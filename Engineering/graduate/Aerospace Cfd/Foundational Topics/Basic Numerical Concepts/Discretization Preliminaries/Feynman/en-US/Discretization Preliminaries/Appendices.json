{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a Computational Fluid Dynamics (CFD) simulation is fundamentally tied to how well the discrete operators mimic the continuous derivatives of the governing equations. This exercise takes you back to first principles, using the workhorse of numerical analysis—the Taylor series—to construct a high-order accurate approximation for the second derivative. Mastering this technique is essential for developing and understanding the custom discretization schemes often required in advanced aerospace applications. ",
            "id": "3955828",
            "problem": "Consider a smooth scalar field $u(x)$ that represents a one-dimensional slice of a flow variable within the context of Computational Fluid Dynamics (CFD) for aerospace applications. You are tasked with constructing a centered finite difference approximation to the second partial derivative $\\partial_{xx} u$ at a grid node $x_{i}$ on a uniform grid with spacing $h$, using only the stencil points $x_{i-2}$, $x_{i-1}$, $x_{i}$, $x_{i+1}$, and $x_{i+2}$. Starting from the fundamental definition of the derivative and the Taylor series expansion of $u(x)$ about $x_{i}$, derive a linear combination of the form\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right)\n$$\nthat approximates $\\partial_{xx} u(x_{i})$ with fourth-order accuracy. Define the leading truncation error coefficient $C$ by the relation\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right) \\;=\\; \\partial_{xx} u(x_{i}) \\;+\\; C\\,h^{4}\\,\\partial_{x}^{6}u(x_{i}) \\;+\\; \\mathcal{O}(h^{6}),\n$$\nwhere $\\partial_{x}^{6}u$ denotes the sixth derivative of $u$ with respect to $x$. Use Taylor series to determine the coefficients $a_{0}$, $a_{1}$, and $a_{2}$ by enforcing fourth-order accuracy, and then compute the exact value of $C$ implied by your construction. Provide $C$ as an exact rational number. No units are required for the final answer. Do not round; give the fraction in simplest form.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard exercise in the derivation of finite difference schemes using Taylor series analysis. Therefore, the problem is deemed valid.\n\nThe objective is to find a finite difference approximation for the second derivative $\\partial_{xx} u$ at a grid node $x_i$ of the form:\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right)\n$$\nThis approximation must be fourth-order accurate, which means its Taylor series expansion must match that of $\\partial_{xx} u(x_i)$ up to terms of order $\\mathcal{O}(h^4)$. We begin by writing the Taylor series expansions for the function $u(x)$ at the stencil points $x_{i \\pm 1}$ and $x_{i \\pm 2}$ around the central point $x_i$. Let $u_j = u(x_j)$ and $u_i^{(k)} = \\partial_x^k u(x_i)$. The uniform grid spacing is $h$, so $x_{i \\pm n} = x_i \\pm n h$.\n\nThe Taylor series expansions are:\n$$u_{i+1} = u_i + h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} + \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} + \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i-1} = u_i - h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} - \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} - \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i+2} = u_i + (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} + \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} + \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i-2} = u_i - (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} - \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} - \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n\nThe proposed scheme uses symmetric combinations of these points. Summing the pairs of expansions cancels all odd-order derivative terms:\n$$u_{i+1} + u_{i-1} = 2u_i + 2\\frac{h^2}{2!}u_i^{(2)} + 2\\frac{h^4}{4!}u_i^{(4)} + 2\\frac{h^6}{6!}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+1} + u_{i-1} = 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} + \\mathcal{O}(h^8)$$\nAnd for the outer points:\n$$u_{i+2} + u_{i-2} = 2u_i + 2\\frac{(2h)^2}{2!}u_i^{(2)} + 2\\frac{(2h)^4}{4!}u_i^{(4)} + 2\\frac{(2h)^6}{6!}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{16h^4}{12}u_i^{(4)} + \\frac{64h^6}{360}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{4}{3}h^4 u_i^{(4)} + \\frac{8}{45}h^6 u_i^{(6)} + \\mathcal{O}(h^8)$$\n\nNow, we substitute these sums into the general form of the finite difference operator. Let $L[u]$ be the operator.\n$$L[u] = \\frac{1}{h^2} \\left( a_0 u_i + a_1(u_{i+1} + u_{i-1}) + a_2(u_{i+2} + u_{i-2}) \\right)$$\n$$L[u] = \\frac{1}{h^2} \\left[ a_0 u_i + a_1 \\left( 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} \\right) + a_2 \\left( 2u_i + 4h^2 u_i^{(2)} + \\frac{4}{3}h^4 u_i^{(4)} + \\frac{8}{45}h^6 u_i^{(6)} \\right) + \\mathcal{O}(h^8) \\right]$$\nWe collect terms based on the order of derivatives of $u$ at $x_i$:\n$$L[u] = \\frac{1}{h^2} \\left[ (a_0 + 2a_1 + 2a_2)u_i + (a_1 + 4a_2)h^2 u_i^{(2)} + \\left(\\frac{a_1}{12} + \\frac{4a_2}{3}\\right)h^4 u_i^{(4)} + \\left(\\frac{a_1}{360} + \\frac{8a_2}{45}\\right)h^6 u_i^{(6)} + \\mathcal{O}(h^8) \\right]$$\n$$L[u] = \\frac{(a_0 + 2a_1 + 2a_2)}{h^2} u_i + (a_1 + 4a_2) u_i^{(2)} + \\left(\\frac{a_1}{12} + \\frac{4a_2}{3}\\right)h^2 u_i^{(4)} + \\left(\\frac{a_1}{360} + \\frac{8a_2}{45}\\right)h^4 u_i^{(6)} + \\mathcal{O}(h^6)$$\nFor this expression to be a fourth-order accurate approximation of $u_i^{(2)} = \\partial_{xx} u(x_i)$, the coefficients must satisfy the following conditions:\n\\begin{enumerate}\n    \\item The coefficient of $u_i$ must be zero: $a_0 + 2a_1 + 2a_2 = 0$.\n    \\item The coefficient of $u_i^{(2)}$ must be one: $a_1 + 4a_2 = 1$.\n    \\item The coefficient of $u_i^{(4)}$ must be zero to eliminate the $\\mathcal{O}(h^2)$ error term: $\\frac{a_1}{12} + \\frac{4a_2}{3} = 0$.\n\\end{enumerate}\nWe solve this system of three linear equations for $a_0$, $a_1$, and $a_2$. From the third equation:\n$$\\frac{a_1}{12} = -\\frac{4a_2}{3} \\implies a_1 = -16a_2$$\nSubstitute this into the second equation:\n$$-16a_2 + 4a_2 = 1 \\implies -12a_2 = 1 \\implies a_2 = -\\frac{1}{12}$$\nNow, we find $a_1$:\n$$a_1 = -16 \\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}$$\nFinally, using the first equation, we find $a_0$:\n$$a_0 = -2a_1 - 2a_2 = -2\\left(\\frac{4}{3}\\right) - 2\\left(-\\frac{1}{12}\\right) = -\\frac{8}{3} + \\frac{2}{12} = -\\frac{8}{3} + \\frac{1}{6}$$\n$$a_0 = -\\frac{16}{6} + \\frac{1}{6} = -\\frac{15}{6} = -\\frac{5}{2}$$\nThe coefficients are $a_0 = -\\frac{5}{2}$, $a_1 = \\frac{4}{3}$, and $a_2 = -\\frac{1}{12}$.\n\nWith these coefficients, the $\\mathcal{O}(h^2)$ error term vanishes. The leading error term is the next non-zero term in the expansion, which is the term proportional to $h^4 u_i^{(6)}$. The problem defines the truncation error such that:\n$$L[u] = \\partial_{xx} u(x_{i}) + C\\,h^{4}\\,\\partial_{x}^{6}u(x_{i}) + \\mathcal{O}(h^{6})$$\nFrom our expansion, the coefficient of $h^4 u_i^{(6)}$ is $C$. We can determine $C$ from our derived expression for $L[u]$:\n$$C = \\frac{a_1}{360} + \\frac{8a_2}{45}$$\nSubstitute the values of $a_1$ and $a_2$:\n$$C = \\frac{4/3}{360} + \\frac{8(-1/12)}{45} = \\frac{4}{3 \\cdot 360} - \\frac{8}{12 \\cdot 45}$$\n$$C = \\frac{4}{1080} - \\frac{8}{540} = \\frac{1}{270} - \\frac{8}{540}$$\nTo subtract, we use a common denominator of $540$:\n$$C = \\frac{2}{540} - \\frac{8}{540} = -\\frac{6}{540}$$\nSimplifying the fraction gives the final value for the leading truncation error coefficient:\n$$C = -\\frac{1}{90}$$",
            "answer": "$$\\boxed{-\\frac{1}{90}}$$"
        },
        {
            "introduction": "A numerically accurate scheme is useless if it is not stable, as any small error will grow exponentially and destroy the solution. This practice introduces the powerful von Neumann stability analysis to investigate the behavior of a time-dependent advection scheme. By analyzing how different wave components are amplified or damped over a single time step, you will derive the celebrated Courant–Friedrichs–Lewy (CFL) condition from scratch, a cornerstone of explicit time-marching methods in CFD. ",
            "id": "3955901",
            "problem": "Consider the linear advection (transport) equation $\\partial_{t} u + a \\,\\partial_{x} u = 0$ with constant wave speed $a \\in \\mathbb{R}$ on an infinite, uniform grid with spatial spacing $\\Delta x$ and explicit time step $\\Delta t$. Let $u^{n}_{j}$ denote the numerical approximation to $u$ at spatial node $x_{j} = j\\,\\Delta x$ and time level $t^{n} = n\\,\\Delta t$. Discretize in time using forward Euler and in space using the first-order upwind difference, chosen according to the sign of $a$ (upwind in the direction of the characteristic):\n- If $a \\ge 0$, use the backward difference in space.\n- If $a \\le 0$, use the forward difference in space.\nDefine the dimensionless Courant–Friedrichs–Lewy (CFL) number $C = |a|\\,\\Delta t/\\Delta x$.\n\nUsing von Neumann (Fourier) stability analysis on this linear constant-coefficient scheme, proceed from the definition of a discrete Fourier mode and the linearity of the update to:\n- Derive the closed-form expression of the one-step amplification factor as a function of the nondimensional wavenumber $\\theta \\in [-\\pi,\\pi]$ and the signed Courant number $\\nu = a\\,\\Delta t/\\Delta x$.\n- From first principles, determine the necessary and sufficient bound on $\\nu$ such that the scheme is stable in the Fourier (energy) sense, that is, the spectral radius of the amplification matrix (equivalently $\\sup_{\\theta} |G(\\theta;\\nu)|$) does not exceed $1$.\n- Express this stability bound in terms of the CFL number $C$ and compute the exact value of the maximal allowable CFL number\n$$\nC_{\\max} \\equiv \\sup \\{\\, C \\ge 0 \\;:\\; \\sup_{\\theta \\in [-\\pi,\\pi]} |G(\\theta;\\nu)| \\le 1 \\,\\}.\n$$\n\nReport the single exact value of $C_{\\max}$ as your final answer. The CFL number is dimensionless; no unit is required. Do not provide an inequality; provide only the maximal admissible value $C_{\\max}$.",
            "solution": "The problem statement is a standard exercise in the stability analysis of finite difference schemes and is deemed valid. It is scientifically grounded, well-posed, objective, and complete. We shall proceed with the derivation as requested.\n\nThe governing partial differential equation is the linear advection equation:\n$$\n\\partial_{t} u + a \\,\\partial_{x} u = 0\n$$\nwhere $a \\in \\mathbb{R}$ is the constant wave speed.\nThe numerical grid is defined by $x_j = j\\,\\Delta x$ and $t^n = n\\,\\Delta t$, with $u^n_j$ approximating $u(x_j, t^n)$. The time derivative is discretized using the first-order forward Euler scheme: $\\partial_t u \\approx (u_j^{n+1} - u_j^n)/\\Delta t$. The spatial derivative is discretized using a first-order upwind scheme, which depends on the sign of the wave speed $a$.\n\nWe consider two cases based on the sign of $a$.\n\nCase 1: $a \\ge 0$ (Wave propagates in the positive $x$-direction)\nThe upwind direction is from the left, so we use a backward difference for the spatial derivative: $\\partial_x u \\approx (u_j^n - u_{j-1}^n)/\\Delta x$. The finite difference equation (FDE) is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nRearranging for $u_j^{n+1}$ and introducing the signed Courant number $\\nu = a\\,\\Delta t/\\Delta x$, which is non-negative ($\\nu \\ge 0$) in this case, we get:\n$$\nu_j^{n+1} = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n$$\nTo perform von Neumann stability analysis, we substitute a single Fourier mode $u_j^n = \\hat{u}^n \\exp(ij\\theta)$, where $\\theta = k\\Delta x$ is the non-dimensional wavenumber for a mode with wavenumber $k$, and $\\hat{u}^n$ is the amplitude at time level $n$.\n$$\n\\hat{u}^{n+1} \\exp(ij\\theta) = \\hat{u}^n \\exp(ij\\theta) - \\nu (\\hat{u}^n \\exp(ij\\theta) - \\hat{u}^n \\exp(i(j-1)\\theta))\n$$\nThe amplification factor $G(\\theta; \\nu) = \\hat{u}^{n+1}/\\hat{u}^n$ is found by dividing by $\\hat{u}^n \\exp(ij\\theta)$:\n$$\nG(\\theta; \\nu) = 1 - \\nu (1 - \\exp(-i\\theta))\n$$\nFor stability, the magnitude of the amplification factor must not exceed $1$ for all $\\theta \\in [-\\pi, \\pi]$, i.e., $|G(\\theta; \\nu)| \\le 1$. We can express $G$ as:\n$$\nG(\\theta; \\nu) = (1 - \\nu) + \\nu \\exp(-i\\theta)\n$$\nThis expression describes a circle in the complex plane with center $c = 1 - \\nu$ and radius $r = \\nu$. For the entire circle to lie within the unit disk $|z| \\le 1$, the condition $|c| + r \\le 1$ must hold.\n$$\n|1 - \\nu| + \\nu \\le 1\n$$\nSince we are in the case where $\\nu \\ge 0$, we consider two sub-cases for the absolute value:\n1. If $0 \\le \\nu \\le 1$, then $1 - \\nu \\ge 0$, and the condition becomes $(1 - \\nu) + \\nu \\le 1$, which simplifies to $1 \\le 1$. This is always true.\n2. If $\\nu > 1$, then $1 - \\nu < 0$, and the condition becomes $-(1 - \\nu) + \\nu \\le 1$, which simplifies to $2\\nu - 1 \\le 1$, or $\\nu \\le 1$. This contradicts the assumption $\\nu > 1$.\nThus, for $a \\ge 0$, the stability condition is $0 \\le \\nu \\le 1$.\n\nCase 2: $a \\le 0$ (Wave propagates in the negative $x$-direction)\nThe upwind direction is from the right, so we use a forward difference for the spatial derivative: $\\partial_x u \\approx (u_{j+1}^n - u_j^n)/\\Delta x$. The FDE is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\nAgain, introducing $\\nu = a\\,\\Delta t/\\Delta x$, which is non-positive ($\\nu \\le 0$) in this case, we get:\n$$\nu_j^{n+1} = u_j^n - \\nu (u_{j+1}^n - u_j^n)\n$$\nSubstituting the Fourier mode $u_j^n = \\hat{u}^n \\exp(ij\\theta)$:\n$$\n\\hat{u}^{n+1} \\exp(ij\\theta) = \\hat{u}^n \\exp(ij\\theta) - \\nu (\\hat{u}^n \\exp(i(j+1)\\theta) - \\hat{u}^n \\exp(ij\\theta))\n$$\nDividing by $\\hat{u}^n \\exp(ij\\theta)$ gives the amplification factor:\n$$\nG(\\theta; \\nu) = 1 - \\nu (\\exp(i\\theta) - 1)\n$$\nThis can be rewritten as:\n$$\nG(\\theta; \\nu) = (1 + \\nu) - \\nu \\exp(i\\theta)\n$$\nThis expression describes a circle in the complex plane with center $c = 1 + \\nu$ and radius $r = |-\\nu| = -\\nu$ (since $\\nu \\le 0$). The stability condition $|c| + r \\le 1$ becomes:\n$$\n|1 + \\nu| - \\nu \\le 1\n$$\nSince $\\nu \\le 0$, we consider two sub-cases for the absolute value:\n1. If $-1 \\le \\nu \\le 0$, then $1 + \\nu \\ge 0$, and the condition is $(1 + \\nu) - \\nu \\le 1$, which simplifies to $1 \\le 1$. This is always true.\n2. If $\\nu < -1$, then $1 + \\nu < 0$, and the condition is $-(1 + \\nu) - \\nu \\le 1$, which simplifies to $-1 - 2\\nu \\le 1$, or $\\nu \\ge -1$. This contradicts the assumption $\\nu < -1$.\nThus, for $a \\le 0$, the stability condition is $-1 \\le \\nu \\le 0$.\n\nSummary of Results\nThe amplification factor $G(\\theta; \\nu)$ for the first-order upwind scheme is given by:\n$$\nG(\\theta; \\nu) = \n\\begin{cases} \n1 - \\nu (1 - \\exp(-i\\theta)) & \\text{if } \\nu \\ge 0 \\\\\n1 - \\nu (\\exp(i\\theta) - 1) & \\text{if } \\nu \\le 0 \n\\end{cases}\n$$\nThe necessary and sufficient condition for Fourier stability, $|G(\\theta; \\nu)| \\le 1$ for all $\\theta$, is found by combining the results from both cases:\n$$\n-1 \\le \\nu \\le 1\n$$\nThis can be written compactly as $|\\nu| \\le 1$.\n\nThe problem defines the (non-negative) CFL number as $C = |a|\\,\\Delta t/\\Delta x$. We can relate this to the signed Courant number $\\nu = a\\,\\Delta t/\\Delta x$. Note that $C = |\\nu|$.\nTherefore, the stability condition $|\\nu| \\le 1$ is equivalent to:\n$$\nC \\le 1\n$$\nSince $C$ is by definition non-negative, the stability bound is $0 \\le C \\le 1$.\n\nThe problem asks for the maximal allowable CFL number, $C_{\\max}$, defined as:\n$$\nC_{\\max} \\equiv \\sup \\{\\, C \\ge 0 \\;:\\; \\sup_{\\theta \\in [-\\pi,\\pi]} |G(\\theta;\\nu)| \\le 1 \\,\\}\n$$\nThe set of allowable $C$ values is the interval $[0, 1]$. The supremum of this set is $1$.\nTherefore, the maximal allowable CFL number is $1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "Theoretical analysis provides the expected order of accuracy, but how do we verify that our code implements the scheme correctly and achieves this order in practice? This hands-on coding exercise guides you through the standard industry and academic practice of grid refinement studies to empirically measure a scheme's convergence rate. You will implement second-order schemes and use them to confront common real-world challenges, such as non-asymptotic behavior and the effects of sharp gradients, which can mask the true order of accuracy. ",
            "id": "3955888",
            "problem": "Consider the task of empirically estimating the order of accuracy of a spatial discretization in Computational Fluid Dynamics (CFD). The foundational base is the definition of the spatial derivative and the use of Taylor series expansions to derive finite-difference approximations. Let a sufficiently smooth scalar field $u(x)$ be defined on the closed interval $[0,1]$, and consider a family of uniform grids with $N$ grid points, grid spacing $h = \\frac{1}{N-1}$, and grid nodes $x_i = i h$ for $i = 0,1,\\dots,N-1$.\n\nYour objective is to:\n1. Derive and implement second-order accurate finite-difference formulas for the first derivative $u'(x)$ on a uniform grid:\n   - Use a second-order central difference for interior nodes.\n   - Use second-order one-sided differences at the boundaries.\n   The derivation must start from Taylor series expansions and the definition of $u'(x)$, without assuming the target formulas a priori.\n2. For each grid, compute the discrete approximation of $u'(x)$ and evaluate the discrete $L^2$ error norm\n   $$E(h) = \\left( h \\sum_{i=0}^{N-1} \\left( u'_h(x_i) - u'(x_i) \\right)^2 \\right)^{1/2},$$\n   where $u'_h(x_i)$ denotes the numerical derivative at node $x_i$ computed by your finite-difference scheme.\n3. Using a grid refinement study with a constant refinement ratio, estimate the empirical order of accuracy $p$ by a least-squares fit of $\\log E(h)$ versus $\\log h$, that is, find the slope of the best-fit line\n   $$\\log E(h) \\approx \\alpha + p \\log h.$$\n   The empirical order $p$ must be computed from at least three grid levels.\n\nPitfalls to consider and discuss in your solution:\n- Non-asymptotic regimes on coarse grids where higher-order truncation terms are not negligible, which may distort the estimated $p$.\n- Boundary layer effects where localized steep gradients can dominate the global error, modifying the apparent convergence rate unless the grid sufficiently resolves the layer thickness.\n\nImplement this procedure for the following test suite, which is designed to probe different facets of the empirical order measurement:\n\n- Test Case A (happy path, smooth and well-resolved): \n  - Function $u(x) = \\sin(2\\pi x)$ with exact derivative $u'(x) = 2\\pi \\cos(2\\pi x)$.\n  - Grids with $N \\in \\{50, 100, 200\\}$.\n- Test Case B (non-asymptotic coarse resolution of higher frequency content):\n  - Function $u(x) = \\sin(12\\pi x)$ with exact derivative $u'(x) = 12\\pi \\cos(12\\pi x)$.\n  - Grids with $N \\in \\{12, 24, 48\\}$.\n- Test Case C (boundary layer effect):\n  - Function $u(x) = \\tanh\\!\\left(\\frac{x}{\\delta}\\right)$ with exact derivative $u'(x) = \\frac{1}{\\delta}\\,\\mathrm{sech}^2\\!\\left(\\frac{x}{\\delta}\\right)$, where $\\delta = 10^{-2}$.\n  - Grids with $N \\in \\{100, 200, 400\\}$.\n\nYour program must:\n- Implement the second-order finite-difference scheme derived from first principles as described above.\n- For each test case, compute the errors $E(h)$ for the specified grids and estimate the empirical order $p$ via least-squares on $(\\log h, \\log E(h))$ data points.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[p_A, p_B, p_C]$, where $p_A$, $p_B$, and $p_C$ are floats representing the estimated empirical orders for Test Cases A, B, and C respectively.\n\nNo physical units are involved; all quantities are dimensionless. Angles in trigonometric functions are in radians. The final output must be exactly in the format specified, with no additional text.",
            "solution": "The problem requires the derivation and implementation of a second-order accurate finite-difference scheme for the first derivative, followed by an empirical estimation of the order of accuracy for three distinct test cases. The solution is presented in several steps: derivation of the numerical schemes, description of the error analysis methodology, and discussion of the specific test cases with respect to known numerical analysis pitfalls.\n\n### 1. Derivation of Second-Order Finite-Difference Schemes\n\nWe are tasked with approximating the first derivative $u'(x)$ of a sufficiently smooth function $u(x)$ on a uniform grid $x_i = i h$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $h = 1/(N-1)$. The scheme must be second-order accurate, i.e., the truncation error must be $O(h^2)$. We require different formulas for interior nodes and boundary nodes.\n\n#### 1.1. Interior Nodes: Central Difference Scheme\nFor an interior node $x_i$ (where $1 \\le i \\le N-2$), we have access to neighboring points $x_{i-1} = x_i - h$ and $x_{i+1} = x_i + h$. We use Taylor series expansions of $u(x)$ around $x_i$:\n$$u(x_{i+1}) = u(x_i + h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + O(h^4)$$\n$$u(x_{i-1}) = u(x_i - h) = u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + O(h^4)$$\nSubtracting the second expansion from the first yields:\n$$u(x_{i+1}) - u(x_{i-1}) = 2h u'(x_i) + \\frac{h^3}{3} u'''(x_i) + O(h^5)$$\nSolving for $u'(x_i)$:\n$$u'(x_i) = \\frac{u(x_{i+1}) - u(x_{i-1})}{2h} - \\frac{h^2}{6} u'''(x_i) + O(h^4)$$\nThe finite-difference approximation $u'_h(x_i)$ is taken as the first term on the right-hand side. The leading term of the truncation error is $-\\frac{h^2}{6} u'''(x_i)$, which demonstrates that the scheme is second-order accurate.\n$$u'_h(x_i) = \\frac{u(x_{i+1}) - u(x_{i-1})}{2h}, \\quad \\text{for } i = 1, \\dots, N-2$$\n\n#### 1.2. Boundary Nodes: One-Sided Schemes\nAt the boundaries $x_0$ and $x_{N-1}$, a central difference is not possible. We must use one-sided formulas that maintain second-order accuracy. We derive these using the method of undetermined coefficients.\n\n**Left Boundary ($i=0$):** We seek a formula of the form $u'_h(x_0) \\approx a u(x_0) + b u(x_1) + c u(x_2)$. We expand $u(x_1) = u(x_0+h)$ and $u(x_2) = u(x_0+2h)$ around $x_0$:\n$$u(x_1) = u(x_0) + h u'(x_0) + \\frac{h^2}{2} u''(x_0) + O(h^3)$$\n$$u(x_2) = u(x_0) + 2h u'(x_0) + \\frac{(2h)^2}{2} u''(x_0) + O(h^3) = u(x_0) + 2h u'(x_0) + 2h^2 u''(x_0) + O(h^3)$$\nSubstituting these into the formula for $u'_h(x_0)$ and collecting terms by derivatives of $u$ at $x_0$:\n$$a u_0 + b u_1 + c u_2 = (a+b+c)u(x_0) + (bh + 2ch)u'(x_0) + (b\\frac{h^2}{2} + c\\frac{4h^2}{2})u''(x_0) + \\dots$$\nFor this expression to be a second-order approximation of $u'(x_0)$, we require:\n\\begin{enumerate}\n    \\item Coefficient of $u(x_0)$ is $0$: $a+b+c=0$\n    \\item Coefficient of $u'(x_0)$ is $1$: $bh + 2ch=1$\n    \\item Coefficient of $u''(x_0)$ is $0$: $\\frac{b h^2}{2} + 2 c h^2=0$\n\\end{enumerate}\nFrom (3), we get $b/2 + 2c = 0 \\implies b = -4c$. Substituting this into (2) gives $(-4c)h + 2ch = 1 \\implies -2ch=1 \\implies c = -1/(2h)$. Consequently, $b = 2/h$. Finally, from (1), $a = -b-c = -2/h + 1/(2h) = -3/(2h)$. The resulting second-order forward difference formula is:\n$$u'_h(x_0) = \\frac{-3u(x_0) + 4u(x_1) - u(x_2)}{2h}$$\n\n**Right Boundary ($i=N-1$):** A similar procedure using points $x_{N-1}$, $x_{N-2}$, and $x_{N-3}$ yields the second-order backward difference formula. By symmetry, we can infer the coefficients, or solve the corresponding system. The formula is:\n$$u'_h(x_{N-1}) = \\frac{3u(x_{N-1}) - 4u(x_{N-2}) + u(x_{N-3})}{2h}$$\n\n### 2. Error Analysis and Order of Accuracy\n\nThe problem specifies the discrete $L^2$ error norm to quantify the difference between the numerical derivative $u'_h(x_i)$ and the exact derivative $u'(x_i)$:\n$$E(h) = \\left( h \\sum_{i=0}^{N-1} \\left( u'_h(x_i) - u'(x_i) \\right)^2 \\right)^{1/2}$$\nFor a discretization method with an order of accuracy $p$, the error is expected to behave as $E(h) \\approx C h^p$ for a constant $C$ when $h$ is sufficiently small (i.e., in the asymptotic convergence regime). To determine $p$ empirically, we can take the logarithm of this relationship:\n$$\\log E(h) \\approx \\log C + p \\log h$$\nThis shows a linear relationship between $\\log E(h)$ and $\\log h$, with the slope being the order of accuracy $p$. Given a set of error measurements $(E_j)$ on a sequence of grids with spacing $(h_j)$, we can find $p$ by performing a linear least-squares fit on the data points $(\\log h_j, \\log E_j)$.\n\n### 3. Discussion of Test Cases and Pitfalls\n\nThe chosen test cases are designed to highlight important practical aspects of convergence studies.\n\n**Test Case A: $u(x) = \\sin(2\\pi x)$ on $N \\in \\{50, 100, 200\\}$**\nThis is a \"happy path\" case. The function is smooth and periodic, and its derivatives are well-behaved. The grids are sufficiently fine to resolve the single-wavelength variation over the domain $[0,1]$. We expect the error to be in the asymptotic regime, and the estimated order $p_A$ should be very close to the theoretical value of $2$.\n\n**Test Case B: $u(x) = \\sin(12\\pi x)$ on $N \\in \\{12, 24, 48\\}$**\nThis case probes the non-asymptotic regime. The function has a higher frequency (6 full wavelengths in $[0,1]$). The coarsest grid, $N=12$, gives a spacing of $h=1/11$. The wavelength is $\\lambda = 2\\pi/(12\\pi) = 1/6$. The number of points per wavelength is $\\lambda/h \\approx (1/6)/(1/11) \\approx 1.83$, which is well below the Nyquist-Shannon sampling theorem requirement and insufficient for accurate derivative approximation. On such coarse grids, the higher-order terms in the truncation error expansion (e.g., $O(h^4)$) are not negligible compared to the leading $O(h^2)$ term. As a result, the assumption $E(h) \\approx C h^p$ is not valid across this range of grids. The slope of the log-log plot will be distorted, and the estimated order $p_B$ is expected to be significantly lower than $2$.\n\n**Test Case C: $u(x) = \\tanh(x/\\delta)$ with $\\delta = 10^{-2}$ on $N \\in \\{100, 200, 400\\}$**\nThis case illustrates the effect of a boundary layer. The function has a region of very rapid change (a \"layer\") near $x=0$ with a characteristic thickness of $\\delta=0.01$. The truncation error of our schemes depends on higher derivatives, e.g., $u'''(x)$. For this function, these derivatives can be very large within the layer, with magnitudes scaling as $1/\\delta^3$. This makes the constant $C$ in the error relation $E(h) \\approx C h^p$ extremely large. The global error $E(h)$ will be dominated by the large local errors inside this poorly resolved layer. The grid spacings are $h \\approx 1/99, 1/199, 1/399$, which correspond to $h/\\delta \\approx 1, 0.5, 0.25$. Only the finest grid begins to place a few points within the layer. Because the layer is not adequately resolved by all grids in the study, the observed convergence may not follow the theoretical rate. We might expect $p_C$ to deviate from the ideal value of $2$. The convergence will approach the theoretical rate only when $h \\ll \\delta$, which is a much more stringent condition than for the smooth sine function.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef compute_second_order_derivative(u_vals, h):\n    \"\"\"\n    Computes the first derivative using second-order accurate finite differences.\n    - Central difference for interior points.\n    - One-sided differences for boundary points.\n    \n    Args:\n        u_vals (np.ndarray): Array of function values on the grid.\n        h (float): The uniform grid spacing.\n\n    Returns:\n        np.ndarray: The numerical approximation of the first derivative.\n    \"\"\"\n    N = len(u_vals)\n    du_dx = np.zeros(N, dtype=float)\n\n    if N  3:\n        raise ValueError(\"Grid must have at least 3 points for second-order boundaries.\")\n\n    # Second-order forward difference at the left boundary (i=0)\n    du_dx[0] = (-3.0 * u_vals[0] + 4.0 * u_vals[1] - u_vals[2]) / (2.0 * h)\n\n    # Second-order central difference for interior points (i=1 to N-2)\n    du_dx[1:-1] = (u_vals[2:] - u_vals[:-2]) / (2.0 * h)\n\n    # Second-order backward difference at the right boundary (i=N-1)\n    du_dx[-1] = (3.0 * u_vals[-1] - 4.0 * u_vals[-2] + u_vals[-3]) / (2.0 * h)\n\n    return du_dx\n\ndef compute_l2_error(u_numeric, u_exact, h):\n    \"\"\"\n    Computes the discrete L2 error norm.\n\n    Args:\n        u_numeric (np.ndarray): Array of numerical values.\n        u_exact (np.ndarray): Array of exact values.\n        h (float): The uniform grid spacing.\n\n    Returns:\n        float: The discrete L2 error.\n    \"\"\"\n    error_sq_sum = np.sum((u_numeric - u_exact)**2)\n    l2_error = np.sqrt(h * error_sq_sum)\n    return l2_error\n\ndef estimate_order_of_accuracy(h_values, E_values):\n    \"\"\"\n    Estimates the order of accuracy p from E(h) vs h data.\n    This is done by a least-squares fit of log(E) vs log(h).\n\n    Args:\n        h_values (list or np.ndarray): List of grid spacings.\n        E_values (list or np.ndarray): List of corresponding L2 errors.\n\n    Returns:\n        float: The estimated order of accuracy, p.\n    \"\"\"\n    log_h = np.log(h_values)\n    log_E = np.log(E_values)\n\n    # Fit a line (polynomial of degree 1) to the log-log data.\n    # The slope of this line is the order of accuracy.\n    p, _ = np.polyfit(log_h, log_E, 1)\n    return p\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and compute the empirical orders of accuracy.\n    \"\"\"\n    \n    # Test Case A: Smooth function, well-resolved\n    case_A = {\n        \"u\": lambda x: np.sin(2 * np.pi * x),\n        \"du_dx\": lambda x: 2 * np.pi * np.cos(2 * np.pi * x),\n        \"N_values\": [50, 100, 200]\n    }\n\n    # Test Case B: Higher frequency, coarse resolution\n    case_B = {\n        \"u\": lambda x: np.sin(12 * np.pi * x),\n        \"du_dx\": lambda x: 12 * np.pi * np.cos(12 * np.pi * x),\n        \"N_values\": [12, 24, 48]\n    }\n    \n    # Test Case C: Boundary layer\n    delta_C = 1e-2\n    case_C = {\n        \"u\": lambda x: np.tanh(x / delta_C),\n        \"du_dx\": lambda x: (1.0 / delta_C) * (1.0 / np.cosh(x / delta_C))**2,\n        \"N_values\": [100, 200, 400]\n    }\n\n    test_cases = [case_A, case_B, case_C]\n    results = []\n\n    for case in test_cases:\n        h_values = []\n        E_values = []\n        \n        u_func = case[\"u\"]\n        du_dx_func = case[\"du_dx\"]\n        N_values = case[\"N_values\"]\n\n        for N in N_values:\n            h = 1.0 / (N - 1)\n            x_grid = np.linspace(0.0, 1.0, N)\n            \n            u_on_grid = u_func(x_grid)\n            du_dx_numeric = compute_second_order_derivative(u_on_grid, h)\n            du_dx_exact = du_dx_func(x_grid)\n            \n            error = compute_l2_error(du_dx_numeric, du_dx_exact, h)\n            \n            h_values.append(h)\n            E_values.append(error)\n            \n        p_estimated = estimate_order_of_accuracy(h_values, E_values)\n        results.append(p_estimated)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}