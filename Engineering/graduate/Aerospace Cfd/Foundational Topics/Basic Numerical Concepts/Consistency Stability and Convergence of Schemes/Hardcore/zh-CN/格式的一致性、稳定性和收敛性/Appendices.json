{
    "hands_on_practices": [
        {
            "introduction": "数值格式究竟在求解什么？本练习将指导你推导一种简单但广泛使用的数值格式所对应的修正方程。通过泰勒级数展开，你将揭示出“人工粘性”项 ，这是一个会深刻影响解的质量的数值产物。这一分析对于理解格式的*一致性*及其固有的耗散或色散误差至关重要。",
            "id": "3950230",
            "problem": "在计算流体力学 (CFD) 的背景下，考虑一维线性平流偏微分方程 (PDE)，其形式为 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，且 $u(x,t)$ 足够光滑。在一个空间步长为 $\\Delta x$ 的均匀空间网格上，定义在网格点 $x_{i}$ 处对空间导数的半离散一阶迎风有限差分近似，即用 $\\left(u_{i}(t) - u_{i-1}(t)\\right)/\\Delta x$ 替换 $u_{x}(x_{i},t)$，其中 $u_{i}(t) = u(x_{i},t)$ 且 $x_{i} = i\\,\\Delta x$。得到的半离散格式为 $u_{i}'(t) + a\\,\\left(u_{i}(t) - u_{i-1}(t)\\right)/\\Delta x = 0$。\n\n从该偏微分方程和迎风格式的定义出发，使用 $u(x,t)$ 关于 $x_{i}$ 的泰勒级数展开，推导该半离散格式所求解的修正方程，保留截至并包含 $\\mathcal{O}\\!\\left(\\Delta x^{2}\\right)$ 阶的项。然后，识别出该修正方程中出现的、与 $a\\,\\Delta x$ 成正比的主阶人工扩散项。\n\n将你的最终答案表示为该主阶人工扩散项的单个解析表达式。无需进行数值计算，且最终表达式不涉及单位。",
            "solution": "题目要求推导应用于一维线性平流方程的半离散一阶迎风格式的修正偏微分方程。我们必须从这个修正方程中识别出主阶人工扩散项。\n\n给定的偏微分方程(PDE)是线性平流方程：\n$$u_{t} + a\\,u_{x} = 0$$\n其中 $u=u(x,t)$, $u_t = \\frac{\\partial u}{\\partial t}$, $u_x = \\frac{\\partial u}{\\partial x}$，且平流速度 $a$ 是一个正常数 ($a  0$)。\n\n题目定义了一个在空间步长为 $\\Delta x$ 的均匀网格上的半离散数值格式。在每个网格点 $x_i$ 处，空间导数 $u_x$ 由一阶迎风有限差分公式近似。由于 $a  0$，“迎风”方向是负 $x$ 方向，涉及网格点 $i$ 和 $i-1$。该格式表示为：\n$$\\frac{d u_{i}(t)}{dt} + a\\,\\frac{u_{i}(t) - u_{i-1}(t)}{\\Delta x} = 0$$\n这里，$u_i(t)$ 表示在网格点 $x_i$ 处作为连续时间 $t$ 的函数的数值解，因此 $\\frac{d u_{i}(t)}{dt}$ 等价于在 $x_i$ 处计算偏导数 $\\frac{\\partial u}{\\partial t}$。我们可以使用在点 $(x_i, t)$ 处的偏导数记法来写出该格式：\n$$\\frac{\\partial u}{\\partial t} + a\\,\\left(\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x}\\right) = 0$$\n\n为了找出该格式实际求解的修正方程，我们分析有限差分近似的截断误差。我们对项 $u(x_i - \\Delta x, t)$ 在点 $x_i$ 附近进行泰勒级数展开：\n$$u(x_i - \\Delta x, t) = u(x_i, t) - (\\Delta x)\\frac{\\partial u}{\\partial x}\\bigg|_{x_i} + \\frac{(\\Delta x)^2}{2!}\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_i} - \\frac{(\\Delta x)^3}{3!}\\frac{\\partial^3 u}{\\partial x^3}\\bigg|_{x_i} + \\mathcal{O}(\\Delta x^4)$$\n为清晰起见，我们采用下标表示法来表示在 $(x_i, t)$ 处计算的偏导数，例如，$u_x = \\frac{\\partial u}{\\partial x}\\big|_{x_i}$, $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}\\big|_{x_i}$，等等。展开式变为：\n$$u(x_i - \\Delta x, t) = u(x_i, t) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n\n现在，我们将此展开式代入格式中的有限差分算子：\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ u(x_i, t) - \\left( u(x_i, t) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right) \\right]$$\n化简方括号内的表达式：\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ \\Delta x \\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\mathcal{O}(\\Delta x^4) \\right]$$\n两边除以 $\\Delta x$，我们得到离散空间导数算子的连续表示：\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n\n接下来，我们将此结果代回半离散格式。为方便记法，省略在 $x_i$ 处的显式计算，我们现在描述的是解在连续域上的行为：\n$$u_t + a \\left( u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right) = 0$$\n将常数 $a$ 分配进去：\n$$u_t + a u_x - a \\frac{\\Delta x}{2} u_{xx} + a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) = 0$$\n\n这就是该格式所求解的修正偏微分方程，包含了截至 $\\mathcal{O}(\\Delta x^2)$ 阶的项。为了更好地看清与原始偏微分方程的关系，我们重新整理该方程：\n$$u_t + a u_x = a \\frac{\\Delta x}{2} u_{xx} - a \\frac{(\\Delta x)^2}{6} u_{xxx} - \\mathcal{O}(\\Delta x^3)$$\n\n左侧的 $u_t + a u_x$ 是原始的偏微分方程，应等于 $0$。右侧代表了格式的截断误差。修正方程表明，数值解并非精确满足原始偏微分方程，而是满足一个包含这些误差项的不同偏微分方程。\n\n截断误差的主项是 $\\Delta x$ 幂次最低的项，即 $a \\frac{\\Delta x}{2} u_{xx}$。该项的阶为 $\\mathcal{O}(\\Delta x)$。它包含一个二阶空间导数 $u_{xx}$，这是物理扩散或粘性耗散现象（例如热方程 $u_t = \\nu u_{xx}$）的特征。因为该项是数值方法的产物，而非原始物理模型的一部分，所以它被称为“人工扩散”或“数值扩散”。系数 $a \\frac{\\Delta x}{2}$ 是人工扩散系数。由于 $a  0$ 且 $\\Delta x  0$，该系数为正，表明该格式引入了一种耗散效应，倾向于平滑解中的陡峭梯度。\n\n题目要求识别这个“主阶人工扩散项”。根据我们的分析，该项正是截断误差的主项。\n\n因此，人工扩散项为 $a \\frac{\\Delta x}{2} u_{xx}$。",
            "answer": "$$\n\\boxed{a \\frac{\\Delta x}{2} u_{xx}}\n$$"
        },
        {
            "introduction": "在确认了格式的一致性之后，我们必须确保其稳定性，以防止数值误差无限增长。本练习将运用强大的冯·诺依曼稳定性分析方法，研究一种常见的显式平流格式 。你将推导其放大因子，它决定了误差分量如何随时间演化，并由此建立著名的Courant-Friedrichs-Lewy (CFL) 条件，这是计算流体力学中显式时间积分方法的基石。",
            "id": "3950212",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，该方程是计算流体力学 (CFD) 中的一个经典输运模型。假设计算区域为周期性或无限区域，空间网格是均匀的，节点为 $x_{j} = j\\,\\Delta x$（其中 $j$ 为整数），时间层为 $t^{n} = n\\,\\Delta t$（其中 $n$ 为整数）。定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a\\,\\Delta t/\\Delta x$。使用一阶迎风空间差分（适用于 $a0$）和前向欧拉时间积分对该方程进行离散化，形成一个将 $u_{j}^{n}$ 更新至 $u_{j}^{n+1}$ 的显式格式。从线性平流模型以及时间和空间上的前向差分和迎风差分的定义出发，通过代入单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$（其中 $i = \\sqrt{-1}$，$\\theta$ 是无量纲波数）来进行 von Neumann (傅里叶) 稳定性分析。推导由 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义的放大因子 $G(\\theta)$，并确定使该格式对所有 $\\theta$ 都保持稳定的 CFL 数 $\\nu$ 的最大允许值。你的最终答案必须依次包含 $G(\\theta)$ 的闭式表达式和给出最大允许 $\\nu$ 值的单个数字。无需四舍五入。",
            "solution": "问题陈述经评估有效。这是一个源于计算流体力学领域的、有科学依据、适定且客观的问题，具体涉及一个数值格式的稳定性分析。所有必要信息均已提供，没有矛盾或模糊之处。\n\n给定的偏微分方程 (PDE) 是一维线性平流方程：\n$$u_{t} + a\\,u_{x} = 0$$\n其中平流速度 $a$ 是一个正常数 ($a  0$)。\n\n所指定的数值格式使用前向欧拉法进行时间积分，并使用一阶迎风法进行空间离散化。\n\n时间导数项 $u_t$ 由一阶前向差分近似：\n$$\\frac{\\partial u}{\\partial t} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}$$\n其中 $u_j^n$ 表示在空间节点 $x_j = j\\,\\Delta x$ 和时间层 $t^n = n\\,\\Delta t$ 处的数值解。\n\n空间导数项 $u_x$ 由一阶迎风差分近似。由于 $a  0$，“迎风”方向是来自左侧（即信息从较小的 $x$ 传播到较大的 $x$）。这对应于一阶后向差分：\n$$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}$$\n将这些离散近似代入偏微分方程，得到完全离散化的方程：\n$$\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left(\\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\\right) = 0$$\n为了得到 $u_{j}^{n+1}$ 的显式更新格式，我们整理各项：\n$$u_{j}^{n+1} - u_{j}^{n} = -a \\frac{\\Delta t}{\\Delta x} \\left(u_{j}^{n} - u_{j-1}^{n}\\right)$$\n我们引入定义为 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ 的 Courant–Friedrichs–Lewy (CFL) 数。将 $\\nu$ 代入方程得到：\n$$u_{j}^{n+1} = u_{j}^{n} - \\nu \\left(u_{j}^{n} - u_{j-1}^{n}\\right)$$\n$$u_{j}^{n+1} = (1 - \\nu)u_{j}^{n} + \\nu u_{j-1}^{n}$$\n这就是我们必须对其进行 von Neumann 稳定性分析的有限差分格式。该分析通过将单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ 代入格式来进行。此处，$\\hat{u}^{n}$ 是在时间步 $n$ 的模态振幅，$i=\\sqrt{-1}$，$\\theta = k_x \\Delta x$ 是无量纲波数，其中 $k_x$ 是波数。\n\n格式中的各项变为：\n$$u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta)$$\n$$u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$$\n$$u_{j-1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$$\n将这些代入离散方程：\n$$\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta) = (1 - \\nu)\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta) + \\nu \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$$\n我们可以用公因子 $\\exp(i\\,j\\,\\theta)$（非零）来除整个方程：\n$$\\hat{u}^{n+1} = (1 - \\nu)\\hat{u}^{n} + \\nu \\hat{u}^{n}\\,\\exp(-i\\,\\theta)$$\n在右侧提取 $\\hat{u}^n$ 得到：\n$$\\hat{u}^{n+1} = [1 - \\nu + \\nu \\exp(-i\\,\\theta)]\\,\\hat{u}^{n}$$\n放大因子 $G(\\theta)$ 由关系式 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义。通过比较，我们找到 $G(\\theta)$ 的表达式：\n$$G(\\theta) = 1 - \\nu + \\nu \\exp(-i\\,\\theta)$$\n这是所要求答案的第一部分。\n\n为使格式稳定，对于无量纲波数 $\\theta$ 的任何值，放大因子的模都不得超过 1。von Neumann 稳定性条件是：\n$$|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]$$\n为了分析这个条件，我们计算模的平方 $|G(\\theta)|^2$。使用欧拉公式 $\\exp(-i\\,\\theta) = \\cos(\\theta) - i\\,\\sin(\\theta)$，我们可以用其实部和虚部来表示 $G(\\theta)$：\n$$G(\\theta) = (1 - \\nu + \\nu \\cos(\\theta)) - i\\,(\\nu \\sin(\\theta))$$\n模的平方是实部和虚部平方的和：\n$$|G(\\theta)|^2 = (1 - \\nu + \\nu \\cos(\\theta))^2 + (-\\nu \\sin(\\theta))^2$$\n$$|G(\\theta)|^2 = (1 - \\nu(1 - \\cos(\\theta)))^2 + \\nu^2 \\sin^2(\\theta)$$\n展开平方项：\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - \\cos(\\theta))^2 + \\nu^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + \\nu^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta) + \\sin^2(\\theta))$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + 1)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(2 - 2\\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + 2\\nu^2(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 + (2\\nu^2 - 2\\nu)(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 + 2\\nu(\\nu - 1)(1 - \\cos(\\theta))$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 变为：\n$$1 + 2\\nu(\\nu - 1)(1 - \\cos(\\theta)) \\le 1$$\n$$2\\nu(\\nu - 1)(1 - \\cos(\\theta)) \\le 0$$\n我们分析这个不等式中的各个因子：\n1. CFL 数 $\\nu = a\\,\\Delta t / \\Delta x$ 是正的，因为 $a  0$，$\\Delta t  0$，且 $\\Delta x  0$。因此，$\\nu  0$。\n2. 项 $(1 - \\cos(\\theta))$ 对于任何实数 $\\theta$ 总是非负的，因为 $-1 \\le \\cos(\\theta) \\le 1$。其取值范围是从 0 到 2。\n由于 $2\\nu  0$ 且 $(1 - \\cos(\\theta)) \\ge 0$，要使该不等式对所有 $\\theta$ 都成立，唯一的可能是剩余的因子 $(\\nu-1)$ 为非正数。\n$$\\nu - 1 \\le 0 \\implies \\nu \\le 1$$\n将此与 $\\nu  0$ 结合，该格式的稳定性条件是 $0  \\nu \\le 1$。\n问题要求的是使该格式稳定的 CFL 数 $\\nu$ 的最大允许值。这对应于稳定范围的上界。\n$$\\nu_{\\text{max}} = 1$$\n这是所要求答案的第二部分。",
            "answer": "$$\\boxed{G(\\theta) = 1 - \\nu + \\nu \\exp(-i\\theta), \\quad \\nu_{\\text{max}} = 1}$$"
        },
        {
            "introduction": "拉克斯等价定理指出，对于一个一致的线性格式，稳定性意味着收敛性。这最后一个练习将理论与应用联系起来，要求你分析来自模拟网格加密研究的数值结果 。你将计算观测到的收敛阶，学会区分理想的渐进行为与更复杂的实际情况，在这些情况下，边界条件等因素会改变全局误差的行为。",
            "id": "3950211",
            "problem": "考虑方形域上的二维可压缩欧拉方程，其初始条件为一个嵌入在均匀自由流中的等熵涡，使得精确解是该涡以恒定速度进行的刚体对流。假设采用一种在内部形式上为二阶精确的有限体积空间离散格式，并使用一个稳定的显式时间积分器，在固定的 Courant–Friedrichs–Lewy (CFL) 数下进行时间推进。设空间网格为均匀网格，间距为 $h$，并将固定最终时刻的全局离散 $L^{2}$-误差记为 $E(h)$。根据相容性的定义，内部的局部截断误差阶数为 $q_{i}=2$；然而，边界封闭格式会根据其精度改变全局相容阶。在稳定性条件下，收敛性原理断言，全局误差表现为来自不同区域（内部和受边界影响的区域）的贡献之和，可建模为\n$$\nE(h) \\approx C_{i}\\, h^{q_{i}} + C_{b}\\, h^{q_{b}},\n$$\n其中 $C_{i}$ 和 $C_{b}$ 是取决于解和格式细节的正常数，$q_{i}$ 是内部阶数，$q_{b}$ 是边界封闭格式的阶数。对于比率为 $r1$ 的网格加密，其观测精度阶 $p_{\\mathrm{obs}}$ 可以通过对误差测量值进行 $\\log E(h)$ 相对于 $\\log h$ 的斜率拟合来估计。\n\n您的任务是编写一个程序，该程序给定一个小型测试套件，其中包含每个场景下三种网格间距的 $L^{2}$ 误差测量值，计算观测到的精度阶，并在存在边界效应时将其与理论相容性预期进行协调。由于误差和间距是无量纲的，因此不需要物理单位。\n\n定义和要求：\n- 两个连续网格间距 $h_{k}$ 和 $h_{k+1}=h_{k}/r$ 及其相应误差 $E_{k}$ 和 $E_{k+1}$ 之间的成对观测阶为\n$$\np_{k\\rightarrow k+1} = \\frac{\\log\\left(E_{k}/E_{k+1}\\right)}{\\log(r)}.\n$$\n- 多点观测阶 $p_{\\mathrm{fit}}$ 应通过对所有三个数据点进行 $y=\\log E(h)$ 相对于 $x=\\log h$ 的最小二乘线性拟合得到；拟合的斜率即为阶数的估计值。\n- 稳定性条件下的理论渐近全局阶为 $p_{\\infty}=\\min\\{q_{i}, q_{b}\\}$，其中 $q_{b}$ 是边界封闭格式的阶数。在没有降低精度的边界封闭格式（例如，周期性边界）的情况下，取 $q_{b}=q_{i}$。\n- 协调判据：声明一个布尔值 $\\mathrm{asymptotic\\_consistent}$，如果 $|p_{\\mathrm{fit}}-p_{\\infty}|\\leq \\tau$ 或 $|p_{k\\rightarrow k+1}^{\\text{fine}}-p_{\\infty}|\\leq \\tau$ 至少一个成立，则其为真，其中 $p_{k\\rightarrow k+1}^{\\text{fine}}$ 是在两个最密网格上的成对阶，$\\tau$ 是一个小的容差。\n\n测试套件：\n- 所有场景的通用设置：域长度 $L=1$，加密比率 $r=2$，网格尺寸 $N\\in\\{16,32,64\\}$，其中 $h=L/N$。\n- 场景 $\\mathcal{A}$ （周期性边界，无边界引起的精度下降）：测量误差\n  - $E_{16}=0.0001953125$,\n  - $E_{32}=0.000048828125$,\n  - $E_{64}=0.00001220703125$,\n  及理论 $p_{\\infty}=2$。\n- 场景 $\\mathcal{B}$ （入流-出流边界，一阶封闭格式全局占主导地位）：测量误差\n  - $E_{16}=0.001328125$,\n  - $E_{32}=0.00064453125$,\n  - $E_{64}=0.0003173828125$,\n  及理论 $p_{\\infty}=1$。\n- 场景 $\\mathcal{C}$ （壁面边界，一阶封闭格式处于预渐近状态，内部误差在粗网格上仍然显著）：测量误差\n  - $E_{16}=0.000640625$,\n  - $E_{32}=0.00022265625$,\n  - $E_{64}=0.0000869140625$,\n  及理论 $p_{\\infty}=1$。\n\n程序要求：\n- 根据上述定义，使用 $r=2$ 为每个场景实现 $p_{16\\rightarrow 32}$、$p_{32\\rightarrow 64}$ 和 $p_{\\mathrm{fit}}$ 的计算。\n- 对协调判据使用容差 $\\tau=0.15$，并根据所述规则设置 $\\mathrm{asymptotic\\_consistent}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的聚合结果。对于按 $\\mathcal{A}、\\mathcal{B}、\\mathcal{C}$ 顺序排列的每个场景，输出三个浮点数值 $p_{16\\rightarrow 32}$、$p_{32\\rightarrow 64}$ 和 $p_{\\mathrm{fit}}$（四舍五入到三位小数），后跟布尔值 $\\mathrm{asymptotic\\_consistent}$（表示为单词 True 或 False）。因此，最终输出包含十二个项目：\n  - 场景 $\\mathcal{A}$：$p_{16\\rightarrow 32}$、$p_{32\\rightarrow 64}$、$p_{\\mathrm{fit}}$、$\\mathrm{asymptotic\\_consistent}$，\n  - 场景 $\\mathcal{B}$：$p_{16\\rightarrow 32}$、$p_{32\\rightarrow 64}$、$p_{\\mathrm{fit}}$、$\\mathrm{asymptotic\\_consistent}$，\n  - 场景 $\\mathcal{C}$：$p_{16\\rightarrow 32}$、$p_{32\\rightarrow 64}$、$p_{\\mathrm{fit}}$、$\\mathrm{asymptotic\\_consistent}$。\n示例格式：\"[2.000,2.000,2.000,True,1.050,1.020,1.035,True,1.520,1.360,1.440,False]\"。此处显示的数值仅为示例；您的程序必须根据所提供的数据计算实际值。",
            "solution": "该问题被评估为有效。这是一个定义明确、具有科学依据的数值分析练习，专门侧重于数值格式精度阶的验证。它包含了所有必要的数据和定义，没有矛盾之处，并探讨了计算科学与工程中的一个基本概念。\n\n问题的核心在于分析欧拉方程数值解的收敛性。对于一个适定、相容且稳定的数值格式，Lax 等价定理保证其收敛性。这种收敛的速度是衡量格式效率的一个关键指标。\n\n在固定的最终时间，对于给定的网格间距 $h$，全局离散误差 $E(h)$ 取决于计算域内部及其边界的贡献。问题为此行为提供了一个模型：\n$$\nE(h) \\approx C_{i}\\, h^{q_{i}} + C_{b}\\, h^{q_{b}}\n$$\n在此，$C_{i}$ 和 $C_{b}$ 是常数，$q_{i}$ 是域内部空间离散的精度阶，$q_{b}$ 是边界条件实施的精度阶。问题指出，内部格式是二阶精确的，因此 $q_{i}=2$。渐近精度阶 $p_{\\infty}$ 是当 $h$ 足够小时误差减小的速率。在此极限下，指数较低的项占主导地位，因此 $p_{\\infty} = \\min\\{q_{i}, q_{b}\\}$。\n\n为了数值验证精度阶，研究人员在一系列系统性加密的网格上测量误差 $E(h)$。观测到的精度阶 $p_{\\mathrm{obs}}$ 可以从这些测量值中估计出来。\n\n如果我们假设误差由单项主导，$E(h) \\approx C h^{p}$，我们可以对两边取对数：\n$$\n\\log(E(h)) \\approx \\log(C) + p \\log(h)\n$$\n这表明 $\\log(E)$ 和 $\\log(h)$ 之间存在线性关系，其斜率即为精度阶 $p$。\n\n两个网格层级（间距分别为 $h_k$ 和 $h_{k+1}=h_k/r$，其中 $r$ 是加密比率）之间的成对观测阶可以从它们的误差比率中推导出来：\n$$\n\\frac{E_k}{E_{k+1}} \\approx \\frac{C h_k^p}{C (h_k/r)^p} = r^p\n$$\n求解 $p$ 可得到问题中提供的公式：\n$$\np_{k\\rightarrow k+1} = \\frac{\\log(E_k/E_{k+1})}{\\log(r)}\n$$\n为了使用多个数据点获得更稳健的估计，可以对数据 $\\{(\\log h_k, \\log E_k)\\}$ 执行最小二乘线性回归。所得直线的斜率即为拟合的精度阶 $p_{\\mathrm{fit}}$。\n\n协调判据 $|p_{\\mathrm{fit}}-p_{\\infty}|\\leq \\tau$ 或 $|p_{k\\rightarrow k+1}^{\\text{fine}}-p_{\\infty}|\\leq \\tau$ 用于确定模拟结果是否处于渐近区域，在该区域中，观测阶接近于理论渐近阶 $p_\\infty$。容差 $\\tau$ 用于考虑由高阶项或数值噪声引起的微小偏差。在本问题中，给定 $r=2$，$h_N = L/N = 1/N$ (其中 $N \\in \\{16, 32, 64\\}$) 以及 $\\tau=0.15$。\n\n我们现在将此框架应用于每个场景。\n\n**场景 $\\mathcal{A}$**\n- 给定误差：$E_{16}=0.0001953125$, $E_{32}=0.000048828125$, $E_{64}=0.00001220703125$。\n- 理论阶数：$p_{\\infty}=2$。\n- 误差比率为 $E_{16}/E_{32} = 4$ 和 $E_{32}/E_{64} = 4$。\n- 成对阶数：\n  $$p_{16\\rightarrow 32} = \\frac{\\log(4)}{\\log(2)} = 2$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(4)}{\\log(2)} = 2$$\n- 对于拟合阶，我们对 $N\\in\\{16,32,64\\}$ 的 $(\\log(h_N), \\log(E_N))$ 进行线性回归。由于 $(\\log h, \\log E)$ 的三个点的横坐标是等距的，这使得最小二乘斜率简化为第一个点和最后一个点之间的斜率：\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{64}) - \\log(E_{16})}{\\log(h_{64}) - \\log(h_{16})} = \\frac{\\log(E_{16}/E_{64})}{\\log(h_{16}/h_{64})} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(16)}{\\log(4)} = 2$$\n- 协调：最密网格上的成对阶为 $p_{32\\rightarrow 64}=2$，拟合阶为 $p_{\\mathrm{fit}}=2$。\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |2-2|=0 \\leq 0.15$。因此，$\\mathrm{asymptotic\\_consistent}$ 为真。\n  该场景描绘了理想的二阶收敛，这与带有不降低精度的周期性边界（$q_b=q_i=2$）的二阶内部格式的预期一致。\n\n**场景 $\\mathcal{B}$**\n- 给定误差：$E_{16}=0.001328125$, $E_{32}=0.00064453125$, $E_{64}=0.0003173828125$。\n- 理论阶数：$p_{\\infty}=1$。\n- 误差比率为 $E_{16}/E_{32} \\approx 2.06059$ 和 $E_{32}/E_{64} \\approx 2.02985$。\n- 成对阶数：\n  $$p_{16\\rightarrow 32} = \\frac{\\log(2.06059)}{\\log(2)} \\approx 1.043$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(2.02985)}{\\log(2)} \\approx 1.021$$\n- 拟合阶：\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(4.18373)}{\\log(4)} \\approx 1.032$$\n- 协调：最密网格上的成对阶为 $p_{32\\rightarrow 64} \\approx 1.021$，拟合阶为 $p_{\\mathrm{fit}} \\approx 1.032$。\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |1.032-1| = 0.032 \\leq 0.15$。因此，$\\mathrm{asymptotic\\_consistent}$ 为真。\n  结果与一阶收敛的理论预期一致，当一阶边界封闭格式（$q_b=1$）主导二阶内部格式（$q_i=2$）时，就会出现这种情况。\n\n**场景 $\\mathcal{C}$**\n- 给定误差：$E_{16}=0.000640625$, $E_{32}=0.00022265625$, $E_{64}=0.0000869140625$。\n- 理论阶数：$p_{\\infty}=1$。\n- 误差比率为 $E_{16}/E_{32} \\approx 2.87719$ 和 $E_{32}/E_{64} \\approx 2.56180$。\n- 成对阶数：\n  $$p_{16\\rightarrow 32} = \\frac{\\log(2.87719)}{\\log(2)} \\approx 1.525$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(2.56180)}{\\log(2)} \\approx 1.357$$\n- 拟合阶：\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(7.37086)}{\\log(4)} \\approx 1.441$$\n- 协调：最密网格上的成对阶为 $p_{32\\rightarrow 64} \\approx 1.357$，拟合阶为 $p_{\\mathrm{fit}} \\approx 1.441$。\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |1.441-1| = 0.441  0.15$。\n  $|p_{32\\rightarrow 64}-p_{\\infty}| = |1.357-1| = 0.357  0.15$。\n  两个条件均为假，因此 $\\mathrm{asymptotic\\_consistent}$ 为假。\n  此场景展示了一个预渐近状态。尽管最终的收敛速率是 $p_{\\infty}=1$，但所使用的网格不够密，无法达到此极限。在这些网格上，与一阶边界分量 $C_b h^1$ 相比，二阶误差分量 $C_i h^2$ 仍然很显著，导致观测到的阶数介于 1 和 2 之间。成对阶数的下降趋势（$1.525 \\rightarrow 1.357$）正确地表明收敛速率正在接近 1 的渐近极限。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes observed orders of accuracy for a numerical scheme under different\n    scenarios and reconciles them with theoretical expectations.\n    \"\"\"\n    # Common settings for all scenarios\n    r = 2.0  # Refinement ratio\n    N_values = [16, 32, 64]\n    L = 1.0\n    h_values = [L / n for n in N_values]\n    tau = 0.15  # Reconciliation tolerance\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Scenario A\",\n            \"errors\": [0.0001953125, 0.000048828125, 0.00001220703125],\n            \"p_inf\": 2.0\n        },\n        {\n            \"name\": \"Scenario B\",\n            \"errors\": [0.001328125, 0.00064453125, 0.0003173828125],\n            \"p_inf\": 1.0\n        },\n        {\n            \"name\": \"Scenario C\",\n            \"errors\": [0.000640625, 0.00022265625, 0.0000869140625],\n            \"p_inf\": 1.0\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        errors = case[\"errors\"]\n        p_inf = case[\"p_inf\"]\n        \n        # Calculate pairwise orders of accuracy\n        # p_16-32\n        p_coarse = np.log(errors[0] / errors[1]) / np.log(r)\n        \n        # p_32-64\n        p_fine = np.log(errors[1] / errors[2]) / np.log(r)\n\n        # Calculate the multi-point fitted order p_fit\n        # This is done by a least-squares linear fit of y=log(E) vs x=log(h)\n        log_h = np.log(h_values)\n        log_E = np.log(errors)\n        \n        # np.polyfit with degree 1 returns [slope, intercept]\n        p_fit = np.polyfit(log_h, log_E, 1)[0]\n        \n        # Reconciliation criterion\n        # is true if either |p_fit - p_inf| = tau or |p_fine - p_inf| = tau\n        is_consistent = (abs(p_fit - p_inf) = tau) or (abs(p_fine - p_inf) = tau)\n        \n        # Append formatted results for the current scenario\n        results.append(f\"{p_coarse:.3f}\")\n        results.append(f\"{p_fine:.3f}\")\n        results.append(f\"{p_fit:.3f}\")\n        results.append(str(is_consistent))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}