{
    "hands_on_practices": [
        {
            "introduction": "在着手解决复杂的流体动力学问题之前，一个核心技能是识别一个给定的问题在数学上是否适定。本练习提供了一个通过基本原理证明不适定性的实践机会。您将通过一个具体的反例，展示当对斯托克斯方程（Stokes equations）过度施加边界条件时，为何不存在解，其核心在于证明所给定的数据与质量守恒这一基本物理定律相矛盾。这个练习清晰地揭示了物理定律和数学适定性之间的深刻联系。",
            "id": "4006640",
            "problem": "考虑稳态不可压缩斯托克斯方程，这是计算流体动力学 (CFD) 中的一个基本模型，定义在二维单位圆盘区域 $\\Omega = \\{ (x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1}^{2} + x_{2}^{2}  1 \\}$ 上，其边界为 $\\partial \\Omega$。令 $\\boldsymbol{u} : \\Omega \\to \\mathbb{R}^{2}$ 表示速度场，$p : \\Omega \\to \\mathbb{R}$ 表示压力，并假设变量是无量纲的，因此不出现物理单位。方程为\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\nu > 0$ 是运动粘度。考虑以下过定边界数据：\n$$\n\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}, \\qquad p\\big|_{\\partial \\Omega} = 0,\n$$\n其中 $\\boldsymbol{n}$ 表示 $\\partial \\Omega$ 上的外单位法向量。从控制方程和基本积分恒等式出发，构造一个反例，通过证明在索博列夫空间 $H^{1}(\\Omega)$ 中解不存在，来说明该边值问题是不适定的。\n\n你的任务是：\n- 对于在 $\\partial \\Omega$ 上有迹的任何 $H^{1}(\\Omega)$ 解，推导由 $\\nabla \\cdot \\boldsymbol{u} = 0$ 蕴含的必要相容性条件。\n- 仅使用散度定理和 $H^{1}(\\Omega)$ 函数迹的性质等基本原理，计算在单位圆盘 $\\Omega$ 上给定边界速度 $\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}$ 时的边通量积分\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds\n$$\n并说明其值如何与相容性条件矛盾，从而表明在过定数据下解在 $H^{1}(\\Omega)$ 中不存在，因此问题是不适定的。\n\n给出积分 $\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds$ 的值作为你的最终答案。无需四舍五入。",
            "solution": "问题陈述经评估是有效的。它提出了一个定义明确的数学任务：通过证明解不存在来论证给定斯托克斯方程边值问题的不适定性。这通过从控制方程推导出一个必要的相容性条件，并证明所给定的边界数据违反了该条件来实现。此问题具有科学依据、自成体系且客观。\n\n稳态不可压缩流体的斯托克斯方程由以下公式给出：\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0} \\quad \\text{in } \\Omega\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega\n$$\n其中 $\\boldsymbol{u}$ 是速度场，$p$ 是压力，$\\nu > 0$ 是运动粘度。区域 $\\Omega$ 是二维单位圆盘，$\\Omega = \\{ (x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1}^{2} + x_{2}^{2}  1 \\}$。\n\n问题要求我们证明解 $\\boldsymbol{u} \\in H^{1}(\\Omega)$ 不存在。对于任何这样的矢量场 $\\boldsymbol{u}$，散度定理都适用。该定理指出，对于定义在 $\\Omega$ 上的一个足够光滑的矢量场 $\\boldsymbol{v}$，其散度在区域上的积分等于该矢量场穿过边界 $\\partial \\Omega$ 的通量：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{v}) \\, d\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{v} \\cdot \\boldsymbol{n} \\, ds\n$$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial \\Omega$ 上的外单位法向量，$d\\Omega$ 是面积元，$ds$ 是沿边界的弧长元。\n\n我们将此定理应用于速度场 $\\boldsymbol{u}$。不可压缩条件指出，在 $\\Omega$ 中处处有 $\\nabla \\cdot \\boldsymbol{u} = 0$。将此代入散度定理可得：\n$$\n\\int_{\\Omega} 0 \\, d\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds\n$$\n左侧的积分为零。这得出了任何解 $\\boldsymbol{u}$ 都必须满足的必要相容性条件：\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = 0\n$$\n这个条件有一个清晰的物理诠释：对于不可压缩流体，流体穿过一个闭合区域边界的总净通量必须为零。\n\n现在，我们考察给定的边界条件。问题指出边界上的速度由以下公式给出：\n$$\n\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}\n$$\n我们必须使用这个指定条件来计算边通量积分。将 $\\boldsymbol{u} = \\boldsymbol{n}$ 代入边界积分可得：\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot \\boldsymbol{n} \\, ds\n$$\n根据定义，$\\boldsymbol{n}$ 是一个单位法向量，这意味着它的模为 $|\\boldsymbol{n}| = 1$。任何向量与自身的点积是其模的平方。因此：\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{n} = |\\boldsymbol{n}|^{2} = 1^{2} = 1\n$$\n因此积分简化为：\n$$\n\\int_{\\partial \\Omega} 1 \\, ds\n$$\n这个积分表示边界 $\\partial \\Omega$ 的总弧长。区域 $\\Omega$ 是单位圆盘，所以其边界 $\\partial \\Omega$ 是单位圆，半径为 $r=1$。半径为 $r$ 的圆的周长由公式 $2\\pi r$ 给出。对于单位圆，周长是 $2\\pi(1) = 2\\pi$。\n因此，由边界条件确定的边通量积分的值为：\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = 2\\pi\n$$\n我们现在得出了一个矛盾。不可压缩条件 $\\nabla \\cdot \\boldsymbol{u} = 0$ 要求边通量积分为 $0$。然而，给定的边界条件 $\\boldsymbol{u}|_{\\partial \\Omega} = \\boldsymbol{n}$ 要求同个积分为 $2\\pi$。这导致了矛盾的陈述 $0 = 2\\pi$。\n\n由于这个基本矛盾的出现，不存在解 $\\boldsymbol{u} \\in H^1(\\Omega)$ 能同时满足控制不可压缩方程和给定的边界条件。解的不存在证明了该边值问题，在其过定数据的陈述下，是不适定的。附加条件 $p|_{\\partial \\Omega} = 0$ 虽然是过定的一部分，但并非得出此特定矛盾所必需的。\n\n基于给定的边界数据，积分 $\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds$ 的值为 $2\\pi$。",
            "answer": "$$\\boxed{2\\pi}$$"
        },
        {
            "introduction": "理解了如何避免不适定问题后，下一步便是设计高质量的边界条件。在计算流体力学中，物理域常常被人为截断，这就需要引入人工边界，而这些边界不应污染内部区域的解。本练习从简单的适定性要求更进一步，进入了优化的范畴，其目标是最小化在人工边界上产生的伪反射，这在航空航天领域的波传播问题模拟中至关重要。您将推导一个反射系数，并利用它来寻找最优的边界参数，以平衡不同波速下的反射。",
            "id": "4006591",
            "problem": "考虑一个与计算流体力学 (CFD) 相关的一维、无量纲化的线性波传播模型，该模型建立在有限区间 $x \\in [0,L]$ 上，时间 $t \\geq 0$。场量 $u(x,t)$ 满足二阶双曲型偏微分方程\n$$\nu_{tt} = c^{2} u_{xx},\n$$\n其中 $c>0$ 是一个无量纲常数相速度。在右边界 $x=L$ 处，施加了一个对流形式的近似无反射边界条件\n$$\nu_{t} + b\\,u_{x} = 0 \\quad \\text{at } x=L,\n$$\n其中 $b>0$ 是一个可调的无量纲参数。假设左边界 $x=0$ 注入一个角频率为 $\\omega$、波数为 $k$ 的右行时间谐波平面波，该波满足精确的内部色散关系 $\\omega = c\\,k$，并且假设 $x=L$ 附近的解可以表示为一个入射右行波和一个反射左行波的叠加。\n\n任务：\n1. 从控制方程和边界条件出发，对入射-反射分解进行建模，并推导出在 $x=L$ 处的反射系数 $R(b;c)$，将其表示为对流参数 $b$ 和物理相速度 $c$ 的函数。您的推导必须基于平面波拟设和内部方程所蕴含的色散关系。\n2. 使用双曲型问题的标准能量方法，证明为使初边值问题在边界能量耗散的意义下是适定的，对 $b$ 的要求是合理的。\n3. 在许多带有平均流的航空航天 CFD 应用中，可能存在两个不同的无量纲右行相速度 $c_{1}>0$ 和 $c_{2}>0$（例如，在线性化设置中的两个特征族）。您的任务是选择一个单一的边界参数 $b>0$，以最小化这两种速度下虚假反射的最坏情况振幅。构建极小化极大问题\n$$\n\\min_{b>0}\\ \\max\\Big(|R(b;c_{1})|,\\ |R(b;c_{2})|\\Big),\n$$\n并确定其闭式解，即最优选择 $b^{\\star}$。请以单一闭式解析表达式的形式给出您的最终答案。无需四舍五入。所有量均为无量纲。",
            "solution": "这个问题由三个关于一维线性波传播模型的相互关联的任务组成。我将系统地处理每个任务。\n\n### 1. 反射系数的推导\n\n控制偏微分方程是一维波动方程：\n$$\nu_{tt} = c^{2} u_{xx}\n$$\n$x=L$ 边界附近的解被描述为入射右行波和反射左行波的叠加。对于角频率为 $\\omega$ 的时间谐波，通解可以写成复指数的形式。右行波的形式为 $\\exp(i(kx - \\omega t))$，左行波的形式为 $\\exp(i(-kx - \\omega t))$，其中内部方程的色散关系规定了 $\\omega = ck$。\n\n为了以一种独立于观测坐标系的方式定义反射系数，我们可以将波场表示为相对于边界 $x=L$ 的形式。令总场 $u(x,t)$ 为入射波 $u_I(x,t)$ 和反射波 $u_R(x,t)$ 之和：\n$$\nu(x,t) = u_I(x,t) + u_R(x,t)\n$$\n朝正 $x$ 方向传播的入射波和朝负 $x$ 方向传播的反射波可以建模为：\n$$\nu_I(x,t) = A_I \\exp(-i\\omega(t - (x-L)/c)) = A_I \\exp(i(k(x-L) - \\omega t))\n$$\n$$\nu_R(x,t) = A_R \\exp(-i\\omega(t + (x-L)/c)) = A_R \\exp(i(-k(x-L) - \\omega t))\n$$\n这里，$A_I$ 是入射波的振幅，$A_R$ 是反射波的振幅。反射系数 $R$ 定义为比率 $R = A_R / A_I$。\n因此，总解为：\n$$\nu(x,t) = A_I \\left( \\exp(i(k(x-L) - \\omega t)) + R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\n我们需要在 $x=L$ 处应用边界条件：\n$$\nu_{t} + b\\,u_{x} = 0 \\quad \\text{at } x=L\n$$\n首先，我们计算 $u(x,t)$ 的偏导数：\n$$\nu_t = A_I \\left( (-i\\omega) \\exp(i(k(x-L) - \\omega t)) + (-i\\omega) R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\n$$\nu_x = A_I \\left( (ik) \\exp(i(k(x-L) - \\omega t)) + (-ik) R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\n在 $x=L$ 处计算这些导数：\n$$\nu_t(L,t) = -i\\omega A_I (1+R) \\exp(-i\\omega t)\n$$\n$$\nu_x(L,t) = ik A_I (1-R) \\exp(-i\\omega t)\n$$\n将这些表达式代入边界条件：\n$$\n-i\\omega A_I (1+R) \\exp(-i\\omega t) + b (ik A_I (1-R) \\exp(-i\\omega t)) = 0\n$$\n我们可以消去公共的非零因子 $i A_I \\exp(-i\\omega t)$（假设入射波不为零）：\n$$\n-\\omega (1+R) + bk (1-R) = 0\n$$\n使用色散关系 $\\omega = ck$：\n$$\n-ck (1+R) + bk (1-R) = 0\n$$\n假设 $k \\neq 0$（即不是静态解），我们可以除以 $k$：\n$$\n-c(1+R) + b(1-R) = 0\n$$\n现在，我们求解反射系数 $R$：\n$$\n-c - cR + b - bR = 0\n$$\n$$\nb - c = cR + bR\n$$\n$$\nb - c = R(b+c)\n$$\n这得到了反射系数 $R(b;c)$ 作为 $b$ 和 $c$ 的函数：\n$$\nR(b;c) = \\frac{b-c}{b+c}\n$$\n\n### 2. 适定性与能量方法\n\n为了在能量耗散的意义上分析适定性，我们考察系统总能量的演化。波动方程的能量密度由动能密度和势能密度之和给出：\n$$\ne(x,t) = \\frac{1}{2} u_t^2 + \\frac{1}{2} c^2 u_x^2\n$$\n域 $x \\in [0,L]$ 内的总能量 $E(t)$ 是能量密度的积分：\n$$\nE(t) = \\int_{0}^{L} e(x,t) \\,dx = \\frac{1}{2} \\int_{0}^{L} \\left( u_t^2 + c^2 u_x^2 \\right) \\,dx\n$$\n总能量的变化率可以通过对时间求导得到：\n$$\n\\frac{dE}{dt} = \\int_{0}^{L} \\frac{\\partial e}{\\partial t} \\,dx = \\int_{0}^{L} \\left( u_t u_{tt} + c^2 u_x u_{xt} \\right) \\,dx\n$$\n代入控制方程 $u_{tt} = c^2 u_{xx}$：\n$$\n\\frac{dE}{dt} = \\int_{0}^{L} \\left( u_t(c^2 u_{xx}) + c^2 u_x u_{xt} \\right) \\,dx = c^2 \\int_{0}^{L} \\left( u_t u_{xx} + u_x u_{xt} \\right) \\,dx\n$$\n被积函数是能量通量 $\\frac{\\partial}{\\partial x}(u_t u_x)$ 的空间导数。因此，根据微积分基本定理：\n$$\n\\frac{dE}{dt} = c^2 \\int_{0}^{L} \\frac{\\partial}{\\partial x}(u_t u_x) \\,dx = c^2 \\Big[ u_t u_x \\Big]_{x=0}^{x=L} = c^2 u_t(L,t)u_x(L,t) - c^2 u_t(0,t)u_x(0,t)\n$$\n项 $-c^2 u_t u_x$ 表示沿正 $x$ 方向的能量通量。因此，项 $c^2 u_t(L,t)u_x(L,t)$ 是通过边界 $x=L$ 流入域内的能量速率。为了使问题适定，$x=L$ 处的边界必须是被动的，意味着它不能是能量的来源。这要求在该边界流入域内的能量速率为非正值：\n$$\nc^2 u_t(L,t)u_x(L,t) \\le 0\n$$\n现在我们应用在 $x=L$ 处的给定边界条件 $u_t(L,t) = -b u_x(L,t)$。将其代入不等式：\n$$\nc^2 (-b u_x(L,t)) u_x(L,t) \\le 0\n$$\n$$\n-b c^2 (u_x(L,t))^2 \\le 0\n$$\n由于 $c$ 是正常数 ($c>0$)，所以 $c^2 > 0$。平方项 $(u_x(L,t))^2$ 总是非负的。为了使该不等式对任何可能的解 $u(x,t)$ 都成立，我们必须有：\n$$\n-b \\le 0 \\quad \\implies \\quad b \\ge 0\n$$\n题目陈述中给出了 $b>0$。此条件确保了 $x=L$ 处的边界是严格耗散的（除非 $u_x(L,t)=0$），意味着能量总是从域中流出。这可以防止能量自发增长并确保解的稳定性，这是此类初边值问题适定性的一个关键方面。\n\n### 3. 最优边界参数的极小化极大问题\n\n我们的任务是找到解决以下极小化极大问题的最优参数 $b^{\\star}$：\n$$\n\\min_{b>0}\\ \\max\\Big(|R(b;c_{1})|,\\ |R(b;c_{2})|\\Big)\n$$\n从第一部分可知，反射系数为 $R(b;c) = \\frac{b-c}{b+c}$。反射的振幅是其模：\n$$\n|R(b;c)| = \\left| \\frac{b-c}{b+c} \\right|\n$$\n因为 $b>0$ 且 $c>0$（给定 $c_1, c_2 > 0$），分母 $b+c$ 总是正的。因此：\n$$\n|R(b;c)| = \\frac{|b-c|}{b+c}\n$$\n需要最小化的函数是 $f(b) = \\max\\left(\\frac{|b-c_1|}{b+c_1}, \\frac{|b-c_2|}{b+c_2}\\right)$。不失一般性，假设 $0  c_1  c_2$。\n\n让我们分析这两个分量 $g_1(b) = \\frac{|b-c_1|}{b+c_1}$ 和 $g_2(b) = \\frac{|b-c_2|}{b+c_2}$ 作为 $b$ 的函数的行为。\n- 如果 $b \\in (0, c_1]$，则 $|b-c_1| = c_1-b$ 且 $|b-c_2| = c_2-b$。我们考察的函数是 $\\max\\left(\\frac{c_1-b}{c_1+b}, \\frac{c_2-b}{c_2+b}\\right)$。在此区间内，两项都是 $b$ 的递减函数。最大值的最小值将出现在此区间的右端点，即 $b=c_1$。\n- 如果 $b \\in [c_2, \\infty)$，则 $|b-c_1| = b-c_1$ 且 $|b-c_2| = b-c_2$。函数是 $\\max\\left(\\frac{b-c_1}{b+c_1}, \\frac{b-c_2}{b+c_2}\\right)$。两项都是 $b$ 的递增函数。最大值的最小值将出现在左端点，即 $b=c_2$。\n- 因此，最优值 $b^{\\star}$ 必须位于区间 $(c_1, c_2)$ 内。\n\n对于 $b \\in (c_1, c_2)$，我们有 $|b-c_1|=b-c_1$ 和 $|b-c_2|=c_2-b$。函数变为：\n$g_1(b) = \\frac{b-c_1}{b+c_1}$ 和 $g_2(b) = \\frac{c_2-b}{c_2+b}$。\n我们来考察它们对 $b$ 的导数：\n$$\n\\frac{dg_1}{db} = \\frac{d}{db}\\left(\\frac{b-c_1}{b+c_1}\\right) = \\frac{(1)(b+c_1) - (b-c_1)(1)}{(b+c_1)^2} = \\frac{2c_1}{(b+c_1)^2} > 0\n$$\n$$\n\\frac{dg_2}{db} = \\frac{d}{db}\\left(\\frac{c_2-b}{c_2+b}\\right) = \\frac{(-1)(c_2+b) - (c_2-b)(1)}{(c_2+b)^2} = \\frac{-2c_2}{(c_2+b)^2}  0\n$$\n在区间 $(c_1, c_2)$ 内，$g_1(b)$ 是一个单调递增函数，而 $g_2(b)$ 是一个单调递减函数。它们的最大值的最小值 $\\min_{b} \\max(g_1(b), g_2(b))$ 出现在它们相等的地方，即 $g_1(b) = g_2(b)$。\n我们令两个反射振幅相等来找到最优的 $b^{\\star}$：\n$$\n\\frac{b-c_1}{b+c_1} = \\frac{c_2-b}{c_2+b}\n$$\n交叉相乘得到：\n$$\n(b-c_1)(b+c_2) = (c_2-b)(b+c_1)\n$$\n$$\nb^2 + bc_2 - c_1b - c_1c_2 = c_2b + c_1c_2 - b^2 - c_1b\n$$\n项 $bc_2$ 和 $-c_1b$ 在两边可以消去：\n$$\nb^2 - c_1c_2 = c_1c_2 - b^2\n$$\n$$\n2b^2 = 2c_1c_2\n$$\n$$\nb^2 = c_1c_2\n$$\n因为 $b$ 必须为正 ($b>0$)，我们取正平方根：\n$$\nb^{\\star} = \\sqrt{c_1c_2}\n$$\n这个最优参数 $b^{\\star}$ 是两个相速度 $c_1$ 和 $c_2$ 的几何平均数。无论哪个速度更大，这个分析都成立。这个 $b^{\\star}$ 值平衡了两种波速的反射，最小化了最坏情况下的反射振幅。",
            "answer": "$$\\boxed{\\sqrt{c_{1}c_{2}}}$$"
        },
        {
            "introduction": "理论设计的最后一步是确保其在代码中的正确实现。一个理论上完美的边界条件如果实施不当，同样会导致失败。本练习将理论与计算流体力学（CFD）的实际应用联系起来，要求您设计一个关键的验证测试程序。您的任务是验证一个为可压缩流设计的无反射边界条件是否能精确地保持均匀来流状态，这也就是所谓的“自由流保持”（freestream preservation）测试，它是CFD代码验证的基石。这个实践突显了特征线理论在实用CFD代码开发和验证中的核心作用。",
            "id": "4006581",
            "problem": "您的任务是设计并实现一个验证程序，用于测试一个线性的、基于特征的无反射边界条件，是否能够为一维可压缩Navier–Stokes方程在流向上的形式精确地保持空间均匀的自由来流。该程序必须基于基本定律和公认事实构建其逻辑。\n\n首先从可压缩Navier–Stokes方程入手，在一维流动中，其在无粘性极限下简化为一维Euler方程。在自由来流状态下，原始变量 $(\\rho,u,p)$ 是均匀常数 $(\\rho_\\infty,u_\\infty,p_\\infty)$，比热比为 $\\gamma$，声速为 $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$。在均匀自由来流中，空间梯度消失，因此粘性通量为零，且内部演化是稳态的。因此，任何对均匀自由来流的偏离都必然是由边界条件引入的。边界算子必须与精确解兼容，使得当内部状态等于自由来流时，它不会引入任何偏离。\n\n对于垂直于边界方向上的线性化无粘性子系统，特征分解会产生三个波族，其速度取决于 $(u_\\infty,a_\\infty)$。一个边界是适定的，当且仅当施加的标量边界条件的数量等于通过该边界进入域的特征波的数量，并且这些条件仅约束传入的特征波振幅。\n\n考虑一个无反射边界条件的通用实现，它在特征空间中，将传入特征偏差强制为传出特征偏差的仿射函数。对于给定的边界侧，通过一个矩阵 $R$ 和一个向量 $c$ 定义一个特征空间中的线性算子，其作用为\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c,\n$$\n其中 $\\delta w_{\\mathrm{in}}$ 是传入特征偏差的向量，$\\delta w_{\\mathrm{out}}$ 是传出特征偏差的向量，$R$ 是一个形状为 $(n_{\\mathrm{in}},n_{\\mathrm{out}})$ 的实数矩阵，$c$ 是一个长度为 $n_{\\mathrm{in}}$ 的实数向量。这里，$n_{\\mathrm{in}}$ 和 $n_{\\mathrm{out}}$ 分别是边界处传入和传出特征波的数量，由 $(u_\\infty,a_\\infty)$ 和边界侧（左或右）决定。在均匀自由来流中，$\\delta w_{\\mathrm{out}} = 0$。因此，精确的自由来流保持要求 $\\delta w_{\\mathrm{in}} = c = 0$。\n\n对于每个测试用例，您的程序必须：\n- 计算 $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$。\n- 根据法向上的线性化无粘性特征值和边界侧，确定边界上流入和流出特征波的数量。对于左边界，速度大于零的特征波进入域；对于右边界，速度小于零的特征波进入域。\n- 通过检查标量约束的数量是否等于传入特征波的数量，以及矩阵 $R$ 的形状是否为 $(n_{\\mathrm{in}},n_{\\mathrm{out}})$ 且 $c$ 的长度为 $n_{\\mathrm{in}}$，来验证适定性。将此结果报告为一个整数，其中 $1$ 表示适定，$0$ 表示不适定。\n- 通过计算归一化残差来验证自由来流的保持性，\n$$\n\\left\\| \\delta w_{\\mathrm{in}} \\right\\| / a_\\infty = \\left\\| c \\right\\| / a_\\infty,\n$$\n其中范数是欧几里得范数。将此残差报告为一个无量纲的浮点数。由于残差是归一化的，输出中没有物理单位。\n\n使用以下参数值的测试套件，其中包括一个通用的“理想路径”情况、一个偏差注入情况、一个约束数量不匹配的非适定情况，以及一个超音速出流边界情况。在适用时，所有量均使用国际单位制（SI）。\n\n- 测试用例 1（理想路径，亚音速入流，左边界）：\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100,000.0\\,\\mathrm{Pa}$。\n  - 边界侧：左。\n  - $R = \\mathbf{0}$，形状为 $(2,1)$，$c = [0.0,\\,0.0]$。\n\n- 测试用例 2（偏差注入，亚音速出流，右边界）：\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100,000.0\\,\\mathrm{Pa}$。\n  - 边界侧：右。\n  - $R = \\mathbf{0}$，形状为 $(1,2)$，$c = [10^{-6}]$。\n\n- 测试用例 3（非适定不匹配，亚音速入流，左边界）：\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100,000.0\\,\\mathrm{Pa}$。\n  - 边界侧：左。\n  - $R = \\mathbf{0}$，形状为 $(3,1)$，$c = [0.0,\\,0.0,\\,0.0]$。\n\n- 测试用例 4（边界情况，超音速出流，右边界）：\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 500.0\\,\\mathrm{m/s}$, $p_\\infty = 100,000.0\\,\\mathrm{Pa}$。\n  - 边界侧：右。\n  - $R = \\mathbf{0}$，形状为 $(0,3)$，$c = []$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来。对于每个测试用例 $i$，按顺序输出两个值：首先是归一化残差（浮点数），然后是适定性指标（整数，$1$ 表示适定，$0$ 表示不适定）。因此，最终输出必须是以下形式\n$$\n[\\mathrm{res}_1,\\mathrm{wp}_1,\\mathrm{res}_2,\\mathrm{wp}_2,\\mathrm{res}_3,\\mathrm{wp}_3,\\mathrm{res}_4,\\mathrm{wp}_4],\n$$\n没有附加文本。",
            "solution": "用户要求一个用于一维可压缩Navier-Stokes方程的无反射边界条件（NRBCs）的验证程序。任务的核心是评估给定的NRBC公式是否适定，以及它是否完美地保持了均匀的自由来流。该分析基于双曲型偏微分方程的特征理论，并应用于其无粘性子系统（Euler方程）。\n\n**基本原理**\n\n一维可压缩Euler方程是Navier-Stokes方程的无粘性极限，它构成了一个双曲守恒律系统。流场解的演化由信息沿特征线的传播所控制。这些特征线的速度是通量雅可比矩阵的特征值。对于由原始变量 $(\\rho, u, p)$（密度、速度、压力）描述的一维流动，相对于流体的特征速度为 $0$、$+a$ 和 $-a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是声速，$\\gamma$ 是比热比。在固定于计算域的参考系中，对于速度为 $u_\\infty$ 的均匀自由来流，三个特征速度（特征值）是：\n$$\n\\lambda_1 = u_\\infty - a_\\infty\n$$\n$$\n\\lambda_2 = u_\\infty\n$$\n$$\n\\lambda_3 = u_\\infty + a_\\infty\n$$\n其中 $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$ 是自由来流声速。\n\n**边界条件和适定性**\n\n在计算域的边界处，如果一个特征波从域外向域内传播，则定义为“传入”，如果它从域内向域外传播，则定义为“传出”。传入特征波的数量 $n_{\\mathrm{in}}$ 和传出特征波的数量 $n_{\\mathrm{out}}$ 取决于特征值 $\\lambda_i$ 的符号。对于一个有 $3$ 个特征波的系统，$n_{\\mathrm{in}} + n_{\\mathrm{out}} = 3$。\n- 在**左边界**（例如，在域 $[0, L]$ 的 $x=0$ 处），如果特征速度为正（$\\lambda_i > 0$），则为传入。\n- 在**右边界**（例如，在域 $[0, L]$ 的 $x=L$ 处），如果特征速度为负（$\\lambda_i  0$），则为传入。\n\n对于双曲系统，一个适定的边值问题的基本要求是，规定的标量边界条件的数量必须精确等于传入特征波的数量 $n_{\\mathrm{in}}$。边界条件的公式为：\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c\n$$\n其中 $\\delta w_{\\mathrm{in}}$ 和 $\\delta w_{\\mathrm{out}}$ 分别是传入和传出特征偏差的向量。为使该公式适定，必须满足两个条件：\n1. 标量约束的数量，即向量 $c$ 的长度，必须等于根据流态计算出的传入特征波的数量 $n_{\\mathrm{in}}$。\n2. 将传出波耦合到传入波的矩阵 $R$ 的维度必须与传入和传出特征波的数量一致，即其形状必须是 $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$。\n\n**自由来流的保持性**\n\n在均匀自由来流中，所有空间梯度均为零。这意味着在域内不会产生任何波。因此，任何边界上的传出特征偏差均为零：$\\delta w_{\\mathrm{out}} = 0$。将此代入边界条件方程可得：\n$$\n\\delta w_{\\mathrm{in}} = R \\cdot 0 + c = c\n$$\n为使边界条件能精确保持自由来流，它不能虚假地产生传入波。这要求 $\\delta w_{\\mathrm{in}} = 0$，进而要求向量 $c$ 必须是零向量，即 $c=0$。任何非零的 $c$ 都会随着时间的推移向域中注入一个恒定的误差。该误差的大小由归一化残差 $\\|c\\| / a_\\infty$ 来量化，其中 $\\| \\cdot \\|$ 是欧几里得范数。\n\n**测试用例分析**\n\n我们现在将这些原理应用于每个测试用例。\n\n**测试用例 1：亚音速入流，左边界**\n- 给定条件：$\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$。边界侧：左。$R$ 形状：$(2, 1)$。$c = [0.0, 0.0]$。\n- 自由来流声速：$a_\\infty = \\sqrt{1.4 \\times 100000.0 / 1.0} = \\sqrt{140000} \\approx 374.166 \\, \\mathrm{m/s}$。\n- 由于 $|u_\\infty|  a_\\infty$，流动是亚音速的。\n- 特征速度：\n  - $\\lambda_1 = u_\\infty - a_\\infty = 100.0 - 374.166 = -274.166  0$ (传出)\n  - $\\lambda_2 = u_\\infty = 100.0 > 0$ (传入)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 100.0 + 374.166 = 474.166 > 0$ (传入)\n- 在左边界，正速度是传入。因此，$n_{\\mathrm{in}} = 2$，$n_{\\mathrm{out}} = 1$。\n- 适定性检查：\n  - 要求：$n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$。\n  - 给定：$c$ 长度为 $2$，$R$ 形状为 $(2,1)$。\n  - $c$ 的长度（$2$）与 $n_{\\mathrm{in}}$ 匹配。$R$ 的形状（$(2,1)$）与 $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$ 匹配。该条件是适定的（$1$）。\n- 自由来流保持性：\n  - $c = [0.0, 0.0]$，所以 $\\|c\\| = \\sqrt{0.0^2 + 0.0^2} = 0.0$。\n  - 残差：$0.0 / a_\\infty = 0.0$。\n\n**测试用例 2：亚音速出流，右边界**\n- 给定条件：$\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$。边界侧：右。$R$ 形状：$(1, 2)$。$c = [10^{-6}]$。\n- 自由来流状态与用例1相同：$a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$，亚音速流。\n- 特征速度与用例1相同：$\\lambda_1  0$, $\\lambda_2 > 0$, $\\lambda_3 > 0$。\n- 在右边界，负速度是传入。因此，$n_{\\mathrm{in}} = 1$ (来自 $\\lambda_1$)，$n_{\\mathrm{out}} = 2$ (来自 $\\lambda_2, \\lambda_3$)。\n- 适定性检查：\n  - 要求：$n_{\\mathrm{in}} = 1$, $n_{\\mathrm{out}} = 2$。\n  - 给定：$c$ 长度为 $1$，$R$ 形状为 $(1,2)$。\n  - $c$ 的长度（$1$）与 $n_{\\mathrm{in}}$ 匹配。$R$ 的形状（$(1,2)$）与 $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$ 匹配。该条件是适定的（$1$）。\n- 自由来流保持性：\n  - $c = [10^{-6}]$，所以 $\\|c\\| = 10^{-6}$。\n  - 残差：$10^{-6} / 374.1657... \\approx 2.6726 \\times 10^{-9}$。\n\n**测试用例 3：非适定不匹配，左边界**\n- 给定条件：$\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$。边界侧：左。$R$ 形状：$(3, 1)$。$c = [0.0, 0.0, 0.0]$。\n- 自由来流状态和特征波数量与用例1相同：$n_{\\mathrm{in}} = 2$，$n_{\\mathrm{out}} = 1$。\n- 适定性检查：\n  - 要求：$n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$。\n  - 给定：$c$ 长度为 $3$，$R$ 形状为 $(3,1)$。\n  - $c$ 的长度（$3$）与 $n_{\\mathrm{in}}$（$2$）不匹配。这是一个过指定的边界。该条件是不适定的（$0$）。\n- 自由来流保持性：\n  - $c = [0.0, 0.0, 0.0]$，所以 $\\|c\\| = 0.0$。\n  - 残差：$0.0 / a_\\infty = 0.0$。尽管不适定，但指定的偏差为零。\n\n**测试用例 4：超音速出流，右边界**\n- 给定条件：$\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 500.0$, $p_\\infty = 100000.0$。边界侧：右。$R$ 形状：$(0, 3)$。$c = []$。\n- 自由来流声速：$a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$。\n- 由于 $u_\\infty > a_\\infty$，流动是超音速的。\n- 特征速度：\n  - $\\lambda_1 = u_\\infty - a_\\infty = 500.0 - 374.166 = 125.834 > 0$ (传出)\n  - $\\lambda_2 = u_\\infty = 500.0 > 0$ (传出)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 500.0 + 374.166 = 874.166 > 0$ (传出)\n- 在右边界，负速度是传入。所有速度均为正。因此，$n_{\\mathrm{in}} = 0$，$n_{\\mathrm{out}} = 3$。这是一个纯粹的出流边界。\n- 适定性检查：\n  - 要求：$n_{\\mathrm{in}} = 0$, $n_{\\mathrm{out}} = 3$。\n  - 给定：$c$ 是一个空向量（长度为 $0$），$R$ 形状为 $(0,3)$。\n  - $c$ 的长度（$0$）与 $n_{\\mathrm{in}}$ 匹配。$R$ 的形状（$(0,3)$）与 $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$ 匹配。该条件是适定的（$1$）。\n- 自由来流保持性：\n  - $c = []$，所以 $\\|c\\| = 0.0$。\n  - 残差：$0.0 / a_\\infty = 0.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef verify_bc(gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec):\n    \"\"\"\n    Verifies a nonreflecting boundary condition for well-posedness and\n    freestream preservation.\n\n    Args:\n        gamma (float): Ratio of specific heats.\n        rho_inf (float): Freestream density.\n        u_inf (float): Freestream velocity.\n        p_inf (float): Freestream pressure.\n        side (str): Boundary side, 'left' or 'right'.\n        R_shape (tuple): The (rows, cols) shape of the R matrix.\n        c_vec (list or np.ndarray): The c vector.\n\n    Returns:\n        tuple: A tuple containing (normalized_residual, well_posedness_flag).\n    \"\"\"\n    # Step 1: Compute freestream speed of sound\n    if rho_inf = 0 or p_inf = 0:\n        # Invalid physical state, though not expected from problem statement\n        raise ValueError(\"Invalid physical parameters.\")\n    a_inf = np.sqrt(gamma * p_inf / rho_inf)\n\n    # Step 2: Determine incoming and outgoing characteristic counts\n    # Eigenvalues of the 1D Euler system\n    lambda1 = u_inf - a_inf\n    lambda2 = u_inf\n    lambda3 = u_inf + a_inf\n    eigenvalues = [lambda1, lambda2, lambda3]\n\n    n_in = 0\n    if side == 'left':\n        # For a left boundary, incoming waves have positive speed\n        for lam in eigenvalues:\n            if lam  0:\n                n_in += 1\n    elif side == 'right':\n        # For a right boundary, incoming waves have negative speed\n        for lam in eigenvalues:\n            if lam  0:\n                n_in += 1\n    else:\n        raise ValueError(\"Invalid boundary side specified.\")\n    \n    n_out = 3 - n_in\n\n    # Step 3: Verify well-posedness\n    # The number of constraints is the length of the vector c.\n    # The problem specifies R_shape, which implies the dimensions of the operator.\n    n_constraints_given = len(c_vec)\n    R_shape_given = R_shape\n\n    is_well_posed = (n_constraints_given == n_in) and \\\n                    (R_shape_given[0] == n_in) and \\\n                    (R_shape_given[1] == n_out)\n    \n    wp_flag = 1 if is_well_posed else 0\n\n    # Step 4: Verify freestream preservation by computing the normalized residual\n    c_np_vec = np.array(c_vec, dtype=float)\n    norm_c = np.linalg.norm(c_np_vec)\n    \n    # Avoid division by zero, though a_inf should be positive for valid physics\n    residual = norm_c / a_inf if a_inf  0 else 0.0\n\n    return residual, wp_flag\n\ndef solve():\n    \"\"\"\n    Processes the test cases provided in the problem statement and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec)\n    test_cases = [\n        # Test Case 1 (happy path, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (2, 1), [0.0, 0.0]),\n        # Test Case 2 (bias injection, subsonic outflow, right boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'right', (1, 2), [1e-6]),\n        # Test Case 3 (ill-posed mismatch, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (3, 1), [0.0, 0.0, 0.0]),\n        # Test Case 4 (edge case, supersonic outflow, right boundary)\n        (1.4, 1.0, 500.0, 100000.0, 'right', (0, 3), [])\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rho, u, p, side, R_shape, c = case\n        res, wp = verify_bc(gamma, rho, u, p, side, R_shape, c)\n        results.append(res)\n        results.append(wp)\n\n    # Format the results into the required string format\n    # Example: [res1,wp1,res2,wp2,...]\n    # Use a flexible format for floats to maintain precision\n    result_str_list = [f\"{x:.15g}\" if isinstance(x, float) else str(x) for x in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}