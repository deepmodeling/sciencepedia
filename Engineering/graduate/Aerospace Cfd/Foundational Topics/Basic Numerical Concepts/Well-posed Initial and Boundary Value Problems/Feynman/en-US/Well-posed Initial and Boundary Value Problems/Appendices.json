{
    "hands_on_practices": [
        {
            "introduction": "Understanding well-posedness begins with the continuous equations. This exercise provides a concrete demonstration of ill-posedness by showing how over-prescribing boundary data for the steady Stokes equations leads to a direct contradiction with the fundamental principle of mass conservation, proving that no solution can exist under such conditions. This practice sharpens your ability to spot inconsistencies between governing laws and boundary data from first principles. ",
            "id": "4006640",
            "problem": "Consider the steady incompressible Stokes equations, a fundamental model in Computational Fluid Dynamics (CFD), posed on the two-dimensional unit disk domain $\\Omega = \\{ (x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1}^{2} + x_{2}^{2} < 1 \\}$ with boundary $\\partial \\Omega$. Let $\\boldsymbol{u} : \\Omega \\to \\mathbb{R}^{2}$ denote the velocity field and $p : \\Omega \\to \\mathbb{R}$ the pressure, and assume nondimensional variables so that physical units do not appear. The equations are\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n$$\nwhere $\\nu > 0$ is the kinematic viscosity. Consider the following over-prescribed boundary data:\n$$\n\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}, \\qquad p\\big|_{\\partial \\Omega} = 0,\n$$\nwhere $\\boldsymbol{n}$ denotes the outward unit normal on $\\partial \\Omega$. Starting from the governing equations and fundamental integral identities, construct a counterexample that shows this boundary value problem is ill-posed by demonstrating nonexistence of solutions in the Sobolev space $H^{1}(\\Omega)$.\n\nYour task is to:\n- Derive the necessary compatibility condition implied by $\\nabla \\cdot \\boldsymbol{u} = 0$ for any $H^{1}(\\Omega)$ solution with trace on $\\partial \\Omega$.\n- Using only fundamental principles such as the divergence theorem and properties of traces of $H^{1}(\\Omega)$ functions, evaluate the boundary flux integral\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds\n$$\nfor the prescribed boundary velocity $\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}$ on the unit disk $\\Omega$, and show how its value contradicts the compatibility condition, implying nonexistence in $H^{1}(\\Omega)$ and hence ill-posedness under the over-prescribed data.\n\nProvide the value of the integral $\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds$ as your final answer. No rounding is required.",
            "solution": "The problem statement is assessed to be valid. It presents a well-defined mathematical task: to demonstrate the ill-posedness of a given boundary value problem for the Stokes equations by showing that no solution exists. This is achieved by deriving a necessary compatibility condition from the governing equations and showing it is violated by the prescribed boundary data. The problem is scientifically grounded, self-contained, and objective.\n\nThe Stokes equations for a steady, incompressible fluid are given by:\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0} \\quad \\text{in } \\Omega\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega\n$$\nwhere $\\boldsymbol{u}$ is the velocity field, $p$ is the pressure, and $\\nu > 0$ is the kinematic viscosity. The domain $\\Omega$ is the two-dimensional unit disk, $\\Omega = \\{ (x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1}^{2} + x_{2}^{2} < 1 \\}$.\n\nThe problem requires us to demonstrate nonexistence of solutions $\\boldsymbol{u} \\in H^{1}(\\Omega)$. For any such vector field $\\boldsymbol{u}$, the divergence theorem is applicable. The theorem states that for a sufficiently smooth vector field $\\boldsymbol{v}$ defined on $\\Omega$, the integral of its divergence over the domain is equal to the flux of the vector field across the boundary $\\partial \\Omega$:\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{v}) \\, d\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{v} \\cdot \\boldsymbol{n} \\, ds\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal to the boundary $\\partial \\Omega$, $d\\Omega$ is the area element, and $ds$ is the arc length element along the boundary.\n\nWe apply this theorem to the velocity field $\\boldsymbol{u}$. The incompressibility condition states that $\\nabla \\cdot \\boldsymbol{u} = 0$ everywhere in $\\Omega$. Substituting this into the divergence theorem gives:\n$$\n\\int_{\\Omega} 0 \\, d\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds\n$$\nThe integral on the left side is identically zero. This yields a necessary compatibility condition that any solution $\\boldsymbol{u}$ must satisfy:\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = 0\n$$\nThis condition has a clear physical interpretation: for an incompressible fluid, the total net flux of fluid across the boundary of a closed domain must be zero.\n\nNow, we examine the prescribed boundary conditions. The problem states that the velocity on the boundary is given by:\n$$\n\\boldsymbol{u}\\big|_{\\partial \\Omega} = \\boldsymbol{n}\n$$\nWe must evaluate the boundary flux integral using this specified condition. Substituting $\\boldsymbol{u} = \\boldsymbol{n}$ into the boundary integral gives:\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot \\boldsymbol{n} \\, ds\n$$\nBy definition, $\\boldsymbol{n}$ is a unit normal vector, which means its magnitude is $|\\boldsymbol{n}| = 1$. The dot product of any vector with itself is the square of its magnitude. Therefore:\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{n} = |\\boldsymbol{n}|^{2} = 1^{2} = 1\n$$\nThe integral thus simplifies to:\n$$\n\\int_{\\partial \\Omega} 1 \\, ds\n$$\nThis integral represents the total arc length of the boundary $\\partial \\Omega$. The domain $\\Omega$ is the unit disk, so its boundary $\\partial \\Omega$ is the unit circle, which has a radius of $r=1$. The circumference of a circle with radius $r$ is given by the formula $2\\pi r$. For the unit circle, the circumference is $2\\pi(1) = 2\\pi$.\nTherefore, the value of the boundary flux integral, as determined by the boundary condition, is:\n$$\n\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds = 2\\pi\n$$\nWe have now reached a contradiction. The incompressibility condition $\\nabla \\cdot \\boldsymbol{u} = 0$ requires the boundary flux integral to be $0$. However, the prescribed boundary condition $\\boldsymbol{u}|_{\\partial \\Omega} = \\boldsymbol{n}$ requires the same integral to be $2\\pi$. This leads to the contradictory statement $0 = 2\\pi$.\n\nBecause this fundamental contradiction arises, no solution $\\boldsymbol{u} \\in H^1(\\Omega)$ can simultaneously satisfy both the governing incompressibility equation and the prescribed boundary condition. The nonexistence of a solution demonstrates that the boundary value problem, as stated with its over-prescribed data, is ill-posed. The additional condition $p|_{\\partial \\Omega} = 0$, while part of the over-prescription, is not needed to arrive at this specific contradiction.\n\nThe value of the integral $\\int_{\\partial \\Omega} \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, ds$ based on the given boundary data is $2\\pi$.",
            "answer": "$$\\boxed{2\\pi}$$"
        },
        {
            "introduction": "Moving from continuous theory to numerical practice, we explore how boundary discretizations can impact stability. A stable interior scheme is not enough; its interaction with the boundary is critical for the well-posedness of the overall simulation. This problem guides you through a normal mode analysis to determine how a seemingly plausible outflow boundary condition can introduce numerical instabilities, a crucial skill for developing robust CFD solvers. ",
            "id": "4006579",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ on the finite interval $x \\in [0,L]$ with constant advection speed $a > 0$, representative of a one-dimensional convective transport aligned with the positive $x$-direction. In Computational Fluid Dynamics (CFD), the continuous problem with an outflow at $x=L$ is well posed when the boundary condition does not inject incoming information. A commonly used discrete surrogate of the Sommerfeld radiation condition is to enforce at the outflow boundary that the discrete time derivative plus $a$ times a discrete spatial derivative vanish.\n\nDiscretize the spatial domain with a uniform grid $x_{i} = i\\,\\Delta x$, $i=0,1,\\dots,N$, and time with $t^{n} = n\\,\\Delta t$, $n=0,1,2,\\dots$. Use the second-order accurate Lax–Wendroff finite-difference scheme in the interior,\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right), \\quad i=1,2,\\dots,N-1,\n$$\nand impose at the outflow node $i=N$ the discrete radiation boundary condition derived from $(\\partial_{t} + a\\,\\partial_{x})u=0$ using a forward difference in time and a backward difference in space,\n$$\n\\frac{u_{N}^{n+1} - u_{N}^{n}}{\\Delta t} \\;+\\; a\\,\\frac{u_{N}^{n} - u_{N-1}^{n}}{\\Delta x} \\;=\\; 0,\n$$\nwhich equivalently updates the boundary value via\n$$\nu_{N}^{n+1} \\;=\\; u_{N}^{n} \\;-\\; \\lambda\\left(u_{N}^{n} - u_{N-1}^{n}\\right),\n$$\nwhere the Courant number is $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\nUsing normal mode analysis tailored to boundary-layer modes, seek solutions of the homogeneous discrete system of the form $u_{i}^{n} = g^{n}\\,r^{i}$ with $|g|$ the amplification factor and $r$ a (possibly complex) spatial multiplier. Determine the compatibility of the interior update and the boundary update for spatially decaying boundary-layer modes ($|r|<1$), and assess the parameter ranges of $\\lambda$ that ensure no growth of boundary modes, meaning $|g|\\leq 1$ for all admissible $r$ satisfying the compatibility conditions. Report the maximum allowable value of $\\lambda$ (denoted $\\lambda_{\\max}$) such that no boundary mode exhibits growth. Express the final answer as an exact number.",
            "solution": "The problem requires a stability analysis of a discrete initial boundary value problem (IBVP). The system consists of the linear advection equation discretized using the Lax-Wendroff scheme in the interior of the domain, and a first-order upwind-type condition at the outflow boundary. The stability is to be investigated using normal mode analysis for boundary-layer modes, which are solutions of the form $u_{i}^{n} = g^{n}\\,r^{i}$, where $g$ is the amplification factor and $r$ is the spatial multiplier. For a boundary-layer mode originating at the boundary $i=N$, the solution must decay into the interior, which requires $|r|<1$. The scheme is considered stable if for all such modes, the amplification factor satisfies $|g|\\le 1$.\n\nFirst, we substitute the normal mode ansatz $u_{i}^{n} = g^{n}\\,r^{i}$ into the interior Lax-Wendroff scheme:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{\\lambda}{2}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) \\;+\\; \\frac{\\lambda^{2}}{2}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right)\n$$\nwhere $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$. Substituting $u_{i}^{n} = g^{n}\\,r^{i}$ yields:\n$$\ng^{n+1}\\,r^{i} = g^{n}\\,r^{i} - \\frac{\\lambda}{2}\\left(g^{n}\\,r^{i+1} - g^{n}\\,r^{i-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(g^{n}\\,r^{i+1} - 2g^{n}\\,r^{i} + g^{n}\\,r^{i-1}\\right)\n$$\nDividing by $g^{n}\\,r^{i}$ (assuming $g \\neq 0, r \\neq 0$), we obtain the characteristic equation for the interior scheme relating $g$ and $r$:\n$$\ng \\;=\\; 1 - \\frac{\\lambda}{2}\\left(r - r^{-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(r - 2 + r^{-1}\\right)\n$$\nThis equation can be rearranged as a quadratic equation in $r$:\n$$\ng = 1 - \\frac{\\lambda r}{2} + \\frac{\\lambda}{2r} + \\frac{\\lambda^2 r}{2} - \\lambda^2 + \\frac{\\lambda^2}{2r}\n$$\nMultiplying by $2r$ gives:\n$$\n2gr = 2r - \\lambda r^2 + \\lambda + \\lambda^2 r^2 - 2\\lambda^2 r + \\lambda^2\n$$\nCollecting terms in powers of $r$, we get the characteristic polynomial $P(g,r)=0$:\n$$\n\\left(\\lambda^2 - \\lambda\\right)r^2 + \\left(2 - 2g - 2\\lambda^2\\right)r + \\left(\\lambda^2 + \\lambda\\right) = 0\n$$\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(1 - g - \\lambda^2\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\n\nNext, we substitute the same normal mode ansatz $u_{i}^{n} = g^{n}\\,r^{i}$ into the discrete boundary condition at $i=N$:\n$$\nu_{N}^{n+1} \\;=\\; u_{N}^{n} \\;-\\; \\lambda\\left(u_{N}^{n} - u_{N-1}^{n}\\right)\n$$\n$$\ng^{n+1}\\,r^{N} = g^{n}\\,r^{N} - \\lambda\\left(g^{n}\\,r^{N} - g^{n}\\,r^{N-1}\\right)\n$$\nDividing by $g^{n}\\,r^{N}$ leads to the compatibility equation from the boundary condition:\n$$\ng = 1 - \\lambda\\left(1 - r^{-1}\\right) = 1 - \\lambda + \\frac{\\lambda}{r}\n$$\n\nA boundary mode must satisfy both the interior and boundary characteristic equations simultaneously. We can find the admissible values of $r$ by substituting the expression for $g$ from the boundary condition into the interior characteristic polynomial.\nFrom the boundary relation, we have $g - 1 = -\\lambda + \\frac{\\lambda}{r}$, so $1 - g = \\lambda - \\frac{\\lambda}{r}$.\nSubstituting this into the coefficient of the $r$ term in the interior polynomial:\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(\\left(\\lambda - \\frac{\\lambda}{r}\\right) - \\lambda^2\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(\\lambda - \\lambda^2 - \\frac{\\lambda}{r}\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\nAssuming $\\lambda \\neq 0$:\n$$\n\\left(\\lambda-1\\right)r^2 + 2\\left(1 - \\lambda - \\frac{1}{r}\\right)r + \\left(\\lambda+1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)r^2 + 2\\left(1 - \\lambda\\right)r - 2 + \\left(\\lambda+1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)r^2 - 2\\left(\\lambda-1\\right)r + \\left(\\lambda-1\\right) = 0\n$$\nFactoring out the term $(\\lambda-1)$:\n$$\n\\left(\\lambda-1\\right)\\left(r^2 - 2r + 1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)\\left(r-1\\right)^2 = 0\n$$\n\nThis equation provides the condition for a mode to be compatible with both the interior and boundary schemes. We analyze this result for different ranges of $\\lambda$, subject to the physical constraint $\\lambda > 0$ and the Courant-Friedrichs-Lewy (CFL) condition for the interior Lax-Wendroff scheme, which is $\\lambda \\le 1$. Thus, we only need to consider $\\lambda \\in (0, 1]$.\n\nCase 1: $0 < \\lambda < 1$.\nIn this case, $\\lambda-1 \\neq 0$. The equation requires $(r-1)^2 = 0$, which implies $r=1$. A mode with $r=1$ does not decay spatially, so $|r|$ is not strictly less than $1$. Therefore, it is not a boundary-layer mode according to the problem's definition ($|r|<1$). This means that for $0 < \\lambda < 1$, there are no boundary-layer modes that can exist as solutions to this discrete system. The condition for boundary instability is vacuously not met, so the scheme is stable with respect to the boundary for this range of $\\lambda$.\n\nCase 2: $\\lambda = 1$.\nIn this case, the equation becomes $(1-1)(r-1)^2 = 0$, which simplifies to $0=0$. This identity means that for $\\lambda=1$, the interior and boundary schemes are compatible for any value of $r$. The relationship between $g$ and $r$ is given by the boundary condition equation with $\\lambda=1$:\n$$\ng = 1 - 1 + \\frac{1}{r} = \\frac{1}{r}\n$$\nThe problem specifies that we are assessing boundary-layer modes, for which $|r|<1$. For any such choice of $r$, the amplification factor's magnitude is $|g| = \\frac{1}{|r|}$. Since $|r|<1$, it follows that $|g|>1$. For example, if we choose a mode with $r=1/2$, its amplification factor is $g=2$. This is a growing mode, and thus the scheme is unstable at $\\lambda=1$.\n\nIn summary:\n- The interior scheme is stable for $0 < \\lambda \\le 1$.\n- The boundary condition interaction causes no instability for $0 < \\lambda < 1$.\n- The boundary condition interaction causes instability for $\\lambda = 1$.\n\nThe parameter range of $\\lambda$ that ensures no growth of boundary modes is $0 < \\lambda < 1$. The problem asks for the maximum allowable value of $\\lambda$, denoted $\\lambda_{\\max}$. This corresponds to the supremum of the stability interval.\nTherefore, the maximum allowable value is $\\lambda_{\\max} = 1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Theory must ultimately be tested in practice, and a cornerstone of reliable CFD is rigorous code verification. This hands-on exercise challenges you to implement a verification test for a nonreflecting boundary condition, a common feature in aerospace simulations. You will apply characteristic theory to check for both well-posedness (the correct number of constraints) and the exact preservation of a uniform freestream, translating theoretical principles into a practical quality assurance tool. ",
            "id": "4006581",
            "problem": "You are to design and implement a verification program that tests whether a linearized, characteristic-based nonreflecting boundary condition preserves a spatially uniform freestream exactly for the one-dimensional compressible Navier–Stokes equations in the streamwise direction. The program must base its logic on fundamental laws and well-established facts.\n\nBegin with the compressible Navier–Stokes equations, which for a one-dimensional flow reduce in the inviscid limit to the one-dimensional Euler equations. In a freestream state, the primitive variables $(\\rho,u,p)$ are uniform constants $(\\rho_\\infty,u_\\infty,p_\\infty)$ with ratio of specific heats $\\gamma$, and the sound speed is $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$. In a uniform freestream, spatial gradients vanish, so the viscous fluxes are zero, and the interior evolution is steady. Therefore, any deviation from the uniform freestream must be injected by the boundary conditions. The boundary operator must be compatible with the exact solution, such that it does not inject any deviation when the interior state equals the freestream.\n\nFor the linearized inviscid subsystem in the direction normal to the boundary, the characteristic decomposition yields three wave families with speeds that depend on $(u_\\infty,a_\\infty)$. A boundary is well-posed if and only if the number of scalar boundary conditions enforced equals the number of characteristics entering the domain through that boundary, and these conditions constrain only the incoming characteristic amplitudes.\n\nConsider a generic implementation of nonreflecting boundary conditions that, in the characteristic space, enforces incoming characteristic deviations to be an affine function of outgoing deviations. For a given boundary side, define a linear operator in characteristic space by a matrix $R$ and a vector $c$, acting as\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c,\n$$\nwhere $\\delta w_{\\mathrm{in}}$ is a vector of incoming characteristic deviations, $\\delta w_{\\mathrm{out}}$ is a vector of outgoing characteristic deviations, $R$ is a real matrix of shape $(n_{\\mathrm{in}},n_{\\mathrm{out}})$, and $c$ is a real vector of length $n_{\\mathrm{in}}$. Here, $n_{\\mathrm{in}}$ and $n_{\\mathrm{out}}$ are the respective counts of incoming and outgoing characteristics at the boundary, determined by $(u_\\infty,a_\\infty)$ and the boundary side (left or right). In a uniform freestream, $\\delta w_{\\mathrm{out}} = 0$. Therefore, exact freestream preservation requires $\\delta w_{\\mathrm{in}} = c = 0$.\n\nYour program must, for each test case:\n- Compute $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$.\n- Determine the incoming and outgoing characteristic counts at the boundary from the linearized inviscid eigenvalues in the normal direction and the boundary side. For a left boundary, characteristics with speed greater than zero enter the domain; for a right boundary, characteristics with speed less than zero enter the domain.\n- Verify well-posedness by checking that the number of scalar constraints equals the number of incoming characteristics and that the matrix $R$ has shape $(n_{\\mathrm{in}},n_{\\mathrm{out}})$ with $c$ of length $n_{\\mathrm{in}}$. Report this as an integer, where $1$ means well-posed and $0$ means not well-posed.\n- Verify freestream preservation by computing the normalized residual,\n$$\n\\left\\| \\delta w_{\\mathrm{in}} \\right\\| / a_\\infty = \\left\\| c \\right\\| / a_\\infty,\n$$\nwhere the norm is the Euclidean norm. Report this residual as a dimensionless floating-point number. Since the residual is normalized, there are no physical units in the output.\n\nUse the following test suite of parameter values, which includes a general \"happy path\" case, a boundary condition bias injection case, an ill-posed constraint-count mismatch case, and a supersonic outflow edge case. All quantities use the International System of Units (SI) where applicable.\n\n- Test Case 1 (happy path, subsonic inflow, left boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: left.\n  - $R = \\mathbf{0}$ of shape $(2,1)$, $c = [0.0,\\,0.0]$.\n\n- Test Case 2 (bias injection, subsonic outflow, right boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: right.\n  - $R = \\mathbf{0}$ of shape $(1,2)$, $c = [10^{-6}]$.\n\n- Test Case 3 (ill-posed mismatch, subsonic inflow, left boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: left.\n  - $R = \\mathbf{0}$ of shape $(3,1)$, $c = [0.0,\\,0.0,\\,0.0]$.\n\n- Test Case 4 (edge case, supersonic outflow, right boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 500.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: right.\n  - $R = \\mathbf{0}$ of shape $(0,3)$, $c = []$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case $i$, output two values in order: first the normalized residual as a floating point number, then the well-posedness indicator as an integer ($1$ for well-posed, $0$ for not well-posed). Therefore, the final output must be of the form\n$$\n[\\mathrm{res}_1,\\mathrm{wp}_1,\\mathrm{res}_2,\\mathrm{wp}_2,\\mathrm{res}_3,\\mathrm{wp}_3,\\mathrm{res}_4,\\mathrm{wp}_4],\n$$\nwith no additional text.",
            "solution": "The user requests a verification program for nonreflecting boundary conditions (NRBCs) applied to the one-dimensional compressible Navier-Stokes equations. The core of the task is to assess whether a given NRBC formulation is well-posed and whether it perfectly preserves a uniform freestream flow. This analysis is based on the characteristic theory of hyperbolic partial differential equations, applied to the inviscid subsystem (the Euler equations).\n\n**Fundamental Principles**\n\nThe one-dimensional compressible Euler equations, which represent the inviscid limit of the Navier-Stokes equations, form a system of hyperbolic conservation laws. The evolution of the flow solution is governed by the propagation of information along characteristic curves. The speeds of these characteristics are the eigenvalues of the flux Jacobian matrix. For a one-dimensional flow described by primitive variables $(\\rho, u, p)$ (density, velocity, pressure), the characteristic speeds relative to the fluid are $0$, $+a$, and $-a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound and $\\gamma$ is the ratio of specific heats. In a reference frame fixed to the domain, for a uniform freestream flow with velocity $u_\\infty$, the three characteristic speeds (eigenvalues) are:\n$$\n\\lambda_1 = u_\\infty - a_\\infty\n$$\n$$\n\\lambda_2 = u_\\infty\n$$\n$$\n\\lambda_3 = u_\\infty + a_\\infty\n$$\nwhere $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$ is the freestream speed of sound.\n\n**Boundary Conditions and Well-Posedness**\n\nAt a boundary of the computational domain, a characteristic is defined as \"incoming\" if it propagates from outside the domain to inside, and \"outgoing\" if it propagates from inside to outside. The number of incoming characteristics, $n_{\\mathrm{in}}$, and outgoing characteristics, $n_{\\mathrm{out}}$, depends on the signs of the eigenvalues $\\lambda_i$. For a system with $3$ characteristics, $n_{\\mathrm{in}} + n_{\\mathrm{out}} = 3$.\n- At a **left boundary** (e.g., at $x=0$ on a domain $[0, L]$), a characteristic is incoming if its speed is positive ($\\lambda_i > 0$).\n- At a **right boundary** (e.g., at $x=L$ on a domain $[0, L]$), a characteristic is incoming if its speed is negative ($\\lambda_i < 0$).\n\nA fundamental requirement for a well-posed boundary value problem for a hyperbolic system is that the number of prescribed scalar boundary conditions must be exactly equal to the number of incoming characteristics, $n_{\\mathrm{in}}$. The boundary condition formulation is given as:\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c\n$$\nwhere $\\delta w_{\\mathrm{in}}$ and $\\delta w_{\\mathrm{out}}$ are vectors of incoming and outgoing characteristic deviations, respectively. For this formulation to be well-posed, two conditions must be met:\n1. The number of scalar constraints, given by the length of the vector $c$, must equal the number of incoming characteristics calculated from the flow state, $n_{\\mathrm{in}}$.\n2. The matrix $R$, which couples outgoing to incoming waves, must have dimensions consistent with the number of incoming and outgoing characteristics, i.e., its shape must be $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$.\n\n**Freestream Preservation**\n\nIn a uniform freestream, all spatial gradients are zero. This implies that no waves are generated within the domain. Consequently, the outgoing characteristic deviations at any boundary are zero: $\\delta w_{\\mathrm{out}} = 0$. Substituting this into the boundary condition equation yields:\n$$\n\\delta w_{\\mathrm{in}} = R \\cdot 0 + c = c\n$$\nFor the boundary condition to exactly preserve the freestream, it must not spuriously generate incoming waves. This requires $\\delta w_{\\mathrm{in}} = 0$, which in turn demands that the vector $c$ must be the zero vector, $c=0$. Any non-zero $c$ will inject a constant error into the domain over time. The magnitude of this error is quantified by the normalized residual, $\\|c\\| / a_\\infty$, where $\\| \\cdot \\|$ is the Euclidean norm.\n\n**Analysis of Test Cases**\n\nWe now apply these principles to each test case.\n\n**Test Case 1: Subsonic Inflow, Left Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: left. $R$ shape: $(2, 1)$. $c = [0.0, 0.0]$.\n- Freestream sound speed: $a_\\infty = \\sqrt{1.4 \\times 100000.0 / 1.0} = \\sqrt{140000} \\approx 374.166 \\, \\mathrm{m/s}$.\n- Since $|u_\\infty| < a_\\infty$, the flow is subsonic.\n- Characteristic speeds:\n  - $\\lambda_1 = u_\\infty - a_\\infty = 100.0 - 374.166 = -274.166 < 0$ (outgoing)\n  - $\\lambda_2 = u_\\infty = 100.0 > 0$ (incoming)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 100.0 + 374.166 = 474.166 > 0$ (incoming)\n- At a left boundary, positive speeds are incoming. Thus, $n_{\\mathrm{in}} = 2$ and $n_{\\mathrm{out}} = 1$.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$.\n  - Given: $c$ has length $2$, $R$ has shape $(2,1)$.\n  - The length of $c$ ($2$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(2,1)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = [0.0, 0.0]$, so $\\|c\\| = \\sqrt{0.0^2 + 0.0^2} = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$.\n\n**Test Case 2: Subsonic Outflow, Right Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: right. $R$ shape: $(1, 2)$. $c = [10^{-6}]$.\n- Freestream state is identical to Case 1: $a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$, subsonic flow.\n- Characteristic speeds are identical to Case 1: $\\lambda_1 < 0$, $\\lambda_2 > 0$, $\\lambda_3 > 0$.\n- At a right boundary, negative speeds are incoming. Thus, $n_{\\mathrm{in}} = 1$ (from $\\lambda_1$) and $n_{\\mathrm{out}} = 2$ (from $\\lambda_2, \\lambda_3$).\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 1$, $n_{\\mathrm{out}} = 2$.\n  - Given: $c$ has length $1$, $R$ has shape $(1,2)$.\n  - The length of $c$ ($1$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(1,2)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = [10^{-6}]$, so $\\|c\\| = 10^{-6}$.\n  - Residual: $10^{-6} / 374.1657... \\approx 2.6726 \\times 10^{-9}$.\n\n**Test Case 3: Ill-posed Mismatch, Left Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: left. $R$ shape: $(3, 1)$. $c = [0.0, 0.0, 0.0]$.\n- Freestream state and characteristic counts are identical to Case 1: $n_{\\mathrm{in}} = 2$ and $n_{\\mathrm{out}} = 1$.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$.\n  - Given: $c$ has length $3$, $R$ has shape $(3,1)$.\n  - The length of $c$ ($3$) does not match $n_{\\mathrm{in}}$ ($2$). This is an over-specified boundary. The condition is not well-posed ($0$).\n- Freestream preservation:\n  - $c = [0.0, 0.0, 0.0]$, so $\\|c\\| = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$. Despite being ill-posed, the specified bias is zero.\n\n**Test Case 4: Supersonic Outflow, Right Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 500.0$, $p_\\infty = 100000.0$. Side: right. $R$ shape: $(0, 3)$. $c = []$.\n- Freestream sound speed: $a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$.\n- Since $u_\\infty > a_\\infty$, the flow is supersonic.\n- Characteristic speeds:\n  - $\\lambda_1 = u_\\infty - a_\\infty = 500.0 - 374.166 = 125.834 > 0$ (outgoing)\n  - $\\lambda_2 = u_\\infty = 500.0 > 0$ (outgoing)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 500.0 + 374.166 = 874.166 > 0$ (outgoing)\n- At a right boundary, negative speeds are incoming. All speeds are positive. Thus, $n_{\\mathrm{in}} = 0$ and $n_{\\mathrm{out}} = 3$. This is a purely outflow boundary.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 0$, $n_{\\mathrm{out}} = 3$.\n  - Given: $c$ is an empty vector (length $0$), $R$ has shape $(0,3)$.\n  - The length of $c$ ($0$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(0,3)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = []$, so $\\|c\\| = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef verify_bc(gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec):\n    \"\"\"\n    Verifies a nonreflecting boundary condition for well-posedness and\n    freestream preservation.\n\n    Args:\n        gamma (float): Ratio of specific heats.\n        rho_inf (float): Freestream density.\n        u_inf (float): Freestream velocity.\n        p_inf (float): Freestream pressure.\n        side (str): Boundary side, 'left' or 'right'.\n        R_shape (tuple): The (rows, cols) shape of the R matrix.\n        c_vec (list or np.ndarray): The c vector.\n\n    Returns:\n        tuple: A tuple containing (normalized_residual, well_posedness_flag).\n    \"\"\"\n    # Step 1: Compute freestream speed of sound\n    if rho_inf <= 0 or p_inf < 0:\n        # Invalid physical state, though not expected from problem statement\n        raise ValueError(\"Invalid physical parameters.\")\n    a_inf = np.sqrt(gamma * p_inf / rho_inf)\n\n    # Step 2: Determine incoming and outgoing characteristic counts\n    # Eigenvalues of the 1D Euler system\n    lambda1 = u_inf - a_inf\n    lambda2 = u_inf\n    lambda3 = u_inf + a_inf\n    eigenvalues = [lambda1, lambda2, lambda3]\n\n    n_in = 0\n    if side == 'left':\n        # For a left boundary, incoming waves have positive speed\n        for lam in eigenvalues:\n            if lam > 0:\n                n_in += 1\n    elif side == 'right':\n        # For a right boundary, incoming waves have negative speed\n        for lam in eigenvalues:\n            if lam < 0:\n                n_in += 1\n    else:\n        raise ValueError(\"Invalid boundary side specified.\")\n    \n    n_out = 3 - n_in\n\n    # Step 3: Verify well-posedness\n    # The number of constraints is the length of the vector c.\n    # The problem specifies R_shape, which implies the dimensions of the operator.\n    n_constraints_given = len(c_vec)\n    R_shape_given = R_shape\n\n    is_well_posed = (n_constraints_given == n_in) and \\\n                    (R_shape_given[0] == n_in) and \\\n                    (R_shape_given[1] == n_out)\n    \n    wp_flag = 1 if is_well_posed else 0\n\n    # Step 4: Verify freestream preservation by computing the normalized residual\n    c_np_vec = np.array(c_vec, dtype=float)\n    norm_c = np.linalg.norm(c_np_vec)\n    \n    # Avoid division by zero, though a_inf should be positive for valid physics\n    residual = norm_c / a_inf if a_inf > 0 else 0.0\n\n    return residual, wp_flag\n\ndef solve():\n    \"\"\"\n    Processes the test cases provided in the problem statement and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec)\n    test_cases = [\n        # Test Case 1 (happy path, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (2, 1), [0.0, 0.0]),\n        # Test Case 2 (bias injection, subsonic outflow, right boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'right', (1, 2), [1e-6]),\n        # Test Case 3 (ill-posed mismatch, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (3, 1), [0.0, 0.0, 0.0]),\n        # Test Case 4 (edge case, supersonic outflow, right boundary)\n        (1.4, 1.0, 500.0, 100000.0, 'right', (0, 3), [])\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rho, u, p, side, R_shape, c = case\n        res, wp = verify_bc(gamma, rho, u, p, side, R_shape, c)\n        results.append(res)\n        results.append(wp)\n\n    # Format the results into the required string format\n    # Example: [res1,wp1,res2,wp2,...]\n    # Use a flexible format for floats to maintain precision\n    result_str_list = [f\"{x:.15g}\" if isinstance(x, float) else str(x) for x in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}