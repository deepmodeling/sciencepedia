{
    "hands_on_practices": [
        {
            "introduction": "Before implementing numerical methods, it is crucial to formulate a well-posed problem at the continuous, partial differential equation (PDE) level. This first practice focuses on designing an effective non-reflecting boundary condition for the simple wave equation, a fundamental model for many phenomena in aerospace engineering. By deriving the reflection coefficient and analyzing the system's energy, you will establish the conditions for well-posedness and then proceed to optimize the boundary condition for performance across different wave speeds, a common challenge in realistic flows .",
            "id": "4006591",
            "problem": "Consider a one-dimensional, non-dimensionalized linear wave propagation model relevant to Computational Fluid Dynamics (CFD), posed on the finite interval $x \\in [0,L]$ with time $t \\geq 0$. The field $u(x,t)$ satisfies the second-order hyperbolic partial differential equation\n$$\nu_{tt} = c^{2} u_{xx},\n$$\nwhere $c0$ is a constant non-dimensional phase speed. At the right boundary $x=L$, an approximate non-reflecting boundary condition is imposed in the convective form\n$$\nu_{t} + b\\,u_{x} = 0 \\quad \\text{at } x=L,\n$$\nwhere $b0$ is a tunable non-dimensional parameter. Assume that the left boundary $x=0$ injects a right-going time-harmonic plane wave of angular frequency $\\omega$ and wavenumber $k$ satisfying the exact interior dispersion relation $\\omega = c\\,k$, and that the solution near $x=L$ may be represented as the superposition of an incident right-going wave and a reflected left-going wave.\n\nTasks:\n1. Starting from the governing equation and the boundary condition, model the incident-reflected decomposition and derive the reflection coefficient $R(b;c)$ at $x=L$ as a function of the convective parameter $b$ and the physical phase speed $c$. Your derivation must be based on the plane-wave ansatz and the dispersion relation implied by the interior equation.\n2. Using a standard energy argument for hyperbolic problems, justify the requirement on $b$ for the initial-boundary value problem to be well-posed in the sense of energy dissipation at the boundary.\n3. In many aerospace CFD applications with mean flow, two distinct non-dimensional right-going phase speeds $c_{1}0$ and $c_{2}0$ may be present (for example, two characteristic families in a linearized setting). You are tasked with choosing a single boundary parameter $b0$ to minimize the worst-case amplitude of spurious reflection across these two speeds. Formulate the minimax problem\n$$\n\\min_{b0}\\ \\max\\Big(|R(b;c_{1})|,\\ |R(b;c_{2})|\\Big),\n$$\nand determine the optimal choice $b^{\\star}$ that solves it in closed form. Provide your final answer as a single closed-form analytic expression. No rounding is required. All quantities are non-dimensional.",
            "solution": "This problem is composed of three interconnected tasks concerning a one-dimensional linear wave propagation model. I shall address each task systematically.\n\n### 1. Derivation of the Reflection Coefficient\n\nThe governing partial differential equation is the one-dimensional wave equation:\n$$\nu_{tt} = c^{2} u_{xx}\n$$\nThe solution near the boundary at $x=L$ is described as a superposition of an incident right-going wave and a reflected left-going wave. For a time-harmonic wave with angular frequency $\\omega$, the general solution can be written in terms of complex exponentials. A right-going wave has the form $\\exp(i(kx - \\omega t))$ and a left-going wave has the form $\\exp(i(-kx - \\omega t))$, where the dispersion relation for the interior equation dictates that $\\omega = ck$.\n\nTo define the reflection coefficient in a manner independent of the observational frame, we can express the wave field relative to the boundary at $x=L$. Let the total field $u(x,t)$ be the sum of an incident wave $u_I(x,t)$ and a reflected wave $u_R(x,t)$:\n$$\nu(x,t) = u_I(x,t) + u_R(x,t)\n$$\nThe incident wave propagating towards a positive $x$ direction and the reflected wave propagating towards a negative $x$ direction can be modeled as:\n$$\nu_I(x,t) = A_I \\exp(-i\\omega(t - (x-L)/c)) = A_I \\exp(i(k(x-L) - \\omega t))\n$$\n$$\nu_R(x,t) = A_R \\exp(-i\\omega(t + (x-L)/c)) = A_R \\exp(i(-k(x-L) - \\omega t))\n$$\nHere, $A_I$ is the amplitude of the incident wave and $A_R$ is the amplitude of the reflected wave. The reflection coefficient $R$ is defined as the ratio $R = A_R / A_I$.\nThe total solution is thus:\n$$\nu(x,t) = A_I \\left( \\exp(i(k(x-L) - \\omega t)) + R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\nWe need to apply the boundary condition at $x=L$:\n$$\nu_{t} + b\\,u_{x} = 0 \\quad \\text{at } x=L\n$$\nFirst, we compute the partial derivatives of $u(x,t)$:\n$$\nu_t = A_I \\left( (-i\\omega) \\exp(i(k(x-L) - \\omega t)) + (-i\\omega) R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\n$$\nu_x = A_I \\left( (ik) \\exp(i(k(x-L) - \\omega t)) + (-ik) R \\exp(i(-k(x-L) - \\omega t)) \\right)\n$$\nEvaluating these derivatives at $x=L$:\n$$\nu_t(L,t) = -i\\omega A_I (1+R) \\exp(-i\\omega t)\n$$\n$$\nu_x(L,t) = ik A_I (1-R) \\exp(-i\\omega t)\n$$\nSubstituting these expressions into the boundary condition:\n$$\n-i\\omega A_I (1+R) \\exp(-i\\omega t) + b (ik A_I (1-R) \\exp(-i\\omega t)) = 0\n$$\nWe can cancel the common non-zero factor $i A_I \\exp(-i\\omega t)$ (assuming a non-trivial incident wave):\n$$\n-\\omega (1+R) + bk (1-R) = 0\n$$\nUsing the dispersion relation $\\omega = ck$:\n$$\n-ck (1+R) + bk (1-R) = 0\n$$\nAssuming $k \\neq 0$ (i.e., not a static solution), we can divide by $k$:\n$$\n-c(1+R) + b(1-R) = 0\n$$\nNow, we solve for the reflection coefficient $R$:\n$$\n-c - cR + b - bR = 0\n$$\n$$\nb - c = cR + bR\n$$\n$$\nb - c = R(b+c)\n$$\nThis yields the reflection coefficient $R(b;c)$ as a function of $b$ and $c$:\n$$\nR(b;c) = \\frac{b-c}{b+c}\n$$\n\n### 2. Well-Posedness and Energy Argument\n\nTo analyze the well-posedness in the sense of energy dissipation, we examine the evolution of the total energy of the system. The energy density for the wave equation is given by the sum of kinetic and potential energy densities:\n$$\ne(x,t) = \\frac{1}{2} u_t^2 + \\frac{1}{2} c^2 u_x^2\n$$\nThe total energy $E(t)$ in the domain $x \\in [0,L]$ is the integral of the energy density:\n$$\nE(t) = \\int_{0}^{L} e(x,t) \\,dx = \\frac{1}{2} \\int_{0}^{L} \\left( u_t^2 + c^2 u_x^2 \\right) \\,dx\n$$\nThe rate of change of the total energy is found by differentiating with respect to time:\n$$\n\\frac{dE}{dt} = \\int_{0}^{L} \\frac{\\partial e}{\\partial t} \\,dx = \\int_{0}^{L} \\left( u_t u_{tt} + c^2 u_x u_{xt} \\right) \\,dx\n$$\nSubstitute the governing equation $u_{tt} = c^2 u_{xx}$:\n$$\n\\frac{dE}{dt} = \\int_{0}^{L} \\left( u_t(c^2 u_{xx}) + c^2 u_x u_{xt} \\right) \\,dx = c^2 \\int_{0}^{L} \\left( u_t u_{xx} + u_x u_{xt} \\right) \\,dx\n$$\nThe integrand is the spatial derivative of the energy flux, $\\frac{\\partial}{\\partial x}(u_t u_x)$. Thus, by the Fundamental Theorem of Calculus:\n$$\n\\frac{dE}{dt} = c^2 \\int_{0}^{L} \\frac{\\partial}{\\partial x}(u_t u_x) \\,dx = c^2 \\Big[ u_t u_x \\Big]_{x=0}^{x=L} = c^2 u_t(L,t)u_x(L,t) - c^2 u_t(0,t)u_x(0,t)\n$$\nThe term $-c^2 u_t u_x$ represents the energy flux in the positive $x$ direction. Therefore, the term $c^2 u_t(L,t)u_x(L,t)$ is the rate of energy flow into the domain through the boundary at $x=L$. For the problem to be well-posed, the boundary at $x=L$ must be passive, meaning it cannot be a source of energy. This requires the rate of energy flow into the domain at this boundary to be non-positive:\n$$\nc^2 u_t(L,t)u_x(L,t) \\le 0\n$$\nWe now apply the given boundary condition at $x=L$, which is $u_t(L,t) = -b u_x(L,t)$. Substituting this into the inequality:\n$$\nc^2 (-b u_x(L,t)) u_x(L,t) \\le 0\n$$\n$$\n-b c^2 (u_x(L,t))^2 \\le 0\n$$\nSince $c$ is a positive constant ($c>0$), $c^2 > 0$. The squared term $(u_x(L,t))^2$ is always non-negative. For the inequality to hold for any possible solution $u(x,t)$, we must have:\n$$\n-b \\le 0 \\quad \\implies \\quad b \\ge 0\n$$\nThe problem statement provides that $b>0$. This condition ensures that the boundary at $x=L$ is strictly dissipative (unless $u_x(L,t)=0$), meaning energy is always flowing out of the domain. This prevents spontaneous energy growth and ensures the stability of the solution, which is a key aspect of well-posedness for such initial-boundary value problems.\n\n### 3. Minimax Problem for Optimal Boundary Parameter\n\nWe are tasked with finding the optimal parameter $b^{\\star}$ that solves the minimax problem:\n$$\n\\min_{b>0}\\ \\max\\Big(|R(b;c_{1})|,\\ |R(b;c_{2})|\\Big)\n$$\nFrom Part 1, the reflection coefficient is $R(b;c) = \\frac{b-c}{b+c}$. The amplitude of the reflection is its magnitude:\n$$\n|R(b;c)| = \\left| \\frac{b-c}{b+c} \\right|\n$$\nSince $b>0$ and $c>0$ (given as $c_1, c_2 > 0$), the denominator $b+c$ is always positive. Therefore:\n$$\n|R(b;c)| = \\frac{|b-c|}{b+c}\n$$\nThe function to minimize is $f(b) = \\max\\left(\\frac{|b-c_1|}{b+c_1}, \\frac{|b-c_2|}{b+c_2}\\right)$. Without loss of generality, assume $0  c_1  c_2$.\n\nLet's analyze the behavior of the two components, $g_1(b) = \\frac{|b-c_1|}{b+c_1}$ and $g_2(b) = \\frac{|b-c_2|}{b+c_2}$, as functions of $b$.\n- If $b \\in (0, c_1]$, then $|b-c_1| = c_1-b$ and $|b-c_2| = c_2-b$. The function we are examining is $\\max\\left(\\frac{c_1-b}{c_1+b}, \\frac{c_2-b}{c_2+b}\\right)$. Both terms are decreasing functions of $b$ in this interval. The minimum of the maximum will occur at the right endpoint of this interval, i.e., at $b=c_1$.\n- If $b \\in [c_2, \\infty)$, then $|b-c_1| = b-c_1$ and $|b-c_2| = b-c_2$. The function is $\\max\\left(\\frac{b-c_1}{b+c_1}, \\frac{b-c_2}{b+c_2}\\right)$. Both terms are increasing functions of $b$. The minimum of the maximum will occur at the left endpoint, $b=c_2$.\n- The optimal value $b^{\\star}$ must therefore lie in the interval $(c_1, c_2)$.\n\nFor $b \\in (c_1, c_2)$, we have $|b-c_1|=b-c_1$ and $|b-c_2|=c_2-b$. The functions become:\n$g_1(b) = \\frac{b-c_1}{b+c_1}$ and $g_2(b) = \\frac{c_2-b}{c_2+b}$.\nLet's examine their derivatives with respect to $b$:\n$$\n\\frac{dg_1}{db} = \\frac{d}{db}\\left(\\frac{b-c_1}{b+c_1}\\right) = \\frac{(1)(b+c_1) - (b-c_1)(1)}{(b+c_1)^2} = \\frac{2c_1}{(b+c_1)^2} > 0\n$$\n$$\n\\frac{dg_2}{db} = \\frac{d}{db}\\left(\\frac{c_2-b}{c_2+b}\\right) = \\frac{(-1)(c_2+b) - (c_2-b)(1)}{(c_2+b)^2} = \\frac{-2c_2}{(c_2+b)^2}  0\n$$\nIn the interval $(c_1, c_2)$, $g_1(b)$ is a monotonically increasing function, while $g_2(b)$ is a monotonically decreasing function. The minimum of their maximum, $\\min_{b} \\max(g_1(b), g_2(b))$, occurs at the point where they are equal, i.e., $g_1(b) = g_2(b)$.\nWe set the two reflection amplitudes equal to find the optimal $b^{\\star}$:\n$$\n\\frac{b-c_1}{b+c_1} = \\frac{c_2-b}{c_2+b}\n$$\nCross-multiplying gives:\n$$\n(b-c_1)(b+c_2) = (c_2-b)(b+c_1)\n$$\n$$\nb^2 + bc_2 - c_1b - c_1c_2 = c_2b + c_1c_2 - b^2 - c_1b\n$$\nThe terms $bc_2$ and $-c_1b$ cancel from both sides:\n$$\nb^2 - c_1c_2 = c_1c_2 - b^2\n$$\n$$\n2b^2 = 2c_1c_2\n$$\n$$\nb^2 = c_1c_2\n$$\nSince $b$ must be positive ($b>0$), we take the positive square root:\n$$\nb^{\\star} = \\sqrt{c_1c_2}\n$$\nThis optimal parameter $b^{\\star}$ is the geometric mean of the two phase speeds $c_1$ and $c_2$. The analysis holds regardless of which speed is larger. This value of $b^{\\star}$ balances the reflection for both wave speeds, minimizing the worst-case reflection amplitude.",
            "answer": "$$\\boxed{\\sqrt{c_{1}c_{2}}}$$"
        },
        {
            "introduction": "A well-posed continuous problem is a necessary, but not sufficient, condition for a stable numerical simulation. The process of discretization can introduce its own instabilities, particularly at the interface between the interior scheme and the boundary condition treatment. This exercise  provides hands-on practice with normal mode analysis, a powerful technique to diagnose boundary-induced instabilities in finite-difference schemes. By investigating the interaction between the Lax–Wendroff scheme and a common outflow condition, you will determine the precise stability limits imposed by the boundary.",
            "id": "4006579",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ on the finite interval $x \\in [0,L]$ with constant advection speed $a  0$, representative of a one-dimensional convective transport aligned with the positive $x$-direction. In Computational Fluid Dynamics (CFD), the continuous problem with an outflow at $x=L$ is well posed when the boundary condition does not inject incoming information. A commonly used discrete surrogate of the Sommerfeld radiation condition is to enforce at the outflow boundary that the discrete time derivative plus $a$ times a discrete spatial derivative vanish.\n\nDiscretize the spatial domain with a uniform grid $x_{i} = i\\,\\Delta x$, $i=0,1,\\dots,N$, and time with $t^{n} = n\\,\\Delta t$, $n=0,1,2,\\dots$. Use the second-order accurate Lax–Wendroff finite-difference scheme in the interior,\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right), \\quad i=1,2,\\dots,N-1,\n$$\nand impose at the outflow node $i=N$ the discrete radiation boundary condition derived from $(\\partial_{t} + a\\,\\partial_{x})u=0$ using a forward difference in time and a backward difference in space,\n$$\n\\frac{u_{N}^{n+1} - u_{N}^{n}}{\\Delta t} \\;+\\; a\\,\\frac{u_{N}^{n} - u_{N-1}^{n}}{\\Delta x} \\;=\\; 0,\n$$\nwhich equivalently updates the boundary value via\n$$\nu_{N}^{n+1} \\;=\\; u_{N}^{n} \\;-\\; \\lambda\\left(u_{N}^{n} - u_{N-1}^{n}\\right),\n$$\nwhere the Courant number is $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\nUsing normal mode analysis tailored to boundary-layer modes, seek solutions of the homogeneous discrete system of the form $u_{i}^{n} = g^{n}\\,r^{i}$ with $|g|$ the amplification factor and $r$ a (possibly complex) spatial multiplier. Determine the compatibility of the interior update and the boundary update for spatially decaying boundary-layer modes ($|r|1$), and assess the parameter ranges of $\\lambda$ that ensure no growth of boundary modes, meaning $|g|\\leq 1$ for all admissible $r$ satisfying the compatibility conditions. Report the maximum allowable value of $\\lambda$ (denoted $\\lambda_{\\max}$) such that no boundary mode exhibits growth. Express the final answer as an exact number.",
            "solution": "The problem requires a stability analysis of a discrete initial boundary value problem (IBVP). The system consists of the linear advection equation discretized using the Lax-Wendroff scheme in the interior of the domain, and a first-order upwind-type condition at the outflow boundary. The stability is to be investigated using normal mode analysis for boundary-layer modes, which are solutions of the form $u_{i}^{n} = g^{n}\\,r^{i}$, where $g$ is the amplification factor and $r$ is the spatial multiplier. For a boundary-layer mode originating at the boundary $i=N$, the solution must decay into the interior, which requires $|r|1$. The scheme is considered stable if for all such modes, the amplification factor satisfies $|g|\\le 1$.\n\nFirst, we substitute the normal mode ansatz $u_{i}^{n} = g^{n}\\,r^{i}$ into the interior Lax-Wendroff scheme:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{\\lambda}{2}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) \\;+\\; \\frac{\\lambda^{2}}{2}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right)\n$$\nwhere $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$. Substituting $u_{i}^{n} = g^{n}\\,r^{i}$ yields:\n$$\ng^{n+1}\\,r^{i} = g^{n}\\,r^{i} - \\frac{\\lambda}{2}\\left(g^{n}\\,r^{i+1} - g^{n}\\,r^{i-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(g^{n}\\,r^{i+1} - 2g^{n}\\,r^{i} + g^{n}\\,r^{i-1}\\right)\n$$\nDividing by $g^{n}\\,r^{i}$ (assuming $g \\neq 0, r \\neq 0$), we obtain the characteristic equation for the interior scheme relating $g$ and $r$:\n$$\ng \\;=\\; 1 - \\frac{\\lambda}{2}\\left(r - r^{-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(r - 2 + r^{-1}\\right)\n$$\nThis equation can be rearranged as a quadratic equation in $r$:\n$$\ng = 1 - \\frac{\\lambda r}{2} + \\frac{\\lambda}{2r} + \\frac{\\lambda^2 r}{2} - \\lambda^2 + \\frac{\\lambda^2}{2r}\n$$\nMultiplying by $2r$ gives:\n$$\n2gr = 2r - \\lambda r^2 + \\lambda + \\lambda^2 r^2 - 2\\lambda^2 r + \\lambda^2\n$$\nCollecting terms in powers of $r$, we get the characteristic polynomial $P(g,r)=0$:\n$$\n\\left(\\lambda^2 - \\lambda\\right)r^2 + \\left(2 - 2g - 2\\lambda^2\\right)r + \\left(\\lambda^2 + \\lambda\\right) = 0\n$$\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(1 - g - \\lambda^2\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\n\nNext, we substitute the same normal mode ansatz $u_{i}^{n} = g^{n}\\,r^{i}$ into the discrete boundary condition at $i=N$:\n$$\nu_{N}^{n+1} \\;=\\; u_{N}^{n} \\;-\\; \\lambda\\left(u_{N}^{n} - u_{N-1}^{n}\\right)\n$$\n$$\ng^{n+1}\\,r^{N} = g^{n}\\,r^{N} - \\lambda\\left(g^{n}\\,r^{N} - g^{n}\\,r^{N-1}\\right)\n$$\nDividing by $g^{n}\\,r^{N}$ leads to the compatibility equation from the boundary condition:\n$$\ng = 1 - \\lambda\\left(1 - r^{-1}\\right) = 1 - \\lambda + \\frac{\\lambda}{r}\n$$\n\nA boundary mode must satisfy both the interior and boundary characteristic equations simultaneously. We can find the admissible values of $r$ by substituting the expression for $g$ from the boundary condition into the interior characteristic polynomial.\nFrom the boundary relation, we have $g - 1 = -\\lambda + \\frac{\\lambda}{r}$, so $1 - g = \\lambda - \\frac{\\lambda}{r}$.\nSubstituting this into the coefficient of the $r$ term in the interior polynomial:\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(\\left(\\lambda - \\frac{\\lambda}{r}\\right) - \\lambda^2\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\n$$\n\\lambda\\left(\\lambda-1\\right)r^2 + 2\\left(\\lambda - \\lambda^2 - \\frac{\\lambda}{r}\\right)r + \\lambda\\left(\\lambda+1\\right) = 0\n$$\nAssuming $\\lambda \\neq 0$:\n$$\n\\left(\\lambda-1\\right)r^2 + 2\\left(1 - \\lambda - \\frac{1}{r}\\right)r + \\left(\\lambda+1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)r^2 + 2\\left(1 - \\lambda\\right)r - 2 + \\left(\\lambda+1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)r^2 - 2\\left(\\lambda-1\\right)r + \\left(\\lambda-1\\right) = 0\n$$\nFactoring out the term $(\\lambda-1)$:\n$$\n\\left(\\lambda-1\\right)\\left(r^2 - 2r + 1\\right) = 0\n$$\n$$\n\\left(\\lambda-1\\right)\\left(r-1\\right)^2 = 0\n$$\n\nThis equation provides the condition for a mode to be compatible with both the interior and boundary schemes. We analyze this result for different ranges of $\\lambda$, subject to the physical constraint $\\lambda > 0$ and the Courant-Friedrichs-Lewy (CFL) condition for the interior Lax-Wendroff scheme, which is $\\lambda \\le 1$. Thus, we only need to consider $\\lambda \\in (0, 1]$.\n\nCase 1: $0  \\lambda  1$.\nIn this case, $\\lambda-1 \\neq 0$. The equation requires $(r-1)^2 = 0$, which implies $r=1$. A mode with $r=1$ does not decay spatially, so $|r|$ is not strictly less than $1$. Therefore, it is not a boundary-layer mode according to the problem's definition ($|r|1$). This means that for $0  \\lambda  1$, there are no boundary-layer modes that can exist as solutions to this discrete system. The condition for boundary instability is vacuously not met, so the scheme is stable with respect to the boundary for this range of $\\lambda$.\n\nCase 2: $\\lambda = 1$.\nIn this case, the equation becomes $(1-1)(r-1)^2 = 0$, which simplifies to $0=0$. This identity means that for $\\lambda=1$, the interior and boundary schemes are compatible for any value of $r$. The relationship between $g$ and $r$ is given by the boundary condition equation with $\\lambda=1$:\n$$\ng = 1 - 1 + \\frac{1}{r} = \\frac{1}{r}\n$$\nThe problem specifies that we are assessing boundary-layer modes, for which $|r|1$. For any such choice of $r$, the amplification factor's magnitude is $|g| = \\frac{1}{|r|}$. Since $|r|1$, it follows that $|g|>1$. For example, if we choose a mode with $r=1/2$, its amplification factor is $g=2$. This is a growing mode, and thus the scheme is unstable at $\\lambda=1$.\n\nIn summary:\n- The interior scheme is stable for $0  \\lambda \\le 1$.\n- The boundary condition interaction causes no instability for $0  \\lambda  1$.\n- The boundary condition interaction causes instability for $\\lambda = 1$.\n\nThe parameter range of $\\lambda$ that ensures no growth of boundary modes is $0  \\lambda  1$. The problem asks for the maximum allowable value of $\\lambda$, denoted $\\lambda_{\\max}$. This corresponds to the supremum of the stability interval.\nTherefore, the maximum allowable value is $\\lambda_{\\max} = 1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "The final step in ensuring reliable simulations is the rigorous verification of the implemented code, as theoretical correctness does not always translate to a bug-free implementation. This practice  bridges theory and application by guiding you through the design of a verification test for a characteristic-based non-reflecting boundary condition, a cornerstone of modern CFD solvers. You will apply the principles of hyperbolic theory to check for both well-posedness and the exact preservation of a uniform freestream, a fundamental property that any robust boundary condition must satisfy.",
            "id": "4006581",
            "problem": "You are to design and implement a verification program that tests whether a linearized, characteristic-based nonreflecting boundary condition preserves a spatially uniform freestream exactly for the one-dimensional compressible Navier–Stokes equations in the streamwise direction. The program must base its logic on fundamental laws and well-established facts.\n\nBegin with the compressible Navier–Stokes equations, which for a one-dimensional flow reduce in the inviscid limit to the one-dimensional Euler equations. In a freestream state, the primitive variables $(\\rho,u,p)$ are uniform constants $(\\rho_\\infty,u_\\infty,p_\\infty)$ with ratio of specific heats $\\gamma$, and the sound speed is $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$. In a uniform freestream, spatial gradients vanish, so the viscous fluxes are zero, and the interior evolution is steady. Therefore, any deviation from the uniform freestream must be injected by the boundary conditions. The boundary operator must be compatible with the exact solution, such that it does not inject any deviation when the interior state equals the freestream.\n\nFor the linearized inviscid subsystem in the direction normal to the boundary, the characteristic decomposition yields three wave families with speeds that depend on $(u_\\infty,a_\\infty)$. A boundary is well-posed if and only if the number of scalar boundary conditions enforced equals the number of characteristics entering the domain through that boundary, and these conditions constrain only the incoming characteristic amplitudes.\n\nConsider a generic implementation of nonreflecting boundary conditions that, in the characteristic space, enforces incoming characteristic deviations to be an affine function of outgoing deviations. For a given boundary side, define a linear operator in characteristic space by a matrix $R$ and a vector $c$, acting as\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c,\n$$\nwhere $\\delta w_{\\mathrm{in}}$ is a vector of incoming characteristic deviations, $\\delta w_{\\mathrm{out}}$ is a vector of outgoing characteristic deviations, $R$ is a real matrix of shape $(n_{\\mathrm{in}},n_{\\mathrm{out}})$, and $c$ is a real vector of length $n_{\\mathrm{in}}$. Here, $n_{\\mathrm{in}}$ and $n_{\\mathrm{out}}$ are the respective counts of incoming and outgoing characteristics at the boundary, determined by $(u_\\infty,a_\\infty)$ and the boundary side (left or right). In a uniform freestream, $\\delta w_{\\mathrm{out}} = 0$. Therefore, exact freestream preservation requires $\\delta w_{\\mathrm{in}} = c = 0$.\n\nYour program must, for each test case:\n- Compute $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$.\n- Determine the incoming and outgoing characteristic counts at the boundary from the linearized inviscid eigenvalues in the normal direction and the boundary side. For a left boundary, characteristics with speed greater than zero enter the domain; for a right boundary, characteristics with speed less than zero enter the domain.\n- Verify well-posedness by checking that the number of scalar constraints equals the number of incoming characteristics and that the matrix $R$ has shape $(n_{\\mathrm{in}},n_{\\mathrm{out}})$ with $c$ of length $n_{\\mathrm{in}}$. Report this as an integer, where $1$ means well-posed and $0$ means not well-posed.\n- Verify freestream preservation by computing the normalized residual,\n$$\n\\left\\| \\delta w_{\\mathrm{in}} \\right\\| / a_\\infty = \\left\\| c \\right\\| / a_\\infty,\n$$\nwhere the norm is the Euclidean norm. Report this residual as a dimensionless floating-point number. Since the residual is normalized, there are no physical units in the output.\n\nUse the following test suite of parameter values, which includes a general \"happy path\" case, a boundary condition bias injection case, an ill-posed constraint-count mismatch case, and a supersonic outflow edge case. All quantities use the International System of Units (SI) where applicable.\n\n- Test Case 1 (happy path, subsonic inflow, left boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: left.\n  - $R = \\mathbf{0}$ of shape $(2,1)$, $c = [0.0,\\,0.0]$.\n\n- Test Case 2 (bias injection, subsonic outflow, right boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: right.\n  - $R = \\mathbf{0}$ of shape $(1,2)$, $c = [10^{-6}]$.\n\n- Test Case 3 (ill-posed mismatch, subsonic inflow, left boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 100.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: left.\n  - $R = \\mathbf{0}$ of shape $(3,1)$, $c = [0.0,\\,0.0,\\,0.0]$.\n\n- Test Case 4 (edge case, supersonic outflow, right boundary):\n  - $\\gamma = 1.4$, $\\rho_\\infty = 1.0\\,\\mathrm{kg/m^3}$, $u_\\infty = 500.0\\,\\mathrm{m/s}$, $p_\\infty = 100{,}000.0\\,\\mathrm{Pa}$.\n  - Boundary side: right.\n  - $R = \\mathbf{0}$ of shape $(0,3)$, $c = []$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case $i$, output two values in order: first the normalized residual as a floating point number, then the well-posedness indicator as an integer ($1$ for well-posed, $0$ for not well-posed). Therefore, the final output must be of the form\n$$\n[\\mathrm{res}_1,\\mathrm{wp}_1,\\mathrm{res}_2,\\mathrm{wp}_2,\\mathrm{res}_3,\\mathrm{wp}_3,\\mathrm{res}_4,\\mathrm{wp}_4],\n$$\nwith no additional text.",
            "solution": "The user requests a verification program for nonreflecting boundary conditions (NRBCs) applied to the one-dimensional compressible Navier-Stokes equations. The core of the task is to assess whether a given NRBC formulation is well-posed and whether it perfectly preserves a uniform freestream flow. This analysis is based on the characteristic theory of hyperbolic partial differential equations, applied to the inviscid subsystem (the Euler equations).\n\n**Fundamental Principles**\n\nThe one-dimensional compressible Euler equations, which represent the inviscid limit of the Navier-Stokes equations, form a system of hyperbolic conservation laws. The evolution of the flow solution is governed by the propagation of information along characteristic curves. The speeds of these characteristics are the eigenvalues of the flux Jacobian matrix. For a one-dimensional flow described by primitive variables $(\\rho, u, p)$ (density, velocity, pressure), the characteristic speeds relative to the fluid are $0$, $+a$, and $-a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound and $\\gamma$ is the ratio of specific heats. In a reference frame fixed to the domain, for a uniform freestream flow with velocity $u_\\infty$, the three characteristic speeds (eigenvalues) are:\n$$\n\\lambda_1 = u_\\infty - a_\\infty\n$$\n$$\n\\lambda_2 = u_\\infty\n$$\n$$\n\\lambda_3 = u_\\infty + a_\\infty\n$$\nwhere $a_\\infty = \\sqrt{\\gamma p_\\infty / \\rho_\\infty}$ is the freestream speed of sound.\n\n**Boundary Conditions and Well-Posedness**\n\nAt a boundary of the computational domain, a characteristic is defined as \"incoming\" if it propagates from outside the domain to inside, and \"outgoing\" if it propagates from inside to outside. The number of incoming characteristics, $n_{\\mathrm{in}}$, and outgoing characteristics, $n_{\\mathrm{out}}$, depends on the signs of the eigenvalues $\\lambda_i$. For a system with $3$ characteristics, $n_{\\mathrm{in}} + n_{\\mathrm{out}} = 3$.\n- At a **left boundary** (e.g., at $x=0$ on a domain $[0, L]$), a characteristic is incoming if its speed is positive ($\\lambda_i > 0$).\n- At a **right boundary** (e.g., at $x=L$ on a domain $[0, L]$), a characteristic is incoming if its speed is negative ($\\lambda_i  0$).\n\nA fundamental requirement for a well-posed boundary value problem for a hyperbolic system is that the number of prescribed scalar boundary conditions must be exactly equal to the number of incoming characteristics, $n_{\\mathrm{in}}$. The boundary condition formulation is given as:\n$$\n\\delta w_{\\mathrm{in}} = R \\,\\delta w_{\\mathrm{out}} + c\n$$\nwhere $\\delta w_{\\mathrm{in}}$ and $\\delta w_{\\mathrm{out}}$ are vectors of incoming and outgoing characteristic deviations, respectively. For this formulation to be well-posed, two conditions must be met:\n1. The number of scalar constraints, given by the length of the vector $c$, must equal the number of incoming characteristics calculated from the flow state, $n_{\\mathrm{in}}$.\n2. The matrix $R$, which couples outgoing to incoming waves, must have dimensions consistent with the number of incoming and outgoing characteristics, i.e., its shape must be $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$.\n\n**Freestream Preservation**\n\nIn a uniform freestream, all spatial gradients are zero. This implies that no waves are generated within the domain. Consequently, the outgoing characteristic deviations at any boundary are zero: $\\delta w_{\\mathrm{out}} = 0$. Substituting this into the boundary condition equation yields:\n$$\n\\delta w_{\\mathrm{in}} = R \\cdot 0 + c = c\n$$\nFor the boundary condition to exactly preserve the freestream, it must not spuriously generate incoming waves. This requires $\\delta w_{\\mathrm{in}} = 0$, which in turn demands that the vector $c$ must be the zero vector, $c=0$. Any non-zero $c$ will inject a constant error into the domain over time. The magnitude of this error is quantified by the normalized residual, $\\|c\\| / a_\\infty$, where $\\| \\cdot \\|$ is the Euclidean norm.\n\n**Analysis of Test Cases**\n\nWe now apply these principles to each test case.\n\n**Test Case 1: Subsonic Inflow, Left Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: left. $R$ shape: $(2, 1)$. $c = [0.0, 0.0]$.\n- Freestream sound speed: $a_\\infty = \\sqrt{1.4 \\times 100000.0 / 1.0} = \\sqrt{140000} \\approx 374.166 \\, \\mathrm{m/s}$.\n- Since $|u_\\infty|  a_\\infty$, the flow is subsonic.\n- Characteristic speeds:\n  - $\\lambda_1 = u_\\infty - a_\\infty = 100.0 - 374.166 = -274.166  0$ (outgoing)\n  - $\\lambda_2 = u_\\infty = 100.0  0$ (incoming)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 100.0 + 374.166 = 474.166  0$ (incoming)\n- At a left boundary, positive speeds are incoming. Thus, $n_{\\mathrm{in}} = 2$ and $n_{\\mathrm{out}} = 1$.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$.\n  - Given: $c$ has length $2$, $R$ has shape $(2,1)$.\n  - The length of $c$ ($2$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(2,1)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = [0.0, 0.0]$, so $\\|c\\| = \\sqrt{0.0^2 + 0.0^2} = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$.\n\n**Test Case 2: Subsonic Outflow, Right Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: right. $R$ shape: $(1, 2)$. $c = [10^{-6}]$.\n- Freestream state is identical to Case 1: $a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$, subsonic flow.\n- Characteristic speeds are identical to Case 1: $\\lambda_1  0$, $\\lambda_2  0$, $\\lambda_3  0$.\n- At a right boundary, negative speeds are incoming. Thus, $n_{\\mathrm{in}} = 1$ (from $\\lambda_1$) and $n_{\\mathrm{out}} = 2$ (from $\\lambda_2, \\lambda_3$).\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 1$, $n_{\\mathrm{out}} = 2$.\n  - Given: $c$ has length $1$, $R$ has shape $(1,2)$.\n  - The length of $c$ ($1$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(1,2)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = [10^{-6}]$, so $\\|c\\| = 10^{-6}$.\n  - Residual: $10^{-6} / 374.1657... \\approx 2.6726 \\times 10^{-9}$.\n\n**Test Case 3: Ill-posed Mismatch, Left Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 100.0$, $p_\\infty = 100000.0$. Side: left. $R$ shape: $(3, 1)$. $c = [0.0, 0.0, 0.0]$.\n- Freestream state and characteristic counts are identical to Case 1: $n_{\\mathrm{in}} = 2$ and $n_{\\mathrm{out}} = 1$.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 2$, $n_{\\mathrm{out}} = 1$.\n  - Given: $c$ has length $3$, $R$ has shape $(3,1)$.\n  - The length of $c$ ($3$) does not match $n_{\\mathrm{in}}$ ($2$). This is an over-specified boundary. The condition is not well-posed ($0$).\n- Freestream preservation:\n  - $c = [0.0, 0.0, 0.0]$, so $\\|c\\| = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$. Despite being ill-posed, the specified bias is zero.\n\n**Test Case 4: Supersonic Outflow, Right Boundary**\n- Givens: $\\gamma = 1.4$, $\\rho_\\infty = 1.0$, $u_\\infty = 500.0$, $p_\\infty = 100000.0$. Side: right. $R$ shape: $(0, 3)$. $c = []$.\n- Freestream sound speed: $a_\\infty \\approx 374.166 \\, \\mathrm{m/s}$.\n- Since $u_\\infty  a_\\infty$, the flow is supersonic.\n- Characteristic speeds:\n  - $\\lambda_1 = u_\\infty - a_\\infty = 500.0 - 374.166 = 125.834  0$ (outgoing)\n  - $\\lambda_2 = u_\\infty = 500.0  0$ (outgoing)\n  - $\\lambda_3 = u_\\infty + a_\\infty = 500.0 + 374.166 = 874.166  0$ (outgoing)\n- At a right boundary, negative speeds are incoming. All speeds are positive. Thus, $n_{\\mathrm{in}} = 0$ and $n_{\\mathrm{out}} = 3$. This is a purely outflow boundary.\n- Well-posedness check:\n  - Required: $n_{\\mathrm{in}} = 0$, $n_{\\mathrm{out}} = 3$.\n  - Given: $c$ is an empty vector (length $0$), $R$ has shape $(0,3)$.\n  - The length of $c$ ($0$) matches $n_{\\mathrm{in}}$. The shape of $R$ ($(0,3)$) matches $(n_{\\mathrm{in}}, n_{\\mathrm{out}})$. The condition is well-posed ($1$).\n- Freestream preservation:\n  - $c = []$, so $\\|c\\| = 0.0$.\n  - Residual: $0.0 / a_\\infty = 0.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef verify_bc(gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec):\n    \"\"\"\n    Verifies a nonreflecting boundary condition for well-posedness and\n    freestream preservation.\n\n    Args:\n        gamma (float): Ratio of specific heats.\n        rho_inf (float): Freestream density.\n        u_inf (float): Freestream velocity.\n        p_inf (float): Freestream pressure.\n        side (str): Boundary side, 'left' or 'right'.\n        R_shape (tuple): The (rows, cols) shape of the R matrix.\n        c_vec (list or np.ndarray): The c vector.\n\n    Returns:\n        tuple: A tuple containing (normalized_residual, well_posedness_flag).\n    \"\"\"\n    # Step 1: Compute freestream speed of sound\n    if rho_inf = 0 or p_inf  0:\n        # Invalid physical state, though not expected from problem statement\n        raise ValueError(\"Invalid physical parameters.\")\n    a_inf = np.sqrt(gamma * p_inf / rho_inf)\n\n    # Step 2: Determine incoming and outgoing characteristic counts\n    # Eigenvalues of the 1D Euler system\n    lambda1 = u_inf - a_inf\n    lambda2 = u_inf\n    lambda3 = u_inf + a_inf\n    eigenvalues = [lambda1, lambda2, lambda3]\n\n    n_in = 0\n    if side == 'left':\n        # For a left boundary, incoming waves have positive speed\n        for lam in eigenvalues:\n            if lam  0:\n                n_in += 1\n    elif side == 'right':\n        # For a right boundary, incoming waves have negative speed\n        for lam in eigenvalues:\n            if lam  0:\n                n_in += 1\n    else:\n        raise ValueError(\"Invalid boundary side specified.\")\n    \n    n_out = 3 - n_in\n\n    # Step 3: Verify well-posedness\n    # The number of constraints is the length of the vector c.\n    # The problem specifies R_shape, which implies the dimensions of the operator.\n    n_constraints_given = len(c_vec)\n    R_shape_given = R_shape\n\n    is_well_posed = (n_constraints_given == n_in) and \\\n                    (R_shape_given[0] == n_in) and \\\n                    (R_shape_given[1] == n_out)\n    \n    wp_flag = 1 if is_well_posed else 0\n\n    # Step 4: Verify freestream preservation by computing the normalized residual\n    c_np_vec = np.array(c_vec, dtype=float)\n    norm_c = np.linalg.norm(c_np_vec)\n    \n    # Avoid division by zero, though a_inf should be positive for valid physics\n    residual = norm_c / a_inf if a_inf  0 else 0.0\n\n    return residual, wp_flag\n\ndef solve():\n    \"\"\"\n    Processes the test cases provided in the problem statement and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (gamma, rho_inf, u_inf, p_inf, side, R_shape, c_vec)\n    test_cases = [\n        # Test Case 1 (happy path, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (2, 1), [0.0, 0.0]),\n        # Test Case 2 (bias injection, subsonic outflow, right boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'right', (1, 2), [1e-6]),\n        # Test Case 3 (ill-posed mismatch, subsonic inflow, left boundary)\n        (1.4, 1.0, 100.0, 100000.0, 'left', (3, 1), [0.0, 0.0, 0.0]),\n        # Test Case 4 (edge case, supersonic outflow, right boundary)\n        (1.4, 1.0, 500.0, 100000.0, 'right', (0, 3), [])\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rho, u, p, side, R_shape, c = case\n        res, wp = verify_bc(gamma, rho, u, p, side, R_shape, c)\n        results.append(res)\n        results.append(wp)\n\n    # Format the results into the required string format\n    # Example: [res1,wp1,res2,wp2,...]\n    # Use a flexible format for floats to maintain precision\n    result_str_list = [f\"{x:.15g}\" if isinstance(x, float) else str(x) for x in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}