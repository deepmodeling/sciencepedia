{
    "hands_on_practices": [
        {
            "introduction": "要理解压力敏感性，最直观的方法便是分析纯静水应力状态。本练习将引导你应用Drucker-Prager屈服准则来计算材料在纯静水压力下的屈服点，从而揭示模型参数如何定义材料的静水拉伸和压缩强度 ()。",
            "id": "2674227",
            "problem": "一个均匀、各向同性、对压力敏感的固体通过 Drucker–Prager (DP) 屈服准则进行建模。采用标准的基于不变量的表示法，并以压缩为正。设柯西应力张量为 $\\boldsymbol{\\sigma}$，其第一不变量为 $I_{1}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(\\boldsymbol{\\sigma})$，偏应力为 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} I_{1}(\\boldsymbol{\\sigma}) \\,\\mathbf{I}$，第二不变量为 $J_{2}(\\mathbf{s}) = \\tfrac{1}{2} \\mathbf{s}:\\mathbf{s}$。定义平均（静水）应力为 $p = \\tfrac{1}{3} I_{1}(\\boldsymbol{\\sigma})$。Drucker–Prager 屈服面由两个材料参数 $(\\alpha,k)$ 在不变量空间中定义为一个锥面，该锥面在 $I_{1}$ 和 $\\sqrt{J_{2}}$ 上是线性的，并且关于静水拉伸和压缩对称，使得屈服的开始由以下方程表征\n$$\n\\sqrt{J_{2}(\\mathbf{s})} + \\alpha\\,|I_{1}(\\boldsymbol{\\sigma})| - k = 0.\n$$\n考虑纯静水加载，即 $\\boldsymbol{\\sigma} = p\\,\\mathbf{I}$，包括压缩（$p0$）和拉伸（$p0$）两种情况。仅使用上述定义和给定的 Drucker–Prager 模型形式，确定在压缩和拉伸条件下初始屈服时的静水平均应力，分别表示为 $p_{y}^{\\mathrm{(c)}}$ 和 $p_{y}^{\\mathrm{(t)}}$，其中参数值为 $\\alpha = 0.15$ 和 $k = 30\\,\\text{MPa}$。\n\n将您的最终结果以行矩阵 $\\big(p_{y}^{\\mathrm{(c)}} \\;\\; p_{y}^{\\mathrm{(t)}}\\big)$ 的形式报告，四舍五入至四位有效数字，并以 $\\text{MPa}$ 为单位表示其值。本题不涉及角度。",
            "solution": "所述问题提法明确，具有科学依据，并包含了获得唯一解所需的所有信息。我们将直接进行推导。\n\n应力状态为纯静水加载，由柯西应力张量 $\\boldsymbol{\\sigma} = p\\,\\mathbf{I}$ 定义，其中 $p$ 是平均（静水）应力，$\\mathbf{I}$ 是二阶单位张量。其分量形式为：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} p  0  0 \\\\ 0  p  0 \\\\ 0  0  p \\end{pmatrix}\n$$\n第一步是计算此应力状态下所需的应力不变量。应力张量的第一不变量 $I_{1}(\\boldsymbol{\\sigma})$ 是其迹：\n$$\nI_{1}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = p + p + p = 3p\n$$\n根据问题定义，平均应力 $p$ 通过 $p = \\tfrac{1}{3} I_{1}(\\boldsymbol{\\sigma})$ 与第一不变量相关，这与我们的计算结果一致。\n\n接下来，我们计算偏应力张量 $\\mathbf{s}$，其定义为：\n$$\n\\mathbf{s} = \\boldsymbol{\\sigma} - \\frac{1}{3} I_{1}(\\boldsymbol{\\sigma}) \\,\\mathbf{I}\n$$\n代入静水状态下的 $\\boldsymbol{\\sigma}$ 和 $I_{1}(\\boldsymbol{\\sigma})$ 的表达式：\n$$\n\\mathbf{s} = p\\mathbf{I} - \\frac{1}{3} (3p) \\,\\mathbf{I} = p\\mathbf{I} - p\\mathbf{I} = \\mathbf{0}\n$$\n对于任何静水应力状态，偏应力张量都是零张量。\n\n现在，我们计算偏应力的第二不变量 $J_{2}(\\mathbf{s})$，其定义为 $J_{2}(\\mathbf{s}) = \\tfrac{1}{2} \\mathbf{s}:\\mathbf{s}$。由于 $\\mathbf{s} = \\mathbf{0}$，双点积 $\\mathbf{s}:\\mathbf{s}$ 为零。因此：\n$$\nJ_{2}(\\mathbf{s}) = 0\n$$\n在确定了静水加载的不变量后，我们将它们代入给定的 Drucker–Prager 屈服准则：\n$$\n\\sqrt{J_{2}(\\mathbf{s})} + \\alpha\\,|I_{1}(\\boldsymbol{\\sigma})| - k = 0\n$$\n代入 $J_{2}(\\mathbf{s}) = 0$ 和 $I_{1}(\\boldsymbol{\\sigma}) = 3p$：\n$$\n\\sqrt{0} + \\alpha\\,|3p| - k = 0\n$$\n这可以简化为静水应力下的屈服条件：\n$$\n3\\alpha\\,|p| - k = 0\n$$\n求解屈服时的平均应力大小 $|p|$，我们得到：\n$$\n|p| = \\frac{k}{3\\alpha}\n$$\n现在我们必须根据问题的符号约定来区分压缩屈服和拉伸屈服，其中压缩为正（$p  0$），拉伸为负（$p  0$）。\n\n对于静水压缩，屈服应力表示为 $p_{y}^{\\mathrm{(c)}}$。由于 $p_{y}^{\\mathrm{(c)}}  0$，其绝对值为 $|p_{y}^{\\mathrm{(c)}}| = p_{y}^{\\mathrm{(c)}}$。屈服条件变为：\n$$\np_{y}^{\\mathrm{(c)}} = \\frac{k}{3\\alpha}\n$$\n对于静水拉伸，屈服应力表示为 $p_{y}^{\\mathrm{(t)}}$。由于 $p_{y}^{\\mathrm{(t)}}  0$，其绝对值为 $|p_{y}^{\\mathrm{(t)}}| = -p_{y}^{\\mathrm{(t)}}$。屈服条件变为：\n$$\n-p_{y}^{\\mathrm{(t)}} = \\frac{k}{3\\alpha} \\quad \\implies \\quad p_{y}^{\\mathrm{(t)}} = -\\frac{k}{3\\alpha}\n$$\n因此，包含 $|I_1|$ 的屈服准则的特定形式强制了静水拉伸和压缩下的对称屈服行为，正如问题陈述中所指出的那样。\n\n我们现在代入给定的材料参数值，$\\alpha = 0.15$ 和 $k = 30\\,\\text{MPa}$：\n$$\np_{y}^{\\mathrm{(c)}} = \\frac{30}{3 \\times 0.15} = \\frac{30}{0.45} = \\frac{3000}{45} = \\frac{200}{3}\\,\\text{MPa}\n$$\n$$\np_{y}^{\\mathrm{(t)}} = -\\frac{30}{3 \\times 0.15} = -\\frac{30}{0.45} = -\\frac{200}{3}\\,\\text{MPa}\n$$\n问题要求最终结果四舍五入至四位有效数字。\n$$\n\\frac{200}{3} \\approx 66.666...\n$$\n四舍五入至四位有效数字，我们得到：\n$$\np_{y}^{\\mathrm{(c)}} \\approx 66.67\\,\\text{MPa}\n$$\n$$\np_{y}^{\\mathrm{(t)}} \\approx -66.67\\,\\text{MPa}\n$$\n最终结果以行矩阵 $\\big(p_{y}^{\\mathrm{(c)}} \\;\\; p_{y}^{\\mathrm{(t)}}\\big)$ 的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 66.67  -66.67 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "预测屈服仅仅是塑性力学任务的一半；我们还需要预测塑性流动的方向。本练习深入探讨了塑性流动法则，特别是针对广泛应用的Mohr-Coulomb准则。通过证明在关联流动法则下剪胀角 $\\psi$ 等于摩擦角 $\\phi$ ()，你将掌握此模型的一个基本特性，并将其应用于经典的岩土工程问题中。",
            "id": "2674241",
            "problem": "考虑一个遵循莫尔-库仑屈服准则和关联流动法则的各向同性、理想塑性摩擦性实体。对所有应力和应变均采用压缩为正的符号约定。在轴对称状态下进行分析，主应力满足 $\\sigma_{1} \\ge \\sigma_{2} = \\sigma_{3}$。\n\n(a) 仅使用基本定义，从莫尔-库仑破坏条件的几何定义出发，该条件为一个由摩擦角 $\\phi$ 和内聚力 $c$ 参数化的锥形（在主应力空间中为六边形）曲面。在三轴压缩子午线上，用压力-偏应力不变量 $p = (\\sigma_{1} + \\sigma_{2} + \\sigma_{3})/3$ 和 $q = \\sqrt{\\tfrac{3}{2}\\,s_{ij}s_{ij}}$（其中 $s_{ij} = \\sigma_{ij} - p\\,\\delta_{ij}$）来表达屈服条件。证明在该子午线上，屈服条件可以写成线性形式 $f(p,q) = q - M(\\phi)\\,p - k(\\phi,c) = 0$，其中映射 $\\phi \\mapsto M(\\phi)$ 是严格单调的，并使用关联流动法则 $d\\varepsilon^{p}_{ij} = d\\lambda\\,\\partial f/\\partial \\sigma_{ij}$ 证明塑性剪胀角 $\\psi$ 等于摩擦角 $\\phi$。\n\n(b) 考虑一个排水轴对称三轴压缩试验，试验在恒定围压 $\\sigma_{3}$ 下进行，当前应力状态位于三轴压缩莫尔-库仑屈服面上。材料参数为 $\\phi = 30^{\\circ}$， $c$ 为任意值（其值对于所求的增量不是必需的）。施加一个小的轴向总应变增量 $d\\varepsilon_{1} = 1.0 \\times 10^{-3}$，同时保持 $\\sigma_{2} = \\sigma_{3}$ 恒定（即 $d\\sigma_{2} = d\\sigma_{3} = 0$）。假设该增量在同一三轴压缩面上维持塑性加载，且流动是关联和理想塑性的，计算由此加载产生的塑性体积应变增量 $d\\varepsilon_{v}^{p} = d\\varepsilon_{1}^{p} + d\\varepsilon_{2}^{p} + d\\varepsilon_{3}^{p}$。将最终数值答案表示为一个无量纲的十进制数，并四舍五入到四位有效数字。在推理过程中需要时，请用度表示角度，但最终答案是一个无单位的纯数。",
            "solution": "该问题提法明确，且在摩擦性材料的塑性理论中有坚实的科学基础。我将提供一个完整的解答。\n\n问题分为两部分。 (a) 部分要求推导用应力不变量表示的莫尔-库仑屈服准则，并证明关联流动法则下的剪胀角。 (b) 部分涉及对特定塑性加载增量的计算。全文均使用压缩为正的符号约定。\n\n(a)部分：理论公式\n\n莫尔-库仑屈服准则指出，当某个平面上的剪应力 $\\tau$ 达到一个临界值时，材料发生破坏，该临界值取决于该平面上的法向应力 $\\sigma_n$、材料的内聚力 $c$ 及其内摩擦角 $\\phi$。采用压缩为正的符号约定时，该准则表示为 $|\\tau| = c + \\sigma_n \\tan\\phi$。对于屈服状态，我们可以写成 $\\tau = c + \\sigma_n \\tan\\phi$。\n\n在主应力为 $\\sigma_1 \\ge \\sigma_2 = \\sigma_3$ 的轴对称状态下，临界平面是莫尔应力圆与破坏包线相切的位置。该圆的圆心位于 $(\\frac{\\sigma_1 + \\sigma_3}{2}, 0)$，半径为 $\\frac{\\sigma_1 - \\sigma_3}{2}$。几何上的相切条件由下式给出：\n$$ \\frac{\\sigma_1 - \\sigma_3}{2} = \\left(\\frac{\\sigma_1 + \\sigma_3}{2}\\right) \\sin\\phi + c \\cos\\phi $$\n重新整理该式，可得主应力表示的屈服条件的常见形式：\n$$ \\sigma_1(1-\\sin\\phi) = \\sigma_3(1+\\sin\\phi) + 2c\\cos\\phi $$\n我们需要用第一应力不变量 $p$（静水压力）和第二偏应力不变量 $q$（等效剪应力）来表示该条件。它们定义如下：\n$$ p = \\frac{1}{3}(\\sigma_1 + \\sigma_2 + \\sigma_3) \\quad \\text{and} \\quad q = \\sqrt{\\frac{3}{2} s_{ij}s_{ij}} $$\n其中 $s_{ij} = \\sigma_{ij} - p\\delta_{ij}$ 是偏应力张量。对于轴对称三轴压缩状态（$\\sigma_2 = \\sigma_3$）：\n$$ p = \\frac{1}{3}(\\sigma_1 + 2\\sigma_3) $$\n$$ s_1 = \\sigma_1 - p = \\frac{2}{3}(\\sigma_1 - \\sigma_3), \\quad s_2 = s_3 = \\sigma_3 - p = -\\frac{1}{3}(\\sigma_1 - \\sigma_3) $$\n$$ q = \\sqrt{\\frac{3}{2}(s_1^2 + s_2^2 + s_3^2)} = \\sqrt{\\frac{3}{2}\\left[\\left(\\frac{2}{3}(\\sigma_1 - \\sigma_3)\\right)^2 + 2\\left(-\\frac{1}{3}(\\sigma_1 - \\sigma_3)\\right)^2\\right]} = \\sigma_1 - \\sigma_3 $$\n现在我们可以用 $p$ 和 $q$ 来表示 $\\sigma_1$ 和 $\\sigma_3$：\n$$ q = \\sigma_1 - \\sigma_3 \\quad \\text{and} \\quad 3p = \\sigma_1 + 2\\sigma_3 $$\n解此方程组可得：\n$$ \\sigma_1 = p + \\frac{2}{3}q, \\quad \\sigma_3 = p - \\frac{1}{3}q $$\n将这些代入莫尔-库仑条件：\n$$ \\left(p + \\frac{2}{3}q\\right)(1-\\sin\\phi) = \\left(p - \\frac{1}{3}q\\right)(1+\\sin\\phi) + 2c\\cos\\phi $$\n$$ p(1-\\sin\\phi) - p(1+\\sin\\phi) + q\\left(\\frac{2}{3}(1-\\sin\\phi) + \\frac{1}{3}(1+\\sin\\phi)\\right) = 2c\\cos\\phi $$\n$$ p(-2\\sin\\phi) + q\\left(\\frac{2}{3} - \\frac{2}{3}\\sin\\phi + \\frac{1}{3} + \\frac{1}{3}\\sin\\phi\\right) = 2c\\cos\\phi $$\n$$ -2p\\sin\\phi + q\\left(1 - \\frac{1}{3}\\sin\\phi\\right) = 2c\\cos\\phi $$\n对 $q$ 求解，我们得到三轴压缩子午线上的线性形式：\n$$ q = \\frac{6\\sin\\phi}{3-\\sin\\phi} p + \\frac{6c\\cos\\phi}{3-\\sin\\phi} $$\n这可以写成屈服函数 $f(p,q) = q - M(\\phi)p - k(\\phi,c) = 0$，其中：\n$$ M(\\phi) = \\frac{6\\sin\\phi}{3-\\sin\\phi} \\quad \\text{and} \\quad k(\\phi,c) = \\frac{6c\\cos\\phi}{3-\\sin\\phi} $$\n为了检验映射 $\\phi \\mapsto M(\\phi)$ 的单调性，我们计算它在 $\\phi \\in [0, \\pi/2)$ 上的导数：\n$$ \\frac{dM}{d\\phi} = \\frac{(6\\cos\\phi)(3-\\sin\\phi) - (6\\sin\\phi)(-\\cos\\phi)}{(3-\\sin\\phi)^2} = \\frac{18\\cos\\phi - 6\\sin\\phi\\cos\\phi + 6\\sin\\phi\\cos\\phi}{(3-\\sin\\phi)^2} = \\frac{18\\cos\\phi}{(3-\\sin\\phi)^2} $$\n对于在 $[0, \\pi/2)$ 范围内的 $\\phi$，$\\cos\\phi > 0$。由于 $\\sin\\phi \\le 1$，分母 $(3-\\sin\\phi)^2$ 恒为正。因此，$\\frac{dM}{d\\phi}  0$，这意味着 $M(\\phi)$ 是 $\\phi$ 的一个严格单调递增函数。\n\n为了证明在关联流动法则下塑性剪胀角 $\\psi$ 等于摩擦角 $\\phi$，我们必须使用莫尔-库仑准则本身作为塑性势，而不是像 Drucker-Prager 锥那样的光滑近似。在主应力空间中，莫尔-库仑准则是一个六角锥体。轴对称状态 $\\sigma_1  \\sigma_2 = \\sigma_3$ 对应于该锥体的一条棱（在 $\\pi$ 平面上的一个角点），由两个屈服面的交线形成：\n$g_{13}(\\sigma) = \\sigma_1 - \\sigma_3 N_\\phi - 2c\\sqrt{N_\\phi} = 0$\n$g_{12}(\\sigma) = \\sigma_1 - \\sigma_2 N_\\phi - 2c\\sqrt{N_\\phi} = 0$\n其中 $N_\\phi = \\frac{1+\\sin\\phi}{1-\\sin\\phi} = \\tan^2(45^{\\circ} + \\phi/2)$。\n根据 Koiter 关于角点处关联流动的法则，塑性应变增量矢量 $d\\boldsymbol{\\varepsilon}^p$ 是相交屈服函数梯度的线性组合：\n$$ d\\varepsilon_i^p = d\\lambda_1 \\frac{\\partial g_{13}}{\\partial \\sigma_i} + d\\lambda_2 \\frac{\\partial g_{12}}{\\partial \\sigma_i} \\quad (d\\lambda_1, d\\lambda_2 \\ge 0) $$\n梯度为 $\\nabla g_{13} = (1, 0, -N_\\phi)^T$ 和 $\\nabla g_{12} = (1, -N_\\phi, 0)^T$。塑性应变增量为：\n$d\\varepsilon_1^p = d\\lambda_1(1) + d\\lambda_2(1) = d\\lambda_1 + d\\lambda_2$\n$d\\varepsilon_2^p = d\\lambda_1(0) + d\\lambda_2(-N_\\phi) = -d\\lambda_2 N_\\phi$\n$d\\varepsilon_3^p = d\\lambda_1(-N_\\phi) + d\\lambda_2(0) = -d\\lambda_1 N_\\phi$\n轴对称条件要求 $d\\varepsilon_2^p = d\\varepsilon_3^p$，这意味着 $-d\\lambda_2 N_\\phi = -d\\lambda_1 N_\\phi$，所以 $d\\lambda_1 = d\\lambda_2$。令 $d\\lambda = d\\lambda_1 + d\\lambda_2$。于是，塑性应变增量为：\n$$ d\\varepsilon_1^p = d\\lambda_1 + d\\lambda_1 = 2d\\lambda_1 = d\\lambda $$\n$$ d\\varepsilon_2^p = d\\varepsilon_3^p = -d\\lambda_1 N_\\phi = -\\frac{d\\lambda}{2} N_\\phi $$\n在三轴试验中，剪胀角 $\\psi$ 通过剪胀因子 $N_\\psi = \\frac{1+\\sin\\psi}{1-\\sin\\psi}$ 将塑性体积应变增量 $d\\varepsilon_v^p$ 与轴向塑性应变增量 $d\\varepsilon_1^p$ 联系起来：\n$$ \\frac{d\\varepsilon_v^p}{d\\varepsilon_1^p} = 1 - N_\\psi $$\n让我们从我们推导出的增量来计算这个比率：\n$$ d\\varepsilon_v^p = d\\varepsilon_1^p + d\\varepsilon_2^p + d\\varepsilon_3^p = d\\lambda + 2\\left(-\\frac{d\\lambda}{2} N_\\phi\\right) = d\\lambda(1-N_\\phi) $$\n该比率为：\n$$ \\frac{d\\varepsilon_v^p}{d\\varepsilon_1^p} = \\frac{d\\lambda(1-N_\\phi)}{d\\lambda} = 1 - N_\\phi $$\n将此与定义进行比较，我们发现 $N_\\psi = N_\\phi$。由于映射 $\\phi \\mapsto N_\\phi$ 在 $\\phi \\in [0, \\pi/2)$ 上是严格单调的，因此可以得出 $\\psi = \\phi$。证明完毕。\n\n(b)部分：计算\n\n我们已知一个对理想塑性材料进行的排水三轴试验，材料参数 $\\phi = 30^{\\circ}$ 且流动是关联的。围压保持恒定，因此 $d\\sigma_2 = d\\sigma_3 = 0$。施加的总轴向应变增量为 $d\\varepsilon_1 = 1.0 \\times 10^{-3}$。\n由于材料是理想塑性的，在塑性流动期间，应力状态必须保持在屈服面上。这要求满足一致性条件 $df = 0$。相关的屈服面为 $f(\\sigma_1, \\sigma_3) = \\sigma_1 - N_\\phi \\sigma_3 - 2c\\sqrt{N_\\phi} = 0$。\n屈服函数的增量为：\n$$ df = \\frac{\\partial f}{\\partial \\sigma_1}d\\sigma_1 + \\frac{\\partial f}{\\partial \\sigma_3}d\\sigma_3 = (1)d\\sigma_1 + (-N_\\phi)d\\sigma_3 = 0 $$\n给定 $d\\sigma_3 = 0$，一致性条件意味着 $d\\sigma_1 = 0$。由于 $d\\sigma_1 = d\\sigma_2 = d\\sigma_3 = 0$，应力增量张量 $d\\sigma_{ij}$ 的所有分量均为零。\n总应变增量是弹性和塑性部分之和：$d\\varepsilon_{ij} = d\\varepsilon_{ij}^e + d\\varepsilon_{ij}^p$。弹性应变增量由胡克定律给出，$d\\varepsilon_{ij}^e = C_{ijkl}^{-1} d\\sigma_{kl}$。由于 $d\\sigma_{kl} = 0$，弹性应变增量为零：$d\\varepsilon_{ij}^e = 0$。\n因此，总应变增量完全是塑性的：$d\\varepsilon_{ij} = d\\varepsilon_{ij}^p$。\n给定的轴向应变增量因此就是塑性轴向应变增量：\n$$ d\\varepsilon_1^p = d\\varepsilon_1 = 1.0 \\times 10^{-3} $$\n根据在(a)部分推导的关联流动法则，我们有塑性应变增量的关系。对于轴对称情况，我们有 $d\\varepsilon_2^p=d\\varepsilon_3^p$。\n$$ d\\varepsilon_v^p = d\\varepsilon_1^p (1-N_\\phi) $$\n对于 $\\phi = 30^{\\circ}$，我们有 $\\sin(30^{\\circ}) = 0.5$。\n$$ N_\\phi = \\frac{1 + \\sin(30^{\\circ})}{1 - \\sin(30^{\\circ})} = \\frac{1+0.5}{1-0.5} = \\frac{1.5}{0.5} = 3 $$\n塑性体积应变增量 $d\\varepsilon_v^p$ 是：\n$$ d\\varepsilon_v^p = (1.0 \\times 10^{-3}) \\times (1 - 3) = -2.0 \\times 10^{-3} $$\n负号表示剪胀（体积增加），这与压缩为正的符号约定和非零摩擦角是一致的。\n最终数值答案，四舍五入到四位有效数字，是 $-0.002000$。",
            "answer": "$$ \\boxed{-0.002000} $$"
        },
        {
            "introduction": "本练习将理论模型与计算力学实践联系起来，是通向现代工程仿真的桥梁。在有限元等数值模拟中，本构模型需要通过逐步积分来求解。本练习将指导你推导“返回映射”算法 ()——这是计算塑性力学的核心——让你亲身体验当应力状态试图超出屈服面时，程序是如何将其精确更新的。",
            "id": "2674252",
            "problem": "你需要推导、实现并测试一个用于Drucker-Prager屈服准则的最近点投影算法。该算法在主应力空间中，基于小应变、率无关、关联塑性，并使用线性各向同性弹性。该算法必须从基本定义和定律出发，推导出塑性乘子和主应力的更新方程。然后，你必须将这些方程在一个程序中实现，用以评估一个指定的测试套件。\n\n假设、约定和基本定义：\n- 符号约定：拉为正。主方向上的Cauchy应力张量表示为 $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1,\\sigma_2,\\sigma_3)$。\n- 平均压力：$p = -\\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) = -\\tfrac{1}{3}(\\sigma_1+\\sigma_2+\\sigma_3)$，因此在受压时 $p0$。\n- 偏应力：$\\mathbf{s} = \\boldsymbol{\\sigma} + p \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。\n- 偏应力第二不变量：$J_2 = \\tfrac{1}{2}\\mathbf{s}:\\mathbf{s}$。\n- Mises 等效应力：$q = \\sqrt{3 J_2} = \\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}$。\n- Drucker-Prager 屈服函数：$f(\\boldsymbol{\\sigma}) = q + \\alpha p - \\kappa$，其中 $\\alpha \\ge 0$ 和 $\\kappa \\ge 0$ 是材料参数。\n- 流动法则（关联塑性）：$\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，其中塑性乘子 $\\mathrm{d}\\lambda \\ge 0$。\n- 线性各向同性弹性（Hooke定律）：$\\mathrm{d}\\boldsymbol{\\sigma} = \\mathbb{C} : \\left(\\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}}\\right)$，其中体积模量 $K$ 和剪切模量 $G$ 由 $K = \\dfrac{E}{3(1-2\\nu)}$ 和 $G = \\dfrac{E}{2(1+\\nu)}$ 给出，而 $E$ 是Young模量，$\\nu$ 是Poisson比。\n\n任务1：推导\n- 仅从上述定义和定律出发，推导一个在主应力空间中表达的返回映射（最近点投影）算法，该算法：\n  1. 从给定的试探主应力三元组 $(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}})$ 计算弹性试探状态 $(p_{\\mathrm{tr}}, q_{\\mathrm{tr}}, \\mathbf{s}_{\\mathrm{tr}})$。\n  2. 检验屈服条件 $f_{\\mathrm{tr}} = q_{\\mathrm{tr}} + \\alpha p_{\\mathrm{tr}} - \\kappa$。\n  3. 如果 $f_{\\mathrm{tr}} \\le 0$，则保持状态为弹性。\n  4. 如果 $f_{\\mathrm{tr}}  0$，使用最近点投影返回到屈服面，推导出塑性乘子增量 $\\Delta\\lambda$ 和更新后的应力状态 $(p_{n+1}, q_{n+1}, \\mathbf{s}_{n+1})$ 及其对应更新后的主应力 $(\\sigma_{1,n+1},\\sigma_{2,n+1},\\sigma_{3,n+1})$ 的显式更新方程。\n  5. 当 $f_{\\mathrm{tr}}  0$ 时，识别并正确处理 $q_{\\mathrm{tr}} = 0$（纯静水试探状态）的特殊情况。\n\n你的推导必须仅使用上述基本原理清晰地表达每一步，并且你的最终更新方程必须完全用 $(p_{\\mathrm{tr}}, q_{\\mathrm{tr}})$、$K$、$G$、$\\alpha$ 和 $\\kappa$ 的显式形式表达。\n\n任务2：实现\n- 在一个在主应力空间中操作的程序中实现所推导的算法。每个案例的输入是一个试探主应力三元组 $(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}})$（单位为兆帕，MPa），以及全局材料参数 $E$、$\\nu$、$\\alpha$、$\\kappa$。\n- 所有应力和模量均使用单位 MPa。不涉及角度，因此不需要角度单位。\n- 为保证数值稳健性，使用一个小的非负容差来处理位于屈服面上的情况：如果 $f_{\\mathrm{tr}} \\le 10^{-10}$，则认为状态是弹性的。\n- 当 $q_{\\mathrm{tr}}$ 小于一个小的容差（使用 $10^{-12}$）且 $f_{\\mathrm{tr}}  0$ 时，将返回过程视为纯体积的。\n\n测试套件（所有应力单位为 MPa；所有案例使用相同的材料参数）：\n- 所有测试共用的材料参数：\n  - Young模量 $E = 200000$ MPa，\n  - Poisson比 $\\nu = 0.30$（无量纲），\n  - Drucker-Prager 参数 $\\alpha = 0.20$（无量纲），$\\kappa = 60.0$ MPa。\n- 试探主应力三元组：\n  1. 弹性基线：$(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}}) = (10.0, 10.0, 10.0)$。\n  2. 一般塑性情况：$(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}}) = (120.0, 60.0, -30.0)$。\n  3. 超过屈服的纯静水压情况：$(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}}) = (-400.0, -400.0, -400.0)$。\n  4. 恰好在屈服面上：选择 $p = 100.0$ MPa 和 $q = 40.0$ MPa。一个一致的主应力试探状态是 $(\\sigma_{1,\\mathrm{tr}},\\sigma_{2,\\mathrm{tr}},\\sigma_{3,\\mathrm{tr}}) = (-73.3333333333, -113.3333333333, -113.3333333333)$。\n\n每个测试用例的所需输出：\n- 对于每个测试用例，计算并返回一个包含四个浮点数的列表，四舍五入到六位小数：\n  1. 塑性乘子增量 $\\Delta\\lambda$（无量纲），\n  2. 更新后的主应力 $(\\sigma_{1,n+1},\\sigma_{2,n+1},\\sigma_{3,n+1})$，单位为 MPa。\n\n最终输出格式要求：\n- 你的程序应生成单行输出，其中包含四个测试用例的结果，格式为由逗号分隔的列表的列表，并用方括号括起来，每个数值条目四舍五入到六位小数。例如：\"[[dl1,s11,s21,s31],[dl2,s12,s22,s32],[dl3,s13,s23,s33],[dl4,s14,s24,s34]]\"，其中 \"dlk\" 是案例 $k$ 的塑性乘子增量，$(s1k,s2k,s3k)$ 是案例 $k$ 的更新后主应力，单位为 MPa。",
            "solution": "该问题要求推导并实现Drucker-Prager屈服准则的最近点投影算法。推导过程必须遵循问题陈述中列出的第一性原理。\n\n任务的核心是对于给定的应变增量，将应力状态从弹性试探状态 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ 更新到最终容许状态 $\\boldsymbol{\\sigma}_{n+1}$。该框架是使用隐式后向欧拉格式积分的率无关关联塑性。\n\n最终应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 必须满足约束优化的Karush-Kuhn-Tucker (KKT) 条件：\n1. 屈服条件：$f(\\boldsymbol{\\sigma}_{n+1}) \\le 0$\n2. 塑性乘子：$\\Delta\\lambda \\ge 0$\n3. 一致性条件：$\\Delta\\lambda f(\\boldsymbol{\\sigma}_{n+1}) = 0$\n\n次弹性本构律的后向欧拉积分给出了试探应力与最终应力之间的关系：\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}} $$\n其中 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ 是弹性预测值，$\\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}}$ 是塑性应变增量。关联流动法则给出：\n$$ \\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}} $$\n结合这些，得到基本的返回映射方程：\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\Delta\\lambda \\, \\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}} $$\n\n算法流程如下：\n\n首先，从给定的试探主应力 $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\mathrm{diag}(\\sigma_{1,\\mathrm{tr}}, \\sigma_{2,\\mathrm{tr}}, \\sigma_{3,\\mathrm{tr}})$，我们计算试探不变量。平均应力为 $\\sigma_{\\mathrm{m,tr}} = \\frac{1}{3}(\\sigma_{1,\\mathrm{tr}} + \\sigma_{2,\\mathrm{tr}} + \\sigma_{3,\\mathrm{tr}})$，压力为 $p_{\\mathrm{tr}} = -\\sigma_{\\mathrm{m,tr}}$。偏应力张量为 $\\mathbf{s}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\sigma_{\\mathrm{m,tr}}\\mathbf{I}$。Mises等效应力为 $q_{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\mathbf{s}_{\\mathrm{tr}}:\\mathbf{s}_{\\mathrm{tr}}}$。\n\n第二，我们通过计算试探状态下的屈服函数来检查塑性流动：$f_{\\mathrm{tr}} = q_{\\mathrm{tr}} + \\alpha p_{\\mathrm{tr}} - \\kappa$。如果 $f_{\\mathrm{tr}} \\le 0$，则该步为弹性。无需进行塑性修正。因此，$\\Delta\\lambda = 0$ 且 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$。\n\n第三，如果 $f_{\\mathrm{tr}}  0$，则需要进行塑性修正。我们必须求解 $\\Delta\\lambda$ 和 $\\boldsymbol{\\sigma}_{n+1}$。我们区分两种情况。\n\n情况1：一般返回 ($q_{\\mathrm{tr}}  0$)\n需要屈服函数的梯度：\n$$ \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} $$\n使用 $q = \\sqrt{3 J_2}$ 和 $p = -\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$，我们发现：\n$$ \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\mathbf{s} \\quad \\text{和} \\quad \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = -\\frac{1}{3}\\mathbf{I} $$\n因此，流动向量为：\n$$ \\mathbf{r}_{n+1} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}} = \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} - \\frac{\\alpha}{3}\\mathbf{I} $$\n对于线性各向同性弹性材料，刚度张量 $\\mathbb{C}$ 作用于对称张量 $\\mathbf{A}$ 的结果是 $\\mathbb{C}:\\mathbf{A} = 2G\\mathbf{A}_{\\mathrm{dev}} + K\\,\\mathrm{tr}(\\mathbf{A})\\mathbf{I}$，其中 $\\mathbf{A}_{\\mathrm{dev}}$ 是 $\\mathbf{A}$ 的偏量部分。将此应用于流动向量 $\\mathbf{r}_{n+1}$，其偏量部分为 $\\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1}$，迹为 $\\mathrm{tr}(\\mathbf{r}_{n+1}) = -\\alpha$，得到：\n$$ \\mathbb{C} : \\mathbf{r}_{n+1} = 2G \\left( \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} \\right) + K(-\\alpha)\\mathbf{I} = \\frac{3G}{q_{n+1}}\\mathbf{s}_{n+1} - K\\alpha\\mathbf{I} $$\n将此代入返回映射方程：\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\Delta\\lambda \\left( \\frac{3G}{q_{n+1}}\\mathbf{s}_{n+1} - K\\alpha\\mathbf{I} \\right) $$\n我们将此方程分解为偏量部分和体积部分。注意 $\\boldsymbol{\\sigma} = \\mathbf{s} - p\\mathbf{I}$。\n$$ \\mathbf{s}_{n+1} - p_{n+1}\\mathbf{I} = \\mathbf{s}_{\\mathrm{tr}} - p_{\\mathrm{tr}}\\mathbf{I} - \\Delta\\lambda \\frac{3G}{q_{n+1}}\\mathbf{s}_{n+1} + \\Delta\\lambda K\\alpha\\mathbf{I} $$\n令偏量部分相等：\n$$ \\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - \\Delta\\lambda \\frac{3G}{q_{n+1}}\\mathbf{s}_{n+1} \\implies \\mathbf{s}_{n+1} \\left( 1 + \\frac{3G\\Delta\\lambda}{q_{n+1}} \\right) = \\mathbf{s}_{\\mathrm{tr}} $$\n这个关系意味着 $\\mathbf{s}_{n+1}$ 与 $\\mathbf{s}_{\\mathrm{tr}}$ 共轴。因此，我们可以写出 $\\mathbf{s}_{n+1} = (\\text{scalar}) \\times \\mathbf{s}_{\\mathrm{tr}}$，这也意味着它们的范数由相同的标量关联：$q_{n+1} = (\\text{scalar}) \\times q_{\\mathrm{tr}}$。从上面的方程，我们推导出Mises应力的更新公式：\n$$ q_{n+1} = q_{\\mathrm{tr}} - 3G\\Delta\\lambda $$\n令体积（或静水）部分相等：\n$$ -p_{n+1}\\mathbf{I} = -p_{\\mathrm{tr}}\\mathbf{I} + \\Delta\\lambda K\\alpha\\mathbf{I} \\implies p_{n+1} = p_{\\mathrm{tr}} - K\\alpha\\Delta\\lambda $$\n最终状态必须位于屈服面上，所以 $f(\\boldsymbol{\\sigma}_{n+1}) = q_{n+1} + \\alpha p_{n+1} - \\kappa = 0$。代入 $p_{n+1}$ 和 $q_{n+1}$ 的更新方程：\n$$ (q_{\\mathrm{tr}} - 3G\\Delta\\lambda) + \\alpha (p_{\\mathrm{tr}} - K\\alpha\\Delta\\lambda) - \\kappa = 0 $$\n$$ (q_{\\mathrm{tr}} + \\alpha p_{\\mathrm{tr}} - \\kappa) - \\Delta\\lambda(3G + K\\alpha^2) = 0 $$\n第一个括号中的项是 $f_{\\mathrm{tr}}$。求解 $\\Delta\\lambda$：\n$$ \\Delta\\lambda = \\frac{f_{\\mathrm{tr}}}{3G + K\\alpha^2} $$\n已知 $\\Delta\\lambda$ 后，我们计算更新后的不变量 $p_{n+1}$ 和 $q_{n+1}$。最终的应力张量被重构。偏应力被径向缩回：\n$$ \\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} \\left( 1 - \\frac{3G\\Delta\\lambda}{q_{\\mathrm{tr}}} \\right) = \\mathbf{s}_{\\mathrm{tr}} \\frac{q_{n+1}}{q_{\\mathrm{tr}}} $$\n更新后的平均应力为 $\\sigma_{\\mathrm{m},n+1} = -p_{n+1}$。最终的主应力为：\n$$ \\sigma_{i,n+1} = s_{i,n+1} + \\sigma_{\\mathrm{m},n+1} = \\frac{q_{n+1}}{q_{\\mathrm{tr}}} s_{i,\\mathrm{tr}} - p_{n+1} $$\n\n情况2：顶点返回 ($q_{\\mathrm{tr}} \\approx 0$)\n当试探状态为纯静水压状态时（$q_{\\mathrm{tr}}=0$），梯度 $\\partial q / \\partial \\boldsymbol{\\sigma}$ 未定义，因为屈服面有一个锥形顶点。如果 $f_{\\mathrm{tr}} = \\alpha p_{\\mathrm{tr}} - \\kappa  0$，状态位于屈服锥外沿静水压力轴。必须返回到顶点。\n顶点由 $q=0$ 和屈服条件 $f=0$ 定义，这给出 $\\alpha p - \\kappa = 0$，或 $p = \\kappa / \\alpha$。\n所以，最终状态是 $\\boldsymbol{\\sigma}_{n+1} = \\sigma_{\\mathrm{m},n+1} \\mathbf{I}$，其中 $\\sigma_{\\mathrm{m},n+1} = -p_{n+1} = -\\kappa/\\alpha$。\n对于这种纯体积塑性修正，偏塑性应变为零，流动是纯体积的。体积更新方程仍然有效：$p_{n+1} = p_{\\mathrm{tr}} - K\\alpha\\Delta\\lambda$。\n代入已知的最终压力 $p_{n+1} = \\kappa/\\alpha$：\n$$ \\frac{\\kappa}{\\alpha} = p_{\\mathrm{tr}} - K\\alpha\\Delta\\lambda \\implies \\Delta\\lambda = \\frac{p_{\\mathrm{tr}} - \\kappa/\\alpha}{K\\alpha} = \\frac{\\alpha p_{\\mathrm{tr}} - \\kappa}{K\\alpha^2} $$\n注意到对于这种情况 $f_{\\mathrm{tr}} = \\alpha p_{\\mathrm{tr}} - \\kappa$：\n$$ \\Delta\\lambda = \\frac{f_{\\mathrm{tr}}}{K\\alpha^2} $$\n至此算法完成。在实现中使用一个小容差来在一般返回和顶点返回逻辑之间切换。如果一般情况下的返回算法预测出负的 $q_{n+1}$，这表明试探状态需要返回到顶点，这种情况在所提供的测试套件中没有遇到，但对于一个通用的稳健算法是必须考虑的。",
            "answer": "[[0.000000,10.000000,10.000000,10.000000],[0.000256,96.918721,64.014787,14.658887],[0.003000,-300.000000,-300.000000,-300.000000],[0.000000,-73.333333,-113.333333,-113.333333]]"
        }
    ]
}