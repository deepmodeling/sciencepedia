{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您运用一个基本而强大的工具——叠加原理——来解决接触力学问题。我们将从经典的Boussinesq点载荷解答出发，通过积分来计算一个均匀分布的圆形压力区域所引起的表面位移。这项练习对于理解如何将复杂载荷分解为无限小的简单载荷，并建立对格林函数概念的直观认识至关重要。",
            "id": "2620650",
            "problem": "考虑一个占据 $z \\ge 0$ 区域的各向同性、均匀、线弹性半空间，其杨氏模量为 $E$，泊松比为 $\\nu$。其表面 $z=0$ 除一个圆形区域 $\\{(x,y): x^{2}+y^{2} \\le a^{2}\\}$ 外无牵引力，在该圆形区域上施加了均匀的法向压力 $p$。没有切向牵引力。利用叠加原理以及法向点载荷的经典半空间格林函数（Boussinesq 问题），从第一性原理推导此加载区域的法向表面柔度 $C(a)$ 的一个显式闭合形式表达式。柔度定义为加载区域中心的竖向位移与总载荷之比，即\n$$\nC(a) \\equiv \\frac{w(0)}{P}, \\quad P \\equiv \\int_{x^{2}+y^{2}\\le a^{2}} p \\, \\mathrm{d}A = \\pi a^{2} p.\n$$\n您的推导必须从线弹性场方程和叠加原理开始，并应阐明 Boussinesq 点载荷解与区域柔度之间的逻辑联系。将您的最终结果表示为用 $E$、$\\nu$ 和 $a$ 表示的单个解析表达式。不要将中间公式作为最终答案。最终答案必须是单个闭合形式的表达式。无需进行数值计算，也无需在最终答案中报告单位。",
            "solution": "经验证，该问题陈述具有科学依据、提法恰当且客观。它提出了线弹性理论中的一个经典问题，特别是关于弹性半空间上的接触力学问题。该问题是自洽的，没有矛盾。我们将按照要求，从第一性原理进行严格推导。\n\n本分析的基础是 Boussinesq 问题，该问题为各向同性、均匀、线弹性半空间在其表面受到集中法向点载荷作用下的应力和位移场提供了解决方案。设半空间占据区域 $z \\ge 0$。一个大小为 $P_0$ 的点载荷作用于原点 $(0,0,0)$，方向为负 $z$ 方向。在表面 $z=0$ 上，距离作用点径向距离为 $r = \\sqrt{x^2 + y^2}$ 处的竖向位移 $w(r)$ 由以下基本解给出：\n$$\nw(r) = \\frac{P_0 (1 - \\nu^2)}{\\pi E r}\n$$\n其中 $E$ 是弹性材料的杨氏模量，$\\nu$ 是泊松比。该表达式可作为由法向点载荷引起的竖向表面位移的格林函数。\n\n该问题描述了一个均匀法向压力 $p$ 分布在以原点为中心、半径为 $a$ 的圆形区域上。叠加原理对线弹性系统是有效的，它允许我们通过在整个加载区域上对无穷小点載荷的影响进行积分来确定任意点的总位移。\n\n考虑圆形区域 $D = \\{(\\xi, \\eta) : \\xi^2 + \\eta^2 \\le a^2\\}$ 内位于点 $(\\xi, \\eta)$ 的一个无穷小面积元 $dA'$。该面积元承受一个无穷小的法向力 $dP = p \\, dA'$。这个力可以被视为一个集中的点载荷。\n\n我们需要求解区域中心的竖向位移 $w(0)$，即点 $(x=0, y=0)$ 处的位移。从源点 $(\\xi, \\eta)$ 到场点 $(0,0)$ 的距离为 $r' = \\sqrt{\\xi^2 + \\eta^2}$。由位于 $(\\xi, \\eta)$ 的无穷小载荷 $dP$ 对中心竖向位移的贡献 $dw(0)$ 可通过应用 Boussinesq 公式得到：\n$$\ndw(0) = \\frac{dP (1 - \\nu^2)}{\\pi E r'} = \\frac{p \\, dA' (1 - \\nu^2)}{\\pi E r'}\n$$\n为了求得总的竖向位移 $w(0)$，我们必须在整个圆形域 $D$ 上对该表达式进行积分：\n$$\nw(0) = \\iint_D \\frac{p (1 - \\nu^2)}{\\pi E r'} \\, dA'\n$$\n使用极坐标进行积分最为方便。设源点由 $(\\rho', \\phi')$ 描述，其中 $\\xi = \\rho' \\cos \\phi'$ 且 $\\eta = \\rho' \\sin \\phi'$。在此坐标系中，到原点的距离为 $r' = \\rho'$，无穷小面积元为 $dA' = \\rho' \\, d\\rho' \\, d\\phi'$。积分限为 $0 \\le \\rho' \\le a$ 和 $0 \\le \\phi' \\le 2\\pi$。\n\n将这些代入 $w(0)$ 的积分式，我们得到：\n$$\nw(0) = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{p (1 - \\nu^2)}{\\pi E \\rho'} (\\rho' \\, d\\rho' \\, d\\phi')\n$$\n一个关键的简化发生了，面积元中的项 $\\rho'$ 与格林函数分母中的项 $\\rho'$ 相消。被积函数相对于积分变量变为常数：\n$$\nw(0) = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{p (1 - \\nu^2)}{\\pi E} \\, d\\rho' \\, d\\phi'\n$$\n我们可以分離积分并直接计算它们：\n$$\nw(0) = \\frac{p (1 - \\nu^2)}{\\pi E} \\left( \\int_{0}^{2\\pi} d\\phi' \\right) \\left( \\int_{0}^{a} d\\rho' \\right)\n$$\n这些初等积分的计算结果为：\n$$\n\\int_{0}^{2\\pi} d\\phi' = 2\\pi, \\quad \\int_{0}^{a} d\\rho' = a\n$$\n将这些结果代回 $w(0)$ 的表达式：\n$$\nw(0) = \\frac{p (1 - \\nu^2)}{\\pi E} (2\\pi)(a) = \\frac{2pa(1 - \\nu^2)}{E}\n$$\n这就是加载圆形区域中心的竖向位移。\n\n问题将柔度 $C(a)$ 定义为该中心位移与总载荷 $P$ 之比。总载荷 $P$ 是均匀压力 $p$ 在圆形面积 $\\pi a^2$ 上的积分：\n$$\nP = p (\\pi a^2)\n$$\n由此，我们用总载荷 $P$ 来表示压力 $p$：\n$$\np = \\frac{P}{\\pi a^2}\n$$\n现在，将这个 $p$ 的表达式代入 $w(0)$ 的公式中：\n$$\nw(0) = \\frac{2 \\left( \\frac{P}{\\pi a^2} \\right) a (1 - \\nu^2)}{E} = \\frac{2P(1 - \\nu^2)}{\\pi a E}\n$$\n最后，我们根据其定义计算柔度 $C(a)$：\n$$\nC(a) \\equiv \\frac{w(0)}{P} = \\frac{1}{P} \\left( \\frac{2P(1 - \\nu^2)}{\\pi a E} \\right)\n$$\n总载荷 $P$ 被消去，得到法向表面柔度的最终表达式：\n$$\nC(a) = \\frac{2(1 - \\nu^2)}{\\pi a E}\n$$\n根据要求，该结果是材料特性 $E$ 和 $\\nu$ 以及加载区域半径 $a$ 的函数。",
            "answer": "$$\n\\boxed{\\frac{2(1 - \\nu^{2})}{\\pi a E}}\n$$"
        },
        {
            "introduction": "在经典方法的基础上，本练习将探索一种更为强大且计算效率更高的方法：基于傅里叶变换的谱方法。您将学习如何将半空间上的线弹性问题在频域中进行优雅地求解，从而避免复杂的空间卷积运算。这项综合性练习不仅涵盖了理论推导，还将指导您完成完整的计算实现，包括使用正则化处理奇点，并将您的代码与解析解进行验证，是连接高等理论与实用数值模拟的绝佳实践。",
            "id": "2620658",
            "problem": "考虑一个各向同性的、均匀的线性弹性半空间，其占据区域 $z \\ge 0$，特征为杨氏模量 $E$ 和泊松比 $\\nu$。令 $\\mu$ 和 $\\lambda$ 表示拉梅参数。$z=0$ 处的表面承受指定的法向牵引分布 $t_z(x,y)$，无切向牵引。目标是使用物理上合理的格林核表示来计算产生的垂向表面位移 $w(x,y) = u_z(x,y, z=0)$，并处理奇异核的计算方面和正则化问题。\n\n从第一性原理出发，使用以下基础：\n- 无体力情况下的静力平衡纳维方程：$\\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{u}$ 是位移场。\n- $z=0$ 上的牵引-位移边界条件。\n- 平行于表面的平移不变性，使得可以在平面 $z=0$ 上进行二维傅里叶分析。\n- 通过空间域中的格林核实现的解的卷积表示，及其在谱域中的等效乘法。\n- 使用磨光函数作为奇异核的正则化工具的概念，特别是归一化的格斯函数。\n\n您的任务：\n1. 从上述基础出发，推导将法向牵引 $t_z(x,y)$ 的二维傅里叶变换映射到产生的表面法向位移 $w(x,y)$ 的二维傅里叶变换的谱关系。用波数大小 $k = \\sqrt{k_x^2 + k_y^2}$ 和接触模量 $E^\\star = E/(1-\\nu^2)$ 表示该关系。证明与 $1/k$ 成正比的非局部柔度的出现是合理的。\n2. 使用逆变换得到 $w(x,y)$ 对应的空间域卷积定律，其标量核仅依赖于面内距离 $r = \\sqrt{x^2 + y^2}$。解释 $1/r$ 奇异性的来源。\n3. 通过将总力为 $P$ 的点载荷建模为标准差为 $\\varepsilon$ 的归一化高斯磨光函数 $\\rho_\\varepsilon(x,y)$ 来引入正则化，使得 $t_z(x,y) = P \\rho_\\varepsilon(x,y)$ 且 $\\int_{\\mathbb{R}^2} \\rho_\\varepsilon \\, \\mathrm{d}x \\mathrm{d}y = 1$。推导加载中心处的正则化自位移 $w(\\mathbf{0})$ 作为 $P$、$E^\\star$ 和 $\\varepsilon$ 的函数的解析表达式。说明当 $\\varepsilon \\to 0^+$ 时的收敛行为。\n4. 对于施加在以原点为中心的半径为 $a$ 的圆形区域上的均匀压力 $p$，使用步骤2中的空间卷积定律推导中心位移 $w(\\mathbf{0})$ 的精确表达式。\n5. 设计并实现一种数值算法，该算法使用二维离散傅里叶变换在边长为 $L$ 的方形周期性计算单元上计算 $w(x,y)$，该计算单元在 $N \\times N$ 网格上离散化，网格间距为 $\\Delta x = L/N$。对于法向载荷，使用步骤1中的谱柔度，并将零波数项设置为零，以消除周期性延拓产生的非物理刚体模式。讨论周期性镜像和截断对精度的影响，以及正则化的作用。您的实现必须：\n   - 在网格上构造下面指定的牵引场，中心位于 $(x,y)=(0,0)$。\n   - 对于高斯载荷，重新缩放离散牵引，使离散总力高精度地等于指定的 $P$。\n   - 计算 $w(\\mathbf{0})$ 的数值近似值。\n   - 与相应的解析表达式进行比较并报告相对误差。\n\n物理单位：所有长度必须以米为单位，牵引以帕斯卡为单位，力以牛顿为单位，位移以米为单位。角度无需使用。要求的输出是无量纲的相对误差。\n\n测试套件和要求的输出：\n- 使用材料参数 $E = 70 \\times 10^9$ Pa 和 $\\nu = 0.25$，因此 $E^\\star = E/(1-\\nu^2)$。\n- 使用边长为 $L = 1.0$ 米的方形计算单元，每个方向有 $N = 512$ 个网格点。\n- 定义三个测试案例：\n  1. 总力为 $P = 1000$ N、标准差为 $\\varepsilon = 0.020$ 米的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤3中推导的解析表达式之间的相对误差。\n  2. 在以原点为中心的半径为 $a = 0.040$ 米的圆形区域上施加均匀压力 $p = 2.0 \\times 10^6$ Pa。计算数值解 $w(\\mathbf{0})$ 与步骤4中推导的解析表达式之间的相对误差。\n  3. 总力为 $P = 1000$ N、标准差为 $\\varepsilon = 0.005$ 米的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤3中推导的解析表达式之间的相对误差。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果：$[\\text{err}_1,\\text{err}_2,\\text{err}_3]$，其中每个 $\\text{err}_i$ 是定义为 $\\lvert w_{\\text{num}} - w_{\\text{an}} \\rvert / \\lvert w_{\\text{an}} \\rvert$ 的相对误差，并以浮点数形式表示。",
            "solution": "问题陈述是线性弹性和计算力学中一个适定且科学合理的问题，具体涉及弹性半空间的 Boussinesq 问题。该问题是有效的，可以按如下方式求解。以下步骤对应于问题中概述的任务。\n\n首先，我们定义将要使用的材料参数和常数。弹性半空间的特征是杨氏模量 $E$ 和泊松比 $\\nu$。拉梅参数通过 $\\mu = E / (2(1+\\nu))$ 和 $\\lambda = E\\nu / ((1+\\nu)(1-2\\nu))$ 相关联。接触模量，或称平面应变模量，定义为 $E^\\star = E / (1-\\nu^2)$。\n\n### 1. 谱关系的推导\n\n我们从无体力情况下的静力平衡纳维方程开始：\n$$ \\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0} $$\n其中 $\\mathbf{u}(\\mathbf{x}, z)$ 是位移场。我们在空间坐标 $(x,y)$ 上应用二维傅里叶变换。函数 $f(x,y)$ 的变换记为 $\\hat{f}(k_x, k_y)$：\n$$ \\hat{f}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{x} $$\n其中 $\\mathbf{x}=(x,y)$ 且 $\\mathbf{k}=(k_x, k_y)$。算子变换为 $\\nabla \\to (i k_x, i k_y, \\partial_z)$ 和 $\\nabla^2 \\to (-k^2 + \\partial_z^2)$，其中 $k = \\sqrt{k_x^2+k_y^2}$ 是波数大小。这将偏微分方程组转化为关于变换后位移分量 $\\hat{\\mathbf{u}}(\\mathbf{k}, z)$ 的常微分方程组。\n\n当 $z \\to \\infty$ 时衰减的这些常微分方程的通解可以表示为：\n$$ \\hat{u}_j(\\mathbf{k}, z) = (A_j + z B_j) e^{-kz} $$\n将此代入变换后的纳维方程会产生关于系数 $A_j$ 和 $B_j$ 的代数约束。一个更方便的方法是使用弹性理论中的已知结果。法向载荷下变换后位移的解由下式给出：\n$$ \\hat{u}_x(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_x}{k} $$\n$$ \\hat{u}_y(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_y}{k} $$\n$$ \\hat{u}_z(\\mathbf{k}, z) = C(\\mathbf{k}) (2(1-\\nu) + kz) e^{-kz} $$\n系数 $C(\\mathbf{k})$ 由表面 $z=0$ 处的边界条件确定。边界条件是切向牵引为零（$\\sigma_{xz}=\\sigma_{yz}=0$）和指定的法向牵引 $\\sigma_{zz}(x,y,0) = t_z(x,y)$。相关的应力分量是 $\\sigma_{zz}$，根据 Hooke 定律，用位移表示为：\n$$ \\sigma_{zz} = \\lambda(\\partial_x u_x + \\partial_y u_y + \\partial_z u_z) + 2\\mu \\partial_z u_z $$\n应用傅里叶变换得到：\n$$ \\hat{\\sigma}_{zz}(\\mathbf{k},z) = \\lambda(ik_x \\hat{u}_x + ik_y \\hat{u}_y + \\partial_z \\hat{u}_z) + 2\\mu \\partial_z \\hat{u}_z $$\n我们使用 $\\hat{u}_j$ 的表达式在 $z=0$ 处计算该值。导数为：\n$$ \\partial_z \\hat{u}_z |_{z=0} = C(\\mathbf{k})(-k(2(1-\\nu)) + k) = C(\\mathbf{k})k(1-2(1-\\nu)) = -C(\\mathbf{k})k(1-2\\nu) $$\n面内位移的散度为：\n$$ ik_x \\hat{u}_x + ik_y \\hat{u}_y |_{z=0} = C(\\mathbf{k}) (1-2\\nu) \\frac{i^2(k_x^2+k_y^2)}{k} = -C(\\mathbf{k})k(1-2\\nu) $$\n将这些代入 $z=0$ 处的 $\\hat{\\sigma}_{zz}$ 表达式中：\n$$ \\hat{t}_z(\\mathbf{k}) = \\hat{\\sigma}_{zz}(\\mathbf{k},0) = \\lambda(-C(\\mathbf{k})k(1-2\\nu)) + (\\lambda+2\\mu)(-C(\\mathbf{k})k(1-2\\nu)) = -2(\\lambda+\\mu)C(\\mathbf{k})k(1-2\\nu) $$\n使用关系式 $\\lambda+\\mu=\\mu/(1-2\\nu)$，这可以简化为：\n$$ \\hat{t}_z(\\mathbf{k}) = -2\\mu C(\\mathbf{k}) k $$\n因此，我们可以解出 $C(\\mathbf{k}) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n表面法向位移是 $w(x,y) = u_z(x,y,0)$，所以其变换是 $\\hat{w}(\\mathbf{k}) = \\hat{u}_z(\\mathbf{k},0)$。从通解得到：\n$$ \\hat{w}(\\mathbf{k}) = C(\\mathbf{k}) \\cdot 2(1-\\nu) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k} \\cdot 2(1-\\nu) = -\\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{-k} $$\n在经典文献表述中存在一个符号错误。一个向下的力 $P$（负牵引）应导致一个向下的位移 $w$（负）。我们将 $t_z$ 定义为压力（向下为正）。表面法线向上，因此 $\\sigma_{zz} = -t_z$。\n那么 $\\hat{\\sigma}_{zz}(\\mathbf{k},0) = -\\hat{t}_z(\\mathbf{k})$，所以 $C(\\mathbf{k}) = \\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n这得到 $\\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{k}$。这是在 $+z$ 方向的压力 $t_z$ 引起的 $+z$ 方向的位移。我们假设标准的加载约定（压力 $p$ 向下作用，位移 $w$ 向下为正）。该关系为：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{p}(\\mathbf{k})}{k} $$\n使用 $\\mu = E/(2(1+\\nu))$ 和 $E^\\star = E/(1-\\nu^2)$：\n$$ \\frac{1-\\nu}{\\mu} = \\frac{(1-\\nu) \\cdot 2(1+\\nu)}{E} = \\frac{2(1-\\nu^2)}{E} = \\frac{2}{E/(1-\\nu^2)} = \\frac{2}{E^\\star} $$\n最终的谱关系是：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{2}{E^\\star k} \\hat{p}(\\mathbf{k}) $$\n此关系表示频域中的一个线性滤波器。在波数 $k$ 处，位移响应与该波数下的牵引分量成正比。比例因子 $\\hat{G}(k) = 2/(E^\\star k)$ 是谱柔度或格林函数。$1/k$ 的出现表明该问题由一个椭圆偏微分方程控制，其格林函数是非局部的。在空间域中，这对应于长程相互作用。对于小 $k$（长波长），柔度较大，表明半空间对大尺度载荷是柔顺的；对于大 $k$（短波长），柔度较小，表明对高度局部化的载荷是刚性的。\n\n### 2. 空间域卷积定律\n\n频域中的关系 $\\hat{w}(\\mathbf{k}) = \\hat{G}(\\mathbf{k}) \\hat{p}(\\mathbf{k})$ 根据卷积定理，对应于空间域中的卷积：\n$$ w(\\mathbf{x}) = (G * p)(\\mathbf{x}) = \\int_{\\mathbb{R}^2} G(\\mathbf{x}-\\mathbf{x'}) p(\\mathbf{x'}) d^2\\mathbf{x'} $$\n空间格林函数 $G(\\mathbf{x})$ 是 $\\hat{G}(\\mathbf{k})$ 的傅里叶逆变换：\n$$ G(\\mathbf{x}) = \\mathcal{F}^{-1}\\{\\hat{G}(\\mathbf{k})\\} = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\frac{2}{E^\\star k} e^{i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{k} $$\n由于旋转对称性，$G$ 仅依赖于大小 $r=|\\mathbf{x}|$。我们将积分转换为 k 平面中的极坐标（$k_x = k\\cos\\phi, k_y = k\\sin\\phi$）并将 x 轴与 $\\mathbf{x}$ 对齐，因此 $\\mathbf{k}\\cdot\\mathbf{x} = kr\\cos\\phi$：\n$$ G(r) = \\frac{2}{(2\\pi)^2 E^\\star} \\int_0^\\infty \\int_0^{2\\pi} \\frac{1}{k} e^{ikr\\cos\\phi} k d\\phi dk = \\frac{2}{4\\pi^2 E^\\star} \\int_0^\\infty \\left( \\int_0^{2\\pi} e^{ikr\\cos\\phi} d\\phi \\right) dk $$\n内部积分是第一类零阶 Bessel 函数的一个标准表示：$\\int_0^{2\\pi} e^{iz\\cos\\phi} d\\phi = 2\\pi J_0(z)$。\n$$ G(r) = \\frac{2 \\cdot 2\\pi}{4\\pi^2 E^\\star} \\int_0^\\infty J_0(kr) dk = \\frac{1}{\\pi E^\\star} \\int_0^\\infty J_0(kr) dk $$\n使用恒等式 $\\int_0^\\infty J_0(u)du=1$ 并代换 $u=kr$, $du=r dk$：\n$$ G(r) = \\frac{1}{\\pi E^\\star r} \\int_0^\\infty J_0(u) du = \\frac{1}{\\pi E^\\star r} $$\n这就是著名的 Boussinesq 核。卷积定律为：\n$$ w(\\mathbf{x}) = \\frac{1}{\\pi E^\\star} \\int_{\\mathbb{R}^2} \\frac{p(\\mathbf{x'})}{|\\mathbf{x}-\\mathbf{x'}|} d^2\\mathbf{x'} $$\n$1/r$ 奇异性源于核在频域中的 $1/k$ 行为。在物理上，这对应于对点载荷的响应。原点处的集中力 $P$ 对应于一个狄拉克δ函数压力 $p(\\mathbf{x}) = P\\delta(\\mathbf{x})$，产生无限位移 $w(0)$，这反映了点载荷下无限应力的非物理性质。\n\n### 3. 正则化点载荷位移\n\n我们用正则化的、归一化的高斯压力分布来模拟点载荷 $P$：\n$$ p(x,y) = P \\rho_\\varepsilon(x,y) = \\frac{P}{2\\pi\\varepsilon^2} e^{-(x^2+y^2)/(2\\varepsilon^2)} $$\n其中 $\\varepsilon$ 是正则化长度尺度。我们可以使用空间或谱表示来计算中心位移 $w(\\mathbf{0})$。谱方法更直接。首先，我们找到压力的傅里叶变换：\n$$ \\hat{p}(\\mathbf{k}) = \\mathcal{F}\\left\\{ \\frac{P}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P \\cdot \\mathcal{F}\\left\\{ \\frac{1}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P e^{-k^2\\varepsilon^2/2} $$\n位移的变换是 $\\hat{w}(\\mathbf{k}) = \\hat{G}(k) \\hat{p}(\\mathbf{k}) = \\frac{2 P}{E^\\star k} e^{-k^2\\varepsilon^2/2}$。\n要找到 $w(\\mathbf{0})$，我们在 $\\mathbf{x}=\\mathbf{0}$ 处计算傅里叶逆变换：\n$$ w(\\mathbf{0}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\hat{w}(\\mathbf{k}) d^2\\mathbf{k} = \\frac{1}{4\\pi^2} \\int_0^{2\\pi} \\int_0^\\infty \\left( \\frac{2P}{E^\\star k} e^{-k^2\\varepsilon^2/2} \\right) k dk d\\phi $$\n$$ w(\\mathbf{0}) = \\frac{2\\pi \\cdot 2P}{4\\pi^2 E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{P}{\\pi E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk $$\n该积分为标准高斯积分：$\\int_0^\\infty e^{-a u^2} du = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。这里，$a = \\varepsilon^2/2$。\n$$ \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{1}{2} \\sqrt{\\frac{\\pi}{\\varepsilon^2/2}} = \\frac{\\sqrt{2\\pi}}{2\\varepsilon} $$\n代入此结果得到中心位移：\n$$ w(\\mathbf{0}) = \\frac{P}{\\pi E^\\star} \\frac{\\sqrt{2\\pi}}{2\\varepsilon} = \\frac{P}{\\sqrt{2\\pi} E^\\star \\varepsilon} $$\n当正则化参数 $\\varepsilon \\to 0^+$ 时，项 $1/\\varepsilon \\to \\infty$，因此 $w(\\mathbf{0}) \\to \\infty$。这正确地恢复了理想点载荷的奇异行为。\n\n### 4. 圆形区域上的均匀压力\n\n对于施加在半径为 $a$ 的圆形区域上的均匀压力 $p$，压力分布为 $p(r) = p$ (当 $r \\le a$) 且 $p(r) = 0$ (当 $r > a$)。我们使用步骤2中推导的空间卷积定律计算中心位移 $w(\\mathbf{0})$：\n$$ w(\\mathbf{0}) = \\int_{\\mathbb{R}^2} G(\\mathbf{0}-\\mathbf{x'})p(\\mathbf{x'}) d\\mathbf{x'} = \\int_{|\\mathbf{x'}| \\le a} \\frac{1}{\\pi E^\\star |\\mathbf{x'}|} p \\, d\\mathbf{x'} $$\n我们对积分变量 $\\mathbf{x'} = (r', \\theta')$ 切换到极坐标，其中 $d\\mathbf{x'} = r'dr'd\\theta'$：\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\int_0^a \\frac{1}{r'} r' dr' d\\theta' = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\left( \\int_0^a dr' \\right) d\\theta' $$\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} a \\, d\\theta' = \\frac{p a}{\\pi E^\\star} [ \\theta' ]_0^{2\\pi} = \\frac{p a}{\\pi E^\\star} (2\\pi) $$\n中心位移的精确表达式为：\n$$ w(\\mathbf{0}) = \\frac{2pa}{E^\\star} $$\n\n### 5. 数值算法与实现\n\n数值方法使用二维快速傅里叶变换（FFT）通过在谱域中相乘来实现卷积。\n\n**算法：**\n1.  **离散化**：在 $N \\times N$ 网格上定义一个边长为 $L$ 的方形域。网格间距为 $\\Delta x = L/N$。我们使用中心化坐标网格 $x_i, y_j \\in [-L/2, L/2)$。\n2.  **频率网格**：使用 `np.fft.fftfreq` 构建相应的二维频率网格 $(k_x, k_y)$。波数为 $k_{m} = 2\\pi m/L$，其中 $m \\in \\{-N/2, \\dots, N/2-1\\}$。计算波数大小 $k = \\sqrt{k_x^2 + k_y^2}$。\n3.  **谱核**：构建离散谱格林函数 $\\hat{G}(k_x, k_y) = 2 / (E^\\star k)$。在零波数点 $(k_x, k_y) = (0,0)$，有 $k=0$，核函数是奇异的。这对应于半空间的刚体平移，这在物理上是任意的。我们设置 $\\hat{G}(0,0) = 0$ 来移除此模式，这等效于约束平均位移为零。\n4.  **牵引场**：对于每个测试案例，在空间网格上构建压力分布 $p(x_i, y_j)$。对于高斯载荷，确保离散总力 $\\sum p_{ij} \\Delta x^2$ 等于指定的力 $P$。\n5.  **FFT 卷积**：\n    a. 计算压力网格的二维FFT：$\\hat{p} = \\text{fft2}(p)$。\n    b. 在频域中逐元素相乘：$\\hat{w} = \\hat{p} \\cdot \\hat{G}$。\n    c. 计算二维逆FFT以获得位移场：$w = \\text{ifft2}(\\hat{w})$。由于数值精度问题，结果是复数，我们取其实部。\n6.  **比较**：提取网格中心的数值位移 $w_{\\text{num}}(\\mathbf{0})$，并将其与步骤3和4中推导的解析解 $w_{\\text{an}}(\\mathbf{0})$ 进行比较，以计算相对误差。\n\n**影响讨论：**\n-   **周期性镜像**：FFT 假设周期性边界条件。这意味着我们的计算模拟了一个由间距为 $L$ 的相同载荷组成的无限晶格。在任何点计算的位移都包含了所有这些“周期性镜像”的贡献。这导致位移比真实的孤立载荷问题被高估。误差量级为 $1/L$，随着域大小 $L$ 相对于载荷尺寸的增加而减小。\n-   **截断/混叠**：有限网格（$N$）施加了一个最大可表示波数（奈奎斯特频率，$k_{Nyq} = \\pi/\\Delta x$）。真实信号中高于此频率的频率会被“混叠”到较低频率，从而引入误差。如果压力的傅里叶变换 $\\hat{p}(k)$ 在 $k_{Nyq}$ 之外有大量能量，这将是显著的。对于平滑的高斯压力，$\\hat{p}(k)$ 衰减非常快，因此如果 $\\varepsilon > \\Delta x$，此误差很小。对于边缘锐利的圆形压力，$\\hat{p}(k)$ 衰减较慢（$k^{-3/2}$），因此混叠误差通常更大。\n-   **正则化**：高斯情况下的磨光函数参数 $\\varepsilon$ 确保载荷是平滑的，其频谱是带限的，这对于基于FFT的方法的准确性至关重要。为了让数值方案准确解析载荷，$\\varepsilon$ 应大于网格间距 $\\Delta x$。当 $\\varepsilon$ 接近 $\\Delta x$ 时，高斯函数的离散表示变差，从而增加误差。\n\n实现此算法的 Python 代码在最终答案中提供。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Boussinesq problem for a half-space under different normal traction\n    distributions using a 2D FFT-based spectral method and compares the numerical\n    results to analytical solutions.\n    \"\"\"\n    # Physical and computational parameters\n    E = 70.0e9  # Young's modulus in Pa\n    nu = 0.25    # Poisson's ratio\n    L = 1.0      # Side length of the computational cell in m\n    N = 512      # Number of grid points in each direction\n\n    # Derived parameters\n    E_star = E / (1.0 - nu**2)\n    dx = L / N\n\n    # 1. Construct frequency grid\n    k_freq = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    kx, ky = np.meshgrid(k_freq, k_freq)\n    k_mag = np.sqrt(kx**2 + ky**2)\n\n    # 2. Construct spectral Green's function (compliance)\n    # G_hat(k) = 2 / (E_star * k)\n    G_hat = np.zeros_like(k_mag, dtype=float)\n    # Avoid division by zero at k=0\n    non_zero_k = k_mag != 0\n    G_hat[non_zero_k] = 2.0 / (E_star * k_mag[non_zero_k])\n    # The k=0 term (rigid body mode) is explicitly set to 0.\n\n    # 3. Construct spatial grid, centered at (0,0)\n    x_coords = np.arange(-N/2, N/2) * dx\n    xx, yy = np.meshgrid(x_coords, x_coords)\n    \n    test_cases = [\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.020},\n        {'type': 'circular', 'p': 2.0e6, 'a': 0.040},\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.005},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # 4. Construct traction field on the grid\n        if case['type'] == 'gaussian':\n            P = case['P']\n            eps = case['eps']\n            \n            # Analytic solution for centered displacement\n            w_an = P / (np.sqrt(2 * np.pi) * E_star * eps)\n            \n            # Define unscaled Gaussian traction\n            tz_unscaled = np.exp(-(xx**2 + yy**2) / (2 * eps**2))\n            \n            # Rescale to ensure discrete total force is P\n            # Discrete sum approximates integral: sum(f_i * dA)\n            discrete_total_force = np.sum(tz_unscaled) * dx**2\n            scaling_factor = P / discrete_total_force\n            tz_grid = tz_unscaled * scaling_factor\n            \n        elif case['type'] == 'circular':\n            p = case['p']\n            a = case['a']\n            \n            # Analytic solution for centered displacement\n            w_an = (2 * p * a) / E_star\n            \n            # Define uniform pressure over a circular area\n            r = np.sqrt(xx**2 + yy**2)\n            tz_grid = np.zeros_like(r)\n            tz_grid[r = a] = p\n        \n        # 5. Perform FFT-based convolution\n        # a. FFT of the traction field\n        Tz_hat = np.fft.fft2(tz_grid)\n        \n        # b. Multiply by spectral Green's function\n        W_hat = Tz_hat * G_hat\n        \n        # c. Inverse FFT to get displacement field\n        w_grid = np.fft.ifft2(W_hat)\n        \n        # The output from iFFT should be real, except for small numerical noise.\n        # The grid is constructed such that the origin (0,0) corresponds to\n        # the indices (N//2, N//2).\n        w_num_center = np.real(w_grid[N//2, N//2])\n        \n        # 6. Compute relative error\n        relative_error = np.abs(w_num_center - w_an) / np.abs(w_an)\n        results.append(relative_error)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}