{
    "hands_on_practices": [
        {
            "introduction": "本练习介绍求解圣维南扭转问题的经典方法。通过为等边三角形构建一个多项式形式的普朗特应力函数，我们可以找到一个精确的解析解。此练习旨在锻炼应用控制方程和边界条件来解决一个非平凡的翘曲截面的基本技能。",
            "id": "2710727",
            "problem": "一根横截面为边长 $s$ 的等边三角形的均匀各向同性直杆，绕 $z$ 轴承受圣维南扭转 (Saint-Venant torsion)，单位长度扭角为 $\\theta$。在截面平面内选择笛卡尔坐标系 $(x,y)$，使得三角形的一条边与 $x$ 轴上从 $(0,0)$ 到 $(s,0)$ 的线段重合，且第三个顶点位于 $\\left(\\frac{s}{2}, \\frac{\\sqrt{3}}{2}s\\right)$。在经典的圣维南框架内，使用经扭角标度的 Prandtl 应力函数进行分析，即引入一个应力函数 $\\Phi(x,y)$，使得剪应力由下式表示：\n- $\\tau_{xz} = G \\,\\theta \\,\\frac{\\partial \\Phi}{\\partial y}$，\n- $\\tau_{yz} = - G \\,\\theta \\,\\frac{\\partial \\Phi}{\\partial x}$，\n并且 Prandtl 应力函数满足具有常数源项的泊松方程，\n- $\\nabla^{2} \\Phi = -2$ 在三角形域内，\n以及自由表面边界条件\n- $\\Phi = 0$ 在三角形的每条边上。\n\n仅从以上陈述和扭矩的定义出发，\n$$\nT \\,=\\, \\iint_{A} \\big( x\\,\\tau_{yz} \\,-\\, y\\,\\tau_{xz} \\big)\\, \\mathrm{d}A,\n$$\n其中 $A$ 是三角形区域的面积，完成以下任务：\n\n1. 为 $\\Phi(x,y)$ 构建一个能确保在三条边上 $\\Phi=0$ 的显式多项式候选式，确定使 $\\nabla^{2}\\Phi=-2$ 在域内成立所需的唯一标量因子，并验证在每条边上边界条件 $\\Phi=0$ 均成立。\n\n2. 仅使用给定的定义和基本矢量微积分恒等式，将扭矩积分简化为仅包含 $\\Phi$ 的面积分，并由此获得由 $T = G J \\theta$ 定义的、作为 $\\Phi$ 的泛函的扭转常数 $J$。\n\n3. 对给定的等边三角形，精确计算所得的面积分，以获得 $J$ 作为 $s$ 的函数的闭式表达式。\n\n将最终的扭转常数 $J$ 表示为仅含 $s$ 的单个精确符号表达式。不需要进行数值舍入。在最终表达式中不要包含单位。",
            "solution": "问题陈述在科学上是合理的、适定的且完整的。它提出了一个弹性力学理论中的标准问题——等边三角形截面棱柱杆的扭转问题，该问题使用 Prandtl 应力函数进行公式化。所有的控制方程和边界条件都已正确指定。我们将按要求分三部分进行求解。\n\n第一部分：应力函数 $\\Phi(x,y)$ 的构建\n\n问题要求构建一个应力函数 $\\Phi(x,y)$，该函数在三角形域内满足泊松方程 $\\nabla^{2} \\Phi = -2$，并在其边界上为零。三角形的顶点位于 $(0,0)$、$(s,0)$ 和 $(\\frac{s}{2}, \\frac{\\sqrt{3}}{2}s)$。构成边界的三条直线是：\n$1$. 在 $x$ 轴上的边：$L_1: y = 0$。\n$2$. 连接 $(s,0)$ 和 $(\\frac{s}{2}, \\frac{\\sqrt{3}}{2}s)$ 的边：$L_2: y - 0 = \\frac{\\frac{\\sqrt{3}}{2}s - 0}{\\frac{s}{2}-s}(x-s)$，简化为 $y = -\\sqrt{3}(x-s)$，或 $y + \\sqrt{3}x - \\sqrt{3}s = 0$。\n$3$. 连接 $(0,0)$ 和 $(\\frac{s}{2}, \\frac{\\sqrt{3}}{2}s)$ 的边：$L_3: y = \\sqrt{3}x$，或 $y - \\sqrt{3}x = 0$。\n\n一个在所有三条边界线上均为零的多项式函数，可以构建为定义这些直线的线性表达式的乘积。我们提出一个候选函数，其形式为：\n$$ \\Phi(x,y) = C \\cdot y \\cdot (y - \\sqrt{3}x) \\cdot (y + \\sqrt{3}x - \\sqrt{3}s) $$\n其中 $C$ 是一个待定常数。展开此多项式：\n$$ \\Phi(x,y) = C \\cdot (y^2 - \\sqrt{3}xy) \\cdot (y + \\sqrt{3}x - \\sqrt{3}s) $$\n$$ \\Phi(x,y) = C \\cdot [y^2(y + \\sqrt{3}x - \\sqrt{3}s) - \\sqrt{3}xy(y + \\sqrt{3}x - \\sqrt{3}s)] $$\n$$ \\Phi(x,y) = C \\cdot [y^3 + \\sqrt{3}xy^2 - \\sqrt{3}sy^2 - \\sqrt{3}xy^2 - 3x^2y + 3sxy] $$\n$$ \\Phi(x,y) = C \\cdot (y^3 - 3x^2y - \\sqrt{3}sy^2 + 3sxy) $$\n根据构造，该函数在三角形的边界上为零，因为它的一个因子在每条边上都为零。\n\n接下来，我们必须强制满足条件 $\\nabla^{2} \\Phi = -2$。我们计算 $\\Phi(x,y)$ 的拉普拉斯算子：\n$$ \\frac{\\partial \\Phi}{\\partial x} = C \\cdot (-6xy + 3sy) $$\n$$ \\frac{\\partial^2 \\Phi}{\\partial x^2} = C \\cdot (-6y) $$\n$$ \\frac{\\partial \\Phi}{\\partial y} = C \\cdot (3y^2 - 3x^2 - 2\\sqrt{3}sy + 3sx) $$\n$$ \\frac{\\partial^2 \\Phi}{\\partial y^2} = C \\cdot (6y - 2\\sqrt{3}s) $$\n拉普拉斯算子是这些二阶偏导数的和：\n$$ \\nabla^2 \\Phi = \\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial y^2} = C(-6y) + C(6y - 2\\sqrt{3}s) = -2\\sqrt{3}Cs $$\n令其等于 $-2$ 可得：\n$$ -2\\sqrt{3}Cs = -2 \\implies C = \\frac{1}{\\sqrt{3}s} $$\n因此，满足给定条件的唯一应力函数是：\n$$ \\Phi(x,y) = \\frac{1}{\\sqrt{3}s}(y^3 - 3x^2y - \\sqrt{3}sy^2 + 3sxy) $$\n从乘积形式可以直接验证边界条件 $\\Phi=0$，因为对于三角形边上的任意一点，线性因子 $y$、$y-\\sqrt{3}x$ 或 $y+\\sqrt{3}x-\\sqrt{3}s$ 之一会变为零。\n\n第二部分：扭转常数 $J$ 的推导\n\n扭矩 $T$ 定义为：\n$$ T = \\iint_{A} (x\\,\\tau_{yz} - y\\,\\tau_{xz}) \\mathrm{d}A $$\n将以 $\\Phi$ 表示的应力分量代入：\n$$ T = \\iint_{A} \\left[ x\\left(-G\\theta \\frac{\\partial \\Phi}{\\partial x}\\right) - y\\left(G\\theta \\frac{\\partial \\Phi}{\\partial y}\\right) \\right] \\mathrm{d}A $$\n$$ T = -G\\theta \\iint_{A} \\left( x \\frac{\\partial \\Phi}{\\partial x} + y \\frac{\\partial \\Phi}{\\partial y} \\right) \\mathrm{d}A $$\n我们注意到被积函数是一个矢量场散度的一部分。考虑矢量场 $\\mathbf{F} = \\Phi\\mathbf{r}$，其中 $\\mathbf{r} = x\\mathbf{i} + y\\mathbf{j}$。其散度为：\n$$ \\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (\\Phi\\mathbf{r}) = (\\nabla\\Phi) \\cdot \\mathbf{r} + \\Phi(\\nabla \\cdot \\mathbf{r}) = \\left(\\frac{\\partial \\Phi}{\\partial x}x + \\frac{\\partial \\Phi}{\\partial y}y\\right) + \\Phi(1+1) = \\left(x \\frac{\\partial \\Phi}{\\partial x} + y \\frac{\\partial \\Phi}{\\partial y}\\right) + 2\\Phi $$\n 整理此恒等式可得：\n$$ x \\frac{\\partial \\Phi}{\\partial x} + y \\frac{\\partial \\Phi}{\\partial y} = \\nabla \\cdot (\\Phi\\mathbf{r}) - 2\\Phi $$\n将此式代入扭矩的表达式中：\n$$ T = -G\\theta \\iint_{A} [\\nabla \\cdot (\\Phi\\mathbf{r}) - 2\\Phi] \\mathrm{d}A = -G\\theta \\left( \\iint_{A} \\nabla \\cdot (\\Phi\\mathbf{r}) \\mathrm{d}A - 2\\iint_{A} \\Phi \\mathrm{d}A \\right) $$\n根据散度定理（或平面上的格林公式），第一个积分可以转换成一个边界积分：\n$$ \\iint_{A} \\nabla \\cdot (\\Phi\\mathbf{r}) \\mathrm{d}A = \\oint_{\\partial A} (\\Phi\\mathbf{r}) \\cdot \\mathbf{n} \\mathrm{d}l $$\n其中 $\\partial A$ 是三角形域 $A$ 的边界。由于在边界 $\\partial A$ 上的每一点都有 $\\Phi = 0$，该线积分为零。\n$$ \\oint_{\\partial A} (\\Phi\\mathbf{r}) \\cdot \\mathbf{n} \\mathrm{d}l = \\oint_{\\partial A} (0 \\cdot \\mathbf{r}) \\cdot \\mathbf{n} \\mathrm{d}l = 0 $$\n扭矩表达式简化为：\n$$ T = -G\\theta \\left( 0 - 2\\iint_{A} \\Phi \\mathrm{d}A \\right) = 2G\\theta \\iint_{A} \\Phi \\mathrm{d}A $$\n根据定义，扭转常数 $J$ 通过 $T = G J \\theta$ 将扭矩和扭角联系起来。将此与我们推导的表达式进行比较，我们发现：\n$$ G J \\theta = 2G\\theta \\iint_{A} \\Phi \\mathrm{d}A \\implies J = 2\\iint_{A} \\Phi \\mathrm{d}A $$\n\n第三部分：扭转常数 $J$ 的计算\n\n我们现在使用推导出的 $\\Phi(x,y)$ 表达式来计算 $J$ 的积分：\n$$ J = 2\\iint_{A} \\frac{1}{\\sqrt{3}s}(y^3 - 3x^2y - \\sqrt{3}sy^2 + 3sxy) \\mathrm{d}A $$\n积分区域是由 $0 \\le y \\le \\frac{\\sqrt{3}}{2}s$ 和 $\\frac{y}{\\sqrt{3}} \\le x \\le s - \\frac{y}{\\sqrt{3}}$ 定义的三角形。\n$$ J = \\frac{2}{\\sqrt{3}s} \\int_{0}^{\\frac{\\sqrt{3}}{2}s} \\int_{y/\\sqrt{3}}^{s-y/\\sqrt{3}} (y^3 - \\sqrt{3}sy^2 - 3x^2y + 3sxy) \\mathrm{d}x \\mathrm{d}y $$\n首先，我们计算关于 $x$ 的内层积分：\n$$ I_x = \\int_{y/\\sqrt{3}}^{s-y/\\sqrt{3}} (y^3 - \\sqrt{3}sy^2 - 3x^2y + 3sxy) \\mathrm{d}x = \\left[ (y^3 - \\sqrt{3}sy^2)x - yx^3 + \\frac{3s}{2}yx^2 \\right]_{x=y/\\sqrt{3}}^{x=s-y/\\sqrt{3}} $$\n令 $x_R = s - y/\\sqrt{3}$ 和 $x_L = y/\\sqrt{3}$。则 $x_R - x_L = s - 2y/\\sqrt{3}$，$x_R^2 - x_L^2 = s(s - 2y/\\sqrt{3})$，以及 $x_R^3 - x_L^3 = s^3 - \\sqrt{3}s^2y + sy^2 - \\frac{2y^3}{3\\sqrt{3}}$。代入这些可得：\n$$ I_x = (y^3 - \\sqrt{3}sy^2)(s - \\frac{2y}{\\sqrt{3}}) - y(s^3 - \\sqrt{3}s^2y + sy^2 - \\frac{2y^3}{3\\sqrt{3}}) + \\frac{3s}{2}y \\cdot s(s - \\frac{2y}{\\sqrt{3}}) $$\n展开并按 $y$ 的幂次合并同类项：\n$$ I_x = \\left( sy^3 - \\frac{2}{\\sqrt{3}}y^4 - \\sqrt{3}s^2y^2 + 2sy^3 \\right) - \\left( s^3y - \\sqrt{3}s^2y^2 + sy^3 - \\frac{2y^4}{3\\sqrt{3}} \\right) + \\left( \\frac{3s^3y}{2} - \\sqrt{3}s^2y^2 \\right) $$\n$$ I_x = \\left(3s - s\\right)y^3 + \\left(-\\frac{2}{\\sqrt{3}} + \\frac{2}{3\\sqrt{3}}\\right)y^4 + \\left(-\\sqrt{3}s^2 + \\sqrt{3}s^2 - \\sqrt{3}s^2\\right)y^2 + \\left(-s^3 + \\frac{3s^3}{2}\\right)y $$\n$$ I_x = 2sy^3 - \\frac{4}{3\\sqrt{3}}y^4 - \\sqrt{3}s^2y^2 + \\frac{s^3}{2}y $$\n现在，我们进行关于 $y$ 的外层积分：\n$$ \\int_{0}^{\\frac{\\sqrt{3}}{2}s} I_x \\mathrm{d}y = \\int_{0}^{\\frac{\\sqrt{3}}{2}s} \\left( 2sy^3 - \\frac{4}{3\\sqrt{3}}y^4 - \\sqrt{3}s^2y^2 + \\frac{s^3}{2}y \\right) \\mathrm{d}y $$\n$$ = \\left[ \\frac{2s}{4}y^4 - \\frac{4}{3\\sqrt{3} \\cdot 5}y^5 - \\frac{\\sqrt{3}s^2}{3}y^3 + \\frac{s^3}{4}y^2 \\right]_{0}^{\\frac{\\sqrt{3}}{2}s} $$\n$$ = \\frac{s}{2}\\left(\\frac{9s^4}{16}\\right) - \\frac{4}{15\\sqrt{3}}\\left(\\frac{9\\sqrt{3}s^5}{32}\\right) - \\frac{\\sqrt{3}s^2}{3}\\left(\\frac{3\\sqrt{3}s^3}{8}\\right) + \\frac{s^3}{4}\\left(\\frac{3s^2}{4}\\right) $$\n$$ = \\frac{9s^5}{32} - \\frac{36s^5}{480} - \\frac{9s^5}{24} + \\frac{3s^5}{16} = \\frac{9s^5}{32} - \\frac{3s^5}{40} - \\frac{3s^5}{8} + \\frac{3s^5}{16} $$\n公分母为 $160$：\n$$ = \\left(\\frac{45 - 12 - 60 + 30}{160}\\right)s^5 = \\frac{3}{160}s^5 $$\n这是积分 $\\iint_A (y^3 - 3x^2y - \\sqrt{3}sy^2 + 3sxy) \\mathrm{d}A$ 的值。\n最后，我们将此结果代回 $J$ 的表达式中：\n$$ J = \\frac{2}{\\sqrt{3}s} \\left(\\frac{3}{160}s^5\\right) = \\frac{6s^4}{160\\sqrt{3}} = \\frac{3s^4}{80\\sqrt{3}} $$\n将分母有理化：\n$$ J = \\frac{3s^4 \\cdot \\sqrt{3}}{80\\sqrt{3} \\cdot \\sqrt{3}} = \\frac{3\\sqrt{3}s^4}{80 \\cdot 3} = \\frac{\\sqrt{3}}{80}s^4 $$\n这就是等边三角形截面的扭转常数。",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{80}s^4}$$"
        },
        {
            "introduction": "为什么在横截面积相同的情况下，某些形状在扭转时比其他形状更硬？本练习通过比较圆形（不发生翘曲）和方形（会发生翘曲）截面来探讨这个问题。通过计算和比较它们的扭转常数，你将对翘曲如何影响结构效率建立更深刻的物理直觉。",
            "id": "2710728",
            "problem": "一根均质、各向同性的线性弹性棱柱杆承受圣维南扭转，单位长度扭角为 $\\,\\theta'\\,$, 其侧表面无牵引力。设其横截面为 (i) 半径为 $\\,R\\,$ 的圆形或 (ii) 边长为 $\\,s\\,$ 的正方形。用 $\\,J\\,$ 表示圣维南扭转常数，其定义为 $\\,T = G\\,J\\,\\theta'\\,$, 其中 $\\,T\\,$ 是施加的扭矩，$\\,G\\,$ 是剪切模量。\n\n任务：\n- 使用圣维南扭转的Prandtl应力函数公式，从第一性原理推导圆形横截面的 $\\,J\\,$。\n- 对于正方形横截面，通过精确求解圣维南边值问题（通过傅里叶级数）或使用满足无牵引力边界条件的容许Prandtl应力函数的变分近似，获得关系式 $\\,J_{\\text{square}} = c\\,s^{4}\\,$ 中无量纲常数 $\\,c\\,$ 的一个可靠值。明确说明你选择的路径，并证明得到 $\\,c\\,$ 的步骤是合理的。\n- 施加等面积约束 $\\,\\pi R^{2} = s^{2}\\,$，并计算比率 $\\,J_{\\text{circle}}/J_{\\text{square}}\\,$。\n- 基于控制方程或能量/变分陈述，提供一个简要的物理解释，说明为什么在所有给定面积的单连通形状中，圆形使 $\\,J\\,$ 最大化。\n\n将最终比率 $\\,J_{\\text{circle}}/J_{\\text{square}}\\,$ 表示为一个无量纲数，四舍五入到四位有效数字。",
            "solution": "所提出的问题是弹性力学理论中的一个标准练习，具体涉及棱柱杆的圣维南扭转。该问题具有科学依据，是适定的，并提供了所有必要条件。因此，该问题是有效的，我将进行完整解答。\n\n分析基于Prandtl应力函数 $\\phi(x,y)$，该函数定义在杆的横截面域 $\\Omega$ 上。对于无牵引力的侧表面，此函数必须在域内满足泊松方程，并在边界上为常数。对于单连通域，此常数可以设为零。\n\n控制方程如下：\n1.  应力函数 $\\phi$ 的泊松方程：\n    $$ \\nabla^{2}\\phi = \\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\partial^{2}\\phi}{\\partial y^{2}} = -2G\\theta' \\quad \\text{在 } \\Omega \\text{ 内} $$\n2.  周界 $\\partial\\Omega$ 上的边界条件：\n    $$ \\phi = 0 \\quad \\text{在 } \\partial\\Omega \\text{ 上} $$\n3.  产生的扭矩 $T$ 与应力函数的关系为：\n    $$ T = 2 \\iint_{\\Omega} \\phi \\, dA $$\n4.  抗扭刚度，或称扭转常数 $J$，由关系式 $T = G J \\theta'$ 定义。结合这些可以得到用 $\\phi$ 表示 $J$ 的表达式：\n    $$ J = \\frac{2}{G\\theta'} \\iint_{\\Omega} \\phi \\, dA $$\n\n我现在将按顺序处理每个任务。\n\n**任务1：圆形横截面J的推导**\n\n对于半径为 $R$ 的圆形横截面，域 $\\Omega$ 由 $x^{2} + y^{2} \\le R^{2}$ 定义。由于问题的轴对称性，使用极坐标 $(r, \\vartheta)$ 最为方便，其中 $r^{2} = x^{2} + y^{2}$。极坐标下的拉普拉斯算子是 $\\nabla^{2} = \\frac{\\partial^{2}}{\\partial r^{2}} + \\frac{1}{r}\\frac{\\partial}{\\partial r} + \\frac{1}{r^{2}}\\frac{\\partial^{2}}{\\partial \\vartheta^{2}}$。假设解是轴对称的，$\\phi$ 仅是 $r$ 的函数，即 $\\phi = \\phi(r)$，因此包含 $\\frac{\\partial^{2}}{\\partial \\vartheta^{2}}$ 的项消失。\n\n控制方程简化为一个常微分方程：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{d\\phi}{dr}\\right) = -2G\\theta' $$\n对 $r$ 积分得到：\n$$ r\\frac{d\\phi}{dr} = -G\\theta'r^{2} + C_{1} $$\n除以 $r$ 并再次积分：\n$$ \\frac{d\\phi}{dr} = -G\\theta'r + \\frac{C_{1}}{r} $$\n$$ \\phi(r) = -\\frac{1}{2}G\\theta'r^{2} + C_{1}\\ln(r) + C_{2} $$\n为了确定积分常数，我们应用物理条件和边界条件。首先，应力以及应力函数 $\\phi$ 在实心轴的中心 ($r=0$) 必须保持有限。对数项 $\\ln(r)$ 在 $r=0$ 处是奇异的，因此其系数必须为零。于是，$C_{1}=0$。\n边界条件是在周界上 $\\phi=0$，即 $\\phi(R)=0$。\n$$ \\phi(R) = -\\frac{1}{2}G\\theta'R^{2} + C_{2} = 0 \\implies C_{2} = \\frac{1}{2}G\\theta'R^{2} $$\n因此，圆形横截面的应力函数为：\n$$ \\phi(r) = \\frac{1}{2}G\\theta'(R^{2} - r^{2}) $$\n现在，我们使用其定义计算抗扭刚度 $J_{\\text{circle}}$。极坐标下的面积元是 $dA = r\\,dr\\,d\\vartheta$。\n$$ J_{\\text{circle}} = \\frac{2}{G\\theta'} \\int_{0}^{2\\pi}\\int_{0}^{R} \\frac{1}{2}G\\theta'(R^{2} - r^{2}) \\, r \\, dr \\, d\\vartheta $$\n$G\\theta'$ 项相互抵消，对 $\\vartheta$ 的积分得到一个因子 $2\\pi$。\n$$ J_{\\text{circle}} = 2 \\pi \\int_{0}^{R} (R^{2}r - r^{3}) \\, dr = 2\\pi \\left[ \\frac{R^{2}r^{2}}{2} - \\frac{r^{4}}{4} \\right]_{0}^{R} $$\n$$ J_{\\text{circle}} = 2\\pi \\left( \\frac{R^{4}}{2} - \\frac{R^{4}}{4} \\right) = 2\\pi \\left( \\frac{R^{4}}{4} \\right) = \\frac{\\pi R^{4}}{2} $$\n这是众所周知的圆形面积的极惯性矩。\n\n**任务2：正方形横截面的扭转常数**\n\n对于边长为 $s$ 的正方形横截面，找到 $\\phi$ 的精确闭合形式解是不可能的。问题要求为关系式 $J_{\\text{square}} = c s^{4}$ 中的常数 $c$ 提供一个可靠值。这个值是通过使用应力函数 $\\phi$ 的傅里叶级数表示来精确求解圣维南边值问题得到的。随后对 $\\phi$ 在正方形域上积分，得到扭矩，从而得到 $J$。推导过程冗长，因此我将明确说明我正在使用这种精确方法得出的已有结果。\n\n对于边长为 $s$ 的正方形，其扭转常数由下式给出：\n$$ J_{\\text{square}} = \\left( \\frac{1}{3} - \\frac{64}{\\pi^{5}}\\sum_{n=1,3,5,\\dots}^{\\infty} \\frac{1}{n^{5}}\\tanh\\left(\\frac{n\\pi}{2}\\right) \\right) s^{4} $$\n无量纲常数 $c$ 是括号中的表达式。我们可以计算其数值。该级数收敛非常快。\n$$ c = \\frac{1}{3} - \\frac{64}{\\pi^{5}}\\left( \\frac{\\tanh(\\pi/2)}{1^{5}} + \\frac{\\tanh(3\\pi/2)}{3^{5}} + \\frac{\\tanh(5\\pi/2)}{5^{5}} + \\dots \\right) $$\n使用数值：$\\pi \\approx 3.14159$，$\\pi^{5} \\approx 306.02$。\n$\\tanh(\\pi/2) \\approx \\tanh(1.5708) \\approx 0.91715$。\n$\\tanh(3\\pi/2) \\approx \\tanh(4.7124) \\approx 0.99991$。\n级数的首项占主导地位。\n$$ c \\approx \\frac{1}{3} - \\frac{64}{306.02} \\left( 0.91715 + \\frac{0.99991}{243} + \\dots \\right) \\approx 0.33333 - 0.20914 \\left( 0.91715 + 0.00411 \\right) $$\n$$ c \\approx 0.33333 - 0.20914 \\times 0.92126 \\approx 0.33333 - 0.19266 \\approx 0.14067 $$\n该常数的公认可靠值为 $c \\approx 0.1406$。因此，我们有 $J_{\\text{square}} = 0.1406\\,s^{4}$。\n\n**任务3：扭转常数的比率**\n\n我们有等面积约束：\n$$ \\text{Area}_{\\text{circle}} = \\text{Area}_{\\text{square}} \\implies \\pi R^{2} = s^{2} $$\n根据这个约束，我们可以用 $s^{4}$ 表示 $R^{4}$：\n$$ R^{2} = \\frac{s^{2}}{\\pi} \\implies R^{4} = \\frac{s^{4}}{\\pi^{2}} $$\n现在，我们将此代入 $J_{\\text{circle}}$ 的表达式中：\n$$ J_{\\text{circle}} = \\frac{\\pi R^{4}}{2} = \\frac{\\pi}{2} \\left( \\frac{s^{4}}{\\pi^{2}} \\right) = \\frac{s^{4}}{2\\pi} $$\n我们现在可以计算比率 $J_{\\text{circle}} / J_{\\text{square}}$：\n$$ \\frac{J_{\\text{circle}}}{J_{\\text{square}}} = \\frac{s^{4}/(2\\pi)}{c s^{4}} = \\frac{1}{2\\pi c} $$\n代入数值 $c \\approx 0.1406$：\n$$ \\frac{J_{\\text{circle}}}{J_{\\text{square}}} \\approx \\frac{1}{2\\pi(0.1406)} \\approx \\frac{1}{0.8834} \\approx 1.13190 $$\n四舍五入到四位有效数字，该比率为 $1.132$。\n\n**任务4：圆形截面最大化的物理解释**\n\n由George Pólya证明的圣维南猜想指出，在所有给定面积的单连通横截面形状中，圆形具有最大的抗扭刚度 $J$。通过考虑应力分布及其对刚度的贡献，可以构建一个物理解释。\n\n扭转中的剪切应力由Prandtl应力函数的梯度给出：$\\tau_{xz} = \\frac{\\partial\\phi}{\\partial y}$ 和 $\\tau_{yz} = -\\frac{\\partial\\phi}{\\partial x}$。抗扭能力源于这些应力。为了使横截面能有效地抵抗扭转，材料应尽可能均匀地受力。\n\n对于圆形横截面，剪切应力矢量的大小 $|\\boldsymbol{\\tau}| = \\sqrt{\\tau_{xz}^{2} + \\tau_{yz}^{2}} = |\\nabla\\phi|$，在任意给定半径 $r$ 处是恒定的，并达到其最大值 $|\\boldsymbol{\\tau}|_{\\text{max}} = G\\theta'R$，该值沿整个边界是恒定的。这表明应力分布非常高效。\n\n相反，对于像正方形这样的非圆形形状，应力分布是不均匀的。剪切应力必须与边界相切。在正方形的角点处，此条件迫使应力为零 ($|\\nabla\\phi|=0$)。最大应力出现在边的中点。这意味着角点附近的材料未被充分利用，对总扭矩承载能力的贡献很小，而边中点的材料则承受高应力。这些低应力区域代表了横截面面积在抵抗扭转方面的低效利用。\n\n从能量角度看，对于给定面积，最大化抗扭刚度 $J$ 等效于在给定施加扭矩 $T$ 的情况下最小化总弹性应变能。圆形通过更均匀地分布应力，并避免像正方形角点那样的应力集中和低应力区，从而在所有相同面积的形状中，对于给定的扭矩，达到了可能的最低应变能状态。相同外载荷下更低的能量状态意味着更刚的结构，因此 $J$ 最大。圆形的这种最优性是其几何特性的体现，即在给定周长下包围最大面积。在扭转的薄膜比拟中，这允许变形薄膜下的体积最大化，而该体积是一个与 $J$ 成正比的量。",
            "answer": "$$\n\\boxed{1.132}\n$$"
        },
        {
            "introduction": "虽然解析解形式优美，但它们仅限于简单的几何形状。这项高级实践将指导你开发一个有限元程序，以求解任意多边形截面的翘曲函数和扭转常数。该练习将理论与现代工程实践联系起来，为扭转分析提供了一个强大而通用的工具。",
            "id": "2710723",
            "problem": "考虑一根长度远大于其横截面尺寸的单连通棱柱杆的Saint-Venant扭转问题，其通用多边形横截面由有界域 $\\Omega \\subset \\mathbb{R}^2$ 表示，边界 $\\partial \\Omega$ 上的外单位法向量为 $\\boldsymbol{n} = (n_x,n_y)$。设单位长度扭转角为 $\\kappa = d\\theta/dz$，剪切模量为 $G$。引入翘曲函数 $\\Phi(x,y)$，使得杆件局部的轴向位移为 $u_z(x,y) = \\kappa \\, \\Phi(x,y)$。剪切应变为\n$\\gamma_{xz} = \\kappa \\left(\\partial \\Phi/\\partial x - y \\right)$ 和 $\\gamma_{yz} = \\kappa \\left(\\partial \\Phi/\\partial y + x \\right)$，剪切应力通过胡克定律由线性弹性关系得出：$\\tau_{xz} = G \\, \\gamma_{xz}$ 和 $\\tau_{yz} = G \\, \\gamma_{yz}$。在没有体力的情况下，平衡方程要求在 $\\Omega$ 内 $\\partial \\tau_{xz}/\\partial x + \\partial \\tau_{yz}/\\partial y = 0$。侧表面是无面力的，因此在 $\\partial \\Omega$ 上 $\\tau_{xz} n_x + \\tau_{yz} n_y = 0$。\n\n从这些基本运动学、本构关系和平衡方程出发，完成以下任务：\n\n1) 推导域 $\\Omega$ 内翘曲函数 $\\Phi(x,y)$ 边值问题的强形式，证明它在内部满足齐次拉普拉斯方程，并在边界 $\\partial \\Omega$ 上满足一个诺伊曼型（Neumann-type）边界条件。用 $x$、$y$、$n_x$ 和 $n_y$ 显式写出自然边界数据。\n\n2) 推导弱形式：求 $\\Phi \\in H^{1}(\\Omega)$，在相差一个加性常数的意义下唯一，使得涉及 $\\nabla \\Phi$ 和检验函数梯度的双线性形式等于一个涉及自然边界数据和检验函数的边界积分。清晰地陈述你为消除零空间所采用的归一化条件。\n\n3) 使用有限元法 (FEM) 对弱形式进行离散化，在 $\\Omega$ 的一个协调三角剖分 $\\mathcal{T}_h$ 上使用连续分片线性形函数。对于一个顶点为 $(x_1,y_1)$、$(x_2,y_2)$、$(x_3,y_3)$ 的三角形单元 $e$，定义标准的线性形函数 $N_i(x,y)$，$i \\in \\{1,2,3\\}$，及其梯度 $\\nabla N_i$（在单元 $e$ 上为常数）。显式写出单元刚度矩阵 $K^{(e)} \\in \\mathbb{R}^{3 \\times 3}$ 和由位于 $\\partial \\Omega$ 上的单元 $e$ 的边界边产生的一致诺伊曼载荷向量贡献 $f^{(e,\\partial)} \\in \\mathbb{R}^{3}$。\n\n你的单元公式必须以三角形顶点坐标的闭合形式给出，对于一个端节点为 $i$ 和 $j$ 的边界边，公式应是边长、外单位法向量和端节点坐标的函数。在一个面积为 $A_e$ 的三角形 $e$ 上，使用以下定义和常规常数\n$$\nb_1 = y_2 - y_3,\\quad b_2 = y_3 - y_1,\\quad b_3 = y_1 - y_2, \\qquad\nc_1 = x_3 - x_2,\\quad c_2 = x_1 - x_3,\\quad c_3 = x_2 - x_1,\n$$\n以及 $A_e = \\tfrac{1}{2} \\left| (x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1) \\right|$。\n\n4) 实现一个程序，该程序：\n- 使用第3部分推导的显式单元公式，组装 $\\Phi$ 的全局刚度矩阵和载荷向量。\n- 通过将一个节点的 $\\Phi$ 值固定为零（单点狄利克雷约束）来保证唯一性。\n- 求解 $\\Phi$ 的节点值。\n- 使用恒等式（在单位长度扭转角和单位剪切模量下）计算扭转常数 $J$\n$$\nJ \\;=\\; \\int_{\\Omega} \\left[ \\left(\\frac{\\partial \\Phi}{\\partial x} - y \\right)^{2} + \\left(\\frac{\\partial \\Phi}{\\partial y} + x \\right)^{2} \\right] \\, dA,\n$$\n其中梯度 $\\partial \\Phi/\\partial x$ 和 $\\partial \\Phi/\\partial y$ 在每个线性三角形上是常数。对于单元上的数值积分，你必须使用在三角形上2次精确的求积法则。\n\n对于数值计算，设置单位长度扭转角为 $\\kappa = 1$ (弧度/米)，剪切模量为 $G = 1$ (帕斯卡)。以四次方米 $\\text{m}^4$ 为单位报告 $J$。\n\n测试套件（所有长度单位为米，角度单位为弧度）：\n- 情况A (正常路径): 正方形 $\\Omega = [0,1] \\times [0,1]$，用一个 $2 \\times 2$ 的结构化网格离散化，每个矩形沿从左下角到右上角的对角线分割成两个三角形。\n- 情况B (边界情况，最简网格): 顶点为 $(0,0)$、$(1,0)$、$(0,1)$ 的直角三角形，离散化为单个线性三角形。\n- 情况C (纵横比压力测试): 细长矩形 $\\Omega = [0,2] \\times [0,0.5]$，用一个 $4 \\times 1$ 的结构化网格离散化，每个矩形沿从左下角到右上角的对角线分割成两个三角形。\n\n角度单位：弧度。$J$ 的物理单位：$\\text{m}^4$。将输出表示为以 $\\text{m}^4$ 为单位的实数。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[resultA,resultB,resultC]\"），其中每个条目是按此顺序为情况A、B和C计算出的 $J$ 值，单位为 $\\text{m}^4$。",
            "solution": "我们从Saint-Venant扭转的基本运动学和平衡定律出发，基于线性弹性、小应变和无面力侧表面的假设。令 $\\kappa = d\\theta/dz$ 表示单位长度扭转角。翘曲函数 $\\Phi(x,y)$ 通过轴向位移 $u_z(x,y) = \\kappa \\, \\Phi(x,y)$ 定义。剪切应变为\n$$\n\\gamma_{xz} = \\kappa\\Big(\\frac{\\partial \\Phi}{\\partial x} - y \\Big), \\qquad\n\\gamma_{yz} = \\kappa\\Big(\\frac{\\partial \\Phi}{\\partial y} + x \\Big).\n$$\n根据胡克定律，剪切应力为\n$$\n\\tau_{xz} = G \\, \\gamma_{xz} = G \\kappa \\Big(\\frac{\\partial \\Phi}{\\partial x} - y \\Big), \\qquad\n\\tau_{yz} = G \\, \\gamma_{yz} = G \\kappa \\Big(\\frac{\\partial \\Phi}{\\partial y} + x \\Big).\n$$\n在没有体力的情况下，静力平衡要求\n$$\n\\frac{\\partial \\tau_{xz}}{\\partial x} + \\frac{\\partial \\tau_{yz}}{\\partial y} = 0 \\quad \\text{in } \\Omega.\n$$\n代入剪切应力可得\n$$\nG \\kappa \\left( \\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial y^2} \\right) = 0 \\quad \\Rightarrow \\quad \\nabla^2 \\Phi = 0 \\quad \\text{in } \\Omega,\n$$\n因此翘曲函数解一个齐次拉普拉斯方程。侧表面上的无面力条件是\n$$\n\\tau_{xz} n_x + \\tau_{yz} n_y = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n代入后得到\n$$\nG \\kappa \\left[ \\Big(\\frac{\\partial \\Phi}{\\partial x} - y \\Big) n_x + \\Big(\\frac{\\partial \\Phi}{\\partial y} + x \\Big) n_y \\right] = 0.\n$$\n对于非零的 $G$ 和 $\\kappa$，这简化为诺伊曼边界条件\n$$\n\\frac{\\partial \\Phi}{\\partial n} \\equiv \\nabla \\Phi \\cdot \\boldsymbol{n} = y \\, n_x - x \\, n_y \\quad \\text{on } \\partial \\Omega.\n$$\n因为带有纯诺伊曼数据的拉普拉斯算子在相差一个加性常数的意义下确定 $\\Phi$，我们通过归一化来固定其唯一性；例如，\n$$\n\\int_{\\Omega} \\Phi \\, dA = 0,\n$$\n或者，在数值上通过将一个节点值设为零。\n\n弱形式。将 $\\nabla^2 \\Phi = 0$ 乘以一个任意检验函数 $v \\in H^1(\\Omega)$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (\\nabla^2 \\Phi) \\, v \\, dA = 0.\n$$\n应用格林恒等式，\n$$\n- \\int_{\\Omega} \\nabla \\Phi \\cdot \\nabla v \\, dA + \\int_{\\partial \\Omega} \\frac{\\partial \\Phi}{\\partial n} \\, v \\, ds = 0.\n$$\n使用自然边界数据 $\\partial \\Phi/\\partial n = y n_x - x n_y$，弱形式为：\n求 $\\Phi \\in H^1(\\Omega)$，在相差一个加性常数的意义下唯一，使得\n$$\n\\int_{\\Omega} \\nabla \\Phi \\cdot \\nabla v \\, dA = \\int_{\\partial \\Omega} (y n_x - x n_y) \\, v \\, ds \\qquad \\forall v \\in H^1(\\Omega),\n$$\n并带有用于固定零空间的归一化条件。\n\n使用线性三角形的有限元法 (FEM) 离散化。令 $\\mathcal{T}_h$ 为 $\\Omega$ 的一个协调三角剖分。在一个顶点为 $(x_1,y_1)$、$(x_2,y_2)$、$(x_3,y_3)$ 且面积为 $A_e$ 的单元 $e$ 上，线性形函数为\n$$\nN_i(x,y) = \\frac{a_i + b_i x + c_i y}{2 A_e}, \\quad i \\in \\{1,2,3\\},\n$$\n其中常数为\n$$\nb_1 = y_2 - y_3,\\quad b_2 = y_3 - y_1,\\quad b_3 = y_1 - y_2, \\qquad\nc_1 = x_3 - x_2,\\quad c_2 = x_1 - x_3,\\quad c_3 = x_2 - x_1,\n$$\n梯度为\n$$\n\\nabla N_i = \\frac{1}{2 A_e}\\begin{bmatrix} b_i \\\\ c_i \\end{bmatrix},\n$$\n梯度在单元 $e$ 上是常数。单元刚度矩阵 $K^{(e)} \\in \\mathbb{R}^{3 \\times 3}$ 的项为\n$$\nK^{(e)}_{ij} = \\int_{e} \\nabla N_i \\cdot \\nabla N_j \\, dA = \\frac{b_i b_j + c_i c_j}{4 A_e}, \\quad i,j \\in \\{1,2,3\\}.\n$$\n边界边上的诺伊曼载荷向量。假设一个端节点为 $i$ 和 $j$ 的单元边位于 $\\partial \\Omega$ 上。设边长为 $L_{ij}$，外单位法向量为 $\\boldsymbol{n} = (n_x,n_y)$，它在一条直边上是常数。用 $t \\in [0,1]$ 参数化该边，使得位置为 $\\boldsymbol{x}(t) = \\boldsymbol{x}_i + t (\\boldsymbol{x}_j - \\boldsymbol{x}_i)$，其中 $\\boldsymbol{x}_i = (x_i,y_i)$ 且 $\\Delta \\boldsymbol{x} = \\boldsymbol{x}_j - \\boldsymbol{x}_i = (\\Delta x, \\Delta y)$。限制在边上的形函数为 $N_i(t) = 1-t$ 和 $N_j(t) = t$。自然边界数据为 $g(t) = y(t) n_x - x(t) n_y$。一致边载荷贡献为\n$$\nf_i^{(e,\\partial)} = \\int_{\\text{edge }ij} N_i \\, g \\, ds = L_{ij} \\int_0^1 (1-t)\\, [A + t B] \\, dt\n= L_{ij} \\left( \\frac{A}{2} + \\frac{B}{6} \\right),\n$$\n$$\nf_j^{(e,\\partial)} = \\int_{\\text{edge }ij} N_j \\, g \\, ds = L_{ij} \\int_0^1 t\\, [A + t B] \\, dt\n= L_{ij} \\left( \\frac{A}{2} + \\frac{B}{3} \\right),\n$$\n其中\n$$\nA = y_i n_x - x_i n_y, \\qquad B = \\Delta y \\, n_x - \\Delta x \\, n_y, \\qquad L_{ij} = \\sqrt{(\\Delta x)^2 + (\\Delta y)^2}.\n$$\n弱形式中没有体源项，因此内部单元载荷向量为零。\n\n全局系统和约束。对所有单元进行组装，得到一个对称半正定矩阵 $K$ 和载荷向量 $f$。为消除常数零空间，我们施加一个狄利克雷约束，例如 $\\Phi(\\text{node }1) = 0$，通过修改 $K$ 的相应行和列以及右端项 $f$ 来实现。\n\n扭转常数的后处理。在单位长度扭转角 $\\kappa = 1$ 和单位剪切模量 $G=1$ 的情况下，扭转常数 $J$ 可以从翘曲解中计算得出\n$$\nJ \\;=\\; \\int_{\\Omega} \\left[ \\left(\\frac{\\partial \\Phi}{\\partial x} - y \\right)^{2} + \\left(\\frac{\\partial \\Phi}{\\partial y} + x \\right)^{2} \\right] \\, dA.\n$$\n在一个线性三角形单元上，$\\nabla \\Phi$ 是常数：\n$$\n\\nabla \\Phi|_{e} = \\sum_{i=1}^{3} \\Phi_i \\, \\nabla N_i = \\frac{1}{2 A_e} \\begin{bmatrix} \\sum_{i=1}^3 \\Phi_i b_i \\\\ \\sum_{i=1}^3 \\Phi_i c_i \\end{bmatrix}.\n$$\n在单元 $e$ 上定义常数 $p_e = \\partial \\Phi/\\partial x$ 和 $q_e = \\partial \\Phi/\\partial y$。被积函数是关于 $x$ 和 $y$ 的二次函数，因此在三角形上使用2次精确求积法则即可。使用三点对称法则，重心坐标点为 $(\\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6})$、$(\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6})$、$(\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3})$，权重均为 $A_e/3$。在每个坐标为 $(x_q,y_q)$ 的求积点上，计算\n$$\nq_e(x_q,y_q) = \\left(p_e - y_q \\right)^2 + \\left(q_e + x_q \\right)^2,\n$$\n并求和 $J_e = \\sum_{q=1}^{3} \\left( \\frac{A_e}{3} \\, q_e(x_q,y_q) \\right)$。全局扭转常数为 $J = \\sum_{e} J_e$。\n\n算法实现摘要：\n- 为三个测试用例生成网格。\n- 对每个网格，使用 $K^{(e)}_{ij} = (b_i b_j + c_i c_j)/(4 A_e)$ 从单元刚度矩阵组装 $K$。\n- 使用 $A$ 和 $B$ 的闭合形式表达式以及从边的几何形状计算出的外单位法向量，通过对边界边贡献 $f_i^{(e,\\partial)}$ 求和来构建诺伊曼载荷向量 $f$。\n- 将一个节点处的 $\\Phi$ 设为零以固定常数零空间，并求解 $K \\Phi = f$。\n- 通过2次精确三角形求积法则计算 $J$。\n- 以 $\\text{m}^4$ 为单位报告三个情况下的 $J$。\n\n程序遵守要求的单位：单位长度扭转角 $\\kappa$ (设为 $\\kappa = 1$) 的单位为弧度/米，剪切模量 $G$ (设为 $G=1$) 的单位为帕斯卡，输出 $J$ 的单位为 $\\text{m}^4$。\n\n最终输出格式是单行文本，包含一个用方括号括起来的逗号分隔列表，即\"[resultA,resultB,resultC]\"。",
            "answer": "```python\nimport numpy as np\n\ndef triangle_area(coords):\n    x1, y1 = coords[0]\n    x2, y2 = coords[1]\n    x3, y3 = coords[2]\n    return 0.5 * abs((x2 - x1)*(y3 - y1) - (x3 - x1)*(y2 - y1))\n\ndef tri_bc_constants(coords):\n    # Returns arrays b and c for a 3-node triangle with nodes in order (1,2,3)\n    x1, y1 = coords[0]\n    x2, y2 = coords[1]\n    x3, y3 = coords[2]\n    b = np.array([y2 - y3, y3 - y1, y1 - y2], dtype=float)\n    c = np.array([x3 - x2, x1 - x3, x2 - x1], dtype=float)\n    return b, c\n\ndef tri_stiffness(coords):\n    # Linear triangle element stiffness for Laplace operator\n    A = triangle_area(coords)\n    b, c = tri_bc_constants(coords)\n    Ke = (np.outer(b, b) + np.outer(c, c)) / (4.0 * A)\n    return Ke\n\ndef edge_outward_normal(p_i, p_j, centroid):\n    # Compute outward unit normal for boundary edge ij using centroid test\n    v = p_j - p_i\n    L = np.linalg.norm(v)\n    if L == 0.0:\n        return np.array([0.0, 0.0]), 0.0\n    # Candidate normal by rotating edge vector by -90 degrees (clockwise): (vy, -vx)\n    n = np.array([v[1], -v[0]]) / L\n    mid = 0.5 * (p_i + p_j)\n    # Flip if not pointing outward: dot(n, mid - centroid) should be > 0\n    if np.dot(n, mid - centroid)  0.0:\n        n = -n\n    return n, L\n\ndef assemble_system(nodes, elements):\n    N = len(nodes)\n    K = np.zeros((N, N), dtype=float)\n    f = np.zeros(N, dtype=float)\n\n    # Assemble stiffness\n    for elem in elements:\n        coords = nodes[np.array(elem)]\n        Ke = tri_stiffness(coords)\n        for a_local, a_global in enumerate(elem):\n            for b_local, b_global in enumerate(elem):\n                K[a_global, b_global] += Ke[a_local, b_local]\n\n    # Identify boundary edges (edges that appear only once)\n    edge_count = {}\n    edge_dir = {}\n    for elem in elements:\n        for (i_local, j_local) in [(0,1), (1,2), (2,0)]:\n            i = elem[i_local]\n            j = elem[j_local]\n            key = (min(i, j), max(i, j))\n            if key not in edge_count:\n                edge_count[key] = 0\n                edge_dir[key] = (i, j)  # store directed edge as first seen\n            edge_count[key] += 1\n\n    # Compute domain centroid (for outward normal orientation)\n    centroid = np.mean(nodes, axis=0)\n\n    # Assemble Neumann load from boundary edges\n    for key, count in edge_count.items():\n        if count == 1:\n            i, j = edge_dir[key]\n            pi = nodes[i]\n            pj = nodes[j]\n            n, L = edge_outward_normal(pi, pj, centroid)\n            nx, ny = n\n            xi, yi = pi\n            dx, dy = pj - pi\n\n            A_val = yi * nx - xi * ny\n            B_val = dy * nx - dx * ny\n\n            fi = L * (0.5 * A_val + (1.0/6.0) * B_val)\n            fj = L * (0.5 * A_val + (1.0/3.0) * B_val)\n\n            f[i] += fi\n            f[j] += fj\n\n    return K, f\n\ndef apply_dirichlet_constraint(K, f, node_index, value=0.0):\n    # Enforce Phi(node_index) = value\n    n = K.shape[0]\n    K[node_index, :] = 0.0\n    K[:, node_index] = 0.0\n    K[node_index, node_index] = 1.0\n    f[node_index] = value\n    return K, f\n\ndef solve_system(K, f):\n    return np.linalg.solve(K, f)\n\ndef tri_grad_phi(coords, phi_local):\n    # Compute constant gradient on linear triangle: grad Phi = 1/(2A) * [sum(phi_i b_i), sum(phi_i c_i)]\n    A = triangle_area(coords)\n    b, c = tri_bc_constants(coords)\n    px = np.dot(phi_local, b) / (2.0 * A)\n    py = np.dot(phi_local, c) / (2.0 * A)\n    return px, py, A\n\ndef tri_quadrature_points(coords):\n    # Degree-2 exact symmetric quadrature: 3 points, barycentric coords\n    lams = np.array([\n        [2.0/3.0, 1.0/6.0, 1.0/6.0],\n        [1.0/6.0, 2.0/3.0, 1.0/6.0],\n        [1.0/6.0, 1.0/6.0, 2.0/3.0]\n    ])\n    pts = []\n    for lam in lams:\n        x = lam[0]*coords[0,0] + lam[1]*coords[1,0] + lam[2]*coords[2,0]\n        y = lam[0]*coords[0,1] + lam[1]*coords[1,1] + lam[2]*coords[2,1]\n        pts.append((x, y))\n    return pts\n\ndef compute_J(nodes, elements, phi):\n    # Unit twist kappa=1, unit shear modulus G=1\n    J = 0.0\n    for elem in elements:\n        coords = nodes[np.array(elem)]\n        phi_local = phi[np.array(elem)]\n        px, py, A = tri_grad_phi(coords, phi_local)\n        # Quadrature\n        w = A / 3.0\n        for (xq, yq) in tri_quadrature_points(coords):\n            integrand = (px - yq)**2 + (py + xq)**2\n            J += w * integrand\n    return J\n\ndef rect_mesh(width, height, nx, ny):\n    # Structured rectangular mesh, split each cell by diagonal from (i,j) to (i+1,j+1)\n    xs = np.linspace(0.0, width, nx+1)\n    ys = np.linspace(0.0, height, ny+1)\n    nodes = np.array([(x, y) for y in ys for x in xs], dtype=float)\n    def node_id(i, j):\n        return j*(nx+1) + i\n    elements = []\n    for j in range(ny):\n        for i in range(nx):\n            n00 = node_id(i, j)\n            n10 = node_id(i+1, j)\n            n01 = node_id(i, j+1)\n            n11 = node_id(i+1, j+1)\n            # Two triangles: (n00, n10, n11) and (n00, n11, n01)\n            elements.append([n00, n10, n11])\n            elements.append([n00, n11, n01])\n    return nodes, elements\n\ndef right_triangle_mesh():\n    # Single triangle with vertices (0,0), (1,0), (0,1)\n    nodes = np.array([[0.0, 0.0],\n                      [1.0, 0.0],\n                      [0.0, 1.0]], dtype=float)\n    elements = [[0, 1, 2]]\n    return nodes, elements\n\ndef run_case(nodes, elements):\n    K, f = assemble_system(nodes, elements)\n    # Fix one node to zero (e.g., node 0)\n    Kc, fc = apply_dirichlet_constraint(K, f, node_index=0, value=0.0)\n    phi = solve_system(Kc, fc)\n    J = compute_J(nodes, elements, phi)\n    return J\n\ndef solve():\n    # Test cases:\n    # Case A: Unit square [0,1]x[0,1], 2x2 grid\n    nodes_A, elems_A = rect_mesh(1.0, 1.0, nx=2, ny=2)\n    JA = run_case(nodes_A, elems_A)\n\n    # Case B: Right triangle single element\n    nodes_B, elems_B = right_triangle_mesh()\n    JB = run_case(nodes_B, elems_B)\n\n    # Case C: Thin rectangle [0,2]x[0,0.5], 4x1 grid\n    nodes_C, elems_C = rect_mesh(2.0, 0.5, nx=4, ny=1)\n    JC = run_case(nodes_C, elems_C)\n\n    results = [JA, JB, JC]\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}