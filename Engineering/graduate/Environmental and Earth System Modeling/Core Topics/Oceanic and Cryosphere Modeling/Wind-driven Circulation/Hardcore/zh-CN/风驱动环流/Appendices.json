{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的推导过程之前，物理学中一个至关重要的步骤是验证基本方程的量纲一致性。斯维尔德鲁普（Sverdrup）平衡是风生环流理论的基石，本练习旨在通过量纲分析来检验其构成项。这项实践不仅能提升你对物理量纲的掌握能力，还能加深你对斯维尔德鲁普平衡中每一项物理意义的理解。",
            "id": "3932825",
            "problem": "在大尺度风生海洋环流的背景下，考虑科里奥利参数的经向梯度和一个深度积分的经向输送，以及由一个恒定参考密度归一化的风应力水平旋度的垂直分量。从以下基本定义和事实出发：\n- 科里奥利参数定义为 $f = 2 \\Omega \\sin \\varphi$，其中 $\\Omega$ 是地球自转速率，量纲为 $\\mathrm{s}^{-1}$，$\\varphi$ 是纬度（无量纲）。经向梯度为 $\\beta = \\partial f / \\partial y$，其中 $y$ 是经向坐标，量纲为 $\\mathrm{m}$。\n- 经向输送 $V$ 是经向速度 $v$ 沿深度 $z$ 的垂直积分，即 $V = \\int v \\, \\mathrm{d}z$，其中 $v$ 的量纲为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$z$ 的量纲为 $\\mathrm{m}$。\n- 风应力 $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ 是大气作用在海洋表面的单位面积上的力，量纲为 $\\mathrm{N}\\,\\mathrm{m}^{-2}$；根据牛顿第二定律，我们知道 $\\mathrm{N} = \\mathrm{kg}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- 水平旋度的垂直分量是 $\\operatorname{curl}_z \\boldsymbol{\\tau} = \\partial \\tau_y / \\partial x - \\partial \\tau_x / \\partial y$，在量纲分析中，对 $x$ 和 $y$ 的偏导数各自贡献一个反比长度因子 $\\mathrm{m}^{-1}$。\n- 恒定参考密度 $\\rho_0$ 的量纲为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n\n仅使用这些基础知识，确定两个构造量 $\\beta V$ 和 $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$ 各自的国际单位制（SI）基本单位幂向量，并验证它们是相同的。将公共的SI基本单位幂向量按 $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ 的顺序列为一个单行矩阵报告。不需要数值，也不需要四舍五入。在最终的方框答案中不要包含单位；只提供对应于 $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ 的整数指数。",
            "solution": "该问题要求对风生海洋环流中斯维尔德鲁普平衡的两个核心量进行量纲分析：行星涡度平流项 $\\beta V$ 和风应力旋度项 $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$。目标是确定每个量的SI基本单位幂向量并验证它们是相同的。我们将使用质量（$M$）、长度（$L$）和时间（$T$）的基本量纲，它们分别对应于SI基本单位千克（$\\mathrm{kg}$）、米（$\\mathrm{m}$）和秒（$\\mathrm{s}$）。\n\n首先，我们分析 $\\beta V$ 项。这需要分别找出 $\\beta$ 和 $V$ 的量纲。\n\n科里奥利参数的经向梯度是 $\\beta = \\partial f / \\partial y$。$\\beta$ 的量纲（记为 $[\\beta]$）是 $f$ 的量纲除以 $y$ 的量纲。\n科里奥利参数 $f$ 由 $f = 2 \\Omega \\sin \\varphi$ 给出。\n- 因子 $2$ 是一个无量纲数。\n- 地球自转速率 $\\Omega$ 的量纲已知为时间的倒数，所以 $[\\Omega] = T^{-1}$。\n- 纬度 $\\varphi$ 及其正弦值 $\\sin \\varphi$ 都是无量纲量。\n因此，科里奥利参数的量纲是 $[f] = T^{-1}$。\n经向坐标 $y$ 是一个长度，所以 $[y] = L$。\n综合这些，$\\beta$ 的量纲是：\n$$ [\\beta] = \\frac{[f]}{[y]} = \\frac{T^{-1}}{L} = L^{-1} T^{-1} $$\n\n接下来，我们求经向输送 $V$ 的量纲。其定义为 $V = \\int v \\, \\mathrm{d}z$。积分的量纲是被积函数和微分的量纲的乘积。\n- 经向速度 $v$ 的量纲是长度每时间，所以 $[v] = L T^{-1}$。\n- 深度坐标 $z$ 是一个长度，所以微分 $\\mathrm{d}z$ 的量纲也是长度，$[\\mathrm{d}z] = L$。\n因此，经向输送 $V$ 的量纲是：\n$$ [V] = [v] [z] = (L T^{-1}) (L) = L^2 T^{-1} $$\n\n现在，我们可以求出乘积 $\\beta V$ 的量纲：\n$$ [\\beta V] = [\\beta] [V] = (L^{-1} T^{-1}) (L^2 T^{-1}) = L^{(-1+2)} T^{(-1-1)} = L^1 T^{-2} $$\n用SI基本单位 $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ 表示，对应的量纲是 $M^0 L^1 T^{-2}$。这给出的幂向量是 $(0, 1, -2)$。\n\n第二，我们分析 $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$ 项。我们首先确定分子 $\\operatorname{curl}_z \\boldsymbol{\\tau}$ 的量纲。\n\n风应力 $\\boldsymbol{\\tau}$ 是单位面积上的力，给出的量纲为 $\\mathrm{N}\\,\\mathrm{m}^{-2}$。\n- 牛顿（$\\mathrm{N}$）是力的单位，根据牛顿第二定律（$F=ma$），其量纲为质量乘以加速度。所以，$[\\mathrm{N}] = M L T^{-2}$。\n- 面积的量纲是 $L^2$。\n因此，风应力的量纲是：\n$$ [\\boldsymbol{\\tau}] = \\frac{M L T^{-2}}{L^2} = M L^{-1} T^{-2} $$\n\n风应力水平旋度的垂直分量是 $\\operatorname{curl}_z \\boldsymbol{\\tau} = \\partial \\tau_y / \\partial x - \\partial \\tau_x / \\partial y$。对空间坐标（$x$ 或 $y$）求导会引入一个反比长度的量纲，$L^{-1}$。\n因此，$\\operatorname{curl}_z \\boldsymbol{\\tau}$ 的量纲是：\n$$ [\\operatorname{curl}_z \\boldsymbol{\\tau}] = \\frac{[\\boldsymbol{\\tau}]}{L} = \\frac{M L^{-1} T^{-2}}{L} = M L^{-2} T^{-2} $$\n\n接下来，我们考虑分母，即参考密度 $\\rho_0$。\n- 密度是单位体积的质量。体积的量纲是 $L^3$。\n$\\rho_0$ 的量纲给出为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，对应于：\n$$ [\\rho_0] = M L^{-3} $$\n\n最后，我们结合分子和分母的量纲来求整个表达式的量纲：\n$$ \\left[\\frac{\\operatorname{curl}_z \\boldsymbol{\\tau}}{\\rho_0}\\right] = \\frac{[\\operatorname{curl}_z \\boldsymbol{\\tau}]}{[\\rho_0]} = \\frac{M L^{-2} T^{-2}}{M L^{-3}} = M^{(1-1)} L^{(-2 - (-3))} T^{-2} = M^0 L^1 T^{-2} $$\n用SI基本单位 $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ 表示，这对应于量纲 $M^0 L^1 T^{-2}$。这给出的幂向量是 $(0, 1, -2)$。\n\n两个量 $\\beta V$ 和 $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$ 都具有 $L T^{-2}$ 的量纲，这是加速度的量纲。量纲分析证实了它们是相同的，这与被称为斯维尔德鲁普平衡的物理定律一致。按 $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ 顺序排列的公共SI基本单位幂向量是 $(0, 1, -2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  -2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "斯维尔德鲁普平衡将风应力旋度与海洋内部的流动联系起来，但其背后的物理机制是什么？本练习将探讨这一关键环节：埃克曼（Ekman）抽吸。通过推导埃克曼层底部的垂直速度，你将理解地表风场如何驱动垂直运动，进而拉伸或压缩下方的水柱，从而启动大规模的斯维尔德鲁普输运。",
            "id": "3932817",
            "problem": "在中纬度，一个无限宽的均匀海洋受到一个稳定、水平变化的表面风应力场的强迫，该风应力场的典型振幅为 $\\tau_{0}$，水平涡度尺度为 $|\\partial \\tau_{y}/\\partial x - \\partial \\tau_{x}/\\partial y|$。假设流体为Boussinesq流体，密度 $\\rho$ 恒定，科里奥利参数 $f$ 恒定，并且存在一个厚度为 $h_{E}$ 的湍流埃克曼层。在该层中，稳定的线性水平动量平衡表现为科里奥利力与湍流应力垂直散度之间的平衡。$z=-h_{E}$ 以下的内部区域是无粘性、静水和地转的，并且 $z=-h_{E}$ 处的垂直速度与进入风生Sverdrup环流的内部垂直速度相匹配。海洋表面的运动学边界条件是无穿透流，因此 $w(z=0)=0$，并且湍流应力在埃克曼层底部消失。\n\n仅从这些原理（稳态埃克曼层动量方程和不可压缩性）以及 $z=0$ 处的表面应力边界条件出发，推导埃克曼层底部垂直速度 $w_{E}\\equiv w(z=-h_{E})$ 的表达式，该表达式应使用表面风应力的水平导数以及参数 $\\rho$ 和 $f$ 来表示。然后，在典型的中纬度条件下，计算 $w_{E}$ 的量级：\n- $\\tau_{0} = 0.1\\,\\mathrm{N\\,m^{-2}}$，\n- $f = 10^{-4}\\,\\mathrm{s^{-1}}$，\n- $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$，\n- $\\left|\\partial \\tau_{y}/\\partial x - \\partial \\tau_{x}/\\partial y\\right| = 10^{-7}\\,\\mathrm{N\\,m^{-3}}$。\n\n将 $w_{E}$ 量级的最终数值答案以米/天为单位表示，并将结果四舍五入到三位有效数字。",
            "solution": "### 验证问题\n该问题是物理海洋学中的一个经典练习，旨在推导埃克曼抽吸的概念。\n- **科学依据：** 该问题基于应用于地球物理系统的流体动力学基本原理，特别是埃克曼层理论。\n- **适定性：** 所有必要的物理原理、边界条件和参数均已提供，足以推导出埃克曼抽吸速度的唯一表达式并计算其数值。\n- **客观性：** 问题陈述使用了物理海洋学中的精确、标准术语。\n- **完整性：** 问题陈述完整、自洽。提及Sverdrup环流为 $w_E$ 的重要性提供了背景，但其推导并不需要，推导过程被正确定位在埃克曼层动力学范围内。\n- **一致性：** 给定的数值对于中纬度海洋条件是物理上现实的。问题陈述中没有矛盾。\n\n问题有效。将提供完整的解法。\n\n### 埃克曼抽吸速度的推导\n\n问题指明，埃克曼层中的稳态线性水平动量平衡表现为科里奥利力与湍流应力垂直散度之间的平衡。在一个标准的右手坐标系中，$z$ 轴指向上方，这些方程为：\n$$ -fv = \\frac{1}{\\rho}\\frac{\\partial \\tau_x}{\\partial z} $$\n$$ fu = \\frac{1}{\\rho}\\frac{\\partial \\tau_y}{\\partial z} $$\n此处，$(u, v)$ 是水平速度分量，$f$ 是恒定的科里奥利参数，$\\rho$ 是恒定的密度，$(\\tau_x, \\tau_y)$ 是水平湍流应力矢量的分量。\n\n为了求出埃克曼层内的总输送，我们将这些方程从该层的底部 $z = -h_E$ 到表面 $z=0$ 进行垂直积分：\n$$ \\int_{-h_E}^{0} -fv \\, dz = \\frac{1}{\\rho} \\int_{-h_E}^{0} \\frac{\\partial \\tau_x}{\\partial z} \\, dz $$\n$$ \\int_{-h_E}^{0} fu \\, dz = \\frac{1}{\\rho} \\int_{-h_E}^{0} \\frac{\\partial \\tau_y}{\\partial z} \\, dz $$\n\n我们将经向和纬向埃克曼输送 $U_E$ 和 $V_E$ 定义为垂直积分的速度：\n$$ U_E = \\int_{-h_E}^{0} u \\, dz $$\n$$ V_E = \\int_{-h_E}^{0} v \\, dz $$\n\n积分后的动量方程变为：\n$$ -f V_E = \\frac{1}{\\rho} [\\tau_x(z=0) - \\tau_x(z=-h_E)] $$\n$$ f U_E = \\frac{1}{\\rho} [\\tau_y(z=0) - \\tau_y(z=-h_E)] $$\n\n我们应用给定的应力边界条件。在表面，湍流应力等于表面风应力，根据问题中涡度表达式的记法，我们将其表示为 $(\\tau_x, \\tau_y)$：$\\vec{\\tau}(z=0) = (\\tau_x, \\tau_y)$。在埃克曼层的底部，湍流应力消失：$\\vec{\\tau}(z=-h_E) = 0$。将这些代入输送方程，得到：\n$$ -f V_E = \\frac{\\tau_x}{\\rho} $$\n$$ f U_E = \\frac{\\tau_y}{\\rho} $$\n\n解出埃克曼输送，我们得到：\n$$ U_E = \\frac{\\tau_y}{f\\rho} $$\n$$ V_E = -\\frac{\\tau_x}{f\\rho} $$\n这表明，埃克曼层中的净输送在北半球（$f>0$）指向风应力的右侧，在南半球（$f0$）指向风应力的左侧。\n\n接下来，我们使用质量守恒原理。对于Boussinesq（不可压缩）流体，连续性方程为：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n我们将此方程沿埃克曼层从 $z=-h_E$ 到 $z=0$ 进行垂直积分：\n$$ \\int_{-h_E}^{0} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) dz + \\int_{-h_E}^{0} \\frac{\\partial w}{\\partial z} dz = 0 $$\n假设层厚 $h_E$ 是常数，我们可以交换积分和水平微分的顺序：\n$$ \\frac{\\partial}{\\partial x} \\left( \\int_{-h_E}^{0} u \\, dz \\right) + \\frac{\\partial}{\\partial y} \\left( \\int_{-h_E}^{0} v \\, dz \\right) + [w(z=0) - w(z=-h_E)] = 0 $$\n代入埃克曼输送 $U_E$ 和 $V_E$ 的定义，此式变为：\n$$ \\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} + w(z=0) - w(z=-h_E) = 0 $$\n问题陈述了表面的运动学边界条件为无穿透流，因此 $w(z=0) = 0$。埃克曼层底部的垂直速度定义为 $w_E \\equiv w(z=-h_E)$。该方程简化为：\n$$ w_E = \\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} $$\n这表明埃克曼层底部的垂直速度由埃克曼输送的水平散度决定。这种垂直运动被称为埃克曼抽吸（如果 $w_E  0$）或埃克曼吸抽（如果 $w_E > 0$）。\n\n现在，我们将用风应力表示的 $U_E$ 和 $V_E$ 的表达式代入：\n$$ w_E = \\frac{\\partial}{\\partial x}\\left(\\frac{\\tau_y}{f\\rho}\\right) + \\frac{\\partial}{\\partial y}\\left(-\\frac{\\tau_x}{f\\rho}\\right) $$\n由于 $\\rho$ 和 $f$ 为给定的常数，它们可以从导数中提取出来：\n$$ w_E = \\frac{1}{f\\rho} \\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right) $$\n括号中的项是表面风应力矢量旋度的垂直分量，$\\text{curl}_z(\\vec{\\tau}_s)$。因此，埃克曼速度的最终表达式为：\n$$ w_E = \\frac{\\text{curl}_z(\\vec{\\tau}_s)}{\\rho f} $$\n\n### 数值计算\n\n问题要求计算 $w_E$ 的量级。对推导出的表达式取绝对值：\n$$ |w_E| = \\left| \\frac{1}{\\rho f} \\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right) \\right| = \\frac{|\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}|}{|\\rho f|} $$\n给定的数值是：\n- $|\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}| = 10^{-7}\\,\\mathrm{N\\,m^{-3}}$\n- $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$\n- $f = 10^{-4}\\,\\mathrm{s^{-1}}$\n\n由于 $\\rho$ 和 $f$ 是正数，所以 $|\\rho f| = \\rho f$。代入数值：\n$$ |w_E| = \\frac{10^{-7}\\,\\mathrm{N\\,m^{-3}}}{(1025\\,\\mathrm{kg\\,m^{-3}})(10^{-4}\\,\\mathrm{s^{-1}})} $$\n$$ |w_E| = \\frac{10^{-7}}{1025 \\times 10^{-4}} \\,\\mathrm{m\\,s^{-1}} = \\frac{10^{-3}}{1025} \\,\\mathrm{m\\,s^{-1}} $$\n$$ |w_E| \\approx 9.756 \\times 10^{-7} \\,\\mathrm{m\\,s^{-1}} $$\n\n最终答案必须以米/天表示。我们进行单位换算：\n一天中的秒数是 $24 \\,\\text{小时} \\times 60 \\,\\text{分钟/小时} \\times 60 \\,\\text{秒/分钟} = 86400 \\,\\text{秒}$。\n$$ |w_E| \\, [\\mathrm{m\\,day^{-1}}] = |w_E| \\, [\\mathrm{m\\,s^{-1}}] \\times 86400 \\,\\mathrm{s\\,day^{-1}} $$\n$$ |w_E| = \\frac{10^{-3}}{1025} \\times 86400 \\,\\mathrm{m\\,day^{-1}} = \\frac{86.4}{1025} \\,\\mathrm{m\\,day^{-1}} $$\n$$ |w_E| \\approx 0.08429268... \\,\\mathrm{m\\,day^{-1}} $$\n\n将结果四舍五入到三位有效数字，我们得到：\n$$ |w_E| \\approx 0.0843 \\,\\mathrm{m\\,day^{-1}} $$",
            "answer": "$$\n\\boxed{0.0843}\n$$"
        },
        {
            "introduction": "最后的这项实践练习将理想化的理论与真实海洋的复杂性联系起来。你将应用斯维尔德鲁普关系式，根据观测的风应力数据计算整个海盆的内部总输运量。通过将这一理论计算结果与实测的西边界流输运量进行比较，你将对大尺度环流理论中最核心的预测之一——即内部输运与西边界流的质量平衡——进行定量检验。",
            "id": "3932892",
            "problem": "要求开发人员计算在给定纬度上由风强迫引起的全海盆积分的内部经向体积输运，并将其量值与测得的西边界流输运进行比较，两者均以斯维尔德鲁普（Sv）为单位表示。该计算必须从适用于旋转球体上大尺度风生环流的第一性原理推导得出，并采用稳态、线性、地转-静力平衡近似。从水平积分的动量方程及其涡度形式开始，采用稳态、内部非线性相对涡度平流和底应力可忽略不计，以及风应力作用于表面的假设。除了行星参数和运动学转换的标准定义外，不得使用任何捷径公式。程序必须沿经度对内部经向输运密度进行数值积分，以获得跨越该纬度的总输运。\n\n使用以下基本且经过充分检验的事实和定义：\n- 地球半径 $R = 6.371 \\times 10^{6}$ 米。\n- 地球自转速率 $\\Omega = 7.2921 \\times 10^{-5}$ 弧度/秒。\n- 海洋参考密度 $\\rho_0 = 1025$ 千克/立方米。\n- 纬度 $\\phi$ 处的科里奥利参数的经向导数（“行星涡度梯度”）为 $\\beta(\\phi) = \\dfrac{2 \\Omega \\cos \\phi}{R}$，其中 $\\phi$ 以弧度为单位。\n- 经度 $\\lambda$ 以度为单位；通过 $dx = R \\cos \\phi \\, \\Delta \\lambda \\, \\dfrac{\\pi}{180}$ 将其在纬度 $\\phi$ 处的差异转换为米。\n- 一斯维尔德鲁普（Sv）等于 $10^{6}$ 立方米/秒。\n\n任务：\n1. 对于每个测试案例，给定一个以度为单位的纬度 $\\phi$，一个从东边界到西边界以度为单位的经度序列 $\\{\\lambda_i\\}$，以及沿该纬度的同位置气候态风应力旋度值序列 $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\}$（单位为 $\\mathrm{N}/\\mathrm{m}^{3}$）。将给定序列视为在指定经度上的样本。\n2. 从旋转、层化海洋在地转和静力平衡近似下，受表面风应力强迫的稳态、深度积分的涡度平衡方程出发，推导出内部经向输运密度，并使用梯形法则对其进行纬向数值积分，以获得跨越该纬度的带符号的全海盆积分输运，单位为 $\\mathrm{Sv}$。使用的符号约定为：在北半球，正输运为北向；在南半球，正输运为南向，这由推导出的关系式中风应力旋度项的符号决定。\n3. 对每个测试案例，将计算出的内部输运的量值与所提供的实测西边界流输运（单位为 $\\mathrm{Sv}$）进行比较，并报告其绝对差值（单位为 $\\mathrm{Sv}$）。\n4. 所有角度输入均以度为单位；将纬度转换为弧度以用于三角函数。将最终差值以 $\\mathrm{Sv}$ 表示，并四舍五入到三位小数。\n\n测试套件（四个案例）：\n- 案例 A（大西洋，北半球中纬度）：\n  - 纬度 $\\phi = 26$ 度。\n  - 经度 $\\{\\lambda_i\\} = [0, -10, -20, -35, -50, -60]$ 度。\n  - 风应力旋度 $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [-0.6 \\times 10^{-7}, -0.8 \\times 10^{-7}, -1.1 \\times 10^{-7}, -1.2 \\times 10^{-7}, -0.9 \\times 10^{-7}, -0.7 \\times 10^{-7}]$ $\\mathrm{N}/\\mathrm{m}^{3}$。\n  - 实测西边界流输运 $= 27.3$ $\\mathrm{Sv}$。\n- 案例 B（对照组，风应力旋度为零）：\n  - 纬度 $\\phi = 30$ 度。\n  - 经度 $\\{\\lambda_i\\} = [0, -30]$ 度。\n  - 风应力旋度 $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.0, 0.0]$ $\\mathrm{N}/\\mathrm{m}^{3}$。\n  - 实测西边界流输运 $= 0.0$ $\\mathrm{Sv}$。\n- 案例 C（太平洋，北半球较高纬度，旋度符号有变化）：\n  - 纬度 $\\phi = 40$ 度。\n  - 经度 $\\{\\lambda_i\\} = [100, 80, 60, 40, 20, 0, -20]$ 度。\n  - 风应力旋度 $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.1 \\times 10^{-7}, 0.05 \\times 10^{-7}, -0.05 \\times 10^{-7}, -0.15 \\times 10^{-7}, -0.2 \\times 10^{-7}, -0.1 \\times 10^{-7}, 0.0]$ $\\mathrm{N}/\\mathrm{m}^{3}$。\n  - 实测西边界流输运 $= 37.9$ $\\mathrm{Sv}$。\n- 案例 D（印度洋，南半球）：\n  - 纬度 $\\phi = -20$ 度。\n  - 经度 $\\{\\lambda_i\\} = [60, 40, 20, 0, -20]$ 度。\n  - 风应力旋度 $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.05 \\times 10^{-7}, 0.07 \\times 10^{-7}, 0.09 \\times 10^{-7}, 0.08 \\times 10^{-7}, 0.06 \\times 10^{-7}]$ $\\mathrm{N}/\\mathrm{m}^{3}$。\n  - 实测西边界流输运 $= 28.0$ $\\mathrm{Sv}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是第 $i$ 个案例的计算内部输运量值与提供的实测西边界流输运之间的绝对差值，单位为 $\\mathrm{Sv}$，四舍五入到三位小数。",
            "solution": "该问题具有科学依据、内容自洽且良定，代表了物理海洋学中 Sverdrup 平衡理论的一个典型应用。所有必需的物理常数、边界条件和数据均已提供。任务是从第一性原理出发，推导全海盆积分的经向输运，并将其量值与西边界流的观测数据进行比较，这是对 Sverdrup 理论的直接检验。因此，该问题是有效的。\n\n**Sverdrup 平衡的推导**\n\nSverdrup 平衡描述了远离边界层的海洋内部稳态、大尺度的风生环流。推导始于旋转球体上不可压缩流体的水平动量方程，并采用地转和静力平衡近似。对于稳态（$\\partial / \\partial t = 0$），并忽略非线性平流和侧向摩擦，方程为：\n\n$$\n-f v = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_x}{\\partial z} \\\\\nf u = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_y}{\\partial z}\n$$\n\n此处，$u$ 和 $v$ 分别是纬向（东西向）和经向（南北向）的速度分量。坐标 $x$ 和 $y$ 分别指向东和北。$p$ 是压力，$\\rho_0$ 是海水的恒定参考密度，$\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ 是水平应力矢量。科里奥利参数为 $f = 2\\Omega\\sin\\phi$，其中 $\\Omega$ 是地球自转速率，$\\phi$ 是纬度。\n\n我们将这些方程从海底 $z = -H(x, y)$ 到海面 $z = 0$ 进行垂向积分。令 $U = \\int_{-H}^{0} u \\, dz$ 和 $V = \\int_{-H}^{0} v \\, dz$ 分别为纬向和经向的单位宽度体积输运（单位为 $\\mathrm{m}^2/\\mathrm{s}$）。\n\n对动量方程积分得到：\n\n$$\n-f V = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz + \\frac{1}{\\rho_0} \\left[ \\tau_x \\right]_{-H}^{0} \\\\\nf U = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz + \\frac{1}{\\rho_0} \\left[ \\tau_y \\right]_{-H}^{0}\n$$\n\n表面（$z=0$）的应力是风应力，$\\boldsymbol{\\tau}^w = (\\tau_x^w, \\tau_y^w)$。问题陈述我们可以忽略海洋内部的底应力，因此 $z=-H$ 处的应力为零。方程变为：\n\n$$\n-f V = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz + \\frac{\\tau_x^w}{\\rho_0} \\\\\nf U = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz + \\frac{\\tau_y^w}{\\rho_0}\n$$\n\n为获得涡度方程，我们对这个深度积分后的系统取旋度，即计算 $\\frac{\\partial}{\\partial x}(\\text{y-方程}) - \\frac{\\partial}{\\partial y}(\\text{x-方程})$：\n\n$$\n\\frac{\\partial}{\\partial x}(f U) - \\frac{\\partial}{\\partial y}(-f V) = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial x} \\left( \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz \\right) + \\frac{1}{\\rho_0} \\frac{\\partial}{\\partial y} \\left( \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz \\right) + \\frac{1}{\\rho_0} \\left( \\frac{\\partial \\tau_y^w}{\\partial x} - \\frac{\\partial \\tau_x^w}{\\partial y} \\right)\n$$\n\n假设压力足够光滑，微分和积分的顺序可以交换，压力项相互抵消：$\\frac{\\partial^2 p}{\\partial x \\partial y} = \\frac{\\partial^2 p}{\\partial y \\partial x}$。右侧简化为风应力旋度的垂直分量，$(\\nabla \\times \\boldsymbol{\\tau}^w)_z = \\frac{\\partial \\tau_y^w}{\\partial x} - \\frac{\\partial \\tau_x^w}{\\partial y}$，除以 $\\rho_0$。\n\n左侧展开为：\n$$\n\\frac{\\partial(fU)}{\\partial x} + \\frac{\\partial(fV)}{\\partial y} = f \\left( \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} \\right) + U \\frac{\\partial f}{\\partial x} + V \\frac{\\partial f}{\\partial y}\n$$\n\n不可压缩流体的深度积分连续性方程为 $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$，因此第一项消失。使用 β 平面近似，科里奥利参数 $f$ 被认为仅是纬度 $y$ 的函数，因此 $\\frac{\\partial f}{\\partial x} = 0$。$f$ 的经向梯度定义为行星涡度梯度，$\\beta = \\frac{df}{dy}$。问题提供了球面坐标形式，$\\beta(\\phi) = \\frac{2\\Omega\\cos\\phi}{R}$，其中 $R$ 是地球半径。因此左侧简化为 $\\beta V$。\n\n结合简化后的各项，我们得到 Sverdrup 关系式：\n$$\n\\beta V = \\frac{1}{\\rho_0} (\\nabla \\times \\boldsymbol{\\tau}^w)_z\n$$\n该方程表明，单位宽度的经向输运 $V$ 与当地风应力旋度的垂直分量成正比。我们可以解出 $V$，并将其确定为经向输运密度：\n$$\nV(x, y) = \\frac{1}{\\rho_0 \\beta(y)} (\\nabla \\times \\boldsymbol{\\tau}^w)_z(x, y)\n$$\n\n为求出跨越一个纬度线的总内部经向输运 $M_y$，我们必须将 $V$ 在整个海盆内从东边界 ($x_E$) 到西边界 ($x_W$) 进行纬向积分：\n$$\nM_y = \\int_{x_E}^{x_W} V(x) dx = \\int_{x_E}^{x_W} \\frac{1}{\\rho_0 \\beta} (\\nabla \\times \\boldsymbol{\\tau}^w)_z dx\n$$\n风生环流理论假定，这种宽广而缓慢的内部流动通过一个狭窄而快速的西边界流返回。为保证质量守恒，西边界流的输运 $M_{WBC}$ 必须与内部输运相平衡：$M_y + M_{WBC} = 0$，这意味着 $|M_y| = |M_{WBC}|$。本问题通过比较计算出的内部输运量值 $|M_y|$ 与实测的西边界流输运来检验这一理论上的等价性。\n\n**数值计算**\n\n对于每个固定纬度 $\\phi$ 的测试案例：\n1.  计算行星涡度梯度 $\\beta = \\frac{2\\Omega\\cos\\phi}{R}$。请注意，对于余弦函数，$\\phi$ 必须以弧度为单位。由于 $-90^\\circ  \\phi  90^\\circ$，$\\cos\\phi > 0$，因此 $\\beta$ 始终为正。\n2.  对于每个经度点 $i$，计算被积函数，即经向输运密度 $V_i = \\frac{1}{\\rho_0 \\beta} (\\nabla \\times \\boldsymbol{\\tau})_i$。\n3.  使用在纬度 $\\phi$ 处的圆柱投影，从经度 $\\lambda_i$（以度为单位）计算纬向坐标位置 $x_i$：$x_i = R \\cos\\phi \\cdot (\\lambda_i \\cdot \\frac{\\pi}{180})$。这将角度位置转换为沿纬度线的米制距离。\n4.  使用梯形法则，`numpy.trapz(V, x)`，对 $V(x)$ 关于 $x$ 进行数值积分，从而计算总内部输运 $M_y$（单位为 $\\mathrm{m}^3/\\mathrm{s}$）。该函数作用于离散集合 $\\{V_i\\}$ 和 $\\{x_i\\}$。经度是从东向西给出的，因此 $x_i$ 值的数组将是单调递减的。`trapz` 函数能正确处理这种情况。\n5.  将计算出的输运量从 $\\mathrm{m}^3/\\mathrm{s}$ 转换为斯维尔德鲁普（Sv），方法是除以 $10^6$。\n6.  最终结果是该计算输运的量值与所提供的实测西边界流输运之间的绝对差值，即 $| |M_{y, \\text{computed}}| - M_{WBC, \\text{measured}} |$，四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Sverdrup interior transport, compares it to measured western\n    boundary current transport, and reports the absolute difference.\n    \"\"\"\n    # Define physical constants.\n    R_EARTH = 6.371e6  # Earth radius in meters\n    OMEGA = 7.2921e-5  # Earth rotation rate in radians per second\n    RHO_0 = 1025.0     # Reference ocean density in kilograms per cubic meter\n    SV_CONVERSION = 1e6 # Conversion factor from m^3/s to Sverdrups (Sv)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"case_id\": \"A\",\n            \"phi_deg\": 26.0,\n            \"lons_deg\": np.array([0, -10, -20, -35, -50, -60]),\n            \"curl_tau\": np.array([-0.6e-7, -0.8e-7, -1.1e-7, -1.2e-7, -0.9e-7, -0.7e-7]),\n            \"measured_transport_sv\": 27.3\n        },\n        {\n            \"case_id\": \"B\",\n            \"phi_deg\": 30.0,\n            \"lons_deg\": np.array([0, -30]),\n            \"curl_tau\": np.array([0.0, 0.0]),\n            \"measured_transport_sv\": 0.0\n        },\n        {\n            \"case_id\": \"C\",\n            \"phi_deg\": 40.0,\n            \"lons_deg\": np.array([100, 80, 60, 40, 20, 0, -20]),\n            \"curl_tau\": np.array([0.1e-7, 0.05e-7, -0.05e-7, -0.15e-7, -0.2e-7, -0.1e-7, 0.0]),\n            \"measured_transport_sv\": 37.9\n        },\n        {\n            \"case_id\": \"D\",\n            \"phi_deg\": -20.0,\n            \"lons_deg\": np.array([60, 40, 20, 0, -20]),\n            \"curl_tau\": np.array([0.05e-7, 0.07e-7, 0.09e-7, 0.08e-7, 0.06e-7]),\n            \"measured_transport_sv\": 28.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        phi_deg = case[\"phi_deg\"]\n        lons_deg = case[\"lons_deg\"]\n        curl_tau = case[\"curl_tau\"]\n        measured_sv = case[\"measured_transport_sv\"]\n\n        # 1. Convert latitude from degrees to radians for trigonometric functions.\n        phi_rad = np.deg2rad(phi_deg)\n\n        # 2. Calculate the planetary vorticity gradient (beta).\n        # beta = (2 * Omega * cos(phi)) / R\n        beta = (2.0 * OMEGA * np.cos(phi_rad)) / R_EARTH\n\n        # 3. Calculate the meridional transport density V (in m^2/s) from Sverdrup relation.\n        # V = (1 / (rho_0 * beta)) * curl_tau_z\n        meridional_transport_density = (1.0 / (RHO_0 * beta)) * curl_tau\n\n        # 4. Convert longitudes (degrees) to zonal distance x (meters) at the given latitude.\n        # This creates the x-coordinates for the numerical integration.\n        # x = R * cos(phi) * lambda_rad\n        x_coords_m = R_EARTH * np.cos(phi_rad) * np.deg2rad(lons_deg)\n\n        # 5. Integrate transport density V along x using the trapezoidal rule to get total transport.\n        # The longitudes are given from east to west, so x_coords_m is a decreasing array.\n        # np.trapz correctly computes the signed integral for a non-monotonic coordinate array.\n        computed_transport_m3s = np.trapz(meridional_transport_density, x_coords_m)\n\n        # 6. Convert computed transport from m^3/s to Sverdrups (Sv).\n        computed_transport_sv = computed_transport_m3s / SV_CONVERSION\n\n        # 7. Compare the magnitude of the computed transport to the measured transport.\n        # The Sverdrup balance implies |M_interior| = |M_WBC|. We test this.\n        magnitude_computed_sv = np.abs(computed_transport_sv)\n        \n        # 8. Calculate the absolute difference and round to three decimal places.\n        absolute_difference = np.abs(magnitude_computed_sv - measured_sv)\n        results.append(round(absolute_difference, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}