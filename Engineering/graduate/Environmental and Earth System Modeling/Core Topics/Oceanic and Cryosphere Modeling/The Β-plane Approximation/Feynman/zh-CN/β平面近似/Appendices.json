{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个练习是一项基础性训练。它将引导你直接从科里奥利参数的定义和球体几何出发，推导出 $ \\beta $ 参数。掌握这项计算对于理解 $ \\beta $ 效应的来源以及建立对其量级的物理直觉至关重要。",
            "id": "3926055",
            "problem": "考虑一个中纬度地区，大气或海洋的局部笛卡尔坐标系，其中心位于参考纬度 $\\phi_{0}=45^{\\circ}$。地球被视为一个球体，半径 $a=6.371\\times 10^{6}\\,\\mathrm{m}$，自转角速度恒为 $\\Omega=7.2921\\times 10^{-5}\\,\\mathrm{s}^{-1}$。局部经向坐标 $y$ 是从参考纬度沿大圆测量的物理距离。纬度 $\\phi$ 处的科里奥利参数 $f$ 定义为 $f=2\\Omega\\sin\\phi$。在 $\\beta$ 平面近似中，$f$ 随纬度的变化在 $\\phi_{0}$ 附近线性化为 $f(y)\\approx f_{0}+\\beta\\,y$，其中 $f_{0}$ 是在 $\\phi_{0}$ 处的值，$\\beta$ 是在 $\\phi_{0}$ 处计算的行星涡度的经向梯度。\n\n仅从 $f$ 的定义以及球体上经向弧长与纬度之间的几何关系出发，推导 $\\beta$ 在 $\\phi_{0}=45^{\\circ}$ 时的解析表达式，然后计算其数值。将 $\\beta$ 的单位表示为 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$，并将最终数值结果四舍五入至四位有效数字。通过量化在 $\\phi_{0}$ 处单位经向距离上 $f$ 的分数变化，简要解释 $\\beta$ 相对于 $f_{0}$ 的大小；在您的计算过程中用文字提供此解释，但仅提交 $\\beta$ 的数值作为最终答案。",
            "solution": "该问题要求推导贝塔参数 $\\beta$ 的解析表达式，并随后在参考纬度 $\\phi_{0}=45^{\\circ}$ 计算其数值。β 平面近似将科里奥利参数 $f$ 相对于经向距离 $y$ 线性化为 $f(y) \\approx f_{0} + \\beta y$。系数 $\\beta$ 是在参考纬度（即 $y=0$ 处）计算的 $f$ 的经向梯度。\n\n根据定义，$\\beta$ 由以下公式给出：\n$$ \\beta = \\left. \\frac{df}{dy} \\right|_{y=0} $$\n科里奥利参数 $f$ 是纬度 $\\phi$ 的函数，由 $f(\\phi) = 2\\Omega\\sin\\phi$ 给出，其中 $\\Omega$ 是地球的自转角速度。经向坐标 $y$ 是在半径为 $a$ 的球体上，从参考纬度 $\\phi_{0}$ 向北的弧长距离。经向距离微分 $dy$ 与纬度微分 $d\\phi$（以弧度为单位）之间的关系是：\n$$ dy = a \\, d\\phi $$\n这意味着 $\\frac{d\\phi}{dy} = \\frac{1}{a}$。\n\n为了计算 $\\frac{df}{dy}$，我们使用链式法则，因为 $f$ 是 $\\phi$ 的函数，而 $\\phi$ 又是 $y$ 的函数：\n$$ \\frac{df}{dy} = \\frac{df}{d\\phi} \\frac{d\\phi}{dy} $$\n首先，我们求 $f$ 对 $\\phi$ 的导数：\n$$ \\frac{df}{d\\phi} = \\frac{d}{d\\phi} (2\\Omega\\sin\\phi) = 2\\Omega\\cos\\phi $$\n将这个结果和 $\\frac{d\\phi}{dy} = \\frac{1}{a}$ 代入链式法则表达式，得到：\n$$ \\frac{df}{dy} = (2\\Omega\\cos\\phi) \\left(\\frac{1}{a}\\right) = \\frac{2\\Omega\\cos\\phi}{a} $$\n参数 $\\beta$ 就是在参考纬度 $\\phi_{0}$ 处计算的这个梯度：\n$$ \\beta = \\left. \\frac{df}{dy} \\right|_{\\phi = \\phi_{0}} = \\frac{2\\Omega\\cos\\phi_{0}}{a} $$\n这就是所要求的 $\\beta$ 的解析表达式。\n\n现在，我们使用给定的常数计算 $\\beta$ 的数值：\n参考纬度 $\\phi_{0} = 45^{\\circ}$。\n地球自转角速度 $\\Omega = 7.2921 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。\n地球半径 $a = 6.371 \\times 10^{6}\\,\\mathrm{m}$。\n\n参考纬度的余弦值为 $\\cos(45^{\\circ}) = \\frac{\\sqrt{2}}{2}$。\n将这些值代入 $\\beta$ 的表达式中：\n$$ \\beta = \\frac{2 \\times (7.2921 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\cos(45^{\\circ})}{6.371 \\times 10^{6}\\,\\mathrm{m}} $$\n$$ \\beta = \\frac{2 \\times (7.2921 \\times 10^{-5}) \\times \\frac{\\sqrt{2}}{2}}{6.371 \\times 10^{6}}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta = \\frac{7.2921 \\times \\sqrt{2} \\times 10^{-5}}{6.371 \\times 10^{6}}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx \\frac{7.2921 \\times 1.41421356}{6.371} \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx \\frac{10.31263}{6.371} \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n$$ \\beta \\approx 1.618683 \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\beta \\approx 1.619 \\times 10^{-11}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n\n至于解释，我们计算单位经向距离上 $f$ 的分数变化，即比率 $\\frac{\\beta}{f_{0}}$。\n参考纬度处的科里奥利参数为 $f_{0} = 2\\Omega\\sin\\phi_{0}$。\n该比率为：\n$$ \\frac{\\beta}{f_{0}} = \\frac{2\\Omega\\cos\\phi_{0} / a}{2\\Omega\\sin\\phi_{0}} = \\frac{\\cot\\phi_{0}}{a} $$\n在 $\\phi_{0} = 45^{\\circ}$ 时，$\\cot(45^{\\circ}) = 1$。因此，该比率简化为：\n$$ \\frac{\\beta}{f_{0}} = \\frac{1}{a} = \\frac{1}{6.371 \\times 10^{6}\\,\\mathrm{m}} \\approx 1.57 \\times 10^{-7}\\,\\mathrm{m}^{-1} $$\n这个值表明，在此纬度，每向北移动一米，科里奥利参数大约变化 $1.57 \\times 10^{-5}\\,\\%$。一个更直观的解释是考虑一个更大的天气尺度距离，例如 $1000\\,\\mathrm{km}$（$10^6\\,\\mathrm{m}$）。在这个距离上，$f$ 的分数变化是 $(\\frac{\\beta}{f_0}) \\times (10^6\\,\\mathrm{m}) = \\frac{1}{a} \\times (10^6\\,\\mathrm{m}) \\approx 0.157$。这意味着从 $\\phi_{0}=45^{\\circ}$ 向北每移动 $1000\\,\\mathrm{km}$，科里奥利参数增加约其当地值 $f_0$ 的 $15.7\\%$。这表明，对于大尺度的大气和海洋运动，行星涡度的经向变化是一个显著效应。",
            "answer": "$$\\boxed{1.619 \\times 10^{-11}}$$"
        },
        {
            "introduction": "在定义了 $ \\beta $ 参数之后，我们现在可以探讨其最重要的物理后果：罗斯贝波。这个练习将 $ \\beta $ 平面近似应用于一个简单的正压流体模型，以推导经典的罗斯贝波频散关系。然后，你将利用这个关系，将一个可观测的波特征（周期）与其空间尺度（波长）联系起来，从而加深理论与物理现象之间的联系。",
            "id": "3926044",
            "problem": "考虑在旋转地球上，在中纬度附近采用 $\\beta$ 平面近似建模的无辐散正压流。假设扰动为小振幅，因此可以围绕静止状态进行线性化。取科里奥利参数为 $f(\\varphi) = 2 \\Omega \\sin \\varphi$，其中 $\\Omega$ 是地球的自转速率，$\\varphi$ 是纬度。在局部将 $f(\\varphi)$ 近似为 $f(y) \\approx f_{0} + \\beta y$，其中 $\\beta = \\partial f / \\partial y$。对于经向均匀的罗斯贝波，假设其不依赖于经向坐标，即经向波数 $l = 0$。\n\n从无辐散正压流体中的绝对涡度物质守恒和 $\\beta$ 平面近似出发，推导连接角频率 $\\omega$、纬向波数 $k$ 和 $\\beta$ 的线性色散关系。然后，设定目标周期 $T = 10\\,\\mathrm{天}$，并确定在纬度 $\\varphi = 45^\\circ$ 处，这种经向均匀的罗斯贝波所需的纬向波长 $\\lambda_{x}$。\n\n使用以下地球参数：地球自转速率 $\\Omega = 7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}$ 和地球平均半径 $a = 6.371 \\times 10^{6}\\,\\mathrm{m}$。取纬度 $\\varphi$ 处的 $\\beta$ 值为 $\\beta = \\dfrac{2 \\Omega \\cos \\varphi}{a}$，其中 $\\varphi$ 的单位是度。将最终的 $\\lambda_{x}$ 以 $\\mathrm{km}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "在旋转行星上，大尺度、无辐散正压运动的恰当基本依据是绝对涡度的物质守恒。对于水平无辐散流，其流函数为 $\\psi(x,y,t)$，使得 $u = -\\partial \\psi / \\partial y$ 和 $v = \\partial \\psi / \\partial x$，相对涡度为 $\\zeta = \\nabla^{2} \\psi$，绝对涡度为 $\\zeta + f$。无粘正压流的绝对涡度物质守恒方程为\n$$\n\\frac{D}{Dt}(\\zeta + f) = 0,\n$$\n其中 $D/Dt = \\partial/\\partial t + \\mathbf{u} \\cdot \\nabla$ 是物质导数，$f$ 是科里奥利参数。在参考纬度附近的 $\\beta$ 平面近似下，$f(y) \\approx f_{0} + \\beta y$，其中 $\\beta = \\partial f / \\partial y$ 在参考纬度上求值。使用雅可比算子 $J(a,b) = \\frac{\\partial a}{\\partial x}\\frac{\\partial b}{\\partial y} - \\frac{\\partial a}{\\partial y}\\frac{\\partial b}{\\partial x}$，正压涡度方程可以写成\n$$\n\\frac{\\partial}{\\partial t}(\\nabla^{2} \\psi) + J\\big(\\psi, \\nabla^{2} \\psi + f\\big) = 0.\n$$\n围绕静止状态（小振幅扰动）进行线性化，忽略二次雅可比项 $J(\\psi,\\nabla^{2}\\psi)$，只保留与背景行星涡度梯度的相互作用，得到\n$$\n\\frac{\\partial}{\\partial t}(\\nabla^{2} \\psi) + \\beta \\frac{\\partial \\psi}{\\partial x} = 0.\n$$\n寻求形式为\n$$\n\\psi(x,y,t) = \\Re\\left\\{\\psi_{0} \\exp\\big[i(k x + l y - \\omega t)\\big]\\right\\}\n$$\n的平面波解，其中 $\\psi_{0}$ 是常数振幅，$k$ 是纬向波数，$l$ 是经向波数，$\\omega$ 是角频率。代入线性方程可得\n$$\n\\frac{\\partial}{\\partial t}(\\nabla^{2} \\psi) \\rightarrow -i\\omega (-k^{2} - l^{2}) \\psi = i\\omega (k^{2} + l^{2}) \\psi, \\quad \\beta \\frac{\\partial \\psi}{\\partial x} \\rightarrow i \\beta k \\psi,\n$$\n因此色散关系为\n$$\ni\\omega (k^{2} + l^{2}) + i\\beta k = 0 \\quad \\implies \\quad \\omega(k^2+l^2) + \\beta k = 0.\n$$\n对于经向均匀的波，取 $l = 0$，色散关系简化为\n$$\n\\omega k^2 + \\beta k = 0 \\quad \\implies \\quad \\omega = -\\frac{\\beta}{k}.\n$$\n周期 $T$ 与角频率的关系为 $|\\omega| = \\frac{2\\pi}{T}$。利用 $|\\omega|$ 和 $k = \\frac{2\\pi}{\\lambda_{x}}$，我们可以解出 $\\lambda_{x}$：\n$$\n|\\omega| = \\frac{\\beta}{|k|} \\quad \\Longrightarrow \\quad |k| = \\frac{\\beta}{|\\omega|} = \\frac{\\beta T}{2\\pi},\n$$\n因此\n$$\n\\lambda_{x} = \\frac{2\\pi}{|k|} = \\frac{2\\pi}{\\beta T/(2\\pi)} = \\frac{4\\pi^{2}}{\\beta T}.\n$$\n\n接下来，使用以下公式计算中纬度 $\\varphi = 45^\\circ$ 处的 $\\beta$ 值\n$$\n\\beta = \\frac{2 \\Omega \\cos \\varphi}{a}.\n$$\n已知 $\\Omega = 7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}$，$a = 6.371 \\times 10^{6}\\,\\mathrm{m}$，以及 $\\cos(45^\\circ) = \\frac{\\sqrt{2}}{2} \\approx 0.70710678$，我们得到\n$$\n\\beta = \\frac{2 \\times \\left(7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}\\right) \\times 0.70710678}{6.371 \\times 10^{6}\\,\\mathrm{m}} \\approx 1.62 \\times 10^{-11}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}.\n$$\n目标周期为 $T = 10\\,\\mathrm{天} = 10 \\times 24 \\times 3600\\,\\mathrm{s} = 864000\\,\\mathrm{s}$。因此，\n$$\n\\lambda_{x} = \\frac{4\\pi^{2}}{\\beta T} \\approx \\frac{4 \\times \\pi^{2}}{\\left(1.62 \\times 10^{-11}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}\\right) \\times \\left(864000\\,\\mathrm{s}\\right)}.\n$$\n计算分子 $4\\pi^{2} \\approx 39.4784176$ 和分母 $\\beta T \\approx 1.62 \\times 10^{-11} \\times 864000 \\approx 1.39968 \\times 10^{-5}\\,\\mathrm{m}^{-1}$。因此，\n$$\n\\lambda_{x} \\approx \\frac{39.4784176}{1.39968 \\times 10^{-5}}\\,\\mathrm{m} \\approx 2.82053 \\times 10^{6}\\,\\mathrm{m} = 2.82053 \\times 10^{3}\\,\\mathrm{km}.\n$$\n四舍五入到三位有效数字并以 $\\mathrm{km}$ 为单位表示，所需的纬向波长为\n$$\n\\lambda_{x} \\approx 2.82 \\times 10^{3}\\,\\mathrm{km}.\n$$",
            "answer": "$$\\boxed{2.82 \\times 10^{3}}$$"
        },
        {
            "introduction": "这最后一个高级练习旨在弥合解析理论与现代计算模型之间的差距。你将首先推导更复杂的斜压罗斯贝波的频散关系，然后设计一个数值实验来验证它。这项练习模拟了计算地球物理学中的一个典型工作流程：对照已知的解析解来测试数值模型的有效性，从而磨练在地球系统建模研究与开发中至关重要的技能。",
            "id": "3788700",
            "problem": "您需要在一个计算海洋学任务中，为贝塔平面近似下的罗斯贝波（Rossby wave）色散关系实现一个数值测试。请从一个有效的基础理论出发，推导出必要的解析关系。然后，在一个离散的周期性网格上设计并执行一个数值实验，以估算波的频率，并将其与解析预测进行比较。所有的数学符号、变量、函数、算符和数字都必须用 LaTeX 书写。\n\n请从贝塔平面上的线性、无粘、斜压准地转（QG）位涡（PV）守恒定律出发，该定律指出准地转位涡的物质导数为零。在均匀层结、无平均流的平面上，并采用小振幅线性波的假设，控制定律简化为流函数扰动 $ \\psi(x,y,t) $ 的时间演化，其中线性化的准地转位涡由一个作用于 $ \\psi $ 的线性算符给出。假设科里奥利参数 $ \\beta $ 的经向梯度为常数（其中 $ \\beta = \\partial f / \\partial y $ 在参考纬度上取值），边界条件为周期性，并存在一个有限的斜压变形半径 $ R_d $。请使用空间导数和拉普拉斯算符 $ \\nabla^2 $ 的适当定义。通过考虑平面波解 $ \\psi(x,y,t) = \\Re\\{\\hat{\\psi} \\exp[i(k x + l y - \\omega t)]\\} $，从此基础出发构建解析的罗斯贝波色散关系 $ \\omega(k,l) $，并推导出频率 $ \\omega $ 关于纬向和经向波数 $ k $ 和 $ l $、经向梯度 $ \\beta $ 以及变形半径 $ R_d $ 的相应解析表达式。请勿在问题陈述中写出目标表达式。\n\n数值任务规范：\n- 在离散网格上实现一个伪谱时间积分方法，以在贝塔平面近似下演化线性准地转流函数 $ \\psi(x,y,t) $。使用一个尺寸为 $ L_x $ 和 $ L_y $ 的二维周期性区域，该区域分别被离散化为 $ N_x $ 和 $ N_y $ 个点，具有均匀间距 $ \\Delta x = L_x / N_x $ 和 $ \\Delta y = L_y / N_y $。\n- 将 $ \\psi(x,y,0) $ 初始化为具有波数 $ k = 2\\pi \\, n_x / L_x $ 和 $ l = 2\\pi \\, n_y / L_y $ 的单个单色傅里叶模式，其中 $ n_x $ 和 $ n_y $ 是整数模式指数。\n- 通过在离散傅里叶网格上求解每个模式对应的常微分方程，对线性系统的傅里叶系数 $ \\hat{\\psi}(k,l,t) $ 进行精确的时间演化。如果需要在物理空间和谱空间之间转换，请使用快速傅里叶变换（FFT）。角度单位必须是弧度。\n- 通过计算其傅里叶系数的复相位时间序列，对相位进行解缠，并对相位与时间进行线性回归，来估算激发模式的数值频率 $ \\omega_{\\mathrm{num}} $。频率的提取应与平面波约定 $ \\exp[i(k x + l y - \\omega t)] $ 一致。\n- 根据您推导的色散关系，为相同的 $ k $、$ l $、$ \\beta $ 和 $ R_d $ 计算解析频率 $ \\omega_{\\mathrm{ana}} $。\n- 对每个测试用例，报告定义为 $ \\epsilon = |\\omega_{\\mathrm{num}} - \\omega_{\\mathrm{ana}}| / \\max(|\\omega_{\\mathrm{ana}}|, \\varepsilon) $ 的相对误差，其中 $ \\varepsilon $ 是一个小的正数以避免除以零。频率 $ \\omega $ 必须以 $ \\mathrm{s}^{-1} $ 为单位表示，相对误差 $ \\epsilon $ 必须是无量纲的浮点数。\n\n测试套件：\n提供四个测试用例，其参数在科学上合理且自洽，涵盖一般情况、边界情况和边缘情况。对于每个用例，参数为 $ (\\beta, R_d, L_x, L_y, N_x, N_y, n_x, n_y, \\Delta t, T) $，其中 $ \\Delta t $ 是时间步长，$ T $ 是总积分时间，两者单位均为秒。使用以下值：\n1. 一般斜压情况：$ \\beta = 1.6\\times 10^{-11} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-1} $，$ R_d = 3.0\\times 10^{4} \\, \\mathrm{m} $，$ L_x = 1.0\\times 10^{6} \\, \\mathrm{m} $，$ L_y = 1.0\\times 10^{6} \\, \\mathrm{m} $，$ N_x = 128 $，$ N_y = 128 $，$ n_x = 3 $，$ n_y = 2 $，$ \\Delta t = 1.0\\times 10^{5} \\, \\mathrm{s} $，$ T = 6.0\\times 10^{6} \\, \\mathrm{s} $。\n2. 正压极限且经向模式为零：$ \\beta = 1.6\\times 10^{-11} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-1} $，$ R_d = 1.0\\times 10^{9} \\, \\mathrm{m} $，$ L_x = 2.0\\times 10^{6} \\, \\mathrm{m} $，$ L_y = 1.0\\times 10^{6} \\, \\mathrm{m} $，$ N_x = 96 $，$ N_y = 64 $，$ n_x = 4 $，$ n_y = 0 $，$ \\Delta t = 8.0\\times 10^{4} \\, \\mathrm{s} $，$ T = 4.0\\times 10^{6} \\, \\mathrm{s} $。\n3. 接近奈奎斯特频率的高波数情况：$ \\beta = 2.0\\times 10^{-11} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-1} $，$ R_d = 2.5\\times 10^{4} \\, \\mathrm{m} $，$ L_x = 5.0\\times 10^{5} \\, \\mathrm{m} $，$ L_y = 5.0\\times 10^{5} \\, \\mathrm{m} $，$ N_x = 64 $，$ N_y = 64 $，$ n_x = 31 $，$ n_y = 1 $，$ \\Delta t = 5.0\\times 10^{4} \\, \\mathrm{s} $，$ T = 3.0\\times 10^{6} \\, \\mathrm{s} $。\n4. 小$ \\beta $敏感性情况：$ \\beta = 1.0\\times 10^{-12} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-1} $，$ R_d = 3.0\\times 10^{4} \\, \\mathrm{m} $，$ L_x = 1.0\\times 10^{6} \\, \\mathrm{m} $，$ L_y = 1.0\\times 10^{6} \\, \\mathrm{m} $，$ N_x = 128 $，$ N_y = 128 $，$ n_x = 5 $，$ n_y = 5 $，$ \\Delta t = 1.0\\times 10^{5} \\, \\mathrm{s} $，$ T = 1.0\\times 10^{6} \\, \\mathrm{s} $。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有四个测试用例的相对误差，格式为用方括号括起来的逗号分隔列表，例如 $ [r_1,r_2,r_3,r_4] $，其中每个 $ r_i $ 都是一个浮点数。角度必须以弧度处理，频率必须以 $ \\mathrm{s}^{-1} $ 为单位。",
            "solution": "该问题要求从斜压准地转位涡（QG PV）方程推导出罗斯贝波色散关系，并随后对该关系进行数值验证。对问题陈述的验证已确认其科学合理性、一致性和完整性。我们现在开始求解，该过程包括解析推导，随后是数值实验的设计。\n\n首先，我们建立理论基础。控制方程是在无平均流的 $\\beta$ 平面上，对于无粘、无强迫流体的准地转位涡 $q$ 的守恒。这表示为 $q$ 相对于地转速度 $\\mathbf{u}_g$ 的物质导数为零：\n$$\n\\frac{D_g q}{Dt} = \\frac{\\partial q}{\\partial t} + \\mathbf{u}_g \\cdot \\nabla q = 0\n$$\n地转速度通过 $\\mathbf{u}_g = (-\\partial \\psi / \\partial y, \\partial \\psi / \\partial x)$ 与流函数 $\\psi$ 相关联。对于斜压流体，准地转位涡 $q$ 定义为：\n$$\nq = \\nabla^2 \\psi - \\frac{1}{R_d^2}\\psi + f\n$$\n其中 $\\nabla^2 = \\partial^2/\\partial x^2 + \\partial^2/\\partial y^2$ 是水平拉普拉斯算符，$R_d$ 是第一斜压罗斯贝变形半径，$f$ 是科里奥利参数。在 $\\beta$ 平面上，我们将 $f$ 近似为经向坐标 $y$ 的线性函数：$f = f_0 + \\beta y$，其中 $f_0$ 是参考纬度上的科里奥利参数，而 $\\beta = \\partial f / \\partial y$ 是一个常数。\n\n为了线性化准地转位涡方程，我们考虑在静止状态下流函数 $\\psi$ 的小扰动。位涡被分为一个平均分量 $\\bar{q} = f_0 + \\beta y$ 和一个扰动分量 $q' = \\nabla^2 \\psi - \\psi / R_d^2$。通过考虑扰动速度对平均位涡梯度的平流，可以得到线性化的准地转位涡方程，结果如下：\n$$\n\\frac{\\partial q'}{\\partial t} + v_g \\frac{\\partial \\bar{q}}{\\partial y} = 0\n$$\n代入 $q'$、$\\bar{q}$ 和经向地转速度 $v_g = \\partial \\psi / \\partial x$ 的表达式，我们得到关于流函数扰动 $\\psi(x, y, t)$ 的线性化斜压准地转位涡方程：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\nabla^2 \\psi - \\frac{1}{R_d^2}\\psi \\right) + \\beta \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n\n为了推导色散关系，我们寻找形式为 $\\psi(x,y,t) = \\Re\\{\\hat{\\psi} \\exp[i(k x + l y - \\omega t)]\\}$ 的平面波解，其中 $\\hat{\\psi}$ 是一个常数复振幅，$k$ 和 $l$ 分别是纬向和经向波数，$\\omega$ 是波的频率。将此形式代入控制方程需要计算以下导数：\n- $\\partial/\\partial t \\rightarrow -i\\omega$\n- $\\partial/\\partial x \\rightarrow ik$\n- $\\nabla^2 \\rightarrow -(k^2 + l^2)$\n\n将这些算符代换应用于线性化的准地转位涡方程，得到一个关于系数的代数方程：\n$$\n(-i\\omega) \\left( -(k^2 + l^2) - \\frac{1}{R_d^2} \\right) \\hat{\\psi} + \\beta (ik) \\hat{\\psi} = 0\n$$\n假设存在非平凡解（$\\hat{\\psi} \\neq 0$），我们可以同时除以 $\\hat{\\psi}$ 和 $i$：\n$$\n\\omega (k^2 + l^2 + R_d^{-2}) + \\beta k = 0\n$$\n求解 $\\omega$ 得到斜压罗斯贝波的解析色散关系：\n$$\n\\omega_{\\mathrm{ana}}(k, l) = - \\frac{\\beta k}{k^2 + l^2 + R_d^{-2}}\n$$\n该关系是我们数值测试的核心。它表明罗斯贝波是色散的（即频率依赖于波数），并且具有负的纬向相速度 $c_x = \\omega/k  0$（对于 $k \\neq 0$），这意味着它们向西传播。当 $R_d \\rightarrow \\infty$ 时，恢复到正压极限，此时 $R_d^{-2} \\rightarrow 0$。\n\n任务的数值部分涉及验证这一解析结果。我们在一个大小为 $L_x \\times L_y$、具有 $N_x \\times N_y$ 个离散网格点的双周期区域上使用伪谱方法。在谱域中，线性化的准地转位涡方程转化为每个傅里叶系数 $\\hat{\\psi}(k, l, t)$ 的一组解耦的常微分方程（ODE）。对于一个特定的波数对 $(k,l)$，该常微分方程为：\n$$\n\\frac{d\\hat{\\psi}_{k,l}}{dt} = -i \\left( - \\frac{\\beta k}{k^2 + l^2 + R_d^{-2}} \\right) \\hat{\\psi}_{k,l} = -i \\omega_{\\mathrm{ana}}(k,l) \\hat{\\psi}_{k,l}\n$$\n问题规定我们要“精确地”对系数进行时间演化。该常微分方程的精确解是：\n$$\n\\hat{\\psi}_{k,l}(t) = \\hat{\\psi}_{k,l}(0) \\exp(-i \\omega_{\\mathrm{ana}}(k,l) t)\n$$\n因此，我们的数值实验将包括对每个测试用例执行以下步骤：\n$1$. 根据给定的整数模式指数 $(n_x, n_y)$ 和区域长度，确定具体的波数 $k = 2\\pi n_x / L_x$ 和 $l = 2\\pi n_y / L_y$。\n$2$. 使用推导出的色散关系计算解析频率 $\\omega_{\\mathrm{ana}}$。\n$3$. 在总时间 $T$ 内，以时间步长 $\\Delta t$ 为指定模式 $(k,l)$ 生成单个傅里叶系数 $\\hat{\\psi}(t)$ 的时间序列。我们将其初始值设为 $\\hat{\\psi}(0) = 1$，并使用精确解 $\\hat{\\psi}(t_j) = \\exp(-i \\omega_{\\mathrm{ana}} t_j)$ 计算其在后续时间点 $t_j = j \\Delta t$ 的值。\n$4$. 从该时间序列中估算“数值”频率 $\\omega_{\\mathrm{num}}$。在时间 $t$ 的复系数相位为 $\\phi(t) = \\arg(\\hat{\\psi}(t)) = -\\omega_{\\mathrm{ana}} t$。我们计算每个时间步的相位，对其进行解缠以消除 $2\\pi$ 的不连续性，并对得到的点 $(t_j, \\phi_{\\mathrm{unwrapped}}(t_j))$ 进行线性回归。回归线的斜率提供了对 $-\\omega$ 的估计，因此 $\\omega_{\\mathrm{num}} = -\\mathrm{slope}$。\n$5$. 最后，我们计算数值估算频率与解析频率之间的相对误差 $\\epsilon$：\n$$\n\\epsilon = \\frac{|\\omega_{\\mathrm{num}} - \\omega_{\\mathrm{ana}}|}{\\max(|\\omega_{\\mathrm{ana}}|, \\varepsilon)}\n$$\n其中 $\\varepsilon$ 是一个小的正常数（例如 $10^{-16}$），以防止在 $\\omega_{\\mathrm{ana}} = 0$（即当 $k=0$ 时）的情况下出现除以零的错误。由于时间序列是由精确的解析解生成的，这个过程主要测试了数值相位估计（解缠和线性回归）的准确性以及实现的浮点精度。预期的误差应该非常接近机器精度。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Rossby wave dispersion problem by comparing analytical\n    and numerically estimated wave frequencies.\n    \"\"\"\n    # Test cases: (beta, Rd, Lx, Ly, Nx, Ny, nx, ny, dt, T)\n    test_cases = [\n        (1.6e-11, 3.0e4, 1.0e6, 1.0e6, 128, 128, 3, 2, 1.0e5, 6.0e6),\n        (1.6e-11, 1.0e9, 2.0e6, 1.0e6, 96, 64, 4, 0, 8.0e4, 4.0e6),\n        (2.0e-11, 2.5e4, 5.0e5, 5.0e5, 64, 64, 31, 1, 5.0e4, 3.0e6),\n        (1.0e-12, 3.0e4, 1.0e6, 1.0e6, 128, 128, 5, 5, 1.0e5, 1.0e6)\n    ]\n\n    results = []\n    # Small constant to prevent division by zero in the relative error calculation.\n    epsilon_floor = 1e-16\n\n    for case in test_cases:\n        beta, Rd, Lx, Ly, Nx, Ny, nx, ny, dt, T = case\n\n        # 1. Calculate analytical frequency (omega_ana)\n        # Zonal and meridional wavenumbers\n        k = 2.0 * np.pi * nx / Lx\n        l = 2.0 * np.pi * ny / Ly\n\n        # The term R_d^-2 can also be written as 1/(Rd*Rd)\n        Rd_inv_sq = Rd**-2\n\n        # The analytical dispersion relation for baroclinic Rossby waves\n        denominator = k**2 + l**2 + Rd_inv_sq\n\n        # If k is zero, the frequency is zero and there is no propagation.\n        # This also avoids potential division by zero if the denominator is zero,\n        # though with Rd^-2 > 0, the denominator is always positive for real k, l.\n        if k == 0.0:\n            omega_ana = 0.0\n        else:\n            omega_ana = -beta * k / denominator\n\n        # 2. Generate time series data for numerical frequency estimation.\n        # The problem asks to evolve the Fourier coefficient exactly in time.\n        num_steps = int(T / dt)\n        if num_steps  1:\n            results.append(1.0) # Placeholder for an invalid case\n            continue\n            \n        times = np.arange(num_steps + 1) * dt\n\n        # The exact solution for the Fourier coefficient's time evolution is\n        # psi_hat(t) = psi_hat(0) * exp(-i * omega * t)\n        # We can set psi_hat(0) = 1 + 0j without loss of generality.\n        psi_hat_t = np.exp(-1j * omega_ana * times)\n\n        # 3. Estimate numerical frequency (omega_num) from the time series\n        # The phase of the complex signal is phi(t) = -omega * t.\n        # We can find omega by finding the slope of the phase vs. time.\n        phases = np.angle(psi_hat_t)\n        \n        # Unwrap phases to correctly handle ancles crossing +/- pi\n        unwrapped_phases = np.unwrap(phases)\n\n        # Perform a linear regression on (times, unwrapped_phases) to find the slope.\n        # We use np.polyfit for this purpose. It returns [slope, intercept].\n        if len(times)  2:\n            # Need at least two points for a line fit\n            slope = 0.0\n        else:\n            slope, _ = np.polyfit(times, unwrapped_phases, 1)\n\n        # The numerical frequency is the negative of the slope.\n        omega_num = -slope\n\n        # 4. Calculate the relative error\n        # The denominator for the relative error is max(|omega_ana|, epsilon)\n        # to avoid division by zero when omega_ana is zero.\n        error_denominator = np.max([np.abs(omega_ana), epsilon_floor])\n        relative_error = np.abs(omega_num - omega_ana) / error_denominator\n        \n        results.append(relative_error)\n\n    # Format the final output as a comma-separated list in brackets.\n    # The problem asks for the output string, which this code block doesn't do.\n    # The actual answer should be the string representation of the results list.\n    return results\n\n# The function call and print statement are for execution, not part of the solution content.\n# final_results = solve()\n# print(f\"[{','.join(map(str, final_results))}]\")\n```",
            "answer": "[1.0505187796983058e-15,7.701140306644026e-16,4.805216348425244e-15,0.0]"
        }
    ]
}