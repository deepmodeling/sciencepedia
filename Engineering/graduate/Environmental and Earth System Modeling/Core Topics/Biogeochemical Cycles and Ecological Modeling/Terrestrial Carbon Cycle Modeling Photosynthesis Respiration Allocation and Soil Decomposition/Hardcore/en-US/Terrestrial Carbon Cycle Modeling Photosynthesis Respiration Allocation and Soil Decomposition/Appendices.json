{
    "hands_on_practices": [
        {
            "introduction": "At the heart of the terrestrial carbon cycle lies the biochemical process of photosynthesis. This practice delves into the core mechanics of $\\text{C}_3$ photosynthesis using the widely-accepted Farquhar, von Caemmerer, and Berry (FvCB) model. By calculating the net assimilation rate under specified conditions, you will learn to distinguish between Rubisco-limited and electron-transport-limited states, a critical skill for diagnosing and predicting plant responses to environmental drivers such as rising atmospheric $\\text{CO}_2$ .",
            "id": "3921312",
            "problem": "Consider a steady-state leaf of a temperate $\\text{C}_3$ plant at $25\\,^{\\circ}\\mathrm{C}$, where net carbon dioxide assimilation arises from the balance of biochemical demand for carbon dioxide and mitochondrial respiration. Use the standard biochemical descriptions for $\\text{C}_3$ photosynthesis commonly attributed to the Farquhar, von Caemmerer, and Berry model. The two biochemical limitations are:\n- The carboxylation-limited rate controlled by Ribulose-1,5-bisphosphate carboxylase/oxygenase (Rubisco), which follows Michaelis–Menten kinetics for carbon dioxide with competitive inhibition by oxygen.\n- The electron-transport-limited rate controlled by light-driven electron transport supporting ribulose-1,5-bisphosphate regeneration, with the canonical stoichiometry for $\\text{C}_3$ photosynthesis.\n\nLet the following parameters be given:\n- Maximum Rubisco carboxylation capacity $V_{c\\max} = 70$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n- Effective electron transport rate $J = 140$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n- Day respiration (mitochondrial respiration in the light) $R_{d} = 1.5$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n- Intercellular carbon dioxide partial pressure $C_{i} = 300$ $\\mu\\mathrm{bar}$,\n- Oxygen partial pressure $O = 21000$ $\\mu\\mathrm{bar}$,\n- Michaelis–Menten constants for Rubisco $K_{c} = 404$ $\\mu\\mathrm{bar}$ and $K_{o} = 27800$ $\\mu\\mathrm{bar}$,\n- Carbon dioxide compensation point in the absence of dark respiration $\\Gamma^{*} = 42$ $\\mu\\mathrm{bar}$.\n\nStarting from the fundamental laws and well-tested formulas underlying the above biochemical model:\n1. Derive expressions for the Rubisco-limited gross assimilation rate $W_{c}$ and the electron-transport-limited gross assimilation rate $W_{j}$ in terms of $V_{c\\max}$, $J$, $C_{i}$, $O$, $K_{c}$, $K_{o}$, and $\\Gamma^{*}$.\n2. Determine the limiting regime by comparing $W_{c}$ and $W_{j}$. Encode the regime as a real number $r$, with $r = 0$ for Rubisco limitation and $r = 1$ for electron-transport limitation.\n3. Compute the net assimilation $A$ as the appropriate gross rate minus $R_{d}$.\n4. Quantify the instantaneous sensitivity $\\partial A/\\partial C_{i}$ at the specified $C_{i}$, using the limiting expression from step 2.\n\nExpress $A$ in $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and $\\partial A/\\partial C_{i}$ in $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1}$. Round both $A$ and $\\partial A/\\partial C_{i}$ to four significant figures. Report the final result as a row vector $(A, \\partial A/\\partial C_{i}, r)$. Do not include units in the row vector.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It is based on the standard Farquhar, von Caemmerer, and Berry (FvCB) model of C$_3$ photosynthesis, a cornerstone of plant physiology and ecosystem modeling. All necessary parameters are provided with physically realistic values and consistent units, and the tasks are clearly defined. The problem is therefore deemed valid and a full solution is warranted.\n\nThe solution proceeds in four sequential steps as requested.\n\n### 1. Derive expressions for $W_c$ and $W_j$\n\nThe gross assimilation rate is modeled as the minimum of two limiting rates: the Rubisco-limited rate ($W_c$) and the electron-transport-limited rate ($W_j$).\n\nThe Rubisco-limited rate, $W_c$, is determined by the carboxylation capacity of the enzyme Rubisco. The kinetics are described by a Michaelis-Menten equation for the substrate $\\text{CO}_2$ (with partial pressure $C_i$), including competitive inhibition by $\\text{O}_2$ (with partial pressure $O$). The net effect of photorespiration, which consumes a portion of the fixed carbon, is incorporated through the $\\text{CO}_2$ compensation point in the absence of mitochondrial respiration, $\\Gamma^*$. The rate of carboxylation, $v_c$, is given by:\n$$ v_c = \\frac{V_{c\\max} C_i}{C_i + K_c \\left(1 + \\frac{O}{K_o}\\right)} $$\nThe gross assimilation rate, $W_c$, accounts for the carbon released via the photorespiratory pathway by scaling $v_c$ by the factor $(1 - \\Gamma^*/C_i)$, yielding the standard expression:\n$$ W_c = v_c \\left(1 - \\frac{\\Gamma^*}{C_i}\\right) = \\frac{V_{c\\max} (C_i - \\Gamma^*)}{C_i + K_c \\left(1 + \\frac{O}{K_o}\\right)} $$\n\nThe electron-transport-limited rate, $W_j$, is determined by the rate of regeneration of Ribulose-1,5-bisphosphate (RuBP), which is fueled by ATP and NADPH produced by the light-dependent reactions of photosynthesis. The effective rate of electron transport is given as $J$. According to the canonical stoichiometry for C$_3$ photosynthesis, the gross assimilation rate $W_j$ is related to $J$, $C_i$, and $\\Gamma^*$. This relationship accounts for the partitioning of electrons between the carboxylation and oxygenation pathways. The standard expression for the electron-transport-limited gross assimilation rate is:\n$$ W_j = \\frac{J (C_i - \\Gamma^*)}{4(C_i + 2\\Gamma^*)} $$\n\n### 2. Determine the limiting regime\n\nTo determine the operative limiting process, we calculate the numerical values for $W_c$ and $W_j$ using the provided parameters:\n- $V_{c\\max} = 70 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $J = 140 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $C_i = 300 \\, \\mu\\mathrm{bar}$\n- $O = 21000 \\, \\mu\\mathrm{bar}$\n- $K_c = 404 \\, \\mu\\mathrm{bar}$\n- $K_o = 27800 \\, \\mu\\mathrm{bar}$\n- $\\Gamma^* = 42 \\, \\mu\\mathrm{bar}$\n\nFirst, we calculate the effective Michaelis-Menten constant for carboxylation in the presence of oxygen, let's call it $K_{eff}$:\n$$ K_{eff} = K_c \\left(1 + \\frac{O}{K_o}\\right) = 404 \\, \\mu\\mathrm{bar} \\left(1 + \\frac{21000 \\, \\mu\\mathrm{bar}}{27800 \\, \\mu\\mathrm{bar}}\\right) \\approx 404(1.755396) \\approx 709.18 \\, \\mu\\mathrm{bar} $$\nNow we can compute $W_c$:\n$$ W_c = \\frac{V_{c\\max} (C_i - \\Gamma^*)}{C_i + K_{eff}} = \\frac{70 \\, (300 - 42)}{300 + 709.18} = \\frac{70 \\times 258}{1009.18} = \\frac{18060}{1009.18} \\approx 17.8956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nNext, we compute $W_j$:\n$$ W_j = \\frac{J (C_i - \\Gamma^*)}{4(C_i + 2\\Gamma^*)} = \\frac{140 \\, (300 - 42)}{4(300 + 2 \\times 42)} = \\frac{140 \\times 258}{4(384)} = \\frac{36120}{1536} = 23.515625 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nComparing the two rates, we find that $W_c \\approx 17.90 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and $W_j \\approx 23.52 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\nSince $W_c  W_j$, the gross assimilation rate is limited by Rubisco activity. According to the problem's encoding scheme, this corresponds to a regime identifier $r=0$.\n\n### 3. Compute the net assimilation $A$\n\nThe gross assimilation rate, $A_g$, is the minimum of the potential rates:\n$$ A_g = \\min(W_c, W_j) = W_c \\approx 17.8956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nThe net assimilation rate, $A$, is the gross rate minus the rate of mitochondrial respiration in the light, $R_d$:\n$$ A = A_g - R_d = 17.8956 - 1.5 = 16.3956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nRounding to four significant figures, we get $A = 16.40 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\n### 4. Quantify the instantaneous sensitivity $\\partial A/\\partial C_{i}$\n\nThe sensitivity of net assimilation to intercellular $\\text{CO}_2$ is the partial derivative $\\partial A/\\partial C_i$. Since the system is Rubisco-limited at the specified operating point, $A = W_c - R_d$. The derivative is therefore:\n$$ \\frac{\\partial A}{\\partial C_i} = \\frac{\\partial}{\\partial C_i} (W_c - R_d) = \\frac{\\partial W_c}{\\partial C_i} $$\nsince $R_d$ is constant with respect to $C_i$. We differentiate the expression for $W_c$ with respect to $C_i$ using the quotient rule. Let $K' = K_c(1 + O/K_o)$ for simplicity.\n$$ W_c = V_{c\\max} \\frac{C_i - \\Gamma^*}{C_i + K'} $$\n$$ \\frac{\\partial W_c}{\\partial C_i} = V_{c\\max} \\left[ \\frac{(1)(C_i + K') - (C_i - \\Gamma^*)(1)}{(C_i + K')^2} \\right] $$\n$$ \\frac{\\partial W_c}{\\partial C_i} = V_{c\\max} \\left[ \\frac{K' + \\Gamma^*}{(C_i + K')^2} \\right] = \\frac{V_{c\\max} \\left( K_c\\left(1 + \\frac{O}{K_o}\\right) + \\Gamma^* \\right)}{\\left( C_i + K_c\\left(1 + \\frac{O}{K_o}\\right) \\right)^2} $$\nSubstituting the numerical values:\n$$ \\frac{\\partial A}{\\partial C_i} = \\frac{70 \\, (709.18 + 42)}{(300 + 709.18)^2} = \\frac{70 \\times 751.18}{(1009.18)^2} = \\frac{52582.6}{1018443.9} \\approx 0.051629 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1} $$\nRounding to four significant figures, we get $\\partial A/\\partial C_i = 0.05163 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1}$.\n\nThe final result is the row vector $(A, \\partial A/\\partial C_{i}, r)$ with the calculated values.",
            "answer": "$$\\boxed{\\begin{pmatrix} 16.40  0.05163  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While understanding leaf-level processes is essential, ecosystem models must simulate the integrated activity of an entire plant canopy. This exercise addresses the critical challenge of upscaling, guiding you to compute canopy Gross Primary Production ($GPP$) by partitioning it into sunlit and shaded leaf fractions, each experiencing a different light environment . Comparing this two-leaf model result to a simplified 'big-leaf' approximation will provide direct insight into the importance of non-linear averaging and structural heterogeneity in accurately simulating ecosystem-scale carbon uptake.",
            "id": "3921337",
            "problem": "Consider a horizontally homogeneous canopy subject to direct and diffuse incident light. The goal is to compute canopy-scale Gross Primary Production (GPP) using both a two-leaf (sunlit and shaded) approach and a big-leaf approach, and then quantify the difference. All photosynthetic and stomatal parameters are assumed uniform per unit leaf area and temperature is fixed at a reference, so temperature dependence is neglected. You must produce results in micromoles of carbon dioxide per square meter per second, that is, in $\\mu\\mathrm{mol}\\ \\mathrm{CO}_2\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$.\n\nFundamental base:\n- Beer–Lambert attenuation: For a canopy with Leaf Area Index (LAI) $L$ and a single-beam extinction coefficient $k$ for photosynthetically active radiation (PAR), the fraction of incident PAR absorbed by the whole canopy is $1 - e^{-kL}$. Let $I_0$ be incident PAR at canopy top, partitioned into direct-beam and diffuse components by a diffuse fraction $f_d \\in [0,1]$. Then direct PAR is $I_b = (1 - f_d) I_0$ and diffuse PAR is $I_d = f_d I_0$. Total absorbed PAR by the canopy is $I_{\\mathrm{abs,tot}} = (1 - e^{-kL})(I_b + I_d)$.\n- Two-leaf sunlit–shaded partition: The sunlit leaf area index is $L_s = \\frac{1 - e^{-kL}}{k}$ and the shaded leaf area index is $L_{sh} = L - L_s$. The absorbed diffuse PAR per unit leaf area (averaged over all leaves) equals $I_{\\mathrm{diff,leaf}} = \\frac{(1 - e^{-kL}) I_d}{L}$. The absorbed direct-beam PAR per unit sunlit leaf area equals $I_{\\mathrm{beam,sun}} = \\frac{(1 - e^{-kL}) I_b}{L_s}$. Therefore, the average absorbed PAR by sunlit leaves is $I_{\\mathrm{sun}} = I_{\\mathrm{diff,leaf}} + I_{\\mathrm{beam,sun}}$, and the average absorbed PAR by shaded leaves is $I_{\\mathrm{sh}} = I_{\\mathrm{diff,leaf}}$.\n- Big-leaf approximation: All leaves are treated as having the same absorbed PAR per unit leaf area equal to the canopy-average $I_{\\mathrm{leaf,avg}} = \\frac{I_{\\mathrm{abs,tot}}}{L} = \\frac{(1 - e^{-kL}) I_0}{L}$; canopy assimilation is obtained by multiplying per-leaf-area assimilation by $L$.\n- Leaf-scale photosynthesis model: Use the widely accepted C$_3$ Farquhar–von Caemmerer–Berry model. Define the maximum carboxylation capacity at saturating light per unit leaf area $V_{cmax}$, the Michaelis–Menten constants $K_c$ and $K_o$ for carbon dioxide and oxygen, the photorespiratory compensation point $\\Gamma^\\ast$, and the ambient oxygen concentration $O$. Let $c_a$ be ambient carbon dioxide concentration. The ribulose-1,5-bisphosphate carboxylase/oxygenase (Rubisco)-limited rate is\n$$\nW_c(c_i) = V_{cmax} \\frac{c_i - \\Gamma^\\ast}{c_i + K_c \\left(1 + \\frac{O}{K_o}\\right)},\n$$\nand the light-limited rate is\n$$\nW_j(c_i) = \\frac{J}{4} \\frac{c_i - \\Gamma^\\ast}{c_i + 2\\Gamma^\\ast},\n$$\nwhere the electron transport rate $J$ is given by the non-rectangular hyperbola\n$$\nJ = \\frac{\\alpha I_{\\mathrm{abs}} + J_{\\max} - \\sqrt{(\\alpha I_{\\mathrm{abs}} + J_{\\max})^2 - 4\\theta \\alpha I_{\\mathrm{abs}} J_{\\max}}}{2\\theta},\n$$\nwith quantum yield $\\alpha$, curvature parameter $\\theta$, and maximum electron transport rate $J_{\\max}$. A common empirical relationship at the reference temperature is $J_{\\max} = \\lambda V_{cmax}$, with scalar $\\lambda$. The leaf dark respiration rate is $R_d = \\rho V_{cmax}$ with scalar $\\rho$. Net assimilation per unit leaf area is $A(c_i) = \\min(W_c, W_j) - R_d$.\n- Stomatal conductance closure and diffusion: Use the Medlyn stomatal conductance model with vapor pressure deficit (VPD) $D$ in kilopascals, baseline conductance $g_0$ and slope parameter $g_1$,\n$$\ng_s(A) = g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a},\n$$\nand Fickian diffusion closure\n$$\nA = \\frac{g_s(A)}{1.6}(c_a - c_i).\n$$\nSolve for the intercellular carbon dioxide concentration $c_i$ that satisfies the coupled system; recover both net assimilation $A$ and gross assimilation $W = \\min(W_c, W_j)$ at that $c_i$. Only nonnegative values contribute to GPP.\n\nTargets:\n- Implement the two-leaf GPP as $GPP_{2} = L_s W_{\\mathrm{sun}} + L_{sh} W_{\\mathrm{sh}}$, where $W_{\\mathrm{sun}}$ and $W_{\\mathrm{sh}}$ are the gross assimilation rates computed at $I_{\\mathrm{sun}}$ and $I_{\\mathrm{sh}}$, respectively.\n- Implement the big-leaf GPP as $GPP_{B} = L W_{\\mathrm{big}}$, where $W_{\\mathrm{big}}$ is the gross assimilation computed at $I_{\\mathrm{leaf,avg}}$.\n- Quantify the difference by the normalized difference $D_N = \\frac{GPP_{2} - GPP_{B}}{GPP_{B}}$ when $GPP_{B}  0$, and define $D_N = 0$ when $GPP_{B} = 0$.\n\nConstants to use for all cases at the reference temperature:\n- $K_c = 404.9\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$, $K_o = 278400\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$, $\\Gamma^\\ast = 42.75\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$, $O = 209000\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$.\n- $\\alpha = 0.24$, $\\theta = 0.7$, $\\lambda = 1.67$, $\\rho = 0.015$.\n\nInputs per test case:\n- Leaf Area Index $L$ in $\\mathrm{m}^2\\ \\mathrm{leaf}\\ \\mathrm{m}^{-2}\\ \\mathrm{ground}$ (dimensionless as a ratio), extinction coefficient $k$ (dimensionless), incident PAR $I_0$ in $\\mu\\mathrm{mol}\\ \\mathrm{photons}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$, diffuse fraction $f_d$ (dimensionless), $V_{cmax}$ in $\\mu\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ per leaf area, Medlyn parameters $g_0$ in $\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ per leaf area, $g_1$ (dimensionless), vapor pressure deficit $D$ in $\\mathrm{kPa}$, and ambient carbon dioxide $c_a$ in $\\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$.\n\nTest suite to implement:\n- Case $1$ (baseline, mixed light): $L = 3.0$, $k = 0.5$, $I_0 = 1200$, $f_d = 0.2$, $V_{cmax} = 60$, $g_0 = 0.01$, $g_1 = 9.0$, $D = 1.5$, $c_a = 400$.\n- Case $2$ (low light, high diffuse, potential near-compensation): $L = 3.0$, $k = 0.5$, $I_0 = 50$, $f_d = 0.8$, $V_{cmax} = 60$, $g_0 = 0.01$, $g_1 = 9.0$, $D = 1.0$, $c_a = 400$.\n- Case $3$ (dense canopy, low extinction): $L = 6.0$, $k = 0.3$, $I_0 = 1500$, $f_d = 0.1$, $V_{cmax} = 45$, $g_0 = 0.01$, $g_1 = 6.0$, $D = 2.0$, $c_a = 400$.\n- Case $4$ (sparse canopy, moderate diffuse): $L = 0.5$, $k = 0.7$, $I_0 = 1000$, $f_d = 0.5$, $V_{cmax} = 80$, $g_0 = 0.02$, $g_1 = 9.0$, $D = 0.5$, $c_a = 410$.\n\nRequired outputs per test case:\n- $GPP_{2}$, $GPP_{B}$, and $D_N$, each as a real number in $\\mu\\mathrm{mol}\\ \\mathrm{CO}_2\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ for the first two, and dimensionless for $D_N$.\n\nFinal output format:\n- Your program should produce a single line of output containing all results for the four test cases as a comma-separated list enclosed in square brackets, ordered by test case, and within each test case ordered as $[GPP_{2}, GPP_{B}, D_N]$. That is, the overall output is $[GPP_{2}^{(1)}, GPP_{B}^{(1)}, D_N^{(1)}, GPP_{2}^{(2)}, GPP_{B}^{(2)}, D_N^{(2)}, GPP_{2}^{(3)}, GPP_{B}^{(3)}, D_N^{(3)}, GPP_{2}^{(4)}, GPP_{B}^{(4)}, D_N^{(4)}]$.",
            "solution": "The problem of computing canopy-scale Gross Primary Production (GPP) using both a two-leaf and a big-leaf model is a well-posed and scientifically grounded exercise in terrestrial ecosystem modeling. The validation process confirms that the problem statement is self-contained, with all necessary equations, constants, and parameters provided. The physical and biochemical models—including Beer-Lambert light attenuation, the Farquhar-von Caemmerer-Berry (FvCB) model for C$_3$ photosynthesis, and the Medlyn stomatal conductance model—are standard in the field. The provided parameters and constants are within realistic ranges, and the unit system, while a mixture of molar and micromolar quantities, is internally consistent upon careful inspection. The problem is therefore deemed valid and a solution can be formulated.\n\nThe core of the problem is to determine the gross photosynthetic rate ($W$) for a leaf under specific environmental conditions, which requires solving a coupled system of equations for net assimilation ($A$) and internal CO$_2$ concentration ($c_i$). The solution proceeds by first constructing a function to solve this leaf-level problem, and then applying it within the context of the two-leaf and big-leaf canopy schemes.\n\n### 1. Leaf-Level Photosynthesis and Stomatal Conductance\n\nFor a single leaf, the net assimilation rate $A$ is determined by the balance between CO$_2$ supply through the stomata (demand) and CO$_2$ consumption by photosynthetic biochemistry (supply).\n\n**Biochemical Supply:** The supply of CO$_2$ is driven by photosynthesis. The net assimilation rate, $A$, is the gross assimilation rate, $W$, minus leaf dark respiration, $R_d$.\n$$A_{\\text{supply}}(c_i) = W(c_i) - R_d$$\nThe gross assimilation rate $W(c_i)$ is the minimum of the Rubisco-limited rate ($W_c$) and the light-limited, RuBP regeneration-limited rate ($W_j$).\n$$W(c_i) = \\min(W_c(c_i), W_j(c_i))$$\nThese rates are given by:\n$$W_c(c_i) = V_{cmax} \\frac{c_i - \\Gamma^\\ast}{c_i + K_c \\left(1 + \\frac{O}{K_o}\\right)}$$\n$$W_j(c_i) = \\frac{J}{4} \\frac{c_i - \\Gamma^\\ast}{c_i + 2\\Gamma^\\ast}$$\nThe electron transport rate, $J$, depends on the absorbed photosynthetically active radiation ($I_{\\mathrm{abs}}$) and is calculated using a non-rectangular hyperbola:\n$$J = \\frac{(\\alpha I_{\\mathrm{abs}} + J_{\\max}) - \\sqrt{(\\alpha I_{\\mathrm{abs}} + J_{\\max})^2 - 4\\theta \\alpha I_{\\mathrm{abs}} J_{\\max}}}{2\\theta}$$\nThe maximum electron transport rate, $J_{\\max}$, and dark respiration, $R_d$, are scaled with the maximum carboxylation capacity, $V_{cmax}$:\n$$J_{\\max} = \\lambda V_{cmax}$$\n$$R_d = \\rho V_{cmax}$$\n\n**Diffusive Demand:** The demand for CO$_2$ is governed by Fickian diffusion through the stomata. The flux $A$ is coupled with stomatal conductance to water vapor, $g_s$, through two equations:\n$$A = \\frac{g_s}{1.6}(c_a - c_i)$$\n$$g_s = g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a}$$\nSubstituting the second equation into the first allows us to solve for $A$ as a function of $c_i$, representing the demand side:\n$$A = \\frac{1}{1.6} \\left( g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a} \\right) (c_a - c_i)$$\n$$A \\left( 1 - \\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{c_a - c_i}{c_a} \\right) = \\frac{g_0}{1.6}(c_a - c_i)$$\nThus, the demand function for net assimilation is:\n$$A_{\\text{demand}}(c_i) = \\frac{\\frac{g_0}{1.6}(c_a - c_i)}{1 - \\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{c_a - c_i}{c_a}}$$\n\n**Solving for Operating Point:** The operating point ($c_i, A$) is found by equating the supply and demand functions: $A_{\\text{supply}}(c_i) = A_{\\text{demand}}(c_i)$. This is a non-linear equation for $c_i$ that must be solved numerically. We seek a root for the function $f(c_i) = A_{\\text{supply}}(c_i) - A_{\\text{demand}}(c_i)$. The physically meaningful range for $c_i$ is $[\\Gamma^\\ast, c_a]$. Since $A_{\\text{supply}}$ is an increasing function of $c_i$ and $A_{\\text{demand}}$ is a decreasing function of $c_i$, a unique root is guaranteed within this interval, which can be found efficiently using a numerical root-finding algorithm like the Brent-Dekker method. Once the operating $c_i$ is found, the corresponding gross assimilation $W(c_i)$ is calculated. To ensure physical validity, we take $W = \\max(0, \\min(W_c, W_j))$.\n\n### 2. Canopy-Scale GPP Calculation\n\nThe leaf-level model is applied to two different canopy schemes. For each test case, we first calculate the necessary light and leaf area partitioning.\n\n**Light and Leaf Area Partitioning:**\n- Total incident PAR: $I_0$\n- Direct and diffuse components: $I_b = (1 - f_d) I_0$, $I_d = f_d I_0$\n- Fraction of light absorbed by the canopy: $f_{\\mathrm{abs}} = 1 - e^{-kL}$\n- Sunlit Leaf Area Index: $L_s = \\frac{1 - e^{-kL}}{k} = \\frac{f_{\\mathrm{abs}}}{k}$\n- Shaded Leaf Area Index: $L_{sh} = L - L_s$\n\n**Two-Leaf Model ($GPP_{2}$):**\nThe canopy is divided into sunlit and shaded leaf fractions, each with a distinct average absorbed PAR.\n- Average absorbed PAR per unit shaded leaf area: $I_{\\mathrm{sh}} = \\frac{f_{\\mathrm{abs}} I_d}{L}$\n- Average absorbed PAR per unit sunlit leaf area: $I_{\\mathrm{sun}} = \\frac{f_{\\mathrm{abs}} I_d}{L} + \\frac{f_{\\mathrm{abs}} I_b}{L_s}$\nThe leaf-level solver is called twice:\n1.  With $I_{\\mathrm{abs}} = I_{\\mathrm{sun}}$ to compute gross assimilation for sunlit leaves, $W_{\\mathrm{sun}}$.\n2.  With $I_{\\mathrm{abs}} = I_{\\mathrm{sh}}$ to compute gross assimilation for shaded leaves, $W_{\\mathrm{sh}}$.\nTotal canopy GPP is the sum of contributions from both leaf types, weighted by their respective area indices:\n$$GPP_{2} = L_s W_{\\mathrm{sun}} + L_{sh} W_{\\mathrm{sh}}$$\n\n**Big-Leaf Model ($GPP_{B}$):**\nThe canopy is treated as a single \"big leaf\". All leaves are assumed to receive the same average absorbed PAR.\n- Canopy-average absorbed PAR per unit leaf area: $I_{\\mathrm{leaf,avg}} = \\frac{f_{\\mathrm{abs}} I_0}{L}$\nThe leaf-level solver is called once with $I_{\\mathrm{abs}} = I_{\\mathrm{leaf,avg}}$ to find the average gross assimilation, $W_{\\mathrm{big}}$.\nTotal canopy GPP is this average rate scaled by the total leaf area index:\n$$GPP_{B} = L W_{\\mathrm{big}}$$\n\n**Normalized Difference ($D_N$):**\nThe relative difference between the two models is quantified as:\n$$D_N = \\begin{cases} \\frac{GPP_{2} - GPP_{B}}{GPP_{B}}  \\text{if } GPP_{B}  0 \\\\ 0  \\text{if } GPP_{B} = 0 \\end{cases}$$\n\n### 3. Algorithm Implementation\n\nThe algorithm is implemented in Python, using `numpy` for numerical efficiency and `scipy.optimize.brentq` for robust root-finding. A master function iterates through each test case provided in the problem statement. For each case, it performs the light partitioning, invokes the leaf-level solver for the required scenarios (sunlit, shaded, big-leaf), calculates $GPP_{2}$, $GPP_{B}$, and $D_N$, and appends these three results to a list. Finally, the list of all results is formatted into the required single-line string output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the terrestrial carbon cycle modeling problem for the given test cases.\n    \"\"\"\n    \n    # Constants provided in the problem statement\n    CONSTS = {\n        'Kc': 404.9,          # Michaelis-Menten constant for CO2 (umol/mol)\n        'Ko': 278400.0,       # Michaelis-Menten constant for O2 (umol/mol)\n        'Gamma_star': 42.75,  # Photorespiratory compensation point (umol/mol)\n        'O': 209000.0,        # Ambient O2 concentration (umol/mol)\n        'alpha': 0.24,        # Quantum yield (mol electrons / mol photons)\n        'theta': 0.7,         # Curvature parameter of the light response curve\n        'lambda_': 1.67,      # Ratio of Jmax to Vcmax\n        'rho': 0.015,         # Ratio of Rd to Vcmax\n    }\n\n    def solve_leaf_photo(I_abs, Vcmax, g0, g1, D, ca, consts):\n        \"\"\"\n        Calculates leaf-level gross assimilation for a given set of conditions.\n        \n        This function solves the coupled system of photosynthesis and stomatal\n        conductance equations to find the operating internal CO2 concentration (ci)\n        and the corresponding gross assimilation rate (W).\n\n        Returns:\n            W (float): Gross assimilation rate in umol CO2 m^-2 s^-1.\n        \"\"\"\n        if Vcmax = 0 or I_abs = 0:\n            return 0.0\n\n        Jmax = consts['lambda_'] * Vcmax\n        Rd = consts['rho'] * Vcmax\n\n        # Electron transport rate J (solution to a quadratic equation)\n        j_num = consts['alpha'] * I_abs + Jmax\n        j_den = 2.0 * consts['theta']\n        # Handle case where I_abs is very low to avoid sqrt of negative\n        discriminant_val = j_num**2 - 4.0 * consts['theta'] * consts['alpha'] * I_abs * Jmax\n        if discriminant_val  0:\n            discriminant_val = 0\n            \n        j_sqrt = np.sqrt(discriminant_val)\n        J = (j_num - j_sqrt) / j_den\n\n        # Define the residual function f(ci) = A_supply - A_demand for root finding\n        def root_func(ci):\n            # A_supply(ci): Net assimilation from biochemical supply\n            # Clamp ci to be no less than Gamma_star to avoid non-physical results\n            ci = max(ci, consts['Gamma_star'])\n\n            Wc = Vcmax * (ci - consts['Gamma_star']) / (ci + consts['Kc'] * (1.0 + consts['O'] / consts['Ko']))\n            Wj = (J / 4.0) * (ci - consts['Gamma_star']) / (ci + 2.0 * consts['Gamma_star'])\n            \n            W = np.min([Wc, Wj])\n            A_supply = W - Rd\n\n            # A_demand(ci): Net assimilation from stomatal/diffusion demand\n            if ca - ci  1e-9:\n                return A_supply\n            \n            demand_denominator = 1.0 - (1.0 + g1 / np.sqrt(D)) * (ca - ci) / ca\n            if demand_denominator = 1e-9:\n                A_demand = (g0 / 1.6) * (ca - ci) / 1e-9 # effectively a very large number\n            else:\n                A_demand = (g0 / 1.6) * (ca - ci) / demand_denominator\n            \n            return A_supply - A_demand\n\n        # Find the root ci using Brent's method\n        # The physical range for ci is (Gamma_star, ca)\n        try:\n            # Check if a solution exists in the interval\n            if root_func(consts['Gamma_star'] + 1e-6) * root_func(ca)  0:\n                 ci_sol = brentq(root_func, consts['Gamma_star'] + 1e-6, ca)\n            else:\n                # If conditions are very poor (e.g., low light), A_supply may always be  A_demand\n                # or A_supply  0. In this case, stomata close and ci approaches ca.\n                 ci_sol = ca\n        except ValueError:\n            ci_sol = ca\n\n        # Recalculate gross assimilation W at the solved ci\n        ci_sol = max(ci_sol, consts['Gamma_star'])\n        Wc_sol = Vcmax * (ci_sol - consts['Gamma_star']) / (ci_sol + consts['Kc'] * (1.0 + consts['O'] / consts['Ko']))\n        Wj_sol = (J / 4.0) * (ci_sol - consts['Gamma_star']) / (ci_sol + 2.0 * consts['Gamma_star'])\n        W_sol = np.min([Wc_sol, Wj_sol])\n        \n        return max(0.0, W_sol)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # L,    k,    I0,   fd, Vcmax,   g0,   g1,    D,   ca\n        (3.0,  0.5, 1200.0, 0.2, 60.0, 0.01,  9.0,  1.5, 400.0), # Case 1\n        (3.0,  0.5,   50.0, 0.8, 60.0, 0.01,  9.0,  1.0, 400.0), # Case 2\n        (6.0,  0.3, 1500.0, 0.1, 45.0, 0.01,  6.0,  2.0, 400.0), # Case 3\n        (0.5,  0.7, 1000.0, 0.5, 80.0, 0.02,  9.0,  0.5, 410.0), # Case 4\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L, k, I0, fd, Vcmax, g0, g1, D, ca = case\n\n        # Light and Leaf Area partitioning\n        Ib = (1.0 - fd) * I0\n        Id = fd * I0\n        f_abs_canopy = 1.0 - np.exp(-k * L)\n\n        Ls = f_abs_canopy / k if k  0 else L\n        Lsh = L - Ls\n        \n        # --- Two-Leaf Model ---\n        I_diff_leaf = (f_abs_canopy * Id) / L if L  0 else 0.0\n        I_beam_sun  = (f_abs_canopy * Ib) / Ls if Ls  0 else 0.0\n        \n        I_sun = I_diff_leaf + I_beam_sun\n        I_sh = I_diff_leaf\n\n        W_sun = solve_leaf_photo(I_sun, Vcmax, g0, g1, D, ca, CONSTS)\n        W_sh = solve_leaf_photo(I_sh, Vcmax, g0, g1, D, ca, CONSTS)\n        \n        GPP2 = Ls * W_sun + Lsh * W_sh\n\n        # --- Big-Leaf Model ---\n        I_leaf_avg = (f_abs_canopy * I0) / L if L  0 else 0.0\n        W_big = solve_leaf_photo(I_leaf_avg, Vcmax, g0, g1, D, ca, CONSTS)\n        GPPB = L * W_big\n\n        # --- Normalized Difference ---\n        DN = (GPP2 - GPPB) / GPPB if GPPB  1e-9 else 0.0\n        \n        all_results.extend([GPP2, GPPB, DN])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once carbon is fixed by photosynthesis, it enters a network of terrestrial pools, including vegetation and soil, where it resides for varying amounts of time. This practice shifts the focus from instantaneous fluxes to the long-term dynamics of carbon stocks using a linear compartmental model . By calculating the transient response of a three-pool system to a step change in carbon input, you will gain hands-on experience with system stability, turnover times, and the mathematical framework used to predict how ecosystem carbon storage evolves following a disturbance or environmental change.",
            "id": "3921364",
            "problem": "Consider a linear terrestrial carbon cycle model with three pools: leaf ($L$), wood ($W$), and soil ($S$). Let $\\mathbf{C}(t) = [C_L(t),C_W(t),C_S(t)]^\\top$ denote the carbon stocks in kilograms of carbon per square meter ($\\mathrm{kg\\ C\\ m^{-2}}$). The system obeys mass conservation, first-order losses, and linear inter-pool transfers from litterfall. Specifically, assume:\n- First-order loss rates $k_L$, $k_W$, and $k_S$ for leaf, wood, and soil respectively, all in $\\mathrm{s^{-1}}$.\n- Fractions $p_{LS}$ and $p_{WS}$, where $p_{LS} \\in [0,1]$ is the fraction of leaf losses that become soil inputs (the remainder $1-p_{LS}$ is respired to the atmosphere), and $p_{WS} \\in [0,1]$ is the fraction of wood losses that become soil inputs (the remainder $1-p_{WS}$ is respired to the atmosphere).\n- An external input vector $\\mathbf{I}(t) = [I_L(t), I_W(t), I_S(t)]^\\top$ in $\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$, representing photosynthetic allocation to leaf and wood and exogenous soil inputs (e.g., root exudates).\n\nUnder these assumptions, the state-space model is\n$$\n\\frac{d\\mathbf{C}}{dt} = \\mathbf{I}(t) - \\mathbf{A}\\,\\mathbf{C}(t),\n$$\nwith\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\nk_L  0  0 \\\\\n0  k_W  0 \\\\\n- p_{LS}\\,k_L  - p_{WS}\\,k_W  k_S\n\\end{bmatrix},\n$$\nso that\n$\n\\frac{dC_L}{dt} = I_L(t) - k_L C_L,\\ \n\\frac{dC_W}{dt} = I_W(t) - k_W C_W,\\ \n\\frac{dC_S}{dt} = I_S(t) + p_{LS} k_L C_L + p_{WS} k_W C_W - k_S C_S.\n$\n\nSuppose the system is at steady state under a constant pre-step input $\\mathbf{I}_{\\text{old}}$ for $t  0$, so that $\\mathbf{A}\\,\\mathbf{C}(0) = \\mathbf{I}_{\\text{old}}$. At $t=0$ the leaf input experiences a step increase of magnitude $\\Delta I_L$ (in $\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$), i.e.,\n$\nI_L(t) = I_{L,\\text{old}} + \\Delta I_L\\,u(t),\n$\nwhere $u(t)$ is the unit step function. The wood and soil inputs remain unchanged, so $\\mathbf{I}_{\\text{new}} = [I_{L,\\text{old}} + \\Delta I_L,\\ I_{W,\\text{old}},\\ I_{S,\\text{old}}]^\\top$ for $t \\ge 0$.\n\nTask: For each test case below, construct $\\mathbf{A}$, compute the pre-step steady state $\\mathbf{C}(0)$ satisfying $\\mathbf{A}\\,\\mathbf{C}(0)=\\mathbf{I}_{\\text{old}}$, and then compute the transient solution $\\mathbf{C}(t)$ for $t \\ge 0$ using the matrix exponential $e^{-\\mathbf{A}t}$. Report $\\mathbf{C}(T)$ at the specified evaluation time $T$.\n\nExpress all outputs for carbon stocks in $\\mathrm{kg\\ C\\ m^{-2}}$, rounded to six decimal places. Angles are not involved. Do not use the percentage sign; any fractions are to be expressed as decimals.\n\nTest Suite (each parameter set is physically plausible and uses conversions from days and years to seconds where applicable; use $1\\ \\mathrm{day} = 86{,}400\\ \\mathrm{s}$ and $1\\ \\mathrm{year} = 365\\times 86{,}400\\ \\mathrm{s}$):\n1. Happy path:\n   - $k_L = \\frac{1}{30\\ \\mathrm{days}}$,\n   - $k_W = \\frac{1}{5\\ \\mathrm{years}}$,\n   - $k_S = \\frac{1}{2\\ \\mathrm{years}}$,\n   - $p_{LS} = 0.7$, $p_{WS} = 0.9$,\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.004}{1\\ \\mathrm{day}},\\ \\frac{0.002}{1\\ \\mathrm{day}},\\ \\frac{0.0001}{1\\ \\mathrm{day}}\\right]$,\n   - $\\Delta I_L = \\frac{0.001}{1\\ \\mathrm{day}}$,\n   - $T = 7\\ \\mathrm{days}$.\n2. Zero step (boundary consistency):\n   - $k_L = \\frac{1}{30\\ \\mathrm{days}}$,\n   - $k_W = \\frac{1}{5\\ \\mathrm{years}}$,\n   - $k_S = \\frac{1}{2\\ \\mathrm{years}}$,\n   - $p_{LS} = 0.7$, $p_{WS} = 0.9$,\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.004}{1\\ \\mathrm{day}},\\ \\frac{0.002}{1\\ \\mathrm{day}},\\ \\frac{0.0001}{1\\ \\mathrm{day}}\\right]$,\n   - $\\Delta I_L = \\frac{0}{1\\ \\mathrm{day}}$,\n   - $T = 10\\ \\mathrm{days}$.\n3. Slow wood decay, no leaf-to-soil transfer, fast soil turnover:\n   - $k_L = \\frac{1}{60\\ \\mathrm{days}}$,\n   - $k_W = \\frac{1}{50\\ \\mathrm{years}}$,\n   - $k_S = \\frac{1}{0.5\\ \\mathrm{years}}$,\n   - $p_{LS} = 0.0$, $p_{WS} = 0.6$,\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.003}{1\\ \\mathrm{day}},\\ \\frac{0.001}{1\\ \\mathrm{day}},\\ \\frac{0.0002}{1\\ \\mathrm{day}}\\right]$,\n   - $\\Delta I_L = \\frac{0.005}{1\\ \\mathrm{day}}$,\n   - $T = 20\\ \\mathrm{years}$.\n4. Instantaneous evaluation ($T=0$):\n   - $k_L = \\frac{1}{20\\ \\mathrm{days}}$,\n   - $k_W = \\frac{1}{10\\ \\mathrm{years}}$,\n   - $k_S = \\frac{1}{1\\ \\mathrm{year}}$,\n   - $p_{LS} = 0.5$, $p_{WS} = 0.8$,\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.006}{1\\ \\mathrm{day}},\\ \\frac{0.0025}{1\\ \\mathrm{day}},\\ \\frac{0.00015}{1\\ \\mathrm{day}}\\right]$,\n   - $\\Delta I_L = \\frac{0.001}{1\\ \\mathrm{day}}$,\n   - $T = 0\\ \\mathrm{days}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is the list $[C_L(T),C_W(T),C_S(T)]$ for the corresponding test case, with each number rounded to six decimal places (e.g., $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$).",
            "solution": "The user has provided a problem statement that is complete, self-contained, and scientifically grounded. It describes a linear three-pool terrestrial carbon cycle model, a standard construct in environmental and earth system modeling. The governing equations are a system of linear first-order ordinary differential equations, which are well-posed. The parameters and initial conditions are clearly defined, and the task is a standard exercise in linear systems analysis. The problem is therefore deemed valid and a solution will be provided.\n\nThe state of the system is described by the vector of carbon stocks $\\mathbf{C}(t) = [C_L(t), C_W(t), C_S(t)]^\\top$, where $C_L$, $C_W$, and $C_S$ represent the carbon in the leaf, wood, and soil pools, respectively. The dynamics are governed by the linear state-space model:\n$$\n\\frac{d\\mathbf{C}}{dt} = \\mathbf{I}(t) - \\mathbf{A}\\,\\mathbf{C}(t)\n$$\nwhere $\\mathbf{I}(t)$ is the vector of external carbon inputs and $\\mathbf{A}$ is the system matrix. For $t \\ge 0$, the input vector is constant, denoted by $\\mathbf{I}_{\\text{new}}$. The equation can be rewritten as:\n$$\n\\frac{d\\mathbf{C}}{dt} + \\mathbf{A}\\,\\mathbf{C}(t) = \\mathbf{I}_{\\text{new}}\n$$\nThis is a non-homogeneous system of linear ordinary differential equations. The solution can be found by considering the deviation from the new steady state.\n\nFirst, we determine the initial condition $\\mathbf{C}(0)$. The problem states that for $t  0$, the system is at steady state under a constant input $\\mathbf{I}_{\\text{old}}$. At steady state, $\\frac{d\\mathbf{C}}{dt} = \\mathbf{0}$, which implies:\n$$\n\\mathbf{A}\\,\\mathbf{C}(0) = \\mathbf{I}_{\\text{old}}\n$$\nThe system matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\nk_L  0  0 \\\\\n0  k_W  0 \\\\\n- p_{LS}\\,k_L  - p_{WS}\\,k_W  k_S\n\\end{bmatrix}\n$$\nIts determinant is $\\det(\\mathbf{A}) = k_L k_W k_S$. Since the loss rates $k_L$, $k_W$, and $k_S$ are inverse turnover times, they are strictly positive. Therefore, $\\det(\\mathbf{A}) \\ne 0$, and the matrix $\\mathbf{A}$ is invertible. The initial state $\\mathbf{C}(0)$ is uniquely determined by:\n$$\n\\mathbf{C}(0) = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{old}}\n$$\nNext, we define the new steady state, $\\mathbf{C}_{\\text{new,ss}}$, which the system will approach as $t \\to \\infty$ under the new constant input $\\mathbf{I}_{\\text{new}}$. This state is also found by setting the derivative to zero:\n$$\n\\mathbf{A}\\,\\mathbf{C}_{\\text{new,ss}} = \\mathbf{I}_{\\text{new}} \\implies \\mathbf{C}_{\\text{new,ss}} = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{new}}\n$$\nTo find the transient solution for $t \\ge 0$, we introduce a new variable $\\mathbf{y}(t)$ representing the deviation of the state from the new equilibrium:\n$$\n\\mathbf{y}(t) = \\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}}\n$$\nThe time derivative is $\\frac{d\\mathbf{y}}{dt} = \\frac{d\\mathbf{C}}{dt}$, since $\\mathbf{C}_{\\text{new,ss}}$ is a constant vector. Substituting this into the governing equation:\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{I}_{\\text{new}} - \\mathbf{A}\\,\\mathbf{C}(t) = \\mathbf{A}\\,\\mathbf{C}_{\\text{new,ss}} - \\mathbf{A}\\,\\mathbf{C}(t) = -\\mathbf{A}(\\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}})\n$$\nThis simplifies to a homogeneous linear differential equation:\n$$\n\\frac{d\\mathbf{y}}{dt} = -\\mathbf{A}\\,\\mathbf{y}(t)\n$$\nThe solution to this equation is given by the matrix exponential:\n$$\n\\mathbf{y}(t) = e^{-\\mathbf{A}t} \\mathbf{y}(0)\n$$\nwhere $\\mathbf{y}(0) = \\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}}$ is the initial deviation. Substituting back for $\\mathbf{C}(t)$:\n$$\n\\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}} = e^{-\\mathbf{A}t} (\\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}})\n$$\nThis yields the complete transient solution for $\\mathbf{C}(t)$ for $t \\ge 0$:\n$$\n\\mathbf{C}(t) = \\mathbf{C}_{\\text{new,ss}} + e^{-\\mathbf{A}t} (\\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}})\n$$\nTo implement the solution for each test case, the following algorithm is used:\n1.  Convert all given time-dependent parameters ($k_L$, $k_W$, $k_S$, $\\mathbf{I}_{\\text{old}}$, $\\Delta I_L$, and $T$) into base SI units of seconds ($\\mathrm{s}$) and kilograms of carbon per square meter per second ($\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$). The conversion factors are $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$ and $1\\ \\mathrm{year} = 365 \\times 86400\\ \\mathrm{s}$.\n2.  Construct the matrix $\\mathbf{A}$, the pre-step input vector $\\mathbf{I}_{\\text{old}}$, and the post-step input vector $\\mathbf{I}_{\\text{new}} = [I_{L,\\text{old}} + \\Delta I_L, I_{W,\\text{old}}, I_{S,\\text{old}}]^\\top$.\n3.  Compute the inverse of $\\mathbf{A}$, denoted $\\mathbf{A}^{-1}$.\n4.  Calculate the initial carbon stock vector $\\mathbf{C}(0) = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{old}}$.\n5.  Calculate the new steady-state carbon stock vector $\\mathbf{C}_{\\text{new,ss}} = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{new}}$.\n6.  Compute the matrix exponential $e^{-\\mathbf{A}T}$, where $T$ is the evaluation time in seconds.\n7.  Calculate the final carbon stock vector $\\mathbf{C}(T)$ using the derived solution formula.\n8.  Round the components of $\\mathbf{C}(T)$ to six decimal places as required.\n\nThis procedure is applied to each test case provided in the problem statement. The matrix exponential $e^{-\\mathbf{A}T}$ is computed numerically using the `scipy.linalg.expm` function, and matrix-vector operations are handled by the `numpy` library.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the terrestrial carbon cycle model for given test cases.\n    \"\"\"\n    DAY_S = 86400.0\n    YEAR_S = 365.0 * DAY_S\n\n    test_cases = [\n        {\n            \"kL_inv_time\": 30.0 * DAY_S, \"kW_inv_time\": 5.0 * YEAR_S, \"kS_inv_time\": 2.0 * YEAR_S,\n            \"pLS\": 0.7, \"pWS\": 0.9,\n            \"I_old_vals\": [0.004, 0.002, 0.0001], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.001, \"dIL_time\": DAY_S,\n            \"T_val\": 7.0, \"T_unit\": DAY_S\n        },\n        {\n            \"kL_inv_time\": 30.0 * DAY_S, \"kW_inv_time\": 5.0 * YEAR_S, \"kS_inv_time\": 2.0 * YEAR_S,\n            \"pLS\": 0.7, \"pWS\": 0.9,\n            \"I_old_vals\": [0.004, 0.002, 0.0001], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.0, \"dIL_time\": DAY_S,\n            \"T_val\": 10.0, \"T_unit\": DAY_S\n        },\n        {\n            \"kL_inv_time\": 60.0 * DAY_S, \"kW_inv_time\": 50.0 * YEAR_S, \"kS_inv_time\": 0.5 * YEAR_S,\n            \"pLS\": 0.0, \"pWS\": 0.6,\n            \"I_old_vals\": [0.003, 0.001, 0.0002], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.005, \"dIL_time\": DAY_S,\n            \"T_val\": 20.0, \"T_unit\": YEAR_S\n        },\n        {\n            \"kL_inv_time\": 20.0 * DAY_S, \"kW_inv_time\": 10.0 * YEAR_S, \"kS_inv_time\": 1.0 * YEAR_S,\n            \"pLS\": 0.5, \"pWS\": 0.8,\n            \"I_old_vals\": [0.006, 0.0025, 0.00015], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.001, \"dIL_time\": DAY_S,\n            \"T_val\": 0.0, \"T_unit\": DAY_S\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Convert all parameters to base SI units\n        kL = 1.0 / case[\"kL_inv_time\"]\n        kW = 1.0 / case[\"kW_inv_time\"]\n        kS = 1.0 / case[\"kS_inv_time\"]\n        pLS = case[\"pLS\"]\n        pWS = case[\"pWS\"]\n        T_s = case[\"T_val\"] * case[\"T_unit\"]\n\n        I_old_per_s = np.array([v / t for v, t in zip(case[\"I_old_vals\"], case[\"I_old_times\"])])\n        dIL_per_s = case[\"dIL_val\"] / case[\"dIL_time\"]\n\n        # 2. Construct matrices and vectors\n        A = np.array([\n            [kL, 0, 0],\n            [0, kW, 0],\n            [-pLS * kL, -pWS * kW, kS]\n        ])\n\n        I_old = I_old_per_s\n        I_new = I_old + np.array([dIL_per_s, 0, 0])\n\n        # 3. Calculate initial state C(0) and new steady state C_new_ss\n        A_inv = np.linalg.inv(A)\n        C0 = A_inv @ I_old\n        C_new_ss = A_inv @ I_new\n\n        # 4. Calculate the transient solution C(T)\n        if T_s == 0:\n            # At T=0, the state is still the initial state C(0)\n            CT = C0\n        else:\n            # General solution: C(t) = C_new_ss + exp(-A*t) * (C(0) - C_new_ss)\n            mat_exp = expm(-A * T_s)\n            CT = C_new_ss + mat_exp @ (C0 - C_new_ss)\n        \n        # 5. Round and store the result\n        rounded_CT = np.round(CT, 6).tolist()\n        results.append(rounded_CT)\n        \n    # Final print statement in the exact required format without extra spaces.\n    final_output_str = str(results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}