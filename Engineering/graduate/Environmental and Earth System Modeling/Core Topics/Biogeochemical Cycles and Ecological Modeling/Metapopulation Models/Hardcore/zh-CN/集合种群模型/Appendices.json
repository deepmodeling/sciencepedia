{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解任何动态系统的第一步：寻找其平衡点并分析其稳定性。通过求解经典的Levins模型，你将亲手推导出异质种群持续生存或灭绝的关键阈值条件。这项基本功是掌握更复杂异质种群模型的基础。",
            "id": "2508400",
            "problem": "考虑一个由 $N \\gg 1$ 个等价生境斑块组成的大型集合种群。令 $p(t)$ 表示在时间 $t$ 被占据的斑块比例。假设定殖是由已占据斑块向空斑块的繁殖体雨驱动的，其速率与已占据斑块和空斑块的比例之积成正比，而局域灭绝速率与已占据斑块的比例成正比。在这些假设下，占据动态由以下常微分方程描述\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}t} \\;=\\; c\\,p\\,(1-p)\\;-\\;e\\,p,\n$$\n其中 $c0$ 是定殖参数，$e0$ 是局域灭绝参数。在生物学上可行的状态空间 $p \\in [0,1]$ 内进行分析。\n\n从动力系统的平衡点和一维流的线性稳定性的核心定义出发，完成以下任务：\n- 通过求解微分方程右侧的根，找出可行区间内所有的平衡占据率 $p^{*}$。\n- 通过分析微分方程右侧关于 $p$ 的导数在每个平衡点处的符号，判断每个平衡点的局域稳定性。\n- 从生态学角度解释平衡点 $p^{*}=0$ 和你找到的任何内部平衡点的意义，包括每个平衡点存在且稳定的参数条件，以及区分集合种群持续存在与区域性灭绝的阈值的性质。你的解释应明确地将定殖和灭绝过程与平衡点的可行性联系起来。\n\n以包含 $c$ 和 $e$ 的解析表达式的行向量形式报告所有平衡占据率的集合。不要包含单位。如果你的答案包含常数，请保持其符号形式。",
            "solution": "该问题要求对 Levins 集合种群模型的平衡点及其稳定性进行全面分析，并随后进行生态学解释。我们将系统地进行分析。\n\n该动力系统由关于已占据斑块比例 $p(t)$ 的常微分方程描述：\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}t} = f(p) = c\\,p\\,(1-p) - e\\,p\n$$\n其中 $c  0$ 和 $e  0$ 分别是定殖参数和灭绝参数。状态空间被限制在生物学上可行的区间 $p \\in [0, 1]$。\n\n首先，我们通过求解方程 $f(p^{*}) = 0$ 的根来确定平衡点，记为 $p^{*}$。\n$$\nc\\,p^{*}\\,(1-p^{*}) - e\\,p^{*} = 0\n$$\n我们可以从表达式中提出公因子 $p^{*}$：\n$$\np^{*} \\left[ c(1-p^{*}) - e \\right] = 0\n$$\n该方程为平衡占据率提供了两个可能的解。\n\n第一个平衡点是平凡平衡点：\n$$\np_1^{*} = 0\n$$\n这个平衡点代表集合种群已经灭绝，没有斑块被占据。它始终在可行区间 $[0, 1]$ 内。\n\n第二个平衡点可以通过将第二个因子设为零来求得：\n$$\nc(1-p_2^{*}) - e = 0\n$$\n求解 $p_2^{*}$：\n$$\nc - c p_2^{*} = e\n$$\n$$\nc p_2^{*} = c - e\n$$\n$$\np_2^{*} = \\frac{c-e}{c} = 1 - \\frac{e}{c}\n$$\n这是非平凡平衡点，或称内部平衡点。为使该平衡点具有生物学意义，它必须是正的，即 $p_2^{*}  0$。由于 $c$ 和 $e$ 均为正数，这要求 $1 - \\frac{e}{c}  0$，可简化为 $c  e$。它还必须满足 $p_2^{*} \\le 1$，这一点总是成立的，因为当 $\\frac{e}{c} \\ge 0$ 时，$1 - \\frac{e}{c} \\le 1$。因此，当且仅当 $c  e$ 时，内部平衡点 $p_2^{*}$ 存在于具有生物学意义的区间 $(0, 1]$ 内。\n\n接下来，我们判断每个平衡点的局域稳定性。这取决于函数 $f(p)$ 在平衡点处的导数 $f'(p^{*})$ 的符号。如果 $f'(p^{*})  0$，平衡点是局域稳定的；如果 $f'(p^{*})  0$，则是不稳定的。\n\n首先，我们求 $f(p)$ 的导数：\n$$\nf(p) = cp - cp^2 - ep\n$$\n$$\nf'(p) = \\frac{\\mathrm{d}f}{\\mathrm{d}p} = c - 2cp - e\n$$\n\n现在，我们计算 $f'(p)$ 在每个平衡点处的值。\n\n对于平凡平衡点 $p_1^{*} = 0$：\n$$\nf'(0) = c - 2c(0) - e = c - e\n$$\n$p_1^{*} = 0$ 的稳定性取决于 $c$ 和 $e$ 的相对大小：\n- 如果 $c  e$，则 $f'(0)  0$，平衡点 $p_1^{*} = 0$ 是稳定的。\n- 如果 $c  e$，则 $f'(0)  0$，平衡点 $p_1^{*} = 0$ 是不稳定的。\n- 如果 $c = e$，则 $f'(0) = 0$，线性稳定性分析无法得出结论。在这种情况下，微分方程变为 $\\frac{\\mathrm{d}p}{\\mathrm{d}t} = -cp^2$。对于任何 $p  0$，都有 $\\frac{\\mathrm{d}p}{\\mathrm{d}t}  0$，意味着系统总是向 $p=0$ 移动。因此，在 $p=0$ 处的平衡点是稳定的。\n\n对于内部平衡点 $p_2^{*} = 1 - \\frac{e}{c}$：\n$$\nf'(1 - \\frac{e}{c}) = c - 2c\\left(1 - \\frac{e}{c}\\right) - e\n$$\n$$\n= c - (2c - 2e) - e = c - 2c + 2e - e = e - c\n$$\n$p_2^{*}$ 的稳定性判断如下：\n- 该平衡点仅在 $c  e$ 时具有生物学意义。在这种情况下，$e - c  0$，这意味着 $f'(p_2^{*})  0$。因此，当内部平衡点 $p_2^{*}$ 存在于区间 $(0, 1]$ 时，它总是稳定的。\n- 如果 $c  e$，该平衡点为负（$p_2^{*}  0$），因此在生态学上不相关。从数学上看，由于 $e-c  0$，它是不稳定的。\n\n这些发现的生态学解释如下：\n\n平衡点 $p^{*} = 0$ 代表区域性灭绝状态，即集合种群已从斑块网络中消失。当灭绝率参数 $e$ 大于定殖率参数 $c$ ($e  c$) 时，这是唯一的稳定结果。在这种情况下，任何小的已占据斑块种群都会衰减至零，因为斑块因灭绝而丧失的速率超过了通过定殖而增加的速率。\n\n平衡点 $p^{*} = 1 - \\frac{e}{c}$ 代表集合种群的持续存在状态，此时定殖和灭绝过程达到平衡，从而形成一个稳定的、非零的已占据斑块比例。这种状态只有在定殖率参数大于灭绝率参数 ($c  e$) 时才可能出现。这个条件，$c  e$ 或等价地 $\\frac{c}{e}  1$，是集合种群生存能力的基本阈值。它规定了要使集合种群持续存在，定殖率必须足以克服局域灭绝率。当这个条件成立时，区域性灭绝状态 ($p^{*}=0$) 变得不稳定，这意味着任何少量引入的已占据斑块都将导致集合种群的增长和建立，然后趋向于稳定的持续存在平衡点 $p^{*} = 1 - \\frac{e}{c}$。\n\n在 $c=e$ 处发生的转变是一种跨临界分岔。对于 $c  e$ 的情况，可行域中唯一的稳定平衡点是 $p^{*}=0$。当 $c$ 增加超过 $e$ 时，$p^{*}=0$ 平衡点失去其稳定性，一个新的稳定平衡点 $p^{*} = 1 - \\frac{e}{c}$ 在正值域中出现。这种分岔将参数空间严格地划分为两个不同的区域：一个区域中集合种群注定灭绝 ($c \\le e$)，另一个区域中集合种群可以无限期地持续存在 ($c  e$)。这种阈值行为是集合种群理论的一个经典和基本的结果。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  1 - \\frac{e}{c} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界的生态系统很少是线性的。本练习将引导你进入更复杂的领域，通过数值模拟来探索栖息地破坏和拯救效应对异质种群动态的非线性影响。你将亲自揭示滞后效应和临界点的存在，这些概念对于理解生态系统的恢复力及其在环境变化下的突然转变至关重要。",
            "id": "2508438",
            "problem": "考虑一个集合种群，其斑块占据率 $p$ 在经典的 Levins 集合种群框架下演化，该框架经过修改，包含了生境破坏和拯救效应。其动态通过一个常微分方程（ODE）建模，其拓殖和灭绝过程根据第一性原理构建，如下所示。\n\n基本原理。Levins 集合种群理论将占据斑块比例 $p$ 的时间变化描述为拓殖与灭绝之间的差值。拓殖与占据斑块的比例和空的宜居斑块的比例的乘积成正比。灭绝与占据斑块的比例成正比，比例因子取决于生境破坏和局部拯救效应等生态条件。\n\n建模假设与定义。\n- 令 $h \\in [0,1)$ 表示因生境破坏而变得不宜居的斑块比例。宜居斑块的比例为 $(1 - h)$，可达到的最大占据率为 $p \\le (1 - h)$。\n- 令 $c  0$ 为拓殖速率常数。单位时间内的拓殖速率为 $c \\, p \\, ((1 - h) - p)$，它与占据斑块的比例 $p$ 和空的宜居斑块的比例 $((1 - h) - p)$ 成正比。\n- 令 $e(h)$ 为灭绝速率，它随着生境破坏 $h$ 的增加而增加。使用经过充分检验的函数形式 $e(h) = e_{0} \\, (1 + a \\, h)$，其中 $e_{0}  0$ 是基线灭绝速率，$a \\ge 0$ 量化了生境破坏如何增加灭绝风险。\n- 引入拯救效应：每个占据斑块的有效灭绝速率随着局部占据率的增加而降低。将宜居斑块中的归一化占据率定义为 $x = p / (1 - h)$。假设一个二阶拯救效应 $R(x) = (1 - r \\, x^{2})$，其中 $r \\in [0,1]$，因此 $R(x)$ 会随归一化占据率的平方而降低灭绝率。有效灭绝贡献为 $e(h) \\, R(x) \\, p = e(h) \\, (1 - r \\, (p/(1 - h))^{2}) \\, p$。\n- 最终的 ODE 为\n$$\n\\frac{dp}{dt} = c \\, p \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\, p,\n$$\n其中 $e(h) = e_{0} \\, (1 + a \\, h)$，$h \\in [0,1)$，且 $p \\in [0, 1 - h]$。\n\n问题。分析在生境破坏 $h$ 逐渐增加然后减少过程中的滞后现象。具体来说，当依赖于 $h$ 的灭绝率增加 $e(h)$ 和拯救效应同时存在时，确定将生境破坏 $h$ 恢复到其原始值是否能恢复原始的平衡占据率 $p^{*}$。为使此问题可测试且完全明确，请按以下步骤进行：\n\n- 将固定 $h$ 下的平衡点定义为任何满足 $dp/dt = 0$ 的 $p^{*}$。在一维情况下，稳定平衡点 $p^{*}$ 还需满足 $d(dp/dt)/dp \\vert_{p^{*}}  0$。\n- 实现一个数值方案，模拟渐进式生境破坏和恢复的生态过程：\n  1. 固定初始生境破坏 $h_{0}$，并选择起始占据条件 $p(0) = (1 - h_{0})/2$。在固定的 $h=h_{0}$ 下演化 ODE，直至其收敛到一个稳态。将得到的平衡点表示为 $p^{*}_{\\text{baseline}}(h_{0})$。\n  2. 以 $\\Delta h$ 为步长，准静态地将 $h$ 从 $h_{0}$ 增加到 $h_{\\max}$。在每个 $h$ 值下，从前一个 $h$ 值的平衡点开始演化 ODE 直至收敛。这构成了平衡点的前向（$h$ 增加）分支。\n  3. 以相同的步长 $\\Delta h$，准静态地将 $h$ 从 $h_{\\max}$ 减小回 $h_{0}$。在每个 $h$ 值下，从前一个 $h$ 值的平衡点开始演化 ODE 直至收敛。这构成了平衡点的后向（$h$ 减少）分支。\n  4. 在后向递减过程之后，$h=h_{0}$ 处的收敛值设为 $p^{*}_{\\text{return}}(h_{0})$。\n  5. 通过评估布尔值来确定原始平衡点是否恢复\n     $$\n     \\left| p^{*}_{\\text{return}}(h_{0}) - p^{*}_{\\text{baseline}}(h_{0}) \\right| \\le \\delta,\n     $$\n     其中 $\\delta$ 为预设的容差。\n- 对 ODE 使用确定性时间积分；任何数值一致的方案都是可接受的，例如经典的四阶龙格-库塔方法，需使用足够小的时间步长，并基于 $p$ 的变化和 $dp/dt$ 的量级的收敛准则。此问题中没有物理单位；所有量均为 $[0,1]$ 内的无单位分数。将布尔结果表示为单词 True 或 False（任何地方不得出现百分号；所有比例必须为小数）。\n\n数值方案实现细节：\n- 使用固定的时间步长 $\\Delta t = 0.1$，对每个 $h$ 值积分最多 $T_{\\max} = 500$ 个时间单位（即最多 $5000$ 步）。在每个固定的 $h$ 值下，如果最后一步同时满足以下两个条件，则提前停止：$\\lvert p_{n+1} - p_{n} \\rvert \\le 10^{-8}$ 和 $\\lvert dp/dt \\rvert \\le 10^{-8}$。\n- 在每个时间步将 $p$ 裁剪到可行区间 $[0, 1 - h]$ 内，以强制满足生物学可行性。\n- 在 $h_{0}$ 处的最终恢复比较中使用 $\\delta = 10^{-3}$。\n\n测试套件。对于下面的每个参数集，运行上述完整的滞后协议，并返回一个布尔值，指示在将 $h$ 恢复到 $h_{0}$ 后，$p^{*}$ 是否被恢复。每个测试用例是一个 7 元组 $(c, e_{0}, a, r, h_{0}, h_{\\max}, \\Delta h)$:\n- Case $1$: $(1.0, 0.2, 0.0, 0.0, 0.0, 0.6, 0.01)$。\n- Case $2$: $(1.0, 0.2, 2.5, 0.85, 0.0, 0.7, 0.01)$。\n- Case $3$: $(0.3, 0.4, 1.0, 0.9, 0.0, 0.6, 0.01)$。\n- Case $4$: $(1.0, 0.2, 0.2, 0.9, 0.0, 0.6, 0.01)$。\n\n最终输出格式。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[ \\text{True}, \\text{False}, \\text{True} ]$），顺序与上述测试套件一致，其中每个条目是“将 $h$ 恢复到 $h_{0}$ 是否能在容差 $\\delta$ 内恢复原始的 $p^{*}$？”的布尔值答案。",
            "solution": "该问题陈述是一个有效的科学问题，其基础是理论生态学（特别是集合种群动态学）的既定原则。该问题提法恰当、客观，并为数值实验提供了完整、明确的规范。不存在逻辑矛盾、科学谬误或未定义术语。我们将着手解决。\n\n该问题要求分析一个修正后的 Levins 集合种群模型中的滞后现象。斑块占据率 $p$ 的动态由以下常微分方程（ODE）控制：\n$$\n\\frac{dp}{dt} = c \\, p \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\, p\n$$\n这里，$p \\in [0, 1-h]$ 是被占据斑块的比例，$h \\in [0,1)$ 是被破坏生境的比例，$c  0$ 是内在拓殖率，$r \\in [0,1]$ 是拯救效应的强度。灭绝率 $e(h) = e_{0} \\, (1 + a \\, h)$ 随生境破坏而增加，其中 $e_{0}  0$ 是基线率，$a \\ge 0$ 调节 $h$ 的影响。\n\n问题的核心在于系统的平衡态，即满足 $\\frac{dp}{dt} = 0$ 的解。这些是拓殖和灭绝达到平衡的状态。平衡方程为：\n$$\np \\left[ c \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\right] = 0\n$$\n一个平凡平衡点始终是 $p^{*} = 0$，代表集合种群的完全灭绝。非平凡平衡点 ($p^{*}  0$) 可通过求解方括号内的表达式找到：\n$$\nc \\, (1 - h) - c \\, p = e(h) - \\frac{e(h) \\, r}{(1 - h)^2} p^2\n$$\n整理后得到一个关于 $p$ 的二次方程：\n$$\n\\left( \\frac{e(h) \\, r}{(1 - h)^2} \\right) p^2 - c \\, p + (c(1 - h) - e(h)) = 0\n$$\n这个关于 $p$ 的二次方程可以有零个、一个或两个在物理上有意义（即在区间 $(0, 1 - h]$ 内）的实数根。因此，包括平凡平衡点在内的平衡点总数最多可达三个。对于相同的参数 $h$ 值存在多个稳定平衡点是产生滞后现象的必要条件。当系统处于双稳态时，其状态不仅取决于当前参数，还取决于其历史。像 $h$ 这样的参数缓慢变化，可能导致系统沿着一个稳定分支演化，直到该分支在一个分岔点（一个“临界点”）消失，从而迫使系统突然跃迁到另一个相距较远的稳定分支。当参数变化反向时，系统可能不会沿原路径返回，而是沿着新的分支演化，直到到达另一个不同的分岔点。这种现象就是滞后现象。\n\n问题规定了一个精确的数值方案来检测这种滞后现象。该方案包括三个主要步骤：\n1.  **基线平衡点：** 对于初始的生境破坏水平 $h_{0}$，从 $p(0) = (1 - h_{0})/2$ 开始对 ODE 进行积分，直到达到稳定平衡点 $p^{*}_{\\text{baseline}}(h_{0})$。\n2.  **前向扫描：** 参数 $h$ 以小步长 $\\Delta h$ 准静态地从 $h_{0}$ 增加到 $h_{\\max}$。在每一步，通过对 ODE 进行积分来找到平衡点，并将上一步的平衡点作为新的初始条件。这描绘了生境被破坏时系统的路径。\n3.  **后向扫描：** 从 $h_{\\max}$ 开始，以同样的方式将参数 $h$ 减小回 $h_{0}$。这描绘了生境恢复期间的路径。\n\n将后向扫描结束时的最终平衡点 $p^{*}_{\\text{return}}(h_{0})$ 与原始基线 $p^{*}_{\\text{baseline}}(h_{0})$进行比较。如果它们不同（在容差 $\\delta = 10^{-3}$ 范围内），则表明系统未能恢复其原始状态，并且发生了滞后现象。\n\n为实现此方案，我们设计一个包含以下组件的程序：\n- 一个用于 ODE 右侧项 $\\frac{dp}{dt}$ 的函数，它以 $p$、$h$ 和模型参数 $(c, e_{0}, a, r)$ 作为输入。\n- 一个数值积分器。采用经典的四阶龙格-库塔（RK4）方法，固定时间步长 $\\Delta t = 0.1$。在每个积分步之后，将 $p$ 的值裁剪到有效范围 $[0, 1 - h]$ 内，以确保生物学真实性和数值稳定性。\n- 一个平衡求解器函数。该函数对给定的 $h$ 值，从一个初始的 $p$ 开始，迭代应用 RK4 步，直到满足收敛准则：每步 $p$ 的变化量 $\\lvert p_{n+1} - p_{n} \\rvert$ 和导数的量级 $\\lvert dp/dt \\rvert$ 均低于 $10^{-8}$ 的容差。强制执行最大积分时间 $T_{\\max} = 500$。\n- 一个主程序，为问题陈述中指定的每个测试用例协调整个滞后数值方案。该程序管理 $h$ 的前向和后向扫描，并执行最终比较，以确定集合种群是否已恢复。\n\n每个案例的最终布尔结果指示是否满足 $| p^{*}_{\\text{return}}(h_{0}) - p^{*}_{\\text{baseline}}(h_{0}) | \\le 10^{-3}$，恢复记录为 `True`，发生滞后则记录为 `False`。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the hysteresis protocol for all test cases.\n    \"\"\"\n    test_cases = [\n        # (c, e0, a, r, h0, h_max, delta_h)\n        (1.0, 0.2, 0.0, 0.0, 0.0, 0.6, 0.01),\n        (1.0, 0.2, 2.5, 0.85, 0.0, 0.7, 0.01),\n        (0.3, 0.4, 1.0, 0.9, 0.0, 0.6, 0.01),\n        (1.0, 0.2, 0.2, 0.9, 0.0, 0.6, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_recovered = _run_hysteresis_protocol(*case)\n        results.append(is_recovered)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _dp_dt(p, h, c, e0, a, r):\n    \"\"\"\n    Calculates the right-hand side of the metapopulation ODE.\n    dp/dt = f(p, h, params)\n    \"\"\"\n    if h >= 1.0:\n        return 0.0  # No habitable patches\n\n    e_h = e0 * (1.0 + a * h)\n    \n    colonization = c * p * ((1.0 - h) - p)\n    \n    # Rescue effect term requires p to be non-negative and h  1\n    # Normalized occupancy x = p / (1 - h)\n    # The term (1 - r*x^2) can be negative, which is physically valid\n    # representing extinction acceleration at very high occupancy (e.g. Allee effects)\n    extinction = e_h * (1.0 - r * (p / (1.0 - h))**2) * p if (1.0 - h) > 1e-9 else e_h * p\n\n    return colonization - extinction\n\ndef _rk4_step(p, h, dt, c, e0, a, r):\n    \"\"\"\n    Performs one step of the fourth-order Runge-Kutta method.\n    \"\"\"\n    k1 = _dp_dt(p, h, c, e0, a, r)\n    k2 = _dp_dt(p + 0.5 * dt * k1, h, c, e0, a, r)\n    k3 = _dp_dt(p + 0.5 * dt * k2, h, c, e0, a, r)\n    k4 = _dp_dt(p + dt * k3, h, c, e0, a, r)\n    p_next = p + (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n    \n    # Clip to enforce biological feasibility [0, 1-h]\n    p_next = max(0.0, min(p_next, 1.0 - h))\n    return p_next\n\ndef _solve_to_equilibrium(p_initial, h, c, e0, a, r):\n    \"\"\"\n    Integrates the ODE at a fixed h until equilibrium is reached.\n    \"\"\"\n    dt = 0.1\n    T_max = 500.0\n    max_steps = int(T_max / dt)\n    conv_tol = 1e-8\n\n    p_n = p_initial\n    for _ in range(max_steps):\n        p_n_plus_1 = _rk4_step(p_n, h, dt, c, e0, a, r)\n        \n        # Check for convergence\n        dp_val = _dp_dt(p_n_plus_1, h, c, e0, a, r)\n        if abs(p_n_plus_1 - p_n) = conv_tol and abs(dp_val) = conv_tol:\n            return p_n_plus_1\n        \n        p_n = p_n_plus_1\n        \n    return p_n\n\ndef _run_hysteresis_protocol(c, e0, a, r, h0, h_max, delta_h):\n    \"\"\"\n    Executes the full numerical protocol for a single test case.\n    \"\"\"\n    recovery_tol = 1e-3\n\n    # 1. Determine baseline equilibrium at h0\n    p_initial_baseline = (1.0 - h0) / 2.0\n    p_baseline = _solve_to_equilibrium(p_initial_baseline, h0, c, e0, a, r)\n\n    p_current = p_baseline\n\n    # 2. Forward ramp: increase h from h0 to h_max\n    # Use np.arange which excludes the endpoint, so add a small fraction to include h_max\n    h_values_forward = np.arange(h0 + delta_h, h_max + delta_h / 2.0, delta_h)\n    for h in h_values_forward:\n        p_current = _solve_to_equilibrium(p_current, h, c, e0, a, r)\n\n    # 3. Backward ramp: decrease h from h_max to h0\n    # The last p_current from the forward ramp is the starting point for the backward ramp.\n    h_values_backward = np.arange(h_max - delta_h, h0 - delta_h / 2.0, -delta_h)\n    for h in h_values_backward:\n        p_current = _solve_to_equilibrium(p_current, h, c, e0, a, r)\n        \n    p_return = _solve_to_equilibrium(p_current, h0, c, e0, a, r)\n\n    # 4. Check for recovery\n    is_recovered = abs(p_return - p_baseline) = recovery_tol\n    \n    return is_recovered\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "理论模型若要应用于现实世界，其参数必须能够通过观测数据来确定。本练习旨在搭建理论与实践之间的桥梁，指导你如何从斑块占有率的转变数据中，使用最大似然估计方法推导出定殖率 $c$ 和灭绝率 $e$ 。掌握这项技能，你便能将抽象的数学模型转化为可量化的生态评估工具。",
            "id": "2508415",
            "problem": "在经典的 Levins 复合种群框架中，假定大量的生境斑块是相同且充分混合的，局部定植和灭绝作为连续时间过程发生。令 $c$ 表示定植率参数，$e$ 表示灭绝率参数。在长度为 $\\Delta t$ 的短时间间隔内，假定被占据斑块的比例近似恒定，并等于该时间间隔开始时观测到的值。\n\n考虑一个包含 $N$ 个相同斑块的系统。在 $K$ 个等长 $\\Delta t$ 的连续时间间隔中的每一个间隔开始时，您测量了被占据和空闲斑块的数量以及被占据的比例，并且您还记录了每个间隔内的定植和灭绝计数（即转变 $0 \\to 1$ 和 $1 \\to 0$）。假定在每个间隔 $k$ 内，给定在间隔开始时观测到的被占据比例 $p_k$，每个空闲斑块都经历一个无记忆的定植事件，其恒定风险率为 $c\\,p_k$，每个被占据的斑块都经历一个无记忆的灭绝事件，其恒定风险率为 $e$。假定在给定 $(c,e)$ 和每个斑块的初始状态的条件下，斑块之间是独立的，并且假定 $\\Delta t$ 足够小，以至于单个斑块在一个间隔内发生多次转变的概率可以忽略不计。\n\n您从一个拥有 $N=200$ 个斑块的系统中观测到以下 $K=4$ 个间隔的数据，每个间隔长度为 $\\Delta t = 0.25$ 年：\n- 间隔 $k=1$：初始占据数 $N_{1,1}=90$，初始空闲数 $N_{0,1}=110$，占据比例 $p_1=0.45$，观测到的定植数 $Y_{01,1}=12$，观测到的灭绝数 $Y_{10,1}=8$。\n- 间隔 $k=2$：初始占据数 $N_{1,2}=95$，初始空闲数 $N_{0,2}=105$，占据比例 $p_2=0.475$，观测到的定植数 $Y_{01,2}=14$，观测到的灭绝数 $Y_{10,2}=9$。\n- 间隔 $k=3$：初始占据数 $N_{1,3}=100$，初始空闲数 $N_{0,3}=100$，占据比例 $p_3=0.50$，观测到的定植数 $Y_{01,3}=16$，观测到的灭绝数 $Y_{10,3}=10$。\n- 间隔 $k=4$：初始占据数 $N_{1,4}=98$，初始空闲数 $N_{0,4}=102$，占据比例 $p_4=0.49$，观测到的定植数 $Y_{01,4}=15$，观测到的灭绝数 $Y_{10,4}=10$。\n\n从连续时间风险率和斑块历史独立性的定义出发，并且不引用任何预先推导的估计公式，在适用于小 $\\Delta t$ 和大 $N$ 的稀有事件极限下，推导 $c$ 和 $e$ 的最大似然估计量。然后根据上述数据评估这些估计量。以每年为单位表示您最终的 $c$ 和 $e$ 的数值答案，并将每个答案四舍五入到四位有效数字。将您的最终答案以单行向量 $\\left(c\\ \\ e\\right)$ 的形式提供。",
            "solution": "该问题具有科学依据，提法明确且内容自洽。所提供的数据内部一致。我将继续按照规定，从第一性原理出发，推导定植率参数 $c$ 和灭绝率参数 $e$ 的最大似然估计量。\n\n该模型假设斑块动态遵循一个连续时间马尔可夫过程。斑块的状态要么是空闲 ($0$)，要么是被占据 ($1$)。\n\n对于间隔 $k$ 中的单个空闲斑块，定植过程是无记忆的，具有恒定的风险率 $\\lambda_{c,k} = c p_k$，其中 $p_k$ 是间隔 $k$ 开始时被占据斑块的比例。该斑块在长度为 $\\Delta t$ 的时间间隔内被定植的概率为：\n$$ P(\\text{colonization in } \\Delta t) = 1 - \\exp(-\\lambda_{c,k} \\Delta t) = 1 - \\exp(-c p_k \\Delta t) $$\n对于单个被占据的斑块，灭绝过程是无记忆的，具有恒定的风险率 $\\lambda_e = e$。该斑块在 $\\Delta t$ 时间内灭绝的概率为：\n$$ P(\\text{extinction in } \\Delta t) = 1 - \\exp(-\\lambda_e \\Delta t) = 1 - \\exp(-e \\Delta t) $$\n问题指出 $\\Delta t$ 足够小且 $N$ 足够大，这对应于“稀有事件极限”。在此极限下，大量独立斑块中发生的事件（定植或灭绝）数量可以建模为泊松过程。在间隔 $k$ 中，$N_{0,k}$ 个初始空闲斑块中发生的总定植数 $Y_{01,k}$ 是一个服从泊松分布的随机变量，其均值为 $\\Lambda_{c,k}$：\n$$ \\Lambda_{c,k} = N_{0,k} \\times P(\\text{colonization in } \\Delta t) = N_{0,k} \\left[1 - \\exp(-c p_k \\Delta t)\\right] $$\n同样，在间隔 $k$ 中，$N_{1,k}$ 个初始占据斑块中发生的总灭绝数 $Y_{10,k}$ 服从泊松分布，其均值为 $\\Lambda_{e,k}$：\n$$ \\Lambda_{e,k} = N_{1,k} \\times P(\\text{extinction in } \\Delta t) = N_{1,k} \\left[1 - \\exp(-e \\Delta t)\\right] $$\n$\\Delta t$ 很小的假设允许我们对小 $x$ 使用泰勒级数近似 $1 - \\exp(-x) \\approx x$。应用此近似，泊松分布的均值变为：\n$$ \\Lambda_{c,k} \\approx N_{0,k} (c p_k \\Delta t) $$\n$$ \\Lambda_{e,k} \\approx N_{1,k} (e \\Delta t) $$\n均值为 $\\Lambda$ 的泊松随机变量 $Y$ 的概率质量函数为 $P(Y=y) = \\frac{\\Lambda^y e^{-\\Lambda}}{y!}$。\n在 $K=4$ 个间隔内的定植和灭绝观测是独立的。因此，总似然函数 $L(c, e)$ 是观测到每个间隔 $k=1, \\dots, K$ 的数据 $(Y_{01,k}, Y_{10,k})$ 的概率之积。\n$$ L(c, e) = \\prod_{k=1}^{K} P(Y_{01,k}=y_{01,k} | c) \\times P(Y_{10,k}=y_{10,k} | e) $$\n$$ L(c, e) = \\prod_{k=1}^{K} \\left[ \\frac{(N_{0,k} c p_k \\Delta t)^{Y_{01,k}}}{Y_{01,k}!} \\exp(-N_{0,k} c p_k \\Delta t) \\right] \\times \\left[ \\frac{(N_{1,k} e \\Delta t)^{Y_{10,k}}}{Y_{10,k}!} \\exp(-N_{1,k} e \\Delta t) \\right] $$\n为了找到最大似然估计量 (MLE)，我们最大化对数似然函数 $\\ell(c, e) = \\ln L(c, e)$。\n$$ \\ell(c, e) = \\sum_{k=1}^{K} \\left[ Y_{01,k} \\ln(N_{0,k} c p_k \\Delta t) - \\ln(Y_{01,k}!) - N_{0,k} c p_k \\Delta t \\right] + \\sum_{k=1}^{K} \\left[ Y_{10,k} \\ln(N_{1,k} e \\Delta t) - \\ln(Y_{10,k}!) - N_{1,k} e \\Delta t \\right] $$\n对数似然函数可分为两个独立的部分：一个依赖于 $c$ 的部分 $\\ell_c(c)$ 和一个依赖于 $e$ 的部分 $\\ell_e(e)$。\n$$ \\ell_c(c) = \\sum_{k=1}^{K} \\left[ Y_{01,k} (\\ln(c) + \\ln(N_{0,k} p_k \\Delta t)) - N_{0,k} c p_k \\Delta t \\right] - \\sum_{k=1}^{K}\\ln(Y_{01,k}!) $$\n$$ \\ell_e(e) = \\sum_{k=1}^{K} \\left[ Y_{10,k} (\\ln(e) + \\ln(N_{1,k} \\Delta t)) - N_{1,k} e \\Delta t \\right] - \\sum_{k=1}^{K}\\ln(Y_{10,k}!) $$\n为了找到 MLE $\\hat{c}$，我们将 $\\ell_c(c)$ 对 $c$ 求导，并令导数为零。\n$$ \\frac{\\partial \\ell_c}{\\partial c} = \\sum_{k=1}^{K} \\left[ \\frac{Y_{01,k}}{c} - N_{0,k} p_k \\Delta t \\right] = 0 $$\n$$ \\frac{1}{c} \\sum_{k=1}^{K} Y_{01,k} = \\Delta t \\sum_{k=1}^{K} N_{0,k} p_k $$\n解出 $c$ 得到 MLE $\\hat{c}$：\n$$ \\hat{c} = \\frac{\\sum_{k=1}^{K} Y_{01,k}}{\\Delta t \\sum_{k=1}^{K} N_{0,k} p_k} $$\n同样，对于 MLE $\\hat{e}$，我们将 $\\ell_e(e)$ 对 $e$ 求导，并令导数为零。\n$$ \\frac{\\partial \\ell_e}{\\partial e} = \\sum_{k=1}^{K} \\left[ \\frac{Y_{10,k}}{e} - N_{1,k} \\Delta t \\right] = 0 $$\n$$ \\frac{1}{e} \\sum_{k=1}^{K} Y_{10,k} = \\Delta t \\sum_{k=1}^{K} N_{1,k} $$\n解出 $e$ 得到 MLE $\\hat{e}$：\n$$ \\hat{e} = \\frac{\\sum_{k=1}^{K} Y_{10,k}}{\\Delta t \\sum_{k=1}^{K} N_{1,k}} $$\n现在，我们使用所提供的数据来评估这些估计量。给定 $\\Delta t = 0.25$ 年。\n\n首先，对于 $\\hat{c}$：\n观测到的总定植数为：\n$$ \\sum_{k=1}^{4} Y_{01,k} = 12 + 14 + 16 + 15 = 57 $$\n分母项需要计算乘积之和 $N_{0,k} p_k$：\n$$ \\sum_{k=1}^{4} N_{0,k} p_k = (110 \\times 0.45) + (105 \\times 0.475) + (100 \\times 0.50) + (102 \\times 0.49) $$\n$$ \\sum_{k=1}^{4} N_{0,k} p_k = 49.5 + 49.875 + 50.0 + 49.98 = 199.355 $$\n将这些值代入 $c$ 的估计量中：\n$$ \\hat{c} = \\frac{57}{0.25 \\times 199.355} = \\frac{57}{49.83875} \\approx 1.143763 $$\n四舍五入到四位有效数字，$\\hat{c} \\approx 1.144$ 每年。\n\n接下来，对于 $\\hat{e}$：\n观测到的总灭绝数为：\n$$ \\sum_{k=1}^{4} Y_{10,k} = 8 + 9 + 10 + 10 = 37 $$\n被占据斑块-间隔的总数为：\n$$ \\sum_{k=1}^{4} N_{1,k} = 90 + 95 + 100 + 98 = 383 $$\n将这些值代入 $e$ 的估计量中：\n$$ \\hat{e} = \\frac{37}{0.25 \\times 383} = \\frac{37}{95.75} \\approx 0.3864229 $$\n四舍五入到四位有效数字，$\\hat{e} \\approx 0.3864$ 每年。\n\n推导出的估计量代表了事件总数与总暴露量的比率，其中暴露量是为每个过程适当定义的。在这些建模假设下，这是速率估计的一个逻辑且标准的结果。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.144  0.3864 \\end{pmatrix}}$$"
        }
    ]
}