{
    "hands_on_practices": [
        {
            "introduction": "在深入研究彭曼-蒙特斯方程的复杂性之前，我们首先要掌握一个基本技能：将能量通量转换为等效的水深。这个练习将阐明潜热通量（蒸发消耗的能量）与蒸散速率（以毫米每天为单位）之间的物理联系 。掌握这项单位换算技能是利用基于能量平衡的方法进行任何水文分析的基础。",
            "id": "3924835",
            "problem": "在稳定的白天条件下，一个水分充足、空气动力学耦合的冠层，其地表测得的潜热通量（记为 $\\lambda E$）为 $150\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$，其中 $\\lambda$ 是汽化潜热，$E$ 是蒸散质量通量。在用于计算蒸散的彭曼-蒙特斯 (PM) 方程框架中，潜热通量代表了有效能量中被水相变所消耗的部分。请仅从陆-气界面的能量守恒原理以及汽化潜热作为相变所需单位质量能量的定义出发，推导如何将测得的能量通量 $\\lambda E$ 转换为等效的蒸散深度速率。使用恒定的汽化潜热 $\\lambda = 2.45 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$ 和液态水密度 $\\rho_{w} = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，并假设该通量在一天内空间上均匀且时间上稳定。\n\n计算以单位时间深度表示的蒸散速率，并以 $\\mathrm{mm}\\,\\mathrm{day}^{-1}$ 为单位表示。将最终答案四舍五入到三位有效数字。仅提供最终的数值。",
            "solution": "本题要求将给定的潜热通量转换为以单位时间深度表示的蒸散速率。推导过程必须从基本原理出发。\n\n设潜热通量记为 $Q_{LE}$。题目给出的其值为：\n$$Q_{LE} = 150\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$$\n瓦特（$W$）等于焦耳每秒（$J\\,s^{-1}$），因此，代表单位面积单位时间能量的潜热通量为：\n$$Q_{LE} = 150\\,\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}$$\n该通量是在单位面积、单位时间内，用于驱动水从液态变为气态的相变所消耗的能量。\n\n汽化潜热 $\\lambda$ 被定义为将单位质量的物质从液态转化为气态所需的能量。其给定值为：\n$$\\lambda = 2.45 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n蒸散质量通量，记为 $E$，是单位面积单位时间内蒸发的水的质量。其单位是 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n根据能量守恒原理和上述定义，能量通量 $Q_{LE}$、质量通量 $E$ 和汽化潜热 $\\lambda$ 之间的关系由以下方程给出：\n$$Q_{LE} = \\lambda E$$\n我们可以解出质量通量 $E$：\n$$E = \\frac{Q_{LE}}{\\lambda}$$\n代入给定值：\n$$E = \\frac{150\\,\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}}{2.45 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}}$$\n这得出质量通量 $E$ 的单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n下一步是将此质量通量转换为深度速率。在面积 $A$ 上、时间间隔 $\\Delta t$ 内蒸发的水的质量 $\\Delta M$ 由下式给出：\n$$\\Delta M = E \\cdot A \\cdot \\Delta t$$\n这部分质量的水，在蒸发前，占据了一定的体积 $\\Delta V$。质量和体积之间的关系由液态水的密度 $\\rho_w$ 给出：\n$$\\Delta M = \\rho_w \\Delta V$$\n水的密度值给定为：\n$$\\rho_w = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$$\n在面积 $A$ 上蒸发的水的体积 $\\Delta V$，对应于一个等效的水深，我们将其记为 $d_{ET}$。其关系为：\n$$\\Delta V = d_{ET} \\cdot A$$\n将 $\\Delta V$ 代入质量-体积方程，我们得到以深度表示的蒸发水质量：\n$$\\Delta M = \\rho_w d_{ET} A$$\n现在我们可以令 $\\Delta M$ 的两个表达式相等：\n$$E \\cdot A \\cdot \\Delta t = \\rho_w d_{ET} A$$\n两边同除以面积 $A$ 和时间间隔 $\\Delta t$，即可分离出以单位时间深度表示的蒸散速率 $ET_{rate} = \\frac{d_{ET}}{\\Delta t}$：\n$$ET_{rate} = \\frac{E}{\\rho_w}$$\n将来自能量平衡的 $E$ 表达式代入，我们得到将潜热通量转换为蒸散深度速率的最终公式：\n$$ET_{rate} = \\frac{Q_{LE}}{\\lambda \\rho_w}$$\n现在，我们可以将数值代入此方程，以国际单位制（$\\mathrm{m}\\,\\mathrm{s}^{-1}$）计算该速率：\n$$ET_{rate} = \\frac{150\\,\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}}{(2.45 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1})(1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3})} = \\frac{150}{2.45 \\times 10^{9}}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\n$$ET_{rate} \\approx 6.12244898 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\n题目要求最终答案以毫米/天（$\\mathrm{mm}\\,\\mathrm{day}^{-1}$）表示。题目说明假设通量“在一天内时间上稳定”，这意味着该速率在24小时内是恒定的。我们必须进行单位换算。\n一天中的秒数：\n$$1\\,\\mathrm{day} = 24\\,\\mathrm{hours/day} \\times 60\\,\\mathrm{minutes/hour} \\times 60\\,\\mathrm{seconds/minute} = 86400\\,\\mathrm{s}$$\n一米中的毫米数：\n$$1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$$\n转换过程如下：\n$$ET_{rate} \\, [\\mathrm{mm}\\,\\mathrm{day}^{-1}] = \\left( 6.12244898 \\times 10^{-8}\\,\\frac{\\mathrm{m}}{\\mathrm{s}} \\right) \\times \\left( \\frac{86400\\,\\mathrm{s}}{1\\,\\mathrm{day}} \\right) \\times \\left( \\frac{1000\\,\\mathrm{mm}}{1\\,\\mathrm{m}} \\right)$$\n$$ET_{rate} \\, [\\mathrm{mm}\\,\\mathrm{day}^{-1}] = (6.12244898 \\times 10^{-8}) \\times (8.64 \\times 10^{4}) \\times (10^{3})$$\n$$ET_{rate} \\, [\\mathrm{mm}\\,\\mathrm{day}^{-1}] = 6.12244898 \\times 8.64 \\times 10^{-8+4+3} = 52.897959... \\times 10^{-1}$$\n$$ET_{rate} \\approx 5.2898\\,\\mathrm{mm}\\,\\mathrm{day}^{-1}$$\n最后，题目要求将答案四舍五入到三位有效数字。第四位有效数字是9，因此对第三位数字进行进位。\n$$ET_{rate} \\approx 5.29\\,\\mathrm{mm}\\,\\mathrm{day}^{-1}$$\n最终数值为 $5.29$。",
            "answer": "$$\\boxed{5.29}$$"
        },
        {
            "introduction": "本练习将引导你从基本原理出发，亲自推导完整的彭曼-蒙特斯方程。通过结合地表能量平衡、湍流输送的体积公式以及饱和水汽压曲线的线性化，你将了解该方程如何将辐射驱动项和空气动力学驱动项巧妙地结合起来 。这个过程不仅能加深你对模型结构的理解，还能锻炼你解决多变量物理问题的能力。",
            "id": "3924849",
            "problem": "一个水平均质、水分充足的冠层在稳态条件下被观测，其热储存和平流可忽略不计。地表能量平衡由辐射输入和湍流交换闭合，感热和潜热交换均遵循带阻力的整体输送定律。给定以下测量或规定的量：净可用能量 $R_n - G = 200\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$，空气密度 $\\rho = 1.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，空气定压比热 $c_p = 1004\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，水汽压差 $\\mathrm{VPD} = 1\\ \\mathrm{kPa}$，空气温度下饱和水汽压曲线的斜率 $\\Delta = 0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$，干湿表常数 $\\gamma = 0.066\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$，空气动力学阻力 $r_a = 50\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$，以及整体地表（冠层）阻力 $r_s = 100\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$。假设蒸发潜热为 $\\lambda = 2.45 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$。\n\n仅从地表能量平衡、湍流感热和潜热交换的整体公式，以及饱和水汽压在空气温度附近的一阶（温度）线性化出发，推导出一个依赖于 $R_n - G$、$\\rho$、$c_p$、$\\mathrm{VPD}$、$\\Delta$、$\\gamma$、$r_a$ 和 $r_s$ 的潜热通量 $\\lambda E$ 的表达式。然后使用所提供的数据对 $\\lambda E$ 进行数值计算。最后，利用 $1\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$ 等效于 $1\\ \\mathrm{mm}$ 水深的换算关系，将所得的潜热通量转换为以 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$ 为单位的蒸散速率 $E$。将最终报告的 $E$ 值四舍五入到三位有效数字，并以 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$ 为单位表示答案。",
            "solution": "该问题要求从基本原理出发，推导潜热通量 $\\lambda E$ 的彭曼-蒙特斯方程，然后对蒸散速率 $E$ 进行数值计算。\n\n**1. 潜热通量（$\\lambda E$）表达式的推导**\n\n推导从描述所述假设下的地表能量平衡和湍流通量的三个基本方程开始。\n\n首先，地表能量平衡方程指出，地表的净可用能量（$R_n - G$）被分配为感热通量（$H$）和潜热通量（$\\lambda E$）：\n$$R_n - G = H + \\lambda E \\quad (1)$$\n\n其次，感热通量的整体输送公式，将通量与温度梯度和空气动力学阻力联系起来，由下式给出：\n$$H = \\rho c_p \\frac{T_s - T_a}{r_a} \\quad (2)$$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气定压比热，$T_s$ 是地表温度，$T_a$ 是空气温度，$r_a$ 是空气动力学阻力。\n\n第三，潜热通量的整体输送公式，将通量与水汽压梯度以及由空气动力学和地表分量组成的总阻力联系起来，其表达式为：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{e_s(T_s) - e_a}{r_a + r_s} \\quad (3)$$\n其中 $\\gamma$ 是干湿表常数，$e_s(T_s)$ 是地表温度 $T_s$ 下的饱和水汽压，$e_a$ 是空气的实际水汽压，$r_s$ 是整体地表阻力。\n\n地表温度 $T_s$ 是一个必须消去的未知数。我们通过在已知的空气温度 $T_a$ 附近对饱和水汽压函数 $e_s(T)$ 进行线性化来实现这一点。一阶泰勒级数展开给出：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a) \\quad (4)$$\n其中 $\\Delta = \\frac{de_s}{dT}|_{T_a}$ 是在空气温度下饱和水汽压曲线的斜率。\n\n从方程（2）中，我们可以用 $H$ 来表示温差 $(T_s - T_a)$：\n$$T_s - T_a = \\frac{H r_a}{\\rho c_p} \\quad (5)$$\n\n将方程（5）代入方程（4）：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta \\frac{H r_a}{\\rho c_p}$$\n\n现在，将这个 $e_s(T_s)$ 的表达式代入潜热通量方程（3）：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma (r_a + r_s)} \\left[ \\left( e_s(T_a) + \\Delta \\frac{H r_a}{\\rho c_p} \\right) - e_a \\right]$$\n\n我们识别出 $e_s(T_a) - e_a$ 项是水汽压差，$\\mathrm{VPD}$。方程简化为：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma (r_a + r_s)} \\left[ \\mathrm{VPD} + \\frac{\\Delta H r_a}{\\rho c_p} \\right]$$\n\n将括号外的因子分配进去得到：\n$$\\lambda E = \\frac{\\rho c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)} + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} H \\quad (6)$$\n\n我们现在有两个方程（1）和（6），以及两个未知数 $H$ 和 $\\lambda E$。我们求解这个方程组。从（1）中，我们有 $H = (R_n - G) - \\lambda E$。将此代入（6）：\n$$\\lambda E = \\frac{\\rho c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)} + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} [ (R_n - G) - \\lambda E ]$$\n\n为了求解 $\\lambda E$，我们将所有包含 $\\lambda E$ 的项组合到左边：\n$$\\lambda E + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} \\lambda E = \\frac{\\rho c_p \\mathrm{VPD} + \\Delta r_a (R_n - G)}{\\gamma (r_a + r_s)}$$\n\n将 $\\lambda E$ 提取出来：\n$$\\lambda E \\left( 1 + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n简化括号中的项：\n$$1 + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} = \\frac{\\gamma(r_a + r_s) + \\Delta r_a}{\\gamma(r_a + r_s)}$$\n\n将其代回得到：\n$$\\lambda E \\left( \\frac{\\Delta r_a + \\gamma(r_a + r_s)}{\\gamma(r_a + r_s)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_s)}$$\n\n最后，我们分离出 $\\lambda E$ 以获得推导出的表达式：\n$$\\lambda E = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\Delta r_a + \\gamma (r_a + r_s)}$$\n\n**2. 数值计算**\n\n现在我们将给定的数值代入推导出的表达式。所有值都必须使用一致的国际单位制（SI）单位。\n- $R_n - G = 200\\ \\mathrm{J}\\ \\mathrm{s}^{-1}\\ \\mathrm{m}^{-2}$\n- $\\rho = 1.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$\n- $c_p = 1004\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$\n- $\\mathrm{VPD} = 1\\ \\mathrm{kPa} = 1000\\ \\mathrm{Pa}$\n- $\\Delta = 0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1} = 200\\ \\mathrm{Pa}\\ \\mathrm{K}^{-1}$\n- $\\gamma = 0.066\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1} = 66\\ \\mathrm{Pa}\\ \\mathrm{K}^{-1}$\n- $r_a = 50\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$\n- $r_s = 100\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$\n- $\\lambda = 2.45 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$\n\n首先，计算分子：\n分子 = $\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}$\n$= (200 \\times 50 \\times 200) + (1.2 \\times 1004 \\times 1000)$\n$= 2,000,000 + 1,204,800 = 3,204,800\\ \\mathrm{Pa}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}\\ \\mathrm{m}^{-3}$\n\n接下来，计算分母：\n分母 = $\\Delta r_a + \\gamma (r_a + r_s)$\n$= (200 \\times 50) + (66 \\times (50 + 100))$\n$= 10,000 + (66 \\times 150) = 10,000 + 9,900 = 19,900\\ \\mathrm{Pa}\\ \\mathrm{s}\\ \\mathrm{K}^{-1}\\ \\mathrm{m}^{-1}$\n\n现在，计算 $\\lambda E$：\n$$\\lambda E = \\frac{3,204,800}{19,900} \\approx 161.045\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$$\n\n**3. 转换为蒸散速率（$E$）**\n\n蒸散速率 $E$ 是水的质量通量，可以通过将潜热通量 $\\lambda E$ 除以蒸发潜热 $\\lambda$ 来求得：\n$$E_{mass} = \\frac{\\lambda E}{\\lambda} = \\frac{161.045\\ \\mathrm{J}\\ \\mathrm{s}^{-1}\\ \\mathrm{m}^{-2}}{2.45 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}} \\approx 6.57327 \\times 10^{-5}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$$\n\n问题要求答案的单位是 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$。我们已知 $1\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$ 的水深等效于 $1\\ \\mathrm{mm}$。因此，以 $\\mathrm{mm}\\ \\mathrm{s}^{-1}$ 为单位的速率在数值上等于以 $\\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ 为单位的速率。\n$$E_{depth} \\approx 6.57327 \\times 10^{-5}\\ \\mathrm{mm}\\ \\mathrm{s}^{-1}$$\n\n要从 $\\mathrm{mm}\\ \\mathrm{s}^{-1}$ 转换为 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$，我们需要乘以一小时的秒数（$3600$）：\n$$E = E_{depth} \\times 3600\\ \\mathrm{s}\\ \\mathrm{h}^{-1} = (6.57327 \\times 10^{-5}) \\times 3600 \\approx 0.236637 \\ \\mathrm{mm}\\ \\mathrm{h}^{-1}$$\n\n按要求四舍五入到三位有效数字：\n$$E \\approx 0.237\\ \\mathrm{mm}\\ \\mathrm{h}^{-1}$$",
            "answer": "$$\\boxed{0.237}$$"
        },
        {
            "introduction": "现在，让我们将静态的彭曼-蒙特斯方程应用到一个动态的、更接近真实世界环境建模的场景中。在这个综合练习中，你将构建一个时间步进模型，模拟蒸散过程如何随时间消耗土壤水分，以及土壤水分的减少又如何反过来通过影响气孔阻力来调节蒸散速率 。通过这个实践，你将亲身体验从“能量限制”到“水分限制”状态的转变，这是理解陆地-大气相互作用的关键一环。",
            "id": "3924844",
            "problem": "考虑一个位于平坦地形上的均质冠层-土壤系统，该系统连续 $10$ 天受到水平均一、不随时间变化的气象强迫。目标是使用基于阻抗的能量平衡闭合方法和一个用于气孔阻抗的土壤湿度阈值模型来计算每日蒸散（ET），并诊断从能量限制到水分限制的蒸发控制机制的转换。计算结果必须以毫米/天（mm/day）为单位表示，并四舍五入到三位小数。您必须实现一个完整的、可运行的程序，该程序遵循以下规范。\n\n推导和建模的基本依据：\n- 从地表能量平衡出发，即潜热通量 $ \\lambda E $ 加上感热通量 $ H $ 等于净辐射 $ R_n $ 减去地表热通量 $ G $，即 $ \\lambda E + H = R_n - G $。这里 $ \\lambda $ 是蒸发潜热，$ E $ 是单位面积的水汽质量通量，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。\n- 使用与 Fick 定律和牛顿冷却定律一致的阻抗网络类比来参数化地表-大气交换：$ H = \\rho c_p (T_s - T_a) / r_a $，其中 $ \\rho $ 是空气密度，$ c_p $ 是空气定压比热，$ T_s $ 是地表（冠层-空气界面）温度，$ T_a $ 是气温，$ r_a $ 是空气动力学阻抗。对于水汽，通过干湿表关系和气孔表面阻抗 $ r_s $ 将水汽梯度与饱和差联系起来；利用饱和水汽压曲线的斜率 $ \\Delta $ 在 $ T_a $ 附近对饱和水汽压进行线性化。\n- 使用干湿表常数 $ \\gamma $ 和斜率 $ \\Delta $（单位均为 $\\mathrm{Pa\\,K^{-1}}$）、空气密度 $ \\rho $ 和水汽压亏缺 $ D $（单位为 $\\mathrm{Pa}$）的定义来闭合系统，不提供任何捷径或目标公式。\n\n模型组件和参数：\n- 气象条件在所有天内保持不变：净辐射 $ R_n = 150 \\,\\mathrm{W\\,m^{-2}} $，地表热通量 $ G = 0 \\,\\mathrm{W\\,m^{-2}} $，气温 $ T_a = 298.15 \\,\\mathrm{K} $（即 $25\\,^\\circ\\mathrm{C}$），大气压力 $ p = 101325 \\,\\mathrm{Pa} $，水汽压亏缺 $ D = 2000 \\,\\mathrm{Pa} $，空气动力学阻抗 $ r_a = 50 \\,\\mathrm{s\\,m^{-1}} $。使用空气定压比热 $ c_p = 1005 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} $，蒸发潜热 $ \\lambda = 2.45 \\times 10^6 \\,\\mathrm{J\\,kg^{-1}} $，干空气气体常数 $ R_d = 287 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} $。水汽与干空气的分子量之比为 $ \\varepsilon = 0.622 $。\n- 根据理想气体定律计算 $ \\rho $：$ \\rho = p / (R_d T_a) $。\n- 通过 Tetens 关系式在一致的单位下计算饱和水汽压 $ e_s(T) $ 及其在 $ T_a $ 处的温度斜率 $ \\Delta = \\mathrm{d}e_s/\\mathrm{d}T $。具体来说，使用 $ e_s(T_C) = 0.6108 \\exp\\!\\left( \\frac{17.2694\\, T_C}{T_C + 237.3} \\right) $（单位为 $\\mathrm{kPa}$，其中 $ T_C $ 是摄氏度气温），将 $ e_s $ 转换为 $\\mathrm{Pa}$，并通过对此表达式对温度求导来计算 $ \\Delta $（单位为 $\\mathrm{Pa\\,K^{-1}} $）。\n- 计算干湿表常数 $ \\gamma = \\frac{c_p p}{\\varepsilon \\lambda} $（单位为 $\\mathrm{Pa\\,K^{-1}} $）。\n\n土壤湿度模型和气孔阻抗：\n- 根区深度为 $ Z_r = 0.5 \\,\\mathrm{m} $。设体积含水量为 $ \\theta $（单位为 $\\mathrm{m^3\\,m^{-3}}$）。气孔阻抗 $ r_s(\\theta) $ 遵循一个阈值模型，其最小阻抗为 $ r_{s,\\min} = 50 \\,\\mathrm{s\\,m^{-1}} $，阈值含水量为 $ \\theta^\\ast = 0.20 $，凋萎含水量为 $ \\theta_w = 0.10 $，陡度系数为 $ \\alpha = 6 $。该模型为：\n$$\nr_s(\\theta) =\n\\begin{cases}\nr_{s,\\min}, & \\theta \\ge \\theta^\\ast, \\\\\nr_{s,\\min} \\exp\\!\\left( \\alpha \\frac{\\theta^\\ast - \\theta}{\\theta^\\ast - \\theta_w} \\right), & \\theta < \\theta^\\ast.\n\\end{cases}\n$$\n- 每日水量平衡更新忽略降水和排水，因此 $ \\theta $ 纯粹因蒸散提取而减少：\n$$\n\\theta_{t+1} = \\max\\!\\left( \\theta_t - \\frac{E_t^\\mathrm{mm/day}}{1000\\, Z_r},\\, \\theta_w \\right),\n$$\n其中 $ E_t^\\mathrm{mm/day} $ 是每日蒸散深度，单位为 $\\mathrm{mm\\,day^{-1}}$。注意 $ 1\\,\\mathrm{kg\\,m^{-2}} = 1\\,\\mathrm{mm} $ 的水深，且 $ 1000\\,\\mathrm{mm} = 1\\,\\mathrm{m} $。\n- 定义控制参数\n$$\n\\Omega = \\frac{\\Delta}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)},\n$$\n并用它来诊断机制。能量限制控制对应较大的 $ \\Omega $，而水分限制控制对应较小的 $ \\Omega $。对于本问题，将转换时间定义为第一个使 $ \\Omega_t < 0.5 $ 的天数索引 $ t $。如果在 $10$ 天内没有这样的日子，则报告 $-1$。\n\n任务要求：\n- 从上述能量平衡和阻抗网络关系式推导出 $ E $ 的表达式，使用 $ \\Delta $、$ \\gamma $、$ \\rho $、$ c_p $、$ D $、$ r_a $ 和 $ r_s $。实现所得的计算以获得作为质量通量（单位 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）的 $ E_t $，然后通过乘以 $ 86400 $ 将其转换为 $\\mathrm{mm\\,day^{-1}}$。\n- 使用指定的土壤湿度更新公式每日推进 $ \\theta $。\n- 对于下面定义的每个测试案例，计算 $10$ 天的每日 ET 序列和转换日索引。\n\n测试套件：\n- 案例 $1$：初始 $ \\theta_0 = 0.35 $。\n- 案例 $2$：初始 $ \\theta_0 = 0.25 $。\n- 案例 $3$：初始 $ \\theta_0 = 0.20 $。\n- 案例 $4$：初始 $ \\theta_0 = 0.12 $。\n\n答案规格和输出格式：\n- 您的程序必须使用提供的参数值，并为每个案例生成一个包含 $11$ 个数字的列表：前 $10$ 个条目是 $ t = 1, \\dots, 10 $ 的每日 ET 值 $ E_t^\\mathrm{mm/day} $，四舍五入到三位小数，最后一个条目是如上定义的整数转换日索引（如果没有发生转换，则使用 $-1$）。\n- 将四个案例的结果汇总到一个列表中，并精确打印一行，其中包含用方括号括起来的逗号分隔列表形式的结果，不含多余的空格。例如，最终输出应类似于 $[ [\\dots], [\\dots], [\\dots], [\\dots] ]$，条目之间用逗号分隔。确保 ET 值以 $\\mathrm{mm\\,day^{-1}}$ 给出，转换索引为整数。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n\n**基本方程：**\n- 地表能量平衡：$ \\lambda E + H = R_n - G $\n- 感热通量：$ H = \\rho c_p (T_s - T_a) / r_a $\n- 水汽通量：基于阻抗类比，并使用斜率 $ \\Delta $ 对 $T_a$ 附近的饱和水汽压进行线性化。\n\n**气象和物理常数：**\n- 模拟时长：$10$ 天\n- 净辐射：$ R_n = 150 \\,\\mathrm{W\\,m^{-2}} $\n- 地表热通量：$ G = 0 \\,\\mathrm{W\\,m^{-2}} $\n- 气温：$ T_a = 298.15 \\,\\mathrm{K} $ ($25\\,^\\circ\\mathrm{C}$)\n- 大气压力：$ p = 101325 \\,\\mathrm{Pa} $\n- 水汽压亏缺：$ D = 2000 \\,\\mathrm{Pa} $\n- 空气动力学阻抗：$ r_a = 50 \\,\\mathrm{s\\,m^{-1}} $\n- 空气定压比热：$ c_p = 1005 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} $\n- 蒸发潜热：$ \\lambda = 2.45 \\times 10^6 \\,\\mathrm{J\\,kg^{-1}} $\n- 干空气气体常数：$ R_d = 287 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} $\n- 分子量比值（水汽/干空气）：$ \\varepsilon = 0.622 $\n\n**计算公式：**\n- 空气密度：$ \\rho = p / (R_d T_a) $\n- 饱和水汽压：$ e_s(T_C) = 0.6108 \\exp\\!\\left( \\frac{17.2694\\, T_C}{T_C + 237.3} \\right) $（单位 $\\mathrm{kPa}$，其中 $T_C$ 为摄氏度）\n- 饱和水汽压曲线斜率：$ \\Delta = \\mathrm{d}e_s/\\mathrm{d}T $ 于 $ T_a $ 处。\n- 干湿表常数：$ \\gamma = \\frac{c_p p}{\\varepsilon \\lambda} $\n\n**土壤湿度和气孔阻抗模型：**\n- 根区深度：$ Z_r = 0.5 \\,\\mathrm{m} $\n- 最小气孔阻抗：$ r_{s,\\min} = 50 \\,\\mathrm{s\\,m^{-1}} $\n- 阈值含水量：$ \\theta^\\ast = 0.20 $\n- 凋萎含水量：$ \\theta_w = 0.10 $\n- 陡度系数：$ \\alpha = 6 $\n- 气孔阻抗模型：$r_s(\\theta) = \\begin{cases} r_{s,\\min}, & \\theta \\ge \\theta^\\ast \\\\ r_{s,\\min} \\exp\\!\\left( \\alpha \\frac{\\theta^\\ast - \\theta}{\\theta^\\ast - \\theta_w} \\right), & \\theta < \\theta^\\ast \\end{cases}$\n- 每日水量平衡：$ \\theta_{t+1} = \\max\\!\\left( \\theta_t - \\frac{E_t^\\mathrm{mm/day}}{1000\\, Z_r},\\, \\theta_w \\right) $\n\n**诊断标准：**\n- 控制参数：$ \\Omega = \\frac{\\Delta}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} $\n- 转换时间：第一个使 $ \\Omega_t < 0.5 $ 的天数索引 $ t $。如果在 $10$ 天内没有发生转换，则报告 $-1$。\n\n**单位转换和测试案例：**\n- $1\\,\\mathrm{kg\\,m^{-2}}$ 的水相当于 $1\\,\\mathrm{mm}$ 的水深。\n- 通过乘以 $86400$ 将 $E$ 从 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ 转换为 $\\mathrm{mm\\,day^{-1}}$。\n- 初始体积含水量 $ \\theta_0 $ 的测试案例：$0.35$, $0.25$, $0.20$, $0.12$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题经过了严格的验证。\n- **科学依据**：该问题基于地表能量平衡和阻抗网络类比的原理，这些是微气象学和水文学的核心。推导蒸散率的组合方法是 Penman-Monteith 方法的一个变体，是该领域的基石。土壤湿度模型是对气孔对水分胁迫响应的常见且有效的经验表示。该问题不含伪科学。\n- **适定性**：该问题为时间步进模拟提供了一组确定性的方程、常数和初始条件。对于每个测试案例，都存在唯一的解。\n- **客观性**：问题以精确、定量和无偏见的科学语言陈述。\n- **完整性和一致性**：提供了所有必要的参数和方程。问题明确要求从给定的第一性原理推导蒸散的最终表达式，这是一项严谨且自洽的任务。对推导出的方程进行量纲分析，证实了它们的一致性。\n- **现实性**：所提供的气象和生物物理参数在温带或半干旱气候下植被表面的现实范围内。模拟设置是环境建模中的标准方法。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。这是一个在环境建模领域中表述良好、科学合理的问题，需要从第一性原理进行严谨的推导，然后进行数值实现。\n\n## 解决方案\n\n解决方案分两个阶段进行：首先，按要求推导蒸散的控制方程；其次，描述时间步进模拟的数值算法。\n\n### 蒸散方程的推导\n\n目标是找到蒸散质量通量 $E$（单位 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）的一个表达式，该表达式不依赖于未知的地表温度 $T_s$。这通过将能量平衡方程与基于阻抗的通量公式相结合来实现。\n\n基本方程是：\n1.  地表能量平衡：\n    $$ R_n - G = \\lambda E + H $$\n2.  感热通量（$H$）：\n    $$ H = \\frac{\\rho c_p (T_s - T_a)}{r_a} $$\n3.  潜热通量（$\\lambda E$），可以用水汽压和阻抗来表示。质量通量 $E$ 由下式给出：\n    $$ E = \\rho \\frac{q_s(T_s) - q_a}{r_a + r_s} $$\n    其中 $q$ 是比湿。使用近似 $q \\approx \\frac{\\varepsilon e}{p}$，其中 $e$ 是水汽压，我们有：\n    $$ E = \\frac{\\rho \\varepsilon}{p} \\frac{e_s(T_s) - e_a}{r_a + r_s} $$\n    这里，$e_s(T_s)$ 是地表的饱和水汽压，$e_a$ 是空气的实际水汽压。潜热通量则为：\n    $$ \\lambda E = \\lambda \\frac{\\rho \\varepsilon}{p} \\frac{e_s(T_s) - e_a}{r_a + r_s} $$\n    使用干湿表常数的定义 $\\gamma = \\frac{c_p p}{\\varepsilon \\lambda}$，这变为：\n    $$ \\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{e_s(T_s) - e_a}{r_a + r_s} $$\n\n未知的地表温度 $T_s$ 同时出现在 $H$ 和 $\\lambda E$ 的表达式中。为了消除它，我们在已知的气温 $T_a$ 附近对饱和水汽压函数 $e_s(T)$ 进行线性化：\n$$ e_s(T_s) \\approx e_s(T_a) + \\left. \\frac{\\mathrm{d}e_s}{\\mathrm{d}T} \\right|_{T_a} (T_s - T_a) $$\n$$ e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a) $$\n将此代入潜热通量方程：\n$$ \\lambda E = \\frac{\\rho c_p}{\\gamma (r_a + r_s)} [e_s(T_a) - e_a + \\Delta(T_s - T_a)] $$\n项 $e_s(T_a) - e_a$ 是水汽压亏缺 $D$。\n$$ \\lambda E = \\frac{\\rho c_p}{\\gamma (r_a + r_s)} [D + \\Delta(T_s - T_a)] $$\n从感热通量方程，我们可以将温差表示为 $T_s - T_a = \\frac{H r_a}{\\rho c_p}$。将此代入上式：\n$$ \\lambda E = \\frac{\\rho c_p}{\\gamma (r_a + r_s)} \\left[D + \\Delta \\frac{H r_a}{\\rho c_p}\\right] $$\n$$ \\lambda E = \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} + \\frac{\\Delta r_a H}{\\gamma (r_a + r_s)} $$\n此方程现在将 $\\lambda E$ 和 $H$ 联系起来。我们使用能量平衡 $H = (R_n - G) - \\lambda E$ 来消除 $H$：\n$$ \\lambda E = \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} [(R_n - G) - \\lambda E] $$\n现在我们求解 $\\lambda E$：\n$$ \\lambda E \\left(1 + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)}\\right) = \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} + \\frac{\\Delta r_a (R_n - G)}{\\gamma (r_a + r_s)} $$\n$$ \\lambda E \\left(\\frac{\\gamma (r_a + r_s) + \\Delta r_a}{\\gamma (r_a + r_s)}\\right) = \\frac{\\rho c_p D + \\Delta r_a (R_n - G)}{\\gamma (r_a + r_s)} $$\n$$ \\lambda E = \\frac{\\Delta r_a (R_n - G) + \\rho c_p D}{\\Delta r_a + \\gamma (r_a + r_s)} $$\n这是潜热通量的最终表达式。蒸散质量通量 $E$ 就是：\n$$ E = \\frac{1}{\\lambda} \\left( \\frac{\\Delta r_a (R_n - G) + \\rho c_p D}{\\Delta r_a + \\gamma (r_a + r_s)} \\right) $$\n\n### 计算流程\n\n通过为每个初始土壤湿度条件实现一个为期 $10$ 天的每日时间步进模拟来解决该问题。\n\n**1. 常量的预计算：**\n气象条件不随时间变化，因此可以一次性计算几个参数。\n- 空气密度 $\\rho$ 根据理想气体定律计算：$\\rho = p / (R_d T_a)$。\n- 干湿表常数 $\\gamma$ 根据其定义计算：$\\gamma = \\frac{c_p p}{\\varepsilon \\lambda}$。\n- 摄氏气温为 $T_C = T_a - 273.15$。使用给定的 Tetens 公式找到饱和水汽压 $e_s(T_a)$，结果从 $\\mathrm{kPa}$ 转换为 $\\mathrm{Pa}$。\n- 饱和水汽压曲线的斜率 $\\Delta$ 通过对 Tetens 公式对温度求导并在 $T_a$ 处求值来计算：\n$$ \\frac{\\mathrm{d}e_s}{\\mathrm{d}T} = \\Delta = 1000 \\cdot \\left[ 0.6108 \\exp\\!\\left( \\frac{17.2694\\, T_C}{T_C + 237.3} \\right) \\right] \\cdot \\left[ \\frac{17.2694 \\cdot 237.3}{(T_C + 237.3)^2} \\right] $$\n因子 $1000$ 将结果从 $\\mathrm{kPa\\,K^{-1}}$ 转换为 $\\mathrm{Pa\\,K^{-1}}$。\n\n**2. 时间步进模拟：**\n对于四个测试案例中的每一个，一个循环运行 $t = 1, \\dots, 10$ 天。设 $\\theta_t$ 为第 $t$ 天开始时的体积含水量。\n\n- **气孔阻抗（$r_s$）：** 在每天开始时，根据当前的 $\\theta_t$ 使用提供的阈值模型计算 $r_s$：\n  $$\n  r_s(\\theta_t) =\n  \\begin{cases}\n  r_{s,\\min}, & \\theta_t \\ge \\theta^\\ast \\\\\n  r_{s,\\min} \\exp\\!\\left( \\alpha \\frac{\\theta^\\ast - \\theta_t}{\\theta^\\ast - \\theta_w} \\right), & \\theta_t < \\theta^\\ast\n  \\end{cases}\n  $$\n\n- **蒸散（$E$）：** 确定 $r_s$ 后，使用推导的方程计算质量通量 $E_t$（单位 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）。\n\n- **单位转换：** 每日蒸散深度 $E_t^\\mathrm{mm/day}$ 通过以下方式获得：\n  $$ E_t^\\mathrm{mm/day} = E_t \\ (\\mathrm{kg\\,m^{-2}\\,s^{-1}}) \\times 86400 \\ (\\mathrm{s\\,day^{-1}}) $$\n  此转换使用给定的恒等式，$1\\,\\mathrm{kg\\,m^{-2}}$ 的水对应 $1\\,\\mathrm{mm}$ 的深度。结果四舍五入到三位小数。\n\n- **机制诊断：** 计算当天的控制参数 $\\Omega_t$：\n  $$ \\Omega_t = \\frac{\\Delta}{\\Delta + \\gamma \\left(1 + \\frac{r_s(\\theta_t)}{r_a}\\right)} $$\n  如果转换日尚未确定且 $\\Omega_t < 0.5$，则将当前天数索引 $t$ 记录为转换日。\n\n- **土壤湿度更新：** 通过减去 ET 造成的水分损失来计算下一天开始时的土壤湿度 $\\theta_{t+1}$，确保其不低于凋萎点 $\\theta_w$：\n  $$ \\theta_{t+1} = \\max\\!\\left( \\theta_t - \\frac{E_t^\\mathrm{mm/day}}{1000 \\cdot Z_r}, \\theta_w \\right) $$\n\n此过程重复 $10$ 天。每个案例的最终输出是包含 $10$ 个每日 ET 值和整数转换日索引的列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes daily evapotranspiration (ET) over 10 days for four different\n    initial soil moisture conditions. The calculation is based on a resistance-based\n    energy balance model (Penman-Monteith type) derived from first principles.\n    \"\"\"\n\n    # --- Givens: Meteorological, Physical, and Soil Parameters ---\n    # Meteorological constants\n    R_n = 150.0      # Net radiation (W/m^2)\n    G = 0.0          # Ground heat flux (W/m^2)\n    T_a_k = 298.15   # Air temperature (K)\n    p_pa = 101325.0  # Atmospheric pressure (Pa)\n    D_pa = 2000.0    # Vapor pressure deficit (Pa)\n    r_a = 50.0       # Aerodynamic resistance (s/m)\n    \n    # Physical constants\n    c_p = 1005.0     # Specific heat of air (J/kg/K)\n    lambda_v = 2.45e6 # Latent heat of vaporization (J/kg)\n    R_d = 287.0      # Gas constant for dry air (J/kg/K)\n    epsilon = 0.622  # Ratio of molecular weights (water vapor/dry air)\n\n    # Soil and plant parameters\n    Z_r = 0.5        # Root-zone depth (m)\n    r_s_min = 50.0   # Minimum stomatal resistance (s/m)\n    theta_star = 0.20 # Threshold volumetric water content (m^3/m^3)\n    theta_w = 0.10   # Wilting point volumetric water content (m^3/m^3)\n    alpha = 6.0      # Steepness coefficient for stomatal resistance model\n\n    # Test cases\n    test_cases_theta0 = [0.35, 0.25, 0.20, 0.12]\n    \n    # --- Derived Parameters (time-invariant) ---\n    \n    # Air density (rho) from ideal gas law\n    rho = p_pa / (R_d * T_a_k)\n\n    # Saturation vapor pressure (e_s) and its slope (Delta)\n    T_a_c = T_a_k - 273.15\n    # Tetens relation for e_s (in Pa)\n    es_pa = 1000.0 * 0.6108 * np.exp((17.2694 * T_a_c) / (T_a_c + 237.3))\n    # Derivative of Tetens relation for Delta (in Pa/K)\n    delta = es_pa * (4097.99082 / (T_a_c + 237.3)**2)\n\n    # Psychrometric constant (gamma)\n    gamma = (c_p * p_pa) / (epsilon * lambda_v)\n\n    def run_simulation(theta_initial):\n        \"\"\"\n        Runs the 10-day simulation for a single initial soil moisture case.\n        \"\"\"\n        theta = theta_initial\n        daily_et_results = []\n        transition_day = -1\n        \n        for day in range(1, 11):\n            # 1. Calculate stomatal resistance (r_s) based on current soil moisture\n            if theta >= theta_star:\n                r_s = r_s_min\n            else:\n                exponent = alpha * (theta_star - theta) / (theta_star - theta_w)\n                r_s = r_s_min * np.exp(exponent)\n\n            # 2. Calculate ET mass flux (E) using the derived Penman-Monteith type equation\n            # E = (1/lambda) * (Delta * r_a * (R_n - G) + rho * c_p * D) / (Delta * r_a + gamma * (r_a + r_s))\n            numerator = delta * r_a * (R_n - G) + rho * c_p * D_pa\n            denominator = delta * r_a + gamma * (r_a + r_s)\n            lambda_E = numerator / denominator\n            E_mass_flux = lambda_E / lambda_v  # in kg/m^2/s\n            \n            # 3. Convert E to mm/day and round\n            E_mm_day = E_mass_flux * 86400  # 86400 seconds in a day\n            daily_et_results.append(round(E_mm_day, 3))\n\n            # 4. Diagnose regime transition\n            omega = delta / (delta + gamma * (1 + r_s / r_a))\n            if omega  0.5 and transition_day == -1:\n                transition_day = day\n\n            # 5. Update soil moisture for the next day\n            # Convert m3/m3 to mm of water by multiplying by depth in mm\n            # Water loss in m = E_mm_day / 1000\n            # Volumetric water content loss = (E_mm_day / 1000) / Z_r\n            theta_loss = E_mm_day / (1000.0 * Z_r)\n            theta = max(theta - theta_loss, theta_w)\n            \n        return daily_et_results + [transition_day]\n\n    # --- Main Execution ---\n    all_results = []\n    for theta0 in test_cases_theta0:\n        result_case = run_simulation(theta0)\n        all_results.append(result_case)\n\n    # Format the final output string as per problem specification\n    # e.g., [[6.123,5.432,...,-1],[...],...]\n    # No extra whitespace\n    sub_results_str = []\n    for sublist in all_results:\n        # Format ET values to 3 decimal places, keep index as integer\n        formatted_items = [f\"{item:.3f}\" for item in sublist[:-1]] + [str(sublist[-1])]\n        sub_results_str.append(f\"[{','.join(formatted_items)}]\")\n\n    final_output_string = f\"[{','.join(sub_results_str)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}