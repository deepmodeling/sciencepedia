{
    "hands_on_practices": [
        {
            "introduction": "To apply infiltration models effectively, we must first determine their key parameters from physical measurements. This exercise grounds the Green-Ampt model in reality by connecting the abstract moisture deficit parameter, $\\Delta\\theta$, to fundamental soil properties. By starting with raw data from a soil core sample, you will derive $\\Delta\\theta$ from its physical basis in porosity and initial water content, building a crucial link between field observation and model parameterization .",
            "id": "3885489",
            "problem": "A sharp wetting-front approximation such as the Green-Ampt infiltration model conceptualizes rainfall infiltration into a homogeneous soil as a two-region problem: an initially unsaturated region with volumetric water content $\\theta_{i}$ ahead of the front, and a fully wetted region behind the front. Under the assumption that air entrapment is negligible, the wetted region is treated as completely saturated. Using a control-volume argument and mass conservation across the wetting front, the change in volumetric water content across the front, $\\Delta \\theta$, is defined by the difference between the wetted-region water content and the initial water content.\n\nConsider a field core sample taken from a uniform topsoil where the wetting front will remain within this layer during an infiltration event. The sample was collected using a stainless-steel ring of known internal volume. The following measurements were obtained:\n- Core volume $V_{\\text{core}} = 100.0\\,\\text{cm}^{3}$,\n- Wet mass $m_{\\text{wet}} = 164.2\\,\\text{g}$,\n- Oven-dry mass $m_{\\text{dry}} = 149.3\\,\\text{g}$,\n- Water density $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$,\n- Soil particle density (from pycnometer) $\\rho_{s} = 2.650\\,\\text{g}\\,\\text{cm}^{-3}$.\n\nStarting from the fundamental definitions of volumetric water content and porosity, and the assumption of complete saturation behind the wetting front, derive an analytic expression for $\\Delta \\theta$ in terms of measurable quantities. Then, evaluate $\\Delta \\theta$ using the given data. Explicitly state any idealizations made. Round your final $\\Delta \\theta$ to four significant figures. Express the final result as a decimal fraction (dimensionless). Do not include units in your final answer.\n\nTime Domain Reflectometry (TDR) and gravimetric methods are commonly used to estimate $\\theta_{i}$; here, use the provided gravimetric sample measurements to compute the initial volumetric water content $\\theta_{i}$.",
            "solution": "The Green-Ampt infiltration conceptualization relies on a sharp wetting front separating an initially unsaturated zone from a saturated (or nearly saturated) zone. The fundamental base is mass conservation applied to a representative elementary volume and constitutive definitions of soil properties:\n- Volumetric water content $\\theta$ is defined as the volume of water per unit bulk volume of soil,\n- Porosity $\\phi$ is the fraction of bulk volume occupied by pores,\n- Under complete saturation and negligible air entrapment, the saturated volumetric water content equals the porosity.\n\nWe proceed in two steps: derive $\\Delta \\theta$ from definitions and assumptions, and then evaluate $\\theta_{i}$ and $\\phi$ from the field measurements.\n\n1. Definitions and control-volume argument.\nConsider a control volume $V$ moving with the wetting front. Ahead of the front, the volumetric water content is $\\theta_{i}$. Behind the front, under complete saturation, the volumetric water content is $\\theta_{s}$. The jump in water content across the front is\n$$\n\\Delta \\theta = \\theta_{s} - \\theta_{i}.\n$$\nAssuming negligible air entrapment and complete saturation behind the front,\n$$\n\\theta_{s} \\approx \\phi,\n$$\nwhere $\\phi$ is the porosity. Therefore, the target analytic expression is\n$$\n\\Delta \\theta = \\phi - \\theta_{i}.\n$$\nWe now express $\\phi$ and $\\theta_{i}$ in terms of measurable quantities.\n\n2. Porosity from bulk and particle densities.\nPorosity $\\phi$ follows from the volumetric averaging of solid and pore volumes:\n$$\n\\phi = 1 - \\frac{\\rho_{b}}{\\rho_{s}},\n$$\nwhere $\\rho_{b}$ is the bulk density (dry mass per unit bulk volume) and $\\rho_{s}$ is the particle density (mass of solids per unit solids volume). The bulk density is computed from the oven-dry mass and core volume:\n$$\n\\rho_{b} = \\frac{m_{\\text{dry}}}{V_{\\text{core}}}.\n$$\nUsing the provided data,\n$$\n\\rho_{b} = \\frac{149.3\\,\\text{g}}{100.0\\,\\text{cm}^{3}} = 1.493\\,\\text{g}\\,\\text{cm}^{-3}.\n$$\nThus,\n$$\n\\phi = 1 - \\frac{1.493}{2.650} = 1 - \\frac{1493}{2650} = 1 - 0.563396226415094 \\approx 0.436603773584906.\n$$\n\n3. Initial volumetric water content from gravimetric sampling.\nVolumetric water content $\\theta_{i}$ is the ratio of the volume of water to the bulk volume of the sample:\n$$\n\\theta_{i} = \\frac{V_{w}}{V_{\\text{core}}} = \\frac{m_{w}/\\rho_{w}}{V_{\\text{core}}},\n$$\nwhere $m_{w} = m_{\\text{wet}} - m_{\\text{dry}}$ is the mass of water in the sample and $\\rho_{w}$ is the density of water. Compute $m_{w}$:\n$$\nm_{w} = 164.2 - 149.3 = 14.9\\,\\text{g}.\n$$\nAssuming $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$,\n$$\nV_{w} = \\frac{14.9\\,\\text{g}}{1.000\\,\\text{g}\\,\\text{cm}^{-3}} = 14.9\\,\\text{cm}^{3}.\n$$\nTherefore,\n$$\n\\theta_{i} = \\frac{14.9}{100.0} = 0.149.\n$$\n\n4. Compute $\\Delta \\theta$.\nCombine the results:\n$$\n\\Delta \\theta = \\phi - \\theta_{i} \\approx 0.436603773584906 - 0.149 = 0.287603773584906.\n$$\n\nIdealizations explicitly stated:\n- The wetting front is sharp, separating regions of uniform water content.\n- Air entrapment is neglected; the wetted region is treated as completely saturated, giving $\\theta_{s} \\approx \\phi$.\n- Water density is taken as $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$ at field conditions.\n- The soil layer is homogeneous within the depth reached by the wetting front.\n\nRound to four significant figures, as requested:\n$$\n\\Delta \\theta \\approx 0.2876.\n$$\nThis is a dimensionless decimal fraction.",
            "answer": "$$\\boxed{0.2876}$$"
        },
        {
            "introduction": "Beyond simple calculation, a deeper understanding of a model comes from analyzing its sensitivity to changes in its parameters. This practice explores how the predicted time to ponding, $t_p$, responds to variations in the saturated hydraulic conductivity, $K_s$. You will perform a sensitivity analysis by deriving the partial derivative $\\partial t_{p} / \\partial K_{s}$, which provides powerful insights into the system's behavior, especially in the critical regime where rainfall intensity nearly matches the soil's infiltrative capacity .",
            "id": "3885470",
            "problem": "A homogeneous, deep soil profile is subjected to a spatially uniform, constant-intensity rainfall of rate $i$ (length per time). The soil is initially at uniform volumetric water content $\\theta_{i}$, and infiltration is governed by the Green–Ampt (GA) infiltration model. In the GA model, the infiltration capacity at time $t$ depends on the cumulative infiltration $F(t)$ through a moving wetting-front approximation in which a sharp wetting front separates saturated soil above from initially dry soil below. Let the saturated hydraulic conductivity be $K_{s}$ (length per time), the wetting-front capillary suction head be $\\psi_{f}$ (length), and the water content jump across the front be $\\Delta \\theta = \\theta_{s} - \\theta_{i}$ (dimensionless), where $\\theta_{s}$ is the saturated water content. Ponding is the onset of surface water accumulation when the rainfall rate exceeds the infiltration capacity; prior to ponding, the infiltration rate equals the rainfall rate.\n\nStarting from the GA infiltration capacity relation and the pre-ponding water balance, derive an analytical expression for the ponding time $t_{p}$ as a function of $K_{s}$, $\\psi_{f}$, $\\Delta \\theta$, and $i$. Then, compute the sensitivity of ponding time with respect to saturated hydraulic conductivity by evaluating the partial derivative $\\partial t_{p} / \\partial K_{s}$. Finally, interpret the sign and magnitude of $\\partial t_{p} / \\partial K_{s}$ for the regime in which rainfall intensity slightly exceeds saturated hydraulic conductivity, that is, for $i = K_{s} + \\varepsilon$ with $\\varepsilon > 0$ and $\\varepsilon \\ll K_{s}$, commenting on how the sensitivity scales with $\\varepsilon$.\n\nProvide your final answer as a single closed-form analytical expression for $\\partial t_{p}/\\partial K_{s}$. Do not substitute numerical values, and do not include units in the final boxed expression. In your solution, state the dimensional form of $\\partial t_{p}/\\partial K_{s}$ using base dimensions.",
            "solution": "The derivation proceeds in three parts as requested: derivation of the ponding time $t_{p}$, calculation of its sensitivity $\\partial t_{p} / \\partial K_{s}$, and interpretation of the result in a specific physical regime.\n\nFirst, we derive the expression for the ponding time, $t_{p}$. The Green–Ampt model for infiltration capacity, $f_{p}$, as a function of cumulative infiltration, $F(t)$, is given by:\n$$f_{p}(t) = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{F(t)} \\right)$$\nwhere $K_{s}$ is the saturated hydraulic conductivity, $\\psi_{f}$ is the wetting-front capillary suction head, and $\\Delta\\theta$ is the change in volumetric water content across the wetting front.\n\nPrior to ponding, for time $t  t_{p}$, the soil can absorb all incoming rainfall. The infiltration rate, $f(t)$, is therefore equal to the constant rainfall intensity, $i$.\n$$f(t) = i, \\quad \\text{for } t  t_{p}$$\nThe cumulative infiltration at any time $t$ before ponding is the integral of the infiltration rate:\n$$F(t) = \\int_{0}^{t} f(\\tau) d\\tau = \\int_{0}^{t} i d\\tau = it$$\nPonding occurs at time $t_{p}$ when the rainfall intensity $i$ becomes equal to the soil's infiltration capacity $f_{p}(t_{p})$. This condition is only possible if $i > K_{s}$, since $f_{p}$ decreases from infinity and asymptotically approaches $K_{s}$ as $F(t)$ increases. At the instant of ponding, we have:\n$$i = f_{p}(t_{p})$$\nThe cumulative infiltration at the time of ponding, $F(t_{p})$, is given by:\n$$F(t_{p}) = i t_{p}$$\nSubstituting this expression for $F(t_{p})$ into the Green–Ampt capacity equation at the time of ponding yields:\n$$i = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{F(t_{p})} \\right) = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}} \\right)$$\nWe now solve this equation for the ponding time $t_{p}$:\n$$\\frac{i}{K_{s}} = 1 + \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$\\frac{i}{K_{s}} - 1 = \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$\\frac{i - K_{s}}{K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$t_{p} = \\frac{K_{s} \\psi_{f} \\Delta\\theta}{i(i - K_{s})}$$\nThis is the analytical expression for the ponding time.\n\nSecond, we compute the sensitivity of the ponding time with respect to the saturated hydraulic conductivity by evaluating the partial derivative $\\partial t_{p} / \\partial K_{s}$. We treat $i$, $\\psi_{f}$, and $\\Delta\\theta$ as constants. For clarity, we group the constant terms:\n$$t_{p}(K_{s}) = \\left( \\frac{\\psi_{f} \\Delta\\theta}{i} \\right) \\left( \\frac{K_{s}}{i - K_{s}} \\right)$$\nUsing the quotient rule for differentiation, $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^{2}}$, with $u=K_{s}$ and $v=i-K_{s}$:\n$$\\frac{\\partial}{\\partial K_{s}} \\left( \\frac{K_{s}}{i - K_{s}} \\right) = \\frac{\\left(\\frac{\\partial K_{s}}{\\partial K_{s}}\\right)(i - K_{s}) - K_{s}\\left(\\frac{\\partial(i-K_{s})}{\\partial K_{s}}\\right)}{(i - K_{s})^{2}}$$\n$$\\frac{\\partial}{\\partial K_{s}} \\left( \\frac{K_{s}}{i - K_{s}} \\right) = \\frac{(1)(i - K_{s}) - K_{s}(-1)}{(i - K_{s})^{2}} = \\frac{i - K_{s} + K_{s}}{(i - K_{s})^{2}} = \\frac{i}{(i - K_{s})^{2}}$$\nSubstituting this back into the expression for the sensitivity gives:\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\left( \\frac{\\psi_{f} \\Delta\\theta}{i} \\right) \\left( \\frac{i}{(i - K_{s})^{2}} \\right)$$\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{(i - K_{s})^{2}}$$\nThis is the final analytical expression for the sensitivity.\n\nThe dimensional form of $\\partial t_{p} / \\partial K_{s}$ can be determined from the base dimensions of time ($T$) and length ($L$).\n$$[\\frac{\\partial t_{p}}{\\partial K_{s}}] = \\frac{[t_{p}]}{[K_{s}]} = \\frac{T}{L T^{-1}} = L^{-1} T^{2}$$\n\nThird, we interpret the sign and magnitude of this sensitivity for the specific regime where $i = K_{s} + \\varepsilon$ with $\\varepsilon > 0$ and $\\varepsilon \\ll K_{s}$.\nThe sign of $\\partial t_{p} / \\partial K_{s}$ is determined by its components. The suction head $\\psi_{f}$ is a positive quantity ($L$), the water content difference $\\Delta\\theta = \\theta_s - \\theta_i$ is positive for an initially unsaturated soil, and the denominator $(i - K_{s})^{2}$ is a squared term and therefore positive (for $i \\neq K_{s}$). Thus, $\\partial t_{p} / \\partial K_{s}$ is strictly positive. This implies that increasing the saturated hydraulic conductivity increases the time to ponding, which is physically intuitive: soil that can transmit water more effectively will take longer to become overwhelmed by a given rainfall rate.\n\nTo analyze the magnitude, we substitute $i = K_{s} + \\varepsilon$ into the sensitivity expression:\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{((K_{s} + \\varepsilon) - K_{s})^{2}} = \\frac{\\psi_{f} \\Delta\\theta}{\\varepsilon^{2}}$$\nThis result shows that the sensitivity of ponding time to changes in saturated hydraulic conductivity scales with $\\varepsilon^{-2}$. As the rainfall intensity $i$ approaches the saturated hydraulic conductivity $K_{s}$ (i.e., as $\\varepsilon \\to 0^{+}$), the sensitivity becomes extremely large. This indicates a critical behavior near the threshold $i=K_{s}$. In this regime, a very small change in $K_{s}$ can cause a disproportionately large change in the ponding time $t_{p}$. For instance, a small increase in $K_{s}$ dramatically reduces the \"excess\" rainfall rate $\\varepsilon = i - K_{s}$, which in turn substantially delays the onset of ponding.",
            "answer": "$$\\boxed{\\frac{\\psi_{f} \\Delta\\theta}{(i - K_{s})^{2}}}$$"
        },
        {
            "introduction": "Many real-world physical models, including the Green-Ampt equation for post-ponding conditions, result in implicit equations that require numerical methods to solve. This final practice bridges theory and computation by tasking you with implementing a Newton-Raphson algorithm to find the cumulative infiltration $F$ over time. This exercise moves beyond simple formula application, requiring you to build a robust solver, consider numerical stability, and appreciate the mathematical foundations of the computational tools that are central to modern environmental modeling .",
            "id": "3885467",
            "problem": "Consider infiltration into a homogeneous soil column under the Green-Ampt model with a sharp wetting front. After surface ponding occurs at time $t_p$ with cumulative infiltration $F_p$, the cumulative infiltration $F$ at a later time $t$ satisfies an implicit relationship of the form\n$$\ng(F) = (F - F_p) - \\psi_f \\Delta \\theta \\,\\ln\\left(\\frac{F + \\psi_f \\Delta \\theta}{F_p + \\psi_f \\Delta \\theta}\\right) - K_s (t - t_p) = 0,\n$$\nwhere $F$ and $F_p$ are cumulative infiltrations expressed in meters, $\\psi_f$ is the wetting front capillary suction head expressed in meters, $\\Delta \\theta$ is the moisture deficit defined as $\\Delta \\theta = \\theta_s - \\theta_i$ (dimensionless), $K_s$ is the saturated hydraulic conductivity expressed in meters per second, and $t - t_p$ is the time since ponding expressed in seconds. Starting from the classical concepts of continuity and Darcy’s law for one-dimensional vertical flow in porous media, and the Green-Ampt sharp-front idealization, the above implicit relationship follows from balancing the integrated flux and the wetting front potential contribution; however, you are not to use any shortcut formulas beyond the given implicit form.\n\nYour task is to implement a robust Newton–Raphson algorithm to solve $g(F) = 0$ for $F$ under physically admissible conditions ($F \\ge 0$, $\\psi_f > 0$, $\\Delta \\theta > 0$, $K_s > 0$, $t \\ge t_p$). Derive the required update by explicitly obtaining the derivative $g'(F)$ and using it to form the Newton step. Establish sound convergence criteria based on residual and step-size tolerances, and include safeguards to maintain physical feasibility (for example, the logarithm domain constraint $F + \\psi_f \\Delta \\theta > 0$ and nonnegativity of $F$). When $t = t_p$, the physically correct solution is $F = F_p$; treat this as an exact boundary condition.\n\nImplement the algorithm in code and apply it to the following test suite. All parameter values are scientifically plausible for shallow infiltration under ponded conditions. Express the final cumulative infiltration $F$ for each case in meters, rounded to six decimal places.\n\n- Case $1$: $F_p = 0.01$, $\\psi_f = 0.25$, $\\Delta \\theta = 0.35$, $K_s = 1\\times 10^{-6}$, $t - t_p = 3600$.\n- Case $2$ (boundary): $F_p = 0.015$, $\\psi_f = 0.20$, $\\Delta \\theta = 0.30$, $K_s = 1\\times 10^{-6}$, $t - t_p = 0$.\n- Case $3$: $F_p = 0.005$, $\\psi_f = 0.40$, $\\Delta \\theta = 0.50$, $K_s = 5\\times 10^{-7}$, $t - t_p = 7200$.\n- Case $4$ (near-saturated initial soil): $F_p = 0.0$, $\\psi_f = 0.10$, $\\Delta \\theta = 0.05$, $K_s = 2\\times 10^{-6}$, $t - t_p = 1000$.\n- Case $5$ (long time since ponding): $F_p = 0.01$, $\\psi_f = 0.20$, $\\Delta \\theta = 0.25$, $K_s = 1\\times 10^{-5}$, $t - t_p = 86400$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.123456,0.234567,0.345678,0.456789,0.567890]$), where each entry is the computed $F$ for the corresponding case, in meters and rounded to six decimal places.\n\nIn addition to coding the solver, derive the Newton–Raphson update from first principles and discuss mathematically justified convergence criteria (residual tolerance, step-size tolerance, monotonicity and uniqueness due to the sign of $g'(F)$), and the need for safeguards such as bracketing or step damping to ensure the iteration stays within the physically admissible domain. Do not introduce any extraneous formulas not implied by the given implicit relationship.",
            "solution": "The Newton-Raphson method provides an iterative scheme to find the root of a function $g(F)$. The update rule is:\n$$F_{k+1} = F_k - \\frac{g(F_k)}{g'(F_k)}$$\nwhere $F_k$ is the estimate of the root at iteration $k$, and $g'(F)$ is the first derivative of $g(F)$ with respect to $F$.\n\n**2.1. Derivative of $g(F)$**\nTo implement the algorithm, we must first compute $g'(F)$. Let the constant term $C = \\psi_f \\Delta \\theta$. The function $g(F)$ can be written as:\n$$g(F) = F - F_p - C \\left[ \\ln(F + C) - \\ln(F_p + C) \\right] - K_s (t - t_p)$$\nDifferentiating with respect to $F$, we treat $F_p$, $C$, $K_s$, $t$, and $t_p$ as constants:\n$$g'(F) = \\frac{d}{dF} \\left( F - F_p - C \\ln(F + C) + C \\ln(F_p + C) - K_s (t - t_p) \\right)$$\n$$g'(F) = 1 - 0 - C \\cdot \\frac{1}{F+C} + 0 - 0 = 1 - \\frac{C}{F+C}$$\n$$g'(F) = \\frac{(F + C) - C}{F + C} = \\frac{F}{F + C}$$\nSubstituting back $C = \\psi_f \\Delta \\theta$, the derivative is:\n$$g'(F) = \\frac{F}{F + \\psi_f \\Delta \\theta}$$\n\n**2.2. Analysis of $g(F)$ and its Derivatives**\n- **Monotonicity**: The physical constraints are $\\psi_f > 0$ and $\\Delta\\theta > 0$, so $\\psi_f \\Delta\\theta > 0$. For infiltration to occur, we must have $F \\ge F_p \\ge 0$. As long as $F > 0$, the numerator and denominator of $g'(F)$ are both positive, which means $g'(F) > 0$. A strictly positive first derivative implies that $g(F)$ is a monotonically increasing function of $F$ for $F > 0$. This property is crucial as it guarantees that if a root exists, it is unique.\n- **Convexity**: We examine the second derivative, $g''(F)$:\n$$g''(F) = \\frac{d}{dF}\\left(\\frac{F}{F + C}\\right) = \\frac{1 \\cdot (F+C) - F \\cdot 1}{(F+C)^2} = \\frac{C}{(F+C)^2} = \\frac{\\psi_f \\Delta \\theta}{(F + \\psi_f \\Delta \\theta)^2}$$\nSince $\\psi_f \\Delta \\theta > 0$ and the denominator is squared, $g''(F) > 0$ for all valid $F$. This means the function $g(F)$ is strictly convex (concave up). This property ensures that the tangent line at any point lies below the function curve. Consequently, if the Newton-Raphson iteration starts with an initial guess $F_0$ that is greater than the true root $F^*$ (i.e., $g(F_0) > 0$), the sequence of iterates $F_k$ will converge monotonically downwards to $F^*$.\n\n**2.3. Initial Guess ($F_0$)**\nA good initial guess improves convergence speed and stability.\n- **For $F_p > 0$**: The initial infiltration rate at ponding is $f(t_p) = K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{F_p}\\right)$. A linear extrapolation (first-order Euler) gives a reasonable initial guess for $F$ at time $t$:\n  $$F_0 = F_p + f(t_p) \\cdot (t-t_p) = F_p + K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{F_p}\\right) (t - t_p)$$\n  This guess is typically an overestimate (since the infiltration rate decreases over time), placing $F_0$ to the right of the root, which is ideal for a convex function.\n- **For $F_p = 0$**: The above formula is singular. For infiltration into an initially ponded, dry soil, the early-time behavior is dominated by sorptivity. The cumulative infiltration is approximated by $F \\approx \\sqrt{2 K_s \\psi_f \\Delta \\theta (t - t_p)}$. This provides an excellent initial guess:\n  $$F_0 = \\sqrt{2 (\\psi_f \\Delta \\theta) K_s (t - t_p)}$$\n\n**2.4. Convergence and Safeguards**\n- **Boundary Condition**: If $t - t_p = 0$, then $g(F) = 0$ is satisfied exactly by $F = F_p$. This case is handled directly without iteration.\n- **Convergence Criteria**: The iteration can be terminated when either of two conditions is met:\n  1.  **Residual Tolerance**: The function value is sufficiently close to zero: $|g(F_k)|  \\epsilon_{res}$.\n  2.  **Step-Size Tolerance**: The change between successive iterates is negligible: $|F_{k+1} - F_k|  \\epsilon_{step}$.\n  A maximum number of iterations should also be set to prevent infinite loops.\n- **Safeguards**: The physical domain requires $F > F_p \\ge 0$. The Newton step can, in principle, produce a non-physical estimate (e.g., $F_{k+1}  F_p$). Although unlikely with a good initial guess for a convex function, a robust implementation should include safeguards. If a proposed step $F_{k+1}$ is invalid, it can be repeatedly halved (a technique known as step damping or backtracking) until the new estimate $F_{k+1}$ lies within the valid physical domain.\n\nThis detailed analysis provides the foundation for a robust numerical solver.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the Green-Ampt infiltration problem for a suite of test cases.\n    \"\"\"\n\n    def solve_green_ampt_newton(Fp, psi_f, delta_theta, Ks, dt):\n        \"\"\"\n        Solves for cumulative infiltration F using the Newton-Raphson method.\n\n        Args:\n            Fp (float): Cumulative infiltration at ponding (m).\n            psi_f (float): Wetting front capillary suction head (m).\n            delta_theta (float): Moisture deficit (-).\n            Ks (float): Saturated hydraulic conductivity (m/s).\n            dt (float): Time since ponding, t - tp (s).\n\n        Returns:\n            float: Cumulative infiltration F (m).\n        \"\"\"\n        # Handle the boundary condition: at the moment of ponding, F = Fp.\n        if dt == 0:\n            return Fp\n\n        # Define constants and convergence parameters\n        C = psi_f * delta_theta\n        Kdt = Ks * dt\n        max_iter = 100\n        tol_res = 1e-12  # Residual tolerance for g(F)\n        tol_step = 1e-12 # Step-size tolerance for F\n\n        # --- Set up a physically-based initial guess (F_k) ---\n        if Fp  0:\n            # For Fp  0, use a first-order Euler extrapolation.\n            # This estimate is typically an upper bound, ideal for Newton's method on a convex function.\n            f_p = Ks * (1 + C / Fp)\n            F_k = Fp + f_p * dt\n        else: # Fp = 0\n            # For Fp = 0, the Euler formula is singular. Use the short-time sorptivity approximation.\n            # This expression is derived from the early-time behavior of the Green-Ampt model.\n            arg = 2 * C * Kdt\n            if arg  0: # Should not happen with valid physical parameters\n                arg = 0\n            F_k = np.sqrt(arg)\n\n        # To avoid division by zero if initial guess is exactly Fp=0\n        if F_k = Fp:\n            F_k = Fp + tol_step \n            \n        # --- Newton-Raphson Iteration ---\n        for _ in range(max_iter):\n            # Define g(F_k) and its derivative g'(F_k)\n            # g(F) = (F - Fp) - C * ln((F + C) / (Fp + C)) - Kdt = 0\n            # g'(F) = F / (F + C)\n            \n            # Check for domain validity of the logarithm\n            log_arg_num = F_k + C\n            log_arg_den = Fp + C\n            if log_arg_num = 0 or log_arg_den = 0:\n                # This should not be reached with proper safeguards, but is here for robustness\n                break\n\n            g_F = (F_k - Fp) - C * np.log(log_arg_num / log_arg_den) - Kdt\n\n            # Check for convergence based on residual\n            if abs(g_F)  tol_res:\n                break\n\n            gp_F = F_k / (F_k + C)\n\n            # Avoid division by zero if F_k is near 0 (can happen if Fp=0)\n            if abs(gp_F)  1e-12:\n                # Derivative is zero, method cannot proceed\n                break \n\n            # Calculate Newton step\n            delta_F = g_F / gp_F\n            F_next = F_k - delta_F\n\n            # --- Safeguard: Step Halving (Backtracking) ---\n            # Ensure the next iterate remains in the physical domain (F  Fp).\n            # The lower bound is Fp (or 0 if Fp=0).\n            lower_bound = Fp if Fp  0 else 0\n            \n            # If the step overshoots into the non-physical domain, halve it.\n            # Given the function's convexity and good initial guess, this is mainly a safety measure.\n            while F_next = lower_bound:\n                delta_F /= 2.0\n                F_next = F_k - delta_F\n\n            # Check for convergence based on step size\n            if abs(F_next - F_k)  tol_step:\n                F_k = F_next\n                break\n            \n            F_k = F_next\n\n        return F_k\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (Fp, psi_f, delta_theta, Ks, t - tp)\n        (0.01, 0.25, 0.35, 1e-6, 3600),\n        (0.015, 0.20, 0.30, 1e-6, 0),\n        (0.005, 0.40, 0.50, 5e-7, 7200),\n        (0.0, 0.10, 0.05, 2e-6, 1000),\n        (0.01, 0.20, 0.25, 1e-5, 86400),\n    ]\n\n    results = []\n    for params in test_cases:\n        Fp, psi_f, d_theta, Ks, dt = params\n        F_result = solve_green_ampt_newton(Fp, psi_f, d_theta, Ks, dt)\n        results.append(F_result)\n\n    # Round results to six decimal places\n    rounded_results = [round(r, 6) for r in results]\n\n    # Format the final output string exactly as specified\n    print(f\"[{','.join(map(str, rounded_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}