{
    "hands_on_practices": [
        {
            "introduction": "将可测量的流动特性（如流量 $Q$ 和过水断面面积 $A$）与弗劳德数（$Fr$）这一基本概念联系起来至关重要。弗劳德数不仅是一个流态分类工具，更是决定了信息（如洪水波）在河道中传播方式的关键因素。本练习旨在帮助学生巩固对缓流（亚临界流）的物理理解，并阐明其在完整动力波模型和运动波模型中对信息传播方向的不同影响 。",
            "id": "3902848",
            "problem": "一个横截面为矩形的直棱柱形明渠输送着非恒定流，该流动由一维浅水方程（即圣维南方程）建模。该渠道宽度 $b = 30\\,\\mathrm{m}$，底坡 $S_{0} = 0.0015$。河床糙率由曼宁系数 $n = 0.035$ 表征。在某一特定横截面，一次测量活动得出横截面积 $A = 120\\,\\mathrm{m^{2}}$ 和流量 $Q = 336\\,\\mathrm{m^{3}\\,s^{-1}}$。取重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n\n从浅水自由表面流的质量和动量平衡以及作为圣维南方程基础的静水压强假设出发，确定所测状态下的平均流速 $U$ 和弗劳德数 $\\mathrm{Fr}$。然后，利用圣维南方程的特征结构和从流量-面积关系曲线推导出的运动波近似，推断您计算出的 $\\mathrm{Fr}$ 对长波波速以及在使用 (i) 运动波和 (ii) 完整动力波公式的演进模型中信息传播方向的影响。\n\n报告 $U$ 的单位为 $\\mathrm{m\\,s^{-1}}$，$\\mathrm{Fr}$ 为无量纲数。两者均四舍五入至四位有效数字。",
            "solution": "问题验证如下。\n\n### 步骤 1：提取已知条件\n-   渠道类型：横截面为矩形的直棱柱形明渠。\n-   渠道宽度：$b = 30\\,\\mathrm{m}$。\n-   底坡：$S_{0} = 0.0015$。\n-   曼宁系数：$n = 0.035$。\n-   横截面积：$A = 120\\,\\mathrm{m^{2}}$。\n-   流量：$Q = 336\\,\\mathrm{m^{3}\\,s^{-1}}$。\n-   重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当，且客观。它基于公认的一维明渠流圣维南方程，这是环境和地球系统建模的基石。所有术语都是流体动力学和水文学中的标准术语。所提供的数据是自洽且一致的，可以直接计算所要求的量并进行有意义的物理解释。该问题不违反任何基本原理，不基于错误的前提，也没有任何歧义。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n平均流速 $U$ 定义为通过横截面的总流量 $Q$ 除以横截面积 $A$。\n$$\nU = \\frac{Q}{A}\n$$\n代入给定值：\n$$\nU = \\frac{336\\,\\mathrm{m^{3}\\,s^{-1}}}{120\\,\\mathrm{m^{2}}} = 2.8\\,\\mathrm{m\\,s^{-1}}\n$$\n\n对于宽度为 $b$ 的矩形渠道，横截面积 $A$ 与水深 $y$ 的关系为 $A = by$。因此，我们可以计算出水深：\n$$\ny = \\frac{A}{b} = \\frac{120\\,\\mathrm{m^{2}}}{30\\,\\mathrm{m}} = 4.0\\,\\mathrm{m}\n$$\n\n弗劳德数 $\\mathrm{Fr}$ 是一个表征流态的无量纲参数。对于矩形渠道，它是平均流速 $U$ 与小重力波波速 $\\sqrt{gy}$ 的比值。\n$$\n\\mathrm{Fr} = \\frac{U}{\\sqrt{gy}}\n$$\n代入计算出的 $U$ 和 $y$ 的值以及给定的 $g$ 值：\n$$\n\\mathrm{Fr} = \\frac{2.8\\,\\mathrm{m\\,s^{-1}}}{\\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}})(4.0\\,\\mathrm{m})}} = \\frac{2.8}{\\sqrt{39.24}} \\approx 0.44699\n$$\n四舍五入至四位有效数字，我们得到 $U = 2.800\\,\\mathrm{m\\,s^{-1}}$ 和 $\\mathrm{Fr} = 0.4470$。\n\n由于 $\\mathrm{Fr}  1$，水流被分类为缓流。我们现在分析其对演进模型中信息传播的影响。\n\n用于明渠非恒定流的一维圣维南方程是一个由两个偏微分方程组成的系统，分别表示质量守恒和动量守恒：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{\\partial Q}{\\partial x} = 0 \\quad \\text{(连续性方程)}\n$$\n$$\n\\frac{\\partial Q}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\beta \\frac{Q^2}{A}\\right) + gA\\frac{\\partial y}{\\partial x} = gA(S_0 - S_f) \\quad \\text{(动量方程)}\n$$\n其中 $x$ 是纵向坐标，$t$ 是时间，$S_f$ 是摩阻坡度，$\\beta$ 是动量修正系数（假定为 $1$）。\n\n**i) 对完整动力波公式的影响**\n\n圣维南方程构成一个双曲型系统。在此类系统中，信息沿着 $x$-$t$ 平面上的特征线传播。传播速度（或波速）由系统雅可比矩阵的特征值给出。对于圣维南方程，这些特征波速为：\n$$\nc = U \\pm \\sqrt{g\\frac{A}{T}}\n$$\n其中 $T$ 是渠道的顶宽。对于矩形渠道，$T = b$，因此 $\\sqrt{gA/T}$ 项简化为 $\\sqrt{gy}$，即浅水重力波的波速。因此，两个特征速度为：\n$$\nc = U \\pm \\sqrt{gy}\n$$\n弗劳德数为 $\\mathrm{Fr} = U / \\sqrt{gy}$。\n我们的计算得出 $\\mathrm{Fr} \\approx 0.4470  1$，对应于缓流。在这种流态下，平均流速 $U$ 小于重力波波速 $\\sqrt{gy}$。\n两个特征速度为：\n1.  $c_1 = U + \\sqrt{gy}  0$：这代表一个向下游传播的波。\n2.  $c_2 = U - \\sqrt{gy}  0$：由于 $U  \\sqrt{gy}$，这代表一个向上游传播的波。\n\n因此，对于完整动力波模型，水流的缓流性质 ($\\mathrm{Fr}  1$) 意味着信息（例如，水位变化的影响）会同时向**上游和下游**传播。这对于模拟下游控制（如水坝、堰或潮汐影响）引起的回水效应等现象至关重要，因为在这些现象中，下游条件会影响上游的水流剖面。\n\n**ii) 对运动波公式的影响**\n\n运动波模型是圣维南方程的简化形式，其中动量方程通过忽略局部加速度、对流加速度和压力项而简化。这使得摩阻坡度与底坡之间达到平衡，$S_f = S_0$。这一假设意味着流量与水流面积（或深度）之间存在唯一的、单值的关系 $Q=Q(A)$，称为流量关系曲线。例如，使用曼宁方程：\n$$\nQ = \\frac{1}{n} A R_h^{2/3} S_0^{1/2}\n$$\n其中 $R_h$ 是水力半径。\n\n运动波模型由连续性方程与该流量关系曲线组合而成：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{\\partial Q(A)}{\\partial x} = 0\n$$\n使用链式法则，$\\frac{\\partial Q}{\\partial x} = \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x}$，我们得到：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x} = 0\n$$\n这是一个描述 $A$ 演变的一阶波动方程。它只有一个特征波速，即运动波波速 $c_k$：\n$$\nc_k = \\frac{dQ}{dA}\n$$\n由于对于下游流动，$Q$ 和 $A$ 都是正值，它们的关系是单调的，因此导数 $c_k = dQ/dA$ 始终为正。这意味着运动波**只能向下游方向传播**。\n\n我们计算出的弗劳德数小于1在此处具有深远的影响。虽然真实的物理系统（由动力波模型描述）支持双向信息流，但运动波近似本质上禁止任何上游传播。无论水流是缓流 ($\\mathrm{Fr}  1$) 还是急流 ($\\mathrm{Fr} > 1$)，运动波模型总是将扰动向下游传递。这使得在需要捕捉任何下游控制影响的情况下，运动波模型不适用于当前情况，因为它无法表示向上游传播的特征 $c_2 = U - \\sqrt{gy}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.800  0.4470 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在上一练习概念的基础上，本次实践将从定性理解转向定量计算。我们将深入探讨在完整的圣维南方程（动力波）及其简化形式（运动波）中，波速（celerity）的数学根源 。通过该练习，您将能从根本上理解为什么动力波模型能够模拟回水等上游影响，而运动波模型则只能处理向下游的传播。",
            "id": "3902820",
            "problem": "一个棱柱形宽矩形明渠输送稳定的均匀流，其平均流速为 $u_{0}$，水深为 $h_{0}$。假设静水压力分布，侧向入流可忽略不计，且基流满足河床坡度与摩擦坡降的平衡，因此允许均匀流存在。在一维圣维南方程（也称为浅水方程（SWE））的框架内，考虑围绕此基态的小扰动。\n\n从控制方程出发，对均匀基态进行适当的线性化，推导顺流和逆流传播的动力波波速，并在给定的基流条件下进行评估。另外，从连续性方程出发，使用由曼宁阻力公式给出的均匀流闭合，将运动波波速推导为流量-面积关系曲线的斜率，并在相同的基态下进行评估。最后，通过计算运动波波速与顺流传播的动力波波速之比来比较这两种速度。\n\n使用以下物理上合理的基流和重力参数：\n- 平均流速 $u_{0} = 1.80$ 米/秒。\n- 水深 $h_{0} = 2.20$ 米。\n- 重力加速度 $g = 9.81$ 米/秒^2。\n\n假设渠道为宽矩形，因此水力深度等于水深。所有中间波速值均以米/秒表示。为了进行比较，计算比率 $r = c_{k}/c_{+}$，其中 $c_{k}$ 是均匀流下的运动波波速，而 $c_{+}$ 是从圣维南方程推导出的顺流传播的动力波波速。将最终比率四舍五入到四位有效数字，并以无单位的纯数形式表示。",
            "solution": "该问题提法严谨，科学依据扎根于明渠水力学原理。我们将通过系统地推导所需的波速及其比率来解决此问题。\n\n首先，我们从一维圣维南方程推导棱柱形、无摩擦、宽度恒为 $B$ 的矩形渠道中的动力波波速。控制方程为质量守恒和动量守恒方程。\n\n连续性方程为：\n$$ \\frac{\\partial A}{\\partial t} + \\frac{\\partial Q}{\\partial x} = 0 $$\n其中 $A$ 是过水断面面积，$Q$ 是流量。对于矩形渠道，$A=Bh$ 且 $Q=Au=Bhu$，其中 $h$ 是水深，$u$ 是平均流速。由于 $B$ 是常数，连续性方程变为：\n$$ \\frac{\\partial (Bh)}{\\partial t} + \\frac{\\partial (Bhu)}{\\partial x} = 0 $$\n$$ \\frac{\\partial h}{\\partial t} + \\frac{\\partial (hu)}{\\partial x} = 0 $$\n展开第二项得到：\n$$ \\frac{\\partial h}{\\partial t} + u \\frac{\\partial h}{\\partial x} + h \\frac{\\partial u}{\\partial x} = 0 $$\n\n动量方程，忽略摩擦和河床坡度项（因为这些不影响双曲系统的特征速度），为：\n$$ \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + g \\frac{\\partial h}{\\partial x} = 0 $$\n其中 $g$ 是重力加速度。\n\n我们围绕由恒定流速 $u_0$ 和恒定水深 $h_0$ 定义的稳定均匀基态对这些方程进行线性化。我们引入小扰动 $u'$ 和 $h'$，使得：\n$$ u(x,t) = u_0 + u'(x,t) $$\n$$ h(x,t) = h_0 + h'(x,t) $$\n\n将这些代入连续性方程，并仅保留扰动的一阶项：\n$$ \\frac{\\partial (h_0 + h')}{\\partial t} + (u_0 + u') \\frac{\\partial (h_0 + h')}{\\partial x} + (h_0 + h') \\frac{\\partial (u_0 + u')}{\\partial x} = 0 $$\n$$ \\frac{\\partial h'}{\\partial t} + u_0 \\frac{\\partial h'}{\\partial x} + h_0 \\frac{\\partial u'}{\\partial x} = 0 $$\n\n类似地，代入动量方程并进行线性化：\n$$ \\frac{\\partial (u_0 + u')}{\\partial t} + (u_0 + u') \\frac{\\partial (u_0 + u')}{\\partial x} + g \\frac{\\partial (h_0 + h')}{\\partial x} = 0 $$\n$$ \\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x} + g \\frac{\\partial h'}{\\partial x} = 0 $$\n\n这个线性偏微分方程组可以写成矩阵形式。令 $\\mathbf{v} = \\begin{pmatrix} h' \\\\ u' \\end{pmatrix}$。则：\n$$ \\frac{\\partial \\mathbf{v}}{\\partial t} + \\begin{pmatrix} u_0  h_0 \\\\ g  u_0 \\end{pmatrix} \\frac{\\partial \\mathbf{v}}{\\partial x} = \\mathbf{0} $$\n波速 $c$ 是矩阵 $\\mathbf{J} = \\begin{pmatrix} u_0  h_0 \\\\ g  u_0 \\end{pmatrix}$ 的特征值。我们通过求解特征方程 $\\det(\\mathbf{J} - c\\mathbf{I}) = 0$ 来找到它们。\n$$ \\det \\begin{pmatrix} u_0 - c  h_0 \\\\ g  u_0 - c \\end{pmatrix} = 0 $$\n$$ (u_0 - c)^2 - gh_0 = 0 $$\n$$ u_0 - c = \\pm\\sqrt{gh_0} $$\n$$ c = u_0 \\pm \\sqrt{gh_0} $$\n这些是动力波波速。项 $c_{sw} = \\sqrt{gh_0}$ 是水深为 $h_0$ 的浅水中的重力波波速。\n顺流传播的波速是 $c_{+} = u_0 + \\sqrt{gh_0}$。\n逆流传播的波速是 $c_{-} = u_0 - \\sqrt{gh_0}$。\n\n使用给定的基流参数：$u_0 = 1.80 \\, \\text{m/s}$，$h_0 = 2.20 \\, \\text{m}$，以及 $g = 9.81 \\, \\text{m/s}^2$。\n$$ \\sqrt{gh_0} = \\sqrt{(9.81)(2.20)} = \\sqrt{21.582} \\approx 4.6456 \\, \\text{m/s} $$\n$$ c_{+} = 1.80 + 4.6456 = 6.4456 \\, \\text{m/s} $$\n$$ c_{-} = 1.80 - 4.6456 = -2.8456 \\, \\text{m/s} $$\n$c_{-}$ 的负号表示在负 $x$ 方向（上游）传播。\n\n接下来，我们推导运动波波速 $c_k$。运动波模型将动量方程简化为重力与摩擦之间的平衡，$S_0 = S_f$，这意味着流量 $Q$ 和过水断面面积 $A$ 之间存在唯一的关系，即关系曲线 $Q=Q(A)$。控制方程是连续性方程：\n$$ \\frac{\\partial A}{\\partial t} + \\frac{\\partial Q}{\\partial x} = 0 $$\n使用链式法则，$\\frac{\\partial Q}{\\partial x} = \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x}$。方程变为：\n$$ \\frac{\\partial A}{\\partial t} + \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x} = 0 $$\n这是一个一阶波动方程，其中波速为 $c_k = \\frac{dQ}{dA}$。\n\n我们使用均匀流的曼宁方程：$Q = \\frac{1}{n} A R_h^{2/3} S_0^{1/2}$，其中 $n$ 是曼宁糙率系数，$R_h$ 是水力半径。对于宽矩形渠道，$A=Bh$，湿周 $P=B+2h \\approx B$。因此，$R_h = A/P \\approx Bh/B = h$。\n将 $R_h=h$ 和 $A=Bh$ 代入曼宁方程：\n$Q = \\frac{1}{n} (Bh) h^{2/3} S_0^{1/2} = (\\frac{B S_0^{1/2}}{n}) h^{5/3}$。\n为了求得 $c_k = dQ/dA$，我们使用参数定义函数的求导法则：$c_k = \\frac{dQ/dh}{dA/dh}$。\n$$ \\frac{dQ}{dh} = (\\frac{B S_0^{1/2}}{n}) \\frac{5}{3} h^{2/3} $$\n$$ \\frac{dA}{dh} = B $$\n$$ c_k = \\frac{(\\frac{B S_0^{1/2}}{n}) \\frac{5}{3} h^{2/3}}{B} = \\frac{5}{3} \\frac{S_0^{1/2}}{n} h^{2/3} $$\n平均流速 $u$ 由 $u = Q/A = (\\frac{1}{n} R_h^{2/3} S_0^{1/2})$ 给出。对于宽矩形渠道，这是 $u = \\frac{1}{n} h^{2/3} S_0^{1/2}$。将此与 $c_k$ 的表达式进行比较，我们发现宽矩形渠道的一个通用关系：\n$$ c_k = \\frac{5}{3} u $$\n在基态流下进行评估：\n$$ c_k = \\frac{5}{3} u_0 = \\frac{5}{3} (1.80) = 3.00 \\, \\text{m/s} $$\n\n最后，我们计算比率 $r = c_k/c_{+}$。\n$$ c_k = 3.00 \\, \\text{m/s} $$\n$$ c_{+} = 6.4456 \\, \\text{m/s} $$\n$$ r = \\frac{c_k}{c_{+}} = \\frac{3.00}{6.4456} \\approx 0.4654303 $$\n四舍五入到四位有效数字，比率为 $0.4654$。基流的弗劳德数为 $Fr_0 = u_0/\\sqrt{gh_0} = 1.80/4.6456 \\approx 0.387$，为亚临界流。这与运动波比动力波传播得慢的结论是一致的。\n推导出的比率也可以解析地表示为 $r = \\frac{\\frac{5}{3}u_0}{u_0 + \\sqrt{gh_0}} = \\frac{\\frac{5}{3}Fr_0}{Fr_0+1}$，这会得到相同的数值结果。",
            "answer": "$$\n\\boxed{0.4654}\n$$"
        },
        {
            "introduction": "最后的这项实践将波速的理论知识应用于一个前沿的数值方法中。您将实现 Harten-Lax-van Leer (HLL) 近似黎曼求解器，它是许多现代有限体积法的基石，用于求解浅水方程 。这项练习将清晰地展示左行波和右行波的物理概念如何被直接编码到数值通量函数的逻辑中，从而保证计算的稳定性和准确性。",
            "id": "3902833",
            "problem": "您的任务是为一维浅水方程实现一个数值通量函数，该方程是在平坦河床的动力波公式下由圣维南方程推导而来的。该问题涉及 Harten-Lax-van Leer (HLL) 近似黎曼求解器，并要求解释和实现使用特征速度在界面处进行波速估计的方法。程序必须是自包含的，并为几个精心选择的测试用例计算 HLL 数值通量。\n\n基本原理：平坦河床上的一维圣维南方程（浅水方程）的守恒形式为\n$$\n\\partial_t h + \\partial_x (h u) = 0,\n\\qquad\n\\partial_t (h u) + \\partial_x \\left(h u^2 + \\tfrac{1}{2} g h^2 \\right) = 0,\n$$\n其中 $h$ 是水深（单位：$\\mathrm{m}$），$u$ 是断面平均流速（单位：$\\mathrm{m/s}$），$g$ 是重力加速度（单位：$\\mathrm{m/s^2}$）。定义守恒状态向量 $U = (h, q)$，其中 $q = h u$（单位宽度流量，单位：$\\mathrm{m^2/s}$），相应的通量向量 $F(U)$ 为\n$$\nF(U) = \\left(q, \\frac{q^2}{h} + \\frac{1}{2} g h^2 \\right),\n$$\n约定当 $h  0$ 时，$\\frac{q^2}{h}$ 解释为 $h u^2$。\n\n在左状态 $U_L = (h_L, q_L)$ 和右状态 $U_R = (h_R, q_R)$ 之间的界面处，HLL 通量使用两个波速估计值 $s_L$ 和 $s_R$，这两个值由浅水系统的局部特征速度 $u \\pm \\sqrt{g h}$ 计算得出。具体来说，HLL 波速被选择为\n$$\ns_L = \\min\\left( u_L - \\sqrt{g h_L},\\; u_R - \\sqrt{g h_R} \\right),\n\\qquad\ns_R = \\max\\left( u_L + \\sqrt{g h_L},\\; u_R + \\sqrt{g h_R} \\right).\n$$\n穿过界面的 HLL 数值通量被分段定义为\n$$\nF_{\\mathrm{HLL}} =\n\\begin{cases}\nF(U_L),  \\text{if } s_L \\ge 0, \\\\\nF(U_R),  \\text{if } s_R \\le 0, \\\\\n\\dfrac{s_R F(U_L) - s_L F(U_R) + s_L s_R \\left(U_R - U_L\\right)}{s_R - s_L},  \\text{otherwise}.\n\\end{cases}\n$$\n\n您的程序必须为一维浅水方程实现上述 HLL 通量，并为以下测试套件计算数值通量。使用 $g = 9.81\\,\\mathrm{m/s^2}$。对于每个案例，将输入解释为由水深和流速表示的左右物理状态，并将它们转换为守恒变量以计算通量。要求的输出是质量通量分量 $f_h$（单位：$\\mathrm{m^2/s}$）和动量通量分量 $f_q$（单位：$\\mathrm{m^3/s^2}$）。所有输出都必须使用指定单位表示，并四舍五入到六位小数。\n\n测试套件：\n- 案例 1（亚临界，混合速度）：$h_L = 2.0\\,\\mathrm{m}$，$u_L = 1.0\\,\\mathrm{m/s}$，$h_R = 2.2\\,\\mathrm{m}$，$u_R = -0.5\\,\\mathrm{m/s}$。\n- 案例 2（超临界右行，$s_L \\ge 0$）：$h_L = 0.5\\,\\mathrm{m}$，$u_L = 4.0\\,\\mathrm{m/s}$，$h_R = 0.4\\,\\mathrm{m}$，$u_R = 3.0\\,\\mathrm{m/s}$。\n- 案例 3（超临界左行，$s_R  0$）：$h_L = 0.4\\,\\mathrm{m}$，$u_L = -3.0\\,\\mathrm{m/s}$，$h_R = 0.6\\,\\mathrm{m}$，$u_R = -4.0\\,\\mathrm{m/s}$。\n- 案例 4（静止湖泊，平坦自由表面）：$h_L = 3.0\\,\\mathrm{m}$，$u_L = 0.0\\,\\mathrm{m/s}$，$h_R = 3.0\\,\\mathrm{m}$，$u_R = 0.0\\,\\mathrm{m/s}$。\n- 案例 5（右侧近干涸河床）：$h_L = 1.0\\,\\mathrm{m}$，$u_L = 0.0\\,\\mathrm{m/s}$，$h_R = 1.0 \\times 10^{-6}\\,\\mathrm{m}$，$u_R = 0.0\\,\\mathrm{m/s}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素都是一个包含两个元素的列表，分别表示相应测试用例的质量和动量通量分量，四舍五入到六位小数。例如：\n$$\n\\text{[}[f_{h,1}, f_{q,1}], [f_{h,2}, f_{q,2}], \\ldots \\text{]}.\n$$\n输出字符串中不允许有空格。数值必须是浮点数。\n\n答案单位：输出 $f_h$（单位：$\\mathrm{m^2/s}$）和 $f_q$（单位：$\\mathrm{m^3/s^2}$），每个值都四舍五入到六位小数。",
            "solution": "该问题要求实现并应用 Harten-Lax-van Leer (HLL) 近似黎曼求解器来计算一维浅水方程的数值通量。浅水方程由平坦、无摩擦河床的圣维南方程推导而来，是一组双曲守恒律。\n\n守恒形式的控制方程由下式给出：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\n其中 $t$ 是时间，$x$ 是空间坐标。守恒变量向量 $U$ 和通量向量 $F(U)$ 定义如下：\n$$\nU = \\begin{pmatrix} h \\\\ h u \\end{pmatrix} = \\begin{pmatrix} h \\\\ q \\end{pmatrix}\n\\qquad\nF(U) = \\begin{pmatrix} h u \\\\ h u^2 + \\frac{1}{2} g h^2 \\end{pmatrix} = \\begin{pmatrix} q \\\\ \\frac{q^2}{h} + \\frac{1}{2} g h^2 \\end{pmatrix}\n$$\n此处，$h$ 是水深，$u$ 是断面平均流速，$q = hu$ 是单位宽度流量，$g$ 是重力加速度，指定为 $g = 9.81\\,\\mathrm{m/s^2}$。项 $\\frac{q^2}{h}$ 被理解为 $h u^2$，且在 $h  0$ 时是良定义的。\n\nHLL 求解器近似黎曼问题的解，这是一个初值问题，其数据在界面处由左状态 $U_L$ 和右状态 $U_R$ 分段常数定义。HLL 近似假设解由三个常数状态组成，这三个状态被两个以速度 $s_L$ 和 $s_R$ 传播的波分开。这些速度是系统最小和最大特征速度的估计值。浅水系统的特征速度（通量雅可比矩阵 $\\frac{\\partial F}{\\partial U}$ 的特征值）为 $\\lambda_{1,2} = u \\pm \\sqrt{g h}$。\n\n根据问题陈述，波速估计值 $s_L$ 和 $s_R$ 被选为根据左右状态计算的特征速度的最小值和最大值：\n$$\ns_L = \\min( u_L - \\sqrt{g h_L},\\; u_R - \\sqrt{g h_R} )\n$$\n$$\ns_R = \\max( u_L + \\sqrt{g h_L},\\; u_R + \\sqrt{g h_R} )\n$$\nHLL 数值通量，记为 $F_{\\mathrm{HLL}}$，然后根据这些估计波相对于界面（在 $x=0$ 处）的传播方向来定义：\n\n1.  如果 $s_L \\ge 0$，两个波都向右移动。通量完全由左状态决定，因为整个波结构都在界面的下游。\n    $$\n    F_{\\mathrm{HLL}} = F(U_L)\n    $$\n2.  如果 $s_R \\le 0$，两个波都向左移动。通量完全由右状态决定，因为整个波结构都在界面的上游。\n    $$\n    F_{\\mathrm{HLL}} = F(U_R)\n    $$\n3.  如果 $s_L  0  s_R$，波向相反方向移动，在它们之间形成一个跨越界面的“星区”。通量是左右通量的加权平均，并附加一项来解释 $U_L$ 和 $U_R$ 之间的跳跃。该公式是通过在由速度 $s_L$ 和 $s_R$ 定义的 $x-t$ 平面上的控制体上对守恒律进行积分而导出的。\n    $$\n    F_{\\mathrm{HLL}} = \\frac{s_R F(U_L) - s_L F(U_R) + s_L s_R (U_R - U_L)}{s_R - s_L}\n    $$\n\n为每个测试用例计算 HLL 通量的计算步骤如下：\n对于每个给定的左状态为 $(h_L, u_L)$ 和右状态为 $(h_R, u_R)$ 的测试用例：\n\n1.  **转换为守恒变量：**\n    计算流量 $q_L = h_L u_L$ 和 $q_R = h_R u_R$。\n    构建状态向量 $U_L = (h_L, q_L)$ 和 $U_R = (h_R, q_R)$。\n\n2.  **估计波速：**\n    计算左右状态的特征速度：$u_L \\pm \\sqrt{g h_L}$ 和 $u_R \\pm \\sqrt{g h_R}$。由于所有给定的水深都是非负的，平方根是良定义的。\n    使用提供的 $\\min$ 和 $\\max$ 公式确定 HLL 波速 $s_L$ 和 $s_R$。\n\n3.  **计算物理通量：**\n    使用公式 $F(U) = (q, q^2/h + \\frac{1}{2} g h^2)$ 计算通量向量 $F(U_L)$ 和 $F(U_R)$。对于 $h=0$ 的边界情况，通量将为 $(0,0)$。提供的测试用例通过对近干涸条件使用一个小的正水深（$h=10^{-6}\\,\\mathrm{m}$）来避免这种情况。\n\n4.  **计算 HLL 通量：**\n    根据 $s_L$ 和 $s_R$ 的符号，应用 $F_{\\mathrm{HLL}}$ 的三部分分段公式。最终输出向量 $F_{\\mathrm{HLL}} = (f_h, f_q)$ 分别包含数值质量通量和动量通量。\n\n5.  **格式化输出：**\n    对于每个测试用例，将所得通量向量 $(f_h, f_q)$ 的分量四舍五入到六位小数。\n\n此过程将应用于所有五个测试用例以生成最终输出。使用向量算术（如通过 NumPy 这样的库实现）简化了中心 HLL 通量公式的计算，因为它可以逐分量地应用于状态和通量向量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the HLL numerical flux for the 1D shallow-water equations for a suite of test cases.\n    \"\"\"\n    # Gravitational acceleration\n    g = 9.81  # m/s^2\n\n    # Test suite: (h_L, u_L, h_R, u_R)\n    test_cases = [\n        (2.0, 1.0, 2.2, -0.5),      # Case 1: subcritical, mixed velocities\n        (0.5, 4.0, 0.4, 3.0),       # Case 2: supercritical right-going, s_L >= 0\n        (0.4, -3.0, 0.6, -4.0),     # Case 3: supercritical left-going, s_R = 0\n        (3.0, 0.0, 3.0, 0.0),       # Case 4: lake at rest\n        (1.0, 0.0, 1.0e-6, 0.0),    # Case 5: near-dry bed on the right\n    ]\n\n    results = []\n\n    def compute_flux_vector(h, u, g_val):\n        \"\"\"Computes the physical flux vector F(U) from primitive variables (h, u).\"\"\"\n        if h == 0:\n            return np.array([0.0, 0.0])\n        q = h * u\n        return np.array([q, q**2 / h + 0.5 * g_val * h**2])\n\n    for case in test_cases:\n        h_L, u_L, h_R, u_R = case\n\n        # Step 1: Convert to conservative variables\n        q_L = h_L * u_L\n        q_R = h_R * u_R\n        \n        U_L = np.array([h_L, q_L])\n        U_R = np.array([h_R, q_R])\n\n        # Step 2: Estimate wave speeds\n        # Handle h=0 case, although not strictly necessary for given tests\n        c_L = np.sqrt(g * h_L) if h_L > 0 else 0.0\n        c_R = np.sqrt(g * h_R) if h_R > 0 else 0.0\n        \n        lambda_1_L = u_L - c_L\n        lambda_2_L = u_L + c_L\n        lambda_1_R = u_R - c_R\n        lambda_2_R = u_R + c_R\n        \n        s_L = min(lambda_1_L, lambda_1_R)\n        s_R = max(lambda_2_L, lambda_2_R)\n\n        # Step 3: Compute physical fluxes\n        F_L = compute_flux_vector(h_L, u_L, g)\n        F_R = compute_flux_vector(h_R, u_R, g)\n\n        # Step 4: Calculate HLL flux\n        if s_L >= 0:\n            F_hll = F_L\n        elif s_R = 0:\n            F_hll = F_R\n        else: # s_L  0  s_R\n            # The denominator s_R - s_L is guaranteed to be non-zero here.\n            F_hll = (s_R * F_L - s_L * F_R + s_L * s_R * (U_R - U_L)) / (s_R - s_L)\n            \n        # Step 5: Round and store results\n        f_h = round(F_hll[0], 6)\n        f_q = round(F_hll[1], 6)\n        # Ensure -0.0 is represented as 0.0\n        if f_h == -0.0: f_h = 0.0\n        if f_q == -0.0: f_q = 0.0\n        results.append([f_h, f_q])\n    \n    # Final print statement in the exact required format.\n    # We construct the string manually to avoid spaces.\n    result_strings = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}