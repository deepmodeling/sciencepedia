{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的理查兹方程数值解之前，建立对主导物理过程的直观理解至关重要。本练习将引导你使用一种在物理学和工程学中非常强大的技术——标度分析（scaling analysis），来探究控制非饱和流动的两种基本力：重力和毛细管力。通过推导无量纲的毛细管数 $\\mathcal{C}$ 并解释其物理意义，你将学会判断流动是由重力主导（形成尖锐的湿润锋）还是由毛细管力主导（导致类似扩散的平滑过程）。",
            "id": "3913604",
            "problem": "考虑在地球重力作用下，均质土壤柱中的一维垂直变饱和流。从水量质量守恒定律和变饱和流的达西-白金汉定律出发，通过引入特征垂直长度尺度 $L$、特征基质（压力）水头大小 $\\Psi^{\\ast}$、特征饱和导水率 $K_{s}$ 以及相关的时间尺度 $T$ 来进行尺度分析。使用这些尺度定义一个无量纲毛细管数 $\\mathcal{C}$，该数衡量垂直通量中毛细管压力水头梯度与重力的相对重要性。然后，论证毛细作用主导或重力主导的极限情况。\n\n选择所有关于 $\\mathcal{C}$ 的解释以及在相应极限情况下流动行为的正确陈述：\n\nA. 在极限情况 $\\mathcal{C} \\gg 1$ 下，达西-白金汉通量中由重力引起的贡献在主导阶上可以忽略不计，控制动力学由毛细作用主导；在主导阶上，通量简化为 $q \\approx -K(h)\\,\\partial h/\\partial z$，并且入渗锋面被强烈的毛细管梯度平滑化。\n\nB. 在极限情况 $\\mathcal{C} \\ll 1$ 下，毛细管压力水头梯度在主导阶上可以忽略不计，通量近似为 $q \\approx -K(h)$（向下），守恒定律简化为 $\\partial \\theta/\\partial t + \\partial(-K(\\theta))/\\partial z \\approx 0$，即一个由重力驱动的运动波，其特征由 $-\\,\\mathrm{d}K/\\mathrm{d}\\theta$ 决定。\n\nC. 无量纲数 $\\mathcal{C}$ 比较的是惯性力与粘性力；因此，$\\mathcal{C} \\gg 1$ 意味着惯性效应主导流动。\n\nD. 在地下水位的静水毛细上升中，选择 $L$ 等于平衡上升高度，$\\Psi^{\\ast}$ 等于基质水头的特征大小，将得到量级为 1 的 $\\mathcal{C}$，这反映了平衡状态下重力与毛细作用之间的平衡。\n\nE. 对于具有极大 $\\mathcal{C}$ 值的土壤，由于重力可以忽略不计，其动力学行为变得与 $K(h)$ 无关；因此，任何两个具有不同导水率函数的土壤都会表现出相同的再分布行为。",
            "solution": "用户提供了一个关于多孔介质中一维变饱和流的问题陈述。我的任务是首先验证该问题陈述，如果有效，则继续进行完整解答并评估给出的选项。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **系统：** 一维（$1$D）垂直变饱和流。\n- **介质：** 均质土壤柱。\n- **外力：** 地球重力。\n- **控制原理：** 水量质量守恒定律和变饱和流的达西-白金汉定律。\n- **任务 1：** 进行尺度分析。\n- **特征尺度：**\n    - 垂直长度尺度：$L$\n    - 基质（压力）水头大小：$\\Psi^{\\ast}$\n    - 饱和导水率：$K_{s}$\n    - 相关时间尺度：$T$\n- **任务 2：** 定义一个无量纲毛细管数 $\\mathcal{C}$，用于衡量垂直通量中毛细管压力水头梯度与重力的相对重要性。\n- **任务 3：** 分析毛细作用主导与重力主导的极限情况。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于多孔介质流动的经典理论，特别是使用了理查兹方程，该方程由质量守恒原理和达西-白金汉定律推导而来。这些是水文地质学、土壤物理学和环境工程中的基石概念。该问题在科学上是合理的。\n- **适定性：** 该问题要求通过尺度分析推导一个无量纲数，并解释其在极限情况下的物理意义。这是物理学和工程学中一个标准且定义明确的程序，用于在不求解完整控制方程的情况下理解系统的行为。可以推导出 $\\mathcal{C}$ 的一个唯一且有意义的定义，其极限的解释是标准结果。\n- **客观性：** 语言技术性强、精确，没有主观或含糊的术语。所有使用的术语在相关科学领域都有公认的含义。\n- **完整性与一致性：** 该问题提供了进行尺度分析所需的所有概念要素。它明确了要使用的物理定律和特征尺度。整个设置是自洽且内部一致的。\n\n**第 3 步：结论与行动**\n问题陈述是有效的。这是一个多孔介质中输运现象的标准、适定问题。我现在将进行推导和求解。\n\n### 推导与求解\n\n**1. 控制方程**\n一维垂直变饱和多孔介质中的水流由理查兹方程描述。它结合了质量守恒定律和达西-白金汉定律。设 $z$ 为垂直坐标，向上为正， $t$ 为时间。\n\n水的质量守恒定律为：\n$$ \\frac{\\partial \\theta}{\\partial t} = -\\frac{\\partial q}{\\partial z} $$\n其中 $\\theta$ 是体积含水量（无量纲，$[L^3/L^3]$），$q$ 是体积水通量（达西速度，$[L/T]$）。\n\n重力作用下垂直流动的达西-白金汉定律为：\n$$ q = -K(h) \\frac{\\partial \\Phi}{\\partial z} $$\n其中 $K(h)$ 是非饱和导水率（$[L/T]$），它是基质水头 $h$（$[L]$）的强函数，$\\Phi$ 是总水头（$[L]$）。总水头是基质水头和高程水头之和，$\\Phi = h + z$。\n\n将总水头代入达西-白金汉定律：\n$$ q = -K(h) \\frac{\\partial (h+z)}{\\partial z} = -K(h) \\left( \\frac{\\partial h}{\\partial z} + 1 \\right) $$\n因此，通量 $q$ 由两部分组成：\n- $q_{cap} = -K(h) \\frac{\\partial h}{\\partial z}$ (由毛细管压力水头梯度驱动的通量)\n- $q_{grav} = -K(h)$ (由重力驱动的通量)\n\n**2. 尺度分析与 $\\mathcal{C}$ 的定义**\n问题要求一个无量纲数 $\\mathcal{C}$，用来比较毛细管压力水头梯度与重力的重要性。这等同于比较总水头梯度中两个驱动项 $\\frac{\\partial h}{\\partial z}$ 和 $1$ 的大小。\n\n我们引入特征尺度：\n- 基质水头 $h$ 由其特征大小 $\\Psi^{\\ast}$ 进行尺度化：$h \\sim \\Psi^{\\ast}$。\n- 垂直坐标 $z$ 由特征长度 $L$ 进行尺度化：$z \\sim L$。\n\n利用这些尺度，我们可以估计毛细管压力水头梯度的数量级：\n$$ \\left| \\frac{\\partial h}{\\partial z} \\right| \\sim \\frac{\\Psi^{\\ast}}{L} $$\n重力水头梯度恰好为 $\\frac{\\partial z}{\\partial z} = 1$。\n\n无量纲毛细管数 $\\mathcal{C}$ 是毛细管梯度特征大小与重力梯度之比：\n$$ \\mathcal{C} = \\frac{|\\text{特征毛细管梯度}|}{|\\text{特征重力梯度}|} = \\frac{\\Psi^{\\ast}/L}{1} = \\frac{\\Psi^{\\ast}}{L} $$\n由于 $\\Psi^{\\ast}$（压力水头）和 $L$ 的单位都是长度，所以 $\\mathcal{C}$ 是一个无量纲数。\n\n现在我们根据 $\\mathcal{C}$ 的值分析极限情况。\n\n- **毛细作用主导情况：** 如果 $\\mathcal{C} \\gg 1$，则 $\\Psi^{\\ast}/L \\gg 1$。这意味着特征毛细管梯度 $|\\partial h/\\partial z|$ 远大于 $1$ 的重力梯度。\n- **重力主导情况：** 如果 $\\mathcal{C} \\ll 1$，则 $\\Psi^{\\ast}/L \\ll 1$。这意味着特征毛细管梯度 $|\\partial h/\\partial z|$ 远小于重力梯度。\n\n**3. 选项评估**\n\n**A. 在极限情况 $\\mathcal{C} \\gg 1$ 下，达西-白金汉通量中由重力引起的贡献在主导阶上可以忽略不计，控制动力学由毛细作用主导；在主导阶上，通量简化为 $q \\approx -K(h)\\,\\partial h/\\partial z$，并且入渗锋面被强烈的毛细管梯度平滑化。**\n\n如果 $\\mathcal{C} \\gg 1$，则 $|\\partial h/\\partial z| \\gg 1$。通量表达式 $q = -K(h) (\\partial h/\\partial z + 1)$ 由 $\\partial h/\\partial z$ 项主导。因此，在主导阶上：\n$$ q \\approx -K(h) \\frac{\\partial h}{\\partial z} $$\n重力贡献 $-K(h)$ 确实可以忽略。将此通量代入守恒定律 $\\partial\\theta/\\partial t = -\\partial q/\\partial z$ 得到：\n$$ \\frac{\\partial \\theta}{\\partial t} \\approx \\frac{\\partial}{\\partial z} \\left( K(h) \\frac{\\partial h}{\\partial z} \\right) $$\n使用比水容量 $C(h) = d\\theta/dh$，上式变为 $C(h) \\frac{\\partial h}{\\partial t} \\approx \\frac{\\partial}{\\partial z} \\left( K(h) \\frac{\\partial h}{\\partial z} \\right)$。这是一个非线性扩散方程（也称为 Fokker-Planck 方程）。扩散过程的特点是平滑尖锐的梯度。因此，入渗锋面将被平滑化。该陈述完全正确。\n**结论：正确**\n\n**B. 在极限情况 $\\mathcal{C} \\ll 1$ 下，毛细管压力水头梯度在主导阶上可以忽略不计，通量近似为 $q \\approx -K(h)$（向下），守恒定律简化为 $\\partial \\theta/\\partial t + \\partial(-K(\\theta))/\\partial z \\approx 0$，即一个由重力驱动的运动波，其特征由 $-\\,\\mathrm{d}K/\\mathrm{d}\\theta$ 决定。**\n\n如果 $\\mathcal{C} \\ll 1$，那么 $|\\partial h/\\partial z| \\ll 1$。通量表达式 $q = -K(h) (\\partial h/\\partial z + 1)$ 中的 $\\partial h/\\partial z$ 项与 $1$ 相比可以忽略。因此，在主导阶上：\n$$ q \\approx -K(h)(1) = -K(h) $$\n负号表示向下的流动（因为 $z$ 向上为正，$K(h)$ 为非负值）。守恒定律 $\\partial\\theta/\\partial t = -\\partial q/\\partial z$ 变为：\n$$ \\frac{\\partial \\theta}{\\partial t} \\approx -\\frac{\\partial}{\\partial z}(-K(h)) $$\n由于 $\\theta$ 是 $h$ 的唯一函数，我们可以将 $K$ 表示为 $\\theta$ 的函数，$K(\\theta)$。方程则为 $\\frac{\\partial \\theta}{\\partial t} + \\frac{\\partial(-K(\\theta))}{\\partial z} \\approx 0$。这是一个一阶双曲型偏微分方程，描述了波的传播。这种由重力驱动的流动被称为运动波。对于形如 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial F(u)}{\\partial x} = 0$ 的方程，特征速度（波速）由 $c = dF/du$ 给出。在我们的例子中，$u = \\theta$ 且 $F(\\theta) = -K(\\theta)$。因此，特征速度为 $c(\\theta) = \\frac{d}{d\\theta}(-K(\\theta)) = -\\frac{dK}{d\\theta}$。该陈述完全正确。\n**结论：正确**\n\n**C. 无量纲数 $\\mathcal{C}$ 比较的是惯性力与粘性力；因此，$\\mathcal{C} \\gg 1$ 意味着惯性效应主导流动。**\n\n比较惯性力与粘性力的无量纲数是雷诺数，通常定义为 $Re = \\rho v L / \\mu$。达西-白金汉定律本身是在蠕动流（极低的雷诺数）的假设下推导出来的，其中粘性力占主导地位，惯性力可以忽略不计。我们的数 $\\mathcal{C} = \\Psi^{\\ast}/L$ 比较的是压力梯度（由毛细作用引起）的大小与另一个势梯度（由重力引起）的大小。它是一个力的比率，但不是惯性力与粘性力的比率。这个陈述从根本上误解了 $\\mathcal{C}$ 的物理意义。\n**结论：不正确**\n\n**D. 在地下水位的静水毛细上升中，选择 $L$ 等于平衡上升高度，$\\Psi^{\\ast}$ 等于基质水头的特征大小，将得到量级为 1 的 $\\mathcal{C}$，这反映了平衡状态下重力与毛细作用之间的平衡。**\n\n在静水力平衡状态下，净通量 $q$ 为零。这意味着：\n$$ q = -K(h) \\left( \\frac{\\partial h}{\\partial z} + 1 \\right) = 0 $$\n对于 $K(h) > 0$ 的湿润区域，这要求总水头梯度为零：\n$$ \\frac{\\partial h}{\\partial z} + 1 = 0 \\quad \\implies \\quad \\frac{\\partial h}{\\partial z} = -1 $$\n这表明毛细管压力水头梯度（大小为 $1$）与重力水头梯度（大小为 $1$）之间达到了完美平衡。如果我们选择特征长度尺度 $L$ 为毛细带的高度，并选择 $\\Psi^{\\ast}$ 为此高度上基质水头的大小，则特征梯度为 $|\\partial h/\\partial z| \\sim \\Psi^{\\ast}/L$。由于在平衡状态下该梯度等于 $1$，我们必然有 $\\Psi^{\\ast}/L = 1$，即 $\\mathcal{C} = 1$。这标志着两种力之间的平衡。该陈述在物理上和数学上都是合理的。\n**结论：正确**\n\n**E. 对于具有极大 $\\mathcal{C}$ 值的土壤，由于重力可以忽略不计，其动力学行为变得与 $K(h)$ 无关；因此，任何两个具有不同导水率函数的土壤都会表现出相同的再分布行为。**\n\n如选项 A 的分析所示，在 $\\mathcal{C} \\gg 1$ 的极限下，控制方程近似为：\n$$ C(h) \\frac{\\partial h}{\\partial t} \\approx \\frac{\\partial}{\\partial z} \\left( K(h) \\frac{\\partial h}{\\partial z} \\right) $$\n动力学行为显然依赖于导水率函数 $K(h)$。函数 $K(h)$（以及 $C(h)$）决定了土壤的水力扩散率 $D(h) = K(h)/C(h)$，后者控制着水分再分布的速率。在其他条件相同的情况下，具有较高 $K(h)$ 的土壤将比具有较低 $K(h)$ 的土壤更快地进行水分再分布。动力学行为变得与 $K(h)$ 无关这一前提是错误的，因此结论也是错误的。\n**结论：不正确**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "在建立了对基本物理机制的概念性理解之后，我们现在将这些知识应用于一个经典的实际问题：确定土壤能从浅层地下水位维持的最大蒸发速率。这项练习要求你从达西-白金汉定律出发，为稳态下的理查兹方程推导出一个精确的解析解。通过这个过程，你不仅能锻炼自己的数学推导能力，还能为一个关于毛细管力供水极限的重要物理问题提供一个定量的答案。",
            "id": "3913595",
            "problem": "一个深度为 $D$ 的一维垂直土柱位于浅层地下水位之上。设 $z$ 表示垂直坐标，向上为正，地下水位处 $z=0$，地表处 $z=D$。压力水头 $h(z)$（单位：米水柱）在非饱和区为负值，并满足由质量守恒和达西-白金汉稳态流定律共同控制的变饱和流。总水力水头为 $H(z) = h(z) + z$。假设如下：\n- 水流是稳态、等温、一维的，具有随深度均匀的向上蒸发通量 $q$（向上为正）。\n- 非饱和导水率函数遵循 Gardner 指数模型 $K(h) = K_{s} \\exp(\\alpha h)$，其中 $K_{s}$ 是饱和导水率，$\\alpha$ 是一个正的长度倒数参数。\n- 地下水位处的下边界为 $h(0) = 0$。地表处的上边界由大气需求通量 $q_{a}$ 指定，当仅靠液相输运无法满足 $q_{a}$ 时，允许出现水力上干燥表面 $h(D) \\to -\\infty$ 的极限情况。\n- 只包含液相输运机制；本构关系中排除了气相输运。\n\n从上述控制原理出发，推导稳态向上液相蒸发剖面，并得出一个封闭形式的表达式，用于表示仅靠液相能从深度为 $D$ 的地下水位提供的最大毛细管支持的稳态蒸发量。然后，说明如何通过比较施加的大气需求通量 $q_{a}$ 与毛细管最大值，来识别毛细管作用能够维持所施加的大气需求的机制与需要气相输运的机制。\n\n你的最终答案必须是无量纲最大毛细管支持蒸发通量 $q_{\\max}/K_{s}$ 的单一封闭形式解析表达式，表示为无量纲深度 $\\alpha D$ 的函数。在最终的方框答案中不要包含单位。如果在中间步骤中选择使用单位，长度请使用米，通量请使用米/秒。不需要进行数值计算或四舍五入。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- 一个深度为 $D$ 的一维垂直土柱。\n- 垂直坐标 $z$ 向上为正，地下水位处 $z=0$，地表处 $z=D$。\n- 压力水头为 $h(z)$，总水力水头为 $H(z) = h(z) + z$。\n- 水流是稳态、等温、一维的。\n- 向上蒸发通量 $q$ 为正值，且随深度均匀。\n- 非饱和导水率由 Gardner 指数模型给出：$K(h) = K_{s} \\exp(\\alpha h)$。$K_s$ 是饱和导水率，$\\alpha$ 是一个正的长度倒数参数。\n- 下边界条件：$h(0) = 0$。\n- 上边界条件：地表由大气需求通量 $q_{a}$ 指定。当液相输运无法满足 $q_{a}$ 时，允许出现水力上干燥表面 $h(D) \\to -\\infty$ 的极限情况。\n- 输运机制仅为液相。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于多孔介质流体动力学的基本原理，特别是达西-白金汉定律和质量守恒，这两者结合形成了理查兹方程。Gardner 导水率模型是土壤物理学中广泛使用和接受的经验模型。该设置描述了包气带水文学中的一个经典问题。该问题在科学上是合理的。\n- **适定性**：该问题提供了一个控制定律、一个本构关系和明确定义的边界条件。它要求推导最大通量，这对应于系统的一个特定、唯一的极限行为。该问题是适定的。\n- **客观性**：该问题以物理学和工程学中惯用的精确、客观的语言陈述。它不含主观或基于意见的陈述。\n\n### 步骤 3：结论与行动\n问题有效。现在开始推导解答。\n\n变饱和流的控制原理是质量守恒和达西-白金汉定律的结合。对于稳态（$ \\frac{\\partial}{\\partial t} = 0 $）、一维垂直流且土柱内无源汇项的情况，质量守恒方程简化为 $\\frac{dq_z}{dz} = 0$，其中 $q_z$ 是达西通量的垂直分量。这意味着通量随深度恒定，即 $q_z(z) = q$。问题将这个向上的通量 $q$ 定义为正值。\n\n达西-白金汉定律将通量与总水力水头 $H(z)$ 的梯度联系起来。标准公式给出的通量向量为 $\\mathbf{q} = -K \\nabla H$。在一维情况下，当 $z$ 指向上的方向，垂直通量 $q_z$ 由下式给出：\n$$\nq_z = -K(h) \\frac{dH}{dz} = -K(h) \\frac{d}{dz}(h+z) = -K(h) \\left(\\frac{dh}{dz} + 1\\right)\n$$\n由于问题将向上的通量 $q$ 定义为正值，我们设 $q = q_z$。\n$$\nq = -K(h) \\left(\\frac{dh}{dz} + 1\\right)\n$$\n我们已知 Gardner 导水率模型为 $K(h) = K_s \\exp(\\alpha h)$，其中 $K_s$ 是饱和导水率且 $\\alpha > 0$。将此代入流动方程，得到：\n$$\nq = -K_s \\exp(\\alpha h) \\left(\\frac{dh}{dz} + 1\\right)\n$$\n这是一个关于压力水头剖面 $h(z)$ 的一阶常微分方程。我们可以求解 $\\frac{dh}{dz}$：\n$$\n\\frac{dh}{dz} = -\\frac{q}{K_s \\exp(\\alpha h)} - 1 = -1 - \\frac{q}{K_s} \\exp(-\\alpha h)\n$$\n由于 $q$、$K_s$ 和 $\\alpha$ 均为正值，且 $\\exp(-\\alpha h)$ 也为正值，因此导数 $\\frac{dh}{dz}$ 恒为负。这与从地下水位蒸发的物理过程相符，因为压力水头（吸力）必须随着高出地下水位的高度增加而变得更负。\n\n为了找到深度和压力水头之间的关系，我们分离变量：\n$$\ndz = \\frac{dh}{-1 - \\frac{q}{K_s} \\exp(-\\alpha h)} = -\\frac{dh}{1 + \\frac{q}{K_s} \\exp(-\\alpha h)}\n$$\n我们将此方程从地下水位（$z=0$，此处 $h=0$）积分到土壤表面（$z=D$，此处压力水头为 $h(D)$）。通量 $q$ 在整个剖面中是恒定的。\n$$\n\\int_0^D dz = -\\int_0^{h(D)} \\frac{dh}{1 + \\frac{q}{K_s} \\exp(-\\alpha h)}\n$$\n$$\nD = -\\int_0^{h(D)} \\frac{dh}{1 + \\frac{q}{K_s} \\exp(-\\alpha h)}\n$$\n问题要求解最大毛细管支持的稳态蒸发量 $q_{\\max}$。这个最大通量发生在表面变得水力上干燥的极限条件下，数学上表示为 $h(D) \\to -\\infty$。为了求得 $q_{\\max}$，我们将 $q$ 替换为 $q_{\\max}$，并将积分上限设为 $-\\infty$：\n$$\nD = -\\int_0^{-\\infty} \\frac{dh}{1 + \\frac{q_{\\max}}{K_s} \\exp(-\\alpha h)}\n$$\n为了计算该积分，我们进行换元。令 $u = \\exp(-\\alpha h)$。则 $du = -\\alpha \\exp(-\\alpha h) dh$，这意味着 $dh = -\\frac{du}{\\alpha u}$。$u$ 的积分限为：\n- 当 $h=0$ 时，$u = \\exp(0) = 1$。\n- 当 $h \\to -\\infty$ 时，$u = \\exp(-\\alpha h) \\to \\infty$。\n\n将这些代入 $D$ 的积分式中：\n$$\nD = -\\int_1^{\\infty} \\frac{-du/(\\alpha u)}{1 + \\frac{q_{\\max}}{K_s} u} = \\frac{1}{\\alpha} \\int_1^{\\infty} \\frac{du}{u(1 + \\frac{q_{\\max}}{K_s} u)}\n$$\n我们对被积函数使用部分分式分解。令 $c = \\frac{q_{\\max}}{K_s}$。\n$$\n\\frac{1}{u(1+cu)} = \\frac{A}{u} + \\frac{B}{1+cu} \\implies 1 = A(1+cu) + Bu\n$$\n令 $u=0$ 得 $A=1$。令 $u=-1/c$ 得 $B=-c$。因此，被积函数为 $\\frac{1}{u} - \\frac{c}{1+cu}$。\n积分变为：\n$$\nD = \\frac{1}{\\alpha} \\int_1^{\\infty} \\left(\\frac{1}{u} - \\frac{c}{1+cu}\\right) du\n$$\n$$\nD = \\frac{1}{\\alpha} \\left[ \\ln(u) - \\ln(1+cu) \\right]_1^{\\infty} = \\frac{1}{\\alpha} \\left[ \\ln\\left(\\frac{u}{1+cu}\\right) \\right]_1^{\\infty}\n$$\n现在，我们计算在积分限处的值：\n- 当 $u \\to \\infty$ 时：$\\lim_{u \\to \\infty} \\ln\\left(\\frac{u}{1+cu}\\right) = \\ln\\left(\\lim_{u \\to \\infty} \\frac{u}{1+cu}\\right) = \\ln\\left(\\frac{1}{c}\\right)$。\n- 当 $u=1$ 时：$\\ln\\left(\\frac{1}{1+c}\\right) = -\\ln(1+c)$。\n\n所以，定积分为：\n$$\nD = \\frac{1}{\\alpha} \\left( \\ln\\left(\\frac{1}{c}\\right) - (-\\ln(1+c)) \\right) = \\frac{1}{\\alpha} \\left( \\ln\\left(\\frac{1}{c}\\right) + \\ln(1+c) \\right) = \\frac{1}{\\alpha} \\ln\\left(\\frac{1+c}{c}\\right)\n$$\n将 $c = q_{\\max}/K_s$ 代回：\n$$\nD = \\frac{1}{\\alpha} \\ln\\left(\\frac{1+q_{\\max}/K_s}{q_{\\max}/K_s}\\right) = \\frac{1}{\\alpha} \\ln\\left(1 + \\frac{K_s}{q_{\\max}}\\right)\n$$\n这个方程将土壤深度 $D$ 与最大蒸发速率 $q_{\\max}$ 联系起来。我们现在求解无量纲最大通量 $\\frac{q_{\\max}}{K_s}$，使其表示为无量纲深度 $\\alpha D$ 的函数。\n$$\n\\alpha D = \\ln\\left(1 + \\frac{K_s}{q_{\\max}}\\right)\n$$\n对两边取指数：\n$$\n\\exp(\\alpha D) = 1 + \\frac{K_s}{q_{\\max}}\n$$\n$$\n\\frac{K_s}{q_{\\max}} = \\exp(\\alpha D) - 1\n$$\n将表达式取倒数，得到所需的无量纲通量：\n$$\n\\frac{q_{\\max}}{K_s} = \\frac{1}{\\exp(\\alpha D) - 1}\n$$\n这就是仅靠液相所能提供的最大毛细管支持的稳态蒸发量的封闭形式表达式。\n\n关于流动机制的识别：值 $q_{\\max}$ 代表了土壤液相的最大供应能力。大气需求为 $q_a$。\n- 如果 $q_a \\le q_{\\max}$，土壤能够以大气所需求的速率供应液态水。实际蒸发速率将为 $q=q_a$，并且地表将具有一个有限的负压力水头 $h(D) > -\\infty$。这是一个需求限制机制。\n- 如果 $q_a > q_{\\max}$，大气对水的需求超过了土壤以液相输送水的最大能力。液流通量被限制为 $q_{liquid} = q_{\\max}$，并且地表变得水力上干燥 ($h(D) \\to -\\infty$)。为了满足全部大气需求，需要其他输运机制（如气相扩散）来弥补差额 $q_a - q_{\\max}$。这是一个供应限制机制。\n因此，需要气相输运的机制由条件 $q_a > q_{\\max}$ 来识别。",
            "answer": "$$\\boxed{\\frac{1}{\\exp(\\alpha D) - 1}}$$"
        },
        {
            "introduction": "最后的这项实践练习旨在弥合解析理论与计算建模之间的鸿沟，这是任何地球系统建模者都必须掌握的关键技能。你将首先为稳态入渗剖面推导出一个解析解，然后编写代码实现一个数值求解器来模拟相同的情景。通过将数值解与精确的解析解进行比较，你将完成一次模型验证（model verification），这是建立对任何数值代码信心的基本步骤，也是计算科学中的核心实践。",
            "id": "3913605",
            "problem": "考虑流入半无限多孔介质的一维垂向稳定入渗，该过程在环境与地球系统建模中通过变饱和流的混合形式理查兹方程进行模拟。设 $x$ 表示从地表向下测量的深度，且 $x \\ge 0$。达西通量 $q$ 定义为向下为正。水力水头的表示方式使得通量与压力水头之间的稳态控制关系与所选的符号约定一致，并由下式给出\n$$\nq = K(\\psi)\\left(1 + \\frac{d\\psi}{dx}\\right),\n$$\n其中 $\\psi(x)$ 是压力水头（单位：$\\mathrm{m}$），$K(\\psi)$ 是非饱和导水率（单位：$\\mathrm{m/s}$），项 $1$ 反映了向下坐标约定下的单位重力水头梯度。假设导水率采用 Gardner 模型，\n$$\nK(\\psi) = K_s \\exp(\\alpha \\psi),\n$$\n其中 $K_s$ 是饱和导水率（单位：$\\mathrm{m/s}$），$\\alpha$ 是 Gardner 参数（单位：$\\mathrm{m^{-1}}$）。在半无限域中的稳态流条件下，给定恒定地表水头边界条件 $\\psi(0) = \\psi_0$ 以及当 $x \\to \\infty$ 时压力水头趋于常数 $\\psi_\\infty$ 的远场条件，质量守恒定律意味着通量 $q$ 不随深度变化且满足 $q = K(\\psi_\\infty)$。\n\n从上述基本定律和定义（稳态质量守恒、明确符号约定的达西定律、所选坐标系下的水力水头定义以及 $K(\\psi)$ 的 Gardner 模型）出发，推导在 $x \\in [0,\\infty)$ 上压力水头剖面 $\\psi(x)$ 的解析解，用参数 $K_s$、$\\alpha$、 $q$ 和 $\\psi_0$ 表示。然后，在一个足够深的截断域 $[0,L]$ 上，使用从 $x=0$ 且 $\\psi(0)=\\psi_0$ 开始的稳健初值形式，对稳态常微分方程\n$$\n\\frac{d\\psi}{dx} = \\frac{q}{K(\\psi)} - 1 = \\frac{q}{K_s \\exp(\\alpha \\psi)} - 1,\n$$\n进行数值求解，该截断域需能近似远场条件 $\\psi(x) \\to \\psi_\\infty$，其中 $q = K_s\\exp(\\alpha \\psi_\\infty)$。通过计算在一组指定的采样深度 $\\{x_i\\}$ 上的最大绝对偏差\n$$\n\\Delta_{\\max} = \\max_{x \\in \\{x_i\\}_{i=0}^{N-1}} \\left|\\psi_{\\mathrm{analytic}}(x) - \\psi_{\\mathrm{numeric}}(x)\\right|\n$$\n来比较解析解和数值解。\n\n所有水头单位为 $\\mathrm{m}$，深度单位为 $\\mathrm{m}$，导水率和通量单位为 $\\mathrm{m/s}$。测试用例的最终答案必须是表示 $\\Delta_{\\max}$（单位为 $\\mathrm{m}$）的浮点数。\n\n您的程序必须实现常微分方程的解析解和一个数值求解器，然后对以下每个测试用例（每个测试用例指定 $K_s$（单位 $\\mathrm{m/s}$）、$\\alpha$（单位 $\\mathrm{m^{-1}}$）、$\\psi_0$（单位 $\\mathrm{m}$）、$\\psi_\\infty$（单位 $\\mathrm{m}$）、$L$（单位 $\\mathrm{m}$）和采样点数 $N$）评估 $\\Delta_{\\max}$：\n\n- 情况 A（常规正常路径）：$K_s = 1.0 \\times 10^{-6}\\,\\mathrm{m/s}$，$\\alpha = 4.0\\,\\mathrm{m^{-1}}$，$\\psi_0 = -0.2\\,\\mathrm{m}$，$\\psi_\\infty = -0.5\\,\\mathrm{m}$， $L = 2.0\\,\\mathrm{m}$，$N = 51$。\n- 情况 B（地表水头等于远场水头，导致恒定剖面）：$K_s = 1.0 \\times 10^{-6}\\,\\mathrm{m/s}$，$\\alpha = 4.0\\,\\mathrm{m^{-1}}$，$\\psi_0 = -0.5\\,\\mathrm{m}$，$\\psi_\\infty = -0.5\\,\\mathrm{m}$，$L = 2.0\\,\\mathrm{m}$，$N = 51$。\n- 情况 C（大 $\\alpha$ 值导致在浅域中的急剧过渡）：$K_s = 1.0 \\times 10^{-6}\\,\\mathrm{m/s}$，$\\alpha = 20.0\\,\\mathrm{m^{-1}}$，$\\psi_0 = -0.05\\,\\mathrm{m}$，$\\psi_\\infty = -0.5\\,\\mathrm{m}$，$L = 0.5\\,\\mathrm{m}$，$N = 101$。\n- 情况 D（小 $\\alpha$ 值导致在深域中的缓慢变化）：$K_s = 1.0 \\times 10^{-6}\\,\\mathrm{m/s}$，$\\alpha = 0.5\\,\\mathrm{m^{-1}}$，$\\psi_0 = -0.1\\,\\mathrm{m}$，$\\psi_\\infty = -1.0\\,\\mathrm{m}$，$L = 5.0\\,\\mathrm{m}$，$N = 101$。\n\n对于每种情况，明确使用 $q = K_s \\exp(\\alpha \\psi_\\infty)$。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，“[resultA,resultB,resultC,resultD]”）。每个条目必须是对应情况下 $\\Delta_{\\max}$（单位为 $\\mathrm{m}$）的浮点值。",
            "solution": "用户提供了一个水文地质学和土壤物理学领域的问题，具体涉及一维稳态入渗。任务是首先验证问题的完整性，如果有效，则继续解决它。解决方案包括推导压力水头剖面的解析表达式，为控制性常微分方程（ODE）实现一个数值求解器，并对一组测试用例比较两种解。\n\n### 步骤 1：问题验证\n\n给定条件从问题陈述中逐字提取：\n- 稳态达西通量 $q$ 的控制关系：$q = K(\\psi)\\left(1 + \\frac{d\\psi}{dx}\\right)$\n- 非饱和导水率 $K(\\psi)$ 的 Gardner 模型：$K(\\psi) = K_s \\exp(\\alpha \\psi)$\n- 坐标系：$x$ 是深度，向下为正，$x \\ge 0$。\n- 域：半无限，$[0, \\infty)$。\n- 边界条件：恒定地表水头 $\\psi(0) = \\psi_0$，以及当 $x \\to \\infty$ 时压力水头趋于常数 $\\psi_\\infty$ 的远场条件。\n- 通量条件：根据质量守恒和远场边界条件，恒定通量为 $q = K(\\psi_\\infty)$。\n- 压力水头 $\\psi(x)$ 的常微分方程：$\\frac{d\\psi}{dx} = \\frac{q}{K_s \\exp(\\alpha \\psi)} - 1$。\n- 比较指标：$\\Delta_{\\max} = \\max_{x \\in \\{x_i\\}_{i=0}^{N-1}} \\left|\\psi_{\\mathrm{analytic}}(x) - \\psi_{\\mathrm{numeric}}(x)\\right|$。\n- 测试用例提供了 $K_s$、$\\alpha$、$\\psi_0$、$\\psi_\\infty$、$L$ 和 $N$ 的具体值。\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题基于理查兹方程，这是变饱和流理论的基石。Gardner 导水率模型是一个广泛使用的经验函数。该设置描述了土壤物理学中一个经典的基本问题。该问题是科学合理的。\n- **适定性**：该任务需要求解一个具有给定初始条件的一阶常微分方程。这构成了一个适定的初值问题，预期有唯一解。解析解的推导是微积分中的一个标准练习。\n- **客观与完整**：问题使用精确的数学和物理术语（$q$、$K(\\psi)$、$\\psi$ 等）进行陈述。解析推导和数值求解所需的所有参数、方程和边界条件都已明确提供。\n\n问题陈述没有科学缺陷、矛盾或歧义。它是一个完整、一致且适定的问题，基于已确立的物理原理。\n\n### 结论与行动\n问题是**有效的**。将按照指定的结构提供解决方案。\n\n### 第 1 部分：解析解推导\n压力水头剖面 $\\psi(x)$ 由以下一阶常微分方程控制：\n$$\n\\frac{d\\psi}{dx} = \\frac{q}{K_s \\exp(\\alpha \\psi)} - 1\n$$\n初始条件为 $\\psi(0) = \\psi_0$。这是一个可分离的微分方程。我们可以重新整理它以分离变量 $\\psi$ 和 $x$：\n$$\ndx = \\frac{d\\psi}{\\frac{q}{K_s \\exp(\\alpha \\psi)} - 1}\n$$\n将右侧的分子和分母同乘以 $K_s \\exp(\\alpha \\psi)$ 得：\n$$\ndx = \\frac{K_s \\exp(\\alpha \\psi)}{q - K_s \\exp(\\alpha \\psi)} d\\psi\n$$\n对于入渗到较干燥的土壤中，通常有 $\\psi_0 > \\psi_\\infty$，并且由于 $\\psi$ 为负值且 $\\alpha > 0$，我们有 $K_s \\exp(\\alpha\\psi) \\ge K_s \\exp(\\alpha\\psi_\\infty) = q$。因此，分母 $q - K_s \\exp(\\alpha \\psi)$ 是非正的。我们重写表达式以确保被积函数在积分时是良定义的：\n$$\ndx = - \\frac{K_s \\exp(\\alpha \\psi)}{K_s \\exp(\\alpha \\psi) - q} d\\psi\n$$\n我们对两边进行积分。深度 $x$ 从 $0$ 积分到 $x$，压力水头 $\\psi$ 从地表值 $\\psi_0$ 积分到其在深度 $x$ 处的值 $\\psi(x)$：\n$$\n\\int_0^x dx' = -\\int_{\\psi_0}^{\\psi(x)} \\frac{K_s \\exp(\\alpha \\psi')}{K_s \\exp(\\alpha \\psi') - q} d\\psi'\n$$\n右侧可以使用换元法求解。设 $u = K_s \\exp(\\alpha \\psi') - q$。则其微分为 $du = \\alpha K_s \\exp(\\alpha \\psi') d\\psi'$，这意味着 $K_s \\exp(\\alpha \\psi') d\\psi' = \\frac{1}{\\alpha} du$。积分变为：\n$$\nx = -\\frac{1}{\\alpha} \\int_{u_0}^{u(x)} \\frac{du}{u} = -\\frac{1}{\\alpha} \\left[ \\ln(u) \\right]_{u_0}^{u(x)}\n$$\n其中 $u_0 = K_s \\exp(\\alpha \\psi_0) - q$ 且 $u(x) = K_s \\exp(\\alpha \\psi(x)) - q$。\n$$\nx = -\\frac{1}{\\alpha} \\left[ \\ln(K_s \\exp(\\alpha \\psi(x)) - q) - \\ln(K_s \\exp(\\alpha \\psi_0) - q) \\right]\n$$\n$$\nx = -\\frac{1}{\\alpha} \\ln\\left( \\frac{K_s \\exp(\\alpha \\psi(x)) - q}{K_s \\exp(\\alpha \\psi_0) - q} \\right)\n$$\n为了求 $\\psi(x)$，我们对其进行求解：\n$$\n-\\alpha x = \\ln\\left( \\frac{K_s \\exp(\\alpha \\psi(x)) - q}{K_s \\exp(\\alpha \\psi_0) - q} \\right)\n$$\n$$\n\\exp(-\\alpha x) = \\frac{K_s \\exp(\\alpha \\psi(x)) - q}{K_s \\exp(\\alpha \\psi_0) - q}\n$$\n$$\nK_s \\exp(\\alpha \\psi(x)) - q = (K_s \\exp(\\alpha \\psi_0) - q)\\exp(-\\alpha x)\n$$\n$$\nK_s \\exp(\\alpha \\psi(x)) = q + (K_s \\exp(\\alpha \\psi_0) - q)\\exp(-\\alpha x)\n$$\n两边除以 $K_s$ 并取自然对数，然后再除以 $\\alpha$，得到 $\\psi(x)$ 的显式解：\n$$\n\\psi(x) = \\frac{1}{\\alpha} \\ln\\left[ \\frac{q}{K_s} + \\left(\\exp(\\alpha \\psi_0) - \\frac{q}{K_s}\\right) \\exp(-\\alpha x) \\right]\n$$\n最后，代入给定条件 $q = K(\\psi_\\infty) = K_s \\exp(\\alpha \\psi_\\infty)$，或 $\\frac{q}{K_s} = \\exp(\\alpha \\psi_\\infty)$，我们得到解析解的最终形式：\n$$\n\\psi_{\\mathrm{analytic}}(x) = \\frac{1}{\\alpha} \\ln\\left[ \\exp(\\alpha \\psi_\\infty) + \\left(\\exp(\\alpha \\psi_0) - \\exp(\\alpha \\psi_\\infty)\\right) \\exp(-\\alpha x) \\right]\n$$\n\n### 第 2 部分：数值解与比较\n数值解通过求解由以下定义的初值问题（IVP）获得：\n- ODE: $\\frac{d\\psi}{dx} = \\frac{q}{K_s \\exp(\\alpha \\psi)} - 1$\n- 初始条件: $\\psi(0) = \\psi_0$\n- 积分域: $[0, L]$\n\n此 IVP 使用标准的数值 ODE 求解器求解。Python 库 `scipy` 提供了函数 `scipy.integrate.solve_ivp`，这是一个用于此目的的稳健且通用的工具。对于每个测试用例，使用特定的参数（$K_s$、$\\alpha$、$\\psi_0$、$q$）调用此函数，从 $x=0$ 积分到 $x=L$。解在均匀分布于 $[0, L]$ 上的 $N$ 个点 $\\{x_i\\}$ 的网格上进行评估。\n\n解析解和数值解之间的比较通过最大绝对偏差 $\\Delta_{\\max}$ 来量化。对于每个测试用例，我们计算：\n1. $N$ 个评估点的网格，$x_i = i \\frac{L}{N-1}$，其中 $i=0, 1, \\dots, N-1$。\n2. 使用推导出的公式计算解析解向量 $\\psi_{\\mathrm{analytic}}(x_i)$。\n3. 从 `solve_ivp` 函数获得的数值解向量 $\\psi_{\\mathrm{numeric}}(x_i)$。\n4. 这两个向量之间的最大绝对差：$\\Delta_{\\max} = \\max_{i} |\\psi_{\\mathrm{analytic}}(x_i) - \\psi_{\\mathrm{numeric}}(x_i)|$。\n\n对四个指定的测试用例中的每一个都实施此过程，从而提供了数值求解器相对于精确解析解的准确性度量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the steady infiltration problem for four test cases and prints the maximum deviation\n    between analytical and numerical solutions.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General happy path\n        (1.0e-6, 4.0, -0.2, -0.5, 2.0, 51),\n        # Case B: Constant profile\n        (1.0e-6, 4.0, -0.5, -0.5, 2.0, 51),\n        # Case C: Sharp transition\n        (1.0e-6, 20.0, -0.05, -0.5, 0.5, 101),\n        # Case D: Slow variation\n        (1.0e-6, 0.5, -0.1, -1.0, 5.0, 101),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_max = solve_and_compare_case(*case)\n        results.append(delta_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_and_compare_case(Ks, alpha, psi0, psi_inf, L, N):\n    \"\"\"\n    Derives analytical and numerical solutions for one case and computes the maximum deviation.\n\n    Args:\n        Ks (float): Saturated hydraulic conductivity (m/s).\n        alpha (float): Gardner parameter (m^-1).\n        psi0 (float): Pressure head at the surface (m).\n        psi_inf (float): Pressure head at infinity (m).\n        L (float): Depth of the truncated domain (m).\n        N (int): Number of sampling points.\n\n    Returns:\n        float: The maximum absolute deviation Delta_max (m).\n    \"\"\"\n    # Calculate the steady-state flux q based on the far-field condition\n    q = Ks * np.exp(alpha * psi_inf)\n\n    # Define the grid of points for evaluation\n    x_points = np.linspace(0, L, N)\n\n    # 1. Analytical Solution\n    # The analytical solution is psi(x) = (1/alpha) * ln[exp(alpha*psi_inf) + (exp(alpha*psi0) - exp(alpha*psi_inf)) * exp(-alpha*x)]\n    # We pre-calculate terms to enhance readability and potentially stability\n    exp_alpha_psi_inf = np.exp(alpha * psi_inf)\n    exp_alpha_psi0 = np.exp(alpha * psi0)\n    \n    # Handle the trivial case where psi0 == psi_inf to avoid floating point inaccuracies\n    if np.isclose(psi0, psi_inf):\n        psi_analytic = np.full_like(x_points, psi0)\n    else:\n        # Calculate the argument of the logarithm\n        term_in_ln = exp_alpha_psi_inf + (exp_alpha_psi0 - exp_alpha_psi_inf) * np.exp(-alpha * x_points)\n        psi_analytic = (1 / alpha) * np.log(term_in_ln)\n\n    # 2. Numerical Solution\n    # Define the ODE: d(psi)/dx = q / (Ks * exp(alpha * psi)) - 1\n    def ode_func(x, psi):\n        # The ODE is autonomous (not explicitly dependent on x)\n        # psi is passed as a single-element array by solve_ivp\n        psi_val = psi[0]\n        # Avoid potential overflow/underflow in exp if psi becomes very large/small\n        # though it should be stable for this problem\n        dpsi_dx = (q / (Ks * np.exp(alpha * psi_val))) - 1.0\n        return dpsi_dx\n\n    # Set up and run the ODE solver\n    sol = solve_ivp(\n        fun=ode_func,\n        t_span=(0, L),\n        y0=[psi0],\n        method='RK45',  # Standard robust Runge-Kutta method\n        t_eval=x_points,\n        rtol=1e-8,\n        atol=1e-10\n    )\n    \n    psi_numeric = sol.y[0]\n\n    # 3. Comparison\n    # Calculate the maximum absolute deviation between the two solutions\n    delta_max = np.max(np.abs(psi_analytic - psi_numeric))\n    \n    return delta_max\n\nsolve()\n```"
        }
    ]
}