{
    "hands_on_practices": [
        {
            "introduction": "A primary goal of model spin-up is to minimize long-term drift in key climate variables. This exercise demonstrates the direct consequence of failing to achieve a balanced energy budget. By applying the first law of thermodynamics to a simplified ocean, you will quantify how even a small, persistent heat flux imbalance—a common diagnostic in model output—translates into a significant, long-term trend in global ocean temperature. This fundamental calculation highlights the critical importance of monitoring and reducing such imbalances to ensure a stable model climate. ",
            "id": "3895309",
            "problem": "A global ocean general circulation model is being spun up and exhibits a persistent, spatially uniform net surface heat flux bias of $F_b = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ over the ocean surface. To assess the long-term drift in the globally averaged ocean temperature during spin-up, approximate the ocean as a single, isothermal column of depth $H$ whose temperature $T(t)$ represents the global volume-mean ocean temperature. Assume seawater density $\\rho = 1025\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$ and specific heat at constant pressure $c_p = 3990\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, and take the representative global mean ocean depth to be $H = 3700\\,\\mathrm{m}$. Assume $1$ year equals $365.25$ days and $1$ day equals $86400$ seconds. \n\nUsing the first law of thermodynamics and the definition of heat capacity, derive from first principles the expression for the tendency of the globally averaged ocean temperature due to the imposed flux bias. Then compute the centennial-scale trend (the change over $100$ years) in globally averaged ocean temperature implied by the flux bias, and express your final numerical answer in kelvin per century. Round your numerical answer to three significant figures.\n\nAs an acceptability benchmark for spin-up, a drift magnitude smaller than $0.02\\,\\mathrm{K}$ per century is considered acceptable. In your reasoning, assess whether the implied centennial drift meets this criterion. The final reported answer must be only the calculated centennial trend value.",
            "solution": "The problem requires the derivation of the temperature tendency for a simplified ocean model subjected to a persistent surface heat flux bias, and the subsequent calculation of the centennial temperature trend. This problem is physically well-posed and can be solved using the first law of thermodynamics.\n\nWe begin by applying the first law of thermodynamics, which states that the rate of change of internal energy of a system, $\\frac{dU}{dt}$, is equal to the net rate of heat transfer into the system, $\\dot{Q}$.\n$$\n\\frac{dU}{dt} = \\dot{Q}\n$$\nThe system under consideration is the global ocean, which is modeled as a single, isothermal column of water with a representative surface area $A$ and a constant depth $H$. The temperature $T(t)$ is uniform throughout this volume.\n\nThe change in internal energy $dU$ of a mass $m$ of a substance with specific heat capacity $c_p$ corresponding to a small change in temperature $dT$ is given by $dU = m c_p dT$. The mass of the water column is $m = \\rho V = \\rho A H$, where $\\rho$ is the density of seawater and $V$ is the volume. Therefore, the rate of change of the internal energy of the water column is:\n$$\n\\frac{dU}{dt} = \\frac{d}{dt}(m c_p T) = m c_p \\frac{dT}{dt} = (\\rho A H) c_p \\frac{dT}{dt}\n$$\nThis assumes that $\\rho$, $A$, $H$, and $c_p$ are constant in time.\n\nThe heat is transferred into the ocean at the surface. The problem states a spatially uniform net surface heat flux bias, $F_b$, which is defined as the rate of heat energy transfer per unit surface area. The total rate of heat transfer into the ocean column with surface area $A$ is therefore:\n$$\n\\dot{Q} = F_b A\n$$\nEquating the rate of change of internal energy with the rate of heat transfer according to the first law of thermodynamics:\n$$\n(\\rho A H) c_p \\frac{dT}{dt} = F_b A\n$$\nThe area term $A$ appears on both sides of the equation and can be canceled. This is expected, as the result for the temperature tendency of a globally averaged quantity should not depend on the arbitrary surface area chosen for the analysis. We obtain the expression for the tendency of the globally averaged ocean temperature:\n$$\n\\frac{dT}{dt} = \\frac{F_b}{\\rho c_p H}\n$$\nThis is the derived expression from first principles.\n\nNext, we compute the centennial-scale temperature trend. This is the total change in temperature, $\\Delta T_{century}$, over a period of $\\Delta t = 100$ years. Since the heat flux bias $F_b$ and the ocean properties ($\\rho$, $c_p$, $H$) are assumed to be constant, the temperature tendency $\\frac{dT}{dt}$ is also constant. The total temperature change is then the rate of change multiplied by the time interval:\n$$\n\\Delta T_{century} = \\frac{dT}{dt} \\times \\Delta t = \\frac{F_b \\Delta t}{\\rho c_p H}\n$$\nWe are given the following values:\nNet surface heat flux bias, $F_b = 0.5\\,\\text{W}\\,\\text{m}^{-2} = 0.5\\,\\text{J}\\,\\text{s}^{-1}\\,\\text{m}^{-2}$.\nSeawater density, $\\rho = 1025\\,\\text{kg}\\,\\text{m}^{-3}$.\nSpecific heat of seawater, $c_p = 3990\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\nMean ocean depth, $H = 3700\\,\\text{m}$.\n\nThe time interval $\\Delta t$ for one century must be converted to seconds:\n$$\n\\Delta t = 100\\,\\text{years} \\times 365.25\\,\\frac{\\text{days}}{\\text{year}} \\times 86400\\,\\frac{\\text{s}}{\\text{day}} = 3.15576 \\times 10^9\\,\\text{s}\n$$\nNow, we can substitute these numerical values into the expression for $\\Delta T_{century}$. First, let's calculate the term in the denominator, which represents the heat capacity of the ocean column per unit area:\n$$\n\\rho c_p H = (1025\\,\\text{kg}\\,\\text{m}^{-3}) \\times (3990\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}) \\times (3700\\,\\text{m}) = 1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\nNow we compute the centennial temperature change:\n$$\n\\Delta T_{century} = \\frac{(0.5\\,\\text{J}\\,\\text{s}^{-1}\\,\\text{m}^{-2}) \\times (3.15576 \\times 10^9\\,\\text{s})}{1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}}\n$$\n$$\n\\Delta T_{century} = \\frac{1.57788 \\times 10^9\\,\\text{J}\\,\\text{m}^{-2}}{1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}} \\approx 0.10432509\\,\\text{K}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\Delta T_{century} \\approx 0.104\\,\\text{K}\n$$\nSo, the centennial-scale trend is $0.104\\,\\text{K}$ per century.\n\nFinally, we assess this result against the provided acceptability benchmark. The benchmark for spin-up requires the drift magnitude to be smaller than $0.02\\,\\text{K}$ per century. The calculated drift is $0.104\\,\\text{K}$ per century. Since $0.104 > 0.02$, the model's centennial drift under this persistent heat flux bias does not meet the acceptability criterion. It is too large by a factor of more than $5$.",
            "answer": "$$\\boxed{0.104}$$"
        },
        {
            "introduction": "Earth System Models are composed of interconnected components with vastly different response times. This exercise explores the classic example of the ocean, which has a rapidly adjusting surface mixed layer and a slowly equilibrating deep abyss. By formulating and solving a two-box ocean model, you will derive the two characteristic spin-up timescales that govern the system's thermal adjustment. This analysis reveals why coupled systems exhibit multi-timescale behavior and why achieving full equilibrium in components like the deep ocean is a process that can span centuries to millennia. ",
            "id": "3895353",
            "problem": "A vertically integrated two-box ocean thermal model is composed of an upper mixed layer of depth $H_1$ overlying a deep layer of depth $H_2$. Let the horizontal area be uniform and work per unit area in the vertical column. Assume constant seawater density $\\rho$ and specific heat capacity $c_p$, so that the heat capacities per unit area are $C_1 = \\rho c_p H_1$ for the mixed layer and $C_2 = \\rho c_p H_2$ for the deep layer. The two layers exchange heat through a bulk interfacial exchange represented by a first-order rate constant $k$ with units of $\\mathrm{s}^{-1}$, such that the interfacial heat flux per unit area is $C_1 k (T_1 - T_2)$ from the mixed layer temperature $T_1$ to the deep layer temperature $T_2$. The mixed layer also exchanges heat with the overlying atmosphere, which is held at a fixed temperature anomaly set to zero, through a linearized surface heat exchange coefficient $h$ with units of $\\mathrm{W\\, m^{-2}\\, K^{-1}}$, yielding a net surface heat flux $-h T_1$ (negative when the ocean is warmer than the atmosphere). Consider small perturbations, ignore horizontal processes, and take all coefficients to be constant in time.\n\nStarting from conservation of energy in each layer, write the governing linear system for $(T_1, T_2)$ and, focusing on the homogeneous adjustment (i.e., without explicit external forcing), derive in closed form the two characteristic thermal spin-up timescales, defined as the reciprocals of the magnitudes of the two eigenvalues of the linear operator governing $(T_1, T_2)$. Express both timescales explicitly in terms of $k$, $H_1$, $H_2$, $\\rho$, $c_p$, and $h$. Assume all parameters are provided in International System of Units so that the timescales are in seconds. Provide the pair of timescales as a closed-form analytic expression. Do not substitute numerical values and do not round.",
            "solution": "The appropriate starting point is conservation of energy for each layer. Working per unit horizontal area, the heat content tendency in each layer equals the sum of vertical and surface heat fluxes. With $C_1 = \\rho c_p H_1$ and $C_2 = \\rho c_p H_2$, the interfacial exchange flux from layer $1$ to layer $2$ is $C_1 k (T_1 - T_2)$, which is positive when $T_1 > T_2$. The surface heat flux into the ocean (positive downward) is $-h T_1$ for perturbations about zero atmospheric anomaly. Therefore, the prognostic equations are\n$$\nC_1 \\frac{d T_1}{d t} = -h\\, T_1 - C_1 k \\left(T_1 - T_2\\right),\n$$\n$$\nC_2 \\frac{d T_2}{d t} = +C_1 k \\left(T_1 - T_2\\right).\n$$\nThese equations conserve total heat in the absence of surface exchange because the interfacial flux is equal and opposite across the interface. We can write the homogeneous linear system in matrix form as\n$$\n\\frac{d}{d t}\n\\begin{pmatrix}\nT_1 \\\\\nT_2\n\\end{pmatrix}\n=\n\\mathbf{A}\n\\begin{pmatrix}\nT_1 \\\\\nT_2\n\\end{pmatrix},\n\\quad\n\\mathbf{A}\n=\n\\begin{pmatrix}\n-\\dfrac{h}{C_1} - k & k \\\\\n\\dfrac{C_1}{C_2} k & -\\dfrac{C_1}{C_2} k\n\\end{pmatrix}.\n$$\nThe characteristic thermal spin-up timescales are determined by the eigenvalues of $\\mathbf{A}$. Let $\\lambda$ denote an eigenvalue of $\\mathbf{A}$. The characteristic polynomial is\n$$\n\\det\\!\\left(\\mathbf{A} - \\lambda \\mathbf{I}\\right)\n=\n\\left(-\\frac{h}{C_1} - k - \\lambda\\right)\\left(-\\frac{C_1}{C_2} k - \\lambda\\right) - k\\, \\frac{C_1}{C_2} k\n= 0.\n$$\nIntroduce the shorthand\n$$\n\\alpha \\equiv \\frac{h}{C_1}, \\qquad r \\equiv \\frac{C_1}{C_2} = \\frac{H_1}{H_2},\n$$\nso that the characteristic equation becomes\n$$\n\\left(-\\alpha - k - \\lambda\\right)\\left(-r k - \\lambda\\right) - r k^2 = 0.\n$$\nMultiplying out and simplifying yields\n$$\n\\lambda^2 + \\left[(\\alpha + k) + r k\\right]\\lambda + \\alpha r k = 0.\n$$\nThis quadratic has two real negative roots (since all coefficients are positive), given by\n$$\n\\lambda_{1,2}\n=\n\\frac{-\\left[(\\alpha + k) + r k\\right] \\pm \\sqrt{\\left[(\\alpha + k) + r k\\right]^2 - 4 \\alpha r k}}{2}.\n$$\nDefine\n$$\nS \\equiv (\\alpha + k) + r k = \\frac{h}{C_1} + k\\left(1 + \\frac{H_1}{H_2}\\right),\n$$\nand note that\n$$\n\\alpha r k = \\frac{h}{C_1}\\,\\frac{C_1}{C_2}\\,k = \\frac{h k}{C_2} = \\frac{h k}{\\rho c_p H_2}.\n$$\nThen the eigenvalues can be written compactly as\n$$\n\\lambda_{1,2} = \\frac{-S \\pm \\sqrt{S^2 - 4 \\alpha r k}}{2}.\n$$\nBecause $S > 0$ and $S^2 \\ge 4 \\alpha r k$ for positive parameters, both eigenvalues are real and negative. The two characteristic e-folding timescales controlling thermal spin-up are the reciprocals of the magnitudes of these eigenvalues:\n$$\n\\tau_{1} = \\frac{1}{|\\lambda_{1}|} = \\frac{2}{S + \\sqrt{S^2 - 4 \\alpha r k}},\n\\qquad\n\\tau_{2} = \\frac{1}{|\\lambda_{2}|} = \\frac{2}{S - \\sqrt{S^2 - 4 \\alpha r k}}.\n$$\nExpressing $C_1$ and $C_2$ explicitly in terms of the given physical parameters,\n$$\nC_1 = \\rho c_p H_1,\n\\qquad\nC_2 = \\rho c_p H_2,\n$$\nwe have\n$$\nS = \\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right),\n\\qquad\n4 \\alpha r k = \\frac{4 h k}{\\rho c_p H_2}.\n$$\nHence the two closed-form timescales in seconds are\n$$\n\\tau_{1} = \\frac{2}{\\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right) + \\sqrt{\\left[\\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right)\\right]^2 - \\frac{4 h k}{\\rho c_p H_2}}} ,\n$$\n$$\n\\tau_{2} = \\frac{2}{\\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right) - \\sqrt{\\left[\\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right)\\right]^2 - \\frac{4 h k}{\\rho c_p H_2}}} .\n$$\nThese are the two characteristic thermal spin-up timescales of the coupled mixed layer–deep ocean two-box system, determined by conservation of energy and linear surface and interfacial exchanges.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) + \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^{2} - \\dfrac{4 h k}{\\rho c_p H_2}}} & \\dfrac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) - \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^{2} - \\dfrac{4 h k}{\\rho c_p H_2}}}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Once a model has been run for a long period, how do we assess whether it has successfully spun-up? This hands-on programming exercise provides a practical framework for diagnosing the state of a prognostic tracer like carbon. You will learn to analyze model output to compute two key metrics: the linear trend, which quantifies physical drift, and the budget residual, which quantifies numerical conservation error. Mastering this diagnostic  is essential for distinguishing a model that is still equilibrating from one that may have fundamental flaws in its implementation.",
            "id": "3895292",
            "problem": "Consider a global carbon budget in an Earth System Model (ESM). During model spin-up, a common diagnostic is to assess mass conservation and near-equilibrium behavior of a prognostic carbon pool by comparing its discrete-time tendency to the net external carbon flux. Let the global pool mass be a time series $\\{M_k\\}_{k=0}^{T-1}$ in petagrams of carbon (Pg C), observed at uniform time spacing $\\Delta t$ in years, and let the corresponding net external flux time series be $\\{F_k\\}_{k=0}^{T-2}$ in petagrams of carbon per year (Pg C yr$^{-1}$), defined over the intervals $[k\\Delta t,(k+1)\\Delta t]$. The fundamental conservation law at the global scale states that the rate of change of the total pool mass equals the net external flux, so that in the continuous-time limit $\\frac{dM}{dt} = F_{\\text{net}}(t)$. In discrete time, define the residual budget time series (with flux units) over intervals by\n$$\nr_k \\equiv \\frac{M_{k+1}-M_k}{\\Delta t} - F_k \\quad \\text{for } k=0,1,\\dots,T-2.\n$$\nDefine the root-mean-square residual by\n$$\nr_{\\mathrm{rms}} \\equiv \\sqrt{\\frac{1}{T-1}\\sum_{k=0}^{T-2} r_k^2}.\n$$\nTo assess spin-up, also quantify drift in the pool mass via the least-squares linear trend of $M_k$ versus time $t_k = k \\Delta t$. Let $s$ denote the ordinary least-squares slope of the regression $M_k \\approx s\\, t_k + b$, so $s$ has units of Pg C yr$^{-1}$. Introduce two tolerances: a numerical closure tolerance $\\varepsilon_r$ (Pg C yr$^{-1}$) and a drift tolerance $\\varepsilon_s$ (Pg C yr$^{-1}$). Classify each time series according to the following integer code:\n- $0$: numerically closed and no drift, i.e., $r_{\\mathrm{rms}} \\le \\varepsilon_r$ and $|s| \\le \\varepsilon_s$.\n- $1$: drift only, i.e., $r_{\\mathrm{rms}} \\le \\varepsilon_r$ and $|s| > \\varepsilon_s$.\n- $2$: numerical error only, i.e., $r_{\\mathrm{rms}} > \\varepsilon_r$ and $|s| \\le \\varepsilon_s$.\n- $3$: both drift and numerical error, i.e., $r_{\\mathrm{rms}} > \\varepsilon_r$ and $|s| > \\varepsilon_s$.\n\nYour task is to write a program that, for each provided test case, computes the residual time series $\\{r_k\\}$, the statistic $r_{\\mathrm{rms}}$, the slope $s$, applies the classification rules above with the given tolerances, and returns the classification code.\n\nUse the following constants and test suite. All pool masses must be treated as Pg C, all fluxes as Pg C yr$^{-1}$, all time steps as years, and all slopes and residual statistics as Pg C yr$^{-1}$.\n- Tolerances: $\\varepsilon_r = 0.05$ and $\\varepsilon_s = 0.10$.\n- Uniform time step: $\\Delta t = 1.0$.\n\nTest cases (each test case provides $\\{M_k\\}$ and $\\{F_k\\}$ with lengths $T$ and $T-1$, respectively):\n- Case A (balanced steady): $M = [1000.0, 1000.0, 1000.0, 1000.0, 1000.0]$, $F = [0.0, 0.0, 0.0, 0.0]$.\n- Case B (drift but numerically consistent): $M = [1000.0, 1005.0, 1010.0, 1015.0, 1020.0]$, $F = [5.0, 5.0, 5.0, 5.0]$.\n- Case C (numerical error without drift): $M = [1000.0, 1000.0, 1000.0, 1000.0, 1000.0]$, $F = [0.2, -0.2, 0.2, -0.2]$.\n- Case D (both drift and numerical error): $M = [1000.0, 1005.0, 1010.0, 1015.0, 1020.0]$, $F = [3.0, 3.0, 3.0, 3.0]$.\n- Case E (boundary at tolerances): $M = [1000.0, 1000.1, 1000.2, 1000.3, 1000.4]$, $F = [0.05, 0.05, 0.05, 0.05]$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above (A through E). Each result must be an integer classification code as defined above, so the required output format is of the form $\\texttt{[c_A,c_B,c_C,c_D,c_E]}$ with each $\\texttt{c_*}$ an integer.",
            "solution": "The problem presents a valid and well-posed task from the domain of Earth System Modeling diagnostics. All provided data, definitions, and constants are self-contained, scientifically grounded, and free from contradiction or ambiguity. The task is to classify the state of a carbon pool time series based on two metrics: numerical budget closure and long-term drift. We will proceed with a step-by-step solution.\n\nThe methodology involves two primary calculations for each test case: the root-mean-square (RMS) residual budget, $r_{\\mathrm{rms}}$, and the linear trend of the pool mass, $s$. These two quantities are then compared against specified tolerances to determine a classification code.\n\n**1. Calculation of the RMS Residual Budget ($r_{\\mathrm{rms}}$)**\n\nThe fundamental principle is mass conservation, which in its continuous form states that the rate of change of the total mass $M$ must equal the net external flux $F_{\\text{net}}$, i.e., $\\frac{dM}{dt} = F_{\\text{net}}(t)$. The problem provides a discrete-time formulation to assess how well this principle is upheld by the model's numerical scheme.\n\nGiven a time series of mass $\\{M_k\\}_{k=0}^{T-1}$ sampled at a uniform time step $\\Delta t$, the discrete-time approximation of the rate of change over the interval $[k\\Delta t, (k+1)\\Delta t]$ is the forward difference $(M_{k+1}-M_k)/\\Delta t$.\n\nThe residual, $r_k$, measures the discrepancy between this computed tendency and the given net external flux $F_k$ over the same interval. It is defined as:\n$$\nr_k \\equiv \\frac{M_{k+1}-M_k}{\\Delta t} - F_k \\quad \\text{for } k=0, 1, \\dots, T-2.\n$$\nA non-zero $r_k$ indicates a numerical imbalance, meaning carbon is not perfectly conserved by the model's time-stepping algorithm over that interval.\n\nTo obtain a single metric representing the overall magnitude of this numerical error across the entire simulation period, we calculate the root-mean-square residual, $r_{\\mathrm{rms}}$:\n$$\nr_{\\mathrm{rms}} \\equiv \\sqrt{\\frac{1}{T-1}\\sum_{k=0}^{T-2} r_k^2}.\n$$\nThis statistic provides the typical magnitude of the budget closure error in units of flux (Pg C yr$^{-1}$).\n\n**2. Calculation of the Mass Pool Drift ($s$)**\n\nDuring model spin-up, the goal is to reach a quasi-equilibrium state where prognostic variables, like the carbon pool mass $M$, are no longer exhibiting a significant long-term trend. This trend, or drift, is assessed independently of the short-term numerical closure.\n\nWe quantify the drift by determining the slope of the best-fit line to the mass data $M_k$ as a function of time $t_k = k \\Delta t$. This is a standard simple linear regression problem, where we seek parameters $s$ (slope) and $b$ (intercept) for the model:\n$$\nM_k \\approx s \\cdot t_k + b.\n$$\nThe slope $s$, which represents the average rate of change of mass over the time series, is calculated using the method of ordinary least squares (OLS). The OLS procedure finds the value of $s$ that minimizes the sum of the squared differences between the observed masses $M_k$ and the values predicted by the linear model. The resulting slope $s$ has units of Pg C yr$^{-1}$ and serves as our metric for drift.\n\n**3. Classification Logic**\n\nWith $r_{\\mathrm{rms}}$ and $s$ computed, we classify the time series using the provided tolerances $\\varepsilon_r = 0.05$ Pg C yr$^{-1}$ and $\\varepsilon_s = 0.10$ Pg C yr$^{-1}$. The absolute value of the slope, $|s|$, is used for the drift check. The classification rules are as follows:\n\n- **Code 0 (Numerically Closed, No Drift):** If $r_{\\mathrm{rms}} \\le \\varepsilon_r$ and $|s| \\le \\varepsilon_s$. The model is conserving mass adequately and has reached a stable state.\n- **Code 1 (Drift Only):** If $r_{\\mathrm{rms}} \\le \\varepsilon_r$ and $|s| > \\varepsilon_s$. The model's numerics are sound, but the system has not yet reached equilibrium and is still drifting.\n- **Code 2 (Numerical Error Only):** If $r_{\\mathrm{rms}} > \\varepsilon_r$ and $|s| \\le \\varepsilon_s$. The system is in a quasi-steady state (no long-term trend), but there are numerical issues causing poor mass conservation on a time-step basis.\n- **Code 3 (Both Drift and Numerical Error):** If $r_{\\mathrm{rms}} > \\varepsilon_r$ and $|s| > \\varepsilon_s$. The model suffers from both a failure to conserve mass and an ongoing, long-term trend.\n\nThis procedure will be systematically applied to each of the five test cases to generate the final list of integer codes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spin-up diagnostics for a series of carbon pool time series\n    and classifies them based on numerical closure and drift.\n    \"\"\"\n    # Define constants and tolerances from the problem statement.\n    epsilon_r = 0.05  # Numerical closure tolerance (Pg C yr^-1)\n    epsilon_s = 0.10  # Drift tolerance (Pg C yr^-1)\n    delta_t = 1.0     # Uniform time step (yr)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (balanced steady)\n        {'M': [1000.0, 1000.0, 1000.0, 1000.0, 1000.0], 'F': [0.0, 0.0, 0.0, 0.0]},\n        # Case B (drift but numerically consistent)\n        {'M': [1000.0, 1005.0, 1010.0, 1015.0, 1020.0], 'F': [5.0, 5.0, 5.0, 5.0]},\n        # Case C (numerical error without drift)\n        {'M': [1000.0, 1000.0, 1000.0, 1000.0, 1000.0], 'F': [0.2, -0.2, 0.2, -0.2]},\n        # Case D (both drift and numerical error)\n        {'M': [1000.0, 1005.0, 1010.0, 1015.0, 1020.0], 'F': [3.0, 3.0, 3.0, 3.0]},\n        # Case E (boundary at tolerances)\n        {'M': [1000.0, 1000.1, 1000.2, 1000.3, 1000.4], 'F': [0.05, 0.05, 0.05, 0.05]},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        M = np.array(case['M'], dtype=np.float64)\n        F = np.array(case['F'], dtype=np.float64)\n        \n        T = len(M)\n        \n        # 1. Calculate the residual budget time series {r_k}\n        # Discrete-time tendency: (M_{k+1} - M_k) / delta_t\n        tendency = (M[1:] - M[:-1]) / delta_t\n        r_k = tendency - F\n        \n        # 2. Calculate the root-mean-square residual r_rms\n        # r_rms = sqrt( (1/(T-1)) * sum(r_k^2) )\n        # np.mean(r_k**2) is equivalent since r_k has length T-1\n        r_rms = np.sqrt(np.mean(np.square(r_k)))\n        \n        # 3. Calculate the linear trend slope s of the mass pool M_k\n        # M_k vs t_k, where t_k = k * delta_t\n        t_k = np.arange(T) * delta_t\n        # np.polyfit(x, y, 1) returns [slope, intercept] for a linear fit\n        s, _ = np.polyfit(t_k, M, 1)\n        \n        # 4. Apply classification rules\n        is_closed = r_rms = epsilon_r\n        is_no_drift = abs(s) = epsilon_s\n        \n        code = -1 # Initialize with an invalid code\n        if is_closed and is_no_drift:\n            code = 0  # Numerically closed and no drift\n        elif is_closed and not is_no_drift:\n            code = 1  # Drift only\n        elif not is_closed and is_no_drift:\n            code = 2  # Numerical error only\n        elif not is_closed and not is_no_drift:\n            code = 3  # Both drift and numerical error\n            \n        results.append(code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}