{
    "hands_on_practices": [
        {
            "introduction": "在对地球系统模型进行验证之前，一个关键的实践步骤是确保模型已经达到了一个统计上的稳定状态，即所谓的“spin-up”完成。这个练习将探讨如何通过分析模型线性化后的动力学特性来估算必要的spin-up时间。通过计算雅可比矩阵的特征值，我们可以识别出系统中最慢衰减的模态，并以此为依据，确保初始扰动已经充分衰减，从而使后续的模型-观测比较具有物理意义 。",
            "id": "3895979",
            "problem": "考虑一个正在进行自旋加速（spin-up）的地球系统模型（ESM），该模型的验证要求初始瞬变充分衰减，以便可以将诊断量与观测值进行有意义的比较。在一个统计稳态参考态附近，设预报状态向量异常 $\\mathbf{y}(t) = \\mathbf{x}(t) - \\mathbf{x}^{\\ast}$ 由切线线性近似导出的线性化系统控制，\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{J}\\,\\mathbf{y},\n$$\n其中 $\\mathbf{J}$ 是在 $\\mathbf{x}^{\\ast}$ 处评估的非线性趋势的雅可比矩阵。假设\n$$\n\\mathbf{J} = \n\\begin{pmatrix}\n-0.3  0.1  0 \\\\\n0.2  -0.5  0 \\\\\n0  0  -0.07\n\\end{pmatrix}\n\\quad \\text{天}^{-1},\n$$\n且初始异常为\n$$\n\\mathbf{y}(0) = \n\\begin{pmatrix}\n0.03 \\\\\n-0.02 \\\\\n0.50\n\\end{pmatrix}.\n$$\n一个常见的用于验证的自旋加速准则是异常范数低于一个固定的容差，此处设为欧几里得范数阈值\n$$\n\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon,\n\\quad \\text{其中} \\quad\n\\varepsilon = 10^{-3}.\n$$\n使用雅可比矩阵 $\\mathbf{J}$ 的特征值分析，并从线性系统和矩阵指数的第一性原理出发，基于初始瞬变的衰减推导出一个有原理依据的自旋加速时间估计。然后，在最慢衰减且具有非零投影的特征模决定时间尺度的保守假设下，计算上述系统的自旋加速时间，以保证满足准则 $\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon$。将您的答案四舍五入到三位有效数字。以天为单位表示自旋加速时间。",
            "solution": "问题是确定线性化地球系统模型（ESM）的自旋加速时间，即找到所需的时间 $t$，使得状态向量异常的欧几里得范数 $\\|\\mathbf{y}(t)\\|_{2}$ 降至给定阈值 $\\varepsilon$ 以下。\n\n该问题由以下常微分方程线性系统控制：\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{J}\\,\\mathbf{y}\n$$\n其初始条件为 $\\mathbf{y}(0)$。该初值问题的形式解由下式给出：\n$$\n\\mathbf{y}(t) = \\exp(\\mathbf{J}t)\\mathbf{y}(0)\n$$\n其中 $\\exp(\\mathbf{J}t)$ 是矩阵指数。\n\n为分析 $\\mathbf{y}(t)$ 的行为，我们将解分解为雅可比矩阵 $\\mathbf{J}$ 的特征值和特征向量。如果 $\\mathbf{J}$ 可对角化，其特征值为 $\\lambda_i$，对应的特征向量为 $\\mathbf{v}_i$，我们可以将初始条件 $\\mathbf{y}(0)$ 表示为这些特征向量的线性组合：\n$$\n\\mathbf{y}(0) = \\sum_{i=1}^{n} c_i \\mathbf{v}_i\n$$\n其中 $c_i$ 是标量系数。那么在时间 $t$ 的解由下式给出：\n$$\n\\mathbf{y}(t) = \\sum_{i=1}^{n} c_i \\exp(\\lambda_i t) \\mathbf{v}_i\n$$\n特征值 $\\lambda_i$ 决定了每个模态的时间演化。对于一个接近稳态的稳定系统，所有特征值的实部都必须为负，即 $\\text{Re}(\\lambda_i)  0$。每个模态的衰减速率由 $|\\text{Re}(\\lambda_i)|$ 给出。“最慢衰减特征模”对应于具有最小非零绝对值实部的特征值 $\\lambda_s$，即 $\\lambda_s = \\arg \\min_{\\lambda_i} \\{|\\text{Re}(\\lambda_i)| : \\text{Re}(\\lambda_i)  0\\}$。对于较大的时间 $t$，对应于该特征值的项将在总和中占主导地位，因为所有其他项都已更快地衰减。\n\n首先，我们必须求出给定雅可比矩阵的特征值：\n$$\n\\mathbf{J} = \n\\begin{pmatrix}\n-0.3  0.1  0 \\\\\n0.2  -0.5  0 \\\\\n0  0  -0.07\n\\end{pmatrix}\n$$\n矩阵 $\\mathbf{J}$ 是块对角矩阵，这简化了特征值问题。其特征值就是对角块的特征值。\n一个块是标量 $-0.07$，因此可以立即确定一个特征值为：\n$$\n\\lambda_3 = -0.07\n$$\n另一个块是 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{J}_{12} = \n\\begin{pmatrix}\n-0.3  0.1 \\\\\n0.2  -0.5\n\\end{pmatrix}\n$$\n该块的特征值是特征方程 $\\det(\\mathbf{J}_{12} - \\lambda\\mathbf{I}) = 0$ 的根。\n$$\n(-0.3 - \\lambda)(-0.5 - \\lambda) - (0.1)(0.2) = 0\n$$\n$$\n\\lambda^2 + 0.8\\lambda + 0.15 - 0.02 = 0\n$$\n$$\n\\lambda^2 + 0.8\\lambda + 0.13 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{-0.8 \\pm \\sqrt{0.8^2 - 4(1)(0.13)}}{2} = \\frac{-0.8 \\pm \\sqrt{0.64 - 0.52}}{2} = \\frac{-0.8 \\pm \\sqrt{0.12}}{2}\n$$\n$$\n\\lambda = -0.4 \\pm \\sqrt{\\frac{0.12}{4}} = -0.4 \\pm \\sqrt{0.03}\n$$\n所以另外两个特征值为：\n$$\n\\lambda_1 = -0.4 - \\sqrt{0.03} \\approx -0.5732\n$$\n$$\n\\lambda_2 = -0.4 + \\sqrt{0.03} \\approx -0.2268\n$$\n$\\mathbf{J}$ 的三个特征值均为实数且为负：\n$\\lambda_1 \\approx -0.5732$，$\\lambda_2 \\approx -0.2268$，以及 $\\lambda_3 = -0.07$。\n\n最慢衰减模态对应于绝对值最小的特征值：\n$$\n|\\lambda_1| \\approx 0.5732 \\quad \\text{天}^{-1}\n$$\n$$\n|\\lambda_2| \\approx 0.2268 \\quad \\text{天}^{-1}\n$$\n$$\n|\\lambda_3| = 0.07 \\quad \\text{天}^{-1}\n$$\n最慢模态与 $\\lambda_3 = -0.07 \\, \\text{天}^{-1}$ 相关联。\n\n问题要求该模态具有“非零投影”。块对角结构意味着系统是解耦的。状态 $\\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$ 的演化与 $y_3$ 无关。对应于 $\\lambda_3 = -0.07$ 的特征向量在第三个坐标轴方向上，即 $\\mathbf{v}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。初始条件 $\\mathbf{y}(0)$ 在该模态上的投影就是它的第三个分量。\n给定 $\\mathbf{y}(0) = \\begin{pmatrix} 0.03 \\\\ -0.02 \\\\ 0.50 \\end{pmatrix}$，第三个分量是 $y_3(0) = 0.50$。由于它非零，最慢模态被激发。\n\n第三个分量的解是：\n$$\ny_3(t) = y_3(0) \\exp(\\lambda_3 t) = 0.50 \\exp(-0.07 t)\n$$\n另外两个分量 $\\mathbf{y}_{12}(t) = \\begin{pmatrix} y_1(t) \\\\ y_2(t) \\end{pmatrix}$ 的解根据 $\\exp(\\lambda_1 t)$ 和 $\\exp(\\lambda_2 t)$ 衰减。由于 $|\\lambda_1|$ 和 $|\\lambda_2|$ 都显著大于 $|\\lambda_3|$，$\\mathbf{y}_{12}$ 分量将比 $y_3$ 分量快得多地衰减到零。\n为了计算自旋加速时间，我们关心大时间 $t$ 时的行为，此时最慢模态主导动力学。因此，我们可以将状态向量近似为：\n$$\n\\mathbf{y}(t) \\approx \\begin{pmatrix} 0 \\\\ 0 \\\\ y_3(t) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0.50 \\exp(-0.07 t) \\end{pmatrix}\n$$\n自旋加速准则为 $\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon$，其中 $\\varepsilon = 10^{-3}$。我们将此应用于我们的近似，以在指定假设下找到保证条件满足的时间 $t_{spinup}$。\n$$\n\\|\\mathbf{y}(t_{spinup})\\|_{2} \\approx \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ 0.50 \\exp(-0.07 t_{spinup}) \\end{pmatrix} \\right\\|_{2} = 0.50 \\exp(-0.07 t_{spinup})\n$$\n我们令其等于阈值 $\\varepsilon$：\n$$\n0.50 \\exp(-0.07 t_{spinup}) = 10^{-3}\n$$\n现在，我们求解 $t_{spinup}$：\n$$\n\\exp(-0.07 t_{spinup}) = \\frac{10^{-3}}{0.50} = 2 \\times 10^{-3}\n$$\n对两边取自然对数：\n$$\n-0.07 t_{spinup} = \\ln(2 \\times 10^{-3})\n$$\n$$\nt_{spinup} = -\\frac{\\ln(2 \\times 10^{-3})}{0.07}\n$$\n现在我们计算数值：\n$$\nt_{spinup} = -\\frac{\\ln(0.002)}{0.07} \\approx -\\frac{-6.214608}{0.07} \\approx 88.78011 \\ldots\n$$\n将答案四舍五入到三位有效数字，我们得到：\n$$\nt_{spinup} \\approx 88.8 \\, \\text{天}\n$$\n这是基于最慢被激发模态的动力学，瞬态异常的范数衰减到指定容差以下所需的估计时间。",
            "answer": "$$\\boxed{88.8}$$"
        },
        {
            "introduction": "当我们评估模型性能时，通常会分析模型输出与观测数据之间的残差序列，但这些时间序列数据往往不是相互独立的，而是存在自相关性。这个练习将引导你处理这一常见挑战，即如何量化自相关性对验证指标统计不确定性的影响。你将推导出有效样本量的概念，并展示它如何修正我们对模型偏差等指标的置信区间，这对于做出可靠的科学结论至关重要 。",
            "id": "3895941",
            "problem": "一个水文模型正在用观测的日径流量进行验证。令残差序列 $\\{e_t\\}_{t=1}^{n}$ 表示模型值与观测值之差。一个关键性能指标是平均偏差，其计算方式为样本均值 $\\bar{e} = \\frac{1}{n}\\sum_{t=1}^{n} e_t$。假设残差是均值为零的弱平稳序列，并服从一阶自回归（AR）结构：其滞后$k$自相关为 $\\rho_k$，且满足 $\\rho_k = \\phi^{k}$，其中 $|\\phi|  1$。假定 $n$ 足够大，可以忽略末端效应。\n\n从弱平稳过程的方差、协方差和自协方差的定义出发，推导有效样本量 $n_{\\text{eff}}$ 的表达式，使得 $\\operatorname{Var}(\\bar{e}) \\approx \\sigma_{e}^{2}/n_{\\text{eff}}$，其中 $\\sigma_{e}^{2}$ 是 $e_t$ 的边际方差。然后，在正态近似下，考虑平均偏差的一个双侧置信度为 $0.95$ 的置信区间（CI）。定义乘性膨胀因子 $F$ 为，在具有相同 $\\sigma_{e}^{2}$ 和 $n$ 的条件下，自相关残差情况下的置信区间半宽与独立残差情况下的置信区间半宽之比。\n\n给定 $n=730$ 和 $\\hat{\\phi}=0.6$，计算 $F$。将您的答案四舍五入到四位有效数字，并将其表示为一个纯数（无量纲）。",
            "solution": "主要目标是为自相关时间序列推导样本均值的方差 $\\operatorname{Var}(\\bar{e})$。样本均值定义为 $\\bar{e} = \\frac{1}{n}\\sum_{t=1}^{n} e_t$。其方差为：\n$$\n\\operatorname{Var}(\\bar{e}) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{t=1}^{n} e_t\\right) = \\frac{1}{n^2} \\operatorname{Var}\\left(\\sum_{t=1}^{n} e_t\\right)\n$$\n随机变量和的方差是其协方差矩阵中所有项的和：\n$$\n\\operatorname{Var}\\left(\\sum_{t=1}^{n} e_t\\right) = \\sum_{t=1}^{n} \\sum_{s=1}^{n} \\operatorname{Cov}(e_t, e_s)\n$$\n对于一个弱平稳过程，协方差 $\\operatorname{Cov}(e_t, e_s)$ 仅取决于时间滞后 $|t-s|$。我们定义自协方差函数为 $\\gamma_k = \\operatorname{Cov}(e_t, e_{t-k})$，自相关函数为 $\\rho_k = \\gamma_k / \\gamma_0$。每个残差的方差是 $\\operatorname{Var}(e_t) = \\gamma_0 = \\sigma_e^2$。因此，$\\operatorname{Cov}(e_t, e_s) = \\gamma_{|t-s|} = \\sigma_e^2 \\rho_{|t-s|}$。\n\n将此代入方差表达式中：\n$$\n\\operatorname{Var}\\left(\\sum_{t=1}^{n} e_t\\right) = \\sum_{t=1}^{n} \\sum_{s=1}^{n} \\sigma_e^2 \\rho_{|t-s|} = \\sigma_e^2 \\left( \\sum_{t=1}^{n} \\rho_{|t-t|} + \\sum_{t \\neq s} \\rho_{|t-s|} \\right)\n$$\n这个和可以按滞后 $k = |t-s|$ 重新分组。对于从 $1$ 到 $n-1$ 的每个滞后 $k$，和中有 $2(n-k)$ 对 $(t,s)$。滞后 $k=0$ 出现 $n$ 次。\n$$\n\\operatorname{Var}\\left(\\sum_{t=1}^{n} e_t\\right) = \\sigma_e^2 \\left( n\\rho_0 + \\sum_{k=1}^{n-1} 2(n-k)\\rho_k \\right)\n$$\n由于 $\\rho_0=1$，我们有：\n$$\n\\operatorname{Var}(\\bar{e}) = \\frac{\\sigma_e^2}{n^2} \\left( n + 2\\sum_{k=1}^{n-1} (n-k)\\rho_k \\right) = \\frac{\\sigma_e^2}{n} \\left( 1 + 2\\sum_{k=1}^{n-1} \\left(1-\\frac{k}{n}\\right)\\rho_k \\right)\n$$\n问题陈述 $n$ 很大。这使得对于那些 $\\rho_k$ 不可忽略的滞后 $k$，近似 $(1 - k/n) \\approx 1$ 是合理的。此外，对于一个衰减的自相关函数，我们可以用无穷和来近似有限和：\n$$\n\\operatorname{Var}(\\bar{e}) \\approx \\frac{\\sigma_e^2}{n} \\left( 1 + 2\\sum_{k=1}^{\\infty} \\rho_k \\right)\n$$\n对于给定的一阶自回归（AR(1)）过程，$\\rho_k = \\phi^k$。该和是一个无穷几何级数：\n$$\n\\sum_{k=1}^{\\infty} \\phi^k = \\frac{\\phi}{1-\\phi} \\quad (\\text{对于 } |\\phi|1)\n$$\n将此代入方差表达式中：\n$$\n\\operatorname{Var}(\\bar{e}) \\approx \\frac{\\sigma_e^2}{n} \\left( 1 + 2\\frac{\\phi}{1-\\phi} \\right) = \\frac{\\sigma_e^2}{n} \\left( \\frac{1-\\phi+2\\phi}{1-\\phi} \\right) = \\frac{\\sigma_e^2}{n} \\left( \\frac{1+\\phi}{1-\\phi} \\right)\n$$\n此表达式应等于 $\\sigma_e^2 / n_{\\text{eff}}$：\n$$\n\\frac{\\sigma_e^2}{n_{\\text{eff}}} = \\frac{\\sigma_e^2}{n} \\left( \\frac{1+\\phi}{1-\\phi} \\right)\n$$\n解出 $n_{\\text{eff}}$，我们得到有效样本量：\n$$\nn_{\\text{eff}} = n \\left( \\frac{1-\\phi}{1+\\phi} \\right)\n$$\n接下来，我们定义膨胀因子 $F$。均值的双侧置信区间的半宽与均值的标准误 $\\operatorname{SE}(\\bar{e}) = \\sqrt{\\operatorname{Var}(\\bar{e})}$ 成正比。一个 $0.95$ 置信区间的半宽是 $H = z_{0.025} \\operatorname{SE}(\\bar{e})$。\n\n对于自相关情况：\n$$\nH_{\\text{auto}} = z_{0.025} \\sqrt{\\frac{\\sigma_e^2}{n} \\left( \\frac{1+\\phi}{1-\\phi} \\right)}\n$$\n对于独立残差的情况，自相关 $\\rho_k = 0$ (对于 $k \\ge 1$)，这等价于设置 $\\phi=0$。均值的方差简化为 $\\frac{\\sigma_e^2}{n}$。置信区间的半宽为：\n$$\nH_{\\text{indep}} = z_{0.025} \\sqrt{\\frac{\\sigma_e^2}{n}}\n$$\n膨胀因子 $F$ 是这两个半宽的比值：\n$$\nF = \\frac{H_{\\text{auto}}}{H_{\\text{indep}}} = \\frac{z_{0.025} \\sqrt{\\frac{\\sigma_e^2}{n} \\left( \\frac{1+\\phi}{1-\\phi} \\right)}}{z_{0.025} \\sqrt{\\frac{\\sigma_e^2}{n}}} = \\sqrt{\\frac{\\frac{\\sigma_e^2}{n} \\left( \\frac{1+\\phi}{1-\\phi} \\right)}{\\frac{\\sigma_e^2}{n}}}\n$$\n化简表达式，我们得到：\n$$\nF = \\sqrt{\\frac{1+\\phi}{1-\\phi}}\n$$\n我们已知估计参数 $\\hat{\\phi}=0.6$。$n=730$ 的值证实了大样本假设，但对于 $F$ 的最终计算并非必需。\n将 $\\phi = 0.6$ 代入 $F$ 的表达式中：\n$$\nF = \\sqrt{\\frac{1+0.6}{1-0.6}} = \\sqrt{\\frac{1.6}{0.4}} = \\sqrt{4} = 2\n$$\n问题要求答案四舍五入到四位有效数字。因此，$F=2.000$。",
            "answer": "$$\\boxed{2.000}$$"
        },
        {
            "introduction": "对于概率预报的验证，单一的误差评分可能无法全面反映预报系统的性能。本练习介绍了一种更精细的评估框架——Brier评分的Murphy分解，它将预报评分分解为可靠性、分辨率和不确定性三个可解释的分量。通过对一个水文气象概率预报系统的案例进行计算，你将学会如何诊断预报的优缺点，例如，预报概率是否与观测频率一致（可靠性），以及预报能否有效地区分不同事件发生率的情景（分辨率）。",
            "id": "3896013",
            "problem": "一个水文气象预报系统每天发布关于二元事件“区域平均降水量超过 $20$ 毫米”的概率预报。在一个包含 $N = 750$ 个预报-检验对的季节里，该系统发布的概率取五个离散值，相应的观测结果按以下预报分箱进行汇总。对于具有发布概率 $f_k$ 的分箱 $k$，设 $n_k$ 为该分箱中的预报数量，$e_k$ 为该分箱中事件发生的次数。数据如下：\n- 分箱 $1$：$f_1 = 0.05$，$n_1 = 120$，$e_1 = 6$。\n- 分箱 $2$：$f_2 = 0.15$，$n_2 = 150$，$e_2 = 30$。\n- 分箱 $3$：$f_3 = 0.35$，$n_3 = 200$，$e_3 = 70$。\n- 分箱 $4$：$f_4 = 0.55$，$n_4 = 180$，$e_4 = 99$。\n- 分箱 $5$：$f_5 = 0.75$，$n_5 = 100$，$e_5 = 80$。\n\n从二元结果概率预报的 Brier 分数（BS）的定义出发，$BS \\equiv \\frac{1}{N}\\sum_{i=1}^{N} \\left( f_i - Y_i \\right)^2$，其中 $Y_i \\in \\{0,1\\}$ 是案例 $i$ 的检验结果指示符，$f_i \\in [0,1]$ 是发布的概率，推导将 BS 分解为与上述分箱方案相关的三个可解释分量的 Murphy 分解。仅使用诸如全期望定律和条件均值等基本概率恒等式，并清楚地说明每个分量如何反映预报相对于观测结果的可靠性、分辨率和不确定性。\n\n然后，使用提供的五个分箱，计算这三个分量的样本估计值。将分箱 $k$ 中的经验事件率定义为 $o_k \\equiv \\frac{e_k}{n_k}$，将总体基础率定义为 $\\bar{o} \\equiv \\frac{1}{N}\\sum_{k=1}^{5} e_k$。将每个 $f_k$ 视为其分箱内的平均预报。将三个分量的值均四舍五入到四位有效数字，并表示为无量纲数。按以下顺序报告您的最终答案：可靠性、分辨率、不确定性。",
            "solution": "二元事件概率预报的 Brier 分数（BS）定义为预报概率与二元检验结果之间的均方误差，即\n$$\nBS \\equiv \\frac{1}{N} \\sum_{i=1}^{N} \\left( f_i - Y_i \\right)^2,\n$$\n其中 $Y_i \\in \\{0,1\\}$ 且 $f_i \\in [0,1]$。为了将 BS 与可靠性、分辨率和不确定性联系起来，我们从两个基本工具开始：全期望定律和相对于将样本划分为预报分箱的条件均值。设样本被划分为 $K$ 个分箱，索引为 $k \\in \\{1,\\dots,K\\}$，分箱 $k$ 包含 $n_k$ 个案例，权重为 $w_k \\equiv \\frac{n_k}{N}$，发布概率为 $f_k$（假设在分箱内为常数），经验事件率为\n$$\no_k \\equiv \\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} Y_i.\n$$\n令 $\\bar{o} \\equiv \\frac{1}{N} \\sum_{i=1}^{N} Y_i$ 表示总体基础率（气候概率）。\n\n我们寻求将 BS 分解为三项。将分配到分箱 $k$ 的案例 $i$ 的平方误差写为\n$$\n\\left( f_k - Y_i \\right)^2 = \\left( f_k - o_k + o_k - \\bar{o} + \\bar{o} - Y_i \\right)^2.\n$$\n展开平方，然后在分箱 $k$ 内求平均，随后在所有分箱间求平均，将会产生交叉项，由于 $o_k$ 和 $\\bar{o}$ 的定义，这些交叉项的分箱平均值为零。具体来说，在分箱 $k$ 内，\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( \\bar{o} - Y_i \\right) = \\bar{o} - o_k,\n$$\n并且\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( \\bar{o} - Y_i \\right)^2 = \\underbrace{o_k(1 - o_k)}_{\\text{分箱结果方差}} + \\left( o_k - \\bar{o} \\right)^2,\n$$\n根据恒等式 $\\operatorname{Var}(Y \\mid \\text{bin }k) = o_k(1 - o_k)$ 和全方差定律。使用这些恒等式，在展开和重新组合后，分箱均方误差变为\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( f_k - Y_i \\right)^2\n= \\underbrace{\\left( f_k - o_k \\right)^2}_{\\text{可靠性贡献}}\n+ \\underbrace{\\left( o_k - \\bar{o} \\right)^2}_{\\text{分辨率贡献}}\n+ \\underbrace{o_k(1 - o_k)}_{\\text{不确定性贡献}}\n- \\underbrace{\\left( o_k - \\bar{o} \\right)^2}_{\\text{通过重组抵消}},\n$$\n并且，在使用 $w_k = \\frac{n_k}{N}$ 和恒等式\n$$\n\\sum_{k=1}^{K} w_k \\, o_k(1 - o_k) = \\bar{o}(1 - \\bar{o}) - \\sum_{k=1}^{K} w_k \\left( o_k - \\bar{o} \\right)^2,\n$$\n仔细地组合各分箱的项后，我们得到 Murphy 分解：\n$$\nBS = \\underbrace{\\sum_{k=1}^{K} w_k \\left( f_k - o_k \\right)^2}_{\\text{可靠性}}\n\\;-\\;\n\\underbrace{\\sum_{k=1}^{K} w_k \\left( o_k - \\bar{o} \\right)^2}_{\\text{分辨率}}\n\\;+\\;\n\\underbrace{\\bar{o}(1 - \\bar{o})}_{\\text{不确定性}}.\n$$\n解释：\n- 可靠性量化了发布概率与经验频率的一致性；当所有分箱中 $f_k \\approx o_k$ 时，该值很小。\n- 分辨率量化了各分箱的经验频率偏离气候基础率 $\\bar{o}$ 的程度；当分箱能区分出具有非常不同 $o_k$ 的案例时，该值很大。\n- 不确定性量化了二元结果的内在变异性，等于成功概率为 $\\bar{o}$ 的伯努利随机变量的方差。\n\n我们现在使用提供的数据计算每个分量。\n\n步骤 1：计算 $o_k$、$w_k$ 和 $\\bar{o}$。\n给定 $(n_k, e_k)$：\n- 分箱 $1$：$o_1 = \\frac{6}{120} = \\frac{1}{20} = 0.05$，$w_1 = \\frac{120}{750} = \\frac{4}{25}$。\n- 分箱 $2$：$o_2 = \\frac{30}{150} = \\frac{1}{5} = 0.2$，$w_2 = \\frac{150}{750} = \\frac{1}{5}$。\n- 分箱 $3$：$o_3 = \\frac{70}{200} = \\frac{7}{20} = 0.35$，$w_3 = \\frac{200}{750} = \\frac{4}{15}$。\n- 分箱 $4$：$o_4 = \\frac{99}{180} = \\frac{11}{20} = 0.55$，$w_4 = \\frac{180}{750} = \\frac{6}{25}$。\n- 分箱 $5$：$o_5 = \\frac{80}{100} = \\frac{4}{5} = 0.8$，$w_5 = \\frac{100}{750} = \\frac{2}{15}$。\n总体基础率：\n$$\n\\bar{o} = \\frac{e_1 + e_2 + e_3 + e_4 + e_5}{N} = \\frac{6 + 30 + 70 + 99 + 80}{750} = \\frac{285}{750} = \\frac{19}{50} = 0.38.\n$$\n\n步骤 2：可靠性分量，\n$$\n\\text{Reliability} = \\sum_{k=1}^{5} w_k \\left( f_k - o_k \\right)^2.\n$$\n逐分箱差异：\n- 分箱 $1$：$f_1 - o_1 = 0.05 - 0.05 = 0$，贡献为 $0$。\n- 分箱 $2$：$f_2 - o_2 = 0.15 - 0.2 = -0.05$，平方 $= 0.0025 = \\frac{1}{400}$，乘以权重 $w_2 = \\frac{1}{5}$ 得到 $\\frac{1}{2000}$。\n- 分箱 $3$：$f_3 - o_3 = 0.35 - 0.35 = 0$，贡献为 $0$。\n- 分箱 $4$：$f_4 - o_4 = 0.55 - 0.55 = 0$，贡献为 $0$。\n- 分箱 $5$：$f_5 - o_5 = 0.75 - 0.8 = -0.05$，平方 $= 0.0025 = \\frac{1}{400}$，乘以权重 $w_5 = \\frac{2}{15}$ 得到 $\\frac{1}{3000}$。\n求和，\n$$\n\\text{Reliability} = \\frac{1}{2000} + \\frac{1}{3000} = \\frac{1}{1200} \\approx 0.000833\\overline{3}.\n$$\n\n步骤 3：分辨率分量，\n$$\n\\text{Resolution} = \\sum_{k=1}^{5} w_k \\left( o_k - \\bar{o} \\right)^2.\n$$\n计算差异和平方：\n- 分箱 $1$：$o_1 - \\bar{o} = \\frac{1}{20} - \\frac{19}{50} = -\\frac{33}{100}$，平方 $= \\frac{1089}{10000}$，乘以权重 $w_1 = \\frac{4}{25}$ 得到 $\\frac{1089}{62500}$。\n- 分箱 $2$：$o_2 - \\bar{o} = \\frac{1}{5} - \\frac{19}{50} = -\\frac{9}{50}$，平方 $= \\frac{81}{2500}$，乘以权重 $w_2 = \\frac{1}{5}$ 得到 $\\frac{81}{12500}$。\n- 分箱 $3$：$o_3 - \\bar{o} = \\frac{7}{20} - \\frac{19}{50} = -\\frac{3}{100}$，平方 $= \\frac{9}{10000}$，乘以权重 $w_3 = \\frac{4}{15}$ 得到 $\\frac{6}{25000}$。\n- 分箱 $4$：$o_4 - \\bar{o} = \\frac{11}{20} - \\frac{19}{50} = \\frac{17}{100}$，平方 $= \\frac{289}{10000}$，乘以权重 $w_4 = \\frac{6}{25}$ 得到 $\\frac{867}{125000}$。\n- 分箱 $5$：$o_5 - \\bar{o} = \\frac{4}{5} - \\frac{19}{50} = \\frac{21}{50}$，平方 $= \\frac{441}{2500}$，乘以权重 $w_5 = \\frac{2}{15}$ 得到 $\\frac{147}{6250}$。\n通分到公分母 $125000$ 进行求和：\n$$\n\\text{Resolution} = \\frac{2178 + 810 + 30 + 867 + 2940}{125000} = \\frac{6825}{125000} = \\frac{273}{5000} = 0.0546.\n$$\n\n步骤 4：不确定性分量，\n$$\n\\text{Uncertainty} = \\bar{o} \\left( 1 - \\bar{o} \\right) = \\frac{19}{50} \\cdot \\frac{31}{50} = \\frac{589}{2500} = 0.2356.\n$$\n\n可选验证：该分解意味着 $BS = \\text{可靠性} - \\text{分辨率} + \\text{不确定性}$。使用精确分数，\n$$\nBS = \\frac{1}{1200} - \\frac{273}{5000} + \\frac{589}{2500} = \\frac{1091}{6000} \\approx 0.181833\\ldots,\n$$\n这与在样本分组到分箱后直接对 $\\left( f_i - Y_i \\right)^2$ 求平均值的结果一致。\n\n最后，将每个分量四舍五入到四位有效数字，并将值表示为无量纲数：\n- 可靠性：$\\frac{1}{1200} \\approx 8.333 \\times 10^{-4}$。\n- 分辨率：$\\frac{273}{5000} = 5.460 \\times 10^{-2}$。\n- 不确定性：$\\frac{589}{2500} = 2.356 \\times 10^{-1}$。\n\n按以下顺序报告最终答案：可靠性、分辨率、不确定性。",
            "answer": "$$\\boxed{\\begin{pmatrix}8.333 \\times 10^{-4}  5.460 \\times 10^{-2}  2.356 \\times 10^{-1}\\end{pmatrix}}$$"
        }
    ]
}