{
    "hands_on_practices": [
        {
            "introduction": "本练习将通过一个简单的基因表达模型，引导您完成局部敏感性分析中最基本的操作。您将首先推导出系统的稳态解，然后通过偏微分计算输出（蛋白质浓度）对关键参数（翻译速率）的未归一化敏感度。这个过程是后续更复杂敏感性分析的基石，能够帮助您掌握核心的计算方法。",
            "id": "1442863",
            "problem": "一名合成生物学家正在研究一个简单的基因表达模块，其中一个基因被组成性表达。该系统的动力学可以通过一对耦合常微分方程来描述，这两个方程分别描述了信使RNA（mRNA）的浓度（表示为 $[M]$）和蛋白质产物的浓度（表示为 $[P]$）：\n\n$$ \\frac{d[M]}{dt} = k_{tx} - \\delta_M [M] $$\n$$ \\frac{d[P]}{dt} = k_{tl} [M] - \\delta_P [P] $$\n\n在这里，$k_{tx}$ 代表恒定的转录速率，$\\delta_M$ 是mRNA的一阶降解速率常数，$k_{tl}$ 是翻译（蛋白质合成）的一阶速率常数，而 $\\delta_P$ 是蛋白质的一阶降解速率常数。所有参数均为正常数。\n\n为了理解细胞环境中的波动如何影响蛋白质输出，该生物学家希望量化系统的灵敏度。你的任务是确定稳态蛋白质浓度相对于翻译速率常数的非归一化局部灵敏度。\n\n请找出该灵敏度的解析表达式，该灵敏度定义为稳态蛋白质浓度 $[P]_{ss}$ 相对于翻译速率常数 $k_{tl}$ 的偏导数。请用给定的模型参数 $k_{tx}$、$\\delta_M$、$k_{tl}$ 和 $\\delta_P$ 来表示你的答案。",
            "solution": "在稳态下，根据动力学系统中稳态的定义，所有时间导数都为零。因此，我们令 $\\frac{d[M]}{dt}=0$ 和 $\\frac{d[P]}{dt}=0$。\n\n根据mRNA方程，\n$$\n0 = k_{tx} - \\delta_M [M]_{ss}\n\\quad \\Rightarrow \\quad\n[M]_{ss} = \\frac{k_{tx}}{\\delta_M}.\n$$\n\n根据蛋白质方程，\n$$\n0 = k_{tl} [M]_{ss} - \\delta_P [P]_{ss}\n\\quad \\Rightarrow \\quad\n[P]_{ss} = \\frac{k_{tl}}{\\delta_P}[M]_{ss}.\n$$\n\n将 $[M]_{ss}$ 代入 $[P]_{ss}$ 的表达式中，得到\n$$\n[P]_{ss} = \\frac{k_{tl}}{\\delta_P} \\cdot \\frac{k_{tx}}{\\delta_M}\n= \\frac{k_{tx} k_{tl}}{\\delta_M \\delta_P}.\n$$\n\n$[P]_{ss}$ 相对于 $k_{tl}$ 的非归一化局部灵敏度是其偏导数\n$$\n\\frac{\\partial [P]_{ss}}{\\partial k_{tl}}\n= \\frac{\\partial}{\\partial k_{tl}}\\left(\\frac{k_{tx} k_{tl}}{\\delta_M \\delta_P}\\right)\n= \\frac{k_{tx}}{\\delta_M \\delta_P},\n$$\n其中将 $k_{tx}$、$\\delta_M$ 和 $\\delta_P$ 视为相对于 $k_{tl}$ 的常数。",
            "answer": "$$\\boxed{\\frac{k_{tx}}{\\delta_M \\delta_P}}$$"
        },
        {
            "introduction": "在理解了基本的敏感度计算后，本练习引入了更具解释力的归一化敏感度系数，它消除了单位的量纲影响。通过分析一个两步代谢通路模型，您会发现一个看似关键的参数对系统输出的稳态浓度影响竟然为零。这个练习旨在揭示局部敏感性分析的强大洞察力，它不仅能量化影响，还能揭示出系统中非直观的结构特性和控制逻辑。",
            "id": "1442888",
            "problem": "考虑一个细胞内两步代谢途径的简化模型。一个底物分子 $S_1$ 被酶 $E_1$ 转化为中间产物 $S_2$。这个中间产物 $S_2$ 接着被酶 $E_2$ 转化为最终产物 $S_3$。\n\n该系统的动力学由以下基于质量作用动力学的一组常微分方程（ODE）描述：\n1.  一个外部来源以恒定的流入速率 $v_{in}$ 向系统提供 $S_1$。\n2.  $S_1$ 以一级速率常数 $k_1$ 转化为 $S_2$。该反应的速率为 $k_1 [S_1]$。\n3.  $S_2$ 以一级速率常数 $k_2$ 转化为 $S_3$。该反应的速率为 $k_2 [S_2]$。\n\n$S_1$ 和 $S_2$ 的浓度（分别表示为 $[S_1]$ 和 $[S_2]$）根据以下方程演化：\n$$\n\\frac{d[S_1]}{dt} = v_{in} - k_1 [S_1]\n$$\n$$\n\\frac{d[S_2]}{dt} = k_1 [S_1] - k_2 [S_2]\n$$\n\n系统被允许达到稳态，此时 $S_1$ 和 $S_2$ 的浓度不再随时间变化。我们感兴趣的是中间产物 $[\\bar{S_2}]$ 的稳态浓度，我们将其定义为该途径的输出。\n\n在系统生物学中，通常会进行局部灵敏度分析，以量化系统输出如何受其参数的微小变化影响。输出 $y$ 相对于参数 $p$ 的标度化灵敏度系数，记为 $C_p^y$，定义为：\n$$\nC_p^y = \\frac{\\partial y}{\\partial p} \\frac{p}{y}\n$$\n\n对于以下哪个参数 $p$，稳态输出 $y = [\\bar{S_2}]$ 的标度化灵敏度系数恰好等于零？\n\nA. $v_{in}$\n\nB. $k_1$\n\nC. $k_2$\n\nD. 所有参数的灵敏度均不为零。\n\nE. 结果取决于初始浓度 $[S_1](0)$ 和 $[S_2](0)$。",
            "solution": "通过将时间导数设为零来建立稳态。从\n$$\n\\frac{d[S_1]}{dt} = v_{in} - k_{1}[S_1],\n$$\n稳态满足\n$$\n0 = v_{in} - k_{1}[\\bar{S_1}] \\quad \\Rightarrow \\quad [\\bar{S_1}] = \\frac{v_{in}}{k_{1}}.\n$$\n从\n$$\n\\frac{d[S_2]}{dt} = k_{1}[S_1] - k_{2}[S_2],\n$$\n稳态满足\n$$\n0 = k_{1}[\\bar{S_1}] - k_{2}[\\bar{S_2}] \\quad \\Rightarrow \\quad [\\bar{S_2}] = \\frac{k_{1}}{k_{2}}[\\bar{S_1}] = \\frac{k_{1}}{k_{2}}\\frac{v_{in}}{k_{1}} = \\frac{v_{in}}{k_{2}}.\n$$\n将输出定义为 $y = [\\bar{S_2}] = \\frac{v_{in}}{k_{2}}$。标度化灵敏度系数为\n$$\nC_{p}^{y} = \\frac{\\partial y}{\\partial p}\\frac{p}{y}.\n$$\n分别计算：\n1) 对于 $p = v_{in}$，$\\frac{\\partial y}{\\partial v_{in}} = \\frac{1}{k_{2}}$，所以\n$$\nC_{v_{in}}^{y} = \\frac{1}{k_{2}}\\frac{v_{in}}{v_{in}/k_{2}} = 1.\n$$\n2) 对于 $p = k_{1}$，$y$ 不依赖于 $k_{1}$，所以\n$$\n\\frac{\\partial y}{\\partial k_{1}} = 0 \\quad \\Rightarrow \\quad C_{k_{1}}^{y} = 0.\n$$\n3) 对于 $p = k_{2}$，$\\frac{\\partial y}{\\partial k_{2}} = -\\frac{v_{in}}{k_{2}^{2}}$，所以\n$$\nC_{k_{2}}^{y} = \\left(-\\frac{v_{in}}{k_{2}^{2}}\\right)\\frac{k_{2}}{v_{in}/k_{2}} = -1.\n$$\n因此，唯一使 $[\\bar{S_2}]$ 的标度化灵敏度为零的参数是 $k_{1}$。由于稳态下的 $[\\bar{S_2}]$ 仅取决于 $v_{in}$ 和 $k_{2}$，因此结果不依赖于初始条件。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "现实世界中的环境模型常常包含非光滑或不连续的过程，例如土壤径流的阈值触发，这给基于导数的局部敏感性分析带来了挑战。这个高级练习将引导您直面这一难题，您需要首先诊断模型在径流起点处的不可微问题，然后采用平滑函数对其进行正则化处理。最后，您将应用隐函数定理来推导在更真实模型下的稳态敏感度，这反映了研究生级别研究所需的复杂问题解决能力。",
            "id": "3889139",
            "problem": "一个土壤柱由一个基于质量守恒的单水库“桶”模型表示。设 $S(t)$ 表示土壤水分储量，单位为 $\\mathrm{mm}$。质量平衡是一个常微分方程 (ODE) $\\,\\mathrm{d}S/\\mathrm{d}t = \\text{输入} - \\text{输出}\\,$，具体为\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} \\;=\\; P \\;-\\; E(S) \\;-\\; R(S;k),\n$$\n其中 $P$ 是恒定的降水输入，单位为 $\\mathrm{mm\\,day^{-1}}$，$E(S)$ 是蒸散发，单位为 $\\mathrm{mm\\,day^{-1}}$，$R(S;k)$ 是径流，单位为 $\\mathrm{mm\\,day^{-1}}$，受储水阈值 $S^{*}$ 控制。考虑常用的阈值径流闭合项\n$$\nR_{\\text{thr}}(S;k) \\;=\\; k\\,\\max\\!\\big(0,\\,S - S^{*}\\big),\n$$\n其中 $k$ 是速率参数，单位为 $\\mathrm{day^{-1}}$，$S^{*}$ 的单位为 $\\mathrm{mm}$。假设蒸散发为线性闭合项 $E(S) = c\\,S$，其中 $c$ 的单位为 $\\mathrm{day^{-1}}$。\n\n1. 诊断径流起始点 $S = S^{*}$ 处 $R_{\\text{thr}}(S;k)$ 的可微性问题，并解释为什么这会对模型项在 $S = S^{*}$ 处关于 $S$ 和参数的局部（基于导数的）敏感性分析造成问题。\n\n2. 为了在起始点附近对模型进行正则化，采用平滑的“softplus”函数来近似正部：\n$$\n\\phi_{\\epsilon}(x) \\;=\\; \\epsilon\\,\\ln\\!\\big(1 + \\exp(x/\\epsilon)\\big),\n$$\n其中平滑尺度 $\\epsilon$ 的单位为 $\\mathrm{mm}$，并定义平滑后的径流\n$$\nR_{\\epsilon}(S;k) \\;=\\; k\\,\\phi_{\\epsilon}\\!\\big(S - S^{*}\\big).\n$$\n在恒定强迫下，稳态 $S_{\\mathrm{ss}}$ 满足\n$$\n0 \\;=\\; P \\;-\\; c\\,S_{\\mathrm{ss}} \\;-\\; k\\,\\phi_{\\epsilon}\\!\\big(S_{\\mathrm{ss}} - S^{*}\\big).\n$$\n使用隐函数定理推导局部稳态敏感性 $\\mathrm{d}S_{\\mathrm{ss}}/\\mathrm{d}k$ 的解析表达式，该表达式用在 $S_{\\mathrm{ss}}$ 处求值的 $\\phi_{\\epsilon}$ 及其导数表示。\n\n3. 设参数为 $S^{*} = 100\\,\\mathrm{mm}$，$c = 0.010\\,\\mathrm{day^{-1}}$，$k = 0.10\\,\\mathrm{day^{-1}}$，以及 $\\epsilon = 5.0\\,\\mathrm{mm}$。考虑设置降水量，使平滑模型恰好在径流起始点达到平衡，即 $S_{\\mathrm{ss}} = S^{*}$。在此稳态和参数集下，计算你的敏感性表达式的值。将最终敏感性以毫米-天（$\\mathrm{mm\\cdot day}$）表示，并将答案四舍五入到四位有效数字。",
            "solution": "**第一部分：阈值径流函数的可微性**\n\n阈值径流闭合项由以下函数给出\n$$\nR_{\\text{thr}}(S;k) = k\\,\\max(0, S - S^{*})\n$$\n其中 $S$ 是土壤水分储量，$S^{*}$ 是阈值储量，$k$ 是一个速率参数。为了分析其可微性，我们考察它关于 $S$ 的导数，记为 $\\mathrm{d}R_{\\text{thr}}/\\mathrm{d}S$。\n\n函数的行为在点 $S = S^{*}$ 处发生改变。我们考虑两种情况：\n1.  对于 $S < S^{*}$，自变量 $S - S^{*}$ 为负，因此 $\\max(0, S - S^{*}) = 0$。函数为 $R_{\\text{thr}}(S;k) = k \\cdot 0 = 0$。在此区域的导数为 $\\mathrm{d}R_{\\text{thr}}/\\mathrm{d}S = 0$。\n2.  对于 $S > S^{*}$，自变量 $S - S^{*}$ 为正，因此 $\\max(0, S - S^{*}) = S - S^{*}$。函数为 $R_{\\text{thr}}(S;k) = k(S - S^{*})$。在此区域的导数为 $\\mathrm{d}R_{\\text{thr}}/\\mathrm{d}S = k$。\n\n在点 $S = S^{*}$ 处，导数的左极限是\n$$\n\\lim_{S \\to {S^{*-}}} \\frac{\\mathrm{d}R_{\\text{thr}}}{\\mathrm{d}S} = 0\n$$\n导数的右极限是\n$$\n\\lim_{S \\to {S^{*+}}} \\frac{\\mathrm{d}R_{\\text{thr}}}{\\mathrm{d}S} = k\n$$\n由于参数 $k$ 代表一个正的径流速率，$k > 0$，因此左导数和右导数不相等。因此，函数 $R_{\\text{thr}}(S;k)$ 在点 $S = S^{*}$ 处不可微。这个点是函数图像上的一个“尖角”。\n\n局部（基于导数的）敏感性分析需要计算模型输出相对于模型参数的导数。例如，稳态储量 $S_{\\mathrm{ss}}$ 对某个参数（如 $k$）的敏感性通常涉及模型右侧的雅可比矩阵，即 $\\mathrm{d}(\\mathrm{d}S/\\mathrm{d}t)/\\mathrm{d}S$，在 $S_{\\mathrm{ss}}$ 处求值。在我们的模型中，这个雅可比是 $\\mathrm{d}/\\mathrm{d}S [P - cS - R(S;k)] = -c - \\mathrm{d}R/\\mathrm{d}S$。由于 $R_{\\text{thr}}$ 在 $S = S^{*}$ 处不可微，这个雅可比矩阵在 $S = S^{*}$ 处是不连续的。如果模型恰好在此点达到平衡（$S_{\\mathrm{ss}} = S^{*}$），任何依赖于该雅可比矩阵的敏感性度量都将变得无定义，因为导数不存在。这排除了在径流起始阈值处使用标准局部敏感性方法的可能性。\n\n**第二部分：稳态敏感性 $\\mathrm{d}S_{\\mathrm{ss}}/\\mathrm{d}k$ 的推导**\n\n平滑模型有一个稳态 $S_{\\mathrm{ss}}$，它满足以下隐式方程：\n$$\nF(S_{\\mathrm{ss}}, k) = P - c\\,S_{\\mathrm{ss}} - k\\,\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*}) = 0\n$$\n在这里，$S_{\\mathrm{ss}}$ 是包括 $k$ 在内的参数的一个隐函数。我们可以使用隐函数定理来求敏感性 $\\mathrm{d}S_{\\mathrm{ss}}/\\mathrm{d}k$。该定理指出，如果 $F(y, x) = 0$，则 $\\mathrm{d}y/\\mathrm{d}x = -(\\partial F/\\partial x) / (\\partial F/\\partial y)$，前提是 $\\partial F/\\partial y \\neq 0$。在我们的情景中，$y = S_{\\mathrm{ss}}$ 且 $x = k$。\n\n我们计算 $F(S_{\\mathrm{ss}}, k)$ 所需的偏导数：\n\n首先，关于 $k$ 的偏导数：\n$$\n\\frac{\\partial F}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ P - c\\,S_{\\mathrm{ss}} - k\\,\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*}) \\right] = -\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})\n$$\n\n其次，关于 $S_{\\mathrm{ss}}$ 的偏导数：\n$$\n\\frac{\\partial F}{\\partial S_{\\mathrm{ss}}} = \\frac{\\partial}{\\partial S_{\\mathrm{ss}}} \\left[ P - c\\,S_{\\mathrm{ss}} - k\\,\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*}) \\right] = -c - k\\,\\frac{\\mathrm{d}}{\\mathrm{d}S_{\\mathrm{ss}}}\\left[\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})\\right]\n$$\n为了计算这个导数，我们需要 softplus 函数 $\\phi_{\\epsilon}(x) = \\epsilon\\,\\ln(1 + \\exp(x/\\epsilon))$ 的导数。设 $\\phi'_{\\epsilon}(x) = \\mathrm{d}\\phi_{\\epsilon}/\\mathrm{d}x$。\n$$\n\\phi'_{\\epsilon}(x) = \\epsilon \\cdot \\frac{1}{1 + \\exp(x/\\epsilon)} \\cdot \\exp(x/\\epsilon) \\cdot \\frac{1}{\\epsilon} = \\frac{\\exp(x/\\epsilon)}{1 + \\exp(x/\\epsilon)} = \\frac{1}{1 + \\exp(-x/\\epsilon)}\n$$\n这就是 logistic sigmoid 函数。使用链式法则，$\\frac{\\mathrm{d}}{\\mathrm{d}S_{\\mathrm{ss}}}\\left[\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})\\right] = \\phi'_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})$。\n因此，\n$$\n\\frac{\\partial F}{\\partial S_{\\mathrm{ss}}} = -c - k\\,\\phi'_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})\n$$\n\n应用隐函数定理：\n$$\n\\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} = - \\frac{\\partial F/\\partial k}{\\partial F/\\partial S_{\\mathrm{ss}}} = - \\frac{-\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})}{-c - k\\,\\phi'_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})} = - \\frac{\\phi_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})}{c + k\\,\\phi'_{\\epsilon}(S_{\\mathrm{ss}} - S^{*})}\n$$\n这就是所求的局部稳态敏感性的解析表达式。\n\n**第三部分：敏感性表达式的求值**\n\n我们被要求在条件 $S_{\\mathrm{ss}} = S^{*}$ 下，使用参数 $S^{*} = 100\\,\\mathrm{mm}$，$c = 0.010\\,\\mathrm{day^{-1}}$，$k = 0.10\\,\\mathrm{day^{-1}}$ 和 $\\epsilon = 5.0\\,\\mathrm{mm}$ 来计算 $\\mathrm{d}S_{\\mathrm{ss}}/\\mathrm{d}k$ 的值。\n\n当 $S_{\\mathrm{ss}} = S^{*}$ 时，softplus 函数的自变量为 $S_{\\mathrm{ss}} - S^{*} = 0$。我们计算 $\\phi_{\\epsilon}(0)$ 和 $\\phi'_{\\epsilon}(0)$ 的值：\n$$\n\\phi_{\\epsilon}(0) = \\epsilon\\,\\ln(1 + \\exp(0/\\epsilon)) = \\epsilon\\,\\ln(1 + 1) = \\epsilon\\,\\ln(2)\n$$\n$$\n\\phi'_{\\epsilon}(0) = \\frac{\\exp(0/\\epsilon)}{1 + \\exp(0/\\epsilon)} = \\frac{1}{1+1} = \\frac{1}{2}\n$$\n将这些代入敏感性表达式中：\n$$\n\\left. \\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} \\right|_{S_{\\mathrm{ss}} = S^{*}} = - \\frac{\\epsilon\\,\\ln(2)}{c + k\\,(1/2)}\n$$\n现在，我们代入给定的数值：\n$$\n\\left. \\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} \\right|_{S_{\\mathrm{ss}} = S^{*}} = - \\frac{(5.0\\,\\mathrm{mm})\\,\\ln(2)}{0.010\\,\\mathrm{day^{-1}} + (0.10\\,\\mathrm{day^{-1}})/2}\n$$\n$$\n\\left. \\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} \\right|_{S_{\\mathrm{ss}} = S^{*}} = - \\frac{5.0\\,\\ln(2)}{0.010 + 0.050} \\, \\frac{\\mathrm{mm}}{\\mathrm{day^{-1}}}\n$$\n$$\n\\left. \\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} \\right|_{S_{\\mathrm{ss}} = S^{*}} = - \\frac{5.0\\,\\ln(2)}{0.060} \\, \\mathrm{mm \\cdot day}\n$$\n使用近似值 $\\ln(2) \\approx 0.693147$：\n$$\n\\left. \\frac{\\mathrm{d}S_{\\mathrm{ss}}}{\\mathrm{d}k} \\right|_{S_{\\mathrm{ss}} = S^{*}} \\approx - \\frac{5.0 \\times 0.693147}{0.060} \\, \\mathrm{mm \\cdot day} \\approx - \\frac{3.465735}{0.060} \\, \\mathrm{mm \\cdot day} \\approx -57.76225 \\, \\mathrm{mm \\cdot day}\n$$\n将结果四舍五入到四位有效数字，我们得到 $-57.76\\,\\mathrm{mm \\cdot day}$。",
            "answer": "$$\n\\boxed{-57.76}\n$$"
        }
    ]
}