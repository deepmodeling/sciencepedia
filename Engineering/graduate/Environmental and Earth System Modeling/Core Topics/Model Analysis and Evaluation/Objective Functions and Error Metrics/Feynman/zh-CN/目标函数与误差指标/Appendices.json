{
    "hands_on_practices": [
        {
            "introduction": "在模型校准中，均方根误差（RMSE）和平均绝对误差（MAE）是两种最常用的目标函数。本练习旨在通过一个实际计算案例，揭示这两种度量标准在数学结构上的根本差异，特别是它们对数据中离群值的不同敏感性，这将直接影响模型参数的优化结果。",
            "id": "3899972",
            "problem": "一个流域尺度的水文模型正在使用一个加性偏差参数对日降水量进行校准。设第 $i$ 天的原始模型降水量为 $P_{i}^{\\mathrm{raw}}$，观测降水量为 $P_{i}^{\\mathrm{obs}}$，带有加性偏差参数 $b$ 的模型为 $P_{i}^{\\mathrm{mod}}(b) = P_{i}^{\\mathrm{raw}} + b$。将残差定义为 $e_{i}(b) = P_{i}^{\\mathrm{mod}}(b) - P_{i}^{\\mathrm{obs}}$。对于一个为期 $12$ 天的训练期，当 $b=0$ 时的残差（单位：毫米/天）由以下集合给出\n$$\n\\{ -6.2,\\ 3.9,\\ -1.1,\\ 0.0,\\ 5.3,\\ -14.8,\\ 7.5,\\ 1.6,\\ -2.9,\\ 2.1,\\ -0.7,\\ 4.0 \\}.\n$$\n仅从均方根误差（RMSE）和平均绝对误差（MAE）的定义出发，执行以下操作：\n\n1) 使用提供的 $b=0$ 时的残差，计算均方根误差（RMSE）和平均绝对误差（MAE）。两者均以毫米/天为单位表示。\n\n2) 将加性偏差 $b$ 视为唯一的校准参数，写出分别对应于均方根误差（RMSE）和平均绝对误差（MAE）的目标函数 $J_{\\mathrm{RMSE}}(b)$ 和 $J_{\\mathrm{MAE}}(b)$，用残差 $e_{i}(b)$ 表示。从第一性原理出发，推导使每个目标函数最小化的 $b$ 值，并对所提供的数据进行数值计算。\n\n3) 使用您的推导，定性讨论每个度量如何塑造 $b$ 的校准景观（例如，平滑度、曲率和对异常值的敏感性），并将这些性质与您求得的最小值点联系起来。\n\n为便于评分，请报告在第1部分中计算出的 $b=0$ 时RMSE与MAE的比值，作为一个标量。将您报告的比值四舍五入到四位有效数字。报告该比值时，应为一个没有单位的纯数。如果陈述中间量，请以毫米/天为单位表示。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。它提出了一个环境建模中的标准校准任务，可以使用所提供的信息解决。\n\n训练期的数据点总数为 $N=12$。偏差 $b=0$ 时的残差集合为 $E_0 = \\{ -6.2,\\ 3.9,\\ -1.1,\\ 0.0,\\ 5.3,\\ -14.8,\\ 7.5,\\ 1.6,\\ -2.9,\\ 2.1,\\ -0.7,\\ 4.0 \\}$。单位为毫米/天 (mm/day)。\n\n首先，我们计算加性偏差 $b=0$ 情况下的均方根误差（RMSE）和平均绝对误差（MAE）。\n对于一组 $N$ 个残差 $e_i$，RMSE的定义是：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} e_{i}^{2}}\n$$\n对于给定的残差 $e_i(0)$，我们首先计算平方和：\n$$\n\\sum_{i=1}^{12} (e_{i}(0))^{2} = (-6.2)^2 + (3.9)^2 + (-1.1)^2 + (0.0)^2 + (5.3)^2 + (-14.8)^2 + (7.5)^2 + (1.6)^2 + (-2.9)^2 + (2.1)^2 + (-0.7)^2 + (4.0)^2\n$$\n$$\n\\sum_{i=1}^{12} (e_{i}(0))^{2} = 38.44 + 15.21 + 1.21 + 0.0 + 28.09 + 219.04 + 56.25 + 2.56 + 8.41 + 4.41 + 0.49 + 16.0 = 390.11\n$$\n因此，$b=0$ 时的RMSE为：\n$$\n\\mathrm{RMSE}(0) = \\sqrt{\\frac{390.11}{12}} \\approx 5.7017 \\text{ mm/day}\n$$\n对于一组 $N$ 个残差 $e_i$，MAE的定义是：\n$$\n\\mathrm{MAE} = \\frac{1}{N} \\sum_{i=1}^{N} |e_i|\n$$\n对于给定的残差，我们计算绝对值之和：\n$$\n\\sum_{i=1}^{12} |e_{i}(0)| = |-6.2| + |3.9| + |-1.1| + |0.0| + |5.3| + |-14.8| + |7.5| + |1.6| + |-2.9| + |2.1| + |-0.7| + |4.0|\n$$\n$$\n\\sum_{i=1}^{12} |e_{i}(0)| = 6.2 + 3.9 + 1.1 + 0.0 + 5.3 + 14.8 + 7.5 + 1.6 + 2.9 + 2.1 + 0.7 + 4.0 = 50.1\n$$\n因此，$b=0$ 时的MAE为：\n$$\n\\mathrm{MAE}(0) = \\frac{50.1}{12} = 4.175 \\text{ mm/day}\n$$\n\n其次，我们确定使RMSE和MAE最小化的加性偏差参数 $b$ 的值。作为 $b$ 函数的残差是 $e_i(b) = P_{i}^{\\mathrm{mod}}(b) - P_{i}^{\\mathrm{obs}} = (P_{i}^{\\mathrm{raw}} + b) - P_{i}^{\\mathrm{obs}} = (P_{i}^{\\mathrm{raw}} - P_{i}^{\\mathrm{obs}}) + b = e_{i}(0) + b$。\n\n为了最小化RMSE，我们定义目标函数 $J_{\\mathrm{RMSE}}(b)$：\n$$\nJ_{\\mathrm{RMSE}}(b) = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (e_{i}(b))^{2}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (e_{i}(0) + b)^{2}}\n$$\n最小化 $J_{\\mathrm{RMSE}}(b)$ 等价于最小化其平方，即均方误差（MSE），我们记为 $L(b) = (J_{\\mathrm{RMSE}}(b))^2$。为了找到最小值，我们计算 $L(b)$ 关于 $b$ 的导数并将其设为 $0$：\n$$\n\\frac{dL}{db} = \\frac{d}{db} \\left[ \\frac{1}{N} \\sum_{i=1}^{N} (e_{i}(0) + b)^{2} \\right] = \\frac{1}{N} \\sum_{i=1}^{N} 2(e_{i}(0) + b) = \\frac{2}{N} \\left( \\sum_{i=1}^{N} e_{i}(0) + Nb \\right)\n$$\n将导数设为零得到：\n$$\n\\sum_{i=1}^{N} e_{i}(0) + Nb = 0 \\implies b = -\\frac{1}{N} \\sum_{i=1}^{N} e_{i}(0) = -\\overline{e(0)}\n$$\n最优偏差 $b_{\\mathrm{RMSE}}$ 是初始残差平均值的负数。二阶导数 $\\frac{d^{2}L}{db^2} = 2 > 0$，证实了这是一个最小值点。\n我们计算初始残差的和：\n$$\n\\sum_{i=1}^{12} e_{i}(0) = -6.2 + 3.9 - 1.1 + 0.0 + 5.3 - 14.8 + 7.5 + 1.6 - 2.9 + 2.1 - 0.7 + 4.0 = -1.3\n$$\nRMSE的最优偏差为：\n$$\nb_{\\mathrm{RMSE}} = -\\frac{-1.3}{12} = \\frac{1.3}{12} \\approx 0.1083 \\text{ mm/day}\n$$\n\n为了最小化MAE，我们定义目标函数 $J_{\\mathrm{MAE}}(b)$：\n$$\nJ_{\\mathrm{MAE}}(b) = \\frac{1}{N} \\sum_{i=1}^{N} |e_{i}(b)| = \\frac{1}{N} \\sum_{i=1}^{N} |e_{i}(0) + b|\n$$\n最小化 $J_{\\mathrm{MAE}}(b)$ 等价于最小化绝对偏差之和 $\\sum_{i=1}^{N} |e_{i}(0) - (-b)|$。根据统计学的第一性原理，当点 $-b$ 是值集合 $\\{e_{i}(0)\\}$ 的中位数时，此和最小。因此，最优偏差为 $b_{\\mathrm{MAE}} = -\\mathrm{median}\\{e_{i}(0)\\}$。\n为了找到中位数，我们将初始残差排序：\n$$\n\\{ -14.8, -6.2, -2.9, -1.1, -0.7, 0.0, 1.6, 2.1, 3.9, 4.0, 5.3, 7.5 \\}\n$$\n由于 $N=12$ 是偶数，中位数是中间两个值，即第 $6$ 个和第 $7$ 个元素的平均值：\n$$\n\\mathrm{median}\\{e_{i}(0)\\} = \\frac{0.0 + 1.6}{2} = 0.8\n$$\nMAE的最优偏差为：\n$$\nb_{\\mathrm{MAE}} = -0.8 \\text{ mm/day}\n$$\n\n第三，我们对校准景观进行定性讨论。\nRMSE目标函数基于平方误差，因此 $b$ 的校准景观是一个光滑的凸抛物线。其目标函数 $L(b) = (J_{\\mathrm{RMSE}}(b))^2$ 是关于 $b$ 的二次函数，保证了存在一个唯一、明确定义的最小值，该最小值可以通过解析方法找到。平方项的关键特性是其对异常值的敏感性。大残差的权重远大于小残差。$b_{\\mathrm{RMSE}} \\approx 0.1083$ 这个值是一个小的正偏差。它受到大的负异常值 $e_6(0) = -14.8$ 的显著影响。这个单一的大误差将残差的平均值拉低至 $\\overline{e(0)} \\approx -0.1083$，因此校准通过一个正偏差进行调整以抵消这种影响。\n\nMAE目标函数基于绝对误差，其校准景观也是凸的，但并不光滑。它是分段线性的，在每个使得 $b = -e_i(0)$ 的 $b$ 值处存在不可微点（“扭结”）。其最小值点，即中位数，对异常值具有鲁棒性。极端残差的大小不影响中位数的位置，只影响其排序。对于我们的数据，残差的中位数是 $0.8$。这表明相对于该值，模型有一半时间高估，一半时间低估。大的异常值 $-14.8$ 对中位数的影响不比 $-6.2$ 的值更大。由此产生的最优偏差 $b_{\\mathrm{MAE}} = -0.8$ 表明校正是基于大部分数据的集中趋势，实际上忽略了极端异常值，并得出模型通常高估降水量的结论。$b_{\\mathrm{RMSE}} \\approx 0.1083$ 和 $b_{\\mathrm{MAE}} = -0.8$ 之间的显著差异是每种度量处理异常值方式的直接结果。\n\n最后，为了评分，我们报告 $b=0$ 时RMSE与MAE的比值。\n$$\n\\text{Ratio} = \\frac{\\mathrm{RMSE}(0)}{\\mathrm{MAE}(0)} = \\frac{\\sqrt{390.11/12}}{4.175} \\approx \\frac{5.70168}{4.175} \\approx 1.36567\n$$\n四舍五入到四位有效数字，比值为 $1.366$。",
            "answer": "$$\n\\boxed{1.366}\n$$"
        },
        {
            "introduction": "目标函数的选择并非随意的，它往往植根于对模型误差的统计假设。本练习将引导你从第一性原理出发，通过最大似然估计（MLE）方法，为一个线性偏差模型推导其目标函数。你将发现，假设误差服从高斯分布，会自然地引出我们所熟悉的最小二乘法目标函数，从而深刻理解模型校准背后的统计学基础。",
            "id": "3899935",
            "problem": "在一个区域海洋-大气再分析中，每日海面温度异常被建模为一个确定性预报和一个随机误差之和。经验诊断表明，存在一个随云量线性变化的系统性偏差。设 $o_i$ 表示第 $i$ 天观测到的海面温度异常（单位：开尔文），$m_i$ 表示第 $i$ 天的模型预报异常（单位：开尔文），$c_i$ 表示第 $i$ 天的卫星反演云量（无量纲）。假设失配 $d_i = o_i - m_i$ 由以下线性偏差模型描述\n$$\nd_i = \\beta c_i + \\epsilon_i,\n$$\n其中 $\\beta$ 是一个未知的偏差参数（斜率），$\\epsilon_i$ 是独立同分布 (i.i.d.) 的高斯误差，$\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$，其方差 $\\sigma^2$ 是一个未知常数。假设给定参数时，各天是条件独立的，并且云量 $c_i$ 的测量没有误差。\n\n要求您从第一性原理出发，以高斯似然为起点，不调用任何预先推导出的估计量公式，通过最小化关于 $\\beta$ 的相应负对数似然，来推导线性偏差参数 $\\beta$ 的最大似然估计 (MLE)。然后，使用所提供的数据，计算其数值，并在环境科学的背景下解释其符号和大小。\n\n这 $10$ 对值 $(c_i, d_i)$ 由以下集合给出\n$$\n\\{(0.10, 0.06),\\ (0.20, 0.11),\\ (0.30, 0.14),\\ (0.15, 0.08),\\ (0.50, 0.25),\\ (0.80, 0.42),\\ (0.60, 0.31),\\ (0.40, 0.19),\\ (0.70, 0.36),\\ (0.90, 0.47)\\}.\n$$\n\n计算 MLE $\\hat{\\beta}$ 并报告其数值。将您的答案四舍五入到四位有效数字。结果以单位云量的开尔文数表示。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观，并包含足够的信息来推导唯一解。它代表了环境建模中一个标准的参数估计任务。\n\n目标是找到偏差参数 $\\beta$ 的最大似然估计 (MLE)，其模型为 $d_i = \\beta c_i + \\epsilon_i$。其中 $d_i$ 是观测 ($o_i$) 与模型 ($m_i$) 海面温度异常之间的失配，$c_i$ 是云量，$\\epsilon_i$ 是均值为 $0$、方差为未知 $\\sigma^2$ 的独立同分布 (i.i.d.) 高斯误差。\n\n单个数据点 $i$ 的模型是 $d_i = \\beta c_i + \\epsilon_i$。整理误差项，我们得到 $\\epsilon_i = d_i - \\beta c_i$。问题陈述 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$，这意味着随机变量 $d_i$，在给定 $c_i$ 和参数的条件下，服从均值为 $\\beta c_i$、方差为 $\\sigma^2$ 的高斯分布：\n$$\nd_i | c_i, \\beta, \\sigma^2 \\sim \\mathcal{N}(\\beta c_i, \\sigma^2)\n$$\n因此，单个观测值 $d_i$ 的概率密度函数 (PDF) 为：\n$$\np(d_i | c_i, \\beta, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(d_i - \\beta c_i)^2}{2\\sigma^2} \\right)\n$$\n观测值被假定为条件独立的。整个包含 $N$ 个观测值的数据集的似然函数 $L(\\beta, \\sigma^2)$ 是各个概率密度函数的乘积：\n$$\nL(\\beta, \\sigma^2) = \\prod_{i=1}^{N} p(d_i | c_i, \\beta, \\sigma^2) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(d_i - \\beta c_i)^2}{2\\sigma^2} \\right)\n$$\n这可以改写为：\n$$\nL(\\beta, \\sigma^2) = \\left( \\frac{1}{2\\pi\\sigma^2} \\right)^{N/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2 \\right)\n$$\n为了找到 MLE，我们通常处理对数似然函数 $\\mathcal{L}(\\beta, \\sigma^2) = \\ln L(\\beta, \\sigma^2)$，因为它将乘积转换为和，这在数学上更容易处理。\n$$\n\\mathcal{L}(\\beta, \\sigma^2) = \\ln\\left[ \\left( \\frac{1}{2\\pi\\sigma^2} \\right)^{N/2} \\right] + \\ln\\left[ \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2 \\right) \\right]\n$$\n$$\n\\mathcal{L}(\\beta, \\sigma^2) = -\\frac{N}{2} \\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2\n$$\n问题要求通过最小化负对数似然 $-\\mathcal{L}(\\beta, \\sigma^2)$ 来找到 $\\beta$ 的 MLE：\n$$\n-\\mathcal{L}(\\beta, \\sigma^2) = \\frac{N}{2} \\ln(2\\pi\\sigma^2) + \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2\n$$\n为了找到使该函数最小化的 $\\beta$ 值，我们可以对 $\\beta$ 求偏导数并将其设为零。请注意，由于 $\\beta$ 只出现在残差平方和项中，因此关于 $\\beta$ 最大化似然函数等价于最小化残差平方和 $J(\\beta) = \\sum_{i=1}^{N} (d_i - \\beta c_i)^2$。这证明了在高斯误差下，最大似然估计 (MLE) 与普通最小二乘法 (OLS) 的等价性。\n$$\n\\frac{\\partial}{\\partial \\beta} \\left( -\\mathcal{L}(\\beta, \\sigma^2) \\right) = \\frac{\\partial}{\\partial \\beta} \\left( \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2 \\right) = 0\n$$\n因为 $\\frac{1}{2\\sigma^2}$ 是一个正常数，我们只需要对求和项求导：\n$$\n\\frac{\\partial}{\\partial \\beta} \\sum_{i=1}^{N} (d_i - \\beta c_i)^2 = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\beta} (d_i - \\beta c_i)^2\n$$\n使用链式法则：\n$$\n\\sum_{i=1}^{N} 2(d_i - \\beta c_i) \\cdot (-c_i) = -2 \\sum_{i=1}^{N} (d_i c_i - \\beta c_i^2)\n$$\n将此导数设为零以求得估计量 $\\hat{\\beta}$：\n$$\n-2 \\sum_{i=1}^{N} (d_i c_i - \\hat{\\beta} c_i^2) = 0\n$$\n$$\n\\sum_{i=1}^{N} d_i c_i - \\hat{\\beta} \\sum_{i=1}^{N} c_i^2 = 0\n$$\n求解 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} \\sum_{i=1}^{N} c_i^2 = \\sum_{i=1}^{N} d_i c_i\n$$\n$$\n\\hat{\\beta} = \\frac{\\sum_{i=1}^{N} d_i c_i}{\\sum_{i=1}^{N} c_i^2}\n$$\n这就是推导出的 $\\beta$ 的最大似然估计量的公式。\n\n现在，我们使用提供的 $N=10$ 对 $(c_i, d_i)$ 数据计算 $\\hat{\\beta}$ 的数值。数据为：\n$\\{(0.10, 0.06), (0.20, 0.11), (0.30, 0.14), (0.15, 0.08), (0.50, 0.25), (0.80, 0.42), (0.60, 0.31), (0.40, 0.19), (0.70, 0.36), (0.90, 0.47)\\}$.\n\n首先，我们计算分子 $\\sum_{i=1}^{10} d_i c_i$：\n$ (0.06)(0.10) + (0.11)(0.20) + (0.14)(0.30) + (0.08)(0.15) + (0.25)(0.50) + (0.42)(0.80) + (0.31)(0.60) + (0.19)(0.40) + (0.36)(0.70) + (0.47)(0.90) $\n$ = 0.0060 + 0.0220 + 0.0420 + 0.0120 + 0.1250 + 0.3360 + 0.1860 + 0.0760 + 0.2520 + 0.4230 = 1.4800 $\n\n接下来，我们计算分母 $\\sum_{i=1}^{10} c_i^2$：\n$ (0.10)^2 + (0.20)^2 + (0.30)^2 + (0.15)^2 + (0.50)^2 + (0.80)^2 + (0.60)^2 + (0.40)^2 + (0.70)^2 + (0.90)^2 $\n$ = 0.0100 + 0.0400 + 0.0900 + 0.0225 + 0.2500 + 0.6400 + 0.3600 + 0.1600 + 0.4900 + 0.8100 = 2.8725 $\n\n最后，我们计算 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} = \\frac{1.4800}{2.8725} \\approx 0.5152341166\n$$\n四舍五入到四位有效数字，我们得到 $\\hat{\\beta} \\approx 0.5152$。\n\n$\\hat{\\beta}$ 的单位是 $d_i$ 的单位（开尔文）除以 $c_i$ 的单位（无量纲），结果是开尔文 ($K$)。它可以被解释为每单位云量的开尔文数。\n\n解释：估计参数 $\\hat{\\beta} \\approx 0.5152$ 为正值。这表明云量 $c_i$ 与模型偏差 $d_i = o_i - m_i$ 之间存在正向线性关系。随着云量的增加，模型预报值 $m_i$ 相对于观测到的温度异常值 $o_i$ 变得越来越小。这通常被称为“冷偏差”，并且该偏差会因云量的增加而加剧。其数值大小表明，对于完全被云覆盖的天空 ($c_i=1$)，模型预报预计平均比观测现实冷 $0.5152$ 开尔文。相反，对于晴朗天空 ($c_i=0$)，这个特定的偏差项消失。这是一个物理上合理的发现，因为云-辐射反馈机制是气候和天气模型中误差和偏差的重要来源。",
            "answer": "$$\n\\boxed{0.5152}\n$$"
        },
        {
            "introduction": "真实世界的环境数据常常包含离群值，这会对基于最小二乘法的模型校准产生不成比例的影响。本练习引入了一种先进的稳健目标函数——Huber 损失函数，它巧妙地结合了二次损失和线性损失的优点。通过这个实践，你将学会如何利用这种混合度量来减小离群值对参数估计的干扰，并理解其调节参数如何帮助我们在拟合优度和稳健性之间取得平衡。",
            "id": "3899944",
            "problem": "在环境与地球系统建模的一个简化校准情景中，考虑在一个降水模型中调整一个标量加性偏差参数 $b$，以便在短期内使模拟的日降水强度与观测值对齐。设观测减去模拟的日降水残差为 $e_i = o_i - m_i$（$i = 1, \\dots, 7$），单位为 $\\mathrm{mm\\,day^{-1}}$。假设残差为\n$$\ne_1 = -4,\\quad e_2 = -1,\\quad e_3 = 0,\\quad e_4 = 1,\\quad e_5 = 2,\\quad e_6 = 3,\\quad e_7 = 8.\n$$\n校准参数 $b$ 对模型进行加性调整，产生残差 $r_i(b) = e_i - b$。稳健校准旨在通过对小残差施加二次惩罚，对大残差施加线性惩罚，来减少异常值的过度影响，其中一个可调阈值 $\\delta$ 控制着这两种惩罚机制之间的转换。Huber型目标函数 $J_{\\delta}(b)$ 是每日贡献的总和，即 $J_{\\delta}(b) = \\sum_{i=1}^{7} \\rho_{\\delta}\\big(r_i(b)\\big)$，其中当 $|r_i(b)|$ 低于阈值 $\\delta$ 时，惩罚是二次的；当 $|r_i(b)|$ 高于阈值时，惩罚是线性的。\n\n从基于残差的失配最小化和在核心区域为二次、在尾部为线性的稳健惩罚设计原则出发，推导Huber惩罚 $\\rho_{\\delta}(r)$ 及其一阶导数的显式数学形式。然后，利用凸目标函数的一阶最优性条件，计算当 $\\delta = 2\\,\\mathrm{mm\\,day^{-1}}$ 和 $\\delta = 10\\,\\mathrm{mm\\,day^{-1}}$ 时，使 $J_{\\delta}(b)$ 最小化的偏差 $b^{\\star}$。对于每个 $\\delta$，也计算最小化的目标函数值 $J_{\\delta}\\big(b^{\\star}\\big)$。\n\n将最终校准的偏差值 $b^{\\star}$ 以 $\\mathrm{mm\\,day^{-1}}$ 为单位表示，将最小化的目标函数值 $J_{\\delta}\\big(b^{\\star}\\big)$ 以 $\\big(\\mathrm{mm\\,day^{-1}}\\big)^{2}$ 为单位表示。将所有报告的数值四舍五入到四位有效数字。你的最终答案必须是一个单行矩阵，按顺序包含 $\\delta=2$ 时的 $b^{\\star}$、$J_{2}\\big(b^{\\star}\\big)$，以及 $\\delta=10$ 时的 $b^{\\star}$ 和 $J_{10}\\big(b^{\\star}\\big)$。",
            "solution": "用户的请求是一个有效的科学问题。\n\n### 步骤1：Huber惩罚函数及其导数的推导\n\n问题描述了一个稳健惩罚函数 $\\rho_{\\delta}(r)$，它对小残差 ($|r| \\le \\delta$) 是二次的，对大残差 ($|r| > \\delta$) 是线性的。为确保整个目标函数是凸且可微的，我们必须构造 $\\rho_{\\delta}(r)$ 使其处处连续可微 ($C^1$)。\n\n对于二次区域，我们将惩罚定义为：\n$$\n\\rho_{\\delta}(r) = \\frac{1}{2} r^2 \\quad \\text{for } |r| \\le \\delta\n$$\n因子 $\\frac{1}{2}$ 是一个简化导数的标准惯例。在此区域的导数是：\n$$\n\\rho'_{\\delta}(r) = r \\quad \\text{for } |r| \\le \\delta\n$$\n在过渡点 $r = \\pm\\delta$ 处，函数值及其导数是：\n$$\n\\rho_{\\delta}(\\pm\\delta) = \\frac{1}{2}\\delta^2\n$$\n$$\n\\rho'_{\\delta}(\\pm\\delta) = \\pm\\delta\n$$\n对于线性区域 $|r| > \\delta$，函数必须匹配这些值和斜率。对于 $r > \\delta$，我们需要一条斜率为 $m = \\delta$ 且通过点 $(\\delta, \\frac{1}{2}\\delta^2)$ 的直线。使用点斜式 $y - y_1 = m(x-x_1)$:\n$$\n\\rho_{\\delta}(r) - \\frac{1}{2}\\delta^2 = \\delta(r - \\delta)\n$$\n$$\n\\rho_{\\delta}(r) = \\delta r - \\delta^2 + \\frac{1}{2}\\delta^2 = \\delta r - \\frac{1}{2}\\delta^2 \\quad \\text{for } r > \\delta\n$$\n由于惩罚函数必须是 $r$ 的偶函数（即 $\\rho_{\\delta}(r) = \\rho_{\\delta}(-r)$），因此通过将 $r$ 替换为 $|r|$ 可以找到 $r  -\\delta$ 时的表达式：\n$$\n\\rho_{\\delta}(r) = \\delta|r| - \\frac{1}{2}\\delta^2 \\quad \\text{for } |r| > \\delta\n$$\n综合这些，Huber惩罚函数是：\n$$\n\\rho_{\\delta}(r) = \\begin{cases}\n\\frac{1}{2} r^2  \\text{if } |r| \\le \\delta \\\\\n\\delta |r| - \\frac{1}{2} \\delta^2  \\text{if } |r| > \\delta\n\\end{cases}\n$$\n其导数 $\\rho'_{\\delta}(r)$ 通过对每一部分进行微分得到：\n$$\n\\rho'_{\\delta}(r) = \\begin{cases}\n-\\delta  \\text{if } r  -\\delta \\\\\nr  \\text{if } -\\delta \\le r \\le \\delta \\\\\n\\delta  \\text{if } r > \\delta\n\\end{cases}\n$$\n这个导数是连续的，可以紧凑地写成 $\\rho'_{\\delta}(r) = \\text{median}(-\\delta, r, \\delta)$。\n\n### 步骤2：一阶最优性条件\n\n要最小化的目标函数是 $J_{\\delta}(b) = \\sum_{i=1}^{7} \\rho_{\\delta}(r_i(b))$，其中 $r_i(b) = e_i - b$。Huber损失 $\\rho_{\\delta}$ 是一个凸函数。由于凸函数的和也是凸函数，所以 $J_{\\delta}(b)$ 也是凸函数。一个凸且可微函数的最小值 $b^{\\star}$ 可以通过将其一阶导数设为零（一阶最优性条件）来找到。\n$$\n\\frac{dJ_{\\delta}}{db}(b) = \\sum_{i=1}^{7} \\frac{d}{db} \\rho_{\\delta}(e_i - b) = 0\n$$\n使用链式法则，$\\frac{d}{db}\\rho_{\\delta}(e_i - b) = \\rho'_{\\delta}(e_i - b) \\cdot (-1)$。该条件变为：\n$$\n\\sum_{i=1}^{7} \\left(-\\rho'_{\\delta}(e_i - b)\\right) = 0 \\implies \\sum_{i=1}^{7} \\rho'_{\\delta}(e_i - b) = 0\n$$\n我们需要对给定的两个 $\\delta$ 值，解这个关于 $b^{\\star}$ 的非线性方程。残差数据为 $e = \\{-4, -1, 0, 1, 2, 3, 8\\}$。\n\n### 步骤3：计算 $\\delta = 2\\,\\mathrm{mm\\,day^{-1}}$ 的情况\n\n当 $\\delta=2$ 时，最优性条件为：\n$$\n\\sum_{i=1}^{7} \\rho'_{2}(e_i - b) = \\sum_{i=1}^{7} \\text{median}(-2, e_i - b, 2) = 0\n$$\n我们寻找一个满足此方程的 $b$ 值。让我们测试一下中心数据点均值附近的整数 $b$ 值。考虑 $b^{\\star}=1$。调整后的残差 $r_i(1) = e_i - 1$ 为：\n$$\n\\{-4-1, -1-1, 0-1, 1-1, 2-1, 3-1, 8-1\\} = \\{-5, -2, -1, 0, 1, 2, 7\\}\n$$\n现在我们计算各项 $\\rho'_{2}(r_i(1))$：\n\\begin{itemize}\n    \\item $\\rho'_{2}(-5) = \\text{median}(-2, -5, 2) = -2$ (因为 $-5  -2$)\n    \\item $\\rho'_{2}(-2) = \\text{median}(-2, -2, 2) = -2$ (因为 $-2 \\le -2 \\le 2$)\n    \\item $\\rho'_{2}(-1) = \\text{median}(-2, -1, 2) = -1$ (因为 $-2 \\le -1 \\le 2$)\n    \\item $\\rho'_{2}(0) = \\text{median}(-2, 0, 2) = 0$ (因为 $-2 \\le 0 \\le 2$)\n    \\item $\\rho'_{2}(1) = \\text{median}(-2, 1, 2) = 1$ (因为 $-2 \\le 1 \\le 2$)\n    \\item $\\rho'_{2}(2) = \\text{median}(-2, 2, 2) = 2$ (因为 $-2 \\le 2 \\le 2$)\n    \\item $\\rho'_{2}(7) = \\text{median}(-2, 7, 2) = 2$ (因为 $7 > 2$)\n\\end{itemize}\n总和为 $\\sum_{i=1}^{7} \\rho'_{2}(e_i - 1) = -2 - 2 - 1 + 0 + 1 + 2 + 2 = 0$。\n该条件得到满足，因此最优偏差为 $b^{\\star} = 1\\,\\mathrm{mm\\,day^{-1}}$。\n\n接下来，我们使用调整后的残差 $r_i = \\{-5, -2, -1, 0, 1, 2, 7\\}$ 计算最小化的目标函数值 $J_{2}(b^{\\star})$。\n$$\n\\rho_{2}(r) = \\begin{cases}\n\\frac{1}{2} r^2  \\text{if } |r| \\le 2 \\\\\n2|r| - 2  \\text{if } |r| > 2\n\\end{cases}\n$$\n\\begin{itemize}\n    \\item $\\rho_{2}(-5) = 2|-5| - 2 = 10 - 2 = 8$\n    \\item $\\rho_{2}(-2) = \\frac{1}{2}(-2)^2 = 2$\n    \\item $\\rho_{2}(-1) = \\frac{1}{2}(-1)^2 = 0.5$\n    \\item $\\rho_{2}(0) = \\frac{1}{2}(0)^2 = 0$\n    \\item $\\rho_{2}(1) = \\frac{1}{2}(1)^2 = 0.5$\n    \\item $\\rho_{2}(2) = \\frac{1}{2}(2)^2 = 2$\n    \\item $\\rho_{2}(7) = 2|7| - 2 = 14 - 2 = 12$\n\\end{itemize}\n$J_{2}(b^{\\star}=1) = 8 + 2 + 0.5 + 0 + 0.5 + 2 + 12 = 25$。\n所以，$J_{2}(b^{\\star}) = 25\\,\\big(\\mathrm{mm\\,day^{-1}}\\big)^{2}$。\n\n### 步骤4：计算 $\\delta = 10\\,\\mathrm{mm\\,day^{-1}}$ 的情况\n\n当 $\\delta=10$ 时，最优性条件为 $\\sum_{i=1}^{7} \\rho'_{10}(e_i - b) = 0$。\n残差的均值为 $\\bar{e} = \\frac{1}{7}\\sum e_i = \\frac{-4-1+0+1+2+3+8}{7} = \\frac{9}{7}$。\n让我们检查一下，如果我们使用这个均值作为偏差，是否所有残差都落在二次区域内 ($|r_i| \\le \\delta$)。设 $b = 9/7$。与此偏差的最大偏离将出现在 $e_{min}=-4$ 或 $e_{max}=8$ 处。\n$e_{min} - b = -4 - \\frac{9}{7} = -\\frac{28}{7} - \\frac{9}{7} = -\\frac{37}{7} \\approx -5.29$。\n$e_{max} - b = 8 - \\frac{9}{7} = \\frac{56}{7} - \\frac{9}{7} = \\frac{47}{7} \\approx 6.71$。\n由于 $|-5.29|  10$ 且 $|6.71|  10$，所有调整后的残差 $|e_i - b|$ 都将小于 $\\delta=10$。\n因此，对于所有的 $i$，我们都处于二次惩罚机制中，其中 $\\rho'_{10}(r) = r$。最优性条件简化为：\n$$\n\\sum_{i=1}^{7} (e_i - b) = 0\n$$\n这是标准的最小二乘问题，其解是残差的样本均值：\n$$\nb^{\\star} = \\frac{1}{7} \\sum_{i=1}^{7} e_i = \\frac{9}{7}\\,\\mathrm{mm\\,day^{-1}}\n$$\n接下来，我们计算最小化的目标函数值 $J_{10}(b^{\\star})$。由于所有的 $|r_i| \\le 10$，我们使用 $\\rho_{10}(r) = \\frac{1}{2}r^2$。\n$$\nJ_{10}(b^{\\star}) = \\sum_{i=1}^{7} \\frac{1}{2} (e_i - b^{\\star})^2 = \\frac{1}{2}\\sum_{i=1}^{7} (e_i - \\bar{e})^2\n$$\n残差平方和与样本方差有关。我们可以将其计算为 $\\sum e_i^2 - n(\\bar{e})^2$:\n$$\n\\sum_{i=1}^{7} e_i^2 = (-4)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 + 3^2 + 8^2 = 16 + 1 + 0 + 1 + 4 + 9 + 64 = 95\n$$\n$$\nn(\\bar{e})^2 = 7 \\left(\\frac{9}{7}\\right)^2 = 7 \\frac{81}{49} = \\frac{81}{7}\n$$\n$$\n\\sum_{i=1}^{7} (e_i - \\bar{e})^2 = 95 - \\frac{81}{7} = \\frac{665 - 81}{7} = \\frac{584}{7}\n$$\n所以，目标函数值为：\n$$\nJ_{10}(b^{\\star}) = \\frac{1}{2} \\left(\\frac{584}{7}\\right) = \\frac{292}{7}\\,\\big(\\mathrm{mm\\,day^{-1}}\\big)^{2}\n$$\n\n### 步骤5：最终数值\n\n问题要求将数值报告为四位有效数字。\n当 $\\delta=2$ 时：\n$b^{\\star} = 1.000\\,\\mathrm{mm\\,day^{-1}}$\n$J_{2}(b^{\\star}) = 25.00\\,\\big(\\mathrm{mm\\,day^{-1}}\\big)^{2}$\n\n当 $\\delta=10$ 时：\n$b^{\\star} = \\frac{9}{7} \\approx 1.285714...\\,\\mathrm{mm\\,day^{-1}}$，保留四位有效数字是 $1.286$。\n$J_{10}(b^{\\star}) = \\frac{292}{7} \\approx 41.714285...\\,\\big(\\mathrm{mm\\,day^{-1}}\\big)^{2}$，保留四位有效数字是 $41.71$。\n\n最终答案以一个行矩阵的形式呈现，按顺序包含这四个值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.000  25.00  1.286  41.71 \\end{pmatrix}}\n$$"
        }
    ]
}