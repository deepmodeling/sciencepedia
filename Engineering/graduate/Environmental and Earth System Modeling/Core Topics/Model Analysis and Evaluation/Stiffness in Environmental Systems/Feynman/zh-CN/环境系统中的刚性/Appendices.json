{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了刚性问题的核心特征。通过分析一个简单的化学物质一阶衰变模型，我们可以清晰地揭示为何显式数值方法在处理快速过程时会失效，以及为何隐式方法在这种情况下是必需的 。这个实践旨在通过经典的Dahlquist测试方程，帮助您建立稳定性分析的基本直觉，这是理解和解决环境系统中刚性问题的基石。",
            "id": "3916079",
            "problem": "在环境和地球系统建模中，一个简化但具有代表性的刚性过程是高活性溶解物质在均匀混合控制体积中的一阶衰变。设浓度由常微分方程 $y'(t) = -1000\\,y(t)$ 及其初始条件 $y(0) = y_{0}$ 建模，其中大的衰变系数模拟了相对于平流或扩散传输的快速化学汇。考虑两种广泛用于初值问题的时间步进方法：前向欧拉法和后向欧拉法。仅使用这些方法作为 $y'(t)$ 的单步离散化的定义，推导每种方法应用于此方程时的线性单步更新式，并由此获得单步放大因子 $g(\\Delta t)$，使得每种方法都满足 $y_{n+1} = g(\\Delta t)\\,y_{n}$。计算每种方法在两个时间步长 $\\Delta t = 0.001$ 和 $\\Delta t = 1$ 下的放大因子大小 $|g(\\Delta t)|$。解释这些值对于与刚性相关的误差动态和稳定性的影响，讨论在刚性环境子系统典型的快速衰变背景下，每种方法在这些步长下的表现。将最终答案以单行矩阵的形式给出，按顺序包含四个精确值 $|g_{\\text{FE}}(0.001)|$、 $|g_{\\text{BE}}(0.001)|$、 $|g_{\\text{FE}}(1)|$ 和 $|g_{\\text{BE}}(1)|$，不带单位且不进行四舍五入。",
            "solution": "首先评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：浓度 $y(t)$ 由常微分方程 (ODE) $y'(t) = -1000\\,y(t)$ 建模。\n-   **初始条件**：$y(0) = y_{0}$。\n-   **数值方法**：前向欧拉法和后向欧拉法。\n-   **任务 1**：推导每种方法的单步更新式。\n-   **任务 2**：找到单步放大因子 $g(\\Delta t)$，使得每种方法都满足 $y_{n+1} = g(\\Delta t)\\,y_{n}$。\n-   **任务 3**：计算每种方法在 $\\Delta t = 0.001$ 和 $\\Delta t = 1$ 时的 $|g(\\Delta t)|$。\n-   **任务 4**：在刚性、误差动态和稳定性的背景下解释结果。\n-   **答案格式**：一个包含四个精确值 $|g_{\\text{FE}}(0.001)|$、 $|g_{\\text{BE}}(0.001)|$、 $|g_{\\text{FE}}(1)|$ 和 $|g_{\\text{BE}}(1)|$ 的单行矩阵。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它提出了一个微分方程数值分析领域的标准问题，具体来说是使用 Dahlquist 的测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda = -1000$）来分析基本数值积分器的稳定性。这是一个用于说明常微分方程中刚性概念的典型问题。所提供的背景，即环境模型中的快速化学汇，是一个现实且恰当的应用。该问题是适定的，提供了推导唯一、有意义解所需的所有信息。术语精确且客观。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 求解推导\n\n给定的常微分方程是一个线性、一阶、齐次、常系数方程：\n$$y'(t) = -1000\\,y(t)$$\n设 $y_n$ 是解 $y(t_n)$ 在时间 $t_n = n \\Delta t$ 处的数值近似，其中 $\\Delta t$ 是时间步长。该常微分方程的一般形式为 $y'(t) = f(t, y(t))$，对于本问题，$f(t, y) = -1000 y$。\n\n**1. 前向欧拉法**\n\n前向欧拉（FE）法是一种显式单步法，由以下递推关系定义：\n$$y_{n+1} = y_n + \\Delta t\\,f(t_n, y_n)$$\n将给定函数 $f(t_n, y_n) = -1000\\,y_n$ 代入 FE 公式，得到：\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_n)$$\n提取公因子 $y_n$ 得到单步更新规则：\n$$y_{n+1} = (1 - 1000\\,\\Delta t)\\,y_n$$\n将此式与 $y_{n+1} = g(\\Delta t)\\,y_n$ 形式进行比较，我们确定前向欧拉法的放大因子 $g_{\\text{FE}}(\\Delta t)$ 为：\n$$g_{\\text{FE}}(\\Delta t) = 1 - 1000\\,\\Delta t$$\n\n**2. 后向欧拉法**\n\n后向欧拉（BE）法是一种隐式单步法，由以下递推关系定义：\n$$y_{n+1} = y_n + \\Delta t\\,f(t_{n+1}, y_{n+1})$$\n注意函数 $f$ 是在未来的时间步 $t_{n+1}$ 处进行计算的。将给定函数 $f(t_{n+1}, y_{n+1}) = -1000\\,y_{n+1}$ 代入 BE 公式，得到：\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_{n+1})$$\n这是一个关于未知数 $y_{n+1}$ 的方程。我们必须通过代数方法求解它：\n$$y_{n+1} + 1000\\,\\Delta t\\,y_{n+1} = y_n$$\n$$y_{n+1}(1 + 1000\\,\\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 + 1000\\,\\Delta t}\\,y_n$$\n将此式与 $y_{n+1} = g(\\Delta t)\\,y_n$ 形式进行比较，我们确定后向欧拉法的放大因子 $g_{\\text{BE}}(\\Delta t)$ 为：\n$$g_{\\text{BE}}(\\Delta t) = \\frac{1}{1 + 1000\\,\\Delta t}$$\n\n**3. 放大因子的计算**\n\n现在我们在指定的时间步长下计算每种方法的放大因子大小 $|g(\\Delta t)|$。\n\n**情况 1：$\\Delta t = 0.001$**\n\n-   对于前向欧拉法：\n    $$g_{\\text{FE}}(0.001) = 1 - 1000(0.001) = 1 - 1 = 0$$\n    $$|g_{\\text{FE}}(0.001)| = |0| = 0$$\n-   对于后向欧拉法：\n    $$g_{\\text{BE}}(0.001) = \\frac{1}{1 + 1000(0.001)} = \\frac{1}{1 + 1} = \\frac{1}{2}$$\n    $$|g_{\\text{BE}}(0.001)| = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$$\n\n**情况 2：$\\Delta t = 1$**\n\n-   对于前向欧拉法：\n    $$g_{\\text{FE}}(1) = 1 - 1000(1) = -999$$\n    $$|g_{\\text{FE}}(1)| = |-999| = 999$$\n-   对于后向欧拉法：\n    $$g_{\\text{BE}}(1) = \\frac{1}{1 + 1000(1)} = \\frac{1}{1001}$$\n    $$|g_{\\text{BE}}(1)| = \\left|\\frac{1}{1001}\\right| = \\frac{1}{1001}$$\n\n**4. 关于刚性的解释和影响**\n\n$y'(t) = -1000\\,y(t)$ 的真实解是 $y(t) = y_0 \\exp(-1000 t)$，它会迅速衰减到零。一个数值稳定的方法应该产生一个同样衰减的解，这意味着数值解的大小不应增加。这要求放大因子的大小小于或等于 1：$|g(\\Delta t)| \\leq 1$。\n\n-   **前向欧拉法（显式法）**：\n    稳定性条件是 $|g_{\\text{FE}}(\\Delta t)| = |1 - 1000\\,\\Delta t| \\leq 1$。该不等式仅在 $-1 \\leq 1 - 1000\\,\\Delta t \\leq 1$ 时成立，可简化为 $0 \\leq \\Delta t \\leq \\frac{2}{1000} = 0.002$。因此，FE 方法的稳定性是受时间步长限制的（条件稳定）。\n    -   当 $\\Delta t = 0.001$ 时，满足条件。$|g_{\\text{FE}}(0.001)| = 0 \\leq 1$，因此该方法是稳定的。事实上，它的耗散性如此之强，以至于在单步内就将解衰减到零。\n    -   当 $\\Delta t = 1$ 时，不满足条件。$|g_{\\text{FE}}(1)| = 999 \\gg 1$。该方法是剧烈不稳定的。每一步都将前一个值放大 -999 倍，导致灾难性的误差增长并伴有符号振荡，这是刚性系统数值不稳定性的一个标志。\n\n-   **后向欧拉法（隐式法）**：\n    稳定性条件是 $|g_{\\text{BE}}(\\Delta t)| = |\\frac{1}{1 + 1000\\,\\Delta t}| \\leq 1$。由于 $\\Delta t > 0$，分母 $1 + 1000\\,\\Delta t$ 总是大于 1。因此，对于所有 $\\Delta t > 0$，都有 $0  g_{\\text{BE}}(\\Delta t)  1$。其大小总是小于 1。BE 方法对于此问题是无条件稳定的（这一性质被称为 A-稳定性）。\n    -   当 $\\Delta t = 0.001$ 时， $|g_{\\text{BE}}(0.001)| = 1/2  1$。该方法是稳定的，并产生一个衰减的解。\n    -   当 $\\Delta t = 1$ 时， $|g_{\\text{BE}}(1)| = 1/1001  1$。该方法仍然保持稳定，即使时间步长比衰减的特征时间尺度（$1/1000$）大几个数量级。\n\n**关于刚性的结论**：这个问题很好地说明了刚性。快速衰减过程（特征时间为 $1/1000\\,s$）对显式前向欧拉法施加了严格的稳定性约束（$\\Delta t \\leq 0.002\\,s$），即使我们关心的是更长时间尺度上的系统动态。隐式后向欧拉法是无条件稳定的，不受此约束，可以采用大的时间步长，这使得它在求解刚性系统时效率要高得多，例如在环境建模中常见的那样，其中化学、物理和生物过程在截然不同的时间尺度上发生。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{2}  999  \\frac{1}{1001}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了刚性的基本概念后，我们将把问题扩展到更真实的空间分布系统，即偏微分方程（PDE）描述的污染物输运过程。在环境模型中，刚性常常源于多个物理和化学过程（如对流、扩散和反应）以截然不同的速率同时发生 。本练习将指导您如何通过分析每个过程对显式方法稳定性的限制，来诊断刚性的来源，并理解最快的过程如何决定整个模型的计算时间步长。",
            "id": "3916122",
            "problem": "一种守恒反应性溶质沿着一个笔直、均匀的一维河段输运，该河段的长度远大于网格间距。横截面平均浓度 $C(x,t)$ 的控制方程是线性平流-扩散-反应方程\n$\\displaystyle \\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C$，\n其中 $u$ 是平均流速，$D$ 是有效纵向弥散系数，$k$ 是一阶衰减率。考虑一个间距为 $\\Delta x$ 的均匀网格，并采用一种显式时间推进方法，该方法在时间上使用前向欧拉法，对流项使用一阶迎风格式（对于 $u0$），扩散项使用中心二阶有限差分。\n\n从守恒定律和这些离散化选择出发，通过要求每个网格点的更新是当前及相邻单元浓度的非负贡献与衰减损失的凸组合，推导出一个充分的稳定性和单调性条件。利用该条件，得到一个以 $u$、$D$、$k$ 和 $\\Delta x$ 表示的显式时间步长 $\\Delta t$ 的单一闭式上界。然后，对于 $\\Delta x = 50$ 米，$u = 0.5$ 米/秒，$D = 0.01$ 米$^{2}$/秒，以及 $k = 0.2$ 秒$^{-1}$，评估最严格的允许显式时间步长。\n\n最后，根据特征过程时间尺度，简要解释计算出的边界对该问题的数值刚度意味着什么，以及哪个过程主导了这一限制。\n\n将最终的数值时间步长四舍五入到四位有效数字。以秒为单位表示时间步长。",
            "solution": "首先验证问题的科学合理性、适定性、客观性，并确保其包含所有必要信息。所给出的控制方程是标准的一维平流-扩散-反应方程，这是环境输运现象中的一个基本模型。指定的数值格式（前向欧拉法、一阶迎风、二阶中心差分）是标准的显式方法。所有必需的参数（$u$、$D$、$k$、$\\Delta x$）都以一致的单位给出。因此，该问题被认为是有效的，有必要给出完整解答。\n\n浓度 $C(x, t)$ 的控制方程为：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C\n$$\n我们为时间推进格式重新整理该方程：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C\n$$\n设 $C_j^n$ 表示 $C(j\\Delta x, n\\Delta t)$ 的数值近似，其中 $\\Delta x$ 是均匀网格间距，$\\Delta t$ 是时间步长。我们按要求对每一项进行离散化：\n1.  **时间导数（前向欧拉法）**：\n    $$\n    \\frac{\\partial C}{\\partial t} \\approx \\frac{C_j^{n+1} - C_j^n}{\\Delta t}\n    $$\n2.  **对流项（对于 $u0$ 的一阶迎风格式）**：\n    $$\n    -u \\frac{\\partial C}{\\partial x} \\approx -u \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n    $$\n3.  **扩散项（中心二阶格式）**：\n    $$\n    D \\frac{\\partial^{2} C}{\\partial x^{2}} \\approx D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2}\n    $$\n4.  **反应项**：\n    $$\n    -kC \\approx -kC_j^n\n    $$\n将这些离散格式组合起来，得到完整的有限差分方程：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = -u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} + D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2} - kC_j^n\n$$\n为了推导稳定性和单调性条件，我们求解 $C_j^{n+1}$，并按时间步长 $n$ 的浓度空间位置对各项进行分组：\n$$\nC_j^{n+1} = C_j^n - \\Delta t \\left( u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} \\right) + \\Delta t \\left( D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2} \\right) - \\Delta t (kC_j^n)\n$$\n重新整理并收集 $C_{j-1}^n$、$C_j^n$ 和 $C_{j+1}^n$ 的系数：\n$$\nC_j^{n+1} = \\left( \\frac{u \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2} \\right) C_{j-1}^n + \\left( 1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{2 D \\Delta t}{(\\Delta x)^2} - k \\Delta t \\right) C_j^n + \\left( \\frac{D \\Delta t}{(\\Delta x)^2} \\right) C_{j+1}^n\n$$\n问题要求 $C_j^{n+1}$ 的更新是来自相邻浓度的非负贡献的凸组合，这是单调性（以及在假设 $C^n \\ge 0$ 时的正定性）的一个条件。这意味着在 $C_j^{n+1}$ 的表达式中，$C_{j-1}^n$、$C_j^n$ 和 $C_{j+1}^n$ 的所有系数都必须是非负的。\n1.  $C_{j+1}^n$ 的系数：$\\frac{D \\Delta t}{(\\Delta x)^2} \\ge 0$。这是成立的，因为 $D \\ge 0$，$\\Delta t  0$。\n2.  $C_{j-1}^n$ 的系数：$\\frac{u \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2} \\ge 0$。这是成立的，因为 $u  0$，$D \\ge 0$，$\\Delta t  0$，$\\Delta x  0$。\n3.  $C_j^n$ 的系数：$1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{2 D \\Delta t}{(\\Delta x)^2} - k \\Delta t \\ge 0$。这提供了稳定性约束。\n\n从第三个条件，我们可以推导出时间步长 $\\Delta t$ 的上界：\n$$\n1 \\ge \\frac{u \\Delta t}{\\Delta x} + \\frac{2 D \\Delta t}{(\\Delta x)^2} + k \\Delta t\n$$\n$$\n1 \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k \\right)\n$$\n求解 $\\Delta t$ 得到单一的闭式上界：\n$$\n\\Delta t \\le \\frac{1}{\\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k}\n$$\n现在，我们使用给定的数值来评估这个界限：$\\Delta x = 50$ 米，$u = 0.5$ 米/秒，$D = 0.01$ 米$^{2}$/秒，以及 $k = 0.2$ 秒$^{-1}$。\n分母中的各项是：\n- 平流贡献：$\\frac{u}{\\Delta x} = \\frac{0.5 \\text{ m/s}}{50 \\text{ m}} = 0.01 \\text{ s}^{-1}$。\n- 扩散贡献：$\\frac{2D}{(\\Delta x)^2} = \\frac{2(0.01 \\text{ m}^2/\\text{s})}{(50 \\text{ m})^2} = \\frac{0.02}{2500} \\text{ s}^{-1} = 0.000008 \\text{ s}^{-1}$。\n- 反应贡献：$k = 0.2 \\text{ s}^{-1}$。\n\n分母中的和是：\n$$\n0.01 + 0.000008 + 0.2 = 0.210008 \\text{ s}^{-1}\n$$\n最大允许时间步长是这个和的倒数：\n$$\n\\Delta t_{\\text{max}} = \\frac{1}{0.210008 \\text{ s}^{-1}} \\approx 4.761729 \\text{ s}\n$$\n四舍五入到四位有效数字，最严格的允许显式时间步长是 $4.762$ 秒。\n\n最后，我们解释数值刚度问题。常微分方程组（由偏微分方程的空间离散化产生）的刚性源于存在差异巨大的特征时间尺度。显式方法的稳定性由最快的过程（最短的时间尺度）决定。\n稳定性条件 $\\frac{1}{\\Delta t} \\ge \\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k$ 表明，总的时间步长限制是来自每个独立过程（平流、扩散和反应）限制的倒数之和。我们可以确定与每个过程的稳定性极限相关的特征时间尺度：\n- 平流时间尺度（库朗数限制）：$\\tau_{\\text{adv}} = \\frac{\\Delta x}{u} = \\frac{50}{0.5} = 100$ 秒。\n- 扩散时间尺度（傅里叶数限制）：$\\tau_{\\text{diff}} = \\frac{(\\Delta x)^2}{2D} = \\frac{50^2}{2(0.01)} = \\frac{2500}{0.02} = 125000$ 秒。\n- 反应时间尺度：$\\tau_{\\text{react}} = \\frac{1}{k} = \\frac{1}{0.2} = 5$ 秒。\n\n该系统表现出巨大的时间尺度分离：$\\tau_{\\text{react}} (5 \\text{ s}) \\ll \\tau_{\\text{adv}} (100 \\text{ s}) \\ll \\tau_{\\text{diff}} (125000 \\text{ s})$。这就是数值刚性问题的定义。最快的过程，即化学反应，决定了稳定性极限。计算出的最大时间步长 $\\Delta t_{\\text{max}} \\approx 4.762$ 秒 非常接近并由反应时间尺度 $\\tau_{\\text{react}} = 5$ 秒主导。这迫使模拟以非常小的时间步长进行以保持稳定性，尽管溶质通过平流尤其是扩散的输运发生在长得多的时间尺度上。这在计算上是低效的，并且是使用显式方法模拟刚性系统的主要挑战。主导时间步长限制的过程是一阶衰减（反应）。",
            "answer": "$$\n\\boxed{4.762}\n$$"
        },
        {
            "introduction": "前面的练习表明，隐式方法因其优越的稳定性而成为求解刚性问题的首选。然而，本练习将探讨一个更深入的挑战：即使在无条件稳定的隐式格式中，当对流占主导地位时，仍可能出现非物理的数值振荡 。我们将引入单调性的概念——这是获得物理真实解的关键属性，并探索如何通过修改离散格式来保证单调性。这个实践强调了对于刚性输运问题，仅有稳定性是不够的，还需要关注解的物理行为。",
            "id": "3916099",
            "problem": "考虑在饱和均质多孔介质中的一维反应溶质运移，该过程由平流-扩散-反应守恒定律控制：\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 C}{\\partial x^2} \\;-\\; k\\,C,\n$$\n其中 $C(x,t)$ 是水相浓度，$v$ 是孔隙水流速，$D$ 是水动力弥散系数（在本问题中，假定为纯分子扩散），$k$ 是一级衰减速率。区域为半无限的 $x \\ge 0$。初始条件和边界条件为静止初始条件和单位阶跃入流：\n$$\nC(x,0)=0 \\quad \\text{for all } x\\ge 0, \\qquad C(0,t)=1 \\quad \\text{for all } t0.\n$$\n您使用网格间距 $\\Delta x$ 对空间进行均匀离散，并使用全隐式（后向欧拉）方法以时间步长 $\\Delta t$ 进行时间推进。对于空间导数，您对一阶导数（平流项）和二阶导数（扩散项）均使用二阶中心差分。在每个时间步，这将为内部未知数 $C_i^{n+1}$ 产生一个三对角线性系统。\n\n仅使用上述守恒定律和标准中心差分公式，完成以下任务：\n\n- 推导全隐式格式在内部节点 $i$ 处的离散三对角模板，并确定左侧乘以 $C_{i-1}^{n+1}$、$C_i^{n+1}$ 和 $C_{i+1}^{n+1}$ 的三个系数。\n- 利用离散极值原理和单调矩阵理论（特别是，要求系数矩阵为具有非正非对角元的 $M$-矩阵），确定一个关于 $v$、$D$ 和 $\\Delta x$ 的不等式，在此不等式条件下中心格式是单调的，从而在前进波前没有伪超调。\n- 使用给定的物理和数值参数\n$$\nv = 7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1},\\quad D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad k = 2.0\\ \\mathrm{s}^{-1},\\quad \\Delta x = 2.5 \\times 10^{-3}\\ \\mathrm{m},\\quad \\Delta t = 5.0 \\times 10^{-1}\\ \\mathrm{s},\n$$\n简要解释为什么全隐式中心格式会在波前的前缘产生超调，尽管它在时间上是无条件线性稳定的。\n- 提出两种保持单调性的修正方法：(i) 改变平流项的离散化方法，以及 (ii) 在扩散项中增加一个附加量 $D_{\\text{art}}$，使得中心格式变为单调。然后，计算在此网格上保证中心格式单调性所需的最小 $D_{\\text{art}}$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。\n\n你的最终数值答案 $D_{\\text{art}}$ 以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到三位有效数字。最终答案必须是单个实数。",
            "solution": "该问题要求分析一个用于一维平流-扩散-反应方程的数值格式。该过程涉及推导离散方程，分析其单调性，并将结果应用于一组特定参数，以识别和修正潜在的数值伪影。\n\n控制偏微分方程（PDE）为：\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 C}{\\partial x^2} \\;-\\; k\\,C\n$$\n该数值格式使用全隐式（后向欧拉）方法进行时间积分，并对空间导数使用二阶中心差分。设 $C_i^n$ 为在空间节点 $x_i = i\\Delta x$ 和时间 $t_n = n\\Delta t$ 处浓度 $C(x,t)$ 的数值近似。\n\n在网格点 $(i, n+1)$ 处，PDE 中各项的离散近似为：\n时间导数：\n$$ \\frac{\\partial C}{\\partial t} \\approx \\frac{C_i^{n+1} - C_i^n}{\\Delta t} $$\n平流项（中心差分）：\n$$ v\\,\\frac{\\partial C}{\\partial x} \\approx v \\left( \\frac{C_{i+1}^{n+1} - C_{i-1}^{n+1}}{2 \\Delta x} \\right) $$\n扩散项（中心差分）：\n$$ D\\,\\frac{\\partial^2 C}{\\partial x^2} \\approx D \\left( \\frac{C_{i+1}^{n+1} - 2C_i^{n+1} + C_{i-1}^{n+1}}{(\\Delta x)^2} \\right) $$\n反应项：\n$$ -k\\,C \\approx -k\\,C_i^{n+1} $$\n将这些近似代入控制偏微分方程，得到全离散方程：\n$$\n\\frac{C_i^{n+1} - C_i^n}{\\Delta t} + v \\left( \\frac{C_{i+1}^{n+1} - C_{i-1}^{n+1}}{2 \\Delta x} \\right) = D \\left( \\frac{C_{i+1}^{n+1} - 2C_i^{n+1} + C_{i-1}^{n+1}}{(\\Delta x)^2} \\right) - k C_i^{n+1}\n$$\n\n**三对角模板的推导**\n为了推导该模板，我们重排方程，将新时间层 $n+1$ 的所有项组合在左侧（LHS），将旧时间层 $n$ 的项放在右侧（RHS）。\n$$\n\\frac{C_i^{n+1}}{\\Delta t} + v \\frac{C_{i+1}^{n+1}}{2 \\Delta x} - v \\frac{C_{i-1}^{n+1}}{2 \\Delta x} - D \\frac{C_{i+1}^{n+1}}{(\\Delta x)^2} + 2D \\frac{C_i^{n+1}}{(\\Delta x)^2} - D \\frac{C_{i-1}^{n+1}}{(\\Delta x)^2} + k C_i^{n+1} = \\frac{C_i^n}{\\Delta t}\n$$\n在 LHS 上合并关于 $C_{i-1}^{n+1}$、$C_i^{n+1}$ 和 $C_{i+1}^{n+1}$ 的项：\n$$\n\\left( -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\right) C_{i-1}^{n+1} + \\left( \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k \\right) C_i^{n+1} + \\left( \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\right) C_{i+1}^{n+1} = \\frac{C_i^n}{\\Delta t}\n$$\n在内部节点 $i$ 处，三对角模板的三个系数为：\n- $C_{i-1}^{n+1}$ 的系数：$a_{i-1} = -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2}$\n- $C_i^{n+1}$ 的系数：$a_i = \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k$\n- $C_{i+1}^{n+1}$ 的系数：$a_{i+1} = \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2}$\n\n**单调性条件**\n为了使数值解没有伪振荡（即，满足离散极值原理），线性系统的系数矩阵必须是一个 M-矩阵。一个三对角矩阵成为 M-矩阵的充分条件是其对角元为正，且其非对角元为非正。\n对角元 $a_i = \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k$ 在 $\\Delta t  0$、$D \\ge 0$ 和 $k \\ge 0$ 的条件下总是正的。\n非对角元必须为非正：\n$1.$ $a_{i-1} \\le 0 \\implies -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\le 0 \\implies \\frac{v}{2\\Delta x} + \\frac{D}{(\\Delta x)^2} \\ge 0$。假设 $v0$，这个条件总是满足的。\n$2.$ $a_{i+1} \\le 0 \\implies \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\le 0 \\implies \\frac{v}{2 \\Delta x} \\le \\frac{D}{(\\Delta x)^2}$。\n两边乘以 $2(\\Delta x)^2 / D$（假设 $D0$），我们得到：\n$$\n\\frac{v \\Delta x}{D} \\le 2\n$$\n这个不等式定义了网格佩克莱特数 $Pe_{\\Delta x} = \\frac{v \\Delta x}{D}$。单调性条件是 $Pe_{\\Delta x} \\le 2$。\n\n**使用给定参数对格式进行分析**\n给定的物理和数值参数如下：\n$v = 7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$\n$\\Delta x = 2.5 \\times 10^{-3}\\ \\mathrm{m}$\n\n我们计算网格佩克莱特数：\n$$\nPe_{\\Delta x} = \\frac{v \\Delta x}{D} = \\frac{(7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1})(2.5 \\times 10^{-3}\\ \\mathrm{m})}{1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}} = \\frac{1.8 \\times 10^{-6}}{1.0 \\times 10^{-9}} = 1800\n$$\n由于 $Pe_{\\Delta x} = 1800 \\gg 2$，单调性条件被严重违反。这意味着对应于 $C_{i+1}^{n+1}$ 系数的非对角矩阵元是正的，因此该矩阵不是一个M-矩阵。因此，离散极值原理不被满足。全隐式格式是无条件稳定（A-稳定）的，这意味着数值误差不会随时间无限增长。然而，稳定性并不能保证没有非物理振荡（超调和下冲），特别是在像前进波前这样的陡峭梯度附近。大的佩克莱特数表明在网格尺度上平流作用占主导地位，当与平流项的中心差分近似结合时，正是这些伪振荡的产生原因。\n\n**保持单调性的修正**\n\n(i) **改变平流项离散化方法**：恢复单调性的一种标准方法是用一阶迎风格式替换平流项的中心差分格式。由于速度 $v  0$，我们使用后向差分：$\\frac{\\partial C}{\\partial x} \\approx \\frac{C_i^{n+1} - C_{i-1}^{n+1}}{\\Delta x}$。这使得非对角系数无条件地为非正，从而确保矩阵是一个 M-矩阵且格式是单调的，其代价是引入了可能会过度抹平陡峭波前的数值扩散。\n\n(ii) **附加人工扩散**：另一种方法是保留中心格式，但添加足够的先验人工扩散 $D_{\\text{art}}$ 以满足单调性条件。我们将物理扩散 $D$ 替换为有效扩散 $D_{\\text{eff}} = D + D_{\\text{art}}$。单调性条件变为：\n$$\n\\frac{v \\Delta x}{D_{\\text{eff}}} \\le 2 \\implies \\frac{v \\Delta x}{D + D_{\\text{art}}} \\le 2\n$$\n为了找到所需的最小人工扩散，我们将该条件设为等式：\n$$\n\\frac{v \\Delta x}{D + D_{\\text{art}}} = 2\n$$\n解出 $D_{\\text{art}}$：\n$$\nD + D_{\\text{art}} = \\frac{v \\Delta x}{2}\n$$\n$$\nD_{\\text{art}} = \\frac{v \\Delta x}{2} - D\n$$\n代入给定的数值：\n$$\nD_{\\text{art}} = \\frac{(7.2 \\times 10^{-4}) \\times (2.5 \\times 10^{-3})}{2} - (1.0 \\times 10^{-9})\n$$\n$$\nD_{\\text{art}} = \\frac{1.8 \\times 10^{-6}}{2} - 1.0 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 9.0 \\times 10^{-7} - 1.0 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 900 \\times 10^{-9} - 1.0 \\times 10^{-9} = 899 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 8.99 \\times 10^{-7}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n这是在给定网格上使中心格式保持单调所需的最小人工扩散值。四舍五入到三位有效数字，该值为 $8.99 \\times 10^{-7}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{8.99 \\times 10^{-7}}$$"
        }
    ]
}