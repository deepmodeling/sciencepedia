{
    "hands_on_practices": [
        {
            "introduction": "要掌握环境系统中的刚性问题，最有效的方法之一就是从一个经典的数值分析测试方程开始。这个练习使用一个简单的一阶常微分方程来模拟快速衰减过程，例如高反应性化学物质的分解。通过比较显式（前向欧拉）和隐式（后向欧拉）方法在该问题上的表现，我们可以清晰地揭示数值刚性的核心挑战：显式方法在时间步长选择上受到严格限制，而隐式方法则表现出卓越的稳定性。",
            "id": "3916079",
            "problem": "在环境与地球系统建模中，一个简化但具有代表性的刚性过程是均匀混合控制体积内高反应性溶解物质的一阶衰减。设其浓度由常微分方程 $y'(t) = -1000\\,y(t)$ 和初始条件 $y(0) = y_{0}$ 建模，其中较大的衰减系数模拟了相对于平流或扩散输运而言的快速化学汇。考虑两种广泛用于初值问题的时间步进法：前向欧拉法和后向欧拉法。仅使用这些方法作为 $y'(t)$ 的单步离散化的定义，推导每种方法应用于此方程时的线性单步更新式，并由此得到每种方法的单步放大因子 $g(\\Delta t)$，使得 $y_{n+1} = g(\\Delta t)\\,y_{n}$。计算每种方法在两个时间步长 $\\Delta t = 0.001$ 和 $\\Delta t = 1$ 下放大因子的绝对值 $|g(\\Delta t)|$。解释这些值对于与刚性相关的误差动力学和稳定性的影响，并结合刚性环境子系统中典型的快速衰减背景，讨论每种方法在这些步长下的表现。以单行矩阵的形式给出你的最终答案，其中按顺序包含四个精确值 $|g_{\\text{FE}}(0.001)|$, $|g_{\\text{BE}}(0.001)|$, $|g_{\\text{FE}}(1)|$, 和 $|g_{\\text{BE}}(1)|$，不带单位且不进行四舍五入。",
            "solution": "首先评估问题陈述的有效性。\n\n### 第1步：提取已知条件\n-   **控制方程**：浓度 $y(t)$ 由常微分方程(ODE) $y'(t) = -1000\\,y(t)$ 建模。\n-   **初始条件**：$y(0) = y_{0}$。\n-   **数值方法**：前向欧拉法和后向欧拉法。\n-   **任务1**：推导每种方法的单步更新式。\n-   **任务2**：求出每种方法的单步放大因子 $g(\\Delta t)$，使得 $y_{n+1} = g(\\Delta t)\\,y_{n}$。\n-   **任务3**：计算每种方法在 $\\Delta t = 0.001$ 和 $\\Delta t = 1$ 时的 $|g(\\Delta t)|$。\n-   **任务4**：在刚性、误差动力学和稳定性的背景下解释结果。\n-   **答案格式**：一个包含四个精确值 $|g_{\\text{FE}}(0.001)|$, $|g_{\\text{BE}}(0.001)|$, $|g_{\\text{FE}}(1)|$ 和 $|g_{\\text{BE}}(1)|$ 的单行矩阵。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它提出了一个微分方程数值分析领域的标准问题，具体来说是使用 Dahlquist 测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda = -1000$）来分析基本数值积分器的稳定性。这是说明常微分方程中刚性概念的一个典范问题。所提供的背景，即环境模型中的快速化学汇，是一个现实且恰当的应用。这个问题是适定的，提供了推导唯一、有意义解所需的所有信息。术语精确客观。该问题不违反任何无效性标准。\n\n### 第3步：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 求解过程\n\n给定的常微分方程是一个线性的、一阶的、齐次的、具有常数系数的方程：\n$$y'(t) = -1000\\,y(t)$$\n设 $y_n$ 是解 $y(t_n)$ 在时间 $t_n = n \\Delta t$ 处的数值近似，其中 $\\Delta t$ 是时间步长。该常微分方程的一般形式为 $y'(t) = f(t, y(t))$，对于本问题，$f(t, y) = -1000 y$。\n\n**1. 前向欧拉法**\n\n前向欧拉法(FE)是一种显式单步法，由以下递推关系定义：\n$$y_{n+1} = y_n + \\Delta t\\,f(t_n, y_n)$$\n将给定函数 $f(t_n, y_n) = -1000\\,y_n$ 代入前向欧拉法公式，得到：\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_n)$$\n提取公因子 $y_n$ 得到单步更新规则：\n$$y_{n+1} = (1 - 1000\\,\\Delta t)\\,y_n$$\n通过与 $y_{n+1} = g(\\Delta t)\\,y_n$ 的形式进行比较，我们确定前向欧拉法的放大因子 $g_{\\text{FE}}(\\Delta t)$ 为：\n$$g_{\\text{FE}}(\\Delta t) = 1 - 1000\\,\\Delta t$$\n\n**2. 后向欧拉法**\n\n后向欧拉法(BE)是一种隐式单步法，由以下递推关系定义：\n$$y_{n+1} = y_n + \\Delta t\\,f(t_{n+1}, y_{n+1})$$\n注意，函数 $f$ 是在未来的时间步 $t_{n+1}$ 处进行评估的。将给定函数 $f(t_{n+1}, y_{n+1}) = -1000\\,y_{n+1}$ 代入后向欧拉法公式，得到：\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_{n+1})$$\n这是一个关于未知数 $y_{n+1}$ 的方程。我们必须通过代数方法求解它：\n$$y_{n+1} + 1000\\,\\Delta t\\,y_{n+1} = y_n$$\n$$y_{n+1}(1 + 1000\\,\\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 + 1000\\,\\Delta t}\\,y_n$$\n通过与 $y_{n+1} = g(\\Delta t)\\,y_n$ 的形式进行比较，我们确定后向欧拉法的放大因子 $g_{\\text{BE}}(\\Delta t)$ 为：\n$$g_{\\text{BE}}(\\Delta t) = \\frac{1}{1 + 1000\\,\\Delta t}$$\n\n**3. 放大因子的计算**\n\n现在我们计算每种方法在指定时间步长下放大因子的绝对值 $|g(\\Delta t)|$。\n\n**情况1：$\\Delta t = 0.001$**\n\n-   对于前向欧拉法：\n    $$g_{\\text{FE}}(0.001) = 1 - 1000(0.001) = 1 - 1 = 0$$\n    $$|g_{\\text{FE}}(0.001)| = |0| = 0$$\n-   对于后向欧拉法：\n    $$g_{\\text{BE}}(0.001) = \\frac{1}{1 + 1000(0.001)} = \\frac{1}{1 + 1} = \\frac{1}{2}$$\n    $$|g_{\\text{BE}}(0.001)| = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$$\n\n**情况2：$\\Delta t = 1$**\n\n-   对于前向欧拉法：\n    $$g_{\\text{FE}}(1) = 1 - 1000(1) = -999$$\n    $$|g_{\\text{FE}}(1)| = |-999| = 999$$\n-   对于后向欧拉法：\n    $$g_{\\text{BE}}(1) = \\frac{1}{1 + 1000(1)} = \\frac{1}{1001}$$\n    $$|g_{\\text{BE}}(1)| = \\left|\\frac{1}{1001}\\right| = \\frac{1}{1001}$$\n\n**4. 解释与对刚性的影响**\n\n$y'(t) = -1000\\,y(t)$ 的精确解是 $y(t) = y_0 \\exp(-1000 t)$，它会迅速衰减到零。一个数值稳定的方法应产生一个同样衰减的解，这意味着数值解的量值不应增加。这要求放大因子的绝对值小于或等于1：$|g(\\Delta t)| \\leq 1$。\n\n-   **前向欧拉法 (显式法)**：\n    稳定性条件是 $|g_{\\text{FE}}(\\Delta t)| = |1 - 1000\\,\\Delta t| \\leq 1$。该不等式仅在 $-1 \\leq 1 - 1000\\,\\Delta t \\leq 1$ 时成立，可简化为 $0 \\leq \\Delta t \\leq \\frac{2}{1000} = 0.002$。因此，前向欧拉法的稳定性是条件性的，取决于时间步长。\n    -   在 $\\Delta t = 0.001$ 时，条件满足。$|g_{\\text{FE}}(0.001)| = 0 \\leq 1$，因此方法是稳定的。事实上，它的耗散性如此之强，以至于在单步内就将解衰减到零。\n    -   在 $\\Delta t = 1$ 时，条件被违反。$|g_{\\text{FE}}(1)| = 999 \\gg 1$。该方法是剧烈不稳定的。每一步都将前一个值放大-999倍，导致灾难性的误差增长并伴有符号振荡，这是刚性系统数值不稳定的一个特征。\n\n-   **后向欧拉法 (隐式法)**：\n    稳定性条件是 $|g_{\\text{BE}}(\\Delta t)| = |\\frac{1}{1 + 1000\\,\\Delta t}| \\leq 1$。由于 $\\Delta t > 0$，分母 $1 + 1000\\,\\Delta t$ 总是大于1。因此，对于所有 $\\Delta t > 0$，$0 < g_{\\text{BE}}(\\Delta t) < 1$。其绝对值总是小于1。后向欧拉法对该问题是无条件稳定的（这一性质被称为A-稳定性）。\n    -   在 $\\Delta t = 0.001$ 时，$|g_{\\text{BE}}(0.001)| = 1/2 < 1$。该方法是稳定的，并产生一个衰减的解。\n    -   在 $\\Delta t = 1$ 时，$|g_{\\text{BE}}(1)| = 1/1001 < 1$。即使时间步长比衰减的特征时间尺度（$1/1000$）大几个数量级，该方法仍然保持稳定。\n\n**关于刚性的结论**：这个问题例证了刚性。快速衰减过程（特征时间为 $1/1000\\,\\mathrm{s}$）对显式前向欧拉法施加了严格的稳定性约束（$\\Delta t \\leq 0.002\\,\\mathrm{s}$），即使我们关心的是更长时间尺度上的系统动力学。隐式后向欧拉法由于是无条件稳定的，不受此约束，可以采用大的时间步长，这使得它在求解刚性系统时效率远高于前者。这类刚性系统在环境建模中很常见，其中化学、物理和生物过程发生在截然不同的时间尺度上。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{1}{2} & 999 & \\frac{1}{1001}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在识别出数值刚性的表现之后，下一步是学习如何从环境系统的基本物理过程中预测其存在。这个练习将引导我们通过特征时间尺度的分析来实现这一目标。通过计算和比较对流、扩散和反应等过程的时间尺度，我们可以构建无量纲数（如佩克莱数Pe和丹科勒数Da），这些参数能够量化不同过程的主导地位，并揭示导致系统刚性的时间尺度分离。",
            "id": "3916074",
            "problem": "考虑在长度为 $L$、空间坐标为 $x \\in [0,L]$ 的平直河段中，反应示踪剂的一维输运。该示踪剂以平均速度 $u$ 平流输运，以系数 $D$ 进行分子扩散，并以速率常数 $k$ 进行一级反应衰减。忽略除衰减以外的源和汇，质量守恒导出一个平流-扩散-反应平衡方程。在间距为 $\\Delta x$ 的均匀网格上进行空间离散化后，该方程产生一个关于节点浓度的半离散常微分方程组。\n\n利用河段尺度 $L$ 上特征时间的基本定义——平流时间 $\\tau_{a}$ 为平流穿过 $L$ 的时间，扩散时间 $\\tau_{d}$ 为分子扩散遍历 $L$ 的时间，以及反应时间 $\\tau_{r}$ 为e指数衰减时间——将佩克莱数（Pe）定义为尺度 $L$ 上扩散时间与平流时间之比，将丹姆科勒数（Da）定义为尺度 $L$ 上平流时间与反应时间之比。然后，通过比较最快的反应时间与最慢的网格尺度输运时间，分析网格尺度上半离散系统的刚度。\n\n给定 $u=0.1\\,\\mathrm{m\\,s^{-1}}$，$D=10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$，$L=100\\,\\mathrm{m}$，$k=1\\,\\mathrm{s^{-1}}$，以及 $\\Delta x = 1\\,\\mathrm{m}$：\n- 使用上述特征时间的定义，从第一性原理计算 $\\mathrm{Pe}$ 和 $\\mathrm{Da}$。\n- 用 $\\Delta x$ 替代 $L$ 来评估网格尺度上的平流和扩散特征时间，并确定集合 $\\{\\tau_{a,\\mathrm{grid}}, \\tau_{d,\\mathrm{grid}}, \\tau_{r}\\}$ 中的刚度比 $\\mathcal{R} = \\tau_{\\max}/\\tau_{\\min}$。为本问题之目的，如果 $\\mathcal{R} \\geq 10^{3}$，则将半离散系统分类为刚性系统，否则为非刚性系统。\n- 将您的结果以一个行矩阵的形式报告，该矩阵包含三个无量纲条目 $\\mathrm{Pe}$、$\\mathrm{Da}$ 和 $S$，其中如果半离散系统根据上述准则为刚性，则 $S=1$，否则 $S=0$。\n\n以精确值表示最终答案，不要四舍五入，并且在报告的矩阵中不包含单位。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提供了一套清晰、自洽的定义和数据，用于在平流-扩散-反应系统的背景下，对特征时间尺度和数值刚度进行标准分析。所有必要信息都已给出，没有矛盾或歧义。该问题是有效的，解题过程如下。\n\n问题要求计算两个无量纲数，即佩克莱数（$\\mathrm{Pe}$）和丹姆科勒数（$\\mathrm{Da}$），并根据定义的特征时间比率评估系统刚度。解答分为两部分：首先，在河段尺度 $L$ 上计算 $\\mathrm{Pe}$ 和 $\\mathrm{Da}$；其次，在网格尺度 $\\Delta x$ 上进行刚度分析。\n\n首先，我们使用给定参数在河段尺度 $L = 100\\,\\mathrm{m}$ 上定义并计算特征时间：平流速度 $u = 0.1\\,\\mathrm{m\\,s^{-1}}$，扩散系数 $D = 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$，以及反应速率常数 $k = 1\\,\\mathrm{s^{-1}}$。\n\n平流时间 $\\tau_a$ 是以速度 $u$ 穿过长度 $L$ 所需的时间：\n$$\n\\tau_a = \\frac{L}{u} = \\frac{100\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 1000\\,\\mathrm{s}\n$$\n扩散时间 $\\tau_d$ 是扩散作用在长度尺度 $L$ 上的特征时间。根据量纲分析（$L^2 \\sim Dt$），这表示为：\n$$\n\\tau_d = \\frac{L^2}{D} = \\frac{(100\\,\\mathrm{m})^2}{10^{-5}\\,\\mathrm{m^2\\,s^{-1}}} = \\frac{10^4}{10^{-5}}\\,\\mathrm{s} = 10^9\\,\\mathrm{s}\n$$\n反应时间 $\\tau_r$ 是一级衰减过程的e指数折叠时间，即速率常数 $k$ 的倒数：\n$$\n\\tau_r = \\frac{1}{k} = \\frac{1}{1\\,\\mathrm{s^{-1}}} = 1\\,\\mathrm{s}\n$$\n问题将佩克莱数 $\\mathrm{Pe}$ 定义为尺度 $L$ 上扩散时间与平流时间之比。\n$$\n\\mathrm{Pe} = \\frac{\\tau_d}{\\tau_a} = \\frac{10^9\\,\\mathrm{s}}{1000\\,\\mathrm{s}} = 10^6\n$$\n这个结果可以用佩克莱数的标准公式 $\\mathrm{Pe} = uL/D$ 来验证：\n$$\n\\mathrm{Pe} = \\frac{uL}{D} = \\frac{(0.1\\,\\mathrm{m\\,s^{-1}})(100\\,\\mathrm{m})}{10^{-5}\\,\\mathrm{m^2\\,s^{-1}}} = \\frac{10}{10^{-5}} = 10^6\n$$\n丹姆科勒数 $\\mathrm{Da}$ 定义为尺度 $L$ 上平流时间与反应时间之比。\n$$\n\\mathrm{Da} = \\frac{\\tau_a}{\\tau_r} = \\frac{1000\\,\\mathrm{s}}{1\\,\\mathrm{s}} = 1000 = 10^3\n$$\n这可以用相应的标准公式 $\\mathrm{Da} = kL/u$ 来验证：\n$$\n\\mathrm{Da} = \\frac{kL}{u} = \\frac{(1\\,\\mathrm{s^{-1}})(100\\,\\mathrm{m})}{0.1\\,\\mathrm{m\\,s^{-1}}} = 1000 = 10^3\n$$\n计算出的值为 $\\mathrm{Pe} = 10^6$ 和 $\\mathrm{Da} = 10^3$。\n\n其次，我们通过比较网格尺度 $\\Delta x = 1\\,\\mathrm{m}$ 上的特征时间来分析半离散系统的刚度。需要考虑的时间集合是 $\\{\\tau_{a,\\mathrm{grid}}, \\tau_{d,\\mathrm{grid}}, \\tau_{r}\\}$。\n\n网格尺度的平流时间 $\\tau_{a,\\mathrm{grid}}$ 是平流穿过一个大小为 $\\Delta x$ 的网格单元所需的时间：\n$$\n\\tau_{a,\\mathrm{grid}} = \\frac{\\Delta x}{u} = \\frac{1\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 10\\,\\mathrm{s}\n$$\n网格尺度的扩散时间 $\\tau_{d,\\mathrm{grid}}$ 是扩散作用于一个网格单元的特征时间：\n$$\n\\tau_{d,\\mathrm{grid}} = \\frac{(\\Delta x)^2}{D} = \\frac{(1\\,\\mathrm{m})^2}{10^{-5}\\,\\mathrm{m^2\\,s^{-1}}} = 10^5\\,\\mathrm{s}\n$$\n反应时间 $\\tau_r$ 是化学反应的内在属性，不依赖于空间尺度。因此，它仍然是 $\\tau_r = 1\\,\\mathrm{s}$。\n\n因此，控制半离散常微分方程组动力学的特征时间集合为 $\\{10\\,\\mathrm{s}, 10^5\\,\\mathrm{s}, 1\\,\\mathrm{s}\\}$。\n\n刚度源于时间尺度的巨大差异。我们使用刚度比 $\\mathcal{R}$ 来量化这一点，它被定义为该集合中最大时间与最小时间之比。\n$$\n\\tau_{\\min} = \\min\\{10\\,\\mathrm{s}, 10^5\\,\\mathrm{s}, 1\\,\\mathrm{s}\\} = 1\\,\\mathrm{s} \\quad (\\text{来自反应})\n$$\n$$\n\\tau_{\\max} = \\max\\{10\\,\\mathrm{s}, 10^5\\,\\mathrm{s}, 1\\,\\mathrm{s}\\} = 10^5\\,\\mathrm{s} \\quad (\\text{来自网格尺度扩散})\n$$\n$$\n\\mathcal{R} = \\frac{\\tau_{\\max}}{\\tau_{\\min}} = \\frac{10^5\\,\\mathrm{s}}{1\\,\\mathrm{s}} = 10^5\n$$\n问题提供了一个将系统分类为刚性系统的准则：$\\mathcal{R} \\geq 10^3$。在我们的例子中，$10^5 \\geq 10^3$。此条件得到满足。因此，该半离散系统被认为是刚性的。根据问题的指示，这对应于刚度指标 $S = 1$。\n\n最终结果需以一个行矩阵的形式报告，包含三个无量纲条目：$\\mathrm{Pe}$、$\\mathrm{Da}$ 和 $S$。\n这些值为：\n$\\mathrm{Pe} = 10^6$\n$\\mathrm{Da} = 10^3$\n$S = 1$\n得到的矩阵是 $[10^6, 10^3, 1]$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 \\times 10^6 & 1 \\times 10^3 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本练习将前面两个实践的理论知识应用于一个更具体的环境建模场景：一维河流中的溶质输运。当我们将控制偏微分方程（PDE）离散化为一组常微分方程（ODE）时，系统中存在的多种物理过程的相互作用就直接转化为数值上的挑战。通过为显式时间积分方案推导稳定性条件，您将亲身体会到最快的过程（在此例中是化学反应）如何决定整个模拟的最大允许时间步长，从而深刻理解刚性问题在实际建模中的计算效率影响。",
            "id": "3916122",
            "problem": "一种保守反应性溶质沿着一个长度远大于网格间距的、直的、均匀的一维河段进行输运。断面平均浓度 $C(x,t)$ 的控制方程是线性平流-扩散-反应方程\n$\\displaystyle \\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C$，\n其中 $u$ 是平均流速，$D$ 是有效纵向弥散系数，$k$ 是一级衰减率。考虑一个间距为 $\\Delta x$ 的均匀网格和一个显式时间推进方法，该方法在时间上使用前向欧拉法，对平流项使用一阶迎风格式（对于 $u>0$），对扩散项使用中心二阶有限差分。\n\n从守恒定律和这些离散化选择出发，通过要求每个网格点的更新是当前和相邻单元格浓度的非负贡献以及衰减损失的凸组合，推导一个充分的稳定性和单调性条件。利用该条件，以 $u$、$D$、$k$ 和 $\\Delta x$ 的形式，求出显式时间步长 $\\Delta t$ 的单个闭式上界。然后，对于 $\\Delta x = 50\\,\\mathrm{m}$，$u = 0.5\\,\\mathrm{m\\,s^{-1}}$，$D = 0.01\\,\\mathrm{m^2\\,s^{-1}}$ 和 $k = 0.2\\,\\mathrm{s^{-1}}$，计算最严格的允许显式时间步长。\n\n最后，根据特征过程时间尺度，简要解释计算出的边界对该问题的数值刚度意味着什么，并说明哪个过程主导了该限制。\n\n将最终的数值时间步长四舍五入到四位有效数字。以秒为单位表示时间步长。",
            "solution": "首先验证问题，以确保其科学上合理、适定、客观，并包含所有必要信息。所给的控制方程是标准的一维平流-扩散-反应方程，这是环境输运现象中的一个基本模型。指定的数值格式（前向欧拉法、一阶迎风格式、二阶中心差分）是标准的显式方法。所有必需的参数（$u$、$D$、$k$、$\\Delta x$）都以一致的单位给出。因此，该问题被认为是有效的，有必要给出完整解答。\n\n浓度 $C(x, t)$ 的控制方程是：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C\n$$\n我们为时间推进格式对其进行重排：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^{2} C}{\\partial x^{2}} - k\\,C\n$$\n设 $C_j^n$ 表示 $C(j\\Delta x, n\\Delta t)$ 的数值近似，其中 $\\Delta x$ 是均匀网格间距，$\\Delta t$ 是时间步长。我们按规定对每一项进行离散化：\n1.  **时间导数（前向欧拉法）**：\n    $$\n    \\frac{\\partial C}{\\partial t} \\approx \\frac{C_j^{n+1} - C_j^n}{\\Delta t}\n    $$\n2.  **平流项（对于 $u>0$ 的一阶迎风格式）**：\n    $$\n    -u \\frac{\\partial C}{\\partial x} \\approx -u \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n    $$\n3.  **扩散项（中心二阶格式）**：\n    $$\n    D \\frac{\\partial^{2} C}{\\partial x^{2}} \\approx D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2}\n    $$\n4.  **反应项**：\n    $$\n    -kC \\approx -kC_j^n\n    $$\n结合这些离散化格式，得到完整的有限差分方程：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = -u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} + D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2} - kC_j^n\n$$\n为了推导稳定性和单调性条件，我们求解 $C_j^{n+1}$，并根据时间步长 $n$ 处浓度的空间位置对各项进行分组：\n$$\nC_j^{n+1} = C_j^n - \\Delta t \\left( u \\frac{C_j^n - C_{j-1}^n}{\\Delta x} \\right) + \\Delta t \\left( D \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{(\\Delta x)^2} \\right) - \\Delta t (kC_j^n)\n$$\n对 $C_{j-1}^n$、$C_j^n$ 和 $C_{j+1}^n$ 的系数进行重排和收集：\n$$\nC_j^{n+1} = \\left( \\frac{u \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2} \\right) C_{j-1}^n + \\left( 1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{2 D \\Delta t}{(\\Delta x)^2} - k \\Delta t \\right) C_j^n + \\left( \\frac{D \\Delta t}{(\\Delta x)^2} \\right) C_{j+1}^n\n$$\n问题要求 $C_j^{n+1}$ 的更新是相邻浓度的非负贡献的凸组合，这是单调性（以及在假设 $C^n \\ge 0$ 时的正定性）的一个条件。这意味着在 $C_j^{n+1}$ 的表达式中，$C_{j-1}^n$、$C_j^n$ 和 $C_{j+1}^n$ 的所有系数都必须为非负。\n1.  $C_{j+1}^n$ 的系数：$\\frac{D \\Delta t}{(\\Delta x)^2} \\ge 0$。因为 $D \\ge 0$，$\\Delta t > 0$，所以该式成立。\n2.  $C_{j-1}^n$ 的系数：$\\frac{u \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2} \\ge 0$。因为 $u > 0$，$D \\ge 0$，$\\Delta t > 0$，$\\Delta x > 0$，所以该式成立。\n3.  $C_j^n$ 的系数：$1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{2 D \\Delta t}{(\\Delta x)^2} - k \\Delta t \\ge 0$。这提供了稳定性约束。\n\n从第三个条件，我们可以推导出时间步长 $\\Delta t$ 的上界：\n$$\n1 \\ge \\frac{u \\Delta t}{\\Delta x} + \\frac{2 D \\Delta t}{(\\Delta x)^2} + k \\Delta t\n$$\n$$\n1 \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k \\right)\n$$\n求解 $\\Delta t$ 得到单个闭式上界：\n$$\n\\Delta t \\le \\frac{1}{\\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k}\n$$\n现在，我们使用给定的数值计算这个上界：$\\Delta x = 50\\,\\mathrm{m}$，$u = 0.5\\,\\mathrm{m\\,s^{-1}}$，$D = 0.01\\,\\mathrm{m^2\\,s^{-1}}$ 和 $k = 0.2\\,\\mathrm{s^{-1}}$。\n分母中的各项是：\n- 平流项贡献：$\\frac{u}{\\Delta x} = \\frac{0.5\\,\\mathrm{m\\,s^{-1}}}{50\\,\\mathrm{m}} = 0.01\\,\\mathrm{s^{-1}}$。\n- 扩散项贡献：$\\frac{2D}{(\\Delta x)^2} = \\frac{2(0.01\\,\\mathrm{m^2\\,s^{-1}})}{(50\\,\\mathrm{m})^2} = \\frac{0.02}{2500}\\,\\mathrm{s^{-1}} = 0.000008\\,\\mathrm{s^{-1}}$。\n- 反应项贡献：$k = 0.2\\,\\mathrm{s^{-1}}$。\n\n分母中的和是：\n$$\n0.01 + 0.000008 + 0.2 = 0.210008\\,\\mathrm{s^{-1}}\n$$\n最大允许时间步长是这个和的倒数：\n$$\n\\Delta t_{\\text{max}} = \\frac{1}{0.210008\\,\\mathrm{s^{-1}}} \\approx 4.761729\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，最严格的允许显式时间步长是 $4.762$ s。\n\n最后，我们解释数值刚度。常微分方程组（由偏微分方程的空间离散化产生）的刚性源于存在差异悬殊的特征时间尺度。显式方法的稳定性由最快的过程（最短的时间尺度）决定。\n稳定性条件 $\\frac{1}{\\Delta t} \\ge \\frac{u}{\\Delta x} + \\frac{2D}{(\\Delta x)^2} + k$ 表明，总体时间步长限制是来自每个独立过程（平流、扩散和反应）的限制的调和和。我们可以识别出与每个过程的稳定性极限相关的特征时间尺度：\n- 平流时间尺度（库朗数限制）：$\\tau_{\\text{adv}} = \\frac{\\Delta x}{u} = \\frac{50}{0.5} = 100\\,\\mathrm{s}$。\n- 扩散时间尺度（傅里叶数限制）：$\\tau_{\\text{diff}} = \\frac{(\\Delta x)^2}{2D} = \\frac{50^2}{2(0.01)} = \\frac{2500}{0.02} = 125000\\,\\mathrm{s}$。\n- 反应时间尺度：$\\tau_{\\text{react}} = \\frac{1}{k} = \\frac{1}{0.2} = 5\\,\\mathrm{s}$。\n\n系统表现出巨大的时间尺度分离：$\\tau_{\\text{react}} (5\\,\\mathrm{s}) \\ll \\tau_{\\text{adv}} (100\\,\\mathrm{s}) \\ll \\tau_{\\text{diff}} (125000\\,\\mathrm{s})$。这就是数值刚性问题的定义。最快的过程，即化学反应，决定了稳定性极限。计算出的最大时间步长 $\\Delta t_{\\text{max}} \\approx 4.762\\,\\mathrm{s}$ 非常接近反应时间尺度 $\\tau_{\\text{react}} = 5\\,\\mathrm{s}$，并由其主导。这迫使模拟以非常小的时间步长进行以维持稳定性，尽管溶质的平流输运，特别是扩散输运，发生在长得多的时间尺度上。这在计算上是低效的，也是用显式方法模拟刚性系统的主要挑战。主导时间步长限制的过程是一级衰减（反应）。",
            "answer": "$$\n\\boxed{4.762}\n$$"
        }
    ]
}