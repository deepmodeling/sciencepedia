{
    "hands_on_practices": [
        {
            "introduction": "守恒性是物理建模的基石，尤其是在地球系统模型中，它确保了物质和能量在不同圈层之间交换的物理真实性。这个实践练习构建了一个清晰的反例，旨在揭示一个看似合理但非守恒的通量重映射方法如何导致非物理的质量“凭空”产生。通过亲手量化这种“虚假源”的误差，您将深刻理解为何在通量耦合器设计中必须严格遵循守恒原则。",
            "id": "3868345",
            "problem": "考虑一个双向耦合的地球系统模型 (ESM)，其中一个通量耦合器 (FC) 将一个矩形域上从大气分量到陆地分量的示踪剂质量通量密度场进行重映射。示踪剂质量通量密度定义为单位水平面积的通量，单位为千克/秒/平方米。矩形域在笛卡尔坐标 $(x,y)$ 中为 $[0,2] \\times [0,1]$，示踪剂质量通量密度场由连续函数 $q(x,y) = q(x) = 4 - x^{2}$ 给出，其中 $(x,y) \\in [0,2] \\times [0,1]$。假设该场与 $y$ 无关。\n\n大气分量将该域离散化为两个源网格：$[0,1] \\times [0,1]$ 和 $[1,2] \\times [0,1]$。陆地分量使用相同的双网格划分。物理上正确（守恒）的从大气到陆地的总质量通量等于 $q(x)$ 在整个域上的面积分，即 $q$ 对 $x$ 的积分乘以 $y$ 方向的宽度。相反，假设通量耦合器实现了一种非守恒的“点采样乘以面积”的重映射策略：它在每个目标网格的中心评估 $q$ 的值，乘以网格面积，然后求和。对于这两个目标网格，中心点分别位于 $x_{1}^{c} = 0.5$ 和 $x_{2}^{c} = 1.5$，每个网格的面积为 $A = 1$。\n\n使用质量守恒的基本陈述（通量密度在面积上的积分代表物理上正确的交换）和上述定义，明确地构建这个反例，并量化由非守恒重映射引起的净伪质量增益。将净伪质量增益 $\\Delta \\Phi$ 定义为非守恒总量减去守恒总量。将 $\\Delta \\Phi$ 的最终答案以千克/秒为单位表示，并四舍五入到 $4$ 位有效数字。",
            "solution": "首先提取所有给定信息，然后评估其科学和逻辑上的合理性，从而对问题进行验证。\n\n### 步骤1：提取已知信息\n-   **域**：在笛卡尔坐标 $(x,y)$ 中由 $[0,2] \\times [0,1]$ 定义的矩形域。\n-   **示踪剂质量通量密度场**：由 $q(x,y) = q(x) = 4 - x^{2}$ 给出的连续函数。单位为千克/秒/平方米。\n-   **分量离散化**：大气和陆地分量都将域离散化为两个网格：\n    -   网格1：$[0,1] \\times [0,1]$\n    -   网格2：$[1,2] \\times [0,1]$\n-   **守恒通量计算**：物理上正确的总质量通量是 $q(x)$ 在整个域上的面积分。\n-   **非守恒重映射策略**：通量耦合器 (FC) 使用“点采样乘以面积”的方法。它在每个目标网格的中心评估 $q$ 的值，乘以网格面积，然后将结果求和。\n-   **网格中心和面积**：\n    -   网格1的中心在 $x_{1}^{c} = 0.5$。\n    -   网格2的中心在 $x_{2}^{c} = 1.5$。\n    -   每个网格的面积是 $A = 1$。\n-   **目标**：计算净伪质量增益 $\\Delta \\Phi$，定义为 $\\Delta \\Phi = \\Phi_{\\text{non-conservative}} - \\Phi_{\\text{conservative}}$。\n-   **最终答案格式**：$\\Delta \\Phi$ 的最终答案应以千克/秒为单位表示，并四舍五入到 $4$ 位有效数字。\n\n### 步骤2：使用已知信息进行验证\n问题陈述具有科学依据。它提出了计算物理学和地球系统建模中的一个常见问题，即简单的数值耦合方案违反守恒定律。该问题提出了一个明确定义的数学任务：将离散数值近似的结果（点采样求和，等同于中点黎曼和）与精确的解析结果（积分）进行比较。\n\n-   **科学和事实的合理性**：这个问题是合理的。它没有违反物理定律，而是要求量化一种未能守恒物理量（质量）的数值方法所引入的误差。通量密度、用于计算总通量的面积分以及离散化等概念在物理学和工程学中是标准概念。\n-   **适定性**：这个问题是适定的。函数 $q(x)$ 在指定域上是连续且可积的。所有必要的数据（函数定义、域、网格划分、数值方法）都已提供，可以计算出守恒和非守恒通量，从而得到唯一解。\n-   **客观性**：语言精确客观。所有术语都有明确的定义。\n\n这个问题是应用数学和计算科学领域的一个有效练习。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n### 求解过程\n\n净伪质量增益 $\\Delta \\Phi$ 是由非守恒数值方案计算出的总质量通量 $\\Phi_{\\text{non-conservative}}$ 与物理上正确的总质量通量 $\\Phi_{\\text{conservative}}$ 之间的差值。\n$$\n\\Delta \\Phi = \\Phi_{\\text{non-conservative}} - \\Phi_{\\text{conservative}}\n$$\n\n首先，我们通过对通量密度场 $q(x,y) = q(x) = 4 - x^{2}$ 在整个域 $D = [0,2] \\times [0,1]$ 上进行积分，来计算守恒总质量通量 $\\Phi_{\\text{conservative}}$。\n$$\n\\Phi_{\\text{conservative}} = \\iint_D q(x,y) \\,dA = \\int_{y=0}^{y=1} \\int_{x=0}^{x=2} (4 - x^{2}) \\,dx \\,dy\n$$\n由于被积函数与 $y$ 无关，积分可以分离：\n$$\n\\Phi_{\\text{conservative}} = \\left( \\int_{0}^{2} (4 - x^{2}) \\,dx \\right) \\left( \\int_{0}^{1} 1 \\,dy \\right)\n$$\n关于 $y$ 的积分结果为域在 $y$ 方向上的宽度，即 $1$。\n$$\n\\int_{0}^{1} 1 \\,dy = [y]_{0}^{1} = 1 - 0 = 1\n$$\n关于 $x$ 的积分是：\n$$\n\\int_{0}^{2} (4 - x^{2}) \\,dx = \\left[ 4x - \\frac{x^{3}}{3} \\right]_{0}^{2}\n$$\n在积分上下限处求值：\n$$\n\\left( 4(2) - \\frac{2^{3}}{3} \\right) - \\left( 4(0) - \\frac{0^{3}}{3} \\right) = \\left( 8 - \\frac{8}{3} \\right) - 0 = \\frac{24 - 8}{3} = \\frac{16}{3}\n$$\n因此，守恒总质量通量为：\n$$\n\\Phi_{\\text{conservative}} = \\frac{16}{3} \\text{ kg/s}\n$$\n\n接下来，我们使用“点采样乘以面积”方法计算非守恒总质量通量 $\\Phi_{\\text{non-conservative}}$。这包括对两个网格的贡献求和。\n来自网格 $i$ 的贡献为 $q(x_{i}^{c}) \\times A_{i}$。\n$$\n\\Phi_{\\text{non-conservative}} = q(x_{1}^{c})A_{1} + q(x_{2}^{c})A_{2}\n$$\n问题指定了网格中心为 $x_{1}^{c} = 0.5$ 和 $x_{2}^{c} = 1.5$，每个网格的面积为 $A_1 = A_2 = 1$。\n\n对于网格1（域 $[0,1] \\times [0,1]$）：\n在中心点 $x_{1}^{c} = 0.5$ 处的通量密度为：\n$$\nq(0.5) = 4 - (0.5)^{2} = 4 - 0.25 = 3.75\n$$\n来自网格1的通量贡献为 $q(0.5) \\times A_1 = 3.75 \\times 1 = 3.75$ kg/s。\n\n对于网格2（域 $[1,2] \\times [0,1]$）：\n在中心点 $x_{2}^{c} = 1.5$ 处的通量密度为：\n$$\nq(1.5) = 4 - (1.5)^{2} = 4 - 2.25 = 1.75\n$$\n来自网格2的通量贡献为 $q(1.5) \\times A_2 = 1.75 \\times 1 = 1.75$ kg/s。\n\n非守恒总通量是这些贡献的总和：\n$$\n\\Phi_{\\text{non-conservative}} = 3.75 + 1.75 = 5.5 = \\frac{11}{2} \\text{ kg/s}\n$$\n\n最后，我们计算净伪质量增益 $\\Delta \\Phi$：\n$$\n\\Delta \\Phi = \\Phi_{\\text{non-conservative}} - \\Phi_{\\text{conservative}} = \\frac{11}{2} - \\frac{16}{3}\n$$\n为了进行分数减法，我们找到一个公分母，即 $6$：\n$$\n\\Delta \\Phi = \\frac{11 \\times 3}{2 \\times 3} - \\frac{16 \\times 2}{3 \\times 2} = \\frac{33}{6} - \\frac{32}{6} = \\frac{1}{6}\n$$\n净伪质量增益的精确值为 $\\Delta \\Phi = \\frac{1}{6}$ kg/s。\n\n问题要求将答案四舍五入到 $4$ 位有效数字。\n$$\n\\Delta \\Phi = \\frac{1}{6} \\approx 0.166666...\n$$\n四舍五入到 $4$ 位有效数字，我们得到 $0.1667$。",
            "answer": "$$\\boxed{0.1667}$$"
        },
        {
            "introduction": "在认识到非守恒方法带来的风险后，检验守恒重映射方案在理想条件下的准确性便至关重要。本练习将引导您验证一个关键性质：对于线性变化的通量场，守恒重映射不仅是一种近似，而是能够做到数学上的精确。这个练习不仅是验证耦合器算法正确性的标准方法，也有助于建立您对守恒方案在更复杂情景下可靠性的信心。",
            "id": "3868166",
            "problem": "考虑一个大气分量和一个海洋分量之间的通量交换，该交换通过一个通量耦合器实现，该耦合器使用如地球系统建模框架（ESMF）中的守恒重映方法。在地球表面的一个局部切平面片上，使用以米为单位的笛卡尔坐标 $(x,y)$，真实的连续表面热通量场被规定为线性场，\n$$\n\\phi(x,y) = \\alpha x + \\beta y + \\gamma,\n$$\n其中 $\\alpha$ 的单位是瓦特/立方米，$\\beta$ 的单位是瓦特/立方米，$\\gamma$ 的单位是瓦特/平方米。矩形物理域为 $x \\in [0,L_x]$ 和 $y \\in [0,L_y]$，其中 $L_x = 200000$，$L_y = 100000$。海洋分量在一个细网格上产生网格单元平均通量，该网格将矩形区域均匀地划分为 $N_x \\times N_y$ 个细网格单元，其中 $N_x = 8$，$N_y = 4$。大气分量在一个粗网格上接收通量，该网格将同一矩形区域均匀地划分为 $M_x \\times M_y$ 个粗网格单元，其中 $M_x = 2$，$M_y = 2$。该通量耦合器是守恒的，因为它通过对贡献的细网格单元平均值进行面积加权聚合来计算粗网格单元的平均通量，其中使用了网格之间精确的几何重叠区域。\n\n设场系数为 $\\alpha = 3.0 \\times 10^{-6}$，$\\beta = -2.0 \\times 10^{-6}$，$\\gamma = 200$，因此 $\\phi$ 的单位是瓦特/平方米。仅使用基本定义——即网格单元平均通量等于 $\\phi$ 在该单元上的面积分除以单元面积，以及守恒重映通过真实重叠区域对贡献的平均值进行加权聚合——推导所有 $M_x \\times M_y$ 个粗网格单元的解析预期粗网格单元平均通量。然后，在所述的耦合器行为下，确定在整个粗网格上，耦合器重映的粗网格单元平均值与解析的粗网格单元平均值之间的最大绝对误差。\n\n请用一个单位为瓦特/平方米的实数表示您的最终答案。不需要四舍五入。",
            "solution": "用户希望我解决以下问题：\n考虑一个大气分量和一个海洋分量之间的通量交换，该交换通过一个通量耦合器实现，该耦合器使用如地球系统建模框架（ESMF）中的守恒重映方法。在地球表面的一个局部切平面片上，使用以米为单位的笛卡尔坐标 $(x,y)$，真实的连续表面热通量场被规定为线性场，\n$$\n\\phi(x,y) = \\alpha x + \\beta y + \\gamma,\n$$\n其中 $\\alpha$ 的单位是瓦特/立方米，$\\beta$ 的单位是瓦特/立方米，$\\gamma$ 的单位是瓦特/平方米。矩形物理域为 $x \\in [0,L_x]$ 和 $y \\in [0,L_y]$，其中 $L_x = 200000$，$L_y = 100000$。海洋分量在一个细网格上产生网格单元平均通量，该网格将矩形区域均匀地划分为 $N_x \\times N_y$ 个细网格单元，其中 $N_x = 8$，$N_y = 4$。大气分量在一个粗网格上接收通量，该网格将同一矩形区域均匀地划分为 $M_x \\times M_y$ 个粗网格单元，其中 $M_x = 2$，$M_y = 2$。该通量耦合器是守恒的，因为它通过对贡献的细网格单元平均值进行面积加权聚合来计算粗网格单元的平均通量，其中使用了网格之间精确的几何重叠区域。\n\n设场系数为 $\\alpha = 3.0 \\times 10^{-6}$，$\\beta = -2.0 \\times 10^{-6}$，$\\gamma = 200$，因此 $\\phi$ 的单位是瓦特/平方米。仅使用基本定义——即网格单元平均通量等于 $\\phi$ 在该单元上的面积分除以单元面积，以及守恒重映通过真实重叠区域对贡献的平均值进行加权聚合——推导所有 $M_x \\times M_y$ 个粗网格单元的解析预期粗网格单元平均通量。然后，在所述的耦合器行为下，确定在整个粗网格上，耦合器重映的粗网格单元平均值与解析的粗网格单元平均值之间的最大绝对误差。\n\n请用一个单位为瓦特/平方米的实数表示您的最终答案。不需要四舍五入。\n\n### 第一步：提取已知条件\n-   连续表面热通量场：$\\phi(x,y) = \\alpha x + \\beta y + \\gamma$。\n-   坐标 $(x,y)$ 的单位是米。\n-   区域：$x \\in [0, L_x]$，$y \\in [0, L_y]$。\n-   区域尺寸：$L_x = 200000$ 米，$L_y = 100000$ 米。\n-   细网格（源）：$N_x \\times N_y$ 个均匀网格单元，其中 $N_x = 8$，$N_y = 4$。\n-   粗网格（目标）：$M_x \\times M_y$ 个均匀网格单元，其中 $M_x = 2$，$M_y = 2$。\n-   场系数：$\\alpha = 3.0 \\times 10^{-6}$ W/m$^3$，$\\beta = -2.0 \\times 10^{-6}$ W/m$^3$，$\\gamma = 200$ W/m$^2$。\n-   网格单元平均通量的定义：$\\phi$ 在该单元上的面积分除以单元面积。\n-   耦合器行为：通过对细网格单元平均值进行面积加权聚合实现守恒重映。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题在数值建模领域有充分的依据，特别是在地球系统模型中耦合分量的背景下。通量交换、守恒重映和网格离散化等概念都是标准概念。使用线性测试场是验证数值方案准确性的常用方法。\n2.  **适定性**：该问题是适定的。它提供了所有必要的函数、参数和定义，可以得出一个唯一的解。目标陈述清晰。\n3.  **客观性**：该问题以精确、客观和数学化的语言陈述。没有主观或基于观点的元素。\n4.  **完整性与一致性**：该问题是自洽的。为 $\\alpha$、$\\beta$、$L_x$、$L_y$ 等提供的数值是内部一致的。单位也是一致的：为了使 $\\alpha x$ 的单位为 W/m$^2$，当 $x$ 的单位为 m 时，$\\alpha$ 的单位必须是 W/m$^3$，如题目所述。\n5.  **未发现其他缺陷**：该问题并非微不足道，因为它要求严格应用定义。它不是不适定的、不切实际的或不科学的。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供解答。\n\n该问题要求计算两个量之间的最大绝对误差：“解析预期”的粗网格单元平均通量和“耦合器重映”的粗网格单元平均通量。我们必须推导这两者的表达式，然后找出它们之间的最大差异。\n\n设一个粗网格单元由索引 $(I, J)$ 表示，其中 $I \\in \\{1, \\dots, M_x\\}$ 且 $J \\in \\{1, \\dots, M_y\\}$。\n粗网格单元的尺寸为 $\\Delta x_c = L_x / M_x$ 和 $\\Delta y_c = L_y / M_y$。\n粗网格单元的面积为 $A_c = \\Delta x_c \\Delta y_c$。\n粗网格单元 $(I,J)$ 覆盖的区域为 $x \\in [(I-1)\\Delta x_c, I\\Delta x_c]$ 和 $y \\in [(J-1)\\Delta y_c, J\\Delta y_c]$。\n\n设一个细网格单元由索引 $(i, j)$ 表示，其中 $i \\in \\{1, \\dots, N_x\\}$ 且 $j \\in \\{1, \\dots, N_y\\}$。\n细网格单元的尺寸为 $\\Delta x_f = L_x / N_x$ 和 $\\Delta y_f = L_y / N_y$。\n细网格单元的面积为 $A_f = \\Delta x_f \\Delta y_f$。\n细网格单元 $(i,j)$ 覆盖的区域为 $x \\in [(i-1)\\Delta x_f, i\\Delta x_f]$ 和 $y \\in [(j-1)\\Delta y_f, j\\Delta y_f]$。\n\n**1. 解析预期的粗网格单元平均通量**\n\n粗网格单元 $(I, J)$ 的解析预期平均通量，记作 $\\bar{\\phi}_{I,J}^{\\text{analytic}}$，定义为连续场 $\\phi(x,y)$ 在粗网格单元面积上的积分，再除以该面积。\n$$\n\\bar{\\phi}_{I,J}^{\\text{analytic}} = \\frac{1}{A_c} \\int_{(J-1)\\Delta y_c}^{J\\Delta y_c} \\int_{(I-1)\\Delta x_c}^{I\\Delta x_c} \\phi(x,y) \\,dx\\,dy\n$$\n代入 $\\phi(x,y)$ 的表达式：\n$$\n\\bar{\\phi}_{I,J}^{\\text{analytic}} = \\frac{1}{A_c} \\int_{(J-1)\\Delta y_c}^{J\\Delta y_c} \\int_{(I-1)\\Delta x_c}^{I\\Delta x_c} (\\alpha x + \\beta y + \\gamma) \\,dx\\,dy\n$$\n对于任意在区间 $[a, b]$ 上可积的函数 $f(p)$，其平均值为 $\\frac{1}{b-a}\\int_a^b f(p) dp$。对于线性函数 $f(p) = c_1 p + c_0$，其平均值为 $f\\left(\\frac{a+b}{2}\\right)$，即函数在区间中点处的值。\n我们可以应用这个性质。线性函数在矩形区域上的积分等于该区域的面积乘以函数在该区域质心处的值。\n粗网格单元 $(I,J)$ 的质心为 $(x_{c,I}, y_{c,J})$，其中：\n$$\nx_{c,I} = (I-1)\\Delta x_c + \\frac{\\Delta x_c}{2} = \\left(I - \\frac{1}{2}\\right)\\Delta x_c\n$$\n$$\ny_{c,J} = (J-1)\\Delta y_c + \\frac{\\Delta y_c}{2} = \\left(J - \\frac{1}{2}\\right)\\Delta y_c\n$$\n因此，解析平均通量就是连续通量场在粗网格单元质心处的值：\n$$\n\\bar{\\phi}_{I,J}^{\\text{analytic}} = \\phi(x_{c,I}, y_{c,J}) = \\alpha x_{c,I} + \\beta y_{c,J} + \\gamma\n$$\n\n**2. 耦合器重映的粗网格单元平均通量**\n\n耦合器的过程包括两个步骤：\ni. 计算每个细网格单元的平均通量。\nii. 聚合这些细网格单元的平均值以得到粗网格单元的平均值。\n\n**步骤 i：细网格单元平均通量**\n与粗网格单元情况类似，细网格单元 $(i,j)$ 的平均通量，记作 $\\bar{\\phi}_{i,j}^{\\text{fine}}$，是连续通量场在细网格单元质心 $(x_{f,i}, y_{f,j})$ 处的值。\n质心坐标为：\n$$\nx_{f,i} = \\left(i - \\frac{1}{2}\\right)\\Delta x_f\n$$\n$$\ny_{f,j} = \\left(j - \\frac{1}{2}\\right)\\Delta y_f\n$$\n所以，细网格单元的平均通量为：\n$$\n\\bar{\\phi}_{i,j}^{\\text{fine}} = \\phi(x_{f,i}, y_{f,j}) = \\alpha x_{f,i} + \\beta y_{f,j} + \\gamma\n$$\n\n**步骤 ii：向粗网格单元聚合**\n耦合器通过细网格单元平均值的面积加权平均来计算粗网格单元平均值 $\\bar{\\phi}_{I,J}^{\\text{coupler}}$。由于网格是均匀且嵌套的，每个粗网格单元都是一个由若干细网格单元组成的完美矩形。每个粗网格单元包含的细网格单元数量为 $n_x \\times n_y$，其中 $n_x = N_x/M_x$ 且 $n_y = N_y/M_y$。贡献单元的重叠区域是它们的完整面积 $A_f$。\n粗网格单元 $I$ 内的细网格单元 $x$ 索引 $i$ 的集合是 $\\{(I-1)n_x + 1, \\dots, In_x\\}$。\n粗网格单元 $J$ 内的细网格单元 $y$ 索引 $j$ 的集合是 $\\{(J-1)n_y + 1, \\dots, Jn_y\\}$。\n\n重映通量的公式为：\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\frac{\\sum_{j=(J-1)n_y+1}^{Jn_y} \\sum_{i=(I-1)n_x+1}^{In_x} A_f \\bar{\\phi}_{i,j}^{\\text{fine}}}{\\sum A_f} = \\frac{1}{n_x n_y} \\sum_{j=(J-1)n_y+1}^{Jn_y} \\sum_{i=(I-1)n_x+1}^{In_x} \\bar{\\phi}_{i,j}^{\\text{fine}}\n$$\n这是组成粗网格单元的细网格单元平均值的简单算术平均。代入 $\\bar{\\phi}_{i,j}^{\\text{fine}}$ 的表达式：\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\frac{1}{n_x n_y} \\sum_{j=\\dots} \\sum_{i=\\dots} (\\alpha x_{f,i} + \\beta y_{f,j} + \\gamma)\n$$\n分配求和：\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\frac{1}{n_x n_y} \\left( \\sum_j \\sum_i \\alpha x_{f,i} + \\sum_j \\sum_i \\beta y_{f,j} + \\sum_j \\sum_i \\gamma \\right)\n$$\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\alpha \\left( \\frac{1}{n_x} \\sum_{i=(I-1)n_x+1}^{In_x} x_{f,i} \\right) + \\beta \\left( \\frac{1}{n_y} \\sum_{j=(J-1)n_y+1}^{Jn_y} y_{f,j} \\right) + \\gamma\n$$\n项 $\\frac{1}{n_x} \\sum_{i=(I-1)n_x+1}^{In_x} x_{f,i}$ 是构成粗网格第 $I$ 列的细网格单元质心 $x$ 坐标的平均值。由于细网格是均匀分布的，这个平均值恰好是粗网格单元质心的 $x$ 坐标，即 $x_{c,I}$。\n证明如下：\n设 $S_x = \\frac{1}{n_x} \\sum_{i=(I-1)n_x+1}^{In_x} (i - \\frac{1}{2})\\Delta x_f$。这是一个等差数列。等差数列的平均值是其首项和末项的平均值。\n首项：$i_1 = (I-1)n_x+1 \\implies x_{f,i_1} = ((I-1)n_x + \\frac{1}{2})\\Delta x_f$。\n末项：$i_2 = In_x \\implies x_{f,i_2} = (In_x - \\frac{1}{2})\\Delta x_f$。\n平均值：$S_x = \\frac{1}{2} \\left[ ((I-1)n_x + \\frac{1}{2})\\Delta x_f + (In_x - \\frac{1}{2})\\Delta x_f \\right] = \\frac{\\Delta x_f}{2} ( (I-1)n_x + In_x ) = \\frac{\\Delta x_f}{2} (2In_x - n_x) = \\Delta x_f n_x (I - \\frac{1}{2})$。\n由于 $n_x \\Delta x_f = (N_x/M_x)(L_x/N_x) = L_x/M_x = \\Delta x_c$，我们有：\n$S_x = \\Delta x_c (I - \\frac{1}{2}) = x_{c,I}$。\n\n同理，细网格单元质心 $y$ 坐标的平均值是粗网格单元质心的 $y$ 坐标：\n$$\n\\frac{1}{n_y} \\sum_{j=(J-1)n_y+1}^{Jn_y} y_{f,j} = y_{c,J}\n$$\n将这些代回 $\\bar{\\phi}_{I,J}^{\\text{coupler}}$ 的表达式中：\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\alpha x_{c,I} + \\beta y_{c,J} + \\gamma\n$$\n\n**3. 误差计算**\n\n每个粗网格单元 $(I,J)$ 的误差是耦合器重映的平均值与解析平均值之差：\n$$\nE_{I,J} = \\bar{\\phi}_{I,J}^{\\text{coupler}} - \\bar{\\phi}_{I,J}^{\\text-analytic}\n$$\n根据我们的推导：\n$$\n\\bar{\\phi}_{I,J}^{\\text{coupler}} = \\alpha x_{c,I} + \\beta y_{c,J} + \\gamma\n$$\n$$\n\\bar{\\phi}_{I,J}^{\\text{analytic}} = \\alpha x_{c,I} + \\beta y_{c,J} + \\gamma\n$$\n因此，对于任何粗网格单元 $(I,J)$，这两个量是相同的。\n$$\nE_{I,J} = (\\alpha x_{c,I} + \\beta y_{c,J} + \\gamma) - (\\alpha x_{c,I} + \\beta y_{c,J} + \\gamma) = 0\n$$\n所有粗网格单元的误差均为零。这个结果源于通量场 $\\phi$ 的线性特性，以及重映是在嵌套的、均匀的、正交的网格上执行的这一事实。在这种情况下，守恒重映方案是精确的，意味着它不会引入任何误差。\n\n整个粗网格上的最大绝对误差是所有 $I,J$ 的 $|E_{I,J}|$ 的最大值。\n$$\n\\max_{I,J} |E_{I,J}| = \\max_{I,J} |0| = 0\n$$\n要得出这个结论，并不需要 $\\alpha, \\beta, \\gamma, L_x, L_y, N_x, N_y, M_x, M_y$ 的具体数值，因为只要场是线性的且网格如所述，结果就是解析精确的并且与这些参数无关。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "除了确保物理量的守恒，耦合策略的计算效率在高性能地球系统模拟中同样至关重要。此实践将您的注意力从算法的准确性转向其性能表现，通过分析两种常见的耦合策略——串行与并行，来量化计算性能。通过推导和计算，您将学会如何根据模型组件的计算时间与同步开销，来判断何时采用并行计算能够带来真实的性能提升。",
            "id": "3868314",
            "problem": "在一个地球系统模型（ESM）实验中，大气分量和海洋分量在每个模型步通过一个通量耦合器交换通量。大气分量的每步计算时间为 $T_{a} = 10$ 秒，海洋分量的每步计算时间为 $T_{o} = 15$ 秒，当两个分量并发运行时，耦合器会产生每步 $T_{s} = 2$ 秒的同步开销。假设通量耦合器执行标准的状态协调和守恒重映射，并且每个步骤包含一个单一的交换点，在该点两个分量必须在继续进行之前提供并接收通量。\n\n考虑两种耦合策略：\n- 顺序耦合：在通量耦合器的调度下，各分量在一个步骤内依次运行，并发执行的分量之间没有显式的同步屏障。\n- 并行耦合：各分量并发运行，并通过由通量耦合器管理的每步单个屏障进行同步，这会产生同步开销 $T_{s}$。\n\n使用串行和并发执行中墙钟时间的基本定义以及每步单个同步屏障的概念：\n1. 推导顺序耦合下每步墙钟时间的表达式，用 $T_{a}$ 和 $T_{o}$ 表示。\n2. 推导并行耦合下每步墙钟时间的表达式，用 $T_{a}$、$T_{o}$ 和 $T_{s}$ 表示。\n3. 推导一个用 $T_{a}$、$T_{o}$ 和 $T_{s}$ 表示的一般不等式，该不等式刻画了与顺序耦合相比，并行耦合何时是有利的（即每步严格更快）。\n4. 对于给定的值 $T_{a} = 10$ 秒、$T_{o} = 15$ 秒和 $T_{s} = 2$ 秒，计算加速比 $S$，定义为 $S = t_{\\text{seq}} / t_{\\text{par}}$，其中 $t_{\\text{seq}}$ 和 $t_{\\text{par}}$ 分别是顺序耦合和并行耦合下的每步墙钟时间。\n\n将最终的加速比 $S$ 表示为一个精确的有理数，不进行四舍五入，并且最终答案中不包含单位。所有中间推导过程都必须展示出来。",
            "solution": "在尝试求解之前，将首先对问题陈述的科学合理性、自洽性和清晰性进行验证。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n问题陈述中提供的数据和定义如下：\n-   大气分量每步计算时间：$T_{a} = 10$ 秒。\n-   海洋分量每步计算时间：$T_{o} = 15$ 秒。\n-   并发执行时耦合器每步同步开销：$T_{s} = 2$ 秒。\n-   顺序耦合的定义：各分量依次运行。总时间是它们各自计算时间的总和。\n-   并行耦合的定义：各分量并发运行。总时间由运行时间最长的分量加上同步开销决定。\n-   加速比的定义：$S = t_{\\text{seq}} / t_{\\text{par}}$，其中 $t_{\\text{seq}}$ 和 $t_{\\text{par}}$ 分别是顺序耦合和并行耦合的每步墙钟时间。\n\n#### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n-   **科学依据**：该问题基于并行和串行计算的基本原理，这些原理是高性能计算及其在地球系统模型（ESM）中应用的核心。分量运行时间、并发性、同步开销和加速比等概念是标准的，并得到了准确的表述。\n-   **适定性**：该问题定义清晰。它提供了所有必要的参数（$T_{a}$、$T_{o}$、$T_{s}$）以及两种耦合策略的明确定义。任务是具体的，并能导出一个唯一的、可推导的解。\n-   **客观性**：所用语言形式化且精确，采用了计算科学的标准术语（例如，“通量耦合器”、“守恒重映射”、“同步屏障”）。问题陈述没有主观或模糊的措辞。\n-   **完整性与一致性**：问题是自成体系的。所提供的数据是充分的，并与定义一致。关于 $T_{s}$ 仅适用于并发情况的明确说明是一个关键而清晰的区别。\n-   **现实性**：执行时间（$10$ 秒，$15$ 秒）和开销（$2$ 秒）对于一个复杂耦合模型的单个时间步来说是合理的数值，代表了一个简化但概念上有效的场景。\n\n#### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为它是科学合理的、适定的、客观的且内部一致的。它提出了一个计算建模中的标准、可形式化的问题。将推导完整的解。\n\n### 解题推导\n\n将按顺序解决问题陈述的四个部分来展开解答。\n\n#### 1. 顺序耦合下的每步墙钟时间 ($t_{\\text{seq}}$)\n在顺序耦合下，大气分量和海洋分量依次执行。单个步骤的总墙钟时间 $t_{\\text{seq}}$ 是各分量计算时间的总和。如问题描述所述，在这种情况下，同步开销 $T_{s}$ 不适用，因为各分量不是并发运行的。\n\n因此，表达式为：\n$$t_{\\text{seq}} = T_{a} + T_{o}$$\n\n#### 2. 并行耦合下的每步墙钟时间 ($t_{\\text{par}}$)\n在并行耦合下，各分量并发执行。执行的并发部分所花费的时间由计算时间较长的分量决定，因为较快的分量必须等待较慢的分量完成。这个时间由 $\\max(T_{a}, T_{o})$ 给出。在两个分量都完成计算后，它们必须由耦合器进行同步，这个过程会引入一个指定的开销 $T_{s}$。这个开销时间被加到并发执行时间上。\n\n因此，每步总墙钟时间 $t_{\\text{par}}$ 的表达式为：\n$$t_{\\text{par}} = \\max(T_{a}, T_{o}) + T_{s}$$\n\n#### 3. 并行耦合有利时的一般不等式\n如果并行耦合的每步墙钟时间严格小于顺序耦合的墙钟时间，那么并行耦合就比顺序耦合严格更有利（即更快）。这个条件可以表示为不等式：\n$$t_{\\text{par}}  t_{\\text{seq}}$$\n代入前几部分推导出的表达式：\n$$\\max(T_{a}, T_{o}) + T_{s}  T_{a} + T_{o}$$\n为了简化这个不等式，我们可以使用恒等式 $T_{a} + T_{o} = \\min(T_{a}, T_{o}) + \\max(T_{a}, T_{o})$。将此代入不等式的右边得到：\n$$\\max(T_{a}, T_{o}) + T_{s}  \\min(T_{a}, T_{o}) + \\max(T_{a}, T_{o})$$\n从不等式两边减去项 $\\max(T_{a}, T_{o})$，得到一般条件：\n$$T_{s}  \\min(T_{a}, T_{o})$$\n这个结果在直观上是正确的：要使并行执行具有优势，通过并发运行节省的时间（等于较快分量的运行时间，即 $\\min(T_a, T_o)$）必须大于为同步而产生的开销成本（$T_s$）。\n\n#### 4. 加速比 $S$ 的计算\n问题给出了具体值：$T_{a} = 10$ 秒，$T_{o} = 15$ 秒，以及 $T_{s} = 2$ 秒。首先，我们计算每种耦合策略的墙钟时间。\n\n对于顺序耦合：\n$$t_{\\text{seq}} = T_{a} + T_{o} = 10 + 15 = 25 \\text{ s}$$\n对于并行耦合：\n$$t_{\\text{par}} = \\max(T_{a}, T_{o}) + T_{s} = \\max(10, 15) + 2 = 15 + 2 = 17 \\text{ s}$$\n\n加速比 $S$ 定义为顺序时间与并行时间之比：\n$$S = \\frac{t_{\\text{seq}}}{t_{\\text{par}}}$$\n代入计算出的值：\n$$S = \\frac{25}{17}$$\n这是一个精确的有理数，符合要求。由于 $17$ 和 $25$ 互质，该分数已是最简形式。",
            "answer": "$$\\boxed{\\frac{25}{17}}$$"
        }
    ]
}