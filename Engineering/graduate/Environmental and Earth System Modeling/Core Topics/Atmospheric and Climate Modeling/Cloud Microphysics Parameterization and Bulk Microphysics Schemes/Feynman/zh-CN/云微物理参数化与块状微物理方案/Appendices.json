{
    "hands_on_practices": [
        {
            "introduction": "集总微物理方案使用数学分布（如伽马分布）来描述云滴或雨滴等水凝物粒子的整个群体。一项关键技能是能够将该分布的参数与模式的预报变量（如含水量）和真实世界的观测量（如雷达反射率因子 $Z$）联系起来。这个练习将通过推导 $Z$ 与雨水混合比 $q_{r}$ 和数浓度 $N_{r}$ 之间的关系，巩固您对粒子谱矩及其物理意义的理解。",
            "id": "3867740",
            "problem": "一个暖雨整体微物理方案假设雨滴的三参数伽马滴谱分布(DSD)由 $N(D) = N_{0} D^{\\mu} \\exp(-\\lambda D)$ 给出，其中 $D \\ge 0$。这里，$D$ 是滴径，$N(D)$ 的单位是单位体积单位直径内的粒子数，$\\mu$ 是一个非负的形状参数，$N_{0}$ 是一个截距参数，$\\lambda$ 是一个斜率参数。令雨滴数浓度 $N_{r}$ 为 $N_{r} = \\int_{0}^{\\infty} N(D)\\,\\mathrm{d}D$，令雨水混合比 $q_{r}$ 与 $N(D)$ 的三阶矩相关，关系式为 $q_{r} = \\rho_{r}/\\rho_{a}$，其中 $\\rho_{r} = (\\pi/6)\\,\\rho_{w} \\int_{0}^{\\infty} D^{3} N(D)\\,\\mathrm{d}D$。这里 $\\rho_{a}$ 是空气密度，$\\rho_{w}$ 是液态水密度。在瑞利散射近似下，定义雷达反射率因子 $Z$（使用一致的直径单位）为 $Z = \\int_{0}^{\\infty} D^{6} N(D)\\,\\mathrm{d}D$。\n\n仅从这些定义和基本积分恒等式 $\\int_{0}^{\\infty} x^{\\alpha-1} \\exp(-\\beta x)\\,\\mathrm{d}x = \\Gamma(\\alpha)\\,\\beta^{-\\alpha}$（对于 $\\alpha0, \\beta0$）出发，其中 $\\Gamma(\\cdot)$ 是伽马函数，完成以下任务：\n\n1. 推导一个用 $q_{r}$、$N_{r}$、$\\mu$ 和物理常数表示的 $Z$ 的显式闭式表达式。您的推导必须消去 $N_{0}$ 和 $\\lambda$。\n\n2. 将 $Z$ 对形状参数的敏感度定义为对数导数 $S_{\\mu} \\equiv \\partial \\ln Z / \\partial \\mu$。使用您得到的 $Z$ 的表达式，求出 $S_{\\mu}$ 的闭式形式。\n\n3. 精确计算 $S_{\\mu}$ 在 $\\mu = 2$ 处的值。将最终答案以一个无单位的实数形式给出。如果需要近似，请将答案四舍五入到四位有效数字。\n\n假设 $D$ 的单位是米，$\\rho_{a}$ 和 $\\rho_{w}$ 是正常数；在推导过程中您可以将它们保留为符号。除已说明的内容外，不要假设任何经验性闭合方案。您的最终答案应为所要求的 $S_{\\mu}$ 在 $\\mu=2$ 时的数值。",
            "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 滴谱分布 (DSD): $N(D) = N_{0} D^{\\mu} \\exp(-\\lambda D)$，其中 $D \\ge 0$。\n- 滴径: $D$。\n- $N(D)$ 单位：单位体积单位直径内的粒子数。\n- 形状参数: $\\mu \\ge 0$。\n- 截距参数: $N_{0}$。\n- 斜率参数: $\\lambda$。\n- 雨滴数浓度: $N_{r} = \\int_{0}^{\\infty} N(D)\\,\\mathrm{d}D$。\n- 雨水混合比: $q_{r} = \\rho_{r}/\\rho_{a}$。\n- 雨水质量密度: $\\rho_{r} = (\\pi/6)\\,\\rho_{w} \\int_{0}^{\\infty} D^{3} N(D)\\,\\mathrm{d}D$。\n- 空气密度: $\\rho_{a}$，一个正常数。\n- 液态水密度: $\\rho_{w}$，一个正常数。\n- 雷达反射率因子: $Z = \\int_{0}^{\\infty} D^{6} N(D)\\,\\mathrm{d}D$。\n- 积分恒等式: $\\int_{0}^{\\infty} x^{\\alpha-1} \\exp(-\\beta x)\\,\\mathrm{d}x = \\Gamma(\\alpha)\\,\\beta^{-\\alpha}$，其中 $\\alpha0$, $\\beta0$。\n- 伽马函数: $\\Gamma(\\cdot)$。\n\n步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于云微物理学中标准且成熟的概念。三参数伽马分布是雨滴尺寸的典型模型。数浓度($N_r$)、雨水混合比($q_r$)和雷达反射率因子($Z$)的定义分别对应于分布的零阶矩、三阶矩和六阶矩，这是大气科学和遥感领域的标准做法。所有前提在事实上和科学上都是合理的。\n2.  **适定性**：该问题提供了明确的目标以及实现该目标所需的所有定义和数学恒等式。条件 $\\mu \\ge 0$, $\\lambda0$ 确保了 $N_r$, $q_r$ 和 $Z$ 的积分收敛，并且伽马积分恒等式适用。该问题是自洽的，并允许有唯一解。\n3.  **客观性**：语言精确、量化，没有任何主观或模棱两可的术语。\n\n结论与行动：问题有效。它具有科学依据、适定性且客观。将提供完整的解答。\n\n**推导与求解**\n\n首先计算DSD的 $p$ 阶矩的一般形式，$M_p = \\int_{0}^{\\infty} D^p N(D)\\,\\mathrm{d}D$。\n$$M_p = \\int_{0}^{\\infty} D^p \\left( N_{0} D^{\\mu} \\exp(-\\lambda D) \\right) \\,\\mathrm{d}D = N_{0} \\int_{0}^{\\infty} D^{p+\\mu} \\exp(-\\lambda D) \\,\\mathrm{d}D$$\n使用给定的积分恒等式，令 $x=D$, $\\alpha-1 = p+\\mu$ (因此 $\\alpha = p+\\mu+1$), 以及 $\\beta = \\lambda$, 我们得到：\n$$M_p = N_{0} \\frac{\\Gamma(p+\\mu+1)}{\\lambda^{p+\\mu+1}}$$\n此结果在 $p+\\mu+1  0$ 时有效。由于 $\\mu \\ge 0$，该结果对这里所需的所有矩（$p=0, 3, 6$）都成立。\n\n**第一部分：推导Z的显式闭式表达式。**\n\n我们使用矩的公式来表示 $N_r$, $q_r$ 和 $Z$。\n数浓度 $N_r$ 是零阶矩 ($p=0$):\n$$N_r = M_0 = N_{0} \\frac{\\Gamma(\\mu+1)}{\\lambda^{\\mu+1}} \\quad (1)$$\n雨水混合比 $q_r$ 与三阶矩 ($p=3$) 成正比：\n$$q_r = \\frac{\\rho_r}{\\rho_a} = \\frac{1}{\\rho_a} \\left( \\frac{\\pi \\rho_w}{6} \\int_{0}^{\\infty} D^{3} N(D)\\,\\mathrm{d}D \\right) = \\frac{\\pi \\rho_w}{6 \\rho_a} M_3$$\n$$q_r = \\frac{\\pi \\rho_w}{6 \\rho_a} N_{0} \\frac{\\Gamma(\\mu+4)}{\\lambda^{\\mu+4}} \\quad (2)$$\n雷达反射率因子 $Z$ 是六阶矩 ($p=6$):\n$$Z = M_6 = N_{0} \\frac{\\Gamma(\\mu+7)}{\\lambda^{\\mu+7}} \\quad (3)$$\n目标是用 $N_r$, $q_r$, $\\mu$ 和常数来表示 $Z$，并消去 $N_0$ 和 $\\lambda$。我们可以通过构造比率来消去 $N_0$。\n从方程 $(1)$，我们解出 $N_0$：$N_0 = N_r \\frac{\\lambda^{\\mu+1}}{\\Gamma(\\mu+1)}$。\n将此代入方程 $(2)$：\n$$q_r = \\frac{\\pi \\rho_w}{6 \\rho_a} \\left( N_r \\frac{\\lambda^{\\mu+1}}{\\Gamma(\\mu+1)} \\right) \\frac{\\Gamma(\\mu+4)}{\\lambda^{\\mu+4}} = \\frac{\\pi \\rho_w N_r}{6 \\rho_a} \\frac{\\Gamma(\\mu+4)}{\\Gamma(\\mu+1)} \\lambda^{-3}$$\n现在，解出 $\\lambda^3$ 及随后的 $\\lambda^{-6}$：\n$$\\lambda^3 = \\frac{\\pi \\rho_w N_r}{6 \\rho_a q_r} \\frac{\\Gamma(\\mu+4)}{\\Gamma(\\mu+1)}$$\n$$\\lambda^{-6} = (\\lambda^3)^{-2} = \\left( \\frac{6 \\rho_a q_r}{\\pi \\rho_w N_r} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+4)} \\right)^2$$\n现在，我们来找一个更易于代入的 $Z$ 的表达式。由方程 $(1)$ 和 $(3)$ 得：\n$$\\frac{Z}{N_r} = \\frac{N_{0} \\Gamma(\\mu+7) / \\lambda^{\\mu+7}}{N_{0} \\Gamma(\\mu+1) / \\lambda^{\\mu+1}} = \\frac{\\Gamma(\\mu+7)}{\\Gamma(\\mu+1)} \\lambda^{-6}$$\n所以，$Z = N_r \\frac{\\Gamma(\\mu+7)}{\\Gamma(\\mu+1)} \\lambda^{-6}$。\n代入 $\\lambda^{-6}$ 的表达式：\n$$Z = N_r \\frac{\\Gamma(\\mu+7)}{\\Gamma(\\mu+1)} \\left( \\frac{6 \\rho_a q_r}{\\pi \\rho_w N_r} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+4)} \\right)^2$$\n$$Z = N_r \\frac{\\Gamma(\\mu+7)}{\\Gamma(\\mu+1)} \\left( \\frac{6 \\rho_a q_r}{\\pi \\rho_w N_r} \\right)^2 \\frac{[\\Gamma(\\mu+1)]^2}{[\\Gamma(\\mu+4)]^2}$$\n$$Z = \\left( \\frac{6 \\rho_a}{\\pi \\rho_w} \\right)^2 \\frac{q_r^2}{N_r} \\frac{\\Gamma(\\mu+1)\\Gamma(\\mu+7)}{[\\Gamma(\\mu+4)]^2}$$\n这就是所要求的 $Z$ 的闭式表达式。\n\n**第二部分：以闭式形式求出敏感度 $S_{\\mu} \\equiv \\partial \\ln Z / \\partial \\mu$。**\n\n我们对 $Z$ 的表达式取自然对数。不依赖于 $\\mu$ 的项可以归为一个常数 $C$。\n$$Z = C \\cdot \\frac{\\Gamma(\\mu+1)\\Gamma(\\mu+7)}{[\\Gamma(\\mu+4)]^2}, \\quad \\text{其中} \\quad C = \\left( \\frac{6 \\rho_a}{\\pi \\rho_w} \\right)^2 \\frac{q_r^2}{N_r}$$\n$$\\ln Z = \\ln(C) + \\ln(\\Gamma(\\mu+1)) + \\ln(\\Gamma(\\mu+7)) - 2\\ln(\\Gamma(\\mu+4))$$\n现在，我们对 $\\mu$ 求导以求得 $S_\\mu$。我们使用双伽马函数的定义，$\\psi(x) = \\frac{d}{dx}\\ln(\\Gamma(x))$。\n$$S_\\mu = \\frac{\\partial}{\\partial \\mu} \\ln Z = 0 + \\frac{d}{d\\mu}\\ln(\\Gamma(\\mu+1)) + \\frac{d}{d\\mu}\\ln(\\Gamma(\\mu+7)) - 2\\frac{d}{d\\mu}\\ln(\\Gamma(\\mu+4))$$\n应用链式法则得到：\n$$S_\\mu = \\psi(\\mu+1) + \\psi(\\mu+7) - 2\\psi(\\mu+4)$$\n这是敏感度 $S_\\mu$ 的闭式表达式。\n\n**第三部分：精确计算 $S_{\\mu}$ 在 $\\mu = 2$ 处的值。**\n\n我们将 $\\mu=2$ 代入 $S_\\mu$ 的表达式：\n$$S_\\mu |_{\\mu=2} = \\psi(2+1) + \\psi(2+7) - 2\\psi(2+4)$$\n$$S_\\mu |_{\\mu=2} = \\psi(3) + \\psi(9) - 2\\psi(6)$$\n对于整数参数 $n0$，双伽马函数由 $\\psi(n) = H_{n-1} - \\gamma$ 给出，其中 $H_{k} = \\sum_{i=1}^{k} \\frac{1}{i}$ 是第 $k$ 个调和数 ($H_0=0$)，$\\gamma$ 是欧拉-马歇罗尼常数。\n将此代入表达式中：\n$$S_\\mu |_{\\mu=2} = (H_{2} - \\gamma) + (H_{8} - \\gamma) - 2(H_{5} - \\gamma)$$\n$$S_\\mu |_{\\mu=2} = H_2 - \\gamma + H_8 - \\gamma - 2H_5 + 2\\gamma = H_2 + H_8 - 2H_5$$\n欧拉-马歇罗尼常数 $\\gamma$ 被消掉了。我们现在计算所需的调和数：\n$$H_2 = 1 + \\frac{1}{2} = \\frac{3}{2}$$\n$$H_5 = 1 + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} = \\frac{60+30+20+15+12}{60} = \\frac{137}{60}$$\n$$H_8 = 1 + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8} = H_5 + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8} = \\frac{137}{60} + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8}$$\n$60, 6, 7, 8$ 的最小公倍数是 $840$。\n$$H_8 = \\frac{137 \\times 14}{840} + \\frac{140}{840} + \\frac{120}{840} + \\frac{105}{840} = \\frac{1918 + 140 + 120 + 105}{840} = \\frac{2283}{840} = \\frac{761}{280}$$\n现在我们计算 $S_\\mu |_{\\mu=2}$：\n$$S_\\mu |_{\\mu=2} = \\frac{3}{2} + \\frac{761}{280} - 2\\left(\\frac{137}{60}\\right) = \\frac{3}{2} + \\frac{761}{280} - \\frac{137}{30}$$\n$2, 280, 30$ 的最小公倍数是 $840$。\n$$S_\\mu |_{\\mu=2} = \\frac{3 \\times 420}{840} + \\frac{761 \\times 3}{840} - \\frac{137 \\times 28}{840}$$\n$$S_\\mu |_{\\mu=2} = \\frac{1260 + 2283 - 3836}{840} = \\frac{3543 - 3836}{840} = \\frac{-293}{840}$$\n分子 $293$ 是一个质数，分母是 $840 = 2^3 \\cdot 3 \\cdot 5 \\cdot 7$，因此该分数为最简形式。",
            "answer": "$$\\boxed{-\\frac{293}{840}}$$"
        },
        {
            "introduction": "水汽与液态/冰态水之间的相变是云物理学的核心。饱和调整是模式中用于确保热力学一致性的关键过程，通过凝结多余的水汽或蒸发云水来实现。本练习将深入探讨该过程的第一性原理，从总水物质和湿焓守恒定律出发，推导控制方程，并揭示潜热释放在相变过程中如何与温度变化耦合。",
            "id": "3867671",
            "problem": "考虑一个应用于单个、充分混合且气压固定的暖雨、单矩块体微物理饱和调整步骤。调整前的预报变量为水汽质量混合比 $q_v$（千克水汽/千克湿空气）、云液水质量混合比 $q_c$（千克液态水/千克湿空气）和温度 $T$（开尔文）。饱和调整通过在 $q_v$ 和 $q_c$ 之间交换质量，使热力学状态瞬时松弛到饱和或次饱和平衡，同时保持总水和湿焓守恒。\n\n假设遵循以下基本原理和闭合方案：\n- 总水守恒：$q_t = q_v + q_c$ 在调整过程中保持不变。\n- 暖相（无冰）湿焓守恒：$h = c_{pd}\\,T + L_v\\,q_v$ 保持不变，其中 $c_{pd}$ 是干空气定压比热，$L_v$ 是蒸发潜热，均视为常数。\n- 液态水上的饱和水汽压 $e_s(T)$ 遵循积分形式的克劳修斯-克拉佩龙关系（其中 $L_v$ 为常数）：\n$$\ne_s(T) \\;=\\; e_{s0}\\,\\exp\\!\\Bigg[\\frac{L_v}{R_v}\\Bigg(\\frac{1}{T_0}-\\frac{1}{T}\\Bigg)\\Bigg],\n$$\n其中 $e_{s0}$ 是参考温度 $T_0$ 下的饱和水汽压，$R_v$ 是水汽的比气体常数。\n- 在气压 $p$ 下的饱和水汽混合比为\n$$\nq_{vs}(T,p) \\;=\\; \\epsilon\\,\\frac{e_s(T)}{p - e_s(T)},\n$$\n其中 $\\epsilon = R_d/R_v$，$R_d$ 是干空气的比气体常数。\n\n从这些原理出发，并且不引用任何预先推导的饱和调整公式，完成以下任务：\n\n1. 推导一个非线性系统，用于根据调整前状态 $(q_v,\\,q_c,\\,T)$ 和固定气压 $p$ 确定调整后状态 $(T',\\,q_v',\\,q_c')$。您的系统必须用 $q_t$ 和 $h$ 的守恒定律，以及调整后存在液态水时适用的热力学饱和约束来表示。清晰地区分调整后状态是存在液态水的饱和状态，还是所有液态水都蒸发后的次饱和状态这两种情况。\n\n2. 对于给定的初始状态和常数\n$$\nT \\;=\\; 283 \\text{ K},\\quad p \\;=\\; 9.0000\\times 10^{4} \\text{ Pa},\\quad q_v \\;=\\; 0.0120,\\quad q_c \\;=\\; 0,\n$$\n和\n$$\nc_{pd} \\;=\\; 1004 \\text{ J kg}^{-1}\\text{ K}^{-1},\\quad L_v \\;=\\; 2.500\\times 10^{6} \\text{ J kg}^{-1},\\quad R_v \\;=\\; 461 \\text{ J kg}^{-1}\\text{ K}^{-1},\\quad \\epsilon \\;=\\; 0.622,\n$$\n$$\ne_{s0} \\;=\\; 611.2 \\text{ Pa},\\quad T_0 \\;=\\; 273.15 \\text{ K},\n$$\n使用您的非线性系统来确定满足焓守恒和适当的汽-液热力学约束的调整后温度 $T'$。将您的答案四舍五入到四位有效数字。最终温度以开尔文表示。\n\n您的推导必须明确说明与相变相关的潜热释放或吸收如何通过焓约束与温度趋势耦合。最终报告的答案必须是如上所述的 $T'$ 的单个数值。",
            "solution": "该问题分为两部分：首先，推导饱和调整过程的控制方程；其次，应用这些方程求解特定初始状态下的最终调整温度。\n\n### 第一部分：非线性系统的推导\n\n设大气网格单元的初始状态由温度 $T$、水汽质量混合比 $q_v$ 和云液水质量混合比 $q_c$ 描述。气压 $p$ 保持不变。饱和调整过程导致最终状态 $(T', q_v', q_c')$。\n\n该过程由两个基本守恒原理控制：\n\n1.  **总水守恒：** 总水质量混合比 $q_t$（即水汽和液态水之和）是守恒的。\n    $$q_t = q_v + q_c = q_v' + q_c'$$\n\n2.  **湿焓守恒：** 问题中定义的湿焓 $h$ 也是守恒的。\n    $$h = c_{pd}T + L_v q_v = c_{pd}T' + L_v q_v'$$\n\n从湿焓守恒方程中，我们可以分离出温度变化和水汽变化之间的关系。\n$$c_{pd}(T' - T) = L_v q_v - L_v q_v' = L_v(q_v - q_v')$$\n该方程明确展示了潜热交换与温度之间的耦合关系。凝结，即水汽转化为液态水，意味着 $q_v'  q_v$，这会导致潜热释放和温度升高，$T'  T$。相反，蒸发（$q_v'  q_v$）会消耗潜热，导致冷却（$T'  T$）。\n\n系统的最终状态取决于它是饱和还是次饱和。这导致了两种不同的情况。饱和的条件是水汽混合比等于饱和水汽混合比 $q_{vs}(T,p)$，后者是温度和气压的函数。\n\n**情况1：次饱和最终状态**\n如果最终状态不含液态水，即 $q_c' = 0$，则出现此种情况。这可能发生在初始次饱和且含有一些云水的气块蒸发了所有云水后，仍然保持次饱和。\n如果 $q_c' = 0$，根据总水守恒，最终水汽混合比等于总水混合比：\n$$q_v' = q_t = q_v + q_c$$\n最终温度 $T'$ 由焓守恒确定：\n$$c_{pd}T' + L_v(q_v + q_c) = c_{pd}T + L_v q_v$$\n$$T' = T - \\frac{L_v q_c}{c_{pd}}$$\n只有当气块确实是次饱和时，这个最终状态在物理上才是一致的，即：\n$$q_v' \\le q_{vs}(T', p) \\quad \\text{或} \\quad q_t \\le q_{vs}\\left(T - \\frac{L_v q_c}{c_{pd}}, p\\right)$$\n如果不满足此条件，则意味着在所有云水蒸发完之前就达到了饱和，系统必须按情况2处理。如果初始状态 $q_c=0$ 且未过饱和（$q_v \\le q_{vs}(T,p)$），则不发生调整，且 $(T', q_v', q_c') = (T, q_v, q_c)$。\n\n**情况2：饱和最终状态**\n如果最终状态含有一定量的液态水，即 $q_c' \\ge 0$，则出现此种情况。这发生在初始气块过饱和（$q_v  q_{vs}(T,p)$）时，或者初始时次饱和但有足够的云水在部分蒸发后达到饱和。此情况的定义性约束是，最终水汽混合比恰好是最终温度下的饱和值：\n$$q_v' = q_{vs}(T', p)$$\n控制最终状态 $(T', q_v', q_c')$ 的方程组是：\n1.  $q_v' + q_c' = q_t$\n2.  $c_{pd}T' + L_v q_v' = h$\n3.  $q_v' = q_{vs}(T', p) = \\epsilon \\frac{e_s(T')}{p - e_s(T')}$, with $e_s(T') = e_{s0}\\exp\\left[\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T'}\\right)\\right]$\n\n为了求解最终温度 $T'$，我们可以将其简化为单个非线性方程。根据焓守恒方程(2)，我们将 $q_v'$ 表示为 $T'$ 的函数：\n$$q_v' =  q_v + \\frac{c_{pd}}{L_v}(T-T')$$\n将其与饱和约束(3)相等，我们得到一个关于未知最终温度 $T'$ 的单个非线性方程：\n$$q_v + \\frac{c_{pd}}{L_v}(T-T') = q_{vs}(T', p)$$\n这是一个必须求解 $T'$ 的超越方程。一旦求得 $T'$，就可以根据饱和约束计算出 $q_v'$，并根据总水守恒计算出 $q_c' = q_t - q_v'$。\n\n### 第二部分：数值解\n\n我们给定的初始状态和常数如下：\n-   $T = 283 \\text{ K}$\n-   $p = 9.0000 \\times 10^{4} \\text{ Pa}$\n-   $q_v = 0.0120$\n-   $q_c = 0$\n-   $c_{pd} = 1004 \\text{ J kg}^{-1}\\text{ K}^{-1}$\n-   $L_v = 2.500 \\times 10^{6} \\text{ J kg}^{-1}$\n-   $R_v = 461 \\text{ J kg}^{-1}\\text{K}^{-1}$\n-   $\\epsilon = 0.622$\n-   $e_{s0} = 611.2 \\text{ Pa}$\n-   $T_0 = 273.15 \\text{ K}$\n\n首先，我们必须确定初始状态是否过饱和。我们计算初始温度 $T = 283 \\text{ K}$ 下的饱和水汽压 $e_s$。\n克劳修斯-克拉佩龙方程中的指数项为：\n$$\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right) = \\frac{2.500 \\times 10^{6}}{461}\\left(\\frac{1}{273.15} - \\frac{1}{283}\\right) \\approx 5422.993 \\times (0.003660955 - 0.003533569) \\approx 0.69095$$\n因此，饱和水汽压为：\n$$e_s(283 \\text{ K}) = 611.2 \\text{ Pa} \\times \\exp(0.69095) \\approx 611.2 \\text{ Pa} \\times 1.9956 \\approx 1220.0 \\text{ Pa}$$\n接下来，我们计算在此温度和给定气压 $p = 9.0000 \\times 10^4 \\text{ Pa}$ 下的饱和水汽混合比 $q_{vs}$。\n$$q_{vs}(283 \\text{ K}, 90000 \\text{ Pa}) = \\epsilon \\frac{e_s(T)}{p - e_s(T)} \\approx 0.622 \\times \\frac{1220.0}{90000 - 1220.0} \\approx 0.622 \\times \\frac{1220.0}{88780} \\approx 0.008547$$\n将初始水汽混合比 $q_v = 0.0120$ 与饱和值 $q_{vs} \\approx 0.00855$ 进行比较，我们发现 $q_v  q_{vs}$。气块是过饱和的。\n\n由于气块是过饱和的，将会发生凝结，最终状态必须是饱和的（情况2）。我们必须求解关于 $T'$ 的非线性方程：\n$$f(T') = q_v + \\frac{c_{pd}}{L_v}(T - T') - q_{vs}(T', p) = 0$$\n代入给定值：\n$$f(T') = 0.0120 + \\frac{1004}{2.500 \\times 10^{6}}(283 - T') - q_{vs}(T', 9.0000 \\times 10^4) = 0$$\n$$f(T') = 0.0120 + 4.016 \\times 10^{-4}(283 - T') - 0.622 \\frac{e_s(T')}{9.0000 \\times 10^4 - e_s(T')} = 0$$\n这个方程必须通过数值方法求解 $T'$。我们预期 $T'  T = 283 \\text{ K}$，因为凝结会释放潜热。我们可以寻找 $f(T')$ 的根。\n\n我们测试 $T' = 286.2 \\text{ K}$：\n$e_s(286.2 \\text{ K}) = 611.2 \\exp\\left[5422.99\\left(\\frac{1}{273.15} - \\frac{1}{286.2}\\right)\\right] \\approx 1510.4 \\text{ Pa}$\n$q_{vs}(286.2 \\text{ K}) \\approx 0.622 \\frac{1510.4}{90000 - 1510.4} \\approx 0.010616$\n$f(286.2) \\approx 0.0120 + 4.016 \\times 10^{-4}(283 - 286.2) - 0.010616$\n$f(286.2) \\approx 0.0120 - 0.001285 - 0.010616 = +0.000099$\n\n我们测试 $T' = 286.3 \\text{ K}$：\n$e_s(286.3 \\text{ K}) = 611.2 \\exp\\left[5422.99\\left(\\frac{1}{273.15} - \\frac{1}{286.3}\\right)\\right] \\approx 1520.4 \\text{ Pa}$\n$q_{vs}(286.3 \\text{ K}) \\approx 0.622 \\frac{1520.4}{90000 - 1520.4} \\approx 0.010688$\n$f(286.3) \\approx 0.0120 + 4.016 \\times 10^{-4}(283 - 286.3) - 0.010688$\n$f(286.3) \\approx 0.0120 - 0.001325 - 0.010688 = -0.000013$\n\n由于 $f(286.2)  0$ 且 $f(286.3)  0$，根 $T'$ 位于 $286.2 \\text{ K}$ 和 $286.3 \\text{ K}$ 之间。线性插值表明根更接近 $286.3 \\text{ K}$。更精确的计算得出 $T' \\approx 286.288 \\text{ K}$。\n\n问题要求将答案四舍五入到四位有效数字。\n$$T' \\approx 286.288 \\text{ K} \\rightarrow 286.3 \\text{ K}$$",
            "answer": "$$\\boxed{286.3}$$"
        },
        {
            "introduction": "将物理定律转化为稳定而精确的计算机代码充满了数值挑战，尤其是在处理相变这类快速过程时。这些过程通常会导致数值上的“刚性”问题，难以用简单方法求解。本练习将通过对比求解饱和调整过程的显式和隐式两种时间积分方案，让您亲身体验和量化不同数值方法在计算精度和稳定性上的差异，这代表了大气建模中一个根本性的权衡。",
            "id": "3867741",
            "problem": "考虑一个暖云宏观物理方案中的单箱饱和度调整子步骤，其中水汽混合比和云液水混合比通过凝结和蒸发交换质量，温度因潜热而变化。您将比较一个大时间步长下的显式前向欧拉更新和隐式后向欧拉更新。此比较将量化最终温度和水汽混合比的差异。\n\n假设相变源项采用以下基于物理的闭合方案。设 $q_v$ 为水汽混合比（单位：$\\mathrm{kg\\,kg^{-1}}$），$q_l$ 为云液水混合比（单位：$\\mathrm{kg\\,kg^{-1}}$），$T$ 为空气温度（单位：$\\mathrm{K}$），$p$ 为气压（单位：$\\mathrm{Pa}$）。弛豫源项 $s$（单位：$\\mathrm{kg\\,kg^{-1}\\,s^{-1}}$）定义为\n$$\ns = \\frac{q_v - q_{vs}(T,p)}{\\tau},\n$$\n其中 $\\tau$ 是指定的弛豫时间尺度（单位：$\\mathrm{s}$），$q_{vs}(T,p)$ 是在温度 $T$ 和气压 $p$ 下液态水的饱和水汽混合比。由相变引起的质量和能量演变遵循\n$$\n\\frac{dq_v}{dt} = -s, \\quad \\frac{dq_l}{dt} = s, \\quad \\frac{dT}{dt} = \\frac{L_v}{c_p}\\,s,\n$$\n其中 $L_v$ 是蒸发潜热（单位：$\\mathrm{J\\,kg^{-1}}$），$c_p$ 是空气的定压比热（单位：$\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）。饱和混合比 $q_{vs}(T,p)$ 由饱和水汽压 $e_s(T)$ 的克劳修斯-克拉佩龙方程和湿空气混合比公式组合定义：\n$$\ne_s(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right), \\qquad q_{vs}(T,p) = \\frac{\\epsilon\\, e_s(T)}{p - e_s(T)},\n$$\n其中常数 $e_0$ 是三相点处的饱和水汽压（单位：$\\mathrm{Pa}$），$T_0$ 是三相点温度（单位：$\\mathrm{K}$），$R_v$ 是水汽的比气体常数（单位：$\\mathrm{J\\,kg^{-1}\\,K^{-1}}$），$\\epsilon = R_d/R_v$ 是干空气与水汽的比气体常数之比，其中 $R_d$ 是干空气的比气体常数（单位：$\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）。\n\n您必须为给定的时间步长 $\\Delta t$ 实现两种离散时间更新：\n\n- 显式前向欧拉：在时间步开始时，使用 $q_v^n$ 和 $T^n$ 计算 $s$，然后应用 $q_v^{n+1} = q_v^n - s^n \\Delta t$，$q_l^{n+1} = q_l^n + s^n \\Delta t$，$T^{n+1} = T^n + (L_v/c_p) s^n \\Delta t$。\n\n- 隐式后向欧拉：使用时间步结束时的值，通过 $s^{n+1} = \\big(q_v^{n+1} - q_{vs}(T^{n+1},p)\\big)/\\tau$ 计算 $s$，然后应用 $q_v^{n+1} = q_v^n - s^{n+1}\\Delta t$，$q_l^{n+1} = q_l^n + s^{n+1}\\Delta t$，$T^{n+1} = T^n + (L_v/c_p) s^{n+1}\\Delta t$。这需要求解一个由 $q_{vs}$ 的温度依赖性产生的关于 $s^{n+1}$ 的非线性方程。\n\n两种更新都必须通过限制相变率 $s$ 来强制执行物理约束 $q_v^{n+1} \\ge 0$ 和 $q_l^{n+1} \\ge 0$，使得 $-q_l^n/\\Delta t \\le s \\le q_v^n/\\Delta t$。对于隐式后向欧拉方法，将此限制应用于求解出的 $s^{n+1}$。\n\n使用的常数是 $L_v = 2.5\\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$e_0 = 611.2\\,\\mathrm{Pa}$，$T_0 = 273.15\\,\\mathrm{K}$，以及 $\\epsilon = R_d/R_v$。\n\n您的程序必须为每个测试用例计算显式和隐式更新，并返回最终温度和水汽混合比的绝对差值，即 $\\Delta T = |T_{\\mathrm{imp}}^{n+1} - T_{\\mathrm{exp}}^{n+1}}|$（单位：$\\mathrm{K}$）和 $\\Delta q_v = |q_{v,\\mathrm{imp}}^{n+1} - q_{v,\\mathrm{exp}}^{n+1}}|$（单位：$\\mathrm{kg\\,kg^{-1}}$）。\n\n以指定单位表示最终差异，每个测试用例的结果格式化为列表 $[\\Delta T, \\Delta q_v]$。\n\n测试套件。对于每个用例，使用给定的因子 $f$ 将初始水汽混合比设置为 $q_v^n = f \\cdot q_{vs}(T^n,p)$。\n\n- 用例A（过饱和，无云水，大步长）：$p = 90000\\,\\mathrm{Pa}$，$T^n = 285\\,\\mathrm{K}$，$f = 1.2$，$q_l^n = 0.0\\,\\mathrm{kg\\,kg^{-1}}$，$\\Delta t = 600\\,\\mathrm{s}$，$\\tau = 50\\,\\mathrm{s}$。\n\n- 用例B（接近饱和，无云水）：$p = 100000\\,\\mathrm{Pa}$，$T^n = 300\\,\\mathrm{K}$，$f = 1.0$，$q_l^n = 0.0\\,\\mathrm{kg\\,kg^{-1}}$，$\\Delta t = 600\\,\\mathrm{s}$，$\\tau = 50\\,\\mathrm{s}$。\n\n- 用例C（次饱和，有可用云水）：$p = 80000\\,\\mathrm{Pa}$，$T^n = 270\\,\\mathrm{K}$，$f = 0.8$，$q_l^n = 1.0\\times 10^{-4}\\,\\mathrm{kg\\,kg^{-1}}$，$\\Delta t = 600\\,\\mathrm{s}$，$\\tau = 50\\,\\mathrm{s}$。\n\n- 用例D（强过饱和，非常大的步长）：$p = 95000\\,\\mathrm{Pa}$，$T^n = 260\\,\\mathrm{K}$，$f = 1.5$，$q_l^n = 0.0\\,\\mathrm{kg\\,kg^{-1}}$，$\\Delta t = 1200\\,\\mathrm{s}$，$\\tau = 30\\,\\mathrm{s}$。\n\n- 用例E（次饱和，无云水，蒸发受限）：$p = 100000\\,\\mathrm{Pa}$，$T^n = 290\\,\\mathrm{K}$，$f = 0.8$，$q_l^n = 0.0\\,\\mathrm{kg\\,kg^{-1}}$，$\\Delta t = 600\\,\\mathrm{s}$，$\\tau = 50\\,\\mathrm{s}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果\n$[\\,[\\Delta T_A,\\Delta q_{v,A}],\\,[\\Delta T_B,\\Delta q_{v,B}],\\,[\\Delta T_C,\\Delta q_{v,C}],\\,[\\Delta T_D,\\Delta q_{v,D}],\\,[\\Delta T_E,\\Delta q_{v,E}]\\,]$。",
            "solution": "该问题要求比较两种数值时间步进方案——显式前向欧拉法和隐式后向欧拉法，并将它们应用于云中水汽和液态水之间相变的简化模型。这个过程被称为饱和度调整，是大气模型中宏观物理参数化的一个基本组成部分。我们将求解单个时间步长 $\\Delta t$ 后的最终温度 $T$ 和水汽混合比 $q_v$，并量化两种方案之间的差异。\n\n系统的演变由一组耦合的常微分方程（ODEs）描述。设 $q_v$ 为水汽混合比，$q_l$ 为云液水混合比，$T$ 为温度。它们因凝结或蒸发引起的变化率由以下公式给出：\n$$\n\\frac{dq_v}{dt} = -s, \\quad \\frac{dq_l}{dt} = s, \\quad \\frac{dT}{dt} = \\frac{L_v}{c_p}\\,s\n$$\n其中 $L_v$ 是蒸发潜热，$c_p$ 是空气的定压比热。源项 $s$ 表示从水汽到液态水的质量转移率，并通过向饱和状态的弛豫来定义：\n$$\ns = \\frac{q_v - q_{vs}(T,p)}{\\tau}\n$$\n这里，$\\tau$ 是弛豫时间尺度，$p$ 是大气压力，$q_{vs}(T,p)$ 是饱和水汽混合比。函数 $q_{vs}(T,p)$ 源自饱和水汽压 $e_s(T)$ 的克劳修斯-克拉佩龙方程和混合比的定义：\n$$\ne_s(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right), \\qquad q_{vs}(T,p) = \\frac{\\epsilon\\, e_s(T)}{p - e_s(T)}\n$$\n常数包括：$e_0$，三相点温度 $T_0$ 处的饱和水汽压；$R_v$，水汽的比气体常数；以及 $\\epsilon = R_d/R_v$，干空气（$R_d$）和水汽的气体常数之比。\n\n物理真实性要求混合比保持非负。这对一个时间步长 $\\Delta t$ 内的总相变量施加了约束。可以凝结的水汽总量受限于初始水汽量 $q_v^n$。可以蒸发的液态水总量受限于初始液态水量 $q_l^n$。这些约束转化为对相变率 $s$ 的界限：\n$$\n- \\frac{q_l^n}{\\Delta t} \\le s \\le \\frac{q_v^n}{\\Delta t}\n$$\n其中正的 $s$ 表示凝结，负的 $s$ 表示蒸发。\n\n设系统在时间步 $n$ 的状态为 $(q_v^n, q_l^n, T^n)$。我们的任务是使用两种不同的方法找到时间步 $n+1$ 的状态。\n\n显式前向欧拉方案：\n在该方案中，变化率 $s$ 是使用时间步 $n$ 开始时的状态来评估的。\n$$\ns^n = \\frac{q_v^n - q_{vs}(T^n,p)}{\\tau}\n$$\n非负性的物理约束通过限制此速率来强制执行。让我们将未约束的速率表示为 $s^n_{raw}$。有效速率 $s^n$ 是：\n$$\ns^n = \\max\\left(-\\frac{q_l^n}{\\Delta t}, \\min\\left(\\frac{q_v^n}{\\Delta t}, s^n_{raw}\\right)\\right)\n$$\n然后通过一个前向步长计算时间 $n+1$ 的新状态：\n$$\nq_v^{n+1} = q_v^n - s^n \\Delta t \\\\\nq_l^{n+1} = q_l^n + s^n \\Delta t \\\\\nT^{n+1} = T^n + \\frac{L_v}{c_p} s^n \\Delta t\n$$\n此方法计算简单，但对于大的时间步长可能会数值不稳定，特别是当 $\\Delta t  \\tau$ 时。\n\n隐式后向欧拉方案：\n该方案使用时间步 $n+1$ 结束时的未知状态来评估变化率 $s$。更新方程为：\n$$\nq_v^{n+1} = q_v^n - s^{n+1} \\Delta t \\\\\nq_l^{n+1} = q_l^n + s^{n+1} \\Delta t \\\\\nT^{n+1} = T^n + \\frac{L_v}{c_p} s^{n+1} \\Delta t\n$$\n其中 $s^{n+1}$ 是基于 $n+1$ 时的状态定义的：\n$$\ns^{n+1} = \\frac{q_v^{n+1} - q_{vs}(T^{n+1},p)}{\\tau}\n$$\n为了求解 $s^{n+1}$，我们将 $q_v^{n+1}$ 和 $T^{n+1}$ 的表达式代入 $s^{n+1}$ 的定义中：\n$$\ns^{n+1} = \\frac{(q_v^n - s^{n+1} \\Delta t) - q_{vs}(T^n + \\frac{L_v}{c_p}s^{n+1}\\Delta t, p)}{\\tau}\n$$\n重新整理后，得到一个关于未知数 $s^{n+1}$ 的非线性代数方程。我们寻求函数 $F(s^{n+1})$ 的根：\n$$\nF(s^{n+1}) = s^{n+1}(\\tau + \\Delta t) - q_v^n + q_{vs}\\left(T^n + \\frac{L_v}{c_p}s^{n+1}\\Delta t, p\\right) = 0\n$$\n必须求解该方程以得到 $s^{n+1}_{raw}$。函数 $F(x)$ 相对于其参数 $x$ 是单调递增的，因为 $\\tau  0$, $\\Delta t  0$，并且 $q_{vs}(T,p)$ 是 $T$ 的单调递增函数。这保证了唯一根的存在。我们可以使用标准的数值算法来找到这个根，例如 Brent-Dekker 方法（`brentq`），该方法稳健且高效。根的搜索范围可以被物理限制 $[-q_l^n/\\Delta t, q_v^n/\\Delta t]$ 所界定。\n一旦找到未约束的速率 $s^{n+1}_{raw}$，就根据问题规范对其进行裁剪：\n$$\ns^{n+1} = \\max\\left(-\\frac{q_l^n}{\\Delta t}, \\min\\left(\\frac{q_v^n}{\\Delta t}, s^{n+1}_{raw}\\right)\\right)\n$$\n然后使用裁剪后的 $s^{n+1}$ 和更新方程计算最终状态 $(q_v^{n+1}, q_l^{n+1}, T^{n+1})$。隐式方法即使对于大的时间步长也是数值稳定的。\n\n计算流程：\n对于每个测试用例，我们执行以下步骤：\n1.  设置物理常数：$L_v=2.5\\times 10^6$，$c_p=1004$，$R_v=461$，$R_d=287$，$e_0=611.2$，$T_0=273.15$，以及 $\\epsilon = R_d/R_v$。\n2.  设置用例的初始条件：$p, T^n, f, q_l^n, \\Delta t, \\tau$。\n3.  计算初始水汽混合比 $q_v^n = f \\cdot q_{vs}(T^n, p)$。\n4.  执行显式前向欧拉方案以找到 $(T_{\\mathrm{exp}}^{n+1}, q_{v,\\mathrm{exp}}^{n+1})$。\n5.  执行隐式后向欧拉方案，包括非线性求根步骤，以找到 $(T_{\\mathrm{imp}}^{n+1}, q_{v,\\mathrm{imp}}^{n+1})$。\n6.  计算绝对差值：$\\Delta T = |T_{\\mathrm{imp}}^{n+1} - T_{\\mathrm{exp}}^{n+1}}|$ 和 $\\Delta q_v = |q_{v,\\mathrm{imp}}^{n+1} - q_{v,\\mathrm{exp}}^{n+1}}|$。\n7.  收集所有测试用例的结果，并按指定格式进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the cloud microphysics problem by comparing explicit and implicit\n    Euler methods for a set of test cases.\n    \"\"\"\n    \n    # Define physical constants\n    CONSTANTS = {\n        'Lv': 2.5e6,     # J/kg\n        'cp': 1004.0,    # J/(kg K)\n        'Rv': 461.0,     # J/(kg K)\n        'Rd': 287.0,     # J/(kg K)\n        'e0': 611.2,     # Pa\n        'T0': 273.15,    # K\n    }\n    CONSTANTS['epsilon'] = CONSTANTS['Rd'] / CONSTANTS['Rv']\n\n    def e_s(T, consts):\n        \"\"\"Saturation vapor pressure over liquid water (Pa).\"\"\"\n        Lv, Rv, T0, e0 = consts['Lv'], consts['Rv'], consts['T0'], consts['e0']\n        return e0 * np.exp((Lv / Rv) * (1/T0 - 1/T))\n\n    def q_vs(T, p, consts):\n        \"\"\"Saturation mixing ratio (kg/kg).\"\"\"\n        epsilon = consts['epsilon']\n        es_T = e_s(T, consts)\n        # Ensure denominator is positive, which is physically required\n        if p = es_T:\n            return np.inf  # Or handle as an error, practically p >> es_T\n        return (epsilon * es_T) / (p - es_T)\n\n    def solve_explicit(qv_n, ql_n, T_n, p, dt, tau, consts):\n        \"\"\"\n        Computes one step of the explicit forward Euler scheme.\n        \"\"\"\n        # Calculate source term at time n\n        qvs_n = q_vs(T_n, p, consts)\n        s_raw = (qv_n - qvs_n) / tau\n        \n        # Apply physical limits\n        s_max = qv_n / dt\n        s_min = -ql_n / dt\n        s_n = np.clip(s_raw, s_min, s_max)\n        \n        # Update state variables\n        qv_np1 = qv_n - s_n * dt\n        T_np1 = T_n + (consts['Lv'] / consts['cp']) * s_n * dt\n        \n        return T_np1, qv_np1\n\n    def solve_implicit(qv_n, ql_n, T_n, p, dt, tau, consts):\n        \"\"\"\n        Computes one step of the implicit backward Euler scheme.\n        \"\"\"\n        Lv, cp = consts['Lv'], consts['cp']\n\n        def residual(s, qv_n_arg, T_n_arg, p_arg, dt_arg, tau_arg):\n            T_np1 = T_n_arg + (Lv / cp) * s * dt_arg\n            qvs_np1 = q_vs(T_np1, p_arg, consts)\n            return s * (tau_arg + dt_arg) - qv_n_arg + qvs_np1\n\n        # Physical limits for s as bounds for the solver\n        s_max = qv_n / dt\n        s_min = -ql_n / dt\n\n        # If s_min and s_max are very close, the root is essentially determined.\n        if np.isclose(s_min, s_max):\n            s_raw = s_min\n        else:\n            # Check if the root is outside the bracket by checking the sign at the boundaries\n            f_min = residual(s_min, qv_n, T_n, p, dt, tau)\n            f_max = residual(s_max, qv_n, T_n, p, dt, tau)\n            if f_min * f_max > 0:\n                # The function is monotonic, so if signs are the same,\n                # the root is outside the bracket. We saturate s.\n                if np.abs(f_min)  np.abs(f_max):\n                    s_raw = s_min\n                else:\n                    s_raw = s_max\n            else:\n                sol = root_scalar(residual, args=(qv_n, T_n, p, dt, tau),\n                                  bracket=[s_min, s_max], method='brentq')\n                s_raw = sol.root\n\n        # Apply limits to the solved s, as per problem statement\n        s_np1 = np.clip(s_raw, s_min, s_max)\n        \n        # Update state variables\n        qv_np1 = qv_n - s_np1 * dt\n        T_np1 = T_n + (Lv / cp) * s_np1 * dt\n        \n        return T_np1, qv_np1\n        \n    test_cases = [\n        # p (Pa), T_n (K), f, ql_n (kg/kg), dt (s), tau (s)\n        (90000, 285, 1.2, 0.0, 600, 50),        # Case A\n        (100000, 300, 1.0, 0.0, 600, 50),       # Case B\n        (80000, 270, 0.8, 1.0e-4, 600, 50),     # Case C\n        (95000, 260, 1.5, 0.0, 1200, 30),      # Case D\n        (100000, 290, 0.8, 0.0, 600, 50),       # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        p_val, T_n, f, ql_n, dt, tau = case\n        \n        # Initial vapor mixing ratio\n        qv_n = f * q_vs(T_n, p_val, CONSTANTS)\n        \n        # Explicit solver\n        T_exp, qv_exp = solve_explicit(qv_n, ql_n, T_n, p_val, dt, tau, CONSTANTS)\n        \n        # Implicit solver\n        T_imp, qv_imp = solve_implicit(qv_n, ql_n, T_n, p_val, dt, tau, CONSTANTS)\n        \n        # Calculate differences\n        delta_T = abs(T_imp - T_exp)\n        delta_qv = abs(qv_imp - qv_exp)\n        \n        results.append(f\"[{delta_T},{delta_qv}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}