{
    "hands_on_practices": [
        {
            "introduction": "The primitive equations in their full form are notoriously complex. A powerful method for simplifying them is scale analysis, which uses characteristic scales of motion to identify the dominant physical balances. This first exercise guides you through calculating the fundamental non-dimensional parameters—the Rossby number $Ro$, Froude number $Fr$, and aspect ratio $\\epsilon$—for a typical large-scale planetary flow, providing a quantitative basis for the geostrophic and hydrostatic approximations that are foundational to geophysical fluid dynamics. ",
            "id": "3925160",
            "problem": "Consider the rotating, stratified primitive equations under the Boussinesq approximation (density variations are neglected except where they multiply gravitational acceleration) and the anelastic approximation (fast acoustic waves are filtered by enforcing a divergence constraint on a reference-density-weighted velocity). These equations describe large-scale atmospheric and oceanic motions subject to Earth’s rotation via the Coriolis term and gravity via buoyancy. By non-dimensionalizing the governing equations using characteristic horizontal velocity scale $U$, horizontal length scale $L$, vertical length scale $H$, Coriolis parameter $f$, and gravitational acceleration $g$, one obtains a set of canonical non-dimensional parameters that measure the relative importance of terms: a rotational parameter (Rossby number), a gravitational-wave parameter (Froude number), and an aspect ratio that encodes the thinness of the fluid layer.\n\nUsing characteristic planetary midlatitude values $U \\sim 10\\,\\mathrm{m\\,s^{-1}}$, $L \\sim 10^{6}\\,\\mathrm{m}$, $H \\sim 10^{4}\\,\\mathrm{m}$, $f \\sim 10^{-4}\\,\\mathrm{s^{-1}}$, and taking $g=9.81\\,\\mathrm{m\\,s^{-2}}$, do the following:\n- Starting from the rotating Boussinesq primitive equations and dimensional reasoning, identify the three leading non-dimensional parameters that distinguish rotational, gravitational, and geometric effects. Then, using the values above, compute their numerical values.\n- Based on your results, reason from first principles whether the hydrostatic balance (vertical pressure gradient balancing buoyancy) and the geostrophic balance (Coriolis force balancing horizontal pressure gradient) are appropriate leading-order approximations for these planetary scales.\n\nExpress your final numerical results as a single row vector in the order $\\left(Ro, Fr, \\epsilon\\right)$, where $Ro$ is the Rossby number, $Fr$ is the shallow-water Froude number, and $\\epsilon$ is the aspect ratio. Round each entry to three significant figures. The entries are dimensionless and should be reported without units.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent. It provides all necessary information to identify and compute the required non-dimensional parameters and to assess the validity of the geostrophic and hydrostatic approximations for the specified physical scales. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe problem asks for the identification and calculation of three key non-dimensional parameters governing large-scale planetary flows, and an assessment of two fundamental dynamical balances based on these parameters. The analysis starts from the primitive equations under the Boussinesq approximation.\n\nFirst, we identify the three non-dimensional parameters through dimensional analysis of the governing forces and geometry. The characteristic scales are given as horizontal velocity $U$, horizontal length $L$, vertical length $H$, Coriolis parameter $f$, and gravitational acceleration $g$.\n\nThe Rossby Number ($Ro$):\nThe Rossby number measures the ratio of inertial forces to the Coriolis force. The horizontal momentum equation in the rotating frame is, ignoring friction:\n$$ \\frac{D\\mathbf{u}_h}{Dt} = - f \\mathbf{k} \\times \\mathbf{u}_h - \\frac{1}{\\rho_0} \\nabla_h p $$\nwhere $\\mathbf{u}_h$ is the horizontal velocity vector, $\\mathbf{k}$ is the unit vector in the vertical direction, and $p$ is the pressure. The material derivative is $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$. The inertial acceleration term, $\\frac{D\\mathbf{u}_h}{Dt}$, is dominated by the advective part $\\mathbf{u}_h \\cdot \\nabla_h \\mathbf{u}_h$, which scales as $\\frac{U^2}{L}$. The Coriolis acceleration term, $f \\mathbf{k} \\times \\mathbf{u}_h$, scales as $fU$.\nThe ratio of these two terms defines the Rossby number:\n$$ Ro = \\frac{|\\text{Inertial Force}|}{|\\text{Coriolis Force}|} \\sim \\frac{U^2/L}{fU} = \\frac{U}{fL} $$\n\nThe Froude Number ($Fr$):\nThe Froude number compares the kinetic energy of the flow to the potential energy associated with gravity waves. For a fluid of depth $H$, the speed of long, or shallow-water, external gravity waves is $c = \\sqrt{gH}$. The Froude number is the ratio of the characteristic flow speed $U$ to this wave speed. The problem specifies the \"shallow-water Froude number\" in the output format, confirming this definition.\n$$ Fr = \\frac{U}{c} = \\frac{U}{\\sqrt{gH}} $$\nThis parameter is often seen in its squared form, $Fr^2 = U^2/(gH)$, which represents the ratio of kinetic energy to potential energy.\n\nThe Aspect Ratio ($\\epsilon$):\nThis parameter is a purely geometric ratio that describes the thinness of the fluid domain. It is defined as the ratio of the characteristic vertical length scale $H$ to the characteristic horizontal length scale $L$.\n$$ \\epsilon = \\frac{H}{L} $$\n\nNext, we compute the numerical values of these parameters using the provided characteristic scales for planetary midlatitude motions:\n$U = 10\\,\\mathrm{m\\,s^{-1}}$\n$L = 10^6\\,\\mathrm{m}$\n$H = 10^4\\,\\mathrm{m}$\n$f = 10^{-4}\\,\\mathrm{s^{-1}}$\n$g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n\nCalculation of the Rossby number:\n$$ Ro = \\frac{10\\,\\mathrm{m\\,s^{-1}}}{(10^{-4}\\,\\mathrm{s^{-1}}) \\times (10^6\\,\\mathrm{m})} = \\frac{10}{10^2} = 0.1 $$\n\nCalculation of the Froude number:\nThe gravity wave speed is $c = \\sqrt{gH} = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}}) \\times (10^4\\,\\mathrm{m})} = \\sqrt{98100}\\,\\mathrm{m\\,s^{-1}} \\approx 313.209\\,\\mathrm{m\\,s^{-1}}$.\n$$ Fr = \\frac{10\\,\\mathrm{m\\,s^{-1}}}{313.209\\,\\mathrm{m\\,s^{-1}}} \\approx 0.031927... $$\n\nCalculation of the aspect ratio:\n$$ \\epsilon = \\frac{10^4\\,\\mathrm{m}}{10^6\\,\\mathrm{m}} = 10^{-2} = 0.01 $$\n\nRounding these values to three significant figures, we get:\n$Ro = 0.100$\n$Fr \\approx 0.0319$\n$\\epsilon = 0.0100$\n\nFinally, we assess the validity of the geostrophic and hydrostatic balances.\n\nGeostrophic Balance:\nGeostrophic balance is the leading-order balance in the horizontal momentum equation between the Coriolis force and the horizontal pressure gradient force ($f \\mathbf{k} \\times \\mathbf{u}_h \\approx -\\frac{1}{\\rho_0} \\nabla_h p$). This balance holds when the inertial forces are much smaller than the Coriolis force. The Rossby number, $Ro$, precisely quantifies this ratio. Our calculated value is $Ro = 0.100$. Since $Ro \\ll 1$, the inertial terms are an order of magnitude smaller than the Coriolis and pressure gradient terms. Therefore, geostrophic balance is an appropriate and accurate leading-order approximation for describing large-scale planetary flows at these scales.\n\nHydrostatic Balance:\nHydrostatic balance is the leading-order balance in the vertical momentum equation between the vertical pressure gradient force and gravity ($\\frac{\\partial p}{\\partial z} \\approx -\\rho g$). This approximation is valid when the vertical acceleration is negligible compared to the forces that dominate the vertical balance.\nThe primary reason for the validity of the hydrostatic approximation in large-scale atmospheric and oceanic flows is the small aspect ratio, $\\epsilon = H/L$. We calculated $\\epsilon = 0.0100$.\nA small aspect ratio implies that the geometry of the flow is a thin sheet. By the continuity equation for an incompressible or anelastic fluid ($\\nabla \\cdot \\mathbf{u} \\approx 0$), the scaling for vertical velocity $W$ is related to the horizontal velocity $U$ by $W \\sim U(H/L) = U\\epsilon$.\nThe vertical acceleration scales as $W/T \\sim W(U/L) \\sim (U\\epsilon)(U/L) = U^2\\epsilon/L = U^2 H /L^2$. The forces in the vertical balance (pressure gradient and gravity) are of order $g$. The ratio of vertical acceleration to gravity is $\\frac{U^2 H / L^2}{g} = \\frac{U^2}{gH} \\frac{H^2}{L^2} = Fr^2 \\epsilon^2$.\nWith our values, this ratio is approximately $(0.0319)^2 \\times (0.01)^2 \\approx 10^{-3} \\times 10^{-4} = 10^{-7}$, which is exceptionally small.\nMore directly, looking at the non-dimensional vertical momentum equation reveals that the vertical acceleration term is scaled by a factor of $\\epsilon^2 = (0.01)^2 = 10^{-4}$ relative to the main balancing terms (pressure gradient and gravity). Since $\\epsilon^2 \\ll 1$, the vertical acceleration is dynamically insignificant. Thus, hydrostatic balance is an extremely accurate approximation for these planetary scales.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.100 & 0.0319 & 0.0100 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the validity of large-scale balances established, we can explore how specific approximations shape key physical phenomena like stratification. The Brunt–Väisälä frequency, $N^2$, quantifies the atmosphere's and ocean's resistance to vertical motion and sets the frequency for internal waves. This practice provides a direct comparison of how $N^2$ is formulated under the anelastic and Boussinesq approximations, offering insight into the different behaviors of internal waves in the two fluid systems. ",
            "id": "3925142",
            "problem": "Consider two stably stratified geophysical fluids described by the hydrostatic primitive equations under the appropriate density treatments. In the atmosphere, assume the anelastic approximation (density variations retained in buoyancy but filtered from sound waves), while in the ocean, assume the Boussinesq approximation (constant reference density except in buoyancy).\n\nAtmospheric case (anelastic, hydrostatic): A dry troposphere has background potential temperature $\\Theta(z)$ that increases linearly with altitude $z$, where $z$ is measured upward from the surface. The profile is $\\Theta(z) = \\Theta_{0} + \\Gamma_{\\theta} z$ with $\\Theta_{0} = 300 \\ \\mathrm{K}$ and $\\Gamma_{\\theta} = 3 \\ \\mathrm{K \\ km^{-1}}$. Gravity is constant with $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$. Assume large-scale motions satisfying hydrostatic balance and small-amplitude perturbations about this background.\n\nOceanic case (Boussinesq, hydrostatic): An upper-ocean pycnocline has density decreasing linearly with height $z$ (which is measured upward, with $z=0$ at the mean sea surface). Between depths $z=-200 \\ \\mathrm{m}$ and $z=-100 \\ \\mathrm{m}$, the potential density decreases from $1024 \\ \\mathrm{kg \\ m^{-3}}$ to $1022 \\ \\mathrm{kg \\ m^{-3}}$ in a linear manner with $z$. Use a constant reference density $\\rho_{0} = 1025 \\ \\mathrm{kg \\ m^{-3}}$ and the same gravity $g$.\n\nTasks:\n1. Starting from the hydrostatic primitive equations and fundamental definitions appropriate to each approximation, derive the expression for the squared Brunt–Väisälä frequency $N^{2}$ for each case (atmosphere: in terms of the potential temperature gradient; ocean: in terms of the background density gradient).\n2. Evaluate the resulting $N^{2}$ for the tropospheric profile and for the ocean pycnocline. Express each $N^{2}$ in $\\mathrm{s^{-2}}$.\n3. Using your computed values, determine the dimensionless ratio $R = N^{2}_{\\mathrm{ocean}} / N^{2}_{\\mathrm{trop}}$. Express your final answer for $R$ as a single real number and round it to four significant figures.\n\nIn your solution, also discuss how the magnitude of $N^{2}$ influences the internal mode structure (vertical eigenfunctions and frequencies) in the hydrostatic primitive equations under the anelastic approximation (atmosphere) versus under the Boussinesq approximation (ocean), highlighting any differences in the weighting of vertical modes due to the respective density treatments. The discussion is not part of the final numerical answer.",
            "solution": "The problem asks for the derivation and evaluation of the squared Brunt–Väisälä frequency, $N^2$, for a specified atmospheric and oceanic case, the calculation of their ratio, and a discussion on the implications for internal wave modes.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of geophysical fluid dynamics (hydrostatic balance, Boussinesq and anelastic approximations, static stability). The provided data is self-consistent and sufficient for a unique solution. The problem is therefore deemed valid and a solution will be provided.\n\n### Part 1: Derivation of the Brunt–Väisälä Frequency ($N^2$)\n\nThe squared Brunt–Väisälä frequency, $N^2$, represents the square of the natural frequency of vertical oscillation for a fluid parcel displaced adiabatically from its equilibrium position in a statically stable, stratified fluid. The general derivation starts from considering the vertical acceleration of such a parcel. The net vertical force per unit volume on the parcel is the buoyancy force, given by $-g(\\rho_p - \\rho_e)$, where $g$ is the acceleration due to gravity, $\\rho_p$ is the parcel's density, and $\\rho_e$ is the density of the surrounding environment.\n\nFor a small vertical displacement $\\delta z$, the equation of motion is:\n$$ \\rho_p \\frac{d^2(\\delta z)}{dt^2} = -g(\\rho_p - \\rho_e(z+\\delta z)) $$\nBy linearizing and applying the appropriate thermodynamic constraints for each fluid system, we can derive the expression for $N^2$.\n\n**A. Atmospheric Case (Anelastic, Hydrostatic)**\n\nIn the anelastic approximation for a dry atmosphere, density variations are important for buoyancy but are filtered from acoustic effects. The state of a fluid parcel is best described by its potential temperature, $\\Theta$, which is conserved during adiabatic displacements.\n\nLet the background state be characterized by a potential temperature profile $\\Theta(z)$. A parcel at equilibrium at height $z$ has potential temperature $\\Theta(z)$. If this parcel is displaced vertically by a small distance $\\delta z$ to a new height $z + \\delta z$, its potential temperature remains $\\Theta(z)$. The surrounding environment at this new height has a potential temperature of $\\Theta(z + \\delta z) \\approx \\Theta(z) + \\frac{d\\Theta}{dz}\\delta z$.\n\nThe buoyancy force in the anelastic system is proportional to the potential temperature difference. The vertical acceleration $a = d^2(\\delta z)/dt^2$ is given by:\n$$ a = g \\frac{\\Theta_{\\text{parcel}} - \\Theta_{\\text{env}}}{\\Theta_{\\text{ref}}} $$\nHere, $\\Theta_{\\text{parcel}} = \\Theta(z)$ and $\\Theta_{\\text{env}} = \\Theta(z + \\delta z)$. $\\Theta_{\\text{ref}}$ is a constant reference potential temperature. Thus,\n$$ a = g \\frac{\\Theta(z) - \\left(\\Theta(z) + \\frac{d\\Theta}{dz}\\delta z\\right)}{\\Theta_{\\text{ref}}} = - \\left(\\frac{g}{\\Theta_{\\text{ref}}} \\frac{d\\Theta}{dz}\\right) \\delta z $$\nThis is the equation for simple harmonic motion, $\\frac{d^2(\\delta z)}{dt^2} = -N^2 \\delta z$. By comparison, the squared Brunt–Väisälä frequency for the atmosphere is:\n$$ N^2 = \\frac{g}{\\Theta_{\\text{ref}}} \\frac{d\\Theta}{dz} $$\nFor the given problem, the reference potential temperature is $\\Theta_{0}$, and the gradient is $\\Gamma_{\\theta}$.\n$$ N^2_{\\mathrm{trop}} = \\frac{g}{\\Theta_{0}} \\frac{d\\Theta}{dz} $$\n\n**B. Oceanic Case (Boussinesq, Hydrostatic)**\n\nIn the Boussinesq approximation, the density $\\rho$ is treated as a constant reference value $\\rho_0$ in the momentum equation, except in the buoyancy term where its variations are critical. For analyzing stability, we use potential density, which is conserved for a parcel moving adiabatically. The problem refers to this as \"potential density,\" which we will denote as $\\rho(z)$.\n\nConsider a parcel at equilibrium at height $z$ with potential density $\\rho(z)$. When displaced to $z + \\delta z$, it retains this density. The environment at $z + \\delta z$ has a density of $\\rho(z + \\delta z) \\approx \\rho(z) + \\frac{d\\rho}{dz}\\delta z$.\n\nThe buoyancy force per unit mass on the parcel is $-g(\\rho_{\\text{parcel}} - \\rho_{\\text{env}})/\\rho_0$. The equation of motion is:\n$$ \\frac{d^2(\\delta z)}{dt^2} = -g \\frac{\\rho(z) - \\left(\\rho(z) + \\frac{d\\rho}{dz}\\delta z\\right)}{\\rho_0} = -g \\frac{-\\frac{d\\rho}{dz}\\delta z}{\\rho_0} = \\left(\\frac{g}{\\rho_0} \\frac{d\\rho}{dz}\\right) \\delta z $$\nFor a stable stratification, density must decrease with height, so $d\\rho/dz < 0$. This gives rise to a restoring force. The equation is of the form $\\frac{d^2(\\delta z)}{dt^2} = -N^2 \\delta z$. By comparison, the squared Brunt–Väisälä frequency for the ocean is:\n$$ N^2_{\\mathrm{ocean}} = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz} $$\n\n\n### Part 2: Evaluation of $N^2$\n\n**A. Atmospheric Case**\n\nGiven data:\n- $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$\n- $\\Theta(z) = \\Theta_{0} + \\Gamma_{\\theta} z$\n- $\\Theta_{0} = 300 \\ \\mathrm{K}$\n- $\\Gamma_{\\theta} = 3 \\ \\mathrm{K \\ km^{-1}}$\n\nFirst, we convert the units of $\\Gamma_{\\theta}$:\n$$ \\Gamma_{\\theta} = 3 \\ \\mathrm{K \\ km^{-1}} = 3 \\ \\frac{\\mathrm{K}}{1000 \\ \\mathrm{m}} = 0.003 \\ \\mathrm{K \\ m^{-1}} $$\nThe gradient of potential temperature is constant: $\\frac{d\\Theta}{dz} = \\Gamma_{\\theta} = 0.003 \\ \\mathrm{K \\ m^{-1}}$.\n\nUsing the derived formula with $\\Theta_{\\text{ref}} = \\Theta_0$:\n$$ N^2_{\\mathrm{trop}} = \\frac{g}{\\Theta_0} \\frac{d\\Theta}{dz} = \\frac{9.81 \\ \\mathrm{m \\ s^{-2}}}{300 \\ \\mathrm{K}} \\times 0.003 \\ \\mathrm{K \\ m^{-1}} $$\n$$ N^2_{\\mathrm{trop}} = \\frac{9.81 \\times 0.003}{300} \\ \\mathrm{s^{-2}} = \\frac{0.02943}{300} \\ \\mathrm{s^{-2}} = 9.81 \\times 10^{-5} \\ \\mathrm{s^{-2}} $$\n\n**B. Oceanic Case**\n\nGiven data:\n- $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$\n- $\\rho_0 = 1025 \\ \\mathrm{kg \\ m^{-3}}$\n- At $z_1 = -200 \\ \\mathrm{m}$, $\\rho_1 = 1024 \\ \\mathrm{kg \\ m^{-3}}$\n- At $z_2 = -100 \\ \\mathrm{m}$, $\\rho_2 = 1022 \\ \\mathrm{kg \\ m^{-3}}$\n\nThe density profile is linear, so the gradient $\\frac{d\\rho}{dz}$ is constant:\n$$ \\frac{d\\rho}{dz} = \\frac{\\rho_2 - \\rho_1}{z_2 - z_1} = \\frac{1022 \\ \\mathrm{kg \\ m^{-3}} - 1024 \\ \\mathrm{kg \\ m^{-3}}}{-100 \\ \\mathrm{m} - (-200 \\ \\mathrm{m})} = \\frac{-2 \\ \\mathrm{kg \\ m^{-3}}}{100 \\ \\mathrm{m}} = -0.02 \\ \\mathrm{kg \\ m^{-4}} $$\nThis negative gradient confirms that the pycnocline is stably stratified.\n\nUsing the derived formula:\n$$ N^2_{\\mathrm{ocean}} = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz} = -\\frac{9.81 \\ \\mathrm{m \\ s^{-2}}}{1025 \\ \\mathrm{kg \\ m^{-3}}} \\times (-0.02 \\ \\mathrm{kg \\ m^{-4}}) $$\n$$ N^2_{\\mathrm{ocean}} = \\frac{9.81 \\times 0.02}{1025} \\ \\mathrm{s^{-2}} = \\frac{0.1962}{1025} \\ \\mathrm{s^{-2}} \\approx 1.914146 \\times 10^{-4} \\ \\mathrm{s^{-2}} $$\n\n### Part 3: Dimensionless Ratio $R$\n\nThe dimensionless ratio $R$ is defined as $R = N^{2}_{\\mathrm{ocean}} / N^{2}_{\\mathrm{trop}}$.\n$$ R = \\frac{1.914146 \\times 10^{-4} \\ \\mathrm{s^{-2}}}{9.81 \\times 10^{-5} \\ \\mathrm{s^{-2}}} $$\nAlternatively, we can compute the ratio symbolically before substituting values:\n$$ R = \\frac{-\\frac{g}{\\rho_0} \\frac{d\\rho}{dz}}{\\frac{g}{\\Theta_0} \\frac{d\\Theta}{dz}} = \\frac{-\\frac{d\\rho}{dz}/\\rho_0}{\\frac{d\\Theta}{dz}/\\Theta_0} = \\frac{-(-0.02 \\ \\mathrm{kg \\ m^{-4}}) / (1025 \\ \\mathrm{kg \\ m^{-3}})}{(0.003 \\ \\mathrm{K \\ m^{-1}}) / (300 \\ \\mathrm{K})} $$\n$$ R = \\frac{0.02 / 1025}{0.003 / 300} = \\frac{0.02}{1025} \\times \\frac{300}{0.003} = \\frac{2 \\times 10^{-2}}{1025} \\times \\frac{3 \\times 10^2}{3 \\times 10^{-3}} = \\frac{2 \\times 10^{-2}}{1025} \\times 10^5 = \\frac{2000}{1025} $$\n$$ R = \\frac{80}{41} \\approx 1.9512195... $$\nRounding to four significant figures, we get $R = 1.951$.\n\n### Part 4: Discussion on Internal Mode Structure\n\nThe magnitude of the Brunt-Väisälä frequency $N^2$ is central to the dynamics of internal gravity waves. The vertical structure of these waves is typically governed by a second-order ordinary differential equation, which takes different forms under the anelastic and Boussinesq approximations.\n\nIn both systems, $N(z)$ defines the local upper frequency limit for freely propagating internal waves, meaning wave frequencies $\\omega$ must satisfy $\\omega^2 \\leq N^2(z)$. Our calculation shows that for the given profiles, $N^2_{\\mathrm{ocean}} > N^2_{\\mathrm{trop}}$, implying the oceanic pycnocline supports higher-frequency internal waves than the specified tropospheric layer. For a given horizontal wavenumber, a larger $N^2$ also leads to a larger vertical wavenumber, corresponding to a shorter vertical wavelength.\n\nThe more fundamental difference in the internal mode structure arises from the treatment of the background density, $\\rho_0(z)$.\n\n**Boussinesq Approximation (Ocean):** The density $\\rho_0$ is treated as constant. For a constant $N$, the vertical structure equation for vertical velocity $w$ is $\\frac{d^2 w}{dz^2} + k_z^2 w = 0$, where $k_z^2 = k_h^2(N^2 - \\omega^2)/\\omega^2$. The solutions (eigenfunctions) are simple sinusoids, e.g., $w(z) = W_m \\sin(m\\pi z/H)$ for a domain of height $H$. The amplitude of vertical velocity and displacement is uniform with height for a given mode. This approximation is valid when the vertical scale of motion is much smaller than the density scale height, a condition often met in the ocean.\n\n**Anelastic Approximation (Atmosphere):** The background density $\\rho_0(z)$ varies significantly with height, typically decreasing exponentially, $\\rho_0(z) \\approx \\rho_{0s}\\exp(-z/H_{\\rho})$, where $H_{\\rho}$ is the density scale height (approx. $8$ km). The governing vertical structure equation is more complex and is often written for a density-weighted variable, such as $\\psi = \\sqrt{\\rho_0(z)} w$. This transforms the equation into a Schrödinger-like form: $\\frac{d^2 \\psi}{dz^2} + \\left[ \\frac{N^2(z)}{c^2} - \\frac{1}{4H_{\\rho}^2} \\right] \\psi = 0$ (for vertical propagation, where $c$ is the horizontal phase speed).\n\nThe key implication of the $\\sqrt{\\rho_0(z)}$ weighting is that for the eigenfunctions $\\psi(z)$ to remain bounded, the physical vertical velocity $w(z) = \\psi(z)/\\sqrt{\\rho_0(z)}$ must grow with height as $\\exp(z/2H_{\\rho})$. This means that atmospheric internal waves have velocity and displacement amplitudes that are significantly larger at higher altitudes where density is lower. This amplication ensures that the wave kinetic energy density, $\\frac{1}{2}\\rho_0(z) w^2 = \\frac{1}{2}\\psi^2$, does not grow unboundedly. In contrast, under the Boussinesq approximation, the vertical structure of kinetic energy density $\\frac{1}{2}\\rho_0 w^2$ is identical to that of $w^2$. This fundamental difference in the weighting of vertical modes means that atmospheric waves tend to have their largest expression and transport effects at high altitudes, while oceanic internal waves are less vertically skewed in their amplitude structure.",
            "answer": "$$\n\\boxed{1.951}\n$$"
        },
        {
            "introduction": "Beyond simplifying the underlying physics, a key motivation for using approximations like the anelastic formulation is to enhance computational performance in numerical models. This final practice bridges theory and application by examining the Courant–Friedrichs–Lewy (CFL) stability condition. By quantifying the maximum allowable time step for both a fully compressible model and an anelastic model, you will gain a tangible understanding of the profound computational advantages afforded by filtering acoustically fast waves. ",
            "id": "3925119",
            "problem": "Consider a horizontally homogeneous atmospheric column modeled by the three-dimensional primitive equations. Two formulations are examined: a fully compressible formulation and an anelastic formulation. In the compressible formulation, small-amplitude disturbances support acoustic waves with speed $c$, whereas in the anelastic formulation, acoustic waves are filtered and the remaining fastest characteristics are non-acoustic. Assume a uniform Cartesian grid with horizontal grid spacing $\\Delta x$, and an explicit time-stepping method whose stability is controlled by the Courant–Friedrichs–Lewy (CFL) condition.\n\nStarting from the conservation of mass and momentum laws for a compressible fluid linearized about a state of rest with uniform background density, derive the characteristic wave speeds of the linearized system relevant to horizontal propagation. Use these to establish the form of the CFL time-step limitation in each formulation. In the anelastic formulation, justify which physical process sets the dominant explicit time-step constraint in the absence of acoustic waves, and adopt a physically reasonable, constant advective speed $U$ for that process.\n\nThen, using the following parameter values:\n- Speed of sound $c = 340\\,\\mathrm{m\\,s^{-1}}$,\n- Horizontal grid spacing $\\Delta x = 10\\,\\mathrm{km}$,\n- Maximum advective speed $U = 20\\,\\mathrm{m\\,s^{-1}}$,\n- Maximum allowable Courant number $C_{\\max} = 0.80$,\n\ncompute the maximum explicit time step for:\n1. the compressible formulation limited by acoustic waves, and\n2. the anelastic formulation limited by advection.\n\nExpress both final time steps in seconds and round each to four significant figures. Your final answer must be reported as a single row matrix containing the two values in the order listed above.",
            "solution": "The stability of explicit time-stepping schemes for hyperbolic partial differential equations is governed by the Courant–Friedrichs–Lewy (CFL) condition. This condition states that the numerical domain of dependence must contain the physical domain of dependence. For a one-dimensional problem on a grid with spacing $\\Delta x$ and a time step $\\Delta t$, the CFL condition takes the form:\n$$ C = \\frac{u_{\\max} \\Delta t}{\\Delta x} \\leq C_{\\max} $$\nwhere $u_{\\max}$ is the magnitude of the fastest characteristic wave speed in the system, and $C_{\\max}$ is the maximum allowable Courant number, which is a constant of order unity that depends on the specific numerical scheme. From this, the maximum stable time step is given by:\n$$ \\Delta t_{\\max} = C_{\\max} \\frac{\\Delta x}{u_{\\max}} $$\nThis problem requires us to determine $\\Delta t_{\\max}$ for two different formulations of the atmospheric equations: a fully compressible system and an anelastic system.\n\nFirst, we analyze the compressible formulation. The problem states that this formulation supports acoustic waves. To determine the characteristic speed, we examine the linearized governing equations for a compressible fluid. We consider one-dimensional horizontal propagation for simplicity, which is sufficient to determine the relevant speed. The conservation laws for mass and momentum, linearized about a state of rest (velocity $u=0$) with a uniform background density $\\rho_0$, are:\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0 \\quad \\text{(Continuity)} $$\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0 \\quad \\text{(Momentum)} $$\nHere, $\\rho'$, $u'$, and $p'$ represent small perturbations in density, velocity, and pressure, respectively. To close this system, we relate pressure and density perturbations. For acoustic phenomena, the compression and rarefaction are approximately isentropic. The relationship is thus $p' = c^2 \\rho'$, where $c = \\sqrt{(\\partial p / \\partial \\rho)_s}$ is the speed of sound.\nSubstituting $p' = c^2 \\rho'$ into the momentum equation gives:\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + c^2 \\frac{\\partial \\rho'}{\\partial x} = 0 $$\nWe can combine the continuity and modified momentum equations to find the wave equation. Differentiating the continuity equation with respect to $t$ and the modified momentum equation with respect to $x$ yields:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0 $$\n$$ \\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\nAssuming the perturbations are sufficiently smooth such that the order of differentiation can be interchanged, we can eliminate the term involving $u'$ to obtain:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} = c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} $$\nThis is the standard one-dimensional wave equation. It describes disturbances propagating at speeds of $\\pm c$. Therefore, in the fully compressible system, the fastest characteristic speed is the speed of sound, $u_{\\max} = c$.\nThe CFL time-step limitation for the compressible formulation is:\n$$ \\Delta t_{\\max, \\text{comp}} = C_{\\max} \\frac{\\Delta x}{c} $$\nUsing the given parameter values: $C_{\\max} = 0.80$, $\\Delta x = 10\\,\\mathrm{km} = 10 \\times 10^3\\,\\mathrm{m}$, and $c = 340\\,\\mathrm{m\\,s^{-1}}$.\n$$ \\Delta t_{\\max, \\text{comp}} = 0.80 \\times \\frac{10000\\,\\mathrm{m}}{340\\,\\mathrm{m\\,s^{-1}}} = \\frac{8000}{340}\\,\\mathrm{s} = \\frac{400}{17}\\,\\mathrm{s} \\approx 23.5294\\,\\mathrm{s} $$\nRounding to four significant figures, the maximum time step is $23.53\\,\\mathrm{s}$.\n\nNext, we analyze the anelastic formulation. The anelastic approximation is specifically designed to filter out acoustically fast waves to allow for a larger time step in numerical models. This is achieved by modifying the continuity equation to a form that no longer supports solutions corresponding to sound waves, typically $\\nabla \\cdot (\\rho_0 \\mathbf{v}) = 0$. As stated in the problem, with acoustic waves filtered, the fastest remaining characteristics are non-acoustic.\nIn the absence of sound waves, the next fastest phenomena that can transport information across the grid are other wave modes (like gravity waves) and the advection of the fluid itself. The problem directs us to consider the limit imposed by advection, for which a maximum speed $U$ is given. This is physically justified because the movement of fluid parcels carrying momentum, heat, or other properties constitutes a signal that must be resolved by the numerical scheme. The characteristic speed associated with advection is the fluid velocity itself. Thus, for the anelastic system, the fastest speed relevant to the CFL condition is the maximum advective speed, $u_{\\max} = U$.\nThe CFL time-step limitation for the anelastic formulation is:\n$$ \\Delta t_{\\max, \\text{anel}} = C_{\\max} \\frac{\\Delta x}{U} $$\nUsing the given parameter values: $C_{\\max} = 0.80$, $\\Delta x = 10 \\times 10^3\\,\\mathrm{m}$, and $U = 20\\,\\mathrm{m\\,s^{-1}}$.\n$$ \\Delta t_{\\max, \\text{anel}} = 0.80 \\times \\frac{10000\\,\\mathrm{m}}{20\\,\\mathrm{m\\,s^{-1}}} = 0.80 \\times 500\\,\\mathrm{s} = 400\\,\\mathrm{s} $$\nTo express this value to four significant figures, we write it as $400.0\\,\\mathrm{s}$.\n\nComparing the two results, the time step for the compressible model ($23.53\\,\\mathrm{s}$) is much more restrictive than for the anelastic model ($400.0\\,\\mathrm{s}$), which highlights the computational advantage of filtering sound waves when they are not meteorologically significant.\n\nThe computed values are:\n1.  For the compressible formulation: $\\Delta t_{\\max, \\text{comp}} \\approx 23.53\\,\\mathrm{s}$.\n2.  For the anelastic formulation: $\\Delta t_{\\max, \\text{anel}} = 400.0\\,\\mathrm{s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n23.53 & 400.0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}