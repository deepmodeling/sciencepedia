## 引言
对流是地球大气中至关重要的能量和物质垂直输送过程，深刻影响着天气和气候。然而，由于其尺度远小于[全球气候模型](@entry_id:1125665)和天气预报模型的网格尺度，对流过程无法被直接解析，必须通过“[参数化](@entry_id:265163)”方案来近似表示。如何准确地[参数化](@entry_id:265163)对流，特别是其中复杂的夹卷（环境空气混入）与夹出（云内空气流出）过程，是现代大气科学面临的核心挑战之一。这些次网格过程的微小不确定性，可能导致对降水、风暴强度和大规模环流（如MJO）的模拟出现巨大偏差。

本文旨在系统性地阐述干[湿对流参数化](@entry_id:1128093)的理论基础与实践应用。在“原理与机制”一章中，我们将建立描述对流羽流的物理和数学框架。接着，在“应用与跨学科联系”一章中，我们将探讨这些理论如何在数值模型中应用，如何解释关键大气现象，以及如何利用观测数据进行检验。最后，在“动手实践”一章中，你将通过一系列编程练习，将理论知识转化为实际的建模能力。这三章内容层层递进，旨在帮助读者从基本原理出发，全面掌握对流[参数化](@entry_id:265163)的核心思想及其在环境与地球[系统建模](@entry_id:197208)中的关键作用。

## 原理与机制

在上一章引言的基础上，本章将深入探讨对流[参数化](@entry_id:265163)的核心物理原理与数学机制。我们将从描述湿空气运动的基本[热力学](@entry_id:172368)量开始，建立描述对流羽流的质量通量模型，并详细研究夹卷和夹出过程的物理机制。随后，我们将分析这些过程如何深刻影响对流的[浮力](@entry_id:154088)、能量以及最终的强度。最后，我们将讨论如何在一个更大的模型框架中确定对流的整体强度（即所谓的“对流闭合”问题），以及在数值实现中遇到的挑战。

### [热力学](@entry_id:172368)基础：湿空气中的守恒变量

为了在数值模型中准确追踪经历剧烈垂直运动、压力变化和相态转换的空气块，我们必须识别在此过程中近似守恒的[热力学变量](@entry_id:160587)。这些[守恒量](@entry_id:161475)是构建和理解对流[参数化](@entry_id:265163)方案的基石。

#### 干位温

对于一个不含水汽的干空气块，在绝热（即与环境没有热量交换）的压缩或膨胀过程中，其**干位温**（**dry potential temperature**），记为 $\theta$，是一个[守恒量](@entry_id:161475)。$\theta$ 被定义为将空气块绝热地移动到某个参考压力 $p_0$（通常为 $1000$ hPa）时所具有的温度。其数学表达式为：
$$
\theta = T\left(\frac{p_0}{p}\right)^{\kappa}
$$
其中 $T$ 是空气块的[绝对温度](@entry_id:144687)，$p$ 是其当前压力，$\kappa = R_d/c_{p_d}$ 是一个常数，由干空气气体常数 $R_d$ 和干空气定压比热 $c_{p_d}$ 决定。在没有发生相变、[辐射加热](@entry_id:754016)或与环境混合的情况下，空气块的[物质导数](@entry_id:262900) $D\theta/Dt = 0$。然而，一旦有水汽凝结释放潜热，这个过程对于干空气来说就是非绝热的，$\theta$ 将不再守恒。

#### [虚位温](@entry_id:1133825)

湿空气的密度小于同温同压下的干空气，因为水汽的分子量（约 $18$ g/mol）小于干空气的[平均分子量](@entry_id:199884)（约 $29$ g/mol）。为了方便地使用适用于干空气的[状态方程](@entry_id:274378)，我们引入了**虚温**（**virtual temperature**）$T_v$ 的概念，它是一个假想的温度，在此温度下干空气的密度与湿空气的密度相等。对于包含水汽（[混合比](@entry_id:1127970)为 $q_v$）和液态水凝结物（[混合比](@entry_id:1127970)为 $q_l$）的空气，虚温可以近似为：
$$
T_v \approx T(1 + 0.61 q_v - q_l)
$$
$0.61q_v$ 项反映了水汽的增浮效应，而 $-q_l$ 项则代表了液态水凝结物的重量带来的拖曳（减浮）效应。

相应地，**[虚位温](@entry_id:1133825)**（**virtual potential temperature**）$\theta_v$ 被定义为：
$$
\theta_v \equiv \theta \left( \frac{T_v}{T} \right) \approx \theta(1 + 0.61 q_v - q_l)
$$
$\theta_v$ 直接与空气密度相关，因此它是计算[浮力](@entry_id:154088)的核心变量。一个气块的 $\theta_v$ 高于其环境，意味着它的密度低于环境，从而会受到向上的[浮力](@entry_id:154088)。然而，$\theta_v$ 的守恒性非常有限。只有在干绝热且没有混合的过程中（即 $q_v$ 和 $q_l$ 保持不变），$\theta_v$ 才守恒。在饱和的上升气流中，随着水汽凝结，$q_v$ 减少而 $q_l$ 增加，导致 $\theta_v$ 发生变化，因此它不是一个在湿过程中守恒的量。

#### 湿静力能

为了找到一个在湿[绝热过程](@entry_id:138150)中（即允许水汽凝结和蒸发）也能守恒的变量，我们必须同时考虑显热、潜热和位能。**[湿静力能](@entry_id:1128097)**（**moist static energy**），记为 $h$，正是为此而构建的。其定义为：
$$
h = c_p T + gz + L_v q_v
$$
这里，$c_p T$ 代表单位质量空气的显热焓，$gz$ 是其重力位能（$g$ 为[重力加速度](@entry_id:173411)，$z$ 为高度），$L_v q_v$ 则是其所含水汽的潜热能（$L_v$ 为蒸发潜热）。在没有辐射、摩擦和与环境混合的情况下，湿静力能的[物质导数](@entry_id:262900) $Dh/Dt = 0$。这是因为当水汽凝结时（$q_v$ 减少），释放的潜热会增加显热（$T$ 增加），这两项变化在 $h$ 的表达式中恰好相互补偿。因此，$h$ 是追踪[湿对流](@entry_id:1128092)过程的理想守恒变量。

当对流过程延伸到冰点以上，冰相过程变得重要时，我们可以进一步扩展这个概念。通过引入**冰相[湿静力能](@entry_id:1128097)**（**ice-aware moist static energy**）$h_i$：
$$
h_i = c_p T + gz + L_v q_v - L_f q_i
$$
其中 $L_f$ 是融化潜热，$q_i$ 是冰的[混合比](@entry_id:1127970)。负号项 $-L_f q_i$ 代表了储存在冰相中的“负潜热”（相对于液态水）。这个变量的巧妙之处在于，当液水冻结成冰时（$q_i$ 增加），释放的融化潜热使温度 $T$ 升高，而 $h_i$ 的表达式恰好可以补偿这一变化，使其在绝热的冻结/融化过程中保持守恒。相比之下，传统的[湿静力能](@entry_id:1128097) $h_m$ 在冻结事件中会因潜热释放而发生不连续的跃增。因此，在包含冰相过程的模型中，使用 $h_i$ 能够极大地改善能量的守恒性。

### 体块[羽流模型](@entry_id:1129836)：质量与标量收支

对流[参数化](@entry_id:265163)的一个核心思想是将次网格的对流活动简化为一个或多个上升的**羽流**（**plumes**），这些羽流与其周围的“环境”空气进行质量和能量的交换。这种简化模型被称为体块[羽流模型](@entry_id:1129836)。

在这种框架下，我们定义几个关键的物理量。**对流质量通量**（**convective mass flux**）$M(z)$ 是指在高度 $z$ 处，单位时间内通过单位水平总面积的对流上升气流的质量。它可以表示为 $M(z) = \rho(z) a(z) w_u(z)$，其中 $\rho$ 是空气密度，$a(z)$ 是上升气流所占的水平[面积分](@entry_id:275394)数，$w_u(z)$ 是上升气流的平均垂直速度。

羽流在上升过程中并非一个孤立系统，它会不断地与周围环境空气发生相互作用。我们将从环境流入羽流的过程称为**夹卷**（**entrainment**），其速率定义为 $e(z)$，表示单位高度、单位水平总面积上，单位时间内从环境混入羽流的质量。反之，从羽流流向环境的过程称为**夹出**（**detrainment**），其速率为 $d(z)$。

基于这些定义，我们可以为一个处于稳定状态的羽流建立基本的[守恒方程](@entry_id:1122898)。考虑一个厚度为 $dz$ 的薄水平层，对其应用[质量守恒定律](@entry_id:147377)：流入该层的质量等于流出该层的质量。流入的质量包括从下边界 $z$ 垂直输运的 $M(z)$ 和从侧向夹卷的 $e(z)dz$。流出的质量包括向上边界 $z+dz$ 垂直输运的 $M(z+dz)$ 和向侧向夹出的 $d(z)dz$。因此，我们得到：
$$
M(z) + e(z)dz = M(z+dz) + d(z)dz
$$
整理并取极限 $dz \to 0$，我们得到质量通量的**[连续性方程](@entry_id:195013)**：
$$
\frac{dM}{dz} = e - d
$$
这个方程表明，对流质量通量的垂直梯度由净夹卷率（夹卷减去夹出）决定。

同样地，我们可以为任意一个守恒标量 $\chi$（例如，在没有外部源汇时的[湿静力能](@entry_id:1128097) $h$）建立收支方程。流入薄层的 $\chi$ 总量为 $M(z)\chi_u(z) + e(z)\chi_e(z)dz$，其中 $\chi_u$ 和 $\chi_e$ 分别是羽流和环境中的标量值。流出的总量为 $M(z+dz)\chi_u(z+dz) + d(z)\chi_u(z)dz$。注意，夹卷进来的是环境空气，其属性为 $\chi_e$；而夹出去的是羽流自身的空气，其属性为 $\chi_u$。平衡后可得**标量[守恒方程](@entry_id:1122898)**：
$$
\frac{d(M\chi_u)}{dz} = e\chi_e - d\chi_u
$$
这两个方程构成了体块羽流[参数化](@entry_id:265163)方案的骨架，描述了对流羽流的质量和[热力学性质](@entry_id:146047)如何随高度演变。

### 夹卷与夹出的物理机制

要使体块[羽流模型](@entry_id:1129836)具有预测能力，我们必须为夹卷率 $e$ 和夹出率 $d$ 提供物理上合理的[参数化](@entry_id:265163)表达式。

#### 夹卷过程

夹卷主要是由羽流边界上的湍流混合驱动的。一个关键的参数是**分数夹卷率**（**fractional entrainment rate**）$\epsilon$，定义为夹卷率与质量通量之比，$\epsilon = e/M$。它的单位是逆长度（如 $\mathrm{m}^{-1}$），可以理解为羽流每上升一个单位高度，其质量增加的分数。

根据经典的 Morton-Taylor-Turner [湍流](@entry_id:151300)夹卷假说，羽流边界上的平均法向卷入速度 $v_e$ 与羽流自身的平均垂直速度 $w$ 成正比，即 $v_e = \kappa w$，其中 $\kappa$ 是一个无量纲的夹卷系数。对于一个半径为 $r$ 的[轴对称](@entry_id:1130776)“高帽”形（即内部属性均匀）羽流，其质量通量为 $M = \rho w (\pi r^2)$，而单位高度的夹卷质量为 $e = \rho v_e (2\pi r) = \rho (\kappa w) (2\pi r)$。将这两者代入分数夹卷率的定义，我们得到一个非常重要的关系：
$$
\epsilon = \frac{e}{M} = \frac{\rho (\kappa w) (2\pi r)}{\rho w (\pi r^2)} = \frac{2\kappa}{r}
$$
这个结果表明，分数夹卷率与羽流半径成反比。这意味着，**更宽的羽流受夹卷的影响相对更小**。这与我们的直觉相符：一个细长的羽流有更大的周长-面积比，因此更容易被环境空气稀释。

#### 夹出过程

夹出过程，即羽流物质向环境的流出，主要由两种机制驱动：

1.  **热力夹出**（**Thermal Detrainment**）：当羽流由于与环境的混合而丧失其正[浮力](@entry_id:154088)（即 $B(z)  0$）时，其上升动力减弱，羽流中的空气块倾向于在与其密度相当的高度上水平流出，回归到环境中。因此，热力夹出应只在羽流为负[浮力](@entry_id:154088)时发生，且其强度与负[浮力](@entry_id:154088)的大小成正比。

2.  **机械夹出**（**Mechanical Detrainment**）：当环境存在强的垂直风切变（$S(z) = \partial U / \partial z$）时，切变会在羽流边界上产生[湍流](@entry_id:151300)，如同“剥皮”一样将羽流物质剥离并卷入环境中。

基于[量纲分析](@entry_id:140259)和物理推理，我们可以构建夹出率的[参数化](@entry_id:265163)形式。例如，总夹出率 $d(z)$ 可以表示为热力项和机械项之和。一个合理的表达式可能是：
$$
d(z) = c_{\mathrm{th}} M(z) \frac{\max(-B(z), 0)}{w(z)^2} + c_{\mathrm{m}} M(z) \frac{S(z)}{w(z)}
$$
这里，$c_{\mathrm{th}}$ 和 $c_{\mathrm{m}}$ 是无量纲系数。热力项中的 $\max(-B, 0)$ 确保了它只在负[浮力](@entry_id:154088)时启动，而分母 $w^2$ 来自于将一个基于时间的衰减率转换为基于高度的速率。机械项与风切变 $S(z)$ 成正比，与垂直速度 $w(z)$ 成反比，因为更快的上升速度意味着羽流在单位高度内暴露于切变的时间更短。

### 夹卷对对流性质的影响

夹卷过程通过将较冷、较干的环境空气混入温暖、湿润的羽流中，系统性地削弱了对流的强度。这种效应体现在多个方面。

#### [浮力](@entry_id:154088)稀释

[浮力](@entry_id:154088)是驱动对流的根本动力，通常由羽流和环境之间的[虚位温](@entry_id:1133825)差 $\Delta\theta_v(z) = \theta_{v,u}(z) - \theta_{v,e}(z)$ 决定。根据 Boussinesq 近似，[浮力](@entry_id:154088) $b(z)$ 可以表示为：
$$
b(z) = g \frac{\theta_{v,u}(z) - \theta_{v,e}(z)}{\theta_{v,e}(z)} = g \frac{\Delta\theta_v(z)}{\theta_{v,e}(z)}
$$
对于一个分数夹卷率为 $\epsilon$ 的羽流，其 $\theta_{v,u}$ 的垂直变化率可以由标量守恒方程导出。在一个稳定分层（即环境[虚位温](@entry_id:1133825)随高度增加，$\frac{d\theta_{v,e}}{dz} = \Gamma  0$）的环境中，$\Delta\theta_v(z)$ 满足如下的[一阶线性常微分方程](@entry_id:164502)：
$$
\frac{d\Delta\theta_v}{dz} = -\epsilon \Delta\theta_v - \Gamma
$$
该方程的解表明，$\Delta\theta_v(z)$ 会随高度指数衰减。与一个不发生夹卷的绝热气块相比（其 $\Delta\theta_v$ 随高度线性下降），**夹卷导致羽流的[浮力](@entry_id:154088)更快地被消耗**。在夹卷率极高的情况下（$\epsilon \to \infty$），羽流的[浮力](@entry_id:154088)几乎会瞬间被稀释为零，从而抑制对流的发展。

#### 对流能量的改变

[浮力](@entry_id:154088)的垂[直积](@entry_id:143046)分代表了对流所能做的功。夹卷对[浮力](@entry_id:154088)的稀释效应，会直接影响到两个关键的对流能量诊断量：对流有效位能（CAPE）和对流抑制能（CIN）。

- **CAPE 的削弱**：**对流有效位能**（**Convective Available Potential Energy, CAPE**）定义为从[自由对流](@entry_id:197869)高度（LFC）到[中性浮力](@entry_id:271501)高度（LNB）之间正[浮力](@entry_id:154088)的垂[直积](@entry_id:143046)分，$\mathrm{CAPE} = \int_{z_{\mathrm{LFC}}}^{z_{\mathrm{LNB}}} b(z) dz$。它代表了气块能够获得的最大动能。由于夹卷减小了整个积分路径上的[浮力](@entry_id:154088) $b(z)$，夹卷羽流的实际 CAPE 远小于未稀[释气](@entry_id:753025)块的理论 CAPE。可以推导出，夹卷羽流的 CAPE 与未稀释[浮力](@entry_id:154088)廓线 $b_0(z)$ 的关系为：
  $$
  \mathrm{CAPE}(\epsilon) = \exp(-\epsilon z_{\mathrm{LNB}}) \int_{z_{\mathrm{LFC}}}^{z_{\mathrm{LNB}}} b_0(z') \exp(\epsilon z') dz'
  $$
  这个表达式量化了夹卷对 CAPE 的侵蚀作用。

- **对流触发条件的提高**：夹卷不仅削弱已经发生的对流，也使得对流的触发更加困难。**对流抑制能**（**Convective Inhibition, CIN**）是启动对流需要克服的能量障碍，为从初始高度到 LFC 之间的负[浮力](@entry_id:154088)积分。在云下层，夹卷会混合进更干的环境空气，一方面降低了抬升凝结高度（LCL），但更重要的是，它稀释了边界层内由地表加热和加湿产生的正[浮力](@entry_id:154088)，从而可能增加 CIN。更进一步，要在一个考虑夹卷的真实大气中触发并维持[深对流](@entry_id:1123472)，通常需要比理论计算更强的初始扰动。例如，为了在某个目标高度 $z_t$ 达到一个足以克服各种阻力的最小[浮力](@entry_id:154088) $b_*$，所需的近地表湿度异常 $\Delta q_{s, \mathrm{crit}}$ 会因夹卷而显著增加。其临界值与夹卷率 $\epsilon$ 和对流深度 $z_t - z_b$ 呈指数关系，即 $\Delta q_{s, \mathrm{crit}} \propto \exp(\epsilon(z_t - z_b))$。这意味着，**夹卷越强或对流需要发展的越高，就越需要一个更湿润的边界层来启动对流**。 

### 对流闭合：确定对流强度

至此，我们已经构建了一个能够描述单个羽流性质如何随高度变化的物理模型。但是，这套模型本身并不能确定对流的整体强度，即云底质量通量 $M_b$ 的大小。为了关闭整个系统，我们需要引入一个额外的物理假设，即**对流闭合**（**convective closure**）。闭合方案的作用是根据大尺度、可解析的环流场特征，来诊断出次网格对流的强度 $M_b$。

目前，主要有几种不同类型的闭合方案：

1.  **CAPE 闭合**：这类方案假设对流活动的作用是消耗大气中的不稳定能量（CAPE）。因此，对流强度 $M_b$ 与 CAPE 的大小相关联。在一个典型实现中，对流被设定为在一个给定的“调整时间尺度” $\tau$ 内将 CAPE 松弛到零。CAPE 越大，所需的对流质量通量 $M_b$ 就越大。

2.  **水汽辐合闭合**：这类方案基于水汽收支的观点。它假设在一个足够长的时间尺度上，由大尺度环流向一个气柱内输送的水汽（水汽辐合）以及地表蒸发，必须通过对流产生的降水来平衡。因此，对流强度 $M_b$ 被设定为能够产生足以平衡大尺度水汽供应的降水量。

3.  **[准平衡闭合](@entry_id:1130432)**（**Quasi-Equilibrium Closure**）：这是由 Arakawa 和 Schubert 提出的一个更精巧的理论。它假设深对流的响应非常迅速，以至于它几乎能够瞬时消耗掉由大尺度过程（如抬升、辐射）产生的不稳定能量。因此，大气柱总是处于一种“[准平衡](@entry_id:1130431)”状态，即 CAPE 的生成率与消耗率几乎相等 ($\partial \mathrm{CAPE}/\partial t \approx 0$)。闭合问题就转化为：求解一个能产生恰好平衡大尺度 CAPE 生成率的对流消耗率的 $M_b$ 值。

在所有这些闭合方案中，夹卷和夹出的[参数化](@entry_id:265163)都扮演着至关重要的角色。它们决定了对于一个给定的云底质量通量 $M_b$，对流在消耗 CAPE、产生降水、垂直输送热量和水汽方面的*效率*。一个夹卷率高的对流，其消耗 CAPE 的效率就低，因此需要更大的 $M_b$ 才能达到与低夹卷率对流相同的环境效应。

### 数值实现与稳定性

在实际的大气环流模型（GCM）中，物理过程通常通过**算子分裂**（**operator splitting**）的方式进行积分。在一个物理时间步长 $\Delta t$ 内，模型会依次调用动力过程、边界层[湍流](@entry_id:151300)、云微物理和[湿对流](@entry_id:1128092)等不同模块。

一个严峻的挑战是，对流过程的时间尺度（例如，CAPE 的调整时间尺度 $\tau_c$）往往远小于模型的物理时间步长 $\Delta t$（例如 $\tau_c \sim 100$ s，而 $\Delta t \sim 300-1800$ s）。这种现象被称为**刚性**（**stiffness**）。如果对这种快速过程使用简单的显式时间积分方法（如前向欧拉法），就可能会引发[数值不稳定性](@entry_id:137058)。

以[前向欧拉法](@entry_id:141238)求解一个线性松弛过程 $\mathrm{d}y/\mathrm{d}t = -y/\tau$ 为例，其数值格式为 $y_{n+1} = y_n(1 - \delta t/\tau)$。为了保证数值解不发散，积分步长 $\delta t$ 必须满足稳定性条件 $\delta t \le 2\tau$。

当一个对流[参数化](@entry_id:265163)方案包含多个快速过程时（例如，一个与 CAPE 相关的调整过程和一个与夹卷相关的混合过程），为了维持稳定，积分步长必须小于所有过程中最快时间尺度的两倍。如果这个要求的步长远小于模型物理步长 $\Delta t$，就必须将对流模块在一个 $\Delta t$ 内进行多次**子步循环**（substepping）。例如，如果 $\Delta t = 300$ s，而最快的对流时间尺度是 $\tau_{fast} = 40$ s，那么为了稳定，子步长 $\delta t$ 需小于 $80$ s。这意味着每个物理时间步至少需要 $N = \lceil \Delta t / (2\tau_{fast}) \rceil = \lceil 300/80 \rceil = 4$ 次子步循环。这不仅增加了计算成本，也凸显了在多尺度气候模型中准确而高效地[参数化](@entry_id:265163)快速物理过程的挑战。