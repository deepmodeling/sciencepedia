{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的数值模型之前，培养对大气运动物理尺度的直观理解至关重要。尺度分析是地球物理流体动力学中的一项基本技能，它使我们能够从基本原理出发，估算物理量级的数量级。本练习将引导您应用尺度分析来处理地转平衡——即控制大尺度大气和海洋环流的压力梯度力与科里奥利力之间的核心平衡关系。通过这个“信封背面”式的计算，您将巩固对主导作用力的理解，并对天气尺度系统中的典型风速有一个切实的感受。",
            "id": "3883006",
            "problem": "在 $500\\,\\mathrm{hPa}$ 等压面上观测到一股中纬度天气尺度气流。在经向 $L = 500\\,\\mathrm{km}$ 的水平距离上，位势高度下降了 $\\Delta Z = 50\\,\\mathrm{m}$。科里奥利参数为 $f = 10^{-4}\\,\\mathrm{s^{-1}}$。假设流动处于静力平衡状态，摩擦力可忽略不计，且为稳定的大尺度运动，因此主导的水平动量平衡是科里奥利加速度与气压梯度力之间的平衡。仅使用这些基本平衡关系和量纲分析，推导出特征水平风速大小 $U$ 的一个尺度，并利用给定数据估算其数值。请用 $\\mathrm{m\\,s^{-1}}$ 单位表示最终答案，并四舍五入到两位有效数字。你的最终答案必须是一个数字。",
            "solution": "该问题要求通过考虑基本力平衡和使用量纲分析，为中纬度天气尺度气流推导出一个特征水平风速尺度 $U$。我们有以下已知信息：\n1. 气流位于 $500\\,\\mathrm{hPa}$ 等压面上。\n2. 运动是稳定的、大尺度的，且摩擦力可忽略不计。\n3. 主导的水平动量平衡是科里奥利加速度与气压梯度力之间的平衡。这一组假设定义了地转平衡。\n4. 在经向水平距离 $L = 500\\,\\mathrm{km}$ 上，位势高度 $Z$ 下降了 $\\Delta Z = 50\\,\\mathrm{m}$。\n5. 科里奥利参数为 $f = 10^{-4}\\,\\mathrm{s^{-1}}$。\n6. 气流处于静力平衡状态，这在使用等压面上的位势高度来表示气压梯度时是隐含的。\n\n对于旋转行星上稳定、无摩擦的流动，其水平动量方程即为地转平衡方程。在恒定气压（等压）面上，单位质量的气压梯度力（PGF）用位势 $\\Phi = gZ$ 的梯度表示，其中 $g$ 是重力加速度，$Z$ 是位势高度。单位质量的PGF为 $-\\nabla_p \\Phi = -g \\nabla_p Z$，其中 $\\nabla_p$ 是等压面上的水平梯度算子。\n\n地转平衡方程为：\n$$ -f v_g = -g \\frac{\\partial Z}{\\partial x} $$\n$$ f u_g = -g \\frac{\\partial Z}{\\partial y} $$\n其中 $u_g$ 和 $v_g$ 分别是地转风矢量 $\\vec{v}_g$ 的纬向（东西向）和经向（南北向）分量。\n\n问题要求的是水平风速大小的特征尺度，我们将其表示为 $U$。我们可以通过对地转平衡方程进行尺度分析来获得这个尺度。让我们考虑第二个方程 $f u_g = -g \\frac{\\partial Z}{\\partial y}$ 中各项的尺度。\n\n风速 $u_g$ 的特征尺度是 $U$。\n科里奥利参数 $f$ 本身就是一个尺度。\n因此，科里奥利项 $f u_g$ 的特征尺度是 $fU$。\n\n水平导数 $\\frac{\\partial Z}{\\partial y}$ 的特征尺度由位势高度在水平长度尺度 $L$ 上的变化量 $\\Delta Z$ 给出。因此，位势高度梯度的尺度是 $\\frac{\\Delta Z}{L}$。\n$g$ 项是重力加速度，一个常数。\n因此，气压梯度力项 $-g \\frac{\\partial Z}{\\partial y}$ 的特征尺度是 $g \\frac{\\Delta Z}{L}$。\n\n由于这两种力处于平衡状态，它们的特征尺度必须是同一数量级：\n$$ fU \\sim g \\frac{\\Delta Z}{L} $$\n\n从这个尺度关系中，我们可以推导出特征风速尺度 $U$ 的表达式：\n$$ U = \\frac{g}{f} \\frac{\\Delta Z}{L} $$\n该表达式根据给定的参数提供了地转风的特征大小。\n\n我们现在可以代入给定的数值来估算 $U$。\n给定的值为：\n- $L = 500\\,\\mathrm{km} = 500 \\times 10^3\\,\\mathrm{m} = 5 \\times 10^5\\,\\mathrm{m}$\n- $\\Delta Z = 50\\,\\mathrm{m}$\n- $f = 10^{-4}\\,\\mathrm{s^{-1}}$\n\n重力加速度 $g$ 没有明确给出，但它是将位势高度与气压梯度联系起来所需的一个基本常数。我们将使用标准值 $g \\approx 9.8\\,\\mathrm{m\\,s^{-2}}$。\n\n将这些值代入我们推导出的尺度定律中：\n$$ U = \\frac{9.8\\,\\mathrm{m\\,s^{-2}}}{10^{-4}\\,\\mathrm{s^{-1}}} \\frac{50\\,\\mathrm{m}}{5 \\times 10^5\\,\\mathrm{m}} $$\n首先，我们计算空间尺度的比率：\n$$ \\frac{\\Delta Z}{L} = \\frac{50\\,\\mathrm{m}}{5 \\times 10^5\\,\\mathrm{m}} = \\frac{5 \\times 10^1}{5 \\times 10^5} = 10^{-4} $$\n这个比率是无量纲的。\n\n现在，将此结果代回 $U$ 的表达式中：\n$$ U = \\frac{9.8\\,\\mathrm{m\\,s^{-2}}}{10^{-4}\\,\\mathrm{s^{-1}}} \\times 10^{-4} $$\n$$ U = 9.8\\,\\mathrm{m\\,s^{-1}} $$\n\n问题要求答案四舍五入到两位有效数字。我们计算出的值 $9.8\\,\\mathrm{m\\,s^{-1}}$ 已经有两位有效数字。因此，不需要进一步的四舍五入。特征水平风速大小为 $9.8\\,\\mathrm{m\\,s^{-1}}$。",
            "answer": "$$\\boxed{9.8}$$"
        },
        {
            "introduction": "地转风是一个近似概念，在建模和数据分析中明智地使用它，我们必须了解其适用范围和局限性。无量纲分析在此时就显得至关重要，它能帮助我们识别控制系统行为的关键参数。本练习将指导您推导出罗斯贝数（Rossby number, $Ro$），这是一个关键的无量纲参数，用于衡量惯性加速度与科里奥利加速度的相对重要性。通过计算$Ro$的量级，您可以判断一个流动是否接近地转平衡（$Ro \\ll 1$），或者是否需要考虑其他作用力（如向心力）。",
            "id": "4048767",
            "problem": "考虑在旋转、层结的地球上的中纬度天气尺度流动，在主导阶上近似为Boussinesq近似和静力平衡近似，且摩擦可忽略不计。在随地球旋转的参考系中，水平动量方程包含物质加速度和科里奥利加速度。使用特征水平速度尺度 $U$ 和特征水平长度尺度 $L$，对f平面上的水平动量方程进行无量纲化，其中科里奥利参数为 $f(\\phi)=2\\Omega \\sin\\phi$，$ \\phi$ 是纬度。根据尺度分析的基本原理，确定衡量天气尺度系统中惯性加速度（平流和向心）与科里奥利加速度之比的无量纲参数，并推导其对 $U$、$L$ 和 $f$ 的依赖关系。\n\n然后，对于一个典型的中纬度天气尺度系统，使用给定的特征值 $U=20\\,\\mathrm{m\\,s^{-1}}$ 和 $L=1000\\,\\mathrm{km}$，在纬度 $\\phi=45^\\circ$ 处，利用地球自转速率 $\\Omega=7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$，计算该参数的值。$\\phi$ 以度为单位。将您的数值答案四舍五入到四位有效数字，并将其表示为一个纯数（无量纲）。",
            "solution": "该问题要求从天气尺度流动的水平动量方程中推导出一个无量纲参数，并对其进行数值计算。验证过程确认该问题在科学上是合理的、适定的和客观的。\n\n在忽略摩擦并采用Boussinesq近似的情况下，旋转行星上流体的水平动量方程可以写成矢量形式：\n$$ \\frac{D\\mathbf{u}}{Dt} = -f\\mathbf{k} \\times \\mathbf{u} - \\frac{1}{\\rho_0} \\nabla_h p $$\n其中 $\\mathbf{u}$ 是水平速度矢量，$t$ 是时间，$\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla_h$ 是物质导数，$f$ 是科里奥利参数，$\\mathbf{k}$ 是局地垂直单位矢量，$\\rho_0$ 是一个常数参考密度，$\\nabla_h p$ 是水平气压梯度。\n\n左边的项 $\\frac{D\\mathbf{u}}{Dt}$ 代表流体质点相对于旋转参考系的惯性加速度。右边的第一项 $-f\\mathbf{k} \\times \\mathbf{u}$ 是科里奥利加速度。问题要求惯性加速度与科里奥利加速度之比。我们可以通过尺度分析来确定这两项的特征量级。\n\n设 $U$ 为特征水平速度尺度，$L$ 为特征水平长度尺度。变量可以按如下方式进行尺度缩放：\n- 水平速度：像 $u$ 或 $v$ 这样的分量尺度为 $U$。因此，$|\\mathbf{u}| \\sim U$。\n- 水平梯度：$\\nabla_h$ 的尺度为 $1/L$。\n- 物质导数包含两部分：局地时间导数 $\\frac{\\partial}{\\partial t}$ 和平流导数 $\\mathbf{u} \\cdot \\nabla_h$。对于天气尺度系统，特征平流时间尺度为 $T \\sim L/U$。因此，局地时间导数的尺度为 $\\frac{\\partial}{\\partial t} \\sim \\frac{1}{T} = \\frac{U}{L}$。\n\n现在我们来求惯性加速度项和科里奥利加速度项的量级。\n\n1.  **惯性加速度**：惯性加速度由物质导数给出，$\\frac{D\\mathbf{u}}{Dt} = \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla_h)\\mathbf{u}$。\n    局地时间导数项的量级为：\n    $$ \\left| \\frac{\\partial \\mathbf{u}}{\\partial t} \\right| \\sim \\frac{U}{T} = \\frac{U}{L/U} = \\frac{U^2}{L} $$\n    平流导数项的量级为：\n    $$ \\left| (\\mathbf{u} \\cdot \\nabla_h)\\mathbf{u} \\right| \\sim (U \\cdot \\frac{1}{L}) U = \\frac{U^2}{L} $$\n    由于惯性加速度的两个分量具有相同的特征量级，因此惯性加速度的总量级为：\n    $$ \\left| \\frac{D\\mathbf{u}}{Dt} \\right| \\sim \\frac{U^2}{L} $$\n    该项包含了平流效应和因流动路径曲率引起的向心加速度。\n\n2.  **科里奥利加速度**：科里奥利加速度由 $-f\\mathbf{k} \\times \\mathbf{u}$ 给出。其量级为：\n    $$ |-f\\mathbf{k} \\times \\mathbf{u}| = |f| |\\mathbf{u}| \\sin(\\theta) $$\n    其中 $\\theta$ 是 $\\mathbf{k}$ 和 $\\mathbf{u}$ 之间的夹角。由于 $\\mathbf{u}$ 是水平速度，它与垂直矢量 $\\mathbf{k}$ 垂直，所以 $\\theta = \\pi/2$ 且 $\\sin(\\theta)=1$。\n    科里奥利加速度的特征量级为：\n    $$ | -f\\mathbf{k} \\times \\mathbf{u} | \\sim f U $$\n\n现在，我们可以通过取惯性加速度量级与科里奥利加速度量级之比来推导无量纲参数。这个参数被称为罗斯贝数（Rossby number），记作 $Ro$。\n$$ Ro = \\frac{\\text{惯性加速度量级}}{\\text{科里奥利加速度量级}} = \\frac{U^2/L}{fU} $$\n$$ Ro = \\frac{U}{fL} $$\n这个表达式显示了无量纲参数对特征尺度 $U$、$L$ 和科里奥利参数 $f$ 的依赖关系。\n\n接下来，我们用给定的值来计算这个参数：\n-   特征水平速度尺度: $U = 20\\,\\mathrm{m\\,s^{-1}}$\n-   特征水平长度尺度: $L = 1000\\,\\mathrm{km} = 1000 \\times 10^3\\,\\mathrm{m} = 10^6\\,\\mathrm{m}$\n-   地球自转速率: $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n-   纬度: $\\phi = 45^\\circ$\n\n首先，我们计算给定纬度处的科里奥利参数 $f$。问题指定了f平面近似，所以我们使用在 $\\phi = 45^\\circ$ 处计算的 $f$ 的恒定值。\n$$ f = 2 \\Omega \\sin\\phi = 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times \\sin(45^\\circ) $$\n使用 $\\sin(45^\\circ) = \\frac{\\sqrt{2}}{2}$，我们得到：\n$$ f = 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times \\frac{\\sqrt{2}}{2} = \\sqrt{2} \\times 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}} $$\n$$ f \\approx 1.031254 \\times 10^{-4}\\,\\mathrm{s^{-1}} $$\n现在，我们将 $U$、$f$ 和 $L$ 的值代入罗斯贝数的表达式中：\n$$ Ro = \\frac{U}{fL} = \\frac{20\\,\\mathrm{m\\,s^{-1}}}{(1.031254 \\times 10^{-4}\\,\\mathrm{s^{-1}}) \\times (10^6\\,\\mathrm{m})} $$\n$$ Ro = \\frac{20}{1.031254 \\times 10^2} = \\frac{20}{103.1254} $$\n$$ Ro \\approx 0.193933... $$\n问题要求将答案四舍五入到四位有效数字。\n$$ Ro \\approx 0.1939 $$\n这个值远小于1，表明对于中纬度天气尺度流动，科里奥利加速度相对于惯性加速度占主导地位，这是地转近似的基础。",
            "answer": "$$\\boxed{0.1939}$$"
        },
        {
            "introduction": "当地转近似的条件不被满足，特别是当气流路径存在显著曲率时（即罗斯贝数不可忽略），我们必须引入向心加速度来获得更精确的风场描述，这就引出了梯度风平衡的概念。本练习将理论与计算实践相结合，要求您设计并实现一个算法，从离散的位势高度场中估算梯度风速。您需要从第一性原理出发，推导出包含压力梯度力、科里奥利力及向心力三者平衡的梯度风方程，并通过数值方法计算气流曲率和位势梯度。这项练习将为您提供大气建模中不可或缺的数值方法实践经验，包括在网格上计算导数，以及求解非线性平衡方程以更准确地描述围绕高低压中心的气流。",
            "id": "3882997",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，通过计算法向位势梯度和隐含流线的曲率，从一个离散的位势场中估算闭合低压周围的梯度风速，然后用一组观测风速验证该估计值。推导和算法必须从旋转坐标系动力学的第一性原理以及标量场等值面的几何学开始，且不能先验地假设目标关系。\n\n从等压面上的旋转坐标系水平动量方程（以位势表示）开始，并采用与流动对齐的自然坐标系。利用这些基础，为定常、无摩擦流动建立一个联系风速、曲率半径、科里奥利参数和法向位势梯度的关系。然后，您的实现必须在均匀网格上以科学上一致的方式将连续算子离散化。\n\n您必须使用的基本依据是：\n- 等压面上的旋转坐标系水平动量方程：$$\\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = -f\\,\\hat{\\mathbf{k}} \\times \\mathbf{v} - \\nabla \\Phi,$$ 其中 $\\mathbf{v}$ 是水平速度，$f$ 是科里奥利参数（Coriolis parameter $(f)$），$\\hat{\\mathbf{k}}$ 是垂直单位向量，$\\Phi$ 是位势。\n- 沿流线的自然坐标定义：令 $s$ 表示切向，$n$ 表示指向运动左侧的法向，$R$ 表示流线的局部曲率半径，$v$ 表示流速（$\\mathbf{v}$ 的大小）。在定常、无摩擦运动中，物质加速度具有一个大小为 $v^2/R$ 的法向分量，指向曲率中心。\n\n您必须实现的几何与数值算子：\n- 在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格上，使用二阶中心差分在网格点 $(i,j)$ 处估算 $\\Phi(x,y)$ 的一阶导数：\n  $$\\Phi_x \\approx \\frac{\\Phi_{i,j+1} - \\Phi_{i,j-1}}{2\\,\\Delta x}, \\quad \\Phi_y \\approx \\frac{\\Phi_{i+1,j} - \\Phi_{i-1,j}}{2\\,\\Delta y}.$$\n- 使用二阶中心差分估算二阶导数：\n  $$\\Phi_{xx} \\approx \\frac{\\Phi_{i,j+1} - 2\\,\\Phi_{i,j} + \\Phi_{i,j-1}}{\\Delta x^2}, \\quad \\Phi_{yy} \\approx \\frac{\\Phi_{i+1,j} - 2\\,\\Phi_{i,j} + \\Phi_{i-1,j}}{\\Delta y^2},$$\n  $$\\Phi_{xy} \\approx \\frac{\\Phi_{i+1,j+1} - \\Phi_{i+1,j-1} - \\Phi_{i-1,j+1} + \\Phi_{i-1,j-1}}{4\\,\\Delta x\\,\\Delta y}.$$\n- 计算梯度大小 $$\\left\\lvert \\nabla \\Phi \\right\\rvert = \\sqrt{\\Phi_x^2 + \\Phi_y^2}.$$\n- 使用隐式等值面曲率公式，计算通过该点的等值面 $\\Phi(x,y)=\\mathrm{const}$ 的曲率 $\\kappa$，\n  $$\\kappa = \\frac{\\Phi_{xx}\\,\\Phi_y^2 - 2\\,\\Phi_{xy}\\,\\Phi_x\\,\\Phi_y + \\Phi_{yy}\\,\\Phi_x^2}{\\left(\\Phi_x^2 + \\Phi_y^2\\right)^{3/2}},$$\n  然后计算局部曲率半径 $$R = \\frac{1}{\\lvert \\kappa \\rvert}。$$\n- 对于北半球具有逆时针流动的闭合低压，将流线切线与 $$\\mathbf{t} = \\frac{1}{\\lvert \\nabla \\Phi \\rvert}\\,(-\\Phi_y, \\Phi_x),$$ 对齐，使得运动左侧的法线指向内部，$$\\mathbf{n} = \\frac{-\\nabla \\Phi}{\\lvert \\nabla \\Phi \\rvert},$$ 因此法向位势梯度为 $$\\frac{\\partial \\Phi}{\\partial n} = \\nabla \\Phi \\cdot \\mathbf{n} = -\\lvert \\nabla \\Phi \\rvert.$$\n\n从上述基础出发，为定常、无摩擦流动推导在法向上的梯度风平衡，该平衡联系了 $v$、$f$、$R$ 和 $\\partial \\Phi / \\partial n$。求解该方程的物理相关分支，以在每个测试位置获得一个唯一的正风速 $v$。\n\n科学情景与离散场：\n- 考虑一个等压面上的合成轴对称闭合低压，其位势为 $$\\Phi(x,y) = \\Phi_0 + \\alpha \\left(x^2 + y^2\\right),$$ 其中 $\\Phi_0$ 是一个常数参考值（在实现中设为 $\\Phi_0 = 0$），$\\alpha$ 是一个单位为 $\\mathrm{s}^{-2}$ 的正常数。\n- 使用一个均匀方形网格，范围从 $x = -6.0\\times 10^5\\,\\mathrm{m}$ 到 $x = +6.0\\times 10^5\\,\\mathrm{m}$ 以及 $y = -6.0\\times 10^5\\,\\mathrm{m}$ 到 $y = +6.0\\times 10^5\\,\\mathrm{m}$，网格间距为 $\\Delta x = \\Delta y = 1.0\\times 10^4\\,\\mathrm{m}$。\n- 使用 $\\alpha = 2.5\\times 10^{-9}\\,\\mathrm{s}^{-2}$。\n\n测试套件：\n对于每个测试用例，在位于正 $x$ 轴上，$y=0$ 且 $x=r$ 的网格点处进行评估，其中 $r$ 是指定的半径。使用提供的科里奥利参数和观测风速进行验证。\n1. 标准路径中纬度，中等半径：$f = 1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$，$r = 2.0\\times 10^5\\,\\mathrm{m}$，观测风速 $v_{\\mathrm{obs}} = 7.200\\,\\mathrm{m/s}$。\n2. 边界近中心，小半径：$f = 1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$，$r = 5.0\\times 10^4\\,\\mathrm{m}$，观测风速 $v_{\\mathrm{obs}} = 1.900\\,\\mathrm{m/s}$。\n3. 大半径，中纬度：$f = 1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$，$r = 5.0\\times 10^5\\,\\mathrm{m}$，观测风速 $v_{\\mathrm{obs}} = 18.000\\,\\mathrm{m/s}$。\n4. 近赤道区域，中等半径：$f = 1.2\\times 10^{-5}\\,\\mathrm{s}^{-1}$，$r = 2.0\\times 10^5\\,\\mathrm{m}$，观测风速 $v_{\\mathrm{obs}} = 13.200\\,\\mathrm{m/s}$。\n\n要求：\n- 根据所述的物理基础推导梯度风速 $v$ 的表达式，然后实现在每个测试位置使用上述离散算子估计 $v$ 的算法。\n- 通过计算每个测试用例的绝对误差 $$\\epsilon = \\left\\lvert v - v_{\\mathrm{obs}} \\right\\rvert$$ 来验证估计值。\n- 所有计算出的风速和误差均以米/秒为单位表示。在您的最终程序输出中，仅报告四个测试用例的绝对误差（单位为 $\\mathrm{m/s}$），每个误差值四舍五入到三位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $$[e_1,e_2,e_3,e_4],$$ 其中每个 $e_i$ 是测试用例 $i$ 的四舍五入后的绝对误差。\n\n您的程序必须完全自包含，不使用外部输入，并遵守指定的运行时环境。",
            "solution": "问题陈述经评估是科学上合理、适定、客观且自包含的。它基于地球物理流体动力学的基本原理和标准数值方法，提出了一个明确的任务。所有必要的数据和定义都已提供。因此，该问题是有效的，下面提供了解决方案。\n\n解决方案分为两个主要阶段。首先，从水平动量方程推导梯度风速的控制方程。其次，设计一种算法，使用离散近似方法在指定的位势场上计算所需微分和几何算子，从而计算出该速度。\n\n### 梯度风方程的推导\n\n起点是在旋转参考系中，假设无摩擦和定常流动的等压面上的水平动量方程：\n$$\n\\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = -f\\,\\hat{\\mathbf{k}} \\times \\mathbf{v} - \\nabla \\Phi\n$$\n这里，$\\mathbf{v}$ 是水平速度矢量，$\\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t}$ 是物质加速度，$f$ 是科里奥利参数，$\\hat{\\mathbf{k}}$ 是当地的垂直单位向量，而 $-\\nabla \\Phi$ 是以位势 $\\Phi$ 表示的单位质量的压力梯度力。\n\n对于定常流动（即 $\\frac{\\partial \\mathbf{v}}{\\partial t} = \\mathbf{0}$），物质加速度简化为平流项，对于沿弯曲路径的流动，该项代表向心加速度。在自然坐标 $(s, n)$ 中，其中 $s$ 是切向，$n$ 是指向流动左侧的法向，速度为 $\\mathbf{v} = v\\,\\mathbf{t}$，其中 $\\mathbf{t}$ 是切向单位向量，$v = |\\mathbf{v}|$ 是速率。向心加速度指向曲率中心，其大小为 $\\frac{v^2}{R}$，其中 $R$ 是曲率半径。对于北半球的气旋性低压，流动是逆时针的，曲率中心在左侧，也就是法向量 $\\mathbf{n}$ 的方向。因此，加速度矢量为：\n$$\n\\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = \\frac{v^2}{R} \\mathbf{n}\n$$\n我们将动量方程投影到法向 $\\mathbf{n}$ 上：\n$$\n\\left(\\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t}\\right) \\cdot \\mathbf{n} = (-f\\,\\hat{\\mathbf{k}} \\times \\mathbf{v}) \\cdot \\mathbf{n} + (-\\nabla \\Phi) \\cdot \\mathbf{n}\n$$\n我们来逐项计算：\n1.  **加速度项**：加速度在法向量上的投影为 $\\left(\\frac{v^2}{R} \\mathbf{n}\\right) \\cdot \\mathbf{n} = \\frac{v^2}{R}$。\n2.  **科里奥利力项**：科里奥利力为 $-f\\,\\hat{\\mathbf{k}} \\times \\mathbf{v} = -f\\,\\hat{\\mathbf{k}} \\times (v\\,\\mathbf{t})$。根据右手自然坐标系的定义，$\\hat{\\mathbf{k}} \\times \\mathbf{t} = \\mathbf{n}$。所以，该力为 $-fv\\,\\mathbf{n}$。它在 $\\mathbf{n}$ 上的投影为 $(-fv\\,\\mathbf{n}) \\cdot \\mathbf{n} = -fv$。此力指向运动的右侧，即向外，与 $\\mathbf{n}$ 相反。\n3.  **压力梯度力项**：问题将低压中心的法向量定义为指向内部，沿着压力梯度力的方向：$\\mathbf{n} = \\frac{-\\nabla \\Phi}{|\\nabla \\Phi|}$。因此，力的投影为 $(-\\nabla \\Phi) \\cdot \\mathbf{n} = |-\\nabla \\Phi| |\\mathbf{n}| \\cos(0) = |\\nabla \\Phi|$。\n\n将这些分量代回投影后的动量方程，得到向心力（在 $\\mathbf{n}$ 方向）由两个力的合力提供：向内的压力梯度力和向外的科里奥利力。\n$$\n\\frac{v^2}{R} = |\\nabla \\Phi| - fv\n$$\n该方程被称为气旋性流动的梯度风平衡。将其重新整理为关于风速 $v$ 的标准二次方程形式：\n$$\n\\frac{1}{R} v^2 + fv - |\\nabla \\Phi| = 0\n$$\n使用二次公式 $v = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $v$，其中 $a = 1/R$，$b = f$，$c = -|\\nabla \\Phi|$：\n$$\nv = \\frac{-f \\pm \\sqrt{f^2 - 4(1/R)(-|\\nabla \\Phi|)}}{2/R} = \\frac{R}{2} \\left(-f \\pm \\sqrt{f^2 + \\frac{4|\\nabla \\Phi|}{R}}\\right)\n$$\n由于风速 $v$ 必须为正，且 $f, R, |\\nabla \\Phi|$ 均为正，我们必须选择“+”号以获得物理上有意义的解：\n$$\nv = \\frac{R}{2} \\left( \\sqrt{f^2 + \\frac{4|\\nabla \\Phi|}{R}} - f \\right) = \\frac{-fR + \\sqrt{f^2R^2 + 4R|\\nabla \\Phi|}}{2}\n$$\n这就是用于计算梯度风速的最终表达式。\n\n### 算法实现\n\n为了计算特定网格点上的 $v$，我们必须首先从离散位势场 $\\Phi$ 中估计 $|\\nabla \\Phi|$ 和 $R$。\n\n1.  **网格与场设置**：在 $x, y \\in [-6.0\\times 10^5, 6.0\\times 10^5]\\,\\mathrm{m}$ 域上建立一个间距为 $\\Delta x = \\Delta y = 1.0\\times 10^4\\,\\mathrm{m}$ 的均匀笛卡尔网格。位势场定义为 $\\Phi(x,y) = \\alpha (x^2 + y^2)$，其中 $\\alpha = 2.5\\times 10^{-9}\\,\\mathrm{s}^{-2}$。\n\n2.  **导数计算**：在每个测试网格点 $(i,j)$ 处，使用指定的二阶中心差分公式计算所需的 $\\Phi$ 的一阶和二阶偏导数：\n    - $\\Phi_x \\approx \\frac{\\Phi_{i,j+1} - \\Phi_{i,j-1}}{2\\,\\Delta x}$\n    - $\\Phi_y \\approx \\frac{\\Phi_{i+1,j} - \\Phi_{i-1,j}}{2\\,\\Delta y}$\n    - $\\Phi_{xx} \\approx \\frac{\\Phi_{i,j+1} - 2\\,\\Phi_{i,j} + \\Phi_{i,j-1}}{\\Delta x^2}$\n    - $\\Phi_{yy} \\approx \\frac{\\Phi_{i+1,j} - 2\\,\\Phi_{i,j} + \\Phi_{i-1,j}}{\\Delta y^2}$\n    - $\\Phi_{xy} \\approx \\frac{\\Phi_{i+1,j+1} - \\Phi_{i+1,j-1} - \\Phi_{i-1,j+1} + \\Phi_{i-1,j-1}}{4\\,\\Delta x\\,\\Delta y}$\n    (注意：索引 $i$ 对应于 $y$ 轴，索引 $j$ 对应于 $x$ 轴。)\n\n3.  **梯度与曲率计算**：\n    - 位势梯度的量级计算为 $|\\nabla \\Phi| = \\sqrt{\\Phi_x^2 + \\Phi_y^2}$。\n    - 位势等值面（等压线）的曲率 $\\kappa$ 使用隐函数公式计算：\n      $$\n      \\kappa = \\frac{\\Phi_{xx}\\,\\Phi_y^2 - 2\\,\\Phi_{xy}\\,\\Phi_x\\,\\Phi_y + \\Phi_{yy}\\,\\Phi_x^2}{\\left(\\Phi_x^2 + \\Phi_y^2\\right)^{3/2}}\n      $$\n    - 曲率半径则为 $R = 1/|\\kappa|$。对于特定的轴对称场 $\\Phi(x,y) = \\alpha(x^2+y^2)$，等值面是半径为 $r=\\sqrt{x^2+y^2}$ 的圆，其解析曲率为 $\\kappa=1/r$，半径为 $R=r$。二阶有限差分近似对于二次多项式是精确的，因此数值计算将在测试点上得到 $R=r$。\n\n4.  **风速与误差计算**：对于由半径 $r$ 和科里奥利参数 $f$ 定义的每个测试用例：\n    a. 识别出对应于 $(x=r, y=0)$ 的网格位置 $(i,j)$。\n    b. 如上所述，在此位置计算导数、 $|\\nabla \\Phi|$ 和 $R$。\n    c. 使用推导出的公式计算梯度风速 $v$：$v = \\frac{-fR + \\sqrt{f^2R^2 + 4R|\\nabla \\Phi|}}{2}$。\n    d. 根据提供的观测风速 $v_{\\mathrm{obs}}$ 计算绝对误差 $\\epsilon = |v - v_{\\mathrm{obs}}|$。\n    e. 将误差 $\\epsilon$ 四舍五入到三位小数并存储。\n\n将此过程系统地应用于所有四个测试用例，以生成最终的误差列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the gradient wind balance to estimate wind speed.\n\n    The program performs the following steps:\n    1. Sets up a computational grid and a synthetic geopotential field for a closed low.\n    2. For each test case, it locates the corresponding grid point.\n    3. It computes the first and second partial derivatives of geopotential at that point\n       using second-order central difference schemes.\n    4. It uses these derivatives to calculate the geopotential gradient magnitude |grad(Phi)|\n       and the streamline's radius of curvature R.\n    5. It solves the gradient wind equation, a quadratic equation derived from the horizontal\n       momentum balance, for the wind speed v.\n       The equation is v^2/R + fv - |grad(Phi)| = 0.\n    6. It computes the absolute error between the calculated wind speed and a given\n       observed value for each test case.\n    7. Finally, it prints the list of errors, each rounded to three decimal places.\n    \"\"\"\n\n    # Scientific scenario and discrete field parameters\n    alpha = 2.5e-9  # s^-2\n    grid_lim = 6.0e5  # m\n    dx = 1.0e4  # m\n    dy = 1.0e4  # m\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (f, r, v_obs)\n        (1.0e-4, 2.0e5, 7.200),  # Case 1: Happy path\n        (1.0e-4, 5.0e4, 1.900),   # Case 2: Near-center\n        (1.0e-4, 5.0e5, 18.000),  # Case 3: Large radius\n        (1.2e-5, 2.0e5, 13.200)   # Case 4: Near-equatorial\n    ]\n\n    # Create the grid\n    x_coords = np.arange(-grid_lim, grid_lim + dx, dx)\n    y_coords = np.arange(-grid_lim, grid_lim + dy, dy)\n    X, Y = np.meshgrid(x_coords, y_coords)\n\n    # Define the geopotential field\n    Phi = alpha * (X**2 + Y**2)\n\n    # Get grid dimensions and center index\n    ny, nx = Phi.shape\n    iy_center = (ny - 1) // 2\n    ix_center = (nx - 1) // 2\n\n    results = []\n    \n    for f, r, v_obs in test_cases:\n        # Find the grid indices for the test point (x=r, y=0)\n        # i corresponds to y-axis, j corresponds to x-axis\n        ix = ix_center + int(round(r / dx))\n        iy = iy_center\n        \n        # Check for boundary conditions for finite differences\n        if not (0  iy  ny - 1 and 0  ix  nx - 1):\n            raise IndexError(f\"Test point r={r} requires stencil outside grid boundary.\")\n\n        # Compute first derivatives using second-order central differences\n        phi_x = (Phi[iy, ix + 1] - Phi[iy, ix - 1]) / (2 * dx)\n        phi_y = (Phi[iy + 1, ix] - Phi[iy - 1, ix]) / (2 * dy)\n        \n        # Compute second derivatives using second-order central differences\n        phi_xx = (Phi[iy, ix + 1] - 2 * Phi[iy, ix] + Phi[iy, ix - 1]) / (dx**2)\n        phi_yy = (Phi[iy + 1, ix] - 2 * Phi[iy, ix] + Phi[iy - 1, ix]) / (dy**2)\n        phi_xy = (Phi[iy + 1, ix + 1] - Phi[iy + 1, ix - 1] - Phi[iy - 1, ix + 1] + Phi[iy - 1, ix - 1]) / (4 * dx * dy)\n\n        # Compute gradient magnitude\n        grad_phi_mag = np.sqrt(phi_x**2 + phi_y**2)\n        \n        # Compute curvature of the level set\n        kappa_numerator = phi_xx * phi_y**2 - 2 * phi_xy * phi_x * phi_y + phi_yy * phi_x**2\n        kappa_denominator = (phi_x**2 + phi_y**2)**(3/2)\n        \n        # Avoid division by zero at the center (r=0), though test cases are not at r=0\n        if kappa_denominator == 0:\n            # For a perfect circle, curvature is undefined at the center.\n            # However, for an infinitesimal circle, R -> 0.\n            # This case is not hit by the problem's test suite.\n            # A robust implementation might handle this, but here we proceed.\n            kappa = np.inf\n        else:\n            kappa = kappa_numerator / kappa_denominator\n        \n        # Radius of curvature is the reciprocal of the absolute curvature\n        R = 1 / np.abs(kappa)\n        \n        # Solve the gradient wind quadratic equation for v:\n        # (1/R)v^2 + fv - |grad(Phi)| = 0\n        # v = [-fR + sqrt((fR)^2 + 4R*|grad(Phi)|)] / 2\n        discriminant = (f * R)**2 + 4 * R * grad_phi_mag\n        v_grad = (-f * R + np.sqrt(discriminant)) / 2\n        \n        # Calculate absolute error\n        error = np.abs(v_grad - v_obs)\n        results.append(error)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}