{
    "hands_on_practices": [
        {
            "introduction": "A core task of any scale-aware parameterization is to determine what fraction of a physical process, like convection, is resolved by the model grid versus what fraction remains sub-grid and must be parameterized. This exercise introduces a fundamental diagnostic tool based on the Nyquist sampling theorem, a concept borrowed from signal processing. By comparing the characteristic scale of convection to the model's grid spacing, you will develop a first-principles criterion to decide whether convection is \"seen\" by the grid, providing the essential logic behind why scale-aware schemes are necessary .",
            "id": "3910382",
            "problem": "A numerical weather prediction model employs a scale-aware deep convection parameterization that blends parameterized and explicitly resolved convective tendencies according to a partition coefficient that depends on grid spacing and the characteristic scale of convective updrafts. Consider a single horizontal grid cell of size $\\Delta \\times \\Delta$ with grid spacing $\\Delta = 5\\,\\mathrm{km}$. Observations indicate a mean convective updraft radius $r_u = 1\\,\\mathrm{km}$ and a mean convective area fraction within the grid cell of $a = 0.02$. Assume the following physically grounded bases:\n\n- The grid cell area is $A_g = \\Delta^2$. An individual updraft is approximated as a circular plume of area $A_p = \\pi r_u^2$ and diameter $L_u = 2 r_u$.\n- Updraft centers follow a homogeneous spatial Poisson process within the grid cell. The expected number of updrafts intersecting the cell is $n = a A_g / A_p$, and the probability of at least one updraft present is $P_{\\geq 1} = 1 - \\exp(-n)$.\n- By the Shannon–Nyquist sampling theorem, a necessary condition for the grid to explicitly resolve a spatial feature of dominant scale $L_u$ is that its dominant wavenumber $k_u = 2\\pi/L_u$ does not exceed the Nyquist wavenumber $k_c = \\pi/\\Delta$. If $k_u  k_c$, then the resolved fraction of convective effects attributable to that feature is taken to be zero in a minimal scale-aware blending sense.\n\nStarting only from these bases, derive the expressions needed to diagnose whether convection in this grid cell should be mostly parameterized or mostly resolved. Then compute the resolved fraction $f_{\\mathrm{res}}$ and the parameterized fraction $f_{\\mathrm{par}} = 1 - f_{\\mathrm{res}}$ for the given $\\Delta$, $r_u$, and $a$. Express your final answer as a row matrix $\\begin{pmatrix} f_{\\mathrm{res}}  f_{\\mathrm{par}} \\end{pmatrix}$ with no units. No rounding is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving a unique solution. The core of the problem is to determine whether convective updrafts are resolvable by the model grid, which is governed by the relationship between the feature scale and the grid scale, as described by the Shannon-Nyquist sampling theorem.\n\nThe problem states that a necessary condition for a spatial feature to be explicitly resolved is that its dominant wavenumber, $k_u$, does not exceed the grid's Nyquist wavenumber, $k_c$. This can be expressed as the inequality:\n$$k_u \\leq k_c$$\nIf this condition is not met, i.e., $k_u  k_c$, the feature is considered unresolved, and its contribution to the resolved dynamics is zero. The problem defines this as a \"minimal scale-aware blending sense,\" where the resolved fraction, $f_{\\mathrm{res}}$, is set to zero if the feature is unresolved. Logically, if the feature is resolvable ($k_u \\leq k_c$), its contribution is considered fully resolved in this minimal framework, meaning $f_{\\mathrm{res}} = 1$.\n\nThe problem provides the following definitions:\nThe dominant wavenumber of a convective updraft with characteristic scale (diameter) $L_u$ is:\n$$k_u = \\frac{2\\pi}{L_u}$$\nThe Nyquist wavenumber for a grid with spacing $\\Delta$ is:\n$$k_c = \\frac{\\pi}{\\Delta}$$\n\nSubstituting these definitions into the resolvability condition $k_u \\leq k_c$:\n$$\\frac{2\\pi}{L_u} \\leq \\frac{\\pi}{\\Delta}$$\nDividing both sides by $\\pi$ (which is a positive constant) and rearranging the inequality gives the condition in terms of physical lengths:\n$$\\frac{2}{L_u} \\leq \\frac{1}{\\Delta}$$\n$$2\\Delta \\leq L_u$$\nThe problem also provides that the characteristic scale $L_u$ is the updraft diameter, which is twice its radius, $r_u$:\n$$L_u = 2r_u$$\nSubstituting this into the inequality gives:\n$$2\\Delta \\leq 2r_u$$\n$$\\Delta \\leq r_u$$\nThis is the final diagnostic condition: convection is resolvable if the grid spacing $\\Delta$ is less than or equal to the characteristic updraft radius $r_u$. If $\\Delta  r_u$, the convection is considered sub-grid scale and must be parameterized.\n\nWe are given the following values:\nGrid spacing: $\\Delta = 5\\,\\mathrm{km}$\nMean convective updraft radius: $r_u = 1\\,\\mathrm{km}$\n\nNow, we apply the diagnostic test using these values:\nIs $\\Delta \\leq r_u$?\nIs $5\\,\\mathrm{km} \\leq 1\\,\\mathrm{km}$?\nThe inequality is false, as $5  1$. Therefore, the condition for resolvability is not met.\n\nAlternatively, we can compute the wavenumbers directly.\nThe characteristic scale of the updraft is:\n$$L_u = 2r_u = 2(1\\,\\mathrm{km}) = 2\\,\\mathrm{km}$$\nThe dominant wavenumber of the updraft is:\n$$k_u = \\frac{2\\pi}{L_u} = \\frac{2\\pi}{2\\,\\mathrm{km}} = \\pi\\,\\mathrm{km}^{-1}$$\nThe Nyquist wavenumber of the grid is:\n$$k_c = \\frac{\\pi}{\\Delta} = \\frac{\\pi}{5\\,\\mathrm{km}}$$\nComparing the two wavenumbers:\n$$k_u = \\pi\\,\\mathrm{km}^{-1}$$\n$$k_c = \\frac{\\pi}{5}\\,\\mathrm{km}^{-1}$$\nSince $\\pi  \\frac{\\pi}{5}$, we have $k_u  k_c$.\n\nBased on the problem statement, \"If $k_u  k_c$, then the resolved fraction of convective effects... is taken to be zero\".\nTherefore, the resolved fraction is:\n$$f_{\\mathrm{res}} = 0$$\nThe parameterized fraction, $f_{\\mathrm{par}}$, is defined as what remains, such that the sum of the fractions is unity:\n$$f_{\\mathrm{par}} = 1 - f_{\\mathrm{res}}$$\n$$f_{\\mathrm{par}} = 1 - 0 = 1$$\nThis means that for the given grid spacing and updraft scale, the convection is entirely parameterized. The updrafts are too small to be resolved by the $5\\,\\mathrm{km}$ grid.\n\nThe information regarding the convective area fraction $a = 0.02$ and the derived quantities like the expected number of updrafts $n$ are relevant for calculating the total magnitude of convective activity within the grid cell, but not for determining the partitioning ratio $f_{\\mathrm{res}}/f_{\\mathrm{par}}$, which, in this problem, is based solely on the scale criterion derived from the Nyquist theorem.\n\nThe final answer is the pair of values for the resolved and parameterized fractions.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once it is established that convection is happening at the sub-grid scale, the parameterization must represent its net effect on the resolved model state. The mass-flux approach, a cornerstone of modern convection schemes, achieves this by calculating a grid-averaged vertical mass transport. This practice guides you through the foundational calculation of upscaling the properties of individual convective updrafts—their size, number, and velocity—into a single, powerful prognostic variable: the grid-cell mean convective mass flux . This exercise clarifies how microscopic convective details are translated into macroscopic impacts.",
            "id": "3910401",
            "problem": "In a variable-resolution atmospheric model such as a General Circulation Model (GCM), consider a single horizontal grid cell of side length $\\Delta$ that contains $N$ identical convective updrafts. Each updraft is approximated as a circular plume of radius $r_u$, with uniform vertical velocity $w_u$ inside the plume and negligible vertical velocity outside. Assume constant air density $\\rho$ within the cell. The model seeks a scale-aware formulation for the grid-cell mean convective mass flux that respects the geometric occupancy of the updrafts as the grid spacing changes.\n\nStarting from the continuum definition of vertical mass flux through a horizontal plane,\n$$\nF \\equiv \\int_{A} \\rho\\, w \\, dA,\n$$\nand the area-mean vertical mass flux\n$$\nM \\equiv \\frac{F}{A},\n$$\nwhere $A$ is the total horizontal area of the grid cell, derive an expression for the fractional horizontal area occupied by the updrafts, $a$, and for the grid-cell mean convective mass flux, $M$, in terms of $N$, $r_u$, $\\Delta$, $\\rho$, and $w_u$ under the assumptions above. Use the geometric area of a circle and the fact that the grid cell is square with area $A=\\Delta^2$.\n\nThen, evaluate your expressions for the parameter values $N=3$, $r_u=800\\,\\text{m}$, $\\Delta=4\\,\\text{km}$, $\\rho=1\\,\\text{kg m}^{-3}$, and $w_u=4\\,\\text{m s}^{-1}$. Report the fractional area $a$ (dimensionless) and the mass flux $M$ in $\\text{kg m}^{-2}\\,\\text{s}^{-1}$. Round both numerical results to four significant figures.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It presents a standard, albeit simplified, problem in the parameterization of sub-grid scale processes, specifically convection, within an atmospheric model. All necessary information and definitions are provided, and there are no apparent contradictions or ambiguities.\n\nThe first objective is to derive an expression for the fractional horizontal area occupied by the updrafts, denoted by $a$. This is defined as the ratio of the total area of the updrafts to the total area of the grid cell.\n\nThe grid cell is square with a side length of $\\Delta$, so its total horizontal area $A$ is given by:\n$$\nA = \\Delta^2\n$$\nEach convective updraft is a circular plume of radius $r_u$. The area of a single updraft, $A_u$, is:\n$$\nA_u = \\pi r_u^2\n$$\nThere are $N$ identical updrafts within the grid cell. Assuming the updrafts do not overlap, their total area, $A_{\\text{updrafts}}$, is the sum of their individual areas:\n$$\nA_{\\text{updrafts}} = N A_u = N \\pi r_u^2\n$$\nThe fractional area $a$ is the ratio of $A_{\\text{updrafts}}$ to the total grid cell area $A$:\n$$\na = \\frac{A_{\\text{updrafts}}}{A} = \\frac{N \\pi r_u^2}{\\Delta^2}\n$$\nThis is the required expression for the fractional area $a$.\n\nThe second objective is to derive an expression for the grid-cell mean convective mass flux, $M$. The definition provided for the total vertical mass flux through the horizontal plane is:\n$$\nF \\equiv \\int_{A} \\rho\\, w \\, dA\n$$\nThe vertical velocity $w$ is piecewise defined: it is $w_u$ inside the updrafts and $0$ outside. The density $\\rho$ is assumed constant throughout the cell. We can partition the integral over the total area $A$ into the area covered by the updrafts, $A_{\\text{updrafts}}$, and the remaining area, which is the environment $A_{\\text{env}} = A - A_{\\text{updrafts}}$.\n$$\nF = \\int_{A_{\\text{updrafts}}} \\rho\\, w \\, dA + \\int_{A_{\\text{env}}} \\rho\\, w \\, dA\n$$\nSubstituting the values for $w$ in each region:\n$$\nF = \\int_{A_{\\text{updrafts}}} \\rho\\, w_u \\, dA + \\int_{A_{\\text{env}}} \\rho\\, (0) \\, dA\n$$\nThe second integral is zero. Since $\\rho$ and $w_u$ are constant within the updrafts, they can be factored out of the first integral:\n$$\nF = \\rho w_u \\int_{A_{\\text{updrafts}}} dA\n$$\nThe remaining integral is simply the total area of the updrafts, $A_{\\text{updrafts}} = N \\pi r_u^2$.\n$$\nF = \\rho w_u (N \\pi r_u^2)\n$$\nThe grid-cell mean convective mass flux, $M$, is defined as the total flux $F$ divided by the total area $A$:\n$$\nM = \\frac{F}{A} = \\frac{\\rho w_u N \\pi r_u^2}{\\Delta^2}\n$$\nThis is the required expression for $M$ in terms of the given variables. Notably, we can see the relationship $M = \\rho w_u a$.\n\nThe final task is to evaluate these expressions for the given parameter values: $N=3$, $r_u=800\\,\\text{m}$, $\\Delta=4\\,\\text{km}$, $\\rho=1\\,\\text{kg m}^{-3}$, and $w_u=4\\,\\text{m s}^{-1}$. First, we must ensure consistent units. We convert $\\Delta$ from kilometers to meters:\n$$\n\\Delta = 4\\,\\text{km} = 4 \\times 1000\\,\\text{m} = 4000\\,\\text{m}\n$$\nNow we can calculate the numerical value for the fractional area $a$:\n$$\na = \\frac{N \\pi r_u^2}{\\Delta^2} = \\frac{3 \\cdot \\pi \\cdot (800\\,\\text{m})^2}{(4000\\,\\text{m})^2} = \\frac{3 \\pi (640000)}{16000000} = \\frac{3 \\pi \\cdot 64}{1600} = \\frac{3 \\pi}{25}\n$$\nNumerically, this is:\n$$\na \\approx 0.3769911...\n$$\nRounding to four significant figures, we get $a = 0.3770$.\n\nNext, we calculate the numerical value for the mean mass flux $M$:\n$$\nM = \\frac{\\rho w_u N \\pi r_u^2}{\\Delta^2} = \\rho w_u \\left( \\frac{N \\pi r_u^2}{\\Delta^2} \\right) = \\rho w_u a\n$$\nSubstituting the given values and the calculated value of $a$:\n$$\nM = (1\\,\\text{kg m}^{-3}) \\cdot (4\\,\\text{m s}^{-1}) \\cdot \\left(\\frac{3\\pi}{25}\\right) = \\frac{12\\pi}{25}\\,\\text{kg m}^{-2}\\,\\text{s}^{-1}\n$$\nNumerically, this is:\n$$\nM \\approx 1.5079644... \\,\\text{kg m}^{-2}\\,\\text{s}^{-1}\n$$\nRounding to four significant figures, we get $M = 1.508\\,\\text{kg m}^{-2}\\,\\text{s}^{-1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3770  1.508\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A physically sophisticated parameterization is of little use if it renders the atmospheric model numerically unstable. The implementation of any transport process is constrained by numerical stability criteria, most famously the Courant-Friedrichs-Lewy (CFL) condition, which links the physical velocity, grid spacing, and time step. This exercise explores this critical link in the context of a convective updraft, demonstrating how a scale-aware design—which naturally reduces the parameterized velocity $w_u$ as grid spacing $\\Delta z$ decreases—not only improves physical accuracy but is also essential for maintaining the numerical stability and robustness of the entire modeling system .",
            "id": "3910311",
            "problem": "Consider a single-column convective transport step within a scale-aware convection parameterization that advects a conserved scalar $q$ vertically by a parameterized convective updraft of constant vertical velocity $w_u  0$ over a vertical layer of thickness $\\Delta z$. Assume a finite-volume discretization in the vertical with uniform layers and an explicit first-order upwind time-stepping with time step $\\Delta t$ for the convective transport tendency. Starting from the one-dimensional linear advection equation $\\partial_t q + w_u \\partial_z q = 0$ and the stated discretization choices, derive from first principles the linear stability requirement (the Courant–Friedrichs–Lewy (CFL) condition) for the explicit transport update and identify the non-dimensional number that controls stability. Then, for $w_u = 3\\,\\mathrm{m\\,s^{-1}}$, $\\Delta z = 200\\,\\mathrm{m}$, and $\\Delta t = 60\\,\\mathrm{s}$, compute this non-dimensional number and state whether the explicit transport step is linearly stable under these values. Finally, briefly justify, in the context of scale-aware convection parameterization that must remain robust across changing model resolution, how one might systematically adjust either $w_u$ or $\\Delta t$ as horizontal and vertical grid spacings decrease to maintain stability and physical fidelity.\nReport only the computed dimensionless Courant number as your final answer, rounded to three significant figures. Express the final answer as a dimensionless real number.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. Therefore, a formal derivation and analysis can proceed.\n\nThe problem requires the derivation of the linear stability condition for a specific numerical scheme, its application to given parameters, and a discussion of its implications for scale-aware parameterizations.\n\nWe begin with the governing one-dimensional linear advection equation for a conserved scalar $q$:\n$$\n\\partial_t q + w_u \\partial_z q = 0\n$$\nwhere $w_u  0$ is a constant updraft velocity.\n\nThe problem specifies a finite-volume discretization with a first-order explicit time-stepping scheme (forward Euler) and a first-order upwind spatial discretization. Let $q_j^n$ denote the value of $q$ in the vertical layer (cell) with index $j$ at time step $n$. The layer has a uniform thickness of $\\Delta z$, and the time step is $\\Delta t$.\n\nThe time derivative $\\partial_t q$ is approximated as:\n$$\n\\partial_t q \\approx \\frac{q_j^{n+1} - q_j^n}{\\Delta t}\n$$\nFor the spatial derivative $\\partial_z q$, the upwind scheme is used. Since the velocity $w_u$ is positive (upward), the \"upwind\" direction is from the cell below, indexed by $j-1$. Thus, the spatial derivative at the interface between cells $j-1$ and $j$ is approximated using the value from the upwind cell $j-1$, and the derivative at the interface between cells $j$ and $j+1$ is approximated using the value from cell $j$. For the finite-volume tendency in cell $j$, we consider the flux difference:\n$$\n\\partial_z q \\approx \\frac{q_j^n - q_{j-1}^n}{\\Delta z}\n$$\nSubstituting these discretizations into the governing partial differential equation yields the finite-difference equation:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} + w_u \\frac{q_j^n - q_{j-1}^n}{\\Delta z} = 0\n$$\nTo find the update formula for $q_j^{n+1}$, we rearrange the terms:\n$$\nq_j^{n+1} = q_j^n - \\frac{w_u \\Delta t}{\\Delta z} (q_j^n - q_{j-1}^n)\n$$\nWe identify the non-dimensional number that governs the behavior of this equation as the Courant number, $C$:\n$$\nC = \\frac{w_u \\Delta t}{\\Delta z}\n$$\nThe update equation can then be written more compactly as:\n$$\nq_j^{n+1} = (1-C) q_j^n + C q_{j-1}^n\n$$\nTo determine the linear stability requirement, we perform a von Neumann stability analysis. We consider a single Fourier mode of the solution of the form $q_j^n = \\hat{q}^n \\exp(i k j \\Delta z)$, where $k$ is the wavenumber and $i = \\sqrt{-1}$. Substituting this into the discretized equation gives:\n$$\n\\hat{q}^{n+1} \\exp(i k j \\Delta z) = (1-C) \\hat{q}^n \\exp(i k j \\Delta z) + C \\hat{q}^n \\exp(i k (j-1) \\Delta z)\n$$\nDividing by $\\hat{q}^n \\exp(i k j \\Delta z)$ gives the amplification factor $G(k) = \\hat{q}^{n+1}/\\hat{q}^n$:\n$$\nG(k) = (1-C) + C \\exp(-i k \\Delta z)\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must be less than or equal to $1$ for all possible wavenumbers $k$, i.e., $|G(k)| \\le 1$.\nWe express $G(k)$ in terms of its real and imaginary parts using Euler's formula, $\\exp(i\\theta) = \\cos(\\theta) + i\\sin(\\theta)$:\n$$\nG(k) = (1-C) + C(\\cos(k \\Delta z) - i \\sin(k \\Delta z)) = (1-C+C\\cos(k \\Delta z)) - iC\\sin(k \\Delta z)\n$$\nThe squared magnitude of $G(k)$ is:\n$$\n|G(k)|^2 = (1-C+C\\cos(k \\Delta z))^2 + (-C\\sin(k \\Delta z))^2\n$$\n$$\n|G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k \\Delta z) + C^2\\cos^2(k \\Delta z) + C^2\\sin^2(k \\Delta z)\n$$\n$$\n|G(k)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos(k \\Delta z) + C^2(\\cos^2(k \\Delta z)+\\sin^2(k \\Delta z))\n$$\n$$\n|G(k)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos(k \\Delta z)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos(k \\Delta z) = 1 - 2C(1-C)(1 - \\cos(k \\Delta z))\n$$\nThe stability condition $|G(k)|^2 \\le 1$ becomes:\n$$\n1 - 2C(1-C)(1 - \\cos(k \\Delta z)) \\le 1\n$$\n$$\n-2C(1-C)(1 - \\cos(k \\Delta z)) \\le 0\n$$\nThe term $(1 - \\cos(k \\Delta z))$ is always non-negative, ranging from $0$ to $2$. Therefore, the inequality is satisfied if $C(1-C) \\ge 0$. This condition holds for $0 \\le C \\le 1$. Since $w_u$, $\\Delta t$, and $\\Delta z$ are all positive, $C$ is always non-negative. The stability requirement is thus reduced to $C \\le 1$. This is the Courant–Friedrichs–Lewy (CFL) condition for this scheme. The non-dimensional number that controls stability is the Courant number, $C$.\n\nNext, we compute this non-dimensional number for the given values: $w_u = 3\\,\\mathrm{m\\,s^{-1}}$, $\\Delta z = 200\\,\\mathrm{m}$, and $\\Delta t = 60\\,\\mathrm{s}$.\n$$\nC = \\frac{w_u \\Delta t}{\\Delta z} = \\frac{(3\\,\\mathrm{m\\,s^{-1}})(60\\,\\mathrm{s})}{200\\,\\mathrm{m}} = \\frac{180}{200} = 0.9\n$$\nSince $C = 0.9$, and the stability requirement is $C \\le 1$, the explicit transport step is linearly stable under these values.\n\nFinally, we address the context of scale-aware convection parameterization. As model resolution increases, the grid spacing (both horizontal, $\\Delta x$, and vertical, $\\Delta z$) decreases. If the time step $\\Delta t$ and the parameterized velocity $w_u$ were held constant, the Courant number $C = w_u \\Delta t / \\Delta z$ would increase, eventually violating the stability condition $C \\le 1$ and causing the numerical simulation to fail. To maintain stability and physical fidelity across different resolutions, adjustments are necessary:\n1.  **Adjusting $\\Delta t$**: The most straightforward way to maintain stability is to reduce the time step $\\Delta t$ in proportion to the decrease in $\\Delta z$, such that the ratio $\\Delta t / \\Delta z$ ensures $C \\le 1$. This is a common practice in numerical models but can significantly increase computational cost.\n2.  **Adjusting $w_u$**: A more physically sophisticated approach, central to scale-aware parameterization, is to make the parameterized updraft velocity $w_u$ itself a function of the model grid spacing. As the grid becomes finer, the model starts to explicitly resolve the larger convective eddies. The role of the parameterization should diminish accordingly. By design, a scale-aware scheme reduces the strength of the parameterized transport (i.e., reduces $w_u$) as the grid spacing decreases (e.g., as $\\Delta x \\to 0$). This ensures that the parameterization smoothly turns off at resolutions where convection is explicitly resolved. This approach not only aids in meeting the CFL stability requirement but, more importantly, improves the physical realism of the simulation across the \"gray zone\" of resolutions where convection is only partially resolved.\n\nThe problem asks for the computed dimensionless Courant number, rounded to three significant figures.\n$C = 0.9$. To three significant figures, this is $0.900$.",
            "answer": "$$\\boxed{0.900}$$"
        }
    ]
}