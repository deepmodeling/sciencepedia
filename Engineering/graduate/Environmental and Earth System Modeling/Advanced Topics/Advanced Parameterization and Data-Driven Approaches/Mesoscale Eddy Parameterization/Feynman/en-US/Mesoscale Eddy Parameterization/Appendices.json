{
    "hands_on_practices": [
        {
            "introduction": "Before applying any physical parameterization, it is crucial to understand the nature of its core components. This first exercise uses dimensional analysis to confirm the physical units of the Gent-McWilliams (GM) coefficient, $A_{GM}$, and the resulting eddy-induced bolus velocity, $\\mathbf{u}^*$. Completing this practice  ensures a fundamental grasp of how these key terms are constructed and relate to more familiar concepts like diffusivity and velocity.",
            "id": "3892955",
            "problem": "Consider a hydrostatic, Boussinesq ocean described by large-scale, thickness-weighted tracer dynamics in which mesoscale eddy effects are represented by the Gent–McWilliams (GM) parameterization. Let the buoyancy field be denoted by $b(x,y,z,t)$, with physical dimension of acceleration, and define the horizontal gradient operator $\\nabla_{h}$ and the vertical derivative operator $\\partial_{z}$. The isopycnal slope vector is defined as\n$$\n\\mathbf{s} \\equiv -\\frac{\\nabla_{h} b}{\\partial_{z} b},\n$$\nand the GM parameterization introduces a lateral eddy transfer coefficient $A_{GM}$ and a non-divergent bolus (eddy-induced) velocity $\\mathbf{u}^{*}$ constructed from $A_{GM}$ and spatial gradients of the dimensionless slope field $\\mathbf{s}$ via a streamfunction-based construction. You may use the following foundational facts without proof:\n- A Fickian diffusive flux of a scalar $q$ takes the form $\\mathbf{F}_{\\text{diff}}=-K\\,\\nabla q$, where $K$ is a diffusivity coefficient.\n- For an incompressible horizontal flow, a streamfunction $\\psi$ satisfies $u=\\partial_{y}\\psi$ and $v=-\\partial_{x}\\psi$, equivalently $\\mathbf{u}=\\hat{\\mathbf{k}}\\times\\nabla\\psi$, where $\\hat{\\mathbf{k}}$ is the unit vector in the vertical direction.\n\nUsing only dimensional analysis based on these foundations and the definition of $\\mathbf{s}$ above:\n1. Determine the exponents $a_{L}$ and $a_{T}$ such that the GM coefficient has dimensions $[A_{GM}]=L^{a_{L}}T^{a_{T}}$.\n2. Show that a bolus velocity $\\mathbf{u}^{*}$ constructed from $A_{GM}$ and slope gradients, through a streamfunction-based construction, has the dimensions of velocity and determine the exponents $b_{L}$ and $b_{T}$ such that $[\\mathbf{u}^{*}]=L^{b_{L}}T^{b_{T}}$.\n\nExpress your final answer as a single row matrix containing the four exponents in the order $a_{L}$, $a_{T}$, $b_{L}$, $b_{T}$. Do not include units in the final expression. No rounding is required.",
            "solution": "We begin from the stated definitions and fundamental dimensional facts. First, we analyze the isopycnal slope vector $\\mathbf{s}$. The buoyancy $b$ has dimensions of acceleration, which we write as $[b]=LT^{-2}$. The horizontal gradient operator $\\nabla_{h}$ contributes a factor of $L^{-1}$, and the vertical derivative operator $\\partial_{z}$ also contributes $L^{-1}$. Therefore,\n$$\n[\\nabla_{h} b]=L^{-1}\\,[b]=L^{-1}\\,(LT^{-2})=T^{-2},\\qquad [\\partial_{z} b]=L^{-1}\\,[b]=L^{-1}\\,(LT^{-2})=T^{-2}.\n$$\nHence the slope vector,\n$$\n\\mathbf{s}=-\\frac{\\nabla_{h} b}{\\partial_{z} b},\n$$\nis a ratio of two quantities that both have dimensions $T^{-2}$, so it is dimensionless:\n$$\n[\\mathbf{s}]=1.\n$$\n\nNext, we determine the dimensions of the Gent–McWilliams eddy transfer coefficient $A_{GM}$. The foundational fact for a Fickian diffusive flux of a scalar $q$ is $\\mathbf{F}_{\\text{diff}}=-K\\,\\nabla q$, where $K$ is a diffusivity. Dimensional consistency of this expression requires\n$$\n[\\mathbf{F}_{\\text{diff}}]=[q]\\,[\\mathbf{u}]\\quad\\text{and}\\quad [\\nabla q]=[q]\\,L^{-1}.\n$$\nTherefore, $K$ must satisfy\n$$\nK\\,\\nabla q\\sim [K]\\,[q]\\,L^{-1}\\stackrel{!}{\\sim}[q]\\,[\\mathbf{u}]=[q]\\,LT^{-1},\n$$\nwhich implies\n$$\n[K]=L^{2}T^{-1}.\n$$\nThe GM coefficient $A_{GM}$ is an eddy transfer (diffusivity-type) coefficient acting on isopycnal gradients of tracers; by the same dimensional logic as for $K$, it has dimensions of area per unit time. Thus,\n$$\n[A_{GM}]=L^{2}T^{-1}.\n$$\nFrom this we read off $a_{L}=2$ and $a_{T}=-1$.\n\nFinally, we show that a bolus velocity $\\mathbf{u}^{*}$ constructed from $A_{GM}$ and slope gradients has the dimension of velocity and determine its exponents. The problem states that $\\mathbf{u}^{*}$ is constructed from $A_{GM}$ and spatial gradients of the dimensionless slope field $\\mathbf{s}$ via a streamfunction-based construction. There are two equivalent dimensional routes to this conclusion:\n\n1. Streamfunction route. For incompressible horizontal flow, the streamfunction $\\psi$ satisfies $\\mathbf{u}=\\hat{\\mathbf{k}}\\times\\nabla\\psi$, where $\\nabla$ contributes a factor of $L^{-1}$. In the GM construction, the streamfunction is built multiplicatively from $A_{GM}$ and the dimensionless slope field $\\mathbf{s}$, possibly with spatial averaging or smooth cutoff functions that are themselves dimensionless. Therefore,\n$$\n[\\psi]\\sim [A_{GM}]\\,[\\mathbf{s}]=L^{2}T^{-1}\\times 1=L^{2}T^{-1}.\n$$\nApplying the gradient to obtain the velocity,\n$$\n[\\mathbf{u}^{*}]=[\\nabla\\psi]=L^{-1}\\,[\\psi]=L^{-1}\\,(L^{2}T^{-1})=LT^{-1}.\n$$\n\n2. Gradient-of-slope route. Alternatively, if one constructs $\\mathbf{u}^{*}$ directly from $A_{GM}$ multiplied by spatial gradients of the dimensionless slope field (for example, $\\mathbf{u}^{*}\\sim A_{GM}\\,\\nabla\\mathbf{s}$ in a schematic sense), then\n$$\n[\\nabla\\mathbf{s}]=L^{-1}\\,[\\mathbf{s}]=L^{-1}\\times 1=L^{-1},\n$$\nand so\n$$\n[\\mathbf{u}^{*}]\\sim [A_{GM}]\\,[\\nabla\\mathbf{s}]=\\left(L^{2}T^{-1}\\right)\\left(L^{-1}\\right)=LT^{-1}.\n$$\n\nEither route gives $[\\mathbf{u}^{*}]=LT^{-1}$, the dimension of velocity. Therefore the exponents are $b_{L}=1$ and $b_{T}=-1$.\n\nCollecting the exponents as requested in the order $a_{L}$, $a_{T}$, $b_{L}$, $b_{T}$, we have:\n$$\na_{L}=2,\\quad a_{T}=-1,\\quad b_{L}=1,\\quad b_{T}=-1.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}2 & -1 & 1 & -1\\end{pmatrix}}$$"
        },
        {
            "introduction": "The GM parameterization hinges on the concept of the isopycnal slope, $\\mathbf{s}$, but is formulated under a small-slope assumption. This exercise  provides a hands-on opportunity to calculate this slope for a realistic ocean stratification profile. By determining the depth at which the slope exceeds a critical threshold, you will gain a practical understanding of why \"slope limiting\" is an essential feature in ocean models to maintain physical consistency and numerical stability.",
            "id": "3892999",
            "problem": "Consider a stably stratified, hydrostatic, Boussinesq ocean governed by the primitive equations in the small-slope limit relevant to the Gent–McWilliams (GM) parameterization. Let the buoyancy be defined as $b = -g(\\rho - \\rho_{0})/\\rho_{0}$, and the stratification be measured by the Brunt–Väisälä frequency $N^{2}(z) = \\partial b/\\partial z$, where $z \\ge 0$ denotes the positive-downward vertical coordinate with $z=0$ at the ocean surface. In the GM framework, the isopycnal slope vector $\\mathbf{s}$ characterizes the orientation of surfaces of constant buoyancy and enters the eddy-induced transport closure.\n\nAssume a horizontally uniform, depth-independent horizontal buoyancy gradient with magnitude $|\\nabla_{h} b| = G$, and a vertically varying, monotonic stratification profile $N^{2}(z)$ given by\n$$\nN^{2}(z) = N_{0}^{2} \\exp\\!\\left(-\\frac{z}{H}\\right) + N_{d}^{2}, \\quad z \\ge 0,\n$$\nwhere $N_{0}^{2} = 1.5 \\times 10^{-4}\\ \\mathrm{s}^{-2}$, $H = 1000\\ \\mathrm{m}$, $N_{d}^{2} = 1.0 \\times 10^{-6}\\ \\mathrm{s}^{-2}$, and $G = 2.0 \\times 10^{-8}\\ \\mathrm{s}^{-2}$. The GM scheme commonly imposes a slope limit to enforce the small-angle assumption, here taken to be $s_{\\mathrm{lim}} = 3.0 \\times 10^{-3}$.\n\nStarting from the definitions above and basic kinematic relations for surfaces of constant buoyancy, derive the magnitude of the isopycnal slope $||\\mathbf{s}(z)||$ in terms of $G$ and $N^{2}(z)$, and determine the critical depth $z_{c}$ at which $||\\mathbf{s}(z_{c})|| = s_{\\mathrm{lim}}$. Interpret physically when slope limiting is required relative to $z_{c}$. Express your final answer for the critical depth $z_{c}$ in meters and round your result to three significant figures. Use radians implicitly for any angular quantities that appear during derivation, and do not report angles in degrees.",
            "solution": "The magnitude of the isopycnal slope, $||\\mathbf{s}(z)||$, is the ratio of the magnitude of the horizontal buoyancy gradient to the vertical buoyancy gradient. The vertical buoyancy gradient is the squared Brunt–Väisälä frequency, $N^2(z) = \\partial b / \\partial z$. Given a constant horizontal buoyancy gradient magnitude $|\\nabla_{h} b| = G$, the slope magnitude is:\n$$\n||\\mathbf{s}(z)|| = \\frac{|\\nabla_{h} b|}{|\\partial b / \\partial z|} = \\frac{G}{N^2(z)}\n$$\n\nThe problem asks for the critical depth $z_c$ at which the slope magnitude equals the prescribed limit, $s_{\\mathrm{lim}}$. We set up the equation:\n$$\n||\\mathbf{s}(z_c)|| = \\frac{G}{N^2(z_c)} = s_{\\mathrm{lim}}\n$$\nFirst, we solve for the critical value of the stratification, $N^2(z_c)$:\n$$\nN^2(z_c) = \\frac{G}{s_{\\mathrm{lim}}} = \\frac{2.0 \\times 10^{-8}\\ \\mathrm{s}^{-2}}{3.0 \\times 10^{-3}} = \\frac{2}{3} \\times 10^{-5}\\ \\mathrm{s}^{-2} \\approx 6.67 \\times 10^{-6}\\ \\mathrm{s}^{-2}\n$$\nNext, we substitute the given stratification profile $N^{2}(z) = N_{0}^{2} \\exp(-z/H) + N_{d}^{2}$ into the equation for $z_c$:\n$$\nN_{0}^{2} \\exp(-z_c/H) + N_{d}^{2} = \\frac{G}{s_{\\mathrm{lim}}}\n$$\nNow, we solve for $z_c$:\n$$\n\\exp\\left(-\\frac{z_c}{H}\\right) = \\frac{1}{N_{0}^{2}} \\left( \\frac{G}{s_{\\mathrm{lim}}} - N_{d}^{2} \\right)\n$$\n$$\n-\\frac{z_c}{H} = \\ln \\left[ \\frac{1}{N_{0}^{2}} \\left( \\frac{G}{s_{\\mathrm{lim}}} - N_{d}^{2} \\right) \\right]\n$$\n$$\nz_c = -H \\ln \\left[ \\frac{\\frac{G}{s_{\\mathrm{lim}}} - N_{d}^{2}}{N_{0}^{2}} \\right] = H \\ln \\left[ \\frac{N_{0}^{2}}{\\frac{G}{s_{\\mathrm{lim}}} - N_{d}^{2}} \\right]\n$$\nPlugging in the given values:\n*   $N_{0}^{2} = 1.5 \\times 10^{-4}\\ \\mathrm{s}^{-2}$\n*   $N_{d}^{2} = 1.0 \\times 10^{-6}\\ \\mathrm{s}^{-2}$\n*   $H = 1000\\ \\mathrm{m}$\n*   $\\frac{G}{s_{\\mathrm{lim}}} \\approx 6.67 \\times 10^{-6}\\ \\mathrm{s}^{-2}$\n$$\nz_c = 1000 \\ln \\left[ \\frac{1.5 \\times 10^{-4}}{ (6.66... \\times 10^{-6}) - (1.0 \\times 10^{-6}) } \\right] = 1000 \\ln \\left[ \\frac{1.5 \\times 10^{-4}}{ 5.66... \\times 10^{-6} } \\right]\n$$\nMore precisely:\n$$\n\\frac{G}{s_{\\mathrm{lim}}} - N_{d}^{2} = \\left(\\frac{2}{3} \\times 10^{-5}\\right) - 10^{-6} = \\left(\\frac{20}{3} - 1\\right) \\times 10^{-6} = \\frac{17}{3} \\times 10^{-6}\\ \\mathrm{s}^{-2}\n$$\n$$\nz_c = 1000 \\ln \\left( \\frac{1.5 \\times 10^{-4}}{\\frac{17}{3} \\times 10^{-6}} \\right) = 1000 \\ln \\left( \\frac{150 \\times 3}{17} \\right) = 1000 \\ln \\left( \\frac{450}{17} \\right) \\approx 1000 \\times 3.27601 \\approx 3276.01\\ \\mathrm{m}\n$$\nRounding to three significant figures gives $3.28 \\times 10^{3}\\ \\mathrm{m}$.\n\nPhysically, stratification $N^2(z)$ decreases with depth $z$. Consequently, the isopycnal slope $||\\mathbf{s}(z)||$ increases with depth. Slope limiting is required for all depths $z > z_c$, where the calculated slope would otherwise exceed the physical limit $s_{\\mathrm{lim}}$, preventing numerical instability in weakly stratified regions of the model.",
            "answer": "$$\n\\boxed{3.28 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "An effective parameterization must not only be physically sound but also numerically robust, especially when its underlying assumptions are violated. This final practice  explores a critical scenario where the GM scheme breaks down: intermittent convection, where stratification $N^2$ approaches zero. By analyzing different strategies, you will engage in the type of practical reasoning required by model developers to prevent numerical pathologies and ensure the physical integrity of the simulation.",
            "id": "3893015",
            "problem": "Consider a mid-latitude ocean column with intermittent wintertime atmospheric forcing that sporadically drives convection. Let the buoyancy be defined as $b = -g \\rho' / \\rho_0$, where $g$ is gravitational acceleration, $\\rho'$ is the perturbation density, and $\\rho_0$ is a constant reference density. The squared Brunt–Väisälä frequency (buoyancy frequency) is $N^2 = \\partial b / \\partial z$. Static stability requires $N^2 > 0$, neutral stability corresponds to $N^2 = 0$, and convective instability occurs when $N^2  0$. The Gent–McWilliams (GM) mesoscale eddy parameterization represents adiabatic eddy-induced transport that is aligned with isopycnals; geometrically, the local isopycnal slope can be written as $s = -\\nabla_h b / \\partial_z b$, where $\\nabla_h$ denotes the horizontal gradient and $\\partial_z b$ is the vertical buoyancy gradient. In regions where $\\partial_z b \\rightarrow 0$, $s$ becomes ill-conditioned.\n\nAssume this column is embedded in a coarse-resolution primitive equation ocean model with horizontal grid spacing $10 \\,\\mathrm{km}$ and time step $\\Delta t = 1800 \\,\\mathrm{s}$. During intermittent convection events, observations indicate that $N^2$ fluctuates around zero with amplitudes of order $10^{-7}$ to $10^{-6} \\,\\mathrm{s}^{-2}$ on timescales of hours, while the large-scale vertical shear magnitude is $S = |\\partial_z \\mathbf{u}| \\sim 10^{-3} \\,\\mathrm{s}^{-1}$. Convection and mixed-layer turbulence rapidly homogenize buoyancy over the mixed-layer depth, yielding near-zero $\\partial_z b$, whereas mesoscale eddy processes act adiabatically along isopycnals and are typically slower than convective adjustment.\n\nFrom first principles, use the definitions above to reason about the physical consistency of applying adiabatic, along-isopycnal transports when $N^2 \\approx 0$. Based on this reasoning, select the most physically justified criterion for dynamically disabling and re-enabling GM in the presence of intermittent convection and near-neutral stability. Your choice should prevent numerical pathologies associated with $s$ becoming ill-conditioned, avoid rapid on–off flickering in space and time due to noisy $N^2$ fluctuations, and respect the separation of timescales between fast convective mixing and slower mesoscale eddy processes.\n\nWhich option is the most appropriate criterion?\n\nA. Disable GM at any grid point whenever the instantaneous $N^2 \\le 0$ there, and re-enable it as soon as $N^2 > 0$, with no spatial smoothing, no hysteresis, and no additional checks.\n\nB. Define two positive thresholds $N_{\\mathrm{off}}$ and $N_{\\mathrm{on}}$ with $N_{\\mathrm{on}} > N_{\\mathrm{off}} > 0$, and a small vertical-gradient floor $\\epsilon_b > 0$. Compute a running time-window average $\\langle N^2 \\rangle_\\tau$ over a window of duration $\\tau$ comparable to convective adjustment timescales (e.g., hours). Disable GM in a grid cell if $\\langle N^2 \\rangle_\\tau  N_{\\mathrm{off}}$ for a persistence time $\\tau_{\\mathrm{off}}$ and either $|\\partial_z b|  \\epsilon_b$ or $|s|$ exceeds a prescribed bound set by geometric consistency; re-enable GM only if $\\langle N^2 \\rangle_\\tau > N_{\\mathrm{on}}$ for a persistence time $\\tau_{\\mathrm{on}}$. Apply modest spatial smoothing to $\\langle N^2 \\rangle_\\tau$ to reduce grid-scale noise.\n\nC. Use the instantaneous gradient Richardson number $Ri = N^2 / S^2$ and disable GM wherever $Ri  Ri_{\\mathrm{crit}}$ for some constant $Ri_{\\mathrm{crit}}$ based on shear instability theory, re-enabling it when $Ri \\ge Ri_{\\mathrm{crit}}$, with no hysteresis or additional constraints.\n\nD. At every time step, apply a horizontal Laplacian filter to $N^2$ over the model grid to obtain a smoothed field $N^2_{\\mathrm{sm}}$, and disable GM wherever $N^2_{\\mathrm{sm}}  0$; re-enable it wherever $N^2_{\\mathrm{sm}} \\ge 0$. Do not use thresholds, hysteresis, or checks on $\\partial_z b$.\n\nSelect one option.",
            "solution": "The Gent-McWilliams (GM) parameterization is based on the adiabatic, along-isopycnal transport of tracers by mesoscale eddies. This physical assumption breaks down in regions of active convection, where transport is primarily diabatic (mixing) and the water column becomes homogenized. In such regions, the stratification $N^2 = \\partial_z b$ approaches zero or becomes negative, making the concept of an isopycnal surface ill-defined and causing the isopycnal slope calculation $s = -\\nabla_h b / \\partial_z b$ to become numerically unstable. The ideal criterion for disabling GM must therefore address both this physical inconsistency and the numerical challenges.\n\nLet's analyze the options:\n\n**A. Disable GM at any grid point whenever the instantaneous $N^2 \\le 0$ there, and re-enable it as soon as $N^2 > 0$, with no spatial smoothing, no hysteresis, and no additional checks.**\n*Incorrect*. This approach is too simplistic. Convective regions often exhibit high-frequency fluctuations of $N^2$ around zero. This simple switch would cause the parameterization to flicker on and off rapidly, introducing numerical noise and being physically unrealistic, as the background eddy field does not appear and disappear on such short timescales.\n\n**B. Define two positive thresholds $N_{\\mathrm{off}}$ and $N_{\\mathrm{on}}$ with $N_{\\mathrm{on}} > N_{\\mathrm{off}} > 0$, and a small vertical-gradient floor $\\epsilon_b > 0$. Compute a running time-window average $\\langle N^2 \\rangle_\\tau$ over a window of duration $\\tau$ comparable to convective adjustment timescales (e.g., hours). Disable GM in a grid cell if $\\langle N^2 \\rangle_\\tau  N_{\\mathrm{off}}$ for a persistence time $\\tau_{\\mathrm{off}}$ and either $|\\partial_z b|  \\epsilon_b$ or $|s|$ exceeds a prescribed bound set by geometric consistency; re-enable GM only if $\\langle N^2 \\rangle_\\tau > N_{\\mathrm{on}}$ for a persistence time $\\tau_{\\mathrm{on}}$. Apply modest spatial smoothing to $\\langle N^2 \\rangle_\\tau$ to reduce grid-scale noise.**\n*Correct*. This is a comprehensive and robust strategy. It addresses all key requirements:\n1.  **Avoids Flickering:** It uses time averaging ($\\langle N^2 \\rangle_\\tau$), persistence checks ($\\tau_{\\mathrm{off}}, \\tau_{\\mathrm{on}}$), and spatial smoothing to filter out high-frequency and small-scale noise.\n2.  **Numerical Stability:** It includes direct checks on the denominator ($|\\partial_z b|  \\epsilon_b$) and the slope magnitude ($|s|$) to prevent division by zero or unphysical values.\n3.  **Physical Consistency:** It introduces hysteresis by using separate 'off' and 'on' thresholds ($N_{\\mathrm{on}} > N_{\\mathrm{off}}$). This ensures that GM is only re-enabled once a robustly stable stratification is re-established, respecting the timescale separation between fast convection and slow eddy adjustment.\n\n**C. Use the instantaneous gradient Richardson number $Ri = N^2 / S^2$ and disable GM wherever $Ri  Ri_{\\mathrm{crit}}$ for some constant $Ri_{\\mathrm{crit}}$ based on shear instability theory, re-enabling it when $Ri \\ge Ri_{\\mathrm{crit}}$, with no hysteresis or additional constraints.**\n*Incorrect*. The Richardson number $Ri$ diagnoses shear instability, not the convective instability that primarily defines a mixed layer. The physical reason for disabling GM is the vanishing of stratification ($N^2 \\approx 0$), which makes isopycnals ill-defined, not necessarily high shear. Furthermore, this method is based on instantaneous values and lacks hysteresis, so it would also suffer from the flickering problem.\n\n**D. At every time step, apply a horizontal Laplacian filter to $N^2$ over the model grid to obtain a smoothed field $N^2_{\\mathrm{sm}}$, and disable GM wherever $N^2_{\\mathrm{sm}}  0$; re-enable it wherever $N^2_{\\mathrm{sm}} \\ge 0$. Do not use thresholds, hysteresis, or checks on $\\partial_z b$.**\n*Incorrect*. While spatial smoothing helps reduce grid-scale noise, this approach fails to address temporal flickering. A region's smoothed stratification $N^2_{\\mathrm{sm}}$ can still oscillate around zero in time, causing the scheme to toggle on and off. The lack of hysteresis is a major drawback.\n\nTherefore, Option B provides the most physically justified and numerically robust criterion.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}