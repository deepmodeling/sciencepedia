## 引言
在[地球系统模型](@entry_id:1124096)（ESM）的开发中，如何准确表示那些因计算分辨率限制而无法显式解析的[次网格尺度过程](@entry_id:1132602)，是一个核心挑战。传统的确定性[参数化](@entry_id:265163)方案试图用可解尺度变量的函数来近似这些过程的平均效应，但这种方法系统性地忽略了次网格过程固有的变率和不确定性。这种知识上的差距导致了模型中普遍存在的系统性偏差、系综预报[离散度](@entry_id:168823)不足等问题。随机[参数化](@entry_id:265163)正是为了弥补这一鸿沟而兴起的前沿范式，它通过在模型中引入物理上和统计上合理的随机性，旨在更全面地表示次网格过程的影响。

本文将系统性地引导读者深入随机[参数化](@entry_id:265163)的世界。在**“原理与机制”**一章中，我们将从封闭问题的根源出发，阐明引入随机性的物理和数学基础，并掌握描述[随机过程](@entry_id:268487)的核心语言。随后，在**“应用与交叉学科联系”**一章中，我们将通过大气、海洋等领域的具体案例，展示这些理论如何转化为改进模式真实感的强大工具，并探讨其与数据同化、气候可预报性等领域的深刻联系。最后，通过**“动手实践”**部分，读者将有机会亲手实现和分析随机模型，将理论知识转化为实践技能，从而全面掌握这一提升[地球系统模型](@entry_id:1124096)能力的关键技术。

## 原理与机制

在上一章中，我们介绍了[地球系统模型](@entry_id:1124096)中[参数化](@entry_id:265163)的必要性，即那些由于计算网格分辨率的限制而无法被显式解析的过程。本章将深入探讨这些[参数化](@entry_id:265163)的原理与机制，特别关注一种日益重要的范式：随机[参数化](@entry_id:265163)。我们将首先阐明封闭问题（closure problem）的根源，然后探讨为何以及何时需要引入随机性来表述次网格过程。随后，我们将建立描述这些[随机过程](@entry_id:268487)的数学语言，并讨论在模型中实施随机方法的关键选择及其深远影响。

### [次网格尺度](@entry_id:1132591)效应与封闭问题

[地球系统模型](@entry_id:1124096)的基础是流[体力](@entry_id:174230)学和[热力学](@entry_id:172368)的守恒定律，如动量、质量和能量守恒。这些定律以[非线性偏微分方程](@entry_id:169481)组的形式表达。为了进行数值求解，我们必须在一个离散的网格上表示这些连续的方程。这个离散过程，无论是通过[空间滤波](@entry_id:202429)、网格平均还是谱截断，都不可避免地将变量场分解为**可解尺度（resolved-scale）**和**[次网格尺度](@entry_id:1132591)（subgrid-scale）**两个部分。

我们以一个由速度场 $\boldsymbol{u}(\boldsymbol{x},t)$ 平流的示踪剂（如位涡或化学物质）$a(\boldsymbol{x},t)$ 为例。其[守恒方程](@entry_id:1122898)包含一个[非线性](@entry_id:637147)的平流项 $\nabla\cdot(\boldsymbol{u} a)$。我们定义一个滤波算子 $\overline{(\cdot)}$，它将任何场 $f$ 分解为可解部分 $\bar{f} = \overline{f}$ 和不可解（或次网格）部分 $f' = f - \bar{f}$。将这个算子应用于平流项时，问题便显现出来。由于滤波是一个线性运算，而平流项是二次[非线性](@entry_id:637147)的，所以滤波和乘积运算的顺序不可交换。具体来说：

$$
\overline{\boldsymbol{u} a} \neq \bar{\boldsymbol{u}}\,\bar{a}
$$

为了看清这一点，我们将变量代入分解形式：
$$
\overline{\boldsymbol{u} a} = \overline{(\bar{\boldsymbol{u}} + \boldsymbol{u}')(\bar{a} + a')} = \overline{\bar{\boldsymbol{u}}\bar{a} + \bar{\boldsymbol{u}}a' + \boldsymbol{u}'\bar{a} + \boldsymbol{u}'a'}
$$
经过整理，可解尺度示踪剂 $\bar{a}$ 的[预报方程](@entry_id:1130221)中会出现一个表示次网格尺度效应的项，通常写作次网格通量的散度。这个通量包含了诸如 $\overline{\boldsymbol{u}'a'}$ 这样的项，它代表了次网格速度脉动和示踪剂脉动之间的相关性。在[动量方程](@entry_id:197225)中，类似地会出现**雷诺应力（Reynolds stress）**项 $\overline{\boldsymbol{u}'\otimes\boldsymbol{u}'}$，它源于对[非线性](@entry_id:637147)项 $\nabla\cdot(\boldsymbol{u}\otimes\boldsymbol{u})$ 的平均  。

这些包含次网格变量乘积平均的项，如 $\overline{\boldsymbol{u}'a'}$，无法仅用可解变量（如 $\bar{a}$ 和 $\bar{\boldsymbol{u}}$）来精确表达。然而，我们的模型只预报可解变量的演化。这就构成了一个**封闭问题（closure problem）**：可解尺度的方程依赖于我们无从知晓的不可解尺度的统计量。**[参数化](@entry_id:265163)（parameterization）**的本质，正是为这些未知的次网格项提供一个近似模型，从而使可解尺度的方程组得以“封闭”。

### 引入随机性：为何以及如何引入

最传统的[参数化](@entry_id:265163)方案是**确定性[参数化](@entry_id:265163)（deterministic parameterization）**。它假设次网格效应可以表示为可解尺度状态的某个确定性函数。例如，一个经典的例子是用一个与可解尺度应变率成正比的“涡粘性”项来模拟雷诺应力。然而，这种方法有其固有的局限性。

对于一个给定的可解尺度状态（例如，一个特定的温度和风场），可能存在多种不同的次网格尺度[湍流](@entry_id:151300)或对流构型。这意味着，真实的次网格强迫项 $R(\mathbf{x}, t)$ 并非一个单一的值，而是在给定可解状态 $\bar{q}$ 的条件下的一个概率分布。确定性[参数化](@entry_id:265163)试图模拟这个分布的均值 $\mathbb{E}[R | \bar{q}]$，却完全忽略了其方差 $\mathrm{Var}(R | \bar{q})$ 和其他高阶矩。在许多情况下，这个方差是显著且依赖于状态的，即 $\mathrm{Var}(R | \bar{q}) > 0$ 。

**随机[参数化](@entry_id:265163)（stochastic parameterization）**通过在确定性部分的基础上增加一个[随机过程](@entry_id:268487)来解决这个问题。其形式通常为 $R(\mathbf{x}, t) \approx \Phi(\bar{q}) + \Xi(\bar{q}, \mathbf{x}, t)$，其中 $\Phi$ 是确定性部分（条件均值），而 $\Xi$ 是一个随机项，其统计特性（如方差和相关性）被设计用来表征真实的次网格变率。

引入随机性有两个核心理由：
1.  **表征不可解的变率（Aleatory Uncertainty）**：这是系统固有的、不可约减的随机性。随机项 $\Xi$ 的目的就是为了重现这种变率，使得模型能够产生更真实的统计特性，例如正确的风暴[强度分布](@entry_id:163068)或[厄尔尼诺-南方涛动](@entry_id:1124378)（ENSO）的变率幅度。这种方法旨在解决由于忽略 $\mathrm{Var}(R | \bar{q})$ 而导致的系综预报[离散度](@entry_id:168823)不足和平均态漂移等问题。这种策略的一个例子是在模型的每个时间步都从一个依赖状态的分布中抽取一个随机扰动 。

2.  **表征模型的不确定性（Epistemic Uncertainty）**：这是由于我们知识的缺乏导致的不确定性，原则上可以通过更多数据或更好的理论来减小。这包括参数不确定性（例如，云混合率的最佳值是多少？）和结构不确定性（[参数化](@entry_id:265163)方案的数学形式是否正确？）。一种常见的表征认知不确定性的方法是“扰动参数”方案，即在系综预报的不同成员中使用略微不同的参数值 $\theta$。这种方法将我们对参数 $\theta$ 的[不确定性表示](@entry_id:1133583)为系综成员间的差异 。

### 随机性的理论基础

将随机性引入物理模型并非一个随意的“特设”决定，它背后有坚实的理论基础作为支撑。

首先，**[中心极限定理](@entry_id:143108)（Central Limit Theorem）**提供了一个强有力的论证。在一个可解尺度的时间步长 $\Delta t$ 内，作用于大尺度系统的次网格效应是大量快速、弱相关的微小事件（如单个湍涡或对流泡）累积的结果。[中心极限定理](@entry_id:143108)告诉我们，这样的大量[随机变量](@entry_id:195330)之和趋向于一个高斯分布。这为将次网格强迫的累积效应建模为一个高斯随机增量（即[维纳过程](@entry_id:137696)的增量）提供了理论依据 。

其次，**[涨落-耗散定理](@entry_id:1125114)（Fluctuation-Dissipation Theorem）**的观点也至关重要。从统计物理学的角度看，快速的[次网格尺度](@entry_id:1132591)系统就像一个作用于慢速可解尺度系统的“[热浴](@entry_id:137040)”。这个“热浴”有两个作用：一是通过摩擦或粘性等过程耗散可解尺度的能量（**耗散**），这通常由[参数化](@entry_id:265163)的确定性部分（如涡粘）来描述；二是通过随机的“踢动”将能量反馈给可解尺度（**涨落**）。涨落-耗散定理指出，这两个过程是内在联系、不可分割的。一个只包含耗散而没有相应涨落的[参数化](@entry_id:265163)方案在物理上是不完整的，它会系统性地耗散能量，导致模型的变率过低。因此，为了维持正确的[统计平衡](@entry_id:186577)和气候变率，一个与耗散部分相平衡的随机[强迫项](@entry_id:165986)是必需的  。

更进一步，**均匀化理论（Homogenization Theory）**为从快-慢动力系统中推导简化随机模型提供了严格的数学框架。考虑一个由慢变量 $X_t^\epsilon$ 和快变量 $Y_t^\epsilon$ 组成的系统，其中时间尺度由小参数 $\epsilon$ 分隔。均匀化理论证明，在极限 $\epsilon \to 0$ 下，慢变量 $X_t^\epsilon$ 的动力学收敛到一个有效的随机微分方程（SDE）。这个极限方程的漂移项由快变量的平均效应决定，而其扩散项（即随机部分）则源于快变量脉动的累积效应。这个扩散项的大小与快变量自身的时间自相关结构密切相关 。这雄辩地证明了，随机性不是被外部添加的，而是从多尺度[非线性动力学](@entry_id:901750)的内部平均过程中自然**涌现**出来的。

最后，一个关键的实践问题是，引入随机性是否会破坏模型的守恒性。答案是，只要构造得当，就不会。如果随机次网格倾向被表示为一个随机通量的[散度形式](@entry_id:748608)，那么在周期性或[无通量边界条件](@entry_id:168487)下，对整个模型区域进行积分时，该项的贡献将为零。这意味着，无论随机通量的具体实现是什么，区域总体的[守恒量](@entry_id:161475)（如总质量或总能量）都将保持守恒 。

### 随机模型的数学语言

为了在模型中实现随机[参数化](@entry_id:265163)，我们需要掌握描述[随机过程](@entry_id:268487)的数学语言。

最基本的概念是**[高斯白噪声](@entry_id:749762)（Gaussian white noise）**，记作 $\xi(t)$。这是一个理想化的数学构造，代表一个在时间上完全不相关的[随机过程](@entry_id:268487)。它的关键统计特性是：
- **均值**：$\mathbb{E}[\xi(t)] = 0$。
- **[自相关函数](@entry_id:138327)**：$R(\tau) = \mathbb{E}[\xi(t)\xi(t+\tau)] = \sigma^2 \delta(\tau)$，其中 $\delta(\tau)$ 是[狄拉克δ函数](@entry_id:153299)，$\sigma^2$ 是噪声强度。
[δ函数](@entry_id:273429)的形式意味着噪声在任何两个不同时刻都完全不相关。这也导致了一个奇特的性质：白噪声的瞬时方差 $R(0)$ 是无穷大的 。在实际的离散时间模型中，我们使用的是[维纳过程](@entry_id:137696)的增量 $dW_t$，其方差与时间步长成正比，$\mathbb{E}[(dW_t)^2] = dt$。

与白噪声相对的是**[有色噪声](@entry_id:265434)（colored noise）**。这是任何具有非零时间相关性的平稳[随机过程](@entry_id:268487)。与[白噪声](@entry_id:145248)不同，[有色噪声](@entry_id:265434)具有有限的方差，其[自相关函数](@entry_id:138327) $R(\tau)$ 在 $\tau=0$ 处连续，并随着时间延迟 $\tau$ 的增加而衰减。衰减的[特征时间尺度](@entry_id:276738)被称为**[相关时间](@entry_id:176698)（correlation time）** $\tau_c$。

一个典型且极为重要的[有色噪声](@entry_id:265434)例子是**[奥恩斯坦-乌伦贝克过程](@entry_id:140047)（Ornstein-Uhlenbeck process, OU过程）**。它描述了一个受到随机扰动但同时又会向其均值（此处为0）线性回复的变量 $X(t)$。其演化由一个[线性随机微分方程](@entry_id:202697)（SDE）给出：
$$
dX(t) = -\lambda X(t) dt + \sigma dW(t)
$$
其中 $\lambda > 0$ 是回复率（与相关时间的倒数成正比），$\sigma$ 是噪[声强](@entry_id:1120700)度。OU过程是一个平稳、高斯、[马尔可夫过程](@entry_id:1127634)，其统计特性为：
- **均值**：$\mathbb{E}[X(t)] = 0$。
- **方差**：$\mathrm{Var}[X(t)] = \frac{\sigma^2}{2\lambda}$。
- **[自相关函数](@entry_id:138327)**：$R_X(\tau) = \frac{\sigma^2}{2\lambda} \exp(-\lambda |\tau|)$。
OU过程的自相关函数呈指数衰减，[相关时间](@entry_id:176698)为 $\tau_c = 1/\lambda$。它是有色噪声最简单的典范，常被用作构建更复杂随机[参数化](@entry_id:265163)的基础模块  。

### 随机[参数化](@entry_id:265163)的实现：关键选择与影响

在将随机性引入模型时，模型开发者面临两个关键的数学选择，这两个选择对模型的行为有着深远的影响。

#### 加性噪声 vs. [乘性噪声](@entry_id:261463)

第一个选择是噪声项如何依赖于模型的状态。
- **[加性噪声](@entry_id:194447)（Additive Noise）**：随机强迫的强度是恒定的，不依赖于可解变量。SDE的形式为 $dX = a(X)dt + \sigma dW_t$，其中 $\sigma$ 是一个常数。
- **[乘性噪声](@entry_id:261463)（Multiplicative Noise）**：随机强迫的强度依赖于可解变量的状态。SDE的形式为 $dX = a(X)dt + b(X)dW_t$，其中 $b(X)$ 是一个依赖于状态 $X$ 的函数。

这个选择具有重要的物理意义。乘性噪声允许次网格过程的变率依赖于大尺度状态。例如，海洋表面的[热带对流](@entry_id:1133451)活动在海温较高时可能更活跃、变率更大。这种依赖关系只能通过[乘性噪声](@entry_id:261463)来表示。从数学上看，一个直接的后果是，过程的瞬时方差增长率（二次变差）在加性噪声情况下是常数 $\sigma^2$，而在[乘性噪声](@entry_id:261463)情况下则是依赖状态的 $b^2(X)$ 。

#### [伊藤积分](@entry_id:272774) vs. [斯特拉托诺维奇积分](@entry_id:266086)

当噪声是[乘性](@entry_id:187940)时，第二个更为微妙的选择出现了：如何解释[随机积分](@entry_id:198356) $\int b(X)dW_t$。两种最主要的解释是**伊藤（Itô）积分**和**斯特拉托诺维奇（Stratonovich）积分**。

它们的区别源于在离散求和逼近积分时，如何选取被积函数 $b(X)$ 的求值点。
- **[伊藤积分](@entry_id:272774)**使用时间区间的**左端点**，即 $\sum b(X_{t_k})(W_{t_{k+1}}-W_{t_k})$。这使得被积函数是**非预期的（non-anticipating）**，即在$t_k$时刻的$b(X_{t_k})$与未来的噪声增量$W_{t_{k+1}}-W_{t_k}$无关。
- **[斯特拉托诺维奇积分](@entry_id:266086)**使用时间区间的**中点**，即 $\sum b(\frac{X_{t_k}+X_{t_{k+1}}}{2})(W_{t_{k+1}}-W_{t_k})$。这使得被积函数包含了对未来噪声增量的一些信息，是**预期的（anticipating）**。

这个看似微小的技术差异导致了两种微积分体系的根本不同：
1.  **链式法则**：[斯特拉托诺维奇积分](@entry_id:266086)的链式法则与普通微积分完全相同。而[伊藤积分](@entry_id:272774)的[链式法则](@entry_id:190743)（即**[伊藤引理](@entry_id:138912)**）包含一个额外的二阶项，它与噪声的二次变差有关。
2.  **漂移项修正**：正因为链式法则的不同，一个以斯特拉托诺维奇形式给出的SDE，在转换为数学上等价的伊藤形式时，其漂移项会增加一个修正项，即所谓的**噪声致漂移（noise-induced drift）**。对于标量SDE $dX = a_S(X) dt + b(X) \circ dW_t$（$\circ$表示[斯特拉托诺维奇积分](@entry_id:266086)），其等价的伊藤形式为 $dX = [a_S(X) + \frac{1}{2}b(X)b'(X)]dt + b(X)dW_t$  。这意味着，在乘性噪声下，对[随机积分](@entry_id:198356)的不同物理解释会导致模型确定性部分的演化也发生改变。
3.  **物理解释**：**王-扎才定理（Wong-Zakai theorem）**指出，如果一个系统受到具有非常短但有限[相关时间](@entry_id:176698)（即有色噪声）的真实物理噪声的驱动，那么当这个[相关时间](@entry_id:176698)趋于零时，极限的SDE应该用[斯特拉托诺维奇积分](@entry_id:266086)来解释。由于次网格过程是快速但非瞬时的物理过程，这为在[地球系统模型](@entry_id:1124096)中偏好使用[斯特拉托诺维奇积分](@entry_id:266086)提供了强有力的物理论据 。然而，[伊藤积分](@entry_id:272774)因其非预期的性质（使得它成为一个[鞅](@entry_id:267779)）而在数学金融和概率论中具有极大的便利性。

在加性噪声的情况下（$b(X)=\sigma$为常数），$b'(X)=0$，噪声致漂移项为零，两种积分的定义是等价的 。

### 综合示例：[剪切流](@entry_id:266817)中的随机[湍流模型](@entry_id:190404)

为了将上述原理融会贯通，让我们看一个具体的例子：在一个具有平均剪切的流体中，如何为[雷诺应力](@entry_id:263788)建立一个简单的随机模型 。考虑一个平均流速为 $U(z)$，剪切为 $S=dU/dz$ 的边界层流动。雷诺平均[动量方程](@entry_id:197225)中出现的关键未封闭项是雷诺应力，例如 $\overline{u'w'}$，它代表了垂直方向的动量输送。

我们可以为流向速度脉动 $u'$ 和垂直速度脉动 $w'$ 建立一个耦合的随机模型：
$$
\mathrm{d}u'(t) = -\lambda u'(t) \mathrm{d}t + \alpha S w'(t) \mathrm{d}t + \sigma_u \mathrm{d}W_u(t)
$$
$$
\mathrm{d}w'(t) = -\lambda w'(t) \mathrm{d}t + \sigma_w \mathrm{d}W_w(t)
$$
在这个模型中：
- $-\lambda u'(t) \mathrm{d}t$ 和 $-\lambda w'(t) \mathrm{d}t$ 代表了[湍流](@entry_id:151300)脉动由于[粘性耗散](@entry_id:143708)或压力扰动而衰减的趋势（线性阻尼）。
- $\alpha S w'(t) \mathrm{d}t$ 是关键的物理项，代表**剪切产生（shear production）**。它表示垂直方向的脉动 $w'$ 如何通过与平均剪切 $S$ 的相互作用来产生流向的脉动 $u'$。
- $\sigma_u \mathrm{d}W_u(t)$ 和 $\sigma_w \mathrm{d}W_w(t)$ 是随机强迫项，代表来自其他未建模过程（如压力扰动）的随机“踢动”，维持着[湍流](@entry_id:151300)的存在。

这是一个包含物理机制（剪切产生）、耗散（线性阻尼）和随机涨落的最小化模型，完全符合涨落-耗散的思想。通过应用[伊藤微积分](@entry_id:266022)的矩[演化方程](@entry_id:268137)，我们可以求解这个系统的平稳统计量。在假定系统达到统计平稳状态后，可以推导出雷诺应力 $\overline{u'w'}$ 的一个封闭表达式：
$$
\overline{u'w'} = \frac{\alpha S \sigma_w^2}{4\lambda^2}
$$
这个结果清晰地展示了随机[参数化](@entry_id:265163)的威力。它为原本未知的雷诺应力提供了一个解析表达式，将其与可解的平均剪切 $S$ 以及描述次网格[湍流统计](@entry_id:200093)特性的参数（$\alpha, \lambda, \sigma_w$）直接联系起来。这不仅解决了封闭问题，还提供了一个包含明确物理机制且自洽的[次网格模型](@entry_id:755601)。

本章我们从封闭问题的根源出发，系统地阐述了为何需要以及如何基于物理和数学原理构建随机[参数化](@entry_id:265163)方案。通过掌握这些原理与机制，地球[系统建模](@entry_id:197208)者可以更有力地应对模式分辨率的挑战，开发出更真实、更可靠的[地球系统模型](@entry_id:1124096)。