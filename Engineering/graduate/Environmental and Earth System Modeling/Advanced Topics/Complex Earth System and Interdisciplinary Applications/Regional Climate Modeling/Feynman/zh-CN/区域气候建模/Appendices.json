{
    "hands_on_practices": [
        {
            "introduction": "在配置区域气候模式时，一个首要决策是确定水平网格间距（$ \\Delta x $）。这一选择直接决定了哪些物理过程能够被模型显式解析，哪些则必须通过参数化方案来表达。本练习  将引导您运用经典的湍流浮力羽流理论，通过动手计算来估算显式模拟深对流（一种关键的天气和气候现象）所需的最小分辨率，从而将物理过程的尺度与模型设计直接联系起来。",
            "id": "3909097",
            "problem": "一个旨在显式表示深对流的区域气候模型（RCM）必须配置足够精细的水平网格间距，以解析对流云中的主上升气流核心。将对流上升气流核心视为在不可压缩流动的布辛涅斯克近似（Boussinesq approximation）下的轴对称湍流浮力羽流。在高度 $z$ 处，该核心具有顶帽式（top-hat）垂直速度剖面 $w(z)$ 和半径 $r(z)$。体积通量为 $Q(z) = \\pi r(z)^{2} w(z)$。在湍流浮力羽流理论中，Morton–Taylor–Turner 的经典夹卷假说（entrainment hypothesis）假定羽流边缘的运动学夹卷速度 $u_{e}(z)$ 与局地垂直速度大小成比例，即 $u_{e}(z) = \\alpha w(z)$，其中 $\\alpha$ 是一个无量纲的夹卷系数，用于表征湍流混合进入羽流的过程。使用轴对称连续性方程和夹卷假说，进行尺度分析以获得上升气流半径 $r(z)$ 的主导阶高度依赖关系，并由此评估在指定对流层中层高度处的上升气流直径。\n\n假设在一个区域气候模型框架中，深对流羽流具有以下科学上合理的参数：\n- 云底高度 $z_{0} = 1.5$ km。\n- 云底处的初始核心半径 $r_{0} = 0.30$ km。\n- 对流层中层分析高度 $z_{m} = 6.0$ km。\n- 恒定夹卷系数 $\\alpha = 0.12$。\n\n采纳广泛使用的数值分辨率准则，即显式解析一个相干的上升气流需要至少 $m = 6$ 个网格点横跨其直径。推导满足此准则的最小水平网格间距 $\\Delta x_{\\min}$ 的闭式表达式（用 $r(z_{m})$ 和 $m$ 表示），然后使用上述参数计算 $\\Delta x_{\\min}$ 的数值。\n\n将您的最终数值答案四舍五入至三位有效数字。以 km 为单位表示 $\\Delta x_{\\min}$。",
            "solution": "问题陈述已经过严格验证，被认为是科学上成立、适定且客观的。它基于经典的 Morton-Taylor-Turner 湍流浮力羽流理论，这是流体动力学和大气科学中的一个标准模型。所有必要的参数和条件均已提供，并且对于深层大气对流而言，这些参数和条件在物理上是合理的。因此，该问题是有效的，并将提供解答。\n\n主要目标是确定在区域气候模型（RCM）中显式解析对流上升气流核心所需的最小水平网格间距，问题中将其称为 $\\Delta x_{\\min}$。这需要将模型的网格分辨率与上升气流的物理尺寸联系起来。解答过程分为四个阶段：(1) 推导上升气流半径 $r(z)$ 的高度依赖关系；(2) 计算指定分析高度 $z_m$ 处的上升气流直径；(3) 建立网格分辨率要求；(4) 计算网格间距的最终数值。\n\n首先，我们将上升气流核心建模为轴对称湍流浮力羽流。体积通量 $Q(z) = \\pi r(z)^2 w(z)$ 随高度 $z$ 的变化是由于周围空气的夹卷。单位高度上的夹卷体积流率是羽流周长 $2\\pi r(z)$ 和夹卷速度 $u_e(z)$ 的乘积。因此，质量守恒（或在不可压缩假设下的体积守恒）表示为：\n$$\n\\frac{dQ}{dz} = 2\\pi r u_e\n$$\n问题指定了 Morton-Taylor-Turner 夹卷假说，该假说假定夹卷速度与局地上升气流速度 $w(z)$ 成正比：\n$$\nu_e(z) = \\alpha w(z)\n$$\n其中 $\\alpha$ 是无量纲的夹卷系数。\n\n将 $Q(z)$ 和 $u_e(z)$ 的表达式代入守恒方程，得到：\n$$\n\\frac{d}{dz}(\\pi r^2 w) = 2\\pi r (\\alpha w)\n$$\n两边除以 $\\pi$ 并简化，得到羽流演变的基本方程：\n$$\n\\frac{d}{dz}(r^2 w) = 2 \\alpha r w\n$$\n要求解 $r(z)$ 和 $w(z)$ 的完整解，还需要一个额外的方程，通常是垂直动量守恒方程。然而，问题要求进行“尺度分析以获得主导阶的高度依赖关系”。浮力羽流理论的一个基本结果是，羽流随高度线性扩展，这可以从控制方程的更详细分析中推导出来。这对应于一个圆锥形状，其中半径随高度的变化率是恒定的。这个恒定的扩展率与夹卷系数 $\\alpha$ 直接成正比。对于顶帽式剖面，该关系的主导阶由以下给出：\n$$\n\\frac{dr}{dz} = \\alpha\n$$\n这个线性常微分方程描述了圆锥的半径。我们可以通过从云底条件（在 $z=z_0$ 时 $r=r_0$）到一般高度 $z$ 的直接积分来求解它。\n$$\n\\int_{r_0}^{r(z)} dr' = \\int_{z_0}^{z} \\alpha dz'\n$$\n因为 $\\alpha$ 是给定的常数，积分得到：\n$$\nr(z) - r_0 = \\alpha (z - z_0)\n$$\n因此，上升气流半径作为高度函数的表达式是：\n$$\nr(z) = r_0 + \\alpha (z - z_0)\n$$\n接下来，我们在指定的对流层中层分析高度 $z_m = 6.0$ km 处计算该半径。给定参数为云底高度 $z_0 = 1.5$ km，初始半径 $r_0 = 0.30$ km，以及夹卷系数 $\\alpha = 0.12$。\n$$\nr(z_m) = 0.30 \\text{ km} + 0.12 \\times (6.0 \\text{ km} - 1.5 \\text{ km})\n$$\n$$\nr(z_m) = 0.30 + 0.12 \\times 4.5\n$$\n$$\nr(z_m) = 0.30 + 0.54 = 0.84 \\text{ km}\n$$\n在此高度的上升气流直径 $D(z_m)$ 是半径的两倍：\n$$\nD(z_m) = 2 r(z_m) = 2 \\times 0.84 \\text{ km} = 1.68 \\text{ km}\n$$\n问题接着引入了一个数值分辨率准则：至少需要 $m = 6$ 个网格点横跨上升气流直径。如果 $\\Delta x$ 是水平网格间距，则横跨直径 $D(z_m)$ 的网格点数为 $D(z_m) / \\Delta x$。因此，该准则为：\n$$\n\\frac{D(z_m)}{\\Delta x} \\ge m\n$$\n对 $\\Delta x$ 求解，我们得到对网格间距的约束：\n$$\n\\Delta x \\le \\frac{D(z_m)}{m}\n$$\n这个不等式定义了为满足分辨率要求所允许的最大网格间距 $\\Delta x_{\\max} = D(z_m)/m$。任何大于 $\\Delta x_{\\max}$ 的网格间距 $\\Delta x$ 都会对此特征造成解析不足。问题中的术语 $\\Delta x_{\\min}$ 被解释为这个临界阈值，代表了勉强可接受的最粗（最大）网格间距。\n\n通过代入我们对 $D(z_m)$ 和 $r(z_m)$ 的表达式，可以获得该网格间距的闭式表达式：\n$$\n\\Delta x_{\\min} = \\frac{D(z_m)}{m} = \\frac{2 r(z_m)}{m} = \\frac{2 [r_0 + \\alpha (z_m - z_0)]}{m}\n$$\n最后，我们使用先前计算的直径 $D(z_m) = 1.68$ km 和给定的值 $m=6$ 来计算 $\\Delta x_{\\min}$ 的数值：\n$$\n\\Delta x_{\\min} = \\frac{1.68 \\text{ km}}{6} = 0.28 \\text{ km}\n$$\n问题要求将最终答案四舍五入至三位有效数字。因此，我们将结果表示为 $0.280$ km。",
            "answer": "$$\n\\boxed{0.280}\n$$"
        },
        {
            "introduction": "由于许多重要的大气过程发生在比模型网格更小的尺度上，RCMs 必须依赖参数化方案来描述它们的影响。本练习  深入探讨了莫宁-奥布霍夫相似性理论（Monin-Obukhov similarity theory），这是地表-大气交换参数化方案的基石。通过计算莫宁-奥布霍夫长度（$L$），您将学会如何诊断近地表大气的稳定度，并理解其在调节热量和动量湍流通量中的关键作用。",
            "id": "3909137",
            "problem": "一个区域气候模型采用基于 Monin–Obukhov 相似性理论的一阶地表层方案来表示地表与大气之间的湍流交换。考虑一个白天的陆地格点列，其诊断出的近地表条件如下：摩擦速度 $u_{*} = 0.45~\\text{m s}^{-1}$，地表感热通量 $Q_{h} = 180~\\text{W m}^{-2}$，空气密度 $\\rho = 1.15~\\text{kg m}^{-3}$，定压比热 $c_{p} = 1004~\\text{J kg}^{-1}\\text{K}^{-1}$，von Kármán 常数 $\\kappa = 0.40$，重力加速度 $g = 9.81~\\text{m s}^{-2}$，以及近地表绝对温度 $T_{0} = 305~\\text{K}$。假设虚温效应可以忽略不计，因此虚位温可以近似为 $T_{0}$。\n\n从 Monin–Obukhov 相似性理论的基本陈述以及摩擦速度、运动热通量和浮力通量的定义出发，通过消除未观测的量，推导出 Monin–Obukhov 长度 $L$ 关于 $u_{*}$、$Q_{h}$、$\\rho$、$c_{p}$、$\\kappa$、$g$ 和 $T_{0}$ 的表达式。然后，根据给定条件计算 $L$ 的值。\n\n最后，利用地表层内 $L$ 的符号，定性地解释大气稳定度如何影响动量和热量的整体地表交换系数（此处表示为 $C_{D}$ 和 $C_{H}$）相对于中性条件的变化。\n\n以米为单位表示 Monin–Obukhov 长度的最终数值，并将您的答案四舍五入到三位有效数字。最终答案必须是单个数字。",
            "solution": "经评估，该问题陈述有效。其科学依据是 Monin–Obukhov 相似性理论的既定原理，这是大气边界层物理学的一个基本框架。所有提供的数据在物理上都是真实且一致的，且问题是适定的，可以导出一个唯一的、有意义的解。所用术语客观而精确。\n\n解答按要求分为三个部分：推导 Monin–Obukhov 长度 ($L$)、计算 $L$ 的数值，以及定性解释大气稳定度对地表交换系数的影响。\n\n**第一部分：Monin–Obukhov 长度 $L$ 的推导**\n\nMonin–Obukhov 长度 $L$ 被定义为衡量机械（切变驱动）湍流与浮力（对流）湍流相对重要性的尺度。其定义为：\n$$ L = - \\frac{u_{*}^3}{\\kappa B_s} $$\n其中 $u_{*}$ 是摩擦速度，$\\kappa$ 是 von Kármán 常数，$B_s$ 是地表浮力通量。\n\n地表浮力通量 $B_s$ 定义为：\n$$ B_s = \\frac{g}{\\theta_{v0}} \\overline{w' \\theta_v'}_s $$\n此处，$g$ 是重力加速度，$\\theta_{v0}$ 是地表层中的参考虚位温，而 $\\overline{w' \\theta_v'}_s$ 是地表运动虚位温通量。问题陈述中指出虚温效应可以忽略，这允许用绝对温度近似虚位温，因此 $\\theta_{v0} \\approx T_0$ 且 $\\overline{w' \\theta_v'}_s \\approx \\overline{w' \\theta'}_s$。$\\overline{w' \\theta'}_s$ 项是地表运动感热通量。因此，浮力通量可以写为：\n$$ B_s \\approx \\frac{g}{T_0} \\overline{w' \\theta'}_s $$\n\n地表感热通量 $Q_h$ 与运动感热通量的关系如下：\n$$ Q_h = \\rho c_p \\overline{w' \\theta'}_s $$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热。可以重排该方程，用给定物理量来求解未观测的量 $\\overline{w' \\theta'}_s$：\n$$ \\overline{w' \\theta'}_s = \\frac{Q_h}{\\rho c_p} $$\n\n将 $\\overline{w' \\theta'}_s$ 的这个表达式代入浮力通量 $B_s$ 的近似方程中：\n$$ B_s \\approx \\frac{g}{T_0} \\left( \\frac{Q_h}{\\rho c_p} \\right) = \\frac{g Q_h}{T_0 \\rho c_p} $$\n\n最后，我们将 $B_s$ 的这个表达式代回 Monin–Obukhov 长度 $L$ 的原始定义中：\n$$ L = - \\frac{u_{*}^3}{\\kappa \\left( \\frac{g Q_h}{T_0 \\rho c_p} \\right)} $$\n简化这个繁分数，得到用给定参数表示的 $L$ 的期望表达式：\n$$ L = - \\frac{u_{*}^3 T_0 \\rho c_p}{\\kappa g Q_h} $$\n\n**第二部分：$L$ 的数值计算**\n\n问题提供了以下数值：\n- $u_{*} = 0.45~\\text{m s}^{-1}$\n- $Q_{h} = 180~\\text{W m}^{-2} = 180~\\text{J s}^{-1}\\text{m}^{-2}$\n- $\\rho = 1.15~\\text{kg m}^{-3}$\n- $c_{p} = 1004~\\text{J kg}^{-1}\\text{K}^{-1}$\n- $\\kappa = 0.40$ (无量纲)\n- $g = 9.81~\\text{m s}^{-2}$\n- $T_{0} = 305~\\text{K}$\n\n将这些值代入推导出的 $L$ 表达式中：\n$$ L = - \\frac{(0.45~\\text{m s}^{-1})^3 (305~\\text{K}) (1.15~\\text{kg m}^{-3}) (1004~\\text{J kg}^{-1}\\text{K}^{-1})}{(0.40) (9.81~\\text{m s}^{-2}) (180~\\text{J s}^{-1}\\text{m}^{-2})} $$\n$$ L = - \\frac{(0.091125~\\text{m}^3\\text{s}^{-3}) (305~\\text{K}) (1.15~\\text{kg m}^{-3}) (1004~\\text{J kg}^{-1}\\text{K}^{-1})}{(0.40) (9.81~\\text{m s}^{-2}) (180~\\text{J s}^{-1}\\text{m}^{-2})} $$\n$$ L = - \\frac{32090.042125~\\text{J s}^{-3}}{706.32~\\text{J m}^{-1}\\text{s}^{-3}} $$\n$$ L \\approx -45.4339~\\text{m} $$\n四舍五入到三位有效数字，Monin–Obukhov 长度为：\n$$ L \\approx -45.4~\\text{m} $$\n\n**第三部分：稳定度对交换系数的定性影响**\n\nMonin–Obukhov 长度 $L$ 是地表层大气稳定度的关键指标。其符号由地表感热通量 $Q_h$ 的方向决定。\n- 如果 $Q_h > 0$（向上的热通量，典型的日间加热），则 $L < 0$，表示**不稳定**（对流）条件。\n- 如果 $Q_h < 0$（向下的热通量，典型的夜间冷却），则 $L > 0$，表示**稳定**（层结）条件。\n- 如果 $Q_h = 0$，则 $L \\to \\infty$，表示**中性**条件，此时浮力效应可忽略不计。\n\n在本问题中，$Q_h = 180~\\text{W m}^{-2}$ 为正值。这导致 $L$ 为负值（$L \\approx -45.4~\\text{m}$），证实了大气地表层是不稳定的。\n\n动量 ($C_D$) 和热量 ($C_H$) 的整体地表交换系数参数化了地表与大气之间湍流输送的效率。它们的大小强烈依赖于大气稳定度。\n\n在**中性条件**下（$L \\to \\infty$），湍流仅由机械风切变产生。这为湍流交换建立了一个基准效率，从而得到中性交换系数 $C_{D,N}$ 和 $C_{H,N}$。\n\n在本文所见的**不稳定条件**下（$L  0$），地表比其上方的空气更暖，产生浮力热羽流。这种浮力成为湍流动能的额外来源，增强了垂直混合的强度。涡旋更有活力，能更有效地将动量和热量从地表输送出去。因此，整体交换系数比中性条件下的要大：\n$$ C_D  C_{D,N} \\quad \\text{and} \\quad C_H  C_{H,N} $$\n这种增强作用通常在热量交换（$C_H$）中比在动量交换（$C_D$）中更为显著。\n\n相反，在稳定条件下（$L  0$），地表比其上方的空气更冷。由此产生的密度层结会抑制垂直运动并削弱湍流。这使得湍流输送效率降低，交换系数变得小于其中性值（$C_D  C_{D,N}$ 且 $C_H  C_{H,N}$）。\n\n因此，计算出的 $L$ 的负号表示不稳定条件，在这种条件下，浮力增强了湍流混合，导致整体地表交换系数 $C_D$ 和 $C_H$ 相对于中性稳定度时有所增加。",
            "answer": "$$ \\boxed{-45.4} $$"
        },
        {
            "introduction": "一个可靠的气候模式必须严格遵守基本的物理守恒定律，如质量守恒和能量守恒。本练习  介绍了一项至关重要的模型诊断技术：检验大气水汽收支的闭合性。通过利用模式输出的降水、蒸发和水汽输送数据计算收支方程的残差，您将获得检验模型内部自洽性、识别潜在数值或物理误差来源的实践经验。",
            "id": "3909119",
            "problem": "考虑一个由区域气候模式 (RCM) 所表示的固定区域范围上的大气水柱收支。该收支受水物质质量守恒定律支配，其中总水柱储存量（单位面积质量）因地表源汇和水平输送而变化。设 $W$ 表示单位面积上整层积分的大气水物质质量（例如，水汽加凝结物），$P$ 表示降水率（单位面积和时间的质量通量），$E$ 表示蒸发率（或表示为等效质量通量的地表潜热通量）（单位面积和时间的质量通量），$\\nabla \\cdot \\mathbf{F}_q$ 表示垂直积分的水汽通量的水平散度（单位面积和时间的质量通量，正值表示净输出）。本问题的基本依据是整层积分的水物质连续性方程：\n$$\n\\frac{dW}{dt} \\;=\\; E \\;-\\; P \\;-\\; \\nabla \\cdot \\mathbf{F}_q.\n$$\n给定几个合成测试用例的模式输出，包括 $P$、$E$、$\\frac{dW}{dt}$ 和 $\\nabla \\cdot \\mathbf{F}_q$ 的时间序列。您的任务是利用上述守恒原理，推导并实现一个用于水柱收支的诊断性残差闭合误差，该误差用以量化所报告的模式项在时间上闭合收支的程度。残差闭合误差应仅根据给定的模式时间序列定义，不使用任何外部数据。对于每个测试用例，计算一个单一的总结性指标：在所提供的时间指数上残差的均方根误差 (RMSE)。\n\n所有量均以毫米/天 (mm/day) 为单位提供和处理，通过液态水的密度，该单位等效于千克/平方米/天。您的程序必须使用基本依据所隐含的收支关系，计算每个用例的残差闭合误差时间序列，然后计算该用例随时间变化的 RMSE。以毫米/天为单位表示每个 RMSE，并四舍五入到三位小数。本问题不涉及角度，因此不需要角度单位。\n\n测试套件：\n- 用例 $1$ (理想情况下的精确闭合):\n  - $P = [4.0, 1.5, 0.0, 2.3]$\n  - $E = [2.0, 1.2, 0.8, 2.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [-0.5, -0.3, 0.1, -0.2]$\n  - $\\frac{dW}{dt} = [-1.5, 0.0, 0.7, -0.1]$\n- 用例 $2$ (储存倾向中的系统性偏差):\n  - $P = [3.0, 4.5, 2.0, 5.0, 1.5]$\n  - $E = [3.0, 4.5, 2.0, 5.0, 1.5]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [0.0, -0.5, 0.1, 0.3, -0.2]$\n  - $\\frac{dW}{dt} = [0.2, 0.7, 0.1, -0.1, 0.4]$\n- 用例 $3$ (对所有项的小的独立扰动；混合符号和大小):\n  - 精确闭合的基础数组:\n    - $P_{\\text{base}} = [2.0, 10.0, 0.5, 5.0, 3.0, 8.0]$\n    - $E_{\\text{base}} = [1.5, 7.0, 0.7, 3.5, 2.5, 6.5]$\n    - $\\nabla \\cdot \\mathbf{F}_{q,\\text{base}} = [0.1, -1.0, 0.0, 0.4, -0.2, -0.5]$\n    - $\\left(\\frac{dW}{dt}\\right)_{\\text{base}} = [-0.6, -2.0, 0.2, -1.9, -0.3, -1.0]$\n  - 应用扰动（逐元素相加）以获得模式输出:\n    - $\\Delta P = [0.05, -0.10, 0.00, 0.20, -0.15, 0.10]$\n    - $\\Delta E = [-0.05, 0.00, 0.10, -0.10, 0.00, -0.20]$\n    - $\\Delta(\\nabla \\cdot \\mathbf{F}_q) = [0.02, -0.05, 0.00, 0.03, -0.01, 0.04]$\n    - $\\Delta\\left(\\frac{dW}{dt}\\right) = [0.00, 0.10, -0.05, 0.00, 0.05, -0.10]$\n  - 最终模式数组:\n    - $P = P_{\\text{base}} + \\Delta P$\n    - $E = E_{\\text{base}} + \\Delta E$\n    - $\\nabla \\cdot \\mathbf{F}_q = \\nabla \\cdot \\mathbf{F}_{q,\\text{base}} + \\Delta(\\nabla \\cdot \\mathbf{F}_q)$\n    - $\\frac{dW}{dt} = \\left(\\frac{dW}{dt}\\right)_{\\text{base}} + \\Delta\\left(\\frac{dW}{dt}\\right)$\n- 用例 $4$ (具有单步不匹配的极端事件):\n  - $P = [100.0, 0.0, 25.0]$\n  - $E = [5.0, 2.0, 10.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [-10.0, 0.0, 5.0]$\n  - $\\frac{dW}{dt} = [-84.5, 2.0, -20.0]$\n- 用例 $5$ (所有项为零，精确闭合):\n  - $P = [0.0, 0.0, 0.0, 0.0]$\n  - $E = [0.0, 0.0, 0.0, 0.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [0.0, 0.0, 0.0, 0.0]$\n  - $\\frac{dW}{dt} = [0.0, 0.0, 0.0, 0.0]$\n\n您的程序必须：\n- 为每个测试用例实现上述守恒定律所隐含的残差闭合误差时间序列。\n- 对每个用例，计算在所提供的时间指数上的残差的 RMSE。\n- 输出一行，其中包含按顺序排列的用例 1 到 5 的 RMSE 值，形式为用方括号括起来的逗号分隔列表，每个值以毫米/天为单位，并四舍五入到三位小数，例如 `[x_1,x_2,x_3,x_4,x_5]`。\n\n您的最终输出必须以毫米/天为单位，并且必须是包含 5 个浮点数的列表，这些浮点数四舍五入到三位小数，并按指定格式打印在单行上。",
            "solution": "本问题已经过验证。\n\n### 步骤 1：提取已知信息\n整层积分水物质连续性的基本控制方程如下：\n$$\n\\frac{dW}{dt} \\;=\\; E \\;-\\; P \\;-\\; \\nabla \\cdot \\mathbf{F}_q\n$$\n其中：\n- $W$ 是单位面积上整层积分的大气水物质质量。\n- $\\frac{dW}{dt}$ 是 $W$ 的变化率。\n- $E$ 是蒸发率（单位面积和时间的质量通量）。\n- $P$ 是降水率（单位面积和时间的质量通量）。\n- $\\nabla \\cdot \\mathbf{F}_q$ 是垂直积分水汽通量的水平散度（单位面积和时间的质量通量）。\n所有量的单位均为毫米/天 (mm/day)。\n\n提供了五个测试用例，每个用例都包含 $P$、$E$、$\\frac{dW}{dt}$ 和 $\\nabla \\cdot \\mathbf{F}_q$ 的时间序列数据。\n- **用例 1**：\n  - $P = [4.0, 1.5, 0.0, 2.3]$\n  - $E = [2.0, 1.2, 0.8, 2.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [-0.5, -0.3, 0.1, -0.2]$\n  - $\\frac{dW}{dt} = [-1.5, 0.0, 0.7, -0.1]$\n- **用例 2**：\n  - $P = [3.0, 4.5, 2.0, 5.0, 1.5]$\n  - $E = [3.0, 4.5, 2.0, 5.0, 1.5]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [0.0, -0.5, 0.1, 0.3, -0.2]$\n  - $\\frac{dW}{dt} = [0.2, 0.7, 0.1, -0.1, 0.4]$\n- **用例 3**：数据以基础数组和扰动量的形式提供，必须将它们组合起来。\n  - $P_{\\text{base}} = [2.0, 10.0, 0.5, 5.0, 3.0, 8.0]$, $\\Delta P = [0.05, -0.10, 0.00, 0.20, -0.15, 0.10]$\n  - $E_{\\text{base}} = [1.5, 7.0, 0.7, 3.5, 2.5, 6.5]$, $\\Delta E = [-0.05, 0.00, 0.10, -0.10, 0.00, -0.20]$\n  - $\\nabla \\cdot \\mathbf{F}_{q,\\text{base}} = [0.1, -1.0, 0.0, 0.4, -0.2, -0.5]$, $\\Delta(\\nabla \\cdot \\mathbf{F}_q) = [0.02, -0.05, 0.00, 0.03, -0.01, 0.04]$\n  - $(\\frac{dW}{dt})_{\\text{base}} = [-0.6, -2.0, 0.2, -1.9, -0.3, -1.0]$, $\\Delta(\\frac{dW}{dt}) = [0.00, 0.10, -0.05, 0.00, 0.05, -0.10]$\n- **用例 4**：\n  - $P = [100.0, 0.0, 25.0]$\n  - $E = [5.0, 2.0, 10.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [-10.0, 0.0, 5.0]$\n  - $\\frac{dW}{dt} = [-84.5, 2.0, -20.0]$\n- **用例 5**：\n  - $P = [0.0, 0.0, 0.0, 0.0]$\n  - $E = [0.0, 0.0, 0.0, 0.0]$\n  - $\\nabla \\cdot \\mathbf{F}_q = [0.0, 0.0, 0.0, 0.0]$\n  - $\\frac{dW}{dt} = [0.0, 0.0, 0.0, 0.0]$\n\n任务是为每个用例计算残差闭合误差的均方根误差 (RMSE)，并四舍五入到三位小数。\n\n### 步骤 2：使用提取的已知信息进行验证\n1.  **科学性基础**：该问题基于大气水柱中水的质量守恒原理。控制方程是大气科学和区域气候模拟中一个标准的、基本的关系式。它在科学上是合理的。\n2.  **良态问题**：问题要求从给定的数据集中计算一个诊断性指标 (RMSE)。残差的定义可以从控制方程中明确推导出来。对于每组输入时间序列，都可以计算出一个唯一的 RMSE 值。这是一个良态问题。\n3.  **客观性**：问题使用精确、标准的科学术语进行陈述。数据是数值型的，要求的计算是标准的统计操作。问题不含主观或基于观点的内容。\n4.  **完整性和一致性**：为每个测试用例提供了所有必要的数据和定义。所有项的单位 (mm/day) 都是一致的。所提供的信息中没有矛盾。\n5.  **无其他缺陷**：该问题是将物理原理应用于数值数据的直接应用，是典型的模型评估任务。它不是隐喻性的、琐碎的、病态的或无法验证的。\n\n### 步骤 3：结论与行动\n本问题有效。将开发一个解决方案。\n\n此问题的核心是质量守恒原理。所提供的方程，\n$$\n\\frac{dW}{dt} \\;=\\; E \\;-\\; P \\;-\\; \\nabla \\cdot \\mathbf{F}_q\n$$\n表明大气水柱中水储量的变化率 $\\frac{dW}{dt}$ 必须与进入水柱的净水通量完全平衡。这些通量包括地表蒸发 ($E$)、从水柱中降水 ($P$) 以及从水柱中净水平输送的水汽 ($\\nabla \\cdot \\mathbf{F}_q$)。\n\n在一个完美的数值模型中，独立计算的各项在每个时间步都应满足此方程。然而，由于数值方案、时空离散化或物理参数化中的近似，收支可能无法完美闭合。一个我们记为 $R$ 的残差闭合误差，量化了这种不平衡。\n\n为了定义 $R$，我们将守恒方程重排为一个在完美闭合时等于零的形式：\n$$\n\\frac{dW}{dt} - (E - P - \\nabla \\cdot \\mathbf{F}_q) = 0\n$$\n残差 $R$ 是用模式输出项计算时方程左侧的值：\n$$\nR = \\frac{dW}{dt} - E + P + \\nabla \\cdot \\mathbf{F}_q\n$$\n由于输入是时间序列，我们为序列中的每个时间指数 $i$ 计算一个残差值 $R_i$：\n$$\nR_i = \\left(\\frac{dW}{dt}\\right)_i - E_i + P_i + (\\nabla \\cdot \\mathbf{F}_q)_i\n$$\n问题要求对此残差时间序列计算一个单一的总结性指标，即均方根误差 (RMSE)。对于长度为 $N$ 的残差时间序列 $R$，RMSE 的计算公式为：\n$$\nRMSE = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} R_i^2}\n$$\n该指标提供了预算不平衡在时间段内的平均大小，单位为 mm/day。\n\n要实现的算法如下：\n1.  对于每个测试用例，获取 $P$、$E$、$\\frac{dW}{dt}$ 和 $\\nabla \\cdot \\mathbf{F}_q$ 的时间序列。对于用例 3，这包括将基础数组和扰动数组相加。\n2.  对于用例中的每个时间指数 $i$，使用推导出的公式计算残差 $R_i$。\n3.  一旦获得完整的残差时间序列 $R = [R_1, R_2, ..., R_N]$，计算其 RMSE。\n4.  将最终的 RMSE 四舍五入到三位小数。\n5.  收集所有用例的结果并按指定格式进行格式化。\n\n例如，让我们计算用例 1 第一个时间步的残差：\n- $P_1 = 4.0$\n- $E_1 = 2.0$\n- $(\\nabla \\cdot \\mathbf{F}_q)_1 = -0.5$\n- $(\\frac{dW}{dt})_1 = -1.5$\n残差为：\n$$\nR_1 = (-1.5) - (2.0) + (4.0) + (-0.5) = -1.5 - 2.0 + 4.0 - 0.5 = 0.0\n$$\n对所有时间步重复此操作。对于用例 1，所有残差均为 $0.0$，表示完美闭合，因此 RMSE 为 $0.0$。\n\n对于用例 2，在第一个时间步：\n- $P_1 = 3.0$\n- $E_1 = 3.0$\n- $(\\nabla \\cdot \\mathbf{F}_q)_1 = 0.0$\n- $(\\frac{dW}{dt})_1 = 0.2$\n残差为：\n$$\nR_1 = (0.2) - (3.0) + (3.0) + (0.0) = 0.2\n$$\n在这种情况下，所有时间步的残差始终为 $0.2$，因此 RMSE 也为 $0.2$。\n\n实现将把此过程应用于所有五个用例。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMSE of the water budget residual for five test cases.\n    \"\"\"\n\n    def calculate_rmse(P, E, divFq, dWdt):\n        \"\"\"\n        Calculates the RMSE of the water budget residual for a single case.\n        Args:\n            P (list or np.ndarray): Precipitation time series.\n            E (list or np.ndarray): Evaporation time series.\n            divFq (list or np.ndarray): Moisture flux divergence time series.\n            dWdt (list or np.ndarray): Water storage tendency time series.\n        Returns:\n            float: The calculated RMSE.\n        \"\"\"\n        P_arr = np.array(P)\n        E_arr = np.array(E)\n        divFq_arr = np.array(divFq)\n        dWdt_arr = np.array(dWdt)\n\n        # R = dW/dt - (E - P - divFq) = dW/dt - E + P + divFq\n        residual = dWdt_arr - E_arr + P_arr + divFq_arr\n        \n        # RMSE = sqrt(mean(residual^2))\n        rmse = np.sqrt(np.mean(np.square(residual)))\n        \n        return rmse\n\n    # --- Test Case Definitions ---\n\n    # Case 1 (happy path exact closure)\n    case1_data = {\n        \"P\": [4.0, 1.5, 0.0, 2.3],\n        \"E\": [2.0, 1.2, 0.8, 2.0],\n        \"divFq\": [-0.5, -0.3, 0.1, -0.2],\n        \"dWdt\": [-1.5, 0.0, 0.7, -0.1]\n    }\n\n    # Case 2 (systematic bias in storage tendency)\n    case2_data = {\n        \"P\": [3.0, 4.5, 2.0, 5.0, 1.5],\n        \"E\": [3.0, 4.5, 2.0, 5.0, 1.5],\n        \"divFq\": [0.0, -0.5, 0.1, 0.3, -0.2],\n        \"dWdt\": [0.2, 0.7, 0.1, -0.1, 0.4]\n    }\n\n    # Case 3 (small independent perturbations)\n    # Construct final model arrays from base and perturbation arrays.\n    P_base_3 = np.array([2.0, 10.0, 0.5, 5.0, 3.0, 8.0])\n    delta_P_3 = np.array([0.05, -0.10, 0.00, 0.20, -0.15, 0.10])\n    \n    E_base_3 = np.array([1.5, 7.0, 0.7, 3.5, 2.5, 6.5])\n    delta_E_3 = np.array([-0.05, 0.00, 0.10, -0.10, 0.00, -0.20])\n\n    divFq_base_3 = np.array([0.1, -1.0, 0.0, 0.4, -0.2, -0.5])\n    delta_divFq_3 = np.array([0.02, -0.05, 0.00, 0.03, -0.01, 0.04])\n    \n    dWdt_base_3 = np.array([-0.6, -2.0, 0.2, -1.9, -0.3, -1.0])\n    delta_dWdt_3 = np.array([0.00, 0.10, -0.05, 0.00, 0.05, -0.10])\n    \n    case3_data = {\n        \"P\": (P_base_3 + delta_P_3).tolist(),\n        \"E\": (E_base_3 + delta_E_3).tolist(),\n        \"divFq\": (divFq_base_3 + delta_divFq_3).tolist(),\n        \"dWdt\": (dWdt_base_3 + delta_dWdt_3).tolist()\n    }\n\n    # Case 4 (extreme event with one-step mismatch)\n    case4_data = {\n        \"P\": [100.0, 0.0, 25.0],\n        \"E\": [5.0, 2.0, 10.0],\n        \"divFq\": [-10.0, 0.0, 5.0],\n        \"dWdt\": [-84.5, 2.0, -20.0]\n    }\n\n    # Case 5 (all zero terms, exact closure)\n    case5_data = {\n        \"P\": [0.0, 0.0, 0.0, 0.0],\n        \"E\": [0.0, 0.0, 0.0, 0.0],\n        \"divFq\": [0.0, 0.0, 0.0, 0.0],\n        \"dWdt\": [0.0, 0.0, 0.0, 0.0]\n    }\n\n    test_cases = [case1_data, case2_data, case3_data, case4_data, case5_data]\n\n    results = []\n    for case in test_cases:\n        rmse_val = calculate_rmse(\n            P=case[\"P\"],\n            E=case[\"E\"],\n            divFq=case[\"divFq\"],\n            dWdt=case[\"dWdt\"]\n        )\n        results.append(rmse_val)\n\n    # Format the final output as a comma-separated list of strings,\n    # each rounded to three decimal places.\n    # formatted_results = [f\"{val:.3f}\" for val in results]\n    # print(f\"[{','.join(formatted_results)}]\")\n\n# solve() # The function is not called to prevent output during XML generation\n```",
            "answer": "[0.000, 0.200, 0.191, 0.289, 0.000]"
        }
    ]
}