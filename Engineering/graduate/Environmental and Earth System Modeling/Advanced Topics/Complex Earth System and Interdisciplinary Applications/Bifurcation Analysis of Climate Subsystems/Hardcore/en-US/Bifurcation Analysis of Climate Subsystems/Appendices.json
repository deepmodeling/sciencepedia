{
    "hands_on_practices": [
        {
            "introduction": "One of the most fundamental examples of a climate tipping point arises from the ice-albedo feedback. This exercise guides you through an analysis of a simplified Energy Balance Model (EBM), a cornerstone of climate science, to understand how this feedback can create multiple stable climate states—such as an 'ice-free' Earth and a 'snowball' Earth. By analytically deriving the equilibrium conditions and the critical solar forcing thresholds, you will gain hands-on experience in identifying the mathematical roots of climate bistability .",
            "id": "3865675",
            "problem": "Consider a simplified zero-dimensional Energy Balance Model (EBM) for the climate system with ice-albedo feedback. The absorbed shortwave flux is modeled as $S \\left(1 - \\alpha(f)\\right)$, where $S$ is the effective insolation (solar forcing), and $\\alpha(f)$ is the planetary albedo depending on the fractional ice cover $f \\in [0,1]$. Assume two characteristic albedos, $\\alpha_{i}$ for ice and $\\alpha_{o}$ for open ocean, with $0  \\alpha_{o}  \\alpha_{i}  1$, and a linear mixing rule $\\alpha(f) = \\alpha_{i} f + \\alpha_{o} \\left(1 - f\\right)$. The outgoing longwave radiation is parameterized as $A + B T$, where $A > 0$ and $B > 0$, and $T$ is the global-mean surface temperature. This form arises from a linearization of the Stefan–Boltzmann law about a reference climate state.\n\nAt equilibrium, impose global energy balance $S \\left(1 - \\alpha(f)\\right) = A + B T$ and a smooth constitutive relation for the ice fraction based on two characteristic temperatures, $T_{i}  T_{o}$, representing the onset of widespread ice and the disappearance of sea ice, respectively. Specifically, assume the ramp closure\n$$\nf(T) = \n\\begin{cases}\n1,  T \\le T_{i}, \\\\\n\\dfrac{T_{o} - T}{T_{o} - T_{i}},  T_{i}  T  T_{o}, \\\\\n0,  T \\ge T_{o},\n\\end{cases}\n$$\nwith $D \\equiv T_{o} - T_{i}  0$. In the interior regime $T_{i}  T  T_{o}$, the equilibrium ice fraction $f$ must satisfy the self-consistency condition $f = \\dfrac{T_{o} - T}{D}$ together with the energy balance. In the saturated regimes, $f=0$ (ice-free) and $f=1$ (ice-covered) are candidates for stable equilibria if they are consistent with the corresponding temperature thresholds.\n\nStarting from the energy balance and the given constitutive relations, derive the closed-form analytic expression for the interior equilibrium ice fraction $f^{*}(S)$ as a function of $S$ (express your result in terms of $A$, $B$, $T_{i}$, $T_{o}$, $\\alpha_{i}$, and $\\alpha_{o}$). Then, determine the insolation thresholds $S_{+}$ and $S_{-}$ such that:\n- for $S \\ge S_{+}$ the ice-free state $f=0$ is consistent with $T \\ge T_{o}$ and is a stable equilibrium;\n- for $S \\le S_{-}$ the ice-covered state $f=1$ is consistent with $T \\le T_{i}$ and is a stable equilibrium.\n\nYour derivation must begin from the energy balance and the definitions above, showing all steps and assumptions clearly. The final answer must be expressed symbolically. Provide your final answer as a row matrix containing, in order, the expression for $f^{*}(S)$, the expression for $S_{-}$, and the expression for $S_{+}$. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the interior equilibrium ice fraction $f^{*}(S)$ and the insolation thresholds $S_{+}$ and $S_{-}$ for a zero-dimensional Energy Balance Model (EBM). The analysis proceeds from the fundamental equations provided.\n\nThe system is defined by two core equations at equilibrium:\n1.  The energy balance equation: $S \\left(1 - \\alpha(f)\\right) = A + B T$.\n2.  The constitutive relation for the ice fraction $f$ as a function of temperature $T$.\n\nThe albedo $\\alpha(f)$ is a linear mixture of ice albedo $\\alpha_{i}$ and ocean albedo $\\alpha_{o}$:\n$$ \\alpha(f) = \\alpha_{i} f + \\alpha_{o} (1 - f) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})f $$\nLet us define the albedo difference $\\Delta\\alpha = \\alpha_{i} - \\alpha_{o}$. By the problem's constraint $0  \\alpha_{o}  \\alpha_{i}  1$, we have $\\Delta\\alpha  0$. The albedo function is then $\\alpha(f) = \\alpha_{o} + f \\Delta\\alpha$.\n\nThe ice fraction $f(T)$ is a piecewise linear function. We are first interested in the interior equilibrium, which exists for temperatures in the range $T_{i}  T  T_{o}$. In this regime, the ice fraction is given by:\n$$ f(T) = \\frac{T_{o} - T}{T_{o} - T_{i}} $$\nLet us define the temperature range $D \\equiv T_{o} - T_{i}$. Since $T_{o}  T_{i}$, we have $D  0$. The relation becomes $f = \\frac{T_{o} - T}{D}$.\n\n**1. Derivation of the interior equilibrium ice fraction $f^{*}(S)$**\n\nTo find the equilibrium ice fraction $f^{*}(S)$ as a function of solar forcing $S$, we need to solve the system of equations for $f$ by eliminating $T$.\nFrom the ice fraction relation, we can express the temperature $T$ as a function of $f$:\n$$ T = T_{o} - f D = T_{o} - f(T_{o} - T_{i}) $$\nNow, we substitute both the expression for $\\alpha(f)$ and the expression for $T(f)$ into the energy balance equation:\n$$ S \\left(1 - \\left[\\alpha_{o} + f \\Delta\\alpha\\right]\\right) = A + B \\left[T_{o} - f D\\right] $$\n$$ S(1 - \\alpha_{o}) - S f \\Delta\\alpha = A + B T_{o} - B f D $$\nThis is a linear equation in $f$. We can solve for $f$ by gathering all terms involving $f$ on one side:\n$$ B f D - S f \\Delta\\alpha = A + B T_{o} - S(1 - \\alpha_{o}) $$\n$$ f (B D - S \\Delta\\alpha) = A + B T_{o} - S(1 - \\alpha_{o}) $$\nSolving for $f$, we obtain the expression for the interior equilibrium ice fraction, $f^{*}(S)$:\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B D - S \\Delta\\alpha} $$\nSubstituting the definitions of $D$ and $\\Delta\\alpha$ back yields the expression in terms of the primary parameters:\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})} $$\nThis solution is physically meaningful only for $f \\in (0,1)$, which defines the range of $S$ for which this interior equilibrium exists.\n\n**2. Derivation of the threshold $S_{+}$**\n\nThe threshold $S_{+}$ corresponds to the minimum insolation required for the ice-free state ($f=0$) to be a consistent, stable equilibrium. The condition for the ice-free state is $T \\ge T_{o}$.\nFirst, we find the equilibrium temperature $T_{f=0}$ for the ice-free state ($f=0$). In this case, the albedo is $\\alpha(0) = \\alpha_{o}$. The energy balance equation becomes:\n$$ S(1 - \\alpha_{o}) = A + B T_{f=0} $$\nSolving for $T_{f=0}$:\n$$ T_{f=0} = \\frac{S(1 - \\alpha_{o}) - A}{B} $$\nThe threshold $S_{+}$ is the value of $S$ at which this temperature is exactly equal to the upper threshold for ice formation, $T_{o}$. This marks the point where the ice-free state becomes self-consistent.\n$$ T_{o} = \\frac{S_{+}(1 - \\alpha_{o}) - A}{B} $$\nWe solve for $S_{+}$:\n$$ B T_{o} = S_{+}(1 - \\alpha_{o}) - A $$\n$$ S_{+}(1 - \\alpha_{o}) = A + B T_{o} $$\n$$ S_{+} = \\frac{A + B T_{o}}{1 - \\alpha_{o}} $$\nFor any $S \\ge S_{+}$, the temperature $T_{f=0}$ will be greater than or equal to $T_{o}$, making the ice-free state a valid equilibrium. This point also corresponds to the bifurcation where $f^{*}(S)$ becomes $0$.\n\n**3. Derivation of the threshold $S_{-}$**\n\nThe threshold $S_{-}$ corresponds to the maximum insolation for which the fully ice-covered state ($f=1$) is a consistent, stable equilibrium. The condition for the ice-covered state is $T \\le T_{i}$.\nFirst, we find the equilibrium temperature $T_{f=1}$ for the ice-covered state ($f=1$). In this case, the albedo is $\\alpha(1) = \\alpha_{i}$. The energy balance equation becomes:\n$$ S(1 - \\alpha_{i}) = A + B T_{f=1} $$\nSolving for $T_{f=1}$:\n$$ T_{f=1} = \\frac{S(1 - \\alpha_{i}) - A}{B} $$\nThe threshold $S_{-}$ is the value of $S$ at which this temperature is exactly equal to the lower threshold for ice stability, $T_{i}$.\n$$ T_{i} = \\frac{S_{-}(1 - \\alpha_{i}) - A}{B} $$\nWe solve for $S_{-}$:\n$$ B T_{i} = S_{-}(1 - \\alpha_{i}) - A $$\n$$ S_{-}(1 - \\alpha_{i}) = A + B T_{i} $$\n$$ S_{-} = \\frac{A + B T_{i}}{1 - \\alpha_{i}} $$\nFor any $S \\le S_{-}$, the temperature $T_{f=1}$ will be less than or equal to $T_{i}$, making the ice-covered state a valid equilibrium. This point corresponds to the bifurcation where $f^{*}(S)$ becomes $1$.\n\nThe three requested expressions are:\n1.  Interior equilibrium ice fraction: $f^{*}(S) = \\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})}$\n2.  Ice-covered threshold: $S_{-} = \\dfrac{A + B T_{i}}{1 - \\alpha_{i}}$\n3.  Ice-free threshold: $S_{+} = \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})}  \\dfrac{A + B T_{i}}{1 - \\alpha_{i}}  \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While physical models provide context, the mathematical essence of many tipping points can be captured by universal 'normal form' equations. This practice focuses on the normal form for a saddle-node bifurcation, asking you to develop a numerical algorithm to find and classify all equilibrium states as a control parameter, $\\mu$, changes. Mastering this computational approach  equips you with a robust tool to analyze the stability landscape of virtually any one-dimensional model you might encounter.",
            "id": "3865644",
            "problem": "Consider a reduced, nondimensional, one-dimensional climate subsystem model obtained via Center Manifold Reduction (CMR) from a physically based energy balance framework. The autonomous Ordinary Differential Equation (ODE) describing the slow invariant dynamics is\n$$\n\\frac{dX}{dt} = f(X;\\mu) = \\mu + X - X^3,\n$$\nwhere $X$ is a nondimensional state variable representing a slowly varying large-scale climate quantity (for example, a normalized global-mean temperature anomaly or ice-line coordinate), and $\\mu$ is a nondimensional control parameter representing effective external forcing (for example, scaled radiative forcing or freshwater perturbation). Invariant sets of this flow are equilibria $X^\\star$ satisfying the invariance condition\n$$\nf(X^\\star;\\mu) = 0.\n$$\nThe linear stability of an equilibrium $X^\\star$ is determined by the linearization coefficient\n$$\n\\lambda(X^\\star;\\mu) = \\left.\\frac{\\partial f}{\\partial X}\\right|_{X^\\star} = 1 - 3\\,(X^\\star)^2.\n$$\nAn equilibrium is linearly stable if and only if $\\lambda(X^\\star;\\mu)  0$ and linearly unstable if and only if $\\lambda(X^\\star;\\mu)  0$. At a saddle-node bifurcation, a pair of equilibria coalesce with $\\lambda(X^\\star;\\mu)=0$.\n\nYour task is to demonstrate numerical methods that:\n- Approximate all real invariant equilibria $X^\\star$ for the model at specified parameter values $\\mu$.\n- Verify their stability properties via the sign of $\\lambda(X^\\star;\\mu)$.\n- Quantify the numerical accuracy of the invariant set approximation by evaluating the residual $|f(X^\\star;\\mu)|$ at the numerically computed equilibria.\n\nImplement an algorithm that, for each given $\\mu$, numerically finds all real roots of the cubic equation $-X^3 + X + \\mu = 0$ (equivalently $f(X;\\mu)=0$), filters purely real solutions, merges duplicates that arise at degenerate (double-root) parameter values using a small absolute tolerance, and computes stability classifications and diagnostic metrics. The diagnostic metrics must include:\n- The total number of distinct real equilibria $N_{\\mathrm{eq}}$.\n- The number of linearly stable equilibria $N_{\\mathrm{st}}$ determined by the sign of $\\lambda(X^\\star;\\mu)$.\n- The maximum residual $R_{\\max} = \\max_{X^\\star} |f(X^\\star;\\mu)|$ over the set of numerically found equilibria.\n- The minimum absolute linearization magnitude $L_{\\min} = \\min_{X^\\star} |\\lambda(X^\\star;\\mu)|$, which highlights proximity to saddle-node conditions where $|\\lambda|$ approaches $0$.\n\nDesign the numerical method to be robust across regimes with one equilibrium, three equilibria, and degenerate saddle-node cases where two equilibria coalesce. You must not use any closed-form analytic solution of the cubic; rely only on numerical algorithms.\n\nTest Suite:\nEvaluate your program for the following control parameter values, which include a general case, edge cases, and boundary cases:\n- $\\mu = -0.350$ (general case with three equilibria expected),\n- $\\mu = 0.000$ (symmetric case),\n- $\\mu = 0.300$ (general case),\n- $\\mu = \\frac{2}{3\\sqrt{3}} \\approx 0.3849001794597505$ (positive boundary saddle-node),\n- $\\mu = -\\frac{2}{3\\sqrt{3}} \\approx -0.3849001794597505$ (negative boundary saddle-node),\n- $\\mu = 0.500$ (single-equilibrium regime).\n\nAnswer Specification and Final Output Format:\n- For each test case, output a list $[N_{\\mathrm{eq}}, N_{\\mathrm{st}}, R_{\\max}, L_{\\min}]$, with $R_{\\max}$ and $L_{\\min}$ reported as decimal numbers rounded to eight decimal places.\n- Aggregate the results of all test cases, in the order listed above, into a single line of output that is a comma-separated list enclosed in square brackets, where each element is the per-test-case list described above. For example, the output must look like\n$$\n[[N_{\\mathrm{eq}},N_{\\mathrm{st}},R_{\\max},L_{\\min}],\\ldots]\n$$\nprinted as a single line, with no spaces.\n- Since all quantities are nondimensional, no physical unit specification is required. Angles are not used. No percentages are used.",
            "solution": "The problem requires a numerical investigation of the equilibrium solutions to the autonomous ordinary differential equation $\\frac{dX}{dt} = f(X;\\mu) = \\mu + X - X^3$. The analysis involves finding all real equilibria $X^\\star$ for specified values of the control parameter $\\mu$, determining their stability, and quantifying the numerical accuracy of the solutions.\n\nAn equilibrium state, or invariant set, $X^\\star$ of the dynamical system is a point where the system's state does not change over time, i.e., $\\frac{dX}{dt} = 0$. This leads to the algebraic equilibrium condition:\n$$\nf(X^\\star;\\mu) = \\mu + X^\\star - (X^\\star)^3 = 0\n$$\nThis equation is a cubic polynomial in the state variable $X^\\star$. The task is to find all its real roots for given values of $\\mu$.\n\nThe problem explicitly forbids the use of a closed-form analytical solution for the cubic equation, mandating a purely numerical approach. A standard and robust method for this task is to employ a numerical polynomial root-finding algorithm. Such algorithms, often based on companion matrix eigenvalue computations, can find all roots (both real and complex) of a polynomial given its coefficients. The polynomial in question can be written in standard form as $-X^3 + 0X^2 + 1X^1 + \\mu X^0 = 0$. For a numerical library function that accepts polynomial coefficients in descending order of power, the input vector would be $[-1, 0, 1, \\mu]$.\n\nThe output of a general root-finder will include complex roots. Since the state variable $X$ represents a physical quantity, we are only interested in the real equilibria. A numerical root $z = a + ib$ is identified as real if its imaginary part $|b|$ is negligible, i.e., smaller than a small numerical tolerance, $|b|  \\epsilon_{\\mathrm{imag}}$. The real part $a$ is then taken as the value of the equilibrium $X^\\star$.\n\nFurthermore, at certain critical parameter values $\\mu$, the system undergoes a saddle-node bifurcation where two equilibria coalesce. Numerically, this corresponds to a multiple root of the polynomial. Due to floating-point arithmetic limitations, a numerical solver might return two distinct but very close roots instead of a single multiple root. To correctly identify the number of distinct equilibria, a post-processing step is necessary. After filtering for real roots, they are sorted, and any adjacent roots $X^\\star_i$ and $X^\\star_{i+1}$ whose absolute difference is less than a merging tolerance, $|X^\\star_{i+1} - X^\\star_i|  \\epsilon_{\\mathrm{merge}}$, are treated as a single, degenerate equilibrium.\n\nOnce the set of distinct real equilibria $\\{X^\\star\\}$ is determined, their linear stability is assessed. The stability is governed by the sign of the linearization coefficient $\\lambda$, which is the derivative of the right-hand side of the ODE evaluated at the equilibrium:\n$$\n\\lambda(X^\\star;\\mu) = \\left.\\frac{\\partial f}{\\partial X}\\right|_{X^\\star} = 1 - 3(X^\\star)^2\n$$\nAn equilibrium is linearly stable if $\\lambda  0$ (perturbations decay) and unstable if $\\lambda  0$ (perturbations grow). The case $\\lambda = 0$ corresponds to marginal stability and is the condition for a saddle-node bifurcation.\n\nThe algorithm proceeds by calculating four diagnostic metrics for each given $\\mu$:\n1.  $N_{\\mathrm{eq}}$: The total number of distinct real equilibria, obtained by counting the unique roots after the filtering and merging process.\n2.  $N_{\\mathrm{st}}$: The number of linearly stable equilibria, found by counting the equilibria for which $\\lambda(X^\\star;\\mu)  0$.\n3.  $R_{\\max}$: The maximum absolute residual, defined as $R_{\\max} = \\max_{X^\\star} |f(X^\\star;\\mu)|$. This metric serves as a quality check on the numerical root-finding, as the residual should be close to machine precision for accurate roots.\n4.  $L_{\\min}$: The minimum absolute linearization magnitude, $L_{\\min} = \\min_{X^\\star} |\\lambda(X^\\star;\\mu)|$. This value is a sensitive indicator of proximity to a bifurcation point, as it approaches $0$ when the system is near a condition where $\\lambda(X^\\star;\\mu) = 0$.\n\nIn summary, the implementation will execute the following steps for each value of $\\mu$ provided in the test suite:\n1.  Define the polynomial coefficients as $[-1, 0, 1, \\mu]$.\n2.  Use a numerical solver, such as `numpy.roots`, to compute all roots of the cubic polynomial.\n3.  Isolate the real roots by checking if the absolute value of their imaginary part is below a small tolerance $\\epsilon_{\\mathrm{imag}}$.\n4.  Sort and merge the set of real roots using a tolerance $\\epsilon_{\\mathrm{merge}}$ to obtain the distinct equilibria $\\{X^\\star_i\\}$.\n5.  Count the number of distinct equilibria to determine $N_{\\mathrm{eq}}$.\n6.  For each $X^\\star_i$, calculate $\\lambda(X^\\star_i;\\mu)$ and count the number of stable equilibria to find $N_{\\mathrm{st}}$.\n7.  For each $X^\\star_i$, compute the residual $|f(X^\\star_i; \\mu)|$ and find the maximum value, $R_{\\max}$.\n8.  For each $X^\\star_i$, compute $|\\lambda(X^\\star_i; \\mu)|$ and find the minimum value, $L_{\\min}$.\n9.  Compile and format these four metrics into the specified list structure for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bifurcation analysis problem for the given ODE.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        -0.350,\n        0.000,\n        0.300,\n        2 / (3 * np.sqrt(3)),\n        -2 / (3 * np.sqrt(3)),\n        0.500\n    ]\n\n    # Tolerance for identifying a root as purely real.\n    TOLERANCE_IMAG = 1e-9\n    # Tolerance for merging near-duplicate roots.\n    TOLERANCE_MERGE = 1e-8\n\n    # Store results for all test cases.\n    all_results = []\n\n    for mu in test_cases:\n        # Define the coefficients of the polynomial -X^3 + X + mu = 0.\n        coeffs = [-1, 0, 1, mu]\n\n        # Use numpy.roots to find all roots (real and complex).\n        roots = np.roots(coeffs)\n\n        # Filter for purely real roots by checking the imaginary part.\n        real_roots = sorted([r.real for r in roots if abs(r.imag)  TOLERANCE_IMAG])\n\n        # Merge duplicates that arise at degenerate cases.\n        if not real_roots:\n            distinct_roots = []\n        else:\n            distinct_roots = [real_roots[0]]\n            for i in range(1, len(real_roots)):\n                if abs(real_roots[i] - distinct_roots[-1])  TOLERANCE_MERGE:\n                    distinct_roots.append(real_roots[i])\n        \n        X_stars = np.array(distinct_roots)\n        \n        # Calculate diagnostic metrics.\n        N_eq = len(X_stars)\n\n        if N_eq == 0:\n            # This case will not occur for a cubic polynomial with real coefficients,\n            # but is included for algorithmic robustness.\n            N_st = 0\n            R_max = 0.0\n            L_min = 0.0\n        else:\n            # Calculate residuals: f(X;mu) = mu + X - X^3\n            residuals = np.abs(mu + X_stars - X_stars**3)\n            R_max = np.max(residuals)\n\n            # Calculate stability coefficients: lambda = 1 - 3*X^2\n            lambdas = 1 - 3 * X_stars**2\n            L_min = np.min(np.abs(lambdas))\n            \n            # Count the number of stable equilibria (lambda  0).\n            N_st = int(np.sum(lambdas  0))\n\n        # Format the results for the current test case.\n        # R_max and L_min must be formatted to 8 decimal places.\n        case_result_str = (\n            f\"[{N_eq},\"\n            f\"{N_st},\"\n            f\"{R_max:.8f},\"\n            f\"{L_min:.8f}]\"\n        )\n        all_results.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    # e.g., [[N_eq,N_st,R_max,L_min],[...],...] with no spaces.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The significance of bifurcation analysis extends beyond identifying stable states; it is crucial for understanding the limits of predictability. As a system approaches a tipping point, it becomes exquisitely sensitive to small uncertainties in its current state, $x_0$, or in external forcings, $\\mu$. This exercise  provides a hands-on method to quantify this loss of forecast skill by solving variational equations to measure how initial uncertainties are amplified over time, a phenomenon that has profound implications for climate risk assessment.",
            "id": "3865520",
            "problem": "Consider a nondimensionalized one-dimensional climate subsystem modeled as an ordinary differential equation (ODE) of the normal form for a saddle-node bifurcation. Let the state variable be $x$ and the control parameter be $\\mu$. The system evolves according to\n$$\n\\frac{dx}{dt} = f(x,\\mu) = \\mu - x^2,\n$$\nwith initial condition $x(0) = x_0$. For $\\mu  0$, the system possesses a stable equilibrium at $x^\\star = \\sqrt{\\mu}$, and the bifurcation (loss of hyperbolic stability) occurs at $\\mu = 0$.\n\nForecast skill is degraded near the bifurcation due to increased sensitivity to initial conditions and parameter uncertainty. Your task is to quantify this degradation over a finite forecast horizon by computing how small uncertainties in $x_0$ and $\\mu$ propagate to uncertainty in $x(T)$, where $T$ is the forecast lead time. Use the following foundations:\n- The flow map $\\Phi_T(x_0,\\mu)$ is defined by the solution $x(t)$ of the initial value problem evaluated at $t = T$.\n- First-order uncertainty propagation for independent sources states that the variance in the forecasted quantity equals the sum of variances from each source propagated through the squared sensitivities of the flow map, assuming small uncertainties.\n\nLet $\\sigma_{x_0}^2$ be the variance of uncertainty in $x_0$ and $\\sigma_{\\mu}^2$ be the variance in $\\mu$. Define the forecast skill index $S$ at lead time $T$ by\n$$\nS = \\frac{1}{1 + \\frac{V_f}{V_0}},\n$$\nwhere $V_f$ is the forecast variance at time $T$ computed by first-order propagation, and $V_0 = \\sigma_{x_0}^2 + \\sigma_{\\mu}^2$ is the baseline variance. The forecast skill $S$ is dimensionless. A larger $V_f$ relative to $V_0$ implies smaller $S$.\n\nDevelop a complete program that:\n1. Computes the flow map $\\Phi_T(x_0,\\mu)$ for the system $\\frac{dx}{dt} = \\mu - x^2$, together with the sensitivities $\\frac{\\partial \\Phi_T}{\\partial x_0}$ and $\\frac{\\partial \\Phi_T}{\\partial \\mu}$ at the specified $(x_0,\\mu)$ by solving appropriate variational equations derived from the ODE and the definition of the flow map.\n2. Uses these sensitivities to compute the forecast variance\n$$\nV_f = \\left(\\frac{\\partial \\Phi_T}{\\partial x_0}\\right)^2 \\sigma_{x_0}^2 + \\left(\\frac{\\partial \\Phi_T}{\\partial \\mu}\\right)^2 \\sigma_{\\mu}^2,\n$$\nassuming the uncertainties in $x_0$ and $\\mu$ are independent and sufficiently small for first-order propagation to be valid.\n3. Returns the forecast skill index $S$ for each test case.\n\nAll variables in this problem are nondimensional, and the forecast lead time is $T = 5$. Use $x_0 = \\sqrt{\\max(\\mu, 0)}$ for each test case. Use $\\sigma_{x_0} = 1 \\times 10^{-3}$ and $\\sigma_{\\mu} = 1 \\times 10^{-3}$.\n\nTest suite:\n- Case $1$: $\\mu = 0.5$ (far from bifurcation; stable equilibrium well-defined).\n- Case $2$: $\\mu = 0.1$ (closer to bifurcation).\n- Case $3$: $\\mu = 0.01$ (very close to bifurcation).\n- Case $4$: $\\mu = 0.0$ (at the bifurcation point; nonhyperbolic equilibrium).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $[s_1,s_2,s_3,s_4]$, where each $s_i$ is the forecast skill index $S$ for the corresponding case as a floating-point number.",
            "solution": "The task is to compute a forecast skill index, $S$, for a simple climate subsystem model described by the ordinary differential equation (ODE) $\\frac{dx}{dt} = \\mu - x^2$. This index quantifies the degradation of forecast skill near the bifurcation point $\\mu=0$. The calculation of $S$ depends on the forecast variance, $V_f$, which is determined by propagating initial uncertainties in the state $x_0$ and the parameter $\\mu$ over a forecast horizon $T$. This propagation requires computing the sensitivities of the final state $x(T)$ with respect to $x_0$ and $\\mu$.\n\nLet the flow map be $\\Phi_T(x_0, \\mu) = x(T)$, where $x(t)$ is the solution to the initial value problem. The sensitivities are the partial derivatives of this map, specifically $\\frac{\\partial \\Phi_T}{\\partial x_0}$ and $\\frac{\\partial \\Phi_T}{\\partial \\mu}$, evaluated at a specific point $(x_0, \\mu)$. These sensitivities can be found by solving a system of variational equations simultaneously with the original ODE.\n\nLet $S_{x_0}(t) = \\frac{\\partial x(t)}{\\partial x_0}$ and $S_{\\mu}(t) = \\frac{\\partial x(t)}{\\partial \\mu}$. We derive the governing equations for these sensitivities by differentiating the original ODE, $\\frac{dx}{dt} = \\mu - x^2$, with respect to $x_0$ and $\\mu$, respectively.\n\nThe sensitivity with respect to the initial condition, $S_{x_0}$:\n$$\n\\frac{d}{dt} S_{x_0} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial x_0} \\right) = \\frac{\\partial}{\\partial x_0} \\left( \\frac{dx}{dt} \\right) = \\frac{\\partial}{\\partial x_0} (\\mu - x^2)\n$$\nUsing the chain rule, $\\frac{\\partial f(x,\\mu)}{\\partial x_0} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial x_0}$, we get:\n$$\n\\frac{dS_{x_0}}{dt} = (-2x) S_{x_0}\n$$\nThe initial condition is found by differentiating $x(0) = x_0$ with respect to $x_0$:\n$$\nS_{x_0}(0) = \\frac{\\partial x(0)}{\\partial x_0} = \\frac{\\partial x_0}{\\partial x_0} = 1\n$$\n\nThe sensitivity with respect to the parameter, $S_{\\mu}$:\n$$\n\\frac{d}{dt} S_{\\mu} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\mu} \\right) = \\frac{\\partial}{\\partial \\mu} \\left( \\frac{dx}{dt} \\right) = \\frac{\\partial}{\\partial \\mu} (\\mu - x^2)\n$$\nUsing the chain rule, $\\frac{\\partial f(x,\\mu)}{\\partial \\mu} = \\frac{\\partial f}{\\partial \\mu} + \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\mu}$, we get:\n$$\n\\frac{dS_{\\mu}}{dt} = 1 + (-2x) S_{\\mu}\n$$\nThe initial condition is found by differentiating $x(0) = x_0$ with respect to $\\mu$. When computing the partial derivative $\\frac{\\partial \\Phi_T}{\\partial \\mu}$, the initial condition $x_0$ is treated as an independent variable. Thus:\n$$\nS_{\\mu}(0) = \\frac{\\partial x(0)}{\\partial \\mu} = \\frac{\\partial x_0}{\\partial \\mu} = 0\n$$\n\nWe must solve the following system of three coupled ODEs from $t=0$ to $t=T=5$:\nLet the state vector be $y(t) = [y_0(t), y_1(t), y_2(t)]^T \\equiv [x(t), S_{x_0}(t), S_{\\mu}(t)]^T$.\n$$\n\\frac{dy}{dt} =\n\\begin{pmatrix}\n\\mu - y_0^2 \\\\\n-2 y_0 y_1 \\\\\n1 - 2 y_0 y_2\n\\end{pmatrix}\n$$\nFor each test case, the parameter $\\mu$ is given. The initial condition for the trajectory is specified as $x_0 = \\sqrt{\\max(\\mu, 0)}$. This means we start each simulation for $\\mu > 0$ at the stable equilibrium $x^\\star = \\sqrt{\\mu}$, and for $\\mu = 0$ at the nonhyperbolic equilibrium $x^\\star=0$. Consequently, for any test case, the trajectory is trivial: $x(t) = x_0$ for all $t$. While this allows for an analytical solution to the variational equations, the numerical solution prescribed by the problem is a more general approach and will be implemented. The initial vector for the system is:\n$$\ny(0) = [x_0, 1, 0]^T\n$$\nAfter integrating the system to $T=5$, the final state vector is $y(T) = [\\Phi_T, \\frac{\\partial \\Phi_T}{\\partial x_0}, \\frac{\\partial \\Phi_T}{\\partial \\mu}]^T$.\n\nWith the sensitivities computed, we calculate the forecast variance $V_f$ and the forecast skill index $S$. The problem provides $\\sigma_{x_0} = 1 \\times 10^{-3}$ and $\\sigma_{\\mu} = 1 \\times 10^{-3}$, so the variances are $\\sigma_{x_0}^2 = 1 \\times 10^{-6}$ and $\\sigma_{\\mu}^2 = 1 \\times 10^{-6}$.\n\nThe baseline variance is $V_0 = \\sigma_{x_0}^2 + \\sigma_{\\mu}^2 = 2 \\times 10^{-6}$.\nThe forecast variance is $V_f = \\left(\\frac{\\partial \\Phi_T}{\\partial x_0}\\right)^2 \\sigma_{x_0}^2 + \\left(\\frac{\\partial \\Phi_T}{\\partial \\mu}\\right)^2 \\sigma_{\\mu}^2$.\nThe forecast skill index is $S = \\frac{1}{1 + V_f/V_0}$.\n\nThe procedure for each test case is:\n1.  Set the value of $\\mu$.\n2.  Calculate the initial state $x_0 = \\sqrt{\\max(\\mu, 0)}$.\n3.  Define the initial vector $y(0) = [x_0, 1, 0]^T$.\n4.  Numerically solve the system of ODEs from $t=0$ to $t=T=5$.\n5.  Extract the sensitivities $S_{x_0}(T)$ and $S_{\\mu}(T)$ from the solution at $t=T$.\n6.  Compute $V_f$ and then $S$.\n\nThis procedure is repeated for each value of $\\mu$ in the test suite. The results demonstrate that as $\\mu$ approaches the bifurcation point at $0$, the sensitivity $\\frac{\\partial \\Phi_T}{\\partial \\mu}$ grows significantly, leading to a larger forecast variance $V_f$ and a correspondingly lower forecast skill $S$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the forecast skill index for a simple climate model near a\n    saddle-node bifurcation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases_mu = [0.5, 0.1, 0.01, 0.0]\n\n    # Define constants\n    T = 5.0  # Forecast lead time\n    sigma_x0 = 1e-3  # Uncertainty in initial condition\n    sigma_mu = 1e-3  # Uncertainty in parameter\n    \n    var_x0 = sigma_x0**2\n    var_mu = sigma_mu**2\n    V0 = var_x0 + var_mu  # Baseline variance\n\n    def system_ode(t, y, mu):\n        \"\"\"\n        Defines the system of coupled ODEs for the state and its sensitivities.\n        \n        Args:\n            t (float): Time.\n            y (np.ndarray): State vector [x, S_x0, S_mu].\n            mu (float): Control parameter.\n            \n        Returns:\n            np.ndarray: Derivatives [dx/dt, dS_x0/dt, dS_mu/dt].\n        \"\"\"\n        x, S_x0, S_mu = y\n        \n        # Original ODE\n        dx_dt = mu - x**2\n        \n        # Variational equation for sensitivity to x0\n        dS_x0_dt = -2.0 * x * S_x0\n        \n        # Variational equation for sensitivity to mu\n        dS_mu_dt = 1.0 - 2.0 * x * S_mu\n        \n        return np.array([dx_dt, dS_x0_dt, dS_mu_dt])\n\n    results = []\n    for mu in test_cases_mu:\n        # 1. Determine initial condition for the state variable\n        # The problem specifies starting at the equilibrium point.\n        x0 = np.sqrt(np.maximum(mu, 0))\n        \n        # 2. Set the initial vector for the full system [x, S_x0, S_mu]\n        # S_x0(0) = d(x(0))/d(x0) = 1\n        # S_mu(0) = d(x(0))/d(mu) = 0 (partial derivative)\n        y0 = np.array([x0, 1.0, 0.0])\n        \n        # 3. Solve the system of ODEs\n        # We use a high-precision solver to handle stiffness near the bifurcation\n        sol = solve_ivp(\n            fun=system_ode,\n            t_span=[0, T],\n            y0=y0,\n            args=(mu,),\n            method='RK45',\n            rtol=1e-9,\n            atol=1e-12\n        )\n        \n        # 4. Extract sensitivities at the final time T\n        y_T = sol.y[:, -1]\n        # x_T = y_T[0]  # Not needed for skill index calculation\n        S_x0_T = y_T[1]\n        S_mu_T = y_T[2]\n        \n        # 5. Compute the forecast variance Vf\n        Vf = (S_x0_T**2) * var_x0 + (S_mu_T**2) * var_mu\n        \n        # 6. Compute the forecast skill index S\n        S = 1.0 / (1.0 + Vf / V0)\n        \n        results.append(S)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}