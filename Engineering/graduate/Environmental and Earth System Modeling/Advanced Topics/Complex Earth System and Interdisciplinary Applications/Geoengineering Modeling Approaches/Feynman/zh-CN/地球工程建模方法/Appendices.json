{
    "hands_on_practices": [
        {
            "introduction": "要对地球工程进行建模，第一步是理解其对大气成分的直接影响。这项练习  使用一个简化的“箱式模型”来模拟一项持续的二氧化碳清除（CDR）干预措施。通过求解一个描述大气 $\\mathrm{CO_2}$ 浓度随时间变化的微分方程，我们不仅能实践关键的数学建模技巧，还能量化理解泄漏和自然碳汇饱和等现实世界中的复杂因素如何影响CDR的长期有效性及其对辐射强迫的最终作用。",
            "id": "3882593",
            "problem": "一个单箱大气二氧化碳模型被用于评估一项具有泄漏和时变陆地吸收饱和效应的持续性二氧化碳移除干预措施。设 $C(t)$ 表示全球平均大气$\\mathrm{CO_2}$浓度，单位为百万分率 (ppm)，设 $C_0$ 表示一个固定的工业化前参考浓度。从大气箱的碳质量守恒出发，假设：\n- 在 $t=0$ 之后，不存在人为排放。\n- 一项持续性二氧化碳移除计划以速率 $R(t)=R_0$ (单位为 ppm/年) 从大气中提取$\\mathrm{CO_2}$，但一个恒定的比例 $\\ell$ 会迅速泄漏回来，因此有效永久移除量为 $(1-\\ell) R_0$。\n- 自然陆地吸收使 $C(t)$ 向 $C_0$ 弛豫，其遵循一个因饱和而随时间减弱的线性化通量 $-k(t)\\,[C(t)-C_0]$，其中 $k(t)=\\dfrac{k_0}{1+t/\\tau_s}$。\n\n因此，对于 $t \\ge 0$，大气质量平衡方程为\n$$\n\\frac{dC}{dt} \\;=\\; -\\,(1-\\ell)\\,R_0 \\;-\\; k(t)\\,\\bigl[C(t)-C_0\\bigr],\n$$\n初始条件为 $C(0)=C_i$。与该浓度路径相关的瞬时大气层顶辐射强迫采用经过充分检验的对数关系式\n$$\nF(t) \\;=\\; \\alpha \\,\\ln\\!\\left(\\frac{C(t)}{C_0}\\right).\n$$\n\n仅使用这些假设，解析地推导 $C(t)$，并对以下参数集计算 $T=100$ 年时的 $F(T)$：\n- $C_0=280\\ \\text{ppm}$,\n- $C_i=415\\ \\text{ppm}$,\n- $R_0=1.5\\ \\text{ppm}\\ \\text{年}^{-1}$,\n- $\\ell = 0.20$,\n- $k_0=0.020\\ \\text{年}^{-1}$,\n- $\\tau_s=50\\ \\text{年}$,\n- $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$.\n\n将 $F(T)$ 的最终数值答案四舍五入到四位有效数字。以 $\\text{W}\\ \\text{m}^{-2}$ 为单位表示最终值。",
            "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 第1步：提取已知条件\n- 大气$\\mathrm{CO_2}$浓度 $C(t)$ 的控制微分方程：$\\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0]$\n- 随时间变化的自然吸收率：$k(t) = \\frac{k_0}{1+t/\\tau_s}$\n- 初始条件：$C(0) = C_i$\n- 辐射强迫公式：$F(t) = \\alpha \\ln(\\frac{C(t)}{C_0})$\n- 评估的目标时间：$T = 100$ 年\n- 参数值：\n  - $C_0=280\\ \\text{ppm}$\n  - $C_i=415\\ \\text{ppm}$\n  - $R_0=1.5\\ \\text{ppm}\\ \\text{年}^{-1}$\n  - $\\ell = 0.20$\n  - $k_0=0.020\\ \\text{年}^{-1}$\n  - $\\tau_s=50\\ \\text{年}$\n  - $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$\n\n### 第2步：使用提取的已知条件进行验证\n- **科学上合理**：该问题使用单箱模型，这是气候科学中用于阐释基本动力学的标准简化方法。质量平衡方程正确地考虑了源和汇。代表向工业化前状态弛豫的汇项是一种有效的线性化处理。其时变系数 $k(t)$ 是模拟陆地碳汇饱和的一种合理（尽管简单）的方式。辐射强迫的对数公式是一个在气候建模中（例如被IPCC）广泛使用的、成熟的经验关系。所有参数值在物理上都是现实的。\n- **适定的**：该问题是一个一阶线性常微分方程的初值问题。对于 $t \\ge 0$，系数函数是连续的。标准的存在性和唯一性定理保证了唯一解 $C(t)$ 的存在。\n- **客观的**：该问题以精确的数学和物理术语陈述，没有歧义或主观论断。\n- **完整性**：所有求解 $C(t)$ 并随后计算 $F(T)$ 所需的必要常数、函数形式和初始条件均已提供。\n- **一致性**：所提供的数据或方程中没有内部矛盾。单位是一致的。\n\n### 第3步：结论与行动\n该问题在科学上是合理的、适定的和自洽的。它被认为是**有效的**。将推导出完整的解。\n\n控制方程是一个一阶线性常微分方程：\n$$ \\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0] $$\n我们可以将其重排为标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$。让我们定义一个新变量 $y(t) = C(t) - C_0$。那么 $\\frac{dy}{dt} = \\frac{dC}{dt}$。将此代入方程得到：\n$$ \\frac{dy}{dt} = -(1-\\ell)R_0 - k(t)y(t) $$\n$$ \\frac{dy}{dt} + k(t)y(t) = -(1-\\ell)R_0 $$\n这是一个关于 $y(t)$ 的线性常微分方程，初始条件为 $y(0) = C(0) - C_0 = C_i - C_0$。该方程使用积分因子 $I(t)$ 求解，定义为：\n$$ I(t) = \\exp\\left(\\int k(t) dt\\right) $$\n首先，我们计算 $k(t) = \\frac{k_0}{1+t/\\tau_s}$ 的积分：\n$$ \\int k(t) dt = \\int \\frac{k_0}{1+t/\\tau_s} dt $$\n使用换元法，令 $u = 1 + t/\\tau_s$，我们有 $du = \\frac{1}{\\tau_s}dt$，因此 $dt = \\tau_s du$。\n$$ \\int \\frac{k_0}{u} \\tau_s du = k_0 \\tau_s \\int \\frac{1}{u} du = k_0 \\tau_s \\ln(u) = k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right) $$\n因此，积分因子为：\n$$ I(t) = \\exp\\left(k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right)\\right) = \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} $$\n$y(t)$ 的解由下式给出：\n$$ y(t) = \\frac{1}{I(t)}\\left[\\int I(t) Q(t) dt + \\mathcal{K}\\right] $$\n其中 $Q(t) = -(1-\\ell)R_0$ 是一个常数，$\\mathcal{K}$ 是积分常数。\n$$ y(t) I(t) = \\int -(1-\\ell)R_0 \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt + \\mathcal{K} $$\n我们计算这个积分：\n$$ \\int \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt = \\tau_s \\int u^{k_0 \\tau_s} du = \\frac{\\tau_s}{k_0 \\tau_s+1} u^{k_0 \\tau_s+1} = \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} $$\n将其代回，我们得到：\n$$ y(t)\\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} = - (1-\\ell)R_0 \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} + \\mathcal{K} $$\n求解 $y(t)$：\n$$ y(t) = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\mathcal{K} \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\n我们使用初始条件 $y(0) = C_i - C_0$ 来求 $\\mathcal{K}$。在 $t=0$ 时：\n$$ C_i - C_0 = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} (1) + \\mathcal{K} (1) $$\n$$ \\mathcal{K} = (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} $$\n将 $\\mathcal{K}$ 代回到 $y(t)$ 的解中，然后求出 $C(t) = y(t) + C_0$：\n$$ C(t) = C_0 - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\left[ (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\right] \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\n现在我们代入数值来求 $T=100\\ \\text{年}$ 时的 $C(T)$。\n首先，计算复合参数：\n- 指数项：$k_0 \\tau_s = (0.020\\ \\text{年}^{-1})(50\\ \\text{年}) = 1$。\n- 有效移除率项：$(1-\\ell)R_0 = (1-0.20)(1.5\\ \\text{ppm 年}^{-1}) = (0.80)(1.5\\ \\text{ppm 年}^{-1}) = 1.2\\ \\text{ppm 年}^{-1}$。\n- 系数项：$\\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} = \\frac{(1.2\\ \\text{ppm 年}^{-1})(50\\ \\text{年})}{1+1} = \\frac{60\\ \\text{ppm}}{2} = 30\\ \\text{ppm}$。\n- 初始异常值：$C_i - C_0 = 415\\ \\text{ppm} - 280\\ \\text{ppm} = 135\\ \\text{ppm}$。\n- 在 $t=T=100$ 时的时间项参数：$1+\\frac{T}{\\tau_s} = 1+\\frac{100\\ \\text{年}}{50\\ \\text{年}} = 1+2 = 3$。\n\n将这些代入 $t=T$ 时 $C(t)$ 的解析解中：\n$$ C(100) = 280\\ \\text{ppm} - 30\\ \\text{ppm} \\times (3) + \\left[ 135\\ \\text{ppm} + 30\\ \\text{ppm} \\right] \\times (3)^{-1} $$\n$$ C(100) = 280 - 90 + (165) \\times \\frac{1}{3} $$\n$$ C(100) = 190 + 55 = 245\\ \\text{ppm} $$\n$T=100$ 年时的浓度为 $C(100) = 245\\ \\text{ppm}$。\n\n最后，我们计算 $T=100$ 年时的辐射强迫 $F(T)$：\n$$ F(T) = \\alpha \\ln\\left(\\frac{C(T)}{C_0}\\right) $$\n$$ F(100) = 5.35\\ \\text{W}\\ \\text{m}^{-2} \\times \\ln\\left(\\frac{245}{280}\\right) $$\n该分数可简化为 $\\frac{245}{280} = \\frac{7 \\times 35}{8 \\times 35} = \\frac{7}{8} = 0.875$。\n$$ F(100) = 5.35 \\times \\ln(0.875) $$\n$$ F(100) \\approx 5.35 \\times (-0.13353139) \\approx -0.71441794\\ \\text{W}\\ \\text{m}^{-2} $$\n四舍五入到四位有效数字，我们得到：\n$$ F(100) \\approx -0.7144\\ \\text{W}\\ \\text{m}^{-2} $$",
            "answer": "$$\n\\boxed{-0.7144}\n$$"
        },
        {
            "introduction": "不同的地球工程方法对气候系统的影响方式存在本质差异。这项练习  引导我们使用一个基础的能量平衡模型，直接比较移除二氧化碳（CDR）和减少太阳辐射（SRM）这两种策略。此问题的核心是引入并应用“功效”（efficacy）这一关键概念，它揭示了为何同等大小的辐射强迫若来自不同来源，可能会导致幅度不同的全球温度响应，这是评估和比较不同地球工程方案时必须考虑的重要因素。",
            "id": "3882680",
            "problem": "气候系统建模中的一个核心简化框架是全球平均能量平衡模型，该模型指出，大气层顶部的净能量不平衡 $N$ 对施加的有效辐射强迫 $F$ 和温度变化 $T$ 的响应，通过一个线性反馈参数 $\\lambda$ 来描述，即 $N = F - \\lambda T$。在平衡状态下，或者对于长期的强迫和响应，可以近似为 $N \\approx 0$，因此 $T = F / \\lambda$。不同的强迫因子可以有不同的功效，功效定义为因子 $e$，它在相同辐射强迫大小下，相对于参考因子，缩放温度响应，因此对于给定的因子有 $T = e F / \\lambda$。对于大气中二氧化碳浓度的变化，我们采用标准的辐射强迫公式 $F_{\\mathrm{CO_{2}}}(C) = 5.35 \\,\\ln\\!\\big(C/C_{0}\\big)$，其中 $C$ 是大气中二氧化碳的浓度，单位为百万分率 (ppm)，$C_{0}$ 是一个参考浓度。\n\n考虑一个基准状态，其大气二氧化碳浓度为 $C = 420\\,\\mathrm{ppm}$，参考浓度为 $C_{0} = 280\\,\\mathrm{ppm}$。假设通过二氧化碳移除 (CDR) 去除 $1\\,\\mathrm{ppm}$ 的二氧化碳，使得浓度降低到 $C - \\Delta C$，其中 $\\Delta C = 1\\,\\mathrm{ppm}$。假设气候反馈参数为 $\\lambda = 1.2\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，二氧化碳强迫的功效为 $e_{\\mathrm{CDR}} = 1.0$，太阳辐射管理 (SRM) 强迫的功效为 $e_{\\mathrm{SRM}} = 0.9$。将在移除 $1\\,\\mathrm{ppm}$ 二氧化碳时，为实现相同的绝对温度变化 $|\\Delta T|$，所需的 SRM 辐射强迫与 CDR 辐射强迫的量值之差定义为\n$$\n\\Delta F \\equiv F_{\\mathrm{SRM,req}} - \\big| \\Delta F_{\\mathrm{CDR}} \\big|,\n$$\n其中 $F_{\\mathrm{SRM,req}}$ 是产生与 CDR 诱导的强迫 $\\Delta F_{\\mathrm{CDR}} = F_{\\mathrm{CO_{2}}}(C - \\Delta C) - F_{\\mathrm{CO_{2}}}(C)$ 所导致的温度变化量值相等的 $|\\Delta T|$ 所需的 SRM 强迫的量值。\n\n使用上述框架，计算给定参数下的 $\\Delta F$。将您的答案四舍五入到四位有效数字。以瓦特每平方米（$\\mathrm{W}\\,\\mathrm{m}^{-2}$）为单位表示您的最终答案。",
            "solution": "考虑功效的全球平均能量平衡模型指出，对于功效为 $e$ 的强迫因子，温度响应由下式给出\n$$\n\\Delta T = \\frac{e\\,\\Delta F}{\\lambda}.\n$$\n对于改变二氧化碳浓度的 CDR 情况，其功效为 $e_{\\mathrm{CDR}} = 1.0$。标准的二氧化碳辐射强迫关系式为\n$$\nF_{\\mathrm{CO_{2}}}(C) = 5.35\\,\\ln\\!\\left(\\frac{C}{C_{0}}\\right).\n$$\n从 $C = 420\\,\\mathrm{ppm}$ 中移除 $\\Delta C = 1\\,\\mathrm{ppm}$ 会产生一个强迫变化\n$$\n\\Delta F_{\\mathrm{CDR}} = F_{\\mathrm{CO_{2}}}(C - \\Delta C) - F_{\\mathrm{CO_{2}}}(C) = 5.35\\,\\ln\\!\\left(\\frac{C - \\Delta C}{C}\\right) = 5.35\\,\\ln\\!\\left(1 - \\frac{\\Delta C}{C}\\right).\n$$\n代入 $C = 420$ 和 $\\Delta C = 1$，\n$$\n\\Delta F_{\\mathrm{CDR}} = 5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right).\n$$\n该值为负，表示一个冷却强迫。其量值为\n$$\n\\big|\\Delta F_{\\mathrm{CDR}}\\big| = -\\Delta F_{\\mathrm{CDR}} = -5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right).\n$$\n相关的绝对温度变化为\n$$\n\\big|\\Delta T\\big| = \\frac{e_{\\mathrm{CDR}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|}{\\lambda} = \\frac{1.0}{\\lambda}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\n为了用功效为 $e_{\\mathrm{SRM}} = 0.9$ 的 SRM 实现相同的 $\\big|\\Delta T\\big|$，所需的 SRM 强迫量值为\n$$\nF_{\\mathrm{SRM,req}} = \\frac{\\lambda\\,\\big|\\Delta T\\big|}{e_{\\mathrm{SRM}}} = \\frac{\\lambda}{e_{\\mathrm{SRM}}}\\,\\frac{e_{\\mathrm{CDR}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|}{\\lambda} = \\frac{e_{\\mathrm{CDR}}}{e_{\\mathrm{SRM}}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\n当 $e_{\\mathrm{CDR}} = 1.0$ 时，上式简化为\n$$\nF_{\\mathrm{SRM,req}} = \\frac{1}{e_{\\mathrm{SRM}}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\n因此，问题中定义的差值为\n$$\n\\Delta F = F_{\\mathrm{SRM,req}} - \\big|\\Delta F_{\\mathrm{CDR}}\\big| = \\left(\\frac{1}{e_{\\mathrm{SRM}}} - 1\\right)\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\n我们现在数值计算 $\\big|\\Delta F_{\\mathrm{CDR}}\\big|$：\n$$\n\\ln\\!\\left(\\frac{419}{420}\\right) \\approx -0.00238379135,\n$$\n所以\n$$\n\\big|\\Delta F_{\\mathrm{CDR}}\\big| = -5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right) \\approx 5.35 \\times 0.00238379135 \\approx 0.01275328372\\,\\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$\n当 $e_{\\mathrm{SRM}} = 0.9$ 时，\n$$\n\\Delta F = \\left(\\frac{1}{0.9} - 1\\right) \\times 0.01275328372 = \\left(1.111111\\ldots - 1\\right)\\times 0.01275328372 = \\frac{1}{9}\\times 0.01275328372 \\approx 0.00141703152\\,\\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$\n四舍五入到四位有效数字，结果是\n$$\n0.001417\\,\\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$",
            "answer": "$$\\boxed{0.001417}$$"
        },
        {
            "introduction": "在复杂的全球气候模型中评估地球工程方案时，科学家需要从海量模拟数据中提取关键物理参数。这项练习  介绍了一种气候科学领域的标准分析工具——格雷戈里回归（Gregory regression）。通过亲手编写代码实现该方法，您将学会如何从模拟的顶层大气能量通量和地表温度数据中，估算出干预措施的有效辐射强迫（ERF）和气候反馈参数（$\\lambda$），掌握一项前沿气候研究所需的基本数据分析技能。",
            "id": "3882625",
            "problem": "您正在使用 Gregory 回归框架对一次地球工程扰动的辐射影响进行建模。大气层顶的全球能量守恒定律决定了大气层顶净通量异常满足以下关系\n$$\nN = F - \\lambda\\,T + \\varepsilon,\n$$\n其中，$N$ 是大气层顶净通量异常，单位为 $\\mathrm{W\\,m^{-2}}$；$F$ 是有效辐射强迫 (ERF)，单位为 $\\mathrm{W\\,m^{-2}}$；$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$；$T$ 是全球平均地表气温异常，单位为 $\\mathrm{K}$；而 $\\varepsilon$ 代表内部变率和模型残差。一种基础且广泛使用的估计方法是 Gregory 回归，它使用普通最小二乘法 (OLS) 将 $N$ 作为 $T$ 的函数拟合成一条直线，并将截距解释为有效辐射强迫 $F$，斜率解释为 $-\\lambda$。\n\n任务：\n1) 从 $N$、$F$ 和 $\\lambda$ 的定义以及上述全球能量平衡表达式出发，通过最小化残差平方和来推导 $N$ 与 $T$ 之间线性关系的截距和斜率的 OLS 估计量。展示如何从拟合的截距和斜率中提取估计值 $\\hat{F}$ 和 $\\hat{\\lambda}$，并阐明符号约定的物理意义。\n2) 实现一个程序，该程序针对多个测试用例，根据给定的配对样本 $\\{(T_i,N_i)\\}_{i=1}^{n}$，通过 OLS 估计 $\\hat{F}$（单位为 $\\mathrm{W\\,m^{-2}}$）和 $\\hat{\\lambda}$（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$），然后在相同的单箱能量平衡框架内，计算阶跃强迫下隐含的平衡温度异常估计值 $\\hat{T}_{\\mathrm{eq}} = \\hat{F}/\\hat{\\lambda}$（单位为 $\\mathrm{K}$）。\n3) 所有输出都必须以指定的物理单位表示，但您的程序必须只输出数字，不带单位符号。将每个报告值四舍五入到 $3$ 位小数。\n\n使用以下指定的配对数据集 $(T_i,N_i)$（其中 $i=1,\\dots,n$）作为列表的测试套件。每个列表条目都是一个实数。$T$ 的单位是 $\\mathrm{K}$，$N$ 的单位是 $\\mathrm{W\\,m^{-2}}$。\n\n- 测试用例 1（无噪声参考）：\n  $$\n  T = [0.0,\\,0.5,\\,1.0,\\,1.5,\\,2.0],\\quad\n  N = [4.0,\\,3.5,\\,3.0,\\,2.5,\\,2.0].\n  $$\n- 测试用例 2（中等变率）：\n  $$\n  T = [0.1,\\,0.3,\\,0.7,\\,1.2,\\,1.8],\\quad\n  N = [3.63,\\,3.31,\\,2.88,\\,2.22,\\,1.54].\n  $$\n- 测试用例 3（接近零强迫，小变率）：\n  $$\n  T = [-0.1,\\,0.0,\\,0.1,\\,0.2,\\,0.3],\\quad\n  N = [0.35,\\,0.2,\\,0.07,\\,-0.11,\\,-0.25].\n  $$\n- 测试用例 4（$T$ 的方差小；数值上很敏感）：\n  $$\n  T = [1.00,\\,1.01,\\,0.99,\\,1.02,\\,0.98],\\quad\n  N = [1.702,\\,1.691,\\,1.708,\\,1.686,\\,1.715].\n  $$\n\n对于每个测试用例，计算并报告三元组 $[\\hat{F},\\hat{\\lambda},\\hat{T}_{\\mathrm{eq}}]$，每个值都四舍五入到 3 位小数。您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表，按测试用例排序并按顺序展开，即\n$$\n[\\hat{F}_1,\\hat{\\lambda}_1,\\hat{T}_{\\mathrm{eq},1},\\hat{F}_2,\\hat{\\lambda}_2,\\hat{T}_{\\mathrm{eq},2},\\hat{F}_3,\\hat{\\lambda}_3,\\hat{T}_{\\mathrm{eq},3},\\hat{F}_4,\\hat{\\lambda}_4,\\hat{T}_{\\mathrm{eq},4}].\n$$\n\n约束和期望：\n- 您必须对每个测试用例使用普通最小二乘法 (OLS) 将 $N$ 作为 $T$ 的函数拟合成一条直线。不要使用允许的库之外的任何预打包回归工具；使用样本均值和总和，从第一性原理出发实现 OLS 解法。\n- 通过处理 $T$ 方差极小的潜在情况来确保数值稳健性；如果 $T$ 的方差恰好为零，则回归是未定义的。所提供的测试用例避免了方差恰好为零的情况。\n- 不需要角度单位。不涉及百分比。\n- 结果必须是浮点数。最终输出格式必须是如上所述的、包含展开列表的单行。",
            "solution": "该问题是有效的，因为它在科学上基于气候建模的原理，具体来说，是用于从能量平衡模型中估计辐射强迫和气候反馈的 Gregory 回归方法。该问题是适定的，为通过普通最小二乘法 (OLS) 回归获得唯一解提供了所有必要的数据和数学定义。语言客观，要求明确。\n\n该问题要求推导并实现一个描述大气层顶能量平衡的线性模型的 OLS 估计量。\n\n**1. OLS 估计量的推导及物理诠释**\n\n主导的物理关系由以下能量平衡方程给出：\n$$\nN = F - \\lambda T + \\varepsilon\n$$\n其中，$N$ 是大气层顶净通量异常，$T$ 是全球平均地表气温异常，$F$ 是有效辐射强迫 (ERF)，$\\lambda$ 是净气候反馈参数，$\\varepsilon$ 代表非强迫的内部变率和模型残差。\n\n我们的任务是为一组形式为 $\\{(T_i, N_i)\\}_{i=1}^{n}$ 的数据点拟合一个线性模型：\n$$\nN_i = \\beta_0 + \\beta_1 T_i + e_i\n$$\n在此，$\\beta_0$ 和 $\\beta_1$ 是回归线的截距和斜率系数，$e_i$ 是残差，即观测值 $N_i$ 与模型预测值 $\\hat{N}_i = \\beta_0 + \\beta_1 T_i$ 之间的差异。\n\n普通最小二乘法 (OLS) 旨在确定系数的值（记为 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$），以最小化残差平方和 (SSR)。SSR 作为 $\\beta_0$ 和 $\\beta_1$ 的函数是：\n$$\nS(\\beta_0, \\beta_1) = \\sum_{i=1}^{n} e_i^2 = \\sum_{i=1}^{n} (N_i - (\\beta_0 + \\beta_1 T_i))^2\n$$\n为了找到 $S$ 的最小值，我们分别对 $\\beta_0$ 和 $\\beta_1$ 求偏导数，并令其等于零。\n\n首先，对 $\\beta_0$求导：\n$$\n\\frac{\\partial S}{\\partial \\beta_0} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-1) = 0\n$$\n$$\n\\sum_{i=1}^{n} (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} N_i - n \\hat{\\beta}_0 - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i = 0\n$$\n除以数据点数 $n$，我们得到一个涉及样本均值 $\\bar{T} = \\frac{1}{n} \\sum T_i$ 和 $\\bar{N} = \\frac{1}{n} \\sum N_i$ 的关系式：\n$$\n\\bar{N} - \\hat{\\beta}_0 - \\hat{\\beta}_1 \\bar{T} = 0\n$$\n这给出了截距估计量 $\\hat{\\beta}_0$ 的表达式：\n$$\n\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}\n$$\n这个结果表明回归线必须穿过均值点 $(\\bar{T}, \\bar{N})$。\n\n接下来，对 $\\beta_1$ 求导：\n$$\n\\frac{\\partial S}{\\partial \\beta_1} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\n将 $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$ 的表达式代入此方程：\n$$\n\\sum_{i=1}^{n} T_i (N_i - (\\bar{N} - \\hat{\\beta}_1 \\bar{T}) - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i ((N_i - \\bar{N}) - \\hat{\\beta}_1 (T_i - \\bar{T})) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i (T_i - \\bar{T}) = 0\n$$\n通过识别各项与样本协方差和方差的关系，可以简化这些求和。对于任意变量 $X$，项 $\\sum_{i=1}^{n} (T_i - \\bar{T})(X_i - \\bar{X})$ 可以写作 $\\sum T_i(X_i - \\bar{X}) - \\bar{T}\\sum(X_i - \\bar{X})$。由于 $\\sum(X_i - \\bar{X}) = 0$，该式简化为 $\\sum T_i(X_i - \\bar{X})$。将此应用于我们的方程，得到：\n$$\n\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} (T_i - \\bar{T})^2 = 0\n$$\n解出斜率估计量 $\\hat{\\beta}_1$：\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})}{\\sum_{i=1}^{n} (T_i - \\bar{T})^2}\n$$\n这是 OLS 斜率估计量的著名公式，即 $T$ 和 $N$ 的样本协方差与 $T$ 的样本方差之比。\n\n现在，我们将这些统计估计量与气候模型的物理参数联系起来。通过比较回归模型 $N = \\beta_0 + \\beta_1 T$ 与物理模型 $N = F - \\lambda T$，我们可以做出以下识别：\n- 截距 $\\beta_0$ 对应于有效辐射强迫 $F$。因此，$F$ 的估计量是 $\\hat{F} = \\hat{\\beta}_0$。在物理上，这是在施加辐射强迫的瞬间，在任何温度变化发生之前（$T=0$ 时）的净辐射不平衡（$N$）。\n- 斜率 $\\beta_1$ 对应于 $-\\lambda$。因此，$\\lambda$ 的估计量是 $\\hat{\\lambda} = -\\hat{\\beta}_1$。参数 $\\lambda$ 代表所有气候反馈的净效应。一个稳定的气候系统以负反馈为特征，这意味着随着温度 $T$ 的升高，净辐射通量 $N$ 会减少（更多能量辐射到太空中），从而抵消最初的增温。因此，对于一个稳定系统，$\\lambda > 0$，这意味着 $N$ 相对于 $T$ 的斜率必须为负，即 $\\beta_1  0$。\n\n最后，平衡温度异常 $T_{\\mathrm{eq}}$ 是指在恒定强迫 $F$ 作用下，如果系统被允许达到平衡状态，它将达到的温度变化。在平衡状态下，温度不再变化，大气层顶的净能量通量异常必须为零（$N=0$）。在理想化的能量平衡方程中令 $N=0$ 可得：\n$$\n0 = F - \\lambda T_{\\mathrm{eq}}\n$$\n求解 $T_{\\mathrm{eq}}$ 可得：\n$$\nT_{\\mathrm{eq}} = \\frac{F}{\\lambda}\n$$\n估计的平衡温度异常 $\\hat{T}_{\\mathrm{eq}}$ 使用估计的参数计算得出：\n$$\n\\hat{T}_{\\mathrm{eq}} = \\frac{\\hat{F}}{\\hat{\\lambda}}\n$$\n只要 $\\hat{\\lambda} \\neq 0$，该值就有良好定义。\n\n**2. 实现策略**\n\n程序将为 $\\hat{\\beta}_1$、$\\hat{\\beta}_0$、$\\hat{F}$、$\\hat{\\lambda}$ 和 $\\hat{T}_{\\mathrm{eq}}$ 实现推导出的公式。对于每个测试用例数据集 $(T_i, N_i)$：\n1.  计算样本均值 $\\bar{T}$ 和 $\\bar{N}$。\n2.  计算项 $\\sum_{i=1}^{n} (T_i - \\bar{T})^2$，该项与 $T$ 的方差成正比。为保证数值稳健性，应检查该项不为零，因为除以零会使斜率未定义。\n3.  计算项 $\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})$，该项与 $T$ 和 $N$ 的协方差成正比。\n4.  使用上面推导的公式计算斜率估计量 $\\hat{\\beta}_1$。\n5.  计算截距估计量 $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$。\n6.  确定物理参数估计值：$\\hat{F} = \\hat{\\beta}_0$ 和 $\\hat{\\lambda} = -\\hat{\\beta}_1$。\n7.  计算估计的平衡温度异常 $\\hat{T}_{\\mathrm{eq}} = \\hat{F} / \\hat{\\lambda}$。谨慎起见，应检查 $\\hat{\\lambda} \\approx 0$ 的情况。\n8.  将得到的三元组 $[\\hat{F}, \\hat{\\lambda}, \\hat{T}_{\\mathrm{eq}}]$ 四舍五入到 3 位小数并存储它们。\n9.  处理完所有测试用例后，将收集到的结果格式化为指定的单行字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Gregory regression on paired temperature and flux anomaly data\n    to estimate Effective Radiative Forcing (F), climate feedback parameter (lambda),\n    and equilibrium temperature anomaly (T_eq).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (noise-free reference)\n        (\n            [0.0, 0.5, 1.0, 1.5, 2.0],  # T data\n            [4.0, 3.5, 3.0, 2.5, 2.0]   # N data\n        ),\n        # Test case 2 (moderate variability)\n        (\n            [0.1, 0.3, 0.7, 1.2, 1.8],\n            [3.63, 3.31, 2.88, 2.22, 1.54]\n        ),\n        # Test case 3 (near-zero forcing with small variability)\n        (\n            [-0.1, 0.0, 0.1, 0.2, 0.3],\n            [0.35, 0.2, 0.07, -0.11, -0.25]\n        ),\n        # Test case 4 (low variance in T; numerically delicate)\n        (\n            [1.00, 1.01, 0.99, 1.02, 0.98],\n            [1.702, 1.691, 1.708, 1.686, 1.715]\n        )\n    ]\n\n    results = []\n    \n    for T_list, N_list in test_cases:\n        T = np.array(T_list, dtype=np.float64)\n        N = np.array(N_list, dtype=np.float64)\n\n        if T.shape[0]  2:\n            # Not enough data for regression, though not expected in this problem\n            # Push NaN or handle appropriately if this could occur\n            continue\n\n        # Step 1: Compute sample means\n        T_mean = np.mean(T)\n        N_mean = np.mean(N)\n\n        # Step 2: Compute terms for OLS estimators from first principles\n        # Numerator for slope: sum of cross-products of deviations\n        # Denominator for slope: sum of squared deviations for the independent variable\n        cov_tn_sum = np.sum((T - T_mean) * (N - N_mean))\n        var_t_sum = np.sum((T - T_mean)**2)\n\n        # Numerical robustness check\n        # A variance of exactly zero makes the slope undefined.\n        if np.isclose(var_t_sum, 0.0):\n            # This case is not expected based on problem description\n            # but is good practice to handle.\n            # We can't determine unique parameters.\n            F_hat, lambda_hat, T_eq_hat = np.nan, np.nan, np.nan\n        else:\n            # Step 3: Calculate OLS coefficients (beta_1_hat and beta_0_hat)\n            beta_1_hat = cov_tn_sum / var_t_sum\n            beta_0_hat = N_mean - beta_1_hat * T_mean\n\n            # Step 4: Map OLS coefficients to physical parameters\n            # F_hat is the intercept\n            F_hat = beta_0_hat\n            # lambda_hat is the negative of the slope\n            lambda_hat = -beta_1_hat\n            \n            # Step 5: Compute equilibrium temperature anomaly\n            # Check for non-zero feedback parameter to avoid division by zero\n            if np.isclose(lambda_hat, 0.0):\n                T_eq_hat = np.inf if F_hat > 0 else (-np.inf if F_hat  0 else np.nan)\n            else:\n                T_eq_hat = F_hat / lambda_hat\n        \n        # Step 6: Round results to 3 decimal places\n        F_hat_rounded = round(F_hat, 3)\n        lambda_hat_rounded = round(lambda_hat, 3)\n        T_eq_hat_rounded = round(T_eq_hat, 3)\n        \n        results.extend([F_hat_rounded, lambda_hat_rounded, T_eq_hat_rounded])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nsolve()\n```"
        }
    ]
}