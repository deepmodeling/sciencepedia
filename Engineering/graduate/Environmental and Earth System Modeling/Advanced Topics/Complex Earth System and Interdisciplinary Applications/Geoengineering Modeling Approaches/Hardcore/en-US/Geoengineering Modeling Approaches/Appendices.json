{
    "hands_on_practices": [
        {
            "introduction": "A primary goal of Carbon Dioxide Removal (CDR) is to lower the atmospheric concentration of $\\mathrm{CO_2}$. This exercise provides foundational practice in modeling this process using a single-box atmospheric model, a cornerstone of conceptual climate science. By solving for the concentration trajectory $C(t)$, you will learn to integrate key real-world complexities, such as leakage from storage and the saturation of natural carbon sinks, which are critical for evaluating the long-term effectiveness of any CDR deployment .",
            "id": "3882593",
            "problem": "A single-box atmospheric carbon dioxide model is used to evaluate a sustained carbon dioxide removal intervention with leakage and time-varying terrestrial uptake saturation. Let $C(t)$ denote the globally averaged atmospheric $\\mathrm{CO_2}$ concentration in parts per million (ppm), and let $C_0$ denote a fixed preindustrial reference concentration. Starting from conservation of carbon mass for the atmospheric box, assume:\n- There are no anthropogenic emissions after $t=0$.\n- A sustained carbon dioxide removal program extracts $\\mathrm{CO_2}$ from the atmosphere at rate $R(t)=R_0$ (in ppm per year), but a constant fraction $\\ell$ leaks back rapidly, so the effective permanent removal is $(1-\\ell) R_0$.\n- Natural terrestrial uptake relaxes $C(t)$ toward $C_0$ according to a linearized flux $-k(t)\\,[C(t)-C_0]$ that declines over time due to saturation, with $k(t)=\\dfrac{k_0}{1+t/\\tau_s}$.\n\nThus the atmospheric mass balance for $t \\ge 0$ is\n$$\n\\frac{dC}{dt} \\;=\\; -\\,(1-\\ell)\\,R_0 \\;-\\; k(t)\\,\\bigl[C(t)-C_0\\bigr],\n$$\nwith initial condition $C(0)=C_i$. The instantaneous top-of-atmosphere radiative forcing associated with the concentration pathway is taken as the well-tested logarithmic relation\n$$\nF(t) \\;=\\; \\alpha \\,\\ln\\!\\left(\\frac{C(t)}{C_0}\\right).\n$$\n\nUsing only these assumptions, derive $C(t)$ analytically and compute $F(T)$ at $T=100$ years for the parameter set\n- $C_0=280\\ \\text{ppm}$,\n- $C_i=415\\ \\text{ppm}$,\n- $R_0=1.5\\ \\text{ppm}\\ \\text{yr}^{-1}$,\n- $\\ell = 0.20$,\n- $k_0=0.020\\ \\text{yr}^{-1}$,\n- $\\tau_s=50\\ \\text{yr}$,\n- $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$.\n\nRound your final numerical answer for $F(T)$ to four significant figures. Express the final value in $\\text{W}\\ \\text{m}^{-2}$.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- Governing differential equation for atmospheric $\\mathrm{CO_2}$ concentration $C(t)$: $\\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0]$\n- Time-dependent natural uptake rate: $k(t) = \\frac{k_0}{1+t/\\tau_s}$\n- Initial condition: $C(0) = C_i$\n- Radiative forcing formula: $F(t) = \\alpha \\ln(\\frac{C(t)}{C_0})$\n- Target time for evaluation: $T = 100$ years\n- Parameter values:\n  - $C_0=280\\ \\text{ppm}$\n  - $C_i=415\\ \\text{ppm}$\n  - $R_0=1.5\\ \\text{ppm}\\ \\text{yr}^{-1}$\n  - $\\ell = 0.20$\n  - $k_0=0.020\\ \\text{yr}^{-1}$\n  - $\\tau_s=50\\ \\text{yr}$\n  - $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem uses a single-box model, a standard simplification in climate science for illustrating fundamental dynamics. The mass balance equation correctly accounts for sources and sinks. The sink term, representing relaxation to a preindustrial state, is a valid linearization. Its time-dependent coefficient $k(t)$ is a plausible, albeit simple, way to model the saturation of terrestrial carbon sinks. The logarithmic formula for radiative forcing is a well-established empirical relationship used extensively in climate modeling (e.g., by the IPCC). All parameter values are physically realistic.\n- **Well-Posed**: The problem is an initial value problem for a first-order linear ordinary differential equation. The coefficient functions are continuous for $t \\ge 0$. Standard existence and uniqueness theorems guarantee that a unique solution $C(t)$ exists.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free of ambiguity or subjective claims.\n- **Completeness**: All necessary constants, functional forms, and the initial condition are provided to solve for $C(t)$ and subsequently $F(T)$.\n- **Consistency**: There are no internal contradictions in the provided data or equations. The units are consistent.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and self-contained. It is deemed **valid**. A full solution will be derived.\n\nThe governing equation is a first-order linear ordinary differential equation:\n$$ \\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0] $$\nWe can rearrange this into the standard form $\\frac{dy}{dt} + P(t)y = Q(t)$. Let us define a new variable $y(t) = C(t) - C_0$. Then $\\frac{dy}{dt} = \\frac{dC}{dt}$. Substituting this into the equation gives:\n$$ \\frac{dy}{dt} = -(1-\\ell)R_0 - k(t)y(t) $$\n$$ \\frac{dy}{dt} + k(t)y(t) = -(1-\\ell)R_0 $$\nThis is a linear ODE for $y(t)$ with the initial condition $y(0) = C(0) - C_0 = C_i - C_0$. The equation is solved using an integrating factor, $I(t)$, defined as:\n$$ I(t) = \\exp\\left(\\int k(t) dt\\right) $$\nFirst, we compute the integral of $k(t) = \\frac{k_0}{1+t/\\tau_s}$:\n$$ \\int k(t) dt = \\int \\frac{k_0}{1+t/\\tau_s} dt $$\nUsing the substitution $u = 1 + t/\\tau_s$, we have $du = \\frac{1}{\\tau_s}dt$, so $dt = \\tau_s du$.\n$$ \\int \\frac{k_0}{u} \\tau_s du = k_0 \\tau_s \\int \\frac{1}{u} du = k_0 \\tau_s \\ln(u) = k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right) $$\nThe integrating factor is therefore:\n$$ I(t) = \\exp\\left(k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right)\\right) = \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} $$\nThe solution for $y(t)$ is given by:\n$$ y(t) = \\frac{1}{I(t)}\\left[\\int I(t) Q(t) dt + \\mathcal{K}\\right] $$\nwhere $Q(t) = -(1-\\ell)R_0$ is a constant and $\\mathcal{K}$ is the constant of integration.\n$$ y(t) I(t) = \\int -(1-\\ell)R_0 \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt + \\mathcal{K} $$\nWe evaluate the integral:\n$$ \\int \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt = \\tau_s \\int u^{k_0 \\tau_s} du = \\frac{\\tau_s}{k_0 \\tau_s+1} u^{k_0 \\tau_s+1} = \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} $$\nSubstituting this back, we get:\n$$ y(t)\\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} = - (1-\\ell)R_0 \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} + \\mathcal{K} $$\nSolving for $y(t)$:\n$$ y(t) = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\mathcal{K} \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\nWe find $\\mathcal{K}$ using the initial condition $y(0) = C_i - C_0$. At $t=0$:\n$$ C_i - C_0 = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} (1) + \\mathcal{K} (1) $$\n$$ \\mathcal{K} = (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} $$\nSubstituting $\\mathcal{K}$ back into the solution for $y(t)$ and then finding $C(t) = y(t) + C_0$:\n$$ C(t) = C_0 - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\left[ (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\right] \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\nNow we substitute the numerical values to find $C(T)$ for $T=100\\ \\text{yr}$.\nFirst, calculate the composite parameters:\n- The exponent term: $k_0 \\tau_s = (0.020\\ \\text{yr}^{-1})(50\\ \\text{yr}) = 1$.\n- The effective removal rate term: $(1-\\ell)R_0 = (1-0.20)(1.5\\ \\text{ppm}\\ \\text{yr}^{-1}) = (0.80)(1.5\\ \\text{ppm}\\ \\text{yr}^{-1}) = 1.2\\ \\text{ppm}\\ \\text{yr}^{-1}$.\n- The coefficient term: $\\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} = \\frac{(1.2\\ \\text{ppm}\\ \\text{yr}^{-1})(50\\ \\text{yr})}{1+1} = \\frac{60\\ \\text{ppm}}{2} = 30\\ \\text{ppm}$.\n- The initial anomaly: $C_i - C_0 = 415\\ \\text{ppm} - 280\\ \\text{ppm} = 135\\ \\text{ppm}$.\n- The time term argument at $t=T=100$: $1+\\frac{T}{\\tau_s} = 1+\\frac{100\\ \\text{yr}}{50\\ \\text{yr}} = 1+2 = 3$.\n\nSubstitute these into the analytical solution for $C(t)$ at $t=T$:\n$$ C(100) = 280\\ \\text{ppm} - 30\\ \\text{ppm} \\times (3) + \\left[ 135\\ \\text{ppm} + 30\\ \\text{ppm} \\right] \\times (3)^{-1} $$\n$$ C(100) = 190 + 55 = 245\\ \\text{ppm} $$\nThe concentration at $T=100$ years is $C(100) = 245\\ \\text{ppm}$.\n\nFinally, we compute the radiative forcing $F(T)$ at $T=100$ years:\n$$ F(T) = \\alpha \\ln\\left(\\frac{C(T)}{C_0}\\right) $$\n$$ F(100) = 5.35\\ \\text{W}\\ \\text{m}^{-2} \\times \\ln\\left(\\frac{245}{280}\\right) $$\nThe fraction simplifies to $\\frac{245}{280} = \\frac{7 \\times 35}{8 \\times 35} = \\frac{7}{8} = 0.875$.\n$$ F(100) = 5.35 \\times \\ln(0.875) $$\n$$ F(100) \\approx 5.35 \\times (-0.13353139) \\approx -0.71441794\\ \\text{W}\\ \\text{m}^{-2} $$\nRounding to four significant figures, we get:\n$$ F(100) \\approx -0.7144\\ \\text{W}\\ \\text{m}^{-2} $$",
            "answer": "$$\n\\boxed{-0.7144}\n$$"
        },
        {
            "introduction": "While both Carbon Dioxide Removal (CDR) and Solar Radiation Management (SRM) are proposed geoengineering strategies, they do not affect the climate system in equivalent ways. This practice introduces the critical concept of \"efficacy\" ($e$), which quantifies how the climate system's temperature response can differ for the same magnitude of radiative forcing from different agents. By comparing the forcing required from CDR versus SRM to achieve an identical temperature change, you will gain a more nuanced understanding of the imperfections and non-linearities inherent in attempting to counteract greenhouse gas warming .",
            "id": "3882680",
            "problem": "A central simplifying framework in climate system modeling is the globally averaged energy balance model, which states that the net top-of-atmosphere energy imbalance $N$ responds to imposed effective radiative forcing $F$ and temperature change $T$ through a linear feedback parameter $\\lambda$ such that $N = F - \\lambda T$. At equilibrium or for a long-lived forcing and response, one may approximate $N \\approx 0$ so that $T = F / \\lambda$. Different forcing agents can have different efficacies, defined as the factor $e$ that scales the temperature response relative to the reference agent for the same radiative forcing magnitude, so that for a given agent $T = e F / \\lambda$. For changes in atmospheric carbon dioxide concentration, we adopt the standard radiative forcing formula $F_{\\mathrm{CO_{2}}}(C) = 5.35 \\,\\ln\\!\\big(C/C_{0}\\big)$, where $C$ is the atmospheric carbon dioxide concentration in parts per million (ppm) and $C_{0}$ is a reference concentration.\n\nConsider a baseline state with atmospheric carbon dioxide concentration $C = 420\\,\\mathrm{ppm}$ and reference $C_{0} = 280\\,\\mathrm{ppm}$. Let Carbon Dioxide Removal (CDR) remove $1\\,\\mathrm{ppm}$, so that the concentration decreases to $C - \\Delta C$ with $\\Delta C = 1\\,\\mathrm{ppm}$. Assume the climate feedback parameter is $\\lambda = 1.2\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$, the efficacy for carbon dioxide forcing is $e_{\\mathrm{CDR}} = 1.0$, and the efficacy for Solar Radiation Management (SRM) forcing is $e_{\\mathrm{SRM}} = 0.9$. Define the difference in the required SRM radiative forcing and the magnitude of the CDR radiative forcing, per $1\\,\\mathrm{ppm}$ removed, as\n$$\n\\Delta F \\equiv F_{\\mathrm{SRM,req}} - \\big| \\Delta F_{\\mathrm{CDR}} \\big|,\n$$\nwhere $F_{\\mathrm{SRM,req}}$ is the magnitude of SRM forcing needed to produce $|\\Delta T|$ equal to the magnitude of the temperature change due to the CDR-induced forcing $\\Delta F_{\\mathrm{CDR}} = F_{\\mathrm{CO_{2}}}(C - \\Delta C) - F_{\\mathrm{CO_{2}}}(C)$.\n\nUsing the framework above, compute $\\Delta F$ for the specified parameters. Round your answer to four significant figures. Express your final answer in watts per square meter ($\\mathrm{W}\\,\\mathrm{m}^{-2}$).",
            "solution": "The globally averaged energy balance model with efficacy states that the temperature response to a forcing agent with efficacy $e$ is given by\n$$\n\\Delta T = \\frac{e\\,\\Delta F}{\\lambda}.\n$$\nFor the CDR case, which alters the carbon dioxide concentration, the efficacy is $e_{\\mathrm{CDR}} = 1.0$. The standard carbon dioxide radiative forcing relation is\n$$\nF_{\\mathrm{CO_{2}}}(C) = 5.35\\,\\ln\\!\\left(\\frac{C}{C_{0}}\\right).\n$$\nA removal of $\\Delta C = 1\\,\\mathrm{ppm}$ from $C = 420\\,\\mathrm{ppm}$ yields a forcing change\n$$\n\\Delta F_{\\mathrm{CDR}} = F_{\\mathrm{CO_{2}}}(C - \\Delta C) - F_{\\mathrm{CO_{2}}}(C) = 5.35\\,\\ln\\!\\left(\\frac{C - \\Delta C}{C}\\right) = 5.35\\,\\ln\\!\\left(1 - \\frac{\\Delta C}{C}\\right).\n$$\nSubstituting $C = 420$ and $\\Delta C = 1$,\n$$\n\\Delta F_{\\mathrm{CDR}} = 5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right).\n$$\nThis quantity is negative, representing a cooling forcing. The magnitude is\n$$\n\\big|\\Delta F_{\\mathrm{CDR}}\\big| = -\\Delta F_{\\mathrm{CDR}} = -5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right).\n$$\nThe associated absolute temperature change is\n$$\n\\big|\\Delta T\\big| = \\frac{e_{\\mathrm{CDR}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|}{\\lambda} = \\frac{1.0}{\\lambda}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\nTo achieve the same $\\big|\\Delta T\\big|$ with SRM, whose efficacy is $e_{\\mathrm{SRM}} = 0.9$, the required SRM forcing magnitude is\n$$\nF_{\\mathrm{SRM,req}} = \\frac{\\lambda\\,\\big|\\Delta T\\big|}{e_{\\mathrm{SRM}}} = \\frac{\\lambda}{e_{\\mathrm{SRM}}}\\,\\frac{e_{\\mathrm{CDR}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|}{\\lambda} = \\frac{e_{\\mathrm{CDR}}}{e_{\\mathrm{SRM}}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\nWith $e_{\\mathrm{CDR}} = 1.0$, this reduces to\n$$\nF_{\\mathrm{SRM,req}} = \\frac{1}{e_{\\mathrm{SRM}}}\\,\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\nTherefore, the difference defined in the problem is\n$$\n\\Delta F = F_{\\mathrm{SRM,req}} - \\big|\\Delta F_{\\mathrm{CDR}}\\big| = \\left(\\frac{1}{e_{\\mathrm{SRM}}} - 1\\right)\\big|\\Delta F_{\\mathrm{CDR}}\\big|.\n$$\nWe now compute $\\big|\\Delta F_{\\mathrm{CDR}}\\big|$ numerically:\n$$\n\\ln\\!\\left(\\frac{419}{420}\\right) \\approx -0.00238379135,\n$$\nso\n$$\n\\big|\\Delta F_{\\mathrm{CDR}}\\big| = -5.35\\,\\ln\\!\\left(\\frac{419}{420}\\right) \\approx 5.35 \\times 0.00238379135 \\approx 0.01275328372\\,\\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$\nWith $e_{\\mathrm{SRM}} = 0.9$,\n$$\n\\Delta F = \\left(\\frac{1}{0.9} - 1\\right) \\times 0.01275328372 = \\left(1.111111\\ldots - 1\\right)\\times 0.01275328372 = \\frac{1}{9}\\times 0.01275328372 \\approx 0.00141703152\\,\\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$\nRounded to four significant figures, the result is $0.001417\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.",
            "answer": "$$\\boxed{0.001417}$$"
        },
        {
            "introduction": "Idealized analytical models are powerful for building intuition, but modern geoengineering research relies on analyzing output from complex Earth System Models. This hands-on coding exercise bridges that gap by having you implement the Gregory regression method, a standard technique used by climate scientists to diagnose the Effective Radiative Forcing ($F$) and climate feedback parameter ($\\lambda$) from simulation data. Mastering this computational tool will enable you to extract the most fundamental parameters governing a model's climate response, moving from theoretical concepts to practical data analysis .",
            "id": "3882625",
            "problem": "You are modeling the radiative impact of a geoengineering perturbation using the Gregory regression framework. The global conservation of energy at the top-of-atmosphere dictates that the net top-of-atmosphere flux anomaly satisfies the relationship\n$$\nN = F - \\lambda\\,T + \\varepsilon,\n$$\nwhere $N$ is the net top-of-atmosphere flux anomaly in $\\mathrm{W\\,m^{-2}}$, $F$ is the Effective Radiative Forcing (ERF) in $\\mathrm{W\\,m^{-2}}$, $\\lambda$ is the net climate feedback parameter in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $T$ is the global-mean surface air temperature anomaly in $\\mathrm{K}$, and $\\varepsilon$ represents internal variability and model residuals. A basic and widely used estimation method is the Gregory regression, which fits a straight line to $N$ as a function of $T$ using Ordinary Least Squares (OLS), and interprets the intercept as the ERF $F$ and the slope as $-\\lambda$.\n\nTask:\n1) Starting from the definitions of $N$, $F$, and $\\lambda$ and the global energy balance expressed above, derive the OLS estimators for the intercept and slope of the linear relationship between $N$ and $T$ by minimizing the sum of squared residuals. Show how to extract estimates $\\hat{F}$ and $\\hat{\\lambda}$ from the fitted intercept and slope, making clear the physical meaning of the sign convention.\n2) Implement a program that, given paired samples $\\{(T_i,N_i)\\}_{i=1}^{n}$ for several test cases, estimates $\\hat{F}$ (in $\\mathrm{W\\,m^{-2}}$) and $\\hat{\\lambda}$ (in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$) via OLS, and then computes the implied equilibrium temperature anomaly estimate $\\hat{T}_{\\mathrm{eq}} = \\hat{F}/\\hat{\\lambda}$ (in $\\mathrm{K}$) for a step forcing within the same one-box energy balance framework.\n3) All outputs must be expressed in the specified physical units, but your program must output only the numbers without unit symbols. Round each reported value to $3$ decimals.\n\nUse the following test suite of prescribed, paired datasets $(T_i,N_i)$ with $i=1,\\dots,n$ as lists. Each list entry is a real number. Units are $\\mathrm{K}$ for $T$ and $\\mathrm{W\\,m^{-2}}$ for $N$.\n\n- Test case $1$ (noise-free reference):\n  $$\n  T = [0.0,\\,0.5,\\,1.0,\\,1.5,\\,2.0],\\quad\n  N = [4.0,\\,3.5,\\,3.0,\\,2.5,\\,2.0].\n  $$\n- Test case $2$ (moderate variability):\n  $$\n  T = [0.1,\\,0.3,\\,0.7,\\,1.2,\\,1.8],\\quad\n  N = [3.63,\\,3.31,\\,2.88,\\,2.22,\\,1.54].\n  $$\n- Test case $3$ (near-zero forcing with small variability):\n  $$\n  T = [-0.1,\\,0.0,\\,0.1,\\,0.2,\\,0.3],\\quad\n  N = [0.35,\\,0.2,\\,0.07,\\,-0.11,\\,-0.25].\n  $$\n- Test case $4$ (low variance in $T$; numerically delicate):\n  $$\n  T = [1.00,\\,1.01,\\,0.99,\\,1.02,\\,0.98],\\quad\n  N = [1.702,\\,1.691,\\,1.708,\\,1.686,\\,1.715].\n  $$\n\nFor each test case, compute and report the triplet $[\\hat{F},\\hat{\\lambda},\\hat{T}_{\\mathrm{eq}}]$, each rounded to $3$ decimals. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, ordered by test case and flattened in sequence, that is\n$$\n[\\hat{F}_1,\\hat{\\lambda}_1,\\hat{T}_{\\mathrm{eq},1},\\hat{F}_2,\\hat{\\lambda}_2,\\hat{T}_{\\mathrm{eq},2},\\hat{F}_3,\\hat{\\lambda}_3,\\hat{T}_{\\mathrm{eq},3},\\hat{F}_4,\\hat{\\lambda}_4,\\hat{T}_{\\mathrm{eq},4}].\n$$\n\nConstraints and expectations:\n- You must use Ordinary Least Squares (OLS) to fit a line to $N$ as a function of $T$ for each test case. Do not use any prepackaged regression outside of the permitted libraries; implement the OLS solution from first principles using sample means and sums.\n- Ensure numerical robustness by handling the potential case of extremely small variance in $T$; if the variance of $T$ is exactly zero, the regression is undefined. The provided test cases avoid exactly zero variance.\n- Angle units are not required. No percentages are involved.\n- Results must be floats. The final output format is exactly a single line with the flattened list as specified above.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of climate modeling, specifically the Gregory regression method for estimating radiative forcing and climate feedbacks from an energy balance model. The problem is well-posed, providing all necessary data and mathematical definitions for a unique solution via Ordinary Least Squares (OLS) regression. The language is objective and the requirements are unambiguous.\n\nThe problem requires the derivation and implementation of OLS estimators for a linear model describing the top-of-atmosphere energy balance.\n\n**1. Derivation of OLS Estimators and Physical Interpretation**\n\nThe governing physical relationship is given by the energy balance equation:\n$$\nN = F - \\lambda T + \\varepsilon\n$$\nwhere $N$ is the net top-of-atmosphere flux anomaly, $T$ is the global-mean surface air temperature anomaly, $F$ is the Effective Radiative Forcing (ERF), $\\lambda$ is the net climate feedback parameter, and $\\varepsilon$ represents unforced internal variability and model residuals.\n\nWe are tasked with fitting a linear model to a set of data points $\\{(T_i, N_i)\\}_{i=1}^{n}$ of the form:\n$$\nN_i = \\beta_0 + \\beta_1 T_i + e_i\n$$\nHere, $\\beta_0$ and $\\beta_1$ are the intercept and slope coefficients of the regression line, and $e_i$ are the residuals, which are the differences between the observed values $N_i$ and the values predicted by the model, $\\hat{N}_i = \\beta_0 + \\beta_1 T_i$.\n\nThe method of Ordinary Least Squares (OLS) determines the values of the coefficients, denoted $\\hat{\\beta}_0$ and $\\hat{\\beta}_1$, that minimize the sum of squared residuals (SSR). The SSR, as a function of $\\beta_0$ and $\\beta_1$, is:\n$$\nS(\\beta_0, \\beta_1) = \\sum_{i=1}^{n} e_i^2 = \\sum_{i=1}^{n} (N_i - (\\beta_0 + \\beta_1 T_i))^2\n$$\nTo find the minimum of $S$, we take the partial derivatives with respect to $\\beta_0$ and $\\beta_1$ and set them to zero.\n\nFirst, with respect to $\\beta_0$:\n$$\n\\frac{\\partial S}{\\partial \\beta_0} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-1) = 0\n$$\n$$\n\\sum_{i=1}^{n} (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} N_i - n \\hat{\\beta}_0 - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i = 0\n$$\nDividing by the number of data points, $n$, we obtain a relationship involving the sample means, $\\bar{T} = \\frac{1}{n} \\sum T_i$ and $\\bar{N} = \\frac{1}{n} \\sum N_i$:\n$$\n\\bar{N} - \\hat{\\beta}_0 - \\hat{\\beta}_1 \\bar{T} = 0\n$$\nThis gives an expression for the intercept estimator $\\hat{\\beta}_0$:\n$$\n\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}\n$$\nThis result shows that the regression line must pass through the point of means $(\\bar{T}, \\bar{N})$.\n\nNext, with respect to $\\beta_1$:\n$$\n\\frac{\\partial S}{\\partial \\beta_1} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\nSubstitute the expression for $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$ into this equation:\n$$\n\\sum_{i=1}^{n} T_i (N_i - (\\bar{N} - \\hat{\\beta}_1 \\bar{T}) - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i ((N_i - \\bar{N}) - \\hat{\\beta}_1 (T_i - \\bar{T})) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i (T_i - \\bar{T}) = 0\n$$\nThe sums can be simplified by recognizing their relationship to sample covariance and variance. The term $\\sum_{i=1}^{n} (T_i - \\bar{T})(X_i - \\bar{X})$ for any variable $X$ can be written as $\\sum T_i(X_i - \\bar{X}) - \\bar{T}\\sum(X_i - \\bar{X})$. Since $\\sum(X_i - \\bar{X}) = 0$, this simplifies to $\\sum T_i(X_i - \\bar{X})$. Applying this to our equation gives:\n$$\n\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} (T_i - \\bar{T})^2 = 0\n$$\nSolving for the slope estimator $\\hat{\\beta}_1$:\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})}{\\sum_{i=1}^{n} (T_i - \\bar{T})^2}\n$$\nThis is the well-known formula for the OLS slope estimator, which is the ratio of the sample covariance of $T$ and $N$ to the sample variance of $T$.\n\nNow, we relate these statistical estimators to the physical parameters of the climate model. By comparing the regression model $N = \\beta_0 + \\beta_1 T$ with the physical model $N = F - \\lambda T$, we can make the following identifications:\n- The intercept $\\beta_0$ corresponds to the Effective Radiative Forcing, $F$. Thus, the estimator for $F$ is $\\hat{F} = \\hat{\\beta}_0$. Physically, this is the net radiation imbalance ($N$) at the moment the forcing is applied, before any temperature change has occurred ($T=0$).\n- The slope $\\beta_1$ corresponds to $-\\lambda$. Thus, the estimator for $\\lambda$ is $\\hat{\\lambda} = -\\hat{\\beta}_1$. The parameter $\\lambda$ represents the net effect of all climate feedbacks. A stable climate system is characterized by negative feedbacks, meaning that as the temperature $T$ increases, the net radiation flux $N$ decreases (more energy is radiated to space), which counteracts the initial warming. Therefore, for a stable system, $\\lambda > 0$, which implies that the slope of $N$ versus $T$ must be negative, i.e., $\\beta_1 < 0$.\n\nFinally, the equilibrium temperature anomaly, $T_{\\mathrm{eq}}$, is the temperature change the system would reach if it were allowed to equilibrate to a constant forcing $F$. At equilibrium, the temperature is no longer changing, and the net energy flux anomaly at the top of the atmosphere must be zero ($N=0$). Setting $N=0$ in the idealized energy balance equation gives:\n$$\n0 = F - \\lambda T_{\\mathrm{eq}}\n$$\nSolving for $T_{\\mathrm{eq}}$ yields:\n$$\nT_{\\mathrm{eq}} = \\frac{F}{\\lambda}\n$$\nThe estimated equilibrium temperature anomaly, $\\hat{T}_{\\mathrm{eq}}$, is computed using the estimated parameters:\n$$\n\\hat{T}_{\\mathrm{eq}} = \\frac{\\hat{F}}{\\hat{\\lambda}}\n$$\nThis value is well-defined provided $\\hat{\\lambda} \\neq 0$.\n\n**2. Implementation Strategy**\n\nThe program will implement the derived formulas for $\\hat{\\beta}_1$, $\\hat{\\beta}_0$, $\\hat{F}$, $\\hat{\\lambda}$, and $\\hat{T}_{\\mathrm{eq}}$. For each test case dataset $(T_i, N_i)$:\n1.  Compute the sample means $\\bar{T}$ and $\\bar{N}$.\n2.  Compute the term $\\sum_{i=1}^{n} (T_i - \\bar{T})^2$, which is proportional to the variance of $T$. As a safeguard for numerical robustness, one should check that this term is not zero, as division by zero would render the slope undefined.\n3.  Compute the term $\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})$, which is proportional to the covariance of $T$ and $N$.\n4.  Calculate the slope estimator $\\hat{\\beta}_1$ using the formula derived above.\n5.  Calculate the intercept estimator $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$.\n6.  Determine the physical parameter estimates: $\\hat{F} = \\hat{\\beta}_0$ and $\\hat{\\lambda} = -\\hat{\\beta}_1$.\n7.  Calculate the estimated equilibrium temperature anomaly $\\hat{T}_{\\mathrm{eq}} = \\hat{F} / \\hat{\\lambda}$. A check for $\\hat{\\lambda} \\approx 0$ is prudent.\n8.  Round the resulting triplet $[\\hat{F}, \\hat{\\lambda}, \\hat{T}_{\\mathrm{eq}}]$ to $3$ decimal places and store them.\n9.  After processing all test cases, format the collected results into the specified single-line string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Gregory regression on paired temperature and flux anomaly data\n    to estimate Effective Radiative Forcing (F), climate feedback parameter (lambda),\n    and equilibrium temperature anomaly (T_eq).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (noise-free reference)\n        (\n            [0.0, 0.5, 1.0, 1.5, 2.0],  # T data\n            [4.0, 3.5, 3.0, 2.5, 2.0]   # N data\n        ),\n        # Test case 2 (moderate variability)\n        (\n            [0.1, 0.3, 0.7, 1.2, 1.8],\n            [3.63, 3.31, 2.88, 2.22, 1.54]\n        ),\n        # Test case 3 (near-zero forcing with small variability)\n        (\n            [-0.1, 0.0, 0.1, 0.2, 0.3],\n            [0.35, 0.2, 0.07, -0.11, -0.25]\n        ),\n        # Test case 4 (low variance in T; numerically delicate)\n        (\n            [1.00, 1.01, 0.99, 1.02, 0.98],\n            [1.702, 1.691, 1.708, 1.686, 1.715]\n        )\n    ]\n\n    results = []\n    \n    for T_list, N_list in test_cases:\n        T = np.array(T_list, dtype=np.float64)\n        N = np.array(N_list, dtype=np.float64)\n\n        if T.shape[0] < 2:\n            # Not enough data for regression, though not expected in this problem\n            # Push NaN or handle appropriately if this could occur\n            continue\n\n        # Step 1: Compute sample means\n        T_mean = np.mean(T)\n        N_mean = np.mean(N)\n\n        # Step 2: Compute terms for OLS estimators from first principles\n        # Numerator for slope: sum of cross-products of deviations\n        # Denominator for slope: sum of squared deviations for the independent variable\n        cov_tn_sum = np.sum((T - T_mean) * (N - N_mean))\n        var_t_sum = np.sum((T - T_mean)**2)\n\n        # Numerical robustness check\n        # A variance of exactly zero makes the slope undefined.\n        if np.isclose(var_t_sum, 0.0):\n            # This case is not expected based on problem description\n            # but is good practice to handle.\n            # We can't determine unique parameters.\n            F_hat, lambda_hat, T_eq_hat = np.nan, np.nan, np.nan\n        else:\n            # Step 3: Calculate OLS coefficients (beta_1_hat and beta_0_hat)\n            beta_1_hat = cov_tn_sum / var_t_sum\n            beta_0_hat = N_mean - beta_1_hat * T_mean\n\n            # Step 4: Map OLS coefficients to physical parameters\n            # F_hat is the intercept\n            F_hat = beta_0_hat\n            # lambda_hat is the negative of the slope\n            lambda_hat = -beta_1_hat\n            \n            # Step 5: Compute equilibrium temperature anomaly\n            # Check for non-zero feedback parameter to avoid division by zero\n            if np.isclose(lambda_hat, 0.0):\n                T_eq_hat = np.inf if F_hat > 0 else (-np.inf if F_hat < 0 else np.nan)\n            else:\n                T_eq_hat = F_hat / lambda_hat\n        \n        # Step 6: Round results to 3 decimal places\n        F_hat_rounded = round(F_hat, 3)\n        lambda_hat_rounded = round(lambda_hat, 3)\n        T_eq_hat_rounded = round(T_eq_hat, 3)\n        \n        results.extend([F_hat_rounded, lambda_hat_rounded, T_eq_hat_rounded])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nsolve()\n```"
        }
    ]
}