{
    "hands_on_practices": [
        {
            "introduction": "社会-生态系统常常表现出非线性行为，包括突变或“临界点”。理解这些现象背后的数学结构对于预测和管理它们至关重要。这项练习聚焦于分岔分析，这是一个强大的工具，可以用来描绘系统在不断变化的外部压力下的所有可能状态及其稳定性。通过分析一个简单但具有代表性的模型，你将学会如何识别平衡点以及系统基本行为发生改变的临界阈值，这项技能是理解系统恢复力和崩溃的基础。",
            "id": "3896255",
            "problem": "考虑一个描述家庭采纳环保行为比例的程式化社会生态临界模型，该比例由状态变量 $x$ 表示。其采纳动态由以下一维常微分方程（ODE）表示：\n$$\n\\dot{x} = \\mu - x + x^{3},\n$$\n其中 $\\mu$ 是一个无量纲的外部驱动因素，代表了支持采纳行为的净社会政治压力（例如，激励减去成本）。三次非线性项捕捉了增强的社会反馈（例如，模仿和规范内化），而线性损失项则捕捉了自发放弃或饱和效应。\n\n从动力系统的基本概念出发——平衡点是 $\\dot{x} = 0$ 的点，一维系统中的局部稳定性由右侧函数对 $x$ 的导数在平衡点处的符号决定，而当一对斜率为零的平衡点合并时，会发生鞍结分岔——请对该系统随 $\\mu$ 变化进行分岔分析：\n\n- 通过求解 $\\mu - x + x^{3} = 0$，找出所有作为 $\\mu$ 函数的平衡点 $x^{\\ast}$。\n- 使用一维线性化准则确定这些平衡点的局部稳定性。\n- 找出发生鞍结分岔的 $\\mu$ 的临界值。\n\n以精确值（不进行四舍五入）表示最终的 $\\mu$ 临界值。最终答案必须以单行矩阵的形式报告临界值集合。$\\mu$ 是无量纲的。",
            "solution": "本问题要求对由以下常微分方程（ODE）给出的一维动力系统进行分岔分析：\n$$\n\\dot{x} = \\mu - x + x^{3}\n$$\n状态变量是 $x$，$\\mu$ 是一个控制参数。分析过程包括识别平衡点，确定其稳定性，以及找出发生鞍结分岔的 $\\mu$ 的临界值。\n\n设该常微分方程的右侧为函数 $f(x, \\mu)$，即 $\\dot{x} = f(x, \\mu) = \\mu - x + x^{3}$。\n\n**步骤 1：平衡点**\n\n平衡点（记为 $x^{\\ast}$）是使系统保持静止的 $x$ 值，即 $\\dot{x} = 0$。我们通过求解方程 $f(x^{\\ast}, \\mu) = 0$ 来找到这些点。\n$$\n\\mu - x^{\\ast} + (x^{\\ast})^{3} = 0\n$$\n这个方程可以重排，将 $\\mu$ 表示为平衡态 $x^{\\ast}$ 的函数：\n$$\n\\mu = x^{\\ast} - (x^{\\ast})^{3}\n$$\n这个三次关系表明，对于一个给定的 $\\mu$ 值，可以有一个或三个实平衡点 $x^{\\ast}$。\n\n**步骤 2：稳定性分析**\n\n在一维系统中，平衡点 $x^{\\ast}$ 的局部稳定性由函数 $f(x, \\mu)$ 对 $x$ 的导数在 $x^{\\ast}$ 处的值的符号决定。我们来计算这个导数：\n$$\nf'(x) = \\frac{d}{dx}f(x, \\mu) = \\frac{d}{dx}(\\mu - x + x^{3}) = -1 + 3x^{2}\n$$\n稳定性判据如下：\n- 如果 $f'(x^{\\ast})  0$，平衡点是局部稳定的（吸引子）。\n- 如果 $f'(x^{\\ast})  0$，平衡点是局部不稳定的（排斥子）。\n- 如果 $f'(x^{\\ast}) = 0$，平衡点是临界稳定的，此时可能发生分岔。\n\n根据 $f'(x)$ 的表达式，我们可以基于 $x^{\\ast}$ 的值来确定稳定性：\n- 稳定 ($f'(x^{\\ast})0$)：$-1 + 3(x^{\\ast})^{2}  0 \\implies 3(x^{\\ast})^{2}  1 \\implies (x^{\\ast})^{2}  \\frac{1}{3}$。这对应于 $-\\frac{1}{\\sqrt{3}}  x^{\\ast}  \\frac{1}{\\sqrt{3}}$。\n- 不稳定 ($f'(x^{\\ast})0$)：$-1 + 3(x^{\\ast})^{2}  0 \\implies (x^{\\ast})^{2}  \\frac{1}{3}$。这对应于 $x^{\\ast}  \\frac{1}{\\sqrt{3}}$ 或 $x^{\\ast}  -\\frac{1}{\\sqrt{3}}$。\n\n**步骤 3：鞍结分岔**\n\n当一对平衡点——一个稳定点和一个不稳定点——合并并消失时，会发生鞍结（或折叠）分岔。这发生在平衡点是临界稳定的点，即 $f'(x^{\\ast})=0$。为了找到发生这些分岔的参数 $\\mu$ 的临界值，我们必须同时求解两个方程组成的方程组：平衡条件和临界稳定条件。\n\n临界点 $(x_c, \\mu_c)$ 的方程组为：\n$$\n\\begin{cases}\n\\mu_c - x_c + x_c^3 = 0  \\quad (\\text{平衡条件: } f(x_c, \\mu_c) = 0) \\\\\n-1 + 3x_c^2 = 0  \\quad (\\text{临界稳定条件: } f'(x_c) = 0)\n\\end{cases}\n$$\n\n从第二个方程，我们求出发生分岔时的 $x$ 值：\n$$\n3x_c^2 = 1 \\implies x_c^2 = \\frac{1}{3} \\implies x_c = \\pm\\frac{1}{\\sqrt{3}}\n$$\n这两个是发生分岔的平衡点。现在，我们将这些 $x_c$ 的值代入第一个方程（或重排后的平衡条件 $\\mu_c = x_c - x_c^3$），以求出相应的 $\\mu$ 的临界值，记为 $\\mu_c$。\n\n情况 1：$x_c = +\\frac{1}{\\sqrt{3}}$\n$$\n\\mu_{c1} = x_c - x_c^3 = \\frac{1}{\\sqrt{3}} - \\left(\\frac{1}{\\sqrt{3}}\\right)^3 = \\frac{1}{\\sqrt{3}} - \\frac{1}{3\\sqrt{3}} = \\frac{3 - 1}{3\\sqrt{3}} = \\frac{2}{3\\sqrt{3}}\n$$\n\n情况 2：$x_c = -\\frac{1}{\\sqrt{3}}$\n$$\n\\mu_{c2} = x_c - x_c^3 = -\\frac{1}{\\sqrt{3}} - \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 = -\\frac{1}{\\sqrt{3}} - \\left(-\\frac{1}{3\\sqrt{3}}\\right) = -\\frac{1}{\\sqrt{3}} + \\frac{1}{3\\sqrt{3}} = \\frac{-3 + 1}{3\\sqrt{3}} = -\\frac{2}{3\\sqrt{3}}\n$$\n\n发生鞍结分岔的 $\\mu$ 的临界值是 $\\mu_c = \\pm\\frac{2}{3\\sqrt{3}}$。这些值在分母有理化后可以写成 $\\mu_c = \\pm\\frac{2\\sqrt{3}}{9}$。对于介于 $-\\frac{2\\sqrt{3}}{9}$ 和 $\\frac{2\\sqrt{3}}{9}$ 之间的 $\\mu$ 值，系统有三个平衡点（两个稳定点，一个不稳定点）。对于 $|\\mu|  \\frac{2\\sqrt{3}}{9}$，系统只有一个稳定的平衡点。在临界值 $\\mu_c$ 处，其中两个平衡点合并。\n\n$\\mu$ 的两个临界值是 $-\\frac{2\\sqrt{3}}{9}$ 和 $\\frac{2\\sqrt{3}}{9}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{2\\sqrt{3}}{9}  \\frac{2\\sqrt{3}}{9} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "社会-生态系统中的“社会”部分涉及到人类行为者基于自身激励做出决策。博弈论为分析这些策略互动提供了一个形式化的框架。这项实践深入探讨了一个经典的生物经济学问题：公共池塘资源的管理。你将运用博弈论来模拟个体收获者的行为，并将分散决策的结果——即“公地悲剧”——与社会最优解进行比较。这项练习突出了治理和制度在协调个人激励与集体可持续性方面的关键作用。",
            "id": "3896254",
            "problem": "考虑一个社会生态系统中的可再生资源，由 $N$ 个相同的代理人进行捕捞，其生态生物量状态 $B(t)$ 的演化遵循带捕捞的逻辑斯蒂增长模型：\n$$\n\\frac{dB}{dt} \\;=\\; r\\,B\\left(1 - \\frac{B}{K}\\right) \\;-\\; q\\,E\\,B,\n$$\n其中 $r0$ 是内禀增长率，$K0$ 是环境承载力，$q0$ 是捕捞系数，$E \\equiv \\sum_{i=1}^{N} E_i$ 是总捕捞努力量。每个代理人 $i$ 选择努力量 $E_i \\ge 0$ 并获得瞬时效用\n$$\nu_i(E_i, B) \\;=\\; p\\,q\\,E_i\\,B \\;-\\; c\\,E_i \\;-\\; \\phi\\,q\\,E_i\\,B,\n$$\n其中 $p0$ 是外生的单位捕捞价格，$c0$ 是努力量的边际成本，$\\phi \\ge 0$ 是参数化了的每单位捕捞内化的生态惩罚。假设系统在一个稳定状态下进行管理，代理人能预期到由上述动态过程所决定的长期可持续生物量，并且参数满足 $(p - \\phi)\\,q\\,K  c$ 以确保存在内部正努力量解。\n\n将这种相互作用建模为一个同期对称 Nash 博弈，其中 $N$ 个相同的代理人同时选择 $\\{E_i\\}$，将其他人的努力量视为给定，并认识到可持续生物量通过生态动态过程取决于总努力量。然后，推导：\n\n1. 每个代理人的对称 Nash 均衡努力量 $E_i^{\\ast}$，其中所有代理人选择相同的努力量。\n2. 社会计划者的最优总努力量 $E^{\\mathrm{SP}}$，该努力量在可持续生物量水平上，受相同生态动态过程的约束，最大化了总瞬时净收益 $\\sum_{i=1}^{N} u_i(E_i, B)$。\n\n最后，将分散化结果与中心化结果之间的比较表示为在可持续生物量水平上，分散化总努力量与中心化总努力量之比：\n$$\nR \\;\\equiv\\; \\frac{E_{\\mathrm{tot}}^{\\mathrm{Nash}}}{E_{\\mathrm{tot}}^{\\mathrm{SP}}},\n$$\n其中 $E_{\\mathrm{tot}}^{\\mathrm{Nash}} \\equiv \\sum_{i=1}^{N} E_i^{\\ast}$ 且 $E_{\\mathrm{tot}}^{\\mathrm{SP}} \\equiv E^{\\mathrm{SP}}$。请以仅含 $N$ 的闭式解析表达式给出 $R$。不需要进行数值近似。最终答案应为无量纲量，且不应包含单位。",
            "solution": "求解过程分为四个步骤：\n1.  确定可持续生物量水平作为总努力量的函数。\n2.  推导分散化情景下的对称 Nash 均衡努力量。\n3.  推导中心化社会计划者情景下的最优努力量。\n4.  计算两种情景下总努力量的比率。\n\n步骤 1：可持续生物量\n生态动态由带捕捞的逻辑斯蒂增长模型给出：\n$$ \\frac{dB}{dt} = rB\\left(1 - \\frac{B}{K}\\right) - qEB $$\n其中 $E$ 是总捕捞努力量，$E = \\sum_{i=1}^{N} E_i$。假设系统处于稳定状态，这意味着生物量水平是恒定的，即 $\\frac{dB}{dt} = 0$。\n$$ rB\\left(1 - \\frac{B}{K}\\right) - qEB = 0 $$\n该方程对 $B$ 有两个可能的稳态解。一个是平凡解 $B=0$，对应于资源灭绝。另一个是我们寻求的非平凡正生物量水平。我们可以通过两边同除以 $B$ (假设 $B0$) 来找到它：\n$$ r\\left(1 - \\frac{B}{K}\\right) - qE = 0 $$\n求解 $B$ 作为总努力量 $E$ 的函数：\n$$ 1 - \\frac{B}{K} = \\frac{qE}{r} $$\n$$ \\frac{B}{K} = 1 - \\frac{qE}{r} $$\n$$ B(E) = K\\left(1 - \\frac{qE}{r}\\right) $$\n该表达式表示在给定总努力量 $E$ 下的可持续生物量水平。为保证生物量为正，要求 $E  \\frac{r}{q}$。\n\n步骤 2：对称 Nash 均衡（分散化结果）\n在分散化情景中，每个 $N$ 个相同的代理人选择其努力量 $E_i$ 以最大化其自身个体效用，同时将其他代理人的努力量 $E_{-i} = \\sum_{j \\neq i} E_j$ 视为给定。代理人 $i$ 的效用为：\n$$ u_i(E_i, B) = p\\,q\\,E_i\\,B - c\\,E_i - \\phi\\,q\\,E_i\\,B = ((p - \\phi)qB - c)E_i $$\n每个代理人都认识到，可持续生物量 $B$ 取决于总努力量 $E = E_i + E_{-i}$。将 $B(E)$ 的表达式代入效用函数，我们得到代理人 $i$ 仅关于努力量的效用函数：\n$$ u_i(E_i, E_{-i}) = \\left((p - \\phi)qK\\left(1 - \\frac{q(E_i + E_{-i})}{r}\\right) - c\\right)E_i $$\n为了找到最优努力量 $E_i$，我们将 $u_i$ 对 $E_i$ 求导并令其等于零。\n$$ \\frac{\\partial u_i}{\\partial E_i} = (p - \\phi)qK\\left(1 - \\frac{q(E_i + E_{-i})}{r}\\right) - c + E_i\\left((p - \\phi)qK\\left(-\\frac{q}{r}\\right)\\right) = 0 $$\n$$ (p - \\phi)qK\\left(1 - \\frac{q(2E_i + E_{-i})}{r}\\right) - c = 0 $$\n该方程给出了代理人 $i$ 的反应函数。我们正在寻找一个对称 Nash 均衡，其中所有代理人都选择相同的努力水平，即对所有 $i=1, \\dots, N$ 都有 $E_i = E^*$。在这种情况下，$E_{-i} = (N-1)E^*$。将此代入一阶条件：\n$$ (p - \\phi)qK\\left(1 - \\frac{q(2E^* + (N-1)E^*)}{r}\\right) = c $$\n$$ (p - \\phi)qK\\left(1 - \\frac{q(N+1)E^*}{r}\\right) = c $$\n现在，我们求解对称均衡努力量 $E^*$：\n$$ 1 - \\frac{q(N+1)E^*}{r} = \\frac{c}{(p - \\phi)qK} $$\n$$ \\frac{q(N+1)E^*}{r} = 1 - \\frac{c}{(p - \\phi)qK} $$\n$$ E^* = \\frac{r}{q(N+1)}\\left(1 - \\frac{c}{(p - \\phi)qK}\\right) $$\n在分散化 Nash 均衡中的总努力量是个体努力量的总和：\n$$ E_{\\mathrm{tot}}^{\\mathrm{Nash}} = \\sum_{i=1}^{N} E^* = N E^* = \\frac{Nr}{q(N+1)}\\left(1 - \\frac{c}{(p - \\phi)qK}\\right) $$\n\n步骤 3：社会计划者最优解（中心化结果）\n社会计划者旨在最大化所有代理人的总净收益，即他们效用的总和。设 $U_{SP}$ 为总社会福利。\n$$ U_{SP} = \\sum_{i=1}^{N} u_i = \\sum_{i=1}^{N} \\left(((p - \\phi)qB - c)E_i\\right) = ((p - \\phi)qB - c) \\sum_{i=1}^{N} E_i $$\n设 $E^{\\mathrm{SP}}$ 为社会计划者选择的总努力量。那么 $U_{SP}$ 变为：\n$$ U_{SP}(E^{\\mathrm{SP}}) = ((p - \\phi)qB - c)E^{\\mathrm{SP}} $$\n计划者也受到生态动态过程的约束，因此我们代入 $B(E^{\\mathrm{SP}}) = K\\left(1 - \\frac{qE^{\\mathrm{SP}}}{r}\\right)$：\n$$ U_{SP}(E^{\\mathrm{SP}}) = \\left((p - \\phi)qK\\left(1 - \\frac{qE^{\\mathrm{SP}}}{r}\\right) - c\\right)E^{\\mathrm{SP}} $$\n为了找到最优总努力量 $E^{\\mathrm{SP}}$，我们将 $U_{SP}$ 对 $E^{\\mathrm{SP}}$ 求导并令其等于零。\n$$ \\frac{d U_{SP}}{d E^{\\mathrm{SP}}} = (p - \\phi)qK\\left(1 - \\frac{qE^{\\mathrm{SP}}}{r}\\right) - c + E^{\\mathrm{SP}}\\left((p - \\phi)qK\\left(-\\frac{q}{r}\\right)\\right) = 0 $$\n$$ (p - \\phi)qK\\left(1 - \\frac{2qE^{\\mathrm{SP}}}{r}\\right) - c = 0 $$\n求解社会最优总努力量，我们记为 $E_{\\mathrm{tot}}^{\\mathrm{SP}} = E^{\\mathrm{SP}}$：\n$$ 1 - \\frac{2qE_{\\mathrm{tot}}^{\\mathrm{SP}}}{r} = \\frac{c}{(p - \\phi)qK} $$\n$$ \\frac{2qE_{\\mathrm{tot}}^{\\mathrm{SP}}}{r} = 1 - \\frac{c}{(p - \\phi)qK} $$\n$$ E_{\\mathrm{tot}}^{\\mathrm{SP}} = \\frac{r}{2q}\\left(1 - \\frac{c}{(p - \\phi)qK}\\right) $$\n\n步骤 4：分散化与中心化努力量之比\n最后，我们计算总分散化努力量与总中心化努力量之比 $R$。\n$$ R = \\frac{E_{\\mathrm{tot}}^{\\mathrm{Nash}}}{E_{\\mathrm{tot}}^{\\mathrm{SP}}} = \\frac{\\frac{Nr}{q(N+1)}\\left(1 - \\frac{c}{(p - \\phi)qK}\\right)}{\\frac{r}{2q}\\left(1 - \\frac{c}{(p - \\phi)qK}\\right)} $$\n条件 $(p - \\phi)qK  c$ 确保了项 $\\left(1 - \\frac{c}{(p - \\phi)qK}\\right)$ 为正，因此非零，从而可以在分子和分母中消去。\n$$ R = \\frac{\\frac{Nr}{q(N+1)}}{\\frac{r}{2q}} = \\frac{Nr}{q(N+1)} \\cdot \\frac{2q}{r} $$\n$$ R = \\frac{2N}{N+1} $$\n该表达式按要求给出了仅作为代理人数量 $N$ 的函数的比率。这一结果量化了该模型中的“公地悲剧”：随着 $N$ 的增加，分散化与中心化努力量之比接近 2，表明对资源的显著过度开采。",
            "answer": "$$\\boxed{\\frac{2N}{N+1}}$$"
        },
        {
            "introduction": "社会影响和行为改变往往通过互动网络传播，而不是在均匀混合的群体中。网络科学为模拟这些结构化过程提供了工具。这项练习从解析模型转向计算模拟，要求你在一个网络上实现一个阈值模型来模拟社会传染过程。你将探索一个初始的改变是如何可能逐渐消失，或是引发一个系统级的级联效应，以及这个结果如何对网络结构敏感。这种动手编程实践对于探索那些通常难以用解析方法处理的复杂动态至关重要。",
            "id": "3896268",
            "problem": "考虑一个社会-生态互动网络上的级联阈值传染模型，该网络由一个无向、简单的二元邻接矩阵 $A \\in \\{0,1\\}^{N \\times N}$ 表示，其中 $N$ 是节点数。令 $S \\subset \\{0,1,\\dots,N-1\\}$ 为初始激活节点的种子集，并令阈值向量为 $\\boldsymbol{\\theta} \\in [0,1]^N$。将节点 $i$ 的度定义为 $d_i = \\sum_{j=0}^{N-1} A_{ij}$。令离散时间 $t$ 的二元状态向量为 $\\mathbf{x}(t) \\in \\{0,1\\}^N$，其中如果节点 $i$ 在时间 $t$ 是激活的，则 $x_i(t)=1$，否则 $x_i(t)=0$。初始条件为：对于 $i \\in S$，有 $x_i(0)=1$；对于 $i \\notin S$，有 $x_i(0)=0$。\n\n对所有节点 $i \\in \\{0,1,\\dots,N-1\\}$，同步更新规则是级联的，定义如下：\n$$\nx_i(t+1) =\n\\begin{cases}\n1,  \\text{如果 } x_i(t)=1, \\\\\n1,  \\text{如果 } d_i0 \\text{ 且 } \\dfrac{1}{d_i}\\sum_{j=0}^{N-1} A_{ij} x_j(t) \\ge \\theta_i, \\\\\n0,  \\text{其他情况。}\n\\end{cases}\n$$\n对于度为零的节点（$d_i=0$），我们约定在上述规则中将 $\\dfrac{1}{d_i}\\sum_{j} A_{ij} x_j(t)$ 视为 $0$。\n\n级联规模 $C$ 定义为收敛时的激活节点数：\n$$\nC = \\sum_{i=0}^{N-1} x_i(\\infty),\n$$\n其中 $\\mathbf{x}(t)$ 在同步、级联规则下收敛到一个不动点 $\\mathbf{x}(\\infty)$。\n\n你需要计算每个测试用例的 $C$。此外，还应通过比较度相似但聚类水平不同的网络之间的级联规模来检验聚类敏感性。聚类通过节点 $i$ 的局部聚类系数来量化，\n$$\nC_i = \\frac{2 T_i}{d_i(d_i-1)},\n$$\n其中 $T_i$ 是与节点 $i$ 关联的三角形数量，当 $d_i2$ 时，$C_i=0$。全局聚类系数是平均值 $\\bar{C} = \\dfrac{1}{N}\\sum_{i=0}^{N-1} C_i$。在解决方案中，讨论在同步阈值动态下，$\\bar{C}$ 的变化如何影响级联规模。\n\n测试套件包括以下用例。对于每个用例，阈值向量是恒定的，即对所有 $i$ 都有 $\\theta_i=\\theta$。\n\n- 用例 1：一个 Watts–Strogatz (WS) 小世界环形晶格网络，其中 $N=20$，平均度 $k=4$，重连概率 $p=0$，阈值 $\\theta=0.25$，种子集 $S=\\{0\\}$。通过对节点索引使用模运算，将每个节点 $i$ 与其两侧的 $k/2=2$ 个最近邻连接，来构建初始环。\n\n- 用例 2：具有相同 WS 环形晶格参数的网络，其中 $N=20$，$k=4$，$p=0$，阈值 $\\theta=0.5$，种子集 $S=\\{0,1\\}$。\n\n- 用例 3：一个 WS 网络，其中 $N=20$，$k=4$，$p=0.8$，阈值 $\\theta=0.5$，种子集 $S=\\{0,1\\}$。重连时使用固定的随机数生成器种子 $42$。对于 $r \\in \\{1,2\\}$，每条有向环边 $(i, i+r)$ 以概率 $p$ 独立地重连到一个新的端点 $w$，该端点从 $\\{0,1,\\dots,N-1\\} \\setminus \\left(\\{i\\} \\cup \\mathcal{N}(i)\\right)$ 中均匀随机选择，其中 $\\mathcal{N}(i)$ 是 $i$ 的当前邻居集，从而避免自环和重复边。\n\n- 用例 4：一个自定义网络，其中 $N=5$，由节点 $\\{0,1,2,3\\}$ 上的路径和一个孤立节点 $\\{4\\}$ 组成。非零邻接项为 $A_{01}=A_{10}=A_{12}=A_{21}=A_{23}=A_{32}=1$，所有其他项为 $0$。阈值 $\\theta=0.25$，种子集 $S=\\{0\\}$。\n\n- 用例 5：WS 环形晶格网络，其中 $N=20$，$k=4$，$p=0$，阈值 $\\theta=1.0$，种子集 $S=\\{0,1\\}$。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n- 构建指定的邻接矩阵。\n- 模拟同步阈值动态直到收敛。\n- 计算每个用例的级联规模 $C$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个结果是按上述顺序列出的相应用例的整数级联规模 $C$。此问题不涉及物理单位。不涉及角度。百分比应按已为 $\\theta$ 指定的小数形式表示。",
            "solution": "我们从社会-生态互动网络的表示开始，它是一个由二元邻接矩阵 $A \\in \\{0,1\\}^{N \\times N}$ 编码的无向、简单图，其中如果节点 $i$ 和 $j$ 之间存在互动边，则 $A_{ij}=1$，否则 $A_{ij}=0$。节点 $i$ 的度是 $d_i = \\sum_{j=0}^{N-1} A_{ij}$，即其互动伙伴的数量。\n\n阈值传染规则是社会和社会-生态系统中采纳动态的一个经过充分检验的模型。令阈值向量为 $\\boldsymbol{\\theta} \\in [0,1]^N$，初始种子集为 $S \\subset \\{0,1,\\dots,N-1\\}$。同步、级联的更新规则是：\n$$\nx_i(t+1) =\n\\begin{cases}\n1,  \\text{如果 } x_i(t)=1, \\\\\n1,  \\text{如果 } d_i0 \\text{ 且 } \\dfrac{1}{d_i}\\sum_{j=0}^{N-1} A_{ij} x_j(t) \\ge \\theta_i, \\\\\n0,  \\text{其他情况,}\n\\end{cases}\n$$\n约定对于度为零的节点（$d_i=0$），分数 $\\dfrac{1}{d_i}\\sum_{j} A_{ij} x_j(t)$ 被视为 $0$。这一约定反映了孤立节点无法从邻居那里获得社会或生态强化，因此除非在初始时被设为种子，否则它们将保持非激活状态。\n\n此规则是级联的，意味着一旦一个节点被激活（$x_i(t)=1$），它在之后的所有时间里都保持激活状态。从根本上说，其关键属性是：\n- 单调性：由于更新只会将 $x_i$ 从 $0$ 翻转到 $1$，而绝不会从 $1$ 翻转到 $0$，因此序列 $\\{\\mathbf{x}(t)\\}_{t=0}^{\\infty}$ 在分量顺序上是非递减的。\n- 有限收敛性：因为状态空间是有限的（$\\{0,1\\}^N$），且序列是单调的，所以它必须在最多 $N$ 步内收敛到一个不动点 $\\mathbf{x}(\\infty)$，在该点上，更新规则下不会发生进一步的变化。\n\n因此，可以直接得出一种算法设计：\n- 初始化 $\\mathbf{x}(0)$，如果 $i \\in S$，则 $x_i(0)=1$，否则 $x_i(0)=0$。\n- 同步重复：\n  - 对于每个 $x_i(t)=0$ 的节点 $i$，如果 $d_i>0$，计算分数 $f_i(t) = \\dfrac{1}{d_i}\\sum_{j=0}^{N-1} A_{ij} x_j(t)$，否则 $f_i(t)=0$。\n  - 如果 $f_i(t) \\ge \\theta_i$，则设置 $x_i(t+1)=1$，否则保持 $x_i(t+1)=x_i(t)$。\n- 当 $\\mathbf{x}(t+1)=\\mathbf{x}(t)$ 时停止，并计算级联规模 $C = \\sum_{i=0}^{N-1} x_i(\\infty)$。\n\n为了构建网络，我们使用 Watts–Strogatz (WS) 小世界模型来控制聚类，同时保持度近似恒定：\n- 从一个规则的环形晶格开始：对每个节点 $i$，将其连接到两侧的 $k/2$ 个最近邻，即对于 $r \\in \\{1,2,\\dots,k/2\\}$，添加边 $(i, (i+r) \\bmod N)$ 和 $(i, (i-r) \\bmod N)$。\n- 对于每个 $r \\in \\{1,2,\\dots,k/2\\}$ 的有向环边 $(i, i+r)$，以概率 $p$ 独立地将其端点 $i+r$ 重连到一个从 $\\{0,1,\\dots,N-1\\} \\setminus \\left(\\{i\\} \\cup \\mathcal{N}(i)\\right)$ 中均匀随机选择的节点 $w$，其中 $\\mathcal{N}(i)$ 是 $i$ 的当前邻居集。这可以避免自环和多重边。对于较大的 $p$，生成的无向图的平均度近似为 $k$，且聚类程度降低。\n\n聚类敏感性可以通过局部聚类系数来理解，\n$$\nC_i = \\frac{2 T_i}{d_i(d_i-1)},\n$$\n其中 $T_i$ 统计与 $i$ 关联的三角形数量。全局聚类系数是 $\\bar{C} = \\dfrac{1}{N}\\sum_{i=0}^{N-1} C_i$。在阈值传染中，较高的 $\\bar{C}$ 增加了种子节点的邻居们共享共同联系的概率，从而增强了同时的强化作用。对于度 $d_i=4$、阈值 $\\theta=0.5$ 的情况，激活需要至少 2 个激活的邻居。在一个有许多三角形的晶格网络中，两个相邻的种子节点通常共享邻居，这使得它们的邻居能够满足需要 2 个邻居的要求，从而传播激活。相比之下，在使用大 $p$ 值（较低聚类）重连后，两个种子节点共享的邻居较少，因此只与一个种子节点相邻的节点将无法达到阈值，从而阻碍级联的进行。\n\n我们现在对测试用例进行推理：\n- 用例 1 中，$N=20, k=4, p=0, \\theta=0.25$（对于 $d_i=4$ 的节点，一个邻居就足以激活），激活将沿着环传播，因为每个与激活节点相邻的边界节点都至少有一个激活的邻居，这在同步级联下会导致完全激活。\n- 用例 2 中，$N=20, k=4, p=0, \\theta=0.5$（需要两个邻居），从两个相邻的种子节点开始。在环形晶格中，许多节点与这些种子节点构成三角形，因此能从两个激活的邻居那里获得强化，使得激活波得以传播，并在级联动态下遍及整个网络。\n- 用例 3 中，$N=20, k=4, p=0.8, \\theta=0.5$，使用相同的度，但由于重连（为保证可复现性，随机种子固定为 42），聚类程度较低。在这里，三角形的稀缺减少了种子节点的共享邻居，常常使节点无法达到需要两个邻居的阈值，这与用例 2 相比限制了级联规模。\n- 用例 4 中，$N=5$，网络包含路径 $\\{0,1,2,3\\}$ 和孤立节点 $\\{4\\}$，阈值 $\\theta=0.25$，激活将从节点 0 的种子开始逐步激活路径（每一步需要一个激活的邻居），但度为 $d_4=0$ 的孤立节点除非初始时被设为种子，否则保持非激活状态，从而产生一个不包括节点 4 的级联。\n- 用例 5 中，$N=20, k=4, p=0, \\theta=1.0$，要求所有邻居都被激活才能采纳。从 $S=\\{0,1\\}$ 开始，没有其他节点初始时满足这个要求，级联停止，导致收敛时只有种子节点是激活的。\n\n从算法上讲，同步更新可以高效地实现：\n- 计算一次度向量 $\\mathbf{d} = A \\mathbf{1}$。\n- 在每次迭代中，计算邻居激活计数为 $A \\mathbf{x}(t)$，在 $d_i>0$ 的地方按元素除以 $\\mathbf{d}$，与 $\\boldsymbol{\\theta}$ 比较，并相应地更新非激活节点。\n- 当激活集稳定时终止。对于稀疏计算，每次迭代的复杂度为 $O(|E|)$，对于密集矩阵则为 $O(N^2)$；由于单调级联，迭代次数最多为 $N$。\n\n该程序将构建指定的邻接矩阵（包括具有给定参数的 WS 网络），为每个用例模拟同步阈值动态直到收敛，并以要求的单行格式输出级联规模。用例 2 和用例 3 之间的比较说明了对聚类的敏感性：用例 2 中较高的 $\\bar{C}$ 通过共享邻居和三角形促进了阈值的满足，从而产生更大的级联；而用例 3 中较低的 $\\bar{C}$ 则抑制了这种强化作用，减小了级联规模。",
            "answer": "```python\nimport numpy as np\n\ndef watts_strogatz_adjacency(n: int, k: int, p: float, seed: int | None = None) - np.ndarray:\n    \"\"\"\n    Construct an undirected Watts-Strogatz small-world graph adjacency matrix.\n    - n: number of nodes (must be = 3)\n    - k: mean degree (must be even and  n)\n    - p: rewiring probability in [0,1]\n    - seed: RNG seed for reproducibility\n    Returns adjacency matrix A (n x n) with 0/1 entries, no self-loops, no multi-edges.\n    \"\"\"\n    assert n = 3, \"n must be at least 3\"\n    assert k % 2 == 0 and 0  k  n, \"k must be even and 0  k  n\"\n    rng = np.random.default_rng(seed)\n\n    # Start with ring lattice: connect i to i±r for r = 1..k/2\n    A = np.zeros((n, n), dtype=np.int64)\n    half_k = k // 2\n    # Add undirected edges (i, (i+r) % n) and (i, (i-r) % n)\n    for i in range(n):\n        for r in range(1, half_k + 1):\n            j = (i + r) % n\n            A[i, j] = 1\n            A[j, i] = 1\n\n    # Rewire each directed \"clockwise\" edge (i, i+r) for r=1..k/2 independently\n    # Process edges only in one direction to avoid double rewiring\n    for i in range(n):\n        for r in range(1, half_k + 1):\n            j = (i + r) % n\n            if rng.random()  p:\n                # Attempt to rewire (i, j) to (i, w)\n                # Remove edge (i, j)\n                A[i, j] = 0\n                A[j, i] = 0\n                # Choose new w uniformly from nodes excluding i and current neighbors of i\n                neighbors_i = set(np.where(A[i] == 1)[0])\n                forbidden = neighbors_i.union({i})\n                candidates = [w for w in range(n) if w not in forbidden]\n                if len(candidates) == 0:\n                    # No possible rewiring; restore original edge\n                    A[i, j] = 1\n                    A[j, i] = 1\n                else:\n                    w = rng.choice(candidates)\n                    A[i, w] = 1\n                    A[w, i] = 1\n    return A\n\ndef cascade_size(A: np.ndarray, theta: np.ndarray, seeds: list[int]) - int:\n    \"\"\"\n    Compute cascade size under synchronous progressive threshold dynamics.\n    - A: adjacency matrix (n x n), assumed undirected, simple\n    - theta: threshold vector (length n)\n    - seeds: list of initially active node indices\n    Returns integer cascade size (number of active nodes at convergence).\n    \"\"\"\n    n = A.shape[0]\n    # Binary state vector\n    x = np.zeros(n, dtype=bool)\n    x[seeds] = True\n    degrees = A.sum(axis=1).astype(np.int64)\n\n    # Iteratively update until convergence\n    max_iters = n  # progressive dynamics converge in at most n steps\n    for _ in range(max_iters):\n        prev_x = x.copy()\n        # Compute fraction of active neighbors; handle degree zero separately\n        active_counts = A @ x.astype(np.int64)  # number of active neighbors\n        frac = np.zeros(n, dtype=float)\n        # For nodes with degree  0\n        mask_deg_pos = degrees  0\n        frac[mask_deg_pos] = active_counts[mask_deg_pos] / degrees[mask_deg_pos]\n        # Progressive: already active remain active\n        new_x = prev_x.copy()\n        # Nodes that are inactive but meet threshold become active\n        adopt_mask = (~prev_x)  (frac = theta)\n        new_x[adopt_mask] = True\n        x = new_x\n        if np.array_equal(x, prev_x):\n            break\n    return int(x.sum())\n\ndef solve():\n    # Define test cases as tuples specifying how to build A, theta, seeds\n    # Case 1: WS ring lattice N=20, k=4, p=0.0, theta=0.25, seeds={0}\n    case1 = (\"ws\", {\"n\": 20, \"k\": 4, \"p\": 0.0, \"seed\": None}, {\"theta\": 0.25, \"seeds\": [0]})\n    # Case 2: WS ring lattice N=20, k=4, p=0.0, theta=0.5, seeds={0,1}\n    case2 = (\"ws\", {\"n\": 20, \"k\": 4, \"p\": 0.0, \"seed\": None}, {\"theta\": 0.5, \"seeds\": [0, 1]})\n    # Case 3: WS N=20, k=4, p=0.8, theta=0.5, seeds={0,1}, RNG seed=42\n    case3 = (\"ws\", {\"n\": 20, \"k\": 4, \"p\": 0.8, \"seed\": 42}, {\"theta\": 0.5, \"seeds\": [0, 1]})\n    # Case 4: Custom path on nodes {0,1,2,3} and isolated node {4}, theta=0.25, seeds={0}\n    case4 = (\"custom\", {\"n\": 5, \"edges\": [(0, 1), (1, 2), (2, 3)]}, {\"theta\": 0.25, \"seeds\": [0]})\n    # Case 5: WS ring lattice N=20, k=4, p=0.0, theta=1.0, seeds={0,1}\n    case5 = (\"ws\", {\"n\": 20, \"k\": 4, \"p\": 0.0, \"seed\": None}, {\"theta\": 1.0, \"seeds\": [0, 1]})\n\n    test_cases = [case1, case2, case3, case4, case5]\n\n    results = []\n    for kind, params, dyn in test_cases:\n        theta_val = dyn[\"theta\"]\n        seeds = dyn[\"seeds\"]\n        if kind == \"ws\":\n            A = watts_strogatz_adjacency(n=params[\"n\"], k=params[\"k\"], p=params[\"p\"], seed=params[\"seed\"])\n            theta = np.full(params[\"n\"], theta_val, dtype=float)\n        elif kind == \"custom\":\n            n = params[\"n\"]\n            A = np.zeros((n, n), dtype=np.int64)\n            for (u, v) in params[\"edges\"]:\n                A[u, v] = 1\n                A[v, u] = 1\n            theta = np.full(n, theta_val, dtype=float)\n        else:\n            raise ValueError(\"Unknown test case kind.\")\n        csize = cascade_size(A, theta, seeds)\n        results.append(csize)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}