{
    "hands_on_practices": [
        {
            "introduction": "大气化学系统的一个核心数值挑战是其“刚性”（stiffness），即不同化学反应的发生速率可能相差数个数量级。本练习通过一个简单的、可解析求解的双物种可逆反应系统 $A \\leftrightarrow B$，让学生亲手推导并理解刚性问题为何对标准显式数值方法（如前向欧拉法）构成挑战。通过分析该系统的特征值并确定显式方法的稳定性极限，您将深刻体会到为何大气化学传输模型（CTM）中的化学求解器必须采用专门为刚性系统设计的隐式方法。",
            "id": "3863627",
            "problem": "考虑一个化学输送模型（CTM）的单个网格单元，该模型通过线方法（MOL）求解，在一个刚性化学相互转化测试期间，垂直和水平输送已被关闭。两种气相物质，记为 $A$ 和 $B$，通过反应 $A \\to B$ 和 $B \\to A$ 可逆地相互转化，其一级反应速率常数分别为 $k_{1}$ 和 $k_{2}$，在固定的热力学条件下假定为不随时间变化的常数。令 $[A](t)$ 和 $[B](t)$ 表示随时间 $t$ 变化的数浓度（单位：分子/立方厘米）。根据质量作用定律，并假设在一个混合均匀、没有源、汇或输送的箱体中，控制该系统的常微分方程组（ODEs）为\n$$\n\\frac{d[A]}{dt} \\;=\\; -\\,k_{1}\\,[A] \\;+\\; k_{2}\\,[B], \\qquad\n\\frac{d[B]}{dt} \\;=\\; k_{1}\\,[A] \\;-\\; k_{2}\\,[B].\n$$\n要求您从基本原理出发，推导出一个解析解，该解适用于评估应用于此系统的显式和隐式单步求解器的准确性和刚性问题处理能力。具体来说：\n\n1) 从上述常微分方程组出发，仅使用线性系统的基本性质，为任意非负初始浓度 $[A](0)=A_{0}$ 和 $[B](0)=B_{0}$ 以及任意正常数 $k_{1}$ 和 $k_{2}$，推导出 $[A](t)$ 和 $[B](t)$ 的闭式解析表达式。您的推导应明确利用守恒性质和控制动力学的线性算子的本征结构。\n\n2) 利用线性系统的解析特征值，推导显式欧拉方法的线性稳定性条件。由此，确定最大稳定时间步长 $\\Delta t_{\\max}$，以确保对于右侧雅可比矩阵的所有特征值 $\\lambda$，都有 $|1+\\Delta t\\,\\lambda|  1$。然后，对于具体情况 $k_{1}=500~\\text{s}^{-1}$ 和 $k_{2}=0.5~\\text{s}^{-1}$，计算 $\\Delta t_{\\max}$ 的数值。\n\n将您的最终数值时间步长以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "首先验证该问题是自洽的、有科学依据的且是适定的。所提供的常微分方程组（ODEs）是一阶可逆化学动力学的标准表示。任务涉及使用线性代数的标准解析解法过程和数值方法的经典稳定性分析，这两者都是应用数学和计算科学中的基本主题。该问题是有效的。\n\n**第1部分：解析解的推导**\n\n控制常微分方程组为：\n$$ \\frac{d[A]}{dt} = -k_{1}[A] + k_{2}[B] $$\n$$ \\frac{d[B]}{dt} = k_{1}[A] - k_{2}[B] $$\n这可以写成矩阵形式。令浓度向量为 $\\mathbf{c}(t) = \\begin{pmatrix} [A](t) \\\\ [B](t) \\end{pmatrix}$。则该系统为 $\\frac{d\\mathbf{c}}{dt} = \\mathbf{K}\\mathbf{c}$，其中 $\\mathbf{K}$ 是速率矩阵：\n$$ \\mathbf{K} = \\begin{pmatrix} -k_{1}  k_{2} \\\\ k_{1}  -k_{2} \\end{pmatrix} $$\n初始条件为 $\\mathbf{c}(0) = \\begin{pmatrix} [A](0) \\\\ [B](0) \\end{pmatrix} = \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix}$。\n\n该系统的一个关键性质是总浓度守恒。将两个常微分方程相加得到：\n$$ \\frac{d}{dt}([A] + [B]) = (-k_{1}[A] + k_{2}[B]) + (k_{1}[A] - k_{2}[B]) = 0 $$\n对此方程积分得出 $[A](t) + [B](t) = \\text{常数}$。利用初始条件，我们发现该常数为 $A_{0} + B_{0}$。令 $C_{\\text{tot}} = A_{0} + B_{0}$。\n\n为了利用其本征结构求解该系统，我们求矩阵 $\\mathbf{K}$ 的特征值和特征向量。特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{K} - \\lambda\\mathbf{I}) = 0$ 的根：\n$$ \\det\\begin{pmatrix} -k_{1} - \\lambda  k_{2} \\\\ k_{1}  -k_{2} - \\lambda \\end{pmatrix} = 0 $$\n$$ (-k_{1} - \\lambda)(-k_{2} - \\lambda) - (k_{1})(k_{2}) = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda + k_{1}k_{2} - k_{1}k_{2} = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda = 0 $$\n$$ \\lambda(\\lambda + k_{1} + k_{2}) = 0 $$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -(k_{1} + k_{2})$。\n\n接下来，我们通过求解 $(\\mathbf{K} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$ 来找到相应的特征向量 $\\mathbf{v}$。\n\n对于 $\\lambda_1 = 0$：\n$$ \\begin{pmatrix} -k_{1}  k_{2} \\\\ k_{1}  -k_{2} \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这得到方程 $-k_{1}v_{11} + k_{2}v_{12} = 0$，即 $v_{12} = \\frac{k_{1}}{k_{2}}v_{11}$。一个可能的特征向量是 $\\mathbf{v}_1 = \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix}$。该特征向量对应于稳态或平衡态。\n\n对于 $\\lambda_2 = -(k_{1} + k_{2})$：\n$$ \\begin{pmatrix} -k_{1} - (-(k_{1} + k_{2}))  k_{2} \\\\ k_{1}  -k_{2} - (-(k_{1} + k_{2})) \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} k_{2}  k_{2} \\\\ k_{1}  k_{1} \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这得到方程 $k_{2}v_{21} + k_{2}v_{22} = 0$，即 $v_{21} = -v_{22}$。一个可能的特征向量是 $\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。该特征向量代表了与平衡态的瞬时偏差。\n\n通解是本征模的线性组合：\n$$ \\mathbf{c}(t) = c_{1}e^{\\lambda_1 t}\\mathbf{v}_1 + c_{2}e^{\\lambda_2 t}\\mathbf{v}_2 = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2}e^{-(k_{1}+k_{2})t} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n我们使用 $t=0$ 时的初始条件来求解系数 $c_{1}$ 和 $c_{2}$：\n$$ \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix} = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n这导出了关于 $c_1$ 和 $c_2$ 的线性方程组：\n1) $A_{0} = c_{1}k_{2} + c_{2}$\n2) $B_{0} = c_{1}k_{1} - c_{2}$\n将两个方程相加：$A_{0} + B_{0} = c_{1}(k_{1} + k_{2})$，得到 $c_{1} = \\frac{A_{0} + B_{0}}{k_{1} + k_{2}}$。\n将 $c_{1}$ 代入第一个方程：$c_{2} = A_{0} - c_{1}k_{2} = A_{0} - \\frac{(A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}(k_{1} + k_{2}) - (A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}$。\n\n将 $c_1$ 和 $c_2$ 代回通解，我们得到 $[A](t)$ 和 $[B](t)$ 的闭式解析表达式：\n$$ [A](t) = c_{1}k_{2} + c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{2} + \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = c_{1}k_{1} - c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{1} - \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\n这些表达式可以重排以更清楚地显示平衡部分和瞬态部分：\n$$ [A](t) = \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( A_{0} - \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( B_{0} - \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n\n**第2部分：显式欧拉方法的稳定性分析**\n\n应用于系统 $\\frac{d\\mathbf{c}}{dt} = \\mathbf{f}(\\mathbf{c})$ 的显式欧拉方法由 $\\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{f}(\\mathbf{c}_{n})$ 给出。对于我们的线性系统，$\\mathbf{f}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c}$，所以格式为：\n$$ \\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{K}\\mathbf{c}_{n} = (\\mathbf{I} + \\Delta t \\mathbf{K})\\mathbf{c}_{n} $$\n线性稳定性要求放大矩阵 $\\mathbf{G} = \\mathbf{I} + \\Delta t \\mathbf{K}$ 的特征值的模不超过 $1$。$\\mathbf{G}$ 的特征值由 $1 + \\Delta t \\lambda$ 给出，其中 $\\lambda$ 是 $\\mathbf{K}$ 的特征值。由于系统是线性的，右侧的雅可比矩阵就是矩阵 $\\mathbf{K}$ 本身。\n\n稳定性条件是对于雅可比矩阵的所有特征值 $\\lambda$，都有 $|1 + \\Delta t \\lambda| \\le 1$。问题指定了严格不等式 $|1 + \\Delta t \\lambda|  1$，以确保误差衰减。\n雅可比矩阵的特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -(k_{1} + k_{2})$。\n\n对于 $\\lambda_1 = 0$：\n条件是 $|1 + \\Delta t \\cdot 0| = |1| = 1$。这满足非严格条件 $|1+\\Delta t\\lambda_1|\\le 1$，但不满足严格条件。然而，这个模态与守恒量相关，既不增长也不衰减，因此对于任何 $\\Delta t  0$ 都不会引起不稳定性。稳定性由最刚性（最负）的特征值决定。\n\n对于 $\\lambda_2 = -(k_{1} + k_{2})$：\n条件是 $|1 + \\Delta t (-(k_{1} + k_{2}))|  1$。\n$$ |1 - \\Delta t (k_{1} + k_{2})|  1 $$\n这等价于不等式：\n$$ -1  1 - \\Delta t (k_{1} + k_{2})  1 $$\n我们分析不等式的两个部分：\n1) $1 - \\Delta t (k_{1} + k_{2})  1 \\implies -\\Delta t (k_{1} + k_{2})  0$。因为 $\\Delta t  0$ 且 $k_{1}, k_{2}$ 是正数，所以这总是成立的。\n2) $-1  1 - \\Delta t (k_{1} + k_{2}) \\implies \\Delta t (k_{1} + k_{2})  2 \\implies \\Delta t  \\frac{2}{k_{1} + k_{2}}$。\n\n因此，方法的稳定性受到最刚性模态（对应于 $\\lambda_2$）的限制。最大稳定时间步长是：\n$$ \\Delta t_{\\max} = \\frac{2}{k_{1} + k_{2}} $$\n\n现在，我们计算 $k_{1} = 500~\\text{s}^{-1}$ 和 $k_{2} = 0.5~\\text{s}^{-1}$ 时的数值。\n$$ \\Delta t_{\\max} = \\frac{2}{500~\\text{s}^{-1} + 0.5~\\text{s}^{-1}} = \\frac{2}{500.5}~\\text{s} $$\n$$ \\Delta t_{\\max} \\approx 0.00399600399...~\\text{s} $$\n四舍五入到四位有效数字，我们得到：\n$$ \\Delta t_{\\max} = 0.003996~\\text{s} $$\n用科学记数法表示，这是 $3.996 \\times 10^{-3}~\\text{s}$。\n对时间步长的严格限制是系统刚性的直接后果，其中快速时间尺度 $\\tau_{fast} = (k_1+k_2)^{-1} \\approx 1/500.5~\\text{s}$ 决定了显式方法的稳定性，即使用户只关心向平衡态的缓慢演化，该演化发生在慢速时间尺度 $\\tau_{slow} \\sim k_2^{-1} = 2~\\text{s}$ 上。",
            "answer": "$$\\boxed{3.996 \\times 10^{-3}}$$"
        },
        {
            "introduction": "化学传输模型不仅要处理复杂的化学反应，还必须模拟污染物如何随风（即平流）输送。为了高效地解决这个耦合问题，模型通常采用“算子分裂”（operator splitting）方法，将化学过程和物理输送过程在每个时间步内分开求解。本练习将指导您分析一种高级分裂方法——Strang分裂——的精度，您需要推导一个简单平流-反应方程的精确解和分裂近似解，并定量分析两者之间的误差，从而揭示算子分裂这一核心算法的内在性能和误差来源。",
            "id": "3863578",
            "problem": "考虑一维 ($1$-D) 平流-反应偏微分方程 (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c,\n$$\n该方程定义在周期性域 $x \\in [0,1)$ 上，具有恒定的平流速度 $u$ 和空间变化的一阶损失率 $k(x)$。初始条件为 $c(x,0)=c_0(x)$。令 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 表示在单个时间步长 $\\Delta t$ 内，不使用算子分裂法对耦合的平流-反应系统进行积分所得到的精确解；令 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 表示在相同时间步长内，使用经典的组合“半步反应，全步平流，半步反应”所得到的 Strang 分裂近似解。这里的计算气相化学背景是线性的，其中反应被视为局部常微分方程 (ODE) $c'=-k(x)\\,c$，平流则被视为速度为 $u$ 的纯粹平移。假设边界条件为周期性的，且 $k(x)$ 和 $c_0(x)$ 是光滑函数。\n\n仅从以下几点出发：\n- 线性平流的特征线法，\n- 在固定 $x$ 处，线性 ODE $c'=-k(x)\\,c$ 的空间局部解，\n- Strang 分裂的定义（子算子的二阶组合：反应-平流-反应，时间份数分别为 $\\Delta t/2$、$\\Delta t$、$\\Delta t/2$），\n在周期性域上，用 $c_0$、$k$、$u$、$x$ 和 $\\Delta t$ 推导 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 和 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 的显式封闭形式表达式，过程中不引用任何快捷公式。然后，使用这些表达式，量化逐点差异 $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$，并通过将 Strang 组合与沿特征线的时间积分的梯形逼近联系起来，证明对于光滑的 $k(x)$，时间局部误差的缩放级别为 $O(\\Delta t^3)$。\n\n您必须实现一个程序，该程序在 $x$ 的均匀网格上，针对以下特定的光滑周期性选择，计算此单步局部误差：\n- 域：$x \\in [0,1)$，周期性。\n- 初始条件：$c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$。\n- 空间变化的损失率：$k(x)=k_0 + k_1 \\sin(2\\pi x)$。\n- 平流速度：$u$ 为常数。\n\n您的程序必须：\n- 使用 $x$ 上的高分辨率均匀网格来近似一个时间步长内局部误差的上确界范数 $e(\\Delta t)=\\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty}$。\n- 对于每个测试，将归一化量 $e(\\Delta t)/\\Delta t^3$ 报告为一个浮点数。\n\n仅使用上述基本推导来实现 $c_{\\mathrm{unsplit}}$ 和 $c_{\\mathrm{Strang}}$ 的封闭形式计算。不要使用任何数值时间积分；仅计算推导出的公式。通过周期性三角函数的定义来解析地处理周期性。\n\n测试套件。运行五个测试，涵盖一般情况、用于缩放级别验证的细化以及边缘情况：\n- 测试 1：$\\Delta t=0.2$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n- 测试 2：$\\Delta t=0.1$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n- 测试 3：$\\Delta t=0.05$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n- 测试 4（边缘情况，可交换算子）：$\\Delta t=0.2$，$u=0.7$，$k_0=1.0$，$k_1=0.0$。\n- 测试 5（边缘情况，无平流）：$\\Delta t=0.2$，$u=0.0$，$k_0=1.0$，$k_1=0.5$。\n\n所有量均为无量纲。对于每个测试，使用足够精细的 $x$ 网格计算 $e(\\Delta t)/\\Delta t^3$，以使报告的值能反映理论上的 $\\Delta t^3$ 缩放级别。将每个报告值四舍五入至 $10$ 位有效数字。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，结果顺序与上述测试顺序相同。例如，它应该看起来像\n$[r_1,r_2,r_3,r_4,r_5]$\n其中每个 $r_i$ 是对应测试的四舍五入后的浮点值。",
            "solution": "用户希望验证并解决一个关于一维平流-反应偏微分方程 (PDE) 的 Strang 分裂误差分析的问题。\n\n### 步骤 1：提取已知信息\n\n- **PDE:** $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c$\n- **域：** $x \\in [0,1)$，周期性。\n- **初始条件：** $c(x,0) = c_0(x)$。\n- **平流速度：** $u$ 为常数。\n- **反应速率：** $k(x)$ 是一个空间变化的一阶损失率。\n- **精确解：** $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 是在单个时间步长 $\\Delta t$ 内的精确解。\n- **近似解：** $c_{\\mathrm{Strang}}(x,\\Delta t)$ 是在 $\\Delta t$ 内的 Strang 分裂近似解，使用组合：半步反应 ($\\Delta t/2$)，全步平流 ($\\Delta t$)，半步反应 ($\\Delta t/2$)。\n- **子问题：** 反应是局部 ODE $c'=-k(x)\\,c$，平流是纯粹平移。\n- **任务 1（推导）：** 推导 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 和 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 的显式封闭形式表达式。\n- **任务 2（误差分析）：** 使用推导出的表达式，通过将近似与梯形法则联系起来，证明对于光滑的 $k(x)$，时间局部逐点误差 $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$ 为 $O(\\Delta t^3)$。\n- **任务 3（实现）：** 实现一个程序来计算归一化的局部误差上确界范数 $e(\\Delta t)/\\Delta t^3 = \\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty} / \\Delta t^3$。\n- **具体函数：**\n    - $c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$\n    - $k(x)=k_0 + k_1 \\sin(2\\pi x)$\n- **测试套件：**\n    - 测试 1：$\\Delta t=0.2$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n    - 测试 2：$\\Delta t=0.1$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n    - 测试 3：$\\Delta t=0.05$，$u=0.7$，$k_0=1.0$，$k_1=0.5$。\n    - 测试 4：$\\Delta t=0.2$，$u=0.7$，$k_0=1.0$，$k_1=0.0$。\n    - 测试 5：$\\Delta t=0.2$，$u=0.0$，$k_0=1.0$，$k_1=0.5$。\n- **输出格式：** 一个包含 5 个测试结果的逗号分隔列表，四舍五入到 10 位有效数字，并用方括号括起来。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n- **科学基础：** 该问题是 PDE 数值分析中的一个标准练习，特别关注算子分裂法（Strang 分裂），这在计算物理和化学中被广泛使用。平流-反应方程是输运现象中的一个基本模型。所有概念在数学和计算科学中都已完善建立。\n- **适定性：** 该问题是适定的。具有给定光滑初始条件和周期性边界条件的 PDE 具有唯一、稳定的解。任务是推导并将此精确解与标准的数值近似进行比较。参数已完全指定。\n- **客观性：** 该问题使用精确的数学和计算语言陈述。没有主观或模糊的术语。\n- **完整性：** 该问题是自包含的，提供了执行推导和实现所需的所有必要信息（方程、定义、参数和具体函数）。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是一个在计算科学中定义明确的任务，需要分析推导和数值实现。我现在将着手解决。\n\n### 推导与分析\n\n控制 PDE 是一个线性的、一阶的平流-反应方程：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)c\n$$\n我们被要求找出在单个时间步长 $\\Delta t$ 内的精确解和 Strang 分裂近似解。\n\n#### 1. 精确不分裂解，$c_{\\mathrm{unsplit}}(x, \\Delta t)$\n\n我们使用特征线法。特征曲线 $x(t)$ 由平流速度定义：\n$$\n\\frac{dx}{dt} = u\n$$\n积分此式得到特征线 $x(t) = x_{\\text{start}} + ut$。在时间 $t$ 处的点 $x$ 起源于位置 $x_{\\text{start}} = x - ut$。\n\n沿着特征线，$c(x(t), t)$ 对时间的全导数为：\n$$\n\\frac{dc}{dt} = \\frac{\\partial c}{\\partial t} + \\frac{dx}{dt}\\frac{\\partial c}{\\partial x} = \\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x}\n$$\n将此代入 PDE，我们得到一个沿特征线的关于 $c$ 的常微分方程 (ODE)：\n$$\n\\frac{dc}{dt} = -k(x(t))c\n$$\n为了找到点 $(x, \\Delta t)$ 处的解，我们考虑穿过此点的特征线。该特征线在时间 $t=0$ 时起源于位置 $x_0 = x - u\\Delta t$。ODE 的初始值为 $c(0) = c(x_0, 0) = c_0(x_0)$。\n\n沿特征线的方程是 $\\frac{dc}{dt} = -k(x_0+ut)c$。将此 ODE 从 $t=0$ 积分到 $t=\\Delta t$ 得到：\n$$\nc(x, \\Delta t) = c_0(x_0) \\exp\\left( -\\int_0^{\\Delta t} k(x_0 + u\\tau) d\\tau \\right)\n$$\n代入 $x_0 = x - u\\Delta t$，我们得到：\n$$\nc(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\int_0^{\\Delta t} k(x - u\\Delta t + u\\tau) d\\tau \\right)\n$$\n为了简化积分，我们进行变量替换。令 $s = x - u\\Delta t + u\\tau$。则 $ds = u d\\tau$，积分变量 $s$ 的上下限从 $x - u\\Delta t$（在 $\\tau=0$ 时）到 $x$（在 $\\tau=\\Delta t$ 时）。\n假设 $u \\neq 0$，积分变为：\n$$\n\\int_{x-u\\Delta t}^{x} k(s) \\frac{ds}{u} = \\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds\n$$\n因此，精确解为：\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds \\right) \\quad (\\text{对于 } u \\neq 0)\n$$\n对于 $u=0$ 的特殊情况，PDE 简化为 $\\frac{\\partial c}{\\partial t} = -k(x)c$。对于每个固定的 $x$，这是一个简单的 ODE，其解为 $c(x, t) = c(x,0) \\exp(-k(x)t)$。因此：\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x) \\exp(-k(x)\\Delta t) \\quad (\\text{对于 } u = 0)\n$$\n\n#### 2. Strang 分裂解，$c_{\\mathrm{Strang}}(x, \\Delta t)$\n\nStrang 分裂通过顺序应用反应和输运算子来近似解。其顺序是：半步反应，全步平流，再半步反应。\n\n**步骤 1：第一个半步反应 ($\\Delta t/2$)：**\n从 $c_0(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} = -k(x)c$ 历时 $\\Delta t/2$。\n$$ c_1(x) = c_0(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n\n**步骤 2：全步平流 ($\\Delta t$)：**\n从 $c_1(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$ 历时 $\\Delta t$。这是纯平流，它平移了解的剖面。\n$$ c_2(x) = c_1(x - u\\Delta t) = c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) $$\n\n**步骤 3：第二个半步反应 ($\\Delta t/2$)：**\n从 $c_2(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} = -k(x)c$ 历时 $\\Delta t/2$。\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = c_2(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n代入 $c_2(x)$ 的表达式：\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = \\left[ c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) \\right] \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n合并指数项，我们得到 Strang 分裂解的封闭形式表达式：\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{\\Delta t}{2} \\left[k(x) + k(x - u\\Delta t)\\right] \\right)\n$$\n注意，如果 $u=0$，此式正确地简化为 $c_0(x)\\exp(-k(x)\\Delta t)$，这与无平流情况下的精确解相匹配。\n\n#### 3. 误差分析与梯形法则的联系\n\n我们现在分析局部逐点误差 $|c_{\\mathrm{Strang}}(x,\\Delta t) - c_{\\mathrm{unsplit}}(x,\\Delta t)|$。两个表达式共享前置因子 $c_0(x-u\\Delta t)$。差异源于指数项的参数。\n\n对于精确解，参数为 $-I_{\\mathrm{exact}} = -\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$。\n对于 Strang 分裂解，参数为 $-I_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)]$。\n\n我们来检验 $I_{\\mathrm{Strang}}$ 项。它可以重写为：\n$$\nI_{\\mathrm{Strang}} = \\frac{x - (x-u\\Delta t)}{u} \\frac{k(x) + k(x-u\\Delta t)}{2}\n$$\n这正是积分 $\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$ 的梯形法则近似。对于积分 $\\int_a^b f(s)ds$，梯形法则的误差由 $-\\frac{(b-a)^3}{12}f''(\\xi)$ 给出，其中 $\\xi \\in [a,b]$。\n\n将此应用于我们的积分项 $I_{\\mathrm{exact}}$（其中 $f(s)=k(s)$，$b=x$，$a=x-u\\Delta t$），我们得到：\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)] - \\frac{1}{u} \\frac{(u\\Delta t)^3}{12} k''(\\xi)\n$$\n对于某个 $\\xi \\in [x-u\\Delta t, x]$。因此，\n$$\nI_{\\mathrm{exact}} = I_{\\mathrm{Strang}} - \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\n解之间的差异是：\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} = c_0(x-u\\Delta t) \\left[ \\exp(-I_{\\mathrm{Strang}}) - \\exp(-I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp(I_{\\mathrm{Strang}} - I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp\\left(\\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\n对于小的 $\\Delta t$，内部指数的参数很小。使用泰勒展开 $\\exp(z) \\approx 1+z$ 对于小 $z$：\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} \\approx c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\left(1 + \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\n$$\n= -c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\n当 $\\Delta t \\to 0$ 时，$I_{\\mathrm{Strang}} \\to 0$ 且 $\\xi \\to x$。误差的主导项变为：\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) - c_{\\mathrm{unsplit}}(x, \\Delta t) = -c_0(x) \\frac{u^2 k''(x)}{12} \\Delta t^3 + O(\\Delta t^4)\n$$\n这表明局部逐点误差为 $O(\\Delta t^3)$ 阶，前提是 $k(x)$ 至少是二阶可导的，这对于给定的光滑周期函数 $k(x)$ 是成立的。\n\n#### 4. 用于实现的显式公式\n\n对于给定的 $k(x) = k_0 + k_1 \\sin(2\\pi x)$，我们需要精确解的定积分。其原函数为：\n$$\nK(s) = \\int k(s) ds = \\int (k_0 + k_1 \\sin(2\\pi s)) ds = k_0 s - \\frac{k_1}{2\\pi} \\cos(2\\pi s)\n$$\n$c_{\\mathrm{unsplit}}$ 指数中的积分项为：\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{1}{u}[K(x) - K(x-u\\Delta t)] = k_0 \\Delta t - \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\n所以对于 $u \\neq 0$，$c_{\\mathrm{unsplit}}$ 指数的参数为：\n$$\n\\arg_{\\mathrm{unsplit}} = -k_0 \\Delta t + \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\n\n使用给定的 $k(x)$，$c_{\\mathrm{Strang}}$ 的参数为：\n$$\n\\arg_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [ (k_0+k_1\\sin(2\\pi x)) + (k_0+k_1\\sin(2\\pi(x-u\\Delta t))) ]\n$$\n$$\n= -\\Delta t \\left( k_0 + \\frac{k_1}{2} [\\sin(2\\pi x) + \\sin(2\\pi(x-u\\Delta t))] \\right)\n$$\n这些显式公式将在实现中使用。",
            "answer": "[0.006857855395,0.006870275811,0.00687339174,0.0,0.0]"
        },
        {
            "introduction": "化学传输模型的最终目标之一是为空气质量管理提供科学依据，这需要深入理解臭氧等污染物的非线性生成机制。在不同的大气环境下，臭氧的生成可能主要受氮氧化物（NOx）控制，也可能受挥发性有机物（VOC）控制，即所谓的“NOx限制区”与“VOC限制区”。本练习将理论与应用相结合，要求您根据大气化学的基本原理，编写程序实现两种常用的光化学敏感性诊断指标，并将其应用于模型输出数据，从而判断特定环境下的主导控制机制，完成从模型模拟到科学诊断的关键一步。",
            "id": "3863633",
            "problem": "构造一个程序，使用两个源于气相大气化学和大气化学传输模型输出、有科学依据的指标，来诊断局地光化学敏感性分区（氮氧化物(NOx)限制、挥发性有机物(VOC)限制或过渡区）。目标是根据第一性原理将决策规则形式化，并将其应用于一小组测试场景。所有输出必须是代表分区类别的无单位整数，并按如下规定汇总到单行中。\n\n从以下基本和核心定义开始：\n\n- 由短寿命自由基驱动的臭氧（O$_3$）光化学生成主要受过氧自由基与一氧化氮（NO）的反应控制，因此局地瞬时生成速率 $P(O_3)$ 可表示为 $$P(O_3) \\propto k_{HO_2+NO}\\,[HO_2][NO] + k_{RO_2+NO}\\,[RO_2][NO],$$ 其中 $[HO_2]$ 和 $[RO_2]$ 分别表示氢过氧自由基和有机过氧自由基，而 $k_{\\cdot}$ 是速率常数。在此框架下，臭氧生成对 NOx 和 VOCs 的敏感性取决于 $P(O_3)$ 如何响应那些控制 $[NO]$、$[HO_2]$ 和 $[RO_2]$ 的 NOx 和 VOC 前体物的变化。\n- 自由基终止途径包括通过 $OH + NO_2 \\to HNO_3$ 生成硝酸（HNO$_3$）以及通过 $HO_2 + HO_2 \\to H_2O_2$ 生成过氧化氢（H$_2$O$_2$）。在准稳态条件下，相对于 HNO$_3$，较高的 H$_2$O_2 浓度表明是低 NOx 条件（有利于过氧化物生成），而相对于 H$_2$O_2$，较高的 HNO$_3$ 浓度则表明是高 NOx 条件（有利于硝酸盐生成）。\n\n你必须实现两个互补的诊断指标：\n\n- 基于混合比的过氧化物-硝酸盐指标：使用午间混合比（单位：十亿分体积，ppbv）定义指标 $$I_R = \\frac{[H_2O_2]}{[HNO_3]}$$。使用以下决策规则以及两个划分分区的经验阈值，在本练习中，这些阈值必须视为给定常数：如果 $I_R  \\tau_H$，则分类为 NOx 限制；如果 $I_R  \\tau_L$，则分类为 VOC 限制；否则分类为过渡区。使用 $\\tau_L = 0.35$ 和 $\\tau_H = 0.55$。稳健地处理分母为零的情况：如果 $[HNO_3] \\le \\epsilon$ 且 $[H_2O_2]  \\epsilon$，则分类为 NOx 限制；如果 $[HNO_3] \\le \\epsilon$ 且 $[H_2O_2] \\le \\epsilon$，则分类为过渡区；如果 $[H_2O_2] \\le \\epsilon$ 且 $[HNO_3]  \\epsilon$，则分类为 VOC 限制。为保证数值稳定性，内部使用 ppbv 单位的 $\\epsilon = 10^{-12}$。最终分类是无单位的。\n- 来自有限差分敏感性的臭氧等值线斜率指标：给定一个基准 O$_3$ 混合比 $O_3^\\mathrm{base}$（单位 ppbv），一个经过分数 NOx 扰动 $\\delta_N$（无单位小数）后记为 $O_3^{N+}$ 的受扰动 O$_3$，以及一个经过分数 VOC 扰动 $\\delta_V$ 后记为 $O_3^{V+}$ 的受扰动 O$_3$，近似计算敏感性：$$s_N = \\frac{O_3^{N+} - O_3^\\mathrm{base}}{\\delta_N}, \\quad s_V = \\frac{O_3^{V+} - O_3^\\mathrm{base}}{\\delta_V}.$$ 使用以下从这些敏感性的符号和相对大小推导出的决策规则：如果 $s_N  0$ 且 $s_V  0$，分类为 VOC 限制；如果 $s_N  0$ 且 $s_V  0$，分类为 NOx 限制；如果 $s_N \\le 0$ 且 $s_V \\le 0$，分类为过渡区；否则（两个敏感性均为正），比较其大小：如果 $|s_N|  |s_V| + \\tau_S$，分类为 NOx 限制；如果 $|s_V|  |s_N| + \\tau_S$，分类为 VOC 限制；否则分类为过渡区。使用 ppbv 单位的 $\\tau_S = 5.0$ 作为量级比较的容差。将大小 $\\le \\epsilon_S$ 的值视为零，其中 $\\epsilon_S = 10^{-12}$ (ppbv 单位)。\n\n将每个分类映射到一个整数代码以实现自动评估：\n- NOx 限制 $\\to$ $+1$,\n- VOC 限制 $\\to$ $-1$,\n- 过渡区 $\\to$ $0$.\n\n使用以下测试用例集。所有混合比必须视为 ppbv，所有扰动必须视为小数（不使用百分号）。你的程序必须计算每个案例的分类代码并按顺序输出它们。该测试套件涵盖了不同方面，包括指标一致性、相反的分区、临界过渡行为和数值边界处理。\n\n- 案例 A（过氧化物-硝酸盐，NOx 限制）：$[H_2O_2] = 2.0$, $[HNO_3] = 0.5$。\n- 案例 B（过氧化物-硝酸盐，VOC 限制）：$[H_2O_2] = 0.1$, $[HNO_3] = 2.0$。\n- 案例 C（过氧化物-硝酸盐，过渡区）：$[H_2O_2] = 0.18$, $[HNO_3] = 0.4$。\n- 案例 D（过氧化物-硝酸盐，硝酸盐为零的边界情况）：$[H_2O_2] = 0.2$, $[HNO_3] = 0.0$。\n- 案例 E（等值线斜率，二者均为正，NOx 敏感性更强）：$O_3^\\mathrm{base} = 60$, $O_3^{N+} = 66$, $O_3^{V+} = 62$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n- 案例 F（等值线斜率，因 NOx 敏感性为负而为 VOC 限制）：$O_3^\\mathrm{base} = 70$, $O_3^{N+} = 65$, $O_3^{V+} = 78$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n- 案例 G（等值线斜率，对二者均无响应，过渡区）：$O_3^\\mathrm{base} = 55$, $O_3^{N+} = 54$, $O_3^{V+} = 54$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n- 案例 H（等值线斜率，二者均为正，在不等扰动下 VOC 敏感性更强）：$O_3^\\mathrm{base} = 50$, $O_3^{N+} = 52$, $O_3^{V+} = 51$, $\\delta_N = 0.2$, $\\delta_V = 0.05$。\n\n最终输出格式：你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[result_1,result_2,\\dots]$），其中每个 $result_i$ 是按 A 到 H 顺序排列的相应案例的整数代码。不应打印任何其他文本。所有内部计算必须与指定的单位一致：混合比使用 ppbv，扰动使用无单位小数。不使用角度。不得使用百分比；请改用小数。最终输出是无单位整数。",
            "solution": "该问题要求开发一个程序，将局地光化学分区划分为氮氧化物（NOx）限制、挥发性有机物（VOC）限制或过渡区。该分类基于两个源于气相大气化学原理、有科学依据的独特指标。任务是为这些指标形式化给定的决策规则，并将其应用于所提供的一组大气情景测试套件中。\n\n基本原理是，对流层臭氧（$O_3$）的生成是其前体物（主要是 NOx，即 $NO + NO_2$ 和 VOCs）的非线性函数。臭氧生成对这些前体物变化的敏感性定义了化学分区。问题提供了瞬时臭氧生成速率 $P(O_3)$ 的简化表示：\n$$P(O_3) \\propto k_{HO_2+NO}\\,[HO_2][NO] + k_{RO_2+NO}\\,[RO_2][NO]$$\n此处，$[HO_2]$ 和 $[RO_2]$ 分别是氢过氧自由基和有机过氧自由基的浓度，$[NO]$ 是一氧化氮的浓度，而 $k$ 项是反应速率常数。分区的分类取决于 NOx 和 VOC 前体物的扰动如何影响这些自由基的浓度，并因此影响臭氧的生成速率。\n\n定义了两个指标来探测这种敏感性。\n\n**指标1：过氧化物与硝酸盐之比 ($I_R$)**\n\n该指标利用了自由基终止途径之间的竞争。在高 NOx 条件下，羟基自由基（$OH$）与二氧化氮（$NO_2$）反应生成硝酸（$HNO_3$），这是自由基的一个重要汇：$OH + NO_2 \\to HNO_3$。在低 NOx 条件下，过氧自由基的自反应，如 $HO_2 + HO_2 \\to H_2O_2$，变得更加显著。因此，产物——过氧化氢（$H_2O_2$）和 $HNO_3$ 的比率——可作为 NOx 水平和相关化学敏感性的经验代理指标。\n\n指标定义为混合比之比：\n$$I_R = \\frac{[H_2O_2]}{[HNO_3]}$$\n决策规则基于两个阈值，$\\tau_L = 0.35$ 和 $\\tau_H = 0.55$：\n- 如果 $I_R  \\tau_H$，则为 NOx 限制区（代码：$+1$）。这对应于相对于硝酸盐，过氧化物的生成量较高。\n- 如果 $I_R  \\tau_L$，则为 VOC 限制区（代码：$-1$）。这对应于相对于硝酸盐，过氧化物的生成量较低。\n- 否则（$\\tau_L \\le I_R \\le \\tau_H$），则为过渡区（代码：$0$）。\n\n对于 $[HNO_3]$ 接近零的情况，需要使用数值容差 $\\epsilon = 10^{-12}$ ppbv 进行特殊处理。\n- 如果 $[HNO_3] \\le \\epsilon$ 且 $[H_2O_2]  \\epsilon$：NOx 限制（代码：$+1$），代表硝酸盐生成可忽略不计的极端低 NOx 场景。\n- 如果 $[H_2O_2] \\le \\epsilon$ 且 $[HNO_3]  \\epsilon$：VOC 限制（代码：$-1$），代表过氧化物生成可忽略不计的场景。\n- 如果 $[HNO_3] \\le \\epsilon$ 且 $[H_2O_2] \\le \\epsilon$：过渡区（代码：$0$），代表自由基终止产物总量非常低的状态。\n\n将这些规则应用于前四个测试案例：\n- **案例 A**：$[H_2O_2] = 2.0$ ppbv, $[HNO_3] = 0.5$ ppbv。\n  $I_R = \\frac{2.0}{0.5} = 4.0$。由于 $4.0  \\tau_H = 0.55$，该分区为 **NOx 限制** ($+1$) 。\n- **案例 B**：$[H_2O_2] = 0.1$ ppbv, $[HNO_3] = 2.0$ ppbv。\n  $I_R = \\frac{0.1}{2.0} = 0.05$。由于 $0.05  \\tau_L = 0.35$，该分区为 **VOC 限制** ($-1$) 。\n- **案例 C**：$[H_2O_2] = 0.18$ ppbv, $[HNO_3] = 0.4$ ppbv。\n  $I_R = \\frac{0.18}{0.4} = 0.45$。由于 $\\tau_L=0.35 \\le 0.45 \\le \\tau_H=0.55$，该分区为 **过渡区** ($0$) 。\n- **案例 D**：$[H_2O_2] = 0.2$ ppbv, $[HNO_3] = 0.0$ ppbv。\n  此处，$[HNO_3] = 0.0 \\le \\epsilon$ 且 $[H_2O_2] = 0.2  \\epsilon$。根据此边界情况规则，该分区被分类为 **NOx 限制** ($+1$) 。\n\n**指标2：臭氧等值线斜率**\n\n该指标直接近似臭氧等值线曲面的局部梯度，该曲面绘制了臭氧浓度作为 NOx 和 VOC 前体物水平的函数。敏感性是使用一个基准案例和两个扰动模拟通过有限差分近似计算得出的。给定一个基准臭氧混合比 $O_3^\\mathrm{base}$，一个经过分数 NOx 扰动 $\\delta_N$ 后得到 $O_3^{N+}$ 的模拟，以及一个经过分数 VOC 扰动 $\\delta_V$ 后得到 $O_3^{V+}$ 的模拟，敏感性为：\n$$s_N = \\frac{O_3^{N+} - O_3^\\mathrm{base}}{\\delta_N}, \\quad s_V = \\frac{O_3^{V+} - O_3^\\mathrm{base}}{\\delta_V}$$\n使用 $\\epsilon_S = 10^{-12}$ ppbv 的数值容差将接近零的敏感性视为零。决策逻辑如下：\n- 如果 $s_N  0$ 且 $s_V  0$：VOC 限制（代码：$-1$）。增加 NOx 会导致臭氧减少（滴定/抑制），而增加 VOCs 会导致臭氧增加。\n- 如果 $s_N  0$ 且 $s_V  0$：NOx 限制（代码：$+1$）。这个不太常见的情况被明确定义。\n- 如果 $s_N \\le 0$ 且 $s_V \\le 0$：过渡区（代码：$0$）。臭氧生成对两种前体物均无响应或呈负响应。\n- 否则（涵盖至少一个敏感性为正且不满足上述条件的情况）：使用容差 $\\tau_S = 5.0$ ppbv 比较相对大小。\n  - 如果 $|s_N|  |s_V| + \\tau_S$：NOx 限制（代码：$+1$），因为臭氧对 NOx 的敏感性显著更高。\n  - 如果 $|s_V|  |s_N| + \\tau_S$：VOC 限制（代码：$-1$），因为臭氧对 VOCs 的敏感性显著更高。\n  - 否则：过渡区（代码：$0$），代表敏感性相当。\n\n将这些规则应用于其余四个测试案例：\n- **案例 E**：$O_3^\\mathrm{base} = 60$, $O_3^{N+} = 66$, $O_3^{V+} = 62$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n  $s_N = (66 - 60) / 0.1 = 60.0$。\n  $s_V = (62 - 60) / 0.1 = 20.0$。\n  两个敏感性均为正。比较其大小：$|s_N| = 60.0$ 和 $|s_V| = 20.0$。\n  $|60.0|  |20.0| + \\tau_S=5.0 \\implies 60.0  25.0$，该条件为真。该分区为 **NOx 限制** ($+1$) 。\n- **案例 F**：$O_3^\\mathrm{base} = 70$, $O_3^{N+} = 65$, $O_3^{V+} = 78$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n  $s_N = (65 - 70) / 0.1 = -50.0$。\n  $s_V = (78 - 70) / 0.1 = 80.0$。\n  由于 $s_N  0$ 且 $s_V  0$，该分区为 **VOC 限制** ($-1$) 。\n- **案例 G**：$O_3^\\mathrm{base} = 55$, $O_3^{N+} = 54$, $O_3^{V+} = 54$, $\\delta_N = 0.1$, $\\delta_V = 0.1$。\n  $s_N = (54 - 55) / 0.1 = -10.0$。\n  $s_V = (54 - 55) / 0.1 = -10.0$。\n  由于 $s_N \\le 0$ 且 $s_V \\le 0$，该分区为 **过渡区** ($0$) 。\n- **案例 H**：$O_3^\\mathrm{base} = 50$, $O_3^{N+} = 52$, $O_3^{V+} = 51$, $\\delta_N = 0.2$, $\\delta_V = 0.05$。\n  $s_N = (52 - 50) / 0.2 = 10.0$。\n  $s_V = (51 - 50) / 0.05 = 20.0$。\n  两个敏感性均为正。比较其大小：$|s_N| = 10.0$ 和 $|s_V| = 20.0$。\n  $|20.0|  |10.0| + \\tau_S=5.0 \\implies 20.0  15.0$，该条件为真。该分区为 **VOC 限制** ($-1$) 。\n\n从案例 A 到 H 的最终分类代码集为 $[+1, -1, 0, +1, +1, -1, 0, -1]$。",
            "answer": "[1,-1,0,1,1,-1,0,-1]"
        }
    ]
}