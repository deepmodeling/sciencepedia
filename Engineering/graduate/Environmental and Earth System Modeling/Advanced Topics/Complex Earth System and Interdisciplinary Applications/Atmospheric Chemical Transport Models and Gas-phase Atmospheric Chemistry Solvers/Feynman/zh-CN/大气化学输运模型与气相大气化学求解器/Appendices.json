{
    "hands_on_practices": [
        {
            "introduction": "为了数值求解大气化学中的刚性常微分方程组，隐式积分方法是必不可少的。这些方法的核心是雅可比矩阵，它描述了系统中每个物种的变化率如何响应所有其他物种浓度的微小变化。这项实践  将带你推导对流层臭氧化学中一个基本子系统——光稳态的雅可比矩阵，为你深入理解化学求解器的内部工作原理和构建自己的求解器奠定基础。",
            "id": "3863642",
            "problem": "考虑一个代表大气化学传输模型 (CTM) 中网格单元的零维化学箱式模型，重点关注涉及臭氧和氮氧化物的气相光稳态子系统。假设在求解器时间步长内温度和压力恒定，因此分子氧和第三体的数密度是常数。化学机制仅限于以下反应：\n1. $NO + O_{3} \\to NO_{2} + O_{2}$，\n2. $NO_{2} + h\\nu \\to NO + O$，\n3. $O + O_{2} + M \\to O_{3} + M$。\n\n假设质量作用定律对双分子和三分子反应均成立，并视光解频率在时间步长内为常数。定义物种浓度向量为 $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$，并设 $NO + O_{3}$ 反应的速率系数为 $k_{1}$，$NO_{2}$ 光解的频率为 $J$，以及 $O + O_{2} + M$ 复合反应的速率系数为 $k_{3}$。浓度 $[O_{2}]$ 和 $[M]$ 是由背景大气决定的常数。\n\n从质量守恒和质量作用定律的基本原理出发，推导表示每个物种净化学生成减去消耗的关于 $\\mathbf{x}$ 的常微分方程组。然后，计算化学趋势向量 $\\mathbf{f}(\\mathbf{x})$ 的雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$，其中 $\\mathbf{f}(\\mathbf{x})$ 是常微分方程组的右侧。根据该机制所隐含的生成和消耗耦合关系，确定每个雅可比矩阵元素的符号模式。\n\n给出完整的 $4 \\times 4$ 雅可比矩阵作为你的最终答案，该矩阵应以 $k_{1}$、$J$、$k_{3}$、$ [O_{2}]$、$ [M]$、$ [O_{3}]$ 和 $[NO]$ 的解析表达式形式写出，并按照 $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$ 的顺序排列。答案需为精确表达式，不要四舍五入。最终答案中不包含单位。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**问题验证**\n\n**第1步：提取已知条件**\n-   **模型**：零维化学箱式模型。\n-   **系统**：涉及臭氧 ($O_{3}$)、一氧化氮 ($NO$)、二氧化氮 ($NO_{2}$) 和原子氧 ($O$) 的气相光稳态子系统。\n-   **反应**：\n    1.  $NO + O_{3} \\to NO_{2} + O_{2}$，速率系数为 $k_{1}$。\n    2.  $NO_{2} + h\\nu \\to NO + O$，光解频率为 $J$。\n    3.  $O + O_{2} + M \\to O_{3} + M$，速率系数为 $k_{3}$。\n-   **假设**：质量作用定律成立；温度和压力恒定。\n-   **常数**：速率系数 $k_{1}$ 和 $k_{3}$；光解频率 $J$；数密度 $[O_{2}]$ 和 $[M]$。\n-   **物种向量**：$\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$。\n-   **任务**：\n    1. 推导常微分方程组 (ODEs) $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x})$。\n    2. 计算雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$。\n    3. 提供完整的 $4 \\times 4$ 雅可比矩阵作为最终答案。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题描述了对流层和平流层臭氧光稳态的核心化学反应，这是大气化学中的一个基本概念。使用质量作用定律是化学动力学建模的标准方法。该问题在科学上是合理的。\n-   **适定性**：该问题清晰地定义了化学系统，并要求推导其控制动力学方程及其雅可比矩阵。这是一个标准的、定义明确的数学任务，具有唯一解。\n-   **客观性**：问题陈述使用精确、无偏见和标准的科学语言表达。\n\n**第3步：结论与行动**\n该问题是有效的，因为它具有科学依据、适定性、客观性，并包含获得唯一解所需的所有必要信息。我们可以继续进行求解。\n\n**解题推导**\n\n每个物种浓度的变化率由产生它的反应速率之和减去消耗它的反应速率之和决定。基于质量作用定律，三个反应的速率为：\n-   反应1的速率：$R_{1} = k_{1} [NO] [O_{3}]$\n-   反应2的速率：$R_{2} = J [NO_{2}]$\n-   反应3的速率：$R_{3} = k_{3} [O] [O_{2}] [M]$\n\n使用这些速率表达式，我们可以写出向量 $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$ 中每个物种净变化率的常微分方程组 (ODEs)。\n\n1.  **对于 $[O_{3}]$**：臭氧在反应3中生成，在反应1中消耗。\n    $$ \\frac{d[O_{3}]}{dt} = R_{3} - R_{1} = k_{3} [O] [O_{2}] [M] - k_{1} [NO] [O_{3}] $$\n\n2.  **对于 $[NO]$**：一氧化氮在反应2中生成，在反应1中消耗。\n    $$ \\frac{d[NO]}{dt} = R_{2} - R_{1} = J [NO_{2}] - k_{1} [NO] [O_{3}] $$\n\n3.  **对于 $[NO_{2}]$**：二氧化氮在反应1中生成，在反应2中消耗。\n    $$ \\frac{d[NO_{2}]}{dt} = R_{1} - R_{2} = k_{1} [NO] [O_{3}] - J [NO_{2}] $$\n\n4.  **对于 $[O]$**：原子氧在反应2中生成，在反应3中消耗。\n    $$ \\frac{d[O]}{dt} = R_{2} - R_{3} = J [NO_{2}] - k_{3} [O] [O_{2}] [M] $$\n\n该常微分方程组定义了化学趋势向量 $\\mathbf{f}(\\mathbf{x}) = \\frac{d\\mathbf{x}}{dt}$。设 $x_{1}=[O_{3}]$，$x_{2}=[NO]$，$x_{3}=[NO_{2}]$ 和 $x_{4}=[O]$。$\\mathbf{f}(\\mathbf{x})$ 的分量为：\n$$\nf_{1}(\\mathbf{x}) = k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1} \\\\\nf_{2}(\\mathbf{x}) = J x_{3} - k_{1} x_{2} x_{1} \\\\\nf_{3}(\\mathbf{x}) = k_{1} x_{2} x_{1} - J x_{3} \\\\\nf_{4}(\\mathbf{x}) = J x_{3} - k_{3} x_{4} [O_{2}] [M]\n$$\n\n雅可比矩阵 $\\mathbf{J}$ 是一个 $4 \\times 4$ 矩阵，其中每个元素 $J_{ij}$ 是第 $i$ 个速率函数对第 $j$ 个物种浓度的偏导数，即 $J_{ij} = \\frac{\\partial f_{i}}{\\partial x_{j}}$。我们来计算这些偏导数。\n\n**$\\mathbf{J}$ 的第1行（$f_{1}$ 的导数）：**\n-   $J_{11} = \\frac{\\partial f_{1}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = -k_{1} x_{2} = -k_{1} [NO]$\n-   $J_{12} = \\frac{\\partial f_{1}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = -k_{1} x_{1} = -k_{1} [O_{3}]$\n-   $J_{13} = \\frac{\\partial f_{1}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = 0$\n-   $J_{14} = \\frac{\\partial f_{1}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = k_{3} [O_{2}] [M]$\n\n**$\\mathbf{J}$ 的第2行（$f_{2}$ 的导数）：**\n-   $J_{21} = \\frac{\\partial f_{2}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(J x_{3} - k_{1} x_{2} x_{1}) = -k_{1} x_{2} = -k_{1} [NO]$\n-   $J_{22} = \\frac{\\partial f_{2}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(J x_{3} - k_{1} x_{2} x_{1}) = -k_{1} x_{1} = -k_{1} [O_{3}]$\n-   $J_{23} = \\frac{\\partial f_{2}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(J x_{3} - k_{1} x_{2} x_{1}) = J$\n-   $J_{24} = \\frac{\\partial f_{2}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(J x_{3} - k_{1} x_{2} x_{1}) = 0$\n\n**$\\mathbf{J}$ 的第3行（$f_{3}$ 的导数）：**\n-   $J_{31} = \\frac{\\partial f_{3}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(k_{1} x_{2} x_{1} - J x_{3}) = k_{1} x_{2} = k_{1} [NO]$\n-   $J_{32} = \\frac{\\partial f_{3}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(k_{1} x_{2} x_{1} - J x_{3}) = k_{1} x_{1} = k_{1} [O_{3}]$\n-   $J_{33} = \\frac{\\partial f_{3}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(k_{1} x_{2} x_{1} - J x_{3}) = -J$\n-   $J_{34} = \\frac{\\partial f_{3}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(k_{1} x_{2} x_{1} - J x_{3}) = 0$\n\n**$\\mathbf{J}$ 的第4行（$f_{4}$ 的导数）：**\n-   $J_{41} = \\frac{\\partial f_{4}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = 0$\n-   $J_{42} = \\frac{\\partial f_{4}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = 0$\n-   $J_{43} = \\frac{\\partial f_{4}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = J$\n-   $J_{44} = \\frac{\\partial f_{4}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = -k_{3} [O_{2}] [M]$\n\n雅可比矩阵的对角线元素 $J_{ii}$ 表示一个物种对其自身变化率的反馈。所有对角线元素均为负值，表明任何物种浓度的增加都会加速其自身的净消耗速率。这是一个稳定化学系统的特征，也是 CTM 中使用的数值求解器稳定性的一个关键属性。非对角线元素 $J_{ij}$（其中 $i \\neq j$）表示物种之间的化学耦合。正的 $J_{ij}$ 表示物种 $j$ 生成物种 $i$，而负值则表示物种 $j$ 消耗物种 $i$。例如，$J_{14} = k_{3}[O_{2}][M] > 0$ 表明原子氧 $[O]$ 的增加会导致臭氧 $[O_{3}]$ 生成速率的增加。相反，$J_{12} = -k_{1}[O_{3}]  0$ 表明一氧化氮 $[NO]$ 的增加会提高臭氧的消耗速率。\n\n将这些元素组合起来，便得到最终的雅可比矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-k_{1} [NO]   -k_{1} [O_{3}]   0   k_{3} [O_{2}] [M] \\\\\n-k_{1} [NO]   -k_{1} [O_{3}]   J   0 \\\\\nk_{1} [NO]   k_{1} [O_{3}]   -J   0 \\\\\n0   0   J   -k_{3} [O_{2}] [M]\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "大气化学系统的一个显著特征是“刚性”（stiffness），即不同化学反应的时间尺度可能相差数个数量级。这个特性给数值求解带来了巨大挑战，因为标准显式积分方法的稳定性会受到最快反应时间的严格限制。本练习  通过一个简单的、可解析求解的可逆反应系统，让你亲身体会刚性问题，并从根本上理解为什么必须使用为这类问题专门设计的隐式求解器。",
            "id": "3863627",
            "problem": "考虑一个通过直线法（MOL）求解的化学输运模型（CTM）的单个网格单元，在该单元中，为了进行刚性化学转化测试，垂直和水平输运在测试期间被关闭。两种气相物质，表示为$A$和$B$，通过反应$A \\to B$和$B \\to A$可逆地相互转化，其一级反应速率常数分别为$k_{1}$和$k_{2}$，并假设在固定的热力学条件下随时间保持不变。设$[A](t)$和$[B](t)$表示随时间$t$变化的数浓度，单位为分子/立方厘米。根据质量作用定律，并假设在一个没有源、汇或输运的均匀混合箱中，控制该系统的常微分方程（ODE）组为\n$$\n\\frac{d[A]}{dt} \\;=\\; -\\,k_{1}\\,[A] \\;+\\; k_{2}\\,[B], \\qquad\n\\frac{d[B]}{dt} \\;=\\; k_{1}\\,[A] \\;-\\; k_{2}\\,[B].\n$$\n要求您从基本原理出发，推导出一个解析解，该解适用于评估应用于此系统的显式和隐式单步求解器的准确性和刚性处理能力。具体来说：\n\n1) 从上述ODE系统出发，仅使用线性系统的基本性质，为任意非负初始浓度$[A](0)=A_{0}$和$[B](0)=B_{0}$以及任意正常数$k_{1}$和$k_{2}$，推导出$[A](t)$和$[B](t)$的闭式解析表达式。您的推导应明确利用守恒性质以及控制动力学的线性算子的特征结构。\n\n2) 利用线性系统的解析特征值，推导显式欧拉法的线性稳定性条件。由此确定最大稳定时间步长$\\Delta t_{\\max}$，以确保对于右侧雅可比矩阵的所有特征值$\\lambda$，都有$|1+\\Delta t\\,\\lambda|1$。然后，对于具体情况$k_{1}=500~\\text{s}^{-1}$和$k_{2}=0.5~\\text{s}^{-1}$，计算$\\Delta t_{\\max}$的数值。\n\n您的最终数值时间步长以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证该问题是自洽的、有科学依据且适定的。所给出的常微分方程（ODE）组是一阶可逆化学动力学的标准表示。任务涉及使用线性代数的标准解析解法和数值方法的经典稳定性分析，这两者都是应用数学和计算科学中的基本课题。该问题有效。\n\n**第1部分：解析解的推导**\n\n控制该系统的ODE组为：\n$$ \\frac{d[A]}{dt} = -k_{1}[A] + k_{2}[B] $$\n$$ \\frac{d[B]}{dt} = k_{1}[A] - k_{2}[B] $$\n这可以写成矩阵形式。设浓度向量为$\\mathbf{c}(t) = \\begin{pmatrix} [A](t) \\\\ [B](t) \\end{pmatrix}$。则系统为$\\frac{d\\mathbf{c}}{dt} = \\mathbf{K}\\mathbf{c}$，其中$\\mathbf{K}$是速率矩阵：\n$$ \\mathbf{K} = \\begin{pmatrix} -k_{1}  k_{2} \\\\ k_{1}  -k_{2} \\end{pmatrix} $$\n初始条件为$\\mathbf{c}(0) = \\begin{pmatrix} [A](0) \\\\ [B](0) \\end{pmatrix} = \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix}$。\n\n该系统的一个关键性质是总浓度守恒。将两个ODE相加得到：\n$$ \\frac{d}{dt}([A] + [B]) = (-k_{1}[A] + k_{2}[B]) + (k_{1}[A] - k_{2}[B]) = 0 $$\n对该方程积分得到$[A](t) + [B](t) = \\text{常数}$。使用初始条件，我们发现该常数为$A_{0} + B_{0}$。令$C_{\\text{tot}} = A_{0} + B_{0}$。\n\n为利用其特征结构求解该系统，我们求矩阵$\\mathbf{K}$的特征值和特征向量。特征值$\\lambda$是特征方程$\\det(\\mathbf{K} - \\lambda\\mathbf{I}) = 0$的根：\n$$ \\det\\begin{pmatrix} -k_{1} - \\lambda  k_{2} \\\\ k_{1}  -k_{2} - \\lambda \\end{pmatrix} = 0 $$\n$$ (-k_{1} - \\lambda)(-k_{2} - \\lambda) - (k_{1})(k_{2}) = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda + k_{1}k_{2} - k_{1}k_{2} = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda = 0 $$\n$$ \\lambda(\\lambda + k_{1} + k_{2}) = 0 $$\n特征值为$\\lambda_1 = 0$和$\\lambda_2 = -(k_{1} + k_{2})$。\n\n接下来，我们通过求解$(\\mathbf{K} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$来找到相应的特征向量$\\mathbf{v}$。\n\n对于$\\lambda_1 = 0$：\n$$ \\begin{pmatrix} -k_{1}  k_{2} \\\\ k_{1}  -k_{2} \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这给出了方程$-k_{1}v_{11} + k_{2}v_{12} = 0$，即$v_{12} = \\frac{k_{1}}{k_{2}}v_{11}$。一个可能的特征向量是$\\mathbf{v}_1 = \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix}$。该特征向量对应于稳态或平衡态。\n\n对于$\\lambda_2 = -(k_{1} + k_{2})$：\n$$ \\begin{pmatrix} -k_{1} - (-(k_{1} + k_{2}))  k_{2} \\\\ k_{1}  -k_{2} - (-(k_{1} + k_{2})) \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} k_{2}  k_{2} \\\\ k_{1}  k_{1} \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这给出了方程$k_{2}v_{21} + k_{2}v_{22} = 0$，即$v_{21} = -v_{22}$。一个可能的特征向量是$\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。该特征向量代表了偏离平衡的瞬态。\n\n通解是特征模态的线性组合：\n$$ \\mathbf{c}(t) = c_{1}e^{\\lambda_1 t}\\mathbf{v}_1 + c_{2}e^{\\lambda_2 t}\\mathbf{v}_2 = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2}e^{-(k_{1}+k_{2})t} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n我们使用$t=0$时的初始条件来求解系数$c_{1}$和$c_{2}$：\n$$ \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix} = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n这导出了关于$c_1$和$c_2$的线性方程组：\n1) $A_{0} = c_{1}k_{2} + c_{2}$\n2) $B_{0} = c_{1}k_{1} - c_{2}$\n将两个方程相加：$A_{0} + B_{0} = c_{1}(k_{1} + k_{2})$，得到$c_{1} = \\frac{A_{0} + B_{0}}{k_{1} + k_{2}}$。\n将$c_{1}$代入第一个方程：$c_{2} = A_{0} - c_{1}k_{2} = A_{0} - \\frac{(A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}(k_{1} + k_{2}) - (A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}$。\n\n将$c_1$和$c_2$代回通解，我们得到$[A](t)$和$[B](t)$的闭式解析表达式：\n$$ [A](t) = c_{1}k_{2} + c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{2} + \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = c_{1}k_{1} - c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{1} - \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\n这些表达式可以重新整理，以更清晰地显示平衡部分和瞬态部分：\n$$ [A](t) = \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( A_{0} - \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( B_{0} - \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n\n**第2部分：显式欧拉法的稳定性分析**\n\n应用于系统$\\frac{d\\mathbf{c}}{dt} = \\mathbf{f}(\\mathbf{c})$的显式欧拉法由$\\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{f}(\\mathbf{c}_{n})$给出。对于我们的线性系统，$\\mathbf{f}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c}$，所以格式为：\n$$ \\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{K}\\mathbf{c}_{n} = (\\mathbf{I} + \\Delta t \\mathbf{K})\\mathbf{c}_{n} $$\n线性稳定性要求放大矩阵$\\mathbf{G} = \\mathbf{I} + \\Delta t \\mathbf{K}$的特征值的模不超过$1$。$\\mathbf{G}$的特征值由$1 + \\Delta t \\lambda$给出，其中$\\lambda$是$\\mathbf{K}$的特征值。由于系统是线性的，右侧的雅可比矩阵就是矩阵$\\mathbf{K}$本身。\n\n稳定性条件为$|1 + \\Delta t \\lambda| \\le 1$，适用于雅可比矩阵的所有特征值$\\lambda$。问题指定了严格不等式$|1 + \\Delta t \\lambda|  1$，以确保误差衰减。\n雅可比矩阵的特征值为$\\lambda_1 = 0$和$\\lambda_2 = -(k_{1} + k_{2})$。\n\n对于$\\lambda_1 = 0$：\n条件为$|1 + \\Delta t \\cdot 0| = |1| = 1$。这满足非严格条件$|1+\\Delta t\\lambda_1|\\le 1$，但不满足严格条件。然而，该模态与守恒量相关，既不增长也不衰减，因此对于任何$\\Delta t > 0$都不会引起不稳定性。稳定性由最刚性（最负）的特征值决定。\n\n对于$\\lambda_2 = -(k_{1} + k_{2})$：\n条件为$|1 + \\Delta t (-(k_{1} + k_{2}))|  1$。\n$$ |1 - \\Delta t (k_{1} + k_{2})|  1 $$\n这等价于不等式：\n$$ -1  1 - \\Delta t (k_{1} + k_{2})  1 $$\n我们分析不等式的两个部分：\n1) $1 - \\Delta t (k_{1} + k_{2})  1 \\implies -\\Delta t (k_{1} + k_{2})  0$。因为$\\Delta t > 0$且$k_{1}, k_{2}$为正，所以这总是成立的。\n2) $-1  1 - \\Delta t (k_{1} + k_{2}) \\implies \\Delta t (k_{1} + k_{2})  2 \\implies \\Delta t  \\frac{2}{k_{1} + k_{2}}$。\n\n因此，该方法的稳定性受到最刚性模态（对应于$\\lambda_2$）的限制。最大稳定时间步长为：\n$$ \\Delta t_{\\max} = \\frac{2}{k_{1} + k_{2}} $$\n\n现在，我们为$k_{1} = 500~\\text{s}^{-1}$和$k_{2} = 0.5~\\text{s}^{-1}$计算数值。\n$$ \\Delta t_{\\max} = \\frac{2}{500~\\text{s}^{-1} + 0.5~\\text{s}^{-1}} = \\frac{2}{500.5}~\\text{s} $$\n$$ \\Delta t_{\\max} \\approx 0.00399600399...~\\text{s} $$\n四舍五入到四位有效数字，我们得到：\n$$ \\Delta t_{\\max} = 0.003996~\\text{s} $$\n用科学记数法表示，这是$3.996 \\times 10^{-3}~\\text{s}$。\n对时间步长的严格限制是系统刚性的直接后果，其中快时间尺度$\\tau_{fast} = (k_1+k_2)^{-1} \\approx 1/500.5~\\text{s}$决定了显式方法的稳定性，即使用户只对发生在慢时间尺度$\\tau_{slow} \\sim k_2^{-1} = 2~\\text{s}$上的向平衡的缓慢演化感兴趣。",
            "answer": "$$\\boxed{3.996 \\times 10^{-3}}$$"
        },
        {
            "introduction": "大气化学传输模型（CTM）必须同时模拟化学反应和物理输送过程。算子分裂法，特别是Strang分裂法，是耦合这些不同过程的标准技术。本练习  深入探讨了这种耦合的准确性，要求你推导一个简单平流-反应问题的精确解和分裂解，并分析其误差。通过将分裂误差与梯形积分法则联系起来，你将对CTM中一个关键的数值误差来源获得深刻的理解。",
            "id": "3863578",
            "problem": "考虑一维（$1$-D）平流-反应偏微分方程（PDE）\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c,\n$$\n该方程定义在周期性域 $x \\in [0,1)$ 上，具有恒定的平流速度 $u$ 和空间变化的的一阶损失率 $k(x)$。初始条件为 $c(x,0)=c_0(x)$。令 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 表示在单个时间步长 $\\Delta t$ 内，通过积分耦合的平流-反应系统而不进行算子分裂得到的精确解，令 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 表示在相同时间步长内，使用规范的“半步反应，全步平流，半步反应”组合得到的 Strang 分裂近似解。这里的计算气相化学背景是线性的，其中反应被视为局部常微分方程（ODE） $c'=-k(x)\\,c$，平流被视为速度为 $u$ 的纯平移。假设边界条件是周期性的，且 $k(x)$ 和 $c_0(x)$ 是光滑的。\n\n仅从以下几点出发：\n- 线性平流的特征线法，\n- 在固定 $x$ 处线性 ODE $c'=-k(x)\\,c$ 的空间局部解，\n- Strang 分裂的定义（子算子的二阶组合：反应-平流-反应，时间份数分别为 $\\Delta t/2$、$\\Delta t$、$\\Delta t/2$），\n推导出周期域上 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 和 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 关于 $c_0$、$k$、$u$、$x$ 和 $\\Delta t$ 的显式闭式表达式，不得引用任何快捷公式。然后，利用这些表达式，量化逐点差异 $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$，并通过将 Strang 组合与沿特征线的时间积分的梯形近似联系起来，证明对于光滑的 $k(x)$，局部时间误差的尺度为 $O(\\Delta t^3)$。\n\n您必须实现一个程序，在均匀的 $x$ 网格上，针对以下特定的、光滑且周期性的选择，评估此单步局部误差：\n- 域：$x \\in [0,1)$，周期性。\n- 初始条件：$c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$。\n- 空间变化的损失率：$k(x)=k_0 + k_1 \\sin(2\\pi x)$。\n- 平流速度：$u$ 是一个常数。\n\n您的程序必须：\n- 在一个时间步长内，使用高分辨率的均匀 $x$ 网格来近似局部误差的上确界范数 $e(\\Delta t)=\\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty}$。\n- 对于每个测试，将归一化量 $e(\\Delta t)/\\Delta t^3$ 报告为浮点数。\n\n仅使用上述基本推导，实现 $c_{\\mathrm{unsplit}}$ 和 $c_{\\mathrm{Strang}}$ 的闭式求值。不要使用任何数值时间积分；仅评估推导出的公式。通过周期性三角函数的定义来解析地处理周期性。\n\n测试套件。运行五个测试，涵盖一般情况、用于标度分析的细化以及边缘情况：\n- 测试 1：$\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n- 测试 2：$\\Delta t=0.1$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n- 测试 3：$\\Delta t=0.05$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n- 测试 4（边缘情况，算子可交换）：$\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.0$。\n- 测试 5（边缘情况，无平流）：$\\Delta t=0.2$, $u=0.0$, $k_0=1.0$, $k_1=0.5$。\n\n所有量都是无量纲的。对于每个测试，使用足够精细的 $x$ 网格计算 $e(\\Delta t)/\\Delta t^3$，以使报告的值能反映理论上的 $\\Delta t^3$ 标度。将每个报告值四舍五入到 $10$ 位有效数字。\n\n最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，顺序与上述测试相同。例如，它应该看起来像\n$[r_1,r_2,r_3,r_4,r_5]$\n其中每个 $r_i$ 是对应测试的四舍五入后的浮点数值。",
            "solution": "用户希望验证并解决一个关于一维平流-反应偏微分方程（PDE）的 Strang 分裂误差分析问题。\n\n### 第 1 步：提取给定条件\n\n- **PDE：** $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c$\n- **域：** $x \\in [0,1)$，周期性。\n- **初始条件：** $c(x,0) = c_0(x)$。\n- **平流速度：** $u$ 是一个常数。\n- **反应速率：** $k(x)$ 是一个空间变化的一阶损失率。\n- **精确解：** $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 是在单个时间步长 $\\Delta t$ 内的精确解。\n- **近似解：** $c_{\\mathrm{Strang}}(x,\\Delta t)$ 是在 $\\Delta t$ 内的 Strang 分裂近似解，使用组合：半步反应（$\\Delta t/2$），全步平流（$\\Delta t$），半步反应（$\\Delta t/2$）。\n- **子问题：** 反应是局部 ODE $c'=-k(x)\\,c$，平流是纯平移。\n- **任务 1（推导）：** 推导 $c_{\\mathrm{unsplit}}(x,\\Delta t)$ 和 $c_{\\mathrm{Strang}}(x,\\Delta t)$ 的显式闭式表达式。\n- **任务 2（误差分析）：** 使用推导出的表达式，证明对于光滑的 $k(x)$，局部时间逐点误差 $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$ 为 $O(\\Delta t^3)$，方法是将其与梯形法则联系起来。\n- **任务 3（实现）：** 实现一个程序，计算归一化的局部误差上确界范数，$e(\\Delta t)/\\Delta t^3 = \\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty} / \\Delta t^3$。\n- **特定函数：**\n    - $c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$\n    - $k(x)=k_0 + k_1 \\sin(2\\pi x)$\n- **测试套件：**\n    - 测试 1：$\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n    - 测试 2：$\\Delta t=0.1$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n    - 测试 3：$\\Delta t=0.05$, $u=0.7$, $k_0=1.0$, $k_1=0.5$。\n    - 测试 4：$\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.0$。\n    - 测试 5：$\\Delta t=0.2$, $u=0.0$, $k_0=1.0$, $k_1=0.5$。\n- **输出格式：** 包含 5 个测试结果的逗号分隔列表，四舍五入到 10 位有效数字，并用方括号括起来。\n\n### 第 2 步：使用提取的给定条件进行验证\n\n- **科学依据：** 该问题是偏微分方程数值分析中的一个标准练习，特别关注算子分裂方法（Strang 分裂），这在计算物理和计算化学中被广泛使用。平流-反应方程是输运现象中的一个基本模型。所有概念在数学和计算科学中都已成熟。\n- **适定性：** 该问题是适定的。给定光滑初始条件和周期性边界条件的 PDE 具有唯一、稳定的解。任务是推导该精确解并将其与一个标准的数值近似解进行比较。参数已完全指定。\n- **客观性：** 问题使用精确的数学和计算语言陈述。没有主观或含糊的术语。\n- **完整性：** 问题是自洽的，并提供了执行推导和实现所需的所有必要信息（方程、定义、参数和特定函数）。\n\n### 第 3 步：结论与行动\n问题是有效的。这是计算科学中一个定义明确的任务，需要分析推导和数值实现。我现在将着手解决。\n\n### 推导与分析\n\n控制 PDE 是一个线性一阶平流-反应方程：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)c\n$$\n我们被要求在单个时间步长 $\\Delta t$ 内找到精确解和 Strang 分裂近似解。\n\n#### 1. 精确不分裂解, $c_{\\mathrm{unsplit}}(x, \\Delta t)$\n\n我们使用特征线法。特征曲线 $x(t)$ 由平流速度定义：\n$$\n\\frac{dx}{dt} = u\n$$\n积分此式得到特征线 $x(t) = x_{\\text{start}} + ut$。在时间 $t$ 的点 $x$ 源自位置 $x_{\\text{start}} = x - ut$。\n\n沿着一条特征线，$c(x(t), t)$ 关于时间的全导数为：\n$$\n\\frac{dc}{dt} = \\frac{\\partial c}{\\partial t} + \\frac{dx}{dt}\\frac{\\partial c}{\\partial x} = \\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x}\n$$\n将此代入 PDE，我们得到沿特征线的关于 $c$ 的常微分方程（ODE）：\n$$\n\\frac{dc}{dt} = -k(x(t))c\n$$\n为了找到点 $(x, \\Delta t)$ 处的解，我们考虑穿过该点的特征线。该特征线在时间 $t=0$ 时源于位置 $x_0 = x - u\\Delta t$。该 ODE 的初始值为 $c(0) = c(x_0, 0) = c_0(x_0)$。\n\n沿特征线的方程是 $\\frac{dc}{dt} = -k(x_0+ut)c$。将此 ODE 从 $t=0$ 积分到 $t=\\Delta t$ 得到：\n$$\nc(x, \\Delta t) = c_0(x_0) \\exp\\left( -\\int_0^{\\Delta t} k(x_0 + u\\tau) d\\tau \\right)\n$$\n代入 $x_0 = x - u\\Delta t$，我们得到：\n$$\nc(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\int_0^{\\Delta t} k(x - u\\Delta t + u\\tau) d\\tau \\right)\n$$\n为了简化积分，我们进行变量替换。令 $s = x - u\\Delta t + u\\tau$。那么 $ds = u d\\tau$，积分变量 $s$ 的上下限为从 $x - u\\Delta t$（当 $\\tau=0$ 时）到 $x$（当 $\\tau=\\Delta t$ 时）。\n假设 $u \\neq 0$，积分为：\n$$\n\\int_{x-u\\Delta t}^{x} k(s) \\frac{ds}{u} = \\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds\n$$\n因此，精确解为：\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds \\right) \\quad (\\text{对于 } u \\neq 0)\n$$\n对于特殊情况 $u=0$，PDE 简化为 $\\frac{\\partial c}{\\partial t} = -k(x)c$。对于每个固定的 $x$，这是一个简单的 ODE，其解为 $c(x, t) = c(x,0) \\exp(-k(x)t)$。因此：\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x) \\exp(-k(x)\\Delta t) \\quad (\\text{对于 } u = 0)\n$$\n\n#### 2. Strang 分裂解, $c_{\\mathrm{Strang}}(x, \\Delta t)$\n\nStrang 分裂通过顺序应用反应算子和平流算子来近似解。其顺序是：半步反应，全步平流，再半步反应。\n\n**第 1 步：第一个半步反应（$\\Delta t/2$）：**\n从 $c_0(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} = -k(x)c$，时长为 $\\Delta t/2$。\n$$ c_1(x) = c_0(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n\n**第 2 步：全步平流（$\\Delta t$）：**\n从 $c_1(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$，时长为 $\\Delta t$。这是纯平流，它会平移解的剖面。\n$$ c_2(x) = c_1(x - u\\Delta t) = c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) $$\n\n**第 3 步：第二个半步反应（$\\Delta t/2$）：**\n从 $c_2(x)$ 开始，求解 $\\frac{\\partial c}{\\partial t} = -k(x)c$，时长为 $\\Delta t/2$。\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = c_2(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n代入 $c_2(x)$ 的表达式：\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = \\left[ c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) \\right] \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n合并指数项，我们得到 Strang 分裂解的闭式表达式：\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{\\Delta t}{2} \\left[k(x) + k(x - u\\Delta t)\\right] \\right)\n$$\n请注意，如果 $u=0$，此式正确地简化为 $c_0(x)\\exp(-k(x)\\Delta t)$，这与无平流情况下的精确解相匹配。\n\n#### 3. 误差分析及与梯形法则的联系\n\n我们现在分析局部逐点误差 $|c_{\\mathrm{Strang}}(x,\\Delta t) - c_{\\mathrm{unsplit}}(x,\\Delta t)|$。两个表达式共享前置因子 $c_0(x-u\\Delta t)$。差异源于指数项的参数。\n\n对于精确解，参数为 $-I_{\\mathrm{exact}} = -\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$。\n对于 Strang 分裂解，参数为 $-I_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)]$。\n\n我们来检查一下 $I_{\\mathrm{Strang}}$ 项。它可以重写为：\n$$\nI_{\\mathrm{Strang}} = \\frac{x - (x-u\\Delta t)}{u} \\frac{k(x) + k(x-u\\Delta t)}{2}\n$$\n这正是积分 $\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$ 的梯形法则近似。对于积分 $\\int_a^b f(s)ds$，梯形法则的误差由 $-\\frac{(b-a)^3}{12}f''(\\xi)$ 给出，其中 $\\xi \\in [a,b]$。\n\n将此应用于我们的积分项 $I_{\\mathrm{exact}}$（其中 $f(s)=k(s)$, $b=x$, $a=x-u\\Delta t$），我们得到：\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)] - \\frac{1}{u} \\frac{(u\\Delta t)^3}{12} k''(\\xi)\n$$\n其中 $\\xi \\in [x-u\\Delta t, x]$。因此，\n$$\nI_{\\mathrm{exact}} = I_{\\mathrm{Strang}} - \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\n解之间的差异是：\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} = c_0(x-u\\Delta t) \\left[ \\exp(-I_{\\mathrm{Strang}}) - \\exp(-I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp(I_{\\mathrm{Strang}} - I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp\\left(\\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\n对于小的 $\\Delta t$，内部指数的参数很小。对小的 $z$ 使用泰勒展开 $\\exp(z) \\approx 1+z$：\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} \\approx c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\left(1 + \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\n$$\n= -c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\n当 $\\Delta t \\to 0$ 时，$I_{\\mathrm{Strang}} \\to 0$ 且 $\\xi \\to x$。误差的主项变为：\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) - c_{\\mathrm{unsplit}}(x, \\Delta t) = -c_0(x) \\frac{u^2 k''(x)}{12} \\Delta t^3 + O(\\Delta t^4)\n$$\n这表明局部逐点误差是 $O(\\Delta t^3)$ 阶的，前提是 $k(x)$ 至少是二次可微的，对于给定的光滑周期函数 $k(x)$ 这是成立的。\n\n#### 4. 用于实现的显式公式\n\n对于给定的 $k(x) = k_0 + k_1 \\sin(2\\pi x)$，我们需要精确解的定积分。其不定积分为：\n$$\nK(s) = \\int k(s) ds = \\int (k_0 + k_1 \\sin(2\\pi s)) ds = k_0 s - \\frac{k_1}{2\\pi} \\cos(2\\pi s)\n$$\n$c_{\\mathrm{unsplit}}$ 指数中的积分项是：\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{1}{u}[K(x) - K(x-u\\Delta t)] = k_0 \\Delta t - \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\n因此，对于 $u \\neq 0$，$c_{\\mathrm{unsplit}}$ 中指数的参数是：\n$$\n\\arg_{\\mathrm{unsplit}} = -k_0 \\Delta t + \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\n\n使用给定的 $k(x)$，$c_{\\mathrm{Strang}}$ 的参数是：\n$$\n\\arg_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [ (k_0+k_1\\sin(2\\pi x)) + (k_0+k_1\\sin(2\\pi(x-u\\Delta t))) ]\n$$\n$$\n= -\\Delta t \\left( k_0 + \\frac{k_1}{2} [\\sin(2\\pi x) + \\sin(2\\pi(x-u\\Delta t))] \\right)\n$$\n这些显式公式将在实现中使用。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized local error of Strang splitting for an\n    advection-reaction equation over one time step.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (dt, u, k0, k1)\n        (0.2, 0.7, 1.0, 0.5),\n        (0.1, 0.7, 1.0, 0.5),\n        (0.05, 0.7, 1.0, 0.5),\n        (0.2, 0.7, 1.0, 0.0),\n        (0.2, 0.0, 1.0, 0.5),\n    ]\n\n    results = []\n    \n    # Use a high-resolution grid to minimize spatial discretization error.\n    # N=2**14 = 16384\n    N = 16384\n    x = np.linspace(0, 1, N, endpoint=False)\n\n    # Define initial condition and reaction rate functions.\n    # The functions are vectorized for numpy arrays.\n    def c0_func(x_val):\n        return 1.0 + 0.5 * np.sin(2 * np.pi * x_val) + 0.25 * np.cos(4 * np.pi * x_val)\n\n    def k_func(x_val, k0, k1):\n        return k0 + k1 * np.sin(2 * np.pi * x_val)\n\n    for dt, u, k0, k1 in test_cases:\n        # Characteristic departure point. Periodicity is handled by trigonometric functions.\n        x_prime = x - u * dt\n        \n        # Evaluate initial condition at departure points.\n        c0_at_x_prime = c0_func(x_prime)\n        \n        # --- Calculate Strang Splitting Solution ---\n        # Evaluate k at current and departure points.\n        k_at_x = k_func(x, k0, k1)\n        k_at_x_prime = k_func(x_prime, k0, k1)\n        \n        # Argument of the exponent for the Strang solution\n        exp_arg_strang = -0.5 * dt * (k_at_x + k_at_x_prime)\n        c_strang = c0_at_x_prime * np.exp(exp_arg_strang)\n\n        # --- Calculate Exact Unsplit Solution ---\n        if u == 0.0:\n            # Handle the no-advection case (u=0) separately.\n            # Here, the solution is purely local reaction.\n            c0_at_x = c0_func(x)\n            exp_arg_unsplit = -k_at_x * dt\n            c_unsplit = c0_at_x * np.exp(exp_arg_unsplit)\n        else:\n            # Handle the general advection-reaction case (u!=0).\n            # Use the derived formula for the integrated exponent.\n            cos_term = np.cos(2 * np.pi * x) - np.cos(2 * np.pi * x_prime)\n            exp_arg_unsplit = -k0 * dt + (k1 / (2 * np.pi * u)) * cos_term\n            c_unsplit = c0_at_x_prime * np.exp(exp_arg_unsplit)\n            \n        # --- Calculate Normalized Error ---\n        # Supremum norm of the pointwise difference\n        sup_norm_error = np.max(np.abs(c_strang - c_unsplit))\n        \n        # Normalize by dt^3 to observe O(dt^3) scaling\n        # For commuting cases (Test 4  5), the error is theoretically zero.\n        if dt == 0.0:\n            norm_error = 0.0\n        else:\n            norm_error = sup_norm_error / (dt**3)\n            \n        # Round the result to 10 significant digits as specified.\n        # The formatting string \"{:.10g}\" handles significant figures correctly.\n        # It's converted back to a float for the final list.\n        rounded_result = float(f\"{norm_error:.10g}\")\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}