{
    "hands_on_practices": [
        {
            "introduction": "分布式水文模型的核心是其基本计算单元，即网格单元。本练习将深入探讨单个单元内部的核心原理：质量守恒。通过将单元视为一个简化的“桶”模型，我们将分析其蓄水量如何在输入（如降水）和输出（如蒸散、径流）之间达到平衡（即稳态），这是理解模型长期行为和稳定性的基石。",
            "id": "3874841",
            "problem": "考虑一个用于环境和地球系统建模应用的分布式水文模型中的单个计算单元。垂向积分的水储量，记为 $S(t)$，其演变遵循质量守恒定律，等于不随时间变化的降水输入 $P$、不随时间变化的蒸散（ET）损失 $ET$ 与两个依赖于储量的通量之和的差值：向河道网络的侧向径流 $Q(S)$ 和向深层地下的补给或渗透损失 $R(S)$。控制方程是根据质量守恒原理得到的关于 $S(t)$ 的常微分方程：储量的变化率等于流入量减去流出量。\n\n假设侧向径流的参数化与线性水库理论一致，补给的参数化为非线性且依赖于储量的排水：\n- $Q(S) = k_{1} S$，其中 $k_{1} > 0$，\n- $R(S) = k_{2} S^{2}$，其中 $k_{2} > 0$。\n\n从稳态的基本定义（$\\mathrm{d}S/\\mathrm{d}t = 0$）出发，推导在不随时间变化的强迫 $P$ 和 $ET$ 下，存在一个物理上可接受的稳态储量 $S^{*} \\geq 0$ 的条件，并根据参数 $P$、$ET$、$k_{1}$ 和 $k_{2}$ 确定 $S^{*}$ 的唯一性。然后，通过在 $S^{*}$ 附近对储量动态进行线性化，分析 $S^{*}$ 的局部渐近稳定性，并用净通量相对于 $S$ 的导数来表述稳定性条件。\n\n最后，对于参数值 $P = 6$ mm day$^{-1}$，$ET = 2$ mm day$^{-1}$，$k_{1} = 0.1$ day$^{-1}$ 和 $k_{2} = 0.005$ mm$^{-1}$ day$^{-1}$，计算稳态储量 $S^{*}$。以毫米为单位表示最终储量，并将答案四舍五入到四位有效数字。",
            "solution": "出发点是代表单个计算单元的控制体的质量守恒。垂向积分的水储量 $S(t)$ 服从\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - Q(S) - R(S),\n$$\n其中 $P$ 和 $ET$ 分别是时间不变的降水和蒸散（ET）通量，$Q(S)$ 和 $R(S)$ 是依赖于储量的侧向径流和深层补给损失。\n\n在给定的参数化 $Q(S) = k_{1} S$ 和 $R(S) = k_{2} S^{2}$（其中 $k_{1} > 0$ 和 $k_{2} > 0$）下，该动力系统可以写成\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - k_{1} S - k_{2} S^{2}.\n$$\n\n稳态 $S^{*}$ 由以下条件定义\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t}\\bigg|_{S=S^{*}} = 0,\n$$\n这得到代数平衡方程\n$$\n0 = P - ET - k_{1} S^{*} - k_{2} S^{*2}.\n$$\n整理后得到关于 $S^{*}$ 的二次方程：\n$$\nk_{2} S^{*2} + k_{1} S^{*} - (P - ET) = 0.\n$$\n\n物理上可接受的稳态的存在性与唯一性：\n- 考虑 $P - ET$。如果 $P - ET  0$，那么对于任何 $S \\geq 0$，\n$$\nP - ET - k_{1} S - k_{2} S^{2} \\leq P - ET  0,\n$$\n稳态方程对任何 $S^{*} \\geq 0$ 都不成立；因此，不存在物理上可接受的稳态。\n- 如果 $P - ET = 0$，二次方程变为 $k_{2} S^{*2} + k_{1} S^{*} = 0$，其非负解为 $S^{*} = 0$ 和 $S^{*} = -k_{1}/k_{2}  0$；唯一物理上可接受的稳态是 $S^{*} = 0$，它在非负域中是唯一的。\n- 如果 $P - ET > 0$，二次方程的判别式为\n$$\n\\Delta = k_{1}^{2} + 4 k_{2} (P - ET) > 0,\n$$\n且有两个实根\n$$\nS^{*}_{\\pm} = \\frac{-k_{1} \\pm \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}}.\n$$\n由于 $k_{2} > 0$ 且 $\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} > k_{1}$，因此 $S^{*}_{+} > 0$ 且 $S^{*}_{-}  0$。因此，存在唯一一个物理上可接受的（非负）根，\n$$\nS^{*} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}},\n$$\n这就在物理上有意义的域 $S^{*} \\geq 0$ 中确立了唯一性。\n\n局部渐近稳定性：\n定义净通量函数\n$$\nf(S) = P - ET - k_{1} S - k_{2} S^{2}.\n$$\n如果在 $S^{*}$ 附近的线性化系统具有负增长率，即如果\n$$\nf'(S^{*})  0,\n$$\n那么稳态 $S^{*}$ 是局部渐近稳定的。\n计算导数：\n$$\nf'(S) = -k_{1} - 2 k_{2} S.\n$$\n对于任何 $S^{*} \\geq 0$ 且 $k_{1} > 0$ 和 $k_{2} > 0$，我们有\n$$\nf'(S^{*}) = -k_{1} - 2 k_{2} S^{*}  0.\n$$\n因此，该模型类别中任何物理上可接受的稳态都是局部渐近稳定的。\n\n数值计算：\n给定 $P = 6$ mm day$^{-1}$，$ET = 2$ mm day$^{-1}$，$k_{1} = 0.1$ day$^{-1}$ 和 $k_{2} = 0.005$ mm$^{-1}$ day$^{-1}$，首先确认 $P - ET > 0$：\n$$\nP - ET = 6 - 2 = 4.\n$$\n计算判别式：\n$$\nk_{1}^{2} + 4 k_{2} (P - ET) = (0.1)^{2} + 4 \\cdot 0.005 \\cdot 4 = 0.01 + 0.08 = 0.09.\n$$\n那么\n$$\n\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} = \\sqrt{0.09} = 0.3.\n$$\n计算 $S^{*}$：\n$$\nS^{*} = \\frac{-0.1 + 0.3}{2 \\cdot 0.005} = \\frac{0.2}{0.01} = 20.\n$$\n以毫米表示并四舍五入到四位有效数字，稳态储量为 $20.00$ mm。",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "在理解了单个模型单元的动态后，下一步是连接这些单元以模拟水在景观尺度上的运动。本练习将从点尺度扩展到一维山坡，运用 Dupuit-Forchheimer 近似来模拟浅层地下水流。这是一个基于编程的实践任务，您将通过数值方法求解控制方程，从而架起水文理论与计算模型之间的桥梁。",
            "id": "3874816",
            "problem": "您的任务是，在 Dupuit-Forchheimer (DF) 近似下，计算一维山坡上的稳态地下水水位剖面。请从适用于分布式水文模型的第一性原理出发：饱和流质量守恒和达西定律。在 DF 近似下，单位宽度的侧向流量由 $q(x) = -K(x)\\,h(x)\\,\\dfrac{dh}{dx}$ 给出，其中 $K(x)$ 是水力传导系数，$h(x)$ 是不透水基底以上的地下水位高程，$x$ 是下坡坐标。质量守恒要求 $\\dfrac{dq}{dx} = R(x)$，其中 $R(x)$ 是补给率。结合这些陈述，可得到稳态下的控制性边值问题 (BVP)：\n$$\n\\frac{d}{dx}\\left(K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = -\\,R(x),\n$$\n其边界条件与山坡情况一致：在上坡分水岭 $x=0$ 处，对称性要求无流量条件 $\\dfrac{dh}{dx}(0)=0$；在下坡出口 $x=L$ 处，地下水位等于指定水位 $h(L)=h_{\\mathrm{out}}$。在 $x\\in[0,L]$ 上，所有物理量必须保持非负且有限。\n\n您的程序必须对以下 $K(x)$ 和 $R(x)$ 的参数化测试套件，对此 BVP 进行数值求解。对于每个测试用例，计算并返回两个量：以米 (m) 为单位的中点地下水位高程 $h(L/2)$，以及以平方米每秒 (m$^2$/s) 为单位的出口单位宽度流量 $q(L)$，两者均为浮点数。\n\n请使用以下科学上真实且内部一致的测试套件。所有距离单位为米 (m)，时间单位为秒 (s)。水力传导系数 $K$ 的单位为米每秒 (m/s)，补给 $R$ 的单位为米每秒 (m/s)，水头 $h$ 的单位为米 (m)。\n\n- 测试用例 $1$ (恒定水力传导系数和恒定补给):\n  - $L = 100$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = R_0$，$R_0 = 1.0 \\times 10^{-8}$ m/s\n  - $h_{\\mathrm{out}} = 1.0$ m\n\n- 测试用例 $2$ (指数变化的水力传导系数和恒定补给):\n  - $L = 200$ m\n  - $K(x) = K_0 \\exp\\!\\left(\\beta\\,\\frac{x}{L}\\right)$，$K_0 = 5.0 \\times 10^{-6}$ m/s，$\\beta = 2.0$\n  - $R(x) = R_0$，$R_0 = 5.0 \\times 10^{-9}$ m/s\n  - $h_{\\mathrm{out}} = 0.5$ m\n\n- 测试用例 $3$ (恒定水力传导系数和线性递减补给):\n  - $L = 150$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = R_0\\left(1 - \\gamma\\,\\frac{x}{L}\\right)$，$R_0 = 1.0 \\times 10^{-8}$ m/s，$\\gamma = 0.8$\n  - $h_{\\mathrm{out}} = 0.3$ m\n\n- 测试用例 $4$ (零补给的边界情况):\n  - $L = 100$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = 0$\n  - $h_{\\mathrm{out}} = 0.7$ m\n\n您的程序必须：\n- 仅使用 DF 近似和质量守恒作为基本依据，来建立 $h(x)$ 的 BVP，而不要引用问题陈述中的捷径公式。\n- 对每个测试用例，在 $x \\in [0,L]$ 上数值求解 BVP，确保 $h(x)$ 保持为正，并且解满足边界条件。\n- 对每个测试用例，计算以米 (m) 为单位的 $h(L/2)$ 和以平方米每秒 (m$^2$/s) 为单位的 $q(L) = -K(L)\\,h(L)\\,\\dfrac{dh}{dx}\\big|_{x=L}$。\n- 输出单行内容，其中包含一个用方括号括起来的逗号分隔列表，作为汇总结果。该列表必须按测试用例排序，且每个测试用例的结果先包含 $h(L/2)$ 再包含 $q(L)$，最终格式为：\n$[h_1(L/2),q_1(L),h_2(L/2),q_2(L),h_3(L/2),q_3(L),h_4(L/2),q_4(L)]$。\n\n不允许外部输入；程序必须是自包含的，并按规定产生单行输出。数值必须是指定单位的浮点数。",
            "solution": "所提出的问题陈述具有科学依据、适定且内部一致。它描述了一个基于 Dupuit-Forchheimer 近似的山坡水文学中的经典边值问题。所有参数、边界条件和所需输出都已明确定义。该问题是有效的，并且存在严谨的解。\n\n求解过程首先从所述的第一性原理出发，建立控制性常微分方程 (ODE)，然后在给定的边界条件下求解该方程。\n\n基本原理是经 Dupuit-Forchheimer 近似调整后适用于单位宽度流量 $q(x)$ 的达西定律，以及稳态下的质量守恒方程：\n$$\nq(x) = -K(x)\\,h(x)\\,\\frac{dh}{dx} \\quad \\text{(Darcy-Forchheimer)}\n$$\n$$\n\\frac{dq}{dx} = R(x) \\quad \\text{(质量守恒)}\n$$\n这里，$h(x)$ 是饱和厚度（不透水基底以上的地下水位高程），$x$ 是从分水岭开始的水平坐标，$K(x)$ 是水力传导系数，$R(x)$ 是净补给率。\n\n将 $q(x)$ 的表达式代入质量守恒方程，得到关于地下水高度 $h(x)$ 的控制性二阶非线性边值问题 (BVP)：\n$$\n\\frac{d}{dx}\\left(-K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = R(x)\n$$\n$$\n\\frac{d}{dx}\\left(K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = -R(x)\n$$\n该方程需在定义域 $x \\in [0, L]$ 上求解，并满足以下边界条件：\n1.  上坡分水岭 ($x=0$) 处的无流量条件：$\\dfrac{dh}{dx}(0) = 0$。\n2.  下坡出口 ($x=L$) 处的指定地下水高度：$h(L) = h_{\\mathrm{out}}$。\n\n为了求解此 BVP，我们引入变量代换，定义 $y(x) = \\frac{1}{2}h(x)^2$。$y(x)$ 的导数为 $\\frac{dy}{dx} = h(x)\\frac{dh}{dx}$。将其代入控制性 ODE 可使其线性化：\n$$\n\\frac{d}{dx}\\left(K(x)\\,\\frac{dy}{dx}\\right) = -R(x)\n$$\n边界条件也相应地转换：\n1.  $\\dfrac{dh}{dx}(0) = 0 \\implies \\dfrac{dy}{dx}(0) = h(0)\\dfrac{dh}{dx}(0) = 0$。\n2.  $h(L) = h_{\\mathrm{out}} \\implies y(L) = \\frac{1}{2}h_{\\mathrm{out}}^2$。\n\n我们也可以用 $y(x)$ 来表示流量 $q(x)$：\n$$\nq(x) = -K(x)\\,h(x)\\,\\frac{dh}{dx} = -K(x)\\,\\frac{dy}{dx}\n$$\n将质量守恒方程 $\\frac{dq}{dx} = R(x)$ 从分水岭 $x=0$ 积分到任意位置 $x$ 可得：\n$$\n\\int_0^x \\frac{dq}{d\\xi}\\,d\\xi = \\int_0^x R(\\xi)\\,d\\xi\n$$\n$$\nq(x) - q(0) = \\int_0^x R(\\xi)\\,d\\xi\n$$\n无流量边界条件 $\\frac{dh}{dx}(0) = 0$ 意味着 $q(0) = -K(0)h(0)\\frac{dh}{dx}(0) = 0$。因此，任意点 $x$ 处的流量是上坡总补给量：\n$$\nq(x) = \\int_0^x R(\\xi)\\,d\\xi\n$$\n这提供了一种通过将补给函数 $R(x)$ 在整个山坡长度 $[0, L]$ 上积分来直接计算所需出口流量 $q(L)$ 的方法。对于给定的测试用例，积分 $\\mathcal{R}(x) = \\int_0^x R(\\xi)\\,d\\xi$ 可以解析计算：\n- 用例 1 和 2 ($R(x)=R_0$)：$\\mathcal{R}(x) = R_0 x$\n- 用例 3 ($R(x)=R_0(1-\\gamma x/L)$)：$\\mathcal{R}(x) = R_0(x - \\frac{\\gamma x^2}{2L})$\n- 用例 4 ($R(x)=0$)：$\\mathcal{R}(x) = 0$\n\n现在，我们求解 $h(x)$。根据 $q(x) = -K(x)\\frac{dy}{dx}$ 和 $q(x) = \\mathcal{R}(x)$，我们有：\n$$\n\\frac{dy}{dx} = -\\frac{q(x)}{K(x)}\n$$\n为了求得 $y(x)$，我们利用在 $x=L$ 处的边界条件，将此表达式从 $x$ 积分到 $L$：\n$$\n\\int_x^L \\frac{dy}{d\\zeta}\\,d\\zeta = \\int_x^L -\\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n$$\ny(L) - y(x) = -\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n代入 $y(x) = \\frac{1}{2}h(x)^2$ 和 $y(L) = \\frac{1}{2}h_{\\mathrm{out}}^2$：\n$$\n\\frac{1}{2}h_{\\mathrm{out}}^2 - \\frac{1}{2}h(x)^2 = -\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n求解 $h(x)^2$ 可得：\n$$\nh(x)^2 = h_{\\mathrm{out}}^2 + 2\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n最后，取平方根，并确保满足物理约束 $h(x) \\geq 0$：\n$$\nh(x) = \\sqrt{h_{\\mathrm{out}}^2 + 2\\int_x^L \\frac{\\mathcal{R}(\\zeta)}{K(\\zeta)}\\,d\\zeta}\n$$\n此表达式允许计算任意点的 $h(x)$。我们需要 $h(L/2)$，可通过在上述公式中设置 $x=L/2$ 来求得。为保证通用性和鲁棒性，该积分使用数值积分（具体为 `scipy.integrate.quad`）进行计算。\n\n每个测试用例的计算流程如下：\n1. 定义水力传导系数 $K(x)$ 和解析积分后的补给 $\\mathcal{R}(x) = q(x)$ 的函数。\n2. 通过计算 $\\mathcal{R}(L)$ 来得到出口流量 $q(L)$。\n3. 定义被积函数 $f(\\zeta) = \\frac{\\mathcal{R}(\\zeta)}{K(\\zeta)}$。\n4. 计算定积分 $I = \\int_{L/2}^L f(\\zeta)\\,d\\zeta$。\n5. 计算中点处的地下水高度为 $h(L/2) = \\sqrt{h_{\\mathrm{out}}^2 + 2I}$。\n6. 存储每个用例的结果 ($h(L/2)$, $q(L)$) 并格式化最终输出。\n此流程在以下程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the Dupuit-Forchheimer BVP for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (constant conductivity and constant recharge)\n        {\n            \"L\": 100.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 1.0e-8},\n            \"h_out\": 1.0,\n            \"case_id\": 1\n        },\n        # Test case 2 (exponentially varying conductivity and constant recharge)\n        {\n            \"L\": 200.0,\n            \"params\": {\"K0\": 5.0e-6, \"R0\": 5.0e-9, \"beta\": 2.0},\n            \"h_out\": 0.5,\n            \"case_id\": 2\n        },\n        # Test case 3 (constant conductivity and linearly decreasing recharge)\n        {\n            \"L\": 150.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 1.0e-8, \"gamma\": 0.8},\n            \"h_out\": 0.3,\n            \"case_id\": 3\n        },\n        # Test case 4 (edge case with zero recharge)\n        {\n            \"L\": 100.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 0.0},\n            \"h_out\": 0.7,\n            \"case_id\": 4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        h_out = case[\"h_out\"]\n        params = case[\"params\"]\n\n        K_func = None\n        q_analytic_func = None\n\n        if case[\"case_id\"] == 1:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            K_func = lambda x: K0\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0 d(xi) = R0*x\n            q_analytic_func = lambda x: R0 * x\n        \n        elif case[\"case_id\"] == 2:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            beta = params[\"beta\"]\n            K_func = lambda x: K0 * np.exp(beta * x / L)\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0 d(xi) = R0*x\n            q_analytic_func = lambda x: R0 * x\n            \n        elif case[\"case_id\"] == 3:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            gamma = params[\"gamma\"]\n            K_func = lambda x: K0\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0*(1-gamma*xi/L) d(xi)\n            q_analytic_func = lambda x: R0 * (x - (gamma * x**2) / (2 * L))\n\n        elif case[\"case_id\"] == 4:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            K_func = lambda x: K0\n            # q(x) = 0 since R(x) = 0\n            q_analytic_func = lambda x: 0.0\n\n        # Calculate outlet discharge q(L)\n        q_L = q_analytic_func(L)\n        \n        # Calculate h(L/2)\n        # h(x)^2 = h_out^2 + 2 * integral from x to L of (q(zeta)/K(zeta)) d(zeta)\n        # Define the integrand for the h calculation\n        integrand = lambda zeta: q_analytic_func(zeta) / K_func(zeta)\n        \n        # Numerically integrate from L/2 to L\n        integral_val, _ = quad(integrand, L / 2.0, L)\n        \n        # Calculate h(L/2)\n        h_sq_mid = h_out**2 + 2 * integral_val\n        # h must be non-negative. The physics of the problem ensures h_sq_mid = 0.\n        h_mid = np.sqrt(h_sq_mid)\n        \n        results.append(h_mid)\n        results.append(q_L)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "分布式模型必须面对现实世界中输入（如降雨）在空间上高度变化的挑战。本练习探讨了一个关键的理论问题：当我们用一个平均值来简化一个复杂的、异质的降雨场时，会引入多大的误差？通过分析一个非线性的产流响应过程，您将量化这种“集总误差”，并深入理解空间变异性与模型结构之间的相互作用，这是评估模型准确性的一个至关重要的考量。",
            "id": "3874849",
            "problem": "考虑一个流域面积为 $A$ 的分布式水文模型，该模型将区域划分为由位置 $\\mathbf{x} \\in A$ 索引的无穷小单元。设空间异质性降雨场表示为 $P(\\mathbf{x})$，且处处有 $P(\\mathbf{x}) > 0$。像元级的瞬时径流响应由非线性函数 $Q(P) = a P^{b}$ 描述，其中 $a > 0$ 和 $b > 0$ 是表征地表水文响应的常数。\n\n假设以下具有科学依据的条件：\n- 流域足够大且具有充分的遍历性，因此 $P(\\mathbf{x})$ 的函数的空间平均收敛于相对于 $P(\\mathbf{x})$ 的平稳分布的集合期望 $\\,\\mathbb{E}[\\cdot]$。\n- 降雨场 $P(\\mathbf{x})$ 在整个流域服从对数正态分布，即 $\\ln P(\\mathbf{x})$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布，在像元尺度上是独立同分布的。也就是说，$\\ln P(\\mathbf{x}) \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，因此 $P(\\mathbf{x})$ 服从参数为 $(\\mu, \\sigma^{2})$ 的对数正态分布。\n\n定义以下量：\n- 真实的分布式平均径流（通过逐点应用 $Q(\\cdot)$ 然后求平均得到）为\n$$\\overline{Q}_{\\mathrm{true}} = \\lim_{|A|\\to\\infty}\\frac{1}{|A|}\\int_{A} Q(P(\\mathbf{x}))\\,\\mathrm{d}\\mathbf{x} = \\mathbb{E}[Q(P)] = \\mathbb{E}[a P^{b}].$$\n- 均匀降雨平均径流近似（通过将异质性降雨场替换为其空间平均值然后应用 $Q(\\cdot)$ 得到）为\n$$\\overline{Q}_{\\mathrm{unif}} = Q\\big(\\mathbb{E}[P]\\big) = a\\big(\\mathbb{E}[P]\\big)^{b}.$$\n\n从空间平均和期望的定义出发，仅使用对数正态分布的基本性质以及函数的期望由其对概率密度函数的积分给出的事实，推导将异质性降雨场视为均匀场而引入的平均径流的相对误差的闭式解析表达式：\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}} - \\overline{Q}_{\\mathrm{true}}}{\\overline{Q}_{\\mathrm{true}}}.$$\n\n将您的最终答案表示为关于 $a$、$b$、$\\mu$ 和 $\\sigma^{2}$ 的单个简化符号表达式。不需要进行数值代入。相对误差 ${\\varepsilon}$ 是无量纲的，不需要单位。请提供闭式解析表达式形式的最终答案。",
            "solution": "该问题要求推导相对误差 $\\varepsilon$，该误差产生于用平均降雨计算的径流来近似空间异质性降雨场的平均径流。相对误差定义为：\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}} - \\overline{Q}_{\\mathrm{true}}}{\\overline{Q}_{\\mathrm{true}}} = \\frac{\\overline{Q}_{\\mathrm{unif}}}{\\overline{Q}_{\\mathrm{true}}} - 1$$\n为了求得 $\\varepsilon$，我们必须首先推导真实平均径流 $\\overline{Q}_{\\mathrm{true}}$ 和均匀降雨近似 $\\overline{Q}_{\\mathrm{unif}}$ 的表达式。\n\n问题陈述降雨强度 $P(\\mathbf{x})$ 服从对数正态分布，因此如果我们定义一个随机变量 $P$ 来表示任意点的降雨，那么 $\\ln P$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布。令 $X = \\ln P$，则 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。因此，$P = \\exp(X)$。径流响应由非线性函数 $Q(P) = aP^b$ 给出。\n\n首先，我们计算真实的分布式平均径流 $\\overline{Q}_{\\mathrm{true}}$。这是径流函数的空间平均值，根据遍历性假设，它等于 $Q(P)$ 的期望。\n$$\\overline{Q}_{\\mathrm{true}} = \\mathbb{E}[Q(P)] = \\mathbb{E}[aP^{b}]$$\n由于 $a$ 是一个常数，我们可以写成：\n$$\\overline{Q}_{\\mathrm{true}} = a\\mathbb{E}[P^{b}]$$\n为了计算期望 $\\mathbb{E}[P^{b}]$，我们代入 $P = \\exp(X)$：\n$$\\mathbb{E}[P^{b}] = \\mathbb{E}[(\\exp(X))^{b}] = \\mathbb{E}[\\exp(bX)]$$\n该表达式是正态随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$ 的矩生成函数 (MGF) 在 $t=b$ 处的值。正态随机变量的 MGF 由 $M_X(t) = \\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$ 给出。\n在 $t=b$ 处求值，我们得到对数正态分布的 $b$ 阶矩：\n$$\\mathbb{E}[P^{b}] = M_X(b) = \\exp\\left(\\mu b + \\frac{1}{2}\\sigma^{2}b^{2}\\right)$$\n将此代回 $\\overline{Q}_{\\mathrm{true}}$ 的表达式中，得到：\n$$\\overline{Q}_{\\mathrm{true}} = a \\exp\\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)$$\n\n接下来，我们计算均匀降雨平均径流近似 $\\overline{Q}_{\\mathrm{unif}}$。这是通过将径流函数 $Q$ 应用于平均降雨 $\\mathbb{E}[P]$ 来找到的。\n$$\\overline{Q}_{\\mathrm{unif}} = Q(\\mathbb{E}[P]) = a\\left(\\mathbb{E}[P]\\right)^{b}$$\n我们首先需要找到降雨的均值 $\\mathbb{E}[P]$。这是对数正态分布的一阶矩，可以通过在我们之前的矩计算中设置 $b=1$ 来找到：\n$$\\mathbb{E}[P] = \\mathbb{E}[P^1] = M_X(1) = \\exp\\left(\\mu(1) + \\frac{1}{2}\\sigma^2 (1)^2\\right) = \\exp\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)$$\n现在，我们将此均值代入 $\\overline{Q}_{\\mathrm{unif}}$ 的表达式中：\n$$\\overline{Q}_{\\mathrm{unif}} = a\\left(\\exp\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)\\right)^{b}$$\n使用指数的幂法则 $(e^x)^y = e^{xy}$，我们将其简化为：\n$$\\overline{Q}_{\\mathrm{unif}} = a \\exp\\left(b\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)\\right) = a \\exp\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right)$$\n\n有了 $\\overline{Q}_{\\mathrm{true}}$ 和 $\\overline{Q}_{\\mathrm{unif}}$ 的表达式，我们现在可以计算相对误差 $\\varepsilon$。\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}}}{\\overline{Q}_{\\mathrm{true}}} - 1 = \\frac{a \\exp\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right)}{a \\exp\\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)} - 1$$\n常数 $a$ 被消去。我们使用规则 $e^x/e^y = e^{x-y}$ 合并指数项：\n$${\\varepsilon} = \\exp\\left(\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right) - \\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)\\right) - 1$$\n指数中的项 $b\\mu$ 被消去：\n$${\\varepsilon} = \\exp\\left(\\frac{1}{2}b\\sigma^{2} - \\frac{1}{2}b^{2}\\sigma^{2}\\right) - 1$$\n从指数中提出公因式 $\\frac{1}{2}\\sigma^2$ 得到最终的简化表达式：\n$${\\varepsilon} = \\exp\\left(\\frac{1}{2}\\sigma^2(b - b^2)\\right) - 1$$\n这就是相对误差的闭式解析表达式，用径流非线性参数 $b$ 和对数降雨的方差 $\\sigma^2$ 表示。",
            "answer": "$$\\boxed{\\exp\\left(\\frac{1}{2}(b-b^2)\\sigma^2\\right) - 1}$$"
        }
    ]
}