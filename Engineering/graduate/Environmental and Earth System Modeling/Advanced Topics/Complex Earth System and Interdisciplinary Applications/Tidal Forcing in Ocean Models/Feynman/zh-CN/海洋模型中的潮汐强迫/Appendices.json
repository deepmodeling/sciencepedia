{
    "hands_on_practices": [
        {
            "introduction": "在海洋模型中准确地表示潮汐强迫，始于对其天文起源的深刻理解。本练习将引导你从第一性原理——即牛顿万有引力定律——出发，推导引潮势的关键组成部分。通过这一过程，你将不仅掌握其数学形式，还能估算出平衡潮的数量级，为所有潮汐建模工作奠定坚实的物理基础 。",
            "id": "3926697",
            "problem": "考虑在海洋环流模式（OGCM）中用于设定大尺度正压潮汐强迫的平衡潮概念。海洋表面的垂直平衡潮由 $\\eta_{eq} = U/g$ 给出，其中 $U$ 是单位质量的引潮势，$g$ 是重力加速度。假设地球为半径为 $R$ 的球对称体，并考虑赤道上的一个点。设质量为 $M_{m}$ 的月球与地心的平均距离为 $r$，并采用牛顿引力。\n\n从地球表面某点的月球引力势 $\\Phi(\\mathbf{x}) = -G M_{m}/|\\mathbf{r}-\\mathbf{x}|$ 出发，对小参数 $\\epsilon = R/r$ 进行泰勒展开至二阶（含二阶），并解释为什么常数项（零阶）和线性项（一阶）在地月共转参考系中对引潮势没有贡献。根据此推导，求出赤道上二阶引潮势 $U$ 的主阶标度，并证明其量级为 $G M_{m} R^{2}/r^{3}$（不计与半日变化相关的一阶几何因子）。\n\n使用此标度，计算赤道上月球半日引潮势 $U$ 及其对应的平衡潮 $\\eta_{eq} = U/g$ 的量级估计。使用以下标准地月参数值：$G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$M_{m} = 7.342 \\times 10^{22}\\ \\mathrm{kg}$，$R = 6.371 \\times 10^{6}\\ \\mathrm{m}$，$r = 3.844 \\times 10^{8}\\ \\mathrm{m}$，以及 $g = 9.81\\ \\mathrm{m\\,s^{-2}}$。在进行量级估计时，将几何因子视为一阶（order unity）。\n\n将 $U$ 和 $\\eta_{eq}$ 的结果四舍五入至2位有效数字。将 $U$ 以 $\\mathrm{m^{2}\\,s^{-2}}$ 为单位表示，$\\eta_{eq}$ 以 $\\mathrm{m}$ 为单位表示。将最终结果以一个二元行向量 $\\left(U,\\ \\eta_{eq}\\right)$ 的形式报告。",
            "solution": "用户请求解答一个关于平衡潮概念的问题。根据规则，第一步是验证问题陈述。\n\n### 步骤1：提取已知条件\n- **概念**：海洋环流模式（OGCM）中用于大尺度正压潮汐强迫的平衡潮。\n- **定义**：垂直平衡潮为 $\\eta_{eq} = U/g$。\n- **变量**：\n    - $U$：单位质量的引潮势。\n    - $g$：重力加速度。\n    - $R$：球对称地球的半径。\n    - $M_m$：月球质量。\n    - $r$：地心到月球的平均距离。\n    - $\\mathbf{x}$：地球表面某点相对于地心的位置矢量。\n    - $\\mathbf{r}$：月球相对于地心的位置矢量。\n- **物理学**：牛顿引力。\n- **势公式**：在点 $\\mathbf{x}$ 处的月球引力势为 $\\Phi(\\mathbf{x}) = -G M_{m}/|\\mathbf{r}-\\mathbf{x}|$。\n- **展开参数**：$\\epsilon = R/r$ 是一个小参数。\n- **任务1**：将 $\\Phi(\\mathbf{x})$ 按 $\\epsilon$ 泰勒展开至二阶（含二阶）。\n- **任务2**：解释为什么在地月共转参考系中，常数项（零阶）和线性项（一阶）对引潮势 $U$ 没有贡献。\n- **任务3**：求出赤道上二阶引潮势 $U$ 的主阶标度，并证明其量级为 $G M_{m} R^{2}/r^{3}$。\n- **任务4**：计算赤道上 $U$ 和 $\\eta_{eq}$ 的量级估计，将几何因子视为一阶。\n- **常数**：\n    - $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$\n    - $M_{m} = 7.342 \\times 10^{22}\\ \\mathrm{kg}$\n    - $R = 6.371 \\times 10^{6}\\ \\mathrm{m}$\n    - $r = 3.844 \\times 10^{8}\\ \\mathrm{m}$\n    - $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- **输出要求**：\n    - 将 $U$ 和 $\\eta_{eq}$ 四舍五入至2位有效数字。\n    - 将 $U$ 以 $\\mathrm{m^{2}\\,s^{-2}}$ 为单位表示，$\\eta_{eq}$ 以 $\\mathrm{m}$ 为单位表示。\n    - 将最终结果以一个二元行向量 $(U, \\eta_{eq})$ 的形式报告。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它展示了经典力学和地球物理学中的一个标准推导。物理模型（牛顿引力）、数学方法（泰勒展开）以及相关概念（引潮势、平衡潮）都是基础且公认的。所提供的常数是标准的天文和物理数值。$\\epsilon=R/r$ 为小量的假设在物理上是正确的。该问题没有科学缺陷、内部矛盾或含糊不清之处。推导和计算所需的所有信息均已提供。\n\n### 步骤3：结论与行动\n问题有效。现在提供完整解答。\n\n### 解答推导\n地球表面上一点 $\\mathbf{x}$ 处单位质量的月球引力势由以下公式给出：\n$$\n\\Phi(\\mathbf{x}) = -\\frac{G M_{m}}{|\\mathbf{r}-\\mathbf{x}|}\n$$\n其中 $\\mathbf{r}$ 是月球的位置矢量，$\\mathbf{x}$ 是地表上该点的位置矢量，两者均相对于地心。$|\\mathbf{r}-\\mathbf{x}|$ 的大小可表示为：\n$$\n|\\mathbf{r}-\\mathbf{x}| = \\sqrt{(\\mathbf{r}-\\mathbf{x})\\cdot(\\mathbf{r}-\\mathbf{x})} = \\sqrt{|\\mathbf{r}|^2 - 2\\mathbf{r}\\cdot\\mathbf{x} + |\\mathbf{x}|^2}\n$$\n令 $|\\mathbf{r}| = r$，$|\\mathbf{x}| = R$，$\\mathbf{r}$ 与 $\\mathbf{x}$ 之间的夹角为 $\\theta$（月球的天顶角）。则 $\\mathbf{r}\\cdot\\mathbf{x} = rR\\cos\\theta$。代入这些值可得：\n$$\n|\\mathbf{r}-\\mathbf{x}| = \\sqrt{r^2 - 2rR\\cos\\theta + R^2} = r\\sqrt{1 - 2\\frac{R}{r}\\cos\\theta + \\left(\\frac{R}{r}\\right)^2}\n$$\n令 $\\epsilon = R/r$。势变为：\n$$\n\\Phi(\\mathbf{x}) = -\\frac{G M_{m}}{r} \\left(1 - 2\\epsilon\\cos\\theta + \\epsilon^2\\right)^{-1/2}\n$$\n括号中的项是勒让德多项式 $P_n(\\cos\\theta)$ 的生成函数，这使得可以进行如下展开：\n$$\n\\left(1 - 2\\epsilon\\cos\\theta + \\epsilon^2\\right)^{-1/2} = \\sum_{n=0}^{\\infty} \\epsilon^n P_n(\\cos\\theta)\n$$\n将势 $\\Phi(\\mathbf{x})$ 按 $\\epsilon=(R/r)$ 展开至二阶，可得：\n$$\n\\Phi(\\mathbf{x}) = -\\frac{G M_{m}}{r} \\sum_{n=0}^{2} \\left(\\frac{R}{r}\\right)^n P_n(\\cos\\theta) + \\mathcal{O}(\\epsilon^3)\n$$\n使用前三个勒让德多项式，$P_0(\\cos\\theta) = 1$，$P_1(\\cos\\theta) = \\cos\\theta$，以及 $P_2(\\cos\\theta) = \\frac{1}{2}(3\\cos^2\\theta - 1)$，我们得到：\n$$\n\\Phi(\\mathbf{x}) = \\underbrace{-\\frac{G M_{m}}{r}}_{n=0 \\text{ 项}} \\underbrace{-\\frac{G M_{m} R}{r^2}\\cos\\theta}_{n=1 \\text{ 项}} \\underbrace{-\\frac{G M_{m} R^2}{2r^3}(3\\cos^2\\theta - 1)}_{n=2 \\text{ 项}} + \\mathcal{O}(\\epsilon^3)\n$$\n引潮势 $U$ 是引力势中引起形变的部分。它可以通过考虑与地心一同加速的参考系来找到。月球在地心（$\\mathbf{x}=0$）处施加的单位质量引力为 $\\mathbf{F}_C = -\\nabla\\Phi|_{\\mathbf{x}=0} = -G M_m \\mathbf{r}/r^3$。这个力使地球作为一个刚体加速。在共同加速的参考系中，必须加入一个惯性势 $\\Phi_{inertial} = -\\mathbf{x} \\cdot \\mathbf{F}_C$。\n$$\n\\Phi_{inertial} = -\\mathbf{x} \\cdot \\left(-\\frac{G M_{m}}{r^3}\\mathbf{r}\\right) = \\frac{G M_{m}}{r^3}(\\mathbf{x}\\cdot\\mathbf{r}) = \\frac{G M_{m}}{r^3}(R r \\cos\\theta) = \\frac{G M_{m} R}{r^2}\\cos\\theta\n$$\n引潮势 $U$ 是完整势 $\\Phi$ 与此惯性势之和：\n$$\nU(\\mathbf{x}) = \\Phi(\\mathbf{x}) + \\Phi_{inertial}(\\mathbf{x})\n$$\n代入 $\\Phi(\\mathbf{x})$ 的展开式：\n$$\nU(\\mathbf{x}) = \\left(-\\frac{G M_{m}}{r} - \\frac{G M_{m} R}{r^2}\\cos\\theta - \\frac{G M_{m} R^2}{2r^3}(3\\cos^2\\theta - 1) + \\dots\\right) + \\frac{G M_{m} R}{r^2}\\cos\\theta\n$$\n$$\nU(\\mathbf{x}) = -\\frac{G M_{m}}{r} - \\frac{G M_{m} R^2}{2r^3}(3\\cos^2\\theta - 1) + \\mathcal{O}(\\epsilon^3)\n$$\n现在我们可以解释零阶和一阶项的贡献。\n- 零阶项 $-G M_m/r$ 在任何给定时间在整个地球上都是空间常数。潮汐力由势的梯度导出（$\\mathbf{F}_{tide}=-\\nabla U$）。常数的梯度为零，因此该项不产生力，可以舍去，因为势的定义只取决于一个附加常数。\n- 来自原始势 $\\Phi(\\mathbf{x})$ 的一阶项，即 $-\\frac{G M_{m} R}{r^2}\\cos\\theta$，正好被惯性势 $\\Phi_{inertial}$ 抵消。该项对应于遍布地球的均匀引力场，它负责整个地球朝向月球的加速。由于海洋和固体地球共同经受这种加速，它不会引起任何相对形变或潮汐。\n\n产生潮汐的主阶、空间变化项是二阶（degree-two）项：\n$$\nU_{2}(\\mathbf{x}) = -\\frac{G M_m R^2}{r^3} P_2(\\cos\\theta) = -\\frac{G M_m R^2}{2r^3}(3\\cos^2\\theta - 1)\n$$\n该势的大小由标度因子 $\\frac{G M_m R^2}{r^3}$ 决定。项 $P_2(\\cos\\theta)$ 是一个描述潮汐空间结构的量级为1的无量纲几何因子。对于赤道上的一个点，随着地球自转，月球的天顶角 $\\theta$ 会发生变化。如果月球位于赤道平面内，$\\theta$ 会周期性变化，而势取决于 $\\cos^2\\theta$。由于恒等式 $\\cos^2\\theta = (1+\\cos(2\\theta))/2$，该项包含一个分量，其变化频率是地球相对于月球自转频率的两倍，从而产生半日（每日两次）潮。势的量级为 $G M_{m} R^{2}/r^{3}$ 的理由来自于此推导，其中量级为1的几何因子 $P_2(\\cos\\theta)$ 乘以该标度。\n\n对于量级估计，我们被指示将几何因子视为一阶（order unity），并使用标度因子作为 $U$ 的值：\n$$\nU \\approx \\frac{G M_{m} R^2}{r^3}\n$$\n代入给定值：\n$$\nU \\approx \\frac{(6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}) \\times (7.342 \\times 10^{22}\\ \\mathrm{kg}) \\times (6.371 \\times 10^{6}\\ \\mathrm{m})^2}{(3.844 \\times 10^{8}\\ \\mathrm{m})^3}\n$$\n$$\nU \\approx \\frac{(4.8996 \\times 10^{12}) \\times (4.0590 \\times 10^{13})}{5.6812 \\times 10^{25}} \\ \\mathrm{m^2\\,s^{-2}}\n$$\n$$\nU \\approx \\frac{1.9889 \\times 10^{26}}{5.6812 \\times 10^{25}} \\ \\mathrm{m^2\\,s^{-2}} \\approx 3.5007\\ \\mathrm{m^2\\,s^{-2}}\n$$\n四舍五入至2位有效数字，$U \\approx 3.5\\ \\mathrm{m^2\\,s^{-2}}$。\n\n现在，我们计算相应的平衡潮 $\\eta_{eq} = U/g$：\n$$\n\\eta_{eq} \\approx \\frac{3.5007\\ \\mathrm{m^2\\,s^{-2}}}{9.81\\ \\mathrm{m\\,s^{-2}}} \\approx 0.35685\\ \\mathrm{m}\n$$\n四舍五入至2位有效数字，$\\eta_{eq} \\approx 0.36\\ \\mathrm{m}$。\n\n最终结果以一个二元行向量 $(U, \\eta_{eq})$ 的形式报告。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.5 & 0.36 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从全球理论转向区域建模，我们需要解决一个关键的实际问题：如何在模型的开放边界上施加潮汐强迫。虽然全球模型可以直接由引潮势驱动，但区域模型必须在边界上接收外部潮波。本练习将探讨如何设定动态一致的边界条件，确保潮波能正确地传入模型区域，同时避免产生虚假的数值反射 。",
            "id": "3926676",
            "problem": "考虑一个正压、垂向平均的区域海洋模型，该模型占据一个半无限域，其边界法向坐标为 $n \\geq 0$，并在 $n=0$ 处有一个开边界。设自由面高程为 $ \\eta(n,t) $，边界法向速度为 $ u(n,t) $，两者均表示小振幅运动，因此线性理论适用。假设深度 $ H > 0 $ 为常数，重力加速度 $ g > 0 $，底部摩擦可忽略不计，沿边界的压力梯度也可忽略不计，因此变化是一维的，仅发生在 $ n $ 方向。在这些假设下，控制性线性化浅水方程（也称为圣维南方程）可简化为\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial n}, \\qquad \\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial n} = 0.\n$$\n在开边界 $ n = 0 $ 处，模型给定了一个复数形式的自由面高程 $ \\eta_b(t) = A \\exp(i \\omega t) $，其中 $ A $ 是一个实数正振幅，$ \\omega > 0 $ 是给定的角频率。为避免人为反射并与控制方程保持动力学一致，假设边界强迫激发一个向域内（$ n > 0 $）传播的行进外部重力波。\n\n在上述假设下，推导在 $ n = 0 $ 处与给定 $ \\eta_b(t) $ 动力学一致的复数形式边界法向速度 $ u_b(t) $ 的闭式解析表达式。将最终答案表示为由 $ A $、$ \\omega $、$ g $ 和 $ H $ 构成的 $ u_b(t) $ 的单个符号表达式。无需进行数值计算或四舍五入。最终表达式中不提供单位。",
            "solution": "用户需要问题的详细解答。我将提供详细的逐步推导。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 域：一个半无限域，其边界法向坐标为 $n \\geq 0$。\n- 因变量：自由面高程 $\\eta(n,t)$ 和边界法向速度 $u(n,t)$。\n- 常数：重力加速度 $g > 0$ 和恒定深度 $H > 0$。\n- 控制方程（一维线性化浅水方程）：\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial n} \\quad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial n} = 0 \\quad (2)\n$$\n- 在开边界 $n=0$ 处的边界条件：\n$$\n\\eta_b(t) = \\eta(0, t) = A \\exp(i \\omega t)\n$$\n其中 $A$ 是一个实数正振幅，$\\omega > 0$ 是角频率。\n- 物理约束：解必须代表一个向域内（即正 $n$ 方向）传播且无反射的行进外部重力波。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题进行验证。\n- **科学依据**：该问题基于线性化浅水方程，这是地球物理流体动力学中用于模拟潮汐和海啸等长波的基本且成熟的方程。该设置是研究波传播和开边界条件的标准教科书案例。其前提具有科学合理性。\n- **适定性**：该问题提供了一组线性偏微分方程、一个在 $n=0$ 处的边界条件和一个辐射条件（波向域内传播，这意味着在 $n \\rightarrow \\infty$ 处有一个条件）。这足以确定一个唯一、稳定的解。\n- **客观性**：问题以精确的数学和物理术语陈述，没有歧义或主观性语言。所有参数都已明确定义。\n\n该问题不存在科学上不合理、不完整、矛盾或含糊不清等缺陷。这是一个适定的、波浪理论中的标准问题。\n\n### 步骤3：结论与行动\n问题被判定为有效。将推导完整解。\n\n### 解题推导\n目标是找到与给定的边界高程 $\\eta_b(t)$ 以及向外传播波的条件相一致的边界法向速度 $u_b(t) = u(0,t)$。\n\n鉴于边界上的时间谐波强迫，我们寻求以下形式的波状解：\n$$\n\\eta(n,t) = \\hat{\\eta}(n) \\exp(i \\omega t)\n$$\n$$\nu(n,t) = \\hat{u}(n) \\exp(i \\omega t)\n$$\n其中 $\\hat{\\eta}(n)$ 和 $\\hat{u}(n)$ 是作为空间坐标 $n$ 的函数的复振幅。将这些形式代入控制方程（1）和（2）：\n\n根据方程（1）：\n$$\n\\frac{\\partial}{\\partial t} \\left[ \\hat{u}(n) \\exp(i \\omega t) \\right] = -g \\frac{\\partial}{\\partial n} \\left[ \\hat{\\eta}(n) \\exp(i \\omega t) \\right]\n$$\n$$\ni \\omega \\hat{u}(n) \\exp(i \\omega t) = -g \\frac{d\\hat{\\eta}}{dn} \\exp(i \\omega t)\n$$\n$$\ni \\omega \\hat{u} = -g \\frac{d\\hat{\\eta}}{dn} \\quad (3)\n$$\n\n根据方程（2）：\n$$\n\\frac{\\partial}{\\partial t} \\left[ \\hat{\\eta}(n) \\exp(i \\omega t) \\right] + H \\frac{\\partial}{\\partial n} \\left[ \\hat{u}(n) \\exp(i \\omega t) \\right] = 0\n$$\n$$\ni \\omega \\hat{\\eta}(n) \\exp(i \\omega t) + H \\frac{d\\hat{u}}{dn} \\exp(i \\omega t) = 0\n$$\n$$\ni \\omega \\hat{\\eta} = -H \\frac{d\\hat{u}}{dn} \\quad (4)\n$$\n\n我们可以将这两个一阶常微分方程合并成一个二阶方程。对等式（3）关于 $n$ 求导：\n$$\ni \\omega \\frac{d\\hat{u}}{dn} = -g \\frac{d^2\\hat{\\eta}}{dn^2}\n$$\n从方程（4）中，我们可以将 $\\frac{d\\hat{u}}{dn}$ 表示为 $\\frac{d\\hat{u}}{dn} = -\\frac{i \\omega}{H} \\hat{\\eta}$。将其代入微分后的方程（3）：\n$$\ni \\omega \\left( -\\frac{i \\omega}{H} \\hat{\\eta} \\right) = -g \\frac{d^2\\hat{\\eta}}{dn^2}\n$$\n$$\n\\frac{\\omega^2}{H} \\hat{\\eta} = -g \\frac{d^2\\hat{\\eta}}{dn^2}\n$$\n$$\n\\frac{d^2\\hat{\\eta}}{dn^2} + \\frac{\\omega^2}{gH} \\hat{\\eta} = 0\n$$\n这是关于 $\\hat{\\eta}(n)$ 的亥姆霍兹方程。我们定义波数 $k$ 为一个正实数：\n$$\nk^2 = \\frac{\\omega^2}{gH} \\implies k = \\frac{\\omega}{\\sqrt{gH}}\n$$\n$\\hat{\\eta}(n)$ 的方程变为：\n$$\n\\frac{d^2\\hat{\\eta}}{dn^2} + k^2 \\hat{\\eta} = 0\n$$\n$\\hat{\\eta}(n)$ 的通解是：\n$$\n\\hat{\\eta}(n) = C_1 \\exp(-ikn) + C_2 \\exp(ikn)\n$$\n其中 $C_1$ 和 $C_2$ 是复常数。那么 $\\eta(n,t)$ 的完整解是：\n$$\n\\eta(n,t) = \\left[ C_1 \\exp(-ikn) + C_2 \\exp(ikn) \\right] \\exp(i \\omega t) = C_1 \\exp(i(\\omega t - kn)) + C_2 \\exp(i(\\omega t + kn))\n$$\n项 $C_1 \\exp(i(\\omega t - kn))$ 代表一个在正 $n$ 方向（向域内）传播的波，因为等相位面 $\\omega t - kn = \\text{const}$ 以速度 $\\frac{dn}{dt} = \\frac{\\omega}{k} > 0$ 移动。项 $C_2 \\exp(i(\\omega t + kn))$ 代表一个在负 $n$ 方向（向域外）传播的波。\n\n问题指出，波必须是“一个向域内传播的行进外部重力波”。这是一个辐射条件，意味着没有从无穷远处传入的波，即没有在负 $n$ 方向传播的波。因此，我们必须设 $C_2 = 0$。\n\n因此，物理上一致的自由面高程解为：\n$$\n\\eta(n,t) = C_1 \\exp(i(\\omega t - kn))\n$$\n现在，我们在 $n=0$ 处应用边界条件：$\\eta(0,t) = A \\exp(i \\omega t)$。\n$$\n\\eta(0,t) = C_1 \\exp(i(\\omega t - k \\cdot 0)) = C_1 \\exp(i \\omega t)\n$$\n将此与给定的边界条件进行比较，我们发现 $C_1 = A$。因此，域内各处的自由面高程为：\n$$\n\\eta(n,t) = A \\exp(i(\\omega t - kn))\n$$\n我们最后的任务是找到相应的速度 $u(n,t)$ 并在 $n=0$ 处求值。我们可以使用关系式（4），它关联了 $\\hat{u}$ 和 $\\hat{\\eta}$。从 $\\eta(n,t) = A \\exp(-ikn) \\exp(i\\omega t)$，我们有 $\\hat{\\eta}(n) = A \\exp(-ikn)$。代入方程（4）：\n$$\n\\frac{d\\hat{u}}{dn} = -\\frac{i \\omega}{H} \\hat{\\eta}(n) = -\\frac{i \\omega}{H} A \\exp(-ikn)\n$$\n对 $n$ 积分：\n$$\n\\hat{u}(n) = \\int -\\frac{i \\omega A}{H} \\exp(-ikn) dn = -\\frac{i \\omega A}{H} \\left( \\frac{1}{-ik} \\right) \\exp(-ikn) + C_3\n$$\n$$\n\\hat{u}(n) = \\frac{\\omega A}{Hk} \\exp(-ikn) + C_3\n$$\n积分常数 $C_3$ 对应于平均流，在一个由零均值振荡强迫的线性波问题中，假定平均流为零。因此，$C_3=0$。\n代入 $k = \\frac{\\omega}{\\sqrt{gH}}$:\n$$\n\\hat{u}(n) = \\frac{\\omega A}{H(\\omega/\\sqrt{gH})} \\exp(-ikn) = \\frac{\\sqrt{gH}}{H} A \\exp(-ikn) = A \\sqrt{\\frac{g}{H}} \\exp(-ikn)\n$$\n完整的随时变化的速度场是：\n$$\nu(n,t) = \\hat{u}(n) \\exp(i \\omega t) = A \\sqrt{\\frac{g}{H}} \\exp(-ikn) \\exp(i \\omega t) = A \\sqrt{\\frac{g}{H}} \\exp(i(\\omega t - kn))\n$$\n问题要求边界 $n=0$ 处的速度，即 $u_b(t) = u(0,t)$。设 $n=0$：\n$$\nu_b(t) = A \\sqrt{\\frac{g}{H}} \\exp(i(\\omega t - k \\cdot 0)) = A \\sqrt{\\frac{g}{H}} \\exp(i \\omega t)\n$$\n这就是在 $n=0$ 处，与规定的高程和辐射条件动力学一致的复数形式边界法向速度的闭式解析表达式。",
            "answer": "$$\n\\boxed{A \\sqrt{\\frac{g}{H}} \\exp(i \\omega t)}\n$$"
        },
        {
            "introduction": "为了进一步提升模型的真实性，我们将引入一种更为复杂和强大的技术：数据同化。开放边界条件往往是区域潮汐模型误差的主要来源，而利用海洋内部的观测数据是改进这些条件的有效途径。本练习将通过一个弱约束变分方法，展示如何找到最优的边界强迫，从而在拟合观测数据与保持动力学平滑性之间达到理想的平衡 。",
            "id": "3926677",
            "problem": "考虑一个海洋模型中的正压潮汐强迫，该模型具有由复谐波振幅指定的开放边界条件 (OBC)。假设在线性化浅水方程下，海洋内部对边界强迫做出线性响应。对于角频率为 $\\omega$、深度恒为 $h$ 的单个分潮，其相速为 $c = \\sqrt{g h}$（其中 $g$ 为重力加速度），波数为 $k = \\omega / c$。在由空间衰减率 $\\alpha$（单位为米分之一）建模的弱耗散条件下，从边界段 $j$ 到距离为 $d_{ij}$ 的内部观测点 $i$ 的贡献由格林函数 (GF) 核 $H_{ij} = \\exp\\left(-\\alpha d_{ij}\\right)\\exp\\left(\\mathrm{i} k d_{ij}\\right)$ 表示，其中 $\\mathrm{i} = \\sqrt{-1}$，角度以弧度为单位。将 $n$ 个边界段的复数开边界振幅表示为向量 $b \\in \\mathbb{C}^n$，将 $m$ 个内部复数观测值表示为 $y \\in \\mathbb{C}^m$。线性正演模型为 $\\hat{y} = H b$，其中 $H \\in \\mathbb{C}^{m \\times n}$ 由 GF 核定义。\n\n建立一个弱约束变分数据同化 (WC-VDA) 问题，该问题通过对边界增量施加惩罚来强制边界上的动力学一致性，同时最小化与内部观测值的失配。具体来说，定义代价函数\n$$\nJ(b) = \\left\\| W_o^{1/2} \\left( H b - y \\right) \\right\\|_2^2 + \\lambda \\left\\| D b \\right\\|_2^2,\n$$\n其中 $W_o = \\mathrm{diag}(w_{o,1}, \\ldots, w_{o,m})$ 且 $w_{o,i} = 1/\\sigma_{o,i}^2$ 表示观测方差的倒数，$\\lambda \\ge 0$ 是正则化强度，$D \\in \\mathbb{R}^{(n-1)\\times n}$ 是一阶差分算子，用于惩罚边界增量，使得 $(D b)_j = b_{j+1} - b_j$ 对于 $j = 1,\\ldots,n-1$ 成立。这是一个弱约束公式，因为该惩罚项允许但抑制沿 OBC 的动力学上不一致的空间变化。\n\n你的任务是，对于每个给定的测试用例，使用基于第一性原理的数值稳定算法，计算最小化子 $b^\\star$ 和最小化后的代价 $J(b^\\star)$。在一维海岸线坐标 $x$（以米为单位）上使用距离 $d_{ij} = |x_i - x_j|$，所有角度以弧度为单位，所有复振幅以米为单位。重力加速度为 $g = 9.81\\,\\mathrm{m/s^2}$。在每个测试用例中，模型深度 $h$ 是恒定的。\n\n使用的基本原理：\n- 线性化浅水动力学意味着对于角频率为 $\\omega$ 的谐波强迫，波相速为 $c = \\sqrt{g h}$，波数为 $k = \\omega / c$。\n- 内部对边界强迫的线性响应由上述 GF 核 $H_{ij}$ 的叠加表示。\n- 变分数据同化 (VDA) 准则是一个吉洪诺夫正则化最小二乘法，它结合了观测失配和对边界增量的二次惩罚。\n\n对于每个测试用例，根据所提供的参数组装 $H$、$W_o$ 和 $D$，计算 $b^\\star$，并评估 $J(b^\\star)$。由于使用了逆方差权重，最终代价表示为无量纲浮点数。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$[r_1,r_2,r_3]$）。\n\n使用以下具有科学合理参数的测试套件：\n\n- 测试用例 1（理想路径，半日潮 $\\mathrm{M2}$）：\n  - 深度 $h = 50$ 米。\n  - 角频率 $\\omega = \\dfrac{2\\pi}{12.42 \\times 3600}$ 弧度/秒。\n  - 耗散率 $\\alpha = 1 \\times 10^{-5}$ 米$^{-1}$。\n  - 边界段位置（米）：$x_b = [0, 10000, 20000, 30000, 40000]$。\n  - 内部观测点位置（米）：$x_i = [5000, 15000, 25000, 35000]$。\n  - 复数观测值 $y$ 由振幅-相位对 $(a_i, \\phi_i)$ 定义，其中 $y_i = a_i (\\cos \\phi_i + \\mathrm{i} \\sin \\phi_i)$：\n    - 振幅（米）：$a = [0.9, 0.7, 0.6, 0.5]$。\n    - 相位（弧度）：$\\phi = [0.2, 0.5, 0.9, 1.2]$。\n  - 观测标准差（米）：$\\sigma_o = [0.05, 0.05, 0.05, 0.05]$。\n  - 正则化强度：$\\lambda = 10$。\n\n- 测试用例 2（边界条件：零增量惩罚，$\\mathrm{S2}$）：\n  - 深度 $h = 50$ 米。\n  - 角频率 $\\omega = \\dfrac{2\\pi}{12 \\times 3600}$ 弧度/秒。\n  - 耗散率 $\\alpha = 5 \\times 10^{-6}$ 米$^{-1}$。\n  - 边界段位置（米）：$x_b = [0, 10000, 20000, 30000, 40000]$。\n  - 内部观测点位置（米）：$x_i = [5000, 15000, 25000, 35000]$。\n  - 复数观测值 $y$ 由 $(a_i, \\phi_i)$ 给出：\n    - 振幅（米）：$a = [0.7, 0.6, 0.5, 0.4]$。\n    - 相位（弧度）：$\\phi = [0.1, 0.4, 0.8, 1.1]$。\n  - 观测标准差（米）：$\\sigma_o = [0.05, 0.05, 0.05, 0.05]$。\n  - 正则化强度：$\\lambda = 0$。\n\n- 测试用例 3（秩亏观测与强平滑，全日潮 $\\mathrm{K1}$）：\n  - 深度 $h = 50$ 米。\n  - 角频率 $\\omega = \\dfrac{2\\pi}{23.9345 \\times 3600}$ 弧度/秒。\n  - 耗散率 $\\alpha = 2 \\times 10^{-5}$ 米$^{-1}$。\n  - 边界段位置（米）：$x_b = [0, 8000, 16000, 24000, 32000, 40000]$。\n  - 内部观测点位置（米）：$x_i = [10000, 30000]$。\n  - 复数观测值 $y$ 由 $(a_i, \\phi_i)$ 给出：\n    - 振幅（米）：$a = [0.3, 0.25]$。\n    - 相位（弧度）：$\\phi = [0.15, 0.5]$。\n  - 观测标准差（米）：$\\sigma_o = [0.03, 0.03]$。\n  - 正则化强度：$\\lambda = 1000$。\n\n算法要求：\n- 使用 $H_{ij} = \\exp\\left(-\\alpha d_{ij}\\right)\\exp\\left(\\mathrm{i} k d_{ij}\\right)$ 构建 $H$，其中 $d_{ij} = |x_i - x_j|$，$k = \\omega / \\sqrt{g h}$，$g = 9.81$。\n- 构建 $W_o^{1/2} = \\mathrm{diag}(1/\\sigma_{o,1}, \\ldots, 1/\\sigma_{o,m})$。\n- 通过求解 $b$ 的堆叠最小二乘 (LS) 系统来使用数值稳定的方法：\n  $$\n  \\min_{b \\in \\mathbb{C}^n} \\left\\| \\begin{bmatrix} W_o^{1/2} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} b - \\begin{bmatrix} W_o^{1/2} y \\\\ 0 \\end{bmatrix} \\right\\|_2^2,\n  $$\n  这等价于最小化 $J(b)$。\n- 为每个测试用例评估 $J(b^\\star)$，并在一行中输出三个最小化后的代价，以逗号分隔并用方括号括起来。\n\n所有距离必须以米为单位，所有角度以弧度为单位，所有复振幅以米为单位。将最终的最小化代价表示为无量纲浮点数。",
            "solution": "所提出的问题是一个适定的线性反问题，其框架是用于潮汐建模的弱约束变分数据同化 (WC-VDA)。该问题旨在确定一组开边界段的最佳复振幅 $b \\in \\mathbb{C}^n$，以最好地解释一组内部复观测值 $y \\in \\mathbb{C}^m$，同时保持边界上一定程度的空间平滑性。该问题是有效的，因为它在科学上基于浅水波动力学和数据同化原理，在数学上是明确定义的，并为获得唯一且稳定的解提供了所有必要参数。\n\n问题的核心是最小化吉洪诺夫正则化代价函数：\n$$\nJ(b) = \\left\\| W_o^{1/2} \\left( H b - y \\right) \\right\\|_2^2 + \\lambda \\left\\| D b \\right\\|_2^2\n$$\n该代价函数由两项组成。第一项 $\\left\\| W_o^{1/2} \\left( H b - y \\right) \\right\\|_2^2$ 衡量模型预测的观测值 $H b$ 与实际观测值 $y$ 之间的平方失配，并由观测误差协方差的逆进行加权。矩阵 $W_o^{1/2}$ 是一个对角矩阵，其对角线元素为 $1/\\sigma_{o,i}$，其中 $\\sigma_{o,i}$ 是观测值的标准差。该项确保解尊重观测数据。正演模型矩阵 $H \\in \\mathbb{C}^{m \\times n}$ 由格林函数核 $H_{ij} = \\exp(-\\alpha d_{ij})\\exp(\\mathrm{i} k d_{ij})$ 构建，该核描述了潮波从边界段 $j$ 到内部点 $i$ 的传播和耗散。波数 $k$ 由 $k = \\omega / c$ 给出，其中 $\\omega$ 是潮汐角频率，$c = \\sqrt{gh}$ 是在重力加速度 $g$ 作用下、深度恒为 $h$ 的水体中长波的相速。\n\n第二项 $\\lambda \\left\\| D b \\right\\|_2^2$ 是一个正则化项，它惩罚边界振幅解 $b$ 的粗糙性或不光滑性。矩阵 $D$ 是一阶差分算子，使得 $(D b)_j = b_{j+1} - b_j$。该项的值较大意味着相邻边界段之间存在大的、可能是非物理的变化。标量 $\\lambda \\ge 0$ 控制此惩罚的强度，平衡了拟合观测数据和在边界条件上强制平滑性之间的权衡。\n\n二次泛函 $J(b)$ 的最小化等价于求解一个标准的线性最小二乘 (LS) 问题。这是优化和反演理论中的一个基本原理。我们可以将代价函数重写为单个块结构或“堆叠”系统的 $L_2$ 范数的平方。让我们如下定义增广矩阵 $A$ 和增广向量 $z$：\n$$\nA = \\begin{bmatrix} W_o^{1/2} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} \\in \\mathbb{C}^{(m+n-1) \\times n}, \\quad z = \\begin{bmatrix} W_o^{1/2} y \\\\ 0 \\end{bmatrix} \\in \\mathbb{C}^{(m+n-1)}\n$$\n其中 $0$ 是一个大小为 $n-1$ 的零向量。根据这些定义，代价函数 $J(b)$ 可以表示为：\n$$\nJ(b) = \\left\\| \\begin{bmatrix} W_o^{1/2} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} b - \\begin{bmatrix} W_o^{1/2} y \\\\ 0 \\end{bmatrix} \\right\\|_2^2 = \\left\\| A b - z \\right\\|_2^2\n$$\n这种代数等价性成立，因为块向量的平方范数是其各块平方范数的总和。因此，问题转化为寻找向量 $b^\\star$，使得 $A b$ 和 $z$ 之间的欧几里得距离平方最小。\n\n这个线性最小二乘系统 $\\min_{b} \\| A b - z \\|_2^2$ 可以使用标准的数值算法稳健地求解，例如基于 QR 分解或奇异值分解 (SVD) 的算法。这些方法非常适合处理复值矩阵，并且即使在系统是欠定的或秩亏的情况下（例如，当边界段数 $n$ 超过观测数 $m$ 时，或当 $\\lambda=0$ 时），也具有数值稳定性。\n\n每个测试用例的步骤如下：\n1.  根据给定的物理参数（$h$, $\\omega$, $\\alpha$, $g$），计算导出的物理常数 $c = \\sqrt{gh}$ 和 $k = \\omega/c$。\n2.  使用提供的位置 $x_b$ 和 $x_i$ 计算距离 $d_{ij} = |x_i - x_j|$，从而构建复正演模型矩阵 $H \\in \\mathbb{C}^{m \\times n}$。\n3.  构建实数一阶差分矩阵 $D \\in \\mathbb{R}^{(n-1) \\times n}$。\n4.  根据给定的振幅和相位（$y_i = a_i e^{\\mathrm{i}\\phi_i}$）构建复观测向量 $y \\in \\mathbb{C}^m$。\n5.  根据观测标准差 $\\sigma_o$ 构建对角权重矩阵 $W_o^{1/2}$。\n6.  如上定义，组装增广矩阵 $A$ 和向量 $z$。\n7.  使用数值最小二乘求解器（例如 `numpy.linalg.lstsq`）找到最小化 $\\| A b - z \\|_2^2$ 的解 $b^\\star$。\n8.  求解器直接以残差平方和的形式提供最小化后的代价 $J(b^\\star)$，即 $\\| A b^\\star - z \\|_2^2$。该值是所需的输出。\n这种方法系统地将基于物理的变分问题转化为一个标准的计算线性代数问题，对此存在稳定且高效的解法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Weak-Constraint Variational Data Assimilation problem\n    for three test cases and prints the minimized cost for each.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    test_cases = [\n        {\n            \"h\": 50.0,\n            \"omega\": 2 * np.pi / (12.42 * 3600),\n            \"alpha\": 1e-5,\n            \"x_b\": np.array([0, 10000, 20000, 30000, 40000]),\n            \"x_i\": np.array([5000, 15000, 25000, 35000]),\n            \"y_amp\": np.array([0.9, 0.7, 0.6, 0.5]),\n            \"y_phase\": np.array([0.2, 0.5, 0.9, 1.2]),\n            \"sigma_o\": np.array([0.05, 0.05, 0.05, 0.05]),\n            \"lambda_reg\": 10.0\n        },\n        {\n            \"h\": 50.0,\n            \"omega\": 2 * np.pi / (12.00 * 3600),\n            \"alpha\": 5e-6,\n            \"x_b\": np.array([0, 10000, 20000, 30000, 40000]),\n            \"x_i\": np.array([5000, 15000, 25000, 35000]),\n            \"y_amp\": np.array([0.7, 0.6, 0.5, 0.4]),\n            \"y_phase\": np.array([0.1, 0.4, 0.8, 1.1]),\n            \"sigma_o\": np.array([0.05, 0.05, 0.05, 0.05]),\n            \"lambda_reg\": 0.0\n        },\n        {\n            \"h\": 50.0,\n            \"omega\": 2 * np.pi / (23.9345 * 3600),\n            \"alpha\": 2e-5,\n            \"x_b\": np.array([0, 8000, 16000, 24000, 32000, 40000]),\n            \"x_i\": np.array([10000, 30000]),\n            \"y_amp\": np.array([0.3, 0.25]),\n            \"y_phase\": np.array([0.15, 0.5]),\n            \"sigma_o\": np.array([0.03, 0.03]),\n            \"lambda_reg\": 1000.0\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current test case\n        h = case[\"h\"]\n        omega = case[\"omega\"]\n        alpha = case[\"alpha\"]\n        x_b = case[\"x_b\"]\n        x_i = case[\"x_i\"]\n        y_amp = case[\"y_amp\"]\n        y_phase = case[\"y_phase\"]\n        sigma_o = case[\"sigma_o\"]\n        lambda_reg = case[\"lambda_reg\"]\n\n        # Dimensions\n        n = len(x_b)  # Number of boundary segments\n        m = len(x_i)  # Number of interior observations\n\n        # 1. Calculate derived physical constants\n        c = np.sqrt(g * h)\n        k = omega / c\n\n        # 2. Construct the complex forward model matrix H\n        d_ij = np.abs(x_i[:, np.newaxis] - x_b[np.newaxis, :])\n        H = np.exp(-alpha * d_ij) * np.exp(1j * k * d_ij)\n\n        # 3. Construct the real first-order difference matrix D\n        D = (np.eye(n, k=1) - np.eye(n))[:-1, :]\n\n        # 4. Construct the complex observation vector y\n        y = y_amp * np.exp(1j * y_phase)\n\n        # 5. Construct the observation weights (1/sigma_o)\n        w_o_sqrt = 1.0 / sigma_o\n\n        # 6. Assemble the augmented matrix A and vector z\n        # Top block (observation misfit term)\n        A_top = w_o_sqrt[:, np.newaxis] * H\n        z_top = w_o_sqrt * y\n\n        # Bottom block (regularization term)\n        A_bottom = np.sqrt(lambda_reg) * D\n        z_bottom = np.zeros(n - 1, dtype=np.complex128)\n\n        # Stack the blocks\n        A = np.vstack([A_top, A_bottom])\n        z = np.concatenate([z_top, z_bottom])\n        \n        # 7. Solve the least-squares problem\n        # The 'residuals' output from lstsq is sum(|A*b - z|^2), which is exactly J(b*)\n        b_star, residuals, rank, s = np.linalg.lstsq(A, z, rcond=None)\n        \n        # 8. The minimized cost J(b*) is the residual\n        # For underdetermined systems with exact fit, residuals is an empty array.\n        # So we calculate the norm explicitly to be safe, though for this problem\n        # with noise and regularization, residuals will be populated.\n        if residuals.size == 0:\n            min_cost = 0.0\n        else:\n            min_cost = residuals[0]\n            \n        results.append(min_cost)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}