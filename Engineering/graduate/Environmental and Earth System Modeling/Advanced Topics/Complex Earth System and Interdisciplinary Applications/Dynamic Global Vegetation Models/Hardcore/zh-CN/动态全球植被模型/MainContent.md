## 引言
动态全球植被模型（Dynamic Global Vegetation Models, DGVMs）是现代地球系统科学的基石之一，它们是连接陆地生物圈与全球气候系统的核心计算工具。在全球变化日益加剧的背景下，准确预测陆地生态系统将如何响应气候变暖、大气$\mathrm{CO}_2$浓度升高和土地利用变化，并反过来影响这些变化，已成为一个至关重要的科学挑战。DGVMs正是为了应对这一知识鸿沟而生，它们试图通过第一性原理来模拟复杂的生态过程，从而提供超越经验关系的前瞻性预测能力。

本文旨在为读者提供一个关于DGVMs的全面而深入的理解。我们将从模型构建的底层逻辑出发，逐步揭示其复杂架构背后的科学思想。在“原理与机制”一章中，您将学习到模型如何基于物理守恒定律，构建起耦合的碳、水和能量平衡框架，并了解光合作用、呼吸、养分限制等关键生物地球化学过程是如何被数学化的。随后，在“应用与跨学科联系”一章中，我们将展示这些模型如何作为“虚拟实验室”，被应用于量化[生态系统服务](@entry_id:147516)、[解耦](@entry_id:160890)[气候反馈](@entry_id:1122448)、模拟古气候以及预测未来情景，突显其在连接生态学、[气象学](@entry_id:264031)和地球化学等多个学科中的桥梁作用。最后，“动手实践”部分将提供具体的编码练习，引导您亲手实现模型的关键模块，将理论知识转化为实践技能。通过这三章的学习，您将掌握DGVMs的核心概念，并能够批判性地理解和使用这些强大的科学工具。

## 原理与机制

动态全球植被模型（Dynamic Global Vegetation Models, DGVMs）作为[地球系统模型](@entry_id:1124096)（Earth System Models, ESMs）的关键陆地组成部分，其核心任务是预测陆地生态系统如何响应气候变化、大气$\mathrm{CO}_2$浓度以及[土地利用变化](@entry_id:1127057)，并反作用于气候系统。本章将深入探讨支撑这些模型运行的基本原理和核心机制。我们将从控制植被与环境相互作用的守恒定律出发，逐步解析碳、水和养分循环的关键过程，并阐明模型中用于表示植被多样性和动态演替的不同策略。

### 基本原理：守恒定律与耦合反馈

DGVMs的理论基石是物理学的基本守恒定律，即质量守恒和能量守恒。这些模型将每个网格单元的陆地表面视为一个控制体，精确追踪进入、离开和储存在其中的物质与能量。这种基于过程的预报方法，与依赖静态关系（如[气候包络](@entry_id:194317)）的传统[生物地理学](@entry_id:138434)模型有着本质区别 。一个功能完备的DGVM必须至少包含三个紧密耦合的预算：

1.  **[地表能量平衡](@entry_id:188274)**：地表接收的净辐射（$R_n$，即净短波与净长波辐射之和）必须被有效分配。其平衡方程为：
    $$
    R_n = H + LE + G
    $$
    其中，$H$是感热通量（加热大气的能量），$LE$是潜热通量（通过蒸散发将[水汽输送](@entry_id:1128087)至大气的能量），$G$是[地表热通量](@entry_id:1125826)（传入或传出土壤的能量）。植被的状态（如叶面积、冠层高度）通过改变[地表反照率](@entry_id:1132663)（$\alpha$）和空气动力学粗糙度（$z_0$），直接影响$R_n$和[湍流](@entry_id:151300)交换效率，从而调节$H$和$LE$的分配。

2.  **地表水分平衡**：网格单元的总水量变化由降水、[蒸散](@entry_id:180694)发、径流和深层渗漏共同决定。其[预报方程](@entry_id:1130221)可写为：
    $$
    \frac{dW}{dt} = P - E - T - R - D
    $$
    其中，$W$是土壤水储量，$P$是降水，$E$是蒸发（包括冠层截留蒸发和土壤蒸发），$T$是植被蒸腾，$R$是地表和地下径流，$D$是深层排水。植被通过根系吸水和气孔蒸腾（$T$）深刻影响水分平衡，而土壤水分可获得性反过来又制约植被的生理活动。

3.  **生态系统碳平衡**：生态系统总碳储量（$C_{\mathrm{tot}}$，包括植被、凋落物和土壤碳）的变化率等于碳输入与输出之差：
    $$
    \frac{d C_{\mathrm{tot}}}{dt} = \mathrm{GPP} - R_{\mathrm{a}} - R_{\mathrm{h}} - E_{\mathrm{dist}}
    $$
    其中，$\mathrm{GPP}$（Gross Primary Production）是总[初级生产力](@entry_id:151277)（光合作用固定的总碳量），$R_{\mathrm{a}}$是[自养呼吸](@entry_id:188060)（植物自身的呼吸消耗），$R_{\mathrm{h}}$是[异养](@entry_id:263592)呼吸（[微生物分解](@entry_id:177312)有机质的呼吸消耗），$E_{\mathrm{dist}}$是火灾等干扰事件导致的碳排放 。

这三个平衡方程通过植被的生理生态过程紧密地**耦合**在一起。例如，植物为吸收$\mathrm{CO}_2$进行光合作用（影响碳平衡）而打开气孔，同时会不可避免地通过[蒸腾作用](@entry_id:136237)失去水分（影响水平衡），这一过程消耗能量并以潜热形式影响能量平衡。[气孔导度](@entry_id:155938)（$g_s$）是连接这三大循环的核心变量。DGVMs的“动态”特性正在于此：植被状态（$\mathbf{x}$）的变化会改变地表物理属性（如$\alpha(\mathbf{x})$, $z_0(\mathbf{x})$, $g_s(\mathbf{x})$），进而调制返回大气的能量、水分和碳通量，实现**双向的[陆-气耦合](@entry_id:1127030)反馈**。这正是DGVMs能够作为预测工具整合进[地球系统模型](@entry_id:1124096)的根本原因 。

### 植被多样性的表达：从功能类型到连续性状

要在全球尺度上模拟植被，一个核心挑战是如何在保持计算可行性的同时，捕捉自然界中植物物种的巨大[功能多样性](@entry_id:148586)。DGVMs主要采用两种策略来解决这个问题：

#### 植物功能类型（Plant Functional Types, PFTs）

最经典和广泛使用的方法是将全球植物划分为有限数量的离散类别，即**植物功能类型（PFTs）**。例如，“热带阔叶常绿树”、“温带针叶落叶树”或“C4草本”等。每个PFT被赋予一套固定的参数（$\boldsymbol{\theta}_i$），这些参数定义了其生理（如光合参数）、物候（如落叶习性）和形态（如[分配比](@entry_id:183708)例、比叶面积）特征。模型通过求解一组常微分方程（ODEs）来预报每个PFT的碳、水储量（$C_i(t)$）。网格内的总植被碳量是所有PFT[碳库](@entry_id:200212)的总和，$C(t)=\sum_{i=1}^{N} C_i(t)$。PFTs之间通过竞争有限资源（如光、水和养分）来决定彼此的[相对丰度](@entry_id:754219)，从而模拟植被演替。这种方法将连续的[物种多样性](@entry_id:139929)简化为有限维度的离散类别，极大地提高了计算效率 。

#### 连续性状模型（Continuous Trait-based Models）

PFT方法的局限性在于其分类的刚性——PFT内部无变异，PFT之间有鸿沟。作为一种更先进的替代方案，**连续性状模型**应运而生。它不再使用离散的类别，而是用一个或多个连续的生理生态**性状**（Trait, $T$），如叶片氮含量或比叶面积，来描述植被。模型预报的不是PFT的碳储量，而是碳储量在性状空间上的密度分布$C(T, t)$。总碳量则通过对性状轴积分得到，$C(t)=\int C(T,t)\,dT$。模型的控制方程因此从[常微分方程](@entry_id:147024)（ODEs）变为更复杂的[偏微分](@entry_id:194612)方程（PDEs）或积分-[微分](@entry_id:158422)方程（IDEs）。这种方法允许植被群落的平均性状随环境变化而演化，能够更灵活地模拟植被对环境的适应策略，是当前DGVM发展的前沿方向 。

### [碳循环](@entry_id:141155)核心机制

[碳循环](@entry_id:141155)是DGVMs的核心，它描述了碳如何从大气进入植被，在生态系统内部转移，并最终回归大气的完整路径。

#### 碳的捕获：光合作用

生态系统碳循环的起点是**总[初级生产力](@entry_id:151277)（GPP）**，即植物通过光合作用固定的碳总量。现代DGVMs普遍采用基于生物化学机理的模型来计算GPP，其中最著名的是**[Farquhar模型](@entry_id:178429)**（适用于[C3植物](@entry_id:143969)）。该模型认为，净光合速率（$A$）由两个主要过程中的较慢者决定：

1.  **[Rubisco](@entry_id:145917)限制速率（$W_c$）**：当细胞间$\mathrm{CO}_2$浓度较低或[Rubisco](@entry_id:145917)[酶活性](@entry_id:143847)不足时，光合作用受到羧化反应本身能力的限制。
2.  **电子传递限制速率（$W_j$）**：当光照充足时，光合作用受到[光合电子传递链](@entry_id:178910)再生RuBP（$\mathrm{CO}_2$受体）能力的限制。

因此，净光合速率（扣除白天[线粒体呼吸](@entry_id:151925)$R_d$后）表示为：
$$
A = \min(W_c, W_j) - R_d
$$
其中，$W_c$ 和 $W_j$ 的表达式为：
$$
W_c = V_{c\max}\,\frac{C_i - \Gamma^*}{C_i + K_c\left(1 + \frac{O}{K_o}\right)} \quad\text{和}\quad W_j = \frac{J}{4}\,\frac{C_i - \Gamma^*}{C_i + 2\Gamma^*}
$$
这些方程包含了丰富的生物学细节，如最大羧化速率（$V_{c\max}$）、细胞间$\mathrm{CO}_2$浓度（$C_i$）、$\mathrm{CO}_2$补偿点（$\Gamma^*$）以及[电子传递速率](@entry_id:147994)（$J$）等。这使得模型能够机械地响应大气$\mathrm{CO}_2$浓度和温度的变化。与此相对，一些简化的模型采用**光能利用率（Light-Use Efficiency, LUE）**方法，即 $GPP \approx \epsilon \times I_{\mathrm{abs}}$，其中$\epsilon$是经验性的效率因子。LUE模型结构简单，但缺乏对$\mathrm{CO}_2$施肥效应和复杂环境响应的机理描述 。

#### 连接碳与水：[气孔导度](@entry_id:155938)

[气孔](@entry_id:145015)是植物叶片表面的微小孔隙，是$\mathrm{CO}_2$进入和水汽散失的主要通道。**[气孔导度](@entry_id:155938)（$g_s$）**的精确模拟对于耦合碳、水、能量循环至关重要。DGVMs中广泛使用两类模型：

1.  **[Ball-Berry模型](@entry_id:177016)**：这是一个经典的经验模型，它将[气孔导度](@entry_id:155938)与净光合速率（$A$）、叶片表面的相对湿度（$RH$）和$\mathrm{CO}_2$浓度（$C_s$）联系起来：
    $$
    g_s = g_0 + g_1 \frac{A \cdot RH}{C_s}
    $$
    其中$g_0$是残余导度，$g_1$是经验斜[率参数](@entry_id:265473) 。

2.  **[Medlyn模型](@entry_id:1127766)**：这是一个基于**最[优化理论](@entry_id:144639)**的模型。它假设植物会调节气孔开度，以在单位失水成本下最大化碳的收益。该理论推导出的模型形式为：
    $$
    g_s = g_0 + 1.6\left(1 + \frac{g_1}{\sqrt{D}}\right)\frac{A}{C_a}
    $$
    其中，$D$是大气水汽压亏缺，$C_a$是大气$\mathrm{CO}_2$浓度，常数$1.6$是水汽和$\mathrm{CO}_2$在空气中扩散系数的比值。这里的$g_1$参数具有更明确的生理意义，反映了植物的水分利用策略，即植物对水分成本的敏感度 。

#### 碳的分配与生长

光合作用产生的净初级生产力（NPP，即$GPP - R_a$）是可用于[植物生长](@entry_id:148428)的“建筑材料”。这些碳资源如何在不同的[植物器官](@entry_id:146399)（叶、茎、根）之间**分配**，决定了植物的形态和功能。为保证质量守恒，分配到各器官的碳比例（$f_{\mathrm{leaf}}, f_{\mathrm{stem}}, f_{\mathrm{root}}$）之和必须为1 。

-   **固定分配方案**：最简单的方法是为每个PFT设定固定的[分配比](@entry_id:183708)例。这种方法易于实现，但在描述植物对环境变化的[形态可塑性](@entry_id:893860)方面能力有限。

-   **动态最优化分配**：更先进的模型认为，植物的分配策略是动态变化的，遵循某种最优化原则。例如，当土壤干旱时，植物会倾向于将更多[碳分配](@entry_id:171908)给[根系](@entry_id:198970)以增强水分[吸收能力](@entry_id:918061)。这可以被形式化为一个[约束优化问题](@entry_id:1122941)：在每个时间步，模型选择一组[分配比](@entry_id:183708)例$\mathbf{f}$，以最大化一个[瞬时增长](@entry_id:263654)目标函数 $U(\mathbf{f}; \mathbf{x})$，其中$\mathbf{x}$代表当前环境条件。在最优状态下，分配到每个器官的边际收益是相等的。例如，在一个内部最优解（即所有器官都获得[碳分配](@entry_id:171908)）中，[一阶条件](@entry_id:140702)为 $\frac{\partial U}{\partial f_{\mathrm{leaf}}} = \frac{\partial U}{\partial f_{\mathrm{stem}}} = \frac{\partial U}{\partial f_{\mathrm{root}}}$。如果某个器官（如根）的边际收益低于其他器官，[优化算法](@entry_id:147840)会将其[分配比](@entry_id:183708)例降为零（$f_{\mathrm{root}}=0$），这在数学上由[Karush-Kuhn-Tucker](@entry_id:634966) (KKT)条件保证 。

#### 碳的损失：呼吸、周转与死亡

生态系统中的碳不会无限累积，而是通过呼吸、组织周转和死亡等过程返回环境。

首先，植物自身需要消耗能量来维持生命活动和合成新组织，这通过**[自养呼吸](@entry_id:188060)（$R_a$）**实现。$R_a$通常分为两个部分：
-   **维持呼吸（$R_m$）**：用于维持现有活体组织（如[蛋白质周转](@entry_id:181997)、维持[离子梯度](@entry_id:171010)）的能量成本。它的大小通常与活体生物量或组织氮含量成正比，并对温度高度敏感。
-   **生长呼吸（$R_g$）**：合成新组织过程中的碳消耗，相当于“建造成本”。它的大小通常与新产生的生物量（即生长速率）成正比 。

其次，当[植物组织](@entry_id:146272)（如叶片）老化或受损时，它们会脱落，形成**凋落物**。这一过程称为**周转（turnover）**。在模型中，这通常用一阶动力学来描述，即每个[碳库](@entry_id:200212)的损[失速](@entry_id:186882)率与其自身储量成正比。例如，对于叶、茎、根三个[碳库](@entry_id:200212)$C_i$，其动态方程可写为：
$$
\frac{dC_i}{dt} = f_i \cdot \mathrm{NPP} - \tau_i C_i
$$
其中 $f_i$ 是分配系数，$\tau_i$ 是周转速率（即存活时间的倒数）。在[稳态](@entry_id:139253)条件下（$dC_i/dt=0$），每个库的碳储量为 $C_i^* = (f_i \cdot \mathrm{NPP}) / \tau_i$。这个简单的关系揭示了一个重要原理：即使分配给某个器官的碳输入相对较少，只要其周转速率极低（即寿命很长），它依然可以积累巨大的碳储量。例如，在温带森林中，尽管分配给木质茎（$f_S=0.35$）的NPP（$N_0=0.7 \, \mathrm{kg\,C\,m^{-2}\,yr^{-1}}$）可能不如叶片多，但由于其极低的周转速率（$\tau_S=0.05 \, \mathrm{yr^{-1}}$，即20年寿命），其[稳态](@entry_id:139253)碳储量可达 $C_S^* = (0.35 \times 0.7) / 0.05 = 4.9 \, \mathrm{kg\,C\,m^{-2}}$，远高于寿命仅为半年的叶片（$\tau_L=2.0 \, \mathrm{yr^{-1}}$）的碳储量$C_L^* = (0.4 \times 0.7) / 2.0 = 0.14 \, \mathrm{kg\,C\,m^{-2}}$ 。

最后，凋落物和死亡的植物残体进入土壤，成为**[异养](@entry_id:263592)呼吸（$R_h$）**的底物。土壤微生物在分解这些有机质时释放$\mathrm{CO}_2$，完成碳循环的闭环 。

### 植被结构与演替

DGVMs不仅追踪碳储量的变化，还模拟植被[群落结构](@entry_id:153673)和组成的动态演替。这同样存在不同的建模策略。

-   **碳库模型（Canonical Pool Model）**：这是最常见的方法，将植被和土壤碳划分为一系列相互连接的碳库（如叶、茎、根、凋落物、不同分解阶段的[土壤有机质](@entry_id:186899)）。整个系统由一组描述碳在库间转移通量的[常微分方程](@entry_id:147024)（ODEs）控制，正如前述的周转模型所示。这种“集总参数”方法不追踪单个植物，而是模拟宏观的平均行为 。

-   **队列模型（Cohort Model）**：在模拟森林等结构复杂的生态系统时，一些先进的DGVMs采用基于队列或年龄/尺寸结构的方法。模型不再追踪一个PFT的总碳量，而是追踪由许多同龄或同尺寸的个体组成的“队列”。每个队列的生长、死亡和繁殖都根据其大小和年龄进行模拟。整个植被的状态由一个描述年龄或尺寸分布的[偏微分](@entry_id:194612)方程（PDEs），如McKendrick–von Foerster方程，来刻画。这种“分布式参数”方法能够更真实地模拟森林的自我疏伐、冠层分层和演替动态，但计算成本也更高 。

### [生物地球化学](@entry_id:152189)约束：养分限制

在长期尺度上，仅有适宜的水热条件和充足的$\mathrm{CO}_2$并不足以支持植被[无限生长](@entry_id:198278)。**养分的可获得性**，特别是氮（N）和磷（P），是制约全球陆地生态系统生产力的关键因素。

**[氮限制](@entry_id:1128726)**的原理基于植物[化学计量学](@entry_id:140916)：构建1单位的生物量需要固定比例的碳和氮（由$C:N$比 $r_{CN}$ 决定）。由气候和$\mathrm{CO}_2$决定的潜在生产力（$G_p$）会产生一个相应的氮需求 $D_N = G_p / r_{CN}$。如果植物从土壤中吸收的氮通量（$U_N$）小于这一需求，即 $U_N  D_N$，则植被生长就会受到氮的限制。

例如，若某生态系统的潜在NPP为 $G_p = 3.0 \, \mathrm{g\,C\,m^{-2}\,d^{-1}}$，植被的C:N比为 $r_{CN}=30$，则其氮需求为 $D_N = 3.0 / 30 = 0.1 \, \mathrm{g\,N\,m^{-2}\,d^{-1}}$。如果一个包含完整氮循环模块的DGVM计算出该生态系统当天的实际氮吸收量仅为 $U_N = 0.07 \, \mathrm{g\,N\,m^{-2}\,d^{-1}}$，那么由于$U_N  D_N$，实际的NPP必须被“下调”至由氮供应所能支持的最大值，即 $G_{real} = U_N \times r_{CN} = 0.07 \times 30 = 2.1 \, \mathrm{g\,C\,m^{-2}\,d^{-1}}$ 。

在DGVMs中，[氮限制](@entry_id:1128726)的实现方式主要有两种：
1.  **经验性下调因子**：简单模型通过一个经验性的[氮限制](@entry_id:1128726)因子（$f_N$，范围从0到1）直接乘以潜在生产力，如 $G_{real} = G_p \times f_N$。这种方法不追踪氮[循环过程](@entry_id:146195)，其参数$f_N$通常根据观测数据标定。
2.  **机理性碳氮耦合**：更复杂的模型包含一个完整的[氮循环](@entry_id:140589)模块，动态模拟土壤有机氮的矿化、硝化、植物吸收、[生物固氮](@entry_id:173532)、淋溶和气体损失等过程。模型根据土壤条件和植物需求，内生地计算出氮的可利用性和吸收量（$U_N$），并以此来动态约束碳循环。这种机理性的耦合对于准确预测生态系统对全球变化的长期响应至关重要  。

### 综合：一个完整DGVM的架构

综上所述，一个能够作为[地球系统模型](@entry_id:1124096)预测工具的DGVM，其最小化的过程集合必须能够闭合碳、水、能量和关键养分的预算，并能预报植被结构的长期动态。这套最小集合包括 ：

-   **地表[生物物理学](@entry_id:154938)**：求解能量平衡，计算[反照率](@entry_id:188373)、[感热和潜热通量](@entry_id:1131472)。
-   **水文学**：求解水分平衡，模拟冠层截留、蒸腾、土壤水动态和径流。
-   **[碳循环](@entry_id:141155)**：耦合[气孔导度](@entry_id:155938)的[光合作用模型](@entry_id:1129634)、[自养](@entry_id:262058)和[异养](@entry_id:263592)呼吸模型、[碳分配](@entry_id:171908)、组织周转和凋落物分解。
-   **植被动态**：包含物候（如叶面积的季节变化）、死亡、干扰（如火灾）以及PFTs之间的竞争，从而实现植被组成和结构的预报。
-   **生物地球化学**：至少包含一个闭合的氮循环，通过[化学计量](@entry_id:137450)约束来限制生产力和分解，以确保模型在百年尺度模拟中的[长期稳定性](@entry_id:146123)和真实性。

这些过程通过不同的时间步长进行耦合，利用了**尺度分离**的原理：快速的生物物理过程（如气孔响应、辐射传输）在小时或更短的时间步长上计算，而缓慢的生态和[生物地球化学](@entry_id:152189)过程（如生长、死亡、演替、土壤碳动态）则在天到年的时间步长上更新。正是这种多尺度、多过程的机理性集成，构成了现代DGVMs的复杂而强大的核心。