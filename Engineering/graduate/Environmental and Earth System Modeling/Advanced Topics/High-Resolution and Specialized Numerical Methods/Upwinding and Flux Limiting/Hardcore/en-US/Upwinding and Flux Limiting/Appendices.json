{
    "hands_on_practices": [
        {
            "introduction": "To improve numerical schemes, we must first diagnose their inherent flaws. This exercise guides you through deriving the modified equation for the simple first-order upwind scheme, a powerful diagnostic tool that reveals the scheme's true behavior. By doing so, you will uncover the source of its excessive numerical diffusion and analyze a crucial trade-off between stability and accuracy .",
            "id": "3929243",
            "problem": "An environmental tracer (for example, a passive pollutant concentration) is transported in a one-dimensional, uniformly flowing river reach of length $L$ with constant velocity $u0$. The governing equation for advection of the tracer is the linear advection equation, $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, where $\\phi(x,t)$ is the tracer concentration. Consider a uniform spatial grid with spacing $\\Delta x$ and a uniform time step $\\Delta t$, and an explicit donor-cell upwind spatial discretization combined with forward Euler time stepping. Let the Courant–Friedrichs–Lewy (CFL) number be $C \\equiv u\\,\\Delta t/\\Delta x$.\n\nUsing only the linear advection equation, Taylor expansions about $(x_i,t^n)$, and the definition of the CFL number, derive the leading-order modified equation that the discrete scheme approximates and identify the corresponding effective numerical viscosity $\\nu_{\\text{num}}$ multiplying $\\partial^2 \\phi/\\partial x^2$ to leading order. Then, reason how decreasing $\\Delta t$ at fixed $\\Delta x$ (and fixed $u$) affects $\\nu_{\\text{num}}$ and the trade-off between stability and diffusion in environmental tracer transport simulations. Assume $C \\leq 1$ to satisfy the monotonicity condition of the donor-cell upwind scheme.\n\nWhich option correctly captures the dependence of $\\nu_{\\text{num}}$ on $\\Delta t$ at fixed $\\Delta x$ and the associated stability–diffusion trade-off for this scheme, and qualitatively extends to flux-limited schemes used in practice for tracer transport?\n\nA. For the explicit donor-cell upwind scheme applied to $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, the leading-order effective numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u\\,\\Delta x}{2}\\,(1 - C)$, so reducing $\\Delta t$ (at fixed $\\Delta x$ and $u$) decreases $C$ and increases $\\nu_{\\text{num}}$. This enhances stability margin (since $C$ moves farther below the $C \\leq 1$ threshold) but increases numerical diffusion of the tracer; conversely, choosing $C \\to 1$ minimizes numerical diffusion and yields the least diffusive transport at the edge of the stability limit.\n\nB. For any consistent explicit scheme, $\\nu_{\\text{num}}$ necessarily decreases as $\\Delta t$ decreases, so smaller $\\Delta t$ reduces numerical diffusion while simultaneously improving stability for tracer transport.\n\nC. Total Variation Diminishing (TVD) flux limiters completely remove any dependence of the scheme’s diffusion on $\\Delta t$, so one can decrease $\\Delta t$ to improve stability with no change in $\\nu_{\\text{num}}$.\n\nD. In donor-cell upwind, reducing $\\Delta t$ at fixed $\\Delta x$ makes the scheme less stable because $\\nu_{\\text{num}}$ decreases toward zero, thereby amplifying oscillations; stability is recovered only by increasing $\\Delta t$ so that $C1$.",
            "solution": "The user has requested a rigorous validation and solution for a problem concerning the numerical analysis of the linear advection equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** A one-dimensional, uniformly flowing river reach.\n- **Governing Equation:** The linear advection equation, $\\dfrac{\\partial \\phi}{\\partial t} + u\\,\\dfrac{\\partial \\phi}{\\partial x} = 0$.\n- **Variables:**\n    - $\\phi(x,t)$: Tracer concentration.\n    - $u$: Constant flow velocity, $u0$.\n    - $L$: Length of the river reach.\n- **Numerical Scheme:**\n    - Spatial discretization: Explicit donor-cell upwind.\n    - Time stepping: Forward Euler.\n- **Grid Parameters:**\n    - $\\Delta x$: Uniform spatial grid spacing.\n    - $\\Delta t$: Uniform time step.\n- **Definition:** Courant–Friedrichs–Lewy (CFL) number, $C \\equiv u\\,\\Delta t/\\Delta x$.\n- **Constraint:** $C \\leq 1$.\n- **Task:**\n    1.  Derive the leading-order modified equation for the numerical scheme.\n    2.  Identify the effective numerical viscosity, $\\nu_{\\text{num}}$, which multiplies the $\\dfrac{\\partial^2 \\phi}{\\partial x^2}$ term.\n    3.  Analyze the effect on $\\nu_{\\text{num}}$ and the stability-diffusion trade-off when decreasing $\\Delta t$ at fixed $\\Delta x$ and $u$.\n    4.  Select the option that correctly describes this relationship and its qualitative extension to flux-limited schemes.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is fundamentally sound. The linear advection equation is a cornerstone of transport modeling. The forward-time, upwind-space (FTUS) or donor-cell scheme is a classic, first-order finite difference method. The derivation of the modified equation via Taylor series expansion is a standard and rigorous technique for analyzing the truncation error and effective behavior of a numerical scheme. The concept of numerical viscosity is a direct and well-established consequence of this analysis.\n- **Well-Posed:** The problem is well-posed. It asks for a specific mathematical derivation and a consequential analysis, for which a unique and correct result exists.\n- **Objective:** The problem statement is written in precise, objective, and technical language, free of any subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. It provides the governing equation, the numerical scheme, all necessary definitions (like the CFL number $C$), and the constraint ($u0$) required to uniquely define the upwind direction. The condition $C \\leq 1$ is correctly stated as the monotonicity (and von Neumann stability) condition for this scheme. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is a standard and well-posed problem in the field of computational fluid dynamics and numerical methods for partial differential equations. The solution process may proceed.\n\n### Derivation and Solution\n\nThe task is to derive the modified equation for the specified numerical scheme and analyze the resulting numerical viscosity.\n\n**1. Discretization of the Governing Equation**\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nWe discretize this equation on a grid where $\\phi_i^n \\approx \\phi(x_i, t^n)$.\n- The time derivative $\\dfrac{\\partial \\phi}{\\partial t}$ is approximated using the forward Euler scheme:\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{(x_i, t^n)} \\approx \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t}\n$$\n- Since the velocity $u0$, the flow is from left to right. The donor-cell (or first-order upwind) scheme for the spatial derivative $\\dfrac{\\partial \\phi}{\\partial x}$ uses the value from the \"upwind\" cell, which is at index $i-1$:\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{(x_i, t^n)} \\approx \\frac{\\phi_i^n - \\phi_{i-1}^n}{\\Delta x}\n$$\nSubstituting these approximations into the PDE gives the discrete equation:\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} + u \\frac{\\phi_i^n - \\phi_{i-1}^n}{\\Delta x} = 0\n$$\nRearranging to solve for the future time step $\\phi_i^{n+1}$:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{u \\Delta t}{\\Delta x} (\\phi_i^n - \\phi_{i-1}^n)\n$$\nUsing the definition of the CFL number, $C = u \\Delta t / \\Delta x$, the scheme is:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C (\\phi_i^n - \\phi_{i-1}^n)\n$$\n\n**2. Derivation of the Modified Equation**\n\nTo find the equation that the discrete scheme actually solves, we perform a Taylor series expansion of each term in the discrete equation around the point $(x_i, t^n)$. We denote partial derivatives with subscripts, e.g., $\\phi_t = \\dfrac{\\partial \\phi}{\\partial t}$, $\\phi_{xx} = \\dfrac{\\partial^2 \\phi}{\\partial x^2}$.\n\n- Taylor expansion of $\\phi_i^{n+1}$ in time:\n$$\n\\phi_i^{n+1} = \\phi(x_i, t^n + \\Delta t) = \\phi_i^n + \\Delta t \\, (\\phi_t)_i^n + \\frac{(\\Delta t)^2}{2} (\\phi_{tt})_i^n + O((\\Delta t)^3)\n$$\n- Taylor expansion of $\\phi_{i-1}^n$ in space:\n$$\n\\phi_{i-1}^n = \\phi(x_i - \\Delta x, t^n) = \\phi_i^n - \\Delta x \\, (\\phi_x)_i^n + \\frac{(\\Delta x)^2}{2} (\\phi_{xx})_i^n - \\frac{(\\Delta x)^3}{6} (\\phi_{xxx})_i^n + O((\\Delta x)^4)\n$$\nSubstitute these expansions into the discrete scheme $\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)$:\n$$\n\\phi_i^n + \\Delta t \\, \\phi_t + \\frac{(\\Delta t)^2}{2} \\phi_{tt} + \\dots = \\phi_i^n - C \\left( \\phi_i^n - \\left[ \\phi_i^n - \\Delta x \\, \\phi_x + \\frac{(\\Delta x)^2}{2} \\phi_{xx} - \\dots \\right] \\right)\n$$\nSimplifying the right-hand side:\n$$\n\\phi_i^n + \\Delta t \\, \\phi_t + \\frac{(\\Delta t)^2}{2} \\phi_{tt} + \\dots = \\phi_i^n - C \\left( \\Delta x \\, \\phi_x - \\frac{(\\Delta x)^2}{2} \\phi_{xx} + \\dots \\right)\n$$\nCancel $\\phi_i^n$ from both sides and divide the entire equation by $\\Delta t$:\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - \\frac{C \\Delta x}{\\Delta t} \\phi_x + \\frac{C (\\Delta x)^2}{2 \\Delta t} \\phi_{xx} - \\dots\n$$\nSubstitute $C = u \\Delta t / \\Delta x$:\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - u \\, \\phi_x + \\frac{(u \\Delta t / \\Delta x) (\\Delta x)^2}{2 \\Delta t} \\phi_{xx} - \\dots\n$$\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - u \\, \\phi_x + \\frac{u \\Delta x}{2} \\phi_{xx} - \\dots\n$$\nRearranging gives the truncation error:\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\phi_{xx} - \\frac{\\Delta t}{2} \\phi_{tt} + \\text{H.O.T.}\n$$\nThis is not yet the final form. The $\\phi_{tt}$ term must be expressed in terms of spatial derivatives. From the original PDE, $\\phi_t = -u \\phi_x$. Differentiating with respect to time gives $\\phi_{tt} = -u \\phi_{xt}$. Differentiating with respect to space gives $\\phi_{tx} = -u \\phi_{xx}$. Assuming sufficient smoothness such that $\\phi_{xt} = \\phi_{tx}$, we have $\\phi_{tt} = -u(-u \\phi_{xx}) = u^2 \\phi_{xx}$.\n\nSubstitute this into the rearranged equation:\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\phi_{xx} - \\frac{\\Delta t}{2} (u^2 \\phi_{xx}) + \\text{H.O.T.}\n$$\nFactor out the common terms:\n$$\n\\phi_t + u \\, \\phi_x = \\left(\\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2}\\right) \\phi_{xx} + \\text{H.O.T.}\n$$\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) \\phi_{xx} + \\text{H.O.T.}\n$$\nRecognizing $C = u \\Delta t / \\Delta x$, the leading-order modified equation is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = \\frac{u \\Delta x}{2} (1-C) \\frac{\\partial^2 \\phi}{\\partial x^2}\n$$\nThe right-hand side represents an artificial diffusion (or viscosity) term introduced by the discretization.\n\n**3. Analysis of Numerical Viscosity**\n\nFrom the modified equation, the effective numerical viscosity is:\n$$\n\\nu_{\\text{num}} = \\frac{u \\Delta x}{2} (1-C)\n$$\nNow, we analyze how $\\nu_{\\text{num}}$ changes when $\\Delta t$ is decreased while $u$ and $\\Delta x$ are held fixed.\n- The CFL number is $C = \\dfrac{u \\Delta t}{\\Delta x}$. If $u$ and $\\Delta x$ are fixed, $C$ is directly proportional to $\\Delta t$.\n- Therefore, decreasing $\\Delta t$ causes $C$ to decrease.\n- The numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u \\Delta x}{2} (1-C)$. Since $C \\leq 1$, the term $(1-C)$ is non-negative. As $C$ decreases (moves towards $0$), the term $(1-C)$ increases (moves towards $1$).\n- Consequently, decreasing $\\Delta t$ (at fixed $\\Delta x$) leads to an **increase** in $\\nu_{\\text{num}}$. The maximum numerical viscosity for this scheme occurs as $C \\to 0$, which is $\\nu_{\\text{num,max}} = \\dfrac{u \\Delta x}{2}$.\n- The minimum numerical viscosity occurs as $C \\to 1$, where $\\nu_{\\text{num}} \\to 0$.\n\n**Trade-off Analysis:**\n- **Stability:** The scheme is stable for $0 \\le C \\le 1$. When we decrease $\\Delta t$, $C$ decreases, moving further away from the stability boundary at $C=1$. This provides a larger stability margin.\n- **Diffusion (Accuracy):** When we decrease $\\Delta t$, $\\nu_{\\text{num}}$ increases. This means the scheme becomes more diffusive, smearing out the solution and reducing its accuracy. This is a first-order scheme, and the error term $\\nu_{\\text{num}} \\dfrac{\\partial^2 \\phi}{\\partial x^2}$ confirms this, as it is first order in $\\Delta x$ (unless $C=1$).\n- **Conclusion:** There is a trade-off. To minimize numerical diffusion and achieve the most accurate (least dissipative) result, one should choose $C$ as close to $1$ as possible. However, this runs the simulation at the edge of stability. Decreasing $\\Delta t$ improves the stability margin but at the cost of increased numerical diffusion.\n\n**Extension to Flux-Limited Schemes:**\nFlux-limited schemes blend a high-order scheme (e.g., Lax-Wendroff) with a low-order, non-oscillatory scheme (e.g., upwind) to be Total Variation Diminishing (TVD). While they significantly reduce numerical diffusion compared to the pure upwind scheme, they do not eliminate it entirely. The flux limiter function, which controls the blending, often depends on $C$. The residual numerical diffusion is typically minimized when $C$ is close to $1$. Thus, the qualitative principle that running at smaller $C$ values tends to be more diffusive than running near the stability limit of $C=1$ often still holds, even for these more advanced schemes.\n\n### Option-by-Option Analysis\n\n**A. For the explicit donor-cell upwind scheme applied to $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, the leading-order effective numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u\\,\\Delta x}{2}\\,(1 - C)$, so reducing $\\Delta t$ (at fixed $\\Delta x$ and $u$) decreases $C$ and increases $\\nu_{\\text{num}}$. This enhances stability margin (since $C$ moves farther below the $C \\leq 1$ threshold) but increases numerical diffusion of the tracer; conversely, choosing $C \\to 1$ minimizes numerical diffusion and yields the least diffusive transport at the edge of the stability limit.**\n- The formula for $\\nu_{\\text{num}}$ is correct.\n- The analysis that reducing $\\Delta t$ decreases $C$ and increases $\\nu_{\\text{num}}$ is correct.\n- The interpretation of the trade-off (enhanced stability margin for increased diffusion) is correct.\n- The statement that $C \\to 1$ minimizes diffusion is correct.\nThis option accurately describes all aspects of the derivation and analysis.\nVerdict: **Correct**.\n\n**B. For any consistent explicit scheme, $\\nu_{\\text{num}}$ necessarily decreases as $\\Delta t$ decreases, so smaller $\\Delta t$ reduces numerical diffusion while simultaneously improving stability for tracer transport.**\nThis claim is a false generalization. The analysis for the donor-cell upwind scheme proves the opposite: $\\nu_{\\text{num}}$ increases as $\\Delta t$ decreases (at fixed $\\Delta x$). Therefore, the premise of the statement is incorrect. While smaller $\\Delta t$ generally improves stability for explicit schemes, it does not universally reduce numerical diffusion for all schemes under all conditions.\nVerdict: **Incorrect**.\n\n**C. Total Variation Diminishing (TVD) flux limiters completely remove any dependence of the scheme’s diffusion on $\\Delta t$, so one can decrease $\\Delta t$ to improve stability with no change in $\\nu_{\\text{num}}$.**\nThis statement is too strong and factually incorrect. TVD schemes are designed to prevent oscillations while being more accurate (less diffusive) than first-order schemes, but they do not \"completely remove\" numerical diffusion, nor do they make it independent of the CFL number $C$ (and thus $\\Delta t$). The amount of dissipation in a TVD scheme is generally a function of $C$, and is often minimized for $C$ close to $1$.\nVerdict: **Incorrect**.\n\n**D. In donor-cell upwind, reducing $\\Delta t$ at fixed $\\Delta x$ makes the scheme less stable because $\\nu_{\\text{num}}$ decreases toward zero, thereby amplifying oscillations; stability is recovered only by increasing $\\Delta t$ so that $C1$.**\nThis statement contains multiple errors.\n1. \"reducing $\\Delta t$... makes the scheme less stable\": False. It makes it more stable by reducing $C$.\n2. \"because $\\nu_{\\text{num}}$ decreases toward zero\": False. $\\nu_{\\text{num}}$ increases as $\\Delta t$ decreases.\n3. \"thereby amplifying oscillations\": False. The scheme is non-oscillatory (monotonic) for $C \\le 1$. Increased diffusion damps, not amplifies.\n4. \"stability is recovered only by increasing $\\Delta t$ so that $C1$\": False. The scheme is unconditionally unstable for $C  1$.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Having identified numerical diffusion as a key problem in upwind schemes, we now explore a powerful solution: flux limiting. This practice provides a detailed, step-by-step walkthrough of a single flux-corrected transport (FCT) step. You will compute low- and high-order fluxes and determine the precise amount of anti-diffusive correction that can be safely applied to maintain accuracy without creating unrealistic oscillations .",
            "id": "3929290",
            "problem": "A one-dimensional, nonreactive tracer with concentration $c(x,t)$ is transported by a constant, uniform velocity $a0$ and governed by the linear advection equation $c_t + a c_x = 0$. Consider a uniform finite-volume partition with cell width $\\Delta x = 1$ and nondimensional velocity $a=1$. The time step is $\\Delta t = 0.6$, so the Courant number is $\\nu = a \\Delta t / \\Delta x = 0.6$. At time level $t^n$, the cell-averaged concentrations are\n- $c_{-1}^n = 0.8$,\n- $c_{0}^n = 1.0$,\n- $c_{1}^n = 0.0$,\n- $c_{2}^n = 0.0$,\nand other cells are not needed for this calculation.\n\nUsing a conservative finite-volume update, do the following for the single interface between cells $i=0$ and $i=1$ at $x_{1/2}$:\n- Starting from conservation of tracer mass in each control volume and the advection law $c_t + a c_x = 0$, derive the first-order upwind flux for $a0$ and use it to compute the low-order update $c_0^{L}$ and $c_1^{L}$ after one time step.\n- Starting from a second-order Taylor expansion in time and using $c_t = -a c_x$ and $c_{tt} = a^2 c_{xx}$ implied by the advection equation, derive the second-order Lax–Wendroff candidate high-order numerical flux at $x_{1/2}$ and evaluate it from the given data at time $t^n$.\n- Define the anti-diffusive flux $f^{AD}_{1/2}$ at $x_{1/2}$ as the difference between the candidate high-order flux and the low-order upwind flux evaluated at $t^n$. In a flux-corrected transport step, a limited fraction $\\phi_{1/2} \\in [0,1]$ of this anti-diffusive flux is added to the low-order update such that the updated concentrations in the two cells adjacent to the interface remain within the local physically admissible bounds determined by the extrema of their immediate neighbor values at time $t^n$. Use the sets $\\{c_{-1}^n, c_0^n, c_1^n\\}$ for cell $i=0$ and $\\{c_0^n, c_1^n, c_2^n\\}$ for cell $i=1$ to define the respective lower and upper bounds.\n- Determine the largest admissible limiter coefficient $\\phi_{1/2}$ that guarantees both $c_0^{n+1}$ and $c_1^{n+1}$ remain within their local bounds after adding the limited anti-diffusive flux to the low-order update.\n\nReport the limited anti-diffusive flux $\\phi_{1/2} f^{AD}_{1/2}$ at $x_{1/2}$ as a single nondimensional number. Round your answer to four significant figures.",
            "solution": "The problem requires the calculation of a limited anti-diffusive flux at a specific cell interface using the principles of flux-corrected transport (FCT). We will proceed by first determining the low-order and high-order fluxes, then calculating the anti-diffusive flux, and finally determining the limiter coefficient $\\phi_{1/2}$ needed to enforce monotonicity.\n\nThe governing equation is the linear advection equation:\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} = 0\n$$\nwith a constant velocity $a  0$. The data provided are: cell width $\\Delta x = 1$, velocity $a=1$, time step $\\Delta t = 0.6$. The Courant number is $\\nu = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\times 0.6}{1} = 0.6$. The cell-averaged concentrations at time $t^n$ around the interface $x_{1/2}$ (between cells $i=0$ and $i=1$) are $c_{-1}^n = 0.8$, $c_0^n = 1.0$, $c_1^n = 0.0$, and $c_2^n = 0.0$.\n\nA conservative finite-volume scheme updates the cell-averaged concentration $c_i$ according to:\n$$\nc_i^{n+1} = c_i^n - \\frac{\\Delta t}{\\Delta x} (f_{i+1/2} - f_{i-1/2})\n$$\nwhere $f_{i\\pm1/2}$ are the numerical fluxes at the cell interfaces.\n\n**Step 1: First-Order Upwind Flux and Low-Order Update**\n\nThe derivation of the upwind flux starts from the integral form of the conservation law over a control volume (cell) $i$:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) dx = -[F(x_{i+1/2},t) - F(x_{i-1/2},t)]\n$$\nwhere $F = ac$ is the physical flux. For a cell average $c_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) dx$, this becomes:\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\Delta x} [F_{i+1/2} - F_{i-1/2}]\n$$\nUsing a forward Euler time step and approximating the interface flux $F_{i+1/2}$ gives the finite-volume update rule. For the first-order upwind scheme with $a0$, the flux at an interface is determined by the state in the cell to the left (the \"upwind\" cell). Thus, the low-order flux $f^L$ at interface $x_{i+1/2}$ is:\n$$\nf^L_{i+1/2} = a c_i^n\n$$\nUsing this flux, we compute the low-order, one-step-updated concentrations, denoted $c_i^L$.\nFor cell $i=0$:\n$$\nc_0^L = c_0^n - \\frac{\\Delta t}{\\Delta x} (f^L_{1/2} - f^L_{-1/2}) = c_0^n - \\nu (c_0^n - c_{-1}^n)\n$$\nSubstituting the given values:\n$$\nc_0^L = 1.0 - 0.6 \\times (1.0 - 0.8) = 1.0 - 0.6 \\times 0.2 = 1.0 - 0.12 = 0.88\n$$\nFor cell $i=1$:\n$$\nc_1^L = c_1^n - \\frac{\\Delta t}{\\Delta x} (f^L_{3/2} - f^L_{1/2}) = c_1^n - \\nu (c_1^n - c_0^n)\n$$\nSubstituting the given values:\n$$\nc_1^L = 0.0 - 0.6 \\times (0.0 - 1.0) = 0.0 + 0.6 = 0.6\n$$\nSo, the low-order updates are $c_0^L = 0.88$ and $c_1^L = 0.6$.\n\n**Step 2: Second-Order Lax-Wendroff Flux**\n\nThe Lax-Wendroff scheme is derived from a second-order Taylor expansion in time:\n$$\nc(x, t+\\Delta t) = c(x, t) + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\mathcal{O}((\\Delta t)^3)\n$$\nUsing the advection equation, we substitute $c_t = -a c_x$ and $c_{tt} = \\frac{\\partial}{\\partial t}(-a c_x) = -a \\left(\\frac{\\partial c}{\\partial t}\\right)_x = -a(-a c_x)_x = a^2 c_{xx}$.\n$$\nc(x, t+\\Delta t) = c(x, t) - a \\Delta t c_x + \\frac{a^2 (\\Delta t)^2}{2} c_{xx}\n$$\nIntegrating over cell $i$ and dividing by $\\Delta x$ yields the update for the cell average $c_i$. This can be shown to be equivalent to a conservative form with the Lax-Wendroff flux $f^H_{i+1/2}$:\n$$\nf^H_{i+1/2} = a c_{i+1/2}^n - \\frac{a^2 \\Delta t}{2} (c_x)_{i+1/2}^n\n$$\nUsing standard central difference approximations for the interface value and its derivative:\n$c_{i+1/2}^n \\approx \\frac{c_i^n + c_{i+1}^n}{2}$ and $(c_x)_{i+1/2}^n \\approx \\frac{c_{i+1}^n - c_i^n}{\\Delta x}$.\nSubstituting these gives:\n$$\nf^H_{i+1/2} = a \\frac{c_i^n + c_{i+1}^n}{2} - \\frac{a^2 \\Delta t}{2} \\frac{c_{i+1}^n - c_i^n}{\\Delta x} = \\frac{a}{2} \\left[ (c_i^n + c_{i+1}^n) - \\nu(c_{i+1}^n - c_i^n) \\right]\n$$\n$$\nf^H_{i+1/2} = \\frac{a}{2} \\left[ (1+\\nu) c_i^n + (1-\\nu) c_{i+1}^n \\right]\n$$\nWe evaluate this high-order flux at the interface $x_{1/2}$ (i.e., for $i=0$):\n$$\nf^H_{1/2} = \\frac{a}{2} \\left[ (1+\\nu) c_0^n + (1-\\nu) c_1^n \\right]\n$$\nSubstituting the specific values $a=1$, $\\nu=0.6$, $c_0^n=1.0$, $c_1^n=0.0$:\n$$\nf^H_{1/2} = \\frac{1}{2} \\left[ (1+0.6)(1.0) + (1-0.6)(0.0) \\right] = \\frac{1}{2} [1.6 \\times 1.0 + 0.4 \\times 0.0] = \\frac{1.6}{2} = 0.8\n$$\n\n**Step 3: Anti-diffusive Flux**\n\nThe anti-diffusive flux is the difference between the high-order and low-order fluxes.\nFirst, we evaluate the low-order flux at $x_{1/2}$:\n$$\nf^L_{1/2} = a c_0^n = 1 \\times 1.0 = 1.0\n$$\nNow, the anti-diffusive flux $f^{AD}_{1/2}$ is:\n$$\nf^{AD}_{1/2} = f^H_{1/2} - f^L_{1/2} = 0.8 - 1.0 = -0.2\n$$\n\n**Step 4: Limiter Calculation**\n\nThe FCT update modifies the low-order solution by adding a limited portion of the anti-diffusive flux. The update focusing on the interface $x_{1/2}$ affects cells $i=0$ and $i=1$:\n$$\nc_0^{n+1} = c_0^L - \\phi_{1/2} \\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2}\n$$\n$$\nc_1^{n+1} = c_1^L + \\phi_{1/2} \\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2}\n$$\nwhere $\\phi_{1/2} \\in [0,1]$ is the limiter. Let's calculate the correction term: $\\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2} = \\frac{\\nu}{a} f^{AD}_{1/2} = \\frac{0.6}{1}(-0.2) = -0.12$.\nThe updates become:\n$$\nc_0^{n+1} = 0.88 - \\phi_{1/2}(-0.12) = 0.88 + 0.12 \\phi_{1/2}\n$$\n$$\nc_1^{n+1} = 0.6 + \\phi_{1/2}(-0.12) = 0.6 - 0.12 \\phi_{1/2}\n$$\nThe limiter $\\phi_{1/2}$ is chosen to ensure $c_0^{n+1}$ and $c_1^{n+1}$ remain within their local bounds.\nThe bounds for cell $i=0$ are from $\\{c_{-1}^n, c_0^n, c_1^n\\} = \\{0.8, 1.0, 0.0\\}$.\n$$\nc_{0, \\text{min}} = \\min(0.8, 1.0, 0.0) = 0.0 \\quad ; \\quad c_{0, \\text{max}} = \\max(0.8, 1.0, 0.0) = 1.0\n$$\nThe bounds for cell $i=1$ are from $\\{c_0^n, c_1^n, c_2^n\\} = \\{1.0, 0.0, 0.0\\}$.\n$$\nc_{1, \\text{min}} = \\min(1.0, 0.0, 0.0) = 0.0 \\quad ; \\quad c_{1, \\text{max}} = \\max(1.0, 0.0, 0.0) = 1.0\n$$\nNow we enforce the constraints on $c_0^{n+1}$ and $c_1^{n+1}$:\nFor cell $i=0$: $0.0 \\le 0.88 + 0.12 \\phi_{1/2} \\le 1.0$.\nThe lower bound $0.0 \\le 0.88 + 0.12 \\phi_{1/2}$ is always satisfied for $\\phi_{1/2} \\ge 0$.\nThe upper bound gives: $0.88 + 0.12 \\phi_{1/2} \\le 1.0 \\implies 0.12 \\phi_{1/2} \\le 0.12 \\implies \\phi_{1/2} \\le 1.0$.\n\nFor cell $i=1$: $0.0 \\le 0.6 - 0.12 \\phi_{1/2} \\le 1.0$.\nThe upper bound $0.6 - 0.12 \\phi_{1/2} \\le 1.0 \\implies -0.4 \\le 0.12 \\phi_{1/2}$ is always satisfied for $\\phi_{1/2} \\ge 0$.\nThe lower bound gives: $0.0 \\le 0.6 - 0.12 \\phi_{1/2} \\implies 0.12 \\phi_{1/2} \\le 0.6 \\implies \\phi_{1/2} \\le \\frac{0.6}{0.12} = 5.0$.\n\nTo satisfy all constraints simultaneously, including the definition $\\phi_{1/2} \\in [0,1]$, we need:\n$$\n\\phi_{1/2} \\le \\min(1.0, 1.0, 5.0) = 1.0\n$$\nThe largest admissible value for the limiter coefficient is $\\phi_{1/2} = 1.0$.\n\nFinally, we report the limited anti-diffusive flux, which is $\\phi_{1/2} f^{AD}_{1/2}$.\n$$\n\\phi_{1/2} f^{AD}_{1/2} = 1.0 \\times (-0.2) = -0.2\n$$\nRounding to four significant figures, the result is $-0.2000$.",
            "answer": "$$\\boxed{-0.2000}$$"
        },
        {
            "introduction": "The ultimate test of understanding is the ability to connect theory with empirical results. This comprehensive practice brings together the concepts of numerical diffusion and computational modeling. You will not only re-derive the theoretical rate of error growth but also write a program to simulate the process, measure the diffusion directly, and validate that your numerical experiment matches the theory .",
            "id": "3929286",
            "problem": "You are asked to connect first-order upwinding and flux limiting concepts to quantifiable error growth in a linear advection problem that is widely used in environmental and Earth system modeling for passive tracer transport. Consider the one-dimensional constant-coefficient linear advection equation $u_t + a u_x = 0$ with constant velocity $a  0$ posed on a periodic domain of length $L$. Let the initial tracer profile be a Gaussian pulse centered at $x_0$ with variance $\\sigma_0^2$.\n\nYour tasks are:\n\n1) Starting from the standard, explicit, first-order upwind-in-space, forward-Euler-in-time conservative discretization for $a  0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, derive the leading-order modified equation by Taylor expansion around the continuous solution. Identify the leading artificial diffusion term and its effective diffusion coefficient $\\kappa_{\\mathrm{num}}$ as a function of $a$, $\\Delta x$, and the Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\Delta t / \\Delta x$. Your derivation must start from the finite-volume or finite-difference conservative update and use Taylor series as the fundamental base.\n\n2) Using the well-known property of the heat equation that a Gaussian remains Gaussian under diffusion and that its variance grows linearly in time, deduce the predicted growth law for the variance $\\sigma^2(t)$ of the advected–diffused Gaussian in the presence of the artificial diffusion found in Part 1. Express the slope of the variance growth in terms of $\\kappa_{\\mathrm{num}}$ and connect it to the scaling with $\\Delta x$ and $\\Delta t$.\n\n3) Implement a program to numerically integrate the explicit upwind scheme for the linear advection equation on a periodic domain. Initialize with a Gaussian pulse $u(x,0) = \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma_0^2}\\right)$ and evolve until final time $T$. At each time step, compute the discrete mass $M = \\int u \\, dx$ (approximated by a Riemann sum), the discrete mean position $\\mu(t) = \\frac{1}{M}\\int x u(x,t)\\,dx$, and the discrete variance $\\sigma^2(t) = \\frac{1}{M}\\int (x-\\mu(t))^2 u(x,t)\\,dx$. Estimate the empirical slope of $\\sigma^2(t)$ versus $t$ by least-squares linear regression and convert it into an empirical diffusion coefficient $\\kappa_{\\mathrm{est}}$.\n\n4) Validate the scaling with $\\Delta x$ and $\\Delta t$ by comparing the empirical $\\kappa_{\\mathrm{est}}$ to the theoretical $\\kappa_{\\mathrm{num}}$ from your modified equation analysis. For the comparison metric, use the relative error $|\\kappa_{\\mathrm{est}}-\\kappa_{\\mathrm{num}}|/\\kappa_{\\mathrm{num}}$ when $\\kappa_{\\mathrm{num}}  0$; when $\\kappa_{\\mathrm{num}} = 0$ (boundary case), report the absolute value of $\\kappa_{\\mathrm{est}}$. All outputs must be dimensionless floats.\n\nUse the following physically and numerically consistent settings for all tests:\n- Domain length $L = 1$ with periodic boundary conditions and velocity $a = 1$.\n- Center $x_0 = L/4$ and initial standard deviation $\\sigma_0 = 0.04$.\n- Final time $T = 0.1$.\n- For each case, the spatial step is $\\Delta x = L/N_x$ and the time step is $\\Delta t = \\nu\\,\\Delta x/a$.\n\nYour program must run these test cases:\n- Case A (happy path): $N_x = 200$, $\\nu = 0.5$.\n- Case B (boundary condition): $N_x = 200$, $\\nu = 1.0$.\n- Case C (grid refinement): $N_x = 400$, $\\nu = 0.5$.\n- Case D (varying time step at fixed grid): $N_x = 200$, $\\nu = 0.2$.\n- Case E (coarser grid): $N_x = 100$, $\\nu = 0.5$.\n\nFor each case, compute the requested comparison metric as specified above.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r_A,r_B,r_C,r_D,r_E]\"), in the order of the cases A through E, where each $r_{\\cdot}$ is a float. No units should be printed and no additional text is allowed in the output line.",
            "solution": "The user-submitted problem is assessed to be valid. It is scientifically grounded in the principles of numerical analysis for partial differential equations, specifically concerning the one-dimensional linear advection equation. The problem is well-posed, with all necessary parameters, equations, and conditions clearly defined. It is objective and its tasks are quantifiable and verifiable. There are no contradictions, ambiguities, or pseudo-scientific claims. We may therefore proceed with a full solution.\n\nThe solution is presented in four parts, corresponding to the tasks outlined in the problem statement.\n\nPart 1: Derivation of the Modified Equation and Artificial Diffusion\n\nThe problem concerns the constant-coefficient linear advection equation,\n$$\nu_t + a u_x = 0\n$$\nwith a constant velocity $a  0$ on a periodic domain. We are to analyze the explicit first-order upwind-in-space, forward-Euler-in-time discretization. Given $a  0$, the \"upwind\" direction is from the left (from smaller $x$). Using a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, the finite-difference approximation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nwhere $u_j^n$ approximates the solution $u(x_j, t_n)$ at grid point $x_j = j \\Delta x$ and time $t_n = n \\Delta t$.\n\nRearranging for the time-stepping update, and introducing the Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\Delta t / \\Delta x$, we get:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n$$\nTo derive the modified equation, we perform a Taylor series expansion of each term in the scheme around the point $(x_j, t_n)$, assuming a smooth analytical solution $u(x, t)$ exists. The terms are expanded as follows:\n$$\nu_j^{n+1} = u(x_j, t_n + \\Delta t) = u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + O(\\Delta t^4)\n$$\n$$\nu_{j-1}^n = u(x_j - \\Delta x, t_n) = u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + O(\\Delta x^4)\n$$\nHere, $u$ and its derivatives ($u_t$, $u_x$, $u_{tt}$, etc.) are evaluated at $(x_j, t_n)$. Substituting these expansions into the rearranged numerical scheme:\n$$\n\\left(u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) = u - \\nu \\left(u - \\left(u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\dots \\right) \\right)\n$$\nSimplifying the right-hand side:\n$$\nu + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots = u - \\nu \\left(\\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right)\n$$\nSubtracting $u$ from both sides and dividing by $\\Delta t$:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^2) = -\\frac{\\nu}{\\Delta t} \\left(\\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + O(\\Delta x^3) \\right)\n$$\nUsing the definition $\\nu = a \\Delta t / \\Delta x$, we have $\\nu / \\Delta t = a / \\Delta x$. Substituting this into the right-hand side:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^2) = -\\frac{a}{\\Delta x} \\left(\\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + O(\\Delta x^3) \\right) = -a u_x + \\frac{a \\Delta x}{2} u_{xx} + O(\\Delta x^2)\n$$\nRearranging to match the form of the original PDE:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + O(\\Delta x^2, \\Delta t^2, \\Delta t \\Delta x)\n$$\nThis equation shows the truncation error of the scheme. To find the modified equation, we must express time derivatives in terms of spatial derivatives. From the original PDE, $u_t = -a u_x$. Differentiating with respect to time gives $u_{tt} = (-a u_x)_t = -a (u_t)_x = -a (-a u_x)_x = a^2 u_{xx}$. We only need to substitute up to the lowest order of the error terms.\nSubstituting $u_{tt} = a^2 u_{xx}$ into the truncation error:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\dots = \\left(\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\dots\n$$\nFactoring out $\\frac{a \\Delta x}{2}$:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) u_{xx} + \\dots = \\frac{a \\Delta x}{2} (1 - \\nu) u_{xx} + \\dots\n$$\nThe leading-order modified equation, which a numerical solution of the upwind scheme actually follows, is an advection-diffusion equation:\n$$\nu_t + a u_x = \\kappa_{\\mathrm{num}} u_{xx}\n$$\nThe leading artificial (or numerical) diffusion term is $\\kappa_{\\mathrm{num}} u_{xx}$, with the effective diffusion coefficient being:\n$$\n\\kappa_{\\mathrm{num}} = \\frac{a \\Delta x}{2} (1 - \\nu)\n$$\nThis coefficient is a function of $a$, $\\Delta x$, and $\\nu$, as required. It quantifies the principal source of error in the first-order upwind scheme, which manifests as a spurious damping of the solution.\n\nPart 2: Variance Growth Law\n\nThe modified equation is an advection-diffusion equation. The advection term, $a u_x$, is responsible for translating the profile at a constant speed $a$, while the diffusion term, $\\kappa_{\\mathrm{num}} u_{xx}$, is responsible for spreading the profile. The variance of a distribution is a measure of its spread around the mean. A pure translation does not change the shape of the profile relative to its mean, and thus does not affect the variance. The growth in variance is governed solely by the diffusion term.\n\nThe solution to the pure diffusion equation $u_t = \\kappa u_{xx}$ with an initial Gaussian profile $u(x,0) \\propto \\exp(-x^2 / (2\\sigma_0^2))$ is well-known to be a Gaussian profile whose variance grows linearly in time:\n$$\n\\sigma^2(t) = \\sigma_0^2 + 2 \\kappa t\n$$\nBy analogy, for the advection-diffusion equation with our numerical diffusion coefficient $\\kappa_{\\mathrm{num}}$, the variance of the advected-diffused Gaussian pulse is predicted to follow:\n$$\n\\sigma^2(t) = \\sigma_0^2 + 2 \\kappa_{\\mathrm{num}} t\n$$\nThis is a linear function of time $t$. The slope of the variance growth is given by:\n$$\n\\frac{d\\sigma^2(t)}{dt} = 2 \\kappa_{\\mathrm{num}} = 2 \\left( \\frac{a \\Delta x}{2} (1 - \\nu) \\right) = a \\Delta x (1 - \\nu)\n$$\nThis slope connects the observable growth in the numerical solution's variance directly to the parameters of the discretization ($a, \\Delta x, \\nu$). If one measures the slope of $\\sigma^2(t)$ vs. $t$ empirically from a simulation, say slope$_{\\mathrm{est}}$, one can estimate the effective diffusion coefficient as $\\kappa_{\\mathrm{est}} = \\text{slope}_{\\mathrm{est}} / 2$. This provides a direct path to numerically validating the theoretical derivation from Part 1.\n\nPart 3  4: Numerical Implementation and Validation\n\nWe implement the first-order upwind scheme to simulate the advection of the Gaussian pulse. For each test case, we will compute the evolution of the discrete variance, estimate the empirical diffusion coefficient $\\kappa_{\\mathrm{est}}$ from the slope of the variance-time plot, and compare it to the theoretical value $\\kappa_{\\mathrm{num}}$.\n\nThe discrete moments are calculated as follows. Let $u_j$ be the solution at grid point $x_j$. The discrete total mass $M_d$, mean $\\mu$, and variance $\\sigma^2$ are approximated by Riemann sums. Since $\\Delta x$ is constant, it cancels in the formulae for mean and variance:\n- Total mass (unnormalized): $M_u = \\sum_{j=0}^{N_x-1} u_j$\n- Mean: $\\mu(t) = \\frac{1}{M_u} \\sum_{j=0}^{N_x-1} x_j u_j$\n- Variance: $\\sigma^2(t) = \\frac{1}{M_u} \\sum_{j=0}^{N_x-1} (x_j - \\mu(t))^2 u_j$\n\nThe simulation is run until time $T=0.1$. The initial position is $x_0=0.25$ and advection speed is $a=1$, so the pulse will move to approximately $x=0.35$, well within the domain $[0,1]$ without encountering the periodic boundary. Thus, the simple formulae for mean and variance are adequate.\n\nAt the end of each simulation, a list of time points $t_n$ and corresponding variances $\\sigma^2(t_n)$ is obtained. A linear regression is performed on this data to find the slope. The empirical diffusion coefficient is $\\kappa_{\\mathrm{est}} = \\text{slope}/2$. This is then compared to the theoretical $\\kappa_{\\mathrm{num}} = a\\Delta x(1-\\nu)/2$. The comparison metric is the relative error $|\\kappa_{\\mathrm{est}}-\\kappa_{\\mathrm{num}}|/\\kappa_{\\mathrm{num}}$ for $\\kappa_{\\mathrm{num}}  0$, and the absolute value $|\\kappa_{\\mathrm{est}}|$ for the special case $\\kappa_{\\mathrm{num}} = 0$ (when $\\nu=1$).\n\nThe provided Python code implements this procedure for all specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the multi-part problem of analyzing artificial diffusion in the\n    first-order upwind scheme for the linear advection equation.\n    \"\"\"\n\n    # Simulation parameters\n    L = 1.0  # Domain length\n    a = 1.0  # Advection velocity\n    x0 = 0.25  # Initial pulse center\n    sigma0 = 0.04  # Initial pulse standard deviation\n    T = 0.1  # Final time\n\n    # Test cases: (Nx, nu)\n    test_cases = [\n        (200, 0.5),  # Case A\n        (200, 1.0),  # Case B\n        (400, 0.5),  # Case C\n        (200, 0.2),  # Case D\n        (100, 0.5),  # Case E\n    ]\n\n    results = []\n\n    for Nx, nu in test_cases:\n        # Discretization parameters\n        dx = L / Nx\n        dt = nu * dx / a\n        Nt = int(np.ceil(T / dt))\n\n        # Grid setup\n        x = np.linspace(0, L, Nx, endpoint=False)\n\n        # Initial condition\n        u = np.exp(-((x - x0) ** 2) / (2 * sigma0 ** 2))\n        \n        # Data storage for analysis\n        # We will store Nt+1 points, from t=0 to t=Nt*dt\n        times = np.zeros(Nt + 1)\n        variances = np.zeros(Nt + 1)\n\n        # Main time-stepping loop\n        for n in range(Nt + 1):\n            # Current time\n            current_t = n * dt\n            times[n] = current_t\n\n            # Calculate discrete moments\n            # The Riemann sum dx term cancels in mean and variance,\n            # so we can use unscaled sums.\n            mass_u = np.sum(u)\n            \n            # Check for decay to prevent division by zero\n            if mass_u  1e-15:\n                # If mass has decayed, variance is meaningless. Stop.\n                # Pad remaining variances with the last computed value.\n                variances[n:] = variances[n-1]\n                break\n\n            mean = np.sum(x * u) / mass_u\n            variance = np.sum(((x - mean) ** 2) * u) / mass_u\n            variances[n] = variance\n\n            # Update solution for the next time step (if not the last step)\n            if n  Nt:\n                u = u - nu * (u - np.roll(u, 1))\n\n        # Perform linear regression to find the slope of variance vs. time\n        # The slope of sigma^2 vs t is 2*kappa\n        slope, _, _, _, _ = linregress(times, variances)\n        \n        # Calculate empirical and theoretical diffusion coefficients\n        k_est = slope / 2.0\n        k_num = (a * dx / 2.0) * (1.0 - nu)\n        \n        # Calculate the comparison metric\n        if k_num  1e-15:  # Use a tolerance for floating point comparison\n            error = np.abs(k_est - k_num) / k_num\n        else:  # Case where k_num is theoretically zero (nu=1)\n            error = np.abs(k_est)\n            \n        results.append(error)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}