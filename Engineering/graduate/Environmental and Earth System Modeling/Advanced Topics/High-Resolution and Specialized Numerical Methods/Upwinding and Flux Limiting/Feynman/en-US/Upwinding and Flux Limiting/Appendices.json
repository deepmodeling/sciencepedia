{
    "hands_on_practices": [
        {
            "introduction": "A numerical scheme rarely solves the exact partial differential equation it was designed for. By using Taylor series expansions on the discretized terms, we can derive a \"modified equation\" which includes the leading-order error terms. This powerful analysis reveals the true behavior of the scheme, and in this exercise , you will uncover the hidden numerical diffusion inherent in the simple first-order upwind method, which manifests as an artificial viscosity term.",
            "id": "3929243",
            "problem": "An environmental tracer (for example, a passive pollutant concentration) is transported in a one-dimensional, uniformly flowing river reach of length $L$ with constant velocity $u0$. The governing equation for advection of the tracer is the linear advection equation, $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, where $\\phi(x,t)$ is the tracer concentration. Consider a uniform spatial grid with spacing $\\Delta x$ and a uniform time step $\\Delta t$, and an explicit donor-cell upwind spatial discretization combined with forward Euler time stepping. Let the Courant–Friedrichs–Lewy (CFL) number be $C \\equiv u\\,\\Delta t/\\Delta x$.\n\nUsing only the linear advection equation, Taylor expansions about $(x_i,t^n)$, and the definition of the CFL number, derive the leading-order modified equation that the discrete scheme approximates and identify the corresponding effective numerical viscosity $\\nu_{\\text{num}}$ multiplying $\\partial^2 \\phi/\\partial x^2$ to leading order. Then, reason how decreasing $\\Delta t$ at fixed $\\Delta x$ (and fixed $u$) affects $\\nu_{\\text{num}}$ and the trade-off between stability and diffusion in environmental tracer transport simulations. Assume $C \\leq 1$ to satisfy the monotonicity condition of the donor-cell upwind scheme.\n\nWhich option correctly captures the dependence of $\\nu_{\\text{num}}$ on $\\Delta t$ at fixed $\\Delta x$ and the associated stability–diffusion trade-off for this scheme, and qualitatively extends to flux-limited schemes used in practice for tracer transport?\n\nA. For the explicit donor-cell upwind scheme applied to $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, the leading-order effective numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u\\,\\Delta x}{2}\\,(1 - C)$, so reducing $\\Delta t$ (at fixed $\\Delta x$ and $u$) decreases $C$ and increases $\\nu_{\\text{num}}$. This enhances stability margin (since $C$ moves farther below the $C \\leq 1$ threshold) but increases numerical diffusion of the tracer; conversely, choosing $C \\to 1$ minimizes numerical diffusion and yields the least diffusive transport at the edge of the stability limit.\n\nB. For any consistent explicit scheme, $\\nu_{\\text{num}}$ necessarily decreases as $\\Delta t$ decreases, so smaller $\\Delta t$ reduces numerical diffusion while simultaneously improving stability for tracer transport.\n\nC. Total Variation Diminishing (TVD) flux limiters completely remove any dependence of the scheme’s diffusion on $\\Delta t$, so one can decrease $\\Delta t$ to improve stability with no change in $\\nu_{\\text{num}}$.\n\nD. In donor-cell upwind, reducing $\\Delta t$ at fixed $\\Delta x$ makes the scheme less stable because $\\nu_{\\text{num}}$ decreases toward zero, thereby amplifying oscillations; stability is recovered only by increasing $\\Delta t$ so that $C1$.",
            "solution": "The user has requested a rigorous validation and solution for a problem concerning the numerical analysis of the linear advection equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** A one-dimensional, uniformly flowing river reach.\n- **Governing Equation:** The linear advection equation, $\\dfrac{\\partial \\phi}{\\partial t} + u\\,\\dfrac{\\partial \\phi}{\\partial x} = 0$.\n- **Variables:**\n    - $\\phi(x,t)$: Tracer concentration.\n    - $u$: Constant flow velocity, $u0$.\n    - $L$: Length of the river reach.\n- **Numerical Scheme:**\n    - Spatial discretization: Explicit donor-cell upwind.\n    - Time stepping: Forward Euler.\n- **Grid Parameters:**\n    - $\\Delta x$: Uniform spatial grid spacing.\n    - $\\Delta t$: Uniform time step.\n- **Definition:** Courant–Friedrichs–Lewy (CFL) number, $C \\equiv u\\,\\Delta t/\\Delta x$.\n- **Constraint:** $C \\leq 1$.\n- **Task:**\n    1.  Derive the leading-order modified equation for the numerical scheme.\n    2.  Identify the effective numerical viscosity, $\\nu_{\\text{num}}$, which multiplies the $\\dfrac{\\partial^2 \\phi}{\\partial x^2}$ term.\n    3.  Analyze the effect on $\\nu_{\\text{num}}$ and the stability-diffusion trade-off when decreasing $\\Delta t$ at fixed $\\Delta x$ and $u$.\n    4.  Select the option that correctly describes this relationship and its qualitative extension to flux-limited schemes.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is fundamentally sound. The linear advection equation is a cornerstone of transport modeling. The forward-time, upwind-space (FTUS) or donor-cell scheme is a classic, first-order finite difference method. The derivation of the modified equation via Taylor series expansion is a standard and rigorous technique for analyzing the truncation error and effective behavior of a numerical scheme. The concept of numerical viscosity is a direct and well-established consequence of this analysis.\n- **Well-Posed:** The problem is well-posed. It asks for a specific mathematical derivation and a consequential analysis, for which a unique and correct result exists.\n- **Objective:** The problem statement is written in precise, objective, and technical language, free of any subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. It provides the governing equation, the numerical scheme, all necessary definitions (like the CFL number $C$), and the constraint ($u0$) required to uniquely define the upwind direction. The condition $C \\leq 1$ is correctly stated as the monotonicity (and von Neumann stability) condition for this scheme. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is a standard and well-posed problem in the field of computational fluid dynamics and numerical methods for partial differential equations. The solution process may proceed.\n\n### Derivation and Solution\n\nThe task is to derive the modified equation for the specified numerical scheme and analyze the resulting numerical viscosity.\n\n**1. Discretization of the Governing Equation**\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nWe discretize this equation on a grid where $\\phi_i^n \\approx \\phi(x_i, t^n)$.\n- The time derivative $\\dfrac{\\partial \\phi}{\\partial t}$ is approximated using the forward Euler scheme:\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{(x_i, t^n)} \\approx \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t}\n$$\n- Since the velocity $u0$, the flow is from left to right. The donor-cell (or first-order upwind) scheme for the spatial derivative $\\dfrac{\\partial \\phi}{\\partial x}$ uses the value from the \"upwind\" cell, which is at index $i-1$:\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{(x_i, t^n)} \\approx \\frac{\\phi_i^n - \\phi_{i-1}^n}{\\Delta x}\n$$\nSubstituting these approximations into the PDE gives the discrete equation:\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} + u \\frac{\\phi_i^n - \\phi_{i-1}^n}{\\Delta x} = 0\n$$\nRearranging to solve for the future time step $\\phi_i^{n+1}$:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{u \\Delta t}{\\Delta x} (\\phi_i^n - \\phi_{i-1}^n)\n$$\nUsing the definition of the CFL number, $C = u \\Delta t / \\Delta x$, the scheme is:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C (\\phi_i^n - \\phi_{i-1}^n)\n$$\n\n**2. Derivation of the Modified Equation**\n\nTo find the equation that the discrete scheme actually solves, we perform a Taylor series expansion of each term in the discrete equation around the point $(x_i, t^n)$. We denote partial derivatives with subscripts, e.g., $\\phi_t = \\dfrac{\\partial \\phi}{\\partial t}$, $\\phi_{xx} = \\dfrac{\\partial^2 \\phi}{\\partial x^2}$.\n\n- Taylor expansion of $\\phi_i^{n+1}$ in time:\n$$\n\\phi_i^{n+1} = \\phi(x_i, t^n + \\Delta t) = \\phi_i^n + \\Delta t \\, (\\phi_t)_i^n + \\frac{(\\Delta t)^2}{2} (\\phi_{tt})_i^n + O((\\Delta t)^3)\n$$\n- Taylor expansion of $\\phi_{i-1}^n$ in space:\n$$\n\\phi_{i-1}^n = \\phi(x_i - \\Delta x, t^n) = \\phi_i^n - \\Delta x \\, (\\phi_x)_i^n + \\frac{(\\Delta x)^2}{2} (\\phi_{xx})_i^n - \\frac{(\\Delta x)^3}{6} (\\phi_{xxx})_i^n + O((\\Delta x)^4)\n$$\nSubstitute these expansions into the discrete scheme $\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)$:\n$$\n\\phi_i^n + \\Delta t \\, \\phi_t + \\frac{(\\Delta t)^2}{2} \\phi_{tt} + \\dots = \\phi_i^n - C \\left( \\phi_i^n - \\left[ \\phi_i^n - \\Delta x \\, \\phi_x + \\frac{(\\Delta x)^2}{2} \\phi_{xx} - \\dots \\right] \\right)\n$$\nSimplifying the right-hand side:\n$$\n\\phi_i^n + \\Delta t \\, \\phi_t + \\frac{(\\Delta t)^2}{2} \\phi_{tt} + \\dots = \\phi_i^n - C \\left( \\Delta x \\, \\phi_x - \\frac{(\\Delta x)^2}{2} \\phi_{xx} + \\dots \\right)\n$$\nCancel $\\phi_i^n$ from both sides and divide the entire equation by $\\Delta t$:\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - \\frac{C \\Delta x}{\\Delta t} \\phi_x + \\frac{C (\\Delta x)^2}{2 \\Delta t} \\phi_{xx} - \\dots\n$$\nSubstitute $C = u \\Delta t / \\Delta x$:\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - u \\, \\phi_x + \\frac{(u \\Delta t / \\Delta x) (\\Delta x)^2}{2 \\Delta t} \\phi_{xx} - \\dots\n$$\n$$\n\\phi_t + \\frac{\\Delta t}{2} \\phi_{tt} + \\dots = - u \\, \\phi_x + \\frac{u \\Delta x}{2} \\phi_{xx} - \\dots\n$$\nRearranging gives the truncation error:\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\phi_{xx} - \\frac{\\Delta t}{2} \\phi_{tt} + \\text{H.O.T.}\n$$\nThis is not yet the final form. The $\\phi_{tt}$ term must be expressed in terms of spatial derivatives. From the original PDE, $\\phi_t = -u \\phi_x$. Differentiating with respect to time gives $\\phi_{tt} = -u \\phi_{xt}$. Differentiating with respect to space gives $\\phi_{tx} = -u \\phi_{xx}$. Assuming sufficient smoothness such that $\\phi_{xt} = \\phi_{tx}$, we have $\\phi_{tt} = -u(-u \\phi_{xx}) = u^2 \\phi_{xx}$.\n\nSubstitute this into the rearranged equation:\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\phi_{xx} - \\frac{\\Delta t}{2} (u^2 \\phi_{xx}) + \\text{H.O.T.}\n$$\nFactor out the common terms:\n$$\n\\phi_t + u \\, \\phi_x = \\left(\\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2}\\right) \\phi_{xx} + \\text{H.O.T.}\n$$\n$$\n\\phi_t + u \\, \\phi_x = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) \\phi_{xx} + \\text{H.O.T.}\n$$\nRecognizing $C = u \\Delta t / \\Delta x$, the leading-order modified equation is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} = \\frac{u \\Delta x}{2} (1-C) \\frac{\\partial^2 \\phi}{\\partial x^2}\n$$\nThe right-hand side represents an artificial diffusion (or viscosity) term introduced by the discretization.\n\n**3. Analysis of Numerical Viscosity**\n\nFrom the modified equation, the effective numerical viscosity is:\n$$\n\\nu_{\\text{num}} = \\frac{u \\Delta x}{2} (1-C)\n$$\nNow, we analyze how $\\nu_{\\text{num}}$ changes when $\\Delta t$ is decreased while $u$ and $\\Delta x$ are held fixed.\n- The CFL number is $C = \\dfrac{u \\Delta t}{\\Delta x}$. If $u$ and $\\Delta x$ are fixed, $C$ is directly proportional to $\\Delta t$.\n- Therefore, decreasing $\\Delta t$ causes $C$ to decrease.\n- The numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u \\Delta x}{2} (1-C)$. Since $C \\leq 1$, the term $(1-C)$ is non-negative. As $C$ decreases (moves towards $0$), the term $(1-C)$ increases (moves towards $1$).\n- Consequently, decreasing $\\Delta t$ (at fixed $\\Delta x$) leads to an **increase** in $\\nu_{\\text{num}}$. The maximum numerical viscosity for this scheme occurs as $C \\to 0$, which is $\\nu_{\\text{num,max}} = \\dfrac{u \\Delta x}{2}$.\n- The minimum numerical viscosity occurs as $C \\to 1$, where $\\nu_{\\text{num}} \\to 0$.\n\n**Trade-off Analysis:**\n- **Stability:** The scheme is stable for $0 \\le C \\le 1$. When we decrease $\\Delta t$, $C$ decreases, moving further away from the stability boundary at $C=1$. This provides a larger stability margin.\n- **Diffusion (Accuracy):** When we decrease $\\Delta t$, $\\nu_{\\text{num}}$ increases. This means the scheme becomes more diffusive, smearing out the solution and reducing its accuracy. This is a first-order scheme, and the error term $\\nu_{\\text{num}} \\dfrac{\\partial^2 \\phi}{\\partial x^2}$ confirms this, as it is first order in $\\Delta x$ (unless $C=1$).\n- **Conclusion:** There is a trade-off. To minimize numerical diffusion and achieve the most accurate (least dissipative) result, one should choose $C$ as close to $1$ as possible. However, this runs the simulation at the edge of stability. Decreasing $\\Delta t$ improves the stability margin but at the cost of increased numerical diffusion.\n\n**Extension to Flux-Limited Schemes:**\nFlux-limited schemes blend a high-order scheme (e.g., Lax-Wendroff) with a low-order, non-oscillatory scheme (e.g., upwind) to be Total Variation Diminishing (TVD). While they significantly reduce numerical diffusion compared to the pure upwind scheme, they do not eliminate it entirely. The flux limiter function, which controls the blending, often depends on $C$. The residual numerical diffusion is typically minimized when $C$ is close to $1$. Thus, the qualitative principle that running at smaller $C$ values tends to be more diffusive than running near the stability limit of $C=1$ often still holds, even for these more advanced schemes.\n\n### Option-by-Option Analysis\n\n**A. For the explicit donor-cell upwind scheme applied to $\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0$, the leading-order effective numerical viscosity is $\\nu_{\\text{num}} = \\dfrac{u\\,\\Delta x}{2}\\,(1 - C)$, so reducing $\\Delta t$ (at fixed $\\Delta x$ and $u$) decreases $C$ and increases $\\nu_{\\text{num}}$. This enhances stability margin (since $C$ moves farther below the $C \\leq 1$ threshold) but increases numerical diffusion of the tracer; conversely, choosing $C \\to 1$ minimizes numerical diffusion and yields the least diffusive transport at the edge of the stability limit.**\n- The formula for $\\nu_{\\text{num}}$ is correct.\n- The analysis that reducing $\\Delta t$ decreases $C$ and increases $\\nu_{\\text{num}}$ is correct.\n- The interpretation of the trade-off (enhanced stability margin for increased diffusion) is correct.\n- The statement that $C \\to 1$ minimizes diffusion is correct.\nThis option accurately describes all aspects of the derivation and analysis.\nVerdict: **Correct**.\n\n**B. For any consistent explicit scheme, $\\nu_{\\text{num}}$ necessarily decreases as $\\Delta t$ decreases, so smaller $\\Delta t$ reduces numerical diffusion while simultaneously improving stability for tracer transport.**\nThis claim is a false generalization. The analysis for the donor-cell upwind scheme proves the opposite: $\\nu_{\\text{num}}$ increases as $\\Delta t$ decreases (at fixed $\\Delta x$). Therefore, the premise of the statement is incorrect. While smaller $\\Delta t$ generally improves stability for explicit schemes, it does not universally reduce numerical diffusion for all schemes under all conditions.\nVerdict: **Incorrect**.\n\n**C. Total Variation Diminishing (TVD) flux limiters completely remove any dependence of the scheme’s diffusion on $\\Delta t$, so one can decrease $\\Delta t$ to improve stability with no change in $\\nu_{\\text{num}}$.**\nThis statement is too strong and factually incorrect. TVD schemes are designed to prevent oscillations while being more accurate (less diffusive) than first-order schemes, but they do not \"completely remove\" numerical diffusion, nor do they make it independent of the CFL number $C$ (and thus $\\Delta t$). The amount of dissipation in a TVD scheme is generally a function of $C$, and is often minimized for $C$ close to $1$.\nVerdict: **Incorrect**.\n\n**D. In donor-cell upwind, reducing $\\Delta t$ at fixed $\\Delta x$ makes the scheme less stable because $\\nu_{\\text{num}}$ decreases toward zero, thereby amplifying oscillations; stability is recovered only by increasing $\\Delta t$ so that $C1$.**\nThis statement contains multiple errors.\n1. \"reducing $\\Delta t$... makes the scheme less stable\": False. It makes it more stable by reducing $C$.\n2. \"because $\\nu_{\\text{num}}$ decreases toward zero\": False. $\\nu_{\\text{num}}$ increases as $\\Delta t$ decreases.\n3. \"thereby amplifying oscillations\": False. The scheme is non-oscillatory (monotonic) for $C \\le 1$. Increased diffusion damps, not amplifies.\n4. \"stability is recovered only by increasing $\\Delta t$ so that $C1$\": False. The scheme is unconditionally unstable for $C  1$.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Having established that the upwind scheme introduces numerical diffusion, it's crucial to quantify its cumulative effect. This practice  examines the evolution of a sharp discontinuity, or step function, which is a rigorous test for any advection scheme. You will analyze how this sharp front is progressively smeared by the scheme and derive an analytical expression for the \"smearing width\" after many time steps, connecting the discrete numerical process to a powerful probabilistic interpretation.",
            "id": "3929237",
            "problem": "Consider the one-dimensional linear advection equation for a passive tracer,\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\nwith constant advection speed $a0$. Let the domain be discretized on a uniform grid with cell centers at $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$, and define the Courant number $C = a\\,\\Delta t/\\Delta x$ satisfying $0C1$. Use the first-order upwind explicit scheme for $a0$,\n$$\nu_j^{n+1} = u_j^{n} - C\\left(u_j^n - u_{j-1}^n\\right) = (1-C)\\,u_j^n + C\\,u_{j-1}^n.\n$$\nAssume the step (Heaviside) initial condition $u(x,0) = H(x)$, and define its discrete counterpart by $u_j^0 = 1$ for $j\\ge 0$ and $u_j^0=0$ for $j0$. Let $H[j]$ denote the discrete Heaviside function $H[j]=1$ for $j\\ge 0$ and $H[j]=0$ for $j0$, and let $\\delta_{jk}$ denote the Kronecker delta $\\delta_{jk}=1$ if $j=k$ and $\\delta_{jk}=0$ otherwise.\n\n1) Starting from this base, compute $u_j^1$ for all $j\\in\\mathbb{Z}$ in closed form, written compactly using $H[j]$ and $\\delta_{jk}$.\n\n2) By iterating the scheme from the discrete initial condition, deduce the structure of $u_j^n$ and, by an asymptotic approximation valid for large $n$ grounded in the Central Limit Theorem (CLT), quantify the numerical smearing of the advected step after $n$ steps. Define the smearing width $W_{0.1\\mbox{--}0.9}(n)$ to be the physical distance between the two locations at time $t^n$ where the discrete solution attains the levels $u=0.9$ and $u=0.1$, respectively. Express $W_{0.1\\mbox{--}0.9}(n)$ as a single analytic expression in terms of $C$, $\\Delta x$, and $n$; you may leave any constants in terms of the inverse error function. Do not numerically evaluate any constants. The width has units of length consistent with $\\Delta x$, but your final expression should be symbolic.\n\nReport both answers in a single final line as a two-entry row, where the first entry is the compact expression for $u_j^1$ and the second entry is $W_{0.1\\mbox{--}0.9}(n)$.",
            "solution": "The user has provided a two-part problem concerning the first-order upwind scheme for the linear advection equation.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} = 0$, with constant advection speed $a0$.\n- **Numerical Scheme**: First-order explicit upwind scheme, given by $u_j^{n+1} = (1-C)\\,u_j^n + C\\,u_{j-1}^n$.\n- **Parameters**: The domain is a uniform grid with cell centers $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$. The Courant number is $C = a\\,\\Delta t/\\Delta x$, and it satisfies $0C1$.\n- **Initial Condition**: Discrete step function, $u_j^0 = 1$ for $j\\ge 0$ and $u_j^0=0$ for $j0$.\n- **Notation**: The discrete Heaviside function is $H[j]$ ($1$ for $j\\ge 0$, $0$ otherwise), and the Kronecker delta is $\\delta_{jk}$.\n- **Task 1**: Compute $u_j^1$ for all integers $j$ in a compact closed form using $H[j]$ and $\\delta_{jk}$.\n- **Task 2**: For large $n$, use an asymptotic approximation based on the Central Limit Theorem to find the smearing width $W_{0.1\\mbox{--}0.9}(n)$, defined as the physical distance between the points where the solution is $0.9$ and $0.1$. The expression should be in terms of $C$, $\\Delta x$, and $n$, with constants expressed using the inverse error function.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with a standard numerical method (first-order upwind) for a fundamental PDE (linear advection). The analysis of its numerical diffusion via a probabilistic interpretation and the Central Limit Theorem is a classic, well-established technique in numerical analysis. The problem is well-posed, with all necessary conditions and parameters defined. The stability condition $0C1$ is appropriately specified. The problem statement is objective and uses precise mathematical language. It is free of any of the invalidating flaws listed in the instructions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Part 1: Calculation of $u_j^1$\nThe first-order upwind scheme is given as:\n$$\nu_j^{n+1} = (1-C)\\,u_j^n + C\\,u_{j-1}^n\n$$\nTo find the solution at the first time step, $n=1$, we set $n=0$ in the scheme:\n$$\nu_j^1 = (1-C)\\,u_j^0 + C\\,u_{j-1}^0\n$$\nThe initial condition is the discrete Heaviside function, $u_j^0 = H[j]$. Substituting this into the equation for $u_j^1$:\n$$\nu_j^1 = (1-C)\\,H[j] + C\\,H[j-1]\n$$\nWe analyze this expression for different integer values of $j$:\n1.  For $j  0$: $j-1 \\ge 0$. In this case, $H[j] = 1$ and $H[j-1] = 1$.\n    $u_j^1 = (1-C)(1) + C(1) = 1 - C + C = 1$.\n2.  For $j = 0$: $H[0] = 1$ and $H[0-1] = H[-1] = 0$.\n    $u_0^1 = (1-C)(1) + C(0) = 1 - C$.\n3.  For $j  0$: $j-1  0$. In this case, $H[j] = 0$ and $H[j-1] = 0$.\n    $u_j^1 = (1-C)(0) + C(0) = 0$.\n\nWe seek a compact expression for $u_j^1$ using $H[j]$ and $\\delta_{jk}$. Let us test the form $H[j] - C\\delta_{j0}$:\n- For $j  0$: $H[j] - C\\delta_{j0} = 1 - C(0) = 1$. This matches.\n- For $j = 0$: $H[0] - C\\delta_{00} = 1 - C(1) = 1-C$. This matches.\n- For $j  0$: $H[j] - C\\delta_{j0} = 0 - C(0) = 0$. This matches.\nThus, the expression is correct for all $j \\in \\mathbb{Z}$.\n\n### Part 2: Asymptotic Smearing Width $W_{0.1\\mbox{--}0.9}(n)$\nThe solution at time step $n$ can be found by repeated application of the scheme. This reveals a structure related to the binomial expansion. The solution $u_j^n$ is a linear combination of the initial data points $u_{j-k}^0$ for $k \\in \\{0, 1, ..., n\\}$:\n$$\nu_j^n = \\sum_{k=0}^{n} \\binom{n}{k} C^k (1-C)^{n-k} u_{j-k}^0\n$$\nSubstituting the initial condition $u_j^0 = H[j]$, the term $u_{j-k}^0$ is $1$ if $j-k \\ge 0$ (i.e., $k \\le j$) and $0$ otherwise. The sum becomes:\n$$\nu_j^n = \\sum_{k=0}^{j} \\binom{n}{k} C^k (1-C)^{n-k} \\quad (\\text{for } 0 \\le j \\le n)\n$$\nThis expression is the cumulative distribution function (CDF) for a binomial distribution $B(n,C)$. If $K$ is a random variable representing the number of successes in $n$ trials with success probability $C$, then $u_j^n = P(K \\le j)$.\n\nFor large $n$, the Central Limit Theorem (CLT) states that the binomial distribution $B(n,C)$ can be approximated by a normal distribution $N(\\mu, \\sigma^2)$ with mean $\\mu = nC$ and variance $\\sigma^2 = nC(1-C)$. The CDF of this normal distribution is given by\n$$\nF(x; \\mu, \\sigma) = \\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right)\n$$\nwhere $\\Phi(z)$ is the CDF of the standard normal distribution $N(0,1)$. Thus, for large $n$, we can approximate the discrete solution $u_j^n$ as:\n$$\nu_j^n \\approx \\Phi\\left(\\frac{j - nC}{\\sqrt{nC(1-C)}}\\right)\n$$\nWe need to find the smearing width $W_{0.1\\mbox{--}0.9}(n)$, which is the physical distance $x_{0.9} - x_{0.1}$ corresponding to the grid indices $j_{0.9}$ and $j_{0.1}$ where the solution profile reaches the values $0.9$ and $0.1$.\nLet $z_p = \\Phi^{-1}(p)$ be the value for which the standard normal CDF is $p$.\nFor $u_j^n = 0.9$:\n$$\n\\frac{j_{0.9} - nC}{\\sqrt{nC(1-C)}} = \\Phi^{-1}(0.9) \\implies j_{0.9} = nC + \\Phi^{-1}(0.9)\\sqrt{nC(1-C)}\n$$\nFor $u_j^n = 0.1$:\n$$\n\\frac{j_{0.1} - nC}{\\sqrt{nC(1-C)}} = \\Phi^{-1}(0.1) \\implies j_{0.1} = nC + \\Phi^{-1}(0.1)\\sqrt{nC(1-C)}\n$$\nThe difference in grid indices is $\\Delta j = j_{0.9} - j_{0.1}$. Using the symmetry property $\\Phi^{-1}(p) = -\\Phi^{-1}(1-p)$, we have $\\Phi^{-1}(0.1) = -\\Phi^{-1}(0.9)$.\n$$\n\\Delta j = \\left(\\Phi^{-1}(0.9) - \\Phi^{-1}(0.1)\\right)\\sqrt{nC(1-C)} = 2\\Phi^{-1}(0.9)\\sqrt{nC(1-C)}\n$$\nThe physical width is $W_{0.1\\mbox{--}0.9}(n) = \\Delta j \\cdot \\Delta x$:\n$$\nW_{0.1\\mbox{--}0.9}(n) = 2\\Phi^{-1}(0.9)\\sqrt{nC(1-C)} \\Delta x\n$$\nThe problem requires the answer in terms of the inverse error function, which we denote as $\\operatorname{erfinv}$. The relation between $\\Phi(z)$ and the error function $\\operatorname{erf}(z)$ is:\n$$\n\\Phi(z) = \\frac{1}{2}\\left(1 + \\operatorname{erf}\\left(\\frac{z}{\\sqrt{2}}\\right)\\right)\n$$\nTo find the inverse, we solve for $z$ given a probability $p = \\Phi(z)$:\n$$\n2p - 1 = \\operatorname{erf}\\left(\\frac{z}{\\sqrt{2}}\\right) \\implies \\frac{z}{\\sqrt{2}} = \\operatorname{erfinv}(2p-1) \\implies z = \\sqrt{2}\\,\\operatorname{erfinv}(2p-1)\n$$\nSo, $\\Phi^{-1}(p) = \\sqrt{2}\\,\\operatorname{erfinv}(2p-1)$. For $p=0.9$:\n$$\n\\Phi^{-1}(0.9) = \\sqrt{2}\\,\\operatorname{erfinv}(2(0.9)-1) = \\sqrt{2}\\,\\operatorname{erfinv}(0.8)\n$$\nSubstituting this into the expression for the width:\n$$\nW_{0.1\\mbox{--}0.9}(n) = 2\\left(\\sqrt{2}\\,\\operatorname{erfinv}(0.8)\\right)\\sqrt{nC(1-C)} \\Delta x\n$$\n$$\nW_{0.1\\mbox{--}0.9}(n) = 2\\sqrt{2}\\,\\operatorname{erfinv}(0.8)\\sqrt{nC(1-C)} \\Delta x\n$$\nThis is the final analytical expression for the smearing width.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} H[j] - C\\delta_{j0}  2\\sqrt{2}\\operatorname{erfinv}(0.8)\\sqrt{nC(1-C)}\\Delta x \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The challenge in numerical advection is to achieve high accuracy without introducing non-physical oscillations. Flux-limiting methods offer an elegant solution by blending a stable, low-order scheme with a more accurate, high-order one. This hands-on calculation  will guide you through the core steps of a flux-corrected transport algorithm, where you will compute low- and high-order fluxes and determine the correct \"limiter\" to apply a non-oscillatory correction.",
            "id": "3929290",
            "problem": "A one-dimensional, nonreactive tracer with concentration $c(x,t)$ is transported by a constant, uniform velocity $a0$ and governed by the linear advection equation $c_t + a c_x = 0$. Consider a uniform finite-volume partition with cell width $\\Delta x = 1$ and nondimensional velocity $a=1$. The time step is $\\Delta t = 0.6$, so the Courant number is $\\nu = a \\Delta t / \\Delta x = 0.6$. At time level $t^n$, the cell-averaged concentrations are\n- $c_{-1}^n = 0.8$,\n- $c_{0}^n = 1.0$,\n- $c_{1}^n = 0.0$,\n- $c_{2}^n = 0.0$,\nand other cells are not needed for this calculation.\n\nUsing a conservative finite-volume update, do the following for the single interface between cells $i=0$ and $i=1$ at $x_{1/2}$:\n- Starting from conservation of tracer mass in each control volume and the advection law $c_t + a c_x = 0$, derive the first-order upwind flux for $a0$ and use it to compute the low-order update $c_0^{L}$ and $c_1^{L}$ after one time step.\n- Starting from a second-order Taylor expansion in time and using $c_t = -a c_x$ and $c_{tt} = a^2 c_{xx}$ implied by the advection equation, derive the second-order Lax–Wendroff candidate high-order numerical flux at $x_{1/2}$ and evaluate it from the given data at time $t^n$.\n- Define the anti-diffusive flux $f^{AD}_{1/2}$ at $x_{1/2}$ as the difference between the candidate high-order flux and the low-order upwind flux evaluated at $t^n$. In a flux-corrected transport step, a limited fraction $\\phi_{1/2} \\in [0,1]$ of this anti-diffusive flux is added to the low-order update such that the updated concentrations in the two cells adjacent to the interface remain within the local physically admissible bounds determined by the extrema of their immediate neighbor values at time $t^n$. Use the sets $\\{c_{-1}^n, c_0^n, c_1^n\\}$ for cell $i=0$ and $\\{c_0^n, c_1^n, c_2^n\\}$ for cell $i=1$ to define the respective lower and upper bounds.\n- Determine the largest admissible limiter coefficient $\\phi_{1/2}$ that guarantees both $c_0^{n+1}$ and $c_1^{n+1}$ remain within their local bounds after adding the limited anti-diffusive flux to the low-order update.\n\nReport the limited anti-diffusive flux $\\phi_{1/2} f^{AD}_{1/2}$ at $x_{1/2}$ as a single nondimensional number. Round your answer to four significant figures.",
            "solution": "The problem requires the calculation of a limited anti-diffusive flux at a specific cell interface using the principles of flux-corrected transport (FCT). We will proceed by first determining the low-order and high-order fluxes, then calculating the anti-diffusive flux, and finally determining the limiter coefficient $\\phi_{1/2}$ needed to enforce monotonicity.\n\nThe governing equation is the linear advection equation:\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} = 0\n$$\nwith a constant velocity $a  0$. The data provided are: cell width $\\Delta x = 1$, velocity $a=1$, time step $\\Delta t = 0.6$. The Courant number is $\\nu = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\times 0.6}{1} = 0.6$. The cell-averaged concentrations at time $t^n$ around the interface $x_{1/2}$ (between cells $i=0$ and $i=1$) are $c_{-1}^n = 0.8$, $c_0^n = 1.0$, $c_1^n = 0.0$, and $c_2^n = 0.0$.\n\nA conservative finite-volume scheme updates the cell-averaged concentration $c_i$ according to:\n$$\nc_i^{n+1} = c_i^n - \\frac{\\Delta t}{\\Delta x} (f_{i+1/2} - f_{i-1/2})\n$$\nwhere $f_{i\\pm1/2}$ are the numerical fluxes at the cell interfaces.\n\n**Step 1: First-Order Upwind Flux and Low-Order Update**\n\nThe derivation of the upwind flux starts from the integral form of the conservation law over a control volume (cell) $i$:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) dx = -[F(x_{i+1/2},t) - F(x_{i-1/2},t)]\n$$\nwhere $F = ac$ is the physical flux. For a cell average $c_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) dx$, this becomes:\n$$\n\\frac{d c_i}{dt} = -\\frac{1}{\\Delta x} [F_{i+1/2} - F_{i-1/2}]\n$$\nUsing a forward Euler time step and approximating the interface flux $F_{i+1/2}$ gives the finite-volume update rule. For the first-order upwind scheme with $a0$, the flux at an interface is determined by the state in the cell to the left (the \"upwind\" cell). Thus, the low-order flux $f^L$ at interface $x_{i+1/2}$ is:\n$$\nf^L_{i+1/2} = a c_i^n\n$$\nUsing this flux, we compute the low-order, one-step-updated concentrations, denoted $c_i^L$.\nFor cell $i=0$:\n$$\nc_0^L = c_0^n - \\frac{\\Delta t}{\\Delta x} (f^L_{1/2} - f^L_{-1/2}) = c_0^n - \\nu (c_0^n - c_{-1}^n)\n$$\nSubstituting the given values:\n$$\nc_0^L = 1.0 - 0.6 \\times (1.0 - 0.8) = 1.0 - 0.6 \\times 0.2 = 1.0 - 0.12 = 0.88\n$$\nFor cell $i=1$:\n$$\nc_1^L = c_1^n - \\frac{\\Delta t}{\\Delta x} (f^L_{3/2} - f^L_{1/2}) = c_1^n - \\nu (c_1^n - c_0^n)\n$$\nSubstituting the given values:\n$$\nc_1^L = 0.0 - 0.6 \\times (0.0 - 1.0) = 0.0 + 0.6 = 0.6\n$$\nSo, the low-order updates are $c_0^L = 0.88$ and $c_1^L = 0.6$.\n\n**Step 2: Second-Order Lax-Wendroff Flux**\n\nThe Lax-Wendroff scheme is derived from a second-order Taylor expansion in time:\n$$\nc(x, t+\\Delta t) = c(x, t) + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\mathcal{O}((\\Delta t)^3)\n$$\nUsing the advection equation, we substitute $c_t = -a c_x$ and $c_{tt} = \\frac{\\partial}{\\partial t}(-a c_x) = -a (\\frac{\\partial c}{\\partial t})_x = -a(-a c_x)_x = a^2 c_{xx}$.\n$$\nc(x, t+\\Delta t) = c(x, t) - a \\Delta t c_x + \\frac{a^2 (\\Delta t)^2}{2} c_{xx}\n$$\nIntegrating over cell $i$ and dividing by $\\Delta x$ yields the update for the cell average $c_i$. This can be shown to be equivalent to a conservative form with the Lax-Wendroff flux $f^H_{i+1/2}$:\n$$\nf^H_{i+1/2} = a c_{i+1/2}^n - \\frac{a^2 \\Delta t}{2} (c_x)_{i+1/2}^n\n$$\nUsing standard central difference approximations for the interface value and its derivative:\n$c_{i+1/2}^n \\approx \\frac{c_i^n + c_{i+1}^n}{2}$ and $(c_x)_{i+1/2}^n \\approx \\frac{c_{i+1}^n - c_i^n}{\\Delta x}$.\nSubstituting these gives:\n$$\nf^H_{i+1/2} = a \\frac{c_i^n + c_{i+1}^n}{2} - \\frac{a^2 \\Delta t}{2} \\frac{c_{i+1}^n - c_i^n}{\\Delta x} = \\frac{a}{2} \\left[ (c_i^n + c_{i+1}^n) - \\nu(c_{i+1}^n - c_i^n) \\right]\n$$\n$$\nf^H_{i+1/2} = \\frac{a}{2} \\left[ (1+\\nu) c_i^n + (1-\\nu) c_{i+1}^n \\right]\n$$\nWe evaluate this high-order flux at the interface $x_{1/2}$ (i.e., for $i=0$):\n$$\nf^H_{1/2} = \\frac{a}{2} \\left[ (1+\\nu) c_0^n + (1-\\nu) c_1^n \\right]\n$$\nSubstituting the specific values $a=1$, $\\nu=0.6$, $c_0^n=1.0$, $c_1^n=0.0$:\n$$\nf^H_{1/2} = \\frac{1}{2} \\left[ (1+0.6)(1.0) + (1-0.6)(0.0) \\right] = \\frac{1}{2} [1.6 \\times 1.0 + 0.4 \\times 0.0] = \\frac{1.6}{2} = 0.8\n$$\n\n**Step 3: Anti-diffusive Flux**\n\nThe anti-diffusive flux is the difference between the high-order and low-order fluxes.\nFirst, we evaluate the low-order flux at $x_{1/2}$:\n$$\nf^L_{1/2} = a c_0^n = 1 \\times 1.0 = 1.0\n$$\nNow, the anti-diffusive flux $f^{AD}_{1/2}$ is:\n$$\nf^{AD}_{1/2} = f^H_{1/2} - f^L_{1/2} = 0.8 - 1.0 = -0.2\n$$\n\n**Step 4: Limiter Calculation**\n\nThe FCT update modifies the low-order solution by adding a limited portion of the anti-diffusive flux. The update focusing on the interface $x_{1/2}$ affects cells $i=0$ and $i=1$:\n$$\nc_0^{n+1} = c_0^L - \\phi_{1/2} \\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2}\n$$\n$$\nc_1^{n+1} = c_1^L + \\phi_{1/2} \\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2}\n$$\nwhere $\\phi_{1/2} \\in [0,1]$ is the limiter. Let's calculate the correction term: $\\frac{\\Delta t}{\\Delta x} f^{AD}_{1/2} = \\frac{\\nu}{a} f^{AD}_{1/2} = \\frac{0.6}{1}(-0.2) = -0.12$.\nThe updates become:\n$$\nc_0^{n+1} = 0.88 - \\phi_{1/2}(-0.12) = 0.88 + 0.12 \\phi_{1/2}\n$$\n$$\nc_1^{n+1} = 0.6 + \\phi_{1/2}(-0.12) = 0.6 - 0.12 \\phi_{1/2}\n$$\nThe limiter $\\phi_{1/2}$ is chosen to ensure $c_0^{n+1}$ and $c_1^{n+1}$ remain within their local bounds.\nThe bounds for cell $i=0$ are from $\\{c_{-1}^n, c_0^n, c_1^n\\} = \\{0.8, 1.0, 0.0\\}$.\n$$\nc_{0, \\text{min}} = \\min(0.8, 1.0, 0.0) = 0.0 \\quad ; \\quad c_{0, \\text{max}} = \\max(0.8, 1.0, 0.0) = 1.0\n$$\nThe bounds for cell $i=1$ are from $\\{c_0^n, c_1^n, c_2^n\\} = \\{1.0, 0.0, 0.0\\}$.\n$$\nc_{1, \\text{min}} = \\min(1.0, 0.0, 0.0) = 0.0 \\quad ; \\quad c_{1, \\text{max}} = \\max(1.0, 0.0, 0.0) = 1.0\n$$\nNow we enforce the constraints on $c_0^{n+1}$ and $c_1^{n+1}$:\nFor cell $i=0$: $0.0 \\le 0.88 + 0.12 \\phi_{1/2} \\le 1.0$.\nThe lower bound $0.0 \\le 0.88 + 0.12 \\phi_{1/2}$ is always satisfied for $\\phi_{1/2} \\ge 0$.\nThe upper bound gives: $0.88 + 0.12 \\phi_{1/2} \\le 1.0 \\implies 0.12 \\phi_{1/2} \\le 0.12 \\implies \\phi_{1/2} \\le 1.0$.\n\nFor cell $i=1$: $0.0 \\le 0.6 - 0.12 \\phi_{1/2} \\le 1.0$.\nThe upper bound $0.6 - 0.12 \\phi_{1/2} \\le 1.0 \\implies -0.4 \\le 0.12 \\phi_{1/2}$ is always satisfied for $\\phi_{1/2} \\ge 0$.\nThe lower bound gives: $0.0 \\le 0.6 - 0.12 \\phi_{1/2} \\implies 0.12 \\phi_{1/2} \\le 0.6 \\implies \\phi_{1/2} \\le \\frac{0.6}{0.12} = 5.0$.\n\nTo satisfy all constraints simultaneously, including the definition $\\phi_{1/2} \\in [0,1]$, we need:\n$$\n\\phi_{1/2} \\le \\min(1.0, 1.0, 5.0) = 1.0\n$$\nThe largest admissible value for the limiter coefficient is $\\phi_{1/2} = 1.0$.\n\nFinally, we report the limited anti-diffusive flux, which is $\\phi_{1/2} f^{AD}_{1/2}$.\n$$\n\\phi_{1/2} f^{AD}_{1/2} = 1.0 \\times (-0.2) = -0.2\n$$\nRounding to four significant figures, the result is $-0.2000$.",
            "answer": "$$\\boxed{-0.2000}$$"
        }
    ]
}