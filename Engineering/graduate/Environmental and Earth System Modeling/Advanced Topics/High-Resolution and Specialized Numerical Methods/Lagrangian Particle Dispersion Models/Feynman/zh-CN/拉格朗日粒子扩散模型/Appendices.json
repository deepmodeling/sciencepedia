{
    "hands_on_practices": [
        {
            "introduction": "在模拟污染物扩散之前，我们必须首先理解起作用的各种力。本练习聚焦于量化决定扩散行为的关键环境因素：大气稳定度（浮力）和风切变，以及它们如何与烟羽的初始动量相抗衡。通过从基本物理原理出发推导和计算布伦特-瓦萨拉频率 $N$、理查森数 $\\mathrm{Ri}_g$ 和密度弗劳德数 $\\mathrm{Fr}_d$ 等无量纲参数，您将学会如何定性预测烟羽的初始上升和混合行为。",
            "id": "3886829",
            "problem": "一个连续的浮力射流从烟囱释放到一个水平均匀、稳定分层的大气中。烟囱出口位于高度 $z = 10\\,\\mathrm{m}$ 处。在 $z=10\\,\\mathrm{m}$ 处，环境位温在水平方向上近似均匀，其值为 $\\theta_{0} = 300\\,\\mathrm{K}$，并以恒定梯度 $d\\theta/dz = 4\\,\\mathrm{K\\,km^{-1}}$ 随高度线性增加。在所关注的层内，顺风向平均速度随高度线性增加，具有恒定的垂直切变 $S \\equiv \\partial U/\\partial z = 0.010\\,\\mathrm{s^{-1}}$。在源处，烟囱直径为 $D = 2.0\\,\\mathrm{m}$，平均出口速度为 $W_{0} = 15.0\\,\\mathrm{m\\,s^{-1}}$，流出物的位温相对于环境的超额为 $\\Delta \\theta = 30.0\\,\\mathrm{K}$。取重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，并假设干空气表现为理想气体，因此对于与环境的小偏差，相对密度亏损满足 $|\\Delta \\rho|/\\rho_{0} \\approx |\\Delta \\theta|/\\theta_{0}$。\n\n仅使用适用于分层切变流中拉格朗日粒子扩散的基本定义和平衡关系：\n\n- 从 Boussinesq 近似下垂直位移气块的恢复力以及位温的定义出发，推导在 $z=10\\,\\mathrm{m}$ 处的 Brunt–Väisälä 频率 $N$，以及给定层中用 $N$ 和 $S$ 表示的梯度 Richardson 数 $\\mathrm{Ri}_{g}$。\n- 从基于流出物相对于环境的浮力的折合重力 $g'$ 的定义出发，并使用量纲分析比较源长度尺度 $D$ 上的惯性效应和浮力效应，推导源处的密度 Froude 数 $\\mathrm{Fr}_{d}$，作为初始射流与羽流主导地位的适当无量纲参数。\n- 计算指定情景下的 $N$、$\\mathrm{Ri}_{g}$ 和 $\\mathrm{Fr}_{d}$。使用这些无量纲参数，定性地说明羽流初始是动量主导还是浮力主导，以及环境分层是否可能在羽流扩散时抑制垂直湍流混合。\n\n最终答案只报告密度 Froude 数 $\\mathrm{Fr}_{d}$ 的数值，四舍五入到三位有效数字。由于所求量是无量纲的，因此最终数值答案中不要包含任何单位。",
            "solution": "该问题要求推导和计算控制分层切变环境中羽流扩散的关键无量纲参数，并进行定性分析。该问题具有科学依据，提法明确，并包含了唯一解所需的所有信息。\n\n首先，我们处理 Brunt–Väisälä 频率 $N$ 和梯度 Richardson 数 $\\mathrm{Ri}_{g}$。\n\nBrunt–Väisälä 频率描述了在稳定密度梯度中流体气块垂直振荡的固有频率。我们从垂直位移气块的恢复力推导出它。考虑一个位于高度 $z$ 处，具有环境密度 $\\rho(z)$ 和位温 $\\theta(z)$ 的流体气块。如果该气块绝热地垂直位移一个微小距离 $\\delta z$ 到新的高度 $z+\\delta z$，它将保持其位温，从而保持其原始密度 $\\rho(z)$。在高度 $z+\\delta z$ 处的周围环境流体密度为 $\\rho_{amb}(z+\\delta z)$。\n\n作用在位移气块上的单位体积净浮力为 $F_b = g (\\rho_{amb}(z+\\delta z) - \\rho(z))$。\n在 Boussinesq 近似下，气块的垂直加速度 $a_z$ 是该力除以参考密度 $\\rho_0$：\n$$a_z = \\frac{d^2(\\delta z)}{dt^2} \\approx \\frac{g}{\\rho_0} (\\rho_{amb}(z+\\delta z) - \\rho(z))$$\n对于一个微小位移 $\\delta z$，环境密度可以通过一阶泰勒展开来近似：$\\rho_{amb}(z+\\delta z) \\approx \\rho(z) + \\frac{d\\rho}{dz}\\delta z$。\n将此代入加速度方程可得：\n$$a_z = \\frac{g}{\\rho_0} \\left( \\left(\\rho(z) + \\frac{d\\rho}{dz}\\delta z\\right) - \\rho(z) \\right) = \\frac{g}{\\rho_0} \\frac{d\\rho}{dz} \\delta z$$\n该方程描述了简谐运动 $\\frac{d^2(\\delta z)}{dt^2} = -N^2 \\delta z$，条件是 $\\delta z$ 的系数为负。这对于稳定分层的流体是成立的，因为其密度随高度减小（$\\frac{d\\rho}{dz}  0$）。通过比较，Brunt–Väisälä 频率的平方为：\n$$N^2 = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz}$$\n问题给出了理想气体的热力学关系：$|\\Delta \\rho|/\\rho_0 \\approx |\\Delta \\theta|/\\theta_0$。对于无穷小变化，这变为 $\\frac{d\\rho}{\\rho_0} = -\\frac{d\\theta}{\\theta_0}$，所以 $\\frac{1}{\\rho_0}\\frac{d\\rho}{dz} = -\\frac{1}{\\theta_0}\\frac{d\\theta}{dz}$。将此代入 $N^2$ 的表达式中：\n$$N^2 = -g \\left(-\\frac{1}{\\theta_0} \\frac{d\\theta}{dz}\\right) = \\frac{g}{\\theta_0} \\frac{d\\theta}{dz}$$\n使用给定值：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\theta_0 = 300\\,\\mathrm{K}$，以及 $\\frac{d\\theta}{dz} = 4\\,\\mathrm{K\\,km^{-1}} = 0.004\\,\\mathrm{K\\,m^{-1}}$。\n$$N^2 = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{300\\,\\mathrm{K}} (0.004\\,\\mathrm{K\\,m^{-1}}) \\approx 0.0001308\\,\\mathrm{s^{-2}}$$\n$$N = \\sqrt{0.0001308\\,\\mathrm{s^{-2}}} \\approx 0.0114\\,\\mathrm{s^{-1}}$$\n梯度 Richardson 数 $\\mathrm{Ri}_{g}$ 是一个无量纲参数，表示浮力的稳定效应与速度切变的不稳定效应之比。其定义为：\n$$\\mathrm{Ri}_{g} = \\frac{\\text{buoyancy term}}{\\text{shear term}} = \\frac{(g/\\theta_0)d\\theta/dz}{(\\partial U/\\partial z)^2}$$\n分子是 Brunt–Väisälä 频率的平方 $N^2$，分母是垂直风切变的平方 $S^2 = (\\partial U/\\partial z)^2$。\n$$\\mathrm{Ri}_{g} = \\frac{N^2}{S^2}$$\n使用计算出的 $N^2$ 值和给定值 $S = 0.010\\,\\mathrm{s^{-1}}$：\n$$\\mathrm{Ri}_{g} = \\frac{0.0001308\\,\\mathrm{s^{-2}}}{(0.010\\,\\mathrm{s^{-1}})^2} = \\frac{0.0001308}{0.0001} = 1.308$$\n接下来，我们推导密度 Froude 数 $\\mathrm{Fr}_{d}$。该数比较了射流的初始动量通量与浮力效应。它是通过取惯性力与浮力之比推导出来的。\n单位体积的惯性力可以标度为 $\\sim \\rho_j W_0^2/D$，其中 $\\rho_j$ 是射流密度，$W_0$ 是出口速度，$D$ 是特征长度尺度（烟囱直径）。\n单位体积的浮力是 $g|\\rho_a - \\rho_j| = g|\\Delta \\rho|$，其中 $\\rho_a$ 是环境密度。\n惯性与浮力之比为：\n$$\\frac{\\text{Inertia}}{\\text{Buoyancy}} \\sim \\frac{\\rho_j W_0^2/D}{g|\\Delta \\rho|}$$\n应用 Boussinesq 近似（$\\rho_j \\approx \\rho_a = \\rho_0$），该比值变为：\n$$\\frac{\\rho_0 W_0^2/D}{g|\\Delta \\rho|} = \\frac{W_0^2}{D g (|\\Delta \\rho|/\\rho_0)}$$\n该比值定义为密度 Froude 数的平方 $\\mathrm{Fr}_{d}^2$。项 $g' = g (|\\Delta \\rho|/\\rho_0)$ 是折合重力。使用给定的热力学近似，$g' \\approx g (\\Delta \\theta/\\theta_0)$，其中 $\\Delta\\theta$ 是流出物的位温超额。\n因此，密度 Froude 数为：\n$$\\mathrm{Fr}_{d} = \\frac{W_0}{\\sqrt{g' D}} = \\frac{W_0}{\\sqrt{D g \\frac{\\Delta\\theta}{\\theta_0}}}$$\n现在我们使用提供的数据计算其值：$W_0=15.0\\,\\mathrm{m\\,s^{-1}}$，$D=2.0\\,\\mathrm{m}$，$g=9.81\\,\\mathrm{m\\,s^{-2}}$，$\\Delta\\theta = 30.0\\,\\mathrm{K}$，以及 $\\theta_0=300\\,\\mathrm{K}$。\n首先，计算折合重力 $g'$：\n$$g' = (9.81\\,\\mathrm{m\\,s^{-2}}) \\frac{30.0\\,\\mathrm{K}}{300\\,\\mathrm{K}} = 9.81 \\times 0.1 = 0.981\\,\\mathrm{m\\,s^{-2}}$$\n现在，计算 $\\mathrm{Fr}_{d}$：\n$$\\mathrm{Fr}_{d} = \\frac{15.0\\,\\mathrm{m\\,s^{-1}}}{\\sqrt{(2.0\\,\\mathrm{m})(0.981\\,\\mathrm{m\\,s^{-2}})}} = \\frac{15.0}{\\sqrt{1.962}} \\approx \\frac{15.0}{1.40071} \\approx 10.7089$$\n四舍五入到三位有效数字，我们得到 $\\mathrm{Fr}_{d} \\approx 10.7$。\n\n最后，我们进行定性评估。\n释放的初始行为（类射流与类羽流）由密度 Froude 数决定。$\\mathrm{Fr}_{d} \\gg 1$ 的值表示初始惯性力远大于浮力。我们计算出的值为 $\\mathrm{Fr}_{d} \\approx 10.7$，明显大于 $1$。因此，该羽流初始是动量主导的，其行为将类似于射流。\n环境分层对湍流的影响通过梯度 Richardson 数来评估。通常使用一个临界值 $\\mathrm{Ri}_c \\approx 0.25$。如果 $\\mathrm{Ri}_{g} > \\mathrm{Ri}_c$，则稳定的分层足够强以抑制切变产生的湍流。我们计算出的值为 $\\mathrm{Ri}_{g} \\approx 1.31$，远高于临界值。这表明周围的大气层是强稳定的，并将主动抑制垂直湍流混合，导致羽流在顺风向平流时更多地在水平方向上扩散。",
            "answer": "$$\n\\boxed{10.7}\n$$"
        },
        {
            "introduction": "现代拉格朗日粒子扩散模型（LPDM）使用随机微分方程（SDEs）来描述粒子运动。一个核心挑战是确保模型在非均匀条件下物理上的一致性。本练习探讨了一个关键问题：在湍流空间变化的流场中（即涡动扩散系数 $K(z)$ 非恒定），如何构建随机微分方程以防止粒子在低湍流区域发生非物理性的聚集。通过推导一个修正“漂移项”，您将掌握确保模型满足“均匀混合”条件的必要技术。",
            "id": "3886893",
            "problem": "考虑大气边界层中拉格朗日粒子扩散模型的一维垂直坐标 $z$。一个被动标量由一组粒子表示，其垂直位置 $Z(t)$ 根据伊藤(Itō)随机微分方程（SDE）演化，\n$$\n\\mathrm{d}Z(t) = a(Z(t))\\,\\mathrm{d}t + \\sqrt{2\\,K(Z(t))}\\,\\mathrm{d}W(t),\n$$\n其中 $a(z)$ 是确定性漂移，$K(z)$ 是涡流扩散系数，$W(t)$ 是标准维纳过程。令相应的欧拉浓度 $C(z,t)$ 表示粒子数密度。假设没有源或汇，并且区域足够大，以至于内部的边界效应可以忽略不计。\n\n从概率质量守恒以及伊藤SDE与 $C(z,t)$ 的福克-普朗克(Fokker–Planck)方程之间的关系出发，推导漂移 $a(z)$ 为实现稳态、空间均匀的平衡浓度 $C_{\\infty}(z)=C_{0}$（其中 $C_{0}$ 是一个常数）所需的条件。然后，对于特定的涡流扩散系数剖面 $K(z)=K_{0}\\,(1+\\alpha z)$，其中 $K_{0}>0$ 且 $\\alpha$ 是一个常数（量纲为长度的倒数），计算维持均匀平衡 $C_{\\infty}(z)=C_{0}$ 的 $a(z)$ 的显式表达式。\n\n将您的最终答案表示为 $a(z)$ 的单个闭合形式符号表达式。漂移 $a(z)$ 的物理单位是米/秒，但不要在您的方框答案中包含单位。",
            "solution": "用户希望找到拉格朗日粒子扩散模型中的漂移项 `a(z)`，该漂移项能导致稳态、空间均匀的浓度。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件**\n\n-   粒子的垂直位置 $Z(t)$ 由伊藤(Itō)随机微分方程（SDE）控制：\n    $$\n    \\mathrm{d}Z(t) = a(Z(t))\\,\\mathrm{d}t + \\sqrt{2\\,K(Z(t))}\\,\\mathrm{d}W(t)\n    $$\n-   $a(z)$ 是确定性漂移。\n-   $K(z)$ 是涡流扩散系数。\n-   $W(t)$ 是标准维纳过程。\n-   欧拉浓度为 $C(z,t)$。\n-   系统没有源或汇。\n-   边界效应可以忽略不计。\n-   期望的平衡态是稳态、空间均匀的浓度：$C_{\\infty}(z) = C_{0}$，其中 $C_{0}$ 是一个常数。\n-   给定了特定的涡流扩散系数剖面：$K(z) = K_{0}\\,(1+\\alpha z)$，其中 $K_{0} > 0$ 且 $\\alpha$ 是一个常数。\n\n**1.2. 使用提取的已知条件进行验证**\n\n根据验证标准对问题进行审查。\n\n-   **科学基础**：该问题描述了用于粒子轨迹的拉格朗日随机模型（一个伊藤SDE）与由福克-普朗克(Fokker–Planck)方程描述的相应欧拉浓度场之间的关系。这是统计物理和流体动力学中的一个标准和基本概念，尤其是在模拟湍流扩散方面。该设置在科学上和数学上都是合理的。\n-   **适定性**：问题定义明确。它提供了一个控制方程，指定了一个期望状态（稳态、均匀浓度），并给出了模型系数之一（$K(z)$）的函数形式。然后要求推导满足此条件的另一个系数（$a(z)$）。这构成了一个清晰且可解的数学问题。\n-   **客观性**：问题陈述精确、量化，没有主观或含糊的语言。诸如“稳态”、“空间均匀”和前面提到的SDE等所有术语在物理学和数学中都有正式定义。\n-   **完整性和一致性**：问题提供了所有必要的信息。伊藤SDE与福克-普朗克方程之间的关系是一个标准结果，不需要从第一性原理重新推导，而是被直接引用。对区域的条件（大、无源/汇）足以确定积分常数（通量）。没有矛盾之处。\n-   **现实性和可行性**：SDE是湍流扩散的常用模型。空间变化的扩散系数剖面，如线性形式 $K(z) = K_{0}\\,(1+\\alpha z)$，在大气边界层等情境中被用作简化但合理的表示。这个问题在物理上和数学上都是可解的。\n\n**1.3. 结论与行动**\n\n问题是**有效的**。这是将随机过程应用于输运现象领域的一个标准练习。可以进行求解过程。\n\n### 第2步：推导漂移条件\n\n与给定的伊藤SDE相对应的粒子数密度（或浓度）$C(z,t)$的演化由福克-普朗克方程描述。对于具有漂移$a(z)$和扩散系数$D(z)$的一维过程，福克-普朗克方程的一般形式为：\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{\\partial}{\\partial z}\\left[a(z)C\\right] + \\frac{\\partial^2}{\\partial z^2}\\left[D(z)C\\right]\n$$\n在SDE $\\mathrm{d}Z = a(Z)\\,\\mathrm{d}t + \\sigma(Z)\\,\\mathrm{d}W(t)$ 的背景下，福克-普朗克方程中的扩散系数$D(z)$与随机项$\\sigma(z)$的关系为$D(z) = \\frac{1}{2}\\sigma^2(z)$。从给定的SDE中，我们有$\\sigma(z) = \\sqrt{2K(z)}$，因此扩散系数为：\n$$\nD(z) = \\frac{1}{2}\\left(\\sqrt{2K(z)}\\right)^2 = \\frac{1}{2}(2K(z)) = K(z)\n$$\n因此，浓度$C(z,t)$的控制方程为：\n$$\n\\frac{\\partial C(z,t)}{\\partial t} = -\\frac{\\partial}{\\partial z}\\left[a(z)C(z,t)\\right] + \\frac{\\partial^2}{\\partial z^2}\\left[K(z)C(z,t)\\right]\n$$\n这个方程可以写成连续性方程的形式，$\\frac{\\partial C}{\\partial t} = -\\frac{\\partial J}{\\partial z}$，其中$J(z,t)$是粒子通量：\n$$\nJ(z,t) = a(z)C(z,t) - \\frac{\\partial}{\\partial z}\\left[K(z)C(z,t)\\right]\n$$\n问题要求一个稳态平衡解，这意味着浓度不随时间变化，即$\\frac{\\partial C}{\\partial t} = 0$。在这种情况下，连续性方程简化为$\\frac{\\partial J}{\\partial z} = 0$。这意味着稳态通量$J(z)$必须是关于空间坐标$z$的常数。\n\n问题陈述边界效应可忽略且无源汇。对于这样一个无界或大区域中存在的稳态，粒子的净通量必须处处为零。如果通量是一个非零常数，将意味着粒子从区域的一端连续输运到另一端，导致一个区域耗尽而另一个区域积累，这与稳态平衡的前提相矛盾。因此，我们必须将常数通量设为零：$J(z) = 0$。\n\n因此，稳态平衡的条件是：\n$$\na(z)C(z) - \\frac{\\partial}{\\partial z}\\left[K(z)C(z)\\right] = 0\n$$\n我们已知稳态平衡浓度是空间均匀的，即$C(z) = C_{\\infty}(z) = C_{0}$，其中$C_{0}$是一个非零常数。将此代入零通量条件：\n$$\na(z)C_{0} - \\frac{\\mathrm{d}}{\\mathrm{d}z}\\left[K(z)C_{0}\\right] = 0\n$$\n由于$C_{0}$是常数，可以从导数中提出：\n$$\na(z)C_{0} - C_{0}\\frac{\\mathrm{d}K(z)}{\\mathrm{d}z} = 0\n$$\n假设浓度非零（$C_{0} \\neq 0$），我们可以将整个方程除以$C_{0}$，得到维持均匀浓度所需的漂移$a(z)$的一般条件：\n$$\na(z) = \\frac{\\mathrm{d}K(z)}{\\mathrm{d}z}\n$$\n这个结果被称为“良好混合”条件。它规定必须添加一个等于扩散系数梯度的人为漂移，以抵消粒子在较低扩散系数区域积累的趋势。\n\n### 第3步：计算特定的漂移 `a(z)`\n\n现在我们将这个一般条件应用于问题陈述中提供的特定涡流扩散系数剖面：\n$$\nK(z) = K_{0}\\,(1+\\alpha z)\n$$\n其中$K_{0}$和$\\alpha$是常数。\n\n我们计算$K(z)$关于$z$的导数：\n$$\n\\frac{\\mathrm{d}K(z)}{\\mathrm{d}z} = \\frac{\\mathrm{d}}{\\mathrm{d}z} \\left[ K_{0}\\,(1+\\alpha z) \\right]\n$$\n使用微分法则：\n$$\n\\frac{\\mathrm{d}K(z)}{\\mathrm{d}z} = K_{0} \\frac{\\mathrm{d}}{\\mathrm{d}z} (1+\\alpha z) = K_{0} \\left(\\frac{\\mathrm{d}}{\\mathrm{d}z}(1) + \\frac{\\mathrm{d}}{\\mathrm{d}z}(\\alpha z)\\right)\n$$\n$$\n\\frac{\\mathrm{d}K(z)}{\\mathrm{d}z} = K_{0} (0 + \\alpha) = \\alpha K_{0}\n$$\n因此，维持均匀平衡浓度的漂移$a(z)$是一个常数：\n$$\na(z) = \\alpha K_{0}\n$$",
            "answer": "$$\n\\boxed{\\alpha K_{0}}\n$$"
        },
        {
            "introduction": "拉格朗日扩散模型的一个强大应用是反演建模：利用浓度测量值来推断未知的排放源。本练习将引导您实践此任务的核心统计方法。您将使用一个由LPDM预先计算出的源-受体关系，并应用最大似然估计原理，从含噪声的观测数据中估算未知的排放率 $Q$，并量化该估计的不确定性。",
            "id": "3886854",
            "problem": "考虑一个具有恒定排放率 $Q$（单位为 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）的惰性示踪剂的单一、稳定点源排放。一个拉格朗日粒子扩散模型 (Lagrangian Particle Dispersion Model, LPDM) 预先计算了特定受体的源-受体转换系数（足迹），因此受体 $i$ 处的时间平均浓度与 $Q$ 呈线性关系，即 $y_i = G_i \\, Q + \\epsilon_i$。其中 $G_i$（单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ per $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）是受体 $i$ 的足迹，$\\epsilon_i$ 是测量误差。假设误差 $\\epsilon_i$ 是独立同分布的高斯随机变量，其均值为零，标准差 $\\sigma_i$（单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$）已知，且测量值 $y_i$ 以 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 为单位报告。利用 $\\epsilon_i$ 的独立性和高斯性以及LPDM映射 $Q \\mapsto y_i$ 的线性性，从第一性原理出发，推导出 $Q$ 的最大似然估计量，并在相同的高斯假设下对该估计进行不确定性量化。\n\n您的程序必须：\n- 使用具有可能异构 $\\sigma_i$ 的 $N$ 个受体的一般情况，实现推导出的估计量和相关的不确定性量化。\n- 对于每个测试用例，返回四个量：\n    1. $Q$ 的点估计值（单位为 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n    2. 假设为平坦先验时 $Q$ 的后验标准差（单位为 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$），在高斯误差下，该值等于从似然曲率导出的估计量标准差。\n    3. 在高斯后验分布下，$Q$ 的双侧 $0.95$ 可信区间的下限（单位为 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n    4. 同一可信区间的上限（单位为 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n- 使用标准正态分位数 $z_{0.975}$ 来构建双侧 $0.95$ 区间。\n- 所有结果均以 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$ 表示。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表按上述顺序将所有测试用例的结果展平。例如，对于三个测试用例，输出应为 $[q_1,\\mathrm{sd}_1,\\mathrm{low}_1,\\mathrm{high}_1,q_2,\\mathrm{sd}_2,\\mathrm{low}_2,\\mathrm{high}_2,q_3,\\mathrm{sd}_3,\\mathrm{low}_3,\\mathrm{high}_3]$ 的形式。\n\n测试套件：\n- 用例 A (理想情况，信号适中且不确定性相等)：\n    - $G = [0.80, 1.10, 0.95]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ per $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [0.88, 1.12, 0.97]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.05, 0.05, 0.05]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n- 用例 B (边界倾向情况，足迹非常小且不确定性相等)：\n    - $G = [0.010, 0.020, 0.015]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ per $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [0.008, 0.023, 0.012]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.005, 0.005, 0.005]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n- 用例 C (边缘情况，不确定性异构且因噪声导致一个负测量值)：\n    - $G = [0.30, 0.20, 0.40, 0.50]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ per $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [-0.01, 0.08, 0.15, 0.24]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.05, 0.04, 0.06, 0.05]$，单位为 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按 $[q_A,\\mathrm{sd}_A,\\mathrm{low}_A,\\mathrm{high}_A,q_B,\\mathrm{sd}_B,\\mathrm{low}_B,\\mathrm{high}_B,q_C,\\mathrm{sd}_C,\\mathrm{low}_C,\\mathrm{high}_C]$ 的顺序排列结果，其中下标表示用例。所有数值必须以 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$ 为单位。",
            "solution": "问题陈述被评估为有效，并将提供解决方案。该问题具有科学依据、提法恰当且客观。其对误差分布的描述中存在一个微小的不一致：它将误差 $\\epsilon_i$ 指定为“均值为零、标准差 $\\sigma_i$ 已知的独立同分布高斯随机变量”。如果标准差 $\\sigma_i$ 在不同观测值之间可能变化（如符号所示并在测试用例 C 中得到证实），那么这些随机变量是独立的但不是同分布的。该问题的明确意图是处理异构不确定性。因此，推导将基于修正后的假设进行，即误差 $\\epsilon_i$ 是独立的，并且每个都服从高斯分布 $\\mathcal{N}(0, \\sigma_i^2)$。\n\n任务是基于一组 $N$ 个测量值，推导排放率 $Q$ 的最大似然估计量，并量化其不确定性。将测量值 $y_i$ 与排放率 $Q$ 关联的模型由以下线性方程给出：\n$$ y_i = G_i Q + \\epsilon_i $$\n其中 $y_i$ 是测量的浓度，$G_i$ 是已知的源-受体转换系数（足迹），$Q$ 是未知的排放率，而 $\\epsilon_i$ 是测量误差。对于每个受体 $i=1, \\dots, N$，误差 $\\epsilon_i$ 是一个独立的随机变量，取自均值为 $0$、已知标准差为 $\\sigma_i$ 的高斯分布，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_i^2)$。\n\n由此可知，测量值 $y_i$ 也是一个高斯随机变量，其均值为 $G_i Q$，方差为 $\\sigma_i^2$：\n$$ y_i \\sim \\mathcal{N}(G_i Q, \\sigma_i^2) $$\n单个观测值 $y_i$ 在给定 $Q$ 的情况下的概率密度函数 (PDF) 是：\n$$ p(y_i | Q) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - G_i Q)^2}{2\\sigma_i^2}\\right) $$\n\n**1. 最大似然估计量 (MLE) 的推导**\n\n似然函数 $L(Q)$ 是观测到整个测量数据集 $\\{y_i\\}_{i=1}^N$ 的联合概率。由于测量值是独立的，似然函数是各个 PDF 的乘积：\n$$ L(Q) = \\prod_{i=1}^{N} p(y_i | Q) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - G_i Q)^2}{2\\sigma_i^2}\\right) $$\n为了找到使 $L(Q)$ 最大化的 $Q$ 值，在计算上更简单的方法是最大化对数似然函数 $\\mathcal{L}(Q) = \\ln(L(Q))$：\n$$ \\mathcal{L}(Q) = \\ln\\left( \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - G_i Q)^2}{2\\sigma_i^2}\\right) \\right) $$\n$$ \\mathcal{L}(Q) = \\sum_{i=1}^{N} \\left[ \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma_i^2}}\\right) - \\frac{(y_i - G_i Q)^2}{2\\sigma_i^2} \\right] $$\n$$ \\mathcal{L}(Q) = C - \\frac{1}{2} \\sum_{i=1}^{N} \\frac{(y_i - G_i Q)^2}{\\sigma_i^2} $$\n其中 $C$ 是一个不依赖于 $Q$ 的常数。最大化 $\\mathcal{L}(Q)$ 等价于最小化加权残差平方和 $\\chi^2(Q) = \\sum_{i=1}^{N} \\frac{(y_i - G_i Q)^2}{\\sigma_i^2}$，其中权重为 $w_i = 1/\\sigma_i^2$。\n\n为了找到最大值，我们计算 $\\mathcal{L}(Q)$ 关于 $Q$ 的导数并将其设为 $0$：\n$$ \\frac{d\\mathcal{L}(Q)}{dQ} = \\frac{d}{dQ} \\left( C - \\frac{1}{2} \\sum_{i=1}^{N} \\frac{(y_i - G_i Q)^2}{\\sigma_i^2} \\right) = -\\frac{1}{2} \\sum_{i=1}^{N} \\frac{1}{\\sigma_i^2} \\cdot 2(y_i - G_i Q) \\cdot (-G_i) $$\n$$ \\frac{d\\mathcal{L}(Q)}{dQ} = \\sum_{i=1}^{N} \\frac{G_i(y_i - G_i Q)}{\\sigma_i^2} $$\n将导数设为零以找到估计量 $\\hat{Q}$：\n$$ \\sum_{i=1}^{N} \\frac{G_i(y_i - G_i \\hat{Q})}{\\sigma_i^2} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{G_i y_i}{\\sigma_i^2} = \\hat{Q} \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} $$\n求解 $\\hat{Q}$ 得到最大似然估计量：\n$$ \\hat{Q} = \\frac{\\sum_{i=1}^{N} (G_i y_i / \\sigma_i^2)}{\\sum_{i=1}^{N} (G_i^2 / \\sigma_i^2)} $$\n该估计量是各个估计值 $y_i/G_i$ 的加权平均值，其中每个估计值根据其相对于模型的精度 $(G_i/\\sigma_i)^2$ 进行加权。\n\n**2. 不确定性量化**\n\n问题要求在平坦先验 $p(Q) \\propto 1$ 的条件下，$Q$ 的后验标准差。在这种情况下，后验分布与似然函数成正比，即 $p(Q|\\{y_i\\}) \\propto L(Q)$。由于对数似然 $\\mathcal{L}(Q)$是 $Q$ 的二次函数，因此 $Q$ 的后验分布是高斯分布。此后验分布的均值是 MLE，即 $\\hat{Q}$。\n\n后验分布的方差 $\\sigma_Q^2$ 可以从对数似然函数在其最大值处的曲率求得。方差是对数似然二阶导数的负倒数：\n$$ \\sigma_Q^2 = \\left( - \\frac{d^2\\mathcal{L}(Q)}{dQ^2} \\right)^{-1} $$\n让我们计算二阶导数：\n$$ \\frac{d^2\\mathcal{L}(Q)}{dQ^2} = \\frac{d}{dQ} \\left( \\sum_{i=1}^{N} \\frac{G_i y_i}{\\sigma_i^2} - \\sum_{i=1}^{N} \\frac{G_i^2 Q}{\\sigma_i^2} \\right) = - \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} $$\n二阶导数为负常数，这证实了 $\\hat{Q}$ 对应于一个最大值，且后验分布确实是高斯分布。方差为：\n$$ \\sigma_Q^2 = \\left( - \\left( - \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right) \\right)^{-1} = \\left( \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right)^{-1} $$\n后验标准差 $\\sigma_Q$ 是方差的平方根：\n$$ \\sigma_Q = \\left( \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right)^{-1/2} $$\n\n**3. 可信区间**\n\n当 $Q$ 的后验分布被确定为高斯分布 $Q|\\{y_i\\} \\sim \\mathcal{N}(\\hat{Q}, \\sigma_Q^2)$ 时，可以为 $Q$ 构建一个双侧 $0.95$ 可信区间。该区间以均值 $\\hat{Q}$ 为中心，并延伸标准差 $\\sigma_Q$ 的某个倍数。该倍数由标准正态分位数 $z_{\\alpha/2}$ 给出，其中 $1-\\alpha = 0.95$，因此 $\\alpha/2 = 0.025$。我们需要 $z_{0.025}$，或等效地，上分位数 $z_{1-0.025} = z_{0.975}$。\n\n可信区间由下式给出：\n$$ [ \\hat{Q} - z_{0.975} \\cdot \\sigma_Q, \\quad \\hat{Q} + z_{0.975} \\cdot \\sigma_Q ] $$\n其中 $z_{0.975} \\approx 1.96$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的第 $97.5$ 百分位数。\n\n每个测试用例的计算步骤如下：\n1.  给定 $G_i$、$y_i$ 和 $\\sigma_i$ 的数组，计算权重 $w_i = 1/\\sigma_i^2$。\n2.  计算 MLE 点估计值 $\\hat{Q} = (\\sum w_i G_i y_i) / (\\sum w_i G_i^2)$。\n3.  计算后验标准差 $\\sigma_Q = (\\sum w_i G_i^2)^{-1/2}$。\n4.  从标准正态分布中确定分位数 $z_{0.975}$。\n5.  计算 $0.95$ 可信区间的下限为 $\\hat{Q} - z_{0.975} \\cdot \\sigma_Q$。\n6.  计算 $0.95$ 可信区间的上限为 $\\hat{Q} + z_{0.975} \\cdot \\sigma_Q$。\n这四个量将为每个提供的测试用例进行计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Derives the maximum likelihood estimate for a single emission source Q,\n    its uncertainty, and credible interval, based on a linear receptor model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (G_values, y_values, sigma_values)\n    test_cases = [\n        # Case A (happy path, moderate signals and equal uncertainties)\n        ([0.80, 1.10, 0.95], [0.88, 1.12, 0.97], [0.05, 0.05, 0.05]),\n        # Case B (boundary-leaning case with very small footprints and equal uncertainties)\n        ([0.010, 0.020, 0.015], [0.008, 0.023, 0.012], [0.005, 0.005, 0.005]),\n        # Case C (edge case with heterogeneous uncertainties and one negative measurement)\n        ([0.30, 0.20, 0.40, 0.50], [-0.01, 0.08, 0.15, 0.24], [0.05, 0.04, 0.06, 0.05]),\n    ]\n\n    all_results = []\n    \n    # Pre-calculate the standard normal quantile for a two-sided 95% interval.\n    # This corresponds to the 97.5th percentile.\n    z_0975 = norm.ppf(0.975)\n\n    for G_vals, y_vals, sigma_vals in test_cases:\n        # Convert lists to NumPy arrays for vectorized operations.\n        G = np.array(G_vals)\n        y = np.array(y_vals)\n        sigma = np.array(sigma_vals)\n\n        # The weights for the weighted least squares are the inverse variances.\n        weights = 1.0 / sigma**2\n\n        # Calculate the terms for the MLE of Q.\n        # This is equivalent to Q_hat = (G' W y) / (G' W G) in matrix notation,\n        # where W is the weight matrix.\n        numerator = np.sum(weights * G * y)\n        denominator = np.sum(weights * G**2)\n\n        # 1. Point estimate of Q (kg/s)\n        q_hat = numerator / denominator\n\n        # The denominator is also the Fisher Information, or the inverse variance of Q.\n        # 2. Posterior standard deviation of Q (kg/s)\n        var_q = 1.0 / denominator\n        std_q = np.sqrt(var_q)\n\n        # Calculate the half-width of the credible interval.\n        interval_half_width = z_0975 * std_q\n\n        # 3. Lower endpoint of the 95% credible interval for Q (kg/s)\n        q_lower = q_hat - interval_half_width\n        \n        # 4. Upper endpoint of the 95% credible interval for Q (kg/s)\n        q_upper = q_hat + interval_half_width\n        \n        # Append the four required quantities for this case to the final list.\n        all_results.extend([q_hat, std_q, q_lower, q_upper])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}