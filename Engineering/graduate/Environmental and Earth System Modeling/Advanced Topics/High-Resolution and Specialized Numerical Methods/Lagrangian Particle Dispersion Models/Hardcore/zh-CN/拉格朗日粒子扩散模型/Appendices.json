{
    "hands_on_practices": [
        {
            "introduction": "本次实践关注于控制烟羽扩散的基本物理原理。在对粒子轨迹进行建模之前，我们必须理解作用于其上的各种力。本练习将引导你推导并解释描述烟羽初始动量、浮力与周围大气稳定性之间相互作用的关键无量纲参数，这对正确参数化和解释任何扩散模型的结果至关重要。",
            "id": "3886829",
            "problem": "一股连续的浮力射流从烟囱释放到一个水平均匀、稳定分层的大气中。烟囱出口位于高度 $z = 10\\,\\mathrm{m}$ 处。在 $z=10\\,\\mathrm{m}$ 处，环境位温在水平方向上近似均匀，其值为 $\\theta_{0} = 300\\,\\mathrm{K}$，并以恒定梯度 $d\\theta/dz = 4\\,\\mathrm{K\\,km^{-1}}$ 随高度线性增加。在所关注的层内，顺风向平均速度随高度线性增加，具有恒定的垂直切变 $S \\equiv \\partial U/\\partial z = 0.010\\,\\mathrm{s^{-1}}$。在源处，烟囱直径为 $D = 2.0\\,\\mathrm{m}$，平均出口速度为 $W_{0} = 15.0\\,\\mathrm{m\\,s^{-1}}$，流出物相对于环境的位温超量为 $\\Delta \\theta = 30.0\\,\\mathrm{K}$。取重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，并假设干燥空气行为符合理想气体，因此对于与环境的微小偏离，相对密度亏损满足 $|\\Delta \\rho|/\\rho_{0} \\approx |\\Delta \\theta|/\\theta_{0}$。\n\n仅使用适用于分层切变流中拉格朗日粒子弥散的基本定义和平衡方程：\n\n- 从Boussinesq近似下垂直位移气块的恢复力以及位温的定义出发，推导在 $z=10\\,\\mathrm{m}$ 处的Brunt–Väisälä频率 $N$ 以及给定层内用 $N$ 和 $S$ 表示的梯度理查森数 $\\mathrm{Ri}_{g}$。\n- 从基于流出物相对于环境的浮力的折合重力 $g'$ 的定义出发，并使用量纲分析比较源长度尺度 $D$ 上的惯性效应和浮力效应，推导源处的密度弗劳德数 $\\mathrm{Fr}_{d}$，作为判断初始射流与羽流主导地位的恰当无量纲参数。\n- 计算指定情景下的 $N$、$\\mathrm{Ri}_{g}$ 和 $\\mathrm{Fr}_{d}$。利用这些无量纲参数，定性地说明羽流在初始阶段是动量主导还是浮力主导，以及环境分层是否可能在羽流弥散时抑制其垂直湍流混合。\n\n仅报告密度弗劳德数 $\\mathrm{Fr}_{d}$ 的数值，四舍五入至三位有效数字，作为您的最终答案。由于所求量为无量纲量，最终数值答案中请勿包含任何单位。",
            "solution": "该问题要求推导和计算控制分层切变环境中羽流弥散的关键无量纲参数，并进行定性分析。该问题具有科学依据，提法明确，并包含得出唯一解所需的所有信息。\n\n首先，我们处理Brunt–Väisälä频率 $N$ 和梯度理查森数 $\\mathrm{Ri}_{g}$。\n\nBrunt–Väisälä频率描述了在稳定密度梯度中，流体微团垂直振荡的固有频率。我们从垂直位移的流体微团所受的恢复力来推导它。考虑一个位于高度 $z$ 的流体微团，其环境密度为 $\\rho(z)$，位温为 $\\theta(z)$。如果该微团被绝热地垂直位移一小段距离 $\\delta z$ 到新的高度 $z+\\delta z$，它将保持其位温，从而保持其原始密度 $\\rho(z)$。在高度 $z+\\delta z$ 处的周围环境流体密度为 $\\rho_{amb}(z+\\delta z)$。\n\n作用在位移微团上的单位体积净浮力为 $F_b = g (\\rho_{amb}(z+\\delta z) - \\rho(z))$。\n在Boussinesq近似下，微团的垂直加速度 $a_z$ 是该力除以参考密度 $\\rho_0$：\n$$a_z = \\frac{d^2(\\delta z)}{dt^2} \\approx \\frac{g}{\\rho_0} (\\rho_{amb}(z+\\delta z) - \\rho(z))$$\n对于一个小的位移 $\\delta z$，环境密度可以通过一阶泰勒展开来近似：$\\rho_{amb}(z+\\delta z) \\approx \\rho(z) + \\frac{d\\rho}{dz}\\delta z$。\n将此代入加速度方程可得：\n$$a_z = \\frac{g}{\\rho_0} \\left( \\left(\\rho(z) + \\frac{d\\rho}{dz}\\delta z\\right) - \\rho(z) \\right) = \\frac{g}{\\rho_0} \\frac{d\\rho}{dz} \\delta z$$\n该方程描述了简谐运动 $\\frac{d^2(\\delta z)}{dt^2} = -N^2 \\delta z$，前提是 $\\delta z$ 的系数为负。这对于稳定分层的流体是成立的，因为其密度随高度减小（$\\frac{d\\rho}{dz} < 0$）。通过比较，Brunt–Väisälä频率的平方为：\n$$N^2 = -\\frac{g}{\\rho_0} \\frac{d\\rho}{dz}$$\n问题给出了理想气体的热力学关系：$|\\Delta \\rho|/\\rho_0 \\approx |\\Delta \\theta|/\\theta_0$。对于无穷小的变化，这变成 $\\frac{d\\rho}{\\rho_0} = -\\frac{d\\theta}{\\theta_0}$，因此 $\\frac{1}{\\rho_0}\\frac{d\\rho}{dz} = -\\frac{1}{\\theta_0}\\frac{d\\theta}{dz}$。将此代入 $N^2$ 的表达式中：\n$$N^2 = -g \\left(-\\frac{1}{\\theta_0} \\frac{d\\theta}{dz}\\right) = \\frac{g}{\\theta_0} \\frac{d\\theta}{dz}$$\n使用给定值：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\theta_0 = 300\\,\\mathrm{K}$，以及 $\\frac{d\\theta}{dz} = 4\\,\\mathrm{K\\,km^{-1}} = 0.004\\,\\mathrm{K\\,m^{-1}}$。\n$$N^2 = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{300\\,\\mathrm{K}} (0.004\\,\\mathrm{K\\,m^{-1}}) \\approx 0.0001308\\,\\mathrm{s^{-2}}$$\n$$N = \\sqrt{0.0001308\\,\\mathrm{s^{-2}}} \\approx 0.0114\\,\\mathrm{s^{-1}}$$\n梯度理查森数 $\\mathrm{Ri}_{g}$ 是一个无量纲参数，表示浮力的稳定效应与速度切变的不稳定效应之比。其定义为：\n$$\\mathrm{Ri}_{g} = \\frac{\\text{buoyancy term}}{\\text{shear term}} = \\frac{(g/\\theta_0)d\\theta/dz}{(\\partial U/\\partial z)^2}$$\n分子是Brunt–Väisälä频率的平方，$N^2$，分母是垂直风切变的平方，$S^2 = (\\partial U/\\partial z)^2$。\n$$\\mathrm{Ri}_{g} = \\frac{N^2}{S^2}$$\n使用计算出的 $N^2$ 值和给定值 $S = 0.010\\,\\mathrm{s^{-1}}$：\n$$\\mathrm{Ri}_{g} = \\frac{0.0001308\\,\\mathrm{s^{-2}}}{(0.010\\,\\mathrm{s^{-1}})^2} = \\frac{0.0001308}{0.0001} = 1.308$$\n接下来，我们推导密度弗劳德数 $\\mathrm{Fr}_{d}$。该数比较了射流的初始动量通量与浮力效应。它是通过取惯性力与浮力之比得出的。\n单位体积的惯性力可以标度为 $\\sim \\rho_j W_0^2/D$，其中 $\\rho_j$ 是射流密度，$W_0$ 是出口速度，$D$ 是特征长度尺度（烟囱直径）。\n单位体积的浮力是 $g|\\rho_a - \\rho_j| = g|\\Delta \\rho|$，其中 $\\rho_a$ 是环境密度。\n惯性力与浮力之比为：\n$$\\frac{\\text{Inertia}}{\\text{Buoyancy}} \\sim \\frac{\\rho_j W_0^2/D}{g|\\Delta \\rho|}$$\n应用Boussinesq近似（$\\rho_j \\approx \\rho_a = \\rho_0$），该比值变为：\n$$\\frac{\\rho_0 W_0^2/D}{g|\\Delta \\rho|} = \\frac{W_0^2}{D g (|\\Delta \\rho|/\\rho_0)}$$\n该比值被定义为密度弗劳德数的平方 $\\mathrm{Fr}_{d}^2$。项 $g' = g (|\\Delta \\rho|/\\rho_0)$ 是折合重力。使用给定的热力学近似，$g' \\approx g (\\Delta \\theta/\\theta_0)$，其中 $\\Delta\\theta$ 是流出物的位温超量。\n因此，密度弗劳德数为：\n$$\\mathrm{Fr}_{d} = \\frac{W_0}{\\sqrt{g' D}} = \\frac{W_0}{\\sqrt{D g \\frac{\\Delta\\theta}{\\theta_0}}}$$\n现在我们使用提供的数据计算其值：$W_0=15.0\\,\\mathrm{m\\,s^{-1}}$，$D=2.0\\,\\mathrm{m}$，$g=9.81\\,\\mathrm{m\\,s^{-2}}$，$\\Delta\\theta = 30.0\\,\\mathrm{K}$，以及 $\\theta_0=300\\,\\mathrm{K}$。\n首先，计算折合重力 $g'$：\n$$g' = (9.81\\,\\mathrm{m\\,s^{-2}}) \\frac{30.0\\,\\mathrm{K}}{300\\,\\mathrm{K}} = 9.81 \\times 0.1 = 0.981\\,\\mathrm{m\\,s^{-2}}$$\n现在，计算 $\\mathrm{Fr}_{d}$：\n$$\\mathrm{Fr}_{d} = \\frac{15.0\\,\\mathrm{m\\,s^{-1}}}{\\sqrt{(2.0\\,\\mathrm{m})(0.981\\,\\mathrm{m\\,s^{-2}})}} = \\frac{15.0}{\\sqrt{1.962}} \\approx \\frac{15.0}{1.40071} \\approx 10.7089$$\n四舍五入到三位有效数字，我们得到 $\\mathrm{Fr}_{d} \\approx 10.7$。\n\n最后，我们进行定性评估。\n释放物的初始行为（类射流与类羽流）由密度弗劳德数决定。$\\mathrm{Fr}_{d} \\gg 1$ 的值表示初始惯性力远大于浮力。我们计算出的值为 $\\mathrm{Fr}_{d} \\approx 10.7$，显著大于1。因此，该羽流初始是动量主导的，其行为将类似于射流。\n环境分层对湍流的影响通过梯度理查森数来评估。通常使用一个临界值 $\\mathrm{Ri}_c \\approx 0.25$。如果 $\\mathrm{Ri}_{g} > \\mathrm{Ri}_c$，则稳定分层足够强以抑制由切变产生的湍流。我们计算出的值为 $\\mathrm{Ri}_{g} \\approx 1.31$，远高于该临界值。这表明环境大气层是强稳定的，并将主动抑制垂直湍流混合，导致羽流在顺风向输送过程中更多地在水平方向上扩散。",
            "answer": "$$\n\\boxed{10.7}\n$$"
        },
        {
            "introduction": "在探究了物理环境之后，我们将深入研究拉格朗日粒子扩散模型（LPDM）的数学构建。一个关键挑战是确保模型在物理上是一致的，尤其是在湍流强度随空间变化的​​情况下。本实践将通过要求你推导一个校正项来解决“均匀混合条件”这一核心概念，该校正项可以防止粒子在低扩散率区域发生不符合物理规律的聚集，从而确保模型能正确地模拟扩散过程。",
            "id": "3886893",
            "problem": "在一个用于大气边界层的拉格朗日粒子扩散模型中，考虑一个一维垂直坐标 $z$。一个被动标量由一个粒子系综表示，其垂直位置 $Z(t)$ 根据一个伊藤随机微分方程 (SDE) 演化，\n$$\n\\mathrm{d}Z(t) = a(Z(t))\\,\\mathrm{d}t + \\sqrt{2\\,K(Z(t))}\\,\\mathrm{d}W(t),\n$$\n其中 $a(z)$ 是确定性漂移，$K(z)$ 是涡动扩散系数，$W(t)$ 是一个标准维纳过程。令相应的欧拉浓度 $C(z,t)$ 表示粒子数密度。假设没有源或汇，并且区域足够大，以至于内部的边界效应可以忽略不计。\n\n从概率质量守恒以及伊藤SDE与 $C(z,t)$ 的福克-普朗克方程之间的关系出发，推导漂移 $a(z)$ 为实现稳态、空间均匀的平衡浓度 $C_{\\infty}(z)=C_{0}$（其中 $C_{0}$ 是一个常数）所需的条件。然后，对于特定的涡动扩散系数剖面 $K(z)=K_{0}\\,(1+\\alpha z)$，其中 $K_{0}>0$ 且 $\\alpha$ 是一个常数（量纲为长度的倒数），计算维持均匀平衡 $C_{\\infty}(z)=C_{0}$ 的 $a(z)$ 的显式表达式。\n\n将你的最终答案表示为 $a(z)$ 的单个闭式符号表达式。漂移 $a(z)$ 的物理单位是米每秒，但不要在你的方框答案中包含单位。",
            "solution": "对于给定的伊藤随机微分方程 (SDE)：\n$$\n\\mathrm{d}Z(t) = a(Z(t))\\,\\mathrm{d}t + \\sqrt{2\\,K(Z(t))}\\,\\mathrm{d}W(t)\n$$\n其对应的福克-普朗克方程 (FPE) 描述了粒子概率密度（或浓度）$C(z,t)$ 的演化。该 SDE 的漂移项为 $a(z)$，而扩散项系数为 $\\sigma(z) = \\sqrt{2K(z)}$。福克-普朗克方程中的扩散系数为 $D(z) = \\frac{1}{2}\\sigma^2(z) = K(z)$。因此，FPE 的形式为：\n$$\n\\frac{\\partial C(z,t)}{\\partial t} = -\\frac{\\partial}{\\partial z}\\left[a(z)C(z,t)\\right] + \\frac{\\partial^2}{\\partial z^2}\\left[K(z)C(z,t)\\right]\n$$\n此方程可以表示为连续性方程 $\\frac{\\partial C}{\\partial t} = -\\frac{\\partial J}{\\partial z}$，其中粒子通量 $J(z,t)$ 为：\n$$\nJ(z,t) = a(z)C(z,t) - \\frac{\\partial}{\\partial z}\\left[K(z)C(z,t)\\right]\n$$\n问题要求一个稳态、空间均匀的平衡浓度，即 $\\frac{\\partial C}{\\partial t} = 0$ 且 $C(z,t) = C_{\\infty}(z) = C_0$（一个常数）。\n在稳态条件下 ($\\frac{\\partial C}{\\partial t} = 0$)，通量 $J$ 必须在空间上是恒定的。由于系统中没有源或汇，并且边界效应可以忽略，唯一的物理一致解是净通量为零，即 $J(z) = 0$。\n\n将 $J(z) = 0$ 和 $C(z) = C_0$ 代入通量方程：\n$$\na(z)C_0 - \\frac{\\mathrm{d}}{\\mathrm{d}z}\\left[K(z)C_0\\right] = 0\n$$\n由于 $C_0$ 是一个非零常数，我们可以从导数中将其提出并消去：\n$$\na(z)C_0 - C_0\\frac{\\mathrm{d}K(z)}{\\mathrm{d}z} = 0\n$$\n$$\na(z) = \\frac{\\mathrm{d}K(z)}{\\mathrm{d}z}\n$$\n这就是“适混条件”或“均匀混合条件”。它规定，为确保在非均匀扩散中保持均匀浓度，必须在伊藤 SDE 中引入一个等于扩散系数梯度的附加漂移项。\n\n现在，我们将此一般结果应用于给定的涡动扩散系数剖面 $K(z) = K_0(1+\\alpha z)$：\n$$\na(z) = \\frac{\\mathrm{d}}{\\mathrm{d}z} \\left[ K_0(1+\\alpha z) \\right]\n$$\n计算导数：\n$$\na(z) = K_0 \\frac{\\mathrm{d}}{\\mathrm{d}z} (1+\\alpha z) = K_0 (0 + \\alpha) = \\alpha K_0\n$$\n因此，为维持均匀平衡浓度，所需的漂移项是一个常数 $a(z) = \\alpha K_0$。",
            "answer": "$$\n\\boxed{\\alpha K_{0}}\n$$"
        },
        {
            "introduction": "拉格朗日模型不仅是用于正向预测（污染物将去往何处？）的强大工具，也适用于反演建模（它们来自何处？）。本次实践将 LPDM 的输出应用于一项高级应用：源估算。你将利用 LPDM 预先计算出的源-受体关系，结合统计学原理，从带有噪声的浓度测量数据中估算未知的排放率，并量化估算结果的不确定性。",
            "id": "3886854",
            "problem": "考虑一个被动示踪剂的单一、稳定点源排放，其排放速率恒为 $Q$（单位：$\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。一个拉格朗日粒子扩散模型 (LPDM) 预先计算了特定于受体的源-受体传输系数（足迹），因此受体 $i$ 处的时间平均浓度与 $Q$ 通过 $y_i = G_i \\, Q + \\epsilon_i$ 呈线性关系，其中 $G_i$（单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 每 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$）是受体 $i$ 的足迹，$\\epsilon_i$ 是测量误差。假设误差 $\\epsilon_i$ 是独立同分布的高斯随机变量，均值为零，标准差 $\\sigma_i$ 已知（单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$），且测量值 $y_i$ 以 $\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 为单位报告。利用 $\\epsilon_i$ 的独立性和高斯性以及 LPDM 映射 $Q \\mapsto y_i$ 的线性性，从第一性原理推导 $Q$ 的最大似然估计量，并在相同的高斯假设下对该估计进行不确定性量化。\n\n您的程序必须：\n- 使用具有可能异构的 $\\sigma_i$ 的 $N$ 个受体的一般情况，实现推导出的估计量和相关的不确定性量化。\n- 对于每个测试用例，返回四个量：\n    1. $Q$ 的点估计值（单位：$\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n    2. 假设平坦先验的 $Q$ 的后验标准差（单位：$\\mathrm{kg} \\, \\mathrm{s}^{-1}$），在高斯误差下，这等于从似然曲率导出的估计量的标准差。\n    3. 在高斯后验下，$Q$ 的双边 $0.95$ 可信区间的下端点（单位：$\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n    4. 同一可信区间的上端点（单位：$\\mathrm{kg} \\, \\mathrm{s}^{-1}$）。\n- 使用标准正态分位数 $z_{0.975}$ 构建双边 $0.95$ 区间。\n- 所有结果均以 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$ 表示。\n- 生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，并按上述顺序将所有测试用例的结果展平。例如，对于三个测试用例，输出应为 $[q_1,\\mathrm{sd}_1,\\mathrm{low}_1,\\mathrm{high}_1,q_2,\\mathrm{sd}_2,\\mathrm{low}_2,\\mathrm{high}_2,q_3,\\mathrm{sd}_3,\\mathrm{low}_3,\\mathrm{high}_3]$ 的形式。\n\n测试套件：\n- 案例 A（理想路径，中等信号和等量不确定性）：\n    - $G = [0.80, 1.10, 0.95]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 每 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [0.88, 1.12, 0.97]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.05, 0.05, 0.05]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n- 案例 B（边界情况，足迹非常小和等量不确定性）：\n    - $G = [0.010, 0.020, 0.015]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 每 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [0.008, 0.023, 0.012]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.005, 0.005, 0.005]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n- 案例 C（边缘情况，不确定性异构且因噪声导致一个负测量值）：\n    - $G = [0.30, 0.20, 0.40, 0.50]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$ 每 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$，\n    - $y = [-0.01, 0.08, 0.15, 0.24]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$，\n    - $\\sigma = [0.05, 0.04, 0.06, 0.05]$，单位：$\\mathrm{mg} \\, \\mathrm{m}^{-3}$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，并按 $[q_A,\\mathrm{sd}_A,\\mathrm{low}_A,\\mathrm{high}_A,q_B,\\mathrm{sd}_B,\\mathrm{low}_B,\\mathrm{high}_B,q_C,\\mathrm{sd}_C,\\mathrm{low}_C,\\mathrm{high}_C]$ 的顺序排列，其中下标表示案例。所有数字的单位必须是 $\\mathrm{kg} \\, \\mathrm{s}^{-1}$。",
            "solution": "本问题要求基于一组 $N$ 个受体处的浓度测量值 $\\{y_i\\}$ 来推断单一源的排放速率 $Q$。连接源和受体的模型是线性的：\n$$ y_i = G_i Q + \\epsilon_i $$\n其中 $y_i$ 是测量浓度，$G_i$ 是已知的源-受体传输系数（足迹），$Q$ 是未知的排放速率。测量误差 $\\epsilon_i$ 是独立的随机变量，服从均值为零、标准差为 $\\sigma_i$ 的高斯分布，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_i^2)$。注意，由于标准差 $\\sigma_i$ 可能因受体而异，因此误差是独立但非同分布的。\n\n基于此，测量值 $y_i$ 本身也是一个高斯随机变量，其均值为 $G_i Q$，方差为 $\\sigma_i^2$：\n$$ y_i \\sim \\mathcal{N}(G_i Q, \\sigma_i^2) $$\n因此，在给定 $Q$ 的情况下，观测到单个测量值 $y_i$ 的概率密度函数 (PDF) 为：\n$$ p(y_i | Q) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - G_i Q)^2}{2\\sigma_i^2}\\right) $$\n    \n### 1. 最大似然估计 (Maximum Likelihood Estimation, MLE)\n\n似然函数 $L(Q)$ 是观测到整组测量值 $\\{y_i\\}_{i=1}^N$ 的联合概率。由于测量值是独立的，似然函数是各个 PDF 的乘积：\n$$ L(Q) = \\prod_{i=1}^{N} p(y_i | Q) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - G_i Q)^2}{2\\sigma_i^2}\\right) $$\n为求 $L(Q)$ 的最大值，我们转而最大化其对数似然函数 $\\mathcal{L}(Q) = \\ln(L(Q))$：\n$$ \\mathcal{L}(Q) = \\sum_{i=1}^{N} \\left[ -\\ln(\\sqrt{2\\pi\\sigma_i^2}) - \\frac{(y_i - G_i Q)^2}{2\\sigma_i^2} \\right] = C - \\frac{1}{2} \\sum_{i=1}^{N} \\frac{(y_i - G_i Q)^2}{\\sigma_i^2} $$\n其中 $C$ 是与 $Q$ 无关的常数。最大化 $\\mathcal{L}(Q)$ 等价于最小化加权残差平方和 $\\chi^2(Q) = \\sum_{i=1}^{N} w_i (y_i - G_i Q)^2$，其中权重为 $w_i = 1/\\sigma_i^2$。\n\n对 $\\mathcal{L}(Q)$ 求关于 $Q$ 的导数并令其为零，以找到估计值 $\\hat{Q}$：\n$$ \\frac{d\\mathcal{L}(Q)}{dQ} = \\sum_{i=1}^{N} \\frac{G_i(y_i - G_i Q)}{\\sigma_i^2} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{G_i y_i}{\\sigma_i^2} = \\hat{Q} \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} $$\n解出 $\\hat{Q}$，得到最大似然估计量：\n$$ \\hat{Q} = \\frac{\\sum_{i=1}^{N} (G_i y_i / \\sigma_i^2)}{\\sum_{i=1}^{N} (G_i^2 / \\sigma_i^2)} $$\n这个估计量是各受体单独估计值 $y_i/G_i$ 的加权平均，权重与信噪比的平方 $(G_i/\\sigma_i)^2$ 成正比。\n\n### 2. 不确定性量化\n\n在贝叶斯框架下，假设 $Q$ 的先验分布是平坦的（$p(Q) \\propto 1$），则后验分布 $p(Q|\\{y_i\\})$ 正比于似然函数 $L(Q)$。由于对数似然 $\\mathcal{L}(Q)$ 是 $Q$ 的二次函数，后验分布是一个高斯分布，其均值为 MLE 估计值 $\\hat{Q}$。\n\n后验分布的方差 $\\sigma_Q^2$ 可通过对数似然函数在其最大值处的曲率求得（即费雪信息量的倒数）：\n$$ \\sigma_Q^2 = \\left( - \\frac{d^2\\mathcal{L}(Q)}{dQ^2} \\bigg|_{Q=\\hat{Q}} \\right)^{-1} $$\n计算二阶导数：\n$$ \\frac{d^2\\mathcal{L}(Q)}{dQ^2} = \\frac{d}{dQ} \\left( \\sum_{i=1}^{N} \\frac{G_i y_i}{\\sigma_i^2} - Q \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right) = - \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} $$\n因此，后验方差为：\n$$ \\sigma_Q^2 = \\left( \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right)^{-1} $$\n后验标准差 $\\sigma_Q$ 是其平方根：\n$$ \\sigma_Q = \\left( \\sum_{i=1}^{N} \\frac{G_i^2}{\\sigma_i^2} \\right)^{-1/2} $$\n\n### 3. 可信区间\n\n$Q$ 的后验分布为高斯分布 $\\mathcal{N}(\\hat{Q}, \\sigma_Q^2)$。一个双边 $95\\%$ 的可信区间由下式给出：\n$$ [ \\hat{Q} - z_{0.975} \\cdot \\sigma_Q, \\quad \\hat{Q} + z_{0.975} \\cdot \\sigma_Q ] $$\n其中 $z_{0.975} \\approx 1.95996$ 是标准正态分布的第 $97.5$ 百分位数。\n\n针对每个测试用例，将使用这些公式计算所需的四个量：$\\hat{Q}$、$\\sigma_Q$、区间的下限和上限。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Derives the maximum likelihood estimate for a single emission source Q,\n    its uncertainty, and credible interval, based on a linear receptor model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (G_values, y_values, sigma_values)\n    test_cases = [\n        # Case A (happy path, moderate signals and equal uncertainties)\n        ([0.80, 1.10, 0.95], [0.88, 1.12, 0.97], [0.05, 0.05, 0.05]),\n        # Case B (boundary-leaning case with very small footprints and equal uncertainties)\n        ([0.010, 0.020, 0.015], [0.008, 0.023, 0.012], [0.005, 0.005, 0.005]),\n        # Case C (edge case with heterogeneous uncertainties and one negative measurement)\n        ([0.30, 0.20, 0.40, 0.50], [-0.01, 0.08, 0.15, 0.24], [0.05, 0.04, 0.06, 0.05]),\n    ]\n\n    all_results = []\n    \n    # Pre-calculate the standard normal quantile for a two-sided 95% interval.\n    # This corresponds to the 97.5th percentile.\n    z_0975 = norm.ppf(0.975)\n\n    for G_vals, y_vals, sigma_vals in test_cases:\n        # Convert lists to NumPy arrays for vectorized operations.\n        G = np.array(G_vals)\n        y = np.array(y_vals)\n        sigma = np.array(sigma_vals)\n\n        # The weights for the weighted least squares are the inverse variances.\n        weights = 1.0 / sigma**2\n\n        # Calculate the terms for the MLE of Q.\n        # This is equivalent to Q_hat = (G' W y) / (G' W G) in matrix notation,\n        # where W is the weight matrix.\n        numerator = np.sum(weights * G * y)\n        denominator = np.sum(weights * G**2)\n\n        # 1. Point estimate of Q (kg/s)\n        q_hat = numerator / denominator\n\n        # The denominator is also the Fisher Information, or the inverse variance of Q.\n        # 2. Posterior standard deviation of Q (kg/s)\n        var_q = 1.0 / denominator\n        std_q = np.sqrt(var_q)\n\n        # Calculate the half-width of the credible interval.\n        interval_half_width = z_0975 * std_q\n\n        # 3. Lower endpoint of the 95% credible interval for Q (kg/s)\n        q_lower = q_hat - interval_half_width\n        \n        # 4. Upper endpoint of the 95% credible interval for Q (kg/s)\n        q_upper = q_hat + interval_half_width\n        \n        # Append the four required quantities for this case to the final list.\n        all_results.extend([q_hat, std_q, q_lower, q_upper])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}