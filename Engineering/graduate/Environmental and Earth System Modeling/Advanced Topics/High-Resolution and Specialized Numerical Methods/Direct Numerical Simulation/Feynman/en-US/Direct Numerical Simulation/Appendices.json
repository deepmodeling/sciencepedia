{
    "hands_on_practices": [
        {
            "introduction": "Direct Numerical Simulation earns its name by resolving the full range of spatial and temporal scales in a turbulent flow. The first step in planning any DNS is to determine the size of the smallest scales, which dictates the required grid resolution and time step. This exercise guides you through the foundational principles of Kolmogorov's turbulence theory to estimate these microscales from the large-scale, energy-containing motions of the flow. By working through this problem (), you will gain a concrete understanding of how the characteristics of the largest eddies determine the immense resolution demands at the smallest end of the spectrum.",
            "id": "3874580",
            "problem": "A research team is preparing a Direct Numerical Simulation (DNS) of homogeneous, isotropic turbulence representative of small-scale ocean mixing. The fluid is seawater with kinematic viscosity $\\nu$ equal to $1.0 \\times 10^{-6}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$. The large-scale root-mean-square velocity and integral length are $U = 0.2$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and $L = 0.5$ $\\mathrm{m}$, respectively. Assume a statistically steady, high Reynolds number flow so that a forward energy cascade is well established. \n\nStarting from the incompressible Navier–Stokes equations and the kinetic energy balance, and invoking Kolmogorov similarity for the inertial cascade, derive the scaling of the mean dissipation rate $\\epsilon$ at the large scale in terms of $U$ and $L$, then use dimensional analysis to obtain expressions for the Kolmogorov microscales: the Kolmogorov length scale $\\eta$, time scale $\\tau_{\\eta}$, and velocity scale $u_{\\eta}$, expressed in terms of $\\nu$ and $\\epsilon$. For the DNS resolution criteria, impose the constraints that the grid spacing $\\Delta x$ resolves the Kolmogorov length and the time step $\\Delta t$ resolves the Kolmogorov time with a safety factor $c=1$, that is, set $\\Delta x = c\\,\\eta$ and $\\Delta t = c\\,\\tau_{\\eta}$ with $c=1$.\n\nUsing the given $U$, $L$, and $\\nu$, compute numerical values for $\\eta$, $\\tau_{\\eta}$, $u_{\\eta}$, $\\Delta x$, and $\\Delta t$. Round each value to four significant figures. Express $\\eta$ and $\\Delta x$ in meters, $\\tau_{\\eta}$ and $\\Delta t$ in seconds, and $u_{\\eta}$ in meters per second. The final answer must be a single row matrix containing these five numbers in the order $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard problem in the theory of turbulence and its numerical simulation, providing all necessary information for a unique solution.\n\nThe problem requires a two-part derivation followed by a numerical calculation. First, we derive the scaling for the mean turbulent kinetic energy dissipation rate, $\\epsilon$. Second, we derive the expressions for the Kolmogorov microscales. Finally, we compute the numerical values for these scales and the corresponding DNS grid parameters.\n\nThe starting point is the energy balance in statistically steady, homogeneous turbulence. The rate of production of turbulent kinetic energy per unit mass, $P$, at the large, energy-containing scales of motion must balance the rate of viscous dissipation, $\\epsilon$, at the small, dissipative scales. This is expressed as $P = \\epsilon$. The production rate $P$ is determined by the dynamics of the large eddies. The characteristic velocity of these eddies is the root-mean-square velocity, $U$, and their characteristic size is the integral length scale, $L$. The characteristic time scale for the large eddies, known as the eddy turnover time, is $T_L \\sim L/U$. The kinetic energy per unit mass at these scales is of the order $k \\sim U^2$. The rate at which this energy is transferred down the cascade is the energy divided by the characteristic time, so $P \\sim k/T_L$. Substituting the scalings for $k$ and $T_L$ gives the production rate scaling:\n$$ P \\sim \\frac{U^2}{L/U} = \\frac{U^3}{L} $$\nIn the statistically steady state, this production rate is equal to the dissipation rate, $\\epsilon$. Therefore, the scaling for the mean dissipation rate is:\n$$ \\epsilon \\propto \\frac{U^3}{L} $$\nFor order-of-magnitude estimates, we assume the constant of proportionality is unity, yielding $\\epsilon \\approx \\frac{U^3}{L}$.\n\nNext, we use dimensional analysis to derive the Kolmogorov microscales. According to Kolmogorov's first similarity hypothesis, the small-scale turbulent motions are universally and uniquely determined by the dissipation rate $\\epsilon$ and the kinematic viscosity $\\nu$. Their dimensions are $[\\epsilon] = L^2 T^{-3}$ and $[\\nu] = L^2 T^{-1}$.\n\n1.  The Kolmogorov length scale, $\\eta$, is found by combining $\\epsilon$ and $\\nu$ to obtain a quantity with dimensions of length, $[L]$. We set $\\eta = \\epsilon^a \\nu^b$. In terms of dimensions:\n    $$ [L]^1 [T]^0 = (L^2 T^{-3})^a (L^2 T^{-1})^b = L^{2a+2b} T^{-3a-b} $$\n    This leads to a system of linear equations for the exponents $a$ and $b$:\n    $$ \\begin{cases} 2a + 2b = 1 \\\\ -3a - b = 0 \\end{cases} $$\n    From the second equation, $b = -3a$. Substituting into the first equation gives $2a + 2(-3a) = 1$, which simplifies to $-4a = 1$, so $a = -1/4$. Consequently, $b = -3(-1/4) = 3/4$. The expression for the Kolmogorov length scale is:\n    $$ \\eta = \\epsilon^{-1/4} \\nu^{3/4} = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4} $$\n\n2.  The Kolmogorov time scale, $\\tau_{\\eta}$, is found by forming a quantity with dimensions of time, $[T]$. We set $\\tau_{\\eta} = \\epsilon^a \\nu^b$.\n    $$ [L]^0 [T]^1 = L^{2a+2b} T^{-3a-b} $$\n    This gives the system:\n    $$ \\begin{cases} 2a + 2b = 0 \\\\ -3a - b = 1 \\end{cases} $$\n    From the first equation, $b = -a$. Substituting into the second gives $-3a - (-a) = 1$, which simplifies to $-2a = 1$, so $a = -1/2$. Consequently, $b = 1/2$. The expression for the Kolmogorov time scale is:\n    $$ \\tau_{\\eta} = \\epsilon^{-1/2} \\nu^{1/2} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2} $$\n\n3.  The Kolmogorov velocity scale, $u_{\\eta}$, can be found dimensionally or simply by taking the ratio $u_{\\eta} = \\eta / \\tau_{\\eta}$. Using the latter:\n    $$ u_{\\eta} = \\frac{(\\nu^3/\\epsilon)^{1/4}}{(\\nu/\\epsilon)^{1/2}} = \\frac{\\nu^{3/4}\\epsilon^{-1/4}}{\\nu^{1/2}\\epsilon^{-1/2}} = \\nu^{3/4 - 1/2} \\epsilon^{-1/4 - (-1/2)} = \\nu^{1/4} \\epsilon^{1/4} $$\n    The expression for the Kolmogorov velocity scale is:\n    $$ u_{\\eta} = (\\nu\\epsilon)^{1/4} $$\n\nNow, we compute the numerical values using the given data: $U = 0.2 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$, $L = 0.5 \\, \\mathrm{m}$, and $\\nu = 1.0 \\times 10^{-6} \\, \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n\nFirst, we calculate the dissipation rate $\\epsilon$:\n$$ \\epsilon = \\frac{U^3}{L} = \\frac{(0.2 \\, \\mathrm{m}\\,\\mathrm{s}^{-1})^3}{0.5 \\, \\mathrm{m}} = \\frac{0.008 \\, \\mathrm{m}^3\\,\\mathrm{s}^{-3}}{0.5 \\, \\mathrm{m}} = 0.016 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-3} $$\n\nUsing this value for $\\epsilon$ and the given $\\nu$, we compute the Kolmogorov scales:\n-   $\\eta = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6})^3}{0.016}\\right)^{1/4} = \\left(\\frac{1.0 \\times 10^{-18}}{1.6 \\times 10^{-2}}\\right)^{1/4} = (6.25 \\times 10^{-17})^{1/4} \\approx 8.89552 \\times 10^{-5} \\, \\mathrm{m}$.\n    Rounding to four significant figures, $\\eta \\approx 8.896 \\times 10^{-5} \\, \\mathrm{m}$.\n-   $\\tau_{\\eta} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2} = \\left(\\frac{1.0 \\times 10^{-6}}{0.016}\\right)^{1/2} = (6.25 \\times 10^{-5})^{1/2} \\approx 7.90569 \\times 10^{-3} \\, \\mathrm{s}$.\n    Rounding to four significant figures, $\\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\mathrm{s}$.\n-   $u_{\\eta} = (\\nu\\epsilon)^{1/4} = ((1.0 \\times 10^{-6})(0.016))^{1/4} = (1.6 \\times 10^{-8})^{1/4} \\approx 0.0112468 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n    Rounding to four significant figures, $u_{\\eta} \\approx 0.01125 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$, which is $1.125 \\times 10^{-2} \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nFinally, we determine the DNS resolution parameters according to the problem constraints: $\\Delta x = c\\,\\eta$ and $\\Delta t = c\\,\\tau_{\\eta}$ with the safety factor $c=1$.\n-   Grid spacing: $\\Delta x = 1 \\times \\eta \\approx 8.896 \\times 10^{-5} \\, \\mathrm{m}$.\n-   Time step: $\\Delta t = 1 \\times \\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\mathrm{s}$.\n\nThe five required numerical values, in the specified order $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$ and rounded to four significant figures, are: $(8.896 \\times 10^{-5}, 7.906 \\times 10^{-3}, 1.125 \\times 10^{-2}, 8.896 \\times 10^{-5}, 7.906 \\times 10^{-3})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.896 \\times 10^{-5} & 7.906 \\times 10^{-3} & 1.125 \\times 10^{-2} & 8.896 \\times 10^{-5} & 7.906 \\times 10^{-3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After estimating the necessary grid resolution from turbulence theory, the next critical question is a practical one: \"Is this simulation computationally feasible?\" The notoriously high cost of DNS is its primary limitation, scaling severely with the Reynolds number. This practice provides a realistic feasibility study (), translating the theoretical resolution requirements into tangible demands for computer memory and processing time. By assessing these demands against a typical set of hardware constraints, you will develop an appreciation for the trade-offs involved and understand why DNS remains a tool for fundamental research at moderate Reynolds numbers.",
            "id": "3874556",
            "problem": "Consider a turbulent mixing patch representative of an estuarine shear layer in water. The domain is a cube of side length $L = 1\\,\\mathrm{m}$ with characteristic velocity $U = 0.1\\,\\mathrm{m\\,s^{-1}}$, and the kinematic viscosity of water is $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$. The target Reynolds number is therefore $Re = UL/\\nu$. You wish to assess the feasibility of performing a Direct Numerical Simulation (DNS), defined as resolving all dynamically relevant scales down to the Kolmogorov microscales, starting from the following well-tested foundations: the energy dissipation rate scaling $\\epsilon \\sim U^{3}/L$ and the Kolmogorov scales $\\eta = (\\nu^{3}/\\epsilon)^{1/4}$ and $\\tau_{\\eta} = (\\nu/\\epsilon)^{1/2}$. Assume an explicit time integrator constrained by an advective Courant–Friedrichs–Lewy (CFL) condition with CFL number $C_{\\mathrm{CFL}} = 0.5$, such that the stable time step scales as $\\Delta t \\approx C_{\\mathrm{CFL}}\\,\\eta/U$. The DNS will be advanced for a physical time horizon equal to $5$ large-eddy turnover times, where the turnover time is $T = L/U$.\n\nThe computational method is a standard finite-volume incompressible Navier–Stokes solver storing $12$ double-precision ($8$ bytes each) arrays per grid point (to account for three velocity components, pressure, and working arrays), giving an effective storage of $b_{\\mathrm{eff}} = 96\\,\\mathrm{bytes}$ per grid point. The per time-step floating-point work is $C_{\\mathrm{op}} = 2000$ floating-point operations per grid point. You have access to a distributed-memory cluster of $16$ nodes, each with $256\\,\\mathrm{GB}$ of memory, and a sustained per-node performance of $2.5 \\times 10^{12}$ floating-point operations per second. The total available wall-clock runtime budget is $48\\,\\mathrm{h}$. Take $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$ and $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$ for memory conversion.\n\nUsing only the foundations and definitions above, proceed as follows:\n\n- Derive the Kolmogorov length scale $\\eta$ and use it as the DNS grid spacing, with the number of grid points estimated by $N \\approx (L/\\eta)^{3}$.\n- Determine the required memory $M_{\\mathrm{req}} = b_{\\mathrm{eff}} N$ and compare it to the available memory $M_{\\mathrm{avail}}$.\n- Using the CFL constraint, compute $\\Delta t$, the number of time steps $n_{\\mathrm{steps}}$ to reach the target horizon $5T$, and the total floating-point work $W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}}$. Convert $W_{\\mathrm{tot}}$ to a required runtime $t_{\\mathrm{req}}$ using the cluster’s total sustained performance; compare to the available runtime $t_{\\mathrm{avail}}$.\n- Define the feasibility index $F$ as $F = \\min\\!\\left(M_{\\mathrm{avail}}/M_{\\mathrm{req}},\\; t_{\\mathrm{avail}}/t_{\\mathrm{req}}\\right)$ and compute its value.\n\nFinally, interpret the computed feasibility index $F$ physically and, in words, discuss the trade-offs relative to Large Eddy Simulation (LES), including how choosing a filter scale larger than $\\eta$ changes the grid, time-step, and total cost scaling with $Re$.\n\nReport the final feasibility index as a single dimensionless number. Round your answer to three significant figures.",
            "solution": "The problem statement is found to be valid. It is scientifically grounded in the principles of turbulence theory and computational fluid dynamics, well-posed, objective, and internally consistent. We can therefore proceed with the solution by following the prescribed steps.\n\nFirst, we calculate the characteristic dimensionless numbers and physical scales for the specified turbulent flow. The Reynolds number, $Re$, is a measure of the ratio of inertial forces to viscous forces:\n$$Re = \\frac{UL}{\\nu} = \\frac{(0.1\\,\\mathrm{m\\,s^{-1}})(1\\,\\mathrm{m})}{1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}} = 100,000 = 10^{5}$$\nThis is a high Reynolds number, confirming the flow is turbulent.\n\nNext, we estimate the mean rate of viscous dissipation of turbulent kinetic energy per unit mass, $\\epsilon$. Using the provided scaling for high-Reynolds-number turbulence:\n$$\\epsilon \\sim \\frac{U^{3}}{L} = \\frac{(0.1\\,\\mathrm{m\\,s^{-1}})^{3}}{1\\,\\mathrm{m}} = 10^{-3}\\,\\mathrm{m^{2}\\,s^{-3}}$$\n\nThe Direct Numerical Simulation (DNS) requires resolving the smallest scales of turbulence, the Kolmogorov microscales. The Kolmogorov length scale, $\\eta$, is the characteristic size of the smallest eddies where viscosity dominates and energy is dissipated into heat. It is calculated as:\n$$\\eta = \\left(\\frac{\\nu^{3}}{\\epsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}})^{3}}{10^{-3}\\,\\mathrm{m^{2}\\,s^{-3}}}\\right)^{1/4} = \\left(\\frac{10^{-18}}{10^{-3}}\\right)^{1/4} = (10^{-15})^{1/4} = 10^{-3.75}\\,\\mathrm{m}$$\n\nTo perform a DNS, the computational grid must have a spacing, $\\Delta x$, on the order of $\\eta$. Assuming an isotropic grid where $\\Delta x = \\Delta y = \\Delta z = \\eta$, the total number of grid points, $N$, required to fill the cubic domain of side length $L$ is:\n$$N \\approx \\left(\\frac{L}{\\eta}\\right)^{3} = \\left(\\frac{1\\,\\mathrm{m}}{10^{-3.75}\\,\\mathrm{m}}\\right)^{3} = (10^{3.75})^{3} = 10^{11.25}$$\n\nNow, we assess the computational resource requirements, starting with memory. The total required memory, $M_{\\mathrm{req}}$, is the product of the number of grid points and the effective storage per point, $b_{\\mathrm{eff}}$:\n$$M_{\\mathrm{req}} = b_{\\mathrm{eff}} N = (96\\,\\mathrm{bytes}) \\times 10^{11.25} \\approx 96 \\times (1.77828 \\times 10^{11})\\,\\mathrm{bytes} \\approx 1.7071 \\times 10^{13}\\,\\mathrm{bytes}$$\nUsing the conversion $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$, this is approximately $17.07\\,\\mathrm{TB}$.\n\nThe total available memory, $M_{\\mathrm{avail}}$, on the cluster is:\n$$M_{\\mathrm{avail}} = (\\text{Number of nodes}) \\times (\\text{Memory per node}) = 16 \\times 256\\,\\mathrm{GB} = 4096\\,\\mathrm{GB} = 4.096 \\times 10^{12}\\,\\mathrm{bytes}$$\nThis is $4.096\\,\\mathrm{TB}$. The ratio of available to required memory is:\n$$\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}} = \\frac{4.096 \\times 10^{12}\\,\\mathrm{bytes}}{1.7071 \\times 10^{13}\\,\\mathrm{bytes}} \\approx 0.2399$$\n\nNext, we evaluate the computational time requirement. The simulation must run for a physical time of $5$ large-eddy turnover times. The large-eddy turnover time, $T$, is:\n$$T = \\frac{L}{U} = \\frac{1\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 10\\,\\mathrm{s}$$\nThe total simulation time horizon is $T_{\\mathrm{sim}} = 5T = 50\\,\\mathrm{s}$.\n\nThe time step, $\\Delta t$, is constrained by the advective Courant–Friedrichs–Lewy (CFL) condition:\n$$\\Delta t \\approx C_{\\mathrm{CFL}}\\frac{\\eta}{U} = 0.5 \\times \\frac{10^{-3.75}\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 5 \\times 10^{-3.75}\\,\\mathrm{s}$$\nThe total number of time steps, $n_{\\mathrm{steps}}$, required to reach the time horizon is:\n$$n_{\\mathrm{steps}} = \\frac{T_{\\mathrm{sim}}}{\\Delta t} = \\frac{50\\,\\mathrm{s}}{5 \\times 10^{-3.75}\\,\\mathrm{s}} = 10 \\times 10^{3.75} = 10^{4.75}$$\n\nThe total floating-point work, $W_{\\mathrm{tot}}$, is the product of operations per grid point per time step, the number of grid points, and the number of time steps:\n$$W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}} = (2000) \\times (10^{11.25}) \\times (10^{4.75}) = 2 \\times 10^{3} \\times 10^{16} = 2 \\times 10^{19}\\,\\text{FLOP}$$\n\nThe total sustained performance of the cluster, $P_{\\mathrm{tot}}$, is:\n$$P_{\\mathrm{tot}} = (\\text{Number of nodes}) \\times (\\text{Performance per node}) = 16 \\times (2.5 \\times 10^{12}\\,\\mathrm{FLOP/s}) = 40 \\times 10^{12}\\,\\mathrm{FLOP/s} = 4 \\times 10^{13}\\,\\mathrm{FLOP/s}$$\nThe required wall-clock time, $t_{\\mathrm{req}}$, is the total work divided by the total performance:\n$$t_{\\mathrm{req}} = \\frac{W_{\\mathrm{tot}}}{P_{\\mathrm{tot}}} = \\frac{2 \\times 10^{19}\\,\\mathrm{FLOP}}{4 \\times 10^{13}\\,\\mathrm{FLOP/s}} = 0.5 \\times 10^{6}\\,\\mathrm{s}$$\nThe available wall-clock time, $t_{\\mathrm{avail}}$, is $48$ hours. We convert this to seconds:\n$$t_{\\mathrm{avail}} = 48\\,\\mathrm{h} \\times \\frac{3600\\,\\mathrm{s}}{1\\,\\mathrm{h}} = 172,800\\,\\mathrm{s} = 1.728 \\times 10^{5}\\,\\mathrm{s}$$\nThe ratio of available to required time is:\n$$\\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}} = \\frac{1.728 \\times 10^{5}\\,\\mathrm{s}}{0.5 \\times 10^{6}\\,\\mathrm{s}} = 0.3456$$\n\nThe feasibility index, $F$, is the minimum of these two resource ratios:\n$$F = \\min\\!\\left(\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}},\\; \\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}}\\right) = \\min(0.2399, 0.3456) \\approx 0.2399$$\nRounding to three significant figures, the feasibility index is $0.240$.\n\nA feasibility index $F < 1$ indicates that the simulation is not possible with the available resources. In this case, $F \\approx 0.240$ implies the project is severely under-resourced. The primary bottleneck is memory, as the available memory is only about $24\\%$ of what is required. The available compute time is about $35\\%$ of the required total. To make this DNS feasible, one would need a machine with at least $1/0.2399 \\approx 4.17$ times the memory and enough processing power to complete the run in the allotted time, which would require the total performance to also increase by a factor of $1/0.3456 \\approx 2.89$.\n\nThis high cost motivates alternative approaches like Large Eddy Simulation (LES). In DNS, the grid spacing must scale with the Kolmogorov scale, $\\Delta x_{\\mathrm{DNS}} \\sim \\eta \\sim Re^{-3/4}$, leading to a total number of grid points $N_{\\mathrm{DNS}} \\sim (L/\\eta)^3 \\sim Re^{9/4}$. The time step, based on the smallest eddy turnover, scales as $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/u_{\\eta} \\sim Re^{-1/2}$ or, as assumed in this problem with a constant large-eddy velocity, $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/U \\sim Re^{-3/4}$. This results in a total computational cost scaling as $W_{\\mathrm{DNS}} \\sim N_{\\mathrm{DNS}} \\times n_{\\mathrm{steps}} \\sim Re^{9/4} \\times Re^{3/4} = Re^{3}$. This explosive growth with $Re$ makes DNS impractical for most high-$Re$ flows. In LES, one chooses a filter scale $\\Delta$ (which becomes the effective grid spacing) such that $\\eta \\ll \\Delta \\ll L$. Only eddies larger than $\\Delta$ are resolved, while the effects of smaller, sub-grid scales are modeled. The number of grid points, $N_{\\mathrm{LES}} \\approx (L/\\Delta)^3$, is determined by the choice of $\\Delta$. If $\\Delta$ is chosen as a fixed fraction of $L$, $N_{\\mathrm{LES}}$ becomes independent of $Re$. The CFL-limited time step is now $\\Delta t_{\\mathrm{LES}} \\sim \\Delta/U$, which is also independent of $Re$ and much larger than $\\Delta t_{\\mathrm{DNS}}$. Consequently, the total cost of an LES, $W_{\\mathrm{LES}}$, scales much more weakly with $Re$ (ideally, it is independent of $Re$ for a fixed $\\Delta/L$). This drastic reduction in computational cost is the primary advantage of LES. The trade-off is the introduction of modeling error via the sub-grid scale model, which must accurately represent the energy transfer from resolved to unresolved scales. In contrast, DNS is free of modeling assumptions and is considered a numerically \"exact\" solution to the Navier-Stokes equations, limited only by discretization and round-off errors.",
            "answer": "$$\\boxed{0.240}$$"
        },
        {
            "introduction": "Many flows in environmental and earth systems, such as ocean currents or atmospheric boundary layers, can be modeled as incompressible. A core challenge in any numerical solver for these systems is rigorously enforcing the incompressibility constraint, mathematically stated as $\\nabla \\cdot \\mathbf{u} = 0$. This hands-on coding exercise () delves into the heart of this challenge by having you implement the spectral projection method. You will solve the pressure Poisson equation in Fourier space to project a tentative, non-divergence-free velocity field onto a physically correct, incompressible one, a fundamental building block of modern DNS codes.",
            "id": "3874551",
            "problem": "Consider the projection step used in Direct Numerical Simulation (DNS) of incompressible flow in environmental and earth system modeling. The goal of the projection is to enforce incompressibility by removing the divergence of a tentative velocity field. Starting from the mass conservation law for incompressible flow, which requires $ \\nabla \\cdot \\mathbf{u} = 0 $, and using the idea of a Helmholtz decomposition where a vector field is decomposed into a divergence-free component and a gradient of a scalar potential, construct a numerical solution for the pressure Poisson equation in a periodic box and use it to compute the corrected velocity field that is divergence-free.\n\nYou must implement the following in a single program using a spectral method based on the Fast Fourier Transform (FFT) with periodic boundary conditions:\n\n- Domain: a $ 2 $-dimensional periodic box $ [0, 2\\pi] \\times [0, 2\\pi] $ with uniform grids of $ N \\times N $ points.\n- Trigonometric functions must be evaluated with angles in radians.\n- Given a tentative velocity field $ \\mathbf{u}^{\\ast}(x,y) = (u_x^{\\ast}(x,y), u_y^{\\ast}(x,y)) $ defined on the grid, compute its divergence $ \\nabla \\cdot \\mathbf{u}^{\\ast} $ using spectral differentiation.\n- Solve the pressure Poisson equation in spectral space for a scalar field $ p(x,y) $ such that the corrected velocity $ \\mathbf{u} = \\mathbf{u}^{\\ast} - \\nabla p $ satisfies $ \\nabla \\cdot \\mathbf{u} = 0 $. Use the convention that the mean of $ p $ over the domain is set to $ 0 $ to make the solution unique.\n- Use the $ L^{\\infty} $ norm of the corrected divergence field, defined as $ \\max_{x,y} \\left| \\nabla \\cdot \\mathbf{u}(x,y) \\right| $, to quantify the incompressibility achieved by the projection.\n\nAll quantities are dimensionless. The only angle unit involved is radians and must be used consistently. No physical units are required.\n\nImplement the following test suite. For each case, construct $ \\mathbf{u}^{\\ast} $ as specified, perform the spectral projection, and output the $ L^{\\infty} $ norm of the corrected divergence as a floating-point number.\n\n- Case $ 1 $ (general “happy path”): $ N = 16 $, $ u_x^{\\ast}(x,y) = \\sin(x) $, $ u_y^{\\ast}(x,y) = \\cos(y) $.\n- Case $ 2 $ (already divergence-free field): $ N = 33 $, let $ \\psi(x,y) = \\sin(x)\\sin(y) $, define $ \\mathbf{u}^{\\ast} = \\left(-\\frac{\\partial \\psi}{\\partial y}, \\frac{\\partial \\psi}{\\partial x}\\right) = \\left(-\\cos(y)\\sin(x), \\cos(x)\\sin(y)\\right) $, which has $ \\nabla \\cdot \\mathbf{u}^{\\ast} = 0 $.\n- Case $ 3 $ (multi-mode field): $ N = 64 $, $ u_x^{\\ast}(x,y) = \\sin(3x) + \\frac{1}{2}\\sin(y) $, $ u_y^{\\ast}(x,y) = 2\\sin(2y) - \\sin(x) $.\n- Case $ 4 $ (edge case, trivial field): $ N = 8 $, $ u_x^{\\ast}(x,y) = 0 $, $ u_y^{\\ast}(x,y) = 0 $.\n\nYour program must:\n- Use spectral differentiation to compute $ \\nabla \\cdot \\mathbf{u}^{\\ast} $ and $ \\nabla p $ via FFT and inverse FFT on the periodic domain.\n- Enforce the mean-zero condition for $ p $ by setting the zero Fourier mode to $ 0 $.\n- Return the $ L^{\\infty} $ norm of the corrected divergence for each case as a float.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [result_1, result_2, result_3, result_4] $). Each $ result_i $ must be a floating-point number corresponding to the $ L^{\\infty} $ norm of the corrected divergence for Case $ i $.\n\nNo external input is allowed; all definitions and computations must be self-contained within the program.",
            "solution": "The problem requires the implementation of a spectral projection method to enforce the incompressibility condition on a tentative velocity field in a two-dimensional periodic domain. This is a fundamental step in Direct Numerical Simulation (DNS) of incompressible flows. The solution involves solving the pressure Poisson equation using Fast Fourier Transforms (FFT).\n\nThe core principle is the conservation of mass for an incompressible fluid, which is mathematically expressed as the divergence of the velocity field $ \\mathbf{u} $ being zero:\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\nThe projection method starts with a tentative velocity field $ \\mathbf{u}^{\\ast} $, which is not necessarily divergence-free. This field is then corrected by the gradient of a scalar potential, typically identified with pressure $ p $, to obtain a divergence-free velocity field $ \\mathbf{u} $. The relationship is given by:\n$$ \\mathbf{u} = \\mathbf{u}^{\\ast} - \\nabla p $$\nApplying the divergence operator to this equation and enforcing the incompressibility constraint $ \\nabla \\cdot \\mathbf{u} = 0 $ yields the pressure Poisson equation:\n$$ \\nabla \\cdot (\\mathbf{u}^{\\ast} - \\nabla p) = 0 $$\n$$ \\nabla \\cdot \\mathbf{u}^{\\ast} - \\nabla \\cdot (\\nabla p) = 0 $$\n$$ \\nabla^2 p = \\nabla \\cdot \\mathbf{u}^{\\ast} $$\nwhere $ \\nabla^2 $ is the Laplacian operator. The task is to solve this equation for $ p $ and then use it to find the corrected, divergence-free velocity field. For a periodic domain, this problem is efficiently solved in spectral space.\n\nA function $ f(x,y) $ on the periodic domain $ [0, 2\\pi] \\times [0, 2\\pi] $ can be represented by its discrete Fourier coefficients $ \\hat{f}(k_x, k_y) $. Spatial differentiation in physical space corresponds to algebraic multiplication in Fourier space. Specifically, for a function $ f(x,y) $ and its Fourier transform $ \\hat{f}(k_x, k_y) $:\n$$ \\mathcal{F}\\left(\\frac{\\partial f}{\\partial x}\\right) = i k_x \\hat{f}(k_x, k_y) $$\n$$ \\mathcal{F}\\left(\\frac{\\partial f}{\\partial y}\\right) = i k_y \\hat{f}(k_x, k_y) $$\nwhere $ \\mathcal{F} $ denotes the Fourier transform, and $ k_x, k_y $ are the wavenumbers in the $ x $ and $ y $ directions, respectively. Consequently, the Laplacian operator transforms as:\n$$ \\mathcal{F}(\\nabla^2 f) = \\mathcal{F}\\left(\\frac{\\partial^2 f}{\\partial x^2} + \\frac{\\partial^2 f}{\\partial y^2}\\right) = \\left((i k_x)^2 + (i k_y)^2\\right)\\hat{f}(k_x, k_y) = -(k_x^2 + k_y^2)\\hat{f}(k_x, k_y) $$\nSimilarly, the divergence of a vector field $ \\mathbf{v} = (v_x, v_y) $ transforms as:\n$$ \\mathcal{F}(\\nabla \\cdot \\mathbf{v}) = i k_x \\hat{v}_x(k_x, k_y) + i k_y \\hat{v}_y(k_x, k_y) $$\nApplying the Fourier transform to the pressure Poisson equation, $ \\nabla^2 p = \\nabla \\cdot \\mathbf{u}^{\\ast} $, we get:\n$$ -(k_x^2 + k_y^2) \\hat{p}(k_x, k_y) = i k_x \\hat{u}_x^{\\ast}(k_x, k_y) + i k_y \\hat{u}_y^{\\ast}(k_x, k_y) $$\nThe Fourier coefficients of the pressure, $ \\hat{p} $, can be solved for algebraically:\n$$ \\hat{p}(k_x, k_y) = - \\frac{i k_x \\hat{u}_x^{\\ast} + i k_y \\hat{u}_y^{\\ast}}{k_x^2 + k_y^2} $$\nA singularity arises at the zero-wavenumber mode, where $ k_x = k_y = 0 $, making the denominator zero. This mode corresponds to the mean value of the fields. For the Poisson equation to have a solution on a periodic domain, the integral of the source term $ \\nabla \\cdot \\mathbf{u}^{\\ast} $ must be zero. By the divergence theorem, this condition is satisfied. The equation becomes $ 0/0 $ for the mean mode, meaning $ \\hat{p}(0, 0) $ is undetermined. To ensure a unique solution for pressure, the problem specifies that the mean of $ p $ is zero, which is equivalent to setting its zero-frequency Fourier coefficient to zero: $ \\hat{p}(0, 0) = 0 $.\n\nThe algorithm proceeds as follows:\n$1$. Define the computational grid of $ N \\times N $ points over the domain $ [0, 2\\pi] \\times [0, 2\\pi] $. The grid points are $ (x_j, y_l) $ where $ x_j = \\frac{2\\pi j}{N} $ and $ y_l = \\frac{2\\pi l}{N} $ for $ j, l \\in \\{0, \\dots, N-1\\} $. The corresponding integer wavenumbers are obtained from `numpy.fft.fftfreq`.\n$2$. Evaluate the tentative velocity field components, $ u_x^{\\ast}(x,y) $ and $ u_y^{\\ast}(x,y) $, on this grid.\n$3$. Compute their 2D Fourier transforms, $ \\hat{u}_x^{\\ast}(k_x, k_y) $ and $ \\hat{u}_y^{\\ast}(k_x, k_y) $, using the FFT algorithm.\n$4$. Calculate the Fourier transform of the divergence of the tentative field: $ \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} = i k_x \\hat{u}_x^{\\ast} + i k_y \\hat{u}_y^{\\ast} $.\n$5$. Solve for the Fourier coefficients of the pressure, $ \\hat{p}(k_x, k_y) $, using the derived expression, enforcing $ \\hat{p}(0,0) = 0 $.\n$6$. The divergence of the corrected velocity field, $ \\nabla \\cdot \\mathbf{u} $, can be computed directly in Fourier space. The Fourier transform is $ \\widehat{\\nabla \\cdot \\mathbf{u}} = \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} - \\mathcal{F}(\\nabla^2 p) = \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} + (k_x^2 + k_y^2)\\hat{p} $. By construction, this evaluates to zero for all wavenumbers, up to floating-point numerical precision.\n$7$. The physical field $ \\nabla \\cdot \\mathbf{u}(x,y) $ is obtained by applying the inverse 2D FFT to $ \\widehat{\\nabla \\cdot \\mathbf{u}}(k_x, k_y) $.\n$8$. Finally, the quality of the incompressibility enforcement is measured by the $ L^{\\infty} $ norm of the corrected divergence, $ \\max_{x,y} \\left| \\nabla \\cdot \\mathbf{u}(x,y) \\right| $.\nThis procedure must be applied to each of the four test cases specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pressure Poisson equation on a 2D periodic domain\n    using a spectral method to enforce incompressibility on a\n    tentative velocity field.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, u_x function, u_y function)\n    test_cases = [\n        (16, lambda x, y: np.sin(x), lambda x, y: np.cos(y)),\n        (33, lambda x, y: -np.cos(y) * np.sin(x), lambda x, y: np.cos(x) * np.sin(y)),\n        (64, lambda x, y: np.sin(3 * x) + 0.5 * np.sin(y), lambda x, y: 2 * np.sin(2 * y) - np.sin(x)),\n        (8, lambda x, y: 0.0, lambda x, y: 0.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, ux_func, uy_func = case\n\n        # 1. Define the computational grid and wavenumbers\n        # Domain is [0, 2*pi] x [0, 2*pi]\n        L = 2 * np.pi\n        # Grid points x_j = j * L/N. np.linspace is used for clarity.\n        x = np.linspace(0, L, N, endpoint=False)\n        y = np.linspace(0, L, N, endpoint=False)\n        X, Y = np.meshgrid(x, y, indexing='ij')\n\n        # Wavenumbers: For a domain of size L=2*pi, the physical wavenumbers k\n        # are integers m. The integer wavenumbers m are given by np.fft.fftfreq(N) * N.\n        k_int = np.fft.fftfreq(N) * N\n        KX, KY = np.meshgrid(k_int, k_int, indexing='ij')\n\n        # 2. Evaluate the tentative velocity field u* on the grid\n        ux_star = ux_func(X, Y)\n        uy_star = uy_func(X, Y)\n        # Ensure arrays are float type even for zero-field case\n        if not isinstance(ux_star, np.ndarray):\n            ux_star = np.full((N, N), ux_star, dtype=float)\n        if not isinstance(uy_star, np.ndarray):\n            uy_star = np.full((N, N), uy_star, dtype=float)\n\n\n        # 3. Compute the 2D FFT of the velocity components\n        ux_star_hat = np.fft.fft2(ux_star)\n        uy_star_hat = np.fft.fft2(uy_star)\n\n        # 4. Compute the divergence of u* in spectral space\n        # F(div(u*)) = i*kx*F(ux*) + i*ky*F(uy*)\n        div_u_star_hat = 1j * KX * ux_star_hat + 1j * KY * uy_star_hat\n\n        # 5. Solve the pressure Poisson equation in spectral space\n        # F(nabla^2 p) = F(div(u*))  =>  -(kx^2+ky^2)*p_hat = div_u_star_hat\n        # p_hat = -div_u_star_hat / (kx^2+ky^2)\n        k_squared = KX**2 + KY**2\n\n        # Initialize p_hat with zeros. This automatically sets p_hat(0,0)=0,\n        # enforcing the mean-zero pressure condition.\n        p_hat = np.zeros_like(k_squared, dtype=complex)\n        \n        # Avoid division by zero at k=0\n        non_zero_k = k_squared != 0\n        p_hat[non_zero_k] = -div_u_star_hat[non_zero_k] / k_squared[non_zero_k]\n\n        # 6. Compute the divergence of the corrected velocity field u in spectral space\n        # F(div(u)) = F(div(u*)) - F(div(grad(p)))\n        #           = F(div(u*)) - F(nabla^2 p)\n        #           = div_u_star_hat - (-(kx^2+ky^2)*p_hat)\n        #           = div_u_star_hat + (kx^2+ky^2)*p_hat\n        div_u_hat = div_u_star_hat + k_squared * p_hat\n        \n        # By construction, div_u_hat should be zero to machine precision.\n        # Let's verify for the k=0 mode:\n        # div_u_hat[0,0] = div_u_star_hat[0,0] + 0 * p_hat[0,0] = div_u_star_hat[0,0]\n        # div_u_star_hat[0,0] is the mean of the divergence, which should be numerically zero\n        # for a periodic domain. The operation div_u_hat = ... will correctly handle this.\n        \n        # 7. Transform the corrected divergence back to physical space\n        div_u = np.fft.ifft2(div_u_hat)\n\n        # 8. Calculate the L-infinity norm of the result.\n        # The result should be a real field, but small imaginary parts can exist due\n        # to floating point errors. np.abs handles complex numbers correctly.\n        linf_norm_div_u = np.max(np.abs(div_u))\n        \n        results.append(linf_norm_div_u)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}