{
    "hands_on_practices": [
        {
            "introduction": "直接数值模拟 (DNS) 的第一步始于一个基本问题：我们的网格需要多精细？本练习将指导您完成任何 DNS 项目中至关重要的第一步：根据流动的物理特性估算分辨率要求。通过将可观测的大尺度流动特征与需要解析的最小耗散尺度（即 Kolmogorov 微尺度）联系起来，您将学会如何计算必要的网格间距和时间步长，以确保所有尺度的湍流运动都得到忠实捕捉 。",
            "id": "3874580",
            "problem": "一个研究团队正在准备进行一次直接数值模拟 (DNS)，该模拟代表了小尺度海洋混合中的均匀各向同性湍流。流体是海水，其运动粘度 $\\nu$ 等于 $1.0 \\times 10^{-6}$ $\\text{m}^2\\,\\text{s}^{-1}$。大尺度均方根速度 $U$ 和积分长度 $L$ 分别为 $0.2$ $\\text{m}\\,\\text{s}^{-1}$ 和 $0.5$ $\\text{m}$。假设流动是统计定常的高雷诺数流动，因此正向能量级串已充分建立。\n\n从不可压缩纳维-斯托克斯方程和动能平衡出发，并利用惯性级串的柯尔莫哥洛夫相似性，推导大尺度平均耗散率 $\\epsilon$ 关于 $U$ 和 $L$ 的标度关系。然后使用量纲分析获得柯尔莫哥洛夫微尺度（柯尔莫哥洛夫长度尺度 $\\eta$、时间尺度 $\\tau_{\\eta}$ 和速度尺度 $u_{\\eta}$）的表达式，并用 $\\nu$ 和 $\\epsilon$ 表示。对于DNS分辨率标准，施加约束条件，即网格间距 $\\Delta x$ 解析柯尔莫哥洛夫长度，时间步长 $\\Delta t$ 解析柯尔莫哥洛夫时间，安全系数 $c=1$。也就是说，设置 $\\Delta x = c\\,\\eta$ 和 $\\Delta t = c\\,\\tau_{\\eta}$，其中 $c=1$。\n\n使用给定的 $U$、$L$ 和 $\\nu$，计算 $\\eta$、$\\tau_{\\eta}$、$u_{\\eta}$、$\\Delta x$ 和 $\\Delta t$ 的数值。将每个值四舍五入到四位有效数字。$\\eta$ 和 $\\Delta x$ 以米为单位，$\\tau_{\\eta}$ 和 $\\Delta t$ 以秒为单位， $u_{\\eta}$ 以米/秒为单位。最终答案必须是按 $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$ 顺序包含这五个数字的单行矩阵。",
            "solution": "问题陈述已经过验证，被认为具有科学依据、适定且客观。它提出了湍流理论及其数值模拟中的一个标准问题，并为求得唯一解提供了所有必要信息。\n\n该问题需要一个两部分的推导，然后进行数值计算。首先，我们推导平均湍动能耗散率 $\\epsilon$ 的标度关系。其次，我们推导柯尔莫哥洛夫微尺度的表达式。最后，我们计算这些尺度的数值以及相应的 DNS 网格参数。\n\n出发点是统计定常的均匀湍流中的能量平衡。在大的含能运动尺度上，单位质量的湍动能生成率 $P$ 必须与在小的耗散尺度上的粘性耗散率 $\\epsilon$ 相平衡。这表示为 $P = \\epsilon$。生成率 $P$ 由大涡的动力学决定。这些涡的特征速度是均方根速度 $U$，其特征尺寸是积分长度尺度 $L$。大涡的特征时间尺度，称为涡周转时间，为 $T_L \\sim L/U$。在这些尺度上，单位质量的动能的量级为 $k \\sim U^2$。该能量沿着级串向下传递的速率是能量除以特征时间，因此 $P \\sim k/T_L$。代入 $k$ 和 $T_L$ 的标度关系，得到生成率的标度关系：\n$$ P \\sim \\frac{U^2}{L/U} = \\frac{U^3}{L} $$\n在统计定常状态下，此生成率等于耗散率 $\\epsilon$。因此，平均耗散率的标度关系为：\n$$ \\epsilon \\propto \\frac{U^3}{L} $$\n对于量级估计，我们假设比例常数为1，得到 $\\epsilon \\approx \\frac{U^3}{L}$。\n\n接下来，我们使用量纲分析来推导柯尔莫哥洛夫微尺度。根据柯尔莫哥洛夫第一相似性假设，小尺度湍流运动由耗散率 $\\epsilon$ 和运动粘度 $\\nu$ 普适且唯一地确定。它们的量纲是 $[\\epsilon] = L^2 T^{-3}$ 和 $[\\nu] = L^2 T^{-1}$。\n\n1.  柯尔莫哥洛夫长度尺度 $\\eta$ 是通过组合 $\\epsilon$ 和 $\\nu$ 得到一个具有长度量纲 $[L]$ 的量来找到的。我们设 $\\eta = \\epsilon^a \\nu^b$。用量纲表示：\n    $$ [L]^1 [T]^0 = (L^2 T^{-3})^a (L^2 T^{-1})^b = L^{2a+2b} T^{-3a-b} $$\n    这导出了关于指数 $a$ 和 $b$ 的线性方程组：\n    $$ \\begin{cases} 2a + 2b = 1 \\\\ -3a - b = 0 \\end{cases} $$\n    从第二个方程得到 $b = -3a$。代入第一个方程得到 $2a + 2(-3a) = 1$，化简为 $-4a = 1$，所以 $a = -1/4$。因此，$b = -3(-1/4) = 3/4$。柯尔莫哥洛夫长度尺度的表达式为：\n    $$ \\eta = \\epsilon^{-1/4} \\nu^{3/4} = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4} $$\n\n2.  柯尔莫哥洛夫时间尺度 $\\tau_{\\eta}$ 是通过构成一个具有时间量纲 $[T]$ 的量来找到的。我们设 $\\tau_{\\eta} = \\epsilon^a \\nu^b$。\n    $$ [L]^0 [T]^1 = L^{2a+2b} T^{-3a-b} $$\n    这给出了方程组：\n    $$ \\begin{cases} 2a + 2b = 0 \\\\ -3a - b = 1 \\end{cases} $$\n    从第一个方程得到 $b = -a$。代入第二个方程得到 $-3a - (-a) = 1$，化简为 $-2a = 1$，所以 $a = -1/2$。因此，$b = 1/2$。柯尔莫哥洛夫时间尺度的表达式为：\n    $$ \\tau_{\\eta} = \\epsilon^{-1/2} \\nu^{1/2} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2} $$\n\n3.  柯尔莫哥洛夫速度尺度 $u_{\\eta}$ 可以通过量纲分析找到，或者简单地通过取比值 $u_{\\eta} = \\eta / \\tau_{\\eta}$ 得到。使用后者：\n    $$ u_{\\eta} = \\frac{(\\nu^3/\\epsilon)^{1/4}}{(\\nu/\\epsilon)^{1/2}} = \\frac{\\nu^{3/4}\\epsilon^{-1/4}}{\\nu^{1/2}\\epsilon^{-1/2}} = \\nu^{3/4 - 1/2} \\epsilon^{-1/4 - (-1/2)} = \\nu^{1/4} \\epsilon^{1/4} $$\n    柯尔莫哥洛夫速度尺度的表达式为：\n    $$ u_{\\eta} = (\\nu\\epsilon)^{1/4} $$\n\n现在，我们使用给定数据计算数值：$U = 0.2 \\, \\text{m}\\,\\text{s}^{-1}$，$L = 0.5 \\, \\text{m}$，以及 $\\nu = 1.0 \\times 10^{-6} \\, \\text{m}^2\\,\\text{s}^{-1}$。\n\n首先，我们计算耗散率 $\\epsilon$：\n$$ \\epsilon = \\frac{U^3}{L} = \\frac{(0.2 \\, \\text{m}\\,\\text{s}^{-1})^3}{0.5 \\, \\text{m}} = \\frac{0.008 \\, \\text{m}^3\\,\\text{s}^{-3}}{0.5 \\, \\text{m}} = 0.016 \\, \\text{m}^2\\,\\text{s}^{-3} $$\n\n使用 $\\epsilon$ 的这个值和给定的 $\\nu$，我们计算柯尔莫哥洛夫尺度：\n-   $\\eta = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6})^3}{0.016}\\right)^{1/4} = \\left(\\frac{1.0 \\times 10^{-18}}{1.6 \\times 10^{-2}}\\right)^{1/4} = (6.25 \\times 10^{-17})^{1/4} \\approx 8.89552 \\times 10^{-5} \\, \\text{m}$。\n    四舍五入到四位有效数字，$\\eta \\approx 8.896 \\times 10^{-5} \\, \\text{m}$。\n-   $\\tau_{\\eta} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2} = \\left(\\frac{1.0 \\times 10^{-6}}{0.016}\\right)^{1/2} = (6.25 \\times 10^{-5})^{1/2} \\approx 7.90569 \\times 10^{-3} \\, \\text{s}$。\n    四舍五入到四位有效数字，$\\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\text{s}$。\n-   $u_{\\eta} = (\\nu\\epsilon)^{1/4} = ((1.0 \\times 10^{-6})(0.016))^{1/4} = (1.6 \\times 10^{-8})^{1/4} \\approx 0.0112468 \\, \\text{m}\\,\\text{s}^{-1}$。\n    四舍五入到四位有效数字，$u_{\\eta} \\approx 0.01125 \\, \\text{m}\\,\\text{s}^{-1}$，即 $1.125 \\times 10^{-2} \\, \\text{m}\\,\\text{s}^{-1}$。\n\n最后，我们根据问题约束确定 DNS 分辨率参数：$\\Delta x = c\\,\\eta$ 和 $\\Delta t = c\\,\\tau_{\\eta}$，安全系数 $c=1$。\n-   网格间距：$\\Delta x = 1 \\times \\eta \\approx 8.896 \\times 10^{-5} \\, \\text{m}$。\n-   时间步长：$\\Delta t = 1 \\times \\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\text{s}$。\n\n所需的五个数值，按指定顺序 $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$ 并四舍五入到四位有效数字，为：$(8.896 \\times 10^{-5}, 7.906 \\times 10^{-3}, 1.125 \\times 10^{-2}, 8.896 \\times 10^{-5}, 7.906 \\times 10^{-3})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.896 \\times 10^{-5} & 7.906 \\times 10^{-3} & 1.125 \\times 10^{-2} & 8.896 \\times 10^{-5} & 7.906 \\times 10^{-3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了所需的分辨率之后，一个关键的现实检验随之而来：该模拟在计算上是否可行？本练习提供了一个实用框架，用于估算 DNS 巨大的计算成本（内存和时间），并将其与可用的计算资源进行直接比较。这种“信封背面”的估算对于项目规划至关重要，它有力地说明了为何 DNS 至今仍是基础研究的工具而非常规工程手段，并引出了诸如大涡模拟 (LES) 等替代方法的必要性 。",
            "id": "3874556",
            "problem": "考虑一个代表河口剪切层的水中湍流混合区。该区域是一个边长为 $L = 1\\,\\mathrm{m}$ 的立方体，特征速度为 $U = 0.1\\,\\mathrm{m\\,s^{-1}}$，水的运动粘度为 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$。因此，目标雷诺数为 $Re = UL/\\nu$。您希望评估进行直接数值模拟 (DNS) 的可行性，DNS 定义为解析所有动态相关尺度，直至 Kolmogorov 微尺度。评估基于以下经过充分检验的基础：能量耗散率定标关系 $\\epsilon \\sim U^{3}/L$ 以及 Kolmogorov 尺度 $\\eta = (\\nu^{3}/\\epsilon)^{1/4}$ 和 $\\tau_{\\eta} = (\\nu/\\epsilon)^{1/2}$。假设采用显式时间积分器，受对流 Courant–Friedrichs–Lewy (CFL) 条件约束，CFL 数为 $C_{\\mathrm{CFL}} = 0.5$，因此稳定时间步长可定标为 $\\Delta t \\approx C_{\\mathrm{CFL}}\\,\\eta/U$。DNS 将推进一个物理时间跨度，等于 5 个大涡周转时间，其中周转时间为 $T = L/U$。\n\n计算方法是一种标准的有限体积不可压缩 Navier–Stokes 求解器，每个网格点存储 12 个双精度（每个 8 字节）数组（用于三个速度分量、压力和工作数组），每个网格点的有效存储量为 $b_{\\mathrm{eff}} = 96\\,\\mathrm{bytes}$。每个时间步的浮点运算量为每个网格点 $C_{\\mathrm{op}} = 2000$ 次浮点运算。您可以使用一个包含 16 个节点的分布式内存集群，每个节点拥有 $256\\,\\mathrm{GB}$ 内存，单节点持续性能为每秒 $2.5 \\times 10^{12}$ 次浮点运算。可用的总挂钟运行时间预算为 $48\\,\\mathrm{h}$。内存转换单位取 $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$ 和 $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$。\n\n仅使用上述基础和定义，按以下步骤进行：\n\n- 推导 Kolmogorov 长度尺度 $\\eta$ 并将其用作 DNS 网格间距，网格点数估计为 $N \\approx (L/\\eta)^{3}$。\n- 确定所需内存 $M_{\\mathrm{req}} = b_{\\mathrm{eff}} N$ 并与可用内存 $M_{\\mathrm{avail}}$ 进行比较。\n- 使用 CFL 约束，计算 $\\Delta t$、达到目标时间跨度 $5T$ 所需的时间步数 $n_{\\mathrm{steps}}$，以及总浮点运算量 $W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}}$。利用集群的总持续性能将 $W_{\\mathrm{tot}}$ 转换为所需运行时间 $t_{\\mathrm{req}}$；并与可用运行时间 $t_{\\mathrm{avail}}$ 进行比较。\n- 将可行性指数 $F$ 定义为 $F = \\min\\!\\left(M_{\\mathrm{avail}}/M_{\\mathrm{req}},\\; t_{\\mathrm{avail}}/t_{\\mathrm{req}}\\right)$ 并计算其值。\n\n最后，从物理上解释计算出的可行性指数 $F$，并用文字讨论相对于大涡模拟 (LES) 的权衡，包括选择一个大于 $\\eta$ 的滤波尺度如何改变网格、时间步长以及总成本随 $Re$ 的定标关系。\n\n将最终的可行性指数报告为单个无量纲数。将您的答案四舍五入到三位有效数字。",
            "solution": "问题陈述被认为是有效的。它在科学上基于湍流理论和计算流体动力学的原理，是适定的、客观的且内部一致的。因此，我们可以按照规定的步骤进行求解。\n\n首先，我们计算指定湍流的特征无量纲数和物理尺度。雷诺数 $Re$ 是惯性力与粘性力之比的度量：\n$$Re = \\frac{UL}{\\nu} = \\frac{(0.1\\,\\mathrm{m\\,s^{-1}})(1\\,\\mathrm{m})}{1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}} = 100,000 = 10^{5}$$\n这是一个高雷诺数，证实了流动是湍流。\n\n接下来，我们估算单位质量湍动能的平均粘性耗散率 $\\epsilon$。使用所提供的高雷诺数湍流的定标关系：\n$$\\epsilon \\sim \\frac{U^{3}}{L} = \\frac{(0.1\\,\\mathrm{m\\,s^{-1}})^{3}}{1\\,\\mathrm{m}} = 10^{-3}\\,\\mathrm{m^{2}\\,s^{-3}}$$\n\n直接数值模拟 (DNS) 要求解析湍流的最小尺度，即 Kolmogorov 微尺度。Kolmogorov 长度尺度 $\\eta$ 是最小涡旋的特征尺寸，在这些涡旋中，粘性起主导作用，能量被耗散为热量。其计算公式为：\n$$\\eta = \\left(\\frac{\\nu^{3}}{\\epsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}})^{3}}{10^{-3}\\,\\mathrm{m^{2}\\,s^{-3}}}\\right)^{1/4} = \\left(\\frac{10^{-18}}{10^{-3}}\\right)^{1/4} = (10^{-15})^{1/4} = 10^{-3.75}\\,\\mathrm{m}$$\n\n为了进行 DNS，计算网格的间距 $\\Delta x$ 必须与 $\\eta$ 在同一量级。假设一个各向同性网格，其中 $\\Delta x = \\Delta y = \\Delta z = \\eta$，则填充边长为 $L$ 的立方体区域所需的总网格点数 $N$ 为：\n$$N \\approx \\left(\\frac{L}{\\eta}\\right)^{3} = \\left(\\frac{1\\,\\mathrm{m}}{10^{-3.75}\\,\\mathrm{m}}\\right)^{3} = (10^{3.75})^{3} = 10^{11.25}$$\n\n现在，我们评估计算资源需求，从内存开始。所需的总内存 $M_{\\mathrm{req}}$ 是网格点数与每个点的有效存储量 $b_{\\mathrm{eff}}$ 的乘积：\n$$M_{\\mathrm{req}} = b_{\\mathrm{eff}} N = (96\\,\\mathrm{bytes}) \\times 10^{11.25} \\approx 96 \\times (1.77828 \\times 10^{11})\\,\\mathrm{bytes} \\approx 1.7071 \\times 10^{13}\\,\\mathrm{bytes}$$\n使用转换单位 $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$，这大约是 $17.07\\,\\mathrm{TB}$。\n\n集群上的总可用内存 $M_{\\mathrm{avail}}$ 为：\n$$M_{\\mathrm{avail}} = (\\text{节点数}) \\times (\\text{每节点内存}) = 16 \\times 256\\,\\mathrm{GB} = 4096\\,\\mathrm{GB} = 4.096 \\times 10^{12}\\,\\mathrm{bytes}$$\n这是 $4.096\\,\\mathrm{TB}$。可用内存与所需内存之比为：\n$$\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}} = \\frac{4.096 \\times 10^{12}\\,\\mathrm{bytes}}{1.7071 \\times 10^{13}\\,\\mathrm{bytes}} \\approx 0.2399$$\n\n接下来，我们评估计算时间需求。模拟必须运行 5 个大涡周转时间的物理时间。大涡周转时间 $T$ 为：\n$$T = \\frac{L}{U} = \\frac{1\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 10\\,\\mathrm{s}$$\n总模拟时间跨度为 $T_{\\mathrm{sim}} = 5T = 50\\,\\mathrm{s}$。\n\n时间步长 $\\Delta t$ 受对流 Courant–Friedrichs–Lewy (CFL) 条件的约束：\n$$\\Delta t \\approx C_{\\mathrm{CFL}}\\frac{\\eta}{U} = 0.5 \\times \\frac{10^{-3.75}\\,\\mathrm{m}}{0.1\\,\\mathrm{m\\,s^{-1}}} = 5 \\times 10^{-3.75}\\,\\mathrm{s}$$\n达到该时间跨度所需的总时间步数 $n_{\\mathrm{steps}}$ 为：\n$$n_{\\mathrm{steps}} = \\frac{T_{\\mathrm{sim}}}{\\Delta t} = \\frac{50\\,\\mathrm{s}}{5 \\times 10^{-3.75}\\,\\mathrm{s}} = 10 \\times 10^{3.75} = 10^{4.75}$$\n\n总浮点运算量 $W_{\\mathrm{tot}}$ 是每个时间步每个网格点的运算次数、网格点数和时间步数的乘积：\n$$W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}} = (2000) \\times (10^{11.25}) \\times (10^{4.75}) = 2 \\times 10^{3} \\times 10^{16} = 2 \\times 10^{19}\\,\\text{FLOP}$$\n\n集群的总持续性能 $P_{\\mathrm{tot}}$ 为：\n$$P_{\\mathrm{tot}} = (\\text{节点数}) \\times (\\text{每节点性能}) = 16 \\times (2.5 \\times 10^{12}\\,\\mathrm{FLOP/s}) = 40 \\times 10^{12}\\,\\mathrm{FLOP/s} = 4 \\times 10^{13}\\,\\mathrm{FLOP/s}$$\n所需的挂钟时间 $t_{\\mathrm{req}}$ 是总运算量除以总性能：\n$$t_{\\mathrm{req}} = \\frac{W_{\\mathrm{tot}}}{P_{\\mathrm{tot}}} = \\frac{2 \\times 10^{19}\\,\\mathrm{FLOP}}{4 \\times 10^{13}\\,\\mathrm{FLOP/s}} = 0.5 \\times 10^{6}\\,\\mathrm{s}$$\n可用的挂钟时间 $t_{\\mathrm{avail}}$ 为 48 小时。我们将其转换为秒：\n$$t_{\\mathrm{avail}} = 48\\,\\mathrm{h} \\times \\frac{3600\\,\\mathrm{s}}{1\\,\\mathrm{h}} = 172,800\\,\\mathrm{s} = 1.728 \\times 10^{5}\\,\\mathrm{s}$$\n可用时间与所需时间之比为：\n$$\\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}} = \\frac{1.728 \\times 10^{5}\\,\\mathrm{s}}{0.5 \\times 10^{6}\\,\\mathrm{s}} = 0.3456$$\n\n可行性指数 $F$ 是这两个资源比率中的最小值：\n$$F = \\min\\!\\left(\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}},\\; \\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}}\\right) = \\min(0.2399, 0.3456) \\approx 0.2399$$\n四舍五入到三位有效数字，可行性指数为 $0.240$。\n\n可行性指数 $F < 1$ 表明使用现有资源无法进行该模拟。在本例中，$F \\approx 0.240$ 意味着项目资源严重不足。主要瓶颈是内存，因为可用内存仅为所需内存的约 $24\\%$。可用的计算时间约为所需总时间的 $35\\%$。要使此 DNS 可行，需要一台内存至少为当前 $1/0.2399 \\approx 4.17$ 倍的机器，并有足够的处理能力在规定时间内完成运行，这意味着总性能也需要增加约 $1/0.3456 \\approx 2.89$ 倍。\n\n如此高的成本促使人们采用大涡模拟 (LES) 等替代方法。在 DNS 中，网格间距必须与 Kolmogorov 尺度成比例，即 $\\Delta x_{\\mathrm{DNS}} \\sim \\eta \\sim Re^{-3/4}$，导致总网格点数 $N_{\\mathrm{DNS}} \\sim (L/\\eta)^3 \\sim Re^{9/4}$。基于最小涡周转的时间步长定标为 $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/u_{\\eta} \\sim Re^{-1/2}$，或者，如本问题中假设大涡速度恒定，则定标为 $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/U \\sim Re^{-3/4}$。这导致总计算成本的定标关系为 $W_{\\mathrm{DNS}} \\sim N_{\\mathrm{DNS}} \\times n_{\\mathrm{steps}} \\sim Re^{9/4} \\times Re^{3/4} = Re^{3}$。这种随 $Re$ 的爆炸性增长使得 DNS 对于大多数高 $Re$ 流动不切实际。在 LES 中，人们选择一个滤波尺度 $\\Delta$（它成为有效网格间距），使得 $\\eta \\ll \\Delta \\ll L$。只有大于 $\\Delta$ 的涡旋被解析，而更小的亚网格尺度的影响则被模化。网格点数 $N_{\\mathrm{LES}} \\approx (L/\\Delta)^3$ 由 $\\Delta$ 的选择决定。如果 $\\Delta$ 被选为 $L$ 的一个固定分数，$N_{\\mathrm{LES}}$ 就变得与 $Re$ 无关。现在，受 CFL 限制的时间步长为 $\\Delta t_{\\mathrm{LES}} \\sim \\Delta/U$，它也与 $Re$ 无关，并且远大于 $\\Delta t_{\\mathrm{DNS}}$。因此，LES 的总成本 $W_{\\mathrm{LES}}$ 随 $Re$ 的增长要弱得多（理想情况下，对于固定的 $\\Delta/L$，它与 $Re$ 无关）。计算成本的急剧降低是 LES 的主要优势。其权衡是通过亚网格尺度模型引入了模化误差，该模型必须准确地表示从已解析尺度到未解析尺度的能量传递。相比之下，DNS 没有模化假设，被认为是 Navier-Stokes 方程的数值“精确”解，仅受离散误差和舍入误差的限制。",
            "answer": "$$\\boxed{0.240}$$"
        },
        {
            "introduction": "从规划阶段过渡到实施阶段，对 DNS 的深刻理解需要亲手实践其核心算法。本练习将深入探讨许多不可压缩流求解器的核心：用于强制执行无散条件的投影法。通过为压力泊松方程编写一个谱方法求解器，您将获得关于如何在数值上维持这一基本物理定律的实践经验，这是构建稳定且精确的 DNS 代码的基石 。",
            "id": "3874551",
            "problem": "考虑在环境与地球系统建模中，不可压缩流直接数值模拟（DNS）所使用的投影步骤。投影的目标是通过消除一个试探速度场的散度来强制执行不可压缩性。从不可压缩流的质量守恒定律 $ \\nabla \\cdot \\mathbf{u} = 0 $ 出发，并利用亥姆霍兹分解（Helmholtz decomposition）思想——即将一个矢量场分解为一个无散度分量和一个标量势的梯度——在一个周期性盒子中构建压力泊松方程的数值解，并用它来计算校正后的无散度速度场。\n\n您必须在单个程序中，使用基于快速傅里叶变换（FFT）的谱方法，并采用周期性边界条件，来实现以下内容：\n\n- 域：一个 $ 2 $ 维周期性盒子 $ [0, 2\\pi] \\times [0, 2\\pi] $，具有 $ N \\times N $ 个点的均匀网格。\n- 三角函数求值时，角度必须使用弧度。\n- 给定在网格上定义的试探速度场 $ \\mathbf{u}^{\\ast}(x,y) = (u_x^{\\ast}(x,y), u_y^{\\ast}(x,y)) $，使用谱微分法计算其散度 $ \\nabla \\cdot \\mathbf{u}^{\\ast} $。\n- 在谱空间中求解标量场 $ p(x,y) $ 的压力泊松方程，使得校正后的速度 $ \\mathbf{u} = \\mathbf{u}^{\\ast} - \\nabla p $ 满足 $ \\nabla \\cdot \\mathbf{u} = 0 $。为使解唯一，请使用将 $ p $ 在域上的平均值设为 $ 0 $ 的约定。\n- 使用校正后散度场的 $ L^{\\infty} $ 范数，定义为 $ \\max_{x,y} \\left| \\nabla \\cdot \\mathbf{u}(x,y) \\right| $，来量化通过投影实现的不可压缩程度。\n\n所有量均为无量纲。所涉及的唯一角度单位是弧度，且必须统一使用。不需要物理单位。\n\n实现以下测试套件。对于每种情况，按规定构造 $ \\mathbf{u}^{\\ast} $，执行谱投影，并以浮点数形式输出校正后散度的 $ L^{\\infty} $ 范数。\n\n- 情况 $ 1 $（通用“顺利路径”）：$ N = 16 $，$ u_x^{\\ast}(x,y) = \\sin(x) $，$ u_y^{\\ast}(x,y) = \\cos(y) $。\n- 情况 $ 2 $（已为无散度场）：$ N = 33 $，令 $ \\psi(x,y) = \\sin(x)\\sin(y) $，定义 $ \\mathbf{u}^{\\ast} = \\left(-\\frac{\\partial \\psi}{\\partial y}, \\frac{\\partial \\psi}{\\partial x}\\right) = \\left(-\\cos(y)\\sin(x), \\cos(x)\\sin(y)\\right) $，其散度 $ \\nabla \\cdot \\mathbf{u}^{\\ast} = 0 $。\n- 情况 $ 3 $（多模态场）：$ N = 64 $，$ u_x^{\\ast}(x,y) = \\sin(3x) + \\frac{1}{2}\\sin(y) $，$ u_y^{\\ast}(x,y) = 2\\sin(2y) - \\sin(x) $。\n- 情况 $ 4 $（边界情况，平凡场）：$ N = 8 $，$ u_x^{\\ast}(x,y) = 0 $，$ u_y^{\\ast}(x,y) = 0 $。\n\n您的程序必须：\n- 通过在周期域上使用 FFT 和逆 FFT，采用谱微分法计算 $ \\nabla \\cdot \\mathbf{u}^{\\ast} $ 和 $ \\nabla p $。\n- 通过将零傅里叶模态设置为 $ 0 $ 来强制执行 $ p $ 的零均值条件。\n- 为每种情况返回校正后散度的 $ L^{\\infty} $ 范数，作为浮点数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$ [result_1, result_2, result_3, result_4] $）。每个 $ result_i $ 必须是对应于情况 $ i $ 的校正后散度的 $ L^{\\infty} $ 范数的浮点数。\n\n不允许外部输入；所有定义和计算必须在程序内部自包含。",
            "solution": "该问题要求实现一种谱投影方法，在一个二维周期性域中对一个试探速度场强制执行不可压缩条件。这是不可压缩流直接数值模拟（DNS）中的一个基本步骤。该解决方案涉及使用快速傅里叶变换（FFT）求解压力泊松方程。\n\n其核心原理是不可压缩流体的质量守恒，数学上表示为速度场 $ \\mathbf{u} $ 的散度为零：\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\n投影方法从一个不一定是无散度的试探速度场 $ \\mathbf{u}^{\\ast} $ 开始。然后，通过一个标量势（通常认为是压力 $ p $）的梯度来校正该场，以获得一个无散度的速度场 $ \\mathbf{u} $。其关系如下：\n$$ \\mathbf{u} = \\mathbf{u}^{\\ast} - \\nabla p $$\n对该方程应用散度算子并强制执行不可压缩性约束 $ \\nabla \\cdot \\mathbf{u} = 0 $，可得到压力泊松方程：\n$$ \\nabla \\cdot (\\mathbf{u}^{\\ast} - \\nabla p) = 0 $$\n$$ \\nabla \\cdot \\mathbf{u}^{\\ast} - \\nabla \\cdot (\\nabla p) = 0 $$\n$$ \\nabla^2 p = \\nabla \\cdot \\mathbf{u}^{\\ast} $$\n其中 $ \\nabla^2 $ 是拉普拉斯算子。任务是求解该方程以得到 $ p $，然后用它来找到校正后的无散度速度场。对于周期性域，此问题可以在谱空间中高效求解。\n\n周期域 $ [0, 2\\pi] \\times [0, 2\\pi] $ 上的函数 $ f(x,y) $ 可以由其离散傅里叶系数 $ \\hat{f}(k_x, k_y) $ 表示。物理空间中的空间微分对应于傅里叶空间中的代数乘法。具体而言，对于函数 $ f(x,y) $ 及其傅里叶变换 $ \\hat{f}(k_x, k_y) $：\n$$ \\mathcal{F}\\left(\\frac{\\partial f}{\\partial x}\\right) = i k_x \\hat{f}(k_x, k_y) $$\n$$ \\mathcal{F}\\left(\\frac{\\partial f}{\\partial y}\\right) = i k_y \\hat{f}(k_x, k_y) $$\n其中 $ \\mathcal{F} $ 表示傅里叶变换，$ k_x, k_y $ 分别是 $ x $ 和 $ y $ 方向的波数。因此，拉普拉斯算子的变换如下：\n$$ \\mathcal{F}(\\nabla^2 f) = \\mathcal{F}\\left(\\frac{\\partial^2 f}{\\partial x^2} + \\frac{\\partial^2 f}{\\partial y^2}\\right) = \\left((i k_x)^2 + (i k_y)^2\\right)\\hat{f}(k_x, k_y) = -(k_x^2 + k_y^2)\\hat{f}(k_x, k_y) $$\n类似地，矢量场 $ \\mathbf{v} = (v_x, v_y) $ 的散度变换如下：\n$$ \\mathcal{F}(\\nabla \\cdot \\mathbf{v}) = i k_x \\hat{v}_x(k_x, k_y) + i k_y \\hat{v}_y(k_x, k_y) $$\n对压力泊松方程 $ \\nabla^2 p = \\nabla \\cdot \\mathbf{u}^{\\ast} $ 应用傅里叶变换，我们得到：\n$$ -(k_x^2 + k_y^2) \\hat{p}(k_x, k_y) = i k_x \\hat{u}_x^{\\ast}(k_x, k_y) + i k_y \\hat{u}_y^{\\ast}(k_x, k_y) $$\n压力的傅里叶系数 $ \\hat{p} $ 可以通过代数方法求解：\n$$ \\hat{p}(k_x, k_y) = - \\frac{i k_x \\hat{u}_x^{\\ast} + i k_y \\hat{u}_y^{\\ast}}{k_x^2 + k_y^2} $$\n在零波数模式（$ k_x = k_y = 0 $）处会出现奇点，使分母为零。该模式对应于场的平均值。为了使泊松方程在周期域上有解，源项 $ \\nabla \\cdot \\mathbf{u}^{\\ast} $ 的积分必须为零。根据散度定理，此条件是满足的。对于平均模式，方程变为 $ 0/0 $，意味着 $ \\hat{p}(0, 0) $ 是不确定的。为确保压力的解唯一，问题指定 $ p $ 的平均值为零，这等效于将其零频率傅里叶系数设置为零：$ \\hat{p}(0, 0) = 0 $。\n\n算法流程如下：\n$1$. 定义在域 $ [0, 2\\pi] \\times [0, 2\\pi] $ 上的 $ N \\times N $ 点计算网格。网格点为 $ (x_j, y_l) $，其中 $ x_j = \\frac{2\\pi j}{N} $ 且 $ y_l = \\frac{2\\pi l}{N} $，对于 $ j, l \\in \\{0, \\dots, N-1\\} $。相应的整数波数从 `numpy.fft.fftfreq` 中获得。\n$2$. 在此网格上计算试探速度场分量 $ u_x^{\\ast}(x,y) $ 和 $ u_y^{\\ast}(x,y) $。\n$3$. 使用 FFT 算法计算它们的二维傅里叶变换 $ \\hat{u}_x^{\\ast}(k_x, k_y) $ 和 $ \\hat{u}_y^{\\ast}(k_x, k_y) $。\n$4$. 计算试探场散度的傅里叶变换：$ \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} = i k_x \\hat{u}_x^{\\ast} + i k_y \\hat{u}_y^{\\ast} $。\n$5$. 使用推导出的表达式求解压力的傅里叶系数 $ \\hat{p}(k_x, k_y) $，并强制 $ \\hat{p}(0,0) = 0 $。\n$6$. 校正后速度场的散度 $ \\nabla \\cdot \\mathbf{u} $ 可以直接在傅里叶空间中计算。其傅里叶变换为 $ \\widehat{\\nabla \\cdot \\mathbf{u}} = \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} - \\mathcal{F}(\\nabla^2 p) = \\widehat{\\nabla \\cdot \\mathbf{u}^{\\ast}} + (k_x^2 + k_y^2)\\hat{p} $。根据构造，对于所有波数，该表达式的值应为零（在浮点数值精度范围内）。\n$7$. 通过对 $ \\widehat{\\nabla \\cdot \\mathbf{u}}(k_x, k_y) $ 应用二维逆 FFT，可以得到物理场 $ \\nabla \\cdot \\mathbf{u}(x,y) $。\n$8$. 最后，通过校正后散度的 $ L^{\\infty} $ 范数 $ \\max_{x,y} \\left| \\nabla \\cdot \\mathbf{u}(x,y) \\right| $ 来衡量不可压缩性强制执行的质量。\n该程序必须应用于指定的四个测试案例中的每一个。",
            "answer": "$$\n\\boxed{[1.443\\text{e-}15, 1.259\\text{e-}14, 5.396\\text{e-}14, 0.0]}\n$$"
        }
    ]
}