{
    "hands_on_practices": [
        {
            "introduction": "A primary challenge in environmental modeling is ensuring that numerical solutions respect fundamental physical laws, such as the non-negativity of concentrations. This exercise uses a simple one-cell box model to demonstrate how an operator splitting scheme, if not carefully constructed, can violate such constraints. By analyzing a Lie splitting scheme coupled with a forward Euler method, you will analytically determine the conditions that lead to non-physical negative concentrations, offering a crucial lesson in numerical stability for stiff systems .",
            "id": "3903169",
            "problem": "Consider a one-cell atmospheric box model for a reactive pollutant with concentration $c(t) \\ge 0$. The local mass balance combines an emission source and a first-order chemical loss,\n$$\n\\frac{dc}{dt} \\;=\\; S \\;-\\; \\lambda\\,c,\n$$\nwhere $S \\ge 0$ is a constant source rate and $\\lambda > 0$ is a constant first-order loss rate coefficient. In a split formulation, decompose the right-hand side operator into a source subproblem and a reaction subproblem:\n$$\n\\text{Source subproblem:}\\quad \\frac{dc}{dt} \\;=\\; S,\n\\qquad\n\\text{Reaction subproblem:}\\quad \\frac{dc}{dt} \\;=\\; -\\lambda\\,c.\n$$\nApply Lie splitting (also called sequential splitting) over a single time step of length $\\Delta t > 0$ by first integrating the source subproblem and then the reaction subproblem. Take the source subproblem to be integrated exactly over $\\Delta t$, and take the reaction subproblem to be integrated using the first-order forward Euler method over $\\Delta t$. Assume nonnegative initial concentration $c^{n} \\ge 0$ and nonnegative source $S \\ge 0$.\n\nConstruct this one-cell example explicitly and determine analytically the parameter regime in which the Lie-split update produces a negative concentration after the reaction substep. Specifically, derive a closed-form expression for the critical time step $\\Delta t_{\\text{crit}}$ such that for any $\\Delta t > \\Delta t_{\\text{crit}}$, the reaction substep can yield $c^{n+1} < 0$ starting from $c^{n} \\ge 0$. Express the final answer as an analytical expression for $\\Delta t_{\\text{crit}}$ in seconds. No numerical evaluation is required.",
            "solution": "The problem requires an analysis of a Lie-split numerical scheme for a one-cell atmospheric box model to determine the conditions under which it produces a non-physical negative concentration.\n\nThe governing ordinary differential equation (ODE) for the pollutant concentration $c(t)$ is given by:\n$$\n\\frac{dc}{dt} = S - \\lambda c\n$$\nwhere $c(t) \\ge 0$ is the concentration, $S \\ge 0$ is a constant source rate, and $\\lambda > 0$ is a constant first-order loss rate coefficient.\n\nThe operator on the right-hand side is split into a source operator and a reaction operator. We define a numerical update from a known concentration $c^n$ at the beginning of a time step of length $\\Delta t > 0$ to a new concentration $c^{n+1}$ at the end of the step. The Lie splitting scheme is applied by sequentially solving the two subproblems.\n\n**Step 1: Source Subproblem**\n\nThe first substep involves integrating the source subproblem exactly over the time interval $[t_n, t_n + \\Delta t]$. The source subproblem is:\n$$\n\\frac{dc}{dt} = S\n$$\nLet the concentration at the beginning of the time step be $c(t_n) = c^n$. We integrate this equation from $t_n$ to $t_n + \\Delta t$:\n$$\n\\int_{c^n}^{c^*} dc' = \\int_{t_n}^{t_n + \\Delta t} S \\, dt'\n$$\nwhere $c^*$ denotes the intermediate concentration after this first substep. Since $S$ is a constant, the integration yields:\n$$\nc^* - c^n = S \\cdot ((t_n + \\Delta t) - t_n) = S \\Delta t\n$$\nThus, the intermediate concentration is:\n$$\nc^* = c^n + S \\Delta t\n$$\nGiven the initial conditions $c^n \\ge 0$, $S \\ge 0$, and $\\Delta t > 0$, it is guaranteed that this intermediate concentration $c^*$ is non-negative, i.e., $c^* \\ge c^n \\ge 0$.\n\n**Step 2: Reaction Subproblem**\n\nThe second substep involves integrating the reaction subproblem over the same time interval $\\Delta t$, using the intermediate concentration $c^*$ as the initial condition. The integration is performed using the first-order forward Euler method. The reaction subproblem is:\n$$\n\\frac{dc}{dt} = -\\lambda c\n$$\nThe forward Euler method approximates the solution to an ODE of the form $\\frac{dy}{dt} = f(y)$ with the update rule $y_{k+1} = y_k + \\Delta t \\cdot f(y_k)$. In our case, $y$ is the concentration $c$ and the function is $f(c) = -\\lambda c$. The initial value for this substep is $c^*$, and the final value is $c^{n+1}$. Applying the forward Euler formula gives:\n$$\nc^{n+1} = c^* + \\Delta t (-\\lambda c^*)\n$$\nFactoring out $c^*$, we obtain the expression for the updated concentration:\n$$\nc^{n+1} = c^* (1 - \\lambda \\Delta t)\n$$\n\n**Step 3: Combined Update and Analysis**\n\nBy substituting the expression for $c^*$ from Step 1 into the result of Step 2, we derive the complete one-step update formula for the Lie splitting scheme:\n$$\nc^{n+1} = (c^n + S \\Delta t)(1 - \\lambda \\Delta t)\n$$\nThe problem asks for the condition under which this numerical scheme can produce a negative concentration, i.e., $c^{n+1} < 0$. We must therefore solve the following inequality:\n$$\n(c^n + S \\Delta t)(1 - \\lambda \\Delta t) < 0\n$$\nWe analyze the signs of the two factors on the left-hand side.\nThe first factor is $(c^n + S \\Delta t)$. Based on the problem statement, we have $c^n \\ge 0$, $S \\ge 0$, and $\\Delta t > 0$. Therefore, the term $S \\Delta t$ is non-negative. The sum $c^n + S \\Delta t$ is also non-negative. A negative concentration $c^{n+1}$ can only occur if this term is strictly positive, which is true for any non-trivial case where either $c^n > 0$ or $S > 0$. If both $c^n=0$ and $S=0$, then $c^{n+1}=0$ and no negativity occurs. Thus, for negativity to be possible, we must have $c^n + S \\Delta t > 0$.\n\nSince the first factor $(c^n + S \\Delta t)$ is positive, for the product to be negative, the second factor $(1 - \\lambda \\Delta t)$ must be negative:\n$$\n1 - \\lambda \\Delta t < 0\n$$\nSolving this inequality for $\\Delta t$:\n$$\n1 < \\lambda \\Delta t\n$$\nSince $\\lambda > 0$, we can divide by $\\lambda$ without changing the inequality direction:\n$$\n\\Delta t > \\frac{1}{\\lambda}\n$$\nThis inequality defines the regime in which the numerical scheme can produce a negative concentration. For any time step $\\Delta t$ greater than $\\frac{1}{\\lambda}$, the factor $(1 - \\lambda \\Delta t)$ will be negative, and as long as we are not in the trivial state where $c^n=0$ and $S=0$, the resulting concentration $c^{n+1}$ will be negative.\n\nThe critical time step, $\\Delta t_{\\text{crit}}$, is the threshold above which this non-physical behavior becomes possible. This corresponds to the boundary of the derived stability region. Therefore, the critical time step is:\n$$\n\\Delta t_{\\text{crit}} = \\frac{1}{\\lambda}\n$$\nFor any $\\Delta t > \\Delta t_{\\text{crit}}$, there exist valid initial conditions (e.g., any $c^n > 0$) for which the scheme yields $c^{n+1} < 0$. The units of $\\lambda$ are inverse time (e.g., $s^{-1}$), so the units of $\\Delta t_{\\text{crit}}$ are time (e.g., $s$), as required.",
            "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$"
        },
        {
            "introduction": "The local error of an operator splitting scheme is fundamentally governed by the extent to which the operators fail to commute. This practice provides a concrete, hands-on calculation of the commutator, $[\\mathcal{A}, \\mathcal{R}]$, for discrete advection and reaction operators on a simple periodic grid. By working through the step-by-step computation, you will gain a tangible understanding of how the non-interchangeable nature of physical processes translates into a quantifiable numerical error source .",
            "id": "3903150",
            "problem": "Consider a one-dimensional, incompressible transport of a passive scalar field undergoing first-order decay on a periodic domain. The fundamental mass conservation for a scalar concentration $u(x,t)$ advected with constant velocity $v$ and reacting with a spatially varying first-order rate $k(x)$ is\n$$\n\\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = -k(x)\\,u.\n$$\nOperator splitting approximates the right-hand side by applying advection and reaction sub-operators separately. A key measure of splitting error is the commutator between the discrete advection operator $\\mathcal{A}$ and the discrete reaction operator $\\mathcal{R}$, defined as\n$$\n[\\mathcal{A},\\mathcal{R}]\\,u := \\mathcal{A}(\\mathcal{R}(u)) - \\mathcal{R}(\\mathcal{A}(u)).\n$$\nOn a uniform, periodic grid with $N=4$ points, domain length $L=1$, and grid spacing $\\Delta x = L/N$, index the grid nodes by $i \\in \\{0,1,2,3\\}$ with periodic extension $u_{-1} = u_3$ and $u_4 = u_0$. Let the discrete advection operator be the standard second-order central-difference approximation of the spatial derivative scaled by $-v$:\n$$\n(\\mathcal{A}(u))_i = -v \\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x},\n$$\nand let the discrete reaction operator be pointwise multiplication by the negative rate:\n$$\n(\\mathcal{R}(u))_i = -k_i\\,u_i,\\quad \\text{with }k_i = k(x_i).\n$$\nTake $v = 0.8$, $x_i = i\\,\\Delta x$, and prescribe the fields\n$$\nu(x) = \\sin(2\\pi x) + \\tfrac{1}{2}\\cos(4\\pi x),\\qquad k(x) = 1 + 0.3\\cos(2\\pi x).\n$$\nUsing these definitions and values, compute the discrete commutator vector $([\\mathcal{A},\\mathcal{R}]\\,u)_i$ for $i=0,1,2,3$ and then quantify its magnitude by the discrete Euclidean norm\n$$\n\\|[\\mathcal{A},\\mathcal{R}]\\,u\\|_2 = \\left(\\sum_{i=0}^{3} \\left([\\mathcal{A},\\mathcal{R}]\\,u\\right)_i^2\\right)^{1/2}.\n$$\nExpress the final magnitude as a dimensionless number and round your answer to four significant figures.",
            "solution": "The objective is to compute the Euclidean norm of the commutator vector $([\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u})_i$ for the given discrete operators and fields.\n\nFirst, we set up the grid and parameters. The grid has $N=4$ points over a domain of length $L=1$, so the grid spacing is $\\Delta x = L/N = 0.25$. The grid points are $x_0=0$, $x_1=0.25$, $x_2=0.5$, and $x_3=0.75$. The velocity is $v=0.8$. The constant prefactor in the advection operator is $\\frac{-v}{2\\Delta x} = \\frac{-0.8}{2(0.25)} = -1.6$.\n\nNext, we evaluate the scalar field $u(x)$ and rate field $k(x)$ at the grid points to get discrete vectors $\\mathbf{u}$ and $\\mathbf{k}$.\nFor the scalar field $\\mathbf{u} = (u_0, u_1, u_2, u_3)$:\n$u_0 = u(0) = \\sin(0) + \\frac{1}{2}\\cos(0) = 0.5$\n$u_1 = u(0.25) = \\sin(\\pi/2) + \\frac{1}{2}\\cos(\\pi) = 1 - 0.5 = 0.5$\n$u_2 = u(0.5) = \\sin(\\pi) + \\frac{1}{2}\\cos(2\\pi) = 0 + 0.5 = 0.5$\n$u_3 = u(0.75) = \\sin(3\\pi/2) + \\frac{1}{2}\\cos(3\\pi) = -1 - 0.5 = -1.5$\nSo, $\\mathbf{u} = \\begin{pmatrix} 0.5, 0.5, 0.5, -1.5 \\end{pmatrix}^T$.\n\nFor the rate field $\\mathbf{k} = (k_0, k_1, k_2, k_3)$:\n$k_0 = k(0) = 1 + 0.3\\cos(0) = 1.3$\n$k_1 = k(0.25) = 1 + 0.3\\cos(\\pi/2) = 1.0$\n$k_2 = k(0.5) = 1 + 0.3\\cos(\\pi) = 1 - 0.3 = 0.7$\n$k_3 = k(0.75) = 1 + 0.3\\cos(3\\pi/2) = 1.0$\nSo, $\\mathbf{k} = \\begin{pmatrix} 1.3, 1.0, 0.7, 1.0 \\end{pmatrix}^T$.\n\nThe commutator is $[\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u} = \\mathcal{A}(\\mathcal{R}(\\mathbf{u})) - \\mathcal{R}(\\mathcal{A}(\\mathbf{u}))$. We compute each term.\n\nTo compute $\\mathcal{A}(\\mathcal{R}(\\mathbf{u}))$, first find $\\mathbf{w} = \\mathcal{R}(\\mathbf{u})$, where $w_i = -k_i u_i$:\n$w_0 = -1.3 \\times 0.5 = -0.65$\n$w_1 = -1.0 \\times 0.5 = -0.5$\n$w_2 = -0.7 \\times 0.5 = -0.35$\n$w_3 = -1.0 \\times (-1.5) = 1.5$\nSo, $\\mathbf{w} = \\begin{pmatrix} -0.65, -0.5, -0.35, 1.5 \\end{pmatrix}^T$.\nNow, apply $\\mathcal{A}$ to $\\mathbf{w}$, using periodic indices ($w_{-1}=w_3$, $w_4=w_0$):\n$(\\mathcal{A}(\\mathbf{w}))_0 = -1.6(w_1 - w_3) = -1.6(-0.5 - 1.5) = 3.2$\n$(\\mathcal{A}(\\mathbf{w}))_1 = -1.6(w_2 - w_0) = -1.6(-0.35 - (-0.65)) = -0.48$\n$(\\mathcal{A}(\\mathbf{w}))_2 = -1.6(w_3 - w_1) = -1.6(1.5 - (-0.5)) = -3.2$\n$(\\mathcal{A}(\\mathbf{w}))_3 = -1.6(w_0 - w_2) = -1.6(-0.65 - (-0.35)) = 0.48$\nThus, $\\mathcal{A}(\\mathcal{R}(\\mathbf{u})) = \\begin{pmatrix} 3.2, -0.48, -3.2, 0.48 \\end{pmatrix}^T$.\n\nTo compute $\\mathcal{R}(\\mathcal{A}(\\mathbf{u}))$, first find $\\mathbf{z} = \\mathcal{A}(\\mathbf{u})$, where $z_i = -1.6(u_{i+1} - u_{i-1})$:\n$z_0 = -1.6(u_1 - u_3) = -1.6(0.5 - (-1.5)) = -3.2$\n$z_1 = -1.6(u_2 - u_0) = -1.6(0.5 - 0.5) = 0$\n$z_2 = -1.6(u_3 - u_1) = -1.6(-1.5 - 0.5) = 3.2$\n$z_3 = -1.6(u_0 - u_2) = -1.6(0.5 - 0.5) = 0$\nSo, $\\mathbf{z} = \\begin{pmatrix} -3.2, 0, 3.2, 0 \\end{pmatrix}^T$.\nNow, apply $\\mathcal{R}$ to $\\mathbf{z}$, where $(\\mathcal{R}(\\mathbf{z}))_i = -k_i z_i$:\n$(\\mathcal{R}(\\mathbf{z}))_0 = -1.3 \\times (-3.2) = 4.16$\n$(\\mathcal{R}(\\mathbf{z}))_1 = -1.0 \\times 0 = 0$\n$(\\mathcal{R}(\\mathbf{z}))_2 = -0.7 \\times 3.2 = -2.24$\n$(\\mathcal{R}(\\mathbf{z}))_3 = -1.0 \\times 0 = 0$\nThus, $\\mathcal{R}(\\mathcal{A}(\\mathbf{u})) = \\begin{pmatrix} 4.16, 0, -2.24, 0 \\end{pmatrix}^T$.\n\nNow we compute the commutator vector $\\mathbf{c} = [\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u}$:\n$c_0 = 3.2 - 4.16 = -0.96$\n$c_1 = -0.48 - 0 = -0.48$\n$c_2 = -3.2 - (-2.24) = -0.96$\n$c_3 = 0.48 - 0 = 0.48$\nThe commutator vector is $\\mathbf{c} = \\begin{pmatrix} -0.96, -0.48, -0.96, 0.48 \\end{pmatrix}^T$.\n\nFinally, we compute the discrete Euclidean norm $\\|\\mathbf{c}\\|_2$:\n$\\|\\mathbf{c}\\|_2 = \\sqrt{(-0.96)^2 + (-0.48)^2 + (-0.96)^2 + (0.48)^2}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{0.9216 + 0.2304 + 0.9216 + 0.2304}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{2.304} \\approx 1.517893$\n\nRounding to four significant figures gives $1.518$.",
            "answer": "$$\\boxed{1.518}$$"
        },
        {
            "introduction": "Splitting errors can arise from subtle sources, including the numerical treatment of boundaries. This exercise explores how non-commutativity can be induced between advection and diffusion operators, not because of the underlying physics, but due to the use of different boundary condition types for each split sub-step. Deriving the discrete matrix operators and their commutator will reveal a \"boundary commutator\" term, providing a powerful illustration of how implementation details can introduce localized errors in practical models .",
            "id": "3903181",
            "problem": "Consider a one-dimensional tracer concentration field $u(x,t)$ in a channel of length $L$ governed by the conservation law for transport with constant advection velocity $v>0$ and molecular diffusivity $\\kappa>0$. The governing Partial Differential Equation (PDE) is $u_{t} = -v\\,u_{x} + \\kappa\\,u_{xx}$. In operator-splitting terminology, define the advection operator $A$ and the diffusion operator $B$ such that the full generator is $A+B$. In realistic environmental modeling, boundary treatments for split substeps often differ, which can induce non-commutation at the discrete level.\n\nLet the spatial domain be discretized by a uniform two-cell finite-volume mesh with cell centers at $x_{1}=h/2$ and $x_{2}=3h/2$, where $h=L/2$. Denote the cell-average state vector by $\\boldsymbol{u}=\\begin{pmatrix}u_{1} \\\\ u_{2}\\end{pmatrix}$. Construct $A$ using an upwind finite-volume advection flux consistent with $v>0$ and a homogeneous Dirichlet inflow boundary condition at $x=0$ for the advection substep, i.e., $u(0,t)=0$ is enforced for $A$. At $x=L$ for advection, use the natural outflow closure implied by upwinding for $v>0$. Construct $B$ using a centered finite-volume diffusion flux with homogeneous Neumann no-flux boundary conditions for the diffusion substep, i.e., $u_{x}(0,t)=0$ and $u_{x}(L,t)=0$ for $B$.\n\nStarting from the finite-volume form of the conservation law, where the time rate of change in each cell equals the net flux difference divided by the cell width $h$, derive the $2\\times 2$ matrices $A$ and $B$ that map $\\boldsymbol{u}$ to the semi-discrete right-hand side contributions from advection and diffusion, respectively. Then, form the commutator $[A,B]=AB-BA$ and identify the component driven purely by the boundary closures. Define the boundary commutator at the inflow boundary to be the $(1,1)$ entry of $[A,B]$, which reflects how boundary enforcement at $x=0$ in the split substeps breaks commutativity. Compute this $(1,1)$ entry as a closed-form symbolic expression in terms of $v$, $\\kappa$, and $h$.\n\nProvide your final answer as a single closed-form analytical expression in terms of $v$, $\\kappa$, and $h$. Do not attach units to the expression.",
            "solution": "The goal is to find the $(1,1)$ entry of the commutator $[A,B]=AB-BA$ for the discrete advection operator $A$ and diffusion operator $B$ on a two-cell grid. The semi-discrete finite-volume equation for a cell $i$ is $\\frac{d u_i}{dt} = \\frac{1}{h} (F_{i-1/2} - F_{i+1/2})$, where $F$ is the flux at the cell faces.\n\n**1. Derivation of the Advection Matrix $A$**\nThe advection equation is $u_t = -v u_x$. In conservative form, $u_t + (vu)_x = 0$, so the flux is $F_{adv} = vu$. Using an upwind scheme for $v>0$, the flux at an interface is determined by the upwind (left) cell's state. The evolution is $\\frac{du_i}{dt} = -\\frac{1}{h}(F_{adv, i+1/2} - F_{adv, i-1/2})$.\n\nFor cell 1 (interfaces at $x=0, h$):\nThe inflow flux at $x=0$ uses the Dirichlet condition $u(0,t)=0$, so $F_{adv, 1/2} = v u(0) = 0$.\nThe flux at $x=h$ is from the upwind cell 1, so $F_{adv, 3/2} = v u_1$.\n$$ \\frac{d u_1}{dt} = -\\frac{1}{h} (v u_1 - 0) = -\\frac{v}{h} u_1 $$\nFor cell 2 (interfaces at $x=h, 2h=L$):\nThe inflow flux at $x=h$ is $F_{adv, 3/2} = v u_1$.\nThe outflow flux at $x=L$ uses the upwind cell 2, so $F_{adv, 5/2} = v u_2$.\n$$ \\frac{d u_2}{dt} = -\\frac{1}{h} (v u_2 - v u_1) = \\frac{v}{h} u_1 - \\frac{v}{h} u_2 $$\nThese equations give the matrix $A$:\n$$ A = \\frac{v}{h} \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\end{pmatrix} $$\n\n**2. Derivation of the Diffusion Matrix $B$**\nThe diffusion equation is $u_t = \\kappa u_{xx}$. In conservative form, $u_t - (\\kappa u_x)_x = 0$. The flux is $F_{diff} = -\\kappa u_x$. Using a centered difference for the gradient, $u_x|_{x_{i+1/2}} \\approx \\frac{u_{i+1}-u_i}{h}$. The evolution is $\\frac{du_i}{dt} = -\\frac{1}{h}(F_{diff, i+1/2} - F_{diff, i-1/2})$.\n\nFor cell 1 (interfaces at $x=0, h$):\nThe flux at $x=0$ uses the no-flux condition $u_x(0,t)=0$, so $F_{diff, 1/2} = -\\kappa u_x(0) = 0$.\nThe flux at $x=h$ is $F_{diff, 3/2} = -\\kappa \\frac{u_2 - u_1}{h}$.\n$$ \\frac{d u_1}{dt} = -\\frac{1}{h} \\left( -\\kappa \\frac{u_2 - u_1}{h} - 0 \\right) = \\frac{\\kappa}{h^2}(u_2 - u_1) = -\\frac{\\kappa}{h^2} u_1 + \\frac{\\kappa}{h^2} u_2 $$\nFor cell 2 (interfaces at $x=h, 2h=L$):\nThe flux at $x=h$ is $F_{diff, 3/2} = -\\kappa \\frac{u_2 - u_1}{h}$.\nThe flux at $x=L$ uses the no-flux condition $u_x(L,t)=0$, so $F_{diff, 5/2} = 0$.\n$$ \\frac{d u_2}{dt} = -\\frac{1}{h} \\left( 0 - \\left(-\\kappa \\frac{u_2 - u_1}{h}\\right) \\right) = -\\frac{\\kappa}{h^2} (u_2 - u_1) = \\frac{\\kappa}{h^2} u_1 - \\frac{\\kappa}{h^2} u_2 $$\nThese equations give the matrix $B$:\n$$ B = \\frac{\\kappa}{h^2} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\n\n**3. Computation of the Commutator $[A,B]$**\nThe commutator is $[A,B] = AB - BA$.\nFirst, calculate the product $AB$:\n$$ AB = \\left( \\frac{v}{h} \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\end{pmatrix} \\right) \\left( \\frac{\\kappa}{h^2} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right) = \\frac{v\\kappa}{h^3} \\begin{pmatrix} 1 & -1 \\\\ -2 & 2 \\end{pmatrix} $$\nNext, calculate the product $BA$:\n$$ BA = \\left( \\frac{\\kappa}{h^2} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right) \\left( \\frac{v}{h} \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\end{pmatrix} \\right) = \\frac{v\\kappa}{h^3} \\begin{pmatrix} 2 & -1 \\\\ -2 & 1 \\end{pmatrix} $$\nNow, subtract the products:\n$$ [A,B] = AB - BA = \\frac{v\\kappa}{h^3} \\left( \\begin{pmatrix} 1 & -1 \\\\ -2 & 2 \\end{pmatrix} - \\begin{pmatrix} 2 & -1 \\\\ -2 & 1 \\end{pmatrix} \\right) = \\frac{v\\kappa}{h^3} \\begin{pmatrix} -1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\nThe $(1,1)$ entry of the commutator matrix is the boundary commutator at the inflow.\n$$ [A,B]_{(1,1)} = -\\frac{v\\kappa}{h^3} $$",
            "answer": "$$\\boxed{-\\frac{v\\kappa}{h^3}}$$"
        }
    ]
}