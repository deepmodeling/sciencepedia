{
    "hands_on_practices": [
        {
            "introduction": "算子分裂方法的核心挑战在于物理过程的不可交换性。这个练习旨在将分裂误差的根本来源——算子对易子 (commutator) ——这一抽象概念具体化。通过在一个简单的离散网格上直接计算平流和反应算子的对易子 $[\\mathcal{A},\\mathcal{R}] = \\mathcal{A}(\\mathcal{R}(u)) - \\mathcal{R}(\\mathcal{A}(u))$，你将亲手量化不同算子应用顺序所导致的差异。这个差异的大小直接衡量了算子分裂在一小步内引入的局部误差，为理解和预测分裂格式的精度提供了基本工具。",
            "id": "3903150",
            "problem": "考虑一个在周期性域上经历一阶衰减的被动标量场的一维不可压缩输运。一个标量浓度 $u(x,t)$ 以恒定速度 $v$ 平流，并与空间变化的一阶速率 $k(x)$ 发生反应，其基本质量守恒方程为\n$$\n\\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = -k(x)\\,u.\n$$\n算子分裂法通过分别应用平流和反应子算子来近似右侧项。分裂误差的一个关键度量是离散平流算子 $\\mathcal{A}$ 和离散反应算子 $\\mathcal{R}$ 之间的对易子，定义为\n$$\n[\\mathcal{A},\\mathcal{R}]\\,u := \\mathcal{A}(\\mathcal{R}(u)) - \\mathcal{R}(\\mathcal{A}(u)).\n$$\n在一个具有 $N=4$ 个点、域长度 $L=1$、网格间距 $\\Delta x = L/N$ 的均匀周期性网格上，用 $i \\in \\{0,1,2,3\\}$ 索引网格节点，并具有周期性延拓 $u_{-1} = u_3$ 和 $u_4 = u_0$。设离散平流算子为空间导数的标准二阶中心差分近似，并按 $-v$ 进行缩放：\n$$\n(\\mathcal{A}(u))_i = -v \\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x},\n$$\n并设离散反应算子为与负速率的逐点相乘：\n$$\n(\\mathcal{R}(u))_i = -k_i\\,u_i,\\quad \\text{with }k_i = k(x_i).\n$$\n取 $v = 0.8$，$x_i = i\\,\\Delta x$，并规定场函数为\n$$\nu(x) = \\sin(2\\pi x) + \\tfrac{1}{2}\\cos(4\\pi x),\\qquad k(x) = 1 + 0.3\\cos(2\\pi x).\n$$\n使用这些定义和数值，计算离散对易子向量 $([\\mathcal{A},\\mathcal{R}]\\,u)_i$（对于 $i=0,1,2,3$），然后通过离散欧几里得范数来量化其大小\n$$\n\\|[\\mathcal{A},\\mathcal{R}]\\,u\\|_2 = \\left(\\sum_{i=0}^{3} \\left([\\mathcal{A},\\mathcal{R}]\\,u\\right)_i^2\\right)^{1/2}.\n$$\n将最终的大小表示为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "用户要求计算在周期性网格上为平流-反应系统定义的离散算子对易子的欧几里得范数。\n\n### 步骤 1：问题验证\n\n**提取已知条件：**\n-   控制方程：$\\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = -k(x)\\,u$。\n-   域：一维，周期性，长度 $L=1$。\n-   网格：均匀，有 $N=4$ 个点，由 $i \\in \\{0, 1, 2, 3\\}$ 索引。\n-   网格间距：$\\Delta x = L/N$。\n-   网格点：$x_i = i\\,\\Delta x$。\n-   周期性条件：$u_{-1} = u_3$ 和 $u_4 = u_0$。\n-   离散平流算子：$(\\mathcal{A}(u))_i = -v \\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x}$。\n-   离散反应算子：$(\\mathcal{R}(u))_i = -k_i\\,u_i$，其中 $k_i = k(x_i)$。\n-   对易子定义：$[\\mathcal{A},\\mathcal{R}]\\,u := \\mathcal{A}(\\mathcal{R}(u)) - \\mathcal{R}(\\mathcal{A}(u))$。\n-   标量场：$u(x) = \\sin(2\\pi x) + \\frac{1}{2}\\cos(4\\pi x)$。\n-   速率场：$k(x) = 1 + 0.3\\cos(2\\pi x)$。\n-   速度：$v = 0.8$。\n-   目标量：离散欧几里得范数 $\\|[\\mathcal{A},\\mathcal{R}]\\,u\\|_2 = \\left(\\sum_{i=0}^{3} \\left([\\mathcal{A},\\mathcal{R}]\\,u\\right)_i^2\\right)^{1/2}$。\n-   要求输出：一个四舍五入到四位有效数字的无量纲数。\n\n**使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题描述了平流-反应方程的数值分析，这是输运现象中的一个基本模型。所用算子为标准的二阶中心差分和逐点相乘，这在有限差分法中很常见。对易子是用于分析分裂误差的标准数学概念。该问题在数值分析和应用数学方面有坚实的理论基础。\n-   **适定性：** 提供了所有必要的数据、函数和定义。任务是一个直接的计算，其结果是唯一确定的。\n-   **客观性：** 问题以精确的数学和数值术语陈述，没有主观性语言。\n-   **完整性和一致性：** 问题是自洽的，没有矛盾。对于给定的网格尺寸和算子模板，周期性边界条件被正确指定。\n-   **真实性和可行性：** 所选参数和函数对于一个模型问题是物理上合理的。计算是可行的。\n\n**结论与行动：**\n问题有效。将提供完整的解答。\n\n### 步骤 2：求解\n\n目标是在离散网格上计算对易子向量 $([\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u})_i$ 的欧几里得范数。\n\n**2.1. 网格和参数设置**\n网格在长度为 $L=1$ 的域上有 $N=4$ 个点。网格间距为 $\\Delta x = \\frac{L}{N} = \\frac{1}{4} = 0.25$。网格点为：\n$x_0 = 0 \\cdot 0.25 = 0$\n$x_1 = 1 \\cdot 0.25 = 0.25$\n$x_2 = 2 \\cdot 0.25 = 0.5$\n$x_3 = 3 \\cdot 0.25 = 0.75$\n\n速度为 $v=0.8$。平流算子中的常数因子为 $\\frac{-v}{2\\Delta x} = \\frac{-0.8}{2(0.25)} = \\frac{-0.8}{0.5} = -1.6$。\n\n**2.2. 场的离散化**\n我们在网格点 $x_i$ 上评估标量场 $u(x)$ 和速率场 $k(x)$，以获得离散向量 $\\mathbf{u} = (u_0, u_1, u_2, u_3)$ 和 $\\mathbf{k} = (k_0, k_1, k_2, k_3)$。\n\n对于标量场 $\\mathbf{u}$：\n$u_0 = u(0) = \\sin(0) + \\frac{1}{2}\\cos(0) = 0 + \\frac{1}{2}(1) = 0.5$\n$u_1 = u(0.25) = \\sin(2\\pi \\cdot 0.25) + \\frac{1}{2}\\cos(4\\pi \\cdot 0.25) = \\sin(\\frac{\\pi}{2}) + \\frac{1}{2}\\cos(\\pi) = 1 + \\frac{1}{2}(-1) = 0.5$\n$u_2 = u(0.5) = \\sin(2\\pi \\cdot 0.5) + \\frac{1}{2}\\cos(4\\pi \\cdot 0.5) = \\sin(\\pi) + \\frac{1}{2}\\cos(2\\pi) = 0 + \\frac{1}{2}(1) = 0.5$\n$u_3 = u(0.75) = \\sin(2\\pi \\cdot 0.75) + \\frac{1}{2}\\cos(4\\pi \\cdot 0.75) = \\sin(\\frac{3\\pi}{2}) + \\frac{1}{2}\\cos(3\\pi) = -1 + \\frac{1}{2}(-1) = -1.5$\n离散标量向量为 $\\mathbf{u} = \\begin{pmatrix} 0.5 & 0.5 & 0.5 & -1.5 \\end{pmatrix}^T$。\n\n对于速率场 $\\mathbf{k}$：\n$k_0 = k(0) = 1 + 0.3\\cos(0) = 1 + 0.3(1) = 1.3$\n$k_1 = k(0.25) = 1 + 0.3\\cos(2\\pi \\cdot 0.25) = 1 + 0.3\\cos(\\frac{\\pi}{2}) = 1 + 0.3(0) = 1.0$\n$k_2 = k(0.5) = 1 + 0.3\\cos(2\\pi \\cdot 0.5) = 1 + 0.3\\cos(\\pi) = 1 + 0.3(-1) = 0.7$\n$k_3 = k(0.75) = 1 + 0.3\\cos(2\\pi \\cdot 0.75) = 1 + 0.3\\cos(\\frac{3\\pi}{2}) = 1 + 0.3(0) = 1.0$\n离散速率向量为 $\\mathbf{k} = \\begin{pmatrix} 1.3 & 1.0 & 0.7 & 1.0 \\end{pmatrix}^T$。\n\n**2.3. 对易子计算**\n对易子为 $[\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u} = \\mathcal{A}(\\mathcal{R}(\\mathbf{u})) - \\mathcal{R}(\\mathcal{A}(\\mathbf{u}))$。我们分别计算每一项。\n\n**第 1 项：$\\mathcal{A}(\\mathcal{R}(\\mathbf{u}))$**\n首先，将反应算子 $\\mathcal{R}$ 应用于 $\\mathbf{u}$。设 $\\mathbf{w} = \\mathcal{R}(\\mathbf{u})$，其中 $w_i = -k_i u_i$。\n$w_0 = -k_0 u_0 = -1.3 \\times 0.5 = -0.65$\n$w_1 = -k_1 u_1 = -1.0 \\times 0.5 = -0.5$\n$w_2 = -k_2 u_2 = -0.7 \\times 0.5 = -0.35$\n$w_3 = -k_3 u_3 = -1.0 \\times (-1.5) = 1.5$\n所以，$\\mathbf{w} = \\begin{pmatrix} -0.65 & -0.5 & -0.35 & 1.5 \\end{pmatrix}^T$。\n\n接下来，将平流算子 $\\mathcal{A}$ 应用于 $\\mathbf{w}$。$(\\mathcal{A}(\\mathbf{w}))_i = -1.6(w_{i+1} - w_{i-1})$。索引是周期性的，所以 $w_{-1}=w_3$, $w_4=w_0$。\n$(\\mathcal{A}(\\mathbf{w}))_0 = -1.6(w_1 - w_3) = -1.6(-0.5 - 1.5) = -1.6(-2.0) = 3.2$\n$(\\mathcal{A}(\\mathbf{w}))_1 = -1.6(w_2 - w_0) = -1.6(-0.35 - (-0.65)) = -1.6(0.3) = -0.48$\n$(\\mathcal{A}(\\mathbf{w}))_2 = -1.6(w_3 - w_1) = -1.6(1.5 - (-0.5)) = -1.6(2.0) = -3.2$\n$(\\mathcal{A}(\\mathbf{w}))_3 = -1.6(w_4 - w_2) = -1.6(w_0 - w_2) = -1.6(-0.65 - (-0.35)) = -1.6(-0.3) = 0.48$\n因此，$\\mathcal{A}(\\mathcal{R}(\\mathbf{u})) = \\begin{pmatrix} 3.2 & -0.48 & -3.2 & 0.48 \\end{pmatrix}^T$。\n\n**第 2 项：$\\mathcal{R}(\\mathcal{A}(\\mathbf{u}))$**\n首先，将平流算子 $\\mathcal{A}$ 应用于 $\\mathbf{u}$。设 $\\mathbf{z} = \\mathcal{A}(\\mathbf{u})$，其中 $z_i = -1.6(u_{i+1} - u_{i-1})$。索引是周期性的，所以 $u_{-1}=u_3$, $u_4=u_0$。\n$z_0 = -1.6(u_1 - u_3) = -1.6(0.5 - (-1.5)) = -1.6(2.0) = -3.2$\n$z_1 = -1.6(u_2 - u_0) = -1.6(0.5 - 0.5) = 0$\n$z_2 = -1.6(u_3 - u_1) = -1.6(-1.5 - 0.5) = -1.6(-2.0) = 3.2$\n$z_3 = -1.6(u_4 - u_2) = -1.6(u_0 - u_2) = -1.6(0.5 - 0.5) = 0$\n所以，$\\mathbf{z} = \\begin{pmatrix} -3.2 & 0 & 3.2 & 0 \\end{pmatrix}^T$。\n\n接下来，将反应算子 $\\mathcal{R}$ 应用于 $\\mathbf{z}$。$(\\mathcal{R}(\\mathbf{z}))_i = -k_i z_i$。\n$(\\mathcal{R}(\\mathbf{z}))_0 = -k_0 z_0 = -1.3 \\times (-3.2) = 4.16$\n$(\\mathcal{R}(\\mathbf{z}))_1 = -k_1 z_1 = -1.0 \\times 0 = 0$\n$(\\mathcal{R}(\\mathbf{z}))_2 = -k_2 z_2 = -0.7 \\times 3.2 = -2.24$\n$(\\mathcal{R}(\\mathbf{z}))_3 = -k_3 z_3 = -1.0 \\times 0 = 0$\n因此，$\\mathcal{R}(\\mathcal{A}(\\mathbf{u})) = \\begin{pmatrix} 4.16 & 0 & -2.24 & 0 \\end{pmatrix}^T$。\n\n**对易子向量**\n设 $\\mathbf{c} = [\\mathcal{A},\\mathcal{R}]\\,\\mathbf{u} = \\mathcal{A}(\\mathcal{R}(\\mathbf{u})) - \\mathcal{R}(\\mathcal{A}(\\mathbf{u}))$。\n$c_0 = 3.2 - 4.16 = -0.96$\n$c_1 = -0.48 - 0 = -0.48$\n$c_2 = -3.2 - (-2.24) = -3.2 + 2.24 = -0.96$\n$c_3 = 0.48 - 0 = 0.48$\n对易子向量为 $\\mathbf{c} = \\begin{pmatrix} -0.96 & -0.48 & -0.96 & 0.48 \\end{pmatrix}^T$。\n\n**2.4. 欧几里得范数计算**\n对易子的大小是其离散欧几里得范数 $\\|\\mathbf{c}\\|_2$。\n$\\|\\mathbf{c}\\|_2 = \\sqrt{c_0^2 + c_1^2 + c_2^2 + c_3^2}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{(-0.96)^2 + (-0.48)^2 + (-0.96)^2 + (0.48)^2}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{0.9216 + 0.2304 + 0.9216 + 0.2304}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{2 \\times (0.9216 + 0.2304)}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{2 \\times 1.152}$\n$\\|\\mathbf{c}\\|_2 = \\sqrt{2.304}$\n$\\|\\mathbf{c}\\|_2 \\approx 1.517893277...$\n\n四舍五入到四位有效数字，结果是 $1.518$。",
            "answer": "$$\\boxed{1.518}$$"
        },
        {
            "introduction": "理解了对易子是误差的来源后，一个自然的问题是：这种误差在实践中会造成什么后果？这个练习将探讨算子分裂方法一个严重的失效模式：产生非物理的解，例如负浓度。你将分析一个看似无害的源-汇项分裂方案，并发现当对一个刚性 (stiff) 的汇项使用不稳定的数值方法（如前向欧拉法）时，会导致灾难性的结果。这个思想实验强调了在分裂时，仔细分析并为每个子问题选择恰当数值方法的重要性。",
            "id": "3903169",
            "problem": "考虑一个用于反应性污染物的单室大气箱式模型，其浓度为 $c(t) \\ge 0$。其局部质量平衡结合了排放源和一阶化学损失，\n$$\n\\frac{dc}{dt} \\;=\\; S \\;-\\; \\lambda\\,c,\n$$\n其中 $S \\ge 0$ 是一个恒定的源速率，$\\lambda > 0$ 是一个恒定的一阶损失速率系数。在分裂公式中，将右侧算子分解为一个源子问题和一个反应子问题：\n$$\n\\text{源子问题：}\\quad \\frac{dc}{dt} \\;=\\; S,\n\\qquad\n\\text{反应子问题：}\\quad \\frac{dc}{dt} \\;=\\; -\\lambda\\,c.\n$$\n通过先对源子问题进行积分，然后对反应子问题进行积分，在长度为 $\\Delta t > 0$ 的单个时间步上应用 Lie 分裂（也称为顺序分裂）。假设源子问题在 $\\Delta t$ 上精确积分，反应子问题使用一阶前向欧拉法在 $\\Delta t$ 上积分。假设初始浓度 $c^{n} \\ge 0$ 为非负，源 $S \\ge 0$ 为非负。\n\n明确地构建这个单室示例，并解析地确定参数范围，在该范围内，Lie 分裂更新在反应子步骤后会产生负浓度。具体来说，推导临界时间步 $\\Delta t_{\\text{crit}}$ 的一个封闭形式表达式，使得对于任何 $\\Delta t > \\Delta t_{\\text{crit}}$，从 $c^{n} \\ge 0$ 开始，反应子步骤都可能产生 $c^{n+1}  0$。将最终答案表示为 $\\Delta t_{\\text{crit}}$ 的解析表达式，单位为秒。不需要进行数值计算。",
            "solution": "该问题要求分析一个用于单室大气箱式模型的 Lie 分裂数值方案，以确定其在何种条件下会产生非物理的负浓度。\n\n污染物浓度 $c(t)$ 的控制常微分方程 (ODE) 由以下公式给出：\n$$\n\\frac{dc}{dt} = S - \\lambda c\n$$\n其中 $c(t) \\ge 0$ 是浓度，$S \\ge 0$ 是恒定的源速率，$\\lambda  0$ 是恒定的一阶损失速率系数。\n\n右侧的算子被分裂为一个源算子和一个反应算子。我们定义一个数值更新，从长度为 $\\Delta t  0$ 的时间步开始时的已知浓度 $c^n$ 更新到该时间步结束时的新浓度 $c^{n+1}$。Lie 分裂方案通过顺序求解两个子问题来应用。\n\n**步骤 1：源子问题**\n\n第一个子步骤涉及在时间区间 $[t_n, t_n + \\Delta t]$ 上精确积分源子问题。源子问题是：\n$$\n\\frac{dc}{dt} = S\n$$\n设时间步开始时的浓度为 $c(t_n) = c^n$。我们将此方程从 $t_n$ 积分到 $t_n + \\Delta t$：\n$$\n\\int_{c^n}^{c^*} dc' = \\int_{t_n}^{t_n + \\Delta t} S \\, dt'\n$$\n其中 $c^*$ 表示此第一个子步骤后的中间浓度。由于 $S$ 是一个常数，积分得到：\n$$\nc^* - c^n = S \\cdot ((t_n + \\Delta t) - t_n) = S \\Delta t\n$$\n因此，中间浓度为：\n$$\nc^* = c^n + S \\Delta t\n$$\n给定初始条件 $c^n \\ge 0$、$S \\ge 0$ 和 $\\Delta t  0$，可以保证这个中间浓度 $c^*$ 是非负的，即 $c^* \\ge c^n \\ge 0$。\n\n**步骤 2：反应子问题**\n\n第二个子步骤涉及在相同的时间间隔 $\\Delta t$ 内积分反应子问题，使用中间浓度 $c^*$ 作为初始条件。积分使用一阶前向欧拉法进行。反应子问题是：\n$$\n\\frac{dc}{dt} = -\\lambda c\n$$\n前向欧拉法通过更新规则 $y_{k+1} = y_k + \\Delta t \\cdot f(y_k)$ 来近似形式为 $\\frac{dy}{dt} = f(y)$ 的常微分方程的解。在我们的例子中，$y$ 是浓度 $c$，函数是 $f(c) = -\\lambda c$。此子步骤的初始值是 $c^*$，最终值是 $c^{n+1}$。应用前向欧拉公式得到：\n$$\nc^{n+1} = c^* + \\Delta t (-\\lambda c^*)\n$$\n提出因子 $c^*$，我们得到更新后浓度的表达式：\n$$\nc^{n+1} = c^* (1 - \\lambda \\Delta t)\n$$\n\n**步骤 3：组合更新与分析**\n\n通过将步骤 1 中 $c^*$ 的表达式代入步骤 2 的结果，我们推导出 Lie 分裂方案的完整单步更新公式：\n$$\nc^{n+1} = (c^n + S \\Delta t)(1 - \\lambda \\Delta t)\n$$\n问题要求找出该数值方案在何种条件下会产生负浓度，即 $c^{n+1}  0$。因此，我们必须解以下不等式：\n$$\n(c^n + S \\Delta t)(1 - \\lambda \\Delta t)  0\n$$\n我们分析左侧两个因子的符号。\n第一个因子是 $(c^n + S \\Delta t)$。根据问题陈述，我们有 $c^n \\ge 0$、$S \\ge 0$ 和 $\\Delta t  0$。因此，项 $S \\Delta t$ 是非负的。和 $c^n + S \\Delta t$ 也是非负的。只有当此项严格为正时，才可能出现负浓度 $c^{n+1}$，这在任何 $c^n  0$ 或 $S  0$ 的非平凡情况下都成立。如果 $c^n=0$ 且 $S=0$，则 $c^{n+1}=0$，不会出现负值。因此，为了可能出现负值，我们必须有 $c^n + S \\Delta t  0$。\n\n由于第一个因子 $(c^n + S \\Delta t)$ 是正的，要使乘积为负，第二个因子 $(1 - \\lambda \\Delta t)$ 必须是负的：\n$$\n1 - \\lambda \\Delta t  0\n$$\n解这个关于 $\\Delta t$ 的不等式：\n$$\n1  \\lambda \\Delta t\n$$\n由于 $\\lambda  0$，我们可以除以 $\\lambda$ 而不改变不等号的方向：\n$$\n\\Delta t  \\frac{1}{\\lambda}\n$$\n这个不等式定义了数值方案可能产生负浓度的范围。对于任何大于 $\\frac{1}{\\lambda}$ 的时间步 $\\Delta t$，因子 $(1 - \\lambda \\Delta t)$ 将为负，并且只要我们不处于 $c^n=0$ 和 $S=0$ 的平凡状态，所得浓度 $c^{n+1}$ 将为负。\n\n临界时间步 $\\Delta t_{\\text{crit}}$ 是这种非物理行为变得可能的阈值。这对应于所推导的稳定区域的边界。因此，临界时间步为：\n$$\n\\Delta t_{\\text{crit}} = \\frac{1}{\\lambda}\n$$\n对于任何 $\\Delta t > \\Delta t_{\\text{crit}}$，都存在有效的初始条件（例如，任何 $c^n  0$），使得该方案产生 $c^{n+1}  0$。$\\lambda$ 的单位是时间的倒数（例如，$s^{-1}$），因此 $\\Delta t_{\\text{crit}}$ 的单位是时间（例如，$s$），符合要求。",
            "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$"
        },
        {
            "introduction": "分裂误差不仅源于连续物理过程的内禀属性，也可能由我们的数值离散化选择引入。本练习揭示了一个在真实模型中微妙但至关重要的误差来源：为不同的分裂子步骤使用不一致的边界条件。通过在一个简化的平流-扩散问题上推导算子矩阵，你将看到即使内部格式是相容的，边界处理上的差异也会催生非对易性。这突显了在设计分裂数值方案时，必须进行整体考虑，确保边界和内部处理的协调性。",
            "id": "3903181",
            "problem": "考虑一个长度为 $L$ 的通道中的一维示踪剂浓度场 $u(x,t)$，该场由具有恒定平流速度 $v0$ 和分子扩散率 $\\kappa0$ 的输运守恒律控制。其控制偏微分方程 (PDE) 为 $u_{t} = -v\\,u_{x} + \\kappa\\,u_{xx}$。按照算子分裂的术语，定义平流算子 $A$ 和扩散算子 $B$，使得完整的生成元为 $A+B$。在实际的环境模拟中，分裂子步骤的边界处理方式常常不同，这会在离散层面上引起非对易性。\n\n设空间域通过一个均匀的双单元有限体积网格进行离散化，单元中心位于 $x_{1}=h/2$ 和 $x_{2}=3h/2$，其中 $h=L/2$。用 $\\boldsymbol{u}=\\begin{pmatrix}u_{1} \\\\ u_{2}\\end{pmatrix}$ 表示单元平均状态向量。使用与 $v0$ 一致的迎风有限体积平流通量以及在 $x=0$ 处的齐次狄利克雷入流边界条件来为平流子步骤构建 $A$，即对 $A$ 强制施加 $u(0,t)=0$。在 $x=L$ 处的平流，使用由 $v0$ 的迎风格式所隐含的自然出流闭合。使用中心有限体积扩散通量以及为扩散子步骤设定的齐次诺伊曼无通量边界条件来构建 $B$，即对 $B$ 强制施加 $u_{x}(0,t)=0$ 和 $u_{x}(L,t)=0$。\n\n从守恒律的有限体积形式出发，其中每个单元的时间变化率等于净通量差除以单元宽度 $h$，推导出将 $\\boldsymbol{u}$ 分别映射到平流和扩散的半离散右端项贡献的 $2\\times 2$ 矩阵 $A$ 和 $B$。然后，构造对易子 $[A,B]=AB-BA$，并识别出纯粹由边界闭合驱动的分量。将入流边界处的边界对易子定义为 $[A,B]$ 的 $(1,1)$ 元素，它反映了在分裂子步骤中 $x=0$ 处的边界强制如何破坏对易性。以 $v$、$\\kappa$ 和 $h$ 的形式，计算这个 $(1,1)$ 元素的闭式符号表达式。\n\n你的最终答案应为单个以 $v$、$\\kappa$ 和 $h$ 表示的闭式解析表达式。不要为表达式附加单位。",
            "solution": "用户希望在一个双单元有限体积网格上，求两个离散算子 $A$（平流）和 $B$（扩散）的对易子 $[A,B]=AB-BA$ 的 $(1,1)$ 元素。问题的核心在于，算子 $A$ 和 $B$ 在入流边界 $x=0$ 处是使用不同的边界条件构建的，这导致了非对易性。\n\n首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **控制偏微分方程**：$u_{t} = -v\\,u_{x} + \\kappa\\,u_{xx}$，用于描述示踪剂浓度 $u(x,t)$。\n- **参数**：恒定平流速度 $v0$，恒定分子扩散率 $\\kappa0$。\n- **域**：一个长度为 $L$ 的通道。\n- **算子**：平流算子 $A$，扩散算子 $B$。完整的演化算子为 $A+B$。\n- **离散化**：在域 $[0,L]$ 上的一个均匀双单元有限体积网格。\n- **单元宽度**：$h = L/2$。\n- **单元中心**：单元 1 (从 $x=0$到$x=h$) 的中心为 $x_{1}=h/2$，单元 2 (从 $x=h$ 到 $x=L=2h$) 的中心为 $x_{2}=3h/2$。\n- **状态向量**：$\\boldsymbol{u}=\\begin{pmatrix}u_{1} \\\\ u_{2}\\end{pmatrix}$，表示单元平均浓度。\n- **算子 A (平流)**：\n  - 离散化：针对 $v0$ 的迎风有限体积通量。\n  - 边界条件：入流处为齐次狄利克雷条件，$u(0,t)=0$。在 $x=L$ 处为自然出流。\n- **算子 B (扩散)**：\n  - 离散化：中心有限体积通量。\n  - 边界条件：双边界均为齐次诺伊曼（无通量）条件，$u_{x}(0,t)=0$ 和 $u_{x}(L,t)=0$。\n- **任务**：推导 $2 \\times 2$ 矩阵 $A$ 和 $B$，构造对易子 $[A,B]$，并计算其 $(1,1)$ 元素。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一个标准的平流-扩散过程，并采用了常用的数值离散化技术（有限体积法、迎风格式、中心差分）。算子分裂的概念以及由不一致的边界处理引起的非对易性是偏微分方程数值分析领域一个成熟的研究课题。该问题是适定的，提供了构建离散算子和计算其对易子所需的所有必要信息。其语言精确且客观。没有矛盾或不切实际的假设。因此，该问题被认为是**有效的**。\n\n### 步骤 3：解的推导\n\n对于宽度为 $h$ 的单元 $i$，其半离散有限体积形式由下式给出：\n$$ \\frac{d u_i}{dt} = \\frac{1}{h} (F_{i-1/2} - F_{i+1/2}) $$\n其中 $F_{i \\pm 1/2}$ 表示单元面上的通量。完整的控制方程为 $u_{t} = -\\frac{\\partial}{\\partial x}(vu - \\kappa u_x)$。我们将分别构建平流算子 $A$ 和扩散算子 $B$ 的矩阵，使得 $\\frac{d\\boldsymbol{u}}{dt} = (A+B)\\boldsymbol{u}$。\n\n**1. 平流矩阵 $A$ 的推导**\n\n平流方程为 $u_t = -v u_x$。其守恒形式为 $u_t + (vu)_x = 0$，因此通量为 $F_{adv} = vu$。我们对 $v0$ 使用迎风格式，这意味着界面处的通量由迎风（左侧）单元的状态决定。单元平均值的方程为 $\\frac{du_i}{dt} = -\\frac{1}{h}(F_{adv, i+1/2} - F_{adv, i-1/2})$。\n\n- **对于单元 1 (从 $x=0$ 到 $x=h$)**：\n  界面位于 $x_{1/2}=0$ 和 $x_{3/2}=h$。\n  入流边界 $x_{1/2}=0$ 处的通量由狄利克雷边界条件 $u(0,t)=0$ 决定。因此，$F_{adv, 1/2} = v u(0,t) = 0$。\n  单元 1 和单元 2 之间的界面 $x_{3/2}=h$ 处的通量由迎风状态 $u_1$ 决定。因此，$F_{adv, 3/2} = v u_1$。\n  $u_1$ 的变化率为：\n  $$ \\frac{d u_1}{dt} = -\\frac{1}{h} (F_{adv, 3/2} - F_{adv, 1/2}) = -\\frac{1}{h} (v u_1 - 0) = -\\frac{v}{h} u_1 $$\n\n- **对于单元 2 (从 $x=h$ 到 $x=2h=L$)**：\n  界面位于 $x_{3/2}=h$ 和 $x_{5/2}=L$。\n  $x_{3/2}=h$ 处的通量为 $F_{adv, 3/2} = v u_1$。\n  出流边界 $x_{5/2}=L$ 处的通量由迎风格式的自然出流条件决定，该条件使用最后一个单元的状态。因此，$F_{adv, 5/2} = v u_2$。\n  $u_2$ 的变化率为：\n  $$ \\frac{d u_2}{dt} = -\\frac{1}{h} (F_{adv, 5/2} - F_{adv, 3/2}) = -\\frac{1}{h} (v u_2 - v u_1) = \\frac{v}{h} u_1 - \\frac{v}{h} u_2 $$\n\n将这些结果合并为矩阵形式 $\\frac{d\\boldsymbol{u}}{dt} = A\\boldsymbol{u}$：\n$$ A = \\begin{pmatrix} -v/h  0 \\\\ v/h  -v/h \\end{pmatrix} = \\frac{v}{h} \\begin{pmatrix} -1  0 \\\\ 1  -1 \\end{pmatrix} $$\n\n**2. 扩散矩阵 $B$ 的推导**\n\n扩散方程为 $u_t = \\kappa u_{xx}$。其守恒形式为 $u_t - (\\kappa u_x)_x = 0$，因此通量为 $F_{diff} = -\\kappa u_x$。我们使用中心差分来近似单元面上的梯度：$u_x|_{x_{i+1/2}} \\approx \\frac{u_{i+1}-u_i}{h}$。单元平均值的方程为 $\\frac{du_i}{dt} = -\\frac{1}{h}(F_{diff, i+1/2} - F_{diff, i-1/2})$。\n\n- **对于单元 1 (从 $x=0$ 到 $x=h$)**：\n  界面位于 $x_{1/2}=0$ 和 $x_{3/2}=h$。\n  $x_{1/2}=0$ 处的无通量边界条件为 $u_x(0,t)=0$，因此 $F_{diff, 1/2} = -\\kappa u_x(0,t) = 0$。\n  界面 $x_{3/2}=h$ 处的通量为 $F_{diff, 3/2} = -\\kappa \\frac{u_2 - u_1}{h}$。\n  $u_1$ 的变化率为：\n  $$ \\frac{d u_1}{dt} = -\\frac{1}{h} \\left( -\\kappa \\frac{u_2 - u_1}{h} - 0 \\right) = \\frac{\\kappa}{h^2}(u_2 - u_1) = -\\frac{\\kappa}{h^2} u_1 + \\frac{\\kappa}{h^2} u_2 $$\n\n- **对于单元 2 (从 $x=h$ 到 $x=L=2h$)**：\n  界面位于 $x_{3/2}=h$ 和 $x_{5/2}=L$。\n  界面 $x_{3/2}=h$ 处的通量为 $F_{diff, 3/2} = -\\kappa \\frac{u_2 - u_1}{h}$。\n  $x_{5/2}=L$ 处的无通量边界条件为 $u_x(L,t)=0$，因此 $F_{diff, 5/2} = -\\kappa u_x(L,t) = 0$。\n  $u_2$ 的变化率为：\n  $$ \\frac{d u_2}{dt} = -\\frac{1}{h} \\left( 0 - \\left(-\\kappa \\frac{u_2 - u_1}{h}\\right) \\right) = -\\frac{1}{h} \\left( \\kappa \\frac{u_2-u_1}{h} \\right) = \\frac{\\kappa}{h^2} u_1 - \\frac{\\kappa}{h^2} u_2 $$\n\n将这些结果合并为矩阵形式 $\\frac{d\\boldsymbol{u}}{dt} = B\\boldsymbol{u}$：\n$$ B = \\begin{pmatrix} -\\kappa/h^2  \\kappa/h^2 \\\\ \\kappa/h^2  -\\kappa/h^2 \\end{pmatrix} = \\frac{\\kappa}{h^2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} $$\n\n**3. 对易子 $[A,B]$ 的计算**\n\n对易子定义为 $[A,B] = AB - BA$。\n首先，计算乘积 $AB$：\n$$ AB = \\left( \\frac{v}{h} \\begin{pmatrix} -1  0 \\\\ 1  -1 \\end{pmatrix} \\right) \\left( \\frac{\\kappa}{h^2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\right) = \\frac{v\\kappa}{h^3} \\begin{pmatrix} (-1)(-1) + (0)(1)  (-1)(1) + (0)(-1) \\\\ (1)(-1) + (-1)(1)  (1)(1) + (-1)(-1) \\end{pmatrix} $$\n$$ AB = \\frac{v\\kappa}{h^3} \\begin{pmatrix} 1  -1 \\\\ -2  2 \\end{pmatrix} $$\n\n接下来，计算乘积 $BA$：\n$$ BA = \\left( \\frac{\\kappa}{h^2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\right) \\left( \\frac{v}{h} \\begin{pmatrix} -1  0 \\\\ 1  -1 \\end{pmatrix} \\right) = \\frac{v\\kappa}{h^3} \\begin{pmatrix} (-1)(-1) + (1)(1)  (-1)(0) + (1)(-1) \\\\ (1)(-1) + (-1)(1)  (1)(0) + (-1)(-1) \\end{pmatrix} $$\n$$ BA = \\frac{v\\kappa}{h^3} \\begin{pmatrix} 2  -1 \\\\ -2  1 \\end{pmatrix} $$\n\n现在，将两个乘积相减以求得对易子：\n$$ [A,B] = AB - BA = \\frac{v\\kappa}{h^3} \\left( \\begin{pmatrix} 1  -1 \\\\ -2  2 \\end{pmatrix} - \\begin{pmatrix} 2  -1 \\\\ -2  1 \\end{pmatrix} \\right) $$\n$$ [A,B] = \\frac{v\\kappa}{h^3} \\begin{pmatrix} 1-2  -1-(-1) \\\\ -2-(-2)  2-1 \\end{pmatrix} = \\frac{v\\kappa}{h^3} \\begin{pmatrix} -1  0 \\\\ 0  1 \\end{pmatrix} $$\n\n题目要求的是该对易子矩阵的 $(1,1)$ 元素，该元素被定义为入流边界处的边界对易子。\n$$ [A,B]_{(1,1)} = -\\frac{v\\kappa}{h^3} $$\n这个非零项量化了由算子分裂格式中边界条件的不一致处理在边界处引入的局部误差。",
            "answer": "$$\\boxed{-\\frac{v\\kappa}{h^3}}$$"
        }
    ]
}