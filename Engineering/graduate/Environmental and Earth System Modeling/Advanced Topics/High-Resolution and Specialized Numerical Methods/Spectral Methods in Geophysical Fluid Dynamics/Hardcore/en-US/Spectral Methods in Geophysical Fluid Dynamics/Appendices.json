{
    "hands_on_practices": [
        {
            "introduction": "The primary power of spectral methods lies in their transformation of complex differential operations into simple algebraic multiplication in the spectral domain. This exercise extends this core concept from the familiar Laplace-Beltrami operator, $\\nabla^2$, to the biharmonic operator, $\\nabla^4$. By deriving the eigenvalues of $\\nabla^4$, you will gain hands-on experience with a higher-order operator commonly used to represent diffusion and friction in geophysical models, reinforcing the foundational principle of eigenfunctions in simplifying partial differential equations .",
            "id": "3914974",
            "problem": "Consider a scalar field $q(\\theta,\\phi)$ on the unit sphere, represented in standard spherical coordinates $\\theta \\in [0,\\pi]$ and $\\phi \\in [0,2\\pi)$. The unit sphere implies the geometric radius $a$ is $a = 1$, so all operators are dimensionless. The Laplace–Beltrami operator $\\nabla^{2}$ (also called the spherical Laplacian) on the unit sphere is defined by\n$$\n\\nabla^{2} f(\\theta,\\phi) \\equiv \\frac{1}{\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\!\\left(\\sin\\theta\\,\\frac{\\partial f}{\\partial \\theta}\\right) + \\frac{1}{\\sin^{2}\\theta}\\,\\frac{\\partial^{2} f}{\\partial \\phi^{2}}.\n$$\nAssume $q(\\theta,\\phi)$ admits a spherical harmonic expansion\n$$\nq(\\theta,\\phi) = \\sum_{\\ell=0}^{\\infty}\\sum_{m=-\\ell}^{\\ell} \\hat{q}_{\\ell m}\\,Y_{\\ell}^{m}(\\theta,\\phi),\n$$\nwhere $Y_{\\ell}^{m}(\\theta,\\phi)$ are the orthonormal spherical harmonics on the unit sphere. Using the completeness and orthogonality of $Y_{\\ell}^{m}$ and the definition of the Laplace–Beltrami operator on the sphere, derive the spectral (spherical harmonic) representation of the biharmonic operator $\\nabla^{4} \\equiv \\nabla^{2}\\nabla^{2}$ acting on $q(\\theta,\\phi)$, and compute the corresponding eigenvalues in terms of the total wavenumber $\\ell$. Your final answer must be a single closed-form analytic expression in terms of $\\ell$ only, corresponding to the eigenvalue of $\\nabla^{4}$ acting on $Y_{\\ell}^{m}$ on the unit sphere. No numerical approximation is required.",
            "solution": "The problem statement has been subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n- Scalar field on the unit sphere: $q(\\theta,\\phi)$, with $\\theta \\in [0,\\pi]$ and $\\phi \\in [0,2\\pi)$.\n- Unit sphere radius: $a = 1$.\n- Laplace–Beltrami operator: $\\nabla^{2} f(\\theta,\\phi) \\equiv \\frac{1}{\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\!\\left(\\sin\\theta\\,\\frac{\\partial f}{\\partial \\theta}\\right) + \\frac{1}{\\sin^{2}\\theta}\\,\\frac{\\partial^{2} f}{\\partial \\phi^{2}}$.\n- Spherical harmonic expansion: $q(\\theta,\\phi) = \\sum_{\\ell=0}^{\\infty}\\sum_{m=-\\ell}^{\\ell} \\hat{q}_{\\ell m}\\,Y_{\\ell}^{m}(\\theta,\\phi)$.\n- Basis functions: $Y_{\\ell}^{m}(\\theta,\\phi)$ are the orthonormal spherical harmonics on the unit sphere.\n- Biharmonic operator definition: $\\nabla^{4} \\equiv \\nabla^{2}\\nabla^{2}$.\n- Objective: Derive the spectral representation of $\\nabla^{4} q(\\theta,\\phi)$ and compute the corresponding eigenvalues of the $\\nabla^4$ operator in terms of the total wavenumber $\\ell$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on standard, well-established principles of mathematical physics and differential geometry concerning the Laplace–Beltrami operator and spherical harmonics. It is well-posed, with all necessary definitions provided to determine a unique, meaningful solution for the eigenvalues. The language is objective and precise. The problem is self-contained, consistent, and mathematically feasible. No flaws related to scientific unsoundness, incompleteness, or ambiguity have been identified.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\nThe derivation proceeds from the fundamental properties of spherical harmonics with respect to the Laplace–Beltrami operator. The spherical harmonics $Y_{\\ell}^{m}(\\theta,\\phi)$ are, by definition, the eigenfunctions of the Laplace–Beltrami operator $\\nabla^2$ on the surface of a sphere. For a sphere of radius $a$, the eigenvalue equation is:\n$$\n\\nabla^{2} Y_{\\ell}^{m}(\\theta,\\phi) = -\\frac{\\ell(\\ell+1)}{a^2} Y_{\\ell}^{m}(\\theta,\\phi)\n$$\nwhere $\\ell$ is the total wavenumber (a non-negative integer, $\\ell \\ge 0$) and $m$ is the zonal wavenumber (an integer, $-\\ell \\le m \\le \\ell$). The problem specifies a unit sphere, for which $a=1$. Therefore, the eigenvalue equation simplifies to:\n$$\n\\nabla^{2} Y_{\\ell}^{m}(\\theta,\\phi) = -\\ell(\\ell+1) Y_{\\ell}^{m}(\\theta,\\phi)\n$$\nThe value $-\\ell(\\ell+1)$ is the eigenvalue of the operator $\\nabla^2$ corresponding to the eigenfunction $Y_{\\ell}^{m}$.\n\nThe problem asks for the spectral representation and eigenvalues of the biharmonic operator, $\\nabla^{4}$, defined as $\\nabla^{4} \\equiv \\nabla^{2}\\nabla^{2}$. This means applying the Laplace–Beltrami operator twice. The linearity of $\\nabla^2$ is a critical property.\n\nLet us find the effect of $\\nabla^4$ on a single spherical harmonic basis function $Y_{\\ell}^{m}(\\theta,\\phi)$.\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = \\nabla^{2} \\left( \\nabla^{2} Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nWe substitute the result from the eigenvalue equation for $\\nabla^{2} Y_{\\ell}^{m}(\\theta,\\phi)$:\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = \\nabla^{2} \\left( -\\ell(\\ell+1) Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nSince $-\\ell(\\ell+1)$ is a scalar constant for any given $\\ell$, it can be factored out of the linear operator $\\nabla^2$:\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = -\\ell(\\ell+1) \\left( \\nabla^{2} Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nNow, we apply the eigenvalue property of $\\nabla^2$ a second time:\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = -\\ell(\\ell+1) \\left( -\\ell(\\ell+1) Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nMultiplying the scalar factors yields:\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = \\left( -\\ell(\\ell+1) \\right)^2 Y_{\\ell}^{m}(\\theta,\\phi)\n$$\n$$\n\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) = (\\ell(\\ell+1))^2 Y_{\\ell}^{m}(\\theta,\\phi)\n$$\nThis is an eigenvalue equation for the operator $\\nabla^4$. It shows that the spherical harmonics $Y_{\\ell}^{m}$ are also eigenfunctions of the biharmonic operator $\\nabla^4$, with the corresponding eigenvalues given by $(\\ell(\\ell+1))^2$. The eigenvalue depends only on the total wavenumber $\\ell$, not on the zonal wavenumber $m$.\n\nTo find the spectral representation of $\\nabla^{4}q(\\theta,\\phi)$, we apply the operator to the spherical harmonic expansion of $q(\\theta,\\phi)$. Due to the linearity of $\\nabla^4$, we can apply the operator to each term in the series individually:\n$$\n\\nabla^{4} q(\\theta,\\phi) = \\nabla^{4} \\left( \\sum_{\\ell=0}^{\\infty}\\sum_{m=-\\ell}^{\\ell} \\hat{q}_{\\ell m}\\,Y_{\\ell}^{m}(\\theta,\\phi) \\right) = \\sum_{\\ell=0}^{\\infty}\\sum_{m=-\\ell}^{\\ell} \\hat{q}_{\\ell m} \\left( \\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nSubstituting our result for $\\nabla^{4} Y_{\\ell}^{m}(\\theta,\\phi)$:\n$$\n\\nabla^{4} q(\\theta,\\phi) = \\sum_{\\ell=0}^{\\infty}\\sum_{m=-\\ell}^{\\ell} \\hat{q}_{\\ell m} \\left( (\\ell(\\ell+1))^2 Y_{\\ell}^{m}(\\theta,\\phi) \\right)\n$$\nThis is the spectral representation of $\\nabla^{4}q(\\theta,\\phi)$. The spherical harmonic coefficients of $\\nabla^{4}q$ are $(\\ell(\\ell+1))^2 \\hat{q}_{\\ell m}$.\n\nThe problem explicitly asks for the eigenvalue of $\\nabla^4$ acting on $Y_{\\ell}^m$ as a closed-form analytic expression in terms of $\\ell$. From the eigenvalue equation $\\nabla^{4} Y_{\\ell}^{m} = (\\ell(\\ell+1))^2 Y_{\\ell}^{m}$, this eigenvalue is clearly $(\\ell(\\ell+1))^2$.",
            "answer": "$$\n\\boxed{(\\ell(\\ell+1))^2}\n$$"
        },
        {
            "introduction": "Spectral methods are not just for representing fields; they are powerful tools for efficiently solving the systems of partial differential equations that govern fluid dynamics. This practical coding exercise tackles a vertically coupled Helmholtz system, a common challenge that arises in semi-implicit time-stepping schemes used in atmospheric models. You will implement and verify a two-stage diagonalization strategy, using a horizontal Fourier transform and a vertical modal decomposition to turn a complex coupled PDE system into a set of simple, independent algebraic equations .",
            "id": "3914998",
            "problem": "Consider the linear, hydrostatic, multilayer shallow-water system under a semi-implicit time discretization on a periodic, square domain of side length $2\\pi$, in which the prognostic update for the layer-thickness perturbation vector field $u(x,y)\\in\\mathbb{R}^N$ (with $N$ vertical layers) requires solving a horizontally elliptic, vertically coupled Helmholtz system of the abstract form\n$$\n\\left(I - \\mu\\,\\nabla^2 \\otimes B\\right) u = f,\n$$\nwhere $I$ is the $N\\times N$ identity, $\\mu0$ is a constant parameter emerging from the semi-implicit treatment of fast gravity waves, $\\nabla^2$ is the horizontal Laplace operator on a periodic domain, $\\otimes$ denotes the Kronecker product with respect to the vertical and horizontal spaces, $B\\in\\mathbb{R}^{N\\times N}$ is a symmetric positive semidefinite vertical coupling matrix encoding hydrostatic barotropic/baroclinic coupling, and $f(x,y)\\in\\mathbb{R}^N$ is a given right-hand side. On the periodic square domain of side length $2\\pi$, the horizontal Fourier modes are $e^{i(k_x x + k_y y)}$ with integer wavenumbers $k_x,k_y\\in\\mathbb{Z}$, and satisfy $\\nabla^2 e^{i(k_x x + k_y y)} = -\\left(k_x^2+k_y^2\\right)e^{i(k_x x + k_y y)}$.\n\nYour tasks are:\n- Derive, from first principles starting with the multilayer shallow-water equations and the spectral representation of the horizontal Laplace operator on a periodic domain, why transforming the vertical coordinate into barotropic/baroclinic modes diagonalizes the vertical coupling and yields a block-diagonal structure across horizontal wavenumbers and vertical modes.\n- Implement a solver that, for each discrete horizontal Fourier mode, inverts the coupled Helmholtz system in two different but mathematically equivalent ways:\n  $1.$ Direct vertical-coupled inversion: for each horizontal wavenumber, invert the $N\\times N$ matrix $A(k_x,k_y) = I + \\mu\\,(k_x^2+k_y^2)\\,B$ and apply it to the Fourier coefficients of $f$.\n  $2.$ Modal-diagonal inversion: compute the orthonormal eigen-decomposition $B = Q \\Lambda Q^\\top$ with $\\Lambda=\\mathrm{diag}(\\lambda_1,\\dots,\\lambda_N)$, transform the Fourier coefficients of $f$ to modal space via $Q^\\top$, and for each mode $i$ invert the scalar Helmholtz factor $1+\\mu\\,(k_x^2+k_y^2)\\,\\lambda_i$, then transform back via $Q$.\n- Demonstrate numerically, on a discrete grid using the discrete Fourier transform, that both inversions produce the same solution up to floating-point roundoff by reporting the maximum absolute difference in physical space between the two solutions.\n\nDiscretization and implementation details:\n- Use a uniform grid with $N_x$ points in $x$ and $N_y$ points in $y$ on the periodic domain of side length $2\\pi$. Use the complex-to-complex discrete Fourier transform to represent fields spectrally in the horizontal directions.\n- Compute Fourier wavenumbers in radians per unit length via $k_x = 2\\pi\\,\\mathrm{fftfreq}(N_x, d=(2\\pi)/N_x)$ and $k_y = 2\\pi\\,\\mathrm{fftfreq}(N_y, d=(2\\pi)/N_y)$ so that $k_x,k_y\\in\\mathbb{Z}$, and form $k^2 = k_x^2 + k_y^2$.\n- For reproducibility, construct the right-hand side $f$ as a real-valued array with independent, identically distributed standard normal entries using a fixed pseudorandom seed per test case. Arrange $f$ as an array of shape $(N, N_y, N_x)$, one horizontal field per layer. Apply the discrete Fourier transform independently to each layer.\n\nTest suite:\nProvide the maximum absolute difference between the two inversion methods in physical space for each of the following parameter sets. For each test, set the pseudorandom number generator seed to the stated value before constructing $f$.\n- Test $1$ (happy path with a barotropic null mode): $N=2$, $N_x=8$, $N_y=8$, $\\mu=0.1$, and\n$$\nB=\\begin{bmatrix}\n1  -1\\\\\n-1  1\n\\end{bmatrix},\n$$\nseed $=123$.\n- Test $2$ (three-layer with a barotropic null mode and stronger coupling): $N=3$, $N_x=16$, $N_y=8$, $\\mu=1.0$, and\n$$\nB=\\begin{bmatrix}\n1  -1  0\\\\\n-1  2  -1\\\\\n0  -1  1\n\\end{bmatrix},\n$$\nseed $=1$.\n- Test $3$ (three-layer strictly positive definite coupling and one-dimensional strip grid): $N=3$, $N_x=1$, $N_y=16$, $\\mu=0.01$, and\n$$\nB=\\begin{bmatrix}\n2  -1  0\\\\\n-1  2  -1\\\\\n0  -1  2\n\\end{bmatrix},\n$$\nseed $=7$.\n\nRequired program output:\n- Your program must compute, for each test, the maximum absolute difference between the physical-space solutions obtained by the two inversion methods described above, i.e.,\n$$\n\\max_{i\\in\\{1,\\dots,N\\},\\,y,\\,x}\\left|u^{\\mathrm{direct}}_i(x,y) - u^{\\mathrm{modal}}_i(x,y)\\right|,\n$$\nand aggregate these three values into a single Python list literal printed on one line.\n- Final output format: a single line containing the three results as a comma-separated list enclosed in square brackets, with no extra whitespace or text, e.g., \"[r1,r2,r3]\".\n- No physical units are required because all quantities are nondimensional in this setup. Angles are measured in radians implicitly by the spectral representation, and no percentages are used.\n\nYour program must be a single, self-contained script that constructs the test fields, performs the spectral inversions, and prints the required list in the exact format specified.",
            "solution": "The problem presented is a valid task in computational science, specifically within the field of environmental and earth system modeling. It asks for a derivation and numerical implementation of a spectral solver for a system of Helmholtz equations, which is a standard component in semi-implicit numerical weather prediction and ocean models. The problem is scientifically grounded, well-posed, and all parameters and procedures are explicitly defined.\n\nThe core of the problem is to solve the linear, elliptic partial differential equation system for the layer-thickness perturbation vector field $u(x,y) \\in \\mathbb{R}^N$:\n$$\n\\left(I - \\mu\\,\\nabla^2 \\otimes B\\right) u = f\n$$\nwhere $I$ is the $N \\times N$ identity matrix, $\\mu  0$ is a constant, $\\nabla^2$ is the horizontal Laplacian on a periodic square domain of side length $2\\pi$, $B \\in \\mathbb{R}^{N\\times N}$ is a symmetric positive semidefinite vertical coupling matrix, and $f(x,y) \\in \\mathbb{R}^N$ is a given forcing field. The notation $\\nabla^2 \\otimes B$ signifies that the scalar operator $\\nabla^2$ acts on the horizontal components of the fields, while the matrix $B$ acts on the vertical (layer) components.\n\nWe will first derive, from first principles, how a two-step transformation—first into horizontal Fourier space and then into a vertical modal space—completely diagonalizes the problem. Subsequently, we will describe the implementation of two numerically distinct but mathematically equivalent solution methods.\n\n**Derivation of Decoupling**\n\nThe solution strategy hinges on the properties of the linear operators involved. The horizontal operator, $\\nabla^2$, and the vertical operator, represented by multiplication by the matrix $B$, can be diagonalized in their respective basis representations.\n\n**1. Decoupling in Horizontal Wavenumber Space via Fourier Transform**\n\nThe problem is set on a periodic domain $[0, 2\\pi) \\times [0, 2\\pi)$. The natural basis functions for linear, constant-coefficient differential operators on such a domain are the complex exponentials, which are the eigenfunctions of the Laplacian operator. Any sufficiently smooth vector field $u(x,y)$ can be represented by a Fourier series:\n$$\nu(x,y) = \\sum_{k_x \\in \\mathbb{Z}} \\sum_{k_y \\in \\mathbb{Z}} \\hat{u}(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\nwhere $\\hat{u}(k_x, k_y) \\in \\mathbb{C}^N$ is the vector of Fourier coefficients for the horizontal wavenumber pair $(k_x, k_y)$. The Laplacian acting on this representation is:\n$$\n\\nabla^2 u(x,y) = \\sum_{k_x, k_y} \\hat{u}(k_x, k_y) \\nabla^2 e^{i(k_x x + k_y y)} = \\sum_{k_x, k_y} -(k_x^2 + k_y^2) \\hat{u}(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\nWe represent the right-hand side $f(x,y)$ in the same basis:\n$$\nf(x,y) = \\sum_{k_x, k_y} \\hat{f}(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\nSubstituting these series representations into the governing equation gives:\n$$\n\\sum_{k_x, k_y} \\left( I \\hat{u}(k_x, k_y) - \\mu (-(k_x^2 + k_y^2)) B \\hat{u}(k_x, k_y) \\right) e^{i(k_x x + k_y y)} = \\sum_{k_x, k_y} \\hat{f}(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\nDue to the orthogonality of the Fourier basis functions $\\{e^{i(k_x x + k_y y)}\\}$, the equality must hold for the coefficients of each mode independently. This transforms the single partial differential equation system into a vast set of independent linear algebraic systems, one for each wavenumber pair $(k_x, k_y)$.\nLet $k^2 = k_x^2 + k_y^2$. For each $(k_x, k_y)$, we have:\n$$\n\\left( I + \\mu k^2 B \\right) \\hat{u}(k_x, k_y) = \\hat{f}(k_x, k_y)\n$$\nThis is an $N \\times N$ system of linear equations for the vector of Fourier coefficients $\\hat{u}(k_x, k_y)$. The original PDE system has thus been block-diagonalized across horizontal wavenumbers.\n\n**2. Decoupling in Vertical Modal Space via Eigendecomposition**\n\nNow we focus on solving the $N \\times N$ matrix system for a single, fixed wavenumber pair $(k_x, k_y)$. The matrix governing this system is $A(k) = I + \\mu k^2 B$. The matrix $B$ is specified as real and symmetric. By the spectral theorem, it is orthogonally diagonalizable. There exists an orthogonal matrix $Q$ whose columns are the eigenvectors of $B$, and a diagonal matrix $\\Lambda$ whose diagonal entries are the corresponding real eigenvalues $\\lambda_1, \\lambda_2, \\dots, \\lambda_N$, such that:\n$$\nB = Q \\Lambda Q^\\top\n$$\nThe columns of $Q$ represent the vertical \"modes\" of the system (e.g., the barotropic mode and the baroclinic modes). Substituting this decomposition into our matrix system:\n$$\n(I + \\mu k^2 Q \\Lambda Q^\\top) \\hat{u}(k_x, k_y) = \\hat{f}(k_x, k_y)\n$$\nUsing the property that $I = Q Q^\\top$ since $Q$ is orthogonal:\n$$\n(Q Q^\\top + Q (\\mu k^2 \\Lambda) Q^\\top) \\hat{u}(k_x, k_y) = \\hat{f}(k_x, k_y)\n$$\nFactoring out $Q$ and $Q^\\top$:\n$$\nQ (I + \\mu k^2 \\Lambda) Q^\\top \\hat{u}(k_x, k_y) = \\hat{f}(k_x, k_y)\n$$\nLeft-multiply by $Q^\\top$:\n$$\n(I + \\mu k^2 \\Lambda) Q^\\top \\hat{u}(k_x, k_y) = Q^\\top \\hat{f}(k_x, k_y)\n$$\nWe define the solution and forcing vectors in the basis of vertical modes:\n- $\\hat{u}^*(k_x, k_y) = Q^\\top \\hat{u}(k_x, k_y)$ (transform to modal space)\n- $\\hat{f}^*(k_x, k_y) = Q^\\top \\hat{f}(k_x, k_y)$ (transform to modal space)\n\nThe system becomes:\n$$\n(I + \\mu k^2 \\Lambda) \\hat{u}^*(k_x, k_y) = \\hat{f}^*(k_x, k_y)\n$$\nThe matrix $(I + \\mu k^2 \\Lambda)$ is diagonal, with diagonal entries $(1 + \\mu k^2 \\lambda_i)$. This means the system of $N$ coupled equations for the modal coefficients $\\hat{u}^*$ has decoupled into $N$ independent scalar equations:\n$$\n(1 + \\mu k^2 \\lambda_i) \\hat{u}^*_i(k_x, k_y) = \\hat{f}^*_i(k_x, k_y), \\quad \\text{for } i = 1, \\dots, N\n$$\nThe solution for each scalar component is trivial: $\\hat{u}^*_i = \\hat{f}^*_i / (1 + \\mu k^2 \\lambda_i)$. Once all $\\hat{u}^*_i$ are found, the solution in the original vertical coordinates is recovered by transforming back: $\\hat{u}(k_x, k_y) = Q \\hat{u}^*(k_x, k_y)$. This completes the derivation, showing that the combination of horizontal Fourier transform and vertical modal transform fully diagonalizes the Helmholtz operator.\n\n**Numerical Implementation**\n\nThe derivation above directly motivates two distinct but equivalent numerical solution methods. The continuous Fourier transform is approximated by the Discrete Fourier Transform (DFT), efficiently computed via the Fast Fourier Transform (FFT).\n\n**Method 1: Direct Vertical-Coupled Inversion**\nThis method follows the first stage of the derivation.\n1.  For each vertical layer $j \\in \\{1, \\dots, N\\}$, compute the 2D DFT of the forcing field $f_j(x,y)$ to obtain the spectral coefficients $\\hat{f}_j(k_x, k_y)$.\n2.  For each discrete wavenumber pair $(k_x, k_y)$:\n    a. Construct the $N \\times N$ matrix $A(k) = I + \\mu (k_x^2+k_y^2) B$.\n    b. Solve the $N \\times N$ linear system $A(k) \\hat{u}(k_x, k_y) = \\hat{f}(k_x, k_y)$ for $\\hat{u}(k_x, k_y)$ using a standard linear algebra library function (e.g., matrix inversion).\n3.  For each vertical layer $j$, perform a 2D inverse DFT on the computed solution coefficients $\\hat{u}_j(k_x, k_y)$ to obtain the physical-space solution $u_j(x,y)$.\n\n**Method 2: Modal-Diagonal Inversion**\nThis method follows the full diagonalization.\n1.  Compute the orthonormal eigendecomposition of the vertical coupling matrix, $B = Q \\Lambda Q^\\top$.\n2.  Compute the 2D DFT of the forcing $f(x,y)$ to get $\\hat{f}(k_x, k_y)$.\n3.  For each wavenumber pair $(k_x, k_y)$, transform the forcing coefficients into the vertical modal basis: $\\hat{f}^*(k_x, k_y) = Q^\\top \\hat{f}(k_x, k_y)$.\n4.  For each vertical mode $i \\in \\{1, \\dots, N\\}$ and each wavenumber pair $(k_x, k_y)$, solve the decoupled scalar equation:\n    $$\n    \\hat{u}^*_i(k_x, k_y) = \\frac{\\hat{f}^*_i(k_x, k_y)}{1 + \\mu (k_x^2+k_y^2) \\lambda_i}\n    $$\n5.  For each wavenumber pair $(k_x, k_y)$, transform the solution coefficients from the modal basis back to the physical vertical basis: $\\hat{u}(k_x, k_y) = Q \\hat{u}^*(k_x, k_y)$.\n6.  Perform a 2D inverse DFT on the coefficients $\\hat{u}(k_x, k_y)$ to obtain the physical-space solution $u(x,y)$.\n\nBoth methods are algorithmically different but mathematically equivalent. They solve the same set of linear equations. Therefore, if implemented correctly, they should yield the same solution, differing only by floating-point roundoff errors. The numerical experiment is designed to confirm this equivalence.",
            "answer": "```python\nimport numpy as np\n\ndef solve_helmholtz(N, Nx, Ny, mu, B, seed):\n    \"\"\"\n    Solves the multilayer Helmholtz system using two methods and returns the max difference.\n    \"\"\"\n    # Set the pseudorandom seed for reproducibility\n    np.random.seed(seed)\n    \n    # 1. Construct the right-hand side f in physical space\n    # f is real-valued with i.i.d. standard normal entries\n    f_phys = np.random.standard_normal(size=(N, Ny, Nx))\n    \n    # 2. Compute wavenumbers\n    # The problem specifies kx, ky should be integers. \n    # fftfreq(N, d=L/N) yields frequencies in cycles per unit length.\n    # Wavenumber (in rad/unit length) = 2*pi * frequency.\n    #\n    # freq_x = fftfreq(Nx, d=(2*np.pi)/Nx)\n    # kx = 2*np.pi * freq_x = 2*np.pi * [0, 1, ..., N/2-1, -N/2, ..., -1] / (2*pi)\n    # So kx = [0, 1, ..., N/2-1, -N/2, ..., -1], which are integers.\n    kx_1d = 2 * np.pi * np.fft.fftfreq(Nx, d=(2 * np.pi / Nx))\n    ky_1d = 2 * np.pi * np.fft.fftfreq(Ny, d=(2 * np.pi / Ny))\n    \n    kx_2d, ky_2d = np.meshgrid(kx_1d, ky_1d)\n    k_squared = kx_2d**2 + ky_2d**2  # Shape: (Ny, Nx)\n    \n    # 3. Transform f to spectral space\n    f_hat = np.fft.fft2(f_phys, axes=(1, 2))  # Shape: (N, Ny, Nx)\n\n    # --- Method 1: Direct Vertical-Coupled Inversion ---\n    \n    u_hat_direct = np.zeros_like(f_hat)\n    I = np.identity(N)\n    \n    # Loop over each point in horizontal spectral space\n    for iy in range(Ny):\n        for ix in range(Nx):\n            k2 = k_squared[iy, ix]\n            # Form the N x N matrix for this wavenumber\n            A = I + mu * k2 * B\n            # Invert the matrix and solve for u_hat\n            A_inv = np.linalg.inv(A)\n            u_hat_direct[:, iy, ix] = A_inv @ f_hat[:, iy, ix]\n            \n    # Transform solution back to physical space\n    u_phys_direct = np.real(np.fft.ifft2(u_hat_direct, axes=(1, 2)))\n\n    # --- Method 2: Modal-Diagonal Inversion ---\n    \n    # 2a. Eigendecomposition of B\n    lambdas, Q = np.linalg.eigh(B) # eigh for symmetric matrices\n    \n    # 2b. Transform f_hat to modal space\n    # f_hat_star = Q.T @ f_hat\n    # Use einsum for clean broadcasting over (Ny, Nx) dimensions\n    f_hat_star = np.einsum('ij,jyx-iyx', Q.T, f_hat)\n    \n    # 2c. Solve scalar Helmholtz equations in modal space\n    # Denominator shape will broadcast from (N, 1, 1) and (Ny, Nx) to (N, Ny, Nx)\n    denominator = 1.0 + mu * lambdas[:, np.newaxis, np.newaxis] * k_squared\n    \n    # Handle potential division by zero, though problem setup prevents this\n    # Since mu  0, B is PSD (lambdas = 0), k_squared = 0, denominator = 1.\n    u_hat_star = f_hat_star / denominator\n    \n    # 2d. Transform solution back to physical vertical space\n    # u_hat_modal = Q @ u_hat_star\n    u_hat_modal = np.einsum('ij,jyx-iyx', Q, u_hat_star)\n\n    # Transform solution back to physical grid space\n    u_phys_modal = np.real(np.fft.ifft2(u_hat_modal, axes=(1, 2)))\n\n    # --- 4. Compare solutions ---\n    \n    # Compute the maximum absolute difference between the two solutions\n    max_diff = np.max(np.abs(u_phys_direct - u_phys_modal))\n    \n    return max_diff\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"N\": 2, \"Nx\": 8, \"Ny\": 8, \"mu\": 0.1, \n            \"B\": np.array([[1.0, -1.0], [-1.0, 1.0]]),\n            \"seed\": 123\n        },\n        {\n            \"N\": 3, \"Nx\": 16, \"Ny\": 8, \"mu\": 1.0,\n            \"B\": np.array([[1.0, -1.0, 0.0], [-1.0, 2.0, -1.0], [0.0, -1.0, 1.0]]),\n            \"seed\": 1\n        },\n        {\n            \"N\": 3, \"Nx\": 1, \"Ny\": 16, \"mu\": 0.01,\n            \"B\": np.array([[2.0, -1.0, 0.0], [-1.0, 2.0, -1.0], [0.0, -1.0, 2.0]]),\n            \"seed\": 7\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        max_diff = solve_helmholtz(\n            N=case[\"N\"],\n            Nx=case[\"Nx\"],\n            Ny=case[\"Ny\"],\n            mu=case[\"mu\"],\n            B=case[\"B\"],\n            seed=case[\"seed\"]\n        )\n        results.append(max_diff)\n\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A complete spectral model requires both spatial representation and a stable, accurate method for time integration. This exercise delves into the practical challenges of time-stepping, focusing on the widely used leapfrog scheme and the numerical artifacts it can produce, such as the unphysical computational mode. By analyzing the scheme's amplification factors and methodically designing a Robert-Asselin-Williams (RAW) filter, you will learn how to control numerical instabilities while preserving the accuracy of the physical solution, a crucial task in long-term climate and weather simulations .",
            "id": "3915040",
            "problem": "Consider a single complex Fourier mode of a linear, non-dissipative wave equation relevant to geophysical fluid dynamics, whose spectral amplitude $u(t)$ obeys the ordinary differential equation $du/dt = i \\,\\omega\\, u$, where $\\omega \\in \\mathbb{R}$ is the mode frequency. Denote the nondimensional Courant-like parameter by $\\mu \\equiv \\omega \\,\\Delta t$, with $\\Delta t  0$ the time step. The time integration uses the centered leapfrog scheme followed, each step, by a two-parameter Robert–Asselin–Williams (RAW) filter (Robert–Asselin filter with the Williams correction). Specifically, starting from $(u^{n-1},u^{n})$, form the provisional leapfrog update\n$$\nu^{n+1,\\ast} \\;=\\; u^{n-1} \\;+\\; 2\\,i\\,\\mu\\,u^{n},\n$$\nthen apply the RAW filter to the central time level,\n$$\nu^{n} \\;\\leftarrow\\; u^{n} \\;+\\; \\nu \\,\\bigl(u^{n-1} - 2\\,u^{n} + u^{n+1,\\ast}\\bigr) \\;+\\; \\alpha\\,\\nu \\,\\bigl(u^{n+1,\\ast} - u^{n-1}\\bigr),\n$$\nwhere $\\nu \\in [0,1/2)$ is the filter strength and $\\alpha \\in \\mathbb{R}$ is the Williams parameter. The updated pair for the next step is then $(u^{n},u^{n+1}) = \\bigl(u^{n}\\text{ (filtered)},\\,u^{n+1,\\ast}\\bigr)$.\n\nTasks:\n1) Derive the $2\\times 2$ amplification matrix that maps the state vector $\\bigl(u^{n},u^{n-1}\\bigr)$ to $\\bigl(u^{n+1},u^{n}\\bigr)$, and obtain its characteristic polynomial. Identify the two eigenvalues $g(\\mu,\\nu,\\alpha)$ that represent the physical and computational modes.\n\n2) For the physical mode eigenvalue, obtain the small-parameter asymptotics to first order in $\\nu$ and up to cubic order in $\\mu$ for its magnitude $\\rho(\\mu,\\nu,\\alpha) = |g|$ and phase increment per step $\\psi(\\mu,\\nu,\\alpha) = \\arg(g)$, starting from fundamental expansions of exponentials and trigonometric functions. Express your results as asymptotic series in $\\mu$ with coefficients depending on $\\nu$ and $\\alpha$, and explicitly separate the leading contributions of the leapfrog discretization and the RAW filter.\n\n3) Using your asymptotics, select the Williams parameter $\\alpha$ so that the leading-order amplitude error of the physical mode induced by the filter vanishes, i.e., $\\rho(\\mu,\\nu,\\alpha) = 1 + \\mathcal{O}\\bigl(\\nu\\,\\mu^{4}\\bigr)$ as $\\mu \\to 0$.\n\n4) Analyze the computational mode eigenvalue in the small-$\\mu$ limit. Obtain its per-step amplitude factor $R_{c}(\\nu) = |g_{c}(\\mu\\to 0,\\nu,\\alpha)|$ to first order in $\\nu$. Then, impose the design requirement that the computational mode amplitude be reduced by a factor $R_{c} = 0.9$ per time step, and solve for the corresponding $\\nu$.\n\nProvide your final chosen filter parameters $\\nu$ and $\\alpha$ as a single row matrix. No rounding is required, and no units are needed.",
            "solution": "The user wants a detailed analysis of a numerical time-stepping scheme for a simple wave equation, involving the derivation of amplification factors, asymptotic analysis of accuracy and stability, and parameter selection based on design criteria.\n\nThe problem is scientifically grounded, well-posed, and all necessary information is provided. It represents a standard analysis of numerical methods in computational fluid dynamics. I will proceed with the solution.\n\n### Part 1: Amplification Matrix and Eigenvalues\n\nThe state of the system at time step $n$ can be described by the vector $\\mathbf{v}^n = (u^n, u^{n-1})^T$. The time-stepping scheme advances this to the state vector at step $n+1$, which is $\\mathbf{v}^{n+1} = (u^{n+1}, u^n_{new})^T$, where $u^n_{new}$ is the filtered value of $u^n$. The task is to find the $2 \\times 2$ amplification matrix $\\mathbf{G}$ such that $\\mathbf{v}^{n+1} = \\mathbf{G} \\mathbf{v}^n$.\n\nFirst, we express the components of the new state vector, $u^{n+1}$ and $u^n_{new}$, in terms of the components of the old state vector, $u^n$ and $u^{n-1}$.\nThe first component, $u^{n+1}$, is given by the provisional leapfrog update:\n$$\nu^{n+1} \\equiv u^{n+1,\\ast} = u^{n-1} + 2i\\mu u^n\n$$\nThis can be written as $u^{n+1} = (2i\\mu)u^n + (1)u^{n-1}$.\n\nThe second component, $u^n_{new}$, is the result of applying the RAW filter to the central time level $u^n$:\n$$\nu^n_{new} = u^n + \\nu(u^{n-1} - 2u^n + u^{n+1,\\ast}) + \\alpha\\nu(u^{n+1,\\ast} - u^{n-1})\n$$\nWe substitute the expression for $u^{n+1,\\ast}$:\n$$\nu^n_{new} = u^n + \\nu\\bigl(u^{n-1} - 2u^n + (u^{n-1} + 2i\\mu u^n)\\bigr) + \\alpha\\nu\\bigl((u^{n-1} + 2i\\mu u^n) - u^{n-1}\\bigr)\n$$\n$$\nu^n_{new} = u^n + \\nu(2u^{n-1} - 2u^n + 2i\\mu u^n) + \\alpha\\nu(2i\\mu u^n)\n$$\nCollecting terms multiplying $u^n$ and $u^{n-1}$:\n$$\nu^n_{new} = (1 - 2\\nu + 2i\\mu\\nu + 2i\\alpha\\mu\\nu)u^n + (2\\nu)u^{n-1}\n$$\n$$\nu^n_{new} = \\bigl(1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)\\bigr)u^n + (2\\nu)u^{n-1}\n$$\nThe system of equations for the mapping $(u^n, u^{n-1}) \\to (u^{n+1}, u^n_{new})$ is:\n$$\n\\begin{pmatrix} u^{n+1} \\\\ u^n_{new} \\end{pmatrix} = \\begin{pmatrix} 2i\\mu  1 \\\\ 1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)  2\\nu \\end{pmatrix} \\begin{pmatrix} u^n \\\\ u^{n-1} \\end{pmatrix}\n$$\nThe amplification matrix is therefore:\n$$\n\\mathbf{G} = \\begin{pmatrix} 2i\\mu  1 \\\\ 1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)  2\\nu \\end{pmatrix}\n$$\nThe eigenvalues $g$ of $\\mathbf{G}$ are the roots of the characteristic polynomial $\\det(\\mathbf{G} - g\\mathbf{I}) = 0$.\n$$\n\\det \\begin{pmatrix} 2i\\mu - g  1 \\\\ 1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)  2\\nu - g \\end{pmatrix} = 0\n$$\n$$\n(2i\\mu - g)(2\\nu - g) - \\bigl(1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)\\bigr) = 0\n$$\n$$\ng^2 - (2\\nu + 2i\\mu)g + 4i\\mu\\nu - \\bigl(1 - 2\\nu + 2i\\mu\\nu(1+\\alpha)\\bigr) = 0\n$$\n$$\ng^2 - 2(\\nu + i\\mu)g - \\bigl(1 - 2\\nu - 2i\\mu\\nu + 2i\\alpha\\mu\\nu\\bigr) = 0\n$$\nThe characteristic polynomial is:\n$$\ng^2 - 2(\\nu + i\\mu)g - \\bigl(1 - 2\\nu - 2i\\mu\\nu(1-\\alpha)\\bigr) = 0\n$$\nSolving this quadratic equation for $g$:\n$$\ng = \\frac{2(\\nu + i\\mu) \\pm \\sqrt{4(\\nu+i\\mu)^2 + 4\\bigl(1 - 2\\nu - 2i\\mu\\nu(1-\\alpha)\\bigr)}}{2}\n$$\n$$\ng = (\\nu + i\\mu) \\pm \\sqrt{(\\nu+i\\mu)^2 + 1 - 2\\nu - 2i\\mu\\nu(1-\\alpha)}\n$$\n$$\ng = (\\nu + i\\mu) \\pm \\sqrt{\\nu^2 + 2i\\mu\\nu - \\mu^2 + 1 - 2\\nu - 2i\\mu\\nu + 2i\\alpha\\mu\\nu}\n$$\n$$\ng = (\\nu + i\\mu) \\pm \\sqrt{(1 - 2\\nu + \\nu^2) - \\mu^2 + 2i\\alpha\\mu\\nu}\n$$\n$$\ng = (\\nu + i\\mu) \\pm \\sqrt{(1-\\nu)^2 - \\mu^2 + 2i\\alpha\\mu\\nu}\n$$\nTo identify the physical and computational modes, we consider the limit $\\nu \\to 0$ (no filter, pure leapfrog). The eigenvalues become $g = i\\mu \\pm \\sqrt{1-\\mu^2}$. The physical mode eigenvalue must approximate the true solution's amplification factor $e^{i\\mu} \\approx 1 + i\\mu$ for small $\\mu$. The leapfrog eigenvalue $i\\mu + \\sqrt{1-\\mu^2} \\approx i\\mu + (1 - \\mu^2/2) = 1 + i\\mu - \\mu^2/2$ is the physical mode. Thus, we associate the '+' sign with the physical mode.\nPhysical mode eigenvalue: $g_{phys} = (\\nu + i\\mu) + \\sqrt{(1-\\nu)^2 - \\mu^2 + 2i\\alpha\\mu\\nu}$\nComputational mode eigenvalue: $g_{comp} = (\\nu + i\\mu) - \\sqrt{(1-\\nu)^2 - \\mu^2 + 2i\\alpha\\mu\\nu}$\n\n### Part 2: Asymptotics for the Physical Mode\n\nWe seek asymptotic expansions for the magnitude $\\rho = |g_{phys}|$ and phase increment $\\psi = \\arg(g_{phys})$ for a small Courant parameter $\\mu$ and a small filter strength $\\nu$. We expand $g_{phys}$ to first order in $\\nu$ and up to cubic order in $\\mu$.\n\n$$\ng_{phys} = (\\nu + i\\mu) + (1-\\nu)\\sqrt{1 - \\frac{\\mu^2}{(1-\\nu)^2} + \\frac{2i\\alpha\\mu\\nu}{(1-\\nu)^2}}\n$$\nLet $z = \\frac{\\mu^2}{(1-\\nu)^2} - \\frac{2i\\alpha\\mu\\nu}{(1-\\nu)^2}$. For small $\\mu$ and $\\nu$, $z$ is small.\n$z \\approx \\mu^2(1+2\\nu) - 2i\\alpha\\mu\\nu$.\nWe use the Taylor expansion $\\sqrt{1-z} = 1 - \\frac{1}{2}z - \\frac{1}{8}z^2 - O(z^3)$.\n$$\n\\frac{1}{2}z \\approx \\frac{1}{2}\\mu^2(1+2\\nu) - i\\alpha\\mu\\nu = \\frac{1}{2}\\mu^2 + \\nu\\mu^2 - i\\alpha\\mu\\nu\n$$\n$$\n\\frac{1}{8}z^2 \\approx \\frac{1}{8}(\\mu^2)^2 = \\frac{1}{8}\\mu^4\n$$\nA more careful expansion of $z^2$:\n$z^2 = (\\mu^2(1+2\\nu) - 2i\\alpha\\mu\\nu)^2 \\approx (\\mu^2)^2 - 2(\\mu^2)(2i\\alpha\\mu\\nu) = \\mu^4 - 4i\\alpha\\mu^3\\nu$.\nSo, $\\frac{1}{8}z^2 \\approx \\frac{1}{8}\\mu^4 - \\frac{i}{2}\\alpha\\mu^3\\nu$.\nThe square root term becomes:\n$$\n\\sqrt{1-z} \\approx 1 - \\left(\\frac{1}{2}\\mu^2 + \\nu\\mu^2 - i\\alpha\\mu\\nu\\right) - \\left(\\frac{1}{8}\\mu^4 - \\frac{i}{2}\\alpha\\mu^3\\nu\\right)\n$$\n$$\n= 1 - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 - \\nu\\mu^2 + i\\alpha\\mu\\nu + \\frac{i}{2}\\alpha\\mu^3\\nu\n$$\nNow, multiply by $(1-\\nu)$:\n$$\n(1-\\nu)\\sqrt{1-z} \\approx \\left(1 - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 - \\nu\\mu^2 + i\\alpha\\mu\\nu + \\frac{i}{2}\\alpha\\mu^3\\nu\\right) - \\nu\\left(1 - \\frac{1}{2}\\mu^2\\right)\n$$\n$$\n\\approx 1 - \\nu - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 - \\frac{1}{2}\\nu\\mu^2 + i\\alpha\\mu\\nu + \\frac{i}{2}\\alpha\\mu^3\\nu\n$$\nFinally, add $(\\nu+i\\mu)$ to get $g_{phys}$:\n$$\ng_{phys} \\approx (\\nu+i\\mu) + \\left(1 - \\nu - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 - \\frac{1}{2}\\nu\\mu^2 + i\\alpha\\mu\\nu + \\frac{i}{2}\\alpha\\mu^3\\nu\\right)\n$$\n$$\ng_{phys} \\approx \\left(1 - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 - \\frac{1}{2}\\nu\\mu^2\\right) + i\\left(\\mu + \\alpha\\mu\\nu + \\frac{1}{2}\\alpha\\mu^3\\nu\\right)\n$$\nLet $g_{phys} = R + iI$. The magnitude $\\rho = |g_{phys}| = \\sqrt{R^2+I^2}$.\n$$\nR^2 \\approx \\left(1 - \\frac{1}{2}\\mu^2\\right)^2 - 2\\left(1 - \\frac{1}{2}\\mu^2\\right)\\left(\\frac{1}{8}\\mu^4 + \\frac{1}{2}\\nu\\mu^2\\right) \\approx 1 - \\mu^2 + \\frac{1}{4}\\mu^4 - \\frac{1}{4}\\mu^4 - \\nu\\mu^2 = 1 - \\mu^2 - \\nu\\mu^2\n$$\n$$\nI^2 \\approx \\mu^2\\left(1 + \\alpha\\nu + \\frac{1}{2}\\alpha\\mu^2\\nu\\right)^2 \\approx \\mu^2\\left(1 + 2\\alpha\\nu + \\alpha\\mu^2\\nu\\right) = \\mu^2 + 2\\alpha\\mu^2\\nu + \\alpha\\mu^4\\nu\n$$\n$$\n\\rho^2 = R^2+I^2 \\approx (1 - \\mu^2 - \\nu\\mu^2) + (\\mu^2 + 2\\alpha\\mu^2\\nu) = 1 + (2\\alpha-1)\\nu\\mu^2\n$$\nTaking the square root, $\\rho = \\sqrt{1+(2\\alpha-1)\\nu\\mu^2} \\approx 1 + \\frac{1}{2}(2\\alpha-1)\\nu\\mu^2$.\n\nThe phase increment $\\psi = \\arg(g_{phys}) = \\arctan(I/R)$.\n$$\n\\frac{I}{R} \\approx \\frac{\\mu + \\alpha\\mu\\nu}{1 - \\frac{1}{2}\\mu^2} \\approx (\\mu + \\alpha\\mu\\nu)\\left(1 + \\frac{1}{2}\\mu^2\\right) \\approx \\mu + \\frac{1}{2}\\mu^3 + \\alpha\\mu\\nu\n$$\nUsing $\\arctan(x) = x - x^3/3 + \\dots$:\n$$\n\\psi \\approx \\left(\\mu + \\frac{1}{2}\\mu^3 + \\alpha\\mu\\nu\\right) - \\frac{1}{3}\\mu^3 = \\mu + \\frac{1}{6}\\mu^3 + \\alpha\\mu\\nu\n$$\nFor the pure leapfrog scheme ($\\nu=0$), we have $\\rho_{LF}=1$ and $\\psi_{LF} \\approx \\mu + \\frac{1}{6}\\mu^3$. The term $\\frac{1}{6}\\mu^3$ is the leading-order phase (truncation) error of the leapfrog scheme. The filter introduces additional errors.\n\nSeparating contributions for the full scheme:\nMagnitude: $\\rho(\\mu,\\nu,\\alpha) \\approx \\underbrace{1}_{\\text{Leapfrog}} + \\underbrace{\\frac{1}{2}(2\\alpha-1)\\nu\\mu^2}_{\\text{RAW filter}}$\nPhase increment: $\\psi(\\mu,\\nu,\\alpha) \\approx \\underbrace{\\mu + \\frac{1}{6}\\mu^3}_{\\text{Leapfrog}} + \\underbrace{\\alpha\\nu\\mu}_{\\text{RAW filter}}$\n\n### Part 3: Optimal Williams Parameter `α`\n\nTo make the filter's impact on the physical mode amplitude as small as possible, we require the leading-order amplitude error to vanish. From the expression for $\\rho$, this means the coefficient of the $\\nu\\mu^2$ term must be zero.\n$$\n\\frac{1}{2}(2\\alpha - 1) = 0 \\implies 2\\alpha - 1 = 0 \\implies \\alpha = \\frac{1}{2}\n$$\nWith $\\alpha = 1/2$, the magnitude becomes $\\rho = 1 + O(\\nu\\mu^4)$, significantly improving amplitude conservation.\n\n### Part 4: Computational Mode Analysis and Filter Strength `ν`\n\nWe analyze the computational mode eigenvalue $g_{comp}$ in the limit $\\mu \\to 0$.\n$$\ng_{comp}(\\mu,\\nu,\\alpha) = (\\nu + i\\mu) - \\sqrt{(1-\\nu)^2 - \\mu^2 + 2i\\alpha\\mu\\nu}\n$$\nIn the limit $\\mu \\to 0$:\n$$\ng_{comp}(0,\\nu,\\alpha) = \\nu - \\sqrt{(1-\\nu)^2} = \\nu - |1-\\nu|\n$$\nGiven that $\\nu \\in [0, 1/2)$, $1-\\nu$ is positive, so $|1-\\nu|=1-\\nu$.\n$$\ng_{comp}(0,\\nu,\\alpha) = \\nu - (1-\\nu) = 2\\nu-1\n$$\nThe amplitude factor for the computational mode in this limit is $R_c(\\nu) = |g_{comp}(0,\\nu,\\alpha)| = |2\\nu-1|$. Since $\\nu  1/2$, $2\\nu-1$ is negative.\n$$\nR_c(\\nu) = -(2\\nu-1) = 1-2\\nu\n$$\nThe problem specifies that the computational mode's amplitude should be reduced by a factor of $R_c = 0.9$ per step.\n$$\n1 - 2\\nu = 0.9\n$$\n$$\n2\\nu = 1 - 0.9 = 0.1\n$$\n$$\n\\nu = 0.05\n$$\nThis value $\\nu = 0.05$ lies in the permitted range $[0, 1/2)$.\n\nThe chosen filter parameters are $\\nu=0.05$ and $\\alpha=1/2$. Expressed as fractions, $\\nu = 1/20$ and $\\alpha=1/2$. The final answer is requested as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{20}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        }
    ]
}