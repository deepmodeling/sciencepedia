{
    "hands_on_practices": [
        {
            "introduction": "To effectively apply Adaptive Mesh Refinement, we must first master the fundamentals of numerical stability across different scales. Explicit time-stepping schemes are governed by the Courant–Friedrichs–Lewy (CFL) condition, which links the time step $\\Delta t$ to the grid spacing $h$. This practice  challenges you to derive the consequences of this condition within an AMR hierarchy, showing how local time-stepping, or \"subcycling,\" allows fine grids to take proportionally smaller steps, dramatically improving computational efficiency without violating stability.",
            "id": "3730525",
            "problem": "Consider a one-dimensional linear hyperbolic system of conservation laws $u_{t} + A u_{x} = 0$, where $A \\in \\mathbb{R}^{m \\times m}$ is diagonalizable with real eigenvalues, and let the maximum magnitude of the characteristic speeds be $|\\lambda_{\\max}| = \\max_{k} |\\lambda_{k}|$. A first-order explicit finite volume discretization with a monotone numerical flux updates cell averages using information propagating at most one cell per time step on a uniform grid of spacing $h$. For stability of such explicit schemes, ensure that the discrete domain of dependence contains the continuous domain of dependence. Now consider an Adaptive Mesh Refinement (AMR) hierarchy with levels $\\ell = 0, 1, \\dots, L-1$, where level $\\ell$ has uniform cell spacing $h_{\\ell}$ and $h_{\\ell+1} = h_{\\ell}/r$ for a fixed integer refinement ratio $r \\ge 2$. Suppose subcycling-in-time is used so that level $\\ell$ advances with its own time step $\\Delta t_{\\ell}$ while maintaining a common dimensionless Courant number across all levels.\n\nTasks:\n1. Starting from the hyperbolic character of the system and the requirement that waves traveling at speed $|\\lambda_{\\max}|$ do not cross more than one cell per time step on the grid of spacing $h$, derive the stability restriction for the explicit discretization in terms of a dimensionless factor $\\mathrm{C} \\in (0,1)$, the grid spacing $h$, and the characteristic speed bound $|\\lambda_{\\max}|$. Clearly state the form of the restriction on $\\Delta t$ without invoking any pre-given formula.\n2. Using the AMR hierarchy definition and subcycling assumption, derive the per-level relation for the time steps $\\Delta t_{\\ell}$ in terms of a base coarse-level time step $\\Delta t_{0}$ and the refinement ratio $r$.\n3. For a specific three-level hierarchy with $L=3$, coarse-level spacing $h_{0} = 0.04\\,\\mathrm{m}$, refinement ratio $r = 2$, maximum characteristic speed $|\\lambda_{\\max}| = 5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, and common dimensionless Courant factor $\\mathrm{C} = 0.8$, compute the level-$\\ell=2$ time step $\\Delta t_{2}$ in seconds. Round your answer to four significant figures and express the time in seconds.\n\nDefinitions: Courant–Friedrichs–Lewy (CFL) condition refers to the stability constraint relating $\\Delta t$, $h$, and characteristic speeds in explicit schemes. Adaptive Mesh Refinement (AMR) refers to hierarchical grids with spatial refinement by integer ratios.",
            "solution": "The problem presents a multi-part task concerning the stability of numerical schemes for hyperbolic partial differential equations within an Adaptive Mesh Refinement (AMR) framework. The solution is structured into three sequential derivations and calculations as requested.\n\n### Part 1: Derivation of the Stability Restriction\n\nThe problem concerns a one-dimensional linear hyperbolic system of conservation laws, $u_{t} + A u_{x} = 0$, where the eigenvalues $\\lambda_k$ of the matrix $A$ represent the characteristic speeds at which information propagates through the domain. The maximum speed of propagation is denoted by $|\\lambda_{\\max}| = \\max_{k} |\\lambda_{k}|$.\n\nFor an explicit numerical scheme to be stable, the Courant–Friedrichs–Lewy (CFL) condition must be satisfied. This condition is a necessary condition for convergence and ensures that the numerical domain of dependence of a point in the discretized spacetime grid contains the physical (or continuous) domain of dependence of that same point.\n\nThe problem statement provides a direct physical interpretation of this condition: \"waves traveling at speed $|\\lambda_{\\max}|$ do not cross more than one cell per time step on the grid of spacing $h$.\" Let's formalize this. In a time interval $\\Delta t$, the maximum distance a physical wave can travel is $|\\lambda_{\\max}| \\Delta t$. For a first-order explicit scheme on a grid with uniform cell spacing $h$, the numerical solution at a cell centered at $x_i$ at time $t_{n+1} = t_n + \\Delta t$ depends on information from cells $i-1$, $i$, and $i+1$ at time $t_n$. This implies that the numerical method can only propagate information by a distance on the order of the cell size $h$ in one time step. For stability, the physical propagation distance must not exceed the distance the numerical scheme can \"see\". Thus, the distance traveled by the fastest physical wave must be less than or equal to the width of one grid cell:\n$$|\\lambda_{\\max}| \\Delta t \\le h$$\nThis inequality ensures that a characteristic line originating from any point within the numerical stencil at time $t_n$ does not exit that stencil by time $t_n + \\Delta t$.\n\nThe problem introduces a dimensionless factor $\\mathrm{C} \\in (0,1)$, which serves as a safety factor and is known as the Courant number. The stability condition is expressed by requiring that the ratio of the physical advection distance to the grid cell size be bounded by this factor:\n$$\\frac{|\\lambda_{\\max}| \\Delta t}{h} \\le \\mathrm{C}$$\nBy rearranging this inequality, we obtain the stability restriction on the time step $\\Delta t$ for a grid with spacing $h$:\n$$\\Delta t \\le \\mathrm{C} \\frac{h}{|\\lambda_{\\max}|}$$\n\n### Part 2: Derivation of the Per-Level Time Step Relation\n\nThe AMR hierarchy comprises levels $\\ell = 0, 1, \\dots, L-1$. The cell spacing $h_{\\ell}$ on level $\\ell$ is related to the spacing on the next coarser level $\\ell-1$ by a constant integer refinement ratio $r \\ge 2$, such that $h_{\\ell} = h_{\\ell-1}/r$. This leads to a general expression for the grid spacing on level $\\ell$ in terms of the base coarse-level spacing $h_0$:\n$$h_{\\ell} = \\frac{h_0}{r^{\\ell}}$$\nThe simulation employs subcycling-in-time, where each level $\\ell$ uses its own time step $\\Delta t_{\\ell}$. A critical constraint is that a common dimensionless Courant number $\\mathrm{C}$ is maintained across all levels. To maximize computational efficiency, the time step on each level is chosen to be at the stability limit derived in Part 1. For any level $\\ell$, this gives:\n$$\\Delta t_{\\ell} = \\mathrm{C} \\frac{h_{\\ell}}{|\\lambda_{\\max}|}$$\nWe aim to find a relationship between $\\Delta t_{\\ell}$ and the base coarse-level time step $\\Delta t_0$. For the coarsest level, $\\ell=0$, the time step is:\n$$\\Delta t_0 = \\mathrm{C} \\frac{h_0}{|\\lambda_{\\max}|}$$\nNow, we substitute the expression for $h_{\\ell}$ into the general formula for $\\Delta t_{\\ell}$:\n$$\\Delta t_{\\ell} = \\mathrm{C} \\frac{(h_0/r^{\\ell})}{|\\lambda_{\\max}|} = \\frac{1}{r^{\\ell}} \\left(\\mathrm{C} \\frac{h_0}{|\\lambda_{\\max}|}\\right)$$\nThe term in parentheses is precisely the expression for $\\Delta t_0$. Therefore, we arrive at the sought-after relation:\n$$\\Delta t_{\\ell} = \\frac{\\Delta t_0}{r^{\\ell}}$$\nThis result shows that in a subcycling AMR scheme with a constant Courant number, the time step on a given level is inversely proportional to $r^{\\ell}$, meaning finer levels require proportionally smaller time steps.\n\n### Part 3: Calculation of $\\Delta t_{2}$\n\nThe task is to calculate the time step $\\Delta t_2$ for a specific three-level hierarchy ($\\ell=0, 1, 2$) with the following given parameters:\n- Coarse-level spacing: $h_0 = 0.04\\,\\mathrm{m}$\n- Refinement ratio: $r = 2$\n- Maximum characteristic speed: $|\\lambda_{\\max}| = 5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- Common Courant factor: $\\mathrm{C} = 0.8$\n\nFirst, we must determine the grid spacing on the finest level, $\\ell=2$. Using the formula for $h_{\\ell}$:\n$$h_2 = \\frac{h_0}{r^2}$$\nSubstituting the numerical values:\n$$h_2 = \\frac{0.04\\,\\mathrm{m}}{2^2} = \\frac{0.04\\,\\mathrm{m}}{4} = 0.01\\,\\mathrm{m}$$\nNext, we use the formula for the per-level time step at the stability limit for $\\ell=2$:\n$$\\Delta t_2 = \\mathrm{C} \\frac{h_2}{|\\lambda_{\\max}|}$$\nPlugging in the given values and the calculated $h_2$:\n$$\\Delta t_2 = 0.8 \\times \\frac{0.01\\,\\mathrm{m}}{5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = 0.8 \\times (0.002\\,\\mathrm{s})$$\n$$\\Delta t_2 = 0.0016\\,\\mathrm{s}$$\nThe problem requires the answer to be expressed in seconds and rounded to four significant figures. The value $0.0016$ can be written with four significant figures as $0.001600$. In standard scientific notation, this is $1.600 \\times 10^{-3}$.",
            "answer": "$$\\boxed{1.600 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Beyond temporal stability, the hallmark of a robust AMR scheme is its ability to conserve physical quantities like mass and energy across coarse-fine interfaces. A naive coupling of grids would lead to artificial sources or sinks at these boundaries, violating the fundamental conservation laws being modeled. This exercise  provides a hands-on walkthrough of \"flux refluxing,\" the standard technique used to enforce conservation by correcting the coarse-grid flux with more accurate information from the fine grid, ensuring that the total flux is perfectly balanced.",
            "id": "4006196",
            "problem": "Consider a one-dimensional advection–diffusion substep for a single species mass fraction $Y$ in a reacting flow, formulated within the Adaptive Mesh Refinement (AMR) framework, where reaction is handled by operator splitting and is inactive during this substep (i.e., the reaction source is zero). The governing conservation law for the species during this substep is\n$$\n\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial F}{\\partial x} = 0,\n$$\nwith the total species flux\n$$\nF = \\rho u Y - \\rho D \\frac{\\partial Y}{\\partial x},\n$$\nwhere $\\rho$ is the mass density, $u$ is the advection velocity, and $D$ is the molecular diffusivity. Assume a constant density $\\rho$ and a uniform cross-sectional area of $1$ so that cell volumes are lengths.\n\nA coarse grid consists of two coarse cells $C0$ and $C1$ covering $x \\in [0, 2\\Delta x_c]$ with coarse cell width $\\Delta x_c$. A fine grid with refinement ratio $r = 2$ covers the entire spatial extent of coarse cell $C1$, consisting of two fine cells $F1$ and $F2$ of width $\\Delta x_f = \\Delta x_c/2$. The interface between $C0$ and the fine grid is at $x = \\Delta x_c$. The face at $x = \\Delta x_c$ is shared between coarse cell $C0$ and fine cell $F1$. The left boundary at $x = 0$ is an inflow with a fixed Dirichlet mass fraction.\n\nThe parameters and initial data are:\n- Density $\\rho = 1.0 \\ \\mathrm{kg/m^3}$,\n- Advection velocity $u = 0.8 \\ \\mathrm{m/s}$ (positive $x$ direction),\n- Diffusivity $D = 1.0 \\times 10^{-4} \\ \\mathrm{m^2/s}$,\n- Coarse width $\\Delta x_c = 2.0 \\times 10^{-3} \\ \\mathrm{m}$,\n- Fine width $\\Delta x_f = 1.0 \\times 10^{-3} \\ \\mathrm{m}$,\n- Time step $\\Delta t = 5.0 \\times 10^{-4} \\ \\mathrm{s}$,\n- Inflow mass fraction at $x=0$: $Y_{\\text{in}} = 0.20$,\n- Initial mass fractions: $Y_{C0}^n = 0.06$, $Y_{F1}^n = 0.12$, $Y_{F2}^n = 0.08$.\n\nOn the coarse level, the covered coarse neighbor $C1$ is defined by conservative restriction of the fine data, so its coarse mass fraction is the average $Y_{C1}^n = (Y_{F1}^n + Y_{F2}^n)/2$.\n\nUse the following physically standard discretization principles derived from the conservation law and constitutive flux:\n- Upwind selection for the advective face state $Y$ based on the sign of $u$,\n- Centered difference for the diffusive flux using the distance between adjacent cell centers; for a face between two cells of widths $\\Delta x_L$ and $\\Delta x_R$, the center-to-center distance is $\\Delta x_L/2 + \\Delta x_R/2$.\n\nTasks:\n1. Compute the coarse-level advective–diffusive flux at the right face of $C0$ (located at $x = \\Delta x_c$) using $Y_{C0}^n$ and the coarse neighbor $Y_{C1}^n$, with center-to-center distance $\\Delta x_c$. Also compute the face flux at the left boundary of $C0$ (located at $x=0$) using $Y_{\\text{in}}$ and $Y_{C0}^n$, with center-to-center distance $\\Delta x_c/2$.\n2. Update $Y_{C0}$ over the time step $\\Delta t$ using the coarse-level fluxes at the left and right faces via the finite-volume update implied by the conservation law.\n3. Compute the fine-level flux at the interface face $x = \\Delta x_c$ between $C0$ and $F1$ using the upwind state from $C0$ and the fine state from $F1$, and the center-to-center distance $\\Delta x_c/2 + \\Delta x_f/2$.\n4. Populate a flux register with the fine-level interface flux and apply the reflux correction to the coarse cell $C0$ so that its final updated state is consistent with the fine-level interface flux through $x = \\Delta x_c$.\n5. From the corrected $Y_{C0}^{n+1}$, compute the final species mass in $C0$ per unit cross-sectional area, defined as $m_{C0}^{n+1} = \\rho \\, Y_{C0}^{n+1} \\, \\Delta x_c$, and express it in $\\mathrm{kg/m^2}$.\n\nRound your final answer to four significant figures and express the final mass in $\\mathrm{kg/m^2}$.",
            "solution": "The finite volume discretization of the governing equation for a generic cell $i$ with constant density $\\rho$ and volume $\\Delta x_i$ (per unit area) is:\n$$ Y_i^{n+1} = Y_i^n - \\frac{\\Delta t}{\\rho \\Delta x_i} (F_{i+1/2} - F_{i-1/2}) $$\nThe flux $F$ at a face between a left cell $L$ and a right cell $R$ is discretized as the sum of an advective flux and a diffusive flux. Given $u > 0$, the advective part uses the state from the left cell, $Y_L$. The diffusive flux is a centered difference.\n$$ F_{face} = (\\rho u Y_L) - (\\rho D) \\frac{Y_R - Y_L}{d_{centers}} $$\nwhere $d_{centers}$ is the distance between the cell centers.\n\nFirst, we determine the state of the coarse neighbor $C1$. It is the volume-weighted average (restriction) of the fine cells covering it.\n$$ Y_{C1}^n = \\frac{Y_{F1}^n \\Delta x_f + Y_{F2}^n \\Delta x_f}{\\Delta x_c} = \\frac{Y_{F1}^n + Y_{F2}^n}{r} $$\nWith $r=2$, this is a simple average:\n$$ Y_{C1}^n = \\frac{0.12 + 0.08}{2} = 0.10 $$\n\n**Task 1: Compute Coarse-Level Fluxes for $C0$**\n\nThe cell $C0$ has a left face at $x=0$ and a right face at $x=\\Delta x_c$.\n\n- **Flux at the left face of $C0$ ($F_{C0,left}$ at $x=0$):**\nThe left \"cell\" is the boundary condition $Y_{\\text{in}}$, and the right cell is $C0$. The center-to-center distance is given as $d_{centers} = \\Delta x_c / 2$.\nAdvection uses the upstream state $Y_{\\text{in}}$.\n$$ F_{C0,left} = \\rho u Y_{\\text{in}} - \\rho D \\frac{Y_{C0}^n - Y_{\\text{in}}}{\\Delta x_c / 2} $$\n$$ F_{C0,left} = (1.0)(0.8)(0.20) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.06 - 0.20}{2.0 \\times 10^{-3} / 2} $$\n$$ F_{C0,left} = 0.16 - (1.0 \\times 10^{-4}) \\frac{-0.14}{1.0 \\times 10^{-3}} = 0.16 - (1.0 \\times 10^{-4})(-140) = 0.16 + 0.014 = 0.174 $$\n\n- **Flux at the right face of $C0$ ($F_{C0,right}^c$ at $x=\\Delta x_c$), coarse-level:**\nThe left cell is $C0$, and the right cell is $C1$. The center-to-center distance is given as $d_{centers} = \\Delta x_c$.\nAdvection uses the left state $Y_{C0}^n$.\n$$ F_{C0,right}^c = \\rho u Y_{C0}^n - \\rho D \\frac{Y_{C1}^n - Y_{C0}^n}{\\Delta x_c} $$\n$$ F_{C0,right}^c = (1.0)(0.8)(0.06) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.10 - 0.06}{2.0 \\times 10^{-3}} $$\n$$ F_{C0,right}^c = 0.048 - (1.0 \\times 10^{-4}) \\frac{0.04}{2.0 \\times 10^{-3}} = 0.048 - (1.0 \\times 10^{-4})(20) = 0.048 - 0.002 = 0.046 $$\n\n**Task 2: Update $Y_{C0}$ using coarse fluxes**\n\nThis is a provisional update for $C0$ using only coarse-level information.\n$$ Y_{C0}^{n+1, \\text{coarse}} = Y_{C0}^n - \\frac{\\Delta t}{\\rho \\Delta x_c} (F_{C0,right}^c - F_{C0,left}) $$\n$$ Y_{C0}^{n+1, \\text{coarse}} = 0.06 - \\frac{5.0 \\times 10^{-4}}{(1.0)(2.0 \\times 10^{-3})} (0.046 - 0.174) $$\n$$ Y_{C0}^{n+1, \\text{coarse}} = 0.06 - (0.25) (-0.128) = 0.06 + 0.032 = 0.092 $$\n\n**Task 3: Compute Fine-Level Interface Flux**\n\nThis is the more accurate flux at the coarse-fine interface $x=\\Delta x_c$. The left cell is $C0$ and the right cell is the fine cell $F1$. The center-to-center distance is $d_{centers} = \\Delta x_c/2 + \\Delta x_f/2$.\n$$ d_{centers} = \\frac{2.0 \\times 10^{-3}}{2} + \\frac{1.0 \\times 10^{-3}}{2} = 1.0 \\times 10^{-3} + 0.5 \\times 10^{-3} = 1.5 \\times 10^{-3} \\ \\mathrm{m} $$\nThe fine-level flux $F_{C0,right}^f$ is:\n$$ F_{C0,right}^f = \\rho u Y_{C0}^n - \\rho D \\frac{Y_{F1}^n - Y_{C0}^n}{\\Delta x_c/2 + \\Delta x_f/2} $$\n$$ F_{C0,right}^f = (1.0)(0.8)(0.06) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.12 - 0.06}{1.5 \\times 10^{-3}} $$\n$$ F_{C0,right}^f = 0.048 - (1.0 \\times 10^{-4}) \\frac{0.06}{1.5 \\times 10^{-3}} = 0.048 - (1.0 \\times 10^{-4})(40) = 0.048 - 0.004 = 0.044 $$\n\n**Task 4: Apply Reflux Correction**\n\nThe flux refluxing procedure corrects the coarse cell state to ensure conservation at the coarse-fine interface. The update to $Y_{C0}^{n+1, \\text{coarse}}$ is based on the difference between the coarse-level flux and the fine-level flux at the interface.\nThe change in species mass in $C0$ due to the flux discrepancy is $\\Delta m = (F_{C0,right}^c - F_{C0,right}^f) \\Delta t A$. Since area $A=1$, the correction to the state variable $Y_{C0}$ is:\n$$ \\Delta Y_{C0}^{\\text{reflux}} = \\frac{(F_{C0,right}^c - F_{C0,right}^f) \\Delta t}{\\rho \\Delta x_c} $$\n$$ \\Delta Y_{C0}^{\\text{reflux}} = \\frac{(0.046 - 0.044) (5.0 \\times 10^{-4})}{(1.0) (2.0 \\times 10^{-3})} = \\frac{(0.002) (5.0 \\times 10^{-4})}{2.0 \\times 10^{-3}} = \\frac{1.0 \\times 10^{-6}}{2.0 \\times 10^{-3}} = 0.0005 $$\nThe final, corrected state for $C0$ is:\n$$ Y_{C0}^{n+1} = Y_{C0}^{n+1, \\text{coarse}} + \\Delta Y_{C0}^{\\text{reflux}} $$\n$$ Y_{C0}^{n+1} = 0.092 + 0.0005 = 0.0925 $$\n\n**Task 5: Compute Final Species Mass in $C0$**\n\nThe final species mass in cell $C0$ per unit cross-sectional area is:\n$$ m_{C0}^{n+1} = \\rho \\, Y_{C0}^{n+1} \\, \\Delta x_c $$\n$$ m_{C0}^{n+1} = (1.0 \\ \\mathrm{kg/m^3}) \\times (0.0925) \\times (2.0 \\times 10^{-3} \\ \\mathrm{m}) $$\n$$ m_{C0}^{n+1} = 0.185 \\times 10^{-3} \\ \\mathrm{kg/m^2} = 1.85 \\times 10^{-4} \\ \\mathrm{kg/m^2} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ m_{C0}^{n+1} = 1.850 \\times 10^{-4} \\ \\mathrm{kg/m^2} $$",
            "answer": "$$\\boxed{1.850 \\times 10^{-4}}$$"
        },
        {
            "introduction": "The power of AMR is most evident in large-scale parallel simulations, but its dynamic nature introduces a significant challenge: load imbalance. As refined regions move, some processors become overloaded with work, slowing down the entire computation. This practice  invites you to step into the role of a performance engineer, using a simple but powerful model to analyze the trade-off between running an imbalanced simulation and paying the overhead cost of repartitioning the grid to re-establish balance. This analysis is fundamental to achieving scalability with AMR on high-performance computers.",
            "id": "3094958",
            "problem": "Consider a one-dimensional domain decomposed uniformly across $P$ identical processors running in the Bulk Synchronous Parallel (BSP) model, where each time step is dominated by the slowest processor. The base mesh has $n_b$ cells per processor, and the time to update one cell for one time step is $c$ seconds, so if a processor holds $N$ cells in a step, it takes $cN$ seconds. An Adaptive Mesh Refinement (AMR) region increases the local cell density by a factor $q1$ wherever it resides. While the AMR region resides entirely within a given processor's subdomain, it stays there for exactly $T_s$ consecutive time steps before moving to the next processor's subdomain. Assume the AMR region is small enough to be fully contained in a single subdomain during those $T_s$ steps, and that outside the AMR region the mesh remains at the base resolution.\n\nAt the instant the AMR region enters a new processor's subdomain, you may either keep the current (static) partitioning or invoke repartitioning to perfectly balance the total number of cells across processors for the next $T_s$ steps. If you do not repartition, then during those $T_s$ steps the processor that contains the AMR region holds $qn_b$ cells while every other processor holds $n_b$ cells, and the wall time per step equals $c$ times the maximum cell count across processors that step. If you do repartition, you pay a one-time repartitioning cost $C_r$ at the beginning of those $T_s$ steps, and then each processor holds exactly its equal share of the total cells for each of the $T_s$ steps. The one-time repartitioning cost is modeled as $C_r=C_0+\\alpha N_{\\text{mig}}$, where $C_0$ is a fixed overhead, $\\alpha$ is the time per migrated cell, and $N_{\\text{mig}}$ is the number of cells that must be migrated off the processor that initially contains the AMR region to achieve perfect balance.\n\nUsing only the BSP timing model and linear per-cell cost, derive from first principles the minimal integer $T_{\\star}$ such that invoking repartitioning at the entry of the AMR region yields a strictly smaller total wall time over those $T_s$ steps than not repartitioning. Then evaluate $T_{\\star}$ for the following parameters: $P=8$, $n_b=1.0\\times 10^{6}$ cells, $c=2.0\\times 10^{-8}$ s/cell/step, $q=5$, $C_0=0.40$ s, and $\\alpha=1.0\\times 10^{-7}$ s/cell. Report $T_{\\star}$ as an integer number of time steps (no units). Do not round; give the exact integer.",
            "solution": "### Solution Derivation\nThe goal is to find the minimum integer number of steps, $T_{\\star}$, for which the total wall time with repartitioning ($W_{\\text{repart}}$) is strictly less than the total wall time without repartitioning ($W_{\\text{no-repart}}$) over a period of $T_s$ steps. The condition is:\n$$W_{\\text{repart}}  W_{\\text{no-repart}}$$\n\nFirst, we derive the expression for $W_{\\text{no-repart}}$.\nIn this scenario, one processor holds $qn_b$ cells and the other $P-1$ processors each hold $n_b$ cells. According to the BSP model, the time for each step is dictated by the slowest processor. Since $q > 1$, the processor with $qn_b$ cells is the slowest.\nThe time for a single step is $t_{\\text{step, no-repart}} = c \\times (qn_b)$.\nOver $T_s$ steps, the total wall time is:\n$$W_{\\text{no-repart}} = T_s \\cdot t_{\\text{step, no-repart}} = T_s c q n_b$$\n\nNext, we derive the expression for $W_{\\text{repart}}$.\nThis consists of a one-time repartitioning cost, $C_r$, plus the computational time over $T_s$ steps with a balanced load.\n$$W_{\\text{repart}} = C_r + T_s \\cdot t_{\\text{step, repart}}$$\n\nTo find the time per step with a balanced load, $t_{\\text{step, repart}}$, we first need the total number of cells in the simulation, $N_{\\text{total}}$.\n$$N_{\\text{total}} = (qn_b) + (P-1)n_b = (q + P - 1)n_b$$\nAfter perfect repartitioning, each of the $P$ processors holds an equal number of cells, $N_{\\text{bal}}$.\n$$N_{\\text{bal}} = \\frac{N_{\\text{total}}}{P} = \\frac{(q + P - 1)n_b}{P}$$\nThe time for a single step with a balanced load is then:\n$$t_{\\text{step, repart}} = c N_{\\text{bal}} = c \\frac{(q + P - 1)n_b}{P}$$\n\nNow, we must find the repartitioning cost, $C_r = C_0 + \\alpha N_{\\text{mig}}$. The number of migrated cells, $N_{\\text{mig}}$, is the number of cells that must be moved off the initially overloaded processor to reach the balanced state.\n$$N_{\\text{mig}} = (\\text{initial cells}) - (\\text{final cells}) = qn_b - N_{\\text{bal}}$$\n$$N_{\\text{mig}} = qn_b - \\frac{(q + P - 1)n_b}{P} = n_b \\left( q - \\frac{q + P - 1}{P} \\right)$$\n$$N_{\\text{mig}} = n_b \\left( \\frac{Pq - q - P + 1}{P} \\right) = n_b \\frac{(P-1)(q-1)}{P}$$\nSubstituting this into the expression for $C_r$:\n$$C_r = C_0 + \\alpha \\left( n_b \\frac{(P-1)(q-1)}{P} \\right)$$\n\nWe can now assemble the complete expression for $W_{\\text{repart}}$:\n$$W_{\\text{repart}} = C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P} + T_s c \\frac{(q + P - 1)n_b}{P}$$\n\nNow, we solve the inequality $W_{\\text{repart}}  W_{\\text{no-repart}}$ for $T_s$:\n$$C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P} + T_s c n_b \\frac{q + P - 1}{P}  T_s c q n_b$$\nTo isolate $T_s$, we group the terms containing $T_s$:\n$$C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P}  T_s \\left( c q n_b - c n_b \\frac{q + P - 1}{P} \\right)$$\n$$C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P}  T_s c n_b \\left( q - \\frac{q + P - 1}{P} \\right)$$\nThe term in the parenthesis on the right side is the same one encountered when calculating $N_{\\text{mig}}$:\n$$q - \\frac{q + P - 1}{P} = \\frac{(P-1)(q-1)}{P}$$\nThe inequality becomes:\n$$C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P}  T_s c n_b \\frac{(P-1)(q-1)}{P}$$\nSolving for $T_s$:\n$$T_s  \\frac{C_0 + \\alpha n_b \\frac{(P-1)(q-1)}{P}}{c n_b \\frac{(P-1)(q-1)}{P}}$$\nWe can separate the fraction into two terms:\n$$T_s  \\frac{C_0}{c n_b \\frac{(P-1)(q-1)}{P}} + \\frac{\\alpha n_b \\frac{(P-1)(q-1)}{P}}{c n_b \\frac{(P-1)(q-1)}{P}}$$\n$$T_s  \\frac{P C_0}{c n_b (P-1)(q-1)} + \\frac{\\alpha}{c}$$\nThe problem asks for the minimal integer $T_s$, which we call $T_{\\star}$, that satisfies this strict inequality. If we define the right-hand side as $V$, so $T_s  V$, the minimal integer value for $T_s$ is $\\lfloor V \\rfloor + 1$.\n$$T_{\\star} = \\left\\lfloor \\frac{P C_0}{c n_b (P-1)(q-1)} + \\frac{\\alpha}{c} \\right\\rfloor + 1$$\n\n### Numerical Evaluation\nWe now substitute the given parameters into this derived expression:\n-   $P=8$\n-   $n_b=1.0 \\times 10^{6}$\n-   $c=2.0 \\times 10^{-8}$\n-   $q=5$\n-   $C_0=0.40$\n-   $\\alpha=1.0 \\times 10^{-7}$\n\nLet's calculate the value of the expression $V = \\frac{P C_0}{c n_b (P-1)(q-1)} + \\frac{\\alpha}{c}$.\n\nThe second term is:\n$$\\frac{\\alpha}{c} = \\frac{1.0 \\times 10^{-7}}{2.0 \\times 10^{-8}} = 5$$\n\nThe first term is:\n$$\\frac{P C_0}{c n_b (P-1)(q-1)} = \\frac{8 \\times 0.40}{(2.0 \\times 10^{-8})(1.0 \\times 10^{6})(8-1)(5-1)}$$\n$$\\frac{3.2}{(2.0 \\times 10^{-2})(7)(4)} = \\frac{3.2}{(0.02)(28)} = \\frac{3.2}{0.56}$$\n$$\\frac{3.2}{0.56} = \\frac{320}{56} = \\frac{40 \\times 8}{7 \\times 8} = \\frac{40}{7}$$\n\nNow, we combine the terms to find $V$:\n$$V = \\frac{40}{7} + 5 = \\frac{40}{7} + \\frac{35}{7} = \\frac{75}{7}$$\nIn decimal form, $V \\approx 10.714$.\n\nFinally, we calculate $T_{\\star}$:\n$$T_{\\star} = \\left\\lfloor \\frac{75}{7} \\right\\rfloor + 1 = \\lfloor 10.714... \\rfloor + 1 = 10 + 1 = 11$$\n\nThe minimal integer number of steps for which repartitioning becomes strictly more advantageous is $11$.",
            "answer": "$$\\boxed{11}$$"
        }
    ]
}