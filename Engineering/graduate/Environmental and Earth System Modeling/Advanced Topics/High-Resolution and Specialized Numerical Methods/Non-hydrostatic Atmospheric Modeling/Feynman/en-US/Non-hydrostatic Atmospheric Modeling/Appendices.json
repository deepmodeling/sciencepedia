{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of atmospheric modeling is choosing the right set of governing equations. For large-scale phenomena, the hydrostatic approximation, which balances the vertical pressure gradient force with gravity, is highly effective. This exercise  challenges you to use scaling analysis—a powerful tool for any physicist—to determine when this approximation breaks down. By examining a vigorous convective storm, you will quantify the vertical acceleration and see firsthand why a full non-hydrostatic treatment is essential for accurately simulating small-scale, high-impact weather.",
            "id": "3898934",
            "problem": "Consider a deep convective squall line whose strongest updrafts occupy a layer of depth approximately $5$ km. Observations indicate a characteristic vertical velocity magnitude $w \\sim 15 \\, \\text{m s}^{-1}$ and a vertical pressure perturbation (relative to the hydrostatic base state) of magnitude $\\Delta p \\sim 2 \\, \\text{kPa}$ across $\\Delta z \\sim 5 \\, \\text{km}$. Take the air density to be approximately constant with height, $\\rho \\sim 1 \\, \\text{kg m}^{-3}$, and the acceleration due to gravity as $g = 9.81 \\, \\text{m s}^{-2}$. Viscous effects and vertical Coriolis force can be neglected at this scale.\n\nStarting from the vertical component of the compressible momentum equation and the hydrostatic balance for the base state, derive a scaling estimate for the material vertical acceleration and use it to quantify its magnitude relative to the hydrostatic pressure gradient per unit mass. Specifically, use dimensional analysis of the material derivative to estimate a characteristic material vertical acceleration, and then form the ratio $\\varepsilon$ of this acceleration to the magnitude of the hydrostatic pressure gradient per unit mass.\n\nReport the numerical value of the dimensionless ratio $\\varepsilon$ computed using the given data. Round your answer to three significant figures.",
            "solution": "The appropriate starting point is the vertical component of the compressible momentum equation,\n$$\n\\frac{D w}{D t} \\;=\\; -\\,\\frac{1}{\\rho}\\,\\frac{\\partial p}{\\partial z} \\;-\\; g \\;+\\; \\text{(viscous and other small terms)}.\n$$\nThe hydrostatic base state $(p_0, \\rho_0)$ satisfies\n$$\n\\frac{\\partial p_0}{\\partial z} \\;=\\; -\\,\\rho_0\\,g.\n$$\nDecomposing into a base state plus perturbations, $p = p_0 + p'$ and $\\rho = \\rho_0 + \\rho'$, and subtracting the hydrostatic balance gives the perturbation form\n$$\n\\frac{D w}{D t} \\;=\\; -\\,\\frac{1}{\\rho}\\,\\frac{\\partial p'}{\\partial z} \\;-\\; g\\,\\frac{\\rho'}{\\rho} \\;+\\; \\text{(viscous and other small terms)}.\n$$\nFor a scaling estimate, we consider a characteristic vertical scale $L_z$ and velocity scale $w$. The material derivative is scaled by dimensional analysis as\n$$\n\\left|\\frac{D w}{D t}\\right| \\;\\sim\\; \\frac{w^2}{L_z},\n$$\nsince $|\\partial w/\\partial z| \\sim w/L_z$ and the advective contribution $w\\,\\partial w/\\partial z$ dominates the local tendency at this scale in vigorous convection. The magnitude of the hydrostatic pressure gradient per unit mass is simply $g$, because in hydrostatic balance $-(1/\\rho)\\,\\partial p_0/\\partial z = g$.\n\nTherefore, the requested dimensionless ratio is\n$$\n\\varepsilon \\;=\\; \\frac{\\text{characteristic material vertical acceleration}}{\\text{hydrostatic pressure-gradient acceleration}} \\;\\sim\\; \\frac{w^2/L_z}{g} \\;=\\; \\frac{w^2}{g\\,L_z}.\n$$\nUsing the given values $w = 15 \\, \\text{m s}^{-1}$ and $L_z = \\Delta z = 5 \\, \\text{km} = 5000 \\, \\text{m}$, with $g = 9.81 \\, \\text{m s}^{-2}$, we obtain\n$$\n\\varepsilon \\;=\\; \\frac{(15)^2}{9.81 \\times 5000} \\;=\\; \\frac{225}{49050} \\;=\\; \\frac{1}{218} \\;\\approx\\; 0.004587\\ldots\n$$\nRounded to three significant figures, this is\n$$\n\\varepsilon \\;\\approx\\; 0.00459.\n$$\nAs a consistency check relevant to nonhydrostatic dynamics, the given pressure perturbation across the layer, $\\Delta p \\sim 2000 \\, \\text{Pa}$ over $\\Delta z \\sim 5000 \\, \\text{m}$, implies a nonhydrostatic pressure-gradient acceleration magnitude\n$$\n\\left|\\frac{1}{\\rho}\\frac{\\Delta p}{\\Delta z}\\right| \\;\\sim\\; \\frac{2000}{1 \\times 5000} \\;=\\; 0.4 \\ \\text{m s}^{-2},\n$$\nwhich is a non-negligible fraction of $g$ (about $0.041$). Although the material vertical acceleration is small compared to $g$ (with $\\varepsilon \\approx 0.00459$), it is of the same order as the nonhydrostatic pressure-gradient and buoyancy accelerations that must be retained to capture the observed vertical motions. This scaling justifies the need for nonhydrostatic modeling, in which the vertical momentum equation is solved without imposing hydrostatic balance.",
            "answer": "$$\\boxed{0.00459}$$"
        },
        {
            "introduction": "Once the need for a non-hydrostatic model is established, the next step is to characterize the flow regime more completely. Atmospheric motion is a complex interplay of inertia, rotation, stratification, and compressibility. This practice  introduces three fundamental dimensionless numbers—the Rossby ($Ro$), Froude ($Fr$), and Mach ($Ma$) numbers—that quantify the relative importance of these effects. Calculating these values for a given scenario allows you to make informed decisions about whether to include rotational effects or simplify the model by filtering out sound waves, leading to more efficient and targeted simulations.",
            "id": "3898947",
            "problem": "Consider a dry, stably stratified atmospheric layer of depth $H$ and horizontal scale $L$ at mid-latitudes, with a characteristic horizontal wind speed $U$, Coriolis parameter $f$, Brunt–Väisälä frequency $N$, and speed of sound $c$. Starting from the rotating, compressible Navier–Stokes equations and the definition of the Brunt–Väisälä frequency, perform a first-principles scaling analysis to identify and define three nondimensional groups that quantify the relative importance of rotation, stratification, and compressibility. Using those groups, compute their values for the parameter set $U=15\\,\\mathrm{m\\,s^{-1}}$, $L=20\\,\\mathrm{km}$, $H=5\\,\\mathrm{km}$, $f=10^{-4}\\,\\mathrm{s^{-1}}$, $N=0.01\\,\\mathrm{s^{-1}}$, and $c=320\\,\\mathrm{m\\,s^{-1}}$. Round each nondimensional value to three significant figures. Based on the magnitudes you find, justify whether retaining nonhydrostatic dynamics is necessary and whether a sound-proof formulation (for example, anelastic or pseudo-incompressible) is appropriate for this flow regime. Your final answer must be the three nondimensional values only, in the order corresponding to rotation, stratification, and compressibility, and expressed as a single row vector. The nondimensional values are unitless; do not include any units in the final answer.",
            "solution": "The problem statement has been validated and is determined to be a well-posed, scientifically grounded problem in geophysical fluid dynamics. All necessary parameters are provided, and their values are physically realistic for mesoscale atmospheric phenomena.\n\nThe task is to perform a scaling analysis of the governing equations of atmospheric motion to derive three key nondimensional parameters that characterize the flow regime. These parameters quantify the relative importance of rotation, stratification, and compressibility.\n\nThe fundamental equations for a rotating, compressible fluid are the Navier-Stokes equations. For scaling purposes, we can consider the inviscid form (Euler equations) applied to a dry atmosphere. The relevant equations are the momentum equation, the continuity equation, and a thermodynamic equation.\n\nLet the characteristic scales of the flow be:\n- Horizontal velocity: $U$\n- Vertical velocity: $W$\n- Horizontal length: $L$\n- Vertical length: $H$\n- Time: $T \\sim L/U$ (advective timescale)\n- Pressure perturbation from hydrostatic base state: $P$\n- Density perturbation from base state: $R$\n\nThe analysis proceeds by nondimensionalizing the governing equations and examining the ratios of the terms.\n\n**1. Rotation: The Rossby Number ($Ro$)**\n\nThe horizontal momentum equation is:\n$$ \\frac{D\\mathbf{u}_h}{Dt} = -f \\mathbf{k} \\times \\mathbf{u}_h - \\frac{1}{\\rho}\\nabla_h p $$\nHere, $\\mathbf{u}_h$ is the horizontal velocity vector, $f$ is the Coriolis parameter, $\\mathbf{k}$ is the vertical unit vector, $\\rho$ is density, and $p$ is pressure. The material derivative is $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$.\n\nThe two primary terms governing the large-scale horizontal dynamics are the inertial acceleration (advection) and the Coriolis force.\n- Scale of inertial acceleration: $|\\mathbf{u}_h \\cdot \\nabla_h \\mathbf{u}_h| \\sim \\frac{U^2}{L}$\n- Scale of Coriolis force: $|f \\mathbf{k} \\times \\mathbf{u}_h| \\sim fU$\n\nThe ratio of the inertial term to the Coriolis term defines the Rossby number, $Ro$:\n$$ Ro = \\frac{\\text{Inertial Force}}{\\text{Coriolis Force}} \\sim \\frac{U^2/L}{fU} = \\frac{U}{fL} $$\nThe Rossby number quantifies the importance of rotation. For $Ro \\ll 1$, the flow is geostrophically balanced and dominated by rotation. For $Ro \\gtrsim 1$, inertial effects are significant, and the flow is ageostrophic.\n\n**2. Stratification: The Internal Froude Number ($Fr$)**\n\nStratification refers to the vertical density gradient of the fluid, which gives rise to buoyancy forces. The Brunt-Väisälä frequency, $N$, is the natural frequency of vertical oscillation of a fluid parcel in a stable stratification. Its square is defined as $N^2 = \\frac{g}{\\theta_0} \\frac{d\\theta_0}{dz}$, where $g$ is the acceleration due to gravity and $\\theta_0$ is the background potential temperature.\n\nThe internal Froude number, $Fr$, compares the kinetic energy of the flow to the potential energy required to overcome the stable stratification. It can be seen as the ratio of the characteristic flow speed $U$ to the characteristic speed of long internal gravity waves, $c_g \\sim NH$.\n$$ Fr = \\frac{U}{NH} $$\nWhen $Fr \\ll 1$, the flow has insufficient kinetic energy to move vertically against the strong stratification and is thus constrained to move quasi-horizontally. When $Fr \\gtrsim 1$, the flow can overcome the buoyancy barrier and significant vertical motion can occur.\n\n**3. Compressibility: The Mach Number ($Ma$)**\n\nCompressibility effects are related to the change in fluid density in response to pressure changes. These effects are tied to the propagation of sound waves. The parameter that quantifies the importance of compressibility is the Mach number, $Ma$, defined as the ratio of the characteristic flow speed $U$ to the speed of sound $c$.\n$$ Ma = \\frac{U}{c} $$\nThe derivation arises from the full continuity equation, $\\frac{1}{\\rho}\\frac{D\\rho}{Dt} + \\nabla \\cdot \\mathbf{u} = 0$, where $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$ can be related to the pressure change via the speed of sound, $\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = \\frac{1}{\\rho c^2}\\frac{Dp}{Dt}$. Scaling analysis shows that the ratio of this compressibility term to the divergence term $\\nabla \\cdot \\mathbf{u}$ is of the order $Ma^2 = (U/c)^2$. When $Ma \\ll 1$, density variations due to pressure changes are dynamically negligible, and the flow can be approximated as acoustically incompressible (e.g., using an anelastic model).\n\n**Calculation of Nondimensional Values**\n\nThe given parameter values are:\n- $U = 15\\,\\mathrm{m\\,s^{-1}}$\n- $L = 20\\,\\mathrm{km} = 2 \\times 10^4\\,\\mathrm{m}$\n- $H = 5\\,\\mathrm{km} = 5 \\times 10^3\\,\\mathrm{m}$\n- $f = 10^{-4}\\,\\mathrm{s^{-1}}$\n- $N = 0.01\\,\\mathrm{s^{-1}}$\n- $c = 320\\,\\mathrm{m\\,s^{-1}}$\n\nThe three nondimensional groups are calculated as follows:\n\n- **Rossby Number ($Ro$):**\n$$ Ro = \\frac{U}{fL} = \\frac{15}{ (10^{-4}) \\times (2 \\times 10^4) } = \\frac{15}{2} = 7.5 $$\nRounded to three significant figures, $Ro = 7.50$.\n\n- **Internal Froude Number ($Fr$):**\n$$ Fr = \\frac{U}{NH} = \\frac{15}{ (0.01) \\times (5 \\times 10^3) } = \\frac{15}{50} = 0.3 $$\nRounded to three significant figures, $Fr = 0.300$.\n\n- **Mach Number ($Ma$):**\n$$ Ma = \\frac{U}{c} = \\frac{15}{320} = 0.046875 $$\nRounded to three significant figures, $Ma = 0.0469$.\n\n**Justification of Model Choices**\n\nBased on the calculated values:\n\n- **Nonhydrostatic Dynamics:** The hydrostatic approximation is valid when vertical accelerations are negligible compared to the vertical pressure gradient and buoyancy forces. A common criterion for assessing this is the geometric aspect ratio, $\\delta = H/L$. For the given parameters, $\\delta = \\frac{5\\,\\mathrm{km}}{20\\,\\mathrm{km}} = 0.25$. Since $\\delta$ is not much smaller than $1$, vertical accelerations are expected to be significant. Another indicator is the horizontal wavelength of stationary internal gravity waves, $\\lambda_x = 2\\pi U/N = 2\\pi (15)/(0.01) \\approx 9425\\,\\mathrm{m} = 9.4\\,\\mathrm{km}$. This natural-response wavelength is of the same order as the given horizontal scale $L=20\\,\\mathrm{km}$, suggesting that the resulting flow structures will have an aspect ratio that is not small, thus violating the hydrostatic assumption. Therefore, **retaining nonhydrostatic dynamics is necessary**.\n\n- **Sound-proof Formulation:** The Mach number is $Ma \\approx 0.0469$. Since $Ma \\ll 1$ (typically, $Ma  0.3$ is the criterion), the flow is well within the low-Mach-number regime. This means that sound waves are dynamically unimportant for the phenomenon of interest and propagate much faster than the advective processes. Using a fully compressible model would be computationally prohibitive because the time step would be severely restricted by the Courant-Friedrichs-Lewy (CFL) condition for sound waves. A sound-proof model, such as an anelastic or pseudo-incompressible formulation, filters out these acoustic modes while retaining the essential dynamics related to inertia, rotation, and buoyancy. Therefore, a **sound-proof formulation is appropriate** and highly advantageous for this flow regime.\n\nThe final answer consists of the three computed nondimensional values.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.50  0.300  0.0469\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from the physical equations to a computational solution introduces new challenges, chief among them numerical stability. An explicit numerical model can produce nonsensical results or \"blow up\" if the time step is too large relative to the grid spacing and flow speed. This hands-on calculation  guides you through applying the Courant–Friedrichs–Lewy (CFL) condition, a cornerstone of computational fluid dynamics. You will determine the maximum stable time step for an advection scheme, a critical skill for ensuring the integrity and success of any time-dependent simulation.",
            "id": "3898925",
            "problem": "A non-hydrostatic atmospheric model for compressible flow advances prognostic variables (e.g., velocity and potential temperature) with explicit advection in both the horizontal and vertical directions on a uniform grid. Consider a single time step in which the horizontal wind speed is $U = 20\\,\\mathrm{m\\,s^{-1}}$, the vertical velocity is $w = 5\\,\\mathrm{m\\,s^{-1}}$, the horizontal grid spacing is $\\Delta x = 1\\,\\mathrm{km}$, and the vertical grid spacing is $\\Delta z = 100\\,\\mathrm{m}$. The advection operator is discretized by a monotone upwind finite-volume flux, and time integration uses the third-order Strong Stability Preserving Runge–Kutta (SSP RK3) method. Assume an unsplit update in which horizontal and vertical advective fluxes are applied simultaneously.\n\nStarting from first principles for linear advection and the Courant–Friedrichs–Lewy (CFL) stability requirement for explicit methods, do the following:\n\n- Formulate the dimensionless Courant numbers for horizontal and vertical advection in terms of the time step $\\Delta t$ and the given parameters.\n- Derive the stability constraint on $\\Delta t$ appropriate for an unsplit explicit advection update with a monotone spatial flux and SSP RK3 time integration in two dimensions.\n- Using the derived constraint, choose the largest time step that is stable for both horizontal and vertical advection simultaneously.\n\nExpress the final time step in seconds. The final answer must be a single real-valued number. No rounding is required beyond exact arithmetic.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, well-posed, and contains all necessary information to derive a unique solution.\n\nThe problem asks for the maximum stable time step, $\\Delta t$, for a\ntwo-dimensional linear advection problem solved using a specific numerical scheme. The governing partial differential equation (PDE) for a conserved scalar quantity $q$ in a two-dimensional domain $(x, z)$ with constant velocities $U$ and $w$ is:\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} + w \\frac{\\partial q}{\\partial z} = 0\n$$\n\nThe solution process involves three steps as requested by the problem statement.\n\nFirst, we formulate the dimensionless Courant numbers. The Courant number represents the fraction of a grid cell that information travels across in a single time step in one dimension. For the horizontal ($x$) and vertical ($z$) directions, the Courant numbers, denoted as $C_x$ and $C_z$ respectively, are defined as:\n$$\nC_x = \\frac{|U| \\Delta t}{\\Delta x}\n$$\n$$\nC_z = \\frac{|w| \\Delta t}{\\Delta z}\n$$\nHere, $\\Delta t$ is the time step, $|U|$ and $|w|$ are the magnitudes of the advection speeds, and $\\Delta x$ and $\\Delta z$ are the grid spacings in the respective directions.\n\nSecond, we derive the stability constraint. The numerical stability of an explicit time-integration scheme for an advection equation is governed by the Courant–Friedrichs–Lewy (CFL) condition. This condition relates the time step $\\Delta t$ to the grid spacing and the wave propagation speed.\n\nThe problem specifies an \"unsplit\" update where horizontal and vertical advection are treated simultaneously. The spatial discretization is a \"monotone upwind finite-volume flux.\" The simplest and most fundamental example of such a scheme is the first-order upwind method. For positive velocities $U > 0$ and $w > 0$, the semi-discretized form of the PDE at a grid point $(i, j)$ is:\n$$\n\\frac{dq_{i,j}}{dt} = -\\frac{U}{\\Delta x}(q_{i,j} - q_{i-1,j}) - \\frac{w}{\\Delta z}(q_{i,j} - q_{i,j-1})\n$$\nIf this system were integrated forward in time using the first-order forward Euler method, the stability condition for this two-dimensional, unsplit, first-order upwind scheme is the sum of the individual Courant numbers:\n$$\nC_x + C_z \\le 1\n$$\nor\n$$\n\\frac{|U| \\Delta t}{\\Delta x} + \\frac{|w| \\Delta t}{\\Delta z} \\le 1\n$$\nThe problem specifies the use of the third-order Strong Stability Preserving Runge–Kutta (SSP RK3) method for time integration. A key property of SSP methods is that they are designed to preserve the stability (and monotonicity) of the forward Euler method under a specific time step constraint. For linear hyperbolic problems like the one considered here, discretized with a monotone scheme such as first-order upwind, the standard third-order SSP RK method has an SSP coefficient of $1$. This means that the SSP RK3 scheme is stable if and only if the forward Euler scheme is stable. Therefore, the stability constraint for the combined SSP RK3 and upwind spatial scheme is identical to the CFL condition for the forward Euler method. The derived stability constraint is thus:\n$$\n\\frac{|U| \\Delta t}{\\Delta x} + \\frac{|w| \\Delta t}{\\Delta z} \\le 1\n$$\n\nThird, we use the derived constraint to find the largest stable time step, $\\Delta t_{max}$. We can rearrange the stability inequality by factoring out $\\Delta t$:\n$$\n\\Delta t \\left( \\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z} \\right) \\le 1\n$$\nThe largest stable time step corresponds to the equality:\n$$\n\\Delta t_{max} = \\frac{1}{\\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z}}\n$$\nWe now substitute the given numerical values into this expression. The parameters are:\n- Horizontal wind speed: $U = 20\\,\\mathrm{m\\,s^{-1}}$\n- Vertical velocity: $w = 5\\,\\mathrm{m\\,s^{-1}}$\n- Horizontal grid spacing: $\\Delta x = 1\\,\\mathrm{km} = 1000\\,\\mathrm{m}$\n- Vertical grid spacing: $\\Delta z = 100\\,\\mathrm{m}$\n\nFirst, we compute the terms in the denominator:\n$$\n\\frac{|U|}{\\Delta x} = \\frac{20\\,\\mathrm{m\\,s^{-1}}}{1000\\,\\mathrm{m}} = 0.02\\,\\mathrm{s^{-1}}\n$$\n$$\n\\frac{|w|}{\\Delta z} = \\frac{5\\,\\mathrm{m\\,s^{-1}}}{100\\,\\mathrm{m}} = 0.05\\,\\mathrm{s^{-1}}\n$$\nThe sum of these terms is:\n$$\n\\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z} = 0.02\\,\\mathrm{s^{-1}} + 0.05\\,\\mathrm{s^{-1}} = 0.07\\,\\mathrm{s^{-1}}\n$$\nFinally, we calculate the maximum stable time step:\n$$\n\\Delta t_{max} = \\frac{1}{0.07\\,\\mathrm{s^{-1}}} = \\frac{1}{\\frac{7}{100}}\\,\\mathrm{s} = \\frac{100}{7}\\,\\mathrm{s}\n$$\nThe largest time step that is stable for both horizontal and vertical advection simultaneously is $\\frac{100}{7}$ seconds.",
            "answer": "$$\\boxed{\\frac{100}{7}}$$"
        }
    ]
}