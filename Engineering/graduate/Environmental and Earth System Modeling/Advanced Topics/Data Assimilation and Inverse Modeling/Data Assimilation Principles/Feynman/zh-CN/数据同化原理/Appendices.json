{
    "hands_on_practices": [
        {
            "introduction": "数据同化系统的性能在很大程度上取决于背景误差协方差（$B$）和观测误差协方差（$R$）的准确设定。本练习介绍了一种强大的诊断技术，该技术通过分析预报残差（O–F）和分析残差（O–A）的统计特性，来检验这些协方差矩阵是否被恰当指定。掌握这种方法对于调节和验证一个数据同化系统的统计一致性至关重要。",
            "id": "3872861",
            "problem": "在线性化数据同化设置中进行大气状态估计，考虑一个状态向量 $x \\in \\mathbb{R}^n$ 和一个观测向量 $y \\in \\mathbb{R}^p$，它们通过一个线性观测算子 $H \\in \\mathbb{R}^{p \\times n}$ 关联，关系式为 $y = H x_t + v$，其中 $x_t$ 是（未知的）真实状态，而 $v$ 是观测误差，其均值为零，协方差为 $R \\in \\mathbb{R}^{p \\times p}$。背景（先验）状态为 $x_b = x_t + b$，其中 $b$ 是背景误差，其均值为零，协方差为 $B \\in \\mathbb{R}^{n \\times n}$。假设 $b$ 和 $v$ 不相关，即 $\\mathbb{E}[b] = 0$，$\\mathbb{E}[v] = 0$，且 $\\mathbb{E}[b v^\\top] = 0$。定义分析为 $x_a = x_b + K \\left(y - H x_b\\right)$，其中 $K \\in \\mathbb{R}^{n \\times p}$ 是系统使用的增益。\n\n定义观测减预报（O–F，也称为新息）为 $d \\equiv y - H x_b$，以及观测减分析（O–A，也称为观测空间中的分析残差）为 $e \\equiv y - H x_a$。\n\n根据第一性原理和所述假设：\n- 推导二阶矩 $\\mathbb{E}[d d^\\top]$、$\\mathbb{E}[e d^\\top]$ 和 $\\mathbb{E}[e e^\\top]$ 关于 $H$、$B$、$R$ 和 $K$ 的表达式。\n- 然后，将情况特殊化到 $K$ 是此线性高斯设置下的最优卡尔曼增益。利用此结果说明这些矩各自简化为何种形式，并解释在实践中如何使用这些恒等式来诊断观测误差协方差 $R$ 和背景误差协方差 $B$ 的错误设定。\n\n选择与上述推导完全一致并提供正确诊断解释的选项：\n\nA. 在所述假设下，且使用最优卡尔曼增益时，$\\mathbb{E}[d d^\\top] = H B H^\\top + R$ 且 $\\mathbb{E}[e d^\\top] = R$。因此，如果 O–A/O–F 互协方差的样本估计值偏离指定的 $R$，则表明 $R$ 被错误设定。同样，O–F 协方差与指定 $R$ 之差可估计 $H B H^\\top$，因此若其与根据指定 $B$ 计算出的 $H B H^\\top$ 不匹配，则表明 $B$ 被错误设定。\n\nB. 对于任何线性增益 $K$，$\\mathbb{E}[e d^\\top] = H B H^\\top$，因此将 O–A/O–F 互协方差与 $H B H^\\top$ 进行比较可诊断 $R$ 的错误设定。仅凭 O–F 协方差无法诊断 $B$，因为它不依赖于 $B$。\n\nC. 如果 $B$ 和 $R$ 被正确设定，则 $\\mathbb{E}[e d^\\top] = 0$，因此任何非零的 O–A/O–F 互协方差样本值都意味着模型偏差。同时，$\\mathbb{E}[d d^\\top] = R$ 且与 $B$ 无关。\n\nD. 当 $K$ 最优时，O–A 协方差满足 $\\mathbb{E}[e e^\\top] = R$，因此将 O–A 协方差与指定的 $R$ 匹配是校准 $R$ 最稳健的方法。O–F 协方差不提供关于 $B$ 的信息，因为 $H B H^\\top$ 被抵消了。\n\nE. 即使对于非线性的 $H$，只要围绕真实状态使用一阶线性化，就有 $\\mathbb{E}[e d^\\top] = R$，而与增益 $K$ 无关。因此，O–A/O–F 互协方差总是估计 $R$，而 O–F 协方差总是估计 $H B H^\\top + R$，且对 $K$ 没有任何要求。",
            "solution": "问题陈述是线性数据同化理论中一个标准的、适定的问题。它为推导所需量提供了所有必要的定义和假设。该问题具有科学依据、客观且内部一致。因此，可以推导出解。\n\n核心任务是推导二阶矩 $\\mathbb{E}[d d^\\top]$、$\\mathbb{E}[e d^\\top]$ 和 $\\mathbb{E}[e e^\\top]$，并在诊断的背景下解释它们，特别是当增益 $K$ 是最优的时。\n\n我们首先用基本误差量，即背景误差 $b$ 和观测误差 $v$，来表示新息 $d$ 和分析残差 $e$。\n\n新息（或观测减预报，O–F）定义为 $d \\equiv y - H x_b$。\n代入给定关系 $y = H x_t + v$ 和 $x_b = x_t + b$：\n$$d = (H x_t + v) - H (x_t + b) = H x_t + v - H x_t - H b = v - H b$$\n问题陈述误差均值为零，即 $\\mathbb{E}[b]=0$ 和 $\\mathbb{E}[v]=0$。因此新息的均值为：\n$$\\mathbb{E}[d] = \\mathbb{E}[v - H b] = \\mathbb{E}[v] - H \\mathbb{E}[b] = 0 - H \\cdot 0 = 0$$\n\n分析残差（或观测减分析，O–A）定义为 $e \\equiv y - H x_a$。\n使用分析状态的定义 $x_a = x_b + K(y - H x_b)$，我们可以写出：\n$$e = y - H (x_b + K(y - H x_b)) = (y - H x_b) - H K (y - H x_b)$$\n注意到 $d = y - H x_b$，这可以简化为：\n$$e = d - H K d = (I - H K) d$$\n其中 $I$ 是大小为 $p \\times p$ 的单位矩阵。\n分析残差的均值也为零：\n$$\\mathbb{E}[e] = \\mathbb{E}[(I - H K)d] = (I - H K)\\mathbb{E}[d] = (I - H K) \\cdot 0 = 0$$\n\n现在，我们推导所要求的二阶矩。\n\n**$\\mathbb{E}[d d^\\top]$ 的推导**\n使用表达式 $d = v - H b$：\n$$\\mathbb{E}[d d^\\top] = \\mathbb{E}[(v - H b)(v - H b)^\\top] = \\mathbb{E}[(v - H b)(v^\\top - b^\\top H^\\top)]$$\n展开乘积：\n$$\\mathbb{E}[d d^\\top] = \\mathbb{E}[v v^\\top - v b^\\top H^\\top - H b v^\\top + H b b^\\top H^\\top]$$\n利用期望算子的线性性：\n$$\\mathbb{E}[d d^\\top] = \\mathbb{E}[v v^\\top] - \\mathbb{E}[v b^\\top] H^\\top - H \\mathbb{E}[b v^\\top] + H \\mathbb{E}[b b^\\top] H^\\top$$\n我们已知误差协方差的定义，$\\mathbb{E}[b b^\\top] = B$ 和 $\\mathbb{E}[v v^\\top] = R$。我们还已知误差是不相关的，意味着 $\\mathbb{E}[b v^\\top] = 0$。由于 $\\mathbb{E}[v b^\\top] = (\\mathbb{E}[b v^\\top])^\\top$，我们也有 $\\mathbb{E}[v b^\\top] = 0$。将这些代入方程中：\n$$\\mathbb{E}[d d^\\top] = R - 0 \\cdot H^\\top - H \\cdot 0 + H B H^\\top$$\n$$\\mathbb{E}[d d^\\top] = H B H^\\top + R$$\n这个新息协方差的表达式对任何线性增益 $K$ 都成立，因为它不依赖于 $K$。\n\n**$\\mathbb{E}[e d^\\top]$ 的推导**\n使用关系式 $e = (I - H K) d$：\n$$\\mathbb{E}[e d^\\top] = \\mathbb{E}[((I - H K) d) d^\\top] = (I - H K) \\mathbb{E}[d d^\\top]$$\n代入 $\\mathbb{E}[d d^\\top]$ 的结果：\n$$\\mathbb{E}[e d^\\top] = (I - H K)(H B H^\\top + R)$$\n这是对任何增益 $K$ 的通用表达式。\n\n现在，我们将情况特殊化，考虑 $K$ 是最优卡尔曼增益的情况，它最小化分析误差方差。最优增益的公式是：\n$$K = B H^\\top (H B H^\\top + R)^{-1}$$\n将这个最优 $K$ 代入 $\\mathbb{E}[e d^\\top]$ 的表达式中：\n$$\\mathbb{E}[e d^\\top] = (I - H [B H^\\top (H B H^\\top + R)^{-1}]) (H B H^\\top + R)$$\n分配 $(H B H^\\top + R)$ 项：\n$$\\mathbb{E}[e d^\\top] = I(H B H^\\top + R) - H B H^\\top (H B H^\\top + R)^{-1} (H B H^\\top + R)$$\n$$\\mathbb{E}[e d^\\top] = (H B H^\\top + R) - H B H^\\top = R$$\n因此，对于最优卡尔曼增益，我们有恒等式 $\\mathbb{E}[e d^\\top] = R$。\n\n**$\\mathbb{E}[e e^\\top]$ 的推导**\n使用关系式 $e = (I - H K) d$：\n$$\\mathbb{E}[e e^\\top] = \\mathbb{E}[((I - H K) d) ((I - H K) d)^\\top] = (I - H K) \\mathbb{E}[d d^\\top] (I - H K)^\\top$$\n代入 $\\mathbb{E}[d d^\\top]$ 和最优 $K$ 的表达式：\n$$\\mathbb{E}[e e^\\top] = (I - H K) (H B H^\\top + R) (I - K^\\top H^\\top)$$\n根据前面的推导，我们知道对于最优的 $K$，项 $(I - H K)(H B H^\\top + R)$ 等于 $R$。因此：\n$$\\mathbb{E}[e e^\\top] = R(I - K^\\top H^\\top) = R - R K^\\top H^\\top$$\n这通常不等于 $R$。\n\n**诊断解释**\n假设系统使用理论上的最优增益（即指定的 $B$ 和 $R$ 是正确的），推导出的恒等式为：\n1.  $\\mathbb{E}[d d^\\top] = H B H^\\top + R$\n2.  $\\mathbb{E}[e d^\\top] = R$\n\n在实践中，数据同化系统使用指定的协方差矩阵，我们称之为 $B_{spec}$ 和 $R_{spec}$，来计算其增益 $K$。然后我们可以计算新息 $d$ 和残差 $e$ 的样本统计量（在多个分析循环中取平均）。\n\n-   **诊断 $R$：** 恒等式 $\\mathbb{E}[e d^\\top] = R$ 是 Desroziers 等人提出的一个强大的诊断工具。如果指定的 $B_{spec}$ 和 $R_{spec}$ 是正确的，那么计算出的增益就是最优的，O-A 和 O-F 之间的样本互协方差，记为 $\\hat{\\mathbb{E}}[e d^\\top]$，应该接近指定的 $R_{spec}$。如果 $\\hat{\\mathbb{E}}[e d^\\top] \\neq R_{spec}$，则表明最优性假设被违反，意味着 $B_{spec}$ 或 $R_{spec}$（或两者）被错误设定。这个检查对 $R_{spec}$ 特别敏感。\n\n-   **诊断 $B$：** 恒等式 $\\mathbb{E}[d d^\\top] = H B H^\\top + R$ 对任何增益都成立。它可以重排为 $\\mathbb{E}[d d^\\top] - R = H B H^\\top$。为了诊断 $B$，可以计算样本新息协方差 $\\hat{\\mathbb{E}}[d d^\\top]$。假设 $R_{spec}$ 是相当明确的（可能已使用第一个诊断工具进行了调整），可以将量 $\\hat{\\mathbb{E}}[d d^\\top] - R_{spec}$ 与理论期望值 $H B_{spec} H^\\top$ 进行比较。显著的差异表明 $B_{spec}$ 被错误设定。\n\n现在我们评估给出的选项。\n\n**A. 在所述假设下，且使用最优卡尔曼增益时，$\\mathbb{E}[d d^\\top] = H B H^\\top + R$ 且 $\\mathbb{E}[e d^\\top] = R$。因此，如果 O–A/O–F 互协方差的样本估计值偏离指定的 $R$，则表明 $R$ 被错误设定。同样，O–F 协方差与指定 $R$ 之差可估计 $H B H^\\top$，因此若其与根据指定 $B$ 计算出的 $H B H^\\top$ 不匹配，则表明 $B$ 被错误设定。**\n此选项正确陈述了两个关键恒等式，$\\mathbb{E}[d d^\\top] = H B H^\\top + R$ 和 $\\mathbb{E}[e d^\\top] = R$。它也正确地解释了它们的诊断用途：O-A/O-F 互协方差 $(\\mathbb{E}[e d^\\top])$ 用于检查 $R$，而 O-F 协方差 $(\\mathbb{E}[d d^\\top])$ 与 $R$ 结合使用来检查 $H B H^\\top$。这个陈述与我们的推导完全一致。\n**结论：正确**\n\n**B. 对于任何线性增益 $K$，$\\mathbb{E}[e d^\\top] = H B H^\\top$，因此将 O–A/O–F 互协方差与 $H B H^\\top$ 进行比较可诊断 $R$ 的错误设定。仅凭 O–F 协方差无法诊断 $B$，因为它不依赖于 $B$。**\n第一个论断，即对于任何 $K$，$\\mathbb{E}[e d^\\top] = H B H^\\top$ 是错误的。我们推导出 $\\mathbb{E}[e d^\\top] = (I - H K)(H B H^\\top + R)$。第二个论断，即 O-F 协方差不依赖于 $B$，也是错误的。我们推导出 $\\mathbb{E}[d d^\\top] = H B H^\\top + R$，它明确依赖于 $B$。\n**结论：不正确**\n\n**C. 如果 $B$ 和 $R$ 被正确设定，则 $\\mathbb{E}[e d^\\top] = 0$，因此任何非零的 O–A/O–F 互协方差样本值都意味着模型偏差。同时，$\\mathbb{E}[d d^\\top] = R$ 且与 $B$ 无关。**\n第一个论断，$\\mathbb{E}[e d^\\top] = 0$ 是错误的。对于一个最优系统，$\\mathbb{E}[e d^\\top] = R$，这通常是非零的。第二个论断，$\\mathbb{E}[d d^\\top] = R$ 也是错误的。正确的表达式是 $\\mathbb{E}[d d^\\top] = H B H^\\top + R$。\n**结论：不正确**\n\n**D. 当 $K$ 最优时，O–A 协方差满足 $\\mathbb{E}[e e^\\top] = R$，因此将 O–A 协方差与指定的 $R$ 匹配是校准 $R$ 最稳健的方法。O–F 协方差不提供关于 $B$ 的信息，因为 $H B H^\\top$ 被抵消了。**\n第一个论断，对于最优 $K$，$\\mathbb{E}[e e^\\top] = R$ 是错误的。如推导所示，$\\mathbb{E}[e e^\\top] = R (I - K^\\top H^\\top)$，这通常不是 $R$。第二个论断，即 O-F 协方差不提供关于 $B$ 的信息，是错误的，如对选项 B 的解释所述。\n**结论：不正确**\n\n**E. 即使对于非线性的 $H$，只要围绕真实状态使用一阶线性化，就有 $\\mathbb{E}[e d^\\top] = R$，而与增益 $K$ 无关。因此，O–A/O–F 互协方差总是估计 $R$，而 O–F 协方差总是估计 $H B H^\\top + R$，且对 $K$ 没有任何要求。**\n恒等式对于线性化的非线性 $H$ 成立的前提是合理的，因为问题是在一个线性化设置中。然而，声称 $\\mathbb{E}[e d^\\top] = R$ “与增益 $K$ 无关”是错误的。这个恒等式是最优增益的一个特殊性质。关于 O-F 协方差的部分是正确的，因为 $\\mathbb{E}[d d^\\top] = H B H^\\top + R$ 不依赖于 K，但陈述的第一部分使整个选项不正确。\n**结论：不正确**\n\n只有选项 A 在其数学恒等式的陈述和实际诊断解释方面是完全正确的。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "变分数据同化方法（如4D-Var）的核心是利用伴随模型高效地计算代价函数的梯度。本练习将探讨基础的“点积检验” (dot-product test)，这是验证伴随模型代码与其对应的切线性模型在数学上是否一致的关键步骤。通过此项检验，我们可以确保优化过程的根基——梯度的计算——是准确无误的，从而保证同化系统的可靠性。",
            "id": "3872884",
            "problem": "在由离散化偏微分方程（PDE）控制的环境和地球系统模型的变分数据同化中，考虑一个离散切线性算子 $A$，它将一个时间点的状态扰动映射到网格化模型中稍后时间点的状态扰动。设定义域和陪域为有限维实向量空间 $X$ 和 $Y$，每个空间都配备了一个定义内积的对称正定权重：对于 $u, v \\in X$，$\\langle u, v\\rangle_{X} = u^{\\top} W_{X} v$；对于 $p, q \\in Y$，$\\langle p, q\\rangle_{Y} = p^{\\top} W_{Y} q$，其中 $W_{X}$ 和 $W_{Y}$ 是对称正定矩阵，例如，在 $L^{2}$ 内积的一致离散化中，它们代表网格体积或质量矩阵。现有代码可用于实现切线性算子 $A$ 的作用，另有独立代码声称实现了其关于给定内积的伴随算子 $A^{\\ast}$。您将通过用随机向量探测这两个算子并比较双线性配对的方式，使用标准的点积测试来验证该伴随算子的实现。\n\n关于如何正确地构建、实现和解释这样一个伴随验证测试，以下哪些陈述是有效的？选择所有适用的选项。\n\nA. 如果 $X$ 和 $Y$ 上的内积由对称正定矩阵 $W_{X}$ 和 $W_{Y}$ 定义，那么代表伴随的矩阵必须满足 $A^{\\ast} = W_{X}^{-1} A^{\\top} W_{Y}$，因此验证时必须使用这些相同的权重来计算双线性配对。\n\nB. 在使用双精度机器 epsilon $\\epsilon_{\\mathrm{mach}}$ 的浮点运算中，一个正确实现的切线性和伴随算子对，在经过适当缩放后，对一系列随机抽样向量比较两个双线性配对时，将产生 $O(\\epsilon_{\\mathrm{mach}})$ 阶的相对差异；显著的差异通常表明内积不匹配或边界条件、时间离散化中存在不一致性。\n\nC. 对于一个通过一系列离散更新来推进的随时间变化的非线性模型，与双线性配对兼容的离散伴随必须使用沿同一基准轨迹求值的线性化更新算子（关于所选内积）的转置进行时间上的向后积分，这意味着必须在相同的时间序列上获得轨迹信息。\n\nD. 欧几里得内积 $\\langle u, v\\rangle = u^{\\top} v$ 对于伴随验证测试总是足够的，即使状态是用非标准正交基（例如具有非平凡质量矩阵的有限元基）表示的；使用任何其他权重都是在测试一个非物理的伴随。\n\nE. 为了验证，仅测试形如 $y = A x$ 的向量（其中 $x$ 是随机选择的）就足够了；如果对于所有此类测试，双线性配对都在紧密容差内匹配，那么就可以保证伴随是正确的。\n\nF. 通过点积测试表明切线性代码和伴随代码相对于相同的双线性形式是一致的，但这本身并不能证明切线性代码是该非线性模型的正确线性化；需要进行独立的 Taylor 余项测试来评估线性化精度。\n\nG. 将测试向量 $x$ 和 $y$ 归一化到单位范数可以保证点积差异小到可以忽略不计，且与 $A$ 的条件数无关，因此在实践中仅靠归一化就足以确保测试通过。",
            "solution": "问题描述了在离散化偏微分方程的变分数据同化背景下，针对一个切线性算子代码 `A` 验证其伴随算子代码 `A*` 的过程。必须根据有限维内积空间中伴随算子的定义来评估这些陈述的正确性。\n\n线性算子 $A: X \\to Y$ 的伴随算子 $A^{\\ast}: Y \\to X$ （关于内积 $\\langle \\cdot, \\cdot \\rangle_{X}$ 和 $\\langle \\cdot, \\cdot \\rangle_{Y}$）的基本定义是满足以下关系的唯一线性算子，对所有 $x \\in X$ 和 $y \\in Y$ 均成立：\n$$\n\\langle Ax, y \\rangle_{Y} = \\langle x, A^{\\ast}y \\rangle_{X}\n$$\n问题指定了内积由对称正定（SPD）权重矩阵 $W_{X}$ 和 $W_{Y}$ 定义：\n$$\n\\langle u, v \\rangle_{X} = u^{\\top} W_{X} v\n$$\n$$\n\\langle p, q \\rangle_{Y} = p^{\\top} W_{Y} q\n$$\n将这些定义代入伴随关系中得到：\n$$\n(Ax)^{\\top} W_{Y} y = x^{\\top} W_{X} (A^{\\ast}y)\n$$\n利用对任意矩阵 $B$ 和向量 $v$ 的属性 $(Bv)^{\\top} = v^{\\top}B^{\\top}$，我们得到：\n$$\nx^{\\top} A^{\\top} W_{Y} y = x^{\\top} (W_{X} A^{\\ast}) y\n$$\n因为这个等式必须对所有向量 $x \\in X$ 和 $y \\in Y$ 成立，所以矩阵本身必须相等：\n$$\nA^{\\top} W_{Y} = W_{X} A^{\\ast}\n$$\n因为 $W_{X}$ 是对称正定的，其逆矩阵 $W_{X}^{-1}$ 存在。我们可以解出伴随算子 $A^{\\ast}$ 的矩阵表示：\n$$\nA^{\\ast} = W_{X}^{-1} A^{\\top} W_{Y}\n$$\n“点积测试”是对基本伴随关系 $\\langle Ax, y \\rangle_{Y} = \\langle x, A^{\\ast}y \\rangle_{X}$ 的一种数值验证，通过为随机选择的向量 $x$ 和 $y$ 计算等式两边，并检查它们是否在浮点精度范围内相等。\n\n基于此，我们评估每个陈述。\n\n**A. 如果 $X$ 和 $Y$ 上的内积由对称正定矩阵 $W_{X}$ 和 $W_{Y}$ 定义，那么代表伴随的矩阵必须满足 $A^{\\ast} = W_{X}^{-1} A^{\\top} W_{Y}$，因此验证时必须使用这些相同的权重来计算双线性配对。**\n如上所述，伴随算子的矩阵表示确实是 $A^{\\ast} = W_{X}^{-1} A^{\\top} W_{Y}$。这个验证测试，被称为点积测试，是定义恒等式 $\\langle Ax, y \\rangle_{Y} = \\langle x, A^{\\ast}y \\rangle_{X}$ 的直接实现。此恒等式仅对定义伴随算子的特定内积有效。要执行该测试，必须将左侧计算为 $(Ax)^{\\top} W_{Y} y$，右侧计算为 $x^{\\top} W_{X} (A^{\\ast}y)$，并比较结果。因此，验证绝对必须使用权重矩阵 $W_X$ 和 $W_Y$。\n**结论：正确。**\n\n**B. 在使用双精度机器 epsilon $\\epsilon_{\\mathrm{mach}}$ 的浮点运算中，一个正确实现的切线性和伴随算子对，在经过适当缩放后，对一系列随机抽样向量比较两个双线性配对时，将产生 $O(\\epsilon_{\\mathrm{mach}})$ 阶的相对差异；显著的差异通常表明内积不匹配或边界条件、时间离散化中存在不一致性。**\n在精确算术中，两个双线性配对是完全相同的。在有限精度浮点运算中，由于舍入误差，计算出的值会有所不同。对于一个良态问题和数值稳定的实现，计算两个标量积 $s_1 = \\langle Ax, y \\rangle_{Y}$ 和 $s_2 = \\langle x, A^{\\ast}y \\rangle_{X}$ 的累积误差会很小。其相对差异，例如 $|s_1 - s_2| / |s_1|$，预计在机器 epsilon 的数量级，可能乘以与向量维数和算子条件数相关的因子。显著大于此值的差异通常表明实现中存在错误。该陈述正确地列出了此类错误的常见且微妙的来源：使用错误的内积（例如，使用单位矩阵代替 $W_X, W_Y$），或在实现像边界条件这样的复杂组件时出错，这些组件也必须被正确地转置。\n**结论：正确。**\n\n**C. 对于一个通过一系列离散更新来推进的随时间变化的非线性模型，与双线性配对兼容的离散伴随必须使用沿同一基准轨迹求值的线性化更新算子（关于所选内积）的转置进行时间上的向后积分，这意味着必须在相同的时间序列上获得轨迹信息。**\n假设一个非线性模型通过一系列步骤来演化状态 $x$：$x_{k+1} = \\mathcal{M}_k(x_k)$。切线性模型通过链式法则传播扰动 $\\delta x$：$\\delta x_N = (L_{N-1} \\circ \\dots \\circ L_1 \\circ L_0) \\delta x_0$，其中 $L_k = \\frac{\\partial \\mathcal{M}_k}{\\partial x_k}$ 是在基准轨迹上求值的第 $k$ 步的切线性算子。完整的切线性算子是 $A = L_{N-1} \\dots L_1 L_0$。复合算子的伴随是伴随算子以相反顺序的复合：$A^{\\ast} = (L_{N-1} \\dots L_0)^{\\ast} = L_0^{\\ast} L_1^{\\ast} \\dots L_{N-1}^{\\ast}$。这种反向排序意味着伴随模型必须按时间顺序向后应用。每个 $L_k$ 都依赖于前向“基准”轨迹的状态 $x_k$，因此其伴随 $L_k^{\\ast}$（“关于所选内积的转置”）也将依赖于 $x_k$。因此，计算完整的伴随作用需要访问前向模型运行中的状态序列。\n**结论：正确。**\n\n**D. 欧几里得内积 $\\langle u, v\\rangle = u^{\\top} v$ 对于伴随验证测试总是足够的，即使状态是用非标准正交基（例如具有非平凡质量矩阵的有限元基）表示的；使用任何其他权重都是在测试一个非物理的伴随。**\n这个陈述是错误的。伴随算子是*相对于*其定义域和陪域上的特定内积来定义的。一个伴随代码是为了一对特定的内积而编写的。用不同的内积（如欧几里得内积，其中 $W_X=I, W_Y=I$）来测试它，是在测试一个不同的数学性质。如果代码是为非单位权重 $W_X, W_Y$ 设计的，那么它将无法通过使用欧几里得权重的测试。此外，声称非欧几里得权重是“非物理的”也是错误的。对于许多偏微分方程的离散化（例如，有限元法、非均匀网格上的有限体积法），规范 $L^2$ 内积 $\\int f(z)g(z) d\\Omega$ 的离散模拟是一个加权内积 $u^{\\top}W v$，其中 $W$ 是一个质量矩阵或网格单元体积的对角矩阵。在这些情况下，带有物理意义（例如能量、质量）的是基于 $L^2$ 的内积，而不是系数向量的欧几里得内积。\n**结论：错误。**\n\n**E. 为了验证，仅测试形如 $y = A x$ 的向量（其中 $x$ 是随机选择的）就足够了；如果对于所有此类测试，双线性配对都在紧密容差内匹配，那么就可以保证伴随是正确的。**\n伴随恒等式必须对陪域 $Y$ 中的*所有*向量 $y$ 成立。将测试向量 $y$ 限制在 $A$ 的值域，即 $y \\in \\mathrm{Ran}(A)$，是不充分的。这个测试检查的是恒等式 $\\langle Ax, Ax' \\rangle_Y = \\langle x, A^{\\ast}(Ax') \\rangle_X$。这验证了复合算子 $A^{\\ast}A$ 的作用，但没有提供关于 $A^{\\ast}$ 在 $A$ 值域之外的向量上作用的任何信息。具体来说，如果 $Y = \\mathrm{Ran}(A) \\oplus (\\mathrm{Ran}(A))^{\\perp}$，这个测试就无法检查 $A^{\\ast}$ 如何作用于子空间 $(\\mathrm{Ran}(A))^{\\perp}$。线性代数基本定理指出 $(\\mathrm{Ran}(A))^{\\perp} = \\mathrm{Ker}(A^{\\ast})$。一个错误的实现可能会将一个向量 $y \\in \\mathrm{Ker}(A^{\\ast})$ 映射到一个非零向量，但这种错误永远不会被所提议的受限测试检测到，因为这样的 $y$ 不会被选中。为了确保正确性，必须从整个空间 $Y$ 中随机选择 $y$。\n**结论：错误。**\n\n**F. 通过点积测试表明切线性代码和伴随代码相对于相同的双线性形式是一致的，但这本身并不能证明切线性代码是该非线性模型的正确线性化；需要进行独立的 Taylor 余项测试来评估线性化精度。**\n这个陈述正确地区分了两个不同且必要的验证步骤。点积测试是针对一对声称是算子及其伴随的线性代码的自洽性检查。它验证了数学关系 $\\langle Ax, y \\rangle_Y = \\langle x, A^{\\ast}y \\rangle_X$。它假定 $A$ 的代码是给定的，并验证 $A^{\\ast}$ 的代码。它没有提供任何关于算子 $A$ 本身是否是底层非线性模型 $\\mathcal{M}$ 的正确导数（线性化）表示的信息。要验证切线性代码 $A$ 本身，必须执行 Taylor 测试，该测试检查余项 $\\mathcal{R}(\\delta x) = \\mathcal{M}(x_0 + \\delta x) - \\mathcal{M}(x_0) - A(x_0)\\delta x$ 是否满足 $\\|\\mathcal{R}(\\delta x)\\| = O(\\|\\delta x\\|^2)$。\n**结论：正确。**\n\n**G. 将测试向量 $x$ 和 $y$ 归一化到单位范数可以保证点积差异小到可以忽略不计，且与 $A$ 的条件数无关，因此在实践中仅靠归一化就足以确保测试通过。**\n这个陈述是错误的。虽然归一化输入向量 $x$ 和 $y$（相对于正确的范数，即 $\\|x\\|_X=1$ 和 $\\|y\\|_Y=1$）是标准化测试的好做法，但它并不能消除算子条件数的影响。算子（或矩阵）的条件数刻画了数值计算过程中输入误差到输出误差的放大程度。如果 $A$ 是病态的，那么 $Ax$ 的计算可能会遭受显著的相对精度损失，而不管 $x$ 的范数如何。这个在 $Ax$ 计算值中增加的数值误差随后会传播到双线性配对 $\\langle Ax, y \\rangle_Y$ 中，与 $\\langle x, A^{\\ast}y \\rangle_X$ 相比，可能导致较大的差异。因此，该差异并非与 $A$ 的条件数无关。\n**结论：错误。**",
            "answer": "$$\\boxed{ABCF}$$"
        }
    ]
}