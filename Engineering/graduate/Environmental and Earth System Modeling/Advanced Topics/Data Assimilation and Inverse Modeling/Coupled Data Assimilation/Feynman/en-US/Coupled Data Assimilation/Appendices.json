{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes to the heart of coupled data assimilation by asking you to derive and compute the precise reduction in ocean uncertainty from an atmospheric observation. By deriving an analytical formula for the analysis variance, you will gain a clear understanding of how the strength of cross-domain correlation ($\\rho$), observation error ($R$), and background variances ($B_{\\text{aa}}$) govern the transfer of information between Earth system components. This foundational practice uses a verification experiment to isolate and quantify the benefits of using cross-domain covariances.",
            "id": "4028482",
            "problem": "Design and implement a verification experiment in a simplified coupled data assimilation setting to isolate and quantify the contribution of atmospheric observations to ocean analysis skill by toggling cross-domain covariances and computing differential metrics.\n\nConsider a linear, time-instantaneous, two-component state vector $\\mathbf{x} = [x_{\\mathrm{a}}, x_{\\mathrm{o}}]^{\\top}$ representing an atmospheric scalar $x_{\\mathrm{a}}$ and an ocean scalar $x_{\\mathrm{o}}$. Assume a Gaussian background (prior) distribution $\\mathbf{x} \\sim \\mathcal{N}(\\mu_{\\mathrm{b}}, \\mathbf{B})$ with background covariance matrix\n$$\n\\mathbf{B} = \\begin{bmatrix}\nB_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\\nB_{\\mathrm{oa}}  B_{\\mathrm{oo}}\n\\end{bmatrix}, \\quad B_{\\mathrm{oa}} = B_{\\mathrm{ao}},\n$$\nwhere $B_{\\mathrm{aa}}$ and $B_{\\mathrm{oo}}$ are the background variances for the atmosphere and ocean, respectively, and $B_{\\mathrm{ao}}$ is the cross-covariance capturing cross-domain correlations. Parameterize the cross-covariance as $B_{\\mathrm{ao}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$ with correlation coefficient $\\rho \\in (-1, 1)$.\n\nAssume a single atmospheric observation $y$ with the linear observation operator $\\mathbf{H} = [1, 0]$ and observation error model $y = \\mathbf{H} \\mathbf{x} + \\varepsilon$, where $\\varepsilon \\sim \\mathcal{N}(0, R)$ and $R$ is the observation error variance. Under linear-Gaussian assumptions, the Kalman analysis (posterior) covariance is given by\n$$\n\\mathbf{P}_{\\mathrm{a}} = (\\mathbf{I} - \\mathbf{K} \\mathbf{H}) \\mathbf{B}, \\quad \\mathbf{K} = \\mathbf{B} \\mathbf{H}^{\\top} (\\mathbf{H} \\mathbf{B} \\mathbf{H}^{\\top} + R)^{-1},\n$$\nwhere $\\mathbf{I}$ is the identity matrix and $\\mathbf{K}$ is the Kalman gain.\n\nYour task is to write a program that, for each test case, computes two scalar metrics that isolate the impact of cross-domain covariances on the ocean analysis skill when assimilating only atmospheric observations:\n\n1. The absolute reduction in the ocean analysis variance due solely to cross-domain coupling, defined as\n$$\n\\Delta_{\\mathrm{var}} = P_{\\mathrm{oo}}^{\\mathrm{decoupled}} - P_{\\mathrm{oo}}^{\\mathrm{coupled}},\n$$\nwhere $P_{\\mathrm{oo}}^{\\mathrm{coupled}}$ is the ocean component of the analysis covariance when $B_{\\mathrm{ao}}$ is set to the parameterized nonzero value, and $P_{\\mathrm{oo}}^{\\mathrm{decoupled}}$ is the ocean component when the cross-covariance is toggled off (set to $0$) while keeping $B_{\\mathrm{aa}}$, $B_{\\mathrm{oo}}$, and $R$ unchanged.\n\n2. The relative reduction (dimensionless fraction) in the ocean analysis variance due to coupling, defined as\n$$\n\\delta_{\\mathrm{rel}} = \\frac{\\Delta_{\\mathrm{var}}}{B_{\\mathrm{oo}}}.\n$$\n\nBase your derivation and algorithm on the foundational principles of linear-Gaussian estimation and the Kalman filter update for the covariance, namely the definitions above and the fact that for jointly Gaussian variables, conditioning reduces variance along observed directions in proportion to covariances.\n\nImplement the following test suite with the specified parameter values:\n- Test case $1$: $B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.5$, $R = 0.25$.\n- Test case $2$: $B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.0$, $R = 0.25$.\n- Test case $3$: $B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 2.0$, $\\rho = 0.7$, $R = 1000000.0$.\n- Test case $4$: $B_{\\mathrm{aa}} = 4.0$, $B_{\\mathrm{oo}} = 0.25$, $\\rho = 0.9$, $R = 0.01$.\n- Test case $5$: $B_{\\mathrm{aa}} = 0.01$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.8$, $R = 1.0$.\n- Test case $6$: $B_{\\mathrm{aa}} = 2.0$, $B_{\\mathrm{oo}} = 3.0$, $\\rho = -0.7$, $R = 0.5$.\n\nFor each test case, compute and report the pair $[\\Delta_{\\mathrm{var}}, \\delta_{\\mathrm{rel}}]$ as floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[ [\\Delta_{\\mathrm{var}}^{(1)}, \\delta_{\\mathrm{rel}}^{(1)}], [\\Delta_{\\mathrm{var}}^{(2)}, \\delta_{\\mathrm{rel}}^{(2)}], \\dots ]$). No physical units are required since all quantities are variances and dimensionless ratios in arbitrary but consistent units. Angles are not involved. Do not express any quantity as a percentage; express $\\delta_{\\mathrm{rel}}$ as a decimal fraction.",
            "solution": "The problem requires designing a verification experiment to quantify the impact of cross-domain covariances on ocean analysis skill. We are given a simplified two-component system (atmosphere $x_{\\mathrm{a}}$, ocean $x_{\\mathrm{o}}$), a linear observation operator for the atmosphere, and the standard equations for the Kalman filter analysis covariance. We must derive and compute two metrics: the absolute variance reduction in the ocean state, $\\Delta_{\\mathrm{var}}$, and the relative variance reduction, $\\delta_{\\mathrm{rel}}$, due to the assimilation of an atmospheric observation.\n\nFirst, we will derive analytical expressions for these metrics. The state vector is $\\mathbf{x} = [x_{\\mathrm{a}}, x_{\\mathrm{o}}]^{\\top}$. The background covariance matrix $\\mathbf{B}$, observation operator $\\mathbf{H}$, and identity matrix $\\mathbf{I}$ are:\n$$\n\\mathbf{B} = \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix}, \\quad \\mathbf{H} = [1 \\quad 0], \\quad \\mathbf{I} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}\n$$\nwhere the cross-covariance is parameterized as $B_{\\mathrm{ao}} = B_{\\mathrm{oa}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$. The observation error variance is a scalar $R$.\n\nThe Kalman analysis covariance is given by $\\mathbf{P}_{\\mathrm{a}} = (\\mathbf{I} - \\mathbf{K} \\mathbf{H}) \\mathbf{B}$, with the Kalman gain $\\mathbf{K} = \\mathbf{B} \\mathbf{H}^{\\top} (\\mathbf{H} \\mathbf{B} \\mathbf{H}^{\\top} + R)^{-1}$.\n\nLet's derive the components of the Kalman gain $\\mathbf{K}$.\nThe term $\\mathbf{B} \\mathbf{H}^{\\top}$ is:\n$$\n\\mathbf{B} \\mathbf{H}^{\\top} = \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix}\n$$\nThe innovation covariance term $\\mathbf{H} \\mathbf{B} \\mathbf{H}^{\\top} + R$ is a scalar:\n$$\n\\mathbf{H} \\mathbf{B} \\mathbf{H}^{\\top} + R = [1 \\quad 0] \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} + R = B_{\\mathrm{aa}} + R\n$$\nSince $B_{\\mathrm{aa}}$ is a variance and $R$ is a positive error variance, the denominator $(B_{\\mathrm{aa}} + R)$ is always positive, so its inverse exists. The Kalman gain $\\mathbf{K}$ is a $2 \\times 1$ column vector:\n$$\n\\mathbf{K} = \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} (B_{\\mathrm{aa}} + R)^{-1} = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix}\n$$\nNext, we compute the matrix factor $(\\mathbf{I} - \\mathbf{K} \\mathbf{H})$:\n$$\n\\mathbf{K} \\mathbf{H} = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} [1 \\quad 0] = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}}  0 \\\\ B_{\\mathrm{oa}}  0 \\end{bmatrix}\n$$\n$$\n\\mathbf{I} - \\mathbf{K} \\mathbf{H} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}}  0 \\\\ B_{\\mathrm{oa}}  0 \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix} = \\begin{bmatrix} \\frac{R}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix}\n$$\nNow, we compute the full analysis covariance matrix $\\mathbf{P}_{\\mathrm{a}} = (\\mathbf{I} - \\mathbf{K} \\mathbf{H}) \\mathbf{B}$:\n$$\n\\mathbf{P}_{\\mathrm{a}} = \\begin{bmatrix} \\frac{R}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix} \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix} = \\begin{bmatrix} \\frac{R B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}  \\frac{R B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R} \\\\ \\frac{-B_{\\mathrm{oa}} B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R} + B_{\\mathrm{oa}}  \\frac{-B_{\\mathrm{oa}} B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R} + B_{\\mathrm{oo}} \\end{bmatrix}\n$$\nThe off-diagonal term $P_{\\mathrm{oa}}$ simplifies to $\\frac{B_{\\mathrm{oa}}(-B_{\\mathrm{aa}} + B_{\\mathrm{aa}} + R)}{B_{\\mathrm{aa}} + R} = \\frac{R B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}$, confirming the symmetry of $\\mathbf{P}_{\\mathrm{a}}$ since $B_{\\mathrm{oa}} = B_{\\mathrm{ao}}$.\n\nOur focus is on the ocean analysis variance, which is the bottom-right element of $\\mathbf{P}_{\\mathrm{a}}$, denoted $P_{\\mathrm{oo}}$:\n$$\nP_{\\mathrm{oo}} = B_{\\mathrm{oo}} - \\frac{B_{\\mathrm{oa}} B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R}\n$$\nSince $B_{\\mathrm{oa}} = B_{\\mathrm{ao}}$, this simplifies to:\n$$\nP_{\\mathrm{oo}} = B_{\\mathrm{oo}} - \\frac{B_{\\mathrm{ao}}^2}{B_{\\mathrm{aa}} + R}\n$$\nThis expression allows us to compute the ocean analysis variance for both the \"coupled\" and \"decoupled\" scenarios.\n\nFor the **coupled** case, we use the parameterized cross-covariance $B_{\\mathrm{ao}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$. Squaring this gives $B_{\\mathrm{ao}}^2 = \\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}$. Substituting this into the expression for $P_{\\mathrm{oo}}$ yields the coupled ocean analysis variance:\n$$\nP_{\\mathrm{oo}}^{\\mathrm{coupled}} = B_{\\mathrm{oo}} - \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\n$$\nFor the **decoupled** case, the cross-domain covariance is toggled off, meaning we set $B_{\\mathrm{ao}} = 0$. This corresponds to setting the correlation coefficient $\\rho = 0$. The resulting ocean analysis variance is:\n$$\nP_{\\mathrm{oo}}^{\\mathrm{decoupled}} = B_{\\mathrm{oo}} - \\frac{0^2}{B_{\\mathrm{aa}} + R} = B_{\\mathrm{oo}}\n$$\nThis result is intuitive: if the ocean and atmosphere are uncorrelated in the background, an observation of the atmosphere provides no information to update the ocean state, so its variance remains unchanged from the background value $B_{\\mathrm{oo}}$.\n\nNow, we can compute the required metrics.\n\n1.  The absolute reduction in ocean analysis variance, $\\Delta_{\\mathrm{var}}$:\n    $$\n    \\Delta_{\\mathrm{var}} = P_{\\mathrm{oo}}^{\\mathrm{decoupled}} - P_{\\mathrm{oo}}^{\\mathrm{coupled}} = B_{\\mathrm{oo}} - \\left(B_{\\mathrm{oo}} - \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\\right)\n    $$\n    $$\n    \\Delta_{\\mathrm{var}} = \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\n    $$\n    This quantity represents the direct reduction in uncertainty (variance) in the ocean state due to the information transferred from the atmospheric observation via the cross-domain correlation $\\rho$.\n\n2.  The relative reduction in ocean analysis variance, $\\delta_{\\mathrm{rel}}$:\n    $$\n    \\delta_{\\mathrm{rel}} = \\frac{\\Delta_{\\mathrm{var}}}{B_{\\mathrm{oo}}} = \\frac{1}{B_{\\mathrm{oo}}} \\left(\\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\\right)\n    $$\n    $$\n    \\delta_{\\mathrm{rel}} = \\frac{\\rho^2 B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}\n    $$\n    This dimensionless metric gives the fractional reduction in ocean variance. It is interestingly independent of the ocean's background variance $B_{\\mathrm{oo}}$ and is simply the squared correlation $\\rho^2$ modulated by the factor $\\frac{B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}$, which represents the fractional variance reduction of the observed atmospheric variable itself.\n\nThe algorithm for the program is to apply these two final formulas to each of the provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes metrics for a coupled data assimilation experiment.\n\n    For each test case, the function calculates the absolute and relative \n    reduction in ocean analysis variance due to cross-domain correlations \n    when assimilating only atmospheric observations.\n    \"\"\"\n\n    test_cases = [\n        # (B_aa, B_oo, rho, R)\n        (1.0, 1.0, 0.5, 0.25),\n        (1.0, 1.0, 0.0, 0.25),\n        (1.0, 2.0, 0.7, 1000000.0),\n        (4.0, 0.25, 0.9, 0.01),\n        (0.01, 1.0, 0.8, 1.0),\n        (2.0, 3.0, -0.7, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        B_aa, B_oo, rho, R = case\n\n        # Derived formula for the absolute reduction in ocean analysis variance\n        # delta_var = (rho^2 * B_aa * B_oo) / (B_aa + R)\n        delta_var = (rho**2 * B_aa * B_oo) / (B_aa + R)\n\n        # Derived formula for the relative reduction in ocean analysis variance\n        # delta_rel = delta_var / B_oo  or  (rho^2 * B_aa) / (B_aa + R)\n        if B_oo == 0:\n            # Handle the case where B_oo is zero, though not in test cases.\n            # In this scenario, variance is already zero, so relative reduction is ill-defined.\n            # We can define it as 0 as there's no variance to reduce.\n            delta_rel = 0.0\n        else:\n            delta_rel = delta_var / B_oo\n\n        results.append([delta_var, delta_rel])\n\n    # Format the final output string exactly as required.\n    # e.g., [[val1, val2], [val3, val4], ...]\n    # The map(str, ...) correctly converts each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from theory to a more practical application, this exercise challenges you to implement a hybrid ensemble-variational (3DEnVar) analysis for a small coupled system. You will learn how modern data assimilation systems construct background error covariances by blending a static matrix ($\\mathbf{B}_s$) with one derived from an ensemble of forecasts ($\\mathbf{B}_e$). This hands-on coding problem illustrates how dynamic, flow-dependent cross-correlations are estimated and utilized to create updates in unobserved parts of the system.",
            "id": "3872517",
            "problem": "Consider a linear Gaussian coupled Earth system composed of two components: an atmospheric component and an oceanic component. Let the state vector be $\\mathbf{x} \\in \\mathbb{R}^4$ with indices $0,1$ corresponding to the atmosphere and indices $2,3$ corresponding to the ocean. A background state $\\mathbf{x}^b$ and covariances are given. Observations are linear in the state with additive Gaussian errors. You are to compute the analysis state under a three-dimensional ensemble-variational (3DEnVar) hybrid covariance, blending a static background covariance with an ensemble-based covariance estimated from anomalies, and then evaluate the cross-component increments induced by observations.\n\nStart from the following fundamental base:\n- Linear observation operator mapping $\\mathbf{x}$ to the observation space given by a matrix $\\mathbf{H}$.\n- A linear-Gaussian prior and likelihood: $\\mathbf{x} \\sim \\mathcal{N}(\\mathbf{x}^b, \\mathbf{B})$ and $\\mathbf{y} = \\mathbf{H} \\mathbf{x} + \\epsilon$ with $\\epsilon \\sim \\mathcal{N}(0, \\mathbf{R})$, where $\\mathbf{B}$ is the prior covariance and $\\mathbf{R}$ is the observation error covariance.\n- A hybrid prior covariance $\\mathbf{B}_h$ defined by a convex combination of a static covariance $\\mathbf{B}_s$ and an ensemble covariance $\\mathbf{B}_e$ estimated from anomalies, with a scalar weight $w \\in [0,1]$ such that $\\mathbf{B}_h = w \\mathbf{B}_s + (1 - w) \\mathbf{B}_e$.\n- The ensemble covariance $\\mathbf{B}_e$ is estimated from an anomalies matrix $\\mathbf{A} \\in \\mathbb{R}^{n \\times m}$ as $\\mathbf{B}_e = \\frac{1}{m-1} \\mathbf{A} \\mathbf{A}^\\top$, where $n$ is the state dimension and $m$ is the ensemble size.\n\nYour program must, for each test case defined below, construct $\\mathbf{B}_e$ from the given anomalies $\\mathbf{A}$, construct $\\mathbf{B}_h$ from the given $\\mathbf{B}_s$ and weight $w$, then compute the analysis state $\\mathbf{x}^a$ that minimizes the standard linear-Gaussian variational cost function combining the prior term defined by $\\mathbf{B}_h$ and the observation misfit term defined by $\\mathbf{R}$. Report the cross-component increment magnitude as the Euclidean norm of the analysis increment in the component that is not directly observed.\n\nDefinitions for computing the required quantity:\n- The analysis increment is $\\mathbf{x}^a - \\mathbf{x}^b \\in \\mathbb{R}^4$.\n- The cross-component increment magnitude is the Euclidean norm of the subvector of $\\mathbf{x}^a - \\mathbf{x}^b$ corresponding to the component that is not directly observed in that test case. For tests that observe the atmosphere (indices $0,1$), compute the Euclidean norm over indices $2,3$. For tests that observe the ocean (indices $2,3$), compute the Euclidean norm over indices $0,1$.\n\nUse the following fixed data, consistent across all test cases:\n- State dimension: $n = 4$. Atmospheric indices: $0,1$. Oceanic indices: $2,3$.\n- Background state: $\\mathbf{x}^b = [1.0, -0.5, 0.2, -0.1]^\\top$.\n- Static background covariance:\n$$\n\\mathbf{B}_s = \\begin{bmatrix}\n1.0  0.5  0.0  0.0 \\\\\n0.5  1.0  0.0  0.0 \\\\\n0.0  0.0  0.6  0.18 \\\\\n0.0  0.0  0.18  0.6\n\\end{bmatrix}.\n$$\n- Ensemble anomalies for the first ensemble (labeled $\\mathbf{A}_1$, with $m=5$ members):\n$$\n\\mathbf{A}_1 = \\begin{bmatrix}\n0.5  -0.2  0.3  -0.1  -0.5 \\\\\n-0.1  0.4  -0.2  0.3  -0.4 \\\\\n0.4  -0.1  0.2  -0.05  -0.3 \\\\\n0.2  -0.05  0.15  -0.02  -0.1\n\\end{bmatrix}.\n$$\n- Ensemble anomalies for the second ensemble (labeled $\\mathbf{A}_2$, with $m=5$ members):\n$$\n\\mathbf{A}_2 = \\begin{bmatrix}\n0.5  -0.2  0.3  -0.1  -0.5 \\\\\n-0.1  0.4  -0.2  0.3  -0.4 \\\\\n-0.3  0.1  -0.25  0.2  0.25 \\\\\n0.05  -0.15  0.2  -0.1  0.0\n\\end{bmatrix}.\n$$\n\nTest suite:\n- Test case 1 (atmosphere observed, hybrid with cross-covariance from $\\mathbf{A}_1$):\n  - Observation operator $\\mathbf{H}$ is a $1 \\times 4$ matrix selecting index $0$: $\\mathbf{H} = [1, 0, 0, 0]$.\n  - Observation vector $\\mathbf{y} = [1.5]^\\top$.\n  - Observation error covariance $\\mathbf{R}$ is $[0.04]$ (a $1 \\times 1$ matrix).\n  - Hybrid weight $w = 0.5$.\n  - Ensemble anomalies $\\mathbf{A} = \\mathbf{A}_1$.\n  - Report the Euclidean norm over indices $2,3$ of the analysis increment.\n\n- Test case 2 (atmosphere observed, alternative ensemble anomalies $\\mathbf{A}_2$):\n  - $\\mathbf{H} = [1, 0, 0, 0]$.\n  - $\\mathbf{y} = [1.5]^\\top$.\n  - $\\mathbf{R} = [0.04]$.\n  - $w = 0.5$.\n  - $\\mathbf{A} = \\mathbf{A}_2$.\n  - Report the Euclidean norm over indices $2,3$ of the analysis increment.\n\n- Test case 3 (atmosphere observed, larger observation error):\n  - $\\mathbf{H} = [1, 0, 0, 0]$.\n  - $\\mathbf{y} = [1.5]^\\top$.\n  - $\\mathbf{R} = [1.0]$.\n  - $w = 0.5$.\n  - $\\mathbf{A} = \\mathbf{A}_1$.\n  - Report the Euclidean norm over indices $2,3$ of the analysis increment.\n\n- Test case 4 (pure static, atmosphere observed):\n  - $\\mathbf{H} = [1, 0, 0, 0]$.\n  - $\\mathbf{y} = [1.5]^\\top$.\n  - $\\mathbf{R} = [0.04]$.\n  - $w = 1.0$.\n  - $\\mathbf{A} = \\mathbf{A}_1$.\n  - Report the Euclidean norm over indices $2,3$ of the analysis increment.\n\n- Test case 5 (pure ensemble, ocean observed):\n  - $\\mathbf{H} = [0, 0, 1, 0]$.\n  - $\\mathbf{y} = [0.8]^\\top$.\n  - $\\mathbf{R} = [0.09]$.\n  - $w = 0.0$.\n  - $\\mathbf{A} = \\mathbf{A}_1$.\n  - Report the Euclidean norm over indices $0,1$ of the analysis increment.\n\nYour program should produce a single line of output containing the cross-component increment magnitudes for the tests as a comma-separated list enclosed in square brackets, with each value rounded to $6$ decimal places (e.g., \"[v1,v2,v3,v4,v5]\"). No physical units are involved. Angles are not used. Percentages are not used.",
            "solution": "The problem requires the computation of the cross-component analysis increment magnitude in a coupled linear-Gaussian data assimilation system. The analysis state, $\\mathbf{x}^a$, is the state vector that minimizes the three-dimensional variational (3D-Var) cost function, $J(\\mathbf{x})$. This cost function measures the misfit to the background state, $\\mathbf{x}^b$, and the observations, $\\mathbf{y}$, weighted by their respective error covariances.\n\nThe cost function is given by:\n$$J(\\mathbf{x}) = \\frac{1}{2}(\\mathbf{x} - \\mathbf{x}^b)^\\top \\mathbf{B}_h^{-1} (\\mathbf{x} - \\mathbf{x}^b) + \\frac{1}{2}(\\mathbf{y} - \\mathbf{H}\\mathbf{x})^\\top \\mathbf{R}^{-1} (\\mathbf{y} - \\mathbf{H}\\mathbf{x})$$\nHere, $\\mathbf{H}$ is the linear observation operator, $\\mathbf{R}$ is the observation error covariance matrix, and $\\mathbf{B}_h$ is the hybrid background error covariance matrix.\n\nFor a linear-Gaussian system, this quadratic cost function has a unique minimum. The analysis state $\\mathbf{x}^a$ that minimizes $J(\\mathbf{x})$ can be found by setting the gradient $\\nabla_\\mathbf{x} J(\\mathbf{x})$ to zero. The analytical solution is given by the Best Linear Unbiased Estimator (BLUE) equation:\n$$\\mathbf{x}^a = \\mathbf{x}^b + \\mathbf{K}(\\mathbf{y} - \\mathbf{H}\\mathbf{x}^b)$$\nwhere $\\mathbf{K}$ is the Kalman gain matrix. This form is computationally advantageous, particularly when the dimension of the observation space is much smaller than the state space, as it avoids the direct inversion of the large $n \\times n$ matrix $\\mathbf{B}_h$. The Kalman gain $\\mathbf{K}$ is defined as:\n$$\\mathbf{K} = \\mathbf{B}_h \\mathbf{H}^\\top (\\mathbf{H} \\mathbf{B}_h \\mathbf{H}^\\top + \\mathbf{R})^{-1}$$\n\nThe term $\\mathbf{x}^a - \\mathbf{x}^b$ is the analysis increment, which represents the update applied to the background state based on the information from the observations.\n$$\\delta \\mathbf{x}^a = \\mathbf{x}^a - \\mathbf{x}^b = \\mathbf{K}(\\mathbf{y} - \\mathbf{H}\\mathbf{x}^b)$$\nThe term $\\mathbf{d} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}^b$ is the innovation, or observation-minus-forecast, which is the discrepancy between the actual observation and the observation predicted from the background state.\n\nThe background error covariance $\\mathbf{B}_h$ is a hybrid formulation, constructed as a weighted average of a static covariance, $\\mathbf{B}_s$, and an ensemble-derived covariance, $\\mathbf{B}_e$:\n$$\\mathbf{B}_h = w \\mathbf{B}_s + (1 - w) \\mathbf{B}_e$$\nwhere $w \\in [0, 1]$ is a scalar weight.\n\nThe static covariance $\\mathbf{B}_s$ is provided and is block-diagonal, implying no a priori correlation between the atmospheric components (indices $0,1$) and the oceanic components (indices $2,3$).\n$$\n\\mathbf{B}_s = \\begin{bmatrix}\n\\mathbf{B}_{\\text{aa}}  0 \\\\\n0  \\mathbf{B}_{\\text{oo}}\n\\end{bmatrix}\n$$\n'aa' denotes atmosphere-atmosphere and 'oo' denotes ocean-ocean blocks.\n\nThe ensemble covariance $\\mathbf{B}_e$ is estimated from a matrix of ensemble anomalies, $\\mathbf{A} \\in \\mathbb{R}^{n \\times m}$, where $n=4$ is the state dimension and $m=5$ is the ensemble size. The formula for the unbiased sample covariance is:\n$$\\mathbf{B}_e = \\frac{1}{m-1} \\mathbf{A} \\mathbf{A}^\\top$$\nThe matrix $\\mathbf{A} \\mathbf{A}^\\top$ captures the covariance structure as sampled by the ensemble. Crucially, if the ensemble members exhibit correlations between the atmospheric and oceanic components, the resulting $\\mathbf{B}_e$ will have non-zero off-diagonal blocks (atmosphere-ocean cross-covariances).\n\nThe cross-component update is the central concept being tested. When an observation is made in one component (e.g., atmosphere), the analysis increment $\\delta \\mathbf{x}^a$ can have non-zero elements in the other, unobserved component (e.g., ocean). This is only possible if the Kalman gain matrix $\\mathbf{K}$ has a structure that maps innovations from the observed component to state variables in the unobserved component. This structure is inherited directly from the background error covariance $\\mathbf{B}_h$. Specifically, if the columns of $\\mathbf{B}_h$ corresponding to the observed state variables have non-zero rows corresponding to the unobserved state variables (i.e., the cross-covariance blocks are non-zero), a cross-component update will occur. In this problem, such cross-covariances are introduced by the ensemble term $\\mathbf{B}_e$ when $w  1$.\n\nThe required output for each test case is the Euclidean norm of the subvector of the analysis increment $\\delta \\mathbf{x}^a$ corresponding to the component that is not directly observed. For an observation of the atmosphere (indices $0,1$), this is $||\\delta \\mathbf{x}^a_{2:3}||_2$. For an observation of the ocean (indices $2,3$), this is $||\\delta \\mathbf{x}^a_{0:1}||_2$.\n\nThe algorithm for each test case is as follows:\n1.  Construct the ensemble covariance matrix $\\mathbf{B}_e$ from the given anomaly matrix $\\mathbf{A}$.\n2.  Construct the hybrid covariance matrix $\\mathbf{B}_h$ using the specified weight $w$.\n3.  Calculate the Kalman gain matrix $\\mathbf{K}$.\n4.  Calculate the innovation $\\mathbf{d} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}^b$.\n5.  Compute the analysis increment $\\delta \\mathbf{x}^a = \\mathbf{K} \\mathbf{d}$.\n6.  Identify the unobserved state component based on the structure of the observation operator $\\mathbf{H}$.\n7.  Extract the subvector of $\\delta \\mathbf{x}^a$ for the unobserved component and compute its Euclidean norm.\nThis procedure is applied to each of the five test cases defined in the problem.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_cross_increment_norm(x_b, B_s, a_matrix, w, H, y, R):\n    \"\"\"\n    Computes the cross-component analysis increment magnitude for a single test case.\n\n    Args:\n        x_b (np.ndarray): Background state vector (n,).\n        B_s (np.ndarray): Static background error covariance matrix (n, n).\n        a_matrix (np.ndarray): Ensemble anomalies matrix (n, m).\n        w (float): Hybrid weight.\n        H (np.ndarray): Observation operator matrix (k, n).\n        y (np.ndarray): Observation vector (k,).\n        R (np.ndarray): Observation error covariance matrix (k, k).\n\n    Returns:\n        float: The Euclidean norm of the cross-component analysis increment.\n    \"\"\"\n    n, m = a_matrix.shape  # n: state dimension, m: ensemble size\n\n    # 1. Construct ensemble and hybrid covariance matrices\n    B_e = (1 / (m - 1)) * (a_matrix @ a_matrix.T)\n    B_h = w * B_s + (1 - w) * B_e\n\n    # 2. Calculate Kalman gain K = B_h H^T (H B_h H^T + R)^-1\n    # H.T is (n, k), B_h is (n, n), so B_h @ H.T is (n, k)\n    k_num = B_h @ H.T\n    # H is (k, n), k_num is (n, k), so H @ k_num is (k, k)\n    # R is (k, k)\n    k_den = H @ B_h @ H.T + R\n    k_den_inv = np.linalg.inv(k_den)\n    K = k_num @ k_den_inv  # K is (n, k)\n\n    # 3. Calculate innovation d = y - H x_b\n    innovation = y - (H @ x_b) # innovation is (k,)\n\n    # 4. Compute analysis increment dx = K d\n    analysis_increment = K @ innovation  # analysis_increment is (n,)\n\n    # 5. Identify unobserved component and compute norm\n    observed_idx = np.where(H[0, :] != 0)[0][0]\n    \n    if observed_idx in [0, 1]:  # Atmosphere observed\n        unobserved_slice = slice(2, 4)\n    else:  # Ocean observed (indices 2, 3)\n        unobserved_slice = slice(0, 2)\n    \n    cross_increment_vector = analysis_increment[unobserved_slice]\n    \n    norm = np.linalg.norm(cross_increment_vector)\n    \n    return norm\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Fixed data across all test cases\n    x_b = np.array([1.0, -0.5, 0.2, -0.1])\n    B_s = np.array([\n        [1.0, 0.5, 0.0, 0.0],\n        [0.5, 1.0, 0.0, 0.0],\n        [0.0, 0.0, 0.6, 0.18],\n        [0.0, 0.0, 0.18, 0.6]\n    ])\n    A1 = np.array([\n        [0.5, -0.2, 0.3, -0.1, -0.5],\n        [-0.1, 0.4, -0.2, 0.3, -0.4],\n        [0.4, -0.1, 0.2, -0.05, -0.3],\n        [0.2, -0.05, 0.15, -0.02, -0.1]\n    ])\n    A2 = np.array([\n        [0.5, -0.2, 0.3, -0.1, -0.5],\n        [-0.1, 0.4, -0.2, 0.3, -0.4],\n        [-0.3, 0.1, -0.25, 0.2, 0.25],\n        [0.05, -0.15, 0.2, -0.1, 0.0]\n    ])\n\n    test_cases = [\n        # Test case 1\n        {\n            \"H\": np.array([[1.0, 0.0, 0.0, 0.0]]), \"y\": np.array([1.5]), \n            \"R\": np.array([[0.04]]), \"w\": 0.5, \"A\": A1\n        },\n        # Test case 2\n        {\n            \"H\": np.array([[1.0, 0.0, 0.0, 0.0]]), \"y\": np.array([1.5]),\n            \"R\": np.array([[0.04]]), \"w\": 0.5, \"A\": A2\n        },\n        # Test case 3\n        {\n            \"H\": np.array([[1.0, 0.0, 0.0, 0.0]]), \"y\": np.array([1.5]),\n            \"R\": np.array([[1.0]]), \"w\": 0.5, \"A\": A1\n        },\n        # Test case 4\n        {\n            \"H\": np.array([[1.0, 0.0, 0.0, 0.0]]), \"y\": np.array([1.5]),\n            \"R\": np.array([[0.04]]), \"w\": 1.0, \"A\": A1\n        },\n        # Test case 5\n        {\n            \"H\": np.array([[0.0, 0.0, 1.0, 0.0]]), \"y\": np.array([0.8]),\n            \"R\": np.array([[0.09]]), \"w\": 0.0, \"A\": A1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_cross_increment_norm(\n            x_b=x_b, B_s=B_s, a_matrix=case[\"A\"], w=case[\"w\"],\n            H=case[\"H\"], y=case[\"y\"], R=case[\"R\"]\n        )\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice introduces the crucial dimension of time and explores the interplay between the forecast model and the data assimilation system. You will investigate how the model's coupling frequency—the rate at which different Earth system components exchange information, parameterized by $\\Delta t_c$—influences the background state forecast and, in turn, the resulting analysis. This exercise demonstrates that the effectiveness of coupled data assimilation depends not only on the assimilation algorithm but also on the physical fidelity of the underlying coupled model.",
            "id": "3872554",
            "problem": "Consider a two-component linear coupled system representing a single atmospheric scalar state and a single oceanic scalar state. Let the atmospheric state be denoted by $x_{a}(t)$ and the oceanic state by $x_{o}(t)$. Between coupling exchanges, each component evolves independently according to linear relaxation toward zero:\n$$\\frac{d x_{a}}{dt} = -\\lambda_{a}\\, x_{a}, \\qquad \\frac{d x_{o}}{dt} = -\\lambda_{o}\\, x_{o},$$\nwith known relaxation rates $\\lambda_{a} = 0.1\\,\\mathrm{h}^{-1}$ and $\\lambda_{o} = 0.02\\,\\mathrm{h}^{-1}$. At discrete exchange times $t_{k} = k\\,\\Delta t_{c}$, coupling acts instantaneously as a linear relaxation of each component toward the other, with known exchange coefficients $\\gamma_{ao} = 0.3$ and $\\gamma_{oa} = 0.1$:\n$$x_{a}(t_{k}^{+}) = x_{a}(t_{k}^{-}) + \\gamma_{ao}\\,\\big(x_{o}(t_{k}^{-}) - x_{a}(t_{k}^{-})\\big),$$\n$$x_{o}(t_{k}^{+}) = x_{o}(t_{k}^{-}) + \\gamma_{oa}\\,\\big(x_{a}(t_{k}^{-}) - x_{o}(t_{k}^{-})\\big),$$\nwhere $t_{k}^{-}$ and $t_{k}^{+}$ denote the instants immediately before and after the exchange, respectively. Assume no model noise and take the initial condition at $t=0$ as $x_{a}(0) = 2\\,\\mathrm{K}$ and $x_{o}(0) = -1\\,\\mathrm{K}$.\n\nAt the assimilation time $T = 4\\,\\mathrm{h}$, a single scalar observation of the atmospheric state $y$ is available, with $y = 0.5\\,\\mathrm{K}$. Use a classic Kalman Filter (KF) analysis at $t=T$ with a scalar background error variance for the atmospheric state $B_{a}(T) = 1.0\\,\\mathrm{K}^{2}$ and a scalar observation error variance $R = 0.25\\,\\mathrm{K}^{2}$. The analysis increment is defined as the difference between the analysis and the background atmospheric state at $T$, i.e., $I(\\Delta t_{c}) = x_{a}^{a}(T) - x_{a}^{b}(T)$.\n\nCompute the difference in atmospheric analysis increments between two coupling exchange intervals:\n- Case $1$: $\\Delta t_{c} = 1\\,\\mathrm{h}$.\n- Case $2$: $\\Delta t_{c} = 4\\,\\mathrm{h}$.\n\nThat is, compute $\\Delta I = I(1\\,\\mathrm{h}) - I(4\\,\\mathrm{h})$. Round your final answer to four significant figures and express it in $\\mathrm{K}$.",
            "solution": "The system is linear and time-invariant in each interval between exchanges. For $t \\in (t_{k-1}, t_{k})$ (no exchange), the exact solutions are exponential decays:\n$$x_{a}(t_{k}^{-}) = \\exp(-\\lambda_{a}\\,\\Delta t_{c})\\,x_{a}(t_{k-1}^{+}), \\qquad x_{o}(t_{k}^{-}) = \\exp(-\\lambda_{o}\\,\\Delta t_{c})\\,x_{o}(t_{k-1}^{+}).$$\nAt each exchange time $t_{k}$, the instantaneous coupling is a linear relaxation:\n$$\\begin{pmatrix} x_{a}(t_{k}^{+}) \\\\ x_{o}(t_{k}^{+}) \\end{pmatrix} = \\begin{pmatrix} 1 - \\gamma_{ao}  \\gamma_{ao} \\\\ \\gamma_{oa}  1 - \\gamma_{oa} \\end{pmatrix} \\begin{pmatrix} x_{a}(t_{k}^{-}) \\\\ x_{o}(t_{k}^{-}) \\end{pmatrix}.$$\nCombining the between-exchange decay and at-exchange mixing into a single step from $t_{k-1}^{+}$ to $t_{k}^{+}$ yields\n$$\\begin{pmatrix} x_{a}(t_{k}^{+}) \\\\ x_{o}(t_{k}^{+}) \\end{pmatrix} = \\underbrace{\\begin{pmatrix} 1 - \\gamma_{ao}  \\gamma_{ao} \\\\ \\gamma_{oa}  1 - \\gamma_{oa} \\end{pmatrix}}_{\\mathbf{M}} \\underbrace{\\begin{pmatrix} \\exp(-\\lambda_{a}\\,\\Delta t_{c})  0 \\\\ 0  \\exp(-\\lambda_{o}\\,\\Delta t_{c}) \\end{pmatrix}}_{\\mathbf{D}(\\Delta t_{c})} \\begin{pmatrix} x_{a}(t_{k-1}^{+}) \\\\ x_{o}(t_{k-1}^{+}) \\end{pmatrix}.$$\nThus for $n = T / \\Delta t_{c}$ exchanges up to $T$, the state just after the exchange at $T$ is\n$$\\begin{pmatrix} x_{a}(T) \\\\ x_{o}(T) \\end{pmatrix} = \\big(\\mathbf{M}\\,\\mathbf{D}(\\Delta t_{c})\\big)^{n} \\begin{pmatrix} x_{a}(0) \\\\ x_{o}(0) \\end{pmatrix}.$$\nSince we perform the analysis at $t=T$, the background state is $x_{a}^{b}(T) = x_{a}(T)$ from the above.\n\nFor the Kalman Filter (KF) with a scalar observation operator $H=1$ and scalar background and observation error variances $B_{a}(T)$ and $R$, the scalar Kalman gain is\n$$K = \\frac{B_{a}(T)}{B_{a}(T) + R}.$$\nThe analysis update is\n$$x_{a}^{a}(T) = x_{a}^{b}(T) + K \\big(y - x_{a}^{b}(T)\\big),$$\nso the analysis increment is\n$$I(\\Delta t_{c}) = x_{a}^{a}(T) - x_{a}^{b}(T) = K \\big(y - x_{a}^{b}(T)\\big).$$\nTherefore the requested difference is\n$$\\Delta I = I(1\\,\\mathrm{h}) - I(4\\,\\mathrm{h}) = K \\Big(\\big(y - x_{a}^{b}(T;\\Delta t_{c}=1\\,\\mathrm{h})\\big) - \\big(y - x_{a}^{b}(T;\\Delta t_{c}=4\\,\\mathrm{h})\\big)\\Big) = K \\big(x_{a}^{b}(T;\\Delta t_{c}=4\\,\\mathrm{h}) - x_{a}^{b}(T;\\Delta t_{c}=1\\,\\mathrm{h})\\big).$$\n\nWe now compute $x_{a}^{b}(T)$ for each coupling interval. The fixed matrices are\n$$\\mathbf{M} = \\begin{pmatrix} 1 - \\gamma_{ao}  \\gamma_{ao} \\\\ \\gamma_{oa}  1 - \\gamma_{oa} \\end{pmatrix} = \\begin{pmatrix} 0.7  0.3 \\\\ 0.1  0.9 \\end{pmatrix}.$$\n\nCase $2$: $\\Delta t_{c} = 4\\,\\mathrm{h}$, so $n=1$. Then\n$$\\mathbf{D}(4\\,\\mathrm{h}) = \\begin{pmatrix} \\exp(-\\lambda_{a}\\cdot 4)  0 \\\\ 0  \\exp(-\\lambda_{o}\\cdot 4) \\end{pmatrix} = \\begin{pmatrix} \\exp(-0.4)  0 \\\\ 0  \\exp(-0.08) \\end{pmatrix}.$$\nNumerically,\n$$\\exp(-0.4) \\approx 0.6703200460,\\qquad \\exp(-0.08) \\approx 0.9231163464.$$\nThus\n$$\\mathbf{A}_{2} \\equiv \\mathbf{M} \\mathbf{D}(4\\,\\mathrm{h}) = \\begin{pmatrix} 0.4692240322  0.2769349040 \\\\ 0.0670320046  0.8308047118 \\end{pmatrix}.$$\nWith the initial state $\\begin{pmatrix} x_{a}(0) \\\\ x_{o}(0) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$, we find\n$$\\begin{pmatrix} x_{a}^{b}(T;4\\,\\mathrm{h}) \\\\ x_{o}^{b}(T;4\\,\\mathrm{h}) \\end{pmatrix} = \\mathbf{A}_{2} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0.6615131604 \\\\ -0.6967407026 \\end{pmatrix},$$\nso $x_{a}^{b}(T;4\\,\\mathrm{h}) \\approx 0.6615131604$.\n\nCase $1$: $\\Delta t_{c} = 1\\,\\mathrm{h}$, so $n=4$. Then\n$$\\mathbf{D}(1\\,\\mathrm{h}) = \\begin{pmatrix} \\exp(-\\lambda_{a}\\cdot 1)  0 \\\\ 0  \\exp(-\\lambda_{o}\\cdot 1) \\end{pmatrix} = \\begin{pmatrix} \\exp(-0.1)  0 \\\\ 0  \\exp(-0.02) \\end{pmatrix},$$\nwith\n$$\\exp(-0.1) \\approx 0.9048374180,\\qquad \\exp(-0.02) \\approx 0.9801986733.$$\nThus\n$$\\mathbf{A}_{1} \\equiv \\mathbf{M} \\mathbf{D}(1\\,\\mathrm{h}) = \\begin{pmatrix} 0.6333861926  0.2940596020 \\\\ 0.0904837418  0.8821788060 \\end{pmatrix}.$$\nWe compute $\\mathbf{A}_{1}^{2}$ and $\\mathbf{A}_{1}^{4}$:\n$$\\mathbf{A}_{1}^{2} \\approx \\begin{pmatrix} 0.4277871291  0.4456664796 \\\\ 0.1371341420  0.8048471000 \\end{pmatrix}, \\qquad \\mathbf{A}_{1}^{4} = \\mathbf{A}_{1}^{2}\\,\\mathbf{A}_{1}^{2} \\approx \\begin{pmatrix} 0.2441218000  0.5493439000 \\\\ 0.1690340000  0.7088988000 \\end{pmatrix}.$$\nApplying to the initial state,\n$$\\begin{pmatrix} x_{a}^{b}(T;1\\,\\mathrm{h}) \\\\ x_{o}^{b}(T;1\\,\\mathrm{h}) \\end{pmatrix} = \\mathbf{A}_{1}^{4} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} \\approx \\begin{pmatrix} -0.0611003000 \\\\ -0.3708308000 \\end{pmatrix},$$\nso $x_{a}^{b}(T;1\\,\\mathrm{h}) \\approx -0.0611003000$.\n\nThe scalar Kalman gain, using $B_{a}(T)=1.0$ and $R=0.25$, is\n$$K = \\frac{B_{a}(T)}{B_{a}(T) + R} = \\frac{1.0}{1.0 + 0.25} = 0.8.$$\nThe analysis increments are\n$$I(1\\,\\mathrm{h}) = K \\big(y - x_{a}^{b}(T;1\\,\\mathrm{h})\\big) = 0.8 \\big(0.5 - (-0.0611003000)\\big) \\approx 0.4488802400,$$\n$$I(4\\,\\mathrm{h}) = K \\big(y - x_{a}^{b}(T;4\\,\\mathrm{h})\\big) = 0.8 \\big(0.5 - 0.6615131604\\big) \\approx -0.1292105283.$$\nTherefore the requested difference is\n$$\\Delta I = I(1\\,\\mathrm{h}) - I(4\\,\\mathrm{h}) \\approx 0.4488802400 - (-0.1292105283) \\approx 0.5780907683.$$\nRounded to four significant figures and expressed in $\\mathrm{K}$, the result is $0.5781\\,\\mathrm{K}$.",
            "answer": "$$\\boxed{0.5781}$$"
        }
    ]
}