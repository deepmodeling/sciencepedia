{
    "hands_on_practices": [
        {
            "introduction": "要理解反馈机制，最基本的问题是：反馈如何决定气候变化的最终幅度？本练习使用一个简单的能量平衡模型，引入了关键的气候反馈参数 $\\lambda$。通过计算给定辐射强迫下的平衡变暖，并分析变暖对 $\\lambda$ 的敏感性，您将对反馈在放大或抑制气候响应中的作用建立起核心直觉。",
            "id": "3879458",
            "problem": "为气候系统对辐射强迫的平衡温度响应，构建了一个大气层顶（TOA）能量平衡模型。基本出发点是大气层顶的能量守恒：净辐射不平衡量 $N$ 满足 $N = F + R(T)$，其中 $F$ 是外部施加的辐射强迫，$R(T)$ 是气候系统的辐射响应。围绕一个参考气候状态，假设辐射响应可以线性化为 $R(T) \\approx -\\lambda \\,\\Delta T$，其中 $\\Delta T$ 是全球平均地表温度的变化，$\\lambda$ 是净气候反馈参数，定义为由不同物理过程产生的部分反馈之和。\n\n考虑一个二氧化碳倍增强迫，其量值为 $F_2 = 3.7\\,\\mathrm{W\\,m^{-2}}$。净反馈参数是以下分量的总和（单位均为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）：\n- 普朗克（热）反馈：$\\lambda_{\\mathrm{P}} = 3.3$，\n- 水汽加直减率反馈：$\\lambda_{\\mathrm{wv+lr}} = -1.2$，\n- 云反馈：$\\lambda_{\\mathrm{cld}} = -0.4$，\n- 冰-反照率反馈：$\\lambda_{\\mathrm{ia}} = -0.1$。\n\n仅使用TOA能量平衡和线性化辐射响应，首先确定给定 $F_2$ 和净 $\\lambda$ 下的平衡增温 $\\Delta T$，并定性分析 $\\lambda$ 的符号和大小如何控制平衡解的存在和大小。然后，为量化平衡增温对反馈强度的敏感性，在保持 $F_2$ 固定的情况下，计算在已计算出的净 $\\lambda$ 处的局地导数 $\\partial \\Delta T / \\partial \\lambda$。\n\n报告在给定参数值下计算出的 $\\partial \\Delta T / \\partial \\lambda$ 的数值。以开尔文每 $\\left(\\mathrm{W\\,m^{-2}\\,K^{-1}}\\right)$ 为单位表示该敏感度。将您的答案四舍五入到三位有效数字。",
            "solution": "问题陈述被认为是有效的，因为它科学地基于气候建模的原理，问题设定良好，有明确的目标和足够的数据，并且没有任何列出的使其无效的缺陷。\n\n分析始于大气层顶（TOA）平衡状态下的基本能量平衡方程。净辐射不平衡量 $N$ 必须为零。提供的模型是 $N = F + R(T)$，其中 $F$ 是辐射强迫，$R(T)$ 是辐射响应。在平衡状态下：\n$$N = F + R(T) = 0$$\n辐射响应被线性化为 $R(T) \\approx -\\lambda \\Delta T$，其中 $\\Delta T$ 是全球平均地表温度的变化，$\\lambda$ 是净气候反馈参数。将此代入平衡方程得到：\n$$F - \\lambda \\Delta T = 0$$\n解出平衡增温 $\\Delta T$ 得：\n$$\\Delta T = \\frac{F}{\\lambda}$$\n净气候反馈参数 $\\lambda$ 由其组成部分之和给出：\n$$\\lambda = \\lambda_{\\mathrm{P}} + \\lambda_{\\mathrm{wv+lr}} + \\lambda_{\\mathrm{cld}} + \\lambda_{\\mathrm{ia}}$$\n问题提供了以下强迫和反馈分量的值，反馈的单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，强迫的单位为 $\\mathrm{W\\,m^{-2}}$：\n- 二氧化碳倍增强迫：$F_2 = 3.7$\n- 普朗克反馈：$\\lambda_{\\mathrm{P}} = 3.3$\n- 水汽加直减率反馈：$\\lambda_{\\mathrm{wv+lr}} = -1.2$\n- 云反馈：$\\lambda_{\\mathrm{cld}} = -0.4$\n- 冰-反照率反馈：$\\lambda_{\\mathrm{ia}} = -0.1$\n\n首先，我们计算净反馈参数 $\\lambda$ 的数值：\n$$\\lambda = 3.3 + (-1.2) + (-0.4) + (-0.1) = 3.3 - 1.7 = 1.6 \\, \\mathrm{W\\,m^{-2}\\,K^{-1}}$$\n$\\lambda$ 的符号决定了气候系统的稳定性。为了在正强迫（$F  0$）下存在稳定的平衡，增温也必须是正的（$\\Delta T  0$）。从方程 $\\Delta T = F/\\lambda$ 可知，这要求 $\\lambda  0$。一个正的 $\\lambda$ 表示所有反馈过程的净效应是稳定的（即一个负反馈回路）。在这种情况下，强烈的稳定化普朗克反馈（$\\lambda_{\\mathrm{P}} = 3.3$）超过了非稳定化反馈的总和（$\\lambda_{\\mathrm{wv+lr}} + \\lambda_{\\mathrm{cld}} + \\lambda_{\\mathrm{ia}} = -1.7$），导致净 $\\lambda$ 为正。如果 $\\lambda$ 为零或负，系统将表现出失控的增温或不稳定性。\n\n$\\lambda$ 的大小控制着增温的幅度。$\\lambda$ 值越大，意味着气候系统的稳定化响应越强，导致在给定强迫下平衡温度变化越小。相反，一个较小的正 $\\lambda$ 会导致更大的增温，这表征了一个具有更高气候敏感性的系统。\n\n使用计算出的 $\\lambda$ 值和给定的强迫 $F_2$，我们可以确定平衡增温：\n$$\\Delta T = \\frac{F_2}{\\lambda} = \\frac{3.7}{1.6} = 2.3125 \\, \\mathrm{K}$$\n\n接下来，我们量化平衡增温 $\\Delta T$ 对净反馈参数 $\\lambda$ 的敏感性。我们在保持强迫 $F$ 不变的情况下，计算 $\\Delta T$ 相对于 $\\lambda$ 的偏导数。从 $\\Delta T$ 的表达式开始：\n$$\\Delta T = F \\lambda^{-1}$$\n我们对 $\\lambda$ 求导：\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda}(F \\lambda^{-1})$$\n应用幂函数求导法则 ($d(x^n)/dx = nx^{n-1}$)，我们得到：\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = F(-1)\\lambda^{-2} = -\\frac{F}{\\lambda^2}$$\n负号表示净反馈参数 $\\lambda$ 的增加（更强的稳定化）会导致平衡增温 $\\Delta T$ 的减少，这与我们的定性分析一致。\n\n最后，我们代入强迫 $F_2$ 和净反馈参数 $\\lambda$ 的数值来计算该敏感度的值：\n$$F = F_2 = 3.7 \\, \\mathrm{W\\,m^{-2}}$$\n$$\\lambda = 1.6 \\, \\mathrm{W\\,m^{-2}\\,K^{-1}}$$\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = -\\frac{3.7}{(1.6)^2} = -\\frac{3.7}{2.56} \\approx -1.4453125 \\, \\mathrm{K} / (\\mathrm{W\\,m^{-2}\\,K^{-1}})$$\n问题要求答案四舍五入到三位有效数字。\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} \\approx -1.45 \\, \\mathrm{K} / (\\mathrm{W\\,m^{-2}\\,K^{-1}})$$\n这个值代表了净气候反馈参数每增加一个单位，平衡增温减少的速率。",
            "answer": "$$\\boxed{-1.45}$$"
        },
        {
            "introduction": "平衡态只是故事的一部分，达到平衡的过程同样重要。本练习使用一个动态能量平衡模型，探讨气候系统的瞬态（随时间变化的）行为。您将推导出温度随时间变化的轨迹，并发现系统时间常数 $\\tau$ 的重要性，它将热惯量与反馈强度联系起来，决定了气候变化的速度。",
            "id": "3879366",
            "problem": "考虑一个全球平均的单层能量平衡模型（EBM），其中的预报变量是全球平均地表温度异常 $T(t)$，单位为开尔文。该层的能量守恒由下式表示\n$$\nC \\frac{dT}{dt} = F(t) - \\lambda T,\n$$\n其中 $C$ 是耦合地表层（海洋混合层加陆地）的有效热容，$F(t)$ 是外部施加的辐射强迫，单位为瓦特每平方米，$\\lambda$ 是净气候反馈参数，单位为瓦特每平方米每开尔文。函数 $F(t)$ 是一个幅度为 $F_00$ 的阶跃强迫，因此 $F(t)=F_0 H(t)$，其中 $H(t)$ 是 Heaviside 阶跃函数，定义为当 $t0$ 时 $H(t)=0$，当 $t\\ge 0$ 时 $H(t)=1$。假设系统在 $t0$ 时最初处于平衡状态，此时 $F(t)=0$ 且 $T(t)=0$，并且 $C0$ 和 $\\lambda \\neq 0$ 不随时间变化。\n\n推导所有时间 $t$ 的瞬态响应 $T(t)$，并用 $F_0$、$C$、$\\lambda$、$t$ 和 $H(t)$ 将其表示为单个闭式解析表达式。将 $T(t)$ 以开尔文为单位表示。此外，从能量守恒和上述定义出发，用文字解释时间常数 $\\tau=C/\\lambda$ 在此线性模型中如何表征反馈的强度和符号（区分 $\\lambda0$ 时的负反馈和 $\\lambda0$ 时的正反馈），包括其对稳定性和趋于平衡的影响。\n\n你的最终答案必须仅为 $T(t)$ 的单个解析表达式；任何关于反馈机制的讨论都应出现在你的推导过程中。不需要进行数值近似或四舍五入。",
            "solution": "该问题是有效的。它提出了一个标准的、适定的、表示简化能量平衡模型的一阶线性常微分方程，所有必要的参数和初始条件都已明确定义。其物理和数学设置是合理且自洽的。\n\n全球平均地表温度异常 $T(t)$ 的控制方程由能量守恒原理给出：\n$$\nC \\frac{dT}{dt} = F(t) - \\lambda T\n$$\n其中 $C  0$ 是有效热容，$F(t)$ 是外部辐射强迫，$\\lambda \\neq 0$ 是净气候反馈参数。强迫是一个阶跃函数，$F(t) = F_0 H(t)$，其中 $F_0  0$，$H(t)$ 是 Heaviside 阶跃函数。初始条件为当 $t  0$ 时 $T(t)=0$，这意味着在 $t=0$ 处连续，因此 $T(0)=0$。\n\n该方程可以改写为一阶线性常微分方程的标准形式 $\\frac{dT}{dt} + p(t)T = q(t)$：\n$$\n\\frac{dT}{dt} + \\frac{\\lambda}{C} T = \\frac{F(t)}{C}\n$$\n对于 $t  0$，我们有 $F(t)=0$ 且给定 $T(t)=0$。这是方程 $\\frac{dT}{dt} + \\frac{\\lambda}{C} T = 0$ 的平凡平衡解。\n\n对于 $t \\ge 0$，强迫是常数 $F(t)=F_0$，方程变为：\n$$\n\\frac{dT}{dt} + \\frac{\\lambda}{C} T = \\frac{F_0}{C}\n$$\n这是一个常系数非齐次方程。我们使用积分因子 $I(t)$ 来求解：\n$$\nI(t) = \\exp\\left(\\int \\frac{\\lambda}{C} dt\\right) = \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\n将微分方程两边乘以 $I(t)$ 得到：\n$$\n\\exp\\left(\\frac{\\lambda}{C}t\\right) \\frac{dT}{dt} + \\frac{\\lambda}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right) T = \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\n左边是乘积法则求导的结果，即 $\\frac{d}{dt}\\left(T(t)I(t)\\right)$：\n$$\n\\frac{d}{dt}\\left(T(t) \\exp\\left(\\frac{\\lambda}{C}t\\right)\\right) = \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\n将两边关于 $t$ 从 $0$ 到 $t$ 积分：\n$$\n\\int_0^t \\frac{d}{dt'}\\left(T(t') \\exp\\left(\\frac{\\lambda}{C}t'\\right)\\right) dt' = \\int_0^t \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t'\\right) dt'\n$$\n$$\n\\left[ T(t') \\exp\\left(\\frac{\\lambda}{C}t'\\right) \\right]_0^t = \\frac{F_0}{C} \\left[ \\frac{C}{\\lambda} \\exp\\left(\\frac{\\lambda}{C}t'\\right) \\right]_0^t\n$$\n$$\nT(t) \\exp\\left(\\frac{\\lambda}{C}t\\right) - T(0) \\exp(0) = \\frac{F_0}{\\lambda} \\left( \\exp\\left(\\frac{\\lambda}{C}t\\right) - \\exp(0) \\right)\n$$\n使用初始条件 $T(0)=0$：\n$$\nT(t) \\exp\\left(\\frac{\\lambda}{C}t\\right) = \\frac{F_0}{\\lambda} \\left( \\exp\\left(\\frac{\\lambda}{C}t\\right) - 1 \\right)\n$$\n两边乘以 $\\exp\\left(-\\frac{\\lambda}{C}t\\right)$ 来求解 $T(t)$：\n$$\nT(t) = \\frac{F_0}{\\lambda} \\left( 1 - \\exp\\left(-\\frac{\\lambda}{C}t\\right) \\right)\n$$\n该解在 $t \\ge 0$ 时有效。为了将所有时间 $t$ 的解表示为单个闭式表达式，我们使用 Heaviside 函数 $H(t)$。由于推导出的表达式在 $t=0$ 时为 $0$，并且给定解在 $t0$ 时为 $0$，我们可以写出：\n$$\nT(t) = \\frac{F_0}{\\lambda} \\left( 1 - \\exp\\left(-\\frac{\\lambda}{C}t\\right) \\right) H(t)\n$$\n\n现在，我们来解释反馈和时间常数 $\\tau = C/\\lambda$ 的作用。控制方程 $C \\frac{dT}{dt} = F(t) - \\lambda T$ 表明，系统能量存储的变化率等于来自外部强迫 $F(t)$ 的输入能量减去因气候响应 $-\\lambda T$ 而离开系统的能量。项 $-\\lambda T$ 是净反馈。\n\n情况1：负反馈 ($\\lambda  0$)。\n如果 $\\lambda$ 为正，一个正的温度异常（$T0$）会导致一个负反馈项（$-\\lambda T  0$），表示出射辐射增加，从而抵消了初始增温。这是一个稳定机制。时间常数 $\\tau = C/\\lambda$ 是正的。对于 $t \\ge 0$ 的解是 $T(t) = \\frac{F_0}{\\lambda} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)$。当 $t \\to \\infty$ 时，指数项衰减到 $0$，温度趋于一个新的稳定平衡态 $T_{eq} = \\frac{F_0}{\\lambda}$。时间常数 $\\tau$ 是 e-折叠时间；它是指温度完成其向新平衡态变化的约 $1 - 1/e \\approx 63\\%$ 所需的时间。一个更大的 $\\lambda$（更强的负反馈）会导致更小的平衡温度变化 $T_{eq}$ 和更快的响应（更小的 $\\tau$）。\n\n情况2：正反馈 ($\\lambda  0$)。\n如果 $\\lambda$ 为负，一个正的温度异常（$T0$）会导致一个正反馈项（$-\\lambda T  0$），表示出射辐射减少（或吸收能量增加），从而放大了初始增温。这是一个不稳定机制。令 $\\lambda = -|\\lambda|$。时间常数 $\\tau = C/\\lambda = -C/|\\lambda|$ 是负的。对于 $t \\ge 0$ 的解变为：\n$$\nT(t) = \\frac{F_0}{-|\\lambda|} \\left(1 - \\exp\\left(-\\frac{-|\\lambda|}{C}t\\right)\\right) = \\frac{F_0}{|\\lambda|} \\left(\\exp\\left(\\frac{|\\lambda|}{C}t\\right) - 1\\right)\n$$\n在这种情况下，对于任何 $F_0  0$，温度 $T(t)$ 都会无界地指数增长。系统是不稳定的，不会趋于平衡。这通常被称为“失控”气候情景。量 $|\\tau| = C/|\\lambda|$ 代表了这种指数发散的特征时间尺度。一个更大的 $|\\lambda|$（更强的正反馈）会导致更快速、灾难性的增温（更小的 $|\\tau|$ 和更快的指数增长）。\n\n总而言之，时间常数 $\\tau=C/\\lambda$ 表征了系统的基本行为。它的符号由 $\\lambda$ 决定，并决定了系统的稳定性：一个正的 $\\tau$ 意味着系统是稳定的并趋于平衡，而一个负的 $\\tau$ 意味着系统是不稳定的、失控的。它的大小 $|\\tau|=C/|\\lambda|$ 代表了系统响应的特征时间尺度，该尺度与热惯量 $C$ 成正比，与净反馈强度的大小 $|\\lambda|$ 成反比。",
            "answer": "$$\n\\boxed{\\frac{F_0}{\\lambda} \\left(1 - \\exp\\left(-\\frac{\\lambda t}{C}\\right)\\right) H(t)}\n$$"
        },
        {
            "introduction": "现实世界中的反馈通常是非线性的，并且在复杂系统内相互作用。最后一个练习将从解析解转向计算建模，使用一个更复杂的双箱海洋模型来模拟著名的冰-反照率正反馈。通过编写程序比较包含与不包含此反馈的情景，您将亲手量化其对全球变暖的放大效应，体验气候科学家的核心研究方法。",
            "id": "3879409",
            "problem": "考虑一个全球双箱能量平衡模型（EBM），该模型由一个混合层海洋和一个深层海洋组成，受外部施加的辐射不平衡驱动。控制方程源自每个箱体的能量守恒。令 $T_m(t)$ 表示全球平均混合层温度异常（单位为 $\\mathrm{K}$），$T_d(t)$ 表示深海温度异常（单位为 $\\mathrm{K}$）。混合层和深海的单位面积热容量分别为 $C_m$ 和 $C_d$，单位为 $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$。大气-海洋热交换系数为 $\\kappa$，单位为 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$。净长波辐射响应通过有效气候反馈参数 $\\lambda$ 进行线性化，单位为 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$。外部施加的辐射强迫是一个线性斜坡函数 $F(t)$（单位为 $\\mathrm{W\\, m^{-2}}$），在 $T_{\\mathrm{end}}$（单位为年）的时间内从 $0$ 线性增加到 $F_{\\mathrm{end}}$，即对于 $t \\in [0, T_{\\mathrm{end}}]$，有 $F(t) = F_{\\mathrm{end}}\\, t / T_{\\mathrm{end}}$。行星平均入射短波辐射为 $S_0$（单位为 $\\mathrm{W\\, m^{-2}}$），基准反照率为 $\\alpha_0$。\n\n为表示冰-反照率反馈，假设行星反照率是一个随温度变化的函数 $\\alpha(T_m)$，它随 $T_m$ 的增加而减小，并在 $\\alpha_{\\min}$ 和 $\\alpha_{\\max}$ 之间饱和，由下式给出\n$$\n\\alpha(T_m) = \\min\\Big(\\alpha_{\\max}, \\max\\big(\\alpha_{\\min}, \\alpha_0 - s\\, T_m\\big)\\Big),\n$$\n其中 $s$（单位为 $\\mathrm{K^{-1}}$）是一个小的正斜率，控制反照率对混合层变暖的敏感度。相对于基准反照率变化导致的吸收短波辐射变化被建模为一个附加的反馈强迫\n$$\nF_{\\alpha}(T_m) = S_0\\big(\\alpha_0 - \\alpha(T_m)\\big),\n$$\n因此当 $\\alpha(T_m) \\le \\alpha_0$ 时，$F_{\\alpha}(T_m) \\ge 0$。\n\n在这些假设下，双箱 EBM 的演变遵循以下方程\n$$\n\\begin{aligned}\nC_m \\frac{dT_m}{dt} = F(t) + F_{\\alpha}(T_m) - \\lambda\\, T_m - \\kappa\\,(T_m - T_d),\\\\\nC_d \\frac{dT_d}{dt} = \\kappa\\,(T_m - T_d),\n\\end{aligned}\n$$\n初始条件为 $T_m(0) = 0$ 和 $T_d(0) = 0$。\n\n您的任务是量化在斜坡结束时（$t = T_{\\mathrm{end}}$），冰-反照率反馈对瞬态变暖的贡献。通过设置 $F_{\\alpha}(T_m) \\equiv 0$ 来定义无反馈的反事实情景。令 $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$ 和 $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$ 分别表示在 $t = T_{\\mathrm{end}}$ 时反馈开启和关闭时的混合层温度。量化两个指标：\n- 由冰-反照率反馈引起的可归因增温，\n$$\n\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}}),\n$$\n单位为 $\\mathrm{K}$。\n- 瞬态增温中可归因于冰-反照率反馈的部分，\n$$\n\\phi = \n\\begin{cases}\n\\Delta T \\big/ T_m^{\\mathrm{off}}(T_{\\mathrm{end}}),  \\text{if } T_m^{\\mathrm{off}}(T_{\\mathrm{end}})  0,\\\\\n0,  \\text{if } T_m^{\\mathrm{off}}(T_{\\mathrm{end}}) = 0,\n\\end{cases}\n$$\n以小数形式表示。\n\n采用 $S_0 = 340$ $\\mathrm{W\\, m^{-2}}$。时间单位为年，温度单位为 $\\mathrm{K}$，所有类通量参数的单位酌情使用 $\\mathrm{W\\, m^{-2}}$ 或 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$。对以下指定的每个测试用例，数值积分该系统以获得 $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$ 和 $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$。请使用精确的数值积分方法；不允许使用解析捷径。\n\n测试参数集，每个集以元组形式给出 $(F_{\\mathrm{end}}, T_{\\mathrm{end}}, s, \\alpha_{\\min}, \\alpha_{\\max}, \\alpha_0, \\lambda, \\kappa, C_m, C_d)$:\n- 用例 1（一般情况，中等反馈）：$(4, 100, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$。\n- 用例 2（边界情况，无反馈）：$(4, 100, 0.0000, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$。\n- 用例 3（边缘情况，零强迫）：$(0, 100, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$。\n- 用例 4（更强斜坡，更强但稳定的反馈）：$(8, 200, 0.0020, 0.20, 0.70, 0.30, 1.00, 0.80, 7.00, 100.00)$。\n\n您的程序必须输出单行结果，其中包含所有测试用例的结果，格式为方括号内的逗号分隔列表，顺序为 $[\\Delta T_1, \\phi_1, \\Delta T_2, \\phi_2, \\Delta T_3, \\phi_3, \\Delta T_4, \\phi_4]$。每个元素必须是浮点数（$\\Delta T_i$ 的单位为 $\\mathrm{K}$，$\\phi_i$ 为小数），不含额外文本。不需要用户输入；所有值均已在上方提供，且必须硬编码。数值积分必须足够精确，以捕捉指定时间范围内的动力学过程。",
            "solution": "用户提供了一个问题，要求通过数值求解一个双箱能量平衡模型（EBM），来量化冰-反照率反馈对瞬态全球变暖的影响。\n\n### 第 1 步：问题验证\n\n首先对问题陈述进行严格的验证过程。\n\n**1. 已知条件提取：**\n- **状态变量：** 混合层温度异常 $T_m(t)$ 和深海温度异常 $T_d(t)$，单位均为 $\\mathrm{K}$。\n- **物理常数：** 行星平均入射短波辐射 $S_0 = 340 \\mathrm{\\,W\\,m^{-2}}$。\n- **模型参数：** 混合层热容量 $C_m$ 和深海热容量 $C_d$ (单位为 $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$)，大气-海洋热交换系数 $\\kappa$ ($\\mathrm{W\\,m^{-2}\\,K^{-1}}$)，气候反馈参数 $\\lambda$ ($\\mathrm{W\\,m^{-2}\\,K^{-1}}$)，反照率敏感度 $s$ ($\\mathrm{K^{-1}}$)，以及反照率限制 $\\alpha_{\\min}$、$\\alpha_{\\max}$ 和基准值 $\\alpha_0$。\n- **强迫：** 一个线性斜坡强迫 $F(t) = F_{\\mathrm{end}}\\, t / T_{\\mathrm{end}}$，作用于区间 $t \\in [0, T_{\\mathrm{end}}]$。\n- **反馈公式：** 冰-反照率反馈被建模为一个附加强迫 $F_{\\alpha}(T_m) = S_0(\\alpha_0 - \\alpha(T_m))$，其中反照率 $\\alpha(T_m)$ 是 $T_m$ 的分段线性函数：$\\alpha(T_m) = \\min\\Big(\\alpha_{\\max}, \\max\\big(\\alpha_{\\min}, \\alpha_0 - s\\, T_m\\big)\\Big)$。\n- **控制方程：** 一个由两个耦合的一阶常微分方程（ODEs）组成的系统：\n$$\n\\begin{aligned}\nC_m \\frac{dT_m}{dt} = F(t) + F_{\\alpha}(T_m) - \\lambda\\, T_m - \\kappa\\,(T_m - T_d) \\\\\nC_d \\frac{dT_d}{dt} = \\kappa\\,(T_m - T_d)\n\\end{aligned}\n$$\n- **初始条件：** $T_m(0) = 0$ 和 $T_d(0) = 0$。\n- **目标：** 对于四个指定的参数集，计算可归因增温 $\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$ 和可归因增温分数 $\\phi = \\Delta T / T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$。上标 'on' 和 'off' 分别表示反照率反馈启用（$F_{\\alpha}(T_m)$ 按定义）和禁用（$F_{\\alpha}(T_m) \\equiv 0$）的模拟。\n\n**2. 验证结论：**\n- **科学依据：** 该问题描述了一个典型的双箱 EBM，这是气候科学中用于概念理解的标准工具。这些方程代表能量守恒。在此类模型的背景下，强迫和反馈的公式（包括非线性的冰-反照率反馈）在物理上和概念上都是合理的。指定的参数值在这些简化模型的合理范围内。热容量（$C_m, C_d$）的单位给出为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，但注明了是“以年为时间单位表示”。为了使 ODE 的量纲保持一致（其中时间 $t$ 的单位是年），这些参数必须解释为具有 $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$ 的单位，这是此类模型文献中的常见约定。在此标准解释下，该问题量纲一致且科学有效。\n- **良态性：** 该问题是良态的。带有给定初始条件的 ODE 系统有唯一解，因为 ODE 系统右侧是关于状态变量 $(T_m, T_d)$ 的连续且局部 Lipschitz 函数。\n- **完整性与一致性：** 该问题是自洽的，提供了所有必要的方程、参数、初始条件和数值任务。没有矛盾之处。\n- **结论：** 该问题被视为有效，可以构建解决方案。\n\n### 第 2 步：求解推导与算法设计\n\n问题的核心是求解一个初值问题系统。由于非线性“反馈开启”情况的解析解很复杂且被明确禁止，因此需要采用数值方法。\n\n**1. ODE 系统：**\n令系统状态由向量 $\\mathbf{y}(t) = [T_m(t), T_d(t)]^T$ 表示。控制方程可以重写为向量形式 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$:\n$$\n\\frac{d}{dt} \\begin{pmatrix} T_m \\\\ T_d \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{C_m} \\left[ F(t) + F_{\\alpha}(T_m) - (\\lambda + \\kappa)T_m + \\kappa T_d \\right] \\\\ \\frac{1}{C_d} \\left[ \\kappa T_m - \\kappa T_d \\right] \\end{pmatrix}\n$$\n初始条件为 $\\mathbf{y}(0) = [0, 0]^T$。\n\n**2. 数值积分：**\n该系统将使用高质量的数值 ODE 求解器进行求解。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是一个绝佳的选择。它提供了多种积分方法，包括像 Dormand-Prince 方法（RK45）这样的自适应步长算法，这些算法非常适合高效地实现高精度。\n\n**3. 实现策略：**\n总体算法如下：\n- 遍历提供的四个测试用例。\n- 对于每个测试用例：\n    a. 定义全套参数 $(F_{\\mathrm{end}}, T_{\\mathrm{end}}, s, \\dots, C_d)$。\n    b. **求解“反馈关闭”的情况：**\n       - 设置 ODE 系统函数，将反照率反馈项 $F_{\\alpha}(T_m)$ 强制为零。\n       - 使用 `solve_ivp` 对系统从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 进行数值积分。\n       - 提取最终的混合层温度 $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$。\n    c. **求解“反馈开启”的情况：**\n       - 设置 ODE 系统函数，启用完整的反照率反馈项 $F_{\\alpha}(T_m)$。$\\alpha(T_m)$ 的分段特性将使用裁剪函数（例如 `numpy.clip`）来实现。\n       - 对这个非线性系统从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 进行数值积分。\n       - 提取最终的混合层温度 $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$。\n    d. **计算指标：**\n       - 计算可归因增温：$\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$。\n       - 计算分数贡献 $\\phi$。需特别注意 $T_m^{\\mathrm{off}}(T_{\\mathrm{end}}) = 0$ 的情况，此时 $\\phi$ 定义为 $0$。否则，$\\phi = \\Delta T / T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$。\n- 收集所有测试用例计算出的 $(\\Delta T, \\phi)$ 对。\n- 按照问题陈述中的规定，将最终结果格式化为单个逗号分隔的字符串。\n\n此过程将封装在一个 Python 脚本中，严格遵守指定的执行环境和输出格式。在 ODE 求解器中使用高精度容差（例如，`rtol=1e-8`, `atol=1e-8`）确保了此科学计算所需的数值精度。提供的边缘用例（$s=0$ 的用例 2 和 $F_{\\mathrm{end}}=0$ 的用例 3）将作为实现的内部验证，因为它们预计会产生 $\\Delta T=0$ 和 $\\phi=0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the two-box EBM for given test cases and calculates feedback metrics.\n    \"\"\"\n    # Planetary mean incoming shortwave radiation (W m^-2)\n    S0 = 340.0\n\n    # Test suite parameter sets:\n    # (F_end, T_end, s, alpha_min, alpha_max, alpha_0, lambda, kappa, C_m, C_d)\n    test_cases = [\n        # Case 1 (general, moderate feedback)\n        (4.0, 100.0, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 2 (boundary, no feedback)\n        (4.0, 100.0, 0.0000, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 3 (edge, zero forcing)\n        (0.0, 100.0, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 4 (stronger ramp, stronger but stable feedback)\n        (8.0, 200.0, 0.0020, 0.20, 0.70, 0.30, 1.00, 0.80, 7.00, 100.00),\n    ]\n\n    def ebm_derivatives(t, y, params, feedback_on):\n        \"\"\"\n        Computes the time derivatives for the two-box EBM.\n        y: state vector [T_m, T_d]\n        t: time\n        params: tuple of model parameters\n        feedback_on: boolean to enable/disable ice-albedo feedback\n        \"\"\"\n        T_m, T_d = y\n        F_end, T_end, s, alpha_min, alpha_max, alpha_0, lam, kap, C_m, C_d = params\n\n        # External radiative forcing (linear ramp)\n        F_t = F_end * t / T_end\n\n        # Ice-albedo feedback forcing\n        if feedback_on:\n            # albedo is a function of T_m, clipped by min/max values\n            alpha_Tm = np.clip(alpha_0 - s * T_m, alpha_min, alpha_max)\n            F_alpha = S0 * (alpha_0 - alpha_Tm)\n        else:\n            F_alpha = 0.0\n\n        # System of ODEs from energy conservation\n        dTm_dt = (F_t + F_alpha - lam * T_m - kap * (T_m - T_d)) / C_m\n        dTd_dt = (kap * (T_m - T_d)) / C_d\n\n        return [dTm_dt, dTd_dt]\n\n    def run_simulation(params, feedback_on):\n        \"\"\"\n        Runs a single simulation for a given parameter set.\n        \"\"\"\n        _, T_end, _, _, _, _, _, _, _, _ = params\n        y0 = [0.0, 0.0]  # Initial conditions: T_m(0)=0, T_d(0)=0\n        t_span = [0, T_end]\n\n        sol = solve_ivp(\n            ebm_derivatives,\n            t_span,\n            y0,\n            args=(params, feedback_on),\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-8\n        )\n        \n        # Return the final mixed-layer temperature\n        return sol.y[0, -1]\n\n    results = []\n    for params in test_cases:\n        # Run simulation with feedback OFF\n        T_m_off = run_simulation(params, feedback_on=False)\n        \n        # Run simulation with feedback ON\n        T_m_on = run_simulation(params, feedback_on=True)\n        \n        # Calculate attributable warming\n        delta_T = T_m_on - T_m_off\n\n        # Calculate fraction of warming attributable to feedback\n        if T_m_off > 1e-12:  # Use a small threshold to avoid division by zero\n            phi = delta_T / T_m_off\n        else:\n            phi = 0.0\n            \n        results.extend([delta_T, phi])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}