## 引言
示踪剂守恒是环境与地球系统科学中的一块基石，为我们理解和预测物质（如污染物、养分、热量）在自然界中的迁移、转化和分布提供了根本框架。无论是追踪一条河流中的污染物，模拟大气中温室气体的全球输运，还是量化海洋对碳的吸收，其核心都离不开对物质质量收支的精确核算。然而，将这一简洁的物理定律应用于复杂的[地球系统模型](@entry_id:1124096)时，我们面临着一个关键挑战：如何确保在离散的数值世界中，物理守恒性得到忠实地维持。不守恒的算法会凭空创造或消灭物质，导致模拟结果与物理现实严重偏离。

本文旨在系统性地阐释示踪剂守恒的理论、实践与应用，帮助读者搭建从物理原理到数值模型实现的完整知识体系。在“**原理与机制**”一章中，我们将深入物理核心，推导控制[示踪剂输运](@entry_id:1133278)的基本方程，区分局部与全局守恒，并探讨在[数值离散化](@entry_id:752782)过程中确保守恒性的关键技术与挑战。接下来，在“**应用与交叉学科联系**”一章中，我们将展示这些原理如何在水文学、海洋与大气科学、[生物地球化学](@entry_id:152189)乃至生物医学等多个领域中，被用来解决真实的科学问题，揭示其强大的解释力和预测能力。最后，在“**动手实践**”一章中，你将通过一系列精心设计的练习，将理论知识应用于具体问题，从而加深对关键概念的理解。

## 原理与机制

在本章中，我们将深入探讨示踪剂守恒的物理原理及其数学表述。我们将从一个普遍的守恒定律出发，推导出控制示踪剂浓度演化的[偏微分](@entry_id:194612)方程。随后，我们将区分局部守恒与全局守恒，并阐明边界条件在其中的关键作用。我们还将定义被动示踪剂与主动示踪剂之间的动力学差异。最后，我们将讨论在将这些连续介质的原理转化为离散数值模型时所面临的挑战和实用技术，包括数值格式的内在属性及其对守恒性的影响。

### [示踪剂输运](@entry_id:1133278)的基本方程

环境与地球系统中的示踪剂，无论是溶解的化学物质、热量还是水汽，其时空分布都受制于一个普适的[守恒原理](@entry_id:1122907)。该原理指出，在一个固定的控制体积内，示踪剂总量的变化率等于通过该体积边界的净通量加上体积内部的源汇项之和。这是构建所有输运模型的基础。

让我们形式化这个概念。考虑一个标量示踪剂，其浓度场为 $c(\mathbf{x},t)$，单位为单位体积的质量（例如，$\mathrm{kg/m^3}$）。在一个固定的控制体积 $\mathcal{V}$（其边界为 $\partial\mathcal{V}$，外[法线](@entry_id:167651)[单位向量](@entry_id:165907)为 $\mathbf{n}$）内，示踪剂的总质量为 $\int_{\mathcal{V}} c \, dV$。其随时间的变化率由以下积分守恒定律描述 ：

$$
\frac{d}{dt} \int_{\mathcal{V}} c(\mathbf{x}, t) \, dV = - \oint_{\partial \mathcal{V}} \mathbf{J} \cdot \mathbf{n} \, dA + \int_{\mathcal{V}} S(\mathbf{x}, t) \, dV
$$

方程左侧是控制体积内示踪剂总质量的时间变化率。右侧包含两项：第一项是穿过边界 $\partial\mathcal{V}$ 的总通量 $\mathbf{J}$ 的面积分，负号表示流出体积的通量将导致内部质量减少；第二项是体积 $\mathcal{V}$ 内所有源（产生）和汇（消耗）过程的总和，由体积源汇率 $S(\mathbf{x}, t)$ 描述。

总通量 $\mathbf{J}$ 通常由两个主要过程构成：**平流输运**和**扩散输运**。
1.  **平流通量** ($\mathbf{J}_{\text{adv}}$)：由宏观流体运动（如风或洋流）携带示踪剂产生的输运。其表达式为 $\mathbf{J}_{\text{adv}} = \mathbf{u}c$，其中 $\mathbf{u}(\mathbf{x}, t)$ 是流体的速度场。
2.  **扩散通量** ($\mathbf{J}_{\text{diff}}$)：由分子随机运动或未被模型解析的次网格尺度[湍流](@entry_id:151300)涡旋引起的输运。这种输运通常导致示踪剂从高浓度区域向低浓度区域净迁移。一个广泛应用的本构关系是**菲克定律** (Fick's Law)，它假设扩散通量与浓度梯度成正比：$\mathbf{J}_{\text{diff}} = - \mathbf{K} \nabla c$。其中 $\mathbf{K}$ 是一个[对称正定](@entry_id:145886)（或半正定）的扩散系数张量，负号确保了通量指向浓度降低的方向 。

因此，总通量可以表示为 $\mathbf{J} = \mathbf{u}c - \mathbf{K}\nabla c$。将这个表达式代入积分守恒定律，我们得到：

$$
\frac{d}{dt}\int_{\mathcal{V}} c \, dV = -\oint_{\partial \mathcal{V}} (\mathbf{u}c - \mathbf{K}\nabla c)\cdot \mathbf{n} \, dS + \int_{\mathcal{V}} S \, dV
$$

虽然积分形式在概念上非常直观，但为了进行分析和数值求解，通常需要将其转化为局部（点态）的[偏微分](@entry_id:194612)方程形式。通过应用**[高斯散度定理](@entry_id:188065)**（将边界上的面积分转化为体积内的散度积分），并考虑到控制体积 $\mathcal{V}$ 是任意选取的，我们可以得到如下的局部守恒方程  ：

$$
\frac{\partial c}{\partial t} + \nabla \cdot (\mathbf{u}c - \mathbf{K}\nabla c) = S
$$

该方程，通常被称为**[平流-扩散-反应方程](@entry_id:156456)**，是示踪剂建模的基石。我们可以将其展开，以更清楚地理解各项的物理意义：

$$
\frac{\partial c}{\partial t} + \nabla \cdot (\mathbf{u}c) = \nabla \cdot (\mathbf{K}\nabla c) + S
$$

-   $\frac{\partial c}{\partial t}$：**局部趋势项**，表示在空间固定点上浓度的[瞬时变化率](@entry_id:141382)。
-   $\nabla \cdot (\mathbf{u}c)$：**平流辐散项**，表示由于流体运动导致的从一个无穷小体积中的净质量流出率。在流场是不可压缩的（即 $\nabla \cdot \mathbf{u} = 0$）特殊情况下，该项可以简化为 $\mathbf{u} \cdot \nabla c$。然而，在可压缩流中，必须使用 $\nabla \cdot (\mathbf{u}c)$ 这种[通量形式](@entry_id:273811)才能保证[质量守恒](@entry_id:204015)。
-   $\nabla \cdot (\mathbf{K}\nabla c)$：**扩散项**，描述了[扩散过程](@entry_id:268015)对浓度变化的贡献。它倾向于平滑浓度场中的梯度，使[局部极值](@entry_id:144991)衰减。
-   $S(c, \mathbf{x}, t)$：**源汇项**，代表所有不通过边界通量发生的示踪剂生成或消耗过程。例如，化学反应（如一阶衰变 $S = -\lambda c$）、生物吸收（如Michaelis-Menten动力学）或相变（如蒸发/凝结）都通过此项来描述 。正值 $S>0$ 代表源（净产生），负值 $S<0$ 代表汇（净消耗）。

### 全局守恒、边界条件与诊断

局部[守恒方程](@entry_id:1122898)描述了每一点的浓度变化，而**全局守恒**则关注整个模拟区域 $\Omega$ 内示踪剂的总量 $M(t) = \int_{\Omega} c \, dV$ 的演变。通过对局部守恒方程在整个区域 $\Omega$ 上进行积分，我们可以得到全局预算方程 ：

$$
\frac{dM}{dt} = \frac{d}{dt}\int_{\Omega} c \, dV = \int_{\Omega} S \, dV - \oint_{\partial\Omega} (\mathbf{u}c - \mathbf{K}\nabla c) \cdot \mathbf{n} \, dS
$$

这个方程明确指出，区域内示踪剂总量的变化仅由两个因素决定：区域内所有源和汇的总和，以及穿过区域边界 $\partial\Omega$ 的净通量。

由此可见，为了使一个系统的总质量守恒（即 $\frac{dM}{dt} = 0$），必须满足两个条件 ：
1.  **无内部净源汇**：$\int_{\Omega} S \, dV = 0$。最简单的情况是 $S=0$ 处处成立。
2.  **无边界净通量**：$\oint_{\partial\Omega} \mathbf{J} \cdot \mathbf{n} \, dS = 0$。一个常见的严格条件是**零[通量边界条件](@entry_id:749481)**，即在边界上处处有 $(\mathbf{u}c - \mathbf{K}\nabla c) \cdot \mathbf{n} = 0$。

在实际建模中，边界条件的确切形式至关重要。例如，**诺伊曼 (Neumann) 边界条件**直接指定边界上的法向扩散通量 。如果我们规定边界上的向外扩散通量为 $q(\mathbf{x}, t)$，则边界条件写作：

$$
-K\nabla c \cdot \mathbf{n} = q(\mathbf{x}, t) \quad \text{for } \mathbf{x} \in \partial\Omega
$$

根据这个定义，$q>0$ 表示示踪剂通过扩散流出区域。此时，全局预算方程中的扩散通量项 $\oint_{\partial\Omega} (-K\nabla c) \cdot \mathbf{n} \, dS$ 就被 $\oint_{\partial\Omega} q \, dS$ 所替代。

在复杂的[地球系统模型](@entry_id:1124096)中，验证这些守恒定律是否被准确执行是一项核心任务。模型开发者和使用者会实施**全局预算诊断** 。通过在每个时间步分别计算总质量的变化率、总源汇项以及总边界通量，可以验证数值解是否满足离散化的全局[守恒方程](@entry_id:1122898)。任何显著的偏差（即“收支不平衡”或残差）都可能指向数值方案中的错误或非守恒的实现。

### 被动示踪剂与主动示踪剂

示踪剂根据其是否影响[流体动力](@entry_id:750449)学而被分为两类 ：

-   **被动示踪剂 (Passive Tracer)**：是一种其浓度场 $c$ 不会反作用于决定流场 $\mathbf{u}$ 的动力学方程（如动量方程）的物质。换句话说，流场 $\mathbf{u}$ 的求解可以完全独立于示踪剂浓度 $c$。示踪剂仅仅被给定的流场所“携带”和扩散。例如，在空气中低浓度扩散的染料或非[浮力](@entry_id:154088)污染物。它们的[输运方程](@entry_id:174281)是一个可以独立求解的线性（或[非线性](@entry_id:637147)，如果 $S$ 或 $K$ 依赖于 $c$）[偏微分](@entry_id:194612)方程。

-   **主动示踪剂 (Active Tracer)**：其浓度场 $c$ 会通过改变流体属性（最常见的是密度）来影响流场 $\mathbf{u}$。例如，海洋中的**温度**和**盐度**是典型的主动示踪剂。它们通过[状态方程](@entry_id:274378)影响海水密度，进而改变[浮力](@entry_id:154088)，从而直接影响控制[海洋环流](@entry_id:195237)的动量方程。这种情况下，[示踪剂输运](@entry_id:1133278)方程和流体[动力学方程](@entry_id:751029)是**[双向耦合](@entry_id:178809)**的，必须联立求解，这极大地增加了问题的复杂性。

本课程主要关注被动示踪剂的守恒原理，但这些原理同样是理解主动[示踪剂输运](@entry_id:1133278)的基础。

### [数值守恒](@entry_id:175179)性与实现挑战

将连续的守恒定律转化为计算机可以求解的离散算法时，会引入新的挑战。一个理想的数值方案应该在离散层面上也保持物理守恒性。

**[有限体积法](@entry_id:141374) (Finite Volume Method, FVM)** 是一种为求解守恒定律而生的数值方法。其核心思想是将求解域划分为一系列不重叠的控制体积（或网格单元），并在每个单元上应用积分形式的守恒定律 。对于单元 $i$，其[离散守恒](@entry_id:1123819)方程可以写成：

$$
V_i \frac{d c_i}{dt} + \sum_{f \in \partial i} F_f A_f = V_i S_i
$$

这里，$c_i$ 是单元 $i$ 的平均浓度，$V_i$ 是其体积，$S_i$ 是平均源汇，$\sum_{f \in \partial i} F_f A_f$ 是通过单元所有面 $f$ 的净流出通量（$A_f$ 是面面积，$F_f$ 是法向通量）。[有限体积法](@entry_id:141374)的精髓在于，对于任意两个相邻单元 $i$ 和 $j$ 共享的内部界面，从单元 $i$ 流出的通量被精确地定义为进入单元 $j$ 的通量。当我们将所有单元的方程加总时，所有这些内部通量会成对抵消（形成一个“伸缩求和”），最终只剩下整个区域的边界通量和源汇项。这确保了离散系统在全局上完美地复制了[连续系统](@entry_id:178397)的全局守恒特性。

然而，即使一个方案是严格守恒的，它也可能引入非物理的效应。一个典型的例子是**[数值扩散](@entry_id:136300) (Numerical Diffusion)**。考虑一维线性[平流方程](@entry_id:144869) $\partial_t c + u \partial_x c = 0$，它描述了示踪剂以速度 $u$ 平移而不改变其形状。一个简单、守恒的数值格式，如**一阶迎风格式**，其离散方程的泰勒展开（即修正方程分析）表明，该格式实际求解的是一个带有附加项的方程 ：

$$
\frac{\partial c}{\partial t} + u \frac{\partial c}{\partial x} \approx \nu_{\text{num}} \frac{\partial^{2} c}{\partial x^{2}}
$$

其中，**等效[数值扩散](@entry_id:136300)系数** $\nu_{\text{num}} = \frac{u \Delta x - u^2 \Delta t}{2} = \frac{u \Delta x}{2}(1 - C)$，这里 $C = u\Delta t / \Delta x$ 是库朗数 (CFL number)。只要 $C < 1$，$\nu_{\text{num}}$ 就是一个正的扩散系数。这意味着，即使原始物理问题没有扩散，数值方案本身也会引入一个类似扩散的效应，导致尖锐的梯度被抹平，示踪剂场的方差随时间衰减。这对于需要精确维持示踪剂结构和梯度的应用是一个严重的问题。

在某些情况下，数值方案甚至可能不完全守恒质量。这可能是由于复杂的几何形状、非守恒的插值方法或[算子分裂](@entry_id:634210)技术导致的。在这种情况下，模型开发者可能会采用**质量修正器 (Mass Fixer)** 作为一种后处理步骤 。其目标是调整由平流步骤计算出的临时浓度场 $\tilde{c}_i$，使其恢复到目标总质量 $M^{\text{target}}$，同时对原始解的扰动最小，并保持物理有界性（如浓度非负）。

一个优雅的质量修正器可以被构建为一个[约束优化问题](@entry_id:1122941)：寻找一个新的场 $c_i$，使其在满足[质量守恒](@entry_id:204015)约束 $\sum_i V_i c_i = M^{\text{target}}$ 和物理边界约束 $c_{\min} \le c_i \le c_{\max}$ 的前提下，最小化与临时场 $\tilde{c}_i$ 的加权二范数距离 $\sum_i V_i (c_i - \tilde{c}_i)^2$。

-   如果解不需要触及物理边界，这种修正等价于对所有网格单元施加一个**均匀的加性修正** $c_i = \tilde{c}_i + \delta$。这种方法能保持示踪剂场的空间梯度和相对结构。
-   如果修正可能导致某些单元的值超出物理边界（例如，产生负浓度），则修正会变得[非线性](@entry_id:637147)：一些单元的值会被“裁剪”到边界上，而剩余的质量差额则由其他未饱和的单元来分摊。

这种方法展示了在实际建模中，为了维护基本的物理原理，需要在[数值精度](@entry_id:146137)、计算效率和物理真实性之间进行复杂的权衡。