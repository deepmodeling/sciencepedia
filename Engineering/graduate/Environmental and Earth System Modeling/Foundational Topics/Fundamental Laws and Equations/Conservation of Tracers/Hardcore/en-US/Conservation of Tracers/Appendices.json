{
    "hands_on_practices": [
        {
            "introduction": "Before modeling the conservation of a tracer, we must first choose the right mathematical language to describe its abundance. This fundamental exercise explores the relationships between different tracer metrics, such as mass mixing ratio and molar concentration. By working through the derivations , you will discover why this choice is not merely a matter of convenience but is critical for correctly representing conservation in a compressible fluid like the atmosphere, clarifying which properties are truly conserved along a fluid parcel's trajectory.",
            "id": "3870913",
            "problem": "A dilute gas-phase tracer species $X$ is transported in a compressible, inviscid, adiabatic atmospheric flow, with negligible molecular diffusion and no chemical sources or sinks. The mixture behaves as an ideal gas. The dry air molar mass is $M_{d} = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$, and the tracer molar mass is $M_{X} = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$. At a given location and time, the state is $P = 85{,}000 \\,\\mathrm{Pa}$ and $T = 260 \\,\\mathrm{K}$. The tracer is specified by its mass mixing ratio relative to dry air, defined as $r \\equiv m_{X}/m_{d}$, with value $r = 2.50 \\times 10^{-7}$.\n\nTasks:\n- Using only fundamental definitions and the ideal gas law, derive conversions between the tracer mass mixing ratio $r$, the tracer mass fraction $Y_{X}$, the tracer mole fraction $x_{X}$, and the tracer molar concentration $c_{X}$.\n- Starting from conservation of mass for each constituent and for the mixture, derive which variable forms are strictly conservative in Eulerian divergence form in a compressible flow, and which variables are materially conserved along trajectories. Explain how conservation properties depend on the chosen variable and on density variations.\n- Compute the numeric value of the tracer molar concentration $c_{X}$ at the specified state.\n\nUse the universal gas constant $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$. Round your final numerical answer to four significant figures. Express the final concentration in $\\mathrm{mol\\, m^{-3}}$. Report only the molar concentration $c_{X}$ as your final numerical answer.",
            "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It is a standard problem in atmospheric science and fluid dynamics concerning the transport and representation of a passive tracer. All necessary information is provided for a unique solution.\n\nThe solution is divided into three parts as requested by the problem statement: derivation of conversion formulas, analysis of conservation properties, and numerical calculation of the tracer molar concentration.\n\n### Part 1: Conversion Between Tracer Variables\n\nWe are given the definitions of the following quantities for a tracer species $X$ in a mixture with dry air ($d$):\n- Mass mixing ratio: $r \\equiv \\frac{m_X}{m_d}$, where $m_X$ and $m_d$ are the masses of the tracer and dry air, respectively.\n- Mass fraction: $Y_X \\equiv \\frac{m_X}{m_{total}} = \\frac{m_X}{m_X + m_d}$.\n- Mole fraction: $x_X \\equiv \\frac{n_X}{n_{total}} = \\frac{n_X}{n_X + n_d}$, where $n_X$ and $n_d$ are the number of moles.\n- Molar concentration: $c_X \\equiv \\frac{n_X}{V}$, where $V$ is the volume.\n\nThe relationship between mass $m$, moles $n$, and molar mass $M$ is $m = n M$.\n\n1.  **Conversion between mass mixing ratio ($r$) and mass fraction ($Y_X$)**:\n    By definition, $Y_X = \\frac{m_X}{m_X + m_d}$. Dividing the numerator and denominator by $m_d$ yields:\n    $$Y_X = \\frac{m_X/m_d}{m_X/m_d + 1} = \\frac{r}{r+1}$$\n    Conversely, to express $r$ in terms of $Y_X$, we can use the definition of the mass fraction of dry air, $Y_d = \\frac{m_d}{m_{total}} = 1 - Y_X$.\n    $$r = \\frac{m_X}{m_d} = \\frac{m_X/m_{total}}{m_d/m_{total}} = \\frac{Y_X}{Y_d} = \\frac{Y_X}{1 - Y_X}$$\n\n2.  **Conversion between mass mixing ratio ($r$) and mole fraction ($x_X$)**:\n    We start with the definition of mole fraction, $x_X = \\frac{n_X}{n_X + n_d}$. We substitute $n_X = m_X/M_X$ and $n_d = m_d/M_d$:\n    $$x_X = \\frac{m_X/M_X}{m_X/M_X + m_d/M_d}$$\n    Dividing the numerator and denominator by $m_d$ gives:\n    $$x_X = \\frac{(m_X/m_d)/M_X}{(m_X/m_d)/M_X + 1/M_d} = \\frac{r/M_X}{r/M_X + 1/M_d}$$\n    Multiplying the numerator and denominator by $M_X M_d$ simplifies the expression to:\n    $$x_X = \\frac{r M_d}{r M_d + M_X}$$\n\n3.  **Conversion to molar concentration ($c_X$)**:\n    The molar concentration $c_X$ is related to the mole fraction $x_X$ through the ideal gas law. For the mixture, the ideal gas law is $P V = n_{total} R T$, where $P$ is the total pressure, $T$ is the temperature, and $R$ is the universal gas constant. This can be rearranged to give the total molar concentration of the gas mixture:\n    $$c_{total} = \\frac{n_{total}}{V} = \\frac{P}{RT}$$\n    The molar concentration of the tracer is then the tracer's mole fraction multiplied by the total molar concentration:\n    $$c_X = \\frac{n_X}{V} = \\frac{n_X}{n_{total}} \\frac{n_{total}}{V} = x_X c_{total}$$\n    Substituting the expression for $c_{total}$, we get:\n    $$c_X = x_X \\frac{P}{RT}$$\n    By combining this with the previously derived relation for $x_X$, we can express $c_X$ directly in terms of the mass mixing ratio $r$:\n    $$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\n\n### Part 2: Conservation Properties\n\nWe analyze the conservation properties in a compressible, inviscid flow with velocity field $\\vec{u}$, and with no chemical sources/sinks or molecular diffusion.\n\nThe mass conservation for any species $i$ is described by the continuity equation:\n$$ \\frac{\\partial \\rho_i}{\\partial t} + \\nabla \\cdot (\\rho_i \\vec{u}) = 0 $$\nwhere $\\rho_i$ is the mass concentration (mass per unit volume) of species $i$.\n\n**Strictly Conservative in Eulerian Divergence Form**:\nA variable $q$ is strictly conservative in Eulerian divergence form if it satisfies $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$.\n-   For the tracer mass concentration, $\\rho_X = m_X/V$, the equation is $\\frac{\\partial \\rho_X}{\\partial t} + \\nabla \\cdot (\\rho_X \\vec{u}) = 0$. Thus, $\\rho_X$ is strictly conserved in this form.\n-   By dividing the mass conservation equation by the constant molar mass $M_X$, we obtain the molar conservation equation: $\\frac{\\partial c_X}{\\partial t} + \\nabla \\cdot (c_X \\vec{u}) = 0$ where $c_X = \\rho_X/M_X$. Thus, the molar concentration $c_X$ is also strictly conservative in Eulerian divergence form.\n-   Ratio quantities like $Y_X$, $r$, and $x_X$ do not satisfy this form of conservation. For example, expanding the advection term for $Y_X$ gives $\\nabla \\cdot (Y_X \\vec{u}) = Y_X(\\nabla \\cdot \\vec{u}) + \\vec{u} \\cdot \\nabla Y_X$. The continuity equation would be $\\frac{\\partial Y_X}{\\partial t} + \\vec{u} \\cdot \\nabla Y_X + Y_X(\\nabla \\cdot \\vec{u}) = 0$. This is not in the form $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$.\n\n**Materially Conserved Along Trajectories**:\nA variable $q$ is materially conserved if its value remains constant following a fluid parcel, which is expressed using the material derivative as $\\frac{Dq}{Dt} \\equiv \\frac{\\partial q}{\\partial t} + \\vec{u} \\cdot \\nabla q = 0$.\n\nThe total mass continuity equation for the mixture is $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\vec{u}) = 0$, where $\\rho = \\rho_d + \\rho_X$. In terms of the material derivative, this is $\\frac{D\\rho}{Dt} = -\\rho (\\nabla \\cdot \\vec{u})$.\nSimilarly, for the tracer, $\\frac{D\\rho_X}{Dt} = -\\rho_X (\\nabla \\cdot \\vec{u})$. For a compressible flow, $\\nabla \\cdot \\vec{u} \\neq 0$ generally, so the mass concentration $\\rho_X$ (and similarly the molar concentration $c_X$) is not materially conserved. Its value changes due to volume changes (compression or expansion) of the fluid parcel.\n\nNow we analyze the ratio quantities:\n-   **Mass Fraction ($Y_X = \\rho_X / \\rho$)**:\n    $$ \\frac{D Y_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho^2}\\frac{D\\rho}{Dt} = \\frac{1}{\\rho}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho^2}(-\\rho \\nabla \\cdot \\vec{u}) $$\n    $$ \\frac{D Y_X}{Dt} = -\\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) + \\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) = 0 $$\n    Thus, the mass fraction $Y_X$ is materially conserved.\n\n-   **Mass Mixing Ratio ($r = \\rho_X / \\rho_d$)**:\n    The analysis is identical to that for $Y_X$, as dry air is also a conserved species, so $\\frac{D\\rho_d}{Dt} = -\\rho_d (\\nabla \\cdot \\vec{u})$.\n    $$ \\frac{Dr}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho_d}\\right) = \\frac{1}{\\rho_d}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho_d^2}\\frac{D\\rho_d}{Dt} = \\frac{1}{\\rho_d}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho_d^2}(-\\rho_d \\nabla \\cdot \\vec{u}) = 0 $$\n    Thus, the mass mixing ratio $r$ is materially conserved.\n\n-   **Mole Fraction ($x_X = c_X / c_{total}$)**:\n    The logic is again identical, but applied to molar concentrations. We have $\\frac{Dc_X}{Dt} = -c_X(\\nabla \\cdot \\vec{u})$ and $\\frac{Dc_{total}}{Dt} = -c_{total}(\\nabla \\cdot \\vec{u})$.\n    $$ \\frac{Dx_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{c_X}{c_{total}}\\right) = \\frac{1}{c_{total}}\\frac{Dc_X}{Dt} - \\frac{c_X}{c_{total}^2}\\frac{Dc_{total}}{Dt} = \\frac{1}{c_{total}}(-c_X \\nabla \\cdot \\vec{u}) - \\frac{c_X}{c_{total}^2}(-c_{total} \\nabla \\cdot \\vec{u}) = 0 $$\n    Thus, the mole fraction $x_X$ is materially conserved.\n\n**Summary and Dependence on Density Variations**:\n-   Variables strictly conservative in Eulerian divergence form are the \"per unit volume\" quantities: mass concentration $\\rho_X$ and molar concentration $c_X$.\n-   Variables that are materially conserved (constant along trajectories) are the ratio quantities: mass fraction $Y_X$, mass mixing ratio $r$, and mole fraction $x_X$.\n-   The conservation properties of $\\rho_X$ and $c_X$ are fundamentally different from those of $Y_X$, $r$, and $x_X$ in a compressible flow. The material conservation of the ratio quantities holds regardless of density variations, as expansion/compression effects cancel out in the ratio. This makes them particularly useful for modeling tracer transport in compressible fluids like the atmosphere. In contrast, \"per volume\" quantities are only materially conserved if the flow is incompressible ($\\nabla \\cdot \\vec{u} = 0$), in which case density is constant along trajectories.\n\n### Part 3: Numerical Calculation of Molar Concentration\n\nWe use the formula derived in Part 1 to compute the tracer molar concentration $c_X$:\n$$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\nWe are given the following values:\n-   $r = 2.50 \\times 10^{-7}$\n-   $M_d = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $M_X = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $P = 85{,}000 \\,\\mathrm{Pa}$\n-   $T = 260 \\,\\mathrm{K}$\n-   $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$\n\nFirst, we calculate the mole fraction $x_X$:\n$$x_X = \\frac{(2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}{(48.00 \\times 10^{-3}) + (2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}$$\n$$x_X = \\frac{7.2425 \\times 10^{-9}}{0.0480000072425} \\approx 1.508854 \\times 10^{-7}$$\nNext, we calculate the total molar concentration $P/(RT)$:\n$$\\frac{P}{RT} = \\frac{85000 \\,\\mathrm{Pa}}{(8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}) \\times (260 \\,\\mathrm{K})} \\approx \\frac{85000}{2161.760} \\,\\mathrm{mol\\,m^{-3}} \\approx 39.3197 \\,\\mathrm{mol\\,m^{-3}}$$\nFinally, we compute $c_X$:\n$$c_X = x_X \\frac{P}{RT} \\approx (1.508854 \\times 10^{-7}) \\times (39.3197 \\,\\mathrm{mol\\,m^{-3}}) \\approx 5.9326 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$\nRounding the result to four significant figures as required:\n$$c_X \\approx 5.933 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$",
            "answer": "$$ \\boxed{5.933 \\times 10^{-6}} $$"
        },
        {
            "introduction": "Moving from the continuous world of theory to the discrete world of computation requires careful translation of physical laws into stable algorithms. This practice delves into the heart of numerical modeling by examining a finite-volume scheme for tracer advection . By analyzing a simple one-dimensional upwind scheme, you will derive and apply the famous Courant-Friedrichs-Lewy (CFL) condition, a cornerstone principle that governs the relationship between velocity, grid spacing, and the time step required for a stable and physically meaningful solution.",
            "id": "3870915",
            "problem": "Consider one-dimensional passive tracer advection on a periodic channel of length $L$ with constant positive velocity $u$. The tracer concentration $q(x,t)$ satisfies the conservation law $\\partial_{t} q + \\partial_{x}(u q) = 0$ with periodic boundary conditions. A finite-volume, flux-form discretization is used on a uniform grid of $N$ control volumes (cells) of width $\\Delta x$, with explicit time stepping of size $\\Delta t$. For $u>0$, the numerical flux through the interface at $x_{i+1/2}$ is taken to be the upwind value $F_{i+1/2}^{n} = u\\,q_{i}^{n}$, where $q_{i}^{n}$ denotes the cell average in cell $i$ at time level $t^{n}$.\n\nThe computational parameters are:\n- $L = 180\\,\\text{km}$,\n- $N = 512$,\n- $u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$,\n- $\\Delta t = 300\\,\\text{s}$.\n\nTasks:\n1. Compute the nondimensional Courant number, defined as the ratio between the advective distance traveled by a fluid parcel in one time step and the grid spacing. Express your answer as a pure number (no units), rounded to four significant figures.\n2. Starting from the integral form of local conservation over a control volume and the stated flux-form update, provide a principled explanation of how exact global conservation of the total tracer mass depends on the discretization and its fluxes. Then, using either a monotonicity argument based on convex combinations of neighboring cell averages or a Fourier (von Neumann) amplification-factor analysis, deduce the stability requirement on the time step in terms of the Courant number for this upwind scheme. Conclude with a bound on $\\Delta t$ in terms of $u$ and $\\Delta x$ that ensures nonnegative, nonoscillatory evolution for $u>0$.\n\nOnly the Courant number requested in Task 1 will be graded numerically; ensure you round to four significant figures and report it without units. All other reasoning must be fully justified from first principles of conservation and stability.",
            "solution": "The problem is divided into two tasks. The first is a numerical computation of the Courant number, and the second is a theoretical analysis of conservation and stability properties of the given numerical scheme.\n\nTask 1: Computation of the Courant Number\n\nThe problem provides the following parameters:\n-   Channel length, $L = 180\\,\\text{km} = 1.8 \\times 10^{5}\\,\\text{m}$.\n-   Number of grid cells, $N = 512$.\n-   Constant velocity, $u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$.\n-   Time step, $\\Delta t = 300\\,\\text{s}$.\n\nThe grid is uniform, so the width of each control volume (grid spacing) is $\\Delta x$.\n$$ \\Delta x = \\frac{L}{N} = \\frac{1.8 \\times 10^{5}\\,\\text{m}}{512} = 351.5625\\,\\text{m} $$\nThe Courant number, which we will denote by $C$, is defined as the ratio of the advective distance traveled in one time step, $u \\Delta t$, to the grid spacing, $\\Delta x$.\n$$ C = \\frac{u \\Delta t}{\\Delta x} $$\nSubstituting the given values:\n$$ C = \\frac{(0.71\\,\\text{m}\\,\\text{s}^{-1}) \\times (300\\,\\text{s})}{351.5625\\,\\text{m}} = \\frac{213}{351.5625} \\approx 0.605893706... $$\nRounding the result to four significant figures, we obtain:\n$$ C \\approx 0.6059 $$\n\nTask 2: Conservation and Stability Analysis\n\nFirst, we address the global conservation of tracer mass. The governing partial differential equation is a conservation law, $\\partial_{t} q + \\partial_{x}(uq) = 0$. The integral form of this law over a control volume $V_i = [x_{i-1/2}, x_{i+1/2}]$ is:\n$$ \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx + \\left[uq\\right]_{x=x_{i+1/2}} - \\left[uq\\right]_{x=x_{i-1/2}} = 0 $$\nLet $q_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx$ be the cell-averaged concentration in cell $i$. The integral form becomes:\n$$ \\Delta x \\frac{d q_i}{dt} + F(x_{i+1/2}, t) - F(x_{i-1/2}, t) = 0 $$\nwhere $F(x,t) = uq(x,t)$ is the continuous flux. The finite-volume method discretizes this by approximating the time derivative with a finite difference and the fluxes at the interfaces, $F(x_{i\\pm1/2}, t)$, with numerical fluxes, $F_{i\\pm1/2}^n$. Using an explicit forward Euler time step, we get:\n$$ \\frac{q_i^{n+1} - q_i^n}{\\Delta t} \\Delta x + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\nRearranging gives the flux-form update equation for the cell average:\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\nThe total tracer mass in the discrete system at time level $t^n$ is the sum of the mass in each cell, $M^n = \\sum_{i=1}^{N} q_i^n \\Delta x$. To assess its conservation, we sum the update equation over all cells $i = 1, \\dots, N$:\n$$ \\sum_{i=1}^{N} q_i^{n+1} = \\sum_{i=1}^{N} q_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\nMultiplying by $\\Delta x$ gives the update for total mass:\n$$ M^{n+1} = M^n - \\Delta t \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\nThe sum of the flux differences is a telescoping series:\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = (F_{3/2}^n - F_{1/2}^n) + (F_{5/2}^n - F_{3/2}^n) + \\dots + (F_{N+1/2}^n - F_{N-1/2}^n) = F_{N+1/2}^n - F_{1/2}^n $$\nThe crucial aspect of a flux-form conservative scheme is that the flux exiting cell $i$ at $x_{i+1/2}$, which is $-F_{i+1/2}^n$, is identical to the flux entering cell $i+1$ at the same interface, which is $+F_{i+1/2}^n$. This cancellation is what leads to the telescoping sum. For periodic boundary conditions, cell $N+1$ is identified with cell $1$, and thus the interface at $x_{N+1/2}$ is the same as the interface at $x_{1/2}$. This implies that the fluxes must be equal: $F_{N+1/2}^n = F_{1/2}^n$. Therefore, the sum of all flux differences is zero:\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = 0 $$\nThis leads to $M^{n+1} = M^n$. Thus, the total tracer mass is exactly conserved at every time step, a direct consequence of the flux-form discretization on a periodic domain.\n\nNext, we deduce the stability requirement. The problem specifies an upwind flux for $u>0$, which is $F_{i+1/2}^n = u q_i^n$. The flux at the left interface of cell $i$, $x_{i-1/2}$, is determined by the state in cell $i-1$, so $F_{i-1/2}^n = u q_{i-1}^n$. Substituting these into the update equation:\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( u q_i^n - u q_{i-1}^n \\right) $$\nIntroducing the nondimensional Courant number $C = \\frac{u \\Delta t}{\\Delta x}$, the scheme becomes:\n$$ q_i^{n+1} = q_i^n - C (q_i^n - q_{i-1}^n) $$\nRearranging the terms, we can express the new value $q_i^{n+1}$ as a linear combination of the old values in cell $i$ and its upwind neighbor, cell $i-1$:\n$$ q_i^{n+1} = (1 - C) q_i^n + C q_{i-1}^n $$\nFor the scheme to ensure a nonnegative evolution (i.e., if $q_j^n \\ge 0$ for all $j$, then $q_i^{n+1} \\ge 0$) and be nonoscillatory (monotonic, meaning no new local extrema are created), the value $q_i^{n+1}$ must be a convex combination of the values from which it is computed, here $q_i^n$ and $q_{i-1}^n$. A convex combination requires that the coefficients are non-negative and sum to $1$.\nThe sum of the coefficients is $(1 - C) + C = 1$, which is always true.\nFor the coefficients to be non-negative, we require:\n1.  $C \\ge 0$\n2.  $1 - C \\ge 0$\n\nSince $u>0$, $\\Delta t>0$, and $\\Delta x>0$, the Courant number $C$ is always non-negative, so the first condition is satisfied. The second condition, $1 - C \\ge 0$, implies $C \\le 1$.\nCombining these, the condition for a non-negative, non-oscillatory evolution is $0 \\le C \\le 1$. This is the stability requirement for the first-order upwind scheme.\nExpressing this requirement as a bound on the time step $\\Delta t$:\n$$ \\frac{u \\Delta t}{\\Delta x} \\le 1 $$\n$$ \\Delta t \\le \\frac{\\Delta x}{u} $$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for this scheme. It has the physical interpretation that in a single time step, the information (or tracer) cannot travel further than one grid cell width. Satisfying this condition ensures that the numerical solution is stable and maintains physically meaningful properties like non-negativity.",
            "answer": "$$ \\boxed{0.6059} $$"
        },
        {
            "introduction": "Theoretical conservation must hold true in practice, especially at the boundaries of a computational domain where errors can easily lead to artificial creation or destruction of mass. This hands-on coding exercise  addresses the critical task of implementing conservative boundary fluxes on a staggered grid, a common setup in geophysical models. By contrasting a correctly implemented flux calculation with common incorrect approaches, you will gain invaluable practical insight into preventing non-physical mass leakage and ensuring your model is truly conservative.",
            "id": "3870921",
            "problem": "You are modeling the advection of a passive tracer on a two-dimensional uniform staggered grid (Arakawa C-grid). The tracer concentration is defined at cell centers, the velocity component in the $x$-direction is defined at vertical faces, and the velocity component in the $y$-direction is defined at horizontal faces. The governing law is conservation of tracer in integral form: for any fixed control volume, the rate of change of tracer content equals the negative of the net outward advective flux across its boundary. You must derive, then implement, a conservative computation of the net boundary flux for the entire domain, and contrast it with two common non-conservative boundary implementations that cause leakage.\n\nStart from the finite-volume statement of conservation, expressed for a single cell of area $A$ with outward unit normal $\\boldsymbol{n}$ on the boundary $\\partial \\Omega$: $$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) \\;=\\; - \\oint_{\\partial \\Omega} \\left( \\boldsymbol{u}\\, c\\right)\\cdot \\boldsymbol{n} \\, \\mathrm{d}s,$$ where $c$ is concentration and $\\boldsymbol{u}$ is velocity. Interpret this on a uniform grid with spacings $\\Delta x$ and $\\Delta y$ as a discrete face-by-face sum of fluxes, respecting the orientation of outward normals and consistent upwinding of $c$ at faces. Use the following definitions and conventions:\n- The grid has $N_x$ cells in $x$ and $N_y$ cells in $y$.\n- Tracer values $c_{i,j}$ are at cell centers for indices $i \\in \\{0,\\dots,N_x-1\\}$ and $j \\in \\{0,\\dots,N_y-1\\}$.\n- The $x$-velocity $u_{i,j}$ is defined on vertical faces with indices $i \\in \\{0,\\dots,N_x\\}$ and $j \\in \\{0,\\dots,N_y-1\\}$, collocated at $x$-faces separating $i-1$ and $i$ cells. The outward normal is $-\\hat{\\boldsymbol{x}}$ on the left boundary ($i=0$) and $+\\hat{\\boldsymbol{x}}$ on the right boundary ($i=N_x$).\n- The $y$-velocity $v_{i,j}$ is defined on horizontal faces with indices $i \\in \\{0,\\dots,N_x-1\\}$ and $j \\in \\{0,\\dots,N_y\\}$, collocated at $y$-faces separating $j-1$ and $j$ cells. The outward normal is $-\\hat{\\boldsymbol{y}}$ on the bottom boundary ($j=0$) and $+\\hat{\\boldsymbol{y}}$ on the top boundary ($j=N_y$).\n- For upwinding the advective flux on a face, use the interior adjacent cell value on the upstream side if the flow is outward, and use an inflow boundary concentration when the flow is inward from outside the domain.\n- Each vertical face contributes a flux proportional to its segment length $\\Delta y$, and each horizontal face contributes a flux proportional to its segment length $\\Delta x$.\n\nYour program must compute three quantities for each test case:\n- The correct conservative net outward boundary flux $F_{\\text{corr}}$ computed by summing face fluxes with the consistent upwind tracer and correct face lengths and outward normal signs.\n- A non-conservative net outward boundary flux $F_{\\text{ghost}}$ computed using an erroneous ghost-cell treatment for inflow boundaries: when a boundary face has inflow (velocity points inward), instead of the specified inflow concentration, use half of the adjacent interior cell value ($\\tfrac{1}{2} c_{\\text{adj}}$); for outflows, use the interior value without change; use the correct face lengths and outward normal signs.\n- A non-conservative net outward boundary flux $F_{\\text{area}}$ computed with correct upwinding but with an erroneous face-length assignment: use $\\Delta x$ for all vertical faces and $\\Delta y$ for all horizontal faces, instead of the correct $\\Delta y$ for vertical faces and $\\Delta x$ for horizontal faces; use correct outward normal signs.\n\nAll variables in this problem are dimensionless; express all outputs as decimal numbers.\n\nImplement the above for the following test suite. For each case, construct the arrays exactly as specified:\n\n- Case $1$ (happy path, zero boundary flux):\n  - $N_x = 4$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 1$.\n  - $c_{i,j} = 1$ for all $i,j$.\n  - $u_{i,j} = 0$ for all $i \\in \\{0,\\dots,4\\}$, $j \\in \\{0,\\dots,2\\}$.\n  - $v_{i,j} = 0$ for all $i \\in \\{0,\\dots,3\\}$, $j \\in \\{0,\\dots,3\\}$.\n  - Inflow boundary concentrations are defined but not used: set left, right, bottom, top to scalar values $1$.\n\n- Case $2$ (uniform flow in $x$ with high-concentration inflow on the left):\n  - $N_x = 5$, $N_y = 4$, $\\Delta x = 1$, $\\Delta y = 1$.\n  - $c_{i,j} = 1$ for all $i,j$.\n  - $u_{i,j} = 1$ for all $i \\in \\{0,\\dots,5\\}$, $j \\in \\{0,\\dots,3\\}$.\n  - $v_{i,j} = 0$ for all $i \\in \\{0,\\dots,4\\}$, $j \\in \\{0,\\dots,4\\}$.\n  - Inflow boundary concentration on the left is the scalar $2$; other inflow boundary concentrations are not used.\n\n- Case $3$ (non-uniform tracer in $y$, vertical outflow at top and bottom):\n  - $N_x = 3$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 2$.\n  - $c_{i,j} = 1 + 0.5\\, j$ for all $i \\in \\{0,\\dots,2\\}$ and $j \\in \\{0,\\dots,2\\}$.\n  - $u_{i,j} = 0$ for all $i \\in \\{0,\\dots,3\\}$, $j \\in \\{0,\\dots,2\\}$.\n  - $v_{i,0} = -2$ for all $i \\in \\{0,\\dots,2\\}$ (bottom boundary), $v_{i,3} = 1$ for all $i \\in \\{0,\\dots,2\\}$ (top boundary), and $v_{i,j} = 0$ otherwise.\n  - Inflow boundary concentrations are not used.\n\n- Case $4$ (single cell, mixed inflow and outflow):\n  - $N_x = 1$, $N_y = 1$, $\\Delta x = 3$, $\\Delta y = 2$.\n  - $c_{0,0} = 1.5$.\n  - $u_{0,0} = 0$ at the left boundary, $u_{1,0} = 0.7$ at the right boundary.\n  - $v_{0,0} = 0.1$ at the bottom boundary, $v_{0,1} = -0.2$ at the top boundary.\n  - Inflow boundary concentration on the bottom is the scalar $1$, and on the top is the scalar $3$.\n\nYour program must:\n- Construct the arrays described above for each case.\n- Compute $F_{\\text{corr}}$, $F_{\\text{ghost}}$, and $F_{\\text{area}}$ for each case.\n- Produce a single line of output containing the $12$ results in order as a comma-separated list enclosed in square brackets: $[F_{\\text{corr},1},F_{\\text{ghost},1},F_{\\text{area},1},F_{\\text{corr},2},F_{\\text{ghost},2},F_{\\text{area},2},F_{\\text{corr},3},F_{\\text{ghost},3},F_{\\text{area},3},F_{\\text{corr},4},F_{\\text{ghost},4},F_{\\text{area},4}]$.\n\nDesign your solution to be verifiable with the given test suite. Focus on correctly applying outward normal signs, selecting the proper upwind tracer values at inflow and outflow faces, and multiplying by the correct face lengths. Also implement the two specific non-conservative variants described above. The final outputs are dimensionless decimals.",
            "solution": "The problem requires the computation of the net outward advective flux of a passive tracer across the boundaries of a two-dimensional domain. The calculation is to be performed on a uniform, staggered Arakawa C-grid. We must first derive the correct conservative flux, $F_{\\text{corr}}$, and then two non-conservative variants, $F_{\\text{ghost}}$ and $F_{\\text{area}}$.\n\nThe governing principle is the integral conservation law for a tracer with concentration $c$ and advected by a velocity field $\\boldsymbol{u}$:\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) = - \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s $$\nThe term on the right is the negative of the net outward flux. We are asked to compute this net outward flux, $F_{\\text{net}} = \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s$, for the entire computational domain. The domain boundary is composed of four segments: left, right, bottom, and top. The total flux is the sum of fluxes through these four segments: $F_{\\text{net}} = F_{\\text{left}} + F_{\\text{right}} + F_{\\text{bottom}} + F_{\\text{top}}$.\n\nWe will discretize the flux integral for each boundary segment. The grid has dimensions $N_x \\times N_y$ with cell spacings $\\Delta x$ and $\\Delta y$.\n-   Tracer concentration $c_{i,j}$ is at cell centers for $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n-   $x$-velocity $u_{i,j}$ is on vertical faces for $i \\in \\{0, \\dots, N_x\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n-   $y$-velocity $v_{i,j}$ is on horizontal faces for $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y\\}$.\n\nThe upwind principle is used to determine the tracer concentration $c$ at each face. For a flow velocity $\\boldsymbol{u}$ across a face with normal $\\boldsymbol{n}$, if the flow is directed outward from the domain ($\\boldsymbol{u} \\cdot \\boldsymbol{n} > 0$), $c$ is taken from the adjacent interior cell. If the flow is inward ($\\boldsymbol{u} \\cdot \\boldsymbol{n} < 0$), $c$ is taken from a specified inflow boundary condition.\n\n**1. Derivation of the Correct Conservative Flux, $F_{\\text{corr}}$**\n\nThe flux is summed over all boundary faces.\n\n**Left Boundary (at $i=0$):**\nThe boundary consists of $N_y$ vertical faces, indexed by $j \\in \\{0, \\dots, N_y-1\\}$. The outward normal is $\\boldsymbol{n} = -\\hat{\\boldsymbol{x}}$. The face length is $\\Delta y$. The velocity is $u_{0,j}$.\nThe outward flux through face $j$ is $((\\boldsymbol{u}c) \\cdot \\boldsymbol{n})_j \\Delta y = -u_{0,j} c_{\\text{face}} \\Delta y$.\n-   If $u_{0,j} > 0$: Inflow. $c_{\\text{face}} = c_{\\text{left},j}$ (specified inflow concentration). Flux is $-u_{0,j} c_{\\text{left},j} \\Delta y$.\n-   If $u_{0,j} \\le 0$: Outflow. $c_{\\text{face}} = c_{0,j}$ (adjacent interior cell). Flux is $-u_{0,j} c_{0,j} \\Delta y$.\nThe total flux is:\n$$ F_{\\text{left}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\nwhere $(x)^+ = \\max(x,0)$ and $(x)^- = \\min(x,0)$.\n\n**Right Boundary (at $i=N_x$):**\nThe boundary consists of $N_y$ vertical faces, indexed by $j \\in \\{0, \\dots, N_y-1\\}$. The outward normal is $\\boldsymbol{n} = +\\hat{\\boldsymbol{x}}$. The face length is $\\Delta y$. The velocity is $u_{N_x,j}$.\nThe outward flux through face $j$ is $u_{N_x,j} c_{\\text{face}} \\Delta y$.\n-   If $u_{N_x,j} > 0$: Outflow. $c_{\\text{face}} = c_{N_x-1,j}$. Flux is $u_{N_x,j} c_{N_x-1,j} \\Delta y$.\n-   If $u_{N_x,j} \\le 0$: Inflow. $c_{\\text{face}} = c_{\\text{right},j}$. Flux is $u_{N_x,j} c_{\\text{right},j} \\Delta y$.\nThe total flux is:\n$$ F_{\\text{right}} = \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{N_x,j})^+ c_{Nx-1,j} + (u_{N_x,j})^- c_{\\text{right},j} \\right] $$\n\n**Bottom Boundary (at $j=0$):**\nThe boundary consists of $N_x$ horizontal faces, indexed by $i \\in \\{0, \\dots, N_x-1\\}$. The outward normal is $\\boldsymbol{n} = -\\hat{\\boldsymbol{y}}$. The face length is $\\Delta x$. The velocity is $v_{i,0}$.\nThe outward flux through face $i$ is $-v_{i,0} c_{\\text{face}} \\Delta x$.\n-   If $v_{i,0} > 0$: Inflow. $c_{\\text{face}} = c_{\\text{bottom},i}$. Flux is $-v_{i,0} c_{\\text{bottom},i} \\Delta x$.\n-   If $v_{i,0} \\le 0$: Outflow. $c_{\\text-face}} = c_{i,0}$. Flux is $-v_{i,0} c_{i,0} \\Delta x$.\nThe total flux is:\n$$ F_{\\text{bottom}} = - \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\n**Top Boundary (at $j=N_y$):**\nThe boundary consists of $N_x$ horizontal faces, indexed by $i \\in \\{0, \\dots, N_x-1\\}$. The outward normal is $\\boldsymbol{n} = +\\hat{\\boldsymbol{y}}$. The face length is $\\Delta x$. The velocity is $v_{i,N_y}$.\nThe outward flux through face $i$ is $v_{i,N_y} c_{\\text{face}} \\Delta x$.\n-   If $v_{i,N_y} > 0$: Outflow. $c_{\\text{face}} = c_{i,N_y-1}$. Flux is $v_{i,N_y} c_{i,N_y-1} \\Delta x$.\n-   If $v_{i,N_y} \\le 0$: Inflow. $c_{\\text{face}} = c_{\\text{top},i}$. Flux is $v_{i,N_y} c_{\\text{top},i} \\Delta x$.\nThe total flux is:\n$$ F_{\\text{top}} = \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,N_y})^+ c_{i,N_y-1} + (v_{i,N_y})^- c_{\\text{top},i} \\right] $$\n\nThe total correct conservative flux is $F_{\\text-corr}} = F_{\\text-left}} + F_{\\text-right}} + F_{\\text-bottom}} + F_{\\text-top}}$.\n\n**2. Derivation of the Non-Conservative Flux, $F_{\\text{ghost}}$**\n\nThis variant modifies the inflow boundary condition. In case of inflow, the concentration is taken as half the value of the adjacent interior cell, i.e., $c_{\\text{inflow}} = \\frac{1}{2} c_{\\text{adj}}$. The outflow logic and face lengths remain correct.\n-   Left inflow ($u_{0,j} > 0$): Use $c = \\frac{1}{2} c_{0,j}$.\n-   Right inflow ($u_{N_x,j} < 0$): Use $c = \\frac{1}{2} c_{N_x-1,j}$.\n-   Bottom inflow ($v_{i,0} > 0$): Use $c = \\frac{1}{2} c_{i,0}$.\n-   Top inflow ($v_{i,N_y} < 0$): Use $c = \\frac{1}{2} c_{i,N_y-1}$.\nThe flux formulae are adjusted accordingly. For example, for the left boundary, the flux becomes:\n$$ F_{\\text{left,ghost}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ \\left(\\frac{1}{2} c_{0,j}\\right) + (u_{0,j})^- c_{0,j} \\right] $$\nSimilar substitutions are made for the other boundaries.\n\n**3. Derivation of the Non-Conservative Flux, $F_{\\text{area}}$**\n\nThis variant uses the correct upwinding logic but employs incorrect face lengths. Vertical faces (left/right) are assigned length $\\Delta x$ instead of $\\Delta y$, and horizontal faces (bottom/top) are assigned length $\\Delta y$ instead of $\\Delta x$.\nThe expressions for the four boundary fluxes are identical to those for $F_{\\text{corr}}$, but with $\\Delta x$ and $\\Delta y$ swapped. For example, for the left boundary:\n$$ F_{\\text{left,area}} = - \\Delta x \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\nAnd for the bottom boundary:\n$$ F_{\\text{bottom,area}} = - \\Delta y \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\nThe implementation will construct the specified fields for each test case and apply these three sets of formulae to compute $F_{\\text{corr}}$, $F_{\\text{ghost}}$, and $F_{\\text{area}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_fluxes(case_data):\n    \"\"\"\n    Computes the net outward boundary flux for a given case.\n    The function calculates three versions of the flux:\n    1. F_corr: Correct conservative flux.\n    2. F_ghost: Non-conservative flux with erroneous ghost-cell inflow.\n    3. F_area: Non-conservative flux with erroneous face area assignments.\n    \"\"\"\n    Nx = case_data['Nx']\n    Ny = case_data['Ny']\n    dx = case_data['dx']\n    dy = case_data['dy']\n    c_field = case_data['c']\n    u_field = case_data['u']\n    v_field = case_data['v']\n    c_inflow = case_data['c_inflow']\n    \n    F_corr = 0.0\n    F_ghost = 0.0\n    F_area = 0.0\n\n    # Left boundary (i=0)\n    for j in range(Ny):\n        u = u_field[0, j]\n        if u > 0:  # Inflow\n            # Correct\n            c_up_corr = c_inflow['left']\n            F_corr += -u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[0, j]\n            F_ghost += -u * c_up_ghost * dy\n            # Area\n            F_area += -u * c_up_corr * dx\n        else:  # Outflow (u = 0)\n            c_up = c_field[0, j]\n            # Correct\n            F_corr += -u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += -u * c_up * dy\n            # Area\n            F_area += -u * c_up * dx\n\n    # Right boundary (i=Nx)\n    for j in range(Ny):\n        u = u_field[Nx, j]\n        if u > 0:  # Outflow\n            c_up = c_field[Nx - 1, j]\n            # Correct\n            F_corr += u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += u * c_up * dy\n            # Area\n            F_area += u * c_up * dx\n        else:  # Inflow (u = 0)\n            c_up_corr = c_inflow['right']\n            # Correct\n            F_corr += u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[Nx-1, j]\n            F_ghost += u * c_up_ghost * dy\n            # Area\n            F_area += u * c_up_corr * dx\n\n    # Bottom boundary (j=0)\n    for i in range(Nx):\n        v = v_field[i, 0]\n        if v > 0:  # Inflow\n            c_up_corr = c_inflow['bottom']\n            # Correct\n            F_corr += -v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, 0]\n            F_ghost += -v * c_up_ghost * dx\n            # Area\n            F_area += -v * c_up_corr * dy\n        else:  # Outflow (v = 0)\n            c_up = c_field[i, 0]\n            # Correct\n            F_corr += -v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += -v * c_up * dx\n            # Area\n            F_area += -v * c_up * dy\n\n    # Top boundary (j=Ny)\n    for i in range(Nx):\n        v = v_field[i, Ny]\n        if v > 0:  # Outflow\n            c_up = c_field[i, Ny-1]\n            # Correct\n            F_corr += v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += v * c_up * dx\n            # Area\n            F_area += v * c_up * dy\n        else:  # Inflow (v = 0)\n            c_up_corr = c_inflow['top']\n            # Correct\n            F_corr += v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, Ny-1]\n            F_ghost += v * c_up_ghost * dx\n            # Area\n            F_area += v * c_up_corr * dy\n            \n    return F_corr, F_ghost, F_area\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = []\n\n    # Case 1\n    Nx1, Ny1 = 4, 3\n    c1 = np.ones((Nx1, Ny1))\n    u1 = np.zeros((Nx1 + 1, Ny1))\n    v1 = np.zeros((Nx1, Ny1 + 1))\n    c_in1 = {'left': 1.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx1, 'Ny': Ny1, 'dx': 1.0, 'dy': 1.0, 'c': c1, 'u': u1, 'v': v1, 'c_inflow': c_in1})\n\n    # Case 2\n    Nx2, Ny2 = 5, 4\n    c2 = np.ones((Nx2, Ny2))\n    u2 = np.ones((Nx2 + 1, Ny2))\n    v2 = np.zeros((Nx2, Ny2 + 1))\n    c_in2 = {'left': 2.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx2, 'Ny': Ny2, 'dx': 1.0, 'dy': 1.0, 'c': c2, 'u': u2, 'v': v2, 'c_inflow': c_in2})\n\n    # Case 3\n    Nx3, Ny3 = 3, 3\n    c3 = np.zeros((Nx3, Ny3))\n    j_indices = np.arange(Ny3)\n    c3[:, :] = 1.0 + 0.5 * j_indices\n    u3 = np.zeros((Nx3 + 1, Ny3))\n    v3 = np.zeros((Nx3, Ny3 + 1))\n    v3[:, 0] = -2.0\n    v3[:, 3] = 1.0\n    c_in3 = {'left': 0.0, 'right': 0.0, 'bottom': 0.0, 'top': 0.0} # Not used\n    test_cases.append({'Nx': Nx3, 'Ny': Ny3, 'dx': 1.0, 'dy': 2.0, 'c': c3, 'u': u3, 'v': v3, 'c_inflow': c_in3})\n\n    # Case 4\n    Nx4, Ny4 = 1, 1\n    c4 = np.full((Nx4, Ny4), 1.5)\n    u4 = np.zeros((Nx4 + 1, Ny4))\n    u4[1, 0] = 0.7\n    v4 = np.zeros((Nx4, Ny4 + 1))\n    v4[0, 0] = 0.1\n    v4[0, 1] = -0.2\n    c_in4 = {'left': 0.0, 'right': 0.0, 'bottom': 1.0, 'top': 3.0}\n    test_cases.append({'Nx': Nx4, 'Ny': Ny4, 'dx': 3.0, 'dy': 2.0, 'c': c4, 'u': u4, 'v': v4, 'c_inflow': c_in4})\n\n    results = []\n    for case in test_cases:\n        F_corr, F_ghost, F_area = calculate_fluxes(case)\n        results.extend([F_corr, F_ghost, F_area])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}'.rstrip('0').rstrip('.') if '.' in f'{r:.10f}' else f'{r:.1f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}