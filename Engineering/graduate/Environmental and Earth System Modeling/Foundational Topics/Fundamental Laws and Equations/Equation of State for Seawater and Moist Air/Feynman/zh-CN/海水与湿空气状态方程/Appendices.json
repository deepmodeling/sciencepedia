{
    "hands_on_practices": [
        {
            "introduction": "在同等温度和压力下，湿润空气比干燥空气的密度小，这对大气浮力和动力学至关重要。虚温（virtual temperature）这一概念，正是为了量化这一效应而引入的，它使得我们能用形式上更简洁的干空气状态方程来处理湿空气。本练习  将引导你从第一性原理出发，推导并计算包含水汽和液态水影响的广义虚温，从而深入理解空气密度背后的物理机制。",
            "id": "3878811",
            "problem": "一团位于海水上方的海洋边界层云空气块，在温度 $T = 300\\,\\mathrm{K}$ 和压强 $p$ 下充分混合（假设 $p$ 固定但未具体指明）。该气块包含水蒸气（比湿为 $q_v = 0.018$）和云中液态水（比湿为 $q_l = 0.001$）。仅使用每种气体组分的理想气体定律、道尔顿分压定律以及比湿和混合比的定义，从第一性原理推导该云湿空气的广义虚温 $T_v$ 的表达式。广义虚温由状态方程（EOS）条件定义，即云湿空气的总密度等于相同压强和温度 $T_v$ 下干空气的密度，即 $\\rho_{\\text{total}} = p/\\left(R_d T_v\\right)$，其中 $R_d$ 是干空气的比气体常数。取 $R_d = R^\\ast/M_d$ 和 $R_v = R^\\ast/M_v$，其中 $R^\\ast$ 是普适气体常数，$M_d$ 是干空气的摩尔质量，$M_v$ 是水蒸气的摩尔质量，并令 $\\epsilon \\equiv R_d/R_v = M_v/M_d \\approx 0.622$。\n\n然后，使用给定的 $T$、$q_v$、$q_l$ 和 $\\epsilon = 0.622$ 数值计算差值 $T_v - T$。将 $T_v - T$ 的最终数值结果四舍五入到四位有效数字。以 $\\mathrm{K}$ 为单位表示您的答案。最后，根据固定压强下的密度效应，简要解释 $T_v - T$ 的符号和大小。",
            "solution": "该问题经评估为有效，因为它具有科学依据、问题明确、客观，并包含基于大气热力学既定原则的完整且一致的设定。\n\n我们的任务是从第一性原理推导云空气块的广义虚温 $T_v$ 的表达式，然后根据给定条件计算差值 $T_v - T$。推导过程如下。\n\n设云空气块的总体积为 $V$。该气块包含质量为 $m_d$ 的干空气、质量为 $m_v$ 的水蒸气和质量为 $m_l$ 的液态水。总质量为 $m_{\\text{total}} = m_d + m_v + m_l$。\n因此，云湿空气的总密度为：\n$$\n\\rho_{\\text{total}} = \\frac{m_{\\text{total}}}{V} = \\frac{m_d + m_v + m_l}{V}\n$$\n在此背景下，一个标准且物理上合理的假设是，液态水滴所占的体积与气块的总体积相比可以忽略不计。因此，体积 $V$ 完全由气体组分决定：干空气和水蒸气。\n\n根据道尔顿分压定律，气体混合物的总压强 $p$ 是干空气分压 $p_d$ 和水蒸气分压 $p_v$ 的总和：\n$$\np = p_d + p_v\n$$\n假设每种气体组分都遵循理想气体定律。两种气体在相同温度 $T$ 下占据相同的体积 $V$。\n对于干空气：$p_d V = m_d R_d T$\n对于水蒸气：$p_v V = m_v R_v T$\n\n将这两个方程相加，得到气体混合物总压强的关系式：\n$$\n(p_d + p_v)V = (m_d R_d + m_v R_v)T\n$$\n$$\np V = (m_d R_d + m_v R_v)T\n$$\n由此，我们可以表达出气块的体积 $V$：\n$$\nV = \\frac{T}{p}(m_d R_d + m_v R_v)\n$$\n现在，我们将这个 $V$ 的表达式代入总密度 $\\rho_{\\text{total}}$ 的方程中：\n$$\n\\rho_{\\text{total}} = \\frac{m_d + m_v + m_l}{\\frac{T}{p}(m_d R_d + m_v R_v)} = \\frac{p}{T} \\frac{m_d + m_v + m_l}{m_d R_d + m_v R_v}\n$$\n为了继续推导，我们引入问题中给出的比湿。水蒸气比湿 $q_v$ 和液态水比湿 $q_l$ 定义为相对于气块总质量的质量分数：\n$$\nq_v = \\frac{m_v}{m_{\\text{total}}} \\quad \\text{and} \\quad q_l = \\frac{m_l}{m_{\\text{total}}}\n$$\n那么，干空气的比湿 $q_d$ 为：\n$$\nq_d = \\frac{m_d}{m_{\\text{total}}} = \\frac{m_{\\text{total}} - m_v - m_l}{m_{\\text{total}}} = 1 - q_v - q_l\n$$\n我们可以用总质量 $m_{\\text{total}}$ 和比湿来表示各个组分的质量：\n$m_d = q_d m_{\\text{total}} = (1 - q_v - q_l)m_{\\text{total}}$\n$m_v = q_v m_{\\text{total}}$\n$m_l = q_l m_{\\text{total}}$\n\n将这些表达式代入 $\\rho_{\\text{total}}$ 的方程中。$m_{\\text{total}}$ 项将出现在每个质量项中，可以被因子分解出来。\n$$\n\\rho_{\\text{total}} = \\frac{p}{T} \\frac{m_{\\text{total}}((1 - q_v - q_l) + q_v + q_l)}{m_{\\text{total}}((1 - q_v - q_l)R_d + q_v R_v)}\n$$\n分数内的分子简化为 $1$。$m_{\\text{total}}$ 项相互抵消，得到：\n$$\n\\rho_{\\text{total}} = \\frac{p}{T((1 - q_v - q_l)R_d + q_v R_v)}\n$$\n问题通过状态方程条件定义了广义虚温 $T_v$：\n$$\n\\rho_{\\text{total}} = \\frac{p}{R_d T_v}\n$$\n通过令两个 $\\rho_{\\text{total}}$ 的表达式相等，我们得到：\n$$\n\\frac{p}{R_d T_v} = \\frac{p}{T((1 - q_v - q_l)R_d + q_v R_v)}\n$$\n消去压强 $p$ 并重新整理可得：\n$$\nR_d T_v = T((1 - q_v - q_l)R_d + q_v R_v)\n$$\n两边同除以 $R_d$ 来求解 $T_v$：\n$$\nT_v = T \\left( \\frac{(1 - q_v - q_l)R_d + q_v R_v}{R_d} \\right)\n$$\n$$\nT_v = T \\left( 1 - q_v - q_l + q_v \\frac{R_v}{R_d} \\right)\n$$\n使用定义 $\\epsilon = R_d/R_v$，我们有 $R_v/R_d = 1/\\epsilon$。将其代入 $T_v$ 的方程中：\n$$\nT_v = T \\left( 1 - q_v - q_l + \\frac{q_v}{\\epsilon} \\right)\n$$\n这可以重新整理成一个更常见的形式：\n$$\nT_v = T \\left( 1 + q_v \\left(\\frac{1}{\\epsilon} - 1\\right) - q_l \\right) = T \\left( 1 + q_v \\frac{1-\\epsilon}{\\epsilon} - q_l \\right)\n$$\n这就是推导出的广义虚温的表达式。\n\n接下来，我们使用给定值 $T = 300\\,\\mathrm{K}$、$q_v = 0.018$、$q_l = 0.001$ 和 $\\epsilon = 0.622$ 计算差值 $T_v - T$。\n根据推导出的表达式：\n$$\nT_v - T = T \\left( 1 + q_v \\left(\\frac{1-\\epsilon}{\\epsilon}\\right) - q_l \\right) - T\n$$\n$$\nT_v - T = T \\left( q_v \\left(\\frac{1-\\epsilon}{\\epsilon}\\right) - q_l \\right)\n$$\n首先，计算 $q_v$ 的系数：\n$$\n\\frac{1-\\epsilon}{\\epsilon} = \\frac{1 - 0.622}{0.622} = \\frac{0.378}{0.622} \\approx 0.6077170418\n$$\n现在，将给定的数值代入 $T_v - T$ 的表达式中：\n$$\nT_v - T \\approx 300\\,\\mathrm{K} \\left( 0.018 \\times 0.6077170418 - 0.001 \\right)\n$$\n$$\nT_v - T \\approx 300\\,\\mathrm{K} \\left( 0.01093890675 - 0.001 \\right)\n$$\n$$\nT_v - T \\approx 300\\,\\mathrm{K} \\left( 0.00993890675 \\right)\n$$\n$$\nT_v - T \\approx 2.981672025\\,\\mathrm{K}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nT_v - T \\approx 2.982\\,\\mathrm{K}\n$$\n最后，我们解释这个结果。$T_v - T \\approx +2.982\\,\\mathrm{K}$ 的正号意味着 $T_v > T$。虚温的定义通过 $\\rho_{\\text{total}} = p/(R_d T_v)$ 将气块的总密度 $\\rho_{\\text{total}}$ 与一个假设的、在温度为 $T_v$ 且压强相同时为 $p$ 的干空气块的密度联系起来。一个在实际温度 $T$ 和压强 $p$ 下的干空气块的密度为 $\\rho_d(T, p) = p/(R_d T)$。\n由于 $T_v > T$，因此有 $1/T_v  1/T$，从而 $\\rho_{\\text{total}}  \\rho_d(T, p)$。这意味着云湿空气块比相同温度和压强下的干空气块密度更小（浮力更大）。\n\n这个净效应是两个相反因素共同作用的结果：\n1. 水蒸气的浮力效应：水蒸气（$M_v \\approx 18.015\\,\\mathrm{g/mol}$）比干空气（$M_d \\approx 28.96\\,\\mathrm{g/mol}$）轻得多。用较轻的水蒸气分子替换较重的干空气分子会降低气块的密度。这对应于正项 $T q_v((1-\\epsilon)/\\epsilon) \\approx 300\\,\\mathrm{K} \\times 0.01094 \\approx +3.28\\,\\mathrm{K}$。\n2. 液态水的负载效应：凝结的液态水增加了气块的质量，但对其压强没有贡献（因为它不是气体）。这增加了气块的总密度。这对应于负项 $-T q_l = -300\\,\\mathrm{K} \\times 0.001 = -0.3\\,\\mathrm{K}$。\n\n在这种情况下，水蒸气产生的浮力效应（$+3.28\\,\\mathrm{K}$）在量级上远大于液态水的负载效应（$-0.3\\,\\mathrm{K}$），导致 $T_v - T$ 的净值为正，并显著降低了气块的密度。",
            "answer": "$$\n\\boxed{2.982}\n$$"
        },
        {
            "introduction": "与理想气体不同，海水的状态方程呈现出显著的非线性。这种非线性会导致一些反直觉的现象，其中最著名的就是“等密度混合增重”（cabbeling），即两个密度相同的海水水块混合后，其产物的密度会增加。本练习  将利用泰勒展开来近似海水状态方程，让你亲手计算并量化这一由非线性混合效应导致的密度变化。",
            "id": "3878816",
            "problem": "一位研究人员正在使用海水状态方程（EOS）的局部曲率来研究海水的等压混合致密化（cabbeling）现象。考虑原位密度，这是一个热力学状态函数，记为 $\\rho(S,T,p)$，其中 $S$ 是绝对盐度（单位：g/kg），$T$ 是保守温度（单位：$\\mathrm{^{\\circ}C}$），$p$ 是压力（单位：dbar）。两个水团，标记为 $A$ 和 $B$，在恒定压力 $p$ 下位于同一等密度面上，这意味着它们在混合前具有相同的原位密度 $\\rho_0$。接着，它们进行等压混合，形成一个均匀的混合物，其盐度和温度是两个端点状态的算术平均值。\n\n假设存在以下科学上合理的设定：\n- 压力固定为 $p = 1000$ dbar。\n- 中点状态为 $(S_m,T_m) = (35.00\\,\\mathrm{g/kg},\\,10.00\\,\\mathrm{^{\\circ}C})$。\n- 端点处的等密度面密度为 $\\rho_0 = 1027.200\\,\\mathrm{kg/m^3}$。\n- 在 $(S_m,T_m,p)$ 处 $\\rho$ 的局部一阶和二阶偏导数是已知的（这些可以从标准的海水状态方程，如在指定状态点下的 2010 年国际海水热力学方程（TEOS-10）中获得）：\n  - $\\rho_T = \\left.\\frac{\\partial \\rho}{\\partial T}\\right|_{S,p} = -0.200\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}}$，\n  - $\\rho_S = \\left.\\frac{\\partial \\rho}{\\partial S}\\right|_{T,p} = 0.780\\,\\mathrm{kg\\,m^{-3}\\,(g/kg)^{-1}}$，\n  - $\\rho_{TT} = \\left.\\frac{\\partial^2 \\rho}{\\partial T^2}\\right|_{S,p} = -0.00200\\,\\mathrm{kg\\,m^{-3}\\,K^{-2}}$，\n  - $\\rho_{ST} = \\left.\\frac{\\partial^2 \\rho}{\\partial S\\,\\partial T}\\right|_{p} = 0.000150\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}\\,(g/kg)^{-1}}$，\n  - $\\rho_{SS} = \\left.\\frac{\\partial^2 \\rho}{\\partial S^2}\\right|_{T,p} = 0.000200\\,\\mathrm{kg\\,m^{-3}\\,(g/kg)^{-2}}$。\n\n构建一个例子，其中端点盐度为 $S_A = S_m - 0.20\\,\\mathrm{g/kg}$ 和 $S_B = S_m + 0.20\\,\\mathrm{g/kg}$。在 $(S,T)$ 的一阶近似下施加同等密度面约束，从而选择 $T_A$ 和 $T_B$，使得两个端点在压力 $p$ 下具有相等的密度。然后，使用 $\\rho(S,T,p)$ 在 $(S_m,T_m,p)$ 附近的二阶泰勒展开，计算等压混合水团的原位密度 $\\rho_{\\mathrm{mix}} = \\rho(S_m,T_m,p)$ 至二阶，并证明 cabbeling 现象（即 $\\rho_{\\mathrm{mix}}  \\rho_0$）。\n\n提供 $\\rho_{\\mathrm{mix}}$ 的最终值，单位为 $\\mathrm{kg/m^3}$。将你的答案四舍五入到七位有效数字。",
            "solution": "问题要求使用海水状态方程的二阶泰勒展开，计算两个海水水团等压混合后的密度，以展示 cabbeling 现象。\n\n### 步骤 1：提取已知条件\n- **状态变量**：原位密度 $\\rho(S,T,p)$，其中 $S$ 是绝对盐度，$T$ 是保守温度，$p$ 是压力。\n- **过程条件**：在恒定压力 $p = 1000\\,\\mathrm{dbar}$ 下进行等压混合。\n- **中点状态**：$(S_m, T_m) = (35.00\\,\\mathrm{g/kg}, 10.00\\,\\mathrm{^{\\circ}C})$。混合后的水团处于此状态。\n- **端点密度**：两个初始水团（A 和 B）位于密度为 $\\rho_0 = 1027.200\\,\\mathrm{kg/m^3}$ 的等密度面上。\n- **端点盐度扰动**：$S_A = S_m - 0.20\\,\\mathrm{g/kg}$ 和 $S_B = S_m + 0.20\\,\\mathrm{g/kg}$。这定义了一个偏差 $\\delta S = 0.20\\,\\mathrm{g/kg}$。\n- **在 $(S_m, T_m, p)$ 处的偏导数**：\n  - $\\rho_T = \\frac{\\partial \\rho}{\\partial T} = -0.200\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}}$\n  - $\\rho_S = \\frac{\\partial \\rho}{\\partial S} = 0.780\\,\\mathrm{kg\\,m^{-3}\\,(g/kg)^{-1}}$\n  - $\\rho_{TT} = \\frac{\\partial^2 \\rho}{\\partial T^2} = -0.00200\\,\\mathrm{kg\\,m^{-3}\\,K^{-2}}$\n  - $\\rho_{ST} = \\frac{\\partial^2 \\rho}{\\partial S\\,\\partial T} = 0.000150\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}\\,(g/kg)^{-1}}$\n  - $\\rho_{SS} = \\frac{\\partial^2 \\rho}{\\partial S^2} = 0.000200\\,\\mathrm{kg\\,m^{-3}\\,(g/kg)^{-2}}$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了 cabbeling 现象，这是物理海洋学中一个有据可查的现象。变量（$S, T, p, \\rho$）以及海水热力学方程（TEOS-10）框架的使用都是标准的。给定的偏导数值对于指定状态下的海水是物理上现实的。该问题是科学合理的。\n- **适定性**：该问题基于泰勒级数展开建立了一个清晰的计算。所有必要的数据和约束都已提供，以找到唯一的数值解。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性或偏见。\n- **完整性和一致性**：问题是自洽的。数据足以进行完整的计算。没有明显的矛盾之处。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n### 解题推导\n\n分析是在恒定压力 $p$ 下进行的，因此密度 $\\rho$ 可以仅被视为盐度 $S$ 和温度 $T$ 的函数，即 $\\rho(S,T)$。一个状态为 $(S,T)$ 的水团在其密度中点 $(S_m,T_m)$ 附近的密度可以用二阶泰勒级数展开来近似：\n$$ \\rho(S, T) \\approx \\rho(S_m, T_m) + \\rho_S (S-S_m) + \\rho_T (T-T_m) + \\frac{1}{2} \\left[ \\rho_{SS} (S-S_m)^2 + 2\\rho_{ST} (S-S_m)(T-T_m) + \\rho_{TT} (T-T_m)^2 \\right] $$\n其中偏导数 $\\rho_S$、$\\rho_T$、$\\rho_{SS}$、$\\rho_{ST}$、$\\rho_{TT}$ 均在中点 $(S_m, T_m)$ 处求值。\n\n设两个初始水团的状态为 $A=(S_A, T_A)$ 和 $B=(S_B, T_B)$。混合后的水团位于这些状态的算术平均值处，$M=(S_m, T_m)$。我们可以将与平均值的偏差定义为 $\\delta S$ 和 $\\delta T$，使得：\n- $S_A = S_m - \\delta S$, $T_A = T_m - \\delta T$\n- $S_B = S_m + \\delta S$, $T_B = T_m + \\delta T$\n\n根据问题陈述，给定 $\\delta S = 0.20\\,\\mathrm{g/kg}$。水团 A 和 B 位于同一等密度面上，意味着 $\\rho(S_A, T_A) = \\rho(S_B, T_B) = \\rho_0$。问题指定温度和盐度偏差之间的关系应通过施加一阶条件来确定。在 $(S,T)$ 平面上连接 A 和 B 的直线的斜率为 $\\frac{T_B - T_A}{S_B - S_A} = \\frac{2\\delta T}{2\\delta S} = \\frac{\\delta T}{\\delta S}$。在一阶近似下，该斜率必须等于中点处等密度线的斜率。对于等密度线，$d\\rho=0$。密度的全微分为 $d\\rho = \\rho_S dS + \\rho_T dT$。因此，等密度线的斜率为 $\\frac{dT}{dS}\\Big|_{\\rho} = -\\frac{\\rho_S}{\\rho_T}$。\n\n令两个斜率相等，得到所需的关系：\n$$ \\frac{\\delta T}{\\delta S} = -\\frac{\\rho_S}{\\rho_T} \\implies \\delta T = -\\frac{\\rho_S}{\\rho_T} \\delta S $$\n代入给定值：\n$$ \\delta T = - \\frac{0.780\\,\\mathrm{kg\\,m^{-3}\\,(g/kg)^{-1}}}{-0.200\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}}} \\times (0.20\\,\\mathrm{g/kg}) = \\frac{0.780}{0.200} \\times 0.20 = 0.780\\,\\mathrm{K} $$\n（注意，开尔文的温差与摄氏度的温差是相同的）。\n\n混合水团的密度为 $\\rho_{\\mathrm{mix}} = \\rho(S_m, T_m)$。初始水团的密度为 $\\rho_0$。由 cabbeling 引起的密度增加是通过考虑初始水团的平均密度来找到的。我们将水团 A 和 B 的密度在中点 M 附近展开：\n$$ \\rho_A = \\rho(S_m - \\delta S, T_m - \\delta T) \\approx \\rho_{\\mathrm{mix}} - \\rho_S \\delta S - \\rho_T \\delta T + \\frac{1}{2} \\left[ \\rho_{SS}(\\delta S)^2 + 2\\rho_{ST}\\delta S \\delta T + \\rho_{TT}(\\delta T)^2 \\right] $$\n$$ \\rho_B = \\rho(S_m + \\delta S, T_m + \\delta T) \\approx \\rho_{\\mathrm{mix}} + \\rho_S \\delta S + \\rho_T \\delta T + \\frac{1}{2} \\left[ \\rho_{SS}(\\delta S)^2 + 2\\rho_{ST}\\delta S \\delta T + \\rho_{TT}(\\delta T)^2 \\right] $$\n这两个密度的平均值为 $\\rho_0 = \\frac{1}{2}(\\rho_A + \\rho_B)$。将这两个表达式相加并除以 2，会消去一阶项：\n$$ \\rho_0 \\approx \\rho_{\\mathrm{mix}} + \\frac{1}{2} \\left[ \\rho_{SS}(\\delta S)^2 + 2\\rho_{ST}\\delta S \\delta T + \\rho_{TT}(\\delta T)^2 \\right] $$\n因此，混合水团的密度 $\\rho_{\\mathrm{mix}}$ 为：\n$$ \\rho_{\\mathrm{mix}} \\approx \\rho_0 - \\frac{1}{2} \\left[ \\rho_{SS}(\\delta S)^2 + 2\\rho_{ST}\\delta S \\delta T + \\rho_{TT}(\\delta T)^2 \\right] $$\n方括号中的项表示状态方程非线性（曲率）的影响。我们来计算它的值，记为 $Q$：\n$$ Q = \\rho_{SS}(\\delta S)^2 + 2\\rho_{ST}\\delta S \\delta T + \\rho_{TT}(\\delta T)^2 $$\n代入给定值和我们计算出的 $\\delta T$：\n$$ \\delta S = 0.20 $$\n$$ \\delta T = 0.780 $$\n- 第一项：$\\rho_{SS}(\\delta S)^2 = (0.000200) \\times (0.20)^2 = (0.000200) \\times (0.04) = 0.000008$\n- 第二项：$2\\rho_{ST}\\delta S \\delta T = 2 \\times (0.000150) \\times (0.20) \\times (0.780) = 0.0000468$\n- 第三项：$\\rho_{TT}(\\delta T)^2 = (-0.00200) \\times (0.780)^2 = (-0.00200) \\times (0.6084) = -0.0012168$\n\n总和为：\n$$ Q = 0.000008 + 0.0000468 - 0.0012168 = -0.001162\\,\\mathrm{kg\\,m^{-3}} $$\n由 cabbeling 引起的密度增加 $\\Delta\\rho = \\rho_{\\mathrm{mix}} - \\rho_0$ 由下式给出：\n$$ \\Delta\\rho = -\\frac{1}{2}Q = -\\frac{1}{2}(-0.001162\\,\\mathrm{kg\\,m^{-3}}) = 0.000581\\,\\mathrm{kg\\,m^{-3}} $$\n由于 $\\Delta\\rho > 0$，混合水团比原始水团更密集，这证实了 cabbeling 现象。\n\n混合物的最终密度为：\n$$ \\rho_{\\mathrm{mix}} = \\rho_0 + \\Delta\\rho = 1027.200\\,\\mathrm{kg\\,m^{-3}} + 0.000581\\,\\mathrm{kg\\,m^{-3}} = 1027.200581\\,\\mathrm{kg\\,m^{-3}} $$\n问题要求将最终答案四舍五入到七位有效数字。第七位有效数字是小数点后第三位。随后的数字是 $5$，因此我们向上取整。\n$$ \\rho_{\\mathrm{mix}} \\approx 1027.201\\,\\mathrm{kg\\,m^{-3}} $$",
            "answer": "$$\n\\boxed{1027.201}\n$$"
        },
        {
            "introduction": "在地球系统科学中，状态方程的输入（如温度、盐度和压力）均来自带有不确定性的测量。这些测量误差会传递到最终计算出的物理量（如密度）中，影响我们对海洋状态的认知。本练习  将应用标准误差传播理论，让你能够基于传感器误差和相关性，量化计算海水密度时的不确定性，这是一项连接理论模型与实际观测的关键技能。",
            "id": "3878784",
            "problem": "一个海洋模型使用2010年热力学海水状态方程 (TEOS-10) 来表示海水原位密度 $\\,\\rho\\,$，它是绝对盐度 $\\,S_A\\,$（单位为 $\\mathrm{g}\\,\\mathrm{kg}^{-1}$）、温度 $\\,T\\,$（单位为 $\\mathrm{K}$）和压力 $\\,p\\,$（单位为 $\\mathrm{dbar}$）的函数，即 $\\,\\rho = \\rho(S_A,T,p)\\,$。考虑一个深海状态，在该状态下，TEOS-10 状态方程的导数经评估已知为\n$$\\left.\\frac{\\partial \\rho}{\\partial S_A}\\right|_{T,p} = 0.78\\ \\mathrm{kg\\,m^{-3}\\,(\\mathrm{g}\\,kg^{-1})^{-1}},\\quad \\left.\\frac{\\partial \\rho}{\\partial T}\\right|_{S_A,p} = -0.25\\ \\mathrm{kg\\,m^{-3}\\,K^{-1}},\\quad \\left.\\frac{\\partial \\rho}{\\partial p}\\right|_{S_A,T} = 0.0043\\ \\mathrm{kg\\,m^{-3}\\,dbar^{-1}}。$$\n您拥有由传感器表征的三个输入的标准不确定度，\n$$\\sigma_{S_A} = 0.003\\ \\mathrm{g\\,kg^{-1}},\\quad \\sigma_T = 0.004\\ \\mathrm{K},\\quad \\sigma_p = 0.5\\ \\mathrm{dbar},$$\n以及它们误差之间的以下相关系数，\n$$r_{T,S_A} = 0.20,\\quad r_{T,p} = -0.05,\\quad r_{S_A,p} = 0.10。$$\n假设误差是无偏的、近似高斯分布的，并且足够小以至于一阶线性化是有效的。使用第一性原理误差传播方法，推导密度误差方差的表达式，并计算在此状态下密度的标准不确定度 $\\,\\sigma_{\\rho}\\,$。\n\n将 $\\,\\sigma_{\\rho}\\,$ 的最终数值以 $\\mathrm{kg\\,m^{-3}}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在给定输入变量（绝对盐度 $S_A$、温度 $T$ 和压力 $p$）的不确定度及其相互之间的相关性的情况下，计算海水密度的不确定度 $\\sigma_{\\rho}$。该问题基于多元函数的一阶误差传播原理。\n\n设原位密度 $\\rho$ 是三个变量的函数，$\\rho = \\rho(S_A, T, p)$。问题假设 $S_A$、$T$ 和 $p$ 的测量误差足够小，可以对 $\\rho$ 的误差（记为 $\\delta\\rho$）进行一阶泰勒级数展开：\n$$ \\delta\\rho \\approx \\frac{\\partial \\rho}{\\partial S_A} \\delta S_A + \\frac{\\partial \\rho}{\\partial T} \\delta T + \\frac{\\partial \\rho}{\\partial p} \\delta p $$\n其中 $\\delta S_A$、$\\delta T$ 和 $\\delta p$ 分别是相应输入变量的误差。\n\n密度的方差 $\\sigma_{\\rho}^2$ 定义为误差平方的期望值 $E[(\\delta\\rho)^2]$。将 $\\delta\\rho$ 的表达式平方并取期望值，可得到不确定度传播的通用公式：\n$$ \\sigma_{\\rho}^2 = E\\left[ \\left( \\frac{\\partial \\rho}{\\partial S_A} \\delta S_A + \\frac{\\partial \\rho}{\\partial T} \\delta T + \\frac{\\partial \\rho}{\\partial p} \\delta p \\right)^2 \\right] $$\n展开平方项并应用期望算子，我们得到：\n$$ \\sigma_{\\rho}^2 = \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right)^2 E[(\\delta S_A)^2] + \\left(\\frac{\\partial \\rho}{\\partial T}\\right)^2 E[(\\delta T)^2] + \\left(\\frac{\\partial \\rho}{\\partial p}\\right)^2 E[(\\delta p)^2] \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right) \\left(\\frac{\\partial \\rho}{\\partial T}\\right) E[\\delta S_A \\delta T] \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right) \\left(\\frac{\\partial \\rho}{\\partial p}\\right) E[\\delta S_A \\delta p] \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial T}\\right) \\left(\\frac{\\partial \\rho}{\\partial p}\\right) E[\\delta T \\delta p] $$\n根据定义，变量 $x$ 的方差为 $\\sigma_x^2 = E[(\\delta x)^2]$，两个变量 $x$ 和 $y$ 之间的协方差为 $\\sigma_{xy} = E[\\delta x \\delta y]$。协方差通过 $\\sigma_{xy} = r_{xy} \\sigma_x \\sigma_y$ 与相关系数 $r_{xy}$ 以及标准差 $\\sigma_x$ 和 $\\sigma_y$ 相关联。\n\n将这些定义代入展开后的方程，即可得到问题所要求的密度误差方差的具体表达式：\n$$ \\sigma_{\\rho}^2 = \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right)^2 \\sigma_{S_A}^2 + \\left(\\frac{\\partial \\rho}{\\partial T}\\right)^2 \\sigma_T^2 + \\left(\\frac{\\partial \\rho}{\\partial p}\\right)^2 \\sigma_p^2 \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right) \\left(\\frac{\\partial \\rho}{\\partial T}\\right) r_{S_A,T} \\sigma_{S_A} \\sigma_T \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right) \\left(\\frac{\\partial \\rho}{\\partial p}\\right) r_{S_A,p} \\sigma_{S_A} \\sigma_p \\\\ + 2 \\left(\\frac{\\partial \\rho}{\\partial T}\\right) \\left(\\frac{\\partial \\rho}{\\partial p}\\right) r_{T,p} \\sigma_T \\sigma_p $$\n注意，问题中提供的相关系数 $r_{T,S_A}$ 与 $r_{S_A,T}$ 是相同的。\n\n现在我们将给定的数值代入此表达式。已知条件如下：\n偏导数：\n$$ \\left.\\frac{\\partial \\rho}{\\partial S_A}\\right|_{T,p} = 0.78\\ \\mathrm{kg\\,m^{-3}\\,(\\mathrm{g}\\,kg^{-1})^{-1}} $$\n$$ \\left.\\frac{\\partial \\rho}{\\partial T}\\right|_{S_A,p} = -0.25\\ \\mathrm{kg\\,m^{-3}\\,K^{-1}} $$\n$$ \\left.\\frac{\\partial \\rho}{\\partial p}\\right|_{S_A,T} = 0.0043\\ \\mathrm{kg\\,m^{-3}\\,dbar^{-1}} $$\n标准不确定度：\n$$ \\sigma_{S_A} = 0.003\\ \\mathrm{g\\,kg^{-1}} $$\n$$ \\sigma_T = 0.004\\ \\mathrm{K} $$\n$$ \\sigma_p = 0.5\\ \\mathrm{dbar} $$\n相关系数：\n$$ r_{S_A,T} = r_{T,S_A} = 0.20 $$\n$$ r_{T,p} = -0.05 $$\n$$ r_{S_A,p} = 0.10 $$\n\n我们计算方差方程的每一项。所有项的单位都将是 $(\\mathrm{kg\\,m^{-3}})^2$。\n\n方差项（对角贡献）：\n1. 来自 $S_A$ 的贡献：\n$$ \\left(\\frac{\\partial \\rho}{\\partial S_A}\\right)^2 \\sigma_{S_A}^2 = (0.78)^2 (0.003)^2 = (0.6084) \\times (9 \\times 10^{-6}) = 5.4756 \\times 10^{-6} $$\n2. 来自 $T$ 的贡献：\n$$ \\left(\\frac{\\partial \\rho}{\\partial T}\\right)^2 \\sigma_T^2 = (-0.25)^2 (0.004)^2 = (0.0625) \\times (16 \\times 10^{-6}) = 1.0 \\times 10^{-6} $$\n3. 来自 $p$ 的贡献：\n$$ \\left(\\frac{\\partial \\rho}{\\partial p}\\right)^2 \\sigma_p^2 = (0.0043)^2 (0.5)^2 = (1.849 \\times 10^{-5}) \\times (0.25) = 4.6225 \\times 10^{-6} $$\n\n协方差项（非对角贡献）：\n4. 来自 $S_A-T$ 相关的贡献：\n$$ 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\frac{\\partial \\rho}{\\partial T}\\right) r_{S_A,T} \\sigma_{S_A} \\sigma_T = 2 \\times (0.78) \\times (-0.25) \\times (0.20) \\times (0.003) \\times (0.004) \\\\ = 2 \\times (-0.195) \\times (0.20) \\times (1.2 \\times 10^{-5}) = -0.936 \\times 10^{-6} $$\n5. 来自 $S_A-p$ 相关的贡献：\n$$ 2 \\left(\\frac{\\partial \\rho}{\\partial S_A}\\frac{\\partial \\rho}{\\partial p}\\right) r_{S_A,p} \\sigma_{S_A} \\sigma_p = 2 \\times (0.78) \\times (0.0043) \\times (0.10) \\times (0.003) \\times (0.5) \\\\ = 2 \\times (0.003354) \\times (0.10) \\times (0.0015) = 1.0062 \\times 10^{-6} $$\n6. 来自 $T-p$ 相关的贡献：\n$$ 2 \\left(\\frac{\\partial \\rho}{\\partial T}\\frac{\\partial \\rho}{\\partial p}\\right) r_{T,p} \\sigma_T \\sigma_p = 2 \\times (-0.25) \\times (0.0043) \\times (-0.05) \\times (0.004) \\times (0.5) \\\\ = 2 \\times (-0.001075) \\times (-0.05) \\times (0.002) = 0.215 \\times 10^{-6} $$\n\n总方差 $\\sigma_{\\rho}^2$ 是这六项之和：\n$$ \\sigma_{\\rho}^2 = (5.4756 + 1.0 + 4.6225 - 0.936 + 1.0062 + 0.215) \\times 10^{-6}\\ (\\mathrm{kg\\,m^{-3}})^2 \\\\ \\sigma_{\\rho}^2 = 11.3833 \\times 10^{-6}\\ (\\mathrm{kg\\,m^{-3}})^2 $$\n\n密度的标准不确定度 $\\sigma_{\\rho}$ 是方差的平方根：\n$$ \\sigma_{\\rho} = \\sqrt{11.3833 \\times 10^{-6}}\\ \\mathrm{kg\\,m^{-3}} \\\\ \\sigma_{\\rho} \\approx 3.3739146 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}} $$\n\n按要求将结果四舍五入到四位有效数字：\n$$ \\sigma_{\\rho} \\approx 3.374 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}} $$\n该值表示在指定的深海状态下，考虑了传感器测量的不确定度和相关性之后，计算出的原位密度的标准不确定度。",
            "answer": "$$\n\\boxed{3.374 \\times 10^{-3}}\n$$"
        }
    ]
}