{
    "hands_on_practices": [
        {
            "introduction": "箱式模型是理解大规模示踪剂动力学的基础工具，它将复杂的环境系统简化为相互连接的均质区块。本练习通过分析一个概念性的湖泊分层系统，旨在建立对质量平衡核心概念的直观理解 。您将从第一性原理出发，推导控制方程并求解稳态解，从而掌握如何量化源、汇以及内部交换过程对系统总质量的影响。",
            "id": "3870092",
            "problem": "考虑代表分层湖泊中相邻区域的两个充分混合的隔室。设上层箱中的示踪剂质量为 $M_1(t)$，下层箱中的示踪剂质量为 $M_2(t)$，其中 $t$ 是时间。这两个箱体以速率参数 $r$ (单位为 $\\mathrm{s}^{-1}$) 对称地交换质量，这意味着在微小时间间隔 $\\mathrm{d}t$ 内，从箱1转移到箱2的质量为 $r M_1(t) \\mathrm{d}t$，从箱2转移到箱1的质量为 $r M_2(t) \\mathrm{d}t$。每个箱体都有一个外部源 $S_i$ (单位为 $\\mathrm{kg\\,s}^{-1}$)，其中 $i \\in \\{1,2\\}$，以及一个速率为 $k_i$ (单位为 $\\mathrm{s}^{-1}$) 的一阶去除过程，该过程将示踪剂不可逆地从系统中移除（例如，由于化学转化或输出）。假设 $r > 0$, $S_1 \\ge 0$, $S_2 \\ge 0$, $k_1 \\ge 0$ 和 $k_2 \\ge 0$。从质量守恒和交换过程的定义出发，写出 $M_1(t)$ 和 $M_2(t)$ 的控制性常微分方程（ODEs），并解析推导出稳态质量 $M_1^{\\star}$ 和 $M_2^{\\star}$。然后，利用第一性原理，确定在何种参数条件下，组合的双箱系统中的总质量 $M_{\\mathrm{T}}(t) = M_1(t) + M_2(t)$ 是守恒的，即其时间导数由于“没有来自外部强迫的净产生或来自内部移除的净损失”而对所有状态和时间都为零。作为报告，请提供稳态总质量 $M_{\\mathrm{T}}^{\\star}$ 的一个以 $S_1$、$S_2$、$r$、$k_1$ 和 $k_2$ 表示的单闭式解析表达式。无需进行数值四舍五入。在最终表达式中，表示 $M_{\\mathrm{T}}^{\\star}$ 时无需带单位。",
            "solution": "该问题要求推导双隔室系统的控制方程，确定其稳态质量，分析总质量守恒的条件，并给出稳态总质量的表达式。\n\n首先，我们根据质量守恒原理建立控制微分方程。对于任何控制体积，质量的变化率等于所有流入该体积的质量通量之和减去所有流出该体积的质量通量之和。\n\n对于上层箱（隔室1），其质量为 $M_1(t)$。\n流入箱1的通量有：\n1.  外部源：$S_1$\n2.  来自箱2的交换：$r M_2(t)$\n\n流出箱1的通量有：\n1.  去除过程：$k_1 M_1(t)$\n2.  向箱2的交换：$r M_1(t)$\n\n应用质量平衡原理，$M_1(t)$ 的控制性常微分方程（ODE）为：\n$$ \\frac{dM_1}{dt} = S_1 + r M_2(t) - k_1 M_1(t) - r M_1(t) $$\n$$ \\frac{dM_1}{dt} = S_1 + r M_2(t) - (k_1 + r) M_1(t) $$\n\n类似地，对于下层箱（隔室2），其质量为 $M_2(t)$。\n流入箱2的通量有：\n1.  外部源：$S_2$\n2.  来自箱1的交换：$r M_1(t)$\n\n流出箱2的通量有：\n1.  去除过程：$k_2 M_2(t)$\n2.  向箱1的交换：$r M_2(t)$\n\n$M_2(t)$ 的控制性ODE为：\n$$ \\frac{dM_2}{dt} = S_2 + r M_1(t) - k_2 M_2(t) - r M_2(t) $$\n$$ \\frac{dM_2}{dt} = S_2 + r M_1(t) - (k_2 + r) M_2(t) $$\n\n接下来，我们求解稳态质量，记为 $M_1^{\\star}$ 和 $M_2^{\\star}$。在稳态下，质量是恒定的，因此其时间导数为零：$\\frac{dM_1}{dt} = 0$ 和 $\\frac{dM_2}{dt} = 0$。这会得到一个由两个线性代数方程组成的方程组：\n$$ 0 = S_1 + r M_2^{\\star} - (k_1 + r) M_1^{\\star} $$\n$$ 0 = S_2 + r M_1^{\\star} - (k_2 + r) M_2^{\\star} $$\n将其重新排列为标准矩阵形式 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$：\n$$ (k_1 + r) M_1^{\\star} - r M_2^{\\star} = S_1 $$\n$$ -r M_1^{\\star} + (k_2 + r) M_2^{\\star} = S_2 $$\n这可以写成：\n$$ \\begin{pmatrix} k_1+r  -r \\\\ -r  k_2+r \\end{pmatrix} \\begin{pmatrix} M_1^{\\star} \\\\ M_2^{\\star} \\end{pmatrix} = \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix} $$\n为了求解 $M_1^{\\star}$ 和 $M_2^{\\star}$，我们可以使用 Cramer 法则或矩阵求逆。系数矩阵的行列式为：\n$$ D = \\det \\begin{pmatrix} k_1+r  -r \\\\ -r  k_2+r \\end{pmatrix} = (k_1+r)(k_2+r) - (-r)(-r) $$\n$$ D = k_1 k_2 + k_1 r + k_2 r + r^2 - r^2 = k_1 k_2 + r(k_1+k_2) $$\n如果 $D \\neq 0$，则存在唯一的稳态解。给定 $r > 0$，$k_1 \\ge 0$ 和 $k_2 \\ge 0$，$D$ 仅在 $k_1=0$ 和 $k_2=0$ 时为零。我们假设至少有一个去除速率为正，以确保 $D>0$。\n使用 Cramer 法则：\n$$ M_1^{\\star} = \\frac{\\det \\begin{pmatrix} S_1  -r \\\\ S_2  k_2+r \\end{pmatrix}}{D} = \\frac{S_1(k_2+r) - S_2(-r)}{k_1 k_2 + r(k_1+k_2)} = \\frac{S_1(k_2+r) + rS_2}{k_1 k_2 + r(k_1+k_2)} $$\n$$ M_2^{\\star} = \\frac{\\det \\begin{pmatrix} k_1+r  S_1 \\\\ -r  S_2 \\end{pmatrix}}{D} = \\frac{S_2(k_1+r) - S_1(-r)}{k_1 k_2 + r(k_1+k_2)} = \\frac{S_2(k_1+r) + rS_1}{k_1 k_2 + r(k_1+k_2)} $$\n\n第三个任务是确定总质量 $M_{\\mathrm{T}}(t) = M_1(t) + M_2(t)$ 守恒的条件。我们首先通过将 $M_1(t)$ 和 $M_2(t)$ 的ODE相加来求得 $M_{\\mathrm{T}}(t)$ 的ODE：\n$$ \\frac{dM_{\\mathrm{T}}}{dt} = \\frac{dM_1}{dt} + \\frac{dM_2}{dt} = \\left(S_1 + r M_2 - (k_1 + r) M_1\\right) + \\left(S_2 + r M_1 - (k_2 + r) M_2\\right) $$\n$$ \\frac{dM_{\\mathrm{T}}}{dt} = S_1 + S_2 + (r M_2 - r M_2) + (r M_1 - r M_1) - k_1 M_1 - k_2 M_2 $$\n$$ \\frac{dM_{\\mathrm{T}}}{dt} = S_1 + S_2 - k_1 M_1(t) - k_2 M_2(t) $$\n内部交换项 $r M_1$ 和 $r M_2$ 相互抵消，这意味着内部交换过程对于系统的总质量是守恒的。问题要求 $M_{\\mathrm{T}}$ 守恒的条件，这被定义为其时间导数由于“没有来自外部强迫或内部移除的净产生或损失”而为零。这意味着我们必须将 $dM_{\\mathrm{T}}/dt$ 的ODE中的相应项设为零。\n1.  没有来自外部强迫的净产生：$S_1 + S_2 = 0$。由于 $S_1 \\ge 0$ 和 $S_2 \\ge 0$，这要求 $S_1 = 0$ 且 $S_2 = 0$。\n2.  没有来自内部移除的净损失：$k_1 M_1(t) + k_2 M_2(t) = 0$。这必须对所有状态 $(M_1, M_2)$ 和时间都成立。由于 $M_1 \\ge 0$ 和 $M_2 \\ge 0$，且去除速率 $k_1 \\ge 0$ 和 $k_2 \\ge 0$，此方程只有在系数为零，即 $k_1 = 0$ 和 $k_2 = 0$ 时，才对所有非平凡状态成立。\n因此，总质量守恒的参数条件是 $S_1 = S_2 = k_1 = k_2 = 0$。\n\n最后，题目要求我们提供一般情况下的稳态总质量 $M_{\\mathrm{T}}^{\\star} = M_1^{\\star} + M_2^{\\star}$。我们将推导出的 $M_1^{\\star}$ 和 $M_2^{\\star}$ 的表达式相加：\n$$ M_{\\mathrm{T}}^{\\star} = \\frac{S_1(k_2+r) + rS_2}{k_1 k_2 + r(k_1+k_2)} + \\frac{S_2(k_1+r) + rS_1}{k_1 k_2 + r(k_1+k_2)} $$\n$$ M_{\\mathrm{T}}^{\\star} = \\frac{S_1(k_2+r) + rS_2 + S_2(k_1+r) + rS_1}{k_1 k_2 + r(k_1+k_2)} $$\n展开分子：\n$$ \\text{分子} = S_1 k_2 + S_1 r + r S_2 + S_2 k_1 + S_2 r + r S_1 $$\n$$ \\text{分子} = S_1 k_2 + S_2 k_1 + 2rS_1 + 2rS_2 $$\n$$ \\text{分子} = S_1 k_2 + S_2 k_1 + 2r(S_1 + S_2) $$\n所以，稳态总质量为：\n$$ M_{\\mathrm{T}}^{\\star} = \\frac{S_1 k_2 + S_2 k_1 + 2r(S_1 + S_2)}{k_1 k_2 + r(k_1 + k_2)} $$\n这就是稳态下总质量的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{S_1 k_2 + S_2 k_1 + 2r(S_1 + S_2)}{k_1 k_2 + r(k_1 + k_2)}}\n$$"
        },
        {
            "introduction": "在从理想化的箱式模型过渡到由偏微分方程（PDEs）描述的空间连续系统后，本练习将指导您建立一个真正守恒的数值模型。您将推导描述河流地貌演变的Exner方程，并实现一个有限体积格式，该方法在设计上即能保证质量守恒 。此实践的核心是验证数值模型的守恒特性，通过将其全域积分的质量变化与解析解进行比较，这是连接理论与实践的关键一步。",
            "id": "3870147",
            "problem": "一个长度为 $L$ 的一维河段被建模为 $N$ 个等长的有限体积单元，单元宽度为 $\\Delta x = L/N$，河道宽度为单位宽度。河床高程场用 $\\eta(x,t)$ 表示，河床材料的孔隙度为 $\\lambda_p \\in [0,1)$。严格地从应用于一个控制体积的沉积物相质量守恒原理出发，推导此一维背景下的河床演变控制方程（通常称为 Exner 方程）。为了计算，采用一个线性的坡度驱动输沙公式，其中单位宽度的体积推移质输沙率 $q_s(x,t)$ 与负的河床坡度成正比，具体由 $q_s(x,t) = -K \\,\\partial \\eta/\\partial x$ 给出，其中 $K$ 是一个单位为 $\\mathrm{m}^2/\\mathrm{s}$ 的正常数。上游和下游边界的输沙率分别被指定为常数 $q_{\\text{in}}$ 和 $q_{\\text{out}}$。\n\n在这 $N$ 个单元上，实现一个与推导出的控制方程一致的显式有限体积方法。使用单元交界面上的通量 $F_i$（索引从 $i=0$（上游边界界面）到 $i=N$（下游边界界面）），强制施加 $F_0 = q_{\\text{in}}$ 和 $F_N = q_{\\text{out}}$，并根据指定的输沙公式利用相邻单元的高程计算内部界面通量 $F_i$（对于 $i=1,\\dots,N-1$）。选择一个时间步长 $\\Delta t$，使其满足基于 Courant–Friedrichs–Lewy (CFL) 条件的稳定性约束，该约束适用于所得到的扩散型方程的显式离散化；如果 $K=0$，则使用总模拟时间的均匀划分。从一个初始高程剖面 $\\eta(x,0)$ 开始，在总时间 $T$ 内演化河床。\n\n对于每次模拟，计算全域平均河床高程变化 $\\overline{\\Delta \\eta}_{\\text{num}}$，其定义为 $\\eta(x,T)-\\eta(x,0)$ 在 $[0,L]$ 上的空间平均值，并将其与通过对常数边界通量条件下的河床质量平衡控制方程在全域上积分所得到的解析解 $\\overline{\\Delta \\eta}_{\\text{ana}}$ 进行比较。报告每种情况下的绝对误差 $E = |\\overline{\\Delta \\eta}_{\\text{num}} - \\overline{\\Delta \\eta}_{\\text{ana}}|$。\n\n物理单位：\n- $L$ 单位为米 (m)，$T$ 单位为秒 (s)，$K$ 单位为 $\\mathrm{m}^2/\\mathrm{s}$，$q_{\\text{in}}$ 和 $q_{\\text{out}}$ 单位为 $\\mathrm{m}^2/\\mathrm{s}$，$\\eta$ 单位为米 (m)，$E$ 单位为米 (m)。\n- 最终误差以米为单位，表示为浮点数。\n\n初始条件设定：\n- 使用正弦初始河床剖面 $\\eta(x,0) = A \\sin\\left(2\\pi x/L\\right)$，振幅 $A$ 的单位为米，其中 $x$ 是单元中心坐标。\n\n测试组（每个元组为 $(L,N,K,\\lambda_p,T,q_{\\text{in}},q_{\\text{out}},A)$）：\n1. $(100.0, 50, 0.02, 0.40, 10.0, 0.005, 0.002, 0.0)$\n2. $(200.0, 100, 0.05, 0.35, 20.0, 0.004, 0.004, 0.5)$\n3. $(80.0, 80, 0.0, 0.0, 5.0, 0.003, 0.001, 0.3)$\n4. $(150.0, 75, 0.001, 0.90, 15.0, 0.002, 0.0015, 0.1)$\n5. $(50.0, 25, 0.03, 0.60, 1.0, 0.0, 0.0, 0.25)$\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含五个测试用例的误差。误差应表示为用方括号括起来的、以逗号分隔的浮点数列表（例如：\"[e1,e2,e3,e4,e5]\"），列表中的每个 $e_i$ 都四舍五入到六位小数，单位为米。",
            "solution": "用户在环境模拟领域提供了一个表述清晰的问题，该问题基于质量守恒的基本原理。任务是推导一维河床演变的 Exner 方程，实现一个数值解，并验证其守恒特性。该问题在科学上是合理的，内容完整且客观。因此，我将提供一个完整的解答。\n\n### 第1部分：控制方程的推导\n\n推导始于应用于控制体积的沉积物质量守恒原理。考虑一个一维河段，其河床高程由 $\\eta(x,t)$ 给出。河床材料具有恒定的孔隙度 $\\lambda_p$。我们关注的物理量是单位河道宽度的沉积物固体体积。\n\n让我们定义一个控制体积（CV），它覆盖了从 $x$ 到 $x+\\Delta x$ 的一小段河床，并具有单位宽度。此控制体积内河床层的总体积为 $\\eta \\Delta x$。沉积物固体所占的体积是该总体积乘以固体分数 $(1-\\lambda_p)$。因此，控制体积中的沉积物固体体积为 $V_{sed} = (1-\\lambda_p)\\eta\\Delta x$。\n\n质量守恒原理指出，控制体积内沉积物体积的时间变化率必须等于沉积物体积进入控制体积的净速率。\n$$\n\\frac{\\partial V_{sed}}{\\partial t} = \\text{Flux}_{\\text{in}} - \\text{Flux}_{\\text{out}}\n$$\n单位宽度的体积输沙率用 $q_s(x,t)$ 表示。\n- 在界面 $x$ 处进入控制体积的输沙率为 $q_s(x,t)$。\n- 在界面 $x+\\Delta x$ 处离开控制体积的输沙率为 $q_s(x+\\Delta x, t)$。\n\n控制体积的质量平衡方程为：\n$$\n\\frac{\\partial}{\\partial t} \\left[ (1-\\lambda_p) \\eta(x,t) \\Delta x \\right] = q_s(x,t) - q_s(x+\\Delta x, t)\n$$\n假设孔隙度 $\\lambda_p$ 和单元宽度 $\\Delta x$ 是常数，我们可以将其重写为：\n$$\n(1-\\lambda_p) \\Delta x \\frac{\\partial \\eta}{\\partial t} = - [q_s(x+\\Delta x, t) - q_s(x,t)]\n$$\n两边同除以 $\\Delta x$ 得：\n$$\n(1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{q_s(x+\\Delta x, t) - q_s(x,t)}{\\Delta x}\n$$\n在 $\\Delta x \\to 0$ 的极限情况下，右侧变为通量空间导数的负值：\n$$\n(1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{\\partial q_s}{\\partial x}\n$$\n这是一维河床演变 Exner 方程的一般形式。它表明河床高程的变化是对输沙量空间梯度的响应。\n\n问题指定了一个线性的坡度驱动输沙公式：\n$$\nq_s(x,t) = -K \\frac{\\partial \\eta}{\\partial x}\n$$\n其中 $K$ 是一个正的输沙系数。将 $q_s$ 的表达式代入 Exner 方程，得到：\n$$\n(1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left( -K \\frac{\\partial \\eta}{\\partial x} \\right)\n$$\n假设 $K$ 是一个常数，方程简化为一个线性扩散方程：\n$$\n(1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} = K \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n或者，写成标准扩散形式：\n$$\n\\frac{\\partial \\eta}{\\partial t} = D \\frac{\\partial^2 \\eta}{\\partial x^2} \\quad \\text{其中 } D = \\frac{K}{1-\\lambda_p}\n$$\n这就是在给定输沙定律下，控制河床演变的偏微分方程（PDE）。\n\n### 第2部分：数值格式设计\n\n采用显式有限体积法。长度为 $L$ 的区域被离散为 $N$ 个单元，索引为 $j=0, 1, \\dots, N-1$。每个单元的宽度为 $\\Delta x = L/N$。河床高程 $\\eta_j(t)$ 代表单元 $j$ 内的平均高程。\n\n将守恒形式的 Exner 方程 $(1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} = - \\frac{\\partial q_s}{\\partial x}$ 在单元 $j$ 上（从 $x_j - \\Delta x/2$ 到 $x_j + \\Delta x/2$）进行积分：\n$$\n\\int_{x_j-\\Delta x/2}^{x_j+\\Delta x/2} (1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} \\,dx = - \\int_{x_j-\\Delta x/2}^{x_j+\\Delta x/2} \\frac{\\partial q_s}{\\partial x} \\,dx\n$$\n这得到：\n$$\n(1-\\lambda_p) \\Delta x \\frac{d\\eta_j}{dt} = q_s(x_j-\\Delta x/2) - q_s(x_j+\\Delta x/2)\n$$\n设 $F_j$ 为单元 $j$ 左侧界面（单元 $j-1$ 和 $j$ 之间的交界面）的通量，$F_{j+1}$ 为右侧界面（单元 $j$ 和 $j+1$ 之间的交界面）的通量。单元 $j$ 的方程为：\n$$\n\\frac{d\\eta_j}{dt} = \\frac{1}{(1-\\lambda_p)\\Delta x} (F_j - F_{j+1})\n$$\n通量的定义如下：\n- 边界通量：$F_0 = q_{\\text{in}}$ 和 $F_N = q_{\\text{out}}$。\n- 内部通量（$j=1, \\dots, N-1$）：使用中心差分近似计算相邻单元间的坡度来计算通量。单元 $j-1$ 和单元 $j$ 之间交界面上的通量 $F_j$ 为：\n$$\nF_j = -K \\left( \\frac{\\partial \\eta}{\\partial x} \\right)_{\\text{face } j} \\approx -K \\frac{\\eta_j - \\eta_{j-1}}{\\Delta x}\n$$\n使用时间步长为 $\\Delta t$ 的显式向前欧拉格式进行时间积分，时间步 $n$ 处高程 $\\eta_j^n$ 的更新公式为：\n$$\n\\eta_j^{n+1} = \\eta_j^n + \\frac{\\Delta t}{(1-\\lambda_p)\\Delta x} (F_j^n - F_{j+1}^n)\n$$\n完整的模拟过程是：首先基于时间 $n$ 的高程 $\\eta^n$ 计算所有通量 $F_j^n$，然后使用上述公式计算下一时间步的所有高程 $\\eta_j^{n+1}$。\n\n### 第3部分：稳定性和时间步长选择\n\n显式格式是条件稳定的。其背后的偏微分方程是扩散方程，扩散系数为 $D = K/(1-\\lambda_p)$。时间向前空间中心（FTCS）格式的稳定性要求无量纲扩散数小于或等于 $1/2$：\n$$\n\\frac{D \\Delta t}{(\\Delta x)^2} = \\frac{K \\Delta t}{(1-\\lambda_p)(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n这对时间步长施加了一个上限：\n$$\n\\Delta t \\le \\frac{(1-\\lambda_p)(\\Delta x)^2}{2K}\n$$\n为确保稳定性，实现时将基于此 CFL 条件选择时间步长 $\\Delta t$。总模拟时间 $T$ 将被划分为整数个步数，$N_{steps} = \\lceil T / \\Delta t_{max} \\rceil$，其中 $\\Delta t_{max}$ 是稳定性极限。然后，实际使用的时间步长为 $\\Delta t = T / N_{steps}$，以确保模拟在时刻 $T$ 精确结束。如果 $K=0$，扩散项消失，显式格式对任何 $\\Delta t$ 都是稳定的。在这种情况下，按照要求，将 $T$ 均匀划分为足够多的步数。\n\n### 第4部分：解析质量平衡检验\n\n需要验证的量是全域平均河床高程变化。这可以通过将控制偏微分方程在整个区域 $[0,L]$ 上积分来解析推导：\n$$\n\\int_0^L (1-\\lambda_p) \\frac{\\partial \\eta}{\\partial t} \\,dx = - \\int_0^L \\frac{\\partial q_s}{\\partial x} \\,dx\n$$\n假设 $\\lambda_p$ 为常数并应用微积分基本定理：\n$$\n(1-\\lambda_p) \\frac{d}{dt} \\left( \\int_0^L \\eta \\,dx \\right) = -[q_s(L,t) - q_s(0,t)]\n$$\n在边界条件 $q_s(0,t) = q_{\\text{in}}$ 和 $q_s(L,t) = q_{\\text{out}}$ 下，这变为：\n$$\n(1-\\lambda_p) L \\frac{d\\overline{\\eta}}{dt} = q_{\\text{in}} - q_{\\text{out}}\n$$\n其中 $\\overline{\\eta}(t) = \\frac{1}{L}\\int_0^L \\eta(x,t) dx$ 是全域平均高程。\n对时间从 $0$ 积分到 $T$：\n$$\n(1-\\lambda_p) L (\\overline{\\eta}(T) - \\overline{\\eta}(0)) = (q_{\\text{in}} - q_{\\text{out}})T\n$$\n因此，解析的全域平均变化量 $\\overline{\\Delta \\eta}_{\\text{ana}} = \\overline{\\eta}(T) - \\overline{\\eta}(0)$ 为：\n$$\n\\overline{\\Delta \\eta}_{\\text{ana}} = \\frac{(q_{\\text{in}} - q_{\\text{out}})T}{(1-\\lambda_p)L}\n$$\n所实现的有限体积法在构造上是守恒的。因此，从理论上讲，数值计算的平均高程变化 $\\overline{\\Delta \\eta}_{\\text{num}}$ 应与 $\\overline{\\Delta \\eta}_{\\text{ana}}$ 完全相同。所要求的误差 $E = |\\overline{\\Delta \\eta}_{\\text{num}} - \\overline{\\Delta \\eta}_{\\text{ana}}|$ 用作验证该守恒特性是否被正确实现的手段，任何非零值都将归因于浮点运算的精度限制。",
            "answer": "[0.000000,0.000000,0.000000,0.000000,0.000000]"
        },
        {
            "introduction": "在实际的地球系统模型中，多个组分通过复杂的物理和生化过程相互作用，检验质量守恒变得尤为重要和困难。即使每个独立的反应过程在理论上是质量守恒的，数值离散化和耦合也可能引入不易察觉的“质量泄漏”。本练习模拟了这一挑战，要求您基于一个多物种反应输运模型的输出数据，设计一个诊断工具来精确量化这种数值上的不守恒性 ，这是一项评估和改进复杂模型的关键高级技能。",
            "id": "3870088",
            "problem": "考虑一个一维、双单元的有限体积模型，该模型模拟了一个河道段中三种溶解物质（记为 $A$、$B$ 和 $C$）的输运和反应。每种物质都遵循一个由质量守恒推导出的平流-扩散-反应方程。设物质 $i$ 的控制方程为\n$\\frac{\\partial c_{i}}{\\partial t} + \\nabla \\cdot \\boldsymbol{J}_{i} = r_{i}$，\n其中 $c_{i}$ 是质量浓度，$\\boldsymbol{J}_{i}$ 是总通量（平流加扩散），$r_{i}$ 是由反应引起的质量生成率。反应为\n$A + B \\rightleftharpoons C$\n其质量守恒的化学计量关系由两个非负速率密度 $\\rho_{1}$ 和 $\\rho_{2}$（单位为 $\\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$）表示，即\n$r_{A} = -\\rho_{1} + \\rho_{2}$，$r_{B} = -\\rho_{1} + \\rho_{2}$，$r_{C} = 2\\rho_{1} - 2\\rho_{2}$，\n因此逐点满足 $\\sum_{i \\in \\{A,B,C\\}} r_{i} = 0$。\n\n在两个体积相等的单元（$j=1,2$），$V_{1} = V_{2} = 1000\\ \\mathrm{m}^{3}$ 上，使用时间步长 $\\Delta t = 3600\\ \\mathrm{s}$ 进行从时间 $t^{n}$ 到 $t^{n+1} = t^{n} + \\Delta t$ 的有限体积时间更新。令 $M_{i,j}^{n} = V_{j} c_{i,j}^{n}$ 表示在时间 $t^{n}$ 时单元 $j$ 中物质 $i$ 的质量。\n\n你需要通过对各物质方程求和并消除内界面交换来构建一个用于总质量守恒的区域积分诊断量，从而分离出由离散化引起的任何差异。将一个时间步长内的区域质量变化定义为 $\\Delta M_{\\mathrm{tot}} = \\sum_{i}\\sum_{j} \\left(M_{i,j}^{n+1} - M_{i,j}^{n}\\right)$。每种物质在左（$L$）和右（$R$）边界的向外（离开区域）净边界通量率 $F_{i}^{L}$ 和 $F_{i}^{R}$ 在时间步长内为常数，单位为 $\\mathrm{kg}\\ \\mathrm{s}^{-1}$，并约定向外为正。\n\n数据：\n- 单元体积：$V_{1} = V_{2} = 1000\\ \\mathrm{m}^{3}$。\n- 时间步长：$\\Delta t = 3600\\ \\mathrm{s}$。\n- $t^{n}$ 时的浓度：\n  $c_{A,1}^{n} = 1.200\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{A,2}^{n} = 0.800\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，\n  $c_{B,1}^{n} = 0.900\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{B,2}^{n} = 1.300\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，\n  $c_{C,1}^{n} = 0.700\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{C,2}^{n} = 0.600\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$。\n- $t^{n+1}$ 时的浓度：\n  $c_{A,1}^{n+1} = 1.160\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{A,2}^{n+1} = 0.780\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，\n  $c_{B,1}^{n+1} = 0.880\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{B,2}^{n+1} = 1.260\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，\n  $c_{C,1}^{n+1} = 0.690\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，$c_{C,2}^{n+1} = 0.545\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$。\n- 反应速率密度（假设在时间步长内单元恒定）：\n  $\\rho_{1,1} = 0.010\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$，$\\rho_{2,1} = 0.008\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$，\n  $\\rho_{1,2} = 0.006\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$，$\\rho_{2,2} = 0.007\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$。\n- 边界通量率（向外为正）：\n  $F_{A}^{L} = 0.05\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$，$F_{B}^{L} = -0.02\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$，$F_{C}^{L} = 0.00\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$，\n  $F_{A}^{R} = 0.03\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$，$F_{B}^{R} = 0.01\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$，$F_{C}^{R} = -0.02\\ \\mathrm{kg}\\ \\mathrm{s}^{-1}$。\n\n任务：\n1. 从物质守恒定律和每个单元的有限体积平衡方程出发，为单步区域积分的“质量泄漏”诊断量 $L$ 推导一个闭式表达式。$L$ 被定义为未被解释的总质量变化，即实际区域质量变化与由边界通量和反应项之和预测的变化之间的差值。\n2. 使用所提供的数据计算 $L$ 的值。\n\n最终答案以千克为单位，并四舍五入到四位有效数字。",
            "solution": "首先验证该问题，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n- 物质 $i$ 的控制方程：$\\frac{\\partial c_{i}}{\\partial t} + \\nabla \\cdot \\boldsymbol{J}_{i} = r_{i}$。\n- 涉及的物质：$A$, $B$, $C$。\n- 反应化学计量：$A + B \\rightleftharpoons C$。\n- 质量生成率：$r_{A} = -\\rho_{1} + \\rho_{2}$, $r_{B} = -\\rho_{1} + \\rho_{2}$, $r_{C} = 2\\rho_{1} - 2\\rho_{2}$。这些速率确保 $\\sum_{i \\in \\{A,B,C\\}} r_{i} = 0$。\n- 有限体积模型：$2$ 个单元，$j=1,2$。\n- 单元体积：$V_{1} = V_{2} = V = 1000\\ \\mathrm{m}^{3}$。\n- 时间步长：$\\Delta t = 3600\\ \\mathrm{s}$。\n- 物质质量：$M_{i,j}^{n} = V_{j} c_{i,j}^{n}$。\n- 边界通量率（向外为正）：$F_{i}^{L}$, $F_{i}^{R}$，单位为 $\\mathrm{kg}\\ \\mathrm{s}^{-1}$。\n- $t^{n}$ 时的浓度：$c_{A,1}^{n} = 1.200$, $c_{A,2}^{n} = 0.800$, $c_{B,1}^{n} = 0.900$, $c_{B,2}^{n} = 1.300$, $c_{C,1}^{n} = 0.700$, $c_{C,2}^{n} = 0.600$（单位均为 $\\mathrm{kg}\\ \\mathrm{m}^{-3}$）。\n- $t^{n+1}$ 时的浓度：$c_{A,1}^{n+1} = 1.160$, $c_{A,2}^{n+1} = 0.780$, $c_{B,1}^{n+1} = 0.880$, $c_{B,2}^{n+1} = 1.260$, $c_{C,1}^{n+1} = 0.690$, $c_{C,2}^{n+1} = 0.545$（单位均为 $\\mathrm{kg}\\ \\mathrm{m}^{-3}$）。\n- 反应速率密度：$\\rho_{1,1} = 0.010$, $\\rho_{2,1} = 0.008$, $\\rho_{1,2} = 0.006$, $\\rho_{2,2} = 0.007$（单位均为 $\\mathrm{kg}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$）。\n- 边界通量率：$F_{A}^{L} = 0.05$, $F_{B}^{L} = -0.02$, $F_{C}^{L} = 0.00$, $F_{A}^{R} = 0.03$, $F_{B}^{R} = 0.01$, $F_{C}^{R} = -0.02$（单位均为 $\\mathrm{kg}\\ \\mathrm{s}^{-1}$）。\n- 待求诊断量：质量泄漏 $L$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题有科学依据，基于标准的平流-扩散-反应方程及其有限体积离散化。基于质量的反应速率的定义，$r_A+r_B+r_C = (-\\rho_1+\\rho_2) + (-\\rho_1+\\rho_2) + (2\\rho_1-2\\rho_2) = 0$，与化学反应中的质量守恒原理一致。该问题提供了计算所需诊断量的所有必要数据和定义。该问题适定、客观，不含任何科学或逻辑缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 第1部分：质量泄漏诊断量 $L$ 的推导\n\n在一个控制体积 $V_j$ 中，物质 $i$ 的质量守恒由控制偏微分方程在该体积 $V_j$ 上的积分给出：\n$$ \\int_{V_j} \\frac{\\partial c_i}{\\partial t} dV + \\int_{V_j} \\nabla \\cdot \\boldsymbol{J}_i dV = \\int_{V_j} r_i dV $$\n使用散度定理，通量项变为边界 $\\partial V_j$ 上的面积分：\n$$ \\frac{d}{dt} \\int_{V_j} c_i dV + \\oint_{\\partial V_j} \\boldsymbol{J}_i \\cdot \\mathbf{n} dS = \\int_{V_j} r_i dV $$\n在有限体积离散化中，我们考虑单元 $j$ 和时间步长 $\\Delta t = t^{n+1} - t^n$ 上的平均量。单元 $j$ 中物质 $i$ 的质量为 $M_{i,j} = V_j c_{i,j}$。单元 $j$ 和物质 $i$ 的质量平衡的显式时间离散形式为：\n$$ \\frac{M_{i,j}^{n+1} - M_{i,j}^{n}}{\\Delta t} + \\mathcal{F}_{i,j} = V_j r_{i,j} $$\n其中 $\\mathcal{F}_{i,j}$ 是物质 $i$ 通过单元 $j$ 所有界面流出的质量净速率，$r_{i,j}$ 是单元 $j$ 中的平均质量生成率。问题要求一个区域积分的诊断量。我们将此方程对所有物质 $i \\in \\{A, B, C\\}$ 和所有单元 $j \\in \\{1, 2\\}$ 求和：\n$$ \\sum_{i,j} \\frac{M_{i,j}^{n+1} - M_{i,j}^{n}}{\\Delta t} + \\sum_{i,j} \\mathcal{F}_{i,j} = \\sum_{i,j} V_j r_{i,j} $$\n第一项可以使用总区域质量变化的定义重写，即 $\\Delta M_{\\mathrm{tot}} = \\sum_{i,j} (M_{i,j}^{n+1} - M_{i,j}^{n})$。\n通量求和 $\\sum_{i,j} \\mathcal{F}_{i,j}$ 涉及对所有单元的所有界面上的通量进行求和。对于相邻单元之间的内界面，离开一个单元的通量等于进入相邻单元的通量。因此，这些内界面通量在全区域总和中相互抵消。剩下的是区域外部边界上的通量。\n$$ \\sum_{i,j} \\mathcal{F}_{i,j} = \\sum_i (F_i^L + F_i^R) $$\n这个和是离开区域的总质量净速率，符号约定为 $F_i^L$ 和 $F_i^R$ 对于向外通量为正。\n\n反应项求和 $\\sum_{i,j} V_j r_{i,j}$ 可以按单元分组：$\\sum_j V_j (\\sum_i r_{i,j})$。问题陈述反应的化学计量是质量守恒的，即在每一点都有 $\\sum_i r_i = 0$。因此，对于每个单元 $j$，$\\sum_i r_{i,j} = 0$。我们可以用提供的速率定义来验证这一点：\n对于任何单元 $j$，$\\sum_i r_{i,j} = r_{A,j} + r_{B,j} + r_{C,j} = (-\\rho_{1,j} + \\rho_{2,j}) + (-\\rho_{1,j} + \\rho_{2,j}) + (2\\rho_{1,j} - 2\\rho_{2,j}) = 0$。\n因此，总反应对总质量变化的贡献为零：$\\sum_{i,j} V_j r_{i,j} = 0$。\n\n整个区域的理想质量平衡为：\n$$ \\frac{\\Delta M_{\\mathrm{tot}}}{\\Delta t} + \\sum_i (F_i^L + F_i^R) = 0 \\implies \\Delta M_{\\mathrm{tot}} = -\\Delta t \\sum_i (F_i^L + F_i^R) $$\n该方程表明，区域内的总质量变化完全由跨越其边界的质量净输运所平衡。\n\n质量泄漏诊断量 $L$ 定义为未被解释的总质量变化，也就是数值计算的质量平衡的残差。它是实际质量变化减去所有指定物理过程（通量和反应）预测的变化：\n$$ L = \\Delta M_{\\mathrm{tot}} - \\left( -\\Delta t \\sum_i (F_i^L + F_i^R) + \\Delta t \\sum_{i,j} V_j r_{i,j} \\right) $$\n由于总反应项为零：\n$$ L = \\Delta M_{\\mathrm{tot}} + \\Delta t \\sum_{i \\in \\{A,B,C\\}} (F_i^L + F_i^R) $$\n这是质量泄漏诊断量的最终表达式。\n\n### 第2部分：$L$ 的计算\n我们现在使用所提供的数据计算该表达式。\n\n首先，计算实际总质量变化 $\\Delta M_{\\mathrm{tot}}$。\n时间 $t^n$ 的总质量是 $M_{\\mathrm{tot}}^n = \\sum_{i,j} M_{i,j}^{n} = \\sum_{i,j} V_j c_{i,j}^{n}$。由于 $V_1 = V_2 = V = 1000\\ \\mathrm{m}^3$：\n$M_{\\mathrm{tot}}^n = V \\sum_{i,j} c_{i,j}^{n} = 1000 \\times (1.200 + 0.800 + 0.900 + 1.300 + 0.700 + 0.600)$\n$M_{\\mathrm{tot}}^n = 1000 \\times (5.500) = 5500\\ \\mathrm{kg}$。\n\n时间 $t^{n+1}$ 的总质量是 $M_{\\mathrm{tot}}^{n+1} = \\sum_{i,j} M_{i,j}^{n+1} = V \\sum_{i,j} c_{i,j}^{n+1}$：\n$M_{\\mathrm{tot}}^{n+1} = 1000 \\times (1.160 + 0.780 + 0.880 + 1.260 + 0.690 + 0.545)$\n$M_{\\mathrm{tot}}^{n+1} = 1000 \\times (5.315) = 5315\\ \\mathrm{kg}$。\n\n实际总质量变化为：\n$$ \\Delta M_{\\mathrm{tot}} = M_{\\mathrm{tot}}^{n+1} - M_{\\mathrm{tot}}^{n} = 5315 - 5500 = -185\\ \\mathrm{kg} $$\n\n接下来，计算在时间步长 $\\Delta t$ 内通过边界从区域输运出的总质量。\n总向外通量率：\n$$ \\sum_i (F_i^L + F_i^R) = (F_A^L + F_B^L + F_C^L) + (F_A^R + F_B^R + F_C^R) $$\n$$ = (0.05 - 0.02 + 0.00) + (0.03 + 0.01 - 0.02) $$\n$$ = (0.03) + (0.02) = 0.05\\ \\mathrm{kg}\\ \\mathrm{s}^{-1} $$\n输运出的总质量是该速率乘以时间步长 $\\Delta t = 3600\\ \\mathrm{s}$：\n$$ \\Delta t \\sum_i (F_i^L + F_i^R) = 3600\\ \\mathrm{s} \\times 0.05\\ \\mathrm{kg}\\ \\mathrm{s}^{-1} = 180\\ \\mathrm{kg} $$\n\n最后，计算泄漏量 $L$：\n$$ L = \\Delta M_{\\mathrm{tot}} + \\Delta t \\sum_i (F_i^L + F_i^R) $$\n$$ L = -185\\ \\mathrm{kg} + 180\\ \\mathrm{kg} = -5\\ \\mathrm{kg} $$\n$L$ 的负值表示系统损失了 5 kg 质量，而这部分损失无法由指定的向外边界通量来解释。这代表了从 $t^n$ 到 $t^{n+1}$ 的模拟步骤中的一个数值质量损失误差。\n\n按要求四舍五入到四位有效数字，结果为 $-5.000\\ \\mathrm{kg}$。",
            "answer": "$$\\boxed{-5.000}$$"
        }
    ]
}