{
    "hands_on_practices": [
        {
            "introduction": "The continuity equation is, at its heart, a statement of conservation. Before exploring its differential form or complex numerical solutions, it is essential to master the foundational concept of a mass budget. This exercise  puts you in the role of an environmental modeler tasked with accounting for a conserved tracer in a coastal embayment. By meticulously summing all boundary fluxes and internal sources, you will apply the integral form of the continuity equation to predict the total change in mass over time, reinforcing the direct link between physical processes and the system's state.",
            "id": "3921745",
            "problem": "A coastal embayment is idealized as a rectangular control volume with horizontal coordinates $x \\in [0,L]$, $y \\in [0,W]$, and vertical coordinate $z \\in [0,H]$ measured upward from the bed. A conserved dissolved tracer with total mass $M(t)$ is transported across the open lateral boundaries, deposited at the air–sea interface, taken up at the sediment–water interface, and produced within the water column by a volumetric source. All processes are assumed constant in time over the step $[t_{0},t_{0}+\\Delta t]$, spatially uniform where specified, and scientifically consistent.\n\nGeometry and timing:\n- $L = 5000\\,\\mathrm{m}$, $W = 2000\\,\\mathrm{m}$, $H = 15\\,\\mathrm{m}$.\n- $\\Delta t = 2.0\\,\\mathrm{hours}$.\n\nBoundary fluxes and internal sources (sign convention: positive values increase mass inside the domain; negative values decrease it):\n- Time-averaged integrated lateral flux rate across the western open boundary: $F_{\\mathrm{W}} = +1.80 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$.\n- Time-averaged integrated lateral flux rate across the eastern open boundary: $F_{\\mathrm{E}} = -2.10 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$.\n- Uniform deposition flux density over the surface: $q_{\\mathrm{surf}} = +3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, applied over the area $A_{\\mathrm{surf}} = L W$.\n- Uniform uptake flux density at the bed: $q_{\\mathrm{bot}} = -1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, applied over the area $A_{\\mathrm{bot}} = L W$.\n- Volumetric source distribution in the interior: $s(x,y,z) = s_{0}\\,\\bigl[1 + \\alpha\\,(x/L) + \\beta\\,(y/W)\\bigr]\\,(z/H)$ with $s_{0} = 2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\alpha = 0.25$, and $\\beta = -0.10$.\n\nStarting from the fundamental principle of mass conservation and the definitions of flux and source, compute the total mass change $\\Delta M = M(t_{0}+\\Delta t) - M(t_{0})$ over the time step by consistently aggregating the lateral boundary contributions, the surface and bottom fluxes, and the integrated volumetric source. Express the final result in $\\mathrm{kg}$ and round your answer to four significant figures.",
            "solution": "The problem requires the computation of the total change in mass, $\\Delta M$, of a conserved tracer within a specified rectangular control volume over a time interval $\\Delta t$. The governing principle is the law of mass conservation, which can be expressed in its integral form for a control volume $V$. The rate of change of the total mass $M(t)$ within the volume is the sum of all mass fluxes across its boundaries and all internal sources and sinks.\nThe total rate of mass change, $\\frac{dM}{dt}$, is the algebraic sum of the rates from all contributing processes:\n$$ \\frac{dM}{dt} = F_{\\mathrm{lateral}} + F_{\\mathrm{surf/bot}} + S_{\\mathrm{total}} $$\nThe terms on the right-hand side represent the net rate of change due to lateral boundary fluxes, surface and bottom fluxes, and the integrated volumetric source, respectively. The problem specifies a sign convention where positive values correspond to an increase of mass within the domain.\nSince all fluxes and source rates are assumed to be constant over the time step $\\Delta t = t_{0}+\\Delta t - t_{0}$, the total change in mass $\\Delta M = M(t_{0}+\\Delta t) - M(t_{0})$ is calculated by multiplying the constant total rate of change by the duration of the time step:\n$$ \\Delta M = \\left(\\frac{dM}{dt}\\right) \\times \\Delta t $$\nWe proceed by calculating each contribution to the total rate $\\frac{dM}{dt}$.\n\n1. Net Lateral Flux Rate\nThe problem provides the time-averaged integrated mass flux rates across the western and eastern boundaries. The northern and southern boundaries are implicitly considered closed (no flux).\n-   Western boundary flux: $F_{\\mathrm{W}} = +1.80 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\n-   Eastern boundary flux: $F_{\\mathrm{E}} = -2.10 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\nThe net lateral flux rate is the sum of these two contributions:\n$$ F_{\\mathrm{lateral}} = F_{\\mathrm{W}} + F_{\\mathrm{E}} = (1.80 \\times 10^{4}) + (-2.10 \\times 10^{4})\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -0.30 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -3000\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n2. Net Surface and Bottom Flux Rate\nThe fluxes at the air-sea interface (surface) and the sediment-water interface (bottom) are given as flux densities (mass per unit area per unit time). To find the total flux rate, we multiply these densities by the horizontal area over which they act, $A = L \\times W$.\n-   Area: $A = (5000\\,\\mathrm{m})(2000\\,\\mathrm{m}) = 1.0 \\times 10^{7}\\,\\mathrm{m}^2$\n-   Surface deposition flux density: $q_{\\mathrm{surf}} = +3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n-   Bottom uptake flux density: $q_{\\mathrm{bot}} = -1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\nThe total rate of mass change from the surface flux is:\n$$ F_{\\mathrm{surf}} = q_{\\mathrm{surf}} \\times A = (3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{7}\\,\\mathrm{m}^2) = 35.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\nThe total rate of mass change from the bottom flux is:\n$$ F_{\\mathrm{bot}} = q_{\\mathrm{bot}} \\times A = (-1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{7}\\,\\mathrm{m}^2) = -12.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\nThe net flux rate from these two boundaries is:\n$$ F_{\\mathrm{surf/bot}} = F_{\\mathrm{surf}} + F_{\\mathrm{bot}} = 35.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} - 12.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 23.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n3. Integrated Volumetric Source Rate\nThe volumetric source term, $s(x,y,z)$, is spatially variable and must be integrated over the entire control volume $V = LWH = (5000\\,\\mathrm{m})(2000\\,\\mathrm{m})(15\\,\\mathrm{m}) = 1.5 \\times 10^{8}\\,\\mathrm{m}^3$. The total source rate, $S_{\\mathrm{total}}$, is:\n$$ S_{\\mathrm{total}} = \\int_V s(x,y,z) \\,dV = \\int_{0}^{H} \\int_{0}^{W} \\int_{0}^{L} s_{0}\\,\\left[1 + \\alpha\\,\\frac{x}{L} + \\beta\\,\\frac{y}{W}\\right]\\,\\frac{z}{H} \\, dx \\, dy \\, dz $$\nThe integral is separable in $z$ and the $(x,y)$ pair:\n$$ S_{\\mathrm{total}} = \\frac{s_0}{H} \\left( \\int_{0}^{H} z \\, dz \\right) \\left( \\int_{0}^{W} \\int_{0}^{L} \\left(1 + \\frac{\\alpha x}{L} + \\frac{\\beta y}{W}\\right) dx \\, dy \\right) $$\nEvaluating the individual integrals:\n$$ \\int_{0}^{H} z \\, dz = \\left[\\frac{z^2}{2}\\right]_{0}^{H} = \\frac{H^2}{2} $$\n$$ \\int_{0}^{W} \\int_{0}^{L} \\left(1 + \\frac{\\alpha x}{L} + \\frac{\\beta y}{W}\\right) dx \\, dy = \\int_{0}^{W} \\left[x + \\frac{\\alpha x^2}{2L} + \\frac{\\beta y x}{W}\\right]_{x=0}^{x=L} dy = \\int_{0}^{W} \\left(L + \\frac{\\alpha L}{2} + \\frac{\\beta L y}{W}\\right) dy $$\n$$ = \\left[Ly + \\frac{\\alpha L y}{2} + \\frac{\\beta L y^2}{2W}\\right]_{y=0}^{y=W} = LW + \\frac{\\alpha LW}{2} + \\frac{\\beta LW}{2} = LW\\left(1 + \\frac{\\alpha + \\beta}{2}\\right) $$\nCombining the terms, we get:\n$$ S_{\\mathrm{total}} = \\frac{s_0}{H} \\left(\\frac{H^2}{2}\\right) \\left(LW\\left(1 + \\frac{\\alpha + \\beta}{2}\\right)\\right) = \\frac{s_0 LWH}{2} \\left(1 + \\frac{\\alpha + \\beta}{2}\\right) $$\nSubstituting the given values: $s_{0} = 2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $V = LWH = 1.5 \\times 10^{8}\\,\\mathrm{m}^3$, $\\alpha = 0.25$, and $\\beta = -0.10$.\n$$ S_{\\mathrm{total}} = \\frac{(2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1})(1.5 \\times 10^{8}\\,\\mathrm{m}^3)}{2} \\left(1 + \\frac{0.25 - 0.10}{2}\\right) $$\n$$ S_{\\mathrm{total}} = \\frac{3.00}{2} \\left(1 + \\frac{0.15}{2}\\right) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.5 \\times (1 + 0.075) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.5 \\times 1.075 \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.6125\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n4. Total Rate of Mass Change\nThe total rate of mass change is the sum of all calculated components:\n$$ \\frac{dM}{dt} = F_{\\mathrm{lateral}} + F_{\\mathrm{surf/bot}} + S_{\\mathrm{total}} $$\n$$ \\frac{dM}{dt} = (-3000) + (23.0) + (1.6125) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -2975.3875\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n5. Total Mass Change\nThe total change in mass, $\\Delta M$, is obtained by multiplying this rate by the time step, $\\Delta t = 2.0\\,\\mathrm{hours} = 2.0 \\times 3600\\,\\mathrm{s} = 7200\\,\\mathrm{s}$.\n$$ \\Delta M = \\left(\\frac{dM}{dt}\\right) \\times \\Delta t = (-2975.3875\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (7200\\,\\mathrm{s}) = -21422790\\,\\mathrm{kg} $$\nRounding the result to four significant figures as requested:\n$$ \\Delta M \\approx -2.142 \\times 10^{7}\\,\\mathrm{kg} $$",
            "answer": "$$\\boxed{-2.142 \\times 10^{7}}$$"
        },
        {
            "introduction": "Moving from a simple mass budget to a predictive spatial model requires formulating the continuity equation as a partial differential equation (PDE). A PDE is only solvable when paired with a set of boundary conditions that describe how the domain interacts with the outside world. This practice  challenges you to translate physical scenarios at the edge of an estuary—such as river inflows, connections to the open ocean, and impermeable walls—into their precise mathematical classifications: Dirichlet, Neumann, or Robin conditions. Correctly defining these boundaries is a critical step in building any physically meaningful environmental model.",
            "id": "3921748",
            "problem": "An estuarine control volume $\\Omega \\subset \\mathbb{R}^2$ is modeled as a depth-averaged layer with unknown free-surface thickness $h(\\mathbf{x},t)$ and depth-averaged horizontal velocity $\\mathbf{u}(\\mathbf{x},t)$, where $\\mathbf{x}\\in\\Omega$ and $t$ denotes time. Let $\\mathbf{n}$ be the outward unit normal on the boundary $\\partial\\Omega$. The depth-integrated normal volumetric flux density across the boundary is $h\\,\\mathbf{u}\\cdot\\mathbf{n}$, and sources or sinks acting over the interior are represented by an areal rate $w(\\mathbf{x},t)$. Consider the following partition of $\\partial\\Omega$ into disjoint segments with the physical specifications given below. Your task is to classify each segment’s boundary condition for the continuity equation into prescribed flux (Neumann), prescribed thickness (Dirichlet), or mixed (Robin), and to identify the correct physical interpretation of that classification in terms of mass conservation at the boundary.\n\nBoundary segments and physical specifications:\n- $\\Gamma_{\\mathrm{river}}$: A narrow river mouth supplies a time-varying volumetric discharge $Q_r(t)>0$ into $\\Omega$. The cross-sectional geometry is known, and the inflow is controlled upstream so that the total inflow across $\\Gamma_{\\mathrm{river}}$ is fixed as $\\int_{\\Gamma_{\\mathrm{river}}} h\\,\\mathbf{u}\\cdot\\mathbf{n}\\,\\mathrm{d}s = -Q_r(t)$, where the minus sign is consistent with $\\mathbf{n}$ pointing out of $\\Omega$ and inflow pointing in.\n- $\\Gamma_{\\mathrm{res}}$: A short boundary segment abuts a massive reservoir whose free-surface elevation is regulated to a prescribed stage $h_{\\mathrm{res}}(t)$, with the contact engineered so that the estuary’s free surface matches that stage at the interface.\n- $\\Gamma_{\\mathrm{ocean}}$: An open-ocean segment permits exchange with the shelf. Observations indicate that the net exchange flux across this segment is linearly related to the departure of the estuary’s free surface from the offshore free surface $h_{\\mathrm{ext}}(t)$ via a bulk exchange law $h\\,\\mathbf{u}\\cdot\\mathbf{n}=\\lambda\\,[\\,h-h_{\\mathrm{ext}}(t)\\,]$, with a known $\\lambda>0$ having units of velocity.\n- $\\Gamma_{\\mathrm{wall}}$: A rocky headland and engineered seawall confine the flow, with no seepage through. Thus there is no throughflow across this segment.\n- Additional physics: Spatially uniform precipitation $P(t)$ and evaporation $E(t)$ act over the entire surface, contributing a net areal source $w(\\mathbf{x},t)=P(t)-E(t)$ to the interior of $\\Omega$.\n\nWhich option correctly classifies $\\Gamma_{\\mathrm{river}}$, $\\Gamma_{\\mathrm{res}}$, $\\Gamma_{\\mathrm{ocean}}$, and $\\Gamma_{\\mathrm{wall}}$ into Dirichlet, Neumann, or Robin boundary conditions for the continuity equation, and provides the correct physical interpretation in terms of mass fluxes and state variables at the boundary?\n\nA. $\\Gamma_{\\mathrm{river}}$: Neumann, because the total boundary-normal flux $h\\,\\mathbf{u}\\cdot\\mathbf{n}$ is prescribed (equal to $-Q_r(t)$); $\\Gamma_{\\mathrm{res}}$: Dirichlet, because the state $h$ is clamped to $h_{\\mathrm{res}}(t)$ at the boundary; $\\Gamma_{\\mathrm{ocean}}$: Robin, because the boundary-normal flux is proportional to the departure of $h$ from an external stage $h_{\\mathrm{ext}}(t)$; $\\Gamma_{\\mathrm{wall}}$: Neumann with value $0$, because the boundary-normal flux $h\\,\\mathbf{u}\\cdot\\mathbf{n}$ vanishes.\n\nB. $\\Gamma_{\\mathrm{river}}$: Robin, because the inflow can be thought of as driven by an upstream head; $\\Gamma_{\\mathrm{res}}$: Neumann, because imposing a stage eliminates the normal gradient; $\\Gamma_{\\mathrm{ocean}}$: Dirichlet, because $h_{\\mathrm{ext}}(t)$ appears in the relation; $\\Gamma_{\\mathrm{wall}}$: Neumann with value $0$.\n\nC. $\\Gamma_{\\mathrm{river}}$: Dirichlet, because the river stage is controlled; $\\Gamma_{\\mathrm{res}}$: Dirichlet, because $h=h_{\\mathrm{res}}(t)$; $\\Gamma_{\\mathrm{ocean}}$: Neumann, because a time-varying flux is implied; $\\Gamma_{\\mathrm{wall}}$: Dirichlet, because $h$ is constant along a solid wall.\n\nD. $\\Gamma_{\\mathrm{river}}$: Neumann with value $-Q_r(t)$; $\\Gamma_{\\mathrm{res}}$: Robin, because the reservoir imposes a relation between $h$ and flux; $\\Gamma_{\\mathrm{ocean}}$: Neumann, because precipitation and evaporation act like a boundary flux there; $\\Gamma_{\\mathrm{wall}}$: Dirichlet, because the wall fixes $h$ and thus eliminates divergence at the boundary.\n\nChoose the single best option.",
            "solution": "The problem requires the classification of boundary conditions for the depth-averaged continuity equation in an estuarine model. We must first validate the problem statement and then proceed to a solution by analyzing each boundary segment.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Domain:** A 2D control volume $\\Omega \\subset \\mathbb{R}^2$.\n- **State Variables:** Free-surface thickness $h(\\mathbf{x},t)$ and depth-averaged velocity $\\mathbf{u}(\\mathbf{x},t)$.\n- **Boundary:** $\\partial\\Omega$ with outward unit normal vector $\\mathbf{n}$.\n- **Boundary Partition:** $\\partial\\Omega = \\Gamma_{\\mathrm{river}} \\cup \\Gamma_{\\mathrm{res}} \\cup \\Gamma_{\\mathrm{ocean}} \\cup \\Gamma_{\\mathrm{wall}}$, with these segments being disjoint.\n- **Flux Density:** The depth-integrated normal volumetric flux density is $h\\,\\mathbf{u}\\cdot\\mathbf{n}$.\n- **Interior Source/Sink:** An areal rate $w(\\mathbf{x},t)$.\n- **Boundary Conditions:**\n    - On $\\Gamma_{\\mathrm{river}}$: The total flux is prescribed as $\\int_{\\Gamma_{\\mathrm{river}}} h\\,\\mathbf{u}\\cdot\\mathbf{n}\\,\\mathrm{d}s = -Q_r(t)$, with inflow $Q_r(t)>0$.\n    - On $\\Gamma_{\\mathrm{res}}$: The free-surface thickness is prescribed as $h = h_{\\mathrm{res}}(t)$.\n    - On $\\Gamma_{\\mathrm{ocean}}$: The flux density is related to the local thickness by $h\\,\\mathbf{u}\\cdot\\mathbf{n}=\\lambda\\,[\\,h-h_{\\mathrm{ext}}(t)\\,]$, with a known exchange coefficient $\\lambda>0$.\n    - On $\\Gamma_{\\mathrm{wall}}$: There is no throughflow, meaning the normal flux density is zero, $h\\,\\mathbf{u}\\cdot\\mathbf{n}=0$.\n- **Internal Source Specification:** $w(\\mathbf{x},t)=P(t)-E(t)$ for precipitation $P(t)$ and evaporation $E(t)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the shallow water equations, a fundamental and widely used model in environmental and earth system modeling for rivers, estuaries, and coastal oceans. The continuity equation expresses conservation of mass (or volume for an incompressible fluid). The specified boundary conditions represent standard, physically realistic scenarios encountered in applied modeling: prescribed inflow (river), prescribed stage (reservoir), a radiation/relaxation condition (open ocean), and an impermeable boundary (seawall). The problem is scientifically sound.\n- **Well-Posed:** The task is to classify given mathematical expressions, which represent boundary conditions, according to standard mathematical terminology (Dirichlet, Neumann, Robin). This is a well-defined classification problem.\n- **Objective:** The problem is stated using precise mathematical and physical language. The boundary conditions are given as unambiguous equations. The problem is objective.\n- **Flaw Checklist:**\n    1.  **Scientific/Factual Unsoundness:** None. The physics and mathematics are standard for the field.\n    2.  **Non-Formalizable/Irrelevant:** The problem is already formalized and is directly relevant to the topic of the continuity equation in environmental modeling.\n    3.  **Incomplete/Contradictory:** The information provided is sufficient and self-consistent for the classification task.\n    4.  **Unrealistic/Infeasible:** The conditions are idealizations, but they are standard and physically plausible approximations used in real-world models.\n    5.  **Ill-Posed/Poorly Structured:** The question is clear and has a unique answer based on standard definitions.\n    6.  **Pseudo-Profound/Trivial:** The problem is not trivial; it tests the crucial skill of translating physical descriptions into their correct mathematical representations, which is a core concept in computational science and engineering.\n    7.  **Outside Scientific Verifiability:** The classification is verifiable against mathematical definitions.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the solution.\n\n### Solution Derivation\n\nThe governing partial differential equation (PDE) is the depth-averaged continuity equation, which in its conservative form is:\n$$ \\frac{\\partial h}{\\partial t} + \\nabla \\cdot (h\\mathbf{u}) = w $$\nThis is a conservation law for the scalar quantity $h$, the free-surface thickness. The flux vector is $\\mathbf{F} = h\\mathbf{u}$. Boundary conditions are applied to the state variable $h$ or the normal component of its flux, $\\mathbf{F}\\cdot\\mathbf{n} = h\\mathbf{u}\\cdot\\mathbf{n}$, at the boundary $\\partial\\Omega$.\n\nThe classification of boundary conditions for a scalar variable $\\phi$ (here, $\\phi=h$) is as follows:\n- **Dirichlet condition:** The value of the state variable itself is specified on the boundary. Example: $h = f(\\mathbf{x}, t)$.\n- **Neumann condition:** The value of the normal flux is specified on the boundary. For our PDE, this means $h\\mathbf{u}\\cdot\\mathbf{n} = g(\\mathbf{x}, t)$. A zero-flux condition, $h\\mathbf{u}\\cdot\\mathbf{n} = 0$, is a homogeneous Neumann condition.\n- **Robin condition (or mixed condition):** A linear combination of the state variable and its normal flux is specified on the boundary. Example: $a h + b (h\\mathbf{u}\\cdot\\mathbf{n}) = c(\\mathbf{x}, t)$, where $a$ and $b$ are non-zero coefficients.\n\nWe now classify each boundary segment based on these definitions.\n\n- **$\\Gamma_{\\mathrm{river}}$:** The condition is given as $\\int_{\\Gamma_{\\mathrm{river}}} h\\,\\mathbf{u}\\cdot\\mathbf{n}\\,\\mathrm{d}s = -Q_r(t)$. This specifies the total volumetric flux across the segment. To be applied in a PDE model, this integral condition is typically converted into a condition on the flux density $h\\,\\mathbf{u}\\cdot\\mathbf{n}$. For instance, one might assume a particular flux profile across the river mouth, or a uniform flux density $h\\mathbf{u}\\cdot\\mathbf{n} = -Q_r(t)/L_r$, where $L_r$ is the length of $\\Gamma_{\\mathrm{river}}$. In all cases, the quantity being prescribed is the normal flux. This is the definition of a **Neumann** condition. The value of $h$ itself on the boundary is not specified; it is part of the solution.\n\n- **$\\Gamma_{\\mathrm{res}}$:** The condition is $h = h_{\\mathrm{res}}(t)$. This directly specifies the value of the state variable, the free-surface thickness $h$, on the boundary. This is the definition of a **Dirichlet** condition. The flux across this boundary is not prescribed; it is a result of the dynamics that maintain the specified thickness.\n\n- **$\\Gamma_{\\mathrm{ocean}}$:** The condition is $h\\,\\mathbf{u}\\cdot\\mathbf{n} = \\lambda\\,[\\,h-h_{\\mathrm{ext}}(t)\\,]$, where $\\lambda>0$. This can be rearranged as $(h\\,\\mathbf{u}\\cdot\\mathbf{n}) - \\lambda h = -\\lambda h_{\\mathrm{ext}}(t)$. This equation provides a linear relationship between the normal flux, $h\\,\\mathbf{u}\\cdot\\mathbf{n}$, and the state variable, $h$, at the boundary. This is the definition of a **Robin** condition.\n\n- **$\\Gamma_{\\mathrm{wall}}$:** The condition is stated as no throughflow, which translates mathematically to $h\\,\\mathbf{u}\\cdot\\mathbf{n}=0$. This specifies that the normal flux is zero. This is a specific case of a **Neumann** condition, known as a homogeneous Neumann condition.\n\nThe internal source term $w(\\mathbf{x},t) = P(t) - E(t)$ affects the mass balance in the interior of $\\Omega$ but is not a boundary condition.\n\n### Option-by-Option Analysis\n\n- **A. $\\Gamma_{\\mathrm{river}}$: Neumann, because the total boundary-normal flux $h\\,\\mathbf{u}\\cdot\\mathbf{n}$ is prescribed (equal to $-Q_r(t)$); $\\Gamma_{\\mathrm{res}}$: Dirichlet, because the state $h$ is clamped to $h_{\\mathrm{res}}(t)$ at the boundary; $\\Gamma_{\\mathrm{ocean}}$: Robin, because the boundary-normal flux is proportional to the departure of $h$ from an external stage $h_{\\mathrm{ext}}(t)$; $\\Gamma_{\\mathrm{wall}}$: Neumann with value $0$, because the boundary-normal flux $h\\,\\mathbf{u}\\cdot\\mathbf{n}$ vanishes.**\n    This option correctly classifies all four boundary segments. The reasoning given for each classification aligns perfectly with the definitions and our analysis above.\n    - $\\Gamma_{\\mathrm{river}}$ is correctly identified as Neumann because the flux is prescribed.\n    - $\\Gamma_{\\mathrm{res}}$ is correctly identified as Dirichlet because the state variable $h$ is prescribed.\n    - $\\Gamma_{\\mathrm{ocean}}$ is correctly identified as Robin because the flux is linearly related to the state variable $h$.\n    - $\\Gamma_{\\mathrm{wall}}$ is correctly identified as a zero-flux Neumann condition.\n    **Verdict: Correct.**\n\n- **B. $\\Gamma_{\\mathrm{river}}$: Robin, because the inflow can be thought of as driven by an upstream head; $\\Gamma_{\\mathrm{res}}$: Neumann, because imposing a stage eliminates the normal gradient; $\\Gamma_{\\mathrm{ocean}}$: Dirichlet, because $h_{\\mathrm{ext}}(t)$ appears in the relation; $\\Gamma_{\\mathrm{wall}}$: Neumann with value $0$.**\n    - The classification of $\\Gamma_{\\mathrm{river}}$ is incorrect. The problem *prescribes the flux*, which is a Neumann condition, not a Robin condition that would relate flux to head.\n    - The classification of $\\Gamma_{\\mathrm{res}}$ is incorrect. Prescribing the state variable ($h$) is a Dirichlet condition, not Neumann.\n    - The classification of $\\Gamma_{\\mathrm{ocean}}$ is incorrect. The condition is not $h=h_{\\mathrm{ext}}(t)$ (Dirichlet); it is a relation between flux and $h$ (Robin).\n    **Verdict: Incorrect.**\n\n- **C. $\\Gamma_{\\mathrm{river}}$: Dirichlet, because the river stage is controlled; $\\Gamma_{\\mathrm{res}}$: Dirichlet, because $h=h_{\\mathrm{res}}(t)$; $\\Gamma_{\\mathrm{ocean}}$: Neumann, because a time-varying flux is implied; $\\Gamma_{\\mathrm{wall}}$: Dirichlet, because $h$ is constant along a solid wall.**\n    - The classification of $\\Gamma_{\\mathrm{river}}$ is incorrect. The problem specifies a controlled discharge (flux), not stage ($h$).\n    - The classification of $\\Gamma_{\\mathrm{ocean}}$ is incorrect. The flux is not prescribed independently of the solution; it depends on $h$, making it a Robin condition, not Neumann.\n    - The classification of $\\Gamma_{\\mathrm{wall}}$ is incorrect. A wall imposes a no-flux condition (Neumann), not a condition on the water level $h$ (Dirichlet).\n    **Verdict: Incorrect.**\n\n- **D. $\\Gamma_{\\mathrm{river}}$: Neumann with value $-Q_r(t)$; $\\Gamma_{\\mathrm{res}}$: Robin, because the reservoir imposes a relation between $h$ and flux; $\\Gamma_{\\mathrm{ocean}}$: Neumann, because precipitation and evaporation act like a boundary flux there; $\\Gamma_{\\mathrm{wall}}$: Dirichlet, because the wall fixes $h$ and thus eliminates divergence at the boundary.**\n    - The classification of $\\Gamma_{\\mathrm{res}}$ is incorrect. The problem states $h$ is prescribed, which is Dirichlet, not Robin.\n    - The classification of $\\Gamma_{\\mathrm{ocean}}$ is incorrect. The reasoning is flawed; precipitation and evaporation are internal sources, not boundary fluxes. The condition as stated is Robin.\n    - The classification of $\\Gamma_{\\mathrm{wall}}$ is incorrect. The wall sets the normal flux to zero (Neumann), it does not fix $h$ (Dirichlet).\n    **Verdict: Incorrect.**\n\nOnly option A provides the correct classification for all four boundary segments with the correct physical and mathematical interpretations.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a model is formulated as a PDE with appropriate boundary conditions, the next challenge is to solve it numerically. This involves discretizing the continuous equations, a process that can introduce unexpected artifacts. This exercise  provides a hands-on demonstration of a classic problem in computational fluid dynamics: the loss of monotonicity. You will see how a higher-order numerical scheme, while being perfectly conservative, can generate non-physical oscillations (overshoots and undershoots), and you will explore the principles behind flux limiters, which are designed to prevent these errors.",
            "id": "3921743",
            "problem": "Consider a one-dimensional conservative tracer $c(x,t)$ advected in a straight channel by a constant, positive velocity $u>0$. The governing law is the continuity equation for a passive tracer advected by a known flow, which states that the rate of change of the tracer within any fixed control volume equals the net advective flux into that volume. For a uniform mesh of $N$ cells of width $\\Delta x$, with cell averages $c_i^n$ at time $t^n$, the finite-volume update is obtained by integrating the continuity equation over each cell and applying the divergence theorem to write the change as the difference of fluxes across the cell faces. Denote the face fluxes by $F_{i+1/2}^n$, and consider the explicit update $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$, where the advective flux $F_{i+1/2}^n$ is approximated as $F_{i+1/2}^n = u\\,c_{i+1/2}^n$ for $u>0$, with $c_{i+1/2}^n$ a reconstruction of the face value from neighboring cell averages.\n\nLet the mesh have $N=4$ interior cells indexed by $i=1,2,3,4$, with zero inflow and outflow through the domain boundaries at faces $x_{1/2}$ and $x_{9/2}$, so $F_{1/2}^n=F_{9/2}^n=0$. Consider the following un-limited upwind-biased second-order reconstruction for $u>0$:\n$$\nc_{i+1/2}^n \\equiv c_i^n + \\frac{1}{2}\\left(c_i^n - c_{i-1}^n\\right), \\quad \\text{for } i=1,2,3,4,\n$$\nwith the understanding that at the left boundary the reconstruction reduces to $c_{1/2}^n=0$ because $c_0^n=0$ and there is no inflow.\n\nSuppose the initial data at time $t^n$ are $c_1^n=0$, $c_2^n=1$, $c_3^n=0$, $c_4^n=0$, and choose a Courant number $\\nu=u\\Delta t/\\Delta x=0.6$. Using the above finite-volume update with $F_{i+1/2}^n = u\\,c_{i+1/2}^n$, compute the one-step update $c_i^{n+1}$ for $i=1,2,3,4$. Based on the results and the governing principles of conservation and monotonicity for advective transport, select all statements that are correct:\n\nA. The described upwind-biased reconstruction leads to a conservative update of the total tracer mass but can generate new extrema (overshoot and undershoot) from the given initial condition for $\\nu=0.6$.\n\nB. Because the update is expressed as a flux difference across each cell, values outside the initial range $\\left[0,1\\right]$ cannot be introduced; monotonicity is automatically preserved.\n\nC. Introducing a flux limiter within a Monotonic Upwind Scheme for Conservation Laws (MUSCL) that enforces $c_{i+1/2}^n \\in \\left[\\min\\left(c_{i-1}^n,c_i^n\\right),\\max\\left(c_{i-1}^n,c_i^n\\right)\\right]$ at every face for $u>0$ can maintain boundedness (no new overshoot or undershoot) for $0<\\nu\\le 1$ while preserving conservation through the finite-volume flux-difference update.\n\nD. Flux limiters necessarily break conservation because they alter the flux values at each face in a way that is different for the left and right neighboring cells.\n\nE. A Total Variation Diminishing (TVD) limiter can be constructed so that, for $0<\\nu<1$, the scheme is second-order accurate in smooth regions and reverts to first-order near extrema, thereby preventing spurious oscillations while conserving tracer mass.\n\nSelect all correct options.",
            "solution": "The user has provided a problem concerning the numerical solution of a one-dimensional advection equation using a finite-volume method. I will first validate the problem statement and then proceed to a full solution and evaluation of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Governing Law:** One-dimensional advection of a conservative tracer $c(x,t)$ with a constant, positive velocity $u>0$. The governing principle is the continuity equation.\n-   **Numerical Method:** Finite-volume scheme on a uniform mesh of $N=4$ cells of width $\\Delta x$.\n-   **Update Formula:** $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$, for cells $i=1,2,3,4$.\n-   **Flux Formula:** $F_{i+1/2}^n = u\\,c_{i+1/2}^n$.\n-   **Boundary Conditions:** Zero inflow and outflow, specified as $F_{1/2}^n=0$ and $F_{9/2}^n=0$. These correspond to the fluxes at the leftmost and rightmost boundaries of the domain.\n-   **Reconstruction Scheme:** An un-limited, upwind-biased, second-order reconstruction for $u>0$ is given by $c_{i+1/2}^n \\equiv c_i^n + \\frac{1}{2}\\left(c_i^n - c_{i-1}^n\\right)$, for $i=1,2,3,4$.\n-   **Boundary Data for Reconstruction:** A ghost cell value $c_0^n=0$ is provided for the reconstruction at the left boundary.\n-   **Initial Conditions:** At time $t^n$, the cell averages are $c_1^n=0$, $c_2^n=1$, $c_3^n=0$, $c_4^n=0$.\n-   **Courant Number:** $\\nu \\equiv u\\Delta t/\\Delta x = 0.6$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard topic in computational fluid dynamics and numerical analysis for hyperbolic partial differential equations. The terms and methods (finite volume, continuity equation, upwind reconstruction, Courant number) are well-established.\n\nThe problem is well-posed. It provides all necessary components for a unique calculation: the update equation, the flux calculation method, initial data, boundary conditions, and all relevant parameters.\n\nThe problem is objective and uses precise, formal language.\n\nLet us check for consistency. The finite-volume update for $N=4$ cells requires fluxes $F_{1/2}^n, F_{3/2}^n, F_{5/2}^n, F_{7/2}^n, F_{9/2}^n$. The boundary conditions explicitly set $F_{1/2}^n=0$ and $F_{9/2}^n=0$. The remaining interior fluxes, $F_{3/2}^n, F_{5/2}^n, F_{7/2}^n$, must be computed using the reconstruction. The reconstruction formula is given for $i=1,2,3,4$, which would define $c_{3/2}^n, c_{5/2}^n, c_{7/2}^n, c_{9/2}^n$. For the right boundary flux $F_{9/2}^n$, the reconstruction for $i=4$ gives $c_{9/2}^n = c_4^n + \\frac{1}{2}(c_4^n-c_3^n)$. With the given initial data ($c_3^n=0, c_4^n=0$), this yields $c_{9/2}^n=0$, which implies $F_{9/2}^n=0$. This is consistent with the stated boundary condition. For the left boundary, reconstruction for $i=1$ gives $c_{3/2}^n$, which requires $c_0^n$. The problem provides $c_0^n=0$. All information is self-consistent and complete.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. I will proceed with the derivation of the solution.\n\n### Solution Derivation\n\nThe task is first to compute the one-step update $c_i^{n+1}$ for $i=1,2,3,4$ and then evaluate the propositions.\n\n**1. Calculation of the one-step update $c_i^{n+1}$**\n\nThe finite-volume update formula can be written in terms of the Courant number $\\nu = u\\Delta t/\\Delta x$ as:\n$$c_i^{n+1} = c_i^n - \\nu \\left( \\frac{F_{i+1/2}^n}{u} - \\frac{F_{i-1/2}^n}{u} \\right) = c_i^n - \\nu \\left(c_{i+1/2}^n - c_{i-1/2}^n\\right)$$\n\nFirst, we must compute the reconstructed values at the cell faces, $c_{i+1/2}^n$, using the given initial data: $c_0^n=0$ (ghost cell), $c_1^n=0$, $c_2^n=1$, $c_3^n=0$, $c_4^n=0$.\n\n-   **Face $i=1/2$ (Left Boundary):** The boundary condition is $F_{1/2}^n=0$, which implies $c_{1/2}^n=0$.\n-   **Face $i=3/2$:** Using the reconstruction formula for $i=1$:\n    $$c_{3/2}^n = c_1^n + \\frac{1}{2}\\left(c_1^n - c_0^n\\right) = 0 + \\frac{1}{2}(0 - 0) = 0$$\n-   **Face $i=5/2$:** Using the reconstruction formula for $i=2$:\n    $$c_{5/2}^n = c_2^n + \\frac{1}{2}\\left(c_2^n - c_1^n\\right) = 1 + \\frac{1}{2}(1 - 0) = 1.5$$\n-   **Face $i=7/2$:** Using the reconstruction formula for $i=3$:\n    $$c_{7/2}^n = c_3^n + \\frac{1}{2}\\left(c_3^n - c_2^n\\right) = 0 + \\frac{1}{2}(0 - 1) = -0.5$$\n-   **Face $i=9/2$ (Right Boundary):** The boundary condition is $F_{9/2}^n=0$, which implies $c_{9/2}^n=0$. As noted during validation, the reconstruction for $i=4$ yields $c_{9/2}^n=c_4^n+\\frac{1}{2}(c_4^n-c_3^n)=0+\\frac{1}{2}(0-0)=0$, which is consistent.\n\nNow, we compute the updated cell averages $c_i^{n+1}$ using $\\nu=0.6$:\n-   **Cell $i=1$:**\n    $$c_1^{n+1} = c_1^n - \\nu(c_{3/2}^n - c_{1/2}^n) = 0 - 0.6(0 - 0) = 0$$\n-   **Cell $i=2$:**\n    $$c_2^{n+1} = c_2^n - \\nu(c_{5/2}^n - c_{3/2}^n) = 1 - 0.6(1.5 - 0) = 1 - 0.9 = 0.1$$\n-   **Cell $i=3$:**\n    $$c_3^{n+1} = c_3^n - \\nu(c_{7/2}^n - c_{5/2}^n) = 0 - 0.6(-0.5 - 1.5) = 0 - 0.6(-2.0) = 1.2$$\n-   **Cell $i=4$:**\n    $$c_4^{n+1} = c_4^n - \\nu(c_{9/2}^n - c_{7/2}^n) = 0 - 0.6(0 - (-0.5)) = 0 - 0.6(0.5) = -0.3$$\n\nThe updated state is $(c_1^{n+1}, c_2^{n+1}, c_3^{n+1}, c_4^{n+1}) = (0, 0.1, 1.2, -0.3)$.\n\n**2. Evaluation of the Options**\n\nThe initial data $c^n$ are in the range $[0, 1]$. The updated data $c^{n+1}$ have a maximum of $1.2$ and a minimum of $-0.3$. This shows the generation of new extrema: an overshoot (a value greater than the initial maximum) and an undershoot (a value less than the initial minimum).\n\nLet's check for conservation of total mass, $M = \\sum_i c_i \\Delta x$.\n-   Initial total mass: $M^n = (c_1^n + c_2^n + c_3^n + c_4^n)\\Delta x = (0+1+0+0)\\Delta x = 1\\Delta x$.\n-   Final total mass: $M^{n+1} = (c_1^{n+1} + c_2^{n+1} + c_3^{n+1} + c_4^{n+1})\\Delta x = (0 + 0.1 + 1.2 - 0.3)\\Delta x = 1\\Delta x$.\nThe total mass is conserved. This is expected from the finite-volume \"flux-difference\" form, $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)(F_{i+1/2}^n - F_{i-1/2}^n)$, with zero-flux boundary conditions, because the sum of the updates is a telescoping series that results in the net flux through the domain boundaries: $\\sum_i (F_{i+1/2}^n - F_{i-1/2}^n) = F_{N+1/2}^n - F_{1/2}^n$. Here, this is $F_{9/2}^n - F_{1/2}^n = 0-0=0$.\n\nNow we evaluate each option.\n\n**A. The described upwind-biased reconstruction leads to a conservative update of the total tracer mass but can generate new extrema (overshoot and undershoot) from the given initial condition for $\\nu=0.6$.**\nOur calculations confirm both parts of this statement. The total mass is conserved ($1\\Delta x$ before and after). New extrema are generated ($c_3^{n+1}=1.2 > 1$ and $c_4^{n+1}=-0.3 < 0$). This behavior is characteristic of unlimited second-order linear schemes like the one described (which is the Beam-Warming scheme).\n**Verdict: Correct.**\n\n**B. Because the update is expressed as a flux difference across each cell, values outside the initial range $\\left[0,1\\right]$ cannot be introduced; monotonicity is automatically preserved.**\nThe premise \"the update is expressed as a flux difference\" is true and guarantees conservation. However, the conclusion \"monotonicity is automatically preserved\" is false. Our direct calculation provides a counterexample, where values of $1.2$ and $-0.3$ were generated from an initial condition in the range $[0, 1]$. Higher-order linear schemes are generally not monotonicity-preserving.\n**Verdict: Incorrect.**\n\n**C. Introducing a flux limiter within a Monotonic Upwind Scheme for Conservation Laws (MUSCL) that enforces $c_{i+1/2}^n \\in \\left[\\min\\left(c_{i-1}^n,c_i^n\\right),\\max\\left(c_{i-1}^n,c_i^n\\right)\\right]$ at every face for $u>0$ can maintain boundedness (no new overshoot or undershoot) for $0<\\nu\\le 1$ while preserving conservation through the finite-volume flux-difference update.**\nThis statement describes the core purpose and functionality of MUSCL-type schemes with flux limiters.\n-   **Conservation:** As long as a single, consistent flux value $F_{i+1/2}^n$ is defined at each face and used for the cells to its left and right, the flux-difference formulation ensures conservation. Flux limiters are designed to work this way.\n-   **Boundedness/Monotonicity:** The purpose of a flux limiter is to adjust the higher-order reconstruction (like the one in this problem) towards a first-order, monotone reconstruction near sharp gradients or extrema. This prevents the formation of new extrema. The condition stated, $c_{i+1/2}^n \\in [\\min(c_{i-1}^n, c_i^n), \\max(c_{i-1}^n, c_i^n)]$, is a form of local constraint on the reconstruction to ensure non-oscillatory behavior. Appropriately designed limiters guarantee the scheme is Total Variation Diminishing (TVD) for a Courant number range like $0<\\nu\\le 1$, which implies boundedness. The statement that this \"can\" be done is correct.\n**Verdict: Correct.**\n\n**D. Flux limiters necessarily break conservation because they alter the flux values at each face in a way that is different for the left and right neighboring cells.**\nThis statement is fundamentally incorrect. The principle of a conservative finite-volume scheme is that the flux leaving one cell is exactly the flux entering the next. Flux limiters operate by computing a single, limited reconstructed value $c_{i+1/2}^n$ at the face, which defines a single flux value $F_{i+1/2}^n$. This same value is used as an outflow for cell $i$ and an inflow for cell $i+1$. The statement's reasoning is flawed; the limiter does not create two different flux values at the same face. Thus, conservation is preserved.\n**Verdict: Incorrect.**\n\n**E. A Total Variation Diminishing (TVD) limiter can be constructed so that, for $0<\\nu<1$, the scheme is second-order accurate in smooth regions and reverts to first-order near extrema, thereby preventing spurious oscillations while conserving tracer mass.**\nThis is a comprehensive and accurate description of modern high-resolution TVD schemes.\n-   **Conservation:** As explained for C and D, the scheme remains conservative.\n-   **Accuracy:** By design, TVD limiters are inactive (e.g., the limiter function $\\phi \\approx 1$) in smooth regions of the solution, allowing the scheme to achieve its underlying second-order accuracy. Near extrema, the limiter becomes active ($\\phi \\to 0$), reducing the scheme to the robust (but dissipative) first-order upwind scheme.\n-   **Oscillation Prevention:** The TVD property, $TV(c^{n+1}) \\le TV(c^n)$, where $TV$ is the total variation $\\sum_i |c_{i+1}-c_i|$, mathematically guarantees that no new local extrema can form and existing ones are not amplified. This prevents spurious oscillations.\n-   **CFL Condition:** The TVD property for such explicit schemes is conditional on the Courant number being less than or equal to $1$.\nThe statement correctly summarizes all these key features.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}