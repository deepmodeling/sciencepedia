{
    "hands_on_practices": [
        {
            "introduction": "本练习是环境系统建模中的一个经典范例，要求您从基本物理原理出发，推导并求解一个实际问题。您将综合运用质量守恒定律和达西定律，在Dupuit-Forchheimer近似下，为稳定的无承压含水层推导出控制方程。通过求解这个二阶常微分方程并应用给定的边界条件，您将能够分析地下水位的剖面形态，这对于水资源管理和污染物迁移研究至关重要。",
            "id": "3883626",
            "problem": "考虑一个在稳定流状态下，沿水平坐标 $x$ 在区间 $[0,L]$ 上延伸的非承压含水层。该系统是一维（1D）的，并以恒定速率 $R0$ 接受均匀的面状补给（累积）。假设 Dupuit–Forchheimer (DF) 近似（垂直水力梯度可忽略不计，水流主要为水平方向）和达西定律成立。令 $H(x)$ 表示从不透水基底量起的含水层饱和厚度，令 $q(x)$ 表示沿 $+x$ 方向的单宽流量（单位宽度的体积通量）。水力传导系数 $K$ 是常数。两条河流将边界处的水位固定，施加狄利克雷条件 $H(0)=H_{0}0$ 和 $H(L)=H_{L}0$。\n\n从稳定状态下的局部质量平衡和仅在 DF 近似下的达西定律出发，推导控制方程，并求解与这些边界条件一致的水位剖面 $H(x)$。请将最终答案表示为关于 $x, L, K, R, H_{0}, H_{L}$ 的单个 $H(x)$ 的闭式解析表达式。无需进行数值计算。",
            "solution": "该问题是有效的，因为它具有水文地质学原理的科学依据，在数学上是适定的，并且是一个标准边值问题的客观陈述。我们可以开始推导求解。\n\n推导始于稳定状态下的质量守恒原理。考虑含水层的一个一维控制体，其沿 $x$ 轴的无穷小长度为 $dx$，宽度为单位宽度。水流由单宽流量 $q(x)$ 控制，该流量表示单位时间内流经 $x$ 处横截面的水量。含水层以速率 $R$ 接受均匀的面状补给，其单位为体积/单位面积/单位时间。对于我们这个单位宽度的一维系统，该补给为控制体贡献了一个源项 $R \\cdot dx$。\n\n控制体的稳态质量平衡方程为：\n$$ \\text{流入} + \\text{源} = \\text{流出} $$\n$$ q(x) + R \\, dx = q(x+dx) $$\n整理各项，我们得到：\n$$ q(x+dx) - q(x) = R \\, dx $$\n两边同除以 $dx$ 并取 $dx \\to 0$ 的极限，得到质量守恒方程的微分形式：\n$$ \\frac{dq}{dx} = R $$\n该方程表明，单宽流量沿流径的变化率等于补给速率。\n\n接下来，我们应用经 Dupuit-Forchheimer (DF) 近似修正的达西定律。DF 近似假设水流基本是水平的，因此在任何点 $x$ 的水头 $h$ 可视为等于含水层的饱和厚度 $H(x)$。因此，$h(x) = H(x)$。\n\n根据达西定律，比流量（含水层单位面积的通量），我们称之为 $q'$，由下式给出：\n$$ q'(x) = -K \\frac{dh}{dx} = -K \\frac{dH}{dx} $$\n其中 $K$ 是恒定的水力传导系数。问题陈述中的量 $q(x)$ 是单宽流量，即达西通量 $q'(x)$ 在饱和厚度 $H(x)$ 上的积分：\n$$ q(x) = q'(x) \\cdot H(x) = \\left(-K \\frac{dH}{dx}\\right) H(x) = -K H(x) \\frac{dH}{dx} $$\n使用链式法则恒等式 $\\frac{d}{dx}(H^2) = 2H \\frac{dH}{dx}$，这个表达式可以更方便地写为：\n$$ q(x) = -\\frac{K}{2} \\frac{d}{dx}\\left(H(x)^2\\right) $$\n\n现在，我们将 $q(x)$ 的这个表达式代入质量守恒方程 $\\frac{dq}{dx} = R$：\n$$ \\frac{d}{dx} \\left(-\\frac{K}{2} \\frac{d}{dx}\\left(H(x)^2\\right)\\right) = R $$\n由于 $K$ 是常数，我们可以将其移到导数外面：\n$$ -\\frac{K}{2} \\frac{d^2}{dx^2}\\left(H(x)^2\\right) = R $$\n这是关于 $H(x)^2$ 的控制性二阶常微分方程。我们定义一个新变量 $Y(x) = H(x)^2$。方程变为：\n$$ \\frac{d^2Y}{dx^2} = -\\frac{2R}{K} $$\n这是一个简单的线性常微分方程，可以通过直接积分求解。对 $x$ 积分一次得到：\n$$ \\frac{dY}{dx} = -\\frac{2R}{K}x + C_1 $$\n其中 $C_1$ 是一个积分常数。再次积分得到 $Y(x)$ 的通解：\n$$ Y(x) = -\\frac{R}{K}x^2 + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。代回 $Y(x) = H(x)^2$：\n$$ H(x)^2 = -\\frac{R}{K}x^2 + C_1 x + C_2 $$\n\n常数 $C_1$ 和 $C_2$ 通过应用给定的狄利克雷边界条件来确定：$H(0) = H_0$ 和 $H(L) = H_L$。用 $Y(x)$ 表示，即为 $Y(0) = H_0^2$ 和 $Y(L) = H_L^2$。\n\n应用 $x=0$ 处的第一个边界条件：\n$$ Y(0) = H_0^2 = -\\frac{R}{K}(0)^2 + C_1(0) + C_2 $$\n这立即得出 $C_2 = H_0^2$。现在的解形式为：\n$$ H(x)^2 = -\\frac{R}{K}x^2 + C_1 x + H_0^2 $$\n\n应用 $x=L$ 处的第二个边界条件：\n$$ Y(L) = H_L^2 = -\\frac{R}{K}L^2 + C_1 L + H_0^2 $$\n我们求解该方程以得到 $C_1$：\n$$ C_1 L = H_L^2 - H_0^2 + \\frac{R}{K}L^2 $$\n$$ C_1 = \\frac{H_L^2 - H_0^2}{L} + \\frac{RL}{K} $$\n\n最后，我们将 $C_1$ 和 $C_2$ 的表达式代回 $H(x)^2$ 的通解中：\n$$ H(x)^2 = -\\frac{R}{K}x^2 + \\left(\\frac{H_L^2 - H_0^2}{L} + \\frac{RL}{K}\\right)x + H_0^2 $$\n为了得到一个更有条理的表达式，我们可以对各项进行分组：\n$$ H(x)^2 = H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{RL}{K}x - \\frac{R}{K}x^2 $$\n$$ H(x)^2 = H_0^2 + \\left(\\frac{H_L^2 - H_0^2}{L}\\right)x + \\frac{R}{K}(Lx - x^2) $$\n由于 $H(x)$ 代表物理上的饱和厚度，它必须是非负的。因此，我们取正平方根来获得水位剖面的最终表达式：\n$$ H(x) = \\sqrt{H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{R}{K}(Lx - x^2)} $$\n该解描述了一个抛物线形的水位剖面，它叠加在一个线性剖面上，该线性剖面是在没有补给（$R=0$）时存在的情况。",
            "answer": "$$ \\boxed{\\sqrt{H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{R}{K}(Lx - x^2)}} $$"
        },
        {
            "introduction": "对流-扩散方程是环境流动与输运模型的核心，但其求解的正确性高度依赖于边界条件的设定。本练习将挑战您对模型边界物理意义的深刻理解，要求您为开放的流入/流出系统选择并论证最合适的边界条件。通过分析平流主导的极限情况并运用通量平衡原理，您将学会如何设定既符合物理实际又保证数学上适定性的边界，这是所有输运建模者必须掌握的关键技能。",
            "id": "3883683",
            "problem": "考虑在一直河段 $x \\in [0,L]$ 中，保守示踪剂的浓度为 $C(x,t)$。该河段以恒定的平均流速 $U0$ 和恒定的分子扩散系数 $\\kappa0$ 输运一种被动污染物。区域 $[0,L]$ 代表了一条长得多河流的有限部分，其入流在 $x=0$ 处，来自上游水库；出流在 $x=L$ 处，流入一个大型受纳水体。设 $S(x,t)$ 表示河段内单位长度的体积源项。从质量守恒原理和物理定义的通量定律出发，推导合适的控制方程，并确定在 $x=0$ 和 $x=L$ 处的哪一对边界条件在物理上和数学上适合模拟一个 $U0$ 的开放入流/出流系统。在该系统中，上游水库施加了一个入流浓度 $C_{\\text{in}}(t)$，而下游受纳水体足够大，以至于在远超过 $x=L$ 的地方示踪剂梯度变得可以忽略不计。请借助双曲极限（平流主导）以及针对完整平流-扩散情况的能量或通量平衡论证来证明所选条件的合理性。假设初始条件 $C(x,0)$ 已知且足够光滑。\n\n从以下选项中选择正确的边界条件对。在每个选项中，$C_{\\text{in}}(t)$ 和 $C_{\\text{out}}(t)$ 是给定的函数，$\\partial_x$ 表示 $\\partial/\\partial x$。狄利克雷边界条件固定 $C$ 的值，而诺伊曼边界条件固定 $\\partial_x C$ 的值。\n\nA. $C(0,t)=C_{\\text{in}}(t)$ 且 $\\partial_x C(L,t)=0$。\n\nB. $\\partial_x C(0,t)=0$ 且 $C(L,t)=C_{\\text{out}}(t)$。\n\nC. $C(0,t)=C_{\\text{in}}(t)$ 且 $C(L,t)=C_{\\text{out}}(t)$。\n\nD. $\\partial_x C(0,t)=0$ 且 $\\partial_x C(L,t)=0$。\n\n解释哪一个选项与上游入流和下游开放边界的物理特性最一致，并且在平流主导极限 $\\kappa \\to 0^+$ 下具有适定性。请基于守恒和通量论证，提供一个有原则的推导和论证，不要借助特设的数值启发式方法。为清晰起见，请在推理中首次使用一维（1D）和偏微分方程（PDE）时对其进行定义，并确保你的推导只使用基本守恒定律和标准、经过充分检验的通量本构关系。",
            "solution": "合适的出发点是保守示踪剂在一维（One-Dimensional, 1D）流动中的局部质量守恒。对于任意子区间 $[a,b] \\subset [0,L]$，其积分形式为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_a^b C(x,t)\\,\\mathrm{d}x \\;=\\; J(a,t) - J(b,t) \\;+\\; \\int_a^b S(x,t)\\,\\mathrm{d}x,\n$$\n其中 $J(x,t)$ 是示踪剂的总纵向通量。将 $J$ 分解为平流和扩散分量的本构关系是一个标准且经过充分检验的关系式\n$$\nJ(x,t) \\;=\\; U\\,C(x,t) \\;-\\; \\kappa\\,\\partial_x C(x,t),\n$$\n其中 $U0$ 表示平均下游流速，$\\kappa0$ 表示分子扩散系数。对通量差应用微积分基本定理，该积分表达式可以推导出如下偏微分方程（Partial Differential Equation, PDE）：\n$$\n\\partial_t C(x,t) \\;+\\; \\partial_x\\big(U\\,C(x,t) \\;-\\; \\kappa\\,\\partial_x C(x,t)\\big) \\;=\\; S(x,t),\n\\quad x\\in(0,L),\\; t0,\n$$\n或等价地，\n$$\n\\partial_t C(x,t) \\;+\\; U\\,\\partial_x C(x,t) \\;=\\; \\kappa\\,\\partial_{xx} C(x,t) \\;+\\; S(x,t).\n$$\n\n为选择边界条件，我们分析两个互补的极限和原理：\n\n1. 双曲（平流主导）极限 $\\kappa \\to 0^+$：在此极限下，PDE简化为一阶输运方程\n$$\n\\partial_t C(x,t) \\;+\\; U\\,\\partial_x C(x,t) \\;=\\; S(x,t),\n$$\n其特征线满足 $\\mathrm{d}x/\\mathrm{d}t = U  0$，严格地从 $x=0$ 移动到 $x=L$。对于一阶双曲方程的适定初边值问题，边界数据必须且只能在特征线进入区域的地方指定。因为 $U0$，特征线在 $x=0$ 处进入，在 $x=L$ 处离开。因此，必须在 $x=0$ 处指定一个边界条件，而不能在 $x=L$ 处指定一个独立的值，因为这会从出流边界注入与特征线传播方向相反的信息。在 $x=0$ 处，自然的物理数据是由上游水库进入的流体所携带的入流浓度 $C_{\\text{in}}(t)$，即\n$$\nC(0,t) \\;=\\; C_{\\text{in}}(t).\n$$\n\n2. 抛物型（平流-扩散）情况，$\\kappa0$：PDE在空间上是二阶的，一个在有限区间上的适定问题通常需要在每一端各有一个边界条件。入流条件 $C(0,t)=C_{\\text{in}}(t)$ 仍然是合适的，因为它能连续地连接到双曲极限，并指定了输入的平流状态。在下游边界 $x=L$ 处，我们寻求一个“开放”条件，该条件能模拟延伸至半无限区域的情况，避免虚假反射，并强制不发生与某个想象的边界值之间的人为扩散交换。物理上，如果该河段是一条长得多河流的截断，那么在下游足够远的地方，示踪剂会达到平衡，使得纵向梯度可以忽略。一个常见且物理上一致的选择是零梯度诺伊曼条件\n$$\n\\partial_x C(L,t) \\;=\\; 0,\n$$\n这消除了在出流边界的扩散通量，确保出口通量纯粹是平流的 $J(L,t)=U\\,C(L,t)$，并允许 $(0,L)$ 内的解来决定流出的平流浓度。\n\n这个选择可以通过能量估计来证明其合理性。将PDE乘以 $C$ 并在 $[0,L]$ 上积分，得到\n$$\n\\frac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_0^L C^2\\,\\mathrm{d}x\n\\;+\\; \\frac{U}{2}\\,\\big(C^2(L,t) - C^2(0,t)\\big)\n\\;+\\; \\kappa \\int_0^L (\\partial_x C)^2\\,\\mathrm{d}x\n\\;-\\; \\kappa\\,\\big[C\\,\\partial_x C\\big]_{x=0}^{x=L}\n\\;=\\; \\int_0^L S\\,C\\,\\mathrm{d}x.\n$$\n边界贡献项为\n$$\nB(t) \\;=\\; \\frac{U}{2}\\,\\big(C^2(L,t) - C^2(0,t)\\big) \\;-\\; \\kappa\\,\\big(C(L,t)\\,\\partial_x C(L,t) - C(0,t)\\,\\partial_x C(0,t)\\big).\n$$\n施加 $\\partial_x C(L,t)=0$ 消除了扩散出流项，只留下平流能量输运项 $\\frac{U}{2} C^2(L,t)$ 离开区域。在入流边界，指定 $C(0,t)=C_{\\text{in}}(t)$ 使得 $C(0,t)$ 成为已知，边界能量输入由物理入流状态 $C_{\\text{in}}(t)$ 控制。这种结构反映了一个开放的下游边界和一个指定的上游条件，并且与平流主导状态下的稳定性相一致。\n\n或者，考虑通过直接对守恒定律积分得到的全局质量平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_0^L C\\,\\mathrm{d}x\n\\;=\\; J(0,t) - J(L,t) \\;+\\; \\int_0^L S\\,\\mathrm{d}x\n\\;=\\; U\\,C(0,t) - \\kappa\\,\\partial_x C(0,t) \\;-\\; \\big(U\\,C(L,t) - \\kappa\\,\\partial_x C(L,t)\\big) \\;+\\; \\int_0^L S\\,\\mathrm{d}x.\n$$\n当 $C(0,t)=C_{\\text{in}}(t)$ 且 $\\partial_x C(L,t)=0$ 时，出流通量纯粹是平流的 $J(L,t)=U\\,C(L,t)$，而入流通量由水库浓度 $U\\,C_{\\text{in}}(t)$ 加上任何穿过 $x=0$ 的扩散交换（由内部解提供的 $\\partial_x C(0,t)$ 决定）确定。这是正确的物理划分：上游水库施加浓度，下游受体不将一个值施加回区域内部，并且在 $x=L$ 处的扩散泄漏被抑制，以模拟 $L$ 之外的一个大型开放区域。\n\n现在我们评估每个选项：\n\n选项 A: $C(0,t)=C_{\\text{in}}(t)$ 且 $\\partial_x C(L,t)=0$。\n- 分析：在 $x=0$ 处，狄利克雷条件固定了入流浓度，这与双曲极限下仅在特征线进入区域处（对于 $U0$）指定数据的要求相匹配。在 $x=L$ 处，诺伊曼零梯度条件消除了扩散通量，形成了一个开放边界，允许由解决定的平流状态流出，而无需施加外部信息。这与向下游半无限延伸的情况一致，并产生了一个适定问题，该问题能平滑地连接到平流主导的极限。结论：正确。\n\n选项 B: $\\partial_x C(0,t)=0$ 且 $C(L,t)=C_{\\text{out}}(t)$。\n- 分析：在入流处使用零梯度诺伊曼条件未能指定进入的平流状态；相反，它将边界梯度固定为零，让内部解来决定边界浓度 $C(0,t)$，从而决定净平流流入量 $U\\,C(0,t)$。这不能代表一个施加 $C_{\\text{in}}(t)$ 的上游水库，并可能导致相对于预期入流的质量不平衡。在 $x=L$ 处的狄利克雷条件在出流边界注入了一个浓度值，这在平流主导的极限下会不当地将数据从下游强加到区域内，可能导致不符合物理的边界层和反射。结论：不正确。\n\n选项 C: $C(0,t)=C_{\\text{in}}(t)$ 且 $C(L,t)=C_{\\text{out}}(t)$。\n- 分析：虽然两个狄利克雷条件使得抛物型偏微分方程在数学上是适定的，但在出流处指定 $C(L,t)$ 违反了 $U0$ 的双曲极限，因为它在特征线离开的地方强加了数据。物理上，一个开放的下游边界不应将浓度强加回河段内；这样做会在 $x=L$ 附近产生人为的边界层，并将信息反射到上游。它不能模拟一个在下游自然形成可忽略梯度的半无限区域。结论：不正确。\n\n选项 D: $\\partial_x C(0,t)=0$ 且 $\\partial_x C(L,t)=0$。\n- 分析：两个诺伊曼零梯度条件抑制了两个边界上的扩散交换，使得两个边界的浓度完全由内部解来决定。这使得入流边界缺少一个指定的平流状态 $C_{\\text{in}}(t)$，因此上游水库没有被表示出来。在平流主导的极限下，$x=0$ 处缺少入流数据会导致一个不适定的一阶问题，因为在特征线进入区域的地方没有提供特征数据。此外，对于抛物型情况，在没有额外约束的情况下，两个诺伊曼条件可能导致解的不唯一性（相差一个可加常数），并且不能反映指定入流浓度的物理过程。结论：不正确。\n\n因此，对于具有上游水库和下游开放边界的有限河段平流-扩散模型，当 $U0$ 时，合适的入流/出流边界条件是 $C(0,t)=C_{\\text{in}}(t)$ 和 $\\partial_x C(L,t)=0$。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然解析解能提供深刻的物理洞见，但大多数复杂的环境模型依赖于数值方法求解。本练习将引导您从解析转向计算，要求您为一维扩散方程实现经典的Crank-Nicolson数值格式。这个过程不仅涉及从偏微分方程到离散代数方程组的转换，更重要的是，它要求您通过傅里叶模态分析其稳定性和数值阻尼特性，从而评估数值方案的性能，这是确保模型模拟结果可靠性的基础。",
            "id": "3883646",
            "problem": "考虑由 Fick 第一定律和质量守恒控制的被动示踪剂浓度的一维扩散。通量由 $J(x,t)=-D\\,\\partial_x c(x,t)$ 给出，其中 $D$ 是恒定的分子扩散系数，质量守恒定律为 $\\partial_t c(x,t)+\\partial_x J(x,t)=0$。将这两者结合，得到抛物型偏微分方程 (PDE) $\\partial_t c(x,t)=D\\,\\partial_{xx}c(x,t)$。\n\n您将为一个均匀周期性网格上该偏微分方程的空间离散形式实现 Crank–Nicolson 时间步进格式，然后使用您的实现来数值评估其无条件稳定性和数值阻尼特性。区域为 $[0,L]$，具有周期性边界条件和 $N$ 个均匀分布的网格点，间距为 $\\Delta x=L/N$。对于离散拉普拉斯算子，使用标准的二阶中心差分；对于时间层 $n$ 和 $n+1$ 之间的半隐式更新，使用梯形 (Crank–Nicolson) 法则。\n\n从 Fick 第一定律和质量守恒的基本原理出发，推导您所实现的格式。不要使用问题陈述中的任何简便公式。然后，您的程序应以一种能够让您实现以下目标的方式应用该格式：\n- 计算周期性网格上任意离散傅里叶模态的单步放大因子。\n- 将 Crank–Nicolson 放大因子与空间离散化后的常微分方程的半离散精确时间演化进行比较。\n\n在您的推理和实现中使用的定义：\n- 在具有 $N$ 个点的周期性网格上的一个离散傅里叶模态由整数 $m\\in\\{0,1,\\dots,N-1\\}$ 索引，在网格索引 $j$ 处其网格值与 $\\cos\\!\\big(2\\pi m\\, j/N\\big)$ 或 $\\sin\\!\\big(2\\pi m\\, j/N\\big)$ 成正比。\n- 半离散精确时间演化指的是解析地积分空间离散化后得到的常微分方程组，对于每个离散特征模态，得到 $c(t)=\\exp\\!\\big(\\lambda_m\\, t\\big)\\,c(0)$，其中 $\\lambda_m$ 是与模态 $m$ 对应的离散拉普拉斯算子的特征值。\n\n物理和数值单位：\n- 使用 $L$（单位为米，$\\mathrm{m}$），$D$（单位为平方米/秒，$\\mathrm{m}^2/\\mathrm{s}$），时间 $t$（单位为秒，$\\mathrm{s}$），波数（单位为弧度/米，$\\mathrm{rad}/\\mathrm{m}$）。\n- 所有要求的输出都是无量纲数，并应按规定报告为普通浮点值或布尔值。\n\n测试套件和输出：\n实现您的程序以评估以下三个测试用例。在每个用例中，假设初始条件为 $c(x,0)=A\\cos\\!\\big(2\\pi m\\,x/L\\big)$，振幅 $A=1$，这样动力学行为就完全由模态 $m$ 的放大因子所捕捉。\n\n- 测试用例 1（非刚性区域的精度）：\n    - 参数：$L=1\\,\\mathrm{m}$，$N=128$，$D=10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$\\Delta t=10^{-3}\\,\\mathrm{s}$，最终时间 $T=0.1\\,\\mathrm{s}$，模态指数 $m=4$。\n    - 任务：计算 $T$ 秒后，模态 $m$ 经 Crank-Nicolson 放大后的幅值与半离散精确解的幅值之间的绝对差。以浮点数形式返回此绝对差。\n\n- 测试用例 2（大时间步长下所有模态的无条件稳定性）：\n    - 参数：$L=1\\,\\mathrm{m}$，$N=128$，$D=10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$\\Delta t=5\\,\\mathrm{s}$。\n    - 任务：对于所有离散模态 $m\\in\\{0,\\dots,N-1\\}$，计算 Crank-Nicolson 单步放大因子的幅值。如果且仅当每个模态都满足 $|G_m|\\le 1$（无条件稳定性），则返回布尔值 $True$，否则返回 $False$。\n\n- 测试用例 3（刚性高频模态的数值阻尼不足和时间振荡）：\n    - 参数：$L=1\\,\\mathrm{m}$，$N=128$，$D=1\\,\\mathrm{m}^2/\\mathrm{s}$，$\\Delta t=0.1\\,\\mathrm{s}$，最终时间 $T=10\\,\\mathrm{s}$，模态指数 $m=N/2$（奈奎斯特模态）。\n    - 任务：计算在 $T$ 秒时，模态 $m$ 的 Crank-Nicolson 放大后幅值与半离散精确幅值之比的以 10 为底的对数。以浮点数形式返回此值。一个大的正值表示相对于半离散精确衰减，Crank-Nicolson 格式存在严重的阻尼不足。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来，顺序为测试用例 1、测试用例 2、测试用例 3。例如，输出应类似于 $[x_1,x_2,x_3]$，其中 $x_1$ 和 $x_3$ 是浮点值， $x_2$ 是布尔值。",
            "solution": "用户提供的问题经评估为 **有效**。它在科学上基于质量守恒和 Fickian 扩散原理，数学上是适定的，并以客观、精确的语言呈现。为三个指定的测试用例提供了所有必要的数据和定义，并且该问题是偏微分方程数值分析中的一个标准、非平凡的练习。\n\n### 1. 控制方程和数值格式的推导\n\n问题始于两个基本原理：示踪剂浓度 $c(x,t)$ 的质量守恒和扩散通量 $J(x,t)$ 的 Fick 第一定律。\n\n一维守恒定律表示为连续性方程：\n$$\n\\partial_t c(x,t) + \\partial_x J(x,t) = 0\n$$\n其中 $\\partial_t$ 是对时间 $t$ 的偏导数，$\\partial_x$ 是对空间 $x$ 的偏导数。\n\nFick 第一定律指出，通量与浓度梯度的负值成正比，描述了一个顺梯度输运过程：\n$$\nJ(x,t) = -D \\, \\partial_x c(x,t)\n$$\n其中 $D$ 是恒定的分子扩散系数。\n\n将 $J(x,t)$ 的表达式代入守恒定律得到：\n$$\n\\partial_t c(x,t) + \\partial_x \\left(-D \\, \\partial_x c(x,t)\\right) = 0\n$$\n由于扩散系数 $D$ 为常数，可以将其从空间导数中提出，从而得到一维扩散方程，这是一个抛物型偏微分方程 (PDE)：\n$$\n\\partial_t c(x,t) = D \\, \\partial_{xx} c(x,t)\n$$\n\n### 2. 空间和时间离散化\n\n为了数值求解该偏微分方程，我们首先进行空间离散化（线方法）。将区域 $[0, L]$ 划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀区间，网格点位于 $x_j = j \\Delta x$，其中 $j = 0, 1, \\dots, N-1$。令 $c_j(t)$ 表示浓度 $c(x_j, t)$ 的数值近似。\n\n在网格点 $x_j$ 处的二阶空间导数 $\\partial_{xx} c$ 使用二阶中心差分公式进行近似。这适用于指定的周期性边界条件：\n$$\n\\partial_{xx} c(x_j, t) \\approx \\frac{c_{j+1}(t) - 2c_j(t) + c_{j-1}(t)}{\\Delta x^2}\n$$\n其中索引对 $N$ 取模（例如，$c_N = c_0$ 和 $c_{-1} = c_{N-1}$）。将此代入偏微分方程，得到一个耦合常微分方程组 (ODEs)，即半离散形式：\n$$\n\\frac{d c_j(t)}{dt} = \\frac{D}{\\Delta x^2} \\left( c_{j+1}(t) - 2c_j(t) + c_{j-1}(t) \\right)\n$$\n该系统可以写成向量形式 $\\frac{d\\vec{c}}{dt} = \\mathbf{L}\\vec{c}$，其中 $\\vec{c} = [c_0, c_1, \\dots, c_{N-1}]^T$，$\\mathbf{L}$ 是表示离散拉普拉斯算子乘以 $D$ 的矩阵。\n\n对于时间积分，我们应用 Crank-Nicolson 方法，这等价于梯形法则。对于一个时间步长 $\\Delta t$，设 $\\vec{c}^n \\approx \\vec{c}(n\\Delta t)$，则格式为：\n$$\n\\frac{\\vec{c}^{n+1} - \\vec{c}^n}{\\Delta t} = \\frac{1}{2} \\left( \\mathbf{L}\\vec{c}^{n+1} + \\mathbf{L}\\vec{c}^n \\right)\n$$\n这是一个隐式方法。为方便计算，我们重新整理方程，将未知状态 $\\vec{c}^{n+1}$ 分离到一边：\n$$\n\\vec{c}^{n+1} - \\frac{\\Delta t}{2} \\mathbf{L}\\vec{c}^{n+1} = \\vec{c}^n + \\frac{\\Delta t}{2} \\mathbf{L}\\vec{c}^n\n$$\n将状态向量因子化，得到 Crank-Nicolson 格式的标准形式，该形式需要在每个时间步求解一个线性系统：\n$$\n\\left(\\mathbf{I} - \\frac{\\Delta t}{2} \\mathbf{L}\\right) \\vec{c}^{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2} \\mathbf{L}\\right) \\vec{c}^n\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。\n\n### 3. 傅里叶模态分析（von Neumann 稳定性分析）\n\n为了分析格式的准确性和稳定性，我们研究其在离散傅里叶模态上的行为，这些模态是循环矩阵 $\\mathbf{L}$ 的特征向量。网格上索引为 $m$ 的复傅里叶模态由 $c_j = \\exp(i k x_j) = \\exp(i 2\\pi m j / N)$ 给出，其中 $k = 2\\pi m / L$ 是波数。\n\n将离散空间算子应用于此模态，揭示了相应的特征值 $\\lambda_m$：\n$$\n(\\mathbf{L} \\vec{c})_j = \\frac{D}{\\Delta x^2} \\left( e^{i 2\\pi m (j+1)/N} - 2e^{i 2\\pi m j/N} + e^{i 2\\pi m (j-1)/N} \\right) = \\frac{D}{\\Delta x^2} c_j \\left( e^{i 2\\pi m/N} - 2 + e^{-i 2\\pi m/N} \\right)\n$$\n使用 Euler 公式，$e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，上式简化为：\n$$\n(\\mathbf{L} \\vec{c})_j = \\frac{2D}{\\Delta x^2} c_j \\left( \\cos\\left(\\frac{2\\pi m}{N}\\right) - 1 \\right)\n$$\n利用恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，特征值 $\\lambda_m$ 为：\n$$\n\\lambda_m = \\frac{-4D}{\\Delta x^2} \\sin^2\\left(\\frac{\\pi m}{N}\\right)\n$$\n这些特征值是实数且非正（$\\lambda_m \\le 0$），这与纯粹的耗散物理过程一致。\n\n模态 $m$ 的“半离散精确”演化遵循常微分方程 $\\frac{dc_m(t)}{dt} = \\lambda_m c_m(t)$，其解为 $c_m(t) = c_m(0) \\exp(\\lambda_m t)$。该模态在时间 $T$ 内的放大率为 $\\exp(\\lambda_m T)$。\n\nCrank-Nicolson 格式的数值放大因子 $G_m$ 可通过将 $\\vec{c}^{n+1} = G_m \\vec{c}^n$ 和 $\\mathbf{L}\\vec{c} = \\lambda_m \\vec{c}$ 代入格式方程得到：\n$$\n\\left(1 - \\frac{\\Delta t}{2} \\lambda_m\\right) G_m = \\left(1 + \\frac{\\Delta t}{2} \\lambda_m\\right) \\implies G_m = \\frac{1 + \\lambda_m \\Delta t / 2}{1 - \\lambda_m \\Delta t / 2}\n$$\n\n### 4. 测试用例的实现策略\n\n推导出的 $\\lambda_m$ 和 $G_m$ 公式用于评估测试用例。\n\n**测试用例 1：** 目标是计算格式的精度。我们计算在 $N_{steps} = T / \\Delta t$ 步后的总数值放大率与时间 $T$ 内的总半离散精确放大率之间的绝对差。该量为 $\\left| |G_m|^{N_{steps}} - \\exp(\\lambda_m T) \\right|$。\n\n**测试用例 2：** 该测试验证了 Crank-Nicolson 格式对于扩散方程的无条件稳定性。我们必须检查是否对所有模态 $m \\in \\{0, \\dots, N-1\\}$ 都满足 $|G_m| \\le 1$。由于 $\\lambda_m \\le 0$ 且 $\\Delta t  0$，项 $z_m = \\lambda_m \\Delta t / 2$ 是非正的。令 $z_m = -a_m$，其中 $a_m \\ge 0$。则 $|G_m| = |(1-a_m)/(1+a_m)|$。如初等分析所示，对于 $a_m \\ge 0$，该量总是小于或等于 1。因此，该格式是 A-稳定的，测试必须评估为 `True`。\n\n**测试用例 3：** 该用例突出了 Crank-Nicolson 格式的一个已知缺陷：对高频（刚性）模态缺乏强阻尼。我们分析奈奎斯特模态 $m=N/2$，它具有最大幅值的特征值，因此具有最快的物理衰减率。我们计算数值放大幅值与精确放大幅值之比的以 10 为底的对数：$\\log_{10}\\left( |G_m|^{N_{steps}} / \\exp(\\lambda_m T) \\right)$。对于大的 $\\Delta t$，$G_{N/2}$ 的值接近 -1，这意味着数值解几乎不衰减，并且符号振荡，而精确解几乎是瞬时衰减的。这导致对数比率出现一个非常大的正值。为了数值稳定性，此计算在对数空间中执行。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the Crank-Nicolson scheme analysis and print the results.\n    \"\"\"\n\n    # --- Helper function for core physics/numerics calculation ---\n    def get_modal_properties(L, N, D, dt, m):\n        \"\"\"\n        Computes the eigenvalue lambda_m of the discrete Laplacian and the \n        Crank-Nicolson amplification factor G_m for a given mode m.\n        \n        Args:\n            L (float): Domain length.\n            N (int): Number of grid points.\n            D (float): Diffusivity.\n            dt (float): Time step.\n            m (int): Fourier mode index.\n            \n        Returns:\n            tuple: (lambda_m, G_m)\n        \"\"\"\n        dx = L / N\n        \n        # Eigenvalue lambda_m. Handle the m=0 (constant) mode explicitly\n        # to ensure it is exactly zero.\n        if m % N == 0:\n            lambda_m = 0.0\n        else:\n            # Formula derived from centered difference operator on a periodic grid.\n            lambda_m = (-4.0 * D / dx**2) * np.sin(np.pi * m / N)**2\n\n        # Crank-Nicolson per-step amplification factor G_m.\n        numerator = 1.0 + 0.5 * dt * lambda_m\n        denominator = 1.0 - 0.5 * dt * lambda_m\n        # Denominator is guaranteed to be positive as D=0, dt0, and lambda_m=0.\n        G_m = numerator / denominator\n        \n        return lambda_m, G_m\n\n    # --- Container for results ---\n    results = []\n\n    # =========================================================================\n    # Test Case 1: Accuracy in a non-stiff regime\n    # =========================================================================\n    params1 = {'L': 1.0, 'N': 128, 'D': 1e-4, 'dt': 1e-3, 'T': 0.1, 'm': 4}\n    \n    lambda_m1, G_m1 = get_modal_properties(params1['L'], params1['N'], params1['D'], params1['dt'], params1['m'])\n    \n    num_steps1 = int(round(params1['T'] / params1['dt']))\n    \n    # Final magnitude from Crank-Nicolson scheme after T seconds.\n    cn_magnitude1 = np.abs(G_m1)**num_steps1\n    \n    # Final magnitude from semi-discrete exact solution after T seconds.\n    exact_magnitude1 = np.exp(lambda_m1 * params1['T'])\n    \n    result1 = np.abs(cn_magnitude1 - exact_magnitude1)\n    results.append(result1)\n\n    # =========================================================================\n    # Test Case 2: Unconditional stability\n    # =========================================================================\n    params2 = {'L': 1.0, 'N': 128, 'D': 1e-4, 'dt': 5.0}\n\n    is_stable = True\n    # Theory guarantees stability (|G_m| = 1). This is a numerical verification.\n    for m_idx in range(params2['N']):\n        _, G_m_val = get_modal_properties(params2['L'], params2['N'], params2['D'], params2['dt'], m_idx)\n        # Allow a small floating-point tolerance for the check.\n        if np.abs(G_m_val)  1.0 + 1e-12:\n            is_stable = False\n            break\n    \n    result2 = is_stable\n    results.append(result2)\n\n    # =========================================================================\n    # Test Case 3: Numerical damping deficiency for stiff modes\n    # =========================================================================\n    params3 = {'L': 1.0, 'N': 128, 'D': 1.0, 'dt': 0.1, 'T': 10.0, 'm': 128 // 2}\n\n    lambda_m3, G_m3 = get_modal_properties(params3['L'], params3['N'], params3['D'], params3['dt'], params3['m'])\n    \n    num_steps3 = int(round(params3['T'] / params3['dt']))\n\n    # To avoid potential underflow/overflow from direct ratio computation,\n    # the log of the ratio is computed in log space: log10(a/b) = log10(a) - log10(b).\n    # log10(|G|**N_steps) = N_steps * log10(|G|)\n    # log10(exp(lambda*T)) = (lambda*T) / ln(10)\n    \n    log10_cn_mag = num_steps3 * np.log10(np.abs(G_m3))\n    log10_exact_mag = (lambda_m3 * params3['T']) / np.log(10)\n    \n    result3 = log10_cn_mag - log10_exact_mag\n    results.append(result3)\n\n    # =========================================================================\n    # Final Output Formatting\n    # =========================================================================\n    # The format must be exactly [val1,val2,val3] with no extra spaces or text.\n    output_str = f\"[{results[0]},{results[1]},{results[2]}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}