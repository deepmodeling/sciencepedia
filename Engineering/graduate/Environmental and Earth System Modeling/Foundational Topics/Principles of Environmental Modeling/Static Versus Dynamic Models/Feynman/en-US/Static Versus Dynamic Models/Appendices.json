{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental distinction between static and dynamic models lies in their treatment of time. This first exercise invites you to explore this difference by analytically solving for the transient response of a simple carbon pool to a sudden change in inputs. By deriving the time-dependent solution, you will quantify the system's characteristic response time, a concept entirely absent from a static, equilibrium-based perspective.",
            "id": "3915701",
            "problem": "Consider a single-pool terrestrial soil carbon model in which the carbon stock $C(t)$ evolves due to inputs $I(t)$ and first-order turnover characterized by a constant rate $k$. The conservation of mass dictates that the temporal rate of change of the stock equals inputs minus outputs. Empirical evidence supports the assumption that outputs are proportional to the stock with proportionality constant $k$. Prior to $t=0$, the system is at a steady state under a constant input $I(t)=I_0$; at $t=0$ the input undergoes an instantaneous step increase to a new constant input $I(t)=I_1$ for all $t \\geq 0$. Assume continuity of the stock at $t=0$.\n\nUsing only the conservation of mass and the first-order turnover assumption, derive the transient solution $C(t)$ for $t \\geq 0$ following the step in inputs. Identify the new steady state value $C_{\\infty}$ under the post-step inputs and articulate how the dynamic model’s transient response differs from a static model that would equate the stock with its steady state at all times.\n\nThen, for the parameter values $k = 0.08$ year$^{-1}$, $I_0 = 300$ g C m$^{-2}$ year$^{-1}$, and $I_1 = 360$ g C m$^{-2}$ year$^{-1}$, compute the minimum time $t_{0.99}$ for the stock's deviation from the new steady state to be at most 1% of the initial deviation, as defined by the relation:\n$$\n|C(t) - C_{\\infty}| \\leq 0.01\\,|C(0^{+}) - C_{\\infty}|.\n$$\nExpress the time in years. Round your answer to four significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique and meaningful solution. It represents a standard initial value problem in environmental system modeling.\n\nThe evolution of the soil carbon stock $C(t)$ is governed by the principle of mass conservation, which states that the rate of change of the stock is equal to the rate of inputs minus the rate of outputs.\n$$\n\\frac{dC}{dt} = I(t) - \\text{Outputs}\n$$\nThe problem specifies that the output is due to first-order turnover, meaning the output rate is directly proportional to the current stock size, with a proportionality constant $k$.\n$$\n\\text{Outputs} = kC(t)\n$$\nCombining these two statements yields the governing first-order linear ordinary differential equation for the system:\n$$\n\\frac{dC}{dt} = I(t) - kC(t) \\quad \\text{or} \\quad \\frac{dC}{dt} + kC(t) = I(t)\n$$\n\nFirst, we must determine the initial condition at $t=0$. The problem states that for $t < 0$, the system is at a steady state with a constant input $I(t) = I_0$. At steady state, the stock does not change, so $\\frac{dC}{dt} = 0$. The governing equation becomes:\n$$\n0 = I_0 - kC_{ss,0}\n$$\nwhere $C_{ss,0}$ is the steady-state carbon stock. Solving for $C_{ss,0}$ gives:\n$$\nC_{ss,0} = \\frac{I_0}{k}\n$$\nThe problem specifies that the stock $C(t)$ is continuous at $t=0$. Therefore, the initial condition for the subsequent evolution of the system is the stock value at the end of the pre-step period. We denote $C(0) = C(0^+)$ due to continuity.\n$$\nC(0) = C_{ss,0} = \\frac{I_0}{k}\n$$\n\nNext, we solve for the transient response for $t \\geq 0$. During this period, the input is a new constant value, $I(t) = I_1$. The differential equation is:\n$$\n\\frac{dC}{dt} + kC = I_1\n$$\nThis is a non-homogeneous first-order linear ODE. It can be solved using an integrating factor, $\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)$. Multiplying the ODE by $\\mu(t)$:\n$$\n\\exp(kt)\\frac{dC}{dt} + k\\exp(kt)C(t) = I_1\\exp(kt)\n$$\nThe left-hand side is the result of the product rule for differentiation, $\\frac{d}{dt}[C(t)\\exp(kt)]$.\n$$\n\\frac{d}{dt}[C(t)\\exp(kt)] = I_1\\exp(kt)\n$$\nIntegrating both sides with respect to $t$ from $0$ to $t$:\n$$\n\\int_0^t \\frac{d}{d\\tau}[C(\\tau)\\exp(k\\tau)] \\, d\\tau = \\int_0^t I_1\\exp(k\\tau) \\, d\\tau\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(0) = I_1 \\left[ \\frac{\\exp(k\\tau)}{k} \\right]_0^t\n$$\n$$\nC(t)\\exp(kt) - C(0) = \\frac{I_1}{k} (\\exp(kt) - 1)\n$$\nSolving for $C(t)$:\n$$\nC(t) = C(0)\\exp(-kt) + \\frac{I_1}{k}(1 - \\exp(-kt))\n$$\nSubstituting the initial condition $C(0) = I_0/k$:\n$$\nC(t) = \\frac{I_0}{k}\\exp(-kt) + \\frac{I_1}{k} - \\frac{I_1}{k}\\exp(-kt)\n$$\nThis simplifies to the transient solution for $t \\geq 0$:\n$$\nC(t) = \\frac{I_1}{k} + \\left(\\frac{I_0}{k} - \\frac{I_1}{k}\\right)\\exp(-kt)\n$$\n\nThe new steady state value, $C_{\\infty}$, is the limit of $C(t)$ as $t \\to \\infty$. Since $k > 0$, the term $\\exp(-kt)$ approaches $0$.\n$$\nC_{\\infty} = \\lim_{t \\to \\infty} C(t) = \\lim_{t \\to \\infty} \\left[ \\frac{I_1}{k} + \\left(\\frac{I_0}{k} - \\frac{I_1}{k}\\right)\\exp(-kt) \\right] = \\frac{I_1}{k}\n$$\nUsing this, the transient solution can be expressed more compactly in terms of the initial and final states:\n$$\nC(t) = C_{\\infty} + (C(0) - C_{\\infty})\\exp(-kt)\n$$\n\nThe difference between the dynamic and static models can now be articulated.\nA **static model** assumes the system responds instantaneously to changes in forcing and is always in equilibrium. In this context, a static model would predict that the carbon stock is $C_{static}(t) = I(t)/k$. Therefore, at $t=0$, the stock would discontinuously jump from its old steady-state value $C_0 = I_0/k$ to the new steady-state value $C_{\\infty} = I_1/k$.\nThe **dynamic model**, as derived, shows a fundamentally different behavior. The stock $C(t)$ is continuous at $t=0$ and only approaches the new steady state $C_{\\infty}$ asymptotically. The transition is not instantaneous but occurs over a characteristic time scale determined by $1/k$. The dynamic model captures the system's transient response, reflecting its inertia or \"memory\" of its past state, which a static model completely ignores.\n\nFinally, we compute the time $t_{0.99}$ required for the stock's deviation from the new steady state to fall to 1% of the initial deviation. The condition is:\n$$\n|C(t) - C_{\\infty}| \\leq 0.01\\,|C(0^{+}) - C_{\\infty}|\n$$\nFrom our solution, we have $C(t) - C_{\\infty} = (C(0) - C_{\\infty})\\exp(-kt)$. Substituting this into the inequality:\n$$\n|(C(0) - C_{\\infty})\\exp(-kt)| \\leq 0.01\\,|C(0) - C_{\\infty}|\n$$\nSince $C(0) = I_0/k$ and $C_{\\infty}=I_1/k$ are different (as $I_0 \\neq I_1$), the term $|C(0) - C_{\\infty}|$ is non-zero and can be cancelled. Also, $\\exp(-kt)$ is always positive. This simplifies the inequality to:\n$$\n\\exp(-kt) \\leq 0.01\n$$\nTo find the minimum time $t_{0.99}$ that satisfies this, we solve the equality:\n$$\n\\exp(-kt_{0.99}) = 0.01\n$$\nTaking the natural logarithm of both sides:\n$$\n-kt_{0.99} = \\ln(0.01)\n$$\nSolving for $t_{0.99}$:\n$$\nt_{0.99} = -\\frac{\\ln(0.01)}{k}\n$$\nSubstituting the given value $k = 0.08$ year$^{-1}$:\n$$\nt_{0.99} = -\\frac{\\ln(0.01)}{0.08} = -\\frac{\\ln(10^{-2})}{0.08} = -\\frac{-2\\ln(10)}{0.08} = \\frac{2\\ln(10)}{0.08}\n$$\nNumerically, $\\ln(0.01) \\approx -4.60517$.\n$$\nt_{0.99} = \\frac{4.60517...}{0.08} \\approx 57.5646... \\text{ years}\n$$\nRounding the result to four significant figures, we get $57.56$ years. Note that the values of $I_0$ and $I_1$ are not needed for this calculation, as the time to reach a certain fraction of the new equilibrium depends only on the system's intrinsic rate constant $k$.",
            "answer": "$$\n\\boxed{57.56}\n$$"
        },
        {
            "introduction": "Building on the concept of transient behavior, we now explore a more subtle but critical implication: parameter non-identifiability. This practice challenges you to demonstrate how two systems with different internal dynamics can appear identical from a purely static, steady-state observation point. Completing this exercise will highlight why dynamic, time-resolved data is often essential for correctly identifying and constraining the parameters that govern system processes.",
            "id": "3915709",
            "problem": "Consider a single-compartment, well-mixed box model for a conserved tracer, where the concentration $C(t)$ evolves according to a linear mass balance with a constant volumetric source and first-order removal. The dynamics are given by the ordinary differential equation (ODE)\n$$\n\\frac{dC}{dt} \\;=\\; -\\,k\\,C \\;+\\; u(t),\n$$\nwhere $k$ is a positive first-order removal rate constant and $u(t)$ is a source that takes a step from $0$ to a positive constant $u_{0}$ at $t=0$. The observation is a scalar output\n$$\ny(t) \\;=\\; b\\,C(t),\n$$\nwhere $b$ is a positive, dimensionless observation gain. The initial condition is $C(0)=0$. This setup captures a common structure in environmental and Earth system modeling in which static (steady-state) observations cannot, by themselves, distinguish dynamical parameters from observation gains.\n\nUsing only the fundamental definitions above and basic properties of linear ODEs with constant coefficients, do the following:\n\n1) Show from first principles that the steady-state output $y_{\\infty} \\equiv \\lim_{t\\to\\infty} y(t)$ depends on the ratio $b/k$ and not on $k$ and $b$ individually.\n\n2) Use this to construct an explicit counterexample demonstrating non-identifiability from static data: choose two distinct parameter sets $(k_{1},b_{1})$ and $(k_{2},b_{2})$ that yield identical steady-state outputs under the same constant input $u_{0}$ but have different transient responses. For concreteness, take $k_{1}=1\\,\\text{day}^{-1}$ and $b_{1}=1$, and take $k_{2}=2\\,\\text{day}^{-1}$. Determine the value of $b_{2}$ that makes the steady-state outputs identical for these two parameter sets.\n\n3) For these two parameter sets and any fixed positive $u_{0}$, derive analytically the time $t^{\\ast}>0$ at which the magnitude of the difference in outputs,\n$$\n|y_{1}(t)-y_{2}(t)|,\n$$\nis maximized, where $y_{i}(t)$ is the output corresponding to $(k_{i},b_{i})$. Then, evaluate $t^{\\ast}$ numerically for the specified $k_{1}$ and $k_{2}$.\n\nRound your final numerical answer for $t^{\\ast}$ to four significant figures. Express the final time in days.",
            "solution": "The problem is validated as scientifically sound, well-posed, objective, and complete. We proceed with the solution, addressing each of the three parts in sequence.\n\nThe governing ordinary differential equation (ODE) for the tracer concentration $C(t)$ is\n$$\n\\frac{dC}{dt} = -kC + u(t)\n$$\nwith the initial condition $C(0)=0$. The source term $u(t)$ is a step function, where $u(t)=u_0$ (a positive constant) for $t \\ge 0$. The observed output is $y(t) = bC(t)$, where $b$ is a positive, dimensionless gain.\n\nPart 1: Analysis of the Steady-State Output\n\nThe steady-state concentration, denoted $C_{\\infty}$, is the value of $C(t)$ as $t \\to \\infty$. In this state, the system is at equilibrium, meaning the concentration is no longer changing with time. Mathematically, this corresponds to the condition $\\frac{dC}{dt} = 0$. Substituting this into the governing ODE, with the constant source $u_0$, we obtain:\n$$\n0 = -k C_{\\infty} + u_0\n$$\nSolving for the steady-state concentration $C_{\\infty}$ yields:\n$$\nk C_{\\infty} = u_0 \\implies C_{\\infty} = \\frac{u_0}{k}\n$$\nThe steady-state output, $y_{\\infty}$, is defined as the limit of $y(t)$ as $t \\to \\infty$. Using the relationship $y(t) = bC(t)$, we find:\n$$\ny_{\\infty} = \\lim_{t\\to\\infty} y(t) = b \\left( \\lim_{t\\to\\infty} C(t) \\right) = b C_{\\infty}\n$$\nSubstituting the expression for $C_{\\infty}$:\n$$\ny_{\\infty} = b \\left(\\frac{u_0}{k}\\right) = u_0 \\left(\\frac{b}{k}\\right)\n$$\nThis result demonstrates that for a given constant source $u_0$, the steady-state output $y_{\\infty}$ depends only on the ratio of the parameters $b/k$, and not on the individual values of $b$ and $k$. This property is the basis for non-identifiability from static (steady-state) data alone.\n\nPart 2: Construction of a Counterexample\n\nWe are asked to find two distinct parameter sets, $(k_1, b_1)$ and $(k_2, b_2)$, that produce identical steady-state outputs but have different transient dynamics. The condition for identical steady-state outputs, $y_{1,\\infty} = y_{2,\\infty}$, is:\n$$\nu_0 \\left(\\frac{b_1}{k_1}\\right) = u_0 \\left(\\frac{b_2}{k_2}\\right)\n$$\nSince $u_0 > 0$, this simplifies to the condition that the ratios of the parameters must be equal:\n$$\n\\frac{b_1}{k_1} = \\frac{b_2}{k_2}\n$$\nWe are given the first parameter set $(k_1, b_1)$ with $k_1 = 1\\,\\text{day}^{-1}$ and $b_1 = 1$. We are also given $k_2 = 2\\,\\text{day}^{-1}$ for the second set. We can now solve for the required value of $b_2$:\n$$\n\\frac{1}{1} = \\frac{b_2}{2} \\implies b_2 = 2\n$$\nThus, the two parameter sets are $(k_1, b_1) = (1, 1)$ and $(k_2, b_2) = (2, 2)$. These sets are distinct, but they both have the same parameter ratio $b/k=1$. They will produce the same steady-state output $y_\\infty = u_0$, but their transient responses will differ because the rate constants $k_1$ and $k_2$ are different. The time constant of the system, $\\tau=1/k$, is $\\tau_1 = 1\\,\\text{day}$ for the first system and $\\tau_2 = 1/2\\,\\text{day}$ for the second, implying the second system approaches steady state more quickly.\n\nPart 3: Maximizing the Difference in Transient Outputs\n\nTo analyze the transient response, we must first find the full solution $C(t)$ to the ODE for $t \\ge 0$:\n$$\n\\frac{dC}{dt} + kC = u_0, \\quad C(0)=0\n$$\nThis is a first-order linear ODE. We use the integrating factor method. The integrating factor is $\\exp\\left(\\int k \\, dt\\right) = \\exp(kt)$. Multiplying the ODE by the integrating factor gives:\n$$\n\\exp(kt) \\frac{dC}{dt} + k\\exp(kt)C = u_0 \\exp(kt)\n$$\nThe left side is the derivative of a product:\n$$\n\\frac{d}{dt}\\left( C(t)\\exp(kt) \\right) = u_0 \\exp(kt)\n$$\nIntegrating both sides from $0$ to $t$:\n$$\n\\int_0^t \\frac{d}{ds}\\left( C(s)\\exp(ks) \\right) ds = \\int_0^t u_0 \\exp(ks) ds\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(0) = u_0 \\left[ \\frac{1}{k}\\exp(ks) \\right]_0^t\n$$\nUsing the initial condition $C(0)=0$:\n$$\nC(t)\\exp(kt) = \\frac{u_0}{k}(\\exp(kt) - \\exp(0)) = \\frac{u_0}{k}(\\exp(kt) - 1)\n$$\nSolving for $C(t)$:\n$$\nC(t) = \\frac{u_0}{k}(1 - \\exp(-kt))\n$$\nThe corresponding output is $y(t) = b C(t) = \\frac{b u_0}{k}(1 - \\exp(-kt))$.\n\nFor the two parameter sets found in Part $2$, the outputs $y_1(t)$ and $y_2(t)$ are:\n$$\ny_1(t) = \\frac{b_1 u_0}{k_1}(1 - \\exp(-k_1 t))\n$$\n$$\ny_2(t) = \\frac{b_2 u_0}{k_2}(1 - \\exp(-k_2 t))\n$$\nSince $b_1/k_1 = b_2/k_2 = 1$, we can simplify these expressions:\n$$\ny_1(t) = u_0(1 - \\exp(-k_1 t))\n$$\n$$\ny_2(t) = u_0(1 - \\exp(-k_2 t))\n$$\nThe difference in outputs is $\\Delta y(t) = y_1(t) - y_2(t)$:\n$$\n\\Delta y(t) = u_0(1 - \\exp(-k_1 t)) - u_0(1 - \\exp(-k_2 t)) = u_0(\\exp(-k_2 t) - \\exp(-k_1 t))\n$$\nTo find the time $t^*$ at which the magnitude of this difference, $|\\Delta y(t)|$, is maximized, we first find the extrema of $\\Delta y(t)$ by setting its derivative with respect to $t$ equal to zero.\n$$\n\\frac{d}{dt}(\\Delta y(t)) = u_0(-k_2 \\exp(-k_2 t) - (-k_1)\\exp(-k_1 t)) = u_0(k_1 \\exp(-k_1 t) - k_2 \\exp(-k_2 t))\n$$\nSetting the derivative to zero at $t = t^*$:\n$$\nk_1 \\exp(-k_1 t^*) - k_2 \\exp(-k_2 t^*) = 0\n$$\n$$\nk_1 \\exp(-k_1 t^*) = k_2 \\exp(-k_2 t^*)\n$$\nTo solve for $t^*$, we take the natural logarithm of both sides:\n$$\n\\ln(k_1) - k_1 t^* = \\ln(k_2) - k_2 t^*\n$$\n$$\n(k_2 - k_1)t^* = \\ln(k_2) - \\ln(k_1) = \\ln\\left(\\frac{k_2}{k_1}\\right)\n$$\nThe analytical expression for the time of maximum difference is:\n$$\nt^* = \\frac{\\ln(k_2/k_1)}{k_2 - k_1}\n$$\nSince $k_2=2\\,\\text{day}^{-1}$ and $k_1=1\\,\\text{day}^{-1}$, we have $k_2 > k_1>0$. For $t>0$, $k_2 t > k_1 t$, which implies $-k_2 t < -k_1 t$ and $\\exp(-k_2 t) < \\exp(-k_1 t)$. Thus, $\\Delta y(t)$ is negative for all $t>0$. Maximizing its magnitude $|\\Delta y(t)|$ is equivalent to finding the time of its minimum value, which corresponds to the unique critical point we found.\n\nFinally, we evaluate $t^*$ numerically using the given values $k_1 = 1\\,\\text{day}^{-1}$ and $k_2 = 2\\,\\text{day}^{-1}$:\n$$\nt^* = \\frac{\\ln(2/1)}{2 - 1} = \\frac{\\ln(2)}{1} = \\ln(2)\\,\\text{days}\n$$\nNumerically, $\\ln(2) \\approx 0.693147...$. Rounding to four significant figures gives:\n$$\nt^* \\approx 0.6931\\,\\text{days}\n$$",
            "answer": "$$\n\\boxed{0.6931}\n$$"
        },
        {
            "introduction": "To bring these concepts to life, this final practice moves from analytical derivation to computational simulation. You will implement a common soil water balance model to demonstrate how a system's 'memory,' encapsulated in its initial state, dictates its future trajectory even under identical external forcing. This hands-on coding task provides a concrete illustration of path dependence and underscores the inadequacy of static models for systems where history matters.",
            "id": "3915716",
            "problem": "You are to demonstrate, through a precise computation, why static mappings from meteorological forcing to surface fluxes are inadequate for earth system modeling when state variables exhibit memory. Consider a vertically lumped one-layer soil bucket model with storage constrained between zero and a maximum capacity, forced by identical daily precipitation and potential evapotranspiration time series. Your task is to implement both a dynamic model and a static mapping model, compute resulting evapotranspiration flux trajectories, and quantify divergence arising solely from differences in initial soil moisture.\n\nFundamental base and definitions to use are as follows. Let soil water storage be $S(t)$ in $\\mathrm{mm}$; potential evapotranspiration be $E_{p}(t)$ in $\\mathrm{mm}/\\mathrm{day}$; daily precipitation be $P(t)$ in $\\mathrm{mm}/\\mathrm{day}$; and maximum storage be $S_{\\max}$ in $\\mathrm{mm}$. The daily water balance is given by the conservation principle\n$$\\frac{dS}{dt} = P(t) - E(t) - D(t) - R(t),$$\nwhere $E(t)$ is the actual evapotranspiration in $\\mathrm{mm}/\\mathrm{day}$, $D(t)$ is slow drainage in $\\mathrm{mm}/\\mathrm{day}$, and $R(t)$ is quick runoff in $\\mathrm{mm}/\\mathrm{day}$. Use a discrete-time update with daily time step and the physically consistent ordering: precipitation is added to storage, then evapotranspiration and drainage are removed, and any overflow beyond capacity is treated implicitly by storage capping. Specifically, for each day $t$,\n$$S^{+}(t) = \\min\\{S_{\\max}, S(t) + P(t)\\},$$\n$$E(t) = E_{p}(t)\\,\\phi\\!\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right),\\quad \\phi(u) = u^{\\alpha},\\quad 0 \\le u \\le 1,$$\n$$E(t) \\le S^{+}(t),\\quad D(t) = k_{d}\\,S^{+}(t),$$\n$$S(t+1) = \\max\\{0,\\, S^{+}(t) - E(t) - D(t)\\}.$$\nAll quantities are in $\\mathrm{mm}$ or $\\mathrm{mm}/\\mathrm{day}$ as appropriate. The static mapping model defines actual evapotranspiration as a state-independent scalar multiple of potential evapotranspiration,\n$$E_{\\text{stat}}(t) = c\\,E_{p}(t),$$\nwith constant $c \\in (0,1)$, hence identical forcing yields identical $E_{\\text{stat}}(t)$ regardless of initial soil moisture.\n\nForcing time series are identical across all test cases and specified by deterministic, nonnegative daily sequences of length $T$ days:\n- Number of days: $T = 60$.\n- Potential evapotranspiration: $E_{p}(t) = \\mathrm{clip}\\left(4 + 2\\sin\\left(\\frac{2\\pi t}{30}\\right),\\, 1,\\, 7\\right)$ in $\\mathrm{mm}/\\mathrm{day}$ for $t = 1,\\dots,60$; the clipping bounds enforce $1 \\le E_{p}(t) \\le 7$ in $\\mathrm{mm}/\\mathrm{day}$.\n- Precipitation: $P(t) = \\mathrm{clip}\\left(0.5 + 5\\max\\!\\left(0, \\sin\\left(\\frac{2\\pi (t+5)}{15}\\right)\\right),\\, 0,\\, 8\\right)$ in $\\mathrm{mm}/\\mathrm{day}$ for $t = 1,\\dots,60$; the clipping bounds enforce $0 \\le P(t) \\le 8$ in $\\mathrm{mm}/\\mathrm{day}$.\n\nModel parameters are fixed across all test cases and are as follows: $S_{\\max} = 100$ $\\mathrm{mm}$, $\\alpha = 1.5$, $k_{d} = 0.02$ $\\mathrm{day}^{-1}$, and $c = 0.7$ (dimensionless). Potential Evapotranspiration (PET) is the meteorological demand $E_{p}(t)$, while actual evapotranspiration $E(t)$ is controlled by storage via $\\phi(\\cdot)$.\n\nImplement the dynamic model update and the static mapping above. For each test case, run two simulations differing only by initial storage $S(1)$ while using the identical forcing for both runs. Compute the root-mean-square divergence between the two dynamic evapotranspiration trajectories,\n$$D_{\\text{dyn}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E^{(1)}(t) - E^{(2)}(t)\\right)^{2}} \\quad \\text{in}\\ \\mathrm{mm}/\\mathrm{day},$$\nand compute the corresponding static divergence,\n$$D_{\\text{stat}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E_{\\text{stat}}(t) - E_{\\text{stat}}(t)\\right)^{2}} = 0 \\quad \\text{in}\\ \\mathrm{mm}/\\mathrm{day}.$$\nYour output for each test case must be the ordered pair $[D_{\\text{dyn}}, D_{\\text{stat}}]$ in $\\mathrm{mm}/\\mathrm{day}$.\n\nUse the following test suite of initial storage pairs, all in $\\mathrm{mm}$:\n- Case $1$ (general variability): $(S_{0}^{(1)}, S_{0}^{(2)}) = (10, 60)$.\n- Case $2$ (near-desiccation versus moderate moisture): $(S_{0}^{(1)}, S_{0}^{(2)}) = (0.5, 30)$.\n- Case $3$ (near saturation versus low moisture): $(S_{0}^{(1)}, S_{0}^{(2)}) = (90, 20)$.\n- Case $4$ (boundary condition of identical initial state): $(S_{0}^{(1)}, S_{0}^{(2)}) = (50, 50)$.\n\nExpress $D_{\\text{dyn}}$ and $D_{\\text{stat}}$ in $\\mathrm{mm}/\\mathrm{day}$ as real numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is the two-element list $[D_{\\text{dyn}},D_{\\text{stat}}]$ for the respective test case, in order. For example, an output of the form $[[x_{1},y_{1}],[x_{2},y_{2}],\\dots]$ where $x_{i}$ and $y_{i}$ are floats in $\\mathrm{mm}/\\mathrm{day}$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides a complete set of deterministic equations, parameters, and initial conditions to uniquely solve for the specified outputs. The problem poses a standard, illustrative exercise in earth system modeling, contrasting a state-dependent (dynamic) model with a state-independent (static) model to demonstrate the concept of system memory.\n\nThe core of this problem lies in demonstrating path-dependence in a dynamic system, where the system's current state and future evolution depend on its history, encapsulated by its state variables. In contrast, a static system's output is solely a function of its current inputs, devoid of memory. Here, soil moisture, $S(t)$, is the state variable that carries the system's memory.\n\nThe dynamic model is a discrete-time representation of the soil water balance. For each day $t$, from $t=1$ to $T=60$, the simulation proceeds according to the following steps for a given initial storage $S(t)$ at the start of the day.\n\n1.  **Antecedent Storage Update**: First, daily precipitation $P(t)$ is added to the storage from the previous day, $S(t)$. Any amount exceeding the maximum capacity $S_{\\max}$ is assumed to become immediate surface runoff and is implicitly removed by capping the storage. This intermediate storage value is denoted $S^{+}(t)$.\n    $$S^{+}(t) = \\min\\{S_{\\max}, S(t) + P(t)\\}$$\n    Here, $S_{\\max} = 100\\,\\mathrm{mm}$.\n\n2.  **Flux Calculation**: Next, the outgoing fluxes—actual evapotranspiration $E(t)$ and drainage $D(t)$—are calculated based on this updated antecedent storage $S^{+}(t)$.\n    - Actual evapotranspiration $E(t)$ is a function of both the atmospheric demand, represented by potential evapotranspiration $E_{p}(t)$, and the water availability, represented by the relative soil moisture $\\frac{S^{+}(t)}{S_{\\max}}$. The nonlinear relationship is given by:\n      $$E(t) = E_{p}(t)\\,\\phi\\!\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right) = E_{p}(t)\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right)^{\\alpha}$$\n      with the parameter $\\alpha = 1.5$. A check confirms that the given parameters ensure the physical constraint $E(t) \\le S^{+}(t)$ is always met, as $E_p(t)/S_{\\max} \\le 7/100 = 0.07 \\ll 1$.\n    - Drainage $D(t)$ is modeled as a linear reservoir, proportional to the antecedent storage:\n      $$D(t) = k_{d}\\,S^{+}(t)$$\n      with the drainage constant $k_{d} = 0.02\\,\\mathrm{day}^{-1}$.\n\n3.  **End-of-Day Storage**: Finally, the storage for the beginning of the next day, $S(t+1)$, is computed by subtracting the outgoing fluxes from $S^{+}(t)$. The storage is prevented from becoming negative, with any deficit treated as an unmet demand.\n    $$S(t+1) = \\max\\{0,\\, S^{+}(t) - E(t) - D(t)\\}$$\n\nThis sequence is iterated for $T=60$ days. The crucial point is that the output flux $E(t)$ depends on the state $S(t)$. Since $S(t)$ from one simulation can differ from another due to a different initial condition $S(1)$, their respective evapotranspiration trajectories, $E^{(1)}(t)$ and $E^{(2)}(t)$, will also differ. This difference, quantified by the root-mean-square divergence $D_{\\text{dyn}}$, demonstrates the model's memory of its initial state.\n$$D_{\\text{dyn}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E^{(1)}(t) - E^{(2)}(t)\\right)^{2}}$$\n\nConversely, the static model is defined by a memoryless mapping:\n$$E_{\\text{stat}}(t) = c\\,E_{p}(t)$$\nwith the constant coefficient $c = 0.7$. In this model, the output $E_{\\text{stat}}(t)$ depends only on the current input $E_{p}(t)$. Therefore, for two simulations forced by the same $E_{p}(t)$ time series, the output trajectories will be identical regardless of any notional \"initial state\". This leads to a divergence of zero by definition:\n$$D_{\\text{stat}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E_{\\text{stat}}(t) - E_{\\text{stat}}(t)\\right)^{2}} = 0$$\n\nThe forcing time series for potential evapotranspiration, $E_p(t)$, and precipitation, $P(t)$, are generated for $t=1, \\dots, 60$ using the provided deterministic functions:\n$$E_{p}(t) = \\mathrm{clip}\\left(4 + 2\\sin\\left(\\frac{2\\pi t}{30}\\right),\\, 1,\\, 7\\right)$$\n$$P(t) = \\mathrm{clip}\\left(0.5 + 5\\max\\!\\left(0, \\sin\\left(\\frac{2\\pi (t+5)}{15}\\right)\\right),\\, 0,\\, 8\\right)$$\n\nThe implementation will proceed by first generating these forcing time series. Then, for each test case pair of initial conditions $(S_{0}^{(1)}, S_{0}^{(2)})$, two separate simulations of the dynamic model will be run to generate the actual evapotranspiration time series $E^{(1)}(t)$ and $E^{(2)}(t)$. The divergence $D_{\\text{dyn}}$ is then computed. For Case 4, where $S_{0}^{(1)} = S_{0}^{(2)} = 50\\,\\mathrm{mm}$, we expect $D_{\\text{dyn}} = 0$, providing a consistency check. The value of $D_{\\text{stat}}$ is always $0$. The final output will be a list of the pairs $[D_{\\text{dyn}}, D_{\\text{stat}}]$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares a dynamic soil moisture model with a static mapping\n    to demonstrate the effect of state memory on model outputs.\n    \"\"\"\n    \n    # Model parameters and constants\n    T = 60  # Number of days\n    S_max = 100.0  # Maximum storage (mm)\n    alpha = 1.5  # Evapotranspiration exponent\n    k_d = 0.02  # Drainage coefficient (day^-1)\n    c = 0.7  # Static model coefficient\n    \n    # Define the test cases for initial storage (mm)\n    test_cases = [\n        (10.0, 60.0),    # Case 1: general variability\n        (0.5, 30.0),     # Case 2: near-desiccation vs moderate\n        (90.0, 20.0),    # Case 3: near-saturation vs low\n        (50.0, 50.0)     # Case 4: identical initial state (sanity check)\n    ]\n\n    # Generate forcing time series\n    # Time array t from 1 to T (60)\n    time_t = np.arange(1, T + 1)\n    \n    # Potential Evapotranspiration (Ep)\n    ep_series = 4.0 + 2.0 * np.sin(2.0 * np.pi * time_t / 30.0)\n    ep_series = np.clip(ep_series, 1.0, 7.0)\n    \n    # Precipitation (P)\n    p_sin_arg = 2.0 * np.pi * (time_t + 5.0) / 15.0\n    p_series = 0.5 + 5.0 * np.maximum(0, np.sin(p_sin_arg))\n    p_series = np.clip(p_series, 0.0, 8.0)\n\n    def run_dynamic_model(S_initial, T, S_max, alpha, k_d, p_series, ep_series):\n        \"\"\"\n        Simulates the dynamic soil bucket model for T days.\n\n        Args:\n            S_initial (float): Initial soil water storage (mm).\n            T (int): Number of simulation days.\n            S_max (float): Maximum soil water storage (mm).\n            alpha (float): Evapotranspiration parameter.\n            k_d (float): Drainage coefficient (day^-1).\n            p_series (np.ndarray): Time series of precipitation (mm/day).\n            ep_series (np.ndarray): Time series of potential ET (mm/day).\n\n        Returns:\n            np.ndarray: Time series of actual evapotranspiration (mm/day).\n        \"\"\"\n        S = np.zeros(T)\n        E_actual = np.zeros(T)\n        \n        current_S = S_initial\n        \n        for t in range(T):\n            # Storage after precipitation\n            S_plus = min(S_max, current_S + p_series[t])\n            \n            # Calculate fluxes based on S_plus\n            # Relative storage u = S_plus / S_max\n            rel_storage = S_plus / S_max\n            # Actual Evapotranspiration E(t)\n            E = ep_series[t] * (rel_storage ** alpha)\n            \n            # Drainage D(t)\n            D = k_d * S_plus\n            \n            # Update storage for the next day\n            next_S = max(0, S_plus - E - D)\n            \n            # Store results\n            S[t] = next_S\n            E_actual[t] = E\n            \n            # Update current storage for next iteration\n            current_S = next_S\n            \n        return E_actual\n\n    results = []\n    \n    for s0_1, s0_2 in test_cases:\n        # Run dynamic model for both initial conditions\n        E_traj_1 = run_dynamic_model(s0_1, T, S_max, alpha, k_d, p_series, ep_series)\n        E_traj_2 = run_dynamic_model(s0_2, T, S_max, alpha, k_d, p_series, ep_series)\n        \n        # Calculate dynamic divergence\n        diff_sq = (E_traj_1 - E_traj_2) ** 2\n        mean_sq_diff = np.mean(diff_sq)\n        D_dyn = np.sqrt(mean_sq_diff)\n        \n        # Static divergence is always 0 by definition\n        D_stat = 0.0\n        \n        results.append([D_dyn, D_stat])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, so we need to stringify each inner list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}