{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳方式是付诸实践。本节将通过一系列动手练习，帮助你巩固和应用状态变量与参数的核心概念。我们从地球系统建模中最基础的工具之一——箱式模型开始。这个练习将引导你通过分析一个简化的碳储库模型，明确区分系统的状态变量、参数和外部强迫，并从第一性原理出发求解其动态演化过程。通过这个过程，你将深刻理解物理守恒定律如何转化为描述系统行为的数学方程。",
            "id": "3915326",
            "problem": "一个陆地碳库由一个单一的、充分混合的箱室表示，其碳储量为 $C(t)$，其中 $t$ 表示时间。碳储量的演变遵循质量守恒定律，即储量的变化率等于输入量减去输出量：$\\dot{C}(t)=\\text{inputs}(t)-\\text{outputs}(t)$。假设输出通量与当前储量成正比，比例常数为 $k>0$，并且输入是一个外部给定的强迫 $F(t)$。因此，其控制常微分方程（ODE）为\n$$\n\\dot{C}(t)=-k\\,C(t)+F(t).\n$$\n在状态空间模型的框架下解释此常微分方程。具体来说：\n- 确定哪个量是状态变量，哪些量是参数，哪些是外源强迫，并使用常微分方程的结构和量纲分析来证明你的识别。假设 $C$ 的单位是质量（例如，拍克碳），$t$ 的单位是时间（例如，年），$F$ 的单位是质量/时间。\n- 对于一个在时间 $t=0$ 施加的、大小恒为 $F_{0}$ 的阶跃强迫，即当 $t\\ge 0$ 时 $F(t)=F_{0}$，并在初始条件为 $C(0)=C_{i}$ 的情况下，仅使用质量守恒和标准微积分，从第一性原理推导出 $C(t)$（当 $t\\ge 0$）的解析表达式，而不套用任何预先记忆的求解公式。\n\n将 $C(t)$ 的最终表达式以 $t$、$C_{i}$、$k$ 和 $F_{0}$ 的闭式解析函数形式报告。不要在你最终的方框答案中包含单位。如果你得到任何极限值，不要报告它们；只报告 $C(t)$ 的完整表达式。",
            "solution": "问题陈述经评估有效。它提出了一个标准的、适定的初值问题，该问题基于地球系统科学中使用的基本箱室模型方法。该问题具有科学依据、内容自洽，且没有矛盾或模糊之处。\n\n问题要求完成两项任务：首先，在状态空间模型的框架下解释控制常微分方程（ODE）的各个组成部分；其次，在特定的强迫情景下推导碳储量 $C(t)$ 的解析解。\n\n**第1部分：常微分方程各部分的解释**\n\n控制常微分方程给出为：\n$$\n\\dot{C}(t) = -k\\,C(t) + F(t)\n$$\n其中 $\\dot{C}(t)$ 表示时间导数 $\\frac{dC}{dt}$。\n\n**状态变量：**\n动力学系统的状态变量是一个量，其在给定时间 $t$ 的值完全确定了系统的状态。其未来的演变仅取决于其当前值以及在时间大于 $t$ 时的任何外部输入（强迫）。在给定的常微分方程中，碳储量的变化率 $\\dot{C}(t)$ 是储量本身 $C(t)$ 和外部输入 $F(t)$ 的函数。在任何时间 $t_0$ 知道 $C(t)$ 的值，以及当 $t \\ge t_0$ 时函数 $F(t)$ 的形式，就足以确定碳储量的整个未来轨迹。因此，$C(t)$ 是该系统的状态变量。\n\n**参数：**\n参数是模型中的常数，它们定义了系统的内在结构和行为。它们不是时间的函数，也不依赖于状态变量。在方程中，$k$ 是一个正常数，它决定了输出通量相对于储量大小的速率。它代表了碳库的固有属性，例如特征衰减率或周转率，并且不随时间或 $C$ 的值而改变。因此，$k$ 是一个参数。对于 $F(t) = F_0$ 的特定情况，常数 $F_0$ 也是一个定义恒定强迫大小的参数。初始条件 $C_i$ 是用于求特解的状态变量的特定值，而不是系统动力学本身的参数。\n\n**外源强迫：**\n外源强迫是一种驱动系统演变的外部输入，但它本身不受系统状态的影响。在常微分方程的一般形式中，$F(t)$ 代表进入碳库的碳输入通量。它的值是外部给定的，并且独立于 $C(t)$。因此，$F(t)$ 是外源强迫。对于待求解的特定问题，该强迫采用常数阶跃函数的形式，$F(t) = F_0$（当 $t \\ge 0$ 时）。\n\n**量纲分析证明：**\n提供的单位是：$[C] = M$ (质量)，$[t] = T$ (时间)，$[F] = M \\cdot T^{-1}$ (质量/时间)。\n常微分方程是 $\\dot{C} = -kC + F$。为了保证量纲一致性，该方程中的每一项都必须具有相同的单位。\n$\\dot{C} = \\frac{dC}{dt}$ 项的单位是 $\\frac{[C]}{[t]} = M \\cdot T^{-1}$。\n强迫项 $F$ 的单位是 $M \\cdot T^{-1}$，这是一致的。\n$-kC$ 项也必须具有 $M \\cdot T^{-1}$ 的单位。由于 $C$ 的单位是 $M$，参数 $k$ 的单位必须是 $\\frac{M \\cdot T^{-1}}{M} = T^{-1}$。一个单位为时间倒数的参数代表一个速率常数，这与其作为定义碳库动力学内在时间尺度（其停留时间为 $\\frac{1}{k}$）的参数作用是一致的。\n\n**第2部分：解析解的推导**\n\n问题要求解由以下定义的初值问题：\n$$\n\\frac{dC}{dt} = -k\\,C(t) + F_0, \\quad C(0) = C_i\n$$\n这是一个一阶线性非齐次常微分方程。题目要求我们从第一性原理推导解。我们将使用积分因子法。\n\n首先，将常微分方程整理成标准线性形式：\n$$\n\\frac{dC}{dt} + k\\,C(t) = F_0\n$$\n积分因子（我们记作 $\\mu(t)$）是一个函数，当方程两边都乘以它时，方程的左边会变成一个乘积法则求导的结果。对于形式为 $y' + p(t)y = q(t)$ 的方程，积分因子为 $\\mu(t) = \\exp\\left(\\int p(t) dt\\right)$。在我们的例子中，$p(t) = k$，是一个常数。\n所以，积分因子是：\n$$\n\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)\n$$\n我们可以省略积分常数，因为积分因子的任何非零倍数仍然是积分因子。\n\n现在，将整个常微分方程乘以 $\\mu(t) = \\exp(kt)$：\n$$\n\\exp(kt)\\frac{dC}{dt} + k\\exp(kt)C(t) = F_0\\exp(kt)\n$$\n根据构造，方程的左边现在是乘积 $C(t)\\exp(kt)$ 的导数：\n$$\n\\frac{d}{dt}\\left( C(t)\\exp(kt) \\right) = F_0\\exp(kt)\n$$\n为了求解 $C(t)$，我们将方程两边对时间从 $0$ 到 $t$ 进行积分：\n$$\n\\int_0^t \\frac{d}{d\\tau}\\left( C(\\tau)\\exp(k\\tau) \\right) d\\tau = \\int_0^t F_0\\exp(k\\tau) d\\tau\n$$\n对左边应用微积分基本定理：\n$$\n\\left[ C(\\tau)\\exp(k\\tau) \\right]_0^t = F_0 \\int_0^t \\exp(k\\tau) d\\tau\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(k \\cdot 0) = F_0 \\left[ \\frac{1}{k}\\exp(k\\tau) \\right]_0^t\n$$\n代入初始条件 $C(0) = C_i$ 和 $\\exp(0) = 1$：\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - \\exp(0) \\right)\n$$\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - 1 \\right)\n$$\n现在，我们求解 $C(t)$。首先，在方程两边加上 $C_i$：\n$$\nC(t)\\exp(kt) = C_i + \\frac{F_0}{k}\\exp(kt) - \\frac{F_0}{k}\n$$\n最后，将整个方程乘以 $\\exp(-kt)$ 以分离出 $C(t)$：\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k}\\exp(kt)\\exp(-kt) - \\frac{F_0}{k}\\exp(-kt)\n$$\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k} - \\frac{F_0}{k}\\exp(-kt)\n$$\n将包含 $\\exp(-kt)$ 的项和常数项组合在一起，得到最终表达式：\n$$\nC(t) = \\frac{F_0}{k} + \\left( C_i - \\frac{F_0}{k} \\right) \\exp(-kt)\n$$\n这就是当 $t \\ge 0$ 时，碳储量 $C(t)$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{F_{0}}{k} + \\left(C_{i} - \\frac{F_{0}}{k}\\right)\\exp(-kt)}\n$$"
        },
        {
            "introduction": "在掌握了描述均一系统（集总参数系统）的箱式模型后，我们进一步探索空间上变化的系统（分布式参数系统）。许多地球系统过程，如土壤中的热量传导或海洋中的物质扩散，其属性在空间上并非均匀分布。本练习以一维热传导方程为例，展示了“状态”的概念如何从单个数值扩展为一个连续的函数或场（例如温度剖面），而参数（如热扩散系数 $\\kappa$）则决定了这个场如何随时间演化。求解这个偏微分方程将加深你对更复杂物理模型中状态与参数关系的理解。",
            "id": "3915315",
            "problem": "考虑一个高度为 $H$ 的均质土壤柱中的垂直热扩散，其模型为一维（1D）偏微分方程（PDE）热方程\n$$\\partial_{t} T(z,t) = \\kappa \\,\\partial_{zz} T(z,t), \\quad 0",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：温度异常 $T(z,t)$ 的一维热方程为 $\\partial_{t} T(z,t) = \\kappa \\,\\partial_{zz} T(z,t)$，其中 $00$\n- **初始条件 (IC)**：在 $t=0$ 时，温度剖面为 $T(z,0) = \\Theta_{0} \\left(1 - \\frac{z}{H}\\right)$\n\n这是一个具有齐次边界条件的线性偏微分方程，因此，将解分解为稳态解和瞬态解是一种有效的方法：$T(z,t) = T_{ss}(z) + T_{tr}(z,t)$。\n\n### 第 2 步：求解稳态解 ($T_{ss}(z)$)\n稳态解不随时间变化，因此 $\\partial_t T_{ss}(z) = 0$。代入热方程得到：\n$$\n\\kappa \\,\\frac{d^2 T_{ss}}{dz^2} = 0 \\quad \\implies \\quad \\frac{d^2 T_{ss}}{dz^2} = 0\n$$\n对 $z$ 积分两次得到 $T_{ss}(z) = c_1 z + c_2$。应用边界条件：\n- $T_{ss}(0) = c_1(0) + c_2 = 0 \\implies c_2 = 0$\n- $T_{ss}(H) = c_1 H + c_2 = 0 \\implies c_1 H = 0 \\implies c_1 = 0$\n因此，稳态解为 $T_{ss}(z) = 0$。\n\n### 第 3 步：求解瞬态解 ($T_{tr}(z,t)$)\n由于 $T_{ss}(z) = 0$，完整的解就是瞬态解，$T(z,t) = T_{tr}(z,t)$。瞬态解必须满足原始的偏微分方程和边界条件。其初始条件为：\n$$\nT_{tr}(z,0) = T(z,0) - T_{ss}(z) = \\Theta_0 \\left(1 - \\frac{z}{H}\\right) - 0 = \\Theta_0 \\left(1 - \\frac{z}{H}\\right)\n$$\n我们使用分离变量法，假设 $T_{tr}(z,t) = Z(z)X(t)$。代入偏微分方程得到：\n$$\nZ(z) X'(t) = \\kappa Z''(z) X(t) \\quad \\implies \\quad \\frac{X'(t)}{\\kappa X(t)} = \\frac{Z''(z)}{Z(z)} = -\\lambda\n$$\n其中 $\\lambda$ 是一个常数。\n\n**空间部分 ($Z(z)$):**\n$$\nZ''(z) + \\lambda Z(z) = 0\n$$\n边界条件 $T_{tr}(0,t)=0 \\implies Z(0)=0$ 和 $T_{tr}(H,t)=0 \\implies Z(H)=0$。这是一个标准的斯图姆-刘维尔问题，其解为：\n- **特征值**：$\\lambda_n = \\left(\\frac{n\\pi}{H}\\right)^2$\n- **特征函数**：$Z_n(z) = \\sin\\left(\\frac{n\\pi z}{H}\\right)$，其中 $n = 1, 2, 3, \\dots$\n\n**时间部分 ($X(t)$):**\n$$\nX'(t) + \\kappa \\lambda_n X(t) = 0 \\quad \\implies \\quad X_n(t) = c_n \\exp(-\\kappa \\lambda_n t) = c_n \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n$$\n其中 $c_n$ 是待定系数。\n\n### 第 4 步：构建完整解并应用初始条件\n将以上部分组合，完整的瞬态解是这些解的线性叠加：\n$$\nT(z,t) = \\sum_{n=1}^{\\infty} c_n \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n$$\n我们通过在 $t=0$ 时应用初始条件来确定系数 $c_n$：\n$$\nT(z,0) = \\Theta_0 \\left(1 - \\frac{z}{H}\\right) = \\sum_{n=1}^{\\infty} c_n \\sin\\left(\\frac{n\\pi z}{H}\\right)\n$$\n这是初始条件函数的傅里叶正弦级数。系数 $c_n$ 由以下公式给出：\n$$\nc_n = \\frac{2}{H} \\int_0^H \\Theta_0 \\left(1 - \\frac{z}{H}\\right) \\sin\\left(\\frac{n\\pi z}{H}\\right) dz\n$$\n$$\nc_n = \\frac{2\\Theta_0}{H} \\left[ \\int_0^H \\sin\\left(\\frac{n\\pi z}{H}\\right) dz - \\frac{1}{H} \\int_0^H z \\sin\\left(\\frac{n\\pi z}{H}\\right) dz \\right]\n$$\n计算积分：\n- $\\int_0^H \\sin\\left(\\frac{n\\pi z}{H}\\right) dz = \\left[-\\frac{H}{n\\pi}\\cos\\left(\\frac{n\\pi z}{H}\\right)\\right]_0^H = -\\frac{H}{n\\pi}(\\cos(n\\pi) - 1) = \\frac{H}{n\\pi}(1 - (-1)^n)$\n- $\\int_0^H z \\sin\\left(\\frac{n\\pi z}{H}\\right) dz$ (使用分部积分法) $= \\left[ -\\frac{zH}{n\\pi}\\cos\\left(\\frac{n\\pi z}{H}\\right) + \\left(\\frac{H}{n\\pi}\\right)^2\\sin\\left(\\frac{n\\pi z}{H}\\right) \\right]_0^H = -\\frac{H^2}{n\\pi}\\cos(n\\pi) = -\\frac{H^2}{n\\pi}(-1)^n$\n\n代入 $c_n$ 的表达式：\n$$\nc_n = \\frac{2\\Theta_0}{H} \\left[ \\frac{H}{n\\pi}(1 - (-1)^n) - \\frac{1}{H} \\left(-\\frac{H^2}{n\\pi}(-1)^n\\right) \\right]\n$$\n$$\nc_n = \\frac{2\\Theta_0}{n\\pi} \\left[ (1 - (-1)^n) + (-1)^n \\right] = \\frac{2\\Theta_0}{n\\pi}\n$$\n\n将系数代入，我们得到瞬态解为：\n$$\nT_{\\text{tr}}(z,t) = \\sum_{n=1}^{\\infty} \\frac{2\\Theta_0}{n\\pi} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n$$\n由于稳态解 $T_{ss}(z)=0$，该瞬态解即为完整的解 $T(z,t)$。将其写成更紧凑的形式，可得：\n$$\nT(z,t) = \\frac{2\\Theta_0}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n$$",
            "answer": "$$\n\\boxed{\nT(z,t) = \\frac{2\\Theta_{0}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n}\n$$"
        },
        {
            "introduction": "在理论模型中，我们通常假设参数是已知的。然而在实际研究中，一个核心问题是：“这些参数的值从何而来？”本练习将带你从解析模型的世界走向数据驱动的建模实践。我们将解决一个在生态学和地球系统模型中至关重要的问题：如何利用观测数据来确定模型参数。这个编程练习将指导你完成一个完整的参数校准流程，包括将一个非线性的生物地球化学模型（$Q_{10}$ 温度响应函数）线性化，使用最小二乘法估计关键参数 $Q_{10}$，并量化其不确定性。这能让你体验到现代环境建模者的一项核心工作。",
            "id": "3915317",
            "problem": "您正在模拟土壤中对温度敏感的异养呼吸，其中一阶过程速率的温度响应由广泛使用的 $Q_{10}$ 定律表示。在此设定中，一个过程速率参数 $k(T)$ 通过具有两个参数的参数化形式依赖于一个状态变量 $T$（温度）：一个基准速率 $k_0$ 和一个温度敏感性因子 $Q_{10}$。其函数形式为\n$$\nk(T) \\;=\\; k_0 \\, Q_{10}^{\\frac{T - 20}{10}},\n$$\n其中 $T$ 是以摄氏度为单位的温度，$k(T)$ 的单位是 $\\mathrm{d}^{-1}$（每天），$k_0$ 的单位是 $\\mathrm{d}^{-1}$（每天），而 $Q_{10}$ 是无量纲的。将 $k_0$ 和 $Q_{10}$ 视为待校准的参数，并将 $k(T)$ 看作是与状态变量 $T$ 相关联的参数化速率。\n\n从基本的统计和物理建模基础出发：\n- 上述定律定义了 $k(T)$、$k_0$、$Q_{10}$ 和 $T$ 之间的确定性联系。\n- 假设在温度 $T_i$ 下的速率观测值 $k_{\\mathrm{obs},i}$ 为正，并遵循与对数正态噪声一致的乘性误差，这意味着 $\\ln k_{\\mathrm{obs},i}$ 被建模为具有加性高斯误差的线性回归。\n\n使用这些基础，通过以下步骤从观测值 $\\{(T_i,k_{\\mathrm{obs},i})\\}_{i=1}^n$ 推导出一个用于 $Q_{10}$ 及其 $95\\%$ 置信区间的估计程序：\n- 转换到对数域中的一个线性模型，该模型具有截距和斜率，其中斜率等于 $\\ln(Q_{10})$，截距等于 $\\ln(k_0)$。\n- 使用普通最小二乘法 (OLS) 拟合转换后的模型。\n- 使用具有 $n-2$ 自由度的学生t分布为 $\\ln(Q_{10})$ 构建一个双侧 $95\\%$ 置信区间，然后通过指数函数将该区间映射回 $Q_{10}$。\n\n您的任务是编写一个完整、可运行的程序，为一组固定的测试用例实现此校准。对于每个用例，根据给定的真实参数值和指定的乘性扰动（以模拟测量变异性）确定性地构建观测值，然后执行校准。请使用以下测试套件。\n\n测试套件（每个用例指定温度、真实参数和乘性扰动；构建 $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$）：\n\n- 用例 A（理想路径，宽温度范围，中等噪声）：\n  - 温度 $T$（摄氏度）：$[5,10,15,20,25,30]$。\n  - 真实基准 $k_0$：$0.5 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$2.1$。\n  - 乘子 $m$：$[0.98, 1.03, 1.01, 1.00, 0.97, 1.02]$。\n\n- 用例 B（边界条件，近等温数据，斜率可识别性弱）：\n  - 温度 $T$（摄氏度）：$[19.5,20.0,20.5]$。\n  - 真实基准 $k_0$：$0.8 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$2.0$。\n  - 乘子 $m$：$[1.00, 1.02, 0.99]$。\n\n- 用例 C（边缘情况，宽温度范围伴有类离群值的扰动）：\n  - 温度 $T$（摄氏度）：$[0.0,10.0,20.0,30.0]$。\n  - 真实基准 $k_0$：$1.0 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$1.4$。\n  - 乘子 $m$：$[1.10, 0.90, 1.25, 0.85]$。\n\n实现要求：\n- 对于每个用例，构建设计变量 $x_i = \\frac{T_i - 20}{10}$ 和响应 $y_i = \\ln(k_{\\mathrm{obs},i})$。通过普通最小二乘法拟合线性模型 $y_i = a + b x_i + \\varepsilon_i$，其中 $a = \\ln(k_0)$，$b = \\ln(Q_{10})$，$\\varepsilon_i$ 是独立同分布、均值为零、方差为 $\\sigma^2$ 的高斯误差。\n- 使用基于残差方差估计 $\\hat{\\sigma}^2$ 和 $(X^\\top X)^{-1}$ 的常规公式计算 OLS 估计值 $\\hat{b}$ 及其标准误差 $\\mathrm{SE}(\\hat{b})$，其中 $X$ 是由一列1和一列 $x_i$ 组成的设计矩阵。\n- 将 $b$ 的双侧 $95\\%$ 置信区间构建为 $\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\,\\mathrm{SE}(\\hat{b})$，其中 $\\alpha = 0.05$，$\\nu = n-2$，$t_{1-\\alpha/2,\\nu}$ 是学生t分布的临界值。\n- 通过指数化将此区间转换为 $Q_{10}$，得到 $[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}] = [\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})]$，并计算点估计值 $\\widehat{Q}_{10} = \\exp(\\hat{b})$。\n\n物理和数值单位：\n- 温度 $T$ 以摄氏度为单位。\n- 速率 $k$ 和 $k_0$ 以 $\\mathrm{d}^{-1}$ 为单位。\n- 输出 $\\widehat{Q}_{10}$ 及其置信界限是无量纲的。\n- 不涉及角度单位。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含所有用例的结果，形式为列表的列表。对于每个用例，输出一个包含 $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$ 的三元素列表。\n- 所有浮点数必须四舍五入到小数点后恰好 $6$ 位。\n- 整体输出必须是单行，格式完全如下：\n  - 示例结构：$[[q_{A},q_{A,\\mathrm{lo}},q_{A,\\mathrm{hi}}],[q_{B},q_{B,\\mathrm{lo}},q_{B,\\mathrm{hi}}],[q_{C},q_{C,\\mathrm{lo}},q_{C,\\mathrm{hi}}]]$，\n不含多余的空格或文本。\n\n您的程序必须是自包含的，不需要任何输入，并遵守指定的执行环境。",
            "solution": "我们从一阶过程速率的机理温度响应开始，\n$$\nk(T) = k_0 \\, Q_{10}^{\\frac{T-20}{10}},\n$$\n其中 $T$ 是温度，$k_0$ 是在 $T=20\\,^{\\circ}\\mathrm{C}$ 时的基准速率，$Q_{10}$ 是当 $T$ 增加 $10\\,^{\\circ}\\mathrm{C}$ 时速率增加的无量纲因子。在环境和地球系统建模中，$k_0$ 和 $Q_{10}$ 是参数，$T$ 是由模型测量或模拟的状态变量。在温度 $T_i$ 下的观测速率 $k_{\\mathrm{obs},i}$ 被假定为正值，并且通常使用与对数正态噪声一致的乘性误差进行建模。\n\n为了利用线性回归，对两边取自然对数：\n$$\n\\ln k(T) = \\ln k_0 + \\left(\\frac{T - 20}{10}\\right)\\ln Q_{10}.\n$$\n定义 $x_i = \\frac{T_i - 20}{10}$ 和 $y_i = \\ln k_{\\mathrm{obs},i}$。那么\n$$\ny_i = a + b x_i + \\varepsilon_i,\n$$\n其中 $a = \\ln k_0$，$b = \\ln Q_{10}$，且 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 独立分布，这是一个标准的线性模型。普通最小二乘法 (OLS) 估计量最小化 $\\sum_i (y_i - a - b x_i)^2$。使用设计矩阵\n$$\nX = \\begin{bmatrix}\n1 & x_1\\\\\n\\vdots & \\vdots\\\\\n1 & x_n\n\\end{bmatrix}, \\quad\ny = \\begin{bmatrix}\ny_1\\\\\n\\vdots\\\\\ny_n\n\\end{bmatrix},\n$$\nOLS 估计值为\n$$\n\\hat{\\beta} = \\begin{bmatrix}\\hat{a}\\\\ \\hat{b}\\end{bmatrix} = (X^\\top X)^{-1} X^\\top y.\n$$\n残差为 $r = y - X \\hat{\\beta}$，无偏残差方差估计为\n$$\n\\hat{\\sigma}^2 = \\frac{r^\\top r}{n - p}, \\quad p=2,\n$$\n因为有 $p=2$ 个参数（$a$ 和 $b$）。$\\hat{\\beta}$ 的协方差矩阵是\n$$\n\\mathrm{Cov}(\\hat{\\beta}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}.\n$$\n斜率估计量 $\\hat{b}$ 的方差是该矩阵的 $(2,2)$ 元素，所以\n$$\n\\mathrm{SE}(\\hat{b}) = \\sqrt{\\left[\\mathrm{Cov}(\\hat{\\beta})\\right]_{22}}.\n$$\n对于 $b$ 的一个双侧 $95\\%$ 置信区间，使用自由度为 $\\nu = n-2$ 的学生t分布：\n$$\n\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\, \\mathrm{SE}(\\hat{b}), \\quad \\alpha = 0.05.\n$$\n设 $\\hat{b}_{\\mathrm{lo}}$ 和 $\\hat{b}_{\\mathrm{hi}}$ 分别表示下端点和上端点。因为 $Q_{10} = \\exp(b)$，所以在原始尺度上的点估计和置信区间为\n$$\n\\widehat{Q}_{10} = \\exp(\\hat{b}), \\quad\n\\left[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}\\right] = \\left[\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})\\right].\n$$\n\n算法实现：\n- 对于每个测试用例，按规定构建温度 $T_i$ 和乘子 $m_i$，确定性地计算 $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$，确保物理单位：$T_i$ 以摄氏度为单位，$k_{\\mathrm{obs},i}$ 以 $\\mathrm{d}^{-1}$ 为单位。根据构造，每个 $k_{\\mathrm{obs},i}$ 都是正数。\n- 构建 $x_i = \\frac{T_i - 20}{10}$ 和 $y_i = \\ln(k_{\\mathrm{obs},i})$。\n- 用一列1和一列 $x_i$ 组装 $X$，计算 $\\hat{\\beta}$、残差 $r$、$\\hat{\\sigma}^2$、$(X^\\top X)^{-1}$，并提取 $\\hat{b}$ 和 $\\mathrm{SE}(\\hat{b})$。\n- 从学生t分布在概率 $1-\\alpha/2$ 和自由度 $\\nu=n-2$ 处的累积分布函数的逆函数中获取 $t_{1-\\alpha/2,\\nu}$。\n- 计算 $b$ 尺度上的区间端点，并通过指数化映射回去，得到 $\\widehat{Q}_{10}$、$\\widehat{Q}_{10,\\mathrm{lo}}$ 和 $\\widehat{Q}_{10,\\mathrm{hi}}$。\n- 将每个数值结果四舍五入到小数点后恰好 $6$ 位，以保持输出格式的一致性。\n- 将三个用例的结果聚合到一个列表的列表中，每个内部列表按 $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$ 的顺序排列，并作为单行打印，不含多余的空格或文本。\n\n数值考量：\n- 因为用例中包含近等温数据（用例 B），$\\nu = n-2$ 可能很小，而 $t_{1-\\alpha/2,\\nu}$ 可能很大，导致置信区间很宽，这反映了从有限的温度变化中识别 $\\ln(Q_{10})$ 的能力很弱。\n- 因为所有的 $k_{\\mathrm{obs},i}$ 都严格为正，所以 $\\ln(k_{\\mathrm{obs},i})$ 是良定义的。\n- 在对数尺度上使用 OLS 方法与乘性误差假设一致，并且在对数域中高斯误差的假设下，能产生无偏的斜率估计。\n\n程序精确地遵循这些步骤，并以要求的单行格式打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t as student_t\n\ndef ols_q10_confidence_interval(T_celsius, k_obs):\n    \"\"\"\n    Fit y = a + b x + e on log-scale where:\n      x = (T - 20)/10\n      y = ln(k_obs)\n    Returns Q10_hat, Q10_CI_lower, Q10_CI_upper (two-sided 95% CI).\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    k_obs = np.asarray(k_obs, dtype=float)\n\n    # Design variable and response\n    x = (T_celsius - 20.0) / 10.0\n    y = np.log(k_obs)\n\n    n = x.size\n    # Design matrix with intercept\n    X = np.column_stack([np.ones(n), x])\n\n    # OLS estimates\n    XtX = X.T @ X\n    XtX_inv = np.linalg.inv(XtX)\n    beta_hat = XtX_inv @ (X.T @ y)\n    a_hat, b_hat = beta_hat[0], beta_hat[1]\n\n    # Residuals and variance estimate\n    residuals = y - X @ beta_hat\n    dof = n - 2\n    # Protect against division by zero; if dof = 0, this would be ill-posed (not in our test suite).\n    sigma2_hat = (residuals @ residuals) / dof\n\n    # Standard error of slope\n    var_b = sigma2_hat * XtX_inv[1, 1]\n    se_b = np.sqrt(var_b)\n\n    # t critical value for two-sided 95% CI\n    alpha = 0.05\n    tcrit = student_t.ppf(1.0 - alpha/2.0, dof)\n\n    # CI on b = ln(Q10)\n    b_lo = b_hat - tcrit * se_b\n    b_hi = b_hat + tcrit * se_b\n\n    # Map to Q10 scale\n    Q10_hat = float(np.exp(b_hat))\n    Q10_lo = float(np.exp(b_lo))\n    Q10_hi = float(np.exp(b_hi))\n\n    return Q10_hat, Q10_lo, Q10_hi\n\ndef generate_observations(T_celsius, k0_true, Q10_true, multipliers):\n    \"\"\"\n    Deterministically construct k_obs = m_i * k0_true * Q10_true ** ((T_i - 20)/10)\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    multipliers = np.asarray(multipliers, dtype=float)\n    x = (T_celsius - 20.0) / 10.0\n    k_obs = multipliers * (k0_true * (Q10_true ** x))\n    return k_obs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case A\n    T_A = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0]\n    k0_A = 0.5\n    Q10_A = 2.1\n    m_A = [0.98, 1.03, 1.01, 1.00, 0.97, 1.02]\n\n    # Case B\n    T_B = [19.5, 20.0, 20.5]\n    k0_B = 0.8\n    Q10_B = 2.0\n    m_B = [1.00, 1.02, 0.99]\n\n    # Case C\n    T_C = [0.0, 10.0, 20.0, 30.0]\n    k0_C = 1.0\n    Q10_C = 1.4\n    m_C = [1.10, 0.90, 1.25, 0.85]\n\n    # Construct observations\n    k_obs_A = generate_observations(T_A, k0_A, Q10_A, m_A)\n    k_obs_B = generate_observations(T_B, k0_B, Q10_B, m_B)\n    k_obs_C = generate_observations(T_C, k0_C, Q10_C, m_C)\n\n    # Calibrate and compute CIs\n    results = []\n    for T, kobs in [(T_A, k_obs_A), (T_B, k_obs_B), (T_C, k_obs_C)]:\n        q_hat, q_lo, q_hi = ols_q10_confidence_interval(T, kobs)\n        results.append([q_hat, q_lo, q_hi])\n\n    # Format results with exactly 6 decimals and as a single-line nested list without spaces.\n    def format_triple(triple):\n        return \"[\" + \",\".join(f\"{v:.6f}\" for v in triple) + \"]\"\n\n    output = \"[\" + \",\".join(format_triple(tri) for tri in results) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}