{
    "hands_on_practices": [
        {
            "introduction": "Before implementing a numerical scheme, we can predict its error characteristics through a powerful analytical technique. This practice guides you through deriving the modified equation for two foundational advection schemes. This 'pen-and-paper' exercise is crucial for developing intuition, as it reveals whether a scheme's leading error will be diffusive (causing amplitude damping) or dispersive (causing phase errors) and establishes its formal order of accuracy.",
            "id": "3899299",
            "problem": "Consider one-dimensional passive tracer advection in a straight channel with constant flow speed $u>0$, governed by the linear advection equation $q_t + u\\,q_x = 0$, where $q(x,t)$ is a sufficiently smooth concentration field. Let the spatial grid be uniform with spacing $\\Delta x$, the time step be $\\Delta t$, and define the Courant–Friedrichs–Lewy (CFL) number $C \\equiv u\\,\\Delta t/\\Delta x$. Two finite-difference schemes are considered on this grid: the forward-time upwind-space scheme for $u>0$, given by $q_j^{n+1} = q_j^n - C\\left(q_j^n - q_{j-1}^n\\right)$, and the Lax–Wendroff scheme, given by $q_j^{n+1} = q_j^n - \\frac{C}{2}\\left(q_{j+1}^n - q_{j-1}^n\\right) + \\frac{C^2}{2}\\left(q_{j+1}^n - 2q_j^n + q_{j-1}^n\\right)$. Using Taylor expansions about $(x_j,t^n)$ and the governing equation $q_t + u\\,q_x = 0$ as the fundamental base, argue for each scheme its formal order of accuracy in space and time, and classify the leading term in its modified equation as either diffusive (an even-order spatial derivative term that causes amplitude damping) or dispersive (an odd-order spatial derivative term that causes phase error). Which of the following statements correctly characterizes both schemes?\n\nA. Forward-time upwind-space is first-order accurate with a leading diffusive modified-equation term; Lax–Wendroff is second-order accurate with a leading dispersive modified-equation term.\n\nB. Forward-time upwind-space is second-order accurate with a leading dispersive modified-equation term; Lax–Wendroff is first-order accurate with a leading diffusive modified-equation term.\n\nC. Both schemes are first-order accurate with leading diffusive modified-equation terms.\n\nD. Forward-time upwind-space is first-order accurate with a leading dispersive modified-equation term; Lax–Wendroff is second-order accurate with a leading diffusive modified-equation term.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The one-dimensional linear advection equation for a passive tracer concentration $q(x,t)$ is $q_t + u\\,q_x = 0$, with constant flow speed $u>0$.\n- **Discretization:** The spatial grid is uniform with spacing $\\Delta x$, and the time step is $\\Delta t$.\n- **CFL Number:** The Courant–Friedrichs–Lewy (CFL) number is defined as $C \\equiv u\\,\\Delta t/\\Delta x$.\n- **Scheme 1 (Forward-Time Upwind-Space, FTUS):** For $u>0$, the scheme is $q_j^{n+1} = q_j^n - C\\left(q_j^n - q_{j-1}^n\\right)$.\n- **Scheme 2 (Lax–Wendroff, LW):** The scheme is $q_j^{n+1} = q_j^n - \\frac{C}{2}\\left(q_{j+1}^n - q_{j-1}^n\\right) + \\frac{C^2}{2}\\left(q_{j+1}^n - 2q_j^n + q_{j-1}^n\\right)$.\n- **Analysis Method:** The analysis requires using Taylor expansions about $(x_j, t^n)$ and the governing equation to determine the formal order of accuracy and classify the leading term of the modified equation as diffusive (even-order spatial derivative) or dispersive (odd-order spatial derivative).\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the fundamental linear advection equation and two of the most classic and well-studied finite-difference schemes (FTUS and Lax-Wendroff) used to solve it. The method of analysis, using Taylor series to derive the modified equation and thereby determine numerical error characteristics (diffusion and dispersion), is a standard and central technique in the field of numerical analysis for partial differential equations. The problem is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It asks for a characterization of known numerical schemes using a specified, standard analytical procedure. All necessary definitions and equations are provided. The question is unambiguous and leads to a unique, verifiable conclusion.\n- **Objective:** The problem is stated in precise, objective mathematical language. The definitions of the schemes and the analytical task are clear and not subject to interpretation.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a standard exercise in the numerical analysis of partial differential equations. The solution will proceed by analyzing each scheme as requested.\n\n### Derivation of Modified Equations\n\nTo find the order of accuracy and the nature of the leading error term, we derive the modified equation for each scheme. This is achieved by performing a Taylor series expansion of each term in the finite-difference equation around the point $(x_j, t^n)$, where $q_j^n = q(x_j, t^n)$. We will use the notation $q_t = \\frac{\\partial q}{\\partial t}$, $q_x = \\frac{\\partial q}{\\partial x}$, $q_{tt} = \\frac{\\partial^2 q}{\\partial t^2}$, $q_{xx} = \\frac{\\partial^2 q}{\\partial x^2}$, etc., with all derivatives evaluated at $(x_j, t^n)$.\n\nFrom the governing equation $q_t = -u q_x$, we can express higher-order time derivatives in terms of spatial derivatives, assuming $u$ is constant and $q$ is sufficiently smooth:\n$q_{tt} = \\frac{\\partial}{\\partial t}(-u q_x) = -u \\frac{\\partial}{\\partial x}(q_t) = -u \\frac{\\partial}{\\partial x}(-u q_x) = u^2 q_{xx}$\n$q_{ttt} = \\frac{\\partial}{\\partial t}(u^2 q_{xx}) = u^2 \\frac{\\partial^2}{\\partial x^2}(q_t) = u^2 \\frac{\\partial^2}{\\partial x^2}(-u q_x) = -u^3 q_{xxx}$\n\n#### Analysis of the Forward-Time Upwind-Space (FTUS) Scheme\n\nThe FTUS scheme is $q_j^{n+1} = q_j^n - C(q_j^n - q_{j-1}^n)$.\nFirst, we rewrite the scheme by dividing by $\\Delta t$ and substituting $C = u\\Delta t/\\Delta x$:\n$$ \\frac{q_j^{n+1} - q_j^n}{\\Delta t} = -\\frac{u \\Delta t}{\\Delta x \\Delta t} (q_j^n - q_{j-1}^n) = -u \\frac{q_j^n - q_{j-1}^n}{\\Delta x} $$\nNow we expand each side in a Taylor series.\nLeft-hand side (LHS):\n$$ \\frac{q_j^{n+1} - q_j^n}{\\Delta t} = \\frac{(q + \\Delta t q_t + \\frac{(\\Delta t)^2}{2}q_{tt} + \\dots) - q}{\\Delta t} = q_t + \\frac{\\Delta t}{2}q_{tt} + O((\\Delta t)^2) $$\nRight-hand side (RHS):\n$$ -u \\frac{q_j^n - q_{j-1}^n}{\\Delta x} = -u \\frac{q - (q - \\Delta x q_x + \\frac{(\\Delta x)^2}{2}q_{xx} - \\dots)}{\\Delta x} = -u \\frac{\\Delta x q_x - \\frac{(\\Delta x)^2}{2}q_{xx} + \\dots}{\\Delta x} = -u q_x + \\frac{u\\Delta x}{2}q_{xx} + O((\\Delta x)^2) $$\nEquating the LHS and RHS expansions:\n$$ q_t + \\frac{\\Delta t}{2}q_{tt} + \\dots = -u q_x + \\frac{u\\Delta x}{2}q_{xx} + \\dots $$\nRearranging to match the original PDE, we get the modified equation:\n$$ q_t + u q_x = -\\frac{\\Delta t}{2}q_{tt} + \\frac{u\\Delta x}{2}q_{xx} + O((\\Delta x)^2, (\\Delta t)^2) $$\nSubstitute $q_{tt} = u^2 q_{xx}$:\n$$ q_t + u q_x = -\\frac{\\Delta t}{2}(u^2 q_{xx}) + \\frac{u\\Delta x}{2}q_{xx} + \\dots = \\left( \\frac{u\\Delta x}{2} - \\frac{u^2\\Delta t}{2} \\right) q_{xx} + \\dots $$\nFactoring out common terms and using $C = u\\Delta t/\\Delta x$:\n$$ q_t + u q_x = \\frac{u\\Delta x}{2} \\left(1 - \\frac{u\\Delta t}{\\Delta x}\\right) q_{xx} + \\dots = \\frac{u\\Delta x}{2} (1 - C) q_{xx} + \\text{H.O.T.} $$\nThe truncation error is the set of terms on the right-hand side, the leading part of which is $O(\\Delta x, \\Delta t)$. Thus, the FTUS scheme is **first-order accurate** in both space and time. The leading error term is proportional to $q_{xx}$, a second-order (even) spatial derivative. This term acts like a diffusion term, so the leading error is **diffusive**.\n\n#### Analysis of the Lax-Wendroff (LW) Scheme\n\nThe LW scheme is $q_j^{n+1} = q_j^n - \\frac{C}{2}(q_{j+1}^n - q_{j-1}^n) + \\frac{C^2}{2}(q_{j+1}^n - 2q_j^n + q_{j-1}^n)$.\nAgain, we rewrite the scheme by dividing by $\\Delta t$ and substituting $C$:\n$$ \\frac{q_j^{n+1} - q_j^n}{\\Delta t} = -\\frac{u}{2\\Delta x}(q_{j+1}^n - q_{j-1}^n) + \\frac{u^2\\Delta t}{2(\\Delta x)^2}(q_{j+1}^n - 2q_j^n + q_{j-1}^n) $$\nNow we expand each term.\nLHS:\n$$ \\frac{q_j^{n+1} - q_j^n}{\\Delta t} = q_t + \\frac{\\Delta t}{2}q_{tt} + \\frac{(\\Delta t)^2}{6}q_{ttt} + O((\\Delta t)^3) $$\nRHS terms:\nThe first RHS term is the centered difference approximation for $-u q_x$:\n$$ -\\frac{u}{2\\Delta x}(q_{j+1}^n - q_{j-1}^n) = -\\frac{u}{2\\Delta x}( (q+\\Delta x q_x + \\frac{(\\Delta x)^2}{2}q_{xx} + \\frac{(\\Delta x)^3}{6}q_{xxx}+\\dots) - (q-\\Delta x q_x + \\frac{(\\Delta x)^2}{2}q_{xx} - \\frac{(\\Delta x)^3}{6}q_{xxx}+\\dots) ) $$\n$$ = -\\frac{u}{2\\Delta x}(2\\Delta x q_x + \\frac{(\\Delta x)^3}{3}q_{xxx} + \\dots) = -u q_x - \\frac{u(\\Delta x)^2}{6}q_{xxx} + O((\\Delta x)^4) $$\nThe second RHS term is related to the centered difference approximation for $q_{xx}$:\n$$ \\frac{u^2\\Delta t}{2(\\Delta x)^2}(q_{j+1}^n - 2q_j^n + q_{j-1}^n) = \\frac{u^2\\Delta t}{2(\\Delta x)^2}((\\Delta x)^2 q_{xx} + \\frac{(\\Delta x)^4}{12}q_{xxxx}+\\dots) = \\frac{u^2\\Delta t}{2}q_{xx} + \\frac{u^2\\Delta t(\\Delta x)^2}{24}q_{xxxx} + \\dots $$\nCombining the expansions:\n$$ q_t + \\frac{\\Delta t}{2}q_{tt} + \\frac{(\\Delta t)^2}{6}q_{ttt} + \\dots = -u q_x - \\frac{u(\\Delta x)^2}{6}q_{xxx} + \\frac{u^2\\Delta t}{2}q_{xx} + \\dots $$\nRearranging to form the modified equation:\n$$ q_t + u q_x = -\\frac{\\Delta t}{2}q_{tt} + \\frac{u^2\\Delta t}{2}q_{xx} - \\frac{(\\Delta t)^2}{6}q_{ttt} - \\frac{u(\\Delta x)^2}{6}q_{xxx} + \\text{H.O.T.} $$\nNow, substitute the time derivatives: $q_{tt} = u^2 q_{xx}$ and $q_{ttt} = -u^3 q_{xxx}$.\n$$ q_t + u q_x = \\left(-\\frac{u^2\\Delta t}{2} + \\frac{u^2\\Delta t}{2}\\right)q_{xx} + \\left(\\frac{u^3(\\Delta t)^2}{6} - \\frac{u(\\Delta x)^2}{6}\\right)q_{xxx} + \\text{H.O.T.} $$\nThe term with $q_{xx}$ cancels out, which is by design in the Lax-Wendroff scheme. The leading error term is the one associated with $q_{xxx}$:\n$$ q_t + u q_x = -\\frac{u(\\Delta x)^2}{6}\\left(1 - \\frac{u^2(\\Delta t)^2}{(\\Delta x)^2}\\right)q_{xxx} + \\text{H.O.T.} = -\\frac{u(\\Delta x)^2}{6}(1 - C^2)q_{xxx} + \\text{H.O.T.} $$\nThe truncation error is $O((\\Delta x)^2, (\\Delta t)^2)$, so the Lax-Wendroff scheme is **second-order accurate**. The leading error term is proportional to $q_{xxx}$, a third-order (odd) spatial derivative. This term causes phase errors, so the leading error is **dispersive**.\n\n### Option-by-Option Analysis\n\nBased on the derivations:\n- **FTUS:** First-order accurate, leading error is diffusive.\n- **Lax-Wendroff:** Second-order accurate, leading error is dispersive.\n\nWe now evaluate the given options:\n\n**A. Forward-time upwind-space is first-order accurate with a leading diffusive modified-equation term; Lax–Wendroff is second-order accurate with a leading dispersive modified-equation term.**\nThis statement accurately reflects our findings for both schemes.\n**Verdict: Correct.**\n\n**B. Forward-time upwind-space is second-order accurate with a leading dispersive modified-equation term; Lax–Wendroff is first-order accurate with a leading diffusive modified-equation term.**\nThis statement incorrectly swaps the properties of the two schemes.\n**Verdict: Incorrect.**\n\n**C. Both schemes are first-order accurate with leading diffusive modified-equation terms.**\nThis statement is incorrect as the Lax-Wendroff scheme is second-order accurate and has a leading dispersive error term.\n**Verdict: Incorrect.**\n\n**D. Forward-time upwind-space is first-order accurate with a leading dispersive modified-equation term; Lax–Wendroff is second-order accurate with a leading diffusive modified-equation term.**\nThis statement incorrectly classifies the nature of the leading error terms for both schemes. FTUS is diffusive, not dispersive. Lax-Wendroff is dispersive, not diffusive.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Theoretical predictions, such as the amplification factor from von Neumann analysis, gain practical meaning when verified with numerical experiments. This exercise demonstrates how to design a targeted simulation to directly measure a scheme's numerical diffusion from its output. By evolving a single Fourier mode and measuring its amplitude decay, you can empirically estimate the amplification factor, providing a crucial bridge between abstract analysis and computational practice.",
            "id": "3899290",
            "problem": "You are tasked with designing and implementing a Fourier-based diagnostic for numerical diffusion in a one-dimensional, periodic, linear advection model. The fundamental base is the one-dimensional linear advection equation,\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = 0,\n$$\non a periodic domain of length $L$ with a uniform grid of $N$ points and grid spacing $\\Delta x = L/N$. The physical parameters are the advection speed $u$ in meters per second and the time step $\\Delta t$ in seconds. For a single-mode initial condition,\n$$\nq(x,0) = \\cos(k x),\n$$\nwith wavenumber $k$ in radians per meter, the exact continuous solution for pure advection preserves the amplitude, meaning that any decay in the numerically computed amplitude after a single time step arises from numerical diffusion. The diagnostic shall estimate the magnitude of the numerical amplification factor, denoted as $|G(k)|$, from the measured discrete Fourier amplitude decay over one time step $\\Delta t$.\n\nTo make this diagnostic algorithmically concrete and testable, approximate the advection equation using the first-order upwind finite-difference scheme for positive advection speed $u > 0$:\n$$\nq_i^{n+1} = q_i^n - C \\left(q_i^n - q_{i-1}^n\\right),\n$$\nwhere $q_i^n$ is the discrete solution at grid index $i$ and time level $n$, and $C = \\frac{u \\Delta t}{\\Delta x}$ is the Courant-Friedrichs-Lewy (CFL) number. Enforce periodic boundary conditions so that $q_{-1}^n$ is interpreted as $q_{N-1}^n$. Initialize the field as\n$$\nq_i^0 = \\cos(k x_i), \\quad x_i = i \\Delta x, \\quad i = 0,1,\\dots,N-1,\n$$\nwith the wavenumber chosen to be compatible with the discrete grid: $k = \\frac{2\\pi m}{L}$ for an integer mode index $m \\in \\{0,1,\\dots,N-1\\}$.\n\nEstimate the numerical amplification magnitude $|G(k)|$ by computing the ratio of the magnitude of the Discrete Fourier Transform (DFT) coefficient at the mode $m$ after one time step to its initial magnitude. Specifically, let $Q_m^0$ and $Q_m^1$ denote the complex DFT coefficients at mode $m$ from $q_i^0$ and $q_i^1$ respectively (use the standard unnormalized DFT). Then compute\n$$\n|G(k)| = \\frac{\\left|Q_m^1\\right|}{\\left|Q_m^0\\right|}.\n$$\nHere, the Discrete Fourier Transform (DFT) is defined for the discrete field $\\{q_i\\}_{i=0}^{N-1}$ by\n$$\n\\hat{q}_m = \\sum_{i=0}^{N-1} q_i \\exp\\left(-\\mathrm{i} \\frac{2\\pi m i}{N}\\right),\n$$\nfor mode index $m$. The diagnostic result $|G(k)|$ is dimensionless and must be reported as a floating-point number.\n\nUse the following physically consistent parameters shared across all test cases:\n- Domain length $L = 1000$ meters.\n- Number of grid points $N = 128$, so that $\\Delta x = L/N$ meters.\n- Advection speed $u = 10$ meters per second.\n- Mode wavenumber $k = \\frac{2\\pi m}{L}$ radians per meter, with integer $m$ as specified per test case.\n- Time step $\\Delta t$ determined from the Courant-Friedrichs-Lewy (CFL) number $C$ via $\\Delta t = C \\frac{\\Delta x}{u}$ seconds.\n\nYour program must:\n1. Initialize the field $q_i^0 = \\cos(k x_i)$ for the specified $m$ in each test case.\n2. Advance the field by one time step using the first-order upwind scheme with periodic boundary conditions.\n3. Compute the DFT of the initial and advanced fields and evaluate $|G(k)|$ for the specified mode $m$.\n4. Aggregate the results across all test cases and produce a single-line output with the list of floating-point results.\n\nTest Suite:\n- Case 1 (happy path, long wave, moderate stability): $m = 1$, $C = 0.2$.\n- Case 2 (mid-scale wave, half CFL): $m = 32$, $C = 0.5$.\n- Case 3 (near-Nyquist wave, high CFL near stability bound): $m = 63$, $C = 0.9$.\n- Case 4 (zero mode boundary case): $m = 0$, $C = 0.7$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example,\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4].\n$$\nEach $\\text{result}_j$ must be the computed floating-point value of $|G(k)|$ for the corresponding test case. No units are required for the final answers since $|G(k)|$ is dimensionless.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of numerical analysis for partial differential equations, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. The task is to implement a diagnostic for numerical diffusion in a one-dimensional linear advection model.\n\nThe governing equation is the linear advection equation:\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = 0\n$$\nThis equation is solved on a periodic domain of length $L$ using a grid of $N$ points. The spatial grid points are $x_i = i \\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$, where the grid spacing is $\\Delta x = L/N$.\n\nThe numerical scheme is the first-order upwind method, which, for a positive advection speed $u > 0$, discretizes the equation as:\n$$\nq_i^{n+1} = q_i^n - C (q_i^n - q_{i-1}^n)\n$$\nHere, $q_i^n$ represents the solution at grid point $i$ and time level $n$, and $C = \\frac{u \\Delta t}{\\Delta x}$ is the Courant-Friedrichs-Lewy (CFL) number. The time step is $\\Delta t$. Periodic boundary conditions imply that $q_{-1}^n = q_{N-1}^n$.\n\nThe diagnostic procedure involves the following steps:\n\n1.  **Parameter Computation**: For each test case, specified by a mode index $m$ and a CFL number $C$, we first compute the necessary physical and numerical parameters.\n    -   Grid spacing: $\\Delta x = \\frac{L}{N} = \\frac{1000}{128} = 7.8125$ meters.\n    -   Wavenumber: $k = \\frac{2\\pi m}{L}$. This ensures the initial wave pattern is periodic on the domain.\n    -   Time step: $\\Delta t = C \\frac{\\Delta x}{u}$. This is derived from the definition of the CFL number.\n\n2.  **Initialization**: The simulation field is initialized with a single-mode cosine wave at time $t=0$ (i.e., time level $n=0$):\n    $$\n    q_i^0 = \\cos(k x_i) = \\cos\\left(\\frac{2\\pi m}{L} \\cdot i \\Delta x\\right) = \\cos\\left(\\frac{2\\pi m i}{N}\\right)\n    $$\n    This discrete field represents the initial state $q(x,0)$.\n\n3.  **Time Advancement**: We advance the solution by a single time step $\\Delta t$ to obtain the field at time level $n=1$, denoted by $q_i^1$. This is done by applying the upwind scheme once:\n    $$\n    q_i^1 = q_i^0 - C (q_i^0 - q_{i-1}^0)\n    $$\n    The periodic boundary condition is handled by interpreting the index $i-1$ modulo $N$. For $i=0$, $q_{-1}^0$ becomes $q_{N-1}^0$.\n\n4.  **Fourier Analysis**: The core of the diagnostic is to compare the Fourier spectrum of the solution before and after the time step. We compute the Discrete Fourier Transform (DFT) of the initial field $q^0$ and the advanced field $q^1$. The DFT of a sequence $\\{v_i\\}_{i=0}^{N-1}$ is given by:\n    $$\n    \\hat{v}_j = \\sum_{i=0}^{N-1} v_i \\exp\\left(-\\mathrm{i} \\frac{2\\pi j i}{N}\\right)\n    $$\n    Let $Q_m^0$ and $Q_m^1$ be the complex DFT coefficients at the mode index $m$ corresponding to the initial fields $q_i^0$ and $q_i^1$, respectively.\n\n5.  **Amplification Factor Calculation**: The numerical amplification factor's magnitude at wavenumber $k$, denoted $|G(k)|$, quantifies the amplitude change of that specific mode due to the numerical scheme. It is estimated as the ratio of the magnitudes of the DFT coefficients at mode $m$:\n    $$\n    |G(k)| = \\frac{|Q_m^1|}{|Q_m^0|}\n    $$\n    The initial condition $q_i^0 = \\cos\\left(\\frac{2\\pi m i}{N}\\right)$ can be expressed using Euler's formula as $\\frac{1}{2}\\left(e^{\\mathrm{i} \\frac{2\\pi m i}{N}} + e^{-\\mathrm{i} \\frac{2\\pi m i}{N}}\\right)$. Its DFT has non-zero coefficients primarily at mode indices $m$ and $N-m$ (which is the alias for $-m$ on the discrete grid). Therefore, $|Q_m^0|$ will be non-zero for $m \\in \\{1, \\dots, N/2\\}$, ensuring the ratio is well-defined.\n    \n    A special case is $m=0$, which corresponds to $k=0$. The initial condition is $q_i^0 = \\cos(0) = 1$ for all $i$. For a constant field, the term $(q_i^0 - q_{i-1}^0)$ is zero, so $q_i^1 = q_i^0$. Consequently, $Q_0^1 = Q_0^0$, and we expect $|G(0)| = 1$ exactly.\n\nFor each test case, this procedure is followed to compute a single floating-point value for $|G(k)|$. The final output is a list of these values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical amplification factor for the first-order upwind scheme\n    for a series of test cases based on a 1D linear advection model.\n    \"\"\"\n    \n    # Define shared physical and numerical parameters.\n    L = 1000.0      # Domain length in meters\n    N = 128         # Number of grid points\n    u_vel = 10.0    # Advection speed in m/s\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mode index m, CFL number C)\n    test_cases = [\n        (1, 0.2),   # Case 1: long wave, moderate stability\n        (32, 0.5),  # Case 2: mid-scale wave, half CFL\n        (63, 0.9),  # Case 3: near-Nyquist wave, high CFL\n        (0, 0.7),   # Case 4: zero mode boundary case\n    ]\n    \n    results = []\n    \n    # Calculate grid spacing (constant for all cases)\n    dx = L / N\n    \n    # Generate the spatial grid coordinates (constant for all cases)\n    x = np.arange(N) * dx\n    \n    for m, C_val in test_cases:\n        # Step 1: Calculate case-specific parameters\n        # Wavenumber k is implicitly handled via the mode index m and grid properties\n        # during initialization and DFT analysis.\n        \n        # Step 2: Initialize the field q^0\n        # q_i^0 = cos(k * x_i) = cos( (2*pi*m/L) * (i*L/N) ) = cos(2*pi*m*i / N)\n        # Using arange(N) for indices i = 0, 1, ..., N-1\n        q0 = np.cos(2.0 * np.pi * m * np.arange(N) / N)\n        \n        # Step 3: Advance the field by one time step to get q^1\n        # The upwind scheme is q_i^{n+1} = q_i^n - C * (q_i^n - q_{i-1}^n).\n        # np.roll(q0, 1) shifts elements to the right, so q0[i] becomes q0[i-1],\n        # correctly implementing the periodic boundary condition.\n        q1 = q0 - C_val * (q0 - np.roll(q0, 1))\n        \n        # Step 4: Compute the Discrete Fourier Transforms (DFTs)\n        # numpy.fft.fft provides the unnormalized DFT as specified.\n        Q0_coeffs = np.fft.fft(q0)\n        Q1_coeffs = np.fft.fft(q1)\n        \n        # Extract the complex coefficient at the specified mode m\n        Q0_m = Q0_coeffs[m]\n        Q1_m = Q1_coeffs[m]\n        \n        # Step 5: Calculate the magnitude of the numerical amplification factor\n        # For m=0, q0 is a constant field, so |Q0_m| is N != 0.\n        # For m > 0, cos(2*pi*m*i/N) is composed of two complex exponentials,\n        # so |Q0_m| is N/2 != 0. Thus, division by zero is not an issue.\n        if np.abs(Q0_m) == 0:\n            # This case should not be reached with the given initial conditions.\n            # If it were, it would imply the initial mode has zero amplitude,\n            # making the amplification factor undefined. We'd assign 1.0.\n            amp_factor = 1.0\n        else:\n            amp_factor = np.abs(Q1_m) / np.abs(Q0_m)\n            \n        results.append(amp_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "While the previous practices analyzed error properties in isolation, this capstone exercise focuses on their cumulative impact in a complete simulation. You will advect a Gaussian pulse over a full period and develop metrics to separately quantify the total numerical diffusion and dispersion. This practice makes abstract error concepts tangible, showing how they manifest as observable changes in a tracer field and providing a template for diagnosing model performance in more complex scenarios.",
            "id": "3803225",
            "problem": "Consider the one-dimensional linear advection of a passive tracer governed by the partial differential equation $q_t + u q_x = 0$ on a periodic domain of length $L$ with constant velocity $u$. In the absence of physical diffusion, the exact solution transports any initial condition $q(x,0)$ without changing its shape, total mass, or spatial variance. However, discrete numerical schemes introduce numerical errors that can be decomposed into two effects: numerical diffusion (amplitude damping that reduces the variance of tracer fluctuations) and numerical dispersion (phase errors that shift or distort features without necessarily changing their amplitude). Your task is to quantify these two effects over exactly one period of advection, $T = L/u$, for a Gaussian pulse using two standard explicit schemes.\n\nImplement a program that:\n- Represents the solution on a uniform periodic grid with $N$ points, grid spacing $\\Delta x = L/N$, and time step $\\Delta t$ chosen from a specified Courant–Friedrichs–Lewy number (CFL), $\\mathrm{C} = u \\Delta t / \\Delta x$.\n- Initializes the tracer as a Gaussian pulse centered at $x_0$ with standard deviation $\\sigma$ on $[0,L)$:\n$$\nq(x,0) = \\exp\\left(-\\frac{(d(x;x_0))^2}{2 \\sigma^2}\\right),\n$$\nwhere $d(x;x_0)$ is the minimal periodic distance between $x$ and $x_0$ on the circle $[0,L)$, so that $d \\in \\left[-\\frac{L}{2},\\frac{L}{2}\\right]$.\n- Evolves the tracer for exactly one period $T = L/u$ using one of the following conservative, periodic, finite-difference update rules (space is discretized with index $i \\in \\{0,\\dots,N-1\\}$ and time level $n$):\n    1. First-order upwind (for $u \\ge 0$):\n    $$\n    q_i^{n+1} = q_i^n - \\mathrm{C}\\,\\left(q_i^n - q_{i-1}^n\\right),\n    $$\n    with periodic indexing $q_{-1}^n \\equiv q_{N-1}^n$.\n    2. Lax–Wendroff (second order):\n    $$\n    q_i^{n+1} = q_i^n - \\frac{\\mathrm{C}}{2}\\left(q_{i+1}^n - q_{i-1}^n\\right) + \\frac{\\mathrm{C}^2}{2}\\left(q_{i+1}^n - 2 q_i^n + q_{i-1}^n\\right),\n    $$\n    with periodic indexing.\n- Ensures that the number of time steps $n_T$ satisfies $n_T \\Delta t = T$ exactly. For the test suite below, this is guaranteed by choosing $\\mathrm{C}$ so that $T/\\Delta t = N/\\mathrm{C}$ is an integer.\n- Quantifies numerical diffusion by the decay in the discrete spatial variance (per unit length) of the zero-mean tracer field between $t=0$ and $t=T$. Define the discrete mean and variance at time $t^n$ by\n$$\n\\overline{q}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i^n, \\quad \\mathrm{Var}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} \\left(q_i^n - \\overline{q}^n\\right)^2.\n$$\nReport the ratio\n$$\nR_{\\mathrm{var}} = \\frac{\\mathrm{Var}^{n_T}}{\\mathrm{Var}^{0}},\n$$\nwhich should be less than $1$ if numerical diffusion is present, and equal to $1$ for a perfectly nondiffusive evolution.\n- Quantifies numerical dispersion by the residual phase shift over one period of the dominant large-scale Fourier mode of the zero-mean tracer field. Let $\\widehat{Q}_1^n$ denote the discrete Fourier coefficient of the zero-mean field at wavenumber $k_1 = 2\\pi/L$ (the $k=1$ mode) at time $t^n$, computed via the discrete Fourier transform convention\n$$\n\\widehat{Q}_k^n = \\sum_{j=0}^{N-1} \\left(q_j^n - \\overline{q}^n\\right) \\exp\\left(-\\mathrm{i}\\, \\frac{2\\pi k j}{N}\\right).\n$$\nThe exact continuum solution after one period has no net phase change for any integer spatial Fourier mode. Any nonzero phase change of the $k=1$ mode is therefore purely numerical. Define the wrapped phase difference\n$$\n\\Delta \\phi = \\mathrm{wrap}\\left(\\arg\\left(\\widehat{Q}_1^{n_T}\\right) - \\arg\\left(\\widehat{Q}_1^{0}\\right)\\right),\n$$\nwhere $\\mathrm{wrap}(\\theta)$ maps angles to $(-\\pi,\\pi]$. Convert this phase difference to an equivalent spatial phase shift in meters by\n$$\n\\Delta x_{\\mathrm{phase}} = \\frac{L}{2\\pi}\\,\\Delta \\phi,\n$$\nwhich is the residual spatial shift of the dominant mode after one period. Report $\\Delta x_{\\mathrm{phase}}$ in meters.\n\nYour program must compute, for each test case, the list $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$ and aggregate the results for all test cases into a single line printed to standard output as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of two floating-point numbers. No other text should be printed.\n\nAll physical quantities must be handled in the units specified: $L$ in meters ($\\mathrm{m}$), $u$ in meters per second ($\\mathrm{m/s}$), $T$ in seconds ($\\mathrm{s}$), and $\\Delta x_{\\mathrm{phase}}$ in meters ($\\mathrm{m}$). Angles used internally for phase computation must be in radians.\n\nTest Suite:\nImplement the four cases below. For each, run exactly one period and report $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$.\n\n- Case A (first-order upwind, moderate $\\mathrm{C}$): $L = 1.0\\,\\mathrm{m}$, $N = 256$, $u = 1.0\\,\\mathrm{m/s}$, $\\mathrm{C} = 0.5$, $\\sigma = 0.05\\,L$, $x_0 = 0.3\\,L$.\n- Case B (Lax–Wendroff, moderate $\\mathrm{C}$): $L = 1.0\\,\\mathrm{m}$, $N = 256$, $u = 1.0\\,\\mathrm{m/s}$, $\\mathrm{C} = 0.5$, $\\sigma = 0.05\\,L$, $x_0 = 0.3\\,L$.\n- Case C (first-order upwind, limiting $\\mathrm{C}$): $L = 1.0\\,\\mathrm{m}$, $N = 200$, $u = 1.0\\,\\mathrm{m/s}$, $\\mathrm{C} = 1.0$, $\\sigma = 0.08\\,L$, $x_0 = 0.4\\,L$.\n- Case D (Lax–Wendroff, narrow pulse): $L = 1.0\\,\\mathrm{m}$, $N = 256$, $u = 1.0\\,\\mathrm{m/s}$, $\\mathrm{C} = 0.5$, $\\sigma = 0.01\\,L$, $x_0 = 0.25\\,L$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list with four elements, each element being a list of two floats in the order $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$, corresponding to Cases A, B, C, and D, respectively. For example:\n[[r_A, s_A], [r_B, s_B], [r_C, s_C], [r_D, s_D]],\nwhere each $r_\\cdot$ and $s_\\cdot$ is a floating-point number. Do not include units in the output; all distances are implicitly in meters and all ratios are dimensionless.",
            "solution": "The problem requires the quantification of numerical diffusion and dispersion for two finite-difference schemes used to solve the one-dimensional linear advection equation, $q_t + u q_x = 0$. This equation describes the transport of a passive tracer concentration, $q(x,t)$, with a constant velocity $u$ on a one-dimensional periodic domain of length $L$. The exact solution translates the initial tracer profile $q(x,0)$ without any change in shape, amplitude, or variance. Numerical schemes, however, introduce errors that manifest as numerical diffusion (a damping of amplitudes) and numerical dispersion (phase errors leading to shape distortion). The task is to compute these errors for a Gaussian initial condition after one full advective period, $T = L/u$.\n\nThe solution is developed by first discretizing the governing equation, implementing the specified numerical schemes, and then applying well-defined metrics to the initial and final states of the simulation.\n\n**1. Discretization and Simulation Setup**\n\nThe continuous domain $[0, L)$ is discretized into a uniform grid of $N$ points, indexed by $i = 0, \\dots, N-1$. The grid points are located at $x_i = i \\Delta x$, where the grid spacing is $\\Delta x = L/N$. Time is discretized into steps of size $\\Delta t$. The relationship between spatial and temporal discretization is governed by the Courant–Friedrichs–Lewy (CFL) number, defined as $\\mathrm{C} = u \\Delta t / \\Delta x$. For the stability of the explicit schemes used, this number must be constrained.\n\nThe simulation runs for a total duration of $T = L/u$, which corresponds to the time it takes for a feature to be advected exactly once around the periodic domain. The total number of time steps, $n_T$, is chosen such that $n_T \\Delta t = T$. By substituting the definitions of $T$, $\\Delta t$, and $\\mathrm{C}$, we find $n_T = \\frac{L/u}{( \\mathrm{C} \\Delta x / u)} = \\frac{L}{\\mathrm{C} (L/N)} = N/\\mathrm{C}$. The problem guarantees that for all test cases, $N/\\mathrm{C}$ is an integer, ensuring the simulation terminates precisely at one period.\n\n**2. Initial Condition**\n\nThe initial tracer distribution is a Gaussian pulse, given by:\n$$\nq(x,0) = \\exp\\left(-\\frac{(d(x;x_0))^2}{2 \\sigma^2}\\right)\n$$\nHere, $x_0$ is the center of the pulse, $\\sigma$ is its standard deviation, and $d(x; x_0)$ is the minimal periodic distance between any point $x$ and the center $x_0$. This distance function correctly handles the wrap-around nature of the periodic domain and is defined on the interval $[-\\frac{L}{2}, \\frac{L}{2}]$. In a discrete implementation on the grid $\\{x_i\\}$, the distance from each $x_i$ to $x_0$ is calculated as $d(x_i; x_0) = (x_i - x_0) - L \\cdot \\mathrm{round}((x_i - x_0)/L)$. This ensures the Gaussian is centered correctly and symmetrically on the circular domain.\n\n**3. Numerical Schemes**\n\nThe evolution of the discrete tracer field $q_i^n \\approx q(x_i, t^n)$ is computed using two explicit, conservative finite-difference schemes. Periodicity is enforced by using modular arithmetic on the spatial indices, such that $q_{i \\pm N}^n = q_i^n$.\n\n*   **First-Order Upwind Scheme:** For a positive velocity $u \\ge 0$, this scheme is given by:\n    $$\n    q_i^{n+1} = q_i^n - \\mathrm{C}\\left(q_i^n - q_{i-1}^n\\right)\n    $$\n    This scheme is first-order accurate in both space and time. It is known to be numerically stable for $0 \\le \\mathrm{C} \\le 1$. Its leading-order truncation error term is proportional to the second spatial derivative, which acts as a diffusion term. Consequently, this scheme is highly dissipative, causing sharp gradients to smear out and amplitudes to decay over time. In the special case where $\\mathrm{C}=1$, the scheme becomes $q_i^{n+1} = q_{i-1}^n$, which is an exact shift operator on the grid. The discrete solution is transported without any error in this case.\n\n*   **Lax–Wendroff Scheme:** This is a second-order accurate scheme in both space and time:\n    $$\n    q_i^{n+1} = q_i^n - \\frac{\\mathrm{C}}{2}\\left(q_{i+1}^n - q_{i-1}^n\\right) + \\frac{\\mathrm{C}^2}{2}\\left(q_{i+1}^n - 2 q_i^n + q_{i-1}^n\\right)\n    $$\n    The Lax–Wendroff scheme is stable for $|\\mathrm{C}| \\le 1$. It is constructed to cancel the second-order truncation error term, making it significantly less diffusive than the upwind scheme. However, its dominant error term is proportional to the third spatial derivative, which introduces dispersive errors. These errors cause different Fourier components of the solution to propagate at incorrect phase velocities, leading to spurious oscillations, particularly near sharp features.\n\nFor implementation, these update rules are applied vectorially to the entire solution array $q^n$ at each time step. The periodic shifts required for terms like $q_{i\\pm 1}^n$ are efficiently handled using array-rolling operations.\n\n**4. Quantification of Numerical Errors**\n\nTwo metrics are computed to quantify the effects of numerical diffusion and dispersion after one period, $T$.\n\n*   **Numerical Diffusion Metric ($R_{\\mathrm{var}}$):** Numerical diffusion damps the amplitude of tracer fluctuations. This effect is quantified by measuring the decay in the spatial variance of the solution. The discrete mean and variance of the tracer field at time level $n$ are:\n    $$\n    \\overline{q}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i^n, \\quad \\mathrm{Var}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} \\left(q_i^n - \\overline{q}^n\\right)^2\n    $$\n    The diffusion metric is the ratio of the final variance at time $t^{n_T} = T$ to the initial variance at $t=0$:\n    $$\n    R_{\\mathrm{var}} = \\frac{\\mathrm{Var}^{n_T}}{\\mathrm{Var}^{0}}\n    $$\n    For a perfect, non-diffusive scheme, $R_{\\mathrm{var}} = 1$. The presence of numerical diffusion leads to $R_{\\mathrm{var}} < 1$.\n\n*   **Numerical Dispersion Metric ($\\Delta x_{\\mathrm{phase}}$):** Numerical dispersion causes different wavelengths to travel at incorrect speeds. This is analyzed by examining the phase of a specific Fourier mode of the solution. We focus on the mode with the longest wavelength that fits the domain, which has wavenumber $k_1 = 2\\pi/L$. The complex coefficient of this mode is found using the Discrete Fourier Transform (DFT) of the zero-mean tracer field, $q_j^n - \\overline{q}^n$:\n    $$\n    \\widehat{Q}_k^n = \\sum_{j=0}^{N-1} \\left(q_j^n - \\overline{q}^n\\right) \\exp\\left(-\\mathrm{i}\\, \\frac{2\\pi k j}{N}\\right)\n    $$\n    For the exact solution after one period $T=L/u$, the field returns to its original state, so the phase of any Fourier coefficient should be unchanged. Any numerical phase error is captured by the difference between the final and initial phase of the $k=1$ mode, $\\widehat{Q}_1^n$. The wrapped phase difference is calculated as:\n    $$\n    \\Delta \\phi = \\mathrm{wrap}\\left(\\arg\\left(\\widehat{Q}_1^{n_T}\\right) - \\arg\\left(\\widehat{Q}_1^{0}\\right)\\right)\n    $$\n    where the $\\mathrm{wrap}(\\theta)$ function maps an angle $\\theta$ into the interval $(-\\pi, \\pi]$. A phase error $\\Delta \\phi$ is equivalent to an erroneous spatial shift. A spatial shift of $\\delta x$ imparts a phase change of $k_1 \\delta x = (2\\pi/L) \\delta x$. Therefore, the equivalent spatial phase shift is:\n    $$\n    \\Delta x_{\\mathrm{phase}} = \\frac{L}{2\\pi}\\,\\Delta \\phi\n    $$\n    This value represents the residual displacement of the dominant large-scale feature of the tracer after one period. A non-zero $\\Delta x_{\\mathrm{phase}}$ is a direct measure of the scheme's cumulative dispersive error.\n\n**5. Algorithmic Implementation**\n\nThe algorithm proceeds as follows for each test case:\n1.  Initialize parameters ($L$, $N$, $u$, $\\mathrm{C}$, etc.).\n2.  Construct the spatial grid $x_i$ and the initial Gaussian profile $q^0$.\n3.  Compute the initial variance $\\mathrm{Var}^0$ and the initial phase $\\arg(\\widehat{Q}_1^0)$.\n4.  Loop for $n_T = N/\\mathrm{C}$ time steps, applying the chosen numerical scheme (Upwind or Lax-Wendroff) at each step to update the solution vector.\n5.  After the loop, compute the final variance $\\mathrm{Var}^{n_T}$ and final phase $\\arg(\\widehat{Q}_1^{n_T})$.\n6.  Calculate the metrics $R_{\\mathrm{var}}$ and $\\Delta x_{\\mathrm{phase}}$ using the formulas above.\n7.  Store the resulting pair $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$.\n\nThis process is repeated for all four test cases, and the results are aggregated into a final list for output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the 1D advection problem.\n    \"\"\"\n\n    def solve_case(scheme, L, N, u, C, sigma_rel, x0_rel):\n        \"\"\"\n        Solves a single case of the 1D advection problem.\n\n        Args:\n            scheme (str): 'upwind' or 'lax-wendroff'.\n            L (float): Domain length in meters.\n            N (int): Number of grid points.\n            u (float): Advection velocity in m/s.\n            C (float): Courant number.\n            sigma_rel (float): Standard deviation as a fraction of L.\n            x0_rel (float): Initial pulse center as a fraction of L.\n\n        Returns:\n            list: A list containing [R_var, delta_x_phase].\n        \"\"\"\n        # 1. Setup simulation parameters\n        dx = L / N\n        T = L / u\n        n_T = int(round(N / C))\n        # dt = T / n_T # Equivalent to C * dx / u\n\n        sigma = sigma_rel * L\n        x0 = x0_rel * L\n        x = np.linspace(0, L, N, endpoint=False)\n\n        # 2. Set Initial Condition (Periodic Gaussian)\n        dist_x = x - x0\n        # Minimal periodic distance on the torus [0, L)\n        d = dist_x - L * np.round(dist_x / L)\n        q0 = np.exp(-(d**2) / (2 * sigma**2))\n\n        # 3. Analyze Initial State\n        var0 = np.var(q0)\n        q0_zm = q0 - np.mean(q0)\n        Q_hat_0 = np.fft.fft(q0_zm)\n        # Phase of the k=1 mode\n        phi0 = np.angle(Q_hat_0[1])\n\n        # 4. Time Evolution Loop\n        q_current = q0.copy()\n        if scheme == 'upwind':\n            for _ in range(n_T):\n                q_current = (1 - C) * q_current + C * np.roll(q_current, 1)\n        elif scheme == 'lax-wendroff':\n            for _ in range(n_T):\n                q_ip1 = np.roll(q_current, -1)\n                q_im1 = np.roll(q_current, 1)\n                term1 = -0.5 * C * (q_ip1 - q_im1)\n                term2 = 0.5 * C**2 * (q_ip1 - 2 * q_current + q_im1)\n                q_current = q_current + term1 + term2\n        else:\n            raise ValueError(f\"Unknown scheme: {scheme}\")\n\n        q_final = q_current\n\n        # 5. Analyze Final State\n        var_final = np.var(q_final)\n        q_final_zm = q_final - np.mean(q_final)\n        Q_hat_nT = np.fft.fft(q_final_zm)\n        # Phase of the k=1 mode\n        phi_nT = np.angle(Q_hat_nT[1])\n\n        # 6. Calculate Metrics\n        # Numerical Diffusion: Variance Ratio\n        R_var = var_final / var0 if var0 > 0 else 1.0\n\n        # Numerical Dispersion: Phase Shift\n        \n        # Wrap angle to (-pi, pi]\n        def wrap_angle(angle):\n            return (angle + np.pi) % (2 * np.pi) - np.pi\n\n        delta_phi_raw = phi_nT - phi0\n        delta_phi = wrap_angle(delta_phi_raw)\n\n        delta_x_phase = L * delta_phi / (2 * np.pi)\n\n        return [R_var, delta_x_phase]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: first-order upwind, moderate C\n        {'scheme': 'upwind', 'L': 1.0, 'N': 256, 'u': 1.0, 'C': 0.5, 'sigma_rel': 0.05, 'x0_rel': 0.3},\n        # Case B: Lax-Wendroff, moderate C\n        {'scheme': 'lax-wendroff', 'L': 1.0, 'N': 256, 'u': 1.0, 'C': 0.5, 'sigma_rel': 0.05, 'x0_rel': 0.3},\n        # Case C: first-order upwind, limiting C\n        {'scheme': 'upwind', 'L': 1.0, 'N': 200, 'u': 1.0, 'C': 1.0, 'sigma_rel': 0.08, 'x0_rel': 0.4},\n        # Case D: Lax-Wendroff, narrow pulse\n        {'scheme': 'lax-wendroff', 'L': 1.0, 'N': 256, 'u': 1.0, 'C': 0.5, 'sigma_rel': 0.01, 'x0_rel': 0.25},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_case(**case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}