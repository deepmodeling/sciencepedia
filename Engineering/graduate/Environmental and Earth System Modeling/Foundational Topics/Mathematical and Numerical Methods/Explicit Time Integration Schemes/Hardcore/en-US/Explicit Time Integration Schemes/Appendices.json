{
    "hands_on_practices": [
        {
            "introduction": "This first practice tackles the fundamental task for any explicit method: determining the stability boundary. We will derive the stability region for the Forward Euler method from first principles and apply this theory to find the maximum stable time step for a system with multiple eigenvalues. This exercise is crucial for understanding how the fastest physical processes in a model, represented by the eigenvalues with the largest magnitude, dictate the computational constraints of an explicit integration scheme .",
            "id": "3879008",
            "problem": "A linear, semi-discrete perturbation model arising from the linearization of a coupled ocean–atmosphere column about a stable equilibrium can be written as $y'(t)=A\\,y(t)$, where $y(t)\\in\\mathbb{R}^3$ and $A\\in\\mathbb{R}^{3\\times 3}$ is constant in time. The matrix $A$ captures combined effects of turbulent damping and rotational wave-like dynamics and is diagonalizable over $\\mathbb{C}$ with eigenvalues $\\lambda_1,\\lambda_2,\\lambda_3$. Consider advancing the solution with the explicit forward Euler method with a constant time step $\\Delta t>0$.\n\nStarting from first principles and without invoking any pre-tabulated stability results, analyze linear stability by requiring that no eigenmode amplifies in magnitude under one forward Euler step. From this, derive the region in the complex plane of the non-dimensional parameter $z=\\lambda\\,\\Delta t$ for which the forward Euler method is linearly stable.\n\nNow suppose the linear operator $A$ has the following eigenvalues (in $\\mathrm{s}^{-1}$):\n$\\lambda_1=-0.8$, $\\lambda_2=-0.5+1.2\\,\\mathrm{i}$, $\\lambda_3=-1.3-0.4\\,\\mathrm{i}$, where $\\mathrm{i}^2=-1$.\nDetermine the largest time step $\\Delta t_{\\max}$ (in seconds) such that forward Euler is linearly stable for all three eigenmodes simultaneously. Provide your final numerical value in seconds, rounded to four significant figures, and assume $\\Delta t_{\\max}>0$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. It represents a standard linear stability analysis of a numerical method applied to a system of ordinary differential equations (ODEs). I will therefore proceed with the solution.\n\nThe problem asks for two main results: first, the derivation of the linear stability region for the forward Euler method, and second, the calculation of the maximum stable time step for a specific system.\n\nThe governing system of linear ODEs is given by:\n$$\ny'(t) = A y(t)\n$$\nwhere $y(t) \\in \\mathbb{R}^3$ and $A \\in \\mathbb{R}^{3\\times3}$ is a constant matrix.\nApplying the explicit forward Euler method with a time step $\\Delta t > 0$, we discretize the equation. The value of the solution at time step $n+1$, denoted $y_{n+1}$, is approximated using the value at step $n$, denoted $y_n$:\n$$\n\\frac{y_{n+1} - y_n}{\\Delta t} = A y_n\n$$\nRearranging this gives the update rule for the forward Euler scheme:\n$$\ny_{n+1} = y_n + \\Delta t A y_n = (I + \\Delta t A) y_n\n$$\nHere, $I$ is the identity matrix. The matrix $G = I + \\Delta t A$ is known as the amplification matrix, as it maps the solution from one time step to the next.\n\nTo analyze the stability of the method, we examine its effect on the eigenmodes of the system. The problem states that $A$ is diagonalizable, so there exists an invertible matrix $P$ (whose columns are the eigenvectors of $A$) and a diagonal matrix $\\Lambda$ (whose diagonal entries are the eigenvalues $\\lambda_j$ of $A$) such that $A = P \\Lambda P^{-1}$.\nWe can express the solution vector $y_n$ in the basis of eigenvectors: $y_n = P c_n$, where $c_n$ is the vector of coefficients of the eigenmodes at time step $n$. Substituting this into the Euler update rule:\n$$\nP c_{n+1} = (I + \\Delta t A) P c_n = (I + \\Delta t P \\Lambda P^{-1}) P c_n\n$$\nUsing the property $P P^{-1} = I$, we can write $I = P I P^{-1}$.\n$$\nP c_{n+1} = (P I P^{-1} + \\Delta t P \\Lambda P^{-1}) P c_n = P (I + \\Delta t \\Lambda) P^{-1} P c_n = P (I + \\Delta t \\Lambda) c_n\n$$\nMultiplying from the left by $P^{-1}$ yields a decoupled system for the coefficients $c_n$:\n$$\nc_{n+1} = (I + \\Delta t \\Lambda) c_n\n$$\nSince $\\Lambda$ is diagonal, this represents a set of scalar equations for each individual eigenmode coefficient, $c_{j,n}$:\n$$\nc_{j, n+1} = (1 + \\lambda_j \\Delta t) c_{j, n}\n$$\nThe term $g_j = 1 + \\lambda_j \\Delta t$ is the scalar amplification factor for the $j$-th eigenmode. Linear stability requires that no eigenmode amplifies in magnitude from one step to the next. This means the magnitude of the amplification factor must not exceed $1$:\n$$\n|g_j| \\le 1 \\quad \\implies \\quad |1 + \\lambda_j \\Delta t| \\le 1 \\quad \\text{for all } j\n$$\nThe first part of the problem asks for the stability region in the complex plane for the non-dimensional parameter $z = \\lambda \\Delta t$. Substituting this into the stability condition gives:\n$$\n|1 + z| \\le 1\n$$\nTo characterize this region, we let $z = x + \\mathrm{i}y$, where $x$ and $y$ are the real and imaginary parts of $z$, respectively.\n$$\n|1 + (x + \\mathrm{i}y)| \\le 1 \\quad \\implies \\quad |(1+x) + \\mathrm{i}y| \\le 1\n$$\nThe magnitude of a complex number $a+\\mathrm{i}b$ is $\\sqrt{a^2+b^2}$. Thus:\n$$\n\\sqrt{(1+x)^2 + y^2} \\le 1\n$$\nSquaring both sides (which is permissible as both are non-negative) gives:\n$$\n(1+x)^2 + y^2 \\le 1^2\n$$\nThis inequality describes the set of all points $(x, y)$ in the complex plane that are on or inside a circle of radius $1$ centered at the point $(-1, 0)$. This closed disk is the region of absolute stability for the forward Euler method.\n\nThe second part of the problem is to find the largest time step $\\Delta t_{\\max}$ for which the method is stable for the given set of eigenvalues: $\\lambda_1 = -0.8$, $\\lambda_2 = -0.5 + 1.2\\,\\mathrm{i}$, and $\\lambda_3 = -1.3 - 0.4\\,\\mathrm{i}$ (all in units of $\\mathrm{s}^{-1}$).\nFor the numerical scheme to be stable, the condition $|1 + \\lambda_j \\Delta t| \\le 1$ must hold for all three eigenvalues simultaneously.\nLet's analyze the condition for a general complex eigenvalue $\\lambda = \\alpha + \\mathrm{i}\\beta$. The parameter $z$ is $z = \\lambda \\Delta t = (\\alpha + \\mathrm{i}\\beta)\\Delta t = \\alpha\\Delta t + \\mathrm{i}\\beta\\Delta t$. So $x = \\alpha\\Delta t$ and $y = \\beta\\Delta t$. Substituting into the stability inequality:\n$$\n(1 + \\alpha \\Delta t)^2 + (\\beta \\Delta t)^2 \\le 1\n$$\n$$\n1 + 2\\alpha\\Delta t + \\alpha^2 (\\Delta t)^2 + \\beta^2 (\\Delta t)^2 \\le 1\n$$\n$$\n2\\alpha\\Delta t + (\\alpha^2 + \\beta^2)(\\Delta t)^2 \\le 0\n$$\nSince $\\Delta t > 0$, we can divide by $\\Delta t$:\n$$\n2\\alpha + (\\alpha^2 + \\beta^2)\\Delta t \\le 0\n$$\nThe original physical system is described as a stable equilibrium, which implies that all eigenvalues have negative or zero real parts, $\\alpha = \\mathrm{Re}(\\lambda) \\le 0$. The given eigenvalues all have $\\alpha < 0$. We can rearrange the inequality to solve for $\\Delta t$:\n$$\n(\\alpha^2 + \\beta^2)\\Delta t \\le -2\\alpha\n$$\nSince $\\alpha^2 + \\beta^2 = |\\lambda|^2 > 0$ for non-zero eigenvalues, we can divide by it:\n$$\n\\Delta t \\le \\frac{-2\\alpha}{\\alpha^2 + \\beta^2} = \\frac{-2\\mathrm{Re}(\\lambda)}{|\\lambda|^2}\n$$\nThis inequality must be satisfied for each eigenvalue. To ensure stability for the entire system, $\\Delta t$ must be smaller than or equal to the minimum of the upper bounds imposed by each eigenvalue. Therefore, the maximum stable time step is:\n$$\n\\Delta t_{\\max} = \\min_{j=1,2,3} \\left( \\frac{-2\\mathrm{Re}(\\lambda_j)}{|\\lambda_j|^2} \\right)\n$$\nWe now calculate this value for each of the three given eigenvalues.\n\nFor $\\lambda_1 = -0.8$:\n$\\mathrm{Re}(\\lambda_1) = -0.8$ and $|\\lambda_1|^2 = (-0.8)^2 + 0^2 = 0.64$.\nThe constraint is $\\Delta t \\le \\frac{-2(-0.8)}{0.64} = \\frac{1.6}{0.64} = 2.5$. Thus, $\\Delta t_1 = 2.5 \\, \\mathrm{s}$.\n\nFor $\\lambda_2 = -0.5 + 1.2\\,\\mathrm{i}$:\n$\\mathrm{Re}(\\lambda_2) = -0.5$ and $|\\lambda_2|^2 = (-0.5)^2 + (1.2)^2 = 0.25 + 1.44 = 1.69$.\nThe constraint is $\\Delta t \\le \\frac{-2(-0.5)}{1.69} = \\frac{1}{1.69}$. Thus, $\\Delta t_2 = \\frac{1}{1.69} \\, \\mathrm{s}$.\n\nFor $\\lambda_3 = -1.3 - 0.4\\,\\mathrm{i}$:\n$\\mathrm{Re}(\\lambda_3) = -1.3$ and $|\\lambda_3|^2 = (-1.3)^2 + (-0.4)^2 = 1.69 + 0.16 = 1.85$.\nThe constraint is $\\Delta t \\le \\frac{-2(-1.3)}{1.85} = \\frac{2.6}{1.85}$. Thus, $\\Delta t_3 = \\frac{2.6}{1.85} \\, \\mathrm{s}$.\n\nWe must find the minimum of these three values to find $\\Delta t_{\\max}$:\n$\\Delta t_1 = 2.5$\n$\\Delta t_2 = \\frac{1}{1.69} \\approx 0.5917159...$\n$\\Delta t_3 = \\frac{2.6}{1.85} \\approx 1.4054054...$\nThe minimum value is $\\Delta t_2 = \\frac{1}{1.69}$.\nTherefore, $\\Delta t_{\\max} = \\frac{1}{1.69} \\, \\mathrm{s}$.\n\nThe problem requires a numerical value rounded to four significant figures.\n$$\n\\Delta t_{\\max} = \\frac{1}{1.69} \\, \\mathrm{s} \\approx 0.591715976... \\, \\mathrm{s}\n$$\nRounding to four significant figures gives $0.5917 \\, \\mathrm{s}$.",
            "answer": "$$\n\\boxed{0.5917}\n$$"
        },
        {
            "introduction": "Having learned how to find the stability limit, we now explore what happens when this limit is violated, particularly in the context of stiff systems. This exercise demonstrates the catastrophic consequences of using an explicit method with too large a time step on a stiff ordinary differential equation, a common scenario in modules for chemical kinetics within earth system models. By calculating the enormous ratio of the explosive numerical solution to the rapidly decaying exact solution, you will gain a tangible appreciation for the meaning of numerical instability .",
            "id": "3879025",
            "problem": "In a chemical kinetics module of an environmental and earth system model, a single reactive tracer undergoes first-order decay governed by the ordinary differential equation (ODE) $y'(t)=\\lambda\\,y(t)$ with a constant rate $\\lambda<0$. You apply a first-order explicit time-stepping method that approximates the time derivative by a forward difference over a uniform time step $\\Delta t$ to advance the numerical solution. Consider the following concrete experiment intended to probe stiffness-induced instability: take $\\lambda=-5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$, $\\Delta t=1.0\\times 10^{-4}\\ \\mathrm{s}$, and $N=10$ time steps from an initial condition of magnitude $\\lvert y(0)\\rvert=1$. Let $T=N\\,\\Delta t$ denote the final time.\n\nStarting only from the forward-difference definition of the method and the ODE, and without invoking any pre-stated stability criterion, do the following:\n- Derive the closed-form expression for the numerical solution after $N$ steps in terms of $\\lambda$, $\\Delta t$, $N$, and $y(0)$.\n- Derive the exact analytic solution at time $T$.\n- Using these, construct and simplify the expression for the dimensionless ratio $R$ defined as the magnitude of the numerical solution divided by the magnitude of the exact solution at the same final time $T$.\n- Evaluate $R$ for the given $\\lambda$, $\\Delta t$, and $N$.\n\nReport the final value of $R$ as a single real number in scientific notation, rounded to $4$ significant figures. The ratio $R$ is dimensionless; do not include units in your final answer.",
            "solution": "The ODE is $y'(t)=\\lambda\\,y(t)$ with constant $\\lambda<0$. The first principle we use is the definition of the forward difference approximation to the time derivative at time $t_{n}$:\n$$\n\\frac{y_{n+1}-y_{n}}{\\Delta t}\\approx y'(t_{n})=\\lambda\\,y_{n},\n$$\nwhere $y_{n}\\approx y(t_{n})$ and $t_{n}=n\\,\\Delta t$. Rearranging gives the explicit one-step recursion\n$$\ny_{n+1}=y_{n}+\\Delta t\\,\\lambda\\,y_{n}=\\left(1+\\lambda\\,\\Delta t\\right)y_{n}.\n$$\nIterating this $N$ times from $y_{0}=y(0)$ yields the closed-form numerical solution after $N$ steps:\n$$\ny_{N}=\\left(1+\\lambda\\,\\Delta t\\right)^{N}y_{0}.\n$$\n\nThe exact analytic solution of the ODE with constant $\\lambda$ is obtained by separation of variables or by recognizing it as a linear homogeneous ODE with constant coefficients:\n$$\ny(t)=y_{0}\\,\\exp\\!\\left(\\lambda\\,t\\right).\n$$\nAt the final time $T=N\\,\\Delta t$, the exact solution is\n$$\ny_{\\text{exact}}(T)=y_{0}\\,\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right).\n$$\n\nDefine the dimensionless ratio $R$ between the magnitudes of the numerical and exact solutions at time $T$:\n$$\nR \\equiv \\frac{\\lvert y_{N}\\rvert}{\\lvert y_{\\text{exact}}(T)\\rvert}=\\frac{\\left| \\left(1+\\lambda\\,\\Delta t\\right)^{N} y_{0}\\right|}{\\left| y_{0}\\,\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)\\right|}=\\frac{\\left|1+\\lambda\\,\\Delta t\\right|^{N}}{\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)}.\n$$\nThis expression quantifies, in a single number, the instability growth when the time step $\\Delta t$ violates the stability requirement for the explicit method on the stiff linear test equation.\n\nNow evaluate $R$ for the given parameters $\\lambda=-5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$, $\\Delta t=1.0\\times 10^{-4}\\ \\mathrm{s}$, and $N=10$:\n- Compute the nondimensional product:\n$$\n\\lambda\\,\\Delta t=\\left(-5.0\\times 10^{4}\\right)\\left(1.0\\times 10^{-4}\\right)=-5.0.\n$$\n- Hence,\n$$\n1+\\lambda\\,\\Delta t=1+(-5.0)=-4.0,\\quad \\left|1+\\lambda\\,\\Delta t\\right|=4.0.\n$$\n- The final time is\n$$\nT=N\\,\\Delta t=10\\times 1.0\\times 10^{-4}=1.0\\times 10^{-3}.\n$$\n- The exponential factor is\n$$\n\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)=\\exp\\!\\left(\\lambda\\,T\\right)=\\exp\\!\\left((-5.0\\times 10^{4})\\times (1.0\\times 10^{-3})\\right)=\\exp(-50).\n$$\nTherefore,\n$$\nR=\\frac{4.0^{10}}{\\exp(-50)}=4.0^{10}\\,\\exp(50).\n$$\nEvaluate numerically:\n$$\n4.0^{10}=\\left(2.0^{2}\\right)^{10}=2.0^{20}=1{,}048{,}576,\n$$\nand\n$$\n\\exp(50)\\approx 5.184705528587072\\times 10^{21}.\n$$\nThus,\n$$\nR\\approx \\left(1.048576\\times 10^{6}\\right)\\times \\left(5.184705528587072\\times 10^{21}\\right)=5.436557784342718\\times 10^{27}.\n$$\nRounded to $4$ significant figures, this is\n$$\nR\\approx 5.437\\times 10^{27}.\n$$\nThis very large value reflects the severe instability induced by choosing $\\Delta t$ such that $\\left|1+\\lambda\\,\\Delta t\\right|>1$ for a stiff decay with large negative $\\lambda$.",
            "answer": "$$\\boxed{5.437\\times 10^{27}}$$"
        },
        {
            "introduction": "Our final practice reveals that for certain problems, particularly the advection of tracers governed by hyperbolic partial differential equations, simple linear stability is not enough to ensure a physically meaningful solution. This coding exercise introduces the concept of Strong Stability Preserving (SSP) methods, which are designed to prevent the formation of unphysical oscillations, such as undershoots and overshoots in concentration fields. By comparing an SSP integrator with the classical (non-SSP) fourth-order Runge-Kutta scheme, you will see firsthand why certain high-order methods, while accurate and stable in the linear sense, can be unsuitable for modeling transport processes .",
            "id": "3879058",
            "problem": "Consider the one-dimensional scalar linear advection of a passive tracer governed by the partial differential equation (PDE) $$\\frac{\\partial q(x,t)}{\\partial t} + a \\frac{\\partial q(x,t)}{\\partial x} = 0,$$ where $q(x,t)$ is the nondimensional tracer concentration, $x \\in [0,1]$ is the nondimensional spatial coordinate on a periodic domain, $t \\ge 0$ is nondimensional time, and $a > 0$ is a constant nondimensional advection speed set to $a = 1$. Use the method of lines to discretize the PDE with a first-order upwind spatial flux for $a > 0$, yielding a semi-discrete system $$\\frac{d q_i(t)}{dt} = -\\frac{a}{\\Delta x} \\left(q_i(t) - q_{i-1}(t)\\right),$$ for grid index $i = 0,1,\\dots,N-1$ with periodic wrap-around $q_{-1} \\equiv q_{N-1}$, where $\\Delta x = 1/N$. Denote the Courant number by $$\\lambda = \\frac{a \\Delta t}{\\Delta x},$$ where $\\Delta t$ is the time step. For Forward Euler time stepping, the corresponding fully discrete update is $$q_i^{n+1} = (1 - \\lambda)\\, q_i^n + \\lambda\\, q_{i-1}^n.$$ In the context of Strong Stability Preserving (SSP) time integration, an explicit Runge–Kutta (RK) method is called SSP if each full step can be written as a convex combination of Forward Euler steps applied to the same semi-discrete operator, ensuring properties such as positivity preservation and Total Variation Diminishing (TVD) under the same time step restriction as Forward Euler up to a constant factor. A non-SSP explicit RK method does not satisfy this convexity requirement and can produce spurious oscillations, including undershoots and overshoots, even when the semi-discrete operator is monotone and the Courant number is within the Forward Euler stability bound.\n\nYour task is to construct and analyze a nondimensional numerical experiment that demonstrates how a non-SSP explicit RK method causes spurious oscillations in tracer advection by violating convexity constraints. Proceed as follows:\n\n- Initialize the tracer to a piecewise-constant step profile on the periodic domain: $$q(x,0) = \\begin{cases} 1, & x \\in [0.1,\\,0.4], \\\\ 0, & \\text{otherwise.} \\end{cases}$$ Discretize this initial condition on $N$ equally spaced points with $N \\ge 100$.\n\n- Implement the semi-discrete upwind operator with periodic boundary conditions for $a = 1$ exactly as shown above.\n\n- Implement three explicit time integrators:\n  1. Forward Euler (FE), as given by the formula above. This method is known to be monotone for $\\lambda \\le 1$, hence it is a control case.\n  2. The Strong Stability Preserving third-order Runge–Kutta method (SSPRK$3$), also known as Shu–Osher RK$3$, with stages that can be written as convex combinations of Forward Euler steps when $\\lambda \\le 1$.\n  3. The classical explicit Runge–Kutta method of order four (RK$4$), which is not Strong Stability Preserving.\n\n- Evolve the system to a final nondimensional time $T$ using each integrator. Quantify spurious oscillations using the following metrics computed at final time:\n  1. Undershoot magnitude: $$U = \\max\\left(0,\\, -\\min_i q_i(T)\\right).$$\n  2. Overshoot magnitude: $$V = \\max\\left(0,\\, \\max_i q_i(T) - 1\\right).$$\n  3. Total variation increase: $$\\Delta \\mathrm{TV} = \\max\\left(0,\\, \\mathrm{TV}(q(T)) - \\mathrm{TV}(q(0))\\right),$$ where $$\\mathrm{TV}(q) = \\sum_{i=0}^{N-1} \\left|q_{i+1} - q_i\\right|,$$ with periodic wrap-around $q_N \\equiv q_0$.\n\n- Explain, in terms of convexity constraints, why SSPRK$3$ and Forward Euler avoid spurious oscillations for $\\lambda \\le 1$, while RK$4$ can generate them even for small $\\lambda$.\n\nDesign a test suite of parameter values to exercise different regimes and edge cases. Use nondimensional quantities throughout, so no physical units are required. The test suite must comprise the following cases:\n- Case $1$: Method $=$ SSPRK$3$, $\\lambda = 0.95$, $N = 200$, $T = 0.5$.\n- Case $2$: Method $=$ RK$4$, $\\lambda = 0.95$, $N = 200$, $T = 0.5$.\n- Case $3$: Method $=$ RK$4$, $\\lambda = 0.20$, $N = 200$, $T = 0.5$.\n- Case $4$: Method $=$ Forward Euler, $\\lambda = 0.95$, $N = 200$, $T = 0.5$.\n- Case $5$: Method $=$ SSPRK$3$, $\\lambda = 1.00$, $N = 200$, $T = 0.5$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is itself a list of three floats $[U, V, \\Delta \\mathrm{TV}]$ in that order. For all five cases above, the final output format must be exactly\n$$\\bigl[\\,[U_1, V_1, \\Delta \\mathrm{TV}_1],\\, [U_2, V_2, \\Delta \\mathrm{TV}_2],\\, [U_3, V_3, \\Delta \\mathrm{TV}_3],\\, [U_4, V_4, \\Delta \\mathrm{TV}_4],\\, [U_5, V_5, \\Delta \\mathrm{TV}_5]\\,\\bigr].$$",
            "solution": "The problem requires a demonstration and explanation of spurious oscillations generated by non-Strong Stability Preserving (non-SSP) time integration schemes when applied to a hyperbolic conservation law. We will analyze the behavior of three explicit time integrators—Forward Euler (FE), a third-order Strong Stability Preserving Runge-Kutta method (SSPRK$3$), and the classical fourth-order Runge-Kutta method (RK$4$)—on the one-dimensional linear advection equation.\n\nThe governing partial differential equation (PDE) is the linear advection of a passive tracer concentration $q(x,t)$:\n$$\n\\frac{\\partial q(x,t)}{\\partial t} + a \\frac{\\partial q(x,t)}{\\partial x} = 0\n$$\nThis equation is defined on a periodic spatial domain $x \\in [0,1]$ with time $t \\ge 0$. The advection speed is a positive constant, set to $a = 1$.\n\nWe use the method of lines, first discretizing in space. The spatial domain is discretized into $N$ uniform grid cells of width $\\Delta x = 1/N$. The tracer concentration $q(x,t)$ is represented by its grid-point values $q_i(t)$ for $i = 0, 1, \\dots, N-1$. Using a first-order upwind scheme for the spatial derivative $\\partial q/\\partial x$, which is appropriate for $a > 0$, we obtain the semi-discrete system of ordinary differential equations (ODEs):\n$$\n\\frac{d q_i(t)}{dt} = -\\frac{a}{\\Delta x} \\left(q_i(t) - q_{i-1}(t)\\right) \\equiv \\mathcal{L}(q)_i\n$$\nHere, $\\mathcal{L}$ denotes the semi-discrete spatial operator. The boundary conditions are periodic, so the index $i-1$ is handled with a wrap-around, i.e., $q_{-1} \\equiv q_{N-1}$. This system of ODEs is then solved using an explicit time integration scheme.\n\nThe core of the problem lies in the properties of the chosen time integrator. The key concept is that of Strong Stability Preservation (SSP). This property relates the stability of a high-order Runge-Kutta method to the stability of the simple Forward Euler method.\n\nThe Forward Euler (FE) method applied to the semi-discrete system gives the fully discrete update rule:\n$$\nq_i^{n+1} = q_i^n + \\Delta t \\, \\mathcal{L}(q^n)_i = q_i^n - \\frac{a \\Delta t}{\\Delta x} (q_i^n - q_{i-1}^n)\n$$\nDefining the Courant number $\\lambda = a \\Delta t / \\Delta x$, the FE update can be written as:\n$$\nq_i^{n+1} = (1 - \\lambda) q_i^n + \\lambda q_{i-1}^n\n$$\nThis update expresses the new value $q_i^{n+1}$ as a linear combination of values from the previous time step. For this combination to be a **convex combination**, its coefficients must be non-negative and sum to $1$. The sum is $(1-\\lambda) + \\lambda = 1$. The non-negativity condition requires $1-\\lambda \\ge 0$ and $\\lambda \\ge 0$. Since $a, \\Delta t, \\Delta x$ are all positive, $\\lambda \\ge 0$ is satisfied, and the crucial condition is $\\lambda \\le 1$.\n\nWhen $0 \\le \\lambda \\le 1$, the FE step is a convex combination. A fundamental property of convex combinations is that they cannot produce values outside the range of the input values. If $\\min(q^n) \\le q_j^n \\le \\max(q^n)$ for all $j$, then $\\min(q^n) \\le q_i^{n+1} \\le \\max(q^n)$. This guarantees that no new extrema (spurious oscillations) are created. This property is also known as monotonicity or positivity-preservation. For the given initial condition $q(x,0) \\in [0,1]$, the FE scheme with $\\lambda \\le 1$ ensures $q_i^n \\in [0,1]$ for all $n$ and $i$. This also implies that the total variation (TV) of the solution, $\\mathrm{TV}(q) = \\sum_i |q_{i+1} - q_i|$, does not increase, i.e., $\\mathrm{TV}(q^{n+1}) \\le \\mathrm{TV}(q^n)$.\n\nAn explicit Runge-Kutta method is defined as **Strong Stability Preserving (SSP)** if a full time step can be written as a convex combination of Forward Euler steps. The SSPRK$3$ method (Shu-Osher) is designed to have this property. Its staged form is:\n\\begin{align*}\nq^{(1)} &= q^n + \\Delta t \\mathcal{L}(q^n) \\\\\nq^{(2)} &= \\frac{3}{4}q^n + \\frac{1}{4}\\left(q^{(1)} + \\Delta t \\mathcal{L}(q^{(1)})\\right) \\\\\nq^{n+1} &= \\frac{1}{3}q^n + \\frac{2}{3}\\left(q^{(2)} + \\Delta t \\mathcal{L}(q^{(2)})\\right)\n\\end{align*}\nEach stage is a convex combination of a previous state and a Forward Euler step applied to a previous state. If the Forward Euler step is monotone (which it is for $\\lambda \\le 1$), and each stage is a convex combination, the entire SSPRK$3$ step inherits the monotonicity property. The SSPRK$3$ method is TVD under the same time-step restriction as Forward Euler, i.e., $\\lambda \\le 1$. Therefore, like FE, it should not generate spurious oscillations, undershoots, or overshoots for the given problem.\n\nIn contrast, the classical fourth-order Runge-Kutta (RK$4$) method is **not** an SSP method. Its update formula is:\n\\begin{align*}\nk_1 &= \\Delta t \\mathcal{L}(q^n) \\\\\nk_2 &= \\Delta t \\mathcal{L}(q^n + \\frac{1}{2}k_1) \\\\\nk_3 &= \\Delta t \\mathcal{L}(q^n + \\frac{1}{2}k_2) \\\\\nk_4 &= \\Delta t \\mathcal{L}(q^n + k_3) \\\\\nq^{n+1} &= q^n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{align*}\nThis formula cannot be expressed as a convex combination of Forward Euler steps. The internal stages and their final recombination do not guarantee preservation of monotonicity. When written in the canonical Shu-Osher form, some coefficients in the convex combination are negative. The presence of negative coefficients means the scheme can produce values outside the bounds of the previous step's data, leading to the creation of new minima and maxima. This manifests as spurious oscillations, such as undershoots below $0$ and overshoots above $1$. This can occur even when the Courant number $\\lambda$ is well within the linear stability limit of the RK$4$ scheme (which for this problem is $\\lambda \\approx 2.785$). The numerical experiment, by using $\\lambda \\le 1$, is specifically designed to isolate this failure of convexity from linear instability.\n\nThe numerical experiment is set up as follows:\nThe initial condition is a step function: $q(x,0) = 1$ for $x \\in [0.1, 0.4]$ and $0$ otherwise. This profile is discretized on a grid with $N=200$ points.\nThe system is evolved until a final time $T=0.5$. With $a=1$, the exact solution is the initial profile advected by $0.5$ units to the right, becoming a step function on $[0.6, 0.9]$.\nWe will compare the numerical solutions from FE, SSPRK$3$, and RK$4$ for different Courant numbers $\\lambda$. We quantify the spurious oscillations using three metrics evaluated at $t=T$:\n1.  Undershoot magnitude: $U = \\max(0, -\\min_i q_i(T))$. Any value below $0$ contributes to $U$.\n2.  Overshoot magnitude: $V = \\max(0, \\max_i q_i(T) - 1)$. Any value above $1$ contributes to $V$.\n3.  Total variation increase: $\\Delta \\mathrm{TV} = \\max(0, \\mathrm{TV}(q(T)) - \\mathrm{TV}(q(0)))$. An increase in total variation signifies the creation of new local extrema.\n\nThe algorithm proceeds by initializing the grid and the tracer profile. For each test case, it calculates the time step $\\Delta t$ from the given $\\lambda$, $N$, and $a$. It then iterates the chosen time-stepping scheme for the required number of steps to reach $T$. Finally, it computes and records the metrics $U$, $V$, and $\\Delta \\mathrm{TV}$. The results from the test cases are expected to confirm the theoretical analysis: FE and SSPRK$3$ should yield $U, V, \\Delta \\mathrm{TV}$ equal to $0$ for $\\lambda \\le 1$, while RK$4$ should produce non-zero values for these metrics, indicating the presence of spurious oscillations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection problem using different time integrators\n    to demonstrate the properties of Strong Stability Preserving (SSP) methods.\n    \"\"\"\n\n    test_cases = [\n        {'method': 'SSPRK3', 'lambda': 0.95, 'N': 200, 'T': 0.5},\n        {'method': 'RK4', 'lambda': 0.95, 'N': 200, 'T': 0.5},\n        {'method': 'RK4', 'lambda': 0.20, 'N': 200, 'T': 0.5},\n        {'method': 'Forward Euler', 'lambda': 0.95, 'N': 200, 'T': 0.5},\n        {'method': 'SSPRK3', 'lambda': 1.00, 'N': 200, 'T': 0.5},\n    ]\n\n    results = []\n\n    def L(q, a, dx):\n        \"\"\"\n        Computes the semi-discrete spatial operator L(q) for 1st-order upwind.\n        L(q)_i = -a/dx * (q_i - q_{i-1})\n        \"\"\"\n        q_prev = np.roll(q, 1)\n        return -a / dx * (q - q_prev)\n\n    def fe_step(q, dt, a, dx):\n        \"\"\"A single Forward Euler step.\"\"\"\n        return q + dt * L(q, a, dx)\n\n    def ssp_rk3_step(q, dt, a, dx):\n        \"\"\"A single SSPRK3 (Shu-Osher) step.\"\"\"\n        q1 = q + dt * L(q, a, dx)\n        q2 = 0.75 * q + 0.25 * (q1 + dt * L(q1, a, dx))\n        q_new = (1./3.) * q + (2./3.) * (q2 + dt * L(q2, a, dx))\n        return q_new\n\n    def rk4_step(q, dt, a, dx):\n        \"\"\"A single classical RK4 step.\"\"\"\n        k1 = dt * L(q, a, dx)\n        k2 = dt * L(q + 0.5 * k1, a, dx)\n        k3 = dt * L(q + 0.5 * k2, a, dx)\n        k4 = dt * L(q + k3, a, dx)\n        return q + (1./6.) * (k1 + 2*k2 + 2*k3 + k4)\n\n    def tv(q):\n        \"\"\"Computes the total variation of a periodic array q.\"\"\"\n        # |q_{i+1} - q_i| summed over all i, with q_N = q_0.\n        # np.roll(q, -1) gives q_{i+1} at index i.\n        return np.sum(np.abs(np.roll(q, -1) - q))\n\n    integrators = {\n        'Forward Euler': fe_step,\n        'SSPRK3': ssp_rk3_step,\n        'RK4': rk4_step,\n    }\n\n    for case in test_cases:\n        N = case['N']\n        T = case['T']\n        lam = case['lambda']\n        method_name = case['method']\n\n        a = 1.0\n        dx = 1.0 / N\n        dt = lam * dx / a\n\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n        q0 = np.zeros(N)\n        q0[(x >= 0.1) & (x <= 0.4)] = 1.0\n\n        q = q0.copy()\n        \n        tv0 = tv(q0)\n\n        num_steps = int(np.ceil(T / dt))\n        integrator = integrators[method_name]\n        \n        for _ in range(num_steps):\n            q = integrator(q, dt, a, dx)\n\n        # Ensure final time is exactly T if dt doesn't divide T\n        # This is a minor correction but good practice for precise comparison.\n        # However, the problem implies a fixed number of steps.\n        # We will stick to the specified logic of `ceil(T/dt)` steps.\n        # The problem is nondimensional and cares about the behavior of the scheme,\n        # slight variations in final time across methods are acceptable.\n\n        q_final = q\n\n        undershoot = np.maximum(0.0, -np.min(q_final))\n        overshoot = np.maximum(0.0, np.max(q_final) - 1.0)\n        \n        tv_final = tv(q_final)\n        delta_tv = np.maximum(0.0, tv_final - tv0)\n\n        results.append([undershoot, overshoot, delta_tv])\n    \n    # Format the final output string exactly as specified.\n    # The str() representation of a list is `[item1, item2, ...]`.\n    # Joining these with commas and enclosing in brackets gives the desired format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}