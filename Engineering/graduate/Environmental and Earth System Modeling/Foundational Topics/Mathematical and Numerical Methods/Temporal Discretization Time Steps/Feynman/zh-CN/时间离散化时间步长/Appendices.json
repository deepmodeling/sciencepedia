{
    "hands_on_practices": [
        {
            "introduction": "我们如何确定模型代码的实现是正确的？这是一个在模型开发中至关重要的问题。本练习将介绍理查森外推法 (Richardson extrapolation)，这是一种强大的技术，可以通过数值结果来估计数值格式的实际收敛阶数。通过在不同时间步长下运行模型，你不仅可以验证代码是否达到了其理论收敛率，还能获得对解本身更精确的估计。",
            "id": "3920972",
            "problem": "考虑一个地球系统模式中的预报量，其定义为在固定的预报时间 $T$ 时，某一被动示踪物的归一化、区域积分质量，记为 $u(T;\\Delta t)$，其中 $\\Delta t$ 是用于常微分方程(ODE)数值积分的均匀时间步长。该模式使用一种一致且稳定的时间离散格式。假设全局时间离散误差允许一个形如 $u(T;\\Delta t)=u^{\\star}(T)+C\\,(\\Delta t)^{p}+\\mathcal{O}((\\Delta t)^{p+1})$ 的渐近展开，其中 $u^{\\star}(T)$ 是 $\\Delta t\\to 0$ 时的极限（即时间 $T$ 处的时程连续解），$C$ 是一个与 $\\Delta t$ 无关的常数，而 $p0$ 是关于时间步长的（未知的）观测精度阶。给定在同一时间 $T$、使用三种不同时间步长得到的三个数值计算结果：$u(T;\\Delta t)=0.983000$，$u\\!\\left(T;\\tfrac{\\Delta t}{2}\\right)=0.990000$ 和 $u\\!\\left(T;\\tfrac{\\Delta t}{4}\\right)=0.991750$。请仅使用上述假设和这三个计算结果，建立理查森外推法以消除主误差项，从而估计出 $\\Delta t\\to 0$ 的极限 $u^{\\star}(T)$ 和观测精度阶 $p$。将您的最终答案表示为一个二元行向量 $\\begin{pmatrix}u^{\\star}(T)  p\\end{pmatrix}$，并四舍五入至五位有效数字。量 $u^{\\star}(T)$ 是无量纲的；请以不带单位的形式表示您的答案。",
            "solution": "本题要求根据使用逐次减半的时间步长得到的三个数值计算结果，来估计某量 $u(T;\\Delta t)$ 的真实解 $u^{\\star}(T)$ 和观测精度阶 $p$。题目陈述给出了数值解的渐近误差展开式：\n$$u(T;\\Delta t) = u^{\\star}(T) + C(\\Delta t)^{p} + \\mathcal{O}((\\Delta t)^{p+1})$$\n其中 $u^{\\star}(T)$ 是精确的时程连续解，$C$ 是与时间步长 $\\Delta t$ 无关的常数，$p$ 是精度阶。\n\n我们有三个给定的数据点。为简化记法，我们定义：\n$u_1 = u(T; \\Delta t) = 0.983000$\n$u_2 = u(T; \\frac{\\Delta t}{2}) = 0.990000$\n$u_3 = u(T; \\frac{\\Delta t}{4}) = 0.991750$\n令 $u^{\\star}$ 表示 $u^{\\star}(T)$。\n\n通过忽略高阶项 $\\mathcal{O}((\\Delta t)^{p+1})$，我们可以建立一个包含三个近似方程的方程组：\n$$u_1 \\approx u^{\\star} + C(\\Delta t)^{p} \\quad (1)$$\n$$u_2 \\approx u^{\\star} + C\\left(\\frac{\\Delta t}{2}\\right)^{p} = u^{\\star} + C(\\Delta t)^{p} 2^{-p} \\quad (2)$$\n$$u_3 \\approx u^{\\star} + C\\left(\\frac{\\Delta t}{4}\\right)^{p} = u^{\\star} + C(\\Delta t)^{p} 4^{-p} \\quad (3)$$\n我们的目标是求解该方程组以得到 $p$ 和 $u^{\\star}$。\n\n首先，我们确定精度阶 $p$。我们可以通过计算连续近似值之间的差来消去 $u^{\\star}$：\n$$u_2 - u_1 \\approx \\left(u^{\\star} + C(\\Delta t)^{p} 2^{-p}\\right) - \\left(u^{\\star} + C(\\Delta t)^{p}\\right) = C(\\Delta t)^{p} (2^{-p} - 1) \\quad (4)$$\n$$u_3 - u_2 \\approx \\left(u^{\\star} + C(\\Delta t)^{p} 4^{-p}\\right) - \\left(u^{\\star} + C(\\Delta t)^{p} 2^{-p}\\right) = C(\\Delta t)^{p} (4^{-p} - 2^{-p}) \\quad (5)$$\n现在，我们可以通过计算这些差值的比率来消去项 $C(\\Delta t)^{p}$。设该比率为 $R$：\n$$R = \\frac{u_2 - u_1}{u_3 - u_2} \\approx \\frac{C(\\Delta t)^{p} (2^{-p} - 1)}{C(\\Delta t)^{p} (4^{-p} - 2^{-p})} = \\frac{2^{-p} - 1}{2^{-2p} - 2^{-p}}$$\n我们可以从分母中提出因子 $2^{-p}$：\n$$R \\approx \\frac{2^{-p} - 1}{2^{-p}(2^{-p} - 1)}$$\n假设 $p  0$，则项 $(2^{-p}-1)$ 非零，因此我们可以消去它：\n$$R \\approx \\frac{1}{2^{-p}} = 2^{p}$$\n这为估计 $p$ 提供了一个直接的方法。让我们代入给定的数值：\n$$u_2 - u_1 = 0.990000 - 0.983000 = 0.007000$$\n$$u_3 - u_2 = 0.991750 - 0.990000 = 0.001750$$\n比率 $R$ 为：\n$$R = \\frac{0.007000}{0.001750} = \\frac{7000}{1750} = 4$$\n根据关系式 $R \\approx 2^p$，我们有：\n$$2^p \\approx 4$$\n解出 $p$ 可得：\n$$p = \\log_2(4) = 2$$\n观测精度阶为 $p=2$。这个整数结果表明，该数值格式确实是二阶精度的，并且在此分辨率水平上，高阶误差项可以忽略不计。\n\n接下来，我们使用理查森外推法估计精确解 $u^{\\star}$。我们可以使用这三个方程中的任意两个来消除主误差项。让我们使用方程 $(1)$ 和 $(2)$：\n$$u_1 \\approx u^{\\star} + C(\\Delta t)^{p}$$\n$$u_2 \\approx u^{\\star} + C(\\Delta t)^{p} 2^{-p}$$\n为消除误差项 $C(\\Delta t)^{p}$，我们可以将第二个方程乘以 $2^p$，然后用所得结果减去第一个方程：\n$$2^p u_2 \\approx 2^p u^{\\star} + C(\\Delta t)^{p}$$\n$$(2^p u_2) - u_1 \\approx (2^p u^{\\star} + C(\\Delta t)^{p}) - (u^{\\star} + C(\\Delta t)^{p})$$\n$$2^p u_2 - u_1 \\approx 2^p u^{\\star} - u^{\\star}$$\n$$2^p u_2 - u_1 \\approx u^{\\star}(2^p - 1)$$\n解出 $u^{\\star}$：\n$$u^{\\star} \\approx \\frac{2^p u_2 - u_1}{2^p - 1}$$\n这是步长细化因子为2时的理查森外推公式。现在，我们代入 $p=2$ 以及 $u_1$ 和 $u_2$ 的给定值：\n$$u^{\\star} \\approx \\frac{2^2 u_2 - u_1}{2^2 - 1} = \\frac{4 u_2 - u_1}{3}$$\n$$u^{\\star} \\approx \\frac{4(0.990000) - 0.983000}{3} = \\frac{3.960000 - 0.983000}{3} = \\frac{2.977000}{3}$$\n$$u^{\\star} \\approx 0.992333...$$\n作为一致性检验，我们可以使用 $u_2$ 和 $u_3$ 进行相同的外推计算。时间步长分别为 $\\frac{\\Delta t}{2}$ 和 $\\frac{\\Delta t}{4}$，因此细化因子仍为2。公式变为：\n$$u^{\\star} \\approx \\frac{2^p u_3 - u_2}{2^p - 1} = \\frac{4 u_3 - u_2}{3}$$\n$$u^{\\star} \\approx \\frac{4(0.991750) - 0.990000}{3} = \\frac{3.967000 - 0.990000}{3} = \\frac{2.977000}{3}$$\n$$u^{\\star} \\approx 0.992333...$$\n两种计算都得出了相同的 $u^{\\star}$ 结果，这增强了我们对 $p$ 和 $u^{\\star}$ 两个值的信心。\n\n题目要求最终答案四舍五入至五位有效数字。\n对于 $u^{\\star}$，我们有 $0.992333...$，四舍五入为 $0.99233$。\n对于 $p$，我们得到精确值 $2$，表示为五位有效数字是 $2.0000$。\n\n最终结果是二元行向量 $\\begin{pmatrix}u^{\\star}(T)  p\\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.99233  2.0000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "环境模型通常包含时间尺度差异巨大的过程，例如快速的化学反应和缓慢的输运过程，这类问题被称为“刚性” (stiff) 问题。本练习探讨了刚性问题以及不同时间积分格式 (如后向欧拉法和Crank-Nicolson法) 在此类问题上的表现。你将推导一个格式产生非物理振荡的条件，并学习如何选择能保证解稳定、单调收敛的时间步长。",
            "id": "3921025",
            "problem": "一个用于描述活性大气示踪剂的环境单箱模型，其浓度为 $C(t)$，由一个一阶的产生-损失平衡所控制。其中，产生速率 $S$ 是恒定的，而损失是线性的，速率常数为 $k0$。其演化方程为\n$$\n\\frac{dC}{dt} = S - k\\,C.\n$$\n这个常微分方程代表了一个典型的刚性子问题，这种问题在地球系统模型中对输运-反应方程进行空间离散化后会出现。考虑离散时间层 $t^{n}$ 和 $t^{n+1}=t^{n}+\\Delta t$，时间步长为 $\\Delta t0$。定义平衡浓度 $C^{\\ast}$ 和偏差（误差）$e^{n}=C^{n}-C^{\\ast}$，其中 $C^{n}$ 是 $C(t^{n})$ 的近似值。对于 Backward Euler 方法和 Crank–Nicolson 方法，假设在该时间步内唯一活跃的过程是上述线性反应，请构建偏差 $e^{n}$ 的单步更新式。\n\n仅使用这些时间积分器和控制方程的基本定义，为每种方法推导由 $e^{n+1}=g\\,e^{n}$ 定义的标量放大因子 $g$。将单调性解释为离散轨迹在接近 $C^{\\ast}$ 时不产生过冲，即对于任何初始符号的 $e^{0}$，$e^{n}$ 的符号不随时间改变。基于此，确定 Crank–Nicolson 方法能保证单调趋近 $C^{\\ast}$ 的最大允许时间步长 $\\Delta t_{\\max}$，并将其表示为 $k$ 的函数。将你的最终答案表示为仅包含 $k$ 的闭式符号表达式，并且不包含单位。",
            "solution": "首先，我们验证该问题，并确认它在常微分方程的数值分析领域是一个适定且科学上合理的问题。\n\n首先，我们确定示踪剂的平衡浓度 $C^{\\ast}$。平衡态的特征是浓度不随时间变化，即 $\\frac{dC}{dt} = 0$。将此条件代入控制方程：\n$$\n0 = S - k\\,C^{\\ast}\n$$\n解得 $C^{\\ast}$：\n$$\nC^{\\ast} = \\frac{S}{k}\n$$\n鉴于 $S$ 是一个恒定速率且 $k0$，平衡浓度 $C^{\\ast}$ 是一个正常数。\n\n接下来，我们用偏离平衡的量 $e(t) = C(t) - C^{\\ast}$ 来重写控制方程。浓度的导数是 $\\frac{dC}{dt} = \\frac{d}{dt}(e(t) + C^{\\ast}) = \\frac{de}{dt}$，因为 $C^{\\ast}$ 是常数。将 $C(t) = e(t) + C^{\\ast}$ 代入原始的常微分方程（ODE）：\n$$\n\\frac{de}{dt} = S - k(e(t) + C^{\\ast})\n$$\n$$\n\\frac{de}{dt} = S - k\\,e(t) - k\\,C^{\\ast}\n$$\n使用平衡浓度的表达式，$k\\,C^{\\ast} = k \\left(\\frac{S}{k}\\right) = S$。偏差的方程简化为一个齐次线性常微分方程：\n$$\n\\frac{de}{dt} = -k\\,e(t)\n$$\n现在，我们将使用指定的数值格式对偏差 $e(t)$ 的方程进行离散化，其中 $e^n$ 是 $e(t^n)$ 的数值近似。\n\n对于 Backward Euler 方法，时间导数在未来时间层 $t^{n+1}$ 处进行近似：\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = -k\\,e^{n+1}\n$$\n为了找到单步更新式，我们求解 $e^{n+1}$：\n$$\ne^{n+1} - e^n = -k\\,\\Delta t\\,e^{n+1}\n$$\n$$\ne^{n+1} + k\\,\\Delta t\\,e^{n+1} = e^n\n$$\n$$\ne^{n+1}(1 + k\\,\\Delta t) = e^n\n$$\n因此，更新规则为 $e^{n+1} = \\frac{1}{1 + k\\,\\Delta t} e^n$。Backward Euler 方法的标量放大因子 $g_{BE}$ 因此是：\n$$\ng_{BE} = \\frac{1}{1 + k\\,\\Delta t}\n$$\n因为 $k0$ 且 $\\Delta t0$，我们有 $0  g_{BE}  1$。这意味着对于此问题，无论时间步长大小如何，Backward Euler 方法总是单调的。\n\n对于 Crank–Nicolson 方法，常微分方程的右侧被近似为它在 $t^n$ 和 $t^{n+1}$ 处值的平均值：\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = \\frac{1}{2}(-k\\,e^n - k\\,e^{n+1})\n$$\n我们求解 $e^{n+1}$ 来找到更新规则：\n$$\ne^{n+1} - e^n = -\\frac{k\\,\\Delta t}{2}(e^n + e^{n+1})\n$$\n$$\ne^{n+1} + \\frac{k\\,\\Delta t}{2}e^{n+1} = e^n - \\frac{k\\,\\Delta t}{2}e^n\n$$\n$$\ne^{n+1}\\left(1 + \\frac{k\\,\\Delta t}{2}\\right) = e^n\\left(1 - \\frac{k\\,\\Delta t}{2}\\right)\n$$\n更新规则为 $e^{n+1} = \\frac{1 - k\\,\\Delta t/2}{1 + k\\,\\Delta t/2} e^n$。Crank–Nicolson 方法的标量放大因子 $g_{CN}$ 是：\n$$\ng_{CN} = \\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}}\n$$\n问题将单调性定义为数值解在接近平衡点 $C^{\\ast}$ 时不产生过冲。这意味着偏差 $e^n = C^n - C^{\\ast}$ 的符号不能在相邻的时间步之间改变。也就是说，对于任何 $n$，都有 $\\text{sign}(e^{n+1}) = \\text{sign}(e^n)$。因为 $e^{n+1} = g_{CN}\\,e^n$，所以这个条件当且仅当放大因子 $g_{CN}$ 为非负时成立。\n$$\ng_{CN} \\ge 0\n$$\n代入 $g_{CN}$ 的表达式：\n$$\n\\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}} \\ge 0\n$$\n分母 $1 + \\frac{k\\,\\Delta t}{2}$ 是严格为正的，因为 $k  0$ 且 $\\Delta t  0$。因此，该不等式成立的充要条件是分子为非负：\n$$\n1 - \\frac{k\\,\\Delta t}{2} \\ge 0\n$$\n现在，我们求解 $\\Delta t$：\n$$\n1 \\ge \\frac{k\\,\\Delta t}{2}\n$$\n两边乘以 $2$ 得：\n$$\n2 \\ge k\\,\\Delta t\n$$\n因为 $k  0$，我们可以用 $k$ 去除而不改变不等号方向：\n$$\n\\Delta t \\le \\frac{2}{k}\n$$\n这个不等式给出了时间步长 $\\Delta t$ 为确保单调趋近平衡所需满足的条件。最大允许时间步长 $\\Delta t_{\\max}$ 是满足此条件的 $\\Delta t$ 的最大值。\n$$\n\\Delta t_{\\max} = \\frac{2}{k}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{k}}\n$$"
        },
        {
            "introduction": "在地球系统模型中，准确模拟波动现象——从海洋潮汐到大气重力波——至关重要。本练习深入分析由数值方法引入的相位误差 (数值频散) 和振幅误差 (数值耗散)。通过将二阶和四阶龙格-库塔方法 (RK2和RK4) 应用于一个简单的振荡问题，你将学会如何量化这些误差，并理解为何高阶方法对于长时间的波动模拟通常是必不可少的。",
            "id": "3921036",
            "problem": "在环境和地球系统建模中，诸如线性化惯性重力波和正压模等振荡模式，通常表现为满足线性常微分方程 $u'(t) = i \\,\\omega\\, u(t)$ 的局部谐波分量，其中 $u(t)$ 是一个复值振幅，$\\omega  0$ 是一个实角频率，$i$ 是虚数单位。当对这些模式进行时间积分时，数值频散（相位误差）和数值耗散（振幅误差）会在多个周期内累积，并显著影响波传播、能量收支和相位相干性的预报和诊断。\n\n考虑测试方程 $u'(t) = i \\,\\omega\\, u(t)$，设数值时间步长为 $\\Delta t$，无量纲步长 $\\alpha = \\omega \\,\\Delta t$ 假定很小 ($\\alpha \\ll 1$)，这与大气-海洋模型中的实际稳定性和精度约束一致。设 $M$ 是一个正整数，表示积分的完整周期数。精确解每步前进一个复数因子 $\\exp(i\\,\\alpha)$，每步产生单位模长和相位增量 $\\alpha$。一个单步显式龙格-库塔 (RK) 方法每步前进一个该方法特有的复放大因子 $R(\\alpha)$，从而得到每步数值相位增量 $\\arg(R(\\alpha))$ 和模长 $|R(\\alpha)|$。\n\n使用标准的显式二阶龙格-库塔（RK2，中点）法和经典的显式四阶龙格-库塔（RK4）法：\n- 对于每种应用于 $u'(t) = i \\,\\omega\\, u(t)$ 的方法，推导其每步数值放大因子 $R(\\alpha)$。\n- 从第一性原理出发，定义相对于精确演化的每步数值频散（相位误差）和耗散（振幅误差），并求出 RK2 和 RK4 方法中它们以 $\\alpha$ 的幂表示的主阶渐近展开。\n- 将这些每步误差在 $M$ 个完整周期内累积。设 $m$ 是每个周期的步数（因此总步数为 $N = M\\,m$），并将累积相位滞后定义为数值总相位 $N\\,\\arg(R(\\alpha))$ 与精确总相位 $M \\cdot 2\\pi$ 之差的绝对值。\n- 计算、简化并报告在 $M$ 个周期后，RK2 与 RK4 的累积相位滞后的量值的主阶比率（在小 $\\alpha$ 极限下）。将您的最终答案表示为仅包含 $\\omega$ 和 $\\Delta t$ 的单个闭式解析表达式。无需四舍五入。最终比率是无量纲的。",
            "solution": "该问题要求分析两种不同的龙格-库塔方法，RK2（中点法）和 RK4（经典法），在应用于振荡测试方程 $u'(t) = i \\omega u(t)$ 时的数值相位误差。目标是求出它们在大量周期内的累积相位滞后之比。\n\n设在时间 $t_n$ 的数值解为 $u_n$。单步法的一个步骤可以写为 $u_{n+1} = G(u_n, \\Delta t)$。对于线性方程 $u' = \\lambda u$，这可以表示为 $u_{n+1} = R(\\lambda \\Delta t) u_n$，其中 $R(z)$ 是方法的稳定函数。对于我们的问题，$\\lambda = i\\omega$，我们定义无量纲步长为 $\\alpha = \\omega \\Delta t$，因此 $z = i\\alpha$。每步的数值放大因子是 $R(i\\alpha)$。问题中使用记号 $R(\\alpha)$ 来表示此量。\n\n精确解为 $u(t) = u(0) \\exp(i\\omega t)$。经过一个时间步长 $\\Delta t$ 后，精确解被因子 $\\exp(i\\omega \\Delta t) = \\exp(i\\alpha)$ 放大。该因子的模为 1，相位为 $\\alpha$。数值解被 $R(i\\alpha)$ 放大，其模为 $|R(i\\alpha)|$，相位为 $\\arg(R(i\\alpha))$。每步振幅误差为 $|R(i\\alpha)| - 1$，每步相位误差为 $\\arg(R(i\\alpha)) - \\alpha$。\n\n首先，我们为每种方法推导放大因子 $R(i\\alpha)$。\n\n对于一个通用的龙格-库塔方法，其对 $u'=\\lambda u$ 的稳定函数由 $R(z) = 1 + z b^T (I - z A)^{-1} \\mathbb{1}$ 给出，其中 $A, b, c$ 是 Butcher 系数表中的系数，$z = \\lambda \\Delta t$。对于一个显式 RK 方法，$A$ 是严格下三角矩阵，$(I-zA)^{-1}$ 可以展开为一个有限级数，从而得到一个关于 $z$ 的多项式。对于一个 $p$ 阶方法，其稳定函数为 $R(z) = \\sum_{k=0}^{p} \\frac{z^k}{k!}$ 加上该方法特有的更高阶项。对于许多标准的显式方法，包括中点法和经典 RK4，其稳定函数恰好是 $\\exp(z)$ 的 $p$ 次泰勒多项式。\n\n**1. 二阶龙格-库塔（中点）法 (RK2)**\n\n显式中点法是一种二阶方法 ($p=2$)。其稳定函数由 $\\exp(z)$ 的直到二阶的泰勒级数给出：\n$R_{\\text{RK2}}(z) = 1 + z + \\frac{z^2}{2!}$。\n代入 $z = i\\alpha = i\\omega\\Delta t$：\n$R_{\\text{RK2}}(i\\alpha) = 1 + (i\\alpha) + \\frac{(i\\alpha)^2}{2} = 1 + i\\alpha - \\frac{\\alpha^2}{2}$。\n为了求出每步相位误差，我们计算这个复数的辐角。设 $R_{\\text{RK2}}(i\\alpha) = X_{\\text{RK2}} + iY_{\\text{RK2}}$，其中 $X_{\\text{RK2}} = 1 - \\frac{\\alpha^2}{2}$ 且 $Y_{\\text{RK2}} = \\alpha$。\n相位为 $\\arg(R_{\\text{RK2}}(i\\alpha)) = \\arctan\\left(\\frac{Y_{\\text{RK2}}}{X_{\\text{RK2}}}\\right) = \\arctan\\left(\\frac{\\alpha}{1 - \\alpha^2/2}\\right)$。\n对于小 $\\alpha$，我们使用 $\\arctan(x) \\approx x - x^3/3 + \\dots$ 和 $(1-y)^{-1} \\approx 1+y+y^2+\\dots$ 的泰勒级数展开。\narctan 的自变量为 $\\frac{\\alpha}{1-\\alpha^2/2} = \\alpha \\left(1 - \\frac{\\alpha^2}{2}\\right)^{-1} \\approx \\alpha \\left(1 + \\frac{\\alpha^2}{2}\\right) = \\alpha + \\frac{\\alpha^3}{2}$。\n因此，$\\arg(R_{\\text{RK2}}(i\\alpha)) \\approx \\arctan\\left(\\alpha + \\frac{\\alpha^3}{2}\\right) \\approx \\left(\\alpha + \\frac{\\alpha^3}{2}\\right) - \\frac{1}{3}\\left(\\alpha + \\frac{\\alpha^3}{2}\\right)^3 + \\dots$\n$\\arg(R_{\\text{RK2}}(i\\alpha)) \\approx \\alpha + \\frac{\\alpha^3}{2} - \\frac{\\alpha^3}{3} + O(\\alpha^5) = \\alpha + \\frac{\\alpha^3}{6} + O(\\alpha^5)$。\nRK2 的每步相位误差，记为 $E_{\\phi, \\text{RK2}}$，是：\n$E_{\\phi, \\text{RK2}} = \\arg(R_{\\text{RK2}}(i\\alpha)) - \\alpha \\approx \\frac{\\alpha^3}{6}$。\n\n**2. 四阶龙格-库塔（经典）法 (RK4)**\n\n经典 RK4 法是一种四阶方法 ($p=4$)。其稳定函数是 $\\exp(z)$ 的直到四阶的泰勒级数：\n$R_{\\text{RK4}}(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$。\n代入 $z = i\\alpha$：\n$R_{\\text{RK4}}(i\\alpha) = 1 + (i\\alpha) + \\frac{(i\\alpha)^2}{2} + \\frac{(i\\alpha)^3}{6} + \\frac{(i\\alpha)^4}{24} = \\left(1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24}\\right) + i\\left(\\alpha - \\frac{\\alpha^3}{6}\\right)$。\n精确放大因子为 $\\exp(i\\alpha) = 1 + i\\alpha - \\frac{\\alpha^2}{2} - i\\frac{\\alpha^3}{6} + \\frac{\\alpha^4}{24} + i\\frac{\\alpha^5}{120} - \\dots$。\n数值放大因子和精确放大因子之差为：\n$R_{\\text{RK4}}(i\\alpha) - \\exp(i\\alpha) = -i\\frac{\\alpha^5}{120} + O(\\alpha^6)$。\n设 $R_{\\text{RK4}}(i\\alpha) = |R_{\\text{RK4}}|\\exp(i\\phi_{\\text{RK4}})$ 且 $\\exp(i\\alpha) = \\exp(i\\alpha)$。\n$\\frac{R_{\\text{RK4}}(i\\alpha)}{\\exp(i\\alpha)} = |R_{\\text{RK4}}|\\exp(i(\\phi_{\\text{RK4}}-\\alpha)) \\approx 1 - \\exp(-i\\alpha) \\frac{i\\alpha^5}{120}$。\n对于小 $\\alpha$，$\\exp(-i\\alpha) \\approx 1$。因此，$\\frac{R_{\\text{RK4}}(i\\alpha)}{\\exp(i\\alpha)} \\approx 1 - i\\frac{\\alpha^5}{120}$。\n对于一个复数 $1 - i\\epsilon$ 且 $\\epsilon$ 很小，其相位近似为 $-\\epsilon$。\n因此，RK4 的每步相位误差 $E_{\\phi, \\text{RK4}}$ 为：\n$E_{\\phi, \\text{RK4}} = \\arg(R_{\\text{RK4}}(i\\alpha)) - \\alpha \\approx -\\frac{\\alpha^5}{120}$。\n\n**3. 累积相位滞后与比率**\n\n问题陈述了我们在 $M$ 个完整周期内进行积分。精确解的单个周期是 $T_p = 2\\pi/\\omega$。\n每个周期的步数 $m$ 由 $m \\Delta t = T_p = 2\\pi/\\omega$ 定义。\n由于 $\\alpha = \\omega \\Delta t$，我们有 $\\Delta t = \\alpha/\\omega$。将此代入前一个方程，得到 $m (\\alpha/\\omega) = 2\\pi/\\omega$，简化为 $m\\alpha = 2\\pi$，或 $m = 2\\pi/\\alpha$。\n总步数为 $N = M m = M(2\\pi/\\alpha)$。\n\n累积相位滞后定义为总数值相位与总精确相位之差的绝对值，总精确相位为 $M \\cdot 2\\pi$。\n总数值相位是 $N \\arg(R(i\\alpha))$。总精确相位是 $N\\alpha = M(2\\pi/\\alpha)\\alpha = M \\cdot 2\\pi$。\n因此，累积相位滞后 $L$ 为 $L = |N \\arg(R(i\\alpha)) - M \\cdot 2\\pi| = |N \\arg(R(i\\alpha)) - N\\alpha| = N |\\arg(R(i\\alpha)) - \\alpha| = N |E_{\\phi}|$。\n\n对于 RK2，累积相位滞后为：\n$L_{\\text{RK2}} = N |E_{\\phi, \\text{RK2}}| \\approx \\left(\\frac{2\\pi M}{\\alpha}\\right) \\left|\\frac{\\alpha^3}{6}\\right| = \\frac{2\\pi M \\alpha^2}{6} = \\frac{\\pi M \\alpha^2}{3}$。\n\n对于 RK4，累积相位滞后为：\n$L_{\\text{RK4}} = N |E_{\\phi, \\text{RK4}}| \\approx \\left(\\frac{2\\pi M}{\\alpha}\\right) \\left|-\\frac{\\alpha^5}{120}\\right| = \\frac{2\\pi M \\alpha^4}{120} = \\frac{\\pi M \\alpha^4}{60}$。\n\n问题要求 RK2 与 RK4 的累积相位滞后量值的主阶比率。\n比率 $= \\frac{L_{\\text{RK2}}}{L_{\\text{RK4}}} = \\frac{\\pi M \\alpha^2 / 3}{\\pi M \\alpha^4 / 60} = \\frac{\\alpha^2}{3} \\cdot \\frac{60}{\\alpha^4} = \\frac{20}{\\alpha^2}$。\n\n最后，我们通过代入 $\\alpha = \\omega \\Delta t$ 来用 $\\omega$ 和 $\\Delta t$ 表示答案：\n比率 $= \\frac{20}{(\\omega \\Delta t)^2}$。",
            "answer": "$$\n\\boxed{\\frac{20}{(\\omega \\Delta t)^{2}}}\n$$"
        }
    ]
}