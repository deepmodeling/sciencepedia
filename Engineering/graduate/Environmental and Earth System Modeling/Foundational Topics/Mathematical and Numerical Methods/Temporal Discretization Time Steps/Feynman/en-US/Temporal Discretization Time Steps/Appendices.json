{
    "hands_on_practices": [
        {
            "introduction": "The family of Runge-Kutta methods forms the backbone of many time-stepping algorithms in Earth system models. While often used as a 'black box', a deeper understanding of their construction is essential for advanced modeling and methods development. This first practice  takes you under the hood, guiding you through the derivation of the classical fourth-order Runge-Kutta (RK4) scheme from its fundamental definition and connecting the abstract coefficients of a Butcher tableau to the concrete update formula that powers countless simulations.",
            "id": "3920940",
            "problem": "Consider a lumped reservoir component in an Earth system model whose prognostic quantity $u(t)$ (for example, a spatially averaged tracer concentration) satisfies an Ordinary Differential Equation (ODE) initial value problem $u'(t) = f(u(t), t)$, with $u(t_0) = u_0$, where $f$ is sufficiently smooth in both arguments. Let $h  0$ be a fixed time step and denote $t_n = t_0 + n h$ and $u_n \\approx u(t_n)$.\n\nStarting from the definition that a one-step method is constructed to approximate $u(t_{n+1})$ from $u(t_n)$ using evaluations of $f$ at appropriately shifted stage arguments $(u_n + \\text{increment}, t_n + \\text{shift})$, formulate an explicit $s$-stage Runge-Kutta (RK) method via its Butcher tableau whose coefficient matrix is strictly lower triangular. Use the requirement that the method, when applied to $u'(t) = f(u(t), t)$, matches the Taylor series of the exact solution $u(t_{n+1})$ through terms of order $h^4$ to identify a four-stage explicit Runge-Kutta method of fourth algebraic order.\n\nProvide the Butcher tableau for this four-stage method and, by explicitly constructing its stage evaluations, derive the one-step update formula for advancing $u_n$ to $u_{n+1}$ for the ODE $u' = f(u,t)$. Express the final update $u_{n+1}$ as a single closed-form analytic expression in terms of $u_n$, $t_n$, $h$, and nested evaluations of $f$ at the appropriate stage arguments, without introducing any intermediate symbols. No numerical rounding is required. Do not include units in your final expression.",
            "solution": "The problem statement is valid. It is a well-posed problem in the field of numerical analysis for ordinary differential equations, a topic central to environmental and earth system modeling. The problem is scientifically sound, objective, and contains all necessary information to derive the requested Runge-Kutta method.\n\nAn explicit $s$-stage Runge-Kutta (RK) method is a one-step numerical procedure for solving the initial value problem $u'(t) = f(u(t), t)$ with $u(t_0) = u_0$. The method approximates the solution at time $t_{n+1} = t_n + h$ using the value at $t_n$ as follows:\n$$u_{n+1} = u_n + h \\sum_{i=1}^{s} b_i k_i$$\nwhere the stage values $k_i$ are given by:\n$$k_i = f\\left(t_n + c_i h, u_n + h \\sum_{j=1}^{s} a_{ij} k_j\\right), \\quad i=1, \\dots, s$$\nAn RK method is explicit if the coefficient matrix $A = (a_{ij})$ is strictly lower triangular, meaning $a_{ij} = 0$ for $j \\geq i$. This ensures that the calculation of each stage $k_i$ depends only on the preceding stages $k_1, \\dots, k_{i-1}$, so they can be computed sequentially. For an explicit method, the stage equations become:\n$$k_i = f\\left(t_n + c_i h, u_n + h \\sum_{j=1}^{i-1} a_{ij} k_j\\right)$$\nFor such methods, it is conventional that $c_1 = 0$, which implies $k_1 = f(t_n, u_n)$. The coefficients of an RK method are compactly represented by a Butcher tableau:\n$$\n\\begin{array}{c|c}\n\\mathbf{c}  A \\\\\n\\hline\n \\mathbf{b}^T\n\\end{array}\n=\n\\begin{array}{c|cccc}\nc_1  a_{11}  a_{12}  \\dots  a_{1s} \\\\\nc_2  a_{21}  a_{22}  \\dots  a_{2s} \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\nc_s  a_{s1}  a_{s2}  \\dots  a_{ss} \\\\\n\\hline\n b_1  b_2  \\dots  b_s\n\\end{array}\n$$\nFor an explicit method, the matrix $A$ is strictly lower triangular. It is also a common simplifying assumption that $c_i = \\sum_{j=1}^{s} a_{ij} = \\sum_{j=1}^{i-1} a_{ij}$.\n\nThe order of accuracy of a method is determined by matching the Taylor series expansion of the numerical solution $u_{n+1}$ with that of the exact solution $u(t_{n+1})$ about the point $(t_n, u_n)$. The exact solution's Taylor expansion is:\n$$u(t_{n+1}) = u(t_n) + h u'(t_n) + \\frac{h^2}{2!} u''(t_n) + \\frac{h^3}{3!} u'''(t_n) + \\frac{h^4}{4!} u''''(t_n) + O(h^5)$$\nExpressing the derivatives of $u$ in terms of $f$ and its partial derivatives and comparing them to the expansion of the numerical scheme leads to a set of algebraic equations for the coefficients $a_{ij}$, $b_i$, and $c_i$. For a method to be of order $4$, these coefficients must satisfy $8$ conditions:\n1.  Order $1$: $\\sum_{i=1}^s b_i = 1$\n2.  Order $2$: $\\sum_{i=1}^s b_i c_i = \\frac{1}{2}$\n3.  Order $3$: $\\sum_{i=1}^s b_i c_i^2 = \\frac{1}{3}$\n4.  Order $3$: $\\sum_{i,j=1}^s b_i a_{ij} c_j = \\frac{1}{6}$\n5.  Order $4$: $\\sum_{i=1}^s b_i c_i^3 = \\frac{1}{4}$\n6.  Order $4$: $\\sum_{i,j=1}^s b_i c_i a_{ij} c_j = \\frac{1}{8}$\n7.  Order $4$: $\\sum_{i,j=1}^s b_i a_{ij} c_j^2 = \\frac{1}{12}$\n8.  Order $4$: $\\sum_{i,j,k=1}^s b_i a_{ij} a_{jk} c_k = \\frac{1}{24}$\n\nThe problem asks to identify a $4$-stage ($s=4$) explicit method of order $4$. A minimum of $4$ stages are required for an explicit method to achieve order $4$. There exists a family of such methods. The most widely known and used is the \"classical\" fourth-order Runge-Kutta method, which we will formulate. Its coefficients are a specific solution to the $8$ order conditions.\n\nThe Butcher tableau for the classical $4$-stage, $4^{th}$-order Runge-Kutta method is:\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\nThis tableau defines the coefficients:\n$c_1=0$, $c_2=\\frac{1}{2}$, $c_3=\\frac{1}{2}$, $c_4=1$.\n$b_1=\\frac{1}{6}$, $b_2=\\frac{1}{3}$, $b_3=\\frac{1}{3}$, $b_4=\\frac{1}{6}$.\n$A = \\begin{pmatrix} 0  0  0  0 \\\\ \\frac{1}{2}  0  0  0 \\\\ 0  \\frac{1}{2}  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$, which is strictly lower triangular, confirming the method is explicit.\n\nUsing this tableau, we construct the stage evaluations for the ODE $u' = f(u,t)$:\nThe first stage $k_1$ is evaluated at $(t_n, u_n)$:\n$$k_1 = f(t_n + c_1 h, u_n) = f(t_n, u_n)$$\nThe second stage $k_2$ uses $k_1$ to take a half-step:\n$$k_2 = f(t_n + c_2 h, u_n + h a_{21} k_1) = f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2} k_1\\right)$$\nThe third stage $k_3$ uses $k_2$ to take another half-step from the initial point:\n$$k_3 = f(t_n + c_3 h, u_n + h(a_{31} k_1 + a_{32} k_2)) = f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2} k_2\\right)$$\nThe fourth stage $k_4$ uses $k_3$ to take a full step:\n$$k_4 = f(t_n + c_4 h, u_n + h(a_{41} k_1 + a_{42} k_2 + a_{43} k_3)) = f(t_n + h, u_n + h k_3)$$\nFinally, the update for $u_{n+1}$ is a weighted average of these stage derivatives:\n$$u_{n+1} = u_n + h(b_1 k_1 + b_2 k_2 + b_3 k_3 + b_4 k_4) = u_n + \\frac{h}{6}(k_1 + 2 k_2 + 2 k_3 + k_4)$$\nThe problem requires expressing $u_{n+1}$ as a single expression without intermediate symbols like $k_i$. This is achieved by substituting the definitions of the stages into one another and then into the final update formula. The resulting expression, while cumbersome, represents the computational algorithm in its entirety. This expression is provided in the final answer.",
            "answer": "$$\n\\boxed{u_n + \\frac{h}{6}\\left( f(t_n, u_n) + 2f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right) + 2f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right)\\right) + f\\left(t_n + h, u_n + hf\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right)\\right)\\right) \\right)}\n$$"
        },
        {
            "introduction": "After implementing a numerical scheme, how can we be confident it is working correctly and achieving its theoretical accuracy? This question is central to the practice of verification in scientific computing. This exercise  introduces Richardson extrapolation, a powerful technique that uses results from systematic time step refinement to empirically determine the observed order of accuracy and estimate the true, error-free solution. Mastering this method provides you with a critical tool for debugging your code and building confidence in your model's results.",
            "id": "3920972",
            "problem": "Consider a prognostic quantity in an Earth system model, defined as the normalized, domain-integrated mass of a passive tracer at a fixed forecast time $T$, denoted by $u(T;\\Delta t)$, where $\\Delta t$ is the uniform time step used in the numerical integration of an ordinary differential equation (ODE). The model uses a consistent and stable time discretization scheme. Assume the global time discretization error admits an asymptotic expansion of the form $u(T;\\Delta t)=u^{\\star}(T)+C\\,(\\Delta t)^{p}+\\mathcal{O}((\\Delta t)^{p+1})$, where $u^{\\star}(T)$ is the $\\Delta t\\to 0$ limit (the time-continuous solution at time $T$), $C$ is a constant independent of $\\Delta t$, and $p0$ is the (unknown) observed order of accuracy with respect to the time step. You are given three numerical evaluations at the same $T$ obtained with three time step sizes: $u(T;\\Delta t)=0.983000$, $u\\!\\left(T;\\tfrac{\\Delta t}{2}\\right)=0.990000$, and $u\\!\\left(T;\\tfrac{\\Delta t}{4}\\right)=0.991750$. Using only the stated assumptions and these three evaluations, set up a Richardson extrapolation to eliminate the leading error term and thereby estimate both the $\\Delta t\\to 0$ limit $u^{\\star}(T)$ and the observed order $p$. Report your final answer as a two-entry row vector $\\begin{pmatrix}u^{\\star}(T)  p\\end{pmatrix}$, rounded to five significant figures. The quantity $u^{\\star}(T)$ is dimensionless; express your answer without units.",
            "solution": "The problem requires the estimation of the true solution $u^{\\star}(T)$ and the observed order of accuracy $p$ from three numerical evaluations of a quantity $u(T;\\Delta t)$ using successively halved time steps. The problem statement provides the asymptotic error expansion for the numerical solution:\n$$u(T;\\Delta t) = u^{\\star}(T) + C(\\Delta t)^{p} + \\mathcal{O}((\\Delta t)^{p+1})$$\nwhere $u^{\\star}(T)$ is the exact time-continuous solution, $C$ is a constant independent of the time step $\\Delta t$, and $p$ is the order of accuracy.\n\nWe are given three data points. For notational simplicity, let us define:\n$u_1 = u(T; \\Delta t) = 0.983000$\n$u_2 = u(T; \\frac{\\Delta t}{2}) = 0.990000$\n$u_3 = u(T; \\frac{\\Delta t}{4}) = 0.991750$\nLet $u^{\\star}$ denote $u^{\\star}(T)$.\n\nBy neglecting the higher-order terms $\\mathcal{O}((\\Delta t)^{p+1})$, we can establish a system of three approximate equations:\n$$u_1 \\approx u^{\\star} + C(\\Delta t)^{p} \\quad (1)$$\n$$u_2 \\approx u^{\\star} + C\\left(\\frac{\\Delta t}{2}\\right)^{p} = u^{\\star} + C(\\Delta t)^{p} 2^{-p} \\quad (2)$$\n$$u_3 \\approx u^{\\star} + C\\left(\\frac{\\Delta t}{4}\\right)^{p} = u^{\\star} + C(\\Delta t)^{p} 4^{-p} \\quad (3)$$\nOur goal is to solve this system for $p$ and $u^{\\star}$.\n\nFirst, we determine the order of accuracy, $p$. We can eliminate $u^{\\star}$ by taking the differences between consecutive approximations:\n$$u_2 - u_1 \\approx \\left(u^{\\star} + C(\\Delta t)^{p} 2^{-p}\\right) - \\left(u^{\\star} + C(\\Delta t)^{p}\\right) = C(\\Delta t)^{p} (2^{-p} - 1) \\quad (4)$$\n$$u_3 - u_2 \\approx \\left(u^{\\star} + C(\\Delta t)^{p} 4^{-p}\\right) - \\left(u^{\\star} + C(\\Delta t)^{p} 2^{-p}\\right) = C(\\Delta t)^{p} (4^{-p} - 2^{-p}) \\quad (5)$$\nNow, we can eliminate the term $C(\\Delta t)^{p}$ by taking the ratio of these differences. Let this ratio be $R$:\n$$R = \\frac{u_2 - u_1}{u_3 - u_2} \\approx \\frac{C(\\Delta t)^{p} (2^{-p} - 1)}{C(\\Delta t)^{p} (4^{-p} - 2^{-p})} = \\frac{2^{-p} - 1}{2^{-2p} - 2^{-p}}$$\nWe can factor out $2^{-p}$ from the denominator:\n$$R \\approx \\frac{2^{-p} - 1}{2^{-p}(2^{-p} - 1)}$$\nAssuming $p  0$, the term $(2^{-p}-1)$ is non-zero, so we can cancel it:\n$$R \\approx \\frac{1}{2^{-p}} = 2^{p}$$\nThis provides a direct way to estimate $p$. Let's substitute the given numerical values:\n$$u_2 - u_1 = 0.990000 - 0.983000 = 0.007000$$\n$$u_3 - u_2 = 0.991750 - 0.990000 = 0.001750$$\nThe ratio $R$ is:\n$$R = \\frac{0.007000}{0.001750} = \\frac{7000}{1750} = 4$$\nFrom the relation $R \\approx 2^p$, we have:\n$$2^p \\approx 4$$\nSolving for $p$ yields:\n$$p = \\log_2(4) = 2$$\nThe observed order of accuracy is $p=2$. This integer result suggests that the numerical scheme is indeed second-order accurate and the higher-order error terms are negligible at this level of resolution.\n\nNext, we estimate the exact solution $u^{\\star}$ using Richardson extrapolation. We can eliminate the leading error term using any two of the three equations. Let's use equations $(1)$ and $(2)$:\n$$u_1 \\approx u^{\\star} + C(\\Delta t)^{p}$$\n$$u_2 \\approx u^{\\star} + C(\\Delta t)^{p} 2^{-p}$$\nTo eliminate the error term $C(\\Delta t)^{p}$, we can multiply the second equation by $2^p$ and subtract the first equation from the result:\n$$2^p u_2 \\approx 2^p u^{\\star} + C(\\Delta t)^{p}$$\n$$(2^p u_2) - u_1 \\approx (2^p u^{\\star} + C(\\Delta t)^{p}) - (u^{\\star} + C(\\Delta t)^{p})$$\n$$2^p u_2 - u_1 \\approx 2^p u^{\\star} - u^{\\star}$$\n$$2^p u_2 - u_1 \\approx u^{\\star}(2^p - 1)$$\nSolving for $u^{\\star}$:\n$$u^{\\star} \\approx \\frac{2^p u_2 - u_1}{2^p - 1}$$\nThis is the Richardson extrapolation formula for a refinement factor of $2$. Now, we substitute $p=2$ and the given values for $u_1$ and $u_2$:\n$$u^{\\star} \\approx \\frac{2^2 u_2 - u_1}{2^2 - 1} = \\frac{4 u_2 - u_1}{3}$$\n$$u^{\\star} \\approx \\frac{4(0.990000) - 0.983000}{3} = \\frac{3.960000 - 0.983000}{3} = \\frac{2.977000}{3}$$\n$$u^{\\star} \\approx 0.992333...$$\nAs a consistency check, we can perform the same extrapolation using $u_2$ and $u_3$. The time steps are $\\frac{\\Delta t}{2}$ and $\\frac{\\Delta t}{4}$, so the refinement factor is still $2$. The formula becomes:\n$$u^{\\star} \\approx \\frac{2^p u_3 - u_2}{2^p - 1} = \\frac{4 u_3 - u_2}{3}$$\n$$u^{\\star} \\approx \\frac{4(0.991750) - 0.990000}{3} = \\frac{3.967000 - 0.990000}{3} = \\frac{2.977000}{3}$$\n$$u^{\\star} \\approx 0.992333...$$\nBoth calculations yield the identical result for $u^{\\star}$, which strengthens our confidence in the values of both $p$ and $u^{\\star}$.\n\nThe problem requires the final answer to be rounded to five significant figures.\nFor $u^{\\star}$, we have $0.992333...$, which rounds to $0.99233$.\nFor $p$, we have exactly $2$, which expressed to five significant figures is $2.0000$.\n\nThe final result is the two-entry row vector $\\begin{pmatrix}u^{\\star}(T)  p\\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.99233  2.0000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond formal accuracy, a robust numerical model must produce physically plausible results. For many environmental systems, such as those involving chemical reactions, this means that concentrations must remain non-negative and approach equilibrium monotonically. This practice  explores the crucial concept of numerical stiffness and how different time integrators behave when faced with such problems. You will derive a practical time step constraint required to prevent the non-physical oscillations that can arise, highlighting that the choice of method is often dictated by physical realism as much as by numerical accuracy.",
            "id": "3921025",
            "problem": "An environmental one-box model for a reactive atmospheric tracer with concentration $C(t)$ is governed by a first-order production-loss balance, in which the production is constant with rate $S$ and the loss is linear with rate constant $k0$. The evolution equation is\n$$\n\\frac{dC}{dt} = S - k\\,C.\n$$\nThis ordinary differential equation represents a canonical stiff subproblem that appears after spatial discretization of transport-reaction equations in Earth system models. Consider discrete time levels $t^{n}$ and $t^{n+1}=t^{n}+\\Delta t$ with time step $\\Delta t0$. Define the equilibrium concentration $C^{\\ast}$ and the deviation (error) $e^{n}=C^{n}-C^{\\ast}$, where $C^{n}$ approximates $C(t^{n})$. For the Backward Euler method and the Crank–Nicolson method, form the one-step update for the deviation $e^{n}$ under the assumption that the only active process in the time step is the linear reaction described above.\n\nUsing only fundamental definitions of these time integrators and the governing equation, derive for each method the scalar amplification factor $g$ defined by $e^{n+1}=g\\,e^{n}$. Interpret monotonicity as the requirement that the discrete trajectory approaches $C^{\\ast}$ without overshoot for any initial sign of $e^{0}$, i.e., that $e^{n}$ does not change sign in time. Based on this, determine the largest permissible time step $\\Delta t_{\\max}$, as a function of $k$, that guarantees a monotonic approach to $C^{\\ast}$ for the Crank–Nicolson method. Express your final answer as a closed-form symbolic expression in terms of $k$ only, and do not include units.",
            "solution": "The problem is first validated and found to be a well-posed, scientifically sound problem in the numerical analysis of ordinary differential equations.\n\nFirst, we determine the equilibrium concentration $C^{\\ast}$ of the tracer. The equilibrium state is characterized by a time-invariant concentration, meaning $\\frac{dC}{dt} = 0$. Substituting this condition into the governing equation:\n$$\n0 = S - k\\,C^{\\ast}\n$$\nSolving for $C^{\\ast}$ yields:\n$$\nC^{\\ast} = \\frac{S}{k}\n$$\nGiven that $S$ is a constant rate and $k0$, the equilibrium concentration $C^{\\ast}$ is a positive constant.\n\nNext, we reformulate the governing equation in terms of the deviation from equilibrium, $e(t) = C(t) - C^{\\ast}$. The time derivative of the concentration is $\\frac{dC}{dt} = \\frac{d}{dt}(e(t) + C^{\\ast}) = \\frac{de}{dt}$, since $C^{\\ast}$ is a constant. Substituting $C(t) = e(t) + C^{\\ast}$ into the original ordinary differential equation (ODE):\n$$\n\\frac{de}{dt} = S - k(e(t) + C^{\\ast})\n$$\n$$\n\\frac{de}{dt} = S - k\\,e(t) - k\\,C^{\\ast}\n$$\nUsing the expression for the equilibrium concentration, $k\\,C^{\\ast} = k \\left(\\frac{S}{k}\\right) = S$. The equation for the deviation simplifies to a homogeneous linear ODE:\n$$\n\\frac{de}{dt} = -k\\,e(t)\n$$\nWe will now discretize this equation for the deviation $e(t)$ using the specified numerical schemes, where $e^n$ is the numerical approximation of $e(t^n)$.\n\nFor the Backward Euler method, the time derivative is approximated at the future time level $t^{n+1}$:\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = -k\\,e^{n+1}\n$$\nTo find the one-step update, we solve for $e^{n+1}$:\n$$\ne^{n+1} - e^n = -k\\,\\Delta t\\,e^{n+1}\n$$\n$$\ne^{n+1} + k\\,\\Delta t\\,e^{n+1} = e^n\n$$\n$$\ne^{n+1}(1 + k\\,\\Delta t) = e^n\n$$\nThe update rule is thus $e^{n+1} = \\frac{1}{1 + k\\,\\Delta t} e^n$. The scalar amplification factor for the Backward Euler method, $g_{BE}$, is therefore:\n$$\ng_{BE} = \\frac{1}{1 + k\\,\\Delta t}\n$$\nSince $k0$ and $\\Delta t0$, we have $0  g_{BE}  1$. This implies that the Backward Euler method is always monotonic for this problem, regardless of the time step size.\n\nFor the Crank–Nicolson method, the right-hand side of the ODE is approximated as the average of its values at $t^n$ and $t^{n+1}$:\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = \\frac{1}{2}(-k\\,e^n - k\\,e^{n+1})\n$$\nWe solve for $e^{n+1}$ to find the update rule:\n$$\ne^{n+1} - e^n = -\\frac{k\\,\\Delta t}{2}(e^n + e^{n+1})\n$$\n$$\ne^{n+1} + \\frac{k\\,\\Delta t}{2}e^{n+1} = e^n - \\frac{k\\,\\Delta t}{2}e^n\n$$\n$$\ne^{n+1}\\left(1 + \\frac{k\\,\\Delta t}{2}\\right) = e^n\\left(1 - \\frac{k\\,\\Delta t}{2}\\right)\n$$\nThe update rule is $e^{n+1} = \\frac{1 - k\\,\\Delta t/2}{1 + k\\,\\Delta t/2} e^n$. The scalar amplification factor for the Crank–Nicolson method, $g_{CN}$, is:\n$$\ng_{CN} = \\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}}\n$$\nThe problem defines monotonicity as the requirement that the numerical solution approaches the equilibrium $C^{\\ast}$ without overshoot. This means that the sign of the deviation $e^n = C^n - C^{\\ast}$ must not change from one time step to the next. That is, for any $n$, $\\text{sign}(e^{n+1}) = \\text{sign}(e^n)$. Since $e^{n+1} = g_{CN}\\,e^n$, this condition is satisfied if and only if the amplification factor $g_{CN}$ is non-negative.\n$$\ng_{CN} \\ge 0\n$$\nSubstituting the expression for $g_{CN}$:\n$$\n\\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}} \\ge 0\n$$\nThe denominator, $1 + \\frac{k\\,\\Delta t}{2}$, is strictly positive because $k  0$ and $\\Delta t  0$. Therefore, the inequality holds if and only if the numerator is non-negative:\n$$\n1 - \\frac{k\\,\\Delta t}{2} \\ge 0\n$$\nNow, we solve for $\\Delta t$:\n$$\n1 \\ge \\frac{k\\,\\Delta t}{2}\n$$\nMultiplying by $2$ gives:\n$$\n2 \\ge k\\,\\Delta t\n$$\nSince $k  0$, we can divide by $k$ without reversing the inequality:\n$$\n\\Delta t \\le \\frac{2}{k}\n$$\nThis inequality provides the condition on the time step $\\Delta t$ to ensure a monotonic approach to equilibrium. The largest permissible time step, $\\Delta t_{\\max}$, is the maximum value of $\\Delta t$ that satisfies this condition.\n$$\n\\Delta t_{\\max} = \\frac{2}{k}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{k}}\n$$"
        }
    ]
}