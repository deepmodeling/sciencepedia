{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds our study in the core motivation for using implicit methods: stability in stiff systems. By applying the backward Euler method to a simple linear decay model, you will observe how an implicit scheme produces a stable result even with a large time step. This practice illuminates the fundamental trade-off between stability and accuracy when modeling processes with vastly different timescales .",
            "id": "3885112",
            "problem": "Consider a non-dimensional linear decay model for a tracer concentration in a one-box environmental system, idealized as the ordinary differential equation (ODE) $y'(t)=\\lambda\\,y(t)$ with initial condition $y(0)=y_{0}$. This ODE arises from the conservation of mass law with a linearized sink proportional to $y(t)$, where $\\lambda0$ represents a constant decay rate. Let $\\lambda=-1000$, $y_{0}=1$, and the time step be $\\Delta t=0.1$. Using an implicit time integration scheme derived from the integral form of the ODE over one time step, apply the backward Euler method to compute the one-step numerical approximation $y_{1}\\approx y(\\Delta t)$.\n\nSeparately, derive the exact solution $y(t)$ of the ODE by separation of variables and evaluate it at $t=\\Delta t$. Define the absolute one-step error as $E=\\left|y_{1}-y(\\Delta t)\\right|$. Report $E$ as a single number, rounded to four significant figures. Express the answer as a dimensionless quantity. The purpose of this calculation is to compare the backward Euler result to the exact solution in order to illustrate the tradeoff between absolute stability (A-stability) and accuracy for stiff problems in environmental and earth system modeling.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Ordinary Differential Equation (ODE): $y'(t)=\\lambda\\,y(t)$\n- Initial condition: $y(0)=y_{0}$\n- Decay rate constant: $\\lambda=-1000$\n- Initial value: $y_{0}=1$\n- Time step: $\\Delta t=0.1$\n- Numerical method: Backward Euler\n- Quantity to compute: One-step numerical approximation $y_{1}\\approx y(\\Delta t)$\n- Exact solution: $y(t)$ to be derived.\n- Error definition: Absolute one-step error $E=\\left|y_{1}-y(\\Delta t)\\right|$\n- Final output requirement: Report $E$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard initial value problem (IVP) for a first-order linear homogeneous ordinary differential equation, a fundamental model for exponential decay processes in science and engineering. The parameters provided ($\\lambda=-1000$, $\\Delta t=0.1$) define a numerically stiff problem, which is a common and meaningful scenario for testing and illustrating the properties of implicit time integration schemes like backward Euler. The problem is self-contained, with all necessary data provided. The language is precise and objective. There is no scientific or factual unsoundness, nor are there any contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Numerical Solution using Backward Euler Method\nThe given ODE is $y'(t) = \\lambda y(t)$. The backward Euler method is an implicit one-step numerical method for solving ODEs. For an ODE of the form $y'(t) = f(t,y)$, the general formula for advancing the solution from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ is:\n$$y_{n+1} = y_n + \\Delta t \\, f(t_{n+1}, y_{n+1})$$\nIn this problem, the function $f(t,y)$ is given by $f(t,y) = \\lambda y(t)$. Substituting this into the backward Euler formula gives:\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1})$$\nSince this is an implicit method, we must solve for the unknown $y_{n+1}$:\n$$y_{n+1} - \\lambda \\Delta t y_{n+1} = y_n$$\n$$y_{n+1} (1 - \\lambda \\Delta t) = y_n$$\n$$y_{n+1} = \\frac{y_n}{1 - \\lambda \\Delta t}$$\nWe are asked to compute the first step, $y_1$, starting from the initial condition $y_0$ at $t_0=0$. Setting $n=0$:\n$$y_1 = \\frac{y_0}{1 - \\lambda \\Delta t}$$\nThe problem provides the values $y_0=1$, $\\lambda=-1000$, and $\\Delta t=0.1$. Substituting these values into the equation for $y_1$:\n$$y_1 = \\frac{1}{1 - (-1000)(0.1)} = \\frac{1}{1 - (-100)} = \\frac{1}{1+100} = \\frac{1}{101}$$\n\n### Derivation of the Exact Solution\nThe ODE $y'(t) = \\lambda y(t)$ can be written as $\\frac{dy}{dt} = \\lambda y$. This is a separable differential equation. We can separate the variables $y$ and $t$:\n$$\\frac{dy}{y} = \\lambda \\, dt$$\nIntegrating both sides of the equation:\n$$\\int \\frac{1}{y} \\, dy = \\int \\lambda \\, dt$$\n$$\\ln|y| = \\lambda t + C$$\nwhere $C$ is the constant of integration. To solve for $y$, we exponentiate both sides:\n$$|y| = \\exp(\\lambda t + C) = \\exp(C) \\exp(\\lambda t)$$\nLetting $A = \\pm\\exp(C)$, we obtain the general solution:\n$$y(t) = A \\exp(\\lambda t)$$\nTo find the particular solution, we apply the initial condition $y(0)=y_0$:\n$$y(0) = A \\exp(\\lambda \\cdot 0) = A \\exp(0) = A \\cdot 1 = A$$\nThus, the integration constant is $A=y_0$. The exact solution to the IVP is:\n$$y(t) = y_0 \\exp(\\lambda t)$$\nSubstituting the given values $y_0=1$ and $\\lambda=-1000$:\n$$y(t) = 1 \\cdot \\exp(-1000t) = \\exp(-1000t)$$\nWe need to evaluate this exact solution at time $t=\\Delta t=0.1$:\n$$y(\\Delta t) = y(0.1) = \\exp(-1000 \\cdot 0.1) = \\exp(-100)$$\n\n### Calculation of the Absolute Error\nThe absolute one-step error $E$ is defined as $E = |y_1 - y(\\Delta t)|$. Substituting the numerical and exact values we found:\n$$E = \\left| \\frac{1}{101} - \\exp(-100) \\right|$$\nNow, we compute the numerical values.\n$y_1 = \\frac{1}{101} \\approx 0.009900990099...$\nThe value of $y(\\Delta t) = \\exp(-100)$ is an extremely small positive number. Using a calculator, $\\exp(-100) \\approx 3.72 \\times 10^{-44}$.\nThe error is:\n$$E \\approx |0.009900990099 - 3.72 \\times 10^{-44}|$$\nThe term $\\exp(-100)$ is many orders of magnitude smaller than $\\frac{1}{101}$ and its contribution to the error is negligible for the required precision. Therefore, the error is effectively equal to $y_1$:\n$$E \\approx \\frac{1}{101} \\approx 0.009900990099...$$\nThe problem asks for the result to be rounded to four significant figures.\nThe first non-zero digit of $E$ is the $9$ in the thousandths place. The first four significant figures are $9$, $9$, $0$, $0$. The fifth significant figure is $9$. Since $9 \\ge 5$, we round up the fourth significant figure.\nSo, the value $0.00990099...$ rounded to four significant figures is $0.009901$.",
            "answer": "$$\\boxed{0.009901}$$"
        },
        {
            "introduction": "Beyond numerical stability, a robust model must also respect physical laws, such as the non-negativity of concentrations. This exercise tackles the crucial property of positivity by analyzing a common source-sink box model. You will demonstrate that the fully implicit backward Euler scheme unconditionally preserves positivity, a key advantage for its widespread use in environmental simulation .",
            "id": "3885125",
            "problem": "Consider a zero-dimensional, well-mixed box model of a nonnegative tracer concentration $y(t)$ in environmental and earth system modeling, subject to a linear first-order sink with rate coefficient $\\alpha$ and a constant, nonnegative source $\\beta$. The governing ordinary differential equation (ODE) is $y'(t)=-\\alpha\\,y(t)+\\beta$, where $\\alpha\\ge 0$ and $\\beta\\ge 0$. The fundamental positivity property of the continuous system states that if $y(t_n)\\ge 0$, then solutions remain nonnegative for $t>t_n$. A practical time discretization used in stiff reaction systems is the fully implicit backward Euler scheme.\n\nStarting from basic principles, derive the backward Euler update for this ODE over a single step of size $\\Delta t\\ge 0$ from $t_n$ to $t_{n+1}=t_n+\\Delta t$. Using only the derived update and the assumptions $\\alpha\\ge 0$, $\\beta\\ge 0$, and $y_n\\ge 0$, analyze the positivity preservation of the discrete scheme. Determine the condition on the step size $\\Delta t$ and on the treatment of the reaction/source terms in the discretization that guarantees $y_{n+1}\\ge 0$ whenever $y_n\\ge 0$. Then, assuming $\\alpha>0$, compute the minimal attainable value of the backward Euler next-step prediction $y_{n+1}$ over all nonnegative $\\Delta t$, expressed as a closed-form function of $y_n$, $\\alpha$, and $\\beta$.\n\nYour final answer must be a single analytic expression for this minimal attainable value. No rounding is required. If you introduce any acronym, spell it out on first use. Do not use inequalities or equations in your final answer.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Problem Validation\n\nThe givens provided in the problem statement are:\n1.  **Governing Equation**: The Ordinary Differential Equation (ODE) for a nonnegative tracer concentration $y(t)$ is $y'(t)=-\\alpha\\,y(t)+\\beta$.\n2.  **Parameters**: The rate coefficient $\\alpha \\ge 0$ and the source term $\\beta \\ge 0$.\n3.  **Time Step**: The discretization is over a single step of size $\\Delta t \\ge 0$ from $t_n$ to $t_{n+1}=t_n+\\Delta t$.\n4.  **Initial Condition**: The concentration at the beginning of the step is nonnegative, $y_n = y(t_n) \\ge 0$.\n5.  **Discretization Method**: The fully implicit backward Euler scheme is to be used.\n6.  **Additional Condition for Final Part**: For computing the minimal value, it is assumed that $\\alpha  0$.\n\nThe problem is a standard exercise in the numerical analysis of ODEs, specifically focusing on the properties of implicit schemes. The model is a fundamental linear ODE representing many physical systems. All terms are clearly defined, and the constraints are consistent. The problem is scientifically sound, well-posed, objective, and contains all necessary information for its solution. Therefore, the problem is deemed valid.\n\n### Step 2: Derivation and Analysis\n\nThe problem can now be solved. We will proceed by first deriving the update formula, then analyzing its positivity, and finally determining the minimal attainable value of the next-step prediction.\n\n**Derivation of the Backward Euler Update**\n\nThe governing ODE is given by:\n$$\ny'(t) = -\\alpha y(t) + \\beta\n$$\nThe backward Euler method, an implicit first-order scheme, approximates the derivative $y'(t)$ at time $t_{n+1}$ using a finite difference, and evaluates the right-hand side of the ODE at the future time $t_{n+1}$ and unknown state $y_{n+1}$:\n$$\n\\frac{y_{n+1} - y_n}{\\Delta t} = -\\alpha y_{n+1} + \\beta\n$$\nHere, $y_n$ denotes the numerical approximation to $y(t_n)$ and $y_{n+1}$ denotes the approximation to $y(t_{n+1})$. To find the update rule, we must solve this equation for $y_{n+1}$:\n$$\ny_{n+1} - y_n = \\Delta t (-\\alpha y_{n+1} + \\beta)\n$$\n$$\ny_{n+1} - y_n = -\\alpha \\Delta t \\, y_{n+1} + \\beta \\Delta t\n$$\nRearranging the terms to group all $y_{n+1}$ on one side:\n$$\ny_{n+1} + \\alpha \\Delta t \\, y_{n+1} = y_n + \\beta \\Delta t\n$$\nFactoring out $y_{n+1}$:\n$$\ny_{n+1} (1 + \\alpha \\Delta t) = y_n + \\beta \\Delta t\n$$\nFinally, dividing by $(1 + \\alpha \\Delta t)$ yields the explicit expression for $y_{n+1}$:\n$$\ny_{n+1} = \\frac{y_n + \\beta \\Delta t}{1 + \\alpha \\Delta t}\n$$\nThis is the backward Euler update for the given ODE.\n\n**Positivity Preservation Analysis**\n\nWe need to determine the conditions under which $y_{n+1} \\ge 0$ whenever $y_n \\ge 0$. The problem provides the constraints $\\alpha \\ge 0$, $\\beta \\ge 0$, $\\Delta t \\ge 0$, and we assume $y_n \\ge 0$.\n\nLet's analyze the numerator and the denominator of the expression for $y_{n+1}$:\n1.  **Numerator**: $y_n + \\beta \\Delta t$. Since $y_n \\ge 0$, $\\beta \\ge 0$, and $\\Delta t \\ge 0$, the product $\\beta \\Delta t \\ge 0$. The sum of two non-negative numbers, $y_n$ and $\\beta \\Delta t$, must also be non-negative. Thus, the numerator is always greater than or equal to $0$.\n\n2.  **Denominator**: $1 + \\alpha \\Delta t$. Since $\\alpha \\ge 0$ and $\\Delta t \\ge 0$, the product $\\alpha \\Delta t \\ge 0$. Therefore, the denominator is always greater than or equal to $1$. It is strictly positive.\n\nSince $y_{n+1}$ is the ratio of a non-negative number to a strictly positive number, it must be non-negative, $y_{n+1} \\ge 0$. This holds for any choice of step size $\\Delta t \\ge 0$. Therefore, the backward Euler scheme is **unconditionally positive** for this ODE. The implicit treatment of the sink term $(-\\alpha y)$ is what guarantees this property, avoiding the step-size restrictions that would appear in an explicit scheme.\n\n**Minimal Attainable Value of $y_{n+1}$**\n\nWe are asked to find the minimal attainable value of $y_{n+1}$ over all possible non-negative step sizes $\\Delta t \\ge 0$, under the additional assumption that $\\alpha  0$. Let us define a function $g(\\Delta t)$ representing $y_{n+1}$ as a function of $\\Delta t$:\n$$\ng(\\Delta t) = \\frac{y_n + \\beta \\Delta t}{1 + \\alpha \\Delta t}\n$$\nThe domain of this function is $\\Delta t \\in [0, \\infty)$. To find the minimum value, we can analyze the monotonicity of $g(\\Delta t)$ by examining its derivative with respect to $\\Delta t$. Using the quotient rule for differentiation, $[f/h]' = (f'h - fh')/h^2$, we have:\n$$\ng'(\\Delta t) = \\frac{(\\beta)(1 + \\alpha \\Delta t) - (y_n + \\beta \\Delta t)(\\alpha)}{(1 + \\alpha \\Delta t)^2}\n$$\n$$\ng'(\\Delta t) = \\frac{\\beta + \\alpha \\beta \\Delta t - \\alpha y_n - \\alpha \\beta \\Delta t}{(1 + \\alpha \\Delta t)^2}\n$$\n$$\ng'(\\Delta t) = \\frac{\\beta - \\alpha y_n}{(1 + \\alpha \\Delta t)^2}\n$$\nThe denominator $(1 + \\alpha \\Delta t)^2$ is always positive for $\\Delta t \\ge 0$ and $\\alpha  0$. Thus, the sign of the derivative $g'(\\Delta t)$ is determined solely by the sign of the constant numerator, $\\beta - \\alpha y_n$. The term $\\beta/\\alpha$ represents the steady-state solution of the continuous ODE, where $y' = 0$.\n\nWe consider three cases based on the relationship between the initial value $y_n$ and the steady-state value $\\beta/\\alpha$:\n\n*   **Case 1: $y_n  \\beta/\\alpha$**. This implies $\\alpha y_n  \\beta$, so $\\beta - \\alpha y_n  0$. In this case, $g'(\\Delta t)  0$ for all $\\Delta t \\ge 0$. The function $g(\\Delta t)$ is monotonically increasing. The minimum value must occur at the left endpoint of the domain, i.e., at $\\Delta t = 0$.\n    $$\n    g(0) = \\frac{y_n + \\beta(0)}{1 + \\alpha(0)} = y_n\n    $$\n    The minimal value is $y_n$.\n\n*   **Case 2: $y_n  \\beta/\\alpha$**. This implies $\\alpha y_n  \\beta$, so $\\beta - \\alpha y_n  0$. In this case, $g'(\\Delta t)  0$ for all $\\Delta t \\ge 0$. The function $g(\\Delta t)$ is monotonically decreasing. The minimum value is the infimum, which is approached as $\\Delta t \\to \\infty$.\n    $$\n    \\lim_{\\Delta t \\to \\infty} g(\\Delta t) = \\lim_{\\Delta t \\to \\infty} \\frac{y_n + \\beta \\Delta t}{1 + \\alpha \\Delta t} = \\lim_{\\Delta t \\to \\infty} \\frac{y_n/\\Delta t + \\beta}{1/\\Delta t + \\alpha} = \\frac{\\beta}{\\alpha}\n    $$\n    The minimal value is $\\beta/\\alpha$.\n\n*   **Case 3: $y_n = \\beta/\\alpha$**. This implies $\\alpha y_n = \\beta$, so $\\beta - \\alpha y_n = 0$. In this case, $g'(\\Delta t) = 0$ for all $\\Delta t \\ge 0$. The function $g(\\Delta t)$ is constant. Its value is $g(\\Delta t) = y_n = \\beta/\\alpha$ for all $\\Delta t$. The minimal value is thus $y_n$ (or $\\beta/\\alpha$).\n\nCombining these three cases, the minimal attainable value of $y_{n+1}$ is $y_n$ if $y_n \\le \\beta/\\alpha$, and $\\beta/\\alpha$ if $y_n  \\beta/\\alpha$. This can be expressed compactly using the minimum function.\n\nThe minimal value is $\\min(y_n, \\frac{\\beta}{\\alpha})$. This result has a clear physical interpretation: the numerical solution for $y_{n+1}$ is always bounded below by the smaller of the initial state and the system's steady state.",
            "answer": "$$\n\\boxed{\\min\\left(y_n, \\frac{\\beta}{\\alpha}\\right)}\n$$"
        },
        {
            "introduction": "We now advance from simple box models described by ordinary differential equations (ODEs) to the spatially distributed systems governed by partial differential equations (PDEs). This practice involves discretizing a one-dimensional reactive transport equation using a higher-order implicit method, the Backward Differentiation Formula of order two (BDF2). You will derive the structure of the resulting linear algebraic system, gaining essential insight into how implicit methods are implemented for complex, large-scale simulation tasks .",
            "id": "3885126",
            "problem": "Consider one-dimensional ($1$D) saturated groundwater transport of a reactive solute in a homogeneous medium over the spatial domain $[0,L]$ and time interval $[0,T]$. The concentration field $c(x,t)$ satisfies the linear diffusionâ€“reaction partial differential equation (PDE)\n$$\nS\\,\\frac{\\partial c}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(K\\,\\frac{\\partial c}{\\partial x}\\right) \\;-\\; \\lambda\\,c \\;+\\; q(x,t),\n$$\nwhere $S>0$ is the storage coefficient, $K>0$ is the hydraulic diffusivity (assumed spatially constant), $\\lambda\\ge 0$ is the first-order reaction rate, and $q(x,t)$ is a known source term. Impose Dirichlet boundary conditions $c(0,t)=c_{L}(t)$ and $c(L,t)=c_{R}(t)$ for $t\\in(0,T]$, and an initial condition $c(x,0)=c_{0}(x)$ for $x\\in[0,L]$.\n\nDiscretize the spatial domain with a uniform grid having $N$ interior points at locations $x_{i}=i\\,\\Delta x$ for $i=1,\\dots,N$, where $\\Delta x=L/(N+1)$, and uniform time levels $t^{n}=n\\,\\Delta t$ for $n=0,1,2,\\dots$ with time step $\\Delta t>0$. Let $c_{i}^{n}$ denote the approximation to $c(x_{i},t^{n})$ and $q_{i}^{n}$ denote $q(x_{i},t^{n})$.\n\nUsing second-order central differences in space and the fully implicit Backward Differentiation Formula of order two (BDF2) in time evaluated at $t^{n+1}$, perform the following:\n\n- Derive the discrete equation at an interior grid point $x_{i}$ (with $i\\in\\{2,\\dots,N-1\\}$) at time level $t^{n+1}$ that results from applying the spatial discretization to the diffusion operator and the BDF2 temporal discretization to the time derivative, while treating both diffusion and reaction terms implicitly at $t^{n+1}$ and the source as $q_{i}^{n+1}$.\n- Assemble the resulting linear system at each time step in the form $\\mathbf{A}\\,\\mathbf{c}^{n+1}=\\mathbf{b}^{n+1}$, where $\\mathbf{A}\\in\\mathbb{R}^{N\\times N}$ is the system matrix, $\\mathbf{c}^{n+1}\\in\\mathbb{R}^{N}$ contains the unknown interior values $c_{i}^{n+1}$, and $\\mathbf{b}^{n+1}\\in\\mathbb{R}^{N}$ is the right-hand side. Identify explicitly the values of the sub-diagonal, diagonal, and super-diagonal entries of $\\mathbf{A}$ for the interior rows, and state how boundary conditions modify the first and last rows and the right-hand side.\n- In terms of the number of interior grid points $N$, determine the exact number of nonzero entries in the matrix $\\mathbf{A}$ produced by this discretization with Dirichlet boundary conditions at both ends.\n\nYour final answer should be the exact symbolic expression in $N$ for the number of nonzero entries in $\\mathbf{A}$. Do not include any units. Do not round.",
            "solution": "The user-provided problem is first subjected to a validation check.\n\n### Step 1: Extract Givens\n- **Partial Differential Equation (PDE):** $S\\,\\frac{\\partial c}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(K\\,\\frac{\\partial c}{\\partial x}\\right) \\;-\\; \\lambda\\,c \\;+\\; q(x,t)$\n- **Parameters:** Storage coefficient $S>0$, hydraulic diffusivity $K>0$ (spatially constant), reaction rate $\\lambda\\ge 0$.\n- **Source Term:** $q(x,t)$.\n- **Domain:** Spatial domain $x \\in [0,L]$, time interval $t \\in [0,T]$.\n- **Boundary Conditions (BCs):** Dirichlet conditions $c(0,t)=c_{L}(t)$ and $c(L,t)=c_{R}(t)$ for $t\\in(0,T]$.\n- **Initial Condition (IC):** $c(x,0)=c_{0}(x)$ for $x\\in[0,L]$.\n- **Spatial Discretization:** Uniform grid with $N$ interior points $x_{i}=i\\,\\Delta x$ for $i=1,\\dots,N$, where the grid spacing is $\\Delta x=L/(N+1)$.\n- **Temporal Discretization:** Uniform time levels $t^{n}=n\\,\\Delta t$ for $n=0,1,2,\\dots$ with time step $\\Delta t>0$.\n- **Notation:** $c_{i}^{n} \\approx c(x_{i},t^{n})$ and $q_{i}^{n} = q(x_{i},t^{n})$.\n- **Numerical Method:** Second-order central differences in space; Backward Differentiation Formula of order two (BDF2) in time, evaluated at $t^{n+1}$. Diffusion and reaction terms are treated implicitly at $t^{n+1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem describes a linear reaction-diffusion process, a fundamental and well-established model in many STEM fields, including hydrogeology and environmental engineering. The governing equation is a standard PDE, and all parameters ($S, K, \\lambda$) have clear physical interpretations. This criterion is met.\n- **Well-Posed:** The problem is well-posed. It provides a valid PDE with well-defined initial and boundary conditions. The task is to derive a specific numerical discretization, which is a standard procedure in computational science and leads to a unique linear system at each time step. This criterion is met.\n- **Objective:** The problem is stated using precise, objective mathematical language. All terms and requirements are defined unambiguously. This criterion is met.\n\nThe problem is free from any of the invalidity flags: it is scientifically sound, formalizable, complete, realistic, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe governing PDE, with constant hydraulic diffusivity $K$, is:\n$$\nS\\,\\frac{\\partial c}{\\partial t} \\;=\\; K\\,\\frac{\\partial^2 c}{\\partial x^2} \\;-\\; \\lambda\\,c \\;+\\; q(x,t)\n$$\nThe task is to discretize this equation at a grid point $(x_{i}, t^{n+1})$ using the specified numerical schemes.\n\n**1. Derivation of the Discrete Equation**\n\nFirst, we apply the prescribed discretization schemes to each term in the PDE.\n\nThe time derivative term $\\frac{\\partial c}{\\partial t}$ at time $t^{n+1}$ is approximated using the second-order Backward Differentiation Formula (BDF2):\n$$\n\\frac{\\partial c}{\\partial t}\\Big|_{t^{n+1}} \\;\\approx\\; \\frac{3c^{n+1} - 4c^n + c^{n-1}}{2\\Delta t}\n$$\nApplying this to the concentration at grid point $x_i$, we have:\n$$\nS\\,\\frac{\\partial c}{\\partial t}\\Big|_{x_i, t^{n+1}} \\;\\approx\\; S \\left( \\frac{3c_{i}^{n+1} - 4c_{i}^n + c_{i}^{n-1}}{2\\Delta t} \\right)\n$$\n\nThe diffusion term $\\frac{\\partial^2 c}{\\partial x^2}$ is approximated at grid point $x_i$ using a second-order central difference scheme. As per the instructions, this term is treated implicitly, meaning it is evaluated at time level $t^{n+1}$:\n$$\nK\\,\\frac{\\partial^2 c}{\\partial x^2}\\Big|_{x_i, t^{n+1}} \\;\\approx\\; K \\left( \\frac{c_{i-1}^{n+1} - 2c_{i}^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\nThe reaction term $-\\lambda c$ is also treated implicitly at $t^{n+1}$, so it is simply $-\\lambda c_i^{n+1}$. The source term is given as $q(x_i, t^{n+1}) = q_i^{n+1}$.\n\nSubstituting these discrete approximations into the PDE yields the fully discrete equation at point $(x_i,t^{n+1})$:\n$$\nS \\left( \\frac{3c_{i}^{n+1} - 4c_{i}^n + c_{i}^{n-1}}{2\\Delta t} \\right) \\;=\\; K \\left( \\frac{c_{i-1}^{n+1} - 2c_{i}^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2} \\right) - \\lambda c_{i}^{n+1} + q_{i}^{n+1}\n$$\nThis equation is valid for interior grid points $i=2,\\dots,N-1$. To form the linear system $\\mathbf{A}\\,\\mathbf{c}^{n+1}=\\mathbf{b}^{n+1}$, we rearrange the equation by moving all terms involving the unknown concentrations at time $t^{n+1}$ (i.e., $c_j^{n+1}$) to the left-hand side (LHS) and all known terms (at times $t^n$, $t^{n-1}$, and the source term) to the right-hand side (RHS).\n$$\n\\frac{3S}{2\\Delta t}c_{i}^{n+1} - \\frac{K}{(\\Delta x)^2}c_{i-1}^{n+1} + \\frac{2K}{(\\Delta x)^2}c_{i}^{n+1} - \\frac{K}{(\\Delta x)^2}c_{i+1}^{n+1} + \\lambda c_{i}^{n+1} \\;=\\; S \\left( \\frac{4c_{i}^n - c_{i}^{n-1}}{2\\Delta t} \\right) + q_{i}^{n+1}\n$$\nGrouping the terms on the LHS by the unknown grid concentrations $c_{j}^{n+1}$:\n$$\n\\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{i-1}^{n+1} + \\left(\\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda \\right) c_{i}^{n+1} + \\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{i+1}^{n+1} \\;=\\; S \\left( \\frac{4c_{i}^n - c_{i}^{n-1}}{2\\Delta t} \\right) + q_{i}^{n+1}\n$$\nThis is the discrete equation for an interior grid point $x_i$, where $i \\in \\{2, \\dots, N-1\\}$.\n\n**2. Assembly of the Linear System $\\mathbf{A}\\,\\mathbf{c}^{n+1}=\\mathbf{b}^{n+1}$**\n\nThe vector of unknowns is $\\mathbf{c}^{n+1} = [c_1^{n+1}, c_2^{n+1}, \\dots, c_N^{n+1}]^T \\in\\mathbb{R}^{N}$. The system matrix $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ and the right-hand side vector $\\mathbf{b}^{n+1} \\in \\mathbb{R}^{N}$ are constructed row by row.\n\nFor an interior row $i$ (where $i \\in \\{2, \\dots, N-1\\}$), the entries of $\\mathbf{A}$ are directly obtained from the derived equation:\n- **Sub-diagonal:** $A_{i,i-1} = -\\frac{K}{(\\Delta x)^2}$\n- **Diagonal:** $A_{i,i} = \\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda$\n- **Super-diagonal:** $A_{i,i+1} = -\\frac{K}{(\\Delta x)^2}$\n\nThe corresponding entry in the right-hand side vector is:\n- $b_i^{n+1} = S \\left( \\frac{4c_{i}^n - c_{i}^{n-1}}{2\\Delta t} \\right) + q_{i}^{n+1}$\n\nNow, we consider the boundary conditions and how they modify the first and last rows of the system.\n\n**First row ($i=1$):**\nThe discrete equation for $i=1$ is:\n$$\n\\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{0}^{n+1} + \\left(\\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda \\right) c_{1}^{n+1} + \\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{2}^{n+1} \\;=\\; S \\left( \\frac{4c_{1}^n - c_{1}^{n-1}}{2\\Delta t} \\right) + q_{1}^{n+1}\n$$\nThe term $c_0^{n+1}$ corresponds to the concentration at the boundary $x_0 = 0$. From the Dirichlet boundary condition, we know $c_0^{n+1} = c(0, t^{n+1}) = c_L(t^{n+1})$. This is a known value. The term involving $c_0^{n+1}$ is moved to the RHS.\nThe first row of the matrix equation $\\mathbf{A}\\,\\mathbf{c}^{n+1}=\\mathbf{b}^{n+1}$ becomes:\n$\\left(A_{1,1}\\right) c_1^{n+1} + (A_{1,2}) c_2^{n+1} = b_1^{n+1}$, where:\n- $A_{1,1} = \\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda$\n- $A_{1,2} = -\\frac{K}{(\\Delta x)^2}$\n- $b_1^{n+1} = S \\left( \\frac{4c_1^n - c_1^{n-1}}{2\\Delta t} \\right) + q_1^{n+1} + \\frac{K}{(\\Delta x)^2}c_L(t^{n+1})$\n\n**Last row ($i=N$):**\nThe discrete equation for $i=N$ is:\n$$\n\\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{N-1}^{n+1} + \\left(\\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda \\right) c_{N}^{n+1} + \\left(-\\frac{K}{(\\Delta x)^2}\\right) c_{N+1}^{n+1} \\;=\\; S \\left( \\frac{4c_{N}^n - c_{N}^{n-1}}{2\\Delta t} \\right) + q_{N}^{n+1}\n$$\nThe term $c_{N+1}^{n+1}$ corresponds to the concentration at the boundary $x_{N+1} = (N+1)\\Delta x = L$. From the Dirichlet boundary condition, we know $c_{N+1}^{n+1} = c(L, t^{n+1}) = c_R(t^{n+1})$. This is a known value, and the term is moved to the RHS.\nThe last row of the matrix equation becomes:\n$(A_{N,N-1}) c_{N-1}^{n+1} + (A_{N,N}) c_N^{n+1} = b_N^{n+1}$, where:\n- $A_{N,N-1} = -\\frac{K}{(\\Delta x)^2}$\n- $A_{N,N} = \\frac{3S}{2\\Delta t} + \\frac{2K}{(\\Delta x)^2} + \\lambda$\n- $b_N^{n+1} = S \\left( \\frac{4c_N^n - c_N^{n-1}}{2\\Delta t} \\right) + q_N^{n+1} + \\frac{K}{(\\Delta x)^2}c_R(t^{n+1})$\n\nThe resulting matrix $\\mathbf{A}$ is a symmetric $N \\times N$ tridiagonal matrix.\n\n**3. Number of Nonzero Entries in $\\mathbf{A}$**\n\nThe matrix $\\mathbf{A}$ has nonzero entries only on its main diagonal, sub-diagonal, and super-diagonal. We can count the number of nonzero entries by examining the structure row by row. We assume $N \\ge 1$.\n- The first row ($i=1$) has two nonzero entries: $A_{1,1}$ and $A_{1,2}$.\n- Each interior row $i \\in \\{2, \\dots, N-1\\}$ has three nonzero entries: $A_{i,i-1}$, $A_{i,i}$, and $A_{i,i+1}$. There are $N-2$ such rows (this count is zero if $N2$).\n- The last row ($i=N$) has two nonzero entries: $A_{N,N-1}$ and $A_{N,N}$.\n\nLet's consider two cases for the total number of nonzero entries.\nCase 1: $N=1$. The matrix is $1 \\times 1$. The first row is also the last row. The equation involves boundary data from both sides, but there is only one unknown, $c_1^{n+1}$. The matrix $\\mathbf{A}$ has only one entry, $A_{1,1}$. The number of nonzero entries is $1$.\n\nCase 2: $N \\ge 2$. We can sum the counts from each row type:\n- Number from the first row: $2$\n- Number from the last row: $2$\n- Number from the $N-2$ interior rows: $3 \\times (N-2)$\nTotal nonzero entries = $2 + 2 + 3(N-2) = 4 + 3N - 6 = 3N - 2$.\n\nWe can verify that this formula also works for the $N=1$ case: $3(1) - 2 = 1$. Thus, for any $N \\ge 1$, the total number of nonzero entries is $3N-2$.\n\nAlternatively, for any $N \\times N$ tridiagonal matrix:\n- The main diagonal has $N$ entries.\n- The sub-diagonal has $N-1$ entries.\n- The super-diagonal has $N-1$ entries.\nSince all these entries are nonzero in our case (as $K>0$), the total number is $N + (N-1) + (N-1) = 3N - 2$.",
            "answer": "$$\\boxed{3N-2}$$"
        }
    ]
}