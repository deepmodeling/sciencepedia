{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the CFL condition, it is illuminating to examine the special case where a numerical scheme perfectly captures the physical process. This exercise investigates the first-order upwind scheme for the linear advection equation when the Courant number is exactly one. By analyzing this scenario, you will uncover the profound connection between the numerical grid speed, $\\frac{\\Delta x}{\\Delta t}$, and the physical characteristic speed of the underlying partial differential equation .",
            "id": "2139538",
            "problem": "Consider the one-dimensional linear advection equation, which models the transport of a quantity $u$ at a constant speed. The equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the transported quantity at position $x$ and time $t$, and $c$ is a constant positive advection speed ($c > 0$). The equation is solved over the spatial domain $x \\in (-\\infty, \\infty)$ for time $t \\ge 0$.\n\nThe initial condition at $t=0$ is a well-defined, localized pulse, $u(x, 0) = f(x)$, which is non-zero only on a finite interval.\n\nTo solve this equation numerically, a computational grid is established with uniform spatial spacing $\\Delta x$ and uniform time steps $\\Delta t$. The grid points are denoted by $x_j = j \\Delta x$ and $t_n = n \\Delta t$, where $j$ is an integer and $n$ is a non-negative integer. Let $U_j^n$ represent the numerical approximation of $u(x_j, t_n)$.\n\nThe first-order upwind finite difference scheme is used for the numerical solution. Given the positive advection speed $c>0$, the scheme is defined by discretizing the time derivative with a forward difference and the spatial derivative with a backward difference:\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\nThe grid spacing $\\Delta x$ and time step $\\Delta t$ are specifically chosen such that the Courant number, defined as $\\sigma = \\frac{c \\Delta t}{\\Delta x}$, is exactly equal to 1.\n\nAfter evolving the system for $N$ time steps, where $N$ is a positive integer, which of the following statements best describes the numerical solution profile, $\\{U_j^N\\}_{j \\in \\mathbb{Z}}$, in relation to the initial discrete profile, $\\{U_j^0\\}_{j \\in \\mathbb{Z}}$?\n\nA. The numerical solution is identical to the exact analytical solution at the grid points, representing a perfect, shape-preserving translation of the initial profile.\n\nB. The peak value of the pulse has decreased, and its base has widened, indicating the presence of numerical diffusion.\n\nC. Spurious oscillations have appeared in the numerical solution, particularly near regions of high gradient in the initial pulse.\n\nD. The magnitude of the numerical solution has grown without bound, indicating a numerical instability.\n\nE. The pulse has become asymmetric, with one side becoming steeper than the other.\n\nF. The pulse has remained centered at its initial position but its amplitude has decayed over time.",
            "solution": "The continuous problem is the linear advection equation with constant positive speed $c>0$,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\nwith initial condition $u(x,0)=f(x)$ that is compactly supported. By the method of characteristics, along curves satisfying $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=c$, the solution is constant. Therefore the exact solution is\n$$\nu(x,t) = f(x - c t).\n$$\n\nOn a uniform grid with $x_j=j \\Delta x$, $t_n=n \\Delta t$, the first-order upwind scheme for $c>0$ is\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0.\n$$\nIntroducing the Courant number $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ and rearranging gives\n$$\nU_j^{n+1} = U_j^n - \\sigma \\left(U_j^n - U_{j-1}^n\\right) = (1-\\sigma) U_j^n + \\sigma U_{j-1}^n.\n$$\nWith the specific choice $\\sigma=1$, this update reduces to the pure shift operator\n$$\nU_j^{n+1} = U_{j-1}^n.\n$$\nIterating this identity for $N$ time steps yields\n$$\nU_j^{N} = U_{j-1}^{N-1} = \\cdots = U_{j-N}^{0}.\n$$\nThus the discrete profile is translated exactly by $N$ grid cells to the right without any change of shape or amplitude.\n\nTo compare with the exact solution at grid points at time $t_N = N \\Delta t$, evaluate\n$$\nu(x_j, t_N) = f(x_j - c t_N) = f\\big(j \\Delta x - c N \\Delta t\\big).\n$$\nSince $\\sigma= \\frac{c \\Delta t}{\\Delta x} = 1$, we have $c N \\Delta t = N \\Delta x$, hence\n$$\nu(x_j, t_N) = f\\big((j-N)\\Delta x\\big) = f(x_{j-N}).\n$$\nBy the definition of the initial discrete data, $U_{j-N}^{0} = f(x_{j-N})$, so\n$$\nU_j^{N} = U_{j-N}^{0} = u(x_j, t_N).\n$$\nTherefore, at the grid points, the numerical solution coincides exactly with the analytical solution and represents a perfect, shape-preserving translation of the initial profile by $N$ cells to the right. None of the effects described by numerical diffusion, spurious oscillations, instability, asymmetry, or stationary decay occur in this case.\n\nThe correct choice is A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Real-world environmental systems are inherently nonlinear, meaning their characteristic speeds can vary in space and time. This practice problem extends the CFL concept to the realm of nonlinear PDEs using the inviscid Burgers' equation, a classic model for shock waves in fluid dynamics. You will learn the crucial practical skill of how to adapt the stability criterion when the characteristic speed is not a constant, but rather part of the evolving solution itself .",
            "id": "2139603",
            "problem": "A team of computational engineers is developing a simulation for a one-dimensional, non-viscous, compressible fluid flow within a long channel. The flow dynamics are modeled by the inviscid Burgers' equation, a fundamental nonlinear Partial Differential Equation (PDE):\n$$ u_t + u u_x = 0 $$\nwhere $u(x,t)$ is the fluid velocity at position $x$ and time $t$.\n\nThe team plans to solve this equation numerically using an explicit finite difference scheme on a uniform spatial grid with spacing $\\Delta x$. The stability of this scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. For the specific scheme used, this condition is given by:\n$$ \\frac{\\max_x |u(x, t)| \\Delta t}{\\Delta x} \\le 1 $$\nwhere $\\Delta t$ is the time step. This means that for each time step, $\\Delta t$ must be chosen small enough to satisfy the condition based on the maximum velocity magnitude present across the entire spatial domain at that instant.\n\nThe simulation is initialized at $t=0$ with the following velocity profile over the domain $x \\in [-L, L]$:\n$$ u(x, 0) = A \\sin\\left(\\frac{\\pi x}{L}\\right) + B $$\nThe parameters for the simulation are:\n- Channel half-length, $L = 5.00 \\text{ m}$\n- Velocity amplitude, $A = 2.00 \\text{ m/s}$\n- Velocity offset, $B = 0.500 \\text{ m/s}$\n- Spatial grid spacing, $\\Delta x = 0.100 \\text{ m}$\n\nCalculate the maximum stable time step, $\\Delta t_{max}$, that can be used for the very first step of the simulation (i.e., advancing from $t=0$ to $t=\\Delta t$). Express your answer in seconds, rounded to three significant figures.",
            "solution": "The numerical stability is governed by the Courant-Friedrichs-Lewy condition, which for this scheme is\n$$\n\\frac{\\max_{x}|u(x,t)|\\,\\Delta t}{\\Delta x}\\leq 1.\n$$\nFor the first time step at $t=0$, this gives\n$$\n\\Delta t_{\\max}=\\frac{\\Delta x}{\\max_{x}|u(x,0)|}.\n$$\nThe initial condition is\n$$\nu(x,0)=A\\sin\\!\\left(\\frac{\\pi x}{L}\\right)+B,\\quad x\\in[-L,L].\n$$\nLet $s=\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$, then $s\\in[-1,1]$ over $x\\in[-L,L]$. Define\n$$\ng(s)=|A s+B|,\\quad s\\in[-1,1].\n$$\nSince $g(s)$ is the absolute value of an affine function of $s$, it is convex, so its maximum over a closed interval is attained at the endpoints. Therefore,\n$$\n\\max_{x\\in[-L,L]}|u(x,0)|=\\max_{s\\in[-1,1]}|A s+B|=\\max\\big(|A+B|,\\;|B-A|\\big).\n$$\nSubstituting $A=2.00$ and $B=0.500$,\n$$\n|A+B|=2.50,\\qquad |B-A|=1.50,\n$$\nhence\n$$\n\\max_{x}|u(x,0)|=2.50.\n$$\nWith $\\Delta x=0.100$, the maximum stable time step is\n$$\n\\Delta t_{\\max}=\\frac{0.100}{2.50}=0.0400,\n$$\nrounded to three significant figures.",
            "answer": "$$\\boxed{0.0400}$$"
        },
        {
            "introduction": "This advanced practice provides an opportunity to move from pen-and-paper theory to direct computational verification. This coding exercise challenges you to build a simple numerical model and directly observe the consequences of both satisfying and violating the CFL condition for the linear advection equation. By tracking the amplification of specific wave modes, you will gain a tangible understanding of how numerical instability arises and why the CFL condition is an indispensable tool for model developers .",
            "id": "3922279",
            "problem": "Consider one-dimensional linear advection of a passive tracer in a periodic domain, modeled by the partial differential equation $\\,\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0\\,$, where $\\,\\phi(x,t)\\,$ is the tracer concentration, $\\,u\\,$ is a constant advection velocity, and the spatial domain is discretized into $\\,N\\,$ grid points with uniform spacing $\\,\\Delta x\\,$. The Courant-Friedrichs-Lewy (CFL) condition (CFL) is a stability requirement that constrains the relationship among the time step $\\,\\Delta t\\,$, grid spacing $\\,\\Delta x\\,$, and characteristic speed $\\,u\\,$ through the dimensionless number $\\,C = u\\,\\Delta t/\\Delta x\\,$.\n\nUsing forward Euler time stepping and first-order upwind differencing in space for $\\,u>0\\,$ with periodic boundary conditions, the fully discrete update at grid index $\\,i\\,$ and time level $\\,n\\,$ is\n$$\n\\phi_i^{n+1} = \\phi_i^n - C\\left(\\phi_i^n - \\phi_{i-1}^n\\right),\n$$\nwhere $\\,C = u\\,\\Delta t/\\Delta x\\,$ and periodicity implies $\\,\\phi_{-1}^n = \\phi_{N-1}^n\\,$.\n\nConstruct a numerical experiment that initializes the tracer to the highest resolvable wavenumber mode on the grid, namely $\\,\\phi_i^0 = (-1)^i\\,$ for all $\\,i \\in \\{0,1,\\dots,N-1\\}\\,$, and then advances the solution for a prescribed number of time steps using the above scheme. At each step, compute the scalar amplitude of that highest-wavenumber mode by projecting onto $\\,(-1)^i\\,$ via\n$$\nA^n = \\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_i^n\\,(-1)^i.\n$$\nDefine the per-step amplification factor as the geometric mean of the absolute ratios $\\,|A^{n+1}/A^n|\\,$ over the whole evolution:\n$$\n\\mathcal{G} = \\left(\\prod_{n=0}^{n_{\\text{steps}}-1} \\left|\\frac{A^{n+1}}{A^n}\\right|\\right)^{1/n_{\\text{steps}}}.\n$$\n\nYour program must:\n- Implement the above numerical scheme with periodic boundaries.\n- Initialize $\\,\\phi_i^0 = (-1)^i\\,$.\n- For each test case, compute and return the per-step amplification factor $\\,\\mathcal{G}\\,$ as a floating-point number rounded to six decimal places.\n\nUse physically consistent units: $\\,u\\,$ in $\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta x\\,$ in $\\,\\mathrm{m}\\,$, and $\\,\\Delta t\\,$ in $\\,\\mathrm{s}\\,$. Angles are to be understood in radians when referring to wavenumber-phase relationships. No percentages are involved.\n\nTest suite:\n- Case $\\,1\\,$ (growth beyond stability threshold): $\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 12\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. This yields $\\,C = 1.2\\,$.\n- Case $\\,2\\,$ (boundary of stability): $\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 10\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. This yields $\\,C = 1.0\\,$.\n- Case $\\,3\\,$ (stable with strong decay): $\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 3\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. This yields $\\,C = 0.3\\,$.\n- Case $\\,4\\,$ (stable with moderate decay): $\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 7.5\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. This yields $\\,C = 0.75\\,$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, for example $\\,\\texttt{[r_1,r_2,r_3,r_4]}\\,$, where each $\\,r_j\\,$ is the per-step amplification factor $\\,\\mathcal{G}\\,$ rounded to six decimal places.",
            "solution": "The problem statement has been validated and is deemed **valid**. It is scientifically grounded, well-posed, objective, and contains all necessary information to construct a unique, verifiable solution. The problem describes a standard numerical experiment in computational fluid dynamics to investigate the stability of the first-order upwind scheme for the linear advection equation.\n\n### 1. Theoretical Analysis: Amplification Factor\n\nThe problem investigates the stability of a numerical scheme by analyzing its effect on a single Fourier mode. The discrete update equation is given by\n$$\n\\phi_i^{n+1} = \\phi_i^n - C\\left(\\phi_i^n - \\phi_{i-1}^n\\right)\n$$\nwhere $C = u\\,\\Delta t/\\Delta x$ is the Courant number.\n\nTo determine the scheme's stability, we use von Neumann stability analysis. We consider a single Fourier mode of the form $\\phi_j^n = \\hat{\\phi}^n e^{i k x_j}$, where $k$ is the wavenumber, $x_j = j\\Delta x$ is the grid point location, and $\\hat{\\phi}^n$ is the complex amplitude at time level $n$. Substituting this into the discrete equation yields:\n$$\n\\hat{\\phi}^{n+1} e^{ikj\\Delta x} = \\hat{\\phi}^n e^{ikj\\Delta x} - C \\left( \\hat{\\phi}^n e^{ikj\\Delta x} - \\hat{\\phi}^n e^{ik(j-1)\\Delta x} \\right)\n$$\nThe amplification factor, $G(k)$, is the ratio of amplitudes in successive time steps, $G(k) = \\hat{\\phi}^{n+1} / \\hat{\\phi}^n$. Dividing the equation by $\\hat{\\phi}^n e^{ikj\\Delta x}$ gives:\n$$\nG(k) = 1 - C(1 - e^{-ik\\Delta x})\n$$\nThe problem specifies an initial condition $\\phi_i^0 = (-1)^i$. This particular mode corresponds to the highest resolvable wavenumber on the grid, often called the Nyquist frequency. It can be written as $\\phi_i^0 = e^{i\\pi i}$, which implies a non-dimensional wavenumber $k\\Delta x = \\pi$.\n\nSubstituting $k\\Delta x = \\pi$ into the amplification factor expression:\n$$\nG(k\\Delta x = \\pi) = 1 - C(1 - e^{-i\\pi}) = 1 - C(1 - (-1)) = 1 - 2C\n$$\nThis shows that for the specific mode $\\phi_i^n = A^n (-1)^i$, the amplitude at the next time step is given by $A^{n+1} = (1-2C) A^n$. The ratio of absolute amplitudes is therefore constant for every time step:\n$$\n\\left|\\frac{A^{n+1}}{A^n}\\right| = |1 - 2C|\n$$\nThe problem defines the per-step amplification factor $\\mathcal{G}$ as the geometric mean of these ratios over $n_{\\text{steps}}$:\n$$\n\\mathcal{G} = \\left(\\prod_{n=0}^{n_{\\text{steps}}-1} \\left|\\frac{A^{n+1}}{A^n}\\right|\\right)^{1/n_{\\text{steps}}}\n$$\nSince the ratio is the constant value $|1 - 2C|$, the geometric mean is simply that value:\n$$\n\\mathcal{G} = \\left( \\prod_{n=0}^{n_{\\text{steps}}-1} |1-2C| \\right)^{1/n_{\\text{steps}}} = \\left( (|1-2C|)^{n_{\\text{steps}}} \\right)^{1/n_{\\text{steps}}} = |1-2C|\n$$\nThe numerical experiment described in the problem should, therefore, yield a result for $\\mathcal{G}$ that is equal to $|1-2C|$ for each test case.\n\n### 2. Algorithmic Implementation\n\nThe numerical experiment is implemented by following the discrete equations and definitions provided.\n\n**Initialization**: For each test case, we are given the grid size $N$, grid spacing $\\Delta x$, velocity $u$, time step $\\Delta t$, and number of steps $n_{\\text{steps}}$. The Courant number $C = u\\,\\Delta t/\\Delta x$ is computed first. A one-dimensional array `phi` of size $N$ is initialized to represent the tracer concentration at time $t=0$, with values $\\phi_i^0 = (-1)^i$.\n\n**Time Evolution**: The solution is advanced in a loop for $n_{\\text{steps}}$. In each iteration, representing a step from time level $n$ to $n+1$:\n1.  The current state $\\phi^n$ is used to compute the next state $\\phi^{n+1}$. The update equation $\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)$ is applied to all grid points simultaneously. This is efficiently implemented using vector operations. The term $\\phi_{i-1}^n$ requires accessing the value from the neighboring grid point. For a periodic domain, $\\phi_{-1}^n = \\phi_{N-1}^n$. This periodic shift is handled elegantly by the `numpy.roll` function, which cyclically shifts the elements of the `phi` array.\n2.  The amplitude of the highest-wavenumber mode, $A^n$, is computed before the update, and $A^{n+1}$ is computed after the update. The formula $A^k = \\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_i^k (-1)^i$ is implemented as a dot product between the state vector `phi` and a pre-computed projection vector with elements $(-1)^i$, divided by $N$.\n3.  The absolute ratio $|A^{n+1}/A^n|$ is calculated and stored.\n\n**Final Calculation**: After the time-stepping loop completes, the per-step amplification factor $\\mathcal{G}$ is calculated as the geometric mean of all the stored ratios. This is computed as the product of the ratios raised to the power of $1/n_{\\text{steps}}$. Due to the exact nature of the relationship $A^{n+1}/A^n = 1-2C$ for this problem, each computed ratio will be identical (up to floating-point precision), and the geometric mean will equal this constant value.\n\nThis procedure directly implements the definitions from the problem statement and serves as a numerical verification of the analytical result derived above.\n\nThe test cases cover scenarios where the scheme is unstable ($C > 1$), marginally stable ($C=1$), and stable ($0 < C < 1$), demonstrating the behavior of the amplification factor in each regime.\n-   Case 1 ($C=1.2$): $\\mathcal{G} = |1 - 2.4| = 1.4$. Unstable growth.\n-   Case 2 ($C=1.0$): $\\mathcal{G} = |1 - 2.0| = 1.0$. Marginally stable, no amplitude change.\n-   Case 3 ($C=0.3$): $\\mathcal{G} = |1 - 0.6| = 0.4$. Stable, strong decay.\n-   Case 4 ($C=0.75$): $\\mathcal{G} = |1 - 1.5| = 0.5$. Stable, moderate decay.\n\nThe program calculates these values numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical experiment problem for the 1D linear advection equation.\n\n    For each test case, it simulates the evolution of the highest-wavenumber mode\n    using a first-order upwind scheme and computes the per-step amplification factor.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, delta_x, u, delta_t, n_steps)\n        # Case 1 (growth beyond stability threshold)\n        (64, 100.0, 10.0, 12.0, 8),\n        # Case 2 (boundary of stability)\n        (64, 100.0, 10.0, 10.0, 8),\n        # Case 3 (stable with strong decay)\n        (64, 100.0, 10.0, 3.0, 8),\n        # Case 4 (stable with moderate decay)\n        (64, 100.0, 10.0, 7.5, 8),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, delta_x, u, delta_t, n_steps = case\n        \n        # Calculate the Courant number, C = u * dt / dx.\n        C = u * delta_t / delta_x\n        \n        # Initialize the tracer field phi for the highest resolvable wavenumber mode.\n        # phi_i^0 = (-1)^i\n        indices = np.arange(N)\n        phi = (-1.0)**indices\n        \n        # Define the projection vector (-1)^i for calculating the amplitude A^n.\n        projection_vector = (-1.0)**indices\n        \n        # Calculate the initial amplitude A^0.\n        # A^0 = (1/N) * sum(phi_i^0 * (-1)^i) = (1/N) * sum((-1)^i * (-1)^i)\n        #   = (1/N) * sum(1) = 1.0\n        # We calculate it numerically for completeness.\n        A_current = (1.0 / N) * np.dot(phi, projection_vector)\n\n        # List to store the per-step amplitude ratios |A^{n+1}/A^n|.\n        ratios = []\n        \n        # Main time-stepping loop.\n        for _ in range(n_steps):\n            # Store the current state phi^n.\n            phi_old = phi\n            \n            # Get phi_{i-1} for all i, applying periodic boundary condition.\n            # np.roll(phi_old, 1) shifts elements to the right, so the new element\n            # at index i is the old element from index i-1.\n            phi_prev = np.roll(phi_old, 1)\n            \n            # Update phi to phi^{n+1} using the first-order upwind scheme.\n            # phi_i^{n+1} = phi_i^n - C * (phi_i^n - phi_{i-1}^n)\n            phi = phi_old - C * (phi_old - phi_prev)\n            \n            # Calculate the new amplitude A^{n+1}.\n            A_next = (1.0 / N) * np.dot(phi, projection_vector)\n            \n            # Calculate the ratio of absolute amplitudes and store it.\n            # Since test cases do not result in C=0.5, A_current will not be zero,\n            # so direct division is safe.\n            ratio = np.abs(A_next / A_current)\n            ratios.append(ratio)\n            \n            # Update the amplitude for the next iteration.\n            A_current = A_next\n        \n        # Compute the per-step amplification factor G as the geometric mean of the ratios.\n        product_of_ratios = np.prod(ratios)\n        geo_mean = product_of_ratios**(1.0 / n_steps)\n        \n        results.append(geo_mean)\n\n    # Format the results to six decimal places and print in the required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}