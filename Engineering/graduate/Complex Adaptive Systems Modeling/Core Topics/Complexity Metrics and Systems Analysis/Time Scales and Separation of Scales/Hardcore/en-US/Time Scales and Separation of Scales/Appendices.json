{
    "hands_on_practices": [
        {
            "introduction": "Before applying sophisticated mathematical techniques, the first step in analyzing a system with multiple time scales is to rigorously identify the parameter that governs their separation. This practice () grounds this process in fundamental physics, guiding you through the use of the Buckingham $\\Pi$ theorem. By applying dimensional analysis to a set of characteristic rates and times in a complex adaptive system, you will systematically construct the dimensionless groups that describe the system's behavior and reveal the natural separation-of-scales parameter, $\\epsilon$.",
            "id": "4150136",
            "problem": "Consider a stylized complex adaptive system in which a population of adaptive agents continuously updates their internal state in response to payoffs while a slow environmental variable co-evolves due to aggregate agent behavior. The microscopic agent updates occur with a characteristic learning rate $\\kappa$ with physical dimension $\\mathsf{T}^{-1}$, while the macroscopic environment relaxes with a characteristic rate $\\mu$ with physical dimension $\\mathsf{T}^{-1}$. Agents exhibit decision inertia, modeled by a memory time $D$ with physical dimension $\\mathsf{T}$, and the system is subjected to an exogenous seasonal forcing with angular frequency $\\omega$ with physical dimension $\\mathsf{T}^{-1}$. Assume that these four quantities $\\{\\kappa, \\mu, D, \\omega\\}$ fully characterize the time-dependent aspects of the coupled dynamics at the level of temporal scales and that no other independent base dimensions are relevant beyond time $\\mathsf{T}$ for this dimensional analysis.\n\nUsing only fundamental dimensional analysis and the Buckingham $\\Pi$ theorem, construct a complete set of independent dimensionless groups built from the variables $\\{\\kappa, \\mu, D, \\omega\\}$ and the base dimension $\\mathsf{T}$. Define the characteristic microscopic and macroscopic times by $T_{1} = 1/\\kappa$ and $T_{2} = 1/\\mu$. Identify the leading separation-of-scales parameter $\\epsilon$ as the ratio $T_{1}/T_{2}$ and express $\\epsilon$ entirely in terms of the primitive rates $\\kappa$ and $\\mu$ (you may use your dimensionless groups to do so, but the final expression must be in terms of $\\kappa$ and $\\mu$ only). \n\nYour final answer must be a single closed-form analytic expression. Do not include units in your final answer. No rounding is required because no numerical values are given. As part of your reasoning (not in the final answer), you must explicitly enumerate the number of independent dimensionless groups implied by the Buckingham $\\Pi$ theorem for this set of variables and base dimensions.",
            "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\nThe variables and their physical dimensions are provided as:\n- Agent learning rate: $\\kappa$, with dimension $[\\kappa] = \\mathsf{T}^{-1}$.\n- Environmental relaxation rate: $\\mu$, with dimension $[\\mu] = \\mathsf{T}^{-1}$.\n- Agent memory time: $D$, with dimension $[D] = \\mathsf{T}$.\n- Exogenous forcing angular frequency: $\\omega$, with dimension $[\\omega] = \\mathsf{T}^{-1}$.\nThe set of relevant variables is thus $\\{\\kappa, \\mu, D, \\omega\\}$.\nThe problem states that the only relevant base dimension is time, $\\mathsf{T}$.\nThe following definitions are provided:\n- Characteristic microscopic time: $T_{1} = 1/\\kappa$.\n- Characteristic macroscopic time: $T_{2} = 1/\\mu$.\n- Separation-of-scales parameter: $\\epsilon = T_{1}/T_{2}$.\n\nThe tasks are to:\n1.  Construct a complete set of independent dimensionless groups from $\\{\\kappa, \\mu, D, \\omega\\}$ using the Buckingham $\\Pi$ theorem.\n2.  Express $\\epsilon$ entirely in terms of $\\kappa$ and $\\mu$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem uses standard concepts from the modeling of complex adaptive systems, such as agent learning rates, environmental feedback, and time-scale separation. The method requested, dimensional analysis via the Buckingham $\\Pi$ theorem, is a fundamental and rigorous technique in physics and engineering. The setup is a stylized but scientifically coherent representation of coupled dynamics.\n- **Well-Posed**: All necessary variables and their dimensions are explicitly provided. The number of variables and fundamental dimensions is clearly stated, making the application of the Buckingham $\\Pi$ theorem unambiguous. The objective is precise: to find a set of dimensionless groups and a specific expression for $\\epsilon$. A unique and meaningful solution exists.\n- **Objective**: The problem is formulated in precise, quantitative, and unbiased language, free of any subjective or non-scientific claims.\n\nThe problem exhibits none of the specified invalidity flaws. It is scientifically sound, formalizable within the specified domain, complete, internally consistent, and well-structured.\n\n**Step 3: Verdict and Action**\nThe problem is declared **valid**. A full solution will be provided.\n\nThe solution proceeds by applying the Buckingham $\\Pi$ theorem. The number of variables is $n=4$, corresponding to the set $\\{\\kappa, \\mu, D, \\omega\\}$. The number of fundamental base dimensions is $k=1$, which is time ($\\mathsf{T}$). According to the Buckingham $\\Pi$ theorem, the number of independent dimensionless groups, denoted by $p$, is given by the formula $p = n - k$. In this case, $p = 4 - 1 = 3$. Therefore, we must construct a set of $3$ independent dimensionless groups.\n\nThe dimensions of the variables are $[\\kappa] = \\mathsf{T}^{-1}$, $[\\mu] = \\mathsf{T}^{-1}$, $[\\omega] = \\mathsf{T}^{-1}$, and $[D] = \\mathsf{T}$. To form dimensionless quantities, which have dimension $\\mathsf{T}^{0}$, we must combine these variables in products of the form $\\kappa^{a}\\mu^{b}D^{c}\\omega^{d}$ such that the powers of the dimension $\\mathsf{T}$ sum to zero. The dimensional equation is $(\\mathsf{T}^{-1})^{a}(\\mathsf{T}^{-1})^{b}(\\mathsf{T}^{1})^{c}(\\mathsf{T}^{-1})^{d} = \\mathsf{T}^{-a-b+c-d} = \\mathsf{T}^{0}$, which implies the linear algebraic constraint $-a-b+c-d=0$.\n\nA systematic way to construct a set of independent dimensionless groups is to form ratios of quantities with identical dimensions, and products of quantities whose dimensional powers cancel.\nThe variables $\\kappa$, $\\mu$, and $\\omega$ all possess the dimension $\\mathsf{T}^{-1}$. We can form two independent ratios from them. Let us choose $\\mu$ as the reference rate.\nThe first dimensionless group, $\\Pi_1$, is the ratio of the agent learning rate to the environmental relaxation rate:\n$$ \\Pi_1 = \\frac{\\kappa}{\\mu} $$\nThe dimensions cancel as expected: $[\\Pi_1] = \\frac{[\\kappa]}{[\\mu]} = \\frac{\\mathsf{T}^{-1}}{\\mathsf{T}^{-1}} = \\mathsf{T}^{0}$.\n\nThe second dimensionless group, $\\Pi_2$, can be the ratio of the external forcing frequency to the environmental relaxation rate:\n$$ \\Pi_2 = \\frac{\\omega}{\\mu} $$\nThe dimensions similarly cancel: $[\\Pi_2] = \\frac{[\\omega]}{[\\mu]} = \\frac{\\mathsf{T}^{-1}}{\\mathsf{T}^{-1}} = \\mathsf{T}^{0}$.\n\nFor the third independent dimensionless group, $\\Pi_3$, we must incorporate the variable $D$, which has not yet been used. $D$ has dimension $\\mathsf{T}$. We can combine it with any of the rates (dimension $\\mathsf{T}^{-1}$) to form a dimensionless product. Let us use $\\mu$:\n$$ \\Pi_3 = \\mu D $$\nThe dimensions cancel: $[\\Pi_3] = [\\mu][D] = \\mathsf{T}^{-1}\\mathsf{T}^{1} = \\mathsf{T}^{0}$.\n\nThe set $\\{\\Pi_1, \\Pi_2, \\Pi_3\\} = \\{\\frac{\\kappa}{\\mu}, \\frac{\\omega}{\\mu}, \\mu D\\}$ constitutes a complete set of $3$ independent dimensionless groups for this system.\n\nThe second part of the problem requires expressing the separation-of-scales parameter $\\epsilon$ in terms of $\\kappa$ and $\\mu$. The parameter $\\epsilon$ is defined as the ratio of the microscopic characteristic time $T_1$ to the macroscopic characteristic time $T_2$. The definitions given are $T_1 = 1/\\kappa$ and $T_2 = 1/\\mu$.\nSubstituting these definitions into the expression for $\\epsilon$:\n$$ \\epsilon = \\frac{T_1}{T_2} = \\frac{1/\\kappa}{1/\\mu} $$\nSimplifying this compound fraction yields:\n$$ \\epsilon = \\frac{1}{\\kappa} \\cdot \\frac{\\mu}{1} = \\frac{\\mu}{\\kappa} $$\nThis expression is purely in terms of the primitive rates $\\kappa$ and $\\mu$, as required. It is noteworthy that this parameter is the reciprocal of the first dimensionless group we constructed, i.e., $\\epsilon = 1/\\Pi_1$. This is consistent with the principles of dimensional analysis, as a physically meaningful parameter representing a ratio of scales must be dimensionless.",
            "answer": "$$\n\\boxed{\\frac{\\mu}{\\kappa}}\n$$"
        },
        {
            "introduction": "Once a small parameter $\\epsilon$ is identified, we can formally exploit it to derive a simplified, lower-dimensional model of the system's long-term behavior. This exercise () introduces the core analytical technique of geometric singular perturbation theory, where the dynamics are shown to collapse onto a \"slow manifold.\" You will calculate not only the zeroth-order approximation of this manifold, known as the critical manifold, but also the crucial first-order correction, providing a more accurate description of the slow dynamics.",
            "id": "4150166",
            "problem": "Consider a two-variable slow-fast model for a complex adaptive system (CAS), where an individual-level fast variable $x$ adapts quickly to a population-level slow variable $y$. The model is governed by the system\n$$\n\\epsilon \\,\\dot{x} \\;=\\; f(x,y), \\qquad \\dot{y} \\;=\\; g(x,y),\n$$\nwith small parameter $0\\epsilon\\ll 1$ indicating a separation of time scales. The critical manifold $M_0$ is defined as the set of points where the fast subsystem equilibrates instantaneously as $\\epsilon \\to 0$, namely $M_0 \\equiv \\{(x,y): f(x,y)=0\\}$. Under normal hyperbolicity (i.e., $\\partial f/\\partial x \\neq 0$ on $M_0$), Fenichel theory guarantees the persistence of a nearby invariant slow manifold $M_\\epsilon$ for small $\\epsilon0$ that can be represented locally as a graph $x=h(y,\\epsilon)$ and expanded as $x=h_0(y)+\\epsilon h_1(y)+\\mathcal{O}(\\epsilon^2)$.\n\nLet $f(x,y)=-x+y$ and $g(x,y)=x$. Compute the critical manifold $M_0$ and the first-order approximation to the slow manifold $M_\\epsilon$ by determining the graph functions $h_0(y)$ and $h_\\epsilon(y)=h_0(y)+\\epsilon h_1(y)$ to order $\\epsilon$. Express your final answer as the pair of graph functions $(h_0(y),\\,h_\\epsilon(y))$ in closed form. No rounding is required, and you should not include any units in your final expressions.",
            "solution": "The problem is valid. It is a well-posed problem in the standard framework of geometric singular perturbation theory, a core topic in the study of dynamical systems with multiple time scales, often applied in complex adaptive systems modeling. All necessary data and definitions are provided, and there are no scientific or logical inconsistencies.\n\nThe given slow-fast system is:\n$$\n\\epsilon \\,\\dot{x} \\;=\\; -x+y\n$$\n$$\n\\dot{y} \\;=\\; x\n$$\nwhere $\\dot{x} = \\frac{dx}{dt}$ and $\\dot{y} = \\frac{dy}{dt}$, with $0  \\epsilon \\ll 1$. This corresponds to the general form with $f(x,y) = -x+y$ and $g(x,y) = x$.\n\nFirst, we compute the critical manifold $M_0$. This is the set of points where the fast dynamics have equilibrated, which is found by taking the singular limit $\\epsilon \\to 0$ in the equation for the fast variable $x$.\n$$\n0 = f(x,y) = -x+y\n$$\nSolving for $x$ gives the equation for the critical manifold:\n$$\nx = y\n$$\nThe problem states that the slow manifold $M_\\epsilon$ can be represented as a graph $x=h(y, \\epsilon)$, which has the expansion $x = h_0(y) + \\epsilon h_1(y) + \\mathcal{O}(\\epsilon^2)$. The critical manifold $M_0$ is the zeroth-order approximation to the slow manifold $M_\\epsilon$. Therefore, the graph function for the critical manifold is $h_0(y)$:\n$$\nh_0(y) = y\n$$\nThe theory requires the critical manifold to be normally hyperbolic. This condition is met if $\\frac{\\partial f}{\\partial x} \\neq 0$ for points on $M_0$. We compute the partial derivative:\n$$\n\\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x}(-x+y) = -1\n$$\nSince $\\frac{\\partial f}{\\partial x} = -1 \\neq 0$ for all $(x,y)$, the critical manifold $M_0$ is normally hyperbolic everywhere, which validates the use of Fenichel theory and the existence of the slow manifold expansion.\n\nNext, we determine the first-order correction, $h_1(y)$. The slow manifold $M_\\epsilon$ is an invariant manifold of the system. This means that any trajectory $(x(t), y(t))$ that starts on the manifold remains on it. If a trajectory lies on the manifold, its coordinates must satisfy $x(t) = h(y(t), \\epsilon)$ for all time $t$. We can differentiate this relationship with respect to time using the chain rule:\n$$\n\\frac{dx}{dt} = \\frac{\\partial h(y,\\epsilon)}{\\partial y} \\frac{dy}{dt}\n$$\nSubstituting the expressions for $\\dot{x}$ and $\\dot{y}$ from the original system, we obtain the invariance condition:\n$$\n\\frac{f(x,y)}{\\epsilon} = \\frac{\\partial h(y,\\epsilon)}{\\partial y} g(x,y)\n$$\nSince this equation must hold for any point on the manifold, we substitute $x = h(y, \\epsilon)$:\n$$\nf(h(y,\\epsilon), y) = \\epsilon \\, g(h(y,\\epsilon), y) \\frac{\\partial h(y,\\epsilon)}{\\partial y}\n$$\nNow, we substitute the asymptotic expansion $h(y, \\epsilon) = h_0(y) + \\epsilon h_1(y) + \\mathcal{O}(\\epsilon^2)$ into the invariance condition. We also need the Taylor expansions of $f$ and $g$ around $x=h_0(y)$:\n$$\nf(h_0 + \\epsilon h_1 + \\dots, y) = f(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{(h_0,y)} + \\mathcal{O}(\\epsilon^2)\n$$\n$$\ng(h_0 + \\epsilon h_1 + \\dots, y) = g(h_0, y) + \\epsilon h_1 \\frac{\\partial g}{\\partial x}\\bigg|_{(h_0,y)} + \\mathcal{O}(\\epsilon^2)\n$$\nAnd the derivative of $h(y,\\epsilon)$ is:\n$$\n\\frac{\\partial h}{\\partial y} = \\frac{d h_0}{d y} + \\epsilon \\frac{d h_1}{d y} + \\mathcal{O}(\\epsilon^2)\n$$\nSubstituting these into the invariance condition:\n$$\nf(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{x=h_0} + \\mathcal{O}(\\epsilon^2) = \\epsilon \\left( g(h_0, y) + \\mathcal{O}(\\epsilon) \\right) \\left( \\frac{d h_0}{d y} + \\mathcal{O}(\\epsilon) \\right)\n$$\nExpanding the right-hand side and keeping terms up to order $\\epsilon$:\n$$\nf(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{x=h_0} + \\mathcal{O}(\\epsilon^2) = \\epsilon \\, g(h_0, y) \\frac{d h_0}{d y} + \\mathcal{O}(\\epsilon^2)\n$$\nBy equating coefficients of like powers of $\\epsilon$, we can solve for $h_0$ and $h_1$.\nThe $\\mathcal{O}(\\epsilon^0)$ terms give:\n$$\nf(h_0(y), y) = 0\n$$\nThis is the equation for the critical manifold, which we have already solved to find $h_0(y)=y$.\n\nThe $\\mathcal{O}(\\epsilon^1)$ terms give:\n$$\nh_1(y) \\frac{\\partial f}{\\partial x}(h_0(y), y) = g(h_0(y), y) \\frac{d h_0(y)}{d y}\n$$\nWe now solve this equation for $h_1(y)$ using our specific functions and the result for $h_0(y)$. We have:\n- $h_0(y) = y \\implies \\frac{d h_0}{d y} = 1$\n- $\\frac{\\partial f}{\\partial x}(h_0(y), y) = -1$\n- $g(h_0(y), y) = g(y,y) = y$ (since $g(x,y)=x$)\n\nSubstituting these into the equation for $h_1(y)$:\n$$\nh_1(y) \\cdot (-1) = y \\cdot 1\n$$\n$$\n-h_1(y) = y\n$$\nThus, the first-order correction function is:\n$$\nh_1(y) = -y\n$$\nThe problem asks for the pair of graph functions $(h_0(y), h_\\epsilon(y))$. We have $h_0(y)=y$. The first-order approximation to the slow manifold $M_\\epsilon$ is given by the graph function $h_\\epsilon(y) = h_0(y) + \\epsilon h_1(y)$.\n$$\nh_\\epsilon(y) = y + \\epsilon(-y) = y(1-\\epsilon)\n$$\nTherefore, the required pair of functions is $(y, y(1-\\epsilon))$.",
            "answer": "$$\n\\boxed{(y, y(1-\\epsilon))}\n$$"
        },
        {
            "introduction": "Analytical reductions are powerful, but direct numerical simulation is often essential for exploring the full behavior of a complex system. Systems with widely separated time scales pose a significant computational challenge known as \"stiffness,\" where standard explicit methods become prohibitively slow or unstable. This final practice () tackles this challenge by having you develop a first-order Implicit-Explicit (IMEX) integrator, a sophisticated hybrid scheme that is a cornerstone of modern scientific computing for multiscale problems.",
            "id": "4150119",
            "problem": "You are given an initial value problem with an explicit splitting of fast and slow processes, expressed as the ordinary differential equation (ODE) $$\\dot{x}(t)=f_{\\text{stiff}}(x(t)) + f_{\\text{nonstiff}}(x(t)),$$ where $$f_{\\text{stiff}}(x)=\\lambda x,$$ with $$\\lambdalt;0$$ representing a fast, linearly stiff decay, and $$f_{\\text{nonstiff}}(x)=\\alpha\\sin(x),$$ with $$\\alphagt;0$$ representing a slowly varying nonlinear term. The stiffness implies a fast time scale $$\\tau_{\\text{fast}}\\approx 1/|\\lambda|,$$ separated from the slow time scale of the nonlinear term.\n\nDefine multirate integration in terms of using different step sizes to resolve separated time scales in additively split dynamics. Construct a first-order Implicit-Explicit (IMEX) scheme that treats the stiff fast term implicitly and the slow term explicitly. Specifically, derive the scheme starting from the definition of the time derivative as a difference quotient, and explain how to choose a macro time step $$H$$ for the slow evolution and a micro time step $$h=H/m$$ for the fast evolution, with $$m\\in\\mathbb{N}$$. Your IMEX multirate construction must, within each macro step $$[t_n,t_{n+1}]$$, perform $$m$$ micro updates in which the stiff contribution is evaluated implicitly at the advanced state and the slow contribution is held explicit in a manner consistent with the assumption of slow variation over the macro window. For the given linear stiff term $$f_{\\text{stiff}}(x)=\\lambda x,$$ derive the closed-form micro update and justify stability properties of the implicit treatment when $$\\lambdalt;0$$.\n\nImplement the resulting IMEX multirate integrator to compute the numerical approximation $$x(T)$$ for the following test suite. All quantities are dimensionless. Assume that $$T/H$$ is an integer in each test. The output for each test case must be the single floating-point value of $$x(T)$$.\n\nTest suite:\n- Case 1 (happy path): $$\\lambda=-1000,$$ $$\\alpha=1.0,$$ $$H=0.05,$$ $$m=10,$$ $$T=1.0,$$ $$x(0)=0.1.$$\n- Case 2 (boundary stability with a single implicit macro update): $$\\lambda=-200,$$ $$\\alpha=0.5,$$ $$H=0.02,$$ $$m=1,$$ $$T=2.0,$$ $$x(0)=2.0.$$\n- Case 3 (extremely stiff fast scale): $$\\lambda=-10^6,$$ $$\\alpha=0.1,$$ $$H=0.1,$$ $$m=50,$$ $$T=0.5,$$ $$x(0)=1.0.$$\n- Case 4 (no stiff term, purely slow explicit evolution): $$\\lambda=0,$$ $$\\alpha=1.0,$$ $$H=0.05,$$ $$m=1,$$ $$T=1.0,$$ $$x(0)=0.5.$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $$[x\\_1,x\\_2,x\\_3,x\\_4]$$), where $$x\\_i$$ is the computed $$x(T)$$ for Case $$i$$.",
            "solution": "The problem presented is valid. It is a well-posed initial value problem from the field of numerical analysis, specifically concerning the solution of stiff ordinary differential equations (ODEs). The problem is scientifically grounded, free of contradictions, and contains all necessary information to construct the specified numerical method and compute the required results.\n\nThe task is to construct and apply a first-order Implicit-Explicit (IMEX) multirate integrator for an ODE with an additive splitting into a stiff and a non-stiff part:\n$$\n\\dot{x}(t) = f_{\\text{stiff}}(x(t)) + f_{\\text{nonstiff}}(x(t))\n$$\nThe stiff term is linear, $$f_{\\text{stiff}}(x) = \\lambda x$$ with $$\\lambda  0$$, representing a fast-decaying process on a time scale $$\\tau_{\\text{fast}} \\approx 1/|\\lambda|$$. The non-stiff term is nonlinear, $$f_{\\text{nonstiff}}(x) = \\alpha \\sin(x)$$ with $$\\alpha  0$$, representing a slowly varying process.\n\nMultirate integration methods are designed to efficiently solve such systems by employing different time step sizes that are appropriate for the different time scales present in the problem. We use a large macro time step, $$H$$, to capture the slow dynamics governed by $$f_{\\text{nonstiff}}$$, and within each macro step, we use $$m$$ smaller micro time steps, each of size $$h=H/m$$, to resolve the fast dynamics governed by $$f_{\\text{stiff}}$$. This strategy avoids the severe stability constraint that an explicit method would face, which would necessitate a step size on the order of the fast time scale $$\\tau_{\\text{fast}}$$.\n\nWe will construct the first-order IMEX multirate scheme as specified. Let the time grid be defined by macro steps $$t_n = nH$$. To advance the numerical solution from $$x_n \\approx x(t_n)$$ to $$x_{n+1} \\approx x(t_{n+1})$$, we follow a procedure for the macro-interval $$[t_n, t_{n+1}]$$. The problem dictates that the slow contribution $$f_{\\text{nonstiff}}$$ is held explicit and constant over the macro-interval, consistent with its slow variation. We evaluate it once at the beginning of the step: $$S_n = f_{\\text{nonstiff}}(x_n)$$. Within the macro-interval, we then effectively solve the subproblem $$\\dot{y}(t) = f_{\\text{stiff}}(y(t)) + S_n$$ using $$m$$ micro steps.\n\nLet $$x_{n,j}$$ be the approximation at the $j$-th micro-step, for $$j \\in \\{0, 1, \\dots, m\\}$$, with the initial condition $$x_{n,0} = x_n$$. To advance from $$x_{n,j}$$ to $$x_{n,j+1}$$, we use a first-order time-stepping scheme where the stiff term is treated implicitly (evaluated at the future time) and the slow term is treated explicitly. This is an IMEX formulation, which for a first-order method, corresponds to using Backward Euler for the stiff part and Forward Euler for the non-stiff part. The finite difference form of the ODE over a micro-step of size $$h$$ is:\n$$\n\\frac{x_{n,j+1} - x_{n,j}}{h} = f_{\\text{stiff}}(x_{n,j+1}) + S_n\n$$\nSubstituting the specific forms of the functions, $$f_{\\text{stiff}}(x) = \\lambda x$$ and $$S_n = \\alpha \\sin(x_n)$$, we obtain:\n$$\n\\frac{x_{n,j+1} - x_{n,j}}{h} = \\lambda x_{n,j+1} + \\alpha \\sin(x_n)\n$$\nWe can now derive the closed-form expression for the micro-update by solving for $$x_{n,j+1}}$$:\n$$\nx_{n,j+1} - x_{n,j} = h \\lambda x_{n,j+1} + h \\alpha \\sin(x_n)\n$$\n$$\nx_{n,j+1}(1 - h\\lambda) = x_{n,j} + h \\alpha \\sin(x_n)\n$$\nThis yields the explicit update rule for each micro-step:\n$$\nx_{n,j+1} = \\frac{x_{n,j} + h \\alpha \\sin(x_n)}{1 - h\\lambda}\n$$\nThis update is applied sequentially for $$j = 0, 1, \\dots, m-1$$, starting from $$x_{n,0} = x_n$$. The result after $$m$$ steps is the solution at the next macro time, $$x_{n+1} = x_{n,m}$$.\n\nThe stability of this scheme is a critical aspect. The implicit treatment of the stiff term is intended to remove the stability restriction associated with $$|\\lambda|$$. We analyze the stability for the test equation $$\\dot{y} = \\lambda y$$. The numerical scheme (Backward Euler) is $$y_{k+1} = y_k + h \\lambda y_{k+1}$$, which gives $$y_{k+1} = \\frac{1}{1-h\\lambda} y_k$$. The amplification factor is $$R(z) = \\frac{1}{1-z}$$, where $$z = h\\lambda$$. For stability, we require $$|R(z)| \\le 1$$. Since the problem specifies $$\\lambda  0$$ and the step size $$h  0$$, the argument $$z=h\\lambda$$ is a real, negative number. The magnitude of the amplification factor is:\n$$\n|R(h\\lambda)| = \\left| \\frac{1}{1 - h\\lambda} \\right| = \\frac{1}{1 + h|\\lambda|}\n$$\nAs $$h  0$$ and $$|\\lambda| \\ge 0$$, the denominator $$1 + h|\\lambda| \\ge 1$$. It follows that $$0  |R(h\\lambda)| \\le 1$$. This proves that the method is unconditionally stable for any choice of step size $$h  0$$ for the stiff term with $$\\lambda  0$$. This A-stability property allows the macro-step $$H$$ to be chosen based on the accuracy requirements of the slow non-stiff dynamics, not the stability of the fast stiff dynamics.\n\nThe complete numerical algorithm is:\n$1$. Initialize $$x \\leftarrow x(0)$$, $$t \\leftarrow 0$$.\n$2$. Calculate the number of macro steps, $$N_{steps} = \\text{round}(T/H)$$.\n$3$. For each macro step from $$n=0$$ to $$N_{steps}-1$$:\n    a. Let the current solution at the start of the macro-step be $$x_n$$.\n    b. Evaluate and fix the slow term contribution: $$S_n = \\alpha \\sin(x_n)$$.\n    c. Initialize the micro-step solver: $$x_{\\text{micro}} \\leftarrow x_n$$.\n    d. Define the micro-step size: $$h = H/m$$.\n    e. For each micro-step from $$j=0$$ to $$m-1$$:\n        i. Apply the update: $$x_{\\text{micro}} \\leftarrow \\frac{x_{\\text{micro}} + h S_n}{1 - h\\lambda}$$.\n    f. Update the solution for the next macro-step: $$x \\leftarrow x_{\\text{micro}}$$.\n$4$. The final value of $$x$$ is the approximation of $$x(T)$$.\n\nFor Case $4$, where $$\\lambda=0$$, the system is not stiff. The update formula denominator becomes $$1 - h(0) = 1$$. With $$m=1$$, we have $$h=H$$, and the algorithm simplifies to $$x_{n+1} = x_n + H \\alpha \\sin(x_n)$$, which is the standard Forward Euler method applied to the non-stiff equation $$\\dot{x} = \\alpha \\sin(x)$$, as expected.\n\nThe following Python code implements this algorithm to solve for $$x(T)$$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a first-order IMEX multirate integrator to solve a set of\n    stiff ODE test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (lambda, alpha, H, m, T, x0)\n        (-1000.0, 1.0, 0.05, 10, 1.0, 0.1),\n        # Case 2:\n        (-200.0, 0.5, 0.02, 1, 2.0, 2.0),\n        # Case 3:\n        (-1e6, 0.1, 0.1, 50, 0.5, 1.0),\n        # Case 4:\n        (0.0, 1.0, 0.05, 1, 1.0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        lam, alpha, H, m, T, x0 = case\n        \n        # Ensure correct types for calculations\n        lam = float(lam)\n        alpha = float(alpha)\n        H = float(H)\n        m = int(m)\n        T = float(T)\n        x_current = float(x0)\n\n        # Per the problem statement, T/H is an integer\n        num_macro_steps = int(round(T / H))\n        h = H / m\n\n        # Main integration loop over macro steps\n        for _ in range(num_macro_steps):\n            # Evaluate the slow term once at the beginning of the macro step\n            slow_term_val = alpha * np.sin(x_current)\n            \n            x_micro = x_current\n            \n            # Inner loop for micro-steps\n            for _ in range(m):\n                # Apply the derived closed-form IMEX micro-update\n                # x_micro_new = (x_micro + h * slow_term_val) / (1 - h * lam)\n                numerator = x_micro + h * slow_term_val\n                denominator = 1.0 - h * lam\n                x_micro = numerator / denominator\n\n            # Update the solution for the next macro step\n            x_current = x_micro\n            \n        results.append(x_current)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}