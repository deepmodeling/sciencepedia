{
    "hands_on_practices": [
        {
            "introduction": "流行病模型的一个核心目标是预测疫情的峰值，以便为公共卫生资源的规划提供信息。这项练习  将引导我们利用SIR模型的微分方程，精确地找出感染人数达到峰值时的条件。通过这个过程，我们将揭示群体免疫阈值的概念，即当易感人群数量下降到某个临界点时，疫情的增长将停止并开始衰退。",
            "id": "1707388",
            "problem": "一个流行病学团队正在为一个总人口为 $N$ 的小型孤立社区中一种新型非致命病毒的传播建立模型。所使用的模型是经典的易感-感染-康复 (SIR) 模型，该模型在任何给定时间 $t$ 将人群分为三个仓室：\n- $S(t)$：对病毒易感的个体数量。\n- $I(t)$：当前具有传染性的个体数量。\n- $R(t)$：已康复并获得免疫的个体数量。\n\n总人口保持不变，即 $S(t) + I(t) + R(t) = N$。传播的动力学由以下耦合常微分方程组控制：\n$$\n\\frac{dS}{dt} = - \\frac{\\beta}{N} S I\n$$\n$$\n\\frac{dI}{dt} = \\frac{\\beta}{N} S I - \\gamma I\n$$\n$$\n\\frac{dR}{dt} = \\gamma I\n$$\n此处，$\\beta$ 是有效接触率，$\\gamma$ 是恢复率，因此 $1/\\gamma$ 表示平均传染期。假设疫情始于在一个大部分为易感人群中出现的少数感染者，导致活跃感染人数上升并最终下降。\n\n公共卫生规划的一个关键指标是疫情高峰，它对应于并发感染的最大数量。请确定在传染性个体数量 $I(t)$ 达到其最大值的那一刻，易感个体的数量 $S(t)$。请用模型参数 $\\beta$、$\\gamma$ 和总人口 $N$ 的符号表达式来表示你的答案。",
            "solution": "我们已知 SIR 系统，其总人口为常数 $N$，动力学方程如下：\n$$\n\\frac{dS}{dt} = - \\frac{\\beta}{N} S I, \\quad\n\\frac{dI}{dt} = \\frac{\\beta}{N} S I - \\gamma I, \\quad\n\\frac{dR}{dt} = \\gamma I.\n$$\n题目要求我们求出当 $I(t)$ 达到最大值时的 $S(t)$。$I(t)$ 在某个时间 $t^{\\ast}$ 处取得局部极值的必要条件是 $\\frac{dI}{dt}(t^{\\ast})=0$。使用 $\\frac{dI}{dt}$ 的表达式，我们写出：\n$$\n\\frac{dI}{dt} = I\\left(\\frac{\\beta}{N} S - \\gamma\\right).\n$$\n在峰值处，根据假设（存在上升和下降的非平凡疫情），$I(t^{\\ast})>0$，所以令 $\\frac{dI}{dt}(t^{\\ast})=0$ 意味着：\n$$\n\\frac{\\beta}{N} S(t^{\\ast}) - \\gamma = 0.\n$$\n求解 $S(t^{\\ast})$ 得到：\n$$\nS(t^{\\ast}) = \\frac{\\gamma N}{\\beta}.\n$$\n这是在感染人数达到最大值时，易感人群的数量。",
            "answer": "$$\\boxed{\\frac{\\gamma N}{\\beta}}$$"
        },
        {
            "introduction": "在预测了疫情峰值之后，理解一次流行病的最终影响范围也同样至关重要。这项练习  将我们的分析从瞬时变化率推进到系统的最终状态。我们将学习如何通过对微分方程进行积分，推导出一个连接基本再生数 $R_0$ 与最终未被感染人群比例 $s_{\\infty}$ 的基本关系式，这是一个强大的预测工具，用于评估疫情的总规模。",
            "id": "1707353",
            "problem": "一位流行病学家正在分析在一个大型孤立人群中发生的自限性病毒爆发。该病毒的传播可以很好地由简单的易感-感染-康复 (SIR) 模型描述。易感者数量 $S(t)$、感染者数量 $I(t)$ 和康复者数量 $R(t)$ 随时间 $t$ 的动态变化由以下微分方程组控制：\n\n$$ \\frac{dS}{dt} = -\\beta S I $$\n$$ \\frac{dI}{dt} = \\beta S I - \\gamma I $$\n$$ \\frac{dR}{dt} = \\gamma I $$\n\n这里，$\\beta$ 是有效传播率参数，$\\gamma$ 是平均恢复率。总人口 $N = S(t) + I(t) + R(t)$ 保持不变。在爆发初期 ($t=0$)，只有极少数个体被感染，因此我们可以做出标准近似，即初始感染者数量 $I(0) \\approx 0$ 且初始易感者数量 $S(0) \\approx N$。\n\n流行病学中的一个关键指标是基本再生数 $R_0$，对于此模型定义为 $R_0 = \\frac{\\beta N}{\\gamma}$。另一个重要的量是从未感染该疾病的人口最终比例，记为 $s_{\\infty} = \\frac{S(\\infty)}{N}$，其中 $S(\\infty)$ 是当 $t \\to \\infty$ 时易感者的数量。\n\n存在一个连接 $s_{\\infty}$ 和 $R_0$ 的基本超越关系。该关系可以写成 $f(s_{\\infty}, R_0) = 0$ 的形式。请确定函数 $f(s_{\\infty}, R_0)$ 的表达式。",
            "solution": "我们从 SIR 模型开始：\n$$\n\\frac{dS}{dt}=-\\beta S I,\\quad \\frac{dI}{dt}=\\beta S I-\\gamma I,\\quad \\frac{dR}{dt}=\\gamma I,\n$$\n总人口 $N=S+I+R$ 为常数。为了得到最终规模关系，我们通过将 $\\frac{dS}{dt}$ 除以 $\\frac{dR}{dt}$ 来消去时间：\n$$\n\\frac{dS}{dR}=\\frac{dS/dt}{dR/dt}=\\frac{-\\beta S I}{\\gamma I}=-\\frac{\\beta}{\\gamma}S.\n$$\n分离变量并从爆发开始到结束进行积分。使用 $S(0)\\approx N$ 和 $R(0)\\approx 0$，并注意到当 $t\\to\\infty$ 时，我们有 $I(\\infty)=0$ 因而 $R(\\infty)=N-S(\\infty)$，我们得到\n$$\n\\int_{S(0)}^{S(\\infty)}\\frac{dS}{S}=-\\frac{\\beta}{\\gamma}\\int_{R(0)}^{R(\\infty)}dR\n\\;\\;\\Longrightarrow\\;\\;\n\\ln S(\\infty)-\\ln S(0)=-\\frac{\\beta}{\\gamma}\\bigl(R(\\infty)-R(0)\\bigr).\n$$\n代入 $S(0)=N$，$R(0)=0$ 和 $R(\\infty)=N-S(\\infty)$：\n$$\n\\ln S(\\infty)-\\ln N=-\\frac{\\beta}{\\gamma}\\bigl(N-S(\\infty)\\bigr).\n$$\n定义 $s_{\\infty}=\\frac{S(\\infty)}{N}$ 并使用 $R_{0}=\\frac{\\beta N}{\\gamma}$ 将该关系重写为\n$$\n\\ln s_{\\infty}=-R_{0}\\bigl(1-s_{\\infty}\\bigr),\n$$\n这等价于超越方程\n$$\n\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)=0.\n$$\n因此，$f(s_{\\infty},R_{0})$ 的一个有效选择是\n$$\nf(s_{\\infty},R_{0})=\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr).\n$$",
            "answer": "$$\\boxed{\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)}$$"
        },
        {
            "introduction": "确定性模型描述的是大群体中的平均行为，而随机模型对于理解小群体中的偶然事件或疫情暴发初期的动态至关重要。本次练习  将我们从确定性框架带入随机世界。我们将详细探讨Gillespie算法，这是一种精确模拟流行病随机路径的基石方法，为计算流行病学研究提供了坚实的实践基础。",
            "id": "4149082",
            "problem": "考虑一个在连续时间、种群规模为 $N$ 的充分混合的易感-感染-康复（SIR）传染病模型，其状态变量 $(S,I,R)$ 满足 $S+I+R=N$。该模型有两个反应通道：感染（将一个单位从 $S$ 转移到 $I$）和康复（将一个单位从 $I$ 转移到 $R$）。假设传播方式为参数为 $\\beta0$ 和 $\\gamma0$ 的密度依赖质量作用传播，并且该过程是一个连续时间马尔可夫链（CTMC），其状态依赖的转移强度由质量作用动力学确定。随机模拟算法（SSA），也称为 Gillespie 直接法，通过对下一次反应的等待时间进行抽样，并在当前状态的条件下选择发生哪个反应，来推进 CTMC 的演化。\n\n在密度依赖质量作用传播下，模拟此随机 SIR 过程的一次迭代时，哪个选项完整且按正确顺序指定了 Gillespie 直接法的步骤？该步骤包括基于累积倾向的事件选择，以及从速率等于总倾向的指数分布中抽样的时间增量。\n\nA. 计算倾向函数：感染为 $a_1=\\beta S I/N$，康复为 $a_2=\\gamma I$，并设 $a_0=a_1+a_2$。抽取 $u_1\\sim \\text{Uniform}(0,1)$ 并设置 $\\tau=-\\ln(u_1)/a_0$。抽取 $u_2\\sim \\text{Uniform}(0,1)$，计算阈值 $u_2 a_0$，如果 $u_2 a_0  a_1$ 则选择感染，否则选择康复。如果发生感染，更新 $(S,I,R)\\leftarrow(S-1,I+1,R)$；如果发生康复，更新 $(S,I,R)\\leftarrow(S,I-1,R+1)$。将时间推进 $t\\leftarrow t+\\tau$。\n\nB. 计算倾向函数 $a_1=\\beta S I$ 和 $a_2=\\gamma I$，并设 $a_0=a_1+a_2$。抽取 $u\\sim \\text{Uniform}(0,1)$ 并设置 $\\tau=\\ln(u)/a_0$。通过将 $u$ 与归一化的累积倾向进行比较来选择事件：如果 $u\\leq a_1/a_0$ 选择康复，否则选择感染。更新相应的仓室计数并将时间推进 $t\\leftarrow t+\\tau$。\n\nC. 计算倾向函数 $a_1=\\beta S I/N$ 和 $a_2=\\gamma I$，并设 $a_0=\\max\\{a_1,a_2\\}$。从 $\\text{Exp}(a_0)$ 分布中抽取时间增量 $\\tau$，然后抽取 $u\\sim \\text{Uniform}(0,1)$，如果 $u  a_2/a_0$ 则选择感染，否则选择康复。相应地更新状态并推进时间。\n\nD. 计算倾向函数 $a_1=\\beta S I/N$ 和 $a_2=\\gamma I$，并设 $a_0=a_1+a_2$。抽取 $u_1\\sim \\text{Uniform}(0,1)$ 并设置 $\\tau=1/a_0$。抽取 $u_2\\sim \\text{Uniform}(0,1)$，如果 $u_2  a_1/a_0$ 则选择感染，否则选择康复。更新状态和时间 $t\\leftarrow t+\\tau$。",
            "solution": "Gillespie 直接法是一种精确模拟化学或生物系统（当其被建模为连续时间马尔可夫链时）随机时间演化的算法。对于给定的 SIR 模型，其单次迭代步骤如下：\n\n1.  **计算倾向函数**：对于当前状态 $(S, I, R)$，计算每个可能事件的发生率（倾向）。\n    *   感染事件：一个个体从 $S$ 变为 $I$。问题指定了“密度依赖”传播，其倾向为 $a_1 = \\frac{\\beta S I}{N}$。\n    *   康复事件：一个个体从 $I$ 变为 $R$。其倾向为 $a_2 = \\gamma I$。\n\n2.  **计算总倾向**：所有事件的总发生率为 $a_0 = a_1 + a_2 = \\frac{\\beta S I}{N} + \\gamma I$。\n\n3.  **确定下一事件的时间**：下一事件发生的等待时间 $\\tau$ 是一个服从指数分布的随机变量，其速率参数为 $a_0$。我们通过逆变换采样法生成它：抽取一个随机数 $u_1 \\sim \\text{Uniform}(0,1)$，计算 $\\tau = -\\frac{\\ln(u_1)}{a_0}$。\n\n4.  **确定下一事件的类型**：下一个发生的事件是感染的概率为 $\\frac{a_1}{a_0}$，是康复的概率为 $\\frac{a_2}{a_0}$。我们通过抽取第二个随机数 $u_2 \\sim \\text{Uniform}(0,1)$ 来选择事件。如果 $u_2 \\cdot a_0  a_1$，则选择感染事件；否则，选择康复事件。\n\n5.  **更新状态和时间**：根据所选事件更新仓室人数（例如，感染则 $S \\to S-1, I \\to I+1$），并将时间推进 $t \\to t + \\tau$。\n\n现在我们评估各个选项：\n*   **A**：此选项完全正确地描述了上述所有步骤：正确的倾向函数、正确的总倾向、正确的 $\\tau$ 生成方法以及正确的事件选择逻辑。\n*   **B**：此选项有三个错误：它使用了错误的感染倾向 ($a_1=\\beta S I$，这是标准质量作用，而非密度依赖)、错误的 $\\tau$ 计算公式 (缺少负号)，以及颠倒的事件选择逻辑。\n*   **C**：此选项错误地将总倾向计算为 $a_0 = \\max\\{a_1, a_2\\}$，而正确的应为求和。\n*   **D**：此选项使用了一个确定性的时间步长 $\\tau = 1/a_0$，这是指数分布的平均值，而不是一个随机抽样值。这违反了Gillespie算法的精确性。\n\n因此，选项 A 是唯一正确且完整地描述了 Gillespie 直接法在该模型上的应用的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}