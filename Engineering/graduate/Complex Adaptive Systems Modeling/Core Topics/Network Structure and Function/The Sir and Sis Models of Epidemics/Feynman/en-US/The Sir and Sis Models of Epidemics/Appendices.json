{
    "hands_on_practices": [
        {
            "introduction": "Beyond predicting the peak of an epidemic, a crucial question for public health is determining its ultimate scope. This exercise moves from analyzing instantaneous rates to calculating the final, cumulative impact of an outbreak. By applying a powerful analytical technique that eliminates the time variable, you will derive the famous \"final size equation,\" a foundational result in mathematical epidemiology that links the basic reproduction number, $R_0$, to the total fraction of the population that escapes infection.",
            "id": "1707353",
            "problem": "An epidemiologist is analyzing a self-contained viral outbreak that occurred in a large, isolated population. The spread of the virus is well-described by the simple Susceptible-Infected-Recovered (SIR) model. The dynamics of the number of susceptible individuals $S(t)$, infected individuals $I(t)$, and recovered individuals $R(t)$ over time $t$ are governed by the following system of differential equations:\n\n$$ \\frac{dS}{dt} = -\\frac{\\beta S I}{N} $$\n$$ \\frac{dI}{dt} = \\frac{\\beta S I}{N} - \\gamma I $$\n$$ \\frac{dR}{dt} = \\gamma I $$\n\nHere, $\\beta$ is the effective transmission rate parameter, and $\\gamma$ is the mean recovery rate. The total population $N = S(t) + I(t) + R(t)$ remains constant. At the beginning of the outbreak ($t=0$), a very small number of individuals were infected, so we can make the standard approximation that the initial number of infected individuals $I(0) \\approx 0$ and the initial number of susceptible individuals $S(0) \\approx N$.\n\nA key metric in epidemiology is the basic reproduction number, $R_0$, defined for this model as $R_0 = \\frac{\\beta}{\\gamma}$. Another important quantity is the final fraction of the population that never contracted the disease, denoted by $s_{\\infty} = \\frac{S(\\infty)}{N}$, where $S(\\infty)$ is the number of susceptible individuals as $t \\to \\infty$.\n\nA fundamental transcendental relationship exists that connects $s_{\\infty}$ and $R_0$. This relationship can be written in the form $f(s_{\\infty}, R_0) = 0$. Determine the expression for the function $f(s_{\\infty}, R_0)$.",
            "solution": "To find a relationship between the final fraction of susceptibles, $s_{\\infty}$, and the basic reproduction number, $R_0$, we can eliminate the time variable, $t$, from the system of differential equations. We do this by dividing the equation for $\\frac{dS}{dt}$ by the equation for $\\frac{dR}{dt}$:\n\n$$ \\frac{dS}{dR} = \\frac{dS/dt}{dR/dt} = \\frac{-\\beta S I / N}{\\gamma I} = -\\frac{\\beta}{\\gamma N} S $$\n\nThis can be rewritten using the definition $R_0 = \\beta/\\gamma$:\n\n$$ \\frac{dS}{dR} = -\\frac{R_0}{N} S $$\n\nNow, we separate variables and integrate over the entire course of the epidemic, from $t=0$ to $t \\to \\infty$. At the start ($t=0$), we have $S(0) \\approx N$ and $R(0) = 0$. At the end ($t \\to \\infty$), we have $S(\\infty)$ and $R(\\infty)$. Since the epidemic ends when $I(\\infty)=0$, the final number of recovered individuals is the total number of people who were ever infected, which is $R(\\infty) = N - S(\\infty)$.\n\n$$ \\int_{S(0)}^{S(\\infty)} \\frac{1}{S} dS = -\\frac{R_0}{N} \\int_{R(0)}^{R(\\infty)} dR $$\n$$ [\\ln S]_{S(0)}^{S(\\infty)} = -\\frac{R_0}{N} [R]_{R(0)}^{R(\\infty)} $$\n$$ \\ln S(\\infty) - \\ln S(0) = -\\frac{R_0}{N} (R(\\infty) - R(0)) $$\n\nSubstituting the initial and final conditions:\n\n$$ \\ln S(\\infty) - \\ln N = -\\frac{R_0}{N} (N - S(\\infty)) $$\n\nBy manipulating the arguments of the logarithm and factoring out $N$ on the right side:\n\n$$ \\ln \\left(\\frac{S(\\infty)}{N}\\right) = -R_0 \\left(1 - \\frac{S(\\infty)}{N}\\right) $$\n\nUsing the definition $s_{\\infty} = S(\\infty)/N$, we arrive at the final size equation:\n\n$$ \\ln s_{\\infty} = -R_0 (1 - s_{\\infty}) $$\n\nRearranging this gives the transcendental equation in the form $f(s_{\\infty}, R_0) = 0$:\n\n$$ \\ln s_{\\infty} + R_0 (1 - s_{\\infty}) = 0 $$\n\nTherefore, the function is $f(s_{\\infty}, R_0) = \\ln s_{\\infty} + R_0(1-s_{\\infty})$.",
            "answer": "$$\\boxed{\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)}$$"
        },
        {
            "introduction": "Deterministic SIR models describe the average behavior of an epidemic in a very large population, but they miss the inherent randomness of individual infection and recovery events. This practice serves as a gateway to the more realistic stochastic framework, where you will model the epidemic as a Continuous-Time Markov Chain (CTMC). The challenge is to construct the master equation, which governs the evolution of the probability of the system being in any given state, providing a complete probabilistic description of the dynamics .",
            "id": "4149054",
            "problem": "Consider a stochastic Susceptible–Infectious–Recovered (SIR) epidemic in a well-mixed closed population of size $N$, with state $(S,I,R)$ taking values in $\\{0,1,\\dots,N\\}^3$ subject to $S+I+R=N$. The Susceptible–Infectious–Recovered (SIR) process is modeled as a Continuous-Time Markov Chain (CTMC), with two event types: infection and recovery. The infection event updates the state from $(S,I,R)$ to $(S-1,I+1,R)$ and occurs with propensity $\\beta S I / N$, while the recovery event updates the state from $(S,I,R)$ to $(S,I-1,R+1)$ and occurs with propensity $\\gamma I$, where $\\beta0$ and $\\gamma0$ are fixed parameters. Let $P(S,I,R,t)$ denote the probability mass function of the CTMC at time $t\\ge 0$. Using only the definitions of CTMC transition rates and their associated state updates, select the option that correctly gives the forward master equation for $P(S,I,R,t)$ as a balance of probability fluxes into and out of the state $(S,I,R)$.\n\nA:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\frac{\\beta}{N}\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;+\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;-\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t),$$\nwith the convention that $P(\\cdot)=0$ whenever any argument is outside $\\{0,1,\\dots,N\\}$ or violates $S+I+R=N$.\n\nB:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\frac{\\beta}{N}\\,(S-1)(I+1)\\,P(S-1,I+1,R,t) \\;+\\; \\gamma\\,(I-1)\\,P(S,I-1,R+1,t) \\;-\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$\n\nC:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\beta\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;+\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;-\\; \\left[\\beta\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$\n\nD:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; -\\frac{\\beta}{N}\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;-\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;+\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$",
            "solution": "The master equation describes the time evolution of the probability $P(S,I,R,t)$ of the system being in state $(S,I,R)$ at time $t$. The rate of change of this probability is the sum of probability fluxes into the state minus the sum of probability fluxes out of the state.\n\n**1. Flux Out of State $(S,I,R)$**\nThe system leaves state $(S,I,R)$ via two possible events:\n-   **Infection**: The state changes from $(S,I,R)$ to $(S-1,I+1,R)$. The rate (propensity) of this event is $\\frac{\\beta S I}{N}$.\n-   **Recovery**: The state changes from $(S,I,R)$ to $(S,I-1,R+1)$. The rate (propensity) of this event is $\\gamma I$.\nThe total flux out is the sum of these rates multiplied by the probability of being in state $(S,I,R)$:\n$$ \\text{Flux Out} = \\left(\\frac{\\beta S I}{N} + \\gamma I\\right) P(S,I,R,t) $$\n\n**2. Flux Into State $(S,I,R)$**\nThe system can enter state $(S,I,R)$ from two other states:\n-   **Via an infection**: The system enters state $(S,I,R)$ if it was previously in state $(S+1,I-1,R)$ and an infection occurred. The rate for an infection starting from state $(S+1,I-1,R)$ is $\\frac{\\beta (S+1) (I-1)}{N}$. The flux from this path is this rate times the probability of being in the source state: $\\frac{\\beta (S+1) (I-1)}{N} P(S+1,I-1,R,t)$.\n-   **Via a recovery**: The system enters state $(S,I,R)$ if it was previously in state $(S,I+1,R-1)$ and a recovery occurred. The rate for a recovery starting from state $(S,I+1,R-1)$ is $\\gamma(I+1)$. The flux from this path is $\\gamma(I+1) P(S,I+1,R-1,t)$.\n\n**3. Assembling the Equation**\nCombining the terms (Flux In - Flux Out), we have:\n$$ \\frac{\\partial P(S,I,R,t)}{\\partial t} = \\frac{\\beta}{N}(S+1)(I-1)P(S+1,I-1,R,t) + \\gamma(I+1)P(S,I+1,R-1,t) - \\left(\\frac{\\beta S I}{N} + \\gamma I\\right) P(S,I,R,t) $$\nThis matches option A.\n-   Option B incorrectly identifies the source states for the influx terms.\n-   Option C omits the $1/N$ scaling factor required for density-dependent transmission.\n-   Option D has the signs for the flux terms reversed.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While the master equation provides a complete theoretical description, it is typically impossible to solve analytically for non-trivial systems. This practice introduces the canonical computational method for exploring the model's behavior: the Gillespie Stochastic Simulation Algorithm (SSA). You will be tasked with correctly assembling the algorithm's steps, which involves calculating reaction propensities, sampling the waiting time for the next event, and probabilistically selecting which reaction occurs, thereby generating an exact realization of the stochastic process .",
            "id": "4149082",
            "problem": "Consider a well-mixed Susceptible–Infectious–Recovered (SIR) epidemic in continuous time, at population level $N$, with state variables $(S,I,R)$ satisfying $S+I+R=N$. The model has two reaction channels: infection, which moves one unit from $S$ to $I$, and recovery, which moves one unit from $I$ to $R$. Assume density-dependent mass-action transmission with parameters $\\beta0$ and $\\gamma0$, and that the process is a Continuous-Time Markov Chain (CTMC) with state-dependent transition intensities determined by mass-action kinetics. The Stochastic Simulation Algorithm (SSA), also known as the Gillespie direct method, advances the CTMC by sampling the waiting time to the next reaction and selecting which reaction occurs, conditioned on the current state.\n\nWhich option correctly specifies, in full and in correct order, the Gillespie direct method steps for simulating one iteration of this stochastic SIR process under density-dependent mass-action transmission, including event selection based on cumulative propensities and time increments drawn from an exponential distribution whose rate equals the total propensity?\n\nA. Compute propensities $a_1=\\beta S I/N$ for infection and $a_2=\\gamma I$ for recovery, set $a_0=a_1+a_2$. Draw $u_1\\sim \\text{Uniform}(0,1)$ and set $\\tau=-\\ln(u_1)/a_0$. Draw $u_2\\sim \\text{Uniform}(0,1)$, compute the threshold $u_2 a_0$, and select infection if $u_2 a_0 a_1$, otherwise select recovery. If infection, update $(S,I,R)\\leftarrow(S-1,I+1,R)$; if recovery, update $(S,I,R)\\leftarrow(S,I-1,R+1)$. Advance time by $t\\leftarrow t+\\tau$.\n\nB. Compute propensities $a_1=\\beta S I$ and $a_2=\\gamma I$, set $a_0=a_1+a_2$. Draw $u\\sim \\text{Uniform}(0,1)$ and set $\\tau=\\ln(u)/a_0$. Select the event by comparing $u$ to the normalized cumulative propensities: if $u\\leq a_1/a_0$ choose recovery, else choose infection. Update the corresponding compartment counts and advance time by $t\\leftarrow t+\\tau$.\n\nC. Compute propensities $a_1=\\beta S I/N$ and $a_2=\\gamma I$, set $a_0=\\max\\{a_1,a_2\\}$. Draw the time increment $\\tau$ from $\\text{Exp}(a_0)$, then draw $u\\sim \\text{Uniform}(0,1)$ and choose infection if $u a_2/a_0$, otherwise choose recovery. Update the state accordingly and advance time.\n\nD. Compute propensities $a_1=\\beta S I/N$ and $a_2=\\gamma I$, set $a_0=a_1+a_2$. Draw $u_1\\sim \\text{Uniform}(0,1)$ and set $\\tau=1/a_0$. Draw $u_2\\sim \\text{Uniform}(0,1)$ and select infection if $u_2 a_1/a_0$, otherwise select recovery. Update the state and time $t\\leftarrow t+\\tau$.",
            "solution": "The Gillespie Stochastic Simulation Algorithm (SSA) simulates an exact trajectory of a Continuous-Time Markov Chain. For the SIR model specified, one iteration involves the following steps:\n\n1.  **Compute Propensities:** Given the current state $(S, I, R)$, calculate the propensity (rate) for each possible event.\n    *   Infection ($S \\to I$): $a_1 = \\beta S I/N$. This is the \"density-dependent\" rate specified.\n    *   Recovery ($I \\to R$): $a_2 = \\gamma I$. This is a standard first-order process.\n\n2.  **Compute Total Propensity:** Sum the individual propensities to get the total rate of any event occurring: $a_0 = a_1 + a_2 = (\\beta S I/N) + \\gamma I$.\n\n3.  **Sample Waiting Time ($\\tau$):** The time until the next event is a random variable drawn from an exponential distribution with rate $a_0$. Using a uniform random number $u_1 \\sim \\text{Uniform}(0,1)$, this time is calculated as $\\tau = -\\frac{\\ln(u_1)}{a_0}$.\n\n4.  **Select Next Event:** Determine which event occurs next. The probability of event $j$ occurring is $a_j/a_0$. Using a second uniform random number $u_2 \\sim \\text{Uniform}(0,1)$, we select the event:\n    *   If $u_2 \\cdot a_0  a_1$, the event is **infection**.\n    *   Otherwise (i.e., $a_1 \\le u_2 \\cdot a_0  a_1+a_2$), the event is **recovery**.\n\n5.  **Update State and Time:** Update the state variables according to the chosen event and advance the simulation time.\n    *   If infection: $(S, I, R) \\leftarrow (S-1, I+1, R)$.\n    *   If recovery: $(S, I, R) \\leftarrow (S, I-1, R+1)$.\n    *   Advance time: $t \\leftarrow t + \\tau$.\n\nAnalyzing the options:\n-   **A:** Correctly implements all five steps as described above.\n-   **B:** Incorrectly uses the propensity $a_1=\\beta S I$ (standard mass-action, not density-dependent), calculates the time step with the wrong sign ($\\tau = \\ln(u)/a_0$), and inverts the event selection logic.\n-   **C:** Incorrectly calculates the total propensity as $a_0=\\max\\{a_1,a_2\\}$ instead of the sum.\n-   **D:** Incorrectly uses a deterministic time step $\\tau = 1/a_0$ (the mean waiting time) instead of drawing a random value from the exponential distribution. This is characteristic of an approximate algorithm, not the exact SSA.\n\nTherefore, option A provides the correct and complete description of the algorithm.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}