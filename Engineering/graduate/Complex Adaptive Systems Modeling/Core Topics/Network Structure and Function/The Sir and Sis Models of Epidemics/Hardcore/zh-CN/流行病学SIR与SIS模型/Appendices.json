{
    "hands_on_practices": [
        {
            "introduction": "对于公共卫生规划而言，预测疫情何时达到顶峰至关重要。通过分析SIR模型中感染人数的变化率，我们可以确定感染人数达到最大值时的条件。这个练习将引导你通过设置 $\\frac{dI}{dt} = 0$ 来推导出这一关键阈值，它揭示了在一个群体中，当易感人群的比例下降到何种程度时，疫情的增长将停止并开始衰退 。",
            "id": "1707388",
            "problem": "一个流行病学团队正在为一个总人口为 $N$ 的小型孤立社区中一种新型非致命性病毒的传播建立模型。所使用的模型是经典的易感-感染-康复（SIR）模型，该模型在任意时刻 $t$ 将人群分为三个仓室：\n- $S(t)$: 对病毒易感的个体数量。\n- $I(t)$: 当前具有传染性的个体数量。\n- $R(t)$: 已经康复并现在具有免疫力的个体数量。\n\n总人口保持不变，即 $S(t) + I(t) + R(t) = N$。传播的动力学由以下耦合常微分方程组决定：\n$$\n\\frac{dS}{dt} = - \\frac{\\beta}{N} S I\n$$\n$$\n\\frac{dI}{dt} = \\frac{\\beta}{N} S I - \\gamma I\n$$\n$$\n\\frac{dR}{dt} = \\gamma I\n$$\n此处，$\\beta$ 是有效接触率，表示一个感染者在单位时间内与易感人群发生的导致感染的平均接触次数。参数 $\\gamma$ 是恢复率，使得 $1/\\gamma$ 表示传染期的平均持续时间。假设疫情始于一个主要由易感人群构成的群体中的少数感染者，导致活跃感染人数上升并最终下降。\n\n公共卫生规划的一个关键指标是疫情的高峰，它对应于同时感染的最大人数。确定在感染者数量 $I(t)$ 达到其最大值的那一刻，易感个体的数量 $S(t)$。用模型参数 $\\beta$、$\\gamma$ 和总人口 $N$ 的符号表达式来表示你的答案。",
            "solution": "给定总人口为常数 $N$ 的 SIR 系统及其动力学\n$$\n\\frac{dS}{dt} = - \\frac{\\beta}{N} S I, \\quad\n\\frac{dI}{dt} = \\frac{\\beta}{N} S I - \\gamma I, \\quad\n\\frac{dR}{dt} = \\gamma I.\n$$\n我们要求解 $I(t)$ 达到其最大值时的 $S(t)$。$I(t)$ 在某个时刻 $t^{\\ast}$ 具有局部极值的必要条件是 $\\frac{dI}{dt}(t^{\\ast})=0$。使用 $\\frac{dI}{dt}$ 的表达式，我们写出\n$$\n\\frac{dI}{dt} = I\\left(\\frac{\\beta}{N} S - \\gamma\\right).\n$$\n根据假设，在峰值时 $I(t^{\\ast})>0$（非平凡的、有起有落的疫情），因此令 $\\frac{dI}{dt}(t^{\\ast})=0$ 意味着\n$$\n\\frac{\\beta}{N} S(t^{\\ast}) - \\gamma = 0.\n$$\n求解 $S(t^{\\ast})$ 得到\n$$\nS(t^{\\ast}) = \\frac{\\gamma N}{\\beta}.\n$$\n这就是在感染人数达到最大值的时刻，易感者的数量。",
            "answer": "$$\\boxed{\\frac{\\gamma N}{\\beta}}$$"
        },
        {
            "introduction": "在分析疫情的整体影响时，一个核心问题是最终会有多少人被感染。这个练习将超越瞬时动态，探索疫情的长期后果。你将推导出连接基本再生数 ($R_0$) 和最终未感染人群比例 ($s_{\\infty}$) 的著名“最终规模方程”，这是一个强大的工具，用于预测疫情结束后从未被感染的人口比例 。",
            "id": "1707353",
            "problem": "一位流行病学家正在分析一个在大型、孤立人群中发生的自限性病毒爆发。病毒的传播可以很好地用简单的易感-感染-康复 (SIR) 模型来描述。易感者数量 $S(t)$、感染者数量 $I(t)$ 和康复者数量 $R(t)$ 随时间 $t$ 的动态变化由以下微分方程组决定：\n\n$$ \n\\begin{aligned}\n\\frac{dS}{dt} = -\\beta S I \\\\ \n\\frac{dI}{dt} = \\beta S I - \\gamma I \\\\ \n\\frac{dR}{dt} = \\gamma I \n\\end{aligned}\n$$\n\n此处，$\\beta$ 是有效传播率参数，而 $\\gamma$ 是平均恢复率。总人口 $N = S(t) + I(t) + R(t)$ 保持不变。在爆发初期 ($t=0$)，只有极少数个体被感染，因此我们可以做出标准近似，即初始感染者数量 $I(0) \\approx 0$ 且初始易感者数量 $S(0) \\approx N$。\n\n流行病学中的一个关键指标是基本再生数 $R_0$，在该模型中定义为 $R_0 = \\frac{\\beta N}{\\gamma}$。另一个重要量是最终从未感染该疾病的人口比例，记作 $s_{\\infty} = \\frac{S(\\infty)}{N}$，其中 $S(\\infty)$ 是当 $t \\to \\infty$ 时的易感者数量。\n\n存在一个连接 $s_{\\infty}$ 和 $R_0$ 的基本超越关系。该关系可以写成 $f(s_{\\infty}, R_0) = 0$ 的形式。请确定函数 $f(s_{\\infty}, R_0)$ 的表达式。",
            "solution": "我们从 SIR 模型开始：\n$$\n\\begin{aligned}\n\\frac{dS}{dt} = -\\beta S I \\\\\n\\frac{dI}{dt} = \\beta S I-\\gamma I \\\\\n\\frac{dR}{dt} = \\gamma I\n\\end{aligned}\n$$\n总人口 $N=S+I+R$ 保持不变。为了得到最终规模关系，我们通过将 $\\frac{dS}{dt}$ 除以 $\\frac{dR}{dt}$ 来消去时间：\n$$\n\\frac{dS}{dR} = \\frac{dS/dt}{dR/dt} = \\frac{-\\beta S I}{\\gamma I} = -\\frac{\\beta}{\\gamma}S\n$$\n分离变量并从爆发开始到结束进行积分。使用 $S(0)\\approx N$ 和 $R(0)\\approx 0$，并注意到当 $t\\to\\infty$ 时，我们有 $I(\\infty)=0$，因此 $R(\\infty)=N-S(\\infty)$，我们得到：\n$$\n\\int_{S(0)}^{S(\\infty)}\\frac{dS}{S} = -\\frac{\\beta}{\\gamma}\\int_{R(0)}^{R(\\infty)}dR\n$$\n$$\n\\implies \\ln S(\\infty)-\\ln S(0) = -\\frac{\\beta}{\\gamma}\\bigl(R(\\infty)-R(0)\\bigr)\n$$\n代入 $S(0)=N$、$R(0)=0$ 和 $R(\\infty)=N-S(\\infty)$：\n$$\n\\ln S(\\infty)-\\ln N = -\\frac{\\beta}{\\gamma}\\bigl(N-S(\\infty)\\bigr)\n$$\n定义 $s_{\\infty}=\\frac{S(\\infty)}{N}$ 并使用 $R_{0}=\\frac{\\beta N}{\\gamma}$ 将该关系重写为：\n$$\n\\ln s_{\\infty} = -R_{0}\\bigl(1-s_{\\infty}\\bigr)\n$$\n这等价于超越方程：\n$$\n\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)=0\n$$\n因此，$f$ 的一个有效选择是：\n$$\nf(s_{\\infty},R_{0})=\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)\n$$",
            "answer": "$$\\boxed{\\ln s_{\\infty}+R_{0}\\bigl(1-s_{\\infty}\\bigr)}$$"
        },
        {
            "introduction": "经典的SIR模型使用常微分方程，描述了大量人群中的平均行为，但在现实世界中，尤其是在小规模群体中，随机性扮演着至关重要的角色。本练习将引导你从确定性框架过渡到更精确的随机框架。你将为随机SIR模型构建主方程，这是一个描述系统在任意时刻处于特定状态 $(S, I, R)$ 的概率如何随时间演变的方程，它是理解流行病中随机波动和灭绝可能性的基石 。",
            "id": "4149054",
            "problem": "考虑一个在大小为 $N$ 的均匀混合封闭种群中的随机易感-感染-康复 (SIR) 传染病模型，其状态 $(S,I,R)$ 在 $\\{0,1,\\dots,N\\}^3$ 中取值，且满足 $S+I+R=N$。此易感-感染-康复 (SIR) 过程被建模为连续时间马尔可夫链 (CTMC)，有两种事件类型：感染和康复。感染事件将状态从 $(S,I,R)$ 更新为 $(S-1,I+1,R)$，发生的倾向率为 $\\beta S I / N$；而康复事件将状态从 $(S,I,R)$ 更新为 $(S,I-1,R+1)$，发生的倾向率为 $\\gamma I$，其中 $\\beta0$ 和 $\\gamma0$ 是固定参数。设 $P(S,I,R,t)$ 表示在时间 $t\\ge 0$ 时 CTMC 的概率质量函数。请仅使用 CTMC 转移速率及其相关状态更新的定义，选择能正确给出 $P(S,I,R,t)$ 的前向主方程的选项，该方程表示为流入和流出状态 $(S,I,R)$ 的概率流的平衡。\n\nA:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\frac{\\beta}{N}\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;+\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;-\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t),$$\n约定当任何参数超出 $\\{0,1,\\dots,N\\}$ 范围或违反 $S+I+R=N$ 时，$P(\\cdot)=0$。\n\nB:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\frac{\\beta}{N}\\,(S-1)(I+1)\\,P(S-1,I+1,R,t) \\;+\\; \\gamma\\,(I-1)\\,P(S,I-1,R+1,t) \\;-\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$\n\nC:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; \\beta\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;+\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;-\\; \\left[\\beta\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$\n\nD:\n$$\\frac{\\partial}{\\partial t} P(S,I,R,t) \\;=\\; -\\frac{\\beta}{N}\\,(S+1)(I-1)\\,P(S+1,I-1,R,t) \\;-\\; \\gamma\\,(I+1)\\,P(S,I+1,R-1,t) \\;+\\; \\left[\\frac{\\beta}{N}\\,S I \\;+\\; \\gamma\\,I\\right] P(S,I,R,t).$$",
            "solution": "主方程描述了系统处于特定状态的概率随时间的变化。状态 $(S,I,R)$ 的概率 $P(S,I,R,t)$ 的变化率等于流入该状态的总概率流减去流出该状态的总概率流。\n$$\n\\frac{\\partial P(S,I,R,t)}{\\partial t} = (\\text{流入项}) - (\\text{流出项})\n$$\n**1. 流出项 (Outflow):**\n系统可以通过两种事件离开状态 $(S,I,R)$:\n-   **感染**: 状态变为 $(S-1, I+1, R)$，发生速率为 $\\frac{\\beta S I}{N}$。\n-   **康复**: 状态变为 $(S, I-1, R+1)$，发生速率为 $\\gamma I$。\n因此，总的流出概率流为：\n$$ \\text{流出项} = \\left(\\frac{\\beta S I}{N} + \\gamma I\\right) P(S,I,R,t) $$\n\n**2. 流入项 (Inflow):**\n系统可以通过两种事件进入状态 $(S,I,R)$:\n-   **通过感染**: 系统从状态 $(S+1, I-1, R)$ 发生感染事件进入 $(S,I,R)$。该转移的速率为 $\\frac{\\beta (S+1)(I-1)}{N}$。\n-   **通过康复**: 系统从状态 $(S, I+1, R-1)$ 发生康复事件进入 $(S,I,R)$。该转移的速率为 $\\gamma(I+1)$。\n因此，总的流入概率流为：\n$$ \\text{流入项} = \\frac{\\beta(S+1)(I-1)}{N} P(S+1,I-1,R,t) + \\gamma(I+1) P(S,I+1,R-1,t) $$\n\n**3. 组合方程:**\n将流入项和流出项组合，我们得到主方程：\n$$ \\frac{\\partial P(S,I,R,t)}{\\partial t} = \\frac{\\beta(S+1)(I-1)}{N} P(S+1,I-1,R,t) + \\gamma(I+1) P(S,I+1,R-1,t) - \\left(\\frac{\\beta S I}{N} + \\gamma I\\right) P(S,I,R,t) $$\n重新排列后，这与选项 A 完全匹配。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}