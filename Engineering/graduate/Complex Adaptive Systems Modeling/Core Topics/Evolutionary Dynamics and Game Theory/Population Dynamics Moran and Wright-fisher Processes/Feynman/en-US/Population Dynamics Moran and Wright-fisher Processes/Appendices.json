{
    "hands_on_practices": [
        {
            "introduction": "This practice goes to the heart of connecting microscopic events to macroscopic dynamics. By analyzing the Moran process step-by-step, you will derive the expected change in allele frequency due to weak selection, a quantity known as the drift coefficient. This fundamental exercise  demonstrates how the deterministic force of selection emerges from the underlying stochastic birth-death events.",
            "id": "4137004",
            "problem": "Consider a well-mixed finite population of constant size $N$ evolving according to the Moran birth-death process. There are two types, $A$ and $B$. At each microscopic step, one individual is chosen for reproduction with probability proportional to its fitness, and independently one individual is chosen uniformly at random to die and be replaced by the offspring of the chosen parent. Assume the fitnesses are $f_{A} = 1 + s$ and $f_{B} = 1$, with $|s| \\ll 1$ (weak selection). Let $i_{t}$ denote the number of type $A$ individuals at discrete time $t$ (measured in Moran steps), and let $x_{t} = i_{t}/N$ denote the corresponding frequency of type $A$.\n\nUsing only the process definition above, derive the conditional expectation $\\mathbb{E}[x_{t+1} - x_{t} \\mid x_{t}]$ to first order in $s$. Then, define the generation-rescaled drift as $b(x_{t}) := N\\,\\mathbb{E}[x_{t+1} - x_{t} \\mid x_{t}]$. Under weak selection and in the large-$N$ regime, show that $b(x_{t})$ admits an approximation that is accurate up to terms that vanish as $N \\to \\infty$. Provide the leading-order analytic expression for $b(x_{t})$ as a function of $s$ and $x_{t}$, valid to first order in $s$ while neglecting terms that are of order $1/N$ or smaller after this generation rescaling.\n\nYour final answer must be a single closed-form analytic expression in $s$ and $x_{t}$. No numerical rounding is required.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to derive a unique solution. We may proceed with the derivation.\n\nLet the state of the population at time $t$ be described by the number of type $A$ individuals, denoted by $i_t$. The total population size is constant at $N$. The number of type $B$ individuals is thus $N-i_t$. The frequency of type $A$ is $x_t = i_t/N$. The fitnesses are given as $f_A = 1+s$ and $f_B = 1$. The selection coefficient $s$ is assumed to be small, i.e., $|s| \\ll 1$.\n\nThe Moran process as described consists of two independent events at each time step: reproduction and death.\n\nFirst, we determine the probability of choosing an individual for reproduction. This choice is proportional to fitness. The total fitness of the population is the sum of the fitnesses of all individuals:\n$$ W = i_t f_A + (N-i_t) f_B = i_t (1+s) + (N-i_t) (1) = i_t + i_t s + N - i_t = N + i_t s $$\nThe probability of selecting a type $A$ individual for reproduction is:\n$$ P(\\text{parent is } A) = \\frac{i_t f_A}{W} = \\frac{i_t(1+s)}{N + i_t s} $$\nThe probability of selecting a type $B$ individual for reproduction is:\n$$ P(\\text{parent is } B) = \\frac{(N-i_t) f_B}{W} = \\frac{N-i_t}{N + i_t s} $$\n\nSecond, an individual is chosen uniformly at random to die. The probability that a type $A$ individual is chosen to die is $i_t/N$, and the probability that a type $B$ individual is chosen is $(N-i_t)/N$.\n\nThe number of type $A$ individuals, $i_t$, can change by $+1$, $-1$, or $0$.\nThe number increases by one ($i_t \\to i_t + 1$) if a type $A$ individual reproduces and a type $B$ individual dies. Since these events are independent, the probability of this transition, $T^+(i_t)$, is:\n$$ T^+(i_t) = P(\\text{parent is } A) \\times P(\\text{death is } B) = \\frac{i_t(1+s)}{N + i_t s} \\cdot \\frac{N-i_t}{N} $$\nThe number decreases by one ($i_t \\to i_t - 1$) if a type $B$ individual reproduces and a type $A$ individual dies. The probability of this transition, $T^-(i_t)$, is:\n$$ T^-(i_t) = P(\\text{parent is } B) \\times P(\\text{death is } A) = \\frac{N-i_t}{N + i_t s} \\cdot \\frac{i_t}{N} $$\nThe number remains unchanged ($i_t \\to i_t$) in all other cases.\n\nThe conditional expectation of the change in the number of $A$ individuals in one step, $\\Delta i_t = i_{t+1} - i_t$, is:\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = (+1) \\cdot T^+(i_t) + (-1) \\cdot T^-(i_t) + (0) \\cdot (1 - T^+(i_t) - T^-(i_t)) $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = T^+(i_t) - T^-(i_t) = \\frac{i_t(1+s)(N-i_t)}{N(N + i_t s)} - \\frac{(N-i_t)i_t}{N(N + i_t s)} $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{i_t(N-i_t)}{N(N + i_t s)} \\left[ (1+s) - 1 \\right] = \\frac{s i_t(N-i_t)}{N(N + i_t s)} $$\nNow, we find the conditional expectation of the change in frequency, $x_{t+1} - x_t = \\Delta x_t = \\Delta i_t / N$.\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{1}{N} \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{s i_t(N-i_t)}{N^2(N + i_t s)} $$\nSubstituting $i_t = N x_t$:\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{s (N x_t)(N - N x_t)}{N^2(N + N x_t s)} = \\frac{s N^2 x_t(1-x_t)}{N^2 \\cdot N(1 + x_t s)} = \\frac{s x_t(1-x_t)}{N(1 + x_t s)} $$\nThis is the exact expression for the conditional expected change in frequency. The problem asks for this expression to first order in $s$. For $|s| \\ll 1$, we have $|x_t s| \\ll 1$, so we can use the geometric series expansion $\\frac{1}{1+y} \\approx 1 - y$ for small $y$.\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} (1 - x_t s) = \\frac{s x_t(1-x_t)}{N} - \\frac{s^2 x_t^2(1-x_t)}{N} $$\nTo first order in $s$, we keep only the term linear in $s$:\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} $$\nNext, we define the generation-rescaled drift as $b(x_t) = N\\,\\mathbb{E}[x_{t+1} - x_t \\mid x_t]$. Using the exact expression for the expected change in frequency, we obtain the exact expression for the drift:\n$$ b(x_t) = N \\left( \\frac{s x_t(1-x_t)}{N(1+x_t s)} \\right) = \\frac{s x_t(1-x_t)}{1+x_t s} $$\nThis expression is exact and, for this specific Moran process, contains no terms of order $1/N$. Thus, the condition of neglecting such terms is satisfied trivially.\n\nFinally, we are asked to provide the leading-order analytic expression for $b(x_t)$ valid to first order in $s$. We perform a Taylor expansion of $b(x_t)$ around $s=0$:\n$$ b(x_t) = s x_t(1-x_t) (1+x_t s)^{-1} $$\nUsing the expansion $(1+y)^{-1} = 1 - y + y^2 - \\dots$, with $y = x_t s$:\n$$ b(x_t) = s x_t(1-x_t) (1 - x_t s + (x_t s)^2 - \\dots) $$\n$$ b(x_t) = s x_t(1-x_t) - s^2 x_t^2(1-x_t) + O(s^3) $$\nThe leading-order term is the term of lowest power in $s$, which is $s x_t(1-x_t)$. This is also the expression valid to first order in $s$, as it includes all terms up to and including the power $s^1$.\nThus, the required approximation for the drift coefficient is:\n$$ b(x_t) \\approx s x_t(1-x_t) $$\nThis result represents the deterministic change in allele frequency due to selection, which forms the drift part of the diffusion approximation used in population genetics.",
            "answer": "$$\n\\boxed{s x_{t}(1 - x_{t})}\n$$"
        },
        {
            "introduction": "Building upon the concept of drift, this practice expands our toolkit to the widely-used Wright-Fisher model. You will derive both the drift and diffusion coefficients that form the basis of the diffusion approximation, a powerful tool for studying allele frequency evolution. This exercise culminates in deriving one of the most celebrated results in population genetics: the probability that a new beneficial allele will ultimately fix in the population .",
            "id": "4136999",
            "problem": "Consider a discrete-generation Wright-Fisher (WF) model with two alleles, where the population size is $N$ and allele $A$ experiences genic selection with relative fitness $1+s$ against a baseline of $1$ for allele $a$. Let $x \\in [0,1]$ denote the allele-$A$ frequency before reproduction in a given generation, and let $X'$ denote the number of allele-$A$ copies after reproduction and sampling in the next generation. Assume the diffusion approximation is valid in the regime of weak selection and large population, and that time is measured in generations. Use the following foundational bases:\n- In one WF generation, $X' \\sim \\mathrm{Binomial}(N,p(x))$, where the sampling probability after selection is $p(x) = \\frac{x(1+s)}{1+s x}$.\n- The diffusion approximation identifies the drift $m(x)$ and the infinitesimal variance $v(x)$ from the first two conditional moments of the per-generation frequency increment $\\Delta x = X'/N - x$ to leading order in $s$ and $1/N$.\n- For an Itô diffusion on $[0,1]$ with drift $m(x)$ and instantaneous variance $v(x)$, the backward Kolmogorov operator acting on a twice continuously differentiable test function $f$ is of the form $\\mathcal{L} f(x)$, expressed in terms of $m(x)$, $v(x)$, and derivatives of $f$ with respect to $x$.\n\nTasks:\n1. Starting from $p(x) = \\frac{x(1+s)}{1+s x}$, derive the drift $m(x)$ and the variance $v(x)$ of the Wright-Fisher diffusion to leading order in $s$ and $1/N$, respectively.\n2. Using the general form of the backward Kolmogorov operator for one-dimensional Itô diffusions and your results from Task $1$, write the backward operator $\\mathcal{L}$ for this WF diffusion.\n3. Let $u(x)$ denote the probability that allele $A$ eventually fixes (i.e., reaches frequency $1$) starting from initial frequency $x \\in [0,1]$. Using the boundary value problem for fixation in the diffusion approximation, determine a closed-form analytic expression for $u(x)$ in terms of $x$, $N$, and $s$.\n\nYour final reported answer must be the single closed-form expression for $u(x)$. No rounding is required.",
            "solution": "The problem asks for the derivation of the fixation probability of a selected allele in a Wright-Fisher population, using the diffusion approximation. The solution proceeds in three main stages as per the tasks outlined: first, deriving the drift and variance coefficients for the diffusion process; second, constructing the backward Kolmogorov operator; and third, solving the resulting boundary value problem for the fixation probability.\n\n### Task 1: Derivation of Drift and Variance Coefficients\n\nThe diffusion approximation models the evolution of the allele frequency $x$ as a continuous stochastic process. The parameters of this process, the drift coefficient $m(x)$ and the infinitesimal variance (or diffusion coefficient) $v(x)$, are derived from the moments of the change in allele frequency over a single generation, $\\Delta x = X'/N - x$.\n\nLet $x$ be the frequency of allele $A$ in the current generation. After selection, the frequency of allele $A$ among the gametes that form the next generation is $p(x) = \\frac{x(1+s)}{1+s x}$. The number of $A$ alleles in the next generation, $X'$, is a binomial random variable drawn from $N$ trials with success probability $p(x)$, i.e., $X' \\sim \\mathrm{Binomial}(N, p(x))$.\n\nThe drift coefficient, $m(x)$, is the expected change in allele frequency per generation.\n$$m(x) = E[\\Delta x | x] = E\\left[\\frac{X'}{N} - x \\bigg| x\\right] = \\frac{E[X'|x]}{N} - x$$\nUsing the expectation of a binomial distribution, $E[X'|x] = Np(x)$, we have:\n$$m(x) = p(x) - x = \\frac{x(1+s)}{1+s x} - x = \\frac{x(1+s) - x(1+s x)}{1+s x} = \\frac{x+sx-x-sx^2}{1+s x} = \\frac{sx(1-x)}{1+s x}$$\nThe diffusion approximation is valid for weak selection, $s \\ll 1$. We expand $m(x)$ to the leading order in $s$. Since $(1+sx)^{-1} = 1 - sx + O(s^2)$, we get:\n$$m(x) = sx(1-x)(1 - sx + \\dots) = sx(1-x) + O(s^2)$$\nThus, to leading order in $s$, the drift coefficient is:\n$$m(x) = sx(1-x)$$\n\nThe infinitesimal variance, $v(x)$, is derived from the second moment of the change in allele frequency, $E[(\\Delta x)^2|x]$.\n$$v(x) = E[(\\Delta x)^2 | x] = E\\left[\\left(\\frac{X'}{N} - x\\right)^2 \\bigg| x\\right]$$\nWe can express this as $E[(\\Delta x)^2|x] = \\mathrm{Var}(\\Delta x|x) + (E[\\Delta x|x])^2$.\nThe variance of $\\Delta x$ is:\n$$\\mathrm{Var}(\\Delta x|x) = \\mathrm{Var}\\left(\\frac{X'}{N} - x \\bigg| x\\right) = \\frac{1}{N^2}\\mathrm{Var}(X'|x)$$\nUsing the variance of a binomial distribution, $\\mathrm{Var}(X'|x) = Np(x)(1-p(x))$, we have:\n$$\\mathrm{Var}(\\Delta x|x) = \\frac{Np(x)(1-p(x))}{N^2} = \\frac{p(x)(1-p(x))}{N}$$\nThe squared expectation term is $(E[\\Delta x|x])^2 = (m(x))^2 \\approx (sx(1-x))^2 = s^2x^2(1-x)^2$.\nSo, the second moment is:\n$$v(x) = \\frac{p(x)(1-p(x))}{N} + s^2x^2(1-x)^2$$\nIn the diffusion limit, we consider $N \\to \\infty$ and $s \\to 0$ such that $Ns$ is finite. This implies $s$ is of the order $O(1/N)$. Consequently, the term $s^2x^2(1-x)^2$ is of order $O(1/N^2)$. The first term, $\\frac{p(x)(1-p(x))}{N}$, is of order $O(1/N)$ because $p(x) \\approx x$. Therefore, the squared expectation term is of a lower order and can be neglected. To leading order in $1/N$, we approximate $p(x) \\approx x$:\n$$v(x) \\approx \\frac{x(1-x)}{N}$$\nSo, the required coefficients are $m(x) = sx(1-x)$ and $v(x) = \\frac{x(1-x)}{N}$.\n\n### Task 2: The Backward Kolmogorov Operator\n\nFor a one-dimensional Itô diffusion described by the stochastic differential equation $dX_t = m(X_t) dt + \\sqrt{v(X_t)} dW_t$, the generator, or backward Kolmogorov operator, $\\mathcal{L}$, acting on a twice continuously differentiable function $f(x)$ is given by:\n$$\\mathcal{L}f(x) = m(x)\\frac{df}{dx} + \\frac{1}{2}v(x)\\frac{d^2f}{dx^2}$$\nSubstituting the expressions for $m(x)$ and $v(x)$ derived in Task 1:\n$$\\mathcal{L}f(x) = sx(1-x)\\frac{df}{dx} + \\frac{1}{2}\\left(\\frac{x(1-x)}{N}\\right)\\frac{d^2f}{dx^2}$$\nThis is the backward operator for the Wright-Fisher diffusion with genic selection.\n\n### Task 3: Derivation of the Fixation Probability\n\nThe probability $u(x)$ that allele $A$ eventually fixes, starting from an initial frequency $x$, is the solution to the boundary value problem defined by the condition that $u(x)$ is a function for which the diffusion process is a martingale, i.e., $\\mathcal{L}u(x) = 0$, subject to the appropriate boundary conditions.\nThe differential equation is:\n$$sx(1-x)\\frac{du}{dx} + \\frac{x(1-x)}{2N}\\frac{d^2u}{dx^2} = 0$$\nThe boundary conditions are $u(0)=0$ (if the allele is absent, it cannot fix) and $u(1)=1$ (if the allele is already fixed, its probability of fixation is $1$).\n\nFor $x \\in (0,1)$, we can divide the equation by $x(1-x)$, which is non-zero in this interval:\n$$s\\frac{du}{dx} + \\frac{1}{2N}\\frac{d^2u}{dx^2} = 0$$\nRearranging gives a second-order linear homogeneous ordinary differential equation:\n$$\\frac{d^2u}{dx^2} = -2Ns \\frac{du}{dx}$$\nLet $y(x) = \\frac{du}{dx}$. The equation becomes a first-order ODE for $y(x)$:\n$$\\frac{dy}{dx} = -2Ns y$$\nThis is a separable equation: $\\frac{1}{y}dy = -2Ns dx$. Integrating both sides yields:\n$$\\ln|y| = -2Nsx + C_0$$\n$$y(x) = C_1 \\exp(-2Nsx)$$\nwhere $C_1$ is an arbitrary constant. Since $y(x) = \\frac{du}{dx}$, we integrate again to find $u(x)$:\n$$u(x) = \\int C_1 \\exp(-2Nsx) dx = C_1 \\left( \\frac{\\exp(-2Nsx)}{-2Ns} \\right) + C_2$$\nWe can write the general solution with two new constants, $A$ and $B$:\n$$u(x) = A\\exp(-2Nsx) + B$$\nWe now apply the boundary conditions to determine $A$ and $B$.\nFrom $u(0)=0$:\n$$0 = A\\exp(0) + B \\implies A + B = 0 \\implies B = -A$$\nFrom $u(1)=1$:\n$$1 = A\\exp(-2Ns) + B$$\nSubstituting $B=-A$:\n$$1 = A\\exp(-2Ns) - A = A(\\exp(-2Ns) - 1)$$\nSolving for $A$:\n$$A = \\frac{1}{\\exp(-2Ns) - 1}$$\nThen, $B$ is:\n$$B = -A = -\\frac{1}{\\exp(-2Ns) - 1} = \\frac{1}{1 - \\exp(-2Ns)}$$\nSubstituting $A$ and $B$ back into the solution for $u(x)$:\n$$u(x) = \\frac{1}{\\exp(-2Ns) - 1} \\exp(-2Nsx) + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{-\\exp(-2Nsx)}{1 - \\exp(-2Ns)} + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}$$\nThis is the closed-form expression for the fixation probability $u(x)$ for an allele with selection coefficient $s$ in a population of size $N$, starting at frequency $x$.",
            "answer": "$$\\boxed{\\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}}$$"
        },
        {
            "introduction": "Once an allele's fate—fixation or loss—is determined, how long does the journey take? This advanced practice tackles the conditional mean time to fixation, a crucial timescale in evolution, for a neutral allele. By solving a set of coupled boundary value problems , you will see how the diffusion framework can be extended to calculate not just the ultimate fate of an allele, but also the expected duration of its journey through the population.",
            "id": "4136932",
            "problem": "Consider a single-locus allele frequency process under the diffusion approximation of the Wright–Fisher model in a haploid population of constant effective size $N$, with no mutation and no selection (neutral drift). Let $X_{t} \\in [0,1]$ denote the frequency of allele $A$ at time $t$, and let $T$ be the first hitting time of the absorbing set $\\{0,1\\}$ by $X_{t}$. Assume the standard Wright–Fisher diffusion generator\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{1}{2N}\\, x(1-x)\\, f''(x),\n$$\nacting on twice continuously differentiable functions $f$ on $(0,1)$ with absorbing boundaries at $x=0$ and $x=1$. Let $h(x)$ denote the fixation probability of allele $A$ at $x=1$ starting from $X_{0}=x$, and define the conditional mean time to fixation at $x=1$ given that fixation occurs,\n$$\n\\tau_{\\text{fix}}(x) \\;=\\; \\mathbb{E}_{x}\\!\\left[T \\,\\big|\\, X_{T}=1\\right], \\quad x \\in (0,1).\n$$\n\nStarting from the generator $\\mathcal{L}$, Dynkin’s formula, and boundary value characterizations of hitting probabilities and expected hitting times for one-dimensional diffusions, derive and solve the appropriate coupled boundary value problems to obtain a closed-form analytical expression for $\\tau_{\\text{fix}}(x)$. Alternatively, you may use Doob’s $h$-transform to condition the process on fixation at $x=1$ and then compute the mean hitting time to $x=1$ under the transformed dynamics. Express your final answer as a single analytic expression in terms of $x$ and $N$. No numerical rounding is required, and no physical units are to be included in the final expression.",
            "solution": "The problem asks for the conditional mean time to fixation, $\\tau_{\\text{fix}}(x)$, for a neutral allele in a haploid population of constant effective size $N$, starting from an initial frequency $x$. This quantity is defined as $\\tau_{\\text{fix}}(x) = \\mathbb{E}_{x}[T | X_{T}=1]$, where $T$ is the first hitting time of the absorbing boundaries $\\{0,1\\}$.\n\nUsing the definition of conditional expectation, we can write $\\tau_{\\text{fix}}(x)$ as the ratio of two quantities:\n$$\n\\tau_{\\text{fix}}(x) = \\frac{\\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]}{\\mathbb{P}_{x}[X_{T}=1]}\n$$\nwhere $\\mathbb{I}_{\\{X_{T}=1\\}}$ is the indicator function for the event that the allele fixes at frequency $1$.\n\nLet us define the numerator and the denominator as separate functions of the initial frequency $x$:\n1. $h(x) = \\mathbb{P}_{x}[X_{T}=1]$: The probability of fixation at $1$.\n2. $k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$: The expectation of the product of the absorption time and the indicator of fixation at $1$.\n\nWe will find both $h(x)$ and $k(x)$ by solving the appropriate boundary value problems (BVPs) derived from the given Wright-Fisher diffusion generator, $\\mathcal{L} f(x) = \\frac{1}{2N} x(1-x) f''(x)$.\n\nFirst, we determine the fixation probability $h(x)$. For a one-dimensional diffusion, the probability of hitting one boundary before another is the solution to the backward Kolmogorov equation $\\mathcal{L}h(x) = 0$, with boundary conditions reflecting the outcome at the boundaries.\nThe BVP for $h(x)$ is:\n$$\n\\mathcal{L}h(x) = \\frac{1}{2N} x(1-x) h''(x) = 0, \\quad \\text{for } x \\in (0,1)\n$$\nwith boundary conditions:\n$$\nh(0) = 0 \\quad (\\text{fixation at 1 is impossible starting from 0}) \\\\\nh(1) = 1 \\quad (\\text{fixation at 1 is certain starting from 1})\n$$\nFor $x \\in (0,1)$, the equation simplifies to $h''(x) = 0$. The general solution is a linear function $h(x) = C_1 x + C_2$.\nApplying the boundary conditions:\n$h(0) = 0 \\implies C_1(0) + C_2 = 0 \\implies C_2 = 0$.\n$h(1) = 1 \\implies C_1(1) + 0 = 1 \\implies C_1 = 1$.\nThus, the fixation probability is $h(x) = x$. This is a classic result for neutral evolution.\n\nNext, we determine $k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$. We can derive a differential equation for $k(x)$ by considering the evolution of the process over a single generation. Let $X_1$ be the allele frequency after one generation, starting from $X_0 = x$. The quantity $k(x)$ must satisfy the recurrence relation:\n$$\nk(x) = \\mathbb{E}_{x}[h(X_1) + k(X_1)]\n$$\nwhere time is measured in generations. The term $h(X_1)$ arises because one generation passes (contributing $1$ to the time $T$) with probability $h(X_1)$ of eventual fixation. Rearranging and noting that $h(x)$ is a martingale ($\\mathbb{E}_x[h(X_1)]=h(x)$), we have $\\mathbb{E}_x[k(X_1) - k(x)] = -h(x)$.\nIn the diffusion limit, the left side corresponds to the generator $\\mathcal{L}$ acting on $k(x)$, where the time unit is one generation. Thus, $k(x)$ is the solution to the following Poisson-type equation:\n$$\n\\mathcal{L}k(x) = -h(x)\n$$\nSubstituting the expressions for $\\mathcal{L}$ and $h(x)$:\n$$\n\\frac{1}{2N} x(1-x) k''(x) = -x, \\quad \\text{for } x \\in (0,1)\n$$\nThe boundary conditions for $k(x)$ are determined by its definition. At the boundaries, the absorption time $T$ is $0$, so the expectation must be $0$:\n$$\nk(0) = 0 \\\\\nk(1) = 0\n$$\nFor $x \\in (0,1)$, we can divide the differential equation by $x$:\n$$\n\\frac{1}{2N} (1-x) k''(x) = -1\n$$\n$$\nk''(x) = -\\frac{2N}{1-x}\n$$\nWe integrate this equation twice to find $k(x)$. First integration yields $k'(x)$:\n$$\nk'(x) = \\int -\\frac{2N}{1-t} dt = 2N \\ln(1-x) + C_1\n$$\nSecond integration yields $k(x)$:\n$$\nk(x) = \\int (2N \\ln(1-t) + C_1) dt\n$$\nUsing integration by parts for $\\int \\ln(1-t) dt = -(1-t)\\ln(1-t) + (1-t)$, we get:\n$$\nk(x) = 2N \\left( -(1-x)\\ln(1-x) + (1-x) \\right) + C_1 x + C_2\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + C_1 x + C_2\n$$\nNow we apply the boundary conditions to find the constants $C_1$ and $C_2$.\nAt $x=0$:\n$k(0) = 0 \\implies -2N(1-0)\\ln(1-0) + 2N(1-0) + C_1(0) + C_2 = 0$.\nSince $\\ln(1)=0$, this gives $0 + 2N + C_2 = 0 \\implies C_2 = -2N$.\nAt $x=1$:\n$k(1) = 0$. We must evaluate the limit $\\lim_{x \\to 1} -2N(1-x)\\ln(1-x)$, which is $0$.\nSo, $0 = 0 + 2N(1-1) + C_1(1) + C_2 \\implies 0 = C_1 + C_2$.\nWith $C_2=-2N$, we find $C_1 = 2N$.\nSubstituting the constants back into the solution for $k(x)$:\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N - 2Nx + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x)\n$$\nFinally, we compute the conditional mean time to fixation, $\\tau_{\\text{fix}}(x)$:\n$$\n\\tau_{\\text{fix}}(x) = \\frac{k(x)}{h(x)} = \\frac{-2N(1-x)\\ln(1-x)}{x}\n$$\nThis expression gives the average time to fixation, in generations, given that fixation occurs, starting from an initial frequency $x$.",
            "answer": "$$\n\\boxed{-2N \\frac{1-x}{x} \\ln(1-x)}\n$$"
        }
    ]
}