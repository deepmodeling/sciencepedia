{
    "hands_on_practices": [
        {
            "introduction": "The Wright-Fisher model is a cornerstone of population genetics, but its assumption of binomial sampling can seem counter-intuitive. This exercise challenges you to explore the statistical foundation of this assumption by comparing it to the more realistic scenario of sampling without replacement . By analyzing the variance under both schemes, you will develop a rigorous understanding of why the simpler binomial model is justified and when it serves as an excellent approximation for the effects of genetic drift.",
            "id": "4136976",
            "problem": "A diploid, panmictic population of constant census size $N$ evolves in discrete, nonoverlapping generations under the Wright-Fisher (WF) assumptions. Let $A$ be a neutral allele with gametic frequency $p_t$ in generation $t$. The next generation is formed by randomly sampling $2N$ gametes to create $N$ zygotes. Consider two idealized sampling schemes for generating the count $X_{t+1}$ of allele $A$ among the $2N$ gene copies in generation $t+1$:\n- Scheme I: Gametes are drawn independently and identically from a well-mixed gamete pool, each draw being a Bernoulli trial with success probability $p_t$.\n- Scheme II: Gametes are drawn without replacement from a finite, well-mixed gamete pool of size $G$ that contains $K$ copies of allele $A$ with $K/G = p_t$, where $G \\gg 2N$.\n\nWhich option correctly identifies the variance of $X_{t+1}$ under each scheme and provides the correct justification for using the binomial form in the WF model’s gamete sampling?\n\nA. Under Scheme I, the variance is $2N p_t(1-p_t)$; under Scheme II, the variance is $2N p_t(1-p_t) \\frac{G-2N}{G-1}$. The binomial form is appropriate because meiosis produces a very large gamete pool ($G \\gg 2N$), making the finite-population correction close to $1$ and the draws effectively independent.\n\nB. Under Scheme I, the variance is $2N p_t(1-p_t) \\frac{G-2N}{G-1}$; under Scheme II, the variance is $2N p_t(1-p_t)$. The binomial form is appropriate because replacement does not affect variance when the pool is large.\n\nC. Under Scheme I, the variance is $2N p_t$; under Scheme II, the variance is $2N p_t(1-p_t) \\frac{2N-1}{G-1}$. The binomial form is appropriate because it reduces drift compared to sampling without replacement when $G$ is large.\n\nD. Under Scheme I, the variance is $2N p_t(1-p_t) \\frac{G}{G-1}$; under Scheme II, the variance is $2N p_t(1-p_t)$. The binomial form is appropriate because the correction factor diverges as $G \\to \\infty$, increasing genetic drift.\n\nE. Under Scheme I, the variance is $2N p_t(1-p_t)$; under Scheme II with $G=2N$, the variance is $0$, showing that only binomial sampling can generate drift. The binomial form is appropriate because sampling all parental gene copies without replacement eliminates randomness and therefore must be avoided in WF.",
            "solution": "The problem requires an analysis of the variance of allele counts under two distinct sampling schemes and a justification for the standard sampling method used in the Wright-Fisher (WF) model.\n\n**Problem Validation**\n\nThe problem statement is valid.\n1.  **Givens Extracted**:\n    *   Population: Diploid, panmictic, constant census size $N$.\n    *   Generations: Discrete, nonoverlapping.\n    *   Model context: Wright-Fisher (WF) assumptions.\n    *   Allele: Neutral allele $A$.\n    *   Frequency: Gametic frequency in generation $t$ is $p_t$.\n    *   Next generation sample size: $2N$ gametes.\n    *   Random variable: $X_{t+1}$, the count of allele $A$ in the sample of $2N$ gametes.\n    *   Scheme I: Sampling with replacement. $2N$ independent, identical Bernoulli trials with success probability $p_t$.\n    *   Scheme II: Sampling without replacement from a finite pool of size $G$ containing $K$ copies of allele $A$, where $K/G = p_t$ and $G \\gg 2N$.\n\n2.  **Validation Verdict**: The problem is scientifically grounded, well-posed, and objective. It deals with fundamental concepts of probability theory (binomial and hypergeometric distributions) as they apply to the foundational Wright-Fisher model of population genetics. The givens are self-consistent and sufficient to derive a unique answer. The terminology is precise and standard within the field. Therefore, the problem is valid.\n\n**Derivation and Analysis**\n\n**Scheme I: Sampling with Replacement**\n\nUnder this scheme, the $2N$ gametes that form generation $t+1$ are drawn independently from a conceptual infinite gamete pool where the frequency of allele $A$ is $p_t$. Each draw is a Bernoulli trial with two outcomes: drawing allele $A$ (success) with probability $p_t$, or drawing the alternative allele (failure) with probability $1-p_t$.\n\nThe total number of $A$ alleles, $X_{t+1}$, is the sum of outcomes of $2N$ independent and identically distributed Bernoulli trials. By definition, this means that the random variable $X_{t+1}$ follows a binomial distribution:\n$$ X_{t+1} \\sim \\mathrm{Bin}(n, p) $$\nwhere the number of trials is $n=2N$ and the probability of success is $p=p_t$.\n\nThe variance of a binomially distributed random variable is given by the formula $\\mathrm{Var}(X) = n p (1-p)$.\nSubstituting the parameters for Scheme I, we get:\n$$ \\mathrm{Var}(X_{t+1}) = 2N p_t (1 - p_t) $$\n\n**Scheme II: Sampling Without Replacement**\n\nUnder this scheme, the $2N$ gametes are drawn without replacement from a finite gamete pool of size $G$, which contains exactly $K$ copies of allele $A$. The frequency of allele $A$ in this pool is $p_t = K/G$.\n\nThe number of successes ($A$ alleles), $X_{t+1}$, in a sample of size $n$ drawn without replacement from a population of size $M$ containing $k$ total successes follows a hypergeometric distribution.\nHere, our parameters are:\n*   Population size: $M = G$\n*   Number of successes in population: $k = K = G p_t$\n*   Sample size: $n = 2N$\n\nThe variance of a hypergeometrically distributed random variable is given by the formula:\n$$ \\mathrm{Var}(X) = n \\frac{k}{M} \\left(1 - \\frac{k}{M}\\right) \\left(\\frac{M-n}{M-1}\\right) $$\nSubstituting the parameters for Scheme II and noting that $k/M = p_t$:\n$$ \\mathrm{Var}(X_{t+1}) = 2N p_t (1 - p_t) \\left(\\frac{G - 2N}{G - 1}\\right) $$\nThe term $\\left(\\frac{G - 2N}{G - 1}\\right)$ is known as the finite-population correction (FPC) factor. It accounts for the reduction in variance that occurs when sampling without replacement from a finite population, as each draw is not independent of the previous ones.\n\n**Justification for the Binomial Form in the WF Model**\n\nThe standard Wright-Fisher model assumes sampling with replacement, corresponding to Scheme I and the binomial distribution. From a biological standpoint, sampling without replacement (Scheme II) is more realistic, as a single gamete cannot be used to fertilize more than one zygote. The reason the binomial model is used is as an approximation. This approximation is justified under the assumption that the pool of gametes produced by the parental generation is vastly larger than the number of gametes sampled to create the next generation. In our notation, this is the condition $G \\gg 2N$.\n\nLet us examine the limit of the FPC as $G \\to \\infty$:\n$$ \\lim_{G \\to \\infty} \\left(\\frac{G - 2N}{G - 1}\\right) = \\lim_{G \\to \\infty} \\frac{G(1 - 2N/G)}{G(1 - 1/G)} = \\frac{1 - 0}{1 - 0} = 1 $$\nWhen $G$ is much larger than $2N$, the FPC is very close to $1$. Consequently, the variance under Scheme II (hypergeometric) approximates the variance under Scheme I (binomial):\n$$ \\mathrm{Var}_{\\mathrm{Hypergeometric}}(X_{t+1}) \\approx 2N p_t (1 - p_t) = \\mathrm{Var}_{\\mathrm{Binomial}}(X_{t+1}) $$\nThis convergence occurs because when drawing a small sample from a very large pool, the probability of drawing the same item more than once becomes negligible, and the change in the composition of the pool after each draw is insignificant. Thus, the draws are effectively independent, justifying the use of the binomial distribution as a mathematically convenient and accurate approximation.\n\n**Option-by-Option Analysis**\n\nA. Under Scheme I, the variance is $2N p_t(1-p_t)$; under Scheme II, the variance is $2N p_t(1-p_t) \\frac{G-2N}{G-1}$. The binomial form is appropriate because meiosis produces a very large gamete pool ($G \\gg 2N$), making the finite-population correction close to $1$ and the draws effectively independent.\n- The variance for Scheme I is correct.\n- The variance for Scheme II is correct.\n- The justification is correct. The condition $G \\gg 2N$ makes the FPC approach $1$, which means the hypergeometric sampling is well-approximated by binomial sampling (independent draws).\n- **Verdict: Correct.**\n\nB. Under Scheme I, the variance is $2N p_t(1-p_t) \\frac{G-2N}{G-1}$; under Scheme II, the variance is $2N p_t(1-p_t)$. The binomial form is appropriate because replacement does not affect variance when the pool is large.\n- The variances for Scheme I and Scheme II are swapped.\n- **Verdict: Incorrect.**\n\nC. Under Scheme I, the variance is $2N p_t$; under Scheme II, the variance is $2N p_t(1-p_t) \\frac{2N-1}{G-1}$. The binomial form is appropriate because it reduces drift compared to sampling without replacement when $G$ is large.\n- The variance for Scheme I is stated as $2N p_t$, which is the mean, not the variance.\n- The FPC for Scheme II is stated incorrectly.\n- The justification is backward; for any finite $G > 2N$, the FPC is less than $1$, meaning sampling *without* replacement (Scheme II) has *less* variance (less drift) than sampling *with* replacement (Scheme I). The binomial model represents a higher level of drift.\n- **Verdict: Incorrect.**\n\nD. Under Scheme I, the variance is $2N p_t(1-p_t) \\frac{G}{G-1}$; under Scheme II, the variance is $2N p_t(1-p_t)$. The binomial form is appropriate because the correction factor diverges as $G \\to \\infty$, increasing genetic drift.\n- The variance for Scheme I is incorrect; it does not contain a correction factor.\n- The variance for Scheme II is incorrect; it is missing the FPC.\n- The justification is incorrect; the FPC converges to $1$, it does not diverge.\n- **Verdict: Incorrect.**\n\nE. Under Scheme I, the variance is $2N p_t(1-p_t)$; under Scheme II with $G=2N$, the variance is $0$, showing that only binomial sampling can generate drift. The binomial form is appropriate because sampling all parental gene copies without replacement eliminates randomness and therefore must be avoided in WF.\n- The variance for Scheme I is correct. The claim that the variance under Scheme II is $0$ when $G=2N$ is also correct, as $\\frac{G-2N}{G-1} = \\frac{2N-2N}{2N-1} = 0$. However, the conclusion \"showing that only binomial sampling can generate drift\" is an overgeneralization from a specific edge case. Scheme II generates drift whenever $G > 2N$.\n- The justification is logically flawed. The WF model uses binomial sampling as an approximation for large $G$, not because a specific edge case of the alternative model ($G=2N$) is deterministic.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A central goal of evolutionary theory is to predict the fate of a new allele under the influence of selection and genetic drift. This practice guides you through the canonical derivation of the fixation probability for a selected allele using the diffusion approximation of the Wright-Fisher model . You will start by deriving the model's drift and diffusion coefficients and then use them to solve the relevant boundary value problem, yielding one of the most celebrated results in theoretical population genetics.",
            "id": "4136999",
            "problem": "Consider a discrete-generation Wright-Fisher (WF) model with two alleles, where the population size is $N$ and allele $A$ experiences genic selection with relative fitness $1+s$ against a baseline of $1$ for allele $a$. Let $x \\in [0,1]$ denote the allele-$A$ frequency before reproduction in a given generation, and let $X'$ denote the number of allele-$A$ copies after reproduction and sampling in the next generation. Assume the diffusion approximation is valid in the regime of weak selection and large population, and that time is measured in generations. Use the following foundational bases:\n- In one WF generation, $X' \\sim \\mathrm{Binomial}(N,p(x))$, where the sampling probability after selection is $p(x) = \\frac{x(1+s)}{1+s x}$.\n- The diffusion approximation identifies the drift $m(x)$ and the infinitesimal variance $v(x)$ from the first two conditional moments of the per-generation frequency increment $\\Delta x = X'/N - x$ to leading order in $s$ and $1/N$.\n- For an Itô diffusion on $[0,1]$ with drift $m(x)$ and instantaneous variance $v(x)$, the backward Kolmogorov operator acting on a twice continuously differentiable test function $f$ is of the form $\\mathcal{L} f(x)$, expressed in terms of $m(x)$, $v(x)$, and derivatives of $f$ with respect to $x$.\n\nTasks:\n1. Starting from $p(x) = \\frac{x(1+s)}{1+s x}$, derive the drift $m(x)$ and the variance $v(x)$ of the Wright-Fisher diffusion to leading order in $s$ and $1/N$, respectively.\n2. Using the general form of the backward Kolmogorov operator for one-dimensional Itô diffusions and your results from Task $1$, write the backward operator $\\mathcal{L}$ for this WF diffusion.\n3. Let $u(x)$ denote the probability that allele $A$ eventually fixes (i.e., reaches frequency $1$) starting from initial frequency $x \\in [0,1]$. Using the boundary value problem for fixation in the diffusion approximation, determine a closed-form analytic expression for $u(x)$ in terms of $x$, $N$, and $s$.\n\nYour final reported answer must be the single closed-form expression for $u(x)$. No rounding is required.",
            "solution": "The problem asks for the derivation of the fixation probability of a selected allele in a Wright-Fisher population, using the diffusion approximation. The solution proceeds in three main stages as per the tasks outlined: first, deriving the drift and variance coefficients for the diffusion process; second, constructing the backward Kolmogorov operator; and third, solving the resulting boundary value problem for the fixation probability.\n\n### Task 1: Derivation of Drift and Variance Coefficients\n\nThe diffusion approximation models the evolution of the allele frequency $x$ as a continuous stochastic process. The parameters of this process, the drift coefficient $m(x)$ and the infinitesimal variance (or diffusion coefficient) $v(x)$, are derived from the moments of the change in allele frequency over a single generation, $\\Delta x = X'/N - x$.\n\nLet $x$ be the frequency of allele $A$ in the current generation. After selection, the frequency of allele $A$ among the gametes that form the next generation is $p(x) = \\frac{x(1+s)}{1+s x}$. The number of $A$ alleles in the next generation, $X'$, is a binomial random variable drawn from $N$ trials with success probability $p(x)$, i.e., $X' \\sim \\mathrm{Binomial}(N, p(x))$.\n\nThe drift coefficient, $m(x)$, is the expected change in allele frequency per generation.\n$$m(x) = E[\\Delta x | x] = E\\left[\\frac{X'}{N} - x \\bigg| x\\right] = \\frac{E[X'|x]}{N} - x$$\nUsing the expectation of a binomial distribution, $E[X'|x] = Np(x)$, we have:\n$$m(x) = p(x) - x = \\frac{x(1+s)}{1+s x} - x = \\frac{x(1+s) - x(1+s x)}{1+s x} = \\frac{x+sx-x-sx^2}{1+s x} = \\frac{sx(1-x)}{1+s x}$$\nThe diffusion approximation is valid for weak selection, $s \\ll 1$. We expand $m(x)$ to the leading order in $s$. Since $(1+sx)^{-1} = 1 - sx + O(s^2)$, we get:\n$$m(x) = sx(1-x)(1 - sx + \\dots) = sx(1-x) + O(s^2)$$\nThus, to leading order in $s$, the drift coefficient is:\n$$m(x) = sx(1-x)$$\n\nThe infinitesimal variance, $v(x)$, is derived from the second moment of the change in allele frequency, $E[(\\Delta x)^2|x]$.\n$$v(x) = E[(\\Delta x)^2 | x] = E\\left[\\left(\\frac{X'}{N} - x\\right)^2 \\bigg| x\\right]$$\nWe can express this as $E[(\\Delta x)^2|x] = \\mathrm{Var}(\\Delta x|x) + (E[\\Delta x|x])^2$.\nThe variance of $\\Delta x$ is:\n$$\\mathrm{Var}(\\Delta x|x) = \\mathrm{Var}\\left(\\frac{X'}{N} - x \\bigg| x\\right) = \\frac{1}{N^2}\\mathrm{Var}(X'|x)$$\nUsing the variance of a binomial distribution, $\\mathrm{Var}(X'|x) = Np(x)(1-p(x))$, we have:\n$$\\mathrm{Var}(\\Delta x|x) = \\frac{Np(x)(1-p(x))}{N^2} = \\frac{p(x)(1-p(x))}{N}$$\nThe squared expectation term is $(E[\\Delta x|x])^2 = (m(x))^2 \\approx (sx(1-x))^2 = s^2x^2(1-x)^2$.\nSo, the second moment is:\n$$v(x) = \\frac{p(x)(1-p(x))}{N} + s^2x^2(1-x)^2$$\nIn the diffusion limit, we consider $N \\to \\infty$ and $s \\to 0$ such that $Ns$ is finite. This implies $s$ is of the order $O(1/N)$. Consequently, the term $s^2x^2(1-x)^2$ is of order $O(1/N^2)$. The first term, $\\frac{p(x)(1-p(x))}{N}$, is of order $O(1/N)$ because $p(x) \\approx x$. Therefore, the squared expectation term is of a lower order and can be neglected. To leading order in $1/N$, we approximate $p(x) \\approx x$:\n$$v(x) \\approx \\frac{x(1-x)}{N}$$\nSo, the required coefficients are $m(x) = sx(1-x)$ and $v(x) = \\frac{x(1-x)}{N}$.\n\n### Task 2: The Backward Kolmogorov Operator\n\nFor a one-dimensional Itô diffusion described by the stochastic differential equation $dX_t = m(X_t) dt + \\sqrt{v(X_t)} dW_t$, the generator, or backward Kolmogorov operator, $\\mathcal{L}$, acting on a twice continuously differentiable function $f(x)$ is given by:\n$$\\mathcal{L}f(x) = m(x)\\frac{df}{dx} + \\frac{1}{2}v(x)\\frac{d^2f}{dx^2}$$\nSubstituting the expressions for $m(x)$ and $v(x)$ derived in Task 1:\n$$\\mathcal{L}f(x) = sx(1-x)\\frac{df}{dx} + \\frac{1}{2}\\left(\\frac{x(1-x)}{N}\\right)\\frac{d^2f}{dx^2}$$\nThis is the backward operator for the Wright-Fisher diffusion with genic selection.\n\n### Task 3: Derivation of the Fixation Probability\n\nThe probability $u(x)$ that allele $A$ eventually fixes, starting from an initial frequency $x$, is the solution to the boundary value problem defined by the condition that $u(x)$ is a function for which the diffusion process is a martingale, i.e., $\\mathcal{L}u(x) = 0$, subject to the appropriate boundary conditions.\nThe differential equation is:\n$$sx(1-x)\\frac{du}{dx} + \\frac{x(1-x)}{2N}\\frac{d^2u}{dx^2} = 0$$\nThe boundary conditions are $u(0)=0$ (if the allele is absent, it cannot fix) and $u(1)=1$ (if the allele is already fixed, its probability of fixation is $1$).\n\nFor $x \\in (0,1)$, we can divide the equation by $x(1-x)$, which is non-zero in this interval:\n$$s\\frac{du}{dx} + \\frac{1}{2N}\\frac{d^2u}{dx^2} = 0$$\nRearranging gives a second-order linear homogeneous ordinary differential equation:\n$$\\frac{d^2u}{dx^2} = -2Ns \\frac{du}{dx}$$\nLet $y(x) = \\frac{du}{dx}$. The equation becomes a first-order ODE for $y(x)$:\n$$\\frac{dy}{dx} = -2Ns y$$\nThis is a separable equation: $\\frac{1}{y}dy = -2Ns dx$. Integrating both sides yields:\n$$\\ln|y| = -2Nsx + C_0$$\n$$y(x) = C_1 \\exp(-2Nsx)$$\nwhere $C_1$ is an arbitrary constant. Since $y(x) = \\frac{du}{dx}$, we integrate again to find $u(x)$:\n$$u(x) = \\int C_1 \\exp(-2Nsx) dx = C_1 \\left( \\frac{\\exp(-2Nsx)}{-2Ns} \\right) + C_2$$\nWe can write the general solution with two new constants, $A$ and $B$:\n$$u(x) = A\\exp(-2Nsx) + B$$\nWe now apply the boundary conditions to determine $A$ and $B$.\nFrom $u(0)=0$:\n$$0 = A\\exp(0) + B \\implies A + B = 0 \\implies B = -A$$\nFrom $u(1)=1$:\n$$1 = A\\exp(-2Ns) + B$$\nSubstituting $B=-A$:\n$$1 = A\\exp(-2Ns) - A = A(\\exp(-2Ns) - 1)$$\nSolving for $A$:\n$$A = \\frac{1}{\\exp(-2Ns) - 1}$$\nThen, $B$ is:\n$$B = -A = -\\frac{1}{\\exp(-2Ns) - 1} = \\frac{1}{1 - \\exp(-2Ns)}$$\nSubstituting $A$ and $B$ back into the solution for $u(x)$:\n$$u(x) = \\frac{1}{\\exp(-2Ns) - 1} \\exp(-2Nsx) + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{-\\exp(-2Nsx)}{1 - \\exp(-2Ns)} + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}$$\nThis is the closed-form expression for the fixation probability $u(x)$ for an allele with selection coefficient $s$ in a population of size $N$, starting at frequency $x$.",
            "answer": "$$\\boxed{\\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}}$$"
        },
        {
            "introduction": "Knowing the probability of an allele's fixation is only part of the story; understanding the timescale over which this occurs is equally important for evolutionary analysis. This exercise delves into the temporal dynamics of neutral evolution by tasking you with calculating the average time it takes for an allele to reach fixation, given that it is not lost from the population . By solving a pair of coupled boundary value problems, you will practice a powerful technique for computing conditional statistics of stochastic processes.",
            "id": "4136932",
            "problem": "Consider a single-locus allele frequency process under the diffusion approximation of the Wright–Fisher model in a haploid population of constant effective size $N$, with no mutation and no selection (neutral drift). Let $X_{t} \\in [0,1]$ denote the frequency of allele $A$ at time $t$, and let $T$ be the first hitting time of the absorbing set $\\{0,1\\}$ by $X_{t}$. Assume the standard Wright–Fisher diffusion generator\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{1}{2N}\\, x(1-x)\\, f''(x),\n$$\nacting on twice continuously differentiable functions $f$ on $(0,1)$ with absorbing boundaries at $x=0$ and $x=1$. Let $h(x)$ denote the fixation probability of allele $A$ at $x=1$ starting from $X_{0}=x$, and define the conditional mean time to fixation at $x=1$ given that fixation occurs,\n$$\n\\tau_{\\text{fix}}(x) \\;=\\; \\mathbb{E}_{x}\\!\\left[T \\,\\big|\\, X_{T}=1\\right], \\quad x \\in (0,1).\n$$\n\nStarting from the generator $\\mathcal{L}$, Dynkin’s formula, and boundary value characterizations of hitting probabilities and expected hitting times for one-dimensional diffusions, derive and solve the appropriate coupled boundary value problems to obtain a closed-form analytical expression for $\\tau_{\\text{fix}}(x)$. Alternatively, you may use Doob’s $h$-transform to condition the process on fixation at $x=1$ and then compute the mean hitting time to $x=1$ under the transformed dynamics. Express your final answer as a single analytic expression in terms of $x$ and $N$. No numerical rounding is required, and no physical units are to be included in the final expression.",
            "solution": "The problem asks for the conditional mean time to fixation, $\\tau_{\\text{fix}}(x)$, for a neutral allele in a haploid population of constant effective size $N$, starting from an initial frequency $x$. This quantity is defined as $\\tau_{\\text{fix}}(x) = \\mathbb{E}_{x}[T | X_{T}=1]$, where $T$ is the first hitting time of the absorbing boundaries $\\{0,1\\}$.\n\nUsing the definition of conditional expectation, we can write $\\tau_{\\text{fix}}(x)$ as the ratio of two quantities:\n$$\n\\tau_{\\text{fix}}(x) = \\frac{\\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]}{\\mathbb{P}_{x}[X_{T}=1]}\n$$\nwhere $\\mathbb{I}_{\\{X_{T}=1\\}}$ is the indicator function for the event that the allele fixes at frequency $1$.\n\nLet us define the numerator and the denominator as separate functions of the initial frequency $x$:\n1. $h(x) = \\mathbb{P}_{x}[X_{T}=1]$: The probability of fixation at $1$.\n2. $k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$: The expectation of the product of the absorption time and the indicator of fixation at $1$.\n\nWe will find both $h(x)$ and $k(x)$ by solving the appropriate boundary value problems (BVPs) derived from the given Wright-Fisher diffusion generator, $\\mathcal{L} f(x) = \\frac{1}{2N} x(1-x) f''(x)$.\n\nFirst, we determine the fixation probability $h(x)$. For a one-dimensional diffusion, the probability of hitting one boundary before another is the solution to the backward Kolmogorov equation $\\mathcal{L}h(x) = 0$, with boundary conditions reflecting the outcome at the boundaries.\nThe BVP for $h(x)$ is:\n$$\n\\mathcal{L}h(x) = \\frac{1}{2N} x(1-x) h''(x) = 0, \\quad \\text{for } x \\in (0,1)\n$$\nwith boundary conditions:\n$$\nh(0) = 0 \\quad (\\text{fixation at 1 is impossible starting from 0}) \\\\\nh(1) = 1 \\quad (\\text{fixation at 1 is certain starting from 1})\n$$\nFor $x \\in (0,1)$, the equation simplifies to $h''(x) = 0$. The general solution is a linear function $h(x) = C_1 x + C_2$.\nApplying the boundary conditions:\n$h(0) = 0 \\implies C_1(0) + C_2 = 0 \\implies C_2 = 0$.\n$h(1) = 1 \\implies C_1(1) + 0 = 1 \\implies C_1 = 1$.\nThus, the fixation probability is $h(x) = x$. This is a classic result for neutral evolution.\n\nNext, we determine $k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$. We can derive a differential equation for $k(x)$ by considering the evolution of the process over a single generation. Let $X_1$ be the allele frequency after one generation, starting from $X_0 = x$. The quantity $k(x)$ must satisfy the recurrence relation:\n$$\nk(x) = \\mathbb{E}_{x}[h(X_1) + k(X_1)]\n$$\nwhere time is measured in generations. The term $h(X_1)$ arises because one generation passes (contributing $1$ to the time $T$) with probability $h(X_1)$ of eventual fixation. Rearranging and noting that $h(x)$ is a martingale ($\\mathbb{E}_x[h(X_1)]=h(x)$), we have $\\mathbb{E}_x[k(X_1) - k(x)] = -h(x)$.\nIn the diffusion limit, the left side corresponds to the generator $\\mathcal{L}$ acting on $k(x)$, where the time unit is one generation. Thus, $k(x)$ is the solution to the following Poisson-type equation:\n$$\n\\mathcal{L}k(x) = -h(x)\n$$\nSubstituting the expressions for $\\mathcal{L}$ and $h(x)$:\n$$\n\\frac{1}{2N} x(1-x) k''(x) = -x, \\quad \\text{for } x \\in (0,1)\n$$\nThe boundary conditions for $k(x)$ are determined by its definition. At the boundaries, the absorption time $T$ is $0$, so the expectation must be $0$:\n$$\nk(0) = 0 \\\\\nk(1) = 0\n$$\nFor $x \\in (0,1)$, we can divide the differential equation by $x$:\n$$\n\\frac{1}{2N} (1-x) k''(x) = -1\n$$\n$$\nk''(x) = -\\frac{2N}{1-x}\n$$\nWe integrate this equation twice to find $k(x)$. First integration yields $k'(x)$:\n$$\nk'(x) = \\int -\\frac{2N}{1-t} dt = 2N \\ln(1-x) + C_1\n$$\nSecond integration yields $k(x)$:\n$$\nk(x) = \\int (2N \\ln(1-t) + C_1) dt\n$$\nUsing integration by parts for $\\int \\ln(1-t) dt = -(1-t)\\ln(1-t) + (1-t)$, we get:\n$$\nk(x) = 2N \\left( -(1-x)\\ln(1-x) + (1-x) \\right) + C_1 x + C_2\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + C_1 x + C_2\n$$\nNow we apply the boundary conditions to find the constants $C_1$ and $C_2$.\nAt $x=0$:\n$k(0) = 0 \\implies -2N(1-0)\\ln(1-0) + 2N(1-0) + C_1(0) + C_2 = 0$.\nSince $\\ln(1)=0$, this gives $0 + 2N + C_2 = 0 \\implies C_2 = -2N$.\nAt $x=1$:\n$k(1) = 0$. We must evaluate the limit $\\lim_{x \\to 1} -2N(1-x)\\ln(1-x)$, which is $0$.\nSo, $0 = 0 + 2N(1-1) + C_1(1) + C_2 \\implies 0 = C_1 + C_2$.\nWith $C_2=-2N$, we find $C_1 = 2N$.\nSubstituting the constants back into the solution for $k(x)$:\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N - 2Nx + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x)\n$$\nFinally, we compute the conditional mean time to fixation, $\\tau_{\\text{fix}}(x)$:\n$$\n\\tau_{\\text{fix}}(x) = \\frac{k(x)}{h(x)} = \\frac{-2N(1-x)\\ln(1-x)}{x}\n$$\nThis expression gives the average time to fixation, in generations, given that fixation occurs, starting from an initial frequency $x$.",
            "answer": "$$\n\\boxed{-2N \\frac{1-x}{x} \\ln(1-x)}\n$$"
        }
    ]
}