{
    "hands_on_practices": [
        {
            "introduction": "在对复杂系统进行参数扫描时，遍历所有参数组合的“蛮力”方法在计算上往往是不可行的。实验设计 (Design of Experiments, DOE) 提供了一套强大的方法来高效地探索参数空间。本练习  将引导你构建一个正交设计，这是高效估计主效应的黄金标准，因为它能确保参数效应的估计值互不相关，从而获得最高的稳定性和精确度。",
            "id": "4135739",
            "problem": "考虑一个复杂自适应系统（CAS）元模型，其包含 $k=7$ 个可控参数，每个参数有两个水平，编码为 $-1$ 和 $+1$。您将使用参数扫描，通过响应的线性近似来估计主效应，其中设计矩阵 $X$ 汇集了 $N$ 次运行的编码设置。响应 $y$ 的建模由标准线性元模型 $y = \\beta_{0} + \\sum_{j=1}^{k} \\beta_{j} x_{j} + \\varepsilon$ 给出，系数通过普通最小二乘法（OLS）进行估计（首次出现时定义为普通最小二乘法（OLS）），并假设噪声是独立、均值为零且方差有限的。\n\n您的任务是：\n1. 根据实验设计（DOE）的基本原理（首次出现时定义为实验设计（DOE）），确定最小的 $N$，使得存在一个 $N \\times (k+1)$ 的两水平设计矩阵 $X$，其各列（包括截距列）相互正交，且非截距列是平衡的（$-1$ 和 $+1$ 的数量相等）。请证明其最小性并明确构造出这样的 $X$。\n2. 使用您构造的 $X$ 矩阵，构建格拉姆矩阵 $G = X^{\\top} X$。确定其精确的谱条件数 $\\kappa(G)$，该值定义为 $G$ 的最大特征值与最小特征值之比。\n3. 基于您构造的 $X$ 矩阵的正交性，简要讨论这在当前 CAS 元模型环境下对主效应灵敏度估计稳定性的影响（您可以使用 OLS 估计量及其协方差作为基本论据）。\n\n将您的最终数值答案表示为 $\\kappa(G)$ 的精确值，无需四舍五入，也无需单位。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 系统：一个复杂自适应系统（CAS）元模型。\n- 可控参数数量：$k=7$。\n- 参数水平：两个水平，编码为 $-1$ 和 $+1$。\n- 分析方法：通过线性近似进行参数扫描以估计主效应。\n- 设计矩阵：$X$，维度为 $N \\times (k+1)$，汇集了 $N$ 次运行的编码设置。\n- 响应模型：$y = \\beta_{0} + \\sum_{j=1}^{k} \\beta_{j} x_{j} + \\varepsilon$。这是一个标准线性元模型。\n- 估计方法：普通最小二乘法（OLS）。\n- 误差项假设：$\\varepsilon$ 由独立、均值为零且方差为 $\\sigma^2$ 的随机变量组成。\n- $X$ 的任务1约束：\n    - 最小运行次数 $N$。\n    - $N \\times (k+1)$ 的两水平设计矩阵 $X$ 必须具有相互正交的列（包括截距列）。\n    - 非截距列必须是平衡的（$-1$ 和 $+1$ 的数量相等）。\n- 任务2要求：\n    - 构建格拉姆矩阵 $G = X^{\\top} X$。\n    - 确定精确的谱条件数 $\\kappa(G) = \\lambda_{\\text{max}}(G) / \\lambda_{\\text{min}}(G)$。\n- 任务3要求：\n    - 讨论 $X$ 的正交性对灵敏度估计稳定性的影响。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上和数学上是合理的。它牢固地建立在统计实验设计（DOE）和线性回归分析的既定原则之上，这些是构建元模型和在复杂系统研究中进行灵敏度分析的标准技术。\n\n1.  **科学或事实不合理性**：该问题没有任何科学或事实错误。线性模型、OLS 估计和正交设计的概念是应用统计学和建模的基石。\n2.  **无法形式化或不相关**：该问题是高度可形式化的，并且与 CAS 模型的参数扫描和灵敏度分析主题直接相关。线性元模型是实现此目的的常用方法。\n3.  **不完整或矛盾的设置**：该问题是自洽和一致的。它提供了所有必要的信息（$k=7$）和约束（正交性、平衡性），以唯一确定最小设计规模 $N$ 和所得格拉姆矩阵的结构。“平衡”约束实际上是要求参数列与截距列正交的必然结果，这显示了其内部一致性。\n4.  **不切实际或不可行**：所需的实验设计（一个用于 $k=7$ 个因子的正交阵列）不仅是可行的，而且是一种著名且广泛使用的设计（例如，Plackett-Burman 设计或 $2^{7-4}$ 部分因子设计）。\n5.  **不适定或结构不良**：该问题是适定的。它要求一个最小的 $N$，构造一个特定的矩阵 $X$，一个唯一定义的条件数 $\\kappa(G)$，以及一个基于标准统计理论的讨论。存在一个唯一且有意义的解。\n6.  **伪深刻、琐碎或同义反复**：该问题需要在 DOE 的背景下对线性代数和回归分析的概念进行非平凡的综合。\n7.  **超出科学可验证性范围**：该问题的所有部分在数学上都是可验证的。\n\n**步骤3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n### 解答\n\n按要求分三部分解答该问题。\n\n**1. 最小设计规模 $N$ 及矩阵 $X$ 的构造**\n\n我们的任务是找到设计矩阵 $X$ 的最小运行次数 $N$。该矩阵大小为 $N \\times (k+1)$，且满足特定的正交性和平衡条件。给定 $k=7$ 个参数，矩阵 $X$ 必须有 $k+1 = 8$ 列。我们将这些列表示为向量 $\\mathbf{x}_0, \\mathbf{x}_1, \\dots, \\mathbf{x}_7$，其中 $\\mathbf{x}_0$ 是截距列，$\\mathbf{x}_1, \\dots, \\mathbf{x}_7$ 对应于7个参数。\n\n截距列 $\\mathbf{x}_0$ 是一个包含 $N$ 个1的向量，即 $\\mathbf{x}_0 = [1, 1, \\dots, 1]^\\top$。对于 $j \\in \\{1, \\dots, 7\\}$，参数列 $\\mathbf{x}_j$ 的元素 $x_{ij} \\in \\{-1, +1\\}$。\n\n相互正交的条件是，对于所有 $i \\neq j$（其中 $i, j \\in \\{0, 1, \\dots, 7\\}$），都有 $\\mathbf{x}_i^\\top \\mathbf{x}_j = 0$。我们来考虑参数列 $\\mathbf{x}_j$（其中 $j>0$）与截距列 $\\mathbf{x}_0$ 的正交性：\n$$\n\\mathbf{x}_0^\\top \\mathbf{x}_j = \\sum_{i=1}^{N} (1)(x_{ij}) = 0\n$$\n由于 $x_{ij}$ 只能是 $-1$ 或 $+1$，为了使其总和为零，列向量 $\\mathbf{x}_j$ 必须包含相同数量的 $+1$ 和 $-1$。这意味着 $N$ 必须是偶数。这也证实了“平衡列”约束是与截距列正交的直接且必然的结果。\n\n我们需要在 $N$ 维空间 $\\mathbb{R}^N$ 中找到一组8个相互正交的向量。线性代数的一个基本定理指出，在 $N$ 维空间中，相互正交的非零向量的最大数量是 $N$。因此，我们必须有 $N \\geq 8$。\n\n现在的问题是找到最小的整数 $N \\geq 8$，使得存在一个 $N \\times 8$ 的矩阵 $X$，其元素为 $\\pm 1$（在对第一列进行适当编码后），并且其各列相互正交。这是哈达玛矩阵理论中的一个经典问题。一个 $N$ 阶的哈达玛矩阵，记为 $H_N$，是一个元素为 $\\pm 1$ 的 $N \\times N$ 矩阵，其列（和行）相互正交。这个性质可以用方程 $H_N H_N^\\top = N I_N$ 来表示，其中 $I_N$ 是 $N \\times N$ 的单位矩阵。要使这样的矩阵存在，$N$ 必须是1、2或4的倍数。\n\n由于我们需要 $N \\geq 8$，满足条件的最小4的倍数是 $N=8$。一个8阶的哈达玛矩阵是存在的，并且可以使用 Sylvester（或克罗内克积）方法构造：\n设 $H_2 = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$。则 $H_{2m} = H_2 \\otimes H_m = \\begin{pmatrix} H_m  H_m \\\\ H_m  -H_m \\end{pmatrix}$。\n这得到 $H_4 = \\begin{pmatrix} H_2  H_2 \\\\ H_2  -H_2 \\end{pmatrix} = \\begin{pmatrix} 1  1  1  1 \\\\ 1  -1  1  -1 \\\\ 1  1  -1  -1 \\\\ 1  -1  -1  1 \\end{pmatrix}$。\n最后，得到 $H_8 = \\begin{pmatrix} H_4  H_4 \\\\ H_4  -H_4 \\end{pmatrix}$。\n\n得到的矩阵 $H_8$ 是一个 $8 \\times 8$ 的矩阵，其各列相互正交。我们可以将我们的设计矩阵 $X$ 设为这个 $H_8$。\n$$\nX = H_8 = \\begin{pmatrix}\n 1   1   1   1   1   1   1   1 \\\\\n 1  -1   1  -1   1  -1   1  -1 \\\\\n 1   1  -1  -1   1   1  -1  -1 \\\\\n 1  -1  -1   1   1  -1  -1   1 \\\\\n 1   1   1   1  -1  -1  -1  -1 \\\\\n 1  -1   1  -1  -1   1  -1   1 \\\\\n 1   1  -1  -1  -1  -1   1   1 \\\\\n 1  -1  -1   1  -1   1   1  -1\n\\end{pmatrix}\n$$\n该矩阵的第一列是全为 $+1$ 的向量，适合作为截距项 $\\mathbf{x}_0$。其余的7列为参数 $\\mathbf{x}_1, \\dots, \\mathbf{x}_7$ 提供了设置。这7列中的每一列都包含四个 $+1$ 和四个 $-1$，满足平衡条件。所有列都相互正交。\n因此，最小运行次数为 $N=8$。这个设计对应于一个饱和正交阵列，具体来说是一个 $2^{7-4}$ 分辨率III的部分因子设计。\n\n**2. 格拉姆矩阵 $G$ 及其谱条件数 $\\kappa(G)$**\n\n格拉姆矩阵定义为 $G = X^\\top X$。由于我们构造的矩阵 $X$ 是一个8阶的哈达玛矩阵，它满足性质 $X^\\top X = 8 I_8$，其中 $I_8$ 是 $8 \\times 8$ 的单位矩阵。\n\n或者，我们可以直接计算 $G$ 的元素。元素 $G_{ij}$ 是 $X$ 的第 $i$ 列 $\\mathbf{x}_i$ 和第 $j$ 列 $\\mathbf{x}_j$ 的点积。\n对于对角元素（$i=j$）：\n$$\nG_{jj} = \\mathbf{x}_j^\\top \\mathbf{x}_j = \\sum_{l=1}^{8} (x_{lj})^2\n$$\n对于任何列 $\\mathbf{x}_j$（包括截距列），其元素均为 $\\pm 1$。因此，$(x_{lj})^2=1$。\n$$\nG_{jj} = \\sum_{l=1}^{8} 1 = 8\n$$\n对于非对角元素（$i \\neq j$），根据我们构造的 $X$ 的正交性：\n$$\nG_{ij} = \\mathbf{x}_i^\\top \\mathbf{x}_j = 0\n$$\n因此，格拉姆矩阵是一个对角矩阵，所有对角元素都等于8：\n$$\nG = 8I_8 = \\begin{pmatrix} 8  0  \\dots  0 \\\\ 0  8  \\dots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\dots  8 \\end{pmatrix}\n$$\n对角矩阵的特征值就是其对角元素。因此，$G$ 的所有8个特征值都等于8。设 $\\lambda$ 表示一个特征值，则 $\\lambda_1 = \\lambda_2 = \\dots = \\lambda_8 = 8$。\n这意味着最大特征值为 $\\lambda_{\\text{max}}(G) = 8$，最小特征值为 $\\lambda_{\\text{min}}(G) = 8$。\n\n谱条件数 $\\kappa(G)$ 是最大特征值与最小特征值之比：\n$$\n\\kappa(G) = \\frac{\\lambda_{\\text{max}}(G)}{\\lambda_{\\text{min}}(G)} = \\frac{8}{8} = 1\n$$\n\n**3. 对灵敏度估计稳定性的影响**\n\n在这个 CAS 元模型中，响应对参数变化的灵敏度由线性模型中的系数 $\\beta_j$ 来估计。该估计的稳定性与 OLS 估计量 $\\hat{\\boldsymbol{\\beta}}$ 的统计特性直接相关。\n\n系数向量的 OLS 估计量由公式 $\\hat{\\boldsymbol{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}$ 给出。该估计量的协方差矩阵为 $\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\sigma^2 (X^\\top X)^{-1}$，其中 $\\sigma^2$ 是误差项 $\\varepsilon$ 的方差。\n\n根据我们之前的分析，我们确定了 $X^\\top X = G = 8I_8$。其逆矩阵为 $(X^\\top X)^{-1} = (8I_8)^{-1} = \\frac{1}{8}I_8$。\n将此代入协方差公式可得：\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\sigma^2 \\left(\\frac{1}{8}I_8\\right) = \\frac{\\sigma^2}{N}I_8\n$$\n协方差矩阵的这种对角结构对灵敏度分析具有深刻且非常理想的影响：\n\n1.  **不相关的估计**：由于协方差矩阵是对角矩阵，所有非对角元素均为零。这意味着对于 $i \\neq j$，有 $\\text{Cov}(\\hat{\\beta}_i, \\hat{\\beta}_j) = 0$。主效应（以及截距）的估计在统计上是不相关的。这使得每个参数的灵敏度可以被明确无误地估计；$\\hat{\\beta}_i$ 的值在统计上不依赖于 $\\hat{\\beta}_j$ 的值。这个特性被称为可估性分离，是正交设计的一个标志。\n\n2.  **最大精度和稳定性**：每个系数估计量的方差由协方差矩阵的对角元素给出：对于所有 $j \\in \\{0, \\dots, 7\\}$，$\\text{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{8} = \\frac{\\sigma^2}{N}$。对于任何具有 $N$ 次运行的实验设计，这个方差是可能达到的最小值。正交设计在提取信息方面效率最高，从而得到最精确和最稳定的估计。谱条件数 $\\kappa(G) = 1$ 是这种理想状态的数学标志。值为1表示一个完全良态的问题，其估计是稳健的，并且对输入数据 $\\mathbf{y}$ 的小扰动不敏感。任何非正交性（多重共线性）都会导致 $\\kappa(G) > 1$，从而引起方差膨胀和参数估计的不稳定。\n\n总之，使用这种正交设计进行参数扫描，为估计 CAS 元模型中的主灵敏度提供了最稳健、最高效的方法，确保了各效应可以被独立地、并以最高精度进行估计。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "许多复杂自适应系统模型，特别是基于主体的模型 (Agent-Based Models)，其本质是随机的。这意味着单次运行只产生一个可能的结果，这对于理解系统的平均行为是远远不够的。本练习  将深入探讨为何需要多次重复运行，并从统计学的基本原理出发，推导如何计算所需的重复次数，以确保你的分析结果达到预期的置信水平和精度。",
            "id": "4135741",
            "problem": "考虑一个随机的基于主体的模型 (ABM)，其中对于参数扫描域 $\\Theta$ 中的一个固定控制参数 $\\theta$，其标量输出 $Y$ 是一个随机变量，这源于随机的主体交互和随机的初始条件。在敏感性分析中，我们感兴趣的量是条件期望 $\\mathbb{E}[Y \\mid \\theta]$，它用于衡量系统级输出如何随 $\\theta$ 变化。请从概率论和抽样的基本原理出发，解释当模型是随机的时，为何需要多次独立重复实验来估计 $\\mathbb{E}[Y \\mid \\theta]$。然后，假设您在给定的 $\\theta$ 下运行 $R$ 次独立重复实验，得到独立同分布的样本 $Y_{1}(\\theta), \\dots, Y_{R}(\\theta)$，其条件均值为 $\\mu(\\theta) = \\mathbb{E}[Y \\mid \\theta]$，条件方差为 $\\sigma^{2}(\\theta) = \\operatorname{Var}(Y \\mid \\theta)$。对于较大的 $R$，使用由中心极限定理支持的正态近似，构建 $\\mu(\\theta)$ 的双侧置信区间，并推导所需的最小重复实验次数 $R(\\theta)$，以确保在置信水平为 $1 - \\alpha$ 时，置信区间的半宽（误差范围）至多为一个预设的容差 $\\epsilon > 0$。令 $z_{p}$ 表示标准正态分布的 $p$-分位数。请用 $\\epsilon$、$\\alpha$ 和 $\\sigma^{2}(\\theta)$ 将您的最终答案表示为单个闭式解析表达式。无需进行数值计算。如果您的表达式得出的 $R(\\theta)$ 为非整数，请返回满足要求的最小整数。您的最终答案必须是一个计算式，且方框内不包含任何单位。",
            "solution": "该问题是有效的，因为它在科学上基于概率论和统计学，问题阐述清晰，目标明确，表达形式规范。它直接关系到随机模型敏感性分析中的标准方法，这是复杂自适应系统建模中的一个核心课题。\n\n首先，我们讨论在随机模型中估计条件期望 $\\mathbb{E}[Y \\mid \\theta]$ 时，进行多次独立重复实验的必要性。我们感兴趣的量 $\\mu(\\theta) = \\mathbb{E}[Y \\mid \\theta]$ 代表在控制参数 $\\theta$ 固定时，标量输出 $Y$ 的分布的真实均值。随机的基于主体的模型 (ABM) 的单次运行或重复实验会产生一个单一的实现，记为 $y_1(\\theta)$，它是从 $Y \\mid \\theta$ 的基础概率分布中进行的一次随机抽取。这个单一值 $y_1(\\theta)$ 是 $\\mu(\\theta)$ 的一个无偏估计，因为 $\\mathbb{E}[Y_1(\\theta)] = \\mu(\\theta)$。然而，这是一个噪声很大的估计，因为它的方差是该过程的完整条件方差，即 $\\operatorname{Var}(Y_1(\\theta)) = \\sigma^2(\\theta)$。单个样本无法提供关于分布的离散程度或集中趋势的信息；它只是该分布中的一个点。依赖单次重复实验就好比只测量一个人的身高来估计总人口的平均身高。\n\n为了获得对真实均值 $\\mu(\\theta)$ 更可靠、更精确的估计，我们必须进行多次独立的重复实验。设 $R$ 次独立重复实验的结果为 $Y_1(\\theta), Y_2(\\theta), \\dots, Y_R(\\theta)$。这些是独立同分布 (i.i.d.) 的随机变量，每个变量的均值为 $\\mu(\\theta)$，方差为 $\\sigma^2(\\theta)$。总体均值 $\\mu(\\theta)$ 的标准估计量是样本均值，定义如下：\n$$\n\\hat{\\mu}_R(\\theta) = \\frac{1}{R} \\sum_{i=1}^{R} Y_i(\\theta)\n$$\n根据大数定律，当重复实验次数 $R$ 趋于无穷大时，样本均值 $\\hat{\\mu}_R(\\theta)$ 在概率上收敛于真实均值 $\\mu(\\theta)$。在实践中，样本均值估计量的方差由下式给出：\n$$\n\\operatorname{Var}(\\hat{\\mu}_R(\\theta)) = \\operatorname{Var}\\left(\\frac{1}{R} \\sum_{i=1}^{R} Y_i(\\theta)\\right) = \\frac{1}{R^2} \\sum_{i=1}^{R} \\operatorname{Var}(Y_i(\\theta)) = \\frac{1}{R^2} (R \\sigma^2(\\theta)) = \\frac{\\sigma^2(\\theta)}{R}\n$$\n这个方程展示了抽样的一个基本原理：样本均值的方差与样本数量 $R$ 成反比。因此，通过增加 $R$，我们可以任意减小估计量的方差，使其成为对真实均值 $\\mu(\\theta)$ 更精确、更可靠的度量。因此，多次重复实验对于“平均掉”模型中固有的随机噪声，从而获得系统级输出的统计稳定估计至关重要。\n\n接下来，我们推导达到指定精度所需的最小重复实验次数 $R(\\theta)$。问题要求 $\\mu(\\theta)$ 的 $1-\\alpha$ 置信区间的半宽至多为 $\\epsilon$。对于较大的 $R$，我们使用由中心极限定理 (CLT) 支持的样本均值的正态近似。CLT 表明，标准化样本均值的分布收敛于标准正态分布：\n$$\n\\frac{\\hat{\\mu}_R(\\theta) - \\mu(\\theta)}{\\sigma(\\theta)/\\sqrt{R}} \\xrightarrow{d} \\mathcal{N}(0, 1) \\quad \\text{as } R \\to \\infty\n$$\n这里，$\\sigma(\\theta) = \\sqrt{\\sigma^2(\\theta)}$ 是条件标准差。基于此近似，构建置信水平为 $1-\\alpha$ 的 $\\mu(\\theta)$ 的双侧置信区间。我们从标准正态分布中找到包含中心概率 $1-\\alpha$ 的临界值。剩余的概率 $\\alpha$ 被平均分配到两个尾部，每个尾部为 $\\alpha/2$。上临界值是标准正态分布的 $(1-\\alpha/2)$-分位数，记为 $z_{1-\\alpha/2}$。由于对称性，下临界值为 $z_{\\alpha/2} = -z_{1-\\alpha/2}$。\n\n置信区间由以下概率陈述定义：\n$$\nP\\left( -z_{1-\\alpha/2} \\le \\frac{\\hat{\\mu}_R(\\theta) - \\mu(\\theta)}{\\sigma(\\theta)/\\sqrt{R}} \\le z_{1-\\alpha/2} \\right) \\approx 1-\\alpha\n$$\n重新整理不等式以分离出真实均值 $\\mu(\\theta)$，我们得到：\n$$\nP\\left( \\hat{\\mu}_R(\\theta) - z_{1-\\alpha/2}\\frac{\\sigma(\\theta)}{\\sqrt{R}} \\le \\mu(\\theta) \\le \\hat{\\mu}_R(\\theta) + z_{1-\\alpha/2}\\frac{\\sigma(\\theta)}{\\sqrt{R}} \\right) \\approx 1-\\alpha\n$$\n因此，置信区间为 $[\\hat{\\mu}_R(\\theta) - H, \\hat{\\mu}_R(\\theta) + H]$，其中半宽（或误差范围）$H$ 为：\n$$\nH = z_{1-\\alpha/2}\\frac{\\sigma(\\theta)}{\\sqrt{R}}\n$$\n问题陈述该半宽必须至多为一个预设的容差 $\\epsilon$：\n$$\nH \\le \\epsilon\n$$\n代入 $H$ 的表达式，我们得到：\n$$\nz_{1-\\alpha/2}\\frac{\\sigma(\\theta)}{\\sqrt{R}} \\le \\epsilon\n$$\n现在我们对这个不等式求解 $R$。\n$$\n\\sqrt{R} \\ge \\frac{z_{1-\\alpha/2}\\sigma(\\theta)}{\\epsilon}\n$$\n两边平方得到：\n$$\nR \\ge \\left(\\frac{z_{1-\\alpha/2}\\sigma(\\theta)}{\\epsilon}\\right)^2\n$$\n用 $\\sigma^2(\\theta)$ 代替 $\\sigma(\\theta)^2$：\n$$\nR \\ge \\frac{z_{1-\\alpha/2}^2 \\sigma^2(\\theta)}{\\epsilon^2}\n$$\n由于重复实验次数 $R$ 必须是整数，满足此条件所需的最小重复实验次数 $R(\\theta)$ 是大于或等于右侧值的最小整数。这由向上取整函数给出。\n$$\nR(\\theta) = \\left\\lceil \\frac{z_{1-\\alpha/2}^2 \\sigma^2(\\theta)}{\\epsilon^2} \\right\\rceil\n$$\n此表达式提供了所需最小重复实验次数，它是期望容差 $\\epsilon$、置信水平 $1-\\alpha$（它决定了 $z_{1-\\alpha/2}$）以及模型的内在方差 $\\sigma^2(\\theta)$ 的函数。",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{z_{1-\\alpha/2}^{2} \\sigma^{2}(\\theta)}{\\epsilon^{2}} \\right\\rceil}\n$$"
        },
        {
            "introduction": "在真实世界的系统或经过校准的模型中，参数之间往往存在相关性。这种相关性可能会在敏感性分析中引入混杂效应，即输入参数间的相关性会产生误导性的敏感度信号，掩盖或夸大某些参数的真实影响。本练习  探讨了这一关键问题，并要求你运用多种诊断技术，以区分参数的真实结构性影响与由数据分布引起的虚假信号。",
            "id": "4135798",
            "problem": "一个复杂自适应系统模型产生一个聚合性能指标 $Y$，该指标是参数向量 $\\Theta = (\\theta_1,\\theta_2,\\theta_3)^\\top$ 的一个确定性函数。假设已知 $Y$ 与参数呈线性关系，$Y = \\theta_1 - \\theta_2 + \\theta_3$，并且通过从一个均值为零、协方差矩阵为\n$$\n\\Sigma = \n\\begin{pmatrix}\n\\sigma^2  \\rho \\sigma^2  0 \\\\\n\\rho \\sigma^2  \\sigma^2  0 \\\\\n0  0  \\tau^2\n\\end{pmatrix},\n$$\n的联合分布中对 $\\Theta$ 进行抽样来进行参数扫描，其中 $\\sigma^2 > 0$，$\\tau^2 > 0$，并且 $\\rho \\in (0,1)$ 捕捉了由校准过程中的协同适应引起的 $\\theta_1$ 和 $\\theta_2$ 之间的强正相关性（例如，$\\rho$ 接近 $1$）。你使用拉丁超立方抽样（LHS; Latin Hypercube Sampling）进行了一次大规模的参数扫描（有 $N$ 个样本，$N$ 很大），该抽样保留了输入之间的经验相关结构。一个基于相关性的初步敏感性筛选表明，$\\theta_3$ 似乎是 $Y$ 最重要的驱动因素，而 $\\theta_1$ 和 $\\theta_2$ 与 $Y$ 的关联似乎很弱。\n\n请基于协方差、相关性、线性回归和全方差定律的基本定义来阐述你的理由。解释参数间的混淆如何在这种情况下产生伪敏感性信号，并指出可以区分结构性影响和由分布引起的假象的诊断方法。选择以下所有正确的陈述。\n\nA. 使用从保留了相关性的 LHS 设计中计算出的 $Y$ 与每个 $\\theta_i$ 之间的简单边际相关性（Pearson 或 Spearman）足以正确地对参数重要性进行排序；输入之间的强相关性不会使作为敏感性度量的边际相关性产生偏差。\n\nB. 在控制 $\\theta_2$ 的情况下计算 $Y$ 和 $\\theta_1$ 之间的偏秩相关系数（PRCC; Partial Rank Correlation Coefficient）（反之亦然），或者对 $Y$ 关于 $(\\theta_1,\\theta_2,\\theta_3)$ 进行多元线性回归并检查标准化系数，可以通过分离每个参数的独特贡献来诊断混淆。\n\nC. 即使真实输入是相关的（即 $\\rho > 0$），在独立输入假设下计算的基于方差的一阶 Sobol 敏感性指数 $S_i = \\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_i])/\\mathrm{Var}(Y)$ 仍然有效且可解释，因此在这里可以不加修改地使用。\n\nD. 重新参数化为正交对比 $u = \\theta_1 - \\theta_2$ 和 $v = \\theta_1 + \\theta_2$，然后将 $u$、$v$ 和 $\\theta_3$ 作为独立变量进行扫描以探究结构敏感性，这将揭示 $Y$ 随 $u$ 和 $\\theta_3$ 变化而不随 $v$ 变化，从而诊断出 $\\theta_1$ 和 $\\theta_2$ 的弱边际关联是由混淆引起的。\n\nE. 使用条件方差分解 $\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid \\theta_2)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_2])$ 并将 $\\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_2])$ 完全归因于 $\\theta_2$，即使在输入相关的情况下，也总能得到一个关于 $\\theta_2$ 重要性的正确度量。\n\nF. 为相关输入计算 Shapley 效应（源自合作博弈论的、按次序平均的方差贡献）为 $\\mathrm{Var}(Y)$ 到 $(\\theta_1,\\theta_2,\\theta_3)$ 的归因提供了一种公平的、与顺序无关的方法，并减轻了由混淆引起的伪敏感性信号。\n\nG. 在计算敏感性指数之前，随机排列各次运行中 $\\theta_1$ 的抽样值以打破其与 $\\theta_2$ 的相关性，这样做保留了正确的数据生成过程，并能无偏地揭示 $\\theta_1$ 的真实主效应。\n\n选择所有适用的选项。",
            "solution": "问题陈述描述了敏感性分析中一个典型的混淆案例，其中输入参数之间的强相关性掩盖了它们对模型输出的真实结构性影响。该问题是有效的，因为它在科学上基于统计学和敏感性分析，问题设定良好，有明确的模型和输入分布，并以客观、正式的语言表述。\n\n模型由线性方程 $Y = \\theta_1 - \\theta_2 + \\theta_3$ 给出。参数 $(\\theta_1, \\theta_2, \\theta_3)$ 从一个均值为零、协方差矩阵为 $\\Sigma$ 的分布中抽样。\n$$\n\\Sigma =\n\\begin{pmatrix}\n\\sigma^2  \\rho \\sigma^2  0 \\\\\n\\rho \\sigma^2  \\sigma^2  0 \\\\\n0  0  \\tau^2\n\\end{pmatrix}\n$$\n其中 $\\sigma^2 > 0$，$\\tau^2 > 0$，且 $\\rho \\in (0, 1)$ 接近于 $1$。\n\n问题的核心在于 $\\theta_1$ 和 $\\theta_2$ 之间的强正相关 $\\rho$。这意味着当 $\\theta_1$ 增加时，$\\theta_2$ 也倾向于增加相似的量。由于它们以相反的符号进入模型，它们的影响在观测数据中大部分相互抵消，即项 $\\theta_1 - \\theta_2$ 的方差很小。这就产生了一个它们不重要的伪信号，正如一个初步的敏感性筛选所观察到的那样。\n\n让我们来定量分析一下。输出 $Y$ 的总方差是：\n$$\n\\mathrm{Var}(Y) = \\mathrm{Var}(\\theta_1 - \\theta_2 + \\theta_3)\n= \\mathrm{Var}(\\theta_1 - \\theta_2) + \\mathrm{Var}(\\theta_3) \\quad (\\text{因为 } \\theta_3 \\text{ 与 } \\theta_1, \\theta_2 \\text{ 不相关})\n$$\n$$\n= [\\mathrm{Var}(\\theta_1) + \\mathrm{Var}(\\theta_2) - 2\\mathrm{Cov}(\\theta_1, \\theta_2)] + \\mathrm{Var}(\\theta_3)\n$$\n$$\n= [\\sigma^2 + \\sigma^2 - 2\\rho\\sigma^2] + \\tau^2 = 2\\sigma^2(1 - \\rho) + \\tau^2\n$$\n$Y$ 与每个参数 $\\theta_i$ 的协方差是：\n$$\n\\mathrm{Cov}(Y, \\theta_1) = \\mathrm{Cov}(\\theta_1 - \\theta_2 + \\theta_3, \\theta_1) = \\mathrm{Var}(\\theta_1) - \\mathrm{Cov}(\\theta_2, \\theta_1) = \\sigma^2 - \\rho\\sigma^2 = \\sigma^2(1-\\rho)\n$$\n$$\n\\mathrm{Cov}(Y, \\theta_2) = \\mathrm{Cov}(\\theta_1 - \\theta_2 + \\theta_3, \\theta_2) = \\mathrm{Cov}(\\theta_1, \\theta_2) - \\mathrm{Var}(\\theta_2) = \\rho\\sigma^2 - \\sigma^2 = -\\sigma^2(1-\\rho)\n$$\n$$\n\\mathrm{Cov}(Y, \\theta_3) = \\mathrm{Cov}(\\theta_1 - \\theta_2 + \\theta_3, \\theta_3) = \\mathrm{Var}(\\theta_3) = \\tau^2\n$$\n由于 $\\rho$ 接近 $1$，项 $(1-\\rho)$ 接近 $0$。因此，$\\mathrm{Cov}(Y, \\theta_1)$ 和 $\\mathrm{Cov}(Y, \\theta_2)$ 非常小，而 $\\mathrm{Cov}(Y, \\theta_3)$ 是 $\\tau^2$。这就解释了为什么一个基于相关性的初步筛选（依赖于这些协方差）会发现 $\\theta_1$ 和 $\\theta_2$ 与 $Y$ 的关联很弱，而 $\\theta_3$ 的关联很强。这是一种由分布引起的假象，而不是结构模型 $Y = \\theta_1 - \\theta_2 + \\theta_3$ 的反映，在结构模型中，所有三个参数的系数的绝对值都相同，即 $|1|$。\n\n现在，我们评估每个陈述。\n\n**A. 使用从保留了相关性的 LHS 设计中计算出的 $Y$ 与每个 $\\theta_i$ 之间的简单边际相关性（Pearson 或 Spearman）足以正确地对参数重要性进行排序；输入之间的强相关性不会使作为敏感性度量的边际相关性产生偏差。**\n我们上面的分析表明这是错误的。$\\theta_1$ 和 $\\theta_2$ 的边际协方差（以及因此的相关性）与 $(1-\\rho)$ 成正比，当 $\\rho \\to 1$ 时，该值趋近于 $0$。这会导致参数重要性排序不正确，使得 $\\theta_1$ 和 $\\theta_2$ 显得不重要。输入之间的强相关性正是导致这些边际度量产生偏差的原因。\n**结论：错误**\n\n**B. 在控制 $\\theta_2$ 的情况下计算 $Y$ 和 $\\theta_1$ 之间的偏秩相关系数（PRCC; Partial Rank Correlation Coefficient）（反之亦然），或者对 $Y$ 关于 $(\\theta_1,\\theta_2,\\theta_3)$ 进行多元线性回归并检查标准化系数，可以通过分离每个参数的独特贡献来诊断混淆。**\n该陈述描述了处理混淆的标准统计技术。对 $Y$ 关于 $(\\theta_1, \\theta_2, \\theta_3)$ 进行多元线性回归会估计系数 $\\beta_1, \\beta_2, \\beta_3$。对于大样本量，由于真实模型是 $Y = 1\\cdot\\theta_1 - 1\\cdot\\theta_2 + 1\\cdot\\theta_3$，估计的系数将收敛到 $\\hat{\\beta}_1 \\approx 1$，$\\hat{\\beta}_2 \\approx -1$ 和 $\\hat{\\beta}_3 \\approx 1$。这正确地揭示了结构关系，而不管输入之间的相关性如何。同样，偏相关系数（及其基于秩的对应物 PRCC）在剔除其他指定变量的线性效应后，度量两个变量之间的关联。这正是分离每个参数的独特贡献所需要的，并且能够正确地识别出 $\\theta_1$ 和 $\\theta_2$ 的非零影响。\n**结论：正确**\n\n**C. 即使真实输入是相关的（即 $\\rho > 0$），在独立输入假设下计算的基于方差的一阶 Sobol 敏感性指数 $S_i = \\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_i])/\\mathrm{Var}(Y)$ 仍然有效且可解释，因此在这里可以不加修改地使用。**\n当输入相关时，$S_i$ 作为仅由 $\\theta_i$ 引起的方差分数的解释不再成立。项 $\\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_i])$ 不仅捕捉了 $\\theta_i$ 的效应，还捕捉了任何与之相关的输入的效应。假设一个高斯相关结构，$\\mathbb{E}[\\theta_2 \\mid \\theta_1] = \\rho\\theta_1$。因此，$\\mathbb{E}[Y \\mid \\theta_1] = \\mathbb{E}[\\theta_1 - \\theta_2 + \\theta_3 \\mid \\theta_1] = \\theta_1 - \\rho\\theta_1 + 0 = \\theta_1(1-\\rho)$。$S_1$ 的分子变为 $\\mathrm{Var}(\\theta_1(1-\\rho)) = (1-\\rho)^2\\sigma^2$。当 $\\rho \\to 1$ 时，该项趋近于 $0$。Sobol 指数 $S_1$（以及根据对称性的 $S_2$）将接近于零，给出与边际相关性相同的误导性结果。因此，这些指数在标准方式下是不可解释的，并且对于解决混淆问题是无效的。\n**结论：错误**\n\n**D. 重新参数化为正交对比 $u = \\theta_1 - \\theta_2$ 和 $v = \\theta_1 + \\theta_2$，然后将 $u$、$v$ 和 $\\theta_3$ 作为独立变量进行扫描以探究结构敏感性，这将揭示 $Y$ 随 $u$ 和 $\\theta_3$ 变化而不随 $v$ 变化，从而诊断出 $\\theta_1$ 和 $\\theta_2$ 的弱边际关联是由混淆引起的。**\n这是一种强大的诊断技术。用新变量表示，模型变为 $Y = u + \\theta_3$。变量 $v$ 没有出现在 $Y$ 的结构方程中。让我们检查一下正交性：$\\mathrm{Cov}(u,v) = \\mathrm{Cov}(\\theta_1-\\theta_2, \\theta_1+\\theta_2) = \\mathrm{Var}(\\theta_1) - \\mathrm{Var}(\\theta_2) = \\sigma^2 - \\sigma^2 = 0$。同时，$u$ 和 $v$ 与 $\\theta_3$ 不相关。通过进行一次新的参数扫描，其中 $u$、$v$ 和 $\\theta_3$ 独立变化，可以直接探究模型结构。这种分析会显示 $Y$ 对 $u$ 和 $\\theta_3$ 的变化敏感，但对 $v$ 的变化完全不敏感。这正确地揭示了模型依赖于差值 $\\theta_1-\\theta_2$，并且混淆的产生是因为原始抽样分布在 $u$ 方向上的变异很小（因为 $\\mathrm{Var}(u) = 2\\sigma^2(1-\\rho)$ 很小），而大部分变异发生在不相关的 $v$ 方向上（因为 $\\mathrm{Var}(v) = 2\\sigma^2(1+\\rho)$ 很大）。\n**结论：正确**\n\n**E. 使用条件方差分解 $\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid \\theta_2)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_2])$ 并将 $\\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_2])$ 完全归因于 $\\theta_2$，即使在输入相关的情况下，也总能得到一个关于 $\\theta_2$ 重要性的正确度量。**\n该分解是全方差定律，并且始终成立。然而，将项 $\\mathrm{Var}(\\mathbb{E}[Y \\mid \\theta_2])$ 完全归因于 $\\theta_2$ 作为其重要性的度量，这正是一阶 Sobol 指数 $S_2$ 分子的定义。正如在对选项 C 的分析中所示，这个度量会因输入相关性而产生偏差，并会错误地表明 $\\theta_2$ 不重要。在这种情况下，它不能提供一个正确的重要性度量。\n**结论：错误**\n\n**F. 为相关输入计算 Shapley 效应（源自合作博弈论的、按次序平均的方差贡献）为 $\\mathrm{Var}(Y)$ 到 $(\\theta_1,\\theta_2,\\theta_3)$ 的归因提供了一种公平的、与顺序无关的方法，并减轻了由混淆引起的伪敏感性信号。**\nShapley 效应是一种先进的敏感性分析方法，专门设计用于为输出方差到输入参数的归因提供一个公平且稳健的方法，即使这些输入是相关的。它们基于合作博弈论的公理，确保了诸如效率（效应之和等于总方差）和对称性（可互换的输入获得相同的效应）等属性。通过对一个参数在所有可能的引入参数顺序上的边际贡献进行平均，Shapley 效应考虑了主效应和交互效应，包括由相关性引起的效应。这个过程旨在克服问题中描述的那种混淆，并提供一个更可靠的参数重要性信号。\n**结论：正确**\n\n**G. 在计算敏感性指数之前，随机排列各次运行中 $\\theta_1$ 的抽样值以打破其与 $\\theta_2$ 的相关性，这样做保留了正确的数据生成过程，并能无偏地揭示 $\\theta_1$ 的真实主效应。**\n随机排列 $\\theta_1$ 的值会明确地破坏问题设置中定义的相关结构（即 $\\mathrm{Cov}(\\theta_1, \\theta_2) = \\rho\\sigma^2$）。因此，这个过程从根本上改变了并且*没有*保留正确的数据生成过程。虽然对这个修改后的独立数据集计算敏感性可以是一个有信息量的“假设”情景，以了解模型在独立性下的结构敏感性，但该陈述声称它保留了原始数据过程，这在事实上是错误的。\n**结论：错误**",
            "answer": "$$\\boxed{BDF}$$"
        }
    ]
}