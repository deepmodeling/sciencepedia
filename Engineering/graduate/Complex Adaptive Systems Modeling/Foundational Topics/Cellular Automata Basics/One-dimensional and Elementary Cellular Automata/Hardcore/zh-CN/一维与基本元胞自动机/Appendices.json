{
    "hands_on_practices": [
        {
            "introduction": "元胞自动机的一个基本特性是信息传播速度有限，这是由其局部作用规则决定的。这项练习旨在将这一直觉形式化，通过推导“光锥”来界定单个点在时空中的最大影响范围。理解因果关系在元胞自动机以及更广泛的分布式系统中的传播方式，这是一个基础性的概念。",
            "id": "4134811",
            "problem": "考虑一个一维初等元胞自动机 (ECA)，其定义为一个由$\\mathbb{Z}$索引的二元状态、同步更新的格点系统，其中每个格点$i \\in \\mathbb{Z}$在离散时间$t \\in \\mathbb{N}$的状态为$x_i(t) \\in \\{0,1\\}$，并根据一个均匀的、半径为$1$的局部更新规则$f:\\{0,1\\}^3 \\to \\{0,1\\}$演化，具体方式为$x_i(t+1) = f\\big(x_{i-1}(t), x_i(t), x_{i+1}(t)\\big)$。设初始条件为$x_j(0)$，其中$x_0(0) = 1$且对于所有$j \\neq 0$有$x_j(0) = 0$。定义在$t$步之后可能受到原点处单个非零种子影响的格点集合为\n$$A(t) = \\left\\{\\, i \\in \\mathbb{Z} \\ \\text{使得存在一个半径为}1\\ \\text{的ECA规则}\\ f\\ \\text{，在该规则下格点}\\ i\\ \\text{在时间}\\ t\\ \\text{的构型依赖于}\\ x_0(0) \\,\\right\\}.$$\n从半径为$1$的局部性和同步更新的核心原则出发，推导出集合$A(t)$的精确刻画，然后确定其基数$\\left|A(t)\\right|$作为$t$的函数的闭式表达式。作为示例，明确列出$A(5)$。请以最简精确形式表示$\\left|A(t)\\right|$的最终公式。无需四舍五入。",
            "solution": "我们从初等元胞自动机 (ECA) 的定义属性开始：它是一个定义在$\\mathbb{Z}$上的一维、二元状态、同步更新的系统，具有一个统一的、半径为$1$的局部规则$f:\\{0,1\\}^3 \\to \\{0,1\\}$，通过以下方式更新每个格点：\n$$\nx_i(t+1) = f\\big(x_{i-1}(t), x_i(t), x_{i+1}(t)\\big).\n$$\n我们使用的基本依据是局部性：在每个时间步，格点$i$的新状态仅依赖于其半径为$1$的邻域内的前一时刻状态，即格点$i-1$、$i$和$i+1$。\n\n我们通过光锥论证来形式化依赖关系的传播。定义依赖集$D(i,t)$为那些时间为$0$时的值可以影响$x_i(t)$的初始索引的集合。我们断言，对于一个半径为$1$的ECA，\n$$\nD(i,t) \\subseteq \\{\\, j \\in \\mathbb{Z} : i - t \\leq j \\leq i + t \\,\\}.\n$$\n我们用对$t$的数学归纳法来证明这个断言。\n\n归纳基础 ($t = 0$)：显然，$x_i(0)$只依赖于其自身，所以$D(i,0) = \\{i\\}$，它是$\\{\\, j : i \\leq j \\leq i \\,\\}$的子集。\n\n归纳步骤：假设$D(i,t) \\subseteq \\{\\, j : i - t \\leq j \\leq i + t \\,\\}$。在时间$t+1$时，\n$$\nx_i(t+1) = f\\big(x_{i-1}(t), x_i(t), x_{i+1}(t)\\big),\n$$\n因此依赖集满足\n$$\nD(i,t+1) \\subseteq D(i-1,t) \\cup D(i,t) \\cup D(i+1,t).\n$$\n根据归纳假设，\n\\begin{align*}\nD(i-1,t) \\subseteq \\{\\, j : (i-1) - t \\leq j \\leq (i-1) + t \\,\\} = \\{\\, j : i - (t+1) \\leq j \\leq i + (t-1) \\,\\}, \\\\\nD(i,t) \\subseteq \\{\\, j : i - t \\leq j \\leq i + t \\,\\}, \\\\\nD(i+1,t) \\subseteq \\{\\, j : (i+1) - t \\leq j \\leq (i+1) + t \\,\\} = \\{\\, j : i - (t-1) \\leq j \\leq i + (t+1) \\,\\}.\n\\end{align*}\n这些集合的并集包含在\n$$\n\\{\\, j : i - (t+1) \\leq j \\leq i + (t+1) \\,\\},\n$$\n这便完成了归纳步骤。因此，对于所有$t \\in \\mathbb{N}$，\n$$\nD(i,t) \\subseteq \\{\\, j \\in \\mathbb{Z} : i - t \\leq j \\leq i + t \\,\\}.\n$$\n\n现在考虑特定的初始条件$x_0(0) = 1$且对于所有$j \\neq 0$有$x_j(0) = 0$。在时间$t$的格点$i$会受到原点处种子的影响，当且仅当$0 \\in D(i,t)$，根据依赖锥的刻画，这意味着\n$$\n|i - 0| \\leq t \\quad \\text{或等价地} \\quad |i| \\leq t.\n$$\n因此我们得到包含关系\n$$\nA(t) \\subseteq \\{\\, i \\in \\mathbb{Z} : |i| \\leq t \\,\\}.\n$$\n为了证明等式成立，我们需要证明对于每个满足$|i| \\leq t$的$i$，都存在某个半径为$1$的规则$f$，在该规则下$x_0(0)$的影响能到达$x_i(t)$。一个构造性的例子是由以下规则定义的\n$$\nf(a,b,c) = a \\lor b \\lor c,\n$$\n其中$\\lor$表示逻辑或。在这个规则下，从$x_0(0) = 1$和对$j \\neq 0$有$x_j(0) = 0$的初始条件出发，在时间$t$时等于$1$的格点集合恰好是$\\{\\, i : |i| \\leq t \\,\\}$，因为每个时间步都会将连续为$1$的区域向左和向右各扩展一个格点。因此，每个满足$|i| \\leq t$的格点$i$确实都受到了初始种子的影响，我们得出结论\n$$\nA(t) = \\{\\, i \\in \\mathbb{Z} : |i| \\leq t \\,\\}.\n$$\n\n$A(t)$的基数是$-t$和$t$之间（包括两端）的整数个数，即\n$$\n|A(t)| = 2t + 1.\n$$\n\n对于$t = 5$的示例：我们有\n$$\nA(5) = \\{\\, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5 \\,\\},\n$$\n因此\n$$\n|A(5)| = 11.\n$$\n\n所要求的基数的最简精确最终公式是$2t + 1$。",
            "answer": "$$\\boxed{2t+1}$$"
        },
        {
            "introduction": "从一般原理转向对特定复杂规则的分析，我们常常需要将其行为用代数形式来表示。这项练习聚焦于著名的规则110（Rule 110），它具有图灵完备性，任务是推导其代数范式（ANF），并应用它在具有固定边界条件的有限格子上模拟一个时间步的演化。掌握这一过程是进行元胞自动机理论分析和计算模拟的核心技能。",
            "id": "4134796",
            "problem": "考虑一个在一维有限格点上的半径为 $1$ 的二元初等元胞自动机（ECA），格点长度为 $n$，边界条件为空，即 $x_{0}(t)=x_{n+1}(t)=0$。局部更新由一个作用于最近邻三元组的布尔函数 $f:\\{0,1\\}^{3}\\to\\{0,1\\}$ 指定，因此对于内部格点 $i\\in\\{2,\\dots,n-1\\}$，有 $x_{i}(t+1)=f\\big(x_{i-1}(t),x_{i}(t),x_{i+1}(t)\\big)$。ECA 规则由 Wolfram 编码给出：规则编号 $R$ 写成一个 8 位二进制字 $b_{7}b_{6}b_{5}b_{4}b_{3}b_{2}b_{1}b_{0}$，该二进制字分别编码了邻域按字典序 $111,110,101,100,011,010,001,000$ 的输出，即 $f(1,1,1)=b_{7}$，$f(1,1,0)=b_{6}$，…，$f(0,0,0)=b_{0}$。所有布尔代数操作都在伽罗瓦域 $\\mathbb{F}_{2}$ 上进行。\n\n从这些定义出发，且仅使用这些定义，对规则 $R=110$ 的特定情况执行以下操作：\n1. 推导局部规则 $f(a,b,c)$ 在 $\\mathbb{F}_{2}$ 上的代数范式（也称为 Zhegalkin 多项式），其中 $a$、$b$ 和 $c$ 分别表示左、中、右输入。\n2. 使用空边界条件 $x_{0}(t)=x_{n+1}(t)=0$，构建边界处的诱导局部邻域，并分别用 $x_{1}(t),x_{2}(t)$ 和 $x_{n-1}(t),x_{n}(t)$ 写出边界元胞 $i=1$ 和 $i=n$ 的精确更新函数。\n3. 取 $n=8$ 和初始构型 $x(0)=(x_{1}(0),\\dots,x_{8}(0))=(1,0,1,1,0,1,0,1)$。在空边界条件下，根据规则 $R=110$ 演化一个时间步，然后将得到的构型 $x(1)$ 解释为一个大端序二进制整数 $I=\\sum_{i=1}^{8} x_{i}(1)\\,2^{8-i}$，其中 $x_{1}(1)$ 是最高有效位。将单个整数 $I$ 作为你的最终答案报告。无需四舍五入。",
            "solution": "该问题是适定的，有科学依据的，并包含唯一解所需的所有信息。我们按顺序解决这三个任务。所有计算都在伽罗瓦域 $\\mathbb{F}_{2}$ 上进行，其中加法对应于异或（XOR）运算，乘法对应于与（AND）运算。\n\n### 第 1 部分：规则 110 的代数范式\n\n首先将十进制的规则编号 $R=110$ 转换为其 8 位二进制表示：\n$$110_{10} = 64 + 32 + 8 + 4 + 2 = 1 \\cdot 2^6 + 1 \\cdot 2^5 + 0 \\cdot 2^4 + 1 \\cdot 2^3 + 1 \\cdot 2^2 + 1 \\cdot 2^1 + 0 \\cdot 2^0 = (01101110)_2$$\n问题指明，这个二进制字 $b_7 b_6 b_5 b_4 b_3 b_2 b_1 b_0 = 01101110$ 对应于局部函数 $f(a,b,c)$ 对输入邻域 $(a,b,c)$ 从 $(1,1,1)$ 到 $(0,0,0)$ 按字典序的输出。这给出了 $f$ 的以下真值表：\n\\begin{itemize}\n    \\item $f(1,1,1) = b_7 = 0$\n    \\item $f(1,1,0) = b_6 = 1$\n    \\item $f(1,0,1) = b_5 = 1$\n    \\item $f(1,0,0) = b_4 = 0$\n    \\item $f(0,1,1) = b_3 = 1$\n    \\item $f(0,1,0) = b_2 = 1$\n    \\item $f(0,0,1) = b_1 = 1$\n    \\item $f(0,0,0) = b_0 = 0$\n\\end{itemize}\n一个三变量布尔函数 $f(a,b,c)$ 在 $\\mathbb{F}_2$ 上的代数范式（ANF），或称 Zhegalkin 多项式，是以下形式的多项式：\n$$f(a,b,c) = k_0 + k_1 a + k_2 b + k_3 c + k_4 ab + k_5 ac + k_6 bc + k_7 abc$$\n系数 $k_i$ 可以从真值表中确定。\n\\begin{itemize}\n    \\item $f(0,0,0) = k_0 = 0$\n    \\item $f(0,0,1) = k_0 + k_3 = k_3 = 1$\n    \\item $f(0,1,0) = k_0 + k_2 = k_2 = 1$\n    \\item $f(1,0,0) = k_0 + k_1 = k_1 = 0$\n    \\item $f(0,1,1) = k_0 + k_2 + k_3 + k_6 = 0 + 1 + 1 + k_6 = k_6 = 1$\n    \\item $f(1,0,1) = k_0 + k_1 + k_3 + k_5 = 0 + 0 + 1 + k_5 = 1 + k_5 = 1 \\implies k_5 = 0$\n    \\item $f(1,1,0) = k_0 + k_1 + k_2 + k_4 = 0 + 0 + 1 + k_4 = 1 + k_4 = 1 \\implies k_4 = 0$\n    \\item $f(1,1,1) = k_0 + k_1 + k_2 + k_3 + k_4 + k_5 + k_6 + k_7 = 0+0+1+1+0+0+1+k_7 = 1+k_7 = 0 \\implies k_7 = 1$\n\\end{itemize}\n代入这些系数，规则 110 的 ANF 为：\n$$f(a,b,c) = 0 + 0a + 1b + 1c + 0ab + 0ac + 1bc + 1abc = b + c + bc + abc$$\n\n### 第 2 部分：边界更新函数\n\n位置 $i$ 处元胞的更新规则是 $x_i(t+1) = f(x_{i-1}(t), x_i(t), x_{i+1}(t))$。问题指定了空边界条件，$x_0(t) = 0$ 和 $x_{n+1}(t) = 0$ 对所有时间步 $t$ 成立。\n\n对于左边界元胞 $i=1$，更新函数为：\n$$x_1(t+1) = f(x_0(t), x_1(t), x_2(t)) = f(0, x_1(t), x_2(t))$$\n我们将 $a=0$、$b=x_1(t)$ 和 $c=x_2(t)$ 代入推导出的 ANF：\n$$x_1(t+1) = x_1(t) + x_2(t) + x_1(t)x_2(t) + (0)x_1(t)x_2(t) = x_1(t) + x_2(t) + x_1(t)x_2(t)$$\n\n对于右边界元胞 $i=n$，更新函数为：\n$$x_n(t+1) = f(x_{n-1}(t), x_n(t), x_{n+1}(t)) = f(x_{n-1}(t), x_n(t), 0)$$\n我们将 $a=x_{n-1}(t)$、$b=x_n(t)$ 和 $c=0$ 代入 ANF：\n$$x_n(t+1) = x_n(t) + 0 + x_n(t)(0) + x_{n-1}(t)x_n(t)(0) = x_n(t)$$\n\n### 第 3 部分：演化与整数转换\n\n给定一个大小为 $n=8$ 的格点和初始构型 $x(0) = (1,0,1,1,0,1,0,1)$。我们应用空边界条件 $x_0(0)=0$ 和 $x_9(0)=0$。我们计算下一时间步的状态 $x(1)$。\n\n\\begin{itemize}\n    \\item $x_1(1) = f(x_0(0), x_1(0), x_2(0)) = f(0,1,0) = 1$\n    \\item $x_2(1) = f(x_1(0), x_2(0), x_3(0)) = f(1,0,1) = 1$\n    \\item $x_3(1) = f(x_2(0), x_3(0), x_4(0)) = f(0,1,1) = 1$\n    \\item $x_4(1) = f(x_3(0), x_4(0), x_5(0)) = f(1,1,0) = 1$\n    \\item $x_5(1) = f(x_4(0), x_5(0), x_6(0)) = f(1,0,1) = 1$\n    \\item $x_6(1) = f(x_5(0), x_6(0), x_7(0)) = f(0,1,0) = 1$\n    \\item $x_7(1) = f(x_6(0), x_7(0), x_8(0)) = f(1,0,1) = 1$\n    \\item $x_8(1) = f(x_7(0), x_8(0), x_9(0)) = f(0,1,0) = 1$\n\\end{itemize}\n在 $t=1$ 时得到的构型是 $x(1) = (1,1,1,1,1,1,1,1)$。\n\n最后，我们将此构型解释为一个大端序二进制整数 $I$：\n$$I = \\sum_{i=1}^{8} x_i(1) \\, 2^{8-i}$$\n$$I = x_1(1) \\cdot 2^7 + x_2(1) \\cdot 2^6 + x_3(1) \\cdot 2^5 + x_4(1) \\cdot 2^4 + x_5(1) \\cdot 2^3 + x_6(1) \\cdot 2^2 + x_7(1) \\cdot 2^1 + x_8(1) \\cdot 2^0$$\n代入 $x(1)$ 的值：\n$$I = 1 \\cdot 2^7 + 1 \\cdot 2^6 + 1 \\cdot 2^5 + 1 \\cdot 2^4 + 1 \\cdot 2^3 + 1 \\cdot 2^2 + 1 \\cdot 2^1 + 1 \\cdot 2^0$$\n$$I = 128 + 64 + 32 + 16 + 8 + 4 + 2 + 1$$\n$$I = 2^8 - 1 = 255$$\n整数值为 $255$。",
            "answer": "$$\\boxed{255}$$"
        },
        {
            "introduction": "在研究动力系统的过程中，除了预测未来（正向演化），“追溯过去”（逆向问题）同样重要。这项练习引入了一种来自符号动力学的强大技术，利用德布鲁因图（de Bruijn graph）来精确计算给定状态的前驱状态（preimages）的数量。该方法巧妙地将一个复杂的组合计数问题转化为一个优雅的线性代数计算，展示了不同数学分支在解决复杂系统问题时的交叉与融合。",
            "id": "4134761",
            "problem": "考虑一个一维基本元胞自动机 (ECA)，它由一个局部更新规则 $f:\\{0,1\\}^{3}\\to\\{0,1\\}$ 定义，该规则在具有周期性边界条件的周长为 $L$ 的二元环上同步作用。一个组态是限制在 $L$ 个格点环上的一个双无限二元序列，下一个组态通过将 $f$ 应用于以每个格点为中心的每个长度为3的邻域来获得。二元字母表上的2阶 de Bruijn 图是一个有向图，其顶点集是长度为2的二元词的集合，并且当且仅当顶点 $uv$ 的最后一个符号等于顶点 $vw$ 的第一个符号时，才存在从 $uv$ 到 $vw$ 的有向边；每条这样的边对应于长度为3的词 $uvw$。为了将该图中的路径计数与ECA动力学联系起来，我们为每条有向边分配一个标签 $f(uvw)\\in\\{0,1\\}$，该标签对应于ECA对相关邻域的输出。\n\n任务：从第一性原理和定义出发，推导一个算法，用于计算在环上经过一个ECA时间步后，给定有限二元词 $w\\in\\{0,1\\}^{L}$ 的不同二元原像的数量。您的算法必须通过将计数问题重塑为在2阶 de Bruijn 图中对带标签约束的闭路进行计数，并以一个可以使用整数上的有限维线性代数精确计算的闭合形式表示计数结果。通过在原像与带标签的 de Bruijn 图中长度为 $L$ 的带标签约束的闭路之间建立双射，来证明您的算法的正确性。\n\n验证：将您推导的算法应用于称为规则110的ECA，其 Wolfram 编码按邻域 $uvw\\in\\{111,110,101,100,011,010,001,000\\}$ 的顺序产生的输出 $f(uvw)$ 为 $f(111)=0$, $f(110)=1$, $f(101)=1$, $f(100)=0$, $f(011)=1$, $f(010)=1$, $f(001)=1$, $f(000)=0$。在周长为 $L=5$ 的环上使用周期性边界条件，计算由规则110在环上产生的词 $w=1\\,0\\,1\\,1\\,0$ 的单步原像的精确数量。将您的最终答案表示为单个整数；无需四舍五入。",
            "solution": "该问题是有效的。它是在元胞自动机和符号动力学的既定数学框架内的一个良定问题。它在科学上是合理的、客观的，并包含了得到唯一解所需的所有必要信息。\n\n我们将首先推导通用算法并证明其正确性。然后，我们将其应用于规则110的特定情况。\n\n### 第1部分：原像计数算法的推导\n\n在周长为 $L$ 的环上，一维基本元胞自动机 (ECA) 的一个组态是一个二元序列 $x = (x_0, x_1, \\dots, x_{L-1})$，其中 $x_i \\in \\{0,1\\}$ 且下标在模 $L$ 意义下考虑。其动力学由一个局部更新规则 $f:\\{0,1\\}^3 \\to \\{0,1\\}$ 控制。如果对于每个格点 $i \\in \\{0, 1, \\dots, L-1\\}$，以下条件都成立，则组态 $x$ 是组态 $w = (w_0, w_1, \\dots, w_{L-1})$ 的一个原像：\n$$w_i = f(x_{i-1}, x_i, x_{i+1})$$\n\n问题的核心是对于给定的 $w$ 计算此类组态 $x$ 的数量。我们将此问题重塑为在二元字母表上的2阶 de Bruijn 图 $G$ 上的一个路径计数问题。\n\n$G$ 的顶点是四个长度为2的二元词：$V = \\{00, 01, 10, 11\\}$。对于任意 $u,v,w \\in \\{0,1\\}$，存在一条从顶点 $uv$ 到顶点 $vw$ 的有向边。这条边代表邻域 $uvw$。\n\n**组态与闭路之间的双射：**\n\n让我们在环上的组态与 $G$ 中长度为 $L$ 的闭路之间建立一个双射。\n给定一个组态 $x = (x_0, x_1, \\dots, x_{L-1})$，我们可以定义 $G$ 中的一个包含 $L$ 个顶点的序列，即 $V_i = (x_{i-1}, x_i)$，其中 $i=0, \\dots, L-1$。注意，由于周期性边界条件，$x_{-1} = x_{L-1}$。\n顶点序列为 $P = (V_0, V_1, \\dots, V_{L-1})$。我们来考察从 $V_i$ 到 $V_{i+1}$ 的转移（其中 $V_L = V_0$）。我们有 $V_i = (x_{i-1}, x_i)$ 和 $V_{i+1} = (x_i, x_{i+1})$。$V_i$ 的最后一个符号是 $x_i$，它也是 $V_{i+1}$ 的第一个符号。根据 de Bruijn 图的定义，存在一条从 $V_i$ 到 $V_{i+1}$ 的有向边。这对所有 $i=0, \\dots, L-2$ 都成立。对于最后一步，我们考虑从 $V_{L-1} = (x_{L-2}, x_{L-1})$ 到 $V_0 = (x_{L-1}, x_0)$ 的转移。$V_{L-1}$ 的最后一个符号是 $x_{L-1}$，它也是 $V_0$ 的第一个符号。因此，存在一条从 $V_{L-1}$ 到 $V_0$ 的边。顶点序列 $V_0 \\to V_1 \\to \\dots \\to V_{L-1} \\to V_0$ 构成了 $G$ 中一条长度为 $L$ 的闭路。\n\n反之，给定 $G$ 中任意一条长度为 $L$ 的闭路 $P = (S_0 \\to S_1 \\to \\dots \\to S_{L-1} \\to S_0)$，其中每个 $S_i$ 是一个顶点，我们可以构建一个唯一的组态 $x$。设 $S_i = (u_i, v_i)$。从 $S_i$到 $S_{i+1}=(u_{i+1}, v_{i+1})$ 的边意味着 $v_i = u_{i+1}$。我们定义组态为 $x_i = v_i$，其中 $i=0, \\dots, L-1$。这意味着 $u_{i+1} = x_i$。那么对于 $i=0, \\dots, L-2$，$S_{i+1} = (x_i, x_{i+1})$。我们还有 $S_i = (u_i, v_i) = (u_i, x_i)$。根据边的条件 $v_{i-1} = u_i$，我们得到 $x_{i-1} = u_i$。因此，对于 $i=1, \\dots, L-1$，$S_i = (x_{i-1}, x_i)$。对于 $i=0$，$S_0 = (u_0, v_0) = (u_0, x_0)$。闭路的闭合性意味着存在一条从 $S_{L-1}=(x_{L-2}, x_{L-1})$ 到 $S_0=(u_0, x_0)$ 的边，这要求 $x_{L-1} = u_0$。因此，$S_0 = (x_{L-1}, x_0)$。所构建的序列 $x$ 是一致的，并在环上构成一个有效的组态。\n这就在环上长度为 $L$ 的组态集合与2阶 de Bruijn 图中长度为 $L$ 的闭路集合之间建立了一个双射。\n\n**引入 ECA 规则：**\n\n如果对于所有 $i$ 都有 $w_i = f(x_{i-1}, x_i, x_{i+1})$，则组态 $x$ 是 $w$ 的一个原像。邻域 $(x_{i-1}, x_i, x_{i+1})$ 对应于由 $x$ 定义的路径中从顶点 $V_i = (x_{i-1}, x_i)$到 $V_{i+1} = (x_i, x_{i+1})$ 的边。ECA 规则 $f$ 为这条边分配一个标签 $f(x_{i-1}, x_i, x_{i+1})$。因此，原像条件转化为对相应闭路中边的标签的约束。路径中第 $i$ 条边 $V_i \\to V_{i+1}$ 的标签必须等于 $w_i$。\n\n因此，计算 $w$ 的原像数量等价于计算长度为 $L$ 的闭路 $V_0 \\to V_1 \\to \\dots \\to V_{L-1} \\to V_0$ 的数量，使得边的标签序列恰好是 $(w_0, w_1, \\dots, w_{L-1})$。\n\n**线性代数表述：**\n\n这个带约束的路径计数问题可以使用线性代数来解决。设 $G$ 的顶点从 $j=1$ 到 $4$ 索引。我们定义两个大小为 $4 \\times 4$ 的、依赖于标签的邻接矩阵 $A^{(0)}$ 和 $A^{(1)}$。\n矩阵 $A^{(b)}$ (对于 $b \\in \\{0,1\\}$) 定义如下：\n$$(A^{(b)})_{jk} = \\begin{cases} 1  \\text{如果存在一条从顶点 } j \\text{ 到 } k \\text{ 且标签为 } b \\text{ 的边} \\\\ 0  \\text{否则} \\end{cases}$$\n从顶点 $j$ 到顶点 $k$，边标签序列为 $(w_0, w_1, \\dots, w_{L-1})$ 的长度为 $L$ 的路径数量由以下矩阵乘积的第 $(j,k)$ 个元素给出：\n$$M = A^{(w_0)} A^{(w_1)} \\dots A^{(w_{L-1})}$$\n我们关心的是在同一点开始和结束的闭路。从顶点 $j$ 开始并结束于该顶点的此类路径数量是其对角线元素 $M_{jj}$。对所有可能的起始顶点求和，得到的此类闭路的总数是矩阵 $M$ 的迹。\n\n**算法：**\n1.  枚举2阶 de Bruijn 图的顶点：$v_1=00, v_2=01, v_3=10, v_4=11$。\n2.  对于给定的 ECA 规则 $f$，构建两个 $4 \\times 4$ 矩阵 $A^{(0)}$ 和 $A^{(1)}$。\n3.  对于目标词 $w=(w_0, w_1, \\dots, w_{L-1})$，计算矩阵乘积 $M = \\prod_{i=0}^{L-1} A^{(w_i)}$。\n4.  原像的数量为 $\\mathrm{Tr}(M) = \\sum_{j=1}^4 M_{jj}$。\n\n该算法按要求提供了一个可用有限维线性代数计算的闭合形式的精确计数。其正确性证明源于已建立的双射以及矩阵乘积用于计算有向图中路径数量的标准解释。\n\n### 第2部分：应用于规则110\n\n我们现在应用此算法来计算在大小为 $L=5$ 的环上，对于规则110，词 $w=10110$ 的原像数量。\n\n**1. 系统参数：**\n- 规则110：$f(111)=0, f(110)=1, f(101)=1, f(100)=0, f(011)=1, f(010)=1, f(001)=1, f(000)=0$。\n- 环周长：$L=5$。\n- 目标词：$w = (w_0,w_1,w_2,w_3,w_4) = (1,0,1,1,0)$。\n\n**2. 为规则110构建 $A^{(0)}$ 和 $A^{(1)}$：**\n顶点为 $v_1=00, v_2=01, v_3=10, v_4=11$。在规则110下，边及其标签如下：\n- $v_1 \\to v_1$ (邻域 $000$): $f(000)=0$\n- $v_1 \\to v_2$ (邻域 $001$): $f(001)=1$\n- $v_2 \\to v_3$ (邻域 $010$): $f(010)=1$\n- $v_2 \\to v_4$ (邻域 $011$): $f(011)=1$\n- $v_3 \\to v_1$ (邻域 $100$): $f(100)=0$\n- $v_3 \\to v_2$ (邻域 $101$): $f(101)=1$\n- $v_4 \\to v_3$ (邻域 $110$): $f(110)=1$\n- $v_4 \\to v_4$ (邻域 $111$): $f(111)=0$\n\n由此，我们构建矩阵 $A^{(0)}$ 和 $A^{(1)}$：\n$$\nA^{(0)} = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  0  0  0 \\\\\n1  0  0  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n\\quad\nA^{(1)} = \\begin{pmatrix}\n0  1  0  0 \\\\\n0  0  1  1 \\\\\n0  1  0  0 \\\\\n0  0  1  0\n\\end{pmatrix}\n$$\n\n**3. 计算矩阵乘积：**\n目标词是 $w=10110$。我们必须计算 $M = A^{(1)}A^{(0)}A^{(1)}A^{(1)}A^{(0)}$。\n让我们一步一步地计算这个乘积：\n$M_1 = A^{(1)}A^{(0)} = \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  1 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ 1  0  0  1 \\\\ 0  0  0  0 \\\\ 1  0  0  0 \\end{pmatrix}$\n\n$M_2 = M_1 A^{(1)} = \\begin{pmatrix} 0  0  0  0 \\\\ 1  0  0  1 \\\\ 0  0  0  0 \\\\ 1  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  1 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  1  0 \\\\ 0  0  0  0 \\\\ 0  1  0  0 \\end{pmatrix}$\n\n$M_3 = M_2 A^{(1)} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  1  0 \\\\ 0  0  0  0 \\\\ 0  1  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  1 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  1  1 \\\\ 0  0  0  0 \\\\ 0  0  1  1 \\end{pmatrix}$\n\n$M = M_3 A^{(0)} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  1  1 \\\\ 0  0  0  0 \\\\ 0  0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ 1  0  0  1 \\\\ 0  0  0  0 \\\\ 1  0  0  1 \\end{pmatrix}$\n\n**4. 计算迹：**\n原像的数量是最终矩阵 $M$ 的迹。\n$$ \\mathrm{Tr}(M) = M_{11} + M_{22} + M_{33} + M_{44} = 0 + 0 + 0 + 1 = 1 $$\n在大小为 $L=5$ 的环上，对于规则110，词 $w=10110$ 恰好有一个原像。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}