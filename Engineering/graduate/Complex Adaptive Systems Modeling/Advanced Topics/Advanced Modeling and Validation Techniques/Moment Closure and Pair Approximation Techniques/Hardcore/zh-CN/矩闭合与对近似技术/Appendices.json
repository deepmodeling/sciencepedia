{
    "hands_on_practices": [
        {
            "introduction": "本章的实践练习将从构建动力学模型的基础开始。我们将从一个网络上的 SIS（易感-感染-易感）模型的基本规则出发，通过第一性原理推导节点和连接对密度随时间演化的精确方程。这项练习的核心目标是让您亲眼见证描述连接对的方程如何不可避免地依赖于三元组密度，从而揭示了驱动该领域发展的核心挑战——“矩封闭问题” ()。",
            "id": "4130514",
            "problem": "考虑一个有限、无向、简单的$k$-正则图上的连续时间易感-感染-易感（SIS）接触过程，该图有$N$个节点，每个节点恰好有$k$个邻居。设每条易感-感染边的感染率为$\\lambda  0$，每个感染节点的恢复率为$\\mu  0$。定义以下基序密度，所有密度都由$N$归一化并作为有序结构进行计数：\n- 对于节点状态$X \\in \\{S,I\\}$，令$[X]$表示处于状态$X$的节点的期望数量除以$N$。\n- 对于有序边，令$[XY]$表示有序边$(X \\to Y)$的期望数量除以$N$。因为图是无向的，所以$[SI] = [IS]$始终成立，但我们将保留有序表示法以组织事件的贡献。\n- 对于有序长度为2的路径（三元组），令$[XYZ]$表示具有不同端点和中间节点$Y$的有序路径$X$–$Y$–$Z$的期望数量除以$N$；也就是说，$[XYZ]$计数了中间节点$Y$的有序邻居对，这些邻居对指向状态为$X$和$Z$的端点。\n\n你可以假设由正则性和无向性所蕴含的守恒恒等式，例如$[S] + [I] = 1$、$[SS] + [SI] + [IS] + [II] = k$，以及在所有状态$X,Y,Z \\in \\{S,I\\}$下$[XYZ]$的总和为$k(k-1)$，但不要事先假设任何矩封闭近似。\n\n从第一性原理出发——即，由感染事件（在每条易感-感染边上以速率$\\lambda$独立发生）和恢复事件（在每个感染节点上以速率$\\mu$独立发生）所支配的连续时间马尔可夫动力学，以及对这些事件引起的基序变换进行精确计数——完成以下任务：\n1. 仅用$\\lambda$、$\\mu$、$k$和上面定义的基序密度，推导节点和对密度$\\frac{d}{dt}[I]$和$\\frac{d}{dt}[SI]$的精确时间演化方程。你的推导必须考虑由感染和恢复事件贡献的所有增益和损失，包括因节点状态转换导致的邻近边的变化，并且必须使用三元组密度精确表示$\\frac{d}{dt}[SI]$（不要应用任何封闭近似）。\n2. 将推导扩展到三元组密度，通过象征性地写下$\\frac{d}{dt}[SSI]$和$\\frac{d}{dt}[ISI]$的精确形式，明确展示它们如何依赖于有序长度为3的路径的四元组基序密度（例如，$[WXYZ]$，其中$W,X,Y,Z \\in \\{S,I\\}$），并解释为什么对于有限的$k$，若无额外的近似假设，这种依赖性会阻止在三元组级别的封闭。识别出哪些高阶项会出现，以及它们是如何从三元组的中间节点和端点处的感染和恢复事件中产生的。\n3. 作为最终答案，提供你得到的$\\frac{d}{dt}[SI]$的精确解析表达式，该表达式用$\\lambda$、$\\mu$、$[II]$、$[SI]$、$[SSI]$和$[ISI]$表示。不需要进行数值计算。\n\n你的最终答案必须是单一的闭合形式符号表达式。如果你引入任何额外的符号，必须在推导中明确定义。在推导的第1部分和第2部分中，不要使用任何矩封闭近似。由于最终答案是符号形式的，因此不需要四舍五入或单位。",
            "solution": "该问题要求在一个$k$-正则图上，为一个易感-感染-易感（SIS）模型推导几种基序密度的精确时间演化方程。推导必须基于第一性原理，不应用任何封闭近似。\n\n首先，我将推导感染节点密度$[I]$的方程。然后，我将推导核心结果：易感-感染边密度$[SI]$的方程。最后，我将讨论三元组密度的方程，以说明封闭问题。\n\n令$\\sigma_i \\in \\{S, I\\}$为节点$i$的状态。基序密度定义为对随机过程的期望，并由总节点数$N$归一化。例如，$[I] = \\frac{1}{N} E[\\sum_i \\mathbb{I}(\\sigma_i=I)]$，其中$\\mathbb{I}(\\cdot)$是指示函数。这些期望值的时间演化由底层的连续时间马尔可夫过程的主方程所支配。\n\n**1. $\\frac{d}{dt}[I]$的推导**\n\n感染节点密度$[I]$因两种类型的事件而改变：\n-   **感染**：一个易感节点（$S$）变为感染节点（$I$）。这发生在一条易感-感染（$S-I$）边上。问题陈述感染率是每条$S-I$边$\\lambda$。网络中有序$S-I$边的总数是$N[SI]$。每条这样的边对应一个潜在的感染事件，其中$S$节点变为$I$。系统中感染事件发生的总速率是所有$S$节点速率的总和，即$\\sum_{i|\\sigma_i=S} \\lambda \\times (\\text{节点 } i \\text{ 的 } I \\text{ 邻居数量})$。这个总和恰好是$\\lambda$乘以$S-I$（和$I-S$）边的总数，即$\\lambda N [SI]$。每次感染事件使感染节点数增加1。因此，由于感染导致$N[I]$增加的总速率是$\\lambda N [SI]$。\n-   **恢复**：一个感染节点（$I$）变为易感节点（$S$）。这在每个感染节点上以速率$\\mu$发生。感染节点的总数是$N[I]$。因此，恢复事件发生的总速率是$\\mu N [I]$。每次恢复事件使感染节点数减少1。因此，由于恢复导致$N[I]$减少的总速率是$\\mu N [I]$。\n\n将这些结合起来，得到感染节点期望数量的变化率：\n$$ \\frac{d}{dt}(N[I]) = \\lambda N [SI] - \\mu N [I] $$\n两边除以$N$，我们得到密度$[I]$的演化方程：\n$$ \\frac{d}{dt}[I] = \\lambda [SI] - \\mu [I] $$\n这个方程是精确的，它将节点级密度的变化率与对级密度联系起来，展示了矩层次结构中的特征耦合。\n\n**2. $\\frac{d}{dt}[SI]$的推导**\n\n我们现在推导易感-感染有序边密度$[SI]$的时间演化。我们必须考虑所有产生或销毁$S-I$边的事件。这些事件是感染（$S \\to I$）和恢复（$I \\to S$）。\n\n**感染事件的贡献：**\n感染事件以$\\lambda N [SI]$的总速率发生。让我们考虑一个单一的此类事件，其中一个易感节点$j$因其与一个受感染邻居$i$的连接而变为感染状态。节点$j$的状态从$S$变为$I$。我们分析$S-I$边数量的变化。\n-   **涉及边$(i, j)$的变化：** 连接$i$和$j$的边原本是$I-S$边。事件发生后，它变为$I-I$边。由于图是无向的，这意味着我们失去了一条$S-I$边和一条$I-S$边。对$S-I$边数量的改变是$-1$。\n-   **涉及节点$j$的其他邻居的变化：** 节点$j$有$k-1$个其他邻居（因为图是$k$-正则的）。设$m$是这样一个邻居，$m \\neq i$。\n    -   如果节点$m$处于状态$S$，边$(j, m)$原本是一条$S-S$边。在$j$被感染后，这条边变为$I-S$边。这产生了一条$S-I$边。变化是$+1$。\n    -   如果节点$m$处于状态$I$，边$(j, m)$原本是一条$S-I$边。在$j$被感染后，这条边变为$I-I$边。这销毁了一条$S-I$边。变化是$-1$。\n为了找到总的期望变化，我们对所有感染事件进行平均。一个感染事件会随机选择一条$S-I$边。易感节点$j$（在它连接到一个感染节点$i$的条件下）的$S$和$I$邻居的期望数量由三元组密度决定。\n-   $j$的$S$邻居的期望数量（不包括$i$）由$I-S-S$路径的密度除以$I-S$对的密度给出。根据问题的定义，这是$\\frac{[ISS]}{[IS]}$。由于对于无向图，$[IS]=[SI]$且$[ISS]=[SSI]$，所以这是$\\frac{[SSI]}{[SI]}$。\n-   同样，$j$的$I$邻居的期望数量（不包括$i$）由$I-S-I$路径的密度给出，即$\\frac{[ISI]}{[SI]}$。\n\n每次感染事件中，$S-I$边数量的总期望变化是这些效应的总和：\n$$ \\Delta N_{SI}^{\\text{inf}} = -1 + \\left( (+1) \\times \\frac{[SSI]}{[SI]} \\right) + \\left( (-1) \\times \\frac{[ISI]}{[SI]} \\right) = -1 + \\frac{[SSI] - [ISI]}{[SI]} $$\n由于感染导致$N[SI]$的总变化率是事件发生率乘以每次事件的期望变化：\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{inf}} = (\\lambda N [SI]) \\times \\left(-1 + \\frac{[SSI] - [ISI]}{[SI]}\\right) = \\lambda N (-[SI] + [SSI] - [ISI]) $$\n\n**恢复事件的贡献：**\n恢复事件（$I \\to S$）以$\\mu N [I]$的总速率发生。让我们考虑一个单一的感染节点$j$恢复。我们分析$S-I$边数量的变化。\n-   设$m$是节点$j$的一个邻居。\n    -   如果节点$m$处于状态$S$，边$(j, m)$原本是一条$I-S$边。在$j$恢复后，这条边变为$S-S$边。这销毁了一条$S-I$边。变化是$-1$。\n    -   如果节点$m$处于状态$I$，边$(j, m)$原本是一条$I-I$边。在$j$恢复后，这条边变为$S-I$边。这产生了一条$S-I$边。变化是$+1$。\n为了找到总的期望变化，我们对所有恢复事件进行平均。一个恢复事件会随机选择一个感染节点。一个随机选择的感染节点的$S$和$I$邻居的期望数量由对密度给出。\n-   连接到$I$节点的总边数是$k N[I]$。这必须等于通向$S$节点的边数（$N[SI]$）和通向$I$节点的边数（$N[II]$）之和。因此，$k[I] = [SI] + [II]$。\n-   一个随机$I$节点的$S$邻居的期望数量是$\\frac{N[SI]}{N[I]} = \\frac{[SI]}{[I]}$。\n-   一个随机$I$节点的$I$邻居的期望数量是$\\frac{N[II]}{N[I]} = \\frac{[II]}{[I]}$。\n\n每次恢复事件中，$S-I$边数量的总期望变化是：\n$$ \\Delta N_{SI}^{\\text{rec}} = \\left( (-1) \\times \\frac{[SI]}{[I]} \\right) + \\left( (+1) \\times \\frac{[II]}{[I]} \\right) = \\frac{[II] - [SI]}{[I]} $$\n由于恢复导致$N[SI]$的总变化率是事件发生率乘以每次事件的期望变化：\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{rec}} = (\\mu N [I]) \\times \\left(\\frac{[II] - [SI]}{[I]}\\right) = \\mu N ([II] - [SI]) $$\n\n**$\\frac{d}{dt}[SI]$的完整方程：**\n结合感染和恢复的贡献并除以$N$：\n$$ \\frac{d}{dt}[SI] = \\lambda(-[SI] + [SSI] - [ISI]) + \\mu([II] - [SI]) $$\n重新整理各项，我们得到最终形式：\n$$ \\frac{d}{dt}[SI] = \\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II] $$\n这是$[SI]$对密度演化的精确方程，它依赖于三元组密度$[SSI]$和$[ISI]$。\n\n**3. 层次结构与封闭问题**\n\n为了解这个方程组，我们需要写出出现在$\\frac{d}{dt}[SI]$方程中的三元组密度（如$[SSI]$和$[ISI]$）的演化方程。让我们象征性地考虑$\\frac{d}{dt}[SSI]$的推导，它对应于有序路径$S-S-I$。\n这类三元组的数量可能会改变，如果路径中三个节点中任何一个的状态发生变化，或者距离一步之遥的节点状态发生变化。例如：\n-   **$[SSI]$三元组的产生**：这可能发生于，例如，我们有一个$I-S-I$三元组（$I_u-S_v-I_w$），而端点$u$恢复（$I_u \\to S_u$）。这个事件以速率$\\mu$发生，将一个$[ISI]$三元组转变为一个$[SSI]$三元组。这对$\\frac{d}{dt}[SSI]$贡献一个$+\\mu[ISI]$项。\n-   **$[SSI]$三元组的销毁**：考虑一个$S-S-I$三元组（$S_u-S_v-I_w$）。如果右端点$I_w$恢复，该三元组变为$S-S-S$。这个事件对每个这样的三元组以速率$\\mu$发生，对动力学贡献一个$-\\mu[SSI]$项。\n-   **对四元组的依赖**：一种关键的事件类型是当三元组中的一个节点因三元组*之外*的邻居而改变状态。考虑一个$S-S-S$三元组，$S_u-S_v-S_w$。要使其变为一个$S-S-I$三元组，节点$w$必须被感染。这要求$w$有一个被感染的邻居，比如说$z$。这涉及一条长度为3的路径（一个四元组），$S_u-S_v-S_w-I_z$。在$(w,z)$链路上以速率$\\lambda$发生的感染事件将$[SSS]$三元组转变为$[SSI]$三元组。这个转换的速率依赖于$[SSSI]$四元组的密度。\n\n因此，$\\frac{d}{dt}[SSI]$的精确方程将依赖于诸如$[SSSI]$、$[ISSI]$、$[SSII]$等的四元组密度。例如，一个与$\\lambda [ISSI]$成正比的项将出现在$\\frac{d}{dt}[ISI]$的方程中，因为沿$I-S-S-I$路径传播的感染可以将一个$[SSI]$三元组转换为一个$[ISI]$三元组。\n这展示了一般性问题：大小为$n$的基序密度的导数依赖于大小为$n+1$的基序密度。对于一个大图或无限图，这会产生一个无穷的耦合微分方程层次结构。为了获得一个有限、可解的方程组，必须通过假设一个近似来“封闭”这个层次结构，该近似用低阶矩（例如，对和单体）来表示高阶矩（例如，三元组）。本题要求的是在任何此类封闭*之前*的精确方程，我们已经为对级别推导了它，并为三元组级别进行了讨论。",
            "answer": "$$\\boxed{\\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II]}$$"
        },
        {
            "introduction": "理解了矩封闭问题后，我们转向应用和比较不同的近似方案。在本练习中，我们将分析网络上的一个协调博弈，并分别使用简单的平均场方法和更复杂的对近似方法，来推导达成共识的临界条件。这项练习将突显不同层次的近似如何导致不同的预测结果，并揭示了即使在没有三角形（即聚类系数为零）的情况下，考虑局部相关性也至关重要 ()。",
            "id": "4130526",
            "problem": "考虑一个在大型稀疏网络上的二元协调博弈。该网络由配置模型生成，其度分布为 $P(k)$，平均度为 $z = \\langle k \\rangle$，且聚类系数可忽略不计 $C \\approx 0$。每个节点选择两种策略之一，$A$ 或 $B$。当两个相邻节点协同选择相同策略时，它们都会获得正收益：一条 $A$-$A$ 边为其每个端点产生 $r_A  0$ 的收益，一条 $B$-$B$ 边为其每个端点产生 $r_B  0$ 的收益。在一条 $A$-$B$ 边上，两个端点都获得 $0$ 收益。每个节点累积其所有邻接边的收益总和。行为规则是短视最优响应：在每次更新时，一个节点会切换到能使其在邻居当前策略下瞬时期望收益最大化的策略（平局任意打破）。根据此规则，一个度为 $k$ 的节点，其邻居中有比例为 $q$ 的节点选择策略 $A$，该节点偏好策略 $A$ 的充要条件是\n$$\nr_A \\, q \\ge r_B \\, (1 - q),\n$$\n或者等价地，$q \\ge T$，其中 $T$ 是阈值\n$$\nT := \\frac{r_B}{r_A + r_B}。\n$$\n令 $x$ 表示选择策略 $A$ 的节点的全局比例。令 $[AA]$、$[AB]$ 和 $[BB]$ 分别表示每个节点的预期 $A$-$A$、$A$-$B$ 和 $B$-$B$ 边数，因此 $[AA] + [AB] + [BB] = z$。定义条件邻居概率\n$$\np_{A|A} := \\frac{[AA]}{z x}, \\quad p_{A|B} := \\frac{[AB]}{z (1 - x)}, \\quad p_{B|A} := \\frac{[AB]}{z x}, \\quad p_{B|B} := \\frac{[BB]}{z (1 - x)},\n$$\n这些概率衡量了给定类型的节点，其邻居选择另一种类型的预期比例。假设初始条件在各度类上是同质的，因此每个度类中 $A$ 的初始比例为 $x_k(0) = x(0)$。\n\n在异质平均场近似 (HMF) 下，一个随机节点所看到的邻居构成被替换为全局邻居平均值 $\\theta := \\sum_k \\frac{k P(k)}{z} x_k$。在对近似 (PA) 下，$x$ 的动力学通过条件概率 $p_{A|A}$、$p_{A|B}$ 与对密度 $[AA]$、$[AB]$、$[BB]$ 耦合。\n\n根据上述定义、最优响应规则以及配置模型的结构，回答以下问题：\n\n- 推导异质平均场预测的，从同质度类初始条件开始的 $A$ 的吸引盆的相边界（临界初始比例）$x_c^{\\mathrm{HMF}}$。\n\n- 在对近似下，论证策略 $A$ 平均能够入侵的必要条件是 $p_{A|B} \\ge T$；定义对相关因子\n$$\n\\phi := \\frac{p_{A|B}}{x} = \\frac{[AB]}{z \\, x \\, (1 - x)}。\n$$\n用此表达式来表示对近似的相边界 $x_c^{\\mathrm{PA}}$（用 $T$ 和 $\\phi$ 表示），并确定当同配性相关减少了 $B$ 节点周围 $A$ 邻居的普遍性时（即当 $\\phi  1$ 时），它相对于 $x_c^{\\mathrm{HMF}}$ 的大小关系。\n\n- 定性讨论在对近似中忽略三元组相关（三角形）对具有不可忽略的聚集系数 $C  0$ 的网络上的预测相边界的影响。具体来说，说明忽略三元组是导致 $x_c^{\\mathrm{PA}}$ 系统性地高于还是低于真实的临界比例，以及这种差异如何依赖于 $C$。\n\n哪个选项最能概括定量比较和定性差异？\n\nA. 在 $C \\approx 0$ 的配置模型网络上，异质平均场得出 $x_c^{\\mathrm{HMF}} = T$，而对近似给出 $x_c^{\\mathrm{PA}} = T / \\phi$，其中 $\\phi = [AB] / \\big(z \\, x \\, (1 - x)\\big) \\le 1$，因此 $x_c^{\\mathrm{PA}} \\ge x_c^{\\mathrm{HMF}}$。当聚集系数 $C  0$ 产生三元强化时，真实的临界比例低于对近似的预测值，因此忽略三元组导致了随 $C$ 增长而增大的高估。\n\nB. 对于任何度分布，异质平均场和对近似得出相同的相边界，因为两者都忽略了三角形；没有可归因于对相关的差异，且聚集系数 $C$ 不会改变该预测。\n\nC. 对近似预测 $x_c^{\\mathrm{PA}} = T (1 - C)$，严格低于异质平均场边界，并且忽略三元组使得对近似随着 $C$ 的增加越来越低估临界比例。\n\nD. 对近似得出 $x_c^{\\mathrm{PA}} = T \\, \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$，在异质网络上低于异质平均场边界；三角形对此表达式没有系统性影响。",
            "solution": "此问题要求使用异质平均场 (HMF) 和对近似 (PA) 技术，推导和比较网络协调博弈的临界阈值，并对网络聚集效应进行定性分析。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **博弈：** 策略为 $A$ 和 $B$ 的二元协调博弈。\n- **网络：** 源自配置模型的大型稀疏网络，度分布为 $P(k)$，平均度为 $z = \\langle k \\rangle$，聚集系数可忽略不计 $C \\approx 0$（对于前两部分）。\n- **收益：** 一条 $A$-$A$ 边为每个节点带来 $r_A  0$ 的收益。一条 $B$-$B$ 边为每个节点带来 $r_B  0$ 的收益。一条 $A$-$B$ 边为每个节点带来 $0$ 的收益。\n- **行为规则：** 短视最优响应。一个度为 $k$ 的节点，其邻居中有比例为 $q$ 选择策略 $A$，该节点偏好策略 $A$ 的条件是 $r_A \\, q \\ge r_B \\, (1 - q)$。\n- **阈值：** 切换条件等价于 $q \\ge T$，其中阈值 $T := \\frac{r_B}{r_A + r_B}$。\n- **变量和定义：**\n    - $x$：选择策略 $A$ 的节点的全局比例。\n    - $[AA]$、$[AB]$、$[BB]$：每个节点的预期 $A$-$A$、$A$-$B$ 和 $B$-$B$ 边数，满足 $[AA] + [AB] + [BB] = z$。这被解释为连接到随机节点的各类末端（stubs）的期望数量。\n    - $p_{A|A} := \\frac{[AA]}{z x}$：一个 $A$-节点的邻居是 $A$-节点的条件概率。\n    - $p_{A|B} := \\frac{[AB]}{z (1 - x)}$：一个 $B$-节点的邻居是 $A$-节点的条件概率。\n    - $p_{B|A} := \\frac{[AB]}{z x}$：一个 $A$-节点的邻居是 $B$-节点的条件概率。\n    - $p_{B|B} := \\frac{[BB]}{z (1 - x)}$：一个 $B$-节点的邻居是 $B$-节点的条件概率。\n    - $\\phi := \\frac{p_{A|B}}{x} = \\frac{[AB]}{z \\, x \\, (1 - x)}$：一个对相关因子。\n- **初始条件：** 在各度类上是同质的，$x_k(0) = x(0)$。\n- **近似方法：**\n    - HMF：任何节点所见的邻居构成被全局邻居平均值 $\\theta := \\sum_k \\frac{k P(k)}{z} x_k$ 替代。\n    - PA：动力学使用对密度和条件概率来描述。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于网络科学和统计物理这一成熟领域，具体来说是模拟复杂网络上的社会动力学（协调博弈）。配置模型、短视最优响应、异质平均场理论和对近似等概念是该领域的标准工具。该问题在科学上是合理的。\n- **良态性：** 问题要求在明确定义的理论近似下推导特定量（$x_c^{\\mathrm{HMF}}$、$x_c^{\\mathrm{PA}}$）。问题结构清晰，旨在引导出一个明确的定量比较和定性结论。\n- **客观性：** 语言正式、数学化，没有主观或含糊的术语。\n- **完整性与一致性：** 给定的定义，包括对 $[XY]$ 的略微非传统的定义，是自洽的。给定类型节点的条件概率之和为 $1$：对于一个 $A$-节点，$p_{A|A} + p_{B|A} = ([AA] + [AB])/(zx)$。项 $[AA]+[AB]$ 代表每个节点连接到 $A$-节点的预期末端数，即 $\\frac{1}{N}\\sum_{v \\in V_A} k_v = \\sum_k k P(k) x_k$。分母 $zx$ 暗示了 $x_k=x$ 对所有 $k$ 成立的假设，这使得 $\\sum_k k P(k) x_k = x \\sum_k k P(k) = xz$。此假设在初始条件下已给出，并且在分析此类系统稳定点时是标准做法。所有必要信息均已提供。\n\n**步骤3：结论与行动**\n问题陈述有效、科学上合理且良态。我们可以着手求解。\n\n### 相边界的推导\n\n**1. 异质平均场 (HMF) 边界, $x_c^{\\mathrm{HMF}}$**\n\n根据所述的 HMF 近似，任何节点所见的 A-邻居比例都由全局平均值 $\\theta = \\sum_k \\frac{k P(k)}{z} x_k$ 近似。\n一个节点偏好策略 $A$ 的条件是其邻居中选择 $A$ 的比例至少为 $T$。在 HMF 中，此条件变为 $\\theta \\ge T$。\n\n动力学由一个全局反馈回路表征：如果 $\\theta(t) \\ge T$，所有节点都会看到切换到 $A$ 的条件得到满足，并将在下一步骤采纳策略 $A$，导致 $x(t+1) = 1$ 和 $\\theta(t+1) = 1$。如果 $\\theta(t)  T$，所有节点将采纳策略 $B$，导致 $x(t+1) = 0$ 和 $\\theta(t+1) = 0$。\n\n系统的最终命运由 $\\theta$ 的初始值决定。我们已知同质的初始条件：对所有度类 $k$，$x_k(0) = x(0)$。\n令初始全局比例为 $x_0 = x(0)$。$\\theta$ 的初始值为：\n$$\n\\theta(0) = \\sum_k \\frac{k P(k)}{z} x_k(0) = \\sum_k \\frac{k P(k)}{z} x_0 = x_0 \\frac{1}{z} \\sum_k k P(k)\n$$\n由于 $z = \\langle k \\rangle = \\sum_k k P(k)$，这简化为：\n$$\n\\theta(0) = x_0 \\frac{z}{z} = x_0\n$$\n如果 $\\theta(0) \\ge T$，系统将级联到全-$A$ 状态，这转化为 $x_0 \\ge T$。临界初始比例是吸引盆边界上的值，因此：\n$$\nx_c^{\\mathrm{HMF}} = T\n$$\n\n**2. 对近似 (PA) 边界, $x_c^{\\mathrm{PA}}$**\n\n对近似通过考虑节点的类型来确定其邻域的构成，从而解释了一阶相关性。策略 $A$ 入侵一个由 $B$ 玩家组成的群体的条件是，平均而言，一个 $B$-节点发现切换到 $A$ 是有利可图的。\n\n一个 $B$-节点如果其 $A$-邻居的比例 $q_B$ 满足 $q_B \\ge T$ 则会切换。为了使入侵平均能够成功，一个随机选择的 $B$-节点的 $A$-邻居的*期望*比例必须达到这个阈值。这个期望比例由条件概率 $p_{A|B}$ 给出。\n因此，策略 $A$ 入侵的临界条件是：\n$$\np_{A|B} = T\n$$\n问题定义了对相关因子 $\\phi = \\frac{p_{A|B}}{x}$。在临界比例 $x_c^{\\mathrm{PA}}$ 处，我们有：\n$$\n\\phi \\, x_c^{\\mathrm{PA}} = T\n$$\n求解对近似下的临界比例得到：\n$$\nx_c^{\\mathrm{PA}} = \\frac{T}{\\phi}\n$$\n\n**$x_c^{\\mathrm{PA}}$ 和 $x_c^{\\mathrm{HMF}}$ 的比较**\n\n我们有 $x_c^{\\mathrm{HMF}} = T$ 和 $x_c^{\\mathrm{PA}} = T/\\phi$。问题要求考虑“同配性相关减少了 $B$ 节点周围 $A$ 邻居的普遍性”的情况。\n-   在一个不相关的网络中（由 HMF 近似），一个 $B$-节点的邻居是 $A$-节点的概率就是随机选择一个末端连接到 $A$-节点的全局概率，即 $\\theta$。对于同质比例 $x_k=x$，这便是 $\\theta=x$。所以在不相关的情况下，$p_{A|B} \\approx x$，这意味着 $\\phi = p_{A|B}/x \\approx 1$。\n-   同配性混合（同质性）意味着节点倾向于连接到相同类型的其他节点。这暗示了 $A$-$B$ 边的数量比在随机网络中要少。\n-   “减少了 $B$ 节点周围 $A$ 邻居的普遍性”直接说明了 $p_{A|B}  x$。\n-   这意味着相关因子 $\\phi = p_{A|B}/x  1$。\n-   当 $\\phi  1$ 时，我们有 $1/\\phi > 1$，因此 $x_c^{\\mathrm{PA}} = T/\\phi > T = x_c^{\\mathrm{HMF}}$。\n-   包括不相关网络中 $\\phi=1$ 的情况，普遍关系是 $x_c^{\\mathrm{PA}} \\ge x_c^{\\mathrm{HMF}}$。\n\n**3. 忽略三角形的影响 (聚集, $C > 0$)**\n\n对近似在树（$C=0$）上是精确的，但忽略了高阶相关，例如由三角形（聚集）体现的相关。在协调博弈中，聚集引入了一种强大的强化机制。\n-   如果一个节点有两个邻居，在 PA 的世界里（$C=0$），这两个邻居被假定为不相连的。\n-   当 $C>0$ 时，这两个邻居自身相连的概率增加，从而与原始节点形成一个三角形。\n-   考虑一个正在评估是否切换的 $B$-节点。如果它的一个邻居是 $A$，在一个聚集的网络中，这个 $A$-邻居更有可能连接到该中心节点的其他邻居。如果选择 $A$ 策略的节点形成一个局部集群，这种三元闭包会为局部群体的所有成员提供相互支持，并使选择 $A$ 对他们来说更为稳固。\n-   这种“社会强化”意味着一小群 $A$-策略者可以更容易地维持自身并扩张。它使得协调更容易达成。\n-   因此，在聚集网络上触发全局级联至状态 $A$ 所需的真实临界初始采纳者比例 $x_c^{\\mathrm{true}}$，要*低于*其他属性相似但无聚集的网络。\n-   对近似通过忽略这种强化机制，未能捕捉到这一效应。它实际上模拟了一个对协调不太有利的环境。因此，PA 模型需要一个更高的初始 $A$ 玩家比例来预测级联的发生。\n-   这意味着对近似系统地 *高估* 了真实的临界比例：$x_c^{\\mathrm{PA}} > x_c^{\\mathrm{true}}$。这种差异（高估）自然会随着强化效应强度的增加而增加，这对应于聚集系数 $C$ 的增加。\n\n### 逐项分析\n\n**A. 在 $C \\approx 0$ 的配置模型网络上，异质平均场得出 $x_c^{\\mathrm{HMF}} = T$，而对近似给出 $x_c^{\\mathrm{PA}} = T / \\phi$，其中 $\\phi = [AB] / \\big(z \\, x \\, (1 - x)\\big) \\le 1$，因此 $x_c^{\\mathrm{PA}} \\ge x_c^{\\mathrm{HMF}}$。当聚集系数 $C  0$ 产生三元强化时，真实的临界比例低于对近似的预测值，因此忽略三元组导致了随 $C$ 增长而增大的高估。**\n-   推导 $x_c^{\\mathrm{HMF}} = T$ 是正确的。\n-   推导 $x_c^{\\mathrm{PA}} = T / \\phi$ 和 $\\phi$ 的定义是正确的。\n-   条件 $\\phi \\le 1$ 对应于同配性或随机相关，从而得出正确的结论 $x_c^{\\mathrm{PA}} \\ge x_c^{\\mathrm{HMF}}$。\n-   对聚集的定性分析也是正确的：PA 忽略了三元强化，导致对临界阈值的高估，并且这个误差随 $C$ 增大而增大。\n-   **结论：正确。**\n\n**B. 对于任何度分布，异质平均场和对近似得出相同的相边界，因为两者都忽略了三角形；没有可归因于对相关的差异，且聚集系数 $C$ 不会改变该预测。**\n-   这是不正确的。HMF 和 PA 仅在没有对相关（$\\phi=1$）的情况下得出相同的边界。PA 专门用于捕捉这些相关性，从而导致不同的预测。两者都忽略三角形是事实，但这与它们在 $C \\approx 0$ 网络上的初步比较无关。\n-   **结论：不正确。**\n\n**C. 对近似预测 $x_c^{\\mathrm{PA}} = T (1 - C)$，严格低于异质平均场边界，并且忽略三元组使得对近似随着 $C$ 的增加越来越低估临界比例。**\n-   公式 $x_c^{\\mathrm{PA}} = T (1 - C)$ 不是从给定的前提中推导出来的，并且是不正确的。\n-   声称 $x_c^{\\mathrm{PA}}$ 严格低于 $x_c^{\\mathrm{HMF}}$ 与我们的发现 $x_c^{\\mathrm{PA}} \\ge x_c^{\\mathrm{HMF}}$ 相矛盾。\n-   声称 PA *低估* 了临界比例与正确结论（它高估了）相反。\n-   **结论：不正确。**\n\n**D. 对近似得出 $x_c^{\\mathrm{PA}} = T \\, \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$，在异质网络上低于异质平均场边界；三角形对此表达式没有系统性影响。**\n-   公式 $x_c^{\\mathrm{PA}} = T \\, \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$ 是不正确的。这个表达式与逾渗理论有关，不直接适用于此协调博弈的 PA 吸引盆边界。\n-   关于三角形没有系统性影响的说法，误解了问题最后一部分的要求，该部分正是要求分析忽略三角形的系统性影响。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "当理论模型能够与现实世界的观测数据相结合时，它们的力量才会真正显现。最后的这项练习将通过将矩封闭近似的选择构建为一个参数估计问题，来弥合理论与数据之间的鸿沟。您将推导并实现一种方法，以找到最能拟合一组假设观测数据的最优封闭参数，这是任何计算建模者都应具备的关键技能 ()。",
            "id": "4130524",
            "problem": "考虑一个在复杂自适应系统（CAS）框架下的，位于静态同质网络上的易感-感染-易感（SIS）传播过程。在对近似（PA）中，我们关注的动力学变量是标准化的易感-感染对密度，记为 $[SI](t)$。PA 方法通过对三元组密度进行假设来闭合高阶项，从而推导出节点和对密度随时间演化的常微分方程（ODE）。一个参数化的闭合族引入了一个标量参数 $\\alpha \\in \\mathbb{R}$，该参数在不同程度的聚类或依赖性之间进行插值，例如，通过 $[ABC] \\approx \\alpha \\cdot \\Phi([AB],[BC],[B])$ 来近似三元组，其中 $\\Phi(\\cdot)$ 是一个与度为 k 的约束一致的、关于对密度和单节点密度的有理函数。\n\n假设有一个短时观测数据集 $\\{(t_i,y_i)\\}_{i=1}^n$，其中 $y_i$ 是 $[SI](t_i)$ 的观测值，表示为区间 $[0,1]$ 内的一个无量纲分数。在对 PA 常微分方程关于 $\\alpha$ 进行一阶灵敏度分析时，模型在观测时刻预测的对密度可以近似为 $\\alpha$ 的一个仿射函数，\n$$\n[SI]_{\\text{model}}(t_i;\\alpha) \\approx A_i + \\alpha B_i,\n$$\n其中 $A_i \\in \\mathbb{R}$ 和 $B_i \\in \\mathbb{R}$ 是通过围绕一个基准闭合（例如 $\\alpha = 0$）进行线性化得到的系数，并被视为给定值。设 $w_i \\ge 0$ 为非负权重，$\\lambda \\ge 0$ 为正则化参数。定义加权的 Tikhonov 正则化最小二乘损失\n$$\nL(\\alpha) = \\sum_{i=1}^n w_i \\left(A_i + \\alpha B_i - y_i\\right)^2 + \\lambda \\alpha^2.\n$$\n您的任务是：\n- 从对近似和参数化闭合的基本定义出发，依据第一性原理推导为何一阶仿射近似 $[SI]_{\\text{model}}(t_i;\\alpha) \\approx A_i + \\alpha B_i$ 在 $\\alpha$ 的小扰动下是科学有效的，并证明损失 $L(\\alpha)$ 在适当条件下是凸的且具有唯一的最小化子。提供最小化子的显式公式以及确保存在性和唯一性的精确条件。\n- 实现一个程序，在给定系数 $\\{A_i\\}$、$\\{B_i\\}$、$\\{y_i\\}$、$\\{w_i\\}$ 和 $\\lambda$ 的情况下，计算存在的唯一最小化子 $\\alpha^\\star$。如果闭式解中的分母为零（因此最小化子不唯一），您的程序应为该测试用例返回 IEEE 非数值 (NaN) 浮点值。\n\n所有量都是无量纲的。不涉及角度。所有分数量都应作为小数处理（例如，用 $0.25$ 而不是百分比形式的 $25$）。\n\n测试套件：\n您必须硬编码以下测试用例，并为每个用例计算 $\\alpha^\\star$。每个用例由元组 $(n,\\{A_i\\},\\{B_i\\},\\{y_i\\},\\{w_i\\},\\lambda)$ 定义。\n\n- 用例 1（通用，良态）：\n  - $n = 6$\n  - $\\{A_i\\} = [0.12, 0.15, 0.18, 0.16, 0.14, 0.17]$\n  - $\\{B_i\\} = [0.8, 0.6, 0.5, 0.7, 0.9, 0.4]$\n  - $\\{y_i\\} = [0.13, 0.20, 0.19, 0.15, 0.16, 0.18]$\n  - $\\{w_i\\} = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0]$\n  - $\\lambda = 0.05$\n\n- 用例 2（无正则化，混合灵敏度）：\n  - $n = 4$\n  - $\\{A_i\\} = [0.20, 0.22, 0.21, 0.23]$\n  - $\\{B_i\\} = [-0.30, 0.40, -0.20, 0.50]$\n  - $\\{y_i\\} = [0.19, 0.25, 0.20, 0.24]$\n  - $\\{w_i\\} = [1.5, 0.5, 2.0, 1.0]$\n  - $\\lambda = 0.00$\n\n- 用例 3（所有权重为零，纯正则化）：\n  - $n = 3$\n  - $\\{A_i\\} = [0.10, 0.10, 0.10]$\n  - $\\{B_i\\} = [0.20, -0.10, 0.00]$\n  - $\\{y_i\\} = [0.10, 0.10, 0.10]$\n  - $\\{w_i\\} = [0.0, 0.0, 0.0]$\n  - $\\lambda = 0.10$\n\n- 用例 4（接近边界：微小灵敏度，微小正则化，不同权重）：\n  - $n = 5$\n  - $\\{A_i\\} = [0.05, 0.06, 0.055, 0.058, 0.052]$\n  - $\\{B_i\\} = [0.0001, -0.0002, 0.00015, -0.0001, 0.00025]$\n  - $\\{y_i\\} = [0.051, 0.061, 0.056, 0.059, 0.053]$\n  - $\\{w_i\\} = [200.0, 100.0, 50.0, 80.0, 70.0]$\n  - $\\lambda = 0.00000001$\n\n- 用例 5（强正则化主导）：\n  - $n = 4$\n  - $\\{A_i\\} = [0.30, 0.28, 0.29, 0.27]$\n  - $\\{B_i\\} = [1.20, 1.00, 0.80, 1.10]$\n  - $\\{y_i\\} = [0.32, 0.30, 0.33, 0.31]$\n  - $\\{w_i\\} = [1.0, 1.0, 1.0, 1.0]$\n  - $\\lambda = 10.00$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots,result_5]$），其中每个 $result_j$ 是按上述顺序列出的用例 j 计算出的 $\\alpha^\\star$。",
            "solution": "对问题陈述的有效性进行评估。\n\n### 步骤 1：提取给定信息\n- **模型：** 静态同质网络上的易感-感染-易感（SIS）模型。\n- **方法：** 对近似（PA）。\n- **闭合方案：** 一个带有参数 $\\alpha \\in \\mathbb{R}$ 的参数化闭合族，其中三元组近似为 $[ABC] \\approx \\alpha \\cdot \\Phi([AB],[BC],[B])$。\n- **观测数据：** 一个数据集 $\\{(t_i,y_i)\\}_{i=1}^n$，其中 $y_i$ 是观测到的标准化的易感-感染对密度 $[SI](t_i)$。\n- **模型近似：** 一阶灵敏度分析导出了模型预测的对密度的仿射近似：$[SI]_{\\text{model}}(t_i;\\alpha) \\approx A_i + \\alpha B_i$。\n- **系数：** $A_i, B_i \\in \\mathbb{R}$ 是通过线性化得到的给定系数。\n- **权重：** $w_i \\ge 0$ 是给定的非负权重。\n- **正则化：** $\\lambda \\ge 0$ 是一个给定的非负 Tikhonov 正则化参数。\n- **损失函数：** 目标是最小化加权的正则化最小二乘损失函数 $L(\\alpha)$：\n$$L(\\alpha) = \\sum_{i=1}^n w_i \\left(A_i + \\alpha B_i - y_i\\right)^2 + \\lambda \\alpha^2.$$\n- **任务：**\n    1.  推导仿射近似 $[SI]_{\\text{model}}(t_i;\\alpha) \\approx A_i + \\alpha B_i$ 的科学有效性。\n    2.  证明 $L(\\alpha)$ 是凸的，并在特定条件下具有唯一的最小化子。\n    3.  提供最小化子 $\\alpha^\\star$ 的显式公式以及存在性和唯一性的条件。\n    4.  实现一个程序，为给定的测试套件计算 $\\alpha^\\star$。\n    5.  通过返回 IEEE 非数值 (NaN) 来处理非唯一最小化子的情况。\n- **测试套件：** 提供了五个具体的测试用例，包含 $n$、$\\{A_i\\}$、$\\{B_i\\}$、$\\{y_i\\}$、$\\{w_i\\}$ 和 $\\lambda$ 的值。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学基础：** 该问题牢固地植根于数学流行病学和复杂系统建模等成熟领域。SIS 模型、对近似、矩闭合技术和参数化闭合都是标准概念。灵敏度分析（导出仿射近似）和 Tikhonov 正则化是用于参数估计和求解反问题的基础且广泛使用的数学方法。该设定在其领域内是科学合理且切合实际的。\n- **适定性：** 该问题提供了一个明确定义的数学目标（最小化 $L(\\alpha)$），并要求完成具体的、形式化的任务（推导、分析、实现）。它结构良好，并能导出一个可确定的结果。唯一性问题是要解决的问题的一部分，而不是其规范中的缺陷。\n- **客观性：** 该问题以精确、形式化和客观的数学语言陈述，没有歧义或主观看法。\n- **总体评估：** 该问题不违反任何无效标准。它是一个在应用数学和计算科学领域内完整、一致且科学合理的问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 理论推导\n\n#### 仿射近似的合理性\n在带有参数化闭合的对近似下，系统的动力学由一个常微分方程（ODE）组描述。设系统的状态由一个密度向量 $\\mathbf{z}(t)$ 表示，其中包括 $[S](t)$、$[I](t)$ 和 $[SI](t)$ 等量。闭合参数 $\\alpha$ 进入向量场的定义中，因此系统可以写成：\n$$\n\\frac{d\\mathbf{z}}{dt} = \\mathbf{F}(\\mathbf{z}, \\alpha)\n$$\n给定初始条件 $\\mathbf{z}(0)$，在任意时刻 $t$ 的解是参数 $\\alpha$ 的函数，即 $\\mathbf{z}(t; \\alpha)$。模型在时刻 $t_i$ 对易感-感染对密度的预测是该解向量的一个分量，即 $[SI]_{\\text{model}}(t_i; \\alpha)$。\n\n假设函数 $\\mathbf{F}$ 对其参数足够平滑，那么解 $\\mathbf{z}(t; \\alpha)$ 也将是关于 $\\alpha$ 的一个平滑（可微）函数。$[SI]_{\\text{model}}(t_i; \\alpha)$ 在一个基准值（例如 $\\alpha_0 = 0$）附近的一阶泰勒级数展开为：\n$$\n[SI]_{\\text{model}}(t_i; \\alpha) \\approx [SI]_{\\text{model}}(t_i; \\alpha_0) + (\\alpha - \\alpha_0) \\left. \\frac{\\partial [SI]_{\\text{model}}(t_i; \\alpha)}{\\partial \\alpha} \\right|_{\\alpha=\\alpha_0}\n$$\n将基准值设为 $\\alpha_0 = 0$，上式简化为：\n$$\n[SI]_{\\text{model}}(t_i; \\alpha) \\approx [SI]_{\\text{model}}(t_i; 0) + \\alpha \\left. \\frac{\\partial [SI]_{\\text{model}}(t_i; \\alpha)}{\\partial \\alpha} \\right|_{\\alpha=0}\n$$\n这是一个关于 $\\alpha$ 的仿射函数。通过将常数和线性系数确定为\n$$\nA_i = [SI]_{\\text{model}}(t_i; 0) \\quad \\text{和} \\quad B_i = \\left. \\frac{\\partial [SI]_{\\text{model}}(t_i; \\alpha)}{\\partial \\alpha} \\right|_{\\alpha=0}\n$$\n我们便得到了所述的近似 $[SI]_{\\text{model}}(t_i; \\alpha) \\approx A_i + \\alpha B_i$。这种近似作为一阶灵敏度分析是科学有效的，这是一项在动力系统研究中标准而严谨的技术。其准确性取决于 $\\alpha$ 的大小和高阶导数项的大小，但其形式推导是合理的。\n\n#### 损失函数 $L(\\alpha)$ 的最小化\n损失函数由下式给出：\n$$\nL(\\alpha) = \\sum_{i=1}^n w_i \\left(A_i + \\alpha B_i - y_i\\right)^2 + \\lambda \\alpha^2\n$$\n为了找到最小化 $L(\\alpha)$ 的 $\\alpha$ 值（记为 $\\alpha^\\star$），我们使用微分学。我们必须通过将 $L(\\alpha)$ 对 $\\alpha$ 的一阶导数设为零来找到临界点。\n\n一阶导数：\n$$\n\\frac{dL}{d\\alpha} = \\frac{d}{d\\alpha} \\left[ \\sum_{i=1}^n w_i (A_i + \\alpha B_i - y_i)^2 + \\lambda \\alpha^2 \\right]\n$$\n使用链式法则和微分算子的线性性：\n$$\n\\frac{dL}{d\\alpha} = \\sum_{i=1}^n w_i \\cdot 2(A_i + \\alpha B_i - y_i) \\cdot B_i + 2\\lambda\\alpha\n$$\n$$\n\\frac{dL}{d\\alpha} = 2 \\sum_{i=1}^n w_i B_i (A_i - y_i) + 2\\alpha \\sum_{i=1}^n w_i B_i^2 + 2\\lambda\\alpha\n$$\n$$\n\\frac{dL}{d\\alpha} = 2 \\left( \\sum_{i=1}^n w_i B_i (A_i - y_i) + \\alpha \\left( \\sum_{i=1}^n w_i B_i^2 + \\lambda \\right) \\right)\n$$\n将一阶导数设为零，$\\frac{dL}{d\\alpha} = 0$：\n$$\n\\alpha \\left( \\sum_{i=1}^n w_i B_i^2 + \\lambda \\right) = - \\sum_{i=1}^n w_i B_i (A_i - y_i)\n$$\n$$\n\\alpha \\left( \\sum_{i=1}^n w_i B_i^2 + \\lambda \\right) = \\sum_{i=1}^n w_i B_i (y_i - A_i)\n$$\n解出 $\\alpha$ 即可得到候选最小化子 $\\alpha^\\star$：\n$$\n\\alpha^\\star = \\frac{\\sum_{i=1}^n w_i B_i (y_i - A_i)}{\\sum_{i=1}^n w_i B_i^2 + \\lambda}\n$$\n\n#### 凸性、存在性和唯一性\n为了确定此临界点的性质，我们考察 $L(\\alpha)$ 的二阶导数：\n$$\n\\frac{d^2L}{d\\alpha^2} = \\frac{d}{d\\alpha} \\left[ 2 \\left( \\sum_{i=1}^n w_i B_i (A_i - y_i) + \\alpha \\left( \\sum_{i=1}^n w_i B_i^2 + \\lambda \\right) \\right) \\right]\n$$\n$$\n\\frac{d^2L}{d\\alpha^2} = 2 \\left( \\sum_{i=1}^n w_i B_i^2 + \\lambda \\right)\n$$\n如果一个函数的二阶导数处处非负，则该函数是凸函数。我们已知 $w_i \\ge 0$ 且 $\\lambda \\ge 0$。项 $B_i^2$ 总是非负的。因此，二阶导数表达式中的每一项都是非负的：\n$$\nw_i B_i^2 \\ge 0 \\quad \\forall i\n$$\n$$\n\\sum_{i=1}^n w_i B_i^2 \\ge 0\n$$\n$$\n\\frac{d^2L}{d\\alpha^2} = 2 \\left( \\underbrace{\\sum_{i=1}^n w_i B_i^2}_{\\ge 0} + \\underbrace{\\lambda}_{\\ge 0} \\right) \\ge 0\n$$\n这证明了 $L(\\alpha)$ 是一个凸函数。凸函数的临界点是全局最小值点。\n\n为使最小值是**唯一的**，函数必须是**严格凸**的，这要求二阶导数严格为正：\n$$\n\\frac{d^2L}{d\\alpha^2} > 0 \\implies \\sum_{i=1}^n w_i B_i^2 + \\lambda > 0\n$$\n这是存在唯一最小化子的条件。该条件等价于 $\\alpha^\\star$ 表达式中的分母不为零。由于分母是非负项之和，它为零当且仅当所有项同时为零，即 $\\lambda = 0$ 并且对所有 $i=1, \\dots, n$ 都有 $w_i B_i^2 = 0$。\n\n**关于唯一性的结论：**\n- 唯一最小化子 $\\alpha^\\star$ 存在当且仅当 $\\sum_{i=1}^n w_i B_i^2 + \\lambda > 0$。\n- 如果 $\\lambda > 0$，此条件始终满足。\n- 如果 $\\lambda = 0$，则当存在至少一个索引 $i$ 使得 $w_i > 0$ 且 $B_i \\neq 0$ 时，此条件满足。\n- 如果条件不满足（即分母为零），则二阶导数为零。这意味着 $L(\\alpha)$ 相对于 $\\alpha$ 是常数（如果分子也为零）或者有一个线性项但没有二次项（如果分子非零，此时没有最小值）。在任何一种情况下，都不存在唯一的、有限的最小化子。按照要求，这种情况应通过返回 NaN 来标记。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal closure parameter alpha_star for a series of test cases\n    based on a regularized weighted least-squares loss function.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (n, A_i, B_i, y_i, w_i, lambda)\n        (\n            6,\n            [0.12, 0.15, 0.18, 0.16, 0.14, 0.17],\n            [0.8, 0.6, 0.5, 0.7, 0.9, 0.4],\n            [0.13, 0.20, 0.19, 0.15, 0.16, 0.18],\n            [1.0, 1.0, 1.0, 1.0, 1.0, 1.0],\n            0.05\n        ),\n        # Case 2: (n, A_i, B_i, y_i, w_i, lambda)\n        (\n            4,\n            [0.20, 0.22, 0.21, 0.23],\n            [-0.30, 0.40, -0.20, 0.50],\n            [0.19, 0.25, 0.20, 0.24],\n            [1.5, 0.5, 2.0, 1.0],\n            0.00\n        ),\n        # Case 3: (n, A_i, B_i, y_i, w_i, lambda)\n        (\n            3,\n            [0.10, 0.10, 0.10],\n            [0.20, -0.10, 0.00],\n            [0.10, 0.10, 0.10],\n            [0.0, 0.0, 0.0],\n            0.10\n        ),\n        # Case 4: (n, A_i, B_i, y_i, w_i, lambda)\n        (\n            5,\n            [0.05, 0.06, 0.055, 0.058, 0.052],\n            [0.0001, -0.0002, 0.00015, -0.0001, 0.00025],\n            [0.051, 0.061, 0.056, 0.059, 0.053],\n            [200.0, 100.0, 50.0, 80.0, 70.0],\n            0.00000001\n        ),\n        # Case 5: (n, A_i, B_i, y_i, w_i, lambda)\n        (\n            4,\n            [0.30, 0.28, 0.29, 0.27],\n            [1.20, 1.00, 0.80, 1.10],\n            [0.32, 0.30, 0.33, 0.31],\n            [1.0, 1.0, 1.0, 1.0],\n            10.00\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for the current test case\n        n, A_list, B_list, y_list, w_list, lam_val = case\n        \n        # Convert lists to NumPy arrays for vectorized operations\n        A = np.array(A_list)\n        B = np.array(B_list)\n        y = np.array(y_list)\n        w = np.array(w_list)\n        \n        # The minimizer alpha_star is given by the formula:\n        # alpha_star = sum(w_i * B_i * (y_i - A_i)) / (sum(w_i * B_i^2) + lambda)\n        \n        # Calculate the numerator of the formula\n        numerator = np.sum(w * B * (y - A))\n        \n        # Calculate the denominator of the formula\n        denominator = np.sum(w * B**2) + lam_val\n        \n        # Check for the condition where the minimizer is not unique\n        # This occurs when the denominator is zero.\n        if denominator == 0.0:\n            alpha_star = np.nan\n        else:\n            alpha_star = numerator / denominator\n            \n        results.append(alpha_star)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}