{
    "hands_on_practices": [
        {
            "introduction": "The necessity of moment closure techniques stems from the coupled nature of motif dynamics in networked systems. This foundational exercise guides you through the derivation of exact rate equations for an SIS epidemic model, starting from the density of infected nodes $[I]$ and proceeding to susceptible-infected pairs $[SI]$ . By performing this derivation from first principles, you will see precisely how the change in a motif's density depends on the density of larger motifs, illustrating the infinite hierarchy problem that closure methods aim to solve.",
            "id": "4130514",
            "problem": "Consider a continuous-time susceptible-infected-susceptible (SIS) contact process on a finite, undirected, simple, $k$-regular graph with $N$ nodes, where every node has exactly $k$ neighbors. Let the infection rate per susceptible-infected edge be $\\lambda > 0$ and the recovery rate per infected node be $\\mu > 0$. Define the following motif densities, all normalized by $N$ and counted as ordered structures:\n- For a node state $X \\in \\{S,I\\}$, let $[X]$ denote the expected number of nodes in state $X$ divided by $N$.\n- For ordered edges, let $[XY]$ denote the expected number of ordered edges $(X \\to Y)$ divided by $N$. Because the graph is undirected, $[SI] = [IS]$ holds at all times, but we will retain ordered notation to organize event contributions.\n- For ordered length-$2$ paths (triples), let $[XYZ]$ denote the expected number of ordered paths $X$–$Y$–$Z$ with distinct endpoints and middle node $Y$, divided by $N$; that is, $[XYZ]$ counts ordered neighbor pairs of the middle node $Y$ leading to endpoints in states $X$ and $Z$.\n\nYou may assume conservation identities implied by regularity and undirectedness, such as $[S] + [I] = 1$, $[SS] + [SI] + [IS] + [II] = k$, and that the sum of $[XYZ]$ over all states $X,Y,Z \\in \\{S,I\\}$ is $k(k-1)$, but do not assume any moment closure approximations a priori.\n\nStarting from first principles—namely, the continuous-time Markov dynamics governed by the infection events occurring independently on each susceptible-infected edge at rate $\\lambda$ and recovery events occurring independently at each infected node at rate $\\mu$, together with exact counting of motif transformations induced by these events—do the following:\n1. Derive the exact time-evolution equations for the node and pair densities, $\\frac{d}{dt}[I]$ and $\\frac{d}{dt}[SI]$, in terms of only $\\lambda$, $\\mu$, $k$, and the motif densities defined above. Your derivation must account for all gains and losses contributed by infection and recovery events, including the changes to neighboring edges resulting from a node state transition, and it must express $\\frac{d}{dt}[SI]$ exactly using triple densities (do not apply any closure approximations).\n2. Extend the derivation to the triple densities by writing down the exact form of $\\frac{d}{dt}[SSI]$ and $\\frac{d}{dt}[ISI]$ symbolically, showing explicitly how these depend on quadruple motif densities of ordered length-$3$ paths (e.g., $[WXYZ]$ with $W,X,Y,Z \\in \\{S,I\\}$), and explain why this dependence prevents closure at the triple level for finite $k$ without additional approximation assumptions. Identify which higher-order terms appear and how they arise from infection and recovery events at the middle and endpoint nodes of the triples.\n3. Provide, as your final answer, the exact analytic expression you obtained for $\\frac{d}{dt}[SI]$ in terms of $\\lambda$, $\\mu$, $[II]$, $[SI]$, $[SSI]$, and $[ISI]$. No numerical evaluation is required.\n\nYour final answer must be a single closed-form symbolic expression. If you introduce any additional notation, it must be clearly defined within the derivation. Do not use any moment closure approximations in parts 1 or 2 of the derivation. No rounding or units are needed, since the final answer is symbolic.",
            "solution": "The problem asks for the derivation of the exact time-evolution equations for several motif densities in a susceptible-infected-susceptible (SIS) model on a $k$-regular graph. The derivation must be based on first principles, without applying any closure approximations.\n\nFirst, I will derive the equation for the density of infected nodes, $[I]$. Then, I will derive the central result: the equation for the density of susceptible-infected edges, $[SI]$. Finally, I will discuss the equations for triple densities to illustrate the problem of closure.\n\nLet $\\sigma_i \\in \\{S, I\\}$ be the state of node $i$. The motif densities are defined as expectations over the stochastic process, normalized by the total number of nodes $N$. For example,\n$$[I] = \\frac{1}{N} E\\left[\\sum_i \\mathbb{I}(\\sigma_i=I)\\right]$$\nwhere $\\mathbb{I}(\\cdot)$ is the indicator function. The time evolution of these expected values is governed by the master equation of the underlying continuous-time Markov process.\n\n**1. Derivation of $\\frac{d}{dt}[I]$**\n\nThe density of infected nodes, $[I]$, changes due to two types of events:\n-   **Infection**: A susceptible node ($S$) becomes infected ($I$). This occurs across a susceptible-infected ($S-I$) edge. The problem states the infection rate is $\\lambda$ per $S-I$ edge. The total number of ordered $S-I$ edges in the network is $N[SI]$. Each such edge corresponds to a potential infection event where the $S$ node becomes $I$. The total rate at which infection events occur in the system is the sum of rates over all $S$ nodes, which is $\\sum_{i|\\sigma_i=S} \\lambda \\times (\\text{number of } I \\text{ neighbors of } i)$. This sum is precisely $\\lambda$ times the total number of $S-I$ (and $I-S$) edges, which is $\\lambda N [SI]$. Each infection event increases the number of infected nodes by $1$. Thus, the total rate of increase in $N[I]$ due to infection is $\\lambda N [SI]$.\n-   **Recovery**: An infected node ($I$) becomes susceptible ($S$). This occurs for each infected node at a rate $\\mu$. The total number of infected nodes is $N[I]$. Therefore, the total rate at which recovery events occur is $\\mu N [I]$. Each recovery event decreases the number of infected nodes by $1$. Thus, the total rate of decrease in $N[I]$ due to recovery is $\\mu N [I]$.\n\nCombining these gives the rate of change for the expected number of infected nodes:\n$$ \\frac{d}{dt}(N[I]) = \\lambda N [SI] - \\mu N [I] $$\nDividing by $N$, we obtain the evolution equation for the density $[I]$:\n$$ \\frac{d}{dt}[I] = \\lambda [SI] - \\mu [I] $$\nThis equation is exact and relates the rate of change of a node-level density to a pair-level density, illustrating the characteristic coupling in the moment hierarchy.\n\n**2. Derivation of $\\frac{d}{dt}[SI]$**\n\nWe now derive the time evolution for the density of susceptible-infected ordered edges, $[SI]$. We must account for all events that create or destroy $S-I$ edges. The events are infections ($S \\to I$) and recoveries ($I \\to S$).\n\n**Contribution from Infection Events:**\nInfection events occur at a total rate of $\\lambda N [SI]$. Let's consider a single such event, where a susceptible node $j$ becomes infected due to its connection to an infected neighbor $i$. The state of node $j$ changes from $S$ to $I$. We analyze the change in the number of $S-I$ edges.\n-   **Change involving the edge $(i, j)$:** The edge connecting $i$ and $j$ was an $I-S$ edge. After the event, it becomes an $I-I$ edge. Since the graph is undirected, this means we lose one $S-I$ edge and one $I-S$ edge. The change to the count of $S-I$ edges is $-1$.\n-   **Change involving other neighbors of node $j$:** Node $j$ has $k-1$ other neighbors (since the graph is $k$-regular). Let $m$ be such a neighbor, $m \\neq i$.\n    -   If node $m$ is in state $S$, the edge $(j, m)$ was an $S-S$ edge. After $j$ becomes infected, this edge becomes an $I-S$ edge. This creates one $S-I$ edge. The change is $+1$.\n    -   If node $m$ is in state $I$, the edge $(j, m)$ was an $S-I$ edge. After $j$ becomes infected, this edge becomes an $I-I$ edge. This destroys one $S-I$ edge. The change is $-1$.\nTo find the total expected change, we average over all infection events. An infection event selects an $S-I$ edge at random. The expected number of $S$ and $I$ neighbors of the susceptible node $j$ (given it is connected to an infected node $i$) is determined by the triple densities.\n-   The expected number of $S$ neighbors of $j$ (excluding $i$) is given by the density of $I-S-S$ paths divided by the density of $I-S$ pairs. From the problem definitions, this is $[ISS]/[IS]$. Since $[IS]=[SI]$ and $[ISS]=[SSI]$ for an undirected graph, this is $[SSI]/[SI]$.\n-   Similarly, the expected number of $I$ neighbors of $j$ (excluding $i$) is given by the density of $I-S-I$ paths, which is $[ISI]/[SI]$.\n\nThe total expected change in the number of $S-I$ edges per infection event is the sum of these effects:\n$$ \\Delta N_{SI}^{\\text{inf}} = -1 + \\left( (+1) \\times \\frac{[SSI]}{[SI]} \\right) + \\left( (-1) \\times \\frac{[ISI]}{[SI]} \\right) = -1 + \\frac{[SSI] - [ISI]}{[SI]} $$\nThe total rate of change in $N[SI]$ due to infections is the rate of events multiplied by the expected change per event:\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{inf}} = (\\lambda N [SI]) \\times \\left(-1 + \\frac{[SSI] - [ISI]}{[SI]}\\right) = \\lambda N (-[SI] + [SSI] - [ISI]) $$\n\n**Contribution from Recovery Events:**\nRecovery events ($I \\to S$) occur at a total rate of $\\mu N [I]$. Let's consider a single infected node $j$ recovering. We analyze the change in the number of $S-I$ edges.\n-   Let $m$ be a neighbor of node $j$.\n    -   If node $m$ is in state $S$, the edge $(j, m)$ was an $I-S$ edge. After $j$ recovers, this edge becomes an $S-S$ edge. This destroys one $S-I$ edge. The change is $-1$.\n    -   If node $m$ is in state $I$, the edge $(j, m)$ was an $I-I$ edge. After $j$ recovers, this edge becomes an $S-I$ edge. This creates one $S-I$ edge. The change is $+1$.\nTo find the total expected change, we average over all recovery events. A recovery event selects an infected node at random. The expected number of $S$ and $I$ neighbors of a randomly chosen infected node is given by pair densities.\n-   The total number of edges connected to $I$ nodes is $k N[I]$. This must equal the sum of edges leading to $S$ nodes ($N[SI]$) and $I$ nodes ($N[II]$). Thus, $k[I] = [SI] + [II]$.\n-   The expected number of $S$ neighbors for a random $I$ node is $N[SI]/N[I] = [SI]/[I]$.\n-   The expected number of $I$ neighbors for a random $I$ node is $N[II]/N[I] = [II]/[I]$.\n\nThe total expected change in the number of $S-I$ edges per recovery event is:\n$$ \\Delta N_{SI}^{\\text{rec}} = \\left( (-1) \\times \\frac{[SI]}{[I]} \\right) + \\left( (+1) \\times \\frac{[II]}{[I]} \\right) = \\frac{[II] - [SI]}{[I]} $$\nThe total rate of change in $N[SI]$ due to recoveries is the rate of events multiplied by the expected change per event:\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{rec}} = (\\mu N [I]) \\times \\left(\\frac{[II] - [SI]}{[I]}\\right) = \\mu N ([II] - [SI]) $$\n\n**Full Equation for $\\frac{d}{dt}[SI]$:**\nCombining the contributions from infection and recovery and dividing by $N$:\n$$ \\frac{d}{dt}[SI] = \\lambda(-[SI] + [SSI] - [ISI]) + \\mu([II] - [SI]) $$\nRearranging the terms, we get the final form:\n$$ \\frac{d}{dt}[SI] = \\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II] $$\nThis is the exact equation for the evolution of the $[SI]$ pair density, and it depends on the triple densities $[SSI]$ and $[ISI]$.\n\n**3. The Hierarchy and the Problem of Closure**\n\nTo solve the system of equations, we would need to write down the evolution equations for the triple densities, such as $[SSI]$ and $[ISI]$, that appear in the equation for $\\frac{d}{dt}[SI]$. Let's symbolically consider the derivation for $\\frac{d}{dt}[SSI]$, which corresponds to ordered paths $S-S-I$.\nThe number of such triples can change if the state of any of the three nodes in the path changes, or if nodes one step away change state. For example:\n-   **Creation of an $[SSI]$ triple**: This can happen if, for example, we have an $[ISI]$ triple ($I_u-S_v-I_w$) and the endpoint $u$ recovers ($I_u \\to S_u$). This event, occurring at rate $\\mu$, turns an $[ISI]$ triple into an $[SSI]$ triple. This contributes a term $+\\mu[ISI]$ to $\\frac{d}{dt}[SSI]$.\n-   **Destruction of an $[SSI]$ triple**: Consider an $S-S-I$ triple ($S_u-S_v-I_w$). If the right endpoint $I_w$ recovers, the triple becomes $S-S-S$. This event occurs at rate $\\mu$ for each such triple, contributing a term $-\\mu[SSI]$ to the dynamics.\n-   **Dependence on Quadruples**: A crucial type of event is when a node in the triple changes state due to a neighbor *outside* the triple. Consider an $S-S-S$ triple, $S_u-S_v-S_w$. For this to become an $S-S-I$ triple, the node $w$ must become infected. This requires $w$ to have an infected neighbor, say $z$. This involves a path of length 3 (a quadruple), $S_u-S_v-S_w-I_z$. An infection event on the $(w,z)$ link at rate $\\lambda$ transforms the $[SSS]$ triple into an $[SSI]$ triple. The rate of this transformation depends on the density of $[SSSI]$ quadruples.\n\nTherefore, the exact equation for $\\frac{d}{dt}[SSI]$ will depend on quadruple densities such as $[SSSI]$, $[ISSI]$, $[SSII]$, etc. For example, a term proportional to $\\lambda [ISSI]$ will appear in the equation for $\\frac{d}{dt}[ISI]$, as an infection propagating along an $I-S-S-I$ path can convert an $[SSI]$ triple into an $[ISI]$ triple.\nThis demonstrates the general problem: the derivative of the density of motifs of size $n$ depends on the density of motifs of size $n+1$. This creates an infinite hierarchy of coupled differential equations for a large or infinite graph. To obtain a finite, solvable system of equations, one must \"close\" this hierarchy by positing an approximation that expresses higher-order moments (e.g., triples) in terms of lower-order moments (e.g., pairs and singlets). The problem asked for the exact equations *before* any such closure, which we have derived for the pair level and discussed for the triple level.",
            "answer": "$$\\boxed{\\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II]}$$"
        },
        {
            "introduction": "Once we have a system of moment equations, a powerful application is to analyze the conditions for an epidemic invasion. This problem explores the critical invasion threshold for a Susceptible-Infected-Removed (SIR) process on a network where pair approximation is most accurate—in the limit of a large, locally tree-like structure . By linearizing the dynamics and comparing the result to the classic bond percolation threshold, you will uncover a deep and elegant connection between spreading dynamics and the static connectivity structure of the underlying network.",
            "id": "4130522",
            "problem": "Consider an infinite, locally tree-like network generated by the configuration model with degree distribution $\\{p_k\\}_{k\\in\\mathbb{N}}$ and finite first and second moments $\\langle k\\rangle$ and $\\langle k^2\\rangle$. Disease transmission follows a Continuous-Time Markov Chain (CTMC) Susceptible-Infected-Removed (SIR) process: each susceptible neighbor of an infected node is infected at per-edge rate $\\beta>0$, and each infected node recovers at rate $\\gamma\\ge 0$. The Susceptible-Infected (SI) limit corresponds to $\\gamma\\to 0$ (i.e., no recovery). Assume edges act independently and the network is static.\n\nUsing a pairwise moment closure on this locally tree-like network, linearize the dynamics about the disease-free state to obtain the invasion threshold predicted by the pairwise model. Separately, derive the bond percolation threshold on the same network when edges are occupied independently with probability equal to the edge-level transmissibility of the SIR process. Then compare the two thresholds and analyze under what structural and dynamical conditions they coincide, particularly in the SI limit.\n\nWhich statement is correct?\n\nA. On a locally tree-like configuration-model network with independent edges and Markovian SIR dynamics, the pairwise invasion threshold is identical to the bond percolation threshold with edge transmissibility $T=\\beta/(\\beta+\\gamma)$; in the SI limit $\\gamma\\to 0$, both reduce to the giant-component condition $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$.\n\nB. The thresholds coincide for any network topology provided $\\beta>0$, because the SI limit removes recovery and guarantees invasion independent of structure.\n\nC. The thresholds coincide only for scale-free networks with degree exponent $2<\\alpha<3$ where $\\langle k^2\\rangle$ diverges; for all other degree distributions they differ.\n\nD. Pairwise models always predict a strictly positive invasion threshold $\\beta_c>0$ even in the SI limit $\\gamma=0$, because the closure introduces an effective damping term that mimics recovery.",
            "solution": "This problem requires deriving and comparing two fundamental thresholds: the epidemic invasion threshold from a pairwise model and the bond percolation threshold.\n\n### Derivation of the Pairwise Invasion Threshold\n\nWe analyze the dynamics near the disease-free equilibrium (DFE), where the density of infected nodes $[I]$ is infinitesimally small. The system of ordinary differential equations (ODEs) for the SIR process on a network is:\n$$ \\frac{d[I]}{dt} = \\beta [SI] - \\gamma [I] $$\n$$ \\frac{d[SI]}{dt} = (\\text{rate of creation}) - (\\text{rate of destruction}) $$\nAn $SI$ link is destroyed in two ways:\n1.  The infected node in the pair recovers: Rate is $\\gamma [SI]$.\n2.  The infected node transmits the disease to the susceptible node, turning an $SI$ link into an $IR$ link: Rate is $\\beta [SI]$.\n\nNew $SI$ links are created when a susceptible node $S'$ gets infected by a node $I$, and $S'$ is also connected to other susceptible nodes. The infection event itself occurs at a total rate of $\\beta [SI]$. Consider one such event, where an $I \\to S'$ transmission happens. The newly infected node $S'$ has some degree $k$. Before infection, it was connected to the infecting node $I$ and $k-1$ other neighbors. In a locally tree-like network near the DFE, these $k-1$ neighbors are all susceptible. Thus, this single infection event creates $k-1$ new $SI$ links.\n\nWe need to find the average number of new $SI$ links created per infection event. The node $S'$ that gets infected is a neighbor of a randomly chosen infected node. In a configuration model network, the degree distribution of a node reached by traversing a random edge is not $p_k$, but $\\tilde{p}_k = k p_k / \\langle k \\rangle$. The average number of new $SI$ links created is the expectation of $k-1$ over this distribution:\n$$ \\langle k-1 \\rangle_{\\text{neighbor}} = \\sum_k (k-1) \\tilde{p}_k = \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = \\frac{\\sum_k (k^2 - k) p_k}{\\langle k \\rangle} = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} $$\nThe total rate of creation of $SI$ links is the rate of infection events, $\\beta [SI]$, multiplied by the average number of new links per event:\n$$ \\text{Rate of creation} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\nCombining the terms, the linearized ODE for $[SI]$ is:\n$$ \\frac{d[SI]}{dt} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) - \\gamma [SI] - \\beta [SI] $$\n$$ \\frac{d[SI]}{dt} = \\left[ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma \\right] [SI] $$\nFor the infection to spread, $[I]$ and $[SI]$ must grow from an infinitesimally small perturbation, which requires the eigenvalue of the linearized system to be positive. The condition is that the coefficient on the right-hand side is positive:\n$$ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma > 0 \\implies \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > \\beta + \\gamma $$\nDividing by $\\beta + \\gamma$ (which is positive), we get the invasion condition:\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### Derivation of the Bond Percolation Threshold\n\nBond percolation on a network involves occupying each edge independently with probability $p$. A giant connected component (GC) of occupied edges emerges if $p$ is above a critical threshold $p_c$. For a configuration model network, this threshold is found by analyzing the branching process of following occupied edges.\nA GC exists if the expected number of occupied edges leading away from a node reached by traversing an occupied edge is greater than $1$. Let's trace a path along an occupied edge. We arrive at a node whose degree $k$ is drawn from the distribution $\\tilde{p}_k = k p_k / \\langle k \\rangle$. This node has $k-1$ other edges. Each of these is independently occupied with probability $p$. The expected number of other occupied edges from this node is $(k-1)p$.\nAveraging over all possible degrees $k$ of such a node:\n$$ \\text{Average onward paths} = \\sum_k (k-1) p \\tilde{p}_k = p \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\nThe condition for the existence of a GC is that this quantity is greater than $1$:\n$$ p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\nThe problem states we should use an occupation probability $p$ equal to the SIR edge-level transmissibility, $T$. For a Markovian SIR process, an infected node is in a race to infect a susceptible neighbor (at rate $\\beta$) or to recover (at rate $\\gamma$). The probability that infection occurs before recovery is:\n$$ T = \\frac{\\beta}{\\beta + \\gamma} $$\nSetting $p=T$, the bond percolation condition for a large-scale outbreak becomes:\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### Comparison and SI Limit Analysis\n\n1.  **Comparison**: The invasion threshold derived from the linearized pairwise model is identical to the condition for the emergence of a giant component in bond percolation where the edge occupation probability is the transmissibility $T = \\beta/(\\beta+\\gamma)$. This equivalence is a classic result for locally tree-like networks.\n\n2.  **SI Limit**: We consider the case where there is no recovery, $\\gamma \\to 0$. In this limit, the transmissibility becomes $T = \\beta/(\\beta + 0) = 1$ (for $\\beta>0$). Substituting $T=1$ into the threshold condition gives:\n    $$ 1 \\cdot \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n    This is the Molloy-Reed criterion for the existence of a giant component in the original static network. It means that for an SI process, a large-scale epidemic can occur if and only if the network has a giant component for the infection to spread through.\n\n### Evaluation of Options\n\n*   **A**: This statement correctly identifies that the pairwise threshold is identical to the bond percolation threshold with $T=\\beta/(\\beta+\\gamma)$ and that in the SI limit ($\\gamma \\to 0$), this reduces to the giant-component condition $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$. This matches our derivation perfectly.\n*   **B**: This is incorrect. The equivalence relies on the locally tree-like assumption and is not true for any topology. Furthermore, invasion in the SI limit is not guaranteed; it depends on the network structure meeting the giant-component condition.\n*   **C**: This is incorrect. The equivalence is general for configuration model networks with finite moments, not limited to a specific class of scale-free networks.\n*   **D**: This is incorrect. In the SI limit, if the giant component condition is met, the critical threshold for the infection rate is $\\beta_c = 0$. Any positive $\\beta$ will cause an epidemic. The model does not always predict a strictly positive threshold.\n\nTherefore, statement A is the correct one.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Standard pair approximations often assume a locally tree-like structure, which ignores the high prevalence of triangles, or clustering, found in many real-world networks. This practice challenges you to move beyond this simplification by developing a more sophisticated closure scheme that explicitly accounts for network clustering . You will derive expressions for the densities of open wedges and closed triangles, learning how to incorporate structural properties like the global clustering coefficient $C$ directly into the moment equations.",
            "id": "4130494",
            "problem": "Consider a large, sparse, undirected network of $N$ nodes with mean degree $\\langle k \\rangle$ and negligible degree-degree correlation. Each node is in one of three states, denoted by $X$, $Y$, and $Z$. Let $[X]$ denote the fraction of nodes in state $X$, and let $[XY]$ denote the number of undirected edges between states $X$ and $Y$ divided by $N$ (so that $[XY] = [YX]$ and $\\sum_{W \\in \\{X,Y,Z\\}} [YW] = \\langle k \\rangle [Y]$). Define the oriented triplet density $[XYZ]$ as the number of ordered pairs of neighbors $(X,Z)$ sharing a common center in state $Y$, divided by $N$, and decompose it into the density of closed triangles $[XYZ]_{\\triangle}$ and open wedges $[XYZ]_{\\wedge}$ (so that $[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$). The Global Clustering Coefficient (GCC), denoted by $C$, is defined as the probability that two randomly chosen neighbors of the same node are connected by an edge.\n\nUsing a pair approximation (conditional independence of neighbor states given the center state) and a moment closure that corrects for the fact that the two neighbors must be distinct, derive expressions for $[XYZ]_{\\triangle}$ and $[XYZ]_{\\wedge}$ in terms of $[XY]$, $[YZ]$, $[Y]$, $\\langle k \\rangle$, and $C$. Your derivation must start from the following foundational bases: the definitions above, the independence approximation for neighbors conditioned on the center state, and the definition of the Global Clustering Coefficient as the probability of closure of a neighbor pair.\n\nExpress your final answer as a two-entry row matrix, where the first entry is the approximation for $[XYZ]_{\\triangle}$ and the second entry is the approximation for $[XYZ]_{\\wedge}$. No numerical evaluation is required, and no rounding is needed. The expressions should be fully simplified analytic expressions in symbolic form.",
            "solution": "The problem asks for expressions for the density of closed triangles, $[XYZ]_{\\triangle}$, and open wedges, $[XYZ]_{\\wedge}$, using a pair approximation corrected for network clustering.\n\n### Derivation Steps\n\n1.  **Derive the total triplet density $[XYZ]$**: First, we find an expression for the total density of $X-Y-Z$ triplets using a pair approximation that accounts for choosing two distinct neighbors.\n2.  **Partition into closed and open triplets**: We then use the Global Clustering Coefficient, $C$, to partition the total triplet density into its closed (triangle) and open (wedge) components.\n\n### 1. Derivation of the Total Triplet Density $[XYZ]$\n\nThe quantity $[XYZ]$ is the density of ordered paths of length two with states $X-Y-Z$. We start by counting these paths.\n-   The number of nodes in state $Y$ is $N[Y]$.\n-   For a specific node $j$ in state $Y$ with degree $k_j$, we want to find the number of ordered pairs of its neighbors, one in state $X$ and the other in state $Z$.\n-   We use the pair approximation, which assumes the states of neighbors are independent, given the state of the central node. The probability that a neighbor of a $Y$-node is in state $W$ is given by $P(W|Y)$. This probability can be expressed in terms of the given densities:\n    $$P(W|Y) = \\frac{\\text{Number of edges from Y to W}}{\\text{Total edges from Y}} = \\frac{N[YW]}{N\\langle k \\rangle[Y]} = \\frac{[YW]}{\\langle k \\rangle[Y]}$$\n-   For a $Y$-node of degree $k_j$, there are $k_j(k_j-1)$ ordered pairs of distinct neighbors. The expected number of $X-Y-Z$ triplets centered at this node is $k_j(k_j-1) P(X|Y) P(Z|Y)$.\n-   To find the total density $[XYZ]$, we average this quantity over all nodes in state $Y$:\n    $$[XYZ] = [Y] \\cdot \\langle k(k-1) \\rangle_Y \\cdot P(X|Y) P(Z|Y)$$\n    where $\\langle \\cdot \\rangle_Y$ is the average over nodes in state $Y$.\n-   The problem states there are negligible degree-degree correlations, which allows us to approximate the degree-dependent averages for a subset of nodes (state $Y$) with the global averages: $\\langle k(k-1) \\rangle_Y \\approx \\langle k(k-1) \\rangle = \\langle k^2 \\rangle - \\langle k \\rangle$.\n-   Furthermore, for a large sparse network, a common approximation is to neglect degree heterogeneity (i.e., assume a regular graph where $k_j \\approx \\langle k \\rangle$). This leads to $\\langle k^2 \\rangle \\approx \\langle k \\rangle^2$, so $\\langle k(k-1) \\rangle \\approx \\langle k \\rangle(\\langle k \\rangle - 1)$.\n-   Substituting these approximations and the expression for $P(W|Y)$:\n    $$[XYZ] \\approx [Y] \\cdot \\langle k \\rangle(\\langle k \\rangle - 1) \\cdot \\left(\\frac{[XY]}{\\langle k \\rangle[Y]}\\right) \\cdot \\left(\\frac{[YZ]}{\\langle k \\rangle[Y]}\\right)$$\n-   Simplifying the expression gives the standard pair approximation with the correction for distinct neighbors:\n    $$[XYZ] \\approx \\left(\\frac{\\langle k \\rangle - 1}{\\langle k \\rangle}\\right) \\frac{[XY][YZ]}{[Y]}$$\n\n### 2. Partitioning into Closed and Open Triplets\n\nThe Global Clustering Coefficient, $C$, is defined as the probability that any two neighbors of a given node are themselves connected. This is the probability that a random open wedge is actually a closed triangle.\n-   The total density of $X-Y-Z$ triplets, $[XYZ]$, represents the density of all potential wedges with this state configuration.\n-   The density of closed triangles, $[XYZ]_{\\triangle}$, is the fraction of these triplets that are closed. This is given by multiplying the total triplet density by the probability of closure, $C$.\n-   The density of open wedges, $[XYZ]_{\\wedge}$, is the fraction of these triplets that remain open. This is given by multiplying the total triplet density by the probability of being open, $(1-C)$.\n\nTherefore, we have:\n$$[XYZ]_{\\triangle} = C \\cdot [XYZ] = C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\n$$[XYZ]_{\\wedge} = (1-C) \\cdot [XYZ] = (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\n\nThese are the final expressions for the densities of closed triangles and open wedges under the specified approximations. The result is presented as a two-entry row matrix as requested.",
            "answer": "$$\\boxed{\\begin{pmatrix} C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} & (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} \\end{pmatrix}}$$"
        }
    ]
}