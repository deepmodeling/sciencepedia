{
    "hands_on_practices": [
        {
            "introduction": "这项练习是理解基于矩的建模方法的基石。它要求您从第一性原理出发，推导出一个系统的精确动态方程，这将清晰地揭示对复杂网络动力学进行建模的核心挑战：矩闭合问题。通过追踪单个感染和恢复事件如何改变节点和节点对的数量，您将亲眼看到节点对的变化率如何依赖于三元组的构型，从而产生一个无限的依赖层级。",
            "id": "4130514",
            "problem": "考虑一个具有 $N$ 个节点的有限、无向、简单、$k$-正则图上的连续时间易感-感染-易感（SIS）接触过程，其中每个节点恰好有 $k$ 个邻居。设每个易感-感染边的感染率为 $\\lambda > 0$，每个感染节点的恢复率为 $\\mu > 0$。定义以下基序密度，所有密度均由 $N$ 归一化并作为有序结构进行计数：\n- 对于节点状态 $X \\in \\{S,I\\}$，令 $[X]$ 表示处于状态 $X$ 的节点期望数量除以 $N$。\n- 对于有序边，令 $[XY]$ 表示有序边 $(X \\to Y)$ 的期望数量除以 $N$。由于图是无向的，$[SI] = [IS]$ 始终成立，但我们将保留有序表示法来组织事件的贡献。\n- 对于有序长度为2的路径（三元组），令 $[XYZ]$ 表示端点和中间节点 $Y$ 均不相同的有序路径 $X$–$Y$–$Z$ 的期望数量除以 $N$；也就是说，$[XYZ]$ 计数的是中间节点 $Y$ 的有序邻居对，其端点分别处于状态 $X$ 和 $Z$。\n\n您可以假设由正则性和无向性所蕴含的守恒恒等式，例如 $[S] + [I] = 1$，$[SS] + [SI] + [IS] + [II] = k$，以及对于所有状态 $X,Y,Z \\in \\{S,I\\}$，$[XYZ]$ 的总和为 $k(k-1)$，但不要先验地假设任何矩封闭近似。\n\n从第一性原理出发——即，由每个易感-感染边上以速率 $\\lambda$ 独立发生的感染事件和每个感染节点上以速率 $\\mu$ 独立发生的恢复事件所支配的连续时间马尔可夫动力学，结合对这些事件引起的基序变换的精确计数——完成以下任务：\n1. 仅使用 $\\lambda$、$\\mu$、$k$ 以及上述定义的基序密度，推导节点和对密度的精确时间演化方程 $\\frac{d}{dt}[I]$ 和 $\\frac{d}{dt}[SI]$。您的推导必须考虑由感染和恢复事件贡献的所有增益和损失，包括因节点状态转变而导致的邻边变化，并且必须使用三元组密度精确地表示 $\\frac{d}{dt}[SI]$（不要应用任何封闭近似）。\n2. 将推导扩展到三元组密度，写出 $\\frac{d}{dt}[SSI]$ 和 $\\frac{d}{dt}[ISI]$ 的符号形式精确表达式，明确展示它们如何依赖于有序长度为3路径的四元组基序密度（例如，$[WXYZ]$，其中 $W,X,Y,Z \\in \\{S,I\\}$），并解释为什么在没有额外近似假设的情况下，这种依赖性使得在有限 $k$ 的三元组级别上无法实现封闭。指明出现了哪些高阶项，以及它们是如何由三元组的中间节点和端点处的感染和恢复事件产生的。\n3. 提供您得到的关于 $\\frac{d}{dt}[SI]$ 的精确解析表达式，用 $\\lambda$、$\\mu$、$[II]$、$[SI]$、$[SSI]$ 和 $[ISI]$ 表示，作为您的最终答案。不需要进行数值计算。\n\n您的最终答案必须是一个单一的闭式符号表达式。如果您引入任何额外的符号，必须在推导过程中明确定义。在推导的第1部分和第2部分中，不要使用任何矩封闭近似。由于最终答案是符号形式，不需要四舍五入或单位。",
            "solution": "题目要求在一个 $k$-正则图上，针对易感-感染-易感（SIS）模型中的几种基序密度，推导其精确的时间演化方程。推导必须基于第一性原理，且不应用任何封闭近似。\n\n首先，我将推导感染节点密度 $[I]$ 的方程。然后，我将推导核心结果：易感-感染边密度 $[SI]$ 的方程。最后，我将讨论三元组密度的方程，以说明封闭问题。\n\n令 $\\sigma_i \\in \\{S, I\\}$ 为节点 $i$ 的状态。基序密度定义为对随机过程的期望，并由总节点数 $N$ 进行归一化。例如，$[I] = \\frac{1}{N} E[\\sum_i \\mathbb{I}(\\sigma_i=I)]$，其中 $\\mathbb{I}(\\cdot)$ 是指示函数。这些期望值的时间演化由其底层的连续时间马尔可夫过程的主方程决定。\n\n**1. $\\frac{d}{dt}[I]$ 的推导**\n\n感染节点密度 $[I]$ 因两种类型的事件而改变：\n-   **感染**：一个易感节点（$S$）变为感染节点（$I$）。这发生在易感-感染（$S-I$）边上。题目说明每个 $S-I$ 边的感染率为 $\\lambda$。网络中有序 $S-I$ 边的总数是 $N[SI]$。每条这样的边都对应一个潜在的感染事件，其中 $S$ 节点变为 $I$。系统中感染事件发生的总速率是所有 $S$ 节点速率的总和，即 $\\sum_{i|\\sigma_i=S} \\lambda \\times (\\text{节点 } i \\text{ 的 } I \\text{ 邻居数量})$。这个总和恰好是 $\\lambda$ 乘以 $S-I$（以及 $I-S$）边的总数，即 $\\lambda N [SI]$。每个感染事件使感染节点数增加1。因此，由感染引起的 $N[I]$ 的总增加速率是 $\\lambda N [SI]$。\n-   **恢复**：一个感染节点（$I$）变为易感节点（$S$）。每个感染节点以速率 $\\mu$ 发生此事件。感染节点的总数是 $N[I]$。因此，恢复事件发生的总速率是 $\\mu N [I]$。每个恢复事件使感染节点数减少1。因此，由恢复引起的 $N[I]$ 的总减少速率是 $\\mu N [I]$。\n\n将这些结合起来，得到感染节点期望数量的变化率：\n$$ \\frac{d}{dt}(N[I]) = \\lambda N [SI] - \\mu N [I] $$\n两边除以 $N$，我们得到密度 $[I]$ 的演化方程：\n$$ \\frac{d}{dt}[I] = \\lambda [SI] - \\mu [I] $$\n这个方程是精确的，它将节点级密度的变化率与对级密度关联起来，展示了矩等级结构中的典型耦合特性。\n\n**2. $\\frac{d}{dt}[SI]$ 的推导**\n\n我们现在推导有序易感-感染边密度 $[SI]$ 的时间演化。我们必须考虑所有创建或销毁 $S-I$ 边的事件。这些事件是感染（$S \\to I$）和恢复（$I \\to S$）。\n\n**来自感染事件的贡献：**\n感染事件以 $\\lambda N [SI]$ 的总速率发生。让我们考虑一个这样的事件，其中易感节点 $j$ 因其与一个受感染邻居 $i$ 的连接而受感染。节点 $j$ 的状态从 $S$ 变为 $I$。我们分析 $S-I$ 边数量的变化。\n-   **涉及边 $(i, j)$ 的变化：** 连接 $i$ 和 $j$ 的边原先是 $I-S$ 边。事件发生后，它变为 $I-I$ 边。由于图是无向的，这意味着我们失去了一个 $S-I$ 边和一个 $I-S$ 边。对 $S-I$ 边数量的改变是 $-1$。\n-   **涉及节点 $j$ 的其他邻居的变化：** 节点 $j$ 有 $k-1$ 个其他邻居（因为图是 $k$-正则的）。设 $m$ 是这样一个邻居，其中 $m \\neq i$。\n    -   如果节点 $m$ 处于状态 $S$，则边 $(j, m)$ 原先是 $S-S$ 边。在 $j$ 被感染后，该边变为 $I-S$ 边。这会创建一个 $S-I$ 边。变化量为 $+1$。\n    -   如果节点 $m$ 处于状态 $I$，则边 $(j, m)$ 原先是 $S-I$ 边。在 $j$ 被感染后，该边变为 $I-I$ 边。这会销毁一个 $S-I$ 边。变化量为 $-1$。\n为了找到总的期望变化，我们对所有感染事件进行平均。一个感染事件会随机选择一个 $S-I$ 边。易感节点 $j$ 的 $S$ 和 $I$ 邻居的期望数量（给定它连接到一个感染节点 $i$）由三元组密度决定。\n-   节点 $j$ 的 $S$ 邻居（不包括 $i$）的期望数量由 $I-S-S$ 路径的密度除以 $I-S$ 对的密度给出。根据题目定义，这是 $\\frac{[ISS]}{[IS]}$。由于对于无向图，$[IS]=[SI]$ 且 $[ISS]=[SSI]$，所以这是 $\\frac{[SSI]}{[SI]}$。\n-   类似地，节点 $j$ 的 $I$ 邻居（不包括 $i$）的期望数量由 $I-S-I$ 路径的密度给出，即 $\\frac{[ISI]}{[SI]}$。\n\n每次感染事件中 $S-I$ 边数量的总期望变化是这些效应的总和：\n$$ \\Delta N_{SI}^{\\text{inf}} = -1 + \\left( (+1) \\times \\frac{[SSI]}{[SI]} \\right) + \\left( (-1) \\times \\frac{[ISI]}{[SI]} \\right) = -1 + \\frac{[SSI] - [ISI]}{[SI]} $$\n由感染引起的 $N[SI]$ 的总变化率是事件发生率乘以每次事件的期望变化量：\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{inf}} = (\\lambda N [SI]) \\times \\left(-1 + \\frac{[SSI] - [ISI]}{[SI]}\\right) = \\lambda N (-[SI] + [SSI] - [ISI]) $$\n\n**来自恢复事件的贡献：**\n恢复事件（$I \\to S$）以 $\\mu N [I]$ 的总速率发生。让我们考虑一个单一的感染节点 $j$ 恢复。我们分析 $S-I$ 边数量的变化。\n-   设 $m$ 是节点 $j$ 的一个邻居。\n    -   如果节点 $m$ 处于状态 $S$，则边 $(j, m)$ 原先是 $I-S$ 边。在 $j$ 恢复后，该边变为 $S-S$ 边。这会销毁一个 $S-I$ 边。变化量为 $-1$。\n    -   如果节点 $m$ 处于状态 $I$，则边 $(j, m)$ 原先是 $I-I$ 边。在 $j$ 恢复后，该边变为 $S-I$ 边。这会创建一个 $S-I$ 边。变化量为 $+1$。\n为了找到总的期望变化，我们对所有恢复事件进行平均。一个恢复事件会随机选择一个感染节点。一个随机选择的感染节点的 $S$ 和 $I$ 邻居的期望数量由对密度给出。\n-   连接到 $I$ 节点的总边数是 $k N[I]$。这必须等于通向 $S$ 节点的边数（$N[SI]$）和通向 $I$ 节点的边数（$N[II]$）之和。因此，$k[I] = [SI] + [II]$。\n-   一个随机 $I$ 节点的 $S$ 邻居的期望数量是 $\\frac{N[SI]}{N[I]} = \\frac{[SI]}{[I]}$。\n-   一个随机 $I$ 节点的 $I$ 邻居的期望数量是 $\\frac{N[II]}{N[I]} = \\frac{[II]}{[I]}$。\n\n每次恢复事件中 $S-I$ 边数量的总期望变化是：\n$$ \\Delta N_{SI}^{\\text{rec}} = \\left( (-1) \\times \\frac{[SI]}{[I]} \\right) + \\left( (+1) \\times \\frac{[II]}{[I]} \\right) = \\frac{[II] - [SI]}{[I]} $$\n由恢复引起的 $N[SI]$ 的总变化率是事件发生率乘以每次事件的期望变化量：\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{rec}} = (\\mu N [I]) \\times \\left(\\frac{[II] - [SI]}{[I]}\\right) = \\mu N ([II] - [SI]) $$\n\n**$\\frac{d}{dt}[SI]$ 的完整方程：**\n结合来自感染和恢复的贡献，并除以 $N$：\n$$ \\frac{d}{dt}[SI] = \\lambda(-[SI] + [SSI] - [ISI]) + \\mu([II] - [SI]) $$\n重新整理这些项，我们得到最终形式：\n$$ \\frac{d}{dt}[SI] = \\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II] $$\n这是 $[SI]$ 对密度演化的精确方程，它依赖于三元组密度 $[SSI]$ 和 $[ISI]$。\n\n**3. 等级结构与封闭问题**\n\n为了求解这个方程组，我们需要写出出现在 $\\frac{d}{dt}[SI]$ 方程中的三元组密度（如 $[SSI]$ 和 $[ISI]$）的演化方程。让我们符号化地考虑 $\\frac{d}{dt}[SSI]$ 的推导，它对应于有序路径 $S-S-I$。\n如果路径中三个节点中任何一个的状态发生变化，或者距离一步之遥的节点状态发生变化，这类三元组的数量就会改变。例如：\n-   **$[SSI]$ 三元组的创建**：例如，如果我们有一个 $I-S-I$ 三元组 ($I_u-S_v-I_w$) 且端点 $u$ 恢复（$I_u \\to S_u$），就会发生这种情况。这个以速率 $\\mu$ 发生的事件将一个 $[ISI]$ 三元组转变为一个 $[SSI]$ 三元组。这对 $\\frac{d}{dt}[SSI]$ 贡献了 $+\\mu[ISI]$ 项。\n-   **$[SSI]$ 三元组的销毁**：考虑一个 $S-S-I$ 三元组 ($S_u-S_v-I_w$) 。如果右端点 $I_w$ 恢复，该三元组变为 $S-S-S$。对于每个这样的三元组，此事件以速率 $\\mu$ 发生，从而对动力学方程贡献一个 $-\\mu[SSI]$ 项。\n-   **对四元组的依赖**：一个关键类型的事件是，当三元组中的一个节点因其*外部*的邻居而改变状态时。考虑一个 $S-S-S$ 三元组 $S_u-S_v-S_w$。要使其变为一个 $S-S-I$ 三元组，节点 $w$ 必须被感染。这要求 $w$ 有一个受感染的邻居，比如说 $z$。这涉及一个长度为3的路径（一个四元组），$S_u-S_v-S_w-I_z$。在 $(w,z)$ 链路上以速率 $\\lambda$ 发生的感染事件会将 $[SSS]$ 三元组转换为 $[SSI]$ 三元组。这种转换的速率取决于 $[SSSI]$ 四元组的密度。\n\n因此，$\\frac{d}{dt}[SSI]$ 的精确方程将依赖于四元组密度，如 $[SSSI]$、$[ISSI]$、$[SSII]$ 等。例如，在 $\\frac{d}{dt}[ISI]$ 的方程中会出现一个与 $\\lambda [ISSI]$ 成正比的项，因为沿着 $I-S-S-I$ 路径传播的感染可以将一个 $[SSI]$ 三元组转换为一个 $[ISI]$ 三元组。\n这揭示了一个普遍问题：大小为 $n$ 的基序密度的导数依赖于大小为 $n+1$ 的基序密度。对于大型或无限图，这会产生一个无穷的耦合微分方程等级结构。为了获得一个有限的、可解的方程组，必须通过提出一个近似来“封闭”这个等级结构，该近似用低阶矩（例如，对和单元）来表示高阶矩（例如，三元组）。本题要求在进行任何此类封闭*之前*的精确方程，我们已经推导了对级别的方程，并讨论了三元组级别的情况。",
            "answer": "$$\\boxed{\\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II]}$$"
        },
        {
            "introduction": "在建立了矩层级之后，我们现在来探索近似技术的强大之处。这项实践联系了两个基本概念：流行病传播的动态阈值（从成对模型中推导）和键渗流中巨片出现的静态阈值。通过在局部树状网络上进行此分析，您将证明一个深刻的见解：对于某些网络结构，复杂的动态过程可以映射到更简单的静态结构问题上，从而提供了一个强大的分析捷径。",
            "id": "4130522",
            "problem": "考虑一个由配置模型生成的无限、局部树状网络，其度分布为 $\\{p_k\\}_{k\\in\\mathbb{N}}$，且具有有限的一阶矩 $\\langle k\\rangle$ 和二阶矩 $\\langle k^2\\rangle$。疾病传播遵循连续时间马尔可夫链 (CTMC) 的易感-感染-移除 (SIR) 过程：每个感染节点的易感邻居以每条边 $\\beta>0$ 的速率被感染，每个感染节点以 $\\gamma\\ge 0$ 的速率恢复。易感-感染 (SI) 极限对应于 $\\gamma\\to 0$（即没有恢复）。假设边的作用是独立的，并且网络是静态的。\n\n在这个局部树状网络上使用对偶矩封闭方法，围绕无病状态对动力学进行线性化，以获得对偶模型预测的入侵阈值。另外，在同一网络上，当边以等于 SIR 过程的边层面传播率的概率被独立占据时，推导其键渗流阈值。然后比较这两个阈值，并分析它们在何种结构和动力学条件下重合，特别是在 SI 极限下。\n\n哪个陈述是正确的？\n\nA. 在一个具有独立边和马尔可夫 SIR 动力学的局部树状配置模型网络上，对偶入侵阈值与边传播率为 $T=\\beta/(\\beta+\\gamma)$ 的键渗流阈值相同；在 SI 极限 $\\gamma\\to 0$ 下，两者都简化为巨型连通分支条件 $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$。\n\nB. 只要 $\\beta>0$，这两个阈值对任何网络拓扑都重合，因为 SI 极限消除了恢复过程，从而保证了入侵与结构无关。\n\nC. 这两个阈值仅在度指数 $\\alpha$ 介于2和3之间且 $\\langle k^2\\rangle$ 发散的无标度网络上重合；对于所有其他度分布，它们都不同。\n\nD. 即使在 SI 极限 $\\gamma=0$ 下，对偶模型也总是预测一个严格为正的入侵阈值 $\\beta_c>0$，因为矩封闭方法引入了一个模拟恢复过程的有效阻尼项。",
            "solution": "用户需要对一个关于网络上流行病阈值的问题进行批判性分析和解答。\n\n### 步骤1：提取已知条件\n- **网络模型**：由配置模型生成的无限、局部树状网络。\n- **度分布**：$\\{p_k\\}_{k\\in\\mathbb{N}}$。\n- **矩**：一阶矩 $\\langle k \\rangle = \\sum_k k p_k$ 和二阶矩 $\\langle k^2 \\rangle = \\sum_k k^2 p_k$ 是有限的。\n- **动力学过程**：连续时间马尔可夫链 (CTMC) 易感-感染-移除 (SIR) 模型。\n- **速率**：每条边的感染速率：$\\beta > 0$。每个节点的恢复速率：$\\gamma \\ge 0$。\n- **SI 极限**：$\\gamma \\to 0$ 的特殊情况。\n- **假设**：在传播过程中，边的作用是独立的。网络是静态的。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题在网络科学和数学流行病学等成熟领域有坚实的理论基础。配置模型、SIR 过程、对偶矩封闭和键渗流都是标准的、严谨的概念。\n- **良定性**：该问题是良定的。它要求在指定条件下推导和比较两个定义明确的理论量（入侵阈值和渗流阈值）。假设（局部树状、有限矩）确保了存在唯一且有意义的解，并且可以被推导出来。\n- **客观性**：问题陈述使用了精确、客观和标准的科学术语。没有主观或模糊的元素。\n- **检查缺陷**：\n    1.  **科学上不合理**：无。前提是理论建模中的标准设定。\n    2.  **无法形式化**：无。问题陈述方式可以直接转化为数学方程。\n    3.  **不完整/矛盾**：无。所有必要信息（网络模型、动力学、速率、关键假设如“局部树状”）都已提供。\n    4.  **不现实/不可行**：无。这是一个理论模型，其参数是一致的。\n    5.  **不良定**：无。问题会导向一个唯一的答案。\n    6.  **琐碎/同义反复**：无。推导需要基于随机过程和网络理论基本原理的多个推理步骤。\n    7.  **外部可验证性**：无。推导过程在数学上是可验证的。\n\n### 步骤3：结论与行动\n问题陈述有效。我将继续推导解决方案。\n\n### 对偶入侵阈值的推导\n\n我们分析无病平衡点 (DFE) 附近的动力学，此时感染节点密度 $[I]$ 无穷小，即 $[I] \\approx 0$。令 $[SI]$ 为连接易感节点和感染节点的边的密度。密度的动力学可以用一个常微分方程组 (ODEs) 来描述。要发生入侵，感染节点的数量必须在初始时增长。\n感染节点数量的变化率为：\n$$ \\frac{d[I]}{dt} = \\beta [SI] - \\gamma [I] $$\n为了分析 DFE 的稳定性，我们需要一个关于 $[SI]$ 的方程。\n$$ \\frac{d[SI]}{dt} = (\\text{生成速率}) - (\\text{销毁速率}) $$\n一个 $SI$ 链接通过两种方式被销毁：\n1.  对中的感染节点恢复：速率为 $\\gamma [SI]$。\n2.  对中的感染节点将疾病传播给易感节点：速率为 $\\beta [SI]$。\n\n当一个易感节点 $S'$ 被一个节点 $I$ 感染，并且 $S'$ 还连接到其他易感节点时，就会产生新的 $SI$ 链接。感染事件本身以 $\\beta [SI]$ 的速率发生。考虑一个这样的事件，其中发生了 $I \\to S'$ 的传播。新感染的节点 $S'$ 具有某个度 $k$。在被感染之前，它连接到施感节点 $I$ 和另外 $k-1$ 个邻居。在 DFE 附近的局部树状网络中，这 $k-1$ 个邻居都是易感的。因此，这一个感染事件会产生 $k-1$ 个新的 $SI$ 链接。\n\n我们需要计算每次感染事件平均产生的新 $SI$ 链接数。被感染的节点 $S'$ 是一个感染节点的邻居。在配置模型网络中，通过一条随机边到达的节点的度分布不是 $p_k$，而是 $\\tilde{p}_k = k p_k / \\langle k \\rangle$。因此，产生的新 $SI$ 链接的平均数是在此分布下 $k-1$ 的期望值：\n$$ \\langle k-1 \\rangle_{\\text{neighbor}} = \\sum_k (k-1) \\tilde{p}_k = \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = \\frac{\\sum_k (k^2 - k) p_k}{\\langle k \\rangle} = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} $$\n$SI$ 链接的总生成速率是感染事件的速率 $\\beta [SI]$ 乘以每次事件产生的新链接的平均数：\n$$ \\text{生成速率} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\n综合各项，关于 $[SI]$ 的线性化常微分方程为：\n$$ \\frac{d[SI]}{dt} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) - \\gamma [SI] - \\beta [SI] $$\n$$ \\frac{d[SI]}{dt} = \\left[ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma \\right] [SI] $$\n为了使感染扩散，$[SI]$ 必须从一个无穷小的扰动开始增长，这要求右侧的系数为正：\n$$ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma > 0 $$\n$$ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > \\beta + \\gamma $$\n两边除以 $\\beta + \\gamma$（因为 $\\beta>0, \\gamma\\ge0$，所以这个和是正的），我们得到入侵条件：\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### 键渗流阈值的推导\n\n网络上的键渗流指的是每条边被独立地以概率 $p$ 占据。如果 $p$ 高于一个临界阈值 $p_c$，就会出现一个由被占据的边组成的巨型连通分支 (GC)。对于配置模型网络，这个阈值可以通过分析沿被占据边前进的分支过程来找到。\n如果从一个通过被占据边到达的节点出发，其引出的被占据边的期望数量大于 1，则存在一个巨型连通分支。\n让我们沿着一条被占据的边追踪路径。我们到达一个节点，其度 $k$ 从分布 $\\tilde{p}_k = k p_k / \\langle k \\rangle$ 中抽取。该节点还有 $k-1$ 条其他边。其中每一条都以概率 $p$ 被独立占据。从该节点出发的其他被占据边的期望数量是 $(k-1)p$。\n对这样一个节点所有可能的度 $k$ 进行平均：\n$$ \\text{平均前进路径} = \\sum_k (k-1) p \\tilde{p}_k = p \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\nGC 存在的条件是这个量大于 1：\n$$ p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n问题陈述我们应该使用等于 SIR 过程边层面传播率 $T$ 的占据概率 $p$。对于一个马尔可夫 SIR 过程，一个感染节点处于两种状态的竞争中：感染一个易感邻居（速率为 $\\beta$）或恢复（速率为 $\\gamma$）。感染在恢复之前发生的概率是：\n$$ T = \\frac{\\beta}{\\beta + \\gamma} $$\n设 $p=T$，则大规模爆发的键渗流条件变为：\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### 比较与 SI 极限分析\n\n1.  **比较**：从线性化对偶模型推导出的入侵阈值，与边占据概率为传播率 $T = \\beta/(\\beta+\\gamma)$ 的键渗流中巨型连通分支出现的条件是相同的。这种等价性是局部树状网络的经典结果。\n\n2.  **SI 极限**：我们考虑没有恢复的情况，即 $\\gamma \\to 0$。在此极限下，传播率变为 $T = \\frac{\\beta}{\\beta + 0} = 1$ (对于 $\\beta>0$)。将 $T=1$ 代入阈值条件得到：\n    $$ 1 \\cdot \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n    这是原始静态网络中存在巨型连通分支的 Molloy-Reed 判据。这意味着对于 SI 过程，当且仅当网络中存在一个巨型连通分支供感染传播时，流行病才会发生。\n\n### 逐项分析\n\n**A. 在一个具有独立边和马尔可夫 SIR 动力学的局部树状配置模型网络上，对偶入侵阈值与边传播率为 $T=\\beta/(\\beta+\\gamma)$ 的键渗流阈值相同；在 SI 极限 $\\gamma\\to 0$ 下，两者都简化为巨型连通分支条件 $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$。**\n- 我的推导证实了对偶阈值为 $\\frac{\\beta}{\\beta+\\gamma} \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$。\n- 我的推导证实了当 $p=T=\\beta/(\\beta+\\gamma)$ 时的键渗流阈值是相同的。\n- 我对 $\\gamma \\to 0$ 极限的分析表明，该条件变为 $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$，这正是巨型连通分支条件。\n- **结论：正确。**\n\n**B. 只要 $\\beta>0$，这两个阈值对任何网络拓扑都重合，因为 SI 极限消除了恢复过程，从而保证了入侵与结构无关。**\n- “对任何网络拓扑都重合”：这是错误的。对偶模型、分支过程分析和渗流映射之间的等价性从根本上依赖于网络的局部树状结构，这种结构最小化了短环路的影响。在高度聚集的网络（例如，晶格网络）上，这些近似会失效，阈值也会不同。\n- “保证入侵与结构无关”：这是错误的。SI 极限的阈值是 $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$，这是对网络度分布的一个严格条件。如果不满足此条件，即使 $\\gamma=0$，也不会发生大规模入侵。\n- **结论：不正确。**\n\n**C. 这两个阈值仅在度指数 $\\alpha$ 介于2和3之间且 $\\langle k^2\\rangle$ 发散的无标度网络上重合；对于所有其他度分布，它们都不同。**\n- “仅对无标度网络...”：这是错误的。只要一阶矩和二阶矩是有限的（如问题设定中所述），该推导对任何度分布 $\\{p_k\\}$ 都成立。这种重合性是配置模型网络的一个普遍性质。$\\langle k^2 \\rangle$ 发散的情况是一个特殊极限，此时入侵阈值为零，但阈值条件的形式上的同一性仍然成立。\n- **结论：不正确。**\n\n**D. 即使在 SI 极限 $\\gamma=0$ 下，对偶模型也总是预测一个严格为正的入侵阈值 $\\beta_c>0$，因为矩封闭方法引入了一个模拟恢复过程的有效阻尼项。**\n- 在 SI 极限 ($\\gamma=0$) 下，如果 $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$，对偶模型预测会发生入侵。这是一个关于网络结构的条件，而不是关于 $\\beta$ 的。如果条件满足，任何 $\\beta > 0$ 都会导致流行病。临界阈值为 $\\beta_c = 0$。该模型*总是*预测 $\\beta_c > 0$ 的说法是错误的。\n- 在对偶方程中可能被误解为“阻尼”的项是 $-\\beta[SI]$，它表示通过成功传播移除一个 $SI$ 链接。这是一个真实的饱和效应，而不是一个模拟恢复的人为产物。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "简单的成对近似法虽然功能强大，但有其已知的局限性，其中最主要的是它们无法解释网络聚类（如三角形等短环路）。本练习将指导您构建一个更复杂的闭合方案，该方案明确区分了开放楔形和闭合三角形。通过引入全局聚类系数，您将学习如何系统地改进基本的成对近似法，从而创建一个能更忠实地表示真实世界网络局部结构的模型。",
            "id": "4130494",
            "problem": "考虑一个由$N$个节点构成的大型、稀疏、无向网络，其平均度为$\\langle k \\rangle$，且度-度相关性可忽略不计。每个节点处于三种状态之一，表示为 $X$、$Y$ 和 $Z$。令 $[X]$ 表示处于状态 $X$ 的节点比例，令 $[XY]$ 表示处于状态 $X$ 和 $Y$ 之间的无向边数除以 $N$（因此有 $[XY] = [YX]$ 和 $\\sum_{W \\in \\{X,Y,Z\\}} [YW] = \\langle k \\rangle [Y]$）。将有向三元组密度 $[XYZ]$ 定义为共享一个处于状态 $Y$ 的共同中心节点的有序邻居对 $(X,Z)$ 的数量除以 $N$，并将其分解为闭合三角密度 $[XYZ]_{\\triangle}$ 和开放楔形密度 $[XYZ]_{\\wedge}$（因此有 $[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$）。全局聚类系数（GCC），记作 $C$，定义为同一节点的两个随机选择的邻居之间有边相连的概率。\n\n使用对近似（给定中心节点状态下邻居状态的条件独立性）和一种修正了两个邻居必须是不同个体的矩封闭方法，推导 $[XYZ]_{\\triangle}$ 和 $[XYZ]_{\\wedge}$ 关于 $[XY]$、$[YZ]$、$[Y]$、$\\langle k \\rangle$ 和 $C$ 的表达式。您的推导必须从以下基本依据出发：上述定义、以中心节点状态为条件的邻居独立性近似，以及全局聚类系数作为邻居对闭合概率的定义。\n\n将您的最终答案表示为一个两元行矩阵，其中第一个元素是 $[XYZ]_{\\triangle}$ 的近似表达式，第二个元素是 $[XYZ]_{\\wedge}$ 的近似表达式。不需要进行数值计算，也不需要四舍五入。表达式应为完全简化的符号形式解析表达式。",
            "solution": "用户希望推导在一个具有三种状态 $\\{X, Y, Z\\}$ 的节点网络中，闭合三角密度 $[XYZ]_{\\triangle}$ 和开放楔形密度 $[XYZ]_{\\wedge}$ 的表达式。推导必须基于对近似和矩封闭，最终表达式应使用对密度 $[XY]$、单节点密度 $[Y]$、平均度 $\\langle k \\rangle$ 和全局聚类系数 $C$ 来表示。\n\n首先，我将验证问题陈述。\n\n### 第1步：提取已知条件\n-   网络：大型、稀疏、无向，$N$个节点。\n-   平均度：$\\langle k \\rangle$。\n-   相关性：可忽略的度-度相关性。\n-   节点状态：$X, Y, Z$。\n-   单节点密度：$[X]$ 是处于状态 $X$ 的节点比例。\n-   对密度：$[XY]$ 是处于状态 $X$ 和 $Y$ 之间的无向边数除以 $N$。\n-   对密度性质：$[XY] = [YX]$ 且 $\\sum_{W \\in \\{X,Y,Z\\}} [YW] = \\langle k \\rangle [Y]$。\n-   有向三元组密度：$[XYZ]$ 是共享一个处于状态 $Y$ 的共同中心节点的有序邻居对 $(X,Z)$ 的数量除以 $N$。\n-   三元组分解：$[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$，其中 $[XYZ]_{\\triangle}$ 是闭合三角密度，$[XYZ]_{\\wedge}$ 是开放楔形密度。\n-   全局聚类系数 (GCC)：$C$ 是同一节点的两个随机选择的邻居之间有边相连的概率。\n-   要求方法：对近似（邻居状态的条件独立性）和修正了邻居必须不同的矩封闭。\n-   目标量：$[XYZ]_{\\triangle}$ 和 $[XYZ]_{\\wedge}$。\n-   最终答案中允许的变量：$[XY]$、$[YZ]$、$[Y]$、$\\langle k \\rangle$、$C$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题设定在网络科学和复杂系统建模的标准框架内。对近似和矩封闭是该领域的既定技术。所有定义都是标准的。该问题在科学上是合理的。\n-   **适定性**：问题定义明確。它要求使用指定的近似方法和一组定义的初始量来推导特定量。预计在此框架内存在唯一解。\n-   **客观性**：问题以精确的数学语言陈述，没有歧义或主观论断。\n-   **缺陷清单**：该问题未违反任何无效性标准。它在科学上是合理的、可形式化的、自洽的、在建模背景下是现实的，并且是适定的。其要求的推导并非微不足道。\n\n### 第3步：结论与行动\n问题有效。我将继续进行推导。\n\n### 推导\n目标是找到 $[XYZ]_{\\triangle}$ 和 $[XYZ]_{\\wedge}$ 的表达式。推导过程主要分为三个阶段：首先，使用对近似推导出总三元组密度 $[XYZ]$ 的表达式；其次，将此表达式简化为仅使用允许的变量；第三，使用全局聚类系数 $C$ 将 $[XYZ]$ 分解为其闭合和开放部分。\n\n**1. 总三元组密度 $[XYZ]$ 的推导**\n\n量 $[XYZ]$ 定义为状态为 $Y$ 的中心节点的邻居中，一个处于状态 $X$ 而另一个处于状态 $Z$ 的有序对的数量，再除以总节点数 $N$。\n设 $\\mathcal{V}_Y$ 为处于状态 $Y$ 的节点集合。对于一个度为 $k_j$ 的节点 $j \\in \\mathcal{V}_Y$，设 $k_{j,X}$ 是其处于状态 $X$ 的邻居数量， $k_{j,Z}$ 是其处于状态 $Z$ 的邻居数量。节点 $j$ 的有序 $(X,Z)$ 邻居对的数量为 $k_{j,X} k_{j,Z}$。\n那么，总密度是该量在所有 $Y$ 节点上的平均值，再乘以 $Y$ 节点的比例：\n$$[XYZ] = \\frac{1}{N} \\sum_{j \\in \\mathcal{V}_Y} k_{j,X} k_{j,Z} = [Y] \\left( \\frac{1}{|\\mathcal{V}_Y|} \\sum_{j \\in \\mathcal{V}_Y} k_{j,X} k_{j,Z} \\right) = [Y] \\langle k_X k_Z \\rangle_Y$$\n其中 $\\langle \\cdot \\rangle_Y$ 表示对处于状态 $Y$ 的节点取平均。\n\n对近似假设中心节点的邻居状态是独立的，以中心节点的状态为条件。对于一个度为 $k_j$ 的节点 $j \\in \\mathcal V_Y$，其 $k_j$ 个邻居的状态遵循多项分布。一个 $Y$ 节点的随机邻居处于状态 $W$ 的概率记为 $P(W|Y)$。这个概率可以从给定的密度计算得出。从 $Y$ 节点伸出的边“末端”总数为 $N \\sum_W [YW] = N \\langle k \\rangle [Y]$。从 $Y$ 节点连接到 $X$ 节点的边末端数量为 $N[XY]$。因此，\n$$P(X|Y) = \\frac{N[XY]}{N\\langle k \\rangle [Y]} = \\frac{[XY]}{\\langle k \\rangle [Y]}$$\n对 $Z$ 也类似。\n\n对于一个度为 $k_j$ 的节点 $j \\in \\mathcal V_Y$，乘积 $k_{j,X} k_{j,Z}$ 的期望值由多项分布的性质给出。由于邻居对中的两个邻居必须是不同的，我们选择两个不同的邻居并询问它们的状态。有序的不同邻居对的数量是 $k_j(k_j-1)$。\n$$E[k_{j,X} k_{j,Z} | k_j] = k_j(k_j-1) P(X|Y)P(Z|Y)$$\n这就是问题中提到的“修正了两个邻居必须是不同个体的”事实。对 $Y$ 节点的度分布进行平均：\n$$\\langle k_X k_Z \\rangle_Y = \\langle k(k-1) \\rangle_Y P(X|Y)P(Z|Y)$$\n将此代回 $[XYZ]$ 的表达式中：\n$$[XYZ] = [Y] \\langle k(k-1) \\rangle_Y P(X|Y)P(Z|Y)$$\n现在，我们代入 $P(X|Y)$ 和 $P(Z|Y)$ 的表达式。问题假设“度-度相关性可忽略”，并给出 $\\sum_W [YW] = \\langle k \\rangle [Y]$，这意味着 $Y$ 节点的平均度是全局平均度，即 $\\langle k \\rangle_Y = \\langle k \\rangle$。我们将此推广到更高阶的矩，因此 $\\langle k(k-1) \\rangle_Y \\approx \\langle k(k-1) \\rangle$。\n$$[XYZ] = [Y] \\langle k(k-1) \\rangle \\left( \\frac{[XY]}{\\langle k \\rangle [Y]} \\right) \\left( \\frac{[YZ]}{\\langle k \\rangle [Y]} \\right) = \\frac{\\langle k(k-1) \\rangle}{\\langle k \\rangle^2} \\frac{[XY][YZ]}{[Y]}$$\n\n**2. 表达式的简化**\n\n$[XYZ]$ 的表达式包含 $\\langle k(k-1) \\rangle = \\langle k^2 \\rangle - \\langle k \\rangle$，它依赖于度分布的二阶矩 $\\langle k^2 \\rangle$。问题要求最终答案用 $\\langle k \\rangle$ 表示，而不是 $\\langle k^2 \\rangle$。这就需要对 $\\langle k^2 \\rangle$ 进行近似。一种标准的平均场近似是忽略度的异质性，即假设网络是正则的，其中每个节点的度都相同，$k_i = \\langle k \\rangle$。\n在此近似下：\n$$\\langle k^2 \\rangle = \\langle k \\rangle^2$$\n因此，项 $\\langle k(k-1) \\rangle$近似为：\n$$\\langle k(k-1) \\rangle = \\langle k^2 \\rangle - \\langle k \\rangle \\approx \\langle k \\rangle^2 - \\langle k \\rangle = \\langle k \\rangle (\\langle k \\rangle - 1)$$\n将此代入 $[XYZ]$ 的表达式中：\n$$[XYZ] \\approx \\frac{\\langle k \\rangle (\\langle k \\rangle - 1)}{\\langle k \\rangle^2} \\frac{[XY][YZ]}{[Y]} = \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\frac{[XY][YZ]}{[Y]}$$\n这是在指定近似下 $X-Y-Z$ 三元组总密度的最终形式。\n\n**3. 分解为闭合和开放三元组**\n\n总三元组密度 $[XYZ]$ 是闭合三角密度 $[XYZ]_{\\triangle}$ 和开放楔形密度 $[XYZ]_{\\wedge}$ 的和。\n$$[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$$\n全局聚类系数 $C$ 定义为一个节点的两个随机选择的邻居相互连接的概率。这意味着任何一个形如 $X-Y-Z$ 的给定三元组（或楔形）有 $C$ 的概率是闭合的（即 $X$ 和 $Z$ 之间存在一条边），有 $1-C$ 的概率是开放的。\n我们将这个全局概率应用于我们特定的 $X-Y-Z$ 三元组子集。闭合三角的密度是总三元组密度乘以闭合概率 $C$：\n$$[XYZ]_{\\triangle} = C \\cdot [XYZ]$$\n开放楔形的密度是总三元组密度乘以非闭合概率 $1-C$：\n$$[XYZ]_{\\wedge} = (1-C) \\cdot [XYZ]$$\n代入推导出的 $[XYZ]$ 表达式：\n$$[XYZ]_{\\triangle} = C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\n$$[XYZ]_{\\wedge} = (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\n这些是最终的表达式。它们将以一个两元行矩阵的形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} & (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} \\end{pmatrix}}$$"
        }
    ]
}