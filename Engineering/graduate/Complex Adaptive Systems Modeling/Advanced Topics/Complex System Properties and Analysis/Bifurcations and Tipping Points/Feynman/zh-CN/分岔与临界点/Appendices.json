{
    "hands_on_practices": [
        {
            "introduction": "超临界叉式分岔是描述对称性破缺现象的基本模型，在物理学、生物学和社会系统中广泛存在。通过分析其最简范式，我们将练习识别平衡点、运用线性化方法判断其稳定性的核心技能。这个练习  旨在揭示系统的 $\\mathbb{Z}_2$ 对称性如何约束动态行为，并导致一个稳定状态平滑地转变为两个新的、对称的稳定状态。",
            "id": "4115580",
            "problem": "考虑一个复杂自适应系统（CAS）中集体变量 $x$ 的最小一维对称性保持协同模型，其时间演化由常微分方程 $\\dot{x}=\\mu x - x^{3}$ 给出。参数 $\\mu$ 代表一个缓慢变化的控制驱动（例如，对齐中的净增益），状态 $x$ 则是一个在符号反转下不变的全局有序参数，即该动力学对于 $\\mathbb{Z}_{2}$ 群作用 $x\\mapsto -x$ 是等变的。从第一性原理出发，仅使用核心定义和经过充分检验的事实（平衡点、一维稳定性的线性化以及梯度动力学的概念），完成以下任务：\n\n1. 通过求解 $\\dot{x}=0$，推导出所有平衡点 $x^{\\ast}$ 作为控制参数 $\\mu$ 的函数。\n\n2. 使用基于在每个平衡点处求值的 $\\frac{d}{dx}(\\mu x - x^{3})$ 的一维线性化判据，对每个平衡点 $x^{\\ast}$ 的线性稳定性作为 $\\mu$ 的函数进行分类。从第一性原理证明该分类的合理性。\n\n3. 利用在 $x\\mapsto -x$ 下的不变性以及与此对称性兼容的最低阶奇次非线性的结构，解释 $\\mathbb{Z}_{2}$ 对称性如何约束分岔呈现叉式形态，以及为什么在分岔点出现的分支是对称的。\n\n4. 作为稳定性景观的一个简洁定量总结，构建一个标量势 $V(x;\\mu)$，使得动力学是一个梯度流 $\\dot{x}=-\\frac{\\partial V}{\\partial x}$。选择加性常数使得 $V(0;\\mu)=0$。以单个闭式解析表达式的形式给出 $V(x;\\mu)$ 的最终答案，不带单位。无需四舍五入。",
            "solution": "该问题陈述是初等分岔理论中的一个标准且良构的练习，具体涉及超临界叉式分岔的分析。它具有科学依据，内部一致，并要求应用动力系统的基本原理。因此，该问题被认为是有效的。\n\n该动力系统由以下一维常微分方程描述：\n$$\n\\dot{x} = \\frac{dx}{dt} = f(x; \\mu) = \\mu x - x^{3}\n$$\n其中 $x$ 是状态变量，$\\mu$ 是控制参数。\n\n1. 平衡点的推导\n\n平衡点，记为 $x^{\\ast}$，是系统不随时间变化的状态，即 $\\dot{x} = 0$。为了找到它们，我们求解代数方程 $f(x^{\\ast}; \\mu) = 0$。\n$$\n\\mu x^{\\ast} - (x^{\\ast})^{3} = 0\n$$\n提出公因子 $x^{\\ast}$，我们得到：\n$$\nx^{\\ast} (\\mu - (x^{\\ast})^{2}) = 0\n$$\n该方程的解有两种可能性。\n\n情况1：$x^{\\ast} = 0$。\n这给出了一个平凡平衡点 $x^{\\ast}_{0} = 0$。这个平衡点对所有参数 $\\mu$ 的值都存在。\n\n情况2：$\\mu - (x^{\\ast})^{2} = 0$。\n这得到 $(x^{\\ast})^{2} = \\mu$。为了使 $x^{\\ast}$ 存在实数解，必须有 $\\mu \\ge 0$。当此条件满足时，我们找到两个额外的平衡点：\n$$\nx^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}\n$$\n这两个非平凡平衡点在 $\\mu=0$ 时出现，并且仅在 $\\mu \\ge 0$ 时存在。\n\n总之，作为 $\\mu$ 函数的平衡点为：\n- 对于 $\\mu < 0$：一个平衡点，$x^{\\ast}_{0} = 0$。\n- 对于 $\\mu \\ge 0$：三个平衡点，$x^{\\ast}_{0} = 0$ 和 $x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$。\n\n2. 平衡点的线性稳定性分析\n\n一维平衡点 $x^{\\ast}$ 的稳定性由矢量场导数 $f'(x) = \\frac{df}{dx}$ 在 $x^{\\ast}$ 处的符号决定。如果 $f'(x^{\\ast}) < 0$，小扰动会衰减，平衡点是稳定的（吸引子）。如果 $f'(x^{\\ast}) > 0$，小扰动会增长，平衡点是不稳定的（排斥子）。如果 $f'(x^{\\ast}) = 0$，平衡点是非双曲的，线性分析无法得出结论。\n\n首先，我们计算 $f(x; \\mu) = \\mu x - x^{3}$ 的导数：\n$$\nf'(x; \\mu) = \\frac{d}{dx}(\\mu x - x^{3}) = \\mu - 3x^{2}\n$$\n现在，我们在每个平衡点处计算这个导数的值。\n\n$x^{\\ast}_{0} = 0$ 的稳定性：\n$$\nf'(0; \\mu) = \\mu - 3(0)^{2} = \\mu\n$$\n- 如果 $\\mu < 0$，$f'(0; \\mu) < 0$，所以平衡点 $x^{\\ast}_{0}=0$ 是稳定的。\n- 如果 $\\mu > 0$，$f'(0; \\mu) > 0$，所以平衡点 $x^{\\ast}_{0}=0$ 是不稳定的。\n- 在 $\\mu = 0$ 时，$f'(0; 0) = 0$。稳定性在该点发生改变，该点即为分岔点。\n\n$x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$（对于 $\\mu > 0$）的稳定性：\n我们计算在这些点处的导数：\n$$\nf'(\\pm\\sqrt{\\mu}; \\mu) = \\mu - 3(\\pm\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\n由于这些平衡点仅在 $\\mu > 0$ 时存在，因此对于 $\\mu > 0$，导数 $f'(\\pm\\sqrt{\\mu}; \\mu) = -2\\mu$ 总是负的。因此，两个非平凡平衡分支 $x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$ 在它们存在时总是稳定的。在 $\\mu=0$ 时，它们与平凡分支合并，其稳定性也是非双曲的。\n\n总体行为是，随着参数 $\\mu$ 增加并穿过0，稳定性从平凡分支 $x^{\\ast}_{0}=0$ 转移到两个新的稳定分支 $x^{\\ast}_{\\pm}=\\pm\\sqrt{\\mu}$。这是超临界叉式分岔的标志。\n\n3. $\\mathbb{Z}_{2}$ 对称性的作用\n\n动力学 $\\dot{x} = f(x, \\mu)$ 被陈述为对于 $\\mathbb{Z}_{2}$ 群作用 $x\\mapsto -x$ 是等变的。此性质对 $f(x, \\mu)$ 的函数形式施加了约束。具体来说，如果 $x(t)$ 是一个解，那么 $-x(t)$ 也必须是一个解。令 $y(t) = -x(t)$，则 $\\dot{y} = -\\dot{x} = -f(x, \\mu)$。要使 $y(t)$ 成为一个解，它必须满足 $\\dot{y} = f(y, \\mu)$。代入 $y=-x$，我们得到 $\\dot{y} = f(-x, \\mu)$。令 $\\dot{y}$ 的两个表达式相等，得到对称性条件：\n$$\nf(-x, \\mu) = -f(x, \\mu)\n$$\n这意味着函数 $f(x, \\mu)$ 必须是关于 $x$ 的奇函数。给定的函数 $f(x, \\mu) = \\mu x - x^{3}$ 满足此条件，因为 $f(-x, \\mu) = \\mu(-x) - (-x)^{3} = -\\mu x + x^{3} = -(\\mu x - x^{3}) = -f(x, \\mu)$。\n\n这种对称性对分岔结构有深远的影响。\n首先，如果 $x^{\\ast}$ 是一个平衡点（即 $f(x^{\\ast}, \\mu) = 0$），那么 $f(-x^{\\ast}, \\mu) = -f(x^{\\ast}, \\mu) = -0 = 0$。因此，$-x^{\\ast}$ 也必定是一个平衡点。这保证了任何非零平衡点都必须成对出现，形式为对称的 $(\\pm x^{\\ast})$。平凡平衡点 $x^{\\ast}=0$ 是其自身的对称对应物。\n\n其次，考虑任意奇函数 $f(x)$ 在 $x=0$ 附近的泰勒级数展开：\n$$\nf(x) = c_{1}x + c_{3}x^{3} + c_{5}x^{5} + \\dots\n$$\n当 $x=0$ 解的线性稳定性发生改变时，分岔发生，这发生在当线性系数 $c_{1}$ 穿过零时。该问题的动力学通过截断级数并将线性系数等同于控制参数（即 $c_1 = \\mu$），代表了这一现象的最简单模型，即“范式”模型。$-x^3$ 项是最低阶的奇次*非线性项*。它的负号确保了当 $\\mu>0$ 时，它会抵消远离 $x=0$ 的线性增长，从而创造出新的稳定平衡点。第一个非平凡项是奇次幂（三次）这一事实是 $\\mathbb{Z}_{2}$ 对称性的直接结果。这种一个平衡分支失去稳定性并产生一对对称新分支的结构，根据定义就是叉式分岔。分支的对称出现是系统根本的 $\\mathbb{Z}_{2}$ 对称性的直接后果。\n\n4. 势函数 $V(x;\\mu)$ 的构建\n\n问题要求构建一个标量势 $V(x; \\mu)$，使得动力学可以写成梯度流的形式，即 $\\dot{x} = -\\frac{\\partial V}{\\partial x}$。\n我们已知 $\\dot{x} = \\mu x - x^{3}$。因此，我们必须求解：\n$$\n-\\frac{\\partial V}{\\partial x} = \\mu x - x^{3}\n$$\n两边乘以 $-1$，得到：\n$$\n\\frac{\\partial V}{\\partial x} = x^{3} - \\mu x\n$$\n为了求得 $V(x; \\mu)$，我们将右边的表达式对 $x$ 进行积分，同时保持 $\\mu$ 不变：\n$$\nV(x; \\mu) = \\int (x^{3} - \\mu x) \\, dx = \\frac{x^{4}}{4} - \\mu \\frac{x^{2}}{2} + C(\\mu)\n$$\n其中 $C(\\mu)$ 是一个任意积分“常数”，它可能依赖于参数 $\\mu$，但不依赖于状态变量 $x$。\n问题提供了一个确定此常数的条件：$V(0; \\mu) = 0$。我们将此条件应用于 $V(x; \\mu)$ 的通解：\n$$\nV(0; \\mu) = \\frac{(0)^{4}}{4} - \\mu \\frac{(0)^{2}}{2} + C(\\mu) = 0\n$$\n这意味着 $C(\\mu) = 0$。\n将此结果代回势函数的表达式，我们得到满足给定约束的唯一势函数：\n$$\nV(x;\\mu) = \\frac{1}{4}x^{4} - \\frac{1}{2}\\mu x^{2}\n$$\n该势的局部极小值对应于系统的稳定平衡点，局部极大值对应于不稳定平衡点。对于 $\\mu < 0$，$V(x)$ 在 $x=0$ 处有一个唯一的极小值。对于 $\\mu > 0$，原点 $x=0$ 变成一个局部极大值，并在 $x = \\pm\\sqrt{\\mu}$ 处出现两个新的对称的极小值，这与第2部分进行的稳定性分析完美匹配。",
            "answer": "$$\n\\boxed{\\frac{1}{4}x^{4} - \\frac{1}{2}\\mu x^{2}}\n$$"
        },
        {
            "introduction": "与超临界分岔中的平滑过渡不同，亚临界分岔会导致系统行为发生突然的、灾难性的跳跃。这个练习  探讨了一个包含五次非线性项的模型，它展示了多稳态共存和迟滞现象，这是理解临界点和路径依赖行为的关键。通过确定系统存在多个稳定平衡点的参数区域，你将亲身体会到为何缓慢改变一个控制参数也可能引发系统的急剧转变。",
            "id": "4115551",
            "problem": "考虑一个用于复杂自适应系统中聚合序参量的保持对称性的一维常微分方程（ODE）模型，\n$$\n\\dot{x} = \\mu x + x^{3} - x^{5},\n$$\n其中 $x$ 是一个衡量智能体净排列程度的标量状态，$\\mu$ 是一个代表缓慢外源驱动（例如，压力或资源水平）的标量控制参数。该系统在变换 $x \\mapsto -x$ 下保持不变，这反映了排列没有优选方向。\n\n从适用于一维流的第一性原理出发，利用平衡（$\\dot{x}=0$）和线性稳定性（矢量场在平衡点处导数的符号）的定义来：\n- 推导所有作为 $\\mu$ 函数的平衡分支，\n- 确定哪些分支是线性稳定的，\n- 找出参数 $\\mu$ 的区间，在此区间内系统表现出多个线性稳定平衡点的共存（双稳态），这种现象在缓慢的参数漂移下与迟滞和临界转换相关联。\n\n最后，报告出现双稳态的 $\\mu$ 区间的确切长度（勒贝格测度）。将最终答案表示为一个没有单位的精确值。",
            "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤1：提取已知条件\n-   控制常微分方程（ODE）为：$\\dot{x} = \\mu x + x^{3} - x^{5}$。\n-   $x$ 是一个标量状态变量。\n-   $\\mu$ 是一个标量控制参数。\n-   系统在变换 $x \\mapsto -x$ 下是对称的。\n-   任务是推导平衡分支，确定其线性稳定性，找出导致迟滞现象的双稳态（多个稳定平衡点共存）所对应的参数 $\\mu$ 区间，并报告该区间的长度。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学或事实合理性**：问题在科学上是合理的。所给的ODE是分岔理论中用于研究亚临界叉式分岔和迟滞等现象的标准范式模型。它是动力系统和复杂自适应系统研究中的一个典型例子。\n2.  **不可形式化或不相关**：该问题是分析一维动力系统的一个明确定义的数学练习。它与分岔和临界点的主题直接相关。\n3.  **不完整或矛盾的设置**：问题是自洽的。它提供了控制方程，并清晰地定义了所有变量和任务。没有矛盾之处。\n4.  **不切实际或不可行**：该问题是一个数学抽象。其参数和变量没有与特定的物理单位挂钩，因此不存在物理上不可行的问题。\n5.  **不适定或结构不良**：问题是适定的。对一维ODE的平衡点及其稳定性的分析是一个标准程序，可以得到唯一且有意义的解。\n6.  **伪深刻、琐碎或同义反复**：该问题需要系统地应用分岔理论原理，包括求多项式的根和计算导数。这是一个检验核心概念的非平凡练习。\n7.  **超出科学可验证性**：所有步骤和最终结果在数学上都是可推导和可验证的。\n\n### 步骤3：结论和行动\n问题被判定为有效。将提供解答。\n\n分析过程首先是确定系统的平衡点，然后判断它们的线性稳定性。\n\n平衡点，记为 $x^*$，是系统不发生变化的状态，即 $\\dot{x} = 0$。平衡条件由以下方程给出：\n$$\n\\mu x + x^{3} - x^{5} = 0\n$$\n这个方程可以因式分解为：\n$$\nx(\\mu + x^2 - x^4) = 0\n$$\n一个直接的解是 $x_0 = 0$，它对参数 $\\mu$ 的所有值都是一个平衡点。这个分支对应于平凡的、未排列的状态。\n\n其他的平衡点可以通过求解剩余因子为零来找到：\n$$\nx^4 - x^2 - \\mu = 0\n$$\n这是一个关于变量 $x^2$ 的二次方程。令 $y = x^2$。方程变为：\n$$\ny^2 - y - \\mu = 0\n$$\n使用二次公式求解 $y$：\n$$\ny = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(-\\mu)}}{2(1)} = \\frac{1 \\pm \\sqrt{1 + 4\\mu}}{2}\n$$\n因为 $y = x^2$，所以 $y$ 的解必须是实数且非负，这样才能存在实值的平衡点 $x$。平方根下的项 $1 + 4\\mu$ 必须为非负，这就施加了约束条件 $\\mu \\ge -\\frac{1}{4}$。\n\n这给出了两族关于 $x^2$ 的解：\n1.  $x^2 = \\frac{1 + \\sqrt{1 + 4\\mu}}{2}$。分子是 $1$ 加上一个非负项，因此对于 $\\mu \\ge -\\frac{1}{4}$，这个表达式总是正的。这产生了两条对称的平衡分支，我们记为 $x_{1,2}(\\mu) = \\pm\\sqrt{\\frac{1 + \\sqrt{1 + 4\\mu}}{2}}$。这些分支在 $\\mu \\ge -\\frac{1}{4}$ 时存在。\n\n2.  $x^2 = \\frac{1 - \\sqrt{1 + 4\\mu}}{2}$。为了使 $x^2$ 为非负，我们需要 $1 - \\sqrt{1 + 4\\mu} \\ge 0$，这意味着 $1 \\ge \\sqrt{1 + 4\\mu}$。两边平方（因为两边都是非负的，所以这是有效的）得到 $1 \\ge 1 + 4\\mu$，简化为 $4\\mu \\le 0$，即 $\\mu \\le 0$。结合约束条件 $\\mu \\ge -\\frac{1}{4}$，这族解只在区间 $-\\frac{1}{4} \\le \\mu \\le 0$ 内存在。这产生了两条对称的平衡分支，$x_{3,4}(\\mu) = \\pm\\sqrt{\\frac{1 - \\sqrt{1 + 4\\mu}}{2}}$。\n\n接下来，我们确定这些平衡分支的线性稳定性。平衡点 $x^*$ 的稳定性由矢量场 $f(x) = \\mu x + x^3 - x^5$ 在 $x^*$ 处的导数的符号决定。如果 $f'(x^*) < 0$，平衡点是线性稳定的；如果 $f'(x^*) > 0$，则是不稳定的。\n导数是：\n$$\nf'(x) = \\frac{d}{dx}(\\mu x + x^3 - x^5) = \\mu + 3x^2 - 5x^4\n$$\n平凡平衡点 $x_0 = 0$ 的稳定性：\n$$\nf'(0) = \\mu + 3(0)^2 - 5(0)^4 = \\mu\n$$\n因此，平衡点 $x_0 = 0$ 在 $\\mu < 0$ 时是稳定的，在 $\\mu > 0$ 时是不稳定的。在 $\\mu=0$ 时发生分岔。\n\n非平凡平衡点 $x^* \\neq 0$ 的稳定性：\n对于这些平衡点，我们从其定义可知 $\\mu + (x^*)^2 - (x^*)^4 = 0$，这意味着 $\\mu = (x^*)^4 - (x^*)^2$。我们将这个关于 $\\mu$ 的表达式代入导数 $f'(x^*)$ 中：\n$$\nf'(x^*) = \\mu + 3(x^*)^2 - 5(x^*)^4 = \\left((x^*)^4 - (x^*)^2\\right) + 3(x^*)^2 - 5(x^*)^4\n$$\n$$\nf'(x^*) = 2(x^*)^2 - 4(x^*)^4 = 2(x^*)^2 (1 - 2(x^*)^2)\n$$\n因为 $x^* \\ne 0$，所以 $(x^*)^2 > 0$，因此 $f'(x^*)$ 的符号由项 $(1 - 2(x^*)^2)$ 的符号决定。\n-   如果 $1 - 2(x^*)^2 < 0 \\iff (x^*)^2 > \\frac{1}{2}$，则稳定。\n-   如果 $1 - 2(x^*)^2 > 0 \\iff (x^*)^2 < \\frac{1}{2}$，则不稳定。\n\n现在我们将此稳定性判据应用于非平凡分支：\n1.  对于分支 $x_{1,2}(\\mu)$，我们有 $(x^*)^2 = \\frac{1 + \\sqrt{1 + 4\\mu}}{2}$。稳定性条件 $(x^*)^2 > \\frac{1}{2}$ 变为：\n    $$\n    \\frac{1 + \\sqrt{1 + 4\\mu}}{2} > \\frac{1}{2} \\implies 1 + \\sqrt{1 + 4\\mu} > 1 \\implies \\sqrt{1 + 4\\mu} > 0\n    $$\n    这个不等式在 $1 + 4\\mu > 0$ 时成立，即 $\\mu > -\\frac{1}{4}$。在 $\\mu = -\\frac{1}{4}$ 时，$f'(x^*) = 0$，这对应于一个鞍结分岔。因此，分支 $x_{1,2}(\\mu)$ 在所有 $\\mu > -\\frac{1}{4}$ 的情况下都是稳定的。\n\n2.  对于分支 $x_{3,4}(\\mu)$，我们有 $(x^*)^2 = \\frac{1 - \\sqrt{1 + 4\\mu}}{2}$。稳定性条件与 $(x^*)^2 = \\frac{1}{2}$ 进行比较：\n    $$\n    \\frac{1 - \\sqrt{1 + 4\\mu}}{2} < \\frac{1}{2} \\implies 1 - \\sqrt{1 + 4\\mu} < 1 \\implies -\\sqrt{1 + 4\\mu} < 0\n    $$\n    只要 $\\sqrt{1 + 4\\mu}$ 为正，即 $\\mu > -\\frac{1}{4}$，这个不等式就成立。由于该分支存在于 $-\\frac{1}{4} \\le \\mu \\le 0$ 的区间内，我们有在 $\\mu \\in (-\\frac{1}{4}, 0]$ 时 $(x^*)^2 < \\frac{1}{2}$。因此，分支 $x_{3,4}(\\mu)$ 在其整个存在域上都是不稳定的，除了在分岔点 $\\mu = -\\frac{1}{4}$。\n\n问题要求找出出现与迟滞相关的双稳态的 $\\mu$ 区间。这种现象要求至少存在两个稳定平衡点。我们已经找到了以下稳定平衡点：\n-   平凡状态 $x_0 = 0$ 在 $\\mu < 0$ 时是稳定的。\n-   非平凡状态 $x_{1,2}(\\mu)$ 在 $\\mu > -\\frac{1}{4}$ 时是稳定的。\n\n为了使系统表现出双稳态（在这种情况下，是涉及 $x_0$ 和对称对 $x_{1,2}$ 的三稳态），这两个条件必须同时满足。平凡状态和非平凡状态都稳定的 $\\mu$ 范围是这两个区间的交集：\n$$\n\\{\\mu \\mid \\mu < 0\\} \\cap \\{\\mu \\mid \\mu > -\\frac{1}{4}\\} = \\{\\mu \\mid -\\frac{1}{4} < \\mu < 0\\}\n$$\n这个区间是 $(-\\frac{1}{4}, 0)$。在此范围内，系统有三个稳定平衡点：$x_0=0$ 和一对 $x_{1,2}(\\mu)$。稳定状态的这种多样性是产生迟滞的原因。如果参数 $\\mu$ 从一个正值缓慢减小，系统将保持在稳定的 $x_{1,2}$ 分支上，直到 $\\mu = -\\frac{1}{4}$，此时它必须跳到 $x_0=0$ 的状态。如果 $\\mu$ 从一个小于 $-\\frac{1}{4}$ 的值缓慢增加，系统将保持在 $x_0=0$ 的状态，直到 $\\mu=0$，此时它必须跳到 $x_{1,2}$ 分支之一。迟滞区域由 $\\mu = -\\frac{1}{4}$ 处的鞍结分岔和 $\\mu=0$ 处的亚临界叉式分岔界定。\n\n最后的任务是计算这个双稳态区间的长度（勒贝格测度）。该区间为 $I = (-\\frac{1}{4}, 0)$。区间 $(a, b)$ 的长度是 $b - a$。\n$$\n\\text{长度} = 0 - \\left(-\\frac{1}{4}\\right) = \\frac{1}{4}\n$$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "理论模型为了清晰地揭示原理，通常是确定性的，但真实的复杂自适应系统总是充满噪声且其参数会随时间漂移。这个计算实践  将理论与应用联系起来，要求你模拟一个在噪声干扰下逐渐逼近鞍结分岔的系统。你的任务是实现一个计算流程，通过监测时间序列数据中自相关的变化（一种被称为“临界慢化”的现象），来预警即将到来的临界点，这是复杂系统韧性分析中的一项核心技术。",
            "id": "4115535",
            "problem": "考虑一个一维状态变量 $x(t)$ 的随机微分方程，其控制参数 $\\mu(t)$ 缓慢漂移，并带有加性高斯白噪声，\n$$\\dot{x}(t) = \\mu(t) - x(t)^2 + \\sigma \\,\\eta(t),$$\n其中 $\\eta(t)$ 是标准高斯白噪声，$\\sigma \\ge 0$ 是噪声幅度，$\\mu(t)$ 根据以下公式线性漂移\n$$\\mu(t) = \\mu_0 + v\\,t,$$\n其中 $\\mu_0 \\in \\mathbb{R}$ 且 $v \\in \\mathbb{R}$。确定性部分 $\\dot{x}=\\mu - x^2$ 在 $\\mu=0$ 处有一个鞍结分岔。当 $\\mu(t)$ 从正侧趋近于 $0$ 时，系统表现出临界慢化，在噪声存在的情况下，这通常表现为时间序列 $x(t)$ 中滞后-1 自相关的增加。复杂自适应系统中临界点的预警指标旨在检测此类趋势。\n\n从第一性原理和经过充分检验的数值程序出发：\n- 使用 Euler–Maruyama 格式离散化该随机微分方程。对于时间步长 $\\Delta t > 0$ 和离散时间 $t_n = n\\,\\Delta t$（其中 $n \\in \\{0,1,\\dots,N-1\\}$ 且 $N=\\lfloor T/\\Delta t \\rfloor$），近似为\n$$x_{n+1} = x_n + \\left(\\mu_n - x_n^2\\right)\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n,$$\n其中 $\\mu_n = \\mu_0 + v\\,t_n$ 且 $\\xi_n \\sim \\mathcal{N}(0,1)$ 是独立同分布的标准正态随机变量。\n- 在移除局部线性趋势后，在模拟的离散时间序列的移动窗口内估计滞后-1 自相关。对于长度为 $W$ 的窗口化段 $\\{x_{k}, x_{k+1},\\dots,x_{k+W-1}\\}$，对 $i \\in \\{k,\\dots,k+W-1\\}$ 拟合线性模型 $x_i \\approx a + b\\,i$ 并计算残差 $r_i = x_i - (a + b\\,i)$。该窗口中的样本滞后-1 自相关定义为\n$$\\rho_1 = \\frac{\\sum_{i=k+1}^{k+W-1} \\left(r_i - \\bar{r}\\right)\\left(r_{i-1} - \\bar{r}\\right)}{\\sum_{i=k}^{k+W-1} \\left(r_i - \\bar{r}\\right)^2},$$\n其中 $\\bar{r} = \\frac{1}{W}\\sum_{i=k}^{k+W-1} r_i$。\n- 使用非参数秩基趋势检验来测试窗口化滞后-1 自相关序列是否存在统计上显著的增长趋势。具体来说，计算窗口索引与相应 $\\rho_1$ 值之间的 Kendall 秩相关（Kendall $\\tau$），如果 $\\tau > 0$ 且相关的 p 值低于显著性水平 $\\alpha$，则判定为增长趋势。\n\n您的任务是实现一个完整的程序，该程序：\n1. 对下述测试套件中的每一组参数，使用 Euler–Maruyama 方法模拟时间序列。\n2. 对每个模拟的时间序列，计算去趋势后残差的移动窗口滞后-1 自相关。\n3. 应用 Kendall 秩相关，以 $\\alpha = 0.01$ 的显著性水平检验是否存在统计上显著的增长趋势。\n4. 为每个测试用例生成一个布尔结果，表明是否检测到显著的增长趋势。\n\n使用以下参数值测试套件以确保覆盖不同场景。每个测试用例指定为一个元组 $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed})$，其含义如下：初始控制参数 $\\mu_0$、漂移率 $v$、噪声幅度 $\\sigma$、时间步长 $\\Delta t$、总模拟时间 $T$、窗口长度 $W$（以样本数计）、窗口推进的步幅 $S$（以样本数计）以及用于可复现性的随机数生成器种子。\n\n- 测试用例 1 (趋近临界点)：$(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, -0.001, 0.05, 0.01, 400.0, 2000, 1000, 123)$。\n- 测试用例 2 (无漂移)：$(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, 0.0, 0.05, 0.01, 400.0, 2000, 1000, 456)$。\n- 测试用例 3 (远离临界点)：$(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.1, 0.001, 0.05, 0.01, 400.0, 2000, 1000, 789)$。\n- 测试用例 4 (高噪声下趋近临界点)：$(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, -0.001, 0.30, 0.01, 400.0, 2000, 1000, 321)$。\n\n算法和数值要求：\n- 设置初始条件 $x_0 = \\sqrt{\\max(\\mu_0, 0)}$。\n- 使用指定的随机种子以保证可复现性。\n- 在计算窗口内的滞后-1 自相关时，如果分母为零，则将该窗口的自相关定义为 $0$。\n- 趋势检验使用显著性水平 $\\alpha = 0.01$。\n- 本问题不涉及角度；不需要角度单位。不需要物理单位；将时间和状态变量视为无量纲。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的布尔结果，形式为方括号括起的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 为 $True$ 或 $False$）。请精确地以此格式生成一行输出，不含任何其他文本。",
            "solution": "该问题要求实现一个数值和统计程序，以检测随机动力系统中临界点的预警信号。该系统由一个带缓慢漂移参数的一维随机微分方程（SDE）描述，该方程模拟了鞍结分岔。预警信号是系统状态变量的滞后-1 自相关中出现的统计上显著的增长趋势，这一现象被称为临界慢化。\n\n解决方案分三个主要阶段进行：\n1.  使用 Euler–Maruyama 方法对 SDE 进行数值模拟。\n2.  在模拟的时间序列上，通过移动窗口计算滞后-1 自相关。\n3.  使用 Kendall 秩相关对自相关值序列进行单调趋势的统计检验。\n\n**1. 系统动力学与数值模拟**\n\n状态变量 $x(t)$ 的演化由以下 SDE 控制：\n$$\n\\dot{x}(t) = \\mu(t) - x(t)^2 + \\sigma \\,\\eta(t)\n$$\n动力学的确定性部分 $f(x, \\mu) = \\mu - x^2$ 定义了势景观。对于固定的 $\\mu > 0$，系统在 $x = \\sqrt{\\mu}$ 处有一个稳定平衡点，在 $x = -\\sqrt{\\mu}$ 处有一个不稳定平衡点。当控制参数 $\\mu$ 趋近分岔点 $\\mu_c = 0$ 时，这些平衡点合并并消失。对于 $\\mu < 0$，不存在平衡点，系统状态被驱动向 $-\\infty$。参数 $\\mu(t)$ 随时间线性漂移，即 $\\mu(t) = \\mu_0 + v\\,t$。如果漂移率 $v$ 为负，系统将被驱动向临界点。项 $\\sigma \\,\\eta(t)$ 代表幅度为 $\\sigma$ 的加性高斯白噪声。\n\n为模拟系统轨迹，我们使用 Euler–Maruyama 格式离散化该 SDE。对于时间步长 $\\Delta t$，在时间 $t_{n+1} = (n+1)\\Delta t$ 的状态 $x_{n+1}$ 可由时间 $t_n = n\\Delta t$ 的状态 $x_n$ 近似得出：\n$$\nx_{n+1} = x_n + (\\mu_n - x_n^2)\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n\n$$\n在此，$\\mu_n = \\mu_0 + v\\,t_n$ 是时间 $t_n$ 处的控制参数，$\\xi_n$ 是从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取的独立随机变量。模拟从初始条件 $x_0 = \\sqrt{\\max(\\mu_0, 0)}$ 开始，这会将系统（如果存在稳定平衡点）置于 $t=0$ 时的稳定平衡点上。由此生成一个完整的时间序列 $\\{x_0, x_1, \\dots, x_{N-1}\\}$，其中 $N = \\lfloor T/\\Delta t \\rfloor$。\n\n**2. 移动窗口自相关分析**\n\n当系统从上方趋近分岔点 $\\mu=0$ 时，稳定平衡点 $x = \\sqrt{\\mu}$ 周围的吸引盆会变平。这导致了一种称为临界慢化的现象，即系统在受到小扰动后恢复到平衡点的时间会发散。在随机系统中，这表现为时间相关性的增加，因为过去状态对当前状态的影响会持续更长时间。\n\n为检测这一变化，我们使用移动窗口方法分析时间序列 $\\{x_n\\}$。该序列被划分为长度为 $W$ 个样本的重叠段。这些窗口以 $S$ 个样本的步幅沿时间序列推进。对每个窗口，我们计算其滞后-1 自相关 $\\rho_1$。\n\n每个窗口内一个关键的预处理步骤是去趋势。漂移的参数 $\\mu(t)$ 使时间序列非平稳，这本身就可能引入伪相关。为分离出来自内在动力学的相关性，我们从每个窗口的数据中移除局部线性趋势。对于一个段 $\\{x_k, \\dots, x_{k+W-1}\\}$，我们执行普通最小二乘拟合，为模型 $x_i \\approx a + b\\,i$（其中 $i \\in \\{k, \\dots, k+W-1\\}$）找到系数 $a$ 和 $b$。然后用残差 $r_i = x_i - (a + b\\,i)$ 进行后续分析。\n\n然后，使用指定公式根据这些残差计算该窗口的样本滞后-1 自相关 $\\rho_1$：\n$$\n\\rho_1 = \\frac{\\sum_{i=k+1}^{k+W-1} (r_i - \\bar{r})(r_{i-1} - \\bar{r})}{\\sum_{i=k}^{k+W-1} (r_i - \\bar{r})^2}\n$$\n其中 $\\bar{r}$ 是窗口内残差的均值，$\\bar{r} = \\frac{1}{W}\\sum_{i=k}^{k+W-1} r_i$。此计算为每个窗口产生一个 $\\rho_1$ 值，从而得到一个 $\\rho_1$ 值的序列。\n\n**3. 统计趋势检测**\n\n最后一步是确定计算出的 $\\rho_1$ 值序列是否表现出统计上显著的增长趋势，这将作为预警信号。为此，我们使用 Kendall 秩相关检验，这是一种评估两个变量之间单调关系强度的非参数方法。在这里，这两个变量是窗口索引（一个代表时间的序数）和相应的 $\\rho_1$ 值。\n\n该检验计算 Kendall's $\\tau$ 统计量（其范围从 -1（完全递减趋势）到 +1（完全递增趋势））以及一个相关的 p 值。在无趋势的原假设下，p 值表示观测到至少与所测量趋势一样强的趋势的概率。\n\n根据问题的标准，当且仅当满足以下两个条件时，才算检测到预警信号：\n1.  相关系数 $\\tau > 0$，表示一个正（增长）趋势。\n2.  p 值小于指定的显著性水平，$p < \\alpha$（其中 $\\alpha = 0.01$）。这表明观测到的增长趋势在统计上是显著的。\n\n将此完整程序应用于每个测试用例，得出一个布尔结果，表明是否检测到显著趋势。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import kendalltau\n\ndef solve():\n    \"\"\"\n    Implements the full pipeline to detect early warning signals for tipping points\n    in a stochastic dynamical system, based on the problem specification.\n    \"\"\"\n    # Test cases: (mu0, v, sigma, dt, T, W, S, seed)\n    test_cases = [\n        (0.5, -0.001, 0.05, 0.01, 400.0, 2000, 1000, 123),\n        (0.5, 0.0, 0.05, 0.01, 400.0, 2000, 1000, 456),\n        (0.1, 0.001, 0.05, 0.01, 400.0, 2000, 1000, 789),\n        (0.5, -0.001, 0.30, 0.01, 400.0, 2000, 1000, 321),\n    ]\n\n    results = []\n    alpha = 0.01\n\n    for case in test_cases:\n        mu0, v, sigma, dt, T, W, S, seed = case\n\n        # --- 1. SDE Simulation (Euler-Maruyama) ---\n        rng = np.random.default_rng(seed)\n        t = np.arange(0, T, dt)\n        N = len(t)\n        mu = mu0 + v * t\n        \n        x = np.zeros(N)\n        x[0] = np.sqrt(max(mu0, 0.0))\n        \n        # Generate all random numbers at once for efficiency\n        xi = rng.standard_normal(N - 1)\n        \n        sqrt_dt = np.sqrt(dt)\n        for n in range(N - 1):\n            drift_term = (mu[n] - x[n]**2) * dt\n            diffusion_term = sigma * sqrt_dt * xi[n]\n            x[n+1] = x[n] + drift_term + diffusion_term\n\n        # --- 2. Moving Window Autocorrelation ---\n        autocorrelations = []\n        window_starts = np.arange(0, N - W + 1, S)\n        window_indices = np.arange(W)\n\n        for k in window_starts:\n            x_window = x[k : k + W]\n            \n            # Detrending: fit a linear model x_i ~ a + b*i\n            # np.polyfit returns [slope, intercept] for degree 1\n            slope, intercept = np.polyfit(window_indices, x_window, 1)\n            trend = slope * window_indices + intercept\n            residuals = x_window - trend\n            \n            # Calculate lag-1 autocorrelation from residuals\n            r_mean = np.mean(residuals)\n            centered_residuals = residuals - r_mean\n            \n            # Sum of squared centered residuals (denominator)\n            denominator = np.sum(centered_residuals**2)\n            \n            rho_1 = 0.0\n            if denominator > 0:\n                # Sum of products of lagged centered residuals (numerator)\n                numerator = np.sum(centered_residuals[1:] * centered_residuals[:-1])\n                rho_1 = numerator / denominator\n            \n            autocorrelations.append(rho_1)\n\n        # --- 3. Trend Detection (Kendall's Tau) ---\n        # Ensure there are enough points for a meaningful trend test\n        if len(autocorrelations) < 3:\n             is_significant_trend = False\n        else:\n            tau, p_value = kendalltau(\n                np.arange(len(autocorrelations)), \n                autocorrelations\n            )\n            \n            # A significant increasing trend is detected if tau > 0 and p < alpha\n            is_significant_trend = (tau > 0) and (p_value < alpha)\n        \n        results.append(is_significant_trend)\n\n    # Final output formatting\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}