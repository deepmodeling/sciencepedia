{
    "hands_on_practices": [
        {
            "introduction": "我们从一个理想化的模型开始，探索一个完全没有上位效应的“平滑”适应度景观。这个练习旨在通过计算可及路径的数量，来揭示加性景观的基本组合结构，并为理解更复杂景观的崎岖性提供一个重要的基准 。这个推导过程将直观地展示，在没有基因相互作用的情况下，进化路径是如何不受约束的。",
            "id": "4123166",
            "problem": "考虑一个二元基因型空间 $\\{0,1\\}^{L}$，其中基因型由一个长度为 $L$ 的比特串表示，并且 $L$ 维超立方体的顶点即为基因型。在一个加性景观中，基因型 $g = (g_{1},\\dots,g_{L})$ 的适应度由位点特异性贡献的总和给出，\n$$\nF(g) \\;=\\; \\sum_{i=1}^{L} s_{i}\\, g_{i},\n$$\n其中每个 $s_{i} \\in \\mathbb{R}_{>0}$ 是一个固定的、严格为正的常数，不依赖于遗传背景，而 $g_{i} \\in \\{0,1\\}$ 表示位点 $i$ 上的等位基因。一条路径是一个基因型序列，起始于 $0^{L} = (0,\\dots,0)$ 并终止于 $1^{L} = (1,\\dots,1)$，其中每一步都将一个坐标从 $0$ 翻转为 $1$（即，没有回复突变的单点突变步骤）。如果路径上每一步的适应度都严格增加，则定义该路径为可及的。从这些定义和超立方体的组合结构出发，推导从 $0^{L}$ 到 $1^{L}$ 的可及路径总数，作为 $L$ 的函数。将您的最终答案表示为一个闭合形式的解析表达式。无需四舍五入。",
            "solution": "要找出从基因型 $0^L = (0, \\dots, 0)$ 到 $1^L = (1, \\dots, 1)$ 的可及路径总数。\n\n首先，根据问题定义，一条路径是由 $L$ 个单点突变步骤组成的序列，其中每一步都将一个不同的比特从 $0$ 翻转为 $1$。这意味着一条路径唯一地对应于 $L$ 个位点发生突变的特定顺序。例如，如果 $L=3$，一条可能的路径是位点2先突变，然后是位点1，最后是位点3，这对应于基因型序列 $(0,0,0) \\to (0,1,0) \\to (1,1,0) \\to (1,1,1)$。因此，所有可能的路径数量等于 $L$ 个位点突变顺序的排列数，即 $L!$。\n\n接下来，我们应用可及性条件：路径上每一步的适应度都必须严格增加。\n考虑路径中的任意一步，该步骤通过将第 $j$ 个比特从 $0$ 翻转为 $1$ 来将基因型 $g$ 变为新基因型 $g'$。基因型 $g$ 有 $g_j=0$，而基因型 $g'$ 有 $g'_j=1$，对于所有其他位点 $i \\neq j$，我们有 $g_i = g'_i$。\n\n这一步的适应度变化是 $\\Delta F = F(g') - F(g)$。\n$$\n\\Delta F = \\left( \\sum_{i=1}^{L} s_i g'_i \\right) - \\left( \\sum_{i=1}^{L} s_i g_i \\right) = s_j g'_j - s_j g_j = s_j(1 - 0) = s_j\n$$\n可及性条件要求 $\\Delta F > 0$，即 $s_j > 0$。\n\n问题中明确规定，对于所有位点 $i \\in \\{1, \\dots, L\\}$，系数 $s_i$ 都是严格为正的 ($s_i \\in \\mathbb{R}_{>0}$)。这意味着，对于任何一个将 $0$ 翻转为 $1$ 的突变，其适应度变化 $s_j$ 总是正的。\n\n因此，在加性景观且所有 $s_i > 0$ 的条件下，任何由 $L$ 次从 $0$ 到 $1$ 的突变构成的路径，其每一步适应度都会严格增加。这意味着所有 $L!$ 条可能的路径都是可及路径。\n\n因此，从 $0^L$ 到 $1^L$ 的可及路径总数是 $L!$。",
            "answer": "$$\\boxed{L!}$$"
        },
        {
            "introduction": "在认识了加性景观的特性之后，我们现在引入上位效应这一关键概念，它是导致景观崎岖性的主要原因。通过构建一个具体的双位点适应度模型，本练习将帮助你区分“幅度上位性”和“符号上位性”，并理解只有后者才会从根本上改变景观的拓扑结构，可能产生新的局部最适点 。这是理解基因相互作用如何塑造进化轨迹的关键一步。",
            "id": "4123214",
            "problem": "考虑一个具有两个基因座的二元基因型空间，表示为 $\\{0,1\\}^{2}$，其基因型记为 $00$、$10$、$01$ 和 $11$。设适应度函数 $F:\\{0,1\\}^{2}\\to\\mathbb{R}$ 为每个基因型赋予一个实值适应度。使用复杂适应系统建模中适应度景观理论的以下基本定义和事实：\n\n- 加性基线适应度为 $F_{\\text{add}}(i,j) = F_{00} + s_{1} i + s_{2} j$，其中 $s_{1}$ 和 $s_{2}$ 是单基因座选择系数。\n- 一个标准的双基因座上位性扩展为 $F(i,j) = F_{00} + s_{1} i + s_{2} j + \\epsilon\\, i j$，其中 $\\epsilon$ 是配对上位性系数。\n- 如果 $\\operatorname{sign}\\!\\big(F_{10}-F_{00}\\big) \\neq \\operatorname{sign}\\!\\big(F_{11}-F_{01}\\big)$，则基因座1存在符号上位性，对基因座2也类似。如果单基因座效应的符号在不同遗传背景下相同，但其幅度不同（即 $\\epsilon \\neq 0$ 同时所有单步适应度效应的符号保持不变），则存在无符号上位性的幅度上位性。\n- 在无向基因型图（二维汉明图 $Q_{2}$）上的一个局部最大值是指其适应度严格大于其所有汉明距离为1的邻居的基因型。\n\n使用 $F_{00} = 1$、$s_{1} = \\frac{2}{5}$、$s_{2} = \\frac{3}{10}$ 和 $\\epsilon = -\\frac{1}{5}$：\n\n1. 在 $F(i,j) = F_{00} + s_{1} i + s_{2} j + \\epsilon\\, i j$ 条件下，构建完整的双基因座适应度表 $\\{F_{00},F_{10},F_{01},F_{11}\\}$。\n2. 从基本原理出发，通过检查每个基因座在两种遗传背景下单基因座效应的符号，验证所得到的景观表现出无符号上位性的幅度上位性。\n3. 确定 $Q_{2}$ 上局部最大值的数量 $M$，并从加性基线 $F_{\\text{add}}$ 出发解释为什么上位性项没有在加性预测之外引入额外的局部最大值。\n4. 报告由上位性系数 $\\epsilon$ 和局部最大值数量 $M$ 组成的数对作为你的最终答案，写成一个单行矩阵。无需四舍五入，这些量也没有单位。",
            "solution": "**1. 构建适应度表**\n我们使用给定的适应度函数 $F(i,j) = F_{00} + s_{1} i + s_{2} j + \\epsilon\\, i j$ 和指定的常数 $F_{00} = 1$、$s_{1} = \\frac{2}{5}$、$s_{2} = \\frac{3}{10}$ 以及 $\\epsilon = -\\frac{1}{5}$ 来计算四个基因型中每一个的适应度。\n\n- 对于基因型 $00$ ($i=0, j=0$):\n$F_{00} = F(0,0) = 1 + (\\frac{2}{5})(0) + (\\frac{3}{10})(0) + (-\\frac{1}{5})(0)(0) = 1$。\n\n- 对于基因型 $10$ ($i=1, j=0$):\n$F_{10} = F(1,0) = 1 + (\\frac{2}{5})(1) + (\\frac{3}{10})(0) + (-\\frac{1}{5})(1)(0) = 1 + \\frac{2}{5} = \\frac{7}{5} = 1.4$。\n\n- 对于基因型 $01$ ($i=0, j=1$):\n$F_{01} = F(0,1) = 1 + (\\frac{2}{5})(0) + (\\frac{3}{10})(1) + (-\\frac{1}{5})(0)(1) = 1 + \\frac{3}{10} = \\frac{13}{10} = 1.3$。\n\n- 对于基因型 $11$ ($i=1, j=1$):\n$F_{11} = F(1,1) = 1 + \\frac{2}{5} + \\frac{3}{10} - \\frac{1}{5} = 1 + \\frac{4}{10} + \\frac{3}{10} - \\frac{2}{10} = 1 + \\frac{5}{10} = \\frac{15}{10} = 1.5$。\n\n得到的适应度表为 $\\{F_{00}, F_{10}, F_{01}, F_{11}\\} = \\{1, 1.4, 1.3, 1.5\\}$。\n\n**2. 验证无符号上位性的幅度上位性**\n为验证上位性的性质，我们计算在不同遗传背景下单基因座替换的适应度效应。\n\n- **基因座1的效应**（第一个基因座上从 $0 \\to 1$ 的突变）：\n  - 在背景 $j=0$ 上：$\\Delta F = F_{10} - F_{00} = 1.4 - 1 = 0.4 = \\frac{2}{5}$。\n  - 在背景 $j=1$ 上：$\\Delta F = F_{11} - F_{01} = 1.5 - 1.3 = 0.2 = \\frac{1}{5}$。\n  - 两个效应的符号都为正。由于效应的幅度不同但符号相同，因此不存在符号上位性。\n\n- **基因座2的效应**（第二个基因座上从 $0 \\to 1$ 的突变）：\n  - 在背景 $i=0$ 上：$\\Delta F = F_{01} - F_{00} = 1.3 - 1 = 0.3 = \\frac{3}{10}$。\n  - 在背景 $i=1$ 上：$\\Delta F = F_{11} - F_{10} = 1.5 - 1.4 = 0.1 = \\frac{1}{10}$。\n  - 两个效应的符号都为正。同样，不存在符号上位性。\n\n由于上位性系数 $\\epsilon = -\\frac{1}{5} \\neq 0$ 并且两个基因座的单突变效应在不同背景下符号保持不变，该景观表现出无符号上位性的幅度上位性。\n\n**3. 确定局部最大值的数量 ($M$)**\n局部最大值是适应度严格大于其所有汉明距离为1的邻居的基因型。\n- 基因型 $00$ (1.0): 邻居是 $10$ (1.4) 和 $01$ (1.3)，适应度都更高。不是局部最大值。\n- 基因型 $10$ (1.4): 邻居是 $00$ (1.0) 和 $11$ (1.5)。$F_{11} > F_{10}$。不是局部最大值。\n- 基因型 $01$ (1.3): 邻居是 $00$ (1.0) 和 $11$ (1.5)。$F_{11} > F_{01}$。不是局部最大值。\n- 基因型 $11$ (1.5): 邻居是 $10$ (1.4) 和 $01$ (1.3)，适应度都更低。这是一个局部最大值。\n\n因此，景观中恰好有一个局部最大值，即基因型 $11$。所以 $M = 1$。\n在加性基线模型中，由于 $s_1 > 0$ 和 $s_2 > 0$，适应度总是随着 1 的数量增加而单调增加，因此基因型 $11$ 是唯一的（全局）最大值。在这个问题中，负上位性项 ($\\epsilon  0$) 减弱了突变在另一个突变存在时的有益效果，但其强度不足以逆转效应的符号（即导致 $s_1+\\epsilon  0$ 或 $s_2+\\epsilon  0$）。具体来说，$s_1+\\epsilon = 2/5 - 1/5 = 1/5 > 0$ 且 $s_2+\\epsilon = 3/10 - 1/5 = 1/10 > 0$。因此，所有通向基因型 $11$ 的单向路径仍然是适应度递增的，景观的拓扑结构保持单峰，没有产生额外的局部最大值。\n\n**4. 最终答案的形成**\n问题要求给出由上位性系数 $\\epsilon$ 和局部最大值数量 $M$ 组成的数对。我们已经求得 $\\epsilon = -\\frac{1}{5}$ 和 $M = 1$。这被报告为一个单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{5}  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后，我们将理论付诸实践，在一个崎岖的多峰景观上模拟适应性演化过程。本练习要求你为一个给定的四位点景观计算所有局部最适点的吸引盆大小，从而直观地感受适应度景观的结构是如何决定进化动态和最终结果的 。通过追踪贪心算法下的演化路径，你将深刻理解进化过程中的可预测性与偶然性。",
            "id": "4123161",
            "problem": "考虑一个有限基因型空间 $\\{0,1\\}^{4}$，其具有标准的汉明图结构，其中两个基因型当且仅当它们仅在一个比特位上不同时才相邻。适应度景观是一个函数 $f:\\{0,1\\}^{4}\\to\\mathbb{R}$，其值如下：\n$f(0000)=7.0, f(0001)=7.8, f(0010)=10.2, f(0011)=9.3,$\n$f(0100)=8.0, f(0101)=9.0, f(0110)=11.6, f(0111)=10.9,$\n$f(1000)=9.5, f(1001)=9.2, f(1010)=11.8, f(1011)=9.7,$\n$f(1100)=12.0, f(1101)=10.5, f(1110)=11.0, f(1111)=12.5$。\n\n定义贪婪爬山动力学如下：从任意状态 $\\mathbf{x}\\in\\{0,1\\}^{4}$，考虑其汉明距离为1的邻居集合 $N(\\mathbf{x})$。如果存在一个邻居 $\\mathbf{y}\\in N(\\mathbf{x})$ 使得 $f(\\mathbf{y}) > f(\\mathbf{x})$，则移动到那些满足 $f(\\mathbf{y}) > f(\\mathbf{x})$ 的邻居中适应度最大的邻居；如果这些最大适应度的邻居中有多个，则选择字典序最小的二进制串（字典序由 $0000, 0001, \\dots, 1111$ 定义）。如果没有邻居具有严格更高的适应度，则停止。\n局部最大值（峰）是一个基因型 $\\mathbf{m}$，满足对于所有 $\\mathbf{y}\\in N(\\mathbf{m})$ 都有 $f(\\mathbf{y})  f(\\mathbf{m})$。对于一个峰 $\\mathbf{m}$，其吸引盆 $B(\\mathbf{m})$ 是指所有起始状态 $\\mathbf{x} \\in \\{0,1\\}^4$ 的集合，从这些状态开始的贪婪爬山轨迹最终会终止于 $\\mathbf{m}$。\n\n确定该景观中的所有局部最大值，并计算每个峰的吸引盆的大小 $|B(\\mathbf{m})|$。请以一个单行向量的形式报告峰 $\\{0110, 1010, 1100, 1111\\}$ 的吸引盆大小，并按照峰的字典序排列。",
            "solution": "为了找到吸引盆，我们首先需要确定景观中的所有局部最大值（峰）。一个基因型是局部最大值，如果它的适应度严格大于其所有汉明距离为1的邻居。我们将逐一检查问题中给出的四个候选峰：\n- **峰 0110 (f=11.6):** 邻居为 1110 (f=11.0), 0010 (f=10.2), 0100 (f=8.0), 0111 (f=10.9)。所有邻居的适应度都更低。因此，**0110 是一个局部最大值**。\n- **峰 1010 (f=11.8):** 邻居为 0010 (f=10.2), 1110 (f=11.0), 1000 (f=9.5), 1011 (f=9.7)。所有邻居的适应度都更低。因此，**1010 是一个局部最大值**。\n- **峰 1100 (f=12.0):** 邻居为 0100 (f=8.0), 1000 (f=9.5), 1110 (f=11.0), 1101 (f=10.5)。所有邻居的适应度都更低。因此，**1100 是一个局部最大值**。\n- **峰 1111 (f=12.5):** 邻居为 0111 (f=10.9), 1011 (f=9.7), 1101 (f=10.5), 1110 (f=11.0)。所有邻居的适应度都更低。因此，**1111 是一个局部最大值**（也是全局最大值）。\n\n接下来，我们为空间中的每个基因型（共16个）追踪其根据贪婪爬山动力学（包括字典序决胜规则）的演化路径，以确定它最终到达哪个峰。\n\n**路径追踪：**\n1.  `0000` (7.0) → `0010` (10.2) → `1010` (11.8 - 峰)\n2.  `0001` (7.8) → `0101` (9.0) → `1101` (10.5) → `1111` (12.5 - 峰)\n3.  `0010` (10.2) → `1010` (11.8 - 峰)\n4.  `0011` (9.3) → `0111` (10.9) → `1111` (12.5 - 峰)\n5.  `0100` (8.0) → `1100` (12.0 - 峰)\n6.  `0101` (9.0) → `1101` (10.5) → `1111` (12.5 - 峰)\n7.  `0110` (11.6 - 峰)\n8.  `0111` (10.9) → `1111` (12.5 - 峰)\n9.  `1000` (9.5) → `1100` (12.0 - 峰)\n10. `1001` (9.2) → `1101` (10.5) → `1111` (12.5 - 峰)\n11. `1010` (11.8 - 峰)\n12. `1011` (9.7) → `1111` (12.5 - 峰)\n13. `1100` (12.0 - 峰)\n14. `1101` (10.5) → `1111` (12.5 - 峰)\n15. `1110` (11.0) → `1111` (12.5 - 峰)\n16. `1111` (12.5 - 峰)\n\n**计算吸引盆大小：**\n- **峰 0110 的吸引盆**: {0110}。 大小 = **1**。\n- **峰 1010 的吸引盆**: {0000, 0010, 1010}。 大小 = **3**。\n- **峰 1100 的吸引盆**: {0100, 1000, 1100}。 大小 = **3**。\n- **峰 1111 的吸引盆**: {0001, 0011, 0101, 0111, 1001, 1011, 1101, 1110, 1111}。 大小 = **9**。\n\n（总检查：1 + 3 + 3 + 9 = 16，所有基因型均已计算在内。）\n\n按照峰 $\\{0110, 1010, 1100, 1111\\}$ 的字典序排列，吸引盆的大小分别为 1, 3, 3, 9。因此，答案是包含这些大小的单行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  3  3  9\n\\end{pmatrix}\n}\n$$"
        }
    ]
}