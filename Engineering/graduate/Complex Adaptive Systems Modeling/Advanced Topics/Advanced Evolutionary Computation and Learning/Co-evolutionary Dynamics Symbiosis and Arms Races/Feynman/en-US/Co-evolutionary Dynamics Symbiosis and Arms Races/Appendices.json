{
    "hands_on_practices": [
        {
            "introduction": "To begin our practical exploration of coevolution, we will construct and analyze a foundational mathematical model. This exercise demonstrates how to translate biological assumptions about the costs and benefits of interaction into a dynamical system using the principles of Adaptive Dynamics. By solving for the system's interior fixed point, you will determine the coevolutionary equilibrium, which represents a potential long-term outcome of the symbiotic or antagonistic relationship .",
            "id": "4117882",
            "problem": "Consider two interacting species, labeled $X$ and $Y$, whose quantitative traits $x \\geq 0$ and $y \\geq 0$ represent heritable investment levels into interaction-mediating functions. Assume ecological timescales are fast relative to evolutionary timescales and mutational steps are small, so that the canonical selection-gradient approximation from Adaptive Dynamics (AD) applies: trait change follows $\\dot{x} = \\beta \\frac{\\partial W_x}{\\partial x}$ and $\\dot{y} = \\beta \\frac{\\partial W_y}{\\partial y}$, where $\\beta > 0$ is a scaling constant and $W_x(x,y)$, $W_y(x,y)$ are invasion fitnesses of rare mutant traits in monomorphic resident backgrounds.\n\nConstruct a minimal two-trait model capturing both a mutualistic symbiosis and an antagonistic arms race by letting the individual fitnesses be quadratic with linear cross-interactions:\n$$\nW_x(x,y) = r_x x - c_x x^{2} + \\eta x y, \\quad W_y(x,y) = r_y y - c_y y^{2} + s\\,\\eta x y,\n$$\nwhere $r_x > 0$, $r_y > 0$ are baseline marginal benefits of investment, $c_x > 0$, $c_y > 0$ are convex costs, $\\eta > 0$ is the strength of cross-interaction, and $s \\in \\{+1,-1\\}$ switches regimes: $s=+1$ (symbiosis, both traits mutually increase the other’s marginal fitness) and $s=-1$ (arms race, increasing $x$ decreases $Y$’s marginal fitness and vice versa).\n\nTasks:\n- Starting from the AD selection-gradient principle and the specified $W_x$ and $W_y$, write the explicit dynamical system for $\\dot{x}$ and $\\dot{y}$.\n- Derive the interior fixed point $(x^{*},y^{*})$ with $x^{*} > 0$ and $y^{*} > 0$ in closed form as a function of the parameters $(r_x,r_y,c_x,c_y,\\eta,s)$.\n- State parameter conditions under which this fixed point exists in the interior of the feasible trait space and is biologically meaningful (positivity and local attraction under the linearized dynamics).\n\nExpress your final answer as the closed-form vector $\\begin{pmatrix} x^{*} & y^{*} \\end{pmatrix}$ in terms of $(r_x,r_y,c_x,c_y,\\eta,s)$. No rounding is required.",
            "solution": "The problem statement has been validated and is determined to be a scientifically grounded, well-posed, and objective problem in the field of adaptive dynamics.\n\nThe problem asks for the derivation and analysis of a co-evolutionary system for two interacting species, $X$ and $Y$, with traits $x$ and $y$ respectively. The evolutionary dynamics are governed by the selection-gradient approximation from Adaptive Dynamics (AD).\n\nFirst, we address the task of writing the explicit dynamical system for the traits $x$ and $y$. The dynamics are given by $\\dot{x} = \\beta \\frac{\\partial W_x}{\\partial x}$ and $\\dot{y} = \\beta \\frac{\\partial W_y}{\\partial y}$, where $\\beta > 0$ is a scaling constant. The invasion fitness functions are provided as:\n$$\nW_x(x,y) = r_x x - c_x x^{2} + \\eta x y\n$$\n$$\nW_y(x,y) = r_y y - c_y y^{2} + s\\,\\eta x y\n$$\nThe selection gradients are the partial derivatives of the fitness functions with respect to their own traits:\n$$\n\\frac{\\partial W_x}{\\partial x} = \\frac{\\partial}{\\partial x}(r_x x - c_x x^{2} + \\eta x y) = r_x - 2c_x x + \\eta y\n$$\n$$\n\\frac{\\partial W_y}{\\partial y} = \\frac{\\partial}{\\partial y}(r_y y - c_y y^{2} + s\\,\\eta x y) = r_y - 2c_y y + s\\,\\eta x\n$$\nSubstituting these gradients into the AD equations yields the explicit dynamical system:\n$$\n\\dot{x} = \\beta (r_x - 2c_x x + \\eta y)\n$$\n$$\n\\dot{y} = \\beta (r_y - 2c_y y + s\\,\\eta x)\n$$\n\nNext, we derive the interior fixed point $(x^{*}, y^{*})$, which is a singular strategy where the selection gradients are zero. This requires solving $\\dot{x} = 0$ and $\\dot{y} = 0$ for $x > 0$ and $y > 0$. Since $\\beta > 0$, this is equivalent to solving the system:\n$$\nr_x - 2c_x x^{*} + \\eta y^{*} = 0\n$$\n$$\nr_y - 2c_y y^{*} + s\\,\\eta x^{*} = 0\n$$\nThis is a system of two linear equations for $x^{*}$ and $y^{*}$:\n$$\n2c_x x^{*} - \\eta y^{*} = r_x\n$$\n$$\n-s\\,\\eta x^{*} + 2c_y y^{*} = r_y\n$$\nWe can solve this system using various methods, such as Cramer's rule. The determinant of the coefficient matrix is:\n$$\nD = \\det \\begin{pmatrix} 2c_x & -\\eta \\\\ -s\\eta & 2c_y \\end{pmatrix} = (2c_x)(2c_y) - (-\\eta)(-s\\eta) = 4c_x c_y - s\\eta^2\n$$\nFor a unique solution to exist, we require $D \\neq 0$. The solutions for $x^*$ and $y^*$ are:\n$$\nx^{*} = \\frac{\\det \\begin{pmatrix} r_x & -\\eta \\\\ r_y & 2c_y \\end{pmatrix}}{D} = \\frac{r_x(2c_y) - (-\\eta)r_y}{4c_x c_y - s\\eta^2} = \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^2}\n$$\n$$\ny^{*} = \\frac{\\det \\begin{pmatrix} 2c_x & r_x \\\\ -s\\eta & r_y \\end{pmatrix}}{D} = \\frac{(2c_x)r_y - r_x(-s\\eta)}{4c_x c_y - s\\eta^2} = \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^2}\n$$\nThis provides the closed-form expression for the interior fixed point $(x^{*}, y^{*})$.\n\nFinally, we state the conditions for this fixed point to be biologically meaningful, which requires positivity ($x^*>0, y^*>0$) and local stability.\n\n1.  **Positivity ($x^* > 0, y^* > 0$)**:\n    All parameters $r_x, r_y, c_x, c_y, \\eta$ are strictly positive.\n    The numerator of $x^*$, $2c_y r_x + \\eta r_y$, is always positive.\n    The numerator of $y^*$, $2c_x r_y + s\\eta r_x$, depends on $s$:\n    - If $s=+1$ (symbiosis), the numerator $2c_x r_y + \\eta r_x$ is always positive.\n    - If $s=-1$ (arms race), the numerator is $2c_x r_y - \\eta r_x$. For $y^* > 0$, we require $2c_x r_y > \\eta r_x$.\n    The denominator is $D = 4c_x c_y - s\\eta^2$.\n    - If $s=+1$, $D = 4c_x c_y - \\eta^2$. For both $x^*$ and $y^*$ to be positive, given their positive numerators, we must have $D>0$, which means $4c_x c_y > \\eta^2$.\n    - If $s=-1$, $D = 4c_x c_y + \\eta^2$, which is always positive. So for $x^*>0$ and $y^*>0$, we only need the numerator of $y^*$ to be positive, i.e., $2c_x r_y > \\eta r_x$.\n\n2.  **Local Stability**:\n    The stability of the fixed point is determined by the eigenvalues of the Jacobian matrix of the dynamical system, evaluated at the fixed point.\n    $$\n    J = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\beta \\begin{pmatrix} -2c_x & \\eta \\\\ s\\eta & -2c_y \\end{pmatrix}\n    $$\n    Since the dynamics are linear, the Jacobian is constant. For stability, the real parts of all eigenvalues of $J$ must be negative. Given $\\beta > 0$, this is equivalent to the matrix $M=J/\\beta$ having eigenvalues with negative real parts. The Routh-Hurwitz stability criteria for a $2 \\times 2$ matrix are $\\text{Tr}(M) < 0$ and $\\det(M) > 0$.\n    - Trace: $\\text{Tr}(M) = -2c_x - 2c_y = -2(c_x + c_y)$. Since $c_x > 0$ and $c_y > 0$, the trace is always negative. This condition is always met.\n    - Determinant: $\\det(M) = (-2c_x)(-2c_y) - (\\eta)(s\\eta) = 4c_x c_y - s\\eta^2$. The stability condition is thus $4c_x c_y - s\\eta^2 > 0$.\n\n3.  **Summary of Conditions**:\n    - For $s=+1$ (symbiosis), the condition for positivity ($4c_x c_y > \\eta^2$) is identical to the condition for stability. Thus, for a biologically meaningful interior fixed point, we require $4c_x c_y > \\eta^2$. This implies that the product of the stabilizing self-regulatory costs must exceed the strength of the potentially destabilizing mutualistic feedback.\n    - For $s=-1$ (arms race), the stability condition $4c_x c_y + \\eta^2 > 0$ is always satisfied for positive parameters. The positivity condition is $2c_x r_y > \\eta r_x$. Thus, for a biologically meaningful interior fixed point, this single condition on the parameters must hold. It ensures that species $Y$ is not driven to extinction by the antagonistic pressure from species $X$.\n\nThe final answer requested is the closed-form vector for the fixed point.\n$$\n\\begin{pmatrix} x^{*} & y^{*} \\end{pmatrix} = \\begin{pmatrix} \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^{2}} & \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^{2}} \\end{pmatrix}\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^{2}} & \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^{2}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the concept of an equilibrium, we now delve deeper into its stability properties, which determine the ultimate evolutionary outcome. This practice introduces the critical distinction between convergence stability—whether a population will evolve towards the equilibrium—and evolutionary stability, whether the equilibrium strategy is uninvadable once established. Calculating these two distinct stability metrics for a given system  is a key skill for predicting coevolutionary dynamics accurately.",
            "id": "4117842",
            "problem": "Consider a two-species system in the framework of Adaptive Dynamics (AD), where species $X$ and species $Y$ co-evolve through a mixture of mutualistic facilitation (symbiosis) and antagonistic mismatch costs (arms race). Let the resident trait values be $(x,y)$ with $x \\geq 0$ and $y \\geq 0$, and let the mutant of species $X$ have trait $x_m$. The invasion fitness of the mutant of species $X$ in the resident environment $(x,y)$ is defined by\n$$\nW_x(x_m; x,y) \\equiv a\\, x_m y \\;-\\; \\kappa\\, (x_m - y)^2 \\;-\\; \\frac{b}{2}\\, x_m^2 \\;-\\; \\frac{d}{4}\\, x_m^4,\n$$\nwhere $a>0$ captures facilitative gain proportional to the partner’s trait, $\\kappa>0$ captures the arms race mismatch cost, and $b>0$, $d>0$ capture convex investment costs. Analogously, the invasion fitness of a mutant of species $Y$ with trait $y_m$ in the resident environment $(x,y)$ is\n$$\nW_y(y_m; x,y) \\equiv a\\, y_m x \\;-\\; \\kappa\\, (y_m - x)^2 \\;-\\; \\frac{b}{2}\\, y_m^2 \\;-\\; \\frac{d}{4}\\, y_m^4.\n$$\nThe selection gradients are defined by the standard Adaptive Dynamics principle as\n$$\ng_x(x,y) \\equiv \\left.\\frac{\\partial W_x}{\\partial x_m}\\right|_{x_m=x}, \n\\qquad\ng_y(x,y) \\equiv \\left.\\frac{\\partial W_y}{\\partial y_m}\\right|_{y_m=y}.\n$$\nA co-evolutionary singular point $(x^*, y^*)$ satisfies $g_x(x^*,y^*)=0$ and $g_y(x^*,y^*)=0$. Around $(x^*,y^*)$, consider the Taylor expansions of $g_x$ in the resident trait $x$ and of $W_x$ in the mutant trait $x_m$, and use these expansions to extract the local coefficients that quantify convergence stability and evolutionary stability, respectively.\n\nGiven parameter values $a=4$, $\\kappa=\\frac{1}{2}$, $b=1$, and $d=3$, perform the following:\n\n1. Derive the nontrivial symmetric co-evolutionary singular point $(x^*,y^*)$ under the condition $x^*=y^*>0$.\n2. Apply Taylor expansion around $(x^*,y^*)$ to compute the convergence-stability coefficient $\\left.\\frac{\\partial g_x}{\\partial x}\\right|_{(x^*,y^*)}$.\n3. Apply Taylor expansion around $(x^*,y^*)$ to compute the evolutionary-stability curvature $\\left.\\frac{\\partial^2 W_x}{\\partial x_m^2}\\right|_{x_m=x^*,\\,(x,y)=(x^*,y^*)}$.\n\nProvide your final answer as a single row matrix containing these two quantities in the order $\\left(\\left.\\frac{\\partial g_x}{\\partial x}\\right|_{(x^*,y^*)}, \\left.\\frac{\\partial^2 W_x}{\\partial x_m^2}\\right|_{x_m=x^*,\\,(x,y)=(x^*,y^*)}\\right)$. No rounding is required, and no units are involved. Express your numbers exactly.",
            "solution": "The problem asks for the calculation of a nontrivial symmetric co-evolutionary singular point $(x^*, y^*)$ and two associated stability coefficients for a two-species system described by the framework of Adaptive Dynamics.\n\nFirst, we validate the problem statement.\nThe givens are:\nInvasion fitness of a mutant of species $X$ with trait $x_m$ in a resident environment $(x,y)$:\n$$W_x(x_m; x,y) = a\\, x_m y - \\kappa\\, (x_m - y)^2 - \\frac{b}{2}\\, x_m^2 - \\frac{d}{4}\\, x_m^4$$\nInvasion fitness of a mutant of species $Y$ with trait $y_m$ in a resident environment $(x,y)$:\n$$W_y(y_m; x,y) = a\\, y_m x - \\kappa\\, (y_m - x)^2 - \\frac{b}{2}\\, y_m^2 - \\frac{d}{4}\\, y_m^4$$\nSelection gradients:\n$$g_x(x,y) = \\left.\\frac{\\partial W_x}{\\partial x_m}\\right|_{x_m=x}, \\qquad g_y(x,y) = \\left.\\frac{\\partial W_y}{\\partial y_m}\\right|_{y_m=y}$$\nA co-evolutionary singular point $(x^*, y^*)$ satisfies $g_x(x^*,y^*)=0$ and $g_y(x^*,y^*)=0$.\nParameter values: $a=4$, $\\kappa=\\frac{1}{2}$, $b=1$, $d=3$.\nCondition for the singular point: $x^*=y^*>0$.\nThe tasks are to find $(x^*, y^*)$ and to compute the convergence-stability coefficient $\\left.\\frac{\\partial g_x}{\\partial x}\\right|_{(x^*,y^*)}$ and the evolutionary-stability curvature $\\left.\\frac{\\partial^2 W_x}{\\partial x_m^2}\\right|_{x_m=x^*,\\,(x,y)=(x^*,y^*)}$.\n\nThe problem is scientifically grounded in the established theory of Adaptive Dynamics, is mathematically well-posed, objective, and contains all necessary information. It is therefore a valid problem.\n\nWe proceed with the solution.\n\n**1. Derivation of the co-evolutionary singular point $(x^*, y^*)$**\n\nFirst, we compute the selection gradient for species $X$, $g_x(x,y)$. We differentiate $W_x(x_m; x,y)$ with respect to the mutant trait $x_m$:\n$$ \\frac{\\partial W_x}{\\partial x_m} = a y - 2\\kappa (x_m - y) - b x_m - d x_m^3 $$\nThe selection gradient is obtained by setting the mutant trait equal to the resident trait, $x_m=x$:\n$$ g_x(x,y) = \\left.\\frac{\\partial W_x}{\\partial x_m}\\right|_{x_m=x} = a y - 2\\kappa (x - y) - b x - d x^3 $$\nDue to the symmetry of the fitness functions, the selection gradient for species $Y$, $g_y(x,y)$, is obtained by swapping $x$ and $y$:\n$$ g_y(x,y) = a x - 2\\kappa (y - x) - b y - d y^3 $$\nA co-evolutionary singular point $(x^*, y^*)$ is a point where both selection gradients are zero: $g_x(x^*,y^*)=0$ and $g_y(x^*,y^*)=0$. We are looking for a nontrivial symmetric singular point, which means we impose the condition $x^*=y^*=z$ for some $z>0$.\nSubstituting $x=y=z$ into the equation for $g_x(x,y)=0$:\n$$ g_x(z,z) = a z - 2\\kappa (z - z) - b z - d z^3 = 0 $$\n$$ a z - b z - d z^3 = 0 $$\n$$ z (a - b - d z^2) = 0 $$\nSince we are looking for a nontrivial solution where $z>0$, we can divide by $z$:\n$$ a - b - d z^2 = 0 $$\n$$ d z^2 = a - b $$\n$$ z^2 = \\frac{a - b}{d} $$\n$$ z = \\sqrt{\\frac{a - b}{d}} $$\nWe must verify that $a-b>0$ for a real, positive solution to exist. Given $a=4$ and $b=1$, this condition is satisfied.\nSubstituting the parameter values $a=4$, $b=1$, and $d=3$:\n$$ z^2 = \\frac{4 - 1}{3} = \\frac{3}{3} = 1 $$\n$$ z = \\sqrt{1} = 1 $$\nThus, the nontrivial symmetric co-evolutionary singular point is $(x^*, y^*) = (1, 1)$.\n\n**2. Calculation of the convergence-stability coefficient**\n\nThe convergence-stability coefficient is given by the partial derivative of the selection gradient $g_x(x,y)$ with respect to the resident trait $x$, evaluated at the singular point $(x^*, y^*)$.\nThe expression for $g_x(x,y)$ is:\n$$ g_x(x,y) = a y - 2\\kappa x + 2\\kappa y - b x - d x^3 = (a+2\\kappa) y - (b+2\\kappa) x - d x^3 $$\nWe differentiate this with respect to $x$:\n$$ \\frac{\\partial g_x}{\\partial x} = -(b+2\\kappa) - 3 d x^2 $$\nNow we evaluate this derivative at the singular point $(x^*, y^*) = (1, 1)$, which means we set $x=1$:\n$$ \\left.\\frac{\\partial g_x}{\\partial x}\\right|_{(x^*,y^*)} = -(b+2\\kappa) - 3 d (1)^2 = -b - 2\\kappa - 3d $$\nSubstituting the parameter values $b=1$, $\\kappa=\\frac{1}{2}$, and $d=3$:\n$$ \\left.\\frac{\\partial g_x}{\\partial x}\\right|_{(x^*,y^*)} = -1 - 2\\left(\\frac{1}{2}\\right) - 3(3) = -1 - 1 - 9 = -11 $$\n\n**3. Calculation of the evolutionary-stability curvature**\n\nThe evolutionary-stability curvature is given by the second partial derivative of the invasion fitness $W_x(x_m; x,y)$ with respect to the mutant trait $x_m$, evaluated at $x_m=x^*$ and $(x,y)=(x^*,y^*)$.\nThe first derivative with respect to $x_m$ is:\n$$ \\frac{\\partial W_x}{\\partial x_m} = a y - 2\\kappa (x_m - y) - b x_m - d x_m^3 $$\nThe second derivative with respect to $x_m$ is:\n$$ \\frac{\\partial^2 W_x}{\\partial x_m^2} = -2\\kappa - b - 3 d x_m^2 $$\nThis expression needs to be evaluated at $x_m=x^*=1$ (the resident traits $(x,y)$ do not appear in this expression, so their values at $(x^*,y^*)$ are implicitly used if needed, but here they are not).\n$$ \\left.\\frac{\\partial^2 W_x}{\\partial x_m^2}\\right|_{x_m=x^*,(x,y)=(x^*,y^*)} = -2\\kappa - b - 3 d (1)^2 = -b - 2\\kappa - 3d $$\nSubstituting the parameter values $b=1$, $\\kappa=\\frac{1}{2}$, and $d=3$:\n$$ \\left.\\frac{\\partial^2 W_x}{\\partial x_m^2}\\right|_{x_m=x^*,(x,y)=(x^*,y^*)} = -1 - 2\\left(\\frac{1}{2}\\right) - 3(3) = -1 - 1 - 9 = -11 $$\nThe evolutionary stability curvature is $-11$. A negative value indicates that the singular point is an Evolutionary Stable Strategy (ESS).\n\nThe two quantities to be reported are the convergence-stability coefficient and the evolutionary-stability curvature, which are $-11$ and $-11$ respectively.\nThe final answer is presented as a row matrix containing these two values.",
            "answer": "$$\\boxed{\\begin{pmatrix} -11 & -11 \\end{pmatrix}}$$"
        },
        {
            "introduction": "To bring these theoretical concepts to life, we will now simulate the generation-by-generation process of coevolution computationally. Using the multivariate breeder’s equation, this exercise allows you to observe the dynamic trajectories of traits under mutualistic and antagonistic selection pressures . This hands-on simulation highlights the crucial role of the genetic variance-covariance matrix ($\\mathbf{G}$) in shaping the path and pace of evolution, providing a tangible link between quantitative genetics and long-term coevolutionary patterns.",
            "id": "4117838",
            "problem": "Consider a two-species co-evolutionary system in which each species has a two-dimensional quantitative trait vector. Denote the resident traits of species A by $\\mathbf{z}_A \\in \\mathbb{R}^2$ and of species B by $\\mathbf{z}_B \\in \\mathbb{R}^2$. Assume additive genetic variance-covariance within each species summarized by a symmetric, positive semidefinite matrix $\\mathbf{G}_A \\in \\mathbb{R}^{2 \\times 2}$ and $\\mathbf{G}_B \\in \\mathbb{R}^{2 \\times 2}$, respectively. The per-generation response to selection follows the multivariate breeder’s framework, where the response is proportional to the selection gradient evaluated at the current mean traits and scaled by the respective additive genetic variance-covariance matrix. You will model co-evolutionary dynamics by iterating discrete generations, updating $\\mathbf{z}_A$ and $\\mathbf{z}_B$ in each generation using this framework.\n\nYou are given two classes of ecological interaction functions that determine the selection gradients as functions of the current traits, capturing symbiosis and arms race dynamics. In both classes, all functions act component-wise on the trait vectors (that is, operations such as $\\tanh$ apply to each component of the vector independently).\n\nMutualistic symbiosis class. The selection gradients for species A and B are defined as\n$$\n\\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big),\n$$\n$$\n\\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big),\n$$\nwhere $\\boldsymbol{\\alpha}_A,\\boldsymbol{\\alpha}_B \\in \\mathbb{R}^2_{\\ge 0}$ encode stabilizing selection strengths toward optima $\\boldsymbol{\\theta}_A,\\boldsymbol{\\theta}_B \\in \\mathbb{R}^2$, $\\boldsymbol{\\gamma}_A,\\boldsymbol{\\gamma}_B \\in \\mathbb{R}^2_{\\ge 0}$ encode the mutualistic coupling strengths, and $\\kappa \\in \\mathbb{R}_{>0}$ scales the steepness of the saturation via the hyperbolic tangent function.\n\nAntagonistic arms race class. The selection gradients for species A and B are defined as\n$$\n\\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big),\n$$\n$$\n\\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big),\n$$\nwhere $\\boldsymbol{\\alpha}_A,\\boldsymbol{\\alpha}_B \\in \\mathbb{R}^2_{\\ge 0}$ encode stabilizing selection strengths toward optima $\\boldsymbol{\\theta}_A,\\boldsymbol{\\theta}_B \\in \\mathbb{R}^2$, and $\\boldsymbol{\\rho}_A,\\boldsymbol{\\rho}_B \\in \\mathbb{R}^2_{\\ge 0}$ encode antagonistic coupling strengths.\n\nFor all cases below, iterate discrete generations for a specified number of steps using the multivariate breeder’s framework described above. In each generation, compute the selection gradients $\\mathbf{s}_A$ and $\\mathbf{s}_B$ from the current traits and update the trait means of the two species accordingly.\n\nYour program must implement the above dynamics and compute the final trait vectors after a fixed number of generations for the following test suite. All numerical values in matrices and vectors are real numbers.\n\nTest case 1 (mutualism, coupled but stable). Use\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.20 & 0.03 \\\\ 0.03 & 0.10 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.15 & 0.00 \\\\ 0.00 & 0.12 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.05 \\\\ 0.08 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_A = \\begin{bmatrix} 0.04 \\\\ 0.03 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.5 \\\\ -0.5 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.06 \\\\ 0.06 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_B = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.5 \\\\ -0.5 \\end{bmatrix}$.\n- $\\kappa = 0.7$.\n- Initial conditions: $\\mathbf{z}_A^{(0)} = \\begin{bmatrix} -1.0 \\\\ 1.0 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} 1.0 \\\\ -1.0 \\end{bmatrix}$.\n- Number of generations: $T = 300$.\n\nTest case 2 (arms race with stabilizing selection). Use\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.18 & 0.02 \\\\ 0.02 & 0.09 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.16 & 0.01 \\\\ 0.01 & 0.11 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.04 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\rho}_A = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.04 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\rho}_B = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$.\n- $\\kappa = 0.8$.\n- Initial conditions: $\\mathbf{z}_A^{(0)} = \\begin{bmatrix} 0.2 \\\\ -0.2 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.2 \\end{bmatrix}$.\n- Number of generations: $T = 300$.\n\nTest case 3 (mutualism with a singular genetic covariance matrix for species A). Use\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.10 & 0.00 \\\\ 0.00 & 0.00 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.14 & 0.00 \\\\ 0.00 & 0.10 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.05 \\\\ 0.08 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_A = \\begin{bmatrix} 0.03 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$.\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.06 \\\\ 0.06 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_B = \\begin{bmatrix} 0.04 \\\\ 0.03 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$.\n- $\\kappa = 0.7$.\n- Initial conditions: $\\mathbf{z}_A^{(0)} = \\begin{bmatrix} 0.3 \\\\ -0.7 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.9 \\end{bmatrix}$.\n- Number of generations: $T = 300$.\n\nImplementation requirements.\n- Iterate exactly $T$ discrete generations for each test case, updating $\\mathbf{z}_A$ and $\\mathbf{z}_B$ in-place each generation based on the multivariate breeder’s framework and the specified selection gradient functions.\n- Use the hyperbolic tangent function component-wise, that is, if $\\mathbf{u} \\in \\mathbb{R}^2$, then $\\tanh(\\mathbf{u})$ returns $\\begin{bmatrix} \\tanh(u_1) \\\\ \\tanh(u_2) \\end{bmatrix}$.\n- After completing the $T$ updates for a test case, return the final values in the order $[z_{A,1}^{(T)}, z_{A,2}^{(T)}, z_{B,1}^{(T)}, z_{B,2}^{(T)}]$ rounded to six decimal places.\n\nFinal output format.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a bracketed, comma-separated list of four floating-point numbers. For example, an output with three test cases must look like $\\texttt{[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]}$ with each $a_i,b_i,c_i$ rounded to six decimal places.",
            "solution": "The problem requires the simulation of a two-species co-evolutionary system governed by the multivariate breeder's equation. The evolution of the two-dimensional mean trait vectors, $\\mathbf{z}_A$ for species A and $\\mathbf{z}_B$ for species B, is modeled over discrete generations.\n\nThe core principle is the multivariate breeder's framework, which states that the evolutionary response (change in mean trait) in one generation is the product of the additive genetic variance-covariance matrix ($\\mathbf{G}$) and the selection gradient vector ($\\mathbf{s}$). The update rule for the trait vector $\\mathbf{z}$ from generation $t$ to $t+1$ is:\n$$\n\\mathbf{z}^{(t+1)} = \\mathbf{z}^{(t)} + \\Delta \\mathbf{z}^{(t)}\n$$\nwhere the change $\\Delta \\mathbf{z}^{(t)}$ is given by:\n$$\n\\Delta \\mathbf{z}^{(t)} = \\mathbf{G} \\, \\mathbf{s}(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\nThis leads to the specific update equations for each species:\n$$\n\\mathbf{z}_A^{(t+1)} = \\mathbf{z}_A^{(t)} + \\mathbf{G}_A \\, \\mathbf{s}_A(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\n$$\n\\mathbf{z}_B^{(t+1)} = \\mathbf{z}_B^{(t)} + \\mathbf{G}_B \\, \\mathbf{s}_B(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\nHere, $\\mathbf{G}_A$ and $\\mathbf{G}_B$ are the given $2 \\times 2$ genetic variance-covariance matrices, and $\\mathbf{s}_A$ and $\\mathbf{s}_B$ are the selection gradients, which depend on the nature of the ecological interaction between the species. The term $\\operatorname{diag}(\\mathbf{v})\\mathbf{u}$ in the selection gradient equations corresponds to the element-wise (Hadamard) product of the vectors $\\mathbf{v}$ and $\\mathbf{u}$.\n\nThe problem defines two classes of interactions:\n\n1.  **Mutualistic Symbiosis**: The selection gradients are given by:\n    $$\n    \\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big)\n    $$\n    $$\n    \\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big)\n    $$\n    The first term represents stabilizing selection pulling each species' trait towards its own optimum $\\boldsymbol{\\theta}$. The second term represents the mutualistic benefit, where each species' fitness (and thus selection) is positively influenced by the other species' traits, saturating due to the $\\tanh$ function. This interaction pushes the traits of the two species towards each other.\n\n2.  **Antagonistic Arms Race**: The selection gradients are given by:\n    $$\n    \\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big)\n    $$\n    $$\n    \\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big)\n    $$\n    In this case, the interaction term for species A, $\\tanh(\\kappa(\\mathbf{z}_A - \\mathbf{z}_B))$, pushes its trait $\\mathbf{z}_A$ away from $\\mathbf{z}_B$. Symmetrically, species B is selected to move its trait $\\mathbf{z}_B$ away from $\\mathbf{z}_A$. This creates a chase dynamic, characteristic of an arms race.\n\nThe algorithmic procedure for solving each test case is as follows:\n1.  Initialize the trait vectors $\\mathbf{z}_A$ and $\\mathbf{z}_B$ with their given starting values, $\\mathbf{z}_A^{(0)}$ and $\\mathbf{z}_B^{(0)}$.\n2.  Iterate for $t$ from $0$ to $T-1$, where $T$ is the specified number of generations. In each iteration:\n    a.  Determine the interaction type (mutualism or arms race) for the current test case.\n    b.  Calculate the selection gradient vectors $\\mathbf{s}_A$ and $\\mathbf{s}_B$ using the current trait vectors $\\mathbf{z}_A^{(t)}$ and $\\mathbf{z}_B^{(t)}$ and the corresponding equations. All vector operations like subtraction and the $\\tanh$ function are performed element-wise.\n    c.  Compute the evolutionary response for each species by performing matrix-vector multiplication: $\\Delta \\mathbf{z}_A^{(t)} = \\mathbf{G}_A \\mathbf{s}_A$ and $\\Delta \\mathbf{z}_B^{(t)} = \\mathbf{G}_B \\mathbf{s}_B$.\n    d.  Update the trait vectors for the next generation: $\\mathbf{z}_A^{(t+1)} = \\mathbf{z}_A^{(t)} + \\Delta \\mathbf{z}_A^{(t)}$ and $\\mathbf{z}_B^{(t+1)} = \\mathbf{z}_B^{(t)} + \\Delta \\mathbf{z}_B^{(t)}$.\n3.  After $T$ generations, the final trait vectors are $\\mathbf{z}_A^{(T)}$ and $\\mathbf{z}_B^{(T)}$.\n4.  Concatenate the components of the final vectors into a single list $[z_{A,1}^{(T)}, z_{A,2}^{(T)}, z_{B,1}^{(T)}, z_{B,2}^{(T)}]$ and round each value to six decimal places.\n\nIn Test Case 3, the genetic variance-covariance matrix for species A, $\\mathbf{G}_A = \\begin{bmatrix} 0.10 & 0.00 \\\\ 0.00 & 0.00 \\end{bmatrix}$, is singular. The second row of $\\mathbf{G}_A$ is all zeros, which implies that the change in the second component of species A's trait vector, $\\Delta z_{A,2}$, will be zero in every generation regardless of the selection gradient:\n$$\n\\Delta z_{A,2}^{(t)} = [\\mathbf{G}_A \\mathbf{s}_A]_2 = G_{A,21}s_{A,1} + G_{A,22}s_{A,2} = (0.00)s_{A,1} + (0.00)s_{A,2} = 0\n$$\nConsequently, the second trait of species A, $z_{A,2}$, will remain constant at its initial value throughout the simulation. The first trait, $z_{A,1}$, will evolve as normal. This is a valid scenario representing a lack of heritable variation for a specific trait. The general algorithm handles this case correctly without modification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the co-evolutionary dynamics of a two-species system\n    based on the multivariate breeder's equation for three test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (mutualism)\n        {\n            \"type\": \"mutualism\",\n            \"G_A\": np.array([[0.20, 0.03], [0.03, 0.10]]),\n            \"G_B\": np.array([[0.15, 0.00], [0.00, 0.12]]),\n            \"alpha_A\": np.array([0.05, 0.08]),\n            \"gamma_A\": np.array([0.04, 0.03]),\n            \"theta_A\": np.array([0.5, -0.5]),\n            \"alpha_B\": np.array([0.06, 0.06]),\n            \"gamma_B\": np.array([0.05, 0.02]),\n            \"theta_B\": np.array([0.5, -0.5]),\n            \"rho_A\": None,\n            \"rho_B\": None,\n            \"kappa\": 0.7,\n            \"z_A_0\": np.array([-1.0, 1.0]),\n            \"z_B_0\": np.array([1.0, -1.0]),\n            \"T\": 300,\n        },\n        # Test case 2 (arms race)\n        {\n            \"type\": \"arms_race\",\n            \"G_A\": np.array([[0.18, 0.02], [0.02, 0.09]]),\n            \"G_B\": np.array([[0.16, 0.01], [0.01, 0.11]]),\n            \"alpha_A\": np.array([0.04, 0.04]),\n            \"gamma_A\": None,\n            \"theta_A\": np.array([0.0, 0.0]),\n            \"alpha_B\": np.array([0.04, 0.04]),\n            \"gamma_B\": None,\n            \"theta_B\": np.array([0.0, 0.0]),\n            \"rho_A\": np.array([0.05, 0.02]),\n            \"rho_B\": np.array([0.05, 0.02]),\n            \"kappa\": 0.8,\n            \"z_A_0\": np.array([0.2, -0.2]),\n            \"z_B_0\": np.array([-0.2, 0.2]),\n            \"T\": 300,\n        },\n        # Test case 3 (mutualism with singular G_A)\n        {\n            \"type\": \"mutualism\",\n            \"G_A\": np.array([[0.10, 0.00], [0.00, 0.00]]),\n            \"G_B\": np.array([[0.14, 0.00], [0.00, 0.10]]),\n            \"alpha_A\": np.array([0.05, 0.08]),\n            \"gamma_A\": np.array([0.03, 0.04]),\n            \"theta_A\": np.array([0.0, 0.0]),\n            \"alpha_B\": np.array([0.06, 0.06]),\n            \"gamma_B\": np.array([0.04, 0.03]),\n            \"theta_B\": np.array([0.0, 0.0]),\n            \"rho_A\": None,\n            \"rho_B\": None,\n            \"kappa\": 0.7,\n            \"z_A_0\": np.array([0.3, -0.7]),\n            \"z_B_0\": np.array([-0.2, 0.9]),\n            \"T\": 300,\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        z_A = case[\"z_A_0\"]\n        z_B = case[\"z_B_0\"]\n        \n        G_A = case[\"G_A\"]\n        G_B = case[\"G_B\"]\n        alpha_A = case[\"alpha_A\"]\n        theta_A = case[\"theta_A\"]\n        alpha_B = case[\"alpha_B\"]\n        theta_B = case[\"theta_B\"]\n        kappa = case[\"kappa\"]\n        T = case[\"T\"]\n\n        for _ in range(T):\n            if case[\"type\"] == \"mutualism\":\n                gamma_A = case[\"gamma_A\"]\n                gamma_B = case[\"gamma_B\"]\n                # Calculate selection gradients for mutualism\n                s_A = -alpha_A * (z_A - theta_A) + gamma_A * np.tanh(kappa * (z_B - z_A))\n                s_B = -alpha_B * (z_B - theta_B) + gamma_B * np.tanh(kappa * (z_A - z_B))\n            \n            elif case[\"type\"] == \"arms_race\":\n                rho_A = case[\"rho_A\"]\n                rho_B = case[\"rho_B\"]\n                # Calculate selection gradients for arms race\n                s_A = -alpha_A * (z_A - theta_A) + rho_A * np.tanh(kappa * (z_A - z_B))\n                s_B = -alpha_B * (z_B - theta_B) + rho_B * np.tanh(kappa * (z_B - z_A))\n\n            # Update traits using matrix-vector product\n            delta_z_A = G_A @ s_A\n            delta_z_B = G_B @ s_B\n            \n            z_A = z_A + delta_z_A\n            z_B = z_B + delta_z_B\n\n        # Collect final results and round\n        final_traits = np.concatenate((z_A, z_B))\n        all_results.append(final_traits)\n\n    # Format the final output string\n    # E.g., [[a1,a2,a3,a4],[b1,b2,b3,b4],[c1,c2,c3,c4]]\n    results_as_str_lists = []\n    for res_vec in all_results:\n        # Format each number to 6 decimal places and join into a sublist string\n        sublist_str = '[' + ','.join([f'{x:.6f}' for x in res_vec]) + ']'\n        results_as_str_lists.append(sublist_str)\n    \n    final_output = '[' + ','.join(results_as_str_lists) + ']'\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}