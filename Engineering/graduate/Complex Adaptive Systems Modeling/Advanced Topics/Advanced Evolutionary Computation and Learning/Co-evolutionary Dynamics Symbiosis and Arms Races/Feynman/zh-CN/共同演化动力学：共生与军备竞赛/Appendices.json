{
    "hands_on_practices": [
        {
            "introduction": "在研究共演化动力学时，首要任务是确定系统可能达到的长期结果，即演化均衡点。本练习将构建一个基础模型，用以探索自我限制（成本）与物种间相互作用（互利共生或对抗性军备竞赛）之间的平衡如何决定共演化均衡的存在性与稳定性。通过分析这个简洁的二次型适应度模型 ，您将掌握分析更复杂系统所必需的核心技能。",
            "id": "4117882",
            "problem": "考虑两个相互作用的物种，标记为$X$和$Y$，其数量性状$x \\geq 0$和$y \\geq 0$代表了对相互作用介导功能的可遗传投入水平。假设生态时间尺度相对于演化时间尺度要快，且突变步长很小，因此自适应动力学（AD）中的经典选择梯度近似适用：性状变化遵循 $\\dot{x} = \\beta \\frac{\\partial W_x}{\\partial x}$ 和 $\\dot{y} = \\beta \\frac{\\partial W_y}{\\partial y}$，其中 $\\beta > 0$ 是一个缩放常数，$W_x(x,y)$ 和 $W_y(x,y)$ 是稀有突变性状在单态定居种群背景下的入侵适应度。\n\n通过令个体适应度为具有线性交叉相互作用的二次函数，构建一个能够同时捕捉互利共生和对抗性军备竞赛的最小双性状模型：\n$$\nW_x(x,y) = r_x x - c_x x^{2} + \\eta x y, \\quad W_y(x,y) = r_y y - c_y y^{2} + s\\,\\eta x y,\n$$\n其中 $r_x > 0$，$r_y > 0$ 是投入的基线边际收益，$c_x > 0$，$c_y > 0$ 是凸成本，$\\eta > 0$ 是交叉相互作用的强度，$s \\in \\{+1,-1\\}$ 用于切换模式：$s=+1$（共生，两种性状相互增加对方的边际适应度），$s=-1$（军备竞赛，增加 $x$ 会降低 $Y$ 的边际适应度，反之亦然）。\n\n任务：\n- 从AD选择梯度原理和给定的 $W_x$ 和 $W_y$ 出发，写出关于 $\\dot{x}$ 和 $\\dot{y}$ 的显式动力系统。\n- 以参数 $(r_x,r_y,c_x,c_y,\\eta,s)$ 的函数形式，推导出满足 $x^{*} > 0$ 和 $y^{*} > 0$ 的内部不动点 $(x^{*},y^{*})$ 的闭合形式。\n- 陈述该不动点存在于可行性状空间的内部且具有生物学意义（在线性化动力学下具有正性和局部吸引性）的参数条件。\n\n将您的最终答案表示为由 $(r_x,r_y,c_x,c_y,\\eta,s)$ 构成的闭合形式向量 $\\begin{pmatrix} x^{*}  y^{*} \\end{pmatrix}$。无需四舍五入。",
            "solution": "问题陈述已经过验证，并被确定为自适应动力学领域中一个具有科学依据、适定且客观的问题。\n\n该问题要求推导和分析一个针对两个相互作用物种 $X$ 和 $Y$（分别具有性状 $x$ 和 $y$）的协同演化系统。其演化动力学由自适应动力学（AD）中的选择梯度近似控制。\n\n首先，我们解决为性状 $x$ 和 $y$ 编写显式动力系统的任务。动力学由 $\\dot{x} = \\beta \\frac{\\partial W_x}{\\partial x}$ 和 $\\dot{y} = \\beta \\frac{\\partial W_y}{\\partial y}$ 给出，其中 $\\beta  0$ 是一个缩放常数。入侵适应度函数如下：\n$$\nW_x(x,y) = r_x x - c_x x^{2} + \\eta x y\n$$\n$$\nW_y(x,y) = r_y y - c_y y^{2} + s\\,\\eta x y\n$$\n选择梯度是适应度函数对其自身性状的偏导数：\n$$\n\\frac{\\partial W_x}{\\partial x} = \\frac{\\partial}{\\partial x}(r_x x - c_x x^{2} + \\eta x y) = r_x - 2c_x x + \\eta y\n$$\n$$\n\\frac{\\partial W_y}{\\partial y} = \\frac{\\partial}{\\partial y}(r_y y - c_y y^{2} + s\\,\\eta x y) = r_y - 2c_y y + s\\,\\eta x\n$$\n将这些梯度代入AD方程，得到显式动力系统：\n$$\n\\dot{x} = \\beta (r_x - 2c_x x + \\eta y)\n$$\n$$\n\\dot{y} = \\beta (r_y - 2c_y y + s\\,\\eta x)\n$$\n\n接下来，我们推导内部不动点 $(x^{*}, y^{*})$，这是一个选择梯度为零的奇异策略。这需要求解 $\\dot{x} = 0$ 和 $\\dot{y} = 0$ 以得到 $x  0$ 和 $y  0$。由于 $\\beta  0$，这等价于求解以下方程组：\n$$\nr_x - 2c_x x^{*} + \\eta y^{*} = 0\n$$\n$$\nr_y - 2c_y y^{*} + s\\,\\eta x^{*} = 0\n$$\n这是一个关于 $x^{*}$ 和 $y^{*}$ 的二元线性方程组：\n$$\n2c_x x^{*} - \\eta y^{*} = r_x\n$$\n$$\n-s\\,\\eta x^{*} + 2c_y y^{*} = r_y\n$$\n我们可以用多种方法求解该方程组，例如克莱姆法则（Cramer's rule）。系数矩阵的行列式为：\n$$\nD = \\det \\begin{pmatrix} 2c_x  -\\eta \\\\ -s\\eta  2c_y \\end{pmatrix} = (2c_x)(2c_y) - (-\\eta)(-s\\eta) = 4c_x c_y - s\\eta^2\n$$\n为使唯一解存在，我们要求 $D \\neq 0$。$x^*$ 和 $y^*$ 的解为：\n$$\nx^{*} = \\frac{\\det \\begin{pmatrix} r_x  -\\eta \\\\ r_y  2c_y \\end{pmatrix}}{D} = \\frac{r_x(2c_y) - (-\\eta)r_y}{4c_x c_y - s\\eta^2} = \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^2}\n$$\n$$\ny^{*} = \\frac{\\det \\begin{pmatrix} 2c_x  r_x \\\\ -s\\eta  r_y \\end{pmatrix}}{D} = \\frac{(2c_x)r_y - r_x(-s\\eta)}{4c_x c_y - s\\eta^2} = \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^2}\n$$\n这就给出了内部不动点 $(x^{*}, y^{*})$ 的闭合形式表达式。\n\n最后，我们陈述该不动点具有生物学意义的条件，这要求正性（$x^*0, y^*0$）和局部稳定性。\n\n1.  **正性 ($x^*  0, y^*  0$)**：\n    所有参数 $r_x, r_y, c_x, c_y, \\eta$ 均严格为正。\n    $x^*$ 的分子 $2c_y r_x + \\eta r_y$ 恒为正。\n    $y^*$ 的分子 $2c_x r_y + s\\eta r_x$ 取决于 $s$：\n    - 如果 $s=+1$（共生），分子 $2c_x r_y + \\eta r_x$ 恒为正。\n    - 如果 $s=-1$（军备竞赛），分子为 $2c_x r_y - \\eta r_x$。为使 $y^*  0$，我们要求 $2c_x r_y  \\eta r_x$。\n    分母为 $D = 4c_x c_y - s\\eta^2$。\n    - 如果 $s=+1$，$D = 4c_x c_y - \\eta^2$。考虑到分子为正，要使 $x^*$ 和 $y^*$ 均为正，必须有 $D0$，即 $4c_x c_y  \\eta^2$。\n    - 如果 $s=-1$，$D = 4c_x c_y + \\eta^2$，恒为正。因此，要使 $x^*0$ 和 $y^*0$，我们只需要 $y^*$ 的分子为正，即 $2c_x r_y  \\eta r_x$。\n\n2.  **局部稳定性**：\n    不动点的稳定性由动力系统在不动点处评估的雅可比矩阵的特征值决定。\n    $$\n    J = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\beta \\begin{pmatrix} -2c_x  \\eta \\\\ s\\eta  -2c_y \\end{pmatrix}\n    $$\n    由于动力学是线性的，雅可比矩阵是常数。为了保证稳定性，$J$ 的所有特征值的实部必须为负。鉴于 $\\beta  0$，这等价于矩阵 $M=J/\\beta$ 的特征值具有负实部。对于一个 $2 \\times 2$ 矩阵，Routh-Hurwitz 稳定性判据为 $\\text{Tr}(M)  0$ 和 $\\det(M)  0$。\n    - 迹：$\\text{Tr}(M) = -2c_x - 2c_y = -2(c_x + c_y)$。由于 $c_x  0$ 且 $c_y  0$，迹恒为负。此条件总是满足。\n    - 行列式：$\\det(M) = (-2c_x)(-2c_y) - (\\eta)(s\\eta) = 4c_x c_y - s\\eta^2$。因此，稳定性条件是 $4c_x c_y - s\\eta^2  0$。\n\n3.  **条件总结**：\n    - 对于 $s=+1$（共生），正性条件 ($4c_x c_y  \\eta^2$) 与稳定性条件相同。因此，对于一个具有生物学意义的内部不动点，我们要求 $4c_x c_y  \\eta^2$。这意味着起稳定作用的自我调节成本的乘积必须超过可能破坏稳定的互利反馈的强度。\n    - 对于 $s=-1$（军备竞赛），稳定性条件 $4c_x c_y + \\eta^2  0$ 对于正参数总是满足的。正性条件是 $2c_x r_y  \\eta r_x$。因此，对于一个具有生物学意义的内部不动点，这个关于参数的单一条件必须成立。它确保了物种 $Y$ 不会因来自物种 $X$ 的对抗性压力而走向灭绝。\n\n所要求的最终答案是该不动点的闭合形式向量。\n$$\n\\begin{pmatrix} x^{*}  y^{*} \\end{pmatrix} = \\begin{pmatrix} \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^{2}}  \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^{2}} \\end{pmatrix}\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2c_y r_x + \\eta r_y}{4c_x c_y - s\\eta^{2}}  \\frac{2c_x r_y + s\\eta r_x}{4c_x c_y - s\\eta^{2}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "共演化动力学并非总是趋向于一个稳定的均衡。本练习将引导您探索一种更为动态的可能性：持续的周期性变化，通常被称为演化中的“红色皇后”动态。我们将研究在何种条件下，一个稳定的不动点会失去其稳定性，并通过一种名为霍普夫分岔（Hopf bifurcation）的现象，引发持续的振荡 。这对于理解捕食者与猎物、寄主与寄生虫之间永无止境的演化竞赛至关重要。",
            "id": "4117810",
            "problem": "考虑一个最小正则适应动力学模型，用于描述物种 $X$ 中的数量性状 $x(t)$ 和物种 $Y$ 中的数量性状 $y(t)$ 的共同演化。这两个性状受到稳定性选择、对抗性（军备竞赛）耦合以及在互利或对抗性升级中可能出现的乘性相互作用成本的共同影响。其选择梯度动力学模型为：\n$$\n\\frac{dx}{dt} \\;=\\; a \\;-\\; b\\,x \\;+\\; c\\,y \\;-\\; d\\,x\\,y, \\qquad\n\\frac{dy}{dt} \\;=\\; a \\;-\\; b\\,y \\;-\\; c\\,x \\;-\\; d\\,x\\,y,\n$$\n其中 $a \\in \\mathbb{R}$ 是一个基线方向选择参数，$b0$ 表示每个性状上的稳定性选择强度，$c \\in \\mathbb{R}$ 在 $c \\neq 0$ 时编码了对抗性（军备竞赛）耦合（其符号决定了哪个物种从对手性状的增加中获益），而 $d0$ 是一个成本系数，捕捉了当两个性状都很大时边际成本增加的情况。\n\n从平面系统中的线性化和局部分岔的第一性原理出发，完成以下任务：\n- 确定内部对称不动点 $(x^{\\ast},y^{\\ast})$。\n- 计算该不动点处的雅可比矩阵。\n- 确定基线参数 $a$ 的值，在该值下，不动点处的线性化具有纯虚数特征值（即一个局部的霍普夫分岔点），并明确说明为确保雅可比行列式的正性和横截的非退化性所需的任何参数不等式。\n\n假设 $b0$ 和 $d0$。为确保分岔点处的行列式为正且横截是横贯的，将注意力限制在参数区域 $|c||b|$ 和 $b+c \\neq 0$。在这些假设下，计算内部对称不动点处发生霍普夫分岔时的临界值 $a^{\\ast}$（以仅包含 $b$、$c$ 和 $d$ 的闭式解析表达式表示）。只需报告此 $a^{\\ast}$ 作为您的最终答案。无需数值近似或四舍五入，且不涉及物理单位。",
            "solution": "该问题提出了一个耦合常微分方程组，描述了在选择作用下两个性状 $x(t)$ 和 $y(t)$ 的共同演化：\n$$\n\\frac{dx}{dt} = f(x, y) = a - bx + cy - dxy\n$$\n$$\n\\frac{dy}{dt} = g(x, y) = a - by - cx - dxy\n$$\n参数 $a$、$b$、$c$ 和 $d$ 是常数，且 $b  0$ 和 $d  0$。我们的任务是找到参数 $a$ 的值，记为 $a^{\\ast}$，在该值下系统在内部对称不动点处发生霍普夫分岔。\n\n首先，我们确定内部对称不动点 $(x^{\\ast}, y^{\\ast})$。根据定义，不动点满足 $\\frac{dx}{dt} = 0$ 和 $\\frac{dy}{dt} = 0$。对称不动点是指 $x^{\\ast} = y^{\\ast}$ 的点。我们用 $x_s$ 表示这个共同的值。将 $x = y = x_s$ 代入任一个控制方程（在此代换下两个方程变得相同）可得：\n$$\na - bx_s + cx_s - d x_s^2 = 0\n$$\n整理后得到一个关于 $x_s$ 的二次方程：\n$$\nd x_s^2 + (b-c) x_s - a = 0\n$$\n该方程将对称不动点处的性状值 $x_s$ 与系统参数联系起来。\n\n接下来，我们通过计算在任意点 $(x, y)$ 的雅可比矩阵 $J$ 来对系统进行线性化：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -b - dy  c - dx \\\\ -c - dy  -b - dx \\end{pmatrix}\n$$\n我们在对称不动点 $(x_s, x_s)$ 处计算该雅可比矩阵：\n$$\nJ^{\\ast} = J(x_s, x_s) = \\begin{pmatrix} -b - dx_s  c - dx_s \\\\ -c - dx_s  -b - dx_s \\end{pmatrix}\n$$\n当雅可比矩阵 $J^{\\ast}$ 的特征值为一对纯虚共轭复数 $\\lambda = \\pm i\\omega$（其中 $\\omega \\neq 0$）时，发生霍普夫分岔。对于一个 $2 \\times 2$ 矩阵，这对应于两个条件：\n1. 矩阵的迹必须为零：$\\text{tr}(J^{\\ast}) = 0$。\n2. 矩阵的行列式必须为正：$\\text{det}(J^{\\ast})  0$。\n\n我们来计算 $J^{\\ast}$ 的迹和行列式：\n$$\n\\text{tr}(J^{\\ast}) = (-b - dx_s) + (-b - dx_s) = -2(b + dx_s)\n$$\n$$\n\\text{det}(J^{\\ast}) = (-b - dx_s)^2 - (c - dx_s)(-c - dx_s) = (b + dx_s)^2 + (c - dx_s)(c + dx_s)\n$$\n$$\n\\text{det}(J^{\\ast}) = (b^2 + 2bdx_s + d^2x_s^2) + (c^2 - d^2x_s^2) = b^2 + c^2 + 2bdx_s\n$$\n应用霍普夫分岔的第一个条件，$\\text{tr}(J^{\\ast}) = 0$：\n$$\n-2(b + dx_s) = 0\n$$\n由于 $b  0$ 且 $d  0$，这意味着 $b + dx_s = 0$，从而给出分岔点处的性状值：\n$$\ndx_s = -b \\implies x_s = -\\frac{b}{d}\n$$\n现在我们找到与此性状值 $x_s$ 对应的参数 $a$ 的临界值，记为 $a^{\\ast}$。我们将 $x_s = -b/d$ 代入不动点方程 $d x_s^2 + (b-c) x_s - a = 0$，并求解 $a = a^{\\ast}$：\n$$\na^{\\ast} = d x_s^2 + (b-c) x_s\n$$\n$$\na^{\\ast} = d \\left(-\\frac{b}{d}\\right)^2 + (b-c) \\left(-\\frac{b}{d}\\right)\n$$\n$$\na^{\\ast} = d \\left(\\frac{b^2}{d^2}\\right) - \\frac{b(b-c)}{d}\n$$\n$$\na^{\\ast} = \\frac{b^2}{d} - \\frac{b^2 - bc}{d} = \\frac{b^2 - b^2 + bc}{d}\n$$\n$$\na^{\\ast} = \\frac{bc}{d}\n$$\n这是分岔参数的候选值。我们必须验证霍普夫分岔的其他条件是否满足。\n\n第二个条件是 $\\text{det}(J^{\\ast})  0$。在分岔点，我们有 $dx_s = -b$。将此代入行列式的表达式：\n$$\n\\text{det}(J^{\\ast}) = b^2 + c^2 + 2b d x_s = b^2 + c^2 + 2b(-b) = b^2 + c^2 - 2b^2 = c^2 - b^2\n$$\n因此，条件 $\\text{det}(J^{\\ast})  0$ 要求 $c^2 - b^2  0$，这等价于 $c^2  b^2$ 或 $|c|  |b|$。该条件在问题陈述中已作为假设明确给出，证实了其一致性。\n\n最后，霍普夫分岔要求随着分岔参数 $a$ 的变化，特征值的实部以非零速度穿过虚轴。特征值由 $\\lambda = \\frac{\\text{tr}(J^{\\ast}) \\pm \\sqrt{\\text{tr}(J^{\\ast})^2 - 4\\text{det}(J^{\\ast})}}{2}$ 给出。其实部为 $\\text{Re}(\\lambda) = \\frac{1}{2}\\text{tr}(J^{\\ast}) = -(b+dx_s)$。\n我们必须检查在 $a = a^{\\ast}$ 时是否有 $\\frac{d}{da}\\left(\\text{Re}(\\lambda)\\right) \\neq 0$。\n$$\n\\frac{d}{da}\\left(\\text{Re}(\\lambda)\\right) = \\frac{d}{da}(-b-dx_s) = -d \\frac{dx_s}{da}\n$$\n为了求 $\\frac{dx_s}{da}$，我们对不动点方程 $d x_s^2 + (b-c) x_s - a = 0$ 关于 $a$ 求导：\n$$\n2dx_s \\frac{dx_s}{da} + (b-c) \\frac{dx_s}{da} - 1 = 0 \\implies (2dx_s + b - c) \\frac{dx_s}{da} = 1\n$$\n$$\n\\frac{dx_s}{da} = \\frac{1}{2dx_s + b - c}\n$$\n在分岔点 $a=a^{\\ast}$ 处，我们有 $dx_s = -b$。计算该导数：\n$$\n\\left.\\frac{dx_s}{da}\\right|_{a=a^{\\ast}} = \\frac{1}{2(-b) + b - c} = \\frac{1}{-b-c} = -\\frac{1}{b+c}\n$$\n因此，横截速度为：\n$$\n\\left.\\frac{d}{da}\\left(\\text{Re}(\\lambda)\\right)\\right|_{a=a^{\\ast}} = -d \\left(-\\frac{1}{b+c}\\right) = \\frac{d}{b+c}\n$$\n为了使横截是横贯的（非退化的），该速度必须非零。由于 $d0$，这要求 $b+c \\neq 0$。该条件也在问题陈述中作为假设给出。\n\n在问题的假设下，霍普夫分岔的所有条件都得到满足。发生分岔的 $a$ 的临界值是 $a^{\\ast}=\\frac{bc}{d}$。",
            "answer": "$$\\boxed{\\frac{bc}{d}}$$"
        },
        {
            "introduction": "在分析了系统的均衡和振荡行为之后，我们将从理论分析转向计算实践。前面的练习关注演化的终点，而本练习则聚焦于演化如何逐代发生。通过实施多变量育种者方程 ，您可以模拟特征的共演化轨迹，直观地观察选择梯度和遗传约束（由 $\\mathbf{G}$ 矩阵表示）如何在共生和拮抗情景中共同塑造演化路径。这个练习将理论模型与具体的、可计算的演化过程联系起来。",
            "id": "4117838",
            "problem": "考虑一个双物种协同进化系统，其中每个物种都有一个二维的数量性状向量。物种 A 的常驻性状表示为 $\\mathbf{z}_A \\in \\mathbb{R}^2$，物种 B 的常驻性状表示为 $\\mathbf{z}_B \\in \\mathbb{R}^2$。假设每个物种内的加性遗传方差-协方差由一个对称半正定矩阵 $\\mathbf{G}_A \\in \\mathbb{R}^{2 \\times 2}$ 和 $\\mathbf{G}_B \\in \\mathbb{R}^{2 \\times 2}$ 分别概括。每一代的选择响应遵循多变量育种者框架，其中响应与在当前平均性状下评估的选择梯度成正比，并按各自的加性遗传方差-协方差矩阵进行缩放。您将通过迭代离散世代来模拟协同进化动态，在每一代中使用此框架更新 $\\mathbf{z}_A$ 和 $\\mathbf{z}_B$。\n\n给定两类生态相互作用函数，它们确定选择梯度作为当前性状的函数，捕捉共生和军备竞赛动态。在这两类中，所有函数都逐分量地作用于性状向量（也就是说，像 $\\tanh$ 这样的运算独立地应用于向量的每个分量）。\n\n互利共生类。物种 A 和 B 的选择梯度定义为\n$$\n\\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big),\n$$\n$$\n\\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big),\n$$\n其中 $\\boldsymbol{\\alpha}_A,\\boldsymbol{\\alpha}_B \\in \\mathbb{R}^2_{\\ge 0}$ 编码朝向最适值 $\\boldsymbol{\\theta}_A,\\boldsymbol{\\theta}_B \\in \\mathbb{R}^2$ 的稳定性选择强度，$\\boldsymbol{\\gamma}_A,\\boldsymbol{\\gamma}_B \\in \\mathbb{R}^2_{\\ge 0}$ 编码互利耦合强度，而 $\\kappa \\in \\mathbb{R}_{0}$ 通过双曲正切函数缩放饱和的陡峭程度。\n\n拮抗军备竞赛类。物种 A 和 B 的选择梯度定义为\n$$\n\\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big),\n$$\n$$\n\\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big),\n$$\n其中 $\\boldsymbol{\\alpha}_A,\\boldsymbol{\\alpha}_B \\in \\mathbb{R}^2_{\\ge 0}$ 编码朝向最适值 $\\boldsymbol{\\theta}_A,\\boldsymbol{\\theta}_B \\in \\mathbb{R}^2$ 的稳定性选择强度，而 $\\boldsymbol{\\rho}_A,\\boldsymbol{\\rho}_B \\in \\mathbb{R}^2_{\\ge 0}$ 编码拮抗耦合强度。\n\n对于以下所有情况，使用上述多变量育种者框架迭代离散世代指定的步数。在每一代中，根据当前性状计算选择梯度 $\\mathbf{s}_A$ 和 $\\mathbf{s}_B$，并相应地更新两个物种的性状均值。\n\n您的程序必须实现上述动态，并为以下测试套件计算固定代数后的最终性状向量。矩阵和向量中的所有数值均为实数。\n\n测试用例 1（互利共生，耦合但稳定）。使用\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.20  0.03 \\\\ 0.03  0.10 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.15  0.00 \\\\ 0.00  0.12 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.05 \\\\ 0.08 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_A = \\begin{bmatrix} 0.04 \\\\ 0.03 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.5 \\\\ -0.5 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.06 \\\\ 0.06 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_B = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.5 \\\\ -0.5 \\end{bmatrix}$。\n- $\\kappa = 0.7$。\n- 初始条件：$\\mathbf{z}_A^{(0)} = \\begin{bmatrix} -1.0 \\\\ 1.0 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} 1.0 \\\\ -1.0 \\end{bmatrix}$。\n- 世代数：$T = 300$。\n\n测试用例 2（带稳定性选择的军备竞赛）。使用\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.18  0.02 \\\\ 0.02  0.09 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.16  0.01 \\\\ 0.01  0.11 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.04 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\rho}_A = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.04 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\rho}_B = \\begin{bmatrix} 0.05 \\\\ 0.02 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n- $\\kappa = 0.8$。\n- 初始条件：$\\mathbf{z}_A^{(0)} = \\begin{bmatrix} 0.2 \\\\ -0.2 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.2 \\end{bmatrix}$。\n- 世代数：$T = 300$。\n\n测试用例 3（物种 A 的遗传协方差矩阵为奇异矩阵的互利共生）。使用\n- $\\mathbf{G}_A = \\begin{bmatrix} 0.10  0.00 \\\\ 0.00  0.00 \\end{bmatrix}$, $\\mathbf{G}_B = \\begin{bmatrix} 0.14  0.00 \\\\ 0.00  0.10 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_A = \\begin{bmatrix} 0.05 \\\\ 0.08 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_A = \\begin{bmatrix} 0.03 \\\\ 0.04 \\end{bmatrix}$, $\\boldsymbol{\\theta}_A = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n- $\\boldsymbol{\\alpha}_B = \\begin{bmatrix} 0.06 \\\\ 0.06 \\end{bmatrix}$, $\\boldsymbol{\\gamma}_B = \\begin{bmatrix} 0.04 \\\\ 0.03 \\end{bmatrix}$, $\\boldsymbol{\\theta}_B = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n- $\\kappa = 0.7$。\n- 初始条件：$\\mathbf{z}_A^{(0)} = \\begin{bmatrix} 0.3 \\\\ -0.7 \\end{bmatrix}$, $\\mathbf{z}_B^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.9 \\end{bmatrix}$。\n- 世代数：$T = 300$。\n\n实现要求。\n- 对于每个测试用例，精确迭代 $T$ 个离散世代，每代根据多变量育种者框架和指定的选择梯度函数原地更新 $\\mathbf{z}_A$ 和 $\\mathbf{z}_B$。\n- 逐分量使用双曲正切函数，即，如果 $\\mathbf{u} \\in \\mathbb{R}^2$，则 $\\tanh(\\mathbf{u})$ 返回 $\\begin{bmatrix} \\tanh(u_1) \\\\ \\tanh(u_2) \\end{bmatrix}$。\n- 完成一个测试用例的 $T$ 次更新后，按顺序 $[z_{A,1}^{(T)}, z_{A,2}^{(T)}, z_{B,1}^{(T)}, z_{B,2}^{(T)}]$ 返回最终值，并四舍五入到六位小数。\n\n最终输出格式。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身就是一个包含四个浮点数的、用方括号括起来的逗号分隔列表。例如，包含三个测试用例的输出必须类似于 $\\texttt{[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]}$，其中每个 $a_i,b_i,c_i$ 都四舍五入到六位小数。",
            "solution": "该问题要求模拟一个由多变量育种者方程控制的双物种协同进化系统。两个物种的二维平均性状向量（物种 A 为 $\\mathbf{z}_A$，物种 B 为 $\\mathbf{z}_B$）的进化过程在离散的世代中进行建模。\n\n核心原理是多变量育种者框架，该框架指出一代内的进化响应（平均性状的变化）是加性遗传方差-协方差矩阵（$\\mathbf{G}$）与选择梯度向量（$\\mathbf{s}$）的乘积。性状向量 $\\mathbf{z}$ 从第 $t$ 代到第 $t+1$ 代的更新规则是：\n$$\n\\mathbf{z}^{(t+1)} = \\mathbf{z}^{(t)} + \\Delta \\mathbf{z}^{(t)}\n$$\n其中变化量 $\\Delta \\mathbf{z}^{(t)}$ 由下式给出：\n$$\n\\Delta \\mathbf{z}^{(t)} = \\mathbf{G} \\, \\mathbf{s}(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\n这导致每个物种的具体更新方程如下：\n$$\n\\mathbf{z}_A^{(t+1)} = \\mathbf{z}_A^{(t)} + \\mathbf{G}_A \\, \\mathbf{s}_A(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\n$$\n\\mathbf{z}_B^{(t+1)} = \\mathbf{z}_B^{(t)} + \\mathbf{G}_B \\, \\mathbf{s}_B(\\mathbf{z}_A^{(t)}, \\mathbf{z}_B^{(t)})\n$$\n此处，$\\mathbf{G}_A$ 和 $\\mathbf{G}_B$ 是给定的 $2 \\times 2$ 遗传方差-协方差矩阵，$\\mathbf{s}_A$ 和 $\\mathbf{s}_B$ 是选择梯度，它们取决于物种间的生态相互作用性质。选择梯度方程中的项 $\\operatorname{diag}(\\mathbf{v})\\mathbf{u}$ 对应于向量 $\\mathbf{v}$ 和 $\\mathbf{u}$ 的逐元素（哈达玛）乘积。\n\n问题定义了两类相互作用：\n\n1.  **互利共生**：选择梯度由下式给出：\n    $$\n    \\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big)\n    $$\n    $$\n    \\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\gamma}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big)\n    $$\n    第一项代表稳定性选择，将每个物种的性状拉向其自身的最适值 $\\boldsymbol{\\theta}$。第二项代表互利效益，其中每个物种的适应度（以及因此的选择）受到另一物种性状的积极影响，由于 $\\tanh$ 函数而饱和。这种相互作用将两个物种的性状推向彼此。\n\n2.  **拮抗军备竞赛**：选择梯度由下式给出：\n    $$\n    \\mathbf{s}_A(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_A)\\,(\\mathbf{z}_A - \\boldsymbol{\\theta}_A) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_A)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_A - \\mathbf{z}_B)\\big)\n    $$\n    $$\n    \\mathbf{s}_B(\\mathbf{z}_A,\\mathbf{z}_B) \\;=\\; -\\operatorname{diag}(\\boldsymbol{\\alpha}_B)\\,(\\mathbf{z}_B - \\boldsymbol{\\theta}_B) \\;+\\; \\operatorname{diag}(\\boldsymbol{\\rho}_B)\\,\\tanh\\!\\big(\\kappa\\,(\\mathbf{z}_B - \\mathbf{z}_A)\\big)\n    $$\n    在这种情况下，物种 A 的相互作用项 $\\tanh(\\kappa(\\mathbf{z}_A - \\mathbf{z}_B))$ 会将其性状 $\\mathbf{z}_A$ 推离 $\\mathbf{z}_B$。对称地，物种 B 被选择将其性状 $\\mathbf{z}_B$ 移离 $\\mathbf{z}_A$。这创造了一种追逐动态，是军备竞赛的特征。\n\n解决每个测试用例的算法流程如下：\n1.  使用给定的起始值 $\\mathbf{z}_A^{(0)}$ 和 $\\mathbf{z}_B^{(0)}$ 初始化性状向量 $\\mathbf{z}_A$ 和 $\\mathbf{z}_B$。\n2.  从 $t = 0$ 到 $T-1$ 进行迭代，其中 $T$ 是指定的世代数。在每次迭代中：\n    a.  确定当前测试用例的相互作用类型（互利共生或军备竞赛）。\n    b.  使用当前的性状向量 $\\mathbf{z}_A^{(t)}$ 和 $\\mathbf{z}_B^{(t)}$ 以及相应的方程计算选择梯度向量 $\\mathbf{s}_A$ 和 $\\mathbf{s}_B$。所有向量运算，如减法和 $\\tanh$ 函数，都是逐元素执行的。\n    c.  通过执行矩阵-向量乘法来计算每个物种的进化响应：$\\Delta \\mathbf{z}_A^{(t)} = \\mathbf{G}_A \\mathbf{s}_A$ 和 $\\Delta \\mathbf{z}_B^{(t)} = \\mathbf{G}_B \\mathbf{s}_B$。\n    d.  更新下一代的性状向量：$\\mathbf{z}_A^{(t+1)} = \\mathbf{z}_A^{(t)} + \\Delta \\mathbf{z}_A^{(t)}$ 和 $\\mathbf{z}_B^{(t+1)} = \\mathbf{z}_B^{(t)} + \\Delta \\mathbf{z}_B^{(t)}$。\n3.  经过 $T$ 代后，最终的性状向量为 $\\mathbf{z}_A^{(T)}$ 和 $\\mathbf{z}_B^{(T)}$。\n4.  将最终向量的分量连接成一个列表 $[z_{A,1}^{(T)}, z_{A,2}^{(T)}, z_{B,1}^{(T)}, z_{B,2}^{(T)}]$，并将每个值四舍五入到六位小数。\n\n在测试用例 3 中，物种 A 的遗传方差-协方差矩阵 $\\mathbf{G}_A = \\begin{bmatrix} 0.10  0.00 \\\\ 0.00  0.00 \\end{bmatrix}$ 是奇异的。$\\mathbf{G}_A$ 的第二行为全零，这意味着无论选择梯度如何，物种 A 性状向量的第二个分量 $\\Delta z_{A,2}$ 的变化在每一代中都将为零：\n$$\n\\Delta z_{A,2}^{(t)} = [\\mathbf{G}_A \\mathbf{s}_A]_2 = G_{A,21}s_{A,1} + G_{A,22}s_{A,2} = (0.00)s_{A,1} + (0.00)s_{A,2} = 0\n$$\n因此，物种 A 的第二个特性 $z_{A,2}$ 将在整个模拟过程中保持其初始值不变。第一个特性 $z_{A,1}$ 将正常进化。这是一个有效的情景，代表特定性状缺乏可遗传变异。通用算法无需修改即可正确处理此情况。",
            "answer": "```\n[[0.504959,-0.493976,0.504899,-0.494195],[0.771140,-0.283177,-0.771140,0.283177],[-0.053177,-0.700000,0.053229,-0.095039]]\n```"
        }
    ]
}