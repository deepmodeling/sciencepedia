{
    "hands_on_practices": [
        {
            "introduction": "The Bethe lattice, an infinite tree-like graph, serves as a foundational model in statistical physics because it is often exactly solvable. This exercise challenges you to derive the bond percolation threshold on this lattice by mapping the growth of a cluster to a Galton-Watson branching process. This powerful technique provides a clear and intuitive picture of the phase transition and is a cornerstone for mean-field approximations of percolation on more complex lattices. ",
            "id": "4136648",
            "problem": "Consider an infinite tree without cycles, known as a Bethe lattice, where every vertex has the same degree (coordination number) $z \\geq 3$. In bond percolation, each edge is independently declared open with probability $p \\in [0,1]$ and closed otherwise. A connected component of open edges containing a designated root vertex is called its open cluster. In the absence of cycles, the growth of the open cluster away from the root can be modeled as a branching process in which each newly reached vertex can only attempt to connect to its previously unreached neighbors.\n\nStarting from first principles appropriate to complex adaptive systems modeling, use the following foundational bases:\n\n- The definition of the Bethe lattice as an infinite, cycle-free, $z$-regular graph.\n- The mapping from the percolating cluster on a tree to a Galton–Watson branching process, where the number of offspring of a vertex equals the number of open edges to previously unreached neighbors.\n- The standard characterization of extinction and survival in a Galton–Watson process via the offspring generating function, and the criterion for the emergence of a nonzero survival probability at criticality.\n\nDerive the bond percolation threshold $p_c$ on the Bethe lattice as a closed-form function of $z$. Your derivation must begin from the above bases, explicitly identify the offspring distribution induced by bond percolation on the Bethe lattice, formulate the extinction probability equation using the generating function, and infer the condition for the appearance of a nontrivial survival probability. Express the final threshold as a single exact analytic expression in terms of $z$. No rounding is required, and no units are needed. The final answer must be a single expression.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It describes a canonical problem in the statistical physics of complex systems, specifically bond percolation on a Bethe lattice, and requests a derivation based on first principles. The provided framework—mapping to a Galton-Watson process—is the standard and rigorous method for solving this problem. All definitions and conditions are self-contained and mathematically consistent.\n\nThe derivation of the bond percolation threshold, $p_c$, is carried out by following the specified foundational bases.\n\n1.  **Mapping Percolation to a Branching Process**\n    A Bethe lattice is an infinite, cycle-free graph where every vertex has a coordination number $z$. We consider one vertex as the root of a potential open cluster, designating it as generation $G_0$. An edge is open with probability $p$ and closed with probability $1-p$.\n    The growth of the open cluster from the root can be modeled as a Galton-Watson branching process. In this model, vertices of the cluster are \"individuals\" and open edges to new vertices are \"offspring\".\n    Let's consider a vertex that is part of the open cluster and belongs to generation $n \\geq 1$. It was reached via an open edge from a unique \"parent\" vertex in generation $n-1$. Since the lattice is a tree, there are no cycles. Therefore, of the $z$ edges connected to this vertex, one leads back to its parent, and the other $z-1$ edges lead to previously unvisited \"forward\" neighbors.\n    The number of offspring for a vertex in generation $n \\geq 1$ is the number of open edges connecting it to its $z-1$ forward neighbors. For the process to be modeled by a standard Galton-Watson process where all individuals have the same offspring distribution, we consider the population dynamics starting from generation $G_1$ (the children of the root). Any individual in generation $n \\geq 1$ has $z-1$ potential offspring.\n\n2.  **Offspring Distribution and Generating Function**\n    The number of offspring, $k$, for any given individual (a vertex in generation $n \\geq 1$) follows a binomial distribution. There are $z-1$ independent trials (edges to forward neighbors), each with a success probability $p$ (the edge being open). The probability mass function, $P(k)$, for having $k$ offspring is:\n    $$P(k) = \\binom{z-1}{k} p^k (1-p)^{z-1-k}, \\quad \\text{for } k \\in \\{0, 1, \\dots, z-1\\}$$\n    The offspring generating function, $G(x)$, is defined by the power series $G(x) = \\sum_{k=0}^{\\infty} P(k) x^k$. Substituting our binomial distribution:\n    $$G(x) = \\sum_{k=0}^{z-1} \\binom{z-1}{k} p^k (1-p)^{z-1-k} x^k$$\n    This is the expansion of a binomial expression. By the binomial theorem, $(a+b)^n = \\sum_{k=0}^n \\binom{n}{k} a^{n-k} b^k$, we can identify $n = z-1$, $a = 1-p$, and $b = px$. The generating function simplifies to:\n    $$G(x) = ((1-p)+px)^{z-1} = (1-p+px)^{z-1}$$\n\n3.  **Condition for Infinite Cluster Formation (Non-Extinction)**\n    In the theory of branching processes, the probability of ultimate extinction, $q$, is the smallest non-negative fixed point of the generating function, i.e., the smallest solution to $q = G(q)$.\n    An infinite cluster can form only if there is a non-zero probability of survival, which means the extinction probability $q$ must be strictly less than $1$.\n    The equation $x = G(x)$ always has a solution at $x=1$ because $G(1) = \\sum P(k) = 1$. The existence of another solution $q \\in [0, 1)$ depends on the behavior of $G(x)$ near $x=1$. Since $G(x)$ is a convex function on $[0,1]$ (as all $P(k) \\geq 0$), it will intersect the line $y=x$ at a point smaller than $x=1$ if and only if its slope at $x=1$ is greater than $1$.\n    The condition for the emergence of a non-trivial survival probability is therefore $G'(1) > 1$. The quantity $G'(1)$ is the expected number of offspring for a single individual.\n    The percolation threshold, $p_c$, is the critical value of $p$ at which the system transitions from a regime where all clusters are finite (subcritical, $G'(1) \\leq 1$) to a regime where an infinite cluster may exist (supercritical, $G'(1) > 1$). At criticality, the mean number of offspring is exactly one:\n    $$G'(1) = 1$$\n\n4.  **Derivation of the Percolation Threshold $p_c$**\n    We compute the derivative of $G(x)$ with respect to $x$:\n    $$G'(x) = \\frac{d}{dx} \\left[ (1-p+px)^{z-1} \\right]$$\n    Using the chain rule:\n    $$G'(x) = (z-1) (1-p+px)^{z-2} \\cdot \\frac{d}{dx}(1-p+px) = p(z-1)(1-p+px)^{z-2}$$\n    Now, we evaluate this derivative at $x=1$:\n    $$G'(1) = p(z-1)(1-p+p(1))^{z-2} = p(z-1)(1)^{z-2} = p(z-1)$$\n    The mean number of offspring is $\\mu = p(z-1)$. We set this equal to $1$ at the critical probability $p=p_c$:\n    $$p_c(z-1) = 1$$\n    Solving for $p_c$, we obtain the bond percolation threshold on the Bethe lattice:\n    $$p_c = \\frac{1}{z-1}$$\n    This expression gives the exact percolation threshold as a function of the coordination number $z$, as required. The condition $z \\geq 3$ ensures that $p_c \\in (0, 1/2]$, which is physically meaningful.",
            "answer": "$$\\boxed{\\frac{1}{z-1}}$$"
        },
        {
            "introduction": "Duality is an elegant and powerful concept that provides exact solutions for certain two-dimensional statistical models. For the square lattice, a symmetry exists between the percolation model on the original (primal) lattice and a corresponding model on its dual. This practice guides you to exploit this symmetry by invoking the principle of self-duality at criticality, leading to the exact condition for the phase transition in an anisotropic system. ",
            "id": "4136623",
            "problem": "Consider bond percolation on the infinite square lattice $\\mathbb{Z}^{2}$ in the plane, where each horizontal bond is independently open with probability $p_{h}\\in(0,1)$ and each vertical bond is independently open with probability $p_{v}\\in(0,1)$. Let the planar dual lattice be defined in the usual way, with a dual bond crossing each primal bond. Use the following foundational facts as your starting point:\n\n- In planar bond percolation, the dual bond crossing a given primal bond is open if and only if the primal bond is closed; thus the open probability of a dual bond equals one minus the open probability of the crossed primal bond. Because a dual horizontal bond crosses a primal vertical bond and a dual vertical bond crosses a primal horizontal bond, the dual percolation model corresponding to $(p_{h},p_{v})$ has horizontal and vertical bond open probabilities $(p_{h}^{*},p_{v}^{*})=(1-p_{v},\\,1-p_{h})$.\n- For rectangular domains, the event of a left–right open crossing in the primal model is the complement (up to boundary null events in the continuum limit) of a top–bottom open crossing in the dual model.\n- Crossing events are monotone in the bond probabilities, and the transition between almost sure absence and presence of an infinite open cluster is unique.\n\nStarting from these principles, derive the condition that characterizes the critical manifold for this anisotropic bond percolation model on the square lattice by invoking self-duality of the critical point: at criticality, the model is statistically invariant under passage to the dual. Express the critical manifold as a single closed-form analytic relation giving $p_{v}$ as a function of $p_{h}$. Your final answer must be a single analytical expression without units. Do not use any shortcut formulas; your derivation must proceed from the stated principles.",
            "solution": "The problem requires deriving the critical manifold for an anisotropic bond percolation model on the square lattice, starting from the provided principles of duality.\n\n1.  **Model and Dual Model Definition**\n    Let the primal percolation model be denoted by $M(p_h, p_v)$, where $p_h$ and $p_v$ are the independent probabilities that horizontal and vertical bonds are open, respectively.\n    The first principle defines the dual model, $M^*$. On the dual lattice, a horizontal bond (crossing a primal vertical bond) is open with probability $p_h^* = 1-p_v$. A dual vertical bond (crossing a primal horizontal bond) is open with probability $p_v^* = 1-p_h$. Therefore, the dual model is also an anisotropic bond percolation model on a square lattice, characterized by the parameters $(p_h^*, p_v^*) = (1-p_v, 1-p_h)$. We can write this as $M^* = M(1-p_v, 1-p_h)$.\n\n2.  **Invoking Self-Duality at Criticality**\n    The second and third principles establish a fundamental relationship between the primal and dual models: the existence of an infinite open cluster in the primal model (the supercritical phase) corresponds to the absence of an infinite open cluster in the dual model (the subcritical phase), and vice versa. The critical manifold is the unique boundary that separates these two phases.\n    This implies that the duality transformation must map the critical manifold onto itself. The problem statement provides the key insight: \"at criticality, the model is statistically invariant under passage to the dual.\"\n    This means that if the parameter pair $(p_h, p_v)$ lies on the critical manifold, the primal model $M(p_h, p_v)$ must be statistically indistinguishable from its dual, $M^* = M(1-p_v, 1-p_h)$.\n\n3.  **Deriving the Critical Condition**\n    Since the statistical properties of this model are uniquely determined by its bond occupation probabilities, for the primal and dual models to be statistically invariant, their defining parameter pairs must be identical.\n    Therefore, at criticality, we must have:\n    $$(p_h, p_v) = (p_h^*, p_v^*)$$\n    Substituting the expressions for the dual probabilities:\n    $$(p_h, p_v) = (1-p_v, 1-p_h)$$\n    This equality of ordered pairs gives a system of two equations:\n    1.  $p_h = 1 - p_v$\n    2.  $p_v = 1 - p_h$\n    Both equations are equivalent and simplify to the single condition:\n    $$p_h + p_v = 1$$\n    This equation defines the critical manifold for the system.\n\n4.  **Final Expression**\n    The problem asks for the relation giving $p_v$ as a function of $p_h$. Rearranging the critical condition, we get:\n    $$p_v = 1 - p_h$$\n    This is the desired closed-form expression for the critical manifold. As a check, for the isotropic case where $p_h = p_v = p_c$, this condition yields $p_c + p_c = 1$, or $p_c = 1/2$, which is the correct and well-known exact bond percolation threshold on the square lattice.",
            "answer": "$$\\boxed{1 - p_h}$$"
        },
        {
            "introduction": "While analytical methods provide deep insights, computational approaches are indispensable for obtaining precise quantitative results for most percolation models. This practice moves into the realm of computational physics, asking you to implement a sophisticated algorithm to estimate the site percolation threshold on a two-dimensional torus. By using a union-find data structure augmented to detect cluster wrapping, you will explore a state-of-the-art technique that minimizes finite-size effects and provides a high-precision estimate of the critical point. ",
            "id": "4136646",
            "problem": "Consider site percolation on a two-dimensional square lattice of linear size $L$ with periodic boundary conditions, which topologically forms a discrete torus. Each lattice site is occupied independently with probability $p \\in [0,1]$. Clusters are defined by nearest-neighbor connectivity on the torus. The percolation threshold $p_c$ is the critical occupation probability at which an extensive cluster appears. In finite systems, boundary effects can bias estimators of $p_c$; periodic boundary conditions mitigate these effects by eliminating edges and corners, allowing the use of wrapping probabilities for estimation.\n\nDefine the wrapping probability $R_L(p)$ as the probability that there exists at least one cluster with nonzero winding number along the horizontal or vertical direction of the torus. A cluster exhibits horizontal wrapping if there exists a closed path in the cluster whose net displacement in the horizontal direction is nonzero when accounting for jumps across the periodic boundary; vertical wrapping is defined analogously. The first-wrapping index $m^\\star$ for a given realization and a fixed lattice size $L$ is the smallest number of occupied sites $m$ for which a cluster acquires a nonzero winding number in at least one direction.\n\nStarting from the core definitions of percolation clusters, nearest-neighbor connectivity, and periodic boundary conditions, implement an algorithm to detect winding using a disjoint-set union (union-find) data structure augmented with displacement tracking so that cycle formation with nonzero net displacement along either torus direction is detected exactly at the moment it occurs. Use this to estimate $p_c$ as the median of $m^\\star/n$, where $n=L^2$ is the number of lattice sites, across a number of independent realizations. This estimator corresponds to the point where the microcanonical wrapping probability crosses $1/2$, and under periodic boundary conditions this crossing yields a reduced-boundary-effects estimate of $p_c$.\n\nYour program must:\n- Construct a toroidal lattice of size $L \\times L$.\n- Add sites one by one in a random order and union them to their occupied neighbors using nearest-neighbor connectivity, with periodic boundary conditions.\n- Track for each union operation the displacement constraints so that when an edge closes a cycle, the net displacement of the cycle is computed; if the net displacement along the horizontal or vertical directions is nonzero, mark that the cluster wraps in that direction.\n- Record the first-wrapping index $m^\\star$ for each realization (the step at which wrapping first occurs), and compute the median of $m^\\star/n$ across realizations to estimate $p_c$.\n- Produce results for the provided test suite.\n\nFundamental base to use:\n- Nearest-neighbor connectivity on a square lattice.\n- Definition of clusters as connected components via occupied sites.\n- Periodic boundary conditions implementing toroidal topology via index arithmetic modulo $L$.\n- Monotonicity of wrapping probability with increasing occupied fraction.\n- Median-as-crossing interpretation: the median of $m^\\star/n$ across realizations equals the occupation fraction where the finite-size microcanonical wrapping probability crosses $1/2$.\n\nYour implementation must be purely algorithmic and simulate the defined process; no external data may be used. All outputs are dimensionless probabilities and must be expressed as decimals.\n\nTest suite:\n- Case $1$: $L=16$, number of realizations $T=600$, random seed $314159$.\n- Case $2$: $L=32$, number of realizations $T=400$, random seed $271828$.\n- Case $3$: $L=64$, number of realizations $T=300$, random seed $161803$.\n- Case $4$: $L=10$, number of realizations $T=800$, random seed $101$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite, for example, \"[$r_1,r_2,r_3,r_4$]\". Each $r_i$ must be a decimal number representing the estimated $p_c$ for the corresponding case.",
            "solution": "The problem requires an algorithmic estimation of the site percolation threshold $p_c$ on a torus, using a method designed to minimize finite-size effects. The core idea is to simulate the growth of clusters by adding occupied sites one by one and to determine the exact moment a cluster \"wraps\" around the torus.\n\nThe algorithm proceeds as follows:\n\n1.  **Algorithmic Strategy**\n    Instead of choosing a fixed occupation probability $p$ and checking for wrapping, we simulate the process dynamically. We start with an empty $L \\times L$ lattice and add occupied sites one at a time in a random order. This corresponds to exploring different occupation densities. We stop as soon as a cluster wraps the torus for the first time, and we record the number of sites $m^\\star$ at which this occurs. The ratio $m^\\star/L^2$ is an estimate of $p_c$ for this single realization. By finding the median of these estimates over many realizations, we can get a precise value for $p_c$.\n\n2.  **Data Structure: Augmented Union-Find**\n    A disjoint-set union (or union-find) data structure is ideal for tracking the connected components (clusters) as they form. To detect wrapping, this structure is augmented:\n    -   **Parent Pointers:** Each site has a pointer to its parent in the tree representing its cluster. The root of a tree is its own parent.\n    -   **Displacement Vectors:** For each site `i`, we store a 2D integer vector `disp[i]` representing the displacement from site `i` to its parent, `parent[i]`, on an *unrolled* infinite lattice. This accounts for jumps across the periodic boundaries (e.g., a jump from column $L-1$ to $0$ is a displacement of $(0, -L)$ in lattice units).\n    -   **Wrapping Status:** For each root of a cluster, we store a boolean pair `wrapped[root]` that indicates if the cluster has been found to wrap in the x or y direction.\n\n3.  **Core Operations**\n    -   **`find(i)`:** This operation finds the root of the cluster containing site `i`. During this process (path compression), it accumulates the displacement vectors along the path to calculate the total displacement from `i` to the root.\n    -   **`union(i, j)`:** This unites the clusters containing neighboring sites `i` and `j`. If `i` and `j` are in different clusters, the clusters are merged (e.g., by rank), the displacement vector of the merged root is updated to maintain consistency, and the wrapping status of the new root becomes the logical OR of the two previous clusters' statuses. If `i` and `j` are already in the same cluster, adding the bond between them closes a cycle. We can calculate the net displacement vector `W` of this newly formed cycle. If `W` is non-zero (e.g., `W = (L, 0)`), it means the cycle has a non-zero winding number, and we update the `wrapped` status of the cluster's root accordingly.\n\n4.  **Simulation for One Realization**\n    -   Initialize an empty $L \\times L$ lattice and the augmented union-find structure for $n=L^2$ sites.\n    -   Generate a random permutation of the $n$ site indices.\n    -   Iterate through the permutation, adding one site at a time. Let $m$ be the number of sites added so far.\n    -   For each newly occupied site, iterate through its four neighbors. If a neighbor is already occupied, perform a `union` operation on the two sites.\n    -   After the `union` operations for the new site are complete, check the wrapping status of its cluster. If the cluster is now wrapped in either the x or y direction, this is the first wrapping event.\n    -   Record $m^\\star = m$ and terminate the realization.\n\n5.  **Estimating $p_c$**\n    -   Repeat the simulation for a large number of independent realizations, $T$, collecting a list of first-wrapping indices $\\{m_1^\\star, m_2^\\star, \\dots, m_T^\\star\\}$.\n    -   Calculate the occupation fraction for each: $p_i = m_i^\\star / n$.\n    -   The estimate for the percolation threshold $p_c$ is the median of this set of fractions: $p_c \\approx \\text{median}(\\{p_i\\})$. This corresponds to the point where the wrapping probability crosses $1/2$, a robust estimator that converges quickly to the infinite-lattice value.\n\nThis procedure, based on a variation of the Newman-Ziff algorithm, provides a computationally efficient and highly accurate method for determining percolation thresholds.",
            "answer": "[0.592578,0.592773,0.592529,0.590000]"
        }
    ]
}