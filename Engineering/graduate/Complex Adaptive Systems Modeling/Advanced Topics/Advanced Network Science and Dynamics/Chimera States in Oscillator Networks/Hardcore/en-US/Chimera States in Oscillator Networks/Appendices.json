{
    "hands_on_practices": [
        {
            "introduction": "Understanding synchronization often begins with the global Kuramoto order parameter, $R$, which provides a single value to describe the coherence of an entire network. However, the defining feature of a chimera state is the spatial coexistence of synchronized and desynchronized oscillators. This practice  challenges you to compute the global order parameter for a network explicitly constructed to be in a chimera-like configuration, revealing how this macroscopic measure can be misleading and motivating the need for spatially-resolved diagnostics.",
            "id": "4117505",
            "problem": "Consider a ring network of $N=1200$ identical phase oscillators with nonlocal coupling, studied under the framework of complex adaptive systems modeling. A snapshot of the phases exhibits a coexistence between coherence and incoherence: a contiguous coherent domain and a complementary incoherent domain. Specifically, the phases are given by the following partition:\n- For $1 \\leq j \\leq 360$, the oscillators are phase-locked at $\\theta_{j}=0$ (in radians).\n- For $361 \\leq j \\leq 1200$, the oscillators are distributed uniformly over the unit circle: $\\theta_{j}=\\frac{2\\pi}{840}\\big(j-361\\big)$ (in radians), which enumerates the full set of $840$ equally spaced points on the circle.\n\nStarting from the core definition of the global Kuramoto order parameter, compute the complex mean\n$$R\\,\\exp(i\\Psi)=\\frac{1}{N}\\sum_{j=1}^{N}\\exp\\big(i\\theta_{j}\\big),$$\nand return the magnitude $R$ as an exact rational number. Then, using first principles about averaging on the unit circle and without appealing to any prepackaged diagnostic formulas outside of standard definitions, explain why a single global $R$ may be unable to resolve the coexistence of coherence and incoherence typically observed in chimera states.\n\nExpress the final magnitude $R$ exactly as a rational number. Angles are in radians. No units are required for the final answer.",
            "solution": "The problem is well-posed and scientifically sound, providing all necessary information for a complete analysis. We are asked to compute the magnitude of the global Kuramoto order parameter for a given phase distribution and to explain the limitations of this global measure.\n\nThe global Kuramoto order parameter is defined as a complex number $Z = R\\,\\exp(i\\Psi)$, where $R$ is the magnitude and $\\Psi$ is the average phase. It is calculated as the complex mean of the phasors for all oscillators in the network:\n$$Z = R\\,\\exp(i\\Psi)=\\frac{1}{N}\\sum_{j=1}^{N}\\exp\\big(i\\theta_{j}\\big)$$\nThe total number of oscillators is $N=1200$. The network is partitioned into two distinct subpopulations.\n\nFirst, we calculate the sum $\\sum_{j=1}^{N}\\exp(i\\theta_{j})$ by splitting it across the two domains: the coherent domain and the incoherent domain.\n$$\\sum_{j=1}^{1200}\\exp\\big(i\\theta_{j}\\big) = \\sum_{j=1}^{360}\\exp\\big(i\\theta_{j}\\big) + \\sum_{j=361}^{1200}\\exp\\big(i\\theta_{j}\\big)$$\n\nLet's evaluate the sum for the coherent domain. This subpopulation consists of $N_c = 360$ oscillators, indexed from $j=1$ to $j=360$. Their phases are all locked at $\\theta_{j}=0$ radians.\n$$\\sum_{j=1}^{360}\\exp\\big(i\\theta_{j}\\big) = \\sum_{j=1}^{360}\\exp(i \\cdot 0) = \\sum_{j=1}^{360} 1 = 360$$\nThe phasors for this group are all aligned along the positive real axis, and their sum is a real number equal to the number of oscillators in the group.\n\nNext, we evaluate the sum for the incoherent domain. This subpopulation consists of $N_i = 1200 - 360 = 840$ oscillators, indexed from $j=361$ to $j=1200$. Their phases are given by $\\theta_{j}=\\frac{2\\pi}{840}\\big(j-361\\big)$.\nTo simplify the sum, we introduce a new index $k = j-361$. When $j=361$, $k=0$. When $j=1200$, $k=1200-361=839$. The sum becomes:\n$$\\sum_{j=361}^{1200}\\exp\\left(i\\frac{2\\pi}{840}(j-361)\\right) = \\sum_{k=0}^{839}\\exp\\left(i\\frac{2\\pi k}{840}\\right)$$\nThe terms in this summation, $\\exp\\left(i\\frac{2\\pi k}{840}\\right)$ for $k=0, 1, \\dots, 839$, represent the complete set of the $840$-th roots of unity. Geometrically, these are $840$ vectors of unit length, equally spaced around the unit circle. The sum of these vectors is zero due to symmetry.\nThis can be formally shown by treating the sum as a finite geometric series, $\\sum_{k=0}^{n-1} ar^k = a\\frac{1-r^n}{1-r}$, with $a=1$, $n=840$, and the common ratio $r = \\exp\\left(i\\frac{2\\pi}{840}\\right)$. Since $n=840$, $r \\neq 1$.\n$$\\sum_{k=0}^{839} r^k = \\frac{1-r^{840}}{1-r} = \\frac{1-\\left(\\exp\\left(i\\frac{2\\pi}{840}\\right)\\right)^{840}}{1-\\exp\\left(i\\frac{2\\pi}{840}\\right)} = \\frac{1-\\exp(i2\\pi)}{1-\\exp\\left(i\\frac{2\\pi}{840}\\right)} = \\frac{1-1}{1-\\exp\\left(i\\frac{2\\pi}{840}\\right)} = 0$$\nThus, the sum over the incoherent domain evaluates to $0$.\n\nNow, we can combine the results for both domains to find the total sum:\n$$\\sum_{j=1}^{1200}\\exp\\big(i\\theta_{j}\\big) = 360 + 0 = 360$$\nSubstituting this into the definition of the global order parameter:\n$$Z = \\frac{1}{1200} (360) = \\frac{360}{1200} = \\frac{36}{120} = \\frac{3}{10}$$\nThe complex mean is a real number, $Z = \\frac{3}{10}$. The magnitude $R$ is the absolute value of $Z$.\n$$R = \\left|\\frac{3}{10}\\right| = \\frac{3}{10}$$\n\nFor the second part of the problem, we explain why the global order parameter $R$ is an insufficient diagnostic for a chimera state.\nThe global order parameter $R$ is fundamentally a macroscopic measure obtained by averaging over the entire population of oscillators. By its definition as a mean, it reduces the detailed phase configuration of all $N$ oscillators to a single complex number.\nIn the provided problem, the system exhibits a starkly heterogeneous structure: a fully coherent subpopulation coexisting with a fully incoherent one. We can analyze this by considering the order parameters for each subpopulation.\nLet $Z_c$ be the order parameter for the coherent group of $N_c = 360$ oscillators, and $Z_i$ be the order parameter for the incoherent group of $N_i = 840$ oscillators.\n$$Z_c = \\frac{1}{N_c}\\sum_{j=1}^{360}\\exp\\big(i\\theta_j\\big) = \\frac{1}{360} \\sum_{j=1}^{360}\\exp(i \\cdot 0) = \\frac{360}{360} = 1$$\n$$Z_i = \\frac{1}{N_i}\\sum_{j=361}^{1200}\\exp\\big(i\\theta_j\\big) = \\frac{1}{840} \\sum_{k=0}^{839}\\exp\\left(i\\frac{2\\pi k}{840}\\right) = \\frac{0}{840} = 0$$\nThe magnitude of the local order parameter for the coherent group is $R_c = |Z_c| = 1$, indicating perfect phase synchrony. For the incoherent group, the magnitude is $R_i = |Z_i| = 0$, indicating perfect asynchrony.\nThe global order parameter $Z$ can be expressed as a weighted average of the subpopulation order parameters:\n$$Z = \\frac{1}{N}\\left(N_c Z_c + N_i Z_i\\right) = \\frac{N_c}{N}Z_c + \\frac{N_i}{N}Z_i$$\n$$Z = \\frac{360}{1200}(1) + \\frac{840}{1200}(0) = \\frac{3}{10}$$\nThe result $R = |Z| = \\frac{3}{10}$ is an intermediate value between $0$ and $1$. The critical flaw of the global measure $R$ is that it cannot distinguish this specific chimera state from a completely different, spatially homogeneous state. For example, a network of $1200$ oscillators could be in a state of partial synchrony, where every oscillator has roughly the same level of phase coherence, leading to a global order parameter of $R = \\frac{3}{10}$. Such a state would be dynamically and structurally distinct from a chimera state, yet it would yield the same value for the global diagnostic.\nTherefore, a single scalar value $R$ intrinsically averages out and obscures the spatial information about the coexistence of distinct dynamical behaviors (coherence and incoherence in different regions of the network), which is the defining characteristic of a chimera state. Resolving such states requires local or spatially-resolved measures that can capture this heterogeneity.",
            "answer": "$$\\boxed{\\frac{3}{10}}$$"
        },
        {
            "introduction": "Having recognized the limitations of global metrics, the next step is to develop a quantitative toolkit to diagnose chimera states from phase data. This hands-on exercise  guides you through the process of implementing such a toolkit, from calculating the local order parameter $r_i$ to classifying regions and counting domain boundaries. Mastering this analysis pipeline is a crucial skill for identifying and characterizing these complex patterns in both simulation output and experimental data.",
            "id": "4117507",
            "problem": "You are given snapshots of oscillator phases on a one-dimensional ring network and asked to compute the local coherence, the fraction of spatial incoherence, and a chimera index, then decide whether each snapshot qualifies as a chimera under specified thresholds. The ring has $N$ oscillators with phases $\\theta_i$ in radians at a single time, indexed by $i \\in \\{0,1,\\dots,N-1\\}$, with periodic boundary conditions.\n\nDefinitions to use:\n\n1. Local Kuramoto order parameter. For each index $i$, and given an integer neighborhood half-width $L \\ge 0$, define\n$$\nr_i = \\left| \\frac{1}{2L+1} \\sum_{j=-L}^{L} e^{\\mathrm{i}\\,\\theta_{(i+j) \\bmod N}} \\right| .\n$$\nThis measures the local coherence of phases around node $i$.\n\n2. Spatial incoherence. Given a coherence threshold $r_{\\mathrm{thr}} \\in [0,1]$, define a binary classification at each node with the rule:\n$$\n\\text{node } i \\text{ is incoherent if } r_i < r_{\\mathrm{thr}}, \\quad \\text{and coherent otherwise}.\n$$\nLet $b_i$ be $1$ if node $i$ is incoherent and $0$ otherwise. The spatial incoherence is then\n$$\nSI = \\frac{1}{N} \\sum_{i=0}^{N-1} b_i .\n$$\n\n3. Chimera index on a ring. Define the chimera index $X$ as the number of contiguous incoherent clusters on the ring. Formally, with periodic indexing,\n$$\nX = \n\\begin{cases}\n0, & \\text{if } SI = 0, \\\\\n1, & \\text{if } SI = 1, \\\\\n\\sum_{i=0}^{N-1} \\left[ b_i = 1 \\wedge b_{(i-1) \\bmod N} = 0 \\right], & \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\left[\\cdot\\right]$ denotes the indicator that the logical condition inside is true.\n\n4. Chimera qualification. Given thresholds $SI_{\\min}$, $SI_{\\max}$ with $0 \\le SI_{\\min} < SI_{\\max} \\le 1$ and a minimal domain count $X_{\\min} \\in \\mathbb{N}$, declare the snapshot a chimera if and only if\n$$\nSI_{\\min} < SI < SI_{\\max} \\quad \\text{and} \\quad X \\ge X_{\\min}.\n$$\n\nAngle unit is radians. There are no physical units to report. For numerical reporting, round each $r_i$ and $SI$ to $4$ decimal places. The final output for each test case must be a list of the form\n$$\n[\\,[r_0,\\dots,r_{N-1}],\\, SI,\\, X,\\, \\text{chimera\\_bool}\\,],\n$$\nwhere $[r_0,\\dots,r_{N-1}]$ is the list of rounded local order parameters, $SI$ is the rounded spatial incoherence, $X$ is the integer chimera index, and $\\text{chimera\\_bool}$ is a boolean. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$).\n\nTest Suite. Use the following $5$ test cases:\n\n- Case A (uniform coherence):\n  - $N = 12$, $L = 2$, $r_{\\mathrm{thr}} = 0.95$, $SI_{\\min} = 0.05$, $SI_{\\max} = 0.95$, $X_{\\min} = 1$.\n  - Phases: $\\theta_i = 0$ for all $i$.\n\n- Case B (splay state, high incoherence threshold):\n  - $N = 12$, $L = 2$, $r_{\\mathrm{thr}} = 0.8$, $SI_{\\min} = 0.05$, $SI_{\\max} = 0.95$, $X_{\\min} = 1$.\n  - Phases: $\\theta_i = \\frac{2\\pi i}{N}$ for $i=0,\\dots,N-1$.\n\n- Case C (single contiguous incoherent domain):\n  - $N = 20$, $L = 2$, $r_{\\mathrm{thr}} = 0.85$, $SI_{\\min} = 0.2$, $SI_{\\max} = 0.8$, $X_{\\min} = 1$.\n  - Phases: $\\theta_i = 0$ for $i = 0,\\dots,9$ and $\\theta_i = \\frac{2\\pi (i-10)}{10}$ for $i=10,\\dots,19$.\n\n- Case D (two incoherent domains separated by coherent islands):\n  - $N = 24$, $L = 2$, $r_{\\mathrm{thr}} = 0.85$, $SI_{\\min} = 0.3$, $SI_{\\max} = 0.9$, $X_{\\min} = 2$.\n  - Phases: $\\theta_i = 0$ for $i \\in \\{0,1,2,3,4,5,12,13,14,15,16,17\\}$; $\\theta_i = \\frac{2\\pi (i-6)}{6}$ for $i \\in \\{6,7,8,9,10,11\\}$; $\\theta_i = \\frac{2\\pi (i-18)}{6}$ for $i \\in \\{18,19,20,21,22,23\\}$.\n\n- Case E (alternating blocks producing multiple boundaries):\n  - $N = 16$, $L = 1$, $r_{\\mathrm{thr}} = 0.7$, $SI_{\\min} = 0.1$, $SI_{\\max} = 0.9$, $X_{\\min} = 2$.\n  - Phases: four blocks of size $4$ alternating between $0$ and a local ramp,\n    $\\theta_i = 0$ for $i \\in \\{0,1,2,3\\}$, $\\theta_i = \\frac{2\\pi (i-4)}{4}$ for $i \\in \\{4,5,6,7\\}$, $\\theta_i = 0$ for $i \\in \\{8,9,10,11\\}$, $\\theta_i = \\frac{2\\pi (i-12)}{4}$ for $i \\in \\{12,13,14,15\\}$.\n\nYour program must implement the computations as defined above and produce exactly one line of output containing a list of the five results, each result itself being a list $[\\,[r_0,\\dots,r_{N-1}],\\, SI,\\, X,\\, \\text{chimera\\_bool}\\,]$ with the specified rounding.",
            "solution": "The problem requires the analysis of several snapshots of oscillator phases on a one-dimensional ring network to determine if they represent chimera states. This analysis involves computing a set of standard metrics: the local Kuramoto order parameter, the spatial incoherence, and a chimera index. Based on these metrics and a set of given thresholds, a final classification is made. The process is deterministic and follows from the provided mathematical definitions.\n\nThe foundation of the analysis rests on the concept of local synchronization. The Kuramoto order parameter is a standard measure of phase coherence. Its local version, $r_i$, assesses the degree of synchrony within a specific neighborhood of an oscillator $i$. A value of $r_i=1$ signifies perfect local coherence (all neighboring phases are identical), while $r_i=0$ indicates maximal local incoherence.\n\nThe problem is valid as it is scientifically grounded in the established theory of complex systems and nonlinear dynamics, is mathematically well-posed with unambiguous definitions, and presents an objective, verifiable computational task. All data and parameters are provided, ensuring a unique solution for each test case.\n\nThe algorithmic procedure to solve the problem for each test case is as follows:\n\n**Step 1: Computation of the Local Kuramoto Order Parameter, $r_i$**\n\nFor each oscillator $i \\in \\{0, 1, \\dots, N-1\\}$, the local order parameter $r_i$ is computed based on the phases of its neighbors. The neighborhood is defined by a half-width $L$, including $2L+1$ oscillators centered at $i$. Due to the ring topology, indices are treated with modulo $N$ arithmetic. The formula is:\n$$\nr_i = \\left| \\frac{1}{2L+1} \\sum_{j=-L}^{L} e^{\\mathrm{i}\\,\\theta_{(i+j) \\bmod N}} \\right|\n$$\nEach term $e^{\\mathrm{i}\\,\\theta_k}$ is a phasor (a complex number of unit magnitude) in the complex plane, representing the state of oscillator $k$. The expression inside the modulus is the complex mean of the phasors in the neighborhood of $i$. The magnitude of this mean vector, $r_i$, quantifies the alignment of these phasors. If they are perfectly aligned (all phases equal), the mean vector has length $1$. If they are uniformly distributed, the mean vector approaches length $0$. This calculation is performed for all $N$ oscillators, yielding a list of local coherence values $[r_0, r_1, \\dots, r_{N-1}]$. Per the problem specification, each $r_i$ is rounded to $4$ decimal places for reporting.\n\n**Step 2: Classification of Nodes and Computation of Spatial Incoherence, $SI$**\n\nUsing the computed $r_i$ values, each oscillator is classified as either coherent or incoherent. A threshold $r_{\\mathrm{thr}}$ is used for this binary classification. An oscillator $i$ is deemed incoherent if its local coherence $r_i$ is less than $r_{\\mathrm{thr}}$. We define a binary indicator variable $b_i$:\n$$\nb_i = \\begin{cases} 1 & \\text{if } r_i < r_{\\mathrm{thr}} \\\\ 0 & \\text{if } r_i \\ge r_{\\mathrm{thr}} \\end{cases}\n$$\nThe spatial incoherence, $SI$, is the fraction of the total number of oscillators that are classified as incoherent. It is the mean of the binary indicators:\n$$\nSI = \\frac{1}{N} \\sum_{i=0}^{N-1} b_i\n$$\nThe value of $SI$ ranges from $0$ (all oscillators coherent) to $1$ (all oscillators incoherent). This value is also rounded to $4$ decimal places for the output.\n\n**Step 3: Computation of the Chimera Index, $X$**\n\nThe chimera index $X$ quantifies the spatial organization of the coherent and incoherent domains by counting the number of distinct, contiguous incoherent clusters. On a ring, this is equivalent to counting the number of interfaces between coherent and incoherent regions. The definition is given as:\n$$\nX = \n\\begin{cases}\n0, & \\text{if } SI = 0 \\text{ (no incoherent nodes)} \\\\\n1, & \\text{if } SI = 1 \\text{ (all nodes incoherent)} \\\\\n\\sum_{i=0}^{N-1} \\left[ b_i = 1 \\wedge b_{(i-1) \\bmod N} = 0 \\right], & \\text{otherwise}\n\\end{cases}\n$$\nThe general case counts the number of \"rising edges\" in the binary sequence $b$ when viewed on the circular ring, which precisely corresponds to the number of incoherent clusters. The special cases for $SI=0$ and $SI=1$ handle the uniform states of full coherence and full incoherence, respectively. A fully incoherent state is considered to have a single cluster.\n\n**Step 4: Chimera State Qualification**\n\nA state is classified as a chimera based on a two-part logical condition. This condition ensures that the state exhibits a non-trivial mixture of coherence and incoherence ($SI_{\\min} < SI < SI_{\\max}$) and that these domains are sufficiently organized into a minimum number of clusters ($X \\ge X_{\\min}$). The boolean variable `chimera_bool` is determined by:\n$$\n\\text{chimera\\_bool} = (SI_{\\min} < SI < SI_{\\max}) \\wedge (X \\ge X_{\\min})\n$$\nThe unrounded value of $SI$ is used for this comparison to avoid artifacts from rounding.\n\nThis four-step procedure is applied to each of the five test cases provided. The final output is an aggregation of the results from each case, formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef stringify(v):\n    \"\"\"\n    Custom function to convert a Python object to a string representation\n    without spaces, as suggested by the problem's output format examples.\n    \"\"\"\n    if isinstance(v, list):\n        return '[' + ','.join(stringify(x) for x in v) + ']'\n    if isinstance(v, bool):\n        return 'True' if v else 'False'\n    return str(v)\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"params\": {\"N\": 12, \"L\": 2, \"r_thr\": 0.95, \"SI_min\": 0.05, \"SI_max\": 0.95, \"X_min\": 1},\n            \"phases_func\": lambda N: np.zeros(N)\n        },\n        {\n            \"params\": {\"N\": 12, \"L\": 2, \"r_thr\": 0.8, \"SI_min\": 0.05, \"SI_max\": 0.95, \"X_min\": 1},\n            \"phases_func\": lambda N: 2 * np.pi * np.arange(N) / N\n        },\n        {\n            \"params\": {\"N\": 20, \"L\": 2, \"r_thr\": 0.85, \"SI_min\": 0.2, \"SI_max\": 0.8, \"X_min\": 1},\n            \"phases_func\": lambda N: np.concatenate([\n                np.zeros(10),\n                2 * np.pi * np.arange(10) / 10\n            ])\n        },\n        {\n            \"params\": {\"N\": 24, \"L\": 2, \"r_thr\": 0.85, \"SI_min\": 0.3, \"SI_max\": 0.9, \"X_min\": 2},\n            \"phases_func\": lambda N: (\n                lambda p: (\n                    p.put(list(range(6, 12)), 2 * np.pi * np.arange(6) / 6),\n                    p.put(list(range(18, 24)), 2 * np.pi * np.arange(6) / 6),\n                    p\n                )[-1]\n            )(np.zeros(N))\n        },\n        {\n            \"params\": {\"N\": 16, \"L\": 1, \"r_thr\": 0.7, \"SI_min\": 0.1, \"SI_max\": 0.9, \"X_min\": 2},\n            \"phases_func\": lambda N: (\n                lambda p: (\n                    p.put(list(range(4, 8)), 2 * np.pi * np.arange(4) / 4),\n                    p.put(list(range(12, 16)), 2 * np.pi * np.arange(4) / 4),\n                    p\n                )[-1]\n            )(np.zeros(N))\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        params = case[\"params\"]\n        N, L = params[\"N\"], params[\"L\"]\n        r_thr, SI_min, SI_max, X_min = params[\"r_thr\"], params[\"SI_min\"], params[\"SI_max\"], params[\"X_min\"]\n        \n        phases = case[\"phases_func\"](N)\n        \n        # Step 1: Compute local order parameters r_i\n        r_vals_unrounded = []\n        neighborhood_size = 2 * L + 1\n        for i in range(N):\n            indices = (i + np.arange(-L, L + 1)) % N\n            neighborhood_phases = phases[indices]\n            \n            # Sum of phasors e^(i*theta)\n            phasor_sum = np.sum(np.exp(1j * neighborhood_phases))\n            \n            # Magnitude of the mean phasor\n            r_i = np.abs(phasor_sum / neighborhood_size)\n            r_vals_unrounded.append(r_i)\n        \n        r_vals_rounded = [round(r, 4) for r in r_vals_unrounded]\n\n        # Step 2: Compute spatial incoherence SI\n        b = np.array([1 if r < r_thr else 0 for r in r_vals_unrounded])\n        si_unrounded = np.mean(b)\n        si_rounded = round(si_unrounded, 4)\n\n        # Step 3: Compute chimera index X\n        if si_unrounded == 0:\n            X = 0\n        elif si_unrounded == 1:\n            X = 1\n        else:\n            # Count rising edges (0 -> 1) on the ring\n            b_shifted = np.roll(b, 1)\n            X = np.sum((b == 1) & (b_shifted == 0))\n\n        # Step 4: Chimera qualification\n        chimera_bool = (SI_min < si_unrounded < SI_max) and (X >= X_min)\n\n        # Assemble result for the case\n        result = [r_vals_rounded, si_rounded, X, chimera_bool]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The custom stringify function ensures a compact representation.\n    print(stringify(results))\n\nsolve()\n```"
        },
        {
            "introduction": "Now that we know what a chimera state is and how to diagnose it, the final step is to understand its origins. This practice shifts focus from analysis to synthesis, challenging you to numerically simulate a network of oscillators from first principles. By exploring how coupling parameters influence the system's evolution, you will gain first-hand experience with the spontaneous symmetry-breaking that gives rise to these remarkable hybrid states .",
            "id": "4117497",
            "problem": "You are tasked with constructing and analyzing a two-population network of phase oscillators to identify conditions under which a chimera state emerges. Begin from the Kuramoto–Sakaguchi model, in which each oscillator is characterized by its phase and interacts with all others in its own population and the other population via sinusoidal coupling with a phase-lag. Consider two populations indexed by $\\sigma \\in \\{1,2\\}$, each containing $N$ oscillators with phases $\\theta_{\\sigma,i}(t)$ for $i \\in \\{1,\\dots,N\\}$. The dynamical equations are\n$$\n\\frac{d\\theta_{1,i}}{dt} \\;=\\; \\omega \\;+\\; \\frac{K_{11}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{1,j} - \\theta_{1,i} - \\alpha\\big) \\;+\\; \\frac{K_{12}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{2,j} - \\theta_{1,i} - \\alpha\\big),\n$$\n$$\n\\frac{d\\theta_{2,i}}{dt} \\;=\\; \\omega \\;+\\; \\frac{K_{22}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{2,j} - \\theta_{2,i} - \\alpha\\big) \\;+\\; \\frac{K_{21}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{1,j} - \\theta_{2,i} - \\alpha\\big),\n$$\nwhere $\\omega$ is the common natural frequency, $K_{11}$ and $K_{22}$ are intra-population coupling strengths, $K_{12}$ and $K_{21}$ are inter-population coupling strengths, and $\\alpha$ is the phase-lag. Define the complex order parameter for each population by\n$$\nZ_{\\sigma}(t) \\;=\\; \\frac{1}{N}\\sum_{j=1}^{N} e^{\\,i\\theta_{\\sigma,j}(t)} \\;=\\; r_{\\sigma}(t)e^{\\,i\\psi_{\\sigma}(t)},\n$$\nwhere $r_{\\sigma}(t) \\in [0,1]$ is the magnitude and $\\psi_{\\sigma}(t)$ is the mean phase of population $\\sigma$. The instantaneous frequency of oscillator $i$ in population $\\sigma$ at time $t$ is defined as\n$$\n\\Omega_{\\sigma,i}(t) \\;=\\; \\frac{d\\theta_{\\sigma,i}}{dt}(t).\n$$\n\nYour program must:\n- Implement the dynamics in angle units specified in radians and evolve the system from an explicitly stated set of initial conditions.\n- Use a fixed number of oscillators $N = 64$ per population, a uniform natural frequency $\\omega = 0$, a fixed total simulation time $T = 80$ (dimensionless time units), and a fixed time step $\\Delta t = 0.02$.\n- Initialize phases as follows: for population $1$, set $\\theta_{1,i}(0)$ independently from a normal distribution with mean $0$ and standard deviation $0.1$; for population $2$, set $\\theta_{2,i}(0)$ independently from a uniform distribution on $[-\\pi,\\pi]$. Use a fixed pseudorandom number generator seed $12345$ for reproducibility.\n- Integrate the dynamics using a numerically stable explicit scheme that does not rely on shortcuts; for example, use the classical fourth-order Runge–Kutta method with angle wrapping after each step into $[-\\pi,\\pi]$.\n- After integrating to time $T$, compute $r_{1}(T)$, $r_{2}(T)$, the standard deviations $\\sigma_{\\Omega_1}$ and $\\sigma_{\\Omega_2}$ of $\\{\\Omega_{1,i}(T)\\}_{i=1}^{N}$ and $\\{\\Omega_{2,i}(T)\\}_{i=1}^{N}$, respectively, and decide whether a chimera is present according to the coexistence criterion below.\n\nCoexistence criterion for a chimera state: declare that a chimera is present if and only if, for some labeling of populations, one population is coherent and the other is incoherent, where \"coherent\" and \"incoherent\" are determined by the following thresholds:\n- Coherent population: $r_{\\sigma}(T) \\ge \\rho_{\\text{high}}$ and $\\sigma_{\\Omega_\\sigma} \\le \\sigma_{\\text{low}}$,\n- Incoherent population: $r_{\\sigma}(T) \\le \\rho_{\\text{low}}$ and $\\sigma_{\\Omega_\\sigma} \\ge \\sigma_{\\text{high}}$,\nwith fixed thresholds $\\rho_{\\text{high}} = 0.95$, $\\rho_{\\text{low}} = 0.70$, $\\sigma_{\\text{low}} = 0.05$, $\\sigma_{\\text{high}} = 0.15$. Use these thresholds exactly as stated.\n\nYour program must evaluate the following test suite of parameter values $(K_{11},K_{22},K_{12},K_{21},\\alpha)$:\n- Test $1$: $(1.0, 1.0, 0.2, 0.2, 1.5)$,\n- Test $2$: $(1.0, 1.0, 0.8, 0.8, 1.5)$,\n- Test $3$: $(0.2, 0.2, 0.2, 0.2, 1.5)$,\n- Test $4$: $(1.0, 1.0, 0.5, 0.5, 1.5)$.\n\nFor each test case, compute and return the list $[r_1(T), r_2(T), \\sigma_{\\Omega_1}, \\sigma_{\\Omega_2}, \\mathrm{chimera}]$, where $r_1(T)$ and $r_2(T)$ are floats in radians-based units (dimensionless), $\\sigma_{\\Omega_1}$ and $\\sigma_{\\Omega_2}$ are floats (dimensionless), and $\\mathrm{chimera}$ is a boolean indicating whether the coexistence criterion is satisfied. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case represented as its own nested list, for example, $[[\\dots],[\\dots],[\\dots],[\\dots]]$. Angles must be in radians. There are no physical units required beyond the stated dimensionless time units.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, and complete. All necessary components for a unique, verifiable solution are provided. We may therefore proceed with the solution.\n\nThe problem requires the numerical simulation of a two-population network of Kuramoto-Sakaguchi phase oscillators to identify parameter regimes that support chimera states. A chimera state is a spatio-temporal pattern in a network of identical oscillators where a subset of oscillators synchronizes while the remainder persists in an incoherent, desynchronized state.\n\nThe system is described by the following set of coupled ordinary differential equations (ODEs) for the phases $\\theta_{\\sigma,i}(t)$ of oscillator $i$ in population $\\sigma \\in \\{1,2\\}$:\n$$\n\\frac{d\\theta_{1,i}}{dt} \\;=\\; \\omega \\;+\\; \\frac{K_{11}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{1,j} - \\theta_{1,i} - \\alpha\\big) \\;+\\; \\frac{K_{12}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{2,j} - \\theta_{1,i} - \\alpha\\big)\n$$\n$$\n\\frac{d\\theta_{2,i}}{dt} \\;=\\; \\omega \\;+\\; \\frac{K_{22}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{2,j} - \\theta_{2,i} - \\alpha\\big) \\;+\\; \\frac{K_{21}}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{1,j} - \\theta_{2,i} - \\alpha\\big)\n$$\n\nA direct numerical integration of these equations would involve summations over all $N$ oscillators for each of the $2N$ oscillators at every substep of the integration algorithm, resulting in a computational complexity of $O(N^2)$ per step. To create a more efficient simulation, we can reformulate the equations using the complex order parameter for each population $\\sigma$:\n$$\nZ_{\\sigma}(t) \\;=\\; r_{\\sigma}(t)e^{i\\psi_{\\sigma}(t)} \\;=\\; \\frac{1}{N}\\sum_{j=1}^{N} e^{i\\theta_{\\sigma,j}(t)}\n$$\nUsing the identity $\\sin(x) = \\text{Im}[e^{ix}]$, the summation terms in the ODEs can be rewritten. For example, for the first term in the first equation:\n$$\n\\frac{1}{N}\\sum_{j=1}^{N}\\sin(\\theta_{1,j} - \\theta_{1,i} - \\alpha) = \\frac{1}{N}\\sum_{j=1}^{N}\\text{Im}[e^{i(\\theta_{1,j} - \\theta_{1,i} - \\alpha)}] = \\text{Im}[e^{-i(\\theta_{1,i} + \\alpha)} \\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{1,j}}]\n$$\n$$\n= \\text{Im}[e^{-i(\\theta_{1,i} + \\alpha)} r_1(t)e^{i\\psi_1(t)}] = r_1(t)\\sin(\\psi_1(t) - \\theta_{1,i} - \\alpha)\n$$\nApplying this simplification to all sums, the system of ODEs becomes:\n$$\n\\frac{d\\theta_{1,i}}{dt} = \\omega + K_{11} r_1 \\sin(\\psi_1 - \\theta_{1,i} - \\alpha) + K_{12} r_2 \\sin(\\psi_2 - \\theta_{1,i} - \\alpha)\n$$\n$$\n\\frac{d\\theta_{2,i}}{dt} = \\omega + K_{22} r_2 \\sin(\\psi_2 - \\theta_{2,i} - \\alpha) + K_{21} r_1 \\sin(\\psi_1 - \\theta_{2,i} - \\alpha)\n$$\nThis formulation reduces the computational complexity to $O(N)$ per time step, as it only requires calculating the two order parameters ($Z_1, Z_2$) before evaluating the derivatives for all $2N$ oscillators.\n\nThe system is integrated numerically from $t=0$ to $t=T=80$ using the classical fourth-order Runge-Kutta (RK4) method with a fixed time step of $\\Delta t=0.02$. The state of the system is a vector of $2N$ phases, $[\\theta_{1,1},\\dots,\\theta_{1,N},\\theta_{2,1},\\dots,\\theta_{2,N}]$. After each full RK4 step, the phases are wrapped to the interval $[-\\pi, \\pi]$ to prevent numerical overflow and maintain consistency. The system parameters are set to $N=64$ oscillators per population and a common natural frequency $\\omega=0$.\n\nFor reproducibility, the initial conditions are generated using a pseudorandom number generator with a fixed seed of $12345$. The initial phases for population $1$ are drawn from a normal distribution with mean $0$ and standard deviation $0.1$, i.e., $\\theta_{1,i}(0) \\sim \\mathcal{N}(0, 0.1^2)$. This prepares the first population in a state of high coherence. The initial phases for population $2$ are drawn from a uniform distribution on $[-\\pi, \\pi]$, i.e., $\\theta_{2,i}(0) \\sim \\mathcal{U}[-\\pi, \\pi]$, which corresponds to a fully incoherent state.\n\nAfter the simulation reaches the final time $T=80$, a set of metrics is computed to classify the final state. These are the magnitudes of the order parameters, $r_1(T)$ and $r_2(T)$, and the standard deviations of the instantaneous frequencies, $\\sigma_{\\Omega_1}$ and $\\sigma_{\\Omega_2}$. The instantaneous frequencies, $\\Omega_{\\sigma,i}(T)$, are calculated by evaluating the right-hand side of the ODEs at the final time $T$.\n\nA chimera state is identified based on a strict coexistence criterion. A population $\\sigma$ is \"coherent\" if its order parameter is high and its frequency dispersion is low ($r_{\\sigma}(T) \\ge \\rho_{\\text{high}}=0.95$ and $\\sigma_{\\Omega_\\sigma} \\le \\sigma_{\\text{low}}=0.05$). A population is \"incoherent\" if its order parameter is low and its frequency dispersion is high ($r_{\\sigma}(T) \\le \\rho_{\\text{low}}=0.70$ and $\\sigma_{\\Omega_\\sigma} \\ge \\sigma_{\\text{high}}=0.15$). A chimera is declared to exist if and only if one population is coherent and the other is incoherent according to these exact thresholds.\n\nThe algorithm proceeds by iterating through each parameter set provided in the test suite. For each set, it performs the initialization, numerical integration, and final analysis as described. The resulting five values—$[r_1(T), r_2(T), \\sigma_{\\Omega_1}, \\sigma_{\\Omega_2}, \\text{chimera status}]$—are stored. Finally, the collected results for all test cases are formatted into a single string representing a list of lists and printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-population Kuramoto-Sakaguchi model to find chimera states.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 64          # Number of oscillators per population\n    omega = 0.0     # Natural frequency\n    T = 80.0        # Total simulation time\n    dt = 0.02       # Time step\n\n    # Chimera detection thresholds\n    rho_high = 0.95\n    rho_low = 0.70\n    sigma_low = 0.05\n    sigma_high = 0.15\n\n    # Test cases: (K11, K22, K12, K21, alpha)\n    test_cases = [\n        (1.0, 1.0, 0.2, 0.2, 1.5),\n        (1.0, 1.0, 0.8, 0.8, 1.5),\n        (0.2, 0.2, 0.2, 0.2, 1.5),\n        (1.0, 1.0, 0.5, 0.5, 1.5),\n    ]\n\n    # --- Helper Functions ---\n\n    def wrap_angles(angles):\n        \"\"\"Wrap angles to the interval [-pi, pi].\"\"\"\n        return (angles + np.pi) % (2 * np.pi) - np.pi\n\n    def derivatives(thetas, N, K11, K22, K12, K21, alpha, omega):\n        \"\"\"\n        Calculates the time derivatives of the phases (d(theta)/dt).\n        \n        This function uses the efficient formulation based on order parameters.\n        \"\"\"\n        thetas1 = thetas[:N]\n        thetas2 = thetas[N:]\n\n        # Calculate complex order parameters\n        Z1 = np.mean(np.exp(1j * thetas1))\n        Z2 = np.mean(np.exp(1j * thetas2))\n\n        # Extract magnitudes (r) and mean phases (psi)\n        r1, psi1 = np.abs(Z1), np.angle(Z1)\n        r2, psi2 = np.abs(Z2), np.angle(Z2)\n\n        # Calculate derivatives for each population\n        d_thetas1 = omega + K11 * r1 * np.sin(psi1 - thetas1 - alpha) \\\n                          + K12 * r2 * np.sin(psi2 - thetas1 - alpha)\n        \n        d_thetas2 = omega + K22 * r2 * np.sin(psi2 - thetas2 - alpha) \\\n                          + K21 * r1 * np.sin(psi1 - thetas2 - alpha)\n        \n        return np.concatenate((d_thetas1, d_thetas2))\n\n    # --- Main Simulation Loop ---\n\n    results = []\n    \n    for case in test_cases:\n        K11, K22, K12, K21, alpha = case\n\n        # Initialize phases with a fixed seed for reproducibility\n        rng = np.random.default_rng(12345)\n        thetas1_0 = rng.normal(loc=0.0, scale=0.1, size=N)\n        thetas2_0 = rng.uniform(low=-np.pi, high=np.pi, size=N)\n        thetas = wrap_angles(np.concatenate((thetas1_0, thetas2_0)))\n\n        # RK4 Integration\n        num_steps = int(T / dt)\n        \n        # Define a closure for the derivative function with fixed parameters for the current case\n        f = lambda th: derivatives(th, N, K11, K22, K12, K21, alpha, omega)\n\n        for _ in range(num_steps):\n            # RK4 substeps\n            k1 = dt * f(thetas)\n            k2 = dt * f(wrap_angles(thetas + 0.5 * k1))\n            k3 = dt * f(wrap_angles(thetas + 0.5 * k2))\n            k4 = dt * f(wrap_angles(thetas + k3))\n            \n            # Update step\n            thetas = wrap_angles(thetas + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0)\n\n        # --- Final Analysis ---\n\n        # Separate final phases\n        thetas1_T = thetas[:N]\n        thetas2_T = thetas[N:]\n\n        # Calculate final order parameter magnitudes\n        r1_T = np.abs(np.mean(np.exp(1j * thetas1_T)))\n        r2_T = np.abs(np.mean(np.exp(1j * thetas2_T)))\n\n        # Calculate final instantaneous frequencies and their standard deviations\n        final_omegas = f(thetas) # This is d(theta)/dt at T\n        omegas1_T = final_omegas[:N]\n        omegas2_T = final_omegas[N:]\n        \n        s_om1 = np.std(omegas1_T)\n        s_om2 = np.std(omegas2_T)\n        \n        # Apply chimera criterion\n        pop1_coherent = (r1_T >= rho_high) and (s_om1 <= sigma_low)\n        pop1_incoherent = (r1_T <= rho_low) and (s_om1 >= sigma_high)\n\n        pop2_coherent = (r2_T >= rho_high) and (s_om2 <= sigma_low)\n        pop2_incoherent = (r2_T <= rho_low) and (s_om2 >= sigma_high)\n\n        is_chimera = (pop1_coherent and pop2_incoherent) or \\\n                     (pop1_incoherent and pop2_coherent)\n        \n        results.append([r1_T, r2_T, s_om1, s_om2, is_chimera])\n\n    # Final print statement in the exact required format.\n    # The template format print(f\"[{','.join(map(str, results))}]\") is used.\n    # This stringifies each inner list and joins them with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}