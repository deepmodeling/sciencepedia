## 引言
随着半导体技术不断向更小的技术节点迈进，尤其是在极紫外（EUV）[光刻](@entry_id:158096)时代，精确预测和控制光在纳米结构中的行为已成为延续摩尔定律的关键挑战。传统的基于[标量衍射理论](@entry_id:194697)的[光学模型](@entry_id:161345)，在处理与波长相当的特征尺寸、具有显著物理厚度的掩模以及大角度[斜入射](@entry_id:267188)照明时，已显得力不从心。这种理论与实践的脱节，凸显了转向基于麦克斯韦方程组的严格三维电磁与多层膜建模的迫切性。

本文旨在系统性地阐述这一核心领域。我们将带领读者深入理解从基本物理原理到尖端工程应用的完整知识体系。通过学习本文，您将能够洞悉现代[光刻仿真](@entry_id:1127362)背后的物理本质，并掌握分析复杂电磁效应的核心方法。

文章将分为三个核心部分展开。在“原理与机制”一章中，我们将建立起对EUV材料光学响应、多层膜[反射原理](@entry_id:148504)以及掩模三维效应（如阴影效应）的物理理解，并介绍求解这些问题的关键数值方法。接着，在“应用与跨学科连接”一章中，我们将展示这些理论模型如何在光学元件设计、成像仿真、计量学以及与材料科学的交叉领域中发挥关键作用。最后，通过“动手实践”部分，您将有机会将理论知识应用于具体的计算问题，从而巩固和深化您的理解。

## 原理与机制

本章深入探讨了在先进[光刻](@entry_id:158096)工艺中，对三维掩模和多层[膜结构](@entry_id:1127775)进行电磁建模所需的核心物理原理和关键机制。我们将从材料在极紫外（EUV）波段的基本电磁响应出发，逐步构建对复杂多层膜反射镜的理解。随后，我们将阐明为何经典光学近似在现代光刻中失效，并详细剖析由掩模三维形貌与[斜入射](@entry_id:267188)照明共同引发的关键物理效应，如矢量衍射、偏振混合和掩模阴影效应。最后，我们将介绍用于精确求解这些复杂问题的先进数值方法，为后续章节中具体的工艺建模与仿真应用奠定理论基础。

### 电磁学基础：EUV材料的光学响应

在电磁学框架下，材料对光的响应通过其[本构关系](@entry_id:186508)来描述。对于线性、各向同性的非磁性介质，在频率域中（假设时间谐变因子为 $e^{-i\omega t}$），这些关系由[复介电常数](@entry_id:1122729) $\epsilon(\omega)$ 捕捉。该物理量是理解吸收和色散现象的关键。[复介电常数](@entry_id:1122729)通常写作：
$$ \epsilon(\omega) = \epsilon'(\omega) + i\epsilon''(\omega) $$
其中，实部 $\epsilon'(\omega)$ 与[电场能量](@entry_id:193072)的存储和波的相速度有关，而虚部 $\epsilon''(\omega)$ 则直接量化了材料中的能量耗散或吸收。

在光学和光刻建模中，使用[复折射率](@entry_id:268061) $m(\omega)$ 来描述材料特性更为常见：
$$ m(\omega) = n(\omega) + ik(\omega) $$
这里的 $n(\omega)$ 是传统的折射率，决定了光在介质中的相速度（$v_p = c/n(\omega)$），而 $k(\omega)$ 称为消光系数，量化了波在介质中传播时的振幅衰减。

这两个基本物理量通过麦克斯韦方程组联系在一起。从亥姆霍兹波动方程 $\nabla^2\mathbf{E} + \omega^2\mu_0\epsilon(\omega)\mathbf{E} = 0$ 和[平面波](@entry_id:189798)波数的定义 $k_{\text{medium}} = m(\omega) k_0 = m(\omega) \omega/c$ 可以推导出它们之间的精确关系 ：
$$ \epsilon(\omega) = \epsilon_0 [n(\omega) + ik(\omega)]^2 $$
将此表达式展开并分离实部和虚部，我们得到：
$$ \epsilon'(\omega) = \epsilon_0 [n^2(\omega) - k^2(\omega)] $$
$$ \epsilon''(\omega) = 2\epsilon_0 n(\omega)k(\omega) $$
这个关系式至关重要，它明确了[消光系数](@entry_id:270201) $k(\omega)$ 与介[电常数](@entry_id:272823)虚部 $\epsilon''(\omega)$ 的正比关系。$\epsilon''(\omega) > 0$（或等价地 $k(\omega) > 0$）是材料存在吸收的标志。

吸收的物理后果是[电磁波强度](@entry_id:177579)的指数衰减。一束[平面波](@entry_id:189798)在吸收介质中沿 $z$ 方向传播，其光强度 $I(z)$ 将遵循[比尔-朗伯定律](@entry_id:192870)：
$$ I(z) = I_0 \exp(-\alpha z) $$
其中 $\alpha$ 是吸收系数。该系数与消光系数 $k(\omega)$ 直接相关 ：
$$ \alpha = \frac{2\omega k(\omega)}{c} = \frac{4\pi k(\omega)}{\lambda} $$
$\lambda$ 是真空波长。此外，单位体积内的时间平均耗散功率密度 $p_{\text{abs}}$ 也直接由 $\epsilon''(\omega)$ 决定：
$$ p_{\text{abs}} = \frac{\omega\epsilon''(\omega)}{2}|\mathbf{E}|^2 $$
其中 $|\mathbf{E}|$ 是介质中电场振幅。在[EUV光刻](@entry_id:1124802)中，吸收体材料（如含钽化合物）的设计目标就是使其在 $13.5\,\mathrm{nm}$ 波长下具有足够大的 $k$ 值，以实现对光强的有效抑制。

### 多层膜反射镜：[布拉格反射](@entry_id:184358)原理

在EUV波长（$\lambda \approx 13.5\,\mathrm{nm}$）下，所有材料都表现出显著的吸收性，并且没有任何材料的单次界面[反射率](@entry_id:172768)足够高，以至于可以制造传统意义上的透镜或反射镜。为了克服这一挑战，[EUV光刻](@entry_id:1124802)系统采用了基于**[分布式布拉格反射镜](@entry_id:173772)（Distributed Bragg Reflector, DBR）**原理的反射光学元件。

一个典型的EUV掩模反射区由周期性堆叠的两种不同材料薄膜构成，通常是钼（Mo）和硅（Si）。其工作原理是利用在大量[材料界面](@entry_id:751731)上发生的微弱反射的[相干叠加](@entry_id:170209)。当来自每个界面的反射光波到达观测点时，如果它们的相位一致（即发生[相长干涉](@entry_id:276464)），总反射强度将被显著增强。

为了实现相长干涉，从相邻两个双层膜（例如，Si-Mo界面和下一个Si-Mo界面）反射的光波之间的[光程差](@entry_id:201533)必须是波长的整数倍。这便是**[布拉格条件](@entry_id:271151)**。对于[斜入射](@entry_id:267188)情况，该条件需要修正以考虑光在介质中的[折射](@entry_id:163428)。对于一级共振反射（$m=1$），修正后的[布拉格定律](@entry_id:140129)为 ：
$$ 2d \sqrt{\bar{n}^2 - \sin^2\theta_{\text{ext}}} = \lambda $$
其中 $d$ 是双层膜的周期厚度，$\lambda$ 是真空波长，$\theta_{\text{ext}}$ 是光波从真空（或近真空环境）入射到多层膜表面的入射角（相对于法线），而 $\bar{n}$ 是双层膜材料的平均[复折射率](@entry_id:268061)。

在[EUV光刻](@entry_id:1124802)系统中，掩模通常以一个偏离法线约 $\theta_{\text{ext}} = 6^\circ$ 的角度进行[斜入射](@entry_id:267188)照明。由于在EUV波段所有材料的[折射](@entry_id:163428)率 $n$ 都非常接近1，对于此入射角，可以使用近似的[布拉格条件](@entry_id:271151) $2d \cos\theta_{\text{ext}} = \lambda$ 来进行估算。例如，对于一个在 $\lambda=13.5\,\mathrm{nm}$ 和 $\theta_{\text{ext}}=6^\circ$ 下工作的反射镜，所需的多层膜周期 $d$ 约为 $6.8\,\mathrm{nm}$ 。这突显了多层膜的设计必须精确匹配特定的工作波长和入射角度。

### 多层膜系统的[散射矩阵](@entry_id:137017)方法

为了精确分析和设计由数十甚至数百个薄膜层构成的复杂多层[膜结构](@entry_id:1127775)，我们需要一种系统性的方法来计算其总体的反射和透射特性。**散射矩阵（S-matrix）方法**提供了一个强大且数值稳定的框架，尤其适用于严格耦合波分析（RCWA）等数值技术。

S-matrix方法将每一层（或层间界面）视为一个双端口网络 。端口1（通常是上端口）和端口2（下端口）分别对应于层的上方和下方。进入每个端口的波（入射波）和离开每个端口的波（出射波）的振幅被组织成向量。例如，在处理周期性结构时，这些向量的元素对应于不同[衍射级](@entry_id:174263)次的波的[复振幅](@entry_id:164138)。

对于单个均匀层 $j$，其[S矩阵](@entry_id:137017) $S_j$ 定义了出射波振幅向量 ($b_u^j, b_d^j$) 与入射波振幅向量 ($a_u^j, a_d^j$) 之间的线性关系：
$$
\begin{bmatrix}
b_{u}^{j} \\
b_{d}^{j}
\end{bmatrix}
=
\begin{bmatrix}
R_{uu}^{j}  T_{ud}^{j} \\
T_{du}^{j}  R_{dd}^{j}
\end{bmatrix}
\begin{bmatrix}
a_{u}^{j} \\
a_{d}^{j}
\end{bmatrix}
$$
这里，$a_u^j$ 是从上方入射到该层的波，$a_d^j$ 是从下方入射的波；$b_u^j$ 是向上反射离开的波，$b_d^j$ 是向下透射离开的波。矩阵块 $R_{uu}^j$ 和 $R_{dd}^j$ 分别是从上端口和下端口看进去的反射矩阵，而 $T_{du}^j$ 和 $T_{ud}^j$ 是从上到下和从下到上的透射矩阵。

该方法的最大优势在于其处理层叠结构的能力。两个相邻层（例如，[上层](@entry_id:198114)1和下层2）可以通过一个称为“Redheffer星形乘积”的代数运算法则组合成一个等效的单层。其核心思想是，层1的出射波 $b_d^1$ 成为层2的入射波 $a_u^2$，而层2的出射波 $b_u^2$ 成为层1的入射波 $a_d^1$。通过代数消元，可以推导出整个两层系统的总反射矩阵 $R_{uu}^{\text{tot}}$。例如，当光仅从最上方入射时（$a_d^2 = \mathbf{0}$），总的向上反射由下式给出 ：
$$ R_{uu}^{\text{tot}} = R_{uu}^{1} + T_{ud}^{1} (\mathbf{I} - R_{uu}^{2} R_{dd}^{1})^{-1} R_{uu}^{2} T_{du}^{1} $$
这个表达式在物理上非常直观：总反射等于第一层的直接反射 $R_{uu}^1$，加上穿过第一层、在两层之间发生多次反射（由矩阵逆 $(\mathbf{I} - R_{uu}^{2} R_{dd}^{1})^{-1}$ 项描述，这是一个[几何级数](@entry_id:158490)求和）、然后再次穿过第一层返回上方的所有波的总和。通过迭代应用此组合规则，可以从单个薄膜的S矩阵高效地计算出整个多层膜叠层的光学响应，这正是“多层膜建模”的核心计算引擎。

### 经典近似的局限性：三维电磁建模的必要性

在经典光学中，一个广泛使用的简化模型是**基尔霍夫[薄掩模近似](@entry_id:1133098)（Kirchhoff Thin-Mask Approximation, TMA）**。该近似将物理上具有厚度和复杂三维结构的掩模简化为一个无限薄的二维平面。这个平面的作用由一个空间变化的复透射函数 $t(x,y)$ 来描述，入射场乘以该函数即可得到出射场 。在最简单的形式中，对于二[进制](@entry_id:634389)掩模，$t(x,y)$ 在透[明区](@entry_id:273235)域为1，在不透[明区](@entry_id:273235)域为0。

这种[标量衍射](@entry_id:269469)模型之所以能够成立，依赖于一系列严格的物理条件：
1.  **特征尺寸远大于波长** ($d \gg \lambda$)：这确保了在特征边缘处的矢量衍射效应可以被忽略。
2.  **掩模在电磁学上是“薄”的** ($h \ll \lambda$，其中 $h$ 是吸收体厚度)：这保证了光波在穿过掩模时不会发生显著的波导或[共振效应](@entry_id:155120)。
3.  **近轴照明** ([数值孔径](@entry_id:138876) $\mathrm{NA} \ll 1$)：这保证了光的传播角度很小，使得电场的不同偏振分量可以被[解耦](@entry_id:160890)，并且纵向电场分量可以忽略不计。

然而，在现代光刻技术中，尤其是[EUV光刻](@entry_id:1124802)，这些条件无一满足。[EUV光刻](@entry_id:1124802)的波长 $\lambda$ 约为 $13.5\,\mathrm{nm}$，而特征尺寸 $d$ 和吸收体厚度 $h$（通常为 $50-70\,\mathrm{nm}$）都与波长处于同一量级，甚至更大。此外，EUV系统采用[高数值孔径](@entry_id:1126112)（high-NA）光学系统和固有的[斜入射](@entry_id:267188)照明。因此，$d \gg \lambda$ 和 $h \ll \lambda$ 的条件被严重违反。在这种情况下，将掩模视为一个简单的二维标量屏会产生巨大的误差，无法预测实际的成像结果。这揭示了进行严格的、基于[麦克斯韦方程组](@entry_id:150940)的**三维电磁建模**的绝对必要性。

### [EUV光刻](@entry_id:1124802)掩模中的三维效应物理学

严格的电磁建模揭示了一系列由掩模的三维物理结构与照明条件相互作用而产生的复杂效应。这些“掩模三维效应”（Mask 3D effects）对于理解和预测[EUV光刻](@entry_id:1124802)的成像性能至关重要。

#### EUV反射式掩模的结构与功能

一个现代EUV反射式掩模是一个复杂的工程结构，其每个组成部分都在成像中扮演着关键角色 。
*   **基板（Substrate）**：通常由低[热膨胀](@entry_id:137427)材料（LTEM）制成，为整个掩模提供机械支撑。其超高的平整度和形状精度（“图形”和“平坦度”）直接决定了反射波前的相位均匀性。任何表面的粗糙度或热形变都会转化为相位误差，从而降低成像质量。
*   **多层膜（Multilayer）**：如前所述，由大约40对Mo/Si双层膜构成的DBR，负责在 $13.5\,\mathrm{nm}$ 波长和特定入射角下提供高[反射率](@entry_id:172768)。它不仅设定了反射光场的振幅，其固有的复反射系数也为反射光场赋予了一个基准相位。
*   **覆盖层（Capping Layer）**：通常是几纳米厚的钌（Ru）层，覆盖在多层膜之上。它的主要功能是保护多层膜在等离子体清洗过程中免受损伤，并防止最顶层的硅被氧化。尽管其厚度远小于波长，但它在光学上绝非可以忽略。光波往返穿过该层会引入显著的相位偏移，并且其界面的反射会与多层膜的反射发生干涉，影响总体的[反射率](@entry_id:172768)和相位。
*   **吸收体堆栈（Absorber Stack）**：在覆盖层之上，通过[光刻](@entry_id:158096)工艺图形化的吸收体材料（如含Ta化合物）用于形成电[路图](@entry_id:274599)案。其作用是通过体吸收和[薄膜干涉](@entry_id:172980)效应（设计成[抗反射涂层](@entry_id:183793)）的结合，将指定区域的[反射率](@entry_id:172768)抑制到最低。吸收体的厚度和材料不仅决定了“暗”态的亮度，也决定了从其反射的光的相位。

#### 矢量衍射与偏振混合

当电磁波与尺寸与波长相当的结构相互作用时，其矢量特性变得至关重要。光是一种[横波](@entry_id:269527)，其电场矢量垂直于传播方向。我们可以将任意偏振状态的入射光分解为两个正交的基矢：**横电（Transverse Electric, TE）**偏振和**横磁（Transverse Magnetic, TM）**偏振 。TE偏振的定义是电场矢量垂直于入射面（由入射光[波矢](@entry_id:178620)和表面法线构成的平面），而TM偏振的电场矢量则平行于入射面。

对于一个完美的平面分层介质（无论有无吸收），TE和TM偏振是系统的[本征模](@entry_id:174677)。这意味着，一个纯TE偏振的入射波只会激发出TE偏振的反射和透射波，[TM波](@entry_id:272148)亦然，两者之间不会发生转换或“混合”。

然而，一旦掩模上存在三维图形（如吸收体线条或接触孔），这种对称性就被打破了。
*   对于一维光栅（如密集的线条），如果入射面垂直于光栅线（经典衍射），TE和TM仍然是[解耦](@entry_id:160890)的。但如果入射光束以一个角度射向光栅线（即**锥形衍射**），三维的几何结构就会耦合TE和TM分量，导致偏振混合 。
*   对于二维图形（如接触孔阵列），几乎所有非[正入射](@entry_id:260681)的照明都会导致TE和[TM模](@entry_id:266144)式的强烈耦合。在严格耦合波分析（RCWA）的数学语言中，这表现为介[电常数](@entry_id:272823)的傅里叶[谐波](@entry_id:181533)在[横向场](@entry_id:266489)分量之间引入了非对角耦合项，使得[散射矩阵](@entry_id:137017)不再是[块对角化](@entry_id:145518)的 。

这种偏振依赖的散射行为是EUV掩模三维效应的一个核心方面，它会导致不同偏振的照明产生不同的成像结果，影响成像对比度和工艺窗口。

#### 掩模阴影效应与成像偏移

在[EUV光刻](@entry_id:1124802)中，最显著的三维效应之一是**掩模阴影效应（mask shadowing）**。它源于两个关键事实的结合：EUV系统采用的**[斜入射](@entry_id:267188)**照明（例如，偏离[法线](@entry_id:167651) $6^\circ$）和吸收体具有的不可忽略的**物理高度**（例如，$h=60\,\mathrm{nm}$，是波长的4倍以上）。

当光以一个倾斜的角度照射到掩模上时，高耸的吸收体会在其一侧的反射性多层膜上投下“阴影”。这不仅仅是一个简单的几何遮挡，而是一个复杂的电磁现象  。其主要后果包括：
1.  **衍射不对称性**：对于一个周期性光栅（例如，间距为 $p$ 的线条），反射的[衍射级](@entry_id:174263)次的角度由[光栅方程](@entry_id:174509)决定：$\sin\theta_m = \sin\theta_i + m\lambda/p$，其中 $\theta_i$ 是[入射角](@entry_id:192705)，$\theta_m$ 是第 $m$ 级衍射角。在[斜入射](@entry_id:267188)（$\theta_i \neq 0$）下，正负衍射级次的角度不再对称，即 $\theta_{+1} \neq -\theta_{-1}$。
2.  **相位与振幅失衡**：由于 $\theta_{+1}$ 和 $\theta_{-1}$ 不同，这两个[衍射级](@entry_id:174263)次在多层膜上反射时，会“感受”到不同的复[反射系数](@entry_id:194350)，因为多层膜的[反射率](@entry_id:172768)和相位都是角度的函数。此外，由于入射场在吸收体开口内的分布本身就是倾斜和不均匀的，光与吸收体侧壁的相互作用对于 $+1$ 和 $-1$ 级次来说也是不对称的。这两方面共同导致了到达投影光学系统光瞳的 $+1$ 和 $-1$ 级衍射光在振幅（$A_+ \neq A_-$）和相位（$\phi_+ \neq \phi_-$）上都存在差异。
3.  **成像偏移（Image Placement Error）**：在由两个衍射光束（例如 $+1$ 和 $-1$ 级）干涉形成的空中成像中，其[强度分布](@entry_id:163068)为 $I(x) \propto |A_{+}|^2+|A_{-}|^2+2|A_{+}||A_{-}|\cos(2kx - \Delta\phi)$，其中 $\Delta\phi = \phi_{+} - \phi_{-}$。可以看出，[干涉条纹](@entry_id:176719)的位置由相位差 $\Delta\phi$ 决定。一个非零的 $\Delta\phi$ 会导致整个[干涉图](@entry_id:1126608)案发生横向偏移，偏移量为 $\delta x = \Delta\phi/(2k)$。振幅失衡主要影响条纹的对比度，而相位失衡则直接导致成像位置的错误 。

这种由阴影效应引起的成像偏移是间距依赖的（因为 $\Delta\phi$ 依赖于 $\theta_{\pm 1}$，而后者依赖于 $p$），并且是[EUV光刻](@entry_id:1124802)中一个主要的系统性误差来源，必须通过在掩模设计阶段进行预先补偿（[光学邻近校正](@entry_id:1129161)，OPC）来纠正。这再次凸显了三维电磁建模在预测和补偿这些效应中的核心地位。

### 严格电磁建模的数值方法

由于三维掩模与电磁场的相互作用极其复杂，无法通过解析方法求解，因此必须依赖强大的数值计算工具。这些工具直接求解[麦克斯韦方程组](@entry_id:150940)，以预测掩模的近场行为和[远场衍射](@entry_id:163878)谱。

#### 周期性结构的边界条件：布洛赫-[弗洛凯定理](@entry_id:175204)

许多数值方法为了提高[计算效率](@entry_id:270255)，仅模拟掩模图形的一个单元（unit cell），然后利用其周期性来构建整个掩模的解。这种方法要求在单元的侧向边界上施加正确的边界条件。对于一个在横向（如 $x,y$ 方向）具有周期性（周期为 $a_x, a_y$）的结构，在受到[平面波](@entry_id:189798)[斜入射](@entry_id:267188)时，其内部的电磁场并非严格周期，而是**[准周期性](@entry_id:272343)（quasi-periodic）**的。

根据**布洛赫-[弗洛凯定理](@entry_id:175204)**，对于任何横向[晶格平移矢量](@entry_id:197310) $\mathbf{R} = m_x a_x \hat{\mathbf{x}} + m_y a_y \hat{\mathbf{y}}$，场分量满足以下关系 ：
$$ \mathbf{E}(\mathbf{r}+\mathbf{R}) = \mathbf{E}(\mathbf{r}) e^{i\mathbf{k}_{\parallel} \cdot \mathbf{R}} $$
其中 $\mathbf{k}_{\parallel}$ 是一个常数矢量，称为[布洛赫波矢](@entry_id:746866)。在散射问题中，这个波矢由入射[平面波](@entry_id:189798)的横向波矢分量唯一确定。如果入射波的波矢为 $\mathbf{k}_{\text{inc}}$，则 $\mathbf{k}_{\parallel}$ 就是 $\mathbf{k}_{\text{inc}}$ 在 $xy$ 平面上的投影。例如，对于一个从[折射](@entry_id:163428)率为 $n_s$ 的介质中，以相对于 $z$ 轴的极角 $\theta$ 和[方位角](@entry_id:164011) $\phi$ 入射的平面波，其横向波矢为：
$$ \mathbf{k}_{\parallel} = k_0 n_s \sin\theta (\cos\phi\,\hat{\mathbf{x}} + \sin\phi\,\hat{\mathbf{y}}) $$
其中 $k_0=2\pi/\lambda$。因此，在模拟单元的相对边界之间（例如 $x=0$ 和 $x=a_x$），场值仅相差一个复相位因子 $e^{i k_x a_x}$。这个准[周期性边界条件](@entry_id:753346)是所有基于单元计算的严格电磁求解器（如RCWA和FDTD）的基石。

#### 频域与时域方法：RCWA与FDTD

在光刻建模领域，两种最主流的严格电磁求解器是严格耦合波分析（RCWA）和[时域有限差分法](@entry_id:141865)（FDTD）。

**严格耦合波分析（Rigorous Coupled-Wave Analysis, RCWA）**是一种频域方法，特别适用于模拟横向周期性的结构 。其核心思想是：
1.  将结构沿纵向（$z$ 方向）剖分成一系列薄层，在每个薄层内，介[电常数](@entry_id:272823)仅在横向（$x,y$ 方向）变化。
2.  在每个薄层内，将介[电常数](@entry_id:272823)和电磁场都展开成[傅里叶级数](@entry_id:139455)（即一系列平面[波的叠加](@entry_id:166456)）。
3.  将这些级数代入[麦克斯韦方程组](@entry_id:150940)，会得到一个关于[傅里叶系数](@entry_id:144886)的[代数特征值问题](@entry_id:169099)。其本征解代表了在该层中可以稳定传播的“模式”。
4.  通过在各层界面上强制电磁场切向分量的连续性（通常使用前述的S矩阵方法），将所有层的解“缝合”在一起，最终得到整个结构的反射和透射衍射谱。

RCWA对于模拟理想的周期性结构（如线条/空间阵列）和层状结构（如DBR多层膜）极为高效和精确。它直接在频域求解，对于[单色光](@entry_id:178750)照明的情况速度很快。然而，它对[非周期性](@entry_id:275873)结构（如孤立的缺陷）或非直线形貌（如圆角）的处理较为困难，通常需要采用超[晶胞](@entry_id:143489)（supercell）近似，这会增加计算成本。

**[时域有限差分法](@entry_id:141865)（Finite-Difference Time-Domain, FDTD）**则是一种时域方法，它在时间和空间上对麦克斯韦的旋度方程进行直接离散化 。
1.  它在一个三维网格（“Yee元胞”）上交错存储[电场和磁场](@entry_id:261347)分量。
2.  通过蛙跳式（leapfrog）时间步进算法，从初始状态出发，一步步地模拟电磁脉冲在空间中的传播和与物质的相互作用。
3.  通过对特定点的时域场信号进行傅里叶变换，可以得到宽[频谱](@entry_id:276824)范围内的[频率响应](@entry_id:183149)。

FDTD的最大优势在于其几何灵活性。它可以直接处理任意形状的结构，包括非周期性缺陷、掩模边缘、圆角和倾斜侧壁等。为了模拟开放区域，计算域的边界通常由**完美匹配层（Perfectly Matched Layer, PML）**[吸收边界条件](@entry_id:164672)所包围，以吸收出射波，防止虚假反射。然而，FDTD的计算成本非常高昂。在EUV波段，由于材料吸收强导致场在其中迅速衰减（[趋肤深度](@entry_id:270307)小），需要非常精细的空间网格来分辨场的变化。根据**Courant-Friedrichs-Lewy（CFL）**稳定性条件，精细的空间网格又要求极小的时间步长，这使得模拟时间变得非常长。

#### [积分方程方法](@entry_id:750697)：VIE与SIE简介

除了RCWA和FDTD，另一类强大的数值技术是**[积分方程](@entry_id:138643)（Integral Equation, IE）**方法。与[微分](@entry_id:158422)方程方法（如FDTD）对整个计算空间进行离散化不同，IE方法仅对物质所在区域或其边界进行离散化，从而可能减少未知数的数量。

**体积分方程（Volume Integral Equation, VIE）**方法将散射问题重新表述为求解物体内部的等效体电流或极化强度。例如，[Lippmann-Schwinger方程](@entry_id:142814)就是一种VIE，它将散射体内的总电场表示为入射场与由体极化强度产生的散射场之和。离散化后，未知数是定义在物体内部每个小体积单元（voxel）上的[极化强度](@entry_id:188176)，因此未知数总数与物体体积成正比 。VIE的一个理论优势是其算子具有 $\mathcal{I}-\mathcal{K}$ 的形式（$\mathcal{I}$是单位算符，$\mathcal{K}$是[紧算子](@entry_id:139189)），这使其成为一个第二类[Fredholm方程](@entry_id:266485)，通常具有良好的数学性质，例如在低频时非常稳定。然而，对于高[折射率对比度](@entry_id:159842)的材料，其数值性能可能会下降。

**面积分方程（Surface Integral Equation, SIE）**方法则利用电磁等效性原理，将物体内部的场用其边界上的等效面电流（$\mathbf{J}_s$）和面磁流（$\mathbf{M}_s$）来表示。未知数仅定义在不同材料的交界面上。对于一个薄的、平坦的特征，其表面积远小于其体积，因此SIE的未知数数量通常远少于VIE，尤其是在需要用多个网格单元来分辨厚度的情况下 。现代SIE求解器，如PMCHWT方法，通过恰当地组合边界上的场和其法向导数，可以构建出同样具有第二[类方程](@entry_id:144428)性质、数值稳定的系统。在处理多层膜衬底上的图形时，SIE方法可以通过使用**[层状介质格林函数](@entry_id:751186)**，将整个平面多层膜的效应解析地包含在内，从而避免了对多层膜内部众多界面的[网格划分](@entry_id:1127808)，极大地提高了[计算效率](@entry_id:270255)。

总而言之，不同的数值方法各有其优缺点，适用于不同的问题场景。方法的选择取决于掩模几何的周期性、复杂性、材料属性以及所需的计算精度和效率。