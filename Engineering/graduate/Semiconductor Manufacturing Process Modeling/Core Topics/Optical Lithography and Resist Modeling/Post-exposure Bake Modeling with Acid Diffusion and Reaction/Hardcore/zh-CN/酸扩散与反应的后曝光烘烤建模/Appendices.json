{
    "hands_on_practices": [
        {
            "introduction": "任何对反应-扩散系统的严谨分析都始于无量纲化。这个练习将引导您将曝光后烘烤（PEB）过程的控制方程转化为无量纲形式。通过这种方式，我们可以揭示控制酸扩散、中和与去保护反应之间相互作用的关键物理参数，例如比较反应速率与扩散速率的达姆科勒数（Damköhler numbers），从而简化复杂的物理图像，并获得对工艺控制的普适性理解 。",
            "id": "4155186",
            "problem": "在化学放大光刻胶工艺的曝光后烘烤（Post-Exposure Bake, PEB）步骤中，曝光过程中产生的酸会扩散，并与碱性淬灭剂和酸敏性保护基发生反应。考虑一个占据 $0 \\le x \\le L$ 区域的一维光刻胶薄膜，其中酸浓度为 $a(x,t)$，碱浓度为 $b(x,t)$，未反应的保护基分数（或相对于参考值标度的浓度）为 $p(x,t)$。假设以下具有物理动机的要素：\n- 酸的扩散遵循菲克第二定律（Fick's second law），扩散系数为 $D_a$，而碱和保护基在 PEB 时间尺度上不发生扩散。\n- 酸碱中和反应遵循质量作用定律，速率常数为 $k_n$，反应式为 $A + B \\to$ 惰性产物。\n- 酸催化的脱保护反应遵循质量作用定律，速率常数为 $k_p$，通过催化反应 $A + P \\to$ 脱保护产物 $+$ $A$ 进行，因此酸在脱保护反应中不被消耗。\n\n在这些假设下，控制方程为\n$$\n\\frac{\\partial a}{\\partial t} \\;=\\; D_a\\,\\frac{\\partial^2 a}{\\partial x^2} \\;-\\; k_n\\,a\\,b,\n$$\n$$\n\\frac{\\partial b}{\\partial t} \\;=\\; -\\,k_n\\,a\\,b,\n$$\n$$\n\\frac{\\partial p}{\\partial t} \\;=\\; -\\,k_p\\,a\\,p,\n$$\n在 $x=0$ 和 $x=L$ 处，酸满足无通量边界条件，并给定初始条件 $a(x,0)=a_0(x)$，$b(x,0)=b_0$ 和 $p(x,0)=p_0$，其中 $a_0(x)$ 是一个给定的曝光后分布，而 $b_0$ 和 $p_0$ 是均匀的。\n\n使用特征长度 $L$、特征时间 $t_c$ 和特征浓度标度 $a_c$、$b_c$ 和 $p_c$，引入无量纲变量 $\\xi = x/L$，$\\tau = t/t_c$，$\\tilde{a} = a/a_c$，$\\tilde{b} = b/b_c$ 和 $\\tilde{p} = p/p_c$。仅从菲克定律和质量作用定律出发，对系统进行无量纲化，以获得揭示控制扩散、中和与脱保护相互作用的无量纲数组的无参数形式。\n\n确定一个控制该动力学的最小独立无量纲数组，并用有量纲的参数明确陈述它们的定义。以有序行矩阵的形式给出最终答案，这些独立数组的顺序为：扩散-时间标度组、酸碱中和丹姆科勒数（Damköhler number）、脱保护丹姆科勒数，以及碱-酸浓度标度比。最终答案中不包含任何单位。如果您选择其他等效的数组定义，您必须在报告最终答案前将其简化为具有相同物理内容和相同顺序的等效最小集。",
            "solution": "该问题要求对一个描述化学放大光刻胶中曝光后烘烤（PEB）过程的耦合偏微分方程组进行无量纲化。目标是确定一个控制该系统动力学的最小独立无量纲数组。\n\n有量纲的控制方程如下所示：\n$$\n\\frac{\\partial a}{\\partial t} \\;=\\; D_a\\,\\frac{\\partial^2 a}{\\partial x^2} \\;-\\; k_n\\,a\\,b \\quad (1)\n$$\n$$\n\\frac{\\partial b}{\\partial t} \\;=\\; -\\,k_n\\,a\\,b \\quad (2)\n$$\n$$\n\\frac{\\partial p}{\\partial t} \\;=\\; -\\,k_p\\,a\\,p \\quad (3)\n$$\n其中 $a(x,t)$ 是酸浓度，$b(x,t)$ 是碱浓度，$p(x,t)$ 是保护基浓度。参数 $D_a$、$k_n$ 和 $k_p$ 分别代表酸扩散系数、中和反应速率常数和脱保护反应速率常数。该系统定义在域 $x \\in [0, L]$ 上。\n\n我们引入指定的无量纲变量和特征标度：\n- 无量纲位置：$\\xi = x/L$\n- 无量纲时间：$\\tau = t/t_c$\n- 无量纲酸浓度：$\\tilde{a} = a/a_c$\n- 无量纲碱浓度：$\\tilde{b} = b/b_c$\n- 无量纲保护基浓度：$\\tilde{p} = p/p_c$\n\n这里，$L$ 是给定的特征长度标度，而 $t_c$、$a_c$、$b_c$ 和 $p_c$ 是时间和浓度的特征标度，我们将用它们来构建无量纲数组。\n\n首先，我们使用链式法则，用无量纲对应项来表示有量纲变量及其导数：\n- 变量：$x = L\\xi$，$t = t_c\\tau$，$a = a_c\\tilde{a}$，$b = b_c\\tilde{b}$，$p = p_c\\tilde{p}$。\n- 时间导数：\n$$\n\\frac{\\partial a}{\\partial t} = \\frac{\\partial(a_c \\tilde{a})}{\\partial \\tau} \\frac{d\\tau}{dt} = \\frac{a_c}{t_c} \\frac{\\partial \\tilde{a}}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial b}{\\partial t} = \\frac{b_c}{t_c} \\frac{\\partial \\tilde{b}}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{p_c}{t_c} \\frac{\\partial \\tilde{p}}{\\partial \\tau}\n$$\n- 空间导数：\n$$\n\\frac{\\partial a}{\\partial x} = \\frac{\\partial(a_c \\tilde{a})}{\\partial \\xi} \\frac{d\\xi}{dx} = \\frac{a_c}{L} \\frac{\\partial \\tilde{a}}{\\partial \\xi}\n$$\n$$\n\\frac{\\partial^2 a}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{a_c}{L} \\frac{\\partial \\tilde{a}}{\\partial \\xi}\\right) = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{a_c}{L} \\frac{\\partial \\tilde{a}}{\\partial \\xi}\\right) \\frac{d\\xi}{dx} = \\frac{a_c}{L^2} \\frac{\\partial^2 \\tilde{a}}{\\partial \\xi^2}\n$$\n\n接下来，我们将这些表达式代入三个控制方程中。\n\n对于酸传输方程（1）：\n$$\n\\frac{a_c}{t_c} \\frac{\\partial \\tilde{a}}{\\partial \\tau} = D_a \\frac{a_c}{L^2} \\frac{\\partial^2 \\tilde{a}}{\\partial \\xi^2} - k_n (a_c \\tilde{a})(b_c \\tilde{b})\n$$\n为使方程无量纲化，我们将整个方程乘以 $\\frac{t_c}{a_c}$：\n$$\n\\frac{\\partial \\tilde{a}}{\\partial \\tau} = \\left(\\frac{D_a t_c}{L^2}\\right) \\frac{\\partial^2 \\tilde{a}}{\\partial \\xi^2} - (k_n b_c t_c) \\tilde{a} \\tilde{b}\n$$\n\n对于碱反应方程（2）：\n$$\n\\frac{b_c}{t_c} \\frac{\\partial \\tilde{b}}{\\partial \\tau} = - k_n (a_c \\tilde{a})(b_c \\tilde{b})\n$$\n乘以 $\\frac{t_c}{b_c}$：\n$$\n\\frac{\\partial \\tilde{b}}{\\partial \\tau} = - (k_n a_c t_c) \\tilde{a} \\tilde{b}\n$$\n\n对于保护基反应方程（3）：\n$$\n\\frac{p_c}{t_c} \\frac{\\partial \\tilde{p}}{\\partial \\tau} = - k_p (a_c \\tilde{a})(p_c \\tilde{p})\n$$\n乘以 $\\frac{t_c}{p_c}$：\n$$\n\\frac{\\partial \\tilde{p}}{\\partial \\tau} = - (k_p a_c t_c) \\tilde{a} \\tilde{p}\n$$\n\n得到的无量纲偏微分方程组为：\n$$\n\\frac{\\partial \\tilde{a}}{\\partial \\tau} = \\left(\\frac{D_a t_c}{L^2}\\right) \\frac{\\partial^2 \\tilde{a}}{\\partial \\xi^2} - (k_n b_c t_c) \\tilde{a} \\tilde{b}\n$$\n$$\n\\frac{\\partial \\tilde{b}}{\\partial \\tau} = - (k_n a_c t_c) \\tilde{a} \\tilde{b}\n$$\n$$\n\\frac{\\partial \\tilde{p}}{\\partial \\tau} = - (k_p a_c t_c) \\tilde{a} \\tilde{p}\n$$\n\n该系统解的行为由方程中出现的无量纲系数控制。这些就是我们寻求的无量纲数组。我们来确定它们：\n- 来自酸方程中的扩散项：$\\Pi_A = \\frac{D_a t_c}{L^2}$\n- 来自酸方程中的中和项：$\\Pi_B = k_n b_c t_c$\n- 来自碱方程中的中和项：$\\Pi_C = k_n a_c t_c$\n- 来自保护基方程中的脱保护项：$\\Pi_D = k_p a_c t_c$\n\n数组 $\\{\\Pi_A, \\Pi_B, \\Pi_C, \\Pi_D\\}$ 不是一个最小独立集，因为 $\\Pi_B$ 和 $\\Pi_C$ 通过浓度标度相关联：\n$$\n\\Pi_B = k_n b_c t_c = (k_n a_c t_c) \\left(\\frac{b_c}{a_c}\\right) = \\Pi_C \\left(\\frac{b_c}{a_c}\\right)\n$$\n因此，我们可以使用一个最小独立数组来表示该系统。我们可以选择该集合为 $\\{\\Pi_A, \\Pi_C, \\Pi_D, b_c/a_c\\}$，因为这使得系统可以写为：\n$$\n\\frac{\\partial \\tilde{a}}{\\partial \\tau} = \\Pi_A \\frac{\\partial^2 \\tilde{a}}{\\partial \\xi^2} - \\Pi_C \\left(\\frac{b_c}{a_c}\\right) \\tilde{a} \\tilde{b}\n$$\n$$\n\\frac{\\partial \\tilde{b}}{\\partial \\tau} = - \\Pi_C \\tilde{a} \\tilde{b}\n$$\n$$\n\\frac{\\partial \\tilde{p}}{\\partial \\tau} = - \\Pi_D \\tilde{a} \\tilde{p}\n$$\n这个集合是最小且独立的，它控制着系统的动力学。现在，我们将这些数组映射到问题陈述中指定的名称。\n\n1.  **扩散-时间标度组：** 该组比较了所选时间标度 $t_c$ 与特征扩散时间 $L^2/D_a$。这恰好是 $\\Pi_A$。\n    $$\n    \\text{第 1 组} = \\frac{D_a t_c}{L^2}\n    $$\n2.  **酸碱中和丹姆科勒数：** 丹姆科勒数是输运时间标度与反应时间标度之比。在这里，该数是相对于通用时间标度 $t_c$ 定义的。中和反应的特征时间可以定义为 $1/(k_n a_c)$。因此，丹姆科勒数是比值 $t_c / (1/(k_n a_c))$。这对应于 $\\Pi_C$。我们选择 $\\Pi_C$ 而不是 $\\Pi_B$，是为了与同样基于 $a_c$ 的脱保护丹姆科勒数保持一致。\n    $$\n    \\text{第 2 组} = k_n a_c t_c\n    $$\n3.  **脱保护丹姆科勒数：** 类似地，脱保护反应的特征时间是 $1/(k_p a_c)$，相应的丹姆科勒数是比值 $t_c / (1/(k_p a_c))$。这对应于 $\\Pi_D$。\n    $$\n    \\text{第 3 组} = k_p a_c t_c\n    $$\n4.  **碱-酸浓度标度比：** 这是特征碱浓度与特征酸浓度的比值。\n    $$\n    \\text{第 4 组} = \\frac{b_c}{a_c}\n    $$\n\n这四个数组的集合 $\\{\\frac{D_a t_c}{L^2}, k_n a_c t_c, k_p a_c t_c, \\frac{b_c}{a_c}\\}$，构成了一个最小独立集，它完整地描述了无量纲问题，并符合所要求的内容。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{D_a t_c}{L^2}  k_n a_c t_c  k_p a_c t_c  \\frac{b_c}{a_c} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在不进行复杂数值模拟的情况下，我们如何获得关于工艺参数变化的深刻物理直觉？本练习通过在一个简化的模型上进行灵敏度分析来回答这个问题。您将推导出一个解析解，以确定诸如模糊和转化率等关键指标对扩散系数 $D$ 和反应速率常数 $k_a$ 等基本参数变化的敏感程度，这对于理解和优化工艺窗口至关重要 。",
            "id": "4155241",
            "problem": "考虑在曝光后烘烤（PEB）过程中的化学放大光刻胶的一维模型。酸浓度 $H(x,t)$ 在一个扩散系数 $D$ 为常数的均质聚合物基质中通过扩散演变，并根据质量作用动力学，以速率常数 $k_a$ 催化受保护聚合物部分 $P(x,t)$ 的去保护反应。作为基本定律，假设扩散遵循菲克第二定律（Fick’s second law），反应遵循质量作用定律，写作 $\\partial H/\\partial t = D\\,\\partial^2 H/\\partial x^2$ 和 $\\partial P/\\partial t = -k_a\\,H\\,P$。假设在烘烤时间 $T$ 内为小转化率极限，因此在反应项中 $P(x,t)\\approx 1$ 且酸损耗可忽略不计，这将聚合物动力学线性化为 $\\partial P/\\partial t \\approx -k_a\\,H$，且 $H$ 中没有任何汇项。\n\n曝光图案是位于 $x=0$ 处的半无限线特征，其初始酸分布为阶跃函数：当 $x0$ 时 $H(x,0)=H_0$，当 $x0$ 时 $H(x,0)=0$。空间域为实数线 $-\\infty  x  \\infty$。\n\n在PEB时间 $T$ 后，定义两个关键指标：\n1. 潜像模糊度 $b$，定义为归一化酸浓度 $H/H_0$ 分别为 $0.1$ 和 $0.9$ 的两个点之间的距离。\n2. 标称线边缘 $x=0$ 处的去保护转化率 $c$，定义为 $c=1-P(0,T)$，其中 $P(x,0)=1$。\n\n您的任务是计算这两个指标对于扩散系数 $D$ 和反应速率常数 $k_a$ 的无量纲对数敏感度，即\n$$ S_z^{(y)} = \\frac{\\partial\\ln y}{\\partial\\ln z} $$\n其中 $y \\in \\{b,c\\}$ 和 $z \\in \\{D,k_a\\}$。\n以一个 $1 \\times 4$ 的有序行矩阵 $\\left(S_D^{(b)}, S_{k_a}^{(b)}, S_D^{(c)}, S_{k_a}^{(c)}\\right)$ 的形式给出您的答案。",
            "solution": "该问题要求分为两部分进行分析：首先，确定酸浓度分布 $H(x,T)$ 和聚合物去保护情况 $P(x,T)$；其次，计算所导出指标的对数敏感度。\n\n**第一部分：酸浓度分布**\n\n酸浓度 $H(x,t)$ 的演变由一维扩散方程决定：\n$$ \\frac{\\partial H}{\\partial t} = D \\frac{\\partial^2 H}{\\partial x^2} $$\n初始条件是在 $t=0$ 时的阶跃函数：\n$$ H(x,0) = \\begin{cases} H_0  \\text{for } x  0 \\\\ 0  \\text{for } x  0 \\end{cases} $$\n域为 $-\\infty  x  \\infty$。这个标准输运问题的解可以用误差函数 $\\mathrm{erf}(z)$ 来表示：\n$$ H(x,t) = \\frac{H_0}{2} \\left[ 1 + \\mathrm{erf}\\left(\\frac{x}{\\sqrt{4Dt}}\\right) \\right] $$\n其中 $\\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-u^2) \\,du$。在烘烤时间 $T$ 结束时，酸浓度分布为：\n$$ H(x,T) = \\frac{H_0}{2} \\left[ 1 + \\mathrm{erf}\\left(\\frac{x}{\\sqrt{4DT}}\\right) \\right] $$\n\n**第二部分：潜像模糊度 $b$ 及其敏感度**\n\n潜像模糊度 $b$ 定义为归一化酸浓度分别为 $0.1$ 和 $0.9$ 的点 $x_1$ 和 $x_2$ 之间的距离。\n对于点 $x_1$：\n$$ \\frac{H(x_1,T)}{H_0} = 0.1 $$\n$$ \\frac{1}{2} \\left[ 1 + \\mathrm{erf}\\left(\\frac{x_1}{\\sqrt{4DT}}\\right) \\right] = 0.1 $$\n$$ 1 + \\mathrm{erf}\\left(\\frac{x_1}{\\sqrt{4DT}}\\right) = 0.2 $$\n$$ \\mathrm{erf}\\left(\\frac{x_1}{\\sqrt{4DT}}\\right) = -0.8 $$\n利用反误差函数 $\\mathrm{erf}^{-1}(z)$ 是奇函数的性质，我们得到：\n$$ \\frac{x_1}{\\sqrt{4DT}} = \\mathrm{erf}^{-1}(-0.8) = -\\mathrm{erf}^{-1}(0.8) $$\n$$ x_1 = -\\sqrt{4DT} \\cdot \\mathrm{erf}^{-1}(0.8) $$\n\n对于点 $x_2$：\n$$ \\frac{H(x_2,T)}{H_0} = 0.9 $$\n$$ \\frac{1}{2} \\left[ 1 + \\mathrm{erf}\\left(\\frac{x_2}{\\sqrt{4DT}}\\right) \\right] = 0.9 $$\n$$ \\mathrm{erf}\\left(\\frac{x_2}{\\sqrt{4DT}}\\right) = 0.8 $$\n$$ \\frac{x_2}{\\sqrt{4DT}} = \\mathrm{erf}^{-1}(0.8) $$\n$$ x_2 = \\sqrt{4DT} \\cdot \\mathrm{erf}^{-1}(0.8) $$\n\n模糊度 $b$ 是距离 $b = x_2 - x_1$：\n$$ b = \\left(\\sqrt{4DT} \\cdot \\mathrm{erf}^{-1}(0.8)\\right) - \\left(-\\sqrt{4DT} \\cdot \\mathrm{erf}^{-1}(0.8)\\right) $$\n$$ b = 2 \\sqrt{4DT} \\cdot \\mathrm{erf}^{-1}(0.8) = 4\\sqrt{DT} \\cdot \\mathrm{erf}^{-1}(0.8) $$\n令 $K_b = 4\\sqrt{T} \\cdot \\mathrm{erf}^{-1}(0.8)$ 为一个相对于 $D$ 和 $k_a$ 的常数。则模糊度的表达式简化为 $b = K_b D^{1/2}$。\n\n现在我们计算 $b$ 的对数敏感度。函数 $y$ 相对于变量 $z$ 的对数敏感度为 $S_z^{(y)} = \\frac{\\partial \\ln y}{\\partial \\ln z}$。对于幂律关系 $y = K z^n$，这简化为 $n$。\n\n$b$ 相对于 $D$ 的敏感度为：\n$$ S_D^{(b)} = \\frac{\\partial\\ln b}{\\partial\\ln D} $$\n由于 $b \\propto D^{1/2}$，敏感度为：\n$$ S_D^{(b)} = \\frac{1}{2} $$\n\n$b$ 相对于 $k_a$ 的敏感度为：\n$$ S_{k_a}^{(b)} = \\frac{\\partial\\ln b}{\\partial\\ln k_a} $$\n$b$ 的表达式不包含 $k_a$。这等价于 $b \\propto k_a^0$。因此：\n$$ S_{k_a}^{(b)} = 0 $$\n\n**第三部分：去保护转化率 $c$ 及其敏感度**\n\n聚合物去保护的速率由线性化的动力学方程给出：\n$$ \\frac{\\partial P}{\\partial t} \\approx -k_a H(x,t) $$\n受保护聚合物部分的初始条件是 $P(x,0) = 1$。为了求出在时间 $T$ 时的分数，我们对时间进行积分：\n$$ P(x,T) - P(x,0) = \\int_0^T -k_a H(x,t) \\, dt $$\n$$ P(x,T) = 1 - k_a \\int_0^T H(x,t) \\, dt $$\n转化率 $c$ 定义在标称线边缘 $x=0$ 处。我们首先计算 $H(0,t)$：\n$$ H(0,t) = \\frac{H_0}{2} \\left[ 1 + \\mathrm{erf}\\left(\\frac{0}{\\sqrt{4Dt}}\\right) \\right] = \\frac{H_0}{2} \\left[ 1 + 0 \\right] = \\frac{H_0}{2} $$\n在 $x=0$ 处的酸浓度对于所有 $t  0$ 都是恒定的。我们现在可以计算 $P(0,T)$：\n$$ P(0,T) = 1 - k_a \\int_0^T \\frac{H_0}{2} \\, dt = 1 - k_a \\frac{H_0}{2} T $$\n转化率 $c$ 定义为 $c = 1 - P(0,T)$：\n$$ c = 1 - \\left(1 - \\frac{k_a H_0 T}{2}\\right) = \\frac{k_a H_0 T}{2} $$\n令 $K_c = \\frac{H_0 T}{2}$ 为一个相对于 $D$ 和 $k_a$ 的常数。则 $c = K_c k_a^1$。\n\n现在我们计算 $c$ 的对数敏感度。\n$c$ 相对于 $D$ 的敏感度为：\n$$ S_D^{(c)} = \\frac{\\partial\\ln c}{\\partial\\ln D} $$\n$c$ 的表达式不包含 $D$。这等价于 $c \\propto D^0$。因此：\n$$ S_D^{(c)} = 0 $$\n\n$c$ 相对于 $k_a$ 的敏感度为：\n$$ S_{k_a}^{(c)} = \\frac{\\partial\\ln c}{\\partial\\ln k_a} $$\n由于 $c \\propto k_a^1$，敏感度为：\n$$ S_{k_a}^{(c)} = 1 $$\n\n**第四部分：最终结果**\n\n计算出的敏感度为：\n$S_D^{(b)} = \\frac{1}{2}$\n$S_{k_a}^{(b)} = 0$\n$S_D^{(c)} = 0$\n$S_{k_a}^{(c)} = 1$\n\n最终答案要求为 $1 \\times 4$ 的行矩阵 $\\left(S_D^{(b)}, S_{k_a}^{(b)}, S_D^{(c)}, S_{k_a}^{(c)}\\right)$。\n即 $\\left(\\frac{1}{2}, 0, 0, 1\\right)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  0  0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习将理论与现代计算实践相结合，解决了工艺表征中的一个核心挑战。在实际生产中，我们通常测量的是最终图形，并需要反向推演以理解潜在的物理过程。这个练习模拟了这一“逆问题”，要求您设计一个计算方法，利用傅里叶域的反卷积技术从最终的潜像中提取出有效的工艺模糊核，这是在工艺开发和监控中一项非常实用的技能 。",
            "id": "4155237",
            "problem": "要求您设计并实现一个完整的、可运行的程序，该程序根据测量的曝光后烘烤（PEB）后的潜像，反算出等效的PEB模糊核，并将其与化学放大光刻胶中基于第一性原理反应-扩散模型的预测进行比较。潜像定义为PEB结束时累积的去保护分数。您的方法必须从一个基本的基础出发，仅使用经过充分检验的公式和事实，并避免任何可能揭示目标结果的捷径公式或提示。\n\n从以下有物理基础的基准开始。令 $A(x,t)$ 表示光致酸浓度， $R(x,t)$ 表示累积的去保护分数。假设沿着线-空间方向存在一个空间维度 $x$，其空间周期为 $L$，并采用周期性边界条件。酸扩散由菲克第二定律（Fick's second law）建模，而与大量近似恒定的碱浓度发生淬灭导致的伪一级酸损失，以及在低转化率下与酸浓度呈线性的酸催化去保护反应也包含在模型中。具体使用以下方程：\n$$\n\\frac{\\partial A(x,t)}{\\partial t} = D \\frac{\\partial^2 A(x,t)}{\\partial x^2} - k\\,A(x,t),\n$$\n初始条件为 $A(x,0) = A_0(x)$，以及\n$$\n\\frac{\\partial R(x,t)}{\\partial t} = k_r \\, A(x,t), \\quad R(x,0) = 0,\n$$\n因此，经过持续时间为 $T$ 的PEB后，潜像为 $L(x) = R(x,T)$。假设 $D$ 是酸扩散系数， $k$ 是伪一级酸损失速率常数， $k_r$ 是酸催化去保护速率常数。除 $A_0(x)$ 外，所有变量和参数在空间上都是均匀的。\n\n将等效PEB模糊核 $K(x)$ 定义为将 $A_0(x)$ 映射到 $L(x)$ 的线性空间不变算子，通过周期域上的卷积实现：\n$$\nL(x) = (K * A_0)(x) = \\int_0^L K(x - \\xi) \\, A_0(\\xi) \\, d\\xi,\n$$\n其中包含在 $[0,L)$ 上的周期性环绕。\n\n您的任务是：\n- 根据测量的潜像 $L(x)$ 和已知的PEB前酸分布 $A_0(x)$，通过求解反问题来反算出等效核 $\\hat{K}(x)$。反演过程必须通过使用正则化的傅里葉域反卷积来实现数值适定，其中非零正则化参数 $\\alpha$ 用于避免除以接近零的谱分量。\n- 从第一性原理出发，通过求解上述反应-扩散系统，并将酸浓度在PEB持续时间内积分以获得作为 $A_0(x)$ 泛函的 $L(x)$，来预测 $K(x)$。您可以利用周期性边界条件选择与傅里葉模式上对角化一致的计算方法。不要先验地假设一个高斯核，也不要使用任何捷径公式；从控制方程和核心定义中推导出预测。\n- 使用均方根误差（RMSE）在空间域中比较反算出的核 $\\hat{K}(x)$ 和第一性原理预测的核，RMSE定义为\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{j=0}^{N-1} \\left(\\hat{K}(x_j) - K(x_j)\\right)^2 }.\n$$\n\n在一维空间和周期性边界条件下工作。使用一个包含 $N$ 个点的离散网格，域长度为 $L$，网格间距为 $dx = L/N$，并假设离散傅里葉变换的实现使用快速傅里葉变换（FFT）的标准约定。构建一个物理上合理且自洽的测试套件。对于每个测试用例，使用第一性原理模型从已知的 $A_0(x)$ 模拟一个测量的潜像 $L(x)$，然后应用您的反演方法来恢复 $\\hat{K}(x)$。报告每个案例中 $\\hat{K}(x)$ 和第一性原理预测的 $K(x)$ 之间的RMSE。\n\n使用以下测试套件：\n- 测试用例1（“理想路径，中等扩散”）：$L = 1.0 \\times 10^{-6}$ m, $N = 256$, $D = 1.0 \\times 10^{-15}$ m$^2$/s, $k = 0.5$ s$^{-1}$, $k_r = 0.05$ s$^{-1}$, $T = 60.0$ s, 正则化参数 $\\alpha = 1.0 \\times 10^{-12}$ (无单位), 初始酸 $A_0(x)$ 是一个占空比为$50\\%$的线-空间图形，当 $0 \\le x  L/2$ 时等于 $1.0$，当 $L/2 \\le x  L$ 时等于 $0.0$。\n- 测试用例2（“边界情况，零扩散”）：$L = 1.0 \\times 10^{-6}$ m, $N = 256$, $D = 0.0$ m$^2$/s, $k = 0.5$ s$^{-1}$, $k_r = 0.05$ s$^{-1}$, $T = 60.0$ s, 正则化参数 $\\alpha = 1.0 \\times 10^{-12}$ (无单位), 且 $A_0(x)$ 与测试用例1中相同。\n- 测试用例3（“边缘情况，较高扩散”）：$L = 1.0 \\times 10^{-6}$ m, $N = 256$, $D = 4.0 \\times 10^{-15}$ m$^2$/s, $k = 0.5$ s$^{-1}$, $k_r = 0.05$ s$^{-1}$, $T = 60.0$ s, 正则化参数 $\\alpha = 1.0 \\times 10^{-12}$ (无单位), 且 $A_0(x)$ 与测试用例1中相同。\n\n所有输出必须是无单位的浮点数。您的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起来（例如 $[r_1,r_2,r_3]$），其中 $r_1$、$r_2$ 和 $r_3$ 分别是三个测试用例的RMSE值。不应打印其他任何输出。",
            "solution": "该问题要求设计并实现一个程序，从模拟的潜像数据中反算出等效的曝光后烘烤（PEB）模糊核，并将其与根据第一性原理反应-扩散模型预测的核进行比较。验证和比较在一个具有周期性边界条件的空间维度上进行，这使得傅里叶分析（Fourier analysis）成为自然且最高效的解决方法。\n\n解决方案分为三个主要部分：\n1. 在傅里叶域中推导第一性原理的PEB核 $K(x)$。\n2. 构建正则化反卷积过程以反算出估计核 $\\hat{K}(x)$。\n3. 计算均方根误差（RMSE）以比较指定测试用例的两个核。\n\n**1. 第一性原理核的推导**\n\n该过程始于光致酸浓度 $A(x,t)$ 和累积去保护分数 $R(x,t)$ 的控制偏微分方程（PDE）：\n$$\n\\frac{\\partial A(x,t)}{\\partial t} = D \\frac{\\partial^2 A(x,t)}{\\partial x^2} - k\\,A(x,t)\n$$\n$$\n\\frac{\\partial R(x,t)}{\\partial t} = k_r \\, A(x,t)\n$$\n初始条件为 $A(x,0) = A_0(x)$ 和 $R(x,0) = 0$。域是周期性的，长度为 $L$。\n\n由于这些方程是线性、空间不变的，并且具有周期性边界条件，我们将它们转换到傅里叶域。令 $\\mathcal{F}$ 表示关于空间变量 $x$ 的连续傅里叶变换，其中函数 $f(x)$ 的变换为 $f(k_\\omega) = \\int_{-\\infty}^{\\infty} f(x) e^{-i k_\\omega x} dx$， $k_\\omega$ 是角空间频率。对于长度为 $L$ 的周期域，频率是离散的：$k_{\\omega,n} = 2\\pi n/L$，其中 $n$ 为整数。应用傅里叶变换属性 $\\mathcal{F}\\{\\frac{\\partial^2 f}{\\partial x^2}\\} = -k_{\\omega,n}^2 \\mathcal{F}\\{f\\}$，酸浓度的PDE变为关于每个频率分量 $A_n(t) = \\mathcal{F}\\{A(x,t)\\}(k_{\\omega,n})$ 的一组解耦的常微分方程（ODE）：\n$$\n\\frac{d A_n(t)}{d t} = -D k_{\\omega,n}^2 A_n(t) - k A_n(t) = -(D k_{\\omega,n}^2 + k) A_n(t)\n$$\n这是一个一阶线性ODE，其初始条件为 $A_n(0) = \\mathcal{F}\\{A_0(x)\\} = A_{0,n}$。其解为：\n$$\nA_n(t) = A_{0,n} \\exp\\left( -(D k_{\\omega,n}^2 + k)t \\right)\n$$\n最终潜像定义为 $L(x) = R(x,T)$，其中 $T$ 是总PEB时间。我们通过对去保护速率方程进行积分来找到 $L(x)$：\n$$\nL(x) = R(x,T) = \\int_0^T \\frac{\\partial R(x,t)}{\\partial t} dt = \\int_0^T k_r A(x,t) dt\n$$\n将其转换到傅里叶域，我们得到 $L_n = \\mathcal{F}\\{L(x)\\}$：\n$$\nL_n = k_r \\int_0^T A_n(t) dt = k_r \\int_0^T A_{0,n} \\exp\\left( -(D k_{\\omega,n}^2 + k)t \\right) dt\n$$\n进行积分得到：\n$$\nL_n = k_r A_{0,n} \\left[ \\frac{\\exp\\left( -(D k_{\\omega,n}^2 + k)t \\right)}{-(D k_{\\omega,n}^2 + k)} \\right]_0^T = k_r A_{0,n} \\frac{1 - \\exp\\left( -(D k_{\\omega,n}^2 + k)T \\right)}{D k_{\\omega,n}^2 + k}\n$$\n问题通过卷积 $L(x) = (K * A_0)(x)$ 定义了等效PEB模糊核 $K(x)$。在傅里葉域中，此卷积变为乘积：$L_n = K_n A_{0,n}$，其中 $K_n = \\mathcal{F}\\{K(x)\\}$。通过将其与推导出的 $L_n$ 表达式进行比较，我们可以在傅里葉域中确定第一性原理的核：\n$$\nK_n = \\frac{k_r}{D k_{\\omega,n}^2 + k} \\left( 1 - \\exp\\left( -(D k_{\\omega,n}^2 + k)T \\right) \\right)\n$$\n这个表达式给出了基于PEB过程物理参数的理论核的频率响应。\n\n**2. 通过正则化反卷积反算核**\n\n第二个任务是从“测量”的潜像 $L(x)$ 和已知的初始酸分布 $A_0(x)$ 中反算出核的估计值 $\\hat{K}(x)$。为了进行自洽测试，我们首先使用上面推导的第一性原理模型生成 $L(x)$。\n\n反算的核心是解决反卷积问题 $L = \\hat{K} * A_0$。在离散傅里叶域中，使用离散傅里叶变换（DFT），这变为 $\\tilde{L}_n = \\tilde{\\hat{K}}_n \\tilde{A}_{0,n}$，其中波浪号表示相应离散采样数组的DFT。朴素的反演 $\\tilde{\\hat{K}}_n = \\tilde{L}_n / \\tilde{A}_{0,n}$ 在数值上是不稳定的，因为谱分量 $\\tilde{A}_{0,n}$ 可能为零或非常接近零，导致除以零和噪声放大。\n\n为确保问题是适定的，我们采用Tikhonov正则化（也称为维纳滤波器，Wiener filter）。核的DFT的正则化解为：\n$$\n\\tilde{\\hat{K}}_n = \\frac{\\tilde{L}_n \\cdot \\tilde{A}_{0,n}^*}{|\\tilde{A}_{0,n}|^2 + \\alpha}\n$$\n其中 $\\tilde{A}_{0,n}^*$ 是 $\\tilde{A}_{0,n}$ 的复共轭，而 $\\alpha$ 是一个小的正正则化参数。该参数防止分母变为零并稳定反演过程。问题指定了一个无单位的 $\\alpha$，如果将输入数组视为无单位量，则与此公式一致。\n\n然后，通过对 $\\tilde{\\hat{K}}_n$ 应用逆离散傅里叶变换（IDFT），可以获得核在空间域的估计值 $\\hat{K}(x_j)$。\n\n**3. 数值实现与比较**\n\n该实现使用一个离散网格，在域长度 $L$ 上包含 $N$ 个点，网格间距为 $dx = L/N$。\n\n- **频率向量**：与DFT索引对应的角空间频率 $k_{\\omega,n}$ 使用 `numpy.fft.fftfreq` 计算。对于网格间距 $dx$，空间频率为 $f_n = n/(N \\cdot dx) = n/L$。角频率为 $k_{\\omega,n} = 2\\pi f_n$。\n\n- **离散核**：连续傅里叶变换 $K_n$ 与采样核数组 $K_j = K(x_j)$ 的DFT $\\tilde{K}_n$ 之间的关系可能很微妙。但是，如果我们定义一个有效的离散核 $K_{eff}$，使得离散循环卷积 $L_{discrete} = K_{eff} \\circledast A_{0,discrete}$ 成立，那么其DFT $\\tilde{K}_{eff,n}$ 应与我们推导的 $K_n$ 相匹配。因此，我们可以直接令 $\\tilde{K}_{theory,n} = K_n$。理论上的空间域核即为 $K_{theory}(x_j) = \\text{IDFT}\\{K_n\\}_j$。\n\n每个测试用例的流程如下：\n1.  定义网格、参数和初始酸数组 $A_{0,arr}$。\n2.  计算初始酸的DFT：$\\tilde{A}_{0,n} = \\text{DFT}\\{A_{0,arr}\\}$。\n3.  使用推导的公式计算每个频率的理论核的DFT $K_n$。\n4.  理论空间核数组为 $K_{th,arr} = \\text{IDFT}\\{K_n\\}$。\n5.  在傅里叶域中模拟“测量”的潜像：$\\tilde{L}_n = K_n \\cdot \\tilde{A}_{0,n}$。\n6.  执行正则化反卷积以找到反算出的核的DFT：$\\tilde{\\hat{K}}_n = (\\tilde{L}_n \\cdot \\tilde{A}_{0,n}^*) / (|\\tilde{A}_{0,n}|^2 + \\alpha)$。\n7.  反算出的空间核数组为 $\\hat{K}_{arr} = \\text{IDFT}\\{\\tilde{\\hat{K}}_n\\}$。\n8.  计算两个空间核实部之间的RMSE：\n    $$\n    \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{j=0}^{N-1} \\left(\\Re(\\hat{K}_{arr,j}) - \\Re(K_{th,arr,j})\\right)^2}\n    $$\n这个过程直接比较了从第一性原理推导的核与通过数值反演获得的核，为给定条件下的反演准确性提供了定量度量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the RMSE between a first-principles PEB kernel and a back-calculated one.\n    \"\"\"\n    test_cases = [\n        # Test case 1: \"happy path, moderate diffusion\"\n        {\n            \"L\": 1.0e-6, \"N\": 256, \"D\": 1.0e-15, \"k\": 0.5, \"k_r\": 0.05, \n            \"T\": 60.0, \"alpha\": 1.0e-12\n        },\n        # Test case 2: \"boundary, zero diffusion\"\n        {\n            \"L\": 1.0e-6, \"N\": 256, \"D\": 0.0, \"k\": 0.5, \"k_r\": 0.05, \n            \"T\": 60.0, \"alpha\": 1.0e-12\n        },\n        # Test case 3: \"edge, higher diffusion\"\n        {\n            \"L\": 1.0e-6, \"N\": 256, \"D\": 4.0e-15, \"k\": 0.5, \"k_r\": 0.05, \n            \"T\": 60.0, \"alpha\": 1.0e-12\n        },\n    ]\n\n    results = []\n\n    for params in test_cases:\n        L = params[\"L\"]\n        N = params[\"N\"]\n        D = params[\"D\"]\n        k = params[\"k\"]\n        k_r = params[\"k_r\"]\n        T = params[\"T\"]\n        alpha = params[\"alpha\"]\n\n        # 1. Setup grid and initial condition A0(x)\n        # Grid spacing. The domain is [0, L).\n        dx = L / N\n        # Spatial frequencies (not angular). d=dx sets the sample spacing.\n        spatial_freqs = np.fft.fftfreq(N, d=dx)\n        # Angular spatial frequencies\n        k_omega_n = 2 * np.pi * spatial_freqs\n\n        # Initial acid concentration A0(x)\n        # 50% duty cycle line-space pattern\n        A0_arr = np.zeros(N)\n        A0_arr[:N // 2] = 1.0\n\n        # 2. Derive the first-principles kernel K(x)\n        # We work in the Fourier domain. Kn is the continuous Fourier transform of K(x).\n        denominator = D * k_omega_n**2 + k\n        \n        # Handle the case where denominator is zero (only if D=0 and k=0).\n        # In this problem, k > 0, so the denominator is always positive.\n        Kn = (k_r / denominator) * (1.0 - np.exp(-denominator * T))\n\n        # The discrete effective kernel's DFT is simply Kn.\n        # Its spatial representation is the IFFT of Kn.\n        K_theory_arr = np.fft.ifft(Kn)\n\n        # 3. Back-calculate the kernel K_hat(x)\n        \n        # 3a. Simulate \"measured\" latent image L(x)\n        # L_n = K_n * A0_n\n        A0_fft = np.fft.fft(A0_arr)\n        L_fft = Kn * A0_fft\n        # L_arr = np.fft.ifft(L_fft) # Not strictly needed, we operate in Fourier domain\n\n        # 3b. Perform regularized deconvolution to find K_hat\n        # K_hat_n = (L_n * A0_n*) / (|A0_n|^2 + alpha)\n        A0_fft_conj = np.conj(A0_fft)\n        A0_fft_mag_sq = np.abs(A0_fft)**2\n        \n        K_hat_fft = (L_fft * A0_fft_conj) / (A0_fft_mag_sq + alpha)\n        \n        # The back-calculated spatial kernel is the IFFT of its Fourier transform.\n        K_hat_arr = np.fft.ifft(K_hat_fft)\n\n        # 4. Compare K(x) and K_hat(x) using RMSE\n        # The physical kernels must be real-valued. We take the real part to discard\n        # numerical noise in the imaginary part.\n        diff_sq = (np.real(K_hat_arr) - np.real(K_theory_arr))**2\n        rmse = np.sqrt(np.mean(diff_sq))\n        results.append(rmse)\n\n    # Format output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}