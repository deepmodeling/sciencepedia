{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the kinetics of a chemical process, it is essential to understand its thermodynamic landscape. This practice focuses on computing the equilibrium constant, $K_p$, for a silicon deposition reaction by starting from fundamental thermochemical data. You will use temperature-dependent heat capacities, represented by NASA polynomials, to calculate the standard enthalpy $\\Delta H^\\circ(T)$ and entropy $\\Delta S^\\circ(T)$ changes, which in turn determine the Gibbs free energy change $\\Delta G^\\circ(T)$ and the equilibrium constant. This exercise  provides a foundational skill for assessing reaction feasibility and predicting the maximum possible yield under various temperature conditions.",
            "id": "4127983",
            "problem": "A gas-phase deposition reaction commonly used in Chemical Vapor Deposition (CVD) for semiconductor manufacturing is the hydrogen reduction of silicon tetrachloride. Consider the reaction written with stoichiometric coefficients defined positive for products and negative for reactants: $$\\nu_{\\mathrm{Si(s)}} = +1,\\;\\nu_{\\mathrm{HCl(g)}} = +4,\\;\\nu_{\\mathrm{SiCl_4(g)}} = -1,\\;\\nu_{\\mathrm{H_2(g)}} = -2,$$ which corresponds to $$\\mathrm{SiCl_4(g)} + 2\\,\\mathrm{H_2(g)} \\rightarrow \\mathrm{Si(s)} + 4\\,\\mathrm{HCl(g)}.$$ Assume ideal gases and the standard pressure of $1$ bar for gas-phase standard states. The equilibrium constant in terms of partial pressures is determined by the standard Gibbs free energy change through $$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right),$$ where $R$ is the universal gas constant. The standard molar enthalpy and entropy for each species at temperature $T$ are to be obtained by integrating the temperature-dependent heat capacity at constant pressure.\n\nUse the following context-appropriate fundamental base:\n- The molar heat capacity at constant pressure $C_p(T)$ defines the temperature dependence of enthalpy and entropy via $$H^\\circ(T) = H^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_p(T')\\,\\mathrm{d}T',$$ $$S^\\circ(T) = S^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_p(T')}{T'}\\,\\mathrm{d}T',$$ with $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}.$\n- The standard Gibbs free energy is $$G^\\circ(T) = H^\\circ(T) - T\\,S^\\circ(T),$$ and the reaction properties are $$\\Delta H^\\circ(T) = \\sum_i \\nu_i H_i^\\circ(T),\\quad \\Delta S^\\circ(T) = \\sum_i \\nu_i S_i^\\circ(T),\\quad \\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T).$$\n\nApproximate the National Aeronautics and Space Administration (NASA) polynomial form for the heat capacity using a truncated series $$\\frac{C_p(T)}{R} = a_0 + a_1 T + a_2 T^2 + a_3 T^3 + a_4 T^4,$$ for each species over the temperature interval considered. The universal gas constant is $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$. Use the following scientifically plausible parameters, all referenced to $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$:\n\n- Species: $\\mathrm{H_2(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = 0.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 130.68\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 3.33727920$, $a_1 = -4.94024731\\times 10^{-5}$, $a_2 = 4.99456778\\times 10^{-7}$, $a_3 = -1.79566394\\times 10^{-10}$, $a_4 = 2.00255376\\times 10^{-14}$\n- Species: $\\mathrm{HCl(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = -92310.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 186.90\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 3.50000000$, $a_1 = 1.00000000\\times 10^{-3}$, $a_2 = -3.00000000\\times 10^{-7}$, $a_3 = 5.00000000\\times 10^{-11}$, $a_4 = -3.00000000\\times 10^{-15}$\n- Species: $\\mathrm{SiCl_4(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = -657000.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 324.00\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 11.00000000$, $a_1 = 5.00000000\\times 10^{-3}$, $a_2 = -2.00000000\\times 10^{-6}$, $a_3 = 3.00000000\\times 10^{-10}$, $a_4 = -2.00000000\\times 10^{-14}$\n- Species: $\\mathrm{Si(s)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = 0.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 18.80\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 2.50000000$, $a_1 = 2.00000000\\times 10^{-3}$, $a_2 = -8.00000000\\times 10^{-7}$, $a_3 = 1.00000000\\times 10^{-10}$, $a_4 = -5.00000000\\times 10^{-15}$\n\nTasks:\n- Implement the above integrals to compute $H_i^\\circ(T)$ and $S_i^\\circ(T)$ for each species by integrating $C_{p,i}(T)$ from $T_{\\mathrm{ref}}$ to $T$, using the given $a_k$ coefficients and reference values at $T_{\\mathrm{ref}}$.\n- Compute $\\Delta H^\\circ(T)$, $\\Delta S^\\circ(T)$, $\\Delta G^\\circ(T)$, and finally $K_p(T)$.\n- Treat the solid $\\mathrm{Si(s)}$ as having activity equal to $1$; nonetheless, its $H^\\circ(T)$ and $S^\\circ(T)$ contribute to $\\Delta H^\\circ(T)$ and $\\Delta S^\\circ(T)$.\n\nPhysical and numerical units:\n- Temperatures must be in $\\mathrm{K}$.\n- Enthalpies must be in $\\mathrm{J\\,mol^{-1}}$ and entropies in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- The equilibrium constant $K_p(T)$ is dimensionless.\n\nTest suite:\n- Evaluate $K_p(T)$ at the following temperatures (all in $\\mathrm{K}$): $298.15$, $800.0$, $1000.0$, $1200.0$, $1600.0$.\n- Include the case $T = 298.15$ to test the boundary where the integrals vanish, and higher temperatures to test realistic reactor conditions.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each $K_p(T)$ rounded to six significant digits, in the order of the test suite temperatures: for example, $$[k_{298.15},k_{800.0},k_{1000.0},k_{1200.0},k_{1600.0}].$$",
            "solution": "The objective is to compute the equilibrium constant $K_p(T)$ for the hydrogen reduction of silicon tetrachloride that deposits silicon. The derivation proceeds from fundamental thermodynamic definitions and ideal-gas standard states. The standard chemical potential for species $i$ is $$\\mu_i^\\circ(T) = h_i^\\circ(T) - T\\,s_i^\\circ(T),$$ and the standard Gibbs free energy change of reaction is $$\\Delta G^\\circ(T) = \\sum_i \\nu_i \\mu_i^\\circ(T) = \\sum_i \\nu_i \\left(h_i^\\circ(T) - T\\,s_i^\\circ(T)\\right) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T),$$ with $$\\Delta H^\\circ(T) = \\sum_i \\nu_i H_i^\\circ(T),\\quad \\Delta S^\\circ(T) = \\sum_i \\nu_i S_i^\\circ(T).$$ For ideal gases at the standard pressure of $1$ bar, the equilibrium constant in terms of partial pressures is $$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right).$$\n\nTo obtain the temperature dependence of $H_i^\\circ(T)$ and $S_i^\\circ(T)$ from heat capacities, we start from the definitions at constant pressure:\n- The molar enthalpy change from a reference temperature $T_{\\mathrm{ref}}$ is given by $$H_i^\\circ(T) - H_i^\\circ(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'.$$\n- The molar entropy change is $$S_i^\\circ(T) - S_i^\\circ(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'.$$\n\nWe approximate the temperature dependence of heat capacity using the truncated NASA polynomial form $$\\frac{C_{p,i}(T)}{R} = a_{0,i} + a_{1,i} T + a_{2,i} T^2 + a_{3,i} T^3 + a_{4,i} T^4.$$ With this, the integrals are elementary:\n- The enthalpy integral is $$\\int_{T_{\\mathrm{ref}}}^{T} C_{p,i}(T')\\,\\mathrm{d}T' = R\\left[a_{0,i}(T - T_{\\mathrm{ref}}) + \\frac{a_{1,i}}{2}(T^2 - T_{\\mathrm{ref}}^2) + \\frac{a_{2,i}}{3}(T^3 - T_{\\mathrm{ref}}^3) + \\frac{a_{3,i}}{4}(T^4 - T_{\\mathrm{ref}}^4) + \\frac{a_{4,i}}{5}(T^5 - T_{\\mathrm{ref}}^5)\\right].$$\n- The entropy integral is $$\\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T' = R\\left[a_{0,i}\\ln\\!\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) + a_{1,i}(T - T_{\\mathrm{ref}}) + \\frac{a_{2,i}}{2}(T^2 - T_{\\mathrm{ref}}^2) + \\frac{a_{3,i}}{3}(T^3 - T_{\\mathrm{ref}}^3) + \\frac{a_{4,i}}{4}(T^4 - T_{\\mathrm{ref}}^4)\\right].$$\n\nWe use the provided reference values at $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$:\n- For enthalpy, we take $H_i^\\circ(298.15\\ \\mathrm{K})$ equal to the standard enthalpy of formation $\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K})$ of each species, which yields the correct reaction enthalpy at the reference temperature. Thus $$H_i^\\circ(T) = \\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'.$$\n- For entropy, we take $$S_i^\\circ(T) = S_i^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'.$$\n\nThen reaction properties follow:\n- $$\\Delta H^\\circ(T) = \\sum_i \\nu_i \\left[\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'\\right] = \\Delta H^\\circ(298.15\\ \\mathrm{K}) + \\sum_i \\nu_i \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T',$$ where $$\\Delta H^\\circ(298.15\\ \\mathrm{K}) = \\sum_i \\nu_i \\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}).$$\n- $$\\Delta S^\\circ(T) = \\sum_i \\nu_i \\left[S_i^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'\\right] = \\Delta S^\\circ(298.15\\ \\mathrm{K}) + \\sum_i \\nu_i \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T',$$ where $$\\Delta S^\\circ(298.15\\ \\mathrm{K}) = \\sum_i \\nu_i S_i^\\circ(298.15\\ \\mathrm{K}).$$\n\nFinally, compute $$\\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T),$$ and $$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right).$$ Note that the solid $\\mathrm{Si(s)}$ has activity equal to $1$ and does not introduce a pressure term into $K_p$, but it contributes to $\\Delta H^\\circ(T)$ and $\\Delta S^\\circ(T)$ through its thermochemical functions.\n\nAlgorithmic design for implementation:\n- Define $R$ and $T_{\\mathrm{ref}}$ numerically.\n- Store for each species: stoichiometric coefficient $\\nu_i$, polynomial coefficients $a_{k,i}$, $\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K})$, and $S_i^\\circ(298.15\\ \\mathrm{K})$.\n- Implement functions to evaluate the enthalpy correction $\\int C_{p,i}\\,\\mathrm{d}T'$ and entropy correction $\\int C_{p,i}/T'\\,\\mathrm{d}T'$ using the analytical expressions above.\n- Compute $\\Delta H^\\circ(T)$ and $\\Delta S^\\circ(T)$, then $\\Delta G^\\circ(T)$, and finally $K_p(T)$ for each test temperature. Round each $K_p(T)$ to six significant digits before output.\n- Produce the single-line output with the results ordered as specified.\n\nThis approach strictly follows first-principles thermodynamics and uses the polynomial heat-capacity representation to recover temperature-dependent enthalpy and entropy, avoiding shortcut formulas and ensuring consistency with ideal-gas standard states at $1$ bar.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    # Universal gas constant (J/mol-K)\n    R = 8.31446261815324\n    # Reference temperature (K)\n    T_ref = 298.15\n\n    # Reaction: SiCl4(g) + 2 H2(g) -> Si(s) + 4 HCl(g)\n    # Stoichiometric coefficients: products positive, reactants negative\n    # Species data: name, nu, dhf_ref (J/mol), s_ref (J/mol-K), cp/R coefficients a0..a4\n    species = [\n        {\n            \"name\": \"Si(s)\",\n            \"nu\": +1.0,\n            \"dhf_ref\": 0.0,\n            \"s_ref\": 18.80,\n            \"a\": np.array([2.5, 2.0e-3, -8.0e-7, 1.0e-10, -5.0e-15], dtype=float),\n        },\n        {\n            \"name\": \"HCl(g)\",\n            \"nu\": +4.0,\n            \"dhf_ref\": -92310.0,\n            \"s_ref\": 186.90,\n            \"a\": np.array([3.5, 1.0e-3, -3.0e-7, 5.0e-11, -3.0e-15], dtype=float),\n        },\n        {\n            \"name\": \"SiCl4(g)\",\n            \"nu\": -1.0,\n            \"dhf_ref\": -657000.0,\n            \"s_ref\": 324.00,\n            \"a\": np.array([11.0, 5.0e-3, -2.0e-6, 3.0e-10, -2.0e-14], dtype=float),\n        },\n        {\n            \"name\": \"H2(g)\",\n            \"nu\": -2.0,\n            \"dhf_ref\": 0.0,\n            \"s_ref\": 130.68,\n            \"a\": np.array([3.33727920, -4.94024731e-05, 4.99456778e-07, -1.79566394e-10, 2.00255376e-14], dtype=float),\n        },\n    ]\n\n    # Precompute powers of T_ref for integrals\n    Tref_powers = np.array([T_ref, T_ref**2, T_ref**3, T_ref**4, T_ref**5], dtype=float)\n\n    def enthalpy_correction(T, a):\n        \"\"\"\n        Compute integral_{T_ref}^{T} Cp dT using Cp/R = sum_k a_k T^k, k=0..4.\n        Returns J/mol.\n        \"\"\"\n        # Terms: a0*(T-Tref) + a1/2*(T^2 - Tref^2) + a2/3*(T^3 - Tref^3) + a3/4*(T^4 - Tref^4) + a4/5*(T^5 - Tref^5)\n        T_powers = np.array([T, T**2, T**3, T**4, T**5], dtype=float)\n        coeff_div = np.array([1.0, 1.0/2.0, 1.0/3.0, 1.0/4.0, 1.0/5.0], dtype=float)\n        integral_over_R = np.sum(a * coeff_div * (T_powers - Tref_powers))\n        return R * integral_over_R\n\n    def entropy_correction(T, a):\n        \"\"\"\n        Compute integral_{T_ref}^{T} Cp/T dT using Cp/R = sum_k a_k T^k, k=0..4.\n        Returns J/mol-K.\n        \"\"\"\n        # Terms: a0*ln(T/Tref) + a1*(T - Tref) + a2/2*(T^2 - Tref^2) + a3/3*(T^3 - Tref^3) + a4/4*(T^4 - Tref^4)\n        T_powers = np.array([T, T**2, T**3, T**4], dtype=float)\n        Tref_powers_4 = np.array([T_ref, T_ref**2, T_ref**3, T_ref**4], dtype=float)\n        coeffs = np.array([1.0, 1.0, 1.0/2.0, 1.0/3.0, 1.0/4.0], dtype=float)\n        # First term (log) uses a0\n        term0 = a[0] * math.log(T / T_ref)\n        # Remaining terms use a1..a4\n        term_rest = np.sum(a[1:] * coeffs[1:] * (T_powers - Tref_powers_4))\n        integral_over_R = term0 + term_rest\n        return R * integral_over_R\n\n    def compute_Kp(T):\n        # Compute Delta H°(298) and Delta S°(298)\n        delta_H_ref = 0.0\n        delta_S_ref = 0.0\n        for sp in species:\n            delta_H_ref += sp[\"nu\"] * sp[\"dhf_ref\"]\n            delta_S_ref += sp[\"nu\"] * sp[\"s_ref\"]\n        # Temperature corrections\n        delta_h_corr = 0.0\n        delta_s_corr = 0.0\n        for sp in species:\n            a = sp[\"a\"]\n            delta_h_corr += sp[\"nu\"] * enthalpy_correction(T, a)\n            delta_s_corr += sp[\"nu\"] * entropy_correction(T, a)\n        delta_H_T = delta_H_ref + delta_h_corr\n        delta_S_T = delta_S_ref + delta_s_corr\n        delta_G_T = delta_H_T - T * delta_S_T\n        Kp = math.exp(-delta_G_T / (R * T))\n        return Kp\n\n    # Define the test cases from the problem statement: temperatures in K\n    test_cases = [298.15, 800.0, 1000.0, 1200.0, 1600.0]\n\n    results = []\n    for T in test_cases:\n        Kp = compute_Kp(T)\n        # Round to six significant digits\n        results.append(f\"{Kp:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While thermodynamics defines the destination, kinetics dictates the path and speed of a reaction. Many gas-phase reactions in semiconductor processing are not simple elementary steps but rather complex, pressure-dependent phenomena. This problem  explores the decomposition of a precursor via the Lindemann mechanism, a cornerstone model for unimolecular reactions that demonstrates the transition from first-order to second-order kinetics as pressure changes. By applying the Pseudo-Steady-State Approximation (PSSA) and conducting a sensitivity analysis, you will develop a deeper understanding of how to model reactions in the crucial \"fall-off\" regime and identify the most influential kinetic parameters.",
            "id": "4127985",
            "problem": "Consider the gas-phase decomposition of Tetraethyl orthosilicate (TEOS) in a well-mixed, isothermal reactor at specified temperature and pressure. The mixture is treated as an ideal gas. The decomposition proceeds via a pressure-dependent unimolecular mechanism modeled by collisionally activated intermediate kinetics (Lindemann mechanism) with a single bath gas. You are provided the elementary steps:\n- $S_1$: $\\mathrm{TEOS} + \\mathrm{M} \\rightarrow \\mathrm{TEOS}^\\ast + \\mathrm{M}$,\n- $S_2$: $\\mathrm{TEOS}^\\ast + \\mathrm{M} \\rightarrow \\mathrm{TEOS} + \\mathrm{M}$,\n- $S_3$: $\\mathrm{TEOS}^\\ast \\rightarrow \\text{products}$,\n\nwhere $\\mathrm{M}$ denotes the bath gas and $\\mathrm{TEOS}^\\ast$ denotes the collisionally activated TEOS. Assume the bath gas third-body efficiency is unity so that the effective collider concentration equals the total number concentration of the gas mixture.\n\nFundamental base assumptions and definitions:\n- Ideal gas law: the total molar concentration is $C_{\\mathrm{tot}} = P/(R\\,T)$, the TEOS molar concentration is $C_{\\mathrm{TEOS}} = y_{\\mathrm{TEOS}}\\,C_{\\mathrm{tot}}$, and the collider molar concentration is $C_{\\mathrm{M}} = C_{\\mathrm{tot}}$, where $P$ is pressure, $T$ is temperature, $R$ is the universal gas constant, and $y_{\\mathrm{TEOS}}$ is the TEOS mole fraction.\n- Arrhenius law for each elementary step $i \\in \\{1,2,3\\}$: $k_i(T) = A_i\\,T^{n_i}\\,\\exp\\!\\left(-\\dfrac{E_i}{R\\,T}\\right)$, with pre-exponential factor $A_i$, temperature exponent $n_i$, and activation energy $E_i$. Use the following parameter values:\n  - $A_1 = 1.0\\times 10^{-3}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_1 = 0.5$, $E_1 = 0\\ \\mathrm{J\\,mol^{-1}}$,\n  - $A_2 = 5.0\\times 10^{-2}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_2 = 0.5$, $E_2 = 0\\ \\mathrm{J\\,mol^{-1}}$,\n  - $A_3 = 1.0\\times 10^{13}\\ \\mathrm{s^{-1}}$, $n_3 = 0$, $E_3 = 1.80\\times 10^{5}\\ \\mathrm{J\\,mol^{-1}}$.\n- Universal gas constant: $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nStarting from the fundamental laws above and mass-action kinetics, derive the rate of TEOS decomposition, $r_{\\mathrm{TEOS}}$, in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$, expressed solely in terms of $k_1(T)$, $k_2(T)$, $k_3(T)$, $C_{\\mathrm{TEOS}}$, and $C_{\\mathrm{M}}$. Then, evaluate the sensitivity of the decomposition rate with respect to the pre-exponential factors $A_1$, $A_2$, and $A_3$ using the logarithmic sensitivity definition $S_{A_i} = \\dfrac{\\partial \\ln r_{\\mathrm{TEOS}}}{\\partial \\ln A_i}$.\n\nYour program must:\n1. Compute $k_1(T)$, $k_2(T)$, and $k_3(T)$ using the Arrhenius law for each test case.\n2. Compute $C_{\\mathrm{tot}}$, $C_{\\mathrm{TEOS}}$, $C_{\\mathrm{M}}$ using the ideal gas law.\n3. Compute $r_{\\mathrm{TEOS}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n4. Compute the sensitivities $S_{A_1}$, $S_{A_2}$, and $S_{A_3}$.\n\nTest suite:\n- Case 1 (happy path): $T = 1000\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$.\n- Case 2 (low-pressure edge): $T = 1000\\ \\mathrm{K}$, $P = 1.0\\times 10^{4}\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$.\n- Case 3 (high-pressure edge): $T = 1000\\ \\mathrm{K}$, $P = 5.0\\times 10^{5}\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$.\n- Case 4 (lower-temperature variation): $T = 800\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$.\n- Case 5 (dilute-TEOS scaling): $T = 1000\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-5}$.\n\nAnswer specification:\n- Express $r_{\\mathrm{TEOS}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$ as a floating-point number.\n- Express $S_{A_1}$, $S_{A_2}$, $S_{A_3}$ as floating-point numbers (dimensionless).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a bracketed, comma-separated list of four floats in the order $[r_{\\mathrm{TEOS}}, S_{A_1}, S_{A_2}, S_{A_3}]$. For example: $[[\\dots],[\\dots],\\dots]$.",
            "solution": "**Step 1: Derivation of the Rate of Decomposition, $r_{\\mathrm{TEOS}}$**\n\nThe reaction mechanism is given by three elementary steps:\n- $S_1$: $\\mathrm{TEOS} + \\mathrm{M} \\xrightarrow{k_1} \\mathrm{TEOS}^\\ast + \\mathrm{M}$ (Activation)\n- $S_2$: $\\mathrm{TEOS}^\\ast + \\mathrm{M} \\xrightarrow{k_2} \\mathrm{TEOS} + \\mathrm{M}$ (De-activation)\n- $S_3$: $\\mathrm{TEOS}^\\ast \\xrightarrow{k_3} \\text{products}$ (Decomposition)\n\nAccording to the law of mass action, the rates of these elementary steps, denoted $w_i$, are:\n$$w_1 = k_1(T) [\\mathrm{TEOS}] [\\mathrm{M}]$$\n$$w_2 = k_2(T) [\\mathrm{TEOS}^\\ast] [\\mathrm{M}]$$\n$$w_3 = k_3(T) [\\mathrm{TEOS}^\\ast]$$\nwhere $[X]$ denotes the molar concentration of species $X$. The problem uses the notation $C_{\\mathrm{TEOS}}$ for $[\\mathrm{TEOS}]$ and $C_{\\mathrm{M}}$ for $[\\mathrm{M}]$.\n\nThe net rate of formation of TEOS, $R_{\\mathrm{TEOS}}$, is given by the sum of rates of reactions producing it minus the sum of rates of reactions consuming it.\n$$R_{\\mathrm{TEOS}} = \\frac{d[\\mathrm{TEOS}]}{dt} = w_2 - w_1 = k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}] - k_1 [\\mathrm{TEOS}] [\\mathrm{M}]$$\nThe rate of TEOS decomposition, $r_{\\mathrm{TEOS}}$, is the negative of its rate of formation, thus:\n$$r_{\\mathrm{TEOS}} = -R_{\\mathrm{TEOS}} = k_1 [\\mathrm{TEOS}] [\\mathrm{M}] - k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}]$$\nThis expression contains the concentration of the activated intermediate, $\\mathrm{TEOS}^\\ast$. To find a closed-form expression, we apply the Pseudo-Steady-State Approximation (PSSA) to $\\mathrm{TEOS}^\\ast$. This approximation is valid because $\\mathrm{TEOS}^\\ast$ is a high-energy, short-lived species, and its concentration can be assumed to be small and nearly constant relative to the stable reactants and products.\nThe PSSA sets the net rate of formation of the intermediate to zero:\n$$\\frac{d[\\mathrm{TEOS}^\\ast]}{dt} = w_1 - w_2 - w_3 = 0$$\n$$k_1 [\\mathrm{TEOS}] [\\mathrm{M}] - k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}] - k_3 [\\mathrm{TEOS}^\\ast] = 0$$\nWe can now solve for the steady-state concentration of the intermediate, $[\\mathrm{TEOS}^\\ast]$:\n$$k_1 [\\mathrm{TEOS}] [\\mathrm{M}] = (k_2 [\\mathrm{M}] + k_3) [\\mathrm{TEOS}^\\ast]$$\n$$[\\mathrm{TEOS}^\\ast] = \\frac{k_1 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3}$$\nThe rate of decomposition of TEOS is stoichiometrically equivalent to the rate of formation of products, which is simply $w_3$.\n$$r_{\\mathrm{TEOS}} = w_3 = k_3 [\\mathrm{TEOS}^\\ast]$$\nSubstituting the expression for $[\\mathrm{TEOS}^\\ast]$ yields the final rate law:\n$$r_{\\mathrm{TEOS}} = k_3 \\left( \\frac{k_1 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3} \\right) = \\frac{k_1 k_3 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3}$$\nUsing the notation from the problem statement ($C_{\\mathrm{TEOS}}$ and $C_{\\mathrm{M}}$):\n$$r_{\\mathrm{TEOS}}(T, C_{\\mathrm{TEOS}}, C_{\\mathrm{M}}) = \\frac{k_1(T) k_3(T) C_{\\mathrm{TEOS}} C_{\\mathrm{M}}}{k_2(T) C_{\\mathrm{M}} + k_3(T)}$$\n\n**Step 2: Derivation of the Logarithmic Sensitivities, $S_{A_i}$**\n\nThe logarithmic sensitivity of the rate $r_{\\mathrm{TEOS}}$ with respect to a parameter $A_i$ is defined as:\n$$S_{A_i} = \\frac{\\partial \\ln r_{\\mathrm{TEOS}}}{\\partial \\ln A_i}$$\nThe rate constants are given by the Arrhenius law, $k_i = A_i T^{n_i} \\exp(-E_i/(RT))$. Since $k_i$ is directly proportional to $A_i$, we have the useful property:\n$$\\frac{\\partial \\ln k_j}{\\partial \\ln A_i} = \\frac{A_i}{k_j}\\frac{\\partial k_j}{\\partial A_i} = \\frac{A_i}{k_j} \\left( \\delta_{ij} \\frac{k_j}{A_j} \\right) = \\delta_{ij}$$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\nTo compute the sensitivities, we first take the natural logarithm of the rate expression:\n$$\\ln r_{\\mathrm{TEOS}} = \\ln(k_1) + \\ln(k_3) + \\ln(C_{\\mathrm{TEOS}}) + \\ln(C_{\\mathrm{M}}) - \\ln(k_2 C_{\\mathrm{M}} + k_3)$$\nNow we differentiate with respect to $\\ln A_i$ for $i \\in \\{1, 2, 3\\}$.\n\n**Sensitivity with respect to $A_1$:**\n$$S_{A_1} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_1} = \\frac{\\partial (\\ln k_1)}{\\partial \\ln A_1} + 0 + 0 + 0 - 0 = 1$$\nThus, $S_{A_1} = 1$. The rate is directly proportional to $k_1$ and hence to $A_1$.\n\n**Sensitivity with respect to $A_2$:**\n$$S_{A_2} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_2} = 0 + 0 + 0 + 0 - \\frac{\\partial}{\\partial \\ln A_2} \\left[ \\ln(k_2 C_{\\mathrm{M}} + k_3) \\right]$$\nUsing the chain rule:\n$$S_{A_2} = - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\frac{\\partial (k_2 C_{\\mathrm{M}} + k_3)}{\\partial \\ln A_2} = - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\left( C_{\\mathrm{M}} \\frac{\\partial k_2}{\\partial \\ln A_2} + \\frac{\\partial k_3}{\\partial \\ln A_2} \\right)$$\nSince $\\partial k_2 / \\partial \\ln A_2 = k_2$ and $\\partial k_3 / \\partial \\ln A_2 = 0$:\n$$S_{A_2} = - \\frac{k_2 C_{\\mathrm{M}}}{k_2 C_{\\mathrm{M}} + k_3}$$\n\n**Sensitivity with respect to $A_3$:**\n$$S_{A_3} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_3} = \\frac{\\partial (\\ln k_3)}{\\partial \\ln A_3} - \\frac{\\partial}{\\partial \\ln A_3} \\left[ \\ln(k_2 C_{\\mathrm{M}} + k_3) \\right]$$\n$$S_{A_3} = 1 - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\frac{\\partial (k_2 C_{\\mathrm{M}} + k_3)}{\\partial \\ln A_3} = 1 - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\left( C_{\\mathrm{M}}\\frac{\\partial k_2}{\\partial \\ln A_3} + \\frac{\\partial k_3}{\\partial \\ln A_3}\\right)$$\nSince $\\partial k_2 / \\partial \\ln A_3 = 0$ and $\\partial k_3 / \\partial \\ln A_3 = k_3$:\n$$S_{A_3} = 1 - \\frac{k_3}{k_2 C_{\\mathrm{M}} + k_3} = \\frac{(k_2 C_{\\mathrm{M}} + k_3) - k_3}{k_2 C_{\\mathrm{M}} + k_3}$$\n$$S_{A_3} = \\frac{k_2 C_{\\mathrm{M}}}{k_2 C_{\\mathrm{M}} + k_3}$$\n\n**Step 3: Computational Procedure**\n\nThe program will execute the following steps for each test case $(T, P, y_{\\mathrm{TEOS}})$:\n1.  Calculate the total molar concentration $C_{\\mathrm{tot}} = P/(RT)$.\n2.  Calculate the TEOS concentration $C_{\\mathrm{TEOS}} = y_{\\mathrm{TEOS}} C_{\\mathrm{tot}}$ and the collider concentration $C_{\\mathrm{M}} = C_{\\mathrm{tot}}$.\n3.  Calculate the rate constants $k_1(T)$, $k_2(T)$, and $k_3(T)$ using the provided Arrhenius parameters: $k_i(T) = A_i T^{n_i} \\exp(-E_i / (RT))$.\n4.  Compute the rate of decomposition $r_{\\mathrm{TEOS}}$ using the derived formula.\n5.  Compute the sensitivities $S_{A_1}$, $S_{A_2}$, and $S_{A_3}$ using their derived formulas. $S_{A_1}$ is always $1$. $S_{A_2}$ and $S_{A_3}$ depend on the calculated values of $k_2$, $k_3$, and $C_{\\mathrm{M}}$.\n6.  The results $[r_{\\mathrm{TEOS}}, S_{A_1}, S_{A_2}, S_{A_3}]$ are collected for all test cases and formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves for the decomposition rate of TEOS and its sensitivities to\n    pre-exponential factors based on a Lindemann mechanism.\n    \"\"\"\n    # Define constants and Arrhenius parameters\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Parameters for S1: TEOS + M -> TEOS* + M\n    A1 = 1.0e-3  # m^3 mol^-1 s^-1\n    n1 = 0.5\n    E1 = 0.0  # J mol^-1\n\n    # Parameters for S2: TEOS* + M -> TEOS + M\n    A2 = 5.0e-2  # m^3 mol^-1 s^-1\n    n2 = 0.5\n    E2 = 0.0  # J mol^-1\n\n    # Parameters for S3: TEOS* -> products\n    A3 = 1.0e13  # s^-1\n    n3 = 0.0\n    E3 = 1.80e5  # J mol^-1\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], P [Pa], y_TEOS)\n        (1000.0, 101325.0, 1.0e-2),    # Case 1: happy path\n        (1000.0, 1.0e4, 1.0e-2),       # Case 2: low-pressure edge\n        (1000.0, 5.0e5, 1.0e-2),       # Case 3: high-pressure edge\n        (800.0, 101325.0, 1.0e-2),     # Case 4: lower-temperature variation\n        (1000.0, 101325.0, 1.0e-5),    # Case 5: dilute-TEOS scaling\n    ]\n\n    results = []\n    for T, P, y_TEOS in test_cases:\n        # Step 1: Compute concentrations using the ideal gas law.\n        # C_tot = P / (R * T) in mol m^-3\n        C_tot = P / (R * T)\n        # C_TEOS = y_TEOS * C_tot\n        C_TEOS = y_TEOS * C_tot\n        # C_M = C_tot as per problem statement\n        C_M = C_tot\n\n        # Step 2: Compute rate constants using the Arrhenius law.\n        # k_i(T) = A_i * T^n_i * exp(-E_i / (R * T))\n        k1 = A1 * (T ** n1) * np.exp(-E1 / (R * T))\n        k2 = A2 * (T ** n2) * np.exp(-E2 / (R * T))\n        k3 = A3 * (T ** n3) * np.exp(-E3 / (R * T))\n\n        # Step 3: Compute the rate of TEOS decomposition, r_TEOS.\n        # r_TEOS = (k1 * k3 * C_TEOS * C_M) / (k2 * C_M + k3)\n        numerator = k1 * k3 * C_TEOS * C_M\n        denominator = k2 * C_M + k3\n        r_TEOS = numerator / denominator\n\n        # Step 4: Compute the sensitivities S_A1, S_A2, S_A3.\n        # S_A1 = 1\n        S_A1 = 1.0\n        \n        # S_A2 = - (k2 * C_M) / (k2 * C_M + k3)\n        # S_A3 =   (k2 * C_M) / (k2 * C_M + k3)\n        sensitivity_term = (k2 * C_M) / (k2 * C_M + k3)\n        S_A2 = -sensitivity_term\n        S_A3 = sensitivity_term\n\n        # Collect results for this case\n        case_result = [r_TEOS, S_A1, S_A2, S_A3]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The format is [[...],[...],...]\n    # We construct the string manually to ensure exact output without spaces.\n    inner_strings = [','.join(map(str, res)) for res in results]\n    final_string = f\"[[{'],['.join(inner_strings)}]]\"\n    print(final_string)\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate goal of process modeling is to integrate fundamental principles to predict the behavior of a complete system. This final practice serves as a capstone exercise, guiding you to build a model for an adiabatic plug-flow reactor (PFR) used for silane pyrolysis. You will combine a kinetic rate law with a differential energy balance by numerically solving a system of coupled ordinary differential equations. By comparing a simplified model using constant heat capacities to a more rigorous one with temperature-dependent properties , you will gain practical insight into the quantitative impact of modeling assumptions on predicted reactor performance, such as reactant conversion and outlet temperature.",
            "id": "4127914",
            "problem": "You must write a complete and runnable program that computes the influence of temperature-dependent heat capacities on conversion in an adiabatic, constant-pressure plug-flow reactor for silane pyrolysis, and compares results against a constant-heat-capacity model. The physical system is a gas-phase reactor relevant to semiconductor manufacturing, where silane decomposes as a single-step reaction producing hydrogen gas and depositing crystalline silicon on the surface. Assume the following gas-phase reaction and modeling assumptions:\n\n- Reaction stoichiometry in the gas phase: $\\mathrm{SiH_4(g)} \\rightarrow \\mathrm{Si(s)} + 2\\,\\mathrm{H_2(g)}$.\n- Only gas-phase species contribute to the mixture’s heat capacity and energy balance. Silicon is deposited on surfaces and does not contribute to gas-phase heat capacity.\n- Ideal gas, constant pressure, and adiabatic operation.\n- Plug-flow reactor model with axial coordinate taken as reactor volume.\n- Single-step first-order kinetics in silane gas: $r_A = k(T)\\,C_A$, where $C_A$ is the molar concentration of $\\mathrm{SiH_4}$ and $k(T)$ follows the Arrhenius law $k(T) = A \\exp\\!\\left(-E_a/(R\\,T)\\right)$.\n- Use the Ideal Gas Law with total molar flow and temperature to compute concentrations at each axial position: $C_i = \\dfrac{F_i\\,P}{R\\,T\\,F_T}$, where $F_i$ is the molar flow of species $i$, $F_T = \\sum_i F_i$, $P$ is the total pressure, $R$ is the ideal gas constant, and $T$ is the temperature.\n\nFundamental balances to use as the starting point:\n\n- Mole balance per species $i$: $\\dfrac{dF_i}{dV} = \\nu_i r_A$, where $V$ is the reactor volume and $\\nu_i$ is the stoichiometric coefficient (for $\\mathrm{SiH_4}$, $\\nu_A=-1$; for $\\mathrm{H_2}$, $\\nu_B=+2$; inert carrier $\\mathrm{N_2}$ has $\\nu_I=0$).\n- Adiabatic energy balance at constant pressure: $\\dfrac{dT}{dV} = - \\dfrac{\\Delta H_\\text{rxn}(T)\\,r_A}{\\sum\\limits_{i \\in \\{\\mathrm{SiH_4},\\mathrm{H_2},\\mathrm{N_2}\\}} F_i\\,C_{p,i}(T)}$.\n\nThermochemistry base and data to use:\n\n- Standard heat of reaction at reference temperature $T_\\mathrm{ref} = 298\\,\\mathrm{K}$ is given by standard enthalpies of formation: $\\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) = -34300\\,\\mathrm{J/mol}$. You must account for temperature dependence using heat capacity integration as\n$$\n\\Delta H_\\text{rxn}(T) = \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) \\;+\\; \\int_{298\\,\\mathrm{K}}^{T} \\left[2\\,C_{p,\\mathrm{H_2}}(T') - C_{p,\\mathrm{SiH_4}}(T')\\right]\\,dT'.\n$$\n\n- Heat capacities $C_{p,i}(T)$ (per mole) must be represented in two alternative models:\n\n  1) Constant-$C_p$ model: For each species $i \\in \\{\\mathrm{SiH_4},\\mathrm{H_2},\\mathrm{N_2}\\}$, set $C_{p,i}(T) \\equiv C_{p,i}(T_0)$, the value at the inlet temperature $T_0$ (held constant within each simulation), and keep $\\Delta H_\\text{rxn}(T) \\equiv \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K})$.\n\n  2) Variable-$C_p(T)$ model using National Aeronautics and Space Administration (NASA) polynomial correlations. Use the dimensionless form $C_p/R = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4$ with piecewise coefficients for a low-temperature interval and a high-temperature interval as follows (the gas constant is $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$):\n\n  - Hydrogen, $\\mathrm{H_2}$:\n    Low-temperature range $[200,1000]\\,\\mathrm{K}$:\n    $a_1=2.34433112$, $a_2=7.98052075\\times 10^{-3}$, $a_3=-1.94781510\\times 10^{-5}$, $a_4=2.01572094\\times 10^{-8}$, $a_5=-7.37611761\\times 10^{-12}$.\n    High-temperature range $[1000,6000]\\,\\mathrm{K}$:\n    $a_1=3.33727920$, $a_2=-4.94024731\\times 10^{-5}$, $a_3=4.99456778\\times 10^{-7}$, $a_4=-1.79566394\\times 10^{-10}$, $a_5=2.00255376\\times 10^{-14}$.\n\n  - Nitrogen, $\\mathrm{N_2}$:\n    Low-temperature range $[200,1000]\\,\\mathrm{K}$:\n    $a_1=3.53100528$, $a_2=-1.23660987\\times 10^{-4}$, $a_3=-5.02999433\\times 10^{-7}$, $a_4=2.43530612\\times 10^{-9}$, $a_5=-1.40881235\\times 10^{-12}$.\n    High-temperature range $[1000,6000]\\,\\mathrm{K}$:\n    $a_1=2.95257626$, $a_2=1.39690040\\times 10^{-3}$, $a_3=-4.92631603\\times 10^{-7}$, $a_4=7.86010367\\times 10^{-11}$, $a_5=-4.60755321\\times 10^{-15}$.\n\n  - Silane, $\\mathrm{SiH_4}$:\n    Use a constant-polynomial approximation across the full range $[200,2000]\\,\\mathrm{K}$ as $C_{p,\\mathrm{SiH_4}}/R = a_1$, with $a_1=6.00000000$ and $a_2=a_3=a_4=a_5=0$. This is a degenerate NASA polynomial that fixes $C_{p,\\mathrm{SiH_4}}(T)$ to a constant value consistent with expected magnitudes for a polyatomic gas, yet still uses the NASA functional form.\n\n  For the variable-$C_p(T)$ model, compute $C_{p,i}(T)$ using the appropriate coefficient set for the current $T$, and evaluate $\\int C_p\\,dT$ analytically from the polynomial expression as needed for $\\Delta H_\\text{rxn}(T)$.\n\nKinetics to use:\n- Pre-exponential factor $A = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$.\n- Activation energy $E_a = 2.00\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$.\n\nUnknowns to compute:\n- For each test case, integrate the coupled ordinary differential equations for $F_{\\mathrm{SiH_4}}(V)$, $F_{\\mathrm{H_2}}(V)$, $F_{\\mathrm{N_2}}(V)$, and $T(V)$ from $V=0$ to $V=V_\\text{R}$ under both the constant-$C_p$ model and the variable-$C_p(T)$ model. Then report:\n  - The outlet conversion of silane $X \\equiv \\dfrac{F_{\\mathrm{SiH_4},0} - F_{\\mathrm{SiH_4}}(V_\\text{R})}{F_{\\mathrm{SiH_4},0}}$ as a decimal (not a percentage).\n  - The outlet temperature $T(V_\\text{R})$ in kelvin.\n\nInitial and operating conditions:\n- Ideal gas constant: $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Total pressure $P$ as specified in each test case.\n- Inlet temperature $T_0$ as specified in each test case.\n- Inlet molar flows at $V=0$: $F_{\\mathrm{SiH_4}}(0)=F_{\\mathrm{SiH_4},0}$, $F_{\\mathrm{H_2}}(0)=0$, $F_{\\mathrm{N_2}}(0)=F_{\\mathrm{N_2},0}$.\n\nNumerical requirements and output formatting:\n- Express all temperatures in $\\mathrm{K}$ and all energies in $\\mathrm{J}$, pressures in $\\mathrm{Pa}$, molar flows in $\\mathrm{mol/s}$, and volumes in $\\mathrm{m^3}$.\n- Use a numerically stable integrator appropriate for potentially stiff systems.\n- For each test case, compute and return a list of four numbers: $[X_\\text{const}, X_\\text{var}, T_{\\text{out,const}}, T_{\\text{out,var}}]$, where:\n  - $X_\\text{const}$ and $X_\\text{var}$ are the outlet conversions under the constant-$C_p$ and variable-$C_p(T)$ models, respectively, each rounded to six decimal places.\n  - $T_{\\text{out,const}}$ and $T_{\\text{out,var}}$ are the outlet temperatures under the constant-$C_p$ and variable-$C_p(T)$ models, respectively, each rounded to three decimal places, in $\\mathrm{K}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of the per-case lists, enclosed in square brackets, for example: $[[\\cdots],[\\cdots],\\ldots]$.\n\nTest suite to implement (each case is a tuple $(P, T_0, F_{\\mathrm{SiH_4},0}, F_{\\mathrm{N_2},0}, V_\\text{R})$):\n1) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=900\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$.\n2) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=700\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$.\n3) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=1100\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$.\n4) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=900\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.100\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.000\\,\\mathrm{mol/s}$, $V_\\text{R}=0.005\\,\\mathrm{m^3}$.\n\nYour program must solve each test case for both heat capacity models, compute the requested outputs, and print a single line consisting of a list of four lists corresponding to the four test cases, in the exact format described above. No input should be read from standard input, and no files should be accessed.",
            "solution": "The core of the problem is to solve a system of coupled ordinary differential equations (ODEs) that describe the mole and energy balances within the reactor. The state of the system at any point (volume $V$) along the reactor is described by a vector of molar flow rates for each species and the temperature: $y(V) = [F_{\\mathrm{SiH_4}}(V), F_{\\mathrm{H_2}}(V), F_{\\mathrm{N_2}}(V), T(V)]$.\n\nThe governing equations are:\n1.  **Mole Balances**: For each species $i$, the change in its molar flow rate $F_i$ with respect to reactor volume $V$ is given by its rate of formation:\n    $$\n    \\frac{dF_i}{dV} = r_i = \\nu_i r_A\n    $$\n    where $r_A$ is the rate of reaction of silane ($\\mathrm{SiH_4}$), and $\\nu_i$ is the stoichiometric coefficient. For the reaction $\\mathrm{SiH_4(g)} \\rightarrow \\mathrm{Si(s)} + 2\\,\\mathrm{H_2(g)}$, the coefficients are $\\nu_{\\mathrm{SiH_4}} = -1$, $\\nu_{\\mathrm{H_2}} = +2$, and for the inert nitrogen carrier, $\\nu_{\\mathrm{N_2}} = 0$.\n\n2.  **Energy Balance**: For an adiabatic, constant-pressure PFR, the change in temperature $T$ with respect to volume $V$ is:\n    $$\n    \\frac{dT}{dV} = - \\frac{\\Delta H_\\text{rxn}(T)\\,r_A}{\\sum\\limits_{i} F_i\\,C_{p,i}(T)}\n    $$\n    where $\\Delta H_\\text{rxn}(T)$ is the temperature-dependent heat of reaction, $F_i$ are the molar flow rates, and $C_{p,i}(T)$ are the molar heat capacities of the gas-phase species.\n\nThe rate of reaction, $r_A$, follows first-order kinetics with an Arrhenius temperature dependence:\n$$\nr_A = k(T)\\,C_A = \\left(A \\exp\\!\\left(\\frac{-E_a}{R\\,T}\\right)\\right) C_A\n$$\nThe concentration of silane, $C_A$, is found using the ideal gas law:\n$$\nC_A = \\frac{F_A P}{F_T R T} \\quad \\text{where } F_T = F_{\\mathrm{SiH_4}} + F_{\\mathrm{H_2}} + F_{\\mathrm{N_2}}\n$$\nHere, $P$ is the constant total pressure, $R$ is the ideal gas constant, and $F_T$ is the total molar flow rate.\n\nThe problem requires a comparison between two thermochemical models:\n\n**Model 1: Constant Heat Capacity (Constant-$C_p$)**\nIn this simplified model:\n- The heat capacity of each species, $C_{p,i}$, is assumed to be constant and equal to its value at the inlet temperature, $T_0$. That is, $C_{p,i}(T) \\equiv C_{p,i}(T_0)$.\n- The heat of reaction is assumed to be constant at its standard reference value, $\\Delta H_\\text{rxn}(T) \\equiv \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) = -34,300\\,\\mathrm{J/mol}$.\n\n**Model 2: Variable Heat Capacity (Variable-$C_p(T)$)**\nThis model employs a more rigorous approach:\n- The heat capacity of each species, $C_{p,i}(T)$, is a function of temperature, calculated using the provided NASA polynomial coefficients:\n  $$\n  \\frac{C_{p,i}(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4\n  $$\n  For $\\mathrm{H_2}$ and $\\mathrm{N_2}$, piecewise polynomials are used for different temperature ranges. For $\\mathrm{SiH_4}$, a degenerate polynomial is given, resulting in a constant value $C_{p,\\mathrm{SiH_4}} = 6R$.\n- The heat of reaction, $\\Delta H_\\text{rxn}(T)$, accounts for temperature effects via Kirchhoff's law:\n  $$\n  \\Delta H_\\text{rxn}(T) = \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) + \\int_{298\\,\\mathrm{K}}^{T} \\Delta C_p(T')\\,dT'\n  $$\n  where $\\Delta C_p(T') = 2\\,C_{p,\\mathrm{H_2}}(T') - C_{p,\\mathrm{SiH_4}}(T')$. The integral is evaluated analytically from the $C_p$ polynomials. For species with piecewise polynomials (like $\\mathrm{H_2}$), the integral is split at the temperature breakpoint ($1000\\,\\mathrm{K}$).\n\nTo solve the problem, we will implement a numerical solution in Python using the `scipy.integrate.solve_ivp` function, which is suitable for solving initial value problems for systems of ODEs. We will use the 'BDF' (Backward Differentiation Formula) method, which is robust for potentially stiff systems that can arise from strong temperature-reaction rate coupling.\n\nFor each test case defined by the parameters $(P, T_0, F_{\\mathrm{SiH_4},0}, F_{\\mathrm{N_2},0}, V_\\text{R})$, we will:\n1. Define the initial state vector $y_0 = [F_{\\mathrm{SiH_4},0}, 0, F_{\\mathrm{N_2},0}, T_0]$ at $V=0$.\n2. Integrate the ODE system from $V=0$ to $V=V_\\text{R}$ for both the constant-$C_p$ and variable-$C_p(T)$ models.\n3. From the final state at $V=V_\\text{R}$, we calculate the outlet silane conversion $X$ and the outlet temperature $T_\\text{out}$.\n4. The conversion is defined as $X = (F_{\\mathrm{SiH_4},0} - F_{\\mathrm{SiH_4,out}}) / F_{\\mathrm{SiH_4},0}$.\n5. The results for both models are collected, rounded as specified, and formatted into the required output structure.\n\nThe implementation will include helper functions to accurately compute the temperature-dependent thermochemical properties ($C_p(T)$ and $\\int C_p(T)dT$) based on the provided NASA polynomial data.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Global constants and data\nR = 8.314462618  # J/mol/K\nA_KIN = 1.0e13   # s^-1\nE_A_KIN = 2.0e5  # J/mol\nDH_RXN_REF = -34300.0  # J/mol at 298 K\nT_REF = 298.0      # K\n\nNASA_COEFFS = {\n    'H2': {\n        'low_coeffs': np.array([2.34433112, 7.98052075e-3, -1.94781510e-5, 2.01572094e-8, -7.37611761e-12]),\n        'high_coeffs': np.array([3.33727920, -4.94024731e-5, 4.99456778e-7, -1.79566394e-10, 2.00255376e-14]),\n        'temp_break': 1000.0,\n    },\n    'N2': {\n        'low_coeffs': np.array([3.53100528, -1.23660987e-4, -5.02999433e-7, 2.43530612e-9, -1.40881235e-12]),\n        'high_coeffs': np.array([2.95257626, 1.39690040e-3, -4.92631603e-7, 7.86010367e-11, -4.60755321e-15]),\n        'temp_break': 1000.0,\n    },\n    'SiH4': {\n        'low_coeffs': np.array([6.0, 0.0, 0.0, 0.0, 0.0]),\n        'high_coeffs': None,\n        'temp_break': float('inf'),\n    }\n}\n\ndef get_cp_div_R(species, T):\n    \"\"\"Calculates dimensionless heat capacity Cp/R for a given species and temperature.\"\"\"\n    s_data = NASA_COEFFS[species]\n    if T = s_data['temp_break']:\n        coeffs = s_data['low_coeffs']\n    else:\n        coeffs = s_data['high_coeffs']\n    \n    T_powers = np.array([1, T, T**2, T**3, T**4])\n    return np.dot(coeffs, T_powers)\n\ndef get_cp(species, T):\n    \"\"\"Calculates heat capacity Cp in J/mol/K.\"\"\"\n    return get_cp_div_R(species, T) * R\n\ndef h_poly_div_R(coeffs, T):\n    \"\"\"Calculates the polynomial part of the enthalpy integral, divided by R.\"\"\"\n    T_terms = np.array([T, T**2/2, T**3/3, T**4/4, T**5/5])\n    return np.dot(coeffs, T_terms)\n\ndef get_h_integral(species, T):\n    \"\"\"Calculates the integral of Cp aT from T_REF to T.\"\"\"\n    s_data = NASA_COEFFS[species]\n    \n    if species == 'SiH4': # Degenerate case, Cp is constant\n        return s_data['low_coeffs'][0] * R * (T - T_REF)\n\n    low_coeffs = s_data['low_coeffs']\n    h_ref = h_poly_div_R(low_coeffs, T_REF) * R\n    \n    if T = s_data['temp_break']:\n        return h_poly_div_R(low_coeffs, T) * R - h_ref\n    else:\n        high_coeffs = s_data['high_coeffs']\n        temp_break = s_data['temp_break']\n        \n        h_at_break_low = h_poly_div_R(low_coeffs, temp_break) * R\n        integral_to_break = h_at_break_low - h_ref\n        \n        h_at_break_high = h_poly_div_R(high_coeffs, temp_break) * R\n        h_at_T_high = h_poly_div_R(high_coeffs, T) * R\n        integral_from_break = h_at_T_high - h_at_break_high\n        \n        return integral_to_break + integral_from_break\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        (2.0e4, 900.0, 0.050, 0.950, 0.050),\n        (2.0e4, 700.0, 0.050, 0.950, 0.050),\n        (2.0e4, 1100.0, 0.050, 0.950, 0.050),\n        (2.0e4, 900.0, 0.100, 0.000, 0.005),\n    ]\n\n    results = []\n    for P, T0, F_SiH4_0, F_N2_0, V_R in test_cases:\n        y0 = np.array([F_SiH4_0, 0.0, F_N2_0, T0])\n        v_span = [0, V_R]\n\n        # --- Constant Cp Model ---\n        cp_SiH4_const = get_cp('SiH4', T0)\n        cp_H2_const = get_cp('H2', T0)\n        cp_N2_const = get_cp('N2', T0)\n\n        def pfr_odes_const(V, y):\n            F_SiH4, F_H2, F_N2, T = y\n            F_T = F_SiH4 + F_H2 + F_N2\n            \n            if F_T = 1e-12 or T = 0: return np.zeros(4)\n\n            k = A_KIN * np.exp(-E_A_KIN / (R * T))\n            C_SiH4 = F_SiH4 * P / (F_T * R * T)\n            r_A = k * C_SiH4\n            \n            dF_SiH4_dV = -r_A\n            dF_H2_dV = 2 * r_A\n            dF_N2_dV = 0\n            \n            cp_sum = F_SiH4*cp_SiH4_const + F_H2*cp_H2_const + F_N2*cp_N2_const\n            if abs(cp_sum)  1e-9: cp_sum = 1.0 # Avoid instability\n            \n            dH_rxn = DH_RXN_REF\n            dT_dV = -dH_rxn * r_A / cp_sum\n            \n            return [dF_SiH4_dV, dF_H2_dV, dF_N2_dV, dT_dV]\n\n        sol_const = solve_ivp(pfr_odes_const, v_span, y0, method='BDF', rtol=1e-8, atol=1e-11)\n        \n        F_SiH4_out_const = sol_const.y[0, -1]\n        T_out_const = sol_const.y[3, -1]\n        X_const = (F_SiH4_0 - max(0, F_SiH4_out_const)) / F_SiH4_0 if F_SiH4_0 > 0 else 0.0\n\n        # --- Variable Cp Model ---\n        def pfr_odes_var(V, y):\n            F_SiH4, F_H2, F_N2, T = y\n            F_T = F_SiH4 + F_H2 + F_N2\n            \n            if F_T = 1e-12 or T = 0: return np.zeros(4)\n\n            k = A_KIN * np.exp(-E_A_KIN / (R * T))\n            C_SiH4 = F_SiH4 * P / (F_T * R * T)\n            r_A = k * C_SiH4\n            \n            dF_SiH4_dV = -r_A\n            dF_H2_dV = 2 * r_A\n            dF_N2_dV = 0\n            \n            cp_sum = F_SiH4*get_cp('SiH4', T) + F_H2*get_cp('H2', T) + F_N2*get_cp('N2', T)\n            if abs(cp_sum)  1e-9: cp_sum = 1.0\n            \n            h_int_H2 = get_h_integral('H2', T)\n            h_int_SiH4 = get_h_integral('SiH4', T)\n            dH_rxn = DH_RXN_REF + 2 * h_int_H2 - h_int_SiH4\n            dT_dV = -dH_rxn * r_A / cp_sum\n            \n            return [dF_SiH4_dV, dF_H2_dV, dF_N2_dV, dT_dV]\n\n        sol_var = solve_ivp(pfr_odes_var, v_span, y0, method='BDF', rtol=1e-8, atol=1e-11)\n\n        F_SiH4_out_var = sol_var.y[0, -1]\n        T_out_var = sol_var.y[3, -1]\n        X_var = (F_SiH4_0 - max(0, F_SiH4_out_var)) / F_SiH4_0 if F_SiH4_0 > 0 else 0.0\n        \n        results.append([\n            round(X_const, 6),\n            round(X_var, 6),\n            round(T_out_const, 3),\n            round(T_out_var, 3)\n        ])\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}