{
    "hands_on_practices": [
        {
            "introduction": "当反应器中有多种化学物质同时反应时，追踪每种物质的变化可能变得复杂。引入“反应进度”（$ξ$）这一概念，可以用单个变量优雅地描述整个反应的进程。本练习  将指导您从基本物料平衡出发，运用向量-矩阵表示法，严格推导反应速率，这是高等过程建模的基石。",
            "id": "4128458",
            "problem": "一个用于化学气相沉积（CVD）的混合良好、等温、等压的气相反应器具有多个进料口和一个出口。两股进料流引入四氢化硅 $\\mathrm{SiH_4}$ 和氯化氢 $\\mathrm{HCl}$，它们发生均相气相反应\n$$\n\\mathrm{SiH_4} + 2\\,\\mathrm{HCl} \\rightarrow \\mathrm{SiH_2Cl_2} + 2\\,\\mathrm{H_2}.\n$$\n设物质的顺序为 $i=1:\\,\\mathrm{SiH_4}$、$i=2:\\,\\mathrm{HCl}$、$i=3:\\,\\mathrm{SiH_2Cl_2}$ 和 $i=4:\\,\\mathrm{H_2}$。为此单一反应定义化学计量矩阵 $\\mathbf{N} \\in \\mathbb{R}^{4\\times 1}$，约定反应物系数为负，产物系数为正。用 $\\mathbf{n}(t) \\in \\mathbb{R}^{4}$ 表示反应器中各物质总摩尔数的滞留量向量，用 $\\mathbf{F}^{\\mathrm{in},s}(t) \\in \\mathbb{R}^{4}$ 表示进料流 $s$（其中 $s=1,\\dots,S$）的摩尔流量向量，用 $\\mathbf{F}^{\\mathrm{out}}(t) \\in \\mathbb{R}^{4}$ 表示出口的摩尔流量向量。假设没有其他反应发生，并忽略壁沉积和非均相效应，因此所有生成都归因于给定的气相反应。\n\n从基本物质摩尔平衡和反应进度的定义出发，推导反应进度的时间导数 $\\frac{d\\xi}{dt}$ 的单一闭式解析表达式，该表达式需用 $\\mathbf{N}$、滞留量的时间导数 $\\frac{d\\mathbf{n}}{dt}$、入口摩尔流量向量集 $\\{\\mathbf{F}^{\\mathrm{in},s}\\}_{s=1}^{S}$ 以及出口摩尔流量向量 $\\mathbf{F}^{\\mathrm{out}}$ 来表示。最终答案必须表示为单一的解析表达式。不要进行任何数值计算。答案需精确表达，不要四舍五入。",
            "solution": "本问题要求基于一个混合良好反应器中的基本物质摩尔平衡，推导反应进度的时间导数 $\\frac{d\\xi}{dt}$ 的解析表达式。推导过程如下。\n\n首先，我们为反应器中的每种物质 $i$ 建立通用摩尔平衡。对于一个混合良好的系统，特定物质的质量守恒原理表明，该物质在控制体积（反应器）内的累积速率等于其流入速率减去流出速率，再加上其因化学反应产生的净生成速率。\n对于单一物质 $i$，该平衡表示为：\n$$\n\\frac{dn_i}{dt} = (\\text{摩尔流入速率})_i - (\\text{摩尔流出速率})_i + (\\text{摩尔生成速率})_i\n$$\n其中 $n_i(t)$ 是时刻 $t$ 反应器中物质 $i$ 的总摩尔数。\n\n问题指明有多个入口流（索引为 $s=1, \\dots, S$）和一个出口流。物质 $i$ 进入反应器的总摩尔流量是其在所有入口流中流量的总和，即 $\\sum_{s=1}^{S} F_{i}^{\\mathrm{in},s}(t)$。摩尔流出量表示为 $F_{i}^{\\mathrm{out}}(t)$。由化学反应引起的物质 $i$ 的摩尔生成速率表示为 $G_i$。因此，物质 $i$ 的平衡为：\n$$\n\\frac{dn_i}{dt} = \\sum_{s=1}^{S} F_{i}^{\\mathrm{in},s}(t) - F_{i}^{\\mathrm{out}}(t) + G_i\n$$\n\n生成速率 $G_i$ 与反应速率直接相关。反应进度 $\\xi(t)$ 是衡量反应进程的量，其定义为：由反应引起的物质 $i$ 的摩尔数变化量为 $\\Delta n_i = \\nu_i \\xi$，其中 $\\nu_i$ 是物质 $i$ 的化学计量系数（反应物为负，产物为正）。将此关系对时间求导，得到物质 $i$ 的摩尔生成速率：\n$$\nG_i = \\frac{d(\\nu_i \\xi)}{dt} = \\nu_i \\frac{d\\xi}{dt}\n$$\n此处，$\\frac{d\\xi}{dt}$ 表示反应器中发生的单一反应的总速率，单位为摩尔/单位时间。\n\n将 $G_i$ 的这个表达式代入物质摩尔平衡，得到：\n$$\n\\frac{dn_i}{dt} = \\sum_{s=1}^{S} F_{i}^{\\mathrm{in},s}(t) - F_{i}^{\\mathrm{out}}(t) + \\nu_i \\frac{d\\xi}{dt}\n$$\n该方程对系统中的4种物质均成立。我们可以将这个由四个标量方程组成的系统写成更紧凑的向量-矩阵形式。问题定义了以下向量：\n- 反应器滞留量向量：$\\mathbf{n}(t) = [n_1(t), n_2(t), n_3(t), n_4(t)]^T \\in \\mathbb{R}^4$。\n- 进料流 $s$ 的入口摩尔流量向量：$\\mathbf{F}^{\\mathrm{in},s}(t) = [F_{1}^{\\mathrm{in},s}(t), F_{2}^{\\mathrm{in},s}(t), F_{3}^{\\mathrm{in},s}(t), F_{4}^{\\mathrm{in},s}(t)]^T \\in \\mathbb{R}^4$。\n- 出口摩尔流量向量：$\\mathbf{F}^{\\mathrm{out}}(t) = [F_{1}^{\\mathrm{out}}(t), F_{2}^{\\mathrm{out}}(t), F_{3}^{\\mathrm{out}}(t), F_{4}^{\\mathrm{out}}(t)]^T \\in \\mathbb{R}^4$。\n- 化学计量矩阵（对于单一反应是一个列向量）：$\\mathbf{N} = [\\nu_1, \\nu_2, \\nu_3, \\nu_4]^T \\in \\mathbb{R}^{4\\times 1}$。\n\n使用这些定义，这四个平衡方程的系统可以写成一个单一的向量方程：\n$$\n\\frac{d\\mathbf{n}}{dt} = \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} - \\mathbf{F}^{\\mathrm{out}} + \\mathbf{N} \\frac{d\\xi}{dt}\n$$\n我们的目标是求解此方程以得到标量 $\\frac{d\\xi}{dt}$。我们首先分离出包含反应速率的项：\n$$\n\\mathbf{N} \\frac{d\\xi}{dt} = \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}}\n$$\n这是一个形如 $\\mathbf{N}x = \\mathbf{b}$ 的向量方程，其中 $x = \\frac{d\\xi}{dt}$ 是一个标量，而 $\\mathbf{N}$ 和 $\\mathbf{b} = \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}}$ 是列向量。为使该方程成立，右侧的向量必须与化学计量向量 $\\mathbf{N}$ 共线。\n\n为了求解标量 $x$，我们可以将向量方程投影到 $\\mathbf{N}$ 的方向上。在矩阵代数中，这是通过将方程两边同时左乘 $\\mathbf{N}$ 的转置矩阵（表示为 $\\mathbf{N}^T$）来实现的：\n$$\n\\mathbf{N}^T \\left( \\mathbf{N} \\frac{d\\xi}{dt} \\right) = \\mathbf{N}^T \\left( \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}} \\right)\n$$\n由于 $\\frac{d\\xi}{dt}$ 是一个标量，它可以从左侧的矩阵乘积中提出来：\n$$\n(\\mathbf{N}^T \\mathbf{N}) \\frac{d\\xi}{dt} = \\mathbf{N}^T \\left( \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}} \\right)\n$$\n项 $\\mathbf{N}^T \\mathbf{N}$ 是一个 $1 \\times 1$ 矩阵，即一个标量。它是化学计量向量与自身的点积，等价于 $\\mathbf{N}$ 的欧几里得范数的平方：\n$$\n\\mathbf{N}^T \\mathbf{N} = \\sum_{i=1}^{4} \\nu_i^2\n$$\n对于给定的反应 $\\mathrm{SiH_4} + 2\\,\\mathrm{HCl} \\rightarrow \\mathrm{SiH_2Cl_2} + 2\\,\\mathrm{H_2}$，化学计量系数为 $\\nu_1 = -1$、$\\nu_2 = -2$、$\\nu_3 = 1$ 和 $\\nu_4 = 2$。因此，$\\mathbf{N}^T \\mathbf{N} = (-1)^2 + (-2)^2 + 1^2 + 2^2 = 1 + 4 + 1 + 4 = 10$。由于正在发生反应，$\\mathbf{N}$ 是一个非零向量，因此 $\\mathbf{N}^T \\mathbf{N}$ 是一个正的非零标量。我们可以用此项相除来分离出 $\\frac{d\\xi}{dt}$。\n\n这就得到了反应进度时间导数的最终闭式解析表达式：\n$$\n\\frac{d\\xi}{dt} = \\frac{\\mathbf{N}^T \\left( \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}} \\right)}{\\mathbf{N}^T \\mathbf{N}}\n$$\n该表达式按要求以物质滞留量的时间导数、入口和出口摩尔流量向量以及反应化学计量的形式给出了反应速率。",
            "answer": "$$\n\\boxed{\\frac{\\mathbf{N}^T \\left( \\frac{d\\mathbf{n}}{dt} - \\sum_{s=1}^{S} \\mathbf{F}^{\\mathrm{in},s} + \\mathbf{F}^{\\mathrm{out}} \\right)}{\\mathbf{N}^T \\mathbf{N}}}\n$$"
        },
        {
            "introduction": "在掌握了均相气相反应后，我们将目光转向半导体工艺中至关重要的壁面效应。副产物向腔室壁和晶圆的输运，既包含穿过边界层的扩散过程，也涉及在表面的反应过程。本练习  将引导您推导出一个有效的壁面损失速率，揭示这两个过程如何构成“串联阻力”，并引出重要的质量传输限制（mass-transfer-limited） regime 概念。",
            "id": "4128391",
            "problem": "在用于半导体制造的化学气相沉积（CVD）过程中，一种气相前驱体物种 $A$ 参与一个反应网络。其中，$A$ 经历均相一级气相转化生成副产物（速率常数为 $k_{g}$），并在腔室壁上因反应/吸附而发生非均相损耗。该腔室可近似为一个体积为 $V$、由内表面积 $S$ 界定的充分混合主体，其所有邻近壁面的地方都存在一个厚度为 $\\delta$ 的准静态扩散子层。物种 $A$ 的主体摩尔浓度为 $c(t)$，分子扩散系数为 $D_{A}$。壁面吸收由吸收系数 $\\gamma$ 表征，其定义为导致反应的气体-表面分子碰撞的分数。根据动力学理论，分子对壁面的撞击由平均分子速率 $\\bar{v}$（来自Maxwell–Boltzmann分布）建模。非均相壁面反应与壁面浓度呈线性关系，其表面反应速率为 $k_{s} = \\frac{1}{4}\\,\\gamma\\,\\bar{v}$，因此反应性壁面通量为 $J_{\\mathrm{surf}} = k_{s}\\,c_{w}$，其中 $c_{w}$ 是壁面处的浓度。\n\n仅从物种守恒、Fick第一扩散定律和气体-壁面分子撞击的动力学理论出发，推导非均相壁面汇的引入如何改变物种 $A$ 的空间平均一级气相损耗速率。将壁面引起的贡献表示为一个依赖于 $S/V$、$D_{A}$、$\\delta$ 和 $k_{s}$ 的等效一级项。假设壁面附近存在一个稳态一维扩散子层，其中从主体到壁面的扩散通量 $J$ 受Fick定律控制，且主体浓度 $c(t)$ 在子层外是均匀的。\n\n然后，在高吸收极限下（即表面反应相对于扩散传输非常快，$\\gamma \\to 1$ 且 $k_{s} \\gg D_{A}/\\delta$），计算传质限制速率常数 $k_{\\mathrm{mt}} = k_{m}$。该常数定义为当壁面表现为理想吸收体时，关联壁面通量 $J$ 与主体浓度 $c$ 的系数。请用 $D_{A}$ 和 $\\delta$ 给出 $k_{m}$ 的闭式解析表达式作为最终答案。无需进行数值计算。",
            "solution": "前驱体物种 $A$ 的总损耗速率是均相气相反应和非均相壁面损耗之和。我们首先对主体体积 $V$ 内的物种 $A$ 建立质量平衡。在充分混合的主体中，$A$ 的浓度表示为 $c(t)$。$A$ 的摩尔数（即 $V c(t)$）的变化率由消耗过程决定。\n\n我们写出物种守恒方程：\n$$ V \\frac{dc}{dt} = -(\\text{气相反应损耗速率}) - (\\text{壁面损耗速率}) $$\n假设体积 $V$ 恒定。气相反应为一级反应，速率常数为 $k_g$。其单位体积的消耗速率为 $k_g c$。因此，在体积 $V$ 内的总损耗速率为 $R_{\\text{gas}} = V k_g c$。\n壁面损耗发生在整个内表面积 $S$ 上。损耗速率是表面积与物种 $A$ 从主体到壁面的通量 $J$ 的乘积。因此，$R_{\\text{wall}} = S J$。\n\n将这些项代入质量平衡方程可得：\n$$ V \\frac{dc}{dt} = -V k_g c - S J $$\n两边同除以体积 $V$，我们得到主体浓度的演化方程：\n$$ \\frac{dc}{dt} = -k_g c - \\frac{S}{V} J $$\n我们的目标是用主体浓度 $c$ 和系统参数来表示通量 $J$。题目指定在壁面附近存在一个厚度为 $\\delta$ 的准静态扩散子层。我们假设穿过该子层的输运过程是稳态、一维的。设坐标 $z$ 垂直于表面，$z=0$ 代表子层的主体侧，$z=\\delta$ 代表壁面。这些边界处的浓度分别为 $c(z=0) = c$（主体浓度）和 $c(z=\\delta) = c_w$（壁面浓度）。\n\n根据Fick第一扩散定律，通过子层的通量 $J$ 由下式给出：\n$$ J = -D_A \\frac{dc}{dz} $$\n对于一个内部无反应的稳态子层，通量 $J$ 必须不随 $z$ 变化。这意味着浓度梯度 $\\frac{dc}{dz}$ 也是恒定的，即浓度分布是线性的。因此，我们可以将梯度写为：\n$$ \\frac{dc}{dz} = \\frac{c_w - c}{\\delta} $$\n将此代入Fick定律，得到从主体到壁面的扩散通量：\n$$ J = -D_A \\left( \\frac{c_w - c}{\\delta} \\right) = \\frac{D_A}{\\delta} (c - c_w) $$\n该通量代表向表面的传质速率。\n\n在表面（$z=\\delta$）处，这个进入的扩散通量必须与表面反应引起的消耗速率相平衡。题目给出的反应性壁面通量为 $J_{\\mathrm{surf}} = k_s c_w$，其中 $k_s = \\frac{1}{4}\\gamma\\bar{v}$ 是表面反应速率。\n在稳态下，到达表面的物种通量必须等于在表面被消耗的物种通量：\n$$ J = J_{\\mathrm{surf}} $$\n$$ \\frac{D_A}{\\delta} (c - c_w) = k_s c_w $$\n这个方程使我们能够用已知的主体浓度 $c$ 来求解未知的壁面浓度 $c_w$。\n$$ \\frac{D_A}{\\delta} c - \\frac{D_A}{\\delta} c_w = k_s c_w $$\n$$ \\frac{D_A}{\\delta} c = \\left( k_s + \\frac{D_A}{\\delta} \\right) c_w $$\n$$ c_w = c \\left( \\frac{D_A/\\delta}{k_s + D_A/\\delta} \\right) = c \\left( \\frac{1}{1 + k_s\\delta/D_A} \\right) $$\n现在，通过将 $c_w$ 代回到表面通量的表达式 $J = k_s c_w$ 中，我们可以仅用主体浓度 $c$ 来表示通量 $J$：\n$$ J = k_s \\left[ c \\left( \\frac{1}{1 + k_s\\delta/D_A} \\right) \\right] = c \\left( \\frac{k_s}{1 + k_s\\delta/D_A} \\right) $$\n通过代数变换可以得到一个更有启发性的形式：\n$$ J = c \\left( \\frac{1}{\\frac{1}{k_s} + \\frac{\\delta}{D_A}} \\right) $$\n这个表达式表明，整个过程由两个串联的阻力组成：一个表面反应阻力（$1/k_s$）和一个扩散阻力（$\\delta/D_A$）。\n\n壁面引起的损耗速率贡献项为 $-\\frac{S}{V}J$。代入推导出的 $J$ 的表达式可得：\n$$ \\frac{dc}{dt} = -k_g c - \\frac{S}{V} \\left( \\frac{1}{\\frac{1}{k_s} + \\frac{\\delta}{D_A}} \\right) c $$\n这可以写成 $\\frac{dc}{dt} = -(k_g + k_{\\text{wall}})c$，其中壁面损耗的等效一级速率常数为：\n$$ k_{\\text{wall}} = \\frac{S}{V} \\left( \\frac{1}{\\frac{1}{k_s} + \\frac{\\delta}{D_A}} \\right) $$\n该表达式依赖于 $S/V$、$D_A$、$\\delta$ 和 $k_s$，正如问题第一部分所要求的。\n\n问题的第二部分要求解传质限制速率常数 $k_m$，其定义为在高吸收极限下，关联壁面通量 $J$ 与主体浓度 $c$ 的系数（$J = k_m c$）。这个极限对应于表面反应相对于扩散非常快的情况，即 $k_s \\gg D_A/\\delta$。这等价于令 $k_s \\to \\infty$。\n\n从我们通量的通用表达式 $J = c \\left( \\frac{1}{1/k_s + \\delta/D_A} \\right)$ 可知，关联 $J$ 和 $c$ 的系数是 $\\left( \\frac{1}{1/k_s + \\delta/D_A} \\right)$。\n我们现在可以通过取 $k_s \\to \\infty$ 的极限来求得 $k_m$：\n$$ k_m = \\lim_{k_s \\to \\infty} \\left( \\frac{1}{\\frac{1}{k_s} + \\frac{\\delta}{D_A}} \\right) $$\n当 $k_s \\to \\infty$ 时，$1/k_s$ 项趋于 0。表达式简化为：\n$$ k_m = \\frac{1}{0 + \\frac{\\delta}{D_A}} = \\frac{D_A}{\\delta} $$\n在此极限下，表面反应阻力可以忽略不计，壁面上的总吸收速率完全由跨越子层的扩散速率控制。这就是为什么 $k_m$ 被称为传质限制速率常数。从物理上讲，壁面充当“理想吸收体”，意味着任何到达表面的分子都会被立即消耗，从而使壁面浓度 $c_w$ 趋于零。\n在我们之前的通量方程 $J = \\frac{D_A}{\\delta} (c - c_w)$ 中令 $c_w = 0$，直接得到 $J = \\frac{D_A}{\\delta} c$，这证实了 $k_m = D_A/\\delta$。",
            "answer": "$$\n\\boxed{\\frac{D_{A}}{\\delta}}\n$$"
        },
        {
            "introduction": "现在，让我们通过模拟一个真实的反应器场景，将理论与实践联系起来。我们将对一个连续搅拌釜反应器（CSTR）进行建模，其中反应物生成副产物，这需要结合物料平衡与具体的动力学定律（质量作用定律、Arrhenius 方程）。这项计算练习  要求您求解得到的非线性方程组，以找到稳态浓度，从而探索温度和流速等工艺参数如何影响副产物的生成。",
            "id": "4128384",
            "problem": "考虑一个充分混合的连续搅拌釜反应器（CSTR），其中正在进行与半导体制造副产物形成相关的气相反应。反应器体积为 $V$，以体积流量 $\\dot{V}$ 进料，进料混合物包含四氢化硅（$\\mathrm{SiH_4}$）和氯化氢（$\\mathrm{HCl}$）。唯一的基元气相反应为 $\\mathrm{SiH_4} + 2\\mathrm{HCl} \\rightarrow \\mathrm{SiH_2Cl_2} + 2\\mathrm{H_2}$，其中副产物二氯硅烷（$\\mathrm{SiH_2Cl_2}$）和氢气（$\\mathrm{H_2}$）在气相中形成。假设反应器在温度 $T$ 下等温运行，并处于理想混合状态。\n\n从每种物质 $i$ 的稳态摩尔衡算式开始，\n$$\n0 = \\dot{V}\\left(c_{i,\\text{in}} - c_i\\right) + V \\,\\omega_i\\!\\left(c,T\\right),\n$$\n其中 $c_{i,\\text{in}}$ 是入口浓度，$c_i$ 是出口（也是反应器内）浓度。请在以下物理上合理的模型假设下，推导并求解稳态浓度 $c_{\\mathrm{SiH_4}}$、$c_{\\mathrm{HCl}}$、$c_{\\mathrm{SiH_2Cl_2}}$ 和 $c_{\\mathrm{H_2}}$：\n- 将反应视为正向的基元不可逆反应；引用质量作用定律，使得以 $\\mathrm{mol}/(\\mathrm{m^3}\\cdot \\mathrm{s})$ 为单位的反应速率 $r$ 满足 $r = k(T)\\,c_{\\mathrm{SiH_4}}\\,c_{\\mathrm{HCl}}^{2}$。\n- 通过阿伦尼乌斯关系式 $k(T) = A \\exp\\!\\left(-E/(R T)\\right)$ 将反应速率系数 $k(T)$ 与温度联系起来，其中 $A$ 为指前因子，$E$ 为活化能，$R$ 是通用气体常数。\n- 通过化学计量关系将各物质的源项 $\\omega_i$ 与标量反应速率 $r$ 联系起来：$\\omega_{\\mathrm{SiH_4}} = -r$、$\\omega_{\\mathrm{HCl}}=-2 r$、$\\omega_{\\mathrm{SiH_2Cl_2}}=+r$ 和 $\\omega_{\\mathrm{H_2}}=+2 r$。\n- 强制所有浓度为非负值，以确保物理可行性。\n\n您的任务是实现一个程序，对于每个提供的测试用例，通过求解上述原理得出的耦合非线性代数方程组，计算出稳态浓度。所有浓度单位使用 $\\mathrm{mol}/\\mathrm{m^3}$，体积单位使用 $\\mathrm{m^3}$，体积流量单位使用 $\\mathrm{m^3}/\\mathrm{s}$，温度单位使用 $\\mathrm{K}$，反应速率单位使用 $\\mathrm{mol}/(\\mathrm{m^3}\\cdot\\mathrm{s})$。报告每种浓度和反应速率，并四舍五入到六位小数。\n\n使用通用气体常数 $R = 8.314462618\\,\\mathrm{J}/(\\mathrm{mol}\\cdot\\mathrm{K})$。对于此三级基元反应速率定律，速率系数 $k(T)$ 的单位为 $\\mathrm{m^6}/(\\mathrm{mol^2}\\cdot \\mathrm{s})$。\n\n为以下参数集的测试套件实现解决方案（每个案例列出 $V$、$\\dot{V}$、$T$、$A$、$E$、$c_{\\mathrm{SiH_4},\\text{in}}$、$c_{\\mathrm{HCl},\\text{in}}$）：\n- 案例 1（一般情况）：$V = 1.0\\times 10^{-3}$，$\\dot{V} = 1.0\\times 10^{-4}$，$T = 900$，$A = 1.0\\times 10^{-5}$，$E = 4.0\\times 10^{4}$，$c_{\\mathrm{SiH_4},\\text{in}} = 10.0$，$c_{\\mathrm{HCl},\\text{in}} = 30.0$。\n- 案例 2（更高温度增加速率）：$V = 1.0\\times 10^{-3}$，$\\dot{V} = 1.0\\times 10^{-4}$，$T = 1300$，$A = 1.0\\times 10^{-5}$，$E = 4.0\\times 10^{4}$，$c_{\\mathrm{SiH_4},\\text{in}} = 10.0$，$c_{\\mathrm{HCl},\\text{in}} = 30.0$。\n- 案例 3（通过更大流量实现高度稀释）：$V = 1.0\\times 10^{-3}$，$\\dot{V} = 2.0\\times 10^{-3}$，$T = 900$，$A = 1.0\\times 10^{-5}$，$E = 4.0\\times 10^{4}$，$c_{\\mathrm{SiH_4},\\text{in}} = 10.0$，$c_{\\mathrm{HCl},\\text{in}} = 30.0$。\n- 案例 4（氯化氢限制进料）：$V = 1.0\\times 10^{-3}$，$\\dot{V} = 1.0\\times 10^{-4}$，$T = 1300$，$A = 1.0\\times 10^{-5}$，$E = 4.0\\times 10^{4}$，$c_{\\mathrm{SiH_4},\\text{in}} = 10.0$，$c_{\\mathrm{HCl},\\text{in}} = 2.0$。\n- 案例 5（无氯化氢进料，反应无法进行）：$V = 1.0\\times 10^{-3}$，$\\dot{V} = 1.0\\times 10^{-4}$，$T = 900$，$A = 1.0\\times 10^{-5}$，$E = 4.0\\times 10^{4}$，$c_{\\mathrm{SiH_4},\\text{in}} = 5.0$，$c_{\\mathrm{HCl},\\text{in}} = 0.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的各案例结果列表。每个案例的结果必须是按 $[c_{\\mathrm{SiH_4}},c_{\\mathrm{HCl}},c_{\\mathrm{SiH_2Cl_2}},c_{\\mathrm{H_2}},r]$ 顺序排列的列表，其中每个条目都四舍五入到六位小数；例如，`[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],...]`，其中每个 $x_j$ 和 $y_j$ 都是指定单位的浮点数。",
            "solution": "起点是在连续搅拌釜反应器（CSTR）中每种物质 $i$ 的稳态摩尔衡算式，表示为\n$$\n0 = \\dot{V}\\left(c_{i,\\text{in}} - c_i\\right) + V \\,\\omega_i\\!\\left(c,T\\right),\n$$\n其中 $\\dot{V}$ 是体积流量，$V$ 是反应器体积，$c_{i,\\text{in}}$ 是物质 $i$ 的入口浓度，$c_i$ 是出口（也是反应器内）浓度，而 $\\omega_i\\!\\left(c,T\\right)$ 是由反应引起的物质 $i$ 的体积源项。\n\n对于基元、不可逆气相反应 $\\mathrm{SiH_4} + 2\\mathrm{HCl} \\rightarrow \\mathrm{SiH_2Cl_2} + 2\\mathrm{H_2}$，以 $\\mathrm{mol}/(\\mathrm{m^3}\\cdot \\mathrm{s})$ 为单位的标量反应速率 $r$ 遵循质量作用定律：\n$$\nr = k(T)\\,c_{\\mathrm{SiH_4}}\\,c_{\\mathrm{HCl}}^{2}.\n$$\n速率系数 $k(T)$ 的温度依赖性由阿伦尼乌斯关系式建模：\n$$\nk(T) = A \\exp\\!\\left(-\\frac{E}{R T}\\right),\n$$\n其中 $A$ 是指前因子，单位为 $\\mathrm{m^6}/(\\mathrm{mol^2}\\cdot \\mathrm{s})$（适用于三级速率定律），$E$ 是活化能，单位为 $\\mathrm{J}/\\mathrm{mol}$，$R$ 是通用气体常数 $R = 8.314462618\\,\\mathrm{J}/(\\mathrm{mol}\\cdot\\mathrm{K})$。\n\n化学计量关系提供了每种物质的源项：\n$$\n\\omega_{\\mathrm{SiH_4}} = -r,\\quad \\omega_{\\mathrm{HCl}} = -2\\,r,\\quad \\omega_{\\mathrm{SiH_2Cl_2}} = +r,\\quad \\omega_{\\mathrm{H_2}} = +2\\,r.\n$$\n代入稳态衡算式可得\n$$\n0 = \\dot{V}\\left(c_{\\mathrm{SiH_4},\\text{in}} - c_{\\mathrm{SiH_4}}\\right) - V\\,r,\n$$\n$$\n0 = \\dot{V}\\left(c_{\\mathrm{HCl},\\text{in}} - c_{\\mathrm{HCl}}\\right) - 2 V\\,r,\n$$\n$$\n0 = \\dot{V}\\left(c_{\\mathrm{SiH_2Cl_2},\\text{in}} - c_{\\mathrm{SiH_2Cl_2}}\\right) + V\\,r,\n$$\n$$\n0 = \\dot{V}\\left(c_{\\mathrm{H_2},\\text{in}} - c_{\\mathrm{H_2}}\\right) + 2 V\\,r.\n$$\n由于进料仅包含 $\\mathrm{SiH_4}$ 和 $\\mathrm{HCl}$，我们有 $c_{\\mathrm{SiH_2Cl_2},\\text{in}} = 0$ 和 $c_{\\mathrm{H_2},\\text{in}} = 0$。定义停留时间 $\\tau = V/\\dot{V}$（单位为 $\\mathrm{s}$）以简化表达式。求解产物的线性衡算式，用 $r$ 表示可得\n$$\nc_{\\mathrm{SiH_2Cl_2}} = \\tau\\,r,\\qquad c_{\\mathrm{H_2}} = 2\\,\\tau\\,r.\n$$\n类似地，反应物浓度与 $r$ 的关系为\n$$\nc_{\\mathrm{SiH_4}} = c_{\\mathrm{SiH_4},\\text{in}} - \\tau\\,r,\\qquad c_{\\mathrm{HCl}} = c_{\\mathrm{HCl},\\text{in}} - 2 \\tau\\,r.\n$$\n如果 $r$ 位于区间内，这些关系式强制了物理上的非负性\n$$\n0 \\le r \\le r_{\\max},\\qquad r_{\\max} = \\min\\!\\left(\\frac{c_{\\mathrm{SiH_4},\\text{in}}}{\\tau},\\,\\frac{c_{\\mathrm{HCl},\\text{in}}}{2\\tau}\\right).\n$$\n未知数 $r$ 还必须满足动力学约束\n$$\nr = k(T)\\,\\Big(c_{\\mathrm{SiH_4},\\text{in}} - \\tau\\,r\\Big)\\,\\Big(c_{\\mathrm{HCl},\\text{in}} - 2\\tau\\,r\\Big)^{2}.\n$$\n定义标量函数\n$$\nf(r) = r - k(T)\\,\\Big(c_{\\mathrm{SiH_4},\\text{in}} - \\tau\\,r\\Big)\\,\\Big(c_{\\mathrm{HCl},\\text{in}} - 2\\tau\\,r\\Big)^{2}.\n$$\n对于 $k(T) \\ge 0$、$c_{\\mathrm{SiH_4},\\text{in}} \\ge 0$ 和 $c_{\\mathrm{HCl},\\text{in}} \\ge 0$，我们观察到：\n- 当 $r = 0$ 时，$f(0) = -k(T)\\,c_{\\mathrm{SiH_4},\\text{in}}\\,c_{\\mathrm{HCl},\\text{in}}^{2} \\le 0$。\n- 当 $r = r_{\\max}$ 时，根据构造，$\\Big(c_{\\mathrm{SiH_4},\\text{in}} - \\tau\\,r\\Big)$ 和 $\\Big(c_{\\mathrm{HCl},\\text{in}} - 2\\tau\\,r\\Big)$ 两个因子中至少有一个为零，因此 $f(r_{\\max}) = r_{\\max} \\ge 0$。\n因此，在 $[0, r_{\\max}]$ 区间内存在一个 $f(r) = 0$ 的物理上有意义的根，并且由于在非负性约束下，基元动力学的 $f(r)$ 在此区间上具有单调性，该根是唯一的。实践中，可以使用稳健的区间求根方法（如二分法或 Brent's method）来求解 $r$。\n\n每个测试用例的算法步骤：\n1. 计算 $\\tau = V/\\dot{V}$。\n2. 计算 $k(T) = A \\exp\\!\\left(-E/(R T)\\right)$。\n3. 计算 $r_{\\max} = \\min\\!\\left(c_{\\mathrm{SiH_4},\\text{in}}/\\tau,\\,c_{\\mathrm{HCl},\\text{in}}/(2\\tau)\\right)$。如果 $r_{\\max} = 0$ 或 $k(T) = 0$，则设 $r = 0$。\n4. 否则，求解 $f(r) = 0$ 在 $r \\in [0, r_{\\max}]$ 上的根。\n5. 计算 $c_{\\mathrm{SiH_4}} = c_{\\mathrm{SiH_4},\\text{in}} - \\tau\\,r$，$c_{\\mathrm{HCl}} = c_{\\mathrm{HCl},\\text{in}} - 2\\tau\\,r$，$c_{\\mathrm{SiH_2Cl_2}} = \\tau\\,r$ 和 $c_{\\mathrm{H_2}} = 2\\tau\\,r$。\n6. 将每个结果四舍五入到六位小数，并按要求的单位和顺序报告。\n\n该方法整合了 CSTR 的基本摩尔衡算、质量作用定律和阿伦尼乌斯动力学，同时通过非负性约束确保了物理可行性。提供的测试套件涵盖了一般情况、高温动力学增强、流量增加带来的稀释效应、限制性反应物情景，以及一个产生零反应速率的无反应物边缘案例。最终输出将每个案例的列表 $[c_{\\mathrm{SiH_4}},c_{\\mathrm{HCl}},c_{\\mathrm{SiH_2Cl_2}},c_{\\mathrm{H_2}},r]$ 汇总到单行中，如规范所述。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\nR_UNIVERSAL = 8.314462618  # J/(mol*K)\n\ndef arrhenius_k(A, E, T):\n    # k(T) = A * exp(-E/(R T))\n    return A * np.exp(-E / (R_UNIVERSAL * T))\n\ndef solve_case(V, Vdot, T, A, E, c_in_SiH4, c_in_HCl):\n    tau = V / Vdot\n    k = arrhenius_k(A, E, T)\n\n    # Define the function f(r) = r - k*(cA_in - tau*r)*(cB_in - 2*tau*r)^2\n    def f_r(r):\n        cA = c_in_SiH4 - tau * r\n        cB = c_in_HCl - 2.0 * tau * r\n        # Enforce non-negativity in evaluation domain (outside bracket should not be evaluated)\n        if cA  0 or cB  0:\n            # Outside physical domain, return a value that keeps root within bracket\n            return np.sign(r) * np.inf\n        return r - k * cA * (cB ** 2)\n\n    # Physical upper bound from non-negativity constraints\n    r_max_A = c_in_SiH4 / tau if tau > 0 else 0.0\n    r_max_B = c_in_HCl / (2.0 * tau) if tau > 0 else 0.0\n    r_max = min(r_max_A, r_max_B)\n\n    # Handle degenerate cases\n    if r_max = 0.0 or k == 0.0:\n        r = 0.0\n    else:\n        # Bracket is [0, r_max]; f(0) = 0, f(r_max) >= 0\n        # Numerical guard: ensure finite values at bounds\n        f0 = f_r(0.0)\n        fmax = r_max  # since reaction term vanishes at r_max by construction, f(r_max) = r_max\n        # Use brentq with safe bounds\n        try:\n            r = brentq(f_r, 0.0, r_max, maxiter=100, xtol=1e-12, rtol=1e-10)\n        except Exception:\n            # Fallback: if solver fails for numerical reasons, pick small or zero rate consistent with sign\n            r = 0.0 if f0 >= 0 else min(r_max, 1e-12)\n\n    # Compute concentrations\n    c_SiH4 = c_in_SiH4 - tau * r\n    c_HCl = c_in_HCl - 2.0 * tau * r\n    c_SiH2Cl2 = tau * r\n    c_H2 = 2.0 * tau * r\n\n    # Round to six decimal places\n    fmt = lambda x: f\"{x:.6f}\"\n    return [fmt(c_SiH4), fmt(c_HCl), fmt(c_SiH2Cl2), fmt(c_H2), fmt(r)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (V, Vdot, T, A, E, c_in_SiH4, c_in_HCl)\n    test_cases = [\n        (1.0e-3, 1.0e-4, 900.0, 1.0e-5, 4.0e4, 10.0, 30.0),   # Case 1\n        (1.0e-3, 1.0e-4, 1300.0, 1.0e-5, 4.0e4, 10.0, 30.0),  # Case 2\n        (1.0e-3, 2.0e-3, 900.0, 1.0e-5, 4.0e4, 10.0, 30.0),   # Case 3\n        (1.0e-3, 1.0e-4, 1300.0, 1.0e-5, 4.0e4, 10.0, 2.0),   # Case 4\n        (1.0e-3, 1.0e-4, 900.0, 1.0e-5, 4.0e4, 5.0, 0.0),     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        V, Vdot, T, A, E, c_in_SiH4, c_in_HCl = case\n        result = solve_case(V, Vdot, T, A, E, c_in_SiH4, c_in_HCl)\n        results.append(result)\n\n    # Format final output exactly as required: single line with the list of per-case lists\n    # Each element already string-formatted to six decimals.\n    def list_to_str(lst):\n        return \"[\" + \",\".join(lst) + \"]\"\n    output = \"[\" + \",\".join(list_to_str(res) for res in results) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}