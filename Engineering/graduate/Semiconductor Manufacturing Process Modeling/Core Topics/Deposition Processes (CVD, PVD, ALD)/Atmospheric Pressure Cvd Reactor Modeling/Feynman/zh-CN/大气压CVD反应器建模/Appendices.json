{
    "hands_on_practices": [
        {
            "introduction": "在应用复杂的流体动力学方程之前，我们必须首先确认气体可以被视为一种连续介质。这一判断取决于克努森数 $Kn$，它比较了分子平均自由程 $\\lambda$ 与反应器的特征长度尺度 $L$。本练习将指导您从第一性原理推导平均自由程的表达式，然后计算一个典型 AP-CVD 反应器的克努森数，从而验证在此类条件下使用连续介质模型的合理性 。",
            "id": "4108337",
            "problem": "在用于从硅烷生长二氧化硅的水平平行板反应器的常压化学气相沉积（APCVD）建模中，连续流体假设的有效性取决于克努森数，其定义为 $Kn=\\lambda/L$，其中 $\\lambda$ 是分子平均自由程，而 $L$ 是反应器的特征长度尺度。考虑一个在总压 $p=1.01325\\times 10^{5}\\ \\mathrm{Pa}$ 和气体温度 $T=1000\\ \\mathrm{K}$ 下运行的反应器。其特征长度为板间距 $L=1.0\\times 10^{-2}\\ \\mathrm{m}$。混合气体主要由载气组成，其与硅烷前驱体发生碰撞相互作用的有效硬球直径为 $d=4.0\\times 10^{-10}\\ \\mathrm{m}$。使用理想气体定律和硬球分子的分子动理论，以及平均自由程作为两次碰撞之间行进的平均距离的定义作为基本依据。\n\n仅从这些基本依据出发，首先推导稀薄气体的平均自由程 $\\lambda$ 关于 $p$、$T$、$d$ 和 $k_{B}$ 的表达式，其中 $k_{B}$ 是玻尔兹曼常数。然后，使用 $k_{B}=1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$ 对 $\\lambda$ 进行数值计算，并计算所述反应器的克努森数 $Kn=\\lambda/L$。将最终答案表示为一个纯数（无量纲），并四舍五入到三位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   系统：常压化学气相沉积（APCVD）水平平行板反应器。\n-   克努森数定义：$Kn = \\lambda/L$。\n-   分子平均自由程：$\\lambda$。\n-   反应器特征长度尺度：$L = 1.0\\times 10^{-2}\\ \\mathrm{m}$。\n-   总压：$p = 1.01325\\times 10^{5}\\ \\mathrm{Pa}$。\n-   气体温度：$T = 1000\\ \\mathrm{K}$。\n-   载气有效硬球直径：$d = 4.0\\times 10^{-10}\\ \\mathrm{m}$。\n-   推导所需的基本依据：理想气体定律、硬球分子的分子动理论、平均自由程的定义。\n-   玻尔兹曼常数：$k_{B} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$。\n-   目标1：推导 $\\lambda$ 关于 $p$、$T$、$d$ 和 $k_{B}$ 的表达式。\n-   目标2：计算 $Kn$ 的数值并四舍五入到三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题紧密基于气体动理论的原理及其在化学工程中反应器建模的应用，这是该领域的标准课题。所提供的物理参数（$p$, $T$, $L$, d）对于APCVD过程是符合实际的。\n-   **适定性：** 该问题是适定的。它提供了推导所需表达式和计算最终数值所必需的所有数据和常数。目标陈述清晰。\n-   **客观性：** 该问题以精确、客观和定量的术语陈述，没有任何主观因素。\n-   **结论：** 该问题是自洽的、科学上合理的且适定的。它被认为是**有效的**。\n\n### 解题推导\n\n主要目标是推导平均自由程 $\\lambda$ 的表达式，并随后计算克努森数 $Kn$。\n\n平均自由程 $\\lambda$ 定义为分子在相继碰撞之间行进的平均距离。它可以表示为平均分子速率 $\\langle v \\rangle$ 与碰撞频率 $\\nu$ 之比。\n$$\n\\lambda = \\frac{\\langle v \\rangle}{\\nu}\n$$\n\n对于单个分子在其他分子气体中运动的碰撞频率 $\\nu$，必须考虑所有粒子的相对运动。对于由相同硬球分子组成的气体，从分子动理论的严格推导表明，碰撞频率由下式给出：\n$$\n\\nu = n \\sigma \\langle v_{rel} \\rangle\n$$\n其中 $n$ 是分子数密度（单位体积内的分子数），$\\sigma$ 是碰撞截面，$\\langle v_{rel} \\rangle$ 是分子间的平均相对速率。对于处于热平衡状态的气体，平均相对速率与单个分子的平均速率的关系为 $\\langle v_{rel} \\rangle = \\sqrt{2} \\langle v \\rangle$。\n\n将此代入碰撞频率的表达式中，得到：\n$$\n\\nu = \\sqrt{2} n \\sigma \\langle v \\rangle\n$$\n\n现在，我们可以找到平均自由程的表达式：\n$$\n\\lambda = \\frac{\\langle v \\rangle}{\\nu} = \\frac{\\langle v \\rangle}{\\sqrt{2} n \\sigma \\langle v \\rangle} = \\frac{1}{\\sqrt{2} n \\sigma}\n$$\n\n两个直径为 $d$ 的相同硬球的碰撞截面 $\\sigma$ 是一个半径为 $d$ 的圆的面积。这是因为如果一个分子的中心进入另一个分子中心距离 $d$ 的范围内，就会发生碰撞。\n$$\n\\sigma = \\pi d^2\n$$\n\n将此代入 $\\lambda$ 的表达式中，得到：\n$$\n\\lambda = \\frac{1}{\\sqrt{2} n \\pi d^2}\n$$\n\n下一步是用气体的宏观性质（压力 $p$ 和温度 $T$）来表示数密度 $n$。按照规定，我们使用理想气体定律：\n$$\npV = N k_B T\n$$\n其中 $N$ 是体积 $V$ 内的分子总数，而 $k_B$ 是玻尔兹曼常数。数密度 $n$ 定义为 $n = N/V$。重新整理理想气体定律得到：\n$$\nn = \\frac{N}{V} = \\frac{p}{k_B T}\n$$\n\n最后，将这个 $n$ 的表达式代入我们的 $\\lambda$ 方程，就得到了所需的关系式。这完成了问题的第一部分。\n$$\n\\lambda = \\frac{1}{\\sqrt{2} \\left(\\frac{p}{k_B T}\\right) \\pi d^2} = \\frac{k_B T}{\\sqrt{2} \\pi d^2 p}\n$$\n\n### 数值计算\n\n现在我们使用所提供的数据进行数值计算：\n-   $k_{B} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$\n-   $T = 1000\\ \\mathrm{K}$\n-   $d = 4.0\\times 10^{-10}\\ \\mathrm{m}$\n-   $p = 1.01325\\times 10^{5}\\ \\mathrm{Pa}$\n-   $L = 1.0\\times 10^{-2}\\ \\mathrm{m}$\n\n首先，我们计算平均自由程 $\\lambda$：\n$$\n\\lambda = \\frac{(1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}) (1000\\ \\mathrm{K})}{\\sqrt{2} \\pi (4.0\\times 10^{-10}\\ \\mathrm{m})^2 (1.01325\\times 10^{5}\\ \\mathrm{Pa})}\n$$\n$$\n\\lambda = \\frac{1.380\\,649\\times 10^{-20}}{\\sqrt{2} \\pi (1.6\\times 10^{-19}) (1.01325\\times 10^{5})} \\ \\mathrm{m}\n$$\n$$\n\\lambda = \\frac{1.380\\,649\\times 10^{-20}}{7.20227\\times 10^{-14}} \\ \\mathrm{m} \\approx 1.91696\\times 10^{-7}\\ \\mathrm{m}\n$$\n接下来，我们使用其定义 $Kn=\\lambda/L$ 来计算克努森数 $Kn$：\n$$\nKn = \\frac{\\lambda}{L} = \\frac{1.91696\\times 10^{-7}\\ \\mathrm{m}}{1.0\\times 10^{-2}\\ \\mathrm{m}}\n$$\n$$\nKn = 1.91696\\times 10^{-5}\n$$\n问题要求最终答案四舍五入到三位有效数字。\n$$\nKn \\approx 1.92\\times 10^{-5}\n$$\n该值为无量纲，正如克努森数（两个长度之比）所预期的那样。$Kn \\ll 1$ 的值证实了连续流体假设在此反应器配置中高度有效。",
            "answer": "$$\\boxed{1.92 \\times 10^{-5}}$$"
        },
        {
            "introduction": "连续介质模型通常使用有限体积法等数值方法来求解，而模型验证是确保代码正确求解数学方程的关键一步。本练习将使用不同网格分辨率下的模拟输出，通过理查森外推法计算观测到的收敛精度阶数 $p$。这项实践将向您展示如何运用这一强大技术来估计离散化误差和验证代码的实现 。",
            "id": "4108300",
            "problem": "用于从原硅酸四乙酯沉积二氧化硅的常压化学气相沉积 (CVD) 反应器被建模为一个具有恒定物性的等温、不可压缩流动的二维层流通道。质量分数为 $Y$ 的沉积前驱体的组分守恒由稳态对流扩散方程控制，晶片处的壁面沉积通量 $J$ 根据菲克定律由壁面法向扩散通量计算得出，$J=-\\rho D\\,(\\partial Y/\\partial n)_{w}$，其中 $\\rho$ 是气体密度，$D$ 是二元扩散系数，$n$ 是指向气体内部的壁面法向坐标。采用了基于结构化网格的有限体积离散化方法，邻近晶片的法向网格间距是均匀的，记为 $h$。对于足够小的 $h$，壁面通量的数值预测值 $J(h)$ 存在离散误差，其渐近误差模型为 $J(h)=J^{\\star}+C\\,h^{p}$，其中 $J^{\\star}$ 是网格无关值，$C$ 是一个与 $h$ 无关的常数，$p$ 是壁面通量数值格式的观测精度阶。\n\n为评估网格收敛性并应用理查德森外推法，采用了三套连续加密的网格，其均匀的壁面法向间距分别为 $h_{1}$、$h_{2}$ 和 $h_{3}$，并满足恒定的加密比 $r=h_{1}/h_{2}=h_{2}/h_{3}$。网格间距分别为 $h_{1}=2.0\\times 10^{-3}$，$h_{2}=1.0\\times 10^{-3}$ 和 $h_{3}=5.0\\times 10^{-4}$，因此 $r=2$。在这些网格上计算得到的晶片壁面通量分别为 $J(h_{1})=0.118$，$J(h_{2})=0.112$ 和 $J(h_{3})=0.110$，单位均为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n仅使用渐近误差模型 $J(h)=J^{\\star}+C\\,h^{p}$ 和所提供的数据，通过网格加密和理查德森外推法论证消去 $J^{\\star}$ 和 $C$，从而推导出壁面通量预测的观测精度阶 $p$。将 $p$ 的单个值作为最终答案报告。将您的答案四舍五入到四位有效数字。由于 $p$ 是无量纲的，因此报告的答案无需单位。",
            "solution": "问题首先经过严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **模型描述**：用于常压化学气相沉积 (CVD) 的二维层流通道流，假设为等温、不可压缩且物性恒定。\n- **控制方程**：沉积前驱体质量分数 $Y$ 的稳態对流扩散方程。\n- **壁面通量计算**：晶片处的壁面沉积通量 $J$ 由菲克定律给出：$J = -\\rho D (\\partial Y/\\partial n)_{w}$，其中 $\\rho$ 是气体密度，$D$ 是二元扩散系数，$n$ 是壁面法向坐标。\n- **数值离散化**：在结构化网格上采用有限体积法，邻近晶片的壁面法向网格间距 $h$ 是均匀的。\n- **渐近误差模型**：壁面通量的数值预测值 $J(h)$ 被建模为 $J(h) = J^{\\star} + C h^{p}$，其中 $J^{\\star}$ 是网格无关值，$C$ 是一个常数，$p$ 是观测到的精度阶。\n- **网格加密数据**：\n    - 三套网格，壁面法向间距分别为 $h_{1}$、$h_{2}$ 和 $h_{3}$。\n    - 恒定加密比：$r = h_{1}/h_{2} = h_{2}/h_{3} = 2$。\n    - 网格间距：$h_{1} = 2.0 \\times 10^{-3}$，$h_{2} = 1.0 \\times 10^{-3}$ 和 $h_{3} = 5.0 \\times 10^{-4}$。\n    - 计算得到的壁面通量：$J(h_{1}) = 0.118 \\, \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$J(h_{2}) = 0.112 \\, \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 和 $J(h_{3}) = 0.110 \\, \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- **任务**：仅使用提供的模型和数据推导出观测精度阶 $p$，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于计算流体动力学和数值分析的原理，特别是用于程序验证的人工解法或网格加密研究。渐近误差模型是数值方法离散误差分析中的一个标准假设。\n- **适定性**：该问题是适定的。为一个具有三个未知参数（$J^{\\star}$、$C$、$p$）的误差模型提供了三个数据点 $(h_i, J(h_i))$。目标是确定其中一个参数 $p$，这是数值方法验证中的一个标准程序。该方程组足以求出 $p$ 的唯一解。\n- **客观性**：问题以精确、客观和定量的语言陈述。所有术语都得到了清晰的定义。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。它在科学上是合理的、适定的、客观的，并有充分且一致的数据。可以继续进行求解过程。\n\n### 求解推导\n\n该问题要求根据所提供的数据和壁面通量 $J(h)$ 的渐近误差模型，推导观测到的精度阶 $p$。该模型由下式给出：\n$$J(h) = J^{\\star} + C h^{p}$$\n其中 $J^{\\star}$ 是精确的、与网格无关的通量，$C$ 是一个与网格间距 $h$ 无关的常数，$p$ 是我们希望确定的精度阶。\n\n我们从三套间距为 $h_1  h_2  h_3$ 的连续加密网格上的模拟中获得了三个数据点：\n1. $J(h_{1}) = J_{1} = J^{\\star} + C h_{1}^{p}$\n2. $J(h_{2}) = J_{2} = J^{\\star} + C h_{2}^{p}$\n3. $J(h_{3}) = J_{3} = J^{\\star} + C h_{3}^{p}$\n\n网格加密以一个恒定的比率 $r$ 进行，定义为：\n$$r = \\frac{h_{1}}{h_{2}} = \\frac{h_{2}}{h_{3}}$$\n使用给定值 $h_{1} = 2.0 \\times 10^{-3}$、$h_{2} = 1.0 \\times 10^{-3}$ 和 $h_{3} = 5.0 \\times 10^{-4}$，我们确认 $r=2$。\n\n我们的目标是通过从这三个方程组成的方程组中消去未知常数 $J^{\\star}$ 和 $C$ 来求出 $p$。首先，我们通过将方程两两相减来消去 $J^{\\star}$：\n方程 (1) 减去方程 (2)：\n$$J_{1} - J_{2} = (J^{\\star} + C h_{1}^{p}) - (J^{\\star} + C h_{2}^{p}) = C (h_{1}^{p} - h_{2}^{p})$$\n方程 (2) 减去方程 (3)：\n$$J_{2} - J_{3} = (J^{\\star} + C h_{2}^{p}) - (J^{\\star} + C h_{3}^{p}) = C (h_{2}^{p} - h_{3}^{p})$$\n\n现在，我们可以使用恒定的加密比 $r$。我们可以写出 $h_{1} = r h_{2}$ 和 $h_{2} = r h_{3}$。将这些关系代入差分方程中：\n$$J_{1} - J_{2} = C ((r h_{2})^{p} - h_{2}^{p}) = C h_{2}^{p} (r^{p} - 1)$$\n$$J_{2} - J_{3} = C ((r h_{3})^{p} - h_{3}^{p}) = C h_{3}^{p} (r^{p} - 1)$$\n\n接下来，我们通过将这两个新方程相除来消去常数 $C$ 和项 $(r^p - 1)$。只要 $C \\neq 0$（误差不为零）且 $r^p \\neq 1$（这是成立的，因为 $r=2$ 且对于一个收敛的格式，$p$ 预期为正值），这样做就是允许的。\n$$\\frac{J_{1} - J_{2}}{J_{2} - J_{3}} = \\frac{C h_{2}^{p} (r^{p} - 1)}{C h_{3}^{p} (r^{p} - 1)} = \\frac{h_{2}^{p}}{h_{3}^{p}} = \\left(\\frac{h_{2}}{h_{3}}\\right)^{p}$$\n由于 $h_{2}/h_{3} = r$，表达式简化为：\n$$\\frac{J_{1} - J_{2}}{J_{2} - J_{3}} = r^{p}$$\n这个最终方程将可观测量（计算出的通量和加密比）与精度阶 $p$ 联系起来。为了求解 $p$，我们对等式两边取自然对数：\n$$\\ln\\left(\\frac{J_{1} - J_{2}}{J_{2} - J_{3}}\\right) = \\ln(r^{p})$$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$\\ln\\left(\\frac{J_{1} - J_{2}}{J_{2} - J_{3}}\\right) = p \\ln(r)$$\n分离出 $p$，我们得到观测精度阶的通用公式：\n$$p = \\frac{\\ln\\left(\\frac{J_{1} - J_{2}}{J_{2} - J_{3}}\\right)}{\\ln(r)}$$\n现在，我们代入问题陈述中提供的数值：\n- $J_{1} = 0.118$\n- $J_{2} = 0.112$\n- $J_{3} = 0.110$\n- $r = 2$\n\n首先，计算通量的差值：\n$$J_{1} - J_{2} = 0.118 - 0.112 = 0.006$$\n$$J_{2} - J_{3} = 0.112 - 0.110 = 0.002$$\n现在将这些值代入 $p$ 的公式中：\n$$p = \\frac{\\ln\\left(\\frac{0.006}{0.002}\\right)}{\\ln(2)} = \\frac{\\ln(3)}{\\ln(2)}$$\n最后，我们计算其数值，并按要求四舍五入到四位有效数字：\n$$p \\approx \\frac{1.0986122886...}{0.6931471805...} \\approx 1.5849625...$$\n四舍五入到四位有效数字，我们得到：\n$$p \\approx 1.585$$\n该值代表了用于预测壁面通量的数值格式的观测精度阶。",
            "answer": "$$\\boxed{1.585}$$"
        },
        {
            "introduction": "即使是经过验证的模型，其预测结果也必然存在不确定性，因为模型的输入参数（如扩散系数或反应速率）是通过实验测得的，并非绝对精确。本练习从一个经典的停滞膜模型出发，指导您实施一阶不确定性分析，以量化关键物理参数的不确定性如何影响沉积速率预测值的方差。这项动手编码练习旨在揭示在不同操作条件下，哪些参数对模型的可靠性至关重要 。",
            "id": "4108295",
            "problem": "在大气压化学气相沉积 (APCVD) 反应器中，一片晶圆暴露于一种气态前驱物中，其体相摩尔浓度为 $C_b$（单位 $\\mathrm{mol/m^3}$）。根据经典的质量传递停滞膜模型，厚度为 $h$（单位 $\\mathrm{m}$）的气相边界层将体相气体与晶圆表面分离开来。该前驱物的二元扩散系数为 $D$（单位 $\\mathrm{m^2/s}$）。在晶圆表面，前驱物通过速率常数为 $k_s$（单位 $\\mathrm{m/s}$）的一级表面反应被消耗，从而生成固体薄膜。假设系统处于稳态、等温条件，气相中的均相反应可忽略不计，且物质输运为垂直于表面的一维过程。\n\n从基本原理出发：\n- 菲克定律（一维）：通过边界层的摩尔通量大小为 $J_g = \\dfrac{D}{h}\\left(C_b - C_s\\right)$，其中 $C_s$（单位 $\\mathrm{mol/m^3}$）是表面浓度。\n- 一级表面反应：表面消耗通量为 $J_s = k_s C_s$。\n- 表面稳态平衡：沉积速率 $r$（单位 $\\mathrm{mol/m^2/s}$）等于表面消耗通量，且到达表面的气相通量等于表面反应通量。\n\n任务：\n1. 仅使用上述原理，推导沉积速率 $r$ 作为 $D$、$h$、$k_s$ 和 $C_b$ 函数的显式表达式。\n2. 执行一阶不确定度传播（线性灵敏度分析），以近似计算由 $D$、$k_s$ 和 $h$ 的不确定度引起的 $r$ 的方差。设不确定参数的向量为 $\\mathbf{x} = \\left[D,\\,k_s,\\,h\\right]^\\top$。将 $r$ 对 $\\mathbf{x}$ 的梯度（在平均参数值处计算）表示为 $\\nabla r = \\left[\\dfrac{\\partial r}{\\partial D},\\,\\dfrac{\\partial r}{\\partial k_s},\\,\\dfrac{\\partial r}{\\partial h}\\right]^\\top$。给定 $\\mathbf{x}$ 的协方差矩阵 $\\Sigma$，使用一阶近似\n$$\n\\mathrm{Var}(r) \\approx \\nabla r^\\top \\Sigma\\, \\nabla r,\n$$\n其中 $\\Sigma$ 编码了 $D$、$k_s$ 和 $h$ 在其平均值处的方差和协方差。如果参数是独立的，则 $\\Sigma$ 是一个对角矩阵，其对角线元素等于 $D$、$k_s$ 和 $h$ 的方差。\n\n实现要求：\n- 您的程序必须为每个测试用例计算标量方差 $\\mathrm{Var}(r)$，使用上述一阶近似法。\n- 使用从推导出的 $r$ 表达式中得到的解析梯度。\n- 以 $\\left(\\mathrm{mol/m^2/s}\\right)^2$ 为单位表示最终方差。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[v_1,v_2,v_3]$），其中每个 $v_i$ 是代表测试用例 $i$ 的 $\\mathrm{Var}(r)$ 的浮点数。\n\n测试套件：\n为以下 4 个科学上不同的情况提供结果。在所有情况下，将 $C_b$ 视为已知且确定的。\n\n- 情况 1（反应限制，独立不确定度）：\n  - 平均值：$D = 1.0\\times 10^{-5}\\ \\mathrm{m^2/s}$，$h = 2.0\\times 10^{-3}\\ \\mathrm{m}$，$k_s = 1.0\\times 10^{-4}\\ \\mathrm{m/s}$，$C_b = 5.0\\times 10^{-1}\\ \\mathrm{mol/m^3}$。\n  - 标准差（独立）：$\\sigma_D = 1.0\\times 10^{-6}\\ \\mathrm{m^2/s}$，$\\sigma_h = 3.0\\times 10^{-4}\\ \\mathrm{m}$，$\\sigma_{k_s} = 2.0\\times 10^{-5}\\ \\mathrm{m/s}$。\n\n- 情况 2（质量传递限制，独立不确定度）：\n  - 平均值：$D = 1.0\\times 10^{-5}\\ \\mathrm{m^2/s}$，$h = 5.0\\times 10^{-3}\\ \\mathrm{m}$，$k_s = 1.0\\times 10^{-1}\\ \\mathrm{m/s}$，$C_b = 5.0\\times 10^{-1}\\ \\mathrm{mol/m^3}$。\n  - 标准差（独立）：$\\sigma_D = 1.0\\times 10^{-6}\\ \\mathrm{m^2/s}$，$\\sigma_h = 5.0\\times 10^{-4}\\ \\mathrm{m}$，$\\sigma_{k_s} = 1.0\\times 10^{-2}\\ \\mathrm{m/s}$。\n\n- 情况 3（输运与反应平衡，相关不确定度）：\n  - 平均值：$D = 2.0\\times 10^{-5}\\ \\mathrm{m^2/s}$，$h = 1.0\\times 10^{-3}\\ \\mathrm{m}$，$k_s = 2.0\\times 10^{-2}\\ \\mathrm{m/s}$，$C_b = 1.2\\times 10^{0}\\ \\mathrm{mol/m^3}$。\n  - 标准差：$\\sigma_D = 4.0\\times 10^{-6}\\ \\mathrm{m^2/s}$，$\\sigma_h = 2.0\\times 10^{-4}\\ \\mathrm{m}$，$\\sigma_{k_s} = 4.0\\times 10^{-3}\\ \\mathrm{m/s}$。\n  - $\\left[D,\\,k_s,\\,h\\right]$ 的相关系数矩阵 $\\mathbf{R}$：\n    $$\n    \\mathbf{R} = \\begin{bmatrix}\n    1  3.0\\times 10^{-1}  -5.0\\times 10^{-1} \\\\\n    3.0\\times 10^{-1}  1  0.0\\times 10^{0} \\\\\n    -5.0\\times 10^{-1}  0.0\\times 10^{0}  1\n    \\end{bmatrix},\n    $$\n    且协方差矩阵为 $\\Sigma = \\mathrm{diag}(\\sigma_D,\\sigma_{k_s},\\sigma_h)\\ \\mathbf{R}\\ \\mathrm{diag}(\\sigma_D,\\sigma_{k_s},\\sigma_h)$。\n\n- 情况 4（扩散不确定度为零，独立不确定度）：\n  - 平均值：$D = 1.0\\times 10^{-5}\\ \\mathrm{m^2/s}$，$h = 1.0\\times 10^{-3}\\ \\mathrm{m}$，$k_s = 1.0\\times 10^{-2}\\ \\mathrm{m/s}$，$C_b = 1.0\\times 10^{0}\\ \\mathrm{mol/m^3}$。\n  - 标准差（独立）：$\\sigma_D = 0.0\\times 10^{0}\\ \\mathrm{m^2/s}$，$\\sigma_h = 1.0\\times 10^{-4}\\ \\mathrm{m}$，$\\sigma_{k_s} = 1.0\\times 10^{-3}\\ \\mathrm{m/s}$。",
            "solution": "用户想要解决一个化学气相沉积建模问题。我将首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **模型**：APCVD 反应器中基于停滞膜模型的稳态、等温、一维输运。\n- **体相摩尔浓度**：$C_b$ ($\\mathrm{mol/m^3}$)。\n- **边界层厚度**：$h$ ($\\mathrm{m}$)。\n- **二元扩散系数**：$D$ ($\\mathrm{m^2/s}$)。\n- **表面反应速率常数**：$k_s$ ($\\mathrm{m/s}$)，一级反应。\n- **表面浓度**：$C_s$ ($\\mathrm{mol/m^3}$)。\n- **基本原理**：\n    1.  菲克定律（气相通量）：$J_g = \\dfrac{D}{h}\\left(C_b - C_s\\right)$。\n    2.  一级表面反应（消耗通量）：$J_s = k_s C_s$。\n    3.  稳态平衡：沉积速率 $r = J_g = J_s$。\n- **任务 1**：推导 $r$ 作为 $D$、$h$、$k_s$ 和 $C_b$ 函数的显式表达式。\n- **任务 2**：对 $r$ 执行一阶不确定度传播。\n    - 不确定参数向量：$\\mathbf{x} = \\left[D,\\,k_s,\\,h\\right]^\\top$。\n    - $r$ 的梯度：$\\nabla r = \\left[\\dfrac{\\partial r}{\\partial D},\\,\\dfrac{\\partial r}{\\partial k_s},\\,\\dfrac{\\partial r}{\\partial h}\\right]^\\top$。\n    - 方差近似：$\\mathrm{Var}(r) \\approx \\nabla r^\\top \\Sigma\\, \\nabla r$，其中 $\\Sigma$ 是 $\\mathbf{x}$ 的协方差矩阵。\n- **测试用例**：为 $D$、$h$ 和 $k_s$ 提供了 4 组平均值和不确定度。$C_b$ 是确定的。\n    - **情况 1（反应限制，独立）**：平均值 $(\\bar{D}, \\bar{h}, \\bar{k_s}, C_b) = (1.0\\times 10^{-5}, 2.0\\times 10^{-3}, 1.0\\times 10^{-4}, 5.0\\times 10^{-1})$。标准差 $(\\sigma_D, \\sigma_h, \\sigma_{k_s}) = (1.0\\times 10^{-6}, 3.0\\times 10^{-4}, 2.0\\times 10^{-5})$。\n    - **情况 2（质量传递限制，独立）**：平均值 $(\\bar{D}, \\bar{h}, \\bar{k_s}, C_b) = (1.0\\times 10^{-5}, 5.0\\times 10^{-3}, 1.0\\times 10^{-1}, 5.0\\times 10^{-1})$。标准差 $(\\sigma_D, \\sigma_h, \\sigma_{k_s}) = (1.0\\times 10^{-6}, 5.0\\times 10^{-4}, 1.0\\times 10^{-2})$。\n    - **情况 3（平衡，相关）**：平均值 $(\\bar{D}, \\bar{h}, \\bar{k_s}, C_b) = (2.0\\times 10^{-5}, 1.0\\times 10^{-3}, 2.0\\times 10^{-2}, 1.2\\times 10^{0})$。标准差 $(\\sigma_D, \\sigma_h, \\sigma_{k_s}) = (4.0\\times 10^{-6}, 2.0\\times 10^{-4}, 4.0\\times 10^{-3})$。给出了 $[D, k_s, h]$ 的相关系数矩阵 $\\mathbf{R}$。\n    - **情况 4（扩散不确定度为零，独立）**：平均值 $(\\bar{D}, \\bar{h}, \\bar{k_s}, C_b) = (1.0\\times 10^{-5}, 1.0\\times 10^{-3}, 1.0\\times 10^{-2}, 1.0\\times 10^{0})$。标准差 $(\\sigma_D, \\sigma_h, \\sigma_{k_s}) = (0.0, 1.0\\times 10^{-4}, 1.0\\times 10^{-3})$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于标准的停滞膜模型、菲克扩散定律和一级反应动力学，这些都是化学工程和材料科学中的基本原理。它在科学上是合理的。\n- **适定性**：该问题要求基于一个明确定义的分析过程（一阶不确定度传播）进行推导和计算。所提供的数据和公式足以对每种情况得出一个唯一解。\n- **客观性**：问题以精确、定量和客观的语言陈述。\n- **完整性与一致性**：问题提供了所有必要的数据。单位（$\\mathrm{m}$、$\\mathrm{s}$、$\\mathrm{mol}$）是一致的。在情况 3 的标准差表述中存在轻微的歧义，列出的顺序 $(\\sigma_D, \\sigma_h, \\sigma_{k_s})$ 与定义的向量顺序 $[D, k_s, h]$ 不同。然而，由于标准差已明确用其各自的变量标记，可以通过将标记与定义的向量顺序匹配来解决此歧义。这不会使问题无效。\n- **可行性**：参数值对于气相 CVD 过程是物理上现实的。\n\n### 第 3 步：结论与行动\n问题是有效的。我将继续进行求解。\n\n### 第 1 部分：沉积速率 r 的推导\n沉积过程处于稳态，这意味着到达晶圆表面的前驱物气体通量 $J_g$ 必须等于前驱物被表面反应消耗的速率 $J_s$。这个共同的通量就是沉积速率 $r$。\n$$ r = J_g = J_s $$\n问题给出了这些通量的表达式：\n$$ J_g = \\frac{D}{h}(C_b - C_s) $$\n$$ J_s = k_s C_s $$\n将它们相等，我们可以解出未知的表面浓度 $C_s$：\n$$ \\frac{D}{h}(C_b - C_s) = k_s C_s $$\n$$ \\frac{D}{h}C_b - \\frac{D}{h}C_s = k_s C_s $$\n$$ \\frac{D}{h}C_b = \\left( k_s + \\frac{D}{h} \\right) C_s $$\n$$ C_s = \\frac{\\frac{D}{h}C_b}{k_s + \\frac{D}{h}} $$\n为了简化这个表达式，我们将分子和分母同乘以 $h$：\n$$ C_s = \\frac{D C_b}{k_s h + D} $$\n沉积速率 $r$ 等于表面反应通量 $J_s = k_s C_s$。代入 $C_s$ 的表达式：\n$$ r = k_s \\left( \\frac{D C_b}{D + k_s h} \\right) $$\n这给出了沉积速率作为指定参数函数的最终表达式：\n$$ r(D, k_s, h) = \\frac{D k_s C_b}{D + k_s h} $$\n\n### 第 2 部分：梯度 $\\nabla r$ 的推导\n对于不确定度传播，我们需要 $r$ 相对于不确定参数向量 $\\mathbf{x} = [D, k_s, h]^\\top$ 的梯度。这涉及到计算 $r$ 的偏导数。\n\n**1. 关于 $D$ 的偏导数：**\n使用商法则 $\\left(\\frac{f}{g}\\right)' = \\frac{f'g - fg'}{g^2}$，其中 $f = D k_s C_b$，$g = D + k_s h$：\n$$ \\frac{\\partial r}{\\partial D} = \\frac{(\\frac{\\partial}{\\partial D}(D k_s C_b))(D + k_s h) - (D k_s C_b)(\\frac{\\partial}{\\partial D}(D + k_s h))}{(D + k_s h)^2} $$\n$$ \\frac{\\partial r}{\\partial D} = \\frac{(k_s C_b)(D + k_s h) - (D k_s C_b)(1)}{(D + k_s h)^2} $$\n$$ \\frac{\\partial r}{\\partial D} = \\frac{Dk_s C_b + k_s^2 h C_b - Dk_s C_b}{(D + k_s h)^2} = \\frac{k_s^2 h C_b}{(D + k_s h)^2} $$\n\n**2. 关于 $k_s$ 的偏导数：**\n再次使用商法则，其中 $f = D k_s C_b$，$g = D + k_s h$：\n$$ \\frac{\\partial r}{\\partial k_s} = \\frac{(\\frac{\\partial}{\\partial k_s}(D k_s C_b))(D + k_s h) - (D k_s C_b)(\\frac{\\partial}{\\partial k_s}(D + k_s h))}{(D + k_s h)^2} $$\n$$ \\frac{\\partial r}{\\partial k_s} = \\frac{(D C_b)(D + k_s h) - (D k_s C_b)(h)}{(D + k_s h)^2} $$\n$$ \\frac{\\partial r}{\\partial k_s} = \\frac{D^2 C_b + D k_s h C_b - D k_s h C_b}{(D + k_s h)^2} = \\frac{D^2 C_b}{(D + k_s h)^2} $$\n\n**3. 关于 $h$ 的偏导数：**\n我们可以将 $r$ 写成 $r = (D k_s C_b)(D + k_s h)^{-1}$。使用幂法则和链式法则：\n$$ \\frac{\\partial r}{\\partial h} = (D k_s C_b) \\cdot (-1)(D + k_s h)^{-2} \\cdot (\\frac{\\partial}{\\partial h}(D + k_s h)) $$\n$$ \\frac{\\partial r}{\\partial h} = -(D k_s C_b)(D + k_s h)^{-2} \\cdot (k_s) = - \\frac{D k_s^2 C_b}{(D + k_s h)^2} $$\n\n因此，梯度向量 $\\nabla r$ 为：\n$$ \\nabla r = \\begin{bmatrix} \\frac{\\partial r}{\\partial D} \\\\ \\frac{\\partial r}{\\partial k_s} \\\\ \\frac{\\partial r}{\\partial h} \\end{bmatrix} = \\frac{C_b}{(D + k_s h)^2} \\begin{bmatrix} k_s^2 h \\\\ D^2 \\\\ -D k_s^2 \\end{bmatrix} $$\n\n### 第 3 部分：不确定度传播\n$r$ 的方差的一阶近似由下式给出：\n$$ \\mathrm{Var}(r) \\approx \\nabla r^\\top \\Sigma\\, \\nabla r $$\n梯度 $\\nabla r$ 在 $D$、$k_s$ 和 $h$ 的平均值处计算。矩阵 $\\Sigma$ 是这些参数的协方差矩阵。\n- 对于**独立不确定度**（情况 1、2、4），$\\Sigma$ 是一个对角矩阵，其对角线元素是参数的方差 ($\\sigma^2$)：\n$$ \\Sigma = \\begin{bmatrix} \\sigma_D^2  0  0 \\\\ 0  \\sigma_{k_s}^2  0 \\\\ 0  0  \\sigma_h^2 \\end{bmatrix} $$\n在这种情况下，方差公式简化为加权平方和：\n$$ \\mathrm{Var}(r) \\approx \\left(\\frac{\\partial r}{\\partial D}\\right)^2 \\sigma_D^2 + \\left(\\frac{\\partial r}{\\partial k_s}\\right)^2 \\sigma_{k_s}^2 + \\left(\\frac{\\partial r}{\\partial h}\\right)^2 \\sigma_h^2 $$\n- 对于**相关不确定度**（情况 3），协方差矩阵 $\\Sigma$ 由相关系数矩阵 $\\mathbf{R}$ 和标准差 $\\sigma_i$ 使用公式 $\\Sigma_{ij} = R_{ij} \\sigma_i \\sigma_j$ 构建。以矩阵形式表示为：\n$$ \\Sigma = \\mathbf{S}_\\sigma \\mathbf{R} \\mathbf{S}_\\sigma \\quad \\text{其中} \\quad \\mathbf{S}_\\sigma = \\mathrm{diag}(\\sigma_D, \\sigma_{k_s}, \\sigma_h) $$\n必须执行完整的矩阵乘法 $\\nabla r^\\top \\Sigma \\nabla r$。\n\n### 计算算法\n程序将为每个测试用例实现以下步骤：\n1.  接收平均值 $\\bar{D}$、$\\bar{k_s}$、$\\bar{h}$ 和已知值 $C_b$。\n2.  接收标准差 $\\sigma_D$、$\\sigma_{k_s}$、$\\sigma_h$ 以及（如果适用）相关系数矩阵 $\\mathbf{R}$。\n3.  使用推导的解析表达式，在平均参数值处计算梯度向量 $\\nabla r$ 的三个分量。\n4.  构建 $3 \\times 3$ 协方差矩阵 $\\Sigma$。\n5.  通过矩阵乘积 $\\nabla r^\\top \\Sigma \\nabla r$ 计算方差 $\\mathrm{Var}(r)$。\n6.  收集所有情况的结果，并按要求格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the APCVD uncertainty propagation problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # The order of parameters in the stdevs dictionary and S matrix construction\n    # must match the canonical problem definition: [D, k_s, h].\n    test_cases = [\n        {\n            \"name\": \"Case 1: reaction-limited, independent\",\n            \"means\": {'D': 1.0e-5, 'ks': 1.0e-4, 'h': 2.0e-3, 'Cb': 5.0e-1},\n            \"stdevs\": {'D': 1.0e-6, 'ks': 2.0e-5, 'h': 3.0e-4},\n            \"corr\": None # Independent\n        },\n        {\n            \"name\": \"Case 2: mass-transfer-limited, independent\",\n            \"means\": {'D': 1.0e-5, 'ks': 1.0e-1, 'h': 5.0e-3, 'Cb': 5.0e-1},\n            \"stdevs\": {'D': 1.0e-6, 'ks': 1.0e-2, 'h': 5.0e-4},\n            \"corr\": None # Independent\n        },\n        {\n            \"name\": \"Case 3: balanced, correlated\",\n            \"means\": {'D': 2.0e-5, 'ks': 2.0e-2, 'h': 1.0e-3, 'Cb': 1.2e0},\n            \"stdevs\": {'D': 4.0e-6, 'ks': 4.0e-3, 'h': 2.0e-4}, # Values from problem\n            \"corr\": np.array([\n                [1.0, 0.3, -0.5],\n                [0.3, 1.0,  0.0],\n                [-0.5, 0.0, 1.0]\n            ])\n        },\n        {\n            \"name\": \"Case 4: zero diffusion uncertainty, independent\",\n            \"means\": {'D': 1.0e-5, 'ks': 1.0e-2, 'h': 1.0e-3, 'Cb': 1.0e0},\n            \"stdevs\": {'D': 0.0, 'ks': 1.0e-3, 'h': 1.0e-4},\n            \"corr\": None # Independent\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract mean parameter values\n        D = case['means']['D']\n        ks = case['means']['ks']\n        h = case['means']['h']\n        Cb = case['means']['Cb']\n        \n        # Calculate the components of the gradient of r, evaluated at the mean values.\n        # The vector order is [D, ks, h].\n        # r = (D * ks * Cb) / (D + ks * h)\n        \n        common_denominator = (D + ks * h)**2\n        \n        dr_dD = (ks**2 * h * Cb) / common_denominator\n        dr_dks = (D**2 * Cb) / common_denominator\n        dr_dh = -(D * ks**2 * Cb) / common_denominator\n        \n        grad_r = np.array([dr_dD, dr_dks, dr_dh])\n        \n        # Extract standard deviations\n        sigma_D = case['stdevs']['D']\n        sigma_ks = case['stdevs']['ks']\n        sigma_h = case['stdevs']['h']\n        \n        # Construct the covariance matrix Sigma\n        if case['corr'] is None: # Independent uncertainties\n            Sigma = np.diag([sigma_D**2, sigma_ks**2, sigma_h**2])\n        else: # Correlated uncertainties\n            # Diagonal matrix of standard deviations\n            S = np.diag([sigma_D, sigma_ks, sigma_h])\n            # Correlation matrix\n            R = case['corr']\n            # Covariance matrix Sigma = S * R * S\n            Sigma = S @ R @ S\n            \n        # Calculate the variance using the first-order approximation\n        # Var(r) approx grad_r^T * Sigma * grad_r\n        variance_r = grad_r.T @ Sigma @ grad_r\n        \n        results.append(variance_r)\n\n    # Format the final output as specified\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}