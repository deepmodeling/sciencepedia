{
    "hands_on_practices": [
        {
            "introduction": "理解各向异性蚀刻的起点在于掌握晶体的基本几何学。第一个动手实践将引导你计算一个关键的角度——最常见的(100)晶圆表面与慢速蚀刻的{111}晶面之间的夹角。这个角度是决定微加工结构（如V形槽和金字塔形凹坑）轮廓的基础，是连接晶体学与实际工艺结果的桥梁。通过这个练习，你将从第一性原理出发，验证半导体制造中一个无处不在的几何常数。",
            "id": "4146570",
            "problem": "一片硅晶片由单晶锭切割而成，其表面对应于$(100)$晶面。在使用氢氧化钾（KOH）进行各向异性湿法蚀刻时，由于晶体各向异性所决定的取向依赖的蚀刻速率，沿$\\{111\\}$晶面族会形成刻蚀面。对于像硅这样的面心立方晶格，晶面$(hkl)$的法线方向平行于晶向$[h,k,l]$。仅使用米勒指数的基本定义和三维空间中的欧几里得内积，推导晶片表面法线与一个代表性的$\\{111\\}$晶面法线之间的取向角$\\theta$。计算$(100)$晶片和$(111)$刻蚀面之间的$\\theta$的数值，并以度为单位报告该角度。将最终答案四舍五入至四位有效数字。角度单位必须是度。",
            "solution": "目标是使用基本的几何定义，计算立方晶体中晶片表面法线与一个$\\{111\\}$晶面法线之间的夹角$\\theta$。在立方晶体中，晶面$(hkl)$的法线平行于晶向$[h,k,l]$。因此，$(100)$晶面的晶片表面法线平行于$[1,0,0]$，而一个代表性的$\\{111\\}$晶面法线平行于$[1,1,1]$。\n\n设$\\mathbf{n}_{100}$和$\\mathbf{n}_{111}$表示与这些法线平行的向量。我们可以选择\n$$\n\\mathbf{n}_{100} = (1,0,0), \\quad \\mathbf{n}_{111} = (1,1,1).\n$$\n在$\\mathbb{R}^{3}$中，两个向量之间夹角的欧几里得内积（点积）定义为\n$$\n\\cos\\theta = \\frac{\\mathbf{n}_{100}\\cdot\\mathbf{n}_{111}}{\\|\\mathbf{n}_{100}\\|\\,\\|\\mathbf{n}_{111}\\|}.\n$$\n使用所选的代表向量，\n$$\n\\mathbf{n}_{100}\\cdot\\mathbf{n}_{111} = (1)(1) + (0)(1) + (0)(1) = 1,\n$$\n$$\n\\|\\mathbf{n}_{100}\\| = \\sqrt{(1)^{2}+(0)^{2}+(0)^{2}} = 1, \\quad \\|\\mathbf{n}_{111}\\| = \\sqrt{(1)^{2}+(1)^{2}+(1)^{2}} = \\sqrt{3}.\n$$\n因此，\n$$\n\\cos\\theta = \\frac{1}{1\\cdot\\sqrt{3}} = \\frac{1}{\\sqrt{3}},\n$$\n且\n$$\n\\theta = \\arccos\\!\\left(\\frac{1}{\\sqrt{3}}\\right).\n$$\n为将$\\theta$表示为度，我们使用转换因子$180/\\pi$：\n$$\n\\theta_{\\text{deg}} = \\frac{180}{\\pi}\\,\\arccos\\!\\left(\\frac{1}{\\sqrt{3}}\\right).\n$$\n对该表达式进行数值计算并四舍五入至四位有效数字，得到\n$$\n\\theta_{\\text{deg}} \\approx 54.74.\n$$\n该值验证了在使用氢氧化钾（KOH）等各向异性蚀刻条件下，在$(100)$硅晶片上出现的与$\\{111\\}$晶面相关的特征刻蚀面角。",
            "answer": "$$\\boxed{54.74}$$"
        },
        {
            "introduction": "在前一个练习的基础上，我们将把学到的基本晶体学角度应用到工程实践中。这个练习展示了如何利用这个精确的角度和基本的三角函数关系，来预测微加工中常见结构——V形槽——的一个关键尺寸，即蚀刻深度。这个计算过程将抽象的晶体学概念转化为具体的、可预测的制造结果，体现了工艺建模的核心价值。",
            "id": "4146541",
            "problem": "在一个表面取向为 $(100)$ 的硅晶圆上的硬掩模上，图形化了一个宽度为 $W = 10\\,\\mu\\mathrm{m}$ 的长矩形开口。该开口沿着 $\\langle 110 \\rangle$ 方向排列，以确保形成对称的侧壁。然后，该晶圆在氢氧化钾（KOH）水溶液中进行腐蚀，该腐蚀过程具有强烈的取向依赖性，并将 $\\{111\\}$ 晶面作为腐蚀停止面。随着腐蚀的进行，会形成一个对称的V形槽，其侧壁是相交的 $\\{111\\}$ 晶面。\n\n从立方晶体的晶体学第一性原理出发，即两个晶面之间的夹角等于其法向量之间的夹角，且 $(hkl)$ 晶面的法线由方向 $[h,k,l]$ 给出，请确定相对的 $\\{111\\}$ 晶面在开口中心下方相交处的深度 $h$。仅使用矢量几何和三角关系，将晶面之间的夹角与V形槽的横截面几何形状联系起来，并假设晶面是理想、完全平坦的，没有底切或圆角。\n\n以 $\\mu\\mathrm{m}$ 为单位给出 $h$ 的最终数值，角度以度为单位，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确的，并包含了获得唯一有意义解所需的所有信息。该问题要求确定在 $(100)$ 取向硅晶圆上通过各向异性腐蚀形成的V形槽的深度。这将通过应用晶体学和矢量几何的基本原理来解决。\n\nV形槽由两个来自 $\\{111\\}$ 晶系的相交晶面形成，这些晶面充当腐蚀停止面。晶圆表面是 $(100)$ 晶面。槽的横截面几何形状由这些 $\\{111\\}$ 晶面与 $(100)$ 表面所成的夹角决定。\n\n根据立方晶系的晶体学原理，米勒指数为 $(hkl)$ 的晶面的法向量是方向向量 $[h,k,l]$。两个晶面之间的夹角等于其法向量之间的夹角。\n\n设晶圆表面为 $(100)$ 晶面。该表面的法向量为 $\\mathbf{n}_{\\text{surf}} = [1,0,0]$。\nV形槽的侧壁是 $\\{111\\}$ 晶面。由于槽的对称性，我们可以从该晶系中选择任何一个代表性晶面来计算其与表面的夹角。我们选择 $(111)$ 晶面。该晶面的法向量为 $\\mathbf{n}_{\\text{side}} = [1,1,1]$。\n\n$(100)$ 表面晶面与 $(111)$ 侧壁晶面之间的夹角 $\\phi$ 可通过其法向量的点积公式求得：\n$$\n\\cos(\\phi) = \\frac{\\mathbf{n}_{\\text{surf}} \\cdot \\mathbf{n}_{\\text{side}}}{|\\mathbf{n}_{\\text{surf}}| |\\mathbf{n}_{\\text{side}}|}\n$$\n法向量的分量为：\n$\\mathbf{n}_{\\text{surf}} = [1,0,0]$\n$\\mathbf{n}_{\\text{side}} = [1,1,1]$\n\n点积为：\n$$\n\\mathbf{n}_{\\text{surf}} \\cdot \\mathbf{n}_{\\text{side}} = (1)(1) + (0)(1) + (0)(1) = 1\n$$\n法向量的模为：\n$$\n|\\mathbf{n}_{\\text{surf}}| = \\sqrt{1^2 + 0^2 + 0^2} = \\sqrt{1} = 1\n$$\n$$\n|\\mathbf{n}_{\\text{side}}| = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\n将这些值代入余弦公式：\n$$\n\\cos(\\phi) = \\frac{1}{1 \\cdot \\sqrt{3}} = \\frac{1}{\\sqrt{3}}\n$$\n这个角度 $\\phi$ 代表了在垂直于槽排列方向的横截面中观察到的V形槽侧壁相对于水平晶圆表面的夹角。\n\n现在，我们考虑V形槽的二维横截面。它形成一个顶底宽度为 $W$、高度（深度）为 $h$ 的等腰三角形。沿其对称轴将该三角形二等分，得到两个相同的直角三角形。对于每个直角三角形：\n- 底边是开口宽度的一半，即 $\\frac{W}{2}$。\n- 高是腐蚀深度 $h$。\n- 斜边（侧壁）与水平顶边之间的夹角是我们计算出的角度 $\\phi$。\n\n在这个直角三角形中使用正切函数的定义：\n$$\n\\tan(\\phi) = \\frac{\\text{对边}}{\\text{邻边}} = \\frac{h}{W/2}\n$$\n由此，我们可以将深度 $h$ 表示为：\n$$\nh = \\frac{W}{2} \\tan(\\phi)\n$$\n我们有 $\\cos(\\phi)$ 的值，需要求 $\\tan(\\phi)$。我们可以使用三角恒等式 $\\tan^2(\\phi) + 1 = \\sec^2(\\phi) = \\frac{1}{\\cos^2(\\phi)}$。\n$$\n\\tan^2(\\phi) = \\frac{1}{\\cos^2(\\phi)} - 1\n$$\n代入 $\\cos(\\phi) = \\frac{1}{\\sqrt{3}}$：\n$$\n\\tan^2(\\phi) = \\frac{1}{(1/\\sqrt{3})^2} - 1 = \\frac{1}{1/3} - 1 = 3 - 1 = 2\n$$\n由于 $\\phi$ 是一个锐角（小于 $90^\\circ$ 或 $\\frac{\\pi}{2}$ 弧度），其正切值为正。\n$$\n\\tan(\\phi) = \\sqrt{2}\n$$\n现在，我们将这个值代回深度 $h$ 的表达式中：\n$$\nh = \\frac{W}{2} \\sqrt{2} = \\frac{W}{\\sqrt{2}}\n$$\n问题给出的开口宽度为 $W = 10\\,\\mu\\mathrm{m}$。我们现在可以计算深度 $h$ 的数值：\n$$\nh = \\frac{10\\,\\mu\\mathrm{m}}{\\sqrt{2}} = 5\\sqrt{2}\\,\\mu\\mathrm{m}\n$$\n为了得到最终的数值答案，我们计算该值并按要求四舍五入到四位有效数字。\n$$\nh \\approx 5 \\times 1.41421356... \\,\\mu\\mathrm{m} \\approx 7.0710678... \\,\\mu\\mathrm{m}\n$$\n四舍五入到四位有效数字得到：\n$$\nh \\approx 7.071\\,\\mu\\mathrm{m}\n$$",
            "answer": "$$\\boxed{7.071}$$"
        },
        {
            "introduction": "真实的蚀刻过程涉及连续变化的晶体取向，而不仅仅是几个离散的晶面。最后一个练习将引导你进入一个更高级的计算建模视角。你将通过编写一个简单的程序来模拟一个初始的圆形掩膜开孔如何根据一个给定的、依赖于方向的蚀刻速率数学模型，演变成具有特定对称性的多边形。这个实践将理论模型与最终形成的复杂形貌直接联系起来，让你亲眼见证晶体各向异性是如何“雕刻”出微观世界的。",
            "id": "4146493",
            "problem": "要求您对晶体材料中一个初始圆形掩模开口在取向依赖性腐蚀下的平面演化进行建模，并根据主导晶面预测四重或六重对称形状的出现。该建模应基于以下基本原理：局部法向速度等于局部腐蚀速率，并取决于晶体取向。假设曲率效应可忽略不计，无输运限制，且无掩模底切。在所考虑的演化时间窗口内，掩模开口相对于初始中心保持星形。角度必须以弧度处理。\n\n使用的基本原理：\n- 局部法向速度等于局部腐蚀速率：如果边界由极角 $\\theta$ 参数化，则局部法向速度为 $v_n(\\theta) = R(\\theta)$。\n- 在上述假设下，对于半径为 $r_0$ 的初始圆形边界，径向函数按 $\\frac{\\partial r(\\theta,t)}{\\partial t} = R(\\theta)$ 演化，积分后得到 $r(\\theta,T) = r_0 + \\int_0^T R(\\theta)\\,dt$。\n- 极径为 $r(\\theta)$ 的星形曲线的平面面积为 $A = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta$。\n\n使用一个经过充分检验的各向异性腐蚀速率模型，该模型将晶体对称性编码为周期性调制：\n$$\nR(\\theta) = R_0\\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right],\n$$\n其中 $R_0 > 0$ 是基准腐蚀速率，$\\varepsilon \\in [0,1)$ 是各向异性强度，$k\\in\\mathbb{Z}^+$ 表示对称阶数（例如，四重对称 $k=4$，六重对称 $k=6$），$\\theta_0$ 是一个取向偏移。初始圆形在时间 $t=0$ 时的半径为 $r_0$。演化一个有限时间 $T$。\n\n您的程序必须：\n1. 使用 $[0,2\\pi)$ 上的 $N$ 个均匀间隔的样本对角度域进行离散化。\n2. 根据上述模型，通过对法向速度进行时间积分，计算每个样本 $\\theta_i$ 的演化后极径 $r(\\theta_i)$。\n3. 使用极坐标面积公式 $A = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta$ 计算面积 $A$，并以平方微米（$\\mu\\mathrm{m}^2$）为单位将面积表示为浮点数。\n4. 通过计算 $p=4$ 和 $p=6$ 处的归一化离散傅里叶振幅来量化四重或六重对称性的出现：\n$$\na_p = \\frac{\\left|\\sum_{i=0}^{N-1} r(\\theta_i)\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}\\right|}{\\sum_{i=0}^{N-1} r(\\theta_i)},\n$$\n这会产生一个无量纲的浮点数。\n5. 使用以下规则预测主导对称性（一个整数 $k_{\\text{pred}}$）：如果 $a_4$ 和 $a_6$ 均低于阈值 $\\tau$，则返回 $0$；否则，返回产生较大振幅的 $p\\in\\{4,6\\}$。使用 $\\tau = 0.02$。\n6. 对于每个测试用例，报告一个包含 $[k_{\\text{pred}}, A, a_4, a_6]$ 的列表，其中 $k_{\\text{pred}}$ 是一个整数，$A, a_4, a_6$ 是四舍五入到六位小数的浮点数。\n\n物理和数值单位：\n- 基准腐蚀速率 $R_0$，单位为微米/分钟（$\\mu\\mathrm{m}/\\mathrm{min}$）。\n- 时间 $T$，单位为分钟（$\\mathrm{min}$）。\n- 半径 $r_0$ 和 $r(\\theta)$，单位为微米（$\\mu\\mathrm{m}$）。\n- 面积 $A$，单位为平方微米（$\\mu\\mathrm{m}^2$）。\n- 角度，单位为弧度。\n\n测试套件：\n使用以下五个参数集，涵盖典型情况、偏移、各向同性边界和接近极端的各向异性。对于每种情况，使用 $N=4096$ 个样本。\n\n- 情况 $1$（四重，中等各向异性，对齐）：$r_0=2.0\\,\\mu\\mathrm{m}$, $R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}$, $\\varepsilon=0.3$, $k=4$, $\\theta_0=0.0\\,\\mathrm{rad}$, $T=10.0\\,\\mathrm{min}$.\n- 情况 $2$（六重，中等各向异性，有偏移）：$r_0=2.0\\,\\mu\\mathrm{m}$, $R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}$, $\\varepsilon=0.25$, $k=6$, $\\theta_0=\\frac{\\pi}{6}\\,\\mathrm{rad}$, $T=10.0\\,\\mathrm{min}$.\n- 情况 $3$（各向同性参考）：$r_0=2.0\\,\\mu\\mathrm{m}$, $R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}$, $\\varepsilon=0.0$, $k=4$, $\\theta_0=0.0\\,\\mathrm{rad}$, $T=10.0\\,\\mathrm{min}$.\n- 情况 $4$（四重，强各向异性，有偏移）：$r_0=2.0\\,\\mu\\mathrm{m}$, $R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}$, $\\varepsilon=0.9$, $k=4$, $\\theta_0=\\frac{\\pi}{8}\\,\\mathrm{rad}$, $T=5.0\\,\\mathrm{min}$.\n- 情况 $5$（六重，接近阈值的弱各向异性）：$r_0=2.0\\,\\mu\\mathrm{m}$, $R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}$, $\\varepsilon=0.05$, $k=6$, $\\theta_0=0.3\\,\\mathrm{rad}$, $T=10.0\\,\\mathrm{min}$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个按情况排列的列表，这些列表以逗号分隔并用方括号括起来。例如，输出必须如下所示：\n`` `[[k_pred_1,A_1,a4_1,a6_1],[k_pred_2,A_2,a4_2,a6_2],[k_pred_3,A_3,a4_3,a6_3],[k_pred_4,A_4,a4_4,a6_4],[k_pred_5,A_5,a4_5,a6_5]]` ``\n除了整数 $k_{\\text{pred}}$ 外，所有数值条目都必须是四舍五入到六位小数的浮点数。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且客观的。它对各向异性晶体腐蚀建模中的一个标准问题提供了清晰、自包含的描述，并包含了唯一、可验证解所需的所有必要参数和定义。\n\n问题的核心是为一个由极坐标函数 $r(\\theta, t)$ 定义的形状的演化进行建模，并表征其涌现的对称性。解决方案首先推导出演化后形状的解析形式，然后指定用于计算所需度量指标的数值算法。\n\n**1. 形状演化的解析模型**\n\n腐蚀轮廓的演化由局部法向速度 $v_n(\\theta)$ 控制，该速度被设定为等于取向依赖性腐蚀速率 $R(\\theta)$。对于一个由极坐标函数 $r(\\theta, t)$ 参数化的星形边界，在忽略曲率效应的假设下，径向函数的变化率由下式给出：\n$$\n\\frac{\\partial r(\\theta,t)}{\\partial t} = v_n(\\theta) = R(\\theta)\n$$\n腐蚀速率 $R(\\theta)$ 被建模为角度 $\\theta$ 的周期函数：\n$$\nR(\\theta) = R_0\\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right]\n$$\n此处，$R_0 > 0$ 是基准腐蚀速率，$\\varepsilon \\in [0,1)$ 是各向异性强度，$k \\in \\mathbb{Z}^+$ 是对称阶数（例如，四重对称性为 $k=4$），$\\theta_0$ 是一个对应于晶体相对于坐标系取向的相位偏移。\n\n由于 $R(\\theta)$ 与时间 $t$ 无关，我们可以对演化方程从 $t=0$ 到最终时间 $t=T$ 进行时间积分。给定在 $t=0$ 时半径为 $r_0$ 的初始圆形轮廓，在时间 $T$ 时的半径函数变为：\n$$\n\\int_{r(\\theta,0)}^{r(\\theta,T)} dr = \\int_0^T R(\\theta) dt\n$$\n$$\nr(\\theta, T) - r_0 = R(\\theta) \\cdot [t]_0^T\n$$\n$$\nr(\\theta, T) = r_0 + R(\\theta) \\cdot T\n$$\n代入 $R(\\theta)$ 的表达式，我们得到演化后边界的显式解析形式：\n$$\nr(\\theta, T) = r_0 + T R_0 \\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right]\n$$\n该方程给出了在指定的演化时间 $T$ 下，任意角度 $\\theta$ 对应的极径 $r$。\n\n**2. 数值算法**\n\n为了计算所需的度量指标，我们对连续模型进行离散化。\n\n**2.1. 离散化**\n连续角度域 $[0, 2\\pi)$ 在 $N=4096$ 个离散、均匀间隔的点上进行采样。第 $i$ 个样本的角度为：\n$$\n\\theta_i = i \\cdot \\frac{2\\pi}{N} \\quad \\text{for } i = 0, 1, \\dots, N-1\n$$\n对于每个 $\\theta_i$，我们使用上面推导的解析表达式计算相应的半径 $r_i = r(\\theta_i, T)$。这将产生一个由 $N$ 个半径组成的离散向量，代表腐蚀后的形状。\n\n**2.2. 面积计算**\n由极坐标曲线 $r(\\theta)$ 所围成形状的面积 $A$ 由以下积分给出：\n$$\nA = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta\n$$\n我们使用离散样本上的黎曼和对此积分进行数值近似。无穷小元 $d\\theta$ 被离散角步长 $\\Delta\\theta = \\frac{2\\pi}{N}$ 替代。\n$$\nA \\approx \\frac{1}{2} \\sum_{i=0}^{N-1} r_i^2 \\Delta\\theta = \\frac{1}{2} \\sum_{i=0}^{N-1} r_i^2 \\left(\\frac{2\\pi}{N}\\right) = \\frac{\\pi}{N} \\sum_{i=0}^{N-1} r_i^2\n$$\n当 $N=4096$ 时，这种数值积分非常精确。所有半径的单位都是微米（$\\mu\\mathrm{m}$），因此得到的面积 $A$ 的单位是平方微米（$\\mu\\mathrm{m}^2$）。\n\n**2.3. 对称性分析**\n特定对称性的出现通过计算 $p=4$ 和 $p=6$ 的归一化离散傅里叶振幅 $a_p$ 来量化。提供的公式是：\n$$\na_p = \\frac{\\left|\\sum_{i=0}^{N-1} r_i\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}\\right|}{\\sum_{i=0}^{N-1} r_i}\n$$\n分子中的求和 $\\sum_{i=0}^{N-1} r_i\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}$ 对应于半径向量 $\\{r_i\\}$ 的离散傅里叶变换（DFT）的第 $p$ 个分量，因为 $\\theta_i = i \\frac{2\\pi}{N}$ 导致 DFT 核为 $e^{-\\mathrm{i}\\,2\\pi(pi)/N}$。这可以被高效地计算。分母是所有半径的总和，它与傅里叶级数的直流分量（$p=0$）成正比。因此，$a_p$ 表示 $p$ 重对称分量相对于平均半径的强度。\n\n**2.4. 对称性预测**\n预测的主导对称性 $k_{\\text{pred}}$ 是使用阈值 $\\tau = 0.02$ 来确定的。决策规则如下：\n- 如果 $a_4  \\tau$ 且 $a_6  \\tau$，则认为轮廓缺乏显著的四重或六重对称性，因此我们设置 $k_{\\text{pred}} = 0$。\n- 否则，主导对称性是对应于较大振幅的那一个。我们设置 $k_{\\text{pred}} = \\arg\\max_{p \\in \\{4,6\\}} a_p$。如果数值上相等，我们可以默认为 $4$。\n\n对五个提供的测试用例中的每一个都实施这个完整的算法，以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (r0, R0, epsilon, k, theta0, T)\n    test_cases = [\n        # Case 1 (fourfold, moderate anisotropy, aligned)\n        (2.0, 0.1, 0.3, 4, 0.0, 10.0),\n        # Case 2 (sixfold, moderate anisotropy, offset)\n        (2.0, 0.1, 0.25, 6, np.pi/6, 10.0),\n        # Case 3 (isotropic reference)\n        (2.0, 0.1, 0.0, 4, 0.0, 10.0),\n        # Case 4 (fourfold, strong anisotropy, offset)\n        (2.0, 0.1, 0.9, 4, np.pi/8, 5.0),\n        # Case 5 (sixfold, weak anisotropy near threshold)\n        (2.0, 0.1, 0.05, 6, 0.3, 10.0),\n    ]\n\n    # Shared numerical parameters\n    N = 4096\n    tau = 0.02\n\n    results = []\n    for case in test_cases:\n        r0, R0, epsilon, k, theta0, T = case\n        \n        # 1. Discretize the angular domain\n        theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n        \n        # 2. Compute the evolved polar radius r(theta_i)\n        # R(theta) = R0 * (1 + epsilon * cos(k * (theta - theta0)))\n        # r(theta, T) = r0 + R(theta) * T\n        etch_rate = R0 * (1 + epsilon * np.cos(k * (theta - theta0)))\n        r_evolved = r0 + etch_rate * T\n        \n        # 3. Compute the area A\n        # A = (1/2) * integral(r^2 dtheta) ~ (pi/N) * sum(r_i^2)\n        area = (np.pi / N) * np.sum(r_evolved**2)\n        \n        # 4. Compute normalized discrete Fourier amplitudes a_p for p=4 and p=6\n        # The sum in the numerator is the p-th component of the DFT.\n        r_fft = np.fft.fft(r_evolved)\n        sum_r = np.sum(r_evolved)\n\n        # Numerator is |sum(r_i * exp(-i*p*theta_i))| which is |DFT[p]|\n        # Denominator is sum(r_i)\n        if sum_r == 0:\n            a4, a6 = 0.0, 0.0\n        else:\n            a4 = np.abs(r_fft[4]) / sum_r\n            a6 = np.abs(r_fft[6]) / sum_r\n        \n        # 5. Predict the dominant symmetry k_pred\n        if a4  tau and a6  tau:\n            k_pred = 0\n        else:\n            if a4 = a6:\n                k_pred = 4\n            else:\n                k_pred = 6\n                \n        # 6. Report the results for the case, rounded as specified.\n        # [k_pred (int), A, a4, a6 (floats rounded to 6 decimal places)]\n        # Use a list of strings to preserve formatting for repr()\n        # and then convert back to original types for the final list\n        formatted_case_result = [\n            k_pred,\n            round(area, 6),\n            round(a4, 6),\n            round(a6, 6)\n        ]\n        results.append(formatted_case_result)\n\n    # Custom function to format the final output string exactly as required\n    def format_list_of_lists(list_of_lists):\n        outer_parts = []\n        for inner_list in list_of_lists:\n            inner_parts = []\n            inner_parts.append(str(inner_list[0])) # k_pred is int\n            inner_parts.append(f\"{inner_list[1]:.6f}\") # A is float\n            inner_parts.append(f\"{inner_list[2]:.6f}\") # a4 is float\n            inner_parts.append(f\"{inner_list[3]:.6f}\") # a6 is float\n            outer_parts.append(f\"[{','.join(inner_parts)}]\")\n        return f\"[{','.join(outer_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(format_list_of_lists(results))\n\n\nsolve()\n\n```"
        }
    ]
}