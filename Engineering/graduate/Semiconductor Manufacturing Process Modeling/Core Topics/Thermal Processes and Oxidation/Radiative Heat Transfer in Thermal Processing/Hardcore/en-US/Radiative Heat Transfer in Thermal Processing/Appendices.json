{
    "hands_on_practices": [
        {
            "introduction": "Understanding the spectral distribution of the energy source is the first step in any rigorous radiative heat transfer analysis. This practice explores how to calculate the fraction of power emitted by an idealized blackbody source, such as a lamp filament, within a specific wavelength range . By starting with the fundamental physics of Planck's law and employing a robust numerical integration technique, you will gain hands-on experience in quantifying the energy available from a thermal source for processes like Rapid Thermal Processing.",
            "id": "4158476",
            "problem": "A tungsten-halogen lamp array used in Rapid Thermal Processing (RTP) can be idealized as a collection of blackbody-like emitters with a filament temperature around $T \\approx 3000\\,\\mathrm{K}$. For radiative heat transfer modeling of the wafer-lamp coupling, an essential quantity is the band-limited fraction of the total blackbody emissive power emitted within a wavelength interval $[\\lambda_1,\\lambda_2]$. Starting from fundamental radiation laws appropriate for semiconductor manufacturing process modeling, implement a program that computes the dimensionless fraction\n$F(\\lambda_1,\\lambda_2;T) = \\dfrac{\\int_{\\lambda_1}^{\\lambda_2} E_\\lambda^{b}(T)\\, d\\lambda}{\\sigma T^4}$,\nwhere $E_\\lambda^{b}(T)$ is the spectral blackbody emissive power and $\\sigma$ is the Stefan–Boltzmann constant. Your derivation must begin with Planck’s law and the definition of total blackbody emissive power (the Stefan–Boltzmann law), and develop a numerically robust strategy appropriate for band integration in the near-infrared regime relevant to lamp array modeling. Do not assume any pre-tabulated blackbody fraction functions; instead, derive a numerically stable integral representation and specify a concrete numerical quadrature strategy to evaluate it for given parameters.\n\nAll physical constants you use must be standard and explicitly stated, and all calculations must be performed in the International System of Units (SI). The final reported quantity $F(\\lambda_1,\\lambda_2;T)$ is dimensionless and must be returned as a decimal number.\n\nYour program must evaluate $F(\\lambda_1,\\lambda_2;T)$ for the following test suite of parameter sets, each specified as $(\\lambda_1,\\lambda_2,T)$:\n\n- Case A (near-infrared band at tungsten-like temperature): $(0.8\\,\\mu\\mathrm{m},\\,2.5\\,\\mu\\mathrm{m},\\,3000\\,\\mathrm{K})$.\n- Case B (sanity check, full spectrum): $(0\\,\\mu\\mathrm{m},\\,+\\infty\\,\\mu\\mathrm{m},\\,3000\\,\\mathrm{K})$.\n- Case C (visible band at tungsten-like temperature): $(0.4\\,\\mu\\mathrm{m},\\,0.7\\,\\mu\\mathrm{m},\\,3000\\,\\mathrm{K})$.\n- Case D (near-infrared band at slightly cooler lamp): $(0.8\\,\\mu\\mathrm{m},\\,2.5\\,\\mu\\mathrm{m},\\,2800\\,\\mathrm{K})$.\n- Case E (degenerate band): $(1.0\\,\\mu\\mathrm{m},\\,1.0\\,\\mu\\mathrm{m},\\,3000\\,\\mathrm{K})$.\n\nInterpret $+\\infty$ as mathematical infinity. Angles are not involved. All wavelengths must be internally converted from micrometers to meters before use. The output for each case must be a single floating-point number between $0$ and $1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC,resultD,resultE]\"). Each floating-point result must be rounded to $8$ significant figures. No other text should be printed.",
            "solution": "The problem requires the computation of the band-limited fraction of total blackbody emissive power, a fundamental quantity in radiative heat transfer analysis, particularly relevant to modeling Rapid Thermal Processing (RTP) systems. The solution procedure begins with a validation of the problem statement, which is found to be scientifically sound, well-posed, and objective. The problem is based on established principles of thermal physics and is directly applicable to the specified engineering context. All provided parameters are realistic, and the requirements are self-consistent.\n\nThe core of the problem is to evaluate the dimensionless fraction $F(\\lambda_1, \\lambda_2; T)$ defined as:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} E_\\lambda^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} E_\\lambda^{b}(T)\\, d\\lambda}\n$$\nThe denominator represents the total blackbody emissive power, which, according to the Stefan–Boltzmann law, is equal to $\\sigma T^4$. The term $E_\\lambda^{b}(T)$ is the spectral blackbody emissive power, described by Planck’s law:\n$$\nE_\\lambda^{b}(T) = \\frac{2\\pi h c^2}{\\lambda^5 \\left(\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right) - 1\\right)}\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light in vacuum, $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $\\lambda$ is the wavelength.\n\nDirect numerical integration of this expression is prone to numerical instability due to the $\\lambda^5$ term at small wavelengths and potential floating-point overflow or underflow in the exponential term. A robust numerical strategy requires reformulating the integral. This is achieved through a change of variables to non-dimensionalize the integral. Let us define a dimensionless variable $x$ as:\n$$\nx = \\frac{hc}{\\lambda k_B T}\n$$\nFrom this, we can express $\\lambda$ and its differential $d\\lambda$ in terms of $x$:\n$$\n\\lambda = \\frac{hc}{x k_B T} \\quad \\implies \\quad d\\lambda = -\\frac{hc}{x^2 k_B T} dx\n$$\nThe integration limits also change. As $\\lambda$ goes from $\\lambda_1$ to $\\lambda_2$, $x$ goes from $x_2 = \\frac{hc}{\\lambda_1 k_B T}$ to $x_1 = \\frac{hc}{\\lambda_2 k_B T}$.\n\nSubstituting these into the integral in the numerator of $F(\\lambda_1, \\lambda_2; T)$:\n$$\n\\int_{\\lambda_1}^{\\lambda_2} E_\\lambda^{b}(T)\\, d\\lambda = \\int_{x_2}^{x_1} \\frac{2\\pi h c^2}{\\left(\\frac{hc}{x k_B T}\\right)^5 \\left(e^x - 1\\right)} \\left(-\\frac{hc}{x^2 k_B T}\\right) dx\n$$\nBy reversing the integration limits to cancel the negative sign and simplifying the algebraic terms, we get:\n$$\n\\int_{x_1}^{x_2} \\frac{2\\pi h c^2 (k_B T)^5 x^5}{(hc)^5 (e^x - 1)} \\frac{h c}{x^2 k_B T} dx = \\left(\\frac{2\\pi k_B^4}{h^3 c^2}\\right) T^4 \\int_{x_1}^{x_2} \\frac{x^3}{e^x - 1} dx\n$$\nThe denominator, the total emissive power, is found by letting $\\lambda_1 \\to 0$ and $\\lambda_2 \\to \\infty$, which corresponds to $x_2 \\to \\infty$ and $x_1 \\to 0$:\n$$\n\\sigma T^4 = \\int_{0}^{\\infty} E_\\lambda^{b}(T)\\, d\\lambda = \\left(\\frac{2\\pi k_B^4}{h^3 c^2}\\right) T^4 \\int_{0}^{\\infty} \\frac{x^3}{e^x - 1} dx\n$$\nThe definite integral $\\int_{0}^{\\infty} \\frac{x^3}{e^x - 1} dx$ is a standard form related to the Bose-Einstein integral and evaluates to $\\frac{\\pi^4}{15}$. This allows for a derivation of the Stefan-Boltzmann constant $\\sigma$ in terms of fundamental constants:\n$$\n\\sigma = \\frac{2\\pi k_B^4}{h^3 c^2} \\frac{\\pi^4}{15} = \\frac{2\\pi^5 k_B^4}{15 h^3 c^2}\n$$\n\nNow, the fraction $F(\\lambda_1, \\lambda_2; T)$ can be expressed as the ratio of the two transformed integrals:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\left(\\frac{2\\pi k_B^4}{h^3 c^2}\\right) T^4 \\int_{x_1}^{x_2} \\frac{x^3}{e^x - 1} dx}{\\left(\\frac{2\\pi k_B^4}{h^3 c^2}\\right) T^4 \\int_{0}^{\\infty} \\frac{x^3}{e^x - 1} dx} = \\frac{\\int_{x_1}^{x_2} \\frac{x^3}{e^x - 1} dx}{\\frac{\\pi^4}{15}}\n$$\nThis gives the final, numerically stable expression to be implemented:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{15}{\\pi^4} \\int_{\\frac{hc}{\\lambda_2 k_B T}}^{\\frac{hc}{\\lambda_1 k_B T}} \\frac{x^3}{e^x - 1} dx\n$$\nThe integrand, $f(x) = \\frac{x^3}{e^x - 1}$, is well-behaved and the integration is over a finite interval for finite, non-zero $\\lambda_1, \\lambda_2$.\n\nFor the numerical implementation, the following physical constants (2018 CODATA values) are used in SI units:\n- Planck constant, $h = 6.62607015 \\times 10^{-34}$ J·s\n- Speed of light, $c = 299792458$ m/s\n- Boltzmann constant, $k_B = 1.380649 \\times 10^{-23}$ J/K\n\nThe specified numerical quadrature strategy is to use the `quad` function from the `scipy.integrate` library. This function employs an adaptive quadrature scheme based on the QUADPACK FORTRAN library, which is robust for a wide variety of integrands, including those with integrable singularities at the endpoints. It can also handle infinite integration limits, which is necessary for Case B.\n\nThe test cases are handled as follows:\n- **Cases A, C, D**: Standard evaluation with finite, non-zero limits. Wavelengths are converted from $\\mu$m to m.\n- **Case B $(\\lambda_1=0, \\lambda_2=\\infty)$**: The integration limits for $x$ become $(\\infty, 0)$, so the integral is $\\int_0^\\infty$. The numerical integrator will compute this, and the result should be $1.0$, serving as a validation of the normalization.\n- **Case E $(\\lambda_1=\\lambda_2)$**: The integration limits are identical ($x_1=x_2$), so the integral is zero. This is handled with a conditional check to return $0.0$ directly.\n\nFor numerical precision, the term $e^x - 1$ is computed using `numpy.expm1(x)`, which maintains accuracy for small values of $x$. A safeguard is also included to handle potential overflow for very large $x$ in the integrand, where the function value tends to zero rapidly.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the blackbody radiation fraction problem for a suite of test cases.\n    The implementation follows the derivation of a numerically stable integral\n    representation of the band-limited emission fraction.\n    \"\"\"\n\n    # Physical Constants (2018 CODATA values, SI units)\n    H = 6.62607015e-34      # Planck constant (J.s)\n    C = 299792458.0         # Speed of light in vacuum (m/s)\n    K_B = 1.380649e-23      # Boltzmann constant (J/K)\n\n    # Second radiation constant, C2 = h*c/k_B (m.K)\n    C2 = H * C / K_B\n\n    def integrand(x):\n        \"\"\"\n        The non-dimensionalized integrand for the blackbody radiation function.\n        f(x) = x^3 / (exp(x) - 1).\n        \"\"\"\n        # Handle the limit at x=0, which is 0.\n        if x == 0:\n            return 0.0\n        # Prevent overflow for large x, where the integrand approaches zero.\n        # np.exp(709.78) is near floating point limit.\n        if x  709.0:\n            return 0.0\n        # np.expm1(x) provides better precision for exp(x)-1 when x is small.\n        return x**3 / np.expm1(x)\n\n    def calculate_F(lambda1_micron, lambda2_micron, T_kelvin):\n        \"\"\"\n        Calculates the fraction of blackbody radiation F in the band [lambda1, lambda2]\n        at temperature T.\n\n        Args:\n            lambda1_micron (float): Start wavelength in micrometers.\n            lambda2_micron (float): End wavelength in micrometers.\n            T_kelvin (float): Temperature in Kelvin.\n\n        Returns:\n            float: The dimensionless fraction F.\n        \"\"\"\n        # Case E: Degenerate band of zero width\n        if lambda1_micron == lambda2_micron:\n            return 0.0\n        \n        # Convert wavelengths from micrometers to meters\n        lambda1_m = lambda1_micron * 1e-6\n        lambda2_m = lambda2_micron * 1e-6\n\n        # Calculate the dimensionless integration limits x = hc / (lambda * k_B * T)\n        # Note the inverse relationship between lambda and x.\n        \n        # Upper limit x2 corresponds to lower wavelength lambda1\n        if lambda1_m == 0.0:\n            x2 = np.inf\n        else:\n            x2 = C2 / (lambda1_m * T_kelvin)\n\n        # Lower limit x1 corresponds to upper wavelength lambda2\n        if np.isinf(lambda2_m):\n            x1 = 0.0\n        else:\n            x1 = C2 / (lambda2_m * T_kelvin)\n        \n        # The integral is over [x1, x2]\n        integral_val, _ = integrate.quad(integrand, x1, x2)\n        \n        # The total integral from 0 to infinity is pi^4 / 15\n        normalization_constant = 15.0 / (np.pi**4)\n        \n        return normalization_constant * integral_val\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (lambda1_micron, lambda2_micron, T_kelvin)\n    test_cases = [\n        (0.8, 2.5, 3000.0),      # Case A\n        (0.0, np.inf, 3000.0),   # Case B\n        (0.4, 0.7, 3000.0),      # Case C\n        (0.8, 2.5, 2800.0),      # Case D\n        (1.0, 1.0, 3000.0),      # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda1, lambda2, T = case\n        fraction = calculate_F(lambda1, lambda2, T)\n        # Format the result to 8 significant figures\n        results.append(f\"{fraction:.8g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While sources can be idealized, the surfaces they heat are often spectrally selective, meaning their ability to absorb energy varies with wavelength. This exercise challenges you to move beyond the simplifying \"gray-body\" assumption and quantify the resulting error in a realistic scenario for silicon wafer heating . By comparing the absorbed power calculated with a true spectral emissivity to an approximated one, you will develop the crucial skill of critically assessing when and why common engineering models are valid.",
            "id": "4158884",
            "problem": "A silicon wafer is heated in a Rapid Thermal Processing (RTP) system by an array of tungsten–halogen lamps. Assume the wafer is spatially isothermal, macroscopically smooth, optically thick over the near-infrared spectrum of interest, and that the wafer surface behaves as a diffuse, gray–nongray emitter/absorber with negligible transmission. The lamp bank and wafer face each other with unit view factor and the chamber walls are cold and nonparticipating. The spectral irradiance of the lamp field incident on the wafer can be modeled as three narrow bands centered at wavelengths $\\lambda_{1} = 0.9\\,\\mu\\mathrm{m}$, $\\lambda_{2} = 1.1\\,\\mu\\mathrm{m}$, and $\\lambda_{3} = 1.4\\,\\mu\\mathrm{m}$ that together carry all of the incident radiant power. Let the corresponding fractions of the total incident irradiance be $f_{1} = 0.50$, $f_{2} = 0.30$, and $f_{3} = 0.20$, with $f_{1} + f_{2} + f_{3} = 1$. The total incident irradiance magnitude is $H_{i}$.\n\nOver the band $[0.8, 1.5]\\,\\mu\\mathrm{m}$, the wafer’s spectral emissivity (equal to its absorptivity by Kirchhoff’s law) is well approximated by a linear function of wavelength,\n$$\n\\varepsilon(\\lambda) = \\varepsilon_{0} + s\\left(\\lambda - \\lambda_{\\mathrm{ref}}\\right),\n$$\nwith $\\varepsilon_{0} = 0.68$, $s = 0.25\\,\\mu\\mathrm{m}^{-1}$, and $\\lambda_{\\mathrm{ref}} = 1.0\\,\\mu\\mathrm{m}$. Outside this band, the lamp spectral power is negligible.\n\nStarting from the fundamental radiative transfer statement that the absorbed irradiance equals the spectral integral of the product of the wafer absorptivity and the incident spectral irradiance, and using the narrow-band representation above, first state and justify the physical and mathematical conditions under which replacing $\\varepsilon(\\lambda)$ by a constant (the gray-body approximation) yields a negligible error in predicting the absorbed lamp power. Then, using the common practitioner’s gray approximation $\\varepsilon_{g} = \\varepsilon(\\lambda_{\\mathrm{ref}})$, quantify the relative error $\\delta$ in the predicted absorbed lamp power due to the actual spectral variation of $\\varepsilon(\\lambda)$ over the lamp spectrum. Define\n$$\n\\delta \\equiv \\frac{q_{\\mathrm{gray}} - q_{\\mathrm{exact}}}{q_{\\mathrm{exact}}},\n$$\nwhere $q_{\\mathrm{exact}}$ is the absorbed irradiance computed with the true $\\varepsilon(\\lambda)$ and $q_{\\mathrm{gray}}$ is that computed with the constant $\\varepsilon_{g}$.\n\nExpress the final answer for $\\delta$ as a dimensionless decimal number and round your answer to four significant figures. No other result should be reported as the final answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n### Step 1: Extract Givens\n-   System: A silicon wafer heated in a Rapid Thermal Processing (RTP) system.\n-   Assumptions: Wafer is spatially isothermal, macroscopically smooth, optically thick, and a diffuse, gray–nongray emitter/absorber with negligible transmission. Lamp and wafer have a unit view factor. Chamber walls are cold and nonparticipating.\n-   Incident Irradiance Model: Composed of three narrow bands.\n    -   Wavelengths: $\\lambda_{1} = 0.9\\,\\mu\\mathrm{m}$, $\\lambda_{2} = 1.1\\,\\mu\\mathrm{m}$, $\\lambda_{3} = 1.4\\,\\mu\\mathrm{m}$.\n    -   Fractions of total irradiance ($H_i$): $f_{1} = 0.50$, $f_{2} = 0.30$, $f_{3} = 0.20$. Note that $f_{1} + f_{2} + f_{3} = 1$.\n-   Wafer Spectral Emissivity/Absorptivity: In the band $[0.8, 1.5]\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = \\varepsilon_{0} + s\\left(\\lambda - \\lambda_{\\mathrm{ref}}\\right)$.\n    -   Constants: $\\varepsilon_{0} = 0.68$, $s = 0.25\\,\\mu\\mathrm{m}^{-1}$, $\\lambda_{\\mathrm{ref}} = 1.0\\,\\mu\\mathrm{m}$.\n-   Gray Approximation: $\\varepsilon_{g} = \\varepsilon(\\lambda_{\\mathrm{ref}})$.\n-   Relative Error Definition: $\\delta \\equiv \\frac{q_{\\mathrm{gray}} - q_{\\mathrm{exact}}}{q_{\\mathrm{exact}}}$, where $q_{\\mathrm{exact}}$ and $q_{\\mathrm{gray}}$ are absorbed irradiances.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the fundamental principles of radiative heat transfer, specifically spectral integration for nongray surfaces. The scenario (RTP of silicon) and the physical models (linear emissivity, narrow-band source) are common and valid approximations in engineering analysis.\n-   **Well-Posed**: The problem is clearly defined. It provides all necessary data and definitions to calculate the required quantities. The question is unambiguous and leads to a unique solution.\n-   **Objective**: The language is technical and free of subjective content.\n-   **Completeness and Consistency**: The data is self-consistent (e.g., $f_1+f_2+f_3=1$) and sufficient for the calculation. The givens are physically plausible.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe analysis is divided into two parts as requested: first, a general discussion of the gray-body approximation, and second, the specific calculation of the relative error.\n\n**Part 1: Conditions for a Valid Gray-Body Approximation**\n\nThe absorbed radiant power per unit area, or irradiance, $q_{\\mathrm{abs}}$, is determined by integrating the product of the spectral absorptivity, $\\alpha(\\lambda)$, and the incident spectral irradiance, $H_{i,\\lambda}(\\lambda)$, over all wavelengths:\n$$\nq_{\\mathrm{abs}} = \\int_{0}^{\\infty} \\alpha(\\lambda) H_{i,\\lambda}(\\lambda) \\,d\\lambda\n$$\nFor an opaque surface, Kirchhoff's law of thermal radiation states that the spectral, directional emissivity is equal to the spectral, directional absorptivity. For a diffuse surface, this simplifies to $\\varepsilon(\\lambda) = \\alpha(\\lambda)$ at each wavelength $\\lambda$. The problem states these conditions apply. Therefore, the exact absorbed irradiance is:\n$$\nq_{\\mathrm{exact}} = \\int_{0}^{\\infty} \\varepsilon(\\lambda) H_{i,\\lambda}(\\lambda) \\,d\\lambda\n$$\nThe total incident irradiance is $H_{i} = \\int_{0}^{\\infty} H_{i,\\lambda}(\\lambda) \\,d\\lambda$. We can define a source-averaged emissivity (or absorptivity), $\\bar{\\varepsilon}_{S}$, as:\n$$\n\\bar{\\varepsilon}_{S} = \\frac{\\int_{0}^{\\infty} \\varepsilon(\\lambda) H_{i,\\lambda}(\\lambda) \\,d\\lambda}{\\int_{0}^{\\infty} H_{i,\\lambda}(\\lambda) \\,d\\lambda} = \\frac{q_{\\mathrm{exact}}}{H_{i}}\n$$\nThus, $q_{\\mathrm{exact}} = \\bar{\\varepsilon}_{S} H_{i}$.\n\nA gray-body approximation assumes the emissivity is constant with wavelength, i.e., $\\varepsilon(\\lambda) = \\varepsilon_{g}$. The absorbed irradiance under this approximation is:\n$$\nq_{\\mathrm{gray}} = \\int_{0}^{\\infty} \\varepsilon_{g} H_{i,\\lambda}(\\lambda) \\,d\\lambda = \\varepsilon_{g} \\int_{0}^{\\infty} H_{i,\\lambda}(\\lambda) \\,d\\lambda = \\varepsilon_{g} H_{i}\n$$\nThe error in the gray-body approximation is negligible when $q_{\\mathrm{gray}} \\approx q_{\\mathrm{exact}}$, which implies that $\\varepsilon_{g} \\approx \\bar{\\varepsilon}_{S}$.\n\nThe physical and mathematical conditions for this are:\n1.  **Physical Condition**: The gray-body approximation is accurate if the spectral emissivity $\\varepsilon(\\lambda)$ is nearly constant over the spectral region where the incident irradiance $H_{i,\\lambda}(\\lambda)$ is significant. If the source emits in a narrow band, or if $\\varepsilon(\\lambda)$ is flat across the source's emission spectrum, the approximation will be very good.\n2.  **Mathematical Condition**: The error is zero if $\\varepsilon_{g} = \\bar{\\varepsilon}_{S}$. This means the chosen constant $\\varepsilon_g$ must equal the source-irradiance-weighted average of the true spectral emissivity. The error is small if the integral of the deviations, weighted by the source spectrum, is close to zero:\n    $$\n    \\int_{0}^{\\infty} \\left( \\varepsilon_{g} - \\varepsilon(\\lambda) \\right) H_{i,\\lambda}(\\lambda) \\,d\\lambda \\approx 0\n    $$\nThis condition implies that the positive and negative variations of $\\varepsilon(\\lambda)$ around the chosen constant $\\varepsilon_g$ must effectively cancel each other out when weighted by the spectral power distribution of the incident radiation.\n\n**Part 2: Calculation of Relative Error $\\delta$**\n\nThe problem models the incident spectral irradiance as three discrete, narrow bands, which for integration purposes can be treated as Dirac delta functions:\n$$\nH_{i,\\lambda}(\\lambda) = H_{i} \\left[ f_{1} \\delta(\\lambda - \\lambda_{1}) + f_{2} \\delta(\\lambda - \\lambda_{2}) + f_{3} \\delta(\\lambda - \\lambda_{3}) \\right]\n$$\nThe exact absorbed irradiance, $q_{\\mathrm{exact}}$, is found by substituting this into the integral and using the sifting property of the delta function:\n$$\nq_{\\mathrm{exact}} = \\int_0^\\infty \\varepsilon(\\lambda) H_{i} \\left[ f_{1} \\delta(\\lambda-\\lambda_{1}) + f_{2} \\delta(\\lambda-\\lambda_{2}) + f_{3} \\delta(\\lambda-\\lambda_{3}) \\right] d\\lambda\n$$\n$$\nq_{\\mathrm{exact}} = H_{i} \\left[ f_{1} \\varepsilon(\\lambda_{1}) + f_{2} \\varepsilon(\\lambda_{2}) + f_{3} \\varepsilon(\\lambda_{3}) \\right]\n$$\nWe calculate the emissivity values at the specified wavelengths using the given linear model, $\\varepsilon(\\lambda) = \\varepsilon_{0} + s\\left(\\lambda - \\lambda_{\\mathrm{ref}}\\right)$, with $\\varepsilon_{0} = 0.68$, $s = 0.25\\,\\mu\\mathrm{m}^{-1}$, and $\\lambda_{\\mathrm{ref}} = 1.0\\,\\mu\\mathrm{m}$.\n$$\n\\varepsilon(\\lambda_{1}) = \\varepsilon(0.9\\,\\mu\\mathrm{m}) = 0.68 + 0.25(0.9 - 1.0) = 0.68 - 0.025 = 0.655\n$$\n$$\n\\varepsilon(\\lambda_{2}) = \\varepsilon(1.1\\,\\mu\\mathrm{m}) = 0.68 + 0.25(1.1 - 1.0) = 0.68 + 0.025 = 0.705\n$$\n$$\n\\varepsilon(\\lambda_{3}) = \\varepsilon(1.4\\,\\mu\\mathrm{m}) = 0.68 + 0.25(1.4 - 1.0) = 0.68 + 0.100 = 0.780\n$$\nNow, substitute these values along with the irradiance fractions ($f_{1}=0.50$, $f_{2}=0.30$, $f_{3}=0.20$) into the expression for $q_{\\mathrm{exact}}$:\n$$\nq_{\\mathrm{exact}} = H_{i} \\left[ (0.50)(0.655) + (0.30)(0.705) + (0.20)(0.780) \\right]\n$$\n$$\nq_{\\mathrm{exact}} = H_{i} \\left[ 0.3275 + 0.2115 + 0.1560 \\right] = H_{i} (0.6950)\n$$\nThe source-averaged emissivity is thus $\\bar{\\varepsilon}_{S} = 0.6950$.\n\nNext, we calculate the absorbed irradiance using the gray approximation, $q_{\\mathrm{gray}}$. The problem specifies using $\\varepsilon_{g} = \\varepsilon(\\lambda_{\\mathrm{ref}})$.\n$$\n\\varepsilon_{g} = \\varepsilon(1.0\\,\\mu\\mathrm{m}) = 0.68 + 0.25(1.0 - 1.0) = 0.68\n$$\nSo, the absorbed irradiance in the gray approximation is:\n$$\nq_{\\mathrm{gray}} = \\varepsilon_{g} H_{i} = 0.68 H_{i}\n$$\nFinally, we compute the relative error $\\delta$ using the provided definition:\n$$\n\\delta = \\frac{q_{\\mathrm{gray}} - q_{\\mathrm{exact}}}{q_{\\mathrm{exact}}} = \\frac{0.68 H_{i} - 0.6950 H_{i}}{0.6950 H_{i}} = \\frac{0.68 - 0.6950}{0.6950}\n$$\n$$\n\\delta = \\frac{-0.0150}{0.6950} \\approx -0.0215827338...\n$$\nRounding to four significant figures, the relative error is $-0.02158$.",
            "answer": "$$\n\\boxed{-0.02158}\n$$"
        },
        {
            "introduction": "Radiative exchange depends not only on the source spectrum and surface properties but also, critically, on the geometry of the system. This practice focuses on computing the view factor, the purely geometric quantity that governs the fraction of radiation exchanged between a lamp and a wafer . Starting from first principles, you will derive the governing integral for two parallel disks and implement a numerical solution, providing essential skills for analyzing the spatial configuration of any thermal processing equipment.",
            "id": "4158513",
            "problem": "Consider Rapid Thermal Processing (RTP) in semiconductor manufacturing, where a circular wafer and a coaxial circular disk lamp are arranged parallel to each other and separated by a fixed axial distance. Let the wafer be a diffuse, gray, isothermal emitter with uniform radiative properties, and let the lamp face be a diffuse, gray, isothermal surface. Assume a vacuum environment (no participating media), no obstruction between surfaces, perfect axial alignment, and that both surfaces are planar and parallel.\n\nStarting from the fundamental definition of radiative view factor between two diffuse surfaces, define and compute the view factor from the wafer (surface $1$) to the lamp disk (surface $2$). The wafer has radius $R$ and area $A_1 = \\pi R^2$, the lamp disk has radius $a$ and area $A_2 = \\pi a^2$, and the axial separation between the planes is $H$. Let the surface normals be oriented along the axis, facing each other. Use the definition of the view factor for diffuse surfaces based on the double area integral of the configuration factor kernel, derived from energy conservation, Lambert’s cosine law, and geometrical optics in a vacuum. Explicitly state the physical assumptions used, and treat visibility as unobstructed.\n\nYou must:\n- Derive, from first principles, a configuration suitable for numerical evaluation of the view factor $F_{1 \\to 2}$ for parallel, coaxial circular disks at finite separation $H  0$.\n- Implement a robust numerical method that evaluates $F_{1 \\to 2}$ for given $(R,a,H)$ based on the derived configuration. Angles, where used in any integral, must be treated in radians.\n- Ensure numerical stability and accuracy adequate for engineering use.\n\nReturn the final numerical values of $F_{1 \\to 2}$ for the following test suite, expressed as decimal floats rounded to six decimal places. All geometric parameters are given in meters, and $F_{1 \\to 2}$ is dimensionless.\n\nTest suite:\n1. $R = 0.1$, $a = 0.1$, $H = 0.05$ (typical RTP spacing, equal radii).\n2. $R = 0.1$, $a = 0.05$, $H = 0.02$ (smaller lamp).\n3. $R = 0.1$, $a = 0.2$, $H = 0.03$ (larger lamp).\n4. $R = 0.1$, $a = 0.0$, $H = 0.01$ (degenerate lamp radius).\n5. $R = 0.1$, $a = 0.1$, $H = 10.0$ (very large separation).\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$), where each $result_i$ corresponds to the computed $F_{1 \\to 2}$ for test case $i$, rounded to six decimal places.",
            "solution": "The problem requires the derivation and numerical computation of the radiative view factor, $F_{1 \\to 2}$, from a circular disk (wafer, surface $1$) of radius $R$ to a parallel, coaxial circular disk (lamp, surface $2$) of radius $a$, separated by an axial distance $H$.\n\nThe analysis will proceed from first principles, as stipulated. The following physical assumptions, provided in the problem statement, are foundational to the derivation:\n1.  Both surfaces are diffuse and gray, meaning their radiative properties are independent of direction and wavelength.\n2.  Both surfaces are isothermal.\n3.  The intervening medium is a vacuum, so there is no absorption, emission, or scattering between the surfaces.\n4.  There are no obstructions in the path between the two surfaces.\n5.  The surfaces are planar, parallel, and perfectly aligned on a common central axis.\n\nThe view factor $F_{1 \\to 2}$ is defined as the fraction of radiation leaving surface $A_1$ that arrives directly at surface $A_2$. For diffuse surfaces, it is given by the four-dimensional integral over both areas:\n$$F_{1 \\to 2} = \\frac{1}{A_1} \\int_{A_1} \\int_{A_2} \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi S^2} dA_2 dA_1$$\nwhere $A_1 = \\pi R^2$ is the area of the wafer, $dA_1$ and $dA_2$ are differential area elements on surfaces $1$ and $2$ respectively, $S$ is the straight-line distance between $dA_1$ and $dA_2$, and $\\theta_1$ and $\\theta_2$ are the angles between the line $S$ and the surface normals at $dA_1$ and $dA_2$.\n\nTo evaluate this integral, we establish a cylindrical coordinate system. Let the wafer (surface $1$) lie in the $z=0$ plane, centered at the origin. Its boundary is defined by $r_1 \\le R$. The lamp (surface $2$) lies in the $z=H$ plane, also centered on the z-axis, with boundary $r_2 \\le a$. The surface normal for the wafer is $\\vec{n}_1 = \\hat{k}$ and for the lamp is $\\vec{n}_2 = -\\hat{k}$, as they face each other.\n\nA differential area element $dA_1$ is located at $(r_1, \\phi_1, 0)$ and a differential area element $dA_2$ is at $(r_2, \\phi_2, H)$. The vector from $dA_1$ to $dA_2$ is $\\vec{S} = (r_2 \\cos \\phi_2 - r_1 \\cos \\phi_1)\\hat{i} + (r_2 \\sin \\phi_2 - r_1 \\sin \\phi_1)\\hat{j} + H\\hat{k}$.\nThe squared distance $S^2$ is the squared magnitude of $\\vec{S}$:\n$$S^2 = (r_2 \\cos \\phi_2 - r_1 \\cos \\phi_1)^2 + (r_2 \\sin \\phi_2 - r_1 \\sin \\phi_1)^2 + H^2$$\n$$S^2 = r_1^2 + r_2^2 - 2 r_1 r_2 \\cos(\\phi_2 - \\phi_1) + H^2$$\nThe cosine terms are given by:\n$$\\cos\\theta_1 = \\frac{\\vec{S} \\cdot \\vec{n}_1}{|\\vec{S}|} = \\frac{H}{S}$$\n$$\\cos\\theta_2 = \\frac{-\\vec{S} \\cdot \\vec{n}_2}{|\\vec{S}|} = \\frac{H}{S}$$\nThus, the kernel of the view factor integral becomes:\n$$\\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi S^2} = \\frac{H^2}{\\pi S^4}$$\n\nDue to the axial symmetry of the configuration, the view factor from any differential area element $dA_1$ on a ring of radius $r_1$ to the entire disk $A_2$ is constant. We can simplify the four-dimensional integral to a triple integral by first calculating the view factor from a differential ring on surface $1$ to surface $2$, and then averaging this over the area of surface $1$.\n\nLet $dA_1$ be a ring of radius $r_1$ and width $dr_1$, so its area is $dA_1 = 2\\pi r_1 dr_1$. The view factor $F_{1 \\to 2}$ is the area-weighted average:\n$$F_{1 \\to 2} = \\frac{1}{A_1} \\int_{A_1} F_{dA_1 \\to A_2} dA_1 = \\frac{1}{\\pi R^2} \\int_0^R F_{d\\text{ring} \\to A_2} (2\\pi r_1 dr_1) = \\frac{2}{R^2} \\int_0^R r_1 F_{d\\text{ring} \\to A_2} dr_1$$\nHere, $F_{d\\text{ring} \\to A_2}$ is the view factor from any point on the ring to disk $A_2$. By symmetry, we can fix a point on the ring, say at $(r_1, 0, 0)$, and calculate its view factor to $A_2$.\n$$F_{d\\text{ring} \\to A_2} = \\int_{A_2} \\frac{H^2}{\\pi S_p^4} dA_2$$\nwhere $S_p^2$ is the distance from the point $(r_1, 0, 0)$ to a point $(r_2, \\phi_2, H)$ on surface $2$:\n$$S_p^2 = (r_2 \\cos \\phi_2 - r_1)^2 + (r_2 \\sin \\phi_2)^2 + H^2 = r_1^2 + r_2^2 - 2 r_1 r_2 \\cos\\phi_2 + H^2$$\nThe integral for $F_{d\\text{ring} \\to A_2}$ becomes:\n$$F_{d\\text{ring} \\to A_2} = \\int_0^a \\int_0^{2\\pi} \\frac{H^2}{\\pi (r_1^2 + r_2^2 - 2 r_1 r_2 \\cos\\phi_2 + H^2)^2} r_2 d\\phi_2 dr_2$$\nSubstituting this back into the expression for $F_{1 \\to 2}$:\n$$F_{1 \\to 2} = \\frac{2}{R^2} \\int_0^R r_1 \\left( \\int_0^a \\int_0^{2\\pi} \\frac{H^2 r_2}{\\pi (r_1^2 + r_2^2 - 2 r_1 r_2 \\cos\\phi_2 + H^2)^2} d\\phi_2 dr_2 \\right) dr_1$$\nRearranging the terms gives the final triple integral for numerical evaluation. Let's rename the integration variable $\\phi_2$ to $\\phi$ for simplicity.\n$$F_{1 \\to 2} = \\frac{2 H^2}{\\pi R^2} \\int_0^R \\int_0^a \\int_0^{2\\pi} \\frac{r_1 r_2}{(r_1^2 + r_2^2 + H^2 - 2 r_1 r_2 \\cos\\phi)^2} d\\phi dr_2 dr_1$$\nThis integral is well-defined for $H  0$, as the denominator is always positive. The integrand is finite and continuous over the domain of integration.\n\nThis derived expression is suitable for numerical evaluation. We will implement a solution using the `scipy.integrate.tplquad` function, which performs triple numerical quadrature. The integration will be performed with respect to $\\phi$ (from $0$ to $2\\pi$), then $r_2$ (from $0$ to $a$), then $r_1$ (from $0$ to $R$). The integrand function will compute the kernel, and the overall constant $\\frac{2 H^2}{\\pi R^2}$ will be multiplied with the numerical result of the integral.\n\nA special case is when the lamp radius $a=0$. The area $A_2$ is zero, and thus the view factor $F_{1 \\to 2}$ must be zero. This is handled by setting the upper limit of the $r_2$ integration to zero, which correctly yields a result of $0$. For computational efficiency, this case is handled with a conditional check rather than performing a zero-width integration.\nThe numerical implementation will systematically evaluate this integral for each set of parameters $(R, a, H)$ provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the view factor F_{1-2} for parallel, coaxial circular disks.\n\n    The function validates the problem, derives the integral for the view factor from\n    first principles, and then implements a numerical solution using SciPy's\n    triple quadrature integration. It processes a suite of test cases and formats\n    the output as specified.\n    \"\"\"\n\n    # Test suite: (R, a, H) in meters\n    # 1. R: Wafer radius (surface 1)\n    # 2. a: Lamp disk radius (surface 2)\n    # 3. H: Axial separation distance\n    test_cases = [\n        (0.1, 0.1, 0.05),  # typical RTP spacing, equal radii\n        (0.1, 0.05, 0.02), # smaller lamp\n        (0.1, 0.2, 0.03),  # larger lamp\n        (0.1, 0.0, 0.01),  # degenerate lamp radius\n        (0.1, 0.1, 10.0),  # very large separation\n    ]\n\n    results = []\n    \n    for R, a, H in test_cases:\n        # Handle the degenerate case where the lamp area is zero.\n        # The view factor to a zero-area surface must be zero.\n        if a == 0.0:\n            results.append(0.0)\n            continue\n            \n        # Handle the case where the wafer radius is zero (a point).\n        # The integral formulation with r1 ranging from 0 to 0 will naturally give 0,\n        # but it represents a point source, not an extended surface, and its area is zero.\n        # F_{1-2} is not strictly defined if A1=0, but the flux exchange would be zero.\n        if R == 0.0:\n            results.append(0.0) # Or handle as an invalid case, but 0.0 makes physical sense for total energy.\n            continue\n            \n        # The view factor is derived from the integral:\n        # F_{1-2} = (2 * H^2 / (pi * R^2)) * Integral(...)\n        # The integrand for the triple integral is:\n        # f(phi, r2, r1) = (r1 * r2) / (r1^2 + r2^2 + H^2 - 2*r1*r2*cos(phi))^2\n        # where the integration is d(phi) dr2 dr1.\n        \n        # We need to define the integrand for scipy.integrate.tplquad.\n        # The order of arguments for tplquad's func is f(z, y, x).\n        # Here, x=r1, y=r2, z=phi.\n        \n        def integrand(phi, r2, r1):\n            \"\"\"\n            The kernel of the triple integral for the view factor calculation.\n            \"\"\"\n            cos_phi = np.cos(phi)\n            denominator = r1**2 + r2**2 + H**2 - 2 * r1 * r2 * cos_phi\n            # The denominator is guaranteed to be  0 since H  0.\n            return (r1 * r2) / (denominator**2)\n\n        # The integration limits are:\n        # r1 from 0 to R\n        # r2 from 0 to a\n        # phi from 0 to 2*pi\n        # tplquad(func, x_min, x_max, y_min, y_max, z_min, z_max)\n        \n        # The range for y (r2) is not a function of x (r1), so we use lambda functions.\n        r2_min = lambda r1: 0\n        r2_max = lambda r1: a\n        \n        # The range for z (phi) is not a function of x or y, so we use lambda functions.\n        phi_min = lambda r1, r2: 0\n        phi_max = lambda r1, r2: 2 * np.pi\n        \n        # Perform the numerical integration.\n        integral_val, _ = integrate.tplquad(\n            integrand, \n            0, R,             # r1 limits\n            r2_min, r2_max,    # r2 limits\n            phi_min, phi_max   # phi limits\n        )\n        \n        # Calculate the final view factor using the constant pre-factor.\n        view_factor = (2 * H**2 / (np.pi * R**2)) * integral_val\n        \n        # Clamp the result to the valid range [0, 1] to handle any minor numerical errors.\n        view_factor = max(0.0, min(1.0, view_factor))\n        results.append(view_factor)\n\n    # Format the final output string as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}