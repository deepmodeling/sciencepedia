{
    "hands_on_practices": [
        {
            "introduction": "在我们开始对普雷斯顿系数进行建模或测量之前，我们必须首先理解其基本的物理性质。本练习将从最基础的量纲分析入手，拆解普雷斯顿方程，从而推导出系数 $K$ 的国际单位制（SI）基本单位。掌握这一基本技能对于确保模型的一致性和正确解读结果至关重要。",
            "id": "4156562",
            "problem": "在化学机械平坦化 (CMP) 中，一个经验线性关系被广泛用于建立厚度去除率与单位面积上施加的法向载荷以及相对滑动速度之间的函数模型。令厚度去除率表示为 $R$，施加的平均法向压强表示为 $P$，相对滑动速度表示为 $V$。假设模型形式为 $R$ 与 $P$ 和 $V$ 成正比，其比例因子 $K$ 是由工艺和材料决定的特征常数。\n\n使用量纲分析的第一性原理，从压强是单位面积上的力、力是质量乘以加速度、速度是单位时间内的长度、去除率是单位时间内的厚度这些核心定义出发。这些物理量采用以下工程单位报告：\n- $R$ 的单位为 $\\mathrm{nm/min}$，\n- $P$ 的单位为 $\\mathrm{kPa}$，\n- $V$ 的单位为 $\\mathrm{m/s}$。\n\n推导由关系式 $R = K\\,P\\,V$ 定义的比例因子 $K$ 的国际单位制 (SI) 基本量纲指数。将您的结果表示为一个有序三元组 $(a,b,c)$，使得 $K$ 的 SI 基本量纲为 $M^{a} L^{b} T^{c}$，其中 $M$ 表示质量，$L$ 表示长度，$T$ 表示时间。您的最终答案必须仅为该有序三元组。无需四舍五入。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 模型形式为经验线性关系。\n- $R$：厚度去除率。\n- $P$：施加的平均法向压强。\n- $V$：相对滑动速度。\n- 模型为 $R = KPV$，其中 $K$ 是一个比例因子。\n- 核心定义：\n    - 压强是单位面积上的力。\n    - 力是质量乘以加速度。\n    - 速度是单位时间内的长度。\n    - 去除率是单位时间内的厚度。\n- 提供的测量单位：\n    - $R$ 的单位为 $\\mathrm{nm/min}$。\n    - $P$ 的单位为 $\\mathrm{kPa}$。\n    - $V$ 的单位为 $\\mathrm{m/s}$。\n- 目标是求出比例因子 $K$ 的 SI 基本量纲指数 $(a, b, c)$，使得 $K$ 的量纲为 $[K] = M^{a} L^{b} T^{c}$。$M$、$L$ 和 $T$ 分别代表质量、长度和时间的基本量纲。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据既定的验证标准对问题进行评估。\n- **科学依据**：该问题描述了普雷斯顿方程（Preston's equation, $R \\propto PV$），这是化学机械平坦化 (CMP) 领域的一个基石经验模型。量纲分析法是物理学和工程学中一个基本且严谨的技术。所提供的物理量定义是正确的。该问题是科学合理的。\n- **适定性**：该问题提供了一个清晰的方程 $R = KPV$，并要求求解其中一项 $K$ 的量纲。所有其他量（$R$、$P$、$V$）都可以用基本的 SI 量纲（$M$、$L$、$T$）来表示。这使得 $K$ 的量纲有唯一解。给出的混合单位（例如 $\\mathrm{nm/min}$）是为了提供背景信息，并不妨碍基于物理量基本性质的量纲分析。该问题是适定的。\n- **客观性**：该问题使用精确、无歧义的语言陈述，不含主观或基于意见的内容。\n\n该问题没有违反任何无效标准。它是科学合理的、适定的、客观的、完整的且可验证的。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将推导解答过程。\n\n**解题推导**\n分析从给定的关系式开始：\n$$R = KPV$$\n为了确定比例因子 $K$ 的量纲，我们首先重新排列方程以分离出 $K$：\n$$K = \\frac{R}{P V}$$\n$K$ 的量纲，记为 $[K]$，可以通过代入 $R$、$P$ 和 $V$ 的量纲来求得：\n$$[K] = \\frac{[R]}{[P] [V]}$$\n我们现在确定 $R$、$P$ 和 $V$ 各自的 SI 基本量纲（$M$ 代表质量，$L$ 代表长度，$T$ 代表时间）。\n\n1.  **去除率 ($R$) 的量纲**：\n    去除率定义为单位时间内的厚度（一种长度）。\n    $$[R] = \\frac{[\\text{长度}]}{[\\text{时间}]} = \\frac{L}{T} = L T^{-1}$$\n    单位 $\\mathrm{nm/min}$ 在量纲上与长度/时间一致。\n\n2.  **压强 ($P$) 的量纲**：\n    压强定义为单位面积上的力。\n    $$[P] = \\frac{[\\text{力}]}{[\\text{面积}]}$$\n    力定义为质量乘以加速度。\n    $$[\\text{力}] = [\\text{质量}] \\cdot [\\text{加速度}]$$\n    加速度是单位时间内的速度（长度/时间）。\n    $$[\\text{加速度}] = \\frac{[\\text{长度}]}{[\\text{时间}]^2} = \\frac{L}{T^2} = L T^{-2}$$\n    因此，力的量纲是：\n    $$[\\text{力}] = M \\cdot L T^{-2} = M L T^{-2}$$\n    面积是长度的平方：\n    $$[\\text{面积}] = L^2$$\n    将这些代入压强量纲的表达式中：\n    $$[P] = \\frac{M L T^{-2}}{L^2} = M L^{-1} T^{-2}$$\n    单位 $\\mathrm{kPa}$（千帕斯卡）是一致的，因为帕斯卡是牛顿每平方米（$\\mathrm{N/m^2}$），而牛顿是 $\\mathrm{kg \\cdot m/s^2}$。\n\n3.  **速度 ($V$) 的量纲**：\n    速度定义为单位时间内的长度。\n    $$[V] = \\frac{[\\text{长度}]}{[\\text{时间}]} = \\frac{L}{T} = L T^{-1}$$\n    单位 $\\mathrm{m/s}$ 是速度的国际单位制单位，在量纲上是一致的。\n\n现在，我们将这些量纲代回到 $[K]$ 的方程中：\n$$[K] = \\frac{[R]}{[P] [V]} = \\frac{L T^{-1}}{(M L^{-1} T^{-2}) (L T^{-1})}$$\n首先，我们通过合并具有相同基本量纲的项来简化分母：\n$$[P] [V] = (M L^{-1} T^{-2}) (L T^{-1}) = M \\cdot L^{-1+1} \\cdot T^{-2-1} = M L^{0} T^{-3} = M T^{-3}$$\n现在，将这个简化的分母代回到 $[K]$ 的表达式中：\n$$[K] = \\frac{L T^{-1}}{M T^{-3}}$$\n最后，我们合并各项，得到 $K$ 的最终量纲：\n$$[K] = M^{-1} L^{1} T^{-1-(-3)} = M^{-1} L^{1} T^{2}$$\n问题要求将结果表示为有序三元组 $(a, b, c)$，对应于量纲形式 $M^{a} L^{b} T^{c}$ 中的指数。通过将 $M^{-1} L^{1} T^{2}$ 与通用形式进行比较，我们确定指数为：\n$$a = -1$$\n$$b = 1$$\n$$c = 2$$\n得到的有序三元组是 $(-1, 1, 2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从理论走向实践，本练习将直面所有测量都存在误差的现实。利用一个假设的化学机械平坦化（CMP）实验数据，您将运用不确定性传播原理，估算计算出的普雷斯顿系数 $K$ 的不确定性。这项练习不仅能为您的估算结果提供一个置信水平，还能帮助您识别哪个测量值对总体不确定性的贡献最大，从而为改进未来的实验设计提供指导。",
            "id": "4156545",
            "problem": "在一次用于半导体制造过程建模的化学机械平坦化 (CMP) 实验中，材料去除率由Preston关系式建模，其中去除率 $R$ 通过一个比例系数（Preston系数）$K$ 与下压力 $P$ 和相对滑动速度 $V$ 成正比。测量得到以下平均值和标准不确定度（一个标准差），所有值均假定为统计独立的：\n\n- 压力：$P = 30.0\\ \\mathrm{kPa}$，标准不确定度 $u_{P} = 0.50\\ \\mathrm{kPa}$。\n- 相对速度：$V = 0.600\\ \\mathrm{m/s}$，标准不确定度 $u_{V} = 0.030\\ \\mathrm{m/s}$。\n- 去除率：$R = 180\\ \\mathrm{nm/min}$，标准不确定度 $u_{R} = 10\\ \\mathrm{nm/min}$。\n\n在小且独立的不确定度假设下，使用线性（一阶）不确定度传播来量化 $P$、$V$ 和 $R$ 的不确定度如何传播到 $K$ 的估计值中。具体要求如下：\n\n1. 从第一性原理和定义出发，推导绝对标准不确定度 $u_{K}$ 的解析表达式，用 $K$、$P$、$V$、$R$ 以及标准不确定度 $u_{P}$、$u_{V}$、$u_{R}$ 表示。\n2. 使用所提供的数据，将所有量转换为一致的国际单位制 (SI) 单位，数值计算 $K$ 和 $u_{K}$。\n3. 根据传播方差的结构，确定哪个输入不确定度对 $u_{K}$ 的贡献占主导地位，并解释原因。\n\n以 $\\mathrm{m}^{2}\\,\\mathrm{N}^{-1}$ 为单位表示 $K$ 的绝对标准不确定度的最终数值，并将您的答案四舍五入至三位有效数字。最终答案必须是单个数字。",
            "solution": "经评估，该问题陈述具有科学依据、良定、客观且完整。它代表了不确定度分析在半导体工艺工程中一个已建立的经验模型上的标准应用。因此，该问题是有效的，并将提供解答。\n\n该问题要求基于去除率 $R$、压力 $P$ 和相对速度 $V$ 的测量值，推导并计算Preston系数 $K$ 的不确定度。\n\n### 第1部分：不确定度表达式的推导\n\nPreston关系式由下式给出：\n$$ R = KPV $$\nPreston系数 $K$ 可以表示为测量量 $R$、$P$ 和 $V$ 的函数：\n$$ K(R, P, V) = \\frac{R}{PV} = R P^{-1} V^{-1} $$\n对于一个包含多个独立变量 $x_i$ 的函数 $K$，其合成标准不确定度 $u_K$ 由不确定度传播定律给出。对于小且独立的不确定度，标准不确定度的平方（方差）为：\n$$ u_K^2 = \\sum_{i} \\left( \\frac{\\partial K}{\\partial x_i} \\right)^2 u_{x_i}^2 $$\n在本例中，变量是 $R$、$P$ 和 $V$，因此表达式为：\n$$ u_K^2 = \\left( \\frac{\\partial K}{\\partial R} \\right)^2 u_R^2 + \\left( \\frac{\\partial K}{\\partial P} \\right)^2 u_P^2 + \\left( \\frac{\\partial K}{\\partial V} \\right)^2 u_V^2 $$\n我们计算 $K$ 对每个变量的偏导数：\n$$ \\frac{\\partial K}{\\partial R} = \\frac{1}{PV} $$\n$$ \\frac{\\partial K}{\\partial P} = R(-1)P^{-2}V^{-1} = -\\frac{R}{P^2 V} $$\n$$ \\frac{\\partial K}{\\partial V} = R P^{-1}(-1)V^{-2} = -\\frac{R}{PV^2} $$\n将这些导数代入方差公式：\n$$ u_K^2 = \\left( \\frac{1}{PV} \\right)^2 u_R^2 + \\left( -\\frac{R}{P^2 V} \\right)^2 u_P^2 + \\left( -\\frac{R}{PV^2} \\right)^2 u_V^2 $$\n$$ u_K^2 = \\frac{u_R^2}{P^2 V^2} + \\frac{R^2 u_P^2}{P^4 V^2} + \\frac{R^2 u_V^2}{P^2 V^4} $$\n这个表达式可以通过两边同除以 $K^2 = (R/PV)^2 = R^2/(P^2 V^2)$ 来简化，从而使用相对不确定度进行处理：\n$$ \\frac{u_K^2}{K^2} = \\frac{u_R^2/(P^2 V^2)}{R^2/(P^2 V^2)} + \\frac{R^2 u_P^2/(P^4 V^2)}{R^2/(P^2 V^2)} + \\frac{R^2 u_V^2/(P^2 V^4)}{R^2/(P^2 V^2)} $$\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2 $$\n绝对标准不确定度 $u_K$ 的解析表达式可以通过将相对不确定度乘以 $K$ 得到：\n$$ u_K = |K| \\sqrt{\\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2} $$\n由于 $K$、$P$、$V$ 和 $R$ 都是非负的物理量，所以绝对值并非严格必要。\n\n### 第2部分：$K$ 和 $u_K$ 的数值计算\n\n首先，所有给定物理量都必须转换为一致的国际单位制 (SI) 单位。$K$ 的目标单位是 $\\mathrm{m}^{2}\\,\\mathrm{N}^{-1}$。\n压力的SI单位是帕斯卡 (Pascal, $\\mathrm{Pa}$)，其中 $1\\ \\mathrm{Pa} = 1\\ \\mathrm{N/m^2}$。\n速度的SI单位是 $\\mathrm{m/s}$。\n去除率的SI单位是 $\\mathrm{m/s}$。\n\n给定值及其转换：\n- 压力：$P = 30.0\\ \\mathrm{kPa} = 3.00 \\times 10^4\\ \\mathrm{Pa} = 3.00 \\times 10^4\\ \\mathrm{N/m^2}$。\n- 压力不确定度：$u_{P} = 0.50\\ \\mathrm{kPa} = 5.0 \\times 10^2\\ \\mathrm{Pa} = 5.0 \\times 10^2\\ \\mathrm{N/m^2}$。\n- 相对速度：$V = 0.600\\ \\mathrm{m/s}$ (已是SI单位)。\n- 速度不确定度：$u_{V} = 0.030\\ \\mathrm{m/s}$ (已是SI单位)。\n- 去除率：$R = 180\\ \\mathrm{nm/min} = 180 \\times \\frac{10^{-9}\\ \\mathrm{m}}{60\\ \\mathrm{s}} = 3.00 \\times 10^{-9}\\ \\mathrm{m/s}$。\n- 去除率不确定度：$u_{R} = 10\\ \\mathrm{nm/min} = 10 \\times \\frac{10^{-9}\\ \\mathrm{m}}{60\\ \\mathrm{s}} = \\frac{1}{6} \\times 10^{-9}\\ \\mathrm{m/s} \\approx 1.667 \\times 10^{-10}\\ \\mathrm{m/s}$。\n\n接下来，我们计算 $K$ 的最佳估计值：\n$$ K = \\frac{R}{PV} = \\frac{3.00 \\times 10^{-9}\\ \\mathrm{m/s}}{(3.00 \\times 10^4\\ \\mathrm{N/m^2}) \\times (0.600\\ \\mathrm{m/s})} = \\frac{3.00 \\times 10^{-9}}{1.80 \\times 10^4}\\ \\mathrm{m^2/N} $$\n$$ K = \\frac{5}{3} \\times 10^{-13}\\ \\mathrm{m^2/N} \\approx 1.667 \\times 10^{-13}\\ \\mathrm{m^2/N} $$\n\n现在，我们计算每个输入量的无量纲相对不确定度：\n$$ \\frac{u_R}{R} = \\frac{10\\ \\mathrm{nm/min}}{180\\ \\mathrm{nm/min}} = \\frac{1}{18} $$\n$$ \\frac{u_P}{P} = \\frac{0.50\\ \\mathrm{kPa}}{30.0\\ \\mathrm{kPa}} = \\frac{1}{60} $$\n$$ \\frac{u_V}{V} = \\frac{0.030\\ \\mathrm{m/s}}{0.600\\ \\mathrm{m/s}} = \\frac{1}{20} $$\n我们将这些值代入推导出的 $u_K$ 表达式中：\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left(\\frac{1}{18}\\right)^2 + \\left(\\frac{1}{60}\\right)^2 + \\left(\\frac{1}{20}\\right)^2 $$\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\frac{1}{324} + \\frac{1}{3600} + \\frac{1}{400} $$\n转换为十进制形式以便计算：\n$$ \\left( \\frac{u_K}{K} \\right)^2 \\approx 0.00308642 + 0.00027778 + 0.00250000 = 0.0058642 $$\n$K$ 的相对不确定度是：\n$$ \\frac{u_K}{K} = \\sqrt{0.0058642} \\approx 0.076578 $$\n最后，绝对标准不确定度 $u_K$ 是：\n$$ u_K = K \\times \\frac{u_K}{K} \\approx (1.666... \\times 10^{-13}\\ \\mathrm{m^2/N}) \\times 0.076578 $$\n$$ u_K \\approx 1.2763 \\times 10^{-14}\\ \\mathrm{m^2/N} $$\n按要求四舍五入到三位有效数字：\n$$ u_K \\approx 1.28 \\times 10^{-14}\\ \\mathrm{m^2/N} $$\n\n### 第3部分：主要不确定度来源\n\n总传播方差是每个输入变量方差的各自贡献之和，并按其灵敏度系数进行缩放。在相对形式下，总相对不确定度的平方是各输入量相对不确定度的平方和：\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2 $$\n为了确定主要来源，我们比较这个和中每一项的数值：\n- 来自 $R$ 的贡献：$\\left(\\frac{u_R}{R}\\right)^2 = \\left(\\frac{1}{18}\\right)^2 \\approx 0.003086$\n- 来自 $V$ 的贡献：$\\left(\\frac{u_V}{V}\\right)^2 = \\left(\\frac{1}{20}\\right)^2 = 0.002500$\n- 来自 $P$ 的贡献：$\\left(\\frac{u_P}{P}\\right)^2 = \\left(\\frac{1}{60}\\right)^2 \\approx 0.000278$\n\n比较这些值，$0.003086  0.002500  0.000278$。对 $K$ 的方差贡献最大的是来自去除率 $R$ 的不确定度。这是因为 $R$ 的相对不确定度（$\\frac{u_R}{R} = \\frac{1}{18} \\approx 5.6\\%$）是三个输入相对不确定度中最大的（$\\frac{u_V}{V} = 5.0\\%$，$\\frac{u_P}{P} \\approx 1.7\\%$）。由于Preston方程的简单乘法结构，具有最大相对不确定度的输入在结果的相对不确定度中占主导地位。\n\n最终要求的数值答案是 $u_K$ 的值。",
            "answer": "$$\\boxed{1.28 \\times 10^{-14}}$$"
        },
        {
            "introduction": "最后的这项练习将普雷斯顿方程的概念提升到专业建模的水平，从一个单一的系数 $K$ 扩展到遍布整个晶圆的空变场 $k(\\mathbf{x})$。您将构建并求解一个正则化加权最小二乘问题，从多组实验数据中估算该系数场，这是开发预测性 CMP 模型的常见任务。本练习介绍了处理复杂的空间分布数据和解决不适定反问题的强大技术，这些正是现代工艺建模的核心。",
            "id": "4156565",
            "problem": "在化学机械平坦化 (CMP) 中，经过经验充分检验的 Preston 关系指出，局部材料去除率与局部接触压力和局部相对速度的乘积成正比。考虑一个被离散化为 $N$ 个网格单元的晶圆表面。对于 $J$ 次不同的工艺运行中的每一次，接触压力场和相对速度场都是已知的，并在同一网格上采样，从而得到已知的向量 $\\mathbf{p}_{j} \\in \\mathbb{R}^{N}$ 和 $\\mathbf{v}_{j} \\in \\mathbb{R}^{N}$，其中 $j \\in \\{1,\\dots,J\\}$。第 $j$ 次运行测得的去除率为 $\\mathbf{r}_{j} \\in \\mathbb{R}^{N}$，且受到加性噪声的干扰。设空间变化的 Preston 系数为 $\\mathbf{k} \\in \\mathbb{R}^{N}$，该系数在各次运行中假定为常数，但在不同网格单元上可能不同。假设第 $j$ 次运行中的加性噪声是零均值高斯噪声，其协方差为 $\\boldsymbol{\\Sigma}_{j} \\in \\mathbb{R}^{N \\times N}$，该协方差矩阵已知且为正定。为了促进 $\\mathbf{k}$ 的空间平滑性，使用 Tikhonov 正则化，其中线性算子 $\\mathbf{L} \\in \\mathbb{R}^{M \\times N}$（例如，离散梯度或拉普拉斯算子）和正则化强度 $\\lambda  0$ 均为已知。\n\n从 Preston 比例关系和高斯最大似然原理出发，构建带有 Tikhonov 正则化的加权最小二乘 (WLS) 目标函数以估计 $\\mathbf{k}$，推导其相关的正规方程，并提供估计量 $\\widehat{\\mathbf{k}}$ 关于 $\\{\\mathbf{p}_{j}\\}_{j=1}^{J}$、$\\{\\mathbf{v}_{j}\\}_{j=1}^{J}$、$\\{\\mathbf{r}_{j}\\}_{j=1}^{J}$、$\\{\\boldsymbol{\\Sigma}_{j}\\}_{j=1}^{J}$、$\\mathbf{L}$ 和 $\\lambda$ 的闭式解析表达式。你可以根据需要使用哈达玛积表示法和对角化算子，但除了已声明的结构外，不要假设任何特殊结构。\n\n将你的最终答案表示为单个闭式解析表达式。最终表达式中不要包含单位。不需要进行数值四舍五入。",
            "solution": "用户希望验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   该问题考虑一个被离散化为 $N$ 个网格单元的物理系统。\n-   共有 $J$ 次不同的工艺运行，索引为 $j \\in \\{1, \\dots, J\\}$。\n-   对于每次运行 $j$，接触压力向量为 $\\mathbf{p}_{j} \\in \\mathbb{R}^{N}$。\n-   对于每次运行 $j$，相对速度向量为 $\\mathbf{v}_{j} \\in \\mathbb{R}^{N}$。\n-   对于每次运行 $j$，测量的去除率向量为 $\\mathbf{r}_{j} \\in \\mathbb{R}^{N}$。\n-   空间变化的 Preston 系数向量为 $\\mathbf{k} \\in \\mathbb{R}^{N}$，它在所有 $J$ 次运行中保持不变。\n-   去除率的模型基于 Preston 关系：局部去除率与局部接触压力和局部相对速度的乘积成正比。\n-   运行 $j$ 的测量噪声是加性的、零均值的、高斯的，其协方差矩阵 $\\boldsymbol{\\Sigma}_{j} \\in \\mathbb{R}^{N \\times N}$ 已知且正定。\n-   将使用 Tikhonov 正则化，其中线性算子 $\\mathbf{L} \\in \\mathbb{R}^{M \\times N}$ 和正则化强度 $\\lambda  0$ 均为已知。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固地植根于半导体制造过程建模领域，特别是化学机械平坦化 (CMP)。Preston 方程是该领域的一个基础经验模型。将像 Preston 系数这样的物理参数建模为空间变化的，是一种常见且必要的改进。加性高斯噪声的假设以及使用 Tikhonov 正则化进行参数估计，是统计信号处理和逆问题理论中标准且成熟的技术。该问题在科学上是合理的。\n2.  **适定的：** 该问题是适定的。它要求在指定的统计模型下，根据测量数据推导未知参数向量的估计量。包含 $\\lambda  0$ 的 Tikhonov 正则化，其明确目的是确保即使在非正则化问题是病态的情况下，得到的方程组也是可解的，并且解是唯一且稳定的。\n3.  **客观性：** 问题陈述使用了精确的数学语言和符号。所有术语都得到了清晰的定义，没有主观或模糊的陈述。\n4.  **完整性和一致性：** 构建和解决问题所需的所有信息（$\\mathbf{p}_{j}$、$\\mathbf{v}_{j}$、$\\mathbf{r}_{j}$、$\\boldsymbol{\\Sigma}_{j}$、$\\mathbf{L}$、$\\lambda$）都已提供。设置中没有矛盾之处。\n5.  **可行性：** 所描述的情景是工程学中一个标准的建模问题。诸如已知协方差矩阵之类的假设是常见的理想化处理，以便于解析求解。该设置在物理上和数学上都是一致的。\n\n### 步骤 3：结论与行动\n该问题有效。它具有科学依据、是适定的、客观的，并包含进行严格数学推导所需的所有信息。我将继续进行求解。\n\n---\n\n推导首先将 Preston 关系形式化为矩阵-向量表示法。对于运行 $j$，网格单元 $i$ 的局部去除率与局部压力 $p_{ji}$ 和局部速度 $v_{ji}$ 的乘积成正比。设 $k_i$ 为单元 $i$ 的 Preston 系数。单元 $i$ 的真实、无噪声的去除率为 $k_i p_{ji} v_{ji}$。将所有 $N$ 个单元的这些值堆叠成向量，运行 $j$ 的真实去除率向量，记为 $\\mathbf{r}_{\\text{true},j} \\in \\mathbb{R}^{N}$，由 Preston 系数向量 $\\mathbf{k}$ 与压力和速度向量乘积的逐元素乘积给出。使用哈达玛积符号 $\\circ$，这表示为：\n$$\n\\mathbf{r}_{\\text{true},j} = \\mathbf{k} \\circ (\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})\n$$\n这种关系可以表示为 $\\mathbf{k}$ 的一个线性变换。设 $\\mathbf{D}_{j}$ 是由向量 $\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}$ 构成的 $N \\times N$ 对角矩阵。即 $\\mathbf{D}_{j} = \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})$。那么，真实去除率的模型为：\n$$\n\\mathbf{r}_{\\text{true},j} = \\mathbf{D}_{j}\\mathbf{k}\n$$\n测量的去除率 $\\mathbf{r}_{j}$ 受到加性零均值高斯噪声 $\\boldsymbol{\\epsilon}_{j}$ 的干扰，其协方差为 $\\boldsymbol{\\Sigma}_{j}$。运行 $j$ 的完整模型是：\n$$\n\\mathbf{r}_{j} = \\mathbf{D}_{j}\\mathbf{k} + \\boldsymbol{\\epsilon}_{j}, \\quad \\text{其中} \\quad \\boldsymbol{\\epsilon}_{j} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma}_{j})\n$$\n给定 $\\mathbf{k}$ 时，测量值 $\\mathbf{r}_{j}$ 的概率密度函数 (PDF) 为：\n$$\nP(\\mathbf{r}_{j}|\\mathbf{k}) = \\frac{1}{(2\\pi)^{N/2} \\det(\\boldsymbol{\\Sigma}_{j})^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})\\right)\n$$\n假设 $J$ 次工艺运行在统计上是独立的，所有测量值 $\\{\\mathbf{r}_{j}\\}_{j=1}^{J}$ 的总似然函数是各个似然函数的乘积：\n$$\n\\mathcal{L}(\\mathbf{k}) = \\prod_{j=1}^{J} P(\\mathbf{r}_{j}|\\mathbf{k})\n$$\n$\\mathbf{k}$ 的最大似然估计 (MLE) 是通过最大化 $\\mathcal{L}(\\mathbf{k})$ 找到的，这等同于最小化负对数似然函数 $-\\ln(\\mathcal{L}(\\mathbf{k}))$：\n$$\n-\\ln(\\mathcal{L}(\\mathbf{k})) = -\\sum_{j=1}^{J} \\ln(P(\\mathbf{r}_{j}|\\mathbf{k})) = \\sum_{j=1}^{J} \\left( \\frac{N}{2}\\ln(2\\pi) + \\frac{1}{2}\\ln(\\det(\\boldsymbol{\\Sigma}_{j})) + \\frac{1}{2}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k}) \\right)\n$$\n为了找到最优的 $\\mathbf{k}$，我们可以舍去常数项，剩下加权最小二乘 (WLS) 目标函数：\n$$\nJ_{\\text{WLS}}(\\mathbf{k}) = \\sum_{j=1}^{J} (\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})\n$$\n问题要求添加一个 Tikhonov 正则化项以促进平滑性。正则化项由 $\\lambda \\|\\mathbf{L}\\mathbf{k}\\|_{2}^{2} = \\lambda (\\mathbf{L}\\mathbf{k})^{T}(\\mathbf{L}\\mathbf{k}) = \\lambda \\mathbf{k}^{T}\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}$ 给出。需要最小化的完整正则化 WLS 目标函数是：\n$$\nJ(\\mathbf{k}) = \\sum_{j=1}^{J} (\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k}) + \\lambda \\mathbf{k}^{T}\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}\n$$\n为了找到最小化 $J(\\mathbf{k})$ 的估计量 $\\widehat{\\mathbf{k}}$，我们计算 $J(\\mathbf{k})$ 关于 $\\mathbf{k}$ 的梯度并将其设为零。使用矩阵微积分恒等式 $\\nabla_{\\mathbf{x}} (\\mathbf{b}-\\mathbf{A}\\mathbf{x})^{T}\\mathbf{C}(\\mathbf{b}-\\mathbf{A}\\mathbf{x}) = 2\\mathbf{A}^{T}\\mathbf{C}(\\mathbf{A}\\mathbf{x}-\\mathbf{b})$ 和 $\\nabla_{\\mathbf{x}} \\mathbf{x}^{T}\\mathbf{B}\\mathbf{x} = 2\\mathbf{B}\\mathbf{x}$（对于对称矩阵 $\\mathbf{B}$），梯度为：\n$$\n\\nabla_{\\mathbf{k}}J(\\mathbf{k}) = \\sum_{j=1}^{J} 2\\mathbf{D}_{j}^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{D}_{j}\\mathbf{k} - \\mathbf{r}_{j}) + 2\\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}\n$$\n注意 $\\mathbf{D}_{j}$ 是一个对角矩阵，所以 $\\mathbf{D}_{j}^{T} = \\mathbf{D}_{j}$。同样，$\\boldsymbol{\\Sigma}_j$ 是正定的，所以 $\\boldsymbol{\\Sigma}_j^{-1}$ 是对称的。矩阵 $\\mathbf{L}^{T}\\mathbf{L}$ 也是对称的。\n将梯度设为 $\\mathbf{0}$ 并除以 $2$：\n$$\n\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{D}_{j}\\mathbf{k} - \\mathbf{r}_{j}) + \\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k} = \\mathbf{0}\n$$\n展开并重新整理各项以合并 $\\mathbf{k}$：\n$$\n\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j}\\mathbf{k} - \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j} + \\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k} = \\mathbf{0}\n$$\n将 $\\mathbf{k}$ 提取出来，得到正规方程：\n$$\n\\left( \\left(\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j}\\right) + \\lambda\\mathbf{L}^{T}\\mathbf{L} \\right) \\mathbf{k} = \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j}\n$$\n由于 Tikhonov 正则化项的存在（因为 $\\lambda0$，且半正定矩阵之和至少是半正定的，正则化项通常使其成为正定矩阵，从而保证了可逆性），乘以 $\\mathbf{k}$ 的矩阵是可逆的。求解 $\\mathbf{k}$ 得到估计量 $\\widehat{\\mathbf{k}}$：\n$$\n\\widehat{\\mathbf{k}} = \\left( \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j} + \\lambda\\mathbf{L}^{T}\\mathbf{L} \\right)^{-1} \\left( \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j} \\right)\n$$\n代入 $\\mathbf{D}_{j} = \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})$ 的定义，我们得到最终的闭式表达式。",
            "answer": "$$\n\\boxed{\\left( \\sum_{j=1}^{J} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) \\boldsymbol{\\Sigma}_{j}^{-1} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) + \\lambda \\mathbf{L}^{T}\\mathbf{L} \\right)^{-1} \\left( \\sum_{j=1}^{J} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) \\boldsymbol{\\Sigma}_{j}^{-1} \\mathbf{r}_{j} \\right)}\n$$"
        }
    ]
}