{
    "hands_on_practices": [
        {
            "introduction": "To begin our exploration of time integration, we first examine the most straightforward approach: an explicit method. This exercise focuses on the Forward-Time Central-Space (FTCS) scheme applied to a one-dimensional heat conduction problem. By performing a von Neumann stability analysis, you will directly derive the strict limitation on the time step size, a hallmark of many explicit methods, and understand how it depends on the physical properties of the material and the chosen spatial grid resolution. ",
            "id": "2483538",
            "problem": "A homogeneous, isotropic one-dimensional solid of constant thermal diffusivity is governed by the transient heat equation derived from conservation of energy and Fourier’s law, which yields $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$, where $T$ is temperature, $t$ is time, $x$ is the spatial coordinate along the rod, and $\\alpha$ is the thermal diffusivity. Consider a uniform grid with spacing $\\Delta x$ and apply the Forward-Time Central-Space (FTCS) explicit time integration scheme, which advances $T$ in time using a forward Euler step and approximates the second spatial derivative by a second-order central difference. Using a von Neumann (Fourier) stability analysis, determine the maximum time step $\\Delta t_{\\max}$ such that the scheme is marginally stable for all spatial Fourier modes.\n\nUse the data $\\alpha=1.4\\times 10^{-5}\\,\\mathrm{m^{2}/s}$ and $\\Delta x=0.5\\,\\mathrm{mm}$, and compute the corresponding $\\Delta t_{\\max}$ for this one-dimensional FTCS discretization. Round your answer to four significant figures and express the time in seconds.",
            "solution": "The governing equation for one-dimensional transient heat conduction is given as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nHere, $T(x, t)$ is the temperature, $x$ is the spatial coordinate, $t$ is time, and $\\alpha$ is the thermal diffusivity. We are to analyze the stability of the Forward-Time Central-Space (FTCS) discretization scheme for this equation.\n\nLet us define a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The temperature at a grid node $i$ and time level $n$ is denoted by $T_i^n \\equiv T(i\\Delta x, n\\Delta t)$.\n\nThe FTCS scheme approximates the partial derivatives as follows:\nThe time derivative is approximated using a first-order forward difference:\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\nThe spatial second derivative is approximated using a second-order central difference:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the governing equation gives the discretized form of the FTCS scheme:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right)\n$$\nWe can rearrange this equation to solve explicitly for the temperature at the next time step, $T_i^{n+1}$:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\nLet us define the dimensionless Fourier number, $Fo$, also known as the diffusion number, as:\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\nThe discretized equation simplifies to:\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = Fo \\, T_{i+1}^n + (1 - 2Fo)T_i^n + Fo \\, T_{i-1}^n\n$$\nTo determine the stability of this numerical scheme, we perform a von Neumann stability analysis. We consider the behavior of a single Fourier mode of the solution. Let the temperature distribution at time level $n$ be represented by a Fourier component:\n$$\nT_i^n = \\hat{T}^n(k) e^{I k x_i}\n$$\nwhere $k$ is the wavenumber, $x_i = i\\Delta x$ is the spatial position of node $i$, and $I = \\sqrt{-1}$ is the imaginary unit. The amplitude of this mode at time $n$ is $\\hat{T}^n(k)$. After one time step, this mode will be amplified by a factor $G(k)$, the amplification factor:\n$$\nT_i^{n+1} = \\hat{T}^{n+1}(k) e^{I k x_i} = G(k) \\hat{T}^n(k) e^{I k x_i}\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber $k$. The stability condition is:\n$$\n|G(k)| \\le 1\n$$\nWe substitute the Fourier mode representation into the discretized equation:\n$$\nG(k) \\hat{T}^n(k) e^{I k (i\\Delta x)} = Fo \\, \\hat{T}^n(k) e^{I k ((i+1)\\Delta x)} + (1 - 2Fo) \\hat{T}^n(k) e^{I k (i\\Delta x)} + Fo \\, \\hat{T}^n(k) e^{I k ((i-1)\\Delta x)}\n$$\nDividing by $\\hat{T}^n(k) e^{I k (i\\Delta x)}$ yields the expression for the amplification factor $G(k)$:\n$$\nG(k) = Fo \\, e^{I k \\Delta x} + (1 - 2Fo) + Fo \\, e^{-I k \\Delta x}\n$$\nUsing Euler's identity $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$, we can simplify this expression:\n$$\nG(k) = 1 - 2Fo + Fo (e^{I k \\Delta x} + e^{-I k \\Delta x}) = 1 - 2Fo + 2Fo \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2Fo(1 - \\cos(k \\Delta x))\n$$\nUsing the trigonometric half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain:\n$$\nG(k) = 1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nNow we apply the stability condition $|G(k)| \\le 1$. Since $Fo > 0$, the term $4Fo \\sin^2(k\\Delta x/2)$ is non-negative. Therefore, $G(k)$ is always less than or equal to $1$. The stability is thus governed by the lower bound:\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThis inequality must hold for all possible wavenumbers $k$. The most restrictive condition occurs when the term $\\sin^2(k\\Delta x/2)$ reaches its maximum value. The maximum value of $\\sin^2(\\theta)$ is $1$. This corresponds to the highest frequency (most rapidly oscillating) mode representable on the grid, where $k \\Delta x = \\pi$.\nThus, the condition for stability becomes:\n$$\nFo \\le \\frac{1}{2}\n$$\nMarginal stability is achieved at the limit of this condition, where $Fo = 1/2$. The maximum allowable time step, $\\Delta t_{\\max}$, corresponds to this limit:\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\nSolving for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\nWe are given the following data:\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\nSubstituting these values into the expression for $\\Delta t_{\\max}$:\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.008929}\n$$"
        },
        {
            "introduction": "Having seen the stability constraints of explicit methods, we now turn to their counterpart: implicit schemes. This practice guides you through the formulation of the fully implicit backward Euler method for the same heat conduction problem. You will discover that this approach results in a system of coupled linear equations that must be solved at each time step, and you will construct the classic tridiagonal matrix structure that arises from this discretization. ",
            "id": "2483544",
            "problem": "A homogeneous, isotropic one-dimensional solid slab of length $L$ with constant thermal conductivity $k$, density $\\rho$, and specific heat capacity $c_p$ undergoes transient heat conduction without internal heat generation. Let $T(x,t)$ denote the temperature, and define the thermal diffusivity $\\alpha = \\dfrac{k}{\\rho c_p}$. The governing balance of energy and Fourier’s law lead to the one-dimensional transient heat equation\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.\n$$\nDiscretize the spatial domain $[0,L]$ with a uniform grid $x_i = i\\,\\Delta x$ for $i=0,1,\\dots,N-1$, where $\\Delta x = L/(N-1)$, and discretize time as $t^n = n\\,\\Delta t$ for $n=0,1,2,\\dots$. Impose Dirichlet boundary conditions $T(0,t) = T_L(t)$ and $T(L,t) = T_R(t)$, assumed known for all $t$. For interior nodes $i=1,2,\\dots,N-2$, use a fully implicit backward-in-time, centered-in-space finite difference approximation of the governing equation evaluated at time level $t^{n+1}$.\n\nTasks:\n- Starting from the statement of conservation of energy and Fourier’s law, derive the discrete finite difference equation at an interior node that results from the described time and space discretizations. Introduce the nondimensional parameter $r = \\dfrac{\\alpha\\,\\Delta t}{\\Delta x^2}$ and reduce the discrete equation to a three-point stencil form involving $T_{i-1}^{n+1}$, $T_{i}^{n+1}$, and $T_{i+1}^{n+1}$ on the left-hand side and $T_i^{n}$ on the right-hand side.\n- Assemble the resulting equations for $i=1,2,\\dots,N-2$ into a tridiagonal linear system $\\mathbf{A}\\,\\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$ for the interior unknowns $\\mathbf{T}^{n+1}_{\\text{int}} = \\big(T_1^{n+1},\\dots,T_{N-2}^{n+1}\\big)^{\\top}$, explicitly identifying the sub-diagonal, diagonal, and super-diagonal entries of $\\mathbf{A}$ and the structure of $\\mathbf{b}$, including how the Dirichlet boundary values at time $t^{n+1}$ enter the first and last equations.\n- Report, as your final answer, the triplet consisting of the sub-diagonal, diagonal, and super-diagonal coefficients for interior nodes in the tridiagonal matrix $\\mathbf{A}$, expressed in terms of $r$, in that order. Provide this triplet as a single row matrix. No numerical evaluation is required, and no rounding is needed. Do not include physical units in the final answer.",
            "solution": "The governing equation for one-dimensional transient heat conduction without internal generation is given as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $T(x,t)$ is the temperature, $t$ is time, $x$ is the spatial coordinate, and $\\alpha$ is the thermal diffusivity.\n\nWe are instructed to use a fully implicit finite difference scheme. This means the spatial derivatives are evaluated at the future time level, $t^{n+1}$, and the time derivative is approximated using a backward difference. Let $T_i^n$ denote the temperature at node $x_i$ and time $t^n$.\n\nThe time derivative $\\frac{\\partial T}{\\partial t}$ at $(x_i, t^{n+1})$ is approximated by a first-order backward difference:\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i}^{n+1} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n\nThe spatial derivative $\\frac{\\partial^2 T}{\\partial x^2}$ at $(x_i, t^{n+1})$ is approximated by a second-order central difference:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i}^{n+1} \\approx \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\nSubstituting these approximations into the governing partial differential equation, we obtain the finite difference equation for an interior node $i$:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\nThis equation is valid for $i = 1, 2, \\dots, N-2$.\n\nTo obtain the requested form, we first multiply both sides by $\\Delta t$:\n$$\nT_i^{n+1} - T_i^n = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\nWe now introduce the nondimensional parameter, the Fourier number for the grid, $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. The equation becomes:\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\nThe task requires arranging this equation such that all terms at the new time level $n+1$ are on the left-hand side (LHS) and terms at the current time level $n$ are on the right-hand side (RHS).\n$$\nT_i^{n+1} - r T_{i-1}^{n+1} + 2r T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\nCollecting the coefficients of the unknown temperatures at time level $n+1$, we arrive at the three-point stencil form:\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\nThis completes the first task.\n\nFor the second task, we assemble the system of linear equations for the unknown interior temperatures $\\mathbf{T}^{n+1}_{\\text{int}} = (T_1^{n+1}, T_2^{n+1}, \\dots, T_{N-2}^{n+1})^{\\top}$. There are $N-2$ such equations, one for each interior node from $i=1$ to $i=N-2$.\n\nFor the first interior node, $i=1$:\n$$\n-r T_{0}^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\nHere, $T_0^{n+1}$ is determined by the Dirichlet boundary condition at $x=0$, so $T_0^{n+1} = T_L(t^{n+1})$. Since this is a known value, we move it to the RHS:\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L(t^{n+1})\n$$\n\nFor a general interior node $i$, where $1 < i < N-2$:\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n\nFor the last interior node, $i=N-2$:\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} - r T_{N-1}^{n+1} = T_{N-2}^n\n$$\nHere, $T_{N-1}^{n+1}$ is determined by the Dirichlet boundary condition at $x=L$, so $T_{N-1}^{n+1} = T_R(t^{n+1})$. We move this known value to the RHS:\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} = T_{N-2}^n + r T_R(t^{n+1})\n$$\n\nAssembling these $N-2$ equations into the matrix form $\\mathbf{A} \\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$:\n- The matrix $\\mathbf{A}$ is an $(N-2) \\times (N-2)$ tridiagonal matrix.\n- The vector $\\mathbf{b}$ is an $(N-2) \\times 1$ column vector.\n\nThe matrix $\\mathbf{A}$ has the following structure:\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n1+2r & -r & 0 & \\cdots & 0 \\\\\n-r & 1+2r & -r & \\cdots & 0 \\\\\n0 & -r & 1+2r & \\ddots & \\vdots \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & -r \\\\\n0 & \\cdots & 0 & -r & 1+2r\n\\end{pmatrix}\n$$\nThe entries of $\\mathbf{A}$ for any interior row are derived from the generic stencil:\n- Sub-diagonal entry (coefficient of $T_{i-1}^{n+1}$): $-r$\n- Diagonal entry (coefficient of $T_i^{n+1}$): $1+2r$\n- Super-diagonal entry (coefficient of $T_{i+1}^{n+1}$): $-r$\n\nThe vector $\\mathbf{b}$ is constructed as:\n$$\n\\mathbf{b} =\n\\begin{pmatrix}\nT_1^n + r T_L(t^{n+1}) \\\\\nT_2^n \\\\\n\\vdots \\\\\nT_{N-3}^n \\\\\nT_{N-2}^n + r T_R(t^{n+1})\n\\end{pmatrix}\n$$\nThe boundary conditions at time $t^{n+1}$ contribute to the first and last elements of the RHS vector $\\mathbf{b}$.\n\nThe final task is to report the triplet of sub-diagonal, diagonal, and super-diagonal coefficients of $\\mathbf{A}$ for interior nodes. These are constant for all interior rows of the matrix. Based on our analysis, they are:\n- Sub-diagonal: $-r$\n- Diagonal: $1+2r$\n- Super-diagonal: $-r$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -r & 1+2r & -r \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world processes, such as dopant diffusion in semiconductors, are often governed by nonlinear equations where material properties depend on the solution itself. This exercise advances our study to a nonlinear diffusion problem discretized with an implicit backward Euler scheme, leading to a system of *nonlinear* algebraic equations. Your task is to derive the entries of the Jacobian matrix, a critical component for solving this system using Newton's method, and appreciate how the nonlinearity of the diffusivity $D(c)$ contributes to the structure of this essential matrix. ",
            "id": "4125348",
            "problem": "In thermal budget modeling of dopant diffusion during semiconductor manufacturing, a commonly used continuum description is the nonlinear diffusion equation\n$$\n\\frac{\\partial c}{\\partial t}=\\nabla\\cdot\\big(D(c)\\nabla c\\big),\n$$\nwhere $c$ is the nondimensionalized dopant concentration and $D(c)$ is the nondimensionalized diffusivity. Consider a one-dimensional domain discretized by the finite volume method on a uniform mesh of cell width $h$ (nondimensional), with cell-averaged unknowns $\\{c_i\\}$ located at cell centers. The time integration is backward Euler from time level $n$ to $n+1$ with time step $\\Delta t$ (nondimensional). The face-centered flux at face $i+\\frac{1}{2}$ is approximated by central differencing of the gradient and an arithmetic average of the diffusivity:\n$$\n\\left.\\frac{\\partial c}{\\partial x}\\right|_{i+\\frac{1}{2}} \\approx \\frac{c_{i+1}^{n+1}-c_i^{n+1}}{h},\\qquad D_{i+\\frac{1}{2}}^{n+1} \\approx \\frac{D(c_{i+1}^{n+1})+D(c_i^{n+1})}{2}.\n$$\nAssume $D(c)=1+\\beta c$ with $\\beta$ a known nondimensional parameter. For an interior control volume $i$, the discrete backward Euler finite volume residual is\n$$\nR_i(c^{n+1}) \\equiv h\\,\\frac{c_i^{n+1}-c_i^n}{\\Delta t}-\\frac{1}{h}\\left[D_{i+\\frac{1}{2}}^{n+1}\\left(c_{i+1}^{n+1}-c_i^{n+1}\\right)-D_{i-\\frac{1}{2}}^{n+1}\\left(c_i^{n+1}-c_{i-1}^{n+1}\\right)\\right].\n$$\nDefine the Jacobian matrix $J$ at time level $n+1$ by $J_{ij}=\\frac{\\partial R_i}{\\partial c_j^{n+1}}$. Starting from conservation of mass, the divergence theorem, and the stated discretizations, derive explicit analytic formulas for the tridiagonal Jacobian entries $J_{i,i-1}$, $J_{i,i}$, and $J_{i,i+1}$, clearly separating the contributions arising from differentiation of $D(c)$ and from differentiation of the discrete gradients. Then, as your final reported result, provide the closed-form expression for the diagonal entry $J_{i,i}$ in terms of $h$, $\\Delta t$, $\\beta$, and the unknowns $c_{i-1}^{n+1}$, $c_i^{n+1}$, $c_{i+1}^{n+1}$ only. Express the final answer as a single analytic expression. Do not include units. No numerical rounding is required.",
            "solution": "The task is to compute the partial derivatives $J_{ij}=\\frac{\\partial R_i}{\\partial c_j^{n+1}}$ for $j \\in \\{i-1, i, i+1\\}$. For notational simplicity in the derivation, we will denote $c_k^{n+1}$ as $c_k$. The term $c_i^n$ is a constant with respect to the differentiation variables.\n\nThe residual $R_i$ for an interior cell $i$ depends only on $c_{i-1}$, $c_i$, and $c_{i+1}$. Therefore, the Jacobian matrix $J$ is tridiagonal. The relevant terms in the residual are the numerical fluxes at the cell faces, $F_{i \\pm \\frac{1}{2}}$, where $F_{i+\\frac{1}{2}} = D_{i+\\frac{1}{2}}(c_{i+1}-c_i)$. The residual can be written as:\n$$\nR_i = h\\,\\frac{c_i-c_i^n}{\\Delta t} - \\frac{1}{h} \\left( F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\right)\n$$\nThe specific form of the diffusivity is $D(c) = 1 + \\beta c$. The face diffusivities are:\n$$\nD_{i+\\frac{1}{2}} = \\frac{D(c_{i+1})+D(c_i)}{2} = \\frac{(1+\\beta c_{i+1})+(1+\\beta c_i)}{2} = 1 + \\frac{\\beta}{2}(c_{i+1}+c_i)\n$$\n$$\nD_{i-\\frac{1}{2}} = \\frac{D(c_i)+D(c_{i-1})}{2} = \\frac{(1+\\beta c_i)+(1+\\beta c_{i-1})}{2} = 1 + \\frac{\\beta}{2}(c_i+c_{i-1})\n$$\n\nWe can now compute the Jacobian entries by applying the product rule for differentiation.\n\n**Off-diagonal entry $J_{i,i-1}$:**\n$J_{i,i-1} = \\frac{\\partial R_i}{\\partial c_{i-1}} = \\frac{\\partial}{\\partial c_{i-1}} \\left( \\frac{1}{h} F_{i-\\frac{1}{2}} \\right) = \\frac{1}{h} \\frac{\\partial}{\\partial c_{i-1}} \\left[ D_{i-\\frac{1}{2}} (c_i - c_{i-1}) \\right]$\nUsing the product rule:\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_{i-1}} (c_i - c_{i-1}) + D_{i-\\frac{1}{2}} \\frac{\\partial (c_i - c_{i-1})}{\\partial c_{i-1}} \\right]\n$$\nThe required derivatives are $\\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_{i-1}} = \\frac{\\beta}{2}$ and $\\frac{\\partial (c_i - c_{i-1})}{\\partial c_{i-1}} = -1$.\nSubstituting these yields:\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}(-1) \\right] = \\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_i-c_{i-1}) - \\left(1 + \\frac{\\beta}{2}(c_i+c_{i-1})\\right) \\right]\n$$\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\beta}{2}c_i - \\frac{\\beta}{2}c_{i-1} - 1 - \\frac{\\beta}{2}c_i - \\frac{\\beta}{2}c_{i-1} \\right] = \\frac{1}{h} \\left[ -1 - \\beta c_{i-1} \\right] = -\\frac{1}{h}(1+\\beta c_{i-1})\n$$\nNoting that $D(c_{i-1}) = 1+\\beta c_{i-1}$, we have $J_{i,i-1} = -\\frac{D(c_{i-1})}{h}$.\n\n**Off-diagonal entry $J_{i,i+1}$:**\n$J_{i,i+1} = \\frac{\\partial R_i}{\\partial c_{i+1}} = \\frac{\\partial}{\\partial c_{i+1}} \\left( -\\frac{1}{h} F_{i+\\frac{1}{2}} \\right) = -\\frac{1}{h} \\frac{\\partial}{\\partial c_{i+1}} \\left[ D_{i+\\frac{1}{2}} (c_{i+1} - c_i) \\right]$\nUsing the product rule:\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_{i+1}} (c_{i+1} - c_i) + D_{i+\\frac{1}{2}} \\frac{\\partial (c_{i+1} - c_i)}{\\partial c_{i+1}} \\right]\n$$\nThe required derivatives are $\\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_{i+1}} = \\frac{\\beta}{2}$ and $\\frac{\\partial (c_{i+1} - c_i)}{\\partial c_{i+1}} = 1$.\nSubstituting these yields:\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}(1) \\right] = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_{i+1}-c_i) + \\left(1 + \\frac{\\beta}{2}(c_{i+1}+c_i)\\right) \\right]\n$$\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}c_{i+1} - \\frac{\\beta}{2}c_i + 1 + \\frac{\\beta}{2}c_{i+1} + \\frac{\\beta}{2}c_i \\right] = -\\frac{1}{h} \\left[ 1 + \\beta c_{i+1} \\right] = -\\frac{1}{h}(1+\\beta c_{i+1})\n$$\nNoting that $D(c_{i+1}) = 1+\\beta c_{i+1}$, we have $J_{i,i+1} = -\\frac{D(c_{i+1})}{h}$.\n\n**Diagonal entry $J_{i,i}$:**\nThis term has contributions from the time derivative and from both adjacent fluxes.\n$$\nJ_{i,i} = \\frac{\\partial R_i}{\\partial c_i} = \\frac{\\partial}{\\partial c_i} \\left( h\\,\\frac{c_i-c_i^n}{\\Delta t} \\right) - \\frac{1}{h}\\frac{\\partial F_{i+\\frac{1}{2}}}{\\partial c_i} + \\frac{1}{h}\\frac{\\partial F_{i-\\frac{1}{2}}}{\\partial c_i}\n$$\nThe first term is simply $\\frac{h}{\\Delta t}$. For the flux terms, we again use the product rule.\n$$\n\\frac{\\partial F_{i+\\frac{1}{2}}}{\\partial c_i} = \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_i}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}\\frac{\\partial(c_{i+1}-c_i)}{\\partial c_i} = \\frac{\\beta}{2}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}(-1) = -1 - \\beta c_i\n$$\n$$\n\\frac{\\partial F_{i-\\frac{1}{2}}}{\\partial c_i} = \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_i}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}\\frac{\\partial(c_i-c_{i-1})}{\\partial c_i} = \\frac{\\beta}{2}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}(1) = 1 + \\beta c_i\n$$\nCombining these results:\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} - \\frac{1}{h}(-1-\\beta c_i) + \\frac{1}{h}(1+\\beta c_i) = \\frac{h}{\\Delta t} + \\frac{1}{h}(1+\\beta c_i) + \\frac{1}{h}(1+\\beta c_i)\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i)\n$$\nThe contribution from differentiating the gradient terms (including the time derivative) is:\n$$\nJ_{i,i}^{(\\nabla c)} = \\frac{h}{\\Delta t} - \\frac{1}{h}\\left( D_{i+\\frac{1}{2}}(-1) \\right) + \\frac{1}{h}\\left( D_{i-\\frac{1}{2}}(1) \\right) = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}\\right)\n$$\nThe contribution from differentiating the diffusivity $D(c)$ is:\n$$\nJ_{i,i}^{(D)} = -\\frac{1}{h}\\left( \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_i}(c_{i+1}-c_i) \\right) + \\frac{1}{h}\\left( \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_i}(c_i-c_{i-1}) \\right)\n$$\n$$\nJ_{i,i}^{(D)} = -\\frac{1}{h}\\left( \\frac{\\beta}{2}(c_{i+1}-c_i) \\right) + \\frac{1}{h}\\left( \\frac{\\beta}{2}(c_i-c_{i-1}) \\right) = \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\nSumming the contributions:\n$$\nJ_{i,i} = J_{i,i}^{(\\nabla c)} + J_{i,i}^{(D)} = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}\\right) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\nSubstituting the expressions for $D_{i \\pm \\frac{1}{2}}$:\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(1 + \\frac{\\beta}{2}(c_{i+1}+c_i) + 1 + \\frac{\\beta}{2}(c_i+c_{i-1})\\right) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(c_{i+1}+2c_i+c_{i-1}) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(c_{i+1}+2c_i+c_{i-1}-c_{i+1}+2c_i-c_{i-1}) = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(4c_i)\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i)\n$$\nRestoring the superscript for time level $n+1$, the final expression is:\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i^{n+1})\n$$\nThis expression depends only on $h$, $\\Delta t$, $\\beta$, and the unknown $c_i^{n+1}$, as required.",
            "answer": "$$\n\\boxed{\\frac{h}{\\Delta t} + \\frac{2}{h}\\left(1+\\beta c_i^{n+1}\\right)}\n$$"
        }
    ]
}