{
    "hands_on_practices": [
        {
            "introduction": "Semiconductor process simulation relies on accurately discretizing complex, curved geometries. This exercise introduces the powerful technique of isoparametric mapping, which transforms simple reference elements into curved physical elements, like the quarter-circular corner of an oxide layer discussed here. By analytically deriving the Jacobian determinant for this mapping , you will gain a fundamental understanding of how to verify that a mesh element is valid—i.e., non-inverted—a critical condition for stable and accurate numerical solutions.",
            "id": "4129464",
            "problem": "A curvilinear quadrilateral mesh element is to be placed at the corner of a thermally grown silicon dioxide (oxide) layer around a silicon gate, where the oxide makes a quarter-circular bend. To preserve conservative fluxes in semiconductor manufacturing process modeling (e.g., dopant diffusion and oxidation kinetics) during numerical integration, the mapping Jacobian must remain strictly positive at all Gaussian integration points inside the element.\n\nConsider the physical domain as a quarter-annulus sector bounded by four curves: the inner circular arc of radius $R$ (representing the oxide-silicon interface), the outer circular arc of radius $R+\\Delta R$ (representing the outer oxide boundary), and two radial lines at angles $0$ and $\\pi/2$ radians. Construct a $p$-curved isoparametric quadrilateral element that maps the square parameter domain $[-1,1]\\times[-1,1]$ in $(\\xi,\\eta)$ to this physical sector, using a formulation consistent with the following boundary associations and smoothness principles:\n- The edges $\\eta=-1$ and $\\eta=1$ map to the inner and outer circular arcs, respectively.\n- The edges $\\xi=1$ and $\\xi=-1$ map to the radial lines at angles $0$ and $\\pi/2$, respectively.\n- The radius varies monotonically with $\\eta$ across the element, and the polar angle varies monotonically with $\\xi$ across the element.\n\nStart from the fundamental definition of an isoparametric mapping in two dimensions, the polar coordinate representation of the sector in the plane, and the definition of the Jacobian determinant of a coordinate transformation. Derive a smooth mapping $(x(\\xi,\\eta),y(\\xi,\\eta))$ built from a linear radial law in $\\eta$ and a linear angular law in $\\xi$ that exactly satisfies the four boundary associations. Then compute the Jacobian determinant $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ as a function of $(\\xi,\\eta)$, $R$, and $\\Delta R$, and verify analytically that it is strictly positive at the two-by-two Gauss–Legendre points $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$ used for bilinear/quadratic quadrilateral integration. Angles must be treated in radians.\n\nProvide, as your final answer, the single closed-form analytic expression for the Jacobian determinant $J(\\xi,\\eta)$ of this mapping. Do not substitute numerical values. Express the Jacobian determinant in $\\mathrm{m}^2$.",
            "solution": "The problem requires the derivation of the Jacobian determinant for a specific coordinate transformation used to map a square parametric domain to a physical domain shaped like a quarter-annulus. The validity of the resulting mesh element hinges on the Jacobian determinant being strictly positive.\n\nFirst, we must establish the mapping from the parametric coordinates $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ to the physical coordinates $(x,y)$. The problem specifies that this is achieved by defining a mapping to polar coordinates $(r, \\theta)$ first, where the radius $r$ is a linear function of $\\eta$ and the angle $\\theta$ is a linear function of $\\xi$.\n\nLet the radius be $r(\\eta) = a\\eta + b$. The boundary conditions are:\n1.  At $\\eta = -1$, the radius is the inner radius, $r(-1) = R$.\n2.  At $\\eta = 1$, the radius is the outer radius, $r(1) = R + \\Delta R$.\n\nSubstituting these into the linear form gives a system of two equations:\n$$\n\\begin{cases}\n-a + b = R \\\\\na + b = R + \\Delta R\n\\end{cases}\n$$\nAdding the two equations yields $2b = 2R + \\Delta R$, so $b = R + \\frac{\\Delta R}{2}$.\nSubtracting the first equation from the second yields $2a = \\Delta R$, so $a = \\frac{\\Delta R}{2}$.\nThus, the radial mapping is:\n$$\nr(\\eta) = \\frac{\\Delta R}{2}\\eta + R + \\frac{\\Delta R}{2} = R + \\frac{\\Delta R}{2}(1+\\eta)\n$$\n\nNext, let the angle be $\\theta(\\xi) = c\\xi + d$. The boundary conditions are:\n1.  At $\\xi = 1$, the angle is $\\theta(1) = 0$.\n2.  At $\\xi = -1$, the angle is $\\theta(-1) = \\frac{\\pi}{2}$.\n\nSubstituting these into the linear form gives:\n$$\n\\begin{cases}\nc + d = 0 \\\\\n-c + d = \\frac{\\pi}{2}\n\\end{cases}\n$$\nAdding the two equations yields $2d = \\frac{\\pi}{2}$, so $d = \\frac{\\pi}{4}$.\nSince $c+d=0$, we have $c = -d = -\\frac{\\pi}{4}$.\nThus, the angular mapping is:\n$$\n\\theta(\\xi) = -\\frac{\\pi}{4}\\xi + \\frac{\\pi}{4} = \\frac{\\pi}{4}(1-\\xi)\n$$\nThis choice ensures a positive Jacobian, as required. A mapping with the opposite orientation for $\\xi$ would yield a negative Jacobian, corresponding to an inverted element, which is physically and numerically invalid.\n\nThe transformation from polar coordinates $(r, \\theta)$ to Cartesian coordinates $(x, y)$ is given by the standard relations:\n$$\nx = r \\cos(\\theta) \\quad \\text{and} \\quad y = r \\sin(\\theta)\n$$\nSubstituting our expressions for $r(\\eta)$ and $\\theta(\\xi)$, we obtain the complete mapping from $(\\xi, \\eta)$ to $(x, y)$:\n$$\nx(\\xi, \\eta) = \\left( R + \\frac{\\Delta R}{2}(1+\\eta) \\right) \\cos\\left( \\frac{\\pi}{4}(1-\\xi) \\right)\n$$\n$$\ny(\\xi, \\eta) = \\left( R + \\frac{\\Delta R}{2}(1+\\eta) \\right) \\sin\\left( \\frac{\\pi}{4}(1-\\xi) \\right)\n$$\n\nThe Jacobian determinant is $J(\\xi, \\eta) = \\det\\left(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right)$. The Jacobian matrix is:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the partial derivatives using the chain rule. Let $r=r(\\eta)$ and $\\theta=\\theta(\\xi)$.\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(r \\cos\\theta) = -r \\sin\\theta \\frac{d\\theta}{d\\xi} = -r(\\eta) \\sin(\\theta(\\xi)) \\left(-\\frac{\\pi}{4}\\right) = \\frac{\\pi}{4}r(\\eta)\\sin(\\theta(\\xi))$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(r \\cos\\theta) = \\cos\\theta \\frac{dr}{d\\eta} = \\cos(\\theta(\\xi)) \\left(\\frac{\\Delta R}{2}\\right) = \\frac{\\Delta R}{2}\\cos(\\theta(\\xi))$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(r \\sin\\theta) = r \\cos\\theta \\frac{d\\theta}{d\\xi} = r(\\eta) \\cos(\\theta(\\xi)) \\left(-\\frac{\\pi}{4}\\right) = -\\frac{\\pi}{4}r(\\eta)\\cos(\\theta(\\xi))$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(r \\sin\\theta) = \\sin\\theta \\frac{dr}{d\\eta} = \\sin(\\theta(\\xi)) \\left(\\frac{\\Delta R}{2}\\right) = \\frac{\\Delta R}{2}\\sin(\\theta(\\xi))$\n\nThe Jacobian matrix is:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\pi}{4}r(\\eta)\\sin(\\theta(\\xi)) & \\frac{\\Delta R}{2}\\cos(\\theta(\\xi)) \\\\ -\\frac{\\pi}{4}r(\\eta)\\cos(\\theta(\\xi)) & \\frac{\\Delta R}{2}\\sin(\\theta(\\xi)) \\end{pmatrix}\n$$\nThe determinant is:\n$$\nJ(\\xi, \\eta) = \\left( \\frac{\\pi}{4}r(\\eta)\\sin(\\theta(\\xi)) \\right) \\left( \\frac{\\Delta R}{2}\\sin(\\theta(\\xi)) \\right) - \\left( \\frac{\\Delta R}{2}\\cos(\\theta(\\xi)) \\right) \\left( -\\frac{\\pi}{4}r(\\eta)\\cos(\\theta(\\xi)) \\right)\n$$\n$$\nJ(\\xi, \\eta) = \\frac{\\pi \\Delta R}{8} r(\\eta) \\sin^2(\\theta(\\xi)) + \\frac{\\pi \\Delta R}{8} r(\\eta) \\cos^2(\\theta(\\xi))\n$$\nFactoring out the common term and using the trigonometric identity $\\sin^2\\alpha + \\cos^2\\alpha = 1$:\n$$\nJ(\\xi, \\eta) = \\frac{\\pi \\Delta R}{8} r(\\eta) (\\sin^2(\\theta(\\xi)) + \\cos^2(\\theta(\\xi))) = \\frac{\\pi \\Delta R}{8} r(\\eta)\n$$\nSubstituting the expression for $r(\\eta)$:\n$$\nJ(\\xi, \\eta) = \\frac{\\pi \\Delta R}{8} \\left( R + \\frac{\\Delta R}{2}(1+\\eta) \\right)\n$$\nThis is the final expression for the Jacobian determinant. Note that it is independent of $\\xi$.\n\nTo verify that the Jacobian is strictly positive, we analyze its sign. The physical parameters $R$ (radius) and $\\Delta R$ (radial thickness) must be positive, so $R > 0$ and $\\Delta R > 0$. The constant $\\pi$ is also positive. Therefore, the pre-factor $\\frac{\\pi \\Delta R}{8}$ is strictly positive.\nThe sign of $J$ is determined by the term $R + \\frac{\\Delta R}{2}(1+\\eta)$.\nThe parametric coordinate $\\eta$ lies in the interval $[-1, 1]$. The term $(1+\\eta)$ is therefore in the range $[0, 2]$.\nAt the lower bound $\\eta = -1$, the term is $R + \\frac{\\Delta R}{2}(0) = R > 0$.\nAt the upper bound $\\eta = 1$, the term is $R + \\frac{\\Delta R}{2}(2) = R + \\Delta R > 0$.\nSince the term is linear in $\\eta$ and positive at both endpoints of the interval, it is strictly positive for all $\\eta \\in (-1, 1]$ and non-negative at $\\eta = -1$. This holds for any point inside the element, including the Gauss-Legendre points where $\\eta = \\pm 1/\\sqrt{3}$.\nThus, $J(\\xi, \\eta) > 0$ for all points within the interior of the parametric domain, satisfying the condition for a valid element mapping.\nThe dimensional units of the Jacobian determinant are (unit of $\\Delta R$) $\\times$ (unit of $R$), which is length squared. Given that $R$ and $\\Delta R$ would be measured in meters in a standard system of units, the Jacobian determinant $J$ has units of $\\mathrm{m}^2$, as expected for a differential area element.",
            "answer": "$$\n\\boxed{\\frac{\\pi \\Delta R}{8} \\left( R + \\frac{\\Delta R}{2}(1+\\eta) \\right)}\n$$"
        },
        {
            "introduction": "Beyond ensuring basic validity, the quality of mesh elements, especially in three dimensions, directly impacts simulation accuracy and solver performance. This practice tackles the common problem of 'sliver' tetrahedra, which are notoriously poor for numerical calculations due to their near-zero volume and bad dihedral angles. By analyzing a representative sliver tetrahedron , you will learn how to use a fundamental mesh improvement technique—constrained vertex relocation—to find an optimal vertex position that maximizes the element's geometric quality.",
            "id": "4129475",
            "problem": "In three-dimensional process simulation for semiconductor manufacturing, tetrahedral mesh quality has a direct impact on numerical conditioning and accuracy of transport and reaction models. A common pathology is the presence of sliver tetrahedra, characterized by dihedral angles near $0^{\\circ}$ or $180^{\\circ}$. Consider a representative local mesh patch near a planar boundary (the wafer surface), modeled as the plane $z=0$. Three boundary vertices form an equilateral triangle of side length $a>0$ in the plane $z=0$, with coordinates\n$$\n\\mathbf{p}_{0}=(0,0,0),\\quad \\mathbf{p}_{1}=(a,0,0),\\quad \\mathbf{p}_{2}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{2},0\\right).\n$$\nAn interior vertex $\\mathbf{p}_{3}$ lies above the centroid of the base triangle by a small height $h_{0}>0$, creating a sliver tetrahedron $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2},\\mathbf{p}_{3})$. Its centroid is\n$$\n\\mathbf{c}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},0\\right),\n$$\nand the interior vertex is initially\n$$\n\\mathbf{p}_{3}^{(0)}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h_{0}\\right),\n$$\nwith $h_{0}\\ll a$. Because the boundary vertices lie on $z=0$, any local transformation must preserve boundary conformity, meaning it must not move any boundary vertex off the boundary plane. Two admissible local transformations are:\n- Constrained vertex relocation (smoothing) of the interior vertex $\\mathbf{p}_{3}$ along the line orthogonal to the boundary plane passing through $\\mathbf{c}$, i.e., $\\mathbf{p}_{3}=\\mathbf{c}+h\\,\\hat{\\mathbf{k}}$, where $\\hat{\\mathbf{k}}=(0,0,1)$ and $h>0$.\n- Topology-preserving flips inside the interior (e.g., $2$–$3$ flips), which require additional interior tetrahedra; however, in this single-tetrahedron patch only vertex relocation is applicable without introducing new vertices.\n\nUsing only fundamental geometric definitions (Euclidean dot and cross products) and the definition of the dihedral angle between two planes as the angle between their normal vectors, do the following:\n1. Derive the dihedral angle $\\theta(h)$, as a function of $h$ and $a$, between the base face $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2})$ and a lateral face sharing the base edge $(\\mathbf{p}_{0},\\mathbf{p}_{1})$, i.e., the face $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{3})$.\n2. Impose the vertex-relocation transformation $\\mathbf{p}_{3}=\\mathbf{c}+h\\,\\hat{\\mathbf{k}}$ and determine the value $h^{\\star}>0$ that equalizes all edge lengths of the tetrahedron. Justify why this choice maximizes the minimum dihedral angle by symmetry and shape regularity under the given constraints.\n3. Evaluate the improved dihedral angle $\\theta(h^{\\star})$ from part 1 at this optimal height. Express your final answer in degrees, and round your result to four significant figures.\n\nAngle unit requirement: express the final angle in degrees. If you need to approximate, round your answer to four significant figures. No boundary vertices may move off the plane $z=0$ at any point in your proposed transformation.",
            "solution": "The solution is structured in three parts as requested by the problem statement.\n\nPart 1: Derivation of the dihedral angle $\\theta(h)$\n\nThe dihedral angle between two faces of a polyhedron is defined as the angle between the normal vectors to the planes containing those faces. We are asked to find the dihedral angle $\\theta(h)$ between the base face $F_{base} = (\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2})$ and the lateral face $F_{lat} = (\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{3})$.\n\nThe vertices are given by:\n$\\mathbf{p}_{0}=(0,0,0)$\n$\\mathbf{p}_{1}=(a,0,0)$\n$\\mathbf{p}_{2}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{2},0\\right)$\n$\\mathbf{p}_{3}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)$\n\nThe base face lies in the plane $z=0$. A normal vector to this plane is $\\mathbf{n}_{base} = \\hat{\\mathbf{k}} = (0,0,1)$. The magnitude is $|\\mathbf{n}_{base}|=1$.\n\nTo find the normal vector to the lateral face $F_{lat}$, we compute the cross product of two edge vectors lying on that face, for instance, $\\mathbf{v}_{10} = \\mathbf{p}_{1} - \\mathbf{p}_{0}$ and $\\mathbf{v}_{30} = \\mathbf{p}_{3} - \\mathbf{p}_{0}$.\n$\\mathbf{v}_{10} = (a,0,0) - (0,0,0) = (a,0,0)$\n$\\mathbf{v}_{30} = \\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right) - (0,0,0) = \\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)$\n\nThe normal vector $\\mathbf{n}_{lat}$ is:\n$$\n\\mathbf{n}_{lat} = \\mathbf{v}_{10} \\times \\mathbf{v}_{30} =\n\\begin{vmatrix}\n\\hat{\\mathbf{i}} & \\hat{\\mathbf{j}} & \\hat{\\mathbf{k}} \\\\\na & 0 & 0 \\\\\n\\frac{a}{2} & \\frac{\\sqrt{3}\\,a}{6} & h\n\\end{vmatrix}\n= \\hat{\\mathbf{i}}\\left(0 \\cdot h - 0 \\cdot \\frac{\\sqrt{3}\\,a}{6}\\right) - \\hat{\\mathbf{j}}\\left(a \\cdot h - 0 \\cdot \\frac{a}{2}\\right) + \\hat{\\mathbf{k}}\\left(a \\cdot \\frac{\\sqrt{3}\\,a}{6} - 0 \\cdot \\frac{a}{2}\\right)\n$$\n$$\n\\mathbf{n}_{lat} = \\left(0, -ah, \\frac{\\sqrt{3}\\,a^2}{6}\\right)\n$$\nThe magnitude of $\\mathbf{n}_{lat}$ is:\n$$\n|\\mathbf{n}_{lat}| = \\sqrt{0^2 + (-ah)^2 + \\left(\\frac{\\sqrt{3}\\,a^2}{6}\\right)^2} = \\sqrt{a^2h^2 + \\frac{3a^4}{36}} = \\sqrt{a^2h^2 + \\frac{a^4}{12}} = a\\sqrt{h^2 + \\frac{a^2}{12}}\n$$\nThe dihedral angle $\\theta(h)$ is the angle between $\\mathbf{n}_{base}$ and $\\mathbf{n}_{lat}$. The cosine of this angle is given by the dot product formula:\n$$\n\\cos(\\theta(h)) = \\frac{\\mathbf{n}_{base} \\cdot \\mathbf{n}_{lat}}{|\\mathbf{n}_{base}| |\\mathbf{n}_{lat}|}\n$$\nThe dot product is:\n$$\n\\mathbf{n}_{base} \\cdot \\mathbf{n}_{lat} = (0,0,1) \\cdot \\left(0, -ah, \\frac{\\sqrt{3}\\,a^2}{6}\\right) = \\frac{\\sqrt{3}\\,a^2}{6}\n$$\nSubstituting the dot product and magnitudes:\n$$\n\\cos(\\theta(h)) = \\frac{\\frac{\\sqrt{3}\\,a^2}{6}}{1 \\cdot a\\sqrt{h^2 + \\frac{a^2}{12}}} = \\frac{\\sqrt{3}\\,a}{6\\sqrt{h^2 + \\frac{a^2}{12}}} = \\frac{a}{\\sqrt{a^2 + 12h^2}}\n$$\nThus, the dihedral angle as a function of $h$ and $a$ is:\n$$\n\\theta(h) = \\arccos\\left(\\frac{a}{\\sqrt{a^2 + 12h^2}}\\right)\n$$\n\nPart 2: Determination of the optimal height $h^{\\star}$\n\nFor the tetrahedron to have all edge lengths equal, it must be a regular tetrahedron. The base is an equilateral triangle with side length $a$. Therefore, the three lateral edges $(\\mathbf{p}_{0},\\mathbf{p}_{3})$, $(\\mathbf{p}_{1},\\mathbf{p}_{3})$, and $(\\mathbf{p}_{2},\\mathbf{p}_{3})$ must also have length $a$.\nLet's compute the squared length of one of these edges, for example $|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2$:\n$$\n|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2 = \\left\\|\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)\\right\\|^2 = \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{\\sqrt{3}\\,a}{6}\\right)^2 + h^2 = \\frac{a^2}{4} + \\frac{3a^2}{36} + h^2 = \\frac{a^2}{4} + \\frac{a^2}{12} + h^2\n$$\n$$\n|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2 = \\frac{3a^2+a^2}{12} + h^2 = \\frac{4a^2}{12} + h^2 = \\frac{a^2}{3} + h^2\n$$\nSetting this squared length equal to $a^2$:\n$$\n\\frac{a^2}{3} + h^2 = a^2 \\implies h^2 = a^2 - \\frac{a^2}{3} = \\frac{2a^2}{3}\n$$\nSince $h>0$, the optimal height $h^{\\star}$ is:\n$$\nh^{\\star} = \\sqrt{\\frac{2a^2}{3}} = a\\sqrt{\\frac{2}{3}} = \\frac{\\sqrt{6}}{3}a\n$$\nThis choice of $h^{\\star}$ corresponds to a regular tetrahedron. This configuration maximizes the minimum dihedral angle for the given constraints. The justification is as follows: The prescribed vertex transformation preserves the $C_{3v}$ symmetry of the tetrahedron. Due to this symmetry, for any given $h$, the three dihedral angles between the base and the lateral faces are equal ($\\theta_{base}(h)$), and the three dihedral angles between adjacent lateral faces are also equal ($\\theta_{apex}(h)$). The quality of the tetrahedron is determined by the smaller of these two angle values. The function $\\theta_{base}(h)$ is monotonically increasing with $h$ (from $0^{\\circ}$ as $h \\to 0$ to $90^{\\circ}$ as $h \\to \\infty$), while the function $\\theta_{apex}(h)$ can be shown to be monotonically decreasing (from $180^{\\circ}$ as $h \\to 0$ to $120^{\\circ}$ as $h \\to \\infty$). The minimum of these two functions is maximized when they are equal, i.e., $\\theta_{base}(h) = \\theta_{apex}(h)$. This condition of all dihedral angles being equal is, by definition, met in a regular tetrahedron. Thus, the height $h^{\\star}$ which forms a regular tetrahedron maximizes the minimum dihedral angle.\n\nPart 3: Evaluation of the improved dihedral angle $\\theta(h^{\\star})$\n\nWe substitute $h^{\\star}$ into the expression for $\\theta(h)$. Specifically, we use $(h^{\\star})^2 = \\frac{2a^2}{3}$:\n$$\n\\cos(\\theta(h^{\\star})) = \\frac{a}{\\sqrt{a^2 + 12(h^{\\star})^2}} = \\frac{a}{\\sqrt{a^2 + 12\\left(\\frac{2a^2}{3}\\right)}} = \\frac{a}{\\sqrt{a^2 + 8a^2}} = \\frac{a}{\\sqrt{9a^2}}\n$$\nSince $a>0$, this simplifies to:\n$$\n\\cos(\\theta(h^{\\star})) = \\frac{a}{3a} = \\frac{1}{3}\n$$\nThe value of the optimal dihedral angle is therefore:\n$$\n\\theta(h^{\\star}) = \\arccos\\left(\\frac{1}{3}\\right)\n$$\nTo express this in degrees and round to four significant figures:\n$$\n\\theta(h^{\\star}) \\approx 70.528779...^{\\circ}\n$$\nRounding this value to four significant figures gives $70.53^{\\circ}$.",
            "answer": "$$\\boxed{70.53}$$"
        },
        {
            "introduction": "In many process simulations, such as etching or deposition, the computational mesh must adapt to a constantly evolving physical interface. A static, high-quality mesh will eventually become distorted, leading to numerical errors and instability. This final practice places you in the role of designing the logic for an adaptive simulation, where you must derive explicit criteria, or 'triggers,' for when to perform remeshing based on quality degradation and when to execute a topology change to handle geometric pinch-off .",
            "id": "4129485",
            "problem": "A two-dimensional etch simulation of a silicon feature is performed using a level-set representation of the evolving interface, $\\phi(x,t)=0$, on an unstructured triangular mesh under an Arbitrary Lagrangian–Eulerian (ALE) scheme. The interface advances with normal velocity $v_{n}(s,t)$ and the mesh nodes undergo tangential motion to reduce grid skew. As the feature evolves, elements deform and a narrow “neck” region may form. Robust process modeling requires triggering remeshing based on mesh quality metrics and performing topology changes to handle pinch-off or severe necking before the interface evolution becomes numerically unstable.\n\nConsider the following definitions and well-tested facts:\n- Let $J_{s}^{(K)} \\in (0,1]$ be the scaled Jacobian of element $K$, $\\theta_{\\min}^{(K)} \\in (0,\\pi/3]$ its minimum interior angle, and $A^{(K)} \\ge 1$ its aspect ratio. Define the element quality\n$$\nq^{(K)} = \\min\\left\\{ J_{s}^{(K)}, \\sin\\!\\big(\\theta_{\\min}^{(K)}\\big), \\frac{1}{A^{(K)}} \\right\\},\n$$\nand the global minimum quality $q_{\\min}(t) = \\min_{K} q^{(K)}(t)$.\n- For piecewise-linear geometric approximation of a smooth curve, the curvature error in element $K$ satisfies the bound\n$$\nE_{\\kappa}^{(K)} \\le \\frac{C_{\\kappa}}{q^{(K)}} h_{K} \\left\\| \\nabla_{s} \\kappa \\right\\|,\n$$\nwhere $C_{\\kappa} > 0$ is a shape-regularity constant, $h_{K}$ is a characteristic edge length of $K$, $\\kappa$ is the curvature of the interface, and $\\nabla_{s}$ denotes the surface (curve) gradient along arclength. Assume the global bound $E_{\\kappa}^{\\max}(t) \\le \\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max}(t) \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$, where $h_{\\max}(t)$ is the maximum edge length and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ is the maximum curvature gradient magnitude on the interface.\n\nTo maintain accuracy, remeshing is required whenever $E_{\\kappa}^{\\max}(t) > \\epsilon_{\\kappa}$ for a prescribed tolerance $\\epsilon_{\\kappa} > 0$. Suppose in this simulation the mesh deformation is such that\n$$\nq_{\\min}(t) = q_{0} - \\gamma t,\n$$\nwith constants $q_{0} \\in (0,1)$ and $\\gamma > 0$, while $h_{\\max}(t)$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ are approximately constant over the time window of interest. Define the remeshing trigger functional $R(t)$ as $R(t) = q_{\\min}(t) - q_{\\mathrm{thr}}$, where $q_{\\mathrm{thr}}$ is the threshold quality implied by the curvature error tolerance.\n\nFor topology changes, consider a local neck region of initial width $w_{0}$ subjected to lateral etching with constant velocity $v_{\\ell} > 0$ from both sidewalls, so that the neck width evolves as\n$$\nw(t) = w_{0} - 2 v_{\\ell} t.\n$$\nA robust topology change (neck break) is performed when $w(t) \\le \\eta\\, h_{\\mathrm{neck}}$, where $h_{\\mathrm{neck}}$ is the local mesh size near the neck and $\\eta \\in [1,2]$ is a user-defined resolution factor chosen to avoid under-resolution of the geometry.\n\nGiven the following parameter values:\n- $C_{\\kappa} = 0.5$,\n- $h_{\\max} = 3 \\times 10^{-9} \\text{ m}$,\n- $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} = 2 \\times 10^{16} \\text{ m}^{-2}$,\n- $\\epsilon_{\\kappa} = 1 \\times 10^{8} \\text{ m}^{-1}$,\n- $q_{0} = 0.9$,\n- $\\gamma = 2.0 \\times 10^{-2} \\text{ s}^{-1}$,\n- $w_{0} = 20 \\times 10^{-9} \\text{ m}$,\n- $h_{\\mathrm{neck}} = 2.5 \\times 10^{-9} \\text{ m}$,\n- $v_{\\ell} = 0.25 \\times 10^{-9} \\text{ m/s}$,\n- $\\eta = 1.5$,\n\nperform the following:\n1. Starting from the curvature error bound and the definition of $q_{\\min}(t)$, derive an explicit expression for the threshold quality $q_{\\mathrm{thr}}$ that guarantees $E_{\\kappa}^{\\max}(t) \\le \\epsilon_{\\kappa}$. Then write $R(t)$ and solve for the remeshing time $t_{\\mathrm{remesh}}$ at which $R(t) = 0$.\n2. Starting from the neck-width evolution and the topology change condition $w(t) \\le \\eta\\, h_{\\mathrm{neck}}$, derive the criterion for the topology-change time $t_{\\mathrm{topo}}$ and evaluate it.\n\nExpress both final times, $t_{\\mathrm{remesh}}$ and $t_{\\mathrm{topo}}$, in seconds. Round your answers to four significant figures.",
            "solution": "The problem presents two independent tasks: first, to determine the time at which adaptive remeshing is triggered due to mesh quality degradation, and second, to determine the time at which a topology change is performed to handle a pinching neck in the geometry. We will address each task sequentially.\n\nPart 1: Calculation of the Remeshing Time, $t_{\\mathrm{remesh}}$\n\nThe first step is to derive the threshold quality, $q_{\\mathrm{thr}}$, from the given curvature error criterion. Remeshing is required when the maximum curvature error, $E_{\\kappa}^{\\max}(t)$, exceeds a specified tolerance, $\\epsilon_{\\kappa}$. The condition is $E_{\\kappa}^{\\max}(t) > \\epsilon_{\\kappa}$.\nThe problem provides the global bound for this error:\n$$\nE_{\\kappa}^{\\max}(t) \\le \\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max}(t) \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)\n$$\nTo ensure the error tolerance is met, we must enforce $E_{\\kappa}^{\\max}(t) \\le \\epsilon_{\\kappa}$. Combining this with the bound, we require:\n$$\n\\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} \\le \\epsilon_{\\kappa}\n$$\nHere, we have used the fact that $h_{\\max}(t)$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ are assumed to be constant, so we denote them as $h_{\\max}$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}$.\nTo maintain mesh validity and accuracy, the global minimum quality $q_{\\min}(t)$ must remain above a certain threshold. We can find this threshold, $q_{\\mathrm{thr}}$, by solving the inequality for $q_{\\min}(t)$. Since $q_{\\min}(t)$ is in the denominator and is a positive quantity, we can rearrange the inequality as:\n$$\nq_{\\min}(t) \\ge \\frac{C_{\\kappa} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}}{\\epsilon_{\\kappa}}\n$$\nThe threshold quality, $q_{\\mathrm{thr}}$, is the minimum value of $q_{\\min}(t)$ that satisfies this condition. Thus, we define $q_{\\mathrm{thr}}$ as the value that makes the inequality an equality:\n$$\nq_{\\mathrm{thr}} = \\frac{C_{\\kappa} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}}{\\epsilon_{\\kappa}}\n$$\nWe substitute the given parameter values to find the numerical value of $q_{\\mathrm{thr}}$:\n- $C_{\\kappa} = 0.5$\n- $h_{\\max} = 3 \\times 10^{-9} \\text{ m}$\n- $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} = 2 \\times 10^{16} \\text{ m}^{-2}$\n- $\\epsilon_{\\kappa} = 1 \\times 10^{8} \\text{ m}^{-1}$\n\n$$\nq_{\\mathrm{thr}} = \\frac{(0.5) \\cdot (3 \\times 10^{-9}) \\cdot (2 \\times 10^{16})}{1 \\times 10^{8}} = \\frac{3 \\times 10^{7}}{1 \\times 10^{8}} = 0.3\n$$\nThe problem states that remeshing is triggered when $R(t) = 0$, where the functional $R(t)$ is defined as $R(t) = q_{\\min}(t) - q_{\\mathrm{thr}}$. The time for remeshing, $t_{\\mathrm{remesh}}$, is found by solving $q_{\\min}(t_{\\mathrm{remesh}}) = q_{\\mathrm{thr}}$.\nThe evolution of the minimum quality is given by:\n$$\nq_{\\min}(t) = q_{0} - \\gamma t\n$$\nSetting this equal to $q_{\\mathrm{thr}}$ at $t = t_{\\mathrm{remesh}}$:\n$$\nq_{0} - \\gamma t_{\\mathrm{remesh}} = q_{\\mathrm{thr}}\n$$\nSolving for $t_{\\mathrm{remesh}}$:\n$$\n\\gamma t_{\\mathrm{remesh}} = q_{0} - q_{\\mathrm{thr}}\n$$\n$$\nt_{\\mathrm{remesh}} = \\frac{q_{0} - q_{\\mathrm{thr}}}{\\gamma}\n$$\nNow we substitute the remaining numerical values:\n- $q_{0} = 0.9$\n- $\\gamma = 2.0 \\times 10^{-2} \\text{ s}^{-1}$\n- $q_{\\mathrm{thr}} = 0.3$\n\n$$\nt_{\\mathrm{remesh}} = \\frac{0.9 - 0.3}{2.0 \\times 10^{-2}} = \\frac{0.6}{0.02} = 30 \\text{ s}\n$$\n\nPart 2: Calculation of the Topology Change Time, $t_{\\mathrm{topo}}$\n\nThe second task is to find the time $t_{\\mathrm{topo}}$ at which a topology change is triggered. This occurs when the width of a narrowing neck, $w(t)$, becomes smaller than or equal to a critical value determined by the local mesh size $h_{\\mathrm{neck}}$ and a resolution factor $\\eta$. The condition is:\n$$\nw(t) \\le \\eta h_{\\mathrm{neck}}\n$$\nThe time $t_{\\mathrm{topo}}$ is the instant this condition is first met, which corresponds to the equality:\n$$\nw(t_{\\mathrm{topo}}) = \\eta h_{\\mathrm{neck}}\n$$\nThe evolution of the neck width is given by the linear function:\n$$\nw(t) = w_{0} - 2 v_{\\ell} t\n$$\nSubstituting this expression into the trigger condition:\n$$\nw_{0} - 2 v_{\\ell} t_{\\mathrm{topo}} = \\eta h_{\\mathrm{neck}}\n$$\nWe rearrange this equation to solve for $t_{\\mathrm{topo}}$:\n$$\n2 v_{\\ell} t_{\\mathrm{topo}} = w_{0} - \\eta h_{\\mathrm{neck}}\n$$\n$$\nt_{\\mathrm{topo}} = \\frac{w_{0} - \\eta h_{\\mathrm{neck}}}{2 v_{\\ell}}\n$$\nWe are given the following parameter values:\n- $w_{0} = 20 \\times 10^{-9} \\text{ m}$\n- $h_{\\mathrm{neck}} = 2.5 \\times 10^{-9} \\text{ m}$\n- $v_{\\ell} = 0.25 \\times 10^{-9} \\text{ m/s}$\n- $\\eta = 1.5$\n\nFirst, we compute the terms in the numerator and denominator:\nThe critical width is $\\eta h_{\\mathrm{neck}} = (1.5) \\cdot (2.5 \\times 10^{-9}) = 3.75 \\times 10^{-9} \\text{ m}$.\nThe total lateral etch rate is $2 v_{\\ell} = 2 \\cdot (0.25 \\times 10^{-9}) = 0.5 \\times 10^{-9} \\text{ m/s}$.\n\nNow, we substitute these into the expression for $t_{\\mathrm{topo}}$:\n$$\nt_{\\mathrm{topo}} = \\frac{(20 \\times 10^{-9}) - (3.75 \\times 10^{-9})}{0.5 \\times 10^{-9}} = \\frac{16.25 \\times 10^{-9}}{0.5 \\times 10^{-9}} = \\frac{16.25}{0.5} = 32.5 \\text{ s}\n$$\n\nThe problem asks for the answers to be rounded to four significant figures.\n$t_{\\mathrm{remesh}} = 30 \\text{ s}$ becomes $30.00 \\text{ s}$.\n$t_{\\mathrm{topo}} = 32.5 \\text{ s}$ becomes $32.50 \\text{ s}$.\n\nThe required times are $t_{\\mathrm{remesh}} = 30.00$ s and $t_{\\mathrm{topo}} = 32.50$ s.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.00 & 32.50\n\\end{pmatrix}\n}\n$$"
        }
    ]
}