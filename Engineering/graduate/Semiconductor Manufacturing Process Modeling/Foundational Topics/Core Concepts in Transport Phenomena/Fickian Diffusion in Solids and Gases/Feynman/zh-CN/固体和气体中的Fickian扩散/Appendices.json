{
    "hands_on_practices": [
        {
            "introduction": "扩散模型中的参数，如扩散系数 $D$，并非纯理论的构造，而是必须通过实验来确定。本练习将演示实验数据（不同温度下的扩散系数测量值）与底层物理模型（阿伦尼乌斯方程）之间的关键联系。你将学习如何通过线性化模型，使用统计方法（普通最小二乘法）提取活化能 $E_a$ 和指前因子 $D_0$，并进一步将拟合的不确定性传播到工艺预测中 ()。",
            "id": "4126111",
            "problem": "在晶体硅的高温掺杂激活中，点缺陷或掺杂物种的扩散系数被建模为阿伦尼乌斯型菲克扩散，其中扩散系数 $D(T)$ 随温度 $T$ 的变化关系如下：\n$$\nD(T) = D_0 \\exp\\!\\left(-\\frac{E_a}{k_B T}\\right),\n$$\n其中 $D_0$ 是指前因子，$E_a$ 是活化能，$k_B$ 是玻尔兹曼常数。在一系列不同温度下对扩散系数的独立测量得到数据对 $\\{(T_i, D_i)\\}_{i=1}^{N}$，这些数据对被转换为 $\\{(x_i, y_i)\\}_{i=1}^{N}$，其中 $x_i = 1/T_i$ 且 $y_i = \\ln D_i$。假设转换后的数据服从一个方差齐性的线性模型：\n$$\ny_i = a + b x_i + \\varepsilon_i,\n$$\n其中 $a = \\ln D_0$，$b = -E_a/k_B$，且 $\\varepsilon_i$ 是独立同分布的高斯残差，其均值为零，方差为 $\\sigma^2$。请仅使用上述基本定律和线性模型假设，从第一性原理出发进行以下推导：\n- 推导 $a$ 和 $b$ 的普通最小二乘（OLS）估计量。\n- 用 $a$ 和 $b$ 的OLS估计量表示 $E_a$ 和 $D_0$。\n- 令 $x^{\\ast} = 1/T^{\\ast}$，其中 $T^{\\ast}$ 为工艺温度，退火时间为 $t$。对于一维菲克扩散下的delta函数形式初始条件，特征扩散长度为 $L(T^{\\ast}, t) = \\sqrt{2 D(T^{\\ast})\\, t}$。使用基于 $(a,b)$ 的OLS参数协方差矩阵的线性不确定性传播方法，推导方差 $\\operatorname{Var}[L(T^{\\ast}, t)]$ 的闭式解析表达式，该方差仅由 $(a,b)$ 的不确定性引起。您的最终表达式必须用 $t$、$a$、$b$、$x^{\\ast}$ 以及OLS拟合产生的 $(a,b)$ 的 $(2 \\times 2)$ 协方差矩阵的元素来表示。\n请将您的最终答案以单个闭式解析表达式的形式给出。无需进行数值计算，最终方框内的表达式中不应出现单位。",
            "solution": "该问题要求推导线性化阿伦尼乌斯模型的普通最小二乘（OLS）估计量，用这些估计量表示物理参数，并使用不确定性传播方法推导特征扩散长度的方差。该问题提法正确且科学上合理。我们从第一性原理开始进行推导。\n\n首先，我们推导线性模型 $y_i = a + b x_i + \\varepsilon_i$ 中参数 $a$ 和 $b$ 的OLS估计量。OLS方法旨在最小化残差平方和 $S$，其定义为：\n$$\nS(a, b) = \\sum_{i=1}^{N} \\varepsilon_i^2 = \\sum_{i=1}^{N} (y_i - a - b x_i)^2\n$$\n为了找到使 $S$ 最小化的 $a$ 和 $b$ 的值（我们将其记为 $\\hat{a}$ 和 $\\hat{b}$），我们对 $S$ 分别求关于 $a$ 和 $b$ 的偏导数，并令它们为零。\n\n关于 $a$ 的偏导数为：\n$$\n\\frac{\\partial S}{\\partial a} = \\sum_{i=1}^{N} 2(y_i - a - b x_i)(-1) = -2 \\left( \\sum_{i=1}^{N} y_i - Na - b \\sum_{i=1}^{N} x_i \\right)\n$$\n令其为零，得到第一个正规方程：\n$$\nNa + b \\sum_{i=1}^{N} x_i = \\sum_{i=1}^{N} y_i\n$$\n两边同除以 $N$，并使用样本均值的定义 $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^{N} x_i$ 和 $\\bar{y} = \\frac{1}{N}\\sum_{i=1}^{N} y_i$，我们得到估计量 $\\hat{a}$ 用 $\\hat{b}$ 表示的表达式：\n$$\n\\hat{a} = \\bar{y} - \\hat{b} \\bar{x}\n$$\n\n关于 $b$ 的偏导数为：\n$$\n\\frac{\\partial S}{\\partial b} = \\sum_{i=1}^{N} 2(y_i - a - b x_i)(-x_i) = -2 \\left( \\sum_{i=1}^{N} x_i y_i - a \\sum_{i=1}^{N} x_i - b \\sum_{i=1}^{N} x_i^2 \\right)\n$$\n令其为零，得到第二个正规方程：\n$$\na \\sum_{i=1}^{N} x_i + b \\sum_{i=1}^{N} x_i^2 = \\sum_{i=1}^{N} x_i y_i\n$$\n将 $\\hat{a}$ 的表达式代入第二个正规方程：\n$$\n(\\bar{y} - \\hat{b} \\bar{x}) \\sum_{i=1}^{N} x_i + \\hat{b} \\sum_{i=1}^{N} x_i^2 = \\sum_{i=1}^{N} x_i y_i\n$$\n整理以求解 $\\hat{b}$：\n$$\n\\hat{b} \\left( \\sum_{i=1}^{N} x_i^2 - \\bar{x} \\sum_{i=1}^{N} x_i \\right) = \\sum_{i=1}^{N} x_i y_i - \\bar{y} \\sum_{i=1}^{N} x_i\n$$\n这些项可以用平方和与叉积和表示法来表达：$\\sum_{i=1}^{N} (x_i - \\bar{x})^2 = \\sum_{i=1}^{N} x_i^2 - N\\bar{x}^2$ 和 $\\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y}) = \\sum_{i=1}^{N} x_i y_i - N\\bar{x}\\bar{y}$。由于 $\\sum_{i=1}^{N} x_i = N\\bar{x}$ 和 $\\sum_{i=1}^{N} y_i = N\\bar{y}$，关于 $\\hat{b}$ 的方程变为：\n$$\n\\hat{b} \\sum_{i=1}^{N} (x_i - \\bar{x})^2 = \\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})\n$$\n因此，$b$ 的OLS估计量为：\n$$\n\\hat{b} = \\frac{\\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2}\n$$\n$a$ 的OLS估计量为 $\\hat{a} = \\bar{y} - \\hat{b} \\bar{x}$。\n\n第二，我们用OLS估计量表示物理参数 $D_0$ 和 $E_a$。问题给出了关系式 $a = \\ln D_0$ 和 $b = -E_a/k_B$。我们可以通过将OLS估计量 $\\hat{a}$ 和 $\\hat{b}$ 代入这些反向关系式来获得 $D_0$ 和 $E_a$ 的估计量：\n由 $a = \\ln D_0$，我们有 $D_0 = \\exp(a)$。因此 $D_0$ 的估计量为：\n$$\n\\hat{D}_0 = \\exp(\\hat{a})\n$$\n由 $b = -E_a/k_B$，我们有 $E_a = -b k_B$。因此 $E_a$ 的估计量为：\n$$\n\\hat{E}_a = -\\hat{b} k_B\n$$\n\n第三，我们推导特征扩散长度方差 $\\operatorname{Var}[L(T^{\\ast}, t)]$ 的表达式。扩散长度由 $L(T^{\\ast}, t) = \\sqrt{2 D(T^{\\ast})\\, t}$ 给出。扩散系数 $D(T^{\\ast})$ 通过阿伦尼乌斯方程与线性模型参数 $a$ 和 $b$ 相关联。在温度 $T^{\\ast}$下，我们有 $x^{\\ast} = 1/T^{\\ast}$，模型预测 $\\ln D(T^{\\ast}) = a + b x^{\\ast}$。因此，$D(T^{\\ast}) = \\exp(a + b x^{\\ast})$。\n扩散长度 $L$ 可以写成参数 $a$ 和 $b$ 的函数：\n$$\nL(a, b) = \\sqrt{2t \\exp(a + b x^{\\ast})} = (2t)^{1/2} \\exp\\left(\\frac{a + b x^{\\ast}}{2}\\right)\n$$\n$L$ 的方差源于OLS估计量 $\\hat{a}$ 和 $\\hat{b}$ 的统计不确定性。虽然真实参数 $(a,b)$ 是固定常数，但它们的估计量 $(\\hat{a},\\hat{b})$ 是具有联合概率分布的随机变量。问题中提到的“$(a,b)$ 的协方差矩阵”是一种常见但略不严谨的表示法，它实际上指的是估计量的协方差矩阵 $\\operatorname{Cov}(\\hat{a}, \\hat{b})$。我们用 $\\mathbf{\\Sigma}$ 表示该矩阵：\n$$\n\\mathbf{\\Sigma} = \\begin{pmatrix} \\operatorname{Var}[\\hat{a}]  \\operatorname{Cov}[\\hat{a}, \\hat{b}] \\\\ \\operatorname{Cov}[\\hat{a}, \\hat{b}]  \\operatorname{Var}[\\hat{b}] \\end{pmatrix}\n$$\n我们使用一阶泰勒展开（线性不确定性传播）来近似一个关于相关随机变量的函数的方差。对于 $L = L(\\hat{a}, \\hat{b})$，其方差由下式给出：\n$$\n\\operatorname{Var}[L] \\approx \\left(\\frac{\\partial L}{\\partial a}\\right)^2 \\operatorname{Var}[\\hat{a}] + \\left(\\frac{\\partial L}{\\partial b}\\right)^2 \\operatorname{Var}[\\hat{b}] + 2 \\left(\\frac{\\partial L}{\\partial a}\\right) \\left(\\frac{\\partial L}{\\partial b}\\right) \\operatorname{Cov}[\\hat{a}, \\hat{b}]\n$$\n这些偏导数在点估计 $(\\hat{a}, \\hat{b})$ 处求值。为简化表示，我们用 $a$ 和 $b$ 来写它们。\n首先，我们计算所需的偏导数：\n$$\n\\frac{\\partial L}{\\partial a} = \\frac{\\partial}{\\partial a} \\left[ (2t)^{1/2} \\exp\\left(\\frac{a + b x^{\\ast}}{2}\\right) \\right] = (2t)^{1/2} \\exp\\left(\\frac{a + b x^{\\ast}}{2}\\right) \\cdot \\frac{1}{2} = \\frac{1}{2} L(a, b)\n$$\n$$\n\\frac{\\partial L}{\\partial b} = \\frac{\\partial}{\\partial b} \\left[ (2t)^{1/2} \\exp\\left(\\frac{a + b x^{\\ast}}{2}\\right) \\right] = (2t)^{1/2} \\exp\\left(\\frac{a + b x^{\\ast}}{2}\\right) \\cdot \\frac{x^{\\ast}}{2} = \\frac{x^{\\ast}}{2} L(a, b)\n$$\n将这些导数代入方差公式：\n$$\n\\operatorname{Var}[L] \\approx \\left(\\frac{1}{2} L\\right)^2 \\operatorname{Var}[\\hat{a}] + \\left(\\frac{x^{\\ast}}{2} L\\right)^2 \\operatorname{Var}[\\hat{b}] + 2 \\left(\\frac{1}{2} L\\right) \\left(\\frac{x^{\\ast}}{2} L\\right) \\operatorname{Cov}[\\hat{a}, \\hat{b}]\n$$\n提取公因式：\n$$\n\\operatorname{Var}[L] \\approx \\frac{L^2}{4} \\left( \\operatorname{Var}[\\hat{a}] + (x^{\\ast})^2 \\operatorname{Var}[\\hat{b}] + 2x^{\\ast} \\operatorname{Cov}[\\hat{a}, \\hat{b}] \\right)\n$$\n现在，我们代入 $L^2 = 2t \\exp(a + b x^{\\ast})$：\n$$\n\\operatorname{Var}[L] \\approx \\frac{2t \\exp(a + b x^{\\ast})}{4} \\left( \\operatorname{Var}[\\hat{a}] + (x^{\\ast})^2 \\operatorname{Var}[\\hat{b}] + 2x^{\\ast} \\operatorname{Cov}[\\hat{a}, \\hat{b}] \\right)\n$$\n简化表达式，得到扩散长度方差的最终闭式结果，该结果用模型参数（估计量）、实验条件以及估计量协方差矩阵的元素表示。在表达式中，$a$ 和 $b$ 是点估计 $\\hat{a}$ 和 $\\hat{b}$：\n$$\n\\operatorname{Var}[L] \\approx \\frac{t}{2} \\exp(a + b x^{\\ast}) \\left( \\operatorname{Var}[\\hat{a}] + 2x^{\\ast} \\operatorname{Cov}[\\hat{a}, \\hat{b}] + (x^{\\ast})^2 \\operatorname{Var}[\\hat{b}] \\right)\n$$\n这就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{t}{2} \\exp(a + b x^{\\ast}) \\left( \\operatorname{Var}[\\hat{a}] + 2x^{\\ast} \\operatorname{Cov}[\\hat{a}, \\hat{b}] + (x^{\\ast})^2 \\operatorname{Var}[\\hat{b}] \\right)}\n$$"
        },
        {
            "introduction": "现实世界中的扩散问题，尤其是在半导体制造中，常常涉及在不同性质的多层材料中进行的扩散。本练习提出了一个实际的掺杂预淀积问题，即掺杂剂穿过一层保护性氧化物进入硅中 。它旨在挑战你运用基于时间尺度分析的物理近似方法，来简化这个复杂的耦合系统，这在工程和物理建模中是一项极其强大的技术。",
            "id": "4126176",
            "problem": "在一个与半导体制造过程建模相关的、将磷进行气源预淀积到晶体硅的步骤中，考虑一个覆盖有薄二氧化硅帽层的半无限硅衬底。掺杂剂在硅和氧化物中都进行菲克扩散。氧化物的厚度为 $L_{\\mathrm{ox}} = 5 \\,\\mathrm{nm}$，掺杂剂在氧化物中的扩散系数为 $D_{\\mathrm{ox}} = 1.00 \\times 10^{-12} \\,\\mathrm{cm^{2}\\,s^{-1}}$，并且外部气体在所有时间内都以恒定的掺杂浓度 $C_{g} = 1.00 \\times 10^{21} \\,\\mathrm{cm^{-3}}$ 使氧化物表面饱和。在工艺温度下，硅中掺杂剂的扩散系数为 $D_{\\mathrm{Si}} = 3.00 \\times 10^{-13} \\,\\mathrm{cm^{2}\\,s^{-1}}$。预淀积时间为 $t = 1800 \\,\\mathrm{s}$。初始时，两种介质中各处的掺杂浓度均为零。\n\n在硅-二氧化硅界面处，掺杂剂遵循由偏析系数 $k_{\\mathrm{seg}}$ 描述的平衡偏析，其在界面处定义为 $k_{\\mathrm{seg}} = C_{\\mathrm{Si}}/C_{\\mathrm{Ox}}$。在工艺温度下，$k_{\\mathrm{seg}} = 0.30$。\n\n从菲克第一和第二定律以及界面处偏析系数的定义出发，使用有物理依据的近似方法，将耦合的氧化物-硅输运问题简化为硅表面的一个等效边界条件，并求解向硅中的半无限扩散。然后，计算预淀积后保留在硅中每单位面积的总掺杂剂量，\n$$Q_{\\mathrm{Si}}(t) = \\int_{0}^{\\infty} C_{\\mathrm{Si}}(x,t)\\,dx,$$\n以 $\\mathrm{cm^{-2}}$ 为单位表示。将最终数值答案四舍五入到三位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   系统描述：将磷进行气源预淀积到覆盖有薄二氧化硅帽层的半无限晶体硅衬底中。两种介质中的扩散均为菲克扩散。\n-   氧化物厚度：$L_{\\mathrm{ox}} = 5 \\,\\mathrm{nm} = 5 \\times 10^{-7} \\,\\mathrm{cm}$。\n-   氧化物中掺杂剂的扩散系数：$D_{\\mathrm{ox}} = 1.00 \\times 10^{-12} \\,\\mathrm{cm^{2}\\,s^{-1}}$。\n-   氧化物表面的外部气体浓度：$C_{g} = 1.00 \\times 10^{21} \\,\\mathrm{cm^{-3}}$（对于所有时间 $t>0$ 均为常数）。\n-   硅中掺杂剂的扩散系数：$D_{\\mathrm{Si}} = 3.00 \\times 10^{-13} \\,\\mathrm{cm^{2}\\,s^{-1}}$。\n-   预淀积时间：$t = 1800 \\,\\mathrm{s}$。\n-   初始条件：当 $t=0$ 时，各处掺杂浓度均为零。$C_{\\mathrm{ox}}(x,0) = 0$ 且 $C_{\\mathrm{Si}}(x,0) = 0$。\n-   Si-SiO2界面处的偏析系数：$k_{\\mathrm{seg}} = C_{\\mathrm{Si}}/C_{\\mathrm{Ox}} = 0.30$。\n-   目标量：硅中每单位面积的总掺杂剂量，$Q_{\\mathrm{Si}}(t) = \\int_{0}^{\\infty} C_{\\mathrm{Si}}(x,t)\\,dx$，以 $\\mathrm{cm^{-2}}$ 表示。\n-   要求：将最终数值答案四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：**该问题描述了界面处具有平衡偏析的菲克扩散，这是半导体制造过程建模领域中一个标准且成熟的模型。其物理原理是合理的。\n2.  **适定性：**该问题提供了一整套偏微分方程、边界条件和初始条件。“使用有物理依据的近似方法”的要求指向了该领域中的一种标准简化技术，从而得到一个具有唯一解的适定问题。\n3.  **客观性：**问题以精确、定量和客观的语言陈述。所有参数都给出了明确的数值和单位。\n4.  **未发现缺陷：**该问题科学上合理，内容自洽且客观。所提供的数据对于在典型工艺温度（约 $900-1000 \\,^{\\circ}\\mathrm{C}$）下磷在Si/SiO2系统中的扩散是符合物理实际的。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n掺杂剂的输运在二氧化硅（$x \\in [-L_{\\mathrm{ox}}, 0]$）和硅（$x \\in [0, \\infty)$）两个区域中均遵循菲克第二定律：\n$$ \\frac{\\partial C_{\\mathrm{ox}}}{\\partial t} = D_{\\mathrm{ox}} \\frac{\\partial^2 C_{\\mathrm{ox}}}{\\partial x^2} \\quad \\text{for } x \\in (-L_{\\mathrm{ox}}, 0) $$\n$$ \\frac{\\partial C_{\\mathrm{Si}}}{\\partial t} = D_{\\mathrm{Si}} \\frac{\\partial^2 C_{\\mathrm{Si}}}{\\partial x^2} \\quad \\text{for } x > 0 $$\n\n边界条件和初始条件如下：\n-   在气体-氧化物界面处：对于 $t > 0$，有 $C_{\\mathrm{ox}}(-L_{\\mathrm{ox}}, t) = C_{g}$。\n-   在硅体深处：当 $x \\to \\infty$ 时，$C_{\\mathrm{Si}}(x, t) \\to 0$。\n-   初始状态：$C_{\\mathrm{ox}}(x, 0) = 0$ 且 $C_{\\mathrm{Si}}(x, 0) = 0$。\n-   在氧化物-硅界面处（$x=0$）：\n    -   偏析平衡：$C_{\\mathrm{Si}}(0, t) = k_{\\mathrm{seg}} C_{\\mathrm{ox}}(0, t)$。\n    -   通量连续性：$J_{\\mathrm{ox}}(0, t) = J_{\\mathrm{Si}}(0, t)$，根据菲克第一定律（$J = -D \\frac{\\partial C}{\\partial x}$）可得 $-D_{\\mathrm{ox}} \\left. \\frac{\\partial C_{\\mathrm{ox}}}{\\partial x} \\right|_{x=0^-} = -D_{\\mathrm{Si}} \\left. \\frac{\\partial C_{\\mathrm{Si}}}{\\partial x} \\right|_{x=0^+}$.\n\n问题要求基于有物理依据的近似来求解。我们考察扩散穿过氧化物层的特征时间 $\\tau_{\\mathrm{ox}} = L_{\\mathrm{ox}}^2 / D_{\\mathrm{ox}}$。\n$$ \\tau_{\\mathrm{ox}} = \\frac{(5 \\times 10^{-7} \\,\\mathrm{cm})^2}{1.00 \\times 10^{-12} \\,\\mathrm{cm^2\\,s^{-1}}} = \\frac{25 \\times 10^{-14} \\,\\mathrm{cm^2}}{1.00 \\times 10^{-12} \\,\\mathrm{cm^2\\,s^{-1}}} = 0.25 \\,\\mathrm{s} $$\n由于该时间远小于总工艺时间 $t = 1800 \\,\\mathrm{s}$，薄氧化物层内的掺杂剂分布将迅速达到准稳态。在这种状态下，氧化物扩散方程中的时间导数项可以忽略不计，即 $\\frac{\\partial C_{\\mathrm{ox}}}{\\partial t} \\approx 0$，这意味着 $\\frac{\\partial^2 C_{\\mathrm{ox}}}{\\partial x^2} \\approx 0$。因此，氧化物中的浓度分布近似为线性：\n$$ C_{\\mathrm{ox}}(x, t) \\approx A(t) x + B(t) $$\n系数 $A(t)$ 和 $B(t)$ 可以通过应用氧化物层的边界条件来找到：\n-   $C_{\\mathrm{ox}}(-L_{\\mathrm{ox}}, t) = -A(t)L_{\\mathrm{ox}} + B(t) = C_{g}$\n-   $C_{\\mathrm{ox}}(0, t) = B(t)$\n\n由此，我们得到 $A(t) = \\frac{B(t) - C_g}{L_{\\mathrm{ox}}} = \\frac{C_{\\mathrm{ox}}(0, t) - C_g}{L_{\\mathrm{ox}}}$。在此近似下，穿过氧化物的通量是恒定的，由下式给出：\n$$ J_{\\mathrm{ox}} = -D_{\\mathrm{ox}} \\frac{\\partial C_{\\mathrm{ox}}}{\\partial x} = -D_{\\mathrm{ox}} A(t) = \\frac{D_{\\mathrm{ox}}}{L_{\\mathrm{ox}}} (C_g - C_{\\mathrm{ox}}(0, t)) $$\n根据通量连续性，这也是进入硅的通量 $J_{\\mathrm{Si}}(0, t)$。使用偏析关系 $C_{\\mathrm{ox}}(0, t) = C_{\\mathrm{Si}}(0, t) / k_{\\mathrm{seg}}$，我们得到：\n$$ J_{\\mathrm{Si}}(0, t) = \\frac{D_{\\mathrm{ox}}}{L_{\\mathrm{ox}}} \\left( C_g - \\frac{C_{\\mathrm{Si}}(0, t)}{k_{\\mathrm{seg}}} \\right) $$\n该表达式为硅中的扩散问题提供了一个等效边界条件。现在问题简化为在 $x=0$ 处满足此条件的情况下，求解半无限介质中的 $C_{\\mathrm{Si}}(x,t)$。\n\n我们通过分析该边界条件的性质，做出第二个有物理依据的近似。进入硅的通量受限于穿过氧化物的输运或向硅体内的扩散。我们可以通过评估无量纲量 $U = \\frac{h' \\sqrt{t}}{\\sqrt{D_{\\mathrm{Si}}}}$ 来比较这两种输运限制，其中 $h' = \\frac{D_{\\mathrm{ox}}}{k_{\\mathrm{seg}} L_{\\mathrm{ox}}}$ 是一个等效传质系数。\n$$ h' = \\frac{1.00 \\times 10^{-12} \\,\\mathrm{cm^2\\,s^{-1}}}{0.30 \\times (5 \\times 10^{-7} \\,\\mathrm{cm})} = \\frac{1.00 \\times 10^{-12}}{1.5 \\times 10^{-7}} \\,\\mathrm{cm\\,s^{-1}} \\approx 6.667 \\times 10^{-6} \\,\\mathrm{cm\\,s^{-1}} $$\n$$ U = \\frac{h' \\sqrt{t}}{\\sqrt{D_{\\mathrm{Si}}}} = (6.667 \\times 10^{-6}) \\sqrt{\\frac{1800}{3.00 \\times 10^{-13}}} = (6.667 \\times 10^{-6}) \\sqrt{6 \\times 10^{15}} \\approx 51.6 $$\n由于 $U \\gg 1$，整个过程是强扩散限制的。这意味着与硅吸收掺杂剂的速率相比，穿过氧化物的输运速度非常快。因此，边界条件可以简化为一个恒定表面浓度条件（狄利克雷条件）。表面浓度 $C_{\\mathrm{Si}}(0,t)$ 迅速接近其平衡值，该值可以看作氧化物对扩散没有阻碍时确定。\n$$ C_{\\mathrm{Si}}(0, t) \\approx k_{\\mathrm{seg}} C_g \\equiv C_s^* $$\n简化后的硅扩散问题是：\n$$ \\frac{\\partial C_{\\mathrm{Si}}}{\\partial t} = D_{\\mathrm{Si}} \\frac{\\partial^2 C_{\\mathrm{Si}}}{\\partial x^2} $$\n其中 $C_{\\mathrm{Si}}(x, 0) = 0$，$C_{\\mathrm{Si}}(0, t) = C_s^*$，且当 $x \\to \\infty$ 时 $C_{\\mathrm{Si}}(x, t) \\to 0$。\n这个标准问题的解可以用互补误差函数 $\\mathrm{erfc}$ 表示：\n$$ C_{\\mathrm{Si}}(x, t) = C_s^* \\mathrm{erfc}\\left(\\frac{x}{2\\sqrt{D_{\\mathrm{Si}}t}}\\right) $$\n硅中的总掺杂剂量 $Q_{\\mathrm{Si}}(t)$ 是该浓度分布在硅深度上的积分：\n$$ Q_{\\mathrm{Si}}(t) = \\int_0^\\infty C_{\\mathrm{Si}}(x, t) dx = \\int_0^\\infty C_s^* \\mathrm{erfc}\\left(\\frac{x}{2\\sqrt{D_{\\mathrm{Si}}t}}\\right) dx $$\n令 $u = \\frac{x}{2\\sqrt{D_{\\mathrm{Si}}t}}$，则 $dx = 2\\sqrt{D_{\\mathrm{Si}}t} \\, du$。\n$$ Q_{\\mathrm{Si}}(t) = C_s^* (2\\sqrt{D_{\\mathrm{Si}}t}) \\int_0^\\infty \\mathrm{erfc}(u) du $$\n互补误差函数的定积分是已知的：$\\int_0^\\infty \\mathrm{erfc}(u) du = \\frac{1}{\\sqrt{\\pi}}$。\n因此，总剂量为：\n$$ Q_{\\mathrm{Si}}(t) = 2 C_s^* \\sqrt{\\frac{D_{\\mathrm{Si}}t}{\\pi}} $$\n现在，我们代入数值：\n-   $C_s^* = k_{\\mathrm{seg}} C_g = 0.30 \\times (1.00 \\times 10^{21} \\,\\mathrm{cm^{-3}}) = 3.00 \\times 10^{20} \\,\\mathrm{cm^{-3}}$\n-   $D_{\\mathrm{Si}} = 3.00 \\times 10^{-13} \\,\\mathrm{cm^2\\,s^{-1}}$\n-   $t = 1800 \\,\\mathrm{s}$\n\n$$ Q_{\\mathrm{Si}}(1800\\,\\mathrm{s}) = 2 \\times (3.00 \\times 10^{20}) \\times \\sqrt{\\frac{(3.00 \\times 10^{-13}) \\times 1800}{\\pi}} $$\n$$ Q_{\\mathrm{Si}}(1800\\,\\mathrm{s}) = 6.00 \\times 10^{20} \\times \\sqrt{\\frac{5.40 \\times 10^{-10}}{\\pi}} $$\n$$ Q_{\\mathrm{Si}}(1800\\,\\mathrm{s}) = 6.00 \\times 10^{20} \\times \\sqrt{1.71887... \\times 10^{-10}} $$\n$$ Q_{\\mathrm{Si}}(1800\\,\\mathrm{s}) = 6.00 \\times 10^{20} \\times 1.31105... \\times 10^{-5} $$\n$$ Q_{\\mathrm{Si}}(1800\\,\\mathrm{s}) = 7.8663... \\times 10^{15} \\,\\mathrm{cm^{-2}} $$\n将结果四舍五入到三位有效数字，我们得到 $7.87 \\times 10^{15} \\,\\mathrm{cm^{-2}}$。",
            "answer": "$$\\boxed{7.87 \\times 10^{15}}$$"
        },
        {
            "introduction": "虽然解析解很强大，但大多数具有复杂几何或非线性效应的实际扩散问题都需要数值求解器。本练习将深入计算建模的核心，指导你不仅去实现一个一维扩散方程的数值求解器，而且（更关键的是）去严格地验证它 。通过将求解器的输出与已知的解析解（格林函数）进行比较，并进行网格加密研究，你将掌握代码验证与确认这一不可或缺的计算科学技能。",
            "id": "4126174",
            "problem": "您的任务是验证一个用于一维菲克扩散的数值求解器，该求解器适用于高温处理过程中的半导体掺杂剂再分布。其控制物理原理是在晶体固体中具有恒定扩散系数的菲克扩散，适用于均匀热条件下硅中的各向同性掺杂剂扩散。目标是在有效无界域上，对于足够短的时间，证明（数值解）与已知的格林函数基准在定量上一致，并通过网格加密研究确定收敛率。\n\n从符合背景的基本原理出发：\n- 菲克第一定律指出，扩散通量为 $J(x,t) = -D \\, \\partial C/\\partial x$，其中 $C(x,t)$ 是掺杂剂浓度，$x$ 是一维空间坐标，$t$ 是时间，$D$ 是恒定的扩散系数。\n- 控制体积内的质量守恒意味着 $\\partial C/\\partial t = -\\partial J/\\partial x$，当 $D$ 为常数时，将其与菲克定律结合，得到扩散方程 $\\partial C/\\partial t = D \\, \\partial^{2} C/\\partial x^{2}$。\n\n所使用的解析基准是在 $t=0$ 时刻、$x=0$ 位置处，总质量为 $M$ 的瞬时点源（狄拉克δ函数）在扩散方程下的自由空间格林函数解，当 $t>0$ 时，其表达式为\n$$\nC_{\\mathrm{exact}}(x,t) = \\frac{M}{\\sqrt{4 \\pi D t}} \\, \\exp\\!\\left(-\\frac{x^{2}}{4 D t}\\right).\n$$\n\n为执行科学上可靠且自洽的验证，请使用基于 Crank-Nicolson 方法的二阶精度隐式时间步进格式和二阶中心有限差分空间离散化，实现一个一维数值求解器。通过在有限区间 $[-L, L]$ 上求解并施加齐次狄利克雷边界条件 $C(-L,t)=0$ 和 $C(L,t)=0$ 来模拟有效无界域，并将比较限制在时间较短的情况下，此时高斯宽度远小于 $L$，使得边界影响可以忽略不计。通过将质量沉积在最接近 $x=0$ 的网格点上，其值为 $C(x=0,0) = M/\\Delta x$，来表示点源初始条件，确保离散积分近似于总质量 $M$。\n\n将时刻 $t$ 的离散相对 $\\ell^{2}$ 误差定义为\n$$\nE_{\\ell^{2}}(t) = \\frac{\\left\\|C_{\\mathrm{num}}(\\cdot,t) - C_{\\mathrm{exact}}(\\cdot,t)\\right\\|_{\\ell^{2},\\Delta x}}{\\left\\|C_{\\mathrm{exact}}(\\cdot,t)\\right\\|_{\\ell^{2},\\Delta x}},\n\\quad\n\\left\\|f\\right\\|_{\\ell^{2},\\Delta x} = \\sqrt{\\sum_{i} f(x_{i})^{2} \\, \\Delta x},\n$$\n其中 $\\{x_{i}\\}$ 是网格点，$\\Delta x$ 是均匀的网格间距。\n\n通过网格加密研究，使用以下公式估算两个分别具有网格间距 $\\Delta x_{1}$ 和 $\\Delta x_{2}$ 的网格之间的观测收敛率 $p$\n$$\np = \\frac{\\log\\!\\left(E_{\\ell^{2}}(\\Delta x_{1}) / E_{\\ell^{2}}(\\Delta x_{2})\\right)}{\\log\\!\\left(\\Delta x_{1} / \\Delta x_{2}\\right)}.\n$$\n\n使用以下适用于硅中掺杂剂扩散的科学合理参数：\n- 扩散系数：$D = 1.0 \\times 10^{-13} \\ \\mathrm{m^{2}/s}$。\n- 域半长：$L = 1.0 \\times 10^{-3} \\ \\mathrm{m}$。\n- 点源总质量：$M = 1.0$，单位为浓度乘以长度（因此在一维公式中，$C$ 的单位与 $\\mathrm{m}^{-1}$ 一致）。\n- 评估时间：$t \\in \\{5000 \\ \\mathrm{s}, 20000 \\ \\mathrm{s}\\}$。\n- 网格尺寸：$N \\in \\{201, 401, 801\\}$，为在 $[-L, L]$ 上均匀分布的点，其选择应使 $x=0$ 与一个网格点对齐。\n- 时间步长控制：对于每个网格，通过 $\\Delta t_{\\text{nom}} = \\beta \\frac{\\Delta x^2}{D}$ 设置一个名义步长，其中 $\\beta = 0.25$ (无量纲)。为确保恰好在目标时间 $t$ 结束，设置整数步数 $n = \\text{round}(t/\\Delta t_{\\text{nom}})$，然后使用 $\\Delta t = t/n$进行时间步进。这使得 $\\Delta t$ 与 $\\Delta x^{2}$ 成正比，同时使最终时间与 $t$ 完全重合。\n\n测试套件与覆盖范围：\n- 对每个 $t \\in \\{5000 \\ \\mathrm{s}, 20000 \\ \\mathrm{s}\\}$ 和每个 $N \\in \\{201, 401, 801\\}$，计算 $E_{\\ell^{2}}(t)$。\n- 对每个 $t$，计算两个观测收敛率：一个在 $N=201$ 和 $N=401$ 之间（使用它们各自的 $\\Delta x$ 和误差），另一个在 $N=401$ 和 $N=801$ 之间。\n- 作为一项额外的物理诊断，在 $t=5000 \\ \\mathrm{s}$ 时，在最精细的网格 $N=801$ 上，计算离散总质量 $M_{\\mathrm{num}} = \\sum_{i} C_{\\mathrm{num}}(x_{i},t) \\, \\Delta x$，并输出一个布尔值，指示 $|M_{\\mathrm{num}} - M|/M \\leq 1.0 \\times 10^{-6}$ 是否成立。这用于检查在此短时间和大域上，数值解是否遵循了自由空间解所预期的近似质量守恒。\n\n不涉及角度单位。请按上文规定，以指定单位表示任何物理量。最终输出为无量纲浮点数（观测收敛率）和用于质量诊断的布尔值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。请按顺序输出：\n- 在 $t=5000 \\ \\mathrm{s}$ 时，$N=201$ 和 $N=401$ 之间的观测收敛率。\n- 在 $t=5000 \\ \\mathrm{s}$ 时，$N=401$ 和 $N=801$ 之间的观测收敛率。\n- 在 $t=20000 \\ \\mathrm{s}$ 时，$N=201$ 和 $N=401$ 之间的观测收敛率。\n- 在 $t=20000 \\ \\mathrm{s}$ 时，$N=401$ 和 $N=801$ 之间的观测收敛率。\n- 在 $t=5000 \\ \\mathrm{s}$ 时，对 $N=801$ 定义的布尔值质量诊断，由上述阈值确定。\n\n例如，输出格式必须严格符合 $[r_{1},r_{2},r_{3},r_{4},b]$ 的形式，其中 $r_{i}$ 是浮点数，$b$ 是布尔值。",
            "solution": "该问题已经过验证，并被确定为有效。这是一个在应用于半导体工艺建模的计算物理学领域中，具有科学依据、适定且客观的问题。所有必需的参数和条件都已提供，该任务是一项标准的、非平凡的数值验证练习。\n\n该问题要求实现并验证一个用于一维菲克扩散方程的数值求解器，该方程控制着固体中掺杂剂浓度 $C(x,t)$ 随时间 $t$ 和空间 $x$ 的再分布。其控制性偏微分方程（PDE）为：\n$$\n\\frac{\\partial C}{\\partial t} = D \\frac{\\partial^{2} C}{\\partial x^{2}}\n$$\n其中 $D$ 是恒定的掺杂剂扩散系数。此方程由菲克第一定律 $J(x,t) = -D \\, \\partial C/\\partial x$（该定律将扩散通量 $J$ 与浓度梯度关联起来）与质量守恒原理 $\\partial C/\\partial t = -\\partial J/\\partial x$ 结合而成。\n\n数值解将使用 Crank-Nicolson 方法开发，这是一种非常适合如扩散方程这类抛物线型偏微分方程的有限差分格式。选择此方法是因为它在时间和空间上都具有二阶精度，并且是无条件数值稳定的。\n\n设空间域 $[-L, L]$ 被离散化为 $N$ 个均匀分布的点 $\\{x_i\\}$，间距为 $\\Delta x = 2L/(N-1)$，时间被离散化为大小为 $\\Delta t$ 的步长。设 $C_i^n$ 表示在网格点 $x_i$ 和时间 $t_n = n\\Delta t$ 时浓度 $C(x_i, t_n)$ 的数值近似。\n\nCrank-Nicolson 格式是通过将有限差分近似置于半时间步 $t_{n+1/2} = t_n + \\Delta t/2$ 的中心来推导的。时间导数通过关于 $t_{n+1/2}$ 的中心差分来近似，而空间导数则通过 $t_n$ 和 $t_{n+1}$ 时刻中心差분의平均值来近似：\n$$\n\\frac{C_i^{n+1} - C_i^n}{\\Delta t} = \\frac{D}{2} \\left( \\frac{C_{i-1}^{n+1} - 2C_i^{n+1} + C_{i+1}^{n+1}}{\\Delta x^2} + \\frac{C_{i-1}^n - 2C_i^n + C_{i+1}^n}{\\Delta x^2} \\right)\n$$\n此方程是为内部网格点（即 $i=1, 2, \\dots, N-2$）建立的。定义无量纲参数 $\\alpha = \\frac{D \\Delta t}{2 \\Delta x^2}$，我们可以重新整理方程，将时间步 $n+1$ 的未知浓度（在左手边）与时间步 $n$ 的已知浓度（在右手边）分开：\n$$\n-\\alpha C_{i-1}^{n+1} + (1+2\\alpha)C_i^{n+1} - \\alpha C_{i+1}^{n+1} = \\alpha C_{i-1}^n + (1-2\\alpha)C_i^n + \\alpha C_{i+1}^n\n$$\n问题指定了齐次狄利克雷边界条件，$C(-L,t)=0$ 和 $C(L,t)=0$。在我们的离散框架中，这转化为对所有时间步 $n$，都有 $C_0^n = 0$ 和 $C_{N-1}^n = 0$。\n\n针对内部点的方程集合构成了一个线性系统 $A \\mathbf{C}^{n+1} = B \\mathbf{C}^{n}$，其中 $\\mathbf{C}^n$ 是内部浓度向量 $[C_1^n, \\dots, C_{N-2}^n]^T$。矩阵 $A$ 和 $B$ 是大小为 $(N-2) \\times (N-2)$ 的三对角矩阵。左手边的矩阵 $A$ 的主对角线元素为 $(1+2\\alpha)$，次对角线和超对角线元素为 $-\\alpha$。在每个时间步，我们必须求解形如 $A \\mathbf{u} = \\mathbf{d}$ 的线性系统，其中 $\\mathbf{u} = \\mathbf{C}^{n+1}$ 是未知向量，$\\mathbf{d} = B \\mathbf{C}^{n}$ 是已知的右手边向量。鉴于 $A$ 的三对角结构，该系统可以使用专门的算法（如 Thomas 算法）高效求解，该算法在像 `SciPy` 这样的科学计算库中可用。\n\n初始条件是在 $x=0$ 处总质量为 $M$ 的理想化点源，由狄拉克δ函数 $\\delta(x)$ 表示。出于数值计算的目的，这个奇异源通过将总质量 $M$ 放置在 $x=0$ 处的一个网格单元中进行离散化。由于指定的网格尺寸 $N \\in \\{201, 401, 801\\}$ 均为奇数，对称区间 $[-L, L]$ 上的网格恰好在 $x = 0$ 处有一个点。初始浓度设置为 $C(x_i, 0) = (M/\\Delta x) \\delta_{i, i_0}$，其中 $x_{i_0}=0$，$\\delta_{i,i_0}$ 是克罗内克δ。这确保了离散积分 $\\sum_i C(x_i, 0) \\Delta x = (M/\\Delta x) \\Delta x = M$，从而正确地表示了总质量。\n\n数值解 $C_{\\mathrm{num}}$ 的准确性通过与无限域的解析解进行比较来评估。由于扩散长度 $\\sqrt{2Dt}$ 远小于域尺寸 $L$，该解析解是有效的。精确解为：\n$$\nC_{\\mathrm{exact}}(x,t) = \\frac{M}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{x^2}{4 D t}\\right)\n$$\n比较结果通过离散相对 $\\ell^2$ 误差来量化：\n$$\nE_{\\ell^{2}}(t) = \\frac{\\sqrt{\\sum_{i} (C_{\\mathrm{num}}(x_{i}, t) - C_{\\mathrm{exact}}(x_{i}, t))^2 \\Delta x}}{\\sqrt{\\sum_{i} C_{\\mathrm{exact}}(x_{i}, t)^2 \\Delta x}}\n$$\n收敛率 $p$ 是根据在两个具有不同网格间距 $\\Delta x_1$ 和 $\\Delta x_2$ 的网格上计算出的误差来估算的：\n$$\np = \\frac{\\log(E_{\\ell^2}(\\Delta x_1) / E_{\\ell^2}(\\Delta x_2))}{\\log(\\Delta x_1 / \\Delta x_2)}\n$$\n对于一个二阶精度的格式， $p$ 的期望值约为 $2$。\n\n算法流程如下：\n1. 定义物理参数：扩散系数 $D = 1.0 \\times 10^{-13} \\ \\mathrm{m^2/s}$，域半长 $L = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，以及总质量 $M=1.0$。\n2. 定义计算参数：网格尺寸 $N \\in \\{201, 401, 801\\}$ 和评估时间 $t \\in \\{5000 \\ \\mathrm{s}, 20000 \\ \\mathrm{s}\\}$。\n3. 对于每一对 ($N$, $t$)：\n    a. 设置空间网格并计算 $\\Delta x$。\n    b. 根据稳定性参数 $\\beta = 0.25$ 和需在时刻 $t$ 精确结束的要求，确定时间步长 $\\Delta t$。\n    c. 根据离散点源条件初始化浓度数组 $C$。\n    d. 为 Crank-Nicolson 求解器构建三对角矩阵 $A$。\n    e. 从 $t=0$ 步进到目标时间 $t$，通过重复构建右手边向量并求解三对角系统以获得下一时间步的浓度。\n    f. 通过将最终数值解与精确解析解进行比较，计算相对 $\\ell^2$ 误差 $E_{\\ell^2}$。\n4. 使用计算出的误差，为每个时间 $t$ 计算网格对 ($N=201, 401$) 和 ($N=401, 801$) 之间的观测收敛率。\n5. 对于 $N=801$ 在 $t=5000 \\ \\mathrm{s}$ 的情况，计算数值解中的总质量 $M_{\\mathrm{num}} = \\sum_i C_{\\mathrm{num}}(x_i, t) \\Delta x$，并验证相对质量误差 $|M_{\\mathrm{num}} - M|/M$ 是否在指定的容差 $1.0 \\times 10^{-6}$ 之内。\n6. 整理并按指定格式输出结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef run_simulation(N, t_target, D, L, M):\n    \"\"\"\n    Solves the 1D diffusion equation using the Crank-Nicolson method.\n\n    Args:\n        N (int): Number of grid points.\n        t_target (float): Target simulation time in seconds.\n        D (float): Diffusion coefficient.\n        L (float): Domain half-length.\n        M (float): Total mass of the point source.\n\n    Returns:\n        tuple: (C_final, x, dx) where C_final is the concentration profile,\n               x is the spatial grid, and dx is the grid spacing.\n    \"\"\"\n    # 1. Grid and Time Step Setup\n    dx = 2 * L / (N - 1)\n    x = np.linspace(-L, L, N)\n\n    beta = 0.25\n    dt_nom = beta * dx**2 / D\n    num_steps = int(np.round(t_target / dt_nom))\n    if num_steps == 0:\n        num_steps = 1\n    dt = t_target / num_steps\n\n    # 2. Initial Condition (Discrete Delta Function)\n    C = np.zeros(N)\n    mid_idx = (N - 1) // 2\n    if x[mid_idx] == 0.0:\n        C[mid_idx] = M / dx\n    else:\n        # This case should not be reached with the given odd N values\n        raise ValueError(\"Grid is not centered at x=0\")\n\n    # 3. Crank-Nicolson Matrix Setup\n    alpha = D * dt / (2 * dx**2)\n    num_internal_pts = N - 2\n\n    # The matrix `A` for the LHS is tridiagonal:\n    # diag: 1 + 2*alpha, off-diag: -alpha\n    # We use scipy.linalg.solve_banded which requires a specific format.\n    # ab is a (3, num_internal_pts) array for a tridiagonal matrix.\n    ab = np.zeros((3, num_internal_pts))\n    ab[0, 1:] = -alpha      # Super-diagonal\n    ab[1, :] = 1 + 2 * alpha  # Main diagonal\n    ab[2, :-1] = -alpha     # Sub-diagonal\n\n    # 4. Time Stepping Loop\n    for _ in range(num_steps):\n        # Construct the RHS vector `d = B * C`, where B is the RHS matrix.\n        # d_i = alpha*C_{i-1} + (1-2alpha)*C_i + alpha*C_{i+1} for interior points\n        # Using array slicing for efficiency\n        rhs_vector = (alpha * C[:-2] +\n                      (1 - 2 * alpha) * C[1:-1] +\n                      alpha * C[2:])\n        \n        # Solve the tridiagonal system A*C_next = d\n        # solve_banded expects (l, u) diagonals. (1,1) for tridiagonal.\n        C_next_interior = solve_banded((1, 1), ab, rhs_vector)\n        \n        # Update the concentration array for the next step\n        C[1:-1] = C_next_interior\n        # Boundary conditions C[0] and C[-1] remain 0, as they are not updated.\n\n    return C, x, dx\n\ndef calculate_l2_error(C_num, C_exact, dx):\n    \"\"\"Calculates the discrete relative l2 error.\"\"\"\n    norm_diff_sq = np.sum((C_num - C_exact)**2 * dx)\n    norm_exact_sq = np.sum(C_exact**2 * dx)\n    \n    if norm_exact_sq == 0:\n        return 0.0 if norm_diff_sq == 0.0 else np.inf\n        \n    return np.sqrt(norm_diff_sq / norm_exact_sq)\n\ndef solve():\n    \"\"\"\n    Main function to run the validation suite and produce the final output.\n    \"\"\"\n    # Scientific Parameters\n    D = 1.0e-13  # m^2/s\n    L = 1.0e-3   # m\n    M = 1.0      # units of concentration * length\n\n    # Test Suite Parameters\n    times_to_eval = [5000.0, 20000.0]\n    grid_sizes = [201, 401, 801]\n    \n    all_errors = {}  # {time: {N: error}}\n\n    # --- Part 1: Calculate errors for all configurations ---\n    for t in times_to_eval:\n        all_errors[t] = {}\n        for N in grid_sizes:\n            C_num, x, dx = run_simulation(N, t, D, L, M)\n            \n            # Avoid division by zero in the exact solution formula at t=0.\n            # However, problem specifies t > 0.\n            if t > 0:\n                C_exact = (M / np.sqrt(4 * np.pi * D * t)) * \\\n                          np.exp(-x**2 / (4 * D * t))\n            else:\n                C_exact = np.zeros_like(x)\n                mid_idx = (len(x) - 1) // 2\n                C_exact[mid_idx] = np.inf # Heuristic representation\n\n            error = calculate_l2_error(C_num, C_exact, dx)\n            all_errors[t][N] = error\n\n    final_results = []\n    \n    # --- Part 2: Calculate convergence rates ---\n    for t in times_to_eval:\n        # Rate for (N=201 -> N=401)\n        N1, N2 = 201, 401\n        dx1 = 2 * L / (N1 - 1)\n        dx2 = 2 * L / (N2 - 1)\n        e1 = all_errors[t][N1]\n        e2 = all_errors[t][N2]\n        rate1 = np.log(e1 / e2) / np.log(dx1 / dx2)\n        final_results.append(rate1)\n\n        # Rate for (N=401 -> N=801)\n        N1, N2 = 401, 801\n        dx1 = 2 * L / (N1 - 1)\n        dx2 = 2 * L / (N2 - 1)\n        e1 = all_errors[t][N1]\n        e2 = all_errors[t][N2]\n        rate2 = np.log(e1 / e2) / np.log(dx1 / dx2)\n        final_results.append(rate2)\n        \n    # --- Part 3: Perform mass conservation check ---\n    t_mass_check = 5000.0\n    N_mass_check = 801\n    C_num_mass, _, dx_mass = run_simulation(N_mass_check, t_mass_check, D, L, M)\n    \n    M_num = np.sum(C_num_mass) * dx_mass\n    mass_conservation_check = (np.abs(M_num - M) / M) = 1.0e-6\n    final_results.append(mass_conservation_check)\n    \n    # --- Final Output ---\n    # Convert booleans to strings (\"True\" or \"False\") and floats to strings\n    output_str = [f\"{val:.15f}\" if isinstance(val, float) else str(val) for val in final_results]\n    print(f\"[{','.join(output_str)}]\")\n\nsolve()\n```"
        }
    ]
}