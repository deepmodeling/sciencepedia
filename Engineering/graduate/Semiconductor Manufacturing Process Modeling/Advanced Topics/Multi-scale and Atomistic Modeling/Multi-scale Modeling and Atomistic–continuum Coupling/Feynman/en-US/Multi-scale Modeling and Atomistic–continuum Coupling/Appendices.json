{
    "hands_on_practices": [
        {
            "introduction": "A central challenge in atomistic-continuum coupling is defining the boundary of the atomistic region to accurately represent its embedding within a larger material. This practice explores this fundamental issue by comparing the elastic response of a simple one-dimensional atomic chain under Periodic Boundary Conditions (PBC) versus open boundaries. By deriving the measured elastic modulus in both cases, you will gain a quantitative understanding of the finite-size errors introduced by boundary artifacts and appreciate why PBC is the standard for simulating a small patch of a bulk material .",
            "id": "4144074",
            "problem": "Consider an atomistic–continuum (A–C) coupled model of a homogeneous crystalline material undergoing a spatially uniform small-strain deformation. The atomistic subdomain is embedded deep inside the continuum region, which is well-approximated as infinite. To eliminate artificial surface artifacts at the atomistic boundary and to mimic being inside an infinite medium, the atomistic subdomain is often simulated with Periodic Boundary Conditions (PBC). In this problem, you will justify the use of Periodic Boundary Conditions (PBC) in the atomistic subdomain by deriving the measured elastic response under uniform strain and quantifying the finite-size effect due to domain size when PBC is not used.\n\nStart from a one-dimensional discrete atomistic representation of the continuum bar, consisting of $N$ atoms equally spaced by $a$ in the reference configuration, with nearest-neighbor harmonic interactions of stiffness $k$ (units: $\\mathrm{N/m}$). Let the macroscopic continuum impose a uniform small strain $\\epsilon$ on the atomistic region. The atomistic energy is the sum of quadratic pairwise spring energies for each bond that experiences an elongation of $a\\,\\epsilon$. The total reference length of the atomistic domain is $L = N a$ (units: $\\mathrm{m}$). Assume linear response and neglect anharmonic effects.\n\nFrom fundamental principles of linear elasticity and harmonic interactions, derive the one-dimensional measured modulus $E_{1\\mathrm{D}}$ (units: $\\mathrm{N}$) defined by the relation\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon},\n$$\nwhere $E_\\mathrm{total}$ is the total atomistic energy under the imposed uniform strain $\\epsilon$. Show that:\n- Under Periodic Boundary Conditions (PBC), the number of bonds is equal to $N$, and the measured modulus $E_{1\\mathrm{D}}^\\mathrm{PBC}$ is independent of $N$.\n- Under open boundaries (e.g., non-periodic with no neighbor beyond the endpoints), the number of bonds is equal to $N-1$, leading to a finite-size correction in the measured modulus $E_{1\\mathrm{D}}^\\mathrm{open}(N)$.\n\nUsing these results, quantify the effect of domain size on the measured property by the dimensionless bias\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^\\mathrm{open}(N) - E_{1\\mathrm{D}}^\\mathrm{PBC}}{E_{1\\mathrm{D}}^\\mathrm{PBC}}.\n$$\n\nYou must implement a complete, runnable program that, for the test suite below, computes $b(N)$ for each case. The final output must be a single line containing a comma-separated list of the biases, enclosed in square brackets. The output must be dimensionless decimal fractions (no percentage sign), and no other text should be printed.\n\nTest Suite (each tuple lists $(N, a, k)$ in the specified units; $a$ in $\\mathrm{m}$, $k$ in $\\mathrm{N/m}$):\n- Case $1$: $(N, a, k) = (1000, 5.0\\times 10^{-10}, 50)$.\n- Case $2$: $(N, a, k) = (10, 2.5\\times 10^{-10}, 75)$.\n- Case $3$: $(N, a, k) = (2, 1.0\\times 10^{-9}, 100)$.\n- Case $4$: $(N, a, k) = (50, 3.0\\times 10^{-10}, 60)$.\n\nYour program should produce a single line of output containing the biases for Cases $1$ through $4$ in order, as a comma-separated list enclosed in square brackets (for example, $[b_1,b_2,b_3,b_4]$). Since the requested outputs are dimensionless, no physical units are required in the output.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of solid-state physics and linear elasticity, using a standard harmonic approximation for interatomic forces. The problem is well-posed, with all necessary parameters and definitions provided to derive a unique and meaningful solution. It is objective and directly relevant to the study of finite-size effects in multi-scale simulations. We will proceed with the derivation.\n\nThe objective is to derive the one-dimensional measured elastic modulus, $E_{1\\mathrm{D}}$, for a discrete chain of atoms under two different boundary conditions: Periodic Boundary Conditions (PBC) and open boundaries. We will then use these results to calculate the dimensionless bias $b(N)$, which quantifies the finite-size error introduced by using open boundaries instead of PBC.\n\nThe fundamental energy of a single harmonic bond (a spring) with stiffness $k$ displaced by an amount $\\Delta x$ from its equilibrium length is given by $U_{\\mathrm{bond}} = \\frac{1}{2}k(\\Delta x)^2$. The problem states that the system is subjected to a uniform small strain $\\epsilon$. In a chain of atoms with initial spacing $a$, the elongation of each bond is $\\Delta x = a \\epsilon$. Therefore, the energy stored in each individual bond is:\n$$\nU_{\\mathrm{bond}} = \\frac{1}{2}k(a\\epsilon)^2 = \\frac{1}{2}ka^2\\epsilon^2\n$$\nThe total potential energy of the atomistic domain, $E_{\\mathrm{total}}$, is the sum of the energies of all bonds.\n\nThe one-dimensional measured modulus $E_{1\\mathrm{D}}$ is defined by the relation:\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon}\n$$\nwhere $L = Na$ is the total reference length of the domain.\n\nWe analyze the two cases separately.\n\n**Case 1: Periodic Boundary Conditions (PBC)**\nUnder PBC, the one-dimensional chain of $N$ atoms is treated as a closed ring, where atom $N$ is bonded to atom $1$. Consequently, every atom has exactly two neighbors, and the total number of bonds in the system is equal to the number of atoms, $N$.\n\nThe total energy $E_{\\mathrm{total}}^{\\mathrm{PBC}}$ is the energy per bond multiplied by the number of bonds:\n$$\nE_{\\mathrm{total}}^{\\mathrm{PBC}} = N \\cdot U_{\\mathrm{bond}} = N \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}Nka^2\\epsilon^2\n$$\nNext, we compute the derivative of the total energy with respect to strain $\\epsilon$:\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{PBC}}}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}Nka^2\\epsilon^2\\right) = Nka^2\\epsilon\n$$\nNow, we substitute this result into the definition for the measured modulus $E_{1\\mathrm{D}}^{\\mathrm{PBC}}$. The total reference length is $L = Na$:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{1}{Na} \\left(Nka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\nSimplifying the expression, we find:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{Nka^2\\epsilon}{Na\\epsilon} = ka\n$$\nThe measured modulus under PBC, $E_{1\\mathrm{D}}^{\\mathrm{PBC}} = ka$, is independent of the number of atoms $N$. This result represents the intrinsic modulus of the infinite material, which is the goal of using PBC in simulations of bulk materials. The units are correct: $[k] \\cdot [a] = (\\mathrm{N/m}) \\cdot \\mathrm{m} = \\mathrm{N}$, which are the specified units for $E_{1\\mathrm{D}}$.\n\n**Case 2: Open Boundaries**\nUnder open boundaries, the atoms at the ends of the chain (atom $1$ and atom $N$) are \"free\" and have only one neighbor each. The remaining $N-2$ interior atoms each have two neighbors. The total number of bonds in this linear chain is $N-1$.\n\nThe total energy $E_{\\mathrm{total}}^{\\mathrm{open}}$ is:\n$$\nE_{\\mathrm{total}}^{\\mathrm{open}}(N) = (N-1) \\cdot U_{\\mathrm{bond}} = (N-1) \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}(N-1)ka^2\\epsilon^2\n$$\nWe compute the derivative with respect to $\\epsilon$:\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{open}}(N)}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}(N-1)ka^2\\epsilon^2\\right) = (N-1)ka^2\\epsilon\n$$\nWe substitute this into the definition for the modulus $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$. The reference length of the domain is still $L=Na$, as the modulus is normalized by the total size of the atomistic region being represented.\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{1}{Na} \\left((N-1)ka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\nSimplifying yields:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{(N-1)ka^2\\epsilon}{Na\\epsilon} = \\frac{N-1}{N} ka = \\left(1 - \\frac{1}{N}\\right)ka\n$$\nThis result shows that the measured modulus for the open-boundary case, $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$, depends on the system size $N$. This deviation from the intrinsic value $ka$ is a finite-size effect, arising from the \"missing\" bond at the boundary relative to the bulk. As $N \\to \\infty$, $E_{1\\mathrm{D}}^{\\mathrm{open}}(N) \\to ka$, converging to the bulk value as expected.\n\n**Quantification of the Bias**\nThe dimensionless bias $b(N)$ is defined as the relative difference between the modulus measured with open boundaries and the modulus measured with PBC:\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^{\\mathrm{open}}(N) - E_{1\\mathrm{D}}^{\\mathrm{PBC}}}{E_{1\\mathrm{D}}^{\\mathrm{PBC}}}\n$$\nSubstituting the expressions we derived:\n$$\nb(N) = \\frac{\\left(1 - \\frac{1}{N}\\right)ka - ka}{ka}\n$$\nThe term $ka$ is a common factor and cancels out, revealing that the bias is independent of the material parameters $a$ and $k$. It depends only on the number of atoms $N$.\n$$\nb(N) = \\frac{ka\\left(\\left(1 - \\frac{1}{N}\\right) - 1\\right)}{ka} = \\left(1 - \\frac{1}{N}\\right) - 1 = -\\frac{1}{N}\n$$\nThe bias is simply $b(N) = -1/N$. The negative sign indicates that the finite chain with open boundaries appears softer (has a lower measured modulus) than the bulk material represented by the PBC case. This is because there is one fewer bond for the same number of atoms and domain length definition.\n\nFor the given test cases, we calculate $b(N)$ using this formula.\n- Case $1$: $N=1000$. $b(1000) = -1/1000 = -0.001$.\n- Case $2$: $N=10$. $b(10) = -1/10 = -0.1$.\n- Case $3$: $N=2$. $b(2) = -1/2 = -0.5$.\n- Case $4$: $N=50$. $b(50) = -1/50 = -0.02$.\nThe provided parameters $a$ and $k$ are not required for the final calculation of the bias, but they are essential for defining a physically complete problem from which the general result is derived.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless bias b(N) for a 1D atomistic chain,\n    representing the finite-size error in the measured elastic modulus\n    when using open boundaries instead of periodic boundary conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (N, a, k), where:\n    # N is the number of atoms (dimensionless)\n    # a is the interatomic spacing (m)\n    # k is the spring stiffness (N/m)\n    test_cases = [\n        (1000, 5.0e-10, 50),  # Case 1\n        (10, 2.5e-10, 75),    # Case 2\n        (2, 1.0e-9, 100),   # Case 3\n        (50, 3.0e-10, 60),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, k = case\n        \n        # From the derivation, the measured modulus under Periodic Boundary\n        # Conditions (PBC) is E_pbc = k * a.\n        # This represents the true bulk modulus.\n\n        # The measured modulus under open boundaries (free ends) is\n        # E_open = ((N - 1) / N) * k * a.\n        # This shows a finite-size dependency.\n        \n        # The dimensionless bias b(N) is defined as:\n        # b(N) = (E_open(N) - E_pbc) / E_pbc\n        # Substituting the expressions:\n        # b(N) = ( ((N - 1) / N) * k * a - k * a ) / (k * a)\n        # The 'k * a' term cancels out, leaving:\n        # b(N) = ((N - 1) / N) - 1\n        # b(N) = (N - 1 - N) / N\n        # b(N) = -1 / N\n        #\n        # Therefore, the bias depends only on N, the number of atoms.\n        \n        bias = -1.0 / N\n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of dimensionless decimal fractions.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A key goal of multi-scale modeling is to compute macroscopic material properties, like diffusion coefficients, from first-principles atomistic simulations. This exercise simulates this workflow by using the Einstein relation to extract a self-diffusion coefficient from synthetic molecular dynamics trajectories. You will not only implement the analysis of the mean squared displacement but also apply a crucial finite-size correction, derived from continuum elasticity theory, to extrapolate your result from a small, periodic simulation cell to the infinite-system limit .",
            "id": "4143999",
            "problem": "A silicon self-diffusion calculation in semiconductor manufacturing process modeling requires connecting atomistic Molecular Dynamics (MD) estimates to continuum-scale parameters. Consider equilibrium MD for crystalline silicon at temperature $T = 1200\\,\\mathrm{K}$ and a cubic periodic simulation cell of edge length $L$. The self-diffusion coefficient $D$ is defined via the Einstein relation for a tagged silicon atom, \n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{6t} \\left\\langle \\left\\lvert \\mathbf{r}(t) - \\mathbf{r}(0) \\right\\rvert^2 \\right\\rangle \\right.,\n$$\nwhere $\\left\\langle \\cdot \\right\\rangle$ denotes an ensemble average, and $\\mathbf{r}(t)$ is the unwrapped position (tracking boundary crossings) of the tagged atom at time $t$.\n\nIn crystalline solids, self-diffusion is vacancy-mediated and follows an Arrhenius form, \n$$\nD_\\infty(T) \\;\\propto\\; \\exp\\!\\left(-\\frac{E_f + E_m}{k_\\mathrm{B} T}\\right),\n$$\nwhere $E_f$ is the defect formation energy, $E_m$ is the defect migration energy, $k_\\mathrm{B}$ is the Boltzmann constant, and $D_\\infty(T)$ denotes the diffusion coefficient in the infinite-system limit. In a finite periodic cell, elastic interactions between periodic images modify the formation energy by a size-dependent term $\\Delta E_f(L) \\approx A/L^3$ for sufficiently large $L$, where $A$ is a material-specific positive constant encapsulating the elastic dipole and host elastic moduli. This yields a finite-size diffusion coefficient\n$$\nD_L(T) \\;\\approx\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{\\Delta E_f(L)}{k_\\mathrm{B} T}\\right) \\;=\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\nYour task is to implement a program that:\n1. Generates synthetic equilibrium MD trajectories for $M$ independent tagged silicon atoms undergoing a diffusive random walk consistent with a prescribed finite-size diffusion coefficient $D_L$ at $T = 1200\\,\\mathrm{K}$. Use a time step $\\Delta t$, total simulation time $t_\\mathrm{tot}$, and cubic periodic boundary conditions of edge length $L$; use unwrapped positions to compute displacements. The per-dimension increment should be a Gaussian with zero mean and variance $2 D_L \\Delta t$, consistent with the continuum limit of the Langevin equation.\n2. Computes the mean squared displacement (Mean Squared Displacement (MSD)) \n$$\n\\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n$$\nat evenly spaced times $t_i = i\\,\\Delta t$ for $i=1,2,\\ldots,N$ with $N = t_\\mathrm{tot}/\\Delta t$.\n3. Estimates $D_L$ by performing a least-squares linear fit of $\\mathrm{MSD}(t)$ versus $t$ over the long-time diffusive regime (exclude the initial ballistic regime by discarding the first fraction $f_\\mathrm{cut}$ of the time samples). If the fitted line is $\\mathrm{MSD}(t) \\approx a\\,t + b$, then report $D_L^\\mathrm{est} = a/6$.\n4. Applies the elastic-continuum finite-size correction to estimate $D_\\infty$ via inversion of the above relation:\n$$\nD_\\infty^\\mathrm{est} \\;=\\; D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\nUse the following constants and units:\n- Boltzmann constant $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$,\n- Express all diffusion coefficients in $\\mathrm{m}^2/\\mathrm{s}$,\n- Express lengths $L$ in $\\mathrm{nm}$ in the input parameter specification but convert to $\\mathrm{m}$ internally for trajectory generation; use $L^3$ in $\\mathrm{nm}^3$ for the elastic correction as stated,\n- The parameter $A$ is provided in $\\mathrm{eV}\\cdot\\mathrm{nm}^3$; convert to $\\mathrm{J}\\cdot\\mathrm{nm}^3$ using $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$.\n\nTo ensure scientific realism and testability, assume that the underlying infinite-system diffusion coefficient at $T = 1200\\,\\mathrm{K}$ is $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$. For a given test case, let $D_L^\\mathrm{true} = D_\\infty^\\mathrm{true}\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)$ be the true finite-size diffusion coefficient used to generate synthetic trajectories.\n\nImplement the program to run the following test suite (each test case is a tuple of parameters $(L, A, M, \\Delta t, t_\\mathrm{tot}, f_\\mathrm{cut})$):\n- Test case $1$: $(L = 5.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- Test case $2$: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- Test case $3$: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.0\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$.\n\nYour program should:\n- For each test case, generate synthetic trajectories using $D_L^\\mathrm{true}$ as described,\n- Estimate $D_L^\\mathrm{est}$ by linear regression of $\\mathrm{MSD}(t)$ on $t$ over the long-time window defined by $f_\\mathrm{cut}$,\n- Compute the corrected estimate $D_\\infty^\\mathrm{est}$ using the elastic-continuum finite-size correction,\n- Output a single line containing a comma-separated list enclosed in square brackets with the three corrected estimates in $\\mathrm{m}^2/\\mathrm{s}$, ordered by the test cases listed above. For example, the output format must be exactly of the form $[\\text{result1},\\text{result2},\\text{result3}]$, where each result is a floating-point number.\n\nAnswer all diffusion coefficients in $\\mathrm{m}^2/\\mathrm{s}$ as plain decimal floats (not scientific notation strings), with no units in the printed output line and no additional text.",
            "solution": "The problem presents a valid and well-posed computational task in the field of multi-scale modeling for semiconductor processes. It is scientifically grounded in the principles of statistical mechanics and continuum elasticity, and all required parameters and procedures are specified unambiguously. The objective is to write a program that simulates a diffusive process in a finite-sized system, analyzes the resulting synthetic data to estimate a transport coefficient, and then applies a continuum-theory-based correction to extrapolate this estimate to the infinite-system limit. This procedure mirrors a common workflow in computational materials science for correcting finite-size effects in atomistic simulations.\n\nThe solution proceeds by implementing the four specified steps for each test case.\n\n1.  **Calculation of the Synthetic Data Generation Parameter $D_L^\\mathrm{true}$**\n    The foundation of this problem is the relationship between the diffusion coefficient in a finite periodic cell of size $L$, denoted $D_L(T)$, and its infinite-system counterpart, $D_\\infty(T)$:\n    $$\n    D_L(T) \\approx D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    Here, $T = 1200\\,\\mathrm{K}$ is the temperature, $k_\\mathrm{B}$ is the Boltzmann constant, and $A$ is a parameter related to elastic interactions. The problem provides the \"true\" infinite-system value, $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$, which we use to define the diffusion coefficient for our synthetic trajectory generation, $D_L^\\mathrm{true}$. The exponential term's argument, $\\frac{A}{k_\\mathrm{B} T\\,L^3}$, must be dimensionless. Given the units of the inputs ($A$ in $\\mathrm{eV}\\cdot\\mathrm{nm}^3$, $L$ in $\\mathrm{nm}$, $k_\\mathrm{B}$ in $\\mathrm{J/K}$, and $T$ in $\\mathrm{K}$), we first convert $A$ to units of $\\mathrm{J}\\cdot\\mathrm{nm}^3$ using the conversion factor $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$. The argument then becomes:\n    $$\n    \\frac{A\\;[\\mathrm{eV}\\cdot\\mathrm{nm}^3] \\times (1.602176634\\times 10^{-19}\\;\\mathrm{J/eV})}{k_\\mathrm{B}\\;[\\mathrm{J/K}] \\times T\\;[\\mathrm{K}] \\times (L\\;[\\mathrm{nm}])^3}\n    $$\n    The units correctly cancel, yielding a dimensionless quantity. $D_L^\\mathrm{true}$ is then calculated and used in the next step.\n\n2.  **Synthetic Trajectory Generation**\n    The motion of a diffusing particle is modeled as a 3D random walk. The trajectory of each of the $M$ particles is simulated over $N = t_\\mathrm{tot}/\\Delta t$ time steps. For each dimension ($x, y, z$) and each time step $\\Delta t$, the displacement is drawn from a Gaussian (normal) distribution with a mean of $0$ and a variance of $2 D_L^\\mathrm{true} \\Delta t$. The standard deviation for each displacement component is therefore $\\sigma = \\sqrt{2 D_L^\\mathrm{true} \\Delta t}$. The total \"unwrapped\" displacement of a particle from its origin at time $t_i = i\\,\\Delta t$ is the cumulative sum of the individual random displacements up to that step.\n\n3.  **Mean Squared Displacement (MSD) Analysis and Estimation of $D_L^\\mathrm{est}$**\n    From the generated trajectories, we calculate the Mean Squared Displacement (MSD) as a function of time. The MSD at time $t_i$ is given by averaging the squared displacement magnitudes over the ensemble of $M$ particles:\n    $$\n    \\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n    $$\n    According to the Einstein relation for 3D diffusion, the MSD is linearly proportional to time in the diffusive regime:\n    $$\n    \\mathrm{MSD}(t) = 6 D t\n    $$\n    We estimate the finite-size diffusion coefficient, $D_L^\\mathrm{est}$, by performing a linear least-squares fit to the computed MSD data, $\\mathrm{MSD}(t) = a\\,t + b$. The problem specifies that the fit should exclude the initial fraction $f_\\mathrm{cut}$ of time samples to mimic the analysis of real simulation data where a non-diffusive ballistic regime may exist. The slope $a$ of the fitted line gives the estimate for the diffusion coefficient:\n    $$\n    D_L^\\mathrm{est} = \\frac{a}{6}\n    $$\n\n4.  **Finite-Size Correction and Estimation of $D_\\infty^\\mathrm{est}$**\n    The final step is to recover an estimate for the infinite-system diffusion coefficient, $D_\\infty^\\mathrm{est}$, by inverting the finite-size correction formula. Using the estimated $D_L^\\mathrm{est}$ from the previous step, we have:\n    $$\n    D_\\infty^\\mathrm{est} = D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    The exponential term is the inverse of the correction factor applied in step 1. Because the synthetic data was generated from $D_L^\\mathrm{true}$ and the analysis involves statistical sampling and fitting, $D_\\infty^\\mathrm{est}$ will be an estimate of, but not exactly identical to, the original $D_\\infty^\\mathrm{true}$. The quality of this estimate validates the entire analysis pipeline. This procedure is executed for each of the three provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the infinite-system self-diffusion coefficient\n    of silicon by generating and analyzing synthetic molecular dynamics trajectories.\n    \"\"\"\n    # Define physical and conversion constants as specified\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    EV_TO_J = 1.602176634e-19  # Conversion factor from eV to Joules\n    \n    # Define problem-specific parameters\n    T_K = 1200.0  # Temperature in Kelvin\n    D_INF_TRUE = 1.0e-18  # True infinite-system diffusion coefficient in m^2/s\n\n    # Each test case is a tuple: (L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut)\n    test_cases = [\n        (5.0, 0.6, 800, 5.0e-7, 0.003, 0.2),   # Test case 1\n        (10.0, 0.6, 800, 5.0e-7, 0.003, 0.2),  # Test case 2\n        (10.0, 0.0, 800, 5.0e-7, 0.003, 0.2),  # Test case 3\n    ]\n\n    results = []\n    \n    # Set a random seed for reproducible results\n    np.random.seed(42)\n\n    for case in test_cases:\n        L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut = case\n\n        # 1. Calculate the 'true' finite-size diffusion coefficient D_L_true\n        # This will be used to generate the synthetic trajectory data.\n        A_J_nm3 = A_eV_nm3 * EV_TO_J\n        exponent_arg = A_J_nm3 / (K_B * T_K * L_nm**3)\n        D_L_true = D_INF_TRUE * np.exp(-exponent_arg)\n\n        # 2. Generate synthetic trajectories for M particles\n        num_steps = int(t_tot_s / dt_s)\n        # Standard deviation for a one-dimensional displacement over one time step\n        sigma_step = np.sqrt(2 * D_L_true * dt_s)\n        \n        # Generate random displacements for M particles, N steps, 3 dimensions\n        displacements = np.random.normal(loc=0.0, scale=sigma_step, size=(M, num_steps, 3))\n        \n        # Cumulatively sum displacements to get unwrapped trajectories relative to r(0)\n        # The resulting shape is (M, num_steps, 3) where trajectories[m, i, :]\n        # is the displacement of particle m at time t_{i+1}.\n        trajectories = np.cumsum(displacements, axis=1)\n\n        # 3. Compute the Mean Squared Displacement (MSD)\n        # Sum the squares of x, y, z displacements for each particle at each time step\n        sq_disp = np.sum(trajectories**2, axis=2)\n        # Average the squared displacements over all M particles to get MSD vs. time\n        msd = np.mean(sq_disp, axis=0)\n        \n        # Create a corresponding time array for the MSD data\n        t_array = np.arange(1, num_steps + 1) * dt_s\n\n        # 4. Estimate D_L from a linear fit of the MSD data\n        # Exclude the initial fraction f_cut of data points from the fit\n        cutoff_index = int(f_cut * num_steps)\n        t_fit = t_array[cutoff_index:]\n        msd_fit = msd[cutoff_index:]\n        \n        # Perform linear regression: MSD(t) = slope * t + intercept\n        slope, intercept, _, _, _ = linregress(t_fit, msd_fit)\n        \n        # Estimate the finite-size diffusion coefficient from the slope (MSD = 6*D*t)\n        D_L_est = slope / 6.0\n\n        # 5. Apply the finite-size correction to estimate the infinite-system D\n        # This inverts the formula used in step 1\n        D_inf_est = D_L_est * np.exp(exponent_arg)\n        \n        results.append(D_inf_est)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures plain decimal float output, not scientific notation.\n    formatted_results = [f\"{r:.22f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Many materials derive their functionality from complex, non-bulk structures like reconstructed surfaces, which require their own specialized continuum descriptions. This exercise guides you through the process of homogenization, where an effective continuum model for a reconstructed silicon surface is derived from a simplified atomistic model of its surface dimers. By applying the Cauchy-Born hypothesis with internal atomic relaxations and minimizing the system's energy, you will compute an effective surface elastic constant, demonstrating how fine-scale structural details determine macroscopic mechanical response .",
            "id": "4144033",
            "problem": "A silicon $(001)$ surface undergoes a $(2 \\times 1)$ reconstruction characterized by dimers aligned along the $x$-direction. Consider a two dimensional (2D) surface continuum obtained by homogenizing an atomistic supercell that contains one dimer per $(2 \\times 1)$ surface unit. The supercell dimensions are $a_{s}$ along $x$ and $2 a_{s}$ along $y$, so the supercell area is $A = a_{s} \\cdot 2 a_{s}$. The dimer bond length in the reference (unstrained) reconstructed state is $l_{0}$. The macroscopic in-plane surface deformation is a small uniaxial strain $\\varepsilon_{xx}$ applied along the $x$-direction, with all other components negligible.\n\nUse the following atomistic model for the supercell:\n- The dimer is modeled as a harmonic spring aligned with $x$ with stretch stiffness $k_{d}$.\n- Each of the two dimer atoms is tethered to the underlying substrate by a harmonic spring (aligned with $x$) with stiffness $k_{s}$, which penalizes deviation of each atom’s displacement from the macroscopic imposed displacement field.\n\nAdopt the Cauchy–Born hypothesis at the surface: under the macroscopic small strain $\\varepsilon_{xx}$, the reference $x$-separation of the dimer endpoints, $l_{0}$, is affine-mapped to $l_{0} (1 + \\varepsilon_{xx})$ at the coarse scale. However, allow the two atoms to undergo additional internal displacements $v_{1}$ and $v_{2}$ along $x$ relative to the affine field, incurring the substrate-tether energy. The total atomistic energy of the supercell is the sum of the dimer spring energy and the two substrate spring energies. The homogenized surface free energy density is obtained as the atomistic energy minimized with respect to the internal displacements, divided by the supercell area $A$, and expanded to quadratic order in $\\varepsilon_{xx}$. The effective surface elastic constant in the dimer direction, $C^{s,\\mathrm{eff}}_{xxxx}$, is defined by the quadratic form $\\gamma(\\varepsilon_{xx}) = \\tfrac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^{2} + o(\\varepsilon_{xx}^{2})$.\n\nStarting from fundamental energy equivalence and the Cauchy–Born hypothesis, derive $C^{s,\\mathrm{eff}}_{xxxx}$ in closed form by minimizing over the internal displacements and performing the homogenization. Then, using the parameters\n$a_{s} = 3.84~\\text{\\AA}$, $l_{0} = 2.35~\\text{\\AA}$, $k_{d} = 100~\\text{N}/\\text{m}$, and $k_{s} = 200~\\text{N}/\\text{m}$,\ncompute the numerical value of $C^{s,\\mathrm{eff}}_{xxxx}$.\n\nExpress the final answer in $\\text{N}/\\text{m}$ and round your answer to three significant figures.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of continuum mechanics and atomistic modeling, specifically multi-scale homogenization using the Cauchy-Born rule with internal relaxation. The problem is well-posed, objective, and provides a self-contained set of definitions, parameters, and constraints sufficient to derive a unique, meaningful solution. While there is a minor notational inconsistency between the specified \"$(2 \\times 1)$ reconstruction\" and the given supercell dimensions (which correspond to a $(1 \\times 2)$ reconstruction by convention), the problem provides explicit and unambiguous geometric definitions ($a_s$ along $x$, $2a_s$ along $y$) and an area ($A = 2a_s^2$) that must be used. This makes the problem internally consistent and solvable as stated, overriding the conventional naming ambiguity.\n\nThe derivation of the effective surface elastic constant $C^{s,\\mathrm{eff}}_{xxxx}$ proceeds as follows.\n\nFirst, we establish the geometry and kinematics of the atomistic model for the supercell. Let the reference positions of the two atoms forming the dimer be $x_1^0$ and $x_2^0$ along the $x$-axis. We can define their positions relative to the center of the dimer, such that $x_1^0 = -l_0/2$ and $x_2^0 = l_0/2$, where $l_0$ is the initial bond length.\n\nUnder a macroscopic uniaxial strain $\\varepsilon_{xx}$, the Cauchy-Born hypothesis maps these reference positions to affine deformed positions $x_{i, \\text{affine}} = x_i^0(1+\\varepsilon_{xx})$. The problem introduces additional internal displacements along $x$, denoted by $v_1$ and $v_2$, for each atom relative to this affine field. The final positions of the two atoms are therefore:\n$$x_1 = x_1^0(1+\\varepsilon_{xx}) + v_1 = -\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1$$\n$$x_2 = x_2^0(1+\\varepsilon_{xx}) + v_2 = \\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2$$\n\nNext, we formulate the total potential energy of the supercell, $U_{cell}$. This energy consists of the dimer stretching energy, $U_d$, and the energy from the two substrate tethers, $U_s$.\n\nThe dimer stretching energy $U_d$ is modeled as a harmonic spring with stiffness $k_d$. The energy depends on the change in bond length, $\\Delta l$. The new bond length is $l = x_2 - x_1$.\n$$l = \\left(\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2\\right) - \\left(-\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1\\right) = l_0(1+\\varepsilon_{xx}) + v_2 - v_1$$\nThe change in length is $\\Delta l = l - l_0 = l_0\\varepsilon_{xx} + v_2 - v_1$. The energy is:\n$$U_d = \\frac{1}{2}k_d(\\Delta l)^2 = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2$$\n\nThe substrate tether energy $U_s$ penalizes the deviation of each atom from its affine position. These deviations are the internal displacements $v_1$ and $v_2$. Each atom is tethered by a spring of stiffness $k_s$.\n$$U_s = \\frac{1}{2}k_s v_1^2 + \\frac{1}{2}k_s v_2^2 = \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\nThe total atomistic energy of the supercell is the sum $U_{cell} = U_d + U_s$:\n$$U_{cell}(v_1, v_2) = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2 + \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\nTo find the relaxed state, this energy must be minimized with respect to the internal displacements $v_1$ and $v_2$. We set the partial derivatives of $U_{cell}$ with respect to $v_1$ and $v_2$ to zero.\n$$\\frac{\\partial U_{cell}}{\\partial v_1} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(-1) + k_s v_1 = 0 \\implies (k_d+k_s)v_1 - k_d v_2 = k_d l_0 \\varepsilon_{xx}$$\n$$\\frac{\\partial U_{cell}}{\\partial v_2} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(1) + k_s v_2 = 0 \\implies -k_d v_1 + (k_d+k_s)v_2 = -k_d l_0 \\varepsilon_{xx}$$\nFrom the symmetry of the equations, we can infer $v_2 = -v_1$. Substituting this into the first equation:\n$$(k_d+k_s)v_1 - k_d(-v_1) = k_d l_0 \\varepsilon_{xx} \\implies (2k_d+k_s)v_1 = k_d l_0 \\varepsilon_{xx}$$\nSolving for the equilibrium displacements $v_1^*$ and $v_2^*$:\n$$v_1^* = \\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_2^* = -v_1^* = -\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n\nWe now substitute these equilibrium displacements back into the total energy expression to obtain the minimized energy, $U_{cell}^{min}$.\nKey terms are:\n$$v_2^* - v_1^* = -2v_1^* = -2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_1^{*2} + v_2^{*2} = 2v_1^{*2} = 2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2$$\nSubstituting into $U_{cell}$:\n$$U_{cell}^{min} = \\frac{1}{2}k_d\\left(l_0\\varepsilon_{xx} - 2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2 + \\frac{1}{2}k_s\\left(2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2\\right)$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(1 - \\frac{2k_d}{2k_d+k_s}\\right)^2 + k_s\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(\\frac{k_s}{2k_d+k_s}\\right)^2 + k_s\\frac{k_d^2(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}$$\n$$U_{cell}^{min} = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\left(\\frac{1}{2}k_s^2 + k_s k_d\\right) = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\frac{k_s}{2}(k_s + 2k_d)$$\n$$U_{cell}^{min} = \\frac{1}{2}(l_0\\varepsilon_{xx})^2 \\frac{k_d k_s}{2k_d+k_s} = \\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2$$\n\nThe homogenized surface free energy density $\\gamma(\\varepsilon_{xx})$ is the minimized cell energy divided by the supercell area $A = 2a_s^2$.\n$$\\gamma(\\varepsilon_{xx}) = \\frac{U_{cell}^{min}}{A} = \\frac{1}{2a_s^2} \\left(\\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2\\right) = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}\\varepsilon_{xx}^2$$\n\nThe problem defines the effective surface elastic constant $C^{s,\\mathrm{eff}}_{xxxx}$ through the relation $\\gamma(\\varepsilon_{xx}) = \\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^2$. By comparing the two expressions for $\\gamma(\\varepsilon_{xx})$, we identify the constant:\n$$\\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{2a_s^2(2k_d+k_s)}$$\n\nFinally, we compute the numerical value using the provided parameters:\n$a_s = 3.84 \\times 10^{-10}~\\text{m}$\n$l_0 = 2.35 \\times 10^{-10}~\\text{m}$\n$k_d = 100~\\text{N}/\\text{m}$\n$k_s = 200~\\text{N}/\\text{m}$\n\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{(2.35 \\times 10^{-10})^2 (100) (200)}{2(3.84 \\times 10^{-10})^2 (2(100)+200)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{5.5225 \\times 10^{-20} \\cdot 20000}{2(14.7456 \\times 10^{-20}) (400)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{1.1045 \\times 10^{-15}}{2(14.7456 \\times 10^{-20}) (400)} = \\frac{1.1045 \\times 10^{-15}}{11796.48 \\times 10^{-20}} = \\frac{1.1045 \\times 10^{-15}}{1.179648 \\times 10^{-16}}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} \\approx 9.36295~\\text{N}/\\text{m}$$\nRounding to three significant figures, the result is $9.36~\\text{N}/\\text{m}$.",
            "answer": "$$\\boxed{9.36}$$"
        }
    ]
}