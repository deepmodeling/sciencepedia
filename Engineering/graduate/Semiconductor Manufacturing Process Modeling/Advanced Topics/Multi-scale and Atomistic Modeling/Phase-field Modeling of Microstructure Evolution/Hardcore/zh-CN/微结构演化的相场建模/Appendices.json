{
    "hands_on_practices": [
        {
            "introduction": "相场理论的基石之一是理解两相之间稳定界面的结构和能量。这项解析练习将引导您推导非守恒序参量的经典“扭结”解，通过该过程，您将学习如何将抽象的自由能泛函与界面宽度和界面能等具体物理性质联系起来。这个练习是理解更复杂微观结构演化模型的关键第一步 。",
            "id": "2508064",
            "problem": "考虑一维空间中非守恒序参量 $\\eta(x,t)$ 的相场模型，其 Ginzburg-Landau 自由能泛函为\n$$\nF[\\eta] \\,=\\, \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} \\,+\\, f_{0}(\\eta) \\right] \\, dx,\n$$\n其中 $\\kappa \\,\\, 0$ 为梯度能量系数，$f_{0}(\\eta) \\,=\\, \\frac{A}{4} \\left(\\eta^{2} - 1\\right)^{2}$ 为对称双势阱体自由能密度，且 $A \\,\\, 0$。其动力学遵循 Allen-Cahn (AC) 方程 $\\partial \\eta/\\partial t \\,=\\, -L \\, \\delta F/\\delta \\eta$，其中迁移率 $L$ 为正。但我们只关注使 $F$ 最小化的稳态剖面 $\\eta(x)$，该剖面需满足边界条件：当 $x \\to -\\infty$ 时 $\\eta(x) \\to -1$，以及当 $x \\to +\\infty$ 时 $\\eta(x) \\to +1$。\n\n仅使用应用于 $F[\\eta]$ 的变分法，并施加给定的边界条件，完成以下任务：\n- 推导稳态界面剖面 $\\eta(x)$ 的控制常微分方程，并对其进行一次积分，得到一个包含 $\\eta'(x)$ 和 $f_{0}(\\eta)$ 的第一积分。\n- 从此第一积分出发，确定连接两个势阱的单调稳态剖面，并用 $\\kappa$ 和 $A$ 表示特征界面宽度 $\\lambda$。\n- 使用稳态剖面和第一积分，计算单位面积的界面自由能（在一维情况下即线张力），\n$$\n\\gamma \\,=\\, \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} + f_{0}(\\eta) \\right] \\, dx,\n$$\n并将其纯粹用 $A$ 和 $\\kappa$ 表示。\n\n答案要求：\n- 将您的最终答案表示为关于 $A$ 和 $\\kappa$ 的 $\\gamma$ 的单一闭式符号表达式。\n- 不要提供任何数值近似值。",
            "solution": "所述问题是变分法中的一个标准练习，特别是在 Ginzburg-Landau 界面理论的背景下。所有前提在科学上都是合理的，且该问题在数学上是适定的。我们开始求解。\n\n该问题要求找到一个稳态剖面 $\\eta(x)$，以最小化自由能泛函\n$$\nF[\\eta] = \\int_{-\\infty}^{+\\infty} L(\\eta, \\eta') \\, dx,\n$$\n其中拉格朗日量为 $L(\\eta, \\eta') = \\frac{\\kappa}{2} (\\eta')^{2} + f_{0}(\\eta)$，且 $\\eta' \\equiv \\frac{d\\eta}{dx}$，$f_{0}(\\eta) = \\frac{A}{4} (\\eta^{2} - 1)^{2}$。参数 $\\kappa$ 和 $A$ 是正常数。边界条件为当 $x \\to -\\infty$ 时 $\\eta(x) \\to -1$，以及当 $x \\to +\\infty$ 时 $\\eta(x) \\to +1$。\n\n稳态剖面必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial \\eta} - \\frac{d}{dx} \\left( \\frac{\\partial L}{\\partial \\eta'} \\right) = 0.\n$$\n拉格朗日量的偏导数为：\n$$\n\\frac{\\partial L}{\\partial \\eta} = \\frac{df_{0}}{d\\eta} = \\frac{A}{4} \\cdot 2(\\eta^2 - 1) \\cdot (2\\eta) = A\\eta(\\eta^2 - 1).\n$$\n$$\n\\frac{\\partial L}{\\partial \\eta'} = \\kappa \\eta'.\n$$\n将这些代入欧拉-拉格朗日方程，得到稳态剖面的控制常微分方程：\n$$\nA\\eta(\\eta^2 - 1) - \\kappa \\frac{d^2\\eta}{dx^2} = 0 \\quad \\implies \\quad \\kappa \\frac{d^2\\eta}{dx^2} = \\frac{df_{0}}{d\\eta}.\n$$\n这就是所要求的控制常微分方程。为了找到其第一积分，我们观察到拉格朗日量 $L(\\eta, \\eta')$ 不显式依赖于自变量 $x$。因此，Beltrami 恒等式成立，即量 $H = \\eta' \\frac{\\partial L}{\\partial \\eta'} - L$ 是一个常数。\n$$\nH = \\eta'(\\kappa \\eta') - \\left[ \\frac{\\kappa}{2} (\\eta')^{2} + f_{0}(\\eta) \\right] = \\frac{\\kappa}{2} (\\eta')^{2} - f_{0}(\\eta) = \\text{const}.\n$$\n为了求出该常数，我们应用边界条件。当 $x \\to \\pm\\infty$ 时，剖面趋近于体平衡态之一，即 $\\eta \\to \\pm 1$。在这些区域，剖面必须是均匀的，因此 $\\eta' \\to 0$。在这些状态下，体自由能密度为 $f_{0}(\\pm 1) = \\frac{A}{4}((\\pm 1)^2 - 1)^2 = 0$。\n将这些值代入 $H$ 的表达式中，我们发现该常数为 $0$：\n$$\n\\frac{\\kappa}{2} (0)^{2} - 0 = 0.\n$$\n因此，能量最小化剖面的运动第一积分为\n$$\n\\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} = f_{0}(\\eta).\n$$\n根据这个第一积分，我们可以找到剖面的显式形式。我们寻求一个连接 $\\eta = -1$ 到 $\\eta = +1$ 的单调递增解（$\\frac{d\\eta}{dx}  0$）。\n$$\n\\frac{d\\eta}{dx} = \\sqrt{\\frac{2f_{0}(\\eta)}{\\kappa}} = \\sqrt{\\frac{2}{\\kappa} \\frac{A}{4}(\\eta^2-1)^2} = \\sqrt{\\frac{A}{2\\kappa}} |\\eta^2-1|.\n$$\n由于 $\\eta(x)$ 在 $-1$ 和 $+1$ 之间变化，项 $\\eta^2 - 1$ 是非正的，所以 $|\\eta^2 - 1| = 1 - \\eta^2$。微分方程变为：\n$$\n\\frac{d\\eta}{dx} = \\sqrt{\\frac{A}{2\\kappa}} (1 - \\eta^2).\n$$\n这是一个可分离变量的方程。我们在界面位于 $x=0$ 的条件下（即 $\\eta(0)=0$）对其进行积分。\n$$\n\\int_{0}^{\\eta} \\frac{d\\tilde{\\eta}}{1 - \\tilde{\\eta}^2} = \\int_{0}^{x} \\sqrt{\\frac{A}{2\\kappa}} d\\tilde{x}\n$$\n$$\n[\\operatorname{arctanh}(\\tilde{\\eta})]_{0}^{\\eta} = \\left[\\sqrt{\\frac{A}{2\\kappa}}\\tilde{x}\\right]_{0}^{x}\n$$\n$$\n\\operatorname{arctanh}(\\eta) = \\sqrt{\\frac{A}{2\\kappa}} x.\n$$\n因此，稳态剖面由下式给出：\n$$\n\\eta(x) = \\tanh\\left(\\sqrt{\\frac{A}{2\\kappa}} x\\right).\n$$\n该剖面正确地满足了当 $x \\to \\pm \\infty$ 时 $\\eta \\to \\pm 1$ 的边界条件。特征界面宽度 $\\lambda$ 通常根据参数的缩放来定义，即 $\\eta(x) = \\tanh(x/\\lambda)$。通过比较，我们确定宽度为：\n$$\n\\lambda = \\sqrt{\\frac{2\\kappa}{A}}.\n$$\n最后一步是计算界面自由能 $\\gamma$，其定义为此稳态剖面下泛函 $F[\\eta]$ 的值：\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} + f_{0}(\\eta) \\right] dx.\n$$\n利用第一积分 $\\frac{\\kappa}{2}(\\eta')^2 = f_{0}(\\eta)$，我们可以简化被积函数：\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} 2 f_{0}(\\eta) \\, dx \\quad \\text{或} \\quad \\gamma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\eta}{dx}\\right)^{2} dx.\n$$\n一个更直接的计算方法是利用第一积分将 $\\frac{d\\eta}{dx}$ 用 $\\eta$ 表示，并将积分变量从 $x$ 更改为 $\\eta$。\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\eta}{dx}\\right) \\frac{d\\eta}{dx} dx = \\int_{\\eta(-\\infty)}^{\\eta(+\\infty)} \\kappa \\left(\\frac{d\\eta}{dx}\\right) d\\eta.\n$$\n代入 $\\frac{d\\eta}{dx} = \\sqrt{\\frac{2f_0(\\eta)}{\\kappa}}$：\n$$\n\\gamma = \\int_{-1}^{+1} \\kappa \\sqrt{\\frac{2f_{0}(\\eta)}{\\kappa}} d\\eta = \\int_{-1}^{+1} \\sqrt{2\\kappa f_{0}(\\eta)} \\,d\\eta.\n$$\n现在，我们代入 $f_0(\\eta)$ 的表达式：\n$$\n\\gamma = \\int_{-1}^{+1} \\sqrt{2\\kappa \\cdot \\frac{A}{4}(\\eta^2-1)^2} \\, d\\eta = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{+1} |\\eta^2-1| \\, d\\eta.\n$$\n同样，由于 $\\eta \\in [-1, 1]$，我们有 $|\\eta^2 - 1| = 1 - \\eta^2$。\n$$\n\\gamma = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{+1} (1-\\eta^2) \\, d\\eta.\n$$\n该积分为初等积分：\n$$\n\\int_{-1}^{+1} (1-\\eta^2) \\, d\\eta = \\left[\\eta - \\frac{\\eta^3}{3}\\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{-1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}.\n$$\n将此结果代回 $\\gamma$ 的表达式中：\n$$\n\\gamma = \\sqrt{\\frac{A\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{4}{3\\sqrt{2}}\\sqrt{A\\kappa} = \\frac{2\\sqrt{2}}{3}\\sqrt{A\\kappa}.\n$$\n这就是用给定参数 $A$ 和 $\\kappa$ 表示的界面能的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{2}}{3}\\sqrt{A\\kappa}}\n$$"
        },
        {
            "introduction": "在分析了静态界面之后，下一步是理解微观结构如何随时间演化。这个练习探讨了系统中物质总量守恒（如合金分解）与不守恒（如晶体结构生长）这两种情况在数学和物理上的关键区别。理解艾伦-卡恩（Allen-Cahn）方程和卡恩-希利亚德（Cahn-Hilliard）方程之间的这一差异，对于为特定物理现象选择正确的演化方程至关重要 。",
            "id": "4149872",
            "problem": "考虑一个用于半导体晶圆加工的薄 Silicon-Germanium 合金膜片，它占据一个有界区域 $\\Omega \\subset \\mathbb{R}^3$，在边界 $\\partial \\Omega$ 上具有周期性边界条件或零法向通量边界条件。令 $c(\\mathbf{x},t)$ 表示 Germanium 的局部原子分数，令 $\\phi(\\mathbf{x},t)$ 表示一个第二相的非守恒结构序参量。初始成分 $c(\\mathbf{x},0)$ 在 $\\Omega$ 上的空间平均值为 $\\bar{c}$。热力学驱动力源于一个自由能泛函 $F$，该泛函对每个场都具有标准的 Ginzburg–Landau 形式，包含一个局域体能量密度和一个梯度惩罚项：对于成分，\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left(f_0(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^2\\right)\\, dV,\n$$\n对于序参量，\n$$\nF[\\phi] \\;=\\; \\int_{\\Omega} \\left(g_0(\\phi) \\;+\\; \\frac{\\beta}{2}\\,|\\nabla \\phi|^2\\right)\\, dV,\n$$\n其中 $\\kappa0$ 和 $\\beta0$ 是常数，$f_0$ 和 $g_0$ 是适用于所考虑合金和相的光滑双阱型体能量密度。化学势是变分导数 $\\mu_c = \\delta F / \\delta c$ 和 $\\mu_{\\phi} = \\delta F / \\delta \\phi$。\n\n假设存在以下基本演化定律：\n- $c(\\mathbf{x},t)$ 的物种守恒，由连续性方程给出\n$$\n\\frac{\\partial c}{\\partial t} \\;+\\; \\nabla \\cdot \\mathbf{J}_c \\;=\\; 0,\n$$\n其本构扩散通量为\n$$\n\\mathbf{J}_c \\;=\\; -\\,M(c)\\,\\nabla \\mu_c,\n$$\n其中 $M(c)$ 是一个光滑的非负迁移率。\n- $\\phi(\\mathbf{x},t)$ 的非守恒弛豫动力学，由以下方程给出\n$$\n\\frac{\\partial \\phi}{\\partial t} \\;=\\; -\\,L(\\phi)\\,\\mu_{\\phi},\n$$\n其中 $L(\\phi)$ 是一个光滑的非负动力学系数。\n\n仅使用这些定律、变分导数的定义和散度定理，在给定的边界条件下，推导区域积分 $\\int_{\\Omega} c(\\mathbf{x},t)\\, dV$ 和 $\\int_{\\Omega} \\phi(\\mathbf{x},t)\\, dV$ 变化率的精确表达式，并解释它们之间任何差异的数学原因。将您的最终答案表示为一个包含这两个变化率作为元素的符号行矩阵。无需进行数值计算，也无需四舍五入。",
            "solution": "该问题要求推导在一个区域 $\\Omega$ 内，一个守恒物种 $c(\\mathbf{x}, t)$ 的总量和一个非守恒序参量 $\\phi(\\mathbf{x}, t)$ 的总量的变化率。分析将依赖于所提供的演化方程和在指定边界条件下的散度定理。\n\n首先，我们分析 Germanium 的总量的变化率，它由浓度场 $c(\\mathbf{x}, t)$ 在区域 $\\Omega$ 上的积分表示。我们关心的量是 $\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV$。由于区域 $\\Omega$ 不随时间变化，我们可以应用 Leibniz 积分法则将时间导数移到积分内部：\n$$\n\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV = \\int_{\\Omega} \\frac{\\partial c(\\mathbf{x}, t)}{\\partial t} \\, dV\n$$\n问题给出了 $c$ 的演化定律，即连续性方程：\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J}_c\n$$\n其中 $\\mathbf{J}_c$ 是扩散通量。将此代入我们的积分中得到：\n$$\n\\frac{d}{dt} \\int_{\\Omega} c \\, dV = \\int_{\\Omega} (-\\nabla \\cdot \\mathbf{J}_c) \\, dV = -\\int_{\\Omega} (\\nabla \\cdot \\mathbf{J}_c) \\, dV\n$$\n现在我们应用散度定理（也称为 Gauss 定理），该定理指出，对于一个在区域 $\\Omega$ 上具有边界 $\\partial\\Omega$ 的连续可微矢量场 $\\mathbf{F}$，有 $\\int_{\\Omega} (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_{\\partial\\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$，其中 $\\mathbf{n}$ 是指向边界表面外部的单位法向量。将此定理应用于通量矢量 $\\mathbf{J}_c$，我们得到：\n$$\n\\frac{d}{dt} \\int_{\\Omega} c \\, dV = -\\oint_{\\partial\\Omega} \\mathbf{J}_c \\cdot \\mathbf{n} \\, dS\n$$\n问题指明了两种可能的边界条件：周期性边界条件或零法向通量边界条件。\n1.  **零法向通量：** 此条件定义为在边界 $\\partial\\Omega$ 上的所有点都有 $\\mathbf{J}_c \\cdot \\mathbf{n} = 0$。在这种情况下，曲面积分的被积函数恒等于零，因此积分值为零。\n2.  **周期性边界条件：** 在这种情况下，区域 $\\Omega$ 被视为在空间中重复的代表性体积元，这意味着它没有物理边界。在数学上，任何离开区域一个面的通量会从相对的面重新进入。因此，在整个边界 $\\partial\\Omega$ 上的积分值为零，因为来自相对面的贡献相互抵消。\n\n对于这两种指定的边界条件，曲面积分均为零：\n$$\n\\oint_{\\partial\\Omega} \\mathbf{J}_c \\cdot \\mathbf{n} \\, dS = 0\n$$\n因此，物种 $c$ 的总量的变化率为零：\n$$\n\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV = 0\n$$\n\n接下来，我们分析序参量 $\\phi(\\mathbf{x}, t)$ 的总量的变化率。该量为 $\\frac{d}{dt} \\int_{\\Omega} \\phi(\\mathbf{x}, t) \\, dV$。再次使用 Leibniz 积分法则：\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\phi(\\mathbf{x}, t) \\, dV = \\int_{\\Omega} \\frac{\\partial \\phi(\\mathbf{x}, t)}{\\partial t} \\, dV\n$$\n问题给出了 $\\phi$ 的演化定律，即非守恒的弛豫动力学：\n$$\n\\frac{\\partial \\phi}{\\partial t} = -L(\\phi)\\mu_{\\phi}\n$$\n其中 $L(\\phi)$ 是一个非负动力学系数，$\\mu_{\\phi}$ 是序参量的化学势。将其代入积分中得到：\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\phi \\, dV = \\int_{\\Omega} \\left( -L(\\phi)\\mu_{\\phi} \\right) \\, dV = -\\int_{\\Omega} L(\\phi)\\mu_{\\phi} \\, dV\n$$\n这是 $\\phi$ 总量变化率的最终表达式。与 $c$ 的情况不同，该表达式通常不为零。在所提供的框架内，没有任何数学定理或物理原理会强制该积分为零。化学势 $\\mu_{\\phi} = \\frac{\\delta F}{\\delta \\phi}$ 代表了 $\\phi$ 发生变化的热力学驱动力。系统将演化以降低总自由能，这通常涉及 $\\phi$ 的局域变化，其在区域上的积分非零。例如，稳定相（$\\phi=1$）以牺牲不稳定相（$\\phi=0$）为代价的生长会导致 $\\int_{\\Omega} \\phi \\, dV$ 的增加。\n\n这两个结果之间的根本区别直接源于它们各自演化方程的数学形式。\n- $c$ 的演化由 **守恒定律** $\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J}_c = 0$ 控制。场的时间导数等于通量矢量负的散度。这种结构是局域守恒的数学表述。对体积进行积分，可以利用散度定理将体积内总量的变化与穿过其边界的通量联系起来。在零通量或周期性边界条件下，该边界通量为零，从而导致总量 $\\int_{\\Omega} c \\, dV$ 的守恒。\n- $\\phi$ 的演化由 **非守恒弛豫定律** $\\frac{\\partial \\phi}{\\partial t} = -L(\\phi)\\mu_{\\phi}$ 控制。方程的右边是由局域热力学驱动力决定的局域源/汇项，而不是一个通量矢量的散度。对该方程进行体积积分，并不能自然地通过散度定理得到一个曲面积分。因此，不存在使总量 $\\int_{\\Omega} \\phi \\, dV$ 守恒的约束。\n\n总之，物种 $c$ 的总量是守恒的，因此其变化率为 $0$。序参量 $\\phi$ 的总量不守恒，其变化率由其局域源/汇项的体积积分给出，即 $-\\int_{\\Omega} L(\\phi)\\mu_{\\phi} \\, dV$。\n\n最终答案由这两个推导出的变化率组成，以行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -\\int_{\\Omega} L(\\phi)\\mu_{\\phi}\\,dV \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "这项最终的练习将理论与应用联系起来，指导您构建一个数值模拟。通过实现卡恩-希利亚德方程，您将能直接观察到调幅分解这一典型的守恒场动力学过程。这个练习还将强化一个基本的热力学原理：孤立系统的总自由能必须随时间单调递减，直至达到平衡 。",
            "id": "2847487",
            "problem": "考虑在一个长度为 $L$ 的一维周期性域上的守恒相场 $c(x,t)$ 的 Cahn–Hilliard 方程，\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\n其中自由能泛函为\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\n其中迁移率 $M0$，梯度能量系数 $\\kappa0$。假设采用周期性边界条件和无量纲变量，因此在计算或输出的任何部分都不需要物理单位。\n\n您的任务是从这些定义和第一性原理出发，通过调用变分导数和化学势的定义，推导出一个时间上一阶精确的傅里叶伪谱半隐式离散格式。在该格式中，由梯度能量项引起的对化学势的贡献被隐式处理，而非线性体导数 $F'(c)$ 则被显式处理。在长度为 $L$ 的周期区间上，使用包含 $N$ 个点的均匀网格对空间进行离散化，并使用快速傅里叶变换以谱方法表示空间导数。将相场 $c$ 向前演化指定数量的时间步长 $\\Delta t$，并使用网格上的梯形法则计算每个时间步的离散自由能：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\n其中 $\\Delta x = L/N$，$c_j = c(x_j)$，$x_j = j\\,\\Delta x$，而 $\\partial_x c$ 通过将 $c$ 的傅里叶系数与 $\\mathrm{i}k$ 相乘来进行谱方法计算，其中 $k$ 是与所选 $L$ 和 $N$ 对应的标准波数。您必须对每个测试用例验证离散自由能序列 $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$（其中 $N_t$ 是时间步数）是否单调非增，即对于所有 $n$ 是否有 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$。由于浮点舍入误差，您可以允许一个通过算法确定的小的非负容差，但您必须在您的解法中解释并证明您的选择。\n\n将您的推导实现为一个可执行程序，该程序构建谱算子，推进半隐式格式，计算每一步的离散自由能，并为每个指定的参数集返回一个布尔值，指示在整个运行过程中自由能是否单调递减。\n\n使用以下参数集测试套件。对于每个用例，设域长为 $L=2\\pi$，并使用无量纲参数。“noise”（噪声）用例中的初始条件是具有零均值和指定振幅的空间不相关高斯扰动，通过指定的伪随机种子使其可复现。“uniform”（均匀）用例中的初始条件是空间常数。对于每个用例，报告在所采取的步骤中自由能是否单调非增。\n\n- 用例1（理想路径）：$N=128$，$M=1$，$\\kappa=10^{-2}$，$\\Delta t = 2\\times 10^{-5}$，步数 $N_t=2000$，初始条件类型“noise”，振幅 $10^{-2}$，种子 $1$。\n- 用例2（中等小时间步）：$N=128$，$M=1$，$\\kappa=10^{-2}$，$\\Delta t = 10^{-4}$，步数 $N_t=400$，初始条件类型“noise”，振幅 $10^{-2}$，种子 $2$。\n- 用例3（体相极小值处的边界条件）：$N=64$，$M=1$，$\\kappa=10^{-2}$，$\\Delta t = 5\\times 10^{-4}$，步数 $N_t=200$，初始条件类型“uniform”，值 $+1$。\n- 用例4（较大时间步，可能违反单调衰减）：$N=128$，$M=1$，$\\kappa=10^{-2}$，$\\Delta t = 2\\times 10^{-3}$，步数 $N_t=100$，初始条件类型“noise”，振幅 $10^{-2}$，种子 $3$。\n\n所有变量和参数都是无量纲的；任何量都不需要物理单位。您的程序必须在单行中生成一个包含四个布尔值的列表，按所述顺序对应上述四个用例。最终输出格式必须是仅包含一行结果的方括号内逗号分隔列表，例如，“[True,False,True,True]”。\n\n您的实现必须是自包含的，使用傅里叶伪谱表示法计算空间导数，并遵循您从所述原理推导出的半隐式时间离散化方法，不依赖任何外部数据。不要包含任何无关的输出。唯一可接受的输出是指定的单行布尔值列表。",
            "solution": "该问题是有效的，因为它具有科学依据、良定且客观。它提出了一个计算材料物理学中的标准数值任务，并提供了所有必要信息。我们开始进行推导和求解。\n\nCahn-Hilliard 方程描述了守恒相场 $c(x,t)$ 的演化，由下式给出\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\n其中 $M$ 是迁移率，$\\mu$ 是化学势。化学势定义为 Ginzburg-Landau 自由能泛函 $\\mathcal{F}[c]$ 相对于相场 $c$ 的变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\n自由能泛函由下式给出\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\n其中双阱体能量密度为 $F(c) = \\frac{1}{4}(c^2-1)^2$，梯度能量系数 $\\kappa > 0$。\n\n首先，我们推导化学势 $\\mu$ 的显式形式。泛函的被积函数是 $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$。使用欧拉-拉格朗日方程求变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c} = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\n将这些代入 $\\mu$ 的表达式中，得到：\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\n将此式代入 Cahn-Hilliard 方程，得到完整的四阶非线性偏微分方程：\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\n为进行数值求解，我们采用傅里叶伪谱方法进行空间离散化，并采用半隐式一阶格式进行时间积分。空间域 $[0, L]$ 被离散化为 $N$ 个网格点 $x_j = j \\Delta x$，网格间距为 $\\Delta x = L/N$。相场 $c(x,t)$ 由其在该网格上的值 $c_j(t)$ 表示。在傅里叶谱方法中，空间导数在傅里叶空间中计算。函数 $f(x)$ 被变换为其傅里叶系数 $\\hat{f}(k)$，其中 $k$ 是波数。在傅里叶空间中，$n$ 阶导数对应于乘以 $(ik)^n$。因此，$\\nabla^2$ 变为乘以 $-k^2$，$\\nabla^4$ 变为乘以 $k^4$。\n\n该问题要求使用一种半隐式时间步进格式，其中来自 $F'(c) = c^3-c$ 的非线性体项贡献被显式处理，而刚性的梯度能量项 $-\\kappa\\nabla^2 c$ 被隐式处理。对显式部分使用一阶前向欧拉法，对隐式部分使用后向欧拉法，从时间步 $n$ 到 $n+1$ 的时间步长为 $\\Delta t$ 的时间离散化方程为：\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\n该方程在傅里叶空间中是代数的，这使得求解 $\\hat{c}^{n+1}$ 变得容易。设 $\\hat{c}^n(k)$ 为 $c^n(x_j)$ 的离散傅里叶变换。对该方程进行变换，我们得到：\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\n项 $\\widehat{((c^n)^3 - c^n)}$ 是通过伪谱方法计算的：表达式 $(c^n)^3 - c^n$ 在每个网格点的实空间中求值，然后将结果变换到傅里叶空间。\n我们重新整理方程以求解 $\\hat{c}^{n+1}(k)$：\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\n这得出了每个时间步傅里叶系数的更新规则：\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\n在每个时间步，我们从 $c^n$ 开始，计算其傅里叶变换 $\\hat{c}^n$，计算非线性项及其变换，应用更新规则找到 $\\hat{c}^{n+1}$，然后执行傅里叶逆变换以获得 $c^{n+1}$。\n\n离散自由能 $\\mathcal{F}_h$ 在每一步使用网格上的梯形法则计算：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\n空间导数 $\\partial_x c$ 通过以下谱方法计算：取 $c$ 的傅里叶变换，将系数 $\\hat{c}(k)$ 乘以 $ik$，然后进行傅里叶逆变换。\n\n我们必须验证能量序列 $\\{\\mathcal{F}_h^n\\}$ 是否单调非增。使用有限精度算术的数值计算会引入舍入误差。因此，检查严格不等式 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ 是不合适的。只有当能量增加超过一个容差时，才被认为是显著的。一个鲁棒的容差必须同时考虑能量接近于零时潜在舍入误差的绝对量值和能量较大时的相对误差。我们将容差 $\\epsilon_{tol}$ 定义为一个绝对分量 $\\tau_{abs}$ 和一个相对分量 $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$ 的和。非单调步骤的条件则是 $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n  \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$。对于所使用的双精度浮点数，我们选择保守值 $\\tau_{abs} = 10^{-12}$ 和 $\\tau_{rel} = 10^{-10}$。如果在任何时间步 $n$ 满足此条件，则认为能量序列是非单调的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}