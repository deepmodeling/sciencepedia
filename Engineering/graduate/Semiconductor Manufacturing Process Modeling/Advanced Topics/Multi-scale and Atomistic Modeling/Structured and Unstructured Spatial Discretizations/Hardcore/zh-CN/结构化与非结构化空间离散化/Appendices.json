{
    "hands_on_practices": [
        {
            "introduction": "有限体积法（FVM）的准确性在很大程度上取决于如何近似计算控制体积之间的通量。本练习将探讨构建对偶网格界面的两种不同方法——一种基于正交的Voronoi对偶，另一种基于菱形格式。通过为一个非Delaunay三角剖分计算几何传递率，你将对离散化选择如何影响数值方案的基本组成部分有一个定量的理解。",
            "id": "4171269",
            "problem": "在模拟硅晶圆热退火过程中的掺杂剂扩散时，我们在掩模角附近的非结构化三角形网格上使用了以顶点为中心的有限体积法 (FVM) 离散化。考虑两个相邻的三角形单元，它们共享顶点 $p$ 和 $q$ 之间的边，其中顶点坐标为 $p=(0,0)$ 和 $q=(1,0)$。这两个三角形的第三个顶点分别为 $r_{L}=(0.9,0.3)$ 和 $r_{R}=(0.1,-0.25)$。此构型被有意设置为非 Delaunay 构型。假设扩散系数 $D$ 是恒定的、各向同性的，并且浓度场 $C(x,y)$ 是局部线性的。\n\n从 Fick 定律 $J=-D \\nabla C$ 出发，并利用跨界面的两点通量可以写成 $F_{pq}=-T\\,(C_{q}-C_{p})$ 形式（其中 $T$ 是一个几何传输系数）的思想，推导并计算在以下两种构建分离 $p$ 和 $q$ 周围控制体的控制体界面的方法中，传输系数的数值：\n\n1. 基于正交 Voronoi 的对偶网格：将控制体面定义为连接两个相邻三角形 $(p,q,r_{L})$ 和 $(p,q,r_{R})$ 外心的直线段。利用该线段与边 $pq$ 正交，以及与 $pq$ 法线方向一致的两点通量相关的有效界面长度是此外心到外心线段的长度这一事实。使用 $|pq|$ 作为 $p$ 和 $q$ 之间的距离。\n\n2. 具有基于形心的中线对偶网格的菱形格式：将控制体界面定义为连接每个相邻三角形的形心与 $pq$ 中点的两条线段的并集。为了获得与 $pq$ 法线方向一致的等效两点传输系数，将连接形心到形心的向量投影到 $pq$ 的单位法向量上，并取该投影的模作为有效界面长度。同样，使用 $|pq|$ 作为 $p$ 和 $q$ 之间的距离。\n\n令扩散系数为 $D=1$，从而使传输系数简化为纯粹的几何量。计算相对误差\n$$\nE \\;=\\; \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}.\n$$\n将最终答案表示为精确分数（不要四舍五入）。答案是无量纲的；不包含任何单位。",
            "solution": "用户提供了一个在偏微分方程数值方法领域中定义明确的问题，具体涉及非结构化网格上的有限体积法 (FVM)。任务是计算并比较两种不同对偶网格构造下扩散项的传输系数。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   两个相邻三角形的顶点：$p=(0,0)$、$q=(1,0)$、$r_{L}=(0.9,0.3)$ 和 $r_{R}=(0.1,-0.25)$。\n-   三角形：$\\triangle_L = (p, q, r_L)$ 和 $\\triangle_R = (p, q, r_R)$。\n-   物理定律：Fick 定律，$\\vec{J}=-D \\nabla C$。\n-   假设：恒定、各向同性的扩散系数 $D$；局部线性浓度场 $C(x,y)$。\n-   两点通量近似形式：$F_{pq}=-T(C_{q}-C_{p})$，其中 $T$ 是传输系数。\n-   通用传输系数结构：$T = D \\frac{w}{L}$，其中 $w$ 是有效界面长度，$L$ 是节点之间的距离。此处，$L = |pq|$。\n-   方案 1 (正交对偶网格)：控制体面是连接 $\\triangle_L$ 和 $\\triangle_R$ 外心的线段。有效界面长度 $w_{orth}$ 是该线段的长度。\n-   方案 2 (菱形格式)：有效界面长度 $w_{diamond}$ 是形心到形心向量在边 $pq$ 单位法向量上投影的模。\n-   恒定值：扩散系数 $D=1$。\n-   要求计算：相对误差 $E = \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是计算流体动力学和半导体工艺模拟中的一个标准练习。FVM、对偶网格 (Voronoi, 中线)、外心、形心、传输系数以及非 Delaunay 网格问题等概念都是该领域的基础。问题陈述清晰，提供了所有必要的数据和明确的定义，可以得出一个唯一的解。语言客观而精确。数据是自洽的；例如，所指定的几何结构确实如所述是 非 Delaunay 的，这是比较这些数值格式的一个相关细节。这个问题并非微不足道，因为它需要正确应用几何公式并理解其底层的数值概念。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 求解推导\n\n两个节点 $p$ 和 $q$ 之间的传输系数的一般形式为 $T = D \\frac{w}{L}$，其中 $D$ 是扩散系数，$w$ 是节点之间控制体界面的有效长度，$L$ 是节点之间的距离。\n\n在本题中，给定 $D=1$。节点 $p=(0,0)$ 和 $q=(1,0)$ 之间的距离是 $L = |pq| = \\sqrt{(1-0)^2 + (0-0)^2} = 1$。\n因此，传输系数在数值上简化为等于有效界面长度：$T=w$。我们现在将为两种方案分别计算此长度。\n\n**1. 基于正交 Voronoi 的对偶网格传输系数 ($T_{\\text{orth}}$)**\n\n该方案将有效界面长度 $w_{orth}$ 定义为两个相邻三角形 $\\triangle_L = (p,q,r_L)$ 和 $\\triangle_R = (p,q,r_R)$ 外心之间的距离。设外心为 $O_L$ 和 $O_R$。\n\n三角形的外心是到其三个顶点距离相等的点。设一个通用的外心点为 $(x_c, y_c)$。\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_L(0.9, 0.3)$ 的三角形 $\\triangle_L$：\n线段 $pq$ 的垂直平分线是直线 $x=0.5$。外心必须位于这条线上，所以 $x_{c,L} = 0.5$。\n外心到 $p$ 的距离必须等于到 $r_L$ 的距离：\n$$|O_L p|^2 = |O_L r_L|^2$$\n$$(x_{c,L}-0)^2 + (y_{c,L}-0)^2 = (x_{c,L}-0.9)^2 + (y_{c,L}-0.3)^2$$\n代入 $x_{c,L} = 0.5$：\n$$(0.5)^2 + y_{c,L}^2 = (0.5-0.9)^2 + (y_{c,L}-0.3)^2$$\n$$0.25 + y_{c,L}^2 = (-0.4)^2 + y_{c,L}^2 - 0.6 y_{c,L} + (0.3)^2$$\n$$0.25 = 0.16 - 0.6 y_{c,L} + 0.09$$\n$$0.25 = 0.25 - 0.6 y_{c,L}$$\n$$0.6 y_{c,L} = 0 \\implies y_{c,L} = 0$$\n所以，$\\triangle_L$ 的外心是 $O_L = (0.5, 0)$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_R(0.1, -0.25)$ 的三角形 $\\triangle_R$：\n外心也必须位于 $pq$ 的垂直平分线上，所以 $x_{c,R} = 0.5$。\n外心到 $p$ 的距离必须等于到 $r_R$ 的距离：\n$$|O_R p|^2 = |O_R r_R|^2$$\n$$(x_{c,R}-0)^2 + (y_{c,R}-0)^2 = (x_{c,R}-0.1)^2 + (y_{c,R}-(-0.25))^2$$\n代入 $x_{c,R} = 0.5$：\n$$(0.5)^2 + y_{c,R}^2 = (0.5-0.1)^2 + (y_{c,R}+0.25)^2$$\n$$0.25 + y_{c,R}^2 = (0.4)^2 + y_{c,R}^2 + 0.5 y_{c,R} + (0.25)^2$$\n$$0.25 = 0.16 + 0.5 y_{c,R} + 0.0625$$\n$$0.25 = 0.2225 + 0.5 y_{c,R}$$\n$$0.0275 = 0.5 y_{c,R} \\implies y_{c,R} = 0.055$$\n所以，$\\triangle_R$ 的外心是 $O_R = (0.5, 0.055)$。\n\n有效界面长度 $w_{orth}$ 是 $O_L$ 和 $O_R$ 之间的距离：\n$$w_{orth} = |O_L O_R| = \\sqrt{(0.5-0.5)^2 + (0.055-0)^2} = \\sqrt{0^2 + (0.055)^2} = 0.055$$\n用分数形式表示，$0.055 = \\frac{55}{1000} = \\frac{11}{200}$。\n因此，传输系数为 $T_{orth} = w_{orth} = \\frac{11}{200}$。\n\n**2. 菱形格式传输系数 ($T_{\\text{diamond}}$)**\n\n该方案将有效界面长度 $w_{diamond}$ 定义为形心到形心向量在边 $pq$ 单位法向量上投影的模。\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形的形心是 $(\\frac{x_1+x_2+x_3}{3}, \\frac{y_1+y_2+y_3}{3})$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_L(0.9, 0.3)$ 的三角形 $\\triangle_L$：\n形心是 $G_L = \\left(\\frac{0+1+0.9}{3}, \\frac{0+0+0.3}{3}\\right) = \\left(\\frac{1.9}{3}, \\frac{0.3}{3}\\right) = \\left(\\frac{19}{30}, \\frac{1}{10}\\right)$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_R(0.1, -0.25)$ 的三角形 $\\triangle_R$：\n形心是 $G_R = \\left(\\frac{0+1+0.1}{3}, \\frac{0+0-0.25}{3}\\right) = \\left(\\frac{1.1}{3}, \\frac{-0.25}{3}\\right) = \\left(\\frac{11}{30}, -\\frac{1}{12}\\right)$。\n\n形心到形心的向量是 $\\vec{G_L G_R} = G_R - G_L$：\n$$\\vec{G_L G_R} = \\left(\\frac{11}{30} - \\frac{19}{30}, -\\frac{1}{12} - \\frac{1}{10}\\right) = \\left(-\\frac{8}{30}, -\\frac{5}{60} - \\frac{6}{60}\\right) = \\left(-\\frac{4}{15}, -\\frac{11}{60}\\right)$$\n边向量为 $\\vec{pq} = (1,0)$。$\\vec{pq}$ 的一个单位法向量是 $\\vec{n}=(0,1)$。\n有效界面长度 $w_{diamond}$ 是 $\\vec{G_L G_R}$ 和 $\\vec{n}$ 点积的模：\n$$w_{diamond} = |\\vec{G_L G_R} \\cdot \\vec{n}| = \\left|\\left(-\\frac{4}{15}, -\\frac{11}{60}\\right) \\cdot (0,1)\\right| = \\left|(-\\frac{4}{15})(0) + (-\\frac{11}{60})(1)\\right|$$\n$$w_{diamond} = \\left|-\\frac{11}{60}\\right| = \\frac{11}{60}$$\n因此，传输系数为 $T_{diamond} = w_{diamond} = \\frac{11}{60}$。\n\n**3. 相对误差计算**\n\n相对误差 $E$ 定义为：\n$$E = \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}$$\n代入计算出的值：\n$$E = \\frac{\\frac{11}{60}-\\frac{11}{200}}{\\frac{11}{200}}$$\n我们可以通过分子分母同除以 $11$ 来简化此式：\n$$E = \\frac{\\frac{1}{60}-\\frac{1}{200}}{\\frac{1}{200}}$$\n这等价于：\n$$E = \\frac{T_{diamond}}{T_{orth}} - 1 = \\frac{11/60}{11/200} - 1 = \\frac{200}{60} - 1 = \\frac{20}{6} - 1 = \\frac{10}{3} - 1$$\n$$E = \\frac{10}{3} - \\frac{3}{3} = \\frac{7}{3}$$\n两种传输系数计算之间的相对误差是 $\\frac{7}{3}$。",
            "answer": "$$\\boxed{\\frac{7}{3}}$$"
        },
        {
            "introduction": "半导体工艺建模通常涉及演化的表面，例如在沉积或蚀刻过程中。本实践深入研究了在三角形网格上使用Laplace-Beltrami算子模拟表面扩散。你将推导离散算子（余切拉普拉斯算子），并分析其特征值，以确定显式时间积分方案的最大稳定时间步长，从而将空间离散化与数值稳定性联系起来。",
            "id": "4171249",
            "problem": "在半导体制造过程建模中，沉积和蚀刻过程中出现的晶圆形貌可以通过表面扩散进行平滑，其主导项在数学上通过表面上的平均曲率流进行建模。考虑一个弯曲的晶圆表面，该表面由一个非结构化三角网格表示，该网格由$N=4$个顶点组成，形成一个边长统一为$a>0$的正四面体。设顶点$i$的嵌入位置为$\\mathbf{x}_i \\in \\mathbb{R}^3$，并将所有顶点的位置集合成一个$3N$维向量$\\mathbf{X}$。连续平均曲率流由偏微分方程(PDE) $\\partial_t \\mathbf{x} = - \\nu \\Delta_s \\mathbf{x}$ 建模，其中 $\\Delta_s$ 是表面上的拉普拉斯-贝尔特拉米算子，$\\nu$ 是一个有效表面迁移率乘以表面张力的参数，单位为 $\\mathrm{m}^2/\\mathrm{s}$。假设在此分析中化学反应可忽略不计，并专注于由扩散驱动的几何演化。\n\n使用拉普拉斯-贝尔特拉米算子的变分定义和三角化表面上的标准线性有限元方法(FEM)，半离散演化可以写成 $M \\frac{d\\mathbf{X}}{dt} + \\nu L \\mathbf{X} = \\mathbf{0}$ 的形式，其中$M$是一个集中质量矩阵，其对角线元素是与顶点相关联的面积，$L$是由三角形贡献组装而成的对称刚度矩阵。\n\n任务：\n- 从表面拉普拉斯算子的变分形式出发，推导给定四面体网格的余切加权离散算子$L$和相应的集中质量矩阵$M$（用$a$表示）。\n- 计算算子$M^{-1}L$的特征值。\n- 对 $M \\frac{d\\mathbf{X}}{dt} + \\nu L \\mathbf{X} = \\mathbf{0}$ 使用前向（显式）欧拉时间步进法，确定最大稳定时间步长 $\\Delta t_{\\max}$（用$a$和$\\nu$表示）。将最终结果以闭式解析表达式的形式表示，单位为秒，并且不要在方框答案中包含单位。\n\n本题不提供中间公式的提示。本题不需要进行舍入。您可以假设四面体的面是欧几里得等边三角形，并且网格是封闭无边界的。",
            "solution": "用户要求我解决一个关于四面体网格上表面扩散数值建模的问题。\n\n### 问题验证\n我将首先验证问题陈述。\n\n**步骤1：提取已知条件**\n- **网格：** 一个具有$N=4$个顶点和统一边长$a>0$的正四面体。该网格是一个封闭曲面。\n- **控制偏微分方程：** $\\partial_t \\mathbf{x} = - \\nu \\Delta_s \\mathbf{x}$，其中 $\\Delta_s$ 是拉普拉斯-贝尔特拉米算子，$\\nu$ 是一个常数，单位为 $\\mathrm{m}^2/\\mathrm{s}$。该过程被描述为通过表面扩散进行平滑。\n- **半离散系统：** 该偏微分方程通过在三角网格上使用线性有限元进行离散化，得到常微分方程(ODE)系统：$M \\frac{d\\mathbf{X}}{dt} + \\nu L \\mathbf{X} = \\mathbf{0}$。\n- **系统矩阵：**\n    - $\\mathbf{X}$ 是顶点位置 $\\mathbf{x}_i \\in \\mathbb{R}^3$ 的 $3N$ 维向量。\n    - $M$ 是集中质量矩阵，一个对角矩阵，其元素对应于与顶点相关联的面积。\n    - $L$ 是对称余切加权刚度矩阵（离散拉普拉斯算子）。\n- **时间积分：** ODE系统使用前向（显式）欧拉方法进行积分。\n- **任务：**\n    1.  用$a$推导矩阵$M$和$L$。\n    2.  计算算子$M^{-1}L$的特征值。\n    3.  用$a$和$\\nu$确定最大稳定时间步长 $\\Delta t_{\\max}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题在计算几何和偏微分方程数值解领域有坚实的基础。使用余切拉普拉斯算子离散化拉普拉斯-贝尔特拉米算子是在网格上模拟几何流（如平均曲率流）的一种标准且成熟的方法。\n- **一致性：** 问题陈述中提到“通过表面扩散进行平滑”，并提供了离散系统 $M \\dot{\\mathbf{X}} = -\\nu L \\mathbf{X}$。已知余切矩阵 $L$ 是半正定的。由此产生的系统描述了一个耗散过程，其中高频分量衰减，这是平滑的特征。如果将 $\\Delta_s$ 定义为一个半正定算子（这是几何处理中的常见约定），则连续PDE $\\partial_t \\mathbf{x} = - \\nu \\Delta_s \\mathbf{x}$ 与此相符。在该标准解释下，问题的所有部分都是一致的。\n- **适定性：** 几何形状是一个正四面体，其定义精确。任务是具体的数学推导和计算。问题是自洽的，并提供了得出唯一解所需的所有信息。\n\n**步骤3：结论与行动**\n问题有效。我现在将继续进行求解。\n\n### 第1部分：矩阵 M 和 L 的推导\n\n**正四面体的几何性质**\n一个正四面体有$N=4$个顶点，$E=6$条长度为$a$的边，以及$F=4$个面。每个面都是边长为$a$的等边三角形。每个面的内角都等于$\\pi/3$弧度（$60^\\circ$）。\n\n**集中质量矩阵 M**\n矩阵$M$是一个$3N \\times 3N$的对角矩阵。对于使用线性元的集中质量格式，与顶点$i$对应的对角线元素$M_{ii}$是维诺(Voronoi)区域面积，其近似为所有与顶点$i$相关联的三角形面积的三分之一。\n单个等边三角形面的面积$A_T$为：\n$$ A_T = \\frac{1}{2} a \\cdot (a \\sin(\\pi/3)) = \\frac{1}{2} a^2 \\frac{\\sqrt{3}}{2} = \\frac{\\sqrt{3}}{4} a^2 $$\n在正四面体中，每个顶点都属于3个三角形面。根据对称性，所有$N=4$个顶点的关联面积$A_v$是相同的。\n$$ A_v = 3 \\times \\left(\\frac{1}{3} A_T\\right) = A_T = \\frac{\\sqrt{3}}{4} a^2 $$\n完整的质量矩阵$\\mathbf{M}$是一个$12 \\times 12$的分块对角矩阵，每个块是$A_v$乘以$3 \\times 3$的单位矩阵$I_3$。\n$$ M = \\mathrm{diag}(A_v I_3, A_v I_3, A_v I_3, A_v I_3) = A_v I_{12} = \\frac{\\sqrt{3}}{4} a^2 I_{12} $$\n其中$I_{12}$是$12 \\times 12$的单位矩阵。\n\n**刚度矩阵 L (余切拉普拉斯算子)**\n刚度矩阵$L$由余切公式推导而来。对于一个标量函数，其元素由下式给出：\n$$ L_{ij}^{\\text{scalar}} = \\begin{cases} -w_{ij}  \\text{如果 } i \\neq j \\text{ 且顶点 } i, j \\text{ 相连} \\\\ \\sum_{k \\in N(i)} w_{ik}  \\text{如果 } i=j \\\\ 0  \\text{其他情况} \\end{cases} $$\n连接顶点$i$和$j$的边的权重$w_{ij}$由以下公式给出：\n$$ w_{ij} = \\frac{1}{2}(\\cot \\alpha_{ij} + \\cot \\beta_{ij}) $$\n其中 $\\alpha_{ij}$ 和 $\\beta_{ij}$ 是共享边 $(i, j)$ 的两个三角形中该边所对的角。\n在正四面体中，任意两个顶点都由一条边连接。每条边由两个等边三角形共享。在每个三角形中，该边所对的角是$\\pi/3$。因此，对于任意边 $(i, j)$：\n$$ w_{ij} = \\frac{1}{2}(\\cot(\\pi/3) + \\cot(\\pi/3)) = \\cot(\\pi/3) = \\frac{1}{\\sqrt{3}} $$\n因为所有权重都相等，我们记 $w = 1/\\sqrt{3}$。\n标量拉普拉斯矩阵 $L_{scalar}$ 是一个 $4 \\times 4$ 矩阵。\n对于 $i \\neq j$，$L_{scalar, ij} = -w = -1/\\sqrt{3}$。\n对于 $i=j$，对角线元素为 $L_{scalar, ii} = \\sum_{k \\neq i} w_{ik}$。由于每个顶点有3个邻居，$L_{scalar, ii} = 3w = 3/\\sqrt{3} = \\sqrt{3}$。\n所以，标量矩阵是：\n$$ L_{scalar} = \\begin{pmatrix} \\sqrt{3}  -1/\\sqrt{3}  -1/\\sqrt{3}  -1/\\sqrt{3} \\\\ -1/\\sqrt{3}  \\sqrt{3}  -1/\\sqrt{3}  -1/\\sqrt{3} \\\\ -1/\\sqrt{3}  -1/\\sqrt{3}  \\sqrt{3}  -1/\\sqrt{3} \\\\ -1/\\sqrt{3}  -1/\\sqrt{3}  -1/\\sqrt{3}  \\sqrt{3} \\end{pmatrix} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 3  -1  -1  -1 \\\\ -1  3  -1  -1 \\\\ -1  -1  3  -1 \\\\ -1  -1  -1  3 \\end{pmatrix} $$\n这可以写成 $L_{scalar} = \\frac{1}{\\sqrt{3}}(4I_4 - J_4)$，其中 $I_4$ 是 $4 \\times 4$ 单位矩阵，$J_4$ 是 $4 \\times 4$ 的全一矩阵。\n对于位置向量 $\\mathbf{X}$，完整的 $12 \\times 12$ 矩阵 $L$ 是标量拉普拉斯矩阵 $L_{scalar}$ 与 $3 \\times 3$ 单位矩阵 $I_3$ 的克罗内克(Kronecker)积：\n$$ L = L_{scalar} \\otimes I_3 $$\n\n### 第2部分：$M^{-1}L$的特征值\n\n我们感兴趣的算子是$M^{-1}L$。首先，我们求$M$的逆：\n$$ M^{-1} = \\left(\\frac{\\sqrt{3}}{4} a^2\\right)^{-1} I_{12} = \\frac{4}{\\sqrt{3} a^2} I_{12} $$\n现在，我们计算乘积$M^{-1}L$：\n$$ M^{-1}L = \\left(\\frac{4}{\\sqrt{3} a^2} I_{12}\\right) (L_{scalar} \\otimes I_3) = \\frac{4}{\\sqrt{3} a^2} (L_{scalar} \\otimes I_3) $$\n一个矩阵乘以常数的特征值是该常数乘以原矩阵的特征值。克罗内克积 $A \\otimes B$ 的特征值是矩阵 $A$ 和 $B$ 各自特征值 $\\lambda_i$ 和 $\\mu_j$ 的乘积。这里，$I_3$的特征值都是$1$。因此，$M^{-1}L$的特征值是$L_{scalar}$的特征值乘以$\\frac{4}{\\sqrt{3} a^2}$，且每个特征值的重数都乘以3。\n\n我们来求 $L_{scalar} = \\frac{1}{\\sqrt{3}}(4I_4 - J_4)$ 的特征值。我们首先求全一矩阵 $J_4$ 的特征值。$J_4$ 的秩为$1$，其特征值为$4$（重数为$1$，特征向量为$(1,1,1,1)^T$）和$0$（重数为$4-1=3$）。\n矩阵 $4I_4 - J_4$ 的特征值为 $4 - \\lambda_{J_4}$：\n- $4 - 4 = 0$（重数为$1$）\n- $4 - 0 = 4$（重数为$3$）\n$L_{scalar}$ 的特征值（我们称之为 $\\lambda_k$）是这些值乘以 $1/\\sqrt{3}$：\n- $\\lambda_1 = \\frac{1}{\\sqrt{3}} \\cdot 0 = 0$（重数为$1$）\n- $\\lambda_2 = \\frac{1}{\\sqrt{3}} \\cdot 4 = \\frac{4}{\\sqrt{3}}$（重数为$3$）\n\n最后，$M^{-1}L$ 的特征值（记为 $\\mu_k$）：\n- 对应于 $\\lambda_1=0$ 的特征值是 $\\mu_1 = \\frac{4}{\\sqrt{3} a^2} \\cdot 0 = 0$。其重数为 $1 \\times 3 = 3$。这些模式对应于四面体在 x、y、z 方向上的整体平移。\n- 对应于 $\\lambda_2=4/\\sqrt{3}$ 的特征值是 $\\mu_2 = \\frac{4}{\\sqrt{3} a^2} \\cdot \\frac{4}{\\sqrt{3}} = \\frac{16}{3a^2}$。其重数为 $3 \\times 3 = 9$。\n\n$M^{-1}L$ 的特征值集合是 $\\{0, \\frac{16}{3a^2}\\}$，重数分别为$3$和$9$。\n\n### 第3部分：最大稳定时间步长 $\\Delta t_{\\max}$\n\n半离散系统为 $M \\frac{d\\mathbf{X}}{dt} + \\nu L \\mathbf{X} = \\mathbf{0}$，可以重写为：\n$$ \\frac{d\\mathbf{X}}{dt} = -\\nu M^{-1} L \\mathbf{X} $$\n使用时间步长 $\\Delta t$ 应用前向（显式）欧拉方法：\n$$ \\mathbf{X}_{n+1} = \\mathbf{X}_n + \\Delta t \\left(-\\nu M^{-1} L \\mathbf{X}_n\\right) = (I - \\Delta t \\, \\nu M^{-1}L) \\mathbf{X}_n $$\n为了数值稳定性，放大矩阵 $(I - \\Delta t \\, \\nu M^{-1}L)$ 的所有特征值的模必须小于或等于$1$。\n该矩阵的特征值为 $1 - \\Delta t \\, \\nu \\mu_k$，其中 $\\mu_k$ 是 $M^{-1}L$ 的特征值。我们需要：\n$$ |1 - \\Delta t \\, \\nu \\mu_k| \\le 1 $$\n由于 L 是对称半正定的，M 是对称正定的，因此 $M^{-1}L$ 的特征值 $\\mu_k$ 是实数且非负的。稳定性条件变为：\n$$ -1 \\le 1 - \\Delta t \\, \\nu \\mu_k \\le 1 $$\n右侧不等式 $1 - \\Delta t \\, \\nu \\mu_k \\le 1$ 简化为 $-\\Delta t \\, \\nu \\mu_k \\le 0$，对于 $\\Delta t > 0$，$\\nu > 0$ 和 $\\mu_k \\ge 0$ 总是成立的。\n左侧不等式 $-1 \\le 1 - \\Delta t \\, \\nu \\mu_k$ 给出约束条件：\n$$ \\Delta t \\, \\nu \\mu_k \\le 2 \\implies \\Delta t \\le \\frac{2}{\\nu \\mu_k} \\quad (\\text{对于 } \\mu_k > 0) $$\n此条件必须对所有非零特征值成立。这等价于要求它对最大特征值 $\\mu_{\\max}$ 成立。\n$$ \\Delta t \\le \\frac{2}{\\nu \\mu_{\\max}} $$\n从第2部分可知，最大特征值为 $\\mu_{\\max} = \\frac{16}{3a^2}$。\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 为：\n$$ \\Delta t_{\\max} = \\frac{2}{\\nu \\left(\\frac{16}{3a^2}\\right)} = \\frac{2 \\cdot 3a^2}{16\\nu} = \\frac{6a^2}{16\\nu} = \\frac{3a^2}{8\\nu} $$",
            "answer": "$$\\boxed{\\frac{3a^{2}}{8\\nu}}$$"
        },
        {
            "introduction": "这项综合性实践旨在将理论转化为一个可运行的程序。通过为一个具有温度依赖性电导率的瞬态热传导问题实施一个隐式有限体积法方案，你将组装牛顿法求解器所需的非线性残差向量和雅可比矩阵。本练习为在非结构化网格上构建一个实用的非线性问题数值求解器提供了完整的实践经验。",
            "id": "4171263",
            "problem": "考虑半导体晶圆子域中的瞬态热传导，该过程通过能量守恒和傅里葉定律建模。设温度场为 $T(\\boldsymbol{x},t)$，密度为 $\\rho$，比热容为 $c$，导热系数与温度相关，其关系为 $\\kappa(T)=\\kappa_{0}\\left(1+\\alpha T\\right)$，其中 $\\kappa_{0}>0$ 且 $\\alpha\\ge 0$。从能量守恒和傅里葉定律出发，推导非结构化网格的隐式有限体积法（FVM）残差，其中控制体积之间的每个面上均使用两点通量近似。然后，为牛顿法组装所需的雅可比矩阵项 $\\partial R_{i}/\\partial T_{j}$，并考虑内部面和狄利克雷边界面。所有面均为平面，热传导是各向同性的，且平面外厚度为单位1。\n\n您必须实现一个完整、可运行的程序，该程序能够：\n- 通过其控制体积和面来构建非结构化网格。\n- 在给定温度迭代值 $T$ 和前一时刻温度 $T^{n}$ 的情况下，为隐式时间离散化组装非线性残差 $R(T)$ 和雅可比矩阵 $J(T)$。\n- 对内部面上的导热系数使用算术平均值。\n- 使用在相邻控制体积中评估的单侧导热系数来处理狄利克雷边界。\n- 为一组测试用例计算雅可比矩阵的指定度量指标。\n\n基本和建模假设：\n- 能量守恒：$\\rho c \\dfrac{\\partial T}{\\partial t}=\\nabla\\cdot\\left(\\kappa(T)\\nabla T\\right)$，无体积源项。\n- 各向同性热传导的傅里葉定律：$\\boldsymbol{q}=-\\kappa(T)\\nabla T$。\n- 使用隐式时间步长 $\\Delta t$ 和基于面的通量平衡进行控制体积积分。\n- 在长度为 $L_f$、质心间距为 $d_{ij}$ 的面上采用两点通量近似，并使用单位厚度。几何传递系数为 $A_{ij}=\\dfrac{L_{f}}{d_{ij}}$。\n\n单位：\n- 温度单位必须是 $\\mathrm{K}$。\n- 导热系数单位必须是 $\\mathrm{W}/(\\mathrm{m}\\,\\mathrm{K})$。\n- 热容 $\\rho c$ 单位必须是 $\\mathrm{J}/(\\mathrm{m}^{3}\\,\\mathrm{K})$。\n- 时间步长单位必须是 $\\mathrm{s}$。\n- 面长度和距离单位必须是 $\\mathrm{m}$。\n- 体积单位必须是 $\\mathrm{m}^{3}$。\n- 要求的输出是无量纲的或以派生单位表示，并且必须作为不带单位的原始数值返回。\n\n所有测试用例的网格规范（非结构化多边形控制体积，单位厚度）：\n- 控制体积数量：$5$个，标记为 $0,1,2,3,4$。\n- 体积：$V_{0}=1.8\\times 10^{-12}$, $V_{1}=1.5\\times 10^{-12}$, $V_{2}=1.4\\times 10^{-12}$, $V_{3}=1.6\\times 10^{-12}$, $V_{4}=1.7\\times 10^{-12}$。\n- 内部面（对 $(i,j)$，具有面长度 $L_{f}$ 和距离 $d_{ij}$）：\n  - $(0,1)$，$L_{f}=1.2\\times 10^{-6}$，$d_{ij}=0.7\\times 10^{-6}$。\n  - $(1,2)$，$L_{f}=0.9\\times 10^{-6}$，$d_{ij}=0.6\\times 10^{-6}$。\n  - $(2,3)$，$L_{f}=1.1\\times 10^{-6}$，$d_{ij}=0.5\\times 10^{-6}$。\n  - $(3,4)$，$L_{f}=0.8\\times 10^{-6}$，$d_{ij}=0.6\\times 10^{-6}$。\n  - $(4,0)$，$L_{f}=1.0\\times 10^{-6}$，$d_{ij}=0.5\\times 10^{-6}$。\n  - $(1,3)$，$L_{f}=0.95\\times 10^{-6}$，$d_{ij}=0.75\\times 10^{-6}$。\n- 狄利克雷边界面（单元 $i$ 到边界，边界温度为 $T_{b}$，面长度为 $L_{f}$，距离为 $d_{i,b}$）：\n  - 单元 $0$，$T_{b}=300$，$L_{f}=1.3\\times 10^{-6}$，$d_{i,b}=0.5\\times 10^{-6}$。\n  - 单元 $2$，$T_{b}=295$，$L_{f}=1.0\\times 10^{-6}$，$d_{i,b}=0.6\\times 10^{-6}$。\n  - 单元 $4$，$T_{b}=305$，$L_{f}=0.7\\times 10^{-6}$，$d_{i,b}=0.5\\times 10^{-6}$。\n\n所有测试用例中使用的热物理性质：\n- 热容 $\\rho c=1.63\\times 10^{6}$。\n- 基础导热系数 $\\kappa_{0}=120$。\n\n所有测试用例中使用的温度数据：\n- 前一时刻温度 $T^{n}$ 是均匀的：对于所有控制体积 $i$，$T^{n}_{i}=300$。\n- 用于组装的牛顿迭代温度向量 $T$：$T=[302,298,305,297,300]$。\n\n每个测试用例的程序输出：\n- 测试用例1（非线性热传导）：$\\alpha=10^{-3}$, $\\Delta t=10^{-6}$。计算雅可比矩阵 $J(T)$ 的谱半径，定义为其特征值中的最大绝对值。将此值作为浮点数返回。\n- 测试用例2（线性热传导极限）：$\\alpha=0$, $\\Delta t=10^{-6}$。计算 $J(T)$ 是否在 $10^{-12}$ 的容差内对称，返回一个布尔值。使用 $J(T)-J(T)^{\\top}$ 的弗罗贝尼乌斯范数来评估对称性。\n- 测试用例3（强时间主导机制）：$\\alpha=10^{-3}$, $\\Delta t=10^{-9}$。计算各行的对角占优比的最小值，行 $i$ 的对角占优比定义为 $r_{i}=\\dfrac{|J_{ii}|}{\\sum_{j\\ne i}|J_{ij}|}$，约定如果分母为零，则比率为 $+\\infty$。将最小比率作为浮点数返回。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，并严格按照三个测试用例的顺序排列：$[\\text{spectral\\_radius\\_case1},\\text{is\\_symmetric\\_case2},\\text{min\\_diag\\_dom\\_ratio\\_case3}]$。",
            "solution": "该问题要求推导并实现一个非线性瞬态热传导问题的雅可比矩阵。该问题使用隐式有限体积法（FVM）在非结构化网格上进行离散化。该问题具有科学依据，是适定的，并且为获得唯一解提供了所有必要数据。我们开始进行推导。\n\n瞬态热传导的控制偏微分方程（PDE）由能量守恒给出：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\boldsymbol{q}\n$$\n其中 $\\rho$ 是密度，单位为 $\\mathrm{kg}/\\mathrm{m}^3$，$c$ 是比热容，单位为 $\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$，$\\boldsymbol{q}$ 是热通量矢量，单位为 $\\mathrm{W}/\\mathrm{m}^2$。乘积 $\\rho c$ 是体积热容，单位为 $\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$。热通量由各向同性热传导的傅里葉定律定义：\n$$\n\\boldsymbol{q} = -\\kappa(T) \\nabla T\n$$\n导热系数 $\\kappa$ 与温度相关，由线性模型 $\\kappa(T) = \\kappa_0 (1 + \\alpha T)$ 给出，其中 $\\kappa_0$ 是基础导热系数，$\\alpha$ 是温度系数。\n\n为了离散化该偏微分方程，我们在任意一个边界为 $\\partial V_i$ 的控制体积 $V_i$ 上进行积分：\n$$\n\\int_{V_i} \\rho c \\frac{\\partial T}{\\partial t} \\, dV = \\int_{V_i} \\nabla \\cdot (-\\kappa(T) \\nabla T) \\, dV\n$$\n对右侧应用散度定理可得：\n$$\n\\int_{V_i} \\rho c \\frac{\\partial T}{\\partial t} \\, dV = -\\int_{\\partial V_i} (\\kappa(T) \\nabla T) \\cdot \\boldsymbol{n} \\, dS\n$$\n其中 $\\boldsymbol{n}$ 是指向边界表面 $\\partial V_i$ 外部的单位法向量。\n\n我们对积分进行近似。假设温度 $T$ 在每个控制体积 $V_i$ 内是均匀的，其值为 $T_i$。时间导数使用时间步长为 $\\Delta t$ 的一阶全隐式（后向欧拉）格式进行离散化。这将温度 $T_i$ 视为新时间层 $T_i^{n+1}$ 的未知数。设 $T_i^n$ 为前一时间步的已知温度。左侧变为：\n$$\n\\int_{V_i} \\rho c \\frac{\\partial T}{\\partial t} \\, dV \\approx (\\rho c V_i) \\frac{T_i - T_i^n}{\\Delta t}\n$$\n右侧的面积分是穿过控制体积所有面的热流率之和。对于一个单位厚度的二维问题，面面积 $dS$ 变为面长度 $L_f$ 乘以单位厚度 $1$。流出控制体积 $V_i$ 的总热流率是其所有面上的流量之和。平衡为零的方程是：累积项 + 净流出项 = $0$。设 $F_{out}$ 为流出 $V_i$ 的总热流率。\n$$\nF_{out} = \\sum_{f \\in \\text{faces of } i} \\int_{S_f} (-\\boldsymbol{q}) \\cdot \\boldsymbol{n} \\, dS = \\sum_{f \\in \\text{faces of } i} \\int_{S_f} (\\kappa(T) \\nabla T) \\cdot \\boldsymbol{n} \\, dS\n$$\n净流出通过对离散面上的通量求和来近似。控制体积 $i$ 和相邻体积 $j$ 之间的面上的通量采用两点通量近似（TPFA）进行近似。从 $i$ 到 $j$ 的热流率，记为 $F_{ij}$，是：\n$$\nF_{ij} \\approx \\kappa_{ij} \\frac{L_{ij}}{d_{ij}} (T_i - T_j) = \\kappa_{ij} A_{ij} (T_i - T_j)\n$$\n其中 $L_{ij}$ 是 $i$ 和 $j$ 之间面的长度，$d_{ij}$ 是 $V_i$ 和 $V_j$ 质心之间的距离，$A_{ij} = L_{ij} / d_{ij}$ 是几何传递系数，$\\kappa_{ij}$ 是面上的有效导热系数。类似地，对于边界温度为 $T_b$ 的狄利克雷边界面，从 $i$ 流向边界的流量为 $F_{ib} = \\kappa_{ib} A_{ib} (T_i - T_b)$。\n\n控制体积 $i$ 的离散方程是能量累积率必须与流入该体积的净热流量相平衡。在我们的公式中，这写为：\n$$\n\\frac{\\rho c V_i}{\\Delta t} (T_i - T_i^n) + \\sum_{j \\in N(i)} F_{ij}(T) + \\sum_{b \\in B(i)} F_{ib}(T) = 0\n$$\n其中 $N(i)$ 是内部相邻体积的集合，$B(i)$ 是体积 $i$ 的边界面集合。此方程构成了非线性残差向量 $R_i(T)$ 的第 $i$ 个分量：\n$$\nR_i(T) = \\frac{\\rho c V_i}{\\Delta t} (T_i - T_i^n) + \\sum_{j \\in N(i)} \\kappa_{ij} A_{ij} (T_i - T_j) + \\sum_{b \\in B(i)} \\kappa_{ib} A_{ib} (T_i - T_b)\n$$\n导热系数的近似方法如下：\n1.  内部面 $(i,j)$：算术平均，$\\kappa_{ij}(T) = \\frac{\\kappa(T_i) + \\kappa(T_j)}{2} = \\kappa_0 \\left(1 + \\alpha \\frac{T_i + T_j}{2}\\right)$。\n2.  狄利克雷边界面 $(i,b)$：单侧，$\\kappa_{ib}(T) = \\kappa(T_i) = \\kappa_0(1 + \\alpha T_i)$。\n\n对于牛顿法，我们需要雅可比矩阵 $J$，其元素为 $J_{ik} = \\frac{\\partial R_i}{\\partial T_k}$。\n\n**雅可比矩阵对角线元素, $J_{ii} = \\frac{\\partial R_i}{\\partial T_i}$**\n$$\nJ_{ii} = \\frac{\\partial}{\\partial T_i} \\left( \\frac{\\rho c V_i}{\\Delta t} (T_i - T_i^n) \\right) + \\sum_{j \\in N(i)} \\frac{\\partial F_{ij}}{\\partial T_i} + \\sum_{b \\in B(i)} \\frac{\\partial F_{ib}}{\\partial T_i}\n$$\n通量项的导数为：\n- 对于内部相邻单元 $j$：$F_{ij} = \\kappa_{ij}A_{ij}(T_i-T_j)$。\n  $$ \\frac{\\partial F_{ij}}{\\partial T_i} = \\frac{\\partial \\kappa_{ij}}{\\partial T_i} A_{ij}(T_i-T_j) + \\kappa_{ij}A_{ij}(1) = \\left(\\kappa_0 \\frac{\\alpha}{2}\\right) A_{ij}(T_i-T_j) + \\kappa_{ij}A_{ij} $$\n- 对于边界面 $b$：$F_{ib} = \\kappa_{ib}A_{ib}(T_i-T_b)$。\n  $$ \\frac{\\partial F_{ib}}{\\partial T_i} = \\frac{\\partial \\kappa_{ib}}{\\partial T_i} A_{ib}(T_i-T_b) + \\kappa_{ib}A_{ib}(1) = \\left(\\kappa_0 \\alpha \\right) A_{ib}(T_i-T_b) + \\kappa_{ib}A_{ib} $$\n将所有贡献项相加，对角线元素为：\n$$\nJ_{ii} = \\frac{\\rho c V_i}{\\Delta t} + \\sum_{j \\in N(i)} \\left[ \\kappa_{ij}A_{ij} + \\kappa_0 \\frac{\\alpha}{2} A_{ij}(T_i-T_j) \\right] + \\sum_{b \\in B(i)} \\left[ \\kappa_{ib}A_{ib} + \\kappa_0 \\alpha A_{ib}(T_i-T_b) \\right]\n$$\n\n**雅可比矩阵非对角线元素, $J_{ik} = \\frac{\\partial R_i}{\\partial T_k}$ 对于 $k \\neq i$**\n如果 $k$ 不是 $i$ 的内部相邻单元，$J_{ik}=0$。如果 $k$ 是一个内部相邻单元（为清楚起见，我们使用索引 $j$），则 $R_i$ 中只有通量项 $F_{ij}$ 依赖于 $T_j$。\n$$\nJ_{ij} = \\frac{\\partial F_{ij}}{\\partial T_j} = \\frac{\\partial \\kappa_{ij}}{\\partial T_j} A_{ij}(T_i-T_j) + \\kappa_{ij}A_{ij}(-1) = \\left(\\kappa_0 \\frac{\\alpha}{2}\\right) A_{ij}(T_i-T_j) - \\kappa_{ij}A_{ij}\n$$\n这就完成了所有必需的雅可比矩阵项的推导。实现部分将使用这些公式为三个测试用例中的每一个组装 $5 \\times 5$ 的雅可比矩阵，并计算指定的度量指标。\n\n对于用例2，其中 $\\alpha=0$，雅可比矩阵项简化为：\n$$ J_{ii} = \\frac{\\rho c V_i}{\\Delta t} + \\sum_{j \\in N(i)} \\kappa_0 A_{ij} + \\sum_{b \\in B(i)} \\kappa_0 A_{ib} $$\n$$ J_{ij} = -\\kappa_0 A_{ij} $$\n从 $j$到 $i$ 的通量为 $F_{ji} = \\kappa_0 A_{ij} (T_j - T_i)$。对 $R_j$ 的贡献是 $F_{ji}$，所以 $J_{ji} = \\frac{\\partial F_{ji}}{\\partial T_i} = -\\kappa_0 A_{ij}$。因此，当 $\\alpha=0$ 时，$J_{ij} = J_{ji}$，雅可比矩阵是对称的。当 $\\alpha > 0$ 时，由于导熱系数对温度的依赖性，雅可比矩阵通常是非对称的。\n\n对于用例3，行 $i$ 的对角占优比计算为 $r_i = |J_{ii}| / \\sum_{j \\neq i} |J_{ij}|$。小的时间步长 $\\Delta t$ 会使瞬态项 $\\frac{\\rho c V_i}{\\Delta t}$ 变大，该项在对角线元素 $J_{ii}$ 中占主导地位，通常导致强对角占优。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the semiconductor heat conduction problem for three test cases.\n    \"\"\"\n    \n    # Mesh and material properties (fixed for all cases)\n    # Number of control volumes\n    N_vols = 5\n    \n    # Control volume sizes [m^3]\n    V = np.array([1.8e-12, 1.5e-12, 1.4e-12, 1.6e-12, 1.7e-12])\n    \n    # Interior faces: (cell_i, cell_j, face_length_Lf, centroid_dist_dij)\n    interior_faces = [\n        (0, 1, 1.2e-6, 0.7e-6),\n        (1, 2, 0.9e-6, 0.6e-6),\n        (2, 3, 1.1e-6, 0.5e-6),\n        (3, 4, 0.8e-6, 0.6e-6),\n        (4, 0, 1.0e-6, 0.5e-6),\n        (1, 3, 0.95e-6, 0.75e-6),\n    ]\n    \n    # Dirichlet boundary faces: (cell_i, boundary_temp_Tb, face_length_Lf, cell_to_boundary_dist_dib)\n    dirichlet_faces = [\n        (0, 300.0, 1.3e-6, 0.5e-6),\n        (2, 295.0, 1.0e-6, 0.6e-6),\n        (4, 305.0, 0.7e-6, 0.5e-6),\n    ]\n    \n    # Thermophysical properties\n    rho_c = 1.63e6  # Volumetric heat capacity [J/(m^3*K)]\n    kappa_0 = 120.0   # Base thermal conductivity [W/(m*K)]\n    \n    # Temperature data [K]\n    T_n = np.full(N_vols, 300.0) # Previous time step temperature\n    T = np.array([302.0, 298.0, 305.0, 297.0, 300.0]) # Current Newton iterate temperature\n    \n    test_cases = [\n        {'alpha': 1e-3, 'dt': 1e-6, 'case_id': 1},\n        {'alpha': 0.0, 'dt': 1e-6, 'case_id': 2},\n        {'alpha': 1e-3, 'dt': 1e-9, 'case_id': 3},\n    ]\n\n    def assemble_jacobian(alpha, dt):\n        \"\"\"Assembles the Jacobian matrix J for a given set of parameters.\"\"\"\n        J = np.zeros((N_vols, N_vols))\n\n        # 1. Transient term contribution (diagonal only)\n        for i in range(N_vols):\n            J[i, i] += rho_c * V[i] / dt\n\n        # 2. Interior face contributions\n        for i, j, Lf, dij in interior_faces:\n            A_ij = Lf / dij\n            T_i, T_j = T[i], T[j]\n            \n            kappa_ij = kappa_0 * (1.0 + alpha * (T_i + T_j) / 2.0)\n            \n            # Derivative of flux F_ij w.r.t T_i (for J_ii)\n            dFij_dTi = (kappa_0 * alpha / 2.0) * A_ij * (T_i - T_j) + kappa_ij * A_ij\n            J[i, i] += dFij_dTi\n            \n            # Derivative of flux F_ji w.r.t T_j (for J_jj)\n            dFji_dTj = (kappa_0 * alpha / 2.0) * A_ij * (T_j - T_i) + kappa_ij * A_ij\n            J[j, j] += dFji_dTj\n            \n            # Derivative of flux F_ij w.r.t T_j (for J_ij)\n            dFij_dTj = (kappa_0 * alpha / 2.0) * A_ij * (T_i - T_j) - kappa_ij * A_ij\n            J[i, j] += dFij_dTj\n            \n            # Derivative of flux F_ji w.r.t T_i (for J_ji)\n            dFji_dTi = (kappa_0 * alpha / 2.0) * A_ij * (T_j - T_i) - kappa_ij * A_ij\n            J[j, i] += dFji_dTi\n\n        # 3. Dirichlet boundary face contributions (diagonal only)\n        for i, T_b, Lf, dib in dirichlet_faces:\n            A_ib = Lf / dib\n            T_i = T[i]\n            \n            kappa_ib = kappa_0 * (1.0 + alpha * T_i)\n            \n            # Derivative of flux F_ib w.r.t T_i\n            dFib_dTi = (kappa_0 * alpha) * A_ib * (T_i - T_b) + kappa_ib * A_ib\n            J[i, i] += dFib_dTi\n            \n        return J\n\n    results = []\n    \n    for case in test_cases:\n        alpha = case['alpha']\n        dt = case['dt']\n        case_id = case['case_id']\n        \n        J = assemble_jacobian(alpha, dt)\n        \n        if case_id == 1:\n            # Compute spectral radius\n            eigenvalues = np.linalg.eigvals(J)\n            spectral_radius = np.max(np.abs(eigenvalues))\n            results.append(spectral_radius)\n        \n        elif case_id == 2:\n            # Check for symmetry\n            symmetry_error = np.linalg.norm(J - J.T, 'fro')\n            is_symmetric = symmetry_error  1e-12\n            results.append(is_symmetric)\n            \n        elif case_id == 3:\n            # Compute minimum diagonal dominance ratio\n            ratios = []\n            for i in range(N_vols):\n                diag_val = np.abs(J[i, i])\n                off_diag_sum = np.sum(np.abs(J[i, :])) - diag_val\n                \n                if off_diag_sum == 0.0:\n                    ratios.append(np.inf)\n                else:\n                    ratios.append(diag_val / off_diag_sum)\n            \n            min_diag_dom_ratio = np.min(ratios)\n            results.append(min_diag_dom_ratio)\n\n    print(f\"[{results[0]},{str(results[1]).lower()},{results[2]}]\")\n\nsolve()\n```"
        }
    ]
}