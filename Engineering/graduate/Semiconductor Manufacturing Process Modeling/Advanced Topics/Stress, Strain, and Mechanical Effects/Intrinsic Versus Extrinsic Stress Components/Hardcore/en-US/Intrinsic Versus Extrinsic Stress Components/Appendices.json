{
    "hands_on_practices": [
        {
            "introduction": "Understanding intrinsic stress begins with its physical origin at the atomic scale. This foundational exercise guides you through a classic derivation, connecting the incorporation of atomic-scale defects to the generation of macroscopic stress. By using the concept of eigenstrain to model the chemical expansion from interstitial atoms, you will derive the resulting biaxial stress in a constrained thin film, providing a clear, analytical link between a microstructural cause and its mechanical effect .",
            "id": "4133979",
            "problem": "A crystalline thin film of a semiconductor is uniformly doped with interstitial species during deposition. Each interstitial possesses an eigenvolume $\\Omega_{i}$ and, when incorporated at a number concentration $c_{i}$ (number per unit volume), produces an isotropic chemical expansion represented by the eigenstrain tensor $\\boldsymbol{\\varepsilon}^{*} = \\varepsilon^{*} \\mathbf{I}$ with $\\varepsilon^{*} = \\Omega_{i} c_{i}$, where $\\mathbf{I}$ is the identity tensor. The film is elastically isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$. It is perfectly bonded to a much thicker, effectively rigid substrate such that the in-plane total strains are constrained to be zero, while the film’s free surface imposes zero normal stress. Assume the temperature history is chosen such that extrinsic stress components (for example, thermal mismatch stress and deposition-induced extrinsic stress) are negligible, and only the intrinsic stress arising from interstitial incorporation is present.\n\nStarting from the linear isotropic elasticity constitutive relation with eigenstrain and the additive decomposition of strain, and enforcing the boundary conditions of a thin film under equi-biaxial constraint (in-plane total strains equal to zero and out-of-plane stress equal to zero), derive the intrinsic equi-biaxial in-plane stress $\\sigma$ in the film as a closed-form expression in terms of $E$, $\\nu$, $\\Omega_{i}$, and $c_{i}$. Adopt the sign convention that compressive stress is negative. Express your final answer symbolically; no numerical evaluation or rounding is required. Do not include units in the final boxed answer.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- A crystalline thin film with uniform doping of interstitial species.\n- The eigenvolume per interstitial species is $\\Omega_{i}$.\n- The number concentration of interstitials is $c_{i}$ (number per unit volume).\n- The eigenstrain tensor is isotropic: $\\boldsymbol{\\varepsilon}^{*} = \\varepsilon^{*} \\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor.\n- The magnitude of the isotropic eigenstrain is $\\varepsilon^{*} = \\Omega_{i} c_{i}$.\n- The film is elastically isotropic with Young's modulus $E$ and Poisson's ratio $\\nu$.\n- The film is perfectly bonded to a rigid substrate, imposing the constraint of zero in-plane total strains.\n- The film's top surface is free, resulting in zero normal stress in the out-of-plane direction.\n- Extrinsic stress sources are negligible; only intrinsic stress is considered.\n- The sign convention for stress is that compressive stress is negative.\n- The objective is to derive the intrinsic equi-biaxial in-plane stress, denoted $\\sigma$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically sound, resting on the established principles of linear elasticity, solid mechanics, and materials science. The concept of eigenstrain (also known as misfit strain) due to chemical effects (interstitial incorporation) is a standard model in the study of stress in thin films. The boundary conditions—a film constrained biaxially by a rigid substrate with a free surface—represent a classic and well-posed problem in thin-film mechanics. All necessary parameters ($E$, $\\nu$, $\\Omega_{i}$, $c_{i}$) and conditions are provided, and there are no internal contradictions or ambiguities. The problem is a direct and formalizable application of theory, relevant to the topic of intrinsic stress in semiconductor manufacturing. Therefore, the problem is deemed valid.\n\n### Step 3: Derivation of the Intrinsic Stress\nThe solution begins with the fundamental principle of additive strain decomposition. The total strain tensor, $\\boldsymbol{\\varepsilon}_{\\text{total}}$, is the sum of the elastic strain tensor, $\\boldsymbol{\\varepsilon}_{\\text{elastic}}$, and the eigenstrain (or misfit strain) tensor, $\\boldsymbol{\\varepsilon}^{*}$:\n$$\n\\boldsymbol{\\varepsilon}_{\\text{total}} = \\boldsymbol{\\varepsilon}_{\\text{elastic}} + \\boldsymbol{\\varepsilon}^{*}\n$$\nThe stress in the material, $\\boldsymbol{\\sigma}$, is generated only by the elastic strain, as described by the linear isotropic elastic constitutive relation (Hooke's Law). The strain-stress form of this relation is:\n$$\n\\varepsilon_{ij}^{\\text{elastic}} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\delta_{ij} \\sum_{k=1}^{3} \\sigma_{kk} \\right]\n$$\nwhere $\\sigma_{ij}$ and $\\varepsilon_{ij}^{\\text{elastic}}$ are the components of the stress and elastic strain tensors, respectively, and $\\delta_{ij}$ is the Kronecker delta.\n\nWe establish a Cartesian coordinate system where the film lies in the $x_1$-$x_2$ plane (in-plane directions) and the $x_3$ direction is normal to the film plane (out-of-plane direction).\n\nThe problem specifies an equi-biaxial state of stress in the film plane due to the isotropic nature of the eigenstrain and the in-plane constraints. This implies:\n$$\n\\sigma_{11} = \\sigma_{22} = \\sigma\n$$\nAll shear stress components are zero due to symmetry: $\\sigma_{12} = \\sigma_{13} = \\sigma_{23} = 0$.\n\nThe boundary condition at the free surface of the film dictates that the stress component normal to this surface must be zero:\n$$\n\\sigma_{33} = 0\n$$\nThe problem states that the film is bonded to a rigid substrate, which constrains the total in-plane strains to be zero:\n$$\n\\varepsilon_{11}^{\\text{total}} = 0 \\quad \\text{and} \\quad \\varepsilon_{22}^{\\text{total}} = 0\n$$\nThe eigenstrain is isotropic, given by $\\boldsymbol{\\varepsilon}^{*} = \\varepsilon^{*} \\mathbf{I}$, where $\\varepsilon^{*} = \\Omega_{i} c_{i}$. In component form:\n$$\n\\varepsilon_{11}^{*} = \\varepsilon_{22}^{*} = \\varepsilon_{33}^{*} = \\varepsilon^{*} = \\Omega_{i} c_{i}\n$$\nand all off-diagonal eigenstrain components are zero.\n\nNow, we use the strain decomposition for an in-plane component, for instance $\\varepsilon_{11}^{\\text{total}}$:\n$$\n\\varepsilon_{11}^{\\text{total}} = \\varepsilon_{11}^{\\text{elastic}} + \\varepsilon_{11}^{*}\n$$\nApplying the rigid substrate constraint, $\\varepsilon_{11}^{\\text{total}} = 0$, we find the required elastic strain in the plane:\n$$\n\\varepsilon_{11}^{\\text{elastic}} = - \\varepsilon_{11}^{*} = - \\varepsilon^{*}\n$$\nNext, we express the elastic strain $\\varepsilon_{11}^{\\text{elastic}}$ using Hooke's Law in terms of the stress components:\n$$\n\\varepsilon_{11}^{\\text{elastic}} = \\frac{1}{E} \\left[ \\sigma_{11} - \\nu (\\sigma_{22} + \\sigma_{33}) \\right]\n$$\nSubstituting the known stress components ($\\sigma_{11} = \\sigma$, $\\sigma_{22} = \\sigma$, $\\sigma_{33} = 0$):\n$$\n\\varepsilon_{11}^{\\text{elastic}} = \\frac{1}{E} \\left[ \\sigma - \\nu (\\sigma + 0) \\right] = \\frac{\\sigma (1-\\nu)}{E}\n$$\nWe now have two expressions for $\\varepsilon_{11}^{\\text{elastic}}$. Equating them allows us to solve for the unknown in-plane stress $\\sigma$:\n$$\n\\frac{\\sigma (1-\\nu)}{E} = - \\varepsilon^{*}\n$$\nSolving for $\\sigma$:\n$$\n\\sigma = - \\frac{E \\varepsilon^{*}}{1-\\nu}\n$$\nFinally, we substitute the given expression for the eigenstrain magnitude, $\\varepsilon^{*} = \\Omega_{i} c_{i}$:\n$$\n\\sigma = - \\frac{E \\Omega_{i} c_{i}}{1-\\nu}\n$$\nThis expression represents the intrinsic equi-biaxial stress in the thin film. The negative sign indicates that for a positive eigenvolume $\\Omega_i$ (as expected for interstitials) and positive concentration $c_i$, the film is under compressive stress, which aligns with the physical situation where an expanding film is constrained by a rigid substrate and the given sign convention.",
            "answer": "$$\\boxed{- \\frac{E \\Omega_{i} c_{i}}{1-\\nu}}$$"
        },
        {
            "introduction": "In contrast to intrinsic stress, extrinsic stress arises from external factors, most commonly thermal mismatch. This practice moves from analytical derivation to computational modeling, tasking you with calculating the time-dependent extrinsic stress during a thermal cycle. You will account for the realistic complication of temperature-dependent material properties, requiring you to implement a numerical solution that captures the stress evolution throughout a process recipe, a crucial skill in predictive process modeling .",
            "id": "4133915",
            "problem": "A thin, isotropic semiconductor process film bonded to a much thicker substrate develops extrinsic stress due to mismatch in thermal expansion during a transient thermal cycle. Under the assumptions of small strain, linear thermoelasticity, perfect bonding, and negligible intrinsic sources, the film is constrained to follow the in-plane strain of the substrate, resulting in equi-biaxial in-plane stress in the film. Starting only from the foundations of linear elasticity and thermoelastic strain definitions, derive and implement a computation for the time evolution of the extrinsic thermoelastic stress $ \\sigma(t) $ in the film when all relevant material properties are temperature dependent.\n\nFundamental bases to use:\n- Linear kinematics for small strain: the total strain $ \\varepsilon $ is the sum of the mechanical strain $ \\varepsilon^{\\mathrm{mech}} $ and the thermal strain $ \\varepsilon^{\\mathrm{th}} $.\n- Thermal strain accumulated along a temperature path from a reference temperature $ T_{\\mathrm{ref}} $: $ \\varepsilon^{\\mathrm{th}} = \\int_{T_{\\mathrm{ref}}}^{T} \\alpha(\\theta)\\,\\mathrm{d}\\theta $, where $ \\alpha(\\theta) $ is the coefficient of thermal expansion.\n- For an isotropic material under equi-biaxial plane stress in the film, the constitutive response can be expressed using the biaxial modulus evaluated at the instantaneous temperature.\n\nYou are given temperature-dependent material property functions for the film modulus $ E_f(T) $, film Poisson’s ratio $ \\nu_f(T) $, film coefficient of thermal expansion $ \\alpha_f(T) $, substrate coefficient of thermal expansion $ \\alpha_s(T) $, a stress-free reference temperature $ T_{\\mathrm{ref}} $, and a transient temperature history $ T(t) $. Assume no plasticity, no creep, and no viscoelasticity. Treat the substrate as semi-infinite so that its in-plane strain is fully imposed on the film.\n\nCompute the extrinsic film stress $ \\sigma(t) $ over the specified time windows for each test case, and report a single scalar per case equal to the maximum absolute value of $ |\\sigma(t)| $ attained over the stated time interval. Express all reported stresses in megapascal (MPa) as floats rounded to six decimal places. Angles are not involved. Temperatures are in kelvin (K). Moduli are given in gigapascal (GPa). Coefficients of thermal expansion are in $ \\mathrm{K}^{-1} $. Poisson’s ratio is dimensionless. Time is in seconds (s).\n\nTest suite (four cases):\n- Case A (general heating, moderate temperature dependence):\n  - $ T_{\\mathrm{ref}} = 300\\,\\mathrm{K} $.\n  - $ T(t) = \\begin{cases} 300 + 50 t  \\text{for } 0 \\le t \\le 8 \\\\ 700  \\text{for } 8  t \\le 20 \\end{cases} $.\n  - $ E_f(T) = 170\\,\\mathrm{GPa}\\,\\big(1 - 2\\times 10^{-4}\\,(T - 300)\\big) $.\n  - $ \\nu_f(T) = 0.23 + 5\\times 10^{-5}\\,(T - 300) $.\n  - $ \\alpha_f(T) = 2.5\\times 10^{-6} + 1.0\\times 10^{-9}\\,(T - 300) + 2.0\\times 10^{-12}\\,(T - 300)^2 $.\n  - $ \\alpha_s(T) = 3.0\\times 10^{-6} + 4.0\\times 10^{-9}\\,(T - 300) $.\n  - Time window: $ t \\in [0,20]\\,\\mathrm{s} $.\n\n- Case B (edge case with no mismatch):\n  - $ T_{\\mathrm{ref}} = 300\\,\\mathrm{K} $.\n  - $ T(t) = \\begin{cases} 300 + 40 t  \\text{for } 0 \\le t \\le 10 \\\\ 700  \\text{for } 10  t \\le 20 \\end{cases} $.\n  - $ E_f(T) = 160\\,\\mathrm{GPa}\\,\\big(1 - 1.5\\times 10^{-4}\\,(T - 300)\\big) $.\n  - $ \\nu_f(T) = 0.26 + 4.0\\times 10^{-5}\\,(T - 300) $.\n  - $ \\alpha_f(T) = 2.8\\times 10^{-6} + 2.0\\times 10^{-9}\\,(T - 300) $.\n  - $ \\alpha_s(T) = 2.8\\times 10^{-6} + 2.0\\times 10^{-9}\\,(T - 300) $.\n  - Time window: $ t \\in [0,20]\\,\\mathrm{s} $.\n\n- Case C (temperature step):\n  - $ T_{\\mathrm{ref}} = 300\\,\\mathrm{K} $.\n  - $ T(t) = \\begin{cases} 300  \\text{for } 0 \\le t \\le 10 \\\\ 800  \\text{for } 10  t \\le 20 \\end{cases} $.\n  - $ E_f(T) = 110\\,\\mathrm{GPa}\\,\\big(1 - 3.0\\times 10^{-4}\\,(T - 300)\\big) $.\n  - $ \\nu_f(T) = 0.28 + 1.0\\times 10^{-4}\\,(T - 300) $.\n  - $ \\alpha_f(T) = 4.0\\times 10^{-6} + 1.5\\times 10^{-9}\\,(T - 300) $.\n  - $ \\alpha_s(T) = 2.6\\times 10^{-6} + 3.5\\times 10^{-9}\\,(T - 300) $.\n  - Time window: $ t \\in [0,20]\\,\\mathrm{s} $.\n\n- Case D (cooling from high reference temperature):\n  - $ T_{\\mathrm{ref}} = 800\\,\\mathrm{K} $.\n  - $ T(t) = \\begin{cases} 800 - 50 t  \\text{for } 0 \\le t \\le 10 \\\\ 300  \\text{for } 10  t \\le 20 \\end{cases} $.\n  - $ E_f(T) = 200\\,\\mathrm{GPa}\\,\\big(1 - 1.5\\times 10^{-4}\\,(T - 300)\\big) $.\n  - $ \\nu_f(T) = 0.22 + 8.0\\times 10^{-5}\\,(T - 300) $.\n  - $ \\alpha_f(T) = 2.2\\times 10^{-6} + 0.8\\times 10^{-9}\\,(T - 300) $.\n  - $ \\alpha_s(T) = 3.2\\times 10^{-6} + 1.5\\times 10^{-9}\\,(T - 300) $.\n  - Time window: $ t \\in [0,20]\\,\\mathrm{s} $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D]$), where each entry is the maximum absolute extrinsic stress value in $ \\mathrm{MPa} $ for the corresponding case, rounded to six decimal places.",
            "solution": "The user wants to solve for the time-dependent extrinsic stress in a thin film.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **System**: A thin, isotropic semiconductor film is bonded to a thick substrate.\n-   **Physics**: The problem is governed by linear thermoelasticity under assumptions of small strain, perfect bonding, and negligible intrinsic stress. The film is in a state of equi-biaxial in-plane stress.\n-   **Objective**: Compute the time evolution of extrinsic thermoelastic stress $ \\sigma(t) $ and report the maximum absolute value $ \\max|\\sigma(t)| $ over a given time window for four test cases.\n-   **Fundamental Equations**:\n    1.  Kinematics: Total strain $ \\varepsilon = \\varepsilon^{\\mathrm{mech}} + \\varepsilon^{\\mathrm{th}} $.\n    2.  Thermal strain: $ \\varepsilon^{\\mathrm{th}} = \\int_{T_{\\mathrm{ref}}}^{T} \\alpha(\\theta)\\,\\mathrm{d}\\theta $.\n    3.  Constitutive law: For equi-biaxial plane stress, use the biaxial modulus at the instantaneous temperature.\n-   **Inputs**:\n    -   Temperature-dependent film modulus: $ E_f(T) $\n    -   Temperature-dependent film Poisson’s ratio: $ \\nu_f(T) $\n    -   Temperature-dependent film CTE: $ \\alpha_f(T) $\n    -   Temperature-dependent substrate CTE: $ \\alpha_s(T) $\n    -   Stress-free reference temperature: $ T_{\\mathrm{ref}} $\n    -   Transient temperature history: $ T(t) $\n-   **Assumptions**: No plasticity, creep, or viscoelasticity. The substrate is semi-infinite.\n-   **Units**: Temperature in kelvin (K), moduli in gigapascal (GPa), CTE in $ \\mathrm{K}^{-1} $, time in seconds (s). Final stress to be reported in megapascal (MPa).\n-   **Test Cases**: Four specific cases (A, B, C, D) are provided with explicit functions for $T(t)$, $E_f(T)$, $\\nu_f(T)$, $\\alpha_f(T)$, $\\alpha_s(T)$, and defined values for $T_{\\mathrm{ref}}$ and the time window.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is based on the standard theory of linear thermoelasticity, a cornerstone of solid mechanics and materials science. The concepts of thermal strain, mismatch strain, and a temperature-dependent biaxial modulus are well-established and routinely applied in modeling semiconductor and thin-film stresses. The provided material property functions (polynomials in temperature) are common and physically reasonable approximations. The problem is scientifically sound.\n-   **Well-Posed**: All necessary information is provided to establish a unique stress history $ \\sigma(t) $. The objective, finding the maximum absolute stress over a specified interval, is a well-defined mathematical problem.\n-   **Objective**: The problem is formulated with precise mathematical definitions and objective physical principles. There is no ambiguity or subjectivity.\n-   **Completeness and Consistency**: The problem is self-contained. All required functions, parameters, and boundary conditions (kinematic constraint from the substrate) are specified. The units are stated and consistent, although care must be taken with conversions (GPa to MPa). There are no contradictions.\n-   **Feasibility and Realism**: The scenario and parameter values are realistic for semiconductor manufacturing processes. Transient thermal annealing and the resulting thermo-mechanical stresses are critical concerns in the industry.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, and complete. A solution will be derived and implemented.\n\n### Derivation and Solution\n\nThe derivation of the extrinsic film stress $ \\sigma(t) $ proceeds from the fundamental principles provided.\n\n1.  **Kinematic Constraint**: The thin film is perfectly bonded to a much thicker substrate. Therefore, the total in-plane strain of the film, $ \\varepsilon_{\\mathrm{film}}^{\\mathrm{total}} $, is constrained to be equal to the free thermal strain of the substrate, $ \\varepsilon_{\\mathrm{sub}}^{\\mathrm{th}} $. Since the system is isotropic and the thermal load is uniform, the strains are equal in all in-plane directions. We can write this scalar relationship as:\n    $$ \\varepsilon_{\\mathrm{film}}^{\\mathrm{total}}(t) = \\varepsilon_{\\mathrm{sub}}^{\\mathrm{th}}(t) $$\n\n2.  **Strain Decomposition**: The total strain in the film is the linear superposition of its mechanical strain $ \\varepsilon_{\\mathrm{film}}^{\\mathrm{mech}} $ (which causes stress) and its own free thermal strain $ \\varepsilon_{\\mathrm{film}}^{\\mathrm{th}} $:\n    $$ \\varepsilon_{\\mathrm{film}}^{\\mathrm{total}}(t) = \\varepsilon_{\\mathrm{film}}^{\\mathrm{mech}}(t) + \\varepsilon_{\\mathrm{film}}^{\\mathrm{th}}(t) $$\n\n3.  **Mechanical Strain**: By combining the first two points, we can isolate the mechanical strain in the film. This strain represents the mismatch between the film's natural thermal expansion and the expansion imposed by the substrate.\n    $$ \\varepsilon_{\\mathrm{film}}^{\\mathrm{mech}}(t) = \\varepsilon_{\\mathrm{film}}^{\\mathrm{total}}(t) - \\varepsilon_{\\mathrm{film}}^{\\mathrm{th}}(t) = \\varepsilon_{\\mathrm{sub}}^{\\mathrm{th}}(t) - \\varepsilon_{\\mathrm{film}}^{\\mathrm{th}}(t) $$\n\n4.  **Thermal Strain Formulation**: The thermal strain for a material (film or substrate) is the integral of its temperature-dependent coefficient of thermal expansion (CTE), $ \\alpha(\\theta) $, over the temperature path from a stress-free reference temperature $ T_{\\mathrm{ref}} $ to the current temperature $ T(t) $.\n    $$ \\varepsilon^{\\mathrm{th}}(t) = \\int_{T_{\\mathrm{ref}}}^{T(t)} \\alpha(\\theta) \\, \\mathrm{d}\\theta $$\n    Substituting this into the expression for mechanical strain gives the mismatch strain:\n    $$ \\varepsilon_{\\mathrm{film}}^{\\mathrm{mech}}(t) = \\int_{T_{\\mathrm{ref}}}^{T(t)} \\alpha_s(\\theta) \\, \\mathrm{d}\\theta - \\int_{T_{\\mathrm{ref}}}^{T(t)} \\alpha_f(\\theta) \\, \\mathrm{d}\\theta = \\int_{T_{\\mathrm{ref}}}^{T(t)} \\left( \\alpha_s(\\theta) - \\alpha_f(\\theta) \\right) \\, \\mathrm{d}\\theta $$\n\n5.  **Constitutive Relation (Stress-Strain)**: The problem states the film is under equi-biaxial plane stress ($ \\sigma_{xx} = \\sigma_{yy} = \\sigma $, $ \\sigma_{zz} = 0 $). For an isotropic linear elastic material, the in-plane mechanical strain $ \\varepsilon^{\\mathrm{mech}} $ is related to the in-plane stress $ \\sigma $ by:\n    $$ \\varepsilon^{\\mathrm{mech}} = \\frac{1}{E} \\left[ \\sigma - \\nu (\\sigma + 0) \\right] = \\frac{1-\\nu}{E} \\sigma $$\n    Solving for stress $ \\sigma $ yields:\n    $$ \\sigma = \\frac{E}{1-\\nu} \\varepsilon^{\\mathrm{mech}} = M \\varepsilon^{\\mathrm{mech}} $$\n    where $ M(T) = E(T)/(1-\\nu(T)) $ is the biaxial modulus, evaluated at the instantaneous temperature $ T(t) $.\n\n6.  **Final Expression for Stress**: Combining the results, we obtain the complete expression for the time-dependent extrinsic stress in the film:\n    $$ \\sigma(t) = \\frac{E_f(T(t))}{1 - \\nu_f(T(t))} \\int_{T_{\\mathrm{ref}}}^{T(t)} \\left( \\alpha_s(\\theta) - \\alpha_f(\\theta) \\right) \\, \\mathrm{d}\\theta $$\n\n### Computational Implementation\n\nTo compute the result for each test case, the following steps are taken:\n1.  **Analytical Integration**: The CTE functions $ \\alpha_s(T) $ and $ \\alpha_f(T) $ are given as polynomials in $ (T-300) $. Their difference, $ \\Delta\\alpha(T) = \\alpha_s(T) - \\alpha_f(T) $, is also a polynomial. The integral $ \\int \\Delta\\alpha(\\theta) \\, \\mathrm{d}\\theta $ can be computed analytically, resulting in a primitive function, say $ I(T) $. The definite integral is then simply $ I(T(t)) - I(T_{\\mathrm{ref}}) $.\n2.  **Numerical Maximization**: The final stress function $ \\sigma(t) $ is a complex composition of functions. To find the maximum absolute value $ \\max|\\sigma(t)| $ over the time window $ [t_{\\mathrm{start}}, t_{\\mathrm{end}}] $, a numerical approach is most robust. The time interval is discretized into a large number of points. At each point $ t_i $, the temperature $ T(t_i) $ is calculated, followed by the material properties $ E_f(T(t_i)) $, $ \\nu_f(T(t_i)) $, and the mismatch strain. These are combined to compute $ \\sigma(t_i) $. The maximum of the absolute values of the computed stresses is then found.\n3.  **Unit Conversion**: The film modulus $ E_f $ is given in GPa. It is converted to MPa by multiplying by $ 1000 $, ensuring the final stress is in MPa as required.\n\nThis methodology is applied to each of the four test cases provided. For Case B, since $ \\alpha_s(T) = \\alpha_f(T) $, the integrand is zero, leading to zero mismatch strain and zero stress for all time.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum absolute extrinsic stress in a thin film for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {\n            \"T_ref\": 300.0,\n            \"T_func\": lambda t: 300.0 + 50.0 * t if 0.0 = t = 8.0 else 700.0,\n            \"Ef_GPa_func\": lambda T: 170.0 * (1.0 - 2.0e-4 * (T - 300.0)),\n            \"nu_f_func\": lambda T: 0.23 + 5.0e-5 * (T - 300.0),\n            \"alpha_f_func\": lambda T: 2.5e-6 + 1.0e-9 * (T - 300.0) + 2.0e-12 * (T - 300.0)**2,\n            \"alpha_s_func\": lambda T: 3.0e-6 + 4.0e-9 * (T - 300.0),\n            \"time_window\": [0.0, 20.0],\n        },\n        # Case B\n        {\n            \"T_ref\": 300.0,\n            \"T_func\": lambda t: 300.0 + 40.0 * t if 0.0 = t = 10.0 else 700.0,\n            \"Ef_GPa_func\": lambda T: 160.0 * (1.0 - 1.5e-4 * (T - 300.0)),\n            \"nu_f_func\": lambda T: 0.26 + 4.0e-5 * (T - 300.0),\n            \"alpha_f_func\": lambda T: 2.8e-6 + 2.0e-9 * (T - 300.0),\n            \"alpha_s_func\": lambda T: 2.8e-6 + 2.0e-9 * (T - 300.0),\n            \"time_window\": [0.0, 20.0],\n        },\n        # Case C\n        {\n            \"T_ref\": 300.0,\n            \"T_func\": lambda t: 300.0 if 0.0 = t = 10.0 else 800.0,\n            \"Ef_GPa_func\": lambda T: 110.0 * (1.0 - 3.0e-4 * (T - 300.0)),\n            \"nu_f_func\": lambda T: 0.28 + 1.0e-4 * (T - 300.0),\n            \"alpha_f_func\": lambda T: 4.0e-6 + 1.5e-9 * (T - 300.0),\n            \"alpha_s_func\": lambda T: 2.6e-6 + 3.5e-9 * (T - 300.0),\n            \"time_window\": [0.0, 20.0],\n        },\n        # Case D\n        {\n            \"T_ref\": 800.0,\n            \"T_func\": lambda t: 800.0 - 50.0 * t if 0.0 = t = 10.0 else 300.0,\n            \"Ef_GPa_func\": lambda T: 200.0 * (1.0 - 1.5e-4 * (T - 300.0)),\n            \"nu_f_func\": lambda T: 0.22 + 8.0e-5 * (T - 300.0),\n            \"alpha_f_func\": lambda T: 2.2e-6 + 0.8e-9 * (T - 300.0),\n            \"alpha_s_func\": lambda T: 3.2e-6 + 1.5e-9 * (T - 300.0),\n            \"time_window\": [0.0, 20.0],\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Define T_prime = T - 300, as all polynomials are expanded around 300 K.\n        T0 = 300.0\n\n        # Coefficients for delta_alpha(T) = alpha_s(T) - alpha_f(T) = c0 + c1*T_prime + c2*T_prime^2\n        # We manually derive these from the given functions for each case.\n        # This is equivalent to evaluating (alpha_s(T0) - alpha_f(T0)), etc.\n        T_prime_test = 1.0 # A non-zero value to extract coeffs\n        \n        d_alpha_at_T0 = case[\"alpha_s_func\"](T0) - case[\"alpha_f_func\"](T0)\n        d_alpha_at_T0_plus_1 = case[\"alpha_s_func\"](T0 + T_prime_test) - case[\"alpha_f_func\"](T0 + T_prime_test)\n        d_alpha_at_T0_minus_1 = case[\"alpha_s_func\"](T0 - T_prime_test) - case[\"alpha_f_func\"](T0 - T_prime_test)\n        \n        c0 = d_alpha_at_T0\n        c1 = (d_alpha_at_T0_plus_1 - d_alpha_at_T0_minus_1) / (2.0 * T_prime_test)\n        c2 = (d_alpha_at_T0_plus_1 - 2*d_alpha_at_T0 + d_alpha_at_T0_minus_1) / (2.0 * T_prime_test**2)\n        \n        # Primitive function for the integral of delta_alpha w.r.t. T, expressed in T_prime\n        def indef_integral_func(T_prime):\n            return c0 * T_prime + (c1 / 2.0) * T_prime**2 + (c2 / 3.0) * T_prime**3\n\n        T_ref_prime = case[\"T_ref\"] - T0\n        integral_at_ref = indef_integral_func(T_ref_prime)\n\n        def epsilon_mismatch_func(T):\n            T_prime = T - T0\n            return indef_integral_func(T_prime) - integral_at_ref\n\n        # Time discretization for numerical maximization\n        t_start, t_end = case[\"time_window\"]\n        time_points = np.linspace(t_start, t_end, 20001)\n\n        max_abs_stress = 0.0\n\n        if np.allclose([c0, c1, c2], 0): # Optimization for zero mismatch case\n            max_abs_stress = 0.0\n        else:\n            # Vectorized calculation for efficiency\n            T_values = np.vectorize(case[\"T_func\"])(time_points)\n            \n            Ef_MPa_values = np.vectorize(case[\"Ef_GPa_func\"])(T_values) * 1000.0\n            nu_f_values = np.vectorize(case[\"nu_f_func\"])(T_values)\n            epsilon_values = np.vectorize(epsilon_mismatch_func)(T_values)\n\n            biaxial_modulus_MPa_values = Ef_MPa_values / (1.0 - nu_f_values)\n            stress_values = biaxial_modulus_MPa_values * epsilon_values\n            \n            max_abs_stress = np.max(np.abs(stress_values))\n        \n        results.append(round(max_abs_stress, 6))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world process modeling often requires integrating multiple physical phenomena. This advanced practice challenges you to build a coupled model that simulates both the evolution of an intrinsic stress component and the concurrent generation of an extrinsic one. By linking a model for microstructural grain growth to the relaxation of eigenstrain, and superimposing the effects of thermal mismatch, you will predict the total stress history in a thin film during annealing, demonstrating how different stress sources interact and evolve in a dynamic process environment .",
            "id": "4133974",
            "problem": "Consider a thin polycrystalline silicon (poly-Si) film rigidly constrained by a much thicker substrate, undergoing an annealing schedule that induces abnormal grain growth and microstructural relaxation. The in-plane stress is decomposed into an intrinsic component driven by microstructural eigenstrain and an extrinsic component driven by thermal expansion mismatch. The task is to derive, implement, and evaluate a coupled model that begins from fundamental principles and produces the total in-plane biaxial stress as a function of time. The final numerical answers must be expressed in megapascals (MPa).\n\nFundamental base and definitions:\n- Grain boundary migration is curvature-driven with interface normal velocity given by $v = M_b \\gamma \\kappa$, where $M_b$ is the grain boundary mobility, $\\gamma$ is the grain boundary energy per unit area, and $\\kappa$ is the mean curvature. For equiaxed grains represented by a characteristic grain size $G(t)$, a curvature scaling $\\kappa \\sim 1/G(t)$ is used. Abnormal growth can be phenomenologically accounted for by including a stabilizing length scale $G_c$ that represents the effect of matrix pinning, resulting in an effective driving term that vanishes as $G(t) \\to G_c$.\n- The intrinsic stress arises from an eigenstrain $\\varepsilon^*(t)$ that represents a stress-free strain sourced by microstructural processes (e.g., defect annihilation and grain boundary area reduction). The evolution of $\\varepsilon^*(t)$ is modeled by a first-order kinetics with a rate proportional to the instantaneous grain boundary area density, which scales inversely with grain size $G(t)$. This ties microstructural relaxation to abnormal grain growth.\n- The extrinsic stress arises from thermal expansion mismatch between the film and substrate, characterized by coefficients of thermal expansion $\\alpha_f$ (film) and $\\alpha_s$ (substrate), and a prescribed temperature history $T(t)$.\n- For a thin film constrained in-plane and free in the thickness direction, the appropriate constitutive relation uses the biaxial modulus $M_f = E_f/(1 - \\nu_f)$, where $E_f$ is Young’s modulus and $\\nu_f$ is Poisson’s ratio of the film. The in-plane mechanical stress under zero total in-plane strain is $\\sigma(t) = -M_f \\left(\\varepsilon_{\\text{th}}(t) + \\varepsilon^*(t)\\right)$, where $\\varepsilon_{\\text{th}}(t)$ is the thermal mismatch strain.\n\nModel formulation to be implemented:\n1. Hillert-type abnormal grain growth law. Starting from $v = M_b \\gamma \\kappa$ with $\\kappa \\sim 1/G(t)$ and including a stabilization scale $G_c$, derive and implement a growth law of the separable ordinary differential equation form\n   $$\\frac{dG}{dt} = m\\left(\\frac{1}{G(t)} - \\frac{1}{G_c}\\right),$$\n   with $m$ a kinetic coefficient that aggregates $M_b \\gamma$ into an effective parameter (units of length squared per time). The initial condition is $G(0) = G_0$.\n2. Eigenstrain evolution tied to grain boundary area density. Modeling first-order relaxation towards an asymptote $\\varepsilon^*_\\infty$ with a rate proportional to relative boundary area density gives\n   $$\\frac{d\\varepsilon^*}{dt} = -k_0 \\frac{G_0}{G(t)}\\left(\\varepsilon^*(t) - \\varepsilon^*_\\infty\\right),$$\n   with $k_0$ a kinetics parameter and initial condition $\\varepsilon^*(0) = \\varepsilon^*_0$.\n3. Thermal history and extrinsic strain. A piecewise linear annealing schedule is defined by a ramp and hold:\n   $$T(t) = \\begin{cases}\n   T_0 + \\left(T_a - T_0\\right)\\frac{t}{t_r},  0 \\le t \\le t_r,\\\\\n   T_a,  t_r  t \\le t_r + t_h,\n   \\end{cases}$$\n   with thermal mismatch strain\n   $$\\varepsilon_{\\text{th}}(t) = \\left(\\alpha_f - \\alpha_s\\right)\\left(T(t) - T_0\\right).$$\n4. Stress composition using the biaxial modulus:\n   $$\\sigma(t) = -\\frac{E_f}{1 - \\nu_f}\\left(\\varepsilon_{\\text{th}}(t) + \\varepsilon^*(t)\\right).$$\n\nImplementation requirements:\n- Implement a numerical integrator to solve the coupled system for $G(t)$ and $\\varepsilon^*(t)$ from $t = 0$ to $t = t_m$, where $t_m = t_r + t_h$.\n- Use the final values $G(t_m)$ and $\\varepsilon^*(t_m)$ to compute $\\sigma(t_m)$ in megapascals (MPa).\n- Express the final numerical answers in MPa, rounded to three decimal places.\n\nTest suite:\nProvide results for the following three parameter sets, which cover a general case, a boundary condition case, and a microstructural edge case. In all cases, the answer must be reported at $t_m = t_r + t_h$.\n\nUnits: grain sizes in micrometers ($\\mu\\mathrm{m}$), moduli in gigapascals (GPa), thermal expansion coefficients in per kelvin ($\\mathrm{K}^{-1}$), temperatures in kelvin (K), time in seconds (s), stress in megapascals (MPa).\n\n- Test Case A (general case):\n  - $G_0 = 0.20\\,\\mu\\mathrm{m}$, $G_c = 2.00\\,\\mu\\mathrm{m}$, $m = 0.05\\,\\mu\\mathrm{m}^2/\\mathrm{s}$.\n  - $k_0 = 1.5\\times 10^{-4}\\,\\mathrm{s}^{-1}$, $\\varepsilon^*_0 = 0.0030$, $\\varepsilon^*_\\infty = 0.0000$.\n  - $E_f = 160\\,\\mathrm{GPa}$, $\\nu_f = 0.22$.\n  - $\\alpha_f = 2.6\\times 10^{-6}\\,\\mathrm{K}^{-1}$, $\\alpha_s = 0.5\\times 10^{-6}\\,\\mathrm{K}^{-1}$.\n  - $T_0 = 300\\,\\mathrm{K}$, $T_a = 1000\\,\\mathrm{K}$, $t_r = 1800\\,\\mathrm{s}$, $t_h = 1800\\,\\mathrm{s}$.\n\n- Test Case B (boundary condition with zero extrinsic mismatch):\n  - Same as Test Case A, except $\\alpha_f = 2.6\\times 10^{-6}\\,\\mathrm{K}^{-1}$ and $\\alpha_s = 2.6\\times 10^{-6}\\,\\mathrm{K}^{-1}$.\n\n- Test Case C (edge case with no abnormal growth and slow kinetics):\n  - $G_0 = 0.20\\,\\mu\\mathrm{m}$, $G_c = 0.20\\,\\mu\\mathrm{m}$, $m = 0.005\\,\\mu\\mathrm{m}^2/\\mathrm{s}$.\n  - $k_0 = 1.5\\times 10^{-4}\\,\\mathrm{s}^{-1}$, $\\varepsilon^*_0 = 0.0030$, $\\varepsilon^*_\\infty = 0.0000$.\n  - $E_f = 160\\,\\mathrm{GPa}$, $\\nu_f = 0.22$.\n  - $\\alpha_f = 2.6\\times 10^{-6}\\,\\mathrm{K}^{-1}$, $\\alpha_s = 0.5\\times 10^{-6}\\,\\mathrm{K}^{-1}$.\n  - $T_0 = 300\\,\\mathrm{K}$, $T_a = 1000\\,\\mathrm{K}$, $t_r = 1800\\,\\mathrm{s}$, $t_h = 1800\\,\\mathrm{s}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$), where each $result_i$ is the total stress $\\sigma(t_m)$ in MPa rounded to three decimal places for Test Cases A, B, and C, respectively.",
            "solution": "The user wants a solution for a problem.\nI have successfully validated the problem. I will now solve it.\n\nThe problem requires the calculation of the total in-plane biaxial stress $\\sigma(t)$ in a thin polycrystalline silicon film at the end of a specified annealing schedule. This is accomplished by modeling the coupled evolution of the film's microstructure, represented by the average grain size $G(t)$, and its intrinsic stress relaxation, represented by an eigenstrain $\\varepsilon^*(t)$. The total stress is a superposition of this intrinsic component and an extrinsic component due to thermal mismatch with the substrate.\n\nThe core of the problem lies in solving a system of two coupled, first-order ordinary differential equations (ODEs). The state of the system at any time $t$ can be described by a state vector $\\mathbf{y}(t) = [G(t), \\varepsilon^*(t)]^T$. The governing equations for the rates of change of these state variables are given as:\n\n$1$. **Grain Growth Law:** The evolution of the average grain size $G(t)$ is described by a Hillert-type model for abnormal grain growth, which includes a driving force from grain boundary curvature (proportional to $1/G(t)$) and a pinning effect that introduces a stabilization grain size $G_c$. The resulting ODE is:\n$$\n\\frac{dG}{dt} = m\\left(\\frac{1}{G(t)} - \\frac{1}{G_c}\\right)\n$$\nwith the initial condition $G(0) = G_0$. The parameter $m$ is a kinetic coefficient for grain growth.\n\n$2$. **Eigenstrain Evolution:** The evolution of the intrinsic eigenstrain $\\varepsilon^*(t)$ is modeled as a first-order relaxation process. The rate of relaxation is proportional to the grain boundary area density, which scales as $1/G(t)$, coupling the mechanical relaxation to the microstructural evolution. The ODE is:\n$$\n\\frac{d\\varepsilon^*}{dt} = -k_0 \\frac{G_0}{G(t)}\\left(\\varepsilon^*(t) - \\varepsilon^*_\\infty\\right)\n$$\nwith the initial condition $\\varepsilon^*(0) = \\varepsilon^*_0$. Here, $k_0$ is a rate constant and $\\varepsilon^*_\\infty$ is the asymptotic value of the eigenstrain after complete relaxation.\n\nThis system of ODEs, $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$, is non-linear and coupled, necessitating a numerical solution. We will solve this initial value problem over the time interval $[0, t_m]$, where $t_m = t_r + t_h$ is the total duration of the annealing process. For this task, a robust numerical integration method is appropriate. The `solve_ivp` function from the SciPy library, which implements adaptive Runge-Kutta methods, is an excellent choice.\n\nThe procedure to find the final stress $\\sigma(t_m)$ for each test case is as follows:\n\nFirst, we define the function that computes the derivatives, $\\mathbf{f}(t, \\mathbf{y}) = [dG/dt, d\\varepsilon^*/dt]^T$, using the given parameters for a specific test case.\n\nSecond, we use `solve_ivp` to integrate the ODE system from the initial state $\\mathbf{y}(0) = [G_0, \\varepsilon^*_0]^T$ at $t=0$ to the final time $t_m$. This yields the final state of the film's microstructure and eigenstrain, $\\mathbf{y}(t_m) = [G(t_m), \\varepsilon^*(t_m)]^T$.\n\nThird, we calculate the extrinsic thermal strain component $\\varepsilon_{\\text{th}}(t_m)$. The temperature history $T(t)$ is a piecewise linear function. At the final time $t_m = t_r + t_h$, the process is in the hold phase, so the temperature is $T(t_m) = T_a$. The thermal strain is then calculated relative to the initial temperature $T_0$:\n$$\n\\varepsilon_{\\text{th}}(t_m) = (\\alpha_f - \\alpha_s)(T(t_m) - T_0) = (\\alpha_f - \\alpha_s)(T_a - T_0)\n$$\n\nFourth, we calculate the total stress. For a thin film under biaxial strain, the in-plane stress $\\sigma(t)$ is related to the total in-plane strain by the biaxial modulus of the film, $M_f$. The total strain is the sum of the thermal mismatch strain $\\varepsilon_{\\text{th}}(t)$ and the microstructural eigenstrain $\\varepsilon^*(t)$. The constitutive relation is:\n$$\n\\sigma(t) = -M_f \\left(\\varepsilon_{\\text{th}}(t) + \\varepsilon^*(t)\\right)\n$$\nwhere the biaxial modulus is $M_f = \\frac{E_f}{1 - \\nu_f}$. The parameters $E_f$ (Young's modulus) and $\\nu_f$ (Poisson's ratio) are given.\n\nFinally, we substitute the numerically computed value $\\varepsilon^*(t_m)$ and the calculated value of $\\varepsilon_{\\text{th}}(t_m)$ into the stress equation to find $\\sigma(t_m)$. The modulus $E_f$ is given in GPa, which means the resulting stress $\\sigma(t_m)$ will also be in GPa. A conversion factor of $1000$ is applied to express the final answer in MPa, as required. The entire procedure is encapsulated in a function that is called for each of the three test cases, and the results are formatted according to the problem specification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve for all test cases and print results.\n    \"\"\"\n\n    def solve_one_case(params):\n        \"\"\"\n        Solves the coupled ODE system for a single parameter set and calculates\n        the final stress.\n        \"\"\"\n        # Unpack parameters\n        G0 = params['G0']\n        Gc = params['Gc']\n        m = params['m']\n        k0 = params['k0']\n        eps_star_0 = params['eps_star_0']\n        eps_star_inf = params['eps_star_inf']\n        Ef = params['Ef']\n        nu_f = params['nu_f']\n        alpha_f = params['alpha_f']\n        alpha_s = params['alpha_s']\n        T0 = params['T0']\n        Ta = params['Ta']\n        tr = params['tr']\n        th = params['th']\n\n        # Total time of the annealing schedule\n        t_m = tr + th\n\n        # Define the system of ordinary differential equations (ODEs)\n        def derivs(t, y):\n            \"\"\"\n            Computes the derivative of the state vector [G, epsilon*].\n            \"\"\"\n            G, eps_star = y\n            \n            # ODE for grain growth G(t)\n            # This is stable for Gc > 0. For Gc=G0, dG/dt will start at 0.\n            dG_dt = m * (1.0 / G - 1.0 / Gc) if Gc > 0 else m / G\n            \n            # ODE for eigenstrain evolution epsilon*(t)\n            deps_star_dt = -k0 * (G0 / G) * (eps_star - eps_star_inf)\n            \n            return [dG_dt, deps_star_dt]\n\n        # Initial conditions for the state vector [G, epsilon*]\n        y0 = [G0, eps_star_0]\n        \n        # Time span for integration\n        t_span = [0, t_m]\n        \n        # Solve the ODE system using scipy's solve_ivp\n        # We only need the solution at the final time point t_m for efficiency.\n        sol = solve_ivp(\n            fun=derivs, \n            t_span=t_span, \n            y0=y0, \n            method='RK45', \n            t_eval=[t_m], \n            atol=1e-9,  # Absolute tolerance\n            rtol=1e-6   # Relative tolerance\n        )\n        \n        # Extract final values from the integration result\n        G_final = sol.y[0, 0]\n        eps_star_final = sol.y[1, 0]\n        \n        # Calculate final thermal properties\n        # At time t_m > t_r, the temperature T(t_m) is the anneal temperature Ta.\n        T_final = Ta\n        eps_th_final = (alpha_f - alpha_s) * (T_final - T0)\n        \n        # Calculate the biaxial modulus (in GPa, since Ef is in GPa)\n        M_f = Ef / (1.0 - nu_f)\n        \n        # Calculate final stress using the constitutive relation\n        # sigma = -M * (thermal_strain + eigenstrain)\n        sigma_gpa = -M_f * (eps_th_final + eps_star_final)\n        \n        # Convert stress from GPa to MPa\n        sigma_mpa = sigma_gpa * 1000.0\n        \n        return sigma_mpa\n\n    # Define the test cases from the problem statement.\n    test_case_A = {\n        'G0': 0.20, 'Gc': 2.00, 'm': 0.05,\n        'k0': 1.5e-4, 'eps_star_0': 0.0030, 'eps_star_inf': 0.0000,\n        'Ef': 160.0, 'nu_f': 0.22,\n        'alpha_f': 2.6e-6, 'alpha_s': 0.5e-6,\n        'T0': 300.0, 'Ta': 1000.0, 'tr': 1800.0, 'th': 1800.0\n    }\n\n    test_case_B = test_case_A.copy()\n    test_case_B.update({\n        'alpha_f': 2.6e-6, 'alpha_s': 2.6e-6\n    })\n\n    test_case_C = test_case_A.copy()\n    test_case_C.update({\n        'Gc': 0.20, 'm': 0.005\n    })\n    \n    test_cases = [test_case_A, test_case_B, test_case_C]\n\n    results = []\n    for case in test_cases:\n        result = solve_one_case(case)\n        # Format the result to three decimal places.\n        results.append(f\"{result:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}