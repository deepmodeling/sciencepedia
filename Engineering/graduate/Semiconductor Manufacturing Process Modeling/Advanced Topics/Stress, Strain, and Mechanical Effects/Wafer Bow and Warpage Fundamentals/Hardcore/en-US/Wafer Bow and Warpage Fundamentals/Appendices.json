{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of wafer bow analysis is the ability to relate the stress within a deposited thin film to the macroscopic curvature of the wafer. This first practice focuses on deriving the celebrated Stoney equation, which provides a simple yet powerful analytical link between film stress and substrate curvature under common processing conditions. By working through both the derivation from first principles and a direct numerical application, you will solidify your understanding of this fundamental relationship .",
            "id": "4178577",
            "problem": "A circular, isotropic silicon substrate of thickness $t_s$ carries a uniformly stressed, much thinner, isotropic film of thickness $t_f$ deposited on its top surface. The film has a uniform equi-biaxial residual stress $\\sigma_f$ (positive in tension). Assume small deflections, linear elasticity, and that $t_f \\ll t_s$ so that the neutral axis of bending remains effectively at the substrate mid-plane and the film’s contribution to the bending stiffness is negligible. The substrate Young’s modulus is $E_s$ and Poisson’s ratio is $\\nu_s$. Under these conditions the wafer adopts an equi-biaxial curvature $\\kappa$.\n\nStarting from classical plate bending for an isotropic plate and in-plane force/moment equilibrium for the film–substrate system, derive the relation between the wafer curvature $\\kappa$ and the film stress $\\sigma_f$ in terms of $E_s$, $\\nu_s$, $t_s$, and $t_f$ under the stated assumptions. Then evaluate numerically for\n- $E_s = 130\\ \\text{GPa}$,\n- $\\nu_s = 0.28$,\n- $t_s = 775\\ \\mu\\text{m}$,\n- $\\sigma_f = 300\\ \\text{MPa}$,\n- $t_f = 1\\ \\mu\\text{m}$.\n\nAdopt the sign convention that positive curvature $\\kappa > 0$ corresponds to the wafer bending so that the film side is concave (i.e., the wafer mid-surface bends with the substrate top surface in compression). Report both the curvature $\\kappa$ and the corresponding radius of curvature $R = 1/\\kappa$. Round your answers to four significant figures. Express the curvature in $\\text{m}^{-1}$ and the radius in $\\text{m}$. Finally, briefly comment on the sign of $\\kappa$ that would result from tensile versus compressive $\\sigma_f$ under this convention.",
            "solution": "The problem requires the derivation of the relationship between film stress and wafer curvature, known as the Stoney equation, under specific simplifying assumptions.\n\n**Derivation**\n\n1.  **Bending Moment from Film Stress**: A thin film of thickness $t_f$ with a uniform biaxial stress $\\sigma_f$ is deposited on a substrate of thickness $t_s$. The stress in the film generates a force per unit length, $F'$, acting at the interface. This force is given by:\n    $$F' = \\sigma_f t_f$$\n    Due to the assumption that $t_f \\ll t_s$, the neutral axis of bending for the film-substrate composite is assumed to be at the mid-plane of the substrate. The film force $F'$ acts at the top surface of the substrate, which is at a distance of approximately $t_s/2$ from the neutral axis. This force creates a bending moment per unit length, $M'$, given by:\n    $$M' = F' \\left(\\frac{t_s}{2}\\right) = \\frac{\\sigma_f t_f t_s}{2}$$\n    This moment is equi-biaxial, meaning it acts equally along any two orthogonal directions in the plane of the wafer.\n\n2.  **Moment-Curvature Relationship from Plate Theory**: According to classical plate theory for an isotropic material, the relationship between the applied bending moments per unit length ($M_x$, $M_y$) and the curvatures ($\\kappa_x$, $\\kappa_y$) is:\n    $$M_x = D (\\kappa_x + \\nu_s \\kappa_y)$$\n    $$M_y = D (\\kappa_y + \\nu_s \\kappa_x)$$\n    where $D$ is the flexural rigidity of the plate. For a plate of thickness $t_s$ with Young's modulus $E_s$ and Poisson's ratio $\\nu_s$, the flexural rigidity is:\n    $$D = \\frac{E_s t_s^3}{12(1-\\nu_s^2)}$$\n    The problem states the curvature is equi-biaxial, so $\\kappa_x = \\kappa_y = \\kappa$. Consequently, the bending moment must also be equi-biaxial, $M_x = M_y = M'$. Substituting this into the plate bending equation:\n    $$M' = D (\\kappa + \\nu_s \\kappa) = D \\kappa (1+\\nu_s)$$\n    Now, substitute the expression for $D$:\n    $$M' = \\frac{E_s t_s^3}{12(1-\\nu_s^2)} \\kappa (1+\\nu_s) = \\frac{E_s t_s^3}{12(1-\\nu_s)(1+\\nu_s)} \\kappa (1+\\nu_s)$$\n    $$M' = \\frac{E_s t_s^3}{12(1-\\nu_s)} \\kappa$$\n    This equation relates the internal bending moment in the substrate to its curvature. Note that the quantity $\\frac{E_s}{1-\\nu_s}$ is often referred to as the biaxial modulus of the substrate, $M_s$.\n\n3.  **Equating Moments**: The external moment generated by the film stress must be balanced by the internal restoring moment of the bent substrate. Therefore, we equate the two expressions for $M'$:\n    $$\\frac{\\sigma_f t_f t_s}{2} = \\frac{E_s t_s^3}{12(1-\\nu_s)} \\kappa$$\n    Solving for the curvature $\\kappa$:\n    $$\\kappa = \\frac{\\sigma_f t_f t_s}{2} \\cdot \\frac{12(1-\\nu_s)}{E_s t_s^3}$$\n    $$\\kappa = \\frac{6 \\sigma_f t_f (1-\\nu_s)}{E_s t_s^2}$$\n    This is the celebrated Stoney equation, which relates the wafer curvature to the film stress and the properties of the film and substrate.\n\n**Numerical Evaluation**\n\nThe given values must be converted to base SI units (meters, Pascals).\n-   $E_s = 130\\ \\text{GPa} = 130 \\times 10^9\\ \\text{Pa}$\n-   $\\nu_s = 0.28$\n-   $t_s = 775\\ \\mu\\text{m} = 775 \\times 10^{-6}\\ \\text{m}$\n-   $\\sigma_f = 300\\ \\text{MPa} = 300 \\times 10^6\\ \\text{Pa}$\n-   $t_f = 1\\ \\mu\\text{m} = 1 \\times 10^{-6}\\ \\text{m}$\n\nSubstitute these values into the derived formula for $\\kappa$:\n$$\\kappa = \\frac{6 (300 \\times 10^6) (1 \\times 10^{-6}) (1 - 0.28)}{(130 \\times 10^9) (775 \\times 10^{-6})^2}$$\n$$\\kappa = \\frac{6 \\times 300 \\times 10^6 \\times 10^{-6} \\times 0.72}{130 \\times 10^9 \\times (775^2 \\times 10^{-12})}$$\n$$\\kappa = \\frac{1800 \\times 0.72}{130 \\times 10^9 \\times 600625 \\times 10^{-12}} = \\frac{1296}{130 \\times 600625 \\times 10^{-3}}$$\n$$\\kappa = \\frac{1296}{78081.25} \\approx 0.0165979\\ \\text{m}^{-1}$$\nRounding to four significant figures, the curvature is:\n$$\\kappa \\approx 0.01660\\ \\text{m}^{-1}$$\n\nThe radius of curvature, $R$, is the reciprocal of the curvature $\\kappa$:\n$$R = \\frac{1}{\\kappa} = \\frac{1}{0.0165979\\ \\text{m}^{-1}} \\approx 60.2485\\ \\text{m}$$\nRounding to four significant figures, the radius of curvature is:\n$$R \\approx 60.25\\ \\text{m}$$\n\n**Comment on the Sign of $\\kappa$**\n\nThe derived relationship is $\\kappa = \\frac{6(1-\\nu_s)}{E_s} \\frac{\\sigma_f t_f}{t_s^2}$. In this expression, the material properties ($E_s$, $\\nu_s$) and geometric dimensions ($t_s$, $t_f$) are all positive quantities. Specifically, $0  \\nu_s  0.5$ for most engineering materials, so $(1-\\nu_s)$ is positive. Therefore, the sign of the curvature $\\kappa$ is directly determined by the sign of the film stress $\\sigma_f$.\n\n-   **Tensile Film Stress ($\\sigma_f > 0$)**: If the film stress is tensile, then $\\kappa > 0$. According to the problem's sign convention, this corresponds to the wafer bending such that the film side is concave. This is physically intuitive: a tensile film tries to contract, pulling the edges of the substrate upwards.\n-   **Compressive Film Stress ($\\sigma_f  0$)**: If the film stress is compressive, then $\\kappa  0$. This corresponds to the wafer bending such that the film side is convex (i.e., the center of the wafer bulges upwards). This is also intuitive: a compressive film tries to expand, pushing the substrate into a dome shape.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01660  60.25 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on the Stoney equation, we now explore one of the most common physical origins of film stress: thermal mismatch. During semiconductor manufacturing, temperature cycles are ubiquitous, and differences in the coefficient of thermal expansion ($\\alpha$) between the film and substrate induce significant stress. This exercise will guide you through calculating the biaxial thermal stress generated by a temperature change and then using it to predict the resulting wafer curvature, connecting thermodynamic properties to mechanical deformation .",
            "id": "4178619",
            "problem": "A thin copper film is deposited on a much thicker silicon wafer. After fabrication, the assembly is subjected to a uniform temperature change relative to its stress-free reference state. The following material and geometric properties are known and scientifically representative for semiconductor manufacturing:\n\n- Film (copper): Young's modulus $E_{f} = 110\\ \\text{GPa}$, Poisson's ratio $\\nu_{f} = 0.34$, thickness $t_{f} = 1.0\\ \\mu\\text{m}$.\n- Substrate (silicon): Young's modulus $E_{s} = 130\\ \\text{GPa}$, Poisson's ratio $\\nu_{s} = 0.28$, thickness $t_{s} = 775\\ \\mu\\text{m}$.\n- Coefficient of thermal expansion mismatch $\\Delta \\alpha = \\alpha_{f} - \\alpha_{s} = 16 \\times 10^{-6}\\ \\text{K}^{-1}$.\n- Temperature increase of the assembly relative to the stress-free reference $\\Delta T = 200\\ \\text{K}$.\n\nAssume perfect bonding, linear isotropic elasticity, equi-biaxial in-plane stress in the film, and that the film thickness is much smaller than the substrate thickness so that the Stoney limit applies. Use the following sign conventions: tensile in-plane stress is positive; curvature $\\kappa$ is defined as positive if the wafer center deflects away from the film side (the film side is convex). Starting from the constitutive relations of isotropic linear elasticity for plane stress and the classical moment–curvature relation for thin isotropic plates under equi-biaxial bending, derive the expression for the equi-biaxial thermal stress in the film caused by the constrained thermal mismatch and then the wafer curvature due to this stress. Compute the numerical values.\n\n- Express the thermal stress in $\\text{MPa}$ and round to four significant figures.\n- Express the curvature in $\\text{m}^{-1}$ and round to three significant figures.\n\nReport your final answer as two numbers in order $\\sigma_{f}$ (film stress), $\\kappa$ (curvature), following the rounding and unit instructions above.",
            "solution": "The solution will be derived in two parts. First, the equi-biaxial thermal stress in the copper film ($\\sigma_{f}$) will be derived and calculated. Second, the resulting wafer curvature ($\\kappa$) will be determined using the Stoney equation, paying careful attention to the sign conventions specified.\n\n**Part 1: Film Stress ($\\sigma_{f}$)**\n\nThe film is assumed to be in a state of equi-biaxial plane stress, meaning the in-plane stress components are equal, $\\sigma_{xx} = \\sigma_{yy} = \\sigma_{f}$, and the out-of-plane stress is zero, $\\sigma_{zz} = 0$. For a linear isotropic elastic material, the in-plane mechanical strains ($\\epsilon_{\\text{mech}}$) are related to the stresses by the constitutive equations:\n$$ \\epsilon_{xx, \\text{mech}} = \\frac{1}{E_{f}}[\\sigma_{xx} - \\nu_{f}(\\sigma_{yy} + \\sigma_{zz})] $$\n$$ \\epsilon_{yy, \\text{mech}} = \\frac{1}{E_{f}}[\\sigma_{yy} - \\nu_{f}(\\sigma_{xx} + \\sigma_{zz})] $$\nSubstituting $\\sigma_{xx} = \\sigma_{yy} = \\sigma_{f}$ and $\\sigma_{zz} = 0$, we find the mechanical strains are also equi-biaxial:\n$$ \\epsilon_{\\text{mech}} = \\epsilon_{xx, \\text{mech}} = \\epsilon_{yy, \\text{mech}} = \\frac{1}{E_{f}}(\\sigma_f - \\nu_f \\sigma_f) = \\frac{1-\\nu_f}{E_f} \\sigma_f $$\nThis relationship can be inverted to express stress as a function of mechanical strain:\n$$ \\sigma_f = \\frac{E_f}{1-\\nu_f} \\epsilon_{\\text{mech}} = M_f \\epsilon_{\\text{mech}} $$\nwhere $M_f = \\frac{E_f}{1-\\nu_f}$ is the biaxial modulus of the film.\n\nThe total strain in the film, $\\epsilon_{\\text{total}}$, is the sum of this mechanical strain and the free thermal strain, $\\epsilon_{\\text{th},f} = \\alpha_f \\Delta T$.\n$$ \\epsilon_{\\text{total}} = \\epsilon_{\\text{mech}} + \\epsilon_{\\text{th},f} = \\epsilon_{\\text{mech}} + \\alpha_f \\Delta T $$\nThe problem assumes perfect bonding between the film and the substrate, and that the substrate is much thicker than the film ($t_s \\gg t_f$). This is the \"Stoney limit,\" where the thick substrate acts as a rigid constraint, dictating the total strain of the composite structure. Therefore, the total strain in the film is forced to be equal to the free thermal strain of the substrate, $\\epsilon_{\\text{th},s} = \\alpha_s \\Delta T$.\n$$ \\epsilon_{\\text{total}} = \\epsilon_{\\text{th},s} = \\alpha_s \\Delta T $$\nEquating the two expressions for the total strain allows us to solve for the mechanical strain in the film:\n$$ \\alpha_s \\Delta T = \\epsilon_{\\text{mech}} + \\alpha_f \\Delta T $$\n$$ \\epsilon_{\\text{mech}} = (\\alpha_s - \\alpha_f) \\Delta T = -(\\alpha_f - \\alpha_s) \\Delta T = -\\Delta \\alpha \\Delta T $$\nFinally, we substitute this expression for the mechanical strain back into the stress-strain relationship to obtain the formula for the equi-biaxial thermal stress in the film:\n$$ \\sigma_f = M_f \\epsilon_{\\text{mech}} = \\frac{E_f}{1-\\nu_f} (-\\Delta \\alpha \\Delta T) $$\nNow, we compute the numerical value of the stress using the given parameters:\n- $E_{f} = 110\\ \\text{GPa} = 110 \\times 10^9\\ \\text{Pa}$\n- $\\nu_{f} = 0.34$\n- $\\Delta \\alpha = 16 \\times 10^{-6}\\ \\text{K}^{-1}$\n- $\\Delta T = 200\\ \\text{K}$\n\n$$ \\sigma_f = \\frac{110 \\times 10^9\\ \\text{Pa}}{1 - 0.34} \\times (-(16 \\times 10^{-6}\\ \\text{K}^{-1}) \\times 200\\ \\text{K}) $$\n$$ \\sigma_f = \\frac{110 \\times 10^9}{0.66} \\times (-3200 \\times 10^{-6})\\ \\text{Pa} $$\n$$ \\sigma_f = (1.66\\overline{6} \\times 10^{11}) \\times (-3.2 \\times 10^{-3})\\ \\text{Pa} $$\n$$ \\sigma_f = -5.33\\overline{3} \\times 10^8\\ \\text{Pa} = -533.\\overline{3}\\ \\text{MPa} $$\nThe negative sign indicates that the stress is compressive. This is expected, as the film has a higher coefficient of thermal expansion ($\\alpha_f > \\alpha_s$) and the temperature has increased ($\\Delta T > 0$), so the substrate constrains the film's expansion. Rounding to four significant figures, the film stress is $\\sigma_f = -533.3\\ \\text{MPa}$.\n\n**Part 2: Wafer Curvature ($\\kappa$)**\n\nThe stress in the thin film induces a bending moment in the substrate, causing it to curve. For a thin film on a thick substrate, this relationship is described by the Stoney equation. The classic Stoney equation relates curvature to film stress:\n$$ \\kappa = \\frac{6 \\sigma_f t_f (1-\\nu_s)}{E_s t_s^2} $$\nIt is critical to be precise about the sign convention. The problem states that \"curvature $\\kappa$ is defined as positive if the wafer center deflects away from the film side (the film side is convex)\".\nA compressive stress in the film ($\\sigma_f  0$) will cause it to expand relative to the substrate, forcing the structure to bend such that the film is on the outer, convex side. According to the problem's definition, this corresponds to a positive curvature ($\\kappa > 0$).\nConversely, a tensile stress ($\\sigma_f > 0$) would cause the film to contract, bending the wafer so the film is on the inner, concave side, corresponding to a negative curvature ($\\kappa  0$).\nTherefore, the curvature $\\kappa$ and the film stress $\\sigma_f$ must have opposite signs. The standard formula as written above implies they have the same sign. To align with the problem's explicit sign convention, we must introduce a negative sign:\n$$ \\kappa = - \\frac{6 \\sigma_f t_f (1-\\nu_s)}{E_s t_s^2} $$\nNow, we compute the numerical value of the curvature $\\kappa$ using the result for $\\sigma_f$ and the given substrate properties:\n- $\\sigma_f = -5.33\\overline{3} \\times 10^8\\ \\text{Pa}$\n- $t_{f} = 1.0\\ \\mu\\text{m} = 1.0 \\times 10^{-6}\\ \\text{m}$\n- $E_{s} = 130\\ \\text{GPa} = 130 \\times 10^9\\ \\text{Pa}$\n- $\\nu_{s} = 0.28$\n- $t_{s} = 775\\ \\mu\\text{m} = 775 \\times 10^{-6}\\ \\text{m}$\n\n$$ \\kappa = - \\frac{6 \\times (-5.33\\overline{3} \\times 10^8\\ \\text{Pa}) \\times (1.0 \\times 10^{-6}\\ \\text{m}) \\times (1 - 0.28)}{(130 \\times 10^9\\ \\text{Pa}) \\times (775 \\times 10^{-6}\\ \\text{m})^2} $$\n$$ \\kappa = \\frac{6 \\times (5.33\\overline{3} \\times 10^8) \\times (1.0 \\times 10^{-6}) \\times 0.72}{130 \\times 10^9 \\times (775^2 \\times 10^{-12})}\\ \\text{m}^{-1} $$\n$$ \\kappa = \\frac{2304}{130 \\times 10^9 \\times 600625 \\times 10^{-12}}\\ \\text{m}^{-1} $$\n$$ \\kappa = \\frac{2304}{78081.25}\\ \\text{m}^{-1} \\approx 0.029505\\ \\text{m}^{-1} $$\nAs expected, the compressive stress leads to a positive curvature. Rounding to three significant figures, the curvature is $\\kappa = 0.0295\\ \\text{m}^{-1}$.\n\nThe final answers are the film stress $\\sigma_f = -533.3\\ \\text{MPa}$ and the wafer curvature $\\kappa = 0.0295\\ \\text{m}^{-1}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -533.3  0.0295 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While the Stoney equation is an indispensable tool, it is an approximation based on the assumption of a very thin film with negligible stiffness. This advanced practice challenges you to move beyond this limit by developing a more complete model based on bilayer plate theory, similar to what is used in Finite Element Analysis (FEA). By comparing the results of this more rigorous model to the Stoney approximation, you will learn to quantify the error introduced by simplifying assumptions and appreciate the critical engineering task of selecting a model with the appropriate level of fidelity for a given problem .",
            "id": "4178608",
            "problem": "A circular crystalline silicon wafer of thickness $t_s$ carries a uniform, equi-biaxial residual stress $\\sigma_f$ in a silicon nitride (SiN$_x$) film of thickness $t_f$ deposited on one surface. Under the assumptions of small deflections, plane stress, and linear elasticity, the system bows into a nearly spherical shape with curvature $\\kappa$ that depends on the mismatch between the film’s eigenstrain and the substrate’s response. The classical thin-film limit known as the Stoney approximation provides an analytical prediction of the curvature by neglecting the film’s bending stiffness. However, in realistic semiconductor manufacturing settings, finite film stiffness can introduce a discrepancy from this approximation. In this problem, you will derive a model from first principles to compare the Stoney-based prediction to a numerical finite element analysis (FEA)-style discretization of the bilayer in the thickness direction, and then quantify the discrepancy attributable to finite film stiffness.\n\nUse fundamental mechanics of materials as the base: plane stress constitutive law $\\sigma = M \\,\\varepsilon$ with biaxial modulus $M = E/(1-\\nu)$, strain compatibility $\\varepsilon(z) = \\varepsilon_0 + \\kappa z$ (Kirchhoff–Love plate kinematics), and energy minimization under zero external force and moment. Treat the film’s residual stress as arising from a uniform eigenstrain $\\varepsilon^{*}$ confined to the film, so that if the film were free, it would carry stress $\\sigma_f = M_f \\,\\varepsilon^{*}$, where $M_f$ is the film’s biaxial modulus. The substrate has biaxial modulus $M_s$ and no eigenstrain.\n\nYou must:\n- Derive, from the stated base, the linear system for the unknown mid-plane strain $\\varepsilon_0$ and curvature $\\kappa$ by minimizing the total strain energy with respect to these degrees of freedom subject to zero resultant in-plane force and bending moment (no external loads).\n- Implement two curvature predictions:\n  1. A Stoney-based curvature $\\kappa_{\\text{Stoney}}$ that uses the thin-film approximation and the substrate biaxial modulus.\n  2. A numerical FEA-style curvature $\\kappa_{\\text{FEA}}$ by discretizing the thickness into layers, integrating modulus-weighted strain and eigenstrain terms to assemble the $2\\times 2$ system for $(\\varepsilon_0,\\kappa)$, and solving it exactly.\n- Quantify the discrepancy due to finite film stiffness by computing the decimal ratio $\\delta = (\\kappa_{\\text{FEA}} - \\kappa_{\\text{Stoney}})/\\kappa_{\\text{FEA}}$ for each case.\n- Also compute the spherical-cap bow (sagitta) at wafer edge radius $a$ as $w_{\\text{bow}} = \\kappa_{\\text{FEA}}\\,a^2/2$.\n\nExpress curvatures in $\\text{m}^{-1}$, stresses in $\\text{Pa}$, moduli in $\\text{Pa}$, thicknesses and radii in $\\text{m}$, and bow in $\\text{m}$. Return the discrepancy $\\delta$ as a decimal (not a percentage).\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four floats in the order $[\\kappa_{\\text{Stoney}}, \\kappa_{\\text{FEA}}, \\delta, w_{\\text{bow}}]$.\n\nUse the following test suite, covering typical, boundary, and edge cases. For silicon nitride and silicon, assume isotropic effective properties as specified.\n\nFor each case, parameters are $(t_f, t_s, \\sigma_f, E_f, \\nu_f, E_s, \\nu_s, a)$:\n1. Baseline thin film on $200\\ \\text{mm}$ wafer: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n2. Thicker film: $t_f = 5\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n3. Much thicker film: $t_f = 5.0\\times 10^{-5}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n4. Extremely thin film: $t_f = 1.0\\times 10^{-7}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n5. Zero stress edge case: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = 0.0\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n6. Modulus parity check: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.28$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n\nYour implementation must be general and use these inputs exactly to produce the required output format.",
            "solution": "The solution is derived from the first principles of continuum mechanics for a bilayer plate under internal stress.\n\n**1. Theoretical Framework**\nWe model the film-substrate system as a composite plate. A coordinate system is established with the origin $z=0$ at the mid-plane of the substrate. The substrate occupies the domain $z \\in [-t_s/2, t_s/2]$, and the film occupies $z \\in [t_s/2, t_s/2 + t_f]$.\n\nThe total strain $\\varepsilon(z)$ at any vertical position $z$ is given by the Kirchhoff-Love plate theory kinematics:\n$$ \\varepsilon(z) = \\varepsilon_0 + \\kappa z $$\nwhere $\\varepsilon_0$ is the strain at the reference plane ($z=0$) and $\\kappa$ is the uniform curvature of the plate.\n\nThe equi-biaxial stress $\\sigma(z)$ is related to the elastic strain $\\varepsilon_{el}(z)$ through the biaxial modulus $M(z) = E(z)/(1-\\nu(z))$. The total strain is the sum of elastic strain and any non-mechanical eigenstrain $\\varepsilon^*(z)$: $\\varepsilon(z) = \\varepsilon_{el}(z) + \\varepsilon^*(z)$. The stress is therefore:\n$$ \\sigma(z) = M(z) \\varepsilon_{el}(z) = M(z) [\\varepsilon(z) - \\varepsilon^*(z)] = M(z)[\\varepsilon_0 + \\kappa z - \\varepsilon^*(z)] $$\nThe eigenstrain $\\varepsilon^*(z)$ is zero in the substrate and uniform in the film, $\\varepsilon_f^* = \\sigma_f/M_f$, where $\\sigma_f$ is the given residual stress parameter.\n\n**2. Governing Equations from Energy Minimization**\nThe total strain energy per unit area, $U$, stored in the bilayer is:\n$$ U = \\frac{1}{2} \\int_{-t_s/2}^{t_s/2+t_f} \\sigma(z) \\varepsilon_{el}(z) dz = \\frac{1}{2} \\int_{-t_s/2}^{t_s/2+t_f} M(z)[\\varepsilon_0 + \\kappa z - \\varepsilon^*(z)]^2 dz $$\nFor a system in equilibrium with no external loads, the strain energy is minimized with respect to the kinematic degrees of freedom, $\\varepsilon_0$ and $\\kappa$.\n$$ \\frac{\\partial U}{\\partial \\varepsilon_0} = \\int M(z)[\\varepsilon_0 + \\kappa z - \\varepsilon^*(z)] dz = 0 $$\n$$ \\frac{\\partial U}{\\partial \\kappa} = \\int z M(z)[\\varepsilon_0 + \\kappa z - \\varepsilon^*(z)] dz = 0 $$\nThese two conditions correspond to the requirement that the net in-plane force resultant $N$ and the net bending moment resultant $M$ must both be zero.\n\n**3. General Matrix Formulation for $\\kappa_{\\text{FEA}}$**\nThe governing equations form a $2 \\times 2$ linear system for the unknowns $(\\varepsilon_0, \\kappa)$. We can rewrite the equations as:\n$$\n\\begin{pmatrix}\n\\int M(z)dz  \\int zM(z)dz \\\\\n\\int zM(z)dz  \\int z^2M(z)dz\n\\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_0 \\\\ \\kappa \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\int M(z)\\varepsilon^*(z)dz \\\\\n\\int zM(z)\\varepsilon^*(z)dz\n\\end{pmatrix}\n$$\nThis is of the form $\\mathbf{K} \\mathbf{u} = \\mathbf{F}^*$, where $\\mathbf{K}$ is the stiffness matrix and $\\mathbf{F}^*$ is the load vector due to eigenstrain. Let us define the coefficients:\n-   Axial stiffness: $A = \\int M(z)dz = M_s t_s + M_f t_f$\n-   Coupling stiffness: $B = \\int zM(z)dz = M_f t_f (t_s/2 + t_f/2)$\n-   Bending stiffness: $D = \\int z^2M(z)dz = M_s \\frac{t_s^3}{12} + M_f \\left( \\frac{t_f^3}{12} + t_f \\left( \\frac{t_s}{2} + \\frac{t_f}{2} \\right)^2 \\right)$ (using the parallel axis theorem for the film's contribution).\n-   Eigenforce: $N^* = \\int M(z)\\varepsilon^*(z)dz = M_f \\varepsilon_f^* t_f = \\sigma_f t_f$\n-   Eigenmoment: $M^* = \\int zM(z)\\varepsilon^*(z)dz = M_f \\varepsilon_f^* t_f (t_s/2 + t_f/2) = \\sigma_f t_f (t_s/2 + t_f/2)$\n\nThe system is:\n$$\n\\begin{pmatrix} A  B \\\\ B  D \\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_0 \\\\ \\kappa \\end{pmatrix}\n=\n\\begin{pmatrix} N^* \\\\ M^* \\end{pmatrix}\n$$\nSolving for the curvature $\\kappa$ (which is $\\kappa_{\\text{FEA}}$) using Cramer's rule gives:\n$$ \\kappa_{\\text{FEA}} = \\frac{A M^* - B N^*}{A D - B^2} $$\nThis expression is the exact solution for the curvature based on bilayer plate theory and will be used for the $\\kappa_{\\text{FEA}}$ calculation. The \"FEA-style\" approach corresponds to this systematic assembly of the governing matrix system from first principles.\n\n**4. Stoney Approximation for $\\kappa_{\\text{Stoney}}$**\nThe Stoney formula is a limit of the general solution under the thin-film approximation, where $t_f \\ll t_s$ and the film's stiffness is negligible compared to the substrate's ($M_f t_f \\ll M_s t_s$). A simplified derivation considers the moment balance. The force per unit width in the film is approximately $\\sigma_f t_f$. This force acts at a lever arm of $\\approx t_s/2$ from the substrate's midplane, inducing a moment $M_{load} = (\\sigma_f t_f)(t_s/2)$. This moment is balanced by the substrate's elastic response, $M_{resist} = \\kappa D_s$, where $D_s = M_s t_s^3/12$ is the plate rigidity of the substrate alone. Equating the moments gives:\n$$ \\kappa_{\\text{Stoney}} D_s = M_{load} \\implies \\kappa_{\\text{Stoney}} \\left( M_s \\frac{t_s^3}{12} \\right) = \\sigma_f t_f \\frac{t_s}{2} $$\nSolving for $\\kappa_{\\text{Stoney}}$ yields the classical Stoney formula:\n$$ \\kappa_{\\text{Stoney}} = \\frac{6 \\sigma_f t_f}{M_s t_s^2} $$\n\n**5. Discrepancy and Bow Calculation**\nThe discrepancy $\\delta$ between the two models is computed as the relative difference, as specified:\n$$ \\delta = \\frac{\\kappa_{\\text{FEA}} - \\kappa_{\\text{Stoney}}}{\\kappa_{\\text{FEA}}} $$\nIf $\\kappa_{\\text{FEA}} = 0$ (e.g., if $\\sigma_f = 0$), the discrepancy is physically zero, so we define $\\delta=0$.\n\nThe maximum deflection (bow or sagitta) $w_{\\text{bow}}$ of a spherically bowed circular plate of radius $a$ is given for small deflections by:\n$$ w_{\\text{bow}} = \\frac{\\kappa_{\\text{FEA}} a^2}{2} $$\nThis completes the derivation of all required formulae.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the wafer bow problem for a suite of test cases.\n    \"\"\"\n\n    # Test cases parameters:\n    # (t_f, t_s, sigma_f, E_f, nu_f, E_s, nu_s, a)\n    # in (m, m, Pa, Pa, -, Pa, -, m)\n    test_cases = [\n        (1.0e-6, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (5.0e-6, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (5.0e-5, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-7, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-6, 5.25e-4, 0.0, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-6, 5.25e-4, 4.00e8, 1.30e11, 0.28, 1.30e11, 0.28, 1.00e-1)\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(calculate_bow_metrics(params))\n\n    # Format the final output string as specified: [[r1,r2,...], [s1,s2,...]]\n    # str() on a list correctly formats it as \"[item1, item2, ...]\"\n    # Joining these strings with a comma creates the desired list of lists format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_bow_metrics(params):\n    \"\"\"\n    Calculates curvature, discrepancy, and bow for a single film-substrate system.\n    \n    Args:\n        params (tuple): A tuple containing the system parameters:\n                        (t_f, t_s, sigma_f, E_f, nu_f, E_s, nu_s, a).\n\n    Returns:\n        list: A list of four floats: [k_stoney, k_fea, delta, w_bow].\n    \"\"\"\n    tf, ts, sigma_f, Ef, nuf, Es, nus, a = params\n\n    # Trivial case: zero residual stress results in zero curvature and bow.\n    if sigma_f == 0.0:\n        return [0.0, 0.0, 0.0, 0.0]\n\n    # Calculate biaxial moduli M = E / (1 - nu)\n    Mf = Ef / (1.0 - nuf)\n    Ms = Es / (1.0 - nus)\n\n    # 1. Stoney-based curvature (k_stoney)\n    # k_stoney = 6 * sigma_f * t_f / (M_s * t_s^2)\n    k_stoney = (6.0 * sigma_f * tf) / (Ms * ts**2)\n\n    # 2. FEA-style curvature from exact bilayer plate theory (k_fea)\n    # This involves solving the 2x2 system derived from first principles.\n    # [ A B ] [epsilon_0] = [N*]\n    # [ B D ] [    k    ]   [M*]\n\n    # Assemble stiffness matrix components (integrals over thickness)\n    # A = integral(M(z) dz)\n    A = Ms * ts + Mf * tf\n    \n    # B = integral(z*M(z) dz), with z=0 at substrate midplane\n    B = Mf * tf * (ts / 2.0 + tf / 2.0)\n    \n    # D = integral(z^2*M(z) dz), using parallel axis theorem for convenience\n    D_s = Ms * ts**3 / 12.0\n    d_film_centroid = ts / 2.0 + tf / 2.0\n    D_f = Mf * tf**3 / 12.0 + Mf * tf * d_film_centroid**2\n    D = D_s + D_f\n\n    # Assemble load vector components from eigenstrain\n    # N* = integral(M(z)*eps*(z) dz) = sigma_f * t_f\n    N_star = sigma_f * tf\n    # M* = integral(z*M(z)*eps*(z) dz)\n    M_star = sigma_f * tf * (ts / 2.0 + tf / 2.0)\n\n    # Solve for curvature k_fea = (A*M* - B*N*) / (A*D - B^2)\n    determinant = A * D - B**2\n    if np.isclose(determinant, 0):\n        k_fea = 0.0 # Occurs only in physically degenerate cases\n    else:\n        k_fea = (A * M_star - B * N_star) / determinant\n\n    # 3. Discrepancy (delta)\n    # delta = (k_fea - k_stoney) / k_fea\n    if np.isclose(k_fea, 0):\n        delta = 0.0 # Physically, no curvature means no discrepancy\n    else:\n        # Note: The problem asks for (k_fea - k_stoney) / k_fea.\n        # It is known Stoney's formula often overpredicts curvature for non-ideal\n        # thin films, which would make k_stoney  k_fea, and thus delta negative.\n        # This implementation strictly follows the provided formula.\n        delta = (k_fea - k_stoney) / k_fea\n\n    # 4. Bow at wafer edge (w_bow)\n    # w_bow = k_fea * a^2 / 2\n    w_bow = k_fea * a**2 / 2.0\n\n    return [k_stoney, k_fea, delta, w_bow]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}