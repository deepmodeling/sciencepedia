{
    "hands_on_practices": [
        {
            "introduction": "The first step in modeling any deposition process is to relate the primary process variable, in this case the applied current density $j$, to the physical outcome of film growth. This exercise builds a direct bridge between electrical input and geometric change using Faraday's law of electrolysis, a cornerstone of electrochemistry. By deriving and calculating the planar deposition rate, you will establish a quantitative baseline for understanding how fast a copper film grows under ideal conditions, a foundational skill for all subsequent modeling efforts .",
            "id": "4116888",
            "problem": "A copper electroplating step is used to fill isolated damascene trenches of nominal depth $200\\ \\text{nm}$ on a patterned semiconductor wafer. The electrolyte provides cupric ions that reduce at the cathode according to the stoichiometric reaction $\\text{Cu}^{2+} + 2e^{-} \\rightarrow \\text{Cu}$, and the process is operated under steady Direct Current (DC) with uniform current density $j$ over the wafer. Assume unity cathodic current efficiency (no parasitic reactions), sufficiently high supporting electrolyte that transport limitations are negligible, and planar one-dimensional growth normal to the local surface inside the trench.\n\nStarting from Faraday’s law of electrolysis and conservation of mass, derive an expression for the local planar thickness growth rate $dh/dt$ of copper in terms of the applied current density $j$, the copper molar mass $M$, the copper mass density $\\rho$, the electron number $n$ transferred per metal atom, and the Faraday constant $F$. Then, using the numerical values $j = 20\\ \\text{mA/cm}^2$, $M = 63.546\\ \\text{g/mol}$, $\\rho = 8.96\\ \\text{g/cm}^3$, $n = 2$, and $F = 96{,}485\\ \\text{C/mol}$, compute:\n\n- the planar thickness rate in $\\text{nm/s}$, and\n- the time required to completely fill a trench of depth $200\\ \\text{nm}$ under the same planar growth assumption.\n\nExpress the final thickness rate in $\\text{nm/s}$ and the fill time in $\\text{s}$. Round your numerical answers to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in electrochemical engineering and semiconductor process modeling, based on fundamental principles without any inconsistencies or flaws.\n\nThe first objective is to derive an expression for the planar thickness growth rate, $\\frac{dh}{dt}$, of the electroplated copper film. This derivation begins with Faraday's law of electrolysis, which relates the mass, $m$, of a substance deposited on an electrode to the total electric charge, $Q$, that has passed through the system.\n\nFaraday's law can be written as:\n$$m = \\frac{M}{n F} Q$$\nwhere $M$ is the molar mass of the substance (copper), $n$ is the number of moles of electrons transferred per mole of the substance (valence), and $F$ is the Faraday constant.\n\nFor the given reaction, $\\text{Cu}^{2+} + 2e^{-} \\rightarrow \\text{Cu}$, a copper ion $\\text{Cu}^{2+}$ accepts two electrons to form a solid copper atom. Therefore, the number of electrons transferred per atom is $n=2$.\n\nThe problem states that the process operates under a steady Direct Current (DC). The total charge $Q$ is the product of the constant current $I$ and the time duration $t$, so $Q = I t$. Differentiating the mass equation with respect to time gives the rate of mass deposition:\n$$\\frac{dm}{dt} = \\frac{M}{n F} \\frac{dQ}{dt} = \\frac{M}{n F} I$$\n\nThe current $I$ can be expressed in terms of the uniform current density $j$ and the area $A$ over which it is applied: $I = j A$. Substituting this into the mass rate equation yields:\n$$\\frac{dm}{dt} = \\frac{M j A}{n F}$$\n\nNext, we invoke the principle of mass conservation. The mass $m$ of the deposited film is also related to its volume $V$ and density $\\rho$ by the equation $m = \\rho V$. The problem assumes planar, one-dimensional growth, meaning the thickness $h$ of the film increases uniformly over the area $A$. The volume of the deposited film is thus $V = A h$. Substituting this into the mass-density relation gives:\n$$m = \\rho A h$$\n\nDifferentiating this expression with respect to time, assuming constant density $\\rho$ and area $A$, gives another expression for the rate of mass deposition:\n$$\\frac{dm}{dt} = \\rho A \\frac{dh}{dt}$$\nHere, $\\frac{dh}{dt}$ is the linear growth rate of the film thickness.\n\nBy equating the two derived expressions for the mass deposition rate $\\frac{dm}{dt}$, we get:\n$$\\rho A \\frac{dh}{dt} = \\frac{M j A}{n F}$$\nThe area $A$ is a common factor on both sides and cancels out, which is expected as the local growth rate should not depend on the total area of the wafer. This leaves the final expression for the local planar thickness growth rate:\n$$\\frac{dh}{dt} = \\frac{M j}{n F \\rho}$$\n\nThe second objective is to compute the numerical value of this growth rate and the time required to fill a trench of a given depth. We are given the following values:\n$j = 20\\ \\text{mA/cm}^2 = 20 \\times 10^{-3}\\ \\text{A/cm}^2$\n$M = 63.546\\ \\text{g/mol}$\n$\\rho = 8.96\\ \\text{g/cm}^3$\n$n = 2$ (dimensionless, representing moles of electrons per mole of Cu)\n$F = 96{,}485\\ \\text{C/mol} = 96{,}485\\ \\text{A} \\cdot \\text{s/mol}$\n\nFirst, we calculate the growth rate $\\frac{dh}{dt}$ by substituting these values into the derived formula. It is critical to ensure unit consistency.\n$$ \\frac{dh}{dt} = \\frac{(63.546\\ \\text{g/mol}) \\times (20 \\times 10^{-3}\\ \\text{A/cm}^2)}{(2) \\times (96{,}485\\ \\text{A} \\cdot \\text{s/mol}) \\times (8.96\\ \\text{g/cm}^3)} $$\nThe units simplify as:\n$$ \\frac{(\\text{g/mol}) \\times (\\text{A/cm}^2)}{(\\text{A} \\cdot \\text{s/mol}) \\times (\\text{g/cm}^3)} = \\frac{\\text{g} \\cdot \\text{A} \\cdot \\text{mol} \\cdot \\text{cm}^3}{\\text{mol} \\cdot \\text{cm}^2 \\cdot \\text{A} \\cdot \\text{s} \\cdot \\text{g}} = \\frac{\\text{cm}}{\\text{s}} $$\nThe calculation gives the rate in $\\text{cm/s}$.\n$$ \\frac{dh}{dt} = \\frac{1.27092}{1729011.2} \\frac{\\text{cm}}{\\text{s}} \\approx 7.350605 \\times 10^{-7}\\ \\text{cm/s} $$\nThe problem requires the rate in $\\text{nm/s}$. We use the conversion $1\\ \\text{cm} = 10^7\\ \\text{nm}$.\n$$ \\frac{dh}{dt} = (7.350605 \\times 10^{-7}\\ \\text{cm/s}) \\times (10^7\\ \\text{nm/cm}) = 7.350605\\ \\text{nm/s} $$\nRounding to four significant figures, the planar thickness rate is $7.351\\ \\text{nm/s}$.\n\nFinally, we compute the time $t_{fill}$ required to completely fill a trench of depth $H = 200\\ \\text{nm}$. Assuming the growth rate is constant, the time is the total thickness divided by the rate:\n$$ t_{fill} = \\frac{H}{\\frac{dh}{dt}} $$\nUsing the unrounded value of the growth rate for accuracy:\n$$ t_{fill} = \\frac{200\\ \\text{nm}}{7.350605\\ \\text{nm/s}} \\approx 27.2079\\ \\text{s} $$\nRounding to four significant figures, the fill time is $27.21\\ \\text{s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.351  27.21\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Successful \"bottom-up\" superfilling is not just about depositing copper; it relies on a delicate balance between metal growth and the action of organic additives that modulate local deposition rates. This problem advances from simple growth calculations to explore this dynamic competition through the power of dimensionless analysis . You will construct a criterion that compares the timescale of suppressor diffusion along the feature surface to the timescale of trench closure, providing a powerful predictive tool for assessing whether a process is likely to achieve void-free fill or suffer from premature pinch-off.",
            "id": "4116907",
            "problem": "Copper electroplating into dual-damascene features is often modeled by the competition between additive (suppressor) transport along the surface and metal growth kinetics. Consider a trench of width $w=40\\ \\text{nm}$ whose sidewalls near the mouth plate copper under a constant applied current density $j=15\\ \\text{mA/cm}^2$. Assume the suppressor species that modulates local kinetics has an effective surface diffusion coefficient $D_s=10^{-14}\\ \\text{m}^2/\\text{s}$ across the width scale $w$. Treat copper deposition as a growth process normal to the surface controlled by Faraday’s law of electrolysis, with copper valence $n=2$, Faraday constant $F=96485\\ \\text{C/mol}$, copper molar mass $M_{\\mathrm{Cu}}=63.546\\ \\text{g/mol}$, and copper density $\\rho_{\\mathrm{Cu}}=8.96\\ \\text{g/cm}^3$. Neglect convection and any reaction–diffusion consumption of suppressor; take suppressor transport to be purely diffusive on the surface and copper growth to be spatially uniform at the trench mouth for the purposes of defining closure.\n\nStarting from fundamental transport and electrochemical principles, define two characteristic timescales: (i) the time for suppressor to homogenize across the trench width, and (ii) the time for sidewall growth at the mouth to close the trench by depositing half the width on each side. Then form the dimensionless criterion $\\mathcal{S}$ equal to the ratio of the suppressor diffusion timescale to the sidewall closure timescale. Using the provided parameters, compute $\\mathcal{S}$ and, based on whether $\\mathcal{S}$ is greater than or less than unity, state whether the criterion predicts bottom-up superfill before closure or a pinch-off risk at the mouth. Express the final answer as the value of $\\mathcal{S}$ as a dimensionless pure number, and round your answer to three significant figures.",
            "solution": "The goal is to construct a dimensionless measure comparing suppressor transport across the feature width to the kinematic closure driven by electroplating at the trench mouth. We proceed from first principles.\n\nElectrochemical growth rate normal to the plating surface follows from Faraday’s law of electrolysis. The mass deposition rate per unit area is\n$$\n\\frac{\\dot{m}}{A} = \\frac{j M_{\\mathrm{Cu}}}{n F},\n$$\nwhere $j$ is current density, $M_{\\mathrm{Cu}}$ is the copper molar mass, $n$ is the number of electrons per copper ion, and $F$ is the Faraday constant. Converting mass flux to a linear thickness rate using copper density $\\rho_{\\mathrm{Cu}}$ gives the plating velocity $v$:\n$$\nv = \\frac{1}{\\rho_{\\mathrm{Cu}}}\\frac{\\dot{m}}{A} = \\frac{j M_{\\mathrm{Cu}}}{n F \\rho_{\\mathrm{Cu}}}.\n$$\n\nThe suppressor homogenization across the trench width is governed by Fickian diffusion. The characteristic diffusive timescale over a length $w$ is, by dimensional analysis of Fick’s second law,\n$$\nt_{D} \\sim \\frac{w^{2}}{D_s},\n$$\nwhere $D_s$ is the surface diffusion coefficient of the suppressor species.\n\nThe sidewall closure timescale at the trench mouth is set by the time for each sidewall to deposit a thickness equal to half the trench width, assuming growth normal to the surface at velocity $v$. Because two opposing sidewalls grow inward, closure occurs when each side deposits $w/2$. Thus,\n$$\nt_{\\mathrm{close}} = \\frac{w/2}{v} = \\frac{w}{2}\\,\\frac{n F \\rho_{\\mathrm{Cu}}}{j M_{\\mathrm{Cu}}}.\n$$\n\nWe now form the dimensionless criterion\n$$\n\\mathcal{S} = \\frac{t_{D}}{t_{\\mathrm{close}}} = \\frac{\\dfrac{w^{2}}{D_s}}{\\dfrac{w}{2}\\,\\dfrac{n F \\rho_{\\mathrm{Cu}}}{j M_{\\mathrm{Cu}}}} = \\frac{2 w j M_{\\mathrm{Cu}}}{n F \\rho_{\\mathrm{Cu}} D_s}.\n$$\nThis criterion compares suppressor redistribution across the width to the geometric closure driven by plating. If $\\mathcal{S} > 1$, suppressor diffusion is slower than closure, so strong spatial gradients in suppressor coverage can persist and promote bottom-up acceleration effects before the mouth closes, predicting superfill. If $\\mathcal{S}  1$, suppressor diffusion is faster than closure, tending to homogenize coverage at the mouth so that sidewalls plate comparably and the trench is at risk of pinching off before bottom-up fill can outpace mouth closure.\n\nWe now evaluate $\\mathcal{S}$ numerically with the given parameters. First convert all quantities to International System of Units (SI):\n- $w = 40\\ \\text{nm} = 40 \\times 10^{-9}\\ \\text{m}$,\n- $j = 15\\ \\text{mA/cm}^2 = 0.015\\ \\text{A/cm}^2 = 150\\ \\text{A/m}^2$ (since $1\\ \\text{cm}^2 = 10^{-4}\\ \\text{m}^2$),\n- $M_{\\mathrm{Cu}} = 63.546\\ \\text{g/mol} = 0.063546\\ \\text{kg/mol}$,\n- $\\rho_{\\mathrm{Cu}} = 8.96\\ \\text{g/cm}^3 = 8960\\ \\text{kg/m}^3$,\n- $n = 2$,\n- $F = 96485\\ \\text{C/mol}$,\n- $D_s = 10^{-14}\\ \\text{m}^2/\\text{s}$.\n\nWe may compute $v$ for clarity, then $t_{D}$ and $t_{\\mathrm{close}}$, and finally $\\mathcal{S}$.\n\nPlating velocity:\n$$\nv = \\frac{j M_{\\mathrm{Cu}}}{n F \\rho_{\\mathrm{Cu}}} = \\frac{150 \\times 0.063546}{2 \\times 96485 \\times 8960}\\ \\text{m/s}.\n$$\nCompute the numerator:\n$$\n150 \\times 0.063546 = 9.5319.\n$$\nCompute the denominator:\n$$\n2 \\times 96485 \\times 8960 = 192970 \\times 8960 = 1.7290112 \\times 10^{9}.\n$$\nThus,\n$$\nv \\approx \\frac{9.5319}{1.7290112 \\times 10^{9}}\\ \\text{m/s} \\approx 5.51 \\times 10^{-9}\\ \\text{m/s}.\n$$\n\nDiffusive timescale across the width:\n$$\nt_{D} = \\frac{w^{2}}{D_s} = \\frac{(40 \\times 10^{-9})^{2}}{10^{-14}}\\ \\text{s} = \\frac{1600 \\times 10^{-18}}{10^{-14}}\\ \\text{s} = 0.16\\ \\text{s}.\n$$\n\nClosure timescale:\n$$\nt_{\\mathrm{close}} = \\frac{w/2}{v} = \\frac{20 \\times 10^{-9}}{5.51 \\times 10^{-9}}\\ \\text{s} \\approx 3.63\\ \\text{s}.\n$$\n\nFinally,\n$$\n\\mathcal{S} = \\frac{t_{D}}{t_{\\mathrm{close}}} \\approx \\frac{0.16}{3.63} \\approx 0.0441.\n$$\n\nSince $\\mathcal{S}  1$, the criterion indicates that suppressor diffusion across the trench width is fast relative to mouth closure, which tends to homogenize suppressor coverage and favors comparable sidewall plating at the mouth. Therefore, under these conditions the model predicts a pinch-off risk rather than bottom-up superfill before closure. The requested final answer is the dimensionless number $\\mathcal{S}$, rounded to three significant figures.",
            "answer": "$$\\boxed{0.0441}$$"
        },
        {
            "introduction": "While analytical models provide crucial insights, capturing the complex, evolving geometry of a filling trench requires advanced computational methods. This hands-on coding exercise introduces the Level-Set Method, a powerful numerical technique for tracking moving interfaces in continuum models . By implementing a basic Level-Set simulation to evolve a trench profile, you will gain practical experience with the methods used in state-of-the-art process modeling software to predict fill dynamics under spatially non-uniform conditions.",
            "id": "4116951",
            "problem": "A rectangular single-level damascene trench is to be filled by copper electroplating. The evolving copper-electrolyte interface is represented by a Level-Set (LS) function $\\phi(\\mathbf{x},t)$ defined on a two-dimensional rectangular domain with lateral coordinate $x$ and vertical coordinate $y$, where $\\phi > 0$ denotes electrolyte and $\\phi  0$ denotes copper, and the moving interface is the zero level-set $\\phi=0$. The normal velocity is driven by the local current density field $j(\\mathbf{x})$ through Faraday's law, and the interface evolution over one explicit time step $\\Delta t$ must be computed using an upwind scheme for a Hamilton–Jacobi Partial Differential Equation (PDE). The trench opening width is defined as the contiguous span along the top boundary $y=0$ where $\\phi(x,0,t) > 0$ after the update.\n\nThe physical basis is Faraday's law relating the copper plating normal velocity $v_n$ to the local current density $j$,\n$$\nv_n(\\mathbf{x})=\\frac{M}{n F \\rho}\\,j(\\mathbf{x}),\n$$\nwhere $M$ is the copper molar mass, $n$ is the electron number per copper ion, $F$ is Faraday's constant, and $\\rho$ is the copper mass density. The Level-Set equation for interface motion is\n$$\n\\frac{\\partial \\phi}{\\partial t} + v_n(\\mathbf{x})\\,\\left\\lvert \\nabla \\phi \\right\\rvert = 0,\n$$\ninterpreted with the normal direction pointing from copper ($\\phi0$) into electrolyte ($\\phi>0$), so that a positive $v_n$ advances copper into electrolyte. The numerical update must use a first-order upwind discretization consistent with the Hamilton–Jacobi structure.\n\nImplement a program that, given an initial trench profile and a prescribed spatial field $j(\\mathbf{x})$, performs a single explicit time step of duration $\\Delta t$ to update $\\phi$ and then computes the new trench opening width along the top boundary. Use the following specifications to ensure scientific realism and reproducibility.\n\n- Domain and grid:\n  - Lateral span $W = 200\\,\\mathrm{nm}$, vertical span $H = 200\\,\\mathrm{nm}$.\n  - Uniform grid with $N_x = 401$ nodes in $x$ and $N_y = 401$ nodes in $y$.\n  - Grid spacings $\\,\\Delta x = W/(N_x-1)$ and $\\,\\Delta y = H/(N_y-1)$ in $\\mathrm{nm}$; convert to $\\mathrm{m}$ internally for physical consistency.\n  - The top boundary corresponds to $y=0$ (the first grid row), and $x$ ranges from $0$ to $W$.\n\n- Initial trench geometry:\n  - A rectangular trench void of width $w_\\mathrm{tr} = 80\\,\\mathrm{nm}$ centered laterally in the domain and depth $h_\\mathrm{tr} = 140\\,\\mathrm{nm}$ measured downward from the top boundary.\n  - Define the initial Level-Set $\\phi(x,y,0)$ as the signed distance to the rectangle: $\\phi>0$ inside the void, $\\phi0$ in copper, and $\\phi=0$ at the void-copper boundary. Use the exact signed distance to an axis-aligned rectangle so that inside the rectangle $\\phi$ equals the minimal perpendicular distance to a side, and outside it equals the negative Euclidean distance to the rectangle.\n\n- Physics constants (use these values and units):\n  - Copper molar mass $M = 63.546\\times10^{-3}\\,\\mathrm{kg/mol}$.\n  - Electron number $n=2$.\n  - Faraday constant $F=96485\\,\\mathrm{C/mol}$.\n  - Copper mass density $\\rho=8960\\,\\mathrm{kg/m^3}$.\n\n- Current density fields and time steps (Test Suite):\n  - Case $\\mathrm{A}$ (uniform field, happy path):\n    - $j(\\mathbf{x}) = j_0$ with $j_0 = 300\\,\\mathrm{A/m^2}$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi0$.\n    - Time step $\\Delta t = 0.04\\,\\mathrm{s}$.\n  - Case $\\mathrm{B}$ (sidewall-enhanced field, spatially varying):\n    - $j(\\mathbf{x}) = j_0\\left(1 + \\alpha\\,e^{-\\frac{|x-x_\\ell|}{\\lambda}} + \\alpha\\,e^{-\\frac{|x-x_r|}{\\lambda}}\\right)$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi0$.\n    - Parameters: $j_0 = 200\\,\\mathrm{A/m^2}$, $\\alpha=1$, $\\lambda=5\\,\\mathrm{nm}$, $x_\\ell$ is the left trench sidewall $x$-coordinate and $x_r$ is the right trench sidewall $x$-coordinate.\n    - Time step $\\Delta t = 0.02\\,\\mathrm{s}$.\n  - Case $\\mathrm{C}$ (low-current near-stagnation, edge case):\n    - $j(\\mathbf{x}) = j_0$ with $j_0 = 10\\,\\mathrm{A/m^2}$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi0$.\n    - Time step $\\Delta t = 0.04\\,\\mathrm{s}$.\n\n- Numerical update:\n  - Use a first-order explicit upwind scheme consistent with the Hamilton–Jacobi PDE. Compute one-sided spatial derivatives using nearest neighbors and assemble the Godunov numerical Hamiltonian for $\\left\\lvert \\nabla \\phi \\right\\rvert$ appropriate to the sign of $v_n(\\mathbf{x})$ at each grid point. Impose zero-flux (Neumann-type) boundary conditions via one-sided differences at the domain edges.\n  - Stability must be respected by the Courant–Friedrichs–Lewy (CFL) consideration, but for this assignment you must perform exactly one update of duration $\\Delta t$ as specified per case.\n\n- Trench opening width:\n  - After the update, evaluate $\\phi(x, 0, \\Delta t)$ along the top boundary row $y=0$.\n  - Determine the contiguous interval in $x$ over which $\\phi(x, 0, \\Delta t) > 0$; if multiple disjoint intervals exist, select the largest by measure.\n  - Compute the opening width as the length of that interval using linear interpolation to locate zero crossings between adjacent grid points.\n  - Express the opening width in $\\mathrm{nm}$.\n\nYour program must implement the above for the three cases $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{C}$, and produce a single line of output containing the three opening widths as a comma-separated list enclosed in square brackets, in $\\mathrm{nm}$, each as a floating-point number. For example, the output format must be $\\left[\\mathrm{w_A},\\mathrm{w_B},\\mathrm{w_C}\\right]$ with no additional text. The final outputs must be floats (not integers).",
            "solution": "The user's request is to develop a Python program to simulate one time step of copper electroplating in a damascene trench and compute the resulting opening width. The simulation is based on the Level-Set method.\n\n### **Problem Validation**\n\n1.  **Extract Givens**: All physical constants ($M$, $n$, $F$, $\\rho$), domain parameters ($W, H, N_x, N_y$), initial geometry ($w_\\mathrm{tr}, h_\\mathrm{tr}$), numerical scheme details (first-order upwind explicit), boundary conditions (zero-flux Neumann), and test case parameters ($j(\\mathbf{x})$, $\\Delta t$) are explicitly provided. The output format is also strictly defined.\n\n2.  **Validate Using Extracted Givens**:\n    -   **Scientifically Grounded**: The problem is based on established principles. The evolution of the interface is governed by the Level-Set equation, $\\frac{\\partial \\phi}{\\partial t} + v_n |\\nabla \\phi| = 0$, which is standard for modeling moving fronts. The normal velocity, $v_n$, is derived from Faraday's law of electrolysis, $v_n = \\frac{M}{n F \\rho} j$, a fundamental law of electrochemistry. The constants provided are authentic physical values for copper. The models for current density $j(\\mathbf{x})$ are physically motivated simplifications of real-world phenomena (e.g., additive-driven enhancement on sidewalls). The choice of a first-order upwind (Godunov) scheme is appropriate for the Hamilton–Jacobi nature of the PDE. The problem is scientifically and factually sound.\n    -   **Well-Posed**: The problem is specified with a complete set of information: a well-defined initial condition (signed distance to a rectangle), a deterministic evolution equation, and appropriate boundary conditions. The parameters for all three test cases are clearly defined. The procedure for calculating the final opening width, including interpolation, is unambiguous. A quick analysis of the Courant–Friedrichs–Lewy (CFL) condition confirms that the specified time steps are within the stability limit for the chosen numerical scheme, ensuring a meaningful numerical result.\n    -   **Objective**: The problem is stated in precise, quantitative, and unbiased technical language, free from any subjectivity or opinion.\n\n3.  **Verdict and Action**: The problem is deemed **valid** as it is scientifically grounded, well-posed, and objective. There are no contradictions, ambiguities, or missing information that would prevent a unique, meaningful solution. I will proceed to construct the solution.\n\n### **Methodology and Implementation**\n\nThe solution will be implemented as a Python program using the `numpy` library. The overall process is as follows:\n\n1.  **Constants and Grid Setup**: All physical and numerical parameters are defined in SI units (meters, kilograms, seconds, amperes) to ensure consistency in physical calculations. A 2D uniform grid is generated representing the spatial domain.\n\n2.  **Initial Level-Set Field, $\\phi(\\mathbf{x}, 0)$**: The initial shape of the copper/electrolyte interface is a rectangular trench. The Level-Set function, $\\phi$, is initialized as the exact signed distance function to this rectangle. For a point $\\mathbf{x}$, $\\phi(\\mathbf{x}, 0)$ is positive if $\\mathbf{x}$ is inside the trench (electrolyte), negative if outside (copper), and zero at the boundary. The value represents the shortest distance to the boundary. This is implemented using vectorized `numpy` operations for efficiency.\n\n3.  **Numerical Update Scheme**: The core of the simulation is the update of the $\\phi$ field over a single time step $\\Delta t$ using the equation $\\phi^{n+1} = \\phi^n - \\Delta t \\cdot v_n |\\nabla \\phi|^n$.\n    -   **Velocity Field $v_n$**: For each test case, the current density field $j(\\mathbf{x})$ is first computed on the grid. $j$ is non-zero only in the electrolyte region ($\\phi \\geq 0$). The velocity field is then calculated as $v_n(\\mathbf{x}) = \\frac{M}{n F \\rho} j(\\mathbf{x})$.\n    -   **Upwind Discretization of $|\\nabla \\phi|$**: The term $|\\nabla \\phi|$ is discretized using a first-order Godunov scheme, which is a form of upwind differencing suitable for Hamilton–Jacobi equations. This scheme ensures that information propagates in the correct direction (from copper into the electrolyte, since $v_n \\ge 0$). The numerical approximation is:\n        $$\n        |\\nabla \\phi|_{i,j} \\approx \\sqrt{ \\left( (\\phi_x)^2 \\right)_{i,j} + \\left( (\\phi_y)^2 \\right)_{i,j} }\n        $$\n        where the squared derivative terms are assembled from one-sided differences:\n        $$\n        \\left( (\\phi_x)^2 \\right)_{i,j} = (\\max(D_x^- \\phi_{i,j}, 0))^2 + (\\min(D_x^+ \\phi_{i,j}, 0))^2\n        $$\n        and similarly for the $y$-derivative. Here, $D_x^-$ and $D_x^+$ are the backward and forward difference operators, respectively. Zero-flux Neumann boundary conditions are handled by setting the appropriate one-sided difference to zero at the domain edges.\n    -   **Time Integration**: A single explicit forward Euler step is performed to compute the updated Level-Set field, $\\phi(\\mathbf{x}, \\Delta t)$.\n\n4.  **Trench Opening Width Calculation**: After updating $\\phi$, the new opening width at the top surface ($y=0$) is computed.\n    -   The values of $\\phi$ are extracted along the top row of the grid.\n    -   Contiguous segments of grid points where $\\phi > 0$ are identified. The longest such segment is selected as per the problem specification.\n    -   The precise locations where $\\phi$ crosses zero at the start and end of this segment are found using linear interpolation between the last non-positive grid point and the first positive one, and vice versa at the other end.\n    -   The opening width is the difference between these two interpolated coordinates, reported in nanometers.\n\nThe entire procedure is encapsulated in a function that iterates through the three specified test cases, computes the opening width for each, and formats the results into the required output string.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_opening_width(phi_top, x_coords_nm):\n    \"\"\"\n    Calculates the trench opening width from the Level-Set function at the top boundary.\n\n    Args:\n        phi_top (np.ndarray): 1D array of phi values at y=0.\n        x_coords_nm (np.ndarray): 1D array of x-coordinates in nm.\n\n    Returns:\n        float: The calculated opening width in nm.\n    \"\"\"\n    Nx = len(x_coords_nm)\n    W_nm = x_coords_nm[-1]\n\n    positive_indices = np.where(phi_top  0)[0]\n    \n    if len(positive_indices) == 0:\n        return 0.0\n\n    # Find the longest contiguous block of positive indices\n    splits = np.where(np.diff(positive_indices)  1)[0] + 1\n    blocks = np.split(positive_indices, splits)\n    if not blocks or not any(b.size  0 for b in blocks):\n        return 0.0\n    longest_block = max(blocks, key=len)\n\n    i_start = longest_block[0]\n    i_end = longest_block[-1]\n\n    # Calculate left boundary x_left_nm by linear interpolation\n    if i_start == 0:\n        x_left_nm = 0.0\n    else:\n        phi1 = phi_top[i_start - 1]\n        phi2 = phi_top[i_start]\n        x1 = x_coords_nm[i_start - 1]\n        x2 = x_coords_nm[i_start]\n        x_left_nm = x1 - phi1 * (x2 - x1) / (phi2 - phi1)\n\n    # Calculate right boundary x_right_nm by linear interpolation\n    if i_end == Nx - 1:\n        x_right_nm = W_nm\n    else:\n        phi1 = phi_top[i_end]\n        phi2 = phi_top[i_end + 1]\n        x1 = x_coords_nm[i_end]\n        x2 = x_coords_nm[i_end + 1]\n        x_right_nm = x1 - phi1 * (x2 - x1) / (phi2 - phi1)\n        \n    return x_right_nm - x_left_nm\n\ndef run_simulation_case(case_params):\n    \"\"\"\n    Runs a single simulation case for copper electroplating.\n    \"\"\"\n    # 1. Setup Domain, Constants, and Grid (in SI units)\n    W_nm, H_nm = 200.0, 200.0\n    Nx, Ny = 401, 401\n    \n    W_m, H_m = W_nm * 1e-9, H_nm * 1e-9\n    dx_m = W_m / (Nx - 1)\n    dy_m = H_m / (Ny - 1)\n    \n    w_tr_nm, h_tr_nm = 80.0, 140.0\n    w_tr_m, h_tr_m = w_tr_nm * 1e-9, h_tr_nm * 1e-9\n\n    M, n, F, rho = 63.546e-3, 2.0, 96485.0, 8960.0\n    k_vn_j = M / (n * F * rho)\n\n    x_m = np.linspace(0, W_m, Nx)\n    y_m = np.linspace(0, H_m, Ny)\n    xx_m, yy_m = np.meshgrid(x_m, y_m)\n\n    # 2. Initial Level-Set Function (Signed Distance to Rectangle)\n    x_center_m = W_m / 2.0\n    x_left_m = x_center_m - w_tr_m / 2.0\n    x_right_m = x_center_m + w_tr_m / 2.0\n    y_top_m = 0.0\n    y_bottom_m = h_tr_m\n\n    # Outside distance (negative Euclidean distance to rectangle)\n    dx_dist = np.zeros_like(xx_m)\n    dy_dist = np.zeros_like(yy_m)\n    dx_dist = np.maximum.reduce([dx_dist, x_left_m - xx_m, xx_m - x_right_m])\n    dy_dist = np.maximum.reduce([dy_dist, y_top_m - yy_m, yy_m - y_bottom_m])\n    phi_outside = -np.sqrt(dx_dist**2 + dy_dist**2)\n\n    # Inside distance (minimum perpendicular distance to a side)\n    phi_inside = np.minimum.reduce([\n        xx_m - x_left_m, x_right_m - xx_m,\n        yy_m - y_top_m, y_bottom_m - yy_m\n    ])\n\n    is_inside = (xx_m  x_left_m)  (xx_m  x_right_m)  \\\n                (yy_m  y_top_m)  (yy_m  y_bottom_m)\n    phi = np.where(is_inside, phi_inside, phi_outside)\n\n    # 3. Define Case-Specific Current Density Field\n    j_params = case_params['j_params']\n    case_type = case_params['type']\n    \n    j = np.zeros_like(phi)\n    is_electrolyte = phi = 0\n\n    if case_type == 'uniform':\n        j0 = j_params['j0']\n        j[is_electrolyte] = j0\n    elif case_type == 'sidewall':\n        j0 = j_params['j0']\n        alpha = j_params['alpha']\n        lambda_val_nm = j_params['lambda']\n        \n        x_l_nm = (W_nm / 2.0) - (w_tr_nm / 2.0)\n        x_r_nm = (W_nm / 2.0) + (w_tr_nm / 2.0)\n        x_coords_nm = x_m * 1e9\n        \n        j_factor = 1.0 + alpha * np.exp(-np.abs(x_coords_nm - x_l_nm) / lambda_val_nm) + \\\n                   alpha * np.exp(-np.abs(x_coords_nm - x_r_nm) / lambda_val_nm)\n        \n        j_factor_2d = np.tile(j_factor, (Ny, 1))\n        j_values = j0 * j_factor_2d\n        j[is_electrolyte] = j_values[is_electrolyte]\n\n    # 4. Evolve PDE for one time step\n    dt = case_params['dt']\n    vn = k_vn_j * j\n    \n    # First-order upwind (Godunov) scheme for |grad(phi)|\n    dpdx_p, dpdx_m = np.zeros_like(phi), np.zeros_like(phi)\n    dpdx_p[:, :-1] = (phi[:, 1:] - phi[:, :-1]) / dx_m\n    dpdx_m[:, 1:] = (phi[:, 1:] - phi[:, :-1]) / dx_m\n\n    dpdy_p, dpdy_m = np.zeros_like(phi), np.zeros_like(phi)\n    dpdy_p[:-1, :] = (phi[1:, :] - phi[:-1, :]) / dy_m\n    dpdy_m[1:, :] = (phi[1:, :] - phi[:-1, :]) / dy_m\n\n    grad_phi_x_sq = np.maximum(dpdx_m, 0)**2 + np.minimum(dpdx_p, 0)**2\n    grad_phi_y_sq = np.maximum(dpdy_m, 0)**2 + np.minimum(dpdy_p, 0)**2\n    grad_phi_mag = np.sqrt(grad_phi_x_sq + grad_phi_y_sq)\n\n    # Explicit Euler step\n    phi_new = phi - dt * vn * grad_phi_mag\n    \n    # 5. Compute Opening Width\n    phi_top = phi_new[0, :]\n    x_coords_nm = x_m * 1e9\n    width = calculate_opening_width(phi_top, x_coords_nm)\n    \n    return width\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: uniform field\n        {'type': 'uniform', 'j_params': {'j0': 300.0}, 'dt': 0.04},\n        # Case B: sidewall-enhanced field\n        {'type': 'sidewall', 'j_params': {'j0': 200.0, 'alpha': 1.0, 'lambda': 5.0}, 'dt': 0.02},\n        # Case C: low-current near-stagnation\n        {'type': 'uniform', 'j_params': {'j0': 10.0}, 'dt': 0.04}\n    ]\n    \n    results = []\n    for case in test_cases:\n        width = run_simulation_case(case)\n        results.append(width)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}