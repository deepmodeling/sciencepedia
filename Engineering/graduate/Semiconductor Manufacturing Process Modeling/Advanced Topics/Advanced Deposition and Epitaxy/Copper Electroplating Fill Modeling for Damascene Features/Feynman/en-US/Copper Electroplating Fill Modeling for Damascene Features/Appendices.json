{
    "hands_on_practices": [
        {
            "introduction": "The foundation of modeling any electrochemical deposition process lies in understanding the direct relationship between electrical current and the rate of material growth. This first practice grounds our study in Faraday's law of electrolysis, providing a crucial tool for converting a primary process input, the current density $j$, into a physical deposition velocity. By working through this calculation , you will establish the fundamental baseline for deposition speed, a key parameter that informs all more complex fill models.",
            "id": "4116888",
            "problem": "A copper electroplating step is used to fill isolated damascene trenches of nominal depth $200\\ \\text{nm}$ on a patterned semiconductor wafer. The electrolyte provides cupric ions that reduce at the cathode according to the stoichiometric reaction $\\text{Cu}^{2+} + 2e^{-} \\rightarrow \\text{Cu}$, and the process is operated under steady Direct Current (DC) with uniform current density $j$ over the wafer. Assume unity cathodic current efficiency (no parasitic reactions), sufficiently high supporting electrolyte that transport limitations are negligible, and planar one-dimensional growth normal to the local surface inside the trench.\n\nStarting from Faraday’s law of electrolysis and conservation of mass, derive an expression for the local planar thickness growth rate $dh/dt$ of copper in terms of the applied current density $j$, the copper molar mass $M$, the copper mass density $\\rho$, the electron number $n$ transferred per metal atom, and the Faraday constant $F$. Then, using the numerical values $j = 20\\ \\text{mA/cm}^2$, $M = 63.546\\ \\text{g/mol}$, $\\rho = 8.96\\ \\text{g/cm}^3$, $n = 2$, and $F = 96{,}485\\ \\text{C/mol}$, compute:\n\n- the planar thickness rate in $\\text{nm/s}$, and\n- the time required to completely fill a trench of depth $200\\ \\text{nm}$ under the same planar growth assumption.\n\nExpress the final thickness rate in $\\text{nm/s}$ and the fill time in $\\text{s}$. Round your numerical answers to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in electrochemical engineering and semiconductor process modeling, based on fundamental principles without any inconsistencies or flaws.\n\nThe first objective is to derive an expression for the planar thickness growth rate, $\\frac{dh}{dt}$, of the electroplated copper film. This derivation begins with Faraday's law of electrolysis, which relates the mass, $m$, of a substance deposited on an electrode to the total electric charge, $Q$, that has passed through the system.\n\nFaraday's law can be written as:\n$$m = \\frac{M}{n F} Q$$\nwhere $M$ is the molar mass of the substance (copper), $n$ is the number of moles of electrons transferred per mole of the substance (valence), and $F$ is the Faraday constant.\n\nFor the given reaction, $\\text{Cu}^{2+} + 2e^{-} \\rightarrow \\text{Cu}$, a copper ion $\\text{Cu}^{2+}$ accepts two electrons to form a solid copper atom. Therefore, the number of electrons transferred per atom is $n=2$.\n\nThe problem states that the process operates under a steady Direct Current (DC). The total charge $Q$ is the product of the constant current $I$ and the time duration $t$, so $Q = I t$. Differentiating the mass equation with respect to time gives the rate of mass deposition:\n$$\\frac{dm}{dt} = \\frac{M}{n F} \\frac{dQ}{dt} = \\frac{M}{n F} I$$\n\nThe current $I$ can be expressed in terms of the uniform current density $j$ and the area $A$ over which it is applied: $I = j A$. Substituting this into the mass rate equation yields:\n$$\\frac{dm}{dt} = \\frac{M j A}{n F}$$\n\nNext, we invoke the principle of mass conservation. The mass $m$ of the deposited film is also related to its volume $V$ and density $\\rho$ by the equation $m = \\rho V$. The problem assumes planar, one-dimensional growth, meaning the thickness $h$ of the film increases uniformly over the area $A$. The volume of the deposited film is thus $V = A h$. Substituting this into the mass-density relation gives:\n$$m = \\rho A h$$\n\nDifferentiating this expression with respect to time, assuming constant density $\\rho$ and area $A$, gives another expression for the rate of mass deposition:\n$$\\frac{dm}{dt} = \\rho A \\frac{dh}{dt}$$\nHere, $\\frac{dh}{dt}$ is the linear growth rate of the film thickness.\n\nBy equating the two derived expressions for the mass deposition rate $\\frac{dm}{dt}$, we get:\n$$\\rho A \\frac{dh}{dt} = \\frac{M j A}{n F}$$\nThe area $A$ is a common factor on both sides and cancels out, which is expected as the local growth rate should not depend on the total area of the wafer. This leaves the final expression for the local planar thickness growth rate:\n$$\\frac{dh}{dt} = \\frac{M j}{n F \\rho}$$\n\nThe second objective is to compute the numerical value of this growth rate and the time required to fill a trench of a given depth. We are given the following values:\n$j = 20\\ \\text{mA/cm}^2 = 20 \\times 10^{-3}\\ \\text{A/cm}^2$\n$M = 63.546\\ \\text{g/mol}$\n$\\rho = 8.96\\ \\text{g/cm}^3$\n$n = 2$ (dimensionless, representing moles of electrons per mole of Cu)\n$F = 96{,}485\\ \\text{C/mol} = 96{,}485\\ \\text{A} \\cdot \\text{s/mol}$\n\nFirst, we calculate the growth rate $\\frac{dh}{dt}$ by substituting these values into the derived formula. It is critical to ensure unit consistency.\n$$ \\frac{dh}{dt} = \\frac{(63.546\\ \\text{g/mol}) \\times (20 \\times 10^{-3}\\ \\text{A/cm}^2)}{(2) \\times (96{,}485\\ \\text{A} \\cdot \\text{s/mol}) \\times (8.96\\ \\text{g/cm}^3)} $$\nThe units simplify as:\n$$ \\frac{(\\text{g/mol}) \\times (\\text{A/cm}^2)}{(\\text{A} \\cdot \\text{s/mol}) \\times (\\text{g/cm}^3)} = \\frac{\\text{g} \\cdot \\text{A} \\cdot \\text{mol} \\cdot \\text{cm}^3}{\\text{mol} \\cdot \\text{cm}^2 \\cdot \\text{A} \\cdot \\text{s} \\cdot \\text{g}} = \\frac{\\text{cm}}{\\text{s}} $$\nThe calculation gives the rate in $\\text{cm/s}$.\n$$ \\frac{dh}{dt} = \\frac{1.27092}{1729011.2} \\frac{\\text{cm}}{\\text{s}} \\approx 7.350605 \\times 10^{-7}\\ \\text{cm/s} $$\nThe problem requires the rate in $\\text{nm/s}$. We use the conversion $1\\ \\text{cm} = 10^7\\ \\text{nm}$.\n$$ \\frac{dh}{dt} = (7.350605 \\times 10^{-7}\\ \\text{cm/s}) \\times (10^7\\ \\text{nm/cm}) = 7.350605\\ \\text{nm/s} $$\nRounding to four significant figures, the planar thickness rate is $7.351\\ \\text{nm/s}$.\n\nFinally, we compute the time $t_{fill}$ required to completely fill a trench of depth $H = 200\\ \\text{nm}$. Assuming the growth rate is constant, the time is the total thickness divided by the rate:\n$$ t_{fill} = \\frac{H}{\\frac{dh}{dt}} $$\nUsing the unrounded value of the growth rate for accuracy:\n$$ t_{fill} = \\frac{200\\ \\text{nm}}{7.350605\\ \\text{nm/s}} \\approx 27.2079\\ \\text{s} $$\nRounding to four significant figures, the fill time is $27.21\\ \\text{s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.351 & 27.21\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While a uniform growth rate is a useful starting point, real-world deposition within high-aspect-ratio features is often non-uniform. This practice explores the geometric consequences of differential growth, where the top of a trench fills faster than the bottom . Using a simplified kinematic model, you will calculate the critical 'pinch-off' time and determine whether a void will form, illustrating a primary failure mechanism in damascene metallization.",
            "id": "4116953",
            "problem": "Consider copper electroplating into a single isolated damascene trench in a silicon dioxide dielectric. The trench has an initial rectangular cross-section with width $w$ and depth $H$. During plating, assume a quasi-steady, spatially uniform local current density at the top overhang lips and at the trench bottom, producing constant effective interface-normal velocities at those locations. Specifically, the top overhang at each side advances laterally into the opening with speed $v_{\\text{top}}$ (one lip per side, symmetrically), while the copper at the trench bottom grows vertically upward with speed $v_{\\text{bot}}$. Neglect sidewall deposition, curvature effects, and any time-dependence of $v_{\\text{top}}$ and $v_{\\text{bot}}$.\n\nStarting from Faraday’s law of electrolysis and geometric kinematics, derive the time $t_{\\text{close}}$ at which the trench opening pinches off due to the meeting of the two top overhang lips, and derive the remaining unfilled void depth $H_{\\text{void}}$ inside the trench at the instant of closure. Then evaluate your expressions for $w=60\\ \\text{nm}$, $H=200\\ \\text{nm}$, $v_{\\text{top}}=1.2\\ \\text{nm/s}$, and $v_{\\text{bot}}=0.8\\ \\text{nm/s}$. Round your numerical results to four significant figures. Express $t_{\\text{close}}$ in seconds and $H_{\\text{void}}$ in nanometers.",
            "solution": "This problem is solved using simple geometric kinematics. Let $t=0$ be the start of the electroplating process.\n\nFirst, we derive the time to closure, $t_{\\text{close}}$. The initial trench width is $w$. Two overhangs, one from each side, grow laterally inward, each with a constant speed $v_{\\text{top}}$. The total rate at which the opening's width decreases is the sum of these speeds, $2v_{\\text{top}}$. The width of the opening $w(t)$ at time $t$ is therefore:\n$$w(t) = w - 2v_{\\text{top}}t$$\nPinch-off occurs when the width becomes zero, $w(t_{\\text{close}}) = 0$.\n$$0 = w - 2v_{\\text{top}}t_{\\text{close}}$$\nSolving for $t_{\\text{close}}$ gives the time to closure:\n$$t_{\\text{close}} = \\frac{w}{2v_{\\text{top}}}$$\n\nNext, we derive the depth of the void remaining at closure, $H_{\\text{void}}$. The copper at the trench bottom grows upward with a constant speed $v_{\\text{bot}}$. The height of this bottom film at time $t$, denoted $h_{\\text{bot}}(t)$, is:\n$$h_{\\text{bot}}(t) = v_{\\text{bot}}t$$\nAt the moment of closure, $t = t_{\\text{close}}$, the total height of the copper deposited at the trench bottom is:\n$$h_{\\text{bot}}(t_{\\text{close}}) = v_{\\text{bot}}t_{\\text{close}}$$\nThe initial trench depth is $H$. The void is the unfilled space between the top of the upward-growing film and the pinch-off point. Thus, the void depth $H_{\\text{void}}$ is the initial depth minus the filled depth at $t_{\\text{close}}$:\n$$H_{\\text{void}} = H - h_{\\text{bot}}(t_{\\text{close}})$$\nSubstituting the derived expression for $t_{\\text{close}}$:\n$$H_{\\text{void}} = H - v_{\\text{bot}}\\left(\\frac{w}{2v_{\\text{top}}}\\right) = H - \\frac{w v_{\\text{bot}}}{2v_{\\text{top}}}$$\n\nNow, we evaluate these expressions with the given numerical values:\n- $w = 60\\ \\text{nm}$\n- $H = 200\\ \\text{nm}$\n- $v_{\\text{top}} = 1.2\\ \\text{nm/s}$\n- $v_{\\text{bot}} = 0.8\\ \\text{nm/s}$\n\nEvaluation of $t_{\\text{close}}$:\n$$t_{\\text{close}} = \\frac{60\\ \\text{nm}}{2 \\times 1.2\\ \\text{nm/s}} = \\frac{60}{2.4}\\ \\text{s} = 25\\ \\text{s}$$\nRounding to four significant figures gives $25.00\\ \\text{s}$.\n\nEvaluation of $H_{\\text{void}}$:\n$$H_{\\text{void}} = 200\\ \\text{nm} - \\frac{(60\\ \\text{nm})(0.8\\ \\text{nm/s})}{2(1.2\\ \\text{nm/s})} = 200\\ \\text{nm} - \\frac{48}{2.4}\\ \\text{nm} = 200\\ \\text{nm} - 20\\ \\text{nm} = 180\\ \\text{nm}$$\nRounding to four significant figures gives $180.0\\ \\text{nm}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 25.00 & 180.0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "To accurately predict the complex evolution of the plating front in realistic trench geometries, we turn to advanced numerical methods. This practice introduces the Level-Set method, a powerful computational framework for tracking moving interfaces governed by physical laws like those we have explored . By implementing a single step of this algorithm, you will gain direct insight into how modern simulation tools translate local current densities into the dynamic, evolving topography of the filling copper.",
            "id": "4116951",
            "problem": "A rectangular single-level damascene trench is to be filled by copper electroplating. The evolving copper-electrolyte interface is represented by a Level-Set (LS) function $\\phi(\\mathbf{x},t)$ defined on a two-dimensional rectangular domain with lateral coordinate $x$ and vertical coordinate $y$, where $\\phi>0$ denotes electrolyte and $\\phi<0$ denotes copper, and the moving interface is the zero level-set $\\{\\phi=0\\}$. The normal velocity is driven by the local current density field $j(\\mathbf{x})$ through Faraday's law, and the interface evolution over one explicit time step $\\Delta t$ must be computed using an upwind scheme for a Hamilton–Jacobi Partial Differential Equation (PDE). The trench opening width is defined as the contiguous span along the top boundary $y=0$ where $\\phi(x,0,t)>0$ after the update.\n\nThe physical basis is Faraday's law relating the copper plating normal velocity $v_n$ to the local current density $j$,\n$$\nv_n(\\mathbf{x})=\\frac{M}{n F \\rho}\\,j(\\mathbf{x}),\n$$\nwhere $M$ is the copper molar mass, $n$ is the electron number per copper ion, $F$ is Faraday's constant, and $\\rho$ is the copper mass density. The Level-Set equation for interface motion is\n$$\n\\frac{\\partial \\phi}{\\partial t} + v_n(\\mathbf{x})\\,\\left\\lvert \\nabla \\phi \\right\\rvert = 0,\n$$\ninterpreted with the normal direction pointing from copper ($\\phi<0$) into electrolyte ($\\phi>0$), so that a positive $v_n$ advances copper into electrolyte. The numerical update must use a first-order upwind discretization consistent with the Hamilton–Jacobi structure.\n\nImplement a program that, given an initial trench profile and a prescribed spatial field $j(\\mathbf{x})$, performs a single explicit time step of duration $\\Delta t$ to update $\\phi$ and then computes the new trench opening width along the top boundary. Use the following specifications to ensure scientific realism and reproducibility.\n\n- Domain and grid:\n  - Lateral span $W = 200\\,\\mathrm{nm}$, vertical span $H = 200\\,\\mathrm{nm}$.\n  - Uniform grid with $N_x = 401$ nodes in $x$ and $N_y = 401$ nodes in $y$.\n  - Grid spacings $\\,\\Delta x = W/(N_x-1)$ and $\\,\\Delta y = H/(N_y-1)$ in $\\mathrm{nm}$; convert to $\\mathrm{m}$ internally for physical consistency.\n  - The top boundary corresponds to $y=0$ (the first grid row), and $x$ ranges from $0$ to $W$.\n\n- Initial trench geometry:\n  - A rectangular trench void of width $w_\\mathrm{tr} = 80\\,\\mathrm{nm}$ centered laterally in the domain and depth $h_\\mathrm{tr} = 140\\,\\mathrm{nm}$ measured downward from the top boundary.\n  - Define the initial Level-Set $\\phi(x,y,0)$ as the signed distance to the rectangle: $\\phi>0$ inside the void, $\\phi<0$ in copper, and $\\phi=0$ at the void-copper boundary. Use the exact signed distance to an axis-aligned rectangle so that inside the rectangle $\\phi$ equals the minimal perpendicular distance to a side, and outside it equals the negative Euclidean distance to the rectangle.\n\n- Physics constants (use these values and units):\n  - Copper molar mass $M = 63.546\\times10^{-3}\\,\\mathrm{kg/mol}$.\n  - Electron number $n=2$.\n  - Faraday constant $F=96485\\,\\mathrm{C/mol}$.\n  - Copper mass density $\\rho=8960\\,\\mathrm{kg/m^3}$.\n\n- Current density fields and time steps (Test Suite):\n  - Case $\\mathrm{A}$ (uniform field, happy path):\n    - $j(\\mathbf{x}) = j_0$ with $j_0 = 300\\,\\mathrm{A/m^2}$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi<0$.\n    - Time step $\\Delta t = 0.04\\,\\mathrm{s}$.\n  - Case $\\mathrm{B}$ (sidewall-enhanced field, spatially varying):\n    - $j(\\mathbf{x}) = j_0\\left(1 + \\alpha\\,e^{-\\frac{|x-x_\\ell|}{\\lambda}} + \\alpha\\,e^{-\\frac{|x-x_r|}{\\lambda}}\\right)$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi<0$.\n    - Parameters: $j_0 = 200\\,\\mathrm{A/m^2}$, $\\alpha=1$, $\\lambda=5\\,\\mathrm{nm}$, $x_\\ell$ is the left trench sidewall $x$-coordinate and $x_r$ is the right trench sidewall $x$-coordinate.\n    - Time step $\\Delta t = 0.02\\,\\mathrm{s}$.\n  - Case $\\mathrm{C}$ (low-current near-stagnation, edge case):\n    - $j(\\mathbf{x}) = j_0$ with $j_0 = 10\\,\\mathrm{A/m^2}$ wherever $\\phi\\ge 0$ and $j(\\mathbf{x}) = 0$ where $\\phi<0$.\n    - Time step $\\Delta t = 0.04\\,\\mathrm{s}$.\n\n- Numerical update:\n  - Use a first-order explicit upwind scheme consistent with the Hamilton–Jacobi PDE. Compute one-sided spatial derivatives using nearest neighbors and assemble the Godunov numerical Hamiltonian for $\\left\\lvert \\nabla \\phi \\right\\rvert$ appropriate to the sign of $v_n(\\mathbf{x})$ at each grid point. Impose zero-flux (Neumann-type) boundary conditions via one-sided differences at the domain edges.\n  - Stability must be respected by the Courant–Friedrichs–Lewy (CFL) consideration, but for this assignment you must perform exactly one update of duration $\\Delta t$ as specified per case.\n\n- Trench opening width:\n  - After the update, evaluate $\\phi(x,0,\\Delta t)$ along the top boundary row $y=0$.\n  - Determine the contiguous interval in $x$ over which $\\phi(x,0,\\Delta t) > 0$; if multiple disjoint intervals exist, select the largest by measure.\n  - Compute the opening width as the length of that interval using linear interpolation to locate zero crossings between adjacent grid points.\n  - Express the opening width in $\\mathrm{nm}$.\n\nYour program must implement the above for the three cases $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{C}$, and produce a single line of output containing the three opening widths as a comma-separated list enclosed in square brackets, in $\\mathrm{nm}$, each as a floating-point number. For example, the output format must be $\\left[\\mathrm{w_A},\\mathrm{w_B},\\mathrm{w_C}\\right]$ with no additional text. The final outputs must be floats (not integers).",
            "solution": "The solution is a Python program using the `numpy` library that implements the specified Level-Set simulation for one time step. The program's methodology is as follows:\n\n1.  **Grid and Parameter Setup**: Physical constants (in SI units), domain dimensions, and grid parameters are defined. A 2D uniform grid is generated to represent the spatial domain.\n\n2.  **Initial Level-Set Field ($\\phi(\\mathbf{x}, 0)$)**: The initial trench geometry is encoded into the Level-Set function, $\\phi$. This function is initialized as the exact signed distance to the specified rectangular trench. For any point $\\mathbf{x}$ on the grid, $\\phi(\\mathbf{x}, 0)$ is positive if it is inside the trench (electrolyte), negative if it is outside (copper), and zero at the boundary. The magnitude of $\\phi$ represents the shortest distance to the boundary.\n\n3.  **Numerical Update**: The core of the program updates the $\\phi$ field over the time step $\\Delta t$ using the equation $\\phi^{n+1} = \\phi^n - \\Delta t \\cdot v_n |\\nabla \\phi|^n$. This involves several sub-steps:\n    *   **Velocity Field Calculation**: For each test case, the current density field $j(\\mathbf{x})$ is computed on the grid, being non-zero only where $\\phi \\geq 0$. This is then converted to a normal velocity field $v_n(\\mathbf{x})$ using Faraday's law.\n    *   **Upwind Discretization of $|\\nabla \\phi|$**: The term $|\\nabla \\phi|$ is discretized using a first-order Godunov scheme, which is a standard upwind method for Hamilton–Jacobi equations. This ensures that information propagates in the correct physical direction (outward from the copper). The numerical approximation for $|\\nabla \\phi|$ is constructed from one-sided forward and backward spatial differences of $\\phi$. Zero-flux Neumann boundary conditions are handled by setting the appropriate one-sided differences to zero at the domain edges.\n    *   **Time Integration**: A single explicit forward Euler step is performed to compute the updated Level-Set field, $\\phi(\\mathbf{x}, \\Delta t)$.\n\n4.  **Trench Opening Width Calculation**: After updating $\\phi$, the new opening width at the top surface ($y=0$) is calculated. The program extracts the $\\phi$ values along the top row of the grid and identifies the longest contiguous segment where $\\phi > 0$. The precise start and end points of this opening are found using linear interpolation between grid points where $\\phi$ crosses zero. The final width is the difference between these two coordinates, reported in nanometers.\n\nThe program iterates through the three test cases (A, B, C), performs these steps for each, and formats the resulting widths into the required output string.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_opening_width(phi_top, x_coords_nm):\n    \"\"\"\n    Calculates the trench opening width from the Level-Set function at the top boundary.\n\n    Args:\n        phi_top (np.ndarray): 1D array of phi values at y=0.\n        x_coords_nm (np.ndarray): 1D array of x-coordinates in nm.\n\n    Returns:\n        float: The calculated opening width in nm.\n    \"\"\"\n    Nx = len(x_coords_nm)\n    W_nm = x_coords_nm[-1]\n\n    positive_indices = np.where(phi_top > 0)[0]\n    \n    if len(positive_indices) == 0:\n        return 0.0\n\n    # Find the longest contiguous block of positive indices\n    splits = np.where(np.diff(positive_indices) > 1)[0] + 1\n    blocks = np.split(positive_indices, splits)\n    if not blocks or not any(b.size > 0 for b in blocks):\n        return 0.0\n    longest_block = max(blocks, key=len)\n\n    i_start = longest_block[0]\n    i_end = longest_block[-1]\n\n    # Calculate left boundary x_left_nm by linear interpolation\n    if i_start == 0:\n        x_left_nm = 0.0\n    else:\n        phi1 = phi_top[i_start - 1]\n        phi2 = phi_top[i_start]\n        x1 = x_coords_nm[i_start - 1]\n        x2 = x_coords_nm[i_start]\n        x_left_nm = x1 - phi1 * (x2 - x1) / (phi2 - phi1)\n\n    # Calculate right boundary x_right_nm by linear interpolation\n    if i_end == Nx - 1:\n        x_right_nm = W_nm\n    else:\n        phi1 = phi_top[i_end]\n        phi2 = phi_top[i_end + 1]\n        x1 = x_coords_nm[i_end]\n        x2 = x_coords_nm[i_end + 1]\n        x_right_nm = x1 - phi1 * (x2 - x1) / (phi2 - phi1)\n        \n    return x_right_nm - x_left_nm\n\ndef run_simulation_case(case_params):\n    \"\"\"\n    Runs a single simulation case for copper electroplating.\n    \"\"\"\n    # 1. Setup Domain, Constants, and Grid (in SI units)\n    W_nm, H_nm = 200.0, 200.0\n    Nx, Ny = 401, 401\n    \n    W_m, H_m = W_nm * 1e-9, H_nm * 1e-9\n    dx_m = W_m / (Nx - 1)\n    dy_m = H_m / (Ny - 1)\n    \n    w_tr_nm, h_tr_nm = 80.0, 140.0\n    w_tr_m, h_tr_m = w_tr_nm * 1e-9, h_tr_nm * 1e-9\n\n    M, n, F, rho = 63.546e-3, 2.0, 96485.0, 8960.0\n    k_vn_j = M / (n * F * rho)\n\n    x_m = np.linspace(0, W_m, Nx)\n    y_m = np.linspace(0, H_m, Ny)\n    xx_m, yy_m = np.meshgrid(x_m, y_m)\n\n    # 2. Initial Level-Set Function (Signed Distance to Rectangle)\n    x_center_m = W_m / 2.0\n    x_left_m = x_center_m - w_tr_m / 2.0\n    x_right_m = x_center_m + w_tr_m / 2.0\n    y_top_m = 0.0\n    y_bottom_m = h_tr_m\n\n    # Outside distance (negative Euclidean distance to rectangle)\n    dx_dist = np.zeros_like(xx_m)\n    dy_dist = np.zeros_like(yy_m)\n    dx_dist = np.maximum.reduce([dx_dist, x_left_m - xx_m, xx_m - x_right_m])\n    dy_dist = np.maximum.reduce([dy_dist, y_top_m - yy_m, yy_m - y_bottom_m])\n    phi_outside = -np.sqrt(dx_dist**2 + dy_dist**2)\n\n    # Inside distance (minimum perpendicular distance to a side)\n    phi_inside = np.minimum.reduce([\n        xx_m - x_left_m, x_right_m - xx_m,\n        yy_m - y_top_m, y_bottom_m - yy_m\n    ])\n\n    is_inside = (xx_m > x_left_m) & (xx_m < x_right_m) & \\\n                (yy_m > y_top_m) & (yy_m < y_bottom_m)\n    phi = np.where(is_inside, phi_inside, phi_outside)\n\n    # 3. Define Case-Specific Current Density Field\n    j_params = case_params['j_params']\n    case_type = case_params['type']\n    \n    j = np.zeros_like(phi)\n    is_electrolyte = phi >= 0\n\n    if case_type == 'uniform':\n        j0 = j_params['j0']\n        j[is_electrolyte] = j0\n    elif case_type == 'sidewall':\n        j0 = j_params['j0']\n        alpha = j_params['alpha']\n        lambda_val_nm = j_params['lambda']\n        \n        x_l_nm = (W_nm / 2.0) - (w_tr_nm / 2.0)\n        x_r_nm = (W_nm / 2.0) + (w_tr_nm / 2.0)\n        x_coords_nm = x_m * 1e9\n        \n        j_factor = 1.0 + alpha * np.exp(-np.abs(x_coords_nm - x_l_nm) / lambda_val_nm) + \\\n                   alpha * np.exp(-np.abs(x_coords_nm - x_r_nm) / lambda_val_nm)\n        \n        j_factor_2d = np.tile(j_factor, (Ny, 1))\n        j_values = j0 * j_factor_2d\n        j[is_electrolyte] = j_values[is_electrolyte]\n\n    # 4. Evolve PDE for one time step\n    dt = case_params['dt']\n    vn = k_vn_j * j\n    \n    # First-order upwind (Godunov) scheme for |grad(phi)|\n    dpdx_p, dpdx_m = np.zeros_like(phi), np.zeros_like(phi)\n    dpdx_p[:, :-1] = (phi[:, 1:] - phi[:, :-1]) / dx_m\n    dpdx_m[:, 1:] = (phi[:, 1:] - phi[:, :-1]) / dx_m\n\n    dpdy_p, dpdy_m = np.zeros_like(phi), np.zeros_like(phi)\n    dpdy_p[:-1, :] = (phi[1:, :] - phi[:-1, :]) / dy_m\n    dpdy_m[1:, :] = (phi[1:, :] - phi[:-1, :]) / dy_m\n\n    grad_phi_x_sq = np.maximum(dpdx_m, 0)**2 + np.minimum(dpdx_p, 0)**2\n    grad_phi_y_sq = np.maximum(dpdy_m, 0)**2 + np.minimum(dpdy_p, 0)**2\n    grad_phi_mag = np.sqrt(grad_phi_x_sq + grad_phi_y_sq)\n\n    # Explicit Euler step\n    phi_new = phi - dt * vn * grad_phi_mag\n    \n    # 5. Compute Opening Width\n    phi_top = phi_new[0, :]\n    x_coords_nm = x_m * 1e9\n    width = calculate_opening_width(phi_top, x_coords_nm)\n    \n    return width\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: uniform field\n        {'type': 'uniform', 'j_params': {'j0': 300.0}, 'dt': 0.04},\n        # Case B: sidewall-enhanced field\n        {'type': 'sidewall', 'j_params': {'j0': 200.0, 'alpha': 1.0, 'lambda': 5.0}, 'dt': 0.02},\n        # Case C: low-current near-stagnation\n        {'type': 'uniform', 'j_params': {'j0': 10.0}, 'dt': 0.04}\n    ]\n    \n    results = []\n    for case in test_cases:\n        width = run_simulation_case(case)\n        results.append(width)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}