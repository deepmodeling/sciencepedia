{
    "hands_on_practices": [
        {
            "introduction": "The foundation of Molecular Beam Epitaxy is the generation of a precise and stable molecular beam from a heated source. This exercise guides you through the derivation of the beam flux from first principles, linking the macroscopic parameters of an effusion cell—temperature and equilibrium vapor pressure—to the statistical behavior of atoms as described by the kinetic theory of gases. Mastering this calculation  provides a fundamental understanding of what governs the effusive flux, a critical variable for controlling thin-film growth.",
            "id": "4142758",
            "problem": "A gallium effusion cell used in Molecular Beam Epitaxy (MBE) is operated such that the interior gallium surface is at thermodynamic equilibrium with a monatomic vapor at temperature $T=1100\\ \\text{K}$. The mass of a gallium atom is $m=69.7\\ \\text{amu}$. The equilibrium vapor pressure over the gallium surface is $p_{\\text{eq}}=1.0\\times 10^{-2}\\ \\text{Torr}$. The vacuum on the orifice side is sufficiently low that the ambient pressure there can be taken as $p\\approx 0$. The evaporation coefficient (sometimes called the accommodation coefficient) is $\\alpha=1$. \n\nStarting from the kinetic theory of gases, the ideal gas law, and the Maxwell–Boltzmann distribution for molecular speeds, derive the expression for the net emitted number flux density at the orifice as a function of $p_{\\text{eq}}$, $p$, $m$, and $T$, and then compute its value under the given conditions. Use $1\\ \\text{Torr}=133.322\\ \\text{Pa}$ and $1\\ \\text{amu}=1.66053906660\\times 10^{-27}\\ \\text{kg}$. Express your final numerical answer in $\\text{atoms}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$, and round to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- System: Gallium effusion cell in Molecular Beam Epitaxy (MBE).\n- Internal state: Thermodynamic equilibrium between gallium surface and monatomic vapor.\n- Temperature: $T = 1100\\ \\text{K}$.\n- Mass of a gallium atom: $m = 69.7\\ \\text{amu}$.\n- Equilibrium vapor pressure: $p_{\\text{eq}} = 1.0 \\times 10^{-2}\\ \\text{Torr}$.\n- Ambient pressure at orifice: $p \\approx 0$.\n- Evaporation coefficient: $\\alpha = 1$.\n- Conversion constant: $1\\ \\text{Torr} = 133.322\\ \\text{Pa}$.\n- Conversion constant: $1\\ \\text{amu} = 1.66053906660 \\times 10^{-27}\\ \\text{kg}$.\n- Task 1: Derive the expression for the net emitted number flux density $J_{\\text{net}}$ as a function of $p_{\\text{eq}}$, $p$, $m$, and $T$.\n- Task 2: Compute the numerical value of $J_{\\text{net}}$ in units of atoms $\\text{m}^{-2}\\ \\text{s}^{-1}$.\n- Rounding requirement: Four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically sound, resting on the established principles of the kinetic theory of gases, the ideal gas law, and the Maxwell-Boltzmann distribution, all applied to a standard physical system (an effusion cell). The provided values are realistic for MBE applications. The problem is well-posed, providing all necessary information for a unique solution. The language is objective and precise. Therefore, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Flux Density Expression\nThe net number flux density, $J_{\\text{net}}$, emitted from the orifice is the difference between the flux of particles exiting the cell, $J_{\\text{out}}$, and the flux of particles entering the cell from the ambient vacuum, $J_{\\text{in}}$.\n$$J_{\\text{net}} = J_{\\text{out}} - J_{\\text{in}}$$\nWe begin by deriving a general expression for the flux density of particles, $J$, from an ideal gas at pressure $P$ and temperature $T$ impinging on a surface. This flux density represents the number of particles crossing a unit area per unit time.\n\nAccording to the kinetic theory of gases, the number density of particles, $n$, is related to the pressure $P$ and temperature $T$ by the ideal gas law:\n$$P = n k_B T \\implies n = \\frac{P}{k_B T}$$\nwhere $k_B$ is the Boltzmann constant.\n\nThe velocities of the particles in the gas are described by the Maxwell-Boltzmann velocity distribution. For a gas in thermal equilibrium, the probability distribution function for the velocity vector $\\mathbf{v} = (v_x, v_y, v_z)$ is given by:\n$$f(\\mathbf{v}) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x^2+v_y^2+v_z^2)}{2k_B T}\\right)$$\nThe number of particles per unit volume with velocities in the infinitesimal range $d^3\\mathbf{v} = dv_x dv_y dv_z$ around $\\mathbf{v}$ is $n f(\\mathbf{v})d^3\\mathbf{v}$.\n\nConsider the orifice to lie in the $xy$-plane. The number of particles with velocity $\\mathbf{v}$ that cross an infinitesimal area $dA$ in this plane in a time $dt$ is the number of particles contained in a skewed cylinder with base $dA$ and height $v_z dt$. This number is $(v_z dt dA) \\times (n f(\\mathbf{v}) d^3\\mathbf{v})$. We are interested in the flux, which is the number of particles per unit area per unit time. We must integrate over all possible velocities for particles moving towards the orifice, i.e., those with $v_z > 0$.\n\nThe flux density $J$ is thus given by the integral:\n$$J = \\int_{-\\infty}^{\\infty} dv_x \\int_{-\\infty}^{\\infty} dv_y \\int_{0}^{\\infty} dv_z \\, v_z \\, n \\, f(\\mathbf{v})$$\nSubstituting the expressions for $n$ and $f(\\mathbf{v})$:\n$$J = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_{-\\infty}^{\\infty} dv_x \\int_{-\\infty}^{\\infty} dv_y \\int_{0}^{\\infty} dv_z \\, v_z \\exp\\left(-\\frac{m(v_x^2+v_y^2+v_z^2)}{2k_B T}\\right)$$\nThe integral can be separated into three parts:\n$$J = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left[\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_x^2}{2k_B T}\\right) dv_x\\right] \\left[\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_y^2}{2k_B T}\\right) dv_y\\right] \\left[\\int_{0}^{\\infty} v_z \\exp\\left(-\\frac{mv_z^2}{2k_B T}\\right) dv_z\\right]$$\nThe first two integrals are standard Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$. With $a = \\frac{m}{2k_B T}$, each of these integrals evaluates to $\\sqrt{\\frac{2\\pi k_B T}{m}}$.\n\nThe third integral is evaluated using a substitution. Let $u = \\frac{mv_z^2}{2k_B T}$, which implies $du = \\frac{mv_z}{k_B T} dv_z$, or $v_z dv_z = \\frac{k_B T}{m} du$. The limits of integration for $u$ are from $0$ to $\\infty$.\n$$\\int_{0}^{\\infty} v_z \\exp\\left(-\\frac{mv_z^2}{2k_B T}\\right) dv_z = \\int_{0}^{\\infty} \\frac{k_B T}{m} \\exp(-u) du = \\frac{k_B T}{m} [-\\exp(-u)]_{0}^{\\infty} = \\frac{k_B T}{m} (0 - (-1)) = \\frac{k_B T}{m}$$\nSubstituting the results of the three integrals back into the expression for $J$:\n$$J = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left(\\sqrt{\\frac{2\\pi k_B T}{m}}\\right)^2 \\left(\\frac{k_B T}{m}\\right)$$\n$$J = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left(\\frac{2\\pi k_B T}{m}\\right) \\left(\\frac{k_B T}{m}\\right) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} \\left(\\frac{k_B T}{m}\\right) = n \\sqrt{\\frac{k_B T}{2\\pi m}}$$\nNow, substitute $n = P/(k_B T)$:\n$$J = \\frac{P}{k_B T} \\sqrt{\\frac{k_B T}{2\\pi m}} = \\frac{P}{\\sqrt{2\\pi m k_B T}}$$\nThis is the Hertz-Knudsen equation for the flux of particles impinging on a surface.\n\nThe flux exiting the cell, $J_{\\text{out}}$, is determined by the equilibrium conditions inside. The evaporation coefficient $\\alpha=1$ signifies that the rate of evaporation from the surface is equal to the flux that would be required to maintain the equilibrium vapor pressure $p_{\\text{eq}}$. Thus, $J_{\\text{out}}$ corresponds to the flux from a gas at pressure $p_{\\text{eq}}$ and temperature $T$.\n$$J_{\\text{out}} = \\frac{p_{\\text{eq}}}{\\sqrt{2\\pi m k_B T}}$$\nThe flux entering the cell, $J_{\\text{in}}$, is determined by the ambient conditions outside, where the pressure is $p$ and the temperature is assumed to be $T$.\n$$J_{\\text{in}} = \\frac{p}{\\sqrt{2\\pi m k_B T}}$$\nThe net emitted flux density is therefore:\n$$J_{\\text{net}} = J_{\\text{out}} - J_{\\text{in}} = \\frac{p_{\\text{eq}} - p}{\\sqrt{2\\pi m k_B T}}$$\nThis is the required expression.\n\n### Numerical Calculation\nThe problem states that the ambient pressure is negligible, $p \\approx 0$. The net flux expression simplifies to:\n$$J_{\\text{net}} = \\frac{p_{\\text{eq}}}{\\sqrt{2\\pi m k_B T}}$$\nWe now substitute the given values in SI units.\n- Pressure $p_{\\text{eq}}$:\n$$p_{\\text{eq}} = 1.0 \\times 10^{-2}\\ \\text{Torr} \\times \\frac{133.322\\ \\text{Pa}}{1\\ \\text{Torr}} = 1.33322\\ \\text{Pa}$$\n- Mass $m$:\n$$m = 69.7\\ \\text{amu} \\times \\frac{1.66053906660 \\times 10^{-27}\\ \\text{kg}}{1\\ \\text{amu}} = 1.1573962 \\times 10^{-25}\\ \\text{kg}$$\n- Temperature $T$:\n$$T = 1100\\ \\text{K}$$\n- Boltzmann constant $k_B$:\n$$k_B \\approx 1.380649 \\times 10^{-23}\\ \\text{J K}^{-1}$$\n\nFirst, we compute the denominator $\\sqrt{2\\pi m k_B T}$:\n$$2\\pi m k_B T = 2\\pi \\times (1.1573962 \\times 10^{-25}\\ \\text{kg}) \\times (1.380649 \\times 10^{-23}\\ \\text{J K}^{-1}) \\times (1100\\ \\text{K})$$\n$$2\\pi m k_B T \\approx (6.283185) \\times (1.1573962 \\times 10^{-25}) \\times (1.5187139 \\times 10^{-20})\\ \\text{kg J}$$\n$$2\\pi m k_B T \\approx 1.104426 \\times 10^{-44}\\ \\text{kg}^2 \\text{m}^2 \\text{s}^{-2}$$\nTaking the square root:\n$$\\sqrt{2\\pi m k_B T} \\approx \\sqrt{1.104426 \\times 10^{-44}\\ \\text{kg}^2 \\text{m}^2 \\text{s}^{-2}} \\approx 1.050917 \\times 10^{-22}\\ \\text{kg m s}^{-1}$$\nFinally, we calculate the net flux density $J_{\\text{net}}$:\n$$J_{\\text{net}} = \\frac{1.33322\\ \\text{Pa}}{1.050917 \\times 10^{-22}\\ \\text{kg m s}^{-1}} = \\frac{1.33322\\ \\text{N m}^{-2}}{1.050917 \\times 10^{-22}\\ \\text{kg m s}^{-1}}$$\n$$J_{\\text{net}} \\approx 1.268633 \\times 10^{22}\\ \\text{m}^{-2} \\text{s}^{-1}$$\nRounding to four significant figures as required, we get:\n$$J_{\\text{net}} \\approx 1.269 \\times 10^{22}\\ \\text{atoms}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$$",
            "answer": "$$\\boxed{1.269 \\times 10^{22}}$$"
        },
        {
            "introduction": "In practice, achieving the desired stoichiometry and growth rate in MBE demands an exquisitely stable molecular flux. This problem explores the acute sensitivity of this flux to the effusion cell's temperature, a primary control variable. By integrating the kinetic model of effusion with the thermodynamic Clausius-Clapeyron relation , you will quantify why even a small fluctuation in temperature can produce a large, often undesirable, change in the deposition rate, underscoring the necessity for highly precise temperature regulation.",
            "id": "4142800",
            "problem": "In Molecular Beam Epitaxy (MBE), the arsenic tetramer ($As_4$) flux emitted by an effusion cell operating in the molecular flow regime is controlled by the equilibrium vapor pressure of $As_4$ over the source material and by the kinetic theory of gases. Assume the following physically standard bases:\n- Kinetic theory for effusion states that the molecular flux $J$ is proportional to the equilibrium vapor pressure $p_{\\text{eq}}$ divided by the square root of temperature due to the Maxwell-Boltzmann speed distribution, with $J \\propto \\frac{p_{\\text{eq}}}{\\sqrt{T}}$ when other factors (e.g., orifice geometry and molecular mass) are held fixed.\n- Over a limited temperature range, the integrated Clausius-Clapeyron relation for equilibrium vapor pressure can be expressed as $\\ln p_{\\text{eq}}=-\\frac{\\Delta H}{R\\,T}+C$, where $\\Delta H$ is the molar enthalpy of sublimation or evaporation, $R$ is the universal gas constant, and $C$ is a constant determined by calibration.\n\nConsider an $As_4$ effusion cell with a calibrated constant $C$ and a known molar enthalpy $\\Delta H = 2.0\\times 10^{5}\\ \\text{J}\\ \\text{mol}^{-1}$. Around $T=600\\ \\text{K}$, estimate the multiplicative change in the $As_4$ flux when the cell temperature is increased by $\\Delta T=20\\ \\text{K}$, assuming the molecular flow regime, constant accommodation factor, and unchanged geometry. Use $R=8.314\\ \\text{J}\\ \\text{mol}^{-1}\\ \\text{K}^{-1}$. Express your final answer as a single dimensionless multiplicative factor (i.e., $J(T+\\Delta T)/J(T)$), and round your answer to three significant figures.",
            "solution": "The goal is to estimate the multiplicative change in the flux $J$ emitted by an effusion cell as the temperature increases from $T$ to $T+\\Delta T$. In the molecular flow regime, the effusive flux from an orifice can be derived from kinetic theory (Maxwell-Boltzmann distribution) and is given, up to geometry and accommodation factors, by the Hertz-Knudsen form\n$$\nJ \\propto \\frac{p_{\\text{eq}}}{\\sqrt{T}},\n$$\nwhere $p_{\\text{eq}}$ is the equilibrium vapor pressure of the species in the cell.\n\nOver the relevant temperature range, the equilibrium vapor pressure follows the integrated Clausius-Clapeyron relation\n$$\n\\ln p_{\\text{eq}} = -\\frac{\\Delta H}{R\\,T} + C,\n$$\nwhere $\\Delta H$ is the molar enthalpy of sublimation or evaporation, $R$ is the universal gas constant, and $C$ is a calibration constant. Taking the ratio of pressures at two temperatures $T_{1}$ and $T_{2}$ removes $C$:\n$$\n\\frac{p_{\\text{eq}}(T_{2})}{p_{\\text{eq}}(T_{1})} = \\exp\\!\\left(-\\frac{\\Delta H}{R}\\left(\\frac{1}{T_{2}}-\\frac{1}{T_{1}}\\right)\\right).\n$$\nThe flux ratio is then\n$$\n\\frac{J(T_{2})}{J(T_{1})} = \\frac{p_{\\text{eq}}(T_{2})}{p_{\\text{eq}}(T_{1})}\\,\\sqrt{\\frac{T_{1}}{T_{2}}}\n= \\exp\\!\\left(-\\frac{\\Delta H}{R}\\left(\\frac{1}{T_{2}}-\\frac{1}{T_{1}}\\right)\\right)\\sqrt{\\frac{T_{1}}{T_{2}}}.\n$$\n\nWe set $T_{1}=600\\ \\text{K}$ and $T_{2}=T_{1}+\\Delta T=620\\ \\text{K}$, with $\\Delta H=2.0\\times 10^{5}\\ \\text{J}\\ \\text{mol}^{-1}$ and $R=8.314\\ \\text{J}\\ \\text{mol}^{-1}\\ \\text{K}^{-1}$. Compute the pressure ratio exponent:\n$$\n\\frac{1}{T_{1}} - \\frac{1}{T_{2}} = \\frac{1}{600} - \\frac{1}{620} = \\frac{620-600}{600\\times 620} = \\frac{20}{372000} = \\frac{1}{18600}.\n$$\nTherefore,\n$$\n-\\frac{\\Delta H}{R}\\left(\\frac{1}{T_{2}}-\\frac{1}{T_{1}}\\right) = \\frac{\\Delta H}{R}\\left(\\frac{1}{T_{1}}-\\frac{1}{T_{2}}\\right) = \\frac{2.0\\times 10^{5}}{8.314}\\times \\frac{1}{18600}.\n$$\nKeep the constants symbolic until this final step. Evaluate:\n$$\n\\frac{\\Delta H}{R} = \\frac{2.0\\times 10^{5}}{8.314} \\approx 2.4057\\times 10^{4},\n$$\nso\n$$\n\\frac{\\Delta H}{R}\\left(\\frac{1}{T_{1}}-\\frac{1}{T_{2}}\\right) \\approx 2.4057\\times 10^{4}\\times \\frac{1}{18600} \\approx 1.2934.\n$$\nHence,\n$$\n\\frac{p_{\\text{eq}}(620\\ \\text{K})}{p_{\\text{eq}}(600\\ \\text{K})} \\approx \\exp(1.2934).\n$$\nNow include the temperature dependence from kinetic theory:\n$$\n\\sqrt{\\frac{T_{1}}{T_{2}}} = \\sqrt{\\frac{600}{620}} = \\sqrt{\\frac{30}{31}} \\approx 0.98374.\n$$\nThus the flux ratio is\n$$\n\\frac{J(620\\ \\text{K})}{J(600\\ \\text{K})} \\approx \\exp(1.2934)\\times 0.98374.\n$$\nNumerically, $\\exp(1.2934)\\approx 3.6456$, giving\n$$\n\\frac{J(620\\ \\text{K})}{J(600\\ \\text{K})} \\approx 3.6456\\times 0.98374 \\approx 3.59.\n$$\nRounded to three significant figures, the multiplicative change in flux is approximately $3.59$, which is dimensionless as requested.",
            "answer": "$$\\boxed{3.59}$$"
        },
        {
            "introduction": "This final practice elevates our analysis from steady-state conditions to the dynamic, real-time control of the growth process itself. You will design a Model Predictive Control (MPC) strategy, a powerful technique used in advanced manufacturing, to regulate the film growth rate precisely over time. By formulating the physical system as a discrete-time model and solving a constrained optimization problem , you will determine the optimal control sequence to achieve a desired growth profile while respecting physical actuator limits, bridging the gap between physical modeling and high-performance process automation.",
            "id": "4142797",
            "problem": "Consider the regulation of molecular beam epitaxy (MBE) growth rate via control of the incident atomic flux. Let the effective adsorbed flux state be modeled by the discrete-time linear recursion derived from a first-order adsorption-limited dynamic and zero-order hold sampling: starting from the continuous-time ordinary differential equation (ODE) $dx(t)/dt = -(x(t) - u(t))/\\tau$, where $x(t)$ is the effective adsorbed flux, $u(t)$ is the incident beam flux, and $\\tau$ is a time constant, use a sampling period $T_s$ to obtain a discrete-time linear time-invariant model $x_{k+1} = a x_k + b u_k$ with $a = \\exp(-T_s/\\tau)$ and $b = 1 - a$. The measurable growth rate is $y_k = c x_k$, where $c$ is a conversion factor mapping effective flux to monolayers per second.\n\nThe control input sequence is the incident flux $u_k$ in units of atoms per square centimeter per second, and the control increment is $\\Delta u_k = u_k - u_{k-1}$. Assume an initial steady state at time $k=0$ such that $x_0 = u_0$, and define the regulation target to be a step change in growth rate to a constant setpoint $r$ (in monolayers per second) from the initial $y_0 = c u_0$.\n\nDesign a finite-horizon Model Predictive Control (MPC) problem with horizon $N = 20$, which minimizes a quadratic cost comprising tracking error and input increment effort, subject to actuator saturation and slew-rate constraints, and disallows overshoot beyond the setpoint over the prediction horizon. The MPC cost is\n$$\nJ = \\sum_{i=1}^{N} q \\left(y_i - r\\right)^2 + \\sum_{k=0}^{N-1} r_{\\Delta} \\left(\\Delta u_k\\right)^2,\n$$\nwhere $q > 0$ and $r_{\\Delta} > 0$ are scalar weights. The constraints are\n- flux bounds $u_{\\min} \\le u_k \\le u_{\\max}$ for all $k$ within the horizon,\n- slew bounds $\\Delta u_{\\min} \\le \\Delta u_k \\le \\Delta u_{\\max}$ for all $k$ within the horizon,\n- overshoot avoidance $y_i \\le r$ for all $i = 1,\\dots,N$.\n\nExpress the prediction in terms of the control increments $\\Delta u_0,\\dots,\\Delta u_{N-1}$, assuming $u_k = u_0 + \\sum_{j=0}^{k} \\Delta u_j$. Formulate the resulting constrained quadratic optimization problem in condensed form over the decision vector of control increments, and solve it numerically.\n\nYour program must compute, for each test case specified below, the optimal incident flux trajectory $\\{u_k\\}_{k=0}^{N-1}$ in atoms per square centimeter per second to achieve the specified step change in growth rate without overshoot, and a boolean flag indicating whether overshoot is detected in the predicted growth rate trajectory. The overshoot flag must be $false$ if and only if $y_i \\le r$ holds for all $i=1,\\dots,N$, using a strict numerical tolerance of $10^{-9}$ in the inequality check. Output each flux trajectory as a list of $N$ floats in atoms per square centimeter per second. Aggregate the results for all test cases into a single line as a comma-separated list enclosed in square brackets. Each element of this top-level list must itself be a two-element list: the first element is the overshoot boolean, and the second element is the list of $N$ flux values. No units string may appear in the output values, which must be pure numbers.\n\nUse the following test suite of parameter values:\n\n- Test case 1 (general case):\n  - $T_s = 0.5$ seconds,\n  - $\\tau = 2.0$ seconds,\n  - $c = 10^{-14}$ monolayers per second per (atoms per square centimeter per second),\n  - $u_0 = 1.0 \\times 10^{14}$ atoms per square centimeter per second,\n  - $r = 1.2$ monolayers per second,\n  - $u_{\\min} = 0.8 \\times 10^{14}$ atoms per square centimeter per second,\n  - $u_{\\max} = 1.5 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\min} = -0.05 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\max} = 0.05 \\times 10^{14}$ atoms per square centimeter per second,\n  - $q = 1.0$,\n  - $r_{\\Delta} = 1.0 \\times 10^{-28}$.\n\n- Test case 2 (slow dynamics and tight slew bounds):\n  - $T_s = 0.5$ seconds,\n  - $\\tau = 4.0$ seconds,\n  - $c = 10^{-14}$ monolayers per second per (atoms per square centimeter per second),\n  - $u_0 = 1.0 \\times 10^{14}$ atoms per square centimeter per second,\n  - $r = 1.3$ monolayers per second,\n  - $u_{\\min} = 0.8 \\times 10^{14}$ atoms per square centimeter per second,\n  - $u_{\\max} = 1.5 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\min} = -0.01 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\max} = 0.01 \\times 10^{14}$ atoms per square centimeter per second,\n  - $q = 1.0$,\n  - $r_{\\Delta} = 1.0 \\times 10^{-28}$.\n\n- Test case 3 (no step change boundary case):\n  - $T_s = 0.5$ seconds,\n  - $\\tau = 1.0$ seconds,\n  - $c = 10^{-14}$ monolayers per second per (atoms per square centimeter per second),\n  - $u_0 = 1.0 \\times 10^{14}$ atoms per square centimeter per second,\n  - $r = 1.0$ monolayers per second,\n  - $u_{\\min} = 0.8 \\times 10^{14}$ atoms per square centimeter per second,\n  - $u_{\\max} = 1.5 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\min} = -0.05 \\times 10^{14}$ atoms per square centimeter per second,\n  - $\\Delta u_{\\max} = 0.05 \\times 10^{14}$ atoms per square centimeter per second,\n  - $q = 1.0$,\n  - $r_{\\Delta} = 1.0 \\times 10^{-28}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[result_case_1_boolean,[u_0,u_1,...,u_19]],[result_case_2_boolean,[...]],...]\"). All flux values must be expressed in atoms per square centimeter per second as plain floating point numbers. Angles are not used. Percentages are not used.",
            "solution": "The user-provided problem is assessed to be valid. It is a well-posed, scientifically grounded problem in the domain of process control systems engineering, specifically Model Predictive Control (MPC). The problem statement is self-contained, its parameters are physically plausible for molecular beam epitaxy, and the objective is clearly defined. We will proceed to formulate and solve the problem.\n\nThe task is to design a finite-horizon MPC controller to regulate the growth rate in an MBE process. The controller must minimize a quadratic cost function involving tracking error and control effort, while respecting constraints on actuator level, slew rate, and avoiding any overshoot of the growth rate setpoint. This can be formulated as a Quadratic Programming (QP) problem. The decision variables for the optimization will be the sequence of future control increments, $\\Delta u_k$.\n\nLet the vector of control increments over the prediction horizon $N$ be denoted by $\\Delta \\mathbf{U} = [\\Delta u_0, \\Delta u_1, \\dots, \\Delta u_{N-1}]^T$. Our goal is to express the cost function and constraints in terms of this vector.\n\n**1. Prediction Model Formulation**\n\nThe system is described by the linear time-invariant (LTI) state-space model:\n$$\nx_{k+1} = a x_k + b u_k \\\\\ny_k = c x_k\n$$\nwith $a = \\exp(-T_s/\\tau)$ and $b = 1-a$. The system is initially at a steady state where the incident flux is $u_k = u_{ss}$ for $k < 0$. The problem specifies this initial flux as $u_0$. To avoid ambiguity, we denote this initial steady-state value as $u_{ss}$. The initial state is therefore $x_0 = u_{ss}$, which implies an initial growth rate of $y_0 = c x_0 = c u_{ss}$, which we denote $y_{ss}$.\n\nThe future control inputs $u_k$ for $k \\ge 0$ are determined by the sequence of control increments $\\Delta u_k = u_k - u_{k-1}$, starting from the value $u_{-1} = u_{ss}$. The problem gives the relation as $u_k = u_{ss} + \\sum_{j=0}^{k} \\Delta u_j$. This is consistent with $u_k = u_{k-1} + \\Delta u_k$ for $k \\ge 1$ and $u_0 = u_{ss} + \\Delta u_0$.\n\nThe state at a future time step $i$ ($i=1, \\dots, N$) can be found by unrolling the recurrence relation:\n$$\nx_i = a^i x_0 + \\sum_{k=0}^{i-1} a^{i-1-k} b u_k\n$$\nSubstituting $x_0 = u_{ss}$ and $u_k = u_{ss} + \\sum_{j=0}^{k} \\Delta u_j$, after algebraic manipulation and reordering of summations, we arrive at a direct relationship between the state $x_i$ and the control increments:\n$$\nx_i = u_{ss} + \\sum_{j=0}^{i-1} (1 - a^{i-j}) \\Delta u_j\n$$\nThe corresponding output prediction is $y_i = c x_i$:\n$$\ny_i = c u_{ss} + c \\sum_{j=0}^{i-1} (1 - a^{i-j}) \\Delta u_j\n$$\nWe can express the entire predicted output sequence $\\mathbf{Y} = [y_1, y_2, \\dots, y_N]^T$ in a condensed matrix form:\n$$\n\\mathbf{Y} = \\mathbf{1} y_{ss} + \\mathbf{S}_{\\Delta} \\Delta \\mathbf{U}\n$$\nwhere $\\mathbf{1}$ is an $N \\times 1$ vector of ones, and $\\mathbf{S}_{\\Delta}$ is an $N \\times N$ lower-triangular matrix whose elements (using 0-based indexing for rows $i$ and columns $j$) are given by:\n$$\n(\\mathbf{S}_{\\Delta})_{ij} = \\begin{cases} c(1 - a^{i-j+1}) & \\text{if } j \\le i \\\\ 0 & \\text{if } j > i \\end{cases}\n$$\n\n**2. Quadratic Programming (QP) Cost Function**\n\nThe cost function to be minimized is:\n$$\nJ = \\sum_{i=1}^{N} q (y_i - r)^2 + \\sum_{k=0}^{N-1} r_{\\Delta} (\\Delta u_k)^2\n$$\nLet $\\mathbf{R}$ be an $N \\times 1$ vector where each element is the setpoint $r$. The cost can be written in vector form:\n$$\nJ = q (\\mathbf{Y} - \\mathbf{R})^T (\\mathbf{Y} - \\mathbf{R}) + r_{\\Delta} \\Delta \\mathbf{U}^T \\mathbf{I} \\Delta \\mathbf{U}\n$$\nSubstituting the prediction model $\\mathbf{Y} = \\mathbf{1} y_{ss} + \\mathbf{S}_{\\Delta} \\Delta \\mathbf{U}$:\n$$\nJ = q (\\mathbf{S}_{\\Delta} \\Delta \\mathbf{U} + \\mathbf{1} y_{ss} - \\mathbf{R})^T (\\mathbf{S}_{\\Delta} \\Delta \\mathbf{U} + \\mathbf{1} y_{ss} - \\mathbf{R}) + r_{\\Delta} \\Delta \\mathbf{U}^T \\Delta \\mathbf{U}\n$$\nExpanding this expression, we obtain the standard QP cost form $\\frac{1}{2}\\Delta \\mathbf{U}^T \\mathbf{H} \\Delta \\mathbf{U} + \\mathbf{f}^T \\Delta \\mathbf{U} + \\text{const}$. The constant term does not affect the location of the minimum and can be ignored.\nThe Hessian matrix $\\mathbf{H}$ is:\n$$\n\\mathbf{H} = 2 (q \\mathbf{S}_{\\Delta}^T \\mathbf{S}_{\\Delta} + r_{\\Delta} \\mathbf{I})\n$$\nThe linear term vector $\\mathbf{f}$ is:\n$$\n\\mathbf{f} = 2 q \\mathbf{S}_{\\Delta}^T (\\mathbf{1} y_{ss} - \\mathbf{R})\n$$\nSince $q > 0$ and $r_{\\Delta} > 0$, the Hessian $\\mathbf{H}$ is symmetric and positive definite, ensuring the QP problem is convex and has a unique minimum.\n\n**3. Linear Constraints Formulation**\n\nAll constraints must be expressed as linear inequalities of the form $\\mathbf{A}_{ineq} \\Delta \\mathbf{U} \\le \\mathbf{b}_{ineq}$.\n\n- **Slew Rate Constraints**: $\\Delta u_{\\min} \\le \\Delta u_k \\le \\Delta u_{\\max}$ for $k=0, \\dots, N-1$.\n  These are box constraints on the decision variables:\n  $$\n  \\mathbf{I} \\Delta \\mathbf{U} \\le \\mathbf{1} \\Delta u_{\\max} \\\\\n  -\\mathbf{I} \\Delta \\mathbf{U} \\le -\\mathbf{1} \\Delta u_{\\min}\n  $$\n- **Flux (Actuator) Constraints**: $u_{\\min} \\le u_k \\le u_{\\max}$ for $k=0, \\dots, N-1$.\n  The input trajectory $\\mathbf{U} = [u_0, \\dots, u_{N-1}]^T$ is related to $\\Delta \\mathbf{U}$ by $\\mathbf{U} = \\mathbf{1} u_{ss} + \\mathbf{L} \\Delta \\mathbf{U}$, where $\\mathbf{L}$ is an $N \\times N$ lower-triangular matrix of ones. The constraints are:\n  $$\n  \\mathbf{L} \\Delta \\mathbf{U} \\le \\mathbf{1} (u_{\\max} - u_{ss}) \\\\\n  -\\mathbf{L} \\Delta \\mathbf{U} \\le -\\mathbf{1} (u_{\\min} - u_{ss})\n  $$\n- **Overshoot Avoidance Constraint**: $y_i \\le r$ for $i=1, \\dots, N$.\n  In vector form, $\\mathbf{Y} \\le \\mathbf{R}$. Substituting the prediction model:\n  $$\n  \\mathbf{1} y_{ss} + \\mathbf{S}_{\\Delta} \\Delta \\mathbf{U} \\le \\mathbf{R} \\implies \\mathbf{S}_{\\Delta} \\Delta \\mathbf{U} \\le \\mathbf{R} - \\mathbf{1} y_{ss}\n  $$\n\nThese $5N$ linear inequalities can be stacked into a single matrix inequality $\\mathbf{A}_{ineq} \\Delta \\mathbf{U} \\le \\mathbf{b}_{ineq}$, where:\n$$\n\\mathbf{A}_{ineq} = \\begin{pmatrix} \\mathbf{I} \\\\ -\\mathbf{I} \\\\ \\mathbf{L} \\\\ -\\mathbf{L} \\\\ \\mathbf{S}_{\\Delta} \\end{pmatrix}, \\quad\n\\mathbf{b}_{ineq} = \\begin{pmatrix} \\mathbf{1} \\Delta u_{\\max} \\\\ -\\mathbf{1}\\Delta u_{\\min} \\\\ \\mathbf{1}(u_{\\max} - u_{ss}) \\\\ \\mathbf{1}(u_{ss} - u_{\\min}) \\\\ \\mathbf{R} - \\mathbf{1}y_{ss} \\end{pmatrix}\n$$\n\n**4. Numerical Solution**\n\nThe complete problem is to minimize $\\frac{1}{2}\\Delta \\mathbf{U}^T \\mathbf{H} \\Delta \\mathbf{U} + \\mathbf{f}^T \\Delta \\mathbf{U}$ subject to $\\mathbf{A}_{ineq} \\Delta \\mathbf{U} \\le \\mathbf{b}_{ineq}$. This is a standard QP problem that can be solved efficiently using numerical optimization libraries. We will use the `scipy.optimize.minimize` function with the 'SLSQP' (Sequential Least Squares Programming) method, which is suitable for constrained nonlinear (and thus quadratic) optimization.\n\nOnce the optimal control increment sequence $\\Delta \\mathbf{U}^*$ is found, the optimal flux trajectory is reconstructed via $\\mathbf{U}^* = \\mathbf{1} u_{ss} + \\mathbf{L} \\Delta \\mathbf{U}^*$. The predicted output trajectory is then $\\mathbf{Y}^* = \\mathbf{1} y_{ss} + \\mathbf{S}_{\\Delta} \\Delta \\mathbf{U}^*$, which is checked for overshoot against the setpoint $r$ with a tolerance of $10^{-9}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\nimport sys\n\n# Ensure Python version is 3.12, as float-to-string conversion behavior can vary.\nif sys.version_info.major != 3 or sys.version_info.minor != 12:\n    # Using a warning instead of an error to allow for minor version differences\n    # if they don't affect the output format.\n    # print(\"Warning: This script is designed for Python 3.12. Output format may differ.\", file=sys.stderr)\n    pass\n\n\ndef solve_mpc_case(params):\n    \"\"\"\n    Solves one instance of the MBE growth rate control problem.\n    \"\"\"\n    Ts = params[\"Ts\"]\n    tau = params[\"tau\"]\n    c = params[\"c\"]\n    u0 = params[\"u0\"]\n    r = params[\"r\"]\n    u_min = params[\"u_min\"]\n    u_max = params[\"u_max\"]\n    du_min = params[\"du_min\"]\n    du_max = params[\"du_max\"]\n    q = params[\"q\"]\n    r_delta = params[\"r_delta\"]\n    N = 20\n    \n    # Model parameters\n    a = np.exp(-Ts / tau)\n    uss = u0\n    yss = c * uss\n\n    # Build prediction matrices\n    # S_delta: maps delta_u to changes in y\n    S_delta = np.zeros((N, N))\n    for i in range(N):\n        for j in range(i + 1):\n            S_delta[i, j] = c * (1 - a**(i - j + 1))\n            \n    # L: maps delta_u to u by cumulative sum\n    L = np.tril(np.ones((N, N)))\n    \n    # Formulate the QP problem: min 1/2 * x'Hx + f'x\n    # H: Hessian matrix\n    H = 2 * (q * (S_delta.T @ S_delta) + r_delta * np.identity(N))\n    \n    # f: Linear term vector\n    E_vec = np.full(N, yss - r)\n    f = 2 * q * (S_delta.T @ E_vec)\n    \n    # Objective function for scipy.optimize.minimize\n    def objective(delta_u):\n        # We can drop the constant term from the full cost function\n        cost = 0.5 * delta_u.T @ H @ delta_u + f.T @ delta_u\n        return cost\n        \n    # Assemble linear inequality constraints: A_ineq * x <= b_ineq\n    # This is equivalent to b_ineq - A_ineq * x >= 0 for the solver interface.\n    \n    # 1. Slew rate constraints: du_min <= delta_u <= du_max\n    A1 = np.identity(N)\n    b1 = np.full(N, du_max)\n    A2 = -np.identity(N)\n    b2 = np.full(N, -du_min)\n    \n    # 2. Flux bounds: u_min <= u <= u_max\n    # u = uss + L * delta_u => L * delta_u <= u_max - uss\n    #                         -L * delta_u <= uss - u_min\n    A3 = L\n    b3 = np.full(N, u_max - uss)\n    A4 = -L\n    b4 = np.full(N, uss - u_min)\n    \n    # 3. Overshoot constraint: y <= r\n    # y = yss + S_delta * delta_u => S_delta * delta_u <= r - yss\n    A5 = S_delta\n    b5 = np.full(N, r - yss)\n    \n    # Combine into a single matrix inequality\n    A_ineq = np.vstack([A1, A2, A3, A4, A5])\n    b_ineq = np.concatenate([b1, b2, b3, b4, b5])\n    \n    constraints = [{'type': 'ineq', 'fun': lambda delta_u: b_ineq - A_ineq @ delta_u}]\n    \n    # Initial guess for the solver\n    delta_u_initial = np.zeros(N)\n    \n    # Solve the QP\n    result = minimize(objective, delta_u_initial, method='SLSQP', constraints=constraints, options={'disp': False})\n    \n    if not result.success:\n        raise RuntimeError(f\"Optimization failed: {result.message}\")\n        \n    delta_u_opt = result.x\n    \n    # Reconstruct optimal input and output trajectories\n    u_opt = uss + L @ delta_u_opt\n    y_opt = yss + S_delta @ delta_u_opt\n    \n    # Check for overshoot with a tolerance of 1e-9\n    overshoot_detected = np.any(y_opt > r + 1e-9)\n    \n    return [overshoot_detected, u_opt.tolist()]\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"Ts\": 0.5, \"tau\": 2.0, \"c\": 1e-14, \"u0\": 1.0e14, \"r\": 1.2,\n            \"u_min\": 0.8e14, \"u_max\": 1.5e14, \"du_min\": -0.05e14, \"du_max\": 0.05e14,\n            \"q\": 1.0, \"r_delta\": 1.0e-28\n        },\n        {\n            \"Ts\": 0.5, \"tau\": 4.0, \"c\": 1e-14, \"u0\": 1.0e14, \"r\": 1.3,\n            \"u_min\": 0.8e14, \"u_max\": 1.5e14, \"du_min\": -0.01e14, \"du_max\": 0.01e14,\n            \"q\": 1.0, \"r_delta\": 1.0e-28\n        },\n        {\n            \"Ts\": 0.5, \"tau\": 1.0, \"c\": 1e-14, \"u0\": 1.0e14, \"r\": 1.0,\n            \"u_min\": 0.8e14, \"u_max\": 1.5e14, \"du_min\": -0.05e14, \"du_max\": 0.05e14,\n            \"q\": 1.0, \"r_delta\": 1.0e-28\n        },\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_mpc_case(case_params)\n        results.append(result)\n\n    # Format the final output string according to the spec\n    # e.g., \"[[false,[...]],[true,[...]]]\"\n    result_strings = []\n    for res_bool, res_list in results:\n        bool_str = str(res_bool).lower()\n        # Python's default float-to-string for large numbers may not use\n        # scientific notation. We use str() to get the required \"plain\" format.\n        list_str = '[' + ','.join(map(str, res_list)) + ']'\n        result_strings.append(f\"[{bool_str},{list_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}