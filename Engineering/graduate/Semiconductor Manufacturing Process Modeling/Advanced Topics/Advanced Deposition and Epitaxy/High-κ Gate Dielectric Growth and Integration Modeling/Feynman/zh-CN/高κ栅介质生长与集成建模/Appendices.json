{
    "hands_on_practices": [
        {
            "introduction": "高介电常数（high-κ）材料是延续摩尔定律的关键，它允许在维持低泄漏电流的同时，等效地缩减栅极电介质的厚度。本练习将引导你回到第一性原理，探索等效氧化物厚度（EOT）这一核心概念。通过推导和计算，你将掌握如何将材料的物理厚度与其介电常数（$κ$值）和最终的电学性能（以EOT衡量）联系起来，并分析$κ$值不确定性对工艺控制的影响，这是栅极工程中最基本的建模技能。",
            "id": "4130669",
            "problem": "将一种二氧化铪 (HfO$_2$) 高介电常数 (high-$\\kappa$) 栅极电介质作为平面薄膜集成在硅上，并根据静电学第一性原理对其电容进行建模。栅堆叠被理想化为一个相对介电常数为 $\\kappa$ 的单一均匀电介质层，且没有额外的串联界面层或耗尽效应。等效氧化物厚度 (EOT) 定义为：当实际的高-$\\kappa$ 层和二氧化硅 (SiO$_2$) 层都被视为面积相等的平行板电容器时，能够产生相同栅极电容的二氧化硅层的厚度 $t_{\\mathrm{EOT}}$。设 SiO$_2$ 的相对介电常数为 $\\kappa_{\\mathrm{SiO}_2} = 3.9$，目标等效氧化物厚度为 $t_{\\mathrm{EOT}} = 0.8\\,\\mathrm{nm}$。\n\n从平行板电容器关系式和等效氧化物厚度的定义出发，推导一个将 HfO$_2$ 层的物理厚度 $t_{\\mathrm{phys}}$ 与 $t_{\\mathrm{EOT}}$、$\\kappa$ 和 $\\kappa_{\\mathrm{SiO}_2}$ 相关联的表达式。使用此表达式计算当 HfO$_2$ 的 $\\kappa = 20$ 时所需的 $t_{\\mathrm{phys}}$。然后，通过推导在 $\\kappa = 20$ 处求值的无量纲一阶相对灵敏度\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}}\\,\\frac{d t_{\\mathrm{phys}}}{d \\kappa}\n$$\n来量化 $t_{\\mathrm{phys}}$ 对 $\\kappa$ 不确定度的灵敏度。\n\n将您的最终答案以一个双元素行矩阵的形式报告，其中按顺序包含：所需的物理厚度 $t_{\\mathrm{phys}}$（单位为纳米，四舍五入到三位有效数字）和无量纲灵敏度 $S_{\\mathrm{rel}}$ 的精确值。行矩阵中不包含单位。",
            "solution": "我是STEM（科学、技术、工程和数学）领域一位严谨苛刻的教授。在尝试解决问题之前，我将首先批判性地验证问题陈述。\n\n### 步骤1：提取已知条件\n- 栅堆叠是硅上的理想化二氧化铪 (HfO$_2$) 平面薄膜。\n- 该薄膜是相对介电常数为 $\\kappa$ 的单一均匀电介质层。\n- 没有额外的串联界面层或耗尽效应。\n- 等效氧化物厚度 ($t_{\\mathrm{EOT}}$) 是能产生相同栅极电容的二氧化硅 (SiO$_2$) 的厚度。\n- SiO$_2$ 的相对介电常数为 $\\kappa_{\\mathrm{SiO}_2} = 3.9$。\n- 目标等效氧化物厚度为 $t_{\\mathrm{EOT}} = 0.8\\,\\mathrm{nm}$。\n- 计算中，HfO$_2$ 的相对介电常数取 $\\kappa = 20$。\n- HfO$_2$ 层的物理厚度为 $t_{\\mathrm{phys}}$。\n- 一阶相对灵敏度的定义为 $S_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}}\\,\\frac{d t_{\\mathrm{phys}}}{d \\kappa}$。\n- 任务1：推导关联 $t_{\\mathrm{phys}}$ 与 $t_{\\mathrm{EOT}}$、$\\kappa$ 和 $\\kappa_{\\mathrm{SiO}_2}$ 的表达式。\n- 任务2：根据给定值计算 $t_{\\mathrm{phys}}$。\n- 任务3：推导并计算在 $\\kappa = 20$ 处求值的 $S_{\\mathrm{rel}}$。\n- 任务4：以双元素行矩阵报告 $t_{\\mathrm{phys}}$（单位为纳米，四舍五入到三位有效数字）和 $S_{\\mathrm{rel}}$（精确值）。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据：** 该问题牢固地植根于基本静电学，特别是平行板电容器模型，这是电气工程和器件物理学的基石。等效氧化物厚度（EOT）的概念是半导体工业中用于表征和比较栅极电介质的标准且关键的度量指标。所提供的 HfO$_2$（$\\kappa \\approx 20$）和 SiO$_2$（$\\kappa_{\\mathrm{SiO}_2} = 3.9$）的相对介电常数值在该领域是科学准确和标准的。该问题代表了半导体工艺和器件建模中执行的一种标准的（尽管是简化的）计算。\n- **适定性：** 该问题是自洽的，并提供了得出唯一解所需的所有信息和定义。任务陈述清晰且逻辑上是顺序的。没有缺失数据或矛盾的约束条件。\n- **客观性：** 该问题是使用精确、无歧义的科学语言表述的。所有术语，如相对介电常数，要么是该领域的标准术语，要么像 EOT 和 $S_{\\mathrm{rel}}$ 一样被明确定义。\n\n### 步骤3：结论与行动\n问题是有效的。它科学合理、适定且客观。我现在将开始求解。\n\n平行板电容器的电容 $C$ 由以下公式给出：\n$$\nC = \\frac{\\epsilon A}{t}\n$$\n其中 $\\epsilon$ 是电介质材料的介电常数， $A$ 是极板的面积， $t$ 是电介质层的厚度。介电常数由 $\\epsilon = \\kappa \\epsilon_0$ 给出，其中 $\\kappa$ 是相对介电常数（介电常数）， $\\epsilon_0$ 是真空介电常数。\n\n对于高-$\\kappa$ 栅极电介质 (HfO$_2$)，其电容 $C_{\\mathrm{high-}\\kappa}$ 为：\n$$\nC_{\\mathrm{high-}\\kappa} = \\frac{\\kappa \\epsilon_0 A}{t_{\\mathrm{phys}}}\n$$\n这里，$\\kappa$ 是 HfO$_2$ 的相对介电常数， $t_{\\mathrm{phys}}$ 是其物理厚度。\n\n问题将等效氧化物厚度 $t_{\\mathrm{EOT}}$ 定义为能在相同面积 $A$ 上产生相同电容值的二氧化硅 (SiO$_2$) 层的厚度。这个等效 SiO$_2$ 层的电容 $C_{\\mathrm{EOT}}$ 为：\n$$\nC_{\\mathrm{EOT}} = \\frac{\\kappa_{\\mathrm{SiO}_2} \\epsilon_0 A}{t_{\\mathrm{EOT}}}\n$$\n其中 $\\kappa_{\\mathrm{SiO}_2}$ 是 SiO$_2$ 的相对介电常数。\n\n根据 EOT 的定义，这两个电容相等：\n$$\nC_{\\mathrm{high-}\\kappa} = C_{\\mathrm{EOT}}\n$$\n代入电容的表达式：\n$$\n\\frac{\\kappa \\epsilon_0 A}{t_{\\mathrm{phys}}} = \\frac{\\kappa_{\\mathrm{SiO}_2} \\epsilon_0 A}{t_{\\mathrm{EOT}}}\n$$\n真空介电常数 $\\epsilon_0$ 和面积 $A$ 的项在等式两边都存在且非零，因此可以消去。剩下如下关系：\n$$\n\\frac{\\kappa}{t_{\\mathrm{phys}}} = \\frac{\\kappa_{\\mathrm{SiO}_2}}{t_{\\mathrm{EOT}}}\n$$\n该方程建立了物理厚度和等效厚度之间的核心关系。为了找到 $t_{\\mathrm{phys}}$ 的表达式，我们重新整理方程：\n$$\nt_{\\mathrm{phys}} = t_{\\mathrm{EOT}} \\left( \\frac{\\kappa}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\n这是第一个需要推导的表达式。它表明，高-$\\kappa$ 材料的物理厚度是相对于目标 EOT，按介电常数的比率进行缩放的。\n\n接下来，我们使用给定的数值计算所需的物理厚度 $t_{\\mathrm{phys}}$：$t_{\\mathrm{EOT}} = 0.8\\,\\mathrm{nm}$，$\\kappa = 20$，以及 $\\kappa_{\\mathrm{SiO}_2} = 3.9$。\n$$\nt_{\\mathrm{phys}} = (0.8\\,\\mathrm{nm}) \\left( \\frac{20}{3.9} \\right) = \\frac{16}{3.9}\\,\\mathrm{nm} \\approx 4.10256\\,\\mathrm{nm}\n$$\n问题要求将此值四舍五入到三位有效数字。\n$$\nt_{\\mathrm{phys}} \\approx 4.10\\,\\mathrm{nm}\n$$\n\n最后，我们必须量化 $t_{\\mathrm{phys}}$ 对 $\\kappa$ 变化的灵敏度。无量纲相对灵敏度 $S_{\\mathrm{rel}}$ 定义为：\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}}\\,\\frac{d t_{\\mathrm{phys}}}{d \\kappa}\n$$\n为了计算这个值，我们首先需要求出 $t_{\\mathrm{phys}}$ 关于 $\\kappa$ 的导数。我们推导出的 $t_{\\mathrm{phys}}$ 表达式是 $\\kappa$ 的函数：\n$$\nt_{\\mathrm{phys}}(\\kappa) = \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right) \\kappa\n$$\n由于在此微分中 $t_{\\mathrm{EOT}}$ 和 $\\kappa_{\\mathrm{SiO}_2}$ 被视为常数，因此导数为：\n$$\n\\frac{d t_{\\mathrm{phys}}}{d \\kappa} = \\frac{d}{d\\kappa} \\left[ \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right) \\kappa \\right] = \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}}\n$$\n现在，我们将这个导数代回 $S_{\\mathrm{rel}}$ 的公式中：\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}} \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\n为了简化这个表达式，我们代入关系式 $t_{\\mathrm{phys}} = t_{\\mathrm{EOT}} \\left( \\frac{\\kappa}{\\kappa_{\\mathrm{SiO}_2}} \\right)$：\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{EOT}} \\left( \\frac{\\kappa}{\\kappa_{\\mathrm{SiO}_2}} \\right)} \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\n我们可以通过代数运算来简化它：\n$$\nS_{\\mathrm{rel}} = \\left( \\frac{\\kappa}{1} \\cdot \\frac{\\kappa_{\\mathrm{SiO}_2}}{t_{\\mathrm{EOT}} \\cdot \\kappa} \\right) \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\n所有项都消去了：\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa \\cdot \\kappa_{\\mathrm{SiO}_2} \\cdot t_{\\mathrm{EOT}}}{t_{\\mathrm{EOT}} \\cdot \\kappa \\cdot \\kappa_{\\mathrm{SiO}_2}} = 1\n$$\n相对灵敏度 $S_{\\mathrm{rel}}$ 精确地等于 $1$。这个结果与 $\\kappa$ 的值（或模型中的任何其他参数）无关，因此它在 $\\kappa = 20$ 处的值就是 $1$。这意味着介电常数 $\\kappa$ 的一个微小相对变化，会导致所需物理厚度 $t_{\\mathrm{phys}}$ 发生一个相等的相对变化，这从它们的正比关系中是可以预料到的。\n\n最终答案要求一个双元素行矩阵，包含计算出的物理厚度 ($4.10\\,\\mathrm{nm}$) 和灵敏度 ($1$) 。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.10  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了high-κ材料的电学优势后，我们转向其制造过程——薄膜沉积。化学气相沉积（CVD）是常用技术之一，但反应物在晶圆表面的质量传输限制往往导致薄膜厚度的不均匀性。本练习将带你构建一个基于流体动力学和传质理论的计算模型，通过编程来模拟和量化这种由边界层效应引起的厚度不均匀性，这对于优化反应器设计和工艺参数至关重要。",
            "id": "4130576",
            "problem": "考虑一个水平流反应器，用于在圆形晶圆上沉积高介电常数（high-κ）栅极电介质，例如二氧化铪。将晶圆建模为长度为 $L$ 的平板，与沿 $x$ 方向速度为 $u$ 的均匀气流对齐。气体中含有反应性前驱体，其体相摩尔浓度为 $C_{\\infty}$，在载气中前驱体的运动粘度为 $\\nu$，分子扩散系数为 $D$。假设平板上方为稳态、二维、层流外部流动，并且表面反应足够快，使得表面浓度有效为零，因此沉积受限于通过发展中的边界层的质量传递。\n\n使用以下基本原理：\n- Fick 第一扩散定律：垂直于表面的摩尔通量为 $J = -D \\,\\partial C / \\partial y$（在壁面处）。\n- 雷诺数（Reynolds number (Re)）和施密特数（Schmidt number (Sc)）分别定义为 $Re_x = u x / \\nu$ 和 $Sc = \\nu / D$，其中 $x$ 为沿平板的位置。\n- 通过 $Sh_x = k_m(x) \\, x / D$ 将局部传质系数 $k_m(x)$ 与舍伍德数（Sherwood number (Sh)）关联起来。使用一个合适的、被广泛接受的关于恒定表面浓度的平板上层流外部流动的关联式，从 $Re_x$ 和 $Sc$ 中获得 $k_m(x)$。\n\n通过使用沉积固体的摩尔质量 $M_s$ 和质量密度 $\\rho$ 将摩尔通量转换为厚度增长速率，可以得到厚度增长：\n- 质量通量为 $J(x) \\, M_s$，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 厚度增长速率为 $\\dot{h}(x) = \\dfrac{J(x) \\, M_s}{\\rho}$，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 对于沉积时间 $t$，位置 $x$ 处的厚度为 $h(x) = \\dot{h}(x) \\, t$。\n\n为了避免在理想化边界层关联式中出现的前缘 $x=0$ 处的数学奇点，通过引入一个小的正值入口长度偏移量 $x_0$ 来对模型进行正则化。使用有效距离 $x_{\\mathrm{eff}} = \\max(x, x_0)$ 来评估局部传质系数。\n\n任务：\n1. 根据所述基本原理，推导在层流、发展中边界层条件下，局部传质系数 $k_m(x)$ 作为 $u$、$D$、$\\nu$ 和 $x$ 的函数的显式表达式。\n2. 使用 $k_m(x)$，计算局部摩尔通量 $J(x)$，将其转换为在时间 $t$ 内的厚度 $h(x)$，并将晶圆沿流动方向离散化为 $N$ 个等间距的中心点采样点 $x_i = L \\left(i + \\tfrac{1}{2}\\right)/N$，$i=0,1,\\dots,N-1$。在 $k_m$ 中使用 $x_{\\mathrm{eff},i} = \\max(x_i, x_0)$。\n3. 计算 $N$ 个样本的算术平均厚度 $h_{\\mathrm{mean}}$、最小厚度 $h_{\\min}$ 和最大厚度 $h_{\\max}$。将非均匀性度量定义为小数 $U = \\dfrac{h_{\\max} - h_{\\min}}{h_{\\mathrm{mean}}}$。\n4. 以纳米表示平均厚度，以无量纲小数表示非均匀性。将报告的每个值四舍五入到六位小数。\n\n测试套件：\n对于以下每个参数集，计算以纳米为单位的 $h_{\\mathrm{mean}}$ 和 $U$。\n\n- 情况 A (一般正常路径)：\n    - $L = 0.300 \\,\\mathrm{m}$,\n    - $u = 1.000 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.60 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 6.00 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0020 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 90 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.002 \\,\\mathrm{m}$,\n    - $N = 200$。\n\n- 情况 B (预处理入口，高扩散率)：\n    - $L = 0.300 \\,\\mathrm{m}$,\n    - $u = 0.700 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.50 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 2.00 \\times 10^{-4} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0015 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 120 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.020 \\,\\mathrm{m}$,\n    - $N = 200$。\n\n- 情况 C (极低流速和低扩散率的边缘情况)：\n    - $L = 0.200 \\,\\mathrm{m}$,\n    - $u = 0.050 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.50 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 1.00 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0030 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 60 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.001 \\,\\mathrm{m}$,\n    - $N = 200$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三种情况的结果，格式为逗号分隔的列表的列表，每个内部列表包含以纳米为单位的平均厚度和非均匀性小数，两者均四舍五入到六位小数。例如：\n[[h_mean_caseA,U_caseA],[h_mean_caseB,U_caseB],[h_mean_caseC,U_caseC]]",
            "solution": "我们对平板上层流外部流动条件下的高介电常数（high-κ）栅极电介质沉积进行建模。局部摩尔通量由 Fick 第一扩散定律 $J = -D \\, \\partial C / \\partial y$ 控制，在对流边界层下，壁面处的梯度通常通过传质系数 $k_m(x)$ 表示为 $J(x) = k_m(x) \\left(C_{\\infty} - C_s\\right)$。由于表面反应迅速，表面浓度满足 $C_s \\approx 0$，因此 $J(x) \\approx k_m(x) C_{\\infty}$。\n\n为了获得平板上层流的 $k_m(x)$，我们使用在强制对流和恒定壁面浓度条件下，被广泛接受的局部舍伍德数（Sherwood number (Sh)）的层流关联式，该关联式与传热中的局部努塞尔数形式相似。该关联式为\n$$\nSh_x = a \\, Re_x^{1/2} \\, Sc^{1/3},\n$$\n其中 $a = 0.332$ 是局部值的常数，$Re_x = \\dfrac{u x}{\\nu}$ 是基于距离 $x$ 的雷诺数（Reynolds number (Re)），$Sc = \\dfrac{\\nu}{D}$ 是施密特数（Schmidt number (Sc)）。该关联式是一个经过充分检验的经验结果，源自边界层理论（例如 Blasius 解及其类似解），并在 $Re_x$ 低于层流-湍流转变阈值且表面浓度均匀的层流外部流动条件下得到验证。\n\n传质系数通过以下方式与舍伍德数相关：\n$$\nSh_x = \\frac{k_m(x) \\, x}{D}.\n$$\n求解 $k_m(x)$ 并代入关联式可得\n$$\nk_m(x) = \\frac{Sh_x \\, D}{x} = \\frac{a \\, D}{x} \\left( \\frac{u x}{\\nu} \\right)^{1/2} \\left( \\frac{\\nu}{D} \\right)^{1/3}.\n$$\n简化后得到\n$$\nk_m(x) = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x^{-1/2}.\n$$\n$k_m(x) \\propto x^{-1/2}$ 的形式反映了在考虑发展中的层流边界层时，浓度边界层随距离增加而变薄的现象。该关联式在 $x \\to 0$ 处是奇异的，这是理想化边界层从无限薄的前缘开始的数学假象。在实际反应器中，上游流动调节、入口效应和有限的板厚消除了这种奇异性。为了对模型进行正则化，我们引入一个有限的入口偏移量 $x_0 > 0$，并评估一个有效的局部距离\n$$\nx_{\\mathrm{eff}} = \\max(x, x_0).\n$$\n因此，工作表达式为\n$$\nk_m(x) = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2}, \\quad a = 0.332.\n$$\n\n有了这个 $k_m(x)$，局部摩尔通量为\n$$\nJ(x) = k_m(x) \\, C_{\\infty} = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty}.\n$$\n我们使用沉积固体的摩尔质量 $M_s$ 及其密度 $\\rho$ 将摩尔通量转换为厚度增长速率：\n$$\n\\dot{h}(x) = \\frac{J(x) \\, M_s}{\\rho} = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho}.\n$$\n对于恒定的沉积时间 $t$，局部厚度为\n$$\nh(x) = \\dot{h}(x) \\, t = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho} \\, t.\n$$\n\n为了评估晶圆尺度的非均匀性，沿流动方向使用 $N$ 个等间距的中心点采样点对平板进行离散化：\n$$\nx_i = L \\, \\frac{i + \\frac{1}{2}}{N}, \\quad i = 0, 1, \\dots, N-1,\n$$\n并计算\n$$\nx_{\\mathrm{eff}, i} = \\max(x_i, x_0), \\quad h_i = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}, i}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho} \\, t.\n$$\n通过乘以 $10^9$ 将 $h_i$ 从米转换为纳米。$N$ 个点上的平均厚度、最小厚度和最大厚度为\n$$\nh_{\\mathrm{mean}} = \\frac{1}{N} \\sum_{i=0}^{N-1} h_i, \\quad h_{\\min} = \\min_i h_i, \\quad h_{\\max} = \\max_i h_i,\n$$\n非均匀性为\n$$\nU = \\frac{h_{\\max} - h_{\\min}}{h_{\\mathrm{mean}}}.\n$$\n我们报告以纳米为单位的 $h_{\\mathrm{mean}}$ 和作为无量纲小数的 $U$，每个值都四舍五入到六位小数。\n\n每个测试用例的算法步骤：\n1. 读取 $L$、$u$、$\\nu$、$D$、$C_{\\infty}$、$t$、$M_s$、$\\rho$、$x_0$ 和 $N$。\n2. 预计算常数 $a = 0.332$、$u^{1/2}$、$D^{2/3}$ 和 $\\nu^{-1/6}$。\n3. 生成 $N$ 个中心点位置 $x_i$ 并计算 $x_{\\mathrm{eff}, i}$。\n4. 计算以米为单位的 $k_m(x_i)$、$J(x_i)$ 和 $h_i$，然后转换为纳米。\n5. 计算 $h_{\\mathrm{mean}}$、$h_{\\min}$、$h_{\\max}$ 和 $U$。\n6. 将 $h_{\\mathrm{mean}}$ 和 $U$ 四舍五入到六位小数。\n7. 按照规定的单行格式输出三种情况的结果，格式为成对的列表。\n\n层流假设通过 $Re_L = u L / \\nu$ 远低于典型的外部流转变阈值得到验证。$x_0$ 的正则化避免了前缘处的非物理发散，并代表了工业反应器中真实的入口调节条件。这一基于原理的推导将基本输运定律与经过经验验证的层流边界层关联式相结合，为高κ栅极电介质沉积中因质量传递限制引起的厚度非均匀性，建立了一个计算上易于处理的模型。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_nonuniformity(L, u, nu, D, C_inf, t, M_s, rho, x0, N):\n    \"\"\"\n    Compute mean thickness (nm) and nonuniformity U across a wafer modeled\n    as a flat plate of length L in laminar external flow with developing boundary layer.\n    \"\"\"\n    a = 0.332  # Local Sherwood correlation constant for laminar flat-plate, constant wall concentration\n\n    # Precompute constants for efficiency\n    u_sqrt = np.sqrt(u)\n    D_two_thirds = D ** (2.0 / 3.0)\n    nu_minus_one_sixth = nu ** (-1.0 / 6.0)\n\n    # Mid-interval sampling along the plate\n    i = np.arange(N)\n    x = L * (i + 0.5) / N\n    x_eff = np.maximum(x, x0)\n\n    # Local mass transfer coefficient km(x) = a * u^{1/2} * D^{2/3} * nu^{-1/6} * x_eff^{-1/2}\n    km = a * u_sqrt * D_two_thirds * nu_minus_one_sixth * (x_eff ** -0.5)\n\n    # Molar flux J(x) = km * C_inf\n    J = km * C_inf  # mol/m^2/s\n\n    # Thickness rate (m/s): dot{h} = J * M_s / rho; thickness h = dot{h} * t\n    h_m = (J * M_s / rho) * t  # meters\n\n    # Convert to nanometers\n    h_nm = h_m * 1e9\n\n    h_mean = float(np.mean(h_nm))\n    h_min = float(np.min(h_nm))\n    h_max = float(np.max(h_nm))\n    U = (h_max - h_min) / h_mean if h_mean != 0.0 else float('nan')\n\n    return h_mean, U\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a dict with the necessary parameters.\n    test_cases = [\n        # Case A (general happy path)\n        {\n            \"L\": 0.300,           # m\n            \"u\": 1.000,           # m/s\n            \"nu\": 1.60e-5,        # m^2/s\n            \"D\": 6.00e-5,         # m^2/s\n            \"C_inf\": 0.0020,      # mol/m^3\n            \"t\": 90.0,            # s\n            \"M_s\": 0.2105,        # kg/mol (HfO2 approx)\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.002,          # m\n            \"N\": 200\n        },\n        # Case B (preconditioned entrance, high diffusivity)\n        {\n            \"L\": 0.300,           # m\n            \"u\": 0.700,           # m/s\n            \"nu\": 1.50e-5,        # m^2/s\n            \"D\": 2.00e-4,         # m^2/s\n            \"C_inf\": 0.0015,      # mol/m^3\n            \"t\": 120.0,           # s\n            \"M_s\": 0.2105,        # kg/mol\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.020,          # m\n            \"N\": 200\n        },\n        # Case C (edge case with very low flow and low diffusivity)\n        {\n            \"L\": 0.200,           # m\n            \"u\": 0.050,           # m/s\n            \"nu\": 1.50e-5,        # m^2/s\n            \"D\": 1.00e-5,         # m^2/s\n            \"C_inf\": 0.0030,      # mol/m^3\n            \"t\": 60.0,            # s\n            \"M_s\": 0.2105,        # kg/mol\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.001,          # m\n            \"N\": 200\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        h_mean_nm, U = compute_nonuniformity(\n            L=case[\"L\"], u=case[\"u\"], nu=case[\"nu\"], D=case[\"D\"],\n            C_inf=case[\"C_inf\"], t=case[\"t\"], M_s=case[\"M_s\"],\n            rho=case[\"rho\"], x0=case[\"x0\"], N=case[\"N\"]\n        )\n        results.append((h_mean_nm, U))\n\n    # Format output: [[mean_nm,U],[mean_nm,U],[mean_nm,U]] with six decimals\n    formatted_pairs = []\n    for mean_nm, U in results:\n        formatted_pairs.append(f\"[{mean_nm:.6f},{U:.6f}]\")\n    output = \"[\" + \",\".join(formatted_pairs) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output)\n\nsolve()\n```"
        },
        {
            "introduction": "原子层沉积（ALD）以其卓越的保形性和厚度控制精度而成为先进节点中high-κ薄膜的首选技术，其性能高度依赖于表面反应动力学。本练习将引导你进入高级过程建模领域，结合基本的动力学模型（如阿伦尼乌斯定律）与现代贝叶斯统计方法。你将通过编程，从带有噪声的实验数据中推断出活化能（$E_a$）和吸附概率（$s$）等关键动力学参数，这体现了构建和验证预测性工艺模型的完整流程。",
            "id": "4130634",
            "problem": "您正在对高介电常数（high-κ）栅极电介质（如氧化铪）的原子层沉积（ALD）过程进行建模，重点研究每周期生长率（GPC）作为衬底温度的函数。您将构建一个贝叶斯参数估计模型，使用一个有基本原理的动力学模型，从带有噪声的 GPC 数据中推断活化能 $E_a$（单位为电子伏特）和黏附概率 $s$（无量纲）。该模型必须基于基本定义和经过充分检验的公式。使用的基本原理是用于热激活过程的阿伦尼乌斯定律和用于吸附事件的指数等待时间模型。\n\n假设使用以下过程模型：\n- 依赖于温度的速率常数的阿伦尼乌斯定律为 $k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{k_B T}\\right)$，其中 $k_0$ 是一个指前因子，单位为秒的倒数；$k_B$ 是玻尔兹曼常数；$T$ 是绝对温度，单位为开尔文。\n- 在持续时间为 $\\tau$ 的 ALD 前驱体脉冲之后，分数表面覆盖率建模为 $\\theta(T) = 1 - \\exp\\left(- s \\, k(T) \\, \\tau \\right)$。该模型源于在泊松到达假设下，表面反应事件等待时间的指数分布。\n- 每周期生长率（GPC）由 $\\text{GPC}(T) = t_{\\mathrm{ml}} \\, \\theta(T)$ 给出，其中 $t_{\\mathrm{ml}}$ 是有效单层厚度，单位为纳米。\n\n假设在温度 $\\{T_i\\}$ 下观测到的 GPC 值存在高斯测量噪声：\n$$\ny_i = \\text{GPC}(T_i) + \\epsilon_i, \\quad \\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其中 $y_i$ 是测得的 GPC，单位为纳米/周期；$\\sigma$ 是已知的标准差，单位为纳米/周期（对每个测试用例均为常数）。\n\n为未知参数设置均匀先验：\n- $E_a \\sim \\mathcal{U}(0.2, 1.5)$，单位为电子伏特。\n- $s \\sim \\mathcal{U}(0.001, 0.999)$（无量纲）。\n\n您的任务是实现一个基于网格的贝叶斯估计器，为每个测试用例计算 $E_a$ 的后验均值和 $s$ 的后验均值。使用由独立高斯误差所隐含的似然函数，并在指定的先验范围内的离散化网格上计算后验分布。玻尔兹曼常数的值为 $k_B = 8.617333262145 \\times 10^{-5}$ 电子伏特/开尔文。\n\n所有测试用例共用的常数：\n- $k_0 = 10^8$（单位为 $\\mathrm{s}^{-1}$）。\n- $t_{\\mathrm{ml}} = 0.11$（单位为 $\\mathrm{nm}$）。\n\n测试套件：\n- 用例 1（混合了饱和区和动力学区的通用“理想路径”）：\n  - 温度 $T$（单位 K）: $\\{400, 450, 500, 550, 600\\}$。\n  - 脉冲持续时间 $\\tau$（单位 s）: $0.5$。\n  - 噪声水平 $\\sigma$（单位 nm/周期）: $0.003$。\n  - 观测 GPC $y$（单位 nm/周期）: $\\{0.0068, 0.0369, 0.1015, 0.1089, 0.1121\\}$。\n- 用例 2（在整个温度范围内接近饱和的边界条件）：\n  - 温度 $T$（单位 K）: $\\{800, 900, 1000\\}$。\n  - 脉冲持续时间 $\\tau$（单位 s）: $0.2$。\n  - 噪声水平 $\\sigma$（单位 nm/周期）: $0.001$。\n  - 观测 GPC $y$（单位 nm/周期）: $\\{0.1097, 0.1103, 0.1108\\}$。\n- 用例 3（低温和低黏附概率导致 GPC 非常小的边缘情况）：\n  - 温度 $T$（单位 K）: $\\{300, 325, 350\\}$。\n  - 脉冲持续时间 $\\tau$（单位 s）: $0.05$。\n  - 噪声水平 $\\sigma$（单位 nm/周期）: $0.0002$。\n  - 观测 GPC $y$（单位 nm/周期）: $\\{0.00012, 0.00045, 0.00184\\}$。\n\n算法要求：\n- 实现一个参数网格，其中 $E_a$ 在 $[0.2, 1.5]$ 范围内均匀分布至少 $201$ 个点，$s$ 在 $[0.001, 0.999]$ 范围内均匀分布至少 $201$ 个点。\n- 使用高斯误差模型在网格上计算对数似然，并对每个用例中的所有温度点进行求和。\n- 通过在指数化前减去最大对数后验值，使用 log-sum-exp 稳定化方法以避免数值下溢。\n- 在网格上归一化后验分布，并通过将归一化后的后验分布作为权重进行求和，来计算 $E_a$ 和 $s$ 的后验均值。\n\n单位和输出：\n- 最终的 $E_a$ 以电子伏特表示，$s$ 为无量纲数。\n- 将每个输出值四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，具体形式为列表的列表：$[ [E_{a,1}, s_1], [E_{a,2}, s_2], [E_{a,3}, s_3] ]$，其中 $E_{a,i}$ 和 $s_i$ 是用例 $i$ 的后验均值。\n\n最终答案必须以指定的输出格式表示，$E_a$ 的单位为 $\\mathrm{eV}$，$s$ 无量纲，每个值都四舍五入到三位小数。",
            "solution": "用户希望解决一个与高κ栅极电介质原子层沉积（ALD）建模相关的问题。\n\n### 步骤1：提取给定信息\n- **速率常数模型（阿伦尼乌斯定律）**：$k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{k_B T}\\right)$，其中 $k(T)$ 是与温度相关的速率常数，$E_a$ 是活化能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- **表面覆盖率模型**：$\\theta(T) = 1 - \\exp\\left(- s \\, k(T) \\, \\tau \\right)$，其中 $\\theta(T)$ 是分数表面覆盖率，$s$ 是黏附概率，$\\tau$ 是前驱体脉冲持续时间。\n- **每周期生长率（GPC）模型**：$\\text{GPC}(T) = t_{\\mathrm{ml}} \\, \\theta(T)$，其中 $t_{\\mathrm{ml}}$ 是有效单层厚度。\n- **测量噪声模型**：$y_i = \\text{GPC}(T_i) + \\epsilon_i$，其中噪声 $\\epsilon_i$ 从正态分布 $\\mathcal{N}(0,\\sigma^2)$ 中抽取。\n- **未知参数的先验分布**：\n  - 活化能：$E_a \\sim \\mathcal{U}(0.2, 1.5)$，单位为电子伏特（$\\mathrm{eV}$）。\n  - 黏附概率：$s \\sim \\mathcal{U}(0.001, 0.999)$（无量纲）。\n- **常数**：\n  - 玻尔兹曼常数：$k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV} \\cdot \\mathrm{K}^{-1}$。\n  - 指前因子：$k_0 = 10^8 \\, \\mathrm{s}^{-1}$。\n  - 单层厚度：$t_{\\mathrm{ml}} = 0.11 \\, \\mathrm{nm}$。\n- **测试用例 1**：\n  - 温度 $T$：$\\{400, 450, 500, 550, 600\\}$ $\\mathrm{K}$。\n  - 脉冲持续时间 $\\tau$：$0.5$ $\\mathrm{s}$。\n  - 噪声水平 $\\sigma$：$0.003$ $\\mathrm{nm/cycle}$。\n  - 观测 GPC $y$：$\\{0.0068, 0.0369, 0.1015, 0.1089, 0.1121\\}$ $\\mathrm{nm/cycle}$。\n- **测试用例 2**：\n  - 温度 $T$：$\\{800, 900, 1000\\}$ $\\mathrm{K}$。\n  - 脉冲持续时间 $\\tau$：$0.2$ $\\mathrm{s}$。\n  - 噪声水平 $\\sigma$：$0.001$ $\\mathrm{nm/cycle}$。\n  - 观测 GPC $y$：$\\{0.1097, 0.1103, 0.1108\\}$ $\\mathrm{nm/cycle}$。\n- **测试用例 3**：\n  - 温度 $T$：$\\{300, 325, 350\\}$ $\\mathrm{K}$。\n  - 脉冲持续时间 $\\tau$：$0.05$ $\\mathrm{s}$。\n  - 噪声水平 $\\sigma$：$0.0002$ $\\mathrm{nm/cycle}$。\n  - 观测 GPC $y$：$\\{0.00012, 0.00045, 0.00184\\}$ $\\mathrm{nm/cycle}$。\n- **算法要求**：\n  - 为 $(E_a, s)$ 使用一个至少 $201 \\times 201$ 点的网格。\n  - 计算 $E_a$ 和 $s$ 的后验均值。\n  - 使用 log-sum-exp 稳定化方法。\n- **输出格式**：\n  - 单行 `[ [E_{a,1}, s_1], [E_{a,2}, s_2], [E_{a,3}, s_3] ]`。\n  - 值四舍五入到三位小数。\n\n### 步骤2：使用提取的给定信息进行验证\n对问题进行验证：\n- **科学依据**：该问题基于化学动力学和表面科学的既定原理。阿伦尼乌斯定律和表面覆盖率的指数模型是模拟像 ALD 这样的热激活表面反应的标准方法。参数及其范围对于此类过程在物理上是现实的。\n- **适定性**：该问题是适定的。它要求在给定模型、数据和先验的情况下求参数的后验均值。基于网格的数值估计是一个标准且定义明确的过程，对于给定的网格分辨率，可以得到唯一解。\n- **客观性**：该问题使用精确、客观和定量的语言陈述。所有模型、常数和数据都已明确定义。\n- **完整性和一致性**：该问题是自包含的。提供了所有必要的方程、常数、数据和先验分布。没有内部矛盾。\n- **可行性**：条件和数据对于 ALD 实验在物理上是合理的。指定的数值方法在计算上是可行的。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供一个完整的解决方案。\n\n目标是从不同温度下的一组带噪声的每周期生长率（GPC）测量值中估计活化能 $E_a$ 和黏附概率 $s$。我们为此参数估计任务采用贝叶斯框架。贝叶斯推断的核心原理是根据新数据更新我们对参数的知识（先验分布），从而获得更新后的知识状态（后验分布）。\n\n根据贝叶斯定理，在给定观测数据 $\\mathbf{y} = \\{y_i\\}$ 的条件下，参数 $\\boldsymbol{\\theta} = \\{E_a, s\\}$ 的后验概率分布由下式给出：\n$$ P(E_a, s | \\mathbf{y}) \\propto P(\\mathbf{y} | E_a, s) \\, P(E_a, s) $$\n其中 $P(\\mathbf{y} | E_a, s)$ 是在给定参数下观测到数据的似然，而 $P(E_a, s)$ 是参数的先验分布。\n\n问题为 $E_a$ 和 $s$ 指定了独立的先验分布：\n- $P(E_a) = \\mathcal{U}(0.2, 1.5)$，在区间 $[0.2, 1.5]$ 上的均匀分布。\n- $P(s) = \\mathcal{U}(0.001, 0.999)$，在区间 $[0.001, 0.999]$ 上的均匀分布。\n由于它们是独立的，联合先验是 $P(E_a, s) = P(E_a)P(s)$。在指定的矩形域内，此先验是一个常数。因此，后验分布在此域上与似然函数成正比：$P(E_a, s | \\mathbf{y}) \\propto P(\\mathbf{y} | E_a, s)$。\n\n似然函数源于测量值上的噪声是独立同分布高斯噪声的假设。单个观测值 $y_i$ 的概率为：\n$$ P(y_i | E_a, s) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - \\text{GPC}(T_i; E_a, s))^2}{2\\sigma^2} \\right) $$\n其中 $\\text{GPC}(T_i; E_a, s)$ 是在温度 $T_i$ 下给定参数集 $(E_a, s)$ 的模型预测值。模型构建如下：\n$$ \\text{GPC}(T; E_a, s) = t_{\\mathrm{ml}} \\left( 1 - \\exp\\left(- s \\cdot k_0 \\exp\\left(-\\frac{E_a}{k_B T}\\right) \\cdot \\tau \\right) \\right) $$\n由于单个测量是独立的，数据集 $\\mathbf{y}$ 的总似然是各个概率的乘积：\n$$ P(\\mathbf{y} | E_a, s) = \\prod_{i} P(y_i | E_a, s) $$\n\n为了数值稳定性，通常使用后验分布的对数进行计算。对数后验与对数似然成正比：\n$$ \\ln P(E_a, s | \\mathbf{y}) \\propto \\ln P(\\mathbf{y} | E_a, s) = \\sum_{i} \\ln P(y_i | E_a, s) $$\n$$ \\ln P(E_a, s | \\mathbf{y}) \\propto \\sum_{i} -\\frac{(y_i - \\text{GPC}(T_i; E_a, s))^2}{2\\sigma^2} $$\n涉及 $\\ln(\\sqrt{2\\pi\\sigma^2})$ 的项相对于参数 $(E_a, s)$ 是常数，可以省略，因为它们在归一化过程中会被消去。\n\n我们将通过在参数值的离散网格上计算来近似连续的后验分布。\n1.  **离散化**：为 $E_a$ 在 $[0.2, 1.5]$ 范围内创建具有 $N_{E_a} = 201$ 个点的均匀网格，为 $s$ 在 $[0.001, 0.999]$ 范围内创建具有 $N_s = 201$ 个点的均匀网格。设这些网格点为 $(E_{a,j}, s_k)$。\n2.  **对数后验计算**：对于这个 $N_{E_a} \\times N_s$ 网格上的每个点 $(E_{a,j}, s_k)$，我们计算未归一化的对数后验值，记为 $\\mathcal{L}_{jk}$：\n    $$ \\mathcal{L}_{jk} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N_{\\text{data}}} (y_i - \\text{GPC}(T_i; E_{a,j}, s_k))^2 $$\n3.  **带稳定化的归一化**：对数后验值 $\\mathcal{L}_{jk}$ 通常是很大的负数，直接进行指数运算 $\\exp(\\mathcal{L}_{jk})$ 会导致数值下溢。为防止这种情况，我们使用 log-sum-exp 技巧。首先，我们找到对数后验网格上的最大值 $\\mathcal{L}_{\\max} = \\max_{j,k} \\mathcal{L}_{jk}$。然后，我们计算平移后的未归一化后验概率 $P'_{jk} = \\exp(\\mathcal{L}_{jk} - \\mathcal{L}_{\\max})$。每个网格点的归一化后验概率则为：\n    $$ P_{jk} = \\frac{P'_{jk}}{\\sum_{j',k'} P'_{j'k'}} $$\n4.  **后验均值计算**：目标是计算 $E_a$ 和 $s$ 的后验均值，这代表了每个参数相对于后验分布的期望值。对于我们的离散网格，这通过加权和来近似：\n    $$ \\mathbb{E}[E_a | \\mathbf{y}] \\approx \\sum_{j=1}^{N_{E_a}} \\sum_{k=1}^{N_s} E_{a,j} P_{jk} $$\n    $$ \\mathbb{E}[s | \\mathbf{y}] \\approx \\sum_{j=1}^{N_{E_a}} \\sum_{k=1}^{N_s} s_k P_{jk} $$\n对所提供的三个测试用例中的每一个都重复此过程。最终结果按要求四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian parameter estimation problem for ALD GPC data.\n    \"\"\"\n    # Define constants common to all test cases\n    K_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    K_0 = 1e8                  # Pre-exponential factor in s^-1\n    T_ML = 0.11                # Monolayer thickness in nm\n\n    # Define the parameter grid\n    N_EA = 201\n    N_S = 201\n    ea_vals = np.linspace(0.2, 1.5, N_EA)\n    s_vals = np.linspace(0.001, 0.999, N_S)\n    \n    # Create meshgrids for vectorized calculations\n    # indexing='ij' makes the shapes (N_EA, N_S)\n    ea_grid, s_grid = np.meshgrid(ea_vals, s_vals, indexing='ij')\n\n    # Define the test suite\n    test_cases = [\n        {\n            \"temps_K\": np.array([400, 450, 500, 550, 600]),\n            \"tau_s\": 0.5,\n            \"sigma_nm\": 0.003,\n            \"gpc_obs_nm\": np.array([0.0068, 0.0369, 0.1015, 0.1089, 0.1121])\n        },\n        {\n            \"temps_K\": np.array([800, 900, 1000]),\n            \"tau_s\": 0.2,\n            \"sigma_nm\": 0.001,\n            \"gpc_obs_nm\": np.array([0.1097, 0.1103, 0.1108])\n        },\n        {\n            \"temps_K\": np.array([300, 325, 350]),\n            \"tau_s\": 0.05,\n            \"sigma_nm\": 0.0002,\n            \"gpc_obs_nm\": np.array([0.00012, 0.00045, 0.00184])\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        temps = case[\"temps_K\"]\n        tau = case[\"tau_s\"]\n        sigma = case[\"sigma_nm\"]\n        y_obs = case[\"gpc_obs_nm\"]\n        \n        # Initialize log posterior grid\n        log_posterior = np.zeros_like(ea_grid)\n\n        # Loop over each data point (temperature and observed GPC)\n        for t_i, y_i in zip(temps, y_obs):\n            # Calculate the rate constant k(T) over the entire parameter grid\n            k_t = K_0 * np.exp(-ea_grid / (K_B * t_i))\n            \n            # Calculate the surface coverage theta(T)\n            theta = 1.0 - np.exp(-s_grid * k_t * tau)\n            \n            # Calculate the model GPC\n            gpc_model = T_ML * theta\n            \n            # Calculate the log-likelihood for this data point and add to total\n            # The constant prefactor of the Gaussian is ignored as it cancels out\n            log_likelihood_i = -((y_i - gpc_model)**2) / (2 * sigma**2)\n            log_posterior += log_likelihood_i\n            \n        # --- Numerical Stabilization (log-sum-exp) ---\n        # Subtract the maximum log posterior value to prevent underflow\n        log_post_max = np.max(log_posterior)\n        posterior_unnormalized = np.exp(log_posterior - log_post_max)\n        \n        # --- Normalization ---\n        # Normalize the posterior so that it sums to 1\n        posterior_normalized = posterior_unnormalized / np.sum(posterior_unnormalized)\n\n        # --- Posterior Mean Calculation ---\n        # The mean is the expectation, calculated as a weighted sum over the grid\n        ea_mean = np.sum(ea_grid * posterior_normalized)\n        s_mean = np.sum(s_grid * posterior_normalized)\n        \n        final_results.append([ea_mean, s_mean])\n\n    # --- Format the output as specified ---\n    # Create a list of strings like \"[Ea,s]\" for each case\n    output_parts = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in final_results]\n    \n    # Join the parts into the final string format \"[[...],[...]]\"\n    print(f\"[{','.join(output_parts)}]\")\n\n\nsolve()\n```"
        }
    ]
}