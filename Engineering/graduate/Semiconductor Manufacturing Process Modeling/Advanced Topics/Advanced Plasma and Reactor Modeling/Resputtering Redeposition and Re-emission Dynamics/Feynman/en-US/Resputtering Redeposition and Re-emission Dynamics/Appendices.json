{
    "hands_on_practices": [
        {
            "introduction": "We begin at the microscopic level by examining the fundamental physics of the sputtering process itself. This exercise  challenges you to analyze a realistic empirical model for sputtering yield, which depends non-monotonically on the energy of the bombarding ion. By finding the ion energy $E_{i}^{\\star}$ that maximizes this yield, you will practice applying calculus to understand and optimize a key physical mechanism that governs surface evolution in plasma processing.",
            "id": "4161657",
            "problem": "In a collimated sputter-deposition process for semiconductor interconnects, energetic ions re-impact the partially formed film, leading to resputtering of redeposited material and re-emission of species. The energy-dependent net re-emission (resputtering) yield $Y(E_{i})$ for an incident ion of energy $E_{i}$ is empirically observed to follow\n$$\nY(E_{i}) = \\alpha \\,\\frac{S_{n}(E_{i})}{U_{0}} \\left(1 - \\frac{E_{th}}{E_{i}}\\right)^{m}, \\quad E_{i} > E_{th},\n$$\nwhere $S_{n}(E_{i})$ is the nuclear stopping, $U_{0}$ is the effective surface binding energy, $E_{th}$ is the sputtering threshold energy, $\\alpha$ is a dimensionless proportionality constant capturing material and angular effects, and $m > 0$ encodes the near-threshold rise characteristic. For the energy range of interest, assume the nuclear stopping is well-approximated by a saturating form\n$$\nS_{n}(E_{i}) = \\frac{S_{0}}{1 + E_{i}/E_{c}},\n$$\nwith $S_{0}$ and $E_{c}$ positive constants. Starting from the definitions above and standard calculus for extrema, determine the ion energy $E_{i}^{\\star}$ that maximizes $Y(E_{i})$ for $E_{i} > E_{th}$. Use the parameter values $\\alpha = 0.08$, $U_{0} = 4.7\\,\\mathrm{eV}$, $S_{0} = 18\\,\\mathrm{eV}$, $E_{c} = 300\\,\\mathrm{eV}$, $E_{th} = 40\\,\\mathrm{eV}$, and $m = 2.3$. Express your final answer for $E_{i}^{\\star}$ in $\\mathrm{eV}$ and round to four significant figures.",
            "solution": "The problem requires finding the ion energy $E_{i}^{\\star}$ that maximizes the net re-emission yield $Y(E_{i})$.\n\nThe re-emission yield $Y(E_{i})$ for an incident ion of energy $E_{i}$ is given by\n$$\nY(E_{i}) = \\alpha \\,\\frac{S_{n}(E_{i})}{U_{0}} \\left(1 - \\frac{E_{th}}{E_{i}}\\right)^{m}\n$$\nfor $E_{i} > E_{th}$. The nuclear stopping power $S_{n}(E_{i})$ is given by\n$$\nS_{n}(E_{i}) = \\frac{S_{0}}{1 + E_{i}/E_{c}}.\n$$\nSubstituting the expression for $S_{n}(E_{i})$ into the equation for $Y(E_{i})$, we obtain the full expression for the yield as a function of ion energy:\n$$\nY(E_{i}) = \\frac{\\alpha S_{0}}{U_{0}} \\left( \\frac{1}{1 + E_{i}/E_{c}} \\right) \\left(1 - \\frac{E_{th}}{E_{i}}\\right)^{m}.\n$$\nTo find the energy $E_{i}^{\\star}$ that maximizes $Y(E_{i})$, we must find the value of $E_{i}$ for which the first derivative of the yield with respect to energy is zero, i.e., $\\frac{dY}{dE_{i}} = 0$.\n\nThe constant prefactor $K = \\frac{\\alpha S_{0}}{U_{0}}$ does not affect the location of the maximum, so we can focus on maximizing the energy-dependent part of the function. Let's write the function as:\n$$\nY(E_{i}) = K \\cdot f(E_{i}) \\quad \\text{where} \\quad f(E_{i}) = \\frac{1}{1 + E_{i}/E_{c}} \\left(\\frac{E_{i} - E_{th}}{E_{i}}\\right)^{m}.\n$$\nTo simplify the differentiation, we can work with the natural logarithm of $f(E_{i})$, since the maximum of $f(E_{i})$ will occur at the same energy as the maximum of $\\ln(f(E_{i}))$.\n$$\n\\ln(f(E_{i})) = -\\ln(1 + E_{i}/E_{c}) + m \\ln(E_{i} - E_{th}) - m \\ln(E_{i}).\n$$\nLet's simplify the first term: $1 + E_{i}/E_{c} = (E_{c} + E_{i})/E_{c}$. So, $\\ln(1+E_{i}/E_{c}) = \\ln(E_{c}+E_{i}) - \\ln(E_{c})$.\n$$\n\\ln(f(E_{i})) = \\ln(E_{c}) - \\ln(E_{i} + E_{c}) + m \\ln(E_{i} - E_{th}) - m \\ln(E_{i}).\n$$\nNow, we differentiate with respect to $E_{i}$:\n$$\n\\frac{d}{dE_{i}}\\ln(f(E_{i})) = \\frac{f'(E_{i})}{f(E_{i})} = 0 - \\frac{1}{E_{i} + E_{c}} + \\frac{m}{E_{i} - E_{th}} - \\frac{m}{E_{i}}.\n$$\nTo find the maximum, we set the derivative to zero:\n$$\n\\frac{m}{E_{i} - E_{th}} - \\frac{m}{E_{i}} = \\frac{1}{E_{i} + E_{c}}.\n$$\nWe combine the terms on the left-hand side:\n$$\n\\frac{m E_{i} - m(E_{i} - E_{th})}{E_{i}(E_{i} - E_{th})} = \\frac{1}{E_{i} + E_{c}}.\n$$\n$$\n\\frac{m E_{th}}{E_{i}^{2} - E_{th} E_{i}} = \\frac{1}{E_{i} + E_{c}}.\n$$\nCross-multiplying gives:\n$$\nm E_{th} (E_{i} + E_{c}) = E_{i}^{2} - E_{th} E_{i}.\n$$\n$$\nm E_{th} E_{i} + m E_{th} E_{c} = E_{i}^{2} - E_{th} E_{i}.\n$$\nRearranging this into a standard quadratic equation of the form $aE_{i}^{2} + bE_{i} + c = 0$:\n$$\nE_{i}^{2} - (E_{th} E_{i} + m E_{th} E_{i}) - m E_{th} E_{c} = 0.\n$$\n$$\nE_{i}^{2} - (1+m) E_{th} E_{i} - m E_{th} E_{c} = 0.\n$$\nWe solve for $E_{i}$ using the quadratic formula, $E_{i} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nE_{i} = \\frac{(1+m)E_{th} \\pm \\sqrt{(-(1+m)E_{th})^{2} - 4(1)(-m E_{th} E_{c})}}{2(1)}.\n$$\n$$\nE_{i} = \\frac{(1+m)E_{th} \\pm \\sqrt{(1+m)^{2}E_{th}^{2} + 4m E_{th} E_{c}}}{2}.\n$$\nSince $E_{i}$ must be a positive energy, and all parameters ($m, E_{th}, E_{c}$) are positive, the term under the square root is positive. Furthermore, $\\sqrt{(1+m)^{2}E_{th}^{2} + 4m E_{th} E_{c}} > \\sqrt{(1+m)^{2}E_{th}^{2}} = (1+m)E_{th}$. Therefore, the solution with the minus sign would yield a negative energy, which is physically meaningless. We must take the positive root for the physically valid solution, $E_{i}^{\\star}$:\n$$\nE_{i}^{\\star} = \\frac{(1+m)E_{th} + \\sqrt{(1+m)^{2}E_{th}^{2} + 4m E_{th} E_{c}}}{2}.\n$$\nNow, we substitute the provided numerical values: $m=2.3$, $E_{th}=40\\,\\mathrm{eV}$, and $E_{c}=300\\,\\mathrm{eV}$.\n$$\n1+m = 1+2.3 = 3.3.\n$$\n$$\n(1+m)E_{th} = 3.3 \\times 40 = 132.\n$$\n$$\n(1+m)^{2}E_{th}^{2} = (132)^{2} = 17424.\n$$\n$$\n4m E_{th} E_{c} = 4 \\times 2.3 \\times 40 \\times 300 = 9.2 \\times 12000 = 110400.\n$$\nSubstituting these into the expression for $E_{i}^{\\star}$:\n$$\nE_{i}^{\\star} = \\frac{132 + \\sqrt{17424 + 110400}}{2} = \\frac{132 + \\sqrt{127824}}{2}.\n$$\nCalculating the square root:\n$$\n\\sqrt{127824} \\approx 357.52482.\n$$\n$$\nE_{i}^{\\star} = \\frac{132 + 357.52482}{2} = \\frac{489.52482}{2} \\approx 244.76241\\,\\mathrm{eV}.\n$$\nThe problem asks for the answer to be rounded to four significant figures.\n$$\nE_{i}^{\\star} \\approx 244.8\\,\\mathrm{eV}.\n$$",
            "answer": "$$\\boxed{244.8}$$"
        },
        {
            "introduction": "After a particle is sputtered or re-emitted, its subsequent path is determined by line-of-sight geometry. This practice  focuses on quantifying this transport by deriving an analytical \"view factor\" for a common trench structure. Calculating this factor, which represents the probability of direct transport between two surfaces, provides not only deep physical insight but also a crucial analytical benchmark for validating the accuracy of complex numerical simulation codes.",
            "id": "4161648",
            "problem": "Consider a translationally invariant trench in a physical vapor deposition system, modeled as a two-dimensional rectangular cavity with perfectly diffuse, line-of-sight re-emission. The cavity cross-section is a rectangle of width $w$ and height $h$, with boundary segments: the bottom surface $\\mathcal{S}_{b}$ from $(0,0)$ to $(w,0)$, the top surface $\\mathcal{S}_{t}$ from $(0,h)$ to $(w,h)$, and the side walls $\\mathcal{S}_{\\ell}$ from $(0,0)$ to $(0,h)$ and $\\mathcal{S}_{r}$ from $(w,0)$ to $(w,h)$. Assume that atoms resputtered from $\\mathcal{S}_{b}$ exit according to Lambert’s cosine law relative to the local surface normal, and that their subsequent trajectories are ballistic in vacuum until the next surface impact. Neglect gas-phase scattering, electrostatic deflection, and surface roughness.\n\nStarting from first principles—namely, the definition of view (configuration) factor for diffuse emitters, conservation and reciprocity relations, and the geometry of the enclosure—derive an analytical expression for the two-dimensional view factor $F_{b \\to t}$ from $\\mathcal{S}_{b}$ to $\\mathcal{S}_{t}$ in terms of $w$ and $h$. This view factor is equal to the probability that a single Lambertian re-emission from $\\mathcal{S}_{b}$ impacts $\\mathcal{S}_{t}$.\n\nFor a trench of width $w = 200\\,\\mathrm{nm}$ and height $h = 300\\,\\mathrm{nm}$, evaluate the derived expression numerically. Express your final result as a dimensionless decimal and round your answer to four significant figures. This analytical result is to be used as the ground truth for validating a Monte Carlo re-emission solver (the solver’s predicted fraction of impacts on $\\mathcal{S}_{t}$ should converge to $F_{b \\to t}$ as the number of simulated particles increases).",
            "solution": "### Solution Derivation\nThe view factor $F_{b \\to t}$ represents the fraction of diffusely emitted particles from surface $\\mathcal{S}_{b}$ that directly strike surface $\\mathcal{S}_{t}$. We will derive this by first finding the view factor from a differential element on $\\mathcal{S}_{b}$ to the entire surface $\\mathcal{S}_{t}$, and then averaging this result over the length of $\\mathcal{S}_{b}$.\n\nLet us consider a differential line element $dx$ located at a point $P$ with coordinate $(x, 0)$ on the bottom surface $\\mathcal{S}_{b}$, where $0 \\le x \\le w$. For a $2$D system, the view factor from this differential element $dx$ to the finite surface $\\mathcal{S}_{t}$ is given by the `crossed-strings` method for a differential element, which simplifies to an angular integral:\n$$ F_{dx \\to \\mathcal{S}_{t}} = \\frac{1}{2}(\\sin\\theta_2 - \\sin\\theta_1) $$\nwhere $\\theta_1$ and $\\theta_2$ are the angles between the normal to $dx$ (the positive $y$-axis) and the lines of sight from $P$ to the endpoints of $\\mathcal{S}_{t}$.\n\nThe endpoints of the top surface $\\mathcal{S}_{t}$ are $P_1 = (0, h)$ and $P_2 = (w, h)$.\nThe line of sight from $P(x,0)$ to $P_1(0,h)$ forms an angle $\\theta_1$ with the normal. The vector from $P$ to $P_1$ is $(-x, h)$. The angle is measured from the normal vector $(0,1)$. The horizontal displacement is $-x$. Thus, $\\tan\\theta_1 = \\frac{-x}{h}$.\nThe corresponding sine is:\n$$ \\sin\\theta_1 = \\frac{\\tan\\theta_1}{\\sqrt{1 + \\tan^2\\theta_1}} = \\frac{-x/h}{\\sqrt{1 + (-x/h)^2}} = \\frac{-x}{\\sqrt{x^2+h^2}} $$\n\nThe line of sight from $P(x,0)$ to $P_2(w,h)$ forms an angle $\\theta_2$ with the normal. The vector from $P$ to $P_2$ is $(w-x, h)$. The horizontal displacement is $w-x$. Thus, $\\tan\\theta_2 = \\frac{w-x}{h}$.\nThe corresponding sine is:\n$$ \\sin\\theta_2 = \\frac{\\tan\\theta_2}{\\sqrt{1 + \\tan^2\\theta_2}} = \\frac{(w-x)/h}{\\sqrt{1 + ((w-x)/h)^2}} = \\frac{w-x}{\\sqrt{(w-x)^2+h^2}} $$\n\nSubstituting these into the formula for $F_{dx \\to \\mathcal{S}_{t}}$:\n$$ F_{dx \\to \\mathcal{S}_{t}} = \\frac{1}{2} \\left[ \\frac{w-x}{\\sqrt{(w-x)^2+h^2}} - \\left( \\frac{-x}{\\sqrt{x^2+h^2}} \\right) \\right] = \\frac{1}{2} \\left( \\frac{w-x}{\\sqrt{(w-x)^2+h^2}} + \\frac{x}{\\sqrt{x^2+h^2}} \\right) $$\n\nTo find the total view factor $F_{b \\to t}$ from the entire surface $\\mathcal{S}_{b}$ to $\\mathcal{S}_{t}$, we must average $F_{dx \\to \\mathcal{S}_{t}}$ over the length $w$ of $\\mathcal{S}_{b}$:\n$$ F_{b \\to t} = \\frac{1}{w} \\int_0^w F_{dx \\to \\mathcal{S}_{t}} dx $$\n$$ F_{b \\to t} = \\frac{1}{w} \\int_0^w \\frac{1}{2} \\left( \\frac{w-x}{\\sqrt{(w-x)^2+h^2}} + \\frac{x}{\\sqrt{x^2+h^2}} \\right) dx $$\nThe integral consists of two terms. Let's analyze them separately.\nThe second term is $\\int_0^w \\frac{x}{\\sqrt{x^2+h^2}} dx$.\nFor the first term, let's use a substitution $u = w-x$, which implies $du = -dx$. When $x=0$, $u=w$. When $x=w$, $u=0$.\n$$ \\int_0^w \\frac{w-x}{\\sqrt{(w-x)^2+h^2}} dx = \\int_{w}^{0} \\frac{u}{\\sqrt{u^2+h^2}} (-du) = \\int_0^w \\frac{u}{\\sqrt{u^2+h^2}} du $$\nThis is identical in form to the integral of the second term. Therefore, the total integral is twice the integral of the second term:\n$$ F_{b \\to t} = \\frac{1}{2w} \\left( 2 \\int_0^w \\frac{x}{\\sqrt{x^2+h^2}} dx \\right) = \\frac{1}{w} \\int_0^w \\frac{x}{\\sqrt{x^2+h^2}} dx $$\nTo evaluate this integral, we use another substitution. Let $v = x^2+h^2$, so $dv = 2x dx$, or $x dx = \\frac{1}{2} dv$.\n$$ \\int \\frac{x}{\\sqrt{x^2+h^2}} dx = \\int \\frac{1}{\\sqrt{v}} \\left( \\frac{1}{2} dv \\right) = \\frac{1}{2} \\int v^{-1/2} dv = \\frac{1}{2} \\frac{v^{1/2}}{1/2} = \\sqrt{v} = \\sqrt{x^2+h^2} $$\nNow, we apply the limits of integration from $0$ to $w$:\n$$ \\int_0^w \\frac{x}{\\sqrt{x^2+h^2}} dx = \\left[ \\sqrt{x^2+h^2} \\right]_0^w = \\sqrt{w^2+h^2} - \\sqrt{0^2+h^2} = \\sqrt{w^2+h^2} - h $$\nSubstituting this result back into the expression for $F_{b \\to t}$:\n$$ F_{b \\to t} = \\frac{1}{w} (\\sqrt{w^2+h^2} - h) $$\nThis expression can be rewritten in terms of the aspect ratio $H = h/w$:\n$$ F_{b \\to t} = \\frac{\\sqrt{w^2(1+h^2/w^2)} - h}{w} = \\frac{w\\sqrt{1+(h/w)^2} - h}{w} = \\sqrt{1+\\left(\\frac{h}{w}\\right)^2} - \\frac{h}{w} $$\nThis is the required analytical expression for the view factor.\n\n### Numerical Evaluation\nThe problem provides the following dimensions:\n- Width: $w = 200\\,\\mathrm{nm}$\n- Height: $h = 300\\,\\mathrm{nm}$\n\nThe ratio $h/w$ is:\n$$ \\frac{h}{w} = \\frac{300\\,\\mathrm{nm}}{200\\,\\mathrm{nm}} = 1.5 $$\nNow, we substitute this value into the derived expression for $F_{b \\to t}$:\n$$ F_{b \\to t} = \\sqrt{1 + (1.5)^2} - 1.5 = \\sqrt{1 + 2.25} - 1.5 = \\sqrt{3.25} - 1.5 $$\nUsing a calculator for the numerical value:\n$$ \\sqrt{3.25} \\approx 1.8027756377... $$\n$$ F_{b \\to t} \\approx 1.8027756377 - 1.5 = 0.3027756377... $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ F_{b \\to t} \\approx 0.3028 $$",
            "answer": "$$\\boxed{0.3028}$$"
        },
        {
            "introduction": "We now scale up from single-pathway transport to model the entire reactor as an interconnected system. This advanced practice  demonstrates how the complex web of sputtering and redeposition events across multiple surfaces can be captured within a powerful linear algebraic framework. You will derive the self-consistent matrix equation for steady-state particle fluxes and implement a numerical solution, bridging the gap between physical principles and predictive, system-level computational modeling.",
            "id": "4161607",
            "problem": "Consider a set of $N$ disjoint, planar surfaces inside a Physical Vapor Deposition (PVD) or Plasma Enhanced Chemical Vapor Deposition (PECVD) reactor. Particles impinge on these surfaces, where they may stick, sputter, resputter, redeposit, or be re-emitted. Let the following quantities be defined:\n\n- $N$ is the number of surfaces.\n- $\\Phi_0 \\in \\mathbb{R}^N$ is the vector of external primary incident particle fluxes onto each surface, measured in particles per square meter per second ($\\mathrm{m^{-2}\\,s^{-1}}$).\n- $S \\in \\mathbb{R}^{N \\times N}$ is a diagonal matrix whose $i$-th diagonal element $s_i \\in [0,1]$ is the sticking probability on surface $i$.\n- $P \\in \\mathbb{R}^{N \\times N}$ is a transport-emission coupling matrix, where $P_{ij} \\ge 0$ represents the expected number of particles arriving at surface $i$ per particle that sticks on surface $j$, aggregating all sputter/resputter yield, angular scattering, line-of-sight geometry, and re-emission transport effects into a single linear mapping.\n- $\\Phi \\in \\mathbb{R}^N$ is the total steady-state incident flux vector onto each surface, in $\\mathrm{m^{-2}\\,s^{-1}}$.\n\nAssume the following physically justified bases:\n- Conservation of particle number at steady state for fluxes, applied in expectation: the total incident flux onto any surface equals the sum of externally sourced flux plus all re-emitted or sputter-generated fluxes arriving from other surfaces.\n- Linearity of expectation and linear superposition of independent contributions.\n- The reactor operates in a regime where multiple generations of re-emission/resputtering do not lead to divergence of flux, meaning the combined transport-emission process remains bounded.\n\nTasks:\n1. From the above bases and definitions, derive the self-consistent linear equation governing the steady-state total incident flux $\\Phi$ in terms of the transport-emission coupling matrix $P$, diagonal sticking matrix $S$, and the primary flux vector $\\Phi_0$. Explain why the linear system is well-posed under appropriate spectral conditions and identify the mathematical object that must be inverted to solve for $\\Phi$.\n2. Solve explicitly for $\\Phi$ in closed form, stating any necessary conditions for the solution to exist and be unique.\n3. Implement a program that computes $\\Phi$ for the following test suite. For each test case, compute and return the full vector $\\Phi$ in $\\mathrm{m^{-2}\\,s^{-1}}$.\n\nTest suite:\n- Case A (general regime, $N=3$):\n  - $\\Phi_0 = [1.0\\times 10^{20},\\,2.0\\times 10^{20},\\,0.5\\times 10^{20}]$.\n  - $s = [0.3,\\,0.5,\\,0.2]$ so $S = \\mathrm{diag}(s)$.\n  - $P = \\begin{bmatrix}\n    0.05 & 0.10 & 0.00 \\\\\n    0.02 & 0.03 & 0.04 \\\\\n    0.00 & 0.02 & 0.01\n  \\end{bmatrix}$.\n- Case B (no sticking boundary, $N=3$):\n  - $\\Phi_0 = [1.0\\times 10^{20},\\,1.0\\times 10^{20},\\,1.0\\times 10^{20}]$.\n  - $s = [0.0,\\,0.0,\\,0.0]$, $S = \\mathrm{diag}(s)$.\n  - $P$ identical to Case A.\n- Case C (strong recirculation but bounded, $N=3$):\n  - $\\Phi_0 = [1.0\\times 10^{19},\\,1.0\\times 10^{19},\\,1.0\\times 10^{19}]$.\n  - $s = [0.9,\\,0.9,\\,0.9]$, $S = \\mathrm{diag}(s)$.\n  - $P = \\begin{bmatrix}\n    0.20 & 0.10 & 0.05 \\\\\n    0.05 & 0.20 & 0.10 \\\\\n    0.10 & 0.05 & 0.20\n  \\end{bmatrix}$.\n- Case D (zero transport edge case, $N=3$):\n  - $\\Phi_0 = [3.0\\times 10^{20},\\,4.0\\times 10^{20},\\,2.0\\times 10^{20}]$.\n  - $s = [0.8,\\,0.2,\\,0.5]$, $S = \\mathrm{diag}(s)$.\n  - $P = \\mathbf{0}_{3\\times 3}$ (all entries zero).\n- Case E (symmetric surfaces, $N=4$):\n  - $\\Phi_0 = [1.0\\times 10^{20},\\,1.0\\times 10^{20},\\,1.0\\times 10^{20},\\,1.0\\times 10^{20}]$.\n  - $s = [0.6,\\,0.6,\\,0.6,\\,0.6]$, $S = \\mathrm{diag}(s)$.\n  - $P = \\begin{bmatrix}\n    0.00 & 0.10 & 0.10 & 0.10 \\\\\n    0.10 & 0.00 & 0.10 & 0.10 \\\\\n    0.10 & 0.10 & 0.00 & 0.10 \\\\\n    0.10 & 0.10 & 0.10 & 0.00\n  \\end{bmatrix}$.\n\nOutput specification:\n- Express all fluxes in $\\mathrm{m^{-2}\\,s^{-1}}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of its components. Use scientific notation with six significant digits for each float and do not include spaces. For example, a valid format is:\n  - $[[x_1,x_2],[y_1,y_2,y_3]]$.",
            "solution": "The problem asks for a self-consistent model of steady-state particle fluxes onto $N$ surfaces in a reactor. The core principle is the conservation of particles at steady state. For any given surface $i$, the total incident flux of particles, $\\Phi_i$, must equal the sum of the flux from external sources, $(\\Phi_0)_i$, and the flux of particles originating from all surfaces (including itself) due to secondary processes like sputtering, re-emission, and redeposition.\n\nLet us formalize the contribution from secondary processes. The total incident flux on surface $j$ is $\\Phi_j$. A fraction of this flux, determined by the sticking probability $s_j \\in [0,1]$, adheres to the surface. The flux of particles sticking to surface $j$ is therefore $s_j \\Phi_j$. The problem defines a transport-emission coupling matrix $P$, where the element $P_{ij}$ represents the expected number of particles arriving at surface $i$ for each particle that sticks on surface $j$. Thus, $P_{ij}$ is a dimensionless quantity that aggregates yields and geometric transport factors.\n\nThe flux of particles arriving at surface $i$ that originated from sticking events on surface $j$ is the product of the sticking flux at $j$ and the coupling factor $P_{ij}$. This contribution is $P_{ij} (s_j \\Phi_j)$. To find the total secondary flux arriving at surface $i$, we must sum the contributions from all surfaces $j = 1, \\dots, N$. This gives the total redeposited flux on surface $i$ as $\\sum_{j=1}^N P_{ij} s_j \\Phi_j$.\n\nWith this, we can write the steady-state flux balance equation for surface $i$:\n$$\n\\Phi_i = (\\Phi_0)_i + \\sum_{j=1}^N P_{ij} s_j \\Phi_j\n$$\nThis represents a system of $N$ linear equations for the $N$ unknown fluxes $\\Phi_1, \\dots, \\Phi_N$. We can express this system more compactly using matrix notation. Let $\\Phi$ be the column vector of total fluxes, and $\\Phi_0$ be the column vector of primary fluxes. The matrix $S$ is defined as a diagonal matrix with elements $S_{jj} = s_j$. The summation term $\\sum_{j=1}^N P_{ij} s_j \\Phi_j$ is the $i$-th element of the matrix-vector product $(PS)\\Phi$. The product of matrix $P$ and diagonal matrix $S$ results in a matrix $(PS)$ with elements $(PS)_{ij} = P_{ij}s_j$.\n\nTherefore, the self-consistent linear equation governing the steady-state total incident flux vector $\\Phi$ is:\n$$\n\\Phi = \\Phi_0 + (PS)\\Phi\n$$\n\nTo solve for $\\Phi$, we rearrange the equation to group terms involving $\\Phi$:\n$$\n\\Phi - (PS)\\Phi = \\Phi_0\n$$\nFactoring out $\\Phi$ and using the identity matrix $I$ of size $N \\times N$, we obtain:\n$$\n(I - PS)\\Phi = \\Phi_0\n$$\nThis is a standard linear system of the form $Ax=b$, where the matrix to be solved is $A = (I - PS)$, the unknown vector is $x = \\Phi$, and the constant vector is $b = \\Phi_0$.\n\nThe system is well-posed and has a unique solution if and only if the matrix $(I - PS)$ is invertible (non-singular). The problem provides a physical basis for this condition: \"the combined transport-emission process remains bounded.\" This statement can be interpreted through a Neumann series expansion. The total flux $\\Phi$ can be seen as the sum of the initial flux $\\Phi_0$, the flux after one generation of redeposition, $(PS)\\Phi_0$, the flux after two generations, $(PS)^2\\Phi_0$, and so on:\n$$\n\\Phi = \\Phi_0 + PS(\\Phi_0 + PS\\Phi_0 + \\dots) = \\Phi_0 + (PS)\\Phi_0 + (PS)^2\\Phi_0 + \\dots = \\left(\\sum_{k=0}^{\\infty} (PS)^k\\right) \\Phi_0\n$$\nThis geometric series of matrices converges if and only if the spectral radius of the matrix $PS$, denoted $\\rho(PS)$, is strictly less than $1$. The spectral radius is the maximum of the absolute values of the eigenvalues of the matrix. If $\\rho(PS) < 1$, then the matrix $(I - PS)$ is guaranteed to be invertible, and its inverse is given by the sum of this series: $(I - PS)^{-1} = \\sum_{k=0}^{\\infty} (PS)^k$.\n\nThe physical condition of a bounded process translates directly to the mathematical condition $\\rho(PS) < 1$. If $\\rho(PS) \\ge 1$, at least one mode of particle exchange would be self-sustaining or divergent, leading to an unphysical infinite flux. Since all elements of $P$ and $S$ are non-negative, the elements of $PS$ are also non-negative. By the Perron-Frobenius theorem for non-negative matrices, the condition $\\rho(PS) < 1$ ensures that $(I-PS)^{-1}$ exists and has all non-negative elements, which guarantees a physically meaningful non-negative flux vector $\\Phi$ for any non-negative primary flux $\\Phi_0$. The mathematical object that must be inverted is the matrix $(I - PS)$.\n\nThe explicit closed-form solution for the total steady-state incident flux vector $\\Phi$ is obtained by pre-multiplying both sides of the linear system by the inverse of $(I-PS)$:\n$$\n(I - PS)^{-1}(I - PS)\\Phi = (I - PS)^{-1}\\Phi_0\n$$\n$$\n\\Phi = (I - PS)^{-1}\\Phi_0\n$$\nThe necessary and sufficient condition for this unique, physically meaningful solution to exist is that the spectral radius of the matrix $PS$ is less than one, i.e., $\\rho(PS) < 1$. This condition is satisfied for all test cases provided, as the nature of the transport parameters ensures a dissipative rather than a divergent system. For implementation, solving the linear system $(I - PS)\\Phi = \\Phi_0$ directly is numerically more stable and efficient than explicitly calculating the inverse matrix.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state particle flux in a multi-surface reactor\n    for a given set of test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"name\": \"Case A (general regime)\",\n            \"N\": 3,\n            \"Phi_0\": np.array([1.0e20, 2.0e20, 0.5e20]),\n            \"s\": np.array([0.3, 0.5, 0.2]),\n            \"P\": np.array([\n                [0.05, 0.10, 0.00],\n                [0.02, 0.03, 0.04],\n                [0.00, 0.02, 0.01]\n            ])\n        },\n        {\n            \"name\": \"Case B (no sticking boundary)\",\n            \"N\": 3,\n            \"Phi_0\": np.array([1.0e20, 1.0e20, 1.0e20]),\n            \"s\": np.array([0.0, 0.0, 0.0]),\n            \"P\": np.array([\n                [0.05, 0.10, 0.00],\n                [0.02, 0.03, 0.04],\n                [0.00, 0.02, 0.01]\n            ])\n        },\n        {\n            \"name\": \"Case C (strong recirculation but bounded)\",\n            \"N\": 3,\n            \"Phi_0\": np.array([1.0e19, 1.0e19, 1.0e19]),\n            \"s\": np.array([0.9, 0.9, 0.9]),\n            \"P\": np.array([\n                [0.20, 0.10, 0.05],\n                [0.05, 0.20, 0.10],\n                [0.10, 0.05, 0.20]\n            ])\n        },\n        {\n            \"name\": \"Case D (zero transport edge case)\",\n            \"N\": 3,\n            \"Phi_0\": np.array([3.0e20, 4.0e20, 2.0e20]),\n            \"s\": np.array([0.8, 0.2, 0.5]),\n            \"P\": np.zeros((3, 3))\n        },\n        {\n            \"name\": \"Case E (symmetric surfaces)\",\n            \"N\": 4,\n            \"Phi_0\": np.array([1.0e20, 1.0e20, 1.0e20, 1.0e20]),\n            \"s\": np.array([0.6, 0.6, 0.6, 0.6]),\n            \"P\": np.array([\n                [0.00, 0.10, 0.10, 0.10],\n                [0.10, 0.00, 0.10, 0.10],\n                [0.10, 0.10, 0.00, 0.10],\n                [0.10, 0.10, 0.10, 0.00]\n            ])\n        }\n    ]\n\n    results_str_list = []\n    \n    for case in test_cases:\n        N = case[\"N\"]\n        Phi_0 = case[\"Phi_0\"]\n        s = case[\"s\"]\n        P = case[\"P\"]\n        \n        # S is the diagonal matrix of sticking probabilities.\n        # However, the product (PS) can be calculated more efficiently.\n        # (PS)_ij = P_ij * s_j. In numpy, this corresponds to\n        # multiplying each column of P by the corresponding element of s.\n        # This is achieved by broadcasting s.\n        PS = P * s\n\n        # The linear system is (I - PS) * Phi = Phi_0\n        # I is the identity matrix of size N x N.\n        I = np.eye(N)\n        \n        # The matrix A of the linear system A*x = b is (I - PS).\n        A = I - PS\n        \n        # Solve the system for Phi. This is more numerically stable than\n        # inverting A and multiplying by Phi_0.\n        Phi = np.linalg.solve(A, Phi_0)\n        \n        # Format the result vector into the required string format.\n        # e.g., [1.234567e+20,8.765432e+19]\n        # Scientific notation with 6 significant digits.\n        formatted_phi = [f\"{val:.6e}\" for val in Phi]\n        case_result_str = f\"[{','.join(formatted_phi)}]\"\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    # e.g., [[...],[...],...]\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}