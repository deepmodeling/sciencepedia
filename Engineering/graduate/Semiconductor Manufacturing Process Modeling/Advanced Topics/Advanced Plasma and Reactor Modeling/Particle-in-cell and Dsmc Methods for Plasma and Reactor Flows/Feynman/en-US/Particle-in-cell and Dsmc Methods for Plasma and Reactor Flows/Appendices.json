{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any valid particle simulation, particularly the Direct Simulation Monte Carlo (DSMC) method, lies in correctly resolving the fundamental physical scales of the system. This exercise guides you through a critical first step: translating macroscopic reactor conditions into the microscopic scales of particle motion. By calculating the mean free path and collision time, you will determine the necessary spatial and temporal resolution for a simulation, ensuring that the discrete model can accurately capture the continuous physics of particle collisions .",
            "id": "4149170",
            "problem": "A low-pressure argon reactor used in semiconductor manufacturing operates at pressure $p=10$ mTorr and temperature $T=300$ K. Treat argon as a monatomic hard-sphere gas with kinetic diameter $d=3.66 \\times 10^{-10}$ m and atomic mass $m=39.948$ unified atomic mass units, where $1$ unified atomic mass unit $=1.66053906660 \\times 10^{-27}$ kg. Use the Ideal Gas Law to relate number density to pressure and temperature, the hard-sphere collision cross section definition, and standard kinetic theory for a Maxwell-Boltzmann gas to derive the mean free path and mean collision time. Then, based on commonly accepted Direct Simulation Monte Carlo (DSMC) constraints for accurate simulations, choose a feasible spatial cell size and time step for DSMC in this reactor.\n\nStart from the following foundations:\n- Ideal Gas Law $p=n k_B T$ to relate number density $n$ to $p$ and $T$.\n- Hard-sphere collision cross section $\\sigma=\\pi d^2$ for the argon atoms.\n- Kinetic theory definition of mean free path in a gas $\\ell=\\frac{1}{\\sqrt{2}\\,n\\,\\sigma}$.\n- Maxwell-Boltzmann mean speed $\\bar{v}=\\sqrt{\\frac{8 k_B T}{\\pi m}}$ for argon atoms.\n\nUsing these, derive expressions for the mean free path $\\ell$ and mean collision time $\\tau_c=\\frac{\\ell}{\\bar{v}}$. For DSMC feasibility, define the spatial cell size and time step as $\\Delta x=\\frac{\\ell}{3}$ and $\\Delta t=\\frac{\\tau_c}{5}$, respectively.\n\nAdditional data: Take Boltzmann’s constant as $k_B=1.380649 \\times 10^{-23}$ J/K, and use $1$ Torr $=133.322$ Pa to convert the given pressure to SI units.\n\nCompute and report the four quantities $\\ell$, $\\tau_c$, $\\Delta x$, and $\\Delta t$. Express all final quantities in SI units (m and s), and round your final numerical values to three significant figures.",
            "solution": "The problem is scientifically grounded, well-posed, and provides all necessary information to compute the required quantities. The physical models and constraints are standard in the field of rarefied gas dynamics and computational modeling. Thus, the problem is valid, and a step-by-step solution can be constructed.\n\nThe task is to compute four quantities: the mean free path $\\ell$, the mean collision time $\\tau_c$, a feasible Direct Simulation Monte Carlo (DSMC) spatial cell size $\\Delta x$, and a feasible DSMC time step $\\Delta t$. The derivation will proceed in a logical sequence as outlined by the problem statement.\n\nFirst, all given quantities must be expressed in SI units for consistency in calculations.\nThe pressure is given as $p = 10$ mTorr. Using the conversion factor $1$ Torr $= 133.322$ Pa, we have:\n$$p = 10 \\times 10^{-3} \\text{ Torr} \\times \\frac{133.322 \\text{ Pa}}{1 \\text{ Torr}} = 1.33322 \\text{ Pa}$$\nThe atomic mass of argon is given as $m_{u} = 39.948$ unified atomic mass units (u). Using the conversion factor $1 \\text{ u} = 1.66053906660 \\times 10^{-27}$ kg, the mass of a single argon atom in kilograms is:\n$$m = 39.948 \\text{ u} \\times \\frac{1.66053906660 \\times 10^{-27} \\text{ kg}}{1 \\text{ u}} \\approx 6.63352 \\times 10^{-26} \\text{ kg}$$\nOther given quantities in SI units are the temperature $T = 300$ K, the argon kinetic diameter $d = 3.66 \\times 10^{-10}$ m, and Boltzmann's constant $k_B = 1.380649 \\times 10^{-23}$ J/K.\n\nWith all variables in SI units, we can proceed with the calculations.\n\n1.  **Number Density ($n$)**: The number density $n$ of the gas is found by rearranging the Ideal Gas Law, $p = n k_B T$:\n    $$n = \\frac{p}{k_B T}$$\n    Substituting the values:\n    $$n = \\frac{1.33322 \\text{ Pa}}{(1.380649 \\times 10^{-23} \\text{ J/K}) \\times (300 \\text{ K})} = \\frac{1.33322}{4.141947 \\times 10^{-21}} \\text{ m}^{-3} \\approx 3.21908 \\times 10^{20} \\text{ m}^{-3}$$\n\n2.  **Collision Cross-Section ($\\sigma$)**: For a hard-sphere gas, the collision cross-section $\\sigma$ is defined based on the kinetic diameter $d$:\n    $$\\sigma = \\pi d^2$$\n    Substituting the value for $d$:\n    $$\\sigma = \\pi (3.66 \\times 10^{-10} \\text{ m})^2 = \\pi (1.33956 \\times 10^{-19} \\text{ m}^2) \\approx 4.20836 \\times 10^{-19} \\text{ m}^2$$\n\n3.  **Mean Free Path ($\\ell$)**: The mean free path $\\ell$ is the average distance an atom travels between collisions. It is given by the formula:\n    $$\\ell = \\frac{1}{\\sqrt{2}\\,n\\,\\sigma}$$\n    Substituting the calculated values for $n$ and $\\sigma$:\n    $$\\ell = \\frac{1}{\\sqrt{2} \\times (3.21908 \\times 10^{20} \\text{ m}^{-3}) \\times (4.20836 \\times 10^{-19} \\text{ m}^2)}$$\n    $$\\ell \\approx \\frac{1}{191.605 \\text{ m}^{-1}} \\approx 0.0052190 \\text{ m}$$\n    Rounding to three significant figures, $\\ell = 5.22 \\times 10^{-3}$ m.\n\n4.  **Mean Speed ($\\bar{v}$)**: The mean speed of atoms in a gas following a Maxwell-Boltzmann distribution is given by:\n    $$\\bar{v} = \\sqrt{\\frac{8 k_B T}{\\pi m}}$$\n    Substituting the values for $k_B$, $T$, and $m$:\n    $$\\bar{v} = \\sqrt{\\frac{8 \\times (1.380649 \\times 10^{-23} \\text{ J/K}) \\times (300 \\text{ K})}{\\pi \\times (6.63352 \\times 10^{-26} \\text{ kg})}}$$\n    $$\\bar{v} = \\sqrt{\\frac{3.3135576 \\times 10^{-20}}{2.08399 \\times 10^{-25}}} \\text{ m/s} \\approx \\sqrt{159000.8} \\text{ m/s} \\approx 398.749 \\text{ m/s}$$\n    Rounding to three significant figures, $\\bar{v} = 399$ m/s.\n\n5.  **Mean Collision Time ($\\tau_c$)**: The mean time between collisions, $\\tau_c$, is the ratio of the mean free path to the mean speed:\n    $$\\tau_c = \\frac{\\ell}{\\bar{v}}$$\n    Using the unrounded values for higher precision:\n    $$\\tau_c = \\frac{0.0052190 \\text{ m}}{398.749 \\text{ m/s}} \\approx 1.3088 \\times 10^{-5} \\text{ s}$$\n    Rounding to three significant figures, $\\tau_c = 1.31 \\times 10^{-5}$ s.\n\n6.  **DSMC Parameters ($\\Delta x$ and $\\Delta t$)**: The problem provides specific constraints for choosing the DSMC cell size $\\Delta x$ and time step $\\Delta t$.\n    The spatial cell size $\\Delta x$ is defined as:\n    $$\\Delta x = \\frac{\\ell}{3}$$\n    Using the unrounded value of $\\ell$:\n    $$\\Delta x = \\frac{0.0052190 \\text{ m}}{3} \\approx 0.00173967 \\text{ m}$$\n    Rounding to three significant figures, $\\Delta x = 1.74 \\times 10^{-3}$ m.\n\n    The time step $\\Delta t$ is defined as:\n    $$\\Delta t = \\frac{\\tau_c}{5}$$\n    Using the unrounded value of $\\tau_c$:\n    $$\\Delta t = \\frac{1.3088 \\times 10^{-5} \\text{ s}}{5} = 2.6176 \\times 10^{-6} \\text{ s}$$\n    Rounding to three significant figures, $\\Delta t = 2.62 \\times 10^{-6}$ s.\n\nThe four requested quantities, rounded to three significant figures, are:\n$\\ell = 5.22 \\times 10^{-3}$ m\n$\\tau_c = 1.31 \\times 10^{-5}$ s\n$\\Delta x = 1.74 \\times 10^{-3}$ m\n$\\Delta t = 2.62 \\times 10^{-6}$ s",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.22 \\times 10^{-3} & 1.31 \\times 10^{-5} & 1.74 \\times 10^{-3} & 2.62 \\times 10^{-6}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond tracking particle trajectories, a key function of plasma simulations is to model the complex chemistry that drives semiconductor manufacturing processes. This hands-on coding practice delves into the heart of plasma chemistry by showing you how to calculate a reaction rate from first principles. You will learn to combine fundamental collision data (the cross-section $\\sigma(E)$) with the output of a plasma simulation (the electron energy distribution function $f(E)$) to determine the volumetric rate of a critical process like radical formation .",
            "id": "4149137",
            "problem": "You are modeling electron-neutral collisions in a plasma reactor relevant to semiconductor manufacturing. Consider a Carbon Tetrafluoride (CF$_4$) plasma where electron-impact dissociation produces radicals. In Particle-In-Cell (PIC) with Direct Simulation Monte Carlo (DSMC), the electron-neutral collision rate is computed from first principles of kinetic theory.\n\nStarting from the following fundamental bases:\n- The definition of speed as $v = \\mathrm{d}x/\\mathrm{d}t$ and Newtonian kinetic energy $E_{\\mathrm{J}} = \\tfrac{1}{2} m v^2$ where $E_{\\mathrm{J}}$ is energy in joules and $m$ is mass.\n- The statistical expectation over a probability density $f(E)$ in energy space, normalized such that $\\int f(E)\\,\\mathrm{d}E = 1$.\n- The notion that for a dilute neutral gas of CF$_4$ at temperature $T$, the neutral number density is $n_{\\mathrm{CF}_4} = P/(k_{\\mathrm{B}} T)$ where $P$ is pressure and $k_{\\mathrm{B}}$ is Boltzmann’s constant.\n- For electrons colliding with much heavier neutrals, the relative speed can be approximated by the electron speed $v(E)$ derived from $E_{\\mathrm{J}}$; with $E$ measured in electronvolts and converted to joules via $E_{\\mathrm{J}} = e E_{\\mathrm{eV}}$, where $e$ is the elementary charge.\n\nYour tasks are:\n1. Derive, from the above bases, an algorithm to compute the electron-impact dissociation rate coefficient for CF$_4$ using tabulated cross section $\\sigma(E)$ and a measured energy distribution $f(E)$. Use only definitions and conservation arguments without assuming any shortcut formula.\n2. Implement the algorithm to produce the volumetric production rate of radicals, defined as the number of radicals produced per unit volume per unit time, assuming a stoichiometric yield of one radical per dissociation event. Express all final rates in $\\mathrm{m^{-3}\\,s^{-1}}$.\n3. Use the provided discrete energy grid, cross section table, and measured energy distributions to compute the results for a test suite that covers general and boundary conditions.\n\nConstants (use SI units):\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$,\n- Electron mass $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$,\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n\nCommon energy grid in electronvolts for tabulation:\n- $E_{\\mathrm{grid}} = [0, 2, 4, 6, 8, 10, 12, 15, 20, 30, 40, 50]\\,\\mathrm{eV}$.\n\nTabulated dissociation cross section for CF$_4$ as a function of $E$ on the above grid (assume a threshold near $8\\,\\mathrm{eV}$, plausible magnitudes chosen for scientific realism):\n- $\\sigma(E)$ in $\\mathrm{m^2}$ is $[0, 0, 0, 0, 1\\times 10^{-21}, 5\\times 10^{-21}, 1\\times 10^{-20}, 1.5\\times 10^{-20}, 1.7\\times 10^{-20}, 1.4\\times 10^{-20}, 1\\times 10^{-20}, 7\\times 10^{-21}]$ aligned to $E_{\\mathrm{grid}}$.\n\nMeasured energy distributions $f_{\\mathrm{raw}}(E)$ (non-normalized samples on $E_{\\mathrm{grid}}$; your program must normalize each via $\\int f(E)\\,\\mathrm{d}E = 1$ over $E$ in electronvolts):\n- Case A (general, approximately Maxwellian-like tail): $f_{\\mathrm{raw,A}}(E_i) = E_i \\exp(-E_i/4)$ for each $E_i \\in E_{\\mathrm{grid}}$.\n- Case B (quasi-monoenergetic around $20\\,\\mathrm{eV}$): $f_{\\mathrm{raw,B}}(E_i) = \\exp\\left(-\\frac{(E_i - 20)^2}{2\\times 2^2}\\right)$.\n- Case C (low-energy dominated below threshold): $f_{\\mathrm{raw,C}}(E_i) = \\exp\\left(-\\frac{(E_i - 4)^2}{2\\times 1.5^2}\\right)$.\n- Case D (boundary condition with zero electron density; reuse Case A distribution): $f_{\\mathrm{raw,D}}(E_i) = f_{\\mathrm{raw,A}}(E_i)$.\n\nOperating conditions for each case:\n- Case A: $P = 5.33288\\,\\mathrm{Pa}$ (approximately $40\\,\\mathrm{mTorr}$), $T = 300\\,\\mathrm{K}$, $n_e = 1.0\\times 10^{16}\\,\\mathrm{m^{-3}}$, stoichiometric yield $s = 1$ radical per event.\n- Case B: $P = 1.33322\\,\\mathrm{Pa}$ (approximately $10\\,\\mathrm{mTorr}$), $T = 300\\,\\mathrm{K}$, $n_e = 5.0\\times 10^{15}\\,\\mathrm{m^{-3}}$, $s = 1$.\n- Case C: $P = 13.3322\\,\\mathrm{Pa}$ (approximately $100\\,\\mathrm{mTorr}$), $T = 300\\,\\mathrm{K}$, $n_e = 1.0\\times 10^{16}\\,\\mathrm{m^{-3}}$, $s = 1$.\n- Case D: $P = 5.33288\\,\\mathrm{Pa}$, $T = 300\\,\\mathrm{K}$, $n_e = 0\\,\\mathrm{m^{-3}}$, $s = 1$.\n\nNumerical requirements:\n- Normalize each measured $f_{\\mathrm{raw}}(E)$ on $E_{\\mathrm{grid}}$ so that $\\int f(E)\\,\\mathrm{d}E = 1$ using a consistent quadrature rule over $E$ in electronvolts.\n- Convert energy $E$ in electronvolts to joules using $E_{\\mathrm{J}} = e E_{\\mathrm{eV}}$, then compute electron speed $v(E) = \\sqrt{2 E_{\\mathrm{J}}/m_e}$ in $\\mathrm{m/s}$.\n- Treat the relative electron-neutral speed as $v(E)$.\n- Compute the dissociation rate coefficient in $\\mathrm{m^3/s}$ by appropriately averaging over the normalized $f(E)$ and integrating across energy.\n- Compute the volumetric radical production rate $R$ in $\\mathrm{m^{-3}\\,s^{-1}}$ using the neutral density from the ideal gas relation and the electron density.\n\nYour program should produce a single line of output containing the rates for the four cases as a comma-separated list enclosed in square brackets (e.g., $[r_A,r_B,r_C,r_D]$), where each $r$ is a floating-point number in $\\mathrm{m^{-3}\\,s^{-1}}$.",
            "solution": "The problem requires the derivation and implementation of an algorithm to calculate the volumetric production rate of radicals from electron-impact dissociation of Carbon Tetrafluoride ($\\text{CF}_4$), a process central to plasma etching in semiconductor fabrication. The derivation shall begin from first principles of kinetic theory and be implemented numerically using the provided data.\n\n### 1. Derivation of the Rate Coefficient and Volumetric Rate\n\nThe fundamental process is a collision between an electron ($e^-$) and a neutral $\\text{CF}_4$ molecule, leading to dissociation:\n$$ e^- + \\text{CF}_4 \\rightarrow \\text{radicals} + e^- $$\n\n**Step 1.1: Single-Electron Collision Frequency**\n\nConsider a single electron with kinetic energy $E$ moving at speed $v$ through a dilute, stationary gas of $\\text{CF}_4$ molecules with number density $n_{\\mathrm{CF}_4}$. The electron presents a target to the neutrals, and vice versa. The effective area for a dissociation collision is the energy-dependent cross section, $\\sigma(E)$. In a time interval $\\mathrm{d}t$, the electron travels a distance $\\mathrm{d}l = v\\,\\mathrm{d}t$ and sweeps out a cylindrical volume $\\mathrm{d}V = \\sigma(E) \\cdot \\mathrm{d}l = \\sigma(E) v(E) \\mathrm{d}t$.\n\nThe number of neutral molecules within this infinitesimal volume is $\\mathrm{d}N_{coll} = n_{\\mathrm{CF}_4} \\mathrm{d}V = n_{\\mathrm{CF}_4} \\sigma(E) v(E) \\mathrm{d}t$. The rate at which this single electron causes dissociation events, also known as the collision frequency for this reaction, is therefore:\n$$ \\nu(E) = \\frac{\\mathrm{d}N_{coll}}{\\mathrm{d}t} = n_{\\mathrm{CF}_4} \\sigma(E) v(E) $$\n\nThe speed $v(E)$ of the electron is derived from its kinetic energy. The problem provides energy $E$ in electronvolts ($\\mathrm{eV}$). This must be converted to the SI unit of Joules ($E_{\\mathrm{J}}$) for use in standard physics equations. Given the elementary charge $e$, the conversion is $E_{\\mathrm{J}} = e E$. From the Newtonian kinetic energy formula $E_{\\mathrm{J}} = \\frac{1}{2} m_e v^2$, where $m_e$ is the electron mass, we can solve for the speed:\n$$ v(E) = \\sqrt{\\frac{2 E_{\\mathrm{J}}}{m_e}} = \\sqrt{\\frac{2eE}{m_e}} $$\nThe problem states we can approximate the relative speed of the electron-neutral pair by the electron speed, which is a valid approximation because the electron mass $m_e$ is thousands of times smaller than the mass of a $\\text{CF}_4$ molecule, making the electron's velocity far greater than the thermal velocity of the neutral gas.\n\n**Step 1.2: Averaging over the Electron Energy Distribution**\n\nIn a plasma, electrons do not all have the same energy. Their energies are described by a probability distribution, the Electron Energy Distribution Function (EEDF), denoted $f(E)$. This function is normalized such that $\\int_0^\\infty f(E) \\mathrm{d}E = 1$, and $f(E)\\mathrm{d}E$ represents the fraction of electrons with energies between $E$ and $E+\\mathrm{d}E$.\n\nTo find the overall rate of dissociation, we must average the single-electron collision rate over the entire electron population. The total number of dissociation events per unit volume per unit time, initiated by electrons with energy between $E$ and $E+\\mathrm{d}E$, is the product of the single-electron collision frequency $\\nu(E)$ and the number density of electrons in that energy range, which is $n_e f(E) \\mathrm{d}E$.\nThe rate from this slice of the distribution is:\n$$ \\mathrm{d}R = \\nu(E) \\cdot (n_e f(E) \\mathrm{d}E) = (n_{\\mathrm{CF}_4} \\sigma(E) v(E)) \\cdot (n_e f(E) \\mathrm{d}E) $$\nThe total volumetric rate of dissociation collisions, $R_{coll}$, is obtained by integrating this expression over all possible electron energies:\n$$ R_{coll} = \\int_0^\\infty n_e n_{\\mathrm{CF}_4} \\sigma(E) v(E) f(E) \\mathrm{d}E $$\nWe can regroup the terms:\n$$ R_{coll} = n_e n_{\\mathrm{CF}_4} \\left( \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E \\right) $$\nThe term in the parenthesis is defined as the electron-impact dissociation **rate coefficient**, $k$:\n$$ k \\equiv \\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E $$\nThe rate coefficient $k$ has units of $\\mathrm{m^3/s}$ and represents the average \"effective volume\" swept out per electron per second for the dissociation reaction. It encapsulates the microphysics of the collision process ($\\sigma$) and the plasma's energetic state ($f(E)$).\n\n**Step 1.3: Volumetric Radical Production Rate**\n\nThe volumetric production rate of radicals, $R$, is the rate of dissociation collisions, $R_{coll}$, multiplied by the stoichiometric yield, $s$, which is the number of radicals produced per dissociation event.\n$$ R = s \\cdot R_{coll} = s \\cdot k \\cdot n_e \\cdot n_{\\mathrm{CF}_4} $$\nThe neutral gas density, $n_{\\mathrm{CF}_4}$, is given by the ideal gas law for a given pressure $P$ and temperature $T$:\n$$ n_{\\mathrm{CF}_4} = \\frac{P}{k_{\\mathrm{B}} T} $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant.\nSubstituting all parts, the final expression for the volumetric radical production rate is:\n$$ R = s \\cdot n_e \\cdot \\left(\\frac{P}{k_{\\mathrm{B}} T}\\right) \\cdot \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E $$\nThis completes the derivation from first principles.\n\n### 2. Numerical Implementation Algorithm\n\nThe problem provides all data on a discrete, non-uniform energy grid $E_{\\mathrm{grid}} = \\{E_i\\}_{i=0}^{N-1}$. The integral for the rate coefficient must be computed numerically. The trapezoidal rule is a suitable choice for this integration.\n\n**Algorithm Steps:**\n1.  **Input Data**: Load the constants ($e, m_e, k_{\\mathrm{B}}$), the energy grid $E_{\\mathrm{grid}}$, the cross section array $\\sigma_i = \\sigma(E_i)$, and the parameters for each case ($P, T, n_e, s$, and the rule for $f_{\\mathrm{raw}}$).\n\n2.  For each case:\n    a.  **Electron Speed Array**: For each energy $E_i$ in $E_{\\mathrm{grid}}$ (in $\\mathrm{eV}$), calculate the corresponding electron speed $v_i$.\n        $$ v_i = \\sqrt{\\frac{2eE_i}{m_e}} $$\n        This creates an array of speeds $v = \\{v_i\\}$.\n\n    b.  **Raw EEDF**: Generate the array of raw, non-normalized EEDF values, $f_{\\mathrm{raw},i}$, at each grid point $E_i$ using the function specified for the case.\n\n    c.  **EEDF Normalization**: Compute the normalization constant $I$ by numerically integrating $f_{\\mathrm{raw}}(E)$ over the energy grid (in units of $\\mathrm{eV}$).\n        $$ I = \\int_0^\\infty f_{\\mathrm{raw}}(E) \\mathrm{d}E \\approx \\sum_{i=0}^{N-2} \\frac{f_{\\mathrm{raw},i} + f_{\\mathrm{raw}, i+1}}{2} (E_{i+1} - E_i) $$\n        If $I = 0$ (e.g., if all $f_{\\mathrm{raw},i}$ are zero), the normalized distribution is also zero. Otherwise, compute the normalized EEDF array $f_i$:\n        $$ f_i = \\frac{f_{\\mathrm{raw},i}}{I} $$\n        Note that the units of $f_i$ are $\\mathrm{eV}^{-1}$.\n\n    d.  **Rate Coefficient Calculation**: Compute the rate coefficient $k$ by numerically integrating the product $\\sigma(E)v(E)f(E)$ over the energy grid (in $\\mathrm{eV}$).\n        $$ k = \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E \\approx \\sum_{i=0}^{N-2} \\frac{\\sigma_i v_i f_i + \\sigma_{i+1} v_{i+1} f_{i+1}}{2} (E_{i+1} - E_i) $$\n\n    e.  **Neutral Density**: Calculate the neutral gas density $n_{\\mathrm{CF}_4}$ in $\\mathrm{m^{-3}}$ from the given pressure $P$ (in $\\mathrm{Pa}$) and temperature $T$ (in $\\mathrm{K}$).\n        $$ n_{\\mathrm{CF}_4} = \\frac{P}{k_{\\mathrm{B}} T} $$\n\n    f.  **Volumetric Production Rate**: Compute the final rate $R$ in $\\mathrm{m^{-3}\\,s^{-1}}$ using the electron density $n_e$ and stoichiometric yield $s$ for the case.\n        $$ R = s \\cdot k \\cdot n_e \\cdot n_{\\mathrm{CF}_4} $$\n        For Case D, where $n_e = 0$, the rate $R$ will be exactly $0$.\n\nThis algorithm systematically follows the derived physics to compute the required quantities for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the volumetric radical production rate in a CF4 plasma\n    for several test cases, based on first principles of kinetic theory.\n    \"\"\"\n    # 1. Constants and Grid Data (in SI units)\n    e = 1.602176634e-19  # Elementary charge (C)\n    m_e = 9.1093837015e-31 # Electron mass (kg)\n    k_B = 1.380649e-23     # Boltzmann constant (J/K)\n\n    # Common energy grid in eV\n    E_grid = np.array([0., 2., 4., 6., 8., 10., 12., 15., 20., 30., 40., 50.])\n\n    # Tabulated dissociation cross section for CF4 in m^2\n    sigma_E = np.array([\n        0.0, 0.0, 0.0, 0.0, 1e-21, 5e-21, 1e-20, 1.5e-20, 1.7e-20, 1.4e-20, 1e-20, 7e-21\n    ])\n\n    # 2. Case Definitions\n    \n    # Raw EEDF functions\n    def f_raw_A(E):\n        return E * np.exp(-E / 4.0)\n\n    def f_raw_B(E):\n        return np.exp(-((E - 20.0)**2) / (2 * 2.0**2))\n\n    def f_raw_C(E):\n        return np.exp(-((E - 4.0)**2) / (2 * 1.5**2))\n\n    # Case parameters: (P (Pa), T (K), n_e (m^-3), s, f_raw function)\n    test_cases = [\n        (5.33288, 300.0, 1.0e16, 1.0, f_raw_A),   # Case A\n        (1.33322, 300.0, 5.0e15, 1.0, f_raw_B),   # Case B\n        (13.3322, 300.0, 1.0e16, 1.0, f_raw_C),   # Case C\n        (5.33288, 300.0, 0.0,    1.0, f_raw_A),   # Case D\n    ]\n\n    results = []\n\n    # 3. Main Calculation Loop\n\n    # Pre-calculate electron speeds for the energy grid\n    # E_J = e * E_eV. v = sqrt(2 * E_J / m_e)\n    # Handle E=0 case to avoid sqrt(0) issues if any, although it is fine.\n    # We add a small epsilon to energy during conversion to avoid division by zero or log of zero if needed,\n    # but here sqrt(0) is 0, which is correct.\n    E_joules = E_grid * e\n    v_E = np.sqrt(2 * E_joules / m_e)\n\n    for case in test_cases:\n        P, T, n_e, s, f_raw_func = case\n\n        # For Case D, n_e = 0, so the rate is trivially 0.\n        if n_e == 0.0:\n            results.append(0.0)\n            continue\n        \n        # a. Generate Raw EEDF\n        f_raw = f_raw_func(E_grid)\n\n        # b. Normalize EEDF\n        # Use trapezoidal rule for integration: integral(y dx)\n        norm_constant = np.trapz(f_raw, E_grid)\n\n        if norm_constant == 0.0:\n            # If the distribution is zero everywhere, the rate is zero.\n            f_norm = np.zeros_like(f_raw)\n        else:\n            f_norm = f_raw / norm_constant  # f_norm has units of 1/eV\n\n        # c. Calculate Rate Coefficient k\n        # Integrand for k is sigma * v * f_norm\n        integrand_k = sigma_E * v_E * f_norm\n        \n        # Integrate over energy in eV to get k in m^3/s\n        k = np.trapz(integrand_k, E_grid)\n\n        # d. Calculate Neutral Density\n        n_cf4 = P / (k_B * T)\n\n        # e. Calculate Volumetric Production Rate R\n        # R = s * k * n_e * n_cf4\n        R = s * k * n_e * n_cf4\n        \n        results.append(R)\n\n    # 4. Final Output\n    # Format the results into the required string format: [r_A,r_B,r_C,r_D]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Ultimately, the goal of reactor modeling is to predict tangible, engineering-relevant outcomes on the wafer. This practice demonstrates how to bridge the gap from particle-level simulation data to a macroscopic process metric: the physical force exerted on the wafer. You will synthesize outputs typical of both Particle-in-Cell (ion flux) and DSMC (neutral flux) models, applying conservation laws to quantify the total momentum transfer and to isolate the crucial contribution of the plasma sheath .",
            "id": "4149175",
            "problem": "You are modeling momentum transfer in a planar plasma reactor used for semiconductor manufacturing, with a wafer subject to bombardment by ions described by Particle-In-Cell (PIC) and neutrals described by Direct Simulation Monte Carlo (DSMC). The goal is to compute the normal momentum transfer to the wafer surface and assess the contribution of the plasma sheath to the net wafer normal force balance.\n\nUse the following foundational principles as the starting point for your derivation and algorithm design: conservation of linear momentum, conservation of mechanical energy for ions accelerated through a collisionless sheath, and the kinetic definition of momentum flux as particle flux multiplied by particle momentum. The plasma sheath is modeled as collisionless and planar, with ions gaining energy from the sheath potential drop. Neutrals are modeled as drift-dominated and undergo diffuse reflection at the wafer, with outgoing neutrals having zero mean normal velocity due to full thermal accommodation at the wall.\n\nYour program must, for each test case, do the following:\n- Starting from the given parameters, determine the ion impact speed at the wafer using conservation of energy, where ions gain energy corresponding to the sheath potential drop. Treat the presheath ion drift speed as provided at the sheath edge.\n- Compute the ion momentum transfer rate per unit area to the wafer using the kinetic definition of momentum flux.\n- Compute the neutral momentum transfer rate per unit area to the wafer using the drift-dominated kinetic momentum flux model based on the mean normal drift velocity and neutral flux.\n- Compute the total wafer normal force by multiplying the sum of ion and neutral momentum fluxes by the wafer area.\n- Compute the sheath contribution to the wafer normal force as the difference between the ion force with and without sheath acceleration, i.e., relative to zero sheath potential.\n\nAll quantities must be expressed and returned in International System of Units (SI). Specifically:\n- Forces must be in newtons ($\\mathrm{N}$).\n- Momentum fluxes must be in newtons per square meter ($\\mathrm{N/m^2}$).\n- Angles are not used.\n- The final output for each test case is a list of four floats in the order: ion momentum flux, neutral momentum flux, total wafer normal force, sheath-contributed wafer normal force, each rounded to six decimal places.\n\nConstants to use:\n- Elementary charge $q = 1.602 \\times 10^{-19} \\ \\mathrm{C}$.\n- Atomic mass unit $m_{\\mathrm{amu}} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$.\n- Wafer area $A_w$ is given by $A_w = \\pi \\left(D_w / 2\\right)^2$, where $D_w$ is the wafer diameter in meters.\n\nDerivations must start from:\n- Energy gained by an ion across the sheath equal to $q V_s$, and change in kinetic energy equal to this gained energy.\n- Momentum per particle equal to mass times speed in the normal direction.\n- Momentum flux equal to particle flux times particle momentum.\n\nTest suite:\nProvide results for the following four test cases. Each case specifies ion and neutral species masses in atomic mass units, plasma and flow parameters, and wafer diameter. Treat ions as singly charged.\n\n1) Case 1 (happy path, argon plasma, moderate sheath):\n- Ion mass $m_i = 39.948 \\ \\mathrm{amu}$, neutral mass $m_n = 39.948 \\ \\mathrm{amu}$.\n- Sheath potential drop $V_s = 50 \\ \\mathrm{V}$.\n- Ion flux $\\Gamma_i = 1.0 \\times 10^{20} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Presheath ion drift speed $u_{i,0} = 500 \\ \\mathrm{m/s}$.\n- Neutral flux $\\Gamma_n = 5.0 \\times 10^{22} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Neutral mean normal drift speed $u_n = 5 \\ \\mathrm{m/s}$.\n- Wafer diameter $D_w = 0.300 \\ \\mathrm{m}$.\n\n2) Case 2 (boundary, zero sheath potential):\n- Ion mass $m_i = 39.948 \\ \\mathrm{amu}$, neutral mass $m_n = 39.948 \\ \\mathrm{amu}$.\n- Sheath potential drop $V_s = 0 \\ \\mathrm{V}$.\n- Ion flux $\\Gamma_i = 1.0 \\times 10^{20} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Presheath ion drift speed $u_{i,0} = 500 \\ \\mathrm{m/s}$.\n- Neutral flux $\\Gamma_n = 5.0 \\times 10^{22} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Neutral mean normal drift speed $u_n = 5 \\ \\mathrm{m/s}$.\n- Wafer diameter $D_w = 0.300 \\ \\mathrm{m}$.\n\n3) Case 3 (edge, heavy ions, strong sheath, no neutral drift):\n- Ion mass $m_i = 69.0 \\ \\mathrm{amu}$, neutral mass $m_n = 39.948 \\ \\mathrm{amu}$.\n- Sheath potential drop $V_s = 200 \\ \\mathrm{V}$.\n- Ion flux $\\Gamma_i = 5.0 \\times 10^{19} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Presheath ion drift speed $u_{i,0} = 800 \\ \\mathrm{m/s}$.\n- Neutral flux $\\Gamma_n = 2.0 \\times 10^{22} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Neutral mean normal drift speed $u_n = 0 \\ \\mathrm{m/s}$.\n- Wafer diameter $D_w = 0.200 \\ \\mathrm{m}$.\n\n4) Case 4 (edge, very low flux, neutrals absent):\n- Ion mass $m_i = 39.948 \\ \\mathrm{amu}$, neutral mass $m_n = 39.948 \\ \\mathrm{amu}$.\n- Sheath potential drop $V_s = 20 \\ \\mathrm{V}$.\n- Ion flux $\\Gamma_i = 1.0 \\times 10^{18} \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Presheath ion drift speed $u_{i,0} = 300 \\ \\mathrm{m/s}$.\n- Neutral flux $\\Gamma_n = 0.0 \\ \\mathrm{m^{-2} \\ s^{-1}}$.\n- Neutral mean normal drift speed $u_n = 0 \\ \\mathrm{m/s}$.\n- Wafer diameter $D_w = 0.100 \\ \\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case maps to a sub-list of four floats in SI units rounded to six decimal places and ordered as $[P_i, P_n, F_{\\mathrm{total}}, \\Delta F]$. For example, the output format is $[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\ldots]$ with no spaces.",
            "solution": "The problem statement is scientifically grounded, well-posed, and contains sufficient information for a unique and meaningful solution. The physical model, based on a collisionless planar sheath and kinetic theory, is a standard and valid simplification used in plasma processing analysis. All parameters are within physically plausible ranges. The problem is therefore deemed valid.\n\nThe solution is derived from the fundamental principles of conservation of energy and linear momentum, and the kinetic definition of momentum flux. We will calculate the four requested quantities for each test case: ion momentum flux ($P_i$), neutral momentum flux ($P_n$), total wafer normal force ($F_{\\mathrm{total}}$), and the sheath-contributed wafer normal force ($\\Delta F$). All quantities will be in SI units.\n\nThe constants used are the elementary charge $q = 1.602 \\times 10^{-19} \\ \\mathrm{C}$ and the atomic mass unit $m_{\\mathrm{amu}} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$. Particle masses given in atomic mass units (amu) are converted to kilograms ($\\mathrm{kg}$) using $m (\\mathrm{kg}) = m (\\mathrm{amu}) \\times m_{\\mathrm{amu}}$.\n\n1. Ion Momentum Transfer\n\nThe momentum transfer from ions to the wafer is determined by their mass, flux, and impact velocity. The ions, treated as singly charged particles, start at the sheath edge with a presheath drift speed $u_{i,0}$ and are accelerated across the sheath by a potential drop $V_s$.\n\nAccording to the principle of conservation of mechanical energy for a collisionless sheath, the change in an ion's kinetic energy is equal to the potential energy it loses.\n$$ \\Delta K_i = q V_s $$\nThe initial kinetic energy at the sheath edge is $K_{i,0} = \\frac{1}{2} m_i u_{i,0}^2$. The final kinetic energy at the wafer surface is $K_{i,f} = \\frac{1}{2} m_i u_{i,f}^2$, where $u_{i,f}$ is the final impact speed.\n$$ \\frac{1}{2} m_i u_{i,f}^2 - \\frac{1}{2} m_i u_{i,0}^2 = q V_s $$\nSolving for the final ion impact speed $u_{i,f}$:\n$$ u_{i,f}^2 = u_{i,0}^2 + \\frac{2 q V_s}{m_i} $$\n$$ u_{i,f} = \\sqrt{u_{i,0}^2 + \\frac{2 q V_s}{m_i}} $$\nThe momentum flux, which is the force per unit area (pressure), is defined as the product of the particle flux $\\Gamma_i$ and the momentum transferred per particle. Assuming the ions are neutralized and desorb with negligible momentum (a perfectly inelastic collision for momentum), the momentum transferred per ion is its incident momentum, $p_{i} = m_i u_{i,f}$.\nThe ion momentum flux $P_i$ is therefore:\n$$ P_i = \\Gamma_i \\cdot p_i = \\Gamma_i m_i u_{i,f} = \\Gamma_i m_i \\sqrt{u_{i,0}^2 + \\frac{2 q V_s}{m_i}} $$\n\n2. Neutral Momentum Transfer\n\nThe neutral particles are described by a drift-dominated model with a mean normal drift speed $u_n$ and a particle flux $\\Gamma_n$. The momentum of a single incident neutral is $p_n = m_n u_n$.\nThe problem states that neutrals undergo diffuse reflection with full thermal accommodation, which implies that the outgoing particles have a zero mean normal velocity. Thus, the surface effectively absorbs the entire incident normal momentum of the neutral particles.\nThe neutral momentum flux $P_n$ is the product of the neutral flux $\\Gamma_n$ and the momentum per neutral particle:\n$$ P_n = \\Gamma_n \\cdot p_n = \\Gamma_n m_n u_n $$\n\n3. Total Wafer Normal Force\n\nThe total pressure exerted on the wafer, $P_{\\mathrm{total}}$, is the sum of the ion and neutral momentum fluxes.\n$$ P_{\\mathrm{total}} = P_i + P_n $$\nThe total normal force, $F_{\\mathrm{total}}$, is this total pressure integrated over the wafer area, $A_w$. For a uniform planar flux, this is simply the product of pressure and area.\nThe wafer area is given by $A_w = \\pi (D_w/2)^2$, where $D_w$ is the wafer diameter.\n$$ F_{\\mathrm{total}} = P_{\\mathrm{total}} \\cdot A_w = (P_i + P_n) \\pi \\left(\\frac{D_w}{2}\\right)^2 $$\n\n4. Sheath-Contributed Wafer Normal Force\n\nThe sheath-contributed force, $\\Delta F$, isolates the effect of ion acceleration within the sheath. It is defined as the difference between the ion force on the wafer with the sheath potential ($V_s$) and the hypothetical ion force if the sheath potential were zero ($V_s = 0$).\n\nThe ion force with the sheath is $F_{i, \\text{sheath}} = P_i A_w$.\nIf $V_s=0$, the ion impact speed would simply be the presheath drift speed, $u_{i,f} = u_{i,0}$. The corresponding ion momentum flux would be $P_{i,0} = \\Gamma_i m_i u_{i,0}$, and the force would be $F_{i,0} = P_{i,0} A_w$.\n\nThe sheath-contributed force is the difference:\n$$ \\Delta F = F_{i, \\text{sheath}} - F_{i,0} = (P_i - P_{i,0}) A_w $$\nSubstituting the expressions for the fluxes:\n$$ \\Delta F = (\\Gamma_i m_i u_{i,f} - \\Gamma_i m_i u_{i,0}) A_w = \\Gamma_i m_i (u_{i,f} - u_{i,0}) A_w $$\nUsing the derived expression for $u_{i,f}$:\n$$ \\Delta F = \\Gamma_i m_i \\left( \\sqrt{u_{i,0}^2 + \\frac{2 q V_s}{m_i}} - u_{i,0} \\right) A_w $$\nThese formulae provide the basis for the numerical computation for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes momentum transfer and forces on a wafer in a plasma reactor.\n    \"\"\"\n    \n    # Constants in SI units\n    Q_E = 1.602e-19  # Elementary charge (C)\n    M_AMU = 1.66053906660e-27  # Atomic mass unit (kg)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1: happy path, argon plasma, moderate sheath\n        {\n            \"m_i_amu\": 39.948, \"m_n_amu\": 39.948,\n            \"V_s\": 50.0, \"gamma_i\": 1.0e20, \"u_i0\": 500.0,\n            \"gamma_n\": 5.0e22, \"u_n\": 5.0, \"D_w\": 0.300\n        },\n        # Case 2: boundary, zero sheath potential\n        {\n            \"m_i_amu\": 39.948, \"m_n_amu\": 39.948,\n            \"V_s\": 0.0, \"gamma_i\": 1.0e20, \"u_i0\": 500.0,\n            \"gamma_n\": 5.0e22, \"u_n\": 5.0, \"D_w\": 0.300\n        },\n        # Case 3: edge, heavy ions, strong sheath, no neutral drift\n        {\n            \"m_i_amu\": 69.0, \"m_n_amu\": 39.948,\n            \"V_s\": 200.0, \"gamma_i\": 5.0e19, \"u_i0\": 800.0,\n            \"gamma_n\": 2.0e22, \"u_n\": 0.0, \"D_w\": 0.200\n        },\n        # Case 4: edge, very low flux, neutrals absent\n        {\n            \"m_i_amu\": 39.948, \"m_n_amu\": 39.948,\n            \"V_s\": 20.0, \"gamma_i\": 1.0e18, \"u_i0\": 300.0,\n            \"gamma_n\": 0.0, \"u_n\": 0.0, \"D_w\": 0.100\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        m_i_amu = case[\"m_i_amu\"]\n        m_n_amu = case[\"m_n_amu\"]\n        V_s = case[\"V_s\"]\n        gamma_i = case[\"gamma_i\"]\n        u_i0 = case[\"u_i0\"]\n        gamma_n = case[\"gamma_n\"]\n        u_n = case[\"u_n\"]\n        D_w = case[\"D_w\"]\n\n        # Convert masses to kg\n        m_i_kg = m_i_amu * M_AMU\n        m_n_kg = m_n_amu * M_AMU\n        \n        # 1. Ion momentum flux (P_i)\n        # Calculate final ion impact speed from energy conservation\n        if m_i_kg > 0:\n            u_if = np.sqrt(u_i0**2 + (2 * Q_E * V_s) / m_i_kg)\n        else: # Avoid division by zero, though not expected in tests\n            u_if = u_i0\n        \n        # Calculate ion momentum flux\n        p_i = gamma_i * m_i_kg * u_if\n        \n        # 2. Neutral momentum flux (P_n)\n        p_n = gamma_n * m_n_kg * u_n\n        \n        # 3. Total wafer normal force (F_total)\n        A_w = np.pi * (D_w / 2)**2\n        F_total = (p_i + p_n) * A_w\n        \n        # 4. Sheath-contributed wafer normal force (delta_F)\n        # This is the difference in ion force due to sheath acceleration\n        # delta_F = (p_i - p_i_at_V_s=0) * A_w\n        p_i_no_sheath = gamma_i * m_i_kg * u_i0\n        delta_F = (p_i - p_i_no_sheath) * A_w\n\n        # Store rounded results\n        results.append([p_i, p_n, F_total, delta_F])\n\n    # Format output as required: [[x1,x2,x3,x4],[y1,y2,y3,y4],...]\n    # Floats are rounded to 6 decimal places during formatting.\n    output_str = f\"[{','.join([f'[{\",\".join([f\"{val:.6f}\" for val in res])}]' for res in results])}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}