{
    "hands_on_practices": [
        {
            "introduction": "在工程实践中，指数加权移动平均（EWMA）滤波器因其简洁高效而广受欢迎，但其参数 $\\lambda$ 的选择往往依赖于经验。本练习旨在揭示 EWMA 滤波器与最优化的卡尔曼滤波器之间的深刻联系。通过推导，您将理解在特定模型下，EWMA 滤波器可以达到最优性能，并学会如何基于过程噪声 ($Q$) 和测量噪声 ($R$) 的方差来系统地确定参数 $\\lambda$，从而将控制器设计从“试错”提升到理论指导的层面。",
            "id": "4162389",
            "problem": "一个单输入、单输出的逐批半导体制造步骤被建模为一个带有加性测量噪声的标量随机游走状态。设在批次 $k$ 的真实过程状态为 $x_k \\in \\mathbb{R}$，其演化过程为 $x_{k+1} = x_k + w_k$，其中 $w_k$ 是零均值、独立同分布的高斯过程噪声，其协方差为 $Q  0$。计量（或虚拟计量）测量值为 $y_k = x_k + v_k$，其中 $v_k$ 是零均值、独立同分布的高斯测量噪声，其协方差为 $R  0$，并且 $\\{w_k\\}$ 和 $\\{v_k\\}$ 相互独立。考虑两种状态估计器：\n\n- 为此模型从卡尔曼滤波器导出的最优线性估计器，在稳态下运行。\n- 指数加权移动平均（EWMA, Exponentially Weighted Moving Average）估计器，其更新公式为 $\\hat{x}_k = (1 - \\lambda)\\,\\hat{x}_{k-1} + \\lambda\\,y_k$，其中 $0  \\lambda  1$ 是一个恒定权重。\n\n从离散时间线性高斯状态空间模型的基本定义、卡尔曼滤波器的最优均方误差特性以及 EWMA 递归出发，推导两种估计器的稳态误差动态，并通过相等关系来解释 EWMA 权重 $\\lambda$ 与过程噪声协方差 $Q$ 和测量噪声协方差 $R$ 之间的关系。\n\n提供一个关于 $Q$ 和 $R$ 的 $\\lambda$ 的单一闭式解析表达式。最终答案必须是一个没有单位的单一表达式。不要使用任何数值；不需要四舍五入。",
            "solution": "该问题要求通过将指数加权移动平均（EWMA）估计器的稳态行为与最优稳态卡尔曼滤波器的稳态行为等同起来，从而得到 EWMA 权重 $\\lambda$ 关于过程和测量噪声协方差 $Q$ 和 $R$ 的解析表达式。\n\n该系统由一个线性离散时间状态空间模型描述。\n状态方程为随机游走：\n$$x_{k+1} = x_k + w_k$$\n测量方程为：\n$$y_k = x_k + v_k$$\n这里，$x_k \\in \\mathbb{R}$ 是在批次 $k$ 的真实过程状态。过程噪声 $w_k$ 来自一个零均值的高斯分布，其协方差为 $Q  0$，即 $w_k \\sim \\mathcal{N}(0, Q)$。测量噪声 $v_k$ 来自一个零均值的高斯分布，其协方差为 $R  0$，即 $v_k \\sim \\mathcal{N}(0, R)$。噪声序列 $\\{w_k\\}$ 和 $\\{v_k\\}$ 是独立同分布的，并且相互独立。\n\n该模型可以写成标准的状态空间形式 $x_{k+1} = A x_k + B u_k + w_k$ 和 $y_k = C x_k + v_k$。对于这个问题，状态转移矩阵为 $A=1$，输入矩阵为 $B=0$（因为估计问题中没有提到控制输入），观测矩阵为 C=1。\n\n首先，我们推导该系统的最优线性估计器——卡尔曼滤波器的方程。设 $\\hat{x}_{k|k-1}$ 是在给定直到 $k-1$ 的测量值时，在时间 $k$ 的状态预测值，而 $\\hat{x}_k$ 是在给定测量值 $y_k$ 时，在时间 $k$ 更新后的状态估计值。设 $P_{k|k-1}$ 和 $P_k$ 是相应的误差协方差。\n\n卡尔曼滤波器包括一个预测-更新循环：\n$1$. 预测：\n状态预测为 $\\hat{x}_{k|k-1} = A\\hat{x}_{k-1} = 1 \\cdot \\hat{x}_{k-1} = \\hat{x}_{k-1}$。\n预测误差协方差为 $P_{k|k-1} = A_k P_{k-1} A_k^T + Q = 1 \\cdot P_{k-1} \\cdot 1^T + Q = P_{k-1} + Q$。\n\n$2$. 更新：\n卡尔曼增益为 $K_k = P_{k|k-1} C^T (C P_{k|k-1} C^T + R)^{-1} = P_{k|k-1} \\cdot 1 \\cdot (1 \\cdot P_{k|k-1} \\cdot 1^T + R)^{-1} = \\frac{P_{k|k-1}}{P_{k|k-1} + R}$。\n使用测量值 $y_k$ 更新状态估计：$\\hat{x}_k = \\hat{x}_{k|k-1} + K_k (y_k - C\\hat{x}_{k|k-1}) = \\hat{x}_{k-1} + K_k(y_k - \\hat{x}_{k-1})$。这可以重写为 $\\hat{x}_k = (1-K_k)\\hat{x}_{k-1} + K_k y_k$。\n更新误差协方差为 $P_k = (1 - K_k C) P_{k|k-1} = (1 - K_k) P_{k|k-1}$。\n\n在稳态下，误差协方差收敛到一个恒定值，$P_k \\to P_{ss}$ 且 $P_{k-1} \\to P_{ss}$。因此，卡尔曼增益也收敛到一个稳态值，$K_k \\to K_{ss}$。稳态协方差 $P_{ss}$ 是离散代数黎卡提方程（DARE）的正解。\n从更新步骤，我们有 $P_{ss} = (1 - K_{ss}) P_{ss|ss-1}$。\n从预测步骤，我们有 $P_{ss|ss-1} = P_{ss} + Q$。\n将第二个方程代入第一个方程，得到 $P_{ss} = (1 - K_{ss})(P_{ss} + Q)$。整理后可得 $K_{ss}(P_{ss}+Q) = Q$。\n同样从更新步骤可知，$K_{ss} = \\frac{P_{ss|ss-1}}{P_{ss|ss-1} + R} = \\frac{P_{ss}+Q}{P_{ss}+Q+R}$。\n现在我们得到了一个关于 $K_{ss}$ 和 $P_{ss}$ 的方程组。将 $P_{ss}+Q = Q/K_{ss}$ 代入 $K_{ss}$ 的表达式中，可以找到它们之间的直接关系：\n$K_{ss} = \\frac{Q/K_{ss}}{Q/K_{ss} + R}$。\n分子分母同乘以 $K_{ss}$ 得到 $K_{ss} = \\frac{Q}{Q + R K_{ss}}$。\n这导出了一个关于 $K_{ss}$ 的二次方程：\n$K_{ss} (Q + R K_{ss}) = Q$\n$R K_{ss}^2 + Q K_{ss} - Q = 0$。\n\n使用二次公式求解这个关于 $K_{ss}$ 的二次方程：\n$$K_{ss} = \\frac{-Q \\pm \\sqrt{Q^2 - 4(R)(-Q)}}{2R} = \\frac{-Q \\pm \\sqrt{Q^2 + 4RQ}}{2R}$$\n由于 $Q  0$ 且 $R  0$，平方根下的项为正。卡尔曼增益 $K_{ss}$ 必须为正，因为 $P_{ss|ss-1}  0$ 且 $R  0$。项 $\\sqrt{Q^2 + 4RQ}  \\sqrt{Q^2} = Q$。因此，我们必须取正根以确保 $K_{ss}  0$。\n最优稳态卡尔曼增益为：\n$$K_{ss} = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}$$\n稳态卡尔曼滤波器的递归公式为 $\\hat{x}_k = (1-K_{ss})\\hat{x}_{k-1} + K_{ss} y_k$。\n\n接下来，我们分析 EWMA 估计器：$\\hat{x}_k = (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k$，其中 $0  \\lambda  1$。\n问题要求推导并使稳态误差动态相等。设估计误差为 $e_k = x_k - \\hat{x}_k$。\n对于 EWMA 估计器：\n$e_k = x_k - \\left( (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k \\right)$\n代入 $y_k = x_k + v_k$：\n$e_k = x_k - (1-\\lambda)\\hat{x}_{k-1} - \\lambda(x_k+v_k) = (1-\\lambda)x_k - (1-\\lambda)\\hat{x}_{k-1} - \\lambda v_k$\n$e_k = (1-\\lambda)(x_k - \\hat{x}_{k-1})$\n代入 $x_k = x_{k-1} + w_{k-1}$ 并加上减去 $(1-\\lambda)x_{k-1}$：\n$e_k = (1-\\lambda)(x_{k-1} + w_{k-1} - \\hat{x}_{k-1}) - \\lambda v_k$\n$e_k = (1-\\lambda)(e_{k-1} + w_{k-1}) - \\lambda v_k$\n所以，EWMA 估计器的误差动态为 $e_k = (1-\\lambda)e_{k-1} + (1-\\lambda)w_{k-1} - \\lambda v_k$。\n\n对于稳态卡尔曼滤波器，推导过程是相同的，只需用 $K_{ss}$ 替换 $\\lambda$。最优滤波器的误差动态为 $e_k = (1-K_{ss})e_{k-1} + (1-K_{ss})w_{k-1} - K_{ss}v_k$。\n\n根据定义，卡尔曼滤波器是均方误差意义下的最优线性估计器。EWMA 是一种线性估计器。要使 EWMA 估计器达到最优，其性能必须与卡尔曼滤波器相匹配。将其误差动态方程相等，可以发现这要求它们的参数必须相同。通过比较两个误差动态方程的系数，或者更简单地，通过比较估计器更新形式：\n卡尔曼滤波器：$\\hat{x}_k = (1-K_{ss})\\hat{x}_{k-1} + K_{ss} y_k$\nEWMA 滤波器： $\\hat{x}_k = (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k$\n显然，对于此模型，EWMA 滤波器在结构上与稳态卡尔曼滤波器相同。当 EWMA 的权重 $\\lambda$ 被选择为等于稳态卡尔曼增益 $K_{ss}$ 时，它就成为最优线性滤波器。\n\n因此，我们通过设置 $\\lambda = K_{ss}$，将 EWMA 权重 $\\lambda$ 解释为最优增益。\n$$\\lambda = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}$$\n该表达式提供了使 EWMA 滤波器成为给定随机游走过程模型的最优线性状态估计器的 $\\lambda$ 值。",
            "answer": "$$\\boxed{\\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}}$$"
        },
        {
            "introduction": "设计了控制器之后，评估其性能至关重要，尤其是在存在随机干扰的环境中。本练习要求您在一个典型的逐批（Run-to-run）控制闭环系统中，分析并推导输出跟踪误差的稳态方差。完成此练习将使您能够量化控制器参数（如 EWMA 权重 $\\lambda$）、过程波动以及测量噪声如何共同影响最终产品的质量，这是理解和优化制造过程穩定性的核心技能。",
            "id": "4162430",
            "problem": "半导体制造中的一个单输入单输出逐批（run-to-run）过程由配方输入 $u_k$ 驱动，以达到目标输出 $y^{\\star}$。在批次 $k$ 的过程输出 $y_k$ 可建模为 $y_k = G u_k + d_k$，其中 $G$ 是（恒定）过程增益，$d_k$ 是一个未测量的加性扰动，其按随机游走 $d_k = d_{k-1} + w_k$ 演化。随机增量 $w_k$ 被假定为独立同分布，其均值为零，方差为 $\\sigma_w^2$。一个虚拟量测（Virtual Metrology, VM）系统提供 $y_k$ 的带噪测量值 $z_k$，其形式为 $z_k = y_k + v_k$，其中 $v_k$ 独立同分布，均值为零，方差为 $\\sigma_v^2$。并且，$\\{w_k\\}$、$\\{v_k\\}$ 以及所有过去的状态和输入都是相互独立的。\n\n一个指数加权移动平均（Exponentially Weighted Moving Average, EWMA）估计器根据以下公式更新扰动的估计值 $\\hat{d}_k$：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda\\left(z_k - G u_k\\right),\n$$\n其中 $0  \\lambda  2$ 是EWMA平滑参数。控制器使用扰动估计值设定下一批次的配方，如下所示：\n$$\nu_{k+1} = \\frac{y^{\\star} - \\hat{d}_k}{G}.\n$$\n定义跟踪误差 $e_k = y_k - y^{\\star}$。假设瞬态已消失，且对于所选的 $\\lambda$，闭环误差过程是平稳的。\n\n从给定的过程和估计器定义出发，推导闭环误差动态，并计算跟踪误差 $e_k$ 的稳态方差，将其表示为关于 $\\sigma_w^2$、$\\sigma_v^2$、$G$ 和 $\\lambda$ 的解析表达式。假设所有变量都是无量纲的。将你的最终答案表示为单个闭式表达式；无需四舍五入。",
            "solution": "用户希望求解一个逐批控制系统的跟踪误差的稳态方差。\n\n### 步骤1：提取已知条件\n- 过程模型: $y_k = G u_k + d_k$\n- 扰动模型: $d_k = d_{k-1} + w_k$\n- 扰动增量属性: $w_k$ 是独立同分布（i.i.d.），$E[w_k] = 0$，方差 $Var(w_k) = \\sigma_w^2$。\n- 虚拟量测（VM）模型: $z_k = y_k + v_k$\n- 测量噪声属性: $v_k$ 是 i.i.d.，$E[v_k] = 0$，方差 $Var(v_k) = \\sigma_v^2$。\n- 独立性: $\\{w_k\\}$, $\\{v_k\\}$ 以及所有过去的状态/输入都是相互独立的。\n- 估计器（EWMA）: $\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda\\left(z_k - G u_k\\right)$\n- EWMA参数范围: $0  \\lambda  2$\n- 控制律: $u_{k+1} = \\frac{y^{\\star} - \\hat{d}_k}{G}$\n- 跟踪误差定义: $e_k = y_k - y^{\\star}$\n- 假设: 闭环误差过程是平稳的。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了标准线性模型来描述过程动态、扰动演化（随机游走或IMA(0,1,1)过程）和控制（EWMA控制器，一种积分控制形式）。该框架是半导体制造中统计过程控制和逐批控制的基石。问题定义明确，提供了推导稳态方差唯一解所需的所有定义、关系和统计特性。所给条件 $0  \\lambda  2$ 是该闭环系统稳定性的标准要求，这为平稳性假设提供了依据。语言客观明确。该问题不违反任何无效性标准。\n\n### 步骤3：结论与行动\n问题有效。详细解答如下。\n\n目标是推导跟踪误差 $e_k = y_k - y^{\\star}$ 的稳态方差 $Var(e_k)$ 的解析表达式。\n\n首先，我们将跟踪误差 $e_k$ 用底层系统变量表示。我们从 $e_k$ 的定义开始，并代入过程模型 $y_k = G u_k + d_k$：\n$$\ne_k = y_k - y^{\\star} = (G u_k + d_k) - y^{\\star}\n$$\n控制律给出的是批次 $k+1$ 的输入，因此我们必须重新索引它以表示批次 $k$ 的输入：\n$$\nu_k = \\frac{y^{\\star} - \\hat{d}_{k-1}}{G}\n$$\n将这个 $u_k$ 的表达式代入 $e_k$ 的方程中：\n$$\ne_k = G \\left( \\frac{y^{\\star} - \\hat{d}_{k-1}}{G} \\right) + d_k - y^{\\star} = (y^{\\star} - \\hat{d}_{k-1}) + d_k - y^{\\star}\n$$\n这简化为跟踪误差和扰动项之间的关系：\n$$\ne_k = d_k - \\hat{d}_{k-1}\n$$\n让我们将批次 $k$ 的扰动估计误差定义为 $\\tilde{d}_k = d_k - \\hat{d}_k$。使用扰动模型 $d_k = d_{k-1} + w_k$，我们可以将跟踪误差重写为：\n$$\ne_k = (d_{k-1} + w_k) - \\hat{d}_{k-1} = (d_{k-1} - \\hat{d}_{k-1}) + w_k = \\tilde{d}_{k-1} + w_k\n$$\n现在可以计算跟踪误差的方差 $Var(e_k)$。由于批次 $k-1$ 的估计误差 $\\tilde{d}_{k-1}$ 仅依赖于直到批次 $k-1$ 的随机变量，因此它与扰动增量 $w_k$ 独立。因此，它们和的方差是它们方差的和：\n$$\nVar(e_k) = Var(\\tilde{d}_{k-1} + w_k) = Var(\\tilde{d}_{k-1}) + Var(w_k) = Var(\\tilde{d}_{k-1}) + \\sigma_w^2\n$$\n在平稳性假设下，估计误差的方差在稳态下是恒定的，即 $Var(\\tilde{d}_k) = Var(\\tilde{d}_{k-1}) = \\sigma_{\\tilde{d}}^2$。因此，我们有：\n$$\nVar(e_k) = \\sigma_{\\tilde{d}}^2 + \\sigma_w^2\n$$\n为了求得 $Var(e_k)$，我们必须先确定 $\\sigma_{\\tilde{d}}^2$。我们需要推导估计误差 $\\tilde{d}_k$ 的动态。我们从EWMA估计器方程开始：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda\\left(z_k - G u_k\\right)\n$$\n括号中的项可以通过代入VM和过程模型来简化：\n$$\nz_k - G u_k = (y_k + v_k) - G u_k = (G u_k + d_k + v_k) - G u_k = d_k + v_k\n$$\n将此代回估计器方程，得到：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda(d_k + v_k)\n$$\n现在，我们寻找估计误差 $\\tilde{d}_k = d_k - \\hat{d}_k$ 的递推表达式：\n$$\n\\tilde{d}_k = d_k - \\left[ (1 - \\lambda)\\hat{d}_{k-1} + \\lambda(d_k + v_k) \\right]\n$$\n$$\n\\tilde{d}_k = (1 - \\lambda)d_k - (1 - \\lambda)\\hat{d}_{k-1} - \\lambda v_k\n$$\n使用扰动模型 $d_k = d_{k-1} + w_k$：\n$$\n\\tilde{d}_k = (1 - \\lambda)(d_{k-1} + w_k) - (1 - \\lambda)\\hat{d}_{k-1} - \\lambda v_k\n$$\n将涉及批次 $k-1$ 变量的项组合在一起：\n$$\n\\tilde{d}_k = (1 - \\lambda)(d_{k-1} - \\hat{d}_{k-1}) + (1 - \\lambda)w_k - \\lambda v_k\n$$\n这就得出了估计误差所需的一阶动态：\n$$\n\\tilde{d}_k = (1 - \\lambda)\\tilde{d}_{k-1} + (1 - \\lambda)w_k - \\lambda v_k\n$$\n现在我们可以计算稳态方差 $\\sigma_{\\tilde{d}}^2 = Var(\\tilde{d}_k)$。右侧的项 $\\tilde{d}_{k-1}$、$w_k$ 和 $v_k$ 是相互独立的。因此，和的方差是方差的和：\n$$\nVar(\\tilde{d}_k) = Var((1 - \\lambda)\\tilde{d}_{k-1}) + Var((1 - \\lambda)w_k) + Var(-\\lambda v_k)\n$$\n$$\nVar(\\tilde{d}_k) = (1 - \\lambda)^2 Var(\\tilde{d}_{k-1}) + (1 - \\lambda)^2 Var(w_k) + (-\\lambda)^2 Var(v_k)\n$$\n在稳态下，$Var(\\tilde{d}_k) = Var(\\tilde{d}_{k-1}) = \\sigma_{\\tilde{d}}^2$。代入此式以及已知的噪声项方差：\n$$\n\\sigma_{\\tilde{d}}^2 = (1 - \\lambda)^2 \\sigma_{\\tilde{d}}^2 + (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n我们现在求解 $\\sigma_{\\tilde{d}}^2$：\n$$\n\\sigma_{\\tilde{d}}^2 - (1 - \\lambda)^2 \\sigma_{\\tilde{d}}^2 = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 \\left(1 - (1 - 2\\lambda + \\lambda^2)\\right) = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 (2\\lambda - \\lambda^2) = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n最后，我们将这个 $\\sigma_{\\tilde{d}}^2$ 的表达式代入我们的跟踪误差方差方程 $Var(e_k) = \\sigma_{\\tilde{d}}^2 + \\sigma_w^2$：\n$$\nVar(e_k) = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)} + \\sigma_w^2\n$$\n为了简化，我们通分：\n$$\nVar(e_k) = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2 + \\lambda(2 - \\lambda)\\sigma_w^2}{\\lambda(2 - \\lambda)}\n$$\n$$\nVar(e_k) = \\frac{\\left[(1 - 2\\lambda + \\lambda^2) + (2\\lambda - \\lambda^2)\\right]\\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n分子中 $\\sigma_w^2$ 的系数简化为 $1$：\n$$\nVar(e_k) = \\frac{1 \\cdot \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n这就是跟踪误差稳态方差的最终解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}}\n$$"
        },
        {
            "introduction": "理论模型终究是现实世界的简化，模型与实际过程之间的失配是工程师必须面对的挑战。本练习将引导您探讨控制器设计的鲁棒性问题，即当实际过程增益与模型假设不符时，系统将如何响应。您将通过分析来确定控制器在保持稳定性和满足性能指标的前提下，所能容忍的最大模型失配范围，这是确保控制器在真实、多变的工业环境中可靠工作的关键一步。",
            "id": "4162401",
            "problem": "一个单输入单输出的逐批（run-to-run）控制器用于调节半导体光刻中的关键尺寸。其标称过程模型为 $y_k = G u_k + \\mu_k$，其中 $y_k$ 是第 $k$ 批的测量输出，$u_k$ 是工艺配方，$G  0$ 是标称过程增益，$\\mu_k$ 是一个未知的过程偏差，且在各批次之间保持恒定。由于对象-模型不匹配，实际增益为 $G(1+\\epsilon)$，其中 $\\epsilon$ 是一个未知的无量纲相对增益误差。\n\n该控制器使用基于标称模型的标准设定点配方和一个指数加权移动平均（EWMA; Exponentially Weighted Moving Average）偏差估计器：\n- 控制律：$u_{k+1} = \\frac{y^{*} - \\hat{\\mu}_k}{G}$，其中 $y^{*}$ 是目标输出，$\\hat{\\mu}_k$ 是第 $k$ 批的偏差估计值。\n- EWMA 估计器更新：$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left(y_{k+1} - G u_{k+1}\\right)$，其中 $0  \\lambda  1$。\n\n假设测量噪声可忽略不计且无偏差漂移，因此 $\\mu_k = \\mu$ 是一个常数。定义估计误差为 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$。从离散时间线性系统稳定性的第一性原理（所有闭环特征值必须严格位于单位圆盘内）和收缩率（谱半径受限于一个规定值）出发，推导作为 $\\epsilon$ 函数的闭环估计误差动力学，并用它来确定最大的对称增益失配幅度 $\\epsilon_{\\max}$，使得对于所有满足 $|\\epsilon| \\leq \\epsilon_{\\max}$ 的 $\\epsilon$，同时满足以下两个条件：\n- 稳定性：所有闭环特征值都位于单位圆盘内。\n- 性能：闭环收缩因子的幅值不超过指定的界限。\n\n取 $\\lambda = 0.6$，并要求收缩因子幅值至多为 $0.7$。将 $\\epsilon_{\\max}$ 表示为一个无量纲数。将您的答案四舍五入到四位有效数字。",
            "solution": "目标是推导估计误差的闭环动力学，并随后确定最大的对称增益失配幅度 $\\epsilon_{\\max}$，以保证控制器同时满足稳定性和指定的性能水平。\n\n系统由以下方程描述：\n实际过程模型：$y_k = G(1+\\epsilon) u_k + \\mu$\n控制律：$u_{k+1} = \\frac{y^{*} - \\hat{\\mu}_k}{G}$\nEWMA 估计器更新：$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left(y_{k+1} - G u_{k+1}\\right)$\n\n这里，$y_k$ 是输出，$u_k$ 是控制配方，$G  0$ 是标称增益，$\\epsilon$ 是相对增益误差，$\\mu$ 是恒定的过程偏差，$y^{*}$ 是目标输出，$\\hat{\\mu}_k$ 是偏差估计值，$\\lambda$ 是 EWMA 平滑常数，其中 $0  \\lambda  1$。估计误差定义为 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$。\n\n我们的第一步是推导估计误差 $\\tilde{\\mu}_k$ 的闭环动力学。我们寻求一个形如 $\\tilde{\\mu}_{k+1} = f(\\tilde{\\mu}_k, \\epsilon)$ 的表达式。\n\n我们首先将第 $k+1$ 批的控制律代入实际过程模型，以用偏差估计值 $\\hat{\\mu}_k$ 来表示输出 $y_{k+1}$：\n$$y_{k+1} = G(1+\\epsilon)u_{k+1} + \\mu = G(1+\\epsilon)\\left(\\frac{y^{*} - \\hat{\\mu}_k}{G}\\right) + \\mu$$\n$$y_{k+1} = (1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu$$\n\n接下来，我们分析估计器更新方程中出现的项 $\\left(y_{k+1} - G u_{k+1}\\right)$。该项表示在应用 EWMA 滤波器之前，在第 $k+1$ 批的估计偏差。\n$$y_{k+1} - G u_{k+1} = \\left[(1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu\\right] - G\\left(\\frac{y^{*} - \\hat{\\mu}_k}{G}\\right)$$\n简化此表达式：\n$$y_{k+1} - G u_{k+1} = (1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu - (y^{*} - \\hat{\\mu}_k)$$\n$$y_{k+1} - G u_{k+1} = (y^{*} - \\hat{\\mu}_k) + \\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu - (y^{*} - \\hat{\\mu}_k)$$\n$$y_{k+1} - G u_{k+1} = \\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu$$\n\n现在，将此结果代入 EWMA 估计器更新方程：\n$$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left[\\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu\\right]$$\n展开并重新排列各项以对 $\\hat{\\mu}_k$ 进行分组：\n$$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} - (1-\\lambda)\\epsilon \\hat{\\mu}_k + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu$$\n$$\\hat{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right] \\hat{\\mu}_k + (1-\\lambda)(\\epsilon y^{*} + \\mu)$$\n\n为了获得估计误差 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$ 的动力学，我们将 $\\hat{\\mu}_k = \\tilde{\\mu}_k + \\mu$ 和 $\\hat{\\mu}_{k+1} = \\tilde{\\mu}_{k+1} + \\mu$ 代入上述方程：\n$$\\tilde{\\mu}_{k+1} + \\mu = \\left[\\lambda - (1-\\lambda)\\epsilon\\right](\\tilde{\\mu}_k + \\mu) + (1-\\lambda)(\\epsilon y^{*} + \\mu)$$\n$$\\tilde{\\mu}_{k+1} + \\mu = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\mu + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu$$\n分离出 $\\tilde{\\mu}_{k+1}$：\n$$\\tilde{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + \\lambda\\mu - (1-\\lambda)\\epsilon\\mu + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu - \\mu$$\n常数项可以简化为：\n$$\\lambda\\mu - \\mu + (1-\\lambda)\\mu = (\\lambda - 1 + 1 - \\lambda)\\mu = 0$$\n剩余的包含 $\\epsilon$ 的项是：\n$$(1-\\lambda)\\epsilon y^{*} - (1-\\lambda)\\epsilon\\mu = (1-\\lambda)\\epsilon(y^{*} - \\mu)$$\n因此，闭环估计误差动力学由以下一阶仿射差分方程给出：\n$$\\tilde{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + (1-\\lambda)\\epsilon(y^{*} - \\mu)$$\n\n这个离散时间系统的稳定性和收敛速度由其齐次部分的特征值的模决定。由于这是一个标量系统，特征值就是 $\\tilde{\\mu}_k$ 的系数。我们将其定义为闭环收缩因子 $\\rho$：\n$$\\rho(\\epsilon) = \\lambda - (1-\\lambda)\\epsilon$$\n\n题目施加了两个条件：\n$1$. 稳定性：对于离散时间线性系统，所有特征值必须严格位于单位圆盘内部。这意味着 $|\\rho(\\epsilon)|  1$。\n$2$. 性能：闭环收缩因子的幅值不得超过指定的界限 $0.7$。这意味着 $|\\rho(\\epsilon)| \\leq 0.7$。\n\n性能条件比稳定性条件更严格（$0.7  1$），因此满足性能条件就自动保证了稳定性。因此，我们必须解以下不等式：\n$$|\\lambda - (1-\\lambda)\\epsilon| \\leq 0.7$$\n\n给定 $\\lambda = 0.6$，这意味着 $1-\\lambda = 0.4$。代入这些值：\n$$|0.6 - 0.4\\epsilon| \\leq 0.7$$\n此不等式等价于：\n$$-0.7 \\leq 0.6 - 0.4\\epsilon \\leq 0.7$$\n我们解这个关于 $\\epsilon$ 的双边不等式。首先，所有部分都减去 $0.6$：\n$$-0.7 - 0.6 \\leq -0.4\\epsilon \\leq 0.7 - 0.6$$\n$$-1.3 \\leq -0.4\\epsilon \\leq 0.1$$\n接下来，所有部分都除以 $-0.4$。此操作会反转不等号的方向：\n$$\\frac{-1.3}{-0.4} \\geq \\epsilon \\geq \\frac{0.1}{-0.4}$$\n$$\\frac{1.3}{0.4} \\geq \\epsilon \\geq -0.25$$\n$$3.25 \\geq \\epsilon \\geq -0.25$$\n所以，满足性能要求的增益失配 $\\epsilon$ 的范围是 $[-0.25, 3.25]$。\n\n题目要求的是最大的对称增益失配幅度 $\\epsilon_{\\max}$，使得对于所有满足 $|\\epsilon| \\leq \\epsilon_{\\max}$ 的 $\\epsilon$，条件都成立。这意味着我们必须找到最大的 $\\epsilon_{\\max} \\geq 0$ 值，使得对称区间 $[-\\epsilon_{\\max}, \\epsilon_{\\max}]$ 是有效区间 $[-0.25, 3.25]$ 的子集。\n要使区间 $[-\\epsilon_{\\max}, \\epsilon_{\\max}]$ 包含在 $[-0.25, 3.25]$ 内，我们必须同时满足：\n$$-\\epsilon_{\\max} \\geq -0.25 \\implies \\epsilon_{\\max} \\leq 0.25$$\n$$\\epsilon_{\\max} \\leq 3.25$$\n为了同时满足这两个条件，$\\epsilon_{\\max}$ 必须小于或等于两个边界的最小值：\n$$\\epsilon_{\\max} \\leq \\min(0.25, 3.25) = 0.25$$\n因此，$\\epsilon_{\\max}$ 的最大值为 $0.25$。\n\n题目要求答案四舍五入到四位有效数字。\n$$\\epsilon_{\\max} = 0.2500$$",
            "answer": "$$\\boxed{0.2500}$$"
        }
    ]
}