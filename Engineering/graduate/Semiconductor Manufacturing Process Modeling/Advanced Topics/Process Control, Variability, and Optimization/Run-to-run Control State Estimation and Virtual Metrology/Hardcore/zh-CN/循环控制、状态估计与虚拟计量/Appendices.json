{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立指数加权移动平均（EWMA）滤波器与最优卡尔曼滤波器之间的深刻联系。通过推导并比较两者在稳态下的误差动态，您将揭示在何种条件下简单的 EWMA 滤波器能够达到最优估计性能，并学会如何根据过程和测量噪声的方差来解释和选择 EWMA 的平滑参数 $\\lambda$ 。这项实践对于深刻理解状态估计的理论基础至关重要。",
            "id": "4162389",
            "problem": "一个单输入单输出的逐批半导体制造步骤被建模为一个带有加性测量噪声的标量随机游走状态。设在第 $k$ 批的真实过程状态为 $x_k \\in \\mathbb{R}$，其演化过程为 $x_{k+1} = x_k + w_k$，其中 $w_k$ 是零均值、独立同分布的高斯过程噪声，其协方差为 $Q > 0$。计量（或虚拟计量）测量值为 $y_k = x_k + v_k$，其中 $v_k$ 是零均值、独立同分布的高斯测量噪声，其协方差为 $R > 0$，且 $\\{w_k\\}$ 和 $\\{v_k\\}$ 相互独立。考虑两种状态估计器：\n\n- 从此模型的卡尔曼滤波器推导出的、在稳态下运行的最优线性估计器。\n- 指数加权移动平均（EWMA）估计器，其更新公式为 $\\hat{x}_k = (1 - \\lambda)\\,\\hat{x}_{k-1} + \\lambda\\,y_k$，其中 $0 < \\lambda < 1$ 是一个恒定权重。\n\n从离散时间线性高斯状态空间模型的基本定义、表征卡尔曼滤波器的最优均方误差特性以及 EWMA 递归式出发，推导两种估计器的稳态误差动态，并通过等同它们来解释 EWMA 权重 $\\lambda$ 如何用过程和测量噪声协方差 $Q$ 和 $R$ 表示。\n\n提供一个 $\\lambda$ 作为 $Q$ 和 $R$ 函数的单一闭式解析表达式。最终答案必须是单一表达式，不带单位。不要使用任何数值；无需四舍五入。",
            "solution": "该问题要求通过将指数加权移动平均（EWMA）估计器的稳态行为与最优稳态卡尔曼滤波器的行为等同，来得到 EWMA 权重 $\\lambda$ 关于过程和测量噪声协方差 $Q$ 和 $R$ 的解析表达式。\n\n该系统由一个线性离散时间状态空间模型描述。\n状态方程为随机游走：\n$$x_{k+1} = x_k + w_k$$\n测量方程为：\n$$y_k = x_k + v_k$$\n这里，$x_k \\in \\mathbb{R}$ 是在批次 $k$ 的真实过程状态。过程噪声 $w_k$ 来自协方差为 $Q > 0$ 的零均值高斯分布，即 $w_k \\sim \\mathcal{N}(0, Q)$。测量噪声 $v_k$ 来自协方差为 $R > 0$ 的零均值高斯分布，即 $v_k \\sim \\mathcal{N}(0, R)$。噪声序列 $\\{w_k\\}$ 和 $\\{v_k\\}$ 是独立同分布的，并且相互独立。\n\n该模型可以写成标准的状态空间形式 $x_{k+1} = A x_k + B u_k + w_k$ 和 $y_k = C x_k + v_k$。对于这个问题，状态转移矩阵为 $A=1$，输入矩阵为 $B=0$（因为估计问题中没有提到控制输入），观测矩阵为 $C=1$。\n\n首先，我们为此系统推导最优线性估计器——卡尔曼滤波器的方程。令 $\\hat{x}_{k|k-1}$ 为在给定截至 $k-1$ 的测量值时，在时间 $k$ 的状态预测值，令 $\\hat{x}_k$ 为在给定测量值 $y_k$ 时，在时间 $k$ 的更新状态估计值。令 $P_{k|k-1}$ 和 $P_k$ 为相应的误差协方差。\n\n卡尔曼滤波器包含一个预测-更新周期：\n$1$. 预测：\n状态预测为 $\\hat{x}_{k|k-1} = A\\hat{x}_{k-1} = 1 \\cdot \\hat{x}_{k-1} = \\hat{x}_{k-1}$。\n预测误差协方差为 $P_{k|k-1} = A P_{k-1} A^T + Q = 1 \\cdot P_{k-1} \\cdot 1^T + Q = P_{k-1} + Q$。\n\n$2$. 更新：\n卡尔曼增益为 $K_k = P_{k|k-1} C^T (C P_{k|k-1} C^T + R)^{-1} = P_{k|k-1} \\cdot 1 \\cdot (1 \\cdot P_{k|k-1} \\cdot 1^T + R)^{-1} = \\frac{P_{k|k-1}}{P_{k|k-1} + R}$。\n状态估计使用测量值 $y_k$ 进行更新：$\\hat{x}_k = \\hat{x}_{k|k-1} + K_k (y_k - C\\hat{x}_{k|k-1}) = \\hat{x}_{k-1} + K_k(y_k - \\hat{x}_{k-1})$。这可以重写为 $\\hat{x}_k = (1-K_k)\\hat{x}_{k-1} + K_k y_k$。\n更新误差协方差为 $P_k = (1 - K_k C) P_{k|k-1} = (1 - K_k) P_{k|k-1}$。\n\n在稳态下，误差协方差收敛到一个常数值，$P_k \\to P_{ss}$ 且 $P_{k-1} \\to P_{ss}$。因此，卡尔曼增益也收敛到一个稳态值，$K_k \\to K_{ss}$。稳态协方差 $P_{ss}$ 是离散代数Riccati方程（DARE）的正解。\n从更新步骤，我们有 $P_{ss} = (1 - K_{ss}) P_{ss|ss-1}$。\n从预测步骤，我们有 $P_{ss|ss-1} = P_{ss} + Q$。\n将第二个代入第一个得到 $P_{ss} = (1 - K_{ss})(P_{ss} + Q)$。重新整理得到 $K_{ss}(P_{ss}+Q) = Q$。\n同样从更新步骤，$K_{ss} = \\frac{P_{ss|ss-1}}{P_{ss|ss-1} + R} = \\frac{P_{ss}+Q}{P_{ss}+Q+R}$。\n我们现在得到了一个关于 $K_{ss}$ 和 $P_{ss}$ 的方程组。通过将 $P_{ss}+Q = Q/K_{ss}$ 代入 $K_{ss}$ 的表达式中，可以找到它们之间的直接关系：\n$K_{ss} = \\frac{Q/K_{ss}}{Q/K_{ss} + R}$。\n分子分母同乘以 $K_{ss}$ 得到 $K_{ss} = \\frac{Q}{Q + R K_{ss}}$。\n这导出了一个关于 $K_{ss}$ 的二次方程：\n$K_{ss} (Q + R K_{ss}) = Q$\n$R K_{ss}^2 + Q K_{ss} - Q = 0$。\n\n使用二次公式求解此关于 $K_{ss}$ 的二次方程：\n$$K_{ss} = \\frac{-Q \\pm \\sqrt{Q^2 - 4(R)(-Q)}}{2R} = \\frac{-Q \\pm \\sqrt{Q^2 + 4RQ}}{2R}$$\n因为 $Q > 0$ 且 $R > 0$，所以平方根下的项为正。卡尔曼增益 $K_{ss}$ 必须为正，因为 $P_{ss|ss-1} > 0$ 且 $R > 0$。项 $\\sqrt{Q^2 + 4RQ} > \\sqrt{Q^2} = Q$。因此，我们必须取正根以确保 $K_{ss} > 0$。\n最优稳态卡尔曼增益为：\n$$K_{ss} = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}$$\n稳态卡尔曼滤波器的递归式由 $\\hat{x}_k = (1-K_{ss})\\hat{x}_{k-1} + K_{ss} y_k$ 给出。\n\n接下来，我们分析 EWMA 估计器：$\\hat{x}_k = (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k$，其中 $0 < \\lambda < 1$。\n问题要求推导并等同稳态误差动态。令估计误差为 $e_k = x_k - \\hat{x}_k$。\n对于 EWMA 估计器：\n$e_k = x_k - \\left( (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k \\right)$\n代入 $y_k = x_k + v_k$：\n$e_k = x_k - (1-\\lambda)\\hat{x}_{k-1} - \\lambda(x_k+v_k) = (1-\\lambda)x_k - (1-\\lambda)\\hat{x}_{k-1} - \\lambda v_k$\n$e_k = (1-\\lambda)(x_k - \\hat{x}_{k-1})$\n代入 $x_k = x_{k-1} + w_{k-1}$ 并加上和减去 $(1-\\lambda)x_{k-1}$：\n$e_k = (1-\\lambda)(x_{k-1} + w_{k-1} - \\hat{x}_{k-1}) - \\lambda v_k$\n$e_k = (1-\\lambda)(e_{k-1} + w_{k-1}) - \\lambda v_k$\n所以，EWMA 估计器的误差动态为 $e_k = (1-\\lambda)e_{k-1} + (1-\\lambda)w_{k-1} - \\lambda v_k$。\n\n对于稳态卡尔曼滤波器，推导过程是相同的，只是用 $K_{ss}$ 替换 $\\lambda$。最优滤波器的误差动态为 $e_k = (1-K_{ss})e_{k-1} + (1-K_{ss})w_{k-1} - K_{ss}v_k$。\n\n根据定义，卡尔曼滤波器是均方误差意义下的最优线性估计器。EWMA 是一种线性估计器。要使 EWMA 估计器达到最优，其性能必须与卡尔曼滤波器相匹配。通过等同它们的误差动态，可以发现这要求它们的参数必须相同。通过比较两个误差动态方程的系数，或者更简单地，通过比较估计器更新形式：\n卡尔曼滤波器：$\\hat{x}_k = (1-K_{ss})\\hat{x}_{k-1} + K_{ss} y_k$\nEWMA 滤波器：$\\hat{x}_k = (1-\\lambda)\\hat{x}_{k-1} + \\lambda y_k$\n很明显，对于此模型，EWMA 滤波器在结构上与稳态卡尔曼滤波器相同。当 EWMA 的权重 $\\lambda$ 被选择为等于稳态卡尔曼增益 $K_{ss}$ 时，它就成为最优线性滤波器。\n\n因此，我们通过设置 $\\lambda = K_{ss}$ 将 EWMA 权重 $\\lambda$ 解释为最优增益。\n$$\\lambda = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}$$\n此表达式给出了使 EWMA 滤波器成为给定随机游走过程模型的最优线性状态估计器的 $\\lambda$ 值。",
            "answer": "$$\\boxed{\\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2R}}$$"
        },
        {
            "introduction": "在掌握了状态估计的基础后，下一个关键步骤是分析其在闭环控制系统中的性能。本练习将一个 EWMA 估算器嵌入到逐批（run-to-run）控制回路中，要求您推导系统稳态跟踪误差的方差 。通过这个过程，您将学会如何量化控制器参数（如 EWMA 权重 $\\lambda$）对最终输出稳定性的影响，并理解过程扰动和测量噪声如何共同决定了控制系统的性能极限。",
            "id": "4162430",
            "problem": "半导体制造中的一个单输入单输出批次间过程由配方输入 $u_k$ 驱动，以达到目标输出 $y^{\\star}$。在批次 $k$ 的过程输出 $y_k$ 可建模为 $y_k = G u_k + d_k$，其中 $G$ 是（恒定的）过程增益，$d_k$ 是一个未测量的加性扰动，其演化过程为随机游走 $d_k = d_{k-1} + w_k$。随机增量 $w_k$ 假设为独立同分布，其均值为零，方差为 $\\sigma_w^2$。一个虚拟量测 (VM) 系统提供 $y_k$ 的一个带噪测量值 $z_k$，其形式为 $z_k = y_k + v_k$，其中 $v_k$ 是独立同分布的，均值为零，方差为 $\\sigma_v^2$，并且 $\\{w_k\\}$、$\\{v_k\\}$ 以及所有过去的状态和输入都是相互独立的。\n\n一个指数加权移动平均 (EWMA) 估计器根据以下公式更新扰动的估计值 $\\hat{d}_k$：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda\\left(z_k - G u_k\\right),\n$$\n其中 $0 < \\lambda < 2$ 是 EWMA 平滑参数。控制器使用扰动估计值来设定下一批次的配方，如下所示：\n$$\nu_{k+1} = \\frac{y^{\\star} - \\hat{d}_k}{G}.\n$$\n定义跟踪误差 $e_k = y_k - y^{\\star}$。假设瞬态已消失，并且对于所选的 $\\lambda$，闭环误差过程是平稳的。\n\n从给定的过程和估计器定义出发，推导闭环误差动态，并计算跟踪误差 $e_k$ 的稳态方差，结果应为一个以 $\\sigma_w^2$、$\\sigma_v^2$、$G$ 和 $\\lambda$ 表示的解析表达式。假设所有变量都是无量纲的。将您的最终答案表示为单个闭式表达式；无需进行四舍五入。",
            "solution": "目标是推导跟踪误差 $e_k = y_k - y^{\\star}$ 的稳态方差 $Var(e_k)$ 的解析表达式。\n\n首先，我们用底层系统变量来表示跟踪误差 $e_k$。我们从 $e_k$ 的定义开始，并代入过程模型 $y_k = G u_k + d_k$：\n$$\ne_k = y_k - y^{\\star} = (G u_k + d_k) - y^{\\star}\n$$\n控制器法则是针对批次 $k+1$ 的输入给出的，因此我们必须重新索引它以表示批次 $k$ 的输入：\n$$\nu_k = \\frac{y^{\\star} - \\hat{d}_{k-1}}{G}\n$$\n将此 $u_k$ 的表达式代入 $e_k$ 的方程中：\n$$\ne_k = G \\left( \\frac{y^{\\star} - \\hat{d}_{k-1}}{G} \\right) + d_k - y^{\\star} = (y^{\\star} - \\hat{d}_{k-1}) + d_k - y^{\\star}\n$$\n这可以简化为跟踪误差和扰动项之间的关系：\n$$\ne_k = d_k - \\hat{d}_{k-1}\n$$\n让我们定义在批次 $k$ 的扰动估计误差为 $\\tilde{d}_k = d_k - \\hat{d}_k$。使用扰动模型 $d_k = d_{k-1} + w_k$，我们可以将跟踪误差重写为：\n$$\ne_k = (d_{k-1} + w_k) - \\hat{d}_{k-1} = (d_{k-1} - \\hat{d}_{k-1}) + w_k = \\tilde{d}_{k-1} + w_k\n$$\n现在可以计算跟踪误差的方差 $Var(e_k)$。由于批次 $k-1$ 的估计误差 $\\tilde{d}_{k-1}$ 仅取决于到批次 $k-1$ 为止的随机变量，因此它与扰动增量 $w_k$ 是独立的。因此，它们之和的方差等于它们各自方差之和：\n$$\nVar(e_k) = Var(\\tilde{d}_{k-1} + w_k) = Var(\\tilde{d}_{k-1}) + Var(w_k) = Var(\\tilde{d}_{k-1}) + \\sigma_w^2\n$$\n在平稳性假设下，估计误差的方差在稳态下是恒定的，即 $Var(\\tilde{d}_k) = Var(\\tilde{d}_{k-1}) = \\sigma_{\\tilde{d}}^2$。因此，我们有：\n$$\nVar(e_k) = \\sigma_{\\tilde{d}}^2 + \\sigma_w^2\n$$\n为了求出 $Var(e_k)$，我们必须首先确定 $\\sigma_{\\tilde{d}}^2$。我们需要推导估计误差 $\\tilde{d}_k$ 的动态。我们从 EWMA 估计器方程开始：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda\\left(z_k - G u_k\\right)\n$$\n括号中的项可以通过代入 VM 和过程模型来简化：\n$$\nz_k - G u_k = (y_k + v_k) - G u_k = (G u_k + d_k + v_k) - G u_k = d_k + v_k\n$$\n将此代回估计器方程，得到：\n$$\n\\hat{d}_k = (1 - \\lambda)\\hat{d}_{k-1} + \\lambda(d_k + v_k)\n$$\n现在，我们来求估计误差 $\\tilde{d}_k = d_k - \\hat{d}_k$ 的递归表达式：\n$$\n\\tilde{d}_k = d_k - \\left[ (1 - \\lambda)\\hat{d}_{k-1} + \\lambda(d_k + v_k) \\right]\n$$\n$$\n\\tilde{d}_k = (1 - \\lambda)d_k - (1 - \\lambda)\\hat{d}_{k-1} - \\lambda v_k\n$$\n使用扰动模型 $d_k = d_{k-1} + w_k$：\n$$\n\\tilde{d}_k = (1 - \\lambda)(d_{k-1} + w_k) - (1 - \\lambda)\\hat{d}_{k-1} - \\lambda v_k\n$$\n将涉及批次 $k-1$ 变量的项组合在一起：\n$$\n\\tilde{d}_k = (1 - \\lambda)(d_{k-1} - \\hat{d}_{k-1}) + (1 - \\lambda)w_k - \\lambda v_k\n$$\n这就得出了我们想要的估计误差的一阶动态：\n$$\n\\tilde{d}_k = (1 - \\lambda)\\tilde{d}_{k-1} + (1 - \\lambda)w_k - \\lambda v_k\n$$\n现在我们可以计算稳态方差 $\\sigma_{\\tilde{d}}^2 = Var(\\tilde{d}_k)$。右侧的项 $\\tilde{d}_{k-1}$、$w_k$ 和 $v_k$ 是相互独立的。因此，和的方差等于各项方差之和：\n$$\nVar(\\tilde{d}_k) = Var((1 - \\lambda)\\tilde{d}_{k-1}) + Var((1 - \\lambda)w_k) + Var(-\\lambda v_k)\n$$\n$$\nVar(\\tilde{d}_k) = (1 - \\lambda)^2 Var(\\tilde{d}_{k-1}) + (1 - \\lambda)^2 Var(w_k) + (-\\lambda)^2 Var(v_k)\n$$\n在稳态下，$Var(\\tilde{d}_k) = Var(\\tilde{d}_{k-1}) = \\sigma_{\\tilde{d}}^2$。代入此式以及已知的噪声项方差：\n$$\n\\sigma_{\\tilde{d}}^2 = (1 - \\lambda)^2 \\sigma_{\\tilde{d}}^2 + (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n我们现在求解 $\\sigma_{\\tilde{d}}^2$：\n$$\n\\sigma_{\\tilde{d}}^2 - (1 - \\lambda)^2 \\sigma_{\\tilde{d}}^2 = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 \\left(1 - (1 - 2\\lambda + \\lambda^2)\\right) = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 (2\\lambda - \\lambda^2) = (1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2\n$$\n$$\n\\sigma_{\\tilde{d}}^2 = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n最后，我们将 $\\sigma_{\\tilde{d}}^2$ 的这个表达式代入我们的跟踪误差方差方程 $Var(e_k) = \\sigma_{\\tilde{d}}^2 + \\sigma_w^2$ 中：\n$$\nVar(e_k) = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)} + \\sigma_w^2\n$$\n为了简化，我们通分：\n$$\nVar(e_k) = \\frac{(1 - \\lambda)^2 \\sigma_w^2 + \\lambda^2 \\sigma_v^2 + \\lambda(2 - \\lambda)\\sigma_w^2}{\\lambda(2 - \\lambda)}\n$$\n$$\nVar(e_k) = \\frac{\\left[(1 - 2\\lambda + \\lambda^2) + (2\\lambda - \\lambda^2)\\right]\\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n分子中 $\\sigma_w^2$ 的系数简化为 1：\n$$\nVar(e_k) = \\frac{1 \\cdot \\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}\n$$\n这就是跟踪误差稳态方差的最终解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_w^2 + \\lambda^2 \\sigma_v^2}{\\lambda(2 - \\lambda)}}\n$$"
        },
        {
            "introduction": "理想化的模型在现实世界中很少存在，因此，评估控制器在模型不确定性下的鲁棒性至关重要。本练习引入了“工厂-模型不匹配”的概念，探讨了当实际过程增益与控制器设计时使用的标称增益存在偏差时，系统的稳定性和性能会受到何种影响 。通过确定系统能够容忍的最大增益误差，您将学习到鲁棒性分析的基本方法，这对于设计在真实、多变的制造环境中依然可靠的控制策略至关重要。",
            "id": "4162401",
            "problem": "一个单输入单输出的逐批控制器被用于调节半导体光刻中的关键尺寸。标称过程模型为 $y_k = G u_k + \\mu_k$，其中 $y_k$ 是在第 $k$ 批次测得的输出，$u_k$ 是配方，$G > 0$ 是标称过程增益，$\\mu_k$ 是一个在各批次间恒定的未知过程偏差。由于过程-模型失配，真实增益为 $G(1+\\epsilon)$，其中 $\\epsilon$ 是一个未知的无量纲相对增益误差。\n\n该控制器使用基于标称模型的标准设定点配方和一个指数加权移动平均（EWMA）偏差估计器：\n- 控制律：$u_{k+1} = \\frac{y^{*} - \\hat{\\mu}_k}{G}$，其中 $y^{*}$ 是目标输出，$\\hat{\\mu}_k$ 是在第 $k$ 批次的偏差估计。\n- EWMA 估计器更新：$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left(y_{k+1} - G u_{k+1}\\right)$，其中 $0 < \\lambda < 1$。\n\n假设测量噪声可忽略不计，且无偏差漂移，因此 $\\mu_k = \\mu$ 是一个常数。定义估计误差 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$。从离散时间线性系统稳定性的基本原理（所有闭环特征值必须严格位于单位圆盘内）和收缩率（谱半径受限于一个预定值）出发，推导作为 $\\epsilon$ 函数的闭环估计误差动态，并用它来确定最大的对称增益-失配幅度 $\\epsilon_{\\max}$，使得对于所有满足 $|\\epsilon| \\leq \\epsilon_{\\max}$ 的 $\\epsilon$，同时满足以下两个条件：\n- 稳定性：所有闭环特征值都位于单位圆盘内。\n- 性能：闭环收缩因子的大小不超过一个指定的界限。\n\n取 $\\lambda = 0.6$ 并要求收缩因子的大小至多为 $0.7$。将 $\\epsilon_{\\max}$ 表示为一个无量纲数。将您的答案四舍五入到四位有效数字。",
            "solution": "目标是推导估计误差的闭环动态，并随后确定最大的对称增益-失配幅度 $\\epsilon_{\\max}$，以保证控制器的稳定性和指定的性能水平。\n\n系统由以下方程描述：\n真实过程模型：$y_k = G(1+\\epsilon) u_k + \\mu$\n控制律：$u_{k+1} = \\frac{y^{*} - \\hat{\\mu}_k}{G}$\nEWMA 估计器更新：$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left(y_{k+1} - G u_{k+1}\\right)$\n\n这里，$y_k$ 是输出，$u_k$ 是控制配方，$G > 0$ 是标称增益，$\\epsilon$ 是相对增益误差，$\\mu$ 是恒定的过程偏差，$y^{*}$ 是目标输出，$\\hat{\\mu}_k$ 是偏差估计，$\\lambda$ 是 EWMA 平滑常数，其中 $0 < \\lambda < 1$。估计误差定义为 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$。\n\n我们的第一步是推导估计误差 $\\tilde{\\mu}_k$ 的闭环动态。我们寻求一个形式为 $\\tilde{\\mu}_{k+1} = f(\\tilde{\\mu}_k, \\epsilon)$ 的表达式。\n\n我们首先将第 $k+1$ 批次的控制律代入真实过程模型，以偏差估计 $\\hat{\\mu}_k$ 来表示输出 $y_{k+1}$：\n$$y_{k+1} = G(1+\\epsilon)u_{k+1} + \\mu = G(1+\\epsilon)\\left(\\frac{y^{*} - \\hat{\\mu}_k}{G}\\right) + \\mu$$\n$$y_{k+1} = (1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu$$\n\n接下来，我们分析出现在估计器更新方程中的项 $\\left(y_{k+1} - G u_{k+1}\\right)$。该项表示在应用 EWMA 滤波器之前，在第 $k+1$ 批次估计的偏差。\n$$y_{k+1} - G u_{k+1} = \\left[(1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu\\right] - G\\left(\\frac{y^{*} - \\hat{\\mu}_k}{G}\\right)$$\n简化这个表达式：\n$$y_{k+1} - G u_{k+1} = (1+\\epsilon)(y^{*} - \\hat{\\mu}_k) + \\mu - (y^{*} - \\hat{\\mu}_k)$$\n$$y_{k+1} - G u_{k+1} = (y^{*} - \\hat{\\mu}_k) + \\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu - (y^{*} - \\hat{\\mu}_k)$$\n$$y_{k+1} - G u_{k+1} = \\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu$$\n\n现在，将此结果代入 EWMA 估计器更新方程：\n$$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} + (1-\\lambda)\\left[\\epsilon(y^{*} - \\hat{\\mu}_k) + \\mu\\right]$$\n展开并重新排列各项以对 $\\hat{\\mu}_k$ 进行分组：\n$$\\hat{\\mu}_{k+1} = \\lambda \\hat{\\mu}_{k} - (1-\\lambda)\\epsilon \\hat{\\mu}_k + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu$$\n$$\\hat{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right] \\hat{\\mu}_k + (1-\\lambda)(\\epsilon y^{*} + \\mu)$$\n\n为了获得估计误差 $\\tilde{\\mu}_k = \\hat{\\mu}_k - \\mu$ 的动态，我们将 $\\hat{\\mu}_k = \\tilde{\\mu}_k + \\mu$ 和 $\\hat{\\mu}_{k+1} = \\tilde{\\mu}_{k+1} + \\mu$ 代入上述方程：\n$$\\tilde{\\mu}_{k+1} + \\mu = \\left[\\lambda - (1-\\lambda)\\epsilon\\right](\\tilde{\\mu}_k + \\mu) + (1-\\lambda)(\\epsilon y^{*} + \\mu)$$\n$$\\tilde{\\mu}_{k+1} + \\mu = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\mu + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu$$\n分离出 $\\tilde{\\mu}_{k+1}$：\n$$\\tilde{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + \\lambda\\mu - (1-\\lambda)\\epsilon\\mu + (1-\\lambda)\\epsilon y^{*} + (1-\\lambda)\\mu - \\mu$$\n常数项可以被简化：\n$$\\lambda\\mu - \\mu + (1-\\lambda)\\mu = (\\lambda - 1 + 1 - \\lambda)\\mu = 0$$\n涉及 $\\epsilon$ 的剩余项是：\n$$(1-\\lambda)\\epsilon y^{*} - (1-\\lambda)\\epsilon\\mu = (1-\\lambda)\\epsilon(y^{*} - \\mu)$$\n因此，闭环估计误差动态由以下一阶仿射差分方程给出：\n$$\\tilde{\\mu}_{k+1} = \\left[\\lambda - (1-\\lambda)\\epsilon\\right]\\tilde{\\mu}_k + (1-\\lambda)\\epsilon(y^{*} - \\mu)$$\n\n这个离散时间系统的稳定性和收敛速度由齐次部分的特征值的大小决定。由于这是一个标量系统，特征值就是 $\\tilde{\\mu}_k$ 的系数。我们将其定义为闭环收缩因子 $\\rho$：\n$$\\rho(\\epsilon) = \\lambda - (1-\\lambda)\\epsilon$$\n\n问题提出了两个条件：\n$1$. 稳定性：对于离散时间线性系统，所有特征值必须严格位于单位圆盘内。这意味着 $|\\rho(\\epsilon)| < 1$。\n$2$. 性能：闭环收缩因子的大小不得超过指定的界限 $0.7$。这意味着 $|\\rho(\\epsilon)| \\leq 0.7$。\n\n性能条件比稳定性条件更严格（$0.7 < 1$），因此满足性能条件自动确保了稳定性。因此我们必须解以下不等式：\n$$|\\lambda - (1-\\lambda)\\epsilon| \\leq 0.7$$\n\n给定 $\\lambda = 0.6$，这意味着 $1-\\lambda = 0.4$。代入这些值：\n$$|0.6 - 0.4\\epsilon| \\leq 0.7$$\n这个不等式等价于：\n$$-0.7 \\leq 0.6 - 0.4\\epsilon \\leq 0.7$$\n我们对这个双边不等式求解 $\\epsilon$。首先，从所有部分减去 $0.6$：\n$$-0.7 - 0.6 \\leq -0.4\\epsilon \\leq 0.7 - 0.6$$\n$$-1.3 \\leq -0.4\\epsilon \\leq 0.1$$\n接下来，将所有部分除以 $-0.4$。这个操作会反转不等号的方向：\n$$\\frac{-1.3}{-0.4} \\geq \\epsilon \\geq \\frac{0.1}{-0.4}$$\n$$\\frac{1.3}{0.4} \\geq \\epsilon \\geq -0.25$$\n$$3.25 \\geq \\epsilon \\geq -0.25$$\n所以，满足性能要求的增益失配 $\\epsilon$ 的范围是 $[-0.25, 3.25]$。\n\n问题要求的是最大的对称增益-失配幅度 $\\epsilon_{\\max}$，使得对于所有满足 $|\\epsilon| \\leq \\epsilon_{\\max}$ 的 $\\epsilon$，条件都成立。这意味着我们必须找到最大的值 $\\epsilon_{\\max} \\geq 0$，使得对称区间 $[-\\epsilon_{\\max}, \\epsilon_{\\max}]$ 是有效区间 $[-0.25, 3.25]$ 的一个子集。\n为了使区间 $[-\\epsilon_{\\max}, \\epsilon_{\\max}]$ 包含在 $[-0.25, 3.25]$ 内，我们必须同时满足：\n$$-\\epsilon_{\\max} \\geq -0.25 \\implies \\epsilon_{\\max} \\leq 0.25$$\n$$\\epsilon_{\\max} \\leq 3.25$$\n为了同时满足这两个条件，$\\epsilon_{\\max}$ 必须小于或等于两个边界的最小值：\n$$\\epsilon_{\\max} \\leq \\min(0.25, 3.25) = 0.25$$\n因此，$\\epsilon_{\\max}$ 的最大值为 $0.25$。\n\n问题要求答案四舍五入到四位有效数字。\n$$\\epsilon_{\\max} = 0.2500$$",
            "answer": "$$\\boxed{0.2500}$$"
        }
    ]
}