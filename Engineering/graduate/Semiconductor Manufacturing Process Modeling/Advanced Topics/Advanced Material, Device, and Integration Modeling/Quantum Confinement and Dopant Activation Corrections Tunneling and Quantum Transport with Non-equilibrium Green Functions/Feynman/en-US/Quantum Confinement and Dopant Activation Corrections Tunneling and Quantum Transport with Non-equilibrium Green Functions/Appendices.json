{
    "hands_on_practices": [
        {
            "introduction": "To understand how nanoscale dimensions fundamentally alter a semiconductor's electronic properties, we begin with the most fundamental case: a one-dimensional quantum well. This exercise guides you through modeling an ultra-thin silicon film as a particle in an infinite potential well, a cornerstone of quantum mechanics. By deriving the quantized energy levels, you will directly calculate the upward shift in the conduction band edge, a direct consequence of quantum confinement that is essential for accurately modeling the threshold voltage and performance of modern transistors .",
            "id": "4158084",
            "problem": "A silicon-on-insulator ultra-thin body transistor employs a crystalline silicon film of thickness $t$ oriented along $(001)$ and laterally extended in the $x$-$y$ plane. To incorporate quantum confinement corrections to the conduction band edge into a quantum transport Hamiltonian used with the Non-Equilibrium Green’s Function (NEGF) method, model the motion along the confinement direction $z$ using the effective mass approximation with a single conduction-band valley characterized by a quantization-direction effective mass $m_{z}$. Assume the silicon film is bounded above and below by silicon dioxide, and that the silicon dioxide conduction band offset is sufficiently large that the potential outside the silicon film may be treated as infinite to leading order. Inside the film, set the potential energy reference at the bulk conduction band minimum so that the potential is zero.\n\nStarting from the one-dimensional effective-mass Schrödinger equation in the confinement direction and imposing physically appropriate boundary conditions for an infinite quantum well of width $t$, derive the discrete subband energies in the silicon film. Using these results, determine:\n\n1. The upward shift of the conduction band edge due to quantum confinement, defined as the energy of the lowest occupied electron subband relative to the bulk conduction band minimum.\n2. The energy spacing between the first and second subbands in the same valley.\n\nExpress both answers symbolically in terms of $t$, $m_{z}$, and fundamental constants, and provide them as analytic expressions in Joules. Do not evaluate numerically.",
            "solution": "The problem requires us to find the quantized energy levels for an electron confined in a one-dimensional potential well, which models the thin silicon film. The motion of the electron in the confinement direction, designated as the $z$-direction, is described by the one-dimensional time-independent effective-mass Schrödinger equation:\n$$\n-\\frac{\\hbar^2}{2m_{z}} \\frac{d^2\\psi(z)}{dz^2} + V(z)\\psi(z) = E \\psi(z)\n$$\nHere, $\\psi(z)$ is the electron wavefunction, $E$ is the energy eigenvalue, $\\hbar$ is the reduced Planck constant, and $m_{z}$ is the effective mass of the electron for motion along the $z$-direction.\n\nThe problem specifies that the silicon film has a thickness $t$. We can define the spatial coordinates such that the film occupies the region $0  z  t$. The potential energy $V(z)$ inside the film is set to zero, taking the bulk silicon conduction band minimum as the energy reference. Outside the film, the potential is assumed to be infinite, which models the large conduction band offset between silicon and silicon dioxide. The potential profile is therefore that of an infinite square well:\n$$\nV(z) = \\begin{cases} 0  \\text{for } 0  z  t \\\\ \\infty  \\text{for } z \\le 0 \\text{ and } z \\ge t \\end{cases}\n$$\nInside the well, where $V(z) = 0$, the Schrödinger equation simplifies to:\n$$\n-\\frac{\\hbar^2}{2m_{z}} \\frac{d^2\\psi(z)}{dz^2} = E \\psi(z)\n$$\nThis can be rearranged into the form of a standard second-order linear homogeneous differential equation:\n$$\n\\frac{d^2\\psi(z)}{dz^2} + \\frac{2m_{z}E}{\\hbar^2}\\psi(z) = 0\n$$\nLet us define a wave number $k$ as $k = \\sqrt{\\frac{2m_{z}E}{\\hbar^2}}$. Since $m_z$ is positive and we are looking for bound states with $E  0$, $k$ is real and positive. The equation becomes:\n$$\n\\frac{d^2\\psi(z)}{dz^2} + k^2\\psi(z) = 0\n$$\nThe general solution to this equation is a linear combination of sine and cosine functions:\n$$\n\\psi(z) = A \\sin(kz) + B \\cos(kz)\n$$\nwhere $A$ and $B$ are constants.\n\nTo find the specific solution, we must apply the boundary conditions. The infinite potential barrier implies that the probability of finding the particle outside the well is zero. For the wavefunction to be continuous, it must be zero at the boundaries of the well.\nThe first boundary condition is at $z=0$:\n$$\n\\psi(0) = 0 \\implies A \\sin(k \\cdot 0) + B \\cos(k \\cdot 0) = B \\cdot 1 = 0\n$$\nThis implies that $B=0$. The wavefunction is therefore reduced to the form:\n$$\n\\psi(z) = A \\sin(kz)\n$$\nThe second boundary condition is at $z=t$:\n$$\n\\psi(t) = 0 \\implies A \\sin(kt) = 0\n$$\nFor a non-trivial solution (i.e., for the particle to exist), the constant $A$ cannot be zero. Therefore, we must have:\n$$\n\\sin(kt) = 0\n$$\nThis condition is satisfied only when the argument of the sine function is an integer multiple of $\\pi$.\n$$\nkt = n\\pi, \\quad \\text{where } n \\text{ is an integer.}\n$$\nThe case $n=0$ would lead to $k=0$ and thus $\\psi(z)=0$ for all $z$, which corresponds to no particle. Negative integers for $n$ do not yield physically new solutions, as $\\sin(-x) = -\\sin(x)$, which only changes the overall sign of the wavefunction, a physically irrelevant phase. Thus, we consider only positive integer values for the quantum number $n$:\n$$\nn = 1, 2, 3, \\ldots\n$$\nFrom this quantization condition, we find discrete allowed values for the wave number $k_n$:\n$$\nk_n = \\frac{n\\pi}{t}\n$$\nSubstituting this back into the definition of $k$, $k^2 = \\frac{2m_{z}E}{\\hbar^2}$, we can solve for the allowed energy eigenvalues, $E_n$, which are the energies of the discrete subbands:\n$$\n\\left(\\frac{n\\pi}{t}\\right)^2 = \\frac{2m_{z}E_n}{\\hbar^2}\n$$\nSolving for $E_n$ gives:\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\n\nWith this general expression for the subband energies, we can now address the two specific questions posed.\n\n1. The upward shift of the conduction band edge is defined as the energy of the lowest occupied electron subband relative to the bulk conduction band minimum (which is our $E=0$ reference). This is the ground state energy of the system, which corresponds to the lowest possible quantum number, $n=1$.\n$$\nE_1 = \\frac{(1)^2 \\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{\\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\nThis energy $E_1$ is also known as the zero-point energy of the confined electron.\n\n2. The energy spacing between the first and second subbands is the difference between their respective energy eigenvalues, $E_2$ and $E_1$. The energy of the second subband corresponds to the quantum number $n=2$.\n$$\nE_2 = \\frac{(2)^2 \\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{4 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\nThe energy spacing, $\\Delta E_{21}$, is:\n$$\n\\Delta E_{21} = E_2 - E_1 = \\frac{4 \\pi^2 \\hbar^2}{2 m_{z} t^2} - \\frac{\\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{3 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\nThese expressions are in terms of the given parameters ($t$, $m_{z}$) and fundamental constants ($\\pi$, $\\hbar$), and have units of energy (Joules in the SI system), as required.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\pi^2 \\hbar^2}{2 m_z t^2}  \\frac{3 \\pi^2 \\hbar^2}{2 m_z t^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the principles of 1D confinement, this practice extends the analysis to a more complex and technologically relevant structure: a cylindrical silicon nanowire. This problem requires you to solve the effective-mass Schrödinger equation in cylindrical coordinates, where the solutions involve Bessel functions, to determine the subband energy structure. This exercise bridges analytical theory and numerical practice, demonstrating how to compute the energy dispersion $E(k)$ and verify the concept of longitudinal effective mass from the band curvature, which are critical inputs for any quantum transport simulation in nanowire-based devices .",
            "id": "4158063",
            "problem": "Consider a cylindrical silicon nanowire of radius $R$ aligned along the $z$-axis. Assume the conduction band valley aligned with the wire axis has anisotropic effective mass: longitudinal mass $m_{\\ell}$ along $z$ and transverse mass $m_{t}$ in the radial plane. Under the Effective Mass Approximation (EMA), the single-electron envelope satisfies the time-independent Schrödinger equation with a hard-wall (infinite barrier) confinement at $r=R$. In cylindrical coordinates $(r,\\theta,z)$, the transverse modes separate from the longitudinal motion along $z$. The transverse eigenfunctions are Bessel functions of the first kind $J_{m}(x)$ indexed by the integer angular momentum $m \\in \\mathbb{Z}$ with radial quantization determined by the zeros $\\alpha_{m,p}$ of $J_{m}(x)$, where $p \\in \\mathbb{N}$ enumerates the roots in ascending order. The longitudinal motion is free along $z$ within EMA.\n\nStarting only from these fundamental bases:\n- The separation of variables in cylindrical coordinates for the Schrödinger equation under hard-wall confinement.\n- The properties of Bessel functions $J_{m}(x)$ and their zeros $\\alpha_{m,p}$.\n- The parabolic dispersion of a free particle under EMA along the transport direction.\n\nYour tasks are:\n1. Derive the transverse quantization energy $E_{m,p}^{\\mathrm{trans}}$ for the mode $(m,p)$ and the longitudinal dispersion $E(k)$ for wavevector $k$ along $z$.\n2. Show how the curvature of $E(k)$ at $k=0$ relates to the longitudinal effective mass $m_{\\ell}$.\n3. Implement a program that, for each specified test case, computes:\n   - The transverse quantization energy $E_{m,p}^{\\mathrm{trans}}$ in electronvolts (eV).\n   - The longitudinal effective mass inferred from the dispersion curvature near $k=0$, expressed as a ratio to the free electron mass $m_{0}$, i.e., $m_{\\mathrm{eff}}/m_{0}$.\n   Use a symmetric second-order finite difference to estimate the curvature at $k=0$ with step $h$ in units of inverse meters (m$^{-1}$). The dispersion must be constructed from first principles of EMA using the derived expressions.\n\nAssumptions and constants to be used:\n- Use $m_{0} = 9.1093837015 \\times 10^{-31}$ kilograms.\n- Use the reduced Planck constant $\\,\\hbar = 1.054571817 \\times 10^{-34}$ joule-seconds.\n- Use $q = 1.602176634 \\times 10^{-19}$ joules per electronvolt for unit conversion.\n- The Bessel zeros $\\alpha_{m,p}$ are dimensionless and must be computed numerically to high accuracy using standard special function routines.\n- The nanowire has an infinite barrier at $r=R$ (Dirichlet boundary).\n\nUnit specifications:\n- Report $E_{m,p}^{\\mathrm{trans}}$ in electronvolts (eV), rounded to three decimal places.\n- Report $m_{\\mathrm{eff}}/m_{0}$ as a decimal rounded to six decimal places.\n- Wavevector $k$ and the difference step $h$ must both be interpreted in inverse meters (m$^{-1}$).\n- Radius $R$ is given in nanometers (nm) and must be converted to meters.\n\nTest suite (each case is a tuple $(R_{\\mathrm{nm}}, m, p, m_{\\ell}/m_{0}, m_{t}/m_{0}, h)$):\n- Case 1: $(3.0, 0, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- Case 2: $(5.0, 1, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- Case 3: $(20.0, 0, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- Case 4: $(1.5, 0, 2, 0.916, 0.19, 1.0 \\times 10^{7})$\n\nAlgorithmic requirements:\n- For each case, compute the first $p$ zeros of $J_{m}(x)$ and select $\\alpha_{m,p}$.\n- Compute the transverse energy $E_{m,p}^{\\mathrm{trans}}$ using the derived expression in joules, then convert to electronvolts.\n- Construct the longitudinal dispersion near $k=0$ using the EMA expression and evaluate $E(k)$ at $k=-h, 0, +h$ to numerically estimate the second derivative at $k=0$ by a symmetric second-order finite difference.\n- Infer $m_{\\mathrm{eff}}$ from the curvature and compute the ratio $m_{\\mathrm{eff}}/m_{0}$.\n\nFinal output format:\n- Your program should produce a single line of output containing all results for the test suite as a comma-separated flat list enclosed in square brackets, with entries ordered by test case and, within each case, ordered as $\\left[E_{m,p}^{\\mathrm{trans}}\\,\\text{(eV)},\\, m_{\\mathrm{eff}}/m_{0}\\right]$. For example, the overall output should be of the form:\n$$\\left[E_{\\text{case 1}},\\,\\left(\\frac{m_{\\mathrm{eff}}}{m_{0}}\\right)_{\\text{case 1}},\\,E_{\\text{case 2}},\\,\\left(\\frac{m_{\\mathrm{eff}}}{m_{0}}\\right)_{\\text{case 2}},\\,\\ldots\\right].$$\n\nContext note:\n- While the broader framework of quantum transport with Non-Equilibrium Green’s Functions (NEGF) would use these subband dispersions to construct the Hamiltonian and self-energies for transport along $z$, this problem focuses on establishing the subband dispersion via EMA and verifying the effective mass relationship through curvature. Ensure physical realism and numerical stability in all computations.",
            "solution": "The problem requires a derivation of the energy dispersion for an electron in a cylindrical silicon nanowire, followed by a numerical implementation to compute specific physical quantities.\n\nThe starting point is the time-independent Schrödinger equation under the Effective Mass Approximation (EMA). For a cylindrical nanowire of radius $R$ aligned with the $z$-axis, and with an anisotropic effective mass tensor (longitudinal mass $m_{\\ell}$ along the $z$-axis and transverse mass $m_{t}$ in the xy-plane), the Hamiltonian $H$ is given by:\n$$ H = -\\frac{\\hbar^2}{2m_t} \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} \\right) - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} $$\nIn cylindrical coordinates $(r, \\theta, z)$, the transverse part of the Laplacian is $\\nabla^2_{r,\\theta} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\theta^2}$. The Hamiltonian becomes:\n$$ H = -\\frac{\\hbar^2}{2m_t} \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\theta^2} \\right] - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} $$\nThe envelope function $\\Psi(r, \\theta, z)$ must satisfy the Schrödinger equation $H \\Psi = E \\Psi$ with a hard-wall boundary condition $\\Psi(R, \\theta, z) = 0$.\n\nWe use the method of separation of variables. Given the translational symmetry along the $z$-axis, the wavefunction can be written as a product of a transverse part $F(r, \\theta)$ and a longitudinal plane wave $\\phi(z) = e^{ikz}$, where $k$ is the wavevector along the $z$-direction:\n$$ \\Psi(r, \\theta, z) = F(r, \\theta) e^{ikz} $$\nSubstituting this into the Schrödinger equation:\n$$ \\left( -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} \\right) F(r,\\theta)e^{ikz} = E F(r,\\theta)e^{ikz} $$\nThe action of the $z$-derivative is $\\frac{\\partial^2}{\\partial z^2} e^{ikz} = -k^2 e^{ikz}$. The equation simplifies to:\n$$ \\left( -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} F(r,\\theta) \\right) + \\frac{\\hbar^2 k^2}{2m_\\ell} F(r, \\theta) = E F(r, \\theta) $$\nThis equation shows that the total energy $E$ is a sum of a transverse energy component, which depends on the quantization in the $(r, \\theta)$ plane, and a longitudinal kinetic energy component. We can write $E(k) = E^{\\mathrm{trans}} + E^{\\mathrm{long}}(k)$, where the longitudinal dispersion is:\n$$ E^{\\mathrm{long}}(k) = \\frac{\\hbar^2 k^2}{2m_\\ell} $$\nThe transverse part of the wavefunction, $F(r, \\theta)$, must satisfy its own eigenvalue equation:\n$$ -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} F(r, \\theta) = E^{\\mathrm{trans}} F(r, \\theta) $$\nWe apply separation of variables again for the transverse function, $F(r, \\theta) = \\mathcal{R}(r)\\Theta(\\theta)$. Substituting this into the transverse equation gives:\n$$ -\\frac{\\hbar^2}{2m_t} \\left[ \\frac{\\Theta(\\theta)}{r}\\frac{d}{dr}\\left(r\\frac{d\\mathcal{R}}{dr}\\right) + \\frac{\\mathcal{R}(r)}{r^2}\\frac{d^2\\Theta}{d\\theta^2} \\right] = E^{\\mathrm{trans}} \\mathcal{R}(r)\\Theta(\\theta) $$\nMultiplying by $\\frac{r^2}{\\mathcal{R}(r)\\Theta(\\theta)}$ and rearranging terms separates the $r$-dependent and $\\theta$-dependent parts:\n$$ \\frac{r}{\\mathcal{R}}\\frac{d}{dr}\\left(r\\fracd\\mathcal{R}}{dr}\\right) + \\frac{2m_t E^{\\mathrm{trans}} r^2}{\\hbar^2} = -\\frac{1}{\\Theta}\\frac{d^2\\Theta}{d\\theta^2} $$\nSince the left side depends only on $r$ and the right side only on $\\theta$, both must be equal to a constant. Let this constant be $m^2$. The azimuthal equation is $\\frac{d^2\\Theta}{d\\theta^2} = -m^2 \\Theta$, which has solutions $\\Theta(\\theta) = e^{im\\theta}$. For the wavefunction to be single-valued, $\\Theta(\\theta+2\\pi) = \\Theta(\\theta)$, which requires $m$ to be an integer, $m \\in \\mathbb{Z}$.\n\nThe radial equation is then:\n$$ r^2 \\frac{d^2\\mathcal{R}}{dr^2} + r\\frac{d\\mathcal{R}}{dr} + \\left( \\frac{2m_t E^{\\mathrm{trans}}}{\\hbar^2} r^2 - m^2 \\right) \\mathcal{R} = 0 $$\nLet's define a constant $K^2 = \\frac{2m_t E^{\\mathrm{trans}}}{\\hbar^2}$. The equation becomes:\n$$ r^2 \\mathcal{R}'' + r \\mathcal{R}' + (K^2 r^2 - m^2)\\mathcal{R} = 0 $$\nThis is Bessel's differential equation. Its general solution is a linear combination of Bessel functions of the first kind, $J_m(Kr)$, and the second kind, $Y_m(Kr)$. Since the wavefunction must be finite at the origin $r=0$, and $Y_m(x)$ diverges as $x \\to 0$, we must discard the $Y_m$ solution. The physical solution for the radial part is $\\mathcal{R}(r) = A J_m(Kr)$, where $A$ is a normalization constant.\n\nThe hard-wall boundary condition at the nanowire surface requires $\\mathcal{R}(R)=0$. This translates to:\n$$ J_m(KR) = 0 $$\nThis condition quantizes the possible values of $K$. The argument $KR$ must be one of the zeros of the Bessel function $J_m(x)$. Let $\\alpha_{m,p}$ denote the $p$-th positive zero of $J_m(x)$, where $p \\in \\mathbb{N}$ ($p=1, 2, 3, \\ldots$) is the radial quantum number. Thus, for each mode $(m,p)$:\n$$ K_{m,p} R = \\alpha_{m,p} \\implies K_{m,p} = \\frac{\\alpha_{m,p}}{R} $$\nSubstituting the definition of $K_{m,p}$, we can solve for the transverse quantization energy $E_{m,p}^{\\mathrm{trans}}$:\n$$ \\left(\\frac{\\alpha_{m,p}}{R}\\right)^2 = \\frac{2m_t E_{m,p}^{\\mathrm{trans}}}{\\hbar^2} $$\n$$ E_{m,p}^{\\mathrm{trans}} = \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} $$\nThis is the derived expression for the transverse quantization energy for the subband indexed by $(m,p)$.\n\nThe total energy dispersion for the subband $(m,p)$ combines the transverse and longitudinal parts:\n$$ E_{m,p}(k) = E_{m,p}^{\\mathrm{trans}} + E^{\\mathrm{long}}(k) = \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} + \\frac{\\hbar^2 k^2}{2m_\\ell} $$\n\nNext, we relate the curvature of this dispersion to the effective mass. The effective mass $m_{\\mathrm{eff}}$ of a charge carrier is defined by the curvature of its energy band $E(k)$ as:\n$$ \\frac{1}{m_{\\mathrm{eff}}} = \\frac{1}{\\hbar^2} \\frac{d^2E(k)}{dk^2} $$\nFor our derived longitudinal dispersion $E_{m,p}(k)$, the second derivative with respect to $k$ is:\n$$ \\frac{dE_{m,p}(k)}{dk} = \\frac{d}{dk} \\left( \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} + \\frac{\\hbar^2 k^2}{2m_\\ell} \\right) = \\frac{\\hbar^2 k}{m_\\ell} $$\n$$ \\frac{d^2E_{m,p}(k)}{dk^2} = \\frac{\\hbar^2}{m_\\ell} $$\nThis curvature is constant for all $k$, including $k=0$. Substituting this into the definition of effective mass:\n$$ \\frac{1}{m_{\\mathrm{eff}}} = \\frac{1}{\\hbar^2} \\left( \\frac{\\hbar^2}{m_\\ell} \\right) = \\frac{1}{m_\\ell} $$\n$$ m_{\\mathrm{eff}} = m_\\ell $$\nThis confirms that the effective mass extracted from the curvature of the parabolic dispersion is identical to the longitudinal mass $m_\\ell$ used in the initial Hamiltonian.\n\nThe numerical implementation will calculate $E_{m,p}^{\\mathrm{trans}}$ using its derived formula. It will then numerically estimate the curvature $\\frac{d^2E}{dk^2}$ at $k=0$ using the symmetric second-order finite difference formula:\n$$ \\left. \\frac{d^2E}{dk^2} \\right|_{k=0} \\approx \\frac{E(h) - 2E(0) + E(-h)}{h^2} $$\nwhere $h$ is a small step in wavevector. The numerically determined effective mass is then $m_{\\mathrm{eff, num}} = \\hbar^2 / \\left( \\frac{d^2E}{dk^2} \\right)_{\\mathrm{num}}$. As shown analytically, for a perfectly parabolic band, this numerical procedure should recover $m_\\ell$ with high accuracy, limited only by floating-point precision.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn_zeros\n\ndef solve():\n    \"\"\"\n    Computes transverse quantization energy and longitudinal effective mass\n    for an electron in a cylindrical silicon nanowire for a given set of\n    test cases.\n    \"\"\"\n    # Physical constants in SI units\n    m0 = 9.1093837015e-31   # Free electron mass in kg\n    hbar = 1.054571817e-34  # Reduced Planck constant in J·s\n    q = 1.602176634e-19     # Elementary charge in C (for J to eV conversion)\n\n    # Test suite: (R in nm, m, p, ml_ratio, mt_ratio, h in m^-1)\n    test_cases = [\n        (3.0, 0, 1, 0.916, 0.19, 1.0e7),\n        (5.0, 1, 1, 0.916, 0.19, 1.0e7),\n        (20.0, 0, 1, 0.916, 0.19, 1.0e7),\n        (1.5, 0, 2, 0.916, 0.19, 1.0e7),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_nm, m, p, ml_ratio, mt_ratio, h = case\n\n        # Convert input parameters to SI units\n        R = R_nm * 1e-9      # Radius in meters\n        ml = ml_ratio * m0   # Longitudinal effective mass in kg\n        mt = mt_ratio * m0   # Transverse effective mass in kg\n\n        # --- Task 1: Compute transverse quantization energy E_trans ---\n\n        # Find the p-th positive zero of the m-th order Bessel function of the first kind.\n        # scipy.special.jn_zeros(m, p) returns the first p zeros; we need the p-th one.\n        alpha_mp = jn_zeros(m, p)[p-1]\n\n        # Calculate E_trans in Joules using the derived formula:\n        # E_trans = (hbar^2 * alpha_mp^2) / (2 * mt * R^2)\n        E_trans_J = (hbar**2 * alpha_mp**2) / (2 * mt * R**2)\n\n        # Convert E_trans to electronvolts (eV) and round to three decimal places.\n        E_trans_eV = round(E_trans_J / q, 3)\n        \n        # --- Task 2: Compute effective mass from dispersion curvature ---\n\n        # Define the total energy dispersion function E(k) for the given subband.\n        # E(k) = E_trans + E_long(k) = E_trans + (hbar^2 * k^2) / (2 * ml)\n        def E_dispersion(k_val):\n            return E_trans_J + (hbar**2 * k_val**2) / (2 * ml)\n\n        # Evaluate E(k) at k = -h, 0, +h for the finite difference calculation.\n        E_plus_h = E_dispersion(h)\n        E_zero = E_dispersion(0)\n        E_minus_h = E_dispersion(-h)\n        \n        # Calculate the second derivative (curvature) at k=0 using the\n        # symmetric second-order finite difference formula.\n        # curvature = (E(h) - 2*E(0) + E(-h)) / h^2\n        curvature = (E_plus_h - 2 * E_zero + E_minus_h) / h**2\n\n        # Infer the effective mass from the curvature using the definition:\n        # 1/m_eff = (1/hbar^2) * d^2E/dk^2 = m_eff = hbar^2 / curvature\n        # This numerical test should recover the input m_l due to the parabolic dispersion.\n        m_eff = hbar**2 / curvature\n\n        # Calculate the ratio m_eff/m_0 and round to six decimal places.\n        m_eff_ratio = round(m_eff / m0, 6)\n\n        # Append the calculated results for the current case.\n        results.append(E_trans_eV)\n        results.append(m_eff_ratio)\n\n    # Print the final result as a single line, with values formatted as a\n    # comma-separated flat list enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After establishing the quantized energy levels, the next step is to model the flow of electrons through the device, a process governed by quantum transport. This advanced practice introduces the powerful Non-Equilibrium Green's Function (NEGF) formalism to analyze a single-level system coupled to contacts and subject to scattering. You will implement the self-consistent Born approximation to see how interactions with dopant-induced disorder modify the device's spectral function $A(E)$ and give rise to a finite carrier lifetime $\\tau(E)$. This exercise provides direct insight into how scattering limits performance by calculating its effect on the transmission probability $T(E)$, a key metric in nanoscale electronics .",
            "id": "4158081",
            "problem": "Consider a one-level quantum-confined region (an effective resonant state due to confinement and activated dopants) coupled to two contacts within the Non-Equilibrium Green’s Functions (NEGF) framework. The single level has onsite energy $\\,\\varepsilon_0\\,$ and is coupled to the left and right contacts with energy-independent broadenings (wide-band limit) $\\,\\Gamma_L\\,$ and $\\,\\Gamma_R\\,$, respectively. The device experiences elastic, local scattering due to short-range disorder associated with activated dopants, modeled by a self-consistent Born approximation with a scalar scattering strength $\\,D\\,$. All energies must be treated in electronvolts (eV).\n\nStarting from fundamental NEGF definitions:\n- The retarded Green’s function is defined by $\\,G^r(E) = \\big[E - \\varepsilon_0 - \\Sigma_L^r(E) - \\Sigma_R^r(E) - \\Sigma_s^r(E)\\big]^{-1}\\,$.\n- The contact self-energies in the wide-band limit are purely imaginary and energy-independent, with $\\,\\Sigma_{\\alpha}^r(E) = -\\dfrac{i}{2}\\,\\Gamma_{\\alpha}\\,$ for $\\alpha \\in \\{L,R\\}$.\n- The spectral function is $\\,A(E) = i\\big(G^r(E) - G^a(E)\\big)\\,$.\n- The total broadening is related to the spectral function and retarded functions by NEGF identities.\n\nAssume an elastic, local, self-consistent Born approximation for the scattering self-energy of the form $\\,\\Sigma_s^r(E)\\,$ proportional to the retarded Green’s function $\\,G^r(E)\\,$, with a scalar proportionality factor $\\,D\\,$ that encodes the scattering strength of dopant-induced disorder. This self-energy must be treated self-consistently with $\\,G^r(E)\\,$. Define the energy-resolved finite lifetime $\\,\\tau(E)\\,$ via the total broadening and Planck’s constant divided by $2\\pi$ (reduced Planck constant) $\\,\\hbar\\,$, and express the lifetime in femtoseconds. Use $\\,\\hbar = 6.582119569\\times 10^{-16}\\,$ eV·s, and recall that $\\,1\\,$ femtosecond $= 10^{-15}\\,$ seconds.\n\nYour tasks are:\n1. Starting from the above base definitions, show how the self-consistent treatment of elastic scattering modifies the spectral function $\\,A(E)\\,$ and produces a finite energy-resolved lifetime $\\,\\tau(E)\\,$, in terms of the total broadening.\n2. Quantify the resulting transmission $\\,T(E)\\,$ for two-terminal transport where the left and right contacts are at the same electrochemical potential (linear response), making use of the well-established NEGF expressions in the presence of elastic, current-conserving scattering.\n\nNumerical requirements:\n- Implement a program that, for each specified test case, computes:\n  - The spectral function value $\\,A(E)\\,$ in units of $\\,\\text{eV}^{-1}$.\n  - The lifetime $\\,\\tau(E)\\,$ in femtoseconds.\n  - The transmission $\\,T(E)\\,$ (dimensionless).\n- Treat the scattering self-energy self-consistently at each energy.\n- Use the following test suite. Each test case specifies $(E,\\varepsilon_0,\\Gamma_L,\\Gamma_R,D)$, all in eV, except $D$ which is in eV$^2$:\n  - Case 1 (ballistic resonance, symmetric contacts): $(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.000)$.\n  - Case 2 (weak elastic scattering at resonance): $(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.005)$.\n  - Case 3 (strong elastic scattering at resonance): $(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.080)$.\n  - Case 4 (off-resonance with moderate scattering): $(0.200,\\,0.000,\\,0.050,\\,0.050,\\,0.020)$.\n  - Case 5 (asymmetric contacts with moderate scattering): $(0.000,\\,0.000,\\,0.020,\\,0.080,\\,0.010)$.\n- Angle units do not apply in this problem.\n- Final output format: Your program should produce a single line of output containing all results concatenated into a flat list in the following order, with each numeric entry rounded to six decimal places:\n  - For Case 1: $[A(E_1), \\tau(E_1)\\,\\text{in fs}, T(E_1)]$\n  - For Case 2: $[A(E_2), \\tau(E_2)\\,\\text{in fs}, T(E_2)]$\n  - For Case 3: $[A(E_3), \\tau(E_3)\\,\\text{in fs}, T(E_3)]$\n  - For Case 4: $[A(E_4), \\tau(E_4)\\,\\text{in fs}, T(E_4)]$\n  - For Case 5: $[A(E_5), \\tau(E_5)\\,\\text{in fs}, T(E_5)]$\n- Therefore, the program must print a single line: a comma-separated list enclosed in square brackets with exactly fifteen floating-point numbers, ordered as $[A_1,\\tau_1,T_1,A_2,\\tau_2,T_2,\\dots,A_5,\\tau_5,T_5]$, where $A_i$ is in $\\text{eV}^{-1}$, $\\tau_i$ is in femtoseconds, and $T_i$ is dimensionless.",
            "solution": "To solve this problem, we first determine the self-consistent retarded Green's function, $G^r(E)$, which is central to the NEGF formalism. We then use this function to derive expressions for the spectral function $A(E)$, the finite lifetime $\\tau(E)$, and the transmission probability $T(E)$.\n\nThe retarded Green's function is defined by the equation:\n$$\nG^r(E) = \\left[E - \\varepsilon_0 - \\Sigma_L^r(E) - \\Sigma_R^r(E) - \\Sigma_s^r(E)\\right]^{-1}\n$$\nGiven the self-energies for the contacts in the wide-band limit, $\\Sigma_{L/R}^r = -i\\Gamma_{L/R}/2$, and the self-consistent Born approximation for scattering, $\\Sigma_s^r(E) = D \\cdot G^r(E)$, we can substitute them into the equation:\n$$\nG^r(E) = \\left[E - \\varepsilon_0 + i\\frac{\\Gamma_L}{2} + i\\frac{\\Gamma_R}{2} - D \\cdot G^r(E)\\right]^{-1}\n$$\nLet's define a complex energy term $E' = E - \\varepsilon_0 + i\\frac{\\Gamma_T}{2}$, where $\\Gamma_T = \\Gamma_L + \\Gamma_R$ is the total contact broadening. The equation becomes:\n$$\nG^r(E) = \\left[E' - D \\cdot G^r(E)\\right]^{-1}\n$$\nThis is a self-consistent equation for $G^r(E)$, which can be rearranged into a quadratic equation for $G^r \\equiv G^r(E)$:\n$$\nG^r (E' - D G^r) = 1 \\implies D (G^r)^2 - E' G^r + 1 = 0\n$$\nThe solutions for $G^r$ are given by the quadratic formula:\n$$\nG^r(E) = \\frac{E' \\pm \\sqrt{(E')^2 - 4D}}{2D}\n$$\nTo select the physically correct root, we consider the ballistic limit where the scattering strength $D \\to 0$. In this limit, the original equation gives $G^r = 1/E'$. The root with the minus sign in the numerator correctly recovers this limit, while the \"plus\" root diverges. Therefore, the physical solution is:\n$$\nG^r(E) = \\frac{E' - \\sqrt{(E')^2 - 4D}}{2D}\n$$\nThis choice also ensures that the spectral function remains non-negative, a fundamental physical requirement.\n\nWith the Green's function known, we can find the spectral function $A(E)$, which represents the density of states. It is defined as $A(E) = i(G^r(E) - G^a(E))$. Since the advanced Green's function is the complex conjugate of the retarded one, $G^a(E) = (G^r(E))^*$, the expression simplifies to:\n$$\nA(E) = i(G^r(E) - (G^r(E))^*) = i(2i \\cdot \\text{Im}[G^r(E)]) = -2 \\cdot \\text{Im}[G^r(E)]\n$$\nThe finite lifetime of the quantum state, $\\tau(E)$, is determined by the total broadening $\\Gamma_{tot}(E)$, which quantifies the rate of all escape processes (to contacts or via scattering). This broadening is related to the imaginary part of the total self-energy, $\\Sigma^r_{tot} = \\Sigma_L^r + \\Sigma_R^r + \\Sigma_s^r$.\n$$\n\\Gamma_{tot}(E) = -2 \\cdot \\text{Im}[\\Sigma^r_{tot}(E)] = -2 \\cdot \\text{Im}\\left[-i\\frac{\\Gamma_T}{2} + D \\cdot G^r(E)\\right] = \\Gamma_T - 2D \\cdot \\text{Im}[G^r(E)]\n$$\nUsing the relation $A(E) = -2\\text{Im}[G^r(E)]$, we arrive at the expression for the total broadening:\n$$\n\\Gamma_{tot}(E) = \\Gamma_L + \\Gamma_R + D \\cdot A(E)\n$$\nThe lifetime is then given by the Heisenberg uncertainty principle, $\\tau(E) = \\hbar / \\Gamma_{tot}(E)$.\n\nFinally, for a two-terminal device, the energy-resolved transmission coefficient $T(E)$ is given by the Fisher-Lee formula. In the NEGF formalism for a single-level system, this is $T(E) = \\operatorname{Tr}[\\mathbf{\\Gamma}_L(E) \\mathbf{G}^r(E) \\mathbf{\\Gamma}_R(E) \\mathbf{G}^a(E)]$. For our scalar case, with broadening functions $\\mathbf{\\Gamma}_\\alpha(E) = i(\\Sigma_\\alpha^r - \\Sigma_\\alpha^a) = \\Gamma_\\alpha$, this simplifies to:\n$$\nT(E) = \\Gamma_L G^r(E) \\Gamma_R G^a(E) = \\Gamma_L \\Gamma_R |G^r(E)|^2\n$$\nThis dimensionless quantity represents the probability for an electron at energy $E$ to transmit from the left contact to the right. These derived expressions for $A(E)$, $\\tau(E)$, and $T(E)$ are what need to be implemented numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the NEGF problem for a single-level quantum system with self-consistent scattering.\n    \"\"\"\n    # Define physical constants and test cases from the problem statement.\n    hbar = 6.582119569e-16  # eV*s\n    \n    # Test cases: (E, epsilon_0, Gamma_L, Gamma_R, D)\n    # Units: E, epsilon_0, Gamma_L, Gamma_R in eV; D in eV^2\n    test_cases = [\n        (0.000, 0.000, 0.050, 0.050, 0.000),  # Case 1: Ballistic resonance\n        (0.000, 0.000, 0.050, 0.050, 0.005),  # Case 2: Weak scattering\n        (0.000, 0.000, 0.050, 0.050, 0.080),  # Case 3: Strong scattering\n        (0.200, 0.000, 0.050, 0.050, 0.020),  # Case 4: Off-resonance\n        (0.000, 0.000, 0.020, 0.080, 0.010),  # Case 5: Asymmetric contacts\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, epsilon_0, Gamma_L, Gamma_R, D = case\n        \n        Gamma_T = Gamma_L + Gamma_R\n        \n        # Calculate the self-consistent retarded Green's function G^r(E)\n        if D == 0:\n            # Ballistic case (no scattering)\n            Gr = 1 / ((E - epsilon_0) + 1j * Gamma_T / 2)\n        else:\n            # Self-consistent Born approximation for scattering\n            # G^r solves the quadratic equation: D*(G^r)^2 - E_prime*G^r + 1 = 0\n            # E_prime = E - epsilon_0 + i*(Gamma_L + Gamma_R)/2\n            # The physical root is chosen to match the D - 0 limit.\n            E_prime = (E - epsilon_0) + 1j * Gamma_T / 2\n            # Use numpy for complex arithmetic, including square root\n            sqrt_term = np.sqrt(E_prime**2 - 4 * D)\n            Gr = (E_prime - sqrt_term) / (2 * D)\n\n        # 1. Calculate the spectral function A(E) in eV^-1\n        # A(E) = -2 * Im(G^r)\n        A_E = -2 * Gr.imag\n        \n        # 2. Calculate the lifetime tau(E) in femtoseconds\n        # Total broadening Gamma_tot = Gamma_L + Gamma_R + D*A(E)\n        Gamma_tot = Gamma_T + D * A_E\n        # Lifetime tau = hbar / Gamma_tot\n        tau_s = hbar / Gamma_tot\n        tau_fs = tau_s * 1e15\n        \n        # 3. Calculate the transmission T(E) (dimensionless)\n        # T(E) = Gamma_L * Gamma_R * |G^r|^2\n        T_E = Gamma_L * Gamma_R * (np.abs(Gr)**2)\n        \n        # Append results for the current case to the main list\n        results.extend([A_E, tau_fs, T_E])\n\n    # Format the final output as a single comma-separated list in brackets,\n    # with each number rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}