{
    "hands_on_practices": [
        {
            "introduction": "要理解纳米器件中的量子现象，我们必须首先确定空间限制如何改变允许的电子能态。这个基础练习  将经典的“箱中粒子”模型应用于薄硅膜，将其视为一个无限深势阱。通过求解薛定谔方程，您将直接计算出离散的能级子带以及由此产生的导带底能量抬升，这是量子限制的首要效应。",
            "id": "4158084",
            "problem": "一个绝缘体上硅（SOI）超薄体晶体管采用了一层厚度为 $t$ 的晶体硅薄膜，该薄膜沿 $(001)$ 方向取向，并在 $x$-$y$ 平面内横向延伸。为了将导带边的量子限制修正纳入与非平衡格林函数（NEGF）方法一起使用的量子输运哈密顿量中，我们使用有效质量近似来模拟沿限制方向 $z$ 的运动，该模型包含一个单一的导带谷，其特征是量子化方向的有效质量为 $m_{z}$。假设硅薄膜的上方和下方均为二氧化硅，并且二氧化硅的导带偏移足够大，以至于硅薄膜外部的势能在主导阶上可以被视为无限大。在薄膜内部，将势能参考点设置在体硅导带最小值处，因此势能为零。\n\n从限制方向上的一维有效质量薛定谔方程出发，并对宽度为 $t$ 的无限深势阱施加物理上适当的边界条件，推导出硅薄膜中的离散子带能量。利用这些结果，确定：\n\n1. 由量子限制引起的导带边向上移动的量，定义为最低占据电子子带相对于体硅导带最小值的能量。\n2. 同一谷中第一和第二子带之间的能量间距。\n\n将两个答案都用 $t$、$m_{z}$ 和基本常数符号表示，并以焦耳为单位给出解析表达式。请勿进行数值计算。",
            "solution": "所述问题是有效的。这是一个在初等量子力学应用于半导体物理学领域中，具有科学依据、提法恰当且客观的问题。诸如无限深势阱和单带有效质量近似等理想化处理，是用于对薄膜中量子限制效应进行一阶分析的标准且适当的方法。因此，我们可以进行完整求解。\n\n该问题要求我们求解限制在一维势阱中电子的量子化能级，该模型模拟了薄硅薄膜。电子在限制方向（指定为 $z$ 方向）上的运动由一维不含时有效质量薛定谔方程描述：\n$$\n-\\frac{\\hbar^2}{2m_{z}} \\frac{d^2\\psi(z)}{dz^2} + V(z)\\psi(z) = E \\psi(z)\n$$\n此处，$\\psi(z)$ 是电子波函数，$E$ 是能量本征值，$\\hbar$ 是约化普朗克常数，$m_{z}$ 是电子沿 $z$ 方向运动的有效质量。\n\n问题指明硅薄膜的厚度为 $t$。我们可以定义空间坐标，使得薄膜占据区域 $0  z  t$。薄膜内部的势能 $V(z)$ 被设为零，以体硅导带最小值为能量参考点。薄膜外部的势能被假设为无限大，这模拟了硅与二氧化硅之间巨大的导带偏移。因此，势能分布是一个无限深方势阱：\n$$\nV(z) = \\begin{cases} 0  \\text{for } 0  z  t \\\\ \\infty  \\text{for } z \\le 0 \\text{ and } z \\ge t \\end{cases}\n$$\n在势阱内部，其中 $V(z) = 0$，薛定谔方程简化为：\n$$\n-\\frac{\\hbar^2}{2m_{z}} \\frac{d^2\\psi(z)}{dz^2} = E \\psi(z)\n$$\n这可以被重排为标准的二阶线性齐次微分方程形式：\n$$\n\\frac{d^2\\psi(z)}{dz^2} + \\frac{2m_{z}E}{\\hbar^2}\\psi(z) = 0\n$$\n我们定义波数 $k$ 为 $k = \\sqrt{\\frac{2m_{z}E}{\\hbar^2}}$。由于 $m_z$ 是正的，且我们正在寻找 $E > 0$ 的束缚态，因此 $k$ 是实数且为正。方程变为：\n$$\n\\frac{d^2\\psi(z)}{dz^2} + k^2\\psi(z) = 0\n$$\n该方程的通解是正弦和余弦函数的线性组合：\n$$\n\\psi(z) = A \\sin(kz) + B \\cos(kz)\n$$\n其中 $A$ 和 $B$ 是常数。\n\n为了找到特解，我们必须应用边界条件。无限势垒意味着在势阱外找到粒子的概率为零。为了使波函数连续，它在势阱的边界处必须为零。\n第一个边界条件在 $z=0$ 处：\n$$\n\\psi(0) = 0 \\implies A \\sin(k \\cdot 0) + B \\cos(k \\cdot 0) = B \\cdot 1 = 0\n$$\n这意味着 $B=0$。因此，波函数简化为以下形式：\n$$\n\\psi(z) = A \\sin(kz)\n$$\n第二个边界条件在 $z=t$ 处：\n$$\n\\psi(t) = 0 \\implies A \\sin(kt) = 0\n$$\n对于非平庸解（即粒子存在），常数 $A$ 不能为零。因此，我们必须有：\n$$\n\\sin(kt) = 0\n$$\n只有当正弦函数的自变量是 $\\pi$ 的整数倍时，此条件才满足。\n$$\nkt = n\\pi, \\quad \\text{其中 } n \\text{ 是一个整数。}\n$$\n$n=0$ 的情况会导致 $k=0$，从而对所有 $z$ 都有 $\\psi(z)=0$，这对应于没有粒子。$n$ 取负整数不会产生物理上新的解，因为 $\\sin(-x) = -\\sin(x)$，这只会改变波函数的整体符号，而这是一个物理上无关的相位。因此，我们只考虑量子数 $n$ 的正整数值：\n$$\nn = 1, 2, 3, \\ldots\n$$\n从这个量子化条件，我们找到了波数 $k_n$ 的离散允许值：\n$$\nk_n = \\frac{n\\pi}{t}\n$$\n将此代入 $k$ 的定义 $k^2 = \\frac{2m_{z}E}{\\hbar^2}$，我们可以解出允许的能量本征值 $E_n$，即离散子带的能量：\n$$\n\\left(\\frac{n\\pi}{t}\\right)^2 = \\frac{2m_{z}E_n}{\\hbar^2}\n$$\n解出 $E_n$ 得：\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\n\n有了这个子带能量的通式，我们现在可以回答提出的两个具体问题。\n\n1. 导带边的向上移动量定义为最低占据电子子带相对于体硅导带最小值（即我们的 $E=0$ 参考点）的能量。这是系统的基态能量，对应于最低的可能量子数 $n=1$。\n$$\nE_1 = \\frac{(1)^2 \\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{\\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\n这个能量 $E_1$ 也被称为受限电子的零点能。\n\n2. 第一和第二子带之间的能量间距是它们各自能量本征值 $E_2$ 和 $E_1$ 之间的差值。第二子带的能量对应于量子数 $n=2$。\n$$\nE_2 = \\frac{(2)^2 \\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{4 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\n能量间距 $\\Delta E_{21}$ 是：\n$$\n\\Delta E_{21} = E_2 - E_1 = \\frac{4 \\pi^2 \\hbar^2}{2 m_{z} t^2} - \\frac{\\pi^2 \\hbar^2}{2 m_{z} t^2} = \\frac{3 \\pi^2 \\hbar^2}{2 m_{z} t^2}\n$$\n这些表达式是用给定的参数（$t$、$m_{z}$）和基本常数（$\\pi$、$\\hbar$）表示的，并且单位是能量（在国际单位制中是焦耳），符合要求。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\pi^2 \\hbar^2}{2 m_z t^2}  \\frac{3 \\pi^2 \\hbar^2}{2 m_z t^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在能量量化概念的基础上，本练习  进一步探讨了圆柱形纳米线中子带的完整能量-动量 ($E(k)$) 关系，即色散关系。您将首先解析推导出色散关系，然后通过编程实现数值计算，以验证固态物理学的一个基石原理：能带的曲率定义了电子的有效质量。这个练习将量子力学求解与输运模型中使用的参数联系起来。",
            "id": "4158063",
            "problem": "考虑一个沿 $z$ 轴排列的圆柱形硅纳米线，其半径为 $R$。假设与纳米线轴向对齐的导带谷具有各向异性有效质量：沿 $z$ 轴的纵向质量为 $m_{\\ell}$，径向平面内的横向质量为 $m_{t}$。在有效质量近似（EMA）下，单电子包络函数满足具有硬壁（无限势垒）限制（位于 $r=R$）的定态薛定谔方程。在圆柱坐标系 $(r,\\theta,z)$ 中，横向模式与沿 $z$ 轴的纵向运动是分离的。横向本征函数是第一类贝塞尔函数 $J_{m}(x)$，由整数角动量 $m \\in \\mathbb{Z}$ 索引，其径向量子化由 $J_{m}(x)$ 的零点 $\\alpha_{m,p}$ 决定，其中 $p \\in \\mathbb{N}$ 按升序枚举根。在 EMA 框架内，纵向运动沿 $z$ 轴是自由的。\n\n仅从以下基本原理出发：\n- 在硬壁限制下，对圆柱坐标系中的薛定谔方程进行变量分离。\n- 贝塞尔函数 $J_{m}(x)$ 及其零点 $\\alpha_{m,p}$ 的性质。\n- 在 EMA 下，自由粒子沿输运方向的抛物线色散关系。\n\n您的任务是：\n1. 推导模式 $(m,p)$ 的横向量子化能量 $E_{m,p}^{\\mathrm{trans}}$ 以及沿 $z$ 轴的波矢为 $k$ 的纵向色散关系 $E(k)$。\n2. 展示 $E(k)$ 在 $k=0$ 处的曲率如何与纵向有效质量 $m_{\\ell}$ 相关。\n3. 实现一个程序，为每个指定的测试用例计算：\n   - 横向量子化能量 $E_{m,p}^{\\mathrm{trans}}$，单位为电子伏特（eV）。\n   - 从 $k=0$ 附近的色散曲率推断出的纵向有效质量，表示为与自由电子质量 $m_0$ 的比值，即 $m_{\\mathrm{eff}}/m_{0}$。\n   使用对称二阶有限差分法，以步长 $h$（单位为米分之一，m$^{-1}$）估算 $k=0$ 处的曲率。色散关系必须使用推导出的表达式，基于 EMA 的第一性原理构建。\n\n需使用的假设和常数：\n- 使用 $m_{0} = 9.1093837015 \\times 10^{-31}$ 千克。\n- 使用约化普朗克常数 $\\,\\hbar = 1.054571817 \\times 10^{-34}$ 焦耳·秒。\n- 使用 $q = 1.602176634 \\times 10^{-19}$ 焦耳/电子伏特进行单位换算。\n- 贝塞尔零点 $\\alpha_{m,p}$ 是无量纲的，必须使用标准的特殊函数例程进行高精度数值计算。\n- 纳米线在 $r=R$ 处具有无限势垒（狄利克雷边界）。\n\n单位规范：\n- 以电子伏特（eV）报告 $E_{m,p}^{\\mathrm{trans}}$，四舍五入到三位小数。\n- 以小数形式报告 $m_{\\mathrm{eff}}/m_{0}$，四舍五入到六位小数。\n- 波矢 $k$ 和差分步长 $h$ 都必须解释为米分之一（m$^{-1}$）。\n- 半径 $R$ 以纳米（nm）为单位给出，必须转换为米。\n\n测试套件（每个用例是一个元组 $(R_{\\mathrm{nm}}, m, p, m_{\\ell}/m_{0}, m_{t}/m_{0}, h)$）：\n- 用例 1: $(3.0, 0, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- 用例 2: $(5.0, 1, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- 用例 3: $(20.0, 0, 1, 0.916, 0.19, 1.0 \\times 10^{7})$\n- 用例 4: $(1.5, 0, 2, 0.916, 0.19, 1.0 \\times 10^{7})$\n\n算法要求：\n- 对于每个用例，计算 $J_{m}(x)$ 的前 $p$ 个零点，并选择 $\\alpha_{m,p}$。\n- 使用推导的表达式计算横向能量 $E_{m,p}^{\\mathrm{trans}}$（单位为焦耳），然后转换为电子伏特。\n- 使用 EMA 表达式构建 $k=0$ 附近的纵向色散关系，并在 $k=-h, 0, +h$ 处评估 $E(k)$，通过对称二阶有限差分法数值估算 $k=0$ 处的二阶导数。\n- 从曲率推断 $m_{\\mathrm{eff}}$，并计算比值 $m_{\\mathrm{eff}}/m_{0}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试套件的所有结果，形式为逗号分隔的扁平列表，并用方括号括起来。条目按测试用例排序，在每个用例中，按 $\\left[E_{m,p}^{\\mathrm{trans}}\\,\\text{(eV)},\\, m_{\\mathrm{eff}}/m_{0}\\right]$ 的顺序排列。例如，总输出应采用以下形式：\n$$\\left[E_{\\text{用例 1}},\\,\\left(\\frac{m_{\\mathrm{eff}}}{m_{0}}\\right)_{\\text{用例 1}},\\,E_{\\text{用例 2}},\\,\\left(\\frac{m_{\\mathrm{eff}}}{m_{0}}\\right)_{\\text{用例 2}},\\,\\ldots\\right].$$\n\n背景说明：\n- 尽管使用非平衡格林函数（NEGF）的更广泛的量子输运框架会利用这些子带色散来构建沿 $z$ 轴输运的哈密顿量和自能，但本问题侧重于通过 EMA 建立子带色散，并通过曲率验证有效质量关系。请确保所有计算的物理真实性和数值稳定性。",
            "solution": "用户提供的问题是有效的。它在科学上基于量子力学的有效质量近似原理，问题设定清晰，目标明确，数据充分，并以精确、客观的语言表述。我现在将着手解决该问题。\n\n该问题要求推导圆柱形硅纳米线中电子的能量色散关系，然后通过数值实现来计算特定的物理量。\n\n出发点是有效质量近似（EMA）下的定态薛定谔方程。对于一个半径为 $R$、沿 $z$ 轴排列且具有各向异性有效质量张量（沿 $z$ 轴的纵向质量为 $m_{\\ell}$，在xy平面内的横向质量为 $m_{t}$）的圆柱形纳米线，其哈密顿量 $H$ 由下式给出：\n$$ H = -\\frac{\\hbar^2}{2m_t} \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} \\right) - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} $$\n在圆柱坐标系 $(r, \\theta, z)$ 中，拉普拉斯算子的横向部分是 $\\nabla^2_{r,\\theta} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\theta^2}$。哈密顿量变为：\n$$ H = -\\frac{\\hbar^2}{2m_t} \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\theta^2} \\right] - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} $$\n包络函数 $\\Psi(r, \\theta, z)$ 必须满足薛定谔方程 $H \\Psi = E \\Psi$，并带有硬壁边界条件 $\\Psi(R, \\theta, z) = 0$。\n\n我们使用变量分离法。鉴于沿 $z$ 轴的平移对称性，波函数可以写成横向部分 $F(r, \\theta)$ 和纵向平面波 $\\phi(z) = e^{ikz}$ 的乘积，其中 $k$ 是沿 $z$ 方向的波矢：\n$$ \\Psi(r, \\theta, z) = F(r, \\theta) e^{ikz} $$\n将此代入薛定谔方程：\n$$ \\left( -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} - \\frac{\\hbar^2}{2m_\\ell} \\frac{\\partial^2}{\\partial z^2} \\right) F(r,\\theta)e^{ikz} = E F(r,\\theta)e^{ikz} $$\n$z$ 方向求导的作用是 $\\frac{\\partial^2}{\\partial z^2} e^{ikz} = -k^2 e^{ikz}$。方程简化为：\n$$ \\left( -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} F(r,\\theta) \\right) + \\frac{\\hbar^2 k^2}{2m_\\ell} F(r, \\theta) = E F(r, \\theta) $$\n该方程表明，总能量 $E$ 是横向能量分量（取决于 $(r, \\theta)$ 平面内的量子化）和纵向动能分量之和。我们可以写出 $E(k) = E^{\\mathrm{trans}} + E^{\\mathrm{long}}(k)$，其中纵向色散关系为：\n$$ E^{\\mathrm{long}}(k) = \\frac{\\hbar^2 k^2}{2m_\\ell} $$\n波函数的横向部分 $F(r, \\theta)$ 必须满足其自身的本征值方程：\n$$ -\\frac{\\hbar^2}{2m_t} \\nabla^2_{r,\\theta} F(r, \\theta) = E^{\\mathrm{trans}} F(r, \\theta) $$\n我们再次对横向函数 $F(r, \\theta) = \\mathcal{R}(r)\\Theta(\\theta)$ 应用变量分离法。将其代入横向方程得到：\n$$ -\\frac{\\hbar^2}{2m_t} \\left[ \\frac{\\Theta(\\theta)}{r}\\frac{d}{dr}\\left(r\\frac{d\\mathcal{R}}{dr}\\right) + \\frac{\\mathcal{R}(r)}{r^2}\\frac{d^2\\Theta}{d\\theta^2} \\right] = E^{\\mathrm{trans}} \\mathcal{R}(r)\\Theta(\\theta) $$\n两边乘以 $\\frac{r^2}{\\mathcal{R}(r)\\Theta(\\theta)}$ 并重新整理各项，可将依赖于 $r$ 的部分和依赖于 $\\theta$ 的部分分离开来：\n$$ \\frac{r}{\\mathcal{R}}\\frac{d}{dr}\\left(r\\frac{d\\mathcal{R}}{dr}\\right) + \\frac{2m_t E^{\\mathrm{trans}} r^2}{\\hbar^2} = -\\frac{1}{\\Theta}\\frac{d^2\\Theta}{d\\theta^2} $$\n由于左侧仅依赖于 $r$，右侧仅依赖于 $\\theta$，因此两边都必须等于一个常数。设此常数为 $m^2$。角向方程为 $\\frac{d^2\\Theta}{d\\theta^2} = -m^2 \\Theta$，其解为 $\\Theta(\\theta) = e^{im\\theta}$。为使波函数是单值的，$\\Theta(\\theta+2\\pi) = \\Theta(\\theta)$，这要求 $m$ 是一个整数，即 $m \\in \\mathbb{Z}$。\n\n那么径向方程为：\n$$ r^2 \\frac{d^2\\mathcal{R}}{dr^2} + r\\frac{d\\mathcal{R}}{dr} + \\left( \\frac{2m_t E^{\\mathrm{trans}}}{\\hbar^2} r^2 - m^2 \\right) \\mathcal{R} = 0 $$\n我们定义一个常数 $K^2 = \\frac{2m_t E^{\\mathrm{trans}}}{\\hbar^2}$。方程变为：\n$$ r^2 \\mathcal{R}'' + r \\mathcal{R}' + (K^2 r^2 - m^2)\\mathcal{R} = 0 $$\n这是贝塞尔微分方程。其通解是第一类贝塞尔函数 $J_m(Kr)$ 和第二类贝塞尔函数 $Y_m(Kr)$ 的线性组合。由于波函数在原点 $r=0$ 处必须是有限的，而 $Y_m(x)$ 在 $x \\to 0$ 时发散，因此我们必须舍弃 $Y_m$ 解。径向部分的物理意义解是 $\\mathcal{R}(r) = A J_m(Kr)$，其中 $A$ 是一个归一化常数。\n\n纳米线表面的硬壁边界条件要求 $\\mathcal{R}(R)=0$。这等价于：\n$$ J_m(KR) = 0 $$\n这个条件对 $K$ 的可能取值进行了量子化。自变量 $KR$ 必须是贝塞尔函数 $J_m(x)$ 的一个零点。设 $\\alpha_{m,p}$ 表示 $J_m(x)$ 的第 $p$ 个正零点，其中 $p \\in \\mathbb{N}$ ($p=1, 2, 3, \\ldots$) 是径向量子数。因此，对于每个模式 $(m,p)$：\n$$ K_{m,p} R = \\alpha_{m,p} \\implies K_{m,p} = \\frac{\\alpha_{m,p}}{R} $$\n代入 $K_{m,p}$ 的定义，我们可以解出横向量子化能量 $E_{m,p}^{\\mathrm{trans}}$：\n$$ \\left(\\frac{\\alpha_{m,p}}{R}\\right)^2 = \\frac{2m_t E_{m,p}^{\\mathrm{trans}}}{\\hbar^2} $$\n$$ E_{m,p}^{\\mathrm{trans}} = \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} $$\n这就是由 $(m,p)$ 索引的子带的横向量子化能量的推导表达式。\n\n子带 $(m,p)$ 的总能量色散关系结合了横向和纵向部分：\n$$ E_{m,p}(k) = E_{m,p}^{\\mathrm{trans}} + E^{\\mathrm{long}}(k) = \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} + \\frac{\\hbar^2 k^2}{2m_\\ell} $$\n\n接下来，我们将此色散关系的曲率与有效质量关联起来。载流子的有效质量 $m_{\\mathrm{eff}}$ 由其能带 $E(k)$ 的曲率定义为：\n$$ \\frac{1}{m_{\\mathrm{eff}}} = \\frac{1}{\\hbar^2} \\frac{d^2E(k)}{dk^2} $$\n对于我们推导出的纵向色散关系 $E_{m,p}(k)$，其关于 $k$ 的二阶导数为：\n$$ \\frac{dE_{m,p}(k)}{dk} = \\frac{d}{dk} \\left( \\frac{\\hbar^2 \\alpha_{m,p}^2}{2 m_t R^2} + \\frac{\\hbar^2 k^2}{2m_\\ell} \\right) = \\frac{\\hbar^2 k}{m_\\ell} $$\n$$ \\frac{d^2E_{m,p}(k)}{dk^2} = \\frac{\\hbar^2}{m_\\ell} $$\n这个曲率对于所有 $k$（包括 $k=0$）都是恒定的。将其代入有效质量的定义中：\n$$ \\frac{1}{m_{\\mathrm{eff}}} = \\frac{1}{\\hbar^2} \\left( \\frac{\\hbar^2}{m_\\ell} \\right) = \\frac{1}{m_\\ell} $$\n$$ m_{\\mathrm{eff}} = m_\\ell $$\n这证实了从抛物线色散关系的曲率中提取的有效质量与初始哈密顿量中使用的纵向质量 $m_\\ell$ 是相同的。\n\n数值实现将使用其推导公式计算 $E_{m,p}^{\\mathrm{trans}}$。然后，它将使用对称二阶有限差分公式数值估算曲率 $\\frac{d^2E}{dk^2}$：\n$$ \\left. \\frac{d^2E}{dk^2} \\right|_{k=0} \\approx \\frac{E(h) - 2E(0) + E(-h)}{h^2} $$\n其中 $h$ 是波矢的一个小步长。数值确定的有效质量则为 $m_{\\mathrm{eff, num}} = \\hbar^2 / \\left( \\frac{d^2E}{dk^2} \\right)_{\\mathrm{num}}$。如解析所示，对于一个完美的抛物线能带，此数值过程应能高精度地恢复 $m_\\ell$，其精度仅受浮点精度的限制。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn_zeros\n\ndef solve():\n    \"\"\"\n    Computes transverse quantization energy and longitudinal effective mass\n    for an electron in a cylindrical silicon nanowire for a given set of\n    test cases.\n    \"\"\"\n    # Physical constants in SI units\n    m0 = 9.1093837015e-31   # Free electron mass in kg\n    hbar = 1.054571817e-34  # Reduced Planck constant in J·s\n    q = 1.602176634e-19     # Elementary charge in C (for J to eV conversion)\n\n    # Test suite: (R in nm, m, p, m_l/m_0, m_t/m_0, h in m^-1)\n    test_cases = [\n        (3.0, 0, 1, 0.916, 0.19, 1.0e7),\n        (5.0, 1, 1, 0.916, 0.19, 1.0e7),\n        (20.0, 0, 1, 0.916, 0.19, 1.0e7),\n        (1.5, 0, 2, 0.916, 0.19, 1.0e7),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_nm, m, p, ml_ratio, mt_ratio, h = case\n\n        # Convert input parameters to SI units\n        R = R_nm * 1e-9      # Radius in meters\n        ml = ml_ratio * m0   # Longitudinal effective mass in kg\n        mt = mt_ratio * m0   # Transverse effective mass in kg\n\n        # --- Task 1: Compute transverse quantization energy E_trans ---\n\n        # Find the p-th positive zero of the m-th order Bessel function of the first kind.\n        # scipy.special.jn_zeros(m, p) returns the first p zeros; we need the p-th one.\n        alpha_mp = jn_zeros(m, p)[p-1]\n\n        # Calculate E_trans in Joules using the derived formula:\n        # E_trans = (hbar^2 * alpha_mp^2) / (2 * mt * R^2)\n        E_trans_J = (hbar**2 * alpha_mp**2) / (2 * mt * R**2)\n\n        # Convert E_trans to electronvolts (eV) and round to three decimal places.\n        E_trans_eV = round(E_trans_J / q, 3)\n        \n        # --- Task 2: Compute effective mass from dispersion curvature ---\n\n        # Define the total energy dispersion function E(k) for the given subband.\n        # E(k) = E_trans + E_long(k) = E_trans + (hbar^2 * k^2) / (2 * ml)\n        def E_dispersion(k_val):\n            return E_trans_J + (hbar**2 * k_val**2) / (2 * ml)\n\n        # Evaluate E(k) at k = -h, 0, +h for the finite difference calculation.\n        E_plus_h = E_dispersion(h)\n        E_zero = E_dispersion(0)\n        E_minus_h = E_dispersion(-h)\n        \n        # Calculate the second derivative (curvature) at k=0 using the\n        # symmetric second-order finite difference formula.\n        # curvature = (E(h) - 2*E(0) + E(-h)) / h^2\n        curvature = (E_plus_h - 2 * E_zero + E_minus_h) / h**2\n\n        # Infer the effective mass from the curvature using the definition:\n        # 1/m_eff = (1/hbar^2) * d^2E/dk^2 = m_eff = hbar^2 / curvature\n        # This numerical test should recover the input m_l due to the parabolic dispersion.\n        m_eff = hbar**2 / curvature\n\n        # Calculate the ratio m_eff/m_0 and round to six decimal places.\n        m_eff_ratio = round(m_eff / m0, 6)\n\n        # Append the calculated results for the current case.\n        results.append(E_trans_eV)\n        results.append(m_eff_ratio)\n\n    # Print the final result as a single line, with values formatted as a\n    # comma-separated flat list enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在建立了量化的能量结构之后，下一步是模拟通过它的电荷输运。本练习  引入了强大的非平衡格林函数（NEGF）方法来分析一个代表受限量子态的单能级系统。您将通过实现一个自洽的散射处理来计算关键的输运指标，如谱函数、载流子寿命和透射率，从而揭示无序如何从根本上影响量子电导。",
            "id": "4158081",
            "problem": "考虑一个在非平衡格林函数（NEGF）框架下与两个电极耦合的单能级量子限制区域（由于限制效应和激活的掺杂剂而产生的有效共振态）。该单能级具有在位能 $\\,\\varepsilon_0\\,$，并分别以与能量无关的展宽（宽带极限）$\\,\\Gamma_L\\,$ 和 $\\,\\Gamma_R\\,$ 与左右电极耦合。该器件由于与激活的掺杂剂相关的短程无序而经历弹性的局域散射，该散射通过一个标量散射强度为 $\\,D\\,$ 的自洽玻恩近似来建模。所有能量都必须以电子伏特（eV）为单位处理。\n\n从基本的 NEGF 定义出发：\n- 推迟格林函数定义为 $\\,G^r(E) = \\big[E - \\varepsilon_0 - \\Sigma_L^r(E) - \\Sigma_R^r(E) - \\Sigma_s^r(E)\\big]^{-1}\\,$。\n- 在宽带极限下，电极自能是纯虚数且与能量无关，对于 $\\alpha \\in \\{L,R\\}$，有 $\\,\\Sigma_{\\alpha}^r(E) = -\\dfrac{i}{2}\\,\\Gamma_{\\alpha}\\,$。\n- 谱函数为 $\\,A(E) = i\\big(G^r(E) - G^a(E)\\big)\\,$。\n- 总展宽通过 NEGF 恒等式与谱函数和推迟函数相关联。\n\n假设散射自能 $\\,\\Sigma_s^r(E)\\,$ 采用弹性的、局域的自洽玻恩近似形式，与推迟格林函数 $\\,G^r(E)\\,$ 成正比，比例因子为标量 $\\,D\\,$，该因子编码了掺杂剂引起的无序的散射强度。此自能必须与 $\\,G^r(E)\\,$ 进行自洽处理。通过总展宽和普朗克常数除以 $2\\pi$（约化普朗克常数）$\\,\\hbar\\,$ 来定义能量分辨的有限寿命 $\\,\\tau(E)\\,$，并将寿命以飞秒表示。使用 $\\,\\hbar = 6.582119569\\times 10^{-16}\\,$ eV·s，并记住 $\\,1\\,$ 飞秒 $= 10^{-15}\\,$ 秒。\n\n你的任务是：\n1. 从上述基本定义出发，展示弹性散射的自洽处理如何修改谱函数 $\\,A(E)\\,$ 并产生一个有限的能量分辨寿命 $\\,\\tau(E)\\,$，用总展宽表示。\n2. 在左右电极处于相同电化学势（线性响应）的情况下，利用在弹性、电流守恒散射存在时已成熟的 NEGF 表达式，量化所产生的两端输运透射率 $\\,T(E)\\,$。\n\n数值计算要求：\n- 实现一个程序，为每个指定的测试用例计算：\n  - 谱函数值 $\\,A(E)\\,$，单位为 $\\,\\text{eV}^{-1}$。\n  - 寿命 $\\,\\tau(E)\\,$，单位为飞秒。\n  - 透射率 $\\,T(E)\\,$（无量纲）。\n- 在每个能量点上自洽地处理散射自能。\n- 使用以下测试套件。每个测试用例指定 $(E,\\varepsilon_0,\\Gamma_L,\\Gamma_R,D)$，所有单位均为 eV，除了 D 的单位是 eV$^2$：\n  - 用例 1（弹道共振，对称电极）：$(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.000)$。\n  - 用例 2（共振时的弱弹性散射）：$(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.005)$。\n  - 用例 3（共振时的强弹性散射）：$(0.000,\\,0.000,\\,0.050,\\,0.050,\\,0.080)$。\n  - 用例 4（偏离共振且有中等散射）：$(0.200,\\,0.000,\\,0.050,\\,0.050,\\,0.020)$。\n  - 用例 5（非对称电极且有中等散射）：$(0.000,\\,0.000,\\,0.020,\\,0.080,\\,0.010)$。\n- 角度单位不适用于此问题。\n- 最终输出格式：你的程序应生成单行输出，包含所有结果按以下顺序连接成一个扁平列表，每个数值条目四舍五入到六位小数：\n  - 用例 1：$[A(E_1), \\tau(E_1)\\,\\text{in fs}, T(E_1)]$\n  - 用例 2：$[A(E_2), \\tau(E_2)\\,\\text{in fs}, T(E_2)]$\n  - 用例 3：$[A(E_3), \\tau(E_3)\\,\\text{in fs}, T(E_3)]$\n  - 用例 4：$[A(E_4), \\tau(E_4)\\,\\text{in fs}, T(E_4)]$\n  - 用例 5：$[A(E_5), \\tau(E_5)\\,\\text{in fs}, T(E_5)]$\n- 因此，程序必须打印单行：一个用方括号括起来的逗号分隔列表，包含十五个浮点数，顺序为 $[A_1,\\tau_1,T_1,A_2,\\tau_2,T_2,\\dots,A_5,\\tau_5,T_5]$，其中 $A_i$ 的单位是 $\\text{eV}^{-1}$，$\\tau_i$ 的单位是飞秒，$T_i$ 是无量纲的。",
            "solution": "该问题被评估为具有科学依据、提法恰当且内部一致。它基于非平衡格林函数（NEGF）框架下量子输运理论的标准、无争议的原则。所提供的数据和参数是完整且充分的，足以推导出一个唯一的、有意义的解。\n\n### 第1步：提取已知条件\n\n- **推迟格林函数的基本方程：** $G^r(E) = \\big[E - \\varepsilon_0 - \\Sigma_L^r(E) - \\Sigma_R^r(E) - \\Sigma_s^r(E)\\big]^{-1}$\n- **系统：** 一个在位能为 $\\varepsilon_0$ 的单量子能级。\n- **电极自能（宽带极限）：** 对于电极 $\\alpha \\in \\{L,R\\}$，有 $\\Sigma_{\\alpha}^r(E) = -\\dfrac{i}{2}\\Gamma_{\\alpha}$，其中 $\\Gamma_L$ 和 $\\Gamma_R$ 是与能量无关的展宽。\n- **散射自能（自洽玻恩近似）：** $\\Sigma_s^r(E) = D \\cdot G^r(E)$，这是一个自洽关系，其中 $D$ 是标量散射强度。\n- **谱函数定义：** $A(E) = i\\big(G^r(E) - G^a(E)\\big)$，其中 $G^a(E) = (G^r(E))^*$。\n- **寿命定义：** $\\tau(E) = \\hbar / \\Gamma_{tot}(E)$，其中 $\\Gamma_{tot}(E)$ 是总展宽。\n- **物理常数：** 约化普朗克常数，$\\hbar = 6.582119569\\times 10^{-16}\\,$ eV·s。\n- **单位换算：** $1\\,$ 飞秒 $= 10^{-15}\\,$ 秒。\n- **测试用例：**\n  1. $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D) = (0.000\\,\\text{eV}, 0.000\\,\\text{eV}, 0.050\\,\\text{eV}, 0.050\\,\\text{eV}, 0.000\\,\\text{eV}^2)$\n  2. $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D) = (0.000\\,\\text{eV}, 0.000\\,\\text{eV}, 0.050\\,\\text{eV}, 0.050\\,\\text{eV}, 0.005\\,\\text{eV}^2)$\n  3. $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D) = (0.000\\,\\text{eV}, 0.000\\,\\text{eV}, 0.050\\,\\text{eV}, 0.050\\,\\text{eV}, 0.080\\,\\text{eV}^2)$\n  4. $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D) = (0.200\\,\\text{eV}, 0.000\\,\\text{eV}, 0.050\\,\\text{eV}, 0.050\\,\\text{eV}, 0.020\\,\\text{eV}^2)$\n  5. $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D) = (0.000\\,\\text{eV}, 0.000\\,\\text{eV}, 0.020\\,\\text{eV}, 0.080\\,\\text{eV}, 0.010\\,\\text{eV}^2)$\n\n### 第2步：使用提取的已知条件进行验证\n\n该问题是**有效的**。\n- **科学依据：** 整个表述基于 NEGF 形式主义，这是现代量子输运理论的基石。宽带近似和自洽玻恩近似分别是用于电极和无序的标准、成熟模型。\n- **提法恰当：** 该问题提供了一套完整的参数和定义，导出一个可以求解出唯一物理意义解（对于所求量 $A(E)$、$\\tau(E)$、$T(E)$）的方程组。\n- **客观性：** 问题采用精确的数学语言和客观的物理概念表述，不含任何主观或推测性元素。\n- **完整性与一致性：** 所有必要的常数、参数和函数形式（$\\Sigma^r$，$A(E)$）都已提供。单位是一致的；对于 $\\Sigma_s^r = D G^r$，单位为 $[\\text{eV}]=[\\text{eV}^2][\\text{eV}^{-1}]$，这是正确的。\n\n### 第3步：推导与求解\n\n求解过程首先确定自洽推迟格林函数 $G^r(E)$，然后用它计算谱函数 $A(E)$、寿命 $\\tau(E)$ 和透射率 $T(E)$。\n\n#### 1. 自洽推迟格林函数, $G^r(E)$\n\n我们从 $G^r(E)$ 的定义方程开始：\n$$\nG^r(E) = \\left[E - \\varepsilon_0 - \\Sigma_L^r(E) - \\Sigma_R^r(E) - \\Sigma_s^r(E)\\right]^{-1}\n$$\n代入给定的自能：$\\Sigma_{L/R}^r = -i\\Gamma_{L/R}/2$ 和 $\\Sigma_s^r(E) = D \\cdot G^r(E)$。\n$$\nG^r(E) = \\left[E - \\varepsilon_0 - \\left(-i\\frac{\\Gamma_L}{2}\\right) - \\left(-i\\frac{\\Gamma_R}{2}\\right) - D \\cdot G^r(E)\\right]^{-1}\n$$\n我们定义一个复数能量项 $E' = E - \\varepsilon_0 + i\\frac{\\Gamma_T}{2}$，其中 $\\Gamma_T = \\Gamma_L + \\Gamma_R$ 是总电极展宽。方程变为：\n$$\nG^r(E) = \\left[E' - D \\cdot G^r(E)\\right]^{-1}\n$$\n这是一个关于 $G^r(E)$ 的自洽方程。重新整理得到一个关于 $G^r \\equiv G^r(E)$ 的二次方程：\n$$\nG^r (E' - D G^r) = 1\n$$\n$$\nD (G^r)^2 - E' G^r + 1 = 0\n$$\n$G^r$ 的解由二次公式给出：\n$$\nG^r(E) = \\frac{E' \\pm \\sqrt{(E')^2 - 4D}}{2D}\n$$\n为了选择物理上正确的根，我们考虑弹道极限，即 $D \\to 0$。在此极限下，方程简化为 $-E'G^r + 1 = 0$，得到 $G^r = 1/E'$。对平方根使用泰勒展开，$\\sqrt{(E')^2 - 4D} \\approx E' - 2D/E'$，“正”根在 $D \\to 0$ 时发散，而“负”根正确地恢复了弹道结果：$G^r \\approx (E' - (E' - 2D/E'))/(2D) = (2D/E')/(2D) = 1/E'$。因此，我们必须选择负号。\n$$\nG^r(E) = \\frac{E' - \\sqrt{(E')^2 - 4D}}{2D}\n$$\n这个选择也确保了谱函数 $A(E) = -2\\text{Im}[G^r(E)]$ 是非负的，这是一个基本的物理要求。\n\n#### 2. 谱函数, $A(E)$\n\n谱函数代表态密度。它定义为 $A(E) = i(G^r(E) - G^a(E))$。由于超前格林函数是推迟格林函数的复共轭，$G^a(E) = (G^r(E))^*$，表达式简化为：\n$$\nA(E) = i(G^r(E) - (G^r(E))^*) = i(2i \\cdot \\text{Im}[G^r(E)]) = -2 \\cdot \\text{Im}[G^r(E)]\n$$\n在计算上，我们首先使用自洽公式计算 $G^r(E)$ 的复数值，然后求其虚部来确定 $A(E)$。$A(E)$ 的单位是 $\\text{eV}^{-1}$。\n\n#### 3. 寿命, $\\tau(E)$\n\n量子态的有限寿命源于允许电子逃逸的过程，无论是逃逸到电极还是通过散射。总展宽 $\\Gamma_{tot}(E)$ 量化了所有这些过程的速率。它与总自能的虚部相关，$\\Sigma^r_{tot} = \\Sigma_L^r + \\Sigma_R^r + \\Sigma_s^r$。\n$$\n\\Gamma_{tot}(E) = -2 \\cdot \\text{Im}[\\Sigma^r_{tot}(E)] = -2 \\cdot \\text{Im}\\left[-i\\frac{\\Gamma_L+\\Gamma_R}{2} + D \\cdot G^r(E)\\right]\n$$\n$$\n\\Gamma_{tot}(E) = -2 \\left(-\\frac{\\Gamma_L+\\Gamma_R}{2} + D \\cdot \\text{Im}[G^r(E)]\\right) = \\Gamma_L + \\Gamma_R - 2D \\cdot \\text{Im}[G^r(E)]\n$$\n利用关系式 $A(E) = -2\\text{Im}[G^r(E)]$，我们得到一个物理上直观的结果：\n$$\n\\Gamma_{tot}(E) = \\Gamma_L + \\Gamma_R + D \\cdot A(E)\n$$\n总展宽是由于电极引起的展宽（$\\Gamma_L+\\Gamma_R$）与一个来自散射的附加项（$D \\cdot A(E)$）之和，该附加项与散射强度和可用的态密度成正比。寿命则由海森堡不确定性原理给出：\n$$\n\\tau(E) = \\frac{\\hbar}{\\Gamma_{tot}(E)}\n$$\n为了用飞秒表示结果，我们使用换算关系 $\\tau[\\text{fs}] = \\tau[\\text{s}] \\times 10^{15}$。\n\n#### 4. 透射率, $T(E)$\n\n对于线性响应条件（小偏压）下的两端器件，能量分辨的透射系数由 Fisher-Lee 公式给出，在 NEGF 形式主义中，对于单能级系统，该公式为：\n$$\nT(E) = \\text{Tr}[\\mathbf{\\Gamma}_L(E) \\mathbf{G}^r(E) \\mathbf{\\Gamma}_R(E) \\mathbf{G}^a(E)]\n$$\n对于我们的标量情况，并使用宽带近似，其中展宽函数 $\\mathbf{\\Gamma}_\\alpha(E) = i(\\Sigma_\\alpha^r - \\Sigma_\\alpha^a) = \\Gamma_\\alpha$，该式简化为：\n$$\nT(E) = \\Gamma_L G^r(E) \\Gamma_R G^a(E) = \\Gamma_L \\Gamma_R |G^r(E)|^2\n$$\n量 $T(E)$ 是无量纲的，表示能量为 E 的电子从左电极透射到右电极的概率。\n\n### 算法实现\n\n对于每个具有参数 $(E, \\varepsilon_0, \\Gamma_L, \\Gamma_R, D)$ 的测试用例：\n1.  定义 $\\hbar = 6.582119569 \\times 10^{-16}\\,$ eV·s。\n2.  如果 $D = 0$（弹道情况），计算 $G^r(E) = \\left(E - \\varepsilon_0 + i\\frac{\\Gamma_L + \\Gamma_R}{2}\\right)^{-1}$。\n3.  如果 $D > 0$，计算复数项 $E' = (E - \\varepsilon_0) + i\\frac{\\Gamma_L + \\Gamma_R}{2}$。然后使用复数运算计算 $G^r(E) = \\frac{E' - \\sqrt{(E')^2 - 4D}}{2D}$。\n4.  计算谱函数：$A(E) = -2 \\cdot \\text{Im}[G^r(E)]$。\n5.  计算总展宽：$\\Gamma_{tot}(E) = \\Gamma_L + \\Gamma_R + D \\cdot A(E)$。\n6.  计算寿命（单位：飞秒）：$\\tau(E) = (\\hbar / \\Gamma_{tot}(E)) \\times 10^{15}$。\n7.  计算透射率：$T(E) = \\Gamma_L \\Gamma_R |G^r(E)|^2$。\n8.  存储三个结果（$A(E)$、$\\tau(E)$、$T(E)$），并对所有测试用例重复此过程。\n9.  格式化最终的扁平化结果列表，每个值四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the NEGF problem for a single-level quantum system with self-consistent scattering.\n    \"\"\"\n    # Define physical constants and test cases from the problem statement.\n    hbar = 6.582119569e-16  # eV*s\n    \n    # Test cases: (E, epsilon_0, Gamma_L, Gamma_R, D)\n    # Units: E, epsilon_0, Gamma_L, Gamma_R in eV; D in eV^2\n    test_cases = [\n        (0.000, 0.000, 0.050, 0.050, 0.000),  # Case 1: Ballistic resonance\n        (0.000, 0.000, 0.050, 0.050, 0.005),  # Case 2: Weak scattering\n        (0.000, 0.000, 0.050, 0.050, 0.080),  # Case 3: Strong scattering\n        (0.200, 0.000, 0.050, 0.050, 0.020),  # Case 4: Off-resonance\n        (0.000, 0.000, 0.020, 0.080, 0.010),  # Case 5: Asymmetric contacts\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, epsilon_0, Gamma_L, Gamma_R, D = case\n        \n        Gamma_T = Gamma_L + Gamma_R\n        \n        # Calculate the self-consistent retarded Green's function G^r(E)\n        if D == 0:\n            # Ballistic case (no scattering)\n            Gr = 1 / ((E - epsilon_0) + 1j * Gamma_T / 2)\n        else:\n            # Self-consistent Born approximation for scattering\n            # G^r solves the quadratic equation: D*(G^r)^2 - E_prime*G^r + 1 = 0\n            # E_prime = E - epsilon_0 + i*(Gamma_L + Gamma_R)/2\n            # The physical root is chosen to match the D - 0 limit.\n            E_prime = (E - epsilon_0) + 1j * Gamma_T / 2\n            # Use numpy for complex arithmetic, including square root\n            sqrt_term = np.sqrt(E_prime**2 - 4 * D)\n            Gr = (E_prime - sqrt_term) / (2 * D)\n\n        # 1. Calculate the spectral function A(E) in eV^-1\n        # A(E) = -2 * Im(G^r)\n        A_E = -2 * Gr.imag\n        \n        # 2. Calculate the lifetime tau(E) in femtoseconds\n        # Total broadening Gamma_tot = Gamma_L + Gamma_R + D*A(E)\n        Gamma_tot = Gamma_T + D * A_E\n        # Lifetime tau = hbar / Gamma_tot\n        tau_s = hbar / Gamma_tot\n        tau_fs = tau_s * 1e15\n        \n        # 3. Calculate the transmission T(E) (dimensionless)\n        # T(E) = Gamma_L * Gamma_R * |G^r|^2\n        T_E = Gamma_L * Gamma_R * (np.abs(Gr)**2)\n        \n        # Append results for the current case to the main list\n        results.extend([A_E, tau_fs, T_E])\n\n    # Format the final output as a single comma-separated list in brackets,\n    # with each number rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}