{
    "hands_on_practices": [
        {
            "introduction": "线性化是分析平衡点稳定性的首要工具，但当系统的雅可比矩阵在平衡点处出现零或纯虚特征值时，线性化分析便会失效。本练习将引导你处理这样一个非双曲系统，通过构建一个守恒量（即李雅普诺夫函数），你将能够超越线性化的局限，严格证明非线性系统的稳定性。",
            "id": "4293645",
            "problem": "考虑自治、时不变的二维常微分方程（ODE）系统\n$$\n\\dot{x}_{1}=x_{2},\\qquad \\dot{x}_{2}=-x_{1}-x_{1}^{3},\n$$\n该系统代表了广义坐标为 $x_{1}$、速度为 $x_{2}$ 的单位质量质点在保守非线性恢复力作用下的动力学。你的任务是评估在平衡点 $(0,0)$ 处线性化的预测能力，并通过与完整非线性动力学系统的比较，确定线性化是否得出了正确的稳定性结论，同时明确讨论高阶项的作用。\n\n你必须从适用于复杂系统和非线性动力学的基础原理出发：通过平衡点处的雅可比矩阵定义线性化，通过特征值对双曲情形下的平衡点进行分类，以及对于保守力学系统，运用功能原理导出能量形式的第一积分。除这些基础原理外，不得援引任何专门的定理。\n\n任务：\n- 确定系统在 $(0,0)$ 处的线性化，并根据线性化后的特征值对平衡点进行分类。\n- 在此非双曲情形下，说明仅凭线性化能够或不能够对稳定性得出何种结论，并从第一性原理出发证明你的陈述。\n- 将动力学解释为保守力学系统，并仅使用链式法则和功能原理，从第一性原理推导出一个完整非线性系统的守恒能量函数。\n- 使用推导出的守恒量，严格评估完整非线性系统中平衡点的李雅普诺夫稳定性和渐近稳定性。\n- 相对于线性化的预测，明确讨论高阶项 $-x_{1}^{3}$ 在塑造非线性稳定性特性方面的作用。\n\n答案规格：\n- 你最终报告的答案必须是你从第一性原理推导出的一个光滑、正定的李雅普诺夫函数 $V(x_{1},x_{2})$ 的显式解析表达式，该函数证明了完整非线性系统在 $(0,0)$ 点的李雅普诺夫稳定性。不要包含单位。无需数值取整。最终答案必须是单一的闭式表达式。",
            "solution": "问题要求对给定的二维非线性常微分方程（ODE）系统的平衡点 $(0,0)$ 进行稳定性分析：\n$$\n\\dot{x}_{1} = x_{2} \\\\\n\\dot{x}_{2} = -x_{1} - x_{1}^{3}\n$$\n分析必须将线性化的预测与使用推导出的守恒量对完整非线性系统进行的严格稳定性评估进行比较。\n\n我们首先将系统表示为向量形式。令 $\\mathbf{x} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$。系统动力学由 $\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x})$ 描述，其中向量场 $\\mathbf{f}$ 由下式给出：\n$$\n\\mathbf{f}(x_{1}, x_{2}) = \\begin{pmatrix} x_{2} \\\\ -x_{1} - x_{1}^{3} \\end{pmatrix}\n$$\n平衡点通过令 $\\mathbf{f}(\\mathbf{x}) = \\mathbf{0}$ 求得。这得到 $x_{2}=0$ 和 $-x_{1}-x_{1}^{3} = -x_{1}(1+x_{1}^{2}) = 0$。由于对所有实数 $x_{1}$ 都有 $1+x_{1}^{2}  0$，唯一的实数解是 $x_{1}=0$。因此，如问题所述，唯一的平衡点在原点 $(0,0)$。\n\n首先，我们确定系统在该平衡点处的线性化。线性化由 $\\dot{\\mathbf{z}} = J(0,0)\\mathbf{z}$ 给出，其中 $J$ 是 $\\mathbf{f}$ 的雅可比矩阵：\n$$\nJ(x_{1}, x_{2}) = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial x_{1}}  \\frac{\\partial f_{1}}{\\partial x_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial x_{1}}  \\frac{\\partial f_{2}}{\\partial x_{2}} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -1 - 3x_{1}^{2}  0 \\end{pmatrix}\n$$\n在平衡点 $(0,0)$ 处计算雅可比矩阵：\n$$\nA = J(0,0) = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}\n$$\n为了对平衡点进行分类，我们通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来求该矩阵的特征值：\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -1  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(-1) = \\lambda^{2} + 1 = 0\n$$\n特征值为 $\\lambda_{1,2} = \\pm i$。这是一对纯虚特征值。如果雅可比矩阵的所有特征值都具有非零实部，则该平衡点被分类为双曲平衡点。由于 $\\lambda_{1,2}$ 的实部为零，因此 $(0,0)$ 处的平衡点是非双曲的。\n\n对于线性化系统，纯虚特征值对应于一个中心点，其轨道是围绕平衡点的闭合轨道（圆形或椭圆形），表明系统是稳定的。然而，Hartman-Grobman 定理（该定理保证了双曲平衡点附近非线性系统与其线性化之间的拓扑等价性）在此不适用。因此，仅凭线性化无法得出结论。完整非线性系统的稳定性取决于 $\\mathbf{f}$ 的泰勒展开中的高阶项（$H.O.T.$），在本例中即为 $-x_{1}^{3}$ 项。原点附近的非线性系统可能表现为中心点、稳定螺线点或不稳定螺线点。要得出明确的结论，需要对非线性系统进行直接分析。\n\n现在，我们按照要求从第一性原理推导一个守恒量。该系统可以解释为一个单位质量（$m=1$）的质点，其位置为 $x_{1}$，速度为 $\\dot{x}_{1}=x_{2}$。加速度方程为 $\\ddot{x}_{1} = \\dot{x}_{2} = -x_{1} - x_{1}^{3}$。这对应于牛顿第二定律 $m\\ddot{x}_{1} = F(x_{1})$，其中力 $F(x_{1}) = -x_{1} - x_{1}^{3}$。由于力仅取决于位置 $x_{1}$，因此它是一个保守力。功能原理指出，对于这样的系统，总机械能是守恒的。总能量 $E$ 是动能 $T$ 和势能 $U$ 的和。\n\n单位质量的动能为 $T = \\frac{1}{2}m v^{2} = \\frac{1}{2}(1)x_{2}^{2} = \\frac{1}{2}x_{2}^{2}$。\n势能 $U(x_{1})$ 通过 $F(x_{1}) = -\\frac{dU}{dx_{1}}$ 与保守力相关。我们可以通过积分求得 $U(x_{1})$：\n$$\nU(x_{1}) = -\\int F(x_{1}) \\,dx_{1} = -\\int (-x_{1} - x_{1}^{3}) \\,dx_{1} = \\int (x_{1} + x_{1}^{3}) \\,dx_{1} = \\frac{1}{2}x_{1}^{2} + \\frac{1}{4}x_{1}^{4} + C_{0}\n$$\n选择积分常数 $C_{0}=0$，使得势能在平衡点处为零，我们得到 $U(x_{1}) = \\frac{1}{2}x_{1}^{2} + \\frac{1}{4}x_{1}^{4}$。\n\n系统的总能量是一个候选的李雅普诺夫函数，我们将其表示为 $V(x_{1}, x_{2})$：\n$$\nV(x_{1}, x_{2}) = T + U = \\frac{1}{2}x_{2}^{2} + \\frac{1}{2}x_{1}^{2} + \\frac{1}{4}x_{1}^{4}\n$$\n为验证这是系统的一个守恒量，我们使用链式法则计算它沿系统轨线的时间导数：\n$$\n\\dot{V} = \\frac{dV}{dt} = \\frac{\\partial V}{\\partial x_{1}}\\dot{x}_{1} + \\frac{\\partial V}{\\partial x_{2}}\\dot{x}_{2}\n$$\n偏导数是：\n$$\n\\frac{\\partial V}{\\partial x_{1}} = x_{1} + x_{1}^{3} \\\\\n\\frac{\\partial V}{\\partial x_{2}} = x_{2}\n$$\n将这些偏导数和系统动力学（$\\dot{x}_{1}=x_{2}$, $\\dot{x}_{2}=-x_{1}-x_{1}^{3}$）代入 $\\dot{V}$ 的表达式：\n$$\n\\dot{V} = (x_{1} + x_{1}^{3})(x_{2}) + (x_{2})(-x_{1} - x_{1}^{3}) = x_{1}x_{2} + x_{1}^{3}x_{2} - x_{1}x_{2} - x_{1}^{3}x_{2} = 0\n$$\n由于 $\\dot{V} \\equiv 0$，函数 $V(x_{1}, x_{2})$ 是一个运动常数，或称为第一积分。这证实了它作为守恒能量的作用。\n\n现在，我们使用这个函数 $V(x_{1}, x_{2})$ 通过李雅普诺夫直接法来正式评估平衡点 $(0,0)$ 的稳定性。如果一个函数在平衡点的一个邻域内是正定的，并且其时间导数是半负定的，那么它就是一个证明稳定性的李雅普诺夫函数。\n1.  **正定性：**\n    -   在原点， $V(0,0) = \\frac{1}{2}(0)^{2} + \\frac{1}{4}(0)^{4} + \\frac{1}{2}(0)^{2} = 0$。\n    -   对于任意点 $(x_{1}, x_{2}) \\neq (0,0)$，项 $\\frac{1}{2}x_{1}^{2}$、$\\frac{1}{4}x_{1}^{4}$ 和 $\\frac{1}{2}x_{2}^{2}$ 都是非负的。它们的和为零当且仅当所有项都为零，而这只在 $(x_{1}, x_{2})=(0,0)$ 时发生。因此，对于所有 $(x_{1}, x_{2}) \\neq (0,0)$，都有 $V(x_{1}, x_{2})  0$。该函数是全局正定的。\n\n2.  **时间导数：**\n    -   我们已经证明，对于所有 $(x_{1}, x_{2})$，$\\dot{V}(x_{1}, x_{2}) = 0$。这满足了半负定（$\\dot{V} \\le 0$）的条件。\n\n由于我们找到了一个光滑的正定函数 $V$，其沿轨线的时间导数恒为零，因此平衡点 $(0,0)$ 是**李雅普诺夫稳定的**。这意味着从原点足够近处开始的轨线将永远保持在原点的一个小邻域内。具体来说，它们被限制在 $V(x_{1}, x_{2}) = \\text{常数}$ 的等值面上。\n\n对于渐近稳定性，我们需要轨线在 $t \\to \\infty$ 时趋近于原点。这里情况并非如此。渐近稳定性要求 $\\dot{V}$ 在原点之外是严格负的（或者，根据LaSalle不变性原理，要求 $\\dot{V}=0$ 的集合除了平衡点之外不包含任何其他轨线）。在这里，$\\dot{V}=0$ 处处成立，所以每条轨线都是一个不变集。系统不是渐近稳定的；它表现出持续的振荡。\n\n最后，我们讨论高阶项 $-x_{1}^{3}$ 的作用。线性化捕捉了力 $-x_{1}$，对应于一个势能为 $U_{lin}(x_{1}) = \\frac{1}{2}x_{1}^{2}$ 的简谐振子。高阶项 $-x_{1}^{3}$ 是一个非线性恢复力，它为势能增加了 $\\frac{1}{4}x_{1}^{4}$ 这一项。由于当 $x_{1} \\neq 0$ 时 $x_{1}^{4}  0$，该项使得势阱比线性化系统的抛物线形势阱更“陡峭”。这种额外的恢复效应与线性力方向相同，增强了稳定性。它确保了势能在 $x_{1}=0$ 处有一个严格的全局最小值。完整能量函数 $V(x_{1}, x_{2})$ 的正定性是全局成立的，这意味着所有轨线都是有界的，并且实际上是对应于 $V$ 的等值面的闭合轨道。系统拥有一个**非线性中心**。在这个具体例子中，线性化系统（一个中心点）的预测恰好与完整非线性系统的行为一致。然而，对于非双曲情形，这种正确性通常是无法保证的，并且仅通过构造完整系统的李雅普诺夫函数才得以证实。高阶项保持，甚至增强了平衡点的稳定性。",
            "answer": "$$\n\\boxed{\\frac{1}{2}x_{1}^{2} + \\frac{1}{2}x_{2}^{2} + \\frac{1}{4}x_{1}^{4}}\n$$"
        },
        {
            "introduction": "非线性系统的一个显著特征是其行为会随着参数的改变而发生质的突变，即分岔。本练习探讨了一个经典的双稳态势能系统，通过分析其在准静态外力作用下的响应，你将推导出系统平衡点是如何通过鞍结分岔产生和消失的。这个过程清晰地揭示了迟滞现象——系统状态对历史路径的依赖性——的内在机制。",
            "id": "4293615",
            "problem": "考虑一个单自由度过阻尼梯度系统，其状态变量为 $x \\in \\mathbb{R}$。该系统演化得足够缓慢，以至于它始终保持在（或绝热地跟踪）一个有效势的局域极小值处。内在势为 $V(x)=\\frac{1}{4}x^{4}-\\frac{1}{2}a x^{2}$，其中 $a>0$。一个准静态的外部广义力 $F \\in \\mathbb{R}$ 与 $x$ 线性耦合，因此有效势为 $U(x;F)=V(x)-F x$。在准静态极限下，平衡点被定义为 $U$ 的驻点，而局域稳定性则由 $U$ 的正曲率定义。\n\n仅使用这些原理，完成以下任务：\n\n(a) 通过对 $U(x;F)$ 关于 $x$ 施加驻定性条件，推导 $x$ 作为 $F$ 的函数的平衡条件。不要显式求解得到的多项式；而是表达出 $x$ 必须满足的隐式关系。\n\n(b) 通过考察 $U(x;F)$ 的曲率，确定用 $x$ 和 $a$ 表示的平衡点的局域稳定性判据。\n\n(c) 确定在 $F$ 变化时，一个稳定平衡点和一个不稳定平衡点合并并相互湮灭的条件（鞍节点事件）。利用此条件，解析地推导出这种消失发生时的临界驱动力大小 $F_{c}$，并用 $a$ 以闭式形式表示。\n\n(d) 在上述推导的支持下，用文字解释当 $F$ 从一个大的负值缓慢循环扫描到一个大的正值再返回时，跟踪 $x$ 与 $F$ 的关系如何产生一个滞后回线。你的解释应将多重平衡点的存在、它们的稳定性以及鞍节点事件联系起来。\n\n作为最终答案，提供你得到的临界驱动力大小 $F_c$ 的精确解析表达式。不需要数值近似，也不需要单位。",
            "solution": "系统的有效势由 $U(x;F) = V(x) - Fx$ 给出，其中内在势为 $V(x) = \\frac{1}{4}x^{4} - \\frac{1}{2}ax^{2}$，参数 $a > 0$。因此，有效势为：\n$$\nU(x;F) = \\frac{1}{4}x^{4} - \\frac{1}{2}ax^{2} - Fx\n$$\n\n(a) 平衡条件是通过找出有效势 $U(x;F)$ 关于状态变量 $x$ 的驻点来找到的。这可以通过将 $U$ 对 $x$ 的一阶导数设为零来实现。\n$$\n\\frac{\\partial U}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{4}x^{4} - \\frac{1}{2}ax^{2} - Fx \\right) = x^{3} - ax - F\n$$\n将此导数设为零，$\\frac{\\partial U}{\\partial x} = 0$，得到定义了在给定驱动力 $F$ 下 $x$ 的平衡值的隐式关系：\n$$\nx^{3} - ax - F = 0\n$$\n这个方程可以表示为 $F = x^{3} - ax$，它定义了 $(x, F)$ 平面中的平衡流形。\n\n(b) 平衡点的局域稳定性由该点处势的曲率决定。一个稳定的平衡点对应于势的一个局域极小值，这要求 $U(x;F)$ 对 $x$ 的二阶导数为正。我们计算这个二阶导数：\n$$\n\\frac{\\partial^{2} U}{\\partial x^{2}} = \\frac{\\partial}{\\partial x} (x^{3} - ax - F) = 3x^{2} - a\n$$\n为使平衡点是局域稳定的，我们必须有 $\\frac{\\partial^{2} U}{\\partial x^{2}}  0$。这给出了稳定性判据：\n$$\n3x^{2} - a  0\n$$\n这个不等式可以对 $x$ 求解，以确定稳定区域：\n$$\nx^{2}  \\frac{a}{3} \\quad \\text{或等价地} \\quad |x|  \\sqrt{\\frac{a}{3}}\n$$\n如果平衡点位于满足 $|x|  \\sqrt{a/3}$ 的位置，则它们是稳定的。相反，如果 $|x|  \\sqrt{a/3}$，曲率为负，则平衡点是不稳定的。\n\n(c) 当一个稳定平衡点和一个不稳定平衡点合并并相互湮灭时，发生鞍节点事件。这发生在稳定性的边缘，恰好是势的曲率为零的地方。这对应于条件：\n$$\n\\frac{\\partial^{2} U}{\\partial x^{2}} = 3x^{2} - a = 0\n$$\n求解发生这种情况的临界位置 $x_{c}$，我们发现：\n$$\nx_{c}^{2} = \\frac{a}{3} \\implies x_{c} = \\pm \\sqrt{\\frac{a}{3}}\n$$\n这些临界位置是鞍节点分岔的位置。为了找到相应的临界驱动力值，我们将这些 $x_{c}$ 值代回到 (a) 部分的平衡条件 $F = x^{3} - ax$ 中。\n对于临界点 $x_{c} = -\\sqrt{\\frac{a}{3}}$：\n$$\nF = \\left(-\\sqrt{\\frac{a}{3}}\\right)^{3} - a\\left(-\\sqrt{\\frac{a}{3}}\\right) = -\\left(\\frac{a}{3}\\right)\\sqrt{\\frac{a}{3}} + a\\sqrt{\\frac{a}{3}} = \\sqrt{\\frac{a}{3}}\\left(a - \\frac{a}{3}\\right) = \\sqrt{\\frac{a}{3}}\\left(\\frac{2a}{3}\\right) = \\frac{2a\\sqrt{a}}{3\\sqrt{3}}\n$$\n对于临界点 $x_{c} = +\\sqrt{\\frac{a}{3}}$：\n$$\nF = \\left(\\sqrt{\\frac{a}{3}}\\right)^{3} - a\\left(\\sqrt{\\frac{a}{3}}\\right) = \\left(\\frac{a}{3}\\right)\\sqrt{\\frac{a}{3}} - a\\sqrt{\\frac{a}{3}} = \\sqrt{\\frac{a}{3}}\\left(\\frac{a}{3} - a\\right) = \\sqrt{\\frac{a}{3}}\\left(-\\frac{2a}{3}\\right) = -\\frac{2a\\sqrt{a}}{3\\sqrt{3}}\n$$\n问题要求的是临界驱动力的大小，记为 $F_{c}$。这是上面计算出的力的绝对值：\n$$\nF_{c} = \\left|\\pm\\frac{2a\\sqrt{a}}{3\\sqrt{3}}\\right| = \\frac{2a\\sqrt{a}}{3\\sqrt{3}}\n$$\n\n(d) 在特定的 $F$ 范围内存在多重平衡点，以及它们在临界点处的湮灭，导致了滞后现象。在驱动力范围 $|F|  F_{c}$ 内，对于 $x$ 存在三个平衡解：两个是稳定的（外部分支，其中 $|x| > \\sqrt{a/3}$），一个是不稳定的（中间分支，其中 $|x|  \\sqrt{a/3}$）。根据假设，系统会跟踪一个稳定的平衡点（$U$ 的一个局域极小值）。\n\n让我们追踪一次 $F$ 的缓慢循环扫描：\n1.  从一个大的负驱动力开始，$F \\ll -F_{c}$。此时 $U(x;F)$ 只有一个极小值，位于一个大的负 $x$ 处。系统状态位于这个下方的稳定分支上。\n2.  缓慢增加 $F$。系统状态 $x$ 随之增加，沿着这个下方的稳定分支移动。即使当 $F$ 进入双稳区 $(-F_{c}, F_{c})$，系统仍然停留在这个分支上。\n3.  当 $F$ 达到临界值 $+F_{c}$ 时，下方的稳定平衡点（位于 $x_{c} = -\\sqrt{a/3}$）与中间的不稳定平衡点合并，然后两者都消失了。\n4.  随着其局域极小值的消失，系统必须经历一次灾变性跳跃，跃迁到唯一剩下的稳定平衡点，该平衡点位于上部分支，对应一个正的 $x$ 值。\n5.  现在，将 $F$ 从一个大的正值扫回来。系统从上方的稳定分支（大的正 $x$）开始。\n6.  随着 $F$ 的减小，系统跟踪这个上部分支， $x$ 值随之减小。\n7.  当 $F$ 下降到另一个临界值 $-F_{c}$ 时，上方的稳定平衡点（位于 $x_{c} = +\\sqrt{a/3}$）与不稳定的平衡点合并并消失。\n8.  系统随后必须向下跳跃到唯一可用的稳定状态，该状态位于下部分支，对应一个负的 $x$ 值。\n\n当 $F$ 增加时 $x$ 的路径与 $F$ 减小时的路径不同。这种状态对控制参数 $F$ 历史的依赖性就是滞后现象。$x$ 对 $F$ 的图像形成一个回线，向上和向下的跳跃发生在两个不同的驱动力值 $+F_{c}$ 和 $-F_{c}$ 处，这两个点是鞍节点分岔点。",
            "answer": "$$\\boxed{\\frac{2a\\sqrt{a}}{3\\sqrt{3}}}$$"
        },
        {
            "introduction": "混沌的标志性特征是对初始条件的敏感依赖性，即“蝴蝶效应”。本练习将介绍量化这种敏感性的核心工具——最大李雅普诺夫指数（LLE），并指导你通过编程来计算它。通过对经典的逻辑斯蒂映射进行分析，你将学习如何从动力学方程出发，推导并数值估计LLE，从而能够明确地区分周期行为与混沌行为。",
            "id": "4293679",
            "problem": "考虑在区间 $[0,1]$ 上由 $x_{n+1} = T(x_n)$ 定义的一维迭代映射，其中 $T$ 是连续可微的。最大李雅普诺夫指数（LLE）量化了相邻轨道的平均指数分离率，其基本定义为长时间极限\n$$\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\frac{|\\delta x_n|}{|\\delta x_0|},$$\n其中 $\\delta x_n$ 是两条轨道在 $n$ 次迭代后的无穷小分离，该分离在由 $T$ 诱导的线性化下演化。\n\n您的任务是：\n\n1) 从上述基本定义和可微函数复合的链式法则出发，推导出一维可微映射的最大李雅普诺夫指数的表达式。该表达式应以沿典型轨道的 $T$ 导数绝对值的对数的长时间平均值来表示。请清楚地说明您在推导过程中使用的所有假设。\n\n2) 将您的结果具体应用于参数为 $r \\in (0,4]$ 的逻辑斯谛映射 $T(x) = r x (1 - x)$。请为该映射提供有限时间最大李雅普诺夫指数估计量的每次迭代贡献的显式表达式，表示为 $r$ 和当前状态 $x_n$ 的函数。\n\n3) 实现一个程序，使用有限时间估计量来数值估计最大李雅普诺夫指数\n$$\\hat{\\lambda}_{N,M}(x_0) = \\frac{1}{N} \\sum_{n=1}^{N} \\log \\left| T'(x_{M+n-1}) \\right|,$$\n其中 $M$ 是预烧（瞬态）长度，$N$ 是平均迭代次数，$x_0$ 是初始条件，$\\log$ 表示自然对数。您的实现必须对逻辑斯谛映射中可能发生的非线性引起的奇异事件具有鲁棒性，例如遇到 $|T'(x)| = 0$ 的点或舍入到区间端点：\n- 在迭代索引为 $n$ 时计算任何对数之前，如果 $|1 - 2 x_{M+n-1}|  \\varepsilon_{\\text{crit}}$ 或 $x_{M+n-1} \\notin [0,1]$ 或 $x_{M+n-1}$ 距离任一端点的距离在 $\\varepsilon_{\\text{end}}$ 之内，则将 $x_{M+n-1}$ 替换为 $x_{M+n-1} + \\operatorname{sign}(0.5 - x_{M+n-1}) \\, \\varepsilon_{\\text{jit}}$，然后将其限制在闭区间 $[\\varepsilon_{\\text{end}}, 1 - \\varepsilon_{\\text{end}}]$ 内。\n- 使用 $\\varepsilon_{\\text{crit}} = 10^{-14}$，$\\varepsilon_{\\text{jit}} = 10^{-12}$ 和 $\\varepsilon_{\\text{end}} = 10^{-15}$。\n- 在每次映射迭代 $x \\mapsto T(x)$ 之后，将结果限制在 $[\\varepsilon_{\\text{end}}, 1 - \\varepsilon_{\\text{end}}]$ 内，以避免因舍入而产生的虚假端点值。\n\n4) 使用您的程序为以下测试套件评估估计量。对于每种情况，报告一个浮点数值，该值等于四舍五入到 $6$ 位小数的 $\\hat{\\lambda}_{N,M}(x_0)$：\n- 情况 A（完全发展的混沌，典型初始条件）：$r = 4.0$，$x_0 = 0.123456789$，$M = 1000$，$N = 200000$。\n- 情况 B（需要正则化的临界点初始条件）：$r = 4.0$，$x_0 = 0.5$，$M = 1000$，$N = 200000$。\n- 情况 C（周期窗口）：$r = 3.2$，$x_0 = 0.1$，$M = 1000$，$N = 200000$。\n- 情况 D（Feigenbaum 点附近的混沌初现）：$r = 3.569945672$，$x_0 = 0.1$，$M = 2000$，$N = 200000$。\n- 情况 E（混沌带状吸引子）：$r = 3.75$，$x_0 = 0.1$，$M = 1000$，$N = 200000$。\n\n将估计出的最大李雅普诺夫指数的正值解释为对初始条件敏感依赖性（混沌）的指标，负值解释为渐近周期性的指标。您无需输出此解释；它用于指导您的理解。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，每个值四舍五入到 $6$ 位小数，顺序为 [情况 A, 情况 B, 情况 C, 情况 D, 情况 E]。例如，一个有效的输出行格式为“[0.693147,0.693147,-0.000001,0.000000,0.500000]”。不要打印任何其他文本。",
            "solution": "用户的要求是推导一维映射的最大李雅普诺夫指数（LLE）的表达式，将其具体化到逻辑斯谛映射，并实现一个数值估计器来为几个测试用例计算它。\n\n### 任务1：李雅普诺夫指数表达式的推导\n\n最大李雅普诺夫指数 $\\lambda$ 量化了无穷小邻近轨道分离的平均速率。对于一维映射 $x_{n+1} = T(x_n)$，其基本定义为：\n$$\n\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\frac{|\\delta x_n|}{|\\delta x_0|}\n$$\n这里，$\\delta x_0$ 是两个起始点 $x_0$ 和 $x_0' = x_0 + \\delta x_0$ 之间的初始无穷小分离。$n$ 次迭代后的分离是 $\\delta x_n = x_n' - x_n$，其中 $x_n = T^n(x_0)$ 且 $x_n' = T^n(x_0')$。\n\n我们逐步进行推导。\n设两条轨道在 $x_0$ 和 $x_0' = x_0 + \\delta x_0$ 处初始化。\n一次迭代后，它们的状态为 $x_1 = T(x_0)$ 和 $x_1' = T(x_0 + \\delta x_0)$。\n分离变为 $\\delta x_1 = x_1' - x_1 = T(x_0 + \\delta x_0) - T(x_0)$。\n由于初始分离 $\\delta x_0$ 是无穷小的，且假设映射 $T$ 是连续可微的，我们可以对 $T(x_0 + \\delta x_0)$ 在 $x_0$ 附近使用一阶泰勒级数展开：\n$$\nT(x_0 + \\delta x_0) \\approx T(x_0) + T'(x_0) \\delta x_0\n$$\n其中 $T'(x_0)$ 是 $T$ 在 $x_0$ 处的导数。\n将此代入 $\\delta x_1$ 的表达式中，得到：\n$$\n\\delta x_1 \\approx (T(x_0) + T'(x_0) \\delta x_0) - T(x_0) = T'(x_0) \\delta x_0\n$$\n这表明初始分离 $\\delta x_0$ 在一次迭代后被拉伸或压缩了 $|T'(x_0)|$ 倍。\n\n现在，我们考虑分离在 $n$ 次迭代中的演化。第二次迭代后，分离为 $\\delta x_2 \\approx T'(x_1) \\delta x_1$。代入 $\\delta x_1$ 的表达式，我们得到：\n$$\n\\delta x_2 \\approx T'(x_1) \\left( T'(x_0) \\delta x_0 \\right) = T'(x_1) T'(x_0) \\delta x_0\n$$\n通过归纳法，在 $n$ 次迭代后，分离 $\\delta x_n$ 与初始分离 $\\delta x_0$ 的关系为：\n$$\n\\delta x_n \\approx \\left( \\prod_{k=0}^{n-1} T'(x_k) \\right) \\delta x_0\n$$\n其中 $x_k = T^k(x_0)$ 是主轨道在第 $k$ 次迭代时的状态。根据链式法则，乘积项恰好是映射的第 $n$ 次迭代 $T^n(x_0)$ 的导数：$(T^n)'(x_0) = T'(x_{n-1}) \\cdots T'(x_1) T'(x_0)$。\n\n我们将此结果代入 $\\lambda$ 的定义中：\n$$\n\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\frac{|\\left( \\prod_{k=0}^{n-1} T'(x_k) \\right) \\delta x_0|}{|\\delta x_0|}\n$$\n$|\\delta x_0|$ 项被消去：\n$$\n\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\left| \\prod_{k=0}^{n-1} T'(x_k) \\right|\n$$\n利用对数的性质 $\\ln(\\prod a_i) = \\sum \\ln(a_i)$，我们得到最终表达式：\n$$\n\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} \\ln |T'(x_k)|\n$$\n该表达式将最大李雅普诺夫指数表示为沿一条轨道评估的映射导数绝对值的对数的长时间平均值。\n\n该推导依赖于以下关键假设：\n1.  **可微性**：映射 $T(x)$ 在其定义域上必须至少是连续可微的（$C^1$），这样才能使用泰勒级数展开和链式法则。\n2.  **无穷小分离**：整个推导基于映射动力学的线性化，这只对无穷小分离有效。李雅普诺夫指数刻画了这种无穷小扰动的增长率。\n3.  **遍历性**：这是导出公式具有实用性的关键假设。我们假设系统在其吸引子上是遍历的。这意味着，对于吸引盆内几乎所有的初始条件 $x_0$，沿所得轨道的时间平均等同于在吸引子的自然不变测度上的空间平均。因此，极限存在且不依赖于典型初始条件 $x_0$ 的具体选择。\n\n### 任务2：具体化到逻辑斯谛映射\n\n逻辑斯谛映射定义为 $T(x) = r x (1 - x)$。\n为了应用推导出的公式，我们首先需要计算其导数 $T'(x)$：\n$$\nT'(x) = \\frac{d}{dx} \\left( rx - rx^2 \\right) = r - 2rx = r(1-2x)\n$$\n在第 $n$ 步，对 LLE 的有限时间估计量的单次迭代贡献是求和内的项 $\\ln|T'(x_n)|$。对于逻辑斯谛映射，此项明确为：\n$$\n\\ln|T'(x_n)| = \\ln|r(1-2x_n)|\n$$\n\n### 任务3和4：数值估计与实现\n\n问题提供了一个 LLE 的有限时间估计量：\n$$\n\\hat{\\lambda}_{N,M}(x_0) = \\frac{1}{N} \\sum_{n=1}^{N} \\log \\left| T'(x_{M+n-1}) \\right|\n$$\n这里，$M$ 是“预烧”迭代的次数，以让轨道稳定到吸引子上，$N$ 是其后用于计算平均值的迭代次数。\n\n数值实现遵循一个精确的算法以确保鲁棒性，特别是针对奇异点。逻辑斯谛映射的导数 $T'(x) = r(1-2x)$ 在临界点 $x=0.5$ 时为零，这将导致对数发散到 $-\\infty$。端点 $x=0$ 和 $x=1$ 也可能引起问题。\n\n实现的算法流程如下：\n1.  用初始条件 $x_0$ 初始化状态 $x$。\n2.  执行预烧阶段：迭代映射 $M$ 次。在每次迭代中，更新状态 $x \\leftarrow r x (1 - x)$，然后将结果限制在区间 $[\\varepsilon_{\\text{end}}, 1 - \\varepsilon_{\\text{end}}]$ 内，以防止状态因浮点舍入而精确地落在端点上。\n3.  初始化一个累加器 `lyapunov_sum` 为 $0.0$。\n4.  执行 $N$ 次迭代的平均阶段：\n    a. 设当前状态为 $x_{current}$。在使用它之前，检查数值不稳定性。如果一个状态太接近临界点 $0.5$（即 $|1 - 2x_{current}|  \\varepsilon_{\\text{crit}}$），或者它位于或太接近区间端点，则认为该状态是不稳定的。\n    b. 如果状态不稳定，则通过添加一个小的抖动 $\\pm\\varepsilon_{\\text{jit}}$ 来扰动（替换）它。抖动的符号被选择为将状态推离区间中心。然后将扰动后的状态限制在 $[\\varepsilon_{\\text{end}}, 1 - \\varepsilon_{\\text{end}}]$ 内。这个新的、安全的状态将替换旧状态用于当前步骤中的所有后续计算。\n    c. 使用（可能被扰动的）状态计算导数项 $\\ln|r(1-2x)|$ 并将其加到 `lyapunov_sum`。\n    d. 使用（可能被扰动的）状态作为输入，为下一步迭代映射 $x \\leftarrow r x (1 - x)$。\n    e. 将映射迭代的结果限制在 $[\\varepsilon_{\\text{end}}, 1 - \\varepsilon_{\\text{end}}]$ 内。\n5. 循环结束后，LLE 的估计值计算为 $\\hat{\\lambda} = \\text{lyapunov\\_sum} / N$。\n6. 此过程应用于指定的五个测试用例中的每一个，并将结果四舍五入到 $6$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the largest Lyapunov exponent for the logistic map\n    for a suite of test cases and prints the results in the specified format.\n    \"\"\"\n    # Define constants for numerical stability from the problem statement.\n    EPS_CRIT = 1.0e-14\n    EPS_JIT = 1.0e-12\n    EPS_END = 1.0e-15\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (fully developed chaos)\n        {'r': 4.0, 'x0': 0.123456789, 'M': 1000, 'N': 200000},\n        # Case B (critical point initial condition)\n        {'r': 4.0, 'x0': 0.5, 'M': 1000, 'N': 200000},\n        # Case C (periodic window)\n        {'r': 3.2, 'x0': 0.1, 'M': 1000, 'N': 200000},\n        # Case D (onset of chaos)\n        {'r': 3.569945672, 'x0': 0.1, 'M': 2000, 'N': 200000},\n        # Case E (chaotic banded attractor)\n        {'r': 3.75, 'x0': 0.1, 'M': 1000, 'N': 200000},\n    ]\n\n    def calculate_lle(r, x0, M, N):\n        \"\"\"\n        Estimates the Largest Lyapunov Exponent (LLE) for the logistic map.\n\n        Args:\n            r (float): The parameter of the logistic map.\n            x0 (float): The initial condition.\n            M (int): The number of burn-in (transient) iterations.\n            N (int): The number of iterations for averaging.\n\n        Returns:\n            float: The estimated LLE.\n        \"\"\"\n        x = float(x0)\n\n        # Burn-in phase to allow the trajectory to settle on the attractor.\n        # After each map iteration, the state is clamped to avoid rounding\n        # into exact endpoints.\n        for _ in range(M):\n            x = r * x * (1.0 - x)\n            x = max(EPS_END, min(1.0 - EPS_END, x))\n\n        lyapunov_sum = 0.0\n\n        # Averaging phase to compute the LLE.\n        for _ in range(N):\n            # Check for singular or near-singular conditions before evaluation.\n            # This includes being too close to the critical point (x=0.5)\n            # or the interval endpoints.\n            if (abs(1.0 - 2.0 * x)  EPS_CRIT) or \\\n               (x = EPS_END) or (x >= 1.0 - EPS_END):\n                \n                # Perturb the state to avoid singularity.\n                # The sign of the jitter is chosen to push the state away\n                # from the center (0.5).\n                sign_val = np.sign(0.5 - x)\n                if sign_val == 0.0:\n                    sign_val = 1.0  # Handle exact x=0.5 case by picking a direction.\n                \n                x += sign_val * EPS_JIT\n                \n                # Clamp the perturbed state back into the safe interval.\n                x = max(EPS_END, min(1.0 - EPS_END, x))\n\n            # Add the log of the absolute value of the derivative to the sum.\n            # This uses the (potentially perturbed) state x.\n            lyapunov_sum += np.log(abs(r * (1.0 - 2.0 * x)))\n\n            # Iterate the map for the next step using the (potentially perturbed) state.\n            x = r * x * (1.0 - x)\n            \n            # Clamp the result of the map iteration to stay within the safe interval.\n            x = max(EPS_END, min(1.0 - EPS_END, x))\n\n        # The LLE is the average of the logged values.\n        return lyapunov_sum / N\n\n    results = []\n    for case in test_cases:\n        lle = calculate_lle(case['r'], case['x0'], case['M'], case['N'])\n        # Format the result to 6 decimal places as a string.\n        results.append(f\"{lle:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}