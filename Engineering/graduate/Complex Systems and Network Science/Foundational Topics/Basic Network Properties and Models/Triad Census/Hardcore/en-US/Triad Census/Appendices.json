{
    "hands_on_practices": [
        {
            "introduction": "Before we can identify \"significant\" patterns in real networks, we must first understand what to expect from a purely random process. This exercise builds this foundational understanding by deriving the expected frequency of specific triads in the classic directed Erdős–Rényi random graph, $G_{n,p}$. By applying principles of symmetry and linearity of expectation, you will develop the analytical skills needed to establish a baseline for network motif analysis .",
            "id": "4312773",
            "problem": "Consider the directed Erdős–Rényi (ER) random graph $G_{n,p}$ on $n$ labeled vertices, where every ordered pair of distinct vertices $(i,j)$ with $i \\neq j$ is included as a directed edge (arc) $i \\to j$ independently with probability $p \\in (0,1)$. In the directed triad census, the class $021\\mathrm{D}$ consists of induced triads on three vertices that contain exactly two arcs, both emanating from the same vertex to the other two (an out-star), with no other arcs among the three; the class $021\\mathrm{U}$ consists of induced triads that contain exactly two arcs, both pointing into the same vertex from the other two (an in-star), with no other arcs among the three. Let $X_{021\\mathrm{D}}$ and $X_{021\\mathrm{U}}$ denote the random variables counting the number of induced subgraphs on triples of vertices in $G_{n,p}$ that are isomorphic to $021\\mathrm{D}$ and $021\\mathrm{U}$, respectively.\n\nStarting from the symmetry of the ER model under edge-orientation reversal and the independence of edges, show that $\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}[X_{021\\mathrm{U}}]$, and derive their common expected value as a closed-form analytic expression in $n$ and $p$. Express your final answer as a single symbolic expression. No numerical approximation is required.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Graph Model**: Directed Erdős–Rényi random graph $G_{n,p}$ on $n$ labeled vertices.\n- **Edge Rule**: An arc $i \\to j$ for any ordered pair of distinct vertices $(i,j)$ exists independently with probability $p \\in (0,1)$.\n- **Triad Class $021\\mathrm{D}$**: An induced subgraph on three vertices with exactly two arcs, which form an out-star (e.g., $i \\to j$, $i \\to k$, and no other arcs between $i,j,k$).\n- **Triad Class $021\\mathrm{U}$**: An induced subgraph on three vertices with exactly two arcs, which form an in-star (e.g., $j \\to i$, $k \\to i$, and no other arcs between $i,j,k$).\n- **Random Variables**: $X_{021\\mathrm{D}}$ and $X_{021\\mathrm{U}}$ are the respective counts of these induced subgraphs.\n- **Objective**:\n    1. Show that $\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}[X_{021\\mathrm{U}}]$ using symmetry.\n    2. Derive this common expected value as a closed-form expression in $n$ and $p$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is set within the established mathematical framework of random graph theory. The model ($G_{n,p}$), the objects of study (triad census), and the goal (calculating an expected value) are all standard and well-defined in complex systems and network science. The definitions for the triad classes $021\\mathrm{D}$ and $021\\mathrm{U}$ are precise and standard. The problem is self-contained, with all necessary parameters ($n, p$) and definitions provided. There are no contradictions, ambiguities, or violations of scientific principles.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe solution is divided into two parts as requested by the problem statement.\n\n**Part 1: Proof of Equality of Expectations using Symmetry**\n\nLet $G = (V, E)$ be a realization of the directed Erdős–Rényi random graph $G_{n,p}$, where $V$ is the set of $n$ vertices and $E$ is the set of directed edges (arcs). For any ordered pair of distinct vertices $(i,j)$, the probability that the arc $i \\to j$ is in $E$ is $P(i \\to j \\in E) = p$, independently for all pairs.\n\nConsider a graph transformation that reverses the direction of every arc. Let $G' = (V, E')$ be the graph where an arc $j \\to i$ is in $E'$ if and only if the arc $i \\to j$ is in $E$. The probability of any specific arc configuration in $G'$ can be related to the probability of the corresponding reversed configuration in $G$.\n\nThe probability that an arc $j \\to i$ exists in $G'$ is $P(j \\to i \\in E') = P(i \\to j \\in E) = p$. Since the choices for arcs in $G$ are independent, the choices for arcs in $G'$ are also independent. Therefore, the reversed graph $G'$ is also a realization from the same random graph ensemble $G_{n,p}$. This means the probability distribution over the space of all possible graphs is identical for $G$ and $G'$. Consequently, the expectation of any graph property is the same for both distributions.\n\nNow, consider the relationship between triad types under this reversal transformation. Let a set of three vertices $\\{u,v,w\\}$ form an induced subgraph of type $021\\mathrm{D}$ in $G$. Without loss of generality, let $u$ be the center, so the arcs are $u \\to v$ and $u \\to w$. By definition of an induced subgraph, there are no other arcs among these three vertices. When we reverse all arcs to obtain $G'$, the arcs on this specific triplet become $v \\to u$ and $w \\to u$, with no other arcs present between them. This configuration is precisely an induced subgraph of type $021\\mathrm{U}$ in $G'$, with $u$ as the center.\n\nThis establishes a one-to-one correspondence: every induced triad of type $021\\mathrm{D}$ in an instance $G$ corresponds to exactly one induced triad of type $021\\mathrm{U}$ in the reversed instance $G'$. Therefore, the number of $021\\mathrm{D}$ triads in $G$, denoted by $X_{021\\mathrm{D}}(G)$, is equal to the number of $021\\mathrm{U}$ triads in $G'$, denoted by $X_{021\\mathrm{U}}(G')$. We have $X_{021\\mathrm{D}}(G) = X_{021\\mathrm{U}}(G')$.\n\nSince $G$ and $G'$ are drawn from the same probability distribution, the expectation of any random variable defined on them is the same. Thus,\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}_G[X_{021\\mathrm{D}}(G)] = \\mathbb{E}_{G'}[X_{021\\mathrm{U}}(G')] = \\mathbb{E}[X_{021\\mathrm{U}}]\n$$\nThis demonstrates that the expected counts of $021\\mathrm{D}$ and $021\\mathrm{U}$ triads are equal.\n\n**Part 2: Derivation of the Common Expected Value**\n\nWe will calculate the expected value $\\mathbb{E}[X_{021\\mathrm{D}}]$. The result for $\\mathbb{E}[X_{021\\mathrm{U}}]$ will be identical.\n\nWe use the method of indicator variables and linearity of expectation. Let the set of vertices be $V = \\{1, 2, \\dots, n\\}$. Let $\\mathcal{T}$ be the set of all unordered triples of distinct vertices from $V$. The number of such triples is $|\\mathcal{T}| = \\binom{n}{3}$.\n\nFor each triple of vertices $T = \\{i, j, k\\} \\in \\mathcal{T}$, let $I_T$ be an indicator random variable such that $I_T = 1$ if the induced subgraph on the vertices $\\{i,j,k\\}$ is of type $021\\mathrm{D}$, and $I_T = 0$ otherwise.\n\nThe total number of $021\\mathrm{D}$ triads is the sum of these indicators over all possible triples:\n$$\nX_{021\\mathrm{D}} = \\sum_{T \\in \\mathcal{T}} I_T\n$$\nBy linearity of expectation, the expected value is:\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}\\left[\\sum_{T \\in \\mathcal{T}} I_T\\right] = \\sum_{T \\in \\mathcal{T}} \\mathbb{E}[I_T]\n$$\nThe expectation of an indicator variable is the probability of the event it indicates: $\\mathbb{E}[I_T] = P(I_T = 1)$. Due to the symmetry of the $G_{n,p}$ model, this probability is the same for all triples $T$. Let's calculate this probability for a generic triple $\\{i, j, k\\}$.\n\nFor the induced subgraph on $\\{i, j, k\\}$ to be of type $021\\mathrm{D}$, one vertex must be the \"source\" of two arcs, and no other arcs may exist between the three vertices. There are $3$ choices for which vertex acts as the source.\nLet's first assume vertex $i$ is the source. This requires the following arc configuration:\n1. Arc $i \\to j$ must exist. The probability is $p$.\n2. Arc $i \\to k$ must exist. The probability is $p$.\n3. Arc $j \\to i$ must *not* exist. The probability is $1-p$.\n4. Arc $k \\to i$ must *not* exist. The probability is $1-p$.\n5. Arc $j \\to k$ must *not* exist. The probability is $1-p$.\n6. Arc $k \\to j$ must *not* exist. The probability is $1-p$.\n\nThere are $\\binom{3}{2} \\times 2 = 6$ possible directed arcs among $3$ vertices. For the specific case of an induced $021\\mathrm{D}$ triad centered at $i$, exactly $2$ of these $6$ potential arcs must be present, and the other $4$ must be absent. Since the existence of each arc is an independent event, the probability of this specific configuration (with $i$ as the center) is the product of the individual probabilities:\n$$\nP(\\text{center is } i) = p \\cdot p \\cdot (1-p) \\cdot (1-p) \\cdot (1-p) \\cdot (1-p) = p^2 (1-p)^4\n$$\nThe three events \"center is $i$\", \"center is $j$\", and \"center is $k$\" are mutually exclusive for the induced subgraph on $\\{i,j,k\\}$. For example, if the center is $i$, arc $j \\to i$ must be absent; if the center were $j$, arc $j \\to i$ would have to be present. Therefore, the total probability that the triple $\\{i, j, k\\}$ forms a $021\\mathrm{D}$ triad is the sum of the probabilities of these three configurations:\n$$\nP(I_T=1) = P(\\text{center is } i) + P(\\text{center is } j) + P(\\text{center is } k) = 3 p^2 (1-p)^4\n$$\nNow we can compute the total expectation:\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\sum_{T \\in \\mathcal{T}} P(I_T=1) = |\\mathcal{T}| \\times (3 p^2 (1-p)^4)\n$$\nSubstituting $|\\mathcal{T}| = \\binom{n}{3}$:\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\binom{n}{3} \\cdot 3 p^2 (1-p)^4\n$$\nExpanding the binomial coefficient $\\binom{n}{3} = \\frac{n(n-1)(n-2)}{3 \\cdot 2 \\cdot 1} = \\frac{n(n-1)(n-2)}{6}$:\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\frac{n(n-1)(n-2)}{6} \\cdot 3 p^2 (1-p)^4 = \\frac{n(n-1)(n-2)}{2} p^2 (1-p)^4\n$$\nThis is the common expected value for both $X_{021\\mathrm{D}}$ and $X_{021\\mathrm{U}}$.",
            "answer": "$$\n\\boxed{\\frac{n(n-1)(n-2)}{2} p^2 (1-p)^4}\n$$"
        },
        {
            "introduction": "The core of network motif analysis is comparing observed subgraph counts to those expected under a suitable null model. This practice problem presents a hypothetical scenario to demonstrate a crucial lesson: the choice of null model can dramatically alter our conclusions about whether a pattern is statistically significant. By calculating the expected count of feed-forward loops under two different null models, you will gain hands-on experience with the quantitative reasoning that underpins the discovery of network motifs .",
            "id": "4312795",
            "problem": "Consider a directed simple network on $n=60$ vertices. The triad census counts the number of isomorphism classes of $3$-node subgraphs in a directed network. A feed-forward loop (FFL) triad is the transitive directed triad on three nodes with arcs $A \\to B$, $A \\to C$, and $B \\to C$ and no reciprocal arcs; in standard triad census notation this is the class often denoted $030\\mathrm{T}$. You are given the following global statistics for the network:\n- The marginal probability that an arc exists for any ordered pair of distinct nodes is $p=0.25$, so the expected number of arcs per unordered dyad (pair of nodes) is $d=2p=0.5$.\n- The dyad-state distribution across unordered pairs is: mutual dyad probability $m=0.18$ (both directions present), asymmetric dyad probability $a=0.14$ (exactly one direction present), and null dyad probability $u=0.68$ (no arcs in either direction), so that $2m+a=d$ is satisfied.\n- The observed number of FFL triads is $T_{\\mathrm{obs}}=300$.\n\nTwo null models are considered:\n- Null $\\mathcal{N}_1$: The directed Erdős–Rényi (ER) model, where each possible ordered arc is present independently with probability $p$, and dyad states emerge from independent arcs.\n- Null $\\mathcal{N}_2$: A reciprocity-preserving dyadic independent model, where each unordered dyad is independently assigned a state with probabilities $m$, $a$, $u$, and for asymmetric dyads the orientation is equally likely in either direction for each dyad and independent across dyads.\n\nStarting only from the core definitions of the triad census, independence in the null models, and elementary probability, derive the expected probability that a given triple of distinct nodes forms an FFL triad under each null model and hence the expected number of FFL triads. Use these to assess whether the FFL is over-represented or under-represented compared to each null. To make the assessment quantitative, approximate the variance of the triad count under each null by treating distinct node triples as independent Bernoulli trials with the derived FFL probability, and compute the corresponding $z$-scores $z=(T_{\\mathrm{obs}}-\\mathbb{E}[T])/\\sqrt{\\mathrm{Var}(T)}$.\n\nWhich option correctly gives the expected counts, the representation assessments, and demonstrates that an inappropriate null (here, $\\mathcal{N}_1$) can invert the sign of over-/under-representation relative to a more appropriate null ($\\mathcal{N}_2$)?\n\nA. Under $\\mathcal{N}_1$ with $p=0.25$, the expected FFL count is $\\binom{60}{3}\\cdot 6p^3(1-p)^3\\approx 1353$, giving under-representation with $z\\approx -29$. Under $\\mathcal{N}_2$ with $a=0.14$, the expected FFL count is $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^3\\approx 70$, giving over-representation with $z\\approx 27$, thereby inverting the sign across the two nulls.\n\nB. Under $\\mathcal{N}_1$, the expected FFL count is $\\binom{60}{3}\\cdot p^3(1-p)^3\\approx 226$, and under $\\mathcal{N}_2$ it is $\\binom{60}{3}\\cdot \\tfrac{1}{2}a^3\\approx 130$; in both cases the FFL is over-represented relative to expectation.\n\nC. Under $\\mathcal{N}_1$, the expected FFL count is $\\binom{60}{3}\\cdot 2p^3(1-p)^3\\approx 451$, while under $\\mathcal{N}_2$ it is $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^2\\approx 504$; in both cases the FFL is under-represented.\n\nD. The expected probability of an FFL is independent of reciprocity and equals $6p^3(1-p)^3$ under any null matching $p$; with $T_{\\mathrm{obs}}=300$ it is under-represented under both nulls.",
            "solution": "The user wants me to analyze a problem concerning the feed-forward loop (FFL) triad motif in a directed network. I will first validate the problem statement and then, if valid, proceed to the full derivation and evaluation of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- Network type: Directed simple network\n- Number of vertices: $n=60$\n- Motif of interest: Feed-forward loop (FFL), a transitive directed triad with arcs $A \\to B$, $A \\to C$, and $B \\to C$, and no reciprocal arcs. This corresponds to the triad isomorphism class $030\\mathrm{T}$.\n- Global network statistics:\n    - Marginal arc probability: $p=0.25$\n    - Expected number of arcs per unordered dyad: $d=2p=0.5$\n    - Dyad-state probabilities for an unordered pair of nodes:\n        - Mutual dyad probability ($m$): $m=0.18$\n        - Asymmetric dyad probability ($a$): $a=0.14$\n        - Null dyad probability ($u$): $u=0.68$\n    - Consistency check provided: $2m+a = 2(0.18) + 0.14 = 0.36 + 0.14 = 0.50 = d$, which is satisfied. Also, the probabilities sum to unity: $m+a+u = 0.18+0.14+0.68=1.0$.\n- Observed number of FFL triads: $T_{\\mathrm{obs}}=300$\n- Null Models for comparison:\n    - $\\mathcal{N}_1$: The directed Erdős–Rényi (ER) model where each of the $n(n-1)$ possible directed arcs is present independently with probability $p=0.25$.\n    - $\\mathcal{N}_2$: A reciprocity-preserving dyadic independent model where each of the $\\binom{n}{2}$ unordered dyads is independently assigned a state (mutual, asymmetric, null) with probabilities $m, a, u$. For asymmetric dyads, the direction of the single arc is chosen with probability $1/2$ for each of the two possibilities.\n- Task: Derive the expected number of FFLs, $\\mathbb{E}[T]$, under each null model. Assess over/under-representation of the FFL motif by calculating the $z$-score, $z=(T_{\\mathrm{obs}}-\\mathbb{E}[T])/\\sqrt{\\mathrm{Var}(T)}$, using the approximation that distinct node triples are independent Bernoulli trials.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is firmly rooted in network science, specifically in the area of network motif analysis. The concepts of triad census, FFLs, Erdős–Rényi models, and configuration models (like $\\mathcal{N}_2$) are standard in the field.\n- **Well-Posed:** The problem is well-posed. All necessary parameters ($n, p, m, a, u, T_{\\mathrm{obs}}$) are provided, and the null models are defined precisely. The task asks for specific, calculable quantities.\n- **Objective:** The language is objective and technical.\n- **Consistency:** The provided numerical values ($p, m, a, u$) are internally consistent as shown in Step 1.\n- **Flaw Check:** The problem does not violate any of the invalidity criteria. It is a standard, non-trivial exercise in probabilistic network analysis that highlights the crucial role of null model selection.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. I will proceed with the derivation.\n\n### Derivation and Solution\n\nThe total number of distinct triples of nodes in the network is $N_{triples} = \\binom{n}{3}$. With $n=60$, this is:\n$$ \\binom{60}{3} = \\frac{60 \\times 59 \\times 58}{3 \\times 2 \\times 1} = 10 \\times 59 \\times 58 = 34220 $$\n\nAn FFL is a specific type of induced subgraph on three nodes. The problem defines it as the transitive directed triad of class $030\\mathrm{T}$, which means there are exactly three directed edges forming a transitive pattern (e.g., $A \\to B, B \\to C, A \\to C$) and no other edges between the three nodes. This implies the three dyads connecting the nodes must all be asymmetric.\n\n**Analysis under Null Model $\\mathcal{N}_1$ (Directed ER Model)**\n\nUnder $\\mathcal{N}_1$, each of the $n(n-1)$ possible directed arcs exists independently with probability $p=0.25$. For a given triple of distinct nodes, say $\\{V_1, V_2, V_3\\}$, there are $2\\binom{3}{2}=6$ possible directed arcs.\n\nTo form an FFL, we need exactly $3$ arcs in a transitive pattern, and the other $3$ potential arcs must be absent. Let's consider a specific FFL configuration, e.g., $V_1 \\to V_2, V_1 \\to V_3, V_2 \\to V_3$. This requires the following six independent events:\n1. Arc $V_1 \\to V_2$ exists (probability $p$)\n2. Arc $V_2 \\to V_1$ is absent (probability $1-p$)\n3. Arc $V_1 \\to V_3$ exists (probability $p$)\n4. Arc $V_3 \\to V_1$ is absent (probability $1-p$)\n5. Arc $V_2 \\to V_3$ exists (probability $p$)\n6. Arc $V_3 \\to V_2$ is absent (probability $1-p$)\n\nThe probability of this specific configuration is $p^3(1-p)^3$.\n\nFor any given triple of nodes, there are multiple ways to form an FFL. An FFL has a unique \"source\" node (out-degree $2$), \"intermediate\" node (in-degree $1$, out-degree $1$), and \"sink\" node (in-degree $2$). We can choose the source from the $3$ nodes, the sink from the remaining $2$, and the last one is the intermediate. This gives $3 \\times 2 \\times 1 = 3! = 6$ possible, mutually exclusive FFL configurations on a labeled triple.\n\nThe probability, $P_{FFL}(\\mathcal{N}_1)$, that a randomly chosen triple of nodes forms an FFL is the sum of the probabilities of these $6$ configurations:\n$$ P_{FFL}(\\mathcal{N}_1) = 6 \\cdot p^3(1-p)^3 $$\nThe expected number of FFLs, $\\mathbb{E}[T_{\\mathcal{N}_1}]$, is the total number of triples multiplied by this probability:\n$$ \\mathbb{E}[T_{\\mathcal{N}_1}] = \\binom{n}{3} \\cdot 6 p^3(1-p)^3 $$\nUsing the given values $n=60$ and $p=0.25$:\n$$ \\mathbb{E}[T_{\\mathcal{N}_1}] = 34220 \\cdot 6 \\cdot (0.25)^3 (1-0.25)^3 = 34220 \\cdot 6 \\cdot \\left(\\frac{1}{4}\\right)^3 \\left(\\frac{3}{4}\\right)^3 = 34220 \\cdot 6 \\cdot \\frac{27}{4096} = 34220 \\cdot \\frac{162}{4096} \\approx 1353.18 $$\nThe observed count is $T_{\\mathrm{obs}}=300$, which is much lower than the expected count $\\approx 1353$. Thus, the FFL is **under-represented** relative to $\\mathcal{N}_1$.\n\nTo calculate the $z$-score, we approximate the variance as $\\mathrm{Var}(T) \\approx N_{triples} P_{FFL} (1-P_{FFL}) \\approx \\mathbb{E}[T] (1-P_{FFL})$.\n$$ P_{FFL}(\\mathcal{N}_1) = 6 \\cdot \\frac{27}{4096} \\approx 0.03955 $$\n$$ \\mathrm{Var}(T_{\\mathcal{N}_1}) \\approx 1353.18 \\cdot (1 - 0.03955) \\approx 1299.66 $$\n$$ \\sigma_{\\mathcal{N}_1} = \\sqrt{\\mathrm{Var}(T_{\\mathcal{N}_1})} \\approx \\sqrt{1299.66} \\approx 36.05 $$\nThe z-score is:\n$$ z_1 = \\frac{T_{\\mathrm{obs}} - \\mathbb{E}[T_{\\mathcal{N}_1}]}{\\sigma_{\\mathcal{N}_1}} \\approx \\frac{300 - 1353.18}{36.05} \\approx -29.21 $$\n\n**Analysis under Null Model $\\mathcal{N}_2$ (Reciprocity-Preserving Dyadic Model)**\n\nUnder $\\mathcal{N}_2$, the states of the three dyads connecting the nodes $\\{V_1, V_2, V_3\\}$ are independent. For an FFL to form, all three dyads must be asymmetric. The probability for a single dyad to be asymmetric is $a=0.14$. The probability for all three to be asymmetric is $a^3$.\n\nGiven that the three dyads are asymmetric, we need to find the probability that their orientations form a transitive pattern (an FFL) rather than a cyclic one. For each asymmetric dyad, there are two possible orientations, each with probability $1/2$. Thus for three dyads, there are $2^3 = 8$ equally likely orientation patterns.\nThese 8 patterns correspond to the edge sets of all possible tournaments on 3 labeled vertices. There are two cyclic tournaments ($V_1 \\to V_2 \\to V_3 \\to V_1$ and $V_1 \\to V_3 \\to V_2 \\to V_1$) and $8-2=6$ transitive tournaments (FFLs).\nTherefore, the conditional probability of forming an FFL, given three asymmetric dyads, is $6/8 = 3/4$.\n\nThe probability, $P_{FFL}(\\mathcal{N}_2)$, that a randomly chosen triple of nodes forms an FFL is:\n$$ P_{FFL}(\\mathcal{N}_2) = P(\\text{all 3 dyads are asymmetric}) \\times P(\\text{pattern is transitive} | \\text{3 asymmetric dyads}) $$\n$$ P_{FFL}(\\mathcal{N}_2) = a^3 \\cdot \\frac{3}{4} $$\nThe expected number of FFLs, $\\mathbb{E}[T_{\\mathcal{N}_2}]$, is:\n$$ \\mathbb{E}[T_{\\mathcal{N}_2}] = \\binom{n}{3} \\cdot \\frac{3}{4} a^3 $$\nUsing the given values $n=60$ and $a=0.14$:\n$$ \\mathbb{E}[T_{\\mathcal{N}_2}] = 34220 \\cdot \\frac{3}{4} \\cdot (0.14)^3 = 34220 \\cdot 0.75 \\cdot 0.002744 \\approx 70.42 $$\nThe observed count is $T_{\\mathrm{obs}}=300$, which is much higher than the expected count $\\approx 70$. Thus, the FFL is **over-represented** relative to $\\mathcal{N}_2$.\n\nTo calculate the $z$-score, we again approximate the variance:\n$$ P_{FFL}(\\mathcal{N}_2) = 0.75 \\cdot (0.14)^3 \\approx 0.002058 $$\n$$ \\mathrm{Var}(T_{\\mathcal{N}_2}) \\approx 70.42 \\cdot (1 - 0.002058) \\approx 70.27 $$\n$$ \\sigma_{\\mathcal{N}_2} = \\sqrt{\\mathrm{Var}(T_{\\mathcal{N}_2})} \\approx \\sqrt{70.27} \\approx 8.38 $$\nThe z-score is:\n$$ z_2 = \\frac{T_{\\mathrm{obs}} - \\mathbb{E}[T_{\\mathcal{N}_2}]}{\\sigma_{\\mathcal{N}_2}} \\approx \\frac{300 - 70.42}{8.38} \\approx 27.39 $$\n\n**Conclusion and Option Evaluation**\n\n- Under $\\mathcal{N}_1$, $\\mathbb{E}[T] \\approx 1353$ and $z \\approx -29$, indicating significant under-representation.\n- Under $\\mathcal{N}_2$, $\\mathbb{E}[T] \\approx 70$ and $z \\approx 27$, indicating significant over-representation.\n- The choice of null model inverts the conclusion about motif significance. $\\mathcal{N}_1$ is a poor null because it does not match the observed dyad census (e.g., it predicts reciprocity $m=p^2=0.0625$, far from the observed $m=0.18$). $\\mathcal{N}_2$ is more appropriate as it preserves the dyadic structure by construction.\n\nNow I will evaluate each option.\n\n**A. Under $\\mathcal{N}_1$ with $p=0.25$, the expected FFL count is $\\binom{60}{3}\\cdot 6p^3(1-p)^3\\approx 1353$, giving under-representation with $z\\approx -29$. Under $\\mathcal{N}_2$ with $a=0.14$, the expected FFL count is $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^3\\approx 70$, giving over-representation with $z\\approx 27$, thereby inverting the sign across the two nulls.**\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_1}]$ is correct. The calculated value $\\approx 1353$ is correct. The assessment of under-representation and $z \\approx -29$ are correct.\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_2}]$ is correct. The calculated value $\\approx 70$ is correct. The assessment of over-representation and $z \\approx 27$ are correct.\n- The observation that the sign of representation is inverted is correct.\n- **Verdict: Correct.**\n\n**B. Under $\\mathcal{N}_1$, the expected FFL count is $\\binom{60}{3}\\cdot p^3(1-p)^3\\approx 226$, and under $\\mathcal{N}_2$ it is $\\binom{60}{3}\\cdot \\tfrac{1}{2}a^3\\approx 130$; in both cases the FFL is over-represented relative to expectation.**\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_1}]$ is incorrect; it is missing the combinatorial factor of $6$.\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_2}]$ is incorrect; it uses a factor of $1/2$ instead of the correct $3/4$.\n- The conclusion that the FFL is over-represented in both cases is incorrect (it is under-represented for $\\mathcal{N}_1$).\n- **Verdict: Incorrect.**\n\n**C. Under $\\mathcal{N}_1$, the expected FFL count is $\\binom{60}{3}\\cdot 2p^3(1-p)^3\\approx 451$, while under $\\mathcal{N}_2$ it is $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^2\\approx 504$; in both cases the FFL is under-represented.**\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_1}]$ is incorrect; it uses a factor of $2$ instead of $6$.\n- The formula for $\\mathbb{E}[T_{\\mathcal{N}_2}]$ is incorrect; it uses $a^2$ instead of $a^3$.\n- The conclusion that the FFL is under-represented in both cases is incorrect (it is over-represented for $\\mathcal{N}_2$).\n- **Verdict: Incorrect.**\n\n**D. The expected probability of an FFL is independent of reciprocity and equals $6p^3(1-p)^3$ under any null matching $p$; with $T_{\\mathrm{obs}}=300$ it is under-represented under both nulls.**\n- The claim that the probability is independent of the reciprocity structure of the null model is false. Our derivation explicitly shows two different probabilities for $\\mathcal{N}_1$ and $\\mathcal{N}_2$, even though both models are constrained by the same empirical arc density $p$ (since $d=2p$ is consistent with $m, a, u$).\n- The conclusion that it is under-represented under both nulls is false.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from theory to practice, performing a triad census on a real network requires a robust algorithm to classify each of the potentially billions of triads into its correct isomorphism class. This exercise challenges you to develop such an algorithm by identifying a set of isomorphism-invariant features—properties like node degrees and dyad mutuality that are independent of arbitrary node labels. This task is a critical step in translating abstract graph theory into a functional computational tool for network analysis .",
            "id": "4312800",
            "problem": "Consider a directed simple graph on a fixed set of $3$ labeled nodes, with no self-loops and at most one directed edge between any ordered pair of distinct nodes. The induced subgraph on these $3$ nodes can be classified into one of the $16$ isomorphism classes of the triad census, traditionally denoted by the names $\\{003, 012, 102, 021D, 021U, 021C, 111D, 111U, 030T, 030C, 201, 120D, 120U, 120C, 210, 300\\}$. The task is to construct an algorithm that classifies any given $3$-node induced directed subgraph into one of these $16$ classes using only node in-degrees, node out-degrees, and mutuality indicators for unordered node pairs. \n\nFundamental base. Use the following core definitions and facts from graph theory as the foundational starting point:\n- A directed simple graph $G = (V, E)$ has a finite set of nodes $V$ and a set of directed edges $E \\subseteq V \\times V$, with no self-loops and at most one edge in each direction between distinct nodes.\n- For a node $i \\in V$, the in-degree $d_i^{in}$ is the number of edges of the form $(j, i) \\in E$, and the out-degree $d_i^{out}$ is the number of edges of the form $(i, j) \\in E$.\n- For any unordered pair $\\{i,j\\}$ of distinct nodes, define the mutuality indicator $M_{ij}$ as $1$ if both $(i,j) \\in E$ and $(j,i) \\in E$, and $0$ otherwise.\n- For a $3$-node induced subgraph, there are $3$ unordered pairs (dyads). Each dyad is either null (no edges in either direction), asymmetric (exactly one directed edge exists), or mutual (both directed edges exist). Let $m$ denote the number of mutual dyads, $a$ denote the number of asymmetric dyads, and $n$ denote the number of null dyads. Then $m + a + n = 3$. The total number of directed edges $|E|$ satisfies $$|E| = \\sum_{i=1}^{3} d_i^{out} = \\sum_{i=1}^{3} d_i^{in} = 2m + a$$, since each mutual dyad contributes $2$ directed edges and each asymmetric dyad contributes $1$ directed edge.\n\nDesign objective. Derive, from the above base, a complete decision procedure that uses only the per-node degree pairs $\\{(d_i^{in}, d_i^{out})\\}_{i=1}^{3}$ and the mutuality indicators $\\{M_{ij}\\}$ for the $3$ unordered pairs to identify the unique triad census class of the $3$-node induced subgraph. The classification must be isomorphism-invariant with respect to node labels.\n\nOutput specification. Encode the $16$ triad classes by integer identifiers according to the following mapping:\n- $003 \\mapsto 0$\n- $012 \\mapsto 1$\n- $102 \\mapsto 2$\n- $021D \\mapsto 3$\n- $021U \\mapsto 4$\n- $021C \\mapsto 5$\n- $111D \\mapsto 6$\n- $111U \\mapsto 7$\n- $030T \\mapsto 8$\n- $030C \\mapsto 9$\n- $201 \\mapsto 10$\n- $120D \\mapsto 11$\n- $120U \\mapsto 12$\n- $120C \\mapsto 13$\n- $210 \\mapsto 14$\n- $300 \\mapsto 15$\n\nYour program must implement the classification algorithm and apply it to the following test suite of $16$ induced subgraphs, each specified by its set of directed edges on nodes $\\{1,2,3\\}$:\n- Test $1$: $\\varnothing$.\n- Test $2$: $\\{(1,2)\\}$.\n- Test $3$: $\\{(1,2),(2,1)\\}$.\n- Test $4$: $\\{(1,2),(1,3)\\}$.\n- Test $5$: $\\{(2,1),(3,1)\\}$.\n- Test $6$: $\\{(1,2),(2,3)\\}$.\n- Test $7$: $\\{(1,2),(2,1),(1,3)\\}$.\n- Test $8$: $\\{(1,2),(2,1),(3,1)\\}$.\n- Test $9$: $\\{(1,2),(1,3),(2,3)\\}$.\n- Test $10$: $\\{(1,2),(2,3),(3,1)\\}$.\n- Test $11$: $\\{(1,2),(2,1),(1,3),(3,1)\\}$.\n- Test $12$: $\\{(1,2),(2,1),(1,3),(2,3)\\}$.\n- Test $13$: $\\{(1,2),(2,1),(3,1),(3,2)\\}$.\n- Test $14$: $\\{(1,2),(2,1),(1,3),(3,2)\\}$.\n- Test $15$: $\\{(1,2),(2,1),(1,3),(3,1),(2,3)\\}$.\n- Test $16$: $\\{(1,2),(2,1),(1,3),(3,1),(2,3),(3,2)\\}$.\n\nRequired final output format. Your program should produce a single line of output containing the results as a comma-separated list of the $16$ integer identifiers, in the order of the tests $1$ through $16$, enclosed in square brackets (for example, $[r_1,r_2,\\dots,r_{16}]$). There are no physical units or angles in this problem. The program must run without any input and must not access external files or networks. The algorithm must use only the per-node degrees and mutuality indicators in its decision logic, as mandated above.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following data, definitions, and constraints for the classification of a $3$-node induced directed subgraph:\n- **Graph Structure**: The graph is a directed simple graph on a fixed set of $3$ labeled nodes. It has no self-loops and at most one directed edge between any ordered pair of distinct nodes.\n- **Node Set**: $V = \\{1, 2, 3\\}$.\n- **In-degree and Out-degree**: For a node $i \\in V$, the in-degree $d_i^{in}$ is the number of incoming edges, and the out-degree $d_i^{out}$ is the number of outgoing edges.\n- **Mutuality Indicator**: For any unordered pair of distinct nodes $\\{i,j\\}$, $M_{ij} = 1$ if both $(i,j)$ and $(j,i)$ are edges, and $M_{ij} = 0$ otherwise.\n- **Dyad Counts**: For the $3$ dyads (unordered pairs of nodes), $m$ is the number of mutual dyads, $a$ is the number of asymmetric dyads, and $n$ is the number of null dyads. These counts satisfy $m + a + n = 3$.\n- **Edge Count Relation**: The total number of directed edges $|E|$ is given by $|E| = \\sum_{i=1}^{3} d_i^{out} = \\sum_{i=1}^{3} d_i^{in} = 2m + a$.\n- **Design Objective**: The classification algorithm must use only the per-node degree pairs $\\{(d_i^{in}, d_i^{out})\\}_{i=1}^{3}$ and the mutuality indicators $\\{M_{ij}\\}$ for the $3$ unordered pairs. The classification must be isomorphism-invariant.\n- **Output Mapping**: A specific mapping from the $16$ triad census class names to integer identifiers $0$ through $15$ is provided.\n- **Test Suite**: A list of $16$ test cases, each defined by a set of directed edges on nodes $\\{1,2,3\\}$, is provided for verification.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria:\n\n1.  **Scientifically Grounded**: The problem is rooted in the established field of network science and graph theory, specifically concerning the triad census, a standard tool for network motif analysis developed by Holland and Leinhardt. All definitions (in-degree, out-degree, mutuality) are standard. The enumeration of $16$ isomorphism classes for $3$-node directed graphs is a foundational result in this area. The problem is scientifically sound.\n2.  **Well-Posed**: The problem asks for an algorithm to uniquely classify any $3$-node directed graph into one of $16$ distinct isomorphism classes. As will be shown, the provided information (degree pairs and mutuality indicators) is sufficient to construct a complete and unambiguous classification scheme. Thus, a unique and meaningful solution exists.\n3.  **Objective**: The problem is stated using precise, formal-mathematical language. All terms are well-defined, and the objective is clear and quantitative. There is no subjective or opinion-based content.\n4.  **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary definitions and constraints are provided. The definitions are internally consistent (e.g., the relation between edge count, degrees, and dyad counts holds).\n5.  **Unrealistic or Infeasible**: The problem deals with abstract mathematical objects (graphs) and does not involve physical constraints. The specified task is computationally feasible.\n6.  **Ill-Posed or Poorly Structured**: The problem is well-structured. The goal is to find an isomorphism-invariant classification, and the provided inputs (degrees and mutuality) are properties that can be used to construct such invariants.\n7.  **Pseudo-Profound, Trivial, or Tautological**: The problem addresses a non-trivial classification task. While the solution is systematic, it requires a careful derivation to demonstrate that the given informational basis is sufficient, which constitutes a valid conceptual exercise.\n8.  **Outside Scientific Verifiability**: The problem and its solution are entirely within the realm of mathematics and can be formally verified.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded, and formally specified task in graph theory. A solution will be provided.\n\n### Derivation of the Classification Algorithm\n\nThe objective is to create an isomorphism-invariant classification procedure for a $3$-node directed subgraph using only node degrees and dyad mutuality. An isomorphism-invariant property is one that is identical for all graphs in the same isomorphism class.\n\nLet the three nodes be $v_1, v_2, v_3$. The available information for classification is the set of degree pairs $\\{(d_1^{in}, d_1^{out}), (d_2^{in}, d_2^{out}), (d_3^{in}, d_3^{out})\\}$ and the set of mutuality indicators $\\{M_{12}, M_{13}, M_{23}\\}$.\n\nTo ensure isomorphism-invariance, we must use features that do not depend on the arbitrary labeling of the nodes. We can construct such features as follows:\n1.  **Total Mutuality ($m$)**: The number of mutual dyads, $m = \\sum_{\\{i,j\\}} M_{ij}$, is invariant under node relabeling.\n2.  **Sorted Degree Sequence**: The set of degree pairs is dependent on node labels. However, a sorted list of these pairs is an isomorphism-invariant. We will sort the list of pairs $(d_i^{in}, d_i^{out})$ lexicographically.\n\nThus, the unique signature for any triad class will be the tuple $(m, \\text{SortedDegreePairs})$. We will demonstrate that this signature uniquely identifies each of the $16$ triad classes.\n\nThe classification procedure is as follows:\n1.  Given the edge set of a $3$-node subgraph, calculate the in-degree and out-degree for each of the $3$ nodes.\n2.  Calculate the number of mutual dyads, $m$.\n3.  Form a list of the three $(d^{in}, d^{out})$ pairs and sort it lexicographically.\n4.  The combination of $m$ and the sorted list of degree pairs forms a unique key that maps directly to one of the $16$ triad classes.\n\nWe now systematically derive the signature for each of the $16$ classes. The classes are grouped by the number of mutual dyads $m \\in \\{0, 1, 2, 3\\}$.\n\n**Case $m=0$ (No mutual dyads)**\nThe total number of edges is $|E| = a$.\n-   **Class 003 (ID 0)**: $a=0, n=3 \\implies |E|=0$. All degrees are $(0,0)$.\n    -   Signature: $m=0$, Sorted Degrees: $((0,0), (0,0), (0,0))$.\n-   **Class 012 (ID 1)**: $a=1, n=2 \\implies |E|=1$. One edge $(v_1, v_2)$. Degrees: $d_1: (0,1)$, $d_2: (1,0)$, $d_3: (0,0)$.\n    -   Signature: $m=0$, Sorted Degrees: $((0,0), (0,1), (1,0))$.\n-   **Class 021 (IDs 3, 4, 5)**: $a=2, n=1 \\implies |E|=2$.\n    -   **021D (ID 3)**: \"Down\" configuration, e.g., $(v_1, v_2), (v_1, v_3)$. One source node. Degrees: $d_1: (0,2)$, $d_2: (1,0)$, $d_3: (1,0)$.\n        -   Signature: $m=0$, Sorted Degrees: $((0,2), (1,0), (1,0))$.\n    -   **021U (ID 4)**: \"Up\" configuration, e.g., $(v_2, v_1), (v_3, v_1)$. One sink node. Degrees: $d_1: (2,0)$, $d_2: (0,1)$, $d_3: (0,1)$.\n        -   Signature: $m=0$, Sorted Degrees: $((0,1), (0,1), (2,0))$.\n    -   **021C (ID 5)**: \"Cyclic\" path, e.g., $(v_1, v_2), (v_2, v_3)$. Degrees: $d_1: (0,1)$, $d_2: (1,1)$, $d_3: (1,0)$.\n        -   Signature: $m=0$, Sorted Degrees: $((0,1), (1,0), (1,1))$.\n-   **Class 030 (IDs 8, 9)**: $a=3, n=0 \\implies |E|=3$.\n    -   **030T (ID 8)**: Transitive tournament, e.g., $(v_1,v_2), (v_2,v_3), (v_1,v_3)$. Degrees: $d_1: (0,2)$, $d_2: (1,1)$, $d_3: (2,0)$.\n        -   Signature: $m=0$, Sorted Degrees: $((0,2), (1,1), (2,0))$.\n    -   **030C (ID 9)**: Cyclical tournament, e.g., $(v_1,v_2), (v_2,v_3), (v_3,v_1)$. Degrees: $d_1: (1,1)$, $d_2: (1,1)$, $d_3: (1,1)$.\n        -   Signature: $m=0$, Sorted Degrees: $((1,1), (1,1), (1,1))$.\n\n**Case $m=1$ (One mutual dyad)**\nThe total number of edges is $|E| = 2+a$.\n-   **Class 102 (ID 2)**: $a=0, n=2 \\implies |E|=2$. One mutual dyad, e.g., $(v_1,v_2), (v_2,v_1)$. Degrees: $d_1: (1,1)$, $d_2: (1,1)$, $d_3: (0,0)$.\n    -   Signature: $m=1$, Sorted Degrees: $((0,0), (1,1), (1,1))$.\n-   **Class 111 (IDs 6, 7)**: $a=1, n=1 \\implies |E|=3$.\n    -   **111D (ID 6)**: Mutual dyad + outgoing edge, e.g., $(v_1,v_2), (v_2,v_1), (v_1,v_3)$. Degrees: $d_1: (1,2)$, $d_2: (1,1)$, $d_3: (1,0)$.\n        -   Signature: $m=1$, Sorted Degrees: $((1,0), (1,1), (1,2))$.\n    -   **111U (ID 7)**: Mutual dyad + incoming edge, e.g., $(v_1,v_2), (v_2,v_1), (v_3,v_1)$. Degrees: $d_1: (2,1)$, $d_2: (1,1)$, $d_3: (0,1)$.\n        -   Signature: $m=1$, Sorted Degrees: $((0,1), (1,1), (2,1))$.\n-   **Class 120 (IDs 11, 12, 13)**: $a=2, n=0 \\implies |E|=4$.\n    -   **120D (ID 11)**: Mutual dyad + two outgoing edges, e.g., $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_2,v_3)$. Degrees: $d_1: (1,2)$, $d_2: (1,2)$, $d_3: (2,0)$.\n        -   Signature: $m=1$, Sorted Degrees: $((1,2), (1,2), (2,0))$.\n    -   **120U (ID 12)**: Mutual dyad + two incoming edges, e.g., $(v_1,v_2), (v_2,v_1), (v_3,v_1), (v_3,v_2)$. Degrees: $d_1: (2,1)$, $d_2: (2,1)$, $d_3: (0,2)$.\n        -   Signature: $m=1$, Sorted Degrees: $((0,2), (2,1), (2,1))$.\n    -   **120C (ID 13)**: Mutual dyad + path, e.g., $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_2)$. Degrees: $d_1: (1,2)$, $d_2: (2,1)$, $d_3: (1,1)$.\n        -   Signature: $m=1$, Sorted Degrees: $((1,1), (1,2), (2,1))$.\n\n**Case $m=2$ (Two mutual dyads)**\nThe total number of edges is $|E| = 4+a$.\n-   **Class 201 (ID 10)**: $a=0, n=1 \\implies |E|=4$. e.g., $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_1)$. Pivot node $v_1$. Degrees: $d_1: (2,2)$, $d_2: (1,1)$, $d_3: (1,1)$.\n    -   Signature: $m=2$, Sorted Degrees: $((1,1), (1,1), (2,2))$.\n-   **Class 210 (ID 14)**: $a=1, n=0 \\implies |E|=5$. Two mutual dyads + one asymmetric edge, e.g., $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_1), (v_2,v_3)$. Degrees: $d_1: (2,2)$, $d_2: (1,2)$, $d_3: (2,1)$.\n    -   Signature: $m=2$, Sorted Degrees: $((1,2), (2,1), (2,2))$.\n\n**Case $m=3$ (Three mutual dyads)**\n-   **Class 300 (ID 15)**: $a=0, n=0 \\implies |E|=6$. Complete directed graph. Degrees: $d_1, d_2, d_3$ are all $(2,2)$.\n    -   Signature: $m=3$, Sorted Degrees: $((2,2), (2,2), (2,2))$.\n\nThis analysis confirms that the signature $(m, \\text{SortedDegreePairs})$ is unique for each of the $16$ isomorphism classes. An algorithm can pre-compute these signatures and store them in a lookup table for efficient classification. The implementation will construct this lookup table for mapping the computed signature of a test graph to its corresponding integer ID.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the triad census classification problem for the given test suite.\n    \"\"\"\n\n    # Mapping from triad census names to the specified integer IDs.\n    CLASS_TO_ID = {\n        '003': 0, '012': 1, '102': 2, '021D': 3, '021U': 4,\n        '021C': 5, '111D': 6, '111U': 7, '030T': 8, '030C': 9,\n        '201': 10, '120D': 11, '120U': 12, '120C': 13, '210': 14,\n        '300': 15\n    }\n\n    # This signature map is the core of the classification algorithm.\n    # It maps the unique signature (m, sorted_degree_pairs) to a triad class ID.\n    # The degree pairs are sorted lexicographically.\n    SIGNATURE_TO_ID = {\n        # m = 0\n        (0, ((0, 0), (0, 0), (0, 0))): CLASS_TO_ID['003'],\n        (0, ((0, 0), (0, 1), (1, 0))): CLASS_TO_ID['012'],\n        (0, ((0, 2), (1, 0), (1, 0))): CLASS_TO_ID['021D'],\n        (0, ((0, 1), (0, 1), (2, 0))): CLASS_TO_ID['021U'],\n        (0, ((0, 1), (1, 0), (1, 1))): CLASS_TO_ID['021C'],\n        (0, ((0, 2), (1, 1), (2, 0))): CLASS_TO_ID['030T'],\n        (0, ((1, 1), (1, 1), (1, 1))): CLASS_TO_ID['030C'],\n        # m = 1\n        (1, ((0, 0), (1, 1), (1, 1))): CLASS_TO_ID['102'],\n        (1, ((1, 0), (1, 1), (1, 2))): CLASS_TO_ID['111D'],\n        (1, ((0, 1), (1, 1), (2, 1))): CLASS_TO_ID['111U'],\n        (1, ((1, 2), (1, 2), (2, 0))): CLASS_TO_ID['120D'],\n        (1, ((0, 2), (2, 1), (2, 1))): CLASS_TO_ID['120U'],\n        (1, ((1, 1), (1, 2), (2, 1))): CLASS_TO_ID['120C'],\n        # m = 2\n        (2, ((1, 1), (1, 1), (2, 2))): CLASS_TO_ID['201'],\n        (2, ((1, 2), (2, 1), (2, 2))): CLASS_TO_ID['210'],\n        # m = 3\n        (3, ((2, 2), (2, 2), (2, 2))): CLASS_TO_ID['300'],\n    }\n\n    def classify_triad(edges):\n        \"\"\"\n        Classifies a 3-node directed graph based on its edge set.\n        The algorithm uses only node degrees and mutuality indicators as required.\n        Nodes are assumed to be 1, 2, 3 as in the problem, but are mapped to\n        0, 1, 2 for array indexing.\n        \"\"\"\n        num_nodes = 3\n        adj = np.zeros((num_nodes, num_nodes), dtype=int)\n        for u, v in edges:\n            if 1 = u = num_nodes and 1 = v = num_nodes:\n                adj[u - 1, v - 1] = 1\n\n        # Calculate in-degrees and out-degrees for each node.\n        # axis=0 sums columns (incoming edges), axis=1 sums rows (outgoing edges).\n        in_degrees = adj.sum(axis=0)\n        out_degrees = adj.sum(axis=1)\n\n        degree_pairs = []\n        for i in range(num_nodes):\n            degree_pairs.append((in_degrees[i], out_degrees[i]))\n\n        # Sort the degree pairs to create an isomorphism-invariant feature.\n        # Python's default tuple sorting is lexicographical.\n        degree_pairs.sort()\n        \n        # Calculate mutuality indicators and the total count of mutual dyads (m).\n        m = 0\n        node_indices = range(num_nodes)\n        for i in node_indices:\n            for j in range(i + 1, num_nodes):\n                if adj[i, j] == 1 and adj[j, i] == 1:\n                    m += 1\n\n        # The signature is the tuple of m and the sorted degree pairs.\n        # The list of pairs must be converted to a tuple to be a dictionary key.\n        signature = (m, tuple(degree_pairs))\n\n        # Look up the signature to get the class ID.\n        return SIGNATURE_TO_ID.get(signature)\n\n    # Test suite from the problem statement.\n    test_cases = [\n        set(),                                             # Test 1: 003\n        {(1, 2)},                                          # Test 2: 012\n        {(1, 2), (2, 1)},                                  # Test 3: 102\n        {(1, 2), (1, 3)},                                  # Test 4: 021D\n        {(2, 1), (3, 1)},                                  # Test 5: 021U\n        {(1, 2), (2, 3)},                                  # Test 6: 021C\n        {(1, 2), (2, 1), (1, 3)},                          # Test 7: 111D\n        {(1, 2), (2, 1), (3, 1)},                          # Test 8: 111U\n        {(1, 2), (1, 3), (2, 3)},                          # Test 9: 030T\n        {(1, 2), (2, 3), (3, 1)},                          # Test 10: 030C\n        {(1, 2), (2, 1), (1, 3), (3, 1)},                  # Test 11: 201\n        {(1, 2), (2, 1), (1, 3), (2, 3)},                  # Test 12: 120D\n        {(1, 2), (2, 1), (3, 1), (3, 2)},                  # Test 13: 120U\n        {(1, 2), (2, 1), (1, 3), (3, 2)},                  # Test 14: 120C\n        {(1, 2), (2, 1), (1, 3), (3, 1), (2, 3)},          # Test 15: 210\n        {(1, 2), (2, 1), (1, 3), (3, 1), (2, 3), (3, 2)},  # Test 16: 300\n    ]\n\n    results = []\n    for case in test_cases:\n        result_id = classify_triad(case)\n        results.append(str(result_id))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}