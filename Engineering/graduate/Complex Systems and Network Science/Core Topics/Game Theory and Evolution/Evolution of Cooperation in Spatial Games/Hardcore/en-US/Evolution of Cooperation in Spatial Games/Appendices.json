{
    "hands_on_practices": [
        {
            "introduction": "The spread or retreat of cooperation often depends on the microscopic dynamics at the boundary between clusters of cooperators and defectors. This exercise provides a foundational analytical workout, asking you to calculate the \"invasion fitness\" of a cooperator at such an interface. By applying the Fermi update rule in a simplified, symmetric scenario, you will derive a clear expression for the probability of a cooperator converting an adjacent defector, revealing the core mechanics of spatial selection .",
            "id": "4274998",
            "problem": "Consider the Prisoner’s Dilemma (PD) in its donation-game parameterization on an infinite, $k$-regular spatial network, where each player interacts pairwise with all $k$ neighbors. In each pairwise interaction, a cooperator pays a cost $c>0$ to confer a benefit $b>c$ to the partner, while a defector pays no cost and confers no benefit. Thus, for any single interaction, the payoffs to the row player are: mutual cooperation yields $R=b-c$, unilateral cooperation against defection yields $S=-c$, unilateral defection against cooperation yields $T=b$, and mutual defection yields $P=0$. The total payoff to a player is the sum of its pairwise payoffs over all $k$ neighbors.\n\nFocus on a straight interface between a semi-infinite defective domain and its complementary cooperative domain. Consider an adjacent pair of boundary nodes, one defector and one cooperator, lying on opposite sides of the interface such that both have exactly $m$ cooperative neighbors and $k-m$ defective neighbors (with $1 \\leq m \\leq k-1$) by regularity of the interface. Strategy updating is asynchronous and follows the Fermi pairwise comparison rule with intensity parameter $\\beta=1$: when the boundary defector compares itself to the boundary cooperator across their shared edge, the defector adopts cooperation with a probability that depends on their payoff difference.\n\nDefine the invasion fitness $\\phi$ of the boundary cooperator as the conditional probability that the boundary defector adopts cooperation in the described comparison event. Compute $\\phi$ as a closed-form expression in terms of $k$ and $c$ only. Express your final answer as a single analytical expression; no rounding is required.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and self-contained. It describes a canonical model from evolutionary game theory on networks. The premises are clear, and the required task is a direct application of the stated principles. The crucial condition that both the boundary cooperator and defector have an identical number of cooperative neighbors, $m$, is a specific theoretical simplification that is not inherently contradictory and leads to a well-defined calculation. The problem is therefore deemed valid and a solution can be derived.\n\nThe problem describes the Prisoner's Dilemma in the donation-game formulation. In a single pairwise interaction, a cooperator pays a cost $c>0$ to provide a benefit $b>c$ to its partner. A defector pays nothing and provides nothing. The payoffs for the row player are given by the matrix:\n$$\n\\begin{pmatrix}\nR & S \\\\\nT & P\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb-c & -c \\\\\nb & 0\n\\end{pmatrix}\n$$\nwhere $R$ is the payoff for mutual cooperation, $S$ for cooperating with a defector, $T$ for defecting against a cooperator, and $P$ for mutual defection. The total payoff for a player on the $k$-regular network is the sum of a player's payoffs from interacting with its $k$ neighbors.\n\nWe are asked to consider a focal cooperator, let's denote it by $C^*$, and an adjacent focal defector, $D^*$. According to the problem statement, both players are situated at the boundary between cooperative and defective domains and have identical neighborhood compositions: each has exactly $m$ cooperative neighbors and $k-m$ defective neighbors, where $1 \\leq m \\leq k-1$.\n\nLet us calculate the total payoff, $\\Pi_C$, for the focal cooperator $C^*$. This player has $m$ neighbors who are cooperators and $k-m$ neighbors who are defectors. The total payoff is the sum of payoffs from these interactions:\n$$\n\\Pi_C = m \\cdot R + (k-m) \\cdot S\n$$\nSubstituting the expressions for $R$ and $S$:\n$$\n\\Pi_C = m(b-c) + (k-m)(-c) = mb - mc - kc + mc\n$$\n$$\n\\Pi_C = mb - kc\n$$\nNext, we calculate the total payoff, $\\Pi_D$, for the focal defector $D^*$. This player also has $m$ cooperative neighbors and $k-m$ defective neighbors. The total payoff is the sum of payoffs from these interactions:\n$$\n\\Pi_D = m \\cdot T + (k-m) \\cdot P\n$$\nSubstituting the expressions for $T$ and $P$:\n$$\n\\Pi_D = m(b) + (k-m)(0)\n$$\n$$\n\\Pi_D = mb\n$$\nThe problem states that strategy updating follows the Fermi pairwise comparison rule. The invasion fitness, $\\phi$, is defined as the conditional probability that the defector $D^*$ adopts the cooperator's strategy when comparing itself with $C^*$. The general form of the Fermi rule for a player $i$ adopting the strategy of a neighbor $j$ is:\n$$\nP(i \\to j) = \\frac{1}{1 + \\exp(-\\beta(\\Pi_j - \\Pi_i))}\n$$\nIn our case, player $i$ is the defector $D^*$, and player $j$ is the cooperator $C^*$. The intensity of selection is given as $\\beta = 1$. Therefore, the probability $\\phi$ is:\n$$\n\\phi = \\frac{1}{1 + \\exp(-1 \\cdot (\\Pi_C - \\Pi_D))} = \\frac{1}{1 + \\exp(-(\\Pi_C - \\Pi_D))}\n$$\nTo compute $\\phi$, we must first find the payoff difference $\\Pi_C - \\Pi_D$:\n$$\n\\Pi_C - \\Pi_D = (mb - kc) - (mb) = -kc\n$$\nSubstituting this difference into the expression for $\\phi$:\n$$\n\\phi = \\frac{1}{1 + \\exp(-(-kc))}\n$$\n$$\n\\phi = \\frac{1}{1 + \\exp(kc)}\n$$\nThis expression for $\\phi$ is in terms of $k$ and $c$ only, as required by the problem statement. The parameters $b$ and $m$ cancel out due to the symmetric neighborhood assumption for the two focal players.",
            "answer": "$$\n\\boxed{\\frac{1}{1 + \\exp(kc)}}\n$$"
        },
        {
            "introduction": "While full spatial simulations are powerful, analytical approximations offer deep insights into how network structure affects evolution. This problem challenges you to compare the predictions of two fundamental theories: the well-mixed mean-field (MF) model and the spatially-aware pair approximation (PA) model. By calculating the expected frequency of cooperators in a Snowdrift game under both frameworks, you will quantify how accounting for local correlations changes the predicted outcome of the evolutionary dynamics .",
            "id": "4274916",
            "problem": "Consider a large population structured as a Regular Random Graph (RRG) of degree $k$, in which each node plays a two-strategy, two-player Snowdrift (also called Hawk-Dove) game against each of its neighbors. Let the benefit of cooperation be $b>0$ and the cost of cooperation be $c>0$, with payoff matrix entries defined by the standard Snowdrift parameterization: mutual cooperation yields payoff $R=b-\\frac{c}{2}$ to each cooperator, one-sided cooperation yields payoff $S=b-c$ to the cooperator and $T=b$ to the defector, and mutual defection yields $P=0$ to each. Strategy updating follows pairwise comparison (imitation) under weak selection, where adoption probabilities are monotone in the payoff difference.\n\nUse as a fundamental base the following widely accepted facts:\n- In the well-mixed (Mean Field, MF) limit for two-strategy games under replicator dynamics, an interior steady state $x_{\\mathrm{MF}}$ for the cooperator density $x$ is determined by the equality of expected payoffs of cooperators and defectors, namely $R x + S (1-x) = T x + P (1-x)$.\n- On $k$-regular graphs under weak selection with pairwise comparison (imitation), pair approximation (PA) yields an effective replicator equation on graphs equivalent to the MF replicator with a transformed payoff matrix $\\mathbf{A}'=\\mathbf{A}+\\frac{1}{k}\\left(\\mathbf{A}-\\mathbf{A}^{\\top}\\right)$, where $\\mathbf{A}=\\begin{pmatrix}R & S \\\\ T & P\\end{pmatrix}$ and ${}^{\\top}$ denotes transpose. The interior steady state $x_{\\mathrm{PA}}$ is determined by equality of expected payoffs computed with $\\mathbf{A}'$.\n\nFor a specific graph degree and parameterization, let $k=4$, $b=1$, and $c=0.6$. Derive the MF prediction $x_{\\mathrm{MF}}$ and the PA prediction $x_{\\mathrm{PA}}$, and compute the numerical difference $\\Delta=x_{\\mathrm{PA}}-x_{\\mathrm{MF}}$. Express $\\Delta$ as a unitless decimal and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the difference between the cooperator frequency predicted by Pair Approximation (PA) on a regular random graph and the frequency predicted by Mean-Field (MF) theory for a Snowdrift game. The problem is well-defined and its premises are consistent with standard models in evolutionary game theory.\n\nFirst, we define the payoff matrix $\\mathbf{A}=\\begin{pmatrix} R & S \\\\ T & P \\end{pmatrix}$ using the given parameters $b=1$ and $c=0.6$.\nThe payoff entries are:\n$R = b - \\frac{c}{2} = 1 - \\frac{0.6}{2} = 1 - 0.3 = 0.7$\n$S = b - c = 1 - 0.6 = 0.4$\n$T = b = 1$\n$P = 0$\nThus, the payoff matrix is $\\mathbf{A} = \\begin{pmatrix} 0.7 & 0.4 \\\\ 1 & 0 \\end{pmatrix}$.\nThe condition for a stable mixed strategy equilibrium in the Snowdrift game is $T > R > S > P$, which corresponds to $1 > 0.7 > 0.4 > 0$. This condition is satisfied.\n\nNext, we calculate the Mean-Field (MF) prediction for the cooperator frequency, $x_{\\mathrm{MF}}$. The interior steady state is found where the expected payoff of a cooperator, $E_C$, equals that of a defector, $E_D$. Let $x$ be the frequency of cooperators.\n$$E_C = x R + (1-x) S$$\n$$E_D = x T + (1-x) P$$\nSetting $E_C = E_D$ at $x=x_{\\mathrm{MF}}$:\n$$x_{\\mathrm{MF}} R + (1-x_{\\mathrm{MF}}) S = x_{\\mathrm{MF}} T + (1-x_{\\mathrm{MF}}) P$$\nSolving for $x_{\\mathrm{MF}}$ gives the general formula:\n$$x_{\\mathrm{MF}} = \\frac{P-S}{R-S-T+P}$$\nSubstituting the numerical payoff values:\n$$x_{\\mathrm{MF}} = \\frac{0 - 0.4}{0.7 - 0.4 - 1 + 0} = \\frac{-0.4}{-0.7} = \\frac{4}{7}$$\n\nNow, we calculate the Pair Approximation (PA) prediction, $x_{\\mathrm{PA}}$. According to the problem statement, this is determined by an effective payoff matrix $\\mathbf{A}' = \\mathbf{A} + \\frac{1}{k}(\\mathbf{A} - \\mathbf{A}^{\\top})$, with graph degree $k=4$.\nFirst, we find $\\mathbf{A}-\\mathbf{A}^{\\top}$:\n$$\\mathbf{A} - \\mathbf{A}^{\\top} = \\begin{pmatrix} 0.7 & 0.4 \\\\ 1 & 0 \\end{pmatrix} - \\begin{pmatrix} 0.7 & 1 \\\\ 0.4 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & -0.6 \\\\ 0.6 & 0 \\end{pmatrix}$$\nThen we compute the correction term for $k=4$:\n$$\\frac{1}{k}(\\mathbf{A} - \\mathbf{A}^{\\top}) = \\frac{1}{4} \\begin{pmatrix} 0 & -0.6 \\\\ 0.6 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & -0.15 \\\\ 0.15 & 0 \\end{pmatrix}$$\nThe effective payoff matrix $\\mathbf{A}'$ is:\n$$\\mathbf{A}' = \\mathbf{A} + \\frac{1}{k}(\\mathbf{A} - \\mathbf{A}^{\\top}) = \\begin{pmatrix} 0.7 & 0.4 \\\\ 1 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & -0.15 \\\\ 0.15 & 0 \\end{pmatrix} = \\begin{pmatrix} 0.7 & 0.25 \\\\ 1.15 & 0 \\end{pmatrix}$$\nLet the entries of this new matrix be $\\mathbf{A}'=\\begin{pmatrix} R' & S' \\\\ T' & P' \\end{pmatrix}$. So, $R'=0.7$, $S'=0.25$, $T'=1.15$, and $P'=0$.\nThe PA steady state $x_{\\mathrm{PA}}$ is found using the same equilibrium condition form, but with the effective payoffs:\n$$x_{\\mathrm{PA}} = \\frac{P'-S'}{R'-S'-T'+P'}$$\nSubstituting the new payoff values:\n$$x_{\\mathrm{PA}} = \\frac{0 - 0.25}{0.7 - 0.25 - 1.15 + 0} = \\frac{-0.25}{0.45 - 1.15} = \\frac{-0.25}{-0.7} = \\frac{25}{70} = \\frac{5}{14}$$\n\nFinally, we compute the difference $\\Delta = x_{\\mathrm{PA}} - x_{\\mathrm{MF}}$.\n$$\\Delta = \\frac{5}{14} - \\frac{4}{7} = \\frac{5}{14} - \\frac{8}{14} = -\\frac{3}{14}$$\nTo provide the numerical answer, we convert this fraction to a decimal:\n$$\\Delta = -\\frac{3}{14} \\approx -0.2142857...$$\nRounding to four significant figures, we get:\n$$\\Delta \\approx -0.2143$$\nThis negative value indicates that for the Snowdrift game under pairwise comparison updating, the spatial structure captured by pair approximation leads to a lower frequency of cooperators compared to the well-mixed population.",
            "answer": "$$\\boxed{-0.2143}$$"
        },
        {
            "introduction": "Theoretical models often assume infinite, homogeneous spaces, but real-world populations are finite and have boundaries. This computational exercise invites you to explore the profound impact of such boundaries by simulating the Prisoner's Dilemma on a finite lattice. You will discover how the placement of an initial cooperative cluster—in the center versus in a corner—dramatically alters its fate, demonstrating a key mechanism for the survival of cooperation through network reciprocity .",
            "id": "4274991",
            "problem": "Consider a finite two-dimensional square lattice of size $N \\times N$ with reflecting boundaries (non-periodic), where each vertex represents an agent and each undirected edge represents an interaction between two adjacent agents. Each agent permanently occupies its vertex and has exactly one of two strategies: cooperation $C$ or defection $D$. Interactions follow the donation-game formulation of the Prisoner's Dilemma: a cooperator pays a cost $c > 0$ to provide a benefit $b > 0$ to each neighbor, while a defector pays no cost and provides no benefit. The instantaneous payoff $\\pi_i$ of agent $i$ with degree $d_i$ and $n_i^C$ cooperative neighbors is\n$$\n\\pi_i = b \\, n_i^C - c \\, d_i \\, \\mathbf{1}\\{s_i = C\\},\n$$\nwhere $s_i \\in \\{C,D\\}$ is the strategy of agent $i$ and $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n\nTime evolves in discrete steps $t = 0, 1, 2, \\dots$. At each step, an undirected edge $(i,j)$ is chosen uniformly at random. Then one of the two oriented updates is chosen uniformly at random: either $i$ considers imitating $j$ or $j$ considers imitating $i$. If $i$ considers $j$, agent $i$ adopts agent $j$'s strategy with probability given by the Fermi pairwise comparison rule\n$$\np_{i \\leftarrow j} = \\frac{1}{1 + \\exp\\left(-\\beta \\left(\\pi_j - \\pi_i \\right)\\right)},\n$$\nwhere $\\beta \\ge 0$ is the selection intensity. If the update does not result in adoption, strategies remain unchanged for that step. The process continues until either all agents are cooperators (the all-$C$ absorbing state) or all agents are defectors (the all-$D$ absorbing state), or until a fixed horizon of $H$ steps is reached.\n\nThe initial condition is a contiguous square block of cooperators of side length $s$, embedded in a sea of defectors. Two placements are considered:\n- Corner placement: the cooperative block occupies lattice coordinates with the upper-left corner anchored at the lattice corner, i.e., rows $i \\in \\{0,1,\\dots,s-1\\}$ and columns $j \\in \\{0,1,\\dots,s-1\\}$.\n- Center placement: the cooperative block is centered as a contiguous square of side $s$ starting at rows $i \\in \\{\\lfloor (N-s)/2 \\rfloor, \\dots, \\lfloor (N-s)/2 \\rfloor + s - 1\\}$ and columns $j \\in \\{\\lfloor (N-s)/2 \\rfloor, \\dots, \\lfloor (N-s)/2 \\rfloor + s - 1\\}$.\n\nLet the fixation probability of cooperation within horizon $H$ be defined as the fraction (expressed as a decimal) of independent simulation runs that reach the all-$C$ absorbing state by time $H$, starting from the specified initial condition.\n\nYour task is to write a complete program that computes the fixation probability of cooperation for each of the following test cases. Each run uses independent randomness. The observation to be demonstrated is how boundary placement (corner versus center) affects fixation probability, and the mechanism should be explained through interface growth arguments in your solution.\n\nUse the following fixed donation-game parameters and test suite:\n- Benefit $b = 1.0$.\n- Cost $c \\in \\{0.25, 0.30\\}$ as specified per case.\n- Selection intensity $\\beta \\in \\{0.0, 1.0, 2.0\\}$ as specified per case.\n- Lattice size $N = 20$.\n- Cooperative block side $s \\in \\{1, 4\\}$ as specified per case.\n- Horizon $H = 10000$ steps for all cases.\n\nTest suite (each case is an independent setting for which you must output the fixation probability of cooperation as a decimal number):\n1. Case A (corner, typical selection): $N = 20$, $s = 4$, corner placement, $b = 1.0$, $c = 0.25$, $\\beta = 1.0$, $R = 80$.\n2. Case B (center, typical selection): $N = 20$, $s = 4$, center placement, $b = 1.0$, $c = 0.25$, $\\beta = 1.0$, $H = 10000$, number of independent runs $R = 80$.\n3. Case C (corner, single seed, strong selection): $N = 20$, $s = 1$, corner placement, $b = 1.0$, $c = 0.30$, $\\beta = 2.0$, $H = 10000$, number of independent runs $R = 120$.\n4. Case D (center, single seed, strong selection): $N = 20$, $s = 1$, center placement, $b = 1.0$, $c = 0.30$, $\\beta = 2.0$, $H = 10000$, number of independent runs $R = 120$.\n5. Case E (center, neutral drift baseline): $N = 20$, $s = 4$, center placement, $b = 1.0$, $c = 0.25$, $\\beta = 0.0$, $H = 10000$, number of independent runs $R = 80$.\n\nScientific realism constraints:\n- Degrees of boundary vertices must reflect the lattice structure (corners have degree $2$, edges have degree $3$, interior vertices have degree $4$).\n- The stochastic dynamics must adhere to the specified pairwise comparison rule with Fermi update.\n\nYour program should produce a single line of output containing the fixation probabilities for the five cases as a comma-separated list of decimals rounded to three decimal places and enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_k$ corresponds to the fixation probability for the $k$-th test case in the order listed above. No physical units or angles are involved. All final answers must be decimals (not fractions or percentages).",
            "solution": "The user has requested the computation of fixation probabilities for cooperation in a spatial Prisoner's Dilemma on a square lattice. This requires a stochastic simulation of an agent-based model. The following solution details the theoretical underpinnings, the algorithmic design, and the scientific rationale for the expected outcomes.\n\n### 1. Problem Validation\nThe problem statement is **valid**.\n\n- **Givens Extraction**:\n    - **Lattice**: $N \\times N$ square lattice, $N=20$, with reflecting boundaries.\n    - **Strategies**: Cooperation ($C$) and Defection ($D$).\n    - **Game**: Donation game with benefit $b=1.0$ and cost $c \\in \\{0.25, 0.30\\}$.\n    - **Payoff Function**: $\\pi_i = b \\, n_i^C - c \\, d_i \\, \\mathbf{1}\\{s_i = C\\}$, where $i$ is the agent, $s_i$ its strategy, $d_i$ its degree, $n_i^C$ its number of cooperative neighbors, and $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n    - **Dynamics**: Discrete time steps. At each step, an edge $(i,j)$ is chosen uniformly at random, followed by a random choice of update direction ($i \\leftarrow j$ or $j \\leftarrow i$). Strategy adoption probability is given by the Fermi pairwise comparison rule: $p_{i \\leftarrow j} = \\frac{1}{1 + \\exp\\left(-\\beta \\left(\\pi_j - \\pi_i \\right)\\right)}$.\n    - **Selection Intensity**: $\\beta \\in \\{0.0, 1.0, 2.0\\}$.\n    - **Initial Conditions**: A contiguous square block of cooperators of side length $s \\in \\{1, 4\\}$ in a sea of defectors.\n    - **Placements**: 'corner' (block at $(0,0)$) and 'center' (block centered on the lattice).\n    - **Termination**: Simulation ends upon reaching an all-$C$ or all-$D$ absorbing state, or after a horizon of $H=10000$ steps.\n    - **Output**: Fixation probability of cooperation (fraction of runs ending in all-$C$ within horizon $H$) for five specified test cases, rounded to three decimals.\n    - **Test Cases**:\n        - A: $N=20, s=4$, corner, $c=0.25, \\beta=1.0, R=80$.\n        - B: $N=20, s=4$, center, $c=0.25, \\beta=1.0, R=80$.\n        - C: $N=20, s=1$, corner, $c=0.30, \\beta=2.0, R=120$.\n        - D: $N=20, s=1$, center, $c=0.30, \\beta=2.0, R=120$.\n        - E: $N=20, s=4$, center, $c=0.25, \\beta=0.0, R=80$.\n\n- **Validation Verdict**: The problem is scientifically grounded, well-posed, and objective. It describes a standard model from the field of evolutionary game theory and complex systems. All parameters, rules, and conditions are explicitly defined, forming a self-contained and consistent specification for a Monte Carlo simulation. The problem is therefore valid.\n\n### 2. Theoretical Framework and Solution Design\n\n#### 2.1. Model Specification\nThe system is a population of $N \\times N = 400$ agents on a 2D square lattice. The lattice has reflecting (non-periodic) boundaries, meaning agents at the edges and corners have fewer neighbors than those in the interior.\n- An agent's degree, $d_i$, is $4$ for interior vertices, $3$ for edge vertices (not corners), and $2$ for corner vertices.\n- Strategies are binary: Cooperator ($C$, represented as $1$) and Defector ($D$, represented as $0$).\n- The payoff $\\pi_i$ for agent $i$ depends on its own strategy and the strategies of its immediate neighbors. A cooperator pays a cost $c$ for each neighbor it has (total cost $c \\cdot d_i$) and provides a benefit $b$ to each of its neighbors. A defector pays no costs and provides no benefits. The payoff is thus calculated as specified: $\\pi_i = b \\cdot n_i^C - c \\cdot d_i \\cdot s_i$, where $s_i=1$ if agent $i$ is a cooperator and $s_i=0$ if it is a defector.\n\n#### 2.2. Evolutionary Dynamics\nThe simulation proceeds in discrete time steps, implementing an asynchronous update rule. At each step:\n1.  An undirected edge $(i, j)$ connecting two neighboring agents is selected uniformly at random from all edges on the lattice.\n2.  One of the two agents, say $i$, is randomly chosen as the \"focal\" agent, and the other, $j$, as the \"model\" agent.\n3.  The instantaneous payoffs $\\pi_i$ and $\\pi_j$ are calculated based on the current configuration of strategies on the grid.\n4.  The focal agent $i$ adopts the model agent $j$'s strategy with the Fermi probability $p_{i \\leftarrow j}$. This probability increases with the payoff advantage of the model, $\\pi_j - \\pi_i$. The selection intensity $\\beta$ controls the sensitivity to this payoff difference.\n    - If $\\beta > 0$, higher-payoff strategies are more likely to be imitated.\n    - If $\\beta = 0$, the probability becomes $p = 1/2$, meaning imitation is random and independent of payoffs (neutral drift).\n    - If $\\beta \\to \\infty$, the update becomes deterministic: the focal agent adopts the model's strategy if and only if $\\pi_j > \\pi_i$.\n\n#### 2.3. Rationale for Boundary Effects on Cooperation\nThe central scientific question is why the initial placement of the cooperative cluster (corner vs. center) affects its fixation probability. The primary mechanism is the role of spatial heterogeneity introduced by the lattice boundaries.\n\n1.  **Reduced Cost at Boundaries**: Agents at the lattice-defined boundaries and corners have fewer neighbors ($d_i < 4$). For a cooperator, the total cost of cooperation is $c \\cdot d_i$. Thus, cooperators at these low-degree sites pay a smaller cost than those in the lattice interior. This gives them a higher intrinsic payoff, making them more resilient to invasion by defectors. A cooperative cluster anchored in a corner can leverage these \"cheap\" sites as robust defensive positions.\n\n2.  **Favorable Interface Geometry**: The survival and expansion of a strategy cluster depend on the dynamics at its interface with the opposing strategy. The geometry of the cluster's placement alters this interface. A square cluster of side $s$ has an area of $s^2$.\n    - **Center Placement**: The cluster is surrounded by defectors, creating an interface of length approximately $4s$. The ratio of surface (vulnerable) agents to core (protected) agents is relatively high.\n    - **Corner Placement**: The cluster is bounded by two sides of the lattice itself, exposing only two sides to the sea of defectors. The interface length is approximately $2s$. This configuration has a much lower surface-to-volume (or interface-to-area) ratio. A smaller fraction of cooperators are in direct competition with defectors, and a larger \"core\" of cooperators provides a stable payoff base to those at the interface.\n\nTogether, these effects predict that cooperation is more likely to survive and fixate when starting from a corner placement compared to a center placement. The simulation is designed to test and quantify this well-established theoretical result.\n\n#### 2.4. Algorithmic Implementation\nA Monte Carlo simulation is implemented to estimate the fixation probabilities. For each test case, a specified number of independent runs ($R$) are executed.\n\n1.  **Initialization**: For each run, a $N \\times N$ `numpy` array represents the lattice. It is initialized with defectors ($0$), and a square block of cooperators ($1$) is placed according to the 'corner' or 'center' specification. Static properties like the degree of each site and a list of all edges are pre-computed for efficiency.\n\n2.  **Simulation Loop**: A single run evolves for a maximum of $H=10000$ steps.\n    - In each step, an edge and an update direction are chosen randomly.\n    - The payoffs for the two interacting agents are calculated based on their local neighborhood.\n    - The Fermi probability is computed, and a random number is drawn to determine if a strategy update occurs.\n    - The loop terminates prematurely if the system reaches an absorbing state (all-$C$ or all-$D$).\n\n3.  **Result Aggregation**: If a run ends in the all-$C$ state (either by fixation or at the horizon $H$), it is counted as a success ($1$). Otherwise, it is a failure ($0$). The fixation probability for a given test case is the average of these outcomes over all $R$ runs.\n\n4.  **Baseline Case (Neutral Drift)**: Case E with $\\beta=0$ serves as a critical baseline. Under neutral drift, the fixation probability of a strategy is equal to its initial frequency. For $s=4$ on a $N=20$ lattice, the initial frequency of cooperators is $s^2/N^2 = 16/400 = 0.04$. The simulation result for Case E should be statistically consistent with this theoretical value, validating the core stochastic framework of the program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fixation probability of cooperation for five test cases of a spatial\n    Prisoner's Dilemma on a 2D lattice.\n    \"\"\"\n\n    test_cases = [\n        # Case A: corner, typical selection\n        {'N': 20, 's': 4, 'placement': 'corner', 'b': 1.0, 'c': 0.25, 'beta': 1.0, 'H': 10000, 'R': 80},\n        # Case B: center, typical selection\n        {'N': 20, 's': 4, 'placement': 'center', 'b': 1.0, 'c': 0.25, 'beta': 1.0, 'H': 10000, 'R': 80},\n        # Case C: corner, single seed, strong selection\n        {'N': 20, 's': 1, 'placement': 'corner', 'b': 1.0, 'c': 0.30, 'beta': 2.0, 'H': 10000, 'R': 120},\n        # Case D: center, single seed, strong selection\n        {'N': 20, 's': 1, 'placement': 'center', 'b': 1.0, 'c': 0.30, 'beta': 2.0, 'H': 10000, 'R': 120},\n        # Case E: center, neutral drift baseline\n        {'N': 20, 's': 4, 'placement': 'center', 'b': 1.0, 'c': 0.25, 'beta': 0.0, 'H': 10000, 'R': 80},\n    ]\n\n    def _precompute_lattice_properties(N):\n        \"\"\"Pre-computes degrees and edge list for the NxN lattice.\"\"\"\n        degrees = np.full((N, N), 4, dtype=int)\n        degrees[0, :] -= 1\n        degrees[N - 1, :] -= 1\n        degrees[:, 0] -= 1\n        degrees[:, N - 1] -= 1\n\n        edges = []\n        for r in range(N):\n            for c in range(N):\n                if r + 1 < N:\n                    edges.append(((r, c), (r + 1, c)))\n                if c + 1 < N:\n                    edges.append(((r, c), (r, c + 1)))\n        return degrees, edges\n\n    def _initialize_grid(N, s, placement):\n        \"\"\"Initializes the grid with a cluster of cooperators.\"\"\"\n        grid = np.zeros((N, N), dtype=int)\n        if s > 0:\n            if placement == 'corner':\n                start_row, start_col = 0, 0\n            else:  # center\n                start_row = (N - s) // 2\n                start_col = (N - s) // 2\n            \n            grid[start_row:start_row + s, start_col:start_col + s] = 1\n        return grid\n\n    def _calculate_payoff(coords, grid, b, c, degrees, N):\n        \"\"\"Calculates the payoff for a single agent.\"\"\"\n        r, col = coords\n        \n        n_C = 0\n        # Check neighbors\n        if r > 0 and grid[r - 1, col] == 1: n_C += 1\n        if r < N - 1 and grid[r + 1, col] == 1: n_C += 1\n        if col > 0 and grid[r, col - 1] == 1: n_C += 1\n        if col < N - 1 and grid[r, col + 1] == 1: n_C += 1\n            \n        payoff = b * n_C\n        \n        if grid[r, col] == 1:  # If agent is a cooperator\n            payoff -= c * degrees[r, col]\n            \n        return payoff\n\n    def run_simulation(params, degrees, edges, rng):\n        \"\"\"Runs a single simulation and returns 1 if cooperation fixates, 0 otherwise.\"\"\"\n        N, s, placement, b, c, beta, H = \\\n            params['N'], params['s'], params['placement'], params['b'], params['c'], params['beta'], params['H']\n        \n        grid = _initialize_grid(N, s, placement)\n        num_edges = len(edges)\n        \n        for _ in range(H):\n            num_cooperators = np.sum(grid)\n            if num_cooperators == N * N:\n                return 1\n            if num_cooperators == 0:\n                return 0\n\n            edge_idx = rng.integers(num_edges)\n            i_coords, j_coords = edges[edge_idx]\n            \n            if rng.random() < 0.5:\n                focal_coords, model_coords = i_coords, j_coords\n            else:\n                focal_coords, model_coords = j_coords, i_coords\n            \n            focal_strategy = grid[focal_coords]\n            model_strategy = grid[model_coords]\n\n            if focal_strategy == model_strategy:\n                continue\n\n            pi_focal = _calculate_payoff(focal_coords, grid, b, c, degrees, N)\n            pi_model = _calculate_payoff(model_coords, grid, b, c, degrees, N)\n\n            delta_pi = pi_model - pi_focal\n            \n            prob = 1.0 / (1.0 + np.exp(-beta * delta_pi))\n            \n            if rng.random() < prob:\n                grid[focal_coords] = model_strategy\n\n        # Check state at horizon\n        return 1 if np.sum(grid) == N * N else 0\n\n    results = []\n    # Pre-compute for the only N value\n    degrees, edges = _precompute_lattice_properties(20)\n    rng = np.random.default_rng()\n\n    for case in test_cases:\n        R = case['R']\n        fixation_count = 0\n        for _ in range(R):\n            fixation_count += run_simulation(case, degrees, edges, rng)\n        \n        fixation_prob = fixation_count / R\n        results.append(f\"{fixation_prob:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}