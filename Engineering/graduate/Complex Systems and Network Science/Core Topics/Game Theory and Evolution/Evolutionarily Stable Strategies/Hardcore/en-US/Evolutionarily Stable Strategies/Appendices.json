{
    "hands_on_practices": [
        {
            "introduction": "The Hawk-Dove game is a cornerstone model for understanding conflict and cooperation in animal behavior and beyond. This exercise will guide you through a foundational analysis, from deriving expected payoffs in a mixed population to determining the conditions under which aggressive (Hawk) or passive (Dove) strategies are evolutionarily stable. By working through this canonical example , you will build essential skills in applying the core definitions of ESS to a game with clear, intuitive parameters for resource value ($V$) and conflict cost ($C$).",
            "id": "4275246",
            "problem": "Consider a well-mixed, infinitely large population engaging in a symmetric two-strategy game with strategies Hawk ($H$) and Dove ($D$). The payoff matrix for the row player is\n$$\nA=\\begin{pmatrix}\n\\frac{V-C}{2}  V \\\\\n0  \\frac{V}{2}\n\\end{pmatrix},\n$$\nwhere $V$ denotes the value of the contested resource and $C$ denotes the cost of escalated conflict. Assume $V0$ and $C0$. A mixed population plays Hawk with frequency $p \\in [0,1]$ and Dove with frequency $1-p$.\n\nStarting from the definitions of expected payoff in a well-mixed population and the definition of a symmetric Evolutionarily Stable Strategy (ESS) in symmetric games, do the following:\n\n1. Derive the expected payoffs $U_H(p)$ and $U_D(p)$ to strategies $H$ and $D$, respectively, when the population mix is $p$.\n2. Using the definition of a symmetric Nash equilibrium in mixed strategies, compute the mixed equilibrium proportion $p^\\ast$ of Hawks by equating the expected payoffs of $H$ and $D$. Express $p^\\ast$ as a closed-form expression in $V$ and $C$.\n3. Using the definition of an ESS for symmetric games, determine for which parameter ranges of $V$ and $C$ a pure strategy ($H$ or $D$) is an ESS or fails to be an ESS. Also determine the parameter range for which the mixed strategy $p^\\ast$ is an ESS. Provide rigorous justifications based on the ESS conditions, not by appeal to memorized criteria.\n4. For the final answer, report only the expression you found for $p^\\ast$ in item $2$.\n\nIf you provide any numerical approximations in intermediate checks, clearly state them; however, the final expression for $p^\\ast$ must be exact and in closed form. No rounding is required. The final answer should contain only the requested expression for $p^\\ast$ with no units.",
            "solution": "The problem statement is deemed valid as it is a well-posed, scientifically grounded, and objective problem from the field of evolutionary game theory. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe task is to analyze a symmetric two-strategy game between Hawk ($H$) and Dove ($D$) with the given payoff matrix for the row player:\n$$\nA=\\begin{pmatrix}\nU(H, H)  U(H, D) \\\\\nU(D, H)  U(D, D)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{V-C}{2}  V \\\\\n0  \\frac{V}{2}\n\\end{pmatrix}\n$$\nThe parameters $V$ and $C$ are positive, i.e., $V0$ and $C0$. The population consists of a proportion $p$ of Hawks and $1-p$ of Doves, where $p \\in [0,1]$.\n\n**1. Derivation of Expected Payoffs**\n\nThe expected payoff to an individual playing a certain strategy is calculated by averaging the payoffs of playing against each strategy in the population, weighted by the frequency of those strategies.\n\nThe expected payoff to a Hawk player, $U_H(p)$, is the payoff from encountering another Hawk (with probability $p$) plus the payoff from encountering a Dove (with probability $1-p$):\n$$\nU_H(p) = p \\cdot U(H, H) + (1-p) \\cdot U(H, D)\n$$\nSubstituting the values from the payoff matrix $A$:\n$$\nU_H(p) = p \\left(\\frac{V-C}{2}\\right) + (1-p)V = \\frac{pV}{2} - \\frac{pC}{2} + V - pV = V - p\\left(\\frac{V+C}{2}\\right)\n$$\n\nSimilarly, the expected payoff to a Dove player, $U_D(p)$, is:\n$$\nU_D(p) = p \\cdot U(D, H) + (1-p) \\cdot U(D, D)\n$$\nSubstituting the values from the payoff matrix $A$:\n$$\nU_D(p) = p(0) + (1-p)\\frac{V}{2} = \\frac{V}{2} - \\frac{pV}{2}\n$$\n\n**2. Computation of the Mixed Equilibrium Proportion $p^\\ast$**\n\nA mixed strategy Nash equilibrium, denoted by $p^\\ast$, occurs when the expected payoffs for the pure strategies are equal, meaning individuals are indifferent between playing Hawk or Dove. This equilibrium is interior to the strategy space, i.e., $p^\\ast \\in (0,1)$. We find $p^\\ast$ by setting $U_H(p^\\ast) = U_D(p^\\ast)$:\n$$\nV - p^\\ast\\left(\\frac{V+C}{2}\\right) = \\frac{V}{2} - \\frac{p^\\ast V}{2}\n$$\nTo solve for $p^\\ast$, we rearrange the equation:\n$$\nV - \\frac{V}{2} = p^\\ast\\left(\\frac{V+C}{2}\\right) - \\frac{p^\\ast V}{2}\n$$\n$$\n\\frac{V}{2} = p^\\ast\\left(\\frac{V+C-V}{2}\\right)\n$$\n$$\n\\frac{V}{2} = p^\\ast\\left(\\frac{C}{2}\\right)\n$$\nAssuming $C \\neq 0$, which is true since $C0$, we can solve for $p^\\ast$:\n$$\np^\\ast = \\frac{V}{C}\n$$\nFor $p^\\ast$ to be a valid mixed strategy proportion in an *internal* equilibrium, it must satisfy $0  p^\\ast  1$. Given $V0$ and $C0$, $p^\\ast  0$ is always true. The condition $p^\\ast  1$ requires $V/C  1$, which means $V  C$.\n\n**3. Analysis of Evolutionarily Stable Strategies (ESS)**\n\nA strategy $S^\\ast$ is an Evolutionarily Stable Strategy (ESS) if, for any alternative (\"mutant\") strategy $S \\ne S^\\ast$, the following two conditions hold:\n1.  **Nash Equilibrium Condition:** $U(S^\\ast, S^\\ast) \\ge U(S, S^\\ast)$\n2.  **Stability Condition:** If $U(S^\\ast, S^\\ast) = U(S, S^\\ast)$, then $U(S^\\ast, S)  U(S, S)$\n\nWe will analyze the pure and mixed strategies.\n\n**Pure Strategy $H$ (Hawk):**\nLet $S^\\ast = H$. An invading mutant plays strategy $S=D$.\nWe check the Nash condition: $U(H, H) \\ge U(D, H)$. From the payoff matrix, this is:\n$$\n\\frac{V-C}{2} \\ge 0 \\implies V \\ge C\n$$\nIf $V  C$, the inequality is strict ($U(H, H)  U(D, H)$). The Nash condition is satisfied strictly, so $H$ is an ESS. A population of Hawks cannot be invaded by mutant Doves because the Hawks do better against other Hawks than the Doves do.\nIf $V = C$, the Nash condition holds with equality ($U(H, H) = U(D, H) = 0$). We must check the stability condition with $S^\\ast = H$ and $S=D$: $U(H, D)  U(D, D)$. From the payoff matrix, this is:\n$$\nV  \\frac{V}{2}\n$$\nSince $V0$ is given, this inequality is always true.\nTherefore, the pure strategy $H$ is an ESS if and only if $V \\ge C$.\n\n**Pure Strategy $D$ (Dove):**\nLet $S^\\ast = D$. An invading mutant plays strategy $S=H$.\nWe check the Nash condition: $U(D, D) \\ge U(H, D)$. From the payoff matrix, this is:\n$$\n\\frac{V}{2} \\ge V\n$$\nSince $V0$, this simplifies to $\\frac{1}{2} \\ge 1$, which is false.\nThus, the Nash condition is never met. A population of Doves can always be invaded by mutant Hawks, since a Hawk does better against a Dove ($V$) than a Dove does against another Dove ($\\frac{V}{2}$).\nTherefore, the pure strategy $D$ is never an ESS.\n\n**Mixed Strategy $p^\\ast = V/C$:**\nThis strategy is only relevant for the case where it represents an internal equilibrium, i.e., $V  C$. Let $S^\\ast$ be the mixed strategy where Hawks are played with probability $p^\\ast=V/C$. Let $S$ be a mutant strategy with proportion $p \\ne p^\\ast$ of Hawks.\nThe payoff to a strategy with proportion $p_1$ Hawks against a population with proportion $p_2$ Hawks is $U(p_1, p_2) = p_1 U_H(p_2) + (1-p_1)U_D(p_2)$.\nBy definition of the mixed Nash equilibrium $p^\\ast$, we have $U_H(p^\\ast) = U_D(p^\\ast)$.\nCheck the Nash condition: $U(S^\\ast, S^\\ast) \\ge U(S, S^\\ast)$.\n$U(S^\\ast, S^\\ast) = p^\\ast U_H(p^\\ast) + (1-p^\\ast)U_D(p^\\ast) = p^\\ast U_H(p^\\ast) + (1-p^\\ast)U_H(p^\\ast) = U_H(p^\\ast)$.\n$U(S, S^\\ast) = p U_H(p^\\ast) + (1-p)U_D(p^\\ast) = p U_H(p^\\ast) + (1-p)U_H(p^\\ast) = U_H(p^\\ast)$.\nSo, $U(S^\\ast, S^\\ast) = U(S, S^\\ast)$ for any mutant strategy $S$. The Nash condition holds with equality.\n\nWe must check the stability condition: $U(S^\\ast, S)  U(S, S)$.\n$U(S^\\ast, S) = p^\\ast U_H(p) + (1-p^\\ast)U_D(p)$.\n$U(S, S) = p U_H(p) + (1-p)U_D(p)$.\nThe condition is $p^\\ast U_H(p) + (1-p^\\ast)U_D(p)  p U_H(p) + (1-p)U_D(p)$.\nRearranging the terms:\n$$\n(p^\\ast - p)U_H(p) - (p^\\ast - p)U_D(p)  0\n$$\n$$\n(p^\\ast - p)[U_H(p) - U_D(p)]  0\n$$\nLet's analyze the term $U_H(p) - U_D(p)$:\n$$\nU_H(p) - U_D(p) = \\left(V - p\\left(\\frac{V+C}{2}\\right)\\right) - \\left(\\frac{V}{2} - \\frac{pV}{2}\\right) = \\frac{V}{2} - p\\left(\\frac{C}{2}\\right) = \\frac{1}{2}(V-pC)\n$$\nSince $p^\\ast = V/C$, we have $V = p^\\ast C$. Substituting this into the expression:\n$$\nU_H(p) - U_D(p) = \\frac{1}{2}(p^\\ast C - pC) = \\frac{C}{2}(p^\\ast - p)\n$$\nSubstituting this back into the stability condition inequality:\n$$\n(p^\\ast - p)\\left[\\frac{C}{2}(p^\\ast - p)\\right]  0\n$$\n$$\n\\frac{C}{2}(p^\\ast - p)^2  0\n$$\nSince $p \\ne p^\\ast$, $(p^\\ast - p)^2  0$. As we are given $C0$, the inequality $\\frac{C}{2}(p^\\ast - p)^2  0$ is always true.\nTherefore, the mixed strategy $p^\\ast = V/C$ is an ESS if and only if it represents a valid internal equilibrium, which is when $V  C$.\n\n**Summary of ESS results:**\n- If $V \\ge C$, the unique ESS is the pure strategy $H$ (all Hawks).\n- If $V  C$, the unique ESS is the mixed strategy $p^\\ast=V/C$.\n- The pure strategy $D$ (all Doves) is never an ESS.\n\nThe problem asks for the expression for $p^\\ast$ found in item $2$.",
            "answer": "$$\n\\boxed{\\frac{V}{C}}\n$$"
        },
        {
            "introduction": "A common point of confusion is the precise relationship between a Nash Equilibrium (NE) and an Evolutionarily Stable Strategy (ESS). While every ESS is a Nash equilibrium, the converse is not true. This practice is designed to clarify this crucial distinction by having you analyze a carefully constructed counterexample . By demonstrating why a specific NE fails the ESS stability condition, you will develop a more nuanced understanding of why evolutionary stability is a stricter requirement than the static equilibrium concept.",
            "id": "4275307",
            "problem": "Consider a symmetric two-strategy game played on a well-mixed population (equivalently, a complete interaction network) with two pure strategies $x$ and $y$. Let the payoff function be denoted by $\\pi(s,t)$, the payoff to a player using strategy $s$ against an opponent using strategy $t$. Assume the following payoffs:\n$$\n\\pi(x,x) = 5,\\quad \\pi(x,y) = 1,\\quad \\pi(y,x) = 5,\\quad \\pi(y,y) = 3.\n$$\nWork within the standard definitions of Nash equilibrium (NE) and Evolutionarily Stable Strategy (ESS) in symmetric games:\n- A strategy $x$ is a symmetric Nash equilibrium if, for all strategies $y$, $\\pi(x,x) \\ge \\pi(y,x)$.\n- A strategy $x$ is an Evolutionarily Stable Strategy (ESS) if, for all strategies $y \\neq x$, $\\pi(x,x) \\ge \\pi(y,x)$, and whenever $\\pi(x,x) = \\pi(y,x)$, it additionally holds that $\\pi(x,y)  \\pi(y,y)$.\n\nDefine a resident population consisting entirely of $x$, and consider a mutant invasion by $y$ at small frequency $\\varepsilon \\in (0,1)$, so the population mix is $p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$. Because payoffs in symmetric two-player games are linear in population frequencies, the expected payoff to a strategy $s$ against the population $p_{\\varepsilon}$ is $\\pi(s,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(s,x) + \\varepsilon \\pi(s,y)$.\n\nTask:\n1. Using only the definitions stated above, demonstrate that $x$ is a symmetric Nash equilibrium but is not an Evolutionarily Stable Strategy in this game, and explain why the mutant $y$ can neutralize or beat $x$ in terms of invasion resistance.\n2. Let $D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$ denote the mutant’s expected payoff advantage at frequency $\\varepsilon$. Derive $D(\\varepsilon)$ to first order in $\\varepsilon$ and compute the right-hand derivative $D'(0^{+})$. Report the value of $D'(0^{+})$ as your final numeric answer. No rounding is required, and no units should be included.",
            "solution": "The problem is first validated against the required criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- **Game Type**: Symmetric two-strategy game on a well-mixed population.\n- **Strategies**: Two pure strategies, denoted by $x$ and $y$.\n- **Payoff Function**: $\\pi(s,t)$ is the payoff to strategy $s$ against strategy $t$.\n- **Payoff Values**:\n  - $\\pi(x,x) = 5$\n  - $\\pi(x,y) = 1$\n  - $\\pi(y,x) = 5$\n  - $\\pi(y,y) = 3$\n- **Definition of Symmetric Nash Equilibrium (NE)**: A strategy $x$ is a symmetric NE if for all strategies $y$, $\\pi(x,x) \\ge \\pi(y,x)$.\n- **Definition of Evolutionarily Stable Strategy (ESS)**: A strategy $x$ is an ESS if for all strategies $y \\neq x$:\n  1. $\\pi(x,x) \\ge \\pi(y,x)$ (NE condition)\n  2. If $\\pi(x,x) = \\pi(y,x)$, then $\\pi(x,y)  \\pi(y,y)$ (stability condition).\n- **Population Mix**: $p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$ for a mutant frequency $\\varepsilon \\in (0,1)$.\n- **Expected Payoff**: $\\pi(s,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(s,x) + \\varepsilon \\pi(s,y)$.\n- **Mutant Payoff Advantage**: $D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a standard application of evolutionary game theory, using the canonical definitions of Nash Equilibrium and Evolutionarily Stable Strategy. These are fundamental concepts in complex systems, economics, and theoretical biology.\n- **Well-Posed**: The problem is mathematically well-defined. It provides all necessary data (payoff matrix) and formal definitions to perform the required tasks. The questions are specific and lead to a unique, computable answer.\n- **Objective**: The problem is stated in precise, formal language, free from subjectivity or ambiguity.\n- **Conclusion**: The problem is internally consistent, scientifically valid, and well-posed. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe solution is addressed in two parts as requested by the problem statement.\n\n**Part 1: Analysis of Strategy $x$ as NE and ESS**\n\nTo determine if strategy $x$ is a symmetric Nash equilibrium (NE), we must check if the condition $\\pi(x,x) \\ge \\pi(y,x)$ holds for the alternative strategy $y$.\n- From the givens, we have $\\pi(x,x) = 5$ and $\\pi(y,x) = 5$.\n- The inequality is $5 \\ge 5$, which is true.\n- Therefore, strategy $x$ is a symmetric Nash equilibrium.\n\nNext, we check if $x$ is an Evolutionarily Stable Strategy (ESS). An ESS must satisfy two conditions for any alternative strategy $y \\neq x$:\n1.  $\\pi(x,x) \\ge \\pi(y,x)$\n2.  If $\\pi(x,x) = \\pi(y,x)$, then $\\pi(x,y)  \\pi(y,y)$\n\nWe have already established that the first condition holds. Furthermore, we found that the equality $\\pi(x,x) = \\pi(y,x)$ is met, since $5 = 5$. This requires us to check the mandatory second condition, the stability condition.\n- The stability condition is $\\pi(x,y)  \\pi(y,y)$.\n- From the givens, we have $\\pi(x,y) = 1$ and $\\pi(y,y) = 3$.\n- The inequality becomes $1  3$, which is false.\n- Since the stability condition is violated, strategy $x$ is **not** an Evolutionarily Stable Strategy.\n\nThe reason the mutant strategy $y$ can invade and \"beat\" the resident strategy $x$ is directly explained by the failure of these conditions. The first condition, $\\pi(x,x) = \\pi(y,x)$, implies that a single mutant $y$ entering a population of $x$-strategists does exactly as well as the residents. It is not at an immediate disadvantage, so it is not selected against. This is what is meant by $y$ being able to \"neutralize\" $x$ upon initial appearance.\n\nThe stability condition, $\\pi(x,y)  \\pi(y,y)$, is designed to check what happens when the mutant frequency $\\varepsilon$ becomes slightly positive. When $\\varepsilon  0$, individuals sometimes interact with mutants. A resident $x$ interacts with a mutant $y$ with payoff $\\pi(x,y)$. A mutant $y$ interacts with another mutant $y$ with payoff $\\pi(y,y)$. The failure of the stability condition, i.e., $\\pi(x,y)  \\pi(y,y)$ being false, means that $\\pi(x,y) \\le \\pi(y,y)$. In this specific case, $\\pi(x,y)  \\pi(y,y)$ since $1  3$. This means that in the rare events that mutants interact with each other, they receive a higher payoff than residents do when they interact with mutants. This gives the mutant strategy a net selective advantage once its frequency is non-zero, allowing it to \"beat\" the resident population and increase in frequency.\n\n**Part 2: Derivation of $D(\\varepsilon)$ and $D'(0^{+})$**\n\nThe mutant's expected payoff advantage, $D(\\varepsilon)$, is defined as $D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$, where $p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$ is the population state.\n\nFirst, we write out the expressions for the expected payoffs $\\pi(x,p_{\\varepsilon})$ and $\\pi(y,p_{\\varepsilon})$:\n$$\n\\pi(x,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(x,x) + \\varepsilon \\pi(x,y)\n$$\n$$\n\\pi(y,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(y,x) + \\varepsilon \\pi(y,y)\n$$\nNow, we compute their difference:\n$$\nD(\\varepsilon) = \\left[ (1-\\varepsilon)\\pi(y,x) + \\varepsilon \\pi(y,y) \\right] - \\left[ (1-\\varepsilon)\\pi(x,x) + \\varepsilon \\pi(x,y) \\right]\n$$\nWe can group terms by $(1-\\varepsilon)$ and $\\varepsilon$:\n$$\nD(\\varepsilon) = (1-\\varepsilon)[\\pi(y,x) - \\pi(x,x)] + \\varepsilon[\\pi(y,y) - \\pi(x,y)]\n$$\nNow, substitute the given payoff values:\n- $\\pi(x,x) = 5$\n- $\\pi(y,x) = 5$\n- $\\pi(x,y) = 1$\n- $\\pi(y,y) = 3$\nSubstituting these into the expression for $D(\\varepsilon)$:\n$$\nD(\\varepsilon) = (1-\\varepsilon)[5 - 5] + \\varepsilon[3 - 1]\n$$\n$$\nD(\\varepsilon) = (1-\\varepsilon)(0) + \\varepsilon(2)\n$$\n$$\nD(\\varepsilon) = 2\\varepsilon\n$$\nThis expression is already linear in $\\varepsilon$, so it is its own first-order approximation around $\\varepsilon=0$.\n\nTo find the right-hand derivative at $\\varepsilon=0$, denoted $D'(0^{+})$, we differentiate $D(\\varepsilon)$ with respect to $\\varepsilon$:\n$$\nD'(\\varepsilon) = \\frac{d}{d\\varepsilon}(2\\varepsilon) = 2\n$$\nSince the derivative is a constant, its value at any point, including the right-hand limit at $0$, is $2$.\n$$\nD'(0^{+}) = 2\n$$\nThis positive value for $D'(0^{+})$ confirms that the mutant strategy $y$ has an initial growth advantage in a population dominated by $x$, which is consistent with our conclusion that $x$ is not an ESS.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Moving from case-by-case analysis to general methods, this practice challenges you to formalize the verification of a mixed-strategy ESS into a computational algorithm. You will translate the abstract theoretical requirements—the equal-payoff condition for the support set and the second-order stability condition—into a concrete, verifiable procedure. This exercise  builds a bridge from theoretical understanding to practical implementation, a critical skill for analyzing games with larger strategy spaces where manual inspection is infeasible.",
            "id": "4275309",
            "problem": "Consider a symmetric two-player evolutionary game with a finite set of $n$ pure strategies and a real payoff matrix $A \\in \\mathbb{R}^{n \\times n}$. A mixed strategy is a vector $x \\in \\Delta_n$, where $\\Delta_n = \\{x \\in \\mathbb{R}^n \\mid \\sum_{i=1}^n x_i = 1, x_i \\ge 0\\}$, and its support is the index set $S = \\{i \\in \\{1,\\dots,n\\} \\mid x_i  0\\}$. A mixed strategy $x$ is evolutionarily stable if it is a symmetric Nash equilibrium and is locally uninvadable by nearby mutants.\n\nStarting only from the core definitions of symmetric Nash equilibrium and the notion that an evolutionarily stable strategy must be a strict local maximizer of the population payoff subject to the simplex constraints, design and implement an algorithm that, given a payoff matrix $A$ and a candidate support $S$, carries out the following tasks:\n\n1. Solve the equal-payoff constraints on the support $S$ to construct a candidate mixed strategy $x$ with support $S$ and an associated scalar payoff $u$, ensuring $x \\in \\Delta_n$.\n2. Verify that no pure strategy outside $S$ attains a higher expected payoff against $x$ than the common payoff $u$ of the strategies in $S$.\n3. Form the symmetric part of the payoff interaction and the corresponding Hessian of the population payoff, restrict this Hessian to the tangent space of the simplex at $x$ within the face spanned by $S$, and check strict negative definiteness on that tangent space.\n\nReturn a boolean indicating whether a mixed evolutionarily stable strategy exists for the given support $S$ under the given payoff matrix $A$.\n\nAssume all computations are over the real numbers and use a numerical tolerance of $\\varepsilon = 10^{-9}$ when comparing reals. Indices are to be interpreted in zero-based form.\n\nYour program must implement the above algorithm and evaluate it on the following test suite. For each test case, the input is a payoff matrix $A$ and a support set $S$, both specified explicitly. The required output for each test case is a boolean that is true if the algorithm certifies the existence of a mixed evolutionarily stable strategy with the given support, and false otherwise.\n\nTest suite:\n\n1. Three-strategy symmetric attraction game with fully mixed support. Let\n$$\nA_1 = \\begin{pmatrix}\n1  2  2 \\\\\n2  1  2 \\\\\n2  2  1\n\\end{pmatrix}, \\quad S_1 = \\{0,1,2\\}.\n$$\n\n2. Three-strategy rock–paper–scissors zero-sum interaction with fully mixed support. Let\n$$\nA_2 = \\begin{pmatrix}\n0  -1  1 \\\\\n1  0  -1 \\\\\n-1  1  0\n\\end{pmatrix}, \\quad S_2 = \\{0,1,2\\}.\n$$\n\n3. Three-strategy weakly synergistic interaction with fully mixed support. Let\n$$\nA_3 = \\begin{pmatrix}\n1  0.2  0.2 \\\\\n0.2  1  0.2 \\\\\n0.2  0.2  1\n\\end{pmatrix}, \\quad S_3 = \\{0,1,2\\}.\n$$\n\n4. Three-strategy interaction with a two-strategy support. Let\n$$\nA_4 = \\begin{pmatrix}\n1  2  -1 \\\\\n2  1  -1 \\\\\n-1  -1  -2\n\\end{pmatrix}, \\quad S_4 = \\{0,1\\}.\n$$\n\n5. Two-strategy identity interaction with fully mixed support. Let\n$$\nA_5 = \\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}, \\quad S_5 = \\{0,1\\}.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $5$. For example, the output must be of the form\n`[result_1,result_2,result_3,result_4,result_5]`,\nwhere each $\\text{result}_k$ is a boolean. No physical units or angle units are involved, and no percentages are to be used; all values are pure real numbers and booleans. The algorithmic design must be principled and directly derived from the foundational definitions, and the implementation must be self-contained with no external inputs or files.",
            "solution": "The problem requires the design and implementation of an algorithm to determine if a given support set $S$ for a symmetric two-player game with payoff matrix $A$ corresponds to a mixed evolutionarily stable strategy (ESS). The algorithm must be derived from the foundational definitions of a symmetric Nash equilibrium and the characterization of an ESS as a strict local maximizer of the population payoff on the simplex.\n\nAn evolutionarily stable strategy $x$ must satisfy two primary conditions:\n1.  **Nash Equilibrium Condition**: The strategy $x$ must be a symmetric Nash equilibrium (NE).\n2.  **Stability Condition**: The strategy $x$ must be robust against invasion by mutant strategies.\n\nThese two conditions can be translated into a concrete, three-step computational procedure as outlined in the problem statement. We will formalize each step.\n\nLet $A \\in \\mathbb{R}^{n \\times n}$ be the payoff matrix and $S \\subseteq \\{0, 1, \\dots, n-1\\}$ be the candidate support set of size $k = |S|$. A mixed strategy $x$ with support $S$ has $x_i  0$ for $i \\in S$ and $x_i=0$ for $i \\notin S$.\n\n### Step 1: Candidate Strategy Identification\n\nFor a mixed strategy $x$ with support $S$ to be a symmetric Nash Equilibrium, all pure strategies $i \\in S$ that are played with positive probability must yield the same expected payoff. Let this common payoff be $u$. This is known as the equal-payoff condition.\nThe expected payoff for a pure strategy $i$ against a mixed strategy $x$ is given by the $i$-th component of the vector $Ax$, i.e., $(Ax)_i = \\sum_{j=0}^{n-1} A_{ij} x_j$.\n\nThe conditions to find the candidate strategy $x$ and its payoff $u$ are:\n1.  Equal payoffs on the support: $(Ax)_i = u$ for all $i \\in S$.\n2.  Simplex constraint: $\\sum_{i=0}^{n-1} x_i = 1$.\n\nSince $x_j=0$ for $j \\notin S$, these conditions can be written as a system of linear equations involving only the components $x_i$ for $i \\in S$:\n$$\n\\sum_{j \\in S} A_{ij} x_j = u, \\quad \\forall i \\in S\n$$\n$$\n\\sum_{j \\in S} x_j = 1\n$$\nThis constitutes a system of $k+1$ linear equations for the $k$ unknown probabilities $\\{x_i\\}_{i \\in S}$ and the unknown payoff $u$. Let $x_S$ be the vector of probabilities on the support $S$. We can write the system in matrix form:\n$$\n\\begin{pmatrix} A_{S,S}  -\\mathbf{1} \\\\ \\mathbf{1}^T  0 \\end{pmatrix} \\begin{pmatrix} x_S \\\\ u \\end{pmatrix} = \\begin{pmatrix} \\mathbf{0} \\\\ 1 \\end{pmatrix}\n$$\nwhere $A_{S,S}$ is the $k \\times k$ submatrix of $A$ with rows and columns corresponding to indices in $S$, and $\\mathbf{1}$ is a $k$-dimensional column vector of ones.\n\nThis system is solved for the vector $[x_S^T, u]^T$. If the matrix on the left is singular, no unique solution exists, and no ESS can be formed on this support. After solving, we must verify that the solution is a valid mixed strategy, which requires $x_i  \\varepsilon$ for all $i \\in S$, where $\\varepsilon = 10^{-9}$ is the numerical tolerance. If any $x_i \\le \\varepsilon$, the true support is a proper subset of $S$, so the given support $S$ is invalid.\n\n### Step 2: Nash Equilibrium Verification\n\nThe NE condition further requires that no pure strategy outside the support can achieve a strictly better payoff than the strategies inside the support. That is, for any pure strategy $j \\notin S$, its payoff against $x$ must not exceed $u$.\n$$\n(Ax)_j = \\sum_{i \\in S} A_{ji} x_i \\le u, \\quad \\forall j \\notin S\n$$\nIf this inequality (checked with tolerance, $\\sum_{i \\in S} A_{ji} x_i \\le u + \\varepsilon$) is violated for any $j \\notin S$, an agent could improve their payoff by switching to pure strategy $j$, meaning $x$ is not a Nash equilibrium. In this case, $x$ cannot be an ESS.\n\n### Step 3: Second-Order (Stability) Condition\n\nThis step formalizes the notion of an ESS as a strict local maximizer of the population payoff. The average payoff of an individual playing strategy $y$ in a population dominated by strategy $x$ is $y^T A x$. The average population payoff is $x^T A x$. An ESS is a strategy $x$ such that for any mutant strategy $y \\neq x$, if $y^T A x = x^T A x$, then $x^T A y  y^T A y$.\n\nFor a candidate strategy $x$ which is an interior point of a face of the simplex (i.e., $(Ax)_j  u$ for all $j \\notin S$), this stability condition simplifies to a local second-order condition. We must check if $x$ is a strict local maximum of the population payoff function $f(y) = y^T A y$ when restricted to the simplex face defined by the support $S$.\nThe Hessian of the payoff function $f(y)$ is $H = A + A^T$.\nFor a strict local maximum, the quadratic form $v^T H v$ must be strictly negative for all non-zero vectors $v$ in the tangent space of the constraint manifold at $x$.\n\nThe constraint manifold is the face of the simplex corresponding to the support $S$, defined by $\\{y \\in \\mathbb{R}^n \\mid \\sum_{i \\in S} y_i = 1, y_i \\ge 0 \\forall i \\in S, y_j=0 \\forall j \\notin S\\}$. The tangent space at $x$ within this face is the set of vectors $v$ such that $v_j=0$ for $j \\notin S$ and $\\sum_{i \\in S} v_i = 0$.\n\nLet $H_S$ be the $k \\times k$ submatrix of $H$ corresponding to the indices in $S$. The condition is that $v_S^T H_S v_S  0$ for all non-zero vectors $v_S \\in \\mathbb{R}^k$ such that $\\mathbf{1}^T v_S = 0$. This is equivalent to checking if the matrix $H_S$ is strictly negative definite on the $(k-1)$-dimensional tangent space.\n\nTo verify this, we can construct an orthonormal basis for this tangent space. Let $N$ be a $k \\times (k-1)$ matrix whose columns form such a basis. The quadratic form restricted to this subspace is represented by the $(k-1) \\times (k-1)$ matrix $H_{proj} = N^T H_S N$. Strict negative definiteness requires all eigenvalues of $H_{proj}$ to be strictly negative. We check if the maximum eigenvalue of $H_{proj}$ is less than $-\\varepsilon$. If this holds, the stability condition is satisfied.\n\nIf all three steps are successfully completed, the mixed strategy $x$ with support $S$ is certified as an ESS. A failure at any step implies it is not. A mixed ESS must have a support of size $k \\ge 2$; otherwise, the tangent space for the stability analysis is trivial and the concept is typically applied to situations with genuine mixing.\n```python\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef is_ess(A: np.ndarray, S: set, eps: float = 1e-9) -> bool:\n    \"\"\"\n    Checks if a mixed strategy with a given support S is an ESS.\n\n    Args:\n        A: The n x n payoff matrix.\n        S: The set of indices for the support.\n        eps: Numerical tolerance.\n\n    Returns:\n        True if an ESS with support S exists, False otherwise.\n    \"\"\"\n    n = A.shape[0]\n    support_indices = sorted(list(S))\n    k = len(support_indices)\n\n    # A mixed ESS requires at least two strategies in its support.\n    # The stability analysis is non-trivial only for k >= 2.\n    if k  2:\n        return False\n\n    # Task 1: Find the candidate strategy x and its payoff u.\n    # This involves solving a system of k+1 linear equations.\n    # M * z = b, where z = [x_s_1, ..., x_s_k, u]^T\n    A_S = A[np.ix_(support_indices, support_indices)]\n    \n    M = np.zeros((k + 1, k + 1))\n    M[:k, :k] = A_S\n    M[:k, k] = -1.0\n    M[k, :k] = 1.0\n    \n    b = np.zeros(k + 1)\n    b[k] = 1.0\n\n    try:\n        z = np.linalg.solve(M, b)\n    except np.linalg.LinAlgError:\n        # The system is singular, so no unique solution for x and u exists.\n        return False\n\n    x_S = z[:k]\n    u = z[k]\n\n    # Check if the solution is a valid mixed strategy (all probabilities must be positive).\n    if np.any(x_S = eps):\n        # If any probability is non-positive, the assumed support S is incorrect.\n        return False\n\n    # Task 2: Verify the Nash Equilibrium condition.\n    # No pure strategy outside the support should yield a better payoff.\n    x = np.zeros(n)\n    x[support_indices] = x_S\n    \n    non_support_indices = [i for i in range(n) if i not in S]\n    if non_support_indices:\n        payoffs_against_x = A @ x\n        for j in non_support_indices:\n            if payoffs_against_x[j] > u + eps:\n                return False\n\n    # Task 3: Verify the second-order (stability) condition.\n    # The Hessian of the population payoff must be negative definite on the tangent space.\n    H = A + A.T\n    H_S = H[np.ix_(support_indices, support_indices)]\n\n    # Construct an orthonormal basis for the tangent space of the simplex face.\n    # This space consists of vectors v in R^k such that sum(v_i) = 0.\n    # The columns of `basis_vectors` form such a basis.\n    if k > 1:\n        basis_vectors = null_space(np.ones((1, k)))\n    else: # Should not happen due to k2 check, but for robustness\n        return True # Vacuously true, no deviation possible\n\n    # Project the Hessian submatrix H_S onto the tangent space.\n    H_proj = basis_vectors.T @ H_S @ basis_vectors\n    \n    # Check for negative definiteness by inspecting the eigenvalues of the projected Hessian.\n    # For a symmetric matrix, we can use eigvalsh for efficiency and stability.\n    try:\n        eigenvalues = np.linalg.eigvalsh(H_proj)\n    except np.linalg.LinAlgError:\n        # This is unlikely for a symmetric matrix unless it's ill-conditioned.\n        return False\n\n    # All eigenvalues must be strictly negative.\n    if np.max(eigenvalues)  -eps:\n        return True\n    else:\n        return False\n\ndef solve():\n    \"\"\"\n    Runs the ESS validation algorithm on a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: Symmetric attraction game\n        (np.array([[1, 2, 2], [2, 1, 2], [2, 2, 1]], dtype=float), {0, 1, 2}),\n        \n        # Case 2: Rock-Paper-Scissors\n        (np.array([[0, -1, 1], [1, 0, -1], [-1, 1, 0]], dtype=float), {0, 1, 2}),\n        \n        # Case 3: Weakly synergistic interaction\n        (np.array([[1, 0.2, 0.2], [0.2, 1, 0.2], [0.2, 0.2, 1]], dtype=float), {0, 1, 2}),\n\n        # Case 4: Interaction with a two-strategy support\n        (np.array([[1, 2, -1], [2, 1, -1], [-1, -1, -2]], dtype=float), {0, 1}),\n\n        # Case 5: Two-strategy identity interaction (coordination game)\n        (np.array([[1, 0], [0, 1]], dtype=float), {0, 1})\n    ]\n\n    results = []\n    for A, S in test_cases:\n        result = is_ess(A, S)\n        results.append(str(result).lower())\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```",
            "answer": "$$\n\\boxed{\\texttt{[true,false,false,true,false]}}\n$$"
        }
    ]
}