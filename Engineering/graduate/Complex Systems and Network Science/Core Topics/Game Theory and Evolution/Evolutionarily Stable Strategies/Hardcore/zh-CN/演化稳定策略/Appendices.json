{
    "hands_on_practices": [
        {
            "introduction": "鹰鸽博弈是演化博弈论的基石模型，它清晰地揭示了冲突与合作之间的权衡。本练习将指导你从基本定义出发，通过计算预期收益和应用演化稳定策略（ESS）的条件，来确定该模型中的纯策略和混合策略ESS，从而掌握分析ESS的核心数学方法。通过解决这个问题 ，你将能够处理最经典的演化博弈场景。",
            "id": "4275246",
            "problem": "考虑一个进行对称双策略博弈的充分混合的无限大种群，策略为鹰 ($H$) 和鸽 ($D$)。行局中人的支付矩阵为\n$$\nA = \\begin{pmatrix}\n\\frac{V-C}{2}  V \\\\\n0  \\frac{V}{2}\n\\end{pmatrix}\n$$\n其中 $V$ 表示争夺资源的价值，$C$ 表示冲突升级的成本。假设 $V>0$ 且 $C>0$。一个混合种群以频率 $p \\in [0,1]$ 使用鹰策略，以频率 $1-p$ 使用鸽策略。\n\n从充分混合种群中期望支付的定义和对称博弈中对称演化稳定策略 (ESS) 的定义出发，完成以下任务：\n\n1. 当种群混合比例为 $p$ 时，推导策略 $H$ 和 $D$ 的期望支付 $U_H(p)$ 和 $U_D(p)$。\n2. 使用混合策略中的对称纳什均衡的定义，通过令 $H$ 和 $D$ 的期望支付相等来计算鹰策略的混合均衡比例 $p^\\ast$。将 $p^\\ast$ 表示为关于 $V$ 和 $C$ 的闭式表达式。\n3. 使用对称博弈的ESS定义，确定对于 $V$ 和 $C$ 的哪些参数范围，纯策略（$H$ 或 $D$）是ESS或不是ESS。同时确定混合策略 $p^\\ast$ 是ESS的参数范围。基于ESS条件提供严格的证明，而不是诉诸于记忆中的判据。\n4. 对于最终答案，仅报告你在第2项中找到的 $p^\\ast$ 的表达式。\n\n如果你在中间检查中提供了任何数值近似，请明确说明；然而，$p^\\ast$ 的最终表达式必须是精确的闭式形式。不需要四舍五入。最终答案应只包含所要求的 $p^\\ast$ 表达式，不带单位。",
            "solution": "该问题陈述被认为是有效的，因为它是演化博弈论领域一个适定的、有科学依据的、客观的问题。所有必要的数据和定义都已提供，没有矛盾或歧义。\n\n任务是分析鹰 ($H$) 和鸽 ($D$) 之间的对称双策略博弈，给定行局中人的支付矩阵为：\n$$\nA=\\begin{pmatrix}\nU(H, H)  U(H, D) \\\\\nU(D, H)  U(D, D)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{V-C}{2}  V \\\\\n0  \\frac{V}{2}\n\\end{pmatrix}\n$$\n参数 $V$ 和 $C$ 均为正，即 $V>0$ 且 $C>0$。种群由比例为 $p$ 的鹰和 $1-p$ 的鸽组成，其中 $p \\in [0,1]$。\n\n**1. 期望支付的推导**\n\n一个个体采用某种策略的期望支付，是通过将与种群中每种策略对抗的支付按这些策略的频率加权平均来计算的。\n\n鹰策略使用者（Hawk player）的期望支付 $U_H(p)$ 是其遇到另一只鹰（概率为 $p$）的支付加上遇到一只鸽（概率为 $1-p$）的支付：\n$$\nU_H(p) = p \\cdot U(H, H) + (1-p) \\cdot U(H, D)\n$$\n代入支付矩阵 $A$ 中的值：\n$$\nU_H(p) = p \\left(\\frac{V-C}{2}\\right) + (1-p)V = \\frac{pV}{2} - \\frac{pC}{2} + V - pV = V - p\\left(\\frac{V+C}{2}\\right)\n$$\n\n类似地，鸽策略使用者（Dove player）的期望支付 $U_D(p)$ 是：\n$$\nU_D(p) = p \\cdot U(D, H) + (1-p) \\cdot U(D, D)\n$$\n代入支付矩阵 $A$ 中的值：\n$$\nU_D(p) = p(0) + (1-p)\\frac{V}{2} = \\frac{V}{2} - \\frac{pV}{2}\n$$\n\n**2. 混合均衡比例 $p^\\ast$ 的计算**\n\n混合策略纳什均衡，记为 $p^\\ast$，在纯策略的期望支付相等时出现，意味着个体在选择鹰策略或鸽策略之间是无差异的。此均衡位于策略空间内部，即 $p^\\ast \\in (0,1)$。我们通过设 $U_H(p^\\ast) = U_D(p^\\ast)$ 来求解 $p^\\ast$：\n$$\nV - p^\\ast\\left(\\frac{V+C}{2}\\right) = \\frac{V}{2} - \\frac{p^\\ast V}{2}\n$$\n为了解出 $p^\\ast$，我们整理方程：\n$$\nV - \\frac{V}{2} = p^\\ast\\left(\\frac{V+C}{2}\\right) - \\frac{p^\\ast V}{2}\n$$\n$$\n\\frac{V}{2} = p^\\ast\\left(\\frac{V+C-V}{2}\\right)\n$$\n$$\n\\frac{V}{2} = p^\\ast\\left(\\frac{C}{2}\\right)\n$$\n假设 $C \\neq 0$，由于 $C>0$ 这是成立的，我们可以解出 $p^\\ast$：\n$$\np^\\ast = \\frac{V}{C}\n$$\n为了使 $p^\\ast$ 成为一个*内部*均衡中有效的混合策略比例，它必须满足 $0  p^\\ast  1$。鉴于 $V>0$ 和 $C>0$，$p^\\ast > 0$ 总是成立的。条件 $p^\\ast  1$ 要求 $V/C  1$，即 $V  C$。\n\n**3. 演化稳定策略 (ESS) 的分析**\n\n一个策略 $S^\\ast$ 是一个演化稳定策略 (ESS)，如果对于任何替代（“突变”）策略 $S \\ne S^\\ast$，以下两个条件成立：\n1.  **纳什均衡条件：** $U(S^\\ast, S^\\ast) \\ge U(S, S^\\ast)$\n2.  **稳定性条件：** 如果 $U(S^\\ast, S^\\ast) = U(S, S^\\ast)$，则 $U(S^\\ast, S) > U(S, S)$\n\n我们将分析纯策略和混合策略。\n\n**纯策略 $H$ (Hawk):**\n令 $S^\\ast = H$。入侵的突变体采用策略 $S=D$。\n我们检查纳什条件：$U(H, H) \\ge U(D, H)$。根据支付矩阵，这等价于：\n$$\n\\frac{V-C}{2} \\ge 0 \\implies V \\ge C\n$$\n如果 $V > C$，不等式是严格的 ($U(H, H) > U(D, H)$)。纳什条件被严格满足，所以 $H$ 是一个ESS。一个鹰种群不能被突变的鸽策略入侵，因为鹰对抗其他鹰比鸽对抗鹰做得更好。\n如果 $V = C$，纳什条件等号成立 ($U(H, H) = U(D, H) = 0$)。我们必须检查稳定性条件，其中 $S^\\ast = H$ 且 $S=D$：$U(H, D) > U(D, D)$。根据支付矩阵，这等价于：\n$$\nV > \\frac{V}{2}\n$$\n因为已知 $V>0$，这个不等式总是成立的。\n因此，纯策略 $H$ 是ESS当且仅当 $V \\ge C$。\n\n**纯策略 $D$ (Dove):**\n令 $S^\\ast = D$。入侵的突变体采用策略 $S=H$。\n我们检查纳什条件：$U(D, D) \\ge U(H, D)$。根据支付矩阵，这等价于：\n$$\n\\frac{V}{2} \\ge V\n$$\n因为 $V>0$，这可以化简为 $\\frac{1}{2} \\ge 1$，这是不成立的。\n因此，纳什条件永远不会满足。一个鸽种群总是可以被突变的鹰策略入侵，因为鹰对抗鸽 ($V$) 比鸽对抗另一只鸽 ($\\frac{V}{2}$) 做得更好。\n因此，纯策略 $D$ 永远不是ESS。\n\n**混合策略 $p^\\ast = V/C$:**\n这个策略仅在它代表一个内部均衡的情况下有意义，即 $V  C$。令 $S^\\ast$ 为以概率 $p^\\ast=V/C$ 使用鹰策略的混合策略。令 $S$ 为一个鹰策略比例为 $p \\ne p^\\ast$ 的突变策略。\n一个鹰策略比例为 $p_1$ 的策略对抗一个鹰策略比例为 $p_2$ 的种群的支付是 $U(p_1, p_2) = p_1 U_H(p_2) + (1-p_1)U_D(p_2)$。\n根据混合纳什均衡 $p^\\ast$ 的定义，我们有 $U_H(p^\\ast) = U_D(p^\\ast)$。\n检查纳什均衡条件：$U(S^\\ast, S^\\ast) \\ge U(S, S^\\ast)$。\n$U(S^\\ast, S^\\ast) = p^\\ast U_H(p^\\ast) + (1-p^\\ast)U_D(p^\\ast) = p^\\ast U_H(p^\\ast) + (1-p^\\ast)U_H(p^\\ast) = U_H(p^\\ast)$。\n$U(S, S^\\ast) = p U_H(p^\\ast) + (1-p)U_D(p^\\ast) = p U_H(p^\\ast) + (1-p)U_H(p^\\ast) = U_H(p^\\ast)$。\n所以，对于任何突变策略 $S$，$U(S^\\ast, S^\\ast) = U(S, S^\\ast)$。纳什条件等号成立。\n\n我们必须检查稳定性条件：$U(S^\\ast, S) > U(S, S)$。\n$U(S^\\ast, S) = p^\\ast U_H(p) + (1-p^\\ast)U_D(p)$。\n$U(S, S) = p U_H(p) + (1-p)U_D(p)$。\n条件是 $p^\\ast U_H(p) + (1-p^\\ast)U_D(p) > p U_H(p) + (1-p)U_D(p)$。\n整理各项：\n$$\n(p^\\ast - p)U_H(p) - (p^\\ast - p)U_D(p) > 0\n$$\n$$\n(p^\\ast - p)[U_H(p) - U_D(p)] > 0\n$$\n我们来分析 $U_H(p) - U_D(p)$ 这一项：\n$$\nU_H(p) - U_D(p) = \\left(V - p\\left(\\frac{V+C}{2}\\right)\\right) - \\left(\\frac{V}{2} - \\frac{pV}{2}\\right) = \\frac{V}{2} - p\\left(\\frac{C}{2}\\right) = \\frac{1}{2}(V-pC)\n$$\n由于 $p^\\ast = V/C$，我们有 $V = p^\\ast C$。将此代入表达式：\n$$\nU_H(p) - U_D(p) = \\frac{1}{2}(p^\\ast C - pC) = \\frac{C}{2}(p^\\ast - p)\n$$\n将此代回稳定性条件不等式：\n$$\n(p^\\ast - p)\\left[\\frac{C}{2}(p^\\ast - p)\\right] > 0\n$$\n$$\n\\frac{C}{2}(p^\\ast - p)^2 > 0\n$$\n由于 $p \\ne p^\\ast$，$(p^\\ast - p)^2 > 0$。又因为已知 $C>0$，不等式 $\\frac{C}{2}(p^\\ast - p)^2 > 0$ 总是成立。\n因此，混合策略 $p^\\ast = V/C$ 是ESS当且仅当它代表一个有效的内部均衡，即 $V  C$ 时。\n\n**ESS结果总结：**\n- 如果 $V \\ge C$，唯一的ESS是纯策略 $H$ (全部为鹰)。\n- 如果 $V  C$，唯一的ESS是混合策略 $p^\\ast=V/C$。\n- 纯策略 $D$ (全部为鸽) 永远不是ESS。\n\n问题要求的是第2项中找到的 $p^\\ast$ 的表达式。",
            "answer": "$$\n\\boxed{\\frac{V}{C}}\n$$"
        },
        {
            "introduction": "理解纳什均衡（NE）和演化稳定策略（ESS）之间的区别至关重要；前者是一个静态的均衡概念，而后者则蕴含了动态稳定性的要求。通过这个练习 ，你将亲手验证一个精心设计的反例，即一个策略是NE但并非ESS，从而深刻理解ESS定义中第二个条件（稳定性条件）的必要性。这个辨析有助于澄清关于演化稳定性的常见误解。",
            "id": "4275307",
            "problem": "考虑一个在均匀混合种群（等价于一个完全交互网络）上进行的对称双策略博弈，其中有两个纯策略 $x$ 和 $y$。设支付函数表示为 $\\pi(s,t)$，即使用策略 $s$ 的参与者对抗使用策略 $t$ 的对手时获得的支付。假设支付如下：\n$$\n\\pi(x,x) = 5,\\quad \\pi(x,y) = 1,\\quad \\pi(y,x) = 5,\\quad \\pi(y,y) = 3.\n$$\n在对称博弈中，使用纳什均衡 (NE) 和演化稳定策略 (ESS) 的标准定义：\n- 如果对于所有策略 $y$，都有 $\\pi(x,x) \\ge \\pi(y,x)$，则策略 $x$ 是一个对称纳什均衡。\n- 如果对于所有策略 $y \\neq x$，都有 $\\pi(x,x) \\ge \\pi(y,x)$，并且当 $\\pi(x,x) = \\pi(y,x)$ 时，还额外满足 $\\pi(x,y) > \\pi(y,y)$，则策略 $x$ 是一个演化稳定策略 (ESS)。\n\n定义一个完全由 $x$ 组成的原住民种群，并考虑一个频率为 $\\varepsilon \\in (0,1)$ 的小量突变体 $y$ 的入侵，因此种群混合为 $p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$。因为在对称双人博弈中，支付与种群频率呈线性关系，所以策略 $s$ 对抗种群 $p_{\\varepsilon}$ 的期望支付为 $\\pi(s,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(s,x) + \\varepsilon \\pi(s,y)$。\n\n任务：\n1. 仅使用上述定义，证明在该博弈中 $x$ 是一个对称纳什均衡，但不是一个演化稳定策略，并解释为什么突变体 $y$ 在入侵抵抗方面能够中和或击败 $x$。\n2. 设 $D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$ 表示突变体在频率为 $\\varepsilon$ 时的期望支付优势。将 $D(\\varepsilon)$ 推导至 $\\varepsilon$ 的一阶，并计算其右导数 $D'(0^{+})$。将 $D'(0^{+})$ 的值作为你的最终数值答案。无需四舍五入，也不应包含单位。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **博弈类型**：在均匀混合种群上的对称双策略博弈。\n- **策略**：两个纯策略，表示为 $x$ 和 $y$。\n- **支付函数**：$\\pi(s,t)$ 是策略 $s$ 对抗策略 $t$ 时的支付。\n- **支付值**：\n  - $\\pi(x,x) = 5$\n  - $\\pi(x,y) = 1$\n  - $\\pi(y,x) = 5$\n  - $\\pi(y,y) = 3$\n- **对称纳什均衡 (NE) 的定义**：如果对于所有策略 $y$，都有 $\\pi(x,x) \\ge \\pi(y,x)$，则策略 $x$ 是一个对称 NE。\n- **演化稳定策略 (ESS) 的定义**：如果对于所有策略 $y \\neq x$：\n  1. $\\pi(x,x) \\ge \\pi(y,x)$ (NE 条件)\n  2. 如果 $\\pi(x,x) = \\pi(y,x)$，则 $\\pi(x,y) > \\pi(y,y)$ (稳定性条件)，则策略 $x$ 是一个 ESS。\n- **种群混合**：对于突变体频率 $\\varepsilon \\in (0,1)$，$p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$。\n- **期望支付**：$\\pi(s,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(s,x) + \\varepsilon \\pi(s,y)$。\n- **突变体支付优势**：$D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是演化博弈论的标准应用，使用了纳什均衡和演化稳定策略的经典定义。这些是复杂系统、经济学和理论生物学中的基本概念。\n- **适定性**：该问题在数学上是适定的。它提供了执行所需任务的所有必要数据（支付矩阵）和形式化定义。问题具体，并能得出一个唯一、可计算的答案。\n- **客观性**：问题以精确、形式化的语言陈述，没有主观性或模糊性。\n- **结论**：该问题内部一致、科学有效且适定。未发现任何缺陷。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n### 解答推导\n\n根据问题陈述的要求，解答分为两部分。\n\n**第一部分：分析策略 $x$ 作为 NE 和 ESS**\n\n要确定策略 $x$ 是否为对称纳什均衡 (NE)，我们必须检查对于备选策略 $y$，条件 $\\pi(x,x) \\ge \\pi(y,x)$ 是否成立。\n- 根据已知条件，我们有 $\\pi(x,x) = 5$ 和 $\\pi(y,x) = 5$。\n- 不等式为 $5 \\ge 5$，这是成立的。\n- 因此，策略 $x$ 是一个对称纳什均衡。\n\n接下来，我们检查 $x$ 是否为演化稳定策略 (ESS)。对于任何备选策略 $y \\neq x$，ESS 必须满足两个条件：\n1.  $\\pi(x,x) \\ge \\pi(y,x)$\n2.  如果 $\\pi(x,x) = \\pi(y,x)$，则 $\\pi(x,y) > \\pi(y,y)$\n\n我们已经确定第一个条件成立。此外，我们发现等式 $\\pi(x,x) = \\pi(y,x)$ 成立，因为 $5 = 5$。这要求我们检查强制性的第二个条件，即稳定性条件。\n- 稳定性条件是 $\\pi(x,y) > \\pi(y,y)$。\n- 根据已知条件，我们有 $\\pi(x,y) = 1$ 和 $\\pi(y,y) = 3$。\n- 不等式变为 $1 > 3$，这是不成立的。\n- 由于稳定性条件被违反，策略 $x$ **不是**一个演化稳定策略。\n\n突变策略 $y$ 能够入侵并“击败”原住民策略 $x$ 的原因，可以由这些条件的失效直接解释。第一个条件 $\\pi(x,x) = \\pi(y,x)$ 意味着，单个突变体 $y$ 进入一个由 $x$ 策略者组成的种群时，其表现与原住民完全相同。它没有立即处于劣势，因此不会被选择性淘汰。这就是 $y$ 在初始出现时能够“中和”$x$ 的含义。\n\n稳定性条件 $\\pi(x,y) > \\pi(y,y)$ 旨在检查当突变体频率 $\\varepsilon$ 变为略大于零时会发生什么。当 $\\varepsilon > 0$ 时，个体有时会与突变体互动。一个原住民 $x$ 与一个突变体 $y$ 互动，支付为 $\\pi(x,y)$。一个突变体 $y$ 与另一个突变体 $y$ 互动，支付为 $\\pi(y,y)$。稳定性条件 $\\pi(x,y) > \\pi(y,y)$ 的失效，意味着 $\\pi(x,y) \\le \\pi(y,y)$。在这个具体案例中，$\\pi(x,y)  \\pi(y,y)$，因为 $1  3$。这意味着在突变体之间发生互动的罕见事件中，它们获得的支付高于原住民与突变体互动时获得的支付。这使得突变策略一旦其频率非零，就具有了净选择优势，使其能够“击败”原住民种群并在频率上增加。\n\n**第二部分：推导 $D(\\varepsilon)$ 和 $D'(0^{+})$**\n\n突变体的期望支付优势 $D(\\varepsilon)$ 定义为 $D(\\varepsilon) = \\pi(y,p_{\\varepsilon}) - \\pi(x,p_{\\varepsilon})$，其中 $p_{\\varepsilon} = (1-\\varepsilon)x + \\varepsilon y$ 是种群状态。\n\n首先，我们写出期望支付 $\\pi(x,p_{\\varepsilon})$ 和 $\\pi(y,p_{\\varepsilon})$ 的表达式：\n$$\n\\pi(x,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(x,x) + \\varepsilon \\pi(x,y)\n$$\n$$\n\\pi(y,p_{\\varepsilon}) = (1-\\varepsilon)\\pi(y,x) + \\varepsilon \\pi(y,y)\n$$\n现在，我们计算它们的差值：\n$$\nD(\\varepsilon) = \\left[ (1-\\varepsilon)\\pi(y,x) + \\varepsilon \\pi(y,y) \\right] - \\left[ (1-\\varepsilon)\\pi(x,x) + \\varepsilon \\pi(x,y) \\right]\n$$\n我们可以按 $(1-\\varepsilon)$ 和 $\\varepsilon$ 对项进行分组：\n$$\nD(\\varepsilon) = (1-\\varepsilon)[\\pi(y,x) - \\pi(x,x)] + \\varepsilon[\\pi(y,y) - \\pi(x,y)]\n$$\n现在，代入给定的支付值：\n- $\\pi(x,x) = 5$\n- $\\pi(y,x) = 5$\n- $\\pi(x,y) = 1$\n- $\\pi(y,y) = 3$\n将这些值代入 $D(\\varepsilon)$ 的表达式中：\n$$\nD(\\varepsilon) = (1-\\varepsilon)[5 - 5] + \\varepsilon[3 - 1]\n$$\n$$\nD(\\varepsilon) = (1-\\varepsilon)(0) + \\varepsilon(2)\n$$\n$$\nD(\\varepsilon) = 2\\varepsilon\n$$\n这个表达式已经是关于 $\\varepsilon$ 的线性表达式，因此它本身就是其在 $\\varepsilon=0$ 附近的一阶近似。\n\n为了求在 $\\varepsilon=0$ 处的右导数，记为 $D'(0^{+})$，我们将 $D(\\varepsilon)$ 对 $\\varepsilon$ 求导：\n$$\nD'(\\varepsilon) = \\frac{d}{d\\varepsilon}(2\\varepsilon) = 2\n$$\n由于导数是一个常数，其在任何点的值，包括在 $0$ 处的右极限，都是 $2$。\n$$\nD'(0^{+}) = 2\n$$\n$D'(0^{+})$ 的这个正值证实了突变策略 $y$ 在一个由 $x$ 主导的种群中具有初始增长优势，这与我们关于 $x$ 不是 ESS 的结论是一致的。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "本练习旨在搭建理论与计算实践之间的桥梁，让你体验复杂系统研究中的一个典型任务。你将学习如何从观测到的动态数据（策略频率的时间序列）中反向推断系统的内在规则（收益矩阵），并利用构建的模型来检验观测到的稳定状态是否满足演化稳定性的条件。这个计算性问题  强调了ESS概念在数据驱动的系统辨识和分析中的应用。",
            "id": "4275299",
            "problem": "考虑一个混合均匀的无限种群，它们正在进行一个对称双人博弈，其有限策略集的基数为 $m$。令 $x \\in \\Delta^{m-1}$ 表示在概率单纯形上的种群状态，其中 $\\Delta^{m-1} = \\{ x \\in \\mathbb{R}^m \\mid \\sum_{i=1}^m x_i = 1, x_i \\ge 0 \\}$，且 $x_i$ 是策略 $i$ 的频率。平均场种群动态由复制子常微分方程 (ODE) 给出，该方程源于一个基本假设：每个策略的增长率与其相对于种群平均收益的超额收益成正比。令 $A \\in \\mathbb{R}^{m \\times m}$ 表示收益矩阵，其中 $(A x)_i$ 是策略 $i$ 在对抗状态 $x$ 时的期望收益，而 $x^\\top A x$ 是种群平均收益。复制子 ODE 定义在 $\\Delta^{m-1}$ 上，且该单纯形在流的作用下是正向不变的。如果一个状态 $x^\\star$ 是一个对称纳什均衡并且能抵抗邻近突变体的入侵，则它是一个演化稳定策略 (ESS)；众所周知，对于对称博弈，一个在复制子动态下局部渐近稳定的严格对称纳什均衡就是一个 ESS。\n\n给定三个测试用例，每个用例都包含通过对具有未知收益矩阵 $A$ 的复制子 ODE 进行积分而生成的含噪声的种群状态时间序列。您的任务是：\n- 通过使用 $\\dot{x}$ 的有限差分近似和线性最小二乘法，估计未知收益矩阵 $A$ 的条目，从而将复制子动态拟合到时间序列。\n- 从时间序列的末尾部分识别一个候选吸引子 $x^\\star$。\n- 推导并计算复制子向量场在 $x^\\star$ 处的雅可比矩阵，并将其投影到单纯形的切空间上，以评估局部渐近稳定性。\n- 对于每个测试用例，通过验证投影雅可比矩阵的所有特征值都具有严格为负的实部，并且估计的向量场在 $x^\\star$ 处的范数接近于零，来判断观测到的吸引子是否满足 ESS 属性。\n\n使用的基本原理：\n- 复制子 ODE $ \\dot{x}_i = x_i \\big( (A x)_i - x^\\top A x \\big) $ 源于超额收益的定义以及在 $\\Delta^{m-1}$ 上的质量守恒。\n- 对于对称博弈，复制子 ODE 静止点的局部渐近稳定性意味着对邻近入侵的抵抗力。\n\n按如下方式构建估计器。对于在时间索引 $k$ 处的每个观测状态 $x^{(k)}$，时间步长为 $h > 0$，近似 $\\dot{x}^{(k)} \\approx \\frac{x^{(k+1)} - x^{(k)}}{h}$。对于每个策略索引 $i \\in \\{1,\\dots,m\\}$，复制子向量场在 $x^{(k)}$ 处的第 $i$ 个分量是 $A$ 的条目的线性函数：\n$$\n\\dot{x}_i^{(k)} = x_i^{(k)} \\sum_{q=1}^{m} A_{i q} x_q^{(k)} \\;-\\; x_i^{(k)} \\sum_{p=1}^{m} \\sum_{q=1}^{m} x_p^{(k)} A_{p q} x_q^{(k)}.\n$$\n将所有 $i$ 和 $k$ 的这些方程堆叠成一个线性系统 $M a \\approx y$，其中 $a \\in \\mathbb{R}^{m^2}$ 是 $A$ 按行优先顺序的向量化形式，$y \\in \\mathbb{R}^{m K}$ 收集了所有的有限差分近似值，而 $M \\in \\mathbb{R}^{m K \\times m^2}$ 是由上述表达式中每个 $A_{p q}$ 的系数构成的设计矩阵。通过线性最小二乘法估计 $a$，并将其重塑为 $\\hat{A} \\in \\mathbb{R}^{m \\times m}$。为了强制施加适用于 ESS 分析的对称性，请使用对称化矩阵 $\\tilde{A} = \\frac{1}{2}(\\hat{A} + \\hat{A}^\\top)$。\n\n定义复制子向量场在 $x$ 处的雅可比矩阵 $J(x)$，其分量为 $J_{i j}(x) = \\frac{\\partial}{\\partial x_j} \\big[ x_i \\big( (A x)_i - x^\\top A x \\big) \\big]$，并使用其列张成切空间 $\\mathcal{T} = \\{ v \\in \\mathbb{R}^m \\mid \\sum_{i=1}^m v_i = 0 \\}$ 的任意基矩阵 $Q \\in \\mathbb{R}^{m \\times (m-1)}$（例如，$Q = [e_1 - e_m, \\dots, e_{m-1} - e_m]$，其中 $e_j$ 是标准基向量）将 $J(x^\\star)$ 投影到切空间 $\\mathcal{T}$ 上。计算 $J_\\mathcal{T}(x^\\star) = Q^\\top J(x^\\star) Q$ 的特征值，并通过检查所有特征值是否都具有严格为负的实部来判断局部渐近稳定性。此外，检查估计的向量场在 $x^\\star$ 处的范数是否很小。\n\n测试套件。对于每种情况，使用时间步长 $h$、步数 $N$ 和幅值为 $\\sigma$ 的加性观测噪声来模拟复制子 ODE；将负分量裁剪为 0，并在加入噪声后重新归一化到单纯形。使用前向欧拉积分。测试用例是：\n- 情况 1（内部稳定）：$m = 3$, $A = \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix}$, $x_0 = (0.6, 0.3, 0.1)$, $h = 0.01$, $N = 600$, $\\sigma = 0.002$。\n- 情况 2（内部不稳定）：$m = 3$, $A = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$, $x_0 = (0.3, 0.2, 0.5)$, $h = 0.01$, $N = 600$, $\\sigma = 0.002$。\n- 情况 3（边界稳定）：$m = 2$, $A = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$, $x_0 = (0.3, 0.7)$, $h = 0.01$, $N = 600$, $\\sigma = 0.002$。\n\n实现要求：\n- 通过构建 $M$ 和 $y$ 并求解一个带有小正则化参数 $\\lambda > 0$ 的岭回归最小二乘问题来从含噪声的时间序列中估计 $\\hat{A}$，以提高数值稳定性。\n- 使用最后 $L$ 个样本（$L = 50$）的平均值来估计 $x^\\star$。\n- 如果投影雅可比矩阵 $J_\\mathcal{T}(x^\\star)$ 的特征值的最大实部严格小于一个负阈值 $-\\gamma$（其中 $\\gamma = 10^{-4}$），并且向量场在 $x^\\star$ 处的范数小于 $\\varepsilon = 10^{-3}$，则判定 ESS 为真。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3]$），其中每个 $\\mathrm{result}_k$ 是一个布尔值，指示测试用例 $k$ 中的吸引子是否满足上述标准的演化稳定策略 (ESS) 属性。不允许有其他输出。",
            "solution": "任务是确定从含噪声的复制子动态中观测到的吸引子是否对应于一个演化稳定策略 (ESS)。这需要先从时间序列数据中识别系统的底层收益矩阵，然后在吸引子处对已识别的动态系统进行局部稳定性分析。在对称博弈中，ESS 是一个对称纳什均衡，它能抵抗突变策略的入侵。一个状态 $x^\\star$ 成为 ESS 的一个充分条件是，它是一个在复制子动态下局部渐近稳定的严格纳什均衡。所提供的方法就是测试这种局部渐近稳定性。\n\n该过程包括三个主要阶段：模拟系统以生成数据，估计系统参数（收益矩阵 $A$），以及分析所估计系统的稳定性。\n\n**1. 通过线性回归进行系统识别**\n\n策略频率的演化由复制子常微分方程 (ODE) 控制：\n$$\n\\dot{x}_i = x_i \\left( (A x)_i - x^\\top A x \\right)\n$$\n其中 $x_i$ 是策略 $i$ 的频率，$A$ 是收益矩阵，$(A x)_i$ 是策略 $i$ 的收益，而 $x^\\top A x$ 是种群中的平均收益。\n\n给定一个具有恒定时间步长 $h$ 的种群状态时间序列 $\\{x^{(0)}, x^{(1)}, \\dots, x^{(N-1)}\\}$，我们可以使用有限差分来近似在时间步长 $k$ 处的导数 $\\dot{x}_i$：\n$$\n\\dot{x}_i^{(k)} \\approx \\frac{x_i^{(k+1)} - x_i^{(k)}}{h}\n$$\n系统识别的核心在于认识到复制子方程对于收益矩阵的未知条目 $A_{pq}$ 是线性的。将有限差分近似代入 ODE，得到：\n$$\n\\frac{x_i^{(k+1)} - x_i^{(k)}}{h} \\approx x_i^{(k)} \\left( \\sum_{q=1}^{m} A_{iq} x_q^{(k)} - \\sum_{p=1}^{m}\\sum_{q=1}^{m} x_p^{(k)} A_{pq} x_q^{(k)} \\right)\n$$\n这可以被重新排列以分离出项 $A_{pq}$：\n$$\n\\frac{x_i^{(k+1)} - x_i^{(k)}}{h} \\approx \\sum_{p=1}^{m}\\sum_{q=1}^{m} \\left( x_i^{(k)} (\\delta_{ip} - x_p^{(k)}) x_q^{(k)} \\right) A_{pq}\n$$\n其中 $\\delta_{ip}$ 是克罗内克 delta 符号。\n\n通过将所有策略 $i \\in \\{1, \\dots, m\\}$ 和所有可用的时间步长 $k \\in \\{0, \\dots, N-2\\}$ 的这些方程堆叠起来，我们可以构建一个形式为 $M a \\approx y$ 的大型超定线性系统。这里，$a \\in \\mathbb{R}^{m^2}$ 是矩阵 $A$ 的向量化形式（按行优先顺序），$y \\in \\mathbb{R}^{m(N-1)}$ 是所有有限差分近似值 $\\frac{x_i^{(k+1)} - x_i^{(k)}}{h}$ 组成的向量，而 $M \\in \\mathbb{R}^{m(N-1) \\times m^2}$ 是设计矩阵，其条目是上面推导出的 $A_{pq}$ 的系数：$M_{(km+i), (pm+q)} = x_i^{(k)} (\\delta_{ip} - x_p^{(k)}) x_q^{(k)}$。\n\n为了找到 $a$ 的估计值，我们求解一个岭回归最小二乘问题，这有助于减轻由 $M$ 中潜在的共线性引起的数值问题：\n$$\n\\hat{a} = \\arg\\min_a \\|Ma - y\\|_2^2 + \\lambda \\|a\\|_2^2\n$$\n解由 $\\hat{a} = (M^\\top M + \\lambda I)^{-1} M^\\top y$ 给出，其中 $\\lambda > 0$ 是一个小的正则化参数。然后将向量 $\\hat{a}$ 重塑为估计矩阵 $\\hat{A} \\in \\mathbb{R}^{m \\times m}$。由于 ESS 的概念植根于对称博弈，我们通过取 $\\tilde{A} = \\frac{1}{2}(\\hat{A} + \\hat{A}^\\top)$ 来对我们的估计矩阵强制施加对称性。这个对称化矩阵 $\\tilde{A}$ 用于后续的稳定性分析。\n\n**2. 局部稳定性分析**\n\n一个 ESS 必须是动态系统的一个静止点，并且必须是局部渐近稳定的。\n首先，我们通过假设系统在模拟结束时已经收敛来识别一个候选吸引子 $x^\\star$。我们通过对时间序列的最后 $L$ 个点求平均来估计 $x^\\star$：$x^\\star = \\frac{1}{L} \\sum_{k=N-L}^{N-1} x^{(k)}$。\n\n平衡点的局部稳定性由在平衡点处求值的向量场的雅可比矩阵的特征值决定。向量场为 $f_i(x) = x_i ((\\tilde{A}x)_i - x^\\top \\tilde{A}x)$。其雅可比矩阵 $J(x)$ 的条目是：\n$$\nJ_{ij}(x) = \\frac{\\partial f_i}{\\partial x_j} = \\delta_{ij}( (\\tilde{A}x)_i - x^\\top \\tilde{A}x ) + x_i ( \\tilde{A}_{ij} - 2(\\tilde{A}x)_j )\n$$\n这个公式利用了 $\\tilde{A}$ 是对称的这一事实。\n\n动态系统被约束在概率单纯形 $\\Delta^{m-1}$ 上。因此，我们关心的是相对于保持在单纯形内的扰动的稳定性。这是通过分析雅可比矩阵在单纯形的切空间 $\\mathcal{T} = \\{ v \\in \\mathbb{R}^m \\mid \\sum_{i=1}^m v_i = 0 \\}$ 上的行为来评估的。我们将雅可比矩阵 $J(x^\\star)$ 投影到这个空间上。$\\mathcal{T}$ 的一组基可以由一个矩阵 $Q \\in \\mathbb{R}^{m \\times (m-1)}$ 的列构成，例如列为 $[e_1 - e_m, \\dots, e_{m-1} - e_m]$ 的矩阵 $Q$。投影后的雅可比矩阵则由 $J_{\\mathcal{T}}(x^\\star) = Q^\\top J(x^\\star) Q$ 给出。\n\n**3. ESS 判定标准**\n\n根据问题的定义，如果满足两个条件，状态 $x^\\star$ 就被认为是 ESS：\n1.  **平衡条件**：状态 $x^\\star$ 必须是动态系统的一个静止点。在数值上，通过检查在 $x^\\star$ 处估计的向量场的范数是否低于一个小阈值 $\\varepsilon$ 来验证：$\\| f(x^\\star) \\|  \\varepsilon$。\n2.  **稳定性条件**：状态必须是局部渐近稳定的。这要求投影雅可比矩阵 $J_{\\mathcal{T}}(x^\\star)$ 的所有特征值都具有严格为负的实部。在数值上，我们检查其实部的最大值是否小于一个负阈值：$\\max(\\operatorname{Re}(\\lambda_i))  -\\gamma$，其中 $\\gamma > 0$。\n\n如果两个条件都满足，则该吸引子被归类为 ESS。以下代码为三个指定的测试用例实现了这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of identifying Evolutionarily Stable Strategies (ESS) from noisy\n    replicator dynamics time series.\n    \"\"\"\n    test_cases = [\n        # Case 1 (interior stable)\n        {\n            \"m\": 3,\n            \"A\": np.array([[-1.0, 0.0, 0.0], [0.0, -1.0, 0.0], [0.0, 0.0, -1.0]]),\n            \"x0\": np.array([0.6, 0.3, 0.1]),\n            \"h\": 0.01,\n            \"N\": 600,\n            \"sigma\": 0.002,\n        },\n        # Case 2 (interior unstable)\n        {\n            \"m\": 3,\n            \"A\": np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"x0\": np.array([0.3, 0.2, 0.5]),\n            \"h\": 0.01,\n            \"N\": 600,\n            \"sigma\": 0.002,\n        },\n        # Case 3 (boundary stable)\n        {\n            \"m\": 2,\n            \"A\": np.array([[1.0, 0.0], [0.0, 0.0]]),\n            \"x0\": np.array([0.3, 0.7]),\n            \"h\": 0.01,\n            \"N\": 600,\n            \"sigma\": 0.002,\n        },\n    ]\n\n    # Implementation parameters from the problem statement\n    L = 50\n    gamma = 1e-4\n    epsilon = 1e-3\n    lambda_reg = 1e-6  # Small regularization parameter\n\n    results = []\n    \n    # Set a seed for reproducibility of noise generation\n    np.random.seed(42)\n\n    for case in test_cases:\n        m, A_true, x0, h, N, sigma = (\n            case[\"m\"],\n            case[\"A\"],\n            case[\"x0\"],\n            case[\"h\"],\n            case[\"N\"],\n            case[\"sigma\"],\n        )\n\n        # 1. Generate noisy time series data using forward Euler\n        x_series = np.zeros((N, m))\n        x_series[0] = x0\n\n        for k in range(N - 1):\n            x = x_series[k]\n            # Replicator ODE update\n            payoffs = A_true @ x\n            avg_payoff = x @ payoffs\n            x_dot = x * (payoffs - avg_payoff)\n            \n            x_next_noiseless = x + h * x_dot\n            \n            # Add noise, clip negative values, and renormalize to simplex\n            noise = (np.random.rand(m) - 0.5) * 2 * sigma\n            x_next_noisy = x_next_noiseless + noise\n            x_next_noisy[x_next_noisy  0] = 0.0\n            sum_x = np.sum(x_next_noisy)\n            if sum_x > 0:\n                x_next_noisy /= sum_x\n            else:\n                x_next_noisy = np.ones(m) / m  # Reset if all components are zero\n            \n            x_series[k + 1] = x_next_noisy\n\n        # 2. Fit the model to estimate A using linear least squares\n        num_fit_points = N - 1\n        num_eqs = m * num_fit_points\n        num_vars = m * m\n        \n        M = np.zeros((num_eqs, num_vars))\n        y = np.zeros(num_eqs)\n\n        for k in range(num_fit_points):\n            x_k = x_series[k]\n            x_k_plus_1 = x_series[k + 1]\n            x_dot_approx = (x_k_plus_1 - x_k) / h\n            \n            for i in range(m):\n                row_idx = k * m + i\n                y[row_idx] = x_dot_approx[i]\n                \n                for p in range(m):\n                    for q in range(m):\n                        col_idx = p * m + q\n                        # Coefficient of A_pq in the equation for x_dot_i\n                        coeff = x_k[i] * ((1 if i == p else 0) - x_k[p]) * x_k[q]\n                        M[row_idx, col_idx] = coeff\n        \n        # Solve ridge-regularized least squares: (M'M + lambda*I)a = M'y\n        try:\n            a_hat = np.linalg.solve(\n                M.T @ M + lambda_reg * np.identity(num_vars), M.T @ y\n            )\n            A_hat = a_hat.reshape((m, m))\n            A_tilde = 0.5 * (A_hat + A_hat.T)\n        except np.linalg.LinAlgError:\n            # Handle cases where the matrix is singular despite regularization\n            is_ess = False # Cannot perform analysis\n            results.append(is_ess)\n            continue\n\n        # 3. Identify attractor and perform stability analysis\n        x_star = np.mean(x_series[-L:], axis=0)\n        \n        # Check equilibrium condition: norm of vector field at x_star\n        payoffs_star = A_tilde @ x_star\n        avg_payoff_star = x_star @ payoffs_star\n        vector_field_at_star = x_star * (payoffs_star - avg_payoff_star)\n        norm_vf = np.linalg.norm(vector_field_at_star)\n        is_rest_point = norm_vf  epsilon\n\n        # Compute Jacobian J(x*) using the symmetrized matrix A_tilde\n        J = np.zeros((m, m))\n        for i in range(m):\n            for j in range(m):\n                term1 = (payoffs_star[i] - avg_payoff_star) if i == j else 0\n                term2 = x_star[i] * (A_tilde[i, j] - 2 * payoffs_star[j])\n                J[i, j] = term1 + term2\n\n        # Project Jacobian onto the tangent space of the simplex\n        if m > 1:\n            Q = np.vstack((np.eye(m - 1), -np.ones((1, m - 1))))\n            J_projected = Q.T @ J @ Q\n            eigenvalues = np.linalg.eigvals(J_projected)\n            max_real_part = np.max(np.real(eigenvalues))\n        else: # Trivial case for m=1\n            max_real_part = 0.0\n\n        # Check stability condition: eigenvalues of projected Jacobian\n        is_stable = max_real_part  -gamma\n        \n        # 4. Decide if it's an ESS based on the two conditions\n        is_ess = is_rest_point and is_stable\n        results.append(is_ess)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}