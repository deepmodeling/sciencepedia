{
    "hands_on_practices": [
        {
            "introduction": "要真正理解动力系统，我们必须掌握轨道和原像这两个基本概念。本练习将通过一个经典的一维离散映射，让您动手实践如何追踪一个状态在时间上的正向演化（其轨道）和反向追溯（其原像）。这个映射 $F(x) = x^2 - 2$ 在混沌理论中非常有名，而此问题  将展示一个巧妙的变量代换如何优雅地揭示其内在结构。",
            "id": "4272770",
            "problem": "考虑实线上的离散时间动力系统，其状态空间为 $\\mathbb{R}$，演化由映射 $F:\\mathbb{R}\\to\\mathbb{R}$ 给出，定义为 $F(x)=x^{2}-2$。设初始条件为 $x_{0}=2\\cos\\!\\left(\\frac{\\pi}{9}\\right)$，其中所有角度均以弧度为单位。\n\n仅使用离散时间动力系统中轨道、前向像和原像的基本定义，以及经过验证的三角恒等式，完成以下任务：\n\n1. 构建前向轨道 $\\{x_{k}\\}_{k\\geq 0}$，其中 $x_{k}=F^{k}(x_{0})$，直到并包括 $k=6$，将每个 $x_{k}$ 以符号形式表示为在 $\\frac{\\pi}{9}$ 的倍数处求值的单个三角函数。\n2. 确定 $x_{0}$ 在映射 $F$ 下的所有一阶原像的集合，即集合 $F^{-1}(x_{0})=\\{x\\in\\mathbb{R}:F(x)=x_{0}\\}$。\n3. 确定位于区间 $[-2,2]$ 内的 $x_{0}$ 的所有二阶原像的集合，即集合 $\\{x\\in[-2,2]:F^{2}(x)=x_{0}\\}$。\n\n所有中间结果都用符号表示；不要使用数值近似。你的最终任务是提供 $x_{6}$ 的单一精确闭式表达式。不要进行数值近似，也不要包含单位。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- 动力系统：实线上的离散时间系统。\n- 状态空间：$\\mathbb{R}$。\n- 演化映射：$F: \\mathbb{R} \\to \\mathbb{R}$，定义为 $F(x) = x^{2} - 2$。\n- 初始条件：$x_{0} = 2\\cos(\\frac{\\pi}{9})$。\n- 符号说明：$x_{k} = F^{k}(x_{0}) = F(F(...F(x_0)...))$，即 $F$ 对 $x_{0}$ 的第 $k$ 次迭代。\n- 任务1：构建前向轨道 $\\{x_{k}\\}_{k\\geq 0}$ 直到 $k=6$，并将每个 $x_{k}$ 表示为特定的三角函数形式。\n- 任务2：求一阶原像集 $F^{-1}(x_{0}) = \\{x \\in \\mathbb{R} : F(x) = x_{0}\\}$。\n- 任务3：求区间 $[-2, 2]$ 内的二阶原像集，即 $\\{x \\in [-2, 2] : F^{2}(x) = x_{0}\\}$。\n- 最终答案要求：提供 $x_{6}$ 的精确闭式值。\n\n### 第2步：使用提取的已知条件进行验证\n问题定义良好且在数学上是合理的。\n- **科学依据：** 映射 $F(x) = x^{2} - 2$ 是动力系统研究中的一个著名对象，被称为第二类切比雪夫多项式 $T_{2}(x)$。对于区间 $[-2, 2]$ 内的初始条件，其动力学行为与圆上的倍角映射共轭，后者是混沌理论中的一个基本模型。该问题植根于已建立的数学原理。\n- **适定性：** 函数 $F$ 定义清晰，初始条件是一个特定的实数，任务表述明确。存在唯一且有意义的解。\n- **客观性：** 问题陈述由形式化的数学定义和问题组成，不含任何主观或有偏见的语言。\n\n所有有效性标准均已满足。该问题并非不合理、不可形式化、不完整、不切实际、不适定、微不足道或无法验证。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n通过变量代换，可以大大简化映射 $F(x) = x^{2} - 2$ 的动力学行为，特别是对于区间 $[-2, 2]$ 内的初始条件。令 $x = 2\\cos(\\theta)$，其中 $\\theta$ 为某个角度。将映射 $F$ 应用于此形式，得到：\n$$F(x) = F(2\\cos(\\theta)) = (2\\cos(\\theta))^{2} - 2 = 4\\cos^{2}(\\theta) - 2$$\n使用倍角三角恒等式 $2\\cos^{2}(\\theta) - 1 = \\cos(2\\theta)$，我们可以简化表达式：\n$$F(2\\cos(\\theta)) = 2(2\\cos^{2}(\\theta) - 1) = 2\\cos(2\\theta)$$\n这表明，对于由 $2\\cos(\\theta)$ 表示的状态 $x$，下一个状态 $F(x)$ 由 $2\\cos(2\\theta)$ 表示。将映射迭代 $k$ 次，相当于将角度重复加倍：\n$$F^{k}(2\\cos(\\theta)) = 2\\cos(2^{k}\\theta)$$\n这种共轭关系为解决问题的所有部分提供了一种直接方法。\n\n#### 1. 前向轨道构建\n初始条件为 $x_{0} = 2\\cos(\\frac{\\pi}{9})$。这已经是 $2\\cos(\\theta_{0})$ 的形式，其中 $\\theta_{0} = \\frac{\\pi}{9}$。我们现在可以使用公式 $x_{k} = 2\\cos(2^{k}\\theta_{0})$ 来计算前向轨道 $\\{x_{k}\\}_{k=0}^{6}$。\n\n- 对于 $k=0$：$x_{0} = 2\\cos(2^{0} \\cdot \\frac{\\pi}{9}) = 2\\cos(\\frac{\\pi}{9})$。\n- 对于 $k=1$：$x_{1} = 2\\cos(2^{1} \\cdot \\frac{\\pi}{9}) = 2\\cos(\\frac{2\\pi}{9})$。\n- 对于 $k=2$：$x_{2} = 2\\cos(2^{2} \\cdot \\frac{\\pi}{9}) = 2\\cos(\\frac{4\\pi}{9})$。\n- 对于 $k=3$：$x_{3} = 2\\cos(2^{3} \\cdot \\frac{\\pi}{9}) = 2\\cos(\\frac{8\\pi}{9})$。使用恒等式 $\\cos(\\pi - \\alpha) = -\\cos(\\alpha)$，我们可以写出 $x_{3} = 2\\cos(\\pi - \\frac{\\pi}{9}) = -2\\cos(\\frac{\\pi}{9}) = -x_{0}$。\n- 对于 $k=4$：$x_{4} = F(x_{3}) = F(-x_{0}) = (-x_{0})^{2} - 2 = x_{0}^{2} - 2 = F(x_{0}) = x_{1}$。所以，$x_{4} = 2\\cos(\\frac{2\\pi}{9})$。\n- 对于 $k=5$：由于轨道已进入一个循环（$x_{4} = x_{1}$），我们有 $x_{5} = F(x_{4}) = F(x_{1}) = x_{2}$。所以，$x_{5} = 2\\cos(\\frac{4\\pi}{9})$。\n- 对于 $k=6$：同样地，$x_{6} = F(x_{5}) = F(x_{2}) = x_{3}$。所以，$x_{6} = 2\\cos(\\frac{8\\pi}{9})$。\n\n直到 $k=6$ 的前向轨道是：\n$\\{2\\cos(\\frac{\\pi}{9}), 2\\cos(\\frac{2\\pi}{9}), 2\\cos(\\frac{4\\pi}{9}), 2\\cos(\\frac{8\\pi}{9}), 2\\cos(\\frac{2\\pi}{9}), 2\\cos(\\frac{4\\pi}{9}), 2\\cos(\\frac{8\\pi}{9})\\}$。\n\n#### 2. $x_{0}$ 的一阶原像\n我们要求解集合 $F^{-1}(x_{0}) = \\{x \\in \\mathbb{R} : F(x) = x_{0}\\}$。这需要解方程 $x^{2} - 2 = x_{0}$。\n$$x^{2} = x_{0} + 2$$\n$$x = \\pm\\sqrt{x_{0} + 2}$$\n代入 $x_{0} = 2\\cos(\\frac{\\pi}{9})$：\n$$x = \\pm\\sqrt{2\\cos(\\frac{\\pi}{9}) + 2} = \\pm\\sqrt{2(1 + \\cos(\\frac{\\pi}{9}))}$$\n使用半角恒等式 $1 + \\cos(2\\alpha) = 2\\cos^{2}(\\alpha)$，其中 $2\\alpha = \\frac{\\pi}{9}$（因此 $\\alpha = \\frac{\\pi}{18}$）：\n$$x = \\pm\\sqrt{2 \\cdot 2\\cos^{2}(\\frac{\\pi}{18})} = \\pm\\sqrt{4\\cos^{2}(\\frac{\\pi}{18})} = \\pm 2\\cos(\\frac{\\pi}{18})$$\n一阶原像集为 $F^{-1}(x_{0}) = \\{2\\cos(\\frac{\\pi}{18}), -2\\cos(\\frac{\\pi}{18})\\}$。\n\n#### 3. $[-2, 2]$ 内 $x_{0}$ 的二阶原像\n我们要求解集合 $\\{x \\in [-2, 2] : F^{2}(x) = x_{0}\\}$，这是 $F^{-1}(x_{0})$ 中元素的原像集。令 $y \\in F^{-1}(x_{0})$。我们必须解关于 $x$ 的方程 $F(x) = y$，即 $x^{2} - 2 = y$。这得到 $x = \\pm\\sqrt{y+2}$。如果 $y \\in [-2, 2]$，则限制条件 $x \\in [-2, 2]$ 自动满足，我们的集合 $F^{-1}(x_{0})$ 正是这种情况。\n\n情况1：$y = 2\\cos(\\frac{\\pi}{18})$\n$$x = \\pm\\sqrt{2\\cos(\\frac{\\pi}{18}) + 2} = \\pm\\sqrt{2(1 + \\cos(\\frac{\\pi}{18}))}$$\n使用半角恒等式，其中 $2\\alpha = \\frac{\\pi}{18}$（因此 $\\alpha = \\frac{\\pi}{36}$）：\n$$x = \\pm\\sqrt{2 \\cdot 2\\cos^{2}(\\frac{\\pi}{36})} = \\pm 2\\cos(\\frac{\\pi}{36})$$\n\n情况2：$y = -2\\cos(\\frac{\\pi}{18})$\n$$x = \\pm\\sqrt{-2\\cos(\\frac{\\pi}{18}) + 2} = \\pm\\sqrt{2(1 - \\cos(\\frac{\\pi}{18}))}$$\n使用半角恒等式 $1 - \\cos(2\\alpha) = 2\\sin^{2}(\\alpha)$，其中 $2\\alpha = \\frac{\\pi}{18}$（因此 $\\alpha = \\frac{\\pi}{36}$）：\n$$x = \\pm\\sqrt{2 \\cdot 2\\sin^{2}(\\frac{\\pi}{36})} = \\pm\\sqrt{4\\sin^{2}(\\frac{\\pi}{36})} = \\pm 2\\sin(\\frac{\\pi}{36})$$\n\n完整的二阶原像集由四个值组成：$\\{2\\cos(\\frac{\\pi}{36}), -2\\cos(\\frac{\\pi}{36}), 2\\sin(\\frac{\\pi}{36}), -2\\sin(\\frac{\\pi}{36})\\}$。为了将它们全部用余弦函数表示，我们使用恒等式 $\\cos(\\pi - \\alpha) = -\\cos(\\alpha)$ 和 $\\sin(\\alpha) = \\cos(\\frac{\\pi}{2} - \\alpha)$：\n- $2\\cos(\\frac{\\pi}{36})$\n- $-2\\cos(\\frac{\\pi}{36}) = 2\\cos(\\pi - \\frac{\\pi}{36}) = 2\\cos(\\frac{35\\pi}{36})$\n- $2\\sin(\\frac{\\pi}{36}) = 2\\cos(\\frac{\\pi}{2} - \\frac{\\pi}{36}) = 2\\cos(\\frac{17\\pi}{36})$\n- $-2\\sin(\\frac{\\pi}{36}) = -2\\cos(\\frac{17\\pi}{36}) = 2\\cos(\\pi - \\frac{17\\pi}{36}) = 2\\cos(\\frac{19\\pi}{36})$\n\n因此，在 $[-2, 2]$ 内的二阶原像集为 $\\{2\\cos(\\frac{\\pi}{36}), 2\\cos(\\frac{17\\pi}{36}), 2\\cos(\\frac{19\\pi}{36}), 2\\cos(\\frac{35\\pi}{36})\\}$。\n\n#### 最终答案计算\n最终任务是提供 $x_{6}$ 的单一值。根据第1部分的确定，轨道是预周期的，$x_{0}$ 是一个瞬态，导向3-循环 $\\{x_{1}, x_{2}, x_{3}\\}$。具体来说，$x_{4}=x_{1}$，$x_{5}=x_{2}$，以及 $x_{6}=x_{3}$。\n$x_{3}$ 的值是：\n$$x_{3} = 2\\cos(\\frac{8\\pi}{9})$$\n因此，$x_{6} = 2\\cos(\\frac{8\\pi}{9})$。\n这是所要求的精确闭式表达式。",
            "answer": "$$\\boxed{2\\cos\\left(\\frac{8\\pi}{9}\\right)}$$"
        },
        {
            "introduction": "单个轨道固然重要，但状态空间的全局结构才能揭示系统所有可能的行为。本练习聚焦于多稳态现象，此时状态空间被分割为不同的吸引盆。理解分隔这些吸引盆的边界，即分界线（separatrix），是根据初始状态预测系统最终归宿的关键。此问题  将挑战您在一个二维连续系统中，通过分析平衡点来识别鞍点在形成这些边界时所扮演的关键角色。",
            "id": "4272744",
            "problem": "考虑在状态空间 $\\mathbb{R}^2$ 上由以下常微分方程定义的平面自治系统：\n$$\n\\dot{x} = x - x^3 - \\mu y,\\qquad \\dot{y} = \\lambda x - y,\n$$\n其中 $\\mu  0$ 和 $\\lambda  0$ 是参数，并假设 $\\mu\\lambda  1$。用复杂系统和网络科学的语言来说，该系统表现出多稳态，状态空间被一个边界（分界线）划分为多个吸引盆。请仅使用状态空间中的轨迹、平衡点、通过雅可比矩阵的线性化、双曲性以及吸引盆的核心定义，分析从分界线附近开始的轨迹的定性行为，并确定状态空间中的边界是如何决定的。\n\n你的推理应从定义开始：轨迹是状态空间中向量场的解曲线；平衡点是向量场为零的点；双曲平衡点处的雅可比线性化决定了局部动力学；稳定和不稳定流形是在平衡点处与相应特征空间相切的不变集；吸引盆是其轨迹收敛到特定吸引子的初始条件集合。\n\n下列哪个陈述是正确的？\n\nA. 分隔吸引盆的边界是在 $(0,0)$ 处的鞍点平衡点的稳定流形 $W^s$；位于该不变流形两侧的初始条件会产生定性上不同的轨迹，它们渐近趋向于不同的稳定平衡点 $(+\\sqrt{1-\\mu\\lambda},\\,\\lambda\\sqrt{1-\\mu\\lambda})$ 或 $(-\\sqrt{1-\\mu\\lambda},\\,-\\lambda\\sqrt{1-\\mu\\lambda})$。在局部，分界线在 $(0,0)$ 处与雅可比矩阵的负特征值所对应的特征向量相切，并且可以通过从 $(0,0)$ 附近沿稳定特征方向的点开始对流进行时间反向积分来数值计算。\n\nB. 分界线是在 $(0,0)$ 处的鞍点平衡点的不稳定流形 $W^u$；恰好在其上的初始条件会收敛到一个稳定平衡点，而在其附近的初始条件会沿其不稳定方向收敛到鞍点，因此 $W^u$ 决定了吸引盆的边界。\n\nC. 对于所有允许的参数值，边界都与由 $x - x^3 - \\mu y = 0$ 定义的x-零斜线重合，因为轨迹不能穿过零斜线；因此，零斜线就是分界线。\n\nD. 分界线是一个环绕 $(0,0)$ 处鞍点的闭合周期轨道，它将状态空间分为两个吸引盆；位于两侧的初始条件会无限期地保持在鞍点附近。\n\nE. 对于具有双曲不动点的光滑平面系统，吸引盆边界通常是分形的；因此，在任何鞍点附近，吸引盆在任意精细的尺度上相互交错，分界线不是一个由线性化决定的不变流形。",
            "solution": "用户希望我分析一个平面动力系统，验证问题陈述，然后评估给出的选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n平面自治系统由以下常微分方程定义：\n$$\n\\dot{x} = x - x^3 - \\mu y\n$$\n$$\n\\dot{y} = \\lambda x - y\n$$\n状态空间为 $\\mathbb{R}^2$。参数 $\\mu$ 和 $\\lambda$ 满足 $\\mu  0$ 和 $\\lambda  0$。还有一个附加约束条件：$\\mu\\lambda  1$。问题要求基于核心定义进行分析：轨迹、平衡点、雅可比线性化、双曲性、稳定与不稳定流形以及吸引盆。\n\n**步骤 2：使用提取的已知条件进行验证**\n1.  **科学基础：** 问题描述了一个标准的二维自治常微分方程系统。所提及的概念——平衡点、稳定性、雅可比线性化、稳定/不稳定流形、吸引盆和分界线——在动力系统的数学领域中都有基础且严格的定义。该系统本身是双稳态系统的一个经典例子，其结构类似于 FitzHugh-Nagumo 方程等模型。问题在科学和数学上是合理的。\n2.  **适定性：** 向量场 $(f_1(x,y), f_2(x,y)) = (x - x^3 - \\mu y, \\lambda x - y)$ 由多项式函数组成，这些函数在 $\\mathbb{R}^2$ 上是无限可微的（$C^\\infty$）。根据 Picard-Lindelöf 定理（或 Cauchy-Lipschitz 定理），对于任何初始条件 $(x_0, y_0) \\in \\mathbb{R}^2$，都存在唯一的局部解（轨迹），并且是连续的。由于轨迹是有界的，解在所有时间上的全局存在性也得到保证。问题要求对吸引盆边界进行正确的刻画，这在此背景下是一个明确定义的问题。\n3.  **客观性：** 问题使用精确的数学语言和定义进行陈述。没有主观、模糊或基于意见的陈述。\n4.  **不完整或矛盾的设置：** 系统方程、参数约束（$\\mu0$、$\\lambda0$、$\\mu\\lambda1$）和状态空间都已明确给出。这些条件是自洽的，足以对系统的相图进行定性分析。\n5.  **不切实际或不可行：** 问题是一个数学抽象，并未声称代表某个特定的物理系统，因此物理现实性不是主要关注点。在数学上，这些条件是可行的。\n6.  **不适定或结构不良：** 问题结构良好，可以得出唯一的动力学定性描述。问题不是循环论证。\n7.  **伪深刻、琐碎或同义反复：** 所需的分析并非琐碎。它涉及寻找平衡点，使用雅可比矩阵确定其稳定性，并应用稳定流形定理来正确识别分界线。这是非线性动力学入门课程中的一个标准但有实质内容的问题。\n8.  **超出科学可验证性：** 所有论断都可以使用微分方程理论中的标准数学技术进行严格验证。\n\n**步骤 3：结论与行动**\n问题陈述有效。我将继续进行求解。\n\n### 求解推导\n\n**1. 求平衡点（不动点）**\n平衡点是满足 $\\dot{x} = 0$ 和 $\\dot{y} = 0$ 的点 $(x, y)$。\n平衡点的方程组为：\n$$\nx - x^3 - \\mu y = 0 \\quad (1)\n$$\n$$\n\\lambda x - y = 0 \\quad (2)\n$$\n从方程 $(2)$，我们得到 $y = \\lambda x$。将其代入方程 $(1)$：\n$$\nx - x^3 - \\mu(\\lambda x) = 0\n$$\n$$\nx(1 - x^2 - \\mu\\lambda) = 0\n$$\n该方程对 $x$ 有三个解：\n- $x = 0$\n- $x^2 = 1 - \\mu\\lambda \\implies x = \\pm\\sqrt{1-\\mu\\lambda}$\n\n条件 $\\mu\\lambda  1$ 确保了 $1 - \\mu\\lambda  0$，因此两个非零的 $x$ 解是实数且不相等。我们使用 $y = \\lambda x$ 找到相应的 $y$ 值。三个平衡点是：\n1.  原点：$P_0 = (0, 0)$\n2.  $P_+ = (\\sqrt{1-\\mu\\lambda}, \\lambda\\sqrt{1-\\mu\\lambda})$\n3.  $P_- = (-\\sqrt{1-\\mu\\lambda}, -\\lambda\\sqrt{1-\\mu\\lambda})$\n\n**2. 通过线性化进行稳定性分析**\n系统的雅可比矩阵是：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 - 3x^2  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\n\n**在原点 $P_0 = (0,0)$ 的稳定性：**\n$$\nJ(0,0) = \\begin{pmatrix} 1  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\n行列式为 $\\det(J) = (1)(-1) - (-\\mu)(\\lambda) = \\mu\\lambda - 1$。\n迹为 $\\text{tr}(J) = 1 + (-1) = 0$。\n由于我们已知 $\\mu\\lambda  1$，所以 $\\det(J)  0$。一个行列式为负的实矩阵总有一个正实特征值和一个负实特征值，这意味着该平衡点是一个**鞍点**。根据定义，鞍点是双曲的。特征值 $\\kappa$ 由特征方程 $\\kappa^2 - \\text{tr}(J)\\kappa + \\det(J) = 0$ 给出，化简为 $\\kappa^2 + (\\mu\\lambda - 1) = 0$，因此 $\\kappa = \\pm\\sqrt{1-\\mu\\lambda}$。\n\n**在 $P_{\\pm} = (\\pm\\sqrt{1-\\mu\\lambda}, \\pm\\lambda\\sqrt{1-\\mu\\lambda})$ 的稳定性：**\n对于这些点，$x^2 = 1-\\mu\\lambda$。将其代入雅可比矩阵：\n$$\nJ(P_{\\pm}) = \\begin{pmatrix} 1 - 3(1-\\mu\\lambda)  -\\mu \\\\ \\lambda  -1 \\end{pmatrix} = \\begin{pmatrix} -2 + 3\\mu\\lambda  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\n行列式为 $\\det(J) = (-2 + 3\\mu\\lambda)(-1) - (-\\mu)(\\lambda) = 2 - 3\\mu\\lambda + \\mu\\lambda = 2(1 - \\mu\\lambda)$。\n由于 $\\mu\\lambda  1$，$\\det(J)  0$。\n迹为 $\\text{tr}(J) = (-2 + 3\\mu\\lambda) + (-1) = -3 + 3\\mu\\lambda = 3(\\mu\\lambda - 1)$。\n由于 $\\mu\\lambda  1$，$\\text{tr}(J)  0$。\n由于 $\\det(J)  0$ 且 $\\text{tr}(J)  0$，两个特征值的实部都为负。因此，平衡点 $P_+$ 和 $P_-$ 是**稳定汇点**（吸引子）。\n\n**3. 吸引盆与分界线**\n状态空间包含两个吸引子（$P_+$ 和 $P_-$）和一个鞍点（$P_0$）。这证实了系统是多稳态的。所有轨迹收敛到 $P_+$ 的初始条件集合是它的吸引盆，记为 $\\mathcal{B}(P_+)$。对 $P_-$ 也是如此。状态空间 $\\mathbb{R}^2$ 被划分为这两个吸引盆及它们的公共边界。这个边界就是**分界线**。\n\n在这种类型的平面系统中，两个汇点吸引盆之间的边界是由位于该边界上的鞍点的**稳定流形**构成的。在这里，原点 $P_0$ 是一个鞍点。从其稳定流形 $W^s(P_0)$ 上开始的轨迹，当 $t \\to \\infty$ 时会收敛到原点。从该流形无穷小偏离处开始的轨迹将被鞍点沿其不稳定方向排斥，并最终流向两个汇点之一。因此，$W^s(P_0)$ 是一个分隔两个吸引盆的不变流形。\n\n**稳定流形定理**保证，对于像我们这个鞍点这样的双曲不动点，稳定流形 $W^s$ 是一个光滑嵌入的子流形，在不动点处与线性化系统（雅可比矩阵）的稳定特征空间相切。稳定特征空间是由对应于负特征值 $\\kappa_s = -\\sqrt{1-\\mu\\lambda}$ 的特征向量所张成的一维空间。\n\n要数值计算稳定流形，不能简单地进行时间正向积分，因为任何数值误差都会导致轨迹偏离鞍点。标准技术是从鞍点附近沿稳定特征向量的一个点开始，对系统进行**时间反向积分**（即，求解 $-t$ 的流）。\n\n### 逐项分析\n\n**A. 分隔吸引盆的边界是在 $(0,0)$ 处的鞍点平衡点的稳定流形 $W^s$；位于该不变流形两侧的初始条件会产生定性上不同的轨迹，它们渐近趋向于不同的稳定平衡点 $(+\\sqrt{1-\\mu\\lambda},\\,\\lambda\\sqrt{1-\\mu\\lambda})$ 或 $(-\\sqrt{1-\\mu\\lambda},\\,-\\lambda\\sqrt{1-\\mu\\lambda})$。在局部，分界线在 $(0,0)$ 处与雅可比矩阵的负特征值所对应的特征向量相切，并且可以通过从 $(0,0)$ 附近沿稳定特征方向的点开始对流进行时间反向积分来数值计算。**\n这个陈述是对情况全面而准确的描述。\n- 分界线确实是 $(0,0)$ 处鞍点的稳定流形。\n- 稳定平衡点的表达式是正确的。\n- 对分界线两侧轨迹行为的描述是正确的。\n- 关于分界线与稳定特征空间局部相切的陈述是稳定流形定理的直接推论。\n- 所提出的数值方法（时间反向积分）是计算稳定流形的正确标准程序。\n**结论：正确**\n\n**B. 分界线是在 $(0,0)$ 处的鞍点平衡点的不稳定流形 $W^u$；恰好在其上的初始条件会收敛到一个稳定平衡点，而在其附近的初始条件会沿其不稳定方向收敛到鞍点，因此 $W^u$ 决定了吸引盆的边界。**\n这个陈述错误地识别了分界线。是稳定流形 $W^s$，而不是不稳定流形 $W^u$，构成了吸引盆的边界。虽然 $W^u$ 上的轨迹确实流向稳定平衡点（形成异宿轨道），但 $W^u$ 本身并不分隔吸引盆。短语“在其附近的初始条件会沿其不稳定方向收敛到鞍点”也存在混淆；$W^u$ 上的轨迹是*离开*鞍点流动的。\n**结论：错误**\n\n**C. 对于所有允许的参数值，边界都与由 $x - x^3 - \\mu y = 0$ 定义的x-零斜线重合，因为轨迹不能穿过零斜线；因此，零斜线就是分界线。**\n前提“轨迹不能穿过零斜线”是错误的。在x-零斜线（$\\dot{x}=0$）上，向量场是垂直的（除了不动点外，$\\dot{y} = \\lambda x - y \\neq 0$）。轨迹是垂直穿过x-零斜线的。零斜线通常不是不变流形，也不作为分界线。\n**结论：错误**\n\n**D. 分界线是一个环绕 $(0,0)$ 处鞍点的闭合周期轨道，它将状态空间分为两个吸引盆；位于两侧的初始条件会无限期地保持在鞍点附近。**\n该系统中没有极限环。可以应用 Bendixson 判据。向量场的散度是 $\\nabla \\cdot (\\dot{x}, \\dot{y}) = \\frac{\\partial}{\\partial x}(x - x^3 - \\mu y) + \\frac{\\partial}{\\partial y}(\\lambda x - y) = (1 - 3x^2) - 1 = -3x^2$。该值总是 $\\le 0$，并且不在任何开集上恒等于零。Bendixson 判据（或其由 Dulac 推广的判据）排除了在任何单连通区域内存在周期轨道的可能性。相图由两个汇点和一个鞍点组成，分界线是鞍点的稳定流形。\n**结论：错误**\n\n**E. 对于具有双曲不动点的光滑平面系统，吸引盆边界通常是分形的；因此，在任何鞍点附近，吸引盆在任意精细的尺度上相互交错，分界线不是一个由线性化决定的不变流形。**\n这个陈述是错误的。虽然在动力系统中存在分形吸引盆边界，但这对于像本题这样的简单平面自治系统来说并非普遍情况。它们通常出现在更复杂的场景中，例如非自治（受迫）系统或具有三个或更多竞争吸引子且其吸引盆有特定相切情况的系统（Wada盆）。在这个系统中，吸引盆边界是一条光滑（$C^k$）曲线，即鞍点的稳定流形。根据稳定流形定理，分界线正是一个其局部行为由线性化决定的不变流形。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "分析高维或混沌系统可能令人望而生畏，因为它们的轨道极其复杂。庞加莱映射（Poincaré map）提供了一种强大的技术，通过将连续流变换为低维离散映射来简化分析。本练习  是一项实践性的计算任务，您将为著名的洛伦兹系统——一个混沌动力学的标杆——实现这一方法。通过在轨道穿越特定平面时进行“快照”，您将构建一个经验性的返回映射，并从中揭示混沌之中的隐藏秩序。",
            "id": "4272789",
            "problem": "考虑一个被称为 Lorenz 系统的三维自治常微分方程（ODE），它在状态空间 $\\mathbb{R}^3$ 上的流（flow）定义为\n$$\n\\dot{x} = \\sigma (y - x), \\quad \\dot{y} = x (\\rho - z) - y, \\quad \\dot{z} = x y - \\beta z,\n$$\n其中 $\\sigma$、$\\rho$ 和 $\\beta$ 是正常数，$(x,y,z)$ 是状态向量。Poincaré 截面是状态空间中一个余维数为一的曲面，轨迹会横截此曲面，从而可以构建一个 Poincaré 回归映射，该映射将一个交点映射到其与该截面的下一个交点。目标是为 Lorenz 系统设计一个合适的 Poincaré 截面，并从模拟的轨迹数据中数值估计一个一维（1D）回归映射。\n\n你的任务是：\n1. 提出并使用由平面 $y=0$ 定义的 Poincaré 截面，并考虑向上穿越的情况（即从 $y0$ 到 $y\\ge 0$）。对于每个交点，通过在连续的时间样本之间进行线性插值来近似交点。\n2. 根据下文的测试用例说明，将第 $n$ 个交点的标量可观测量 $u_n$ 定义为交点的 $x$ 坐标或 $z$ 坐标。\n3. 通过使用连续的交点构建点对 $(u_n, u_{n+1})$ 来构造经验回归映射，并且在指定的情况下，在计算统计数据之前，丢弃初始的一些交点作为瞬态（transient）。\n\n你的程序必须从基本原理出发：\n- 使用固定步长 $\\Delta t$ 的数值方法，从给定的初始条件 $(x_0,y_0,z_0)$ 出发，在总模拟时间 $T$ 内对 Lorenz ODE 进行积分。\n- 通过在连续步骤中监测 $y$ 的符号，检测轨迹向上穿越 Poincaré 截面 $y=0$ 的情况。当发生穿越时，沿两个连续采样状态之间的线段进行线性插值来近似交点。\n- 根据连续的交点形成经验回归映射，并按照下文的说明计算每个测试用例所要求的统计量。\n- 如果在丢弃瞬态部分后，回归映射点对少于两个，或者所要求的统计量因方差为零而未定义，则对于要求的浮点数统计量返回 $0.0$。如果测试用例要求布尔值或整数，则根据计算出的数据返回逻辑上正确的值。\n\n使用以下测试套件，其中规定了参数和要求的输出：\n\n- 测试用例 1（混沌状态，斜率估计）：\n  - 参数：$\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$。\n  - 可观测量：每次向上穿越 $y=0$ 时的 $u_n=x$。\n  - 瞬态丢弃：$N_{\\mathrm{skip}}=100$ 个交点。\n  - 输出：对保留的点对使用普通最小二乘法估计最佳仿射关系 $u_{n+1}\\approx a\\,u_n + b$ 的斜率 $a$。返回浮点数 $a$。\n\n- 测试用例 2（混沌状态，连续交点的相关性）：\n  - 参数：$\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$。\n  - 可观测量：每次向上穿越 $y=0$ 时的 $u_n=z$。\n  - 瞬态丢弃：$N_{\\mathrm{skip}}=100$ 个交点。\n  - 输出：计算保留点对中 $u_n$ 和 $u_{n+1}$ 之间的皮尔逊相关系数 $r$。返回浮点数 $r$。\n\n- 测试用例 3（短时间积分，数据充分性检查）：\n  - 参数：$\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=2$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$。\n  - 可观测量：每次向上穿越 $y=0$ 时的 $u_n=x$。\n  - 瞬态丢弃：$N_{\\mathrm{skip}}=0$ 个交点。\n  - 输出：返回一个布尔值，指示可用的回归映射点对数量是否大于或等于 $5$。\n\n- 测试用例 4（受限叶，带滤波的斜率估计）：\n  - 参数：$\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$。\n  - 可观测量：每次向上穿越 $y=0$ 时的 $u_n=x$，但只保留 $x0$ 的交点（以限制在吸引子的一个叶上）。\n  - 瞬态丢弃：$N_{\\mathrm{skip}}=100$ 个交点。\n  - 输出：对保留的点对使用普通最小二乘法估计最佳仿射关系 $u_{n+1}\\approx a\\,u_n + b$ 的斜率 $a$。返回浮点数 $a$。\n\n- 测试用例 5（非混沌状态，点对计数）：\n  - 参数：$\\sigma=10$, $\\rho=20$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$。\n  - 可观测量：每次向上穿越 $y=0$ 时的 $u_n=x$。\n  - 瞬态丢弃：$N_{\\mathrm{skip}}=0$ 个交点。\n  - 输出：返回在整个模拟过程中计算出的可用回归映射点对的整数数量。\n\n最终输出格式规范：\n- 你的程序应生成单行输出，其中包含五个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来，按测试用例 1 到 5 的顺序排列；例如 $[a_1,r_2,b_3,a_4,n_5]$，其中 $a_1$ 和 $a_4$是浮点数，$r_2$ 是浮点数，$b_3$ 是布尔值，$n_5$ 是整数。不应打印其他任何文本。",
            "solution": "该问题要求对 Lorenz 系统进行数值分析，这是一个表现出混沌行为的三维自治动力系统的典型例子。分析将通过从模拟轨迹构建一维 Poincaré 回归映射来执行。解决方案涉及数值积分、检测与 Poincaré 截面的交点以及对所得交点序列的统计分析。\n\n系统的状态由向量 $\\mathbf{x}(t) = (x(t), y(t), z(t))^{\\mathsf{T}} \\in \\mathbb{R}^3$ 给出。其演化由 Lorenz 方程决定：\n$$\n\\begin{aligned}\n\\dot{x} = \\sigma (y - x) \\\\\n\\dot{y} = x (\\rho - z) - y \\\\\n\\dot{z} = x y - \\beta z\n\\end{aligned}\n$$\n其中 $\\sigma$、$\\rho$ 和 $\\beta$ 是正实数参数。\n\n解决方案的核心是通过对这些常微分方程（ODEs）进行数值积分，来生成系统的离散时间轨迹。如题目所指定，对于固定步长的数值方法，一个标准且稳健的选择是四阶 Runge-Kutta (RK4) 方法。给定时间 $t_i$ 的状态 $\\mathbf{x}_i$，在时间 $t_{i+1} = t_i + \\Delta t$ 的状态 $\\mathbf{x}_{i+1}$ 按如下方式计算：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\Delta t \\cdot f(\\mathbf{x}_i, t_i) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot f(\\mathbf{x}_i + \\frac{1}{2}\\mathbf{k}_1, t_i + \\frac{1}{2}\\Delta t) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot f(\\mathbf{x}_i + \\frac{1}{2}\\mathbf{k}_2, t_i + \\frac{1}{2}\\Delta t) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot f(\\mathbf{x}_i + \\mathbf{k}_3, t_i + \\Delta t) \\\\\n\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\n其中 $f(\\mathbf{x}, t)$ 代表 Lorenz 方程的右侧。此过程在总模拟时间 $T$ 内重复进行。\n\nPoincaré 截面被定义为平面 $S = \\{ (x, y, z) \\in \\mathbb{R}^3 \\mid y = 0 \\}$。我们关注的是“向上”穿越此截面的轨迹，即从一个 $y  0$ 的状态到一个 $y \\ge 0$ 的状态。在从时间 $t_i$到 $t_{i+1}$ 的每个积分步骤中，我们检查 $y$ 坐标的符号。如果 $y(t_i)  0$ 且 $y(t_{i+1}) \\ge 0$，则检测到一次穿越。\n\n当在状态 $\\mathbf{x}_i$ 和 $\\mathbf{x}_{i+1}$ 之间检测到穿越时，平面 $y=0$ 上的交点 $\\mathbf{x}^*$ 使用线性插值进行近似。轨迹与平面相交的小数时间步长 $s \\in [0, 1)$ 可以通过求解 $y(t_i) + s(y(t_{i+1}) - y(t_i)) = 0$ 来找到 $s$：\n$$\ns = \\frac{-y(t_i)}{y(t_{i+1}) - y(t_i)}\n$$\n然后交点近似为：\n$$\n\\mathbf{x}^* = \\mathbf{x}_i + s (\\mathbf{x}_{i+1} - \\mathbf{x}_i)\n$$\n根据构造，$\\mathbf{x}^*$ 的 $y$ 坐标为 0。\n\n此过程产生一个按时间排序的交点序列 $\\{\\mathbf{x}^*_1, \\mathbf{x}^*_2, \\dots, \\mathbf{x}^*_M\\}$。对于每个测试用例，标量可观测量 $u_n$ 被定义为第 $n$ 个交点 $\\mathbf{x}^*_n$ 的 $x$ 坐标或 $z$ 坐标。这会创建一个序列 $\\{u_1, u_2, \\dots, u_M\\}$。\n\n通过构建连续观测值的点对 $(u_n, u_{n+1})$ 来构造经验回归映射。在分析之前，可能会丢弃初始数量为 $N_{\\mathrm{skip}}$ 的交点以移除瞬态动力学，从而得到一个从 $u_{N_{\\mathrm{skip}}+1}$ 开始的新序列。\n\n然后，根据剩余的点对 $(u_n, u_{n+1})$ 计算每个测试用例的特定统计量：\n- **仿射拟合的斜率（用例 1 和 4）：** 对于点对 $(u_n, u_{n+1})$（我们可以将其表示为 $(x_i, y_i)$），使用普通最小二乘法估计最佳拟合线 $y \\approx ax+b$ 的斜率 $a$。斜率的公式是：\n$$\na = \\frac{\\text{cov}(u_n, u_{n+1})}{\\text{var}(u_n)} = \\frac{\\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2}\n$$\n其中 $N$ 是点对的数量，$\\bar{x}, \\bar{y}$ 是样本均值。如果 $u_n$ 的方差为零，则斜率未定义，根据问题规范返回 $0.0$。\n\n- **皮尔逊相关系数（用例 2）：** 计算序列 $\\{u_n\\}$ 和 $\\{u_{n+1}\\}$ 之间的皮尔逊相关系数 $r$。它定义为：\n$$\nr = \\frac{\\text{cov}(u_n, u_{n+1})}{\\sigma_{u_n} \\sigma_{u_{n+1}}}\n$$\n其中 $\\sigma$ 表示标准差。如果任一序列的方差为零，则 $r$ 未定义，并返回 $0.0$。\n\n- **数据充分性（用例 3 和 5）：** 这些用例涉及计算在应用任何指定的滤波器和瞬态丢弃规则后获得的有效回归映射点对 $(u_n, u_{n+1})$ 的数量。对于用例 3，返回一个布尔值，指示此计数是否至少为 $5$。对于用例 5，返回整数计数值本身。\n\n为每个测试用例实现了特殊处理，例如在用例 4 中筛选 $x0$ 的交点。整个过程封装在一个程序中，该程序遍历指定的测试用例，为每个用例执行模拟和分析，并以要求的格式报告结果。如果在任何阶段，数据点数量不足以形成所需的点对数量（例如，用于斜率/相关性计算的点对少于两个），则返回指定的默认值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n\n    test_cases = [\n        {\n            'case_id': 1, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 100,\n            'output_type': 'float'\n        },\n        {\n            'case_id': 2, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'z', 'N_skip': 100,\n            'output_type': 'float'\n        },\n        {\n            'case_id': 3, 'params': (10.0, 28.0, 8.0/3.0), 'T': 2.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 0,\n            'output_type': 'bool'\n        },\n        {\n            'case_id': 4, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 100,\n            'output_type': 'float_filtered'\n        },\n        {\n            'case_id': 5, 'params': (10.0, 20.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 0,\n            'output_type': 'int'\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_and_analysis(case)\n        results.append(result)\n    \n    # Format boolean 'True' -> 'True' as per standard str() behavior.\n    # If 'true' is required, str(r).lower() would be used.\n    # The problem description is ambiguous; standard str() is the most direct interpretation.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef lorenz_deriv(state, sigma, rho, beta):\n    \"\"\"Computes the derivative of the Lorenz system.\"\"\"\n    x, y, z = state\n    dx_dt = sigma * (y - x)\n    dy_dt = x * (rho - z) - y\n    dz_dt = x * y - beta * z\n    return np.array([dx_dt, dy_dt, dz_dt], dtype=np.float64)\n\ndef run_simulation_and_analysis(case_params):\n    \"\"\"\n    Runs the simulation for a single test case and computes the required statistic.\n    \"\"\"\n    sigma, rho, beta = case_params['params']\n    T, dt = case_params['T'], case_params['dt']\n    x0, y0, z0 = case_params['ic']\n    observable_name = case_params['observable']\n    N_skip = case_params['N_skip']\n    case_id = case_params['case_id']\n    output_type = case_params['output_type']\n\n    # --- Simulation Phase ---\n    state = np.array([x0, y0, z0], dtype=np.float64)\n    num_steps = int(round(T / dt))\n    \n    intersections = []\n    \n    for _ in range(num_steps):\n        state_prev = state\n        y_prev = state[1]\n\n        # 4th-order Runge-Kutta integration step\n        k1 = dt * lorenz_deriv(state, sigma, rho, beta)\n        k2 = dt * lorenz_deriv(state + 0.5 * k1, sigma, rho, beta)\n        k3 = dt * lorenz_deriv(state + 0.5 * k2, sigma, rho, beta)\n        k4 = dt * lorenz_deriv(state + k3, sigma, rho, beta)\n        state = state + (k1 + 2*k2 + 2*k3 + k4) / 6.0\n        y_next = state[1]\n\n        # Upward crossing detection (y0 to y>=0)\n        if y_prev  0.0 and y_next >= 0.0:\n            if y_next == y_prev:\n                s = 1.0\n            else:\n                s = -y_prev / (y_next - y_prev)\n            \n            interp_state = state_prev + s * (state - state_prev)\n            intersections.append(interp_state)\n\n    # --- Analysis Phase ---\n    \n    # Special filter for Case 4\n    if output_type == 'float_filtered':\n        intersections = [p for p in intersections if p[0] > 0.0]\n\n    # Create observable sequence\n    obs_idx = 0 if observable_name == 'x' else 2\n    u_full = np.array([p[obs_idx] for p in intersections])\n\n    # Discard transients\n    if len(u_full) = N_skip:\n        u = np.array([])\n    else:\n        u = u_full[N_skip:]\n    \n    num_pairs = len(u) - 1 if len(u) > 0 else 0\n\n    # Case-specific return values\n    if output_type == 'bool':\n        return num_pairs >= 5\n\n    if output_type == 'int':\n        return num_pairs\n    \n    # For float outputs (slope, correlation)\n    if num_pairs  2:\n        return 0.0\n\n    u_n = u[:-1]\n    u_n_plus_1 = u[1:]\n\n    if output_type in ['float', 'float_filtered']: # Slope calculation\n        var_un = np.var(u_n)\n        if var_un == 0.0:\n            return 0.0\n        \n        # OLS slope a = cov(x,y)/var(x)\n        cov_val = np.cov(u_n, u_n_plus_1, ddof=0)[0, 1]\n        slope = cov_val / var_un\n        return slope\n\n    # This part of the code is for case_id 2 (correlation)\n    # np.corrcoef returns a 2x2 matrix; the correlation is at [0,1]\n    corr = np.corrcoef(u_n, u_n_plus_1)[0, 1]\n    \n    # Return 0.0 if statistic is undefined (e.g., zero variance)\n    return 0.0 if np.isnan(corr) else corr\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}