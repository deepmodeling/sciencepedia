{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the logistic map, a paradigmatic model in population dynamics and chaos theory. This exercise challenges you to move beyond simply identifying fixed points by determining their stability and, crucially, mapping out the entire basin of attraction for the stable state. By analyzing the system for a parameter regime where the dynamics are simple, this practice solidifies the fundamental connection between local stability analysis using derivatives and the global behavior of trajectories across the state space .",
            "id": "4272727",
            "problem": "Consider the discrete-time dynamical system defined by the logistic map $f_{r}:[0,1]\\to[0,1]$ given by $f_{r}(x)=r\\,x\\,(1-x)$, where $r$ is a parameter and $x$ is the state variable. The state space is the compact interval $[0,1]$, and the trajectories are generated by $x_{k+1}=f_{r}(x_{k})$. Work in the parameter regime $1r3$. Use the following fundamental base:\n- A fixed point $x^{\\ast}$ satisfies $f_{r}(x^{\\ast})=x^{\\ast}$.\n- Local asymptotic stability of a fixed point for one-dimensional iterated maps is guaranteed when $|f_{r}'(x^{\\ast})|1$.\n- The basin of attraction of an attracting fixed point $x^{\\ast}$ is the set of initial conditions $x_{0}$ whose trajectory $\\{x_{k}\\}_{k\\ge 0}$ converges to $x^{\\ast}$.\n\nTasks:\n1. Identify the stable fixed point $x^{\\ast}$ for $1r3$ and justify its stability using the above base.\n2. Determine the basin of attraction of $x^{\\ast}$ restricted to the invariant interval $[0,1]$, and compute its Lebesgue measure (length) within $[0,1]$. Express your final answer as a real number.\n3. Explain, using dynamical-systems reasoning grounded in the above base (without invoking unproven shortcuts), how the interval boundary points $0$ and $1$ influence the basin of attraction in this parameter regime.\n\nNo rounding is required; give the exact value of the requested measure as a real number.",
            "solution": "The problem requires an analysis of the logistic map $f_{r}(x)=r\\,x\\,(1-x)$ on the state space $[0,1]$ for the parameter regime $1r3$. The analysis will proceed in three parts as specified by the tasks.\n\n**1. Identification and Stability of the Fixed Point**\n\nA fixed point $x^{\\ast}$ of the map $f_r$ is a solution to the equation $f_{r}(x^{\\ast})=x^{\\ast}$.\n$$r\\,x^{\\ast}\\,(1-x^{\\ast}) = x^{\\ast}$$\nThis equation can be rearranged as:\n$$r\\,x^{\\ast} - r\\,(x^{\\ast})^{2} - x^{\\ast} = 0$$\n$$x^{\\ast}\\,(r - 1 - r\\,x^{\\ast}) = 0$$\nThis yields two possible fixed points:\n$$x^{\\ast}_{1} = 0$$\n$$r - 1 - r\\,x^{\\ast}_{2} = 0 \\implies x^{\\ast}_{2} = \\frac{r-1}{r} = 1 - \\frac{1}{r}$$\nFor the given parameter range $1r3$, both fixed points are within the state space $[0,1]$. Specifically, $0  1/3  1/r  1$, which implies $0  1-1/r  2/3$, so $x^{\\ast}_{2} \\in (0, 2/3) \\subset [0,1]$.\n\nTo determine the stability of these fixed points, we use the provided criterion $|f_{r}'(x^{\\ast})|1$. The derivative of $f_r(x)$ with respect to $x$ is:\n$$f_{r}'(x) = \\frac{d}{dx}\\left(r\\,x - r\\,x^{2}\\right) = r - 2\\,r\\,x$$\n\nWe evaluate this derivative at each fixed point.\nFor $x^{\\ast}_{1} = 0$:\n$$f_{r}'(0) = r - 2\\,r\\,(0) = r$$\nThe stability condition is $|r|1$. However, the problem specifies the parameter regime $1r3$. In this regime, $|f_{r}'(0)| = r  1$, so the fixed point $x^{\\ast}_{1}=0$ is unstable (repelling).\n\nFor $x^{\\ast}_{2} = 1 - \\frac{1}{r}$:\n$$f_{r}'\\left(1 - \\frac{1}{r}\\right) = r - 2\\,r\\,\\left(1 - \\frac{1}{r}\\right) = r - 2\\,(r-1) = r - 2\\,r + 2 = 2 - r$$\nThe stability condition is $|2-r|1$. This inequality is equivalent to the compound inequality $-1  2-r  1$.\nThe right side, $2-r  1$, implies $1  r$.\nThe left side, $-1  2-r$, implies $r  3$.\nThus, the condition for stability is $1r3$, which is precisely the parameter regime specified in the problem.\n\nTherefore, for $1r3$, the unique stable fixed point is $x^{\\ast} = 1 - \\frac{1}{r}$.\n\n**2. Basin of Attraction and its Lebesgue Measure**\n\nThe basin of attraction of the stable fixed point $x^{\\ast} = 1 - \\frac{1}{r}$, denoted $\\mathcal{B}(x^{\\ast})$, is the set of all initial conditions $x_{0} \\in [0,1]$ such that the trajectory $x_{k+1}=f_{r}(x_{k})$ converges to $x^{\\ast}$ as $k \\to \\infty$.\n\nThe state space $[0,1]$ is a compact set. For $1r3$, the map has one attracting fixed point, $x^{\\ast} = 1 - \\frac{1}{r}$, and one repelling fixed point, $x=0$. The basin of attraction $\\mathcal{B}(x^{\\ast})$ consists of all points in $[0,1]$ except those whose trajectories converge to another attractor or are part of the boundary of the basin. In this one-dimensional system, the only points that do not converge to the attractor $x^{\\ast}$ are those that constitute the basin of the repeller $x=0$.\n\nThe basin of the repelling fixed point $x=0$, denoted $\\mathcal{B}(0)$, consists of $x=0$ itself and the set of all its preimages. A point $y$ is a preimage of $z$ if $f_r(y)=z$.\nThe set of all preimages of $0$ is $\\bigcup_{k=1}^{\\infty} f_r^{-k}(\\{0\\})$, where $f_r^{-k}$ is the $k$-th inverse image map.\n- First preimages of $0$: We solve $f_r(x)=0$, which is $r\\,x\\,(1-x)=0$. The solutions are $x=0$ and $x=1$. So, $f_r^{-1}(\\{0\\}) = \\{0,1\\}$.\n- Second preimages of $0$: These are the first preimages of the set $\\{0,1\\}$. $f_r^{-2}(\\{0\\}) = f_r^{-1}(\\{0, 1\\}) = f_r^{-1}(\\{0\\}) \\cup f_r^{-1}(\\{1\\})$. We already have $f_r^{-1}(\\{0\\}) = \\{0,1\\}$. We now find the preimages of $1$ by solving $f_r(x)=1$:\n$$r\\,x\\,(1-x)=1 \\implies r\\,x - r\\,x^{2} = 1 \\implies r\\,x^{2} - r\\,x + 1 = 0$$\nThe discriminant of this quadratic equation is $\\Delta = (-r)^{2} - 4(r)(1) = r^{2} - 4r = r(r-4)$. For the parameter regime $1r3$, the term $r-4$ is negative, so $\\Delta  0$. This means there are no real solutions for $x$. Therefore, the set of preimages of $1$ is empty: $f_r^{-1}(\\{1\\}) = \\emptyset$.\n- Consequently, $f_r^{-2}(\\{0\\}) = \\{0,1\\} \\cup \\emptyset = \\{0,1\\}$. By induction, $f_r^{-k}(\\{0\\}) = \\{0,1\\}$ for all $k \\ge 1$.\n\nThe set of all points whose trajectories eventually land on $0$ is precisely the set $\\{0,1\\}$. Thus, the basin of attraction of the repelling fixed point $0$ is $\\mathcal{B}(0) = \\{0,1\\}$.\n\nThe basin of attraction of the stable fixed point $x^{\\ast}$ is the entire state space minus the basin of the repeller:\n$$\\mathcal{B}(x^{\\ast}) = [0,1] \\setminus \\mathcal{B}(0) = [0,1] \\setminus \\{0,1\\} = (0,1)$$\nThe basin of attraction is the open interval $(0,1)$.\n\nThe Lebesgue measure of a set is its length in one dimension. The Lebesgue measure of the interval $(0,1)$ is $1-0=1$.\n\n**3. Influence of Boundary Points on the Basin of Attraction**\n\nThe boundary points of the state space, $x=0$ and $x=1$, play a critical role in defining the basin of attraction of $x^{\\ast}$.\n\n- The point $x=0$ is a fixed point of the map. As established, it is a repelling fixed point for $1  r  3$ because $|f_{r}'(0)| = r  1$. This instability is fundamental. It ensures that any trajectory starting infinitesimally close to $0$, but not exactly at $0$, will be pushed away from it and into the interior of the interval $(0,1)$. Thus, $x=0$ acts as a source, preventing trajectories from accumulating at this boundary and directing them toward the stable fixed point. The point $x=0$ itself does not belong to the basin of $x^{\\ast}$; its trajectory is static, $\\{0, 0, 0, \\ldots\\}$, converging to $0$.\n\n- The point $x=1$ is not a fixed point, but it is a first preimage of the repelling fixed point $x=0$, since $f_r(1) = r(1)(1-1)=0$. The trajectory starting at $x_0=1$ is $\\{1, 0, 0, 0, \\ldots\\}$, which converges to $0$. Therefore, $x=1$ also does not belong to the basin of $x^{\\ast}$. It acts as the other endpoint of the basin.\n\n- For any initial condition $x_0 \\in (0,1)$, the first iterate is $x_1 = f_r(x_0) = r x_0 (1-x_0)$. Since $x_0 \\in (0,1)$, we have $x_1  0$. The maximum value of $f_r(x)$ on $[0,1]$ is $f_r(1/2) = r/4$. Since $r3$, we have $r/4  3/4  1$. Thus, for any $x_0 \\in (0,1)$, we have $x_1 = f_r(x_0) \\in (0, r/4] \\subset (0,1)$. By induction, the entire trajectory $\\{x_k\\}_{k \\ge 1}$ remains strictly within the open interval $(0,1)$. The trajectory is trapped within $(0,1)$ and can never reach the boundary points $0$ or $1$.\n\nIn summary, the dynamics on the boundary points $\\{0,1\\}$ define the extent of the basin of attraction $\\mathcal{B}(x^{\\ast})$. These two points are precisely the set of initial conditions in $[0,1]$ whose trajectories do not converge to the stable fixed point $x^{\\ast}$. All other points, which constitute the open interval $(0,1)$, have trajectories that are bounded away from the repeller at $0$ and are confined to the interval where $x^{\\ast}$ is the only attractor, thus ensuring their convergence to it.",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "Moving from a one-dimensional map to a two-dimensional continuous flow, the structure of the state space becomes significantly richer and more geometric. This problem presents a bistable planar system where the state space is partitioned into distinct basins of attraction for two stable equilibria. Your task is to identify the separatrix—the invariant manifold that forms the boundary between these basins—by analyzing the properties of the system's fixed points, particularly the saddle point that organizes the global flow .",
            "id": "4272744",
            "problem": "Consider the planar autonomous system defined on the state space $\\mathbb{R}^2$ by the ordinary differential equations\n$$\n\\dot{x} = x - x^3 - \\mu y,\\qquad \\dot{y} = \\lambda x - y,\n$$\nwhere $\\mu  0$ and $\\lambda  0$ are parameters, and assume $\\mu \\lambda  1$. In the language of complex systems and network science, the system exhibits multistability, and the state space is partitioned into basins of attraction separated by a boundary (a separatrix). Using only core definitions of trajectories in state space, equilibria, linearization via the Jacobian, hyperbolicity, and basins of attraction, analyze the qualitative behavior of trajectories initiated near the separatrix and identify how the boundary in state space is determined.\n\nYour reasoning should begin from the definitions: a trajectory is the solution curve of the vector field in the state space; an equilibrium is a point where the vector field vanishes; the Jacobian linearization at a hyperbolic equilibrium governs local dynamics; the stable and unstable manifolds are invariant sets tangent to the corresponding eigenspaces at the equilibrium; basins of attraction are sets of initial conditions whose trajectories converge to specific attractors.\n\nWhich of the following statements is correct?\n\nA. The boundary that separates basins of attraction is the stable manifold $W^s$ of the saddle equilibrium at $(0,0)$; initial conditions on either side of this invariant manifold produce qualitatively different trajectories that asymptotically approach the distinct stable equilibria $(+\\sqrt{1-\\mu\\lambda},\\,\\lambda\\sqrt{1-\\mu\\lambda})$ or $(-\\sqrt{1-\\mu\\lambda},\\,-\\lambda\\sqrt{1-\\mu\\lambda})$. Locally, the separatrix is tangent at $(0,0)$ to the eigenvector of the Jacobian associated with the negative eigenvalue, and it can be computed numerically by integrating the flow backward in time from a point near $(0,0)$ in the stable eigendirection.\n\nB. The separatrix is the unstable manifold $W^u$ of the saddle equilibrium at $(0,0)$; initial conditions exactly on it converge to a stable equilibrium, whereas initial conditions near it converge to the saddle along its unstable direction, so $W^u$ determines the basin boundary.\n\nC. The boundary coincides with the $x$-nullcline defined by $x - x^3 - \\mu y = 0$ for all admissible parameter values, because trajectories cannot cross nullclines; therefore, the nullcline is the separatrix.\n\nD. The separatrix is a closed periodic orbit encircling the saddle at $(0,0)$ that divides the state space into two basins; initial conditions on either side remain near the saddle indefinitely.\n\nE. For smooth planar systems with hyperbolic fixed points, the basin boundary is generically fractal; therefore, near any saddle the basins of attraction interleave at arbitrarily fine scales, and the separatrix is not an invariant manifold determined by linearization.",
            "solution": "The user wants me to analyze a planar dynamical system, validate the problem statement, and then evaluate the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\nThe planar autonomous system is defined by the ordinary differential equations:\n$$\n\\dot{x} = x - x^3 - \\mu y\n$$\n$$\n\\dot{y} = \\lambda x - y\n$$\nThe state space is $\\mathbb{R}^2$. The parameters $\\mu$ and $\\lambda$ satisfy $\\mu  0$ and $\\lambda  0$. An additional constraint is given: $\\mu \\lambda  1$. The problem requires analysis based on core definitions: trajectory, equilibrium, Jacobian linearization, hyperbolicity, stable/unstable manifolds, and basins of attraction.\n\n**Step 2: Validate Using Extracted Givens**\n1.  **Scientific Groundedness:** The problem describes a standard two-dimensional autonomous system of ordinary differential equations. The concepts mentioned—equilibria, stability, Jacobian linearization, stable/unstable manifolds, basins of attraction, and separatrices—are foundational and rigorously defined within the mathematical field of dynamical systems. The system itself is a classic example of a bistable system, similar in structure to models like the FitzHugh-Nagumo equations. The problem is scientifically and mathematically sound.\n2.  **Well-Posedness:** The vector field $(f_1(x,y), f_2(x,y)) = (x - x^3 - \\mu y, \\lambda x - y)$ is composed of polynomial functions, which are infinitely differentiable ($C^\\infty$) on $\\mathbb{R}^2$. By the Picard-Lindelöf theorem (or Cauchy-Lipschitz theorem), for any initial condition $(x_0, y_0) \\in \\mathbb{R}^2$, a unique local solution (trajectory) exists and is continuous. The global existence of solutions for all time is also assured as trajectories are bounded. The question asks for the correct characterization of the basin boundary, which is a well-defined question in this context.\n3.  **Objectivity:** The problem is stated using precise mathematical language and definitions. There are no subjective, ambiguous, or opinion-based statements.\n4.  **Incomplete or Contradictory Setup:** The system equations, parameter constraints ($\\mu0$, $\\lambda0$, $\\mu\\lambda1$), and state space are all explicitly provided. These conditions are self-consistent and sufficient to perform a qualitative analysis of the system's phase portrait.\n5.  **Unrealistic or Infeasible:** The problem is a mathematical abstraction and does not claim to represent a specific physical system, so physical realism is not a primary concern. Mathematically, the conditions are feasible.\n6.  **Ill-Posed or Poorly Structured:** The problem is well-structured and leads to a unique qualitative description of the dynamics. The question is not circular.\n7.  **Pseudo-Profound, Trivial, or Tautological:** The analysis required is non-trivial. It involves finding equilibria, using the Jacobian to determine their stability, and applying the Stable Manifold Theorem to correctly identify the separatrix. This is a standard but substantive problem in an introductory course on nonlinear dynamics.\n8.  **Outside Scientific Verifiability:** All claims can be rigorously verified using standard mathematical techniques from the theory of differential equations.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the solution.\n\n### Solution Derivation\n\n**1. Find Equilibria (Fixed Points)**\nEquilibria are points $(x, y)$ where $\\dot{x} = 0$ and $\\dot{y} = 0$.\nThe system of equations for the equilibria is:\n$$\nx - x^3 - \\mu y = 0 \\quad (1)\n$$\n$$\n\\lambda x - y = 0 \\quad (2)\n$$\nFrom equation $(2)$, we have $y = \\lambda x$. Substituting this into equation $(1)$:\n$$\nx - x^3 - \\mu(\\lambda x) = 0\n$$\n$$\nx(1 - x^2 - \\mu\\lambda) = 0\n$$\nThis equation yields three solutions for $x$:\n- $x = 0$\n- $x^2 = 1 - \\mu\\lambda \\implies x = \\pm\\sqrt{1-\\mu\\lambda}$\n\nThe condition $\\mu\\lambda  1$ ensures that $1 - \\mu\\lambda  0$, so the two non-zero solutions for $x$ are real and distinct. We find the corresponding $y$ values using $y = \\lambda x$. The three equilibrium points are:\n1.  The origin: $P_0 = (0, 0)$\n2.  $P_+ = (\\sqrt{1-\\mu\\lambda}, \\lambda\\sqrt{1-\\mu\\lambda})$\n3.  $P_- = (-\\sqrt{1-\\mu\\lambda}, -\\lambda\\sqrt{1-\\mu\\lambda})$\n\n**2. Stability Analysis via Linearization**\nThe Jacobian matrix of the system is:\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 - 3x^2  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\n\n**Stability at the origin $P_0 = (0,0)$:**\n$$\nJ(0,0) = \\begin{pmatrix} 1  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\nThe determinant is $\\det(J) = (1)(-1) - (-\\mu)(\\lambda) = \\mu\\lambda - 1$.\nThe trace is $\\text{tr}(J) = 1 + (-1) = 0$.\nSince we are given $\\mu\\lambda  1$, we have $\\det(J)  0$. A real matrix with a negative determinant always has one positive and one negative real eigenvalue, which means the equilibrium is a **saddle point**. Saddle points are by definition hyperbolic. The eigenvalues $\\kappa$ are given by the characteristic equation $\\kappa^2 - \\text{tr}(J)\\kappa + \\det(J) = 0$, which simplifies to $\\kappa^2 + (\\mu\\lambda - 1) = 0$, so $\\kappa = \\pm\\sqrt{1-\\mu\\lambda}$.\n\n**Stability at $P_{\\pm} = (\\pm\\sqrt{1-\\mu\\lambda}, \\pm\\lambda\\sqrt{1-\\mu\\lambda})$:**\nFor these points, $x^2 = 1-\\mu\\lambda$. Substituting this into the Jacobian:\n$$\nJ(P_{\\pm}) = \\begin{pmatrix} 1 - 3(1-\\mu\\lambda)  -\\mu \\\\ \\lambda  -1 \\end{pmatrix} = \\begin{pmatrix} -2 + 3\\mu\\lambda  -\\mu \\\\ \\lambda  -1 \\end{pmatrix}\n$$\nThe determinant is $\\det(J) = (-2 + 3\\mu\\lambda)(-1) - (-\\mu)(\\lambda) = 2 - 3\\mu\\lambda + \\mu\\lambda = 2(1 - \\mu\\lambda)$.\nSince $\\mu\\lambda  1$, $\\det(J)  0$.\nThe trace is $\\text{tr}(J) = (-2 + 3\\mu\\lambda) + (-1) = -3 + 3\\mu\\lambda = 3(\\mu\\lambda - 1)$.\nSince $\\mu\\lambda  1$, $\\text{tr}(J)  0$.\nSince $\\det(J)  0$ and $\\text{tr}(J)  0$, both eigenvalues have negative real parts. Therefore, the equilibria $P_+$ and $P_-$ are **stable sinks** (attractors).\n\n**3. Basins of Attraction and Separatrix**\nThe state space contains two attractors ($P_+$ and $P_-$) and one saddle point ($P_0$). This confirms the system is multistable. The set of all initial conditions whose trajectories converge to $P_+$ is its basin of attraction, $\\mathcal{B}(P_+)$. Similarly for $P_-$. The state space $\\mathbb{R}^2$ is partitioned into these two basins and their common boundary. This boundary is the **separatrix**.\n\nIn a planar system of this type, the boundary between the basins of two sinks is formed by the **stable manifold** of the saddle point(s) lying on that boundary. Here, the origin $P_0$ is a saddle. Trajectories starting on its stable manifold, $W^s(P_0)$, converge to the origin as $t \\to \\infty$. Trajectories starting infinitesimally off this manifold will be repelled by the saddle along its unstable direction and will ultimately flow to one of the two sinks. Therefore, $W^s(P_0)$ is an invariant manifold that separates the two basins of attraction.\n\nThe **Stable Manifold Theorem** guarantees that for a hyperbolic fixed point like our saddle, the stable manifold $W^s$ is a smoothly embedded submanifold tangent at the fixed point to the stable eigenspace of the linearized system (the Jacobian). The stable eigenspace is the one-dimensional space spanned by the eigenvector corresponding to the negative eigenvalue $\\kappa_s = -\\sqrt{1-\\mu\\lambda}$.\n\nTo numerically compute the stable manifold, one cannot simply integrate forward in time, as any numerical error will cause the trajectory to diverge from the saddle. The standard technique is to start at a point very close to the saddle along the stable eigenvector and integrate the system **backwards in time** (i.e., solve for the flow with $-t$).\n\n### Option-by-Option Analysis\n\n**A. The boundary that separates basins of attraction is the stable manifold $W^s$ of the saddle equilibrium at $(0,0)$; initial conditions on either side of this invariant manifold produce qualitatively different trajectories that asymptotically approach the distinct stable equilibria $(+\\sqrt{1-\\mu\\lambda},\\,\\lambda\\sqrt{1-\\mu\\lambda})$ or $(-\\sqrt{1-\\mu\\lambda},\\,-\\lambda\\sqrt{1-\\mu\\lambda})$. Locally, the separatrix is tangent at $(0,0)$ to the eigenvector of the Jacobian associated with the negative eigenvalue, and it can be computed numerically by integrating the flow backward in time from a point near $(0,0)$ in the stable eigendirection.**\nThis statement is a comprehensive and accurate description of the situation.\n- The separatrix is indeed the stable manifold of the saddle at $(0,0)$.\n- The identities of the stable equilibria are correct.\n- The description of the behavior of trajectories on either side of the separatrix is correct.\n- The statement about the local tangency of the separatrix to the stable eigenspace is a direct consequence of the Stable Manifold Theorem.\n- The proposed numerical method (backward integration in time) is the correct standard procedure for computing stable manifolds.\n**Verdict: Correct**\n\n**B. The separatrix is the unstable manifold $W^u$ of the saddle equilibrium at $(0,0)$; initial conditions exactly on it converge to a stable equilibrium, whereas initial conditions near it converge to the saddle along its unstable direction, so $W^u$ determines the basin boundary.**\nThis statement incorrectly identifies the separatrix. The stable manifold $W^s$, not the unstable manifold $W^u$, forms the basin boundary. While trajectories on $W^u$ do flow towards the stable equilibria (forming heteroclinic orbits), $W^u$ itself does not separate the basins. The phrase \"initial conditions near it converge to the saddle along its unstable direction\" is also confused; trajectories on $W^u$ flow *away* from the saddle.\n**Verdict: Incorrect**\n\n**C. The boundary coincides with the $x$-nullcline defined by $x - x^3 - \\mu y = 0$ for all admissible parameter values, because trajectories cannot cross nullclines; therefore, the nullcline is the separatrix.**\nThe premise \"trajectories cannot cross nullclines\" is false. On the $x$-nullcline ($\\dot{x}=0$), the vector field is vertical ($\\dot{y} = \\lambda x - y \\neq 0$ except at fixed points). Trajectories cross the $x$-nullcline vertically. Nullclines are not, in general, invariant manifolds and do not serve as separatrices.\n**Verdict: Incorrect**\n\n**D. The separatrix is a closed periodic orbit encircling the saddle at $(0,0)$ that divides the state space into two basins; initial conditions on either side remain near the saddle indefinitely.**\nThere are no limit cycles in this system. Bendixson's criterion can be applied. The divergence of the vector field is $\\nabla \\cdot (\\dot{x}, \\dot{y}) = \\frac{\\partial}{\\partial x}(x - x^3 - \\mu y) + \\frac{\\partial}{\\partial y}(\\lambda x - y) = (1 - 3x^2) - 1 = -3x^2$. This quantity is always $\\le 0$ and is not identically zero on any open set. Bendixson's criterion (or its extension by Dulac) precludes the existence of periodic orbits in any simply connected region. The phase portrait consists of two sinks and a saddle, with the separatrix being the stable manifold of the saddle.\n**Verdict: Incorrect**\n\n**E. For smooth planar systems with hyperbolic fixed points, the basin boundary is generically fractal; therefore, near any saddle the basins of attraction interleave at arbitrarily fine scales, and the separatrix is not an invariant manifold determined by linearization.**\nThis statement is incorrect. While fractal basin boundaries exist in dynamical systems, they are not the generic case for simple planar autonomous systems like this one. They typically arise in more complex scenarios, such as non-autonomous (forced) systems or systems with three or more competing attractors whose basins have particular tangencies (Wada basins). In this system, the basin boundary is a smooth ($C^k$) curve, the stable manifold of the saddle. The separatrix is precisely an invariant manifold whose local behavior is determined by linearization, as per the Stable Manifold Theorem.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "For complex, high-dimensional systems like the Lorenz model, analytical solutions are typically out of reach, and we must turn to computational methods to uncover their intricate dynamics. This practice guides you through the powerful technique of constructing a Poincaré map, which reduces a continuous flow to a discrete map, making the structure of the dynamics easier to visualize and analyze. By numerically simulating a trajectory and recording its successive intersections with a chosen plane, you will build an empirical return map that reveals the deterministic, yet chaotic, nature of the Lorenz attractor .",
            "id": "4272789",
            "problem": "Consider the three-dimensional autonomous ordinary differential equation (ODE) known as the Lorenz system, defined on the state space $\\mathbb{R}^3$ by the flow\n$$\n\\dot{x} = \\sigma (y - x), \\quad \\dot{y} = x (\\rho - z) - y, \\quad \\dot{z} = x y - \\beta z,\n$$\nwhere $\\sigma$, $\\rho$, and $\\beta$ are positive parameters, and $(x,y,z)$ is the state vector. A Poincaré section is a codimension-one surface in state space that is transversally intersected by trajectories, enabling the construction of a Poincaré return map that maps a point of intersection to its next intersection with the section. The goal is to design a suitable Poincaré section for the Lorenz system and to numerically estimate a one-dimensional (1D) return map from simulated trajectory data.\n\nYour tasks are:\n1. Propose and use the Poincaré section defined by the plane $y=0$ with crossings in the upward direction (that is, from $y0$ to $y\\ge 0$). For each intersection, approximate the intersection point by linear interpolation between successive time samples.\n2. Define a scalar observable $u_n$ at the $n$-th intersection as either the $x$-coordinate or the $z$-coordinate of the intersection point, depending on the test case specification below.\n3. Construct the empirical return map by forming pairs $(u_n, u_{n+1})$ using successive intersections, and, where specified, discard an initial set of intersections as transients before computing the statistics.\n\nFrom first principles, your program must:\n- Integrate the Lorenz ODE using a fixed-step numerical method with step size $\\Delta t$ over a total simulation time $T$ from a given initial condition $(x_0,y_0,z_0)$.\n- Detect crossings of the Poincaré section $y=0$ in the upward direction by monitoring the sign of $y$ at successive steps. When a crossing occurs, approximate the intersection point by linear interpolation along the segment between the two successive sampled states.\n- Form the empirical return map from successive intersections and compute the requested statistic per test case as specified below.\n- If there are fewer than two return-map pairs after discarding transients, or the required statistic is undefined due to zero variance, return $0.0$ for the requested float statistic. If a test case requests a boolean or integer, return the logically correct value given the computed data.\n\nUse the following test suite, which specifies parameters and requested outputs:\n\n- Test case $1$ (chaotic regime, slope estimate):\n  - Parameters: $\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$.\n  - Observable: $u_n=x$ at each upward crossing of $y=0$.\n  - Transient discard: $N_{\\mathrm{skip}}=100$ intersections.\n  - Output: estimate the slope $a$ of the best-fit affine relation $u_{n+1}\\approx a\\,u_n + b$ using ordinary least squares on the retained pairs. Return $a$ as a float.\n\n- Test case $2$ (chaotic regime, correlation of successive intersections):\n  - Parameters: $\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$.\n  - Observable: $u_n=z$ at each upward crossing of $y=0$.\n  - Transient discard: $N_{\\mathrm{skip}}=100$ intersections.\n  - Output: compute the Pearson correlation coefficient $r$ between $u_n$ and $u_{n+1}$ over the retained pairs. Return $r$ as a float.\n\n- Test case $3$ (short integration, data sufficiency check):\n  - Parameters: $\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=2$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$.\n  - Observable: $u_n=x$ at each upward crossing of $y=0$.\n  - Transient discard: $N_{\\mathrm{skip}}=0$ intersections.\n  - Output: return a boolean indicating whether the number of available return-map pairs is greater than or equal to $5$.\n\n- Test case $4$ (restricted lobe, slope estimate with filter):\n  - Parameters: $\\sigma=10$, $\\rho=28$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$.\n  - Observable: $u_n=x$ at each upward crossing of $y=0$, but only retain intersections for which $x0$ (to restrict to one lobe of the attractor).\n  - Transient discard: $N_{\\mathrm{skip}}=100$ intersections.\n  - Output: estimate the slope $a$ of the best-fit affine relation $u_{n+1}\\approx a\\,u_n + b$ using ordinary least squares on the retained pairs. Return $a$ as a float.\n\n- Test case $5$ (non-chaotic regime, count pairs):\n  - Parameters: $\\sigma=10$, $\\rho=20$, $\\beta=8/3$, $T=50$, $\\Delta t=10^{-3}$, $(x_0,y_0,z_0)=(1,1,1)$.\n  - Observable: $u_n=x$ at each upward crossing of $y=0$.\n  - Transient discard: $N_{\\mathrm{skip}}=0$ intersections.\n  - Output: return the integer number of available return-map pairs computed over the entire simulation.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $5$; for example, $[a_1,r_2,b_3,a_4,n_5]$, where $a_1$ and $a_4$ are floats, $r_2$ is a float, $b_3$ is a boolean, and $n_5$ is an integer. No additional text should be printed.",
            "solution": "The problem requires the numerical analysis of the Lorenz system, a canonical example of a three-dimensional autonomous dynamical system exhibiting chaotic behavior. The analysis is to be performed by constructing a one-dimensional Poincaré return map from a simulated trajectory. The solution involves numerical integration, detection of intersections with a Poincaré section, and statistical analysis of the resulting sequence of intersections.\n\nThe state of the system is given by the vector $\\mathbf{x}(t) = (x(t), y(t), z(t))^{\\mathsf{T}} \\in \\mathbb{R}^3$. Its evolution is governed by the Lorenz equations:\n$$\n\\begin{aligned}\n\\dot{x} = \\sigma (y - x) \\\\\n\\dot{y} = x (\\rho - z) - y \\\\\n\\dot{z} = x y - \\beta z\n\\end{aligned}\n$$\nwhere $\\sigma$, $\\rho$, and $\\beta$ are positive real parameters.\n\nThe core of the solution is to generate a discrete-time trajectory of the system by numerically integrating these ordinary differential equations (ODEs). A standard and robust choice for a fixed-step numerical method, as specified, is the fourth-order Runge-Kutta (RK4) method. Given a state $\\mathbf{x}_i$ at time $t_i$, the state $\\mathbf{x}_{i+1}$ at time $t_{i+1} = t_i + \\Delta t$ is computed as follows:\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\Delta t \\cdot f(\\mathbf{x}_i, t_i) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot f(\\mathbf{x}_i + \\frac{1}{2}\\mathbf{k}_1, t_i + \\frac{1}{2}\\Delta t) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot f(\\mathbf{x}_i + \\frac{1}{2}\\mathbf{k}_2, t_i + \\frac{1}{2}\\Delta t) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot f(\\mathbf{x}_i + \\mathbf{k}_3, t_i + \\Delta t) \\\\\n\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\nwhere $f(\\mathbf{x}, t)$ represents the right-hand side of the Lorenz equations. This process is repeated for a total simulation time $T$.\n\nThe Poincaré section is defined as the plane $S = \\{ (x, y, z) \\in \\mathbb{R}^3 \\mid y = 0 \\}$. We are interested in trajectories that cross this section in the \"upward\" direction, meaning from a state with $y  0$ to a state with $y \\ge 0$. At each integration step from time $t_i$ to $t_{i+1}$, we check the sign of the $y$-coordinate. A crossing is detected if $y(t_i)  0$ and $y(t_{i+1}) \\ge 0$.\n\nWhen a crossing is detected between states $\\mathbf{x}_i$ and $\\mathbf{x}_{i+1}$, the intersection point $\\mathbf{x}^*$ on the plane $y=0$ is approximated using linear interpolation. The fractional time step $s \\in [0, 1)$ at which the trajectory intersects the plane is found by solving $y(t_i) + s(y(t_{i+1}) - y(t_i)) = 0$ for $s$:\n$$\ns = \\frac{-y(t_i)}{y(t_{i+1}) - y(t_i)}\n$$\nThe intersection point is then approximated as:\n$$\n\\mathbf{x}^* = \\mathbf{x}_i + s (\\mathbf{x}_{i+1} - \\mathbf{x}_i)\n$$\nBy construction, the $y$-coordinate of $\\mathbf{x}^*$ is $0$.\n\nThis procedure yields a time-ordered sequence of intersection points $\\{\\mathbf{x}^*_1, \\mathbf{x}^*_2, \\dots, \\mathbf{x}^*_M\\}$. For each test case, a scalar observable $u_n$ is defined as either the $x$-coordinate or the $z$-coordinate of the $n$-th intersection point $\\mathbf{x}^*_n$. This creates a sequence $\\{u_1, u_2, \\dots, u_M\\}$.\n\nAn empirical return map is constructed by forming pairs of successive observations, $(u_n, u_{n+1})$. Before analysis, an initial number of intersections, $N_{\\mathrm{skip}}$, may be discarded to remove transient dynamics, resulting in a new sequence starting from $u_{N_{\\mathrm{skip}}+1}$.\n\nThe specific statistic for each test case is then computed from the remaining pairs $(u_n, u_{n+1})$:\n- **Slope of Affine Fit (Cases 1  4):** For the pairs $(u_n, u_{n+1})$, which we can denote as $(x_i, y_i)$, the slope $a$ of the best-fit line $y \\approx ax+b$ is estimated using ordinary least squares. The formula for the slope is:\n$$\na = \\frac{\\text{cov}(u_n, u_{n+1})}{\\text{var}(u_n)} = \\frac{\\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2}\n$$\nwhere $N$ is the number of pairs, and $\\bar{x}, \\bar{y}$ are the sample means. If the variance of $u_n$ is zero, the slope is undefined, and a value of $0.0$ is returned as per the problem specification.\n\n- **Pearson Correlation Coefficient (Case 2):** The Pearson correlation coefficient $r$ between the sequences $\\{u_n\\}$ and $\\{u_{n+1}\\}$ is computed. It is defined as:\n$$\nr = \\frac{\\text{cov}(u_n, u_{n+1})}{\\sigma_{u_n} \\sigma_{u_{n+1}}}\n$$\nwhere $\\sigma$ denotes the standard deviation. If either sequence has zero variance, $r$ is undefined, and $0.0$ is returned.\n\n- **Data Sufficiency (Cases 3  5):** These cases involve counting the number of valid return-map pairs $(u_n, u_{n+1})$ obtained after applying any specified filters and transient-discard rules. For Case 3, a boolean is returned indicating if this count is at least $5$. For Case 5, the integer-valued count itself is returned.\n\nSpecial handling is implemented for each test case, such as filtering the intersections for $x0$ in Case 4. The entire process is encapsulated in a program that iterates through the specified test cases, performs the simulation and analysis for each, and reports the results in the required format. If at any stage the number of data points is insufficient to form the required number of pairs (e.g., fewer than two pairs for slope/correlation calculation), the specified default values are returned.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n\n    test_cases = [\n        {\n            'case_id': 1, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 100,\n            'output_type': 'float'\n        },\n        {\n            'case_id': 2, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'z', 'N_skip': 100,\n            'output_type': 'float'\n        },\n        {\n            'case_id': 3, 'params': (10.0, 28.0, 8.0/3.0), 'T': 2.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 0,\n            'output_type': 'bool'\n        },\n        {\n            'case_id': 4, 'params': (10.0, 28.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 100,\n            'output_type': 'float_filtered'\n        },\n        {\n            'case_id': 5, 'params': (10.0, 20.0, 8.0/3.0), 'T': 50.0, 'dt': 1e-3,\n            'ic': (1.0, 1.0, 1.0), 'observable': 'x', 'N_skip': 0,\n            'output_type': 'int'\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_and_analysis(case)\n        results.append(result)\n    \n    # Format boolean 'True' - 'True' as per standard str() behavior.\n    # If 'true' is required, str(r).lower() would be used.\n    # The problem description is ambiguous; standard str() is the most direct interpretation.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef lorenz_deriv(state, sigma, rho, beta):\n    \"\"\"Computes the derivative of the Lorenz system.\"\"\"\n    x, y, z = state\n    dx_dt = sigma * (y - x)\n    dy_dt = x * (rho - z) - y\n    dz_dt = x * y - beta * z\n    return np.array([dx_dt, dy_dt, dz_dt], dtype=np.float64)\n\ndef run_simulation_and_analysis(case_params):\n    \"\"\"\n    Runs the simulation for a single test case and computes the required statistic.\n    \"\"\"\n    sigma, rho, beta = case_params['params']\n    T, dt = case_params['T'], case_params['dt']\n    x0, y0, z0 = case_params['ic']\n    observable_name = case_params['observable']\n    N_skip = case_params['N_skip']\n    case_id = case_params['case_id']\n    output_type = case_params['output_type']\n\n    # --- Simulation Phase ---\n    state = np.array([x0, y0, z0], dtype=np.float64)\n    num_steps = int(round(T / dt))\n    \n    intersections = []\n    \n    for _ in range(num_steps):\n        state_prev = state\n        y_prev = state[1]\n\n        # 4th-order Runge-Kutta integration step\n        k1 = dt * lorenz_deriv(state, sigma, rho, beta)\n        k2 = dt * lorenz_deriv(state + 0.5 * k1, sigma, rho, beta)\n        k3 = dt * lorenz_deriv(state + 0.5 * k2, sigma, rho, beta)\n        k4 = dt * lorenz_deriv(state + k3, sigma, rho, beta)\n        state = state + (k1 + 2*k2 + 2*k3 + k4) / 6.0\n        y_next = state[1]\n\n        # Upward crossing detection (y0 to y=0)\n        if y_prev  0.0 and y_next = 0.0:\n            if y_next == y_prev:\n                s = 1.0\n            else:\n                s = -y_prev / (y_next - y_prev)\n            \n            interp_state = state_prev + s * (state - state_prev)\n            intersections.append(interp_state)\n\n    # --- Analysis Phase ---\n    \n    # Special filter for Case 4\n    if output_type == 'float_filtered':\n        intersections = [p for p in intersections if p[0]  0.0]\n\n    # Create observable sequence\n    obs_idx = 0 if observable_name == 'x' else 2\n    u_full = np.array([p[obs_idx] for p in intersections])\n\n    # Discard transients\n    if len(u_full) = N_skip:\n        u = np.array([])\n    else:\n        u = u_full[N_skip:]\n    \n    num_pairs = len(u) - 1 if len(u)  0 else 0\n\n    # Case-specific return values\n    if output_type == 'bool':\n        return num_pairs = 5\n\n    if output_type == 'int':\n        return num_pairs\n    \n    # For float outputs (slope, correlation)\n    if num_pairs  2:\n        return 0.0\n\n    u_n = u[:-1]\n    u_n_plus_1 = u[1:]\n\n    if output_type in ['float', 'float_filtered']: # Slope calculation\n        var_un = np.var(u_n)\n        if var_un == 0.0:\n            return 0.0\n        \n        # OLS slope a = cov(x,y)/var(x)\n        cov_val = np.cov(u_n, u_n_plus_1, ddof=0)[0, 1]\n        slope = cov_val / var_un\n        return slope\n\n    # This part of the code is for case_id 2 (correlation)\n    # np.corrcoef returns a 2x2 matrix; the correlation is at [0,1]\n    corr = np.corrcoef(u_n, u_n_plus_1)[0, 1]\n    \n    # Return 0.0 if statistic is undefined (e.g., zero variance)\n    return 0.0 if np.isnan(corr) else corr\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}