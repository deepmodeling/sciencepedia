{
    "hands_on_practices": [
        {
            "introduction": "经典的投票者模型预测系统最终会达成共识，但在现实世界中，观点往往保持多样性。此练习通过引入“噪声”（即自发的观点翻转）来探讨这种持续的观点并存现象。你将学习如何运用福克-普朗克方程，将离散的随机过程近似为连续过程，从而分析模仿与随机性之间的竞争，并推导出系统的稳态宏观性质。",
            "id": "4129398",
            "problem": "考虑一个由$N$个个体组成的充分混合群体，每个个体持有一个二元观点$s_i(t) \\in \\{-1,+1\\}$。该群体在每个个体处独立的泊松时钟驱动下，遵循以下连续时间动力学演化：\n- 以速率$\\lambda$模仿：当一个个体的模仿时钟敲响时，它会随机均匀地选择另一个个体，并复制其观点。\n- 以速率$\\eta$自发翻转：当一个个体的自发时钟敲响时，它会将其观点从$+1$翻转到$-1$，或从$-1$翻转到$+1$。\n\n令磁化强度为 $m(t) = \\frac{1}{N} \\sum_{i=1}^{N} s_i(t)$，并令 $k(t)$ 表示处于状态 $+1$ 的个体数量，因此 $m(t) = \\frac{2k(t)}{N} - 1$。从$k(t)$的马尔可夫生灭过程的基本定义出发，使用大$N$（全连接网络）的平均场极限，通过Kramers–Moyal展开推导$m(t)$的有效漂移和扩散，得到相关的Fokker-Planck方程（FPE），并推断出稳态平均磁化强度及其方差（到$1/N$的主导阶）。你的推导应从微观跃迁速率开始，通过粗粒化过程得到一个在$m=0$邻域内有效的介观描述。\n\n将你的最终答案以单行矩阵的形式给出，其中第一个元素是稳态平均磁化强度 $\\langle m \\rangle_{\\mathrm{ss}}$，第二个元素是稳态方差 $\\mathrm{Var}_{\\mathrm{ss}}(m)$，两者都用$N$、$\\lambda$和$\\eta$的符号表示。",
            "solution": "该问题要求推导在一个经历模仿和自发观点翻转的个体群体中，磁化强度的稳态平均值和方差。推导将从微观动力学出发，通过系统大小展开，得到宏观的Fokker-Planck方程（FPE）。\n\n首先，我们验证问题陈述的有效性。\n该问题提供了观点动力学随机过程的完整描述。\n**已知条件：**\n- 群体大小：$N$个个体。\n- 个体状态：$s_i(t) \\in \\{-1,+1\\}$。\n- 模仿速率：$\\lambda$。\n- 自发翻转速率：$\\eta$。\n- 磁化强度：$m(t) = \\frac{1}{N} \\sum_{i=1}^{N} s_i(t)$。\n- 处于状态$+1$的个体数量：$k(t)$。\n- 关系式：$m(t) = \\frac{2k(t)}{N} - 1$。\n- 拓扑结构：充分混合群体（平均场）。\n- 极限：大$N$。\n\n**验证：**\n该问题具有科学依据，描述了统计物理和复杂系统中的一个标准模型（投票者模型的一个变体）。这是一个良定问题，所有必要的参数和动力学都已定义，对于非零速率，它会导向一个唯一的统计稳态。语言客观且正式。该问题是自洽的，不违反任何物理或数学原理。\n**结论：** 该问题有效。我们继续进行求解。\n\n令$k$为观点为$s_i=+1$的个体数量。则观点为$s_i=-1$的个体数量为$N-k$。系统状态完全由整数$k \\in \\{0, 1, ..., N\\}$描述。这定义了一个关于$k$的连续时间马尔可夫生灭过程。我们需要找到跃迁速率$T^+(k) = T(k \\to k+1)$和$T^-(k) = T(k \\to k-1)$。\n\n当一个观点为$-1$的个体翻转到$+1$时，发生$k \\to k+1$的跃迁。这可以通过两种方式发生：\n1.  **自发翻转**：一个观点为$-1$的个体自发翻转到$+1$。有$N-k$个这样的个体，每个个体以速率$\\eta$翻转。总速率为$(N-k)\\eta$。\n2.  **模仿**：一个观点为$-1$的个体模仿一个观点为$+1$的个体。有$N-k$个观点为$-1$的个体。每个个体以速率$\\lambda$尝试模仿。在模仿时，一个个体从其他$N-1$个个体中随机均匀地选择一个个体。选择到观点为$+1$的个体的概率是$\\frac{k}{N-1}$。因此，这个过程的总速率是$(N-k)\\lambda \\frac{k}{N-1}$。\n\n$k \\to k+1$的总跃迁速率为：\n$$T^+(k) = (N-k)\\eta + \\lambda \\frac{k(N-k)}{N-1}$$\n\n当一个观点为$+1$的个体翻转到$-1$时，发生$k \\to k-1$的跃迁。类似地，这可以通过两种方式发生：\n1.  **自发翻转**：一个观点为$+1$的个体自发翻转到$-1$。有$k$个这样的个体，所以总速率是$k\\eta$。\n2.  **模仿**：一个观点为$+1$的个体模仿一个观点为$-1$的个体。这个过程的总速率是$k\\lambda \\frac{N-k}{N-1}$。\n\n$k \\to k-1$的总跃迁速率为：\n$$T^-(k) = k\\eta + \\lambda \\frac{k(N-k)}{N-1}$$\n\n概率$P(k,t)$的演化由主方程决定：\n$$\\frac{d P(k,t)}{dt} = T^+(k-1)P(k-1,t) + T^-(k+1)P(k+1,t) - [T^+(k) + T^-(k)]P(k,t)$$\n\n为了推导磁化强度$m$的Fokker-Planck方程，我们进行Kramers-Moyal展开。我们将离散变量$k$与连续变量$m$关联起来：\n$$m = \\frac{2k}{N} - 1 \\implies k = \\frac{N(m+1)}{2}$$\n$\\Delta k = \\pm 1$的变化对应于$\\Delta m = \\pm \\frac{2}{N}$的变化。概率密度$P(m,t)$的FPE由下式给出：\n$$\\frac{\\partial P(m,t)}{\\partial t} = -\\frac{\\partial}{\\partial m}[A(m)P(m,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial m^2}[B(m)P(m,t)]$$\n其中$A(m)$是漂移系数，$B(m)$是扩散系数。它们被定义为跳跃过程的一阶矩和二阶矩：\n$$A(m) = \\lim_{\\Delta t \\to 0} \\frac{\\langle \\Delta m \\rangle}{\\Delta t}, \\quad B(m) = \\lim_{\\Delta t \\to 0} \\frac{\\langle (\\Delta m)^2 \\rangle}{\\Delta t}$$\n跳跃矩由跃迁速率计算得出：\n$$\\langle \\Delta m \\rangle = \\left(+\\frac{2}{N}\\right) T^+(k)\\Delta t + \\left(-\\frac{2}{N}\\right) T^-(k)\\Delta t = \\frac{2}{N}[T^+(k) - T^-(k)]\\Delta t$$\n$$\\langle (\\Delta m)^2 \\rangle = \\left(+\\frac{2}{N}\\right)^2 T^+(k)\\Delta t + \\left(-\\frac{2}{N}\\right)^2 T^-(k)\\Delta t = \\frac{4}{N^2}[T^+(k) + T^-(k)]\\Delta t$$\n所以系数为：\n$$A(m) = \\frac{2}{N}[T^+(k) - T^-(k)]$$\n$$B(m) = \\frac{4}{N^2}[T^+(k) + T^-(k)]$$\n让我们计算$T^+ - T^-$和$T^+ + T^-$：\n$$T^+(k) - T^-(k) = \\left((N-k)\\eta + \\lambda \\frac{k(N-k)}{N-1}\\right) - \\left(k\\eta + \\lambda \\frac{k(N-k)}{N-1}\\right) = (N-2k)\\eta$$\n使用$N-2k = N(1 - 2k/N) = -Nm$，我们得到：\n$$T^+(k) - T^-(k) = -Nm\\eta$$\n漂移系数为：\n$$A(m) = \\frac{2}{N}(-Nm\\eta) = -2m\\eta$$\n接下来，我们计算速率之和：\n$$T^+(k) + T^-(k) = (N-k)\\eta + k\\eta + 2\\lambda \\frac{k(N-k)}{N-1} = N\\eta + 2\\lambda \\frac{k(N-k)}{N-1}$$\n我们用$m$来表示$k(N-k)$：\n$$k(N-k) = \\frac{N(m+1)}{2} \\left(N - \\frac{N(m+1)}{2}\\right) = \\frac{N(m+1)}{2} \\frac{N(1-m)}{2} = \\frac{N^2}{4}(1-m^2)$$\n所以，速率之和为：\n$$T^+(k) + T^-(k) = N\\eta + 2\\lambda \\frac{N^2(1-m^2)}{4(N-1)} = N\\eta + \\frac{\\lambda N^2}{2(N-1)}(1-m^2)$$\n扩散系数为：\n$$B(m) = \\frac{4}{N^2}\\left[N\\eta + \\frac{\\lambda N^2}{2(N-1)}(1-m^2)\\right] = \\frac{4\\eta}{N} + \\frac{2\\lambda N}{N(N-1)}(1-m^2) = \\frac{4\\eta}{N} + \\frac{2\\lambda}{N-1}(1-m^2)$$\n对于大$N$，我们可以近似$N-1 \\approx N$，这是$1/N$的主导阶近似：\n$$B(m) \\approx \\frac{4\\eta}{N} + \\frac{2\\lambda}{N}(1-m^2) = \\frac{2}{N}[\\lambda+2\\eta - \\lambda m^2]$$\n问题指明分析应在“$m=0$的邻域内”有效。这表明围绕$m=0$的涨落很小，因此扩散系数中的$m^2$项可以作为高阶修正被忽略。方差将为$O(1/N)$，所以这个近似是自洽的。我们在$B(m)$中令$m=0$：\n$$B(m) \\approx B(0) = \\frac{2(\\lambda+2\\eta)}{N}$$\n得到的FPE描述了$m$的一个Ornstein-Uhlenbeck过程：\n$$\\frac{\\partial P(m,t)}{\\partial t} = \\frac{\\partial}{\\partial m}[2m\\eta P(m,t)] + \\frac{\\lambda+2\\eta}{N} \\frac{\\partial^2 P(m,t)}{\\partial m^2}$$\n为了找到稳态分布$P_{\\mathrm{ss}}(m)$，我们令$\\frac{\\partial P}{\\partial t} = 0$：\n$$\\frac{\\partial}{\\partial m}\\left[2m\\eta P_{\\mathrm{ss}}(m) + \\frac{\\lambda+2\\eta}{N} \\frac{\\partial P_{\\mathrm{ss}}(m)}{\\partial m}\\right] = 0$$\n这意味着括号中的项是常数，该项是概率流的负值。对于具有反射边界或自然边界的可归一化分布，此常数必须为零。\n$$2m\\eta P_{\\mathrm{ss}}(m) + \\frac{\\lambda+2\\eta}{N} \\frac{d P_{\\mathrm{ss}}(m)}{d m} = 0$$\n$$\\frac{d P_{\\mathrm{ss}}}{P_{\\mathrm{ss}}} = -\\frac{2N\\eta}{\\lambda+2\\eta} m \\, dm$$\n对两边积分，我们得到：\n$$\\ln P_{\\mathrm{ss}}(m) = -\\frac{N\\eta}{\\lambda+2\\eta} m^2 + \\text{常数}$$\n这对应于一个高斯分布：\n$$P_{\\mathrm{ss}}(m) = \\mathcal{N} \\exp\\left(-\\frac{N\\eta}{\\lambda+2\\eta} m^2\\right)$$\n其中$\\mathcal{N}$是归一化常数。形式为$\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$的高斯分布的均值为$\\mu$，方差为$\\sigma^2$。通过比较，我们可以确定稳态均值和方差。\n由于分布关于$m=0$对称，均值显然为零：\n$$\\langle m \\rangle_{\\mathrm{ss}} = 0$$\n方差$\\mathrm{Var}_{\\mathrm{ss}}(m) = \\langle m^2 \\rangle_{\\mathrm{ss}} = \\sigma^2$可以通过设定以下等式求得：\n$$\\frac{1}{2\\sigma^2} = \\frac{N\\eta}{\\lambda+2\\eta}$$\n$$\\sigma^2 = \\frac{\\lambda+2\\eta}{2N\\eta}$$\n因此，到$1/N$的主导阶，稳态方差为：\n$$\\mathrm{Var}_{\\mathrm{ss}}(m) = \\frac{\\lambda+2\\eta}{2N\\eta}$$\n最终答案是磁化强度的稳态均值和方差。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{\\lambda + 2\\eta}{2N\\eta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在社会系统中，不仅我们的观点会改变，我们的社交网络也会随之演变。此练习探讨了一种自适应投票者模型，其中网络结构与观点动态地共同演化。你将通过对偶近似（pair approximation）进行一次平均场分析，以确定一个临界点，在该点，网络会因趋同性而分裂成意见一致但彼此隔离的社群，这揭示了简单的自适应规则如何导致社会隔离等复杂的涌现现象。",
            "id": "4311561",
            "problem": "考虑一个具有 $N$ 个节点和平均度为 $k$ 的无向、简单、连通随机网络上的自适应投票者模型 (AVM)。每个节点持有两种观点之一，记为 $A$ 和 $B$。在每次基本更新中，一条连接持相反观点节点的边（称为活跃边）被均匀随机地选中。以概率 $φ \\in [0,1]$，发生一次重连事件：被选中的边的某个端点将这条边重连到一个与其自身观点相同的均匀随机节点上，同时保持度序列不变并避免自环和重边。以概率 $1-φ$，发生一次采纳事件：被选中的边的某个端点采纳另一个端点的观点。设 $M = Nk/2$ 为边的总数， $m$ 为活跃边的数量。定义活跃边密度 $ρ = m/M$。\n\n从模型定义出发，并假设随机混合以及不存在超出对密度的度—观点相关性（即对近似），推导在 AVM 动力学下 $ρ$ 预期演化的封闭平均场速率方程。对该速率方程进行线性稳定性和不动点分析，以确定临界重连概率 $φ_c(k)$。在此概率下，系统从一个具有非零稳态活跃边密度的区域，过渡到一个唯一稳定稳态为 $ρ = 0$（即碎裂成观点同质的组分）的区域。将 $φ_c(k)$ 显式地表示为 $k$ 和常数的函数，并由对近似（pair approximation）给出合理解释。\n\n你的程序必须实现推导出的 $φ_c(k)$ 表达式，并对以下平均度值的测试集进行求值：\n- $k = 2$ （最小连通性的边界情况），\n- $k = 3$ （低连通性），\n- $k = 4$ （中等连通性），\n- $k = 10$ （高连通性），\n- $k = 100$ （渐近区域指示）。\n\n你的程序应生成单行输出，其中包含一个逗号分隔的浮点数列表形式的结果，四舍五入到小数点后 $10$ 位，并用方括号括起来（例如，$[0.1234567890,0.2345678901]$）。输出必须遵循这种确切格式，并按上面列出的顺序包含针对给定测试集的 $φ_c(k)$ 计算值。不涉及物理单位；所有量均为无量纲。最终答案必须以小数形式给出，而不是分数。",
            "solution": "自适应投票者模型 (AVM) 包含两种类型的更新，应用于连接持相反观点节点的边。设 $N$ 为节点数， $k$ 为平均度， $M = Nk/2$ 为边的总数。定义活跃边 $m$ 为连接相反观点的边，活跃边密度 $ρ = m/M$。\n\n我们的目标是使用对近似（pair approximation）推导 $ρ$ 的平均场速率方程。此推导的基础是 AVM 更新规则的定义和随机混合的假设，该假设允许通过对密度来近似高阶邻域统计量，从而在对的层面上实现封闭。\n\n我们首先考虑一个单一的基本事件，即从所有活跃边中均匀选择一条。存在两种互斥的结果：\n\n- 以概率 $φ$ 进行重连，\n- 以概率 $1 - φ$ 进行采纳。\n\n我们计算在每种结果下活跃边数 $m$ 的期望变化，然后通过除以 $M$ 进行归一化和重标定时间，将其转换为密度 $ρ$ 的期望变化。由于稳定性和阈值在线性时间重标定下是不变的，我们关注速率方程的符号和不动点，而不是其绝对速率。\n\n重连步骤 ($φ$)：当一条活跃边被重连时，该边会从活跃边集合中移除，并被一条连接相同观点节点的边所取代。在对近似和随机混合的假设下，重连的边变为非活跃的（连接相同观点），并且重连选择不会创建新的活跃边。因此，活跃边数量的变化为\n$$\n\\Delta m_{\\text{rewire}} = -1\n$$\n\n采纳步骤 ($1-φ$)：我们分析当被选中的活跃边的某个端点采纳另一个端点的观点时，活跃边数量的期望变化。考虑一条活跃边 $(i,j)$，其中节点 $i$ 持有观点 $A$，节点 $j$ 持有观点 $B$。不失一般性，假设 $i$ 采纳了观点 $B$。活跃边数量的净变化取决于节点 $i$ 在观点翻转前后与其相邻的活跃边数量之差。\n\n设 $b$ 为观点翻转前节点 $i$ 的邻居中持有观点 $B$ 的数量， $a$ 为持有观点 $A$ 的数量。那么节点 $i$ 的度为 $a + b = k$。在随机混合假设下，并以选定的活跃边 $(i,j)$ 存在为条件，我们推断：\n- 一个邻居是 $j$，持有观点 $B$。\n- 另外 $k-1$ 个邻居是独立的，在对近似中，每个邻居持有观点 $B$ 的概率为 $ρ$，持有观点 $A$ 的概率为 $1-ρ$。\n\n因此，翻转前 $B$ 观点邻居的期望数量为\n$$\n\\mathbb{E}[b] = 1 + (k - 1) ρ,\n$$\n翻转前 $A$ 观点邻居的期望数量为\n$$\n\\mathbb{E}[a] = (k - 1)(1 - ρ).\n$$\n在 $i$ 翻转为观点 $B$ 后，与 $i$ 相邻的活跃边恰好是那些连接到持有观点 $A$ 的邻居的边，其数量由 $\\mathbb{E}[a]$ 给出。在翻转前，与 $i$ 相邻的活跃边是那些连接到持有观点 $B$ 的邻居的边，其数量由 $\\mathbb{E}[b]$ 给出。因此，由于单次采纳事件导致的活跃边数量的期望变化为\n$$\n\\Delta m_{\\text{adopt}} = \\mathbb{E}[a] - \\mathbb{E}[b]\n= (k - 1)(1 - ρ) - \\left[ 1 + (k - 1) ρ \\right]\n= (k - 1)(1 - 2ρ) - 1.\n$$\n\n结合重连和采纳的结果，每次基本事件中 $m$ 的期望变化为\n$$\n\\Delta m = φ \\cdot (-1) + (1 - φ) \\cdot \\left[ (k - 1)(1 - 2ρ) - 1 \\right].\n$$\n重标定时间以吸收常数因子 $M$，并直接对密度 $ρ$ 进行操作，我们得到平均场速率方程\n$$\n\\frac{dρ}{dτ} = -φ + (1 - φ) \\left[ (k - 1)(1 - 2ρ) - 1 \\right],\n$$\n其中 $τ$ 是与基本事件数量成正比的重标定时间变量。\n\n展开右侧以分离 $ρ$ 的常数项和线性项，\n$$\n\\frac{dρ}{dτ} = \\underbrace{\\left[ (k - 2) - φ (k - 1) \\right]}_{\\text{常数项}}\n\\;-\\; \\underbrace{2 (1 - φ) (k - 1)}_{\\text{线性系数}} \\; ρ.\n$$\n\n不动点与稳定性：不动点满足\n$$\n\\left[ (k - 2) - φ (k - 1) \\right] - 2 (1 - φ) (k - 1) ρ^* = 0,\n$$\n所以\n$$\nρ^* = \\frac{(k - 2) - φ (k - 1)}{2 (1 - φ) (k - 1)}.\n$$\n碎裂阈值出现在内部不动点 $ρ^*$ 与 $ρ = 0$ 相撞时，这标志着非零活跃边密度的消失。这恰好发生在分子为零时：\n$$\n(k - 2) - φ_c (k - 1) = 0.\n$$\n求解 $φ_c$ 可得\n$$\nφ_c(k) = \\frac{k - 2}{k - 1}.\n$$\n\n解释：当 $φ  φ_c(k)$ 时，速率方程中的常数项为正，这意味着存在一个远离 $ρ = 0$ 的正向漂移和一个稳定的内部不动点 $ρ^*  0$，代表持续的观点间相互作用（无碎裂）。当 $φ  φ_c(k)$ 时，常数项为负，唯一稳定的不动点是 $ρ = 0$，对应于碎裂成无活跃边的观点同质组分。\n\n程序规范：程序应实现推导出的表达式 $φ_c(k) = \\frac{k - 2}{k - 1}$，并针对测试集中的值 $k = 2$、$k = 3$、$k = 4$、$k = 10$ 和 $k = 100$ 进行计算。输出是无量纲的，必须表示为小数，并以方括号括起来的单个逗号分隔列表的形式打印，每个值四舍五入到小数点后 $10$ 位，并完全按照测试集的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef phi_c(k: int) - float:\n    \"\"\"\n    Critical rewiring probability phi_c(k) under the pair approximation\n    for the two-state adaptive voter model on a random network\n    with mean degree k: phi_c = (k - 2) / (k - 1).\n    \"\"\"\n    if k == 1:\n        # Undefined in this approximation; return NaN for completeness.\n        return float('nan')\n    return (k - 2) / (k - 1)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [2, 3, 4, 10, 100]\n\n    results = []\n    for k in test_cases:\n        result = phi_c(k)\n        # Round to 10 decimal places as specified.\n        results.append(f\"{result:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型固然重要，但我们如何将其与真实世界的观测数据联系起来？本练习将引导你解决一个关键的“反问题”：如何从数据中推断模型的内在参数。你将运用随机过程的最大似然估计（Maximum Likelihood Estimation）原理，基于观测到的事件计数和不同观点群体间的相互作用历史来构建似然函数，从而量化观点偏见等现象。这项实践连接了理论与应用，让你掌握用经验数据来校准和检验模型的基本技能。",
            "id": "4311571",
            "problem": "考虑一个有限有向加权网络上的连续时间有偏投票者模型，其节点集为 $\\mathcal{V}$，非负权重为 $\\{w_{ij}\\}_{i,j \\in \\mathcal{V}}$。每个节点持有 $\\{0,1\\}$ 中的一个二元观点。令 $s0$ 为一个偏向观点 $1$ 的偏置参数，令 $\\gamma0$ 为一个设定时间尺度的未知全局相互作用率。其动力学如下：在时间 $t$，对于每个满足 $w_{ij}0$ 的有序对 $(i,j)$，节点 $j$ 根据一个泊松过程更新其状态，方法是复制节点 $i$ 的状态。该泊松过程的瞬时速率为 $\\gamma w_{ij}$ 乘以一个状态依赖因子，当 $\\sigma_{i}(t)=1$ 且 $\\sigma_{j}(t)=0$ 时，该因子等于 $s$；当 $\\sigma_{i}(t)=0$ 且 $\\sigma_{j}(t)=1$ 时，该因子等于 $1$；其他情况下，该因子等于 $0$。此处 $\\sigma_{k}(t)\\in\\{0,1\\}$ 表示节点 $k$ 在时间 $t$ 的状态。记 $H_{01}(t)$ 为在时间 $t$ 时，持有观点 $0$ 的节点对持有观点 $1$ 的邻居的瞬时总加权暴露度，\n$$\nH_{01}(t) \\equiv \\sum_{i,j \\in \\mathcal{V}} \\mathbf{1}\\{\\sigma_{i}(t)=1,\\,\\sigma_{j}(t)=0\\}\\,w_{ij},\n$$\n类似地，$H_{10}(t)$ 为在时间 $t$ 时，持有观点 $1$ 的节点对持有观点 $0$ 的邻居的总加权暴露度，\n$$\nH_{10}(t) \\equiv \\sum_{i,j \\in \\mathcal{V}} \\mathbf{1}\\{\\sigma_{i}(t)=0,\\,\\sigma_{j}(t)=1\\}\\,w_{ij}.\n$$\n在这些规则下，$0\\to 1$ 翻转的计数过程的随机强度为 $\\lambda_{01}(t)=\\gamma s\\,H_{01}(t)$，$1\\to 0$ 翻转的计数过程的随机强度为 $\\lambda_{10}(t)=\\gamma\\,H_{10}(t)$。\n\n您在固定的时间窗口 $[0,T]$（其中 $T0$）内观察系统的一条轨迹，并只记录以下聚合充分统计量：$0\\to 1$ 翻转的总次数 $Y_{01}$，$1\\to 0$ 翻转的总次数 $Y_{10}$，以及时间积分暴露度\n$$\nX_{01}\\equiv \\int_{0}^{T} H_{01}(t)\\,dt,\\qquad X_{10}\\equiv \\int_{0}^{T} H_{10}(t)\\,dt.\n$$\n假设 $X_{01}0$，$X_{10}0$，$Y_{01}0$ 且 $Y_{10}0$，从而参数在参数空间的内部是可识别的。从连续时间马尔可夫动力学和计数过程的随机强度的定义出发，推导偏置参数 $s$ 的最大似然估计量，其中全局速率 $\\gamma$ 被视为未知的讨厌参数。将您的最终结果表示为仅含 $X_{01}$、$X_{10}$、$Y_{01}$ 和 $Y_{10}$ 的闭式解析表达式。不要简化为数值。您的最终答案必须是单个无单位的解析表达式。",
            "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，是适定的、客观的且内部一致的。它提出了一个随机过程统计推断中的标准但非平凡的问题。所有推导最大似然估计量所需的信息均已提供。\n\n任务是找到偏置参数 $s$ 的最大似然估计量 (MLE)，并将全局速率 $\\gamma$ 视为一个讨厌参数。推导从观测数据的似然函数开始。\n\n系统动力学描述了两种类型的事件：$0\\to 1$ 翻转和 $1\\to 0$ 翻转。这些事件由计数过程控制，我们将其表示为 $N_{01}(t)$ 和 $N_{10}(t)$，其随机强度分别为 $\\lambda_{01}(t) = \\gamma s H_{01}(t)$ 和 $\\lambda_{10}(t) = \\gamma H_{10}(t)$。量 $H_{01}(t)$ 和 $H_{10}(t)$ 依赖于系统状态 $\\sigma(t)$，而 $\\sigma(t)$ 本身也是一个随机过程。这种结构被称为双重随机泊松过程或考克斯过程 (Cox process)。\n\n问题陈述我们观察系统在 $[0,T]$ 上的单一轨迹。这意味着，为了构建似然函数，我们可以以观察到的系统状态路径 $\\{\\sigma(u) : u \\in [0,T]\\}$ 为条件。一旦我们以此路径为条件，函数 $H_{01}(t)$ 和 $H_{10}(t)$ 就成为在 $t \\in [0,T]$ 上确定的时间函数。因此，翻转过程表现为两个独立的、具有确定性（但随时间变化）速率函数的非齐次泊松过程。\n\n对于速率函数为 $\\lambda(t)$ 的非齐次泊松过程，在区间 $[0,T]$ 内观察到 $k$ 个事件的概率由均值为 $\\Lambda = \\int_0^T \\lambda(u)du$ 的泊松分布给出。其概率质量函数为 $P(k) = \\frac{\\Lambda^k}{k!} \\exp(-\\Lambda)$。\n\n将此原理应用于我们的两个过程：\n1. $0\\to 1$ 翻转的总次数 $Y_{01}$ 服从均值为 $\\Lambda_{01}$ 的泊松分布。\n$$ \\Lambda_{01} = \\int_{0}^{T} \\lambda_{01}(t) dt = \\int_{0}^{T} \\gamma s H_{01}(t) dt = \\gamma s \\int_{0}^{T} H_{01}(t) dt = \\gamma s X_{01} $$\n2. $1\\to 0$ 翻转的总次数 $Y_{10}$ 服从均值为 $\\Lambda_{10}$ 的泊松分布。\n$$ \\Lambda_{10} = \\int_{0}^{T} \\lambda_{10}(t) dt = \\int_{0}^{T} \\gamma H_{10}(t) dt = \\gamma \\int_{0}^{T} H_{10}(t) dt = \\gamma X_{10} $$\n问题提供了 $Y_{01}$、$Y_{10}$、$X_{01}$ 和 $X_{10}$ 作为观察到的充分统计量。因此，在给定参数 $s$ 和 $\\gamma$ 的情况下，观察到这些数据的似然是两个泊松概率质量函数的乘积。\n\n似然函数 $L(s, \\gamma)$ 为：\n$$ L(s, \\gamma) = P(Y_{01} | s, \\gamma, X_{01}) \\cdot P(Y_{10} | \\gamma, X_{10}) $$\n$$ L(s, \\gamma) = \\frac{(\\gamma s X_{01})^{Y_{01}}}{Y_{01}!} \\exp(-\\gamma s X_{01}) \\cdot \\frac{(\\gamma X_{10})^{Y_{10}}}{Y_{10}!} \\exp(-\\gamma X_{10}) $$\n为了找到 $s$ 和 $\\gamma$ 的最大似然估计量，我们最大化对数似然函数 $\\ell(s, \\gamma) = \\ln L(s, \\gamma)$。\n$$ \\ell(s, \\gamma) = Y_{01} \\ln(\\gamma s X_{01}) - \\gamma s X_{01} + Y_{10} \\ln(\\gamma X_{10}) - \\gamma X_{10} - \\ln(Y_{01}!) - \\ln(Y_{10}!) $$\n展开对数项：\n$$ \\ell(s, \\gamma) = Y_{01}(\\ln \\gamma + \\ln s + \\ln X_{01}) - \\gamma s X_{01} + Y_{10}(\\ln \\gamma + \\ln X_{10}) - \\gamma X_{10} - C $$\n其中 $C = \\ln(Y_{01}!) + \\ln(Y_{10}!)$ 是一个与参数无关的常数。\n我们可以将涉及参数的项分组：\n$$ \\ell(s, \\gamma) = (Y_{01} + Y_{10})\\ln\\gamma + Y_{01}\\ln s - \\gamma(s X_{01} + X_{10}) + C' $$\n其中 $C'$ 包含所有不依赖于 $s$ 或 $\\gamma$ 的项。\n\n为了找到最大化 $\\ell$ 的 $s$ 和 $\\gamma$ 的值，我们计算关于每个参数的偏导数并将其设为零。这为估计量 $\\hat{s}$ 和 $\\hat{\\gamma}$ 提供了一个包含两个方程的方程组。\n\n关于 $s$ 的偏导数：\n$$ \\frac{\\partial \\ell}{\\partial s} = \\frac{Y_{01}}{s} - \\gamma X_{01} = 0 $$\n关于 $\\gamma$ 的偏导数：\n$$ \\frac{\\partial \\ell}{\\partial \\gamma} = \\frac{Y_{01} + Y_{10}}{\\gamma} - (s X_{01} + X_{10}) = 0 $$\n\n设解为 $\\hat{s}$ 和 $\\hat{\\gamma}$。从第一个方程，我们可以用 $\\hat{s}$ 表示 $\\hat{\\gamma}$：\n$$ \\hat{\\gamma} X_{01} = \\frac{Y_{01}}{\\hat{s}} \\implies \\hat{\\gamma} = \\frac{Y_{01}}{\\hat{s} X_{01}} $$\n问题的假设（$Y_{01}0, s0, X_{01}0$）确保了 $\\hat{\\gamma}$ 是良定义且为正的。\n\n现在，将 $\\hat{\\gamma}$ 的这个表达式代入第二个方程：\n$$ \\frac{Y_{01} + Y_{10}}{\\frac{Y_{01}}{\\hat{s} X_{01}}} - (\\hat{s} X_{01} + X_{10}) = 0 $$\n$$ \\frac{\\hat{s} X_{01} (Y_{01} + Y_{10})}{Y_{01}} = \\hat{s} X_{01} + X_{10} $$\n我们现在求解 $\\hat{s}$。\n$$ \\hat{s} X_{01} \\left(1 + \\frac{Y_{10}}{Y_{01}}\\right) = \\hat{s} X_{01} + X_{10} $$\n$$ \\hat{s} X_{01} + \\hat{s} \\frac{X_{01} Y_{10}}{Y_{01}} = \\hat{s} X_{01} + X_{10} $$\n从两边减去项 $\\hat{s} X_{01}$ 得到：\n$$ \\hat{s} \\frac{X_{01} Y_{10}}{Y_{01}} = X_{10} $$\n最后，分离出 $\\hat{s}$ 得到最大似然估计量：\n$$ \\hat{s} = \\frac{X_{10} Y_{01}}{X_{01} Y_{10}} $$\n问题的假设（$X_{01}0, X_{10}0, Y_{01}0, Y_{10}0$）保证了估计量是良定义且为正的，这与参数约束 $s0$ 一致。这个表达式是通过联合最大化得到的，当 $\\gamma$ 是一个讨厌参数时，$s$ 的最大似然估计量。",
            "answer": "$$\\boxed{\\frac{Y_{01} X_{10}}{Y_{10} X_{01}}}$$"
        }
    ]
}