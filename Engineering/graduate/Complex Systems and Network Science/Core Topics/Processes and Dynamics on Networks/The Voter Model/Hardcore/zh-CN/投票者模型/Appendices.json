{
    "hands_on_practices": [
        {
            "introduction": "理论研究通常从最简化的情境开始，以抓住核心动力学。本练习将探讨在平均场近似下的带噪声选民模型，其中个体不仅会模仿他人，还会自发地改变观点。通过这个练习，你将实践如何从微观的个体规则出发，运用克莱默-莫亚尔展开推导出描述系统宏观状态（磁化强度）的福克-普朗克方程，并求解其稳态性质。",
            "id": "4129398",
            "problem": "考虑一个由 $N$ 个智能体组成的充分混合种群，每个智能体的观点为二元观点 $s_i(t) \\in \\{-1,+1\\}$。该种群在以下连续时间动力学下演化，每个智能体都有独立的泊松时钟：\n- 模仿速率为 $\\lambda$：当一个智能体的模仿时钟敲响时，它会从同伴中均匀随机地选择一个个体，并复制该同伴的观点。\n- 自发翻转速率为 $\\eta$：当一个智能体的自发时钟敲响时，它会将其观点从 $+1$ 翻转到 $-1$，或从 $-1$ 翻转到 $+1$。\n\n令磁化强度为 $m(t) = \\frac{1}{N} \\sum_{i=1}^{N} s_i(t)$，并令 $k(t)$ 表示处于状态 $+1$ 的智能体数量，因此 $m(t) = \\frac{2k(t)}{N} - 1$。从 $k(t)$ 的马尔可夫生灭过程的基本定义出发，并使用 $N$ 很大时的平均场极限（全连接网络），通过 Kramers–Moyal 展开推导 $m(t)$ 的有效漂移和扩散，得到相关的福克-普朗克方程（FPE），并推断出稳态平均磁化强度及其方差（到 $1/N$ 的主导阶）。你的推导应从微观转移速率开始，通过粗粒化得到在 $m=0$ 附近有效的中观描述。\n\n请将你的最终答案以单行矩阵的形式给出，其第一个条目是稳态平均磁化强度 $\\langle m \\rangle_{\\mathrm{ss}}$，第二个条目是稳态方差 $\\mathrm{Var}_{\\mathrm{ss}}(m)$，两者都用 $N$、$\\lambda$ 和 $\\eta$ 的符号表示。",
            "solution": "该问题要求推导在一个经历模仿和自发观点翻转的智能体种群中，磁化强度的稳态平均值和方差。推导将从微观动力学出发，通过系统规模展开得到宏观的福克-普朗克方程（FPE）。\n\n首先，我们验证问题陈述的有效性。\n该问题完整地描述了一个观点动力学的随机过程。\n**已知条件：**\n- 种群规模：$N$ 个智能体。\n- 智能体状态：$s_i(t) \\in \\{-1,+1\\}$。\n- 模仿速率：$\\lambda$。\n- 自发翻转速率：$\\eta$。\n- 磁化强度：$m(t) = \\frac{1}{N} \\sum_{i=1}^{N} s_i(t)$。\n- 状态为 $+1$ 的智能体数量：$k(t)$。\n- 关系式：$m(t) = \\frac{2k(t)}{N} - 1$。\n- 拓扑结构：充分混合种群（平均场）。\n- 极限：大 $N$。\n\n**验证：**\n该问题具有科学依据，描述了统计物理和复杂系统中的一个标准模型（投票者模型的一个变体）。问题提法清晰，所有必要的参数和动力学都已定义，对于非零速率，将导出一个唯一的统计稳态。语言客观且正式。问题是自洽的，不违反任何物理或数学原理。\n**结论：** 问题有效。我们继续求解。\n\n令 $k$ 为观点为 $s_i=+1$ 的智能体数量。则观点为 $s_i=-1$ 的智能体数量为 $N-k$。系统状态完全由整数 $k \\in \\{0, 1, ..., N\\}$ 描述。这定义了 $k$ 上的一个连续时间马尔可夫生灭过程。我们需要找到转移速率 $T^+(k) = T(k \\to k+1)$ 和 $T^-(k) = T(k \\to k-1)$。\n\n当一个观点为 $-1$ 的智能体翻转为 $+1$ 时，发生 $k \\to k+1$ 的转移。这可以通过两种方式发生：\n1.  **自发翻转**：一个观点为 $-1$ 的智能体自发翻转为 $+1$。有 $N-k$ 个这样的智能体，每个智能体以速率 $\\eta$ 翻转。总速率为 $(N-k)\\eta$。\n2.  **模仿**：一个观点为 $-1$ 的智能体模仿一个观点为 $+1$ 的智能体。有 $N-k$ 个观点为 $-1$ 的智能体。每个智能体以速率 $\\lambda$ 尝试模仿。模仿时，一个智能体会从其他 $N-1$ 个智能体中均匀随机地选择一个同伴。选择一个观点为 $+1$ 的同伴的概率是 $\\frac{k}{N-1}$。因此，这个过程的总速率是 $(N-k)\\lambda \\frac{k}{N-1}$。\n\n$k \\to k+1$ 的总转移速率为：\n$$T^+(k) = (N-k)\\eta + \\lambda \\frac{k(N-k)}{N-1}$$\n\n当一个观点为 $+1$ 的智能体翻转为 $-1$ 时，发生 $k \\to k-1$ 的转移。类似地，这可以通过两种方式发生：\n1.  **自发翻转**：一个观点为 $+1$ 的智能体自发翻转为 $-1$。有 $k$ 个这样的智能体，所以总速率是 $k\\eta$。\n2.  **模仿**：一个观点为 $+1$ 的智能体模仿一个观点为 $-1$ 的智能体。这个过程的总速率是 $k\\lambda \\frac{N-k}{N-1}$。\n\n$k \\to k-1$ 的总转移速率为：\n$$T^-(k) = k\\eta + \\lambda \\frac{k(N-k)}{N-1}$$\n\n概率 $P(k,t)$ 的演化由主方程决定：\n$$\\frac{d P(k,t)}{dt} = T^+(k-1)P(k-1,t) + T^-(k+1)P(k+1,t) - [T^+(k) + T^-(k)]P(k,t)$$\n\n为了推导磁化强度 $m$ 的福克-普朗克方程，我们进行 Kramers-Moyal 展开。我们将离散变量 $k$ 与连续变量 $m$ 联系起来：\n$m = \\frac{2k}{N} - 1 \\implies k = \\frac{N(m+1)}{2}$\n$\\Delta k = \\pm 1$ 的变化对应于 $\\Delta m = \\pm \\frac{2}{N}$ 的变化。概率密度 $P(m,t)$ 的福克-普朗克方程由下式给出：\n$$\\frac{\\partial P(m,t)}{\\partial t} = -\\frac{\\partial}{\\partial m}[A(m)P(m,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial m^2}[B(m)P(m,t)]$$\n其中 $A(m)$ 是漂移系数，$B(m)$ 是扩散系数。它们被定义为跳跃过程的一阶矩和二阶矩：\n$$A(m) = \\lim_{\\Delta t \\to 0} \\frac{\\langle \\Delta m \\rangle}{\\Delta t}, \\quad B(m) = \\lim_{\\Delta t \\to 0} \\frac{\\langle (\\Delta m)^2 \\rangle}{\\Delta t}$$\n跳跃矩由转移速率计算得出：\n$$\\langle \\Delta m \\rangle = \\left(+\\frac{2}{N}\\right) T^+(k)\\Delta t + \\left(-\\frac{2}{N}\\right) T^-(k)\\Delta t = \\frac{2}{N}[T^+(k) - T^-(k)]\\Delta t$$\n$$\\langle (\\Delta m)^2 \\rangle = \\left(+\\frac{2}{N}\\right)^2 T^+(k)\\Delta t + \\left(-\\frac{2}{N}\\right)^2 T^-(k)\\Delta t = \\frac{4}{N^2}[T^+(k) + T^-(k)]\\Delta t$$\n所以系数为：\n$$A(m) = \\frac{2}{N}[T^+(k) - T^-(k)]$$\n$$B(m) = \\frac{4}{N^2}[T^+(k) + T^-(k)]$$\n我们来计算 $T^+ - T^-$ 和 $T^+ + T^-$：\n$$T^+(k) - T^-(k) = \\left((N-k)\\eta + \\lambda \\frac{k(N-k)}{N-1}\\right) - \\left(k\\eta + \\lambda \\frac{k(N-k)}{N-1}\\right) = (N-2k)\\eta$$\n使用 $N-2k = N(1 - 2k/N) = -Nm$，我们得到：\n$$T^+(k) - T^-(k) = -Nm\\eta$$\n漂移系数为：\n$$A(m) = \\frac{2}{N}(-Nm\\eta) = -2m\\eta$$\n接下来，我们计算速率之和：\n$$T^+(k) + T^-(k) = (N-k)\\eta + k\\eta + 2\\lambda \\frac{k(N-k)}{N-1} = N\\eta + 2\\lambda \\frac{k(N-k)}{N-1}$$\n我们将 $k(N-k)$ 用 $m$ 表示：\n$$k(N-k) = \\frac{N(m+1)}{2} \\left(N - \\frac{N(m+1)}{2}\\right) = \\frac{N(m+1)}{2} \\frac{N(1-m)}{2} = \\frac{N^2}{4}(1-m^2)$$\n所以，速率之和为：\n$$T^+(k) + T^-(k) = N\\eta + 2\\lambda \\frac{N^2(1-m^2)}{4(N-1)} = N\\eta + \\frac{\\lambda N^2}{2(N-1)}(1-m^2)$$\n扩散系数为：\n$$B(m) = \\frac{4}{N^2}\\left[N\\eta + \\frac{\\lambda N^2}{2(N-1)}(1-m^2)\\right] = \\frac{4\\eta}{N} + \\frac{2\\lambda N}{N(N-1)}(1-m^2) = \\frac{4\\eta}{N} + \\frac{2\\lambda}{N-1}(1-m^2)$$\n对于大 $N$，我们可以近似 $N-1 \\approx N$，这是在 $1/N$ 上的主导阶近似：\n$$B(m) \\approx \\frac{4\\eta}{N} + \\frac{2\\lambda}{N}(1-m^2) = \\frac{2}{N}[\\lambda+2\\eta - \\lambda m^2]$$\n问题指明分析应在“$m=0$ 附近”有效。这表明围绕 $m=0$ 的涨落很小，因此扩散系数中的 $m^2$ 项可以作为高阶修正被忽略。方差将为 $O(1/N)$，所以这个近似是自洽的。我们在 $B(m)$ 中令 $m=0$：\n$$B(m) \\approx B(0) = \\frac{2(\\lambda+2\\eta)}{N}$$\n得到的福克-普朗克方程描述了 $m$ 的一个奥恩斯坦-乌伦贝克过程：\n$$\\frac{\\partial P(m,t)}{\\partial t} = \\frac{\\partial}{\\partial m}[2m\\eta P(m,t)] + \\frac{\\lambda+2\\eta}{N} \\frac{\\partial^2 P(m,t)}{\\partial m^2}$$\n为了找到稳态分布 $P_{\\mathrm{ss}}(m)$，我们令 $\\frac{\\partial P}{\\partial t} = 0$：\n$$\\frac{\\partial}{\\partial m}\\left[2m\\eta P_{\\mathrm{ss}}(m) + \\frac{\\lambda+2\\eta}{N} \\frac{\\partial P_{\\mathrm{ss}}(m)}{\\partial m}\\right] = 0$$\n这意味着括号中的项，即概率通量的负值，是一个常数。对于具有反射或自然边界的可归一化分布，此常数必须为零。\n$$2m\\eta P_{\\mathrm{ss}}(m) + \\frac{\\lambda+2\\eta}{N} \\frac{d P_{\\mathrm{ss}}(m)}{d m} = 0$$\n$$\\frac{d P_{\\mathrm{ss}}}{P_{\\mathrm{ss}}} = -\\frac{2N\\eta}{\\lambda+2\\eta} m \\, dm$$\n对两边积分，我们得到：\n$$\\ln P_{\\mathrm{ss}}(m) = -\\frac{N\\eta}{\\lambda+2\\eta} m^2 + \\text{常数}$$\n这对应一个高斯分布：\n$$P_{\\mathrm{ss}}(m) = \\mathcal{N} \\exp\\left(-\\frac{N\\eta}{\\lambda+2\\eta} m^2\\right)$$\n其中 $\\mathcal{N}$ 是一个归一化常数。形式为 $\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$ 的高斯分布的平均值为 $\\mu$，方差为 $\\sigma^2$。通过比较，我们可以确定稳态平均值和方差。\n由于分布在 $m=0$ 周围是对称的，平均值显然为零：\n$$\\langle m \\rangle_{\\mathrm{ss}} = 0$$\n方差 $\\mathrm{Var}_{\\mathrm{ss}}(m) = \\langle m^2 \\rangle_{\\mathrm{ss}} = \\sigma^2$ 可通过令下式成立求得：\n$$\\frac{1}{2\\sigma^2} = \\frac{N\\eta}{\\lambda+2\\eta}$$\n$$\\sigma^2 = \\frac{\\lambda+2\\eta}{2N\\eta}$$\n因此，在 $1/N$ 的主导阶上，稳态方差为：\n$$\\mathrm{Var}_{\\mathrm{ss}}(m) = \\frac{\\lambda+2\\eta}{2N\\eta}$$\n最终答案是磁化强度的稳态平均值和方差。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\lambda + 2\\eta}{2N\\eta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了平均场模型后，下一步是将其扩展到更真实的复杂网络上。本练习将引导你分析个体更新速率如何依赖于网络的度异质性，并推导在通用网络上的选民模型的无穷小生成元。掌握生成元的概念对于精确描述和分析网络上的任何连续时间马尔可夫链过程至关重要。",
            "id": "4129354",
            "problem": "考虑一个由 $N$ 个智能体组成的群体，它们通过一个简单的无向网络连接，其邻接矩阵为 $A \\in \\{0,1\\}^{N \\times N}$，其中 $A_{ij} = A_{ji}$ 且 $A_{ii} = 0$。每个智能体 $i \\in \\{1, \\dots, N\\}$ 持有一个二元观点 $x_i \\in \\{0,1\\}$，因此系统状态为 $x = (x_1, \\dots, x_N) \\in \\{0,1\\}^{N}$。假设在每个满足 $A_{ij} = 1$ 的有序对 $(i,j)$ 上，交互事件作为单位速率的独立泊松过程发生。当 $(i,j)$ 上的事件发生时，智能体 $i$ 立即用智能体 $j$ 的当前观点替换自己的观点。这在状态空间 $\\{0,1\\}^N$ 上定义了一个连续时间马尔可夫链（CTMC）。\n\n从泊松过程的基本原理和 CTMC 生成元的定义出发，完成以下任务：\n\n1. 根据独立泊松过程的叠加性质，论证为什么智能体 $i$ 的总更新速率（表示为 $\\lambda_i$）等于所有作用于 $i$ 的过程的速率之和，并因此通过邻接矩阵 $A$ 依赖于网络的度异质性。\n\n2. 用 $A$ 和更新映射 $x \\mapsto x^{i \\leftarrow j}$ 表示作用于有界函数 $f:\\{0,1\\}^{N} \\to \\mathbb{R}$ 的 CTMC 的无穷小生成元 $L$ 的闭合形式，其中 $x^{i \\leftarrow j}$ 表示通过用 $x_j$ 替换 $x_i$ 并保持所有其他分量不变而从 $x$ 获得的构型。\n\n你的最终答案必须是生成元 $L$ 作用于函数 $f$ 的单个闭合形式解析表达式。不要提供不等式或方程组。无需四舍五入。最终答案不带单位。",
            "solution": "该问题陈述是关于应用于观点动力学标准模型的连续时间马尔可夫链（CTMC）理论的一个有效练习。它具有科学依据，问题提法恰当，客观，并包含了进行严谨推导所需的所有必要信息。\n\n### 第1部分：总更新速率 $\\lambda_i$ 的推导\n\n模型规定，对于每个有序智能体对 $(i,j)$，如果智能体 $j$ 是智能体 $i$ 的邻居（即 $A_{ij}=1$），则存在一个单位速率的独立泊松过程，我们称之为 $\\mathcal{P}_{ij}$。过程 $\\mathcal{P}_{ij}$ 中的一个事件对应于智能体 $i$ 采纳智能体 $j$ 的观点。\n\n我们需要确定特定智能体 $i$ 的总更新速率 $\\lambda_i$。“智能体 $i$ 的更新”发生，指的是智能体 $i$ 是其观点被替换的那个。这对应于对于固定的 $i$ 和任何满足 $A_{ij}=1$ 的 $j$，来自任何过程 $\\mathcal{P}_{ij}$ 的事件的发生。\n\n设智能体 $i$ 的邻居集合为 $\\mathcal{N}_i = \\{j \\in \\{1, \\dots, N\\} \\mid A_{ij}=1\\}$。导致智能体 $i$ 更新其观点的事件是来自泊松过程集合 $\\{\\mathcal{P}_{ij} \\mid j \\in \\mathcal{N}_i\\}$ 的事件。这些过程中的每一个速率都为 $1$。\n\n独立泊松过程的一个基本性质是叠加原理。它指出，如果我们有一组速率分别为 $r_1, r_2, \\dots, r_m$ 的独立泊松过程，它们的叠加（即合并的事件流）也是一个泊松过程，其总速率为 $R = \\sum_{k=1}^m r_k$。\n\n在我们的案例中，对于一个固定的智能体 $i$，该智能体的总更新过程是所有 $j \\in \\mathcal{N}_i$ 的独立泊松过程 $\\mathcal{P}_{ij}$ 的叠加。这些过程中的每一个速率都是 $r_j = 1$。因此，智能体 $i$ 的总更新速率，表示为 $\\lambda_i$，是所有这些作用过程的速率之和：\n$$ \\lambda_i = \\sum_{j \\in \\mathcal{N}_i} 1 $$\n这个和是对 $i$ 的所有邻居求和。我们可以用邻接矩阵 $A$ 来表示它。条件 $j \\in \\mathcal{N}_i$ 等价于 $A_{ij}=1$。过程 $\\mathcal{P}_{ij}$ 的速率可以写成 $1 \\cdot A_{ij}$（即，如果存在边则为 $1$，否则为 $0$）。对所有可能的智能体 $j$ 求和：\n$$ \\lambda_i = \\sum_{j=1}^{N} A_{ij} $$\n这个和 $\\sum_{j=1}^{N} A_{ij}$，根据定义，是网络中节点 $i$ 的度，通常表示为 $k_i$。因此，$\\lambda_i=k_i$。\n\n因此，智能体 $i$ 的更新速率等于其度。度异质性指的是网络中节点度的变化。如果网络不是正则图，那么不同智能体的度 $k_i$ 会有所不同。由于 $\\lambda_i = k_i$，更新速率 $\\lambda_i$ 直接且线性地依赖于智能体的度。具有较高连接性（中心节点）的智能体被更频繁地选择来更新其观点，这表明动力学直接依赖于网络的度异质性。\n\n### 第2部分：无穷小生成元 $L$ 的推导\n\nCTMC 的无穷小生成元 $L$ 描述了状态函数期望值的瞬时变化率。它通过其对任何有界函数 $f: \\{0,1\\}^N \\to \\mathbb{R}$ 的作用来定义，如下所示：\n$$ (Lf)(x) = \\lim_{dt \\to 0^+} \\frac{\\mathbb{E}[f(X(dt)) \\mid X(0)=x] - f(x)}{dt} $$\n这里，$X(t)$ 是系统在时间 $t$ 的状态。在一个微小的时间间隔 $dt$ 内，速率为 $r$ 的特定泊松过程发生一个事件的概率是 $r \\cdot dt + o(dt)$。来自任何独立过程的两个或更多事件发生的概率是 $o(dt)$，在极限情况下可以忽略。\n\n只有当更新事件发生时，系统状态才能从 $x$ 变为新状态 $y$。基本事件是对于每个满足 $A_{ij}=1$ 的有序对 $(i,j)$ 的泊松过程 $\\mathcal{P}_{ij}$。每个过程的速率都为 $1$。\n\n考虑系统在时间 $t=0$ 时的状态为 $x$。在时间间隔 $(0, dt]$ 内，来自过程 $\\mathcal{P}_{ij}$ 的事件发生的概率为 $1 \\cdot dt$。如果该事件发生，系统从状态 $x$ 转移到状态 $x^{i \\leftarrow j}$，该状态通过将智能体 $i$ 的观点设置为智能体 $j$ 的观点来获得，即对于 $k \\neq i$ 有 $(x^{i \\leftarrow j})_k = x_k$ 且 $(x^{i \\leftarrow j})_i = x_j$。\n\n任何事件发生的总速率为 $\\Lambda = \\sum_{i=1}^N \\sum_{j=1}^N A_{ij}$。在 $(0, dt]$ 内没有事件发生的概率为 $1 - \\Lambda \\cdot dt + o(dt)$。\n\n现在我们可以写出 $f(X(dt))$ 的期望值：\n$$ \\mathbb{E}[f(X(dt)) \\mid X(0)=x] = f(x) \\cdot \\mathbb{P}(\\text{no event}) + \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} \\left( f(x^{i \\leftarrow j}) \\cdot \\mathbb{P}(\\text{event on }(i,j)) \\right) + o(dt) $$\n代入概率：\n$$ \\mathbb{E}[f(X(dt)) \\mid X(0)=x] = f(x) \\left(1 - \\sum_{i'=1}^{N} \\sum_{j'=1}^{N} A_{i'j'} dt \\right) + \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} (f(x^{i \\leftarrow j}) \\cdot dt) + o(dt) $$\n注意，我们必须对所有可能的事件求和来计算没有事件发生的概率。\n\n现在，我们计算生成元定义中的分子：\n$$ \\mathbb{E}[f(X(dt)) \\mid X(0)=x] - f(x) = -f(x) \\left(\\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij}\\right) dt + \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} f(x^{i \\leftarrow j}) dt + o(dt) $$\n$$ = \\left( \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} f(x^{i \\leftarrow j}) - \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} f(x) \\right) dt + o(dt) $$\n$$ = \\left( \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} [f(x^{i \\leftarrow j}) - f(x)] \\right) dt + o(dt) $$\n除以 $dt$ 并取极限 $dt \\to 0^+$，得到生成元 $L$ 在状态 $x$ 上对函数 $f$ 的作用：\n$$ (Lf)(x) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} [f(x^{i \\leftarrow j}) - f(x)] $$\n这个表达式是生成元作用的闭合形式。该求和是对网络中存在边的所有有序对 $(i,j)$进行的。对于每个这样的对，一个事件会导致从状态 $x$到 $x^{i \\leftarrow j}$ 的潜在转移，并且相应的项对 $f$ 的期望值的变化率做出贡献。如果 $x_i = x_j$，则 $x^{i \\leftarrow j} = x$，项 $[f(x^{i \\leftarrow j}) - f(x)]$ 为零，这正确地反映了状态没有发生变化。该表达式是通用的，并且对任何状态 $x$ 和任何测试函数 $f$ 都成立。",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{N} \\sum_{j=1}^{N} A_{ij} [f(x^{i \\leftarrow j}) - f(x)]}\n$$"
        },
        {
            "introduction": "在许多现实系统中，社会关系（网络结构）会随着观点的变化而共同演化。本练习将带你进入自适应网络的领域，通过分析一个著名的自适应选民模型来探索这种共同演化，其中意见相左的个体可能会重连他们的社会关系。你将运用对近似（pair approximation）这一平均场技术来推导网络分裂为意见一致的社群的临界条件，并通过编程实现来验证你的理论结果。",
            "id": "4311561",
            "problem": "考虑一个无向、简单、连通的随机网络上的自适应选民模型 (AVM)，该网络有 $N$ 个节点，平均度为 $k$。每个节点持有两种观点之一，记为 $A$ 和 $B$。在每次基本更新中，会从所有连接相反观点节点的边（即活跃边）中均匀随机地选择一条。以概率 $\\phi \\in [0,1]$ 发生重连事件：所选边的一个端点将该边重连接到一个与其观点相同的均匀随机节点上，此过程保持度序列不变，并避免自环和重边。以概率 $1-\\phi$ 发生采纳事件：所选边的一个端点采纳另一个端点的观点。设 $M = Nk/2$ 为边的总数，$m$ 为活跃边的数量。定义活跃边密度为 $\\rho = m/M$。\n\n从模型定义出发，并假设随机混合以及除了对密度之外不存在度-观点相关性（配对近似），推导出一个封闭的平均场速率方程，用于描述在 AVM 动态下 $\\rho$ 的期望演化。对该速率方程进行线性稳定性和不动点分析，以确定临界重连概率 $\\phi_c(k)$。在此临界点，系统从一个具有非零稳态活跃边密度的区域，过渡到一个唯一的稳定稳态为 $\\rho = 0$（碎裂成观点同质的连通分量）的区域。基于配对近似，将 $\\phi_c(k)$ 显式地表示为 $k$ 和常数的函数。\n\n你的程序必须实现推导出的 $\\phi_c(k)$ 表达式，并针对以下平均度值的测试集进行评估：\n- $k = 2$ (最小连通性的边界情况),\n- $k = 3$ (低连通性),\n- $k = 4$ (中等连通性),\n- $k = 10$ (高连通性),\n- $k = 100$ (渐近区域指示)。\n\n你的程序应生成单行输出，其中包含用逗号分隔的浮点数列表形式的结果，四舍五入到小数点后 $10$ 位，并用方括号括起来（例如，$[0.1234567890,0.2345678901]$）。输出必须遵循此确切格式，并按上面列出的顺序包含为给定测试集计算的 $\\phi_c(k)$ 值。不涉及物理单位；所有量均为无量纲。最终答案必须以小数形式给出，而不是分数。",
            "solution": "自适应选民模型 (AVM) 包含两种类型的更新，应用于连接持有相反观点节点的边。设 $N$ 为节点数，$k$ 为平均度，$M = Nk/2$ 为总边数。定义活跃边数量 $m$ 为连接相反观点的边的数量，活跃边密度为 $\\rho = m/M$。\n\n我们的目标是使用配对近似推导 $\\rho$ 的平均场速率方程。此推导的基础是 AVM 更新规则的定义以及随机混合的假设，该假设允许通过对密度来近似高阶邻域统计，从而在对的层面上实现方程的封闭。\n\n我们首先考虑一个单一的基本事件，即从所有活跃边中均匀选择一条边。存在两种互斥的结果：\n\n- 以概率 $\\phi$ 发生重连，\n- 以概率 $1 - \\phi$ 发生采纳。\n\n我们计算每种结果下活跃边数量 $m$ 的期望变化，然后通过除以 $M$ 并重新调整时间尺度，将其转换为密度 $\\rho$ 的期望变化。由于稳定性和阈值在线性时间重标度下是不变的，我们关注速率方程的符号和不动点，而不是其绝对速度。\n\n重连步骤 ($\\phi$)：当一条活跃边被重连时，该边会从活跃边集合中移除，并被一条连接相同观点节点的边所取代。在配对近似和随机混合的假设下，重连的边变为非活跃的（连接相同观点），并且重连选择不会产生新的活跃边。因此，活跃边数量的变化是\n$$\n\\Delta m_{\\text{rewire}} = -1.\n$$\n\n采纳步骤 ($1-\\phi$)：我们分析当所选活跃边的一个端点采纳另一个端点的观点时，活跃边数量的期望变化。考虑一条活跃边 $(i,j)$，其中节点 $i$ 持有观点 $A$，节点 $j$ 持有观点 $B$。不失一般性，假设节点 $i$ 采纳观点 $B$。活跃边数量的净变化取决于节点 $i$ 观点翻转前后与其关联的活跃边数量之差。\n\n设在翻转前，节点 $i$ 的邻居中持有观点 $B$ 的数量为 $b$，持有观点 $A$ 的数量为 $a$。那么节点 $i$ 的度为 $a + b = k$。在随机混合的假设下，并以所选活跃边 $(i,j)$ 的存在为条件，我们推断：\n- 一个邻居是 $j$，其观点为 $B$。\n- 其他 $k-1$ 个邻居是独立的，在配对近似下，每个邻居持有观点 $B$ 的概率为 $\\rho$，持有观点 $A$ 的概率为 $1-\\rho$。\n\n因此，在翻转前，观点为 $B$ 的邻居的期望数量是\n$$\n\\mathbb{E}[b] = 1 + (k - 1) \\rho,\n$$\n观点为 $A$ 的邻居的期望数量是\n$$\n\\mathbb{E}[a] = (k - 1)(1 - \\rho).\n$$\n在节点 $i$ 翻转为观点 $B$ 后，与 $i$ 关联的活跃边恰好是那些连接到持有观点 $A$ 的邻居的边，其数量为 $\\mathbb{E}[a]$。在翻转前，与 $i$ 关联的活跃边是那些连接到持有观点 $B$ 的邻居的边，其数量为 $\\mathbb{E}[b]$。因此，由单个采纳事件引起的活跃边数量的期望变化是\n$$\n\\Delta m_{\\text{adopt}} = \\mathbb{E}[a] - \\mathbb{E}[b]\n= (k - 1)(1 - \\rho) - \\left[ 1 + (k - 1) \\rho \\right]\n= (k - 1)(1 - 2\\rho) - 1.\n$$\n\n结合重连和采纳的结果，每次基本事件中 $m$ 的期望变化是\n$$\n\\Delta m = \\phi \\cdot (-1) + (1 - \\phi) \\cdot \\left[ (k - 1)(1 - 2\\rho) - 1 \\right].\n$$\n重标度时间以吸收常数因子 $M$，并直接使用密度 $\\rho$ 进行计算，我们得到平均场速率方程\n$$\n\\frac{d\\rho}{d\\tau} = -\\phi + (1 - \\phi) \\left[ (k - 1)(1 - 2\\rho) - 1 \\right],\n$$\n其中 $\\tau$ 是一个与基本事件数量成正比的重标度时间变量。\n\n展开右侧以分离 $\\rho$ 的常数项和线性项，\n$$\n\\frac{d\\rho}{d\\tau} = \\underbrace{\\left[ (k - 2) - \\phi (k - 1) \\right]}_{\\text{常数项}}\n\\;-\\; \\underbrace{2 (1 - \\phi) (k - 1)}_{\\text{线性系数}} \\; \\rho.\n$$\n\n不动点与稳定性：不动点满足\n$$\n\\left[ (k - 2) - \\phi (k - 1) \\right] - 2 (1 - \\phi) (k - 1) \\rho^* = 0,\n$$\n所以\n$$\n\\rho^* = \\frac{(k - 2) - \\phi (k - 1)}{2 (1 - \\phi) (k - 1)}.\n$$\n当内部不动点 $\\rho^*$ 与 $\\rho = 0$ 相撞时，出现碎裂阈值，这标志着非零活跃边密度的消失。这恰好在分子为零时发生：\n$$\n(k - 2) - \\phi_c (k - 1) = 0.\n$$\n求解 $\\phi_c$ 可得\n$$\n\\phi_c(k) = \\frac{k - 2}{k - 1}.\n$$\n\n解释：对于 $\\phi  \\phi_c(k)$，速率方程中的常数项为正，这意味着存在一个远离 $\\rho = 0$ 的正向漂移和一个稳定的内部不动点 $\\rho^* > 0$，代表持续的观点间相互作用（无碎裂）。对于 $\\phi > \\phi_c(k)$，常数项为负，唯一稳定的不动点是 $\\rho = 0$，对应于碎裂成没有活跃边的观点同质连通分量。\n\n程序规范：程序应实现推导出的表达式 $\\phi_c(k) = \\frac{k - 2}{k - 1}$，并针对测试集中的值 $k = 2$, $k = 3$, $k = 4$, $k = 10$, 和 $k = 100$ 进行计算。输出是无量纲的，必须表示为小数，并必须以方括号括起来的单个逗号分隔列表的形式打印，每个值四舍五入到小数点后 $10$ 位，并严格按照测试集的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef phi_c(k: int) -> float:\n    \"\"\"\n    Critical rewiring probability phi_c(k) under the pair approximation\n    for the two-state adaptive voter model on a random network\n    with mean degree k: phi_c = (k - 2) / (k - 1).\n    \"\"\"\n    if k == 1:\n        # Undefined in this approximation; return NaN for completeness.\n        return float('nan')\n    return (k - 2) / (k - 1)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [2, 3, 4, 10, 100]\n\n    results = []\n    for k in test_cases:\n        result = phi_c(k)\n        # Round to 10 decimal places as specified.\n        results.append(f\"{result:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}