{
    "hands_on_practices": [
        {
            "introduction": "掌握随机游走始于基础。本练习将引导您完成从图的基本结构（邻接矩阵和度矩阵）构建转移矩阵的核心过程。通过分析一个简单的路径图，您将巩固对图拓扑、转移概率以及由平稳分布描述的长期行为之间关系的理解 。",
            "id": "4299832",
            "problem": "考虑一个无向简单路径图，其节点为 $1$, $2$, $3$，连接方式为 $1-2-3$。该图上的一个简单随机游走是一个时间齐次离散时间马尔可夫链（MC），其状态为图的节点。在每个时间步，位于节点 $i$ 的游走者会等概率地移动到其任意一个邻居节点。\n\n仅使用基本定义，完成以下任务：\n\n- 定义该图的邻接矩阵 $A$ 和度矩阵 $D$。\n- 从“从节点 $i$ 到节点 $j$ 的转移概率，当 $j$ 是 $i$ 的邻居时等于 $1/k_{i}$，否则等于 $0$（其中 $k_{i}$ 是节点 $i$ 的度）”这一标准定义出发，推导转移矩阵 $P$ 关于 $A$ 和 $D$ 的紧凑矩阵表达式，并为该图显式计算 $P$。\n- 验证 $P \\mathbf{1} = \\mathbf{1}$，其中 $\\mathbf{1}$ 是全1向量，从而证明 $P$ 的每一行之和为 $1$。\n- 利用无向图上随机游走的可逆性和细致平衡概念，推导平稳分布 $\\pi$，并根据转移概率和度的异质性解释端点与中间节点之间的差异。\n- 最后，计算返回节点 $2$ 的精确两步返回概率，即 $P^{2}$ 的 $(2,2)$ 项，并将该数值作为你的最终答案。\n\n所有数值必须以精确形式给出。最终答案应为返回节点 $2$ 的精确两步返回概率。",
            "solution": "该问题定义明确，并基于马尔可夫链和图上随机游走的基本原理。我们按照指定的步骤进行求解。\n\n该图是一个无向简单路径图，节点标记为 $1, 2, 3$，连接方式为 $1-2-3$。节点集合为 $V = \\{1, 2, 3\\}$，边集合为 $E = \\{\\{1, 2\\}, \\{2, 3\\}\\}$。\n\n**邻接矩阵 $A$ 和度矩阵 $D$**\n对于一个无向图，其邻接矩阵 $A$ 是一个对称矩阵，其中如果节点 $i$ 和节点 $j$ 之间有边相连，则元素 $A_{ij}$ 为 $1$，否则为 $0$。对于简单图，对角线元素 $A_{ii}$ 均为 $0$。\n对于给定图，连接存在于节点 $1$ 和 $2$ 之间，以及节点 $2$ 和 $3$ 之间。因此，邻接矩阵为：\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}\n$$\n节点 $i$ 的度，记为 $k_i$，是连接到该节点的边的数量。它可以从邻接矩阵计算得出：$k_i = \\sum_{j} A_{ij}$。\n各节点的度为：\n$k_1 = A_{11} + A_{12} + A_{13} = 0 + 1 + 0 = 1$\n$k_2 = A_{21} + A_{22} + A_{23} = 1 + 0 + 1 = 2$\n$k_3 = A_{31} + A_{32} + A_{33} = 0 + 1 + 0 = 1$\n度矩阵 $D$ 是一个对角矩阵，其对角线上的元素为各节点的度，即 $D_{ii} = k_i$。\n$$\nD = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n**转移矩阵 $P$**\n从节点 $i$到节点 $j$ 的转移概率 $P_{ij}$ 定义为：如果 $j$ 是 $i$ 的邻居，则为 $1/k_i$，否则为 $0$。这可以用邻接矩阵表示为 $P_{ij} = A_{ij}/k_i$。\n为了以矩阵形式表示，我们观察到转移矩阵 $P$ 的第 $i$ 行是通过将邻接矩阵 $A$ 的第 $i$ 行除以度 $k_i$ 得到的。这个操作对应于用度矩阵的逆 $D^{-1}$ 左乘 $A$。逆矩阵 $D^{-1}$ 是一个对角矩阵，其元素为 $(D^{-1})_{ii} = 1/k_i$。\n因此，矩阵表达式为 $P = D^{-1}A$。\n我们来计算 $D^{-1}$：\n$$\nD^{-1} = \\begin{pmatrix} 1/1  0  0 \\\\ 0  1/2  0 \\\\ 0  0  1/1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1/2  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n现在我们计算 $P$：\n$$\nP = D^{-1}A = \\begin{pmatrix} 1  0  0 \\\\ 0  1/2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 1/2  0  1/2 \\\\ 0  1  0 \\end{pmatrix}\n$$\n\n**验证行和为 $1$**\n为证明 $P$ 的每一行之和为 $1$，我们验证 $P \\mathbf{1} = \\mathbf{1}$，其中 $\\mathbf{1}$ 是全为 $1$ 的列向量。\n$$\nP \\mathbf{1} = \\begin{pmatrix} 0  1  0 \\\\ 1/2  0  1/2 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0\\cdot1 + 1\\cdot1 + 0\\cdot1 \\\\ (1/2)\\cdot1 + 0\\cdot1 + (1/2)\\cdot1 \\\\ 0\\cdot1 + 1\\cdot1 + 0\\cdot1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\mathbf{1}\n$$\n这证实了 $P$ 是一个合法的随机矩阵。\n\n**平稳分布 $\\pi$**\n对于无向图上的随机游走，该过程是可逆的。平稳分布 $\\pi$ 必须满足细致平衡条件：对于所有状态对 $i, j$，有 $\\pi_i P_{ij} = \\pi_j P_{ji}$。\n代入 $P_{ij} = A_{ij}/k_i$ 和 $P_{ji} = A_{ji}/k_j$：\n$$\n\\pi_i \\frac{A_{ij}}{k_i} = \\pi_j \\frac{A_{ji}}{k_j}\n$$\n由于图是无向的，$A$ 是对称的，所以 $A_{ij} = A_{ji}$。如果 $i$ 和 $j$ 之间存在边（$A_{ij}=1$），该条件简化为 $\\pi_i/k_i = \\pi_j/k_j$。由于图是连通的，这意味着对于所有节点 $i$，比率 $\\pi_i/k_i$ 是一个常数，记为 $C$。因此，$\\pi_i = C k_i$。平稳概率与节点的度成正比。\n为了求出常数 $C$，我们使用归一化条件 $\\sum_i \\pi_i = 1$：\n$$\n\\sum_{i=1}^{3} C k_i = C (k_1 + k_2 + k_3) = 1\n$$\n使用我们计算出的度，$k_1=1, k_2=2, k_3=1$：\n$$\nC(1 + 2 + 1) = C \\cdot 4 = 1 \\implies C = \\frac{1}{4}\n$$\n平稳分布的各分量为 $\\pi_i = k_i / \\sum_j k_j$。\n$$\n\\pi_1 = \\frac{k_1}{4} = \\frac{1}{4}\n$$\n$$\n\\pi_2 = \\frac{k_2}{4} = \\frac{2}{4} = \\frac{1}{2}\n$$\n$$\n\\pi_3 = \\frac{k_3}{4} = \\frac{1}{4}\n$$\n平稳分布为 $\\pi = \\begin{pmatrix} 1/4  1/2  1/4 \\end{pmatrix}$。\n**解释：** 平稳概率 $\\pi_i$ 表示游走者在节点 $i$ 停留时间的长期比例。结果表明，游走者有一半的时间停留在中心节点 $2$，而在每个端点（$1$ 和 $3$）各停留四分之一的时间。这是度的异质性的直接结果：节点 $2$ 的度为 $2$，而节点 $1$ 和 $3$ 的度为 $1$。从度较低的端点出发，游走者被迫移动到度较高的中心节点；而从中心节点出发，游走可以扩散到任一端点。这种结构特征导致游走者更频繁地访问连接性更强的中心节点，从而使其具有更高的平稳概率。\n\n**返回节点 $2$ 的两步返回概率**\n从节点 $i$ 出发，经过 $n$ 步后位于节点 $j$ 的概率由矩阵 $P^n$ 的 $(i,j)$ 项给出。我们需要计算 $P^2$ 的 $(2,2)$ 项，我们将其记为 $(P^2)_{22}$。\n这可以通过考虑所有从节点 $2$ 返回节点 $2$ 的长度为 $2$ 的可能路径来计算。长度为 $2$ 的路径涉及一个中间节点 $j$。该概率由 $(P^2)_{22} = \\sum_{j=1}^3 P_{2j}P_{j2}$ 给出。\n可能的路径有：\n1.  $2 \\to 1 \\to 2$：概率为 $P_{21} \\cdot P_{12}$。根据矩阵 $P$，$P_{21} = 1/2$ 且 $P_{12}=1$。概率为 $(1/2) \\cdot 1 = 1/2$。\n2.  $2 \\to 2 \\to 2$：概率为 $P_{22} \\cdot P_{22}$。由于没有自环，$P_{22}=0$。概率为 $0 \\cdot 0 = 0$。\n3.  $2 \\to 3 \\to 2$：概率为 $P_{23} \\cdot P_{32}$。根据矩阵 $P$，$P_{23} = 1/2$ 且 $P_{32}=1$。概率为 $(1/2) \\cdot 1 = 1/2$。\n总的两步返回概率是这些互斥路径的概率之和：\n$$\n(P^2)_{22} = P_{21}P_{12} + P_{22}P_{22} + P_{23}P_{32} = \\left(\\frac{1}{2}\\right)(1) + (0)(0) + \\left(\\frac{1}{2}\\right)(1) = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n或者，我们可以直接计算矩阵 $P^2$：\n$$\nP^2 = P \\cdot P = \\begin{pmatrix} 0  1  0 \\\\ 1/2  0  1/2 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 1/2  0  1/2 \\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 1/2  0  1/2 \\\\ 0  1  0 \\\\ 1/2  0  1/2 \\end{pmatrix}\n$$\n$P^2$ 的 $(2,2)$ 项是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "许多由随机游走建模的真实世界过程都涉及“陷阱”或“目标”——即游走者一旦进入便无法离开的吸收态。本练习介绍了一种强大的技术——首步分析法 (first-step analysis)，用于计算在陷入陷阱之前到达目标的概率。您将学习如何基于马尔可夫性质建立并求解一个线性方程组，以计算这些命中概率，这是分析具有吸收边界的随机过程的一项基本技能 。",
            "id": "4299835",
            "problem": "考虑一个在有限有向网络上的离散时间随机游走，其节点集为 $\\{S, A, B, C, T, U, V\\}$。节点 $T$ 是一个指定的目标，而 $U$ 和 $V$ 是陷阱（吸收态）。该随机游走作为一个时齐马尔可夫链演化，其从瞬时节点 $S$、$A$、$B$ 和 $C$ 的转移由以下规则确定：\n- 从 $S$ 出发：以概率 $1/2$ 移动到 $A$，以概率 $1/3$ 移动到 $B$，以概率 $1/6$ 移动到 $V$。\n- 从 $A$ 出发：以概率 $1/3$ 移动到 $T$，以概率 $1/3$ 移动到 $B$，以概率 $1/3$ 移动到 $U$。\n- 从 $B$ 出发：以概率 $1/4$ 移动到 $A$，以概率 $1/2$ 移动到 $C$，以概率 $1/4$ 移动到 $U$。\n- 从 $C$ 出发：以概率 $1/2$ 移动到 $T$，以概率 $1/3$ 移动到 $B$，以概率 $1/6$ 移动到 $V$。\n\n节点 $T$、$U$ 和 $V$ 是吸收态：一旦进入，游走将永远停留在那里。\n\n从 $S$ 出发，计算该游走在到达 $U$ 或 $V$ 之前到达 $T$ 的概率。请使用基于马尔可夫性质的首步分析法，从第一性原理推导你的结果，并解释如何使用吸收马尔可夫链的基本矩阵表示相同的量。将最终概率表示为最简分数。无需四舍五入。",
            "solution": "该问题要求计算一个从节点 $S$ 开始的随机游走在被陷阱节点 $U$ 或 $V$ 吸收之前到达目标节点 $T$ 的概率。这可以被表述为一个吸收马尔可夫链上的击中概率问题。瞬时态的集合是 $\\mathcal{T} = \\{S, A, B, C\\}$，吸收态的集合是 $\\mathcal{A} = \\{T, U, V\\}$。\n\n令 $h_i$ 为给定游走从节点 $i \\in \\mathcal{T}$ 开始，在到达任何其他吸收态（$U$ 或 $V$）之前到达目标态 $T$ 的概率。我们需要求解 $h_S$。\n\n根据定义，对于吸收态，概率为：\n- $h_T = 1$，因为游走已成功到达目标。\n- $h_U = 0$，因为游走已被困住，未能先到达目标。\n- $h_V = 0$，原因同上。\n\n我们将按照要求使用两种方法解决此问题：首步分析法和基本矩阵法。\n\n### 1. 使用首步分析法推导\n\n首步分析法基于马尔可夫性质。从状态 $i$ 到达目标的概率是从 $i$ 一步可达的状态到达目标的概率的加权平均值，权重为转移概率。\n对于任何瞬时态 $i \\in \\mathcal{T}$，概率 $h_i$ 由以下方程给出：\n$$h_i = \\sum_{j \\in \\mathcal{T} \\cup \\mathcal{A}} P_{ij} h_j$$\n其中 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n将此原理应用于每个瞬时态，我们得到一个关于未知概率 $h_S, h_A, h_B, h_C$ 的线性方程组。\n\n1.  **从 S 出发：** 游走可以转移到 $A$（概率 $1/2$），$B$（概率 $1/3$），或 $V$（概率 $1/6$）。\n    $$h_S = P_{SA} h_A + P_{SB} h_B + P_{SV} h_V = \\frac{1}{2} h_A + \\frac{1}{3} h_B + \\frac{1}{6} (0)$$\n    $$h_S = \\frac{1}{2} h_A + \\frac{1}{3} h_B \\quad (1)$$\n\n2.  **从 A 出发：** 游走可以转移到 $T$（概率 $1/3$），$B$（概率 $1/3$），或 $U$（概率 $1/3$）。\n    $$h_A = P_{AT} h_T + P_{AB} h_B + P_{AU} h_U = \\frac{1}{3} (1) + \\frac{1}{3} h_B + \\frac{1}{3} (0)$$\n    $$h_A = \\frac{1}{3} + \\frac{1}{3} h_B \\quad (2)$$\n\n3.  **从 B 出发：** 游走可以转移到 $A$（概率 $1/4$），$C$（概率 $1/2$），或 $U$（概率 $1/4$）。\n    $$h_B = P_{BA} h_A + P_{BC} h_C + P_{BU} h_U = \\frac{1}{4} h_A + \\frac{1}{2} h_C + \\frac{1}{4} (0)$$\n    $$h_B = \\frac{1}{4} h_A + \\frac{1}{2} h_C \\quad (3)$$\n\n4.  **从 C 出发：** 游走可以转移到 $T$（概率 $1/2$），$B$（概率 $1/3$），或 $V$（概率 $1/6$）。\n    $$h_C = P_{CT} h_T + P_{CB} h_B + P_{CV} h_V = \\frac{1}{2} (1) + \\frac{1}{3} h_B + \\frac{1}{6} (0)$$\n    $$h_C = \\frac{1}{2} + \\frac{1}{3} h_B \\quad (4)$$\n\n现在我们求解这个由四个线性方程组成的方程组。最有效的方法是先求解 $h_A, h_B, h_C$。\n从方程（2），我们可以用 $h_A$ 表示 $h_B$：\n$$3h_A = 1 + h_B \\implies h_B = 3h_A - 1$$\n将 $h_B$ 的这个表达式代入方程（4），以 $h_A$ 表示 $h_C$：\n$$h_C = \\frac{1}{2} + \\frac{1}{3} (3h_A - 1) = \\frac{1}{2} + h_A - \\frac{1}{3} = h_A + \\frac{1}{6}$$\n现在，将 $h_B$ 和 $h_C$ 的表达式代入方程（3）：\n$$3h_A - 1 = \\frac{1}{4} h_A + \\frac{1}{2} \\left(h_A + \\frac{1}{6}\\right)$$\n$$3h_A - 1 = \\frac{1}{4} h_A + \\frac{1}{2} h_A + \\frac{1}{12}$$\n为了消去分数，将整个方程乘以 $12$：\n$$12(3h_A - 1) = 12\\left(\\frac{1}{4} h_A\\right) + 12\\left(\\frac{1}{2} h_A\\right) + 12\\left(\\frac{1}{12}\\right)$$\n$$36h_A - 12 = 3h_A + 6h_A + 1$$\n$$36h_A - 12 = 9h_A + 1$$\n$$27h_A = 13 \\implies h_A = \\frac{13}{27}$$\n现在我们可以回代求解 $h_B$：\n$$h_B = 3h_A - 1 = 3\\left(\\frac{13}{27}\\right) - 1 = \\frac{13}{9} - 1 = \\frac{4}{9}$$\n最后，我们使用方程（1）计算所求的概率 $h_S$：\n$$h_S = \\frac{1}{2} h_A + \\frac{1}{3} h_B = \\frac{1}{2}\\left(\\frac{13}{27}\\right) + \\frac{1}{3}\\left(\\frac{4}{9}\\right)$$\n$$h_S = \\frac{13}{54} + \\frac{4}{27} = \\frac{13}{54} + \\frac{8}{54} = \\frac{21}{54}$$\n将分子和分母除以它们的最大公约数 $3$ 来化简分数：\n$$h_S = \\frac{21 \\div 3}{54 \\div 3} = \\frac{7}{18}$$\n\n### 2. 使用基本矩阵的解释\n\n吸收马尔可夫链的理论为此问题提供了一个矩阵表述。转移矩阵 $P$ 可以写成典范形式，通过将状态排序为先瞬时态 $\\mathcal{T}=\\{S, A, B, C\\}$，后吸收态 $\\mathcal{A}=\\{T, U, V\\}$。\n$$P = \\begin{pmatrix} Q  R \\\\ 0  I \\end{pmatrix}$$\n这里，$Q$ 是瞬时态之间转移概率的 $4 \\times 4$ 子矩阵，$R$ 是从瞬时态到吸收态概率的 $4 \\times 3$ 子矩阵，$0$ 是一个 $3 \\times 4$ 的零矩阵，$I$ 是 $3 \\times 3$ 的单位矩阵。\n\n根据问题描述，这些矩阵是：\n$$Q = \\begin{pmatrix} P_{SS}  P_{SA}  P_{SB}  P_{SC} \\\\ P_{AS}  P_{AA}  P_{AB}  P_{AC} \\\\ P_{BS}  P_{BA}  P_{BB}  P_{BC} \\\\ P_{CS}  P_{CA}  P_{CB}  P_{CC} \\end{pmatrix} = \\begin{pmatrix} 0  1/2  1/3  0 \\\\ 0  0  1/3  0 \\\\ 0  1/4  0  1/2 \\\\ 0  0  1/3  0 \\end{pmatrix}$$\n$$R = \\begin{pmatrix} P_{ST}  P_{SU}  P_{SV} \\\\ P_{AT}  P_{AU}  P_{AV} \\\\ P_{BT}  P_{BU}  P_{BV} \\\\ P_{CT}  P_{CU}  P_{CV} \\end{pmatrix} = \\begin{pmatrix} 0  0  1/6 \\\\ 1/3  1/3  0 \\\\ 0  1/4  0 \\\\ 1/2  0  1/6 \\end{pmatrix}$$\n\n吸收链的基本矩阵是 $N = (I - Q)^{-1}$。元素 $N_{ij}$ 表示给定过程从瞬时态 $i$ 开始，处于瞬时态 $j$ 的期望次数。\n\n从一个瞬时态 $i$ 开始，被一个特定的吸收态 $k$ 吸收的概率由矩阵乘积 $B = NR$ 的第 $(i,k)$ 个元素给出。令 $\\mathbf{h} = (h_S, h_A, h_B, h_C)^T$ 为从每个瞬时态进入目标态 $T$ 的吸收概率列向量。该向量对应于矩阵 $B$ 的第一列（因为我们将 $T$ 排列为第一个吸收态）。它可以计算为：\n$$\\mathbf{h} = N \\mathbf{r}_T$$\n其中 $\\mathbf{r}_T$ 是矩阵 $R$ 的第一列：\n$$\\mathbf{r}_T = (P_{ST}, P_{AT}, P_{BT}, P_{CT})^T = (0, 1/3, 0, 1/2)^T$$\n代入 $N = (I-Q)^{-1}$，我们得到：\n$$\\mathbf{h} = (I-Q)^{-1} \\mathbf{r}_T$$\n从左侧乘以 $(I-Q)$ 得到：\n$$(I-Q)\\mathbf{h} = \\mathbf{r}_T$$\n这个矩阵方程是：\n$$\\begin{pmatrix} 1  -1/2  -1/3  0 \\\\ 0  1  -1/3  0 \\\\ 0  -1/4  1  -1/2 \\\\ 0  0  -1/3  1 \\end{pmatrix} \\begin{pmatrix} h_S \\\\ h_A \\\\ h_B \\\\ h_C \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/3 \\\\ 0 \\\\ 1/2 \\end{pmatrix}$$\n展开这个矩阵方程得到以下系统：\n- $h_S - \\frac{1}{2}h_A - \\frac{1}{3}h_B = 0 \\implies h_S = \\frac{1}{2}h_A + \\frac{1}{3}h_B$\n- $h_A - \\frac{1}{3}h_B = 1/3 \\implies h_A = \\frac{1}{3} + \\frac{1}{3}h_B$\n- $-\\frac{1}{4}h_A + h_B - \\frac{1}{2}h_C = 0 \\implies h_B = \\frac{1}{4}h_A + \\frac{1}{2}h_C$\n- $-\\frac{1}{3}h_B + h_C = 1/2 \\implies h_C = \\frac{1}{2} + \\frac{1}{3}h_B$\n该方程组与使用首步分析法推导出的方程组完全相同。因此，基本矩阵形式主义为计算吸收概率提供了一个等价的、更通用的框架，并得出相同的结果。$h_S$ 的解仍然是 $\\frac{7}{18}$。",
            "answer": "$$\\boxed{\\frac{7}{18}}$$"
        },
        {
            "introduction": "除了单步转移概率，我们常需要能够捕捉网络上整体输运和探索效率的度量指标。这个问题通过有效电阻的概念将随机游走与电路理论联系起来，并引入了遍历时间 (commute time) 这一衡量随机游走者探索效率的关键指标。通过为两种极端对比的网络结构（路径图与完全图）推导并比较这些度量，您将对网络拓扑如何显著影响动态过程获得深刻的定量理解 。",
            "id": "4299826",
            "problem": "考虑两个无向、连通、简单图，每条边的权重为单位1，因此每条边可以看作是电阻网络中的单位电阻：一个是包含 $n$ 个顶点的路径图 $P_{n}$（一条单链），另一个是包含 $n$ 个顶点的完全图 $K_{n}$（每对顶点都相连）。令 $R_{ij}$ 表示节点 $i$ 和 $j$ 之间的有效电阻，定义为在基尔霍夫电路定律和欧姆定律下，从 $i$ 到 $j$ 驱动单位电流所需的电压差。考虑每个图上的离散时间简单随机游走，其转移概率定义为 $P_{uv} = A_{uv} / d_{u}$，其中 $A_{uv}$ 是邻接矩阵，$d_{u}$ 是节点 $u$ 的度。令 $H_{ij}$ 表示从 $i$ 到 $j$ 的首达时间（从 $i$ 出发到达 $j$ 所需的期望步数），并定义往返时间 $C_{ij} = H_{ij} + H_{ji}$。\n\n从基本定义和定律（有效电阻的基尔霍夫定律和随机游走的首达时间线性方程）出发，推导以下各项的闭式表达式：\n- $P_{n}$ 端点之间的有效电阻 $R_{ij}$。\n- $P_{n}$ 端点之间的往返时间 $C_{ij}$。\n- $K_{n}$ 中任意两个不同节点之间的有效电阻 $R_{ij}$。\n- $K_{n}$ 中任意两个不同节点之间的往返时间 $C_{ij}$。\n\n然后，比较每个量对于 $P_{n}$ 与 $K_{n}$ 随 $n$ 的渐近标度，解释结果所蕴含的传输效率和探索效率的定性差异。将你的最终答案表示为一个单行矩阵，按顺序 $\\left(R_{P_{n}},\\, C_{P_{n}},\\, R_{K_{n}},\\, C_{K_{n}}\\right)$ 列出四个表达式。不需要数值四舍五入；提供以 $n$ 表示的精确表达式。",
            "solution": "该问题是有效的，因为它在科学上基于网络科学、概率论和电路理论，是良定的、客观的和完整的。我们可以按要求从基本原理开始进行推导。\n\n问题要求推导两种特定图结构——路径图 $P_n$ 和完全图 $K_n$ 的有效电阻 $R_{ij}$ 和往返时间 $C_{ij}$。我们将系统地处理每种情况。\n\n**1. 路径图 $P_n$**\n\n设路径图 $P_n$ 的顶点从 $i=1$ 到 $i=n$ 顺序标记。对于 $i=1, 2, \\dots, n-1$，边连接顶点 $i$ 和顶点 $i+1$。端点是顶点 $1$ 和 $n$。\n\n**$P_n$ 上的有效电阻 ($R_{1,n}$)**\n在电路网络类比中，每条边都是一个电阻为 $r=1$ 的电阻器。为了找到端点（节点1和n）之间的有效电阻 $R_{1,n}$，我们可以观察到该图代表一个简单的串联电路。从节点 $1$ 到节点 $n$ 的路径是唯一的，并穿过 $n-1$ 条边。串联电阻的总电阻是它们的和。因此，有效电阻是沿路径的 $n-1$ 条边的电阻之和。\n$$R_{1,n} = \\sum_{k=1}^{n-1} r = \\sum_{k=1}^{n-1} 1 = n-1$$\n\n**$P_n$ 上的往返时间 ($C_{1,n}$)**\n往返时间定义为 $C_{ij} = H_{ij} + H_{ji}$，其中 $H_{ij}$ 是首达时间。我们从其基本定义推导 $H_{ij}$。对于图上的简单随机游走，从起始节点 $i$ 到目标节点 $j$ 的首达时间 $H_{i,j}$ 满足以下线性方程组。对于一个固定的目标 $j$，令 $h_k = H_{k,j}$：\n$$h_k = \\begin{cases} 0  \\text{if } k=j \\\\ 1 + \\sum_{l \\sim k} P_{kl} h_l  \\text{if } k \\neq j \\end{cases}$$\n其中 $P_{kl} = 1/d_k$ 是从 $k$ 到邻居 $l$ 的转移概率， $d_k$ 是顶点 $k$ 的度。\n\n我们来求 $P_n$ 上的 $H_{1,n}$。目标是顶点 $n$。令 $h_i = H_{i,n}$。度为 $d_1 = d_n = 1$ 且对于 $i \\in \\{2, \\dots, n-1\\}$ 有 $d_i = 2$。方程组是：\n1. $h_n = 0$\n2. 对于 $i \\in \\{2, \\dots, n-1\\}$: $h_i = 1 + \\frac{1}{2}(h_{i-1} + h_{i+1})$\n3. 对于 $i=1$: $h_1 = 1 + h_2$\n\n对内部节点的方程进行整理，得到二阶线性非齐次差分方程：\n$$h_{i+1} - 2h_i + h_{i-1} = -2$$\n通解是齐次解 $h_i^{(h)}$ 和特解 $h_i^{(p)}$ 的和。齐次方程是 $h_{i+1} - 2h_i + h_{i-1} = 0$，其特征方程为 $\\lambda^2 - 2\\lambda + 1 = 0 \\Rightarrow (\\lambda-1)^2 = 0$。对于重根 $\\lambda=1$，齐次解为 $h_i^{(h)} = A \\cdot 1^i + B \\cdot i \\cdot 1^i = A + Bi$。\n对于特解，我们尝试多项式 $h_i^{(p)} = Ci^2$。将其代入方程：\n$C(i+1)^2 - 2Ci^2 + C(i-1)^2 = -2 \\Rightarrow C(i^2+2i+1) - 2Ci^2 + C(i^2-2i+1) = -2 \\Rightarrow 2C = -2 \\Rightarrow C = -1$。\n所以，$h_i^{(p)} = -i^2$。\n通解是 $h_i = A + Bi - i^2$。\n\n我们使用边界条件来求解常数 $A$ 和 $B$：\n1. $h_n = 0 \\Rightarrow A + Bn - n^2 = 0$\n2. $h_1 = 1 + h_2 \\Rightarrow A+B(1)-1^2 = 1 + (A+B(2)-2^2) \\Rightarrow A+B-1 = 1+A+2B-4 \\Rightarrow B-1 = 2B-3 \\Rightarrow B=2$。\n\n将 $B=2$ 代入第一个条件：$A + 2n - n^2 = 0 \\Rightarrow A = n^2 - 2n$。\n因此，从节点 $i$ 到节点 $n$ 的首达时间是 $h_i = (n^2 - 2n) + 2i - i^2 = n^2 - 2n + 2i - i^2 = (n-i)(n+i-2)$。\n我们关心的是 $H_{1,n}$，它对应于 $i=1$：\n$$H_{1,n} = (n-1)(n+1-2) = (n-1)(n-1) = (n-1)^2$$\n由于图的对称性（将顶点重新标记为 $j' = n+1-j$），从 $n$ 到 $1$ 的首达时间与从 $1$ 到 $n$ 的首达时间相同：\n$$H_{n,1} = H_{1,n} = (n-1)^2$$\n因此，端点之间的往返时间为：\n$$C_{1,n} = H_{1,n} + H_{n,1} = (n-1)^2 + (n-1)^2 = 2(n-1)^2$$\n\n**2. 完全图 $K_n$**\n\n在完全图 $K_n$ 中，每对不同的顶点都由一条边连接。设每条边的电阻为 $r=1$。\n\n**$K_n$ 上的有效电阻 ($R_{ij}$)**\n我们希望找到任意两个不同节点（比如 $i$ 和 $j$）之间的有效电阻。根据欧姆定律，$R_{ij} = V_{ij}/I$，其中 $V_{ij}$ 是电势差。我们可以通过在节点 $i$ 注入 $I=1$ 单位的电流，并在节点 $j$ 将其取出，来求得此值。令 $\\phi_k$ 为节点 $k$ 的电势。不失一般性，我们可以设 $\\phi_j = 0$。\n由于图的对称性，所有其他节点 $k \\notin \\{i, j\\}$ 必须具有相同的电势，我们将其记为 $\\phi_x$。所以我们有电势 $\\phi_i$，$\\phi_j=0$，以及对于 $k\\neq i,j$ 有 $\\phi_k = \\phi_x$。\n我们应用基尔霍夫电流定律：流出任何节点的电流之和为零（除非它是源或汇）。\n在节点 $i$（1单位电流的源）：\n$$1 = \\frac{\\phi_i - \\phi_j}{r} + \\sum_{k \\neq i,j} \\frac{\\phi_i - \\phi_k}{r} = (\\phi_i - 0) + (n-2)(\\phi_i - \\phi_x)$$\n$$1 = \\phi_i + (n-2)(\\phi_i - \\phi_x) \\quad (1)$$\n在任何中间节点 $k \\neq i,j$（无净电流）：\n$$0 = \\frac{\\phi_k - \\phi_i}{r} + \\frac{\\phi_k - \\phi_j}{r} + \\sum_{l \\neq i,j,k} \\frac{\\phi_k - \\phi_l}{r}$$\n$$0 = (\\phi_x - \\phi_i) + (\\phi_x - 0) + \\sum_{l \\neq i,j,k} (\\phi_x - \\phi_x)$$\n$$0 = 2\\phi_x - \\phi_i \\Rightarrow \\phi_i = 2\\phi_x$$\n将 $\\phi_i = 2\\phi_x$ 代入方程 $(1)$：\n$$1 = (2\\phi_x) + (n-2)(2\\phi_x - \\phi_x) = 2\\phi_x + (n-2)\\phi_x = (2 + n - 2)\\phi_x = n\\phi_x$$\n这得到 $\\phi_x = 1/n$。因此，$\\phi_i = 2\\phi_x = 2/n$。\n有效电阻是单位电流所需的电势差，即：\n$$R_{ij} = \\frac{\\phi_i - \\phi_j}{1} = \\frac{2/n - 0}{1} = \\frac{2}{n}$$\n\n**$K_n$ 上的往返时间 ($C_{ij}$)**\n我们再次使用首达时间 $h_k = H_{k,j}$ 的基本方程。对于 $K_n$，每个顶点的度都是 $d_k = n-1$。在任何节点 $k$ 的随机游走者以概率 $1/(n-1)$ 移动到其 $n-1$ 个邻居中的任何一个。\n我们来求不同 $i,j$ 的 $H_{i,j}$。令 $h_k = H_{k,j}$。我们有 $h_j = 0$。\n由于图的对称性，对于任何起始节点 $k \\neq j$，到达 $j$ 的时间必须相同。因此，对于所有 $k \\neq j$，令 $h_k = H$。\n对于任何起始节点 $i \\neq j$，首达时间方程为：\n$$h_i = 1 + \\sum_{l \\sim i} P_{il}h_l = 1 + \\frac{1}{n-1} \\sum_{l \\neq i} h_l$$\n求和遍及所有顶点 $l \\neq i$。其中一个顶点是目标 $j$，其 $h_j=0$。另外 $n-2$ 个顶点 $l$ 不是 $j$，所以 $h_l=H$。\n将 $h_i=H$ 代入方程：\n$$H = 1 + \\frac{1}{n-1} \\left( h_j + \\sum_{l \\neq i,j} h_l \\right) = 1 + \\frac{1}{n-1} \\left( 0 + (n-2)H \\right)$$\n$$H = 1 + \\frac{n-2}{n-1}H$$\n解出 $H$：\n$$H \\left( 1 - \\frac{n-2}{n-1} \\right) = 1 \\Rightarrow H \\left( \\frac{n-1 - (n-2)}{n-1} \\right) = 1 \\Rightarrow H \\left( \\frac{1}{n-1} \\right) = 1$$\n$$H = n-1$$\n因此，对于任何不同的 $i,j$，首达时间为 $H_{ij} = n-1$。根据对称性，$H_{ji} = n-1$。\n往返时间为：\n$$C_{ij} = H_{ij} + H_{ji} = (n-1) + (n-1) = 2(n-1)$$\n\n**3. 比较与解释**\n\n我们总结大 $n$ 情况下的结果：\n- **路径图 $P_n$ (端点):**\n  - $R_{1,n} = n-1 \\implies R \\sim O(n)$\n  - $C_{1,n} = 2(n-1)^2 \\implies C \\sim O(n^2)$\n- **完全图 $K_n$ (任意对):**\n  - $R_{ij} = 2/n \\implies R \\sim O(n^{-1})$\n  - $C_{ij} = 2(n-1) \\implies C \\sim O(n)$\n\n**传输效率 ($R_{ij}$):** 有效电阻衡量两点之间流动的阻力。\n- 在 $P_n$ 上，电阻随图的大小线性增长。这表示传输效率低下，因为流动被限制在一条单一的长路径上。这是一个空间扩展的一维系统的特征。\n- 在 $K_n$ 上，电阻随着 $n$ 的增加而消失。大量的平行路径使得传输极为高效。这种高连通性是“小世界”网络的一个标志，其中任意两节点间的有效距离很小。\n\n**探索效率 ($C_{ij}$):** 往返时间衡量随机游走者在两个节点之间来回移动的期望时间，这表明游走者探索网络的难易程度。\n- 在 $P_n$ 上，往返时间随图的大小呈二次方增长。在线性图上的随机游走者极有可能多次重访其足迹，使得在遥远端点之间的遍历成为一个非常缓慢的扩散过程。这反映了探索效率低下。\n- 在 $K_n$ 上，往返时间仅随图的大小线性增长。尽管节点数量增加，但高连通性确保了随机游走者可以相对快速地到达任何其他节点。首达时间 $H_{ij}=n-1$ 是在 $n-1$ 个选项中选出正确一个所需的平均时间。这比路径图上的探索效率要高得多。\n\n$R_{ij}$ 和 $C_{ij}$ 的标度律定量地展示了网络拓扑对动力学的深远影响。路径图是用于传输和探索的低效结构，而完全图则是最高效的。",
            "answer": "$$\\boxed{\\begin{pmatrix} n-1 & 2(n-1)^{2} & \\frac{2}{n} & 2(n-1) \\end{pmatrix}}$$"
        }
    ]
}