{
    "hands_on_practices": [
        {
            "introduction": "流行病爆发的可能性通常可以通过其底层接触网络的谱特性来理解。本练习将通过计算星形图（一个典型的具有中心枢纽的网络）的流行病阈值，来建立这一基本联系。通过推导其邻接矩阵的最大特征值 $\\lambda_1$，你将直接看到这个单一数值如何决定了 SIS 模型的临界点，为更高级的谱分析奠定坚实的基础。",
            "id": "4273572",
            "problem": "考虑一个具有 $N \\geq 3$ 个节点的无向、无权星形图上的易感-感染-易感 (SIS) 流行病过程。设邻接矩阵为 $A \\in \\mathbb{R}^{N \\times N}$，其中一个特殊的中枢节点（标签为 $1$）与所有 $N-1$ 个叶节点（标签为 $2$ 到 $N$）相连，而叶节点之间互不相连。因此，对于 $j \\in \\{2,\\ldots,N\\}$，$A_{1j} = A_{j1} = 1$，否则 $A_{ij} = 0$。每个受感染的节点以速率 $\\mu  0$ 恢复，每个易感节点以每个受感染邻居 $\\beta  0$ 的速率被感染。\n\n设 $p_i(t)$ 表示节点 $i$ 在时间 $t$ 受感染的概率。通过在无病平衡点（对所有 $i$，$p_i(t) = 0$）附近对节点级动力学进行线性化，可以得到一个经过充分检验的近似方法，该方法能捕捉早期行为和无病状态稳定性的丧失。在此近似下，我们考虑线性系统\n$$\n\\frac{d}{dt} \\boldsymbol{p}(t) \\approx \\left(-\\mu I + \\beta A\\right)\\boldsymbol{p}(t),\n$$\n其中 $\\boldsymbol{p}(t) = \\left(p_1(t),\\ldots,p_N(t)\\right)^{\\top}$，$I$ 是单位矩阵。无病平衡点的稳定性丧失发生在临界点，在该点线性算子从所有模式衰减转变为至少一个模式增长。\n\n从该线性化和线性稳定性分析的第一性原理出发，确定星形图邻接矩阵的最大特征值 $\\lambda_1(A)$（用 $N$ 表示）。然后，利用此结果得出 SIS 流行病阈值比 $\\beta_c/\\mu$ 作为 $N$ 的函数的解析表达式，该阈值比定义为使无病平衡点达到临界稳定状态时 $\\beta/\\mu$ 的唯一值。请以单一闭式表达式给出最终答案。无需四舍五入，也无需单位。",
            "solution": "该问题要求确定星形图上的 SIS 流行病阈值。此任务包括两个主要步骤：首先，找到星形图邻接矩阵的最大特征值；其次，在所提供的流行病动力学的线性稳定性分析中应用此结果。\n\n我们首先分析具有 $N$ 个节点的星形图的邻接矩阵 $A$ 的结构。该图有一个中心枢纽节点（我们标记为节点 1），它与 $N-1$ 个外围叶节点（标记为 2 到 $N$）相连。叶节点之间互不相连。相应的 $N \\times N$ 邻接矩阵 $A$ 是实对称矩阵，其元素为：对于 $j \\in \\{2, \\ldots, N\\}$，$A_{1j} = A_{j1} = 1$，所有其他元素均为零。\n\n为了找到 $A$ 的特征值 $\\lambda$，我们求解特征值方程 $A\\boldsymbol{v} = \\lambda\\boldsymbol{v}$，其中 $\\boldsymbol{v} = (v_1, v_2, \\ldots, v_N)^{\\top}$ 是对应的特征向量。这个矩阵方程可以写成一个包含 $N$ 个线性方程的方程组：\n对于中枢节点 ($i=1$)：\n$$ \\sum_{j=2}^{N} v_j = \\lambda v_1 $$\n对于叶节点 ($i \\in \\{2, \\ldots, N\\}$)：\n$$ v_1 = \\lambda v_i $$\n\n我们来分析这个方程组。从第二组方程可知，如果 $\\lambda \\neq 0$，对于所有 $i \\in \\{2, \\ldots, N\\}$，我们可以写出 $v_i = v_1 / \\lambda$。这意味着对应于叶节点的特征向量的所有分量都是相同的。我们用 $v_{\\text{leaf}}$ 表示这个共同的值。因此，$v_2 = v_3 = \\cdots = v_N = v_{\\text{leaf}} = v_1 / \\lambda$。\n\n将此结果代入中枢节点的方程中：\n$$ \\sum_{j=2}^{N} v_{\\text{leaf}} = (N-1) v_{\\text{leaf}} = \\lambda v_1 $$\n现在，我们将 $v_{\\text{leaf}} = v_1 / \\lambda$ 代入该方程：\n$$ (N-1) \\frac{v_1}{\\lambda} = \\lambda v_1 $$\n对于非平凡特征向量，$\\boldsymbol{v}$ 不能是零向量。如果 $v_1=0$，那么对所有 $i$ 都有 $v_i=0$，这会得到平凡解。因此，我们假设 $v_1 \\neq 0$，并可以用它来除：\n$$ \\frac{N-1}{\\lambda} = \\lambda \\implies \\lambda^2 = N-1 $$\n此方程给出了两个不同的特征值：$\\lambda = \\sqrt{N-1}$ 和 $\\lambda = -\\sqrt{N-1}$。\n\n接下来，我们考虑 $\\lambda = 0$ 的情况。方程组变为：\n对于中枢节点 ($i=1$)：\n$$ \\sum_{j=2}^{N} v_j = 0 $$\n对于叶节点 ($i \\in \\{2, \\ldots, N\\}$)：\n$$ v_1 = 0 \\cdot v_i = 0 $$\n因此，对于特征值 $0$，特征向量的第一个分量必须是 $v_1 = 0$，并且其其他 $N-1$ 个分量的和必须为零。满足 $\\sum_{j=2}^N v_j = 0$ 的向量集合 $(v_2, \\ldots, v_N)$ 构成一个维度为 $(N-1) - 1 = N-2$ 的向量空间。因此，$\\lambda=0$ 是一个几何重数为 $N-2$ 的特征值。\n\n总而言之，邻接矩阵 $A$ 的谱由三个不同的值组成：$\\sqrt{N-1}$（重数为 1）、$-\\sqrt{N-1}$（重数为 1）和 $0$（重数为 $N-2$）。特征值的总数为 $1 + 1 + (N-2) = N$，这与一个 $N \\times N$ 矩阵的预期相符。\n\n$A$ 的最大特征值，记为 $\\lambda_1(A)$，即为谱半径。给定 $N \\geq 3$，我们有 $\\sqrt{N-1} > 0$，所以最大特征值为：\n$$ \\lambda_1(A) = \\sqrt{N-1} $$\n\n现在，我们继续确定流行病阈值。感染概率 $\\boldsymbol{p}(t)$ 的动力学由以下线性系统近似：\n$$ \\frac{d}{dt} \\boldsymbol{p}(t) = \\left(-\\mu I + \\beta A\\right)\\boldsymbol{p}(t) $$\n无病平衡点对应于对所有 $t$ 都有 $\\boldsymbol{p}(t) = \\boldsymbol{0}$。该平衡点的稳定性由矩阵算子 $\\boldsymbol{M} = -\\mu I + \\beta A$ 的特征值决定。当且仅当 $\\boldsymbol{M}$ 的所有特征值都具有负实部时，该平衡点是稳定的。\n\n设 $\\eta$ 是 $\\boldsymbol{M}$ 的一个特征值，$\\boldsymbol{v}$ 是对应的特征向量。那么：\n$$ \\boldsymbol{M}\\boldsymbol{v} = \\eta\\boldsymbol{v} $$\n$$ (-\\mu I + \\beta A)\\boldsymbol{v} = \\eta\\boldsymbol{v} $$\n$$ \\beta A\\boldsymbol{v} = (\\eta + \\mu)\\boldsymbol{v} $$\n$$ A\\boldsymbol{v} = \\frac{\\eta + \\mu}{\\beta}\\boldsymbol{v} $$\n这个方程是 $A$ 的特征值方程。因此，对于 $A$ 的每个特征值 $\\lambda_j$，都有一个对应的 $\\boldsymbol{M}$ 的特征值 $\\eta_j$，它们之间的关系如下：\n$$ \\lambda_j = \\frac{\\eta_j + \\mu}{\\beta} \\implies \\eta_j = \\beta \\lambda_j - \\mu $$\n由于无向图的邻接矩阵 $A$ 是实对称的，所以其所有特征值 $\\lambda_j$ 都是实数。因此，$\\boldsymbol{M}$ 的所有特征值 $\\eta_j$ 也都是实数。\n\n无病状态的稳定性由 $\\boldsymbol{M}$ 的最大特征值的符号决定，我们将其记为 $\\eta_1$。这对应于 $A$ 的最大特征值 $\\lambda_1(A)$：\n$$ \\eta_1 = \\beta \\lambda_1(A) - \\mu $$\n如果 $\\eta_1  0$，无病状态是稳定的；如果 $\\eta_1 > 0$，则是不稳定的。流行病阈值是临界稳定性的点，此时 $\\eta_1 = 0$。在此阈值下，感染率 $\\beta$ 取其临界值 $\\beta_c$。\n设 $\\eta_1 = 0$：\n$$ \\beta_c \\lambda_1(A) - \\mu = 0 $$\n求解流行病阈值比 $\\beta_c/\\mu$：\n$$ \\frac{\\beta_c}{\\mu} = \\frac{1}{\\lambda_1(A)} $$\n代入我们找到的 $\\lambda_1(A) = \\sqrt{N-1}$ 的表达式：\n$$ \\frac{\\beta_c}{\\mu} = \\frac{1}{\\sqrt{N-1}} $$\n这就是星形图上 SIS 流行病阈值作为节点数 $N$ 的函数的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{N-1}}}\n$$"
        },
        {
            "introduction": "现实世界中的社会结构很少是简单的单一图；它们通常由不同的社区或互动层次组成。本练习将展示如何将强大的谱分析方法推广到这些更复杂、模块化的网络中。你将学习构建一个“超邻接矩阵”来表示一个多层系统，并利用其最大特征值来确定流行病阈值，这项技术可以广泛应用于分析现实结构化种群中的疾病传播。",
            "id": "4273504",
            "problem": "考虑一个具有模块化（社区）结构的网络化种群中的易感-感染-易感（SIS）传播过程。使用以下基本原理：确定性动力学系统在平衡点附近的线性稳定性由在该平衡点处计算的雅可比矩阵决定，如果雅可比矩阵的谱半径意味着轨迹会返回到平衡点（对于连续时间，所有特征值都具有负实部；对于离散时间，所有特征值都位于单位圆内），则该平衡点是稳定的。在淬火平均场近似下的网络化SIS模型中，无病平衡点对应于感染概率为零的情况。\n\n我们考虑在 $N$ 个物理节点（索引为 $i \\in \\{0,1,\\dots,N-1\\}$）的集合上定义的两个社区（层），索引为 $1$ 和 $2$。每个社区都有其自己的社区内邻接矩阵 $A^{(1)} \\in \\mathbb{R}^{N \\times N}$ 和 $A^{(2)} \\in \\mathbb{R}^{N \\times N}$，其元素为对称非负值，当节点 $i$ 和 $j$ 在社区 $\\ell$ 中不相互作用时，$A^{(\\ell)}_{ij} = 0$。节点可以同时属于两个社区（模块化重叠），也可以只属于一个社区。定义对角共属关系矩阵 $D \\in \\mathbb{R}^{N \\times N}$ 如下：\n$$\nD_{ii} = \\begin{cases}\n1  \\text{若节点 } i \\text{ 属于两个社区}, \\\\\n0  \\text{否则。}\n\\end{cases}\n$$\n社区间的耦合通过以权重 $\\omega \\ge 0$ 连接每个重叠节点在各层中的副本来建模。构建 $2N \\times 2N$ 的超邻接矩阵 $S$ 为分块矩阵：\n$$\nS = \\begin{pmatrix}\nA^{(1)}  \\omega D \\\\\n\\omega D  A^{(2)}\n\\end{pmatrix}.\n$$\n\n令 $\\beta  0$ 表示感染率，$\\mu  0$ 表示恢复率。定义无量纲有效感染率 $\\tau = \\beta / \\mu$。在超网络 $S$ 上的淬火平均场近似中，围绕无病平衡点进行线性化后，流行病阈值 $\\tau_c$ 是 $S$ 的主特征值（最大特征值）的函数。您的任务是：\n- 为每个指定的测试用例构建 $S$，\n- 计算其最大特征值 $\\lambda_{\\max}(S)$，\n- 为每个测试用例返回相应的临界感染率 $\\tau_c$，结果为十进制数，四舍五入到 $6$ 位小数。\n\n不涉及物理单位；所有量均为无量纲。不使用角度。答案必须是十进制数。\n\n测试套件（四个用例）。对于每个用例，都指定了 $N$、$A^{(1)}$、$A^{(2)}$、重叠集和 $\\omega$：\n\n用例 1（不相交的社区；无模块化重叠）：\n- $N = 5$,\n- $A^{(1)} = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}$,\n- $A^{(2)} = \\begin{pmatrix}\n0  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}$,\n- 重叠集 $\\{ \\}$, 即 $D = \\mathrm{diag}(0,0,0,0,0)$,\n- $\\omega = 0.8$.\n\n用例 2（单节点重叠；中等耦合）：\n- $N = 5$,\n- $A^{(1)} = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  0\n\\end{pmatrix}$,\n- $A^{(2)} = \\begin{pmatrix}\n0  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  1  1 \\\\\n0  0  1  0  0 \\\\\n0  0  1  0  0\n\\end{pmatrix}$,\n- 重叠集 $\\{2\\}$, 即 $D = \\mathrm{diag}(0,0,1,0,0)$,\n- $\\omega = 0.5$.\n\n用例 3（多节点重叠；较强耦合）：\n- $N = 5$,\n- $A^{(1)} = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}$,\n- $A^{(2)} = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  0  0\n\\end{pmatrix}$,\n- 重叠集 $\\{1,2,3\\}$, 即 $D = \\mathrm{diag}(0,1,1,1,0)$,\n- $\\omega = 1.0$.\n\n用例 4（完全重叠；相同的密集社区；强耦合）：\n- $N = 4$,\n- $A^{(1)} = \\begin{pmatrix}\n0  1  1  1 \\\\\n1  0  1  1 \\\\\n1  1  0  1 \\\\\n1  1  1  0\n\\end{pmatrix}$,\n- $A^{(2)} = \\begin{pmatrix}\n0  1  1  1 \\\\\n1  0  1  1 \\\\\n1  1  0  1 \\\\\n1  1  1  0\n\\end{pmatrix}$,\n- 重叠集 $\\{0,1,2,3\\}$, 即 $D = \\mathrm{diag}(1,1,1,1)$,\n- $\\omega = 2.0$.\n\n您的程序应：\n- 对于每个用例，使用指定的 $A^{(1)}$、$A^{(2)}$、$D$ 和 $\\omega$ 构建 $S$，\n- 计算 $\\lambda_{\\max}(S)$（最大特征值），\n- 计算 $\\tau_c = 1 / \\lambda_{\\max}(S)$，\n- 将每个 $\\tau_c$ 四舍五入到 $6$ 位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[x_1,x_2,x_3,x_4]$，其中 $x_i$ 是按顺序排列的用例 1 到 4 的四舍五入后的小数。",
            "solution": "用户希望求解双层网络上易感-感染-易感（SIS）模型的流行病阈值。我将首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **模型**：在具有模块化（社区）结构的网络化种群上的易感-感染-易感（SIS）传播过程。\n- **框架**：淬火平均场近似，围绕无病平衡点进行线性化。\n- **社区**：两个社区（层），索引为 $1$ 和 $2$。\n- **节点**：$N$ 个物理节点的集合，索引为 $i \\in \\{0, 1, \\dots, N-1\\}$。\n- **社区内邻接矩阵**：$A^{(1)} \\in \\mathbb{R}^{N \\times N}$ 和 $A^{(2)} \\in \\mathbb{R}^{N \\times N}$，具有对称非负元素。\n- **共属关系矩阵**：$D \\in \\mathbb{R}^{N \\times N}$，一个对角矩阵，如果节点 $i$ 属于两个社区，则 $D_{ii} = 1$，否则 $D_{ii} = 0$。\n- **社区间耦合**：权重 $\\omega \\ge 0$。\n- **超邻接矩阵**：一个 $2N \\times 2N$ 的分块矩阵 $S = \\begin{pmatrix} A^{(1)}  \\omega D \\\\ \\omega D  A^{(2)} \\end{pmatrix}$。\n- **参数**：感染率 $\\beta  0$，恢复率 $\\mu  0$。\n- **有效感染率**：$\\tau = \\beta / \\mu$。\n- **流行病阈值条件**：流行病阈值 $\\tau_c$ 是 $S$ 的主特征值 $\\lambda_{\\max}(S)$ 的函数。任务指定关系为 $\\tau_c = 1 / \\lambda_{\\max}(S)$。\n- **任务**：对于四个测试用例中的每一个，构建 $S$，计算其最大特征值 $\\lambda_{\\max}(S)$，并返回四舍五入到 $6$ 位小数的 $\\tau_c = 1 / \\lambda_{\\max}(S)$。\n- **测试用例**：四个用例已完全指定，包括 $N$、矩阵 $A^{(1)}$ 和 $A^{(2)}$、重叠节点集以及耦合权重 $\\omega$ 的值。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于多层网络上的标准 SIS 模型，这是网络科学和数学流行病学中一个成熟的课题。使用超邻接矩阵并通过系统雅可比矩阵（在淬火平均场近似下由 $S$ 表示）的主特征值来确定流行病阈值是标准的理论方法。公式 $\\tau_c = 1/\\lambda_{\\max}(S)$ 是这类模型的经典结果。该问题在科学上是合理的。\n- **适定性**：每个测试用例的所有参数和矩阵都已明确提供。这使得矩阵 $S$ 的构建是明确无误的。由于 $S$ 被指定为实对称矩阵，其特征值是实数且定义良好。在非负矩阵的 Perron-Frobenius 定理的一般条件下，最大特征值 $\\lambda_{\\max}(S)$ 存在且唯一。$\\tau_c$ 的计算是一个简单的求逆运算。每个用例都存在唯一解。\n- **客观性**：问题使用精确的数学语言和定义进行陈述。没有主观或含糊不清的术语。\n\n该问题不违反任何无效性标准。它在科学上是合理的、适定的、完整的并且是可形式化的。\n\n### 第 3 步：结论和行动\n问题是**有效的**。将提供解决方案。\n\n---\n\n该问题要求计算双层网络上易感-感染-易感（SIS）模型的流行病阈值。所提供的理论基础是，对于该系统的淬火平均场近似，流行病阈值 $\\tau_c$ 由超邻接矩阵 $S$ 的谱特性决定。具体来说，当有效感染率 $\\tau = \\beta / \\mu$ 超过临界值 $\\tau_c$ 时，无病平衡点失去稳定性。该阈值由控制无病状态附近线性化动力学的矩阵的最大特征值（谱半径）的倒数给出。在此公式中，该矩阵是超邻接矩阵 $S$。因此，核心关系是：\n$$\n\\tau_c = \\frac{1}{\\lambda_{\\max}(S)}\n$$\n其中 $\\lambda_{\\max}(S)$ 是 $S$ 的最大特征值。\n\n超邻接矩阵 $S$ 是一个定义如下的 $2N \\times 2N$ 分块矩阵：\n$$\nS = \\begin{pmatrix}\nA^{(1)}  \\omega D \\\\\n\\omega D  A^{(2)}\n\\end{pmatrix}\n$$\n此处，$A^{(1)}$ 和 $A^{(2)}$ 是两个社区（层）的 $N \\times N$ 邻接矩阵，$\\omega$ 是层间耦合强度，$D$ 是一个对角 $N \\times N$ 矩阵，指示哪些节点是两个社区之间重叠部分的一部分。\n\n解决每个测试用例问题的步骤如下：\n$1$. 对于给定的节点数 $N$，按规定定义社区内邻接矩阵 $A^{(1)}$ 和 $A^{(2)}$。这些矩阵是对称的，并且具有非负元素。\n$2$. 构建共属关系矩阵 $D$。这是一个 $N \\times N$ 的对角矩阵。对于指定重叠集中的每个节点索引 $i$，我们设置对角元素 $D_{ii} = 1$；所有其他元素均为 $0$。\n$3$. 使用给定的耦合权重 $\\omega \\ge 0$，从分块 $A^{(1)}$、$A^{(2)}$ 和 $\\omega D$ 组装 $2N \\times 2N$ 的超邻接矩阵 $S$。\n$4$. 计算 $S$ 的特征值。由于 $A^{(1)}$ 和 $A^{(2)}$ 是对称的，$D$ 是对角的，所以 $S$ 是一个实对称矩阵。它的特征值都是实数。我们使用数值特征值求解器来找到它们。其中最大的是 $\\lambda_{\\max}(S)$。\n$5$. 计算临界阈值 $\\tau_c = 1 / \\lambda_{\\max}(S)$。由于 $S$ 的所有元素都是非负的，根据 Perron-Frobenius 定理，$\\lambda_{\\max}(S) \\ge 0$。对于给定的非平凡网络，$\\lambda_{\\max}(S)  0$。\n$6$. 将最终值四舍五入到 6 位小数。\n\n我们将此过程应用于四个测试用例中的每一个。\n\n**用例 1：**\n- $N=5$。\n- $A^{(1)}$ 描述了节点 $0, 1, 2, 3, 4$ 上的路径图。$A^{(2)}$ 描述了节点 $3$ 和 $4$ 之间的一条边。\n- 重叠集为空，因此 $D$ 是零矩阵。\n- 当 $D = 0$ 时，矩阵 $S$ 变为块对角矩阵：$S = \\text{diag}(A^{(1)}, A^{(2)})$。\n- 块对角矩阵的特征值是其块的特征值的并集。因此，$\\lambda_{\\max}(S) = \\max(\\lambda_{\\max}(A^{(1)}), \\lambda_{\\max}(A^{(2)}))$。\n- $A^{(1)}$（5个节点路径图的邻接矩阵）的最大特征值是 $2\\cos(\\pi/6) = \\sqrt{3}$。\n- $A^{(2)}$（一条边和三个孤立节点）的最大特征值是 $1$。\n- 因此，$\\lambda_{\\max}(S) = \\max(\\sqrt{3}, 1) = \\sqrt{3} \\approx 1.732051$。\n- $\\tau_c = 1/\\sqrt{3} \\approx 0.577350$。\n\n**用例 2：**\n- $N=5$；$\\omega=0.5$。\n- $A^{(1)}$ 代表节点 $0, 1, 2$ 上的路径。$A^{(2)}$ 代表节点 $2, 3, 4$ 上的路径。\n- 重叠集是 $\\{2\\}$，所以 $D = \\text{diag}(0,0,1,0,0)$。\n- 我们构建 $10 \\times 10$ 的矩阵 $S$ 并以数值方式计算其特征值。\n- 发现最大特征值为 $\\lambda_{\\max}(S) \\approx 1.637508$。\n- $\\tau_c = 1 / \\lambda_{\\max}(S) \\approx 0.610683$。\n\n**用例 3：**\n- $N=5$；$\\omega=1.0$。\n- $A^{(1)}$ 是所有 5 个节点上的路径。$A^{(2)}$ 是节点 $0, 1, 2, 3$ 上的路径。\n- 重叠集是 $\\{1,2,3\\}$，所以 $D = \\text{diag}(0,1,1,1,0)$。\n- 我们构建 $10 \\times 10$ 的矩阵 $S$ 并以数值方式计算其特征值。\n- 发现最大特征值为 $\\lambda_{\\max}(S) \\approx 2.369275$。\n- $\\tau_c = 1 / \\lambda_{\\max}(S) \\approx 0.422072$。\n\n**用例 4：**\n- $N=4$；$\\omega=2.0$。\n- $A^{(1)}$ 和 $A^{(2)}$ 都是完全图 $K_4$ 的邻接矩阵。\n- 重叠是完全的，所以 $D$ 是 $4 \\times 4$ 的单位矩阵 $I_4$。\n- 超邻接矩阵是 $S = \\begin{pmatrix} A  2I_4 \\\\ 2I_4  A \\end{pmatrix}$，其中 $A$ 是 $K_4$ 的邻接矩阵。\n- $A$ 的特征值是 $3$（重数为 $1$）和 $-1$（重数为 $3$）。\n- 这种形式的分块矩阵的特征值是 $\\lambda_i \\pm \\omega$，对应于 $A$ 的每个特征值 $\\lambda_i$。\n- 这给出的特征值为 $3 \\pm 2 = \\{5, 1\\}$ 和 $-1 \\pm 2 = \\{1, -3\\}$。\n- $S$ 的特征值集合是 $\\{5, 1, 1, 1, 1, -3, -3, -3\\}$。\n- 最大特征值是 $\\lambda_{\\max}(S) = 5$。\n- $\\tau_c = 1/5 = 0.200000$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the SIS epidemic threshold on a two-layer network for a suite of test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"N\": 5,\n            \"A1\": np.array([\n                [0, 1, 0, 0, 0],\n                [1, 0, 1, 0, 0],\n                [0, 1, 0, 1, 0],\n                [0, 0, 1, 0, 1],\n                [0, 0, 0, 1, 0]\n            ]),\n            \"A2\": np.array([\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 1],\n                [0, 0, 0, 1, 0]\n            ]),\n            \"overlap_set\": set(),\n            \"omega\": 0.8\n        },\n        {\n            \"N\": 5,\n            \"A1\": np.array([\n                [0, 1, 0, 0, 0],\n                [1, 0, 1, 0, 0],\n                [0, 1, 0, 0, 0],\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0]\n            ]),\n            \"A2\": np.array([\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0],\n                [0, 0, 0, 1, 1],\n                [0, 0, 1, 0, 0],\n                [0, 0, 1, 0, 0]\n            ]),\n            \"overlap_set\": {2},\n            \"omega\": 0.5\n        },\n        {\n            \"N\": 5,\n            \"A1\": np.array([\n                [0, 1, 0, 0, 0],\n                [1, 0, 1, 0, 0],\n                [0, 1, 0, 1, 0],\n                [0, 0, 1, 0, 1],\n                [0, 0, 0, 1, 0]\n            ]),\n            \"A2\": np.array([\n                [0, 1, 0, 0, 0],\n                [1, 0, 1, 0, 0],\n                [0, 1, 0, 1, 0],\n                [0, 0, 1, 0, 0],\n                [0, 0, 0, 0, 0]\n            ]),\n            \"overlap_set\": {1, 2, 3},\n            \"omega\": 1.0\n        },\n        {\n            \"N\": 4,\n            \"A1\": np.array([\n                [0, 1, 1, 1],\n                [1, 0, 1, 1],\n                [1, 1, 0, 1],\n                [1, 1, 1, 0]\n            ]),\n            \"A2\": np.array([\n                [0, 1, 1, 1],\n                [1, 0, 1, 1],\n                [1, 1, 0, 1],\n                [1, 1, 1, 0]\n            ]),\n            \"overlap_set\": {0, 1, 2, 3},\n            \"omega\": 2.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        A1 = case[\"A1\"]\n        A2 = case[\"A2\"]\n        overlap_set = case[\"overlap_set\"]\n        omega = case[\"omega\"]\n\n        # Step 1: Construct the co-membership matrix D\n        d_vector = [1 if i in overlap_set else 0 for i in range(N)]\n        D = np.diag(d_vector)\n\n        # Step 2: Construct the supra-adjacency matrix S\n        S = np.block([\n            [A1, omega * D],\n            [omega * D, A2]\n        ])\n\n        # Step 3: Compute the largest eigenvalue of S\n        # Since S is real and symmetric, eigh is efficient and returns sorted eigenvalues\n        eigenvalues = np.linalg.eigh(S)[0]\n        lambda_max = eigenvalues[-1]\n\n        # Step 4: Compute the critical infection ratio tau_c\n        # Based on the problem's construction, lambda_max will be positive for these non-trivial graphs.\n        tau_c = 1 / lambda_max\n        \n        # Format result to 6 decimal places and add to list\n        results.append(f\"{tau_c:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然将流行病阈值与 $1/\\lambda_1$ 联系起来的近似方法是网络流行病学的基石，但理解其局限性至关重要。最后一个练习将挑战你批判性地评估该模型，重点关注高度异构网络中的特征向量局域化现象。你将探索为何这一简单预测可能失效的原因，并学习如何使用反参与率（Inverse Participation Ratio, IPR）作为诊断工具，来评估平均场近似的可靠性。",
            "id": "4273503",
            "problem": "考虑一个有限、连通的无向网络，由邻接矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 表示，其最大特征值为 $\\lambda_1$，相关联的单位范数主特征向量为 $v$（即 $\\sum_{i=1}^N v_i^2 = 1$）。该网络上的流行病传播遵循易感-感染-易感 (SIS) 动力学，感染率为 $\\beta$，恢复率为 $\\mu$，并采用追踪每个节点感染概率的节点级描述。在淬火平均场 (QMF) 近似中，非线性动力学在无病状态附近进行线性化，以评估该状态不稳定性的发生。对于某些网络，主特征向量 $v$ 是局域化的，这意味着其质量集中在一小部分节点上，而不是分散在整个网络中。局域化的一个标准度量是逆参与率 (IPR)，对于单位范数向量 $v$ 定义为 $I = \\sum_{i=1}^N v_i^4$。对于非局域化特征向量，$I$ 通常按 $O(1/N)$ 标度；而对于局域化特征向量，$I$ 可能按 $O(1)$ 标度。\n\n哪个选项最能解释为什么主特征向量的局域化会导致淬火平均场 (QMF) 方法在此类网络中预测出更低的流行病阈值，并提出了一个使用逆参与率 (IPR) 的、有科学依据的诊断方法，以标记 QMF 可能低估阈值的情况？\n\nA. 在 QMF 中，不稳定性的发生由 $A$ 的主特征对决定。当 $v$ 局域化时，不稳定方向对应于集中在一小组节点（例如，一个中心节点及其邻居）上的增长，QMF 将此解释为足以导致地方性流行，因为它忽略了动力学关联和全局传播约束。这导致 QMF 预测的阈值低于需要更非局域化激活的方法。一个有用的诊断方法是计算主特征向量的 IPR $I = \\sum_{i=1}^N v_i^4$ 及相关的有效规模 $N_{\\mathrm{eff}} = 1/I$；如果 $N_{\\mathrm{eff}}/N$ 很小或者 $I$ 不随 $N$ 消失，这就标记了 QMF 可能低估了阈值。\n\nB. 局域化会减小最大特征值 $\\lambda_1$，因为质量集中在少数节点上会削弱全网范围的耦合，从而增加了 QMF 预测的流行病阈值。一种诊断方法是计算 $I = \\sum_{i=1}^N v_i^2$，并在 $I$ 随 $N$ 增长时宣布为局域化。\n\nC. QMF 阈值仅取决于平均度，因此特征向量局域化不影响阈值预测。一种诊断方法是比较度方差与 IPR：如果度方差相对于 IPR 较高，则 QMF 会高估阈值。\n\nD. 局域化通常会产生近简并的主特征值，并迫使 QMF 依赖第二个特征值进行阈值预测，从而增加了阈值。一种诊断方法是计算 $I = \\sum_{i=1}^N v_i^4$，并在 $I$ 为 $O(1)$ 时宣布网络为非局域化，在 $I$ 为 $O(1/N)$ 时宣布为局域化。",
            "solution": "用户希望对问题陈述进行批判性验证，然后是详细的解决方案和选项评估。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   网络：一个有限、连通的无向网络。\n-   邻接矩阵：$A \\in \\mathbb{R}^{N \\times N}$。\n-   主特征值：$\\lambda_1$，$A$ 的最大特征值。\n-   主特征向量：$v$，与 $\\lambda_1$ 相关联且具有单位范数，$\\sum_{i=1}^N v_i^2 = 1$。\n-   动力学：易感-感染-易感 (SIS) 模型。\n-   参数：感染率 $\\beta$，恢复率 $\\mu$。\n-   近似：淬火平均场 (QMF) 近似，在无病状态附近线性化。\n-   局域化：主特征向量 $v$ 的质量集中在一小部分节点上的性质。\n-   局域化度量：逆参与率 (IPR)，定义为 $I = \\sum_{i=1}^N v_i^4$。\n-   IPR 的标度行为：对于非局域化特征向量，$I$ 按 $O(1/N)$ 标度。对于局域化特征向量，$I$ 按 $O(1)$ 标度。\n-   问题：解释为什么主特征向量的局域化导致 QMF 方法预测出更低的流行病阈值，并提出一个使用 IPR 来识别这种低估的诊断方法。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据充分：** 该问题牢固地建立在网络科学和数学流行病学这一成熟领域之内。SIS 模型、QMF 近似、在该近似中主特征值在确定流行病阈值中的作用、特征向量局域化的概念，以及使用 IPR 作为度量，都是科学文献中标准且有据可查的概念。所描述的现象——平均场理论由于局域化在异质网络上的失效——是一个著名的研究课题。该问题在事实上和科学上都是合理的。\n-   **问题适定：** 该问题要求一个概念性解释和一个相关的诊断方法，这是评估对科学原理理解的标准格式。在指定的理论框架内，存在一个清晰且唯一的答案。\n-   **客观性：** 问题使用该领域通用的精确技术语言（例如，“Quenched Mean-Field”、“principal eigenvector”、“Inverse Participation Ratio”）进行陈述。没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它在科学上合理，问题适定，客观且完整。我将继续推导解决方案。\n\n### 推导与选项分析\n\n**理论基础**\n\n节点级 SIS 模型下，节点 $i$ 在时间 $t$ 被感染的概率 $p_i(t)$ 的动力学可以被描述。淬火平均场 (QMF) 近似假设一个节点的邻居的感染状态是独立的。这导致了以下的微分方程组：\n$$\n\\frac{dp_i}{dt} = \\underbrace{-\\mu p_i}_{\\text{recovery}} + \\underbrace{(1-p_i) \\beta \\sum_{j=1}^N A_{ij} p_j}_{\\text{infection from neighbors}}\n$$\n其中 $\\beta$ 是每个受感染邻居的感染率，$\\mu$ 是恢复率，$A_{ij}$ 是邻接矩阵 $A$ 的元素。\n\n为了确定流行病阈值，我们分析无病状态（其中对所有 $i$ 都有 $p_i = 0$）的稳定性。我们引入一个小的扰动 $p_i(t) = \\epsilon_i(t)$，并在不动点 $\\vec{p} = \\vec{0}$ 附近将方程线性化：\n$$\n\\frac{d\\epsilon_i}{dt} \\approx -\\mu \\epsilon_i + (1-0) \\beta \\sum_{j=1}^N A_{ij} \\epsilon_j\n$$\n写成向量形式，其中 $\\vec{\\epsilon} = (\\epsilon_1, \\dots, \\epsilon_N)^T$，为：\n$$\n\\frac{d\\vec{\\epsilon}}{dt} = (-\\mu \\mathbf{I} + \\beta A) \\vec{\\epsilon}\n$$\n其中 $\\mathbf{I}$ 是 $N \\times N$ 单位矩阵。\n\n如果矩阵 $(-\\mu \\mathbf{I} + \\beta A)$ 至少有一个特征值的实部为正，则无病状态是不稳定的。该矩阵的特征值为 $-\\mu + \\beta \\lambda_k$，其中 $\\lambda_k$ 是 $A$ 的特征值。由于 $A$ 是无向图的邻接矩阵，其特征值为实数。不稳定性由最大特征值 $\\lambda_1$ 决定：\n$$\n-\\mu + \\beta \\lambda_1  0 \\implies \\frac{\\beta}{\\mu} \\lambda_1  1\n$$\n这定义了有效感染率 $\\beta/\\mu$ 的 QMF 流行病阈值：\n$$\n\\left(\\frac{\\beta}{\\mu}\\right)_c^{\\text{QMF}} = \\frac{1}{\\lambda_1}\n$$\n如果有效感染率超过此阈值，则预测会发生流行病。增长的扰动将具有与 $\\lambda_1$ 相关的主特征向量 $v$ 的形状。\n\n**局域化的影响**\n\n特征向量局域化意味着主特征向量 $v$ 的分量 $v_i$ 在一小部分节点上很大，而对大多数节点接近于零。上述线性稳定性分析预测，如果感染能在这个特征向量集中的、小的活动核心节点上自我维持，就会爆发流行病。QMF 模型实质上假设，如果这个局域化模式是不稳定的，感染将不可避免地扩散并遍及整个网络成为地方性流行。\n\n这一假设是 QMF 方法在此背景下的关键缺陷。流行病传播本质上是一个非线性过程。即使感染在一个小核心（例如，一个中心节点及其直接邻居）上能够自我维持，但如果连接不足，或者如果随机涨落在感染桥接到其他区域之前将其扑灭，它也可能无法“入侵”网络的其余部分（外围）。QMF模型作为一个确定性的线性化近似，忽略了这些关键的非线性、随机效应，以及控制从核心到外围实际传播的动力学关联。它将局部不稳定性误认为是必然的全局地方性流行。\n\n因此，QMF 预测的阈值 $1/\\lambda_1$ 通常过低（即，它低估了引发流行病的难度）。真实的阈值更高，因为需要更强的感染率来确保感染不仅在核心上存活，而且能成功地传播到并定殖于网络的其余部分。\n\n**IPR 的诊断作用**\n\n逆参与率 $I = \\sum_{i=1}^N v_i^4$ 是一个衡量局域化的絕佳指标。对于一个完全非局域化的向量，其中 $v_i = 1/\\sqrt{N}$，我们得到 $I = \\sum (1/N^2) = N/N^2 = 1/N$。对于一个完全局域化的向量，其中 $v_k = 1$ 且 $v_{i \\neq k} = 0$，我们得到 $I = 1$。\n\n量 $N_{\\text{eff}} = 1/I$ 可以解释为参与该特征向量模式的节点的“有效数量”。\n-   如果 $v$ 是非局域化的，$I = O(1/N)$，所以 $N_{\\text{eff}} = O(N)$。有效规模与系统规模成正比。\n-   如果 $v$ 是局域化的，$I = O(1)$，所以 $N_{\\text{eff}} = O(1)$。有效规模与系统規模无关。\n\n一个小的比率 $N_{\\text{eff}}/N = 1/(IN)$ 表明特征向量集中在网络节点的一小部分上。这正是 QMF 近似预计会因低估真实流行病阈值而失效的条件。因此，计算主特征向量的 IPR 并检查 $I$ 是否为 $O(1)$（或者 $N_{\\text{eff}}/N$ 是否很小）可作为一个有科学依据的诊断方法，以标记那些 QMF 预测可能不可靠且过低的网络。\n\n### 逐项选项分析\n\n**A. 在 QMF 中，不稳定性的发生由 $A$ 的主特征对决定。当 $v$ 局域化时，不稳定方向对应于集中在一小组节点（例如，一个中心节点及其邻居）上的增长，QMF 将此解释为足以导致地方性流行，因为它忽略了动力学关联和全局传播约束。这导致 QMF 预测的阈值低于需要更非局域化激活的方法。一个有用的诊断方法是计算主特征向量的 IPR $I = \\sum v_i^4$ 及相关的有效规模 $N_{\\mathrm{eff}} = 1/I$；如果 $N_{\\mathrm{eff}}/N$ 很小或者 $I$ 不随 $N$ 消失，这就标记了 QMF 可能低估了阈值。**\n-   该选项正确地指出 QMF 阈值基于主特征对 $(\\lambda_1, v)$。它准确地将局域化描述为集中在少数节点上的增长。它指出了 QMF 的确切失败之处：忽略了动力学关联和全局传播动力学。它正确地得出结论，这会导致低估（一个更低的预测阈值）。最后，它提出了使用 IPR $I = \\sum v_i^4$ 和有效参与数 $N_{\\text{eff}} = 1/I$ 的正确诊断方法，并正确指出小的 $N_{\\text{eff}}/N$ 或不随 $N$ 消失的 $I$ 是 QMF 失效的标志。\n-   **结论：正确。**\n\n**B. 局域化会减小最大特征值 $\\lambda_1$ 因为质量集中在少数节点上会削弱全网范围的耦合，从而增加了 QMF 预测的流行病阈值。一种诊断方法是计算 $I = \\sum_{i=1}^N v_i^2$ 并在 $I$ 随 $N$ 增长时宣布为局域化。**\n-   局域化会减小 $\\lambda_1$ 的前提通常是错误的。在异质网络（如无标度网络）中，这是表现出特征向量局域化的经典例子，$\\lambda_1$ 通常非常大，经常随 $N$ 或 $N$ 的幂次标度。正是这个大的 $\\lambda_1$ 导致了平均场理论预测的极小阈值。QMF 阈值增加的结论也是不正确的。提议的诊断方法 $I = \\sum_{i=1}^N v_i^2$ 只是向量的平方范数，根据问题定义，它被固定为 1，而不是局域化的度量。\n-   **结论：不正确。**\n\n**C. QMF 阈值仅取决于平均度，因此特征向量局域化不影响阈值预测。一种诊断方法是比较度方差与 IPR：如果度方差相对于 IPR 较高，则 QMF 会高估阈值。**\n-   QMF 阈值取决于平均度的前提是错误的。QMF 阈值是 $(\\beta/\\mu)_c = 1/\\lambda_1$。另一种近似，异质平均场 (HMF) 理论，得出的阈值是 $(\\beta/\\mu)_c = \\langle k \\rangle / \\langle k^2 \\rangle$，这取决于度分布的矩。该选项混淆了不同的平均场理论。QMF *高估* 阈值的结论与已知结果相反。\n-   **结论：不正确。**\n\n**D. 局域化通常会产生近简并的主特征值，并迫使 QMF 依赖第二个特征值进行阈值预测，从而增加了阈值。一种诊断方法是计算 $I = \\sum_{i=1}^N v_i^4$，并在 $I$ 为 $O(1)$ 时宣布网络为非局域化，在 $I$ 为 $O(1/N)$ 时宣布为局域化。**\n-   局域化通常不会产生简并的主特征值。对于一个连通的无向图，佩龙-弗罗贝尼乌斯定理保证 $\\lambda_1$ 是单重的（非简并的）。QMF 会转而使用 $\\lambda_2$ 的想法是没有根据的；分析是基于增长最快的模式，而该模式总是与 $\\lambda_1$ 相关联。此外，该选项颠倒了 IPR 的标度定义：$I \\sim O(1)$ 表示局域化，而 $I \\sim O(1/N)$ 表示非局域化，而不是反过来。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}