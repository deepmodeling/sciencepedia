{
    "hands_on_practices": [
        {
            "introduction": "我们的动手实践始于最基本的构建模块。该练习要求您使用第一步分析法，为一个简单的两状态系统推导平均首达时间（MFPT）。掌握这一基础计算对于建立关于跃迁速率如何直接决定到达目标状态的期望时间的直觉至关重要。",
            "id": "2654448",
            "problem": "考虑一个具有 $2$ 个状态（标记为 $1$ 和 $2$）的可逆单分子反应网络，代表化学物种间的相互转化 $X_1 \\rightleftharpoons X_2$。该动力学被建模为一个连续时间马尔可夫链（CTMC），其从状态 $1$ 到状态 $2$ 的转移速率为常数 $k_{12}$，从状态 $2$ 到状态 $1$ 的转移速率为常数 $k_{21}$。假设满足标准的马尔可夫跳跃过程假设：等待时间呈指数分布，其参数等于当前状态的出射速率之和，且转移是无记忆的。\n\n定义平均首达时间（MFPT）$T_i$ 为从状态 $i$ 出发首次到达状态 $2$ 的期望时间。使用基于指数等待时间定义和马尔可夫性质的首步分析法，推导 $T_1$ 的方程，并求解以获得一个用 $k_{12}$ 和 $k_{21}$ 表示的闭式表达式。明确陈述你所施加的任何边界条件，并从物理上解释其合理性。\n\n将您关于 $T_1$ 的最终答案以秒为单位，用 $k_{12}$ 和 $k_{21}$ 表示成一个单一的闭式解析表达式。不要进行四舍五入。",
            "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n首先，从问题陈述中逐字提取已知条件：\n- 一个具有 $2$ 个状态（标记为 $1$ 和 $2$）的可逆单分子反应网络。\n- 该网络代表相互转化 $X_1 \\rightleftharpoons X_2$。\n- 动力学被建模为一个连续时间马尔可夫链（CTMC）。\n- 从状态 $1$ 到状态 $2$ 的转移速率为常数 $k_{12}$。\n- 从状态 $2$ 到状态 $1$ 的转移速率为常数 $k_{21}$。\n- 适用标准的马尔可夫跳跃过程假设：等待时间呈指数分布和无记忆性转移。\n- 平均首达时间（MFPT）$T_i$ 是从状态 $i$ 出发首次到达状态 $2$ 的期望时间。\n- 任务是使用首步分析法推导 $T_1$ 的方程并求解。\n\n其次，根据所需标准对问题进行验证。\n- **科学依据：** 该问题基于连续时间马尔可夫链的标准理论，这是化学动力学和随机过程中的一个基本工具。平均首达时间的概念及其通过首步分析的推导是标准的、完善的程序。该问题在科学上是合理的。\n- **适定性：** 该问题对一个双态 CTMC 进行了完整描述，并要求计算一个特定的、可计算的量 ($T_1$)。此计算所需的所有必要参数 ($k_{12}$) 均已提供。该问题是适定的，并有唯一解。\n- **客观性：** 该问题使用精确、无歧义的数学和科学术语进行陈述。它不含主观或推测性内容。\n\n该问题未违反任何指定的无效标准。这是一个化学动力学中的标准、可形式化的问题。速率 $k_{21}$ 虽然被指定，但最终与计算*到*状态 $2$ 的首达时间无关，因为根据定义，过程在首次到达此目标状态时即停止。这不构成矛盾，而是此类问题的常见特征，旨在测试学生识别相关信息的能力。\n\n结论是该问题是 **有效的**。将提供解答。\n\n目标是求出系统从状态 $1$ 开始到状态 $2$ 的平均首达时间（MFPT）。设系统在时间 $t$ 的状态为 $X(t) \\in \\{1, 2\\}$。从状态 $i$ 到状态 $j$ 的 MFPT 记为 $T_{i \\to j}$。这里，我们关心的是 $T_{1 \\to 2}$，问题中记为 $T_1$。形式上，$T_i = E[\\tau_2 | X(0) = i]$，其中 $\\tau_2 = \\inf\\{t \\ge 0 : X(t) = 2\\}$ 是到状态 $2$ 的首达时间。\n\n所采用的方法是首步分析法，该方法以无穷小时间间隔 $\\Delta t$ 内的第一个事件为条件。\n\n首先，我们建立边界条件。问题要求的是首次到达状态 $2$ 的期望时间。如果过程从状态 $2$ 开始（即 $i=2$），那么它在时间 $t=0$ 时就已经到达了目标状态。因此，所用时间为零。边界条件是：\n$$T_2 = 0$$\n\n现在，我们推导 $T_1$ 的方程。考虑系统在时间 $t=0$ 时从状态 $1$ 开始。我们在一个微小的时间间隔 $[0, \\Delta t]$ 内分析该过程。根据 CTMC 的性质，在此间隔内从状态 $1$ 转移到状态 $2$ 的概率是 $k_{12} \\Delta t + o(\\Delta t)$，其中 $o(\\Delta t)$ 表示比 $\\Delta t$ 更快趋于零的项。相应地，停留在状态 $1$ 的概率是 $1 - k_{12} \\Delta t + o(\\Delta t)$。\n\n根据全期望定律，我们可以将 $T_1$ 写成以第一个时间间隔 $\\Delta t$ 内发生的事件为条件的期望结果之和：\n$$T_1 = E[\\tau_2 | \\text{jump to } 2 \\text{ in } \\Delta t] P(\\text{jump to } 2 \\text{ in } \\Delta t) + E[\\tau_2 | \\text{no jump in } \\Delta t] P(\\text{no jump in } \\Delta t)$$\n\n我们来分析每一项：\n1. 如果在 $\\Delta t$ 内发生从状态 $1$ 到状态 $2$ 的跃迁，经过的时间近似为 $\\Delta t$。一旦进入状态 $2$，到达状态 $2$ 的剩余期望时间为 $T_2$。这种情况下总的期望时间是 $\\Delta t + T_2$。\n2. 如果没有发生跃迁，经过的时间是 $\\Delta t$。由于马尔可夫过程的无记忆性，系统仍处于状态 $1$，从此刻起到达状态 $2$ 的剩余期望时间仍然是 $T_1$。这种情况下总的期望时间是 $\\Delta t + T_1$。\n\n将这些及其各自的概率代入方程，得到：\n$$T_1 = (\\Delta t + T_2)(k_{12} \\Delta t + o(\\Delta t)) + (\\Delta t + T_1)(1 - k_{12} \\Delta t + o(\\Delta t))$$\n\n现在，我们代入边界条件 $T_2=0$：\n$$T_1 = (\\Delta t)(k_{12} \\Delta t + o(\\Delta t)) + (\\Delta t + T_1)(1 - k_{12} \\Delta t + o(\\Delta t))$$\n展开表达式：\n$$T_1 = k_{12}(\\Delta t)^2 + o(\\Delta t^2) + \\Delta t + T_1 - k_{12}(\\Delta t)^2 - k_{12}T_1\\Delta t + o(\\Delta t)$$\n我们合并各项，并认识到 $(\\Delta t)^2$ 项相互抵消，所有高阶项可以合并为一个单一的 $o(\\Delta t)$ 项：\n$$T_1 = T_1 + \\Delta t - k_{12} T_1 \\Delta t + o(\\Delta t)$$\n从两边减去 $T_1$ 得：\n$$0 = \\Delta t - k_{12} T_1 \\Delta t + o(\\Delta t)$$\n整个方程除以 $\\Delta t$（其中 $\\Delta t \\neq 0$）：\n$$0 = 1 - k_{12} T_1 + \\frac{o(\\Delta t)}{\\Delta t}$$\n取极限 $\\Delta t \\to 0$，根据定义，项 $\\frac{o(\\Delta t)}{\\Delta t}$ 趋于 $0$。这就得出了关于 $T_1$ 的最终线性方程：\n$$1 - k_{12} T_1 = 0$$\n这就是问题所要求的关于 $T_1$ 的方程。求解 $T_1$ 是很简单的：\n$$k_{12} T_1 = 1$$\n$$T_1 = \\frac{1}{k_{12}}$$\n\n这个结果在物理上是直观的。系统处于状态 $1$，唯一的逃逸路径通向目标状态 $2$。在状态 $1$ 的等待时间服从速率参数为 $k_{12}$ 的指数分布。该指数分布的均值为 $1/k_{12}$。因此，离开状态 $1$（从而首次到达状态 $2$）的平均时间恰好是 $1/k_{12}$。速率 $k_{21}$ 是无关的，因为该过程被定义为一旦到达状态 $2$ 即停止，这使得状态 $2$ 对于此特定计算成为一个吸收态。如果速率 $k_{12}$ 和 $k_{21}$ 的单位是秒的倒数 ($s^{-1}$)，那么 $T_1$ 的单位将是秒。",
            "answer": "$$\\boxed{\\frac{1}{k_{12}}}$$"
        },
        {
            "introduction": "从连续时间过程转向离散时间过程，这个问题探索了一个更复杂的场景，涉及一个带有“瞬移”机制的有向网络。您将为平均首达时间建立并求解一个线性方程组，这是一种适用于任何离散马尔可夫链的通用方法。这个练习还揭示了一个与直觉相悖的现象：增加捷径有时反而会增加到达目标的时间，从而加深您对网络拓扑如何影响动态过程的理解。",
            "id": "4286948",
            "problem": "考虑一个在有向网络上的离散时间随机游走，网络节点为 $\\{t, v, a, b\\}$，其中目标节点 $t$ 是吸收节点。在每一步，游走者以 $1-\\alpha$ 的概率从出边中均匀随机选择一条进行移动；以 $\\alpha$ 的概率根据一个固定的个性化分布 $q$ 传送到一个节点。这种传送是一个 PageRank 风格的机制，它没有过去状态的记忆，并且独立于当前所在的节点。从起始节点 $i$ 到吸收目标节点 $t$ 的平均首次到达时间（MFPT）定义为，在上述动力学过程中，从 $i$ 出发首次到达 $t$ 所需的期望步数。\n\n网络和动力学过程的具体规定如下：\n- 节点 $t$ 是吸收节点。\n- 节点 $v$ 有指向 $t$ 和 $a$ 的出边，且没有其他出边。\n- 节点 $a$ 仅有一条指向节点 $b$ 的出边。\n- 节点 $b$ 仅有一条指向节点 $v$ 的出边。\n- 传送个性化分布 $q$ 在 $t$ 和 $v$ 上的概率质量为零，且 $q_{a} = q_{b} = \\frac{1}{2}$。\n\n任务：\n1. 仅使用马尔可夫链的第一性原理和平均首次到达时间（MFPT）的定义，解释在何种结构性条件下，增加传送机制会悖论性地增加到某些低度目标节点的 MFPT。你的解释必须从网关节点、度的异质性以及 $q$ 的支撑集之间的相互作用来论证，而不是引用任何预先给定的快捷公式。\n2. 对于上述描述的具体网络和传送方案，计算当 $\\alpha = \\frac{3}{10}$ 时，从节点 $v$ 到吸收目标节点 $t$ 的 MFPT。将最终的 MFPT 表示为一个精确的有理数，不要进行四舍五入。",
            "solution": "该问题被评估为科学上合理、内容自洽、良定的，并且没有任何指定的使其无效的缺陷。这是一个关于网络上随机过程理论的有效问题。\n\n该问题包含两部分。第一部分任务是为一个网络科学中的已知现象提供概念性解释。第二部分是为一个给定的网络进行具体计算。\n\n**第一部分：概念性解释**\n\n从起始节点 $i$ 到吸收目标节点 $t$ 的平均首次到达时间（MFPT），记为 $m_i$，由一个基本递推关系决定。对于一个从节点 $i$ 到节点 $j$ 的转移概率为 $P'_{ij}$ 的一般离散时间马尔可夫过程，到吸收态 $t$（其中 $m_t = 0$）的 MFPT 满足以下方程：\n$$m_i = 1 + \\sum_{j} P'_{ij} m_j$$\n对所有非目标节点 $i$ 成立。其中 ‘$1$’ 表示当前所走的一步，求和项表示从下一个状态 $j$ 开始的未来期望步数，这个期望是对所有可能的下一状态取平均得到的。\n\n在给定的问题中，转移机制是标准随机游走和传送事件的凸组合。设 $P_{ij}$ 为在标准随机游走下从 $i$ 转移到 $j$ 的概率，其中出边是均匀随机选择的。对于一个出度为 $k_{out}(i)$ 的节点 $i$，如果存在一条从 $i$ 到 $j$ 的边，则 $P_{ij} = 1/k_{out}(i)$，否则 $P_{ij} = 0$。传送以概率 $\\alpha$ 发生，目标节点 $j$ 根据个性化分布 $q_j$ 选择。因此，复合转移概率 $P'_{ij}$ 为：\n$$P'_{ij} = (1-\\alpha) P_{ij} + \\alpha q_j$$\n\n将此代入 MFPT 方程可得：\n$$m_i = 1 + \\sum_j \\left( (1-\\alpha) P_{ij} + \\alpha q_j \\right) m_j = 1 + (1-\\alpha)\\sum_j P_{ij} m_j + \\alpha \\sum_j q_j m_j$$\n让我们将在传送分布下的期望 MFPT 表示为 $\\langle m \\rangle_q = \\sum_j q_j m_j$。此项与起始节点 $i$ 无关。方程变为：\n$$m_i = 1 + (1-\\alpha) \\left( \\sum_{j} P_{ij} m_j \\right) + \\alpha \\langle m \\rangle_q$$\n\n由于传送（一种通常与加速混合时间相关的机制）而导致 MFPT 增加的悖论，可以通过前面提到的三个结构性因素的相互作用来解释：\n\n1.  **网关节点 (Gateway Nodes):** 网络中可能存在“网关”节点，它们是提供通往目标快速路径的关键瓶颈点。在给定的问题中，节点 $v$ 是一个网关节点，因为它是唯一一个有直接边指向吸收目标节点 $t$ 的瞬态节点。到达 $v$ 的随机游走者在没有传送的情况下，有非零概率在下一步到达目标。\n\n2.  **网络异质性与陷阱区域 (Network Heterogeneity and Trapping Regions):** 网络结构不是均匀的。它既包含通往目标的快速路径（从网关 $v$ 出发），也包含一个“慢速”区域，在本例中即为环路 $a \\to b \\to v$。如果一个游走者位于节点 $a$ 或 $b$，它至少需要走两步（$a \\to b \\to v$）才能回到网关节点 $v$，并从那里才能访问目标。这样的区域可以起到陷阱的作用。\n\n3.  **传送分布 $q$ 的支撑集 (Support of the Teleportation Distribution $q$):** 关键因素是传送将游走者导向何处。当分布 $q$ 的结构不利于到达目标时，就会出现 MFPT 悖论性增加的现象。这种情况发生在 $q$ 将其概率质量集中在“远离”目标的节点上，而对目标本身或网关节点赋予很少或没有概率质量时。在这个问题中，$q_t=0$ 和 $q_v=0$，但 $q_a=1/2$ 和 $q_b=1/2$。这意味着传送事件永远不会将游走者直接带到目标或网关节点。相反，它总是将游走者置于慢速陷阱区域的节点 $a$ 或 $b$。\n\n当从一个“好”节点（如网关 $v$）出发时，悖论就产生了。在没有传送（$\\alpha=0$）的情况下，位于 $v$ 的游走者有 $1/2$ 的概率在一步内到达 $t$。而有传送（$\\alpha>0$）时，这个有利的随机游走步骤有 $\\alpha$ 的概率被中断。游走者被迫传送到 $a$ 或 $b$。从这两个节点中的任意一个出发，它都必须遍历环路才能回到 $v$。这种被迫的绕路为期望路径长度增加了多个步骤。虽然从 $v$ 出发的随机游走部分仍以 $1-\\alpha$ 的概率存在，但以 $\\alpha$ 概率引入一个保证的“坏跳转”会增加总的期望时间。如果传送到陷阱区域所导致的时间惩罚足够大，它将超过从网关直接路径带来的好处，从而导致从该网关节点出发的 MFPT 总体增加。目标节点的低度是产生这种网关结构的常见特征，因为它限制了通往目标的入口点数量。\n\n**第二部分：MFPT 计算**\n\n我们需要计算从节点 $v$ 到 $t$ 的 MFPT，记为 $m_v$。我们还必须找到从其他瞬态节点 $a$ 和 $b$ 出发的 MFPT，即 $m_a$ 和 $m_b$。从吸收目标节点出发的 MFPT 为 $m_t = 0$。传送参数为 $\\alpha = 3/10$。\n\nMFPT 的线性方程组是：\n$$m_i = 1 + \\sum_{j \\in \\{t,v,a,b\\}} P'_{ij} m_j \\quad \\text{for } i \\in \\{v, a, b\\}$$\n转移概率 $P'_{ij} = (1-\\alpha) P_{ij} + \\alpha q_j$ 需要对每个起始节点 $i$ 进行计算。\n\n**$m_v$ 的方程：**\n在随机游走中，$v$ 的出邻居是 $t$ 和 $a$，所以 $P_{vt} = P_{va} = 1/2$。\n$m_v = 1 + P'_{vt} m_t + P'_{vv} m_v + P'_{va} m_a + P'_{vb} m_b$\n在 $m_t=0$, $\\alpha=3/10$, $q=(q_t,q_v,q_a,q_b)=(0,0,1/2,1/2)$ 且 $1-\\alpha=7/10$ 的条件下：\n$P'_{vt} = (7/10)(1/2) + (3/10)(0) = 7/20$\n$P'_{vv} = (7/10)(0) + (3/10)(0) = 0$\n$P'_{va} = (7/10)(1/2) + (3/10)(1/2) = (7/20) + (3/20) = 10/20 = 1/2$\n$P'_{vb} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$m_v$ 的方程为：\n$m_v = 1 + (0)m_v + (1/2)m_a + (3/20)m_b \\implies m_v = 1 + \\frac{1}{2}m_a + \\frac{3}{20}m_b$ (1)\n\n**$m_a$ 的方程：**\n$a$ 的出邻居是 $b$，所以 $P_{ab} = 1$。\n$m_a = 1 + P'_{at} m_t + P'_{av} m_v + P'_{aa} m_a + P'_{ab} m_b$\n$P'_{aa} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$P'_{ab} = (7/10)(1) + (3/10)(1/2) = 7/10 + 3/20 = 14/20 + 3/20 = 17/20$\n$m_a$ 的方程为：\n$m_a = 1 + (3/20)m_a + (17/20)m_b$\n$m_a(1 - 3/20) = 1 + (17/20)m_b$\n$m_a(17/20) = 1 + (17/20)m_b \\implies m_a = \\frac{20}{17} + m_b$ (2)\n\n**$m_b$ 的方程：**\n$b$ 的出邻居是 $v$，所以 $P_{bv} = 1$。\n$m_b = 1 + P'_{bt} m_t + P'_{bv} m_v + P'_{ba} m_a + P'_{bb} m_b$\n$P'_{bv} = (7/10)(1) + (3/10)(0) = 7/10$\n$P'_{ba} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$P'_{bb} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$m_b$ 的方程为：\n$m_b = 1 + (7/10)m_v + (3/20)m_a + (3/20)m_b$\n$m_b(1-3/20) = 1 + (7/10)m_v + (3/20)m_a$\n$m_b(17/20) = 1 + \\frac{7}{10}m_v + \\frac{3}{20}m_a$ (3)\n\n现在我们解这个三元线性方程组。\n将方程 (2) 代入方程 (3)：\n$\\frac{17}{20}m_b = 1 + \\frac{7}{10}m_v + \\frac{3}{20}(\\frac{20}{17} + m_b)$\n$\\frac{17}{20}m_b = 1 + \\frac{7}{10}m_v + \\frac{3}{17} + \\frac{3}{20}m_b$\n$(\\frac{17}{20} - \\frac{3}{20})m_b = (1 + \\frac{3}{17}) + \\frac{7}{10}m_v$\n$\\frac{14}{20}m_b = \\frac{20}{17} + \\frac{7}{10}m_v$\n$\\frac{7}{10}m_b = \\frac{20}{17} + \\frac{7}{10}m_v$\n乘以 $10/7$:\n$m_b = \\frac{10}{7}\\left(\\frac{20}{17} + \\frac{7}{10}m_v\\right) = \\frac{200}{119} + m_v$ (4)\n\n现在将方程 (2) 和方程 (4) 代入方程 (1) 来求解 $m_v$：\n首先，使用 (2) 和 (4) 将 $m_a$ 用 $m_v$ 表示：\n$m_a = \\frac{20}{17} + m_b = \\frac{20}{17} + (\\frac{200}{119} + m_v) = \\frac{20 \\cdot 7}{17 \\cdot 7} + \\frac{200}{119} + m_v = \\frac{140}{119} + \\frac{200}{119} + m_v = \\frac{340}{119} + m_v$\n\n将 $m_a$ 和 $m_b$ 的表达式代入方程 (1)：\n$m_v = 1 + \\frac{1}{2}(\\frac{340}{119} + m_v) + \\frac{3}{20}(\\frac{200}{119} + m_v)$\n$m_v = 1 + \\frac{170}{119} + \\frac{1}{2}m_v + \\frac{30}{119} + \\frac{3}{20}m_v$\n合并常数项：\n$1 + \\frac{170}{119} + \\frac{30}{119} = \\frac{119}{119} + \\frac{170}{119} + \\frac{30}{119} = \\frac{119+170+30}{119} = \\frac{319}{119}$\n合并右侧的 $m_v$ 项：\n$\\frac{1}{2}m_v + \\frac{3}{20}m_v = (\\frac{10}{20} + \\frac{3}{20})m_v = \\frac{13}{20}m_v$\n$m_v$ 的方程变为：\n$m_v = \\frac{319}{119} + \\frac{13}{20}m_v$\n$m_v - \\frac{13}{20}m_v = \\frac{319}{119}$\n$m_v (1 - \\frac{13}{20}) = \\frac{319}{119}$\n$m_v (\\frac{7}{20}) = \\frac{319}{119}$\n$m_v = \\frac{319}{119} \\cdot \\frac{20}{7}$\n由于 $119 = 7 \\cdot 17$ 且 $319 = 11 \\cdot 29$，分子和分母没有公因数。\n$m_v = \\frac{319 \\cdot 20}{119 \\cdot 7} = \\frac{6380}{833}$\n该分数是不可约分的。",
            "answer": "$$\\boxed{\\frac{6380}{833}}$$"
        },
        {
            "introduction": "为了将理论与计算应用联系起来，这最后一个练习要求您编写一个程序来研究小世界网络的特性。通过计算平均首达时间，并将其与路径长度和直径等结构指标进行比较，您将凭经验验证网络科学的一个基石：少数随机捷径如何能极大地缩短在大型网络中的遍历时间。这项练习提供了在复杂图上模拟和分析随机过程的直接动手经验。",
            "id": "4286927",
            "problem": "给定一个无向图族，该族图的构建方法是：从一个一维周期性晶格（环）开始，然后添加少量随机放置的快捷边。考虑在此类图上的离散时间简单随机游走：在每个时间步，位于节点 $i$ 的游走者会从其邻居中均匀随机地选择一个并移动到那里。我们关注的量是平均首次通过时间（MFPT），定义为从指定的源节点开始，随机游走首次到达目标节点所需的期望步数。形式上，从节点 $i$ 到节点 $j$ 的平均首次通过时间（MFPT）是命中时间 $T_{ij}$ 的期望值，其中 $T_{ij}$ 是在初始位置为 $i$ 的条件下，随机游走位置首次等于 $j$ 的时间 $t$。所有有序源-目标对的平均MFPT用 $\\langle T \\rangle$ 表示，它是 $T_{ij}$ 在所有 $i \\neq j$ 的有序对 $(i,j)$ 上的平均值。\n\n您的任务是实现一个完整的程序，该程序能够：\n- 构建一个包含 $N$ 个节点的环形晶格图，其中节点 $i$ 与节点 $(i-1) \\bmod N$ 和 $(i+1) \\bmod N$ 之间有无向边连接。\n- 通过从所有尚未被晶格中的边连接的非相邻节点对中，无放回地均匀随机选择 $m$ 个无序对，并在每个选定的对之间插入无向边，来添加 $m$ 条快捷边。每个测试用例都指定一个随机种子，以使快捷边的选择可复现。\n- 对每个生成的图，计算：\n    1. 图上离散时间简单随机游走的所有不同节点有序对 $(i,j)$ 的平均首次通过时间 $\\langle T \\rangle$。\n    2. 平均测地线长度 $\\langle d \\rangle$，定义为在使用未加权边的情况下，所有 $i \\neq j$ 的有序对 $(i,j)$ 的最短路径距离 $d(i,j)$ 的平均值。\n    3. 图直径 $D$，定义为所有无序对 $\\{i,j\\}$ 的 $d(i,j)$ 的最大值。\n\n计算的基本原理：\n- 将随机游走视为一个时间齐次马尔可夫链，其转移矩阵为 $P = (p_{ij})$，其中 $p_{ij}$ 等于从节点 $i$ 移动到节点 $j$ 的一步概率，对于邻接矩阵 $A$ 和节点 $i$ 的度 $k_i$，$p_{ij} = A_{ij}/k_i$。\n- 将从 $i$ 到 $j$ 的命中时间定义为从 $i$ 开始的链首次访问 $j$ 的时间。MFPT 是其期望值。\n- 仅使用马尔可夫链和吸收态的基本定义来构建计算方法以获得 $\\langle T \\rangle$；不要假定任何专门的快捷公式。\n\n数值细节和单位：\n- 时间以随机游走的离散步数计量。将 $\\langle T \\rangle$ 报告为以“步”为单位的实数。\n- 距离以最短路径中的边数计量。将 $\\langle d \\rangle$ 报告为实数，$D$ 报告为整数。\n\n测试套件：\n- 案例 1：$N = 60$，$m = 0$，种子 $= 1$。\n- 案例 2：$N = 60$，$m = 3$，种子 $= 1$。\n- 案例 3：$N = 90$，$m = 0$，种子 $= 2$。\n- 案例 4：$N = 90$，$m = 4$，种子 $= 2$。\n- 案例 5：$N = 90$，$m = 1$，种子 $= 42$。\n\n程序要求：\n- 对于每个测试用例，按规定构建图，计算 $\\langle T \\rangle$、$\\langle d \\rangle$ 和 $D$，并按指定的输出格式汇总结果。\n- 最终输出格式必须是单行文本，包含一个由方括号括起来的、以逗号分隔的各测试用例结果列表。每个用例的结果本身必须是包含三个值的列表，顺序为 $[\\langle T \\rangle,\\langle d \\rangle,D]$。例如：$[[t_1,d_1,D_1],[t_2,d_2,D_2],\\ldots]$。\n- 将 $\\langle T \\rangle$ 和 $\\langle d \\rangle$ 表示为十进制浮点数，$D$ 表示为整数。数值必须直接打印，不带额外单位。\n\n您的实现必须完全自包含且可直接运行。不允许外部输入。程序应使用提供的种子进行可复现的随机性操作，并且不应依赖任何外部文件或网络访问。程序必须为给定的测试套件精确计算所有量，并仅按指定格式打印单行最终输出。",
            "solution": "该问题定义明确，并基于图论和马尔可夫链理论的既定原理。它要求为一类被称为小世界网络的图计算关键的网络度量指标——平均测地线距离、直径和平均首次通过时间。求解过程首先构建指定的图，然后基于基本定义计算所需的度量指标。\n\n计算过程分为三个主要部分：图的构建、测地线路径度量的计算以及平均首次通过时间的计算。\n\n**1. 图的构建**\n\n对于每个测试用例，我们给定节点数 $N$、快捷边数 $m$ 以及用于可复现性的随机种子。一个无向图由其邻接矩阵 $A$ 表示，这是一个 $N \\times N$ 的对称矩阵，如果节点 $i$ 和 $j$ 之间存在边，则 $A_{ij}=1$，否则 $A_{ij}=0$。\n\n首先，构建一个一维周期性晶格（环）。这是通过在每个节点 $i$ 与其邻居 $(i-1) \\pmod N$ 和 $(i+1) \\pmod N$ 之间创建边来实现的，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n\n接下来，添加 $m$ 条快捷边。生成所有可能的非相邻节点无序对的集合。使用测试用例中指定的种子值的随机数生成器，从该集合中无放回地均匀随机选择 $m$ 个对。对于每个选定的对 $\\{u,v\\}$，更新邻接矩阵中相应的条目，使得 $A_{uv} = A_{vu} = 1$。得到的矩阵 $A$ 代表了将要计算度量指标的最终图。\n\n**2. 测地线路径度量：直径 ($D$) 和平均距离 ($\\langle d \\rangle$)**\n\n在无权图中，两个节点 $i$ 和 $j$ 之间的测地线距离 $d(i,j)$ 是连接它们的最短路径中的边数。通过从图中每个节点开始执行广度优先搜索 (BFS) 算法，可以系统地计算所有节点对的这些距离。这种所有点对最短路径计算的结果是一个距离矩阵 $\\mathbf{D}$，其中条目 $\\mathbf{D}_{ij} = d(i,j)$。\n\n根据距离矩阵 $\\mathbf{D}$，按如下方式计算所需的度量指标：\n- 图直径 $D$ 是图中任意两个节点之间的最大距离。由于图是无向的，$d(i,j) = d(j,i)$，直径是距离矩阵中的最大值：\n$$ D = \\max_{i,j} d(i,j) $$\n- 平均测地线长度 $\\langle d \\rangle$ 是所有不同节点有序对的最短路径距离的平均值。它通过将距离矩阵的所有非对角线元素相加，然后除以这类对的总数 $N(N-1)$ 来计算：\n$$ \\langle d \\rangle = \\frac{1}{N(N-1)} \\sum_{i=0}^{N-1} \\sum_{j=0, j \\neq i}^{N-1} d(i,j) $$\n\n**3. 平均首次通过时间 ($\\langle T \\rangle$)**\n\n图上的简单随机游走是一个离散时间马尔可夫链。状态空间是节点集合 $\\{0, 1, \\dots, N-1\\}$。从节点 $i$ 移动到节点 $j$ 的转移概率 $P_{ij}$ 仅在它们之间有边连接时非零，此时概率为 $1/k_i$，其中 $k_i = \\sum_j A_{ij}$ 是节点 $i$ 的度。因此，转移矩阵为 $P = (P_{ij})$，其中 $P_{ij} = A_{ij}/k_i$。\n\n平均首次通过时间 (MFPT) $T_{ij}$ 是从源节点 $i$ 开始首次到达目标节点 $j$ 所需的期望步数。问题要求从基本原理出发进行计算。这可以通过考虑一个修改过的过程来实现，其中目标节点 $j$ 是一个吸收态。\n\n对于一个固定的目标节点 $j$，从任何其他节点 $i \\neq j$ 到 $j$ 的 MFPT 满足以下递推关系，该关系通过对游走的第一步进行条件化得到：\n$$ T_{ij} = 1 + \\sum_{k=0}^{N-1} P_{ik} T_{kj} $$\n这个方程表明，从 $i$ 到达 $j$ 的时间是 $1$ 步加上从新节点 $k$ 出发的期望剩余时间。我们使用边界条件，即从目标到达目标本身的时间为零，$T_{jj} = 0$。\n\n对于一个固定的目标 $j$，这为 $N-1$ 个未知值 $\\{T_{ij} | i \\neq j\\}$ 定义了一个包含 $N-1$ 个线性方程的方程组。设 $S' = \\{0, 1, \\dots, N-1\\} \\setminus \\{j\\}$ 为瞬态（非目标）状态的集合。对于任何 $i \\in S'$，方程为：\n$$ T_{ij} = 1 + \\sum_{k \\in S'} P_{ik} T_{kj} + P_{ij}T_{jj} = 1 + \\sum_{k \\in S'} P_{ik} T_{kj} $$\n整理各项，我们得到：\n$$ T_{ij} - \\sum_{k \\in S'} P_{ik} T_{kj} = 1, \\quad \\forall i \\in S' $$\n这可以表示为矩阵形式。设 $\\mathbf{t}_j$ 是一个大小为 $N-1$ 的列向量，包含所有 $i \\in S'$ 的 $T_{ij}$ 值。设 $Q_j$ 是 $P$ 的一个 $(N-1) \\times (N-1)$ 子矩阵，对应于瞬态 $S'$ 之间的转移。该方程组变为：\n$$ \\mathbf{t}_j - Q_j \\mathbf{t}_j = \\mathbf{1} $$\n其中 $\\mathbf{1}$ 是一个大小为 $N-1$ 的全一列向量。这可以写作：\n$$ (I - Q_j) \\mathbf{t}_j = \\mathbf{1} $$\n其中 $I$ 是 $(N-1) \\times (N-1)$ 的单位矩阵。\n\n到目标 $j$ 的 MFPT 向量 $\\mathbf{t}_j$ 可以通过求解这个线性方程组得到。为了数值稳定性和效率，这比直接计算矩阵逆 $(I-Q_j)^{-1}$ 更可取。对 $N$ 个可能的目标节点 $j \\in \\{0, 1, \\dots, N-1\\}$ 中的每一个重复此过程，使我们能够填充完整的 MFPT 矩阵 $\\mathbf{T} = (T_{ij})$。\n\n最后，通过对所有 $N(N-1)$ 个不同的源和目标节点的有序对的 $T_{ij}$ 进行平均，计算出平均首次通过时间 $\\langle T \\rangle$：\n$$ \\langle T \\rangle = \\frac{1}{N(N-1)} \\sum_{i=0}^{N-1} \\sum_{j=0, j \\neq i}^{N-1} T_{ij} $$\n\n实现将遵循这个三部分结构对每个测试用例进行处理，为每组参数生成所需的 $[\\langle T \\rangle, \\langle d \\rangle, D]$ 列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse.csgraph import shortest_path\n\ndef compute_metrics(N, m, seed):\n    \"\"\"\n    Constructs a graph and computes its average MFPT, average geodesic length, and diameter.\n\n    Args:\n        N (int): The number of nodes in the graph.\n        m (int): The number of random shortcut edges to add.\n        seed (int): The seed for the random number generator.\n\n    Returns:\n        list: A list containing [...]\n    \"\"\"\n    # Due to a generation error, the code is incomplete.\n    pass\n```"
        }
    ]
}