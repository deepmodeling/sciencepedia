{
    "hands_on_practices": [
        {
            "introduction": "为了打下坚实的基础，我们的第一个实践是推导 k-正则图的流行病阈值。这个练习  展示了线性稳定性分析的核心方法，并在一个清晰、理想化的场景中，建立了阈值与网络谱特性之间的基本联系。",
            "id": "4309101",
            "problem": "考虑一个在具有 $n$ 个节点的有限、简单、无向、连通的 $k$-正则图上的连续时间易感-感染-易感（SIS）传染病过程，其邻接矩阵记为 $A \\in \\mathbb{R}^{n \\times n}$。每个受感染节点以速率 $\\delta  0$ 恢复，每个易感节点以速率 $\\beta  0$ 被其每个受感染的邻居感染。设有效传播率为 $\\tau = \\beta / \\delta$。在 N-交织平均场近似（NIMFA）下，令 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 受感染的概率，并将这些概率收集成向量 $p(t) \\in \\mathbb{R}^{n}$。通过在无病平衡点 $p(t) = 0$ 附近将 NIMFA 动力学线性化，用邻接矩阵 $A$ 的谱来分析该平衡点的稳定性。从第一性原理出发，并且只使用关于非负矩阵谱的经过充分检验的结论，推导出流行病阈值 $\\tau_{c}$ 作为 $A$ 的最大特征值的函数，然后将您的结果具体化到给定的 $k$-正则图上。您的最终答案必须是一个仅含 $k$ 的封闭形式解析表达式。不要提供中间的阈值不等式。最终答案必须是精确的，没有四舍五入，并且不包含任何单位。",
            "solution": "在尝试求解之前，对所述问题进行验证。\n\n### 步骤 1：提取已知条件\n\n-   **模型：** 连续时间易感-感染-易感（SIS）传染病过程。\n-   **网络：** 一个具有 $n$ 个节点的有限、简单、无向、连通的 $k$-正则图。\n-   **邻接矩阵：** $A \\in \\mathbb{R}^{n \\times n}$。\n-   **恢复速率：** $\\delta  0$。\n-   **感染速率：** 每个易感节点以速率 $\\beta  0$ 被其每个受感染的邻居感染。\n-   **有效传播率：** $\\tau = \\beta / \\delta$。\n-   **近似方法：** N-交织平均场近似（NIMFA）。\n-   **状态变量：** $p_i(t)$ 是节点 $i$ 在时间 $t$ 受感染的概率。这些概率的向量是 $p(t) \\in \\mathbb{R}^{n}$。\n-   **目标：**\n    1.  在无病平衡点 $p(t) = 0$ 附近将 NIMFA 动力学线性化。\n    2.  使用邻接矩阵 $A$ 的谱分析该平衡点的稳定性。\n    3.  推导出流行病阈值 $\\tau_c$ 作为 $A$ 的最大特征值的函数。\n    4.  将结果具体化到给定的 $k$-正则图上。\n    5.  最终答案必须是一个仅含 $k$ 的封闭形式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据指定标准对问题进行审查：\n\n-   **科学依据：** 该问题牢固地植根于数学流行病学和网络科学的既定领域。SIS 模型、平均场近似和平衡点稳定性分析都是标准的、经过充分验证的方法论。\n-   **适定性：** 所有必要的参数（$\\beta$, $\\delta$）、网络属性（$k$-正则，连通）和分析方法（NIMFA，线性化）都已明确定义。目标是推导一个特定的量 $\\tau_c$，从而得到一个唯一且有意义的解。\n-   **客观性：** 问题以精确的数学和科学语言表述，没有任何主观性或模糊性。\n\n问题陈述没有表现出任何指定的缺陷（例如，科学上不健全、不完整、矛盾）。这是一个理论流行病学中的标准、可形式化的问题。\n\n### 步骤 3：结论与行动\n\n问题是有效的。将按要求从第一性原理推导解答。\n\n### 推导\n\n节点 $i$ 在时间 $t$ 受感染的概率 $p_i(t)$ 的动力学是在 N-交织平均场近似（NIMFA）下建模的。$p_i(t)$ 的变化率由感染率和恢复率之间的平衡决定。\n\n一个受感染的节点 $i$（概率为 $p_i$）以恒定速率 $\\delta$ 恢复。这对变化率贡献了 $-\\delta p_i$ 这一项。\n\n一个易感节点 $i$（概率为 $1 - p_i$）通过与其受感染邻居的接触而被感染。在适用于线性化的 NIMFA 的一种常见表述中，来自邻居的感染压力被视为可加的。易感节点 $i$ 被感染的速率为 $\\beta (1-p_i) \\sum_{j=1}^{n} A_{ij} p_j$，其中如果节点 $i$ 和 $j$ 相连，则 $A_{ij}=1$，否则 $A_{ij}=0$。\n\n结合这些项，NIMFA 动力学系统由以下 $n$ 个耦合常微分方程组描述：\n$$\n\\frac{dp_i}{dt} = \\beta (1 - p_i) \\sum_{j=1}^{n} A_{ij} p_j - \\delta p_i, \\quad \\text{for } i = 1, \\dots, n.\n$$\n无病平衡点（DFE）是所有节点都处于易感状态，即对所有 $i$ 都有 $p_i = 0$。我们可以通过将其代入方程来验证 $p = 0$ 确实是一个平衡点，这会得到 $\\frac{dp_i}{dt} = 0$。\n\n为了分析 DFE 的稳定性，我们在 $p = 0$ 附近对系统进行线性化。令 $f_i(p) = \\beta (1 - p_i) \\sum_{j=1}^{n} A_{ij} p_j - \\delta p_i$。线性化系统为 $\\frac{dp}{dt} = J p$，其中 $J$ 是在 DFE 处计算的雅可比矩阵，其元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial p_j}|_{p=0}$。\n\n我们计算偏导数：\n对于 $i \\neq j$：\n$$\n\\frac{\\partial f_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j} \\left[ \\beta (1 - p_i) \\sum_{k=1}^{n} A_{ik} p_k - \\delta p_i \\right] = \\beta (1 - p_i) A_{ij}.\n$$\n在 $p = 0$（因此 $p_i=0$）处求值，我们得到 $J_{ij} = \\beta A_{ij}$。\n\n对于 $i = j$：\n$$\n\\frac{\\partial f_i}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ \\beta (1 - p_i) \\sum_{k=1}^{n} A_{ik} p_k - \\delta p_i \\right] = -\\beta \\sum_{k=1}^{n} A_{ik} p_k + \\beta(1-p_i)A_{ii} - \\delta.\n$$\n由于图是简单的，所以 $A_{ii}=0$。在 $p=0$ 处求值，我们得到 $J_{ii} = -\\delta$。\n\n因此，DFE 处的雅可比矩阵为 $J = \\beta A - \\delta I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。线性化系统为 $\\frac{dp}{dt} = (\\beta A - \\delta I) p$。\n\nDFE 的稳定性由 $J$ 的特征值决定。如果 $J$ 的所有特征值都具有负实部，则 DFE 是稳定的；如果至少有一个特征值具有正实部，则 DFE 是不稳定的。流行病阈值是 $J$ 的任何特征值的最大实部为零的条件。\n\n设 $\\lambda_m$ 是邻接矩阵 $A$ 的一个特征值，对应的特征向量为 $v_m$。由于图是无向的，$A$ 是一个实对称矩阵，其所有特征值 $\\lambda_m$ 都是实数。\n$J$ 的特征值 $\\mu_m$ 与 $A$ 的特征值相关：\n$$\nJ v_m = (\\beta A - \\delta I) v_m = \\beta (A v_m) - \\delta v_m = \\beta \\lambda_m v_m - \\delta v_m = (\\beta \\lambda_m - \\delta) v_m.\n$$\n因此，$J$ 的特征值为 $\\mu_m = \\beta \\lambda_m - \\delta$。\n\n稳定性由 $J$ 的最大特征值决定，记为 $\\mu_{\\max}$：\n$$\n\\mu_{\\max} = \\max_{m} (\\mu_m) = \\max_{m} (\\beta \\lambda_m - \\delta) = \\beta (\\max_m \\lambda_m) - \\delta = \\beta \\lambda_{\\max} - \\delta.\n$$\n这里，$\\lambda_{\\max}$ 是邻接矩阵 $A$ 的最大特征值。由于图是连通的，其邻接矩阵 $A$ 是不可约的非负矩阵。根据 Perron-Frobenius 定理，$\\lambda_{\\max}$ 是实的、正的且是单重的。\n\n如果 DFE 是不稳定的，即 $\\mu_{\\max} > 0$，则流行病可以出现并持续：\n$$\n\\beta \\lambda_{\\max} - \\delta > 0 \\implies \\frac{\\beta}{\\delta} \\lambda_{\\max} > 1.\n$$\n使用有效传播率的定义 $\\tau = \\beta / \\delta$，流行病爆发的条件是 $\\tau \\lambda_{\\max} > 1$。\n\n流行病阈值 $\\tau_c$ 是稳定性发生变化的 $\\tau$ 的临界值。这发生在 $\\mu_{\\max} = 0$ 时，得到：\n$$\n\\tau_c \\lambda_{\\max} = 1 \\implies \\tau_c = \\frac{1}{\\lambda_{\\max}}.\n$$\n这是任何网络上 NIMFA 模型的一般流行病阈值，用其邻接矩阵的最大特征值表示。\n\n问题要求我们将此结果具体化到一个 $k$-正则图。如果每个节点的度都为 $k$，则该图是 $k$-正则的。这个性质意味着邻接矩阵 $A$ 的每一行和都等于 $k$：\n$$\n\\sum_{j=1}^{n} A_{ij} = k \\quad \\text{for all } i=1, \\dots, n.\n$$\n考虑全 1 向量 $\\mathbf{1} = (1, 1, \\dots, 1)^T$。$A$ 对 $\\mathbf{1}$ 的作用是：\n$$\n(A\\mathbf{1})_i = \\sum_{j=1}^{n} A_{ij} (1) = k.\n$$\n因此，$A\\mathbf{1} = k\\mathbf{1}$。这表明 $k$ 是 $A$ 的一个特征值，其特征向量为 $\\mathbf{1}$。\n\n对于任何图，最大特征值都受最大度的限制，即 $\\lambda_{\\max} \\leq k_{\\max}$。对于一个 $k$-正则图，$k_{\\max} = k$。由于我们已经找到了一个等于 $k$ 的特征值，它必须是最大特征值。因此，对于一个 $k$-正则图，$\\lambda_{\\max} = k$。\n\n将这个结果代入流行病阈值的一般表达式中：\n$$\n\\tau_c = \\frac{1}{k}.\n$$\n这是在 NIMFA 下，$k$-正则图上流行病阈值的最终表达式。",
            "answer": "$$\\boxed{\\frac{1}{k}}$$"
        },
        {
            "introduction": "现实世界的网络很少是同质的。这个实践  通过分析星形图（一个具有中心枢纽节点的典型例子），来探讨结构异质性的影响。你将发现“超级传播者”节点的存在如何显著降低流行病阈值，这是理解真实系统中疾病动态的关键洞见。",
            "id": "4309082",
            "problem": "考虑一个静态、简单、无向的星形图 $S_{n}$ 上的易感-感染-易感 (SIS) 传染过程。该图有 $n$ 个节点，由一个中心节点（标签为 $0$）连接到 $n-1$ 个叶节点（标签为 $1,2,\\dots,n-1$）组成，叶节点之间没有边。设每次接触的感染率为 $\\beta$，每个节点的恢复率为 $\\mu$。在淬火平均场 (QMF) 近似中，令 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 被感染的概率，并通过因子分解来处理动力学相关性，使得节点感染状态的乘积近似为其概率的乘积。以此近似为基础，对所有 $p_{i}(t)=0$ 的无病平衡点进行线性稳定性分析。从第一性原理出发，根据 $S_{n}$ 的邻接矩阵 $A$ 的谱性质推导小扰动的增长条件，然后求解 $S_{n}$ 相应的特征值问题，以获得淬火平均场流行病阈值，即无病状态失去稳定性时的临界感染率 $\\beta_{c}$。请用 $n$ 和 $\\mu$ 的闭式解析表达式表示 $\\beta_{c}$ 的最终答案。此外，请基于你推导出的谱结构，简要定性地解释 $S_{n}$ 中中心节点的主导作用如何影响该阈值。",
            "solution": "该问题要求使用淬火平均场 (QMF) 近似，求解星形图 $S_n$ 上易感-感染-易感 (SIS) 模型的流行病阈值 $\\beta_c$。推导过程通过对无病平衡点进行线性稳定性分析来完成。\n\n首先，我们建立节点 $i$ 在时间 $t$ 被感染的概率 $p_i(t)$ 的动力学方程。对于 SIS 过程，一个易感节点 $i$ 可能被其任何一个已感染的邻居感染，而一个已感染的节点 $i$ 可以恢复并再次变为易感状态。\n一个已感染节点 $i$ 的恢复率为 $\\mu$，因此对 $p_i(t)$ 变化的贡献是 $-\\mu p_i(t)$。\n一个易感节点 $i$（概率为 $1-p_i(t)$）在其至少一个邻居被感染并传播疾病时被感染。来自已感染邻居 $j$ 的传播率为 $\\beta$。在 QMF 近似中，邻居 $j$ 被感染的概率被独立地处理为 $p_j(t)$。节点 $i$ 被感染的总概率通量是 $i$ 为易感的概率 $(1-p_i(t))$ 与其从邻域接收感染的速率的乘积。该速率由 $\\beta \\sum_{j} A_{ij} p_j(t)$ 给出，其中 $A$ 是图的邻接矩阵（如果节点 $i$ 和 $j$ 相连，则 $A_{ij}=1$，否则为 $0$）。\n\n综合这些项，节点 $i$ 感染概率演化的 QMF 方程为：\n$$\n\\frac{dp_i(t)}{dt} = -\\mu p_i(t) + (1-p_i(t)) \\beta \\sum_{j=0}^{n-1} A_{ij} p_j(t)\n$$\n这是一个包含 $n$ 个耦合非线性常微分方程的方程组。\n\n无病平衡点 (DFE) 是所有节点都处于易感状态，即对所有 $i \\in \\{0, 1, \\dots, n-1\\}$ 都有 $p_i = 0$。为了确定该平衡点的稳定性，我们进行线性稳定性分析。我们考虑在 DFE 周围的一个小扰动 $\\epsilon_i(t)$，使得 $p_i(t) = 0 + \\epsilon_i(t)$，其中 $|\\epsilon_i(t)| \\ll 1$。将此代入 QMF 方程并保留 $\\epsilon_i$ 的一阶项进行线性化：\n$$\n\\frac{d\\epsilon_i(t)}{dt} = -\\mu \\epsilon_i(t) + (1-\\epsilon_i(t)) \\beta \\sum_{j=0}^{n-1} A_{ij} \\epsilon_j(t)\n$$\n$$\n\\frac{d\\epsilon_i(t)}{dt} \\approx -\\mu \\epsilon_i(t) + \\beta \\sum_{j=0}^{n-1} A_{ij} \\epsilon_j(t)\n$$\n项 $-\\epsilon_i(t) \\beta \\sum_{j} A_{ij} \\epsilon_j(t)$ 是 $\\mathcal{O}(\\epsilon^2)$ 阶的，因此被忽略。\n以向量形式表示，其中 $\\vec{\\epsilon}(t) = (\\epsilon_0(t), \\epsilon_1(t), \\dots, \\epsilon_{n-1}(t))^T$，线性化方程组为：\n$$\n\\frac{d\\vec{\\epsilon}(t)}{dt} = (\\beta A - \\mu I) \\vec{\\epsilon}(t)\n$$\n其中 $I$ 是 $n \\times n$ 的单位矩阵。DFE 的稳定性由雅可比矩阵 $J = \\beta A - \\mu I$ 的特征值决定。如果 $J$ 的所有特征值都具有负实部，则 DFE 是稳定的。如果至少有一个特征值具有正实部，则流行病可能爆发。流行病阈值对应于 $J$ 的最大特征值变为零的临界条件。\n\n$J$ 的特征值（记为 $\\lambda_k$）与邻接矩阵 $A$ 的特征值（记为 $\\Lambda_k$）之间的关系为 $\\lambda_k = \\beta \\Lambda_k - \\mu$。由于 $A$ 是一个简单无向图的邻接矩阵，它是实对称的，其所有特征值 $\\Lambda_k$ 都是实数。因此，$J$ 的最大特征值是 $\\lambda_{max} = \\beta \\Lambda_{max} - \\mu$，其中 $\\Lambda_{max}$ 是 $A$ 的最大特征值（其谱半径）。\n\n流行病阈值 $\\beta_c$ 在这个最大特征值为零时找到：\n$$\n\\beta_c \\Lambda_{max} - \\mu = 0 \\implies \\beta_c = \\frac{\\mu}{\\Lambda_{max}}\n$$\n这就建立了用 $A$ 的谱性质表示的增长条件。下一步是求出星形图 $S_n$ 的 $\\Lambda_{max}$。\n\n星形图 $S_n$ 有 $n$ 个节点：一个中心节点（节点 $0$）连接到 $n-1$ 个叶节点（节点 $1, \\dots, n-1$）。邻接矩阵 $A$（以中心节点为第一行/列）为：\n$$\nA = \\begin{pmatrix}\n0  1  1  \\dots  1 \\\\\n1  0  0  \\dots  0 \\\\\n1  0  0  \\dots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n1  0  0  \\dots  0\n\\end{pmatrix}\n$$\n特征值方程为 $A\\mathbf{v} = \\Lambda \\mathbf{v}$，其中 $\\mathbf{v} = (v_0, v_1, \\dots, v_{n-1})^T$。这对应于以下方程组：\n1. $\\sum_{j=1}^{n-1} v_j = \\Lambda v_0$\n2. 对于每个 $i \\in \\{1, 2, \\dots, n-1\\}$，有 $v_0 = \\Lambda v_i$\n\n从方程 (2) 可知，如果 $\\Lambda \\neq 0$，那么特征向量的所有叶节点分量都相等：$v_i = v_0 / \\Lambda$。一个非平凡解要求 $v_0 \\neq 0$（否则所有 $v_i=0$）。将此代入方程 (1)：\n$$\n\\sum_{j=1}^{n-1} \\left(\\frac{v_0}{\\Lambda}\\right) = \\Lambda v_0\n$$\n$$\n(n-1)\\frac{v_0}{\\Lambda} = \\Lambda v_0\n$$\n因为 $v_0 \\neq 0$，我们可以两边同除以它得到：\n$$\n\\frac{n-1}{\\Lambda} = \\Lambda \\implies \\Lambda^2 = n-1 \\implies \\Lambda = \\pm\\sqrt{n-1}\n$$\n这给出了两个不同的特征值：$\\sqrt{n-1}$ 和 $-\\sqrt{n-1}$。\n\n如果 $\\Lambda = 0$，方程 (2) 给出 $v_0 = 0$。方程 (1) 则变为 $\\sum_{j=1}^{n-1} v_j = 0$。这个条件定义了一个 $(n-2)$ 维的特征向量子空间。因此，$\\Lambda=0$ 是一个几何（和代数）重数为 $n-2$ 的特征值。\n\n$S_n$ 的邻接矩阵 $A$ 的完整特征值谱是 $\\{\\sqrt{n-1}, -\\sqrt{n-1}, 0, \\dots, 0\\}$，其中 $0$ 的重数为 $n-2$。最大特征值是谱半径：\n$$\n\\Lambda_{max} = \\sqrt{n-1}\n$$\n将此代入我们的流行病阈值表达式中，我们得到：\n$$\n\\beta_c = \\frac{\\mu}{\\sqrt{n-1}}\n$$\n\n对该结果的定性解释突显了中心节点的主导作用。流行病阈值 $\\beta_c$ 与叶节点数量的平方根 $\\sqrt{n-1}$ 成反比，这也是中心节点度的平方根。对于一个大的星形图（$n \\to \\infty$），阈值 $\\beta_c \\to 0$。这意味着星形网络结构对流行病极其脆弱；如果网络足够大，即使是极小的感染率也足以引起爆发。\n\n这种极端的脆弱性是中心节点主导作用的直接后果，而谱性质捕捉到了这一点。谱半径 $\\Lambda_{max} = \\sqrt{n-1}$ 是衡量网络放大扰动能力的一个指标。一个大的 $\\Lambda_{max}$ 意味着网络结构极大地促进了传播。与 $\\Lambda_{max}$ 对应的特征向量，其最大分量局域在中心节点上，表明初期的流行病主要集中在中心节点。中心节点扮演着“超级传播者”的角色，能高效地从任何叶节点接收感染，并将其传播给所有其他叶节点。QMF 阈值正确地捕捉了这种效应，显示出比均匀近似（其阈值将与平均度 $\\langle k \\rangle \\approx 2$ 成比例）低得多的阈值，并形式化地说明了中心主导节点如何使整个系统变得脆弱。",
            "answer": "$$\\boxed{\\frac{\\mu}{\\sqrt{n-1}}}$$"
        },
        {
            "introduction": "理论为流行病阈值提供了多种模型，但我们如何为特定网络选择合适的模型呢？这最后一个实践  是一个连接理论与应用的计算练习。通过计算聚类系数和度异质性等关键结构指标，你将学会应用一个启发式框架，为不同的网络拓扑结构确定最合适的理论近似方法。",
            "id": "4309023",
            "problem": "考虑无向简单图上的易感-感染-易感 (SIS) 过程。目标是根据可测量的网络结构特性，为每个给定的网络决定哪种流行病阈值近似方法最为合适。您必须编写一个完整的程序，对于每个测试用例，根据网络的无向邻接矩阵 $A$ 计算以下量：\n\n- 度序列 $\\{k_i\\}_{i=1}^n$，其中 $k_i = \\sum_{j=1}^n A_{ij}$。\n- 度异质性 $H = \\dfrac{\\langle k^2 \\rangle}{\\langle k \\rangle^2}$，其中 $\\langle \\cdot \\rangle$ 表示对所有节点的平均。\n- 边的度-度皮尔逊同配性 $r$，定义为每条边两端节点度的皮尔逊相关系数。如果没有边，或者边端点度的方差为零，则取 $r = 0$。\n- 平均聚类系数 $C$，定义为所有节点上局部聚类系数 $C_i$ 的平均值。对于度 $k_i \\ge 2$ 的节点 $i$，$C_i = \\dfrac{\\text{节点 }i\\text{ 的邻居之间的边数}}{\\binom{k_i}{2}}$；如果 $k_i  2$，则取 $C_i = 0$。\n- 邻接矩阵 $A$ 的谱半径 $\\rho(A)$，定义为 $A$ 的特征值的最大绝对值。\n- 非回溯矩阵 $B$ 的谱半径 $\\rho(B)$。矩阵 $B$ 由 $A$ 的有向边集合构造如下：对于每条无向边 $\\{u,v\\}$，包含有向边 $(u \\to v)$ 和 $(v \\to u)$；然后，当且仅当 $v = x$ 且 $y \\ne u$ 时，$B_{(u \\to v),(x \\to y)} = 1$，否则 $B_{(u \\to v),(x \\to y)} = 0$。\n\n然后，您的程序必须根据以下决策规则推荐三种阈值近似方法中的一种，这些规则完全以计算出的网络度量来表示：\n\n- 如果 $C \\ge 0.1$，推荐非回溯算子近似（代码 $2$）。\n- 否则，如果 $|r| \\ge 0.2$ 或 $H \\ge 3.0$，推荐邻接算子（淬火平均场）近似（代码 $0$）。\n- 否则，推荐基于度的（异质平均场）近似（代码 $1$）。\n\n对于每个测试用例，仅输出与推荐的近似方法相对应的整数代码，使用以下映射：邻接算子 $0$，基于度的 $1$，非回溯算子 $2$。\n\n您的程序必须处理以下由其邻接矩阵给出的无向网络测试套件。对于每个矩阵 $A^{(t)}$，节点索引从 $0$ 到 $n-1$，$A^{(t)}_{ij} = 1$ 表示节点 $i$ 和 $j$ 之间有边，否则 $A^{(t)}_{ij} = 0$；所有 $A^{(t)}$ 都是对称且对角线为零的。\n\n- 测试用例 1（一个以节点 0 为中心的 6 节点星形图）：\n$$\nA^{(1)} =\n\\begin{pmatrix}\n0  1  1  1  1  1 \\\\\n1  0  0  0  0  0 \\\\\n1  0  0  0  0  0 \\\\\n1  0  0  0  0  0 \\\\\n1  0  0  0  0  0 \\\\\n1  0  0  0  0  0\n\\end{pmatrix}.\n$$\n\n- 测试用例 2（一个 8 节点环状格点，每个节点连接到两个最近的邻居）：\n$$\nA^{(2)}_{ij} = \n\\begin{cases}\n1  \\text{如果 } j = (i-1) \\bmod 8 \\text{ 或 } j = (i+1) \\bmod 8, \\\\\n0  \\text{否则}.\n\\end{cases}\n$$\n\n- 测试用例 3（一个 3 节点三角形）：\n$$\nA^{(3)} =\n\\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix}.\n$$\n\n- 测试用例 4（一个 5 节点完全图）：\n$$\nA^{(4)}_{ij} =\n\\begin{cases}\n0  \\text{如果 } i = j, \\\\\n1  \\text{如果 } i \\ne j.\n\\end{cases}\n$$\n\n最终输出格式要求：您的程序应生成单行输出，其中包含按顺序排列的测试用例结果，形式为方括号括起来的逗号分隔列表，例如 $[a_1,a_2,a_3,a_4]$，其中每个 $a_t$ 是测试用例 $t$ 的整数代码。",
            "solution": "问题陈述已经过验证，并被认为是有效的。它在网络科学和流行病学领域有科学依据，定义明确，目标清晰，没有矛盾或含糊不清之处。我们可以着手解决问题。\n\n任务是为一个给定网络上的易感-感染-易感 (SIS) 模型推荐一种合适的流行病阈值近似方法。推荐是根据一组基于网络计算出的结构特性的启发式规则来确定的。对于每个提供的邻接矩阵 $A$，我们必须计算几个网络度量，并按指定顺序应用决策规则。\n\n决策逻辑所需的度量是度异质性 $H$、度-度同配性 $r$ 和平均聚类系数 $C$。决策规则如下：\n1.  如果 $C \\ge 0.1$，推荐非回溯算子近似（代码 $2$）。\n2.  否则，如果 $|r| \\ge 0.2$ 或 $H \\ge 3.0$，推荐邻接算子近似（代码 $0$）。\n3.  否则，推荐基于度的近似（代码 $1$）。\n\n我们将为四个测试用例中的每一个系统地计算这些度量，并应用规则来确定适当的推荐代码。问题还要求计算谱半径 $\\rho(A)$ 和 $\\rho(B)$，这将在附带的程序中完成，但这些值本身并未用于决策逻辑。\n\n**1. 度量定义**\n\n设 $A$ 是一个有 $n$ 个节点的简单无向图的邻接矩阵。\n- **度序列**：节点 $i$ 的度是 $k_i = \\sum_{j=1}^n A_{ij}$。\n- **度异质性 $H$**：$H = \\dfrac{\\langle k^2 \\rangle}{\\langle k \\rangle^2}$，其中 $\\langle k^m \\rangle = \\frac{1}{n} \\sum_{i=1}^n k_i^m$。\n- **同配性 $r$**：网络中所有边端点度的皮尔逊相关系数。设 $E$ 为边集。我们构造两个列表 $K_1$ 和 $K_2$，包含每条边两端节点的度。那么 $r = \\text{PearsonCorr}(K_1, K_2)$。如果边数为零或边端点度的方差为零，则 $r=0$。\n- **平均聚类系数 $C$**：$C = \\frac{1}{n} \\sum_{i=1}^n C_i$。节点 $i$ 的局部聚类系数是 $C_i = \\frac{T_i}{\\binom{k_i}{2}}$，其中 $T_i$ 是连接到节点 $i$ 的三角形数量（或其邻居之间的边数）。$T_i$ 可以计算为 $\\frac{1}{2} \\sum_{j,l} A_{ij}A_{jl}A_{li} = \\frac{(A^3)_{ii}}{2}$。如果 $k_i  2$，我们取 $C_i=0$。\n\n**2. 测试用例分析**\n\n**测试用例 1：6 节点星形图**\n- 邻接矩阵 $A^{(1)}$ 表示一个以节点 0 为中心的星形图。\n- **度**：中心节点的度为 $k_0 = 5$。五个外围节点每个的度为 $k_i = 1$（对于 $i \\in \\{1, ..., 5\\}$）。\n- **度异质性 $H$**：\n  $$ \\langle k \\rangle = \\frac{5 + 5 \\times 1}{6} = \\frac{10}{6} = \\frac{5}{3} $$\n  $$ \\langle k^2 \\rangle = \\frac{5^2 + 5 \\times 1^2}{6} = \\frac{25 + 5}{6} = 5 $$\n  $$ H = \\frac{\\langle k^2 \\rangle}{\\langle k \\rangle^2} = \\frac{5}{(5/3)^2} = \\frac{5}{25/9} = \\frac{45}{25} = 1.8 $$\n- **同配性 $r$**：所有边都连接中心节点（度为 5）和一个外围节点（度为 1）。所有边的度对都是 $(5,1)$。边两端度的列表方差为零。因此，根据问题定义，$r=0$。\n- **聚类系数 $C$**：\n  - 对于中心节点 ($i=0$)，$k_0=5$。其邻居为 $\\{1,2,3,4,5\\}$。这些邻居之间没有边。因此，$C_0=0$。\n  - 对于外围节点 ($i \\in \\{1,...,5\\}$)，$k_i=1$。由于 $k_i  2$，因此 $C_i=0$。\n  - 平均聚类系数为 $C = \\frac{1}{6}\\sum_i C_i = 0$。\n- **决策**：\n  1. $C \\ge 0.1$ 吗？否 ($0  0.1$)。\n  2. $|r| \\ge 0.2$ 或 $H \\ge 3.0$ 吗？否 ($|0|  0.2$ 且 $1.8  3.0$)。\n  3. 否则：推荐代码 $1$。\n- **用例 1 的结果**：$1$。\n\n**测试用例 2：8 节点环状格点**\n- 该图是一个循环图 $C_8$，它是一个 2-正则图。\n- **度**：每个节点的度都为 $k_i = 2$。\n- **度异质性 $H$**：对于任何正则图，所有度都相同，因此 $\\langle k^2 \\rangle = k^2$ 且 $\\langle k \\rangle = k$。于是，$H = \\frac{k^2}{k^2} = 1$。\n- **同配性 $r$**：这是一个正则图，所以任何边两端的度都是 $(2,2)$。方差为零，所以 $r=0$。\n- **聚类系数 $C$**：对于任何节点 $i$，其邻居之间不相连。三角形的数量为 $0$。因此，对于所有 $i$，$C_i=0$，平均值为 $C=0$。\n- **决策**：\n  1. $C \\ge 0.1$ 吗？否 ($0  0.1$)。\n  2. $|r| \\ge 0.2$ 或 $H \\ge 3.0$ 吗？否 ($|0|  0.2$ 且 $1  3.0$)。\n  3. 否则：推荐代码 $1$。\n- **用例 2 的结果**：$1$。\n\n**测试用例 3：3 节点三角形**\n- 该图是一个完全图 $K_3$，它是一个 2-正则图。\n- **度**：每个节点的度都为 $k_i = 2$。\n- **度异质性 $H$**：该图是正则的，所以 $H=1$。\n- **同配性 $r$**：该图是正则的，所以 $r=0$。\n- **聚类系数 $C$**：对于任何节点 $i$，它的两个邻居是相连的，形成一个三角形。\n  $$ C_i = \\frac{\\text{邻居之间的边数}}{\\binom{k_i}{2}} = \\frac{1}{\\binom{2}{2}} = 1 $$\n  平均聚类系数为 $C=1$。\n- **决策**：\n  1. $C \\ge 0.1$ 吗？是 ($1 \\ge 0.1$)。\n  2. 推荐代码 $2$。\n- **用例 3 的结果**：$2$。\n\n**测试用例 4：5 节点完全图**\n- 该图是一个完全图 $K_5$，它是一个 4-正则图。\n- **度**：每个节点的度都为 $k_i = 4$。\n- **度异质性 $H$**：该图是正则的，所以 $H=1$。\n- **同配性 $r$**：该图是正则的，所以 $r=0$。\n- **聚类系数 $C$**：对于任何节点 $i$，它的 $k_i=4$ 个邻居形成一个完全图 $K_4$。它们之间的边数是 $\\binom{4}{2} = 6$。\n  $$ C_i = \\frac{\\text{邻居之间的边数}}{\\binom{k_i}{2}} = \\frac{6}{\\binom{4}{2}} = \\frac{6}{6} = 1 $$\n  平均聚类系数为 $C=1$。\n- **决策**：\n  1. $C \\ge 0.1$ 吗？是 ($1 \\ge 0.1$)。\n  2. 推荐代码 $2$。\n- **用例 4 的结果**：$2$。\n\n按顺序排列的测试用例的最终推荐代码列表是 $[1, 1, 2, 2]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_network(A):\n    \"\"\"\n    Computes network metrics and returns the recommended approximation code.\n\n    The function computes all metrics specified in the problem, though not all\n    are used in the final decision logic.\n    \"\"\"\n    n = A.shape[0]\n    if n == 0:\n        return 1 # Default for an empty graph\n\n    # --- Compute Degree-based metrics ---\n    k = A.sum(axis=1)\n    \n    # Degree Heterogeneity H\n    mean_k = k.mean()\n    if mean_k == 0:\n        H = 0.0 # Graph with no edges\n    else:\n        mean_k2 = (k**2).mean()\n        H = mean_k2 / (mean_k**2)\n\n    # --- Compute Assortativity r ---\n    edges = np.where(np.triu(A, 1))\n    num_edges = len(edges[0])\n\n    if num_edges == 0:\n        r = 0.0\n    else:\n        deg_u = k[edges[0]]\n        deg_v = k[edges[1]]\n        \n        # As per problem, if variance is zero, r=0.\n        if deg_u.std() == 0 or deg_v.std() == 0:\n            r = 0.0\n        else:\n            # Pearson correlation coefficient calculation\n            mean_u, mean_v = deg_u.mean(), deg_v.mean()\n            numerator = np.sum((deg_u - mean_u) * (deg_v - mean_v))\n            denominator = np.sqrt(np.sum((deg_u - mean_u)**2) * np.sum((deg_v - mean_v)**2))\n            if denominator == 0:\n                 r = 0.0\n            else:\n                 r = numerator / denominator\n\n    # --- Compute Average Clustering Coefficient C ---\n    C_i_list = []\n    # Using the A^3 formula for triangles is efficient for small, dense graphs.\n    A_cubed = np.linalg.matrix_power(A, 3)\n    for i in range(n):\n        ki = k[i]\n        if ki  2:\n            C_i = 0.0\n        else:\n            # num_triangles is half the diagonal of A^3\n            num_triangles = A_cubed[i, i] / 2.0\n            # num_possible_triangles is k_i choose 2\n            num_possible_triangles = ki * (ki - 1) / 2.0\n            C_i = num_triangles / num_possible_triangles\n        C_i_list.append(C_i)\n    \n    C = np.mean(C_i_list) if C_i_list else 0.0\n\n    # --- Compute Spectral Radii (not used in decision logic, but required) ---\n    # Spectral Radius of Adjacency Matrix A\n    if n > 0:\n        eigenvalues_A = np.linalg.eigvals(A)\n        rho_A = np.max(np.abs(eigenvalues_A))\n    else:\n        rho_A = 0.0\n\n    # Spectral Radius of Non-backtracking Matrix B\n    if num_edges == 0:\n        rho_B = 0.0\n    else:\n        # Construct the non-backtracking matrix B\n        dir_edges = []\n        rows, cols = np.where(A == 1)\n        for u, v in zip(rows, cols):\n            dir_edges.append((u, v))\n        \n        num_dir_edges = len(dir_edges)\n        edge_to_idx = {edge: i for i, edge in enumerate(dir_edges)}\n        \n        # B can be large, use integer type for efficiency\n        B = np.zeros((num_dir_edges, num_dir_edges), dtype=np.int8)\n\n        for i, edge1 in enumerate(dir_edges):\n            u, v = edge1\n            # Find all outgoing edges from node v\n            successors = np.where(A[v, :] == 1)[0]\n            for y in successors:\n                # Non-backtracking condition: y != u\n                if y != u:\n                    j = edge_to_idx[(v, y)]\n                    B[i, j] = 1\n\n        eigenvalues_B = np.linalg.eigvals(B)\n        rho_B = np.max(np.abs(eigenvalues_B))\n\n    # --- Apply Decision Rules ---\n    if C >= 0.1:\n        return 2  # Non-backtracking operator approximation\n    elif abs(r) >= 0.2 or H >= 3.0:\n        return 0  # Adjacency operator (quenched mean-field) approximation\n    else:\n        return 1  # Degree-based (heterogeneous mean-field) approximation\n\ndef solve():\n    # Test Case 1: 6-node star graph\n    A1 = np.array([\n        [0, 1, 1, 1, 1, 1],\n        [1, 0, 0, 0, 0, 0],\n        [1, 0, 0, 0, 0, 0],\n        [1, 0, 0, 0, 0, 0],\n        [1, 0, 0, 0, 0, 0],\n        [1, 0, 0, 0, 0, 0]\n    ])\n\n    # Test Case 2: 8-node ring lattice\n    n2 = 8\n    A2 = np.zeros((n2, n2), dtype=int)\n    for i in range(n2):\n        A2[i, (i - 1) % n2] = 1\n        A2[i, (i + 1) % n2] = 1\n\n    # Test Case 3: 3-node triangle\n    A3 = np.array([\n        [0, 1, 1],\n        [1, 0, 1],\n        [1, 1, 0]\n    ])\n\n    # Test Case 4: 5-node complete graph\n    n4 = 5\n    A4 = np.ones((n4, n4), dtype=int) - np.eye(n4, dtype=int)\n\n    test_cases = [A1, A2, A3, A4]\n    \n    results = []\n    for A in test_cases:\n        result = analyze_network(A)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}