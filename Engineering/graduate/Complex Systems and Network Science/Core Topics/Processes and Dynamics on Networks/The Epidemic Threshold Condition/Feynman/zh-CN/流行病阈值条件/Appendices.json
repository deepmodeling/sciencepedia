{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于一个基础但至关重要的问题：如何在规则网络上推导流行病阈值。通过分析一个简单的SIS（易感-感染-易感）模型，我们应用线性稳定性分析来研究无病平衡点的行为。这项练习旨在通过将流行病的爆发条件与网络邻接矩阵的最大特征值联系起来，为您提供推导流行病阈值的基本数学工具 。",
            "id": "4309101",
            "problem": "考虑一个连续时间的易感-感染-易感（SIS）传染病过程，该过程发生在一个包含 $n$ 个节点的有限、简单、无向、连通的 $k$-正则图上，其邻接矩阵记为 $A \\in \\mathbb{R}^{n \\times n}$。每个受感染节点以速率 $\\delta > 0$ 恢复，每个易感节点被其每个受感染邻居以速率 $\\beta > 0$ 感染。令有效传播率为 $\\tau = \\beta / \\delta$。在 N-纠缠平均场近似（NIMFA）下，令 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 受感染的概率，并将这些概率汇集成向量 $p(t) \\in \\mathbb{R}^{n}$。通过在无病平衡点 $p(t) = 0$ 附近对 NIMFA 动力学进行线性化，根据邻接矩阵 $A$ 的谱来分析该平衡点的稳定性。从第一性原理出发，仅使用关于非负矩阵谱的成熟结论，推导疫情阈值 $\\tau_{c}$ 作为 $A$ 的最大特征值的函数，然后将您的结果具体化到给定的 $k$-正则图上。您的最终答案必须是仅含 $k$ 的单个闭式解析表达式。不要提供中间的阈值不等式。精确表达最终答案，不要四舍五入，也不要包含任何单位。",
            "solution": "在尝试求解之前，对所述问题进行验证。\n\n### 第 1 步：提取已知条件\n\n-   **模型：** 连续时间的易感-感染-易感（SIS）传染病过程。\n-   **网络：** 一个包含 $n$ 个节点的有限、简单、无向、连通的 $k$-正则图。\n-   **邻接矩阵：** $A \\in \\mathbb{R}^{n \\times n}$。\n-   **恢复率：** $\\delta > 0$。\n-   **感染率：** 每个易感节点被其每个受感染邻居以速率 $\\beta > 0$ 感染。\n-   **有效传播率：** $\\tau = \\beta / \\delta$。\n-   **近似方法：** N-纠缠平均场近似（NIMFA）。\n-   **状态变量：** $p_i(t)$ 是节点 $i$ 在时间 $t$ 受感染的概率。这些概率的向量是 $p(t) \\in \\mathbb{R}^{n}$。\n-   **目标：**\n    1.  在无病平衡点 $p(t) = 0$ 附近对 NIMFA 动力学进行线性化。\n    2.  使用邻接矩阵 $A$ 的谱分析该平衡点的稳定性。\n    3.  推导疫情阈值 $\\tau_c$ 作为 $A$ 的最大特征值的函数。\n    4.  将结果具体化到给定的 $k$-正则图。\n    5.  最终答案必须是仅含 $k$ 的单个闭式解析表达式。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n根据指定标准对问题进行审查：\n\n-   **科学依据：** 该问题牢固地植根于数学流行病学和网络科学这一成熟领域。SIS 模型、平均场近似以及平衡点稳定性分析都是标准的、经过充分验证的方法。\n-   **良态的：** 所有必要的参数（$\\beta$、$\\delta$）、网络属性（$k$-正则、连通）和分析方法（NIMFA、线性化）都已明确定义。目标是推导一个特定量 $\\tau_c$，从而得到一个唯一且有意义的解。\n-   **客观性：** 该问题以精确的数学和科学语言表述，没有任何主观性或模糊性。\n\n问题陈述没有表现出任何指定的缺陷（例如，科学上不健全、不完整、矛盾）。这是一个理论流行病学中的标准、可形式化的问题。\n\n### 第 3 步：结论与行动\n\n该问题是有效的。将按要求从第一性原理推导求解。\n\n### 推导\n\n节点 $i$ 在时间 $t$ 受感染的概率 $p_i(t)$ 的动力学在 N-纠缠平均场近似（NIMFA）下建模。$p_i(t)$ 的变化率由感染率和恢复率之间的平衡给出。\n\n一个受感染的节点 $i$（概率为 $p_i$）以恒定速率 $\\delta$ 恢复。这对变化率的贡献项为 $-\\delta p_i$。\n\n一个易感的节点 $i$（概率为 $1 - p_i$）通过与受感染邻居的接触而被感染。在 NIMFA 的一种适用于线性化的常见表述中，来自邻居的感染压力被视为可加的。易感节点 $i$ 被感染的速率为 $\\beta (1-p_i) \\sum_{j=1}^{n} A_{ij} p_j$，其中如果节点 $i$ 和 $j$ 相连，则 $A_{ij}=1$，否则 $A_{ij}=0$。\n\n结合这些项，NIMFA 动力学系统由以下 $n$ 个耦合常微分方程组描述：\n$$\n\\frac{dp_i}{dt} = \\beta (1 - p_i) \\sum_{j=1}^{n} A_{ij} p_j - \\delta p_i, \\quad \\text{for } i = 1, \\dots, n.\n$$\n无病平衡点（DFE）是所有节点都处于易感状态的状态，即对所有 $i$ 都有 $p_i = 0$。我们可以通过将其代入方程组来验证 $p = 0$ 确实是一个平衡点，这会得到 $\\frac{dp_i}{dt} = 0$。\n\n为了分析 DFE 的稳定性，我们在 $p = 0$ 附近对系统进行线性化。令 $f_i(p) = \\beta (1 - p_i) \\sum_{j=1}^{n} A_{ij} p_j - \\delta p_i$。线性化系统为 $\\frac{dp}{dt} = J p$，其中 $J$ 是在 DFE 处求值的雅可比矩阵，其元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial p_j}|_{p=0}$。\n\n我们计算偏导数：\n对于 $i \\neq j$：\n$$\n\\frac{\\partial f_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j} \\left[ \\beta (1 - p_i) \\sum_{k=1}^{n} A_{ik} p_k - \\delta p_i \\right] = \\beta (1 - p_i) A_{ij}.\n$$\n在 $p = 0$ 处求值（此时 $p_i=0$），我们得到 $J_{ij} = \\beta A_{ij}$。\n\n对于 $i = j$：\n$$\n\\frac{\\partial f_i}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ \\beta (1 - p_i) \\sum_{k=1}^{n} A_{ik} p_k - \\delta p_i \\right] = -\\beta \\sum_{k=1}^{n} A_{ik} p_k + \\beta(1-p_i)A_{ii} - \\delta.\n$$\n由于图是简单的，所以 $A_{ii}=0$。在 $p = 0$ 处求值，我们得到 $J_{ii} = -\\delta$。\n\n因此，在 DFE 处的雅可比矩阵是 $J = \\beta A - \\delta I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。线性化系统为 $\\frac{dp}{dt} = (\\beta A - \\delta I) p$。\n\nDFE 的稳定性由 $J$ 的特征值决定。如果 $J$ 的所有特征值的实部都为负，则 DFE 是稳定的；如果至少有一个特征值的实部为正，则 DFE 是不稳定的。疫情阈值是 $J$ 的任意特征值的最大实部为零的条件。\n\n令 $\\lambda_m$ 为邻接矩阵 $A$ 的一个特征值，对应的特征向量为 $v_m$。由于图是无向的，$A$ 是一个实对称矩阵，其所有特征值 $\\lambda_m$ 都是实数。\n$J$ 的特征值 $\\mu_m$ 与 $A$ 的特征值相关：\n$$\nJ v_m = (\\beta A - \\delta I) v_m = \\beta (A v_m) - \\delta v_m = \\beta \\lambda_m v_m - \\delta v_m = (\\beta \\lambda_m - \\delta) v_m.\n$$\n因此，$J$ 的特征值为 $\\mu_m = \\beta \\lambda_m - \\delta$。\n\n稳定性由 $J$ 的最大特征值决定，记为 $\\mu_{\\max}$：\n$$\n\\mu_{\\max} = \\max_{m} (\\mu_m) = \\max_{m} (\\beta \\lambda_m - \\delta) = \\beta (\\max_m \\lambda_m) - \\delta = \\beta \\lambda_{\\max} - \\delta.\n$$\n这里，$\\lambda_{\\max}$ 是邻接矩阵 $A$ 的最大特征值。由于图是连通的，其邻接矩阵 $A$ 是不可约的非负矩阵。根据 Perron-Frobenius 定理，$\\lambda_{\\max}$ 是实的、正的且为单根。\n\n如果 DFE 不稳定，疫情就会出现并持续，这对应于 $\\mu_{\\max}  0$：\n$$\n\\beta \\lambda_{\\max} - \\delta  0 \\implies \\frac{\\beta}{\\delta} \\lambda_{\\max}  1.\n$$\n使用有效传播率的定义 $\\tau = \\beta / \\delta$，疫情爆发的条件是 $\\tau \\lambda_{\\max}  1$。\n\n疫情阈值 $\\tau_c$ 是稳定性发生变化的 $\\tau$ 的临界值。这发生在 $\\mu_{\\max} = 0$ 时，可得：\n$$\n\\tau_c \\lambda_{\\max} = 1 \\implies \\tau_c = \\frac{1}{\\lambda_{\\max}}.\n$$\n这是 NIMFA 模型在任何网络上的通用疫情阈值，用其邻接矩阵的最大特征值表示。\n\n问题要求我们将此结果具体化到 $k$-正则图上。如果每个节点的度都为 $k$，则图是 $k$-正则的。这个属性意味着邻接矩阵 $A$ 的每一行和都等于 $k$：\n$$\n\\sum_{j=1}^{n} A_{ij} = k \\quad \\text{for all } i=1, \\dots, n.\n$$\n考虑全 1 向量 $\\mathbf{1} = (1, 1, \\dots, 1)^T$。$A$ 作用于 $\\mathbf{1}$ 的结果是：\n$$\n(A\\mathbf{1})_i = \\sum_{j=1}^{n} A_{ij} (1) = k.\n$$\n因此，$A\\mathbf{1} = k\\mathbf{1}$。这表明 $k$ 是 $A$ 的一个特征值，其特征向量是 $\\mathbf{1}$。\n\n对于任何图，最大特征值受最大度的限制，即 $\\lambda_{\\max} \\leq k_{\\max}$。对于一个 $k$-正则图，$k_{\\max} = k$。既然我们已经找到了一个等于 $k$ 的特征值，它必然是最大特征值。因此，对于 $k$-正则图，$\\lambda_{\\max} = k$。\n\n将此结果代入疫情阈值的通用表达式：\n$$\n\\tau_c = \\frac{1}{k}.\n$$\n这是在 NIMFA 下，$k$-正则图上疫情阈值的最终表达式。",
            "answer": "$$\\boxed{\\frac{1}{k}}$$"
        },
        {
            "introduction": "在建立了基本方法之后，我们转向一个更能体现真实世界网络异质性的案例：星形图。尽管分析方法与前一个问题相同，但星形图的中心-辐射结构导致了一个令人惊讶且极具启发性的结果。通过这个练习，您将亲身体会到高度连接的“中心”节点如何极大地影响网络的脆弱性，并学习如何用邻接矩阵的谱半径来量化这种效应 。",
            "id": "4309082",
            "problem": "考虑一个静态、简单、无向的星形图 $S_{n}$ 上的易感-感染-易感（SIS）传染过程。该图有 $n$ 个节点，由一个中心节点（标签为 $0$）连接到 $n-1$ 个叶节点（标签为 $1,2,\\dots,n-1$）组成，叶节点之间没有边。设每次接触的感染率为 $\\beta$，每个节点的恢复率为 $\\mu$。在淬火平均场（QMF）近似下，令 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 被感染的概率，并通过因式分解处理动力学相关性，使得节点感染状态的乘积近似为其概率的乘积。以此近似为基础，对所有 $p_{i}(t)=0$ 的无病平衡态进行线性稳定性分析。从第一性原理出发，根据 $S_{n}$ 的邻接矩阵 $A$ 的谱性质推导小微扰的增长条件，然后求解 $S_{n}$ 相应的特征值问题，以获得淬火平均场疫情阈值，即无病态失稳时的临界感染率 $\\beta_{c}$。请将 $\\beta_{c}$ 的最终答案表示为关于 $n$ 和 $\\mu$ 的闭式解析表达式。此外，请基于你推导出的谱结构，对 $S_{n}$ 中中心节点的主导作用如何影响该阈值提供一个简要的定性解释。",
            "solution": "问题要求使用淬火平均场（QMF）近似，求解星形图 $S_n$ 上易感-感染-易感（SIS）模型的疫情阈值 $\\beta_c$。推导过程通过对无病平衡态进行线性稳定性分析来进行。\n\n首先，我们建立节点 $i$ 在时间 $t$ 被感染的概率 $p_i(t)$ 的动力学方程。对于 SIS 过程，一个易感节点 $i$ 可能被其任何一个已感染的邻居感染，而一个已感染的节点 $i$ 可能恢复并再次变为易感。\n已感染节点 $i$ 的恢复率为 $\\mu$，因此对 $p_i(t)$ 变化的贡献是 $-\\mu p_i(t)$。\n一个易感节点 $i$（概率为 $1-p_i(t)$）在其至少一个邻居被感染并传播疾病时被感染。来自已感染邻居 $j$ 的传播率为 $\\beta$。在 QMF 近似中，邻居 $j$ 被感染的概率被独立地处理为 $p_j(t)$。节点 $i$ 被感染的总概率流是 $i$ 为易感状态的概率 $(1-p_i(t))$ 与其从邻域接收感染的速率的乘积。该速率由 $\\beta \\sum_{j} A_{ij} p_j(t)$ 给出，其中 $A$ 是图的邻接矩阵（如果节点 $i$ 和 $j$ 相连，则 $A_{ij}=1$，否则为 $0$）。\n\n综合这些项，节点 $i$ 感染概率演化的 QMF 方程为：\n$$\n\\frac{dp_i(t)}{dt} = -\\mu p_i(t) + (1-p_i(t)) \\beta \\sum_{j=0}^{n-1} A_{ij} p_j(t)\n$$\n这是一个包含 $n$ 个耦合非线性常微分方程的方程组。\n\n无病平衡态（DFE）是所有节点都处于易感状态的状态，即对于所有 $i \\in \\{0, 1, \\dots, n-1\\}$，$p_i = 0$。为了确定该平衡态的稳定性，我们进行线性稳定性分析。我们考虑在 DFE 周围的一个小微扰 $\\epsilon_i(t)$，使得 $p_i(t) = 0 + \\epsilon_i(t)$，其中 $|\\epsilon_i(t)| \\ll 1$。将此代入 QMF 方程，并只保留 $\\epsilon_i$ 的一阶项进行线性化：\n$$\n\\frac{d\\epsilon_i(t)}{dt} = -\\mu \\epsilon_i(t) + (1-\\epsilon_i(t)) \\beta \\sum_{j=0}^{n-1} A_{ij} \\epsilon_j(t)\n$$\n$$\n\\frac{d\\epsilon_i(t)}{dt} \\approx -\\mu \\epsilon_i(t) + \\beta \\sum_{j=0}^{n-1} A_{ij} \\epsilon_j(t)\n$$\n项 $-\\epsilon_i(t) \\beta \\sum_{j} A_{ij} \\epsilon_j(t)$ 是 $\\mathcal{O}(\\epsilon^2)$ 阶的，因此被忽略。\n写成向量形式，其中 $\\vec{\\epsilon}(t) = (\\epsilon_0(t), \\epsilon_1(t), \\dots, \\epsilon_{n-1}(t))^T$，线性化方程组为：\n$$\n\\frac{d\\vec{\\epsilon}(t)}{dt} = (\\beta A - \\mu I) \\vec{\\epsilon}(t)\n$$\n其中 $I$ 是 $n \\times n$ 单位矩阵。DFE 的稳定性由雅可比矩阵 $J = \\beta A - \\mu I$ 的特征值决定。如果 $J$ 的所有特征值都具有负实部，则 DFE 是稳定的。如果至少有一个特征值具有正实部，则疫情可能爆发。疫情阈值对应于 $J$ 的最大特征值变为零的临界条件。\n\n$J$ 的特征值（记为 $\\lambda_k$）与邻接矩阵 $A$ 的特征值（记为 $\\Lambda_k$）之间的关系为 $\\lambda_k = \\beta \\Lambda_k - \\mu$。由于 $A$ 是一个简单无向图的邻接矩阵，它是实对称的，其所有特征值 $\\Lambda_k$ 都是实数。因此，$J$ 的最大特征值为 $\\lambda_{max} = \\beta \\Lambda_{max} - \\mu$，其中 $\\Lambda_{max}$ 是 $A$ 的最大特征值（其谱半径）。\n\n当这个最大特征值为零时，我们找到疫情阈值 $\\beta_c$：\n$$\n\\beta_c \\Lambda_{max} - \\mu = 0 \\implies \\beta_c = \\frac{\\mu}{\\Lambda_{max}}\n$$\n这就建立了用 $A$ 的谱性质表示的增长条件。下一步是求出星形图 $S_n$ 的 $\\Lambda_{max}$。\n\n星形图 $S_n$ 有 $n$ 个节点：一个中心节点（节点 $0$）连接到 $n-1$ 个叶节点（节点 $1, \\dots, n-1$）。邻接矩阵 $A$（以中心节点为第一行/列）为：\n$$\nA = \\begin{pmatrix}\n0  1  1  \\dots  1 \\\\\n1  0  0  \\dots  0 \\\\\n1  0  0  \\dots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n1  0  0  \\dots  0\n\\end{pmatrix}\n$$\n特征值方程为 $A\\mathbf{v} = \\Lambda \\mathbf{v}$，其中 $\\mathbf{v} = (v_0, v_1, \\dots, v_{n-1})^T$。这对应于以下方程组：\n1. $\\sum_{j=1}^{n-1} v_j = \\Lambda v_0$\n2. $v_0 = \\Lambda v_i$ for each $i \\in \\{1, 2, \\dots, n-1\\}$\n\n从方程（2）可知，如果 $\\Lambda \\neq 0$，那么特征向量的所有叶节点分量都相等：$v_i = v_0 / \\Lambda$。一个非平凡解要求 $v_0 \\neq 0$（否则所有 $v_i=0$）。将此代入方程（1）：\n$$\n\\sum_{j=1}^{n-1} \\left(\\frac{v_0}{\\Lambda}\\right) = \\Lambda v_0\n$$\n$$\n(n-1)\\frac{v_0}{\\Lambda} = \\Lambda v_0\n$$\n由于 $v_0 \\neq 0$，我们可以用它来除，得到：\n$$\n\\frac{n-1}{\\Lambda} = \\Lambda \\implies \\Lambda^2 = n-1 \\implies \\Lambda = \\pm\\sqrt{n-1}\n$$\n这给出了两个不同的特征值：$\\sqrt{n-1}$ 和 $-\\sqrt{n-1}$。\n\n如果 $\\Lambda = 0$，方程（2）给出 $v_0 = 0$。方程（1）则变为 $\\sum_{j=1}^{n-1} v_j = 0$。这个条件定义了一个 $(n-2)$ 维的特征向量子空间。因此，$\\Lambda=0$ 是一个几何（和代数）重数为 $n-2$ 的特征值。\n\n$S_n$ 的邻接矩阵 $A$ 的完整特征值谱为 $\\{\\sqrt{n-1}, -\\sqrt{n-1}, 0, \\dots, 0\\}$，其中 $0$ 的重数为 $n-2$。最大特征值是谱半径：\n$$\n\\Lambda_{max} = \\sqrt{n-1}\n$$\n将此代入我们的疫情阈值表达式，我们得到：\n$$\n\\beta_c = \\frac{\\mu}{\\sqrt{n-1}}\n$$\n\n对此结果的定性解释突出了中心节点的主导作用。疫情阈值 $\\beta_c$ 与叶节点数量的平方根 $\\sqrt{n-1}$ 成反比，这也是中心节点度的平方根。对于一个大的星形图（$n \\to \\infty$），阈值 $\\beta_c \\to 0$。这意味着星形网络结构对疫情极其脆弱；如果网络足够大，即使是无穷小的感染率也足以引发疫情爆发。\n\n这种极端的脆弱性是中心节点主导作用的直接后果，而谱性质正捕捉到了这一点。谱半径 $\\Lambda_{max} = \\sqrt{n-1}$ 是衡量网络放大扰动能力的指标。一个大的 $\\Lambda_{max}$ 意味着网络结构极大地促进了传播。与 $\\Lambda_{max}$ 对应的特征向量其最大分量局域在中心节点上，表明初期的疫情主要集中在中心节点。中心节点扮演着“超级传播者”的角色，能高效地从任何一个叶节点接收感染，并将其传播到所有其他叶节点。QMF 阈值正确地捕捉到了这种效应，显示出与均匀近似（其将与平均度 $\\langle k \\rangle \\approx 2$ 成比例）相比低得多的阈值，并形式化了中心主导节点如何使整个系统变得脆弱。",
            "answer": "$$\\boxed{\\frac{\\mu}{\\sqrt{n-1}}}$$"
        },
        {
            "introduction": "对于大型稀疏网络，如Erdős–Rényi随机图，传统的基于邻接矩阵的均场近似可能不够精确。本练习将您引入更前沿、更精确的分析框架：分支过程和非回溯矩阵方法。您将通过两种不同的方法推导出SIR（易感-感染-移除）模型的阈值，并理解它们在局部树状结构假设下的等价性 。这个高级实践不仅深化了您对临界现象的理解，还为您提供了分析复杂网络动态的强大工具。",
            "id": "4309002",
            "problem": "考虑一个在稀疏区域的 Erdős–Rényi 随机图 $G(n,p)$ 上的易感-感染-移除 (SIR) 过程，其中 $p = c/(n-1)$，因此当 $n \\to \\infty$ 时，平均度 $c$ 保持为 $O(1)$。每个感染节点以单边传播率 $T \\in [0,1]$ 独立地传播给每个易感的邻居。将流行病阈值 $T_c$ 定义为 $T$ 的下确界，使得当 $n \\to \\infty$ 时，宏观爆发（一个巨型感染分支）以非零概率发生。\n\n仅使用适用于局部树状随机图的基本定义和第一性原理，执行以下两个独立的计算并进行协调：\n\n- 从尺寸偏倚（超额）度分布的定义和一个在局部树状配置模型上对早期传播的 Galton–Watson 分支过程近似出发，推导出现巨型感染簇的条件，该条件是 $T$ 和 $G(n,p)$ 度分布矩的函数。将您的推导特化到稀疏区域的 Erdős–Rényi 情况，以获得 $T_c$ 作为平均度 $c$ 的封闭形式函数。\n\n- 在图的有向边集合上定义非回溯 (Hashimoto) 矩阵 $\\mathbf{B}$，并写出 SIR 过程的基于边的消息传递不动点方程，该方程表达了感染不穿过有向边的概率。围绕无病不动点对这些方程进行线性化，并用谱半径 $\\rho(\\mathbf{B})$ 表示不稳定性条件。在稀疏区域中，评估 $G(n,p)$ 的 $\\rho(\\mathbf{B})$ 的领头阶渐近行为，并获得 $T_c$ 作为 $c$ 的封闭形式函数。\n\n解释在所述假设下，您获得的两个 $T_c$ 表达式为何在 $n \\to \\infty$ 的极限下一致。以 $c$ 的单一封闭形式表达式提供您的最终答案 $T_c$。不需要数值评估，也不涉及单位。最终答案必须是单一的解析表达式。",
            "solution": "问题陈述是一个有效的、良定的科学问题。所有给定条件都有科学依据、一致且足以推导出解决方案。该问题要求使用两种不同但相关的理论框架，推导稀疏 Erdős–Rényi 图上易感-感染-移除 (SIR) 模型的流行病阈值 $T_c$，并对它们进行协调。\n\n### 步骤 1：问题验证\n\n**提取的给定条件：**\n-   **过程**：易感-感染-移除 (SIR) 过程。\n-   **网络**：一个 Erdős–Rényi (ER) 随机图 $G(n,p)$。\n-   **区域**：稀疏极限，其中 $n \\to \\infty$，$p = c/(n-1)$，且平均度 $c$ 是一个 1 阶常数，即 $c = O(1)$。\n-   **传播**：单边传播率 $T$，其中 $T \\in [0,1]$。\n-   **阈值定义**：$T_c$ 是 $T$ 的下确界，使得当 $n \\to \\infty$ 时，宏观爆发以非零概率发生。\n-   **方法 1**：在局部树状图上使用分支过程近似，利用尺寸偏倚（超额）度分布，根据度分布的矩找到 $T_c$，然后特化到 ER 情况。\n-   **方法 2**：使用非回溯 (Hashimoto) 矩阵 $\\mathbf{B}$ 的基于边的消息传递形式体系，围绕无病状态进行线性化，并将不稳定性与谱半径 $\\rho(\\mathbf{B})$ 相关联以找到 $T_c$。\n\n**验证结论：**\n该问题是**有效的**。它在网络流行病学和随机图论的既定理论中有科学依据。它问题良定、客观，并包含足够的信息来推导所要求的结果。两种指定的方法是分析网络上动力学过程的标准且强大的技术。该问题在理论物理/应用数学领域提出了一个非平凡但可解的挑战。\n\n### 步骤 2：求解推导\n\n我们将首先使用分支过程近似推导流行病阈值，然后使用非回溯矩阵形式体系进行推导。最后，我们将证明它们的等价性。\n\n#### 推导 1：分支过程近似\n\n在一个大型、稀疏的随机图（局部呈树状）上，流行病早期的传播可以被建模为一个 Galton-Watson 分支过程。当且仅当该分支过程有非零概率无限存活时，爆发才会变得宏观。这发生在个体的预期后代数量超过 1 时。\n\n设 $P(k)$ 为图的度分布。平均度为 $\\langle k \\rangle = \\sum_k k P(k)$。\n初始感染节点是随机均匀选择的。我们假设它感染了它的邻居。“后代”是下一代新感染的节点。一个被感染的节点是通过其感染者的某条边到达的。通过随机选择一条边到达的节点的度分布不是 $P(k)$，而是尺寸偏倚或超额度分布，记为 $q_k$。选择一条连接到度为 $k$ 的节点的边的概率与 $k P(k)$ 成正比。归一化后得到：\n$$q_k = \\frac{k P(k)}{\\sum_j j P(j)} = \\frac{k P(k)}{\\langle k \\rangle}$$\n这样一个节点，通过它的一条边被到达，还有 $k-1$ 条“其他”边可以用来传播感染。这就是超额度。\n\n我们考虑的分支过程是关于受感染边的过程。一个被邻居 `v` 感染的节点 `u` 将试图将其 $k_u-1$ 个其他邻居感染。沿任何单条边成功传播的概率是 $T$。从节点 `u` 产生的新的成功传播的预期数量是 $T(k_u-1)$。\n\n为了确定流行病是否会传播，我们需要对所有可能处于传播链第二步的节点 `u` 求这个量的平均值。这样一个节点的度 $k_u$ 服从分布 $q_k$。因此，后续感染的预期数量，我们称之为分支比 $R_*$，是：\n$$R_* = \\sum_{k=1}^{\\infty} T(k-1)q_k = T \\sum_{k=1}^{\\infty} (k-1) \\frac{k P(k)}{\\langle k \\rangle}$$\n$$R_* = \\frac{T}{\\langle k \\rangle} \\sum_{k=1}^{\\infty} (k^2 - k) P(k) = \\frac{T}{\\langle k \\rangle} \\left( \\sum_{k=1}^{\\infty} k^2 P(k) - \\sum_{k=1}^{\\infty} k P(k) \\right)$$\n使用度分布的一阶矩和二阶矩的定义，$\\langle k \\rangle = \\sum_k k P(k)$ 和 $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$，我们有：\n$$R_* = T \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n如果 $R_*  1$，则发生宏观爆发。流行病阈值 $T_c$ 对应于临界点 $R_* = 1$。\n$$T_c \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} = 1 \\implies T_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle}$$\n这是由配置模型描述的网络的通用结果。\n\n现在，我们将此结果特化到稀疏极限（$p = c/(n-1)$，$n \\to \\infty$）下的 Erdős–Rényi 图 $G(n,p)$。在此极限下，度分布 $P(k)$ 收敛于均值为 $c$ 的泊松分布：\n$$P(k) = \\frac{\\exp(-c) c^k}{k!}$$\n对于泊松分布，其矩是众所周知的：\n-   一阶矩（均值）：$\\langle k \\rangle = c$。\n-   二阶矩：$\\langle k^2 \\rangle = \\text{Var}(k) + \\langle k \\rangle^2 = c + c^2$。\n\n将这些矩代入 $T_c$ 的表达式中：\n$$T_c = \\frac{c}{(c + c^2) - c} = \\frac{c}{c^2} = \\frac{1}{c}$$\n\n#### 推导 2：非回溯矩阵方法\n\n此方法使用基于边的消息传递方程来分析无病状态的稳定性。设 $P_{u \\to v}$ 为在整个流行病过程中，从一个极小的感染种子开始，节点 $u$ *不* 将感染传播给其邻居 $v$ 的概率。\n\n要使 $u$ 不感染 $v$，必须发生以下两个互斥事件之一：\n1.  节点 $u$ 本身从未被除 $v$ 之外的任何邻居感染。假设在局部树状结构上是独立的，此事件的概率为 $\\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} P_{w \\to u}$。\n2.  节点 $u$ 被除 $v$ 之外的至少一个邻居感染（概率为 $1 - \\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} P_{w \\to u}$），但从 $u$ 到 $v$ 的传播失败（概率为 $1-T$）。\n\n将这些结合起来，得到 $P_{u \\to v}$ 的自洽不动点方程：\n$$P_{u \\to v} = \\left( \\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} P_{w \\to u} \\right) \\cdot 1 + \\left( 1 - \\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} P_{w \\to u} \\right) (1-T)$$\n$$P_{u \\to v} = (1-T) + T \\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} P_{w \\to u}$$\n无病状态对应于没有感染传播，因此对于所有有向边 $u \\to v$，$P_{u \\to v} = 1$。这是一个平凡不动点：$1 = (1-T) + T \\cdot 1$。\n\n为了找到流行病阈值，我们分析这个不动点的稳定性。让我们引入一个小的扰动：$P_{u \\to v} = 1 - \\epsilon_{u \\to v}$，其中 $\\epsilon_{u \\to v}  0$ 是无穷小量。将此代入不动点方程并进行线性化：\n$$1 - \\epsilon_{u \\to v} = (1-T) + T \\prod_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} (1 - \\epsilon_{w \\to u})$$\n对于小的 $\\epsilon$，我们使用近似 $\\prod(1-\\epsilon_i) \\approx 1 - \\sum \\epsilon_i$：\n$$1 - \\epsilon_{u \\to v} \\approx (1-T) + T \\left( 1 - \\sum_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} \\epsilon_{w \\to u} \\right)$$\n$$1 - \\epsilon_{u \\to v} \\approx 1 - T + T - T \\sum_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} \\epsilon_{w \\to u}$$\n$$\\epsilon_{u \\to v} = T \\sum_{w \\in \\mathcal{N}(u) \\setminus \\{v\\}} \\epsilon_{w \\to u}$$\n这是一个关于扰动 $\\epsilon_{u \\to v}$ 的线性方程组。我们可以将其写成矩阵形式。设 $\\vec{\\epsilon}$ 是一个向量，它包含了图中所有 $2|E|$ 条有向边的 $\\epsilon_{u \\to v}$ 值。方程变为：\n$$\\vec{\\epsilon} = T \\mathbf{B} \\vec{\\epsilon}$$\n其中 $\\mathbf{B}$ 是图的非回溯（或 Hashimoto）矩阵。其元素定义为，如果 $w \\neq v$ 则 $B_{(u \\to v), (w \\to u)} = 1$，否则为 0。也就是说，它将传入的非回溯边映射到一条传出的边。\n\n如果扰动 $\\vec{\\epsilon}$ 能够增长，则无病不动点是不稳定的。这发生在当线性算子 $T\\mathbf{B}$ 的特征值大于 1 时。不稳定性开始的条件是该算子的最大特征值（谱半径）等于 1：\n$$\\rho(T\\mathbf{B}) = 1 \\implies T \\rho(\\mathbf{B}) = 1$$\n这给出了流行病阈值为 $T_c = 1/\\rho(\\mathbf{B})$。\n\n最后一步是确定稀疏 ER 图的谱半径 $\\rho(\\mathbf{B})$。在随机矩阵理论中，一个已知的结果是：对于来自配置模型的、具有度分布 $P(k)$ 的随机图，在 $n$ 很大时，其非回溯矩阵的谱半径收敛于平均超额度：\n$$\\rho(\\mathbf{B}) \\to \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n由于这个结果适用于 ER 图的情况，我们可以再次使用极限泊松度分布的矩，$\\langle k \\rangle = c$ 和 $\\langle k^2 \\rangle = c+c^2$：\n$$\\rho(\\mathbf{B}) \\to \\frac{(c+c^2) - c}{c} = \\frac{c^2}{c} = c$$\n因此，从这种方法得到的流行病阈值是：\n$$T_c = \\frac{1}{\\rho(\\mathbf{B})} = \\frac{1}{c}$$\n\n#### 两种方法的协调\n\n两种方法都得出了相同的结果，$T_c = 1/c$。这种一致性并非巧合；它反映了当应用于局部树状图时，两种形式体系之间的深层联系。\n\n1.  **共同的核心概念**：两种方法都确定了控制流行病级联爆发的相同关键量：沿网络路径的感染分支因子。大型稀疏随机图的局部树状结构是两种方法的核心。\n\n2.  **分支过程视角**：方法 1 明确地将流行病建模为树状分支过程。增长条件 $R_*  1$ 是基于一个刚刚被感染的节点所产生的预期新感染数（$T \\times$ 邻居数）。可用的“前进”邻居的平均数是平均超额度，即 $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$。\n\n3.  **谱视角**：方法 2 分析了感染“消息”或概率沿有向边的传播。非回溯矩阵 $\\mathbf{B}$ 是一个图的邻接矩阵，该图的节点是有向边，其链接代表长度为 2 的非回溯路径。谱半径 $\\rho(\\mathbf{B})$ 控制图中非回溯路径数量的指数增长率。在一棵树上，这个增长率就是每个节点的平均分支因子。对于一个局部是树的大型随机图，$\\rho(\\mathbf{B})$ 收敛于路径的平均分支因子，这恰好是平均超额度，即 $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$。\n\n本质上，方法 1 中 Galton-Watson 过程的分支因子是方法 2 中作为非回溯矩阵谱半径出现的数学量的物理体现。不稳定性条件 $T \\rho(\\mathbf{B})  1$ 是对分支过程超临界条件 $T \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}  1$ 的重述。因此，两种方法都是捕捉稀疏网络上持续感染传播条件的等效方式。",
            "answer": "$$\n\\boxed{\\frac{1}{c}}\n$$"
        }
    ]
}