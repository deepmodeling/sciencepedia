{
    "hands_on_practices": [
        {
            "introduction": "理解平均场近似的最好方法是从最简单的系统开始。这个练习将指导你在一个仅有两个节点的有向网络模体上，应用所谓的“淬火平均场”(Quenched Mean Field, QMF)近似。通过为每个节点的感染概率建立并求解耦合微分方程，你将学会该方法的核心步骤，并发现网络结构（如权重不对称性）如何产生非平凡的动力学效应。",
            "id": "4287177",
            "problem": "考虑一个在具有$2$个节点（标记为$1$和$2$）的小型有向加权网络基序上的易感-感染-易感（SIS）流行病过程。从节点 $j$ 到节点 $i$ 的有向传播沿着权重为 $w_{ji}$ 的有向边发生，其感染率与全局传播率参数 $\\beta>0$ 和权重 $w_{ji}>0$ 的乘积成正比。每个受感染的节点以速率 $\\mu>0$ 独立恢复。设 $p_i(t)$ 表示节点 $i$ 在时间 $t$ 的感染概率。在淬火平均场（QMF）近似（其中节点状态是独立的，邻接关系是固定的）下，易感节点 $i$ 的感染风险是其所有入边上的瞬时感染压力之和，每个压力等于 $\\beta w_{ji} p_j(t)$。假设该基序恰好有两条有向边：$w_{12}=a>0$（从节点 $1$ 到节点 $2$）和 $w_{21}=b>0$（从节点 $2$ 到节点 $1$），没有自环或其他边。\n\n从上述SIS过程和平均场闭合假设出发，推导QMF动力学的稳态方程，并解析地求解非平凡稳态感染概率 $p_1^{\\ast}$ 和 $p_2^{\\ast}$，将其表示为 $a$、$b$、$\\beta$ 和 $\\mu$ 的函数。然后，计算由下式定义的稳态平均患病率 $\\bar{p}^{\\ast}$：\n$$\n\\bar{p}^{\\ast} \\equiv \\frac{p_1^{\\ast} + p_2^{\\ast}}{2}.\n$$\n假设参数满足 $a>0$、$b>0$、$\\beta>0$、$\\mu>0$，并且存在非零稳态。将最终答案表示为关于 $a$、$b$、$\\beta$ 和 $\\mu$ 的 $\\bar{p}^{\\ast}$ 的单个闭式解析表达式。无需四舍五入。在您的推导过程中，简要讨论与对称情况 $a=b$ 相比，非对称权重 $a \\neq b$ 如何影响 $p_1^{\\ast}$、$p_2^{\\ast}$ 和 $\\bar{p}^{\\ast}$。",
            "solution": "问题陈述具有科学依据、是适定的、客观且自洽的。它描述了一个2节点有向网络上的经典易感-感染-易感（SIS）模型，这是网络流行病学中的一个标准问题。所有参数和假设，包括使用淬火平均场（QMF）近似，都得到了明确定义。任务是推导并求解非平凡稳态概率和平均患病率。存在非零稳态的假设消除了歧义。因此，该问题是有效的，可以求解。\n\n我们首先在QMF近似下，为节点1和节点2的感染概率 $p_1(t)$ 和 $p_2(t)$ 建立微分方程。节点 $i$ 的感染概率变化率 $\\frac{dp_i}{dt}$ 是感染率与恢复率之差。\n\n易感节点 $i$ 的感染率是其易感概率 $1-p_i(t)$ 乘以来自其受感染邻居的总感染压力（或风险）。问题陈述该风险为 $\\sum_j \\beta w_{ji} p_j(t)$，其中 $\\beta$ 是全局传播率参数，$w_{ji}$ 是有向边权重。受感染节点 $i$ 的恢复率是其受感染概率 $p_i(t)$ 乘以恢复率 $\\mu$。\n\n因此，节点 $i$ 的一般QMF方程为：\n$$\n\\frac{dp_i}{dt} = (1-p_i(t)) \\sum_j \\beta w_{ji} p_j(t) - \\mu p_i(t)\n$$\n\n对于指定的2节点网络，权重为 $w_{21}=b$（从节点2到1）和 $w_{12}=a$（从节点1到2），所有其他权重均为零。关于 $p_1(t)$ 和 $p_2(t)$ 的方程组变为：\n$$\n\\frac{dp_1}{dt} = (1-p_1(t)) \\beta w_{21} p_2(t) - \\mu p_1(t) = (1-p_1(t)) \\beta b p_2(t) - \\mu p_1(t)\n$$\n$$\n\\frac{dp_2}{dt} = (1-p_2(t)) \\beta w_{12} p_1(t) - \\mu p_2(t) = (1-p_2(t)) \\beta a p_1(t) - \\mu p_2(t)\n$$\n\n为了找到稳态解，记为 $p_1^{\\ast}$ 和 $p_2^{\\ast}$，我们将时间导数设为零：\n$$\n(1-p_1^{\\ast}) \\beta b p_2^{\\ast} - \\mu p_1^{\\ast} = 0 \\quad \\quad (1)\n$$\n$$\n(1-p_2^{\\ast}) \\beta a p_1^{\\ast} - \\mu p_2^{\\ast} = 0 \\quad \\quad (2)\n$$\n\n问题要求的是非平凡稳态，因此我们假设 $p_1^{\\ast} > 0$ 且 $p_2^{\\ast} > 0$。我们可以重新整理这些方程：\n$$\n\\mu p_1^{\\ast} = \\beta b p_2^{\\ast} (1-p_1^{\\ast})\n$$\n$$\n\\mu p_2^{\\ast} = \\beta a p_1^{\\ast} (1-p_2^{\\ast})\n$$\n\n为了求解该方程组，我们可以从第一个方程中将 $p_1^{\\ast}$ 表示为 $p_2^{\\ast}$ 的函数：\n$$\n\\mu p_1^{\\ast} + \\beta b p_1^{\\ast} p_2^{\\ast} = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} (\\mu + \\beta b p_2^{\\ast}) = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} = \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}}\n$$\n将这个 $p_1^{\\ast}$ 的表达式代入第二个稳态方程：\n$$\n\\mu p_2^{\\ast} = \\beta a \\left( \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\n因为我们寻求非平凡解，其中 $p_2^{\\ast} \\neq 0$，所以我们可以将方程两边同除以 $p_2^{\\ast}$：\n$$\n\\mu = \\beta a \\left( \\frac{\\beta b}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\n两边同乘以 $(\\mu + \\beta b p_2^{\\ast})$ 得到：\n$$\n\\mu(\\mu + \\beta b p_2^{\\ast}) = \\beta^2 ab (1-p_2^{\\ast})\n$$\n$$\n\\mu^2 + \\mu \\beta b p_2^{\\ast} = \\beta^2 ab - \\beta^2 ab p_2^{\\ast}\n$$\n现在，我们求解 $p_2^{\\ast}$：\n$$\np_2^{\\ast} (\\mu \\beta b + \\beta^2 ab) = \\beta^2 ab - \\mu^2\n$$\n$$\np_2^{\\ast} (\\beta b (\\mu + \\beta a)) = \\beta^2 ab - \\mu^2\n$$\n这就给出了 $p_2^{\\ast}$ 的解：\n$$\np_2^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)}\n$$\n问题陈述了存在一个非零稳态，这意味着 $\\beta^2 ab - \\mu^2 > 0$，即 $\\beta\\sqrt{ab} > \\mu$。这是该系统中流行病爆发的著名条件，其中 $\\sqrt{ab}$ 是网络加权邻接矩阵的谱半径。\n\n根据对称性，交换标签 $(1 \\leftrightarrow 2)$ 等价于交换权重 $(a \\leftrightarrow b)$。因此，我们可以通过在 $p_2^{\\ast}$ 的表达式中互换 $a$ 和 $b$ 来求得 $p_1^{\\ast}$：\n$$\np_1^{\\ast} = \\frac{\\beta^2 ba - \\mu^2}{\\beta a (\\beta b + \\mu)}\n$$\n\n接下来，我们计算稳态平均患病率 $\\bar{p}^{\\ast}$：\n$$\n\\bar{p}^{\\ast} = \\frac{p_1^{\\ast} + p_2^{\\ast}}{2} = \\frac{1}{2} \\left[ \\frac{\\beta^2 ab - \\mu^2}{\\beta a (\\beta b + \\mu)} + \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)} \\right]\n$$\n提出公因式 $(\\beta^2 ab - \\mu^2)$：\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2} \\left[ \\frac{1}{\\beta a (\\beta b + \\mu)} + \\frac{1}{\\beta b (\\beta a + \\mu)} \\right]\n$$\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left[ \\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} \\right]\n$$\n为了合并括号中的分数，我们使用公分母 $ab(\\beta b + \\mu)(\\beta a + \\mu)$：\n$$\n\\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} = \\frac{b(\\beta a + \\mu) + a(\\beta b + \\mu)}{ab(\\beta b + \\mu)(\\beta a + \\mu)} = \\frac{\\beta ab + b\\mu + \\beta ab + a\\mu}{ab(\\beta^2 ab + \\beta a \\mu + \\beta b \\mu + \\mu^2)}\n$$\n$$\n= \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\n将此结果代回 $\\bar{p}^{\\ast}$ 的表达式中：\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left( \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)} \\right)\n$$\n这可以简化为最终的闭式表达式：\n$$\n\\bar{p}^{\\ast} = \\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\n\n最后，我们讨论非对称权重的影响。在 $a=b$ 的对称情况下，概率相等：$p_1^{\\ast} = p_2^{\\ast} = 1 - \\frac{\\mu}{\\beta a}$。当权重非对称时，比如 $a>b$，节点1是比节点2更强的传播者。$p_1^{\\ast}$ 和 $p_2^{\\ast}$ 的分母分别为 $\\beta a (\\beta b + \\mu)$ 和 $\\beta b (\\beta a + \\mu)$。\n$p_1^{\\ast}$ 的分母：$\\beta^2 ab + a\\beta\\mu$。\n$p_2^{\\ast}$ 的分母：$\\beta^2 ab + b\\beta\\mu$。\n由于 $a>b$ 且所有参数均为正数，所以 $a\\beta\\mu > b\\beta\\mu$，这意味着 $p_1^{\\ast}$ 的分母大于 $p_2^{\\ast}$ 的分母。由于分子相同，这导致 $p_1^{\\ast}  p_2^{\\ast}$。\n这是一个关键的网络效应：作为更强传播者的节点（具有更大的出边权重 $a=w_{12}$）其个体感染概率反而较低，因为它从传播能力较弱的邻居那里接收到的感染压力较小。相反地，较弱的传播者（节点2）面临更强的感染压力，因此具有更高的感染概率。\n\n关于平均患病率 $\\bar{p}^{\\ast}$，考虑权重几何平均值 $\\sqrt{ab}$ 保持不变的情况。这固定了流行病阈值条件。算术平均-几何平均不等式指出，对于 $a,b0$，$a+b \\ge 2\\sqrt{ab}$，当且仅当 $a=b$ 时等号成立。因此，对于固定的乘积 $ab$，和 $a+b$ 在对称情况下达到最小值。对 $\\bar{p}^{\\ast}$ 表达式的分析表明，它是和 $a+b$ 的递减函数（在乘积 $ab$ 固定的情况下）。因此，平均患病率 $\\bar{p}^{\\ast}$ 在对称情况（$a=b$）下达到最大值，并会因权重的任何非对称性而减小。",
            "answer": "$$\n\\boxed{\\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}}\n$$"
        },
        {
            "introduction": "在掌握了微观模体上的分析后，下一步是处理大规模随机网络。本练习将介绍一种极为强大的分析工具——生成函数，它是网络科学的基石之一。通过将SIR模型的最终状态巧妙地映射到构型模型网络上的键渗流问题，你将学会如何计算一个关键的宏观量——最终疫情规模 $R_{\\infty}$。",
            "id": "4287240",
            "problem": "考虑一个由配置模型生成的大型稀疏随机网络，其度分布为 $P(k)$，其中 $P(3)=1$ 且对于所有 $k \\neq 3$ 都有 $P(k)=0$。一场易感-感染-恢复 (SIR) 传染病在该网络上传播，其边级别的传播率为 $\\mathcal{T}$，这意味着每次通过一条边的感染性接触都以概率 $\\mathcal{T}$ 独立地传播病毒，否则传播失败。假设网络是局部树状的，并且适用于配置模型网络的平均场生成函数方法。\n\n仅使用配置模型网络的第一性原理，以及将最终SIR传染病规模映射到网络上的键渗流的方法，确定最终传染病规模 $R_{\\infty}$，即最终被感染然后恢复的群体比例。您的推导应从与 $P(k)$ 相关的生成函数的定义以及关于感染不再进一步传播的边概率的自洽论证出发。计算当 $\\mathcal{T} = 0.6$ 时您的结果。\n\n将您的最终答案表示为一个无单位的纯数，并四舍五入到六位有效数字。",
            "solution": "该问题要求计算在一个3-正则随机网络上易感-感染-恢复 (SIR) 传染病的最终规模。3-正则随机网络是指每个节点的度都为 $k=3$ 的网络。分析将使用平均场生成函数方法，并利用SIR传染病最终状态与键渗流之间的映射关系。\n\n首先，我们定义与网络度分布 $P(k)$ 相关的生成函数。问题陈述该网络由配置模型生成，其中 $P(3)=1$ 且对于所有 $k \\neq 3$ 都有 $P(k)=0$。\n\n度分布的生成函数 $G_0(x)$ 定义为 $G_0(x) = \\sum_{k=0}^{\\infty} P(k) x^k$。对于给定的分布，这变为：\n$$\nG_0(x) = P(3)x^3 = 1 \\cdot x^3 = x^3\n$$\n\n超额度分布的生成函数 $G_1(x)$ 描述了通过遍历一条随机边到达的节点的出边数量的分布。它定义为 $G_1(x) = \\sum_{k=1}^{\\infty} \\frac{k P(k)}{\\langle k \\rangle} x^{k-1}$。首先，我们计算平均度 $\\langle k \\rangle$：\n$$\n\\langle k \\rangle = \\sum_{k=0}^{\\infty} k P(k) = 3 \\cdot P(3) = 3 \\cdot 1 = 3\n$$\n将此代入 $G_1(x)$ 的定义中：\n$$\nG_1(x) = \\frac{3 P(3)}{\\langle k \\rangle} x^{3-1} = \\frac{3 \\cdot 1}{3} x^2 = x^2\n$$\n\nSIR传染病的最终规模 $R_{\\infty}$ 等同于网络上键渗流过程中巨大连通分量 (GCC) 的相对大小。在此映射中，每条边以等于传播率 $\\mathcal{T}$ 的概率被“占据”（即可以传播感染）。\n\n令 $v$ 为沿着一条随机选择的边*不*会导向被感染节点的巨大分量的概率。一条边未能导向GCC，可能是因为 (a) 该边是“未被占据的”（传播失败），其概率为 $1-\\mathcal{T}$，或者 (b) 该边是“被占据的”（传播成功，概率为 $\\mathcal{T}$），但另一端的节点没有通过其任何其他边连接到GCC。\n\n通过遍历一条边到达的节点具有由 $G_1(x)$ 生成的超额度分布。如果这个节点有 $k-1$ 条其他边，那么它们中没有一条导向GCC的概率是 $v^{k-1}$。对所有可能的超额度进行平均，目标节点未通过其其他边连接到GCC的概率由 $\\sum_{k=1}^{\\infty} \\frac{k P(k)}{\\langle k \\rangle} v^{k-1} = G_1(v)$ 给出。\n\n结合这些可能性，我们可以写出关于 $v$ 的自洽方程：\n$$\nv = (1 - \\mathcal{T}) + \\mathcal{T} G_1(v)\n$$\n代入我们对 $G_1(x)$ 的表达式，我们得到：\n$$\nv = 1 - \\mathcal{T} + \\mathcal{T} v^2\n$$\n这可以重排为关于 $v$ 的二次方程：\n$$\n\\mathcal{T} v^2 - v + (1 - \\mathcal{T}) = 0\n$$\n我们使用二次求根公式解出 $v$：\n$$\nv = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(\\mathcal{T})(1-\\mathcal{T})}}{2\\mathcal{T}} = \\frac{1 \\pm \\sqrt{1 - 4\\mathcal{T} + 4\\mathcal{T}^2}}{2\\mathcal{T}} = \\frac{1 \\pm \\sqrt{(1 - 2\\mathcal{T})^2}}{2\\mathcal{T}} = \\frac{1 \\pm |1 - 2\\mathcal{T}|}{2\\mathcal{T}}\n$$\n这个方程的一个解总是 $v=1$，这对应于没有传染病发生（没有GCC）的情况。只有当存在一个解 $v1$ 时，才可能发生非平凡的传染病。这发生在超过传染病阈值时，对于这个模型，阈值条件是 $\\mathcal{T} G_1'(1)  1$。由于 $G_1'(x) = 2x$，所以 $G_1'(1) = 2$，条件变为 $2\\mathcal{T}  1$，即 $\\mathcal{T}  1/2 = 0.5$。\n\n问题指定 $\\mathcal{T} = 0.6$，大于 $0.5$。因此，预计会发生非平凡的传染病。对于 $\\mathcal{T} > 0.5$，我们有 $1 - 2\\mathcal{T}  0$，所以 $|1-2\\mathcal{T}| = -(1-2\\mathcal{T}) = 2\\mathcal{T}-1$。$v$ 的两个根是：\n$$\nv = \\frac{1 \\pm (2\\mathcal{T}-1)}{2\\mathcal{T}}\n$$\n一个根是 $v_+ = \\frac{1 + 2\\mathcal{T}-1}{2\\mathcal{T}} = \\frac{2\\mathcal{T}}{2\\mathcal{T}} = 1$。另一个非平凡的根是：\n$$\nv_- = \\frac{1 - (2\\mathcal{T}-1)}{2\\mathcal{T}} = \\frac{2 - 2\\mathcal{T}}{2\\mathcal{T}} = \\frac{1-\\mathcal{T}}{\\mathcal{T}}\n$$\n这就是一条边不导向GCC的概率的具有物理意义的解。\n\n最终传染病规模 $R_{\\infty}$ 是GCC中节点的比例。一个随机选择的节点如果其所有边都不导向GCC，那么它就*不*在GCC中。如果一个节点的度为 $k$，这个概率是 $v^k$。对度分布 $P(k)$ 进行平均，一个随机节点不在GCC中的概率是 $\\sum_k P(k) v^k = G_0(v)$。因此，GCC的大小是：\n$$\nR_{\\infty} = 1 - G_0(v)\n$$\n代入我们对 $G_0(x)$ 和 $v$ 的表达式：\n$$\nR_{\\infty} = 1 - v^3 = 1 - \\left(\\frac{1-\\mathcal{T}}{\\mathcal{T}}\\right)^3\n$$\n现在我们为给定的传播率 $\\mathcal{T}=0.6$ 计算这个表达式的值：\n$$\nR_{\\infty} = 1 - \\left(\\frac{1-0.6}{0.6}\\right)^3 = 1 - \\left(\\frac{0.4}{0.6}\\right)^3 = 1 - \\left(\\frac{2}{3}\\right)^3\n$$\n$$\nR_{\\infty} = 1 - \\frac{8}{27} = \\frac{27-8}{27} = \\frac{19}{27}\n$$\n为了得到数值答案，我们计算这个分数的值，并四舍五入到六位有效数字：\n$$\nR_{\\infty} = \\frac{19}{27} \\approx 0.703703703...\n$$\n四舍五入到六位有效数字得到 $0.703704$。",
            "answer": "$$\\boxed{0.703704}$$"
        },
        {
            "introduction": "标准的平均场模型常常假设网络是无关联的，但这在现实世界中未必成立。这个高级练习将挑战你超越这一基本假设。你将学习如何通过线性化动力学系统并分析其系统矩阵的谱特性，来推导具有度-度相关的网络上的疫情阈值，从而得到一个更精确、更普适的结论。",
            "id": "4287250",
            "problem": "考虑一个在大型、稀疏、无向网络上的易感-感染-易感 (SIS) 传播过程。每个节点的度 $k$ 从度分布 $P(k)$ 中抽取，每次接触的感染率为 $\\beta$，恢复率为 $\\mu$。令 $i_{k}(t)$ 表示度为 $k$ 的节点在时间 $t$ 被感染的概率。该网络表现出度相关性，其量化由条件概率 $P(k' \\mid k)$ 给出，该概率表示一个度为 $k$ 的节点的随机选择的邻居的度为 $k'$。对于所有度 $k$ 和 $k'$，度-度相关性遵循无向网络的细致平衡约束 $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$。\n\n从第一性原理和基于度的平均场近似出发，完成以下任务：\n\n1. 写出关于 $i_{k}(t)$ 的异质平均场速率方程，该方程通过 $P(k' \\mid k)$ 考虑了度异质性和度相关性。围绕无病平衡点 $i_{k} \\equiv 0$ 对该动力学系统进行线性化，并利用线性系统的稳定性分析，用一个由 $P(k' \\mid k)$ 和度值 $\\{k\\}$ 构建的矩阵的光谱半径来表示流行病阈值条件。\n\n2. 利用此谱特征，陈述在何种关于 $P(k' \\mid k)$ 的精确条件下，为不相关网络推导的广泛使用的基于矩的阈值是无效的。在相同的平均场框架内，为相关混合情况下的阈值提供一个修正表达式。\n\n3. 考虑一个具有两类度分布的网络，其度为 $k_{1} = 2$ 和 $k_{2} = 8$，概率为 $P(k_{1}) = \\frac{4}{5}$ 和 $P(k_{2}) = \\frac{1}{5}$。指定的条件概率为 $P(k_{1} \\mid k_{1}) = \\frac{7}{10}$ 和 $P(k_{2} \\mid k_{1}) = \\frac{3}{10}$。利用细致平衡约束确定 $P(k_{1} \\mid k_{2})$ 和 $P(k_{2} \\mid k_{2})$，然后构建用于 SIS 动力学线性化的相应度相关矩阵。以精确的封闭形式，计算该网络临界比率 $\\beta / \\mu$ 的修正平均场流行病阈值，并将其表示为单个解析表达式。最终答案以精确的符号表达式给出。最终答案中不包含任何单位。",
            "solution": "首先验证问题。给定条件是：一个在大型、稀疏、无向网络上的易感-感染-易感 (SIS) 模型；感染率 $\\beta$；恢复率 $\\mu$；度分布 $P(k)$；度-度相关的条件概率 $P(k' \\mid k)$；变量 $i_k(t)$ 为度为 $k$ 的节点被感染的概率；以及细致平衡约束 $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$。给出了一个两类网络的具体数值：$k_1 = 2$， $k_2 = 8$， $P(k_1) = \\frac{4}{5}$， $P(k_2) = \\frac{1}{5}$， $P(k_1 \\mid k_1) = \\frac{7}{10}$，以及 $P(k_2 \\mid k_1) = \\frac{3}{10}$。该问题在网络流行病学方面有科学依据，是自洽的，并且在数学上是适定的。所提供的数值与概率论和细致平衡约束一致。因此，该问题被认为是有效的，可以构建解决方案。\n\n**1. 异质平均场方程和流行病阈值**\n\n我们首先推导 $i_k(t)$ 的速率方程，即度为 $k$ 的受感染节点的分数。$i_k(t)$ 的变化由两个过程控制：恢复和感染。\n- 一个度为 $k$ 的受感染节点以速率 $\\mu$ 恢复并变为易感状态。这对变化率贡献了一个项 $-\\mu i_k(t)$。\n- 一个度为 $k$ 的易感节点（其分数为 $1-i_k(t)$）通过与邻居接触而被感染。感染速率与感染率 $\\beta$、邻居数 $k$ 以及随机选择的邻居被感染的概率成正比。这个概率，我们称之为 $\\theta_k(t)$，取决于中心节点的度 $k$。\n\n在基于度的平均场近似中，我们通过对邻居的度进行平均来表示 $\\theta_k(t)$。一个度为 $k$ 的节点的邻居度为 $k'$ 的概率是 $P(k' \\mid k)$。这个度为 $k'$ 的邻居被感染的概率是 $i_{k'}(t)$。对所有可能的邻居度 $k'$ 求和，我们得到：\n$$ \\theta_k(t) = \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) $$\n一个度为 $k$ 的易感节点被感染的总速率是 $\\beta k \\theta_k(t)$。假设来自邻居的感染事件是独立的，则 $i_k(t)$ 的增益项是 $\\beta k (1-i_k(t)) \\theta_k(t)$。\n\n结合增益和损失项，我们得到完整的非线性速率方程：\n$$ \\frac{di_k}{dt} = \\beta k (1-i_k(t)) \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) - \\mu i_k(t) $$\n为了找到流行病阈值，我们分析无病平衡点 (DFE) 的稳定性，此时对所有 $k$ 都有 $i_k(t) = 0$。令 $i_k(t) = \\epsilon_k(t)$，其中 $\\epsilon_k(t)$ 是一个小扰动。将此代入速率方程，并通过舍去 $\\epsilon^2$ 及更高阶的项（即，令 $1-\\epsilon_k \\approx 1$）进行线性化：\n$$ \\frac{d\\epsilon_k}{dt} \\approx \\beta k \\sum_{k'} P(k' \\mid k) \\, \\epsilon_{k'}(t) - \\mu \\epsilon_k(t) $$\n这是一个线性常微分方程组。设网络中不同的度为 $\\{k_1, k_2, \\dots, k_N\\}$。我们可以将该系统写成向量形式 $\\frac{d\\vec{\\epsilon}}{dt} = J \\vec{\\epsilon}$，其中 $\\vec{\\epsilon}$ 是扰动向量 $(\\epsilon_{k_1}, \\epsilon_{k_2}, \\dots, \\epsilon_{k_N})^T$，$J$ 是雅可比矩阵。$J$ 的元素由下式给出：\n$$ J_{ij} = \\beta k_i P(k_j \\mid k_i) - \\mu \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克 δ。我们可以将 $J$ 表示为 $J = \\beta M - \\mu I$，其中 $I$ 是单位矩阵，$M$ 是一个元素为 $M_{ij} = k_i P(k_j \\mid k_i)$ 的矩阵。\n\n如果 $J$ 的任何一个特征值的实部为正，则 DFE 是不稳定的。$J$ 的特征值为 $\\lambda_J = \\beta \\lambda_M - \\mu$，其中 $\\lambda_M$ 是 $M$ 的特征值。不稳定的条件是 $\\max(\\text{Re}(\\lambda_J))  0$，这可以转化为 $\\beta \\max(\\text{Re}(\\lambda_M)) - \\mu  0$。矩阵 $M$ 的元素非负，因此根据佩龙-弗罗贝尼乌斯定理，其最大特征值是实数且为正。该特征值即为光谱半径 $\\rho(M)$。因此，$\\max(\\text{Re}(\\lambda_M)) = \\rho(M)$。\n\n流行病阈值是传播率 $\\lambda = \\beta / \\mu$ 的临界值，在该值处 DFE 失去稳定性。爆发的条件是 $\\frac{\\beta}{\\mu} \\rho(M)  1$。因此，阈值条件可以用矩阵 $M$ 的光谱半径表示为：\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\n其中 $M$ 是一个矩阵，其元素为 $M_{ij} = k_i P(k_j \\mid k_i)$，对应于不同的度类 $i$ 和 $j$。\n\n**2. 不相关网络阈值无效的条件**\n\n对于不相关网络，广泛使用的基于矩的阈值是 $(\\frac{\\beta}{\\mu})_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$。这个结果是在假设 $P(k' \\mid k)$ 与 $k$ 无关的情况下推导出来的，具体来说，即 $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$，其中 $\\langle k \\rangle = \\sum_k k P(k)$ 且 $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$。\n\n当网络表现出度相关性时，基于矩的阈值就无效了，这意味着假设 $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$ 并不对所有的对 $(k, k')$ 成立。这发生在具有选型混合（高-度节点倾向于连接其他高-度节点）或异型混合（高-度节点倾向于连接低-度节点）的网络中。\n\n在相关混合情况下，流行病阈值的修正表达式正是上一节中通过稳定性分析推导出的表达式：\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\n其中 $M_{ij} = k_i P(k_j \\mid k_i)$。这个表达式是通用的，对于相关和不相关网络都有效，在没有相关性的特定情况下，它会简化为基于矩的公式。\n\n**3. 两类网络的计算**\n\n给定一个具有两类度的网络，$k_1 = 2$ 和 $k_2 = 8$，其概率为 $P(k_1) = \\frac{4}{5}$ 和 $P(k_2) = \\frac{1}{5}$。条件概率为 $P(k_1 \\mid k_1) = \\frac{7}{10}$ 和 $P(k_2 \\mid k_1) = \\frac{3}{10}$。由于 $\\sum_{k'} P(k' \\mid k) = 1$，我们可以验证 $P(k_1 \\mid k_1) + P(k_2 \\mid k_1) = \\frac{7}{10} + \\frac{3}{10} = 1$，这是自洽的。\n\n我们首先利用细致平衡约束来确定剩余的条件概率 $P(k_1 \\mid k_2)$ 和 $P(k_2 \\mid k_2)$：$k_1 P(k_1) P(k_2 \\mid k_1) = k_2 P(k_2) P(k_1 \\mid k_2)$。\n$$ (2) \\left(\\frac{4}{5}\\right) \\left(\\frac{3}{10}\\right) = (8) \\left(\\frac{1}{5}\\right) P(k_1 \\mid k_2) $$\n$$ \\frac{24}{50} = \\frac{8}{5} P(k_1 \\mid k_2) $$\n$$ P(k_1 \\mid k_2) = \\frac{24}{50} \\cdot \\frac{5}{8} = \\frac{3}{10} $$\n对 $k=k_2$ 使用归一化条件，我们有 $P(k_1 \\mid k_2) + P(k_2 \\mid k_2) = 1$。\n$$ P(k_2 \\mid k_2) = 1 - P(k_1 \\mid k_2) = 1 - \\frac{3}{10} = \\frac{7}{10} $$\n现在我们构建 $2 \\times 2$ 矩阵 $M$，其元素为 $M_{ij} = k_i P(k_j \\mid k_i)$：\n$M_{11} = k_1 P(k_1 \\mid k_1) = 2 \\cdot \\frac{7}{10} = \\frac{14}{10} = \\frac{7}{5}$\n$M_{12} = k_1 P(k_2 \\mid k_1) = 2 \\cdot \\frac{3}{10} = \\frac{6}{10} = \\frac{3}{5}$\n$M_{21} = k_2 P(k_1 \\mid k_2) = 8 \\cdot \\frac{3}{10} = \\frac{24}{10} = \\frac{12}{5}$\n$M_{22} = k_2 P(k_2 \\mid k_2) = 8 \\cdot \\frac{7}{10} = \\frac{56}{10} = \\frac{28}{5}$\n\n矩阵 $M$ 是：\n$$ M = \\begin{pmatrix} \\frac{7}{5}  \\frac{3}{5} \\\\ \\frac{12}{5}  \\frac{28}{5} \\end{pmatrix} $$\n为了找到光谱半径 $\\rho(M)$，我们通过解特征方程 $\\det(M - \\lambda I) = 0$ 来计算特征值：\n$$ \\det \\begin{pmatrix} \\frac{7}{5} - \\lambda  \\frac{3}{5} \\\\ \\frac{12}{5}  \\frac{28}{5} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(\\frac{7}{5} - \\lambda\\right)\\left(\\frac{28}{5} - \\lambda\\right) - \\left(\\frac{3}{5}\\right)\\left(\\frac{12}{5}\\right) = 0 $$\n$$ \\lambda^2 - \\left(\\frac{7}{5} + \\frac{28}{5}\\right)\\lambda + \\frac{7 \\cdot 28}{25} - \\frac{3 \\cdot 12}{25} = 0 $$\n$$ \\lambda^2 - \\frac{35}{5}\\lambda + \\frac{196 - 36}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{160}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{32}{5} = 0 $$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$ \\lambda = \\frac{7 \\pm \\sqrt{(-7)^2 - 4(1)\\left(\\frac{32}{5}\\right)}}{2} = \\frac{7 \\pm \\sqrt{49 - \\frac{128}{5}}}{2} $$\n$$ \\lambda = \\frac{7 \\pm \\sqrt{\\frac{245 - 128}{5}}}{2} = \\frac{7 \\pm \\sqrt{\\frac{117}{5}}}{2} $$\n光谱半径 $\\rho(M)$ 是最大的特征值：\n$$ \\rho(M) = \\frac{7 + \\sqrt{\\frac{117}{5}}}{2} = \\frac{7 + \\frac{\\sqrt{9 \\cdot 13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{65}}{5}}{2} = \\frac{35 + 3\\sqrt{65}}{10} $$\n流行病阈值是光谱半径的倒数：\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{1}{\\rho(M)} = \\frac{10}{35 + 3\\sqrt{65}} $$\n为了使分母有理化，我们将分子和分母同乘以共轭项 $35 - 3\\sqrt{65}$：\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{(35 + 3\\sqrt{65})(35 - 3\\sqrt{65})} = \\frac{10(35 - 3\\sqrt{65})}{35^2 - (3\\sqrt{65})^2} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{1225 - 9 \\cdot 65} = \\frac{10(35 - 3\\sqrt{65})}{1225 - 585} = \\frac{10(35 - 3\\sqrt{65})}{640} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{35 - 3\\sqrt{65}}{64} $$\n这是临界比率 $\\beta / \\mu$ 的精确符号表达式。",
            "answer": "$$ \\boxed{\\frac{35 - 3\\sqrt{65}}{64}} $$"
        }
    ]
}