{
    "hands_on_practices": [
        {
            "introduction": "我们从一个最简单的系统开始，以建立对平均场方法核心思想的直观理解。这个练习将淬火平均场（QMF）近似应用于一个仅包含两个节点的有向加权网络模体。通过为每个节点写下感染概率的动力学方程并求解其稳态，我们可以清晰地看到平均场近似的基本操作，并揭示即使在最微观的尺度上，网络结构（如非对称权重）如何产生非平凡的动力学效应 。",
            "id": "4287177",
            "problem": "考虑一个具有2个节点（标记为1和2）的小型有向加权网络基序上的易感-感染-易感（SIS）流行病过程。从节点$j$到节点$i$的有向传播沿着权重为$w_{ji}$的有向边发生，感染率与全局传播率参数$\\beta>0$和权重$w_{ji}>0$的乘积成正比。每个受感染的节点以独立的恢复率$\\mu>0$恢复。令$p_i(t)$表示节点$i$在时间$t$的感染概率。在淬火平均场（QMF）近似（其中节点状态独立且邻接关系固定）中，易感节点$i$的感染风险是沿所有入边的瞬时感染压力之和，每条边的感染压力等于$\\beta w_{ji} p_j(t)$。假设该基序恰好有两条有向边：$w_{12}=a>0$（从节点1到节点2）和$w_{21}=b>0$（从节点2到节点1），没有自环或其他边。\n\n从上述SIS过程和平均场闭合假设出发，推导QMF动力学的稳态方程，并解析地求解非平凡稳态感染概率$p_1^{\\ast}$和$p_2^{\\ast}$，将其表示为$a$、$b$、$\\beta$和$\\mu$的函数。然后，计算由下式定义的稳态平均流行率$\\bar{p}^{\\ast}$：\n$$\n\\bar{p}^{\\ast} \\equiv \\frac{p_1^{\\ast} + p_2^{\\ast}}{2}.\n$$\n假设参数满足$a>0$、$b>0$、$\\beta>0$、$\\mu>0$，并且存在非零稳态。请提供$\\bar{p}^{\\ast}$关于$a$、$b$、$\\beta$和$\\mu$的单个闭式解析表达式作为最终答案。无需四舍五入。在您的推导中，简要讨论与对称情况$a=b$相比，非对称权重$a \\neq b$如何影响$p_1^{\\ast}$、$p_2^{\\ast}$和$\\bar{p}^{\\ast}$。",
            "solution": "该问题陈述在科学上是可靠的、提法恰当、客观且自洽的。它描述了一个2节点有向网络上的典型易感-感染-易感（SIS）模型，这是网络流行病学中的一个标准问题。所有参数和假设，包括使用淬火平均场（QMF）近似，都得到了明确定义。任务是推导并求解非平凡稳态概率和平均流行率。假设存在非零稳态消除了歧义。因此，该问题是有效的，可以求解。\n\n我们首先根据QMF近似，为节点1和2的感染概率$p_1(t)$和$p_2(t)$建立微分方程。节点$i$的感染概率变化率$\\frac{dp_i}{dt}$是感染率与恢复率之差。\n\n易感节点$i$的感染率是其易感概率$1-p_i(t)$乘以其受感染邻居带来的总感染压力（或风险）。问题陈述指出，此风险为$\\sum_j \\beta w_{ji} p_j(t)$，其中$\\beta$是全局传播率参数，$w_{ji}$是有向边权重。受感染节点$i$的恢复率是其被感染的概率$p_i(t)$乘以恢复率$\\mu$。\n\n因此，节点$i$的一般QMF方程为：\n$$\n\\frac{dp_i}{dt} = (1-p_i(t)) \\sum_j \\beta w_{ji} p_j(t) - \\mu p_i(t)\n$$\n\n对于指定的2节点网络，权重为$w_{21}=b$（从节点2到1）和$w_{12}=a$（从节点1到2），所有其他权重均为零。$p_1(t)$和$p_2(t)$的方程组变为：\n$$\n\\frac{dp_1}{dt} = (1-p_1(t)) \\beta b p_2(t) - \\mu p_1(t)\n$$\n$$\n\\frac{dp_2}{dt} = (1-p_2(t)) \\beta a p_1(t) - \\mu p_2(t)\n$$\n\n为了找到稳态解，记为$p_1^{\\ast}$和$p_2^{\\ast}$，我们将时间导数设为零：\n$$\n(1-p_1^{\\ast}) \\beta b p_2^{\\ast} - \\mu p_1^{\\ast} = 0 \\quad \\quad (1)\n$$\n$$\n(1-p_2^{\\ast}) \\beta a p_1^{\\ast} - \\mu p_2^{\\ast} = 0 \\quad \\quad (2)\n$$\n\n问题要求的是非平凡稳态，因此我们假设$p_1^{\\ast} > 0$和$p_2^{\\ast} > 0$。我们可以重新整理方程：\n$$\n\\mu p_1^{\\ast} = \\beta b p_2^{\\ast} (1-p_1^{\\ast})\n$$\n$$\n\\mu p_2^{\\ast} = \\beta a p_1^{\\ast} (1-p_2^{\\ast})\n$$\n\n为了解这个方程组，我们可以从第一个方程中用$p_2^{\\ast}$表示$p_1^{\\ast}$：\n$$\n\\mu p_1^{\\ast} + \\beta b p_1^{\\ast} p_2^{\\ast} = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} (\\mu + \\beta b p_2^{\\ast}) = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} = \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}}\n$$\n将这个$p_1^{\\ast}$的表达式代入第二个稳态方程：\n$$\n\\mu p_2^{\\ast} = \\beta a \\left( \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\n因为我们寻求的是$p_2^{\\ast} \\neq 0$的非平凡解，所以我们可以将两边同除以$p_2^{\\ast}$：\n$$\n\\mu = \\beta a \\left( \\frac{\\beta b}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\n两边同乘以$(\\mu + \\beta b p_2^{\\ast})$得到：\n$$\n\\mu(\\mu + \\beta b p_2^{\\ast}) = \\beta^2 ab (1-p_2^{\\ast})\n$$\n$$\n\\mu^2 + \\mu \\beta b p_2^{\\ast} = \\beta^2 ab - \\beta^2 ab p_2^{\\ast}\n$$\n现在，我们求解$p_2^{\\ast}$：\n$$\np_2^{\\ast} (\\mu \\beta b + \\beta^2 ab) = \\beta^2 ab - \\mu^2\n$$\n$$\np_2^{\\ast} (\\beta b (\\mu + \\beta a)) = \\beta^2 ab - \\mu^2\n$$\n这给出了$p_2^{\\ast}$的解：\n$$\np_2^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)}\n$$\n问题陈述中说明存在非零稳态，这意味着$\\beta^2 ab - \\mu^2 > 0$，即$\\beta\\sqrt{ab} > \\mu$。这是该系统中疫情爆发的众所周知的条件，其中$\\sqrt{ab}$是网络加权邻接矩阵的谱半径。\n\n根据对称性，交换标签$(1 \\leftrightarrow 2)$等价于交换权重$(a \\leftrightarrow b)$。因此，我们可以通过在$p_2^{\\ast}$的表达式中互换$a$和$b$来找到$p_1^{\\ast}$：\n$$\np_1^{\\ast} = \\frac{\\beta^2 ba - \\mu^2}{\\beta a (\\beta b + \\mu)}\n$$\n\n接下来，我们计算稳态平均流行率$\\bar{p}^{\\ast}$：\n$$\n\\bar{p}^{\\ast} = \\frac{p_1^{\\ast} + p_2^{\\ast}}{2} = \\frac{1}{2} \\left[ \\frac{\\beta^2 ab - \\mu^2}{\\beta a (\\beta b + \\mu)} + \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)} \\right]\n$$\n提出公因式$(\\beta^2 ab - \\mu^2)$：\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2} \\left[ \\frac{1}{\\beta a (\\beta b + \\mu)} + \\frac{1}{\\beta b (\\beta a + \\mu)} \\right]\n$$\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left[ \\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} \\right]\n$$\n为了合并方括号中的分数，我们使用公分母$ab(\\beta b + \\mu)(\\beta a + \\mu)$：\n$$\n\\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} = \\frac{b(\\beta a + \\mu) + a(\\beta b + \\mu)}{ab(\\beta b + \\mu)(\\beta a + \\mu)} = \\frac{\\beta ab + b\\mu + \\beta ab + a\\mu}{ab(\\beta^2 ab + \\beta a \\mu + \\beta b \\mu + \\mu^2)}\n$$\n$$\n= \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\n将此代回$\\bar{p}^{\\ast}$的表达式中：\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left( \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)} \\right)\n$$\n这简化为最终的闭式表达式：\n$$\n\\bar{p}^{\\ast} = \\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\n\n最后，我们讨论非对称权重的影响。在对称情况下，即$a=b$，概率相等：$p_1^{\\ast} = p_2^{\\ast} = 1 - \\frac{\\mu}{\\beta a}$。当权重非对称时，比如$a>b$，节点1是比节点2更强的传播者。$p_1^{\\ast}$和$p_2^{\\ast}$的分母分别是$\\beta a (\\beta b + \\mu)$和$\\beta b (\\beta a + \\mu)$。\n$p_1^{\\ast}$的分母：$\\beta^2 ab + a\\beta\\mu$。\n$p_2^{\\ast}$的分母：$\\beta^2 ab + b\\beta\\mu$。\n由于$a>b$且所有参数均为正，所以$a\\beta\\mu > b\\beta\\mu$，这意味着$p_1^{\\ast}$的分母大于$p_2^{\\ast}$的分母。由于分子相同，这导致$p_1^{\\ast}  p_2^{\\ast}$。\n这是一个关键的网络效应：作为更强传播者（具有更大的出向权重$a=w_{12}$）的节点，其个体感染概率较低，因为它从其较弱传播的邻居那里接收到的感染压力较小。相反，较弱的传播者（节点2）面临更强的感染压力，因此具有更高的感染概率。\n\n关于平均流行率$\\bar{p}^{\\ast}$，考虑权重几何平均值$\\sqrt{ab}$保持不变的情况。这固定了疫情阈值条件。算术平均-几何平均不等式指出，对于$a,b>0$，有$a+b \\ge 2\\sqrt{ab}$，当且仅当$a=b$时等号成立。因此，对于固定的乘积$ab$，和$a+b$在对称情况下最小化。对$\\bar{p}^{\\ast}$的表达式进行分析表明，（在$ab$固定的情况下）它是$a+b$这个和的递减函数。因此，平均流行率$\\bar{p}^{\\ast}$在对称情况（$a=b$）下最大化，并因权重的任何不对称性而降低。",
            "answer": "$$\n\\boxed{\\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}}\n$$"
        },
        {
            "introduction": "在理解了单个节点的平均场行为后，我们将尺度放大到大型异质网络。此练习采用了异质平均场（HMF）近似，这是一种处理网络中节点度数多样性的强大技术。您将通过为不同度类的节点构建动力学方程，并为一个关键量——即随机选择的邻居节点被感染的概率（$\\Theta$）——建立自洽方程，来推导地方性流行的稳态感染率 。这个过程是网络流行病学中一个核心的分析工具。",
            "id": "4287187",
            "problem": "考虑一个在异质平均场（HMF）近似下的大规模、稀疏、无关联网络上的连续时间易感-感染-易感（SIS）传染过程，该网络有两个度类。设度分布支持在两个度 $k_{a} \\in \\mathbb{N}$ 和 $k_{b} \\in \\mathbb{N}$ 上，其概率分别为 $\\pi \\in (0,1)$ 和 $1 - \\pi$。每条易感-感染边的感染率为 $\\beta  0$，每个感染节点的恢复率为 $\\mu  0$。分别用 $i_{a}(t)$ 和 $i_{b}(t)$ 表示度类 $k_{a}$ 和 $k_{b}$ 中感染节点的比例。设平均度为 $\\langle k \\rangle = k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)$，并设随机选择的邻居被感染的概率为 $\\,\\Theta(t)\\,$，对于无关联混合，其定义为 $\\Theta(t) = \\big(k_{a}\\,\\pi\\,i_{a}(t) + k_{b}\\,(1 - \\pi)\\,i_{b}(t)\\big)/\\langle k \\rangle$。将流行率 $p(t)$ 定义为群体中感染节点的比例，$p(t) = \\pi\\,i_{a}(t) + (1 - \\pi)\\,i_{b}(t)$。\n\n从标准的连续时间SIS流量平衡和上述无关联混合闭合出发，执行以下操作：\n\n- 推导 $i_{a}(t)$ 和 $i_{b}(t)$ 的异质平均场动力学方程。\n- 应用稳态条件，得到 $i_{a}^{*}$、$i_{b}^{*}$ 和关于 $\\Theta^{*}$ 的自洽方程。\n- 精确求解自洽方程，得到稳态流行率 $p^{*} = \\pi\\,i_{a}^{*} + (1 - \\pi)\\,i_{b}^{*}$ 作为 $\\beta$、$\\mu$、$k_{a}$、$k_{b}$ 和 $\\pi$ 的函数的闭式表达式。\n- 在地方病不动点 $\\big(i_{a}^{*}, i_{b}^{*}\\big)$ 附近对二维动力学系统进行线性化，并计算雅可比矩阵。使用其特征值陈述地方病不动点局部渐近稳定的条件。\n\n您的最终答案必须是 $p^{*}$ 关于 $\\beta$、$\\mu$、$k_{a}$、$k_{b}$ 和 $\\pi$ 的单个精确闭式解析表达式。该答案是无量纲的。不要四舍五入；请提供精确表达式。",
            "solution": "我们从标准的连续时间易感-感染-易感（SIS）流量平衡开始。在无关联网络的异质平均场中，度类 $k$ 的感染比例演化遵循以下方程\n$$\n\\frac{d i_{k}(t)}{dt} \\;=\\; -\\,\\mu\\,i_{k}(t) \\;+\\; \\beta\\,k\\,\\big(1 - i_{k}(t)\\big)\\,\\Theta(t),\n$$\n其中 $\\Theta(t)$ 是随机选择的邻居被感染的概率。对于所描述的双类网络，\n$$\n\\Theta(t) \\;=\\; \\frac{k_{a}\\,\\pi\\,i_{a}(t) + k_{b}\\,(1 - \\pi)\\,i_{b}(t)}{\\langle k \\rangle}, \n\\qquad \n\\langle k \\rangle \\;=\\; k_{a}\\,\\pi + k_{b}\\,(1 - \\pi),\n$$\n且流行率为 $p(t) = \\pi\\,i_{a}(t) + (1 - \\pi)\\,i_{b}(t)$。\n\n将流量平衡应用于每个度类，我们得到二维系统\n$$\n\\frac{d i_{a}}{dt} \\;=\\; -\\,\\mu\\,i_{a} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}\\big)\\,\\Theta,\n\\qquad\n\\frac{d i_{b}}{dt} \\;=\\; -\\,\\mu\\,i_{b} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}\\big)\\,\\Theta,\n$$\n其闭合关系为\n$$\n\\Theta \\;=\\; \\frac{k_{a}\\,\\pi\\,i_{a} + k_{b}\\,(1 - \\pi)\\,i_{b}}{\\langle k \\rangle}.\n$$\n\n在稳态下，$d i_{a}/dt = 0$ 且 $d i_{b}/dt = 0$，对每个类产生：\n$$\n0 \\;=\\; -\\,\\mu\\,i_{k}^{*} \\;+\\; \\beta\\,k\\,\\big(1 - i_{k}^{*}\\big)\\,\\Theta^{*},\n\\quad\\Rightarrow\\quad\ni_{k}^{*} \\;=\\; \\frac{\\beta\\,k\\,\\Theta^{*}}{\\mu + \\beta\\,k\\,\\Theta^{*}},\n\\quad\nk \\in \\{k_{a}, k_{b}\\}.\n$$\n由此，闭合关系成为 $\\Theta^{*}$ 的一个自洽条件：\n$$\n\\Theta^{*} \\;=\\; \\frac{k_{a}\\,\\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; k_{b}\\,(1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}}{\\langle k \\rangle}.\n$$\n假设 $\\Theta^{*}  0$，两边同除以 $\\Theta^{*}$ 得到\n$$\n1 \\;=\\; \\frac{\\beta}{\\langle k \\rangle}\\left[\n\\frac{k_{a}^{2}\\,\\pi}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; \\frac{k_{b}^{2}\\,(1 - \\pi)}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\n\\right].\n$$\n这可以合并成一个单一的有理函数。定义\n$$\nA \\;=\\; k_{a}^{2}\\,\\pi, \\quad B \\;=\\; k_{b}^{2}\\,(1 - \\pi), \\quad a \\;=\\; \\beta\\,k_{a}, \\quad b \\;=\\; \\beta\\,k_{b}, \\quad m \\;=\\; \\langle k \\rangle \\;=\\; k_{a}\\,\\pi + k_{b}\\,(1 - \\pi).\n$$\n则\n$$\n1 \\;=\\; \\frac{\\beta}{m}\\,\\frac{(A + B)\\,\\mu \\;+\\; (A\\,b + B\\,a)\\,\\Theta^{*}}{\\mu^{2} \\;+\\; \\mu\\,(a + b)\\,\\Theta^{*} \\;+\\; a\\,b\\,\\Theta^{*\\,2}}.\n$$\n两边同乘以分母，得到一个关于 $\\Theta^{*}$ 的二次方程：\n$$\na\\,b\\,\\Theta^{*\\,2} \\;+\\; \\mu\\,(a + b)\\,\\Theta^{*} \\;+\\; \\mu^{2} \\;-\\; \\frac{\\beta}{m}\\,\\Big( (A + B)\\,\\mu \\;+\\; (A\\,b + B\\,a)\\,\\Theta^{*} \\Big) \\;=\\; 0.\n$$\n回到原始参数，这个二次方程可以写成\n$$\nC_{2}\\,\\Theta^{*\\,2} \\;+\\; C_{1}\\,\\Theta^{*} \\;+\\; C_{0} \\;=\\; 0,\n$$\n其系数为\n$$\nC_{2} \\;=\\; \\beta^{2}\\,k_{a}\\,k_{b},\n$$\n$$\nC_{1} \\;=\\; \\mu\\,\\beta\\,(k_{a} + k_{b}) \\;-\\; \\frac{\\beta^{2}}{m}\\Big( k_{a}^{2}\\,\\pi\\,k_{b} \\;+\\; k_{b}^{2}\\,(1 - \\pi)\\,k_{a} \\Big),\n$$\n$$\nC_{0} \\;=\\; \\mu^{2} \\;-\\; \\frac{\\beta\\,\\mu}{m}\\Big( k_{a}^{2}\\,\\pi \\;+\\; k_{b}^{2}\\,(1 - \\pi) \\Big).\n$$\n正的地方病解 $\\Theta^{*}$ 可通过二次公式求得。物理上相关的根是能得到 $\\Theta^{*} \\geq 0$ 的那个根：\n$$\n\\Theta^{*} \\;=\\; \\frac{-\\,C_{1} \\;+\\; \\sqrt{\\,C_{1}^{2} \\;-\\; 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}}.\n$$\n给定 $\\Theta^{*}$，每个类中的稳态感染比例为\n$$\ni_{a}^{*} \\;=\\; \\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}},\n\\qquad\ni_{b}^{*} \\;=\\; \\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}},\n$$\n且稳态流行率为\n$$\np^{*} \\;=\\; \\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}.\n$$\n\n现在我们通过在 $\\big(i_{a}^{*}, i_{b}^{*}\\big)$ 附近对二维动力学系统进行线性化来分析地方病不动点的局部稳定性。定义向量 $\\mathbf{i} = \\big(i_{a}, i_{b}\\big)^{\\top}$ 和矢量场 $\\mathbf{F}(\\mathbf{i})$，其分量为\n$$\nF_{a}(i_{a}, i_{b}) \\;=\\; -\\,\\mu\\,i_{a} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}\\big)\\,\\Theta(i_{a},i_{b}),\n\\qquad\nF_{b}(i_{a}, i_{b}) \\;=\\; -\\,\\mu\\,i_{b} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}\\big)\\,\\Theta(i_{a},i_{b}),\n$$\n其中 $\\Theta(i_{a},i_{b}) = \\big(k_{a}\\,\\pi\\,i_{a} + k_{b}\\,(1 - \\pi)\\,i_{b}\\big)/m$。雅可比矩阵 $J$ 的元素为\n$$\nJ_{aa} \\;=\\; \\frac{\\partial F_{a}}{\\partial i_{a}} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{a}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{a}},\n$$\n$$\nJ_{ab} \\;=\\; \\frac{\\partial F_{a}}{\\partial i_{b}} \\;=\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{b}},\n$$\n$$\nJ_{ba} \\;=\\; \\frac{\\partial F_{b}}{\\partial i_{a}} \\;=\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{a}},\n$$\n$$\nJ_{bb} \\;=\\; \\frac{\\partial F_{b}}{\\partial i_{b}} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{b}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{b}}.\n$$\n使用 $\\frac{\\partial \\Theta}{\\partial i_{a}} = \\frac{k_{a}\\,\\pi}{m}$、$\\frac{\\partial \\Theta}{\\partial i_{b}} = \\frac{k_{b}\\,(1 - \\pi)}{m}$ 和 $1 - i_{k}^{*} = \\frac{\\mu}{\\mu + \\beta\\,k\\,\\Theta^{*}}$，我们得到\n$$\nJ_{aa} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{a}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{a}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}}\\cdot \\frac{k_{a}\\,\\pi}{m},\n$$\n$$\nJ_{ab} \\;=\\; \\beta\\,k_{a}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}}\\cdot \\frac{k_{b}\\,(1 - \\pi)}{m},\n$$\n$$\nJ_{ba} \\;=\\; \\beta\\,k_{b}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\\cdot \\frac{k_{a}\\,\\pi}{m},\n$$\n$$\nJ_{bb} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{b}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{b}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\\cdot \\frac{k_{b}\\,(1 - \\pi)}{m}.\n$$\n$J$ 的特征值是方程 $\\lambda^{2} - \\operatorname{tr}(J)\\,\\lambda + \\det(J) = 0$ 的解。地方病不动点的局部渐近稳定性要求 $\\operatorname{tr}(J)  0$ 和 $\\det(J) > 0$。因为 $J_{ab} > 0$ 且 $J_{ba} > 0$，而对角线项包含 $-\\,\\mu - \\beta\\,k\\,\\Theta^{*}$ 和一个较小的正校正项，所以在稳态存在的参数区域内，对于地方病的 $\\Theta^{*} > 0$，$\\operatorname{tr}(J)$ 是负的，并且非对角线项的乘积结构与对角线项的符号性质共同导致 $\\det(J) > 0$。因此，当地方病解 $\\Theta^{*} > 0$ 存在时（即，当感染率与恢复率之比高于异质平均场阈值时），该地方病不动点是局部渐近稳定的。\n\n最后，我们通过将 $\\Theta^{*}$ 的表达式代入 $p^{*}$ 的公式中，组装出 $p^{*}$ 的显式闭式表达式，并用参数 $\\beta$、$\\mu$、$k_{a}$、$k_{b}$ 和 $\\pi$ 来表示它：\n$$\np^{*} \\;=\\; \\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}},\n$$\n其中\n$$\n\\Theta^{*} \\;=\\; \\frac{-\\,C_{1} \\;+\\; \\sqrt{\\,C_{1}^{2} \\;-\\; 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}},\n\\quad\nC_{2} \\;=\\; \\beta^{2}\\,k_{a}\\,k_{b},\n\\quad\nC_{1} \\;=\\; \\mu\\,\\beta\\,(k_{a} + k_{b}) \\;-\\; \\frac{\\beta^{2}}{k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)}\\Big( k_{a}^{2}\\,\\pi\\,k_{b} \\;+\\; k_{b}^{2}\\,(1 - \\pi)\\,k_{a} \\Big),\n$$\n$$\nC_{0} \\;=\\; \\mu^{2} \\;-\\; \\frac{\\beta\\,\\mu}{k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)}\\Big( k_{a}^{2}\\,\\pi \\;+\\; k_{b}^{2}\\,(1 - \\pi) \\Big).\n$$\n这给出了双类异质平均场SIS模型下稳态流行率的精确、闭式解析表达式。",
            "answer": "$$\\boxed{\\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}} \\text{ 其中 } \\Theta^{*} = \\frac{-\\,C_{1} + \\sqrt{\\,C_{1}^{2} - 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}}, \\; C_{2} = \\beta^{2} k_{a} k_{b}, \\; C_{1} = \\mu \\beta (k_{a}+k_{b}) - \\frac{\\beta^{2}}{k_{a}\\pi + k_{b}(1-\\pi)}\\big(k_{a}^{2}\\pi k_{b}+ k_{b}^{2}(1-\\pi)k_{a}\\big), \\; C_{0} = \\mu^{2} - \\frac{\\beta \\mu}{k_{a}\\pi + k_{b}(1-\\pi)}\\big(k_{a}^{2}\\pi + k_{b}^{2}(1-\\pi)\\big)}$$"
        },
        {
            "introduction": "许多基础的平均场模型都依赖于一个重要假设：网络是度不相关的。这个练习将挑战这一假设，引导您将度相关性——即节点倾向于与特定度数的节点连接的特性——纳入平均场框架。您将学习如何通过一个依赖于条件概率 $P(k'|k)$ 的矩阵的谱半径来确定更普适的流行病爆发阈值 。这项实践不仅展示了平均场理论的扩展性，也深刻揭示了网络微观结构如何显著影响宏观动力学行为。",
            "id": "4287250",
            "problem": "考虑一个在一个大型、稀疏、无向网络上的易感-感染-易感（SIS）传播过程。每个节点的度 $k$ 从度分布 $P(k)$ 中抽取，每次接触的感染率为 $\\beta$，恢复率为 $\\mu$。令 $i_{k}(t)$ 表示度为 $k$ 的节点在时间 $t$ 被感染的概率。该网络表现出度相关性，由条件概率 $P(k' \\mid k)$ 量化，该概率表示一个度为 $k$ 的节点的随机选择的邻居具有度 $k'$。度-度相关性遵循无向网络的细致平衡约束 $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$，对所有度 $k$ 和 $k'$ 均成立。\n\n从第一性原理和基于度的平均场近似出发，完成以下任务：\n\n1. 写出关于 $i_{k}(t)$ 的异质平均场速率方程，该方程通过 $P(k' \\mid k)$ 考虑了度异质性和度相关性。围绕无病平衡态 $i_{k} \\equiv 0$ 对此动力学系统进行线性化，并利用线性系统的稳定性分析，用一个由 $P(k' \\mid k)$ 和度值 $\\{k\\}$ 构建的矩阵的谱半径来表示疫情阈值条件。\n\n2. 使用此谱特征，陈述在何种关于 $P(k' \\mid k)$ 的精确条件下，为无相关网络推导的广泛使用的基于矩的阈值是无效的。在相同的平均场框架内，为相关混合情况下的阈值提供一个修正的表达式。\n\n3. 考虑一个具有两个度类别的度分布，度分别为 $k_{1} = 2$ 和 $k_{2} = 8$，其概率为 $P(k_{1}) = \\frac{4}{5}$ 和 $P(k_{2}) = \\frac{1}{5}$。条件概率指定为 $P(k_{1} \\mid k_{1}) = \\frac{7}{10}$ 和 $P(k_{2} \\mid k_{1}) = \\frac{3}{10}$。使用细致平衡约束来确定 $P(k_{1} \\mid k_{2})$ 和 $P(k_{2} \\mid k_{2})$，然后构建在SIS动力学线性化中使用的相应度相关矩阵。以精确的封闭形式，计算此网络的修正平均场疫情阈值，作为临界比率 $\\beta / \\mu$ 的单个解析表达式。将你的最终答案表示为精确的符号表达式。最终答案中不要包含任何单位。",
            "solution": "首先验证题目的有效性。给定条件如下：一个大型、稀疏、无向网络上的易感-感染-易感（SIS）模型；感染率 $\\beta$；恢复率 $\\mu$；度分布 $P(k)$；度-度相关的条件概率 $P(k' \\mid k)$；变量 $i_k(t)$ 为度为 $k$ 的节点被感染的概率；以及细致平衡约束 $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$。给出了一个两类网络的具体值：$k_1 = 2$，$k_2 = 8$，$P(k_1) = \\frac{4}{5}$，$P(k_2) = \\frac{1}{5}$，$P(k_1 \\mid k_1) = \\frac{7}{10}$ 以及 $P(k_2 \\mid k_1) = \\frac{3}{10}$。该问题在科学上植根于网络流行病学，内容自洽，且在数学上是适定的。所提供的数值与概率论和细致平衡约束一致。因此，该问题被认为是有效的，可以构建解答。\n\n**1. 异质平均场方程和疫情阈值**\n\n我们首先推导 $i_k(t)$ 的速率方程，即度为 $k$ 的节点中被感染者的比例。$i_k(t)$ 的变化由两个过程控制：恢复和感染。\n- 一个度为 $k$ 的受感染节点以速率 $\\mu$ 恢复并变为易感状态。这对变化率贡献了 $-\\mu i_k(t)$ 这一项。\n- 一个度为 $k$ 的易感节点（其比例为 $1-i_k(t)$）通过与邻居的接触而被感染。感染速率与感染率 $\\beta$、邻居数量 $k$ 以及随机选择的邻居被感染的概率成正比。这个概率，我们称之为 $\\theta_k(t)$，取决于中心节点的度 $k$。\n\n在基于度的平均场近似中，我们通过对邻居的度进行平均来表示 $\\theta_k(t)$。一个度为 $k$ 的节点的邻居具有度 $k'$ 的概率为 $P(k' \\mid k)$。这个度为 $k'$ 的邻居被感染的概率是 $i_{k'}(t)$。对所有可能的邻居度 $k'$ 求和，我们得到：\n$$ \\theta_k(t) = \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) $$\n一个度为 $k$ 的易感节点被感染的总速率是 $\\beta k \\theta_k(t)$。假设来自邻居的感染事件是独立的，那么 $i_k(t)$ 的增益项是 $\\beta k (1-i_k(t)) \\theta_k(t)$。\n\n结合增益和损失项，我们得到完整的非线性速率方程：\n$$ \\frac{di_k}{dt} = \\beta k (1-i_k(t)) \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) - \\mu i_k(t) $$\n为了找到疫情阈值，我们分析无病平衡态（DFE）的稳定性，此时对所有 $k$ 都有 $i_k(t) = 0$。令 $i_k(t) = \\epsilon_k(t)$，其中 $\\epsilon_k(t)$ 是一个小的扰动。将此代入速率方程，并通过舍去 $\\epsilon^2$ 及更高阶的项（即，令 $1-\\epsilon_k \\approx 1$）进行线性化：\n$$ \\frac{d\\epsilon_k}{dt} \\approx \\beta k \\sum_{k'} P(k' \\mid k) \\, \\epsilon_{k'}(t) - \\mu \\epsilon_k(t) $$\n这是一个线性常微分方程组。设网络中不同的度为 $\\{k_1, k_2, \\dots, k_N\\}$。我们可以将该系统写成向量形式 $\\frac{d\\vec{\\epsilon}}{dt} = J \\vec{\\epsilon}$，其中 $\\vec{\\epsilon}$ 是扰动向量 $(\\epsilon_{k_1}, \\epsilon_{k_2}, \\dots, \\epsilon_{k_N})^T$，$J$ 是雅可比矩阵。$J$ 的元素由下式给出：\n$$ J_{ij} = \\beta k_i P(k_j \\mid k_i) - \\mu \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克（Kronecker）δ函数。我们可以将 $J$ 表示为 $J = \\beta M - \\mu I$，其中 $I$ 是单位矩阵，$M$ 是一个元素为 $M_{ij} = k_i P(k_j \\mid k_i)$ 的矩阵。\n\n如果 $J$ 的任何一个特征值的实部为正，则DFE是不稳定的。$J$ 的特征值为 $\\lambda_J = \\beta \\lambda_M - \\mu$，其中 $\\lambda_M$ 是 $M$ 的特征值。不稳定的条件是 $\\max(\\text{Re}(\\lambda_J)) > 0$，这等价于 $\\beta \\max(\\text{Re}(\\lambda_M)) - \\mu > 0$。矩阵 $M$ 的元素非负，因此根据佩龙-弗罗贝尼乌斯（Perron-Frobenius）定理，其最大特征值是实数且为正。这个特征值就是谱半径 $\\rho(M)$。因此，$\\max(\\text{Re}(\\lambda_M)) = \\rho(M)$。\n\n疫情阈值是传播率 $\\lambda = \\beta / \\mu$ 的临界值，在该值处DFE失去稳定性。爆发的条件是 $\\frac{\\beta}{\\mu} \\rho(M) > 1$。因此，阈值条件用矩阵 $M$ 的谱半径表示为：\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\n其中 $M$ 是一个矩阵，其元素为 $M_{ij} = k_i P(k_j \\mid k_i)$，对应于不同的度类别 $i$ 和 $j$。\n\n**2. 无相关网络阈值无效的条件**\n\n对于无相关网络，广泛使用的基于矩的阈值为 $(\\frac{\\beta}{\\mu})_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$。这个结果是在 $P(k' \\mid k)$ 独立于 $k$ 的假设下推导出来的，具体来说是 $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$，其中 $\\langle k \\rangle = \\sum_k k P(k)$ 且 $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$。\n\n当网络表现出度相关性时，即假设 $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$ 并不对所有 $(k, k')$ 对都成立时，基于矩的阈值就是无效的。这种情况发生在具有同配混合（高度节点倾向于连接其他高度节点）或异配混合（高度节点倾向于连接低度节点）的网络中。\n\n在相关混合情况下，疫情阈值的修正表达式正是前一节中通过稳定性分析推导出的表达式：\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\n其中 $M_{ij} = k_i P(k_j \\mid k_i)$。这个表达式是通用的，对有相关和无相关的网络都有效，在没有相关性的特定情况下，它会简化为基于矩的公式。\n\n**3. 两类网络的计算**\n\n给定一个具有两个度类别的网络，$k_1 = 2$ 和 $k_2 = 8$，其概率为 $P(k_1) = \\frac{4}{5}$ 和 $P(k_2) = \\frac{1}{5}$。条件概率为 $P(k_1 \\mid k_1) = \\frac{7}{10}$ 和 $P(k_2 \\mid k_1) = \\frac{3}{10}$。由于 $\\sum_{k'} P(k' \\mid k) = 1$，我们可以验证 $P(k_1 \\mid k_1) + P(k_2 \\mid k_1) = \\frac{7}{10} + \\frac{3}{10} = 1$，这是一致的。\n\n我们首先使用细致平衡约束确定剩余的条件概率 $P(k_1 \\mid k_2)$ 和 $P(k_2 \\mid k_2)$：$k_1 P(k_1) P(k_2 \\mid k_1) = k_2 P(k_2) P(k_1 \\mid k_2)$。\n$$ (2) \\left(\\frac{4}{5}\\right) \\left(\\frac{3}{10}\\right) = (8) \\left(\\frac{1}{5}\\right) P(k_1 \\mid k_2) $$\n$$ \\frac{24}{50} = \\frac{8}{5} P(k_1 \\mid k_2) $$\n$$ P(k_1 \\mid k_2) = \\frac{24}{50} \\cdot \\frac{5}{8} = \\frac{3}{10} $$\n对于 $k=k_2$ 使用归一化条件，我们有 $P(k_1 \\mid k_2) + P(k_2 \\mid k_2) = 1$。\n$$ P(k_2 \\mid k_2) = 1 - P(k_1 \\mid k_2) = 1 - \\frac{3}{10} = \\frac{7}{10} $$\n现在我们构造 $2 \\times 2$ 矩阵 $M$，其元素为 $M_{ij} = k_i P(k_j \\mid k_i)$：\n$M_{11} = k_1 P(k_1 \\mid k_1) = 2 \\cdot \\frac{7}{10} = \\frac{14}{10} = \\frac{7}{5}$\n$M_{12} = k_1 P(k_2 \\mid k_1) = 2 \\cdot \\frac{3}{10} = \\frac{6}{10} = \\frac{3}{5}$\n$M_{21} = k_2 P(k_1 \\mid k_2) = 8 \\cdot \\frac{3}{10} = \\frac{24}{10} = \\frac{12}{5}$\n$M_{22} = k_2 P(k_2 \\mid k_2) = 8 \\cdot \\frac{7}{10} = \\frac{56}{10} = \\frac{28}{5}$\n\n矩阵 $M$ 为：\n$$ M = \\begin{pmatrix} \\frac{7}{5}  \\frac{3}{5} \\\\ \\frac{12}{5}  \\frac{28}{5} \\end{pmatrix} $$\n为了找到谱半径 $\\rho(M)$，我们通过求解特征方程 $\\det(M - \\lambda I) = 0$ 来计算特征值：\n$$ \\det \\begin{pmatrix} \\frac{7}{5} - \\lambda  \\frac{3}{5} \\\\ \\frac{12}{5}  \\frac{28}{5} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(\\frac{7}{5} - \\lambda\\right)\\left(\\frac{28}{5} - \\lambda\\right) - \\left(\\frac{3}{5}\\right)\\left(\\frac{12}{5}\\right) = 0 $$\n$$ \\lambda^2 - \\left(\\frac{7}{5} + \\frac{28}{5}\\right)\\lambda + \\frac{7 \\cdot 28}{25} - \\frac{3 \\cdot 12}{25} = 0 $$\n$$ \\lambda^2 - \\frac{35}{5}\\lambda + \\frac{196 - 36}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{160}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{32}{5} = 0 $$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$ \\lambda = \\frac{7 \\pm \\sqrt{(-7)^2 - 4(1)\\left(\\frac{32}{5}\\right)}}{2} = \\frac{7 \\pm \\sqrt{49 - \\frac{128}{5}}}{2} $$\n$$ \\lambda = \\frac{7 \\pm \\sqrt{\\frac{245 - 128}{5}}}{2} = \\frac{7 \\pm \\sqrt{\\frac{117}{5}}}{2} $$\n谱半径 $\\rho(M)$ 是最大的特征值：\n$$ \\rho(M) = \\frac{7 + \\sqrt{\\frac{117}{5}}}{2} = \\frac{7 + \\frac{\\sqrt{9 \\cdot 13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{65}}{5}}{2} = \\frac{35 + 3\\sqrt{65}}{10} $$\n疫情阈值是谱半径的倒数：\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{1}{\\rho(M)} = \\frac{10}{35 + 3\\sqrt{65}} $$\n为了使分母有理化，我们将分子和分母同乘以共轭项 $35 - 3\\sqrt{65}$：\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{(35 + 3\\sqrt{65})(35 - 3\\sqrt{65})} = \\frac{10(35 - 3\\sqrt{65})}{35^2 - (3\\sqrt{65})^2} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{1225 - 9 \\cdot 65} = \\frac{10(35 - 3\\sqrt{65})}{1225 - 585} = \\frac{10(35 - 3\\sqrt{65})}{640} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{35 - 3\\sqrt{65}}{64} $$\n这是临界比率 $\\beta / \\mu$ 的精确符号表达式。",
            "answer": "$$ \\boxed{\\frac{35 - 3\\sqrt{65}}{64}} $$"
        }
    ]
}