{
    "hands_on_practices": [
        {
            "introduction": "This foundational exercise guides you through a first-principles derivation of percolation thresholds on networks. Starting with the elegant message-passing framework, you will derive the linearized stability condition for the emergence of a giant connected component. This practice reveals the deep connection between this phase transition and the spectral radius of the non-backtracking matrix, culminating in the celebrated Molloy-Reed criterion for configuration model networks .",
            "id": "4296412",
            "problem": "Consider percolation processes on a large, sparse, undirected network generated by the configuration model with degree distribution $P(k)$, which is locally tree-like in the thermodynamic limit. Two percolation processes are defined: bond percolation (each edge is independently retained with probability $p$) and site percolation (each node is independently retained with probability $q$, with all incident edges removed if the node is removed). The emergence of a Giant Connected Component (GCC) is to be analyzed via message passing on the directed-edge representation of the network, using the cavity approach that neglects backtracking loops.\n\nStarting only from the definitions of bond and site percolation, the concept of Giant Connected Component (GCC), and the construction of directed-edge messages that represent the probability that following a directed edge does not lead to the GCC, derive the linearized stability condition for the trivial fixed point corresponding to the absence of a GCC on general graphs. Identify the operator that governs the linearized message dynamics and express the critical parameters for the onset of a GCC in terms of its spectral radius.\n\nThen, specialize your result to locally tree-like configuration-model networks and connect the relevant spectral radius to the mean excess degree, expressed in terms of the first two moments $\\langle k \\rangle$ and $\\langle k^{2} \\rangle$ of the degree distribution $P(k)$.\n\nFinally, compute the bond and site percolation thresholds for the specific degree distribution\n$$\nP(k) = \\frac{1}{2}\\,\\delta_{k,1} + \\frac{1}{2}\\,\\delta_{k,3},\n$$\nwhere $\\delta_{i,j}$ is the Kronecker delta, yielding explicit values for the critical bond occupation probability $p_{c}$ and the critical site occupation probability $q_{c}$.\n\nExpress your final results as exact fractions in simplest form. Provide the final answer as a row matrix containing $p_{c}$ and $q_{c}$, in that order. No units are required, and no rounding is needed.",
            "solution": "This problem requires the derivation of percolation thresholds for bond and site percolation on configuration-model networks. The solution will proceed in three stages: first, a general framework for the onset of a Giant Connected Component (GCC) is derived using a message-passing approach on a general graph; second, this framework is specialized to configuration-model networks by relating the critical condition to the moments of the degree distribution; and third, the specific thresholds for the given degree distribution are calculated.\n\nLet us begin by establishing the message-passing framework for a general large, sparse, undirected network. We analyze the stability of the trivial fixed point corresponding to the absence of a GCC. A GCC emerges when this fixed point becomes unstable. The method relies on the cavity approach, which assumes the network is locally tree-like, making it exact for configuration-model networks in the thermodynamic limit.\n\nLet there be a set of directed edges $(i, j)$ corresponding to each undirected edge $\\{i, j\\}$. A message passed from node $i$ to a neighbor $j$ quantifies the probability of some event occurring in the \"cavity graph\", i.e., the original graph with connections involving node $i$ (or just the edge $(i,j)$) removed.\n\n**Part 1: General Derivation via Message Passing**\n\n**Bond Percolation**\n\nIn bond percolation, each edge is present independently with probability $p$. Let $u_{i \\to j}$ be the probability that following the directed edge $i \\to j$ does **not** lead to the GCC. This event occurs if either the edge $\\{i,j\\}$ is absent (with probability $1-p$), or the edge is present (with probability $p$) but node $j$ fails to connect to the GCC through any of its other neighbors $k \\in \\mathcal{N}(j) \\setminus \\{i\\}$. Within the cavity/tree-like approximation, the paths starting from $j$ towards its other neighbors are independent. The probability that the path from $j$ towards a neighbor $k$ fails to reach the GCC is, by definition, $u_{j \\to k}$.\n\nThus, the self-consistency equation for the messages is:\n$$\nu_{i \\to j} = (1 - p) + p \\prod_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} u_{j \\to k}\n$$\nThe absence of a GCC corresponds to the trivial fixed point where $u_{i \\to j} = 1$ for all directed edges $(i,j)$. Let us verify this: $1 = (1-p) + p \\prod 1 = 1-p+p = 1$. To analyze the stability of this fixed point, we linearize the equation around it. Let $u_{i \\to j} = 1 - \\epsilon_{i \\to j}$, where $\\epsilon_{i \\to j}$ is a small positive perturbation. Substituting this into the equation yields:\n$$\n1 - \\epsilon_{i \\to j} = (1 - p) + p \\prod_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} (1 - \\epsilon_{j \\to k})\n$$\nFor small $\\epsilon$, we can expand the product to first order: $\\prod (1 - \\epsilon_k) \\approx 1 - \\sum \\epsilon_k$.\n$$\n1 - \\epsilon_{i \\to j} \\approx (1 - p) + p \\left(1 - \\sum_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} \\epsilon_{j \\to k}\\right)\n$$\n$$\n1 - \\epsilon_{i \\to j} \\approx 1 - p + p - p \\sum_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} \\epsilon_{j \\to k}\n$$\nThis simplifies to the linearized dynamics equation for the perturbations:\n$$\n\\epsilon_{i \\to j} = p \\sum_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} \\epsilon_{j \\to k}\n$$\n\n**Site Percolation**\n\nIn site percolation, each node is present independently with probability $q$. If a node is removed, all its incident edges are also removed. Let $v_{i \\to j}$ be the probability that node $j$ is **not** part of the GCC, viewed from its neighbor $i$ (i.e., in the cavity graph where $i$ is removed). This event occurs if either node $j$ is absent (with probability $1-q$), or node $j$ is present (with probability $q$) but it does not connect to the GCC through any of its other neighbors $k \\in \\mathcal{N}(j) \\setminus \\{i\\}$.\n\nThe self-consistency equation is therefore:\n$$\nv_{i \\to j} = (1 - q) + q \\prod_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} v_{j \\to k}\n$$\nThis equation is mathematically isomorphic to the one for bond percolation. The trivial fixed point is $v_{i \\to j} = 1$. Linearizing around this fixed point by setting $v_{i \\to j} = 1 - \\delta_{i \\to j}$ gives:\n$$\n\\delta_{i \\to j} = q \\sum_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} \\delta_{j \\to k}\n$$\n\n**Linearized Dynamics and Critical Condition**\n\nBoth linearized equations can be written in terms of a linear operator, the non-backtracking matrix $\\mathbf{B}$ of the graph. The operator $\\mathbf{B}$ acts on functions defined on the set of directed edges. Its action is given by:\n$$\n(\\mathbf{B} f)(i \\to j) = \\sum_{k \\in \\mathcal{N}(j) \\setminus \\{i\\}} f(j \\to k)\n$$\nThe linearized dynamics for the perturbation vectors $\\vec{\\epsilon}$ and $\\vec{\\delta}$ can be written as $\\vec{\\epsilon}^{(t+1)} = p \\mathbf{B} \\vec{\\epsilon}^{(t)}$ and $\\vec{\\delta}^{(t+1)} = q \\mathbf{B} \\vec{\\delta}^{(t)}$, respectively. The trivial fixed point (no GCC) becomes unstable when the largest eigenvalue (spectral radius $\\rho$) of the corresponding linear operator becomes greater than $1$.\nFor bond percolation, the operator is $\\mathbf{T}_{\\text{bond}} = p\\mathbf{B}$. The critical condition is $\\rho(\\mathbf{T}_{\\text{bond}}) = p_c \\rho(\\mathbf{B}) = 1$.\nFor site percolation, the operator is $\\mathbf{T}_{\\text{site}} = q\\mathbf{B}$. The critical condition is $\\rho(\\mathbf{T}_{\\text{site}}) = q_c \\rho(\\mathbf{B}) = 1$.\nThis yields the critical thresholds in terms of the spectral radius of the non-backtracking matrix:\n$$\np_c = \\frac{1}{\\rho(\\mathbf{B})} \\quad \\text{and} \\quad q_c = \\frac{1}{\\rho(\\mathbf{B})}\n$$\n\n**Part 2: Specialization to Configuration-Model Networks**\n\nFor large random graphs generated by the configuration model with degree distribution $P(k)$, the local tree-like assumption is exact. In this limit, the spectral radius of the non-backtracking matrix, $\\rho(\\mathbf{B})$, is equal to the mean excess degree of the network.\n\nThe excess degree of a node is its degree minus one; it is the number of edges leaving a node other than the one we arrived upon. To find the mean excess degree, we consider traversing a random edge. The probability that this edge leads to a node of degree $k$ is not $P(k)$, but is proportional to $kP(k)$. The normalized distribution for the degree of a node at the end of a random edge is $\\frac{kP(k)}{\\langle k \\rangle}$, where $\\langle k \\rangle = \\sum_k k P(k)$ is the mean degree.\n\nA node of degree $k$ has $k-1$ outgoing edges (excess degree). The mean excess degree is the average of $k-1$ over this distribution:\n$$\n\\rho(\\mathbf{B}) = \\sum_{k} (k-1) \\frac{k P(k)}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k} (k^2 - k) P(k)\n$$\nUsing the definition of moments, $\\langle f(k) \\rangle = \\sum_k f(k) P(k)$, we can write this as:\n$$\n\\rho(\\mathbf{B}) = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}\n$$\nwhere $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$ is the second moment of the degree distribution.\n\nSubstituting this expression for $\\rho(\\mathbf{B})$ into our critical conditions gives the percolation thresholds for the configuration model:\n$$\np_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle}\n$$\n$$\nq_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle}\n$$\nThis is the renowned Molloy-Reed criterion for the emergence of a giant component.\n\n**Part 3: Calculation for the Specific Degree Distribution**\n\nWe are given the degree distribution $P(k) = \\frac{1}{2}\\,\\delta_{k,1} + \\frac{1}{2}\\,\\delta_{k,3}$. This describes a network where half of the nodes have degree $1$ and the other half have degree $3$.\n\nFirst, we compute the first moment (mean degree) $\\langle k \\rangle$:\n$$\n\\langle k \\rangle = \\sum_{k} k P(k) = (1) \\cdot P(1) + (3) \\cdot P(3) = (1)\\left(\\frac{1}{2}\\right) + (3)\\left(\\frac{1}{2}\\right) = \\frac{1}{2} + \\frac{3}{2} = \\frac{4}{2} = 2\n$$\nNext, we compute the second moment $\\langle k^2 \\rangle$:\n$$\n\\langle k^2 \\rangle = \\sum_{k} k^2 P(k) = (1^2) \\cdot P(1) + (3^2) \\cdot P(3) = (1)\\left(\\frac{1}{2}\\right) + (9)\\left(\\frac{1}{2}\\right) = \\frac{1}{2} + \\frac{9}{2} = \\frac{10}{2} = 5\n$$\nNow we can compute the quantity $\\langle k^2 \\rangle - \\langle k \\rangle$:\n$$\n\\langle k^2 \\rangle - \\langle k \\rangle = 5 - 2 = 3\n$$\nFinally, we substitute these values into the formulas for the critical thresholds $p_c$ and $q_c$:\n$$\np_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle} = \\frac{2}{3}\n$$\n$$\nq_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle} = \\frac{2}{3}\n$$\nThe bond and site percolation thresholds are identical for this network ensemble, both equal to $\\frac{2}{3}$. The final answer is to be presented as a row matrix containing $p_c$ and $q_c$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{2}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building upon the theoretical tools from the previous exercise, this problem challenges you to apply the probability generating function (PGF) formalism to a more complex network. You will analyze a network with a mixed degree distribution, a scenario often encountered in real-world systems. This practice is essential for mastering the skill of translating a network's microscopic structure, encoded in its $P(k)$, into its macroscopic percolation properties .",
            "id": "4308457",
            "problem": "Consider a large configuration model network on $n$ vertices constructed by the standard stub-matching process from an independently generated degree sequence $\\{k_{i}\\}_{i=1}^{n}$. The degrees are generated by the following mixture mechanism: for each vertex, with probability $(1-\\alpha)$, assign degree $1$; with probability $\\alpha$, draw a degree $\\kappa$ from a Poisson distribution of mean $\\lambda$, and assign degree $\\kappa$. Assume $0\\alpha1$ and $\\lambda0$. Let $P(k)$ denote the resulting degree distribution on $\\mathbb{N}_{0}$ and assume the large-$n$ limit with no degree-degree correlations beyond those implied by the configuration model.\n\nDefine bond percolation on this network by independently retaining each edge with probability $T\\in[0,1]$, and removing it otherwise. Define site percolation by independently retaining each vertex with probability $p\\in[0,1]$, and removing it otherwise (together with incident edges); edges between removed vertices do not exist.\n\nUsing only core definitions of the configuration model, the excess degree distribution, and the probability generating function (PGF) approach combined with the branching-process criterion for the emergence of a giant connected component of occupied vertices, derive the critical values $T_{c}$ and $p_{c}$ in closed form for this network, expressed solely in terms of $\\alpha$ and $\\lambda$. Your final answer should be the two critical values in a single row matrix form $\\big(T_{c}\\;\\;p_{c}\\big)$ as an analytic expression. Do not provide numerical approximations.",
            "solution": "The problem is valid as it is scientifically grounded in the established theory of network science, is well-posed with a clear path to a unique solution, and is stated in objective, formal language. We proceed with the solution.\n\nThe emergence of a giant connected component (GCC) in a network can be analyzed as a branching process. For a configuration model network with degree distribution $P(k)$, the key condition for the existence of a GCC is the Molloy-Reed criterion. This criterion can be elegantly expressed using probability generating functions (PGFs).\n\nLet $G_0(x)$ be the PGF for the degree distribution $P(k)$:\n$$G_0(x) = \\sum_{k=0}^{\\infty} P(k) x^k$$\nThe mean degree is $\\langle k \\rangle = \\sum_k k P(k) = G_0'(1)$.\n\nA crucial quantity is the excess degree distribution, which is the distribution of the number of other edges attached to a vertex reached by following a random edge. The PGF for the excess degree distribution is denoted by $G_1(x)$:\n$$G_1(x) = \\sum_{k=1}^{\\infty} \\frac{k P(k)}{\\langle k \\rangle} x^{k-1} = \\frac{G_0'(x)}{G_0'(1)}$$\nThe branching process considers exploring the network from a random edge. The expected number of new edges we can follow from a vertex reached via a random edge is the mean excess degree, given by $G_1'(1)$. A GCC exists if this value is greater than $1$.\n$$G_1'(1)  1$$\nWe can express $G_1'(1)$ in terms of moments of the original degree distribution. Since $G_1(x) = G_0'(x)/\\langle k \\rangle$, its derivative is $G_1'(x) = G_0''(x)/\\langle k \\rangle$. Evaluating at $x=1$:\n$$G_1'(1) = \\frac{G_0''(1)}{\\langle k \\rangle} = \\frac{\\sum_k k(k-1)P(k)}{\\sum_k k P(k)} = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\nThe condition for a GCC is thus $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}  1$. Let's call this branching ratio $\\kappa = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$.\n\nFirst, we analyze bond percolation. Each edge is retained independently with probability $T$. This effectively thins the edges of the network. For a vertex that originally had degree $k$, the number of remaining edges, $k'$, follows a binomial distribution $B(k, T)$. The PGF of the new degree distribution, $G_{0,T}(x)$, is found by compounding the original PGF with the PGF for the binomial process, $(1-T+Tx)$:\n$$G_{0,T}(x) = \\sum_{k=0}^{\\infty} P(k) (1-T+Tx)^k = G_0(1-T+Tx)$$\nThe corresponding excess degree PGF for the percolated network is:\n$$G_{1,T}(x) = G_1(1-T+Tx)$$\nThe criticality condition is that the mean of the new excess degree distribution equals $1$. The mean is $G_{1,T}'(1)$.\n$$G_{1,T}'(x) = \\frac{d}{dx} G_1(1-T+Tx) = G_1'(1-T+Tx) \\cdot T$$\nEvaluating at $x=1$ gives the new branching ratio:\n$$G_{1,T}'(1) = G_1'(1) \\cdot T = T \\kappa$$\nThe critical threshold $T_c$ is found when this quantity equals $1$:\n$$T_c \\cdot \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} = 1 \\implies T_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle}$$\n\nNext, we analyze site percolation. Each vertex is retained independently with probability $p$. We are interested in the giant component of occupied vertices. A clean way to model this is to consider the subgraph formed by the occupied vertices and their connecting edges. A vertex of original degree $k$ is occupied with probability $p$. Each of its $k$ neighbors is independently occupied with probability $p$. Thus, the degree $k'$ of this vertex in the new (occupied) subgraph follows a binomial distribution $B(k,p)$. The PGF for the degree distribution of an occupied vertex is:\n$$G_{0,p}(x) = \\sum_{k=0}^{\\infty} P(k) (1-p+px)^k = G_0(1-p+px)$$\nThe criterion for a GCC in this new network of occupied sites is that its own branching ratio, $\\kappa'$, is greater than $1$.\n$$\\kappa' = \\frac{\\langle k'^2 \\rangle - \\langle k' \\rangle}{\\langle k' \\rangle}  1$$\nWe can calculate the moments of the new distribution from its PGF, $G_{0,p}(x)$.\nThe new mean degree is $\\langle k' \\rangle = G_{0,p}'(1)$.\n$$G_{0,p}'(x) = \\frac{d}{dx} G_0(1-p+px) = G_0'(1-p+px) \\cdot p$$\n$$\\langle k' \\rangle = G_{0,p}'(1) = G_0'(1) \\cdot p = p \\langle k \\rangle$$\nThe term $\\langle k'^2 \\rangle - \\langle k' \\rangle$ is given by $G_{0,p}''(1)$.\n$$G_{0,p}''(x) = \\frac{d}{dx} \\left( G_0'(1-p+px) \\cdot p \\right) = G_0''(1-p+px) \\cdot p^2$$\n$$G_{0,p}''(1) = G_0''(1) \\cdot p^2 = p^2 (\\langle k^2 \\rangle - \\langle k \\rangle)$$\nThe criticality condition is $\\frac{p_c^2 (\\langle k^2 \\rangle - \\langle k \\rangle)}{p_c \\langle k \\rangle} = 1$, which simplifies to:\n$$p_c \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} = 1 \\implies p_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle}$$\nThus, for a configuration model network, the critical thresholds for bond and site percolation have the same form.\n\nThe final step is to compute $\\langle k \\rangle$ and $\\langle k^2 \\rangle$ for the given degree distribution. The distribution $P(k)$ is a mixture: $P(k) = (1-\\alpha)\\delta_{k,1} + \\alpha P_{\\text{Poisson}}(k|\\lambda)$, where $\\delta_{k,1}$ is the Kronecker delta and $P_{\\text{Poisson}}(k|\\lambda) = \\frac{e^{-\\lambda}\\lambda^k}{k!}$.\n\nThe PGF for this mixture distribution, $G_0(x)$, is the weighted sum of the PGFs of its components. The PGF for a fixed degree of $1$ is $x^1=x$. The PGF for a Poisson distribution of mean $\\lambda$ is $\\exp(\\lambda(x-1))$.\n$$G_0(x) = (1-\\alpha)x + \\alpha \\exp(\\lambda(x-1))$$\nWe can find the required moments by differentiating the PGF.\nThe mean degree $\\langle k \\rangle$ is $G_0'(1)$:\n$$G_0'(x) = (1-\\alpha) + \\alpha \\lambda \\exp(\\lambda(x-1))$$\n$$\\langle k \\rangle = G_0'(1) = (1-\\alpha) + \\alpha \\lambda \\exp(0) = 1-\\alpha + \\alpha\\lambda$$\nThe quantity $\\langle k^2 \\rangle - \\langle k \\rangle$ is $G_0''(1)$:\n$$G_0''(x) = \\alpha \\lambda^2 \\exp(\\lambda(x-1))$$\n$$\\langle k^2 \\rangle - \\langle k \\rangle = G_0''(1) = \\alpha \\lambda^2 \\exp(0) = \\alpha\\lambda^2$$\nNow we substitute these moments into the expressions for $T_c$ and $p_c$:\n$$T_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle} = \\frac{1-\\alpha + \\alpha\\lambda}{\\alpha\\lambda^2}$$\n$$p_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle - \\langle k \\rangle} = \\frac{1-\\alpha + \\alpha\\lambda}{\\alpha\\lambda^2}$$\nThese are the critical values expressed solely in terms of $\\alpha$ and $\\lambda$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1-\\alpha + \\alpha\\lambda}{\\alpha\\lambda^{2}}  \\frac{1-\\alpha + \\alpha\\lambda}{\\alpha\\lambda^{2}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice bridges the gap between abstract models and real-world network analysis. It asks you to critically evaluate different algorithms for estimating percolation thresholds on a specific, given network that is locally tree-like. You will compare methods based solely on the degree distribution with more sophisticated approaches that capture the network's precise topology, highlighting why the non-backtracking operator is central to understanding resilience in general networks .",
            "id": "4296418",
            "problem": "You are given a large, sparse, undirected network with $N$ nodes and $M$ edges that is empirically observed to be locally tree-like (low clustering and negligible short cycles). You are tasked with estimating the critical occupation probability at which a giant connected component first emerges for both bond percolation (each edge occupied independently with probability $T$) and site percolation (each node retained independently with probability $p$). You must design a scalable algorithm that does not rely on exhaustive Monte Carlo sampling, uses only local structure (neighbor lists), and yields an estimate that is correct for general locally tree-like networks. The algorithm should be explicit about what linear operator governs the instability of the no-giant phase and how bond versus site percolation enter into the criterion. Which option best satisfies these requirements?\n\nA. Build the adjacency matrix $A$ of the network and use its spectral radius $\\rho(A)$ to estimate the thresholds via $T_{c} = 1 / \\rho(A)$ for bond percolation and $p_{c} = 1 / \\rho(A)$ for site percolation. Implement a Power Iteration using sparse matrix-vector multiplies costing $O(M)$ per iteration to compute $\\rho(A)$, asserting that backtracking paths do not change the leading-order instability.\n\nB. Construct the Hashimoto non-backtracking matrix $B$ on directed edges and derive message-passing cavity equations whose linearization around the no-giant fixed point is governed by the operator $T B$ for bond percolation and $p B$ for site percolation when retention is uniform across nodes. Estimate the thresholds via $T_{c} = 1 / \\rho(B)$ and $p_{c} = 1 / \\rho(B)$, computing $\\rho(B)$ by Power Iteration on the directed-edge space in $O(M)$ per iteration. For heterogeneous site percolation with node-dependent retention probabilities $\\{p_{i}\\}$, incorporate diagonal node weights into the linearized messages to obtain an operator of the form $W B$ with $W$ depending on $\\{p_{i}\\}$.\n\nC. Perform $R$ independent Monte Carlo simulations using a union-find algorithm to enumerate connected components after sampling either edges with probability $T$ (bond) or nodes with probability $p$ (site). Sweep $T$ or $p$ over a grid and locate the threshold where the empirical susceptibility (finite-cluster size variance) peaks. The algorithm reports $T_{c} \\approx 1 / \\langle k \\rangle$ and $p_{c} \\approx 1 / \\langle k \\rangle$, where $\\langle k \\rangle$ is the average degree, with per-sweep complexity $O(M \\alpha(N))$ and total cost $O(R M \\alpha(N))$, where $\\alpha(N)$ is the inverse Ackermann function.\n\nD. Use the generating function approach that depends only on the empirical degree distribution $P(k)$: estimate $T_{c} = \\langle k \\rangle / (\\langle k^{2} \\rangle - \\langle k \\rangle)$ for bond percolation and $p_{c} = \\langle k \\rangle / \\langle k^{2} \\rangle$ for site percolation, computing moments $\\langle k \\rangle$ and $\\langle k^{2} \\rangle$ in $O(N)$ time. Assert that degree-degree correlations and mesoscopic structure do not affect the thresholds on locally tree-like graphs.\n\nE. Form the random-walk normalized Laplacian $L = I - D^{-1} A$, where $D$ is the diagonal degree matrix and $I$ is the identity. Estimate thresholds by $T_{c} = 1 / \\rho(L)$ for bond percolation and $p_{c} = 1 / \\rho(L)$ for site percolation, using the leading eigenvalue of $L$ computed in $O(M)$ per iteration. Argue that the stability of the no-giant phase is controlled by return probabilities in the random walk dynamics.",
            "solution": "The problem statement is a valid exercise in the application of network science principles to the study of percolation phenomena.\n\n### Step 1: Extract Givens\n- **Network**: A large, sparse, undirected network with $N$ nodes and $M$ edges.\n- **Network Property**: The network is locally tree-like, implying a low clustering coefficient and a negligible number of short cycles.\n- **Percolation Processes**:\n    1.  **Bond percolation**: Each edge is present (occupied) independently with probability $T$.\n    2.  **Site percolation**: Each node is present (retained) independently with probability $p$.\n- **Objective**: To estimate the critical occupation probabilities ($T_c$ for bond, $p_c$ for site) at which a giant connected component (GCC) first emerges.\n- **Algorithmic Constraints**:\n    1.  The algorithm must be scalable.\n    2.  It must not rely on exhaustive Monte Carlo sampling.\n    3.  It must use only local structure (i.e., neighbor lists).\n    4.  The estimate must be correct for general locally tree-like networks.\n    5.  It must explicitly identify the linear operator governing the instability of the phase without a GCC.\n    6.  It must be explicit about the role of $T$ and $p$ in the criterion.\n- **Question**: Identify the option that best satisfies all these requirements.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It addresses a central topic in complex systems and network science: the percolation phase transition. The concepts involved (bond/site percolation, giant component, locally tree-like networks, adjacency and non-backtracking matrices, scalability) are all well-defined within the field. The constraints on the desired algorithm are specific and verifiable. The problem requires a sophisticated understanding of the relationship between network structure, spectral properties of associated operators, and critical phenomena, which is a non-trivial but standard subject. There are no scientific or factual unsoundness, no ambiguity, and no missing information that would prevent a rigorous evaluation of the proposed options. The problem is valid.\n\n### Principle-Based Derivation\nThe emergence of a giant connected component (GCC) corresponds to a phase transition. The state without a GCC (where all connected components are finite) becomes unstable at the critical threshold. We can analyze this instability by considering the propagation of \"being in the GCC\" from a single node or edge. On a locally tree-like network, this propagation can be modeled as a branching process. The key is to analyze the expected number of newly reached nodes at each step of the propagation. A GCC appears when this number is greater than one.\n\nLet's model this propagation using a message-passing framework on the directed edges of the network. For each undirected edge $(i, j)$, we create two directed edges, $i \\to j$ and $j \\to i$. A message passed from $i$ to $j$ can be interpreted as the probability that node $i$ is connected to a cluster of infinite size through one of its neighbors other than $j$. The GCC emerges when a non-trivial solution for these probabilities appears. The stability of the trivial solution (all probabilities are zero) is governed by a linearized system.\n\nThe critical insight for tree-like structures is that for a cluster to grow, the propagation paths must not immediately reverse. A path $k \\to i \\to j$ contributes to growth, but a path $j \\to i \\to j$ does not. This motivates the use of the **non-backtracking matrix**, $B$. The matrix $B$ is a $2M \\times 2M$ matrix indexed by the directed edges. An entry $B_{(i \\to j), (k \\to i)}$ is $1$ if $k \\ne j$ and $0$ otherwise. A matrix-vector product $v' = Bv$ corresponds to a message-passing update: the message on edge $i \\to j$ is the sum of incoming messages to node $i$ from all neighbors except $j$: $v'_{i \\to j} = \\sum_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} v_{k \\to i}$.\n\n**Bond Percolation**: For a message to propagate from $k \\to i$ and then to $i \\to j$, the edge $(i,j)$ must be occupied. This occurs with probability $T$. The operator governing the linearized message-passing dynamics is therefore $T B$. The trivial \"no-GCC\" state becomes unstable when the spectral radius of this operator equals $1$.\n$$\n\\rho(T_c B) = 1 \\implies T_c \\rho(B) = 1 \\implies T_c = \\frac{1}{\\rho(B)}\n$$\nwhere $\\rho(B)$ is the spectral radius (largest eigenvalue) of the non-backtracking matrix $B$.\n\n**Site Percolation**: For a message to propagate from $k \\to i$ to $i \\to j$, the intermediate node $i$ must be occupied. This occurs with probability $p$. For a uniform retention probability $p$, the logic is identical to a \"node transmissibility\" replacing the \"edge transmissibility\". The operator becomes $p B$, and the critical threshold is:\n$$\n\\rho(p_c B) = 1 \\implies p_c \\rho(B) = 1 \\implies p_c = \\frac{1}{\\rho(B)}\n$$\nIf site retention probabilities are heterogeneous ($p_i$ for each node $i$), the message update from $k \\to i \\to j$ is weighted by $p_i$. This can be expressed by a diagonal matrix $W$ whose entries corresponding to directed edges leaving node $i$ are $p_i$. The operator becomes $W B$, and the critical condition is $\\rho(W B) = 1$.\n\n**Algorithmic Implementation**: The spectral radius $\\rho(B)$ can be efficiently computed using the Power Iteration method. Even though $B$ is a $2M \\times 2M$ matrix, it is very sparse. A matrix-vector product $Bv$ can be computed in $O(\\sum_i k_i) = O(M)$ time using only the network's adjacency list (local structure). This makes the approach scalable.\n\nThis derivation demonstrates that a method based on the non-backtracking matrix $B$ satisfies all the problem's constraints.\n\n### Option-by-Option Analysis\n\n**A. Build the adjacency matrix $A$ of the network and use its spectral radius $\\rho(A)$ to estimate the thresholds via $T_{c} = 1 / \\rho(A)$ for bond percolation and $p_{c} = 1 / \\rho(A)$ for site percolation.**\nThis is incorrect. The adjacency matrix $A$ counts all walks, including those that immediately backtrack (e.g., $i \\to j \\to i$). Such paths do not contribute to the expansion of a cluster into new territory. The condition $T_c = 1/\\rho(A)$ gives the threshold for an SIS epidemic model, not percolation. On a $k$-regular graph, $\\rho(A)=k$, so this yields $T_c = 1/k$. The correct bond percolation threshold on an infinite $(k-1)$-ary tree (the universal cover of a $k$-regular graph) is $T_c = 1/(k-1)$. This demonstrates the fundamental error of using $A$ instead of an operator that accounts for non-backtracking paths.\n**Verdict: Incorrect.**\n\n**B. Construct the Hashimoto non-backtracking matrix $B$ on directed edges and derive message-passing cavity equations whose linearization around the no-giant fixed point is governed by the operator $T B$ for bond percolation and $p B$ for site percolation when retention is uniform across nodes. Estimate the thresholds via $T_{c} = 1 / \\rho(B)$ and $p_{c} = 1 / \\rho(B)$, computing $\\rho(B)$ by Power Iteration on the directed-edge space in $O(M)$ per iteration. For heterogeneous site percolation with node-dependent retention probabilities $\\{p_{i}\\}$, incorporate diagonal node weights into the linearized messages to obtain an operator of the form $W B$ with $W$ depending on $\\{p_{i}\\}$.**\nThis option aligns perfectly with the principled derivation. It correctly identifies the non-backtracking matrix $B$ as the key linear operator. It correctly formulates the critical thresholds for both bond ($T_c=1/\\rho(B)$) and uniform site percolation ($p_c=1/\\rho(B)$). It proposes a scalable ($O(M)$ per iteration) and local-structure-based algorithm (Power Iteration on $B$) to compute the threshold. Finally, it correctly generalizes to the case of heterogeneous site percolation, showing a deep understanding of the underlying physics. This method is known to be exact for trees and provides a highly accurate estimate for general locally tree-like networks, as it captures the full topology beyond just the degree distribution.\n**Verdict: Correct.**\n\n**C. Perform $R$ independent Monte Carlo simulations using a union-find algorithm...**\nThis option is immediately disqualified as it violates the explicit constraint that the algorithm \"does not rely on exhaustive Monte Carlo sampling.\" Furthermore, the proposed estimates $T_c \\approx 1/\\langle k \\rangle$ and $p_c \\approx 1/\\langle k \\rangle$ are crude approximations valid only for uncorrelated networks with Poisson degree distributions (i.e., Erdős-Rényi graphs) and are incorrect for general degree distributions. The correct mean-field result for uncorrelated networks involves the second moment of the degree distribution, $\\langle k^2 \\rangle$.\n**Verdict: Incorrect.**\n\n**D. Use the generating function approach that depends only on the empirical degree distribution $P(k)$: estimate $T_{c} = \\langle k \\rangle / (\\langle k^{2} \\rangle - \\langle k \\rangle)$ for bond percolation and $p_{c} = \\langle k \\rangle / \\langle k^{2} \\rangle$ for site percolation...**\nThis approach has two major flaws. First, the provided formula for site percolation, $p_{c} = \\langle k \\rangle / \\langle k^{2} \\rangle$, is incorrect. The correct formula, derived from the same generating function formalism, is $p_c = \\langle k \\rangle / (\\langle k^2 \\rangle - \\langle k \\rangle)$, which is identical to the bond percolation case. Second, and more importantly, this method relies solely on the degree distribution $P(k)$ and implicitly assumes the network is a random graph with no degree correlations (an uncorrelated configuration model). This violates the requirement that the estimate be \"correct for general locally tree-like networks,\" as it fails to account for the specific topological structure, including degree correlations, that a real-world network possesses. The non-backtracking matrix approach of option B correctly incorporates this specific structure.\n**Verdict: Incorrect.**\n\n**E. Form the random-walk normalized Laplacian $L = I - D^{-1} A$,... Estimate thresholds by $T_{c} = 1 / \\rho(L)$...**\nThis is incorrect. The spectral radius of the normalized Laplacian, $\\rho(L)$, is not related to the percolation threshold in this manner. For any connected, non-bipartite graph, $\\rho(L) = 2$. This would imply a universal threshold of $T_c = 1/2$, regardless of the network's degree distribution or other structural properties, which is patently false. The eigenvalues of the Laplacian are related to diffusion time scales and graph partitioning, but the percolation transition is a distinct phenomenon governed by a different operator.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}