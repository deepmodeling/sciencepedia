{
    "hands_on_practices": [
        {
            "introduction": "网络科学的一个主要挑战是从经验数据中学习模型参数。本练习将提供从观测路径集合中估计二阶网络转移概率的实践。你将使用贝叶斯方法来平滑这些估计，这是一种处理高阶模型中常见的数据稀疏性问题的关键技术 。",
            "id": "4281315",
            "problem": "考虑一个高阶网络模型，其中在有限节点集 $V=\\{A,B,C,D\\}$ 上的路径由一个二阶马尔可夫过程生成：下一个节点 $v\\in V$ 取决于紧邻其前的前序有序对 $(u,w)\\in V\\times V$。给定以下路径数据集（每条路径是一个节点序列）：\n$\\langle A,B,C,D,B,C\\rangle$、$\\langle B,C,B,A,B,D\\rangle$ 和 $\\langle C,B,C,D,C,B\\rangle$。通过长度为 $3$ 的滑动窗口来解析每条路径，以形成三元组 $(u,w,v)$，并对于此数据集中每个不同的上下文 $(u,w)$，计算每个 $v\\in V$ 跟随其后出现的次数。\n\n假设对于每个上下文 $(u,w)$，在 $|V|=4$ 个可能的下一节点结果上存在一个对称狄利克雷先验，其集中参数为 $\\alpha=\\frac{1}{2}$。仅利用以下基本事实：(i) 多项式似然函数控制分类结果的计数，(ii) 狄利克雷分布是多项式分布的共轭先验，以及 (iii) 多项式-狄利克雷模型的后验预测分布产生一个归一化的概率分布，通过对后验进行积分，推导出每个上下文平滑的、依赖于上下文的二阶转移概率 $P(v\\mid u,w)$。为数据集中观察到的每个不同上下文 $(u,w)$ 显式计算这些概率，并从第一性原理出发，验证对于每个这样的 $(u,w)$，分布 $\\{P(v\\mid u,w):v\\in V\\}$ 的总和为 $1$。\n\n最后，计算特定上下文 $(B,C)$ 的平滑后继节点分布的香农熵（使用自然对数），即\n$$H\\big(P(\\cdot\\mid B,C)\\big)=-\\sum_{v\\in V}P(v\\mid B,C)\\,\\ln\\big(P(v\\mid B,C)\\big),$$\n并将此熵作为你的最终答案。无需四舍五入；请提供以自然对数 $\\ln$ 表示的精确解析表达式。",
            "solution": "用户提供了一个需要将贝叶斯推断应用于高阶网络模型的问题。在尝试解决问题之前，需要对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **节点集**: $V=\\{A,B,C,D\\}$，大小为 $|V|=4$。\n- **模型**: 二阶马尔可夫过程，其中下一个节点 $v$ 取决于前序有序对 $(u,w)$。\n- **路径数据集**:\n  - 路径 1: $\\langle A,B,C,D,B,C\\rangle$\n  - 路径 2: $\\langle B,C,B,A,B,D\\rangle$\n  - 路径 3: $\\langle C,B,C,D,C,B\\rangle$\n- **数据处理**: 通过长度为 $3$ 的滑动窗口来解析每条路径，以形成三元组 $(u,w,v)$。\n- **先验分布**: 对于每个上下文 $(u,w)$，在 $|V|=4$ 个可能的结果上，存在一个对称狄利克雷先验，其集中参数为 $\\alpha=\\frac{1}{2}$。\n- **统计模型**: 问题陈述使用以下事实：(i) 多项式似然函数控制分类结果的计数，(ii) 狄利克雷分布是多项式分布的共轭先验，以及 (iii) 多项式-狄利克雷模型的后验预测分布产生一个归一化的概率分布。\n- **任务1**: 推导并计算在数据集中观察到的每个不同上下文 $(u,w)$ 的平滑的、依赖于上下文的二阶转移概率 $P(v\\mid u,w)$。\n- **任务2**: 从第一性原理出发，验证对于每个上下文 $(u,w)$，分布 $\\{P(v\\mid u,w):v\\in V\\}$ 的总和为 $1$。\n- **任务3**: 计算特定上下文 $(B,C)$ 的香农熵 $H\\big(P(\\cdot\\mid B,C)\\big)=-\\sum_{v\\in V}P(v\\mid B,C)\\,\\ln\\big(P(v\\mid B,C)\\big)$。\n- **最终答案格式**: 熵的精确解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**: 该问题在网络科学（高阶网络）、贝叶斯统计（狄利克雷-多项式共轭模型）和信息论（香农熵）的既定原则方面有充分的依据。狄利克雷分布和多项式分布之间的关系以及后验预测分布的公式是贝叶斯分析中的标准结果。\n- **适定性**: 问题定义清晰。数据集已提供，提取观测值的方法（滑动窗口）已指定，先验分布已明确定义（$\\alpha=1/2$），并且最终要计算的量是明确的。存在唯一、稳定且有意义的解。\n- **客观性**: 问题以精确、正式的语言陈述，没有任何主观或模棱两可的术语。\n- **完整性和一致性**: 所有必要信息（节点集、路径、先验参数、模型类型）均已提供。各项任务在逻辑上是顺序的，并且相互一致。\n\n**第3步：结论与行动**\n问题有效。它在科学上是合理的，适定的，并且是自洽的。可以开始求解过程。\n\n### 解\n\n该问题要求我们计算一个二阶马尔可夫模型的平滑转移概率，然后计算特定上下文所得分布的熵。\n\n**1. 提取二阶转移计数**\n我们首先对给定路径应用长度为3的滑动窗口，以提取三元组 $(u,w,v)$，这代表从上下文 $(u,w)$到下一个节点 $v$ 的一次转移。\n\n路径 1: $\\langle A,B,C,D,B,C\\rangle$ 产生三元组:\n$(A,B,C)$, $(B,C,D)$, $(C,D,B)$, $(D,B,C)$.\n\n路径 2: $\\langle B,C,B,A,B,D\\rangle$ 产生三元组:\n$(B,C,B)$, $(C,B,A)$, $(B,A,B)$, $(A,B,D)$.\n\n路径 3: $\\langle C,B,C,D,C,B\\rangle$ 产生三元组:\n$(C,B,C)$, $(B,C,D)$, $(C,D,C)$, $(D,C,B)$.\n\n现在，我们汇总这些观测值，以获得每个不同上下文 $(u,w)$ 的计数 $N(v|u,w)$。\n- **上下文 $(A,B)$**: $(A,B,C)$, $(A,B,D) \\implies N(C|A,B)=1, N(D|A,B)=1$。总计数为 $N_{A,B}=2$。\n- **上下文 $(B,C)$**: $(B,C,D)$, $(B,C,B)$, $(B,C,D) \\implies N(B|B,C)=1, N(D|B,C)=2$。总计数为 $N_{B,C}=3$。\n- **上下文 $(C,D)$**: $(C,D,B)$, $(C,D,C) \\implies N(B|C,D)=1, N(C|C,D)=1$。总计数为 $N_{C,D}=2$。\n- **上下文 $(D,B)$**: $(D,B,C) \\implies N(C|D,B)=1$。总计数为 $N_{D,B}=1$。\n- **上下文 $(C,B)$**: $(C,B,A)$, $(C,B,C) \\implies N(A|C,B)=1, N(C|C,B)=1$。总计数为 $N_{C,B}=2$。\n- **上下文 $(B,A)$**: $(B,A,B) \\implies N(B|B,A)=1$。总计数为 $N_{B,A}=1$。\n- **上下文 $(D,C)$**: $(D,C,B) \\implies N(B|D,C)=1$。总计数为 $N_{D,C}=1$。\n\n对于所有其他转移 $(v|u,w)$，计数为 $0$。\n\n**2. 推导后验预测概率**\n对于给定的上下文 $(u,w)$，关于下一节点 $v \\in V$ 的概率分布是一个分类分布，其参数向量为 $\\vec{p}_{u,w} = (P(v|u,w))_{v \\in V}$。观测到的计数 $\\vec{N}_{u,w} = (N(v|u,w))_{v \\in V}$ 受多项式似然函数控制。\n\n我们给定 $\\vec{p}_{u,w}$ 的一个对称狄利克雷先验：$P(\\vec{p}_{u,w}) = \\text{Dir}(\\vec{\\alpha})$，其中 $\\vec{\\alpha} = (\\alpha, \\alpha, \\alpha, \\alpha)$ 且 $\\alpha = \\frac{1}{2}$。词汇表（节点集）的大小为 $|V|=4$。\n\n狄利克雷分布是多项式似然的共轭先验。因此，在观测到计数 $\\vec{N}_{u,w}$ 之后，$\\vec{p}_{u,w}$ 的后验分布也是一个狄利克雷分布：\n$$ P(\\vec{p}_{u,w} | \\vec{N}_{u,w}) = \\text{Dir}(\\vec{\\alpha} + \\vec{N}_{u,w}) $$\n结果 $v$ 的后验参数是 $\\alpha_v' = \\alpha + N(v|u,w)$。\n\n观测到一个新结果 $v$ 的后验预测概率是相应参数 $P(v|u,w)$ 在后验分布下的期望值。对于一个狄利克雷分布 $\\text{Dir}(\\vec{\\beta})$，第 $i$ 个分量的期望值为 $E[p_i] = \\frac{\\beta_i}{\\sum_j \\beta_j}$。\n将此应用于我们的后验分布，平滑后的转移概率为：\n$$ P(v \\mid u,w) = \\frac{\\alpha + N(v|u,w)}{\\sum_{v' \\in V} (\\alpha + N(v'|u,w))} = \\frac{\\alpha + N(v|u,w)}{|V|\\alpha + \\sum_{v' \\in V} N(v'|u,w)} $$\n令 $N_{u,w} = \\sum_{v' \\in V} N(v'|u,w)$ 为从上下文 $(u,w)$ 观察到的总转移次数。代入给定值 $\\alpha=\\frac{1}{2}$ 和 $|V|=4$，我们得到：\n$$ P(v \\mid u,w) = \\frac{\\frac{1}{2} + N(v|u,w)}{4 \\times \\frac{1}{2} + N_{u,w}} = \\frac{\\frac{1}{2} + N(v|u,w)}{2 + N_{u,w}} $$\n\n**3. 对总和为一性质的验证**\n按照要求，我们从第一性原理验证所推导的概率对于任何上下文 $(u,w)$ 构成一个有效的分布：\n$$ \\sum_{v \\in V} P(v \\mid u,w) = \\sum_{v \\in V} \\frac{\\alpha + N(v|u,w)}{|V|\\alpha + N_{u,w}} $$\n由于分母相对于求和变量 $v$ 是常数，我们有：\n$$ = \\frac{1}{|V|\\alpha + N_{u,w}} \\sum_{v \\in V} \\left( \\alpha + N(v|u,w) \\right) $$\n$$ = \\frac{1}{|V|\\alpha + N_{u,w}} \\left( \\left(\\sum_{v \\in V} \\alpha\\right) + \\left(\\sum_{v \\in V} N(v|u,w)\\right) \\right) $$\n第一个和是对 $|V|$ 个相同项求和，结果为 $|V|\\alpha$。第二个和是 $N_{u,w}$ 的定义。\n$$ = \\frac{|V|\\alpha + N_{u,w}}{|V|\\alpha + N_{u,w}} = 1 $$\n对于任何有效的参数和计数组合，该性质都成立。\n\n**4. 计算上下文 $(B,C)$ 的概率**\n我们现在应用推导出的公式来计算特定上下文 $(u,w) = (B,C)$ 的概率。根据我们的计数，有 $N(B|B,C)=1$，$N(D|B,C)=2$，以及 $N_{B,C}=3$。对于 $A$ 和 $C$ 的计数为 $0$。\n概率表达式的分母是 $2 + N_{B,C} = 2+3=5$。\n对于每个 $v \\in \\{A,B,C,D\\}$ 的概率是：\n- $P(A \\mid B,C) = \\frac{\\frac{1}{2} + N(A|B,C)}{5} = \\frac{\\frac{1}{2} + 0}{5} = \\frac{1}{10}$\n- $P(B \\mid B,C) = \\frac{\\frac{1}{2} + N(B|B,C)}{5} = \\frac{\\frac{1}{2} + 1}{5} = \\frac{3/2}{5} = \\frac{3}{10}$\n- $P(C \\mid B,C) = \\frac{\\frac{1}{2} + N(C|B,C)}{5} = \\frac{\\frac{1}{2} + 0}{5} = \\frac{1}{10}$\n- $P(D \\mid B,C) = \\frac{\\frac{1}{2} + N(D|B,C)}{5} = \\frac{\\frac{1}{2} + 2}{5} = \\frac{5/2}{5} = \\frac{5}{10} = \\frac{1}{2}$\n\n给定上下文 $(B,C)$ 的下一个节点的概率分布是 $\\{P(v|B,C)\\}_{v \\in V} = \\{\\frac{1}{10}, \\frac{3}{10}, \\frac{1}{10}, \\frac{1}{2}\\}$。\n\n**5. 计算上下文 $(B,C)$ 的香农熵**\n最后，我们使用自然对数计算此分布的香农熵：\n$$ H\\big(P(\\cdot\\mid B,C)\\big)=-\\sum_{v\\in V}P(v\\mid B,C)\\,\\ln\\big(P(v\\mid B,C)\\big) $$\n设概率为 $p_A=\\frac{1}{10}$，$p_B=\\frac{3}{10}$，$p_C=\\frac{1}{10}$，以及 $p_D=\\frac{1}{2}$。\n$$ H = - \\left( p_A \\ln(p_A) + p_B \\ln(p_B) + p_C \\ln(p_C) + p_D \\ln(p_D) \\right) $$\n$$ H = - \\left( \\frac{1}{10}\\ln\\left(\\frac{1}{10}\\right) + \\frac{3}{10}\\ln\\left(\\frac{3}{10}\\right) + \\frac{1}{10}\\ln\\left(\\frac{1}{10}\\right) + \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) \\right) $$\n合并相同项：\n$$ H = - \\left( 2 \\cdot \\frac{1}{10}\\ln\\left(\\frac{1}{10}\\right) + \\frac{3}{10}\\ln\\left(\\frac{3}{10}\\right) + \\frac{5}{10}\\ln\\left(\\frac{5}{10}\\right) \\right) $$\n我们使用这样一个性质：对于概率分布 $\\{p_i = n_i/N\\}$，其熵为 $H = \\ln(N) - \\frac{1}{N}\\sum_i n_i \\ln(n_i)$。这里，公分母是 $N=10$，分子分别为 $n_A=1, n_B=3, n_C=1, n_D=5$。\n$$ H = \\ln(10) - \\frac{1}{10} \\left( 1\\ln(1) + 3\\ln(3) + 1\\ln(1) + 5\\ln(5) \\right) $$\n因为 $\\ln(1)=0$，表达式简化为：\n$$ H = \\ln(10) - \\frac{1}{10} \\left( 3\\ln(3) + 5\\ln(5) \\right) $$\n$$ H = \\ln(10) - \\frac{3}{10}\\ln(3) - \\frac{5}{10}\\ln(5) $$\n$$ H = \\ln(10) - \\frac{3}{10}\\ln(3) - \\frac{1}{2}\\ln(5) $$\n这就是熵的最终精确解析表达式。",
            "answer": "$$\\boxed{\\ln(10) - \\frac{3}{10}\\ln(3) - \\frac{1}{2}\\ln(5)}$$"
        },
        {
            "introduction": "一旦定义了高阶模型，我们如何用它进行分析？本题通过将经典的最短路径问题应用于一个带有路径依赖成本（即“转弯惩罚”）的场景来探讨这一点。你将学习一种基本技巧：将高阶问题转换为一个扩展状态空间图上等效的一阶问题，从而使其能够用标准算法求解 。",
            "id": "4281377",
            "problem": "考虑一个有向图 $G=(V,E)$，其中 $V=\\{S,X,Y,Z,T\\}$，边权重函数为 $w:E\\to\\mathbb{R}_{\\ge 0}$。一条路径 $P=(v_{0},v_{1},\\ldots,v_{m})$ 的基础成本定义为边权重的加和，即 $\\sum_{\\ell=0}^{m-1} w(v_{\\ell},v_{\\ell+1})$。在许多交通和流系统中，遍历成本并非纯粹的边权重加和：它们还取决于在中间顶点处所做的转向序列。为了捕捉这种路径依赖性，定义一个转向惩罚函数 $p:V\\times V\\times V\\to\\mathbb{R}_{\\ge 0}$，使得对于任意连续的边 $(i,j)\\in E$ 和 $(j,k)\\in E$，转向 $(i\\to j\\to k)$ 会产生一个额外的成本 $p(i,j,k)$。对于离开源点的路径的第一条边，不施加转向惩罚。于是，二阶路径成本是路径上的边权重和转向惩罚的加和：$\\sum_{\\ell=0}^{m-1} w(v_{\\ell},v_{\\ell+1}) + \\sum_{\\ell=0}^{m-2} p(v_{\\ell},v_{\\ell+1},v_{\\ell+2})$。\n\n给定以下边和权重：\n- $(S,X)$，权重为 $w(S,X)=1$，\n- $(X,Y)$，权重为 $w(X,Y)=1$，\n- $(Y,T)$，权重为 $w(Y,T)=1$，\n- $(S,Z)$，权重为 $w(S,Z)=2$，\n- $(Z,T)$，权重为 $w(Z,T)=2$，\n- $(X,Z)$，权重为 $w(X,Z)=1$。\n\n转向惩罚函数 $p$ 在允许的三元组上指定如下：\n- $p(S,X,Y)=5$，\n- $p(X,Y,T)=0$，\n- $p(S,Z,T)=0$，\n- $p(S,X,Z)=0$，\n- $p(X,Z,T)=0$，\n且对于所有其他未在上面列出的有效三元组 $(i,j,k)$（其中 $(i,j)\\in E$ 且 $(j,k)\\in E$），$p(i,j,k)=0$。\n\n从一阶最短路径的基础定义以及通过2阶记忆网络（也称为二阶模型）表示路径依赖成本的方法出发，推导出一个原则性的变换，该变换将 $G$ 上的二阶最短路径问题转换为扩展状态空间上的一阶最短路径问题。使用此变换计算从 $S$ 到 $T$ 的最小二阶成本。另外，当忽略转向惩罚时（即，仅最小化 $\\sum w$），分别计算从 $S$ 到 $T$ 的简单最短路径。设 $R$ 为在真实的二阶成本下，因使用简单最短路径而产生的遗憾值，其定义为简单最短路径的二阶成本与最优二阶成本之间的差值。以单个标量的形式精确提供 $R$ 的值。本问题无需四舍五入，也不涉及单位。",
            "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 图：$G=(V,E)$\n- 顶点：$V=\\{S,X,Y,Z,T\\}$\n- 边权重函数：$w:E\\to\\mathbb{R}_{\\ge 0}$\n- 边和权重：\n    - $w(S,X)=1$\n    - $w(X,Y)=1$\n    - $w(Y,T)=1$\n    - $w(S,Z)=2$\n    - $w(Z,T)=2$\n    - $w(X,Z)=1$\n- 转向惩罚函数：$p:V\\times V\\times V\\to\\mathbb{R}_{\\ge 0}$\n- 转向惩罚：\n    - $p(S,X,Y)=5$\n    - $p(X,Y,T)=0$\n    - $p(S,Z,T)=0$\n    - $p(S,X,Z)=0$\n    - $p(X,Z,T)=0$\n    - 对于所有其他有效的三元组 $(i,j,k)$，$p(i,j,k)=0$。\n- 基础路径成本（一阶）：$C_1(P) = \\sum_{\\ell=0}^{m-1} w(v_{\\ell},v_{\\ell+1})$\n- 二阶路径成本：$C_2(P) = \\sum_{\\ell=0}^{m-1} w(v_{\\ell},v_{\\ell+1}) + \\sum_{\\ell=0}^{m-2} p(v_{\\ell},v_{\\ell+1},v_{\\ell+2})$\n- 遗憾值：$R = (\\text{简单最短路径的二阶成本}) - (\\text{最优二阶成本})$\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，植根于图论和网络优化这一数学领域。高阶网络和带转向惩罚的最短路径的概念是计算机科学和复杂系统中一个成熟的课题。该问题是适定的：它是自洽的，所有必要的数据（图结构、权重、惩罚）都已提供。定义清晰且形式化，没有留下任何模糊空间。目标陈述精确。不存在矛盾、事实错误或主观论断。该问题是可形式化和可解的，可以使用标准的（尽管是高级的）图算法。\n\n### 第3步：结论与行动\n问题被判定为有效。将提供完整的解决方案。\n\n### 解题推导\n\n解决方案需要三部分计算：\n1.  仅基于边权重 $w$ 确定从 $S$ 到 $T$ 的简单最短路径。\n2.  使用包含转向惩罚 $p$ 的二阶成本函数，确定从 $S$ 到 $T$ 的最优最短路径。\n3.  按定义计算遗憾值 $R$。\n\n#### 1. 简单最短路径（一阶成本）\n\n我们寻求最小化基础成本 $C_1(P) = \\sum w(v_{\\ell},v_{\\ell+1})$。我们枚举图 $G$ 中从 $S$ 到 $T$ 的所有可能路径，并计算它们的一阶成本。\n- 路径 $P_1 = (S, X, Y, T)$:\n  $C_1(P_1) = w(S,X) + w(X,Y) + w(Y,T) = 1 + 1 + 1 = 3$。\n- 路径 $P_2 = (S, Z, T)$:\n  $C_1(P_2) = w(S,Z) + w(Z,T) = 2 + 2 = 4$。\n- 路径 $P_3 = (S, X, Z, T)$:\n  $C_1(P_3) = w(S,X) + w(X,Z) + w(Z,T) = 1 + 1 + 2 = 4$。\n\n比较这些成本，最小的一阶成本是 $3$。因此，简单最短路径（我们记为 $P_{simple}$）是 $P_1 = (S, X, Y, T)$。\n\n#### 2. 简单最短路径的二阶成本\n\n接下来，我们计算路径 $P_{simple} = (S, X, Y, T)$ 的二阶成本 $C_2$。\n$C_2(P_{simple}) = (w(S,X) + w(X,Y) + w(Y,T)) + (p(S,X,Y) + p(X,Y,T))$。\n使用给定的值：\n$C_2(P_{simple}) = (1 + 1 + 1) + (5 + 0) = 3 + 5 = 8$。\n所以，在一阶模型下被视为最优的路径的二阶成本为 $8$。\n\n#### 3. 最优二阶最短路径\n\n为了找到真正的最小二阶成本，我们必须考虑路径依赖的转向惩罚。这是一个二阶（或2阶记忆）问题。解决它的一个原则性方法是将其转换为一个等价的一阶最短路径问题，该问题定义在一个扩展的状态空间或线图 $G'=(V', E')$ 上。\n\n**转换为一阶问题**\n\n新图 $G'$ 中的状态必须不仅编码当前顶点，而且还要编码到达该顶点的前一个顶点，因为需要此信息来应用正确的转向惩罚。\n- **$G'$ 的顶点**：$V'$ 的顶点代表原始图 $G$ 的有向边。$V'$ 中的一个顶点由有序对 $(u,v)$ 表示，其中 $(u,v) \\in E$。我们还添加一个虚拟源节点 $S_{start}$ 和一个虚拟汇点 $T_{end}$。\n- **$G'$ 的边**：如果边的序列 $((i,j),(j,k))$ 代表原始图 $G$ 中的一个有效转向 $i \\to j \\to k$，则在 $E'$ 中存在一条从顶点 $(i,j) \\in V'$ 到顶点 $(j,k) \\in V'$ 的边。\n- **$G'$ 的边权重**：$G'$ 中从 $(i,j)$ 到 $(j,k)$ 的边的权重是，从 $i$ 到达后遍历边 $(j,k)$ 的成本。该成本是边权重 $w(j,k)$ 和转向惩罚 $p(i,j,k)$ 的和。\n  $w'((i,j), (j,k)) = w(j,k) + p(i,j,k)$。\n\n- **源点和汇点的连接**：\n  - 对于离开原始源点 $S$ 的每条边 $(S, v)$，我们在 $G'$ 中添加一条从 $S_{start}$ 到顶点 $(S,v) \\in V'$ 的边。此边的成本就是第一步的权重 $w(S,v)$，因为没有转向惩罚。\n  - 对于进入原始汇点 $T$ 的每条边 $(u, T)$，我们在 $G'$ 中添加一条从顶点 $(u,T) \\in V'$ 到虚拟汇点 $T_{end}$ 的零权重边。\n\n**在 $G'$ 上构建和求解**\n\n我们根据问题的已知条件构建 $G'$。\n- **$V'$ 中的顶点**：$S_{start}$，$T_{end}$，以及对应于 $E$ 中边的顶点：$(S,X)$、$(X,Y)$、$(Y,T)$、$(S,Z)$、$(Z,T)$、$(X,Z)$。\n\n- **$E'$ 中的边和权重**：\n  - **从 $S_{start}$ 出发**：\n    - $S_{start} \\to (S,X)$：权重 $w(S,X) = 1$。\n    - $S_{start} \\to (S,Z)$：权重 $w(S,Z) = 2$。\n  - **表示转向**：\n    - 转向 $S \\to X \\to Y$：边 $(S,X) \\to (X,Y)$，权重为 $w(X,Y) + p(S,X,Y) = 1 + 5 = 6$。\n    - 转向 $S \\to X \\to Z$：边 $(S,X) \\to (X,Z)$，权重为 $w(X,Z) + p(S,X,Z) = 1 + 0 = 1$。\n    - 转向 $X \\to Y \\to T$：边 $(X,Y) \\to (Y,T)$，权重为 $w(Y,T) + p(X,Y,T) = 1 + 0 = 1$。\n    - 转向 $S \\to Z \\to T$：边 $(S,Z) \\to (Z,T)$，权重为 $w(Z,T) + p(S,Z,T) = 2 + 0 = 2$。\n    - 转向 $X \\to Z \\to T$：边 $(X,Z) \\to (Z,T)$，权重为 $w(Z,T) + p(X,Z,T) = 2 + 0 = 2$。\n  - **到 $T_{end}$**：\n    - $(Y,T) \\to T_{end}$：权重 $0$。\n    - $(Z,T) \\to T_{end}$：权重 $0$。\n\n现在我们在这个新的一阶图 $G'$ 中找到从 $S_{start}$ 到 $T_{end}$ 的最短路径。我们枚举 $G'$ 中的路径：\n- **路径 $P'_1$（对应于 $G$ 中的 $S \\to X \\to Y \\to T$）**：\n  $S_{start} \\to (S,X) \\to (X,Y) \\to (Y,T) \\to T_{end}$\n  成本 = $w'(S_{start},(S,X)) + w'((S,X),(X,Y)) + w'((X,Y),(Y,T)) + w'((Y,T),T_{end}) = 1 + 6 + 1 + 0 = 8$。\n\n- **路径 $P'_2$（对应于 $G$ 中的 $S \\to Z \\to T$）**：\n  $S_{start} \\to (S,Z) \\to (Z,T) \\to T_{end}$\n  成本 = $w'(S_{start},(S,Z)) + w'((S,Z),(Z,T)) + w'((Z,T),T_{end}) = 2 + 2 + 0 = 4$。\n\n- **路径 $P'_3$（对应于 $G$ 中的 $S \\to X \\to Z \\to T$）**：\n  $S_{start} \\to (S,X) \\to (X,Z) \\to (Z,T) \\to T_{end}$\n  成本 = $w'(S_{start},(S,X)) + w'((S,X),(X,Z)) + w'((X,Z),(Z,T)) + w'((Z,T),T_{end}) = 1 + 1 + 2 + 0 = 4$。\n\n比较 $G'$ 中路径的总成本，最小成本为 $4$。这就是最优的二阶成本。\n\n#### 4. 遗憾值 $R$ 的计算\n\n遗憾值 $R$ 是简单最短路径的二阶成本与最优二阶成本之间的差值。\n- $P_{simple}$ 的二阶成本：$8$。\n- 最优二阶成本：$4$。\n\n$R = 8 - 4 = 4$。\n\n因忽略二阶转向惩罚并遵循朴素最优路径而产生的遗憾值为 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "为什么高阶模型至关重要？本练习通过探索一个动态过程——流行病传播——来展示其重要性，在该过程中，系统的最终状态取决于具体的感染路径。通过分析一个无记忆模型会失效的场景，你将具体理解路径依赖如何从根本上改变系统级别的结果 。",
            "id": "4281345",
            "problem": "考虑一个由四个节点 $\\{a,b,c,d\\}$ 组成的最小有向接触模体，其有向边为 $a \\to b$、$d \\to b$ 和 $b \\to c$。一个连续时间易感-感染 (SI) 过程在该模体上运行，无恢复，瞬时感染尝试由符合传播条件的边上的独立指数时钟控制。在时间 $t=0$ 时，节点 $a$ 和 $d$ 是感染状态，节点 $b$ 和 $c$ 是易感状态。\n\n定义了两个模型如下：\n\n- 基准无记忆模型：一旦节点 $b$ 被感染（无论其如何被感染），它会根据一个速率为 $\\mu$（其中 $\\mu > 0$）的指数时钟，通过边 $b \\to c$ 尝试感染节点 $c$。边 $a \\to b$ 和 $d \\to b$ 的传播速率分别为 $\\lambda_a > 0$ 和 $\\lambda_d > 0$。\n\n- 高阶路径依赖模型：该模型表示为一个二阶过程，其中从 $b$ 到 $c$ 的有效传播取决于 $b$ 的感染源。具体来说，如果 $b$ 被 $a$ 感染，则 $b \\to c$ 的风险率等于 $\\mu_a > 0$；如果 $b$ 被 $d$ 感染，则其等于 $\\mu_d = 0$。边 $a \\to b$ 和 $d \\to b$ 的传播速率同样分别为 $\\lambda_a > 0$ 和 $\\lambda_d > 0$。\n\n假设所有传播时钟都是独立的，没有恢复，并且时间范围足够长，以至于任何由正指数速率控制的传播几乎必然在某个有限时间内发生。\n\n仅从指数等待时间和独立性的定义出发，以及从一个二阶（order-2）网络表示的构建出发（其中状态是有序节点对 $(w,u)$，表示最后一步是 $w \\to u$），推导在高阶路径依赖模型下，最终爆发规模的期望值（当 $t \\to \\infty$ 时受感染节点的期望数量），并将其表示为 $\\lambda_a$ 和 $\\lambda_d$ 的函数。请用 $\\lambda_a$ 和 $\\lambda_d$ 的封闭形式解析表达式表示您的最终答案。不要四舍五入。结果不带单位。",
            "solution": "问题要求在高阶路径依赖模型下，一个特定四节点模体上的易感-感染 (SI) 过程的最终爆发规模的期望值。我们将从控制感染事件的指数分布的基本性质推导出这个值。\n\n设节点集为 $V = \\{a, b, c, d\\}$。在时间 $t=0$ 时的初始状态是，节点 $a$ 和 $d$ 被感染 ($I_0 = \\{a, d\\}$)，节点 $b$ 和 $c$ 是易感的 ($S_0 = \\{b, c\\}$)。初始感染节点数为 2。\n\n该过程随着受感染节点试图感染其易感邻居而演化。从初始状态开始，可能的传播事件是 $a \\to b$ 和 $d \\to b$。节点 $c$ 只能被 $b$ 感染，因此在 $b$ 被感染之前它一直保持易感状态。\n\n从 $a \\to b$ 和 $d \\to b$ 的感染尝试由独立的指数时钟控制。设 $T_a$ 是传播事件 $a \\to b$ 的等待时间， $T_d$ 是传播事件 $d \\to b$ 的等待时间。根据问题陈述，这些是具有指数分布的独立随机变量：\n- $T_a \\sim \\text{Exp}(\\lambda_a)$，其概率密度函数为 $f_{T_a}(t_a) = \\lambda_a \\exp(-\\lambda_a t_a)$，当 $t_a \\ge 0$。\n- $T_d \\sim \\text{Exp}(\\lambda_d)$，其概率密度函数为 $f_{T_d}(t_d) = \\lambda_d \\exp(-\\lambda_d t_d)$，当 $t_d \\ge 0$。\n\n由于 $\\lambda_a > 0$ 且 $\\lambda_d > 0$，两个速率都为正。这意味着节点 $b$ 最终将被 $a$ 或 $d$ 感染，概率为 $1$。节点 $b$ 的感染时间是 $T_b = \\min(T_a, T_d)$。节点 $b$ 被感染后，感染节点数变为 3（节点 $a$、$d$ 和 $b$）。\n\n高阶模型的核心在于后续事件，即从 $b$ 到 $c$ 的潜在传播。此传播的速率取决于哪个节点感染了 $b$。\n1.  如果节点 $a$ 感染了 $b$（即 $T_a < T_d$），则 $b \\to c$ 传播的风险率为 $\\mu_a > 0$。\n2.  如果节点 $d$ 感染了 $b$（即 $T_d < T_a$），则 $b \\to c$ 传播的风险率为 $\\mu_d = 0$。\n\n问题陈述任何具有正速率的传播几乎必然会发生。因此，如果节点 $a$ 感染了 $b$，节点 $c$ 随后也会被感染。如果节点 $d$ 感染了 $b$，节点 $c$ 将永远不会被感染，因为传播速率为零。\n\n因此，如果 $a$ 感染 $b$，最终爆发规模 $N_{\\infty}$ 将为 4；如果 $d$ 感染 $b$，则为 3。为了求出期望的最终爆发规模 $E[N_{\\infty}]$，我们必须首先计算这两个互斥事件的概率。\n\n让我们计算节点 $a$ 感染节点 $b$ 的概率，即 $P(T_a < T_d)$。由于 $T_a$ 和 $T_d$ 是独立的，它们的联合概率密度函数为 $f(t_a, t_d) = f_{T_a}(t_a) f_{T_d}(t_d) = \\lambda_a \\lambda_d \\exp(-\\lambda_a t_a - \\lambda_d t_d)$，当 $t_a, t_d \\ge 0$。我们在 $t_a < t_d$ 的区域上对这个联合概率密度函数进行积分：\n$$ P(T_a < T_d) = \\int_0^\\infty \\int_0^{t_d} \\lambda_a \\exp(-\\lambda_a t_a) \\lambda_d \\exp(-\\lambda_d t_d) \\, dt_a \\, dt_d $$\n我们首先计算关于 $t_a$ 的内层积分：\n$$ \\int_0^{t_d} \\lambda_a \\exp(-\\lambda_a t_a) \\, dt_a = \\left[ -\\exp(-\\lambda_a t_a) \\right]_0^{t_d} = -\\exp(-\\lambda_a t_d) - (-\\exp(0)) = 1 - \\exp(-\\lambda_a t_d) $$\n将此结果代入外层积分：\n$$ P(T_a < T_d) = \\int_0^\\infty \\lambda_d \\exp(-\\lambda_d t_d) \\left( 1 - \\exp(-\\lambda_a t_d) \\right) \\, dt_d $$\n$$ = \\int_0^\\infty \\left( \\lambda_d \\exp(-\\lambda_d t_d) - \\lambda_d \\exp(-(\\lambda_a + \\lambda_d) t_d) \\right) \\, dt_d $$\n$$ = \\left[ -\\exp(-\\lambda_d t_d) - \\lambda_d \\frac{-\\exp(-(\\lambda_a + \\lambda_d) t_d)}{\\lambda_a + \\lambda_d} \\right]_0^\\infty $$\n$$ = \\left[ -\\exp(-\\lambda_d t_d) + \\frac{\\lambda_d}{\\lambda_a + \\lambda_d} \\exp(-(\\lambda_a + \\lambda_d) t_d) \\right]_0^\\infty $$\n在极限处求值：\n$$ = \\left( \\lim_{t_d\\to\\infty} \\left( -\\exp(-\\lambda_d t_d) + \\frac{\\lambda_d}{\\lambda_a + \\lambda_d} \\exp(-(\\lambda_a+\\lambda_d)t_d) \\right) \\right) - \\left( -\\exp(0) + \\frac{\\lambda_d}{\\lambda_a + \\lambda_d} \\exp(0) \\right) $$\n$$ = (0 - 0) - \\left( -1 + \\frac{\\lambda_d}{\\lambda_a + \\lambda_d} \\right) = 1 - \\frac{\\lambda_d}{\\lambda_a + \\lambda_d} = \\frac{\\lambda_a + \\lambda_d - \\lambda_d}{\\lambda_a + \\lambda_d} = \\frac{\\lambda_a}{\\lambda_a + \\lambda_d} $$\n所以，$a$ 感染 $b$ 的概率是 $P(a \\to b) = \\frac{\\lambda_a}{\\lambda_a + \\lambda_d}$。\n由于 $b$ 的感染只有两种可能性，$d$ 感染 $b$ 的概率是 $P(d \\to b) = 1 - P(a \\to b) = \\frac{\\lambda_d}{\\lambda_a + \\lambda_d}$。\n\n现在我们可以确定期望的最终爆发规模。我们可以将最终规模 $N_{\\infty}$ 表示为确定会被感染的节点数与一个代表感染不确定的节点的随机变量之和。\n节点 $a$、$d$ 和 $b$ 肯定在最终的感染集合中。因此，最终规模至少为 3。\n节点 $c$ 仅在 $a$ 感染 $b$ 时才会被感染。设 $X_c$ 为一个指示随机变量，如果节点 $c$ 被感染，则 $X_c = 1$，否则 $X_c = 0$。\n最终爆发规模为 $N_{\\infty} = 3 + X_c$。\n根据期望的线性性质，$E[N_{\\infty}] = E[3 + X_c] = 3 + E[X_c]$。\n\n指示变量的期望值是其所指示事件的概率。\n$E[X_c] = P(X_c = 1) = P(\\text{节点 } c \\text{ 被感染})$。\n节点 $c$ 被感染当且仅当节点 $a$ 感染节点 $b$。\n因此，$E[X_c] = P(a \\to b) = \\frac{\\lambda_a}{\\lambda_a + \\lambda_d}$。\n\n将此代回期望最终规模的表达式中：\n$$ E[N_{\\infty}] = 3 + \\frac{\\lambda_a}{\\lambda_a + \\lambda_d} $$\n为了将其写成单个分数：\n$$ E[N_{\\infty}] = \\frac{3(\\lambda_a + \\lambda_d)}{\\lambda_a + \\lambda_d} + \\frac{\\lambda_a}{\\lambda_a + \\lambda_d} = \\frac{3\\lambda_a + 3\\lambda_d + \\lambda_a}{\\lambda_a + \\lambda_d} = \\frac{4\\lambda_a + 3\\lambda_d}{\\lambda_a + \\lambda_d} $$\n这就是期望最终爆发规模关于给定参数 $\\lambda_a$ 和 $\\lambda_d$ 的封闭形式解析表达式。",
            "answer": "$$\\boxed{\\frac{4\\lambda_a + 3\\lambda_d}{\\lambda_a + \\lambda_d}}$$"
        }
    ]
}