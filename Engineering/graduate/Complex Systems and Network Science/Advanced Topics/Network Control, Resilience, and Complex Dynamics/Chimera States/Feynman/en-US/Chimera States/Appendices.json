{
    "hands_on_practices": [
        {
            "introduction": "The journey into the world of chimera states often begins with numerical exploration. Before any code is written or data analyzed, a clear and logical experimental plan is paramount. This foundational exercise  walks you through the essential steps of setting up a simulation, from defining the system parameters to analyzing the final state, ensuring that your computational search for these elusive patterns is built on a solid methodological foundation.",
            "id": "1666625",
            "problem": "A student in an introductory course on nonlinear dynamics is tasked with numerically investigating chimera states. These are special spatiotemporal patterns in networks of identical oscillators where a subset of oscillators synchronizes while the rest remain incoherent. The student considers a one-dimensional ring of $N$ identical phase oscillators with non-local coupling, governed by the Kuramoto-Sakaguchi equations:\n$$ \\frac{d\\theta_i}{dt} = \\omega - \\frac{K}{2R+1} \\sum_{j=i-R}^{j=i+R} \\sin(\\theta_i - \\theta_j + \\alpha) $$\nHere, $\\theta_i$ is the phase of the $i$-th oscillator (with indices taken modulo $N$), $\\omega$ is the uniform natural frequency, $K$ is the coupling strength, $R$ is the coupling radius defining the neighborhood size, and $\\alpha$ is a phase lag parameter.\n\nTo find a chimera state, the student must perform a sequence of steps in a precise order. Below are five fundamental actions required for this numerical experiment:\n\n(i) Evolve the system of $N$ coupled Ordinary Differential Equations (ODEs) forward in time using a numerical integration method (e.g., Runge-Kutta) for a large number of time steps.\n(ii) Specify the fixed parameters of the system: the number of oscillators $N$, their natural frequency $\\omega$, the coupling strength $K$, the coupling radius $R$, and the phase lag $\\alpha$.\n(iii) After the evolution, analyze the behavior of the oscillators to check for the hallmark of a chimera state: the coexistence of a group of oscillators with identical effective frequencies and another group with a distribution of different effective frequencies.\n(iv) Set the initial condition for the system by assigning a phase $\\theta_i(0)$ to each oscillator at time $t=0$. For chimeras, a specially prepared non-uniform state is often required.\n(v) Ignore the data from the initial portion of the time evolution to ensure that any transient behavior has decayed and the system has settled onto its long-term attractor.\n\nWhich of the following options represents the correct logical sequence of these actions to successfully set up and execute the simulation to search for a chimera state?\n\nA. (ii) → (iv) → (i) → (v) → (iii)\n\nB. (ii) → (iv) → (iii) → (i) → (v)\n\nC. (iv) → (ii) → (i) → (v) → (iii)\n\nD. (ii) → (i) → (iv) → (v) → (iii)\n\nE. (ii) → (iv) → (i) → (iii) → (v)",
            "solution": "We are to determine the correct logical sequence of actions to numerically search for a chimera state in the given system of $N$ nonlocally coupled phase oscillators governed by the Kuramoto-Sakaguchi equations\n$$\n\\frac{d\\theta_{i}}{dt}=\\omega-\\frac{K}{2R+1}\\sum_{j=i-R}^{i+R}\\sin\\!\\big(\\theta_{i}-\\theta_{j}+\\alpha\\big),\n$$\nwith indices taken modulo $N$. This defines an initial value problem for $N$ coupled first-order ODEs. For such a problem, one must first fully specify the vector field and the initial condition before performing any time integration, then integrate forward, remove transients to focus on the long-term behavior (attractor), and finally analyze observables that reveal the chimera signature.\n\nFirst, one must specify the fixed parameters of the model to define the right-hand side map $f:\\mathbb{T}^{N}\\to\\mathbb{R}^{N}$ of the ODE. Writing the system compactly as\n$$\n\\dot{\\theta}_{i}=f_{i}(\\theta;\\omega,K,R,\\alpha), \\quad i\\in\\{1,\\dots,N\\},\n$$\nwe see that the vector field depends on the constants $N$, $\\omega$, $K$, $R$, and $\\alpha$. Without these, the ODE is not fully defined. Therefore, step (ii) must precede all others.\n\nSecond, an initial value problem requires an initial condition. One must assign phases $\\theta_{i}(0)$ for all $i$. Since the goal is to find a chimera state, one typically chooses a specially prepared non-uniform initial condition to bias the dynamics toward coexistence of coherent and incoherent groups. Thus step (iv) naturally follows after specifying the parameters in step (ii).\n\nThird, with the vector field $f$ and initial condition $\\theta(0)$ specified, one can numerically integrate the ODE forward in time using an appropriate method (for example, a Runge-Kutta scheme), which is step (i). This produces a trajectory $t\\mapsto\\theta(t)$.\n\nFourth, to observe the long-term behavior, one discards an initial transient interval to allow the trajectory to approach its attractor. Denote a transient time $T_{\\mathrm{trans}}$ and only consider data for $t\\geq T_{\\mathrm{trans}}$. This is step (v). This practice ensures that any initial-condition-induced short-time effects do not contaminate asymptotic diagnostics.\n\nFifth, one analyzes the post-transient dynamics to detect the chimera hallmark: coexistence of a synchronized subgroup and an incoherent subgroup. A standard diagnostic is the effective frequency of each oscillator, computed as a long-time average after the transient:\n$$\n\\Omega_{i}=\\lim_{T\\to\\infty}\\frac{\\theta_{i}(T_{\\mathrm{trans}}+T)-\\theta_{i}(T_{\\mathrm{trans}})}{T}.\n$$\nIn a chimera, there exists a subset of indices for which $\\Omega_{i}$ take an identical value (phase-locked group) and a complementary subset where $\\Omega_{i}$ are distributed over an interval (drifting group). This analysis corresponds to step (iii) and must come after integration and transient removal.\n\nPutting the logically necessary order together yields the sequence: specify parameters (ii) → set initial condition (iv) → integrate (i) → discard transients (v) → analyze for chimera (iii). Among the given options, this corresponds to option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "After successfully running a simulation, a key challenge is to objectively determine if a chimera state has emerged. One of its defining characteristics is the splitting of the oscillators into groups with distinct frequency behaviors. This practice  provides a hands-on method for analyzing the time-averaged frequencies from a simulation, introducing a statistical measure to help distinguish a true chimera state from a simple clustered or noisy state.",
            "id": "1666687",
            "problem": "In the study of complex systems, a chimera state is a peculiar spatiotemporal pattern observed in a network of identical coupled oscillators, where parts of the system exhibit synchronous behavior while others remain incoherent. Differentiating a true chimera state from other patterns, such as a noisy multi-cluster state, is a significant challenge in nonlinear dynamics.\n\nA researcher proposes a statistical measure called the Gap-to-Range Ratio (GRR) to quantify the degree of clustering in a one-dimensional dataset. The GRR, denoted by $\\mathcal{C}$, is computed from a set of $N$ data points as follows:\n1. Sort the data points $x_i$ to obtain an ordered sequence $x_{(1)} \\le x_{(2)} \\le \\dots \\le x_{(N)}$.\n2. Calculate the successive gaps between ordered points: $g_i = x_{(i+1)} - x_{(i)}$ for $i = 1, \\dots, N-1$.\n3. The GRR is defined as the ratio of the maximum gap to the mean gap. This can be expressed with the simplified formula:\n$$ \\mathcal{C} = \\frac{(N-1) \\max_{i}\\{g_i\\}}{x_{(N)} - x_{(1)}} $$\n\nThe researcher applies this metric to the time-averaged angular frequencies of $N=12$ oscillators observed in a numerical experiment. The recorded frequencies, in units of radians per second, are given by the set:\n$$ \\{3.14, 4.15, 3.12, 5.82, 3.19, 5.79, 3.09, 5.88, 3.15, 5.85, 3.11, 4.22\\} $$\n\nCalculate the value of the Gap-to-Range Ratio, $\\mathcal{C}$, for this dataset. Round your final answer to three significant figures.",
            "solution": "We are given $N=12$ data points and the Gap-to-Range Ratio definition\n$$\n\\mathcal{C}=\\frac{(N-1)\\max_{i}\\{g_{i}\\}}{x_{(N)}-x_{(1)}}, \\quad g_{i}=x_{(i+1)}-x_{(i)}.\n$$\nStep 1: Sort the data. The ordered values are\n$$\nx_{(1)}=3.09,\\ x_{(2)}=3.11,\\ x_{(3)}=3.12,\\ x_{(4)}=3.14,\\ x_{(5)}=3.15,\\ x_{(6)}=3.19,\\ x_{(7)}=4.15,\\ x_{(8)}=4.22,\\ x_{(9)}=5.79,\\ x_{(10)}=5.82,\\ x_{(11)}=5.85,\\ x_{(12)}=5.88.\n$$\nStep 2: Compute successive gaps $g_{i}=x_{(i+1)}-x_{(i)}$ for $i=1,\\dots,11$:\n$$\n\\begin{aligned}\n&g_{1}=3.11-3.09=0.02,\\quad g_{2}=3.12-3.11=0.01,\\quad g_{3}=3.14-3.12=0.02,\\\\\n&g_{4}=3.15-3.14=0.01,\\quad g_{5}=3.19-3.15=0.04,\\quad g_{6}=4.15-3.19=0.96,\\\\\n&g_{7}=4.22-4.15=0.07,\\quad g_{8}=5.79-4.22=1.57,\\quad g_{9}=5.82-5.79=0.03,\\\\\n&g_{10}=5.85-5.82=0.03,\\quad g_{11}=5.88-5.85=0.03.\n\\end{aligned}\n$$\nThus, $\\max_{i}\\{g_{i}\\}=1.57$.\n\nStep 3: Compute the range $x_{(N)}-x_{(1)}=5.88-3.09=2.79$.\n\nStep 4: Apply the formula with $N-1=11$:\n$$\n\\mathcal{C}=\\frac{11\\cdot 1.57}{2.79}=\\frac{17.27}{2.79}\\approx 6.19,\n$$\nwhere the final value is rounded to three significant figures.",
            "answer": "$$\\boxed{6.19}$$"
        },
        {
            "introduction": "Moving from manual analysis to automated detection is a critical step in modern computational science. This advanced practice  challenges you to build a complete algorithmic pipeline for identifying and validating chimera states. By generating synthetic data with a known ground truth and implementing a classification scheme based on the local Kuramoto order parameter, you will develop a robust tool for analyzing complex spatiotemporal patterns.",
            "id": "4268035",
            "problem": "Consider a ring network of $N$ phase oscillators with phases $\\theta_i \\in [0,2\\pi)$ in radians, indexed by $i \\in \\{0,1,\\dots,N-1\\}$ with periodic boundary conditions. A chimera state is a spatiotemporal pattern in which a subset of oscillators is phase-coherent while the complementary subset is phase-incoherent. Starting from foundational definitions, design and implement an algorithm that segments the ring into coherent and incoherent domains using thresholds on a local order parameter, and then validates the classifications against synthetic data with known ground-truth domains.\n\nThe foundational base for the derivation is the Kuramoto order parameter (KOP). For a given set of phases $\\{\\theta_j\\}$, the global KOP is defined by\n$$\nR = \\left| \\frac{1}{N} \\sum_{j=0}^{N-1} e^{\\mathrm{i} \\theta_j} \\right| ,\n$$\nwhich measures the overall phase coherence of the network. To perform spatial segmentation, define the local neighborhood $\\mathcal{N}_i$ of node $i$ as the set of indices\n$$\n\\mathcal{N}_i = \\{i-w, i-w+1, \\dots, i+w\\} \\ (\\text{taken modulo } N),\n$$\nwhere $w$ is a positive integer and the neighborhood size is $m = 2w+1$. The local KOP at node $i$ is then\n$$\nR_i = \\left| \\frac{1}{m} \\sum_{j \\in \\mathcal{N}_i} e^{\\mathrm{i} \\theta_j} \\right| .\n$$\nIn domains where phases are locally coherent, $R_i$ is close to $1$, whereas in incoherent regions with nearly uniform random phases, the average of unit complex numbers tends to cancel, making $R_i$ close to $0$ as $m$ grows.\n\nClassification rule. Given two thresholds $T_{\\text{coh}}$ and $T_{\\text{incoh}}$ satisfying $1 \\ge T_{\\text{coh}} \\ge T_{\\text{incoh}} \\ge 0$, classify each node $i$ as follows:\n- coherent if $R_i \\ge T_{\\text{coh}}$,\n- incoherent if $R_i \\le T_{\\text{incoh}}$,\n- indeterminate otherwise.\nThe angle unit throughout is radians.\n\nSynthetic data generation. Construct synthetic chimera snapshots with known ground truth labels as follows. Fix $N$, a coherent fraction $f \\in [0,1]$, a phase slope $k \\ge 0$ in radians per node, and noise levels $\\sigma_c \\ge 0$ and $\\sigma_u \\ge 0$ for coherent and incoherent domains, respectively. Let $C = \\lfloor f N \\rfloor$ be the size of the coherent domain, occupying indices $i = 0,1,\\dots,C-1$, and let the incoherent domain occupy indices $i = C,\\dots,N-1$. Draw a base phase $\\theta_0 \\sim \\mathrm{Uniform}(0,2\\pi)$. Generate phases by\n$$\n\\theta_i =\n\\begin{cases}\n\\theta_0 + k i + \\eta_i \\pmod{2\\pi}, & i \\in \\{0,\\dots,C-1\\},\\ \\eta_i \\sim \\mathcal{N}(0,\\sigma_c^2),\\\\\n\\phi_i + \\xi_i \\pmod{2\\pi}, & i \\in \\{C,\\dots,N-1\\},\\ \\phi_i \\sim \\mathrm{Uniform}(0,2\\pi),\\ \\xi_i \\sim \\mathcal{N}(0,\\sigma_u^2).\n\\end{cases}\n$$\nDefine the ground-truth label $y_i = 1$ if $i < C$ and $y_i = 0$ otherwise.\n\nValidation metrics. Let $\\hat{y}_i \\in \\{1,0,-1\\}$ be predicted labels for node $i$ based on the rule above, where $-1$ denotes indeterminate. Consider only covered nodes with $\\hat{y}_i \\ne -1$ to evaluate classification. Define the coverage fraction\n$$\n\\text{coverage} = \\frac{\\#\\{i : \\hat{y}_i \\ne -1\\}}{N} .\n$$\nOn the covered subset, define accuracy\n$$\n\\text{accuracy} = \n\\begin{cases}\n\\frac{\\#\\{i : \\hat{y}_i = y_i \\}}{\\#\\{i : \\hat{y}_i \\ne -1\\}}, & \\text{if } \\#\\{i : \\hat{y}_i \\ne -1\\} > 0,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nFor each class $c \\in \\{0,1\\}$ on the covered subset, define precision $\\text{Prec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FP}_c}$ and recall $\\text{Rec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FN}_c}$ with the conventions that divisions by zero yield a value of $0$. Define the class-wise $F_1$ score by\n$$\nF_{1,c} =\n\\begin{cases}\n\\frac{2 \\,\\text{Prec}_c \\,\\text{Rec}_c}{\\text{Prec}_c + \\text{Rec}_c}, & \\text{if } \\text{Prec}_c + \\text{Rec}_c > 0,\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nand the macro $F_1$ score by $F_1^{\\text{macro}} = \\tfrac{1}{2}(F_{1,0} + F_{1,1})$. If coverage is zero, set both accuracy and $F_1^{\\text{macro}}$ to $0$.\n\nAlgorithmic task. Implement:\n1. A generator for synthetic chimera snapshots as specified, with reproducible randomness given a seed.\n2. A computation of the local KOP $R_i$ for all $i$ using neighborhoods of half-width $w$ on the ring.\n3. A segmentation of nodes using thresholds $T_{\\text{coh}}$ and $T_{\\text{incoh}}$.\n4. A validation against ground truth using the coverage, accuracy, and macro $F_1$ metrics defined above, computed only on covered nodes.\n\nTest suite. Your program must evaluate the algorithm on the following parameter sets and return the metrics for each set in order. Angles are in radians, and neighborhoods use periodic indexing.\n- Case 1 (general mixed chimera, happy path): $N=128$, $w=4$ (so $m=9$), $T_{\\text{coh}}=0.92$, $T_{\\text{incoh}}=0.60$, $f=0.50$, $k=0.02$, $\\sigma_c=0.03$, $\\sigma_u=0.20$, seed $=1$.\n- Case 2 (fully coherent domain): $N=128$, $w=4$, $T_{\\text{coh}}=0.95$, $T_{\\text{incoh}}=0.50$, $f=1.00$, $k=0.01$, $\\sigma_c=0.02$, $\\sigma_u=0.20$ (unused but provided), seed $=2$.\n- Case 3 (high noise, likely indeterminacy): $N=128$, $w=6$ (so $m=13$), $T_{\\text{coh}}=0.90$, $T_{\\text{incoh}}=0.70$, $f=0.50$, $k=0.02$, $\\sigma_c=0.30$, $\\sigma_u=0.30$, seed $=3$.\n- Case 4 (single threshold boundary, no indeterminacy): $N=128$, $w=2$ (so $m=5$), $T_{\\text{coh}}=0.80$, $T_{\\text{incoh}}=0.80$, $f=0.30$, $k=0.03$, $\\sigma_c=0.05$, $\\sigma_u=0.40$, seed $=4$.\n\nFinal output format. Your program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each case’s result is the list $[\\text{accuracy},\\text{coverage},F_1^{\\text{macro}}]$. For example, the output must have the form\n$$\n\\big[ [a_1,c_1,f_1], [a_2,c_2,f_2], [a_3,c_3,f_3], [a_4,c_4,f_4] \\big],\n$$\nwith each $a_i$, $c_i$, and $f_i$ a real number.",
            "solution": "The problem requires the design and implementation of an algorithm to identify chimera states in a ring network of phase oscillators. This involves generating synthetic data with known ground-truth domains, calculating a local order parameter to classify nodes, and evaluating the classification performance using well-defined metrics. The approach is systematically constructed from foundational principles of network science and statistical analysis.\n\nThe solution proceeds in four stages: (1) generation of synthetic phase data representing a chimera state, (2) computation of the local Kuramoto order parameter for each oscillator, (3) classification of oscillators into coherent, incoherent, or indeterminate states based on this parameter, and (4) validation of the classification against the ground truth using specified performance metrics.\n\n**1. Synthetic Chimera State Generation**\n\nTo validate the classification algorithm, we first construct a synthetic snapshot of oscillator phases with known coherent and incoherent domains. The network consists of $N$ oscillators on a ring, indexed by $i \\in \\{0, 1, \\dots, N-1\\}$.\n\nThe ground-truth structure is defined by a coherent fraction $f \\in [0,1]$. A block of $C = \\lfloor f N \\rfloor$ oscillators, with indices $i \\in \\{0, 1, \\dots, C-1\\}$, forms the coherent domain (ground-truth label $y_i=1$). The remaining $N-C$ oscillators, with indices $i \\in \\{C, \\dots, N-1\\}$, form the incoherent domain (ground-truth label $y_i=0$).\n\nThe phases $\\theta_i \\in [0, 2\\pi)$ are generated as follows, using a reproducible pseudorandom number generator initialized with a given seed:\n\n-   **Coherent Domain ($i \\in \\{0, \\dots, C-1\\}$)**: The phases are designed to be strongly correlated. A single base phase $\\theta_{\\text{base}}$ is drawn from a uniform distribution, $\\theta_{\\text{base}} \\sim \\mathrm{Uniform}(0, 2\\pi)$. The phases of the coherent oscillators are then determined by a linear progression with a phase slope $k \\ge 0$ (in radians per node), plus a small amount of Gaussian noise. The phase for oscillator $i$ is given by:\n    $$\n    \\theta_i = (\\theta_{\\text{base}} + k i + \\eta_i) \\pmod{2\\pi}\n    $$\n    where the noise term $\\eta_i$ is drawn from a normal distribution with mean $0$ and variance $\\sigma_c^2$, i.e., $\\eta_i \\sim \\mathcal{N}(0, \\sigma_c^2)$. The small noise level $\\sigma_c$ ensures that the phases remain close to the deterministic sequence $\\theta_{\\text{base}} + ki$.\n\n-   **Incoherent Domain ($i \\in \\{C, \\dots, N-1\\}$)**: The phases are designed to be uncorrelated. For each oscillator $i$ in this domain, a new, independent phase $\\phi_i$ is drawn from the uniform distribution $\\mathrm{Uniform}(0, 2\\pi)$. An additional Gaussian noise term is also added. The phase for oscillator $i$ is:\n    $$\n    \\theta_i = (\\phi_i + \\xi_i) \\pmod{2\\pi}\n    $$\n    where the noise term $\\xi_i$ is drawn from a normal distribution $\\mathcal{N}(0, \\sigma_u^2)$. The combination of uniformly distributed base phases $\\phi_i$ and noise $\\xi_i$ results in a set of largely uncorrelated phases.\n\nThe modulo $2\\pi$ operation ensures all phases lie within the interval $[0, 2\\pi)$.\n\n**2. Local Coherence Measurement**\n\nTo distinguish between the coherent and incoherent regions spatially, we employ the local Kuramoto order parameter (KOP), $R_i$. This metric quantifies the degree of phase synchronization within a local neighborhood of each oscillator.\n\nThe neighborhood $\\mathcal{N}_i$ for oscillator $i$ is defined as the set of $m = 2w+1$ oscillators centered at $i$, where $w$ is the neighborhood half-width. Due to the ring topology, indices are taken modulo $N$:\n$$\n\\mathcal{N}_i = \\{ (i-w+j) \\pmod N \\mid j=0, 1, \\dots, 2w \\}\n$$\nThe local KOP, $R_i$, is the magnitude of the mean of the phasors $e^{\\mathrm{i}\\theta_j}$ for all oscillators $j$ in the neighborhood $\\mathcal{N}_i$:\n$$\nR_i = \\left| \\frac{1}{m} \\sum_{j \\in \\mathcal{N}_i} e^{\\mathrm{i} \\theta_j} \\right|\n$$\nConceptually, if the phases $\\theta_j$ in the neighborhood are nearly identical, the corresponding unit vectors on the complex plane will point in similar directions, and their average will have a magnitude $R_i$ close to $1$. Conversely, if the phases are uniformly distributed, the vectors will tend to cancel each other out, resulting in an average with magnitude $R_i$ close to $0$.\n\nComputationally, this calculation is performed for each oscillator $i$ by first converting the phase vector $\\boldsymbol{\\theta}$ to a vector of complex phasors $\\mathbf{z} = (e^{\\mathrm{i}\\theta_0}, \\dots, e^{\\mathrm{i}\\theta_{N-1}})$. Then, for each $i$, we sum the phasors corresponding to the indices in $\\mathcal{N}_i$, divide by the neighborhood size $m$, and take the absolute value. The periodic boundary condition is handled by wrapping indices as required.\n\n**3. Threshold-Based Segmentation**\n\nWith the local order parameter $R_i$ computed for every oscillator, we can classify each node. The classification rule uses two thresholds, $T_{\\text{coh}}$ and $T_{\\text{incoh}}$, which must satisfy $1 \\ge T_{\\text{coh}} \\ge T_{\\text{incoh}} \\ge 0$. The predicted label $\\hat{y}_i$ for each node $i$ is assigned as follows:\n\n-   If $R_i \\ge T_{\\text{coh}}$, the node is classified as **coherent** ($\\hat{y}_i = 1$).\n-   If $R_i \\le T_{\\text{incoh}}$, the node is classified as **incoherent** ($\\hat{y}_i = 0$).\n-   If $T_{\\text{incoh}} < R_i < T_{\\text{coh}}$, the node's state is **indeterminate** ($\\hat{y}_i = -1$).\n\nThis rule partitions the network into three sets: a set predicted to be coherent, a set predicted to be incoherent, and a set for which the classification is ambiguous. The gap between $T_{\\text{coh}}$ and $T_{\\text{incoh}}$ creates a buffer zone, reducing misclassifications for nodes with intermediate $R_i$ values, which often occur at the boundary between domains or in regions with high noise.\n\n**4. Quantitative Validation**\n\nThe final step is to evaluate the performance of the classification algorithm. The evaluation is performed only on the subset of nodes that were not classified as indeterminate (i.e., where $\\hat{y}_i \\in \\{0, 1\\}$).\n\nThe following metrics are computed:\n\n-   **Coverage**: The fraction of nodes that receive a definitive classification (coherent or incoherent).\n    $$\n    \\text{coverage} = \\frac{\\#\\{i : \\hat{y}_i \\ne -1\\}}{N}\n    $$\n-   **Accuracy**: Among the covered nodes, the fraction that are correctly classified.\n    $$\n    \\text{accuracy} = \\frac{\\#\\{i : \\hat{y}_i = y_i \\text{ and } \\hat{y}_i \\ne -1\\}}{\\#\\{i : \\hat{y}_i \\ne -1\\}}\n    $$\n    If coverage is $0$, accuracy is defined to be $0$.\n\n-   **Macro $F_1$ Score**: This metric provides a balanced measure of performance across both classes (coherent and incoherent). It is the average of the $F_1$ scores for each class. For each class $c \\in \\{0, 1\\}$, we calculate precision ($\\text{Prec}_c$) and recall ($\\text{Rec}_c$) on the covered subset.\n    -   True Positives ($\\text{TP}_c$): $\\#\\{i : \\hat{y}_i=c \\text{ and } y_i=c\\}$.\n    -   False Positives ($\\text{FP}_c$): $\\#\\{i : \\hat{y}_i=c \\text{ and } y_i \\ne c\\}$.\n    -   False Negatives ($\\text{FN}_c$): $\\#\\{i : \\hat{y}_i \\ne c \\text{ and } y_i=c \\text{ and } \\hat{y}_i \\ne -1\\}$.\n    \n    The precision and recall are then:\n    $$\n    \\text{Prec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FP}_c}, \\quad \\text{Rec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FN}_c}\n    $$\n    with divisions by zero yielding $0$. The $F_1$ score for class $c$ is the harmonic mean of precision and recall:\n    $$\n    F_{1,c} = \\frac{2 \\cdot \\text{Prec}_c \\cdot \\text{Rec}_c}{\\text{Prec}_c + \\text{Rec}_c}\n    $$\n    again with division by zero yielding $0$. Finally, the macro-averaged $F_1$ score is:\n    $$\n    F_1^{\\text{macro}} = \\frac{1}{2}(F_{1,0} + F_{1,1})\n    $$\n    If coverage is $0$, $F_1^{\\text{macro}}$ is also set to $0$.\n\nThese four steps constitute a complete pipeline for generating, analyzing, and validating a chimera state detection algorithm based on local phase coherence.",
            "answer": "[[1.0, 0.921875, 1.0], [1.0, 1.0, 1.0], [0.0, 0.0, 0.0], [1.0, 0.84375, 1.0]]"
        }
    ]
}