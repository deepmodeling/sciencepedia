{
    "hands_on_practices": [
        {
            "introduction": "This first exercise focuses on the two fundamental graph-theoretic conditions at the heart of Lin's theorem for structural controllability. By analyzing a simple three-node network, you will practice identifying whether a state is accessible from an input and detecting the presence of a \"dilation,\" a structural flaw that inherently prevents control. Mastering these core diagnostic checks  is essential for understanding why a network's structure might render it uncontrollable, regardless of the specific interaction strengths.",
            "id": "4305612",
            "problem": "Consider a Linear Time-Invariant (LTI) structured system specified by a system digraph on the vertex set of state nodes $\\{1,2,3\\}$ and a single input node $u$. The directed edges among state nodes are $1\\to 3$ and $2\\to 3$, and the input acts on node $1$, i.e., there is an input edge $u\\to 1$. Using the graph-theoretic conditions from Lin’s theorem for structural controllability, address the following:\n\n1. Determine whether the state node $2$ is accessible from the input node $u$. A state node is accessible if there exists a directed path from an input node to that state node in the system digraph.\n\n2. Determine whether a dilation exists. A dilation exists if there is a subset $S$ of state nodes such that the cardinality of the set of in-neighbors $\\mathcal{N}^{-}(S)$ (comprising all vertices with edges entering $S$, including both state and input vertices) satisfies $|\\mathcal{N}^{-}(S)|<|S|$.\n\nReport your results as a row matrix with two entries. Use the convention: the first entry is $1$ if node $2$ is accessible and $0$ otherwise; the second entry is $1$ if a dilation exists and $0$ otherwise. No rounding is required, and no physical units are involved.",
            "solution": "The problem asks us to analyze a given Linear Time-Invariant (LTI) structured system for two properties related to structural controllability, based on the graph-theoretic conditions of Lin’s theorem.\n\nThe system is defined by a system digraph. Let $V_x = \\{1, 2, 3\\}$ be the set of state nodes and $V_u = \\{u\\}$ be the set of input nodes. The total set of vertices in the digraph is $V = V_x \\cup V_u = \\{u, 1, 2, 3\\}$. The directed edges are given as $E = \\{(u, 1), (1, 3), (2, 3)\\}$. This corresponds to a system where input $u$ affects state $1$, state $1$ affects state $3$, and state $2$ affects state $3$.\n\nWe will address the two parts of the problem sequentially.\n\n**1. Accessibility of State Node $2$**\n\nThe problem defines a state node as accessible if there exists a directed path from an input node to that state node in the system digraph. In this system, the only input node is $u$. Therefore, we must determine if there is a directed path from node $u$ to node $2$.\n\nA directed path is a sequence of vertices $(v_0, v_1, \\dots, v_k)$ such that for each $i \\in \\{0, 1, \\dots, k-1\\}$, the directed edge $(v_i, v_{i+1})$ exists in the graph's edge set $E$. For node $2$ to be accessible, there must be a path with $v_0 = u$ and $v_k = 2$.\n\nLet's examine the structure of the digraph. The edges are $u \\to 1$, $1 \\to 3$, and $2 \\to 3$. The only node that can be reached from the input $u$ is node $1$, via the direct edge $(u, 1)$. From node $1$, we can only reach node $3$ via the edge $(1, 3)$. Thus, the only state nodes reachable from the input $u$ are $1$ and $3$, via the paths $(u, 1)$ and $(u, 1, 3)$, respectively.\n\nNode $2$ has no incoming edges from any other node in the graph; its in-degree is $0$. Therefore, it is impossible for any directed path to terminate at node $2$. Consequently, there is no directed path from the input node $u$ to the state node $2$.\n\nThus, the state node $2$ is not accessible. According to the problem's convention, the first entry of the result matrix is $0$.\n\n**2. Existence of a Dilation**\n\nA dilation is a structural property that obstructs controllability. The problem defines that a dilation exists if there is a non-empty subset of state nodes, $S \\subseteq V_x$, such that the cardinality of its set of in-neighbors, $\\mathcal{N}^{-}(S)$, is strictly less than the cardinality of $S$ itself, i.e., $|\\mathcal{N}^{-}(S)| < |S|$.\n\nThe set $\\mathcal{N}^{-}(S)$ is defined as the set of all vertices with edges entering $S$. In the context of Lin's theorem and structural controllability, this neighborhood set, often called the \"exclusive neighborhood\", comprises only vertices *outside* of $S$. We will adopt this standard, scientifically precise definition:\n$\\mathcal{N}^{-}(S) = \\{v \\in V \\setminus S \\mid \\exists s \\in S \\text{ such that } (v, s) \\in E\\}$.\n\nWe must check all non-empty subsets of the state set $V_x = \\{1, 2, 3\\}$ for this condition.\n\nLet's test the singleton subsets first.\n-   Consider the subset $S_1 = \\{1\\}$. The only edge entering $S_1$ is $(u, 1)$. The source vertex is $u$. Since $u \\notin S_1$, it is in the exclusive neighborhood. Thus, $\\mathcal{N}^{-}(S_1) = \\{u\\}$. We compare the cardinalities: $|\\mathcal{N}^{-}(S_1)| = 1$ and $|S_1| = 1$. The condition $|\\mathcal{N}^{-}(S_1)| < |S_1|$, or $1 < 1$, is false.\n\n-   Consider the subset $S_2 = \\{2\\}$. There are no edges in the digraph that terminate at node $2$. Therefore, the set of in-neighbors is empty: $\\mathcal{N}^{-}(S_2) = \\emptyset$. We compare the cardinalities: $|\\mathcal{N}^{-}(S_2)| = 0$ and $|S_2| = 1$. The condition $|\\mathcal{N}^{-}(S_2)| < |S_2|$, or $0 < 1$, is true.\n\nSince we have found a subset $S = \\{2\\}$ for which the condition holds, we can conclude that a dilation exists in the system. The existence of even one such set is sufficient.\n\nFor the sake of completeness, we can identify all such subsets.\n-   $S_3 = \\{3\\}$: In-neighbors are $\\{1, 2\\}$. $|\\mathcal{N}^{-}(S_3)|=2$, $|S_3|=1$. $2 < 1$ is false.\n-   $S_4 = \\{1, 2\\}$: The only edge from outside is $(u, 1)$. $\\mathcal{N}^{-}(S_4) = \\{u\\}$. $|\\mathcal{N}^{-}(S_4)|=1$, $|S_4|=2$. $1 < 2$ is true. This is also a dilation.\n-   $S_5 = \\{1, 3\\}$: In-neighbors from outside are $\\{u, 2\\}$. $\\mathcal{N}^{-}(S_5) = \\{u, 2\\}$. $|\\mathcal{N}^{-}(S_5)|=2$, $|S_5|=2$. $2 < 2$ is false.\n-   $S_6 = \\{2, 3\\}$: In-neighbor from outside is $\\{1\\}$. $\\mathcal{N}^{-}(S_6) = \\{1\\}$. $|\\mathcal{N}^{-}(S_6)|=1$, $|S_6|=2$. $1 < 2$ is true. This is also a dilation.\n-   $S_7 = \\{1, 2, 3\\}$: In-neighbor from outside is $\\{u\\}$. $\\mathcal{N}^{-}(S_7) = \\{u\\}$. $|\\mathcal{N}^{-}(S_7)|=1$, $|S_7|=3$. $1 < 3$ is true. This is also a dilation.\n\nA dilation exists. According to the problem's convention, the second entry of the result matrix is $1$.\n\n**Conclusion**\n\n-   Node $2$ is not accessible, so the first entry is $0$.\n-   A dilation exists (e.g., the set $S = \\{2\\}$), so the second entry is $1$.\n\nThe final result is to be reported as a row matrix $\\begin{pmatrix} 0 & 1 \\end{pmatrix}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the foundational diagnostic checks, this practice applies a full structural controllability analysis to a canonical network topology: a directed chain. You will not only verify controllability using graph-theoretic principles but also connect this to the algebraic perspective by examining the rank of the controllability matrix. This exercise  provides a complete workflow for confirming structural controllability and introduces the concept of the controllability index, which quantifies the time horizon needed to influence the entire system.",
            "id": "4305607",
            "problem": "Consider a structured linear time-invariant system with state vector $x \\in \\mathbb{R}^{4}$ governed by $\\dot{x} = A x + B u$, where the sparsity of the state matrix $A$ is specified by the directed chain graph $1 \\to 2 \\to 3 \\to 4$, and there is a single input applied to node $1$. The structural pattern is encoded by\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\na_{21} & 0 & 0 & 0 \\\\\n0 & a_{32} & 0 & 0 \\\\\n0 & 0 & a_{43} & 0\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\nb_{1} \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix},\n$$\nwhere $a_{21}, a_{32}, a_{43}, b_{1}$ are independent free parameters representing generically nonzero entries consistent with the graph, and all other entries are structurally zero.\n\nUsing the fundamental definitions of structural controllability and Lin's theorem for structured systems, determine whether the system is structurally controllable under this single-input placement. Then compute the structural controllability index, defined as the minimal positive integer $\\mu$ such that the generic rank of the controllability matrix formed by $\\{B, AB, \\dots, A^{\\mu-1}B\\}$ equals $4$. Also determine the minimal number of inputs $m$ needed to guarantee structural controllability for this directed chain graph under generic parameter values. Report your final answer as a row matrix $(m, \\mu)$ using the $\\mathrm{pmatrix}$ format. No rounding is required, and the answer must be expressed as exact integers.",
            "solution": "The problem asks for an analysis of the structural controllability of a given LTI system. We need to determine if the system is structurally controllable with the given single input, find the minimal number of inputs $m$ required for controllability for this graph, and compute the structural controllability index $\\mu$ for the specified input configuration.\n\nThe system is of order $N=4$ and is described by the structured matrices:\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\na_{21} & 0 & 0 & 0 \\\\\n0 & a_{32} & 0 & 0 \\\\\n0 & 0 & a_{43} & 0\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\nb_{1} \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n\n**1. Minimal Number of Inputs ($m$)**\n\nAccording to Lin's theorem, the minimum number of inputs $m$ required to make a network structurally controllable is given by $m = \\max(1, N - |M^*|)$, where $N$ is the number of state nodes and $|M^*|$ is the size of the maximum matching in the state graph $G(A)$.\n\nThe non-zero entries of $A$ ($a_{21}, a_{32}, a_{43}$) correspond to the directed edges $1 \\to 2$, $2 \\to 3$, and $3 \\to 4$ respectively (since an entry $A_{ij}$ denotes an edge from node $j$ to node $i$). The state graph is a directed chain: $1 \\to 2 \\to 3 \\to 4$.\n\nA matching is a set of edges where no two edges share a common start or end vertex. For this chain, the set of all edges $M = \\{(1,2), (2,3), (3,4)\\}$ is a valid matching. Since it includes all available edges, it is a maximum matching. The size is $|M^*|=3$.\n\nTherefore, the minimal number of inputs is:\n$$m = \\max(1, N - |M^*|) = \\max(1, 4 - 3) = \\max(1, 1) = 1.$$\nThis confirms that the network can be controlled with a single input.\n\n**2. Structural Controllability and Controllability Index ($\\mu$)**\n\nA structured LTI system is structurally controllable if the Kalman controllability matrix $\\mathcal{C} = [B, AB, \\dots, A^{N-1}B]$ has a generic rank of $N$. For this system, $N=4$, so we check the rank of $\\mathcal{C} = [B, AB, A^2B, A^3B]$.\n\nLet's compute the columns of $\\mathcal{C}$:\n- First column: $B = \\begin{pmatrix} b_1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n- Second column: $AB = \\begin{pmatrix} 0 \\\\ a_{21}b_1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n- Third column: $A^2B = A(AB) = \\begin{pmatrix} 0 \\\\ 0 \\\\ a_{32}a_{21}b_1 \\\\ 0 \\end{pmatrix}$\n- Fourth column: $A^3B = A(A^2B) = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ a_{43}a_{32}a_{21}b_1 \\end{pmatrix}$\n\nThe controllability matrix is:\n$$ \\mathcal{C} = \\begin{pmatrix}\nb_1 & 0 & 0 & 0 \\\\\n0 & a_{21}b_1 & 0 & 0 \\\\\n0 & 0 & a_{32}a_{21}b_1 & 0 \\\\\n0 & 0 & 0 & a_{43}a_{32}a_{21}b_1\n\\end{pmatrix} $$\nThe determinant is $\\det(\\mathcal{C}) = (b_1)(a_{21}b_1)(a_{32}a_{21}b_1)(a_{43}a_{32}a_{21}b_1) = a_{21}^3 a_{32}^2 a_{43} b_1^4$.\nSince all parameters are generically non-zero, this determinant is a non-zero polynomial. Thus, the generic rank of $\\mathcal{C}$ is 4, and the system is structurally controllable.\n\nThe structural controllability index $\\mu$ is the smallest integer such that the generic rank of $\\mathcal{C}_{\\mu} = [B, AB, \\dots, A^{\\mu-1}B]$ equals $N=4$.\n- The matrix $\\mathcal{C}_1 = [B]$ has generic rank 1.\n- The matrix $\\mathcal{C}_2 = [B, AB]$ has generic rank 2.\n- The matrix $\\mathcal{C}_3 = [B, AB, A^2B]$ has generic rank 3.\n- The matrix $\\mathcal{C}_4 = [B, AB, A^2B, A^3B]$ has generic rank 4.\nThe rank first reaches 4 when $\\mu=4$.\n\n**Conclusion**\nThe minimal number of inputs is $m=1$, and the structural controllability index for the given configuration is $\\mu=4$. The final answer is the row matrix $(m, \\mu)$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 1 & 4 \\end{pmatrix}} $$"
        },
        {
            "introduction": "This final practice explores the crucial distinction between structural (or generic) controllability and the controllability of a system with specific, fixed parameters. While a system's connection pattern may be structurally controllable, there can exist \"non-generic\" parameter values that cause a loss of control through precise cancellations. This problem challenges you to derive the exact algebraic condition that leads to such a failure , deepening your understanding of what \"structural\" truly implies and revealing the fragility of control under fine-tuned circumstances.",
            "id": "4305579",
            "problem": "Consider a Linear Time-Invariant (LTI) system with three state variables described by the state-space equation $\\dot{x} = A x + B u$, where $A \\in \\mathbb{R}^{3 \\times 3}$ and $B \\in \\mathbb{R}^{3 \\times 1}$. The structured pattern of $(A,B)$ is specified as follows. The matrix $A$ has free parameters at entries $(1,2)$, $(2,3)$, and $(3,1)$, and zeros elsewhere:\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & a & 0 \\\\\n0 & 0 & b \\\\\nc & 0 & 0\n\\end{pmatrix},\n$$\nand the input matrix $B$ has free parameters at entries $(1,1)$ and $(2,1)$, and zero at $(3,1)$:\n$$\nB \\;=\\;\n\\begin{pmatrix}\np \\\\\nq \\\\\n0\n\\end{pmatrix}.\n$$\nHere $a$, $b$, $c$, $p$, and $q$ are independent free parameters that may take any real values. This pattern is structurally controllable in the sense of Lin's theorem.\n\nStarting from core definitions of structural controllability and graph-theoretic conditions (no dilations and input reachability), and using the Kalman controllability matrix definition, construct a non-generic uncontrollable realization of this structurally controllable pattern by enforcing an explicit, nontrivial algebraic dependency among two or more of the free parameters (do not set any single parameter identically to zero). Your construction should exploit the fact that uncontrollability occurs on an algebraic variety of measure zero in parameter space.\n\nProvide, as your final output, a single simplified polynomial expression in the parameters $a$, $b$, $c$, $p$, and $q$ whose vanishing guarantees that the rank of the Kalman controllability matrix drops below $3$ for this pattern while respecting the given sparsity. Do not output an equation or inequality; output only the polynomial expression. No numerical rounding is required and no physical units are involved in the final expression.",
            "solution": "A Linear Time-Invariant (LTI) system described by the state-space equation $\\dot{x} = A x + B u$ is controllable if and only if the Kalman controllability matrix, $\\mathcal{C}$, has full rank. For the given system, the state vector $x$ is in $\\mathbb{R}^{3}$, so the state dimension is $n=3$. The controllability matrix must therefore have rank $3$. The system becomes uncontrollable if $\\text{rank}(\\mathcal{C}) < 3$.\n\nThe controllability matrix is defined as $\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}$. Since the system has $n=3$ states and $m=1$ input, $\\mathcal{C}$ is a $3 \\times 3$ square matrix. For a square matrix, having a rank less than its dimension is equivalent to its determinant being zero. Thus, the condition for uncontrollability is $\\det(\\mathcal{C}) = 0$.\n\nThe problem provides the structured matrices $A$ and $B$ as:\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & a & 0 \\\\\n0 & 0 & b \\\\\nc & 0 & 0\n\\end{pmatrix},\n\\quad\nB \\;=\\;\n\\begin{pmatrix}\np \\\\\nq \\\\\n0\n\\end{pmatrix}.\n$$\nWe proceed to construct the matrix $\\mathcal{C}$ by computing its constituent column vectors. The first column is the input matrix $B$ itself:\n$$\nB = \\begin{pmatrix} p \\\\ q \\\\ 0 \\end{pmatrix}.\n$$\nThe second column is the product $AB$:\n$$\nAB = \\begin{pmatrix} 0 & a & 0 \\\\ 0 & 0 & b \\\\ c & 0 & 0 \\end{pmatrix} \\begin{pmatrix} p \\\\ q \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot p + a \\cdot q + 0 \\cdot 0 \\\\ 0 \\cdot p + 0 \\cdot q + b \\cdot 0 \\\\ c \\cdot p + 0 \\cdot q + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} aq \\\\ 0 \\\\ cp \\end{pmatrix}.\n$$\nTo find the third column, $A^2B$, we first compute $A^2$:\n$$\nA^2 = A \\cdot A = \\begin{pmatrix} 0 & a & 0 \\\\ 0 & 0 & b \\\\ c & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & a & 0 \\\\ 0 & 0 & b \\\\ c & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & ab \\\\ bc & 0 & 0 \\\\ 0 & ac & 0 \\end{pmatrix}.\n$$\nNow we can compute $A^2B$:\n$$\nA^2B = \\begin{pmatrix} 0 & 0 & ab \\\\ bc & 0 & 0 \\\\ 0 & ac & 0 \\end{pmatrix} \\begin{pmatrix} p \\\\ q \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot p + 0 \\cdot q + ab \\cdot 0 \\\\ bc \\cdot p + 0 \\cdot q + 0 \\cdot 0 \\\\ 0 \\cdot p + ac \\cdot q + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ bcp \\\\ acq \\end{pmatrix}.\n$$\nCombining these columns, we form the controllability matrix $\\mathcal{C}$:\n$$\n\\mathcal{C} = \\begin{pmatrix}\np & aq & 0 \\\\\nq & 0 & bcp \\\\\n0 & cp & acq\n\\end{pmatrix}.\n$$\nThe system is uncontrollable if and only if $\\det(\\mathcal{C}) = 0$. We compute the determinant using cofactor expansion along the first row:\n$$\n\\det(\\mathcal{C}) = p \\begin{vmatrix} 0 & bcp \\\\ cp & acq \\end{vmatrix} - aq \\begin{vmatrix} q & bcp \\\\ 0 & acq \\end{vmatrix} + 0 \\begin{vmatrix} q & 0 \\\\ 0 & cp \\end{vmatrix}\n$$\n$$\n\\det(\\mathcal{C}) = p \\left( (0)(acq) - (bcp)(cp) \\right) - aq \\left( (q)(acq) - (bcp)(0) \\right) + 0\n$$\n$$\n\\det(\\mathcal{C}) = p(-b c^2 p^2) - aq(a c q^2)\n$$\n$$\n\\det(\\mathcal{C}) = -b c^2 p^3 - a^2 c q^3.\n$$\nThe condition for uncontrollability is $-b c^2 p^3 - a^2 c q^3 = 0$. We can factor this expression:\n$$\n-c(b c p^3 + a^2 q^3) = 0.\n$$\nThis equation is satisfied if either $c=0$ or $b c p^3 + a^2 q^3 = 0$.\n\nThe problem asks for a non-generic uncontrollable realization based on a nontrivial algebraic dependency, while respecting the given sparsity and not setting single parameters to zero. The condition $c=0$ corresponds to a change in the sparsity pattern of the matrix $A$, which would violate the instruction to \"respect the given sparsity\".\n\nThe second condition, $b c p^3 + a^2 q^3 = 0$, represents a non-trivial algebraic dependency among the system parameters. This identity can be satisfied for non-zero values of all parameters $a, b, c, p, q$. Its satisfaction leads to a loss of controllability due to a precise cancellation of terms, a phenomenon that occurs on an \"algebraic variety of measure zero in parameter space,\" as alluded to in the problem. This is the non-generic realization sought. The vanishing of the polynomial $b c p^3 + a^2 q^3$ is a sufficient condition to guarantee that $\\det(\\mathcal{C})=0$ and thus that the rank of $\\mathcal{C}$ drops below $3$.\n\nTherefore, the single simplified polynomial expression whose vanishing imposes the required nontrivial condition for uncontrollability is $b c p^3 + a^2 q^3$. We can neglect the overall sign as the condition is setting the expression to zero.",
            "answer": "$$\\boxed{b c p^{3} + a^{2} q^{3}}$$"
        }
    ]
}