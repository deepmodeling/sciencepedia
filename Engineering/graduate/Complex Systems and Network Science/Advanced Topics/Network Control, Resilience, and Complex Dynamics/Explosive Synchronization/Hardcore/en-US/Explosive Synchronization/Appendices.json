{
    "hands_on_practices": [
        {
            "introduction": "Before studying explosive synchronization, one must be able to measure it. This practice begins with the foundational skill of calculating the Kuramoto order parameter, $r$, from raw phase data. You will then apply this understanding to design a scientifically sound protocol for empirically revealing the characteristic hysteresis loop of an explosive transition. ",
            "id": "4276126",
            "problem": "Consider a network of $N$ phase oscillators whose macroscopic coherence is quantified by the complex Kuramoto order parameter defined by\n$$\nr e^{i \\psi} = \\frac{1}{N} \\sum_{j=1}^{N} e^{i \\theta_{j}},\n$$\nwhere $r \\in [0,1]$ is the magnitude of coherence and $\\psi \\in \\mathbb{R}$ is the mean phase. You are given an experimental snapshot of phases after equilibration at a fixed coupling $K=K^{\\star}$ during an upward (forward) continuation, in which the coupling is slowly increased from low to high values. The recorded phases (in radians) are\n$\\{ \\theta_{j} \\}_{j=1}^{10} = \\{ 0.02,\\ 0.05,\\ -0.03,\\ 0.04,\\ -0.01,\\ 0.00,\\ 3.10,\\ -3.12,\\ 3.08,\\ -3.09 \\}$,\nwith $N=10$. Starting from the fundamental definition of the order parameter, compute $r(K^{\\star})$ from this data. Round your numerical result to four significant figures.\n\nIn addition, design a scientifically sound quasi-static coupling sweep protocol to empirically reveal forward and backward thresholds associated with Explosive Synchronization (ES) in networks with positive degreeâ€“frequency correlation, justifying each design choice from first principles (e.g., dynamical equations, equilibria, and hysteresis in discontinuous transitions). Clearly state how the thresholds are operationally identified from the measured $r(K)$ curves. The angles must be treated in radians, and the final numerical answer for $r(K^{\\star})$ must be dimensionless.",
            "solution": "The problem consists of two parts. The first part requires the computation of the Kuramoto order parameter magnitude, $r$, from a given set of oscillator phases. The second part asks for the design of a scientifically sound experimental protocol to study Explosive Synchronization (ES).\n\n### Part 1: Computation of the Order Parameter $r(K^{\\star})$\n\nThe complex Kuramoto order parameter, $z$, is defined as the mean of the phasors representing the individual oscillators on the unit circle in the complex plane:\n$$z = r e^{i \\psi} = \\frac{1}{N} \\sum_{j=1}^{N} e^{i \\theta_{j}}$$\nwhere $N$ is the number of oscillators, $\\theta_j$ is the phase of the $j$-th oscillator, $r$ is the magnitude of the order parameter representing the level of phase coherence, and $\\psi$ is the average phase.\n\nThe magnitude $r$ is the modulus of the complex number $z$. We can express $z$ in Cartesian form using Euler's formula, $e^{i\\theta} = \\cos(\\theta) + i\\sin(\\theta)$:\n$$z = \\frac{1}{N} \\sum_{j=1}^{N} (\\cos(\\theta_j) + i\\sin(\\theta_j))$$\nSeparating the real and imaginary parts:\n$$z = \\left(\\frac{1}{N} \\sum_{j=1}^{N} \\cos(\\theta_j)\\right) + i \\left(\\frac{1}{N} \\sum_{j=1}^{N} \\sin(\\theta_j)\\right)$$\nLet $X = \\frac{1}{N} \\sum_{j=1}^{N} \\cos(\\theta_j)$ and $Y = \\frac{1}{N} \\sum_{j=1}^{N} \\sin(\\theta_j)$. Then $z = X + iY$. The magnitude $r$ is given by:\n$$r = |z| = \\sqrt{X^2 + Y^2}$$\nWe are given $N=10$ and the set of phases (in radians):\n$\\{ \\theta_{j} \\}_{j=1}^{10} = \\{ 0.02,\\ 0.05,\\ -0.03,\\ 0.04,\\ -0.01,\\ 0.00,\\ 3.10,\\ -3.12,\\ 3.08,\\ -3.09 \\}$\n\nFirst, we compute the sum of cosines:\n$$ \\sum_{j=1}^{10} \\cos(\\theta_j) = \\cos(0.02) + \\cos(0.05) + \\cos(-0.03) + \\cos(0.04) + \\cos(-0.01) + \\cos(0.00) + \\cos(3.10) + \\cos(-3.12) + \\cos(3.08) + \\cos(-3.09) $$\nSince $\\cos(-x) = \\cos(x)$, this is:\n$$ \\sum_{j=1}^{10} \\cos(\\theta_j) = \\cos(0.02) + \\cos(0.05) + \\cos(0.03) + \\cos(0.04) + \\cos(0.01) + \\cos(0) + \\cos(3.10) + \\cos(3.12) + \\cos(3.08) + \\cos(3.09) $$\nUsing a calculator for the values (in radians):\n$$ \\sum \\cos(\\theta_j) \\approx 0.999800 + 0.998750 + 0.999550 + 0.999200 + 0.999950 + 1.000000 - 0.999135 - 0.999712 - 0.998295 - 0.998715 \\approx 2.001393 $$\nSo, $X = \\frac{2.001393}{10} = 0.2001393$.\n\nNext, we compute the sum of sines:\n$$ \\sum_{j=1}^{10} \\sin(\\theta_j) = \\sin(0.02) + \\sin(0.05) + \\sin(-0.03) + \\sin(0.04) + \\sin(-0.01) + \\sin(0.00) + \\sin(3.10) + \\sin(-3.12) + \\sin(3.08) + \\sin(-3.09) $$\nSince $\\sin(-x) = -\\sin(x)$, this is:\n$$ \\sum_{j=1}^{10} \\sin(\\theta_j) = \\sin(0.02) + \\sin(0.05) - \\sin(0.03) + \\sin(0.04) - \\sin(0.01) + \\sin(0) + \\sin(3.10) - \\sin(3.12) + \\sin(3.08) - \\sin(3.09) $$\nUsing a calculator for the values (in radians):\n$$ \\sum \\sin(\\theta_j) \\approx 0.019999 + 0.049979 - 0.029996 + 0.039989 - 0.009999 + 0.000000 + 0.041581 - 0.023999 + 0.058374 - 0.050682 \\approx 0.095246 $$\nSo, $Y = \\frac{0.095246}{10} = 0.0095246$.\n\nNow, we compute $r$:\n$$ r = \\sqrt{(0.2001393)^2 + (0.0095246)^2} \\approx \\sqrt{0.04005574 + 0.00009072} = \\sqrt{0.04014646} \\approx 0.2003658 $$\nRounding the result to four significant figures, we obtain:\n$$ r(K^{\\star}) \\approx 0.2004 $$\nThe value is dimensionless, as required.\n\n### Part 2: Protocol Design for Investigating Explosive Synchronization\n\nExplosive Synchronization (ES) is characterized by a first-order (discontinuous) phase transition and an associated hysteresis loop in the order parameter $r$ as a function of the coupling strength $K$. The protocol must be designed to reveal these two features.\n\n**Protocol Design**\n\n1.  **System Preparation:**\n    - Construct a network of $N$ phase oscillators with a given topology (e.g., scale-free, which promotes ES).\n    - For each oscillator $j$, assign a natural frequency $\\omega_j$ and determine its network degree $k_j$.\n    - To induce ES, enforce a positive correlation between the magnitude of the natural frequencies and the degrees. A common implementation is to set $|\\omega_j|$ to be a monotonically increasing function of $k_j$, e.g., $|\\omega_j| = a k_j$ for some constant $a > 0$. The signs of $\\omega_j$ can be chosen randomly. This setup is crucial, as it is a primary mechanism for ES in oscillator networks.\n\n2.  **Forward (Upward) Coupling Sweep:**\n    - **Initialization:** Begin with the system in an incoherent state by setting the coupling strength to a very low value, $K_{start}$, where $K_{start} \\approx 0$. Initial phases $\\{\\theta_j\\}$ can be chosen randomly from $[0, 2\\pi)$.\n    - **Quasi-static Incrementation:** Increase the coupling strength $K$ in small, fixed steps, $\\Delta K$. The new coupling is $K \\leftarrow K + \\Delta K$. The step size $\\Delta K$ must be small enough to resolve the transition sharply.\n    - **Equilibration:** After each increment, numerically integrate the equations of motion (e.g., using a Runge-Kutta method) for a sufficiently long equilibration time, $T_{equil}$. This allows the system to relax to its new steady state corresponding to the updated coupling $K$.\n    - **Measurement:** Once the system has equilibrated, compute the time-averaged order parameter, $\\langle r \\rangle$, over a subsequent measurement window, $T_{meas}$. Store the pair $(K, \\langle r \\rangle)$.\n    - **Iteration:** Repeat the increment-equilibrate-measure cycle until a maximum coupling $K_{end}$ is reached, where the system is expected to be in a fully synchronized state ($\\langle r \\rangle \\approx 1$).\n\n3.  **Backward (Downward) Coupling Sweep:**\n    - **Initialization:** Starting from the synchronized state at $K = K_{end}$, begin the backward process.\n    - **Quasi-static Decrementation:** Decrease the coupling strength $K$ in the same small steps, $\\Delta K$: $K \\leftarrow K - \\Delta K$.\n    - **Equilibration and Measurement:** At each step, perform the same equilibration ($T_{equil}$) and measurement ($T_{meas}$) procedures as in the forward sweep. Store the pair $(K, \\langle r \\rangle)$.\n    - **Iteration:** Repeat this cycle until the coupling returns to the starting value $K_{start}$.\n\n**Justification from First Principles**\n\n- **Quasi-static Process:** Phase transitions are equilibrium phenomena. A quasi-static sweep (small $\\Delta K$, large $T_{equil}$) ensures that the system's trajectory in the $(K, r)$ plane remains close to the succession of equilibrium (or statistical steady) states. Near a transition point, systems exhibit \"critical slowing down,\" where relaxation times diverge. Therefore, $T_{equil}$ must be particularly long in the vicinity of the expected thresholds to obtain accurate results and avoid artificially shifting the transition points.\n\n- **Positive Degree-Frequency Correlation ($|\\omega_j| \\propto k_j$):** This is the core mechanism. In the standard Kuramoto model (uncorrelated $\\omega_j$ and $k_j$), synchronization emerges gradually as hubs (high-$k_j$ nodes) entrain their neighbors, leading to a continuous, second-order transition. With the positive correlation, hubs have the highest frequency detuning, making them the most resistant to synchronization. They remain desynchronized while smaller-degree nodes form a synchronized cluster. This suppresses the gradual growth of $r$. The system remains largely incoherent until the coupling $K$ is strong enough to overcome the large frequency mismatch of the hubs all at once. At a critical threshold $K_f$, the hubs are abruptly pulled into the synchronized cluster, causing a discontinuous jump in $r$.\n\n- **Hysteresis:** The jump to a high-$r$ state is irreversible over the same path. In the synchronized state (for $K > K_f$), the effective coupling felt by each oscillator is proportional to $Kr$. Because $r$ is now large, this feedback mechanism helps maintain synchrony even when $K$ is decreased below $K_f$. The synchronized state remains stable until $K$ is reduced to a much lower backward threshold, $K_b  K_f$, at which point the coupling term is no longer sufficient to contain the frequency dispersion, and the system abruptly desynchronizes, with $r$ dropping to a small value. This history dependence of the state creates a hysteresis loop. The region $K_b  K  K_f$ is a bistable region where both the incoherent and the synchronized states are stable attractors.\n\n**Operational Identification of Thresholds**\n\nFrom the data collected in the forward and backward sweeps, plot $\\langle r \\rangle$ versus $K$.\n- **Forward Threshold ($K_f$):** This is identified on the curve from the forward sweep. It is the value of $K$ at which the most abrupt increase in $\\langle r \\rangle$ occurs. Operationally, it is found by locating the maximum of the numerical derivative $d\\langle r \\rangle / dK$.\n- **Backward Threshold ($K_b$):** This is identified on the curve from the backward sweep. It is the value of $K$ at which the most abrupt decrease in $\\langle r \\rangle$ occurs. Operationally, it corresponds to the maximum negative value (or minimum) of the derivative $d\\langle r \\rangle / dK$.\n\nThe presence of a region where the forward and backward curves do not overlap, forming a loop ($K_f > K_b$), is the definitive empirical evidence of hysteresis and a first-order phase transition, confirming the phenomenon of Explosive Synchronization.",
            "answer": "$$\\boxed{0.2004}$$"
        },
        {
            "introduction": "A key feature of explosive synchronization is its path-dependent, hysteretic nature, which presents unique experimental challenges. This exercise requires you to think critically about experimental design, evaluating different protocols to distinguish genuine physical hysteresis from artifacts of finite-time measurements. This will sharpen your ability to design and interpret experiments on systems with first-order transitions. ",
            "id": "4276026",
            "problem": "Consider a network of $N$ phase oscillators with adjacency matrix $A_{ij}$, governed by the Kuramoto model\n$$\n\\dot{\\theta}_{i} = \\omega_{i} + \\frac{K}{N} \\sum_{j=1}^{N} A_{ij} \\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big),\n$$\nwhere $\\theta_{i}$ is the phase of oscillator $i$, $\\omega_{i}$ is its natural frequency, and $K$ is the global coupling strength. The macroscopic phase coherence is quantified by the complex order parameter\n$$\nr e^{\\mathrm{i}\\psi} = \\frac{1}{N} \\sum_{j=1}^{N} e^{\\mathrm{i}\\theta_{j}},\n$$\nwhere $r \\in [0,1]$ and $\\psi \\in \\mathbb{R}$. In heterogeneous networks with frequency-degree correlation, for example $\\omega_{i} = c\\,k_{i}$ with $k_{i} = \\sum_{j} A_{ij}$ the degree of node $i$ and $c > 0$ a constant, it is well known that the transition from incoherence ($r \\approx 0$) to macroscopic synchronization ($r \\approx r_{0} > 0$) can be discontinuous and exhibit hysteresis (explosive synchronization): upon increasing $K$ quasi-statically from $K=0$, the system remains on an incoherent stable branch until a saddle-node disappearance at a coupling $K_{c}^{\\mathrm{up}}$, where it jumps to the synchronized branch; when decreasing $K$ quasi-statically from a synchronized initial state, it remains on the synchronized stable branch down to a lower coupling $K_{c}^{\\mathrm{down}}$, with $K_{c}^{\\mathrm{down}}  K_{c}^{\\mathrm{up}}$.\n\nAn experiment aims to detect explosive synchronization by executing a finite-time protocol: the coupling $K(t)$ is ramped up linearly from $0$ to $K_{\\max}$ with rate $\\alpha_{\\mathrm{up}} = K_{\\max}/T_{\\mathrm{up}}$ over time $T_{\\mathrm{up}}$, then ramped down linearly back to $0$ with rate $\\alpha_{\\mathrm{down}} = K_{\\max}/T_{\\mathrm{down}}$ over time $T_{\\mathrm{down}}$. The observable is $r(t)$ measured at finite resolution and averaged over a window of duration $\\Delta t$ at each $K$.\n\nAssume that near any dynamically stable branch of fixed points $r^{*}(K)$, the macroscopic relaxation of $r$ to $r^{*}(K)$ can be approximated by linear response,\n$$\n\\dot{r}(t) \\approx -\\frac{1}{\\tau(K)}\\big(r(t) - r^{*}(K)\\big),\n$$\nwhere $\\tau(K)$ is the relaxation time, which may become large near loss of stability. Under the ramp $K(t)$, define the tracking error $e(t) = r(t) - r^{*}(K(t))$. Neglecting higher-order terms and assuming $r^{*}(K)$ varies smoothly on the stable branch, one obtains\n$$\n\\dot{e}(t) + \\frac{1}{\\tau\\big(K(t)\\big)}\\,e(t) \\approx -\\alpha\\,\\frac{\\mathrm{d} r^{*}}{\\mathrm{d} K}\\bigg|_{K=K(t)},\n$$\nwith $\\alpha$ denoting either $\\alpha_{\\mathrm{up}}$ or $\\alpha_{\\mathrm{down}}$ depending on sweep direction. After crossing a saddle-node at $K = K_{c}^{\\mathrm{up}}$ or $K = K_{c}^{\\mathrm{down}}$, the former branch loses stability, and the system requires a switching time of order $\\tau_{\\mathrm{switch}}$ to reach the other stable branch; consequently, the observed jump in $r(t)$ will occur at a coupling shifted by $\\delta K \\sim \\alpha\\,\\tau_{\\mathrm{switch}}$ from the quasi-static value. The experimentally observed hysteresis width is then $W_{\\mathrm{obs}} \\approx \\big(K_{c}^{\\mathrm{up}} + \\delta K_{\\mathrm{up}}\\big) - \\big(K_{c}^{\\mathrm{down}} + \\delta K_{\\mathrm{down}}\\big)$, where $\\delta K_{\\mathrm{up}} \\sim \\alpha_{\\mathrm{up}}\\,\\tau_{\\mathrm{sync}}$ and $\\delta K_{\\mathrm{down}} \\sim -\\alpha_{\\mathrm{down}}\\,\\tau_{\\mathrm{desync}}$, and $\\tau_{\\mathrm{sync}}$ and $\\tau_{\\mathrm{desync}}$ are characteristic switching times near $K_{c}^{\\mathrm{up}}$ and $K_{c}^{\\mathrm{down}}$, respectively.\n\nConsidering the path dependence inherent to explosive synchronization and the finite ramp rates, which of the following protocol designs best ensures that the experiment detects genuine hysteresis (and thus explosive synchronization) rather than artifacts of finite-time dynamics or initial-condition bias?\n\nA. Choose ramp rates satisfying $\\alpha_{\\mathrm{up}}\\,\\tau_{\\mathrm{sync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$ and $\\alpha_{\\mathrm{down}}\\,\\tau_{\\mathrm{desync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$, prepare the up-sweep from an incoherent initial state and the down-sweep from a synchronized initial state, and at each $K$ dwell for a time $t_{\\mathrm{wait}}$ with $t_{\\mathrm{wait}} \\gg \\max_{K} \\tau(K)$ before measuring $r$ over a window $\\Delta t$ satisfying $\\tau(K) \\lesssim \\Delta t \\ll T_{\\mathrm{up}},T_{\\mathrm{down}}$.\n\nB. Use very fast ramps with $\\alpha_{\\mathrm{up}},\\alpha_{\\mathrm{down}} \\gg \\big(K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}\\big)/\\tau_{\\max}$, where $\\tau_{\\max} = \\max_{K} \\tau(K)$, so that dynamic lag enhances the jump size in $r(t)$ and makes hysteresis easier to observe even from a single incoherent initial condition.\n\nC. Suppress path dependence by starting both the up-sweep and down-sweep from identical incoherent phase configurations, and choose a short measurement window $\\Delta t \\ll \\min_{K} \\tau(K)$ to avoid averaging out rapid changes in $r(t)$.\n\nD. Reduce the system size to small $N$ to limit metastability and fluctuations; with smaller $N$, the hysteresis loop narrows and explosive synchronization becomes more robustly detectable regardless of ramp rate and initial conditions.",
            "solution": "### Step 1: Extract Givens\nThe problem statement provides the following information:\n- **System Model:** A network of $N$ oscillators governed by the Kuramoto model:\n$$\n\\dot{\\theta}_{i} = \\omega_{i} + \\frac{K}{N} \\sum_{j=1}^{N} A_{ij} \\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big)\n$$\n- **Variables:** $\\theta_i$ (phase), $\\omega_i$ (natural frequency), $K$ (coupling strength), $A_{ij}$ (adjacency matrix).\n- **Order Parameter:** $r e^{\\mathrm{i}\\psi} = \\frac{1}{N} \\sum_{j=1}^{N} e^{\\mathrm{i}\\theta_{j}}$, with $r$ quantifying macroscopic coherence.\n- **Phenomenon:** Explosive synchronization, characterized by a discontinuous transition and hysteresis, occurs in heterogeneous networks with frequency-degree correlation, such as $\\omega_{i} = c\\,k_{i}$.\n- **Hysteresis Loop:** In the quasi-static limit (infinitely slow change of $K$), the system transitions up to the synchronized branch at $K_{c}^{\\mathrm{up}}$ and transitions down to the incoherent branch at $K_{c}^{\\mathrm{down}}$, with $K_{c}^{\\mathrm{down}}  K_{c}^{\\mathrm{up}}$. The width of the intrinsic hysteresis loop is $W = K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$.\n- **Experimental Protocol:** The coupling $K$ is varied with time, $K(t)$, using a linear ramp up (rate $\\alpha_{\\mathrm{up}}$) and a linear ramp down (rate $\\alpha_{\\mathrm{down}}$).\n- **Dynamic Effects:**\n    - The relaxation of the order parameter $r(t)$ towards a stable fixed point $r^*(K)$ is approximated by $\\dot{r}(t) \\approx -\\frac{1}{\\tau(K)}\\big(r(t) - r^{*}(K)\\big)$, where $\\tau(K)$ is the relaxation time.\n    - A finite ramp rate $\\alpha$ introduces a tracking error $e(t) = r(t) - r^{*}(K(t))$.\n    - The observed transition points are shifted from the quasi-static values by an amount $\\delta K \\sim \\alpha\\,\\tau_{\\mathrm{switch}}$, where $\\tau_{\\mathrm{switch}}$ is a characteristic switching time.\n    - Specifically, $\\delta K_{\\mathrm{up}} \\sim \\alpha_{\\mathrm{up}}\\,\\tau_{\\mathrm{sync}}$ and $\\delta K_{\\mathrm{down}} \\sim -\\alpha_{\\mathrm{down}}\\,\\tau_{\\mathrm{desync}}$.\n    - The experimentally observed hysteresis width is $W_{\\mathrm{obs}} \\approx \\big(K_{c}^{\\mathrm{up}} + \\delta K_{\\mathrm{up}}\\big) - \\big(K_{c}^{\\mathrm{down}} + \\delta K_{\\mathrm{down}}\\big)$.\n- **Objective:** The question asks for the protocol design that best ensures the detection of *genuine* hysteresis, while avoiding artifacts from finite-time dynamics or biased initial conditions.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem is firmly grounded in the established theory of complex systems and nonlinear dynamics. The Kuramoto model is a canonical model for synchronization. Explosive synchronization and its connection to frequency-degree correlations are well-documented phenomena. The analysis of dynamic bifurcations, including the lag effect of finite ramp rates ($\\delta K \\sim \\alpha \\tau$), is a standard topic in the study of non-equilibrium systems. The provided information is scientifically sound and factually correct within its domain.\n- **Well-Posedness:** The problem is well-posed. It presents a clear physical scenario and a well-defined objective: to identify the experimental protocol that faithfully measures the intrinsic properties of the system by minimizing measurement-induced artifacts. The provided options represent distinct and physically meaningful strategies that can be evaluated against this objective.\n- **Objectivity:** The problem is stated in precise, objective, and technical language. The term \"best\" is not subjective but refers to the protocol that most accurately reflects the underlying physical reality of \"genuine hysteresis,\" as opposed to \"artifacts of finite-time dynamics,\" a clear and objective distinction.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It presents a valid and non-trivial question in the context of experimental and numerical studies of systems with phase transitions and hysteresis. Therefore, the problem is **valid**. We proceed to the solution.\n\n### Principle-Based Derivation\nThe primary goal is to design a protocol that measures the intrinsic, quasi-static properties of the system, specifically the hysteresis loop defined by the true critical points $K_{c}^{\\mathrm{up}}$ and $K_{c}^{\\mathrm{down}}$. This means minimizing artifacts that could distort the measurement of this loop. The problem statement itself identifies the main sources of such artifacts.\n\n1.  **Artifacts from Finite Ramp Rate:** The problem states that a finite ramp rate $\\alpha$ causes the observed transition points to shift by $\\delta K \\sim \\alpha \\tau_{\\mathrm{switch}}$. The observed hysteresis width becomes $W_{\\mathrm{obs}} \\approx (K_{c}^{\\mathrm{up}}+\\delta K_{\\mathrm{up}}) - (K_{c}^{\\mathrm{down}}+\\delta K_{\\mathrm{down}})$. To ensure $W_{\\mathrm{obs}} \\approx W = K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$, the shifts $\\delta K_{\\mathrm{up}}$ and $|\\delta K_{\\mathrm{down}}|$ must be negligible compared to the intrinsic width $W$. This leads to the conditions:\n    $$\n    \\alpha_{\\mathrm{up}}\\,\\tau_{\\mathrm{sync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}\n    $$\n    $$\n    \\alpha_{\\mathrm{down}}\\,\\tau_{\\mathrm{desync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}\n    $$\n    These conditions imply that the ramp rates $\\alpha_{\\mathrm{up}}$ and $\\alpha_{\\mathrm{down}}$ must be very small. This is the essence of a **quasi-static** process.\n\n2.  **Artifacts from Initial Conditions (Path Dependence):** Hysteresis is, by definition, a path-dependent phenomenon. Within the bistable region ($K \\in (K_{c}^{\\mathrm{down}}, K_{c}^{\\mathrm{up}})$), there exist two stable states: an incoherent one (low $r$) and a synchronized one (high $r$). To trace the entire hysteresis loop, one must separately probe both stable branches.\n    - To map the lower branch, which extends from $K=0$ up to the jump at $K_{c}^{\\mathrm{up}}$, the experiment (the \"up-sweep\") must start from an initial condition that lies on this branch, i.e., an **incoherent state** ($r \\approx 0$).\n    - To map the upper branch, which extends from high $K$ down to the jump at $K_{c}^{\\mathrm{down}}$, the experiment (the \"down-sweep\") must start from an initial condition on that branch, i.e., a **synchronized state** ($r \\approx 1$).\n    Attempting to \"suppress\" this path dependence is a conceptual error; it would mean failing to measure the hysteresis itself.\n\n3.  **Artifacts from Measurement Dwell Time:** At any given value of $K(t)$, the system's state $r(t)$ will relax towards the corresponding equilibrium state $r^*(K(t))$ on a timescale $\\tau(K)$. To measure the equilibrium value $r^*(K)$, one must wait for a time significantly longer than the relaxation time. This is particularly important near the bifurcation points, where relaxation can be very slow (critical slowing down, meaning $\\tau(K)$ diverges). Thus, the time spent measuring at each $K$, let's call it $t_{\\mathrm{wait}}$, must satisfy $t_{\\mathrm{wait}} \\gg \\max_{K} \\tau(K)$.\n\nCombining these three points, the ideal protocol must involve: (i) very slow ramps, (ii) carefully prepared initial states for the up- and down-sweeps to correctly trace the two branches, and (iii) sufficient waiting time at each measurement point to allow for relaxation to equilibrium.\n\n### Option-by-Option Analysis\n\n**A. Choose ramp rates satisfying $\\alpha_{\\mathrm{up}}\\,\\tau_{\\mathrm{sync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$ and $\\alpha_{\\mathrm{down}}\\,\\tau_{\\mathrm{desync}} \\ll K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}$, prepare the up-sweep from an incoherent initial state and the down-sweep from a synchronized initial state, and at each $K$ dwell for a time $t_{\\mathrm{wait}}$ with $t_{\\mathrm{wait}} \\gg \\max_{K} \\tau(K)$ before measuring $r$ over a window $\\Delta t$ satisfying $\\tau(K) \\lesssim \\Delta t \\ll T_{\\mathrm{up}},T_{\\mathrm{down}}$.**\n- This option perfectly aligns with all the requirements derived above.\n- The condition on ramp rates, $\\alpha \\tau \\ll W$, ensures a quasi-static measurement of the transition points.\n- The preparation of distinct initial states (incoherent for up-sweep, synchronized for down-sweep) is the correct way to probe the path-dependent nature of hysteresis.\n- The condition on dwell time, $t_{\\mathrm{wait}} \\gg \\max_{K} \\tau(K)$, ensures that measurements reflect equilibrium states, not transients.\n- The condition on the averaging window $\\Delta t$ is also physically sound.\nThis protocol is meticulously designed to measure the genuine hysteresis loop and avoid artifacts.\n**Verdict: Correct.**\n\n**B. Use very fast ramps with $\\alpha_{\\mathrm{up}},\\alpha_{\\mathrm{down}} \\gg \\big(K_{c}^{\\mathrm{up}} - K_{c}^{\\mathrm{down}}\\big)/\\tau_{\\max}$, where $\\tau_{\\max} = \\max_{K} \\tau(K)$, so that dynamic lag enhances the jump size in $r(t)$ and makes hysteresis easier to observe even from a single incoherent initial condition.**\n- This protocol advocates for very fast ramps, which is the direct opposite of the quasi-static condition. Such a protocol would measure a *dynamic hysteresis*, where the observed loop width $W_{\\mathrm{obs}}$ is dominated by rate-dependent effects ($\\delta K$), not the intrinsic properties ($K_{c}^{\\mathrm{up}}$, $K_{c}^{\\mathrm{down}}$). While a loop might be observed, it would be an artifact, precisely what the question asks to avoid.\n**Verdict: Incorrect.**\n\n**C. Suppress path dependence by starting both the up-sweep and down-sweep from identical incoherent phase configurations, and choose a short measurement window $\\Delta t \\ll \\min_{K} \\tau(K)$ to avoid averaging out rapid changes in $r(t)$.**\n- This protocol is fundamentally flawed. Starting the down-sweep from an incoherent state would cause the system to simply remain on the incoherent branch; the upper branch of the hysteresis loop would never be accessed, and thus no hysteresis would be observed. Hysteresis *is* path dependence, so \"suppressing\" it means failing to measure it.\n- Furthermore, using a measurement window $\\Delta t \\ll \\tau(K)$ means the measurement will capture non-equilibrium fluctuations and transient behavior rather than the stable property $r^*(K)$.\n**Verdict: Incorrect.**\n\n**D. Reduce the system size to small $N$ to limit metastability and fluctuations; with smaller $N$, the hysteresis loop narrows and explosive synchronization becomes more robustly detectable regardless of ramp rate and initial conditions.**\n- This misrepresents the role of system size in phase transitions. Explosive synchronization, as a first-order-like transition, is sharpest in the thermodynamic limit ($N \\to \\infty$). In small systems (small $N$), fluctuations are strong. These fluctuations can induce spontaneous transitions between the two metastable states, effectively smearing the sharp jumps and blurring the hysteresis loop. This makes the phenomenon *less* well-defined and harder to distinguish from a continuous transition, not \"more robustly detectable\". The claim that it becomes independent of ramp rate and initial conditions is also false; these considerations remain crucial.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating theory into a working model is a crucial skill in network science. This computational practice challenges you to implement a numerical solver for the self-consistency equations that govern explosive synchronization in the mean-field limit. Your task is to generate the synchronization diagram and computationally pinpoint the bistable region, thereby reproducing the phenomenon from first principles. ",
            "id": "4276050",
            "problem": "Consider the Kuramoto model of phase oscillators on an annealed complex network, where the phase $\\theta_i$ of node $i$ with degree $k_i$ and natural frequency $\\omega_i$ evolves according to the mean-field approximation: $\\frac{d\\theta_i}{dt} = \\omega_i - K k_i r \\sin(\\theta_i - \\psi)$, with $K$ the coupling strength, $r$ the macroscopic order parameter magnitude, and $\\psi$ the mean phase. In the stationary regime with constant $r$ and collective frequency $\\Omega = \\dot{\\psi}$, oscillators partition into locked components satisfying $|\\omega - \\Omega| \\le K k r$ and drifting components. The order parameter $r$ is defined through the annealed mean-field as $r = \\frac{1}{\\langle k \\rangle} \\int k \\cos(\\theta) \\, \\mathrm{d}\\mu$, where $\\langle k \\rangle$ is the mean degree, and the imaginary part condition enforces stationarity. Let the joint distribution of degrees and intrinsic frequencies be $P(k,\\omega) = P(k) \\delta(\\omega - \\alpha k - b)$, where $P(k)$ is the Probability Density Function (PDF) of degrees and $\\delta$ is the Dirac delta. Assume a truncated power-law degree PDF $P(k) = C k^{-\\gamma}$ for $k \\in [k_{\\min}, k_{\\max}]$, with normalization constant $C$ determined by $\\int_{k_{\\min}}^{k_{\\max}} P(k) \\, \\mathrm{d}k = 1$ and $\\langle k \\rangle = \\int_{k_{\\min}}^{k_{\\max}} k P(k) \\, \\mathrm{d}k$. The phenomenon of explosive synchronization arises when a strong positive correlation $\\omega \\propto k$ induces discontinuous transitions and hysteresis, leading to coexistence of multiple stationary solutions $(r,\\Omega)$ for the same coupling strength $K$.\n\nStarting from fundamental definitions and the locked/drifting partition, derive the stationary self-consistency requirements for the real and imaginary parts of the order parameter in the rotating frame. Use them to formulate numerical evaluation rules for $r(K)$ and $\\Omega(K)$ for the specified $P(k,\\omega)$. Implement a program that, for a given set of parameters, computes $r(K)$ as solutions to the self-consistency conditions across a range of $K$ values. Identify values of $K$ where more than one solution $(r,\\Omega)$ coexists. To robustly reveal coexistence, compute both the branch obtained by adiabatically increasing $K$ from low to high values and the branch obtained by adiabatically decreasing $K$ from high to low values, and compare their stationary solutions at identical $K$.\n\nYou must express all mathematical quantities in LaTeX in your derivation. Angles are dimensionless and must be treated in radians. No physical units apply. Your program should numerically evaluate the necessary integrals over $k$ using a discretized grid and must not rely on any external data.\n\nUse the following test suite of parameter sets. For each case, you will be given a list of coupling strengths $K$ in which to search for coexistence. For each case, output the list of those $K$ values (rounded to three decimal places) where both an increasing-$K$ branch and a decreasing-$K$ branch yield distinct nontrivial solutions for $r$.\n\n- Case 1 (anticipated explosive synchronization):\n  - Degree distribution exponent: $\\gamma = 2.6$\n  - Degree range: $k_{\\min} = 1.0$, $k_{\\max} = 100.0$\n  - Frequency-degree correlation: $\\alpha = 1.0$, $b = 0.0$\n  - Coupling strengths: $K \\in \\{0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1.00, 1.10, 1.20, 1.30, 1.40, 1.50, 1.60, 1.70, 1.80\\}$\n\n- Case 2 (weaker correlation, expected continuous onset):\n  - Degree distribution exponent: $\\gamma = 2.6$\n  - Degree range: $k_{\\min} = 1.0$, $k_{\\max} = 100.0$\n  - Frequency-degree correlation: $\\alpha = 0.2$, $b = 0.0$\n  - Coupling strengths: $K$ identical to Case 1\n\n- Case 3 (small coupling, expected no locking):\n  - Degree distribution exponent: $\\gamma = 2.6$\n  - Degree range: $k_{\\min} = 1.0$, $k_{\\max} = 100.0$\n  - Frequency-degree correlation: $\\alpha = 1.0$, $b = 0.0$\n  - Coupling strengths: $K \\in \\{0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10\\}$\n\nYour program must:\n- Derive and implement the stationary self-consistency conditions for $r$ and $\\Omega$ implied by the annealed mean-field and the locked set criterion $|\\omega - \\Omega| \\le K k r$ under $P(k,\\omega) = P(k) \\delta(\\omega - \\alpha k - b)$.\n- Use a numerical discretization of $k$ to evaluate the required integrals and solve for $(r,\\Omega)$ by fixed-point iteration or root-finding for each $K$ along both increasing and decreasing sequences.\n- Determine, for each case, the set of $K$ values where multiple solutions coexist, defined as having two distinct nontrivial solutions for $r(K)$ obtained from the two branches at the same $K$ (i.e., $|r_{\\uparrow}(K) - r_{\\downarrow}(K)|$ exceeds a small tolerance and both are greater than a small threshold).\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case reported as a list of the $K$ values with coexistence, rounded to three decimal places. For example, the output format must be exactly like: \"[[0.900,1.000],[...],[...]]\".",
            "solution": "We begin from the Kuramoto model on a network under the annealed mean-field approximation. The microscopic dynamics of oscillator $i$ is given by $\\frac{d\\theta_i}{dt} = \\omega_i + K \\sum_j A_{ij} \\sin(\\theta_j - \\theta_i)$, where $A_{ij}$ is the adjacency matrix, $K$ is the coupling strength, and $\\omega_i$ is the intrinsic frequency. Under the annealed mean-field approximation, the interaction term is replaced by its expected value for nodes of degree $k_i$, yielding $\\frac{d\\theta_i}{dt} = \\omega_i - K k_i r \\sin(\\theta_i - \\psi)$, where the order parameter $r e^{i\\psi} = \\frac{1}{\\langle k \\rangle} \\sum_j k_j e^{i\\theta_j}$, and $\\langle k \\rangle$ is the mean degree.\n\nIn a steady state, we move to a rotating frame with frequency $\\Omega = \\dot{\\psi}$, and consider $\\phi_i = \\theta_i - \\psi$. The dynamics becomes $\\frac{d\\phi_i}{dt} = \\omega_i - \\Omega - K k_i r \\sin \\phi_i$. Stationarity allows two classes: locked oscillators with $\\frac{d\\phi}{dt} = 0$ satisfying $|\\omega - \\Omega| \\le K k r$, and drifting oscillators with $|\\omega - \\Omega|  K k r$. For locked oscillators, the stationary phase satisfies $\\sin \\phi^* = \\frac{\\omega - \\Omega}{K k r}$ and contributes $\\cos \\phi^* = \\sqrt{1 - \\left(\\frac{\\omega - \\Omega}{K k r}\\right)^2}$ to the real part of the order parameter. For drifting oscillators, their phase distribution is generally nonuniform; however, in the standard annealed mean-field stationary treatment, the drifting contributions average to zero in the real part when symmetric around $\\Omega$, or are negligible under strong locking, and the imaginary part condition enforces balance for the locked set.\n\nFor a population described by the joint distribution $P(k,\\omega)$, the order parameter $r$ and the stationarity of the imaginary part are determined by integrals over the locked set. Let the locked set be $S = \\{(k,\\omega): |\\omega - \\Omega| \\le K k r\\}$. Then, using the definition $r = \\frac{1}{\\langle k \\rangle} \\int k \\cos \\phi^* \\, P(k,\\omega) \\,\\mathrm{d}k \\,\\mathrm{d}\\omega$, and enforcing that the imaginary part vanishes (equivalently, the average $\\sin \\phi^*$ weighted by $k$ is zero), we obtain the self-consistency conditions:\n$$\nr = \\frac{1}{\\langle k \\rangle} \\int\\!\\!\\int_{S} k \\, P(k,\\omega) \\, \\sqrt{1 - \\left(\\frac{\\omega - \\Omega}{K k r}\\right)^2} \\, \\mathrm{d}k \\, \\mathrm{d}\\omega,\n$$\n$$\n0 = \\int\\!\\!\\int_{S} k \\, P(k,\\omega) \\, \\frac{\\omega - \\Omega}{K k r} \\, \\mathrm{d}k \\, \\mathrm{d}\\omega.\n$$\nUnder the specified joint distribution $P(k,\\omega) = P(k) \\delta(\\omega - \\alpha k - b)$, these reduce by evaluating the $\\delta$-function, yielding one-dimensional integrals over $k$. Write $g(k;\\Omega) = \\alpha k + b - \\Omega$ and denote the locked indicator $I(k;r,\\Omega,K) = \\mathbf{1}(|g(k;\\Omega)| \\le K k r)$. The conditions become:\n$$\nr = \\frac{1}{\\langle k \\rangle} \\int_{k_{\\min}}^{k_{\\max}} k \\, P(k) \\, I(k;r,\\Omega,K) \\, \\sqrt{1 - \\left(\\frac{g(k;\\Omega)}{K k r}\\right)^2} \\, \\mathrm{d}k,\n$$\n$$\n0 = \\int_{k_{\\min}}^{k_{\\max}} k \\, P(k) \\, I(k;r,\\Omega,K) \\, \\frac{g(k;\\Omega)}{K k r} \\, \\mathrm{d}k.\n$$\nThe second condition simplifies by canceling $k$ in the numerator and denominator:\n$$\n0 = \\int_{k_{\\min}}^{k_{\\max}} P(k) \\, I(k;r,\\Omega,K) \\, (\\alpha k + b - \\Omega) \\, \\mathrm{d}k.\n$$\nDefine normalization and moments for the truncated power-law degree PDF $P(k) = C k^{-\\gamma}$ on $[k_{\\min}, k_{\\max}]$. The normalization constant $C$ and mean $\\langle k \\rangle$ are\n$$\nC = \\frac{\\gamma - 1}{k_{\\min}^{1-\\gamma} - k_{\\max}^{1-\\gamma}}, \\quad \\langle k \\rangle = \\int_{k_{\\min}}^{k_{\\max}} k P(k) \\, \\mathrm{d}k = C \\frac{k_{\\max}^{2 - \\gamma} - k_{\\min}^{2 - \\gamma}}{2 - \\gamma},\n$$\nfor $\\gamma \\neq 1, 2$, which holds in our test suite.\n\nGiven $K$, the pair $(r,\\Omega)$ is found by solving the coupled nonlinear equations above. Numerically, we discretize $k \\in [k_{\\min}, k_{\\max}]$ with a grid $\\{k_m\\}$ and approximate the integrals by Riemann sums or trapezoidal rule. For a given $(r,\\Omega)$, we compute $I_m = \\mathbf{1}(|g(k_m;\\Omega)| \\le K k_m r)$, then\n$$\nA(r,\\Omega,K) = \\sum_m P(k_m) I_m \\Delta k, \\quad B(r,\\Omega,K) = \\sum_m P(k_m) (\\alpha k_m + b) I_m \\Delta k,\n$$\nand the imaginary-part stationarity condition implies $\\Omega = \\frac{B}{A}$ when $A  0$. The real-part condition yields an update for $r$:\n$$\nr_{\\mathrm{rhs}}(r,\\Omega,K) = \\frac{1}{\\langle k \\rangle} \\sum_m k_m P(k_m) I_m \\sqrt{1 - \\left(\\frac{g(k_m;\\Omega)}{K k_m r}\\right)^2} \\, \\Delta k.\n$$\nWe employ a fixed-point scheme updating $\\Omega \\leftarrow B/A$ and $r \\leftarrow r_{\\mathrm{rhs}}$ with damping until convergence. To reveal possible coexistence of solutions (which signals explosive synchronization), we compute two branches:\n- The increasing-$K$ branch: initialize at small $K$ with a small $r$ and $\\Omega \\approx \\alpha \\langle k \\rangle + b$, then increment $K$ and solve at each step using the previous solution as a warm start.\n- The decreasing-$K$ branch: initialize at large $K$ with $r$ near one and $\\Omega \\approx \\alpha \\langle k \\rangle + b$, solve at each step using the previous solution as a warm start while decrementing $K$.\n\nAt each $K$ in the test set, we compare the solutions $(r_{\\uparrow}(K), \\Omega_{\\uparrow}(K))$ and $(r_{\\downarrow}(K), \\Omega_{\\downarrow}(K))$. If both $r_{\\uparrow}(K)$ and $r_{\\downarrow}(K)$ exceed a small threshold (e.g., $10^{-3}$) and $|r_{\\uparrow}(K) - r_{\\downarrow}(K)|$ exceeds a tolerance (e.g., $2 \\times 10^{-2}$), we declare coexistence for that $K$.\n\nAlgorithmic steps:\n- Construct a uniform grid over $k \\in [k_{\\min}, k_{\\max}]$, compute $P(k_m)$ and $\\langle k \\rangle$ analytically.\n- Implement functions to compute the locked indicator $I_m$, $A$, $B$, and $r_{\\mathrm{rhs}}$.\n- Solve the fixed-point equations for the branches with damping and convergence criteria for each $K$.\n- For each case, collect $K$ values exhibiting coexistence, round to three decimals, and output as a single line containing the three lists for the three cases.\n\nThis procedure tests different facets:\n- Case 1 probes hysteresis and coexistence under strong degree-frequency correlation ($\\alpha = 1.0$) with a heavy-tailed degree distribution ($\\gamma = 2.6$), typical for explosive synchronization.\n- Case 2 examines weakened correlation ($\\alpha = 0.2$), where the onset is expected to be continuous and coexistence absent, validating the algorithm's discrimination.\n- Case 3 tests low coupling strengths where the locked set is empty and $r \\approx 0$ for both branches, ensuring boundary condition handling with no coexistence.\n\nThe final program implements this numerical scheme and prints the required single-line output format: a list of three lists, each containing the $K$ values for the respective case where multiple solutions coexist.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef truncated_powerlaw_constants(kmin, kmax, gamma):\n    # Normalization constant C for P(k) = C k^{-gamma}\n    # and mean degree k; gamma != 1,2 in our test suite.\n    C = (gamma - 1.0) / (kmin**(1.0 - gamma) - kmax**(1.0 - gamma))\n    mean_k = C * (kmax**(2.0 - gamma) - kmin**(2.0 - gamma)) / (2.0 - gamma)\n    return C, mean_k\n\ndef make_k_grid(kmin, kmax, n_points):\n    k = np.linspace(kmin, kmax, n_points, dtype=float)\n    dk = (kmax - kmin) / (n_points - 1)\n    return k, dk\n\ndef degree_pdf(k, C, gamma):\n    return C * k**(-gamma)\n\ndef locked_indicator(k, alpha, b, Omega, K, r):\n    if r = 0.0 or K = 0.0:\n        return np.zeros_like(k, dtype=bool)\n    g = alpha * k + b - Omega\n    return np.abs(g) = (K * k * r + 1e-15)\n\ndef compute_A_B(k, Pk, alpha, b, Omega, K, r, dk, mask):\n    # A = \\int P(k) I dk ; B = \\int P(k) (\\alpha k + b) I dk\n    if not np.any(mask):\n        return 0.0, 0.0\n    Pk_mask = Pk[mask]\n    k_mask = k[mask]\n    A = np.sum(Pk_mask) * dk\n    B = np.sum(Pk_mask * (alpha * k_mask + b)) * dk\n    return A, B\n\ndef compute_r_rhs(k, Pk, alpha, b, Omega, K, r, dk, mask, mean_k):\n    if r = 0.0 or K = 0.0 or not np.any(mask):\n        return 0.0\n    k_mask = k[mask]\n    Pk_mask = Pk[mask]\n    g = alpha * k_mask + b - Omega\n    denom = K * k_mask * r\n    x = g / denom\n    # Numerical safety: clip inside [-1,1] for sqrt\n    x2 = x * x\n    comp = np.sqrt(np.maximum(0.0, 1.0 - x2))\n    integral = np.sum(k_mask * Pk_mask * comp) * dk\n    return integral / mean_k\n\ndef fixed_point_solve_kuramoto(k, dk, Pk, mean_k, alpha, b, K,\n                               r_init, Omega_init,\n                               max_iter=200, tol=1e-8, damping=0.6):\n    r = max(1e-8, min(0.999999, float(r_init)))\n    Omega = float(Omega_init)\n    # If K is zero, r=0 is the only solution\n    if K = 0.0:\n        return 0.0, Omega\n    for it in range(max_iter):\n        mask = locked_indicator(k, alpha, b, Omega, K, r)\n        A, B = compute_A_B(k, Pk, alpha, b, Omega, K, r, dk, mask)\n        if A  0.0:\n            Omega_new = B / A\n        else:\n            # If no locked oscillators, keep Omega near average alpha*k+b\n            Omega_new = Omega\n        r_rhs = compute_r_rhs(k, Pk, alpha, b, Omega_new, K, r, dk, mask, mean_k)\n        # Damped updates\n        r_new = (1.0 - damping) * r + damping * r_rhs\n        Omega = (1.0 - damping) * Omega + damping * Omega_new\n        # Clamp r into [0, 1]\n        r_new = float(np.clip(r_new, 0.0, 1.0))\n        # Check convergence\n        if abs(r_new - r)  tol and abs(Omega_new - Omega)  tol:\n            r = r_new\n            break\n        r = r_new\n    # Optional refinement via root solver to enforce both equations\n    # Define residuals: f1 = r - RHS, f2 = \\int P(k) I (alpha k + b - Omega) dk\n    def residuals(x):\n        r_x = float(np.clip(x[0], 0.0, 1.0))\n        Omega_x = float(x[1])\n        mask_x = locked_indicator(k, alpha, b, Omega_x, K, r_x)\n        A_x, B_x = compute_A_B(k, Pk, alpha, b, Omega_x, K, r_x, dk, mask_x)\n        f2 = B_x - Omega_x * A_x\n        rhs = compute_r_rhs(k, Pk, alpha, b, Omega_x, K, r_x, dk, mask_x, mean_k)\n        f1 = r_x - rhs\n        return np.array([f1, f2], dtype=float)\n    try:\n        sol = root(residuals, np.array([r, Omega], dtype=float), method='hybr')\n        if sol.success:\n            r_sol = float(np.clip(sol.x[0], 0.0, 1.0))\n            Omega_sol = float(sol.x[1])\n            # Validate solution: recompute mask; if no locked, set r=0\n            mask_val = locked_indicator(k, alpha, b, Omega_sol, K, r_sol)\n            if np.any(mask_val):\n                r, Omega = r_sol, Omega_sol\n            else:\n                r = 0.0\n        # else keep iterative solution\n    except Exception:\n        pass\n    return r, Omega\n\ndef compute_branches(params, K_values, n_k=5000):\n    gamma, kmin, kmax, alpha, b = params\n    C, mean_k = truncated_powerlaw_constants(kmin, kmax, gamma)\n    k, dk = make_k_grid(kmin, kmax, n_k)\n    Pk = degree_pdf(k, C, gamma)\n    # Initial Omega near alpha * k + b\n    Omega0 = alpha * mean_k + b\n    # Increasing-K branch\n    r_up = []\n    Omega_up = []\n    r_curr = 1e-6\n    Omega_curr = Omega0\n    for K in K_values:\n        r_sol, Omega_sol = fixed_point_solve_kuramoto(\n            k, dk, Pk, mean_k, alpha, b, K,\n            r_curr, Omega_curr\n        )\n        r_up.append(r_sol)\n        Omega_up.append(Omega_sol)\n        r_curr, Omega_curr = r_sol, Omega_sol\n    # Decreasing-K branch\n    r_down = [None] * len(K_values)\n    Omega_down = [None] * len(K_values)\n    # Start from largest K with high r initial guess\n    K_start = K_values[-1]\n    r_curr = 0.95\n    Omega_curr = Omega0\n    r_sol, Omega_sol = fixed_point_solve_kuramoto(\n        k, dk, Pk, mean_k, alpha, b, K_start,\n        r_curr, Omega_curr\n    )\n    r_curr, Omega_curr = r_sol, Omega_sol\n    r_down[-1] = r_sol\n    Omega_down[-1] = Omega_sol\n    for idx in range(len(K_values) - 2, -1, -1):\n        K = K_values[idx]\n        r_sol, Omega_sol = fixed_point_solve_kuramoto(\n            k, dk, Pk, mean_k, alpha, b, K,\n            r_curr, Omega_curr\n        )\n        r_down[idx] = r_sol\n        Omega_down[idx] = Omega_sol\n        r_curr, Omega_curr = r_sol, Omega_sol\n    return np.array(r_up), np.array(r_down), np.array(Omega_up), np.array(Omega_down)\n\ndef identify_coexistence(K_values, r_up, r_down, r_threshold=1e-3, diff_tol=2e-2):\n    coexist_K = []\n    for Ki, rup, rdown in zip(K_values, r_up, r_down):\n        if rup  r_threshold and rdown  r_threshold and abs(rup - rdown)  diff_tol:\n            coexist_K.append(Ki)\n    return coexist_K\n\ndef format_list_of_floats(lst):\n    return \"[\" + \",\".join(f\"{x:.3f}\" for x in lst) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    case1_params = (2.6, 1.0, 100.0, 1.0, 0.0)  # (gamma, kmin, kmax, alpha, b)\n    case2_params = (2.6, 1.0, 100.0, 0.2, 0.0)\n    case3_params = (2.6, 1.0, 100.0, 1.0, 0.0)\n\n    K_vals_case1 = np.array([\n        0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90,1.00,1.10,1.20,1.30,1.40,1.50,1.60,1.70,1.80\n    ], dtype=float)\n    K_vals_case2 = K_vals_case1.copy()\n    K_vals_case3 = np.array([0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10], dtype=float)\n\n    # Compute branches and identify coexistence\n    r_up1, r_down1, _, _ = compute_branches(case1_params, K_vals_case1, n_k=5000)\n    coexist1 = identify_coexistence(K_vals_case1, r_up1, r_down1)\n\n    r_up2, r_down2, _, _ = compute_branches(case2_params, K_vals_case2, n_k=5000)\n    coexist2 = identify_coexistence(K_vals_case2, r_up2, r_down2)\n\n    r_up3, r_down3, _, _ = compute_branches(case3_params, K_vals_case3, n_k=5000)\n    coexist3 = identify_coexistence(K_vals_case3, r_up3, r_down3)\n\n    results_str = \"[\" + \",\".join([\n        format_list_of_floats(coexist1),\n        format_list_of_floats(coexist2),\n        format_list_of_floats(coexist3)\n    ]) + \"]\"\n    # Final print statement in the exact required format.\n    print(results_str)\n\nsolve()\n```"
        }
    ]
}