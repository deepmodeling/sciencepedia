{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨*结构可观测性*（structural observability）的概念，该性质仅取决于网络的“布线图”，即节点间的连接关系，而与具体的动力学参数无关。我们将运用一种强大的图论工具——二分图中的最大匹配——来确定使一个系统实现结构可观测性所需的最小传感器数量。这种方法是为大型网络设计传感器布局的基础。",
            "id": "4293873",
            "problem": "考虑一个线性时不变 (LTI) 网络化动态系统，其状态向量为 $x \\in \\mathbb{R}^{6}$，动态特性为 $\\dot{x} = A x$。其中，系统矩阵 $A$ 的结构受一个顶点集为 $\\{1,2,3,4,5,6\\}$ 的有向无环图 (DAG) 的约束。该图具有有向边 $1 \\to 2$、$1 \\to 3$、$2 \\to 4$、$3 \\to 4$、$4 \\to 5$ 和 $4 \\to 6$。专用传感器被定义为直接测量单个状态分量的输出，即 $y = C x$，其中 $C$ 的每个非零行选择 $x$ 的一个坐标。\n\n从结构可观测性的基本定义以及与转置矩阵 $A^{\\top}$ 相关联的系统二分图的图论构造出发，解释为什么最大匹配中的未匹配顶点决定了使系统实现结构可观测性所需的专用传感器的数量。然后，构建由给定 DAG 导出的二分图，并使用最大匹配来计算确保系统结构可观测性所需的最小专用传感器数量。请以单个整数形式提供您的最终答案。",
            "solution": "该问题要求解释结构可观测性与二分图匹配之间的关系，然后计算给定网络化系统所需的最小专用传感器数量。\n\n首先，我们讨论理论基础。一个由 $\\dot{x} = Ax + Bu$ 和 $y=Cx$ 描述的线性时不变 (LTI) 系统，其可观测性分析由矩阵对 $(A, C)$ 定义。系统可观测的充分必要条件是可观测性矩阵 $\\mathcal{O}$ 具有满列秩，其中 $n$ 是状态空间的维度。可观测性矩阵由下式给出：\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\n一个等价的可观测性条件是 Popov-Belevitch-Hautus (PBH) 判据，该判据指出，系统可观测的充分必要条件是对于所有复数 $\\lambda \\in \\mathbb{C}$，矩阵\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\n的秩为 $n$。\n\n对于一个*结构化*系统，矩阵 $A$ 和 $C$ 的元素要么是固定的零，要么是独立的自由参数。结构可观测性要求对于这些自由参数的几乎所有数值，系统都是可观测的。这等价于结构化矩阵 $\\begin{pmatrix} A \\\\ C \\end{pmatrix}$ 的*泛型秩*等于 $n$ 的条件。\n\n结构化矩阵的泛型秩由其关联二分图中的最大匹配的大小决定。设系统有 $n$ 个状态和 $p$ 个输出。结构化矩阵 $M = \\begin{pmatrix} A \\\\ C \\end{pmatrix}$ 的维度为 $(n+p) \\times n$。我们可以构建一个二分图 $G_M = (V_{in}, V_{out}, E)$，其中输入顶点集 $V_{in} = \\{x_1, \\dots, x_n\\}$ 对应于 $M$ 的列，输出顶点集 $V_{out} = \\{\\dot{x}_1, \\dots, \\dot{x}_n, y_1, \\dots, y_p\\}$ 对应于 $M$ 的行。如果对应的元素 $M_{ij}$ 非零，则存在一条从顶点 $x_j \\in V_{in}$ 到顶点 $v_i \\in V_{out}$ 的边。$M$ 的泛型秩等于 $G_M$ 中最大匹配的大小，记为 $\\mu(G_M)$。因此，系统 $(A, C)$ 是结构可观测的，当且仅当 $\\mu(G_M) = n$。这意味着在最大匹配中，每个输入顶点 $x_j$ 都必须与某个输出顶点匹配。\n\n问题要求从没有传感器的系统开始，该系统由矩阵 $A$ 描述。我们可以为动态矩阵 $A$ 构建一个二分图 $G_A = (V_x, V_{\\dot{x}}, E_A)$，其中 $V_x = \\{x_1, \\dots, x_n\\}$ 且 $V_{\\dot{x}} = \\{\\dot{x}_1, \\dots, \\dot{x}_n\\}$。如果 $A_{ij}$ 是一个自由参数（非零），则存在一条边 $(x_j, \\dot{x}_i)$。设该图中最大匹配的大小为 $\\mu(G_A)$。根据定义，$\\mu(G_A) \\le n$。如果 $\\mu(G_A) < n$，则该系统在没有传感器的情况下不是结构可观测的。在最大匹配中，$V_x$ 中未匹配的顶点数量为 $n - \\mu(G_A)$。\n\n为了实现结构可观测性，我们必须添加传感器。在状态 $x_k$ 上的专用传感器对应一个输出 $y_k = x_k$。这会在输出矩阵 $C$ 中引入一个新行，该行在第 $k$ 列有一个唯一的非零元素。在二分图框架中，这增加了一个新的输出顶点 $y_k$ 和一条新的边 $(x_k, y_k)$。\n\n核心任务是添加最少数量的此类传感器边，以将匹配大小增加到 $n$。设 $M$ 是图 $G_A$ 中大小为 $\\mu(G_A)$ 的一个最大匹配。存在一个集合 $U \\subset V_x$，包含 $n - \\mu(G_A)$ 个未被 $M$ 匹配的顶点。如果我们在一个状态 $x_k$ 上放置一个专用传感器，其中 $x_k \\in U$，我们会引入一个新的输出顶点 $y_k$ 和一条新的边 $(x_k, y_k)$。由于 $x_k$ 是未匹配的，而 $y_k$ 是一个不属于 $M$ 中任何边的新顶点，因此边 $(x_k, y_k)$ 可以被添加到匹配中，形成一个新的大小为 $\\mu(G_A) + 1$ 的匹配 $M' = M \\cup \\{(x_k, y_k)\\}$。通过在每个 $n - \\mu(G_A)$ 个未匹配的输入顶点上放置一个专用传感器，我们可以将匹配大小增加到 $\\mu(G_A) + (n-\\mu(G_A)) = n$。由于每个传感器最多只能将匹配大小增加一，因此这是所需的最小传感器数量。\n因此，所需的最小专用传感器数量为 $N_{sensors} = n - \\mu(G_A)$。注意，问题中提到了转置矩阵 $A^{\\top}$。$A^{\\top}$ 的二分图与 $A$ 的图是同构的，因此最大匹配的大小是相同的。\n\n现在我们将此方法应用于给定的问题。\n该系统有 $n=6$ 个状态。其动态特性受一个有向无环图 (DAG) 的约束，该图具有边 $1 \\to 2$、$1 \\to 3$、$2 \\to 4$、$3 \\to 4$、$4 \\to 5$ 和 $4 \\to 6$。DAG 中的一条边 $j \\to i$ 意味着系统矩阵 $A$ 的元素 $A_{ij}$ 是非零的。术语 DAG 意味着没有有向环，包括自环，因此对角线元素 $A_{ii}$ 均为零。结构化矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n* & 0 & 0 & 0 & 0 & 0 \\\\\n* & 0 & 0 & 0 & 0 & 0 \\\\\n0 & * & * & 0 & 0 & 0 \\\\\n0 & 0 & 0 & * & 0 & 0 \\\\\n0 & 0 & 0 & * & 0 & 0\n\\end{pmatrix}\n$$\n其中 $*$ 代表一个非零元素。\n\n我们构建其关联的二分图 $G_A = (V_x, V_{\\dot{x}}, E_A)$，其中 $V_x=\\{x_1, \\dots, x_6\\}$ 且 $V_{\\dot{x}}=\\{\\dot{x}_1, \\dots, \\dot{x}_6\\}$。边 $(x_j, \\dot{x}_i)$ 对应于非零元素 $A_{ij}$：\n$E_A = \\{(x_1, \\dot{x}_2), (x_1, \\dot{x}_3), (x_2, \\dot{x}_4), (x_3, \\dot{x}_4), (x_4, \\dot{x}_5), (x_4, \\dot{x}_6)\\}$。\n\n我们的目标是找到最大匹配的大小，$\\mu(G_A)$。我们检查该图：\n输入顶点 $x_5$ 和 $x_6$ 没有出边，因此它们不能成为任何匹配的一部分。这直接意味着它们将是 $V_x$ 中的未匹配顶点。\n输入顶点 $x_2$ 和 $x_3$ 都只有一个可能的边目标：输出顶点 $\\dot{x}_4$。在任何匹配中，一个顶点最多只能使用一次。因此，边 $(x_2, \\dot{x}_4)$ 或 $(x_3, \\dot{x}_4)$ 中只有一条能存在于匹配中。这意味着输入顶点 $\\{x_2, x_3\\}$ 中至少有一个必须保持未匹配状态。\n\n基于此分析，我们在 $V_x$ 中至少有三个未匹配的顶点：两个来自 $\\{x_5, x_6\\}$，以及至少一个来自 $\\{x_2, x_3\\}$。\n未匹配顶点的总数至少为 $3$。这意味着最大匹配的大小最多为 $n - 3 = 6 - 3 = 3$。\n\n让我们构造一个大小为 $3$ 的匹配来确认这是最大大小。\n考虑边集 $M = \\{(x_1, \\dot{x}_2), (x_2, \\dot{x}_4), (x_4, \\dot{x}_5)\\}$。\n涉及的顶点是来自 $V_x$ 的 $\\{x_1, x_2, x_4\\}$ 和来自 $V_{\\dot{x}}$ 的 $\\{\\dot{x}_2, \\dot{x}_4, \\dot{x}_5\\}$。没有顶点被使用超过一次，因此这是一个有效的匹配。其大小为 $3$。\n另一个可能的最大匹配是 $M' = \\{(x_1, \\dot{x}_3), (x_3, \\dot{x}_4), (x_4, \\dot{x}_6)\\}$，其大小也为 $3$。\n既然我们找到了一个大小为 $3$ 的匹配，并且我们已经论证了不存在大小为 $4$ 或更大的匹配，那么最大匹配的大小就是 $\\mu(G_A) = 3$。\n\n实现结构可观测性所需的最小专用传感器数量由下式给出：\n$$\nN_{sensors} = n - \\mu(G_A)\n$$\n代入数值 $n=6$ 和 $\\mu(G_A)=3$：\n$$\nN_{sensors} = 6 - 3 = 3\n$$\n因此，需要 $3$ 个专用传感器。例如，在状态 $x_3$、$x_5$ 和 $x_6$ 上放置传感器将允许一个大小为 $6$ 的匹配：$\\{(x_1, \\dot{x}_2), (x_2, \\dot{x}_4), (x_4, \\dot{x}_5), (x_3, y_3), (x_5, y_5), (x_6, y_6)\\}$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在结构视角的基础上，本练习将考察动力学在具有不连通组件的网络上的行为。我们将分析一个扩散过程，其中传感器仅放置在一个组件中，并确定系统状态的哪些部分因此无法被追踪。这个问题突显了从状态到传感器的连通路径在状态空间模型的可观测性分析中扮演的关键角色。",
            "id": "4293879",
            "problem": "考虑一个具有两个不连通分量的无向、无权网络上的线性扩散过程。设状态向量为 $x(t) \\in \\mathbb{R}^{5}$，其动力学由线性时不变（LTI）系统 $\\dot{x}(t) = A x(t)$ 控制，其中 $A = -L$，$L$ 是图拉普拉斯矩阵。第一个分量是一个2节点路径图，其拉普拉斯矩阵为\n$$\nL_{1} = \\begin{pmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{pmatrix},\n$$\n第二个分量是一个3节点完全图（三角形），其拉普拉斯矩阵为\n$$\nL_{2} = \\begin{pmatrix}\n2 & -1 & -1 \\\\\n-1 & 2 & -1 \\\\\n-1 & -1 & 2\n\\end{pmatrix}.\n$$\n总的拉普拉斯矩阵是分块对角矩阵，\n$$\nL = \\begin{pmatrix}\nL_{1} & 0 \\\\\n0 & L_{2}\n\\end{pmatrix},\n$$\n因此 $A = -L$ 也是分块对角矩阵，其分块为 $A_{1} = -L_{1}$ 和 $A_{2} = -L_{2}$。假设输出是一个单一传感器，仅测量2节点分量中第一个节点的状态，即\n$$\ny(t) = C x(t), \\quad C = \\begin{pmatrix}1 & 0 & 0 & 0 & 0\\end{pmatrix}.\n$$\n从图扩散和线性系统可观测性的定义出发，并且不使用任何预先指定的快捷公式，确定系统对 $(A, C)$ 的不可观测子空间的维度。解释拉普拉斯矩阵的分块对角结构如何通过分离每个分量对测量输出的影响来决定这个维度。请以单个整数形式提供最终答案。无需四舍五入。",
            "solution": "线性时不变系统对 $(A, C)$ 的不可观测子空间是所有初始状态 $x(0)$ 的集合，这些初始状态使得对所有 $t \\geq 0$ 都有零输出 $y(t) = 0$。一个等价的描述是，不可观测子空间是可观测性矩阵 $\\mathcal{O}$ 的零空间。我们要求的就是这个子空间的维度。\n\n状态空间的维度为 $n=5$。系统对 $(A, C)$ 的可观测性矩阵 $\\mathcal{O}$ 构建如下：\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\\\ CA^4 \\end{pmatrix}\n$$\n不可观测子空间的维度由 $n - \\text{rank}(\\mathcal{O})$ 给出。\n\n该问题的结构，即分块对角的系统矩阵 $A$ 和相应的分块输出矩阵 $C$，使得我们可以进行更有洞察力的分析。根据网络分量对状态向量 $x(t)$ 进行分块：\n$$\nx(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}\n$$\n其中 $x_1(t) \\in \\mathbb{R}^2$ 对应于2节点路径图的状态，$x_2(t) \\in \\mathbb{R}^3$ 对应于3节点完全图的状态。\n\n系统动力学是解耦的：\n$$\n\\dot{x}_1(t) = A_1 x_1(t) \\quad \\text{其中} \\quad A_1 = -L_1 = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\n$$\n\\dot{x}_2(t) = A_2 x_2(t) \\quad \\text{其中} \\quad A_2 = -L_2 = \\begin{pmatrix} -2 & 1 & 1 \\\\ 1 & -2 & 1 \\\\ 1 & 1 & -2 \\end{pmatrix}\n$$\n输出方程也可以用这个分块来表示。设 $C = \\begin{pmatrix} C_1 & C_2 \\end{pmatrix}$，其中 $C_1 = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$ 且 $C_2 = \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}$。输出为：\n$$\ny(t) = C x(t) = \\begin{pmatrix} C_1 & C_2 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} = C_1 x_1(t) + C_2 x_2(t) = C_1 x_1(t)\n$$\n输出 $y(t)$ 完全依赖于第一个分量 $x_1(t)$ 的状态。第二个分量 $x_2(t)$ 的状态对测量没有直接或间接的影响。\n\n我们来正式分析不可观测状态 $x(0) = \\begin{pmatrix} x_1(0) \\\\ x_2(0) \\end{pmatrix}$。如果对于所有 $t \\ge 0$，输出 $y(t) = C e^{At} x(0)$ 恒等于零，则该状态是不可观测的。\n由于 $A$ 的分块结构，矩阵指数 $e^{At}$ 也是分块对角的：\n$$\ne^{At} = \\begin{pmatrix} e^{A_1 t} & 0 \\\\ 0 & e^{A_2 t} \\end{pmatrix}\n$$\n不可观测性的条件是：\n$$\ny(t) = \\begin{pmatrix} C_1 & C_2 \\end{pmatrix} \\begin{pmatrix} e^{A_1 t} & 0 \\\\ 0 & e^{A_2 t} \\end{pmatrix} \\begin{pmatrix} x_1(0) \\\\ x_2(0) \\end{pmatrix} = C_1 e^{A_1 t} x_1(0) + C_2 e^{A_2 t} x_2(0) = 0\n$$\n因为 $C_2$ 是零矩阵，这可以简化为：\n$$\nC_1 e^{A_1 t} x_1(0) = 0 \\quad \\text{对所有 } t \\ge 0\n$$\n这正是 $x_1(0)$ 是子系统 $(A_1, C_1)$ 的一个不可观测状态的条件。该条件对 $x_2(0)$ 没有任何约束。第二个分量的任何初始状态 $x_2(0) \\in \\mathbb{R}^3$，当与第一个分量的一个不可观测状态 $x_1(0)$ 配对时，将导致整个系统的一个不可观测状态。\n\n因此，整个系统的不可观测子空间 $\\mathcal{U}$ 是第一个分量的不可观测子空间 $\\mathcal{U}_1$ 与第二个分量的整个状态空间 $\\mathbb{R}^3$ 的直和：\n$$\n\\mathcal{U} = \\mathcal{U}_1 \\oplus \\mathbb{R}^3\n$$\n其维度为 $\\text{dim}(\\mathcal{U}) = \\text{dim}(\\mathcal{U}_1) + \\text{dim}(\\mathbb{R}^3) = \\text{dim}(\\mathcal{U}_1) + 3$。\n\n我们现在通过分析子系统 $(A_1, C_1)$ 来确定 $\\text{dim}(\\mathcal{U}_1)$。状态维度为 $n_1=2$。可观测性矩阵为：\n$$\n\\mathcal{O}_1 = \\begin{pmatrix} C_1 \\\\ C_1 A_1 \\end{pmatrix}\n$$\n我们有 $C_1 = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$ 和 $A_1 = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}$。\n第二行是：\n$$\nC_1 A_1 = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 \\end{pmatrix}\n$$\n所以，第一个子系统的可观测性矩阵是：\n$$\n\\mathcal{O}_1 = \\begin{pmatrix} 1 & 0 \\\\ -1 & 1 \\end{pmatrix}\n$$\n$\\mathcal{O}_1$ 的秩可以通过计算其行列式得到：$\\det(\\mathcal{O}_1) = (1)(1) - (0)(-1) = 1 \\ne 0$。由于行列式不为零，该矩阵具有满秩，$\\text{rank}(\\mathcal{O}_1) = 2$。\n第一个分量的不可观测子空间的维度是：\n$$\n\\text{dim}(\\mathcal{U}_1) = n_1 - \\text{rank}(\\mathcal{O}_1) = 2 - 2 = 0\n$$\n这意味着第一个子系统是完全可观测的，其不可观测子空间是平凡子空间 $\\{\\mathbf{0}\\}$。\n\n将此结果代回到总不可观测子空间维度的表达式中：\n$$\n\\text{dim}(\\mathcal{U}) = \\text{dim}(\\mathcal{U}_1) + 3 = 0 + 3 = 3\n$$\n\n这个结果可以通过为 $5 \\times 5$ 系统构建完整的可观测性矩阵 $\\mathcal{O}$ 来验证。$\\mathcal{O}$ 的行是 $CA^k$，其中 $k=0, \\dots, 4$。\n由于 $A = \\begin{pmatrix} A_1 & 0 \\\\ 0 & A_2 \\end{pmatrix}$ 和 $C = \\begin{pmatrix} C_1 & 0 \\end{pmatrix}$，我们有 $CA^k = \\begin{pmatrix} C_1 A_1^k & 0 \\end{pmatrix}$。\n因此，$\\mathcal{O}$ 的行是：\n$C = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} -1 & 1 & 0 & 0 & 0 \\end{pmatrix}$\n$A_1^2 = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}^2 = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix} = -2 A_1$。因此，$CA^2 = -2(CA) = \\begin{pmatrix} 2 & -2 & 0 & 0 & 0 \\end{pmatrix}$。所有后续的行 $CA^k$ 都将是 $CA$ 的标量倍数，因此是线性相关的。\n可观测性矩阵是：\n$$\n\\mathcal{O} = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\\\ -1 & 1 & 0 & 0 & 0 \\\\ 2 & -2 & 0 & 0 & 0 \\\\ -4 & 4 & 0 & 0 & 0 \\\\ 8 & -8 & 0 & 0 & 0 \\end{pmatrix}\n$$\n前两行是线性无关的。所有其他行都是第二行的标量倍数。因此，$\\mathcal{O}$ 的秩为 $2$。\n不可观测子空间的维度是 $n - \\text{rank}(\\mathcal{O}) = 5 - 2 = 3$。该子空间由形式为 $(0, 0, v_3, v_4, v_5)^T$ 的向量组成，这恰好对应于未被测量的第二个分量的状态空间。\n不可观测子空间的维度是 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "许多现实世界网络，从电网到神经网络，都由非线性动力学主导。本练习将挑战著名的 Kuramoto 振子耦合模型，展示如何通过在同步状态附近进行线性化来分析其可观测性。通过研究一个星形网络，您将发现网络中的对称性如何产生不可观测的运动模式，这是理解复杂系统行为的一个关键洞见。",
            "id": "4293920",
            "problem": "考虑一个由 $N$ 个耦合相位振子组成的网络，其动力学由 Kuramoto 模型在一个无向、连通图上描述，耦合权重对称 $K_{ij} = K_{ji} \\ge 0$：\n$$\n\\dot{\\theta}_{i} \\;=\\; \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big), \\quad i \\in \\{1,\\dots,N\\},\n$$\n其中 $\\theta_{i}$ 是相位，$\\omega_{i}$ 是自然频率。假设存在一个锁相-同步解，其具有恒定的相位差 $\\theta_{i}^{\\ast} - \\theta_{j}^{\\ast}$ 和一个旋转坐标系中的共同频率，从而满足平衡条件。定义小的相位偏差 $\\delta_{i} := \\theta_{i} - \\theta_{i}^{\\ast}$。\n\n任务 1. 从上述模型和平衡条件出发，推导同步状态附近偏差向量 $\\delta := (\\delta_{1},\\dots,\\delta_{N})^{\\top}$ 的线性化动力学。根据底层图和耦合，确定所得雅可比矩阵的结构。\n\n任务 2. 将问题特化为一个 $N=5$ 个节点的星形图，其中节点 1 是中心节点，连接到节点 2、3、4、5，没有其他边。所有非零耦合是均匀的，$K_{1j} = K$ 对于 $j \\in \\{2,3,4,5\\}$ 且 $K>0$，而其他情况 $K_{ij}=0$。假设在旋转坐标系中存在一个同相锁相解，其中对所有 $i$ 都有 $\\theta_{i}^{\\ast} = \\theta^{\\ast}$，因此平衡点处所有相关的余弦因子都严格为正。设线性化动力学写为 $\\dot{\\delta} = A\\,\\delta$，并假设只测量中心节点的相位偏差，$y = C \\delta$，其中 $C = e_{1}^{\\top}$。\n\n利用线性系统和图拉普拉斯算子的第一性原理，分析从此单一测量中该线性化动力学的可观测性。特别地，计算线性时不变 (LTI) 对 $(A,C)$ 的不可观测子空间的维数。\n\n你的最终答案必须是这个维数，以一个整数形式给出。不需要四舍五入。不要包含单位。",
            "solution": "用户要求分析 Kuramoto 振子网络的可观测性。解题过程根据问题陈述分为两部分。首先，推导一般性的线性化动力学。其次，将这些动力学特化到特定的网络拓扑和测量情景，然后进行可观测性分析。\n\n### 第一部分：线性化动力学的推导\n\n耦合相位振子的动力学由 Kuramoto 模型给出：\n$$\n\\dot{\\theta}_{i} \\;=\\; f_i(\\theta_1, \\dots, \\theta_N) = \\; \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big)\n$$\n其中 $i \\in \\{1,\\dots,N\\}$。我们已知存在一个锁相-同步解，记为 $\\theta_i^{\\ast}$，其中所有振子以一个共同频率 $\\Omega$ 旋转。在这个旋转坐标系中的平衡条件是，对所有 $i$ 都有 $\\dot{\\theta}_{i}^{\\ast} = \\Omega$：\n$$\n\\Omega = \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j}^{\\ast} - \\theta_{i}^{\\ast}\\big)\n$$\n我们考虑对此同步状态的小偏差，$\\theta_{i}(t) = \\theta_{i}^{\\ast} + \\delta_{i}(t)$。偏差 $\\delta_i$ 的动力学通过在平衡解 $\\theta^{\\ast} = (\\theta_1^{\\ast}, \\dots, \\theta_N^{\\ast})^{\\top}$ 附近线性化函数 $f_i$ 得到。线性化系统由 $\\dot{\\delta} = A \\delta$ 给出，其中 $A$ 是在平衡点 $\\theta^{\\ast}$ 处评估的向量场的雅可比矩阵。雅可比矩阵 $A$ 的元素由 $A_{ik} = \\frac{\\partial f_i}{\\partial \\theta_k}\\big|_{\\theta=\\theta^{\\ast}}$ 给出。\n\n让我们计算偏导数：\n对于 $k \\neq i$：\n$$\nA_{ik} = \\frac{\\partial}{\\partial \\theta_k} \\left( \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big) \\right) \\Bigg|_{\\theta=\\theta^{\\ast}} = K_{ik} \\cos(\\theta_k^{\\ast} - \\theta_i^{\\ast})\n$$\n对于 $k = i$：\n$$\nA_{ii} = \\frac{\\partial}{\\partial \\theta_i} \\left( \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big) \\right) \\Bigg|_{\\theta=\\theta^{\\ast}} = \\sum_{j=1}^{N} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast})(-1) = -\\sum_{j \\neq i} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast})\n$$\n最终求和中省略了 $j=i$ 的项，因为 $\\sin(\\theta_i - \\theta_i)=0$，其对 $\\theta_i$ 的导数也为零。\n\n所以，线性化动力学是：\n$$\n\\dot{\\delta}_i = \\sum_{k=1}^N A_{ik} \\delta_k = \\left( -\\sum_{j \\neq i} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast}) \\right) \\delta_i + \\sum_{k \\neq i} K_{ik} \\cos(\\theta_k^{\\ast} - \\theta_i^{\\ast}) \\delta_k\n$$\n这可以更紧凑地写出。我们定义一个有效耦合权重矩阵 $W_{ij} = K_{ij} \\cos(\\theta_j^* - \\theta_i^*)$。因为 $K_{ij}=K_{ji}$ 且 $\\cos(x) = \\cos(-x)$，所以矩阵 $W$ 是对称的。雅可比矩阵 $A$ 的元素可以写成：\n-   对于 $i \\neq k$，$A_{ik} = W_{ik}$\n-   $A_{ii} = -\\sum_{j \\neq i} W_{ij}$\n\n这正是加权图拉普拉斯矩阵的负数的定义。如果 $L(W)$ 是权重为 $W_{ij}$ 的图的拉普拉斯矩阵，定义为 $L_{ii}(W) = \\sum_{j \\neq i} W_{ij}$ 且对于 $i \\neq k$，$L_{ik}(W) = -W_{ik}$，那么雅可比矩阵就是 $A = -L(W)$。\n\n### 第二部分：星形图的可观测性分析\n\n我们现在特化到给定的情况：一个有 $N=5$ 个节点的星形图，中心节点为 1，连接对的均匀耦合为 $K > 0$。耦合矩阵满足 $K_{1j} = K_{j1} = K$ 对于 $j \\in \\{2,3,4,5\\}$，而对于 $i,j \\neq 1$ 的所有其他情况 $K_{ij}=0$。\n\n我们被给予一个同相锁相解，其中对所有 $i$ 都有 $\\theta_i^{\\ast} = \\theta^{\\ast}$。将此代入平衡条件得到：\n$$\n\\Omega = \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin(0) = \\omega_i\n$$\n这意味着，要存在同相解，所有自然频率必须相同，即对所有 $i$ 都有 $\\omega_i = \\Omega$。由于 $\\theta_j^{\\ast} - \\theta_i^{\\ast} = 0$，有效耦合权重为 $W_{ij} = K_{ij} \\cos(0) = K_{ij}$。因此，雅可比矩阵 $A$ 是星形图的标准图拉普拉斯算子 $L$ 的负数，即 $A=-L$。拉普拉斯矩阵 $L$ 由以下给出：\n-   $L_{11} = \\sum_{j=2}^5 K_{1j} = 4K$\n-   对于 $j \\in \\{2,3,4,5\\}$，$L_{1j} = -K_{1j} = -K$\n-   对于 $i \\in \\{2,3,4,5\\}$，$L_{ii} = K_{i1} = K$\n-   对于 $i, j \\in \\{2,3,4,5\\}$ 且 $i \\neq j$，$L_{ij} = -K_{ij}=0$\n\n因此，矩阵 $A=-L$ 是：\n$$\nA = K \\begin{pmatrix}\n-4 & 1 & 1 & 1 & 1 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n1 & 0 & -1 & 0 & 0 \\\\\n1 & 0 & 0 & -1 & 0 \\\\\n1 & 0 & 0 & 0 & -1\n\\end{pmatrix}\n$$\n测量值为 $y = C\\delta$，其中 $C=e_1^{\\top}=[1,0,0,0,0]$。为了确定可观测子空间的维数，我们使用 Popov-Belevitch-Hautus (PBH) 检验。状态空间 $\\mathbb{R}^N$ 可以分解为一个可观测子空间和一个不可观测子空间。不可观测子空间由所有位于测量矩阵 $C$ 的核空间中的 $A$ 的特征向量张成。一个特征向量 $v$ 是不可观测的当且仅当 $Cv=0$。在我们的情况下，$Cv = [1,0,0,0,0] v = v_1$，因此如果一个特征向量的第一个分量为零，则它是不可观测的。\n\n我们来求 $A$ 的特征值和特征向量。这等价于求 $-A/K=L/K$ 的特征值和特征向量。设 $\\lambda'$ 是 $L/K$ 的一个特征值，其特征向量为 $v=(v_1, \\dots, v_5)^\\top$。特征值方程 $(L/K)v = \\lambda' v$ 产生以下方程组：\n1. $4v_1 - v_2 - v_3 - v_4 - v_5 = \\lambda' v_1$\n2. $-v_1 + v_2 = \\lambda' v_2 \\implies v_2(1-\\lambda') = v_1$\n3. $-v_1 + v_3 = \\lambda' v_3 \\implies v_3(1-\\lambda') = v_1$\n4. $-v_1 + v_4 = \\lambda' v_4 \\implies v_4(1-\\lambda') = v_1$\n5. $-v_1 + v_5 = \\lambda' v_5 \\implies v_5(1-\\lambda') = v_1$\n\n从方程 (2-5)，我们区分两种情况。\n\n情况 1：$\\lambda' \\neq 1$。\n那么 $v_2 = v_3 = v_4 = v_5 = \\frac{v_1}{1-\\lambda'}$。将此代入方程 (1)：\n$4v_1 - 4\\left(\\frac{v_1}{1-\\lambda'}\\right) = \\lambda' v_1$。\n假设 $v_1 \\neq 0$ (否则所有 $v_i=0$)，我们可以除以 $v_1$：\n$4 - \\frac{4}{1-\\lambda'} = \\lambda' \\implies 4(1-\\lambda') - 4 = \\lambda'(1-\\lambda') \\implies -4\\lambda' = \\lambda' - (\\lambda')^2 \\implies (\\lambda')^2 - 5\\lambda' = 0$。\n这给出了两个特征值：$\\lambda'(\\lambda'-5)=0 \\implies \\lambda' = 0$ 和 $\\lambda' = 5$。\n对于 $\\lambda' = 0$：$v_i = v_1$。特征向量是 $v^{(0)}=(1,1,1,1,1)^\\top$。\n对于 $\\lambda' = 5$：$v_i = v_1/(1-5) = -v_1/4$。特征向量是 $v^{(5)}=(1, -1/4, -1/4, -1/4, -1/4)^\\top$，或者经过缩放后为 $(4,-1,-1,-1,-1)^\\top$。\n\n情况 2：$\\lambda' = 1$。\n方程 (2-5) 变为 $v_1=0$。方程 (1) 变为 $-v_2 - v_3 - v_4 - v_5 = 0$。\n$\\lambda'=1$ 的特征空间由形如 $(0, v_2, v_3, v_4, v_5)^\\top$ 的向量组成，其中 $\\sum_{i=2}^5 v_i=0$。这是一个 3 维子空间。该特征空间的一个基是：\n$v^{(1a)} = (0, 1, -1, 0, 0)^\\top$\n$v^{(1b)} = (0, 1, 0, -1, 0)^\\top$\n$v^{(1c)} = (0, 1, 0, 0, -1)^\\top$\n\n$A$ 的特征值是 $-\\lambda$，其中 $\\lambda$ 是 $L$ 的特征值。所以，$A$ 的特征值是 $0$、$-5K$（重数均为 1）和 $-K$（重数为 3）。\n\n现在我们应用可观测性条件 $Cv=v_1=0$：\n-   对于特征值 $0$，特征向量为 $v^{(0)}=(1,1,1,1,1)^\\top$。$Cv^{(0)} = 1 \\neq 0$。此模式是可观测的。\n-   对于特征值 $-5K$，特征向量为 $v^{(5)}=(4,-1,-1,-1,-1)^\\top$。$Cv^{(5)} = 4 \\neq 0$。此模式是可观测的。\n-   对于特征值 $-K$，所有特征向量的形式为 $(0, v_2, v_3, v_4, v_5)^\\top$，其中 $\\sum_{i=2}^5 v_i = 0$。对于任何这样的向量 $v$，$Cv = v_1 = 0$。所有三个基向量 $v^{(1a)}, v^{(1b)}, v^{(1c)}$ 的第一个分量都为零。\n\n因此，对应于特征值 $-K$ 的整个 3 维特征空间是不可观测的。不可观测子空间由 $\\{v^{(1a)}, v^{(1b)}, v^{(1c)}\\}$ 张成。\n问题要求计算不可观测子空间的维数。根据我们的分析，这个维数是 3。在物理上，这三个不可观测模式对应于叶节点之间相互振荡的运动，这种运动方式使得中心节点保持静止（因为它们的相位偏差之和为零），从而使这些运动对于放置在中心节点的传感器是不可见的。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}