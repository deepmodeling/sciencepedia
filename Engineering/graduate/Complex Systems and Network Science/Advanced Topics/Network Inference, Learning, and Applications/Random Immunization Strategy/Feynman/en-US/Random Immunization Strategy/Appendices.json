{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with the simplest case: a random immunization strategy applied to a structurally homogeneous network. This exercise guides you through the derivation of the critical immunization threshold for an Erdős–Rényi (ER) random graph, a canonical model in network science. By treating immunization as a site percolation process, you will use a branching process approximation to connect the macroscopic intervention—the fraction of nodes immunized—to a fundamental network property, the mean degree $z$, thereby revealing the core mechanism of network fragmentation .",
            "id": "4299287",
            "problem": "Consider an Erdős–Rényi (ER) random network $G(n,p)$ in the sparse regime with $n$ large, where each pair of nodes is connected independently with probability $p$. The degree distribution of $G(n,p)$ converges to a Poisson distribution with mean degree $z = np$ when $n$ is large and $p$ scales as $z/n$. Now suppose a random immunization strategy is applied: each node is independently immunized (removed) with probability $f$, and hence each node survives (is retained) with probability $q = 1 - f$. Treat the immunized network as a site-percolated version of the original graph.\n\nUsing the branching-process approximation to component exploration in locally tree-like sparse random graphs and starting from first principles about excess degree and the mean reproduction number of the exploration process, derive the critical occupation probability $q_{c}$ for the emergence of a giant connected component under site percolation on $G(n,p)$, and then obtain the corresponding critical immunization fraction $f_{c}$ that just eliminates the giant component. Express your final answer as a closed-form analytic expression in terms of $z$. No numerical approximation or rounding is required.",
            "solution": "The problem asks for the critical occupation probability $q_c$ and the corresponding critical immunization fraction $f_c$ for the existence of a giant connected component (GCC) in an Erdős–Rényi (ER) random network subjected to random node removal (site percolation). The derivation will be based on a branching-process approximation, which is appropriate for sparse, locally tree-like networks.\n\nFirst, we establish the givens from the problem statement:\n1.  The network is an Erdős–Rényi random graph, $G(n,p)$, with $n$ nodes, where $n$ is large.\n2.  The network is in the sparse regime, with connection probability $p$ scaling as $p = z/n$, where $z$ is the mean degree.\n3.  The degree distribution, $P(k)$, of this network converges to a Poisson distribution with mean $z$:\n    $$P(k) = \\frac{z^k \\exp(-z)}{k!}$$\n4.  A random immunization strategy is applied, where each node is removed with probability $f$.\n5.  Equivalently, each node survives (is occupied) with probability $q = 1 - f$.\n\nThe problem is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. Therefore, it is deemed valid. We may proceed with the solution.\n\nThe existence of a giant connected component in a random network is determined by the condition that a branching process, which explores the network by following its edges, can, with non-zero probability, continue indefinitely. The critical threshold for the emergence of the GCC corresponds to the point where the basic reproduction number, $R_0$, of this exploration process is equal to $1$. $R_0$ is defined as the average number of newly explored, surviving nodes in the next generation, starting from a single explored node.\n\nLet's model this exploration process. We start from a randomly chosen node. The number of its neighbors determines the first generation of explored nodes. Then, from each of these neighbors, we follow their *other* edges to find the next generation. The number of these \"other\" edges is a node's excess degree.\n\nThe key to finding $R_0$ is to determine the average number of outgoing edges from a node that has been reached by traversing a random edge. The probability of reaching a node of degree $k$ by following a randomly chosen edge is not $P(k)$, but is proportional to $k P(k)$, because nodes with higher degree have more edges leading to them. The normalized probability is $\\frac{k P(k)}{\\langle k \\rangle}$, where $\\langle k \\rangle$ is the mean degree of the network.\n\nFor a node of degree $k$ reached via one of its edges, there are $k-1$ remaining edges, which constitute its excess degree. The average excess degree, which we can denote as $\\langle k_{excess} \\rangle$, is the average number of such outgoing edges over all possible nodes that can be reached:\n$$\\langle k_{excess} \\rangle = \\sum_{k=1}^{\\infty} (k-1) \\frac{k P(k)}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k=0}^{\\infty} (k^2 - k) P(k)$$\nThe sum is over all non-negative integers $k$. The expression in the sum is simply the expectation of $k^2 - k$. Thus,\n$$\\langle k_{excess} \\rangle = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n\nIn the immunized network, for the exploration to proceed along one of these $k-1$ edges, the node at the other end must not have been removed. This occurs with probability $q$. Therefore, the reproduction number $R_0$ is the mean excess degree multiplied by the survival probability $q$:\n$$R_0 = q \\cdot \\langle k_{excess} \\rangle = q \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n\nNext, we must calculate the first and second moments, $\\langle k \\rangle$ and $\\langle k^2 \\rangle$, for the given Poisson degree distribution. For a Poisson distribution with mean $z$, we have:\n-   The mean degree: $\\langle k \\rangle = z$.\n-   The variance: $\\text{Var}(k) = \\langle k^2 \\rangle - \\langle k \\rangle^2 = z$.\n\nFrom the variance, we can find the second moment $\\langle k^2 \\rangle$:\n$$\\langle k^2 \\rangle = \\text{Var}(k) + \\langle k \\rangle^2 = z + z^2$$\n\nNow, we substitute these moments into the expression for $R_0$:\n$$R_0 = q \\frac{(z + z^2) - z}{z} = q \\frac{z^2}{z} = qz$$\n\nThe critical point for the formation of a giant component occurs when $R_0 = 1$. Let $q_c$ be the critical occupation probability at this threshold.\n$$1 = q_c z$$\nSolving for $q_c$, we find:\n$$q_c = \\frac{1}{z}$$\nThis is the critical occupation probability below which no giant component exists.\n\nThe problem also asks for the corresponding critical immunization fraction, $f_c$. This is related to $q_c$ by the definition $q_c = 1 - f_c$. Therefore:\n$$f_c = 1 - q_c$$\nSubstituting our result for $q_c$:\n$$f_c = 1 - \\frac{1}{z}$$\nThis is the minimum fraction of nodes that must be immunized to guarantee the dismantling of the giant connected component. A giant component exists only if the immunization fraction $f$ is less than $f_c$ (and the mean degree $z>1$). The required quantities are $q_c = 1/z$ and $f_c = 1 - 1/z$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{z} & 1 - \\frac{1}{z} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While the Erdős–Rényi model provides crucial insights, many real-world networks exhibit significant structural heterogeneity, often characterized by a heavy-tailed, or \"scale-free,\" degree distribution. This practice challenges the optimistic results from homogeneous networks by exploring the efficacy of random immunization on a scale-free network . By analyzing how the critical immunization fraction $f_c$ behaves as the network's degree heterogeneity increases, you will uncover a profound limitation of the random strategy and understand why it is often insufficient for controlling outbreaks on networks with highly-connected hubs.",
            "id": "4299299",
            "problem": "Consider a large, sparse, uncorrelated network generated by the configuration model with degree distribution $P(k)$ supported on integers $k \\in [k_{\\min}, k_{\\max}]$, where $P(k) \\propto k^{-\\gamma}$ and $2 < \\gamma \\le 3$. Assume $k_{\\min} \\ge 1$ is fixed and $k_{\\max}$ is a finite structural cutoff that can grow with the network size. A random immunization strategy independently removes each node with probability $f$ (so each node is retained with probability $1-f$), and we are concerned with the disappearance of the giant connected component as a proxy for halting large-scale spreading in the network.\n\nUsing only the locally tree-like property of configuration-model networks and the equivalence to a Galton–Watson branching process for component exploration, proceed as follows:\n\n1. Derive the condition for the disappearance of the giant component under random node removal in terms of the mean excess branching factor. Express the critical immunized fraction $f_{c}$ in terms of the first two moments of the pre-immunization degree distribution, $\\langle k \\rangle$ and $\\langle k^{2} \\rangle$, without invoking any result that is itself the target of derivation.\n\n2. For the scale-free form $P(k) = C k^{-\\gamma}$ on $[k_{\\min}, k_{\\max}]$, determine the normalization constant $C$ and compute asymptotically (in the limit of large $k_{\\max}$ at fixed $k_{\\min}$) the moments $\\langle k \\rangle$ and $\\langle k^{2} \\rangle$ for the two cases $2 < \\gamma < 3$ and $\\gamma = 3$.\n\n3. Combine the results to obtain the large-$k_{\\max}$ asymptotics of $f_{c}$ and evaluate the limit $\\lim_{k_{\\max} \\to \\infty} f_{c}$ for fixed $k_{\\min}$ and a fixed exponent $2 < \\gamma \\le 3$.\n\nYour final answer must be the single limiting value of $f_{c}$ as a real number (no units). No rounding is required; provide the exact limiting value.",
            "solution": "We begin from the locally tree-like property of configuration-model networks. Exploration of a connected component by following edges can be approximated by a Galton–Watson branching process. For a randomly chosen half-edge entering a node, the number of new half-edges (excluding the one we came from) encountered has the excess-degree distribution. The expected number of new half-edges generated per step (the mean branching factor) determines whether a giant component exists.\n\nLet $f$ be the immunized (removed) fraction. Under random node removal, a node survives with probability $1-f$. Consequently, each potential offspring in the branching process is present with probability $1-f$. In an uncorrelated network with pre-immunization degree distribution $P(k)$, the excess-degree distribution is\n$$\nq(k) = \\frac{(k+1) P(k+1)}{\\langle k \\rangle},\n$$\nand the mean excess degree is\n$$\n\\langle k_{\\mathrm{excess}} \\rangle = \\sum_{k=0}^{\\infty} k \\, q(k) = \\frac{\\langle k^{2} \\rangle - \\langle k \\rangle}{\\langle k \\rangle}.\n$$\nUnder random node removal, the mean branching factor becomes\n$$\nB = (1-f) \\, \\langle k_{\\mathrm{excess}} \\rangle = (1-f) \\, \\frac{\\langle k^{2} \\rangle - \\langle k \\rangle}{\\langle k \\rangle}.\n$$\nThe condition for the disappearance of the giant component is the criticality condition $B = 1$. Solving for $f$ at criticality yields\n$$\nf_{c} = 1 - \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle}.\n$$\n\nNext, we compute the asymptotics of $\\langle k \\rangle$ and $\\langle k^{2} \\rangle$ for a scale-free distribution with a hard cutoff. Let\n$$\nP(k) = C k^{-\\gamma}, \\quad k \\in [k_{\\min}, k_{\\max}], \\quad 2 < \\gamma \\le 3,\n$$\nwhere $C$ normalizes $P(k)$. Approximating sums by integrals for large support, we have\n$$\n1 = \\sum_{k=k_{\\min}}^{k_{\\max}} P(k) \\approx \\int_{k_{\\min}}^{k_{\\max}} C k^{-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{1-\\gamma} - k_{\\min}^{1-\\gamma}}{1-\\gamma}.\n$$\nThus\n$$\nC = \\frac{(\\gamma - 1)}{k_{\\min}^{1-\\gamma} - k_{\\max}^{1-\\gamma}}.\n$$\nIn the limit of large $k_{\\max}$ (with fixed $k_{\\min}$) and $2 < \\gamma \\le 3$, we have $k_{\\max}^{1-\\gamma} \\to 0$, so\n$$\nC \\sim (\\gamma - 1) k_{\\min}^{\\gamma - 1}.\n$$\n\nCompute the first moment:\n$$\n\\langle k \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k \\, P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{1-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{2-\\gamma} - k_{\\min}^{2-\\gamma}}{2-\\gamma}.\n$$\nFor $2 < \\gamma \\le 3$, we have $2-\\gamma < 0$, so $k_{\\max}^{2-\\gamma} \\to 0$ as $k_{\\max} \\to \\infty$. Hence\n$$\n\\langle k \\rangle \\sim C \\, \\frac{- k_{\\min}^{2-\\gamma}}{2-\\gamma} = C \\, \\frac{k_{\\min}^{2-\\gamma}}{\\gamma - 2}.\n$$\nSubstituting $C \\sim (\\gamma - 1) k_{\\min}^{\\gamma - 1}$ gives\n$$\n\\langle k \\rangle \\sim \\frac{\\gamma - 1}{\\gamma - 2} \\, k_{\\min},\n$$\nwhich is finite and independent of $k_{\\max}$ for fixed $k_{\\min}$.\n\nCompute the second moment for $2 < \\gamma < 3$:\n$$\n\\langle k^{2} \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k^{2} P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{2-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{3-\\gamma} - k_{\\min}^{3-\\gamma}}{3-\\gamma}.\n$$\nSince $3 - \\gamma > 0$ for $2 < \\gamma < 3$, we have\n$$\n\\langle k^{2} \\rangle \\sim \\frac{C}{3-\\gamma} \\, k_{\\max}^{3-\\gamma} \\quad \\text{as} \\quad k_{\\max} \\to \\infty,\n$$\nwhich diverges as a power of $k_{\\max}$.\n\nFor the marginal case $\\gamma = 3$, we have\n$$\nP(k) = C k^{-3}, \\quad C \\approx 2 k_{\\min}^{2},\n$$\nand\n$$\n\\langle k^{2} \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k^{2} P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{-1} \\, \\mathrm{d}k = C \\, \\ln\\!\\left( \\frac{k_{\\max}}{k_{\\min}} \\right),\n$$\nwhich diverges logarithmically as $k_{\\max} \\to \\infty$.\n\nIn both cases ($2 < \\gamma < 3$ and $\\gamma = 3$), we therefore have\n$$\n\\langle k^{2} \\rangle \\to \\infty \\quad \\text{and} \\quad \\langle k \\rangle \\to \\frac{\\gamma - 1}{\\gamma - 2} \\, k_{\\min} \\quad \\text{(finite)},\n$$\nso\n$$\n\\langle k(k-1) \\rangle = \\langle k^{2} \\rangle - \\langle k \\rangle \\to \\infty.\n$$\nReturning to\n$$\nf_{c} = 1 - \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle},\n$$\nwe see that the denominator diverges while the numerator remains finite, hence\n$$\n\\lim_{k_{\\max} \\to \\infty} f_{c} = 1 - \\lim_{k_{\\max} \\to \\infty} \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle} = 1 - 0 = 1.\n$$\nTherefore, for scale-free networks with exponent $2 < \\gamma \\le 3$, the critical immunized fraction under random immunization tends to $1$ as the structural cutoff $k_{\\max}$ grows, demonstrating the inefficacy of random immunization in the heavy-tailed regime.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Moving from analytical theory to practical application, this final exercise provides a hands-on computational comparison between random and targeted immunization strategies. You will implement algorithms to determine the minimum immunization coverage needed to suppress a Susceptible-Infected-Susceptible (SIS) epidemic on several example networks . By contrasting an approximate theoretical estimator for random immunization with a more precise spectral method for a degree-based targeted strategy, this practice offers a quantitative and tangible understanding of the immense strategic advantage gained by leveraging knowledge of the network structure.",
            "id": "4299240",
            "problem": "Consider the Susceptible–Infected–Susceptible (SIS) contagion process on an undirected, unweighted contact network represented by a symmetric adjacency matrix with binary entries. The effective infection rate is defined as $\\lambda$, which is the ratio of the infection rate to the recovery rate and is dimensionless. Immunization is modeled as node removal (site percolation). Two immunization strategies are considered: random immunization and targeted immunization. In random immunization, a fraction $p$ of nodes is removed uniformly at random, independently. In targeted immunization, nodes are removed deterministically in descending order of their original degrees (tie-break by smaller index), without recalculating the order after each removal.\n\nStarting from first principles, use the following bases appropriate to complex systems and network science:\n- The linearized dynamics of SIS near the disease-free equilibrium for networks, and the connection between stability and spectral properties of the adjacency matrix.\n- The heterogeneous mean-field perspective for uncorrelated networks, formulated in terms of degree moments, and the effect of independent node removal on degree counts for surviving nodes via Binomial thinning.\n\nYour tasks:\n- Derive, from these bases, an estimator for the minimal random immunization fraction $p_{\\mathrm{rand,min}}$ required to ensure that the SIS process is subcritical, meaning the epidemic threshold exceeds a specified $\\lambda$. Express $p_{\\mathrm{rand,min}}$ as a decimal in $[0,1]$.\n- For the targeted strategy, compute the minimal fraction $p_{\\mathrm{targ,min}}$ of deterministically removed nodes needed so that the SIS threshold exceeds the specified $\\lambda$. For targeted immunization, use the linear stability criterion applied to the induced subgraph after removals.\n- Implement both computations as a program. For each test case, the program should output the pair $\\left[p_{\\mathrm{rand,min}}, p_{\\mathrm{targ,min}}\\right]$.\n\nNo physical units are involved. All fractions must be expressed as decimals or rational numbers without the percentage sign.\n\nTest suite and data:\nFor each test case below, the network is specified by a node count $N$ and an edge list $E$ as unordered pairs $(i,j)$ with $0 \\le i,j < N$, and the corresponding prescribed effective infection rate $\\lambda$. All edges are undirected and unique.\n\n- Test Case A:\n  - $N = 20$\n  - $\\lambda = 0.3$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9),(0,10),(1,2),(1,3),(1,4),(1,5),(2,6),(2,7),(3,8),(3,9),(4,10),(4,11),(5,12),(5,13),(6,14),(7,15),(8,16),(9,17),(10,18),(11,19)\\}$\n- Test Case B:\n  - $N = 15$\n  - $\\lambda = 0.3$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9),(0,10),(0,11),(0,12),(0,13),(0,14)\\}$\n- Test Case C:\n  - $N = 10$\n  - $\\lambda = 0.05$\n  - $E = \\{(0,1),(1,2),(2,3),(3,4),(4,5),(5,6),(6,7),(7,8),(8,9),(9,0)\\}$\n- Test Case D:\n  - $N = 12$\n  - $\\lambda = 0.9$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(9,4),(9,5),(9,6),(9,7),(9,8),(9,10),(9,11),(2,10),(3,11)\\}$\n\nPrecise computational specifications:\n- Random immunization estimator: start from the induced effect of independent node survival with probability $s = 1 - p$ on degree counts of surviving nodes and the mean-field threshold expressed via degree moments; derive and use the resulting inequality to solve for the minimal $p$ that guarantees subcriticality at the given $\\lambda$.\n- Targeted immunization computation: remove nodes in descending order by their original degree (tie-break by smaller index). After removing $r$ nodes, consider the induced subgraph on the remaining $N - r$ nodes; determine the epidemic threshold from the spectral criterion based on the adjacency matrix of the induced subgraph; stop at the smallest $r$ for which the threshold exceeds $\\lambda$. Report $p_{\\mathrm{targ,min}} = r/N$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case, where each entry is the two-element list $\\left[p_{\\mathrm{rand,min}}, p_{\\mathrm{targ,min}}\\right]$. For example, the final output should be of the form $\\left[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]\\right]$, where each $a_i$ and $b_i$ is a decimal in $[0,1]$ computed from the corresponding test case.",
            "solution": "The Susceptible–Infected–Susceptible (SIS) process on a static network with adjacency matrix $A$ can be linearized near the disease-free equilibrium by considering the infection probabilities $x_i(t)$ at each node $i$. The linearized dynamics can be written as\n$$\n\\frac{d\\mathbf{x}}{dt} \\approx \\left(\\beta A - \\mu I\\right)\\mathbf{x},\n$$\nwhere $\\beta$ is the infection rate, $\\mu$ is the recovery rate, and $I$ is the identity matrix. The disease-free equilibrium is locally stable if the spectral radius $\\rho\\left(\\beta A - \\mu I\\right)$ is negative, which is equivalent to\n$$\n\\frac{\\beta}{\\mu} < \\frac{1}{\\rho(A)}.\n$$\nDefining the effective infection rate as $\\lambda = \\beta/\\mu$, the spectral stability criterion becomes the threshold condition\n$$\n\\lambda < \\frac{1}{\\rho(A)}.\n$$\nThis provides a fundamental base for targeted immunization: by removing nodes and considering the induced subgraph adjacency $A'$, the new spectral threshold is $\\lambda_c^{\\mathrm{spec}} = 1/\\rho(A')$. The minimal targeted removal fraction $p_{\\mathrm{targ,min}}$ is found by increasing the number of removed nodes until $\\lambda \\le 1/\\rho(A')$ holds.\n\nFor random immunization (site percolation), assume nodes survive independently with probability $s = 1 - p$. Conditional on survival, each node’s degree is subjected to Binomial thinning: given an original degree $k$, the surviving degree $k'$ is distributed as $\\mathrm{Binomial}(k, s)$. Over the ensemble of surviving nodes, the first and second moments transform as\n$$\n\\langle k' \\rangle = s \\langle k \\rangle,\n\\quad\n\\langle (k')^2 \\rangle = s(1-s)\\langle k \\rangle + s^2 \\langle k^2 \\rangle,\n$$\nwhere $\\langle k \\rangle$ and $\\langle k^2 \\rangle$ are the original degree moments, defined as empirical averages over all nodes:\n$$\n\\langle k \\rangle = \\frac{1}{N}\\sum_{i=1}^N k_i,\n\\quad\n\\langle k^2 \\rangle = \\frac{1}{N}\\sum_{i=1}^N k_i^2.\n$$\nUnder the heterogeneous mean-field approximation for uncorrelated networks, the epidemic threshold is given by\n$$\n\\lambda_c^{\\mathrm{hmf}} = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}.\n$$\nAfter random immunization with survival probability $s$, the mean-field threshold becomes\n$$\n\\lambda_c^{\\mathrm{hmf}}(s) = \\frac{\\langle k' \\rangle}{\\langle (k')^2 \\rangle}\n= \\frac{s\\langle k \\rangle}{s(1-s)\\langle k \\rangle + s^2\\langle k^2 \\rangle}\n= \\frac{\\langle k \\rangle}{(1-s)\\langle k \\rangle + s\\langle k^2 \\rangle}.\n$$\nTo ensure subcriticality at a prescribed $\\lambda$, we require\n$$\n\\lambda \\le \\lambda_c^{\\mathrm{hmf}}(s) \\quad \\Rightarrow \\quad\n\\langle k \\rangle \\ge \\lambda\\left[(1-s)\\langle k \\rangle + s\\langle k^2 \\rangle\\right].\n$$\nSolving this inequality for $s$ yields\n$$\n\\langle k \\rangle - \\lambda \\langle k \\rangle \\ge \\lambda s\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)\n\\quad \\Rightarrow \\quad\ns \\le \\frac{\\langle k \\rangle (1 - \\lambda)}{\\lambda\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)}.\n$$\nSince $s = 1 - p$ and $s \\in [0,1]$, the minimal random immunization fraction sufficient to ensure subcriticality is\n$$\np_{\\mathrm{rand,min}} = \\max\\left(0, 1 - \\min\\left(1, \\frac{\\langle k \\rangle (1 - \\lambda)}{\\lambda\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)}\\right)\\right),\n$$\nwith the understanding that if the right-hand side for $s$ is negative, then in principle $p_{\\mathrm{rand,min}} = 1$ is required (immunization of all nodes), and if the bound is at least $1$, then $p_{\\mathrm{rand,min}} = 0$ (no immunization needed).\n\nAlgorithmic design:\n- For each test case, construct the adjacency matrix $A$ of size $N \\times N$ from the given edge list $E$.\n- Compute the degree sequence $\\{k_i\\}_{i=1}^N$ by summing rows of $A$, then compute $\\langle k \\rangle$ and $\\langle k^2 \\rangle$.\n- Compute $p_{\\mathrm{rand,min}}$ using the bound above.\n- For targeted immunization, sort nodes by their original degrees in descending order (tie-break by smaller index). Iteratively remove $r = 0,1,2,\\dots,N$ nodes following that order to form the induced subgraph adjacency $A'$, compute its spectral radius $\\rho(A')$ via eigenvalues for symmetric matrices, and the threshold $1/\\rho(A')$ (interpreting $1/0$ as $+\\infty$). Stop at the smallest $r$ such that $1/\\rho(A') \\ge \\lambda$, and set $p_{\\mathrm{targ,min}} = r/N$. If the condition is satisfied at $r = 0$, then $p_{\\mathrm{targ,min}} = 0$. If not satisfied until $r = N$, set $p_{\\mathrm{targ,min}} = 1$.\n- Aggregate results for all test cases into a single list in the required output format.\n\nWhy targeted strategies differ:\nHeavy-tailed networks concentrate connectivity in hubs with large $k_i$, which strongly influence $\\rho(A)$ and inflate $\\langle k^2 \\rangle$. Targeted removal directly reduces the largest degrees and thus sharply reduces $\\rho(A)$ and the second moment $\\langle k^2 \\rangle$, often achieving subcriticality with substantially smaller $p$ than random immunization. Random immunization, by uniformly removing nodes, primarily affects the average degree $\\langle k \\rangle$ and only indirectly reduces $\\langle k^2 \\rangle$ through thinning; as a result, it typically requires a larger fraction $p$ to offset the contribution of high-degree nodes in heavy-tailed networks.\n\nEdge cases covered:\n- If $\\lambda$ is very small, initial networks may already be subcritical, giving $p_{\\mathrm{rand,min}} = 0$ and $p_{\\mathrm{targ,min}} = 0$.\n- If $\\lambda$ is very large, random immunization may require $p_{\\mathrm{rand,min}} \\approx 1$, while targeted immunization might achieve subcriticality by removing a few hubs, resulting in small $p_{\\mathrm{targ,min}}$.\n- In nearly regular networks (e.g., cycle), the advantage of targeted removal is less pronounced because no extreme hubs exist.\n\nThe program implements these computations exactly as specified and outputs a single line: a comma-separated list enclosing the four two-element lists corresponding to the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_adjacency(n, edges):\n    \"\"\"Build symmetric adjacency matrix for an undirected simple graph.\"\"\"\n    A = np.zeros((n, n), dtype=float)\n    for u, v in edges:\n        if u == v:\n            continue  # ignore self-loops if any\n        A[u, v] = 1.0\n        A[v, u] = 1.0\n    return A\n\ndef degree_moments(A):\n    \"\"\"Compute <k> and <k^2> from adjacency matrix A.\"\"\"\n    deg = A.sum(axis=1)\n    mean_k = float(np.mean(deg))\n    mean_k2 = float(np.mean(deg**2))\n    return deg, mean_k, mean_k2\n\ndef random_immunization_fraction(mean_k, mean_k2, lam):\n    \"\"\"\n    Compute the minimal random immunization fraction p such that\n    the HMF threshold with binomial thinning exceeds lam.\n    Using s <= <k>(1 - lam) / [lam(<k^2> - <k>)] with s = 1 - p and s in [0,1].\n    \"\"\"\n    # Handle degenerate or edge cases robustly\n    if lam <= 0:\n        return 0.0\n    denom = lam * (mean_k2 - mean_k)\n    numer = mean_k * (1.0 - lam)\n    if denom <= 0:\n        # No finite s can satisfy inequality when denom <= 0 and lam > 0.\n        # If numer <= 0 too, then the inequality requires s <= negative -> p=1.\n        # Else if numer > 0 but denom <= 0, the bound is -inf or undefined -> p=1.\n        return 1.0\n    s_bound = numer / denom\n    # Clamp s_bound into [0,1] domain and map to p\n    if s_bound <= 0:\n        return 1.0\n    if s_bound >= 1.0:\n        return 0.0\n    p = 1.0 - s_bound\n    # Numerical guard\n    if p < 0.0:\n        p = 0.0\n    if p > 1.0:\n        p = 1.0\n    return float(p)\n\ndef spectral_radius(A):\n    \"\"\"Compute spectral radius of symmetric adjacency matrix A.\"\"\"\n    n = A.shape[0]\n    if n == 0:\n        return 0.0\n    # If graph has no edges, spectral radius is 0\n    if np.allclose(A, 0.0):\n        return 0.0\n    # Use eigvalsh for symmetric matrices\n    evals = np.linalg.eigvalsh(A)\n    rho = float(np.max(np.abs(evals)))\n    return rho\n\ndef targeted_immunization_fraction(A, lam, deg):\n    \"\"\"\n    Remove nodes in descending order of original degree (tie-break by smaller index),\n    and compute minimal fraction r/N such that 1/rho(A_sub) >= lam.\n    \"\"\"\n    n = A.shape[0]\n    # Sort nodes by original degree desc, tie-break by index asc\n    order = sorted(range(n), key=lambda i: (-deg[i], i))\n    # Try removing r nodes\n    for r in range(0, n + 1):\n        survivors = order[r:]\n        if len(survivors) == 0:\n            # No nodes => null graph => tau_c = +inf\n            return r / n\n        A_sub = A[np.ix_(survivors, survivors)]\n        rho = spectral_radius(A_sub)\n        tau_c = float('inf') if rho == 0.0 else (1.0 / rho)\n        if tau_c >= lam:\n            return r / n\n    # If never satisfies, require removing all\n    return 1.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A\n        (\n            20,\n            [\n                (0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9),(0,10),\n                (1,2),(1,3),(1,4),(1,5),\n                (2,6),(2,7),\n                (3,8),(3,9),\n                (4,10),(4,11),\n                (5,12),(5,13),\n                (6,14),\n                (7,15),\n                (8,16),\n                (9,17),\n                (10,18),\n                (11,19)\n            ],\n            0.3\n        ),\n        # Test Case B (Star)\n        (\n            15,\n            [(0,i) for i in range(1,15)],\n            0.3\n        ),\n        # Test Case C (Cycle)\n        (\n            10,\n            [(i, (i+1) % 10) for i in range(10)],\n            0.05\n        ),\n        # Test Case D (Two hubs)\n        (\n            12,\n            [\n                (0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),\n                (9,4),(9,5),(9,6),(9,7),(9,8),(9,10),(9,11),\n                (2,10),(3,11)\n            ],\n            0.9\n        ),\n    ]\n\n    results = []\n    for n, edges, lam in test_cases:\n        A = build_adjacency(n, edges)\n        deg, mean_k, mean_k2 = degree_moments(A)\n        p_rand = random_immunization_fraction(mean_k, mean_k2, lam)\n        p_targ = targeted_immunization_fraction(A, lam, deg)\n        results.append([p_rand, p_targ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}