{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于一个基本问题：在最简单的随机网络模型上，需要免疫多大比例的人群才能阻止大规模疾病的传播？本练习将指导你使用分支过程近似法，为 Erdős–Rényi (ER) 网络推导临界免疫阈值 。通过这个推导，你将从第一性原理出发，理解网络结构（具体为平均度 $z$）如何直接决定了随机免疫策略的成败。",
            "id": "4299287",
            "problem": "考虑一个处于稀疏状态的 Erdős–Rényi (ER) 随机网络 $G(n,p)$，其中节点数 $n$ 很大，每对节点以概率 $p$ 独立连接。当 $n$ 很大且 $p$ 按 $z/n$ 的比例缩放时，$G(n,p)$ 的度分布收敛于平均度为 $z = np$ 的泊松分布。现在假设应用一种随机免疫策略：每个节点以概率 $f$ 被独立地免疫（移除），因此每个节点以概率 $q = 1 - f$ 存活（被保留）。将免疫后的网络视为原始图的一个位点渗流版本。\n\n使用分支过程近似法来探索局部类树稀疏随机图中的连通分量，并从关于超额度和探索过程平均再生数的第一性原理出发，推导在 $G(n,p)$ 上进行位点渗流时出现巨连通分量的临界占据概率 $q_{c}$，然后求出恰好能消除该巨连通分量的相应临界免疫分数 $f_{c}$。请用含 $z$ 的闭式解析表达式表示您的最终答案。不需要进行数值近似或四舍五入。",
            "solution": "该问题要求解在经历随机节点移除（位点渗流）的 Erdős–Rényi (ER) 随机网络中，存在巨连通分量（GCC）的临界占据概率 $q_c$ 和相应的临界免疫分数 $f_c$。推导将基于分支过程近似，该方法适用于稀疏的、局部类树的网络。\n\n首先，我们从问题陈述中确定已知条件：\n1.  网络是一个有 $n$ 个节点的 Erdős–Rényi 随机图 $G(n,p)$，其中 $n$ 很大。\n2.  网络处于稀疏状态，连接概率 $p$ 按 $p = z/n$ 的比例缩放，其中 $z$ 是平均度。\n3.  该网络的度分布 $P(k)$ 收敛于平均值为 $z$ 的泊松分布：\n    $$P(k) = \\frac{z^k \\exp(-z)}{k!}$$\n4.  应用一种随机免疫策略，每个节点以概率 $f$ 被移除。\n5.  等价地，每个节点以概率 $q = 1 - f$ 存活（被占据）。\n\n该问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的。我们可以继续进行求解。\n\n随机网络中巨连通分量的存在与否，取决于一个探索网络的分支过程（该过程沿着网络的边进行探索）能否以非零概率无限持续下去。GCC 出现的临界阈值对应于此探索过程的基本再生数 $R_0$ 等于 $1$ 的点。$R_0$ 定义为从单个已探索节点开始，下一代中新探索到的、存活的节点的平均数量。\n\n我们来为这个探索过程建模。我们从一个随机选择的节点开始。其邻居的数量决定了第一代被探索的节点。然后，从这些邻居中的每一个出发，我们沿着它们的*其他*边去寻找下一代。这些“其他”边的数量就是一个节点的超额度。\n\n找到 $R_0$ 的关键是确定从一个通过遍历随机边到达的节点出发的出边的平均数量。通过沿一条随机选择的边到达一个度为 $k$ 的节点的概率不是 $P(k)$，而是与 $k P(k)$ 成正比，因为度越高的节点有越多的边指向它。归一化后的概率是 $\\frac{k P(k)}{\\langle k \\rangle}$，其中 $⟨k⟩$ 是网络的平均度。\n\n对于一个通过它的一条边到达的度为 $k$ 的节点，还有 $k-1$ 条剩余的边，这些边构成了它的超额度。平均超额度，我们可以记为 $⟨k_{\\text{excess}}⟩$，是在所有可能被到达的节点上，此类出边的平均数：\n$$\\langle k_{\\text{excess}} \\rangle = \\sum_{k=1}^{\\infty} (k-1) \\frac{k P(k)}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k=0}^{\\infty} (k^2 - k) P(k)$$\n求和遍及所有非负整数 $k$。求和中的表达式就是 $k^2 - k$ 的期望值。因此，\n$$\\langle k_{\\text{excess}} \\rangle = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n\n在免疫后的网络中，为了让探索能沿着这 $k-1$ 条边中的一条进行下去，另一端的节点必须没有被移除。这种情况发生的概率是 $q$。因此，再生数 $R_0$ 是平均超额度乘以存活概率 $q$：\n$$R_0 = q \\cdot \\langle k_{\\text{excess}} \\rangle = q \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$$\n\n接下来，我们必须为给定的泊松度分布计算一阶矩 $⟨k⟩$ 和二阶矩 $⟨k^2⟩$。对于平均值为 $z$ 的泊松分布，我们有：\n-   平均度：$⟨k⟩ = z$。\n-   方差：$\\text{Var}(k) = \\langle k^2 \\rangle - \\langle k \\rangle^2 = z$。\n\n从方差，我们可以求出二阶矩 $⟨k^2⟩$：\n$$\\langle k^2 \\rangle = \\text{Var}(k) + \\langle k \\rangle^2 = z + z^2$$\n\n现在，我们将这些矩代入 $R_0$ 的表达式中：\n$$R_0 = q \\frac{(z + z^2) - z}{z} = q \\frac{z^2}{z} = qz$$\n\n巨连通分量形成的临界点发生在 $R_0 = 1$ 时。设 $q_c$ 为此阈值下的临界占据概率。\n$$1 = q_c z$$\n解出 $q_c$，我们得到：\n$$q_c = \\frac{1}{z}$$\n这是临界占据概率，低于此概率则不存在巨连通分量。\n\n问题还要求相应的临界免疫分数 $f_c$。它通过定义 $q_c = 1 - f_c$ 与 $q_c$ 相关。因此：\n$$f_c = 1 - q_c$$\n代入我们关于 $q_c$ 的结果：\n$$f_c = 1 - \\frac{1}{z}$$\n这是为保证瓦解巨连通分量所必须免疫的节点的最小分数。只有当免疫分数 $f$ 小于 $f_c$ (且平均度 $z>1$) 时，巨连通分量才会存在。所求的量是 $q_c = 1/z$ 和 $f_c = 1 - 1/z$。",
            "answer": "$$\\boxed{\\begin{pmatrix} q_c = \\frac{1}{z} & f_c = 1 - \\frac{1}{z} \\end{pmatrix}}$$"
        },
        {
            "introduction": "现实世界中的许多接触网络，如社交网络或互联网，并非 ER 网络那样均匀，而是呈现出“无标度”的特性，即存在少数拥有极多连接的“中心节点”。本练习将探讨随机免疫策略在这些异质网络上的效果 。你将通过分析度指数为 $\\gamma \\le 3$ 的无标度网络度分布的矩，揭示一个惊人且重要的结论：对于这类网络，随机免疫策略理论上需要免疫几乎所有节点才能奏效，这突显了其固有的局限性。",
            "id": "4299299",
            "problem": "考虑一个由配置模型生成的大型、稀疏、无相关的网络，其度分布为 $P(k)$，定义在整数 $k \\in [k_{\\min}, k_{\\max}]$ 上，其中 $P(k) \\propto k^{-\\gamma}$ 且 $2  \\gamma \\le 3$。假设 $k_{\\min} \\ge 1$ 是固定的，而 $k_{\\max}$ 是一个可以随网络规模增长的有限结构截断值。一种随机免疫策略以概率 $f$ 独立地移除每个节点（因此每个节点以概率 $1-f$ 被保留），我们关心巨连通分支的消失，以此作为网络中大规模传播停止的标志。\n\n仅使用配置模型网络的局部树状属性以及其与用于探索连通分支的 Galton–Watson 分支过程的等价性，按以下步骤进行：\n\n1. 根据平均超额分支因子，推导在随机节点移除下巨连通分支消失的条件。用免疫前度分布的前两阶矩 $⟨k⟩$ 和 $⟨k^2⟩$ 表示临界免疫比例 $f_{c}$，且不得引用本身就是推导目标的任何结果。\n\n2. 对于在 $[k_{\\min}, k_{\\max}]$ 上的无标度形式 $P(k) = C k^{-\\gamma}$，确定归一化常数 $C$，并计算在 $k_{\\max}$ 很大（固定 $k_{\\min}$）的极限下，$2  \\gamma  3$ 和 $\\gamma = 3$ 两种情况下矩 $⟨k⟩$ 和 $⟨k^2⟩$ 的渐近行为。\n\n3. 结合这些结果，得到 $f_{c}$ 在大 $k_{\\max}$ 下的渐近行为，并对固定的 $k_{\\min}$ 和固定的指数 $2  \\gamma \\le 3$ 计算极限 $\\lim_{k_{\\max} \\to \\infty} f_{c}$。\n\n你的最终答案必须是 $f_{c}$ 的极限值，以一个实数（无单位）的形式给出。无需四舍五入；请给出精确的极限值。",
            "solution": "我们从配置模型网络的局部树状属性开始。通过沿边探索连通分支的过程可以近似为一个 Galton–Watson 分支过程。对于一个随机选择进入节点的半边，所遇到的新半边（不包括我们来的那条）的数量遵循超额度分布。每一步生成的新半边的期望数量（即平均分支因子）决定了是否存在巨连通分支。\n\n设 $f$ 为免疫（移除）的比例。在随机节点移除下，一个节点以概率 $1-f$ 存活。因此，分支过程中的每个潜在后代以概率 $1-f$ 存在。在一个无相关网络中，若免疫前的度分布为 $P(k)$，则其超额度分布为\n$$\nq(k) = \\frac{(k+1) P(k+1)}{\\langle k \\rangle},\n$$\n平均超额度为\n$$\n\\langle k_{\\mathrm{excess}} \\rangle = \\sum_{k=0}^{\\infty} k \\, q(k) = \\frac{\\langle k^{2} \\rangle - \\langle k \\rangle}{\\langle k \\rangle}.\n$$\n在随机节点移除下，平均分支因子变为\n$$\nB = (1-f) \\, \\langle k_{\\mathrm{excess}} \\rangle = (1-f) \\, \\frac{\\langle k^{2} \\rangle - \\langle k \\rangle}{\\langle k \\rangle}.\n$$\n巨连通分支消失的条件是临界条件 $B = 1$。在临界条件下求解 $f$ 可得\n$$\nf_{c} = 1 - \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle}.\n$$\n\n接下来，我们计算具有硬截断的无标度分布的 $⟨k⟩$ 和 $⟨k^2⟩$ 的渐近行为。设\n$$\nP(k) = C k^{-\\gamma}, \\quad k \\in [k_{\\min}, k_{\\max}], \\quad 2  \\gamma \\le 3,\n$$\n其中 $C$ 是 $P(k)$ 的归一化常数。对于大的支撑集，我们用积分近似求和，得到\n$$\n1 = \\sum_{k=k_{\\min}}^{k_{\\max}} P(k) \\approx \\int_{k_{\\min}}^{k_{\\max}} C k^{-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{1-\\gamma} - k_{\\min}^{1-\\gamma}}{1-\\gamma}.\n$$\n因此\n$$\nC = \\frac{(\\gamma - 1)}{k_{\\min}^{1-\\gamma} - k_{\\max}^{1-\\gamma}}.\n$$\n在 $k_{\\max}$ 很大（固定 $k_{\\min}$）且 $2  \\gamma \\le 3$ 的极限下，我们有 $k_{\\max}^{1-\\gamma} \\to 0$，所以\n$$\nC \\sim (\\gamma - 1) k_{\\min}^{\\gamma - 1}.\n$$\n\n计算一阶矩：\n$$\n\\langle k \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k \\, P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{1-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{2-\\gamma} - k_{\\min}^{2-\\gamma}}{2-\\gamma}.\n$$\n对于 $2  \\gamma \\le 3$，我们有 $2-\\gamma  0$，因此当 $k_{\\max} \\to \\infty$ 时 $k_{\\max}^{2-\\gamma} \\to 0$。因此\n$$\n\\langle k \\rangle \\sim C \\, \\frac{- k_{\\min}^{2-\\gamma}}{2-\\gamma} = C \\, \\frac{k_{\\min}^{2-\\gamma}}{\\gamma - 2}.\n$$\n代入 $C \\sim (\\gamma - 1) k_{\\min}^{\\gamma - 1}$ 得到\n$$\n\\langle k \\rangle \\sim \\frac{\\gamma - 1}{\\gamma - 2} \\, k_{\\min},\n$$\n对于固定的 $k_{\\min}$，这是一个与 $k_{\\max}$ 无关的有限值。\n\n计算 $2  \\gamma  3$ 时的二阶矩：\n$$\n\\langle k^{2} \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k^{2} P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{2-\\gamma} \\, \\mathrm{d}k = C \\, \\frac{k_{\\max}^{3-\\gamma} - k_{\\min}^{3-\\gamma}}{3-\\gamma}.\n$$\n由于当 $2  \\gamma  3$ 时 $3 - \\gamma > 0$，我们有\n$$\n\\langle k^{2} \\rangle \\sim \\frac{C}{3-\\gamma} \\, k_{\\max}^{3-\\gamma} \\quad \\text{as} \\quad k_{\\max} \\to \\infty,\n$$\n它随着 $k_{\\max}$ 的幂次发散。\n\n对于临界情况 $\\gamma = 3$，我们有\n$$\nP(k) = C k^{-3}, \\quad C \\approx 2 k_{\\min}^{2},\n$$\n且\n$$\n\\langle k^{2} \\rangle \\approx \\int_{k_{\\min}}^{k_{\\max}} k^{2} P(k) \\, \\mathrm{d}k = C \\int_{k_{\\min}}^{k_{\\max}} k^{-1} \\, \\mathrm{d}k = C \\, \\ln\\!\\left( \\frac{k_{\\max}}{k_{\\min}} \\right),\n$$\n当 $k_{\\max} \\to \\infty$ 时，它以对数形式发散。\n\n因此，在两种情况（$2  \\gamma  3$ 和 $\\gamma = 3$）下，我们都有\n$$\n\\langle k^{2} \\rangle \\to \\infty \\quad \\text{且} \\quad \\langle k \\rangle \\to \\frac{\\gamma - 1}{\\gamma - 2} \\, k_{\\min} \\quad \\text{（有限值）},\n$$\n所以\n$$\n\\langle k(k-1) \\rangle = \\langle k^{2} \\rangle - \\langle k \\rangle \\to \\infty.\n$$\n回到\n$$\nf_{c} = 1 - \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle},\n$$\n我们看到分母发散而分子保持有限，因此\n$$\n\\lim_{k_{\\max} \\to \\infty} f_{c} = 1 - \\lim_{k_{\\max} \\to \\infty} \\frac{\\langle k \\rangle}{\\langle k^{2} \\rangle - \\langle k \\rangle} = 1 - 0 = 1.\n$$\n因此，对于指数为 $2  \\gamma \\le 3$ 的无标度网络，随着结构截断值 $k_{\\max}$ 的增长，随机免疫下的临界免疫比例趋向于 1，这表明在重尾分布的情况下随机免疫是无效的。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "理论分析揭示了随机免疫在异质网络上的不足，那么在实践中，我们如何量化其效果并与更优的策略进行比较？本练习要求你运用计算方法，在给定的网络数据上实现随机免疫和靶向免疫两种策略 。通过计算阻止易感-感染-易感 (SIS) 模型传播所需的最小免疫比例，你将亲眼见证并量化靶向策略（优先免疫高连接性节点）相比于随机策略的巨大优势，从而深刻理解网络结构信息在制定干预措施中的核心价值。",
            "id": "4299240",
            "problem": "考虑一个在无向、无权重的接触网络上的易感–感染–易感（SIS）传染过程，该网络由一个具有二进制条目的对称邻接矩阵表示。有效感染率定义为 $\\lambda$，即感染率与恢复率之比，是无量纲的。免疫被建模为节点移除（位点渗流）。考虑两种免疫策略：随机免疫和靶向免疫。在随机免疫中，一部分比例为 $p$ 的节点被独立地、均匀随机地移除。在靶向免疫中，节点按照其原始度数降序（度数相同时按较小索引优先）确定性地移除，每次移除后不重新计算顺序。\n\n从第一性原理出发，使用以下适用于复杂系统和网络科学的基础：\n- 网络上SIS在无病平衡点附近的线性化动力学，以及稳定性与邻接矩阵谱性质之间的联系。\n- 针对无关联网络的异质平均场观点，用度矩来表述，以及通过二项式稀疏化处理独立节点移除对幸存节点度数的影响。\n\n您的任务：\n- 从这些基础出发，推导出一个估计量，用于计算确保SIS过程是亚临界的所需的最小随机免疫比例 $p_{\\mathrm{rand,min}}$，即流行病阈值超过指定的 $\\lambda$。将 $p_{\\mathrm{rand,min}}$ 表示为 $[0,1]$ 内的小数。\n- 对于靶向策略，计算所需的确定性移除节点的最小比例 $p_{\\mathrm{targ,min}}$，以使SIS阈值超过指定的 $\\lambda$。对于靶向免疫，使用应用于移除后诱导子图的线性稳定性准则。\n- 将这两种计算实现为一个程序。对于每个测试用例，程序应输出对 $\\left[p_{\\mathrm{rand,min}}, p_{\\mathrm{targ,min}}\\right]$。\n\n不涉及物理单位。所有比例必须表示为小数或有理数，不带百分号。\n\n测试套件和数据：\n对于下面的每个测试用例，网络由节点数 $N$ 和边列表 $E$（作为无序对 $(i,j)$，其中 $0 \\le i,j  N$）指定，以及相应的规定有效感染率 $\\lambda$。所有边都是无向且唯一的。\n\n- 测试用例A：\n  - $N = 20$\n  - $\\lambda = 0.3$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9),(0,10),(1,2),(1,3),(1,4),(1,5),(2,6),(2,7),(3,8),(3,9),(4,10),(4,11),(5,12),(5,13),(6,14),(7,15),(8,16),(9,17),(10,18),(11,19)\\}$\n- 测试用例B：\n  - $N = 15$\n  - $\\lambda = 0.3$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9),(0,10),(0,11),(0,12),(0,13),(0,14)\\}$\n- 测试用例C：\n  - $N = 10$\n  - $\\lambda = 0.05$\n  - $E = \\{(0,1),(1,2),(2,3),(3,4),(4,5),(5,6),(6,7),(7,8),(8,9),(9,0)\\}$\n- 测试用例D：\n  - $N = 12$\n  - $\\lambda = 0.9$\n  - $E = \\{(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(9,4),(9,5),(9,6),(9,7),(9,8),(9,10),(9,11),(2,10),(3,11)\\}$\n\n精确的计算规范：\n- 随机免疫估计量：从独立节点以概率 $s = 1 - p$ 存活对幸存节点度数的影响，以及通过度矩表示的平均场阈值出发；推导并使用得到的不等式来求解保证在给定 $\\lambda$ 下为亚临界的最小 $p$。\n- 靶向免疫计算：按原始度数降序（度数相同时按较小索引优先）移除节点。移除 $r$ 个节点后，考虑剩余 $N - r$ 个节点上的诱导子图；根据诱导子图的邻接矩阵，使用谱准则确定流行病阈值；在阈值超过 $\\lambda$ 的最小 $r$ 处停止。报告 $p_{\\mathrm{targ,min}} = r/N$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个条目，每个条目是双元素列表 $\\left[p_{\\mathrm{rand,min}}, p_{\\mathrm{targ,min}}\\right]$。例如，最终输出的形式应为 $\\left[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]\\right]$，其中每个 $a_i$ 和 $b_i$ 是从相应测试用例计算出的 $[0,1]$ 内的小数。",
            "solution": "在具有邻接矩阵 $A$ 的静态网络上的易感–感染–易感（SIS）过程，可以通过考虑每个节点 $i$ 的感染概率 $x_i(t)$，在无病平衡点附近进行线性化。线性化动力学可以写成\n$$\n\\frac{d\\mathbf{x}}{dt} \\approx \\left(\\beta A - \\mu I\\right)\\mathbf{x},\n$$\n其中 $\\beta$ 是感染率，$\\mu$ 是恢复率，$I$ 是单位矩阵。如果谱半径 $\\rho\\left(\\beta A - \\mu I\\right)$ 为负，则无病平衡点是局部稳定的，这等价于\n$$\n\\frac{\\beta}{\\mu}  \\frac{1}{\\rho(A)}.\n$$\n将有效感染率定义为 $\\lambda = \\beta/\\mu$，谱稳定性判据变为阈值条件\n$$\n\\lambda  \\frac{1}{\\rho(A)}.\n$$\n这为靶向免疫提供了基本依据：通过移除节点并考虑诱导子图的邻接矩阵 $A'$，新的谱阈值为 $\\lambda_c^{\\mathrm{spec}} = 1/\\rho(A')$。通过增加移除节点的数量，直到 $\\lambda \\le 1/\\rho(A')$ 成立，即可找到最小的靶向移除比例 $p_{\\mathrm{targ,min}}$。\n\n对于随机免疫（位点渗流），假设节点以概率 $s = 1 - p$ 独立存活。在存活的条件下，每个节点的度会经历二项式稀疏化：给定原始度为 $k$，存活后的度 $k'$ 服从分布 $\\mathrm{Binomial}(k, s)$。在存活节点的系综上，一阶矩和二阶矩变换如下\n$$\n\\langle k' \\rangle = s \\langle k \\rangle,\n\\quad\n\\langle (k')^2 \\rangle = s(1-s)\\langle k \\rangle + s^2 \\langle k^2 \\rangle,\n$$\n其中 $⟨k⟩$ 和 $⟨k^2⟩$ 是原始的度矩，定义为所有节点上的经验平均值：\n$$\n\\langle k \\rangle = \\frac{1}{N}\\sum_{i=1}^N k_i,\n\\quad\n\\langle k^2 \\rangle = \\frac{1}{N}\\sum_{i=1}^N k_i^2.\n$$\n在无关联网络的异质平均场近似下，流行病阈值由下式给出\n$$\n\\lambda_c^{\\mathrm{hmf}} = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}.\n$$\n经过存活概率为 $s$ 的随机免疫后，平均场阈值变为\n$$\n\\lambda_c^{\\mathrm{hmf}}(s) = \\frac{\\langle k' \\rangle}{\\langle (k')^2 \\rangle}\n= \\frac{s\\langle k \\rangle}{s(1-s)\\langle k \\rangle + s^2\\langle k^2 \\rangle}\n= \\frac{\\langle k \\rangle}{(1-s)\\langle k \\rangle + s\\langle k^2 \\rangle}.\n$$\n为确保在给定的 $\\lambda$ 下是亚临界的，我们需要\n$$\n\\lambda \\le \\lambda_c^{\\mathrm{hmf}}(s) \\quad \\Rightarrow \\quad\n\\langle k \\rangle \\ge \\lambda\\left[(1-s)\\langle k \\rangle + s\\langle k^2 \\rangle\\right].\n$$\n对此不等式求解 $s$ 可得\n$$\n\\langle k \\rangle (1 - \\lambda) \\ge \\lambda s\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)\n\\quad \\Rightarrow \\quad\ns \\le \\frac{\\langle k \\rangle (1 - \\lambda)}{\\lambda\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)}.\n$$\n由于 $s = 1 - p$ 且 $s \\in [0,1]$，确保亚临界所需的最小随机免疫比例是\n$$\np_{\\mathrm{rand,min}} = \\max\\left(0, 1 - \\min\\left(1, \\frac{\\langle k \\rangle (1 - \\lambda)}{\\lambda\\left(\\langle k^2 \\rangle - \\langle k \\rangle\\right)}\\right)\\right),\n$$\n理解为，如果 $s$ 的右侧为负，则原则上需要 $p_{\\mathrm{rand,min}} = 1$（免疫所有节点）；如果该界限至少为1，则 $p_{\\mathrm{rand,min}} = 0$（无需免疫）。\n\n算法设计：\n- 对于每个测试用例，根据给定的边列表 $E$ 构建大小为 $N \\times N$ 的邻接矩阵 $A$。\n- 通过对 $A$ 的行求和来计算度序列 $\\{k_i\\}_{i=1}^N$，然后计算 $⟨k⟩$ 和 $⟨k^2⟩$。\n- 使用上述界限计算 $p_{\\mathrm{rand,min}}$。\n- 对于靶向免疫，按原始度数降序（度数相同时按较小索引优先）对节点进行排序。按照该顺序迭代移除 $r = 0,1,2,\\dots,N$ 个节点以形成诱导子图的邻接矩阵 $A'$，通过对称矩阵的特征值计算其谱半径 $\\rho(A')$，以及阈值 $1/\\rho(A')$（将 $1/0$ 解释为 $+\\infty$）。在使得 $1/\\rho(A') \\ge \\lambda$ 的最小 $r$ 处停止，并设置 $p_{\\mathrm{targ,min}} = r/N$。如果条件在 $r = 0$ 时满足，则 $p_{\\mathrm{targ,min}} = 0$。如果直到 $r = N$ 才满足，则设置 $p_{\\mathrm{targ,min}} = 1$。\n- 将所有测试用例的结果汇总到所需输出格式的单个列表中。\n\n靶向策略为何不同：\n重尾网络将连通性集中在具有大 $k_i$ 的枢纽节点上，这些节点强烈影响 $\\rho(A)$ 并增大了 $⟨k^2⟩$。靶向移除直接减少了最大的度，从而急剧降低 $\\rho(A)$ 和二阶矩 $⟨k^2⟩$，通常可以用比随机免疫小得多的 $p$ 实现亚临界。\n随机免疫通过均匀移除节点，主要影响平均度 $⟨k⟩$，并且仅通过稀疏化间接减少 $⟨k^2⟩$；因此，在重尾网络中，它通常需要更大的比例 $p$ 来抵消高度数节点的贡献。\n\n覆盖的边缘情况：\n- 如果 $\\lambda$ 非常小，初始网络可能已经是亚临界的，得到 $p_{\\mathrm{rand,min}} = 0$ 和 $p_{\\mathrm{targ,min}} = 0$。\n- 如果 $\\lambda$ 非常大，随机免疫可能需要 $p_{\\mathrm{rand,min}} \\approx 1$，而靶向免疫可能通过移除少数几个枢纽节点就实现亚临界，从而导致较小的 $p_{\\mathrm{targ,min}}$。\n- 在近似规则的网络（例如，环状网络）中，靶向移除的优势不太明显，因为不存在极端的枢纽节点。\n\n程序完全按照规定实现这些计算，并输出单行：一个逗号分隔的列表，其中包含对应于四个测试用例的四个双元素列表。",
            "answer": "[[0.0, 0.05], [0.641, 0.067], [0.0, 0.0], [0.971, 0.167]]"
        }
    ]
}