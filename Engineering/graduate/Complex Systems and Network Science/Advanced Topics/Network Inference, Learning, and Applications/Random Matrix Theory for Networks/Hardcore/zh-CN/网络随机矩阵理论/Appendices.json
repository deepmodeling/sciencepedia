{
    "hands_on_practices": [
        {
            "introduction": "为了在网络中识别有意义的模式，我们首先需要建立一个基准，以了解纯随机网络的谱是什么样的。随机矩阵理论提供了这一基本的零模型。这项练习将指导您完成一个基础性推导，展示一个大的、稠密的随机图的特征值分布如何收敛到著名的维格纳半圆律，这是网络谱分析的基石。",
            "id": "4299557",
            "problem": "考虑稠密区域中的无向 Erdős–Rényi 随机图 $G(n,p)$，其中 $p \\in (0,1)$ 是一个与 $n$ 无关的固定常数，且边是独立存在的。令 $A \\in \\mathbb{R}^{n \\times n}$ 表示其邻接矩阵，其中对于 $i \\neq j$，有 $A_{ij} = A_{ji} \\in \\{0,1\\}$，且对于所有 $i$，有 $A_{ii} = 0$。定义中心化邻接矩阵 $\\tilde{A} \\in \\mathbb{R}^{n \\times n}$ 为：当 $i \\neq j$ 时 $\\tilde{A}_{ij} = A_{ij} - p$，且 $\\tilde{A}_{ii} = 0$。考虑归一化矩阵\n$$\nX_n = \\frac{\\tilde{A}}{\\sqrt{n p(1-p)}}.\n$$\n$X_n$ 的上三角元素是独立的，均值为 $0$，方差为 $1/n$。令 $\\mu_{X_n}$ 表示经验谱分布 (Empirical Spectral Distribution, ESD)，定义为 $\\mu_{X_n} = \\frac{1}{n} \\sum_{k=1}^{n} \\delta_{\\lambda_k(X_n)}$，其中 $\\lambda_k(X_n)$ 是 $X_n$ 的特征值。从基本定义和迹矩法出发，仅使用关于矩阵元素独立性、零均值、有限方差和有界性的一般事实，推导当 $n \\to \\infty$ 时 $\\mu_{X_n}$ 的极限分布。具体而言：\n- 证明对于每个固定的整数 $k \\geq 1$，矩序列 $m_k^{(n)} = \\int x^k \\,\\mathrm{d}\\mu_{X_n}(x) = \\frac{1}{n} \\operatorname{Tr}(X_n^k)$ 收敛到一个确定性极限 $m_k$。\n- 通过枚举迹展开中闭路的主要组合贡献来确定这些极限矩 $\\{m_k\\}_{k \\geq 1}$，并解释为什么在极限情况下只有成对的边匹配（非交叉配对）有贡献。\n- 推断出极限 ESD，并给出其显式的概率密度函数 $\\rho(x)$，表示为关于 $x$ 的单一解析表达式。\n\n将你的最终答案以关于 $x$ 的单一闭式表达式形式给出极限密度 $\\rho(x)$。不需要数值近似。最终密度表达式不带单位，并且最终答案中不要包含任何无关的文本。",
            "solution": "该问题要求解 Erdős–Rényi 随机图 $G(n,p)$ 的归一化中心邻接矩阵 $X_n$ 的极限经验谱分布 (ESD)。我们将使用矩量法。ESD $\\mu_{X_n}$ 的 $k$ 阶矩由 $m_k^{(n)} = \\frac{1}{n} \\operatorname{Tr}(X_n^k)$ 给出。我们将证明对于每个固定的整数 $k \\ge 1$，序列 $m_k^{(n)}$ 在 $n \\to \\infty$ 时收敛到一个极限 $m_k$，然后确定与此极限矩序列相对应的分布。\n\n$k$ 阶矩可以写成迹的展开式：\n$$\nm_k^{(n)} = \\frac{1}{n} \\operatorname{Tr}(X_n^k) = \\frac{1}{n} \\sum_{i_1, \\dots, i_k=1}^n (X_n)_{i_1 i_2} \\cdots (X_n)_{i_k i_1}\n$$\n代入 $X_n$ 的定义，其非对角线元素为 $(X_n)_{ij} = \\frac{A_{ij} - p}{\\sqrt{np(1-p)}}$：\n$$\nm_k^{(n)} = \\frac{1}{n(np(1-p))^{k/2}} \\sum_{i_1, \\dots, i_k=1}^n (A_{i_1 i_2}-p) \\cdots (A_{i_k i_1}-p)\n$$\n（忽略对角线元素为零的影响，因为它们在 $n \\to \\infty$ 时贡献可忽略不计）。为了求 $m_k^{(n)}$ 的极限值，我们首先计算其期望 $\\mathbb{E}[m_k^{(n)}]$。由于 $(A_{ij}-p)$ 是均值为零的独立随机变量（对于不同的边 $\\{i,j\\}$），\n$$\n\\mathbb{E}[m_k^{(n)}] = \\frac{1}{n^{1+k/2} (p(1-p))^{k/2}} \\sum_{i_1, \\dots, i_k=1}^n \\mathbb{E}[(A_{i_1 i_2}-p) \\cdots (A_{i_k i_1}-p)]\n$$\n求和中的期望值仅当乘积中的每个随机变量 $(A_{ij}-p)$ 至少出现两次时才为非零。这是因为 $\\mathbb{E}[A_{ij}-p]=0$。在 $n \\to \\infty$ 的极限下，主要贡献来自于那些每条边恰好被遍历两次的闭路。\n\n1.  如果 $k$ 是奇数，就不可能使每条边都恰好被遍历两次。任何包含至少一条只被遍历一次的边的闭路，其期望值为零。更高阶的遍历（如三次）会引入额外的 $n$ 的负幂次，因此在极限下消失。因此，对于所有奇数 $k$，极限矩为 $m_k = \\lim_{n\\to\\infty} \\mathbb{E}[m_k^{(n)}] = 0$。\n\n2.  如果 $k$ 是偶数，令 $k=2m$。主要贡献来自于由 $m$ 条不同边组成的闭路，其中每条边被遍历一次向前，一次向后。这些闭路对应于长度为 $2m$ 的 Dyck 路，或等价于 $\\{1, \\dots, 2m\\}$ 的非交叉配对。这种配对的数量由第 $m$ 个卡特兰数给出：$C_m = \\frac{1}{m+1}\\binom{2m}{m}$。\n\n对于一个特定的非交叉配对，我们需要计算对求和有贡献的闭路数量。这样的闭路经过 $m+1$ 个不同的顶点。选择这 $m+1$ 个顶点的方式有 $\\binom{n}{m+1}$ 种，并以 $(m+1)!$ 种方式将它们分配给路径上的位置。因此，大约有 $n^{m+1}$ 种方式来选择顶点。\n\n对于这样一条特定的闭路，期望值为 $(\\mathbb{E}[(A_{ij}-p)^2])^m = (p(1-p))^m$。\n\n将这些组合在一起，我们得到：\n$$\n\\mathbb{E}[m_{2m}^{(n)}] \\approx \\frac{1}{n^{1+m} (p(1-p))^m} \\cdot C_m \\cdot n^{m+1} \\cdot (p(1-p))^m = C_m\n$$\n因此，在 $n \\to \\infty$ 的极限下，我们有：\n$$\nm_k = \\begin{cases} C_{k/2}  \\text{if } k \\text{ is even} \\\\ 0  \\text{if } k \\text{ is odd} \\end{cases}\n$$\n这个矩序列 $\\{m_k\\}$ 是标准维格纳半圆分布的矩。该分布的支撑集为 $[-2,2]$，其概率密度函数 $\\rho(x)$ 为：\n$$\n\\rho(x) = \\frac{1}{2\\pi} \\sqrt{4-x^2}, \\quad \\text{for } x \\in [-2, 2]\n$$\n可以证明，矩的收敛性足以保证分布的弱收敛。因此，$\\mu_{X_n}$ 收敛到这个半圆分布。\n最终的概率密度函数为所求答案。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{4-x^2}}{2\\pi}}\n$$"
        },
        {
            "introduction": "一旦我们将半圆律理解为随机性的标志，我们就可以开始寻找有意义的结构。这项练习展示了一个强大的应用：一个显著的网络特征（如枢纽节点）如何在谱中显现。您将计算由枢纽节点产生的“离群”特征值的确切位置，从而在网络拓扑和谱特性之间建立一个切实的联系。",
            "id": "4299575",
            "problem": "考虑一个包含 $n$ 个节点的合成无向网络，该网络由一个对称加权邻接矩阵 $A_{n} \\in \\mathbb{R}^{n \\times n}$ 表示。将 $A_{n}$ 分解为 $A_{n} = W_{n} + S_{n}$，其中 $W_{n}$ 建模背景连通性波动，$S_{n}$ 建模单个中心节点。\n\n背景矩阵 $W_{n}$ 是一个实对称随机矩阵，其元素 $(W_{n})_{ij} = (W_{n})_{ji}$ 对于 $i \\neq j$ 独立同分布，均值为 $\\mathbb{E}[(W_{n})_{ij}] = 0$，方差为 $\\mathrm{Var}[(W_{n})_{ij}] = \\sigma^{2}/n$，且对于所有 $i$ 都有 $(W_{n})_{ii} = 0$。中心节点矩阵 $S_{n}$ 编码了一个以节点 1 为中心的星形结构，该结构与所有其他节点之间具有统一的边权重 $s_{n}  0$：对于 $j = 2, \\dots, n$，有 $(S_{n})_{1j} = (S_{n})_{j1} = s_{n}$，其他情况则 $(S_{n})_{ij} = 0$。采用尺度变换 $s_{n} = \\alpha/\\sqrt{n}$，其中 $\\alpha  0$ 为固定值，并假设 $\\alpha  \\sigma$ 以确保存在一个由中心节点诱导的离群特征值。\n\n从网络随机矩阵理论的第一性原理出发——即 $W_{n}$ 谱分布的 Wigner 半圆律和加性有限秩扰动的基于预解式的自洽性——在 $n \\to \\infty$ 的极限下，推导以下各项的闭式解析表达式：\n1. 由中心节点诱导的 $A_{n}$ 的最大离群特征值。\n2. 该特征值与 $W_{n}$ 体谱右边缘的间距。\n\n将您的最终答案表示为关于 $\\alpha$ 和 $\\sigma$ 的单个解析表达式或单行解析表达式矩阵。无需数值舍入。不涉及物理单位。",
            "solution": "该问题要求在 $n \\to \\infty$ 的极限下，求出矩阵 $A_n = W_n + S_n$ 的最大离群特征值及其与体谱的间距。我们将使用随机矩阵理论中的预解式技术来解决这个问题。\n\n首先，我们刻画背景矩阵 $W_n$ 的谱性质。$W_n$ 是一个实对称随机矩阵，其元素 $(W_n)_{ij}$ 对于 $i \\neq j$ 独立同分布，均值为 $0$，方差为 $\\sigma^2/n$，且对角线元素 $(W_n)_{ii}=0$。这是 Wigner 矩阵的一个特例。对于这种方差尺度，当 $n \\to \\infty$ 时，$W_n$ 的经验谱分布收敛于 Wigner 半圆律。其概率密度函数 $\\rho(x)$ 由下式给出：\n$$ \\rho(x) = \\begin{cases} \\frac{1}{2\\pi\\sigma^2}\\sqrt{4\\sigma^2 - x^2}  \\text{if } |x| \\le 2\\sigma \\\\ 0  \\text{if } |x|  2\\sigma \\end{cases} $$\n因此，$W_n$ 的谱渐近支撑于区间 $[-2\\sigma, 2\\sigma]$ 上。谱的这个连续部分被称为“体谱”。因此，体谱的右边缘位于 $\\lambda_{\\text{edge}} = 2\\sigma$。\n\n该分布的 Stieltjes 变换 $g(z) = \\int \\frac{\\rho(x)}{x-z} dx$ 是一个关键工具。对于 $z \\in \\mathbb{C} \\setminus [-2\\sigma, 2\\sigma]$，它满足以下二次方程：\n$$ \\sigma^2 g(z)^2 + z g(z) + 1 = 0 $$\n满足当 $|z|$ 很大时 $g(z) \\sim -1/z$ 的合适的解是：\n$$ g(z) = \\frac{-z + \\sqrt{z^2 - 4\\sigma^2}}{2\\sigma^2} $$\n对于体谱外的实值 $\\lambda$（即 $|\\lambda|  2\\sigma$），量 $(G_{W_n}(\\lambda))_{ii}$ 收敛于 $g(\\lambda)$，并且预解式的迹也通过 $\\frac{1}{n}\\mathrm{Tr}(G_{W_n}(\\lambda)) \\to g(\\lambda)$ 与 $g(\\lambda)$ 相关，其中 $G_{W_n}(\\lambda) = (W_n - \\lambda I)^{-1}$ 是 $W_n$ 的预解式。\n\n接下来，我们分析扰动矩阵 $S_n$。它由 $(S_{n})_{1j} = (S_{n})_{j1} = s_{n} = \\alpha/\\sqrt{n}$ (对于 $j=2, \\dots, n$) 定义，所有其他元素均为零。该矩阵代表一个星形图，可以写成一个秩为 2 的矩阵。令 $e_1 = (1, 0, \\dots, 0)^T$ 为标准基向量，$v = \\sum_{j=2}^n e_j = (0, 1, \\dots, 1)^T$。那么 $S_n$ 可以表示为：\n$$ S_n = s_n (e_1 v^T + v e_1^T) $$\n\n$A_n = W_n + S_n$ 的一个与 $W_n$ 的体谱分离的离群特征值 $\\lambda$ 是预解式 $G_{A_n}(\\lambda) = (W_n + S_n - \\lambda I)^{-1}$ 的一个极点。这些极点由条件 $\\det(A_n - \\lambda I) = 0$ 确定，使用 $W_n$ 的预解式可将其重写为：\n$$ \\det(I + G_{W_n}(\\lambda) S_n) = 0 $$\n利用性质 $\\det(I+BC) = \\det(I+CB)$ 以及 $S_n$ 的结构 $S_n = s_n(e_1 v^T + v e_1^T) = [e_1, v] \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix} [e_1, v]^T$，我们可以简化行列式。\n令 $U = [e_1, v]$ 和 $C = \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix}$。那么 $S_n=UCU^T$。\n条件变为 $\\det(I_n + G_{W_n}(\\lambda) U C U^T) = 0$。\n这等价于 $\\det(I_2 + U^T G_{W_n}(\\lambda) U C) = 0$。\n我们来计算矩阵 $M(\\lambda) = U^T G_{W_n}(\\lambda) U$：\n$$ M(\\lambda) = \\begin{pmatrix} e_1^T G_{W_n}(\\lambda) e_1  e_1^T G_{W_n}(\\lambda) v \\\\ v^T G_{W_n}(\\lambda) e_1  v^T G_{W_n}(\\lambda) v \\end{pmatrix} $$\n条件变为：\n$$ \\det\\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} e_1^T G_{W_n} e_1  e_1^T G_{W_n} v \\\\ v^T G_{W_n} e_1  v^T G_{W_n} v \\end{pmatrix} \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 1+s_n(e_1^T G_{W_n} v)  s_n(e_1^T G_{W_n} e_1) \\\\ s_n(v^T G_{W_n} v)  1+s_n(v^T G_{W_n} e_1) \\end{pmatrix} = 0 $$\n由于 $G_{W_n}$ 是对称的，所以 $e_1^T G_{W_n} v = v^T G_{W_n} e_1$。方程简化为：\n$$ (1+s_n e_1^T G_{W_n} v)^2 - s_n^2 (e_1^T G_{W_n} e_1)(v^T G_{W_n} v) = 0 $$\n在 $n \\to \\infty$ 的极限下，对于体谱外的 $\\lambda$，预解式的二次型收敛：$u^T G_{W_n}(\\lambda) w \\to (u^T w) g(\\lambda)$。\n我们将此应用于我们的各项：\n\\begin{itemize}\n    \\item $e_1^T G_{W_n}(\\lambda) e_1 \\to (e_1^T e_1) g(\\lambda) = 1 \\cdot g(\\lambda) = g(\\lambda)$.\n    \\item $v^T G_{W_n}(\\lambda) v \\to (v^T v) g(\\lambda) = (n-1) g(\\lambda)$.\n    \\item $e_1^T G_{W_n}(\\lambda) v \\to (e_1^T v) g(\\lambda) = 0 \\cdot g(\\lambda) = 0$.\n\\end{itemize}\n将这些极限和 $s_n = \\alpha/\\sqrt{n}$ 代入方程中：\n$$ (1 + \\frac{\\alpha}{\\sqrt{n}} \\cdot 0)^2 - \\left(\\frac{\\alpha}{\\sqrt{n}}\\right)^2 (g(\\lambda))((n-1) g(\\lambda)) \\approx 0 $$\n$$ 1 - \\frac{\\alpha^2}{n} g(\\lambda)^2 (n-1) = 0 $$\n取 $n \\to \\infty$ 的极限，我们得到：\n$$ 1 - \\alpha^2 g(\\lambda)^2 = 0 \\implies g(\\lambda)^2 = \\frac{1}{\\alpha^2} $$\n我们正在寻找最大特征值，因此我们假设 $\\lambda  \\lambda_{\\text{edge}} = 2\\sigma$。对于实数 $\\lambda  2\\sigma$，Stieltjes 变换 $g(\\lambda) = \\int_{-2\\sigma}^{2\\sigma} \\frac{\\rho(x)}{x-\\lambda}dx$ 是负的。因此，我们必须取负根：\n$$ g(\\lambda) = -\\frac{1}{\\alpha} $$\n现在我们代入 $g(\\lambda)$ 的表达式：\n$$ \\frac{-\\lambda + \\sqrt{\\lambda^2 - 4\\sigma^2}}{2\\sigma^2} = -\\frac{1}{\\alpha} $$\n$$ -\\lambda + \\sqrt{\\lambda^2 - 4\\sigma^2} = -\\frac{2\\sigma^2}{\\alpha} $$\n$$ \\sqrt{\\lambda^2 - 4\\sigma^2} = \\lambda - \\frac{2\\sigma^2}{\\alpha} $$\n条件 $\\alpha  \\sigma$ 确保对于我们将要找到的离群值 $\\lambda$，右边是正的。两边平方：\n$$ \\lambda^2 - 4\\sigma^2 = \\left(\\lambda - \\frac{2\\sigma^2}{\\alpha}\\right)^2 = \\lambda^2 - \\frac{4\\lambda\\sigma^2}{\\alpha} + \\frac{4\\sigma^4}{\\alpha^2} $$\n$$ -4\\sigma^2 = -\\frac{4\\lambda\\sigma^2}{\\alpha} + \\frac{4\\sigma^4}{\\alpha^2} $$\n假设 $\\sigma \\neq 0$，我们可以两边除以 $-4\\sigma^2$：\n$$ 1 = \\frac{\\lambda}{\\alpha} - \\frac{\\sigma^2}{\\alpha^2} $$\n解出 $\\lambda$ 得到最大离群特征值 $\\lambda_{\\text{outlier}}$：\n$$ \\lambda_{\\text{outlier}} = \\alpha \\left(1 + \\frac{\\sigma^2}{\\alpha^2}\\right) = \\alpha + \\frac{\\sigma^2}{\\alpha} $$\n这个结果在 $\\alpha  \\sigma$ 时有效，这确保了 $\\lambda_{\\text{outlier}}  2\\sigma$。确实，$\\alpha + \\frac{\\sigma^2}{\\alpha} - 2\\sigma = \\frac{\\alpha^2 - 2\\alpha\\sigma + \\sigma^2}{\\alpha} = \\frac{(\\alpha-\\sigma)^2}{\\alpha}  0$。\n\n第一个要求的量是离群特征值：\n$$ \\lambda_{\\text{outlier}} = \\alpha + \\frac{\\sigma^2}{\\alpha} $$\n\n第二个要求的量是该特征值与体谱右边缘的间距。右边缘位于 $\\lambda_{\\text{edge}} = 2\\sigma$。间距 $\\Delta$ 为：\n$$ \\Delta = \\lambda_{\\text{outlier}} - \\lambda_{\\text{edge}} = \\left(\\alpha + \\frac{\\sigma^2}{\\alpha}\\right) - 2\\sigma $$\n$$ \\Delta = \\frac{\\alpha^2 + \\sigma^2 - 2\\alpha\\sigma}{\\alpha} = \\frac{(\\alpha-\\sigma)^2}{\\alpha} $$\n\n这两个表达式是该问题的完整答案。我们将其表示为一个行矩阵。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\alpha + \\frac{\\sigma^2}{\\alpha}  \\frac{(\\alpha - \\sigma)^2}{\\alpha} \\end{pmatrix}} $$"
        },
        {
            "introduction": "我们已经看到，一个强的结构信号可以产生一个可检测的离群值。但是，信号需要多“强”才足够？最后的这项练习探讨了著名的Baik–Ben Arous–Péché (BBP)相变，它为信号检测定义了一个明确的界限。通过推导临界信号强度，您将揭示隐藏结构在谱上变得可见的基本极限，这是理解谱方法的能力与局限性的一个关键概念。",
            "id": "4299560",
            "problem": "考虑一个由 $n$ 个节点组成的无向网络序列，该序列被建模为具有独立边的稀疏 Erdős–Rényi 图。令 $A^{(n)}$ 为其邻接矩阵，其非对角线元素为 $A^{(n)}_{ij} \\in \\{0,1\\}$（当 $i \\neq j$ 时），其中 $\\mathbb{P}(A^{(n)}_{ij} = 1) = p_{n}$ 且 $p_{n} = c/n$（对于固定的 $c  0$）。定义中心化和标准化的类邻接矩阵 $X^{(n)}$ 如下：\n$$\nX^{(n)}_{ij} = \\begin{cases}\n\\dfrac{A^{(n)}_{ij} - p_{n}}{\\sqrt{n p_{n} (1 - p_{n})}}  \\text{if } i \\neq j, \\\\\n0  \\text{if } i = j,\n\\end{cases}\n$$\n并考虑在此主体（bulk）上添加一个秩一异质性（信号），\n$$\nS^{(n)} = X^{(n)} + \\theta\\, v v^{\\top},\n$$\n其中 $v \\in \\mathbb{R}^{n}$ 是一个与 $X^{(n)}$ 无关的确定性单位向量（$\\|v\\|_{2} = 1$），$\\theta \\in \\mathbb{R}$ 是一个信号强度参数。在大 $n$ 极限下，$X^{(n)}$ 是一个 Wigner 型矩阵，其非对角线元素的方差等于 $1/n$，其经验谱分布收敛到支撑在 $[-2,2]$ 上的半圆律。\n\n使用网络随机矩阵理论的第一性原理，推导与 $S^{(n)}$ 的 Baik–Ben Arous–Péché (BBP) 相变相关的离群特征值条件，并用 $X^{(n)}$ 的极限谱分布的主体 Stieltjes 变换 $m(z)$ 来表示。然后，对于如上定义的类邻接缩放（即，中心化和标准化的矩阵产生方差为 1 的半圆律），求解所得的自洽方程，以确定主体支撑右侧的一个假定离群值，并找出当离群值首次从主体右边缘出现时 $\\theta$ 的临界值。\n\n你的推导必须从 Stieltjes 变换的定义、矩阵的预解式以及秩一更新的 Sherman–Morrison 公式开始，并进行到极限各向同性近似 $\\langle v, (\\cdot) v \\rangle \\to m(z)$。明确使用半圆律在实数参数 $z  2$ 上的 Stieltjes 变换 $m(z)$。将临界信号强度报告为一个精确的数字。不需要四舍五入。最终答案必须是单个实数。",
            "solution": "问题要求在一个特定的随机矩阵模型中，出现离群特征值所需的临界信号强度 $\\theta$。推导过程主要分为三个阶段：首先，建立秩一扰动矩阵模型中离群特征值的一般方程；其次，将此方程特化到给定的矩阵系综，其极限谱分布为半圆律；第三，求解临界参数值。\n\n令 $S^{(n)} = X^{(n)} + \\theta v v^{\\top}$ 为所讨论的矩阵，其中 $X^{(n)}$ 是随机“主体”矩阵，$\\theta v v^{\\top}$ 是秩一“信号”或扰动。我们关心的是在大 $n$ 极限下 $S^{(n)}$ 的特征值。离群特征值是那些位于主体矩阵 $X^{(n)}$ 极限谱分布支撑集之外的特征值。\n\n特征值的位置可以从经验谱分布的 Stieltjes 变换的极点确定。对于一个大小为 $n \\times n$ 的矩阵 $M$，其 Stieltjes 变换定义为\n$$\nm_{M}(z) = \\frac{1}{n} \\text{Tr}\\left((M - zI_n)^{-1}\\right)\n$$\n其中 $z \\in \\mathbb{C} \\setminus \\text{spectrum}(M)$，$I_n$ 是 $n \\times n$ 单位矩阵。矩阵 $(M-zI_n)^{-1}$ 称为 $M$ 在 $z$ 处的预解式。\n\n令 $R_X(z) = (X^{(n)} - zI_n)^{-1}$ 为主体矩阵 $X^{(n)}$ 的预解式。扰动矩阵 $S^{(n)}$ 的预解式可以使用秩一更新的逆的 Sherman–Morrison 公式求得。对于一个可逆矩阵 $A$ 和向量 $u, w$，该公式表述为 $(A+uw^{\\top})^{-1} = A^{-1} - \\frac{A^{-1}uw^{\\top}A^{-1}}{1+w^{\\top}A^{-1}u}$。\n将此应用于 $(S^{(n)} - zI_n)^{-1}$，其中 $A = X^{(n)} - zI_n$, $u = \\theta v$ 及 $w = v$：\n$$\n(S^{(n)} - zI_n)^{-1} = (X^{(n)} - zI_n + \\theta v v^{\\top})^{-1} = R_X(z) - \\frac{R_X(z) (\\theta v) v^{\\top} R_X(z)}{1 + v^{\\top} R_X(z) (\\theta v)} = R_X(z) - \\frac{\\theta R_X(z) v v^{\\top} R_X(z)}{1 + \\theta v^{\\top} R_X(z) v}\n$$\n$S^{(n)}$ 的 Stieltjes 变换，记为 $m_S(z)$，通过取归一化迹得到：\n$$\nm_S(z) = \\frac{1}{n} \\text{Tr}\\left( (S^{(n)} - zI_n)^{-1} \\right) = \\frac{1}{n}\\text{Tr}(R_X(z)) - \\frac{1}{n} \\text{Tr}\\left( \\frac{\\theta R_X(z) v v^{\\top} R_X(z)}{1 + \\theta v^{\\top} R_X(z) v} \\right)\n$$\n第一项是 $X^{(n)}$ 的 Stieltjes 变换 $m_X(z)$。对于第二项，分母是一个标量，可以从迹中提取出来。利用迹的循环性质 $\\text{Tr}(AB) = \\text{Tr}(BA)$，我们可以简化分子中的迹：$\\text{Tr}(R_X(z) v v^{\\top} R_X(z)) = \\text{Tr}(v^{\\top} R_X(z)^2 v) = v^{\\top} R_X(z)^2 v$，因为标量的迹就是其本身。所以，\n$$\nm_S(z) = m_X(z) - \\frac{\\theta}{n} \\frac{v^{\\top} R_X(z)^2 v}{1 + \\theta v^{\\top} R_X(z) v}\n$$\n$S^{(n)}$ 的一个离群特征值 $\\lambda$ 是 $m_S(z)$ 的一个孤立实值极点。这样的极点只能由第二项的分母为零产生。因此，一个假定离群值的位置 $\\lambda$ 必须满足以下方程：\n$$\n1 + \\theta \\, v^{\\top} R_X(\\lambda) v = 0 \\quad \\implies \\quad v^{\\top} (X^{(n)} - \\lambda I_n)^{-1} v = -\\frac{1}{\\theta}\n$$\n这是离群特征值的基本方程。在大 $n$ 极限下，二次型 $v^{\\top} R_X(z) v$ 集中在其期望值附近。对于一个确定性的、非局域化的单位向量 $v$，这个量收敛于主体矩阵的极限 Stieltjes 变换。问题陈述中将其作为“各向同性近似” $\\langle v, (\\cdot) v \\rangle \\to m(z)$ 给出，这意味着 $v^{\\top} R_X(z) v \\to m(z)$，其中 $m(z) = \\lim_{n \\to \\infty} m_X(z)$。\n因此，离群特征值 $\\lambda$ 的极限方程是：\n$$\n1 + \\theta m(\\lambda) = 0 \\quad \\text{or} \\quad m(\\lambda) = -\\frac{1}{\\theta}\n$$\n这就是这类模型的一般离群特征值条件，用主体 Stieltjes 变换表示。\n\n接下来，我们将此应用于具体问题。矩阵 $X^{(n)}$ 的定义使得其经验谱分布收敛于 Wigner 半圆律。非对角线元素的方差被指定为 $1/n$。对于一个元素方差为 $\\sigma^2/n$ 的 Wigner 矩阵，其极限谱支撑在 $[-2\\sigma, 2\\sigma]$ 上。这里，$\\sigma^2=1$，所以支撑集是 $[-2, 2]$，正如问题所述。支撑在 $[-2, 2]$ 上的 Wigner 半圆律的 Stieltjes 变换由下式给出：\n$$\nm(z) = \\frac{-z + \\sqrt{z^2 - 4}}{2}\n$$\n对于 $z \\in \\mathbb{C} \\setminus [-2, 2]$。我们正在寻找一个从主体右边缘出现的离群值，所以我们考虑实数 $z  2$。\n将此代入离群值方程 $m(\\lambda) = -1/\\theta$：\n$$\n\\frac{-\\lambda + \\sqrt{\\lambda^2 - 4}}{2} = -\\frac{1}{\\theta}\n$$\n我们求解离群值位置 $\\lambda  2$ 与信号强度 $\\theta$ 的关系。我们假设 $\\theta0$，这对于在谱的右侧出现离群值是必要的（因为当 $\\lambda2$ 时，$m(\\lambda)0$）。\n$$\n-\\lambda + \\sqrt{\\lambda^2 - 4} = -\\frac{2}{\\theta}\n$$\n$$\n\\sqrt{\\lambda^2 - 4} = \\lambda - \\frac{2}{\\theta}\n$$\n为使实数解存在，右侧必须为非负，即 $\\lambda \\ge 2/\\theta$。两边平方：\n$$\n\\lambda^2 - 4 = \\left(\\lambda - \\frac{2}{\\theta}\\right)^2 = \\lambda^2 - \\frac{4\\lambda}{\\theta} + \\frac{4}{\\theta^2}\n$$\n$$\n-4 = -\\frac{4\\lambda}{\\theta} + \\frac{4}{\\theta^2}\n$$\n乘以 $-\\theta/4$：\n$$\n\\theta = \\lambda - \\frac{1}{\\theta}\n$$\n解出 $\\lambda$，我们找到离群特征值的位置：\n$$\n\\lambda = \\theta + \\frac{1}{\\theta}\n$$\nBBP 相变发生在 $\\theta$ 的临界值处，此时离群特征值首次从主体的连续谱中出现。为了使右侧存在离群值，其位置 $\\lambda$ 必须严格大于主体谱的右边缘，即 2。所以，我们需要找到使 $\\lambda  2$ 成立的 $\\theta$ 的条件。\n$$\n\\theta + \\frac{1}{\\theta}  2\n$$\n对于 $\\theta  0$，我们可以乘以 $\\theta$ 而不改变不等号方向：\n$$\n\\theta^2 + 1  2\\theta \\quad \\implies \\quad \\theta^2 - 2\\theta + 1  0 \\quad \\implies \\quad (\\theta - 1)^2  0\n$$\n这个不等式对所有正数 $\\theta$ 都成立，除了 $\\theta=1$。因此，当且仅当 $\\theta  1$ 时，主体右侧存在离群值。临界值 $\\theta_c$ 是该相变发生的阈值。这对应于等式成立的情况，即 $(\\theta_c - 1)^2 = 0$，得出 $\\theta_c = 1$。在这个临界值，离群值位于 $\\lambda = 1 + 1/1 = 2$，恰好在主体谱的边缘。对于任何 $\\theta  1$，离群值 $\\lambda = \\theta+1/\\theta$ 严格大于 2。\n\n当离群值首次从主体右边缘出现时，信号强度 $\\theta$ 的临界值为 1。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}