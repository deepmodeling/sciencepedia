{
    "hands_on_practices": [
        {
            "introduction": "The Heterogeneous Mean-field (HMF) theory provides a powerful framework for understanding epidemics on networks by reducing the system's complexity to a set of equations dependent only on node degree. The cornerstone of this theory is a self-consistency equation for $\\Theta$, the probability that a random edge points to an infected node. This first practice focuses on translating theory into computation by implementing an iterative solver to find the non-trivial (endemic) fixed point of these equations, allowing you to calculate the expected disease prevalence for diverse network structures .",
            "id": "4280361",
            "problem": "You are tasked with implementing a program that computes the endemic prevalence for the Susceptible-Infected-Susceptible (SIS) process in an uncorrelated network using the heterogeneous mean-field approximation. The network is specified by a degree distribution $P(k)$ over a finite, discrete support of nonnegative integers $k$, and the process parameters are the infection rate $\\lambda$ and the recovery rate $\\mu$. The endemic prevalence is defined as $\\rho = \\sum_{k} P(k)\\,\\rho_k$, where $\\rho_k$ denotes the steady-state infection probability for nodes of degree $k$. Assume an uncorrelated network and use iterative self-consistency to solve for the fixed-point solution in the steady state. If the problem is at the epidemic threshold or below the threshold, the iteration should converge to the disease-free fixed point, yielding $\\rho = 0$. All calculations are dimensionless.\n\nYour derivation and algorithm must start from first principles appropriate for heterogeneous mean-field theory under the assumptions of uncorrelated networks. Do not use or assume any shortcut formulas beyond those justified by the core definitions and well-tested facts about SIS dynamics and degree-based mean-field closures.\n\nYour program must implement the iterative self-consistency method to obtain the fixed point and compute the prevalence $\\rho$ for each of the following test cases. For each case, use the specified $P(k)$ and $(\\lambda,\\mu)$, with the understanding that the test suite includes both supercritical cases, where $\\lambda/\\mu > \\langle k\\rangle/\\langle k^2\\rangle$, and a boundary case where $\\lambda/\\mu = \\langle k\\rangle/\\langle k^2\\rangle$. Here, $\\langle k\\rangle = \\sum_k k\\,P(k)$ and $\\langle k^2\\rangle = \\sum_k k^2\\,P(k)$.\n\nTest Suite:\n- Case A (Poisson-like): $P(k)$ is proportional to the Poisson distribution with mean $z=4$ truncated to $k \\in \\{0,1,2,\\dots,30\\}$, i.e., $P(k) \\propto e^{-z} z^k / k!$ and renormalized over the truncation. Parameters: $\\lambda = 0.3$, $\\mu = 1$.\n- Case B (Scale-free): $P(k)$ is proportional to $k^{-\\gamma}$ over $k \\in \\{1,2,\\dots,100\\}$, with $\\gamma = 2.5$, renormalized. Parameters: $\\lambda = 0.2$, $\\mu = 1$.\n- Case C (Bimodal with isolated nodes): $P(0) = 0.5$, $P(10) = 0.5$, and $P(k) = 0$ otherwise. Parameters: $\\lambda = 0.12$, $\\mu = 1$.\n- Case D (Boundary case): Uniform distribution $P(k) = 1/5$ over $k \\in \\{1,2,3,4,5\\}$, zero otherwise. Parameters: $\\lambda = 3/11$, $\\mu = 1$.\n\nAlgorithmic requirements:\n- Use an iterative fixed-point solver for the degree-resolved infection probabilities $\\rho_k$ under the heterogeneous mean-field closure for uncorrelated networks. Initialize the iteration with a small, positive seed and iterate until convergence to a steady state.\n- Convergence criterion: terminate when the absolute change in the self-consistency variable between successive iterations is less than $10^{-12}$ or after $10^6$ iterations, whichever comes first.\n- Numerical stability: ensure that all probability values remain within the interval $[0,1]$ throughout the computation and that the degree distribution $P(k)$ is normalized to $\\sum_k P(k) = 1$.\n\nOutput:\n- For each case, output the prevalence $\\rho$ as a float rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.123456,0.234567,0.000000,0.345678]$).\n\nNo physical units are involved. Angles are not used. Percentages are not used; all outputs are pure decimal numbers.",
            "solution": "The problem is to compute the endemic prevalence of a Susceptible-Infected-Susceptible (SIS) process on an uncorrelated complex network, described by a degree distribution $P(k)$, using the heterogeneous mean-field (HMF) approximation. The solution requires deriving the governing equations from first principles and then implementing an iterative algorithm to solve them for several specified test cases.\n\nLet $\\rho_i(t)$ be the probability that a specific node $i$ is infected at time $t$. A susceptible node $i$ becomes infected by any of its infected neighbors. If a neighbor $j$ is infected, it transmits the disease to $i$ at rate $\\lambda$. An infected node $i$ recovers and becomes susceptible again at a rate $\\mu$. The evolution of $\\rho_i(t)$ is governed by:\n$$\n\\frac{d\\rho_i(t)}{dt} = (1 - \\rho_i(t)) \\lambda \\sum_{j \\in \\mathcal{N}(i)} I_j(t) - \\mu \\rho_i(t)\n$$\nwhere $\\mathcal{N}(i)$ is the set of neighbors of node $i$, and $I_j(t)$ is an indicator variable being $1$ if node $j$ is infected and $0$ otherwise.\n\nThe heterogeneous mean-field approximation simplifies this by assuming that all nodes with the same degree $k$ are statistically equivalent. Let $\\rho_k(t)$ be the average infection probability of a node with degree $k$. The equation for $\\rho_k(t)$ is obtained by averaging over all nodes of degree $k$ and applying a mean-field closure, which decouples the states of neighboring nodes.\n$$\n\\frac{d\\rho_k(t)}{dt} = (1 - \\rho_k(t)) \\lambda k \\Theta(t) - \\mu \\rho_k(t)\n$$\nHere, we have replaced the sum over neighbors $\\sum_{j} I_j(t)$ with its mean-field expectation, $k \\Theta(t)$. The term $\\Theta(t)$ is the crucial self-consistency variable, representing the probability that a randomly chosen edge in the network leads to an infected node.\n\nTo close this system of equations, we must express $\\Theta(t)$ in terms of the variables $\\rho_k(t)$. For an uncorrelated network, the probability that a randomly selected edge connects to a node of degree $k'$ is proportional to $k'P(k')$. This is because a node of degree $k'$ has $k'$ edges incident to it. The properly normalized probability is $\\frac{k'P(k')}{\\sum_{k''} k''P(k'')} = \\frac{k'P(k')}{\\langle k \\rangle}$, where $\\langle k \\rangle$ is the average degree of the network. Given that an edge leads to a node of degree $k'$, the probability this node is infected is $\\rho_{k'}(t)$. Summing over all possible degrees $k'$ of the target node yields the self-consistency equation for $\\Theta(t)$:\n$$\n\\Theta(t) = \\sum_{k'} \\frac{k'P(k')}{\\langle k \\rangle} \\rho_{k'}(t)\n$$\nIn the steady state, we set $\\frac{d\\rho_k(t)}{dt} = 0$. Let the steady-state quantities be $\\rho_k$ and $\\Theta$. The dynamical equation for $\\rho_k$ becomes an algebraic equation:\n$$\n(1 - \\rho_k) \\lambda k \\Theta - \\mu \\rho_k = 0\n$$\nSolving for $\\rho_k$, we find:\n$$\n\\rho_k = \\frac{\\lambda k \\Theta}{\\mu + \\lambda k \\Theta} = \\frac{\\beta k \\Theta}{1 + \\beta k \\Theta}\n$$\nwhere we have defined the effective infection rate $\\beta = \\lambda/\\mu$.\n\nSubstituting this expression for $\\rho_k$ back into the self-consistency equation for $\\Theta$, we obtain the fixed-point equation for $\\Theta$:\n$$\n\\Theta = \\sum_{k'} \\frac{k'P(k')}{\\langle k \\rangle} \\left( \\frac{\\beta k' \\Theta}{1 + \\beta k' \\Theta} \\right)\n$$\nThis equation always admits the trivial solution $\\Theta = 0$, which corresponds to the disease-free state where $\\rho_k = 0$ for all $k$, and the total prevalence $\\rho = \\sum_k P(k) \\rho_k = 0$.\n\nA non-trivial endemic state with $\\Theta  0$ is possible if the disease-free state is unstable. To find the condition for this, we analyze the behavior for small $\\Theta$. For $\\Theta \\to 0$, we have $\\frac{\\beta k' \\Theta}{1 + \\beta k' \\Theta} \\approx \\beta k' \\Theta$. The fixed-point equation becomes:\n$$\n\\Theta \\approx \\sum_{k'} \\frac{k'P(k')}{\\langle k \\rangle} (\\beta k' \\Theta) = \\frac{\\beta \\Theta}{\\langle k \\rangle} \\sum_{k'} (k')^2 P(k') = \\frac{\\beta \\langle k^2 \\rangle}{\\langle k \\rangle} \\Theta\n$$\nA non-trivial solution can emerge if the coefficient of $\\Theta$ on the right-hand side is greater than $1$. This gives the epidemic threshold condition:\n$$\n\\frac{\\beta \\langle k^2 \\rangle}{\\langle k \\rangle}  1 \\quad \\implies \\quad \\frac{\\lambda}{\\mu}  \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}\n$$\nwhere $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$ is the second moment of the degree distribution.\n\nThe algorithm to find the endemic prevalence $\\rho$ is an iterative procedure to solve for the fixed point $\\Theta$. Let the mapping be $G(\\Theta) = \\sum_{k} \\frac{kP(k)}{\\langle k \\rangle} \\frac{\\beta k \\Theta}{1 + \\beta k \\Theta}$. The algorithm is:\n1. Initialize the iteration with a small positive seed value $\\Theta_0  0$, for instance, $\\Theta_0 = 10^{-6}$.\n2. Iterate $\\Theta_{n+1} = G(\\Theta_n)$ for $n=0, 1, 2, \\dots$.\n3. Stop when the change between successive iterates is negligible, i.e., $|\\Theta_{n+1} - \\Theta_n|  10^{-12}$, or after a maximum of $10^6$ iterations. Let the converged value be $\\Theta^*$.\n4. If the iteration converges to $\\Theta^* \\approx 0$ (which occurs when the system is at or below the epidemic threshold), the prevalence is $\\rho = 0$.\n5. If $\\Theta^*  0$, calculate the degree-dependent prevalences $\\rho_k = \\frac{\\beta k \\Theta^*}{1 + \\beta k \\Theta^*}$ for all $k$.\n6. Compute the total average prevalence $\\rho = \\sum_k P(k)\\rho_k$.\n\nThis procedure is implemented for each test case. The degree distribution $P(k)$ for each case must first be constructed and normalized such that $\\sum_k P(k) = 1$. The moments $\\langle k \\rangle$ and $\\langle k^2 \\rangle$ are computed from this normalized distribution. The iterative solver then finds $\\Theta^*$, from which the final prevalence $\\rho$ is determined and rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import factorial\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute the SIS prevalence for each.\n    The final results are printed in the specified format.\n    \"\"\"\n\n    def solve_prevalence(degrees, p_k_unnormalized, lambda_val, mu_val):\n        \"\"\"\n        Computes endemic prevalence for the SIS model on an uncorrelated network\n        using the heterogeneous mean-field approximation.\n\n        Args:\n            degrees (np.ndarray): Array of degree values k.\n            p_k_unnormalized (np.ndarray): Array of unnormalized probabilities P(k).\n            lambda_val (float): Infection rate.\n            mu_val (float): Recovery rate.\n\n        Returns:\n            float: The computed total prevalence rho.\n        \"\"\"\n        # Step 1: Prepare inputs\n        degrees = np.array(degrees, dtype=np.float64)\n        p_k = np.array(p_k_unnormalized, dtype=np.float64)\n        \n        # Normalize the degree distribution\n        p_k_sum = np.sum(p_k)\n        if p_k_sum > 0:\n            p_k /= p_k_sum\n        else: # Trivial case with no nodes\n            return 0.0\n\n        # Step 2: Calculate moments of the degree distribution\n        k_mean = np.sum(p_k * degrees)\n        \n        # If mean degree is 0, no links exist, thus no spread is possible.\n        if k_mean == 0.0:\n            return 0.0\n\n        # Step 3: Setup for iterative solver\n        beta = lambda_val / mu_val\n        theta = 1e-6  # Small positive seed for the iteration\n        max_iter = 1_000_000\n        tolerance = 1e-12\n\n        # Step 4: Iteratively solve for the fixed point Theta\n        for _ in range(max_iter):\n            theta_old = theta\n            \n            # The heart of the self-consistency equation for Theta\n            # Theta_new = (1/k) * sum_k( k * P(k) * rho_k(Theta_old) )\n            # where rho_k = (beta * k * Theta) / (1 + beta * k * Theta)\n            \n            # Vectorized calculation for the sum term\n            # Denominator: 1 + beta * k * theta\n            # Numerator of sum term: k * P(k) * (beta * k * theta)\n            denominator = 1.0 + beta * degrees * theta_old\n            sum_terms = (degrees * p_k * (beta * degrees * theta_old)) / denominator\n            \n            theta = np.sum(sum_terms) / k_mean\n            \n            # Check for convergence\n            if abs(theta - theta_old)  tolerance:\n                break\n        \n        # If theta converges to a value smaller than the tolerance,\n        # it is effectively zero (disease-free state).\n        if theta  tolerance:\n            return 0.0\n\n        # Step 5: Calculate final prevalence from the converged Theta\n        # rho_k = (beta * k * theta) / (1 + beta * k * theta)\n        rho_k_vec = (beta * degrees * theta) / (1.0 + beta * degrees * theta)\n        \n        # rho = sum_k P(k) * rho_k\n        rho = np.sum(p_k * rho_k_vec)\n        \n        return rho\n\n    # Definition of test cases from the problem statement\n    \n    # Case A: Poisson-like distribution\n    z_a = 4.0\n    k_max_a = 30\n    degrees_a = np.arange(k_max_a + 1)\n    p_k_unnormalized_a = np.exp(-z_a) * (z_a**degrees_a) / factorial(degrees_a)\n    params_a = (degrees_a, p_k_unnormalized_a, 0.3, 1.0)\n\n    # Case B: Scale-free distribution\n    gamma_b = 2.5\n    k_max_b = 100\n    degrees_b = np.arange(1, k_max_b + 1)\n    p_k_unnormalized_b = degrees_b**(-gamma_b)\n    params_b = (degrees_b, p_k_unnormalized_b, 0.2, 1.0)\n\n    # Case C: Bimodal distribution\n    degrees_c = np.array([0, 10])\n    p_k_unnormalized_c = np.array([0.5, 0.5])  # Already normalized\n    params_c = (degrees_c, p_k_unnormalized_c, 0.12, 1.0)\n    \n    # Case D: Uniform distribution (boundary case)\n    degrees_d = np.arange(1, 6)\n    p_k_unnormalized_d = np.ones_like(degrees_d) # Proportional to 1\n    params_d = (degrees_d, p_k_unnormalized_d, 3.0/11.0, 1.0)\n\n    test_cases = [params_a, params_b, params_c, params_d]\n    \n    results = []\n    for case in test_cases:\n        degrees, pk_un, lam, mu = case\n        prevalence = solve_prevalence(degrees, pk_un, lam, mu)\n        results.append(f\"{prevalence:.6f}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond simply calculating the final endemic prevalence, mean-field theories offer deep insights into the nature of the epidemic transition itself. This practice shifts from numerical solution to analytical derivation, focusing on the system's behavior infinitesimally close to the epidemic threshold, $\\lambda_c$. By linearizing the HMF equations, you will derive the critical exponent $\\beta$, which describes how the prevalence $\\rho$ scales with the distance from the critical point, as in $\\rho \\sim (\\lambda - \\lambda_c)^{\\beta}$, a hallmark of continuous phase transitions .",
            "id": "4280365",
            "problem": "Consider a continuous-time Susceptible-Infected-Susceptible (SIS) process on a large, sparse, uncorrelated network with degree distribution $P(k)$ and finite moments up to $\\langle k^{3} \\rangle$. The infection rate per contact is $\\lambda$ and the recovery rate is $\\mu$. In the heterogeneous mean-field (HMF) description, all nodes of equal degree $k$ share the same instantaneous infection probability $\\rho_{k}(t)$, and the probability that a randomly chosen edge points to an infected node is denoted by $\\Theta(t)$. For uncorrelated networks, the annealed approximation implies $\\Theta(t) = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_{k}(t)$.\n\nStarting from fundamental definitions of the SIS dynamics and the heterogeneous mean-field approximation, derive the near-threshold scaling of the stationary prevalence $\\rho \\equiv \\sum_{k} P(k)\\,\\rho_{k}$ as a function of the distance to the epidemic threshold, $(\\lambda - \\lambda_{c})$, by linearizing the steady-state HMF equations around the threshold. Define the critical exponent $\\beta$ via the relation $\\rho \\sim (\\lambda - \\lambda_{c})^{\\beta}$ as $\\lambda \\downarrow \\lambda_{c}^{+}$, and determine its value under the stated assumptions.\n\nYour final answer must be the value of the exponent $\\beta$ as a single real number. No rounding is needed. If you introduce any additional symbols, define them clearly within your derivation. No physical units are required in the final answer.",
            "solution": "The problem asks for the derivation of the critical exponent $\\beta$ governing the scaling of the stationary prevalence $\\rho$ near the epidemic threshold $\\lambda_c$ for a continuous-time Susceptible-Infected-Susceptible (SIS) model on a heterogeneous network. The scaling relation is given by $\\rho \\sim (\\lambda - \\lambda_c)^{\\beta}$ as the infection rate $\\lambda$ approaches the threshold $\\lambda_c$ from above. We will use the heterogeneous mean-field (HMF) approximation.\n\nFirst, we establish the dynamical equation for the probability $\\rho_k(t)$ that a node of degree $k$ is infected at time $t$. A susceptible node of degree $k$, which occurs with probability $(1 - \\rho_k(t))$, becomes infected by contact with any of its $k$ neighbors. The probability that a randomly chosen neighbor is infected is given by $\\Theta(t)$. With an infection rate per contact of $\\lambda$, the rate of infection for a susceptible node of degree $k$ is $\\lambda k \\Theta(t)$. An infected node of degree $k$ recovers at a rate $\\mu$. Combining these processes, the evolution of $\\rho_k(t)$ is described by the rate equation:\n$$ \\frac{d\\rho_k(t)}{dt} = \\lambda k (1 - \\rho_k(t)) \\Theta(t) - \\mu \\rho_k(t) $$\nThe quantity $\\Theta(t)$ is the probability that a randomly chosen edge points to an infected node. For an uncorrelated network, it is given by the self-consistency condition:\n$$ \\Theta(t) = \\sum_j \\frac{j P(j)}{\\langle k \\rangle} \\rho_j(t) $$\nwhere $\\langle k \\rangle = \\sum_k k P(k)$ is the average degree of the network.\n\nTo find the stationary prevalence, we analyze the steady-state behavior by setting $\\frac{d\\rho_k(t)}{dt} = 0$. Let $\\rho_k$ and $\\Theta$ denote the stationary values of $\\rho_k(t)$ and $\\Theta(t)$, respectively. The steady-state equation for $\\rho_k$ is:\n$$ \\lambda k (1 - \\rho_k) \\Theta - \\mu \\rho_k = 0 $$\nSolving for $\\rho_k$, we get:\n$$ \\lambda k \\Theta = \\rho_k (\\mu + \\lambda k \\Theta) $$\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu + \\lambda k \\Theta} $$\nThis equation shows that $\\rho_k = 0$ for all $k$ (which implies $\\Theta = 0$) is always a trivial solution, corresponding to the disease-free state.\n\nThe epidemic threshold, $\\lambda_c$, is the critical value of $\\lambda$ at which a non-trivial solution (i.e., an endemic state with $\\Theta  0$) first appears. To find $\\lambda_c$, we linearize the system around the disease-free state. For a small but non-zero $\\Theta \\ll 1$, we can approximate $\\rho_k$ to the first order in $\\Theta$:\n$$ \\rho_k \\approx \\frac{\\lambda k \\Theta}{\\mu} $$\nSubstituting this linear approximation into the self-consistency equation for $\\Theta$:\n$$ \\Theta = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\rho_k \\approx \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k \\Theta}{\\mu} \\right) $$\nFor the endemic state, we assume $\\Theta  0$ and can divide by it:\n$$ 1 = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\frac{\\lambda k}{\\mu} = \\frac{\\lambda}{\\mu \\langle k \\rangle} \\sum_k k^2 P(k) $$\nUsing the definition of the second moment of the degree distribution, $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$, we have:\n$$ 1 = \\frac{\\lambda \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\nThis equation holds at the threshold, defining the critical infection rate $\\lambda_c$:\n$$ \\lambda_c = \\frac{\\mu \\langle k \\rangle}{\\langle k^2 \\rangle} $$\n\nNow, to find the scaling of the prevalence near the threshold, we analyze the system for $\\lambda$ slightly above $\\lambda_c$. Let $\\lambda = \\lambda_c + \\epsilon$, where $\\epsilon$ is a small positive parameter, $\\epsilon = \\lambda - \\lambda_c  0$. In this regime, the stationary prevalence is small, so $\\Theta$ is small. We need to expand the expression for $\\rho_k$ to a higher order in $\\Theta$.\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu + \\lambda k \\Theta} = \\frac{(\\lambda k / \\mu) \\Theta}{1 + (\\lambda k / \\mu) \\Theta} $$\nUsing the Taylor expansion $(1+x)^{-1} = 1 - x + x^2 - \\dots$ for small $x = (\\lambda k / \\mu) \\Theta$:\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu} \\left( 1 - \\frac{\\lambda k \\Theta}{\\mu} + \\mathcal{O}(\\Theta^2) \\right) = \\frac{\\lambda k}{\\mu}\\Theta - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta^2 + \\mathcal{O}(\\Theta^3) $$\nSubstitute this expansion back into the self-consistency equation for $\\Theta$:\n$$ \\Theta = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\rho_k = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k}{\\mu}\\Theta - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta^2 + \\mathcal{O}(\\Theta^3) \\right) $$\nAssuming $\\Theta \\ne 0$, we divide by $\\Theta$:\n$$ 1 = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k}{\\mu} - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta + \\mathcal{O}(\\Theta^2) \\right) $$\nSeparating the sums:\n$$ 1 = \\frac{\\lambda}{\\mu \\langle k \\rangle} \\sum_k k^2 P(k) - \\frac{\\lambda^2 \\Theta}{\\mu^2 \\langle k \\rangle} \\sum_k k^3 P(k) + \\mathcal{O}(\\Theta^2) $$\nUsing the moment notation $\\langle k^n \\rangle = \\sum_k k^n P(k)$:\n$$ 1 = \\frac{\\lambda \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} - \\frac{\\lambda^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta + \\mathcal{O}(\\Theta^2) $$\nNow, substitute $\\lambda = \\lambda_c + \\epsilon$. In the term proportional to $\\Theta$, which is already small, we can approximate $\\lambda \\approx \\lambda_c$ as the correction would be of higher order, i.e., $\\mathcal{O}(\\epsilon \\Theta)$.\n$$ 1 \\approx \\frac{(\\lambda_c + \\epsilon) \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} - \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta $$\nThe first term can be expanded:\n$$ \\frac{(\\lambda_c + \\epsilon) \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} = \\frac{\\lambda_c \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} + \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\nBy definition of $\\lambda_c$, the first part of this expression is equal to $1$. So, the equation becomes:\n$$ 1 \\approx \\left( 1 + \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} \\right) - \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta $$\nRearranging the terms to solve for $\\Theta$:\n$$ \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta \\approx \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\n$$ \\Theta \\approx \\epsilon \\left( \\frac{\\mu \\langle k^2 \\rangle}{\\lambda_c^2 \\langle k^3 \\rangle} \\right) $$\nSince $\\epsilon = \\lambda - \\lambda_c$, this shows that $\\Theta$ is directly proportional to the distance from the critical point:\n$$ \\Theta \\propto (\\lambda - \\lambda_c) $$\nFinally, we need to find the scaling of the total prevalence $\\rho = \\sum_k P(k) \\rho_k$. Near the threshold, $\\Theta$ is small, so we can use the first-order approximation for $\\rho_k$:\n$$ \\rho_k \\approx \\frac{\\lambda k \\Theta}{\\mu} \\approx \\frac{\\lambda_c k \\Theta}{\\mu} $$\nwhere we have again used $\\lambda \\approx \\lambda_c$ as $\\Theta$ is already of order $\\epsilon$.\nSubstituting this into the definition of $\\rho$:\n$$ \\rho = \\sum_k P(k) \\rho_k \\approx \\sum_k P(k) \\left( \\frac{\\lambda_c k \\Theta}{\\mu} \\right) = \\frac{\\lambda_c \\Theta}{\\mu} \\sum_k k P(k) = \\frac{\\lambda_c \\langle k \\rangle}{\\mu} \\Theta $$\nSince $\\frac{\\lambda_c \\langle k \\rangle}{\\mu}$ is a constant, the prevalence $\\rho$ scales linearly with $\\Theta$:\n$$ \\rho \\propto \\Theta $$\nCombining this with our result for $\\Theta$, we find the scaling of $\\rho$ with respect to $\\lambda - \\lambda_c$:\n$$ \\rho \\propto (\\lambda - \\lambda_c)^1 $$\nThe problem defines the critical exponent $\\beta$ through the relation $\\rho \\sim (\\lambda - \\lambda_c)^{\\beta}$. By comparing our derived scaling, we conclude that the exponent is $\\beta = 1$. This is a characteristic result for mean-field theories of phase transitions.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "The elegance of Heterogeneous Mean-field (HMF) theory lies in its simplification: it replaces the network's specific wiring with a statistical degree distribution, assuming no degree correlations. But when is this assumption justified? This final practice challenges you to critically evaluate the accuracy of HMF by comparing its predictions against those from the more detailed Quenched Mean-Field (QMF) model, which retains the full network topology. By implementing both models and testing them on networks with different structural properties, you will gain a practical understanding of HMF's limitations and develop an intuition for when its powerful approximations are most reliable .",
            "id": "4280379",
            "problem": "You are given three undirected, unweighted networks specified by their adjacency matrices. Consider the Susceptible-Infected-Susceptible (SIS) process with infection rate $\\beta$ and recovery rate $\\mu$. Define the effective infection rate as $\\lambda = \\beta / \\mu$, which is dimensionless. You will analyze the SIS dynamics using two mean-field descriptions:\n- Quenched Mean-Field (QMF): node-level description.\n- Heterogeneous Mean-Field (HMF): degree-class description for uncorrelated networks.\n\nFoundational definitions to use:\n- Let $A \\in \\{0,1\\}^{N \\times N}$ be a symmetric adjacency matrix with zeros on the diagonal. Let $k_i = \\sum_{j} A_{ij}$ be node degrees, $\\langle k \\rangle = \\frac{1}{N} \\sum_{i=1}^N k_i$, and $\\langle k^2 \\rangle = \\frac{1}{N} \\sum_{i=1}^N k_i^2$. Let $P(k)$ be the empirical degree distribution over the network nodes. Let $\\Lambda_{\\max}(A)$ denote the largest eigenvalue of $A$.\n- In Quenched Mean-Field (QMF), the node-level infection probabilities $x_i(t) \\in [0,1]$ evolve as $\\frac{dx_i}{dt} = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$. A stationary solution satisfies $0 = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$. The total stationary prevalence is $\\rho_{\\mathrm{QMF}} = \\frac{1}{N} \\sum_{i=1}^N x_i^\\ast$.\n- In Heterogeneous Mean-Field (HMF) for uncorrelated networks, the degree-class infection probabilities $\\rho_k(t) \\in [0,1]$ satisfy $\\frac{d \\rho_k}{dt} = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$, where $\\Theta$ is the probability that a randomly chosen edge points to an infected node. At stationarity, $0 = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$. The self-consistency relation is $\\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_k$. The total stationary prevalence is $\\rho_{\\mathrm{HMF}} = \\sum_k P(k) \\rho_k^\\ast$.\n\nYour tasks:\n1. Starting only from the above foundational definitions, derive the critical effective infection rate thresholds for the onset of a nontrivial stationary solution:\n   - The QMF threshold $\\lambda_c^{\\mathrm{QMF}}$.\n   - The HMF threshold $\\lambda_c^{\\mathrm{HMF}}$.\n   Your derivations must be linear stability analyses around the disease-free state.\n2. Implement numerical solvers for the stationary solutions:\n   - For QMF, solve the nonlinear fixed-point equations for $x_i^\\ast$ for a given $\\lambda$.\n   - For HMF, assuming no degree-degree correlations, solve the degree-based fixed-point equations and the self-consistency equation for $\\Theta$ for a given $\\lambda$.\n   Use $\\mu = 1$ without loss of generality. All quantities are dimensionless.\n3. Accuracy assessment protocol:\n   - For each network and for $\\lambda \\in \\{0.1, 0.2, 0.3, 0.5, 0.8, 1.0, 2.0\\}$, compute $\\rho_{\\mathrm{QMF}}(\\lambda)$ and $\\rho_{\\mathrm{HMF}}(\\lambda)$.\n   - Define the relative error $E(\\lambda) = \\frac{\\left|\\rho_{\\mathrm{HMF}}(\\lambda) - \\rho_{\\mathrm{QMF}}(\\lambda)\\right|}{\\max\\left(\\rho_{\\mathrm{QMF}}(\\lambda), \\varepsilon\\right)}$ with $\\varepsilon = 10^{-8}$ to avoid division by zero.\n   - Declare HMF \"accurate\" at that $\\lambda$ if $E(\\lambda) \\leq 0.1$, otherwise \"inaccurate.\"\n4. Compute both thresholds and determine the parameter regimes where HMF provides accurate predictions (and where it fails) according to the above protocol.\n\nTest suite:\nUse the following three adjacency matrices. The node indexing is $0,1,\\dots,N-1$. All matrices are symmetric and have zero diagonal. The dimensionless effective infection rate values to test are the seven-element set above. For each matrix, compute both thresholds and the accuracy flags for the seven $\\lambda$ values.\n\n- Case A (ring with $N=10$):\n  Adjacency $A_{ij} = 1$ if $j = (i \\pm 1) \\bmod 10$, else $0$.\n- Case B (star with $N=10$):\n  Adjacency $A_{0j} = A_{j0} = 1$ for $j \\in \\{1,\\dots,9\\}$; all other off-diagonal entries $0$.\n- Case C (moderately heterogeneous $N=10$) with edges:\n  $\\{(0,1),(1,2),(2,3),(3,4),(4,5),(5,0),(6,7),(7,8),(8,9),(9,6),(2,6),(4,7),(1,8),(5,9),(0,3),(0,6),(0,7)\\}$; interpret edges as undirected.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each entry corresponds to one adjacency matrix, in the order A, B, C, and must be a list of the form $[\\lambda_c^{\\mathrm{HMF}}, \\lambda_c^{\\mathrm{QMF}}, \\text{acc\\_flags}]$, where:\n  - $\\lambda_c^{\\mathrm{HMF}}$ and $\\lambda_c^{\\mathrm{QMF}}$ are floats rounded to six decimal places.\n  - $\\text{acc\\_flags}$ is a list of $7$ integers (one per $\\lambda$ in the order given) equal to $1$ if HMF is accurate and $0$ otherwise.\n- Example schematic (not actual values): $[[0.123456,0.234567,[1,0,1,1,0,1,1]],[\\dots],[\\dots]]$.\n\nAll quantities are dimensionless; no physical units apply. Angles are not involved. Percentages must not be used; use only decimals. The program must be complete and runnable and must produce exactly one line as specified, with no additional text.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective, providing all necessary information for a complete solution.\n\nThe problem requires the derivation of epidemic thresholds for two mean-field models of an SIS process on a network and a numerical comparison of their predictions. The two models are the Quenched Mean-Field (QMF) theory, a node-level description, and the Heterogeneous Mean-Field (HMF) theory, a degree-class-level description.\n\n**1. Derivation of Critical Thresholds**\n\nThe critical threshold $\\lambda_c$ marks the point where the disease-free state ($x_i=0$ for all nodes $i$, or $\\rho_k=0$ for all degrees $k$) loses stability, allowing for an endemic steady state to exist. We find this threshold by performing a linear stability analysis of the governing equations around this disease-free fixed point.\n\n**Quenched Mean-Field (QMF) Threshold ($\\lambda_c^{\\mathrm{QMF}}$)**\n\nThe QMF dynamics are given by $\\frac{dx_i}{dt} = F_i(\\vec{x}) = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$.\nTo analyze the stability of the fixed point $\\vec{x}=\\vec{0}$, we examine the Jacobian matrix $J$ of the system evaluated at this point. The elements of the Jacobian are $J_{ij} = \\frac{\\partial F_i}{\\partial x_j}|_{\\vec{x}=0}$.\n$$ \\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( -\\mu x_i + \\beta \\sum_{k} A_{ik} x_k - \\beta x_i \\sum_{k} A_{ik} x_k \\right) $$\n$$ \\frac{\\partial F_i}{\\partial x_j} = -\\mu \\delta_{ij} + \\beta A_{ij} - \\beta \\delta_{ij} \\sum_{k} A_{ik} x_k - \\beta x_i A_{ij} $$\nEvaluating at $\\vec{x}=\\vec{0}$:\n$$ J_{ij} = \\frac{\\partial F_i}{\\partial x_j}\\bigg|_{\\vec{x}=0} = -\\mu \\delta_{ij} + \\beta A_{ij} $$\nIn matrix form, the Jacobian is $J = \\beta A - \\mu I$, where $A$ is the adjacency matrix and $I$ is the identity matrix. The disease-free state becomes unstable when the largest eigenvalue of $J$ becomes positive. The eigenvalues of $J$ are $\\eta_k = \\beta \\Lambda_k(A) - \\mu$, where $\\Lambda_k(A)$ are the eigenvalues of $A$. The largest eigenvalue of $J$ is $\\eta_{\\max} = \\beta \\Lambda_{\\max}(A) - \\mu$, where $\\Lambda_{\\max}(A)$ is the largest eigenvalue of $A$.\nThe instability condition is $\\eta_{\\max}  0$:\n$$ \\beta \\Lambda_{\\max}(A) - \\mu  0 \\implies \\frac{\\beta}{\\mu} \\Lambda_{\\max}(A)  1 $$\nUsing the definition of the effective infection rate $\\lambda = \\beta/\\mu$, the condition is $\\lambda \\Lambda_{\\max}(A)  1$. The critical threshold is the value of $\\lambda$ at which this inequality becomes an equality.\n$$ \\lambda_c^{\\mathrm{QMF}} = \\frac{1}{\\Lambda_{\\max}(A)} $$\n\n**Heterogeneous Mean-Field (HMF) Threshold ($\\lambda_c^{\\mathrm{HMF}}$)**\n\nThe HMF stationary state is given by the equations:\n1. $0 = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$\n2. $\\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_k$\n\nThe disease-free state corresponds to $\\rho_k = 0$ for all $k$, and thus $\\Theta = 0$. We linearize around this state by letting $\\rho_k = \\epsilon_k$ and $\\Theta = \\delta$, where these are infinitesimal quantities.\nFrom equation (1), we linearize by dropping the $\\rho_k \\Theta$ term:\n$$ 0 \\approx -\\mu \\epsilon_k + \\beta k \\Theta \\implies \\epsilon_k = \\frac{\\beta k}{\\mu} \\Theta = \\lambda k \\Theta $$\nSubstituting this linear relationship into the self-consistency equation (2), which is already linear:\n$$ \\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} (\\lambda k \\Theta) $$\nFor a non-trivial solution ($\\Theta  0$), we can divide by $\\Theta$:\n$$ 1 = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} (\\lambda k) = \\frac{\\lambda}{\\langle k \\rangle} \\sum_{k} k^2 P(k) $$\nThe term $\\sum_{k} k^2 P(k)$ is the second moment of the degree distribution, $\\langle k^2 \\rangle$.\n$$ 1 = \\frac{\\lambda}{\\langle k \\rangle} \\langle k^2 \\rangle $$\nSolving for the critical value of $\\lambda$:\n$$ \\lambda_c^{\\mathrm{HMF}} = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle} $$\n\n**2. Numerical Solution Strategy**\n\nWe set $\\mu=1$ without loss of generality, so $\\lambda = \\beta$. All quantities are dimensionless.\n\n**QMF Solver:** The stationary state for QMF is found by solving the system of $N$ nonlinear equations for the node-level prevalences $x_i^*$:\n$$ x_i^* = \\frac{\\lambda \\sum_{j} A_{ij} x_j^*}{1 + \\lambda \\sum_j A_{ij} x_j^*} $$\nThis system is solved using fixed-point iteration. We initialize the prevalence vector $\\vec{x}$ with small positive values (e.g., $x_i^{(0)} = 10^{-5}$) and iterate $\\vec{x}^{(t+1)} = F(\\vec{x}^{(t)})$ where $F_i(\\vec{x}) = \\frac{\\lambda (A\\vec{x})_i}{1 + \\lambda (A\\vec{x})_i}$. The iteration proceeds until the maximum absolute difference between successive vectors, $\\|\\vec{x}^{(t+1)} - \\vec{x}^{(t)}\\|_\\infty$, falls below a small tolerance (e.g., $10^{-9}$). If $\\lambda \\leq \\lambda_c^{\\mathrm{QMF}}$, this process converges to $\\vec{x}^* = \\vec{0}$. The total prevalence is then $\\rho_{\\mathrm{QMF}} = \\frac{1}{N}\\sum_i x_i^*$.\n\n**HMF Solver:** The HMF stationary state is found by solving for $\\Theta$, the probability that an edge points to an infected node. First, we express $\\rho_k$ in terms of $\\Theta$ from the primary HMF equation:\n$$ \\rho_k^* = \\frac{\\lambda k \\Theta^*}{1 + \\lambda k \\Theta^*} $$\nSubstituting this into the self-consistency equation gives a single nonlinear equation for $\\Theta^*$:\n$$ \\Theta^* = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k \\Theta^*}{1 + \\lambda k \\Theta^*} \\right) $$\nThis equation is also solved via fixed-point iteration. Starting with an initial guess $\\Theta^{(0)}  0$ (e.g., $0.1$), we iterate $\\Theta^{(t+1)} = G(\\Theta^{(t)})$ until convergence, where $G$ is the right-hand side of the equation. If $\\lambda \\leq \\lambda_c^{\\mathrm{HMF}}$, this converges to $\\Theta^* = 0$. Once $\\Theta^*$ is found, the total prevalence is computed as $\\rho_{\\mathrm{HMF}} = \\sum_k P(k) \\rho_k^*$.\n\n**3. Accuracy Assessment**\n\nFor each network and each provided value of $\\lambda$, we compute the total prevalences $\\rho_{\\mathrm{QMF}}(\\lambda)$ and $\\rho_{\\mathrm{HMF}}(\\lambda)$. The relative error $E(\\lambda)$ is calculated to quantify the discrepancy between the HMF approximation and the more detailed QMF model:\n$$ E(\\lambda) = \\frac{\\left|\\rho_{\\mathrm{HMF}}(\\lambda) - \\rho_{\\mathrm{QMF}}(\\lambda)\\right|}{\\max\\left(\\rho_{\\mathrm{QMF}}(\\lambda), \\varepsilon\\right)}, \\quad \\text{with } \\varepsilon = 10^{-8} $$\nHMF is deemed \"accurate\" if $E(\\lambda) \\leq 0.1$. The results are reported as a series of binary flags for each network and value of $\\lambda$. The HMF model is based on the assumption of no degree-degree correlations (i.e., the network is uncorrelated), so its accuracy will diminish in networks with strong correlations, such as the star graph. For regular graphs, HMF is exact.",
            "answer": "```python\nimport numpy as np\n\ndef build_networks():\n    \"\"\"\n    Builds the adjacency matrices for the three test cases.\n    \"\"\"\n    # Case A: Ring network, N=10\n    A_ring = np.zeros((10, 10), dtype=float)\n    for i in range(10):\n        A_ring[i, (i + 1) % 10] = 1\n        A_ring[i, (i - 1 + 10) % 10] = 1\n\n    # Case B: Star network, N=10\n    A_star = np.zeros((10, 10), dtype=float)\n    A_star[0, 1:] = 1\n    A_star[1:, 0] = 1\n\n    # Case C: Moderately heterogeneous network, N=10\n    edges_c = [\n        (0,1),(1,2),(2,3),(3,4),(4,5),(5,0),(6,7),(7,8),(8,9),(9,6),\n        (2,6),(4,7),(1,8),(5,9),(0,3),(0,6),(0,7)\n    ]\n    A_hetero = np.zeros((10, 10), dtype=float)\n    for i, j in edges_c:\n        A_hetero[i, j] = 1\n        A_hetero[j, i] = 1\n        \n    return [A_ring, A_star, A_hetero]\n\ndef solve_qmf(A, lam, N, tol=1e-9, max_iter=2000):\n    \"\"\"\n    Solves for the stationary prevalence in the Quenched Mean-Field model.\n    \"\"\"\n    x = np.full(N, 1e-5, dtype=float)  # Initial small positive prevalence\n    for _ in range(max_iter):\n        Ax = A @ x\n        with np.errstate(divide='ignore', invalid='ignore'):\n             x_new = (lam * Ax) / (1.0 + lam * Ax)\n        x_new[np.isnan(x_new)] = 0.0 # Handle potential division by zero\n        \n        if np.linalg.norm(x_new - x, ord=np.inf)  tol:\n            x = x_new\n            break\n        x = x_new\n        \n    return np.mean(x)\n\ndef solve_hmf(lam, k_mean, degree_dist, tol=1e-9, max_iter=2000):\n    \"\"\"\n    Solves for the stationary prevalence in the Heterogeneous Mean-Field model.\n    \"\"\"\n    if k_mean == 0:\n        return 0.0\n\n    # Initial guess for Theta  0 to find endemic solution if it exists\n    theta = 0.1\n    \n    k_vals = np.array(list(degree_dist.keys()), dtype=float)\n    pk_vals = np.array(list(degree_dist.values()), dtype=float)\n    \n    for _ in range(max_iter):\n        # Calculate rho_k for the current theta\n        rho_k = (lam * k_vals * theta) / (1.0 + lam * k_vals * theta)\n        \n        # Update theta using the self-consistency equation\n        theta_new = np.sum(k_vals * pk_vals * rho_k) / k_mean\n        \n        if abs(theta_new - theta)  tol:\n            theta = theta_new\n            break\n        theta = theta_new\n        \n    # Calculate final prevalence using the converged theta\n    rho_k_final = (lam * k_vals * theta) / (1.0 + lam * k_vals * theta)\n    rho_hmf = np.sum(pk_vals * rho_k_final)\n    \n    return rho_hmf\n\ndef process_network(A, lambdas):\n    \"\"\"\n    Computes thresholds and accuracy flags for a single network.\n    \"\"\"\n    N = A.shape[0]\n    \n    # 1. Compute network statistics and thresholds\n    degrees = A.sum(axis=1)\n    k_mean = np.mean(degrees)\n    k2_mean = np.mean(degrees**2)\n    \n    lambda_c_hmf = k_mean / k2_mean if k2_mean  0 else float('inf')\n\n    eigenvalues = np.linalg.eigvalsh(A)\n    lambda_max = np.max(eigenvalues)\n    lambda_c_qmf = 1.0 / lambda_max if lambda_max  1e-9 else float('inf')\n\n    # Get degree distribution P(k)\n    unique_degrees, counts = np.unique(degrees, return_counts=True)\n    degree_dist = {int(k): p for k, p in zip(unique_degrees, counts / N)}\n\n    # 2. Loop over lambdas to solve and assess accuracy\n    acc_flags = []\n    epsilon = 1e-8\n    \n    for lam in lambdas:\n        rho_qmf = solve_qmf(A, lam, N)\n        rho_hmf = solve_hmf(lam, k_mean, degree_dist)\n        \n        # 3. Accuracy assessment\n        error = np.abs(rho_hmf - rho_qmf) / max(rho_qmf, epsilon)\n        acc_flags.append(1 if error = 0.1 else 0)\n        \n    return [lambda_c_hmf, lambda_c_qmf, acc_flags]\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solution process.\n    \"\"\"\n    # Define test cases per the problem statement\n    networks = build_networks()\n    lambdas = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0, 2.0]\n    \n    results = []\n    for A in networks:\n        case_result = process_network(A, lambdas)\n        results.append(case_result)\n        \n    # Format the output string exactly as required\n    final_output_parts = []\n    for res in results:\n        l_hmf, l_qmf, flags = res\n        l_hmf_str = f\"{l_hmf:.6f}\"\n        l_qmf_str = f\"{l_qmf:.6f}\"\n        flags_str = f\"[{','.join(map(str, flags))}]\"\n        final_output_parts.append(f\"[{l_hmf_str},{l_qmf_str},{flags_str}]\")\n        \n    print(f\"[{','.join(final_output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}