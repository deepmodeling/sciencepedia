{
    "hands_on_practices": [
        {
            "introduction": "要想真正掌握熟人免疫策略的威力，我们必须首先理解其核心机制。本练习将引导你从第一性原理出发，推导一个给定度为 $k$ 的节点被选中免疫的概率，从而揭示该策略为何会优先选择高连接度个体的数学基础。",
            "id": "4262068",
            "problem": "考虑一个具有 $N$ 个节点、度分布为 $P(k)$、平均度为 $\\langle k \\rangle$ 的大型无向简单网络。在熟人免疫协议中，单次免疫查询按以下步骤进行：首先从 $N$ 个节点中均匀随机地选择一个节点，然后从其邻居中均匀随机地选择一个，并对该邻居进行免疫。假设查询是独立且有放回地进行的，这意味着网络和抽样机制不受先前免疫的影响，并且每次查询都是同分布的。\n\n在度-度相关性可忽略的组态模型假设下，从第一性原理推导出一个度为 $k$ 的节点在经过 $m$ 次独立有放回的查询后至少被免疫一次的概率 $P_{m}(k)$ 的精确表达式（在平均场意义上）。然后，获得一个适用于大型网络中稀疏抽样的 $P_{m}(k)$ 的前导阶指数近似，并用 $N$、$k$ 和 $m$ 确定该近似成立的条件范围，包括前导修正项的量级。\n\n你的最终答案必须包含精确的平均场表达式及其指数近似，并以闭式解析表达式的形式给出。无需进行数值计算。",
            "solution": "问题要求我们求出在使用熟人免疫协议进行 $m$ 次独立查询后，一个度为 $k$ 的节点至少被免疫一次的概率 $P_{m}(k)$，以及其前导阶近似和有效范围。推导将在度-度相关性可忽略的组态模型网络的平均场假设下进行。\n\n首先，我们推导在单次查询中，一个度为 $k$ 的特定节点被选中进行免疫的概率，我们将其记为 $q(k)$。设目标节点为 $V$，其度为 $\\text{deg}(V) = k$。熟人免疫协议包括两个步骤：\n$1$. 从网络中的 $N$ 个节点中均匀随机地选择一个节点，我们称之为 $U$。选中任何特定节点 $U$ 的概率是 $1/N$。\n$2$. 从 $U$ 的邻居中均匀随机地选择一个并进行免疫。\n\n为了使我们的目标节点 $V$ 被免疫，在步骤 1 中选择的节点 $U$ 必须是它的一个邻居。设 $V$ 的邻居集合为 $\\mathcal{N}(V)$，其中 $|\\mathcal{N}(V)|=k$。如果在步骤 1 中选择了一个特定的邻居 $U_i \\in \\mathcal{N}(V)$，其度为 $\\text{deg}(U_i)$。在步骤 2 中，为了使 $V$ 被免疫，它必须从 $U_i$ 的 $\\text{deg}(U_i)$ 个邻居中被选中。这个概率是 $1/\\text{deg}(U_i)$。\n\n通过一个特定的邻居 $U_i$ 使 $V$ 被免疫的概率是这两个独立事件概率的乘积：$P(\\text{select } U_i \\text{ then } V) = P(\\text{select } U_i) \\times P(\\text{select } V | U_i \\text{ was chosen}) = \\frac{1}{N} \\times \\frac{1}{\\text{deg}(U_i)}$。\n\n节点 $V$ 在单次查询中被免疫的总概率 $q_V$ 是对它所有邻居的这些概率求和，因为这些是互斥事件（在步骤 1 中只选择一个节点 $U$）：\n$$q_V = \\sum_{U_i \\in \\mathcal{N}(V)} \\frac{1}{N \\cdot \\text{deg}(U_i)} = \\frac{1}{N} \\sum_{i=1}^{k} \\frac{1}{\\text{deg}(U_i)}$$\n这个概率取决于节点 $V$ 的特定邻居的度。问题要求的是 $P_m(k)$，它指的是一个度为 $k$ 的一般节点。因此，我们需要通过对所有度为 $k$ 的节点 $V$ 的 $q_V$ 进行平均来计算期望概率 $q(k)$。\n$$q(k) = \\left\\langle q_V \\right\\rangle_{\\text{deg}(V)=k} = \\frac{1}{N} \\left\\langle \\sum_{i=1}^{k} \\frac{1}{\\text{deg}(U_i)} \\right\\rangle_{\\text{deg}(V)=k}$$\n在无度-度相关的组态模型假设下，一个节点的邻居的度与该节点自身的度无关。邻居的度分布 $P_{nn}(k')$ 不是整体的度分布 $P(k')$，而是偏向于度更高的节点。这是因为一个度为 $k'$ 的节点有 $k'$ 条边，这使得它成为邻居的可能性是一个度为 $1$ 的节点的 $k'$ 倍。邻居度的归一化分布为 $P_{nn}(k') = \\frac{k' P(k')}{\\sum_{j} j P(j)} = \\frac{k' P(k')}{\\langle k \\rangle}$。\n\n现在我们可以计算邻居度的倒数的期望值：\n$$\\left\\langle \\frac{1}{\\text{deg}(\\text{neighbor})} \\right\\rangle = \\sum_{k'=1}^{N-1} \\frac{1}{k'} P_{nn}(k') = \\sum_{k'=1}^{N-1} \\frac{1}{k'} \\frac{k' P(k')}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k'=1}^{N-1} P(k') = \\frac{1}{\\langle k \\rangle}$$\n因为 $\\sum P(k') = 1$。\n应用这个平均场结果，和的期望值变为期望值的和：\n$$q(k) = \\frac{1}{N} \\sum_{i=1}^{k} \\left\\langle \\frac{1}{\\text{deg}(U_i)} \\right\\rangle = \\frac{1}{N} \\sum_{i=1}^{k} \\frac{1}{\\langle k \\rangle} = \\frac{k}{N \\langle k \\rangle}$$\n这就是一个度为 $k$ 的节点在单次查询中被免疫的平均场概率。请注意，这个概率与节点的度 $k$ 成正比，这是熟人免疫策略的核心优势。\n\n现在我们来求 $P_m(k)$，即在 $m$ 次独立查询中至少被免疫一次的概率。更方便的做法是先计算*不*被免疫的概率。在一次查询中不被免疫的概率是 $1 - q(k)$。由于所有 $m$ 次查询都是独立且有放回地进行的，所以在 $m$ 次查询中任何一次都未被免疫的概率是各次概率的乘积：\n$$P(\\text{not immunized in } m \\text{ queries}) = (1 - q(k))^m = \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m$$\n至少被免疫一次的概率 $P_m(k)$ 是该事件的补事件：\n$$P_m(k) = 1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m$$\n这就是第一个要求的结果：$P_m(k)$ 在平均场意义下的精确表达式。\n\n接下来，我们推导前导阶指数近似。该近似在“大型网络中的稀疏抽样”条件下有效，这意味着单次查询的免疫概率非常小。在数学上，这对应于 $q(k) = \\frac{k}{N \\langle k \\rangle} \\ll 1$ 的情况。只要 $k$ 和 $\\langle k \\rangle$ 不是 $N$ 的量级，这个条件对于大型网络 ($N \\to \\infty$) 就成立。\n我们使用指数函数的著名极限 $(1-x)^m \\approx \\exp(-mx)$，它是 $\\exp(m \\ln(1-x))$ 展开式中的前导项。\n令 $x = q(k) = \\frac{k}{N \\langle k \\rangle}$，我们得到：\n$$P_m(k) = 1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m \\approx 1 - \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)$$\n这是第二个要求的结果：前导阶指数近似。\n\n最后，我们分析有效范围和前导修正项。该近似源于自然对数的泰勒级数展开：$\\ln(1-x) = -x - \\frac{x^2}{2} - \\frac{x^3}{3} - \\dots$。\n然后，$(1-x)^m = \\exp(m\\ln(1-x)) = \\exp\\left(m\\left(-x - \\frac{x^2}{2} - O(x^3)\\right)\\right) = \\exp(-mx) \\exp\\left(-\\frac{mx^2}{2}\\right) \\exp\\left(-O(mx^3)\\right)$。\n如果展开式中的后续项可以忽略不计，那么前导阶近似 $P_m(k) \\approx 1 - \\exp(-mx)$ 是准确的。第一个修正因子是 $\\exp\\left(-\\frac{mx^2}{2}\\right)$。为了使该因子接近 $1$，其指数的绝对值必须很小：\n$$\\frac{mx^2}{2} \\ll 1 \\implies \\frac{m}{2} \\left(\\frac{k}{N \\langle k \\rangle}\\right)^2 \\ll 1 \\implies mk^2 \\ll 2(N \\langle k \\rangle)^2$$\n这个不等式定义了有效范围。对于大的 $N$ 以及增长不是太快的 $m$ 和 $k$ 值，该近似是准确的。\n对概率 $P_m(k)$ 本身的前导修正项的量级可以通过展开修正因子 $\\exp\\left(-\\frac{mx^2}{2}\\right) \\approx 1 - \\frac{mx^2}{2}$ 来找到：\n$$P_m(k) \\approx 1 - \\exp(-mx)\\left(1 - \\frac{mx^2}{2}\\right) = \\left[1 - \\exp(-mx)\\right] + \\frac{mx^2}{2}\\exp(-mx)$$\n前导修正项是第二项，其量级为：\n$$\\frac{m}{2} \\left(\\frac{k}{N \\langle k \\rangle}\\right)^2 \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)$$\n该修正项的量级为 $O\\left(\\frac{m k^2}{N^2}\\right)$。\n最终答案要求给出精确的平均场表达式及其指数近似。",
            "answer": "$$\n\\boxed{1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m, \\quad 1 - \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)}\n$$"
        },
        {
            "introduction": "在确定了节点层面的免疫概率后，我们现在可以评估该策略对整个网络健康状况的影响。本练习要求你将依赖于度的节点存活概率与宏观的流行病阈值联系起来，后者是决定疾病会广泛传播还是自行消亡的关键值。",
            "id": "4262057",
            "problem": "考虑一个由构型模型生成的大型网络，其度分布为 $P(k)$，平均度 $\\langle k \\rangle$ 为有限值。一种疾病根据易感-感染-恢复 (SIR) 过程传播，其中每次接触（边）以独立的概率（传播概率）$T$ 传播感染。在疫情开始前，采用一种熟人免疫策略：一部分随机选中的个体各自指定一个随机邻居进行免疫。在稀疏抽样极限下，该策略导致度为 $k$ 的节点的存活概率具有度相关性，为 $s_k=\\exp\\!\\left(-\\nu k / \\langle k \\rangle\\right)$，其中 $\\nu>0$ 是参数化免疫力度的参数。\n\n从以下基本依据出发：\n- 在大尺寸极限下，构型模型产生局部树状网络。\n- 在此类网络上的早期 SIR 动力学可以近似为一个 Galton–Watson 分支过程，其中基本再生数等于沿着一条典型的传染边到达一个邻居，然后通过该邻居的其余边向外传播所产生的成功传播的期望数量。\n- 度相关的节点存活表现为一种位点占据偏差，它以 $k P(k) s_k$ 的比例重新加权了边的邻居度抽样，而传播概率 $T$ 表现为沿着边的独立边占据。\n\n从第一性原理出发，推导全局爆发存在的疫情阈值条件，用 $T$，$P(k)$ 和 $s_k$ 表示。然后，将问题具体化到泊松度分布 $P(k)=\\exp(-z)\\,z^k/k!$（平均度 $z=\\langle k \\rangle$）的情况，并计算临界传播概率 $T_c$，要求其为关于 $z$ 和 $\\nu$ 的闭式解析表达式。\n\n将 $T_c$ 的最终答案表示为单个解析表达式。无需四舍五入，最终答案中不应包含任何单位。",
            "solution": "问题要求在一个网络上 SIR 过程的疫情阈值条件，该网络中的节点已根据度相关的存活概率 $s_k$ 进行了免疫。疫情阈值对应于分支过程近似的基本再生数 $R_*$ 等于 $1$ 的点。如果 $R_* > 1$，则可能发生疫情。\n\n量 $R_*$ 代表由一个被其邻居之一感染的单一感染节点产生的二次感染的期望数量。这由传播概率 $T$ 与仅由易感节点组成的网络的平均超额度的乘积给出。\n\n我们用 $P(k)$ 表示原始度分布。在免疫过程之后，一个度为 $k$ 的节点以概率 $s_k$ 保持易感。我们可以将其看作一个位点逾渗问题。剩余（易感）网络的性质决定了疫情动力学。\n\n沿着一条随机边到达一个度为 $k$ 的易感邻居的概率，正比于与此类节点关联的边数（即 $k$），并由它们的原始概率 $P(k)$ 和存活概率 $s_k$ 加权。将其归一化后，通过随机边到达的易感邻居的度分布为：\n$$\nq_s(k) = \\frac{k P(k) s_k}{\\sum_{k'} k' P(k') s_{k'}}\n$$\n一个度为 $k$ 的感染节点有 $k-1$ 条边可以用来感染其他邻居。它将引起的二次感染的期望数量由 $T$ 乘以通过这 $k-1$ 条边连接的易感邻居的期望数量给出。对于分支过程，我们对分布 $q_s(k)$ 进行平均。“出向”易感邻居的期望数量是 $k-1$ 在分布 $q_s(k)$ 上的平均值：\n$$\n\\langle k-1 \\rangle_{\\text{susceptible neighbor}} = \\sum_{k=0}^{\\infty} (k-1) q_s(k) = \\frac{\\sum_{k=0}^{\\infty} k(k-1) P(k) s_k}{\\sum_{k=0}^{\\infty} k P(k) s_k}\n$$\n再生数 $R_*$ 是这个量乘以传播概率 $T$：\n$$\nR_* = T \\frac{\\sum_{k} k(k-1) P(k) s_k}{\\sum_{k} k P(k) s_k}\n$$\n疫情阈值通过设置 $R_*=1$ 找到，这给出了临界传播概率 $T_c$：\n$$\nT_c = \\frac{\\sum_{k} k P(k) s_k}{\\sum_{k} k(k-1) P(k) s_k}\n$$\n这是疫情阈值条件的一般表达式。\n\n现在，我们将此结果具体化到给定的泊松度分布 $P(k)=\\exp(-z)\\,z^k/k!$（平均度 $\\langle k \\rangle=z$）和存活概率 $s_k=\\exp(-\\nu k / \\langle k \\rangle) = \\exp(-\\nu k / z)$ 的情况。\n\n为了计算这些和，我们使用生成函数方法。我们定义一个函数 $G_s(x)$ 如下：\n$$\nG_s(x) = \\sum_{k=0}^{\\infty} P(k) s_k x^k\n$$\n我们需要的和可以用 $G_s(x)$ 在 $x=1$ 处的导数来表示：\n$$\n\\sum_{k} k P(k) s_k = G_s'(1)\n$$\n$$\n\\sum_{k} k(k-1) P(k) s_k = G_s''(1)\n$$\n首先，让我们为我们的特定情况构建 $G_s(x)$：\n$$\nG_s(x) = \\sum_{k=0}^{\\infty} \\left(\\frac{\\exp(-z) z^k}{k!}\\right) \\left(\\exp\\left(-\\frac{\\nu k}{z}\\right)\\right) x^k\n$$\n让我们将以 $k$ 为幂的项组合在一起：\n$$\nG_s(x) = \\exp(-z) \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\left(z \\cdot \\exp\\left(-\\frac{\\nu}{z}\\right) \\cdot x\\right)^k\n$$\n这个和是指数函数的泰勒级数，$\\sum_{k=0}^{\\infty} \\frac{A^k}{k!} = \\exp(A)$。这里，$A = z \\exp(-\\nu/z) x$。\n$$\nG_s(x) = \\exp(-z) \\exp\\left(z \\exp\\left(-\\frac{\\nu}{z}\\right) x\\right) = \\exp\\left(z\\left[\\exp\\left(-\\frac{\\nu}{z}\\right)x - 1\\right]\\right)\n$$\n现在，我们计算关于 $x$ 的一阶和二阶导数：\n$$\nG_s'(x) = \\frac{d}{dx} G_s(x) = G_s(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)\n$$\n$$\nG_s''(x) = \\frac{d}{dx} G_s'(x) = G_s'(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right) = G_s(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2\n$$\n在 $x=1$ 处计算这些值：\n$$\nG_s'(1) = G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)\n$$\n$$\nG_s''(1) = G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2\n$$\n临界传播概率 $T_c$ 的阈值条件是：\n$$\nT_c = \\frac{G_s'(1)}{G_s''(1)} = \\frac{G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)}{G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2}\n$$\n$G_s(1)$ 项被消去，我们得到：\n$$\nT_c = \\frac{1}{z \\exp\\left(-\\frac{\\nu}{z}\\right)}\n$$\n这可以简化为临界传播概率的最终表达式：\n$$\nT_c = \\frac{1}{z} \\exp\\left(\\frac{\\nu}{z}\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{z} \\exp\\left(\\frac{\\nu}{z}\\right)}\n$$"
        }
    ]
}