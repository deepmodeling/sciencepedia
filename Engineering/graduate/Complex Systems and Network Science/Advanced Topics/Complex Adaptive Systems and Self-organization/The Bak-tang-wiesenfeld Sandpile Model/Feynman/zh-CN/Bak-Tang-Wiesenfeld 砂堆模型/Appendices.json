{
    "hands_on_practices": [
        {
            "introduction": "Bak-Tang-Wiesenfeld (BTW) 沙堆模型的一个核心且优美的特性是其阿贝尔性质。这意味着无论不稳定的沙堆以何种顺序坍塌，最终的稳定状态和每个位置的总坍塌次数都是唯一的。这个练习将通过一个 $2 \\times 2$ 网格上的具体例子，让你亲手验证这一性质，从而深刻理解为何该模型的结果是确定且可预测的。 ",
            "id": "4307527",
            "problem": "考虑一个 $2\\times 2$ 开放晶格上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型，该晶格有一个代表晶格外围的耗散汇。每个格点都有标准的方形晶格基本方向邻居，并使用阈值 $z_{c}=4$：当一个格点坍塌时，它会失去 $4$ 个沙粒，并向其四个基本方向各发送 $1$ 个沙粒；发送到晶格外的沙粒被汇吸收。用坐标 $(i,j)$ 标记格点，其中 $i,j\\in\\{1,2\\}$，设初始高度位形为\n$$\nh^{(0)}=\\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix}.\n$$\n该位形恰好有两个不稳定格点，$(1,1)$ 和 $(2,2)$。定义里程计函数 $u:\\{1,2\\}^{2}\\to\\mathbb{N}$，其中 $u(i,j)$ 等于在稳定化过程中格点 $(i,j)$ 处执行的坍塌次数。仅使用 BTW 模型的核心定义和开放边界条件，执行两次完整的稳定化：第一次先坍塌 $(1,1)$ 再坍塌 $(2,2)$，第二次先坍塌 $(2,2)$ 再坍塌 $(1,1)$，之后在每种情况下以任何合法序列继续，直到所有格点都稳定。从第一性原理出发，推导最终的稳定位形 $h^{(\\infty)}$ 和里程计函数 $u$，并证明两者都与两次坍塌的初始顺序无关。将你的最终答案表示为一个由稳定后的 $2 \\times 2$ 位形矩阵和 $2 \\times 2$ 里程计矩阵组成的对，并排写在一个单行矩阵中。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于成熟的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型，其给定条件完整且一致，问题表述清晰，并且以客观、正式的语言表达。我们开始求解。\n\n该问题考虑一个 $2 \\times 2$ 开放晶格上的 BTW 沙堆模型。格点用 $(i,j)$ 标记，其中 $i, j \\in \\{1, 2\\}$。坍塌阈值为 $z_c = 4$。当一个高度 $h(i,j) \\ge 4$ 的格点 $(i,j)$ 坍塌时，其高度变为 $h(i,j) \\to h(i,j) - 4$，其每个基本方向的邻居 $(i',j')$ 接收一个沙粒，高度变为 $h(i',j') \\to h(i',j') + 1$。发送到晶格外的沙粒会丢失。\n\n初始高度位形由矩阵 $h^{(0)}$ 给出：\n$$\nh^{(0)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix}\n$$\n初始里程计函数矩阵，用于记录每个格点的坍塌次数，为：\n$$\nu^{(0)} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n由于格点 $(i,j)$ 的单次坍塌引起的高度位形矩阵的变化，可以通过加上一个特定的变化矩阵 $C^{(i,j)}$ 来表示。对于 $2 \\times 2$ 的开放晶格，这些矩阵是：\n- 在 $(1,1)$ 处坍塌：失去 $4$ 个沙粒，向 $(1,2)$ 发送 $1$ 个，向 $(2,1)$ 发送 $1$ 个，向外部发送 $2$ 个。\n$$ C^{(1,1)} = \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} $$\n- 在 $(1,2)$ 处坍塌：失去 $4$ 个沙粒，向 $(1,1)$ 发送 $1$ 个，向 $(2,2)$ 发送 $1$ 个，向外部发送 $2$ 个。\n$$ C^{(1,2)} = \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} $$\n- 在 $(2,1)$ 处坍塌：失去 $4$ 个沙粒，向 $(1,1)$ 发送 $1$ 个，向 $(2,2)$ 发送 $1$ 个，向外部发送 $2$ 个。\n$$ C^{(2,1)} = \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} $$\n- 在 $(2,2)$ 处坍塌：失去 $4$ 个沙粒，向 $(1,2)$ 发送 $1$ 个，向 $(2,1)$ 发送 $1$ 个，向外部发送 $2$ 个。\n$$ C^{(2,2)} = \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} $$\n\n初始位形 $h^{(0)}$ 有两个不稳定格点，$(1,1)$ 和 $(2,2)$，因为它们的高度 ($4$) 大于或等于阈值 $z_c=4$。我们将按要求以两种不同的顺序执行稳定化。\n\n### 情况 1：先坍塌格点 $(1,1)$\n\n**步骤 1：** 坍塌格点 $(1,1)$。\n高度矩阵变为 $h^{(1)} = h^{(0)} + C^{(1,1)}$。\n$$\nh^{(1)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix} + \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  3 \\\\ 3  4 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu^{(1)} = u^{(0)} + \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n现在唯一的不稳定格点是 $(2,2)$。\n\n**步骤 2：** 坍塌格点 $(2,2)$。\n高度矩阵变为 $h^{(2)} = h^{(1)} + C^{(2,2)}$。\n$$\nh^{(2)} = \\begin{pmatrix} 0  3 \\\\ 3  4 \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu^{(2)} = u^{(1)} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在不稳定格点是 $(1,2)$ 和 $(2,1)$。我们可以按任意顺序坍塌它们。我们选择先坍塌 $(1,2)$。\n\n**步骤 3：** 坍塌格点 $(1,2)$。\n高度矩阵变为 $h^{(3)} = h^{(2)} + C^{(1,2)}$。\n$$\nh^{(3)} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix} + \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 4  1 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu^{(3)} = u^{(2)} + \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}\n$$\n现在唯一的不稳定格点是 $(2,1)$。\n\n**步骤 4：** 坍塌格点 $(2,1)$。\n高度矩阵变为 $h^{(4)} = h^{(3)} + C^{(2,1)}$。\n$$\nh^{(4)} = \\begin{pmatrix} 1  0 \\\\ 4  1 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu^{(4)} = u^{(3)} + \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n现在所有高度都小于 $z_c=4$。系统稳定。最终位形为 $h_{1}^{(\\infty)} = h^{(4)}$，最终里程计为 $u_{1} = u^{(4)}$。\n\n### 情况 2：先坍塌格点 $(2,2)$\n\n**步骤 1：** 坍塌格点 $(2,2)$。\n高度矩阵变为 $h'^{(1)} = h^{(0)} + C^{(2,2)}$。\n$$\nh'^{(1)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} = \\begin{pmatrix} 4  3 \\\\ 3  0 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu'^{(1)} = u^{(0)} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在唯一的不稳定格点是 $(1,1)$。\n\n**步骤 2：** 坍塌格点 $(1,1)$。\n高度矩阵变为 $h'^{(2)} = h'^{(1)} + C^{(1,1)}$。\n$$\nh'^{(2)} = \\begin{pmatrix} 4  3 \\\\ 3  0 \\end{pmatrix} + \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu'^{(2)} = u'^{(1)} + \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在不稳定格点是 $(1,2)$ 和 $(2,1)$。注意 $h'^{(2)} = h^{(2)}$ 且 $u'^{(2)} = u^{(2)}$，这在一个中间阶段展示了阿贝尔性质。我们继续进行稳定化。这次我们先坍塌 $(2,1)$。\n\n**步骤 3：** 坍塌格点 $(2,1)$。\n高度矩阵变为 $h'^{(3)} = h'^{(2)} + C^{(2,1)}$。\n$$\nh'^{(3)} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} = \\begin{pmatrix} 1  4 \\\\ 0  1 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu'^{(3)} = u'^{(2)} + \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}\n$$\n现在唯一的不稳定格点是 $(1,2)$。\n\n**步骤 4：** 坍塌格点 $(1,2)$。\n高度矩阵变为 $h'^{(4)} = h'^{(3)} + C^{(1,2)}$。\n$$\nh'^{(4)} = \\begin{pmatrix} 1  4 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n里程计矩阵更新为：\n$$\nu'^{(4)} = u'^{(3)} + \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n系统现在稳定。最终位形为 $h_{2}^{(\\infty)} = h'^{(4)}$，最终里程计为 $u_{2} = u'^{(4)}$。\n\n### 结论\n通过直接计算，我们已经证明两种序列都导致了相同的最终状态和里程计函数：\n$$\nh_{1}^{(\\infty)} = h_{2}^{(\\infty)} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n$$\nu_{1} = u_{2} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n这从第一性原理证明了，对于这个特定的初始位形，最终的稳定位形 $h^{(\\infty)}$ 和里程计函数 $u$ 与坍塌操作的顺序无关。这是 BTW 沙堆模型通用阿贝尔性质的一个具体实例。\n\n最终答案由唯一的稳定位形矩阵和唯一的最终里程计矩阵组成。\n最终稳定位形：\n$$\nh^{(\\infty)} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n最终里程计函数：\n$$\nu = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \n\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解了基本规则后，我们可以进一步探索沙堆模型中的“雪崩”动力学。本练习模拟了在一个接近临界状态的 $3 \\times 3$ 网格上，通过添加一粒沙来触发一次小型雪崩。通过追踪整个松弛过程，你不仅可以练习模型的动力学规则，还能体会到如何利用系统的对称性和守恒律来分析和预测复杂的级联事件的最终结果。 ",
            "id": "4307564",
            "problem": "考虑一个具有开放边界的二维方格网络上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型（也称为阿贝尔沙堆模型 (ASM)）。一个构型为每个格点赋予一个整数数量的沙粒 $z \\in \\mathbb{Z}_{\\ge 0}$。如果一个格点的沙粒数 $z \\ge 4$，则该格点是不稳定的。一个不稳定的格点会发生坍塌，向其四个晶格方向各发送1个沙粒，总共失去4个沙粒；被送到网络外的沙粒会丢失到一个汇中（开放边界）。如果每个格点的沙粒数 $z \\in \\{0,1,2,3\\}$，则该构型是稳定的。阿贝尔性质保证了最终的稳定构型以及每个格点的坍塌次数与坍塌顺序无关。\n\n在一个 $3 \\times 3$ 的开放网络上，从每个格点 $i$ 的沙粒数均为 $z_{i}=3$ 的均匀构型开始。仅在中心格点添加1个沙粒，然后通过重复坍塌进行稳定化，直到所有格点都变得稳定。\n\n仅使用该模型的动力学规则和网络上的沙粒守恒（即，一个格点上沙粒的任何减少都由其邻居格点上沙粒的增加或向汇中的损失来平衡），确定：\n- 每个格点的最终稳定高度，以及\n- 稳定化过程中每个格点的总坍塌次数。\n\n将您的最终答案表示为一个包含18个条目的单行向量：首先按行主序（从左上到右下）列出9个最终高度，然后按相同的行主序列出9个坍塌次数。无需四舍五入。",
            "solution": "我们从具有开放边界的方格网络上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型的定义开始。一个格点的一次坍塌会使其高度减少4，并使其至多四个邻居的高度各增加1。在开放边界上，任何发送到不存在的邻居的沙粒都会丢失到一个汇中。如果每个格点的高度都小于4，则构型是稳定的。阿贝尔性质确保最终的稳定构型和每个格点的总坍塌次数不依赖于坍塌的顺序。\n\n设格点按行主序索引，中心格点是唯一的内部格点。我们用 $t_{i}$ 表示在稳定化过程中格点 $i$ 的坍塌次数。根据网络上的沙粒守恒（考虑了向汇中的损失），对于每个格点 $k$，我们有以下平衡方程\n$$\nz_{\\mathrm{final}}(k) \\;=\\; z_{\\mathrm{initial}}(k) + s(k) \\;-\\; \\big(4\\,t_{k} - \\sum_{n \\sim k} t_{n}\\big),\n$$\n其中 $s(k)$ 是在格点 $k$ 添加的沙粒数（此处中心格点 $s(k)=1$，其他地方 $s(k)=0$），求和是对 $3 \\times 3$ 网络中 $k$ 的现有邻居 $n$ 进行的。这是直接从坍塌规则导出的离散守恒定律：$k$ 处的每次坍塌会从 $k$ 移走4个沙粒，同时向每个邻居提供1个沙粒；送往缺失邻居的沙粒会丢失。\n\n根据正方形二面体群的对称性（保持中心不变的旋转和反射），里程计函数（坍塌次数的向量）只取三个不同的值：\n- 中心格点处为 $x$，\n- 四个边心格点处各为 $y$，\n- 四个角格点处各为 $z$。\n类似地，最终高度也将具有相同的对称类别。\n\n为每种轨道类型写出平衡方程：\n\n1. 中心格点。其邻居是四个边心格点。离散拉普拉斯项是 $4x - 4y$，因此\n$$\nz_{\\mathrm{final}}(\\text{center}) \\;=\\; 3 + 1 \\;-\\; (4x - 4y) \\;=\\; 4 - 4x + 4y.\n$$\n\n2. 边心格点。其在网络内的邻居是中心格点和两个相邻的角格点。离散拉普拉斯项是 $4y - (x + 2z)$，因此\n$$\nz_{\\mathrm{final}}(\\text{edge}) \\;=\\; 3 \\;-\\; \\big(4y - x - 2z\\big) \\;=\\; 3 - 4y + x + 2z.\n$$\n\n3. 角格点。其在网络内的邻居是两个相邻的边心格点。离散拉普拉斯项是 $4z - 2y$，因此\n$$\nz_{\\mathrm{final}}(\\text{corner}) \\;=\\; 3 \\;-\\; \\big(4z - 2y\\big) \\;=\\; 3 - 4z + 2y.\n$$\n\n稳定性要求处处有 $z_{\\mathrm{final}} \\in \\{0,1,2,3\\}$，并且里程计值 $x,y,z$ 必须是非负整数。此外，根据阿贝尔沙堆模型的最小作用量原理，所实现的里程计是能使最终构型 $z_{\\mathrm{final}}$ 稳定，且其本身为逐点最小的非负整数函数。\n\n我们现在构造一个合法的坍塌序列并读出 $(x,y,z)$，然后验证其稳定性。\n\n从 $z \\equiv 3$ 开始，并在中心添加1个沙粒：\n- 中心变为4并坍塌一次：$x \\leftarrow 1$，中心减少4变为0，每个边心格点增加1变为4，角格点保持为3。\n- 现在四个边心格点的高度都为4；每个坍塌一次：每个边心 $y \\leftarrow 1$。每个边心格点减少4变为0，向中心发送1个沙粒，向每个相邻的角格点发送1个沙粒（并向汇中发送1个）。在所有四个边心坍塌之后，中心获得4个沙粒（每个边心格点贡献一个）变为4，每个角格点获得2个沙粒（从其两个相邻的边心）变为5。\n- 高度为4的中心再次坍塌：$x \\leftarrow 2$，向每个边心格点发送1个沙粒。边心格点变为1，角格点保持为5，中心回到0。\n- 每个高度为5的角格点坍塌一次：每个角格点 $z \\leftarrow 1$。每个角格点减少4变为1，向每个相邻的边心格点发送1个沙粒，并向汇中发送2个。每个边心格点从其两个相邻的角格点接收2个沙粒并变为3。\n\n最终的构型是：\n- 中心：$0$，\n- 边心格点：$3$，\n- 角格点：$1$。\n\n没有格点的高度大于或等于4，因此该构型是稳定的。总坍塌次数是：\n- 中心：$x=2$，\n- 边心格点：$y=1$，\n- 角格点：$z=1$。\n\n为了确认一致性，我们用守恒方程进行验证：\n\n- 中心：$z_{\\mathrm{final}} = 4 - 4x + 4y = 4 - 8 + 4 = 0$。\n- 边心：$z_{\\mathrm{final}} = 3 - 4y + x + 2z = 3 - 4 + 2 + 2 = 3$。\n- 角：$z_{\\mathrm{final}} = 3 - 4z + 2y = 3 - 4 + 2 = 1$。\n\n因此，最终构型和坍塌次数是唯一确定的。按行主序（从左上到右下），最终高度为\n$$\n1,\\;3,\\;1,\\;3,\\;0,\\;3,\\;1,\\;3,\\;1,\n$$\n坍塌次数为\n$$\n1,\\;1,\\;1,\\;1,\\;2,\\;1,\\;1,\\;1,\\;1.\n$$\n\n根据阿贝尔性质，任何合法的坍塌序列都会产生相同的结果，并且根据最小作用量原理，上述里程计是最小的，因此是唯一的解。",
            "answer": "$$\\boxed{\\begin{pmatrix}1  3  1  3  0  3  1  3  1  1  1  1  1  2  1  1  1  1\\end{pmatrix}}$$"
        },
        {
            "introduction": "除了单次雪崩的动力学，沙堆模型更深层次的结构体现在其“递归”构型和底层的阿贝尔群结构中。这个练习将引导你使用 Dhar 的“燃烧算法”这一强大的工具来识别哪些构型是系统在长期演化中可以反复达到的。通过求解这个问题，你将从动力学模拟过渡到对模型代数性质的理解，这是掌握自组织临界性理论的关键一步。 ",
            "id": "4307553",
            "problem": "考虑一个在具有开放边界条件的有限二维方形格点上的标准 Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型。该格点是一个由非汇顶点组成的 $2 \\times 2$ 网格，并有一个单一的吸收汇，用于收集离开格点的沙粒。每个非汇顶点的坍塌阈值为 $4$，当它坍塌时，会向其每个正交邻居发送一粒沙；发送到格点外的沙粒被吸收汇吸收。设约化图拉普拉斯矩阵为一个 $4 \\times 4$ 矩阵，其对角线元素为 $4$，对于每对相邻的非汇顶点，其非对角线元素为 $-1$，否则为 $0$。将四个非汇顶点索引为 $1$ (左上)、$2$ (右上)、$3$ (左下) 和 $4$ (右下)。\n\n定义燃烧构型 $b$，其中 $b_{i}$ 等于从顶点 $i$ 到吸收汇的边数。在这个 $2 \\times 2$ 网格上，四个顶点中的每一个都是角点，因此对于所有 $i \\in \\{1,2,3,4\\}$，都有 $b_{i} = 2$。\n\n给定在这个 $2 \\times 2$ 开放格点上的稳定构型 $z = (3,3,3,3)$：\n- 从稳定性、坍塌和燃烧构型的基本定义出发，使用燃烧检验来确定 $z$ 是否为循环构型。\n- 如果 $z$ 是循环构型，通过稳定化零构型和燃烧构型 $b$ 的和来确定阿贝尔沙堆群的单位元构型 $e$。然后，找到一个非负整数加法向量 $a = (a_{1},a_{2},a_{3},a_{4})$，使得稳定化 $e + a$ 后得到 $z$。在所有这样的 $a$ 中，选择使 $\\sum_{i=1}^{4} a_{i}$ 最小化的那一个。\n\n在最终答案中，仅以行向量的形式报告向量 $a$，顺序为 $(1,2,3,4)$。",
            "solution": "用户要求我解决一个关于在具有开放边界的 $2 \\times 2$ 网格上的 Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型的问题。问题分为三个部分：首先，使用燃烧检验测试给定构型 $z$ 是否是循环构型；其次，确定沙堆群的单位元 $e$；第三，找到一个最小的非负整数向量 $a$，使得 $e+a$ 的稳定化结果为 $z$。\n\n首先，我将验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   模型：Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型。\n-   格点：一个由非汇顶点组成的 $2 \\times 2$ 方形网格。\n-   边界条件：开放，带有一个单一的吸收汇。\n-   坍塌阈值：所有四个非汇顶点的 $Z_{\\text{crit}} = 4$。\n-   坍塌规则：一个不稳定的顶点向其每个正交邻居发送一粒沙。发送到格点外的沙粒被吸收汇吸收。\n-   顶点索引：$1$ (左上)，$2$ (右上)，$3$ (左下)，和 $4$ (右下)。\n-   约化图拉普拉斯矩阵 ($L$)：一个 $4 \\times 4$ 矩阵，其对角线元素为 $4$，对于相邻的非汇顶点，非对角线元素为 $-1$，否则为 $0$。\n-   燃烧构型 ($b$)：定义为 $b_i$ 是从顶点 $i$ 到吸收汇的边数。给定对于所有 $i \\in \\{1,2,3,4\\}$，$b_i = 2$。\n-   待分析的稳定构型：$z = (3,3,3,3)$。\n-   任务：\n    1.  使用燃烧检验来确定 $z$ 是否是循环构型。\n    2.  如果是循环构型，通过稳定化零构型与燃烧构型之和 ($S(0+b)$) 来找到单位元构型 $e$。\n    3.  找到一个非负整数向量 $a = (a_1, a_2, a_3, a_4)$，它能最小化和 $\\sum_{i=1}^{4} a_{i}$，并且使得稳定化 $e+a$ 后得到 $z$。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在自组织临界性和复杂系统理论中有坚实的基础，特别是标准的 BTW 沙堆模型。所有使用的概念（稳定性、坍塌、循环性、燃烧检验、阿贝尔群结构）都是该领域的基础。\n-   **良定性**：问题定义了所有必要的量和操作，可以导出一个确定的、唯一的最小向量 $a$ 的答案。\n-   **客观性**：问题以精确、数学化的术语陈述，没有主观性。\n-   **一致性检查**：问题分别定义了拉普拉斯矩阵 $L$ 和坍塌规则。我们来验证它们的一致性。顶点索引如下：\n$1 - 2$\n$| \\ \\ \\ |$\n$3 - 4$\n非汇顶点之间的邻接关系为 $(1,2)$、$(1,3)$、$(2,4)$ 和 $(3,4)$。\n根据问题的定义，拉普拉斯矩阵 $L$ 是：\n$$L = \\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix}$$\n在沙堆模型的背景下，由坍塌引起的构型变化由一个坍塌矩阵 $\\Delta_T$ 描述。在站点 $j$ 发生一次坍塌会使构型向量 $c$ 加上 $\\Delta_T$ 的第 $j$ 列。对于一个不稳定的站点 $i$（其沙高 $c_i \\ge Z_{\\text{crit}}=4$），一次坍塌意味着其沙高减少 $4$，其内部邻居各接收 $1$ 粒沙。对于站点 $1$，其内部邻居是 $2$ 和 $3$。因此，在站点 $1$ 发生一次坍塌对应于一个变化向量 $(-4, 1, 1, 0)^T$。这对应于矩阵 $-L$ 的第一列。所有其他站点也是如此。因此，坍塌矩阵是 $\\Delta_T = -L$。问题的定义是内部一致的。燃烧构型 $b_i=2$ 的定义对于方形格点开放边界上的角点也是正确的。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它在科学上是合理的、良定的、客观的且内部一致的。我现在将进行完整的解答。\n\n### 解题过程\n\n这个问题需要分三步解决。我们按顺序处理每个部分。\n\n**第一部分：循环性的燃烧检验**\n如果从构型 $c' = c + b$ 开始，系统可以通过一系列坍塌来达到稳定，且其中每个站点最多坍塌一次，则稳定构型 $c$ 被定义为循环构型。给定的稳定构型是 $z=(3,3,3,3)$，燃烧构型是 $b=(2,2,2,2)$。\n\n我们来计算燃烧检验的初始构型：\n$$ c' = z + b = (3,3,3,3) + (2,2,2,2) = (5,5,5,5) $$\n坍塌阈值是 $Z_{\\text{crit}} = 4$。由于所有站点的沙高都为 $5$，所有四个站点都是不稳定的。由于模型的阿贝尔性质，我们可以按任何顺序使它们坍塌。我们选择顺序 $1, 2, 3, 4$。\n\n坍塌矩阵是 $\\Delta_T = -L$：\n$$ \\Delta_T = \\begin{pmatrix} -4  1  1  0 \\\\ 1  -4  0  1 \\\\ 1  0  -4  1 \\\\ 0  1  1  -4 \\end{pmatrix} $$\n\n1.  **初始状态**：$c_0 = (5,5,5,5)$。所有站点都不稳定。\n2.  **使站点 1 坍塌**：变化由 $\\Delta_T$ 的第一列给出。\n    $$ c_1 = c_0 + (-4, 1, 1, 0) = (5-4, 5+1, 5+1, 5+0) = (1, 6, 6, 5) $$\n    站点 $1$ 现已坍塌一次。站点 $2, 3, 4$ 不稳定。\n3.  **使站点 2 坍塌**：变化由 $\\Delta_T$ 的第二列给出。\n    $$ c_2 = c_1 + (1, -4, 0, 1) = (1+1, 6-4, 6+0, 5+1) = (2, 2, 6, 6) $$\n    站点 $2$ 现已坍塌一次。站点 $3, 4$ 不稳定。\n4.  **使站点 3 坍塌**：变化由 $\\Delta_T$ 的第三列给出。\n    $$ c_3 = c_2 + (1, 0, -4, 1) = (2+1, 2+0, 6-4, 6+1) = (3, 2, 2, 7) $$\n    站点 $3$ 现已坍塌一次。站点 $4$ 不稳定。\n5.  **使站点 4 坍塌**：变化由 $\\Delta_T$ 的第四列给出。\n    $$ c_4 = c_3 + (0, 1, 1, -4) = (3+0, 2+1, 2+1, 7-4) = (3, 3, 3, 3) $$\n    站点 $4$ 现已坍塌一次。\n\n最终构型是 $(3,3,3,3)$。所有沙高都小于 $4$，所以系统是稳定的。在这个稳定化过程中，每个站点都恰好坍塌了一次。根据燃烧检验，这证明了构型 $z=(3,3,3,3)$ 是 **循环的**。\n\n**第二部分：确定单位元构型**\n问题要求我们通过稳定化零构型 $c_{\\text{zero}}=(0,0,0,0)$ 与燃烧构型 $b=(2,2,2,2)$ 的和来找到单位元构型 $e$。令 $S(c)$ 表示构型 $c$ 的稳定化。\n$$ e = S(c_{\\text{zero}} + b) = S((0,0,0,0) + (2,2,2,2)) = S((2,2,2,2)) $$\n构型 $(2,2,2,2)$ 的所有沙高 $c_i = 2$，小于坍塌阈值 $Z_{\\text{crit}} = 4$。因此，该构型已经是稳定的。\n稳定化算子 $S$ 对一个已经稳定的构型不起作用。\n$$ e = (2,2,2,2) $$\n\n**第三部分：找到最小加法向量**\n我们需要找到一个非负整数向量 $a = (a_1, a_2, a_3, a_4)$，使得 $S(e+a) = z$，并且和 $\\sum_{i=1}^4 a_i$ 最小。\n\n$S(e+a) = z$ 的条件意味着构型 $e+a$ 和构型 $z$ 在沙堆群中属于同一个等价类。如果可以从 $c_{\\text{initial}}$ 通过一系列坍塌到达 $c_{\\text{final}}$，则两个构型 $c_{\\text{initial}}$ 和 $c_{\\text{final}}$ 是等价的。这可以表示为：\n$$ c_{\\text{final}} = c_{\\text{initial}} + \\Delta_T u $$\n其中 $u = (u_1, u_2, u_3, u_4)^T$ 是一个非负整数向量，表示每个站点坍塌的次数。\n\n在我们的情况下，$c_{\\text{initial}} = e+a$ 且 $c_{\\text{final}} = z = S(e+a)$。所以我们有：\n$$ z = (e+a) + \\Delta_T u $$\n我们可以重新整理这个方程来解出 $a$：\n$$ a = z - e - \\Delta_T u $$\n利用问题的拉普拉斯矩阵 $L = -\\Delta_T$ 这一事实，我们得到：\n$$ a = z - e + L u $$\n我们已知 $z=(3,3,3,3)$ 并且我们找到了 $e=(2,2,2,2)$。它们的差是：\n$$ z - e = (1,1,1,1) $$\n将此代入 $a$ 的方程中：\n$$ a = (1,1,1,1)^T + L u $$\n我们的目标是找到一个非负整数向量 $u$，它能最小化 $\\sum a_i$，同时满足所得向量 $a$ 也必须是非负的约束，即对于所有 $i$，$a_i \\ge 0$。\n\n让我们用 $u$ 来表示和 $\\sum a_i$。我们可以将 $\\sum a_i$ 写成点积 $\\mathbf{1}^T a$，其中 $\\mathbf{1}=(1,1,1,1)^T$。\n$$ \\sum_{i=1}^4 a_i = \\mathbf{1}^T a = \\mathbf{1}^T (z-e) + \\mathbf{1}^T L u $$\n我们已经有 $\\mathbf{1}^T(z-e) = 1+1+1+1=4$。我们来计算 $\\mathbf{1}^T L$：\n$$ \\mathbf{1}^T L = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix} $$\n该行向量的第 $j$ 个分量是 $L$ 的第 $j$ 列各项之和。\n- 第 1 列之和: $4-1-1+0 = 2$\n- 第 2 列之和: $-1+4+0-1 = 2$\n- 第 3 列之和: $-1+0+4-1 = 2$\n- 第 4 列之和: $0-1-1+4 = 2$\n所以，$\\mathbf{1}^T L = (2,2,2,2) = 2 \\mathbf{1}^T$。\n那么和为：\n$$ \\sum a_i = 4 + \\begin{pmatrix} 2  2  2  2 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix} = 4 + 2(u_1+u_2+u_3+u_4) = 4 + 2 \\sum u_i $$\n为了最小化 $\\sum a_i$，我们必须最小化和 $\\sum u_i$。由于 $u_i$ 是非负整数，它们的和的最小可能值为 $0$。这在 $u=(0,0,0,0)$ 时发生。\n\n我们来检验这个最小的选择。如果 $u=(0,0,0,0)$，向量 $a$ 是：\n$$ a = (1,1,1,1)^T + L \\cdot (0,0,0,0)^T = (1,1,1,1)^T $$\n我们必须验证这个向量 $a$ 满足 $a_i \\ge 0$ 的条件。确实，$a=(1,1,1,1)$ 的所有分量都是非负的。\n这个 $u=(0,0,0,0)$ 的选择最小化了 $\\sum u_i$ 并且产生了一个有效的 $a$。因此，向量 $a=(1,1,1,1)$ 是最小化 $\\sum a_i$ 的解。\n\n对于这个解，$S(e+a) = S((2,2,2,2)+(1,1,1,1)) = S((3,3,3,3))$。由于 $(3,3,3,3)$ 是稳定的，$S((3,3,3,3)) = (3,3,3,3) = z$，这证实了解的正确性。\n\n所求的最小向量 $a$ 是 $(1,1,1,1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1  1  1  1 \\end{pmatrix} } $$"
        }
    ]
}