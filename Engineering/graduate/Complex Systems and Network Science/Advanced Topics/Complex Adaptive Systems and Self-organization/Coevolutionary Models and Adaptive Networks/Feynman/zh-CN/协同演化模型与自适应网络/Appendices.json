{
    "hands_on_practices": [
        {
            "introduction": "适应性选民模型（Adaptive Voter Model）是研究自适应网络上观点动态的基石模型。本练习将引导你使用对近似（pair approximation）这一关键的平均场技术，来推导模型的宏观动力学方程。通过这个实践，你将掌握将微观互动规则转化为宏观常微分方程的核心技能，这是分析协同演化系统动态行为的基础。",
            "id": "4269268",
            "problem": "考虑一个度为$k$的度规则随机网络上的自适应选民模型（AVM），该网络有$N$个节点，是作为一个无度相关的配置模型构建的。每个节点持有两种观点之一，表示为$A$和$B$。令$[A]$和$[B]$分别表示处于状态$A$和$B$的节点比例，令$[AA]$、$[AB]$和$[BB]$分别表示类型为$AA$、$AB$和$BB$的边的比例，所有比例都按总边数归一化。动力学在连续时间内按以下方式进行：每条不一致边$AB$以速率$1$被选择；一旦被选择，以概率$w \\in (0,1)$发生重连，其中一端被随机均匀地选择，并重新连接到一个与其自身观点相同的随机均匀节点（避免自环和多重边）；以概率$1-w$发生模仿事件，其中一端被随机均匀地选择，并采纳另一个节点的观点。\n\n从边和节点密度的核心定义、配置模型中末端的守恒以及全概率定律出发，使用对近似方法推导出一个关于$[A]$、$[B]$、$[AA]$、$[AB]$和$[BB]$时间演化的封闭常微分方程组（ODEs）。清晰地说明您对三元组密度和条件邻居构成所采用的闭合方法，并用$[A]$、$[B]$和$[AB]$完全表示您引入的任何条件概率。\n\n然后，使用您推导出的常微分方程组，确定在$[A]=[B]=\\tfrac{1}{2}$的统计对称活跃相中，不一致边密度$[AB]^{\\ast}$的非平凡稳态值，作为$k$和$w$的函数。请以最简解析形式提供$[AB]^{\\ast}$的单个闭式表达式作为您的最终答案。无需四舍五入，不涉及单位。",
            "solution": "用户需要一个关于自适应选民模型问题的解。\n\n### 步骤1：问题验证\n\n**1. 提取已知条件：**\n- **模型：** 度规则随机网络上的自适应选民模型（AVM）。\n- **网络参数：** $N$个节点，所有节点的度均为$k$。该网络是一个无度相关的配置模型。\n- **节点状态：** 两种观点，$A$和$B$。\n- **节点密度：** $[A]$和$[B]$分别是处于状态$A$和$B$的节点比例。\n- **边密度：** $[AA]$、$[AB]$和$[BB]$分别是$AA$、$AB$和$BB$类型边的比例，按总边数$E = Nk/2$归一化。\n- **动力学：**\n    - 不一致边$AB$以每条边为1的速率被选择。事件的总速率是$E_{AB}$，即$AB$边的数量。\n    - 以概率$w \\in (0,1)$发生重连事件：从所选边的两端节点中随机均匀地选择一个，它与另一个节点断开连接，并重新连接到一个与其自身观点相同的随机均匀节点。避免自环和多重边。\n    - 以概率$1-w$发生模仿事件：从所选边的两端节点中随机均匀地选择一个，并采纳另一个节点的观点。\n\n- **任务1：** 使用对近似方法推导$[A]$、$[B]$、$[AA]$、$[AB]$和$[BB]$时间演化的封闭常微分方程组（ODEs）。这包括说明所用的闭合方法，并将条件概率完全用$[A]$、$[B]$和$[AB]$表示。\n- **任务2：** 在$[A]=[B]=1/2$的统计对称活跃相中，确定不一致边密度$[AB]^{\\ast}$的非平凡稳态值。结果应为$k$和$w$的函数。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题描述了自适应选民模型，这是研究共演化网络和复杂系统中的一个典型模型。其表述是标准的、科学合理的。\n- **适定性：** 该问题是适定的。它要求使用指定的标准近似方法（对近似）进行推导，并计算稳态解，这是一个可解的任务。\n- **客观性：** 该问题以精确、客观和数学化的语言表述。\n- **结论：** 该问题未违反任何无效性标准。它是理论物理/复杂系统领域一个有效的、非平凡的问题。\n\n### 步骤2：解的推导\n\n**守恒律和定义**\n设$N_A = N[A]$和$N_B = N[B]$分别为A类和B类节点的数量。设$E_{AA}$、$E_{AB}$、$E_{BB}$为每种类型边的数量。对于一个$k$-规则网络，总边数为$E = Nk/2$。边密度为$[XY] = E_{XY}/E$。\n\n节点和边密度通过“末端”守恒相关联。从A类节点发出的边末端（stubs）总数为$k N_A$。这些末端连接到A类或B类节点。每条$AA$边计为两个这样的末端，每条$AB$边计为一个。\n$k N_A = 2E_{AA} + E_{AB}$\n两边除以$Nk$：\n$[A] = \\frac{2E_{AA}}{Nk} + \\frac{E_{AB}}{Nk} = \\frac{2E[AA]}{Nk} + \\frac{E[AB]}{Nk}$\n代入$E=Nk/2$：\n$[A] = \\frac{2(Nk/2)[AA]}{Nk} + \\frac{(Nk/2)[AB]}{Nk} = [AA] + \\frac{1}{2}[AB]$\n类似地，对于B类节点：\n$[B] = [BB] + \\frac{1}{2}[AB]$\n将这两个等式相加得到$[A]+[B] = [AA]+[AB]+[BB]$，这与节点和边的总守恒（$1=1$）是一致的。这些关系使我们能够仅使用$[A]$和$[AB]$来描述系统的状态。\n\n**$[A]$的时间演化**\nA类节点的密度$[A]$仅通过模仿事件改变。在模仿事件中，一条$AB$边被选中，并随机选择一个节点复制另一个节点的状态。如果选择A节点，它将变为B（$N_A \\to N_A-1$）。如果选择B节点，它将变为A（$N_A \\to N_A+1$）。由于两种选择的可能性相同（概率为$1/2$），$N_A$的期望变化为零。\n$$ \\frac{d N_A}{dt} \\propto (1-w) \\left( \\frac{1}{2} \\times (-1) + \\frac{1}{2} \\times (+1) \\right) = 0 $$\n因此，$[A]$（和$[B]$）是此模型中的守恒量。\n$$ \\frac{d[A]}{dt} = 0 \\quad \\text{和} \\quad \\frac{d[B]}{dt} = 0 $$\n\n**$[AB]$的时间演化**\n我们推导不一致边密度$[AB]$的常微分方程。我们使用变量$\\theta(t) = [AB](t)$。$AB$边的总数是$E_{AB} = E\\theta = \\frac{Nk}{2}\\theta$。\n动力学由选择一条不一致边触发。事件的总速率是$E_{AB}$。\n我们通过对所有过程的影响求和来计算$E_{AB}$的变化率。\n$$ \\frac{dE_{AB}}{dt} = (\\text{AB边的生成速率}) - (\\text{AB边的销毁速率}) $$\n每当一条$AB$边被选中进行模仿或重连时，它就会被销毁。总选择速率为$E_{AB}$。因此，焦点$AB$边的销毁速率为$E_{AB}$。\n$$ (\\text{销毁速率})_{\\text{焦点}} = E_{AB} $$\n当一个节点改变其状态，从而改变了连接到它的边的类型时，$AB$边也会作为模仿的副作用而生成和销毁。重连不改变节点状态，因此没有这种副作用。\n\n让我们分析模仿过程。一条$AB$边$(u,v)$（其中$u \\in A, v \\in B$）被选中。模仿事件的速率是$(1-w)E_{AB}$。\n1.  以概率$1/2$，节点$u$被选中从状态$A$翻转到$B$。这以$\\frac{1-w}{2}E_{AB}$的速率发生。当$u$翻转时，其另外$k-1$条边会受到影响。\n2.  以概率$1/2$，节点$v$被选中从状态$B$翻转到$A$。这以$\\frac{1-w}{2}E_{AB}$的速率发生。当$v$翻转时，其另外$k-1$条边会受到影响。\n\n为了计算变化，我们需要邻居状态的条件概率。这就是使用对近似的地方。该闭合假设一个节点的邻域是随机的，仅以该节点的状态为条件。一个邻居的状态被假定为独立于其他邻居的状态。\n一个A类节点的随机邻居是B类节点的概率为：\n$$ P(B|A) = \\frac{\\text{从A到B的末端数}}{\\text{从A发出的总末端数}} = \\frac{E_{AB}}{kN_A} = \\frac{E[AB]}{kN[A]} = \\frac{(Nk/2)[AB]}{kN[A]} = \\frac{[AB]}{2[A]} $$\n类似地，\n$$ P(A|A) = \\frac{2E_{AA}}{kN_A} = \\frac{2E[AA]}{kN[A]} = \\frac{[AA]}{[A]} = \\frac{[A] - [AB]/2}{[A]} = 1 - \\frac{[AB]}{2[A]} $$\n$$ P(A|B) = \\frac{[AB]}{2[B]} \\quad \\text{和} \\quad P(B|B) = 1 - \\frac{[AB]}{2[B]} $$\n根据要求，这些条件概率仅用$[A]$、$[B]$和$[AB]$表示。\n\n当节点$u$从$A$翻转到$B$时：\n- 其连接到A类邻居的$(k-1)P(A|A)$条边变为$B-A$边，生成了$(k-1)P(A|A)$条新的$AB$边。\n- 其连接到B类邻居的$(k-1)P(B|A)$条边（不包括到$v$的边）变为$B-B$边，销毁了$(k-1)P(B|A)$条$AB$边。\n来自$u$邻域的$E_{AB}$净变化为$(k-1)(P(A|A) - P(B|A))$。\n由于$A \\to B$翻转导致的$E_{AB}$变化速率为$\\frac{1-w}{2}E_{AB} \\times (k-1)(P(A|A) - P(B|A))$。\n\n对称地，当节点$v$从$B$翻转到$A$时，其邻域对$E_{AB}$的净变化为$(k-1)(P(B|B) - P(A|B))$。\n由于$B \\to A$翻转导致的$E_{AB}$变化速率为$\\frac{1-w}{2}E_{AB} \\times (k-1)(P(B|B) - P(A|B))$。\n\n由副作用产生的总生成速率为：\n$$ (\\text{生成速率})_{\\text{副作用}} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ P(A|A) - P(B|A) + P(B|B) - P(A|B) \\right] $$\n代入条件概率：\n$$ (\\text{生成速率})_{\\text{副作用}} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ \\left(1 - \\frac{[AB]}{[A]}\\right) + \\left(1 - \\frac{[AB]}{[B]}\\right) \\right] $$\n$$ = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ 2 - [AB] \\left( \\frac{1}{[A]} + \\frac{1}{[B]} \\right) \\right] = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) $$\n\n$E_{AB}$的完整常微分方程是：\n$$ \\frac{dE_{AB}}{dt} = (\\text{生成速率})_{\\text{副作用}} - (\\text{销毁速率})_{\\text{焦点}} $$\n$$ \\frac{dE_{AB}}{dt} = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) - E_{AB} $$\n$$ \\frac{dE_{AB}}{dt} = E_{AB} \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right] $$\n为了得到$\\theta = [AB]$的常微分方程，我们使用$E_{AB} = E\\theta$和$dE_{AB}/dt = E(d\\theta/dt)$：\n$$ \\frac{d\\theta}{dt} = \\theta \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}\\theta \\right] $$\n\n关于密度的完整常微分方程组是：\n1. $\\frac{d[A]}{dt} = 0$\n2. $\\frac{d[B]}{dt} = 0$\n3. $\\frac{d[AB]}{dt} = [AB] \\left( (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right)$\n4. $\\frac{d[AA]}{dt} = \\frac{d}{dt}\\left([A] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\n5. $\\frac{d[BB]}{dt} = \\frac{d}{dt}\\left([B] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\n这是一个符合要求的封闭常微分方程组。\n\n**稳态分析**\n我们寻求一个非平凡稳态$[AB]^{\\ast} \\neq 0$，在该状态下$d[AB]/dt=0$。这要求$[AB]$的常微分方程中方括号内的项为零：\n$$ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = 0 $$\n求解$[AB]^{\\ast}$：\n$$ \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = (1-w)(k-1) - 1 $$\n$$ [AB]^{\\ast} = \\frac{2[A][B] \\left( (1-w)(k-1) - 1 \\right)}{(1-w)(k-1)} = 2[A][B] \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\n问题指定了对称活跃相，其中$[A]=[B]=1/2$。代入这些值：\n$$ [A][B] = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4} $$\n$$ [AB]^{\\ast} = 2 \\left( \\frac{1}{4} \\right) \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) = \\frac{1}{2} \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\n这个非平凡解在$(1-w)(k-1) > 1$时存在。\n将其写成单个分数形式：\n$$ [AB]^{\\ast} = \\frac{1}{2} \\left( \\frac{(1-w)(k-1) - 1}{(1-w)(k-1)} \\right) = \\frac{(1-w)(k-1) - 1}{2(1-w)(k-1)} $$\n这是对称活跃相中不一致边密度的最终表达式。",
            "answer": "$$ \\boxed{ \\frac{(k-1)(1-w)-1}{2(k-1)(1-w)} } $$"
        },
        {
            "introduction": "本练习将我们的视角从观点动态转向流行病学。我们将探讨在SIS模型中，网络结构的动态适应如何影响疾病的传播。此练习的核心在于应用线性稳定性分析和快时间尺度近似（fast-adaptation limit），来推导出一个关键的流行病阈值，从而将网络演化与公共卫生结果直接联系起来。",
            "id": "4269229",
            "problem": "考虑一个由 $N$ 个节点组成的群体，这些节点通过一个无向、连通的加权网络相互作用，其基准权重矩阵为 $W_{0} \\in \\mathbb{R}^{N \\times N}$，其中每个条目 $W_{0,ij} \\ge 0$ 表示节点 $i$ 和 $j$ 之间的接触强度。在时间 $t$，瞬时权重矩阵为 $W(t) = Y(t) \\odot W_{0}$，其中 $Y(t) \\in [0,1]^{N \\times N}$ 是一个乘以基准联系的快速、遍历的、外生适应过程，$\\odot$ 表示哈达玛（逐元素）积。假设 $W_{0}$ 是不可约且非负的。\n\n疾病动力学遵循易感-感染-易感（SIS）模型：节点 $i$ 以概率 $p_{i}(t)$ 被感染，其平均场动力学由以下常微分方程（ODE）给出\n$$\n\\frac{d p_{i}}{d t} = -\\mu p_{i}(t) + \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t) p_{j}(t),\n$$\n其中 $\\beta > 0$ 是单位权重感染率，$\\mu > 0$ 是恢复率。适应场 $Y(t)$ 是一个在 $[0,1]^{N \\times N}$ 上的平稳、遍历的马尔可夫过程，在早期入侵阶段，它在统计上与感染过程独立，并在一个快速时间尺度 $\\epsilon \\ll 1$ 上演化，因此 $Y(t)$ 会快速地从其不变分布中抽样。用 $\\bar{y} = \\mathbb{E}[Y_{ij}]$ 表示 $Y(t)$ 条目的共同平稳均值（假设可交换性，使得所有节点对的平稳均值相同），并假设 $0  \\bar{y} \\le 1$。\n\n仅从上述定义、SIS 平均场动力学、关于线性常微分方程线性稳定性的标准事实以及 Perron–Frobenius 定理（该定理确保一个非负不可约矩阵的谱半径是一个单实的、主特征值）出发，推导在快速适应极限 $\\epsilon \\to 0$ 下的无量纲流行病阈值比 $\\kappa_{c} = \\beta_{c}/\\mu$。你的答案必须是一个单一的闭式解析表达式，包含 $\\bar{y}$ 和由 $W_{0}$ 构建的有效传播矩阵的谱半径。无需四舍五入。将你的最终答案表示为一个无量纲量；不包括单位。",
            "solution": "该问题要求计算在一个快速适应网络上的SIS模型的流行病阈值比 $\\kappa_c = \\beta_c/\\mu$。推导过程将通过分析无病平衡点（DFE）的线性稳定性来进行。\n\n节点 $i$ 的感染概率 $p_i(t)$ 的主导平均场动力学由以下常微分方程组给出：\n$$\n\\frac{d p_{i}}{d t} = -\\mu p_{i}(t) + \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t) p_{j}(t)\n$$\n其中 $W_{ij}(t) = Y_{ij}(t) W_{0,ij}$，$\\beta  0$ 是感染率，$\\mu  0$ 是恢复率。用向量形式表示，令 $\\mathbf{p}(t) = [p_1(t), ..., p_N(t)]^T$。\n\n首先，我们确定无病平衡点（DFE），即没有节点被感染的状态。这对应于对所有 $t$，$\\mathbf{p}(t) = \\mathbf{0}$。将对所有 $i$ 的 $p_i(t) = 0$ 代入主导方程得到：\n$$\n\\frac{d (0)}{d t} = -\\mu(0) + \\beta(1 - 0) \\sum_{j=1}^{N} W_{ij}(t)(0) = 0\n$$\n因此，$\\mathbf{p}_{\\text{DFE}} = \\mathbf{0}$ 确实是系统的一个不动点。\n\n流行病阈值由该DFE的稳定性决定。如果DFE不稳定，即一个小的扰动（疾病的引入）会随时间增长，则可能发生流行病。为了分析稳定性，我们在DFE（$\\mathbf{p} = \\mathbf{0}$）周围对系统进行线性化。该系统可以写成 $\\frac{d\\mathbf{p}}{dt} = \\mathbf{F}(\\mathbf{p}, t)$。线性化动力学由 $\\frac{d\\mathbf{p}}{dt} \\approx J(t) \\mathbf{p}$ 给出，其中 $J(t)$ 是在DFE处计算的雅可比矩阵。雅可比矩阵的条目是 $J_{ij}(t) = \\frac{\\partial F_i}{\\partial p_j}|_{\\mathbf{p}=\\mathbf{0}}$。\n\n偏导数是：\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j} \\left( -\\mu p_{i} + \\beta \\sum_{k=1}^{N} W_{ik}(t) p_{k} - \\beta p_i \\sum_{k=1}^{N} W_{ik}(t) p_{k} \\right)\n$$\n当 $i=j$ 时：\n$$\n\\frac{\\partial F_i}{\\partial p_i} = -\\mu + \\beta (1-p_i) W_{ii}(t) - \\beta \\sum_{k=1}^{N} W_{ik}(t) p_k\n$$\n当 $i\\neq j$ 时：\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\beta (1-p_i) W_{ij}(t)\n$$\n在DFE（$\\mathbf{p}=\\mathbf{0}$）处计算这些导数：\n$$\n\\frac{\\partial F_i}{\\partial p_i}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = -\\mu + \\beta W_{ii}(t)\n$$\n$$\n\\frac{\\partial F_i}{\\partial p_j}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = \\beta W_{ij}(t) \\quad (\\text{当 } i \\neq j)\n$$\n这些可以使用克罗内克δ函数 $\\delta_{ij}$ 来合并：\n$$\nJ_{ij}(t) = -\\mu \\delta_{ij} + \\beta W_{ij}(t)\n$$\n以矩阵形式，雅可比矩阵为 $J(t) = -\\mu I + \\beta W(t)$，其中 $I$ 是 $N \\times N$ 单位矩阵。在DFE附近的线性化系统是：\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta W(t) \\right) \\mathbf{p}\n$$\n这是一个时变系数线性系统。问题陈述，网络适应过程 $Y(t)$（因此也包括 $W(t)$）在一个快速时间尺度 $\\epsilon \\ll 1$ 上演化。在此极限（$\\epsilon \\to 0$）下，系统的稳定性由时间平均系统决定。这是多时间尺度动力系统理论中的一个标准结果。时间平均的雅可比矩阵 $\\langle J(t) \\rangle$ 是通过对快速过程 $Y(t)$ 的平稳分布取期望来获得的。\n$$\n\\langle J(t) \\rangle = \\mathbb{E}[-\\mu I + \\beta W(t)] = -\\mu I + \\beta \\mathbb{E}[W(t)]\n$$\n权重矩阵的期望是 $\\mathbb{E}[W(t)] = \\mathbb{E}[Y(t) \\odot W_0]$。由于 $W_0$ 是一个常数矩阵且期望是逐元素的：\n$$\n(\\mathbb{E}[W(t)])_{ij} = \\mathbb{E}[Y_{ij}(t) W_{0,ij}] = W_{0,ij} \\mathbb{E}[Y_{ij}(t)]\n$$\n给定平稳均值为 $\\mathbb{E}[Y_{ij}(t)] = \\bar{y}$，对所有节点对 $(i, j)$ 成立。因此，平均权重矩阵是：\n$$\nW_{\\text{eff}} = \\mathbb{E}[W(t)] = \\bar{y} W_0\n$$\n小扰动的动力学近似地由以下线性时不变（LTI）系统主导：\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta \\bar{y} W_0 \\right) \\mathbf{p}\n$$\n这个LTI系统的DFE的稳定性由矩阵 $M = -\\mu I + \\beta \\bar{y} W_0$ 的特征值决定。如果 $M$ 的所有特征值都具有负实部，则DFE是稳定的；如果至少有一个特征值具有正实部，则DFE是不稳定的。流行病阈值是临界条件，在该条件下，具有最大实部的特征值恰好为零。\n\n$M$ 的特征值（记为 $\\lambda_k(M)$）与 $W_0$ 的特征值（记为 $\\lambda_k(W_0)$）的关系如下：\n$$\n\\lambda_k(M) = -\\mu + \\beta \\bar{y} \\lambda_k(W_0)\n$$\n稳定性由 $M$ 的主特征值 $\\lambda_{\\text{dom}}(M)$ 决定，它对应于 $W_0$ 具有最大实部的特征值。\n$$\n\\lambda_{\\text{dom}}(M) = \\max_{k} \\text{Re}(\\lambda_k(M)) = -\\mu + \\beta \\bar{y} \\max_{k} \\text{Re}(\\lambda_k(W_0))\n$$\n问题陈述，基准权重矩阵 $W_0$ 是非负且不可约的。根据 Perron-Frobenius 定理，这样的矩阵有一个实的、正的、单的特征值，该特征值等于其谱半径 $\\rho(W_0)$。这个特征值 $\\rho(W_0)$ 大于或等于任何其他特征值的实部。因此，$\\max_{k} \\text{Re}(\\lambda_k(W_0)) = \\rho(W_0)$。\n\n因此，$M$ 的主特征值是：\n$$\n\\lambda_{\\text{dom}}(M) = -\\mu + \\beta \\bar{y} \\rho(W_0)\n$$\n如果 $\\lambda_{\\text{dom}}(M)  0$（感染消亡），则DFE是稳定的；如果 $\\lambda_{\\text{dom}}(M) > 0$（流行病传播），则DFE是不稳定的。流行病阈值由条件 $\\lambda_{\\text{dom}}(M) = 0$ 定义。令 $\\beta_c$ 为阈值处的临界感染率。\n$$\n-\\mu + \\beta_c \\bar{y} \\rho(W_0) = 0\n$$\n求解无量纲比率 $\\kappa_c = \\beta_c / \\mu$：\n$$\n\\beta_c \\bar{y} \\rho(W_0) = \\mu\n$$\n$$\n\\frac{\\beta_c}{\\mu} = \\frac{1}{\\bar{y} \\rho(W_0)}\n$$\n因此，流行病阈值比为 $\\kappa_c = \\frac{1}{\\bar{y} \\rho(W_0)}$。这个表达式包含 $\\bar{y}$ 和基准矩阵 $W_0$ 的谱半径。“有效传播矩阵”可以定义为 $W_{\\text{eff}} = \\bar{y} W_0$，其谱半径为 $\\rho(W_{\\text{eff}}) = \\bar{y} \\rho(W_0)$，因为 $\\bar{y} > 0$。这个结果与阈值条件 $R_0 = (\\beta_c/\\mu)\\rho(W_{\\text{eff}}) = 1$ 一致。\n$\\kappa_c$ 的最终表达式仅从问题陈述和标准数学定理推导得出。",
            "answer": "$$\\boxed{\\frac{1}{\\bar{y} \\rho(W_0)}}$$"
        },
        {
            "introduction": "在理论推导之外，计算方法为我们揭示协同演化系统中的复杂涌现行为提供了强有力的工具。本练习将介绍迟滞（hysteresis）和双稳态（bistability）现象，这是许多自适应系统中的常见特征。你将通过编写程序来数值追踪系统的平衡点，并确定系统发生突变的“临界点”（tipping points），从而亲手体验这些模型中复杂的、依赖于历史路径的动态行为。",
            "id": "4269188",
            "problem": "考虑一个自适应（共同演化）网络上的可逆阈值动力学，该动力学在群体水平上通过一个固定度为 $k \\in \\mathbb{N}$ 的同质网络上的采纳者比例 $x \\in [0,1]$ 来建模。当且仅当一个节点的已采纳邻居的比例至少为阈值 $\\theta \\in (0,1)$ 时，该节点才会采纳。网络通过以强度 $\\omega \\in [0,1]$ 重连不一致边来进行共同演化，这会减少状态间的混合。在退火平均场近似下，一个随机抽样邻居是已采纳者的概率会随着重连强度线性衰减，因此有效邻居采纳概率为 $q(\\omega, x) = (1 - \\omega) x$。在充分混合二项式近似下，一个节点的已采纳邻居数量被建模为一个参数为 $k$ 和 $q(\\omega, x)$ 的二项随机变量。满足阈值规则的节点比例由下式给出\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}.\n$$\n一个可逆平衡是满足自洽条件的任意 $x^\\ast \\in [0,1]$\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big).\n$$\n由于当 $k$ 足够大且 $\\theta$ 为中间值时，$T_k$ 函数很陡峭，因此可能共存多个平衡点。随着 $\\omega$ 的变化，系统所处的稳定平衡可能取决于 $\\omega$ 是增加还是减少，从而产生滞后回线。我们将通过在两个方向上对平衡点 $x^\\ast(\\omega)$ 进行数值延拓来分析滞后现象：\n- 递增方向：在 $\\omega = 0$ 处以 $x_0 = 1$ 初始化，并以 $\\Delta \\omega$ 为步长将 $\\omega$ 增加到指定的 $\\omega_{\\max}$，使用前一个平衡点作为初始条件，通过对映射 $x \\mapsto T_k\\big((1 - \\omega) x, \\theta\\big)$ 进行不动点迭代来寻找下一个平衡点。\n- 递减方向：在 $\\omega = \\omega_{\\max}$ 处以 $x_0 = 0$ 初始化，并以 $\\Delta \\omega$ 为步长将 $\\omega$ 减少到 $0$，使用延拓和相同的不动点迭代方法。\n\n将上转变点 $\\omega_{\\uparrow}$ 定义为在递增延拓中，收敛平衡点首次满足 $x^\\ast(\\omega) \\le \\xi$ 的最小 $\\omega$ 值；将下转变点 $\\omega_{\\downarrow}$ 定义为在递减延拓中，收敛平衡点首次满足 $x^\\ast(\\omega) \\ge \\xi$ 的最大 $\\omega$ 值。其中 $\\xi \\in (0,1)$ 是区分低采纳分支和高采纳分支的固定判别标准（使用 $\\xi = 0.5$）。滞后宽度则为\n$$\nW = \\omega_{\\downarrow} - \\omega_{\\uparrow},\n$$\n并约定如果在扫描区间内 $\\omega_{\\uparrow}$ 或 $\\omega_{\\downarrow}$ 不存在，则 $W$ 设为 $0$。\n\n您的任务是为以下参数集测试套件实现这种基于延拓的滞后宽度计算，每个参数集指定为一个元组 $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$：\n- 测试用例 1：$(20, 0.45, 0.90, 0.002)$。\n- 测试用例 2：$(30, 0.40, 0.90, 0.002)$。\n- 测试用例 3：$(8, 0.60, 0.95, 0.002)$。\n- 测试用例 4：$(12, 0.50, 0.95, 0.002)$。\n\n所有量均为无单位量。每个 $\\omega$ 步长使用 $10^{-10}$ 的不动点迭代容差和最多 $10000$ 次迭代。将 $q(\\omega, x)$ 裁剪到区间 $[0,1]$ 内以确保数值稳定性。对于二项生存函数，请使用数值稳定的计算方法。\n\n您的程序应生成单行输出，其中包含各测试用例的滞后宽度，形式为用方括号括起来的逗号分隔的十进制数列表，每个数四舍五入到六位小数。例如，输出应类似于 $[w_1,w_2,w_3,w_4]$，其中每个 $w_i$ 是小数点后有六位的浮点数。",
            "solution": "该问题要求计算共同演化网络上阈值动力学平均场模型中的滞后宽度。解决方案涉及实现一种数值延拓方法，以追踪当一个控制参数先沿递增方向、再沿递减方向变化时，系统的平衡点。\n\n系统状态由采纳者比例 $x \\in [0,1]$ 描述。网络是同质的，具有固定的度 $k \\in \\mathbb{N}$。动力学由阈值规则控制，即当一个节点的邻居中采纳者的比例至少为 $\\theta \\in (0,1)$ 时，该节点采纳。网络以强度 $\\omega \\in [0,1]$ 共同演化，该强度代表了不同状态（采纳者与非采纳者）节点之间连接的重连速率，从而有效减少了网络中的混合。\n\n在退火平均场近似下，随机节点的邻居为采纳者的有效概率由 $q(\\omega, x) = (1 - \\omega) x$ 给出。使用二项式近似来计算已采纳邻居的数量，满足采纳阈值的节点比例由函数 $T_k\\big(q(\\omega, x), \\theta\\big)$ 给出。该函数是具有 $k$ 次试验和成功概率 $q(\\omega, x)$ 的二项分布的生存函数：\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}\n$$\n其中 $m$ 是已采纳邻居的数量。平衡态 $x^\\ast$ 是此映射的一个不动点，满足自洽条件：\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big)\n$$\n在某些参数范围（足够大的 $k$ 和中等大小的 $\\theta$）内，函数 $T_k$ 是一个陡峭的S形函数，它可以与直线 $y=x$ 在多个点相交，导致双稳态。系统的状态将因此依赖于其历史，这种现象称为滞后。我们的任务是通过计算其宽度 $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$ 来量化这种滞后现象。\n\n滞后宽度 $W$ 的计算通过指定的数值延拓算法进行。\n\n首先，我们设计一个鲁棒的不动点求解器，用以寻找给定参数集 $(k, \\theta, \\omega)$ 的平衡点 $x^\\ast$。该求解器从初始猜测值 $x_0$ 开始，实现迭代映射 $x_{n+1} = T_k\\big((1-\\omega)x_n, \\theta\\big)$。迭代持续进行，直到连续迭代值之间的变化 $|x_{n+1} - x_n|$ 小于指定的容差 $10^{-10}$，或达到最大迭代次数 $10000$ 次。函数 $T_k(q, \\theta)$ 在计算上等同于二项随机变量 $M \\sim \\text{Binomial}(k, q)$ 的生存函数，表示 $P(M \\ge \\lceil \\theta k \\rceil)$。这是通过使用一个稳定的库函数进行数值计算的，这样做比直接对概率质量函数求和更可取，以避免下溢/上溢问题。具体来说，如果 $m_{min} = \\lceil \\theta k \\rceil$，则 $P(M \\ge m_{min}) = P(M > m_{min}-1)$。\n\n其次，我们执行两次延拓运行来寻找转变点 $\\omega_{\\uparrow}$ 和 $\\omega_{\\downarrow}$。\n\n递增延拓运行用于找到上转变点 $\\omega_{\\uparrow}$。参数 $\\omega$ 从 $\\omega=0$ 以 $\\Delta \\omega$ 为步长增加到 $\\omega = \\omega_{\\max}$。该过程在 $\\omega=0$ 时从一个高采纳初始状态 $x=1$ 开始。对于序列中的每个 $\\omega$ 值，调用不动点求解器以找到相应的平衡点 $x^\\ast(\\omega)$。在给定的 $\\omega$ 处，求解器的初始猜测值是前一个 $\\omega$ 步得到的收敛平衡点 $x^\\ast$。这种延拓方法能有效地追踪稳定平衡点的演化。上转变点 $\\omega_{\\uparrow}$ 被定义为遇到的第一个（最小的）使平衡点下降到或低于判别阈值 $\\xi = 0.5$（即 $x^\\ast(\\omega) \\le 0.5$）的 $\\omega$ 值。如果在扫描区间 $[0, \\omega_{\\max}]$ 内没有发生这样的转变，则为此计算目的，$\\omega_{\\uparrow}$ 被视为不存在。\n\n递减延拓运行用于找到下转变点 $\\omega_{\\downarrow}$。这个过程与第一个类似，但方向相反。参数 $\\omega$ 从 $\\omega = \\omega_{\\max}$ 以 $\\Delta \\omega$ 为步长减小到 $\\omega=0$。该过程在 $\\omega=\\omega_{\\max}$ 时从一个低采纳状态 $x=0$ 初始化。在每一步中再次使用不动点求解器并进行延拓。下转变点 $\\omega_{\\downarrow}$ 是遇到的第一个（最大的）使平衡点跃升到或高于判别阈值 $x^\\ast(\\omega) \\ge 0.5$ 的 $\\omega$ 值。如果这种转变没有发生，则 $\\omega_{\\downarrow}$ 被视为不存在。\n\n最后，计算滞后宽度 $W$。如果 $\\omega_{\\uparrow}$ 和 $\\omega_{\\downarrow}$ 都被找到，则宽度为 $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$。如果在指定的 $\\omega$ 范围内任一转变点未被找到，则滞后宽度定义为 $W=0$。\n\n将此完整过程应用于测试套件中提供的四个参数集 $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$ 中的每一个，以获得相应的滞后宽度。在计算过程中，有效概率 $q(\\omega,x)$ 被裁剪到区间 $[0,1]$ 内，以确保二项生存函数计算的数值稳定性。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the hysteresis width for a coevolutionary threshold model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (20, 0.45, 0.90, 0.002),\n        (30, 0.40, 0.90, 0.002),\n        (8, 0.60, 0.95, 0.002),\n        (12, 0.50, 0.95, 0.002),\n    ]\n\n    results = []\n\n    # Numerical parameters\n    TOLERANCE = 1e-10\n    MAX_ITERATIONS = 10000\n    XI = 0.5\n\n    def find_equilibrium(omega, x_initial, k, theta):\n        \"\"\"\n        Finds the equilibrium fraction of adopters x* for given parameters\n        using fixed-point iteration.\n        \"\"\"\n        x_prev = x_initial\n        for _ in range(MAX_ITERATIONS):\n            # Effective neighbor adoption probability, clipped for stability.\n            q = np.clip((1.0 - omega) * x_prev, 0.0, 1.0)\n            \n            # Adoption threshold (minimum number of adopted neighbors).\n            m_min = np.ceil(theta * k)\n            \n            # The problem defines T_k as P(M >= m_min).\n            # scipy.stats.binom.sf(k_val, n, p) computes P(M > k_val).\n            # So, P(M >= m_min) is equivalent to P(M > m_min - 1).\n            if m_min > k:\n                x_next = 0.0\n            elif m_min = 0:\n                x_next = 1.0\n            else:\n                x_next = binom.sf(m_min - 1, k, q)\n\n            if abs(x_next - x_prev)  TOLERANCE:\n                return x_next\n            x_prev = x_next\n        return x_prev # Return last value if max iterations reached\n\n    for k, theta, omega_max, delta_omega in test_cases:\n        # Generate omega values for the scan\n        num_steps = int(round(omega_max / delta_omega))\n        omega_vals = np.linspace(0, omega_max, num_steps + 1)\n        \n        omega_up = None\n        omega_down = None\n\n        # --- Increasing continuation to find omega_up ---\n        x_prev = 1.0\n        for omega in omega_vals:\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr = XI:\n                omega_up = omega\n                break\n            x_prev = x_curr\n\n        # --- Decreasing continuation to find omega_down ---\n        x_prev = 0.0\n        for omega in omega_vals[::-1]: # Iterate in reverse\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr >= XI:\n                omega_down = omega\n                break\n            x_prev = x_curr\n\n        # --- Calculate hysteresis width ---\n        if omega_up is not None and omega_down is not None:\n            width = omega_down - omega_up\n        else:\n            width = 0.0\n        \n        # Ensure width is not negative due to numerical precision\n        results.append(max(0.0, width))\n\n    # Format output as a comma-separated list of floats with 6 decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}