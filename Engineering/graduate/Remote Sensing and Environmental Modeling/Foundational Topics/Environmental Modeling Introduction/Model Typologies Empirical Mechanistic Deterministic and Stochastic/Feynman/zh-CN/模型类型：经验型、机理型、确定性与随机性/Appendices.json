{
    "hands_on_practices": [
        {
            "introduction": "敏感性分析是理解任何环境模型的关键第一步。通过计算雅可比矩阵 (Jacobian matrix)，我们可以量化模型的输出（例如卫星观测的反射率）如何响应其物理参数（例如地表反照率或气溶胶光学厚度）的微小变化。本练习  为模型反演和参数稳定性评估等更高级的主题奠定了坚实的数学基础。",
            "id": "3828596",
            "problem": "考虑一个在平行平面大气中、朗伯表面上、单次散射条件下，用于遥感大气层顶（TOA）反射率 $y$ 的机械确定性正向模型。该模型使用 Beer–Lambert 透射率和一个各向同性单次散射路径项，写作\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\frac{\\tau}{\\mu_{0}}\\right)\\exp\\!\\left(-\\frac{\\tau}{\\mu}\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau,\n$$\n其中 $\\rho$ 是地表反照率（朗伯双向反射因子），$\\tau$ 是气溶胶光学厚度，$\\mu_{0}=\\cos(\\theta_{0})$ 和 $\\mu=\\cos(\\theta)$ 是由太阳天顶角 $\\theta_{0}$ 和观测天顶角 $\\theta$ 定义的太阳和观测方向余弦，$\\omega$ 是单次散射反照率，$P$ 是相函数值（对于各向同性散射，设为 $P=1$）。角度单位为度。\n\n- 几何与光学特性：$\\theta_{0}=60^{\\circ}$，$\\theta=0^{\\circ}$，$\\omega=0.95$，$P=1$，因此 $\\mu_{0}=\\cos(60^{\\circ})$ 且 $\\mu=\\cos(0^{\\circ})$。\n- 参数矢量：$\\theta=\\begin{pmatrix}\\rho \\\\ \\tau\\end{pmatrix}$，其标称值为 $\\rho^{\\star}=0.2$ 和 $\\tau^{\\star}=0.3$。\n- 确定性扰动：$\\Delta\\theta=\\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix}$，其中 $\\Delta\\rho=+0.01$ 且 $\\Delta\\tau=-0.02$。\n\n从 Beer–Lambert 透射定律和在平行平面大气中路径反射率的单次散射近似出发，推导雅可比行向量 $J(\\theta^{\\star})=\\begin{pmatrix}\\frac{\\partial y}{\\partial \\rho}  \\frac{\\partial y}{\\partial \\tau}\\end{pmatrix}\\bigg|_{\\theta^{\\star}}$，并评估确定性一阶灵敏度 $\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta$。将您最终的 $\\Delta y$ 数值结果四舍五入至四位有效数字。将最终的反射率变化表示为无量纲小数。然后，简要解释在给定条件下，反射率在局部对 $\\rho$ 和 $\\tau$ 哪个更敏感，并评论由 $\\Delta y$ 相对于 $y(\\theta^{\\star})$ 的量级所隐含的参数稳定性。",
            "solution": "该问题经评估具有科学依据、适定、客观且完整。它代表了对一个简化辐射传输模型的标准一阶灵敏度分析，这是遥感和环境建模中的一项常见任务。所有必要的数据和定义均已提供，不存在矛盾或物理上不合理的假设。因此，该问题是有效的，可以推导出解决方案。\n\n大气层顶（TOA）反射率 $y$ 的正向模型由下式给出：\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\frac{\\tau}{\\mu_{0}}\\right)\\exp\\!\\left(-\\frac{\\tau}{\\mu}\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau\n$$\n通过组合指数项，可以简化此表达式，该指数项代表双程大气透射率（向下和向上路径）：\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\tau\\left(\\frac{1}{\\mu_{0}} + \\frac{1}{\\mu}\\right)\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau\n$$\n\n首先，我们代入给定的几何和光学特性常数值：\n- 太阳天顶角 $\\theta_{0} = 60^{\\circ}$，所以 $\\mu_{0} = \\cos(60^{\\circ}) = 0.5$。\n- 观测天顶角 $\\theta = 0^{\\circ}$，所以 $\\mu = \\cos(0^{\\circ}) = 1$。\n- 单次散射反照率 $\\omega = 0.95$。\n- 各向同性相函数值 $P = 1$。\n\n将这些值代入模型方程，将其简化为仅关于 $\\rho$ 和 $\\tau$ 的函数：\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp\\!\\left(-\\tau\\left(\\frac{1}{0.5} + \\frac{1}{1}\\right)\\right) + \\frac{0.95 \\times 1}{4 \\times 0.5 \\times 1}\\,\\tau\n$$\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp(-3\\tau) + \\frac{0.95}{2}\\,\\tau\n$$\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau\n$$\n\n目标是计算围绕标称点 $\\theta^{\\star} = \\begin{pmatrix}\\rho^{\\star} \\\\ \\tau^{\\star}\\end{pmatrix}$ 的扰动 $\\Delta\\theta = \\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix}$ 引起的一阶变化 $\\Delta y$。这由截断至一阶的泰勒展开给出：\n$$\n\\Delta y \\approx \\frac{\\partial y}{\\partial \\rho}\\bigg|_{\\theta^{\\star}}\\Delta\\rho + \\frac{\\partial y}{\\partial \\tau}\\bigg|_{\\theta^{\\star}}\\Delta\\tau\n$$\n这可以写成矩阵形式 $\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta$，其中 $J(\\theta^{\\star})$ 是在标称点 $\\theta^{\\star}$ 处求值的雅可比行向量。\n\n雅可比行向量为 $J(\\rho, \\tau) = \\begin{pmatrix}\\frac{\\partial y}{\\partial \\rho}  \\frac{\\partial y}{\\partial \\tau}\\end{pmatrix}$。我们计算 $y(\\rho, \\tau)$ 的偏导数：\n\n1.  关于地表反照率 $\\rho$ 的偏导数：\n    $$\n    \\frac{\\partial y}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left( \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau \\right) = \\exp(-3\\tau)\n    $$\n\n2.  关于气溶膠光学厚度 $\\tau$ 的偏导数：\n    $$\n    \\frac{\\partial y}{\\partial \\tau} = \\frac{\\partial}{\\partial \\tau} \\left( \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau \\right) = \\rho\\,\\exp(-3\\tau)(-3) + 0.475 = -3\\rho\\,\\exp(-3\\tau) + 0.475\n    $$\n\n所以，雅可比向量为：\n$$\nJ(\\rho, \\tau) = \\begin{pmatrix} \\exp(-3\\tau)  -3\\rho\\,\\exp(-3\\tau) + 0.475 \\end{pmatrix}\n$$\n\n接下来，我们在标称参数值 $\\theta^{\\star} = \\begin{pmatrix}\\rho^{\\star} \\\\ \\tau^{\\star}\\end{pmatrix} = \\begin{pmatrix}0.2 \\\\ 0.3\\end{pmatrix}$ 处计算此雅可比矩阵：\n$$\nJ(\\theta^{\\star}) = J(0.2, 0.3) = \\begin{pmatrix} \\exp(-3 \\times 0.3)  -3(0.2)\\,\\exp(-3 \\times 0.3) + 0.475 \\end{pmatrix}\n$$\n$$\nJ(\\theta^{\\star}) = \\begin{pmatrix} \\exp(-0.9)  -0.6\\,\\exp(-0.9) + 0.475 \\end{pmatrix}\n$$\n\n现在，我们使用扰动向量 $\\Delta\\theta = \\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix} = \\begin{pmatrix}+0.01 \\\\ -0.02\\end{pmatrix}$ 来计算一阶灵敏度 $\\Delta y$：\n$$\n\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta = \\begin{pmatrix} \\exp(-0.9)  -0.6\\,\\exp(-0.9) + 0.475 \\end{pmatrix} \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\n\\Delta y \\approx (0.01)\\exp(-0.9) + (-0.02)(-0.6\\,\\exp(-0.9) + 0.475)\n$$\n$$\n\\Delta y \\approx 0.01\\,\\exp(-0.9) + 0.012\\,\\exp(-0.9) - (0.02)(0.475)\n$$\n$$\n\\Delta y \\approx 0.022\\,\\exp(-0.9) - 0.0095\n$$\n使用数值 $\\exp(-0.9) \\approx 0.40656966$：\n$$\n\\Delta y \\approx 0.022 \\times 0.40656966 - 0.0095\n$$\n$$\n\\Delta y \\approx 0.0089445325 - 0.0095\n$$\n$$\n\\Delta y \\approx -0.0005554675\n$$\n将 $\\Delta y$ 的结果四舍五入到四位有效数字：\n$$\n\\Delta y \\approx -0.0005555\n$$\n\n**解释：**\n1.  **灵敏度：** 为确定反射率 $y$ 在局部对 $\\rho$ 和 $\\tau$ 哪个更敏感，我们比较在 $\\theta^{\\star}$ 处的雅可比分量的大小：\n    -   $J_{\\rho} = \\frac{\\partial y}{\\partial \\rho} \\bigg|_{\\theta^{\\star}} = \\exp(-0.9) \\approx 0.4066$\n    -   $J_{\\tau} = \\frac{\\partial y}{\\partial \\tau} \\bigg|_{\\theta^{\\star}} = -0.6\\,\\exp(-0.9) + 0.475 \\approx -0.2440 + 0.475 = 0.2310$\n    由于 $|J_{\\rho}| \\approx 0.4066 > |J_{\\tau}| \\approx 0.2310$，TOA反射率在局部对地表反照率 $\\rho$ 的单位变化的敏感度高于对气溶胶光学厚度 $\\tau$ 的单位变化的敏感度。\n\n2.  **参数稳定性：** 为了评估稳定性，我们将预测变化的大小 $|\\Delta y|$ 与标称反射率值 $y(\\theta^{\\star})$进行比较。\n    首先，我们计算 $y(\\theta^{\\star})$：\n    $$\n    y(\\theta^{\\star}) = y(0.2, 0.3) = 0.2\\,\\exp(-3 \\times 0.3) + 0.475 \\times 0.3\n    $$\n    $$\n    y(\\theta^{\\star}) = 0.2\\,\\exp(-0.9) + 0.1425 \\approx 0.2 \\times 0.4066 + 0.1425 = 0.08132 + 0.1425 = 0.22382\n    $$\n    相对变化为：\n    $$\n    \\frac{|\\Delta y|}{|y(\\theta^{\\star})|} \\approx \\frac{0.0005555}{0.22382} \\approx 0.002482\n    $$\n    这对应于约 $0.25\\%$ 的变化。相对输入扰动为 $\\Delta\\rho/\\rho^{\\star} = 0.01/0.2 = 5\\%$ 和 $|\\Delta\\tau/\\tau^{\\star}| = |-0.02/0.3| \\approx 6.7\\%$。由于相对输出变化（$0.25\\%$）远小于相对输入扰动，因此该模型在此工作点附近被认为是参数稳定的。",
            "answer": "$$\n\\boxed{-0.0005555}\n$$"
        },
        {
            "introduction": "现实世界中的模型输入往往不是完美已知的，它们总伴随着不确定性。本练习  建立在敏感性分析的基础上，演示了如何使用一阶泰勒级数近似，将输入变量（如叶面积指数）的不确定性通过非线性机理模型进行传播，从而估算输出（如光合有效辐射吸收分数）的不确定性。这是从确定性预测迈向概率性预报的关键一步。",
            "id": "3828545",
            "problem": "考虑一个在植被遥感中广泛使用的单参数机理冠层辐射模型，其中光合有效辐射吸收分数 (fAPAR) 通过比尔-朗伯定律与叶面积指数 (LAI) 相关联：$$f(X) = 1 - \\exp(-k X),$$ 其中 $X$ 是 LAI，$k$ 是消光系数。假设一个航空或卫星像元包含 LAI 的亚像元变异性，该变异性被建模为一个随机变量 $X$，其均值为 $\\mathbb{E}[X] = \\mu$，方差为 $\\operatorname{Var}(X) = \\sigma^{2}$。对于特定的生物群系和太阳-传感器几何，取 $k = 0.5$（无量纲）。假设该站点的实地数据给出 LAI 的 $\\mu = 3$ 和 $\\sigma^{2} = 0.16$，两者均无量纲。\n\n任务：\n1. 从 $f(X)$ 在 $x = \\mu$ 处的一阶泰勒展开和方差的定义出发，推导出一阶不确定性传播表达式 $$\\operatorname{Var}(f(X)) \\approx \\big(f'(\\mu)\\big)^{2}\\,\\operatorname{Var}(X).$$ 除了泰勒展开和方差的性质外，避免引用任何预先推导的传播法则。\n2. 使用推导出的表达式，用 $\\mu$、$\\sigma^{2}$ 和 $k$ 表示该模型中 $f(X)$ 的近似方差，然后对 $k = 0.5$、$\\mu = 3$ 和 $\\sigma^{2} = 0.16$ 进行数值计算。\n3. 为评估线性近似对于此特定非线性的有效性，定义无量纲有效性指标 $$\\varepsilon = \\frac{|f''(\\mu)|\\,\\sigma}{|f'(\\mu)|}.$$ 计算给定 $k$、$\\mu$ 和 $\\sigma^{2}$ 下的 $\\varepsilon$。在你的推理中可以使用诸如“小 $\\varepsilon$ 意味着高有效性”之类的解释，但最终答案只需报告 $\\varepsilon$ 的纯数值（无单位）。最终答案无需四舍五入。\n\n注：如果你额外假设 $X$ 服从高斯分布，你可以计算 $f(X)$ 的精确方差，以与一阶近似进行比较作为评估的一部分，但你仍必须按照任务1的要求从第一性原理推导出一阶表达式。最终提交的答案仅为 $\\varepsilon$ 的单个数值，无单位。",
            "solution": "所述问题在科学上是合理的，数学上是适定的，并包含进行求解所需的所有必要信息。该模型是比尔-朗伯定律在遥感中的一个标准应用，任务涉及不确定性分析中的标准数学步骤。因此，该问题是有效的。\n\n问题的核心是分析函数 $f(X) = 1 - \\exp(-kX)$ 的不确定性传播，其中 $X$ 是一个随机变量，其均值为 $\\mathbb{E}[X] = \\mu$，方差为 $\\operatorname{Var}(X) = \\sigma^2$。\n\n**任务1：一阶不确定性传播表达式的推导**\n\n我们从函数 $f(X)$ 在点 $X = \\mu$ 附近的一阶泰勒级数展开开始：\n$$f(X) \\approx f(\\mu) + f'(\\mu)(X-\\mu)$$\n其中 $f'(\\mu)$ 是 $f(X)$ 对 $X$ 的一阶导数在 $X = \\mu$ 处的值。\n\n函数 $g(X)$ 的方差定义为 $\\operatorname{Var}(g(X)) = \\mathbb{E}[(g(X) - \\mathbb{E}[g(X)])^2]$。为了找到 $f(X)$ 的近似方差，我们将方差算子 $\\operatorname{Var}(\\cdot)$ 应用于泰勒展开式。\n$$\\operatorname{Var}(f(X)) \\approx \\operatorname{Var}\\left(f(\\mu) + f'(\\mu)(X-\\mu)\\right)$$\n我们可以重新排列方差算子内部的项：\n$$\\operatorname{Var}(f(X)) \\approx \\operatorname{Var}\\left(f'(\\mu)X + (f(\\mu) - f'(\\mu)\\mu)\\right)$$\n我们使用方差的基本性质，即对于任何随机变量 $Z$ 和常数 $a$、$b$，有 $\\operatorname{Var}(aZ + b) = a^2\\operatorname{Var}(Z)$。在我们的表达式中，$X$ 是随机变量，$f'(\\mu)$ 是一个常数（因为它是在特定点 $\\mu$ 处求值的导数），而整个项 $(f(\\mu) - f'(\\mu)\\mu)$ 也是一个常数。\n应用此性质，我们确定 $a = f'(\\mu)$ 和 $b = f(\\mu) - f'(\\mu)\\mu$。这给出：\n$$\\operatorname{Var}(f'(\\mu)X + (f(\\mu) - f'(\\mu)\\mu)) = \\left(f'(\\mu)\\right)^2 \\operatorname{Var}(X)$$\n因此，通过代回，我们得到方差传播的一阶近似：\n$$\\operatorname{Var}(f(X)) \\approx \\left(f'(\\mu)\\right)^2 \\operatorname{Var}(X)$$\n这就是基于一阶泰勒展开和方差定义所要求的推导。\n\n**任务2：应用于fAPAR模型和数值评估**\n\n给定的模型是 $f(X) = 1 - \\exp(-kX)$。首先，我们必须求它关于 $X$ 的导数。\n$$f'(X) = \\frac{d}{dX} \\left(1 - \\exp(-kX)\\right) = 0 - \\exp(-kX) \\cdot (-k) = k\\exp(-kX)$$\n接下来，我们在平均 LAI，即 $X = \\mu$ 处，评估这个导数：\n$$f'(\\mu) = k\\exp(-k\\mu)$$\n将此表达式代入任务1中推导出的方差公式，其中 $\\operatorname{Var}(X) = \\sigma^2$：\n$$\\operatorname{Var}(f(X)) \\approx \\left(k\\exp(-k\\mu)\\right)^2 \\sigma^2 = k^2\\exp(-2k\\mu)\\sigma^2$$\n这就是用 $\\mu$、$\\sigma^2$ 和 $k$ 表示的 $f(X)$ 的近似方差。\n\n现在，我们使用给定值 $k = 0.5$、$\\mu = 3$ 和 $\\sigma^2 = 0.16$ 对此表达式进行数值计算。\n$$\\operatorname{Var}(f(X)) \\approx (0.5)^2 \\exp(-2 \\cdot 0.5 \\cdot 3) \\cdot 0.16$$\n$$\\operatorname{Var}(f(X)) \\approx 0.25 \\cdot \\exp(-3) \\cdot 0.16$$\n$$\\operatorname{Var}(f(X)) \\approx 0.04 \\exp(-3)$$\n在数值上，这个值大约是 $0.04 \\times 0.049787 \\approx 0.001991$。\n\n**任务3：无量纲有效性指标 $\\varepsilon$ 的计算**\n\n有效性指标定义为 $\\varepsilon = \\frac{|f''(\\mu)|\\,\\sigma}{|f'(\\mu)|}$。这需要 $f(X)$ 的二阶导数。\n我们对 $f'(X) = k\\exp(-kX)$ 关于 $X$ 求导：\n$$f''(X) = \\frac{d}{dX} \\left(k\\exp(-kX)\\right) = k \\cdot \\exp(-kX) \\cdot (-k) = -k^2\\exp(-kX)$$\n现在，我们在 $X = \\mu$ 处评估一阶和二阶导数：\n$$f'(\\mu) = k\\exp(-k\\mu)$$\n$$f''(\\mu) = -k^2\\exp(-k\\mu)$$\n我们取二阶导数的绝对值。由于 $k^2$ 和 $\\exp(-k\\mu)$ 总是正的，这给出：\n$$|f''(\\mu)| = |-k^2\\exp(-k\\mu)| = k^2\\exp(-k\\mu)$$\n标准差 $\\sigma$ 是方差的平方根：$\\sigma = \\sqrt{\\sigma^2} = \\sqrt{0.16} = 0.4$。\n\n现在我们将这些分量代入 $\\varepsilon$ 的表达式中：\n$$\\varepsilon = \\frac{\\left(k^2\\exp(-k\\mu)\\right) \\cdot \\sigma}{k\\exp(-k\\mu)}$$\n我们可以通过消去公因式来简化这个表达式。项 $\\exp(-k\\mu)$ 同时出现在分子和分母中，可以消掉。一个因子 $k$ 也可以消掉。\n$$\\varepsilon = \\frac{k^2 \\sigma}{k} = k\\sigma$$\n这个简洁的结果表明，对于这个特定的指数模型，线性近似的有效性仅取决于消光系数和输入变量标准差的乘积。\n\n最后，我们使用 $k = 0.5$ 和 $\\sigma = 0.4$ 计算 $\\varepsilon$ 的数值：\n$$\\varepsilon = 0.5 \\cdot 0.4 = 0.2$$\n$\\varepsilon$ 的值为 $0.2$。这个无量纲数提供了一个衡量泰勒展开中二阶（非线性）项相对于一阶（线性）项重要性的度量。通常认为 $\\varepsilon \\ll 1$ 的值表明一阶近似是合理的。这里，$\\varepsilon = 0.2$ 表明非线性是存在的，但线性近似对于许多目的来说可能是足够的，尽管并非完全准确。",
            "answer": "$$\\boxed{0.2}$$"
        },
        {
            "introduction": "建模者经常面临一个核心挑战：如何在不同类型的模型（例如，简单的经验模型与复杂的机理模型）之间做出选择。本练习  模拟了一个现实的空气质量预报场景，并运用统计理论来计算被选定模型的真实预期误差，揭示了模型选择过程本身可能引入的“乐观”偏差。这个实践强调了样本内性能与样本外预测能力之间的关键区别，这是评估模型泛化能力的重中之重。",
            "id": "3828542",
            "problem": "在一个使用基于卫星遥感的区域性空气质量预报应用中，假设真实的日均颗粒物浓度（记为 $Y$，单位为 $\\mu\\text{g/m}^3$）由一个未知的机理过程和不可约的噪声共同产生。现有两种相互竞争的预报模型可供考虑，它们反映了不同的模型类型：\n\n- 模型 $1$ 是一种从遥感反射率指数到 $Y$ 的经验确定性回归模型，其条件恒定预报偏差为 $b_1$，预测方差为 $v_1$，该方差源于参数估计的不确定性。\n- 模型 $2$ 是一种机理随机化学输运模型，其条件恒定预报偏差为 $b_2$，预测方差为 $v_2$，该方差源于过程噪声和参数不确定性。\n\n假设不可约的测量过程噪声方差为 $\\sigma^2$，因此对于模型 $i \\in \\{1,2\\}$，其单步预测残差 $R_{i,t} = Y_t - \\hat{Y}_{i,t}$ 被建模为 $R_{i,t} \\sim \\mathcal{N}(b_i, \\omega_i^2)$，其中 $\\omega_i^2 = v_i + \\sigma^2$。这些残差在不同日期 $t$ 之间是独立的，并且由于采用了不相交的随机校准折叠，它们在不同模型之间也是独立的。一个选择协议在 $n$ 个历史日的数据上训练每个模型，并选择具有较小经验均方残差 $\\hat{E}_i = \\frac{1}{n}\\sum_{t=1}^{n} R_{i,t}^2$ 的模型。下游的预报将直接使用被选中的模型，而不进行进一步的平均。\n\n请从偏差-方差分解和中心极限定理（CLT）出发，推导所选模型的期望样本外平方预报误差的表达式，然后使用以下科学上合理的参数值对其进行评估：\n- $b_1 = +1.2$ $\\mu\\text{g/m}^3$, $v_1 = 1.0$ $(\\mu\\text{g/m}^3)^2$,\n- $b_2 = -0.3$ $\\mu\\text{g/m}^3$, $v_2 = 3.5$ $(\\mu\\text{g/m}^3)^2$,\n- $\\sigma^2 = 4.0$ $(\\mu\\text{g/m}^3)^2$, $n = 30$.\n\n将最终数值答案四舍五入至四位有效数字。期望平方误差以 $(\\mu\\text{g/m}^3)^2$ 为单位表示。",
            "solution": "令 $E_{out}$ 为所选模型的期望样本外平方预报误差。选择过程的规则是：如果模型1的经验均方误差 $\\hat{E}_1$ 小于模型2的经验均方误差 $\\hat{E}_2$，则选择模型1，否则选择模型2。对于某个未来时间 $t' > n$，模型 $i$ 的样本外平方误差为 $R_{i,t'}^2$。该量的期望值是模型的真实风险，我们记为 $\\mathcal{R}_i$。\n\n所选模型的期望样本外误差可以表示为各个模型真实风险的加权平均值，其中权重是选择每个模型的概率。\n$$E_{out} = \\mathcal{R}_1 \\cdot P(\\text{选择模型 1}) + \\mathcal{R}_2 \\cdot P(\\text{选择模型 2})$$\n选择事件取决于训练数据 $\\{R_{i,t}\\}_{t=1}^n$，而真实风险 $\\mathcal{R}_i$ 是底层数据生成过程的属性，与特定的训练集无关。具体来说，样本外残差 $R_{i,t'}$ 与样本内残差 $R_{i,t}$ 是独立的。\n\n真实风险 $\\mathcal{R}_i$ 是期望平方残差，根据偏差-方差分解，它等于偏差平方与方差之和。\n$$\\mathcal{R}_i = E[R_{i,t}^2] = (E[R_{i,t}])^2 + \\text{Var}(R_{i,t})$$\n已知 $R_{i,t} \\sim \\mathcal{N}(b_i, \\omega_i^2)$，我们有：\n$$\\mathcal{R}_i = b_i^2 + \\omega_i^2$$\n\n选择规则是在 $\\hat{E}_1  \\hat{E}_2$ 时选择模型1。因此，$P(\\text{选择模型 1}) = P(\\hat{E}_1 - \\hat{E}_2  0)$。令 $D = \\hat{E}_1 - \\hat{E}_2$。我们需要求出 $D$ 的分布。\n\n题目指定使用中心极限定理（CLT）。对于每个模型 $i$，$\\hat{E}_i = \\frac{1}{n} \\sum_{t=1}^n R_{i,t}^2$ 是 $n$ 个独立同分布随机变量 $X_{i,t} = R_{i,t}^2$ 的样本均值。对于足够大的 $n$，中心极限定理表明 $\\hat{E}_i$ 近似服从正态分布：\n$$\\hat{E}_i \\approx \\mathcal{N}\\left(E[X_{i,t}], \\frac{\\text{Var}(X_{i,t})}{n}\\right) \\equiv \\mathcal{N}\\left(E[R_{i,t}^2], \\frac{\\text{Var}(R_{i,t}^2)}{n}\\right)$$\n其均值为 $E[R_{i,t}^2] = \\mathcal{R}_i = b_i^2 + \\omega_i^2$。\n\n为了求方差，我们首先需要 $R_{i,t}$ 的四阶矩。对于一个正态随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其各阶矩是已知的。令 $R_i \\sim \\mathcal{N}(b_i, \\omega_i^2)$。\n$$E[R_i^4] = b_i^4 + 6 b_i^2 \\omega_i^2 + 3 \\omega_i^4$$\n$R_i^2$ 的方差则为：\n$$\\text{Var}(R_i^2) = E[R_i^4] - (E[R_i^2])^2 = (b_i^4 + 6 b_i^2 \\omega_i^2 + 3 \\omega_i^4) - (b_i^2 + \\omega_i^2)^2$$\n$$\\text{Var}(R_i^2) = (b_i^4 + 6 b_i^2 \\omega_i^2 + 3 \\omega_i^4) - (b_i^4 + 2 b_i^2 \\omega_i^2 + \\omega_i^4) = 4 b_i^2 \\omega_i^2 + 2 \\omega_i^4$$\n因此，我们得到每个经验误差的近似分布：\n$$\\hat{E}_i \\approx \\mathcal{N}\\left(b_i^2 + \\omega_i^2, \\frac{4 b_i^2 \\omega_i^2 + 2 \\omega_i^4}{n}\\right)$$\n由于模型是独立的，$\\hat{E}_1$ 和 $\\hat{E}_2$ 也是独立的。差值 $D = \\hat{E}_1 - \\hat{E}_2$ 也近似服从正态分布：\n$$D \\sim \\mathcal{N}(\\mu_D, \\sigma_D^2)$$\n其中均值为 $\\mu_D = E[\\hat{E}_1] - E[\\hat{E}_2] = \\mathcal{R}_1 - \\mathcal{R}_2$，方差为 $\\sigma_D^2 = \\text{Var}(\\hat{E}_1) + \\text{Var}(\\hat{E}_2) = \\frac{\\text{Var}(R_1^2)}{n} + \\frac{\\text{Var}(R_2^2)}{n}$。\n\n选择模型1的概率是 $P(D  0)$。我们将 $D$ 标准化为一个标准正态变量 $Z \\sim \\mathcal{N}(0,1)$：\n$$P(\\text{选择模型 1}) = P(D  0) = P\\left(\\frac{D - \\mu_D}{\\sigma_D}  \\frac{0 - \\mu_D}{\\sigma_D}\\right) = P\\left(Z  -\\frac{\\mu_D}{\\sigma_D}\\right) = \\Phi\\left(-\\frac{\\mu_D}{\\sigma_D}\\right)$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数（CDF）。\n选择模型2的概率是 $P(\\text{选择模型 2}) = 1 - P(\\text{选择模型 1}) = 1 - \\Phi(-\\mu_D/\\sigma_D) = \\Phi(\\mu_D/\\sigma_D)$。\n\n因此，期望样本外误差为：\n$$E_{out} = \\mathcal{R}_1 \\Phi\\left(-\\frac{\\mu_D}{\\sigma_D}\\right) + \\mathcal{R}_2 \\Phi\\left(\\frac{\\mu_D}{\\sigma_D}\\right)$$\n其中 $\\mu_D = \\mathcal{R}_1 - \\mathcal{R}_2$ 且 $\\sigma_D^2 = \\frac{1}{n} \\left( (4 b_1^2 \\omega_1^2 + 2 \\omega_1^4) + (4 b_2^2 \\omega_2^2 + 2 \\omega_2^4) \\right)$。\n\n现在，我们代入数值：\n$b_1 = 1.2$, $v_1 = 1.0$, $b_2 = -0.3$, $v_2 = 3.5$, $\\sigma^2 = 4.0$, $n=30$。\n\n首先，计算总残差方差 $\\omega_i^2$ 和真实风险 $\\mathcal{R}_i$：\n$$\\omega_1^2 = v_1 + \\sigma^2 = 1.0 + 4.0 = 5.0$$\n$$\\omega_2^2 = v_2 + \\sigma^2 = 3.5 + 4.0 = 7.5$$\n$$\\mathcal{R}_1 = b_1^2 + \\omega_1^2 = (1.2)^2 + 5.0 = 1.44 + 5.0 = 6.44$$\n$$\\mathcal{R}_2 = b_2^2 + \\omega_2^2 = (-0.3)^2 + 7.5 = 0.09 + 7.5 = 7.59$$\n\n接下来，计算平方残差的方差 $\\text{Var}(R_i^2)$：\n$$\\text{Var}(R_1^2) = 4 b_1^2 \\omega_1^2 + 2 \\omega_1^4 = 4(1.2)^2(5.0) + 2(5.0)^2 = 4(1.44)(5.0) + 2(25) = 28.8 + 50 = 78.8$$\n$$\\text{Var}(R_2^2) = 4 b_2^2 \\omega_2^2 + 2 \\omega_2^4 = 4(-0.3)^2(7.5) + 2(7.5)^2 = 4(0.09)(7.5) + 2(56.25) = 2.7 + 112.5 = 115.2$$\n\n现在，计算 $D = \\hat{E}_1 - \\hat{E}_2$ 的分布参数：\n$$\\mu_D = \\mathcal{R}_1 - \\mathcal{R}_2 = 6.44 - 7.59 = -1.15$$\n$$\\sigma_D^2 = \\frac{1}{n}(\\text{Var}(R_1^2) + \\text{Var}(R_2^2)) = \\frac{1}{30}(78.8 + 115.2) = \\frac{194.0}{30} \\approx 6.46667$$\n$$\\sigma_D = \\sqrt{\\frac{194}{30}} \\approx 2.54296$$\n\n接下来，计算正态CDF的自变量：\n$$-\\frac{\\mu_D}{\\sigma_D} = -\\frac{-1.15}{\\sqrt{194/30}} \\approx \\frac{1.15}{2.54296} \\approx 0.452228$$\n\n现在，计算选择概率：\n$$P(\\text{选择模型 1}) = \\Phi(0.452228) \\approx 0.674435$$\n$$P(\\text{选择模型 2}) = \\Phi(-0.452228) = 1 - \\Phi(0.452228) \\approx 0.325565$$\n\n最后，计算期望样本外平方误差：\n$$E_{out} = \\mathcal{R}_1 \\cdot P(\\text{选择模型 1}) + \\mathcal{R}_2 \\cdot P(\\text{选择模型 2})$$\n$$E_{out} \\approx (6.44)(0.674435) + (7.59)(0.325565)$$\n$$E_{out} \\approx 4.3433614 + 2.47098035 = 6.81434175$$\n将结果四舍五入至四位有效数字，得到 $6.814$。单位是 $(\\mu\\text{g/m}^3)^2$。这个结果在物理上是合理的。较优模型的真实风险是 $\\mathcal{R}_1 = 6.44$。由于选择过程中的抽样可变性，我们有时会选择较差的模型，导致总期望误差为 $6.814$，这个值高于最优可能风险，但低于较差模型的风险（$\\mathcal{R}_2=7.59$）。",
            "answer": "$$\\boxed{6.814}$$"
        }
    ]
}