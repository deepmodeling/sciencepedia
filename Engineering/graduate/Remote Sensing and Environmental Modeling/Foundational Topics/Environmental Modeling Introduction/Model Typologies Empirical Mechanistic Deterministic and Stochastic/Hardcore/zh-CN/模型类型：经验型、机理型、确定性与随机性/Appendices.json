{
    "hands_on_practices": [
        {
            "introduction": "理解模型的输出如何响应其参数的微小变化，是模型分析中的一项基本技能。这种被称为敏感性分析的方法，量化了模型对参数扰动的局部响应。本练习将通过一个简化的、基于物理的辐射传输模型，引导您动手实践，利用雅可比矩阵计算一阶确定性敏感性，从而为更复杂的模型反演和参数化稳定性研究奠定基础。",
            "id": "3828596",
            "problem": "考虑一个用于遥感大气层顶（TOA）反射率 $y$ 的机械确定性正演模型，该模型针对朗伯表面，在平行平面大气中考虑单次散射。该模型使用比尔-朗伯透射率和各向同性单次散射路径项，其表达式为\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\frac{\\tau}{\\mu_{0}}\\right)\\exp\\!\\left(-\\frac{\\tau}{\\mu}\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau,\n$$\n其中 $\\rho$ 是地表反照率（朗伯双向反射因子），$\\tau$ 是气溶胶光学厚度，$\\mu_{0}=\\cos(\\theta_{0})$ 和 $\\mu=\\cos(\\theta)$ 分别是由太阳天顶角 $\\theta_{0}$ 和观测天顶角 $\\theta$ 定义的太阳方向和观测方向的余弦，$\\omega$ 是单次散射反照率，$P$ 是相函数值（对于各向同性散射，设 $P=1$）。角度单位为度。\n\n- 几何与光学特性：$\\theta_{0}=60^{\\circ}$，$\\theta=0^{\\circ}$，$\\omega=0.95$，$P=1$，因此 $\\mu_{0}=\\cos(60^{\\circ})$ 且 $\\mu=\\cos(0^{\\circ})$。\n- 参数矢量：$\\theta=\\begin{pmatrix}\\rho \\\\ \\tau\\end{pmatrix}$，其标称值为 $\\rho^{\\star}=0.2$ 和 $\\tau^{\\star}=0.3$。\n- 确定性扰动：$\\Delta\\theta=\\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix}$，其中 $\\Delta\\rho=+0.01$ 且 $\\Delta\\tau=-0.02$。\n\n从比尔-朗伯透射定律和平面平行大气中路径反射率的单次散射近似出发，推导雅可比行向量 $J(\\theta^{\\star})=\\begin{pmatrix}\\frac{\\partial y}{\\partial \\rho}  \\frac{\\partial y}{\\partial \\tau}\\end{pmatrix}\\bigg|_{\\theta^{\\star}}$ 并评估确定性一阶灵敏度 $\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta$。将 $\\Delta y$ 的最终数值结果四舍五入至四位有效数字。将最终的反射率变化表示为无单位小数。然后，简要解释在给定条件下，反射率在局部对 $\\rho$ 和 $\\tau$ 哪个更敏感，并评论由 $\\Delta y$ 相对于 $y(\\theta^{\\star})$ 的量级所暗示的参数稳定性。",
            "solution": "此问题经评估具有科学依据、提法明确、客观且完整。它代表了一个简化辐射传输模型的标准一阶灵敏度分析，这是遥感和环境建模中的一项常见任务。所有必要的数据和定义均已提供，不存在矛盾或物理上不合理的假设。因此，该问题是有效的，可以推导出解决方案。\n\n大气层顶（TOA）反射率 $y$ 的正演模型由下式给出：\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\frac{\\tau}{\\mu_{0}}\\right)\\exp\\!\\left(-\\frac{\\tau}{\\mu}\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau\n$$\n该表达式可以通过合并指数项来简化，这些指数项代表双程大气透射率（向下和向上路径）：\n$$\ny(\\rho,\\tau;\\mu_{0},\\mu,\\omega,P) \\;=\\; \\rho\\,\\exp\\!\\left(-\\tau\\left(\\frac{1}{\\mu_{0}} + \\frac{1}{\\mu}\\right)\\right) \\;+\\; \\frac{\\omega\\,P}{4\\,\\mu_{0}\\,\\mu}\\,\\tau\n$$\n\n首先，我们代入给定的几何和光学特性常数值：\n- 太阳天顶角 $\\theta_{0} = 60^{\\circ}$，所以 $\\mu_{0} = \\cos(60^{\\circ}) = 0.5$。\n- 观测天顶角 $\\theta = 0^{\\circ}$，所以 $\\mu = \\cos(0^{\\circ}) = 1$。\n- 单次散射反照率 $\\omega = 0.95$。\n- 各向同性相函数值 $P = 1$。\n\n将这些值代入模型方程，可将其简化为仅含 $\\rho$ 和 $\\tau$ 的函数：\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp\\!\\left(-\\tau\\left(\\frac{1}{0.5} + \\frac{1}{1}\\right)\\right) + \\frac{0.95 \\times 1}{4 \\times 0.5 \\times 1}\\,\\tau\n$$\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp(-3\\tau) + \\frac{0.95}{2}\\,\\tau\n$$\n$$\ny(\\rho, \\tau) = \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau\n$$\n\n目标是计算由扰动 $\\Delta\\theta = \\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix}$ 在标称点 $\\theta^{\\star} = \\begin{pmatrix}\\rho^{\\star} \\\\ \\tau^{\\star}\\end{pmatrix}$ 附近引起的一阶变化 $\\Delta y$。这由截断到一阶的泰勒展开给出：\n$$\n\\Delta y \\approx \\frac{\\partial y}{\\partial \\rho}\\bigg|_{\\theta^{\\star}}\\Delta\\rho + \\frac{\\partial y}{\\partial \\tau}\\bigg|_{\\theta^{\\star}}\\Delta\\tau\n$$\n这可以写成矩阵形式 $\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta$，其中 $J(\\theta^{\\star})$ 是在标称点 $\\theta^{\\star}$ 处求值的雅可比行向量。\n\n雅可比行向量为 $J(\\rho, \\tau) = \\begin{pmatrix}\\frac{\\partial y}{\\partial \\rho}  \\frac{\\partial y}{\\partial \\tau}\\end{pmatrix}$。我们计算 $y(\\rho, \\tau)$ 的偏导数：\n\n1.  关于地表反照率 $\\rho$ 的偏导数：\n    $$\n    \\frac{\\partial y}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left( \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau \\right) = \\exp(-3\\tau)\n    $$\n\n2.  关于气溶胶光学厚度 $\\tau$ 的偏导数：\n    $$\n    \\frac{\\partial y}{\\partial \\tau} = \\frac{\\partial}{\\partial \\tau} \\left( \\rho\\,\\exp(-3\\tau) + 0.475\\,\\tau \\right) = \\rho\\,\\exp(-3\\tau)(-3) + 0.475 = -3\\rho\\,\\exp(-3\\tau) + 0.475\n    $$\n\n因此，雅可比向量为：\n$$\nJ(\\rho, \\tau) = \\begin{pmatrix} \\exp(-3\\tau)  -3\\rho\\,\\exp(-3\\tau) + 0.475 \\end{pmatrix}\n$$\n\n接下来，我们在标称参数值 $\\theta^{\\star} = \\begin{pmatrix}\\rho^{\\star} \\\\ \\tau^{\\star}\\end{pmatrix} = \\begin{pmatrix}0.2 \\\\ 0.3\\end{pmatrix}$ 处计算该雅可比矩阵：\n$$\nJ(\\theta^{\\star}) = J(0.2, 0.3) = \\begin{pmatrix} \\exp(-3 \\times 0.3)  -3(0.2)\\,\\exp(-3 \\times 0.3) + 0.475 \\end{pmatrix}\n$$\n$$\nJ(\\theta^{\\star}) = \\begin{pmatrix} \\exp(-0.9)  -0.6\\,\\exp(-0.9) + 0.475 \\end{pmatrix}\n$$\n\n现在，我们使用扰动向量 $\\Delta\\theta = \\begin{pmatrix}\\Delta\\rho \\\\ \\Delta\\tau\\end{pmatrix} = \\begin{pmatrix}+0.01 \\\\ -0.02\\end{pmatrix}$ 计算一阶灵敏度 $\\Delta y$：\n$$\n\\Delta y \\approx J(\\theta^{\\star})\\,\\Delta\\theta = \\begin{pmatrix} \\exp(-0.9)  -0.6\\,\\exp(-0.9) + 0.475 \\end{pmatrix} \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\n\\Delta y \\approx (0.01)\\exp(-0.9) + (-0.02)(-0.6\\,\\exp(-0.9) + 0.475)\n$$\n$$\n\\Delta y \\approx 0.01\\,\\exp(-0.9) + 0.012\\,\\exp(-0.9) - (0.02)(0.475)\n$$\n$$\n\\Delta y \\approx 0.022\\,\\exp(-0.9) - 0.0095\n$$\n使用数值 $\\exp(-0.9) \\approx 0.40656966$：\n$$\n\\Delta y \\approx 0.022 \\times 0.40656966 - 0.0095\n$$\n$$\n\\Delta y \\approx 0.0089445325 - 0.0095\n$$\n$$\n\\Delta y \\approx -0.0005554675\n$$\n将 $\\Delta y$ 的结果四舍五入到四位有效数字，得到：\n$$\n\\Delta y \\approx -0.0005555\n$$\n\n**解释：**\n1.  **灵敏度：** 为确定反射率 $y$ 在局部对 $\\rho$ 和 $\\tau$ 哪个更敏感，我们比较雅可比矩阵在 $\\theta^{\\star}$ 处的各分量的大小：\n    -   $J_{\\rho} = \\frac{\\partial y}{\\partial \\rho} \\bigg|_{\\theta^{\\star}} = \\exp(-0.9) \\approx 0.4066$\n    -   $J_{\\tau} = \\frac{\\partial y}{\\partial \\tau} \\bigg|_{\\theta^{\\star}} = -0.6\\,\\exp(-0.9) + 0.475 \\approx -0.2440 + 0.475 = 0.2310$\n    由于 $|J_{\\rho}| \\approx 0.4066 > |J_{\\tau}| \\approx 0.2310$，TOA反射率在局部对地表反照率 $\\rho$ 的单位变化比对气溶胶光学厚度 $\\tau$ 的单位变化更敏感。\n\n2.  **参数稳定性：** 为评估稳定性，我们将预测变化量的大小 $|\\Delta y|$ 与标称反射率值 $y(\\theta^{\\star})$ 进行比较。\n    首先，我们计算 $y(\\theta^{\\star})$：\n    $$\n    y(\\theta^{\\star}) = y(0.2, 0.3) = 0.2\\,\\exp(-3 \\times 0.3) + 0.475 \\times 0.3\n    $$\n    $$\n    y(\\theta^{\\star}) = 0.2\\,\\exp(-0.9) + 0.1425 \\approx 0.2 \\times 0.4066 + 0.1425 = 0.08132 + 0.1425 = 0.22382\n    $$\n    相对变化为：\n    $$\n    \\frac{|\\Delta y|}{|y(\\theta^{\\star})|} \\approx \\frac{0.0005555}{0.22382} \\approx 0.002482\n    $$\n    这对应于大约 $0.25\\%$ 的变化。相对输入扰动为 $\\Delta\\rho/\\rho^{\\star} = 0.01/0.2 = 5\\%$ 和 $|\\Delta\\tau/\\tau^{\\star}| = |-0.02/0.3| \\approx 6.7\\%$。由于相对输出变化（$0.25\\%$）远小于相对输入扰动，该模型在此工作点附近被认为是参数稳定的。",
            "answer": "$$\n\\boxed{-0.0005555}\n$$"
        },
        {
            "introduction": "敏感性分析不仅是一个理论练习，它在确定哪些模型参数能够从含噪声的测量数据中被可靠地估算出来方面，有着至关重要的实际应用。此练习建立在敏感性概念之上，引入了一个“噪声约束的可识别性评分”，用以衡量参数变化对模型输出的影响相对于观测噪声的大小。您将应用此方法，直接比较经验模型和机理模型中各参数的可识别性，从而深入理解模型结构和观测不确定性如何共同影响参数反演的可行性。",
            "id": "3828554",
            "problem": "考虑一个遥感应用，其目标变量是遥感反射率，定义为离水辐亮度与向下辐照度之比，单位为反球面度（$\\mathrm{sr}^{-1}$）。您将比较一个经验确定性模型和一个机理确定性模型，它们都是单一环境驱动因子 $x$（例如，叶绿素浓度，单位为 $\\mathrm{mg}\\,\\mathrm{m}^{-3}$）的函数，同时明确考虑一个随机观测过程。目标是应用灵敏度分析，通过对参数灵敏度的大小进行排序，确定在测量噪声约束下最易于识别的参数。\n\n基本原理：\n- 确定性模型定义：一个确定性模型将输入 $x$ 和参数 $\\boldsymbol{\\theta}$ 映射到一个反射率 $R(x;\\boldsymbol{\\theta})$。\n- 随机观测模型：测量值 $y$ 被建模为 $y = R(x;\\boldsymbol{\\theta}) + \\varepsilon$，其中 $\\varepsilon$ 是一个随机变量，满足 $ \\varepsilon \\sim \\mathcal{N}(0,\\sigma_y^2)$，$\\sigma_y$ 是测量噪声的标准差，单位为 $\\mathrm{sr}^{-1}$。\n- 灵敏度定义：$R$ 对于参数 $\\theta_i$ 在给定 $x$ 下的局部参数灵敏度是在指定参数值下计算的偏导数 $\\partial R / \\partial \\theta_i$。\n\n待使用的模型类型：\n- 经验确定性模型：一个多项式近似 $R_{\\mathrm{E}}(x;\\boldsymbol{\\theta}_{\\mathrm{E}})$，其参数向量为 $\\boldsymbol{\\theta}_{\\mathrm{E}} = (\\theta_{\\mathrm{E},0}, \\theta_{\\mathrm{E},1}, \\theta_{\\mathrm{E},2})$，输入为标量 $x$。\n- 机理确定性模型：一个简化的、受辐射传输启发的饱和加倒数形式 $R_{\\mathrm{M}}(x;\\boldsymbol{\\theta}_{\\mathrm{M}})$，其参数向量为 $\\boldsymbol{\\theta}_{\\mathrm{M}} = (\\alpha, \\beta, \\gamma, \\delta)$，输入为标量 $x$。\n\n您的任务：\n1. 从上述定义和标准微分运算法则出发，推导以下模型形式的偏导数 $\\partial R_{\\mathrm{E}}/\\partial \\theta_{\\mathrm{E},i}$ 和 $\\partial R_{\\mathrm{M}}/\\partial \\theta_{\\mathrm{M},i}$ 的解析表达式：\n   - 经验确定性模型：$R_{\\mathrm{E}}(x;\\boldsymbol{\\theta}_{\\mathrm{E}}) = \\theta_{\\mathrm{E},0} + \\theta_{\\mathrm{E},1}\\,x + \\theta_{\\mathrm{E},2}\\,x^2$。\n   - 机理确定性模型：$R_{\\mathrm{M}}(x;\\boldsymbol{\\theta}_{\\mathrm{M}}) = \\alpha\\left(1 - e^{-\\beta x}\\right) + \\dfrac{\\gamma}{1 + \\delta x}$。\n2. 使用随机观测模型 $y = R + \\varepsilon$（其中 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma_y^2)$），将参数 $\\theta_i$ 的噪声约束可识别性排序分数定义为 $S_i = \\left|\\dfrac{\\partial R}{\\partial \\theta_i}\\right|\\,/\\,\\sigma_y$。该分数衡量参数对反射率影响的大小相对于观测噪声的程度，单位为 $(\\mathrm{sr}^{-1})/(\\mathrm{sr}^{-1})$。\n3. 对于每个测试用例，计算两个模型所有参数的 $S_i$，并选择最易于识别的参数的索引（即具有最大 $S_i$ 的参数）。如果出现平局，选择最小的索引。参数索引使用从零开始的编号。不涉及角度。所有反射率和噪声量均以 $\\mathrm{sr}^{-1}$ 为单位；无需单位转换。\n4. 实现一个程序，评估以下四个测试用例，并以单个整数列表的形式输出最易于识别的参数的索引，顺序为：每个测试用例的经验模型索引，然后是机理模型索引。程序必须以一个方括号括起来的逗号分隔列表的单行形式精确输出最终结果。\n\n测试套件：\n- 测试用例 1（正常路径）：\n  - $x = 2.0$\n  - $\\boldsymbol{\\theta}_{\\mathrm{E}} = (0.005, 0.002, 0.0001)$\n  - $\\boldsymbol{\\theta}_{\\mathrm{M}} = (0.02, 0.7, 0.015, 0.1)$\n  - $\\sigma_y = 0.001$ $\\mathrm{sr}^{-1}$\n- 测试用例 2（大噪声）：\n  - $x = 10.0$\n  - $\\boldsymbol{\\theta}_{\\mathrm{E}} = (0.005, 0.002, 0.0001)$\n  - $\\boldsymbol{\\theta}_{\\mathrm{M}} = (0.02, 0.7, 0.015, 0.1)$\n  - $\\sigma_y = 0.02$ $\\mathrm{sr}^{-1}$\n- 测试用例 3（边界输入）：\n  - $x = 0.0$\n  - $\\boldsymbol{\\theta}_{\\mathrm{E}} = (0.005, 0.002, 0.0001)$\n  - $\\boldsymbol{\\theta}_{\\mathrm{M}} = (0.02, 0.7, 0.015, 0.1)$\n  - $\\sigma_y = 0.001$ $\\mathrm{sr}^{-1}$\n- 测试用例 4（经验灵敏度出现平局）：\n  - $x = 1.0$\n  - $\\boldsymbol{\\theta}_{\\mathrm{E}} = (0.000, 0.003, 0.001)$\n  - $\\boldsymbol{\\theta}_{\\mathrm{M}} = (0.1, 0.0, 0.1, 0.0)$\n  - $\\sigma_y = 0.01$ $\\mathrm{sr}^{-1}$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots]$）的结果，其中元素是整数，顺序为 $[\\text{empirical}_1,\\text{mechanistic}_1,\\text{empirical}_2,\\text{mechanistic}_2,\\text{empirical}_3,\\text{mechanistic}_3,\\text{empirical}_4,\\text{mechanistic}_4]$，对应于四个测试用例。",
            "solution": "该问题已经过验证，被认为是有效的。它以数学建模和灵敏度分析的标准原则为科学基础，问题定义良好（良态），目标明确，数据充分，并以客观、无歧义的语言表述。解决方案首先推导解析灵敏度，然后执行一个计算程序来评估指定的测试用例。\n\n目标是在随机观测过程下，为两种不同的遥感反射率 $R$ 模型确定最易于识别的参数。可识别性由一个噪声约束的灵敏度分数来量化。这需要推导每个模型关于其参数的偏导数。\n\n**1. 解析灵敏度的推导**\n\n模型输出 $R$ 对参数 $\\theta_i$ 的局部灵敏度定义为偏导数 $\\frac{\\partial R}{\\partial \\theta_i}$。我们为经验模型和机理模型推导这些灵敏度。\n\n**1.1. 经验确定性模型**\n\n经验模型是以下形式的二次多项式：\n$$\nR_{\\mathrm{E}}(x;\\boldsymbol{\\theta}_{\\mathrm{E}}) = \\theta_{\\mathrm{E},0} + \\theta_{\\mathrm{E},1}\\,x + \\theta_{\\mathrm{E},2}\\,x^2\n$$\n其中 $\\boldsymbol{\\theta}_{\\mathrm{E}} = (\\theta_{\\mathrm{E},0}, \\theta_{\\mathrm{E},1}, \\theta_{\\mathrm{E},2})$ 是参数向量。通过依次对每个参数求偏导数，同时将其他参数和输入 $x$ 视为常数，可以得到灵敏度。\n\n对 $\\theta_{\\mathrm{E},0}$ 的灵敏度为：\n$$\n\\frac{\\partial R_{\\mathrm{E}}}{\\partial \\theta_{\\mathrm{E},0}} = \\frac{\\partial}{\\partial \\theta_{\\mathrm{E},0}} \\left( \\theta_{\\mathrm{E},0} + \\theta_{\\mathrm{E},1}\\,x + \\theta_{\\mathrm{E},2}\\,x^2 \\right) = 1\n$$\n这表明 $\\theta_{\\mathrm{E},0}$ 的变化会导致反射率产生一个恒定的偏移，与 $x$ 无关。\n\n对 $\\theta_{\\mathrm{E},1}$ 的灵敏度为：\n$$\n\\frac{\\partial R_{\\mathrm{E}}}{\\partial \\theta_{\\mathrm{E},1}} = \\frac{\\partial}{\\partial \\theta_{\\mathrm{E},1}} \\left( \\theta_{\\mathrm{E},0} + \\theta_{\\mathrm{E},1}\\,x + \\theta_{\\mathrm{E},2}\\,x^2 \\right) = x\n$$\n该灵敏度与输入变量 $x$ 呈线性相关。\n\n对 $\\theta_{\\mathrm{E},2}$ 的灵敏度为：\n$$\n\\frac{\\partial R_{\\mathrm{E}}}{\\partial \\theta_{\\mathrm{E},2}} = \\frac{\\partial}{\\partial \\theta_{\\mathrm{E},2}} \\left( \\theta_{\\mathrm{E},0} + \\theta_{\\mathrm{E},1}\\,x + \\theta_{\\mathrm{E},2}\\,x^2 \\right) = x^2\n$$\n该灵敏度取决于输入变量 $x$ 的平方。\n\n**1.2. 机理确定性模型**\n\n机理模型由一个饱和加倒数形式给出：\n$$\nR_{\\mathrm{M}}(x;\\boldsymbol{\\theta}_{\\mathrm{M}}) = \\alpha\\left(1 - e^{-\\beta x}\\right) + \\dfrac{\\gamma}{1 + \\delta x}\n$$\n其中 $\\boldsymbol{\\theta}_{\\mathrm{M}} = (\\alpha, \\beta, \\gamma, \\delta)$ 是参数向量。利用微分的和法则、积法则和链式法则来推导灵敏度。\n\n对 $\\alpha$ 的灵敏度为：\n$$\n\\frac{\\partial R_{\\mathrm{M}}}{\\partial \\alpha} = \\frac{\\partial}{\\partial \\alpha} \\left[ \\alpha\\left(1 - e^{-\\beta x}\\right) + \\frac{\\gamma}{1 + \\delta x} \\right] = 1 - e^{-\\beta x}\n$$\n这与饱和项的振幅有关。\n\n对 $\\beta$ 的灵敏度通过对指数项使用链式法则得到：\n$$\n\\frac{\\partial R_{\\mathrm{M}}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left[ \\alpha\\left(1 - e^{-\\beta x}\\right) \\right] = \\alpha \\left( -e^{-\\beta x} \\cdot \\frac{\\partial}{\\partial \\beta}(-\\beta x) \\right) = \\alpha \\left( -e^{-\\beta x} \\cdot (-x) \\right) = \\alpha x e^{-\\beta x}\n$$\n这与饱和速率有关。\n\n对 $\\gamma$ 的灵敏度为：\n$$\n\\frac{\\partial R_{\\mathrm{M}}}{\\partial \\gamma} = \\frac{\\partial}{\\partial \\gamma} \\left[ \\frac{\\gamma}{1 + \\delta x} \\right] = \\frac{1}{1 + \\delta x}\n$$\n这与倒数项的振幅有关。\n\n对 $\\delta$ 的灵敏度通过对项 $(1 + \\delta x)^{-1}$ 使用幂法则和链式法则得到：\n$$\n\\frac{\\partial R_{\\mathrm{M}}}{\\partial \\delta} = \\frac{\\partial}{\\partial \\delta} \\left[ \\gamma(1 + \\delta x)^{-1} \\right] = \\gamma \\left( -1 \\cdot (1 + \\delta x)^{-2} \\cdot \\frac{\\partial}{\\partial \\delta}(1 + \\delta x) \\right) = \\gamma \\left( -(1 + \\delta x)^{-2} \\cdot x \\right) = \\frac{-\\gamma x}{(1 + \\delta x)^2}\n$$\n这与倒数项的衰减率有关。\n\n**2. 可识别性分数与评估**\n\n问题将参数 $\\theta_i$ 的噪声约束可识别性排序分数定义为：\n$$\nS_i = \\frac{\\left|\\frac{\\partial R}{\\partial \\theta_i}\\right|}{\\sigma_y}\n$$\n其中 $\\sigma_y$ 是测量噪声的标准差。该分数通过观测噪声水平来归一化模型对参数的灵敏度大小。分数越高，意味着参数变化的影响相对于噪声越大，使得该参数在含噪声数据中更“易于识别”。\n\n对于每个测试用例，我们对经验模型和机理模型执行以下步骤：\n1.  使用给定的 $x$ 值和模型参数 $\\boldsymbol{\\theta}$，评估解析灵敏度向量 $[\\frac{\\partial R}{\\partial \\theta_0}, \\frac{\\partial R}{\\partial \\theta_1}, \\dots]$。\n2.  通过取每个灵敏度的绝对值并除以给定的 $\\sigma_y$，计算分数向量 $[S_0, S_1, \\dots]$。\n3.  确定向量中最大分数的索引。此索引对应于给定条件下最易于识别的参数。问题规定，如果出现平局，应选择最小的索引。\n\n此过程以编程方式实现，用于处理问题陈述中提供的四个测试用例。最终输出是这些索引的有序列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# SciPy is not needed for this problem as numpy contains all required functions.\n\ndef solve():\n    \"\"\"\n    Computes the index of the most identifiable parameter for empirical and\n    mechanistic models across several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (happy path)\n        {'x': 2.0, 'theta_E': (0.005, 0.002, 0.0001), 'theta_M': (0.02, 0.7, 0.015, 0.1), 'sigma_y': 0.001},\n        # Test case 2 (large noise)\n        {'x': 10.0, 'theta_E': (0.005, 0.002, 0.0001), 'theta_M': (0.02, 0.7, 0.015, 0.1), 'sigma_y': 0.02},\n        # Test case 3 (boundary input)\n        {'x': 0.0, 'theta_E': (0.005, 0.002, 0.0001), 'theta_M': (0.02, 0.7, 0.015, 0.1), 'sigma_y': 0.001},\n        # Test case 4 (tie in empirical sensitivities)\n        {'x': 1.0, 'theta_E': (0.000, 0.003, 0.001), 'theta_M': (0.1, 0.0, 0.1, 0.0), 'sigma_y': 0.01},\n    ]\n\n    results = []\n\n    def calculate_empirical_sensitivities(x):\n        \"\"\"\n        Calculates the sensitivities for the empirical model.\n        dR/d(theta_E0) = 1\n        dR/d(theta_E1) = x\n        dR/d(theta_E2) = x^2\n        \"\"\"\n        return np.array([1.0, x, x**2])\n\n    def calculate_mechanistic_sensitivities(x, theta_M):\n        \"\"\"\n        Calculates the sensitivities for the mechanistic model.\n        theta_M = (alpha, beta, gamma, delta)\n        \"\"\"\n        alpha, beta, gamma, delta = theta_M\n        \n        # dR/d(alpha) = 1 - exp(-beta * x)\n        sens_alpha = 1.0 - np.exp(-beta * x)\n        \n        # dR/d(beta) = alpha * x * exp(-beta * x)\n        sens_beta = alpha * x * np.exp(-beta * x)\n        \n        # dR/d(gamma) = 1 / (1 + delta * x)\n        sens_gamma = 1.0 / (1.0 + delta * x)\n        \n        # dR/d(delta) = -gamma * x / (1 + delta * x)^2\n        sens_delta = -gamma * x / ((1.0 + delta * x)**2)\n        \n        return np.array([sens_alpha, sens_beta, sens_gamma, sens_delta])\n\n    for case in test_cases:\n        # Unpack case data\n        x = case['x']\n        theta_E = case['theta_E']\n        theta_M = case['theta_M']\n        sigma_y = case['sigma_y']\n\n        # 1. Empirical Model Calculation\n        # Calculate sensitivities\n        sens_E = calculate_empirical_sensitivities(x)\n        # Calculate scores S_i = |sensitivity| / sigma_y\n        scores_E = np.abs(sens_E) / sigma_y\n        # Find index of max score. np.argmax handles ties by taking the first occurrence.\n        most_identifiable_E_idx = np.argmax(scores_E)\n        results.append(most_identifiable_E_idx)\n        \n        # 2. Mechanistic Model Calculation\n        # Calculate sensitivities\n        sens_M = calculate_mechanistic_sensitivities(x, theta_M)\n        # Calculate scores\n        scores_M = np.abs(sens_M) / sigma_y\n        # Find index of max score\n        most_identifiable_M_idx = np.argmax(scores_M)\n        results.append(most_identifiable_M_idx)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在拥有多个竞争模型时，我们选择“最佳”模型的方法将如何影响未来的预测准确性？这个问题将我们的分析从参数层面提升到模型选择策略的层面。这项高级练习探讨了模型选择的统计后果，通过一个现实的空气质量预报场景，量化了模型选择过程本身（由于样本数据的随机性）如何影响最终预测的期望误差。通过这个练习，您将深入理解在经验模型和机理模型之间进行选择时，偏误-方差权衡的复杂动态。",
            "id": "3828542",
            "problem": "在一个使用卫星遥感的区域空气质量预报应用中，假设真实的日均颗粒物浓度（记为 $Y$，单位为 $\\mu\\text{g/m}^3$）由一个未知的机理过程和不可约噪声共同产生。现有两种相互竞争的预测模型，它们反映了不同的类型：\n\n- 模型 $1$ 是一种从遥感反射率指数到 $Y$ 的经验确定性回归模型，其条件恒定预测偏差为 $b_1$，预测方差为 $v_1$，该方差归因于参数估计的不确定性。\n- 模型 $2$ 是一种机理随机化学输运模型，其条件恒定预测偏差为 $b_2$，预测方差为 $v_2$，该方差归因于过程噪声和参数不确定性。\n\n假设不可约的测量过程噪声方差为 $\\sigma^2$，因此对于模型 $i \\in \\{1,2\\}$，单步预测残差 $R_{i,t} = Y_t - \\hat{Y}_{i,t}$ 被建模为 $R_{i,t} \\sim \\mathcal{N}(b_i, \\omega_i^2)$，其中 $\\omega_i^2 = v_i + \\sigma^2$。残差在不同日期 $t$ 之间是独立的，并且由于不相交的随机校准折叠，在不同模型之间也是独立的。一个选择协议在 $n$ 个历史日上训练每个模型，并选择具有较小经验均方残差 $\\hat{E}_i = \\frac{1}{n}\\sum_{t=1}^{n} R_{i,t}^2$ 的模型。下游的预报将使用被选中的模型，不再进行平均。\n\n从偏差-方差分解和中心极限定理（CLT）出发，推导所选模型的预期样本外平方预测误差的表达式，然后对以下科学上合理的参数值进行评估：\n- $b_1 = +1.2$ $\\mu\\text{g/m}^3$, $v_1 = 1.0$ $(\\mu\\text{g/m}^3)^2$,\n- $b_2 = -0.3$ $\\mu\\text{g/m}^3$, $v_2 = 3.5$ $(\\mu\\text{g/m}^3)^2$,\n- $\\sigma^2 = 4.0$ $(\\mu\\text{g/m}^3)^2$, $n = 30$.\n\n将最终数值答案四舍五入至四位有效数字。以 $(\\mu\\text{g/m}^3)^2$ 为单位表示预期平方误差。",
            "solution": "此问题在科学上是合理的，它基于统计建模和模型选择中的标准原则。问题表述清晰，并提供了解决问题所需的所有假设和参数值。解题过程需要在模型选择框架下，计算最终的预期样本外预测误差。\n\n**1. 定义预期样本外误差**\n\n令所选模型的预期样本外平方预测误差为 $E_{out}$。模型选择规则是，当模型1的经验均方误差 $\\hat{E}_1$ 小于模型2的经验均方误差 $\\hat{E}_2$ 时，选择模型1，反之则选择模型2。\n\n所选模型的预期样本外误差是每个模型真实风险 $\\mathcal{R}_i$ 的加权平均，权重为选择该模型的概率：\n$$E_{out} = \\mathcal{R}_1 \\cdot P(\\text{选择模型1}) + \\mathcal{R}_2 \\cdot P(\\text{选择模型2})$$\n\n**2. 计算真实风险**\n\n模型 $i$ 的真实风险 $\\mathcal{R}_i$ 是其预期样本外平方误差。根据偏差-方差分解，对于残差 $R_{i,t} \\sim \\mathcal{N}(b_i, \\omega_i^2)$，真实风险为：\n$$\\mathcal{R}_i = E[R_{i,t}^2] = (E[R_{i,t}])^2 + \\text{Var}(R_{i,t}) = b_i^2 + \\omega_i^2$$\n其中 $\\omega_i^2 = v_i + \\sigma^2$ 是总残差方差。\n\n**3. 计算选择概率**\n\n选择模型1的概率为 $P(\\hat{E}_1  \\hat{E}_2) = P(\\hat{E}_1 - \\hat{E}_2  0)$。令 $D = \\hat{E}_1 - \\hat{E}_2$。我们需要 $D$ 的分布。\n根据中心极限定理 (CLT)，对于较大的样本量 $n$，经验均方残差 $\\hat{E}_i = \\frac{1}{n}\\sum_{t=1}^{n} R_{i,t}^2$ 近似服从正态分布：\n$$\\hat{E}_i \\approx \\mathcal{N}\\left(E[R_{i,t}^2], \\frac{\\text{Var}(R_{i,t}^2)}{n}\\right)$$\n分布的均值是真实风险 $\\mathcal{R}_i$。分布的方差需要计算 $R_{i,t}^2$ 的方差。对于正态分布变量 $R_i \\sim \\mathcal{N}(b_i, \\omega_i^2)$，其平方的方差为：\n$$\\text{Var}(R_i^2) = E[R_i^4] - (E[R_i^2])^2 = 4 b_i^2 \\omega_i^2 + 2 \\omega_i^4$$\n由于模型1和模型2的残差是独立的，差值 $D$ 也近似服从正态分布 $D \\sim \\mathcal{N}(\\mu_D, \\sigma_D^2)$，其参数为：\n$$\\mu_D = E[D] = \\mathcal{R}_1 - \\mathcal{R}_2$$\n$$\\sigma_D^2 = \\text{Var}(D) = \\text{Var}(\\hat{E}_1) + \\text{Var}(\\hat{E}_2) = \\frac{\\text{Var}(R_1^2) + \\text{Var}(R_2^2)}{n}$$\n因此，选择模型1的概率是：\n$$P(\\text{选择模型1}) = P(D  0) = P\\left(\\frac{D - \\mu_D}{\\sigma_D}  \\frac{-\\mu_D}{\\sigma_D}\\right) = \\Phi\\left(-\\frac{\\mu_D}{\\sigma_D}\\right)$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)。选择模型2的概率为 $P(\\text{选择模型2}) = 1 - P(\\text{选择模型1})$。\n\n**4. 代入数值进行计算**\n\n给定参数：$b_1 = 1.2$, $v_1 = 1.0$, $b_2 = -0.3$, $v_2 = 3.5$, $\\sigma^2 = 4.0$, $n = 30$。\n\n- **总残差方差：**\n  - $\\omega_1^2 = v_1 + \\sigma^2 = 1.0 + 4.0 = 5.0$\n  - $\\omega_2^2 = v_2 + \\sigma^2 = 3.5 + 4.0 = 7.5$\n\n- **真实风险：**\n  - $\\mathcal{R}_1 = b_1^2 + \\omega_1^2 = (1.2)^2 + 5.0 = 1.44 + 5.0 = 6.44$\n  - $\\mathcal{R}_2 = b_2^2 + \\omega_2^2 = (-0.3)^2 + 7.5 = 0.09 + 7.5 = 7.59$\n\n- **平方残差的方差：**\n  - $\\text{Var}(R_1^2) = 4 b_1^2 \\omega_1^2 + 2 \\omega_1^4 = 4(1.44)(5.0) + 2(5.0)^2 = 28.8 + 50 = 78.8$\n  - $\\text{Var}(R_2^2) = 4 b_2^2 \\omega_2^2 + 2 \\omega_2^4 = 4(0.09)(7.5) + 2(7.5)^2 = 2.7 + 112.5 = 115.2$\n\n- **差值分布的参数：**\n  - $\\mu_D = \\mathcal{R}_1 - \\mathcal{R}_2 = 6.44 - 7.59 = -1.15$\n  - $\\sigma_D^2 = \\frac{1}{30}(\\text{Var}(R_1^2) + \\text{Var}(R_2^2)) = \\frac{78.8 + 115.2}{30} = \\frac{194.0}{30} \\approx 6.4667$\n  - $\\sigma_D = \\sqrt{6.4667} \\approx 2.54296$\n\n- **选择概率：**\n  - CDF的参数 $z = -\\frac{\\mu_D}{\\sigma_D} = -\\frac{-1.15}{2.54296} \\approx 0.45223$\n  - $P(\\text{选择模型1}) = \\Phi(0.45223) \\approx 0.67444$\n  - $P(\\text{选择模型2}) = 1 - P(\\text{选择模型1}) \\approx 0.32556$\n\n- **最终预期误差：**\n  - $E_{out} = \\mathcal{R}_1 \\cdot P(\\text{选择模型1}) + \\mathcal{R}_2 \\cdot P(\\text{选择模型2})$\n  - $E_{out} \\approx (6.44)(0.67444) + (7.59)(0.32556) \\approx 4.34339 + 2.47099 \\approx 6.81438$\n\n将结果四舍五入至四位有效数字，我们得到 $6.814$。",
            "answer": "$$\\boxed{6.814}$$"
        }
    ]
}