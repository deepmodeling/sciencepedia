{
    "hands_on_practices": [
        {
            "introduction": "在定量遥感中，将太阳的方位（天顶角和方位角）精确地转换为局部坐标系下的方向矢量，是进行辐射传输模拟和地形校正的基础。本练习旨在通过第一性原理，从几何定义出发，推导并计算在局部“东-北-上”（East-North-Up, ENU）坐标系中表示太阳方向的单位矢量。这项基本技能对于后续理解和应用更复杂的几何模型至关重要 。",
            "id": "3856007",
            "problem": "一个地面站点位于纬度 $35^{\\circ}$ 和经度 $-120^{\\circ}$。在某一特定时刻，从该站点观测到太阳，其太阳天顶角为 $30^{\\circ}$，太阳方位角为 $150^{\\circ}$，其中方位角是从地理北方向顺时针测量的。考虑本地的东-北-天（ENU）参考系，其中东轴指向经度增加的方向，北轴指向纬度增加的方向，天轴是远离地球中心的本地表面法线。设 $\\mathbf{s}$ 表示在此 ENU 坐标系中，从地面目标指向太阳的单位太阳光照方向向量。\n\n仅使用天顶角和方位角的基本几何定义以及 ENU 坐标轴的正交性，从第一性原理推导 $\\mathbf{s}$ 在 ENU 坐标系中的分量，然后根据给定角度计算它们的值。所有角度均以度为单位。将最终分量表示为有序三元组 $(s_{E}, s_{N}, s_{U})$，并将每个分量四舍五入到四位有效数字。这些分量是无量纲的。提供最终的有序三元组作为唯一结果。",
            "solution": "问题在于确定单位太阳光照向量 $\\mathbf{s}$ 在本地东-北-天（ENU）笛卡尔坐标系中的分量。太阳的方向由其天顶角 $\\theta_s$ 和方位角 $\\phi_s$ 指定。提供的地面站点的纬度和经度确定了 ENU 坐标系的定义位置，但对于几何变换本身并非必需。\n\n设 ENU 坐标系由一组标准正交基向量 $(\\hat{\\mathbf{e}}_E, \\hat{\\mathbf{e}}_N, \\hat{\\mathbf{e}}_U)$ 定义。太阳光照向量 $\\mathbf{s}$ 是一个从地面目标指向太阳的单位向量。它可以表示为基向量的线性组合：\n$$\n\\mathbf{s} = s_E \\hat{\\mathbf{e}}_E + s_N \\hat{\\mathbf{e}}_N + s_U \\hat{\\mathbf{e}}_U\n$$\n我们的目标是利用给定角度从第一性原理求出标量分量 $(s_E, s_N, s_U)$。\n\n太阳天顶角 $\\theta_s$ 定义为本地天顶（天方向）与太阳方向之间的夹角。因此，$\\theta_s$ 是向量 $\\mathbf{s}$ 与基向量 $\\hat{\\mathbf{e}}_U$ 之间的夹角。$\\mathbf{s}$ 沿天轴的分量 $s_U$ 是通过将 $\\mathbf{s}$ 投影到 $\\hat{\\mathbf{e}}_U$ 上得到的。使用点积的定义：\n$$\ns_U = \\mathbf{s} \\cdot \\hat{\\mathbf{e}}_U = |\\mathbf{s}| |\\hat{\\mathbf{e}}_U| \\cos(\\theta_s)\n$$\n由于 $\\mathbf{s}$ 和 $\\hat{\\mathbf{e}}_U$ 是单位向量，它们的模长为 $|\\mathbf{s}| = 1$ 和 $|\\hat{\\mathbf{e}}_U| = 1$。因此，天向分量为：\n$$\ns_U = \\cos(\\theta_s)\n$$\n\n接下来，我们求解水平（东-北）平面中的分量。我们可以将向量 $\\mathbf{s}$ 分解为其垂直和水平部分：\n$$\n\\mathbf{s} = \\mathbf{s}_h + \\mathbf{s}_v\n$$\n其中 $\\mathbf{s}_v = s_U \\hat{\\mathbf{e}}_U$ 是垂直分量，$\\mathbf{s}_h = s_E \\hat{\\mathbf{e}}_E + s_N \\hat{\\mathbf{e}}_N$ 是水平分量，即 $\\mathbf{s}$ 在 E-N 平面上的投影。\n根据勾股定理应用于由 $\\mathbf{s}$ 及其投影构成的直角三角形，水平分量 $\\mathbf{s}_h$ 的模长由下式给出：\n$$\n|\\mathbf{s}_h| = |\\mathbf{s}| \\sin(\\theta_s) = \\sin(\\theta_s)\n$$\n\n太阳方位角 $\\phi_s$ 指定了水平向量 $\\mathbf{s}_h$ 在 E-N 平面内的方向。问题陈述中指出 $\\phi_s$ 是从地理北方向顺时针测量的。在我们的 ENU 坐标系中，这对应于从 $\\hat{\\mathbf{e}}_N$ 轴顺时针测量的角度。\n\n为了求出北向分量 $s_N$，我们将水平向量 $\\mathbf{s}_h$ 投影到北轴 $\\hat{\\mathbf{e}}_N$ 上。根据定义，$\\mathbf{s}_h$ 和 $\\hat{\\mathbf{e}}_N$ 之间的夹角是方位角 $\\phi_s$。\n$$\ns_N = |\\mathbf{s}_h| \\cos(\\phi_s) = \\sin(\\theta_s) \\cos(\\phi_s)\n$$\n\n为了求出东向分量 $s_E$，我们将 $\\mathbf{s}_h$ 投影到东轴 $\\hat{\\mathbf{e}}_E$ 上。ENU 坐标系是一个右手系。如果北对应y轴正向，东对应x轴正向，那么从北轴顺时针测量到东轴的角度是 $270^{\\circ}$ 或 $-90^{\\circ}$。反之，从东轴顺时针测量到北轴的角度是 $90^{\\circ}$。向量 $\\mathbf{s}_h$ 相对于东轴顺时针测量的角度是 $(\\phi_s - 90^{\\circ})$。因此，其在东轴上的投影是：\n$$\ns_E = |\\mathbf{s}_h| \\cos(\\phi_s - 90^{\\circ})\n$$\n使用三角恒等式 $\\cos(x - 90^{\\circ}) = \\sin(x)$，我们得到：\n$$\ns_E = |\\mathbf{s}_h| \\sin(\\phi_s) = \\sin(\\theta_s) \\sin(\\phi_s)\n$$\n这个从第一性原理出发的推导得出了变换公式。\n\n总结来说，太阳光照向量 $\\mathbf{s}$ 的分量是：\n$$\ns_E = \\sin(\\theta_s) \\sin(\\phi_s)\n$$\n$$\ns_N = \\sin(\\theta_s) \\cos(\\phi_s)\n$$\n$$\ns_U = \\cos(\\theta_s)\n$$\n\n现在，我们代入给定的值：$\\theta_s = 30^{\\circ}$ 和 $\\phi_s = 150^{\\circ}$。\n我们有以下三角函数值：\n$\\sin(30^{\\circ}) = \\frac{1}{2} = 0.5$\n$\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$\n$\\sin(150^{\\circ}) = \\sin(180^{\\circ} - 30^{\\circ}) = \\sin(30^{\\circ}) = \\frac{1}{2} = 0.5$\n$\\cos(150^{\\circ}) = \\cos(180^{\\circ} - 30^{\\circ}) = -\\cos(30^{\\circ}) = -\\frac{\\sqrt{3}}{2}$\n\n将这些值代入分量方程中：\n$s_E = \\sin(30^{\\circ}) \\sin(150^{\\circ}) = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4} = 0.25$\n$s_N = \\sin(30^{\\circ}) \\cos(150^{\\circ}) = \\left(\\frac{1}{2}\\right) \\left(-\\frac{\\sqrt{3}}{2}\\right) = -\\frac{\\sqrt{3}}{4}$\n$s_U = \\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$\n\n最后一步是进行数值计算并将结果四舍五入到四位有效数字。\n$s_E = 0.2500$\n$s_N = -\\frac{\\sqrt{3}}{4} \\approx -0.4330127... \\approx -0.4330$\n$s_U = \\frac{\\sqrt{3}}{2} \\approx 0.8660254... \\approx 0.8660$\n\n单位太阳光照向量 $\\mathbf{s}$ 在 ENU 坐标系中的分量为 $(0.2500, -0.4330, 0.8660)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2500,  -0.4330,  0.8660\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "太阳、目标和传感器之间的相对几何关系，特别是相位角 $g$，直接决定了观测到的地表反射特性。本练习要求推导相位角与太阳/观测天顶角及相对方位角之间的关系式，并探讨一个重要的特殊几何构型——后向散射。通过这个练习，你将能从根本上理解为何后向散射方向（或称“热点”）是一个在双向反射分布函数（BRDF）研究中备受关注的特殊角度 。",
            "id": "3855985",
            "problem": "考虑一个水平平面的地球表面和一个局部右手坐标系，其单位法向量 $\\hat{\\mathbf{n}}$ 指向上方。设太阳光照方向由太阳天顶角 $i$ 和太阳方位角 $\\phi_{s}$ 表征，传感器观测方向由观测天顶角 $e$ 和观测方位角 $\\phi_{v}$ 表征。在用于双向反射分布函数 (BRDF) 的标准双向几何中，相位角 $g$ 定义为从表面指向太阳的单位向量与从表面指向传感器的单位向量之间的夹角。从方向余弦和点积的定义出发，推导一个用 $i$、$e$ 以及水平表面上的相对方位角差 $\\Delta \\phi = \\phi_{v} - \\phi_{s}$ 表示的 $\\cos(g)$ 表达式。利用这个表达式，从第一性原理出发解释为什么后向散射几何对应于 $g \\approx 0$。最后，施加约束条件 $i = e$，并推导在水平表面上得出 $g = 0$ 时 $\\phi_{v}$ 和 $\\phi_{s}$ 需满足的条件。以弧度为单位，给出所需的相对方位角差 $\\Delta \\phi$ 的值。如果出现任何特殊的几何简并情况，请明确地对其进行分类，但不要改变所要求的数值。以弧度表示最终答案。无需进行四舍五入。",
            "solution": "该问题经评估是有效的，因为它基于几何光学和矢量微积分的原理，具有科学依据，问题设定良好且目标明确，没有歧义或矛盾。因此，我们可以进行完整解答。\n\n该问题要求用日-传感器几何关系推导相位角 $g$ 的余弦，并分析一个特殊情况。我们首先建立一个坐标系并表示方向向量。\n\n设水平平面上的关注点为右手笛卡尔坐标系 $(x, y, z)$ 的原点。该表面位于 $x-y$ 平面，因此指向上方的单位法向量为 $\\hat{\\mathbf{n}} = (0, 0, 1)$。\n\n太阳光照方向由单位向量 $\\hat{\\mathbf{\\Omega}}_s$ 描述，该向量从表面目标指向太阳。其朝向由太阳天顶角 $i$（$\\hat{\\mathbf{n}}$ 和 $\\hat{\\mathbf{\\Omega}}_s$ 之间的夹角）和太阳方位角 $\\phi_s$ 给出。在球坐标中，单位向量由其天顶角和方位角定义。转换为笛卡尔坐标，我们有：\n$$ \\hat{\\mathbf{\\Omega}}_s = (\\sin(i) \\cos(\\phi_s), \\sin(i) \\sin(\\phi_s), \\cos(i)) $$\n此处，$\\cos(i)$ 是 $\\hat{\\mathbf{\\Omega}}_s$ 在 $z$ 轴上的投影，$\\sin(i)$ 是其在 $x-y$ 平面上投影的模。\n\n类似地，传感器观测方向由单位向量 $\\hat{\\mathbf{\\Omega}}_v$ 描述，该向量从表面目标指向传感器。其朝向由观测天顶角 $e$ 和观测方位角 $\\phi_v$ 给出。其笛卡尔表示为：\n$$ \\hat{\\mathbf{\\Omega}}_v = (\\sin(e) \\cos(\\phi_v), \\sin(e) \\sin(\\phi_v), \\cos(e)) $$\n\n相位角 $g$ 定义为向量 $\\hat{\\mathbf{\\Omega}}_s$ 和 $\\hat{\\mathbf{\\Omega}}_v$ 之间的夹角。根据两个单位向量点积的定义，它们之间夹角的余弦就是它们的点积：\n$$ \\cos(g) = \\hat{\\mathbf{\\Omega}}_s \\cdot \\hat{\\mathbf{\\Omega}}_v $$\n代入笛卡尔分量，我们计算点积：\n$$ \\cos(g) = (\\sin(i) \\cos(\\phi_s)) (\\sin(e) \\cos(\\phi_v)) + (\\sin(i) \\sin(\\phi_s)) (\\sin(e) \\sin(\\phi_v)) + (\\cos(i)) (\\cos(e)) $$\n我们可以提取公因式 $\\sin(i) \\sin(e)$：\n$$ \\cos(g) = \\sin(i) \\sin(e) [\\cos(\\phi_s) \\cos(\\phi_v) + \\sin(\\phi_s) \\sin(\\phi_v)] + \\cos(i) \\cos(e) $$\n使用差角余弦的三角恒等式 $\\cos(A - B) = \\cos(A)\\cos(B) + \\sin(A)\\sin(B)$，令 $A = \\phi_v$ 和 $B = \\phi_s$，我们得到：\n$$ \\cos(g) = \\sin(i) \\sin(e) \\cos(\\phi_v - \\phi_s) + \\cos(i) \\cos(e) $$\n相对方位角差给定为 $\\Delta \\phi = \\phi_v - \\phi_s$。代入此定义，我们得出第一个要求的表达式：\n$$ \\cos(g) = \\cos(i) \\cos(e) + \\sin(i) \\sin(e) \\cos(\\Delta \\phi) $$\n\n接下来，我们从第一性原理出发解释为什么后向散射几何对应于 $g \\approx 0$。后向散射是辐射被直接散射回其源头的物理过程。在太阳-目标-传感器几何中，这意味着传感器与太阳位于同一视线上，但与太阳光照路径的方向相反。向量 $\\hat{\\mathbf{\\Omega}}_s$ 从目标指向太阳。向量 $\\hat{\\mathbf{\\Omega}}_v$ 从目标指向传感器。为了让传感器拦截到后向散射的辐射，它必须与太阳位于从目标看去的完全相同的方向上。因此，指向传感器的方向向量 $\\hat{\\mathbf{\\Omega}}_v$ 必须与指向太阳的方向向量 $\\hat{\\mathbf{\\Omega}}_s$ 重合。在数学上，这表示为 $\\hat{\\mathbf{\\Omega}}_v \\approx \\hat{\\mathbf{\\Omega}}_s$。相位角 $g$ 被定义为这两个向量之间的夹角。如果这两个向量几乎相同，根据定义，它们之间的夹角就接近于零。因此，后向散射几何对应于 $g \\approx 0$。这种配置在遥感中也被称为“热点”。\n\n最后，我们施加约束条件 $i = e$ 和 $g = 0$ 来找出对方位角的条件。设定 $g = 0$ 意味着 $\\cos(g) = \\cos(0) = 1$。我们推导出的表达式变为：\n$$ 1 = \\cos(i) \\cos(e) + \\sin(i) \\sin(e) \\cos(\\Delta \\phi) $$\n现在，我们应用约束条件 $i = e$：\n$$ 1 = \\cos(i) \\cos(i) + \\sin(i) \\sin(i) \\cos(\\Delta \\phi) $$\n$$ 1 = \\cos^2(i) + \\sin^2(i) \\cos(\\Delta \\phi) $$\n使用基本三角恒等式 $\\sin^2(i) + \\cos^2(i) = 1$，我们可以写出 $1 - \\cos^2(i) = \\sin^2(i)$。将此代入方程中得到：\n$$ \\sin^2(i) = \\sin^2(i) \\cos(\\Delta \\phi) $$\n为了解出 $\\cos(\\Delta \\phi)$，我们必须考虑两种情况。\n\n情况1：$i \\neq 0$。天顶角 $i$ 通常在 $[0, \\frac{\\pi}{2}]$ 范围内。对于 $i \\neq 0$，我们有 $\\sin(i) \\neq 0$，因此 $\\sin^2(i) \\neq 0$。我们可以安全地将方程两边同时除以 $\\sin^2(i)$：\n$$ 1 = \\cos(\\Delta \\phi) $$\n$\\Delta \\phi$ 的解为 $\\Delta \\phi = 2k\\pi$，其中 $k$ 为任意整数。主值为 $\\Delta \\phi = 0$。这意味着 $\\phi_v - \\phi_s = 0$，即 $\\phi_v = \\phi_s$。这就是当太阳天顶角和观测天顶角相等且非零时，实现精确后向散射几何（$g=0$）对方位角的要求条件。\n\n情况2：$i = 0$。如果太阳天顶角为 $i=0$，则光照来自正上方（天顶）。约束条件 $i=e$ 意味着 $e=0$，即传感器也是从正上方观测。在这种情况下，方程变为 $\\sin^2(0) = \\sin^2(0) \\cos(\\Delta \\phi)$，简化为 $0 = 0$。这个方程对任意 $\\cos(\\Delta \\phi)$ 的值都成立。这是一种几何简并。当太阳和传感器都位于天顶（$i=e=0$）时，它们的方位角 $\\phi_s$ 和 $\\phi_v$ 是未定义的或不相关的。方向向量 $\\hat{\\mathbf{\\Omega}}_s$ 和 $\\hat{\\mathbf{\\Omega}}_v$ 都变为 $(0, 0, 1)$，因此它们完全对齐，无论方位角如何，相位角 $g$ 始终为 $0$。\n\n问题要求的是所需的相对方位角差 $\\Delta \\phi$ 的值。除了 $i = e = 0$ 的简并情况外，条件明确为 $\\cos(\\Delta \\phi) = 1$。此条件的主值为 $\\Delta\\phi = 0$。所要求的以弧度表示的数值是 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "现代遥感分析严重依赖于复杂的双向反射分布函数（BRDF）模型，而理解模型对几何角度和内部参数的敏感性对于模型反演和不确定性评估至关重要。本练习将引导你对一个核驱动BRDF模型进行全面的敏感性分析，你需要推导模型的雅可比矩阵，并通过计算奇异值和范数来量化反射率对模型参数和观测几何变化的响应。这项高级实践综合了微积分、线性代数和计算技能，是连接理论与定量遥感应用的关键一步 。",
            "id": "3856047",
            "problem": "给定一个简化的核驱动双向反射分布函数（BRDF）模型，该模型旨在分析太阳-目标-传感器几何结构在方向反射率中的作用。该模型将方向反射率因子 $R$ 定义为三个系数和三个角度变量的函数：\n$$\nR(i,e,\\Delta\\phi; f_{iso}, f_{vol}, f_{geo}) \\equiv f_{iso} + f_{vol}\\,K_{vol}(i,e,\\Delta\\phi) + f_{geo}\\,K_{geo}(i,e),\n$$\n其中 $i$ 是太阳入射天顶角，$e$ 是传感器观测天顶角，$\\Delta\\phi$ 是太阳和观测方向之间的相对方位角。所有角度必须以弧度表示。系数 $f_{iso}$、$f_{vol}$ 和 $f_{geo}$ 是无量纲的反射率参数。\n\n在此模型中，体积散射核 $K_{vol}$ 通过太阳和观测方向之间的相位角 $\\xi$ 来确定：\n$$\n\\cos\\xi = \\cos i\\,\\cos e + \\sin i\\,\\sin e\\,\\cos(\\Delta\\phi), \\quad K_{vol}(i,e,\\Delta\\phi) = \\cos\\xi,\n$$\n而几何光学核 $K_{geo}$ 定义为：\n$$\nK_{geo}(i,e) = \\sec i + \\sec e - 2,\n$$\n其中 $\\sec x = 1 / \\cos x$。\n\n您的任务是计算 $R$ 关于参数矢量 $(f_{iso}, f_{vol}, f_{geo})$ 和角度矢量 $(i,e,\\Delta\\phi)$ 的雅可比矩阵，并使用这些雅可比矩阵对一组给定的观测数据进行灵敏度分析。请使用基本微分法则和三角恒等式，从以上提供的定义推导所有表达式。您的推导应基于第一性原理和经过检验的公式，不要引入任何额外的简化公式。\n\n定义和要求：\n- $R$ 关于 $(f_{iso}, f_{vol}, f_{geo})$ 的雅可比矩阵是偏导数的行向量\n$$\nJ_f(i,e,\\Delta\\phi) = \\left[\\frac{\\partial R}{\\partial f_{iso}},\\ \\frac{\\partial R}{\\partial f_{vol}},\\ \\frac{\\partial R}{\\partial f_{geo}}\\right].\n$$\n- $R$ 关于 $(i,e,\\Delta\\phi)$ 的雅可比矩阵是偏导数的行向量\n$$\nJ_\\theta(i,e,\\Delta\\phi; f_{iso}, f_{vol}, f_{geo}) = \\left[\\frac{\\partial R}{\\partial i},\\ \\frac{\\partial R}{\\partial e},\\ \\frac{\\partial R}{\\partial \\Delta\\phi}\\right].\n$$\n- 对于一组 $M$ 个观测值 $\\{(i_m,e_m,\\Delta\\phi_m)\\}_{m=1}^M$，关于参数的堆叠雅可比矩阵是通过将 $J_f(i_m,e_m,\\Delta\\phi_m)$ 作为行堆叠而成的 $M\\times 3$ 矩阵。同样，将 $J_\\theta(i_m,e_m,\\Delta\\phi_m; f_{iso}, f_{vol}, f_{geo})$ 堆叠成一个 $M\\times 3$ 矩阵。\n\n灵敏度分析要求：\n- 对于参数雅可比矩阵（在 $M$ 个观测值上堆叠），计算两个度量指标：该 $M\\times 3$ 矩阵的最大奇异值 $\\sigma_{\\max}$ 和最小奇异值 $\\sigma_{\\min}$。这些值量化了系数矢量中的单位变化在整个观测集上被放大为反射率变化的程度。\n- 对于角度雅可比矩阵（在 $M$ 个观测值上堆叠），计算该 $M\\times 3$ 矩阵的弗罗贝尼乌斯范数 $\\|J_\\theta\\|_F$，它量化了在整个观测集上反射率对角度（以弧度为单位）单位变化的总体灵敏度。\n\n角度单位：所有角度必须为弧度。反射率和雅可比矩阵的元素是无量纲的。您必须将所有报告的浮点度量指标四舍五入到六位小数。\n\n测试套件：\n- 测试用例 $1$（一般情况）：使用 $f_{iso}=0.03$，$f_{vol}=0.12$，$f_{geo}=-0.01$ 以及 $M=5$ 个观测值\n$$\n(i,e,\\Delta\\phi) \\in \\{(0.4,0.3,1.0),\\ (0.6,0.4,0.5),\\ (0.2,0.7,2.2),\\ (0.8,0.2,1.6),\\ (0.5,0.5,0.0)\\}.\n$$\n- 测试用例 $2$（近天底边界）：使用 $f_{iso}=0.05$，$f_{vol}=0.08$，$f_{geo}=0.00$ 以及 $M=3$ 个观测值\n$$\n(i,e,\\Delta\\phi) \\in \\{(0.0,0.0,0.0),\\ (0.05,0.02,1.0),\\ (0.02,0.05,2.5)\\}.\n$$\n- 测试用例 $3$（掠射角边缘情况）：使用 $f_{iso}=0.02$，$f_{vol}=0.15$，$f_{geo}=0.05$ 以及 $M=4$ 个观测值\n$$\n(i,e,\\Delta\\phi) \\in \\{(1.4,1.4,0.0),\\ (1.5,1.3,3.141592653589793),\\ (1.45,1.5,1.2),\\ (1.5,1.45,1.6)\\}.\n$$\n\n程序要求：\n- 根据上述基本定义，解析地实现雅可比矩阵，使用标准微分和三角恒等式。\n- 对于每个测试用例，按顺序计算三个度量指标：$\\sigma_{\\max}(J_f)$、$\\sigma_{\\min}(J_f)$ 和 $\\|J_\\theta\\|_F$。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个测试用例贡献一个包含三个浮点数的列表，这些浮点数四舍五入到六位小数。最终格式必须是\n$$\n\\text{[ [\\sigma_{\\max}^{(1)},\\sigma_{\\min}^{(1)},\\|J_\\theta^{(1)}\\|_F],\\ [\\sigma_{\\max}^{(2)},\\sigma_{\\min}^{(2)},\\|J_\\theta^{(2)}\\|_F],\\ [\\sigma_{\\max}^{(3)},\\sigma_{\\min}^{(3)},\\|J_\\theta^{(3)}\\|_F] ]}\n$$\n不含任何附加文本。确保输出与指定格式完全一致，且为单行。",
            "solution": "该问题被评估为有效，因为它在科学上基于辐射传输和遥感的原理，在数学上是适定的、客观的，并包含唯一解所需的所有必要信息。任务是通过计算一个简化的双向反射分布函数（BRDF）模型的雅可比矩阵及相关度量指标来进行灵敏度分析。\n\nBRDF 模型由以下公式给出：\n$$\nR(i,e,\\Delta\\phi; f_{iso}, f_{vol}, f_{geo}) = f_{iso} + f_{vol}\\,K_{vol}(i,e,\\Delta\\phi) + f_{geo}\\,K_{geo}(i,e)\n$$\n其中 $i$ 是太阳天顶角，$e$ 是观测天顶角，$\\Delta\\phi$ 是相对方位角，$f_{iso}$、$f_{vol}$、$f_{geo}$ 是模型参数。体积散射核 $K_{vol}$ 和几何光学核 $K_{geo}$ 定义如下：\n$$\nK_{vol}(i,e,\\Delta\\phi) = \\cos i\\,\\cos e + \\sin i\\,\\sin e\\,\\cos(\\Delta\\phi)\n$$\n$$\nK_{geo}(i,e) = \\sec i + \\sec e - 2\n$$\n所有角度均以弧度为单位。\n\n解决方案的结构如下：首先，我们推导 $R$ 相对于参数矢量 $(f_{iso}, f_{vol}, f_{geo})$ 的雅可比矩阵的解析表达式，记为 $J_f$。其次，我们推导相对于角度变量矢量 $(i,e,\\Delta\\phi)$ 的雅可比矩阵，记为 $J_\\theta$。最后，我们描述灵敏度度量指标的计算过程：堆叠的 $J_f$ 矩阵的奇异值（$\\sigma_{\\max}$，$\\sigma_{\\min}$）和堆叠的 $J_\\theta$ 矩阵的弗罗贝尼乌斯范数（$\\|J_\\theta\\|_F$）。\n\n**1. 参数雅可比矩阵 $J_f$ 的推导**\n\n$R$ 相对于参数 $f = (f_{iso}, f_{vol}, f_{geo})$ 的雅可比矩阵是一个行向量，包含 $R$ 对每个参数的偏导数。\n$$\nJ_f(i,e,\\Delta\\phi) = \\left[\\frac{\\partial R}{\\partial f_{iso}},\\ \\frac{\\partial R}{\\partial f_{vol}},\\ \\frac{\\partial R}{\\partial f_{geo}}\\right]\n$$\n通过对模型方程应用偏微分法则，我们将核 $K_{vol}$ 和 $K_{geo}$ 视为相对于参数的常数：\n$$\n\\frac{\\partial R}{\\partial f_{iso}} = \\frac{\\partial}{\\partial f_{iso}}(f_{iso} + f_{vol}K_{vol} + f_{geo}K_{geo}) = 1\n$$\n$$\n\\frac{\\partial R}{\\partial f_{vol}} = \\frac{\\partial}{\\partial f_{vol}}(f_{iso} + f_{vol}K_{vol} + f_{geo}K_{geo}) = K_{vol}(i,e,\\Delta\\phi)\n$$\n$$\n\\frac{\\partial R}{\\partial f_{geo}} = \\frac{\\partial}{\\partial f_{geo}}(f_{iso} + f_{vol}K_{vol} + f_{geo}K_{geo}) = K_{geo}(i,e)\n$$\n因此，参数雅可比矩阵为：\n$$\nJ_f(i,e,\\Delta\\phi) = [1, K_{vol}(i,e,\\Delta\\phi), K_{geo}(i,e)]\n$$\n对于一组 $M$ 个观测值，堆叠的雅可比矩阵 $J_f$ 是一个 $M \\times 3$ 矩阵，其中每一行对应一个观测值。\n\n**2. 角度雅可比矩阵 $J_\\theta$ 的推导**\n\n$R$ 相对于角度 $\\theta = (i,e,\\Delta\\phi)$ 的雅可比矩阵是一个偏导数的行向量：\n$$\nJ_\\theta(i,e,\\Delta\\phi; f_{iso}, f_{vol}, f_{geo}) = \\left[\\frac{\\partial R}{\\partial i},\\ \\frac{\\partial R}{\\partial e},\\ \\frac{\\partial R}{\\partial \\Delta\\phi}\\right]\n$$\n利用微分算子的线性和链式法则，我们有：\n$$\n\\frac{\\partial R}{\\partial \\theta_j} = \\frac{\\partial}{\\partial \\theta_j} (f_{iso} + f_{vol}K_{vol} + f_{geo}K_{geo}) = f_{vol}\\frac{\\partial K_{vol}}{\\partial \\theta_j} + f_{geo}\\frac{\\partial K_{geo}}{\\partial \\theta_j}\n$$\n其中 $\\theta_j$ 是 $i$、$e$ 或 $\\Delta\\phi$ 之一。我们必须首先求出核的偏导数。\n\n$K_{vol} = \\cos i\\,\\cos e + \\sin i\\,\\sin e\\,\\cos(\\Delta\\phi)$ 的偏导数：\n$$\n\\frac{\\partial K_{vol}}{\\partial i} = -\\sin i\\,\\cos e + \\cos i\\,\\sin e\\,\\cos(\\Delta\\phi)\n$$\n$$\n\\frac{\\partial K_{vol}}{\\partial e} = -\\cos i\\,\\sin e + \\sin i\\,\\cos e\\,\\cos(\\Delta\\phi)\n$$\n$$\n\\frac{\\partial K_{vol}}{\\partial \\Delta\\phi} = \\sin i\\,\\sin e\\,(-\\sin(\\Delta\\phi)) = -\\sin i\\,\\sin e\\,\\sin(\\Delta\\phi)\n$$\n\n$K_{geo} = \\sec i + \\sec e - 2$ 的偏导数：\n回想一下 $(\\sec x)' = \\sec x \\tan x$。\n$$\n\\frac{\\partial K_{geo}}{\\partial i} = \\frac{\\partial}{\\partial i}(\\sec i + \\sec e - 2) = \\sec i \\tan i\n$$\n这也可以用正弦和余弦表示为 $\\frac{\\sin i}{\\cos^2 i}$。\n$$\n\\frac{\\partial K_{geo}}{\\partial e} = \\frac{\\partial}{\\partial e}(\\sec i + \\sec e - 2) = \\sec e \\tan e = \\frac{\\sin e}{\\cos^2 e}\n$$\n$$\n\\frac{\\partial K_{geo}}{\\partial \\Delta\\phi} = \\frac{\\partial}{\\partial \\Delta\\phi}(\\sec i + \\sec e - 2) = 0\n$$\n将这些代入 $J_\\theta$ 分量的表达式中：\n$$\n\\frac{\\partial R}{\\partial i} = f_{vol}(-\\sin i\\,\\cos e + \\cos i\\,\\sin e\\,\\cos(\\Delta\\phi)) + f_{geo}(\\sec i \\tan i)\n$$\n$$\n\\frac{\\partial R}{\\partial e} = f_{vol}(-\\cos i\\,\\sin e + \\sin i\\,\\cos e\\,\\cos(\\Delta\\phi)) + f_{geo}(\\sec e \\tan e)\n$$\n$$\n\\frac{\\partial R}{\\partial \\Delta\\phi} = f_{vol}(-\\sin i\\,\\sin e\\,\\sin(\\Delta\\phi))\n$$\n这三个表达式构成了行向量 $J_\\theta$ 的分量。对于 $M$ 个观测值，堆叠的 $J_\\theta$ 是一个 $M \\times 3$ 矩阵。\n\n**3. 灵敏度度量指标计算**\n\n推导出的雅可比矩阵用于为每个测试用例计算所需的灵敏度度量指标。\n\n对于堆叠的参数雅可比矩阵 $J_f$（一个 $M \\times 3$ 矩阵），我们计算其奇异值。一个矩阵的奇异值是 $J_f^T J_f$ 的特征值的平方根。我们找到这些值中的最大值（$\\sigma_{\\max}$）和最小值（$\\sigma_{\\min}$）。这通过使用奇异值分解（SVD）算法以数值方式完成。\n\n对于堆叠的角度雅可比矩阵 $J_\\theta$（一个 $M \\times 3$ 矩阵），我们计算其弗罗贝尼乌斯范数，定义为：\n$$\n\\|J_\\theta\\|_F = \\sqrt{\\sum_{m=1}^{M} \\sum_{j=1}^{3} |(J_\\theta)_{mj}|^2}\n$$\n其中 $(J_\\theta)_{mj}$ 是第 $m$ 行第 $j$ 列的元素。该范数衡量了在所有观测值上，反射率对角度变量变化的总体灵敏度大小。\n\n**4. 实现**\n\n最后一步是在 Python 程序中实现这些公式。`numpy` 库用于高效的数组操作。定义一个函数来处理每个测试用例。该函数遍历观测值，根据推导的解析表达式计算 $J_f$ 和 $J_\\theta$ 矩阵的行，并将它们堆叠成 `numpy` 数组。`numpy.linalg.svd` 用于计算 $J_f$ 矩阵的奇异值，而 `numpy.linalg.norm` 与 `'fro'` 选项用于计算 $J_\\theta$ 矩阵的弗罗贝尼乌斯范数。收集每个测试用例的结果，并格式化为指定的字符串输出，所有浮点值四舍五入到六位小数。",
            "answer": "[[2.366433,0.814389,0.144414],[1.732061,1.731998,0.008034],[21.328320,0.024925,2.148119]]"
        }
    ]
}