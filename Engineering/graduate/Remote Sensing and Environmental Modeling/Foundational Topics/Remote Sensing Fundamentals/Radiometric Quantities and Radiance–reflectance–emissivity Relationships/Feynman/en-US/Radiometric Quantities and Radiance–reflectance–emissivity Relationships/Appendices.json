{
    "hands_on_practices": [
        {
            "introduction": "In passive remote sensing, all quantitative analysis is built upon the fundamental principle of energy conservation. This exercise challenges you to construct a thought experiment that rigorously demonstrates why the directional-hemispherical reflectance, $\\rho$, of a passive surface cannot exceed unity. Engaging with this concept  solidifies the physical constraints that govern light-matter interactions and helps distinguish physically plausible measurements from artifacts or phenomena involving active energy sources.",
            "id": "3839604",
            "problem": "A passive, opaque, perfectly Lambertian surface is defined such that its outgoing radiance is independent of direction and proportional to the incident irradiance. Consider the standard radiometric quantities: radiance $L(\\lambda)$ (power per unit projected area per unit solid angle per unit wavelength), irradiance $E(\\lambda)$ (power per unit area per unit wavelength), and the Bidirectional Reflectance Distribution Function (BRDF) $f_r(\\lambda,\\theta_i,\\phi_i;\\theta_o,\\phi_o)$, defined as the ratio of an incremental change in outgoing radiance to an incremental change in incident irradiance, $\\mathrm{d}L_o(\\lambda,\\theta_o,\\phi_o) / \\mathrm{d}E_i(\\lambda,\\theta_i,\\phi_i)$. The directional–hemispherical reflectance $\\rho(\\lambda,\\theta_i,\\phi_i)$ is the fraction of incident irradiance reflected into the outgoing hemisphere. Assume passivity (no internal sources or gain), opacity (no transmission), and that all quantities are spectrally resolved at a fixed wavelength $\\lambda$.\n\nWhich option best constructs a thought experiment grounded in first principles that demonstrates why $\\rho \\leq 1$ must hold for a passive Lambertian surface, and correctly explains the physical implication of violating $\\rho > 1$?\n\nA. Place a finite Lambertian patch inside an ideal, lossless integrating sphere with a small aperture admitting a steady, spectrally narrow irradiance $E_{\\text{in}}(\\lambda)$. Track photon power balance across multiple reflections: each reflection from the Lambertian patch returns a fraction $\\rho$ of the incident power to the cavity. If $\\rho > 1$, the reflected power after $n$ bounces scales like a growing geometric progression, implying unbounded radiant flux growth in a passive, closed system, which violates energy conservation. Therefore $\\rho \\leq 1$. If measurements indicate $\\rho > 1$, the physical implication is that the surface is not passive; it must supply net energy (optical gain), for example through externally pumped luminescence or amplification.\n\nB. Illuminate the Lambertian surface with a narrow collimated beam and note that cosine-law redistribution increases outgoing radiance in certain directions relative to the incident direction. Because radiance can be larger than the incident value in some directions without violating conservation, $\\rho > 1$ is permissible for Lambertian surfaces. Violating $\\rho \\leq 1$ merely indicates strong beaming, not a physical inconsistency.\n\nC. Invoke thermal emission: at sufficiently low temperature, emissivity is small, so reflectance must compensate and can exceed $1$ while maintaining passivity. Violating $\\rho \\leq 1$ is consistent with Kirchhoff’s law of thermal radiation because reflectance and emissivity trade off to conserve energy, and $\\rho > 1$ simply signals “super-reflective” behavior.\n\nD. Argue from the BRDF definition and hemispherical integration that energy conservation bounds reflectance for Lambertian surfaces. If an experiment registers $\\rho > 1$, the most likely explanation is calibration or unit-conversion error, not any physical inconsistency; therefore $\\rho > 1$ has no particular physical implication beyond measurement artifacts.\n\nChoose the single best option.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   The surface is passive, opaque, and perfectly Lambertian.\n-   Outgoing radiance from a Lambertian surface is independent of direction.\n-   Outgoing radiance is proportional to incident irradiance.\n-   Radiance is denoted by $L(\\lambda)$ (in units of power per unit projected area per unit solid angle per unit wavelength).\n-   Irradiance is denoted by $E(\\lambda)$ (in units of power per unit area per unit wavelength).\n-   The Bidirectional Reflectance Distribution Function (BRDF) is defined as $f_r(\\lambda,\\theta_i,\\phi_i;\\theta_o,\\phi_o) = \\mathrm{d}L_o(\\lambda,\\theta_o,\\phi_o) / \\mathrm{d}E_i(\\lambda,\\theta_i,\\phi_i)$.\n-   Directional–hemispherical reflectance, $\\rho(\\lambda,\\theta_i,\\phi_i)$, is the fraction of incident irradiance reflected into the outgoing hemisphere.\n-   Assumptions: passivity (no internal energy sources), opacity (no transmission), and all quantities are considered at a fixed wavelength $\\lambda$.\n-   The question asks to identify the option that best constructs a thought experiment to demonstrate why $\\rho \\le 1$ for a passive Lambertian surface and explains the physical implication of $\\rho > 1$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on fundamental principles of radiometry and the conservation of energy. The definitions of radiance, irradiance, BRDF, reflectance, and the properties of Lambertian, passive, and opaque surfaces are all standard and well-established in physics and optics. The core of the problem addresses the implications of the first law of thermodynamics in the context of light-matter interaction.\n-   **Well-Posed:** The question is clearly formulated. It asks for the best conceptual argument (a thought experiment) among a set of choices that demonstrates a known physical law ($\\rho \\le 1$ for passive surfaces) and its consequences. The criteria for \"best\" are clear: grounded in first principles and correctly explaining the physical implications.\n-   **Objective:** The language is formal, technical, and free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and self-contained. It is a valid problem that tests the understanding of fundamental radiometric principles. I will proceed with deriving the solution and evaluating the options.\n\n**Solution Derivation and Option Analysis**\n\nThe fundamental principle governing the interaction of radiation with a passive material is the conservation of energy. For a surface element receiving incident radiant power, that power can be reflected, absorbed, or transmitted. The problem specifies the surface is opaque, which means the transmittance is zero. Therefore, the incident power can only be reflected or absorbed.\n\nLet $P_i$ be the total incident power on a surface area. Let $P_r$ be the total reflected power and $P_a$ be the total absorbed power. By the law of conservation of energy, for a passive system (one that cannot generate its own energy), the sum of outgoing and absorbed power cannot exceed the incident power.\n$$ P_r + P_a \\le P_i $$\nFor a truly passive, opaque surface without phenomena like fluorescence (which involves absorption and re-emission, often at different wavelengths, and can be considered a form of absorption), the energy is strictly conserved at the specified wavelength, so:\n$$ P_r + P_a = P_i $$\nDividing by the incident power $P_i$, we get:\n$$ \\frac{P_r}{P_i} + \\frac{P_a}{P_i} = 1 $$\nThe fraction of reflected power is the reflectance, $\\rho = P_r / P_i$. The fraction of absorbed power is the absorptance, $\\alpha = P_a / P_i$. Thus, for an opaque surface:\n$$ \\rho + \\alpha = 1 $$\nSince power cannot be negative, the absorbed power $P_a$ must be non-negative, meaning $\\alpha \\ge 0$. From the energy balance equation, this directly implies:\n$$ \\rho = 1 - \\alpha \\le 1 $$\nThis is the fundamental constraint derived from the first law of thermodynamics. Any valid thought experiment must demonstrate the physical contradiction that arises if this law is violated. If a measurement yields $\\rho > 1$, it means $P_r > P_i$, which implies that the surface is outputting more power than it receives. This can only happen if the \"passive\" assumption is incorrect; the surface must possess an internal energy source or be part of a system that provides gain (e.g., through stimulated emission or luminescence from an external pump).\n\nNow, let's evaluate each option based on this principle.\n\n**Option A Evaluation**\nThis option proposes a thought experiment involving a passive Lambertian patch inside an ideal integrating sphere. The sphere itself is lossless, meaning its walls are perfectly reflecting or the setup is analyzed over bounces on the sample only. A steady input of power is introduced.\n-   **Thought Experiment:** The logic traces the power balance. After entering the sphere, a portion of the power strikes the Lambertian patch. This patch reflects a fraction $\\rho$ of the power incident upon it. This reflected power then redistributes within the sphere, and a fraction of it will strike the patch again.\n-   **Reasoning:** If $\\rho > 1$, each interaction with the patch would amplify the power incident upon it. For an initial power $P_0$ striking the patch, it would reflect $\\rho P_0$. This power would, after some redistribution, lead to a subsequent incidence, and the process would repeat. The total radiant power within the sphere would grow with each reflection cycle, scaling as a geometric series with a ratio $\\rho > 1$. A finite, steady input power would lead to an unbounded increase in the total power circulating within the closed, passive system.\n-   **Physical Contradiction:** This runaway power amplification in a passive system is a clear and direct violation of the law of conservation of energy (the first law of thermodynamics).\n-   **Implication of $\\rho > 1$:** The option correctly concludes that if a real measurement yielded $\\rho > 1$, the inescapable physical conclusion is that the passivity assumption is false. The material must be providing optical gain, meaning it is converting some other form of energy into light at the measured wavelength. Examples like externally pumped luminescence or amplification are appropriate.\n-   **Verdict:** This option provides a rigorous, intuitive, and physically correct thought experiment that is perfectly grounded in first principles. It correctly identifies the violation of energy conservation and accurately explains the physical meaning of an apparent $\\rho > 1$ measurement. **Correct**.\n\n**Option B Evaluation**\nThis option argues that since outgoing radiance in some directions can be greater than incident radiance, then $\\rho > 1$ is permissible.\n-   **Reasoning:** The premise confuses radiance ($L$, in $W \\cdot m^{-2} \\cdot sr^{-1}$) with reflectance ($\\rho$, dimensionless) or exitance ($M$, in $W \\cdot m^{-2}$). Radiance is a directional quantity. For a specular (mirror-like) surface, the outgoing radiance in the reflection direction can be extremely high, but it is concentrated in a very small solid angle. Reflectance, $\\rho$, is the integral of the reflected power over the entire hemisphere. The total reflected power can never exceed the total incident power for a passive surface.\n-   **Specific Flaws:**\n    1.  The statement \"$\\rho > 1$ is permissible for Lambertian surfaces\" is false. As derived earlier, energy conservation requires $\\rho \\le 1$ for *any* passive surface, including Lambertian ones. For a Lambertian surface, the BRDF $f_r$ is constant, and $\\rho = \\pi f_r$. The condition $\\rho \\le 1$ implies $f_r \\le 1/\\pi$.\n    2.  The statement \"Violating $\\rho \\le 1$ merely indicates strong beaming\" is also false. First, Lambertian surfaces do not have beaming; they reflect isotropically. Second, even for surfaces with strong beaming (high directionality), the total hemispherical reflectance $\\rho$ must still be $\\le 1$.\n-   **Verdict:** This option is based on a fundamental misunderstanding of radiometric quantities. **Incorrect**.\n\n**Option C Evaluation**\nThis option invokes Kirchhoff's law of thermal radiation, claiming that at low temperatures, low emissivity allows reflectance to exceed $1$.\n-   **Reasoning:** For a body in thermal equilibrium with its surroundings, Kirchhoff's law states that its spectral directional emissivity $\\epsilon(\\lambda, \\theta, \\phi)$ is equal to its spectral directional absorptivity $\\alpha(\\lambda, \\theta, \\phi)$. The problem specifies an opaque surface, for which $\\rho + \\alpha = 1$. Combining these, we get $\\rho + \\epsilon = 1$.\n-   **Specific Flaws:** This relationship shows that reflectance and emissivity are complementary. If emissivity $\\epsilon$ is small (as it might be for a good reflector at low temperature), the reflectance $\\rho$ must be close to $1$ (e.g., if $\\epsilon = 0.05$, then $\\rho = 0.95$). The law absolutely does not permit $\\rho$ to exceed $1$. The argument that $\\rho$ can exceed $1$ to \"compensate\" for small $\\epsilon$ is a gross misinterpretation of the energy balance equation.\n-   **Verdict:** This option misapplies and misinterprets fundamental laws of thermodynamics and radiation. **Incorrect**.\n\n**Option D Evaluation**\nThis option correctly states that energy conservation bounds reflectance but then attributes any measurement of $\\rho > 1$ to experimental error, claiming it has \"no particular physical implication.\"\n-   **Reasoning:** The first part of the argument is sound: the BRDF definition and hemispherical integration, combined with energy conservation, lead to the constraint $\\rho \\le 1$. However, the second part of the argument is a flaw.\n-   **Specific Flaws:** While calibration errors are a common practical issue in radiometry, the question asks for the *physical implication* of a true violation (i.e., assuming the measurement is accurate). By dismissing a measurement of $\\rho > 1$ as merely an error, this option avoids answering the core conceptual question. A value of $\\rho > 1$, if real, has a profound physical implication: the system is not passive. This is the same critical point that Option A makes correctly. Option D's refusal to engage with this implication makes it an incomplete and evasive answer.\n-   **Verdict:** This option fails to provide a complete answer to the question posed, particularly regarding the physical meaning of a violation. It correctly identifies the principle but dodges its consequences. Compared to Option A, which provides a full and insightful explanation, this option is inferior. **Incorrect**.\n\n**Conclusion**\n\nOption A provides the best-constructed thought experiment. It uses the powerful model of an integrating sphere to vividly illustrate how $\\rho > 1$ would lead to a \"perpetual motion\"-like scenario of unbounded energy growth from a finite input, which is a clear violation of a first principle (conservation of energy). It then correctly concludes that if such a result were observed, the initial assumption of passivity must be wrong, and the surface is actively generating light.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While the total reflected energy from a passive surface is capped by the incident energy, its angular distribution is rarely uniform. This practice  moves from the general principle of energy conservation to a practical application in the reflected solar domain, exploring the consequences of modeling assumptions. You will derive and implement a method to quantify the retrieval bias that occurs when a simplified Lambertian model is used to estimate the reflectance of a more realistic, anisotropic surface, a common challenge in analyzing satellite imagery.",
            "id": "3839583",
            "problem": "A remote sensing instrument observes a surface under collimated illumination from the Sun. The downwelling irradiance is $E_0$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, arriving from solar zenith angle $\\theta_i$ and solar azimuth $\\phi_i$. The instrument measures the reflected radiance $L_r(\\theta_v,\\phi_v)$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}$ at view zenith angle $\\theta_v$ and view azimuth $\\phi_v$. The bidirectional reflectance distribution function (BRDF) is defined such that, for collimated illumination, the reflected radiance satisfies $L_r(\\theta_v,\\phi_v) = f_r(\\theta_i,\\phi_i;\\theta_v,\\phi_v)\\,E_0$, where $f_r$ has units $\\mathrm{sr}^{-1}$. \n\nIn foundation, a Lambertian surface has constant BRDF $f_r = \\rho/\\pi$, where $\\rho$ is the directional-hemispherical reflectance (dimensionless). For a mildly anisotropic surface, consider the kernel-driven BRDF\n$$\nf_r(\\theta_i,\\phi_i;\\theta_v,\\phi_v) = \\frac{\\rho}{\\pi}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right],\n$$\nwhere $\\Delta\\phi = \\phi_v - \\phi_i$, $\\alpha$ and $\\beta$ are dimensionless anisotropy coefficients satisfying $|\\alpha| \\leq 0.2$ and $|\\beta| \\leq 0.2$, and all angles are in degrees. Assume reciprocity and energy considerations are satisfied for this mild anisotropy regime.\n\nSuppose a retrieval algorithm incorrectly assumes Lambertian behavior and inverts the measurement using $f_r = \\rho/\\pi$ to estimate $\\rho$ from the measured radiance $L_r$. Starting only from the core definitions above, derive the expression for the retrieval bias in $\\rho$ induced by this incorrect assumption, as a function of $\\theta_i$, $\\theta_v$, $\\Delta\\phi$, $\\alpha$, and $\\beta$. Express the bias as a difference between the retrieved $\\rho$ and the true $\\rho$ (dimensionless, unitless), with the sign indicating overestimation ($>0$) or underestimation ($0$).\n\nThen implement a program that computes this bias for each of the following test cases. All angles are provided in degrees, and cosines and sines must be computed using those angles converted to radians internally. Report each bias as a float rounded to six decimal places. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").\n\nTest Suite (angles in degrees, irradiance in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, reflectance dimensionless):\n- Case A (general backscattering, mild anisotropy): $E_0 = 800$, $\\rho = 0.2$, $\\theta_i = 30$, $\\theta_v = 20$, $\\Delta\\phi = 0$, $\\alpha = 0.1$, $\\beta = 0.05$.\n- Case B (Lambertian boundary): $E_0 = 800$, $\\rho = 0.2$, $\\theta_i = 30$, $\\theta_v = 20$, $\\Delta\\phi = 0$, $\\alpha = 0$, $\\beta = 0$.\n- Case C (forward scattering, near-grazing view): $E_0 = 600$, $\\rho = 0.3$, $\\theta_i = 40$, $\\theta_v = 75$, $\\Delta\\phi = 180$, $\\alpha = 0.1$, $\\beta = 0.1$.\n- Case D (cross-plane, anisotropy dominated by $\\alpha$): $E_0 = 900$, $\\rho = 0.25$, $\\theta_i = 50$, $\\theta_v = 40$, $\\Delta\\phi = 90$, $\\alpha = 0.12$, $\\beta = 0.2$.\n- Case E (high solar zenith, nadir view): $E_0 = 1000$, $\\rho = 0.1$, $\\theta_i = 80$, $\\theta_v = 0$, $\\Delta\\phi = 0$, $\\alpha = 0.05$, $\\beta = 0.05$.\n- Case F (mixed anisotropy signs): $E_0 = 700$, $\\rho = 0.22$, $\\theta_i = 55$, $\\theta_v = 65$, $\\Delta\\phi = 45$, $\\alpha = -0.05$, $\\beta = 0.07$.\n\nYour program should produce a single line of output containing the six biases as a comma-separated list enclosed in square brackets and rounded to six decimal places, in the order A through F.",
            "solution": "The problem requires the derivation of the retrieval bias for surface reflectance, $\\rho$, when an anisotropic surface is incorrectly treated as Lambertian. The bias is defined as the difference between the retrieved reflectance, $\\rho_{\\text{retrieved}}$, and the true reflectance, $\\rho_{\\text{true}}$.\n\nLet the true surface reflectance be $\\rho_{\\text{true}}$. The surface is characterized by the provided kernel-driven Bidirectional Reflectance Distribution Function (BRDF), which we denote as $f_{r, \\text{true}}$. This BRDF relates the downwelling collimated irradiance, $E_0$, to the reflected radiance, $L_r$, measured by the instrument. The illumination direction is given by the solar zenith angle $\\theta_i$ and solar azimuth angle $\\phi_i$, and the viewing direction is given by the view zenith angle $\\theta_v$ and view azimuth angle $\\phi_v$. The relative azimuth angle is $\\Delta\\phi = \\phi_v - \\phi_i$.\n\nFirst, we write the expression for the true radiance reflected from the surface, which is the quantity the instrument measures. According to the problem statement, this is:\n$$\nL_r = f_{r, \\text{true}}(\\theta_i, \\phi_i; \\theta_v, \\phi_v) E_0\n$$\nThe specific model for the anisotropic BRDF is given as:\n$$\nf_{r, \\text{true}}(\\theta_i, \\phi_i; \\theta_v, \\phi_v) = \\frac{\\rho_{\\text{true}}}{\\pi}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right]\n$$\nHere, $\\alpha$ and $\\beta$ are dimensionless anisotropy coefficients. Substituting this into the radiance equation gives the measured radiance:\n$$\nL_r = \\frac{\\rho_{\\text{true}}}{\\pi}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right] E_0\n$$\n\nNext, we consider the retrieval process. The algorithm incorrectly assumes the surface is Lambertian. A Lambertian surface has a constant BRDF, $f_{r, \\text{Lambert}}$, given by:\n$$\nf_{r, \\text{Lambert}} = \\frac{\\rho}{\\pi}\n$$\nThe retrieval algorithm uses this Lambertian model to invert the measured radiance $L_r$ to find an estimate for the reflectance, which we call $\\rho_{\\text{retrieved}}$. The algorithm's underlying model equation is:\n$$\nL_r = f_{r, \\text{Lambert}} E_0 = \\frac{\\rho_{\\text{retrieved}}}{\\pi} E_0\n$$\nTo find the value of $\\rho_{\\text{retrieved}}$, the algorithm solves this equation for it:\n$$\n\\rho_{\\text{retrieved}} = \\frac{L_r \\pi}{E_0}\n$$\n\nNow, we substitute the expression for the actual measured radiance $L_r$ (from the true anisotropic surface) into the algorithm's inversion equation:\n$$\n\\rho_{\\text{retrieved}} = \\frac{\\pi}{E_0} \\left( \\frac{\\rho_{\\text{true}}}{\\pi}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right] E_0 \\right)\n$$\nThe terms $\\pi$ in the numerator and denominator cancel, as does the downwelling irradiance $E_0$. This shows that the retrieved reflectance, and thus the bias, is independent of the incident irradiance level for this specific problem formulation. The simplified expression for the retrieved reflectance is:\n$$\n\\rho_{\\text{retrieved}} = \\rho_{\\text{true}}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right]\n$$\n\nFinally, we derive the retrieval bias, which is defined as $\\rho_{\\text{retrieved}} - \\rho_{\\text{true}}$. A positive bias indicates overestimation, while a negative bias indicates underestimation.\n$$\n\\text{Bias} = \\rho_{\\text{retrieved}} - \\rho_{\\text{true}}\n$$\nSubstituting the expression for $\\rho_{\\text{retrieved}}$:\n$$\n\\text{Bias} = \\left( \\rho_{\\text{true}}\\left[1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)\\right] \\right) - \\rho_{\\text{true}}\n$$\nWe can factor out $\\rho_{\\text{true}}$ from both terms:\n$$\n\\text{Bias} = \\rho_{\\text{true}} \\left( [1 + \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi)] - 1 \\right)\n$$\nThe $1$ and $-1$ terms cancel, leaving the final expression for the retrieval bias:\n$$\n\\text{Bias} = \\rho_{\\text{true}} \\left[ \\alpha \\cos\\theta_i \\cos\\theta_v + \\beta \\sin\\theta_i \\sin\\theta_v \\cos(\\Delta\\phi) \\right]\n$$\nThis expression will be implemented to compute the bias for each test case. The angles $\\theta_i$, $\\theta_v$, and $\\Delta\\phi$ given in degrees must be converted to radians for use in the trigonometric functions $\\cos$ and $\\sin$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the retrieval bias in surface reflectance for a series of test cases.\n    \n    The bias results from assuming a Lambertian surface model to invert radiance\n    measurements from a surface that is actually mildly anisotropic.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (E0, rho_true, theta_i, theta_v, delta_phi, alpha, beta)\n    # E0 is not needed for the bias calculation, but included for completeness.\n    test_cases = [\n        # Case A\n        (800, 0.2, 30, 20, 0, 0.1, 0.05),\n        # Case B\n        (800, 0.2, 30, 20, 0, 0, 0),\n        # Case C\n        (600, 0.3, 40, 75, 180, 0.1, 0.1),\n        # Case D\n        (900, 0.25, 50, 40, 90, 0.12, 0.2),\n        # Case E\n        (1000, 0.1, 80, 0, 0, 0.05, 0.05),\n        # Case F\n        (700, 0.22, 55, 65, 45, -0.05, 0.07),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        # E0 is case[0], which we can ignore as it cancels out in the bias derivation.\n        rho_true = case[1]\n        theta_i_deg = case[2]\n        theta_v_deg = case[3]\n        delta_phi_deg = case[4]\n        alpha = case[5]\n        beta = case[6]\n\n        # Convert angles from degrees to radians for trigonometric functions\n        theta_i_rad = np.deg2rad(theta_i_deg)\n        theta_v_rad = np.deg2rad(theta_v_deg)\n        delta_phi_rad = np.deg2rad(delta_phi_deg)\n\n        # Calculate the bias using the derived formula:\n        # Bias = rho_true * [alpha * cos(theta_i) * cos(theta_v) + \n        #                   beta * sin(theta_i) * sin(theta_v) * cos(delta_phi)]\n        term1 = alpha * np.cos(theta_i_rad) * np.cos(theta_v_rad)\n        term2 = beta * np.sin(theta_i_rad) * np.sin(theta_v_rad) * np.cos(delta_phi_rad)\n        \n        bias = rho_true * (term1 + term2)\n\n        # Round the result to six decimal places as required\n        results.append(round(bias, 6))\n\n    # Format the final output as a comma-separated list in square brackets\n    # The map(str,...) ensures correct string conversion for all float values.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "Just as assumptions about the directional properties of reflectance introduce bias, so do assumptions about the spectral characteristics of measurements. This exercise  shifts our focus to the thermal infrared, where the goal is often to retrieve surface temperature from emitted radiance. You will investigate and quantify the bias in retrieved temperature that arises when the radiance measured over a sensor's finite bandwidth is incorrectly treated as a monochromatic measurement, a fundamental concept in designing and interpreting data from thermal radiometers.",
            "id": "3839559",
            "problem": "You are to implement a program that quantifies the temperature retrieval bias caused by using a monochromatic approximation of spectral radiance for a sensor with finite bandwidth. The scenario is one of thermal remote sensing where a radiometer with a finite spectral response around a central wavelength measures the band-averaged spectral radiance of an emitting surface at a true physical temperature. The retrieval algorithm then incorrectly assumes a monochromatic Planck spectral radiance at the central wavelength to infer the temperature. Your task is to compute, for specified test cases, the bias induced by this approximation.\n\nBegin from the following context-appropriate fundamental base and core definitions:\n\n- The spectral radiance of an ideal blackbody per unit wavelength is given by Planck’s law,\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k T}\\right)-1},\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light in vacuum, $k$ is the Boltzmann constant, $\\lambda$ is the wavelength, and $T$ is the absolute temperature in Kelvin.\n\n- The emitted spectral radiance of a real surface is $L_{\\lambda}(T) = \\varepsilon(\\lambda)\\,B_{\\lambda}(T)$, where $\\varepsilon(\\lambda)$ is the spectral emissivity, assuming isotropic Lambertian emission and negligible reflected contributions in the thermal infrared.\n\n- The radiometer’s band-averaged spectral radiance over a finite bandwidth is\n$$\n\\overline{L}(T) = \\frac{\\int_{\\lambda_0 - \\Delta\\lambda/2}^{\\lambda_0 + \\Delta\\lambda/2} S(\\lambda)\\,\\varepsilon(\\lambda)\\,B_{\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_{\\lambda_0 - \\Delta\\lambda/2}^{\\lambda_0 + \\Delta\\lambda/2} S(\\lambda)\\,\\mathrm{d}\\lambda},\n$$\nwhere $S(\\lambda)$ is the spectral response. In this problem, $S(\\lambda)$ is a rectangular “top-hat” response centered at $\\lambda_0$ with width $\\Delta\\lambda$, so that $S(\\lambda)$ is constant and the normalized average reduces to the mean over the interval.\n\n- The monochromatic retrieval algorithm assumes\n$$\n\\overline{L}(T) \\approx \\varepsilon(\\lambda_0)\\,B_{\\lambda_0}(T_{\\mathrm{ret}}),\n$$\nand retrieves $T_{\\mathrm{ret}}$ by inverting the Planck function at $\\lambda_0$ using the value $\\overline{L}(T)$ divided by $\\varepsilon(\\lambda_0)$. The bias is then\n$$\n\\Delta T = T_{\\mathrm{ret}} - T_{\\mathrm{true}}.\n$$\n\nImplement the following, from first principles:\n\n1. For each test case, compute the band-averaged spectral radiance $\\overline{L}(T_{\\mathrm{true}})$ by numerically integrating $L_{\\lambda}(T_{\\mathrm{true}}) = \\varepsilon(\\lambda)\\,B_{\\lambda}(T_{\\mathrm{true}})$ over the interval $[\\lambda_0 - \\Delta\\lambda/2,\\,\\lambda_0 + \\Delta\\lambda/2]$ with a top-hat response and normalizing by the bandwidth $\\Delta\\lambda$.\n\n2. Derive $T_{\\mathrm{ret}}$ by solving $B_{\\lambda_0}(T_{\\mathrm{ret}}) = \\overline{L}(T_{\\mathrm{true}})/\\varepsilon(\\lambda_0)$ for $T_{\\mathrm{ret}}$ using the analytical inversion of Planck’s law.\n\n3. Compute the bias $\\Delta T = T_{\\mathrm{ret}} - T_{\\mathrm{true}}$.\n\nAll physical quantities must be handled in International System of Units: wavelength in meters, spectral radiance in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$, and temperature in Kelvin. Your program must produce the bias in Kelvin, rounded to six decimal places, for each case.\n\nUse the following test suite, designed to cover a general case, a near-monochromatic boundary, a wide bandwidth edge case, emissivity variation, and a high-temperature Wien-regime case. In all cases, use a rectangular top-hat spectral response as specified.\n\n- Case $1$ (general thermal infrared): $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 1\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 0.98$ (constant).\n\n- Case $2$ (near-monochromatic boundary): $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 0.01\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 0.98$ (constant).\n\n- Case $3$ (wide band edge): $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 3\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 1.0$ (constant).\n\n- Case $4$ (emissivity slope within band): $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 8\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 2\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = \\varepsilon_0 + s \\, \\frac{\\lambda - \\lambda_0}{\\Delta\\lambda/2}$ with $\\varepsilon_0 = 0.96$, $s = 0.02$, clipped to the interval $[0,1]$.\n\n- Case $5$ (mid-wave infrared, high temperature): $T_{\\mathrm{true}} = 1000\\,\\mathrm{K}$, $\\lambda_0 = 3.9\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 0.6\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 1.0$ (constant).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of cases $1$ through $5$, with each bias rounded to six decimal places as a float. For example, the output format must be like $[\\Delta T_1,\\Delta T_2,\\Delta T_3,\\Delta T_4,\\Delta T_5]$ where each $\\Delta T_i$ is in Kelvin. No other text should be printed.",
            "solution": "The problem statement is subjected to a rigorous validation process before any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Planck's Law:** The spectral radiance of an ideal blackbody is given by $B_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k T}\\right)-1}$, where $h$ is the Planck constant, $c$ is the speed of light, $k$ is the Boltzmann constant, $\\lambda$ is wavelength, and $T$ is absolute temperature.\n- **Emitted Spectral Radiance:** $L_{\\lambda}(T) = \\varepsilon(\\lambda)\\,B_{\\lambda}(T)$, where $\\varepsilon(\\lambda)$ is the spectral emissivity.\n- **Band-Averaged Spectral Radiance:** For a rectangular \"top-hat\" spectral response $S(\\lambda)$ of width $\\Delta\\lambda$ centered at $\\lambda_0$, this simplifies to the mean over the interval: $\\overline{L}(T) = \\frac{1}{\\Delta\\lambda} \\int_{\\lambda_0 - \\Delta\\lambda/2}^{\\lambda_0 + \\Delta\\lambda/2} \\varepsilon(\\lambda)\\,B_{\\lambda}(T)\\,\\mathrm{d}\\lambda$.\n- **Monochromatic Retrieval Assumption:** $\\overline{L}(T) \\approx \\varepsilon(\\lambda_0)\\,B_{\\lambda_0}(T_{\\mathrm{ret}})$. The retrieved temperature $T_{\\mathrm{ret}}$ is found by inverting this relation.\n- **Bias Definition:** $\\Delta T = T_{\\mathrm{ret}} - T_{\\mathrm{true}}$.\n- **Units:** All quantities must be in SI units. The output bias $\\Delta T$ is in Kelvin.\n- **Test Cases:**\n    - **Case 1:** $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 1\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 0.98$ (constant).\n    - **Case 2:** $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 0.01\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 0.98$ (constant).\n    - **Case 3:** $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 11\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 3\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 1.0$ (constant).\n    - **Case 4:** $T_{\\mathrm{true}} = 300\\,\\mathrm{K}$, $\\lambda_0 = 8\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 2\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = \\varepsilon_0 + s \\, \\frac{\\lambda - \\lambda_0}{\\Delta\\lambda/2}$ with $\\varepsilon_0 = 0.96$, $s = 0.02$, clipped to $[0,1]$.\n    - **Case 5:** $T_{\\mathrm{true}} = 1000\\,\\mathrm{K}$, $\\lambda_0 = 3.9\\,\\mu\\mathrm{m}$, $\\Delta\\lambda = 0.6\\,\\mu\\mathrm{m}$, $\\varepsilon(\\lambda) = 1.0$ (constant).\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly based on the fundamental principles of blackbody radiation (Planck's law) and radiometry. The scenario described—temperature retrieval bias due to finite sensor bandwidth—is a well-established and practically significant issue in thermal remote sensing. The physics is sound.\n- **Well-Posed:** All necessary equations, parameters, and conditions are provided. The procedure is explicitly defined: numerical integration to find the true band-averaged radiance, followed by analytical inversion of an approximate model to find the retrieved temperature. The problem admits a unique and stable solution for each test case.\n- **Objective:** The problem is stated using precise, formal language and quantitative definitions. There are no subjective or ambiguous terms.\n- **Other Flaws:**\n    - The problem is formalizable and directly relevant to the specified topic.\n    - The setup is complete and consistent.\n    - The parameters ($T$, $\\lambda_0$, $\\Delta\\lambda$) are physically realistic for environmental and industrial remote sensing applications.\n    - The problem structure is logical and leads to a meaningful result.\n    - The problem is a non-trivial application of physical principles, requiring both numerical and analytical steps.\n    - The results are scientifically verifiable through independent calculation.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is scientifically sound, well-posed, unambiguous, and computationally tractable. A solution will be provided.\n\n### Solution\nThe problem requires the calculation of the temperature bias $\\Delta T = T_{\\mathrm{ret}} - T_{\\mathrm{true}}$ that arises from approximating a band-averaged radiance measurement with a monochromatic model. The solution is derived from first principles as specified.\n\n**Theoretical Formulation**\n\nThe core of the problem involves the interplay between the true band-averaged radiance and the simplified monochromatic model used for temperature retrieval.\n\nFirst, we define the physical constants in SI units:\n- Planck constant: $h \\approx 6.62607015 \\times 10^{-34}\\,\\mathrm{J} \\cdot \\mathrm{s}$\n- Speed of light in vacuum: $c \\approx 2.99792458 \\times 10^{8}\\,\\mathrm{m} \\cdot \\mathrm{s}^{-1}$\n- Boltzmann constant: $k \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J} \\cdot \\mathrm{K}^{-1}$\n\nFor computational convenience, we define two composite constants, the first and second radiation constants, $C_1$ and $C_2$:\n- $C_1 = 2 h c^2$\n- $C_2 = h c / k$\n\nPlanck's law for spectral radiance $B_{\\lambda}(T)$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$) can then be written as:\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{C_1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1}\n$$\n\nThe procedure involves three main steps for each test case.\n\n**Step 1: Compute the True Band-Averaged Spectral Radiance $\\overline{L}(T_{\\mathrm{true}})**$\n\nThe sensor measures the radiance emitted by a surface at a true temperature $T_{\\mathrm{true}}$. This radiance, $L_{\\lambda}(T) = \\varepsilon(\\lambda) B_{\\lambda}(T)$, is averaged over the sensor's spectral band. For the specified top-hat spectral response, the band-averaged radiance is the mean value of $L_{\\lambda}(T_{\\mathrm{true}})$ over the interval $[\\lambda_1, \\lambda_2]$, where $\\lambda_1 = \\lambda_0 - \\Delta\\lambda/2$ and $\\lambda_2 = \\lambda_0 + \\Delta\\lambda/2$:\n$$\n\\overline{L}(T_{\\mathrm{true}}) = \\frac{1}{\\Delta\\lambda} \\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda) B_{\\lambda}(\\lambda, T_{\\mathrm{true}}) \\, \\mathrm{d}\\lambda\n$$\nThis integral does not have a general analytical solution and must be evaluated numerically.\n\n**Step 2: Compute the Retrieved Temperature $T_{\\mathrm{ret}}$**\n\nThe retrieval algorithm incorrectly assumes that the measured band-averaged radiance $\\overline{L}(T_{\\mathrm{true}})$ is equal to the monochromatic radiance at the central wavelength $\\lambda_0$, emitted by a body at the retrieved temperature $T_{\\mathrm{ret}}$ with emissivity $\\varepsilon(\\lambda_0)$:\n$$\n\\overline{L}(T_{\\mathrm{true}}) \\approx \\varepsilon(\\lambda_0) B_{\\lambda_0}(\\lambda_0, T_{\\mathrm{ret}})\n$$\nTo find $T_{\\mathrm{ret}}$, we first calculate the effective monochromatic radiance that the algorithm assumes it has measured for a blackbody:\n$$\nL_{\\mathrm{mono}} = \\frac{\\overline{L}(T_{\\mathrm{true}})}{\\varepsilon(\\lambda_0)}\n$$\nWe then solve the equation $L_{\\mathrm{mono}} = B_{\\lambda_0}(\\lambda_0, T_{\\mathrm{ret}})$ for $T_{\\mathrm{ret}}$. This involves inverting Planck's law:\n$$\nL_{\\mathrm{mono}} = \\frac{C_1}{\\lambda_0^5} \\frac{1}{\\exp\\left(\\frac{C_2}{\\lambda_0 T_{\\mathrm{ret}}}\\right) - 1}\n$$\nRearranging for $T_{\\mathrm{ret}}$ yields the analytical solution:\n$$\n\\exp\\left(\\frac{C_2}{\\lambda_0 T_{\\mathrm{ret}}}\\right) = \\frac{C_1}{\\lambda_0^5 L_{\\mathrm{mono}}} + 1\n$$\n$$\n\\frac{C_2}{\\lambda_0 T_{\\mathrm{ret}}} = \\ln\\left(\\frac{C_1}{\\lambda_0^5 L_{\\mathrm{mono}}} + 1\\right)\n$$\n$$\nT_{\\mathrm{ret}} = \\frac{C_2}{\\lambda_0} \\left[ \\ln\\left(\\frac{C_1}{\\lambda_0^5 L_{\\mathrm{mono}}} + 1\\right) \\right]^{-1}\n$$\n\n**Step 3: Compute the Bias $\\Delta T$**\n\nThe final step is to compute the bias as the difference between the retrieved and true temperatures:\n$$\n\\Delta T = T_{\\mathrm{ret}} - T_{\\mathrm{true}}\n$$\n\nThis three-step procedure will be implemented for each of the five test cases. The emissivity function $\\varepsilon(\\lambda)$ will be defined according to each case's specification, noting that for Case $4$, $\\varepsilon(\\lambda)$ is a linear function of $\\lambda$ and its value at the central wavelength $\\lambda_0$ is simply $\\varepsilon(\\lambda_0) = \\varepsilon_0 = 0.96$. All calculations will be performed in SI units, with wavelengths converted from micrometers to meters. The final result for each case will be the bias $\\Delta T$ in Kelvin, rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the temperature retrieval bias caused by using a monochromatic\n    approximation for a sensor with a finite bandwidth.\n    \"\"\"\n\n    # Physical constants from scipy.constants in SI units\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Derived radiation constants\n    C1 = 2 * h * c**2  # First radiation constant (W.m^2)\n    C2 = h * c / k     # Second radiation constant (m.K)\n\n    def planck_radiance(wavelength, temp):\n        \"\"\"\n        Calculates spectral radiance using Planck's law.\n        :param wavelength: Wavelength in meters.\n        :param temp: Temperature in Kelvin.\n        :return: Spectral radiance in W.m^-2.sr^-1.m^-1.\n        \"\"\"\n        # Ensure inputs are numpy arrays for vectorization\n        wavelength = np.asarray(wavelength)\n        temp = np.asarray(temp)\n        \n        # Avoid division by zero or overflow\n        # The exponential term is large, so exp(...) - 1 is approx exp(...)\n        # We handle this by checking if the argument is large.\n        arg = C2 / (wavelength * temp)\n        # For large arguments, exp(arg) is very large, so 1/exp(arg) is near zero.\n        # np.exp handles large arguments by returning inf, so we don't need special handling here.\n        radiance = (C1 / wavelength**5) / (np.exp(arg) - 1.0)\n        return radiance\n\n    def invert_planck(radiance, wavelength):\n        \"\"\"\n        Inverts Planck's law to find temperature.\n        :param radiance: Spectral radiance in W.m^-2.sr^-1.m^-1.\n        :param wavelength: Wavelength in meters.\n        :return: Temperature in Kelvin.\n        \"\"\"\n        # T_ret = (C2 / lambda_0) / ln( (C1 / (lambda_0^5 * L_mono)) + 1 )\n        temp = C2 / (wavelength * np.log(C1 / (wavelength**5 * radiance) + 1.0))\n        return temp\n\n    # Define test cases as a list of dictionaries for clarity\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"T_true\": 300.0,\n            \"lambda_0_um\": 11.0,\n            \"delta_lambda_um\": 1.0,\n            \"emissivity_func\": lambda l, l0, dl: 0.98,\n            \"emissivity_at_lambda0\": 0.98,\n        },\n        {\n            \"name\": \"Case 2\",\n            \"T_true\": 300.0,\n            \"lambda_0_um\": 11.0,\n            \"delta_lambda_um\": 0.01,\n            \"emissivity_func\": lambda l, l0, dl: 0.98,\n            \"emissivity_at_lambda0\": 0.98,\n        },\n        {\n            \"name\": \"Case 3\",\n            \"T_true\": 300.0,\n            \"lambda_0_um\": 11.0,\n            \"delta_lambda_um\": 3.0,\n            \"emissivity_func\": lambda l, l0, dl: 1.0,\n            \"emissivity_at_lambda0\": 1.0,\n        },\n        {\n            \"name\": \"Case 4\",\n            \"T_true\": 300.0,\n            \"lambda_0_um\": 8.0,\n            \"delta_lambda_um\": 2.0,\n            \"emissivity_func\": lambda l, l0, dl: np.clip(0.96 + 0.02 * (l - l0) / (dl / 2), 0, 1),\n            \"emissivity_at_lambda0\": 0.96, # At l = l0, the second term is 0\n        },\n        {\n            \"name\": \"Case 5\",\n            \"T_true\": 1000.0,\n            \"lambda_0_um\": 3.9,\n            \"delta_lambda_um\": 0.6,\n            \"emissivity_func\": lambda l, l0, dl: 1.0,\n            \"emissivity_at_lambda0\": 1.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters and convert to SI units\n        T_true = case[\"T_true\"]\n        lambda_0 = case[\"lambda_0_um\"] * 1e-6\n        delta_lambda = case[\"delta_lambda_um\"] * 1e-6\n\n        # Define integration limits\n        lambda_1 = lambda_0 - delta_lambda / 2.0\n        lambda_2 = lambda_0 + delta_lambda / 2.0\n\n        # Define the integrand: L_lambda(T_true) = eps(lambda) * B_lambda(T_true)\n        def integrand(wavelength):\n            eps = case[\"emissivity_func\"](wavelength, lambda_0, delta_lambda)\n            B = planck_radiance(wavelength, T_true)\n            return eps * B\n\n        # Step 1: Numerically integrate to find band-integrated radiance\n        # quad returns a tuple (result, error_estimate)\n        integrated_radiance, _ = integrate.quad(integrand, lambda_1, lambda_2)\n        \n        # Calculate band-averaged radiance\n        L_bar = integrated_radiance / delta_lambda\n\n        # Step 2: Compute retrieved temperature\n        # First, find the monochromatic-equivalent blackbody radiance\n        eps_lambda0 = case[\"emissivity_at_lambda0\"]\n        L_mono = L_bar / eps_lambda0\n        \n        # Invert Planck's law to get the retrieved temperature\n        T_ret = invert_planck(L_mono, lambda_0)\n\n        # Step 3: Compute the bias\n        delta_T = T_ret - T_true\n        \n        # Round to 6 decimal places and store\n        results.append(round(delta_T, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}