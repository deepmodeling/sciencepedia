{
    "hands_on_practices": [
        {
            "introduction": "任何成像系统的基础是其空间分辨率。这个练习将带你从基本几何光学的角度出发，推导地面采样距离（GSD）—— 这是连接传感器固有特性（瞬时视场 IFOV）和其运行高度的关键参数。通过这个练习，你将掌握如何从第一性原理分析无源和有源传感器的空间分辨率，并理解小角度近似在遥感计算中的应用和合理性。",
            "id": "3832944",
            "problem": "一个星载成像传感器在天底点工作，通过将单个探测器单元的角接收度映射到地球表面来形成图像。瞬时视场 (IFOV) 定义为从传感器入射光瞳看去，单个探测器单元所对应的全角张角，单位为弧度。地面采样距离 (GSD) 定义为该单个探测器单元对应的地面投影足迹的线性尺寸，该尺寸在传感器正下方的局部平坦切平面上测量。这种几何映射关系适用于被动和主动传感范式，因为它源于几何光学和观测几何，与照明是自然的还是由仪器发射的无关。\n\n从几何光学和IFOV作为具有全角宽度的窄视锥的定义出发，推导天底点GSD的表达式，该表达式用卫星在局部平坦切平面上方的高度 $h$ 和IFOV表示。仅在可从第一性原理证明其合理性的情况下，才可使用小角度近似。然后，计算一颗高度 $h=500\\,\\mathrm{km}$、天底点IFOV $=30\\,\\mathrm{\\mu rad}$ 的卫星的GSD。以米为单位表示最终的GSD，并将答案四舍五入到三位有效数字。",
            "solution": "根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n- 一个星载成像传感器在天底点工作。\n- 瞬时视场 (IFOV) 是单个探测器单元的全角张角，单位为弧度。\n- 地面采样距离 (GSD) 是单个探测器单元在天底点的局部平坦切平面上的地面投影足迹的线性尺寸。\n- 任务1：推导天底点GSD关于卫星高度 $h$ 和IFOV的表达式。\n- 任务2：证明使用小角度近似的合理性。\n- 任务3：计算高度 $h=500\\,\\mathrm{km}$ 和 IFOV $=30\\,\\mathrm{\\mu rad}$ 时的GSD。\n- 任务4：以米为单位表示最终的GSD，并四舍五入到三位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于应用于遥感的几何光学和三角学的基本原理，这在科学上是合理的。量 $h$、IFOV 和 GSD 是该领域的标准参数。\n- **适定性：** 问题提供了所有必要的信息和明确的指令，以推导公式并计算数值。存在唯一解。\n- **客观性：** 问题使用精确的技术语言陈述，没有歧义或主观性。\n- **结论：** 问题没有科学缺陷、不完整、矛盾或其他使其无效的特征。这是一个在应用物理和工程领域中有效且适定的问题。\n\n### 第3步：结论与行动\n问题有效。现在开始推导解答。\n\n### GSD表达式的推导\n设卫星位于点 $S$，其高度为 $h$，下方是代表地球表面的局部平坦切平面。卫星正下方的地表点是天底点，我们称之为 $N$。从 $S$ 到 $N$ 的距离是 $h$。\n\nIFOV是单个探测器单元视锥的全角宽度。我们用角度 $\\theta$ 表示IFOV。由于传感器在天底点工作，高度线段 $SN$ 是这个视锥的轴线，并垂直于地平面。\n\n视锥与地平面相交，形成一个足迹。GSD定义为该足迹的线性尺寸（直径）。我们用 $D_{GSD}$ 表示GSD。\n\n我们可以使用直角三角形来分析这个几何关系。考虑通过视锥轴线的横截面。这形成一个以卫星 $S$ 为顶点、以地面上的GSD为底边的等腰三角形。该三角形的高是高度 $h$。顶点 $S$ 处的角是IFOV，即 $\\theta$。\n\n如果我们将这个等腰三角形沿其对称轴（高度线 $SN$）平分，我们得到两个相同的直角三角形。每个直角三角形具有：\n- 一个顶点在卫星 $S$ 处。\n- 高度等于卫星高度 $h$。\n- 底边长度为 $\\frac{D_{GSD}}{2}$。\n- 顶点 $S$ 处的角是IFOV的一半，即 $\\frac{\\theta}{2}$。\n\n根据直角三角形中正切函数的定义，我们有：\n$$\n\\tan\\left(\\frac{\\theta}{2}\\right) = \\frac{\\text{opposite}}{\\text{adjacent}} = \\frac{D_{GSD}/2}{h}\n$$\n解此方程求GSD，$D_{GSD}$，我们得到精确的几何表达式：\n$$\nD_{GSD} = 2h \\tan\\left(\\frac{\\theta}{2}\\right)\n$$\n其中 $\\theta$ 代表IFOV。\n\n### 小角度近似的合理性证明\n题目要求计算IFOV为 $\\theta = 30\\,\\mathrm{\\mu rad}$ 时的GSD。在标准国际单位制中，即 $\\theta = 30 \\times 10^{-6}\\,\\mathrm{rad}$。正切函数的参数是 $\\frac{\\theta}{2} = 15 \\times 10^{-6}\\,\\mathrm{rad}$。\n\n这个角度非常小。对于一个以弧度表示的角度 $x$，当 $|x| \\ll 1$ 时，$\\tan(x)$ 的泰勒级数展开为：\n$$\n\\tan(x) = x + \\frac{x^3}{3} + \\frac{2x^5}{15} + O(x^7)\n$$\n小角度近似即只保留首项，即 $\\tan(x) \\approx x$。\n\n为了从第一性原理证明其合理性，我们可以评估级数中下一项的大小以量化误差。设 $x = \\frac{\\theta}{2} = 15 \\times 10^{-6}$。\n第一项是 $x = 15 \\times 10^{-6}$。\n第二项是 $\\frac{x^3}{3} = \\frac{(15 \\times 10^{-6})^3}{3} = \\frac{3375 \\times 10^{-18}}{3} = 1125 \\times 10^{-18} = 1.125 \\times 10^{-15}$。\n\n使用近似 $\\tan(x) \\approx x$ 引入的相对误差约等于第二项与第一项的比值：\n$$\n\\text{Relative Error} \\approx \\frac{x^3/3}{x} = \\frac{x^2}{3} = \\frac{(15 \\times 10^{-6})^2}{3} = \\frac{225 \\times 10^{-12}}{3} = 75 \\times 10^{-12}\n$$\n这个相对误差在 $10^{-10}$ 的量级，远低于遥感应用中的任何实际精度要求，并且比四舍五入到三位有效数字的要求小几个数量级。因此，使用小角度近似是完全合理的。\n\n将近似 $\\tan(\\frac{\\theta}{2}) \\approx \\frac{\\theta}{2}$ 应用于精确的GSD公式，我们得到：\n$$\nD_{GSD} \\approx 2h \\left(\\frac{\\theta}{2}\\right) = h \\theta\n$$\n因此，对于小角度，GSD就是高度与IFOV（以弧度为单位）的乘积。\n\n### GSD的计算\n我们已知：\n- 高度, $h = 500\\,\\mathrm{km}$\n- IFOV, $\\theta = 30\\,\\mathrm{\\mu rad}$\n\n首先，我们必须将这些值转换为一组一致的单位（米和弧度）。\n以米为单位的高度是：\n$$\nh = 500\\,\\mathrm{km} = 500 \\times 10^3\\,\\mathrm{m} = 5 \\times 10^5\\,\\mathrm{m}\n$$\n以弧度为单位的IFOV是：\n$$\n\\theta = 30\\,\\mathrm{\\mu rad} = 30 \\times 10^{-6}\\,\\mathrm{rad} = 3 \\times 10^{-5}\\,\\mathrm{rad}\n$$\n现在，我们可以使用简化公式计算GSD：\n$$\nD_{GSD} = h \\theta = (5 \\times 10^5\\,\\mathrm{m}) \\times (3 \\times 10^{-5}\\,\\mathrm{rad})\n$$\n弧度单位是无量纲的，所以结果将以米为单位。\n$$\nD_{GSD} = (5 \\times 3) \\times (10^5 \\times 10^{-5})\\,\\mathrm{m} = 15 \\times 10^0\\,\\mathrm{m} = 15\\,\\mathrm{m}\n$$\n题目要求最终答案四舍五入到三位有效数字。计算出的值 $15\\,\\mathrm{m}$可以表示为 $15.0\\,\\mathrm{m}$ 以满足此要求。",
            "answer": "$$\n\\boxed{15.0}\n$$"
        },
        {
            "introduction": "辐射在穿过大气时会发生衰减，这是所有遥感系统都必须面对的物理过程。本练习将引导你从辐射传输的微分形式出发，推导描述这一过程的比尔-朗伯定律。特别地，我们将探讨主动传感（如激光雷达 LiDAR）的一个核心特征：信号必须完成一次往返传播，因此会经历双程衰减。掌握这个概念对于理解主动遥感系统的信号强度、探测范围和数据校正至关重要。",
            "id": "3832940",
            "problem": "一套工作波长为 $\\lambda=1064\\,\\mathrm{nm}$ 的机载光探测和测距 (LiDAR; Light Detection and Ranging) 系统，在水平均匀的大气中发射单色准直脉冲。假设在相关路径上，大气可以用一个恒定的单色消光系数 $\\beta=0.002\\,\\mathrm{m^{-1}}$ 来很好地表示（消光是吸收和散射的总和），在探测波长上没有路径内发射，并且除了消光外没有折射或几何损失。LiDAR 平台所处的高度使得目标沿视线方向位于斜距 $R=1\\,\\mathrm{km}$ 处。\n\n从均匀衰减介质中准直光束的标量、无源辐射传输表述出发——即光束辐照度相对于路径长度的变化率与局部辐照度成正比——推导单向视线透过率作为路径长度的函数。\n\n然后，利用 LiDAR 的主动传感几何结构，确定双向大气透过率的适当表达式，该表达式决定了发射脉冲在出射和返回路径后幸存下来并对测量的后向散射有贡献的比例。\n\n最后，根据给定的 $\\lambda$、$\\beta$ 和 $R$ 计算双向大气透过率。将最终数值四舍五入到四位有效数字。将透过率表示为无单位的无量纲小数。",
            "solution": "该问题要求推导 LiDAR 系统的双向大气透过率，并根据所提供的参数进行数值计算。该过程从验证问题陈述开始。\n\n### 问题验证\n**步骤 1：提取给定条件**\n- LiDAR 波长：$\\lambda = 1064 \\, \\mathrm{nm}$\n- 大气的单色消光系数：$\\beta = 0.002 \\, \\mathrm{m}^{-1}$\n- 到目标的斜距：$R = 1 \\, \\mathrm{km}$\n- 基本原理：光束辐照度相对于路径长度的变化率与局部辐照度成正比。这定义了无源均匀介质中的衰减。\n- 假设大气是水平均匀的，具有恒定的消光系数。\n- 不考虑其他损失源（路径内发射、折射/几何损失）。\n\n**步骤 2：使用提取的给定条件进行验证**\n- **科学上成立：** 该问题基于 Beer-Lambert-Bouguer 定律，这是描述光在介质中衰减的辐射传输基本原理。提供的波长值（一种常见的 Nd:YAG 激光器）、消光系数值（对应于有雾霾的大气）和距离值在物理上是现实的。\n- **适定性：** 问题陈述清晰。它提供了一个起始原理（对微分方程的描述），要求进行推导，然后进行计算。为得到唯一解提供了所有必要的数据。\n- **客观性：** 语言是定量的、精确的，没有任何主观或模棱两可的术语。\n- **完整性和一致性：** 问题是自洽的。提供的恒定消光系数 $\\beta$ 与均匀大气的假设一致。波长 $\\lambda$ 提供了背景信息，但计算本身并不需要它，因为它的影响已经包含在给定的 $\\beta$ 值中。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它科学合理、适定且内部一致。我将继续进行求解。\n\n### 推导与计算\n\n**第 1 部分：单向透过率的推导**\n\n问题陈述，对于均匀衰减介质中的准直光束，光束辐照度相对于路径长度的变化率与局部辐照度成正比。设 $I(r)$ 为光束在其离源路径上距离 $r$ 处的辐照度。辐照度随路径长度的变化率为 $\\frac{dI}{dr}$。由于消光导致辐照度损失，因此该变化为负。比例常数是消光系数 $\\beta$。该关系可形式化为以下一阶线性常微分方程：\n$$\n\\frac{dI(r)}{dr} = -\\beta I(r)\n$$\n为解此方程，我们可以使用分离变量法：\n$$\n\\frac{dI}{I} = -\\beta dr\n$$\n我们将此方程从路径长度 $r=0$ 处的源积分到任意路径长度 $r$。设源处的辐照度为 $I(0) = I_0$。\n$$\n\\int_{I_0}^{I(r)} \\frac{dI'}{I'} = \\int_{0}^{r} -\\beta dr'\n$$\n积分得出：\n$$\n[\\ln(I')]_{I_0}^{I(r)} = - \\beta [r']_{0}^{r}\n$$\n$$\n\\ln(I(r)) - \\ln(I_0) = -\\beta r\n$$\n$$\n\\ln\\left(\\frac{I(r)}{I_0}\\right) = -\\beta r\n$$\n通过对两边取指数，我们求解辐照度 $I(r)$:\n$$\n\\frac{I(r)}{I_0} = \\exp(-\\beta r)\n$$\n单向视线透过率，记为 $\\tau(r)$，定义为穿过长度为 $r$ 的路径后剩余的初始辐照度的分数。因此：\n$$\n\\tau(r) = \\frac{I(r)}{I_0} = \\exp(-\\beta r)\n$$\n这是均匀介质的 Beer-Lambert 定律。\n\n**第 2 部分：双向透过率的表达式**\n\nLiDAR 系统是一种主动传感器。它向目标发射光脉冲，并测量反向散射回来的信号。总路径包括两个部分：\n1. 从 LiDAR 仪器到目标的出射路径，长度为 $R$。\n2. 从目标返回到 LiDAR 仪器的入射路径，长度也为 $R$。\n\n出射路径的透过率 $\\tau_{\\text{out}}$ 是距离 $R$ 上的单向透过率：\n$$\n\\tau_{\\text{out}} = \\tau(R) = \\exp(-\\beta R)\n$$\n假设大气属性恒定，入射路径的透过率 $\\tau_{\\text{in}}$ 是相同的：\n$$\n\\tau_{\\text{in}} = \\tau(R) = \\exp(-\\beta R)\n$$\n双向大气透过率 $\\tau_{2\\text{-way}}$ 是初始发射的脉冲能量在出射和入射两个行程中幸存下来可被探测到的分数。它是各路径段透过率的乘积：\n$$\n\\tau_{2\\text{-way}} = \\tau_{\\text{out}} \\times \\tau_{\\text{in}}\n$$\n$$\n\\tau_{2\\text{-way}} = \\exp(-\\beta R) \\times \\exp(-\\beta R) = \\exp(-2\\beta R)\n$$\n这就是所要求的双向大气透过率的表达式。\n\n**第 3 部分：数值计算**\n\n给定以下数值：\n- 消光系数：$\\beta = 0.002 \\, \\mathrm{m}^{-1}$\n- 斜距：$R = 1 \\, \\mathrm{km}$\n\n首先，我们必须确保单位一致。消光系数的单位是米分之一，所以距离必须转换为米。\n$$\nR = 1 \\, \\mathrm{km} = 1000 \\, \\mathrm{m}\n$$\n现在，我们可以将这些值代入双向透过率的表达式中：\n$$\n\\tau_{2\\text{-way}} = \\exp(-2 \\beta R) = \\exp(-2 \\times 0.002 \\, \\mathrm{m}^{-1} \\times 1000 \\, \\mathrm{m})\n$$\n指数的参数是一个无量纲的量：\n$$\n-2 \\times 0.002 \\times 1000 = -2 \\times 2 = -4\n$$\n所以，双向透过率为：\n$$\n\\tau_{2\\text{-way}} = \\exp(-4)\n$$\n我们现在计算这个值，并四舍五入到四位有效数字：\n$$\n\\exp(-4) \\approx 0.0183156388...\n$$\n四舍五入到四位有效数字，我们看第五位有效数字。前四位是 $1$、$8$、$3$、$1$。第五位是 $5$，所以我们将最后一位数字向上取整。\n$$\n\\tau_{2\\text{-way}} \\approx 0.01832\n$$",
            "answer": "$$\\boxed{0.01832}$$"
        },
        {
            "introduction": "在理解了遥感的几何和辐射基本原理之后，一个更深层次的问题是：我们的测量究竟能提供多少关于目标物理状态的独立信息？本练习将你带入最优估计和反演理论的核心，介绍一个关键的诊断工具——信号自由度（DFS）。通过在一个简化的线性框架下推导平均核矩阵并计算其迹，你将学会如何定量评估一个遥感系统（在此案例中为一个无源和有源联合系统）从测量中提取信息的能力。",
            "id": "3832914",
            "problem": "考虑一个在线性化最优估计框架下的联合被动-主动大气反演问题。设真实状态向量为 $x_{\\mathrm{true}} \\in \\mathbb{R}^{2}$，先验（背景）状态为 $x_{a} \\in \\mathbb{R}^{2}$，测量向量为 $y \\in \\mathbb{R}^{2}$。正向模型在 $x_{a}$ 附近线性化，测量值来自于被动光谱仪和主动激光雷达（LiDAR）通道的组合，因此 $y$ 可以建模为\n$$\ny = \\mathbf{K}\\,x_{\\mathrm{true}} + \\epsilon,\n$$\n其中 $\\mathbf{K} \\in \\mathbb{R}^{2 \\times 2}$ 是雅可比（灵敏度）矩阵，$\\epsilon \\sim \\mathcal{N}(0,\\mathbf{S}_{\\epsilon})$ 是加性高斯测量噪声。$x_{\\mathrm{true}}$ 的先验分布是高斯分布，$x_{\\mathrm{true}} \\sim \\mathcal{N}(x_{a},\\mathbf{S}_{a})$，其先验协方差为 $\\mathbf{S}_{a}$。反演结果 $\\hat{x}$ 被定义为最大后验（MAP）估计量，它通过最小化由高斯似然和高斯先验的乘积产生的标准二次贝叶斯代价函数得到。\n\n从这些基本定义（线性正向模型、高斯噪声、高斯先验和 MAP 估计量定义）出发，推导从真实状态 $x_{\\mathrm{true}}$ 到反演结果期望值 $\\hat{x}$ 的线性映射，确定相应的平均核矩阵 $\\mathbf{A}$，并计算信号自由度（DFS），其定义为平均核的迹，$\\mathrm{DFS} = \\mathrm{trace}(\\mathbf{A})$。\n\n使用以下具体矩阵：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n1  0 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}, \\quad\n\\mathbf{S}_{\\epsilon} = \\begin{pmatrix}\n0.04  0 \\\\\n0  0.09\n\\end{pmatrix}, \\quad\n\\mathbf{S}_{a} = \\begin{pmatrix}\n0.16  0 \\\\\n0  0.04\n\\end{pmatrix}.\n$$\n计算此情况下的 DFS。将您的最终答案表示为一个无量纲标量，并四舍五入到五位有效数字。",
            "solution": "用户希望我在最优估计框架的背景下解决一个大气反演问题。\n\n以下是我的计划：\n1.  **验证问题**：我将根据我的验证标准仔细检查问题陈述。\n    *   **步骤1：提取已知条件**：我将列出所有提供的定义和矩阵。\n        *   真实状态向量：$x_{\\mathrm{true}} \\in \\mathbb{R}^{2}$\n        *   先验状态向量：$x_{a} \\in \\mathbb{R}^{2}$\n        *   测量向量：$y \\in \\mathbb{R}^{2}$\n        *   线性化正向模型：$y = \\mathbf{K}\\,x_{\\mathrm{true}} + \\epsilon$\n        *   雅可比矩阵：$\\mathbf{K} = \\begin{pmatrix} 1  0 \\\\ \\frac{1}{2}  1 \\end{pmatrix}$\n        *   测量噪声分布：$\\epsilon \\sim \\mathcal{N}(0,\\mathbf{S}_{\\epsilon})$\n        *   测量误差协方差矩阵：$\\mathbf{S}_{\\epsilon} = \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}$\n        *   真实状态的先验分布：$x_{\\mathrm{true}} \\sim \\mathcal{N}(x_{a},\\mathbf{S}_{a})$\n        *   先验误差协方差矩阵：$\\mathbf{S}_{a} = \\begin{pmatrix} 0.16  0 \\\\ 0  0.04 \\end{pmatrix}$\n        *   反演结果 $\\hat{x}$ 是最大后验（MAP）估计量。\n        *   目标：推导从真实状态 $x_{\\mathrm{true}}$ 到反演结果期望 $E[\\hat{x}]$ 的线性映射，确定平均核矩阵 $\\mathbf{A}$，并计算信号自由度（DFS），其定义为 $\\mathrm{DFS} = \\mathrm{trace}(\\mathbf{A})$。DFS 的最终结果应四舍五入到五位有效数字。\n\n    *   **步骤2：使用提取的已知条件进行验证**：\n        *   **科学依据**：该问题是在标准的线性高斯反演问题框架内提出的，通常称为最优估计或吉洪诺夫正则化，这是地球物理数据同化和遥感反演的基石。所有概念，包括 MAP 估计量、平均核矩阵和信号自由度，都是完善且科学合理的。\n        *   **适定性**：该问题是适定的。它提供了所有必要的信息（矩阵、分布和定义），以唯一确定平均核和 DFS。给定的协方差矩阵 $\\mathbf{S}_{a}$ 和 $\\mathbf{S}_{\\epsilon}$ 是对角矩阵，且对角线元素为正，这确保了它们是正定对称矩阵，因此是可逆的，这对于求解是必需的。\n        *   **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n    *   **步骤3：结论与行动**：该问题被认定为有效。将提供完整解答。\n\n目标是推导平均核矩阵 $\\mathbf{A}$ 并计算其迹，即信号自由度（DFS）。反演结果 $\\hat{x}$ 是最大后验（MAP）估计量，它最大化了后验概率密度函数 $P(x|y)$。根据贝叶斯定理，$P(x|y) \\propto P(y|x)P(x)$。最大化后验概率等价于最小化其负对数。\n\n似然函数 $P(y|x)$ 从测量模型 $y = \\mathbf{K}x + \\epsilon$ 推导而来，其中 $\\epsilon \\sim \\mathcal{N}(0, \\mathbf{S}_{\\epsilon})$。这意味着 $y|x \\sim \\mathcal{N}(\\mathbf{K}x, \\mathbf{S}_{\\epsilon})$，所以似然函数为：\n$$\nP(y|x) \\propto \\exp\\left(-\\frac{1}{2}(y-\\mathbf{K}x)^T \\mathbf{S}_{\\epsilon}^{-1}(y-\\mathbf{K}x)\\right)\n$$\n先验分布 $P(x)$ 给出为 $x \\sim \\mathcal{N}(x_a, \\mathbf{S}_a)$：\n$$\nP(x) \\propto \\exp\\left(-\\frac{1}{2}(x-x_a)^T \\mathbf{S}_{a}^{-1}(x-x_a)\\right)\n$$\nMAP 估计 $\\hat{x}$ 最小化了二次代价函数 $J(x)$，该函数是指数项的和：\n$$\nJ(x) = (y-\\mathbf{K}x)^T \\mathbf{S}_{\\epsilon}^{-1}(y-\\mathbf{K}x) + (x-x_a)^T \\mathbf{S}_{a}^{-1}(x-x_a)\n$$\n为了找到最小值，我们计算 $J(x)$ 相对于 $x$ 的梯度并将其设为零。\n$$\n\\nabla_x J(x) = -2\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}(y-\\mathbf{K}x) + 2\\mathbf{S}_{a}^{-1}(x-x_a) = 0\n$$\n重新整理各项以求解 $x$（在最小值处即为 $\\hat{x}$）：\n$$\n\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}y - \\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K}\\hat{x} + \\mathbf{S}_{a}^{-1}\\hat{x} - \\mathbf{S}_{a}^{-1}x_a = 0\n$$\n$$\n(\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1})\\hat{x} = \\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}y + \\mathbf{S}_{a}^{-1}x_a\n$$\n因此，反演结果 $\\hat{x}$ 为：\n$$\n\\hat{x} = (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1})^{-1} (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}y + \\mathbf{S}_{a}^{-1}x_a)\n$$\n为了找到从真实状态 $x_{\\mathrm{true}}$ 到反演结果期望 $E[\\hat{x}]$ 的线性映射，我们将正向模型 $y = \\mathbf{K}x_{\\mathrm{true}} + \\epsilon$ 代入 $\\hat{x}$ 的表达式中：\n$$\n\\hat{x} = (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1})^{-1} (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}(\\mathbf{K}x_{\\mathrm{true}} + \\epsilon) + \\mathbf{S}_{a}^{-1}x_a)\n$$\n对测量噪声 $\\epsilon$ 取期望，并利用 $E[\\epsilon] = 0$ 的事实：\n$$\nE[\\hat{x}] = (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1})^{-1} (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K}x_{\\mathrm{true}} + \\mathbf{S}_{a}^{-1}x_a)\n$$\n这个方程可以写成 $E[\\hat{x}] = \\mathbf{A}x_{\\mathrm{true}} + (\\mathbf{I}-\\mathbf{A})x_a$ 的形式，其中 $\\mathbf{I}$ 是单位矩阵。乘以 $x_{\\mathrm{true}}$ 的矩阵 $\\mathbf{A}$ 就是平均核矩阵：\n$$\n\\mathbf{A} = (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1})^{-1} \\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K}\n$$\n信号自由度由 $\\mathrm{DFS} = \\mathrm{trace}(\\mathbf{A})$ 给出。我们现在使用提供的矩阵进行数值计算。\n\n给定的矩阵是：\n$$\n\\mathbf{K} = \\begin{pmatrix} 1  0 \\\\ \\frac{1}{2}  1 \\end{pmatrix}, \\quad \\mathbf{S}_{\\epsilon} = \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}, \\quad \\mathbf{S}_{a} = \\begin{pmatrix} 0.16  0 \\\\ 0  0.04 \\end{pmatrix}\n$$\n首先，我们计算协方差矩阵的逆。由于它们是对角矩阵，其逆矩阵可以通过取每个对角元素的倒数得到：\n$$\n\\mathbf{S}_{\\epsilon}^{-1} = \\begin{pmatrix} \\frac{1}{0.04}  0 \\\\ 0  \\frac{1}{0.09} \\end{pmatrix} = \\begin{pmatrix} 25  0 \\\\ 0  \\frac{100}{9} \\end{pmatrix}\n$$\n$$\n\\mathbf{S}_{a}^{-1} = \\begin{pmatrix} \\frac{1}{0.16}  0 \\\\ 0  \\frac{1}{0.04} \\end{pmatrix} = \\begin{pmatrix} 6.25  0 \\\\ 0  25 \\end{pmatrix} = \\begin{pmatrix} \\frac{25}{4}  0 \\\\ 0  25 \\end{pmatrix}\n$$\n接下来，我们计算项 $\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K}$：\n$$\n\\mathbf{K}^T = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ 0  1 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1} = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 25  0 \\\\ 0  \\frac{100}{9} \\end{pmatrix} = \\begin{pmatrix} 25  \\frac{50}{9} \\\\ 0  \\frac{100}{9} \\end{pmatrix}\n$$\n$$\n\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} = \\begin{pmatrix} 25  \\frac{50}{9} \\\\ 0  \\frac{100}{9} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 25 + \\frac{25}{9}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{250}{9}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100}{9} \\end{pmatrix}\n$$\n现在，我们计算待求逆的矩阵，$\\mathbf{H} = \\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K} + \\mathbf{S}_{a}^{-1}$：\n$$\n\\mathbf{H} = \\begin{pmatrix} \\frac{250}{9}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100}{9} \\end{pmatrix} + \\begin{pmatrix} \\frac{25}{4}  0 \\\\ 0  25 \\end{pmatrix} = \\begin{pmatrix} \\frac{250}{9} + \\frac{25}{4}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100}{9} + 25 \\end{pmatrix} = \\begin{pmatrix} \\frac{1000+225}{36}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100+225}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{1225}{36}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{325}{9} \\end{pmatrix}\n$$\n平均核是 $\\mathbf{A} = \\mathbf{H}^{-1} (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K})$。另一种计算上等价的形式是 $\\mathbf{A} = \\mathbf{I} - \\mathbf{H}^{-1}\\mathbf{S}_a^{-1}$。我们先计算 $\\mathbf{H}^{-1}$。\n$\\mathbf{H}$ 的行列式是：\n$$\n\\det(\\mathbf{H}) = \\left(\\frac{1225}{36}\\right)\\left(\\frac{325}{9}\\right) - \\left(\\frac{50}{9}\\right)^2 = \\frac{398125}{324} - \\frac{2500}{81} = \\frac{398125 - 10000}{324} = \\frac{388125}{324}\n$$\n这变得复杂了。我们使用另一种数值表示法。\n$\\mathbf{H} = \\frac{25}{36} \\begin{pmatrix} 49  8 \\\\ 8  52 \\end{pmatrix}$。$\\det(\\mathbf{H})=(\\frac{25}{36})^2(49\\times 52 - 64) = \\frac{625}{1296}(2548-64)=\\frac{625 \\times 2484}{1296} = \\frac{625 \\times 69}{36} = \\frac{43125}{36}$。\n$\\mathbf{H}^{-1} = \\frac{36}{43125} \\begin{pmatrix} \\frac{325}{9}  -\\frac{50}{9} \\\\ -\\frac{50}{9}  \\frac{1225}{36} \\end{pmatrix} = \\frac{1}{43125} \\begin{pmatrix} 1300  -200 \\\\ -200  1225 \\end{pmatrix} = \\frac{25}{43125}\\begin{pmatrix} 52  -8 \\\\ -8  49 \\end{pmatrix} = \\frac{1}{1725}\\begin{pmatrix} 52  -8 \\\\ -8  49 \\end{pmatrix}$。\n现在我们构建乘积 $\\mathbf{H}^{-1} (\\mathbf{K}^T \\mathbf{S}_{\\epsilon}^{-1}\\mathbf{K})$：\n$$\n\\mathbf{A} = \\frac{1}{1725}\\begin{pmatrix} 52  -8 \\\\ -8  49 \\end{pmatrix} \\begin{pmatrix} \\frac{250}{9}  \\frac{50}{9} \\\\ \\frac{50}{9}  \\frac{100}{9} \\end{pmatrix} = \\frac{1}{1725 \\cdot 9} \\begin{pmatrix} 52  -8 \\\\ -8  49 \\end{pmatrix} \\begin{pmatrix} 250  50 \\\\ 50  100 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} = \\frac{1}{15525} \\begin{pmatrix} 52(250) - 8(50)  52(50) - 8(100) \\\\ -8(250) + 49(50)  -8(50) + 49(100) \\end{pmatrix} = \\frac{1}{15525} \\begin{pmatrix} 13000 - 400  2600 - 800 \\\\ -2000 + 2450  -400 + 4900 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} = \\frac{1}{15525} \\begin{pmatrix} 12600  1800 \\\\ 450  4500 \\end{pmatrix}\n$$\n所有元素都可以被 $225$ 整除。$15525 = 225 \\times 69$。$12600 = 225 \\times 56$。$1800 = 225 \\times 8$。$450 = 225 \\times 2$。$4500 = 225 \\times 20$。\n$$\n\\mathbf{A} = \\frac{225}{15525} \\begin{pmatrix} 56  8 \\\\ 2  20 \\end{pmatrix} = \\frac{1}{69} \\begin{pmatrix} 56  8 \\\\ 2  20 \\end{pmatrix}\n$$\nDFS 是 $\\mathbf{A}$ 的迹：\n$$\n\\mathrm{DFS} = \\mathrm{trace}(\\mathbf{A}) = \\frac{1}{69}(56 + 20) = \\frac{76}{69}\n$$\n最后，我们计算数值并四舍五入到五位有效数字：\n$$\n\\mathrm{DFS} = \\frac{76}{69} \\approx 1.101449275...\n$$\n四舍五入到五位有效数字得到 $1.1014$。",
            "answer": "$$\n\\boxed{1.1014}\n$$"
        }
    ]
}