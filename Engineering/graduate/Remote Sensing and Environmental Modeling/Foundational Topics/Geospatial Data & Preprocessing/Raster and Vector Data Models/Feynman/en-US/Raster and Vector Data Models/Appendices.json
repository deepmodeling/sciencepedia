{
    "hands_on_practices": [
        {
            "introduction": "Raster data models represent continuous spatial fields, such as temperature or elevation, as a grid of discrete cells. A fundamental task is to estimate the field's value at arbitrary locations, not just at cell centers. This exercise guides you through deriving the bilinear interpolation formula from first principles, a cornerstone technique for raster resampling and data integration . By building the two-dimensional interpolator from sequential one-dimensional steps, you will gain a core understanding of how values are estimated within the raster grid.",
            "id": "3840469",
            "problem": "In geospatial resampling of raster imagery for remote sensing and environmental modeling, a common operation is to estimate a continuous field from discrete pixel corner values using bilinear interpolation. Consider a single pixel represented as a unit square with coordinates in $[0,1]\\times[0,1]$. Let the corner values of surface reflectance (unitless fraction) at the four corners $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$ be $z_{00}$, $z_{10}$, $z_{01}$, and $z_{11}$, respectively. Assume the target location inside the square is $(x,y)$ with $x\\in[0,1]$ and $y\\in[0,1]$, where $x$ and $y$ are normalized offsets from the lower-left corner along the $x$- and $y$-axes.\n\na) Starting only from the fundamental definition of one-dimensional linear interpolation along a single axis—that the interpolant between two values $a$ at position $0$ and $b$ at position $1$ is given by the affine combination $(1-\\lambda)a+\\lambda b$ for $\\lambda\\in[0,1]$—derive the bilinear interpolation function $I(x,y)$ on the unit square in terms of $z_{00}$, $z_{10}$, $z_{01}$, $z_{11}$, $x$, and $y$. Do not assume a known form; construct it by sequentially applying one-dimensional interpolation along one axis and then along the other.\n\nb) For a multispectral image band, suppose the reflectance values are $z_{00}=0.12$, $z_{10}=0.20$, $z_{01}=0.32$, and $z_{11}=0.44$, and the query point is $(x,y)=(0.30,0.60)$. Evaluate the derived $I(x,y)$ at this point. Express the final reflectance as a decimal (unitless) and round your answer to six significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive the bilinear interpolation function and compute its value for the given data.\n\n### Part a) Derivation of the Bilinear Interpolation Function\n\nThe core principle is to apply one-dimensional linear interpolation sequentially along two orthogonal axes. The problem defines one-dimensional linear interpolation for a parameter $\\lambda \\in [0,1]$ between a value $a$ at position $0$ and a value $b$ at position $1$ as $f(\\lambda) = (1-\\lambda)a + \\lambda b$. We will apply this principle to the unit square $[0,1] \\times [0,1]$.\n\nLet the four corner values be $z_{00}$ at $(0,0)$, $z_{10}$ at $(1,0)$, $z_{01}$ at $(0,1)$, and $z_{11}$ at $(1,1)$. We seek the interpolated value $I(x,y)$ at a point $(x,y)$ within this square.\n\n**Step 1: Interpolation along the x-axis.**\n\nFirst, we perform two separate linear interpolations along the x-axis.\n\n1.  For the bottom edge of the square (where the y-coordinate is $0$), we interpolate between the value $z_{00}$ (at $x=0$) and $z_{10}$ (at $x=1$). The interpolation parameter is $x$. The interpolated value at the point $(x,0)$, which we denote as $I_1$, is:\n    $$I_1 = (1-x)z_{00} + x z_{10}$$\n\n2.  For the top edge of the square (where the y-coordinate is $1$), we interpolate between the value $z_{01}$ (at $x=0$) and $z_{11}$ (at $x=1$). The interpolation parameter is again $x$. The interpolated value at the point $(x,1)$, which we denote as $I_2$, is:\n    $$I_2 = (1-x)z_{01} + x z_{11}$$\n\nWe now have two intermediate values, $I_1$ and $I_2$, which represent the interpolated values along the vertical line at a specific x-coordinate $x$, but at heights $y=0$ and $y=1$, respectively.\n\n**Step 2: Interpolation along the y-axis.**\n\nNext, we perform a final linear interpolation along the y-axis to find the value at the target location $(x,y)$. We interpolate between the intermediate value $I_1$ (at $y=0$) and $I_2$ (at $y=1$). The interpolation parameter is now $y$.\n\nThe final interpolated value, $I(x,y)$, is given by:\n$$I(x,y) = (1-y)I_1 + y I_2$$\n\nSubstituting the expressions for $I_1$ and $I_2$ from Step 1 into this equation:\n$$I(x,y) = (1-y) \\left( (1-x)z_{00} + x z_{10} \\right) + y \\left( (1-x)z_{01} + x z_{11} \\right)$$\n\nExpanding this expression gives the general formula for bilinear interpolation on the unit square:\n$$I(x,y) = (1-x)(1-y)z_{00} + x(1-y)z_{10} + (1-x)y z_{01} + xy z_{11}$$\n\nThis function $I(x,y)$ is the derived bilinear interpolant. It is a weighted average of the four corner values, where each weight corresponds to the area of the rectangle formed by the query point and the corner diagonally opposite to the corner being weighted.\n\n### Part b) Evaluation at a Specific Point\n\nWe are given the following reflectance values and coordinates:\n-   $z_{00} = 0.12$\n-   $z_{10} = 0.20$\n-   $z_{01} = 0.32$\n-   $z_{11} = 0.44$\n-   $(x,y) = (0.30, 0.60)$\n\nWe also compute the complementary terms:\n-   $1-x = 1 - 0.30 = 0.70$\n-   $1-y = 1 - 0.60 = 0.40$\n\nSubstituting these values into the derived formula for $I(x,y)$:\n$$I(0.30, 0.60) = (1-0.30)(1-0.60)z_{00} + (0.30)(1-0.60)z_{10} + (1-0.30)(0.60)z_{01} + (0.30)(0.60)z_{11}$$\n$$I(0.30, 0.60) = (0.70)(0.40)(0.12) + (0.30)(0.40)(0.20) + (0.70)(0.60)(0.32) + (0.30)(0.60)(0.44)$$\n\nNow, we evaluate each term:\n-   Term 1: $(0.70)(0.40)(0.12) = (0.28)(0.12) = 0.0336$\n-   Term 2: $(0.30)(0.40)(0.20) = (0.12)(0.20) = 0.0240$\n-   Term 3: $(0.70)(0.60)(0.32) = (0.42)(0.32) = 0.1344$\n-   Term 4: $(0.30)(0.60)(0.44) = (0.18)(0.44) = 0.0792$\n\nSumming these terms gives the final interpolated reflectance:\n$$I(0.30, 0.60) = 0.0336 + 0.0240 + 0.1344 + 0.0792 = 0.2712$$\n\nThe problem requires the answer to be rounded to six significant figures. The exact value is $0.2712$. To express this with six significant figures, we append two zeros.\n$$I(0.30, 0.60) = 0.271200$$",
            "answer": "$$\\boxed{0.271200}$$"
        },
        {
            "introduction": "Beyond the values within individual cells, the spatial relationship *between* cells is critical for defining objects and analyzing patterns. This practice explores the concept of connectivity, which determines how cells are grouped into contiguous regions or components. You will analyze how the choice between 4-neighbor and 8-neighbor adjacency rules—a seemingly small detail—can lead to dramatically different interpretations of a landscape's structure, a crucial consideration in fields like landscape ecology and hydrology .",
            "id": "3840460",
            "problem": "A binary raster mask is a discrete grid representation where each grid cell stores a binary state. Consider a $6 \\times 6$ binary raster representing inundated cells ($1$) and non-inundated cells ($0$) derived from a satellite classification in a Geographic Information System (GIS). The mask is\n$$\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 1 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 1 & 0 \\\\\n1 & 1 & 0 & 0 & 0 & 1\n\\end{bmatrix}.\n$$\nUse the following core definitions as the fundamental base:\n- Two raster cells are considered adjacent under $4$-neighbor connectivity if and only if their Manhattan distance is $1$, i.e., for cell centers at integer coordinates $(i,j)$ and $(k,\\ell)$, adjacency holds when $|i-k|+|j-\\ell|=1$.\n- Two raster cells are considered adjacent under $8$-neighbor connectivity if and only if their Chebyshev distance is $1$, i.e., adjacency holds when $\\max\\{|i-k|,|j-\\ell|\\}=1$.\n- A connected component is a maximal set of $1$-valued cells such that each pair of cells in the set is linked by a path of pairwise adjacent $1$-valued cells.\n\nTask:\n1. Using only these definitions, determine the number of connected components of $1$-valued cells under $4$-neighbor connectivity and under $8$-neighbor connectivity for the given mask.\n2. In your derivation, make clear how diagonal connections present in this mask lead to different component counts under the two schemes, thereby demonstrating how $4$-neighbor connectivity can misclassify diagonally continuous inundation as fragmented when compared to $8$-neighbor connectivity.\n\nReport your final answer as the ordered pair $(C_{4},C_{8})$, where $C_{4}$ is the number of connected components under $4$-neighbor connectivity and $C_{8}$ is the number under $8$-neighbor connectivity. Express your final answer as exact integers. No rounding is required and no physical units apply.",
            "solution": "The problem is valid. It is self-contained, scientifically grounded in the principles of raster data analysis and graph theory, and presented with objective, formal definitions. All necessary data, including the raster mask and connectivity rules, are provided to determine a unique, verifiable solution.\n\nLet the given $6 \\times 6$ binary raster mask be denoted by the matrix $M$. We will use $1$-based indexing for rows and columns, so a cell is represented by its coordinates $(i,j)$ where $i,j \\in \\{1, 2, 3, 4, 5, 6\\}$. The set of all cells with value $1$ is:\n$$S = \\{(1,1), (2,2), (2,5), (3,3), (3,4), (3,5), (4,3), (5,1), (5,2), (5,4), (5,5), (6,1), (6,2), (6,6)\\}$$\n\n**1. Analysis for 4-Neighbor Connectivity ($C_4$)**\n\nWe apply the definition of $4$-neighbor connectivity, where two cells $(i,j)$ and $(k,\\ell)$ are adjacent if $|i-k|+|j-\\ell|=1$. This means a cell is connected only to its immediate neighbors to the north, south, east, and west. We will enumerate the connected components by systematically traversing the set $S$.\n\n- **Component 1:** Start with the cell $(1,1)$. Its $4$-neighbors are $(1,2)$ and $(2,1)$. The values at these locations in the mask are $M_{12}=0$ and $M_{21}=0$. Thus, $(1,1)$ has no $4$-connected neighbors with a value of $1$. It forms a component by itself: $C_{4,1} = \\{(1,1)\\}$.\n\n- **Component 2:** The next unassigned cell is $(2,2)$. Its $4$-neighbors are $(1,2)$, $(2,1)$, $(2,3)$, and $(3,2)$, all of which have a value of $0$. Thus, $(2,2)$ is also an isolated component: $C_{4,2} = \\{(2,2)\\}$.\n\n- **Component 3:** The next unassigned cell is $(2,5)$. Its only $4$-neighbor with value $1$ is $(3,5)$. Following the path from $(3,5)$, it is $4$-connected to $(3,4)$. From $(3,4)$, it is $4$-connected to $(3,3)$. From $(3,3)$, it is $4$-connected to $(4,3)$. The cell $(4,3)$ has no further unassigned $4$-neighbors with value $1$. Therefore, this component is the set: $C_{4,3} = \\{(2,5), (3,5), (3,4), (3,3), (4,3)\\}$.\n\n- **Component 4:** The next unassigned cell is $(5,1)$. It is $4$-connected to $(5,2)$ and $(6,1)$. Both $(5,2)$ and $(6,1)$ are $4$-connected to $(6,2)$. There are no other $4$-connections from this group to other cells with value $1$. This component is the set: $C_{4,4} = \\{(5,1), (5,2), (6,1), (6,2)\\}$.\n\n- **Component 5:** The next unassigned cell is $(5,4)$. It is $4$-connected to $(5,5)$. The cell $(5,5)$ has no other $4$-neighbors with value $1$. This component is the set: $C_{4,5} = \\{(5,4), (5,5)\\}$.\n\n- **Component 6:** The final unassigned cell is $(6,6)$. Its $4$-neighbors, $(5,6)$ and $(6,5)$, both have a value of $0$. It forms an isolated component: $C_{4,6} = \\{(6,6)\\}$.\n\nAll cells in $S$ have been assigned to a component. The number of distinct components under $4$-neighbor connectivity is $6$. Thus, $C_{4}=6$.\n\n**2. Analysis for 8-Neighbor Connectivity ($C_8$)**\n\nWe now apply the definition of $8$-neighbor connectivity, where two cells $(i,j)$ and $(k,\\ell)$ are adjacent if $\\max\\{|i-k|, |j-\\ell|\\}=1$. This rule includes diagonal neighbors in addition to the cardinal neighbors from the $4$-connectivity rule. We analyze how this broader definition of adjacency merges the components identified previously.\n\nThe task requires us to demonstrate how diagonal connections cause the component count to differ. We will show that all $6$ of the $4$-neighbor components are linked into a single component by new connections enabled by the $8$-neighbor rule.\n\n- **Merging $C_{4,1}$ and $C_{4,2}$:** Component $C_{4,1} = \\{(1,1)\\}$ and $C_{4,2} = \\{(2,2)\\}$ are separate under $4$-connectivity. However, for cells $(1,1)$ and $(2,2)$, we have $\\max\\{|1-2|, |1-2|\\} = \\max\\{1,1\\} = 1$. They are diagonal neighbors and are therefore connected under the $8$-neighbor rule. This merges them into a single group $\\{(1,1), (2,2)\\}$.\n\n- **Merging with $C_{4,3}$:** The cell $(2,2)$ from the newly merged group is diagonally adjacent to cell $(3,3)$ from component $C_{4,3}$, since $\\max\\{|2-3|, |2-3|\\} = \\max\\{1,1\\} = 1$. This connection merges the group $\\{(1,1), (2,2)\\}$ with the entirety of $C_{4,3}$.\n\n- **Merging with $C_{4,4}$:** Cell $(4,3)$ (now part of the growing single component) is diagonally adjacent to cell $(5,2)$ from component $C_{4,4}$, since $\\max\\{|4-5|,|3-2|\\} = \\max\\{1,1\\}=1$. This merges $C_{4,4}$ into the main component.\n\n- **Merging with $C_{4,5}$:** Cell $(4,3)$ is also diagonally adjacent to cell $(5,4)$ from component $C_{4,5}$, since $\\max\\{|4-5|,|3-4|\\} = \\max\\{1,1\\}=1$. This merges $C_{4,5}$ into the main component.\n\n- **Merging with $C_{4,6}$:** The cell $(5,5)$ (now part of the main component after merging with $C_{4,5}$) is a diagonal neighbor of cell $(6,6)$ from component $C_{4,6}$, since $\\max\\{|5-6|,|5-6|\\} = \\max\\{1,1\\}=1$. This final connection merges $C_{4,6}$ into the main component.\n\nThrough this chain of diagonal connections, all $6$ components that were distinct under $4$-connectivity become linked into a single, large connected component. No $1$-valued cells remain outside this single component. Therefore, the number of components under $8$-neighbor connectivity is $1$. Thus, $C_{8}=1$.\n\nThe analysis highlights a critical aspect of raster data modeling. The choice of connectivity rule directly impacts the topological structure of the data. Visually, the inundated cells form a large, contiguous, albeit thin, diagonal feature. The $8$-neighbor connectivity model correctly identifies this as a single entity. In contrast, the more restrictive $4$-neighbor connectivity model fails to capture the diagonal continuity, resulting in the misclassification of the single feature as $6$ fragmented and disconnected pieces. This has significant implications in environmental modeling, for instance, where measuring the number or size of inundated areas would yield drastically different results depending on the chosen connectivity scheme.\n\nThe final ordered pair is $(C_4, C_8) = (6,1)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 6 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Rasters can model not only static landscapes but also the dynamics of movement across them, a key function of Geographic Information Systems (GIS). This exercise introduces least-cost path analysis, where a raster grid of 'friction' values represents the resistance to movement. You will first derive the dynamic programming recurrence for accumulated cost and then apply it to find the most efficient route between two points, a technique fundamental to everything from logistics planning to wildlife corridor design .",
            "id": "3840444",
            "problem": "A raster grid in a Geographic Information System (GIS) encodes a spatial field of movement resistance as cell-wise friction values. Consider a discrete-time, discrete-space movement model on a raster where an agent starts from a single source cell and may move at each step to any of its $8$-connected neighbors (the four orthogonal and the four diagonal neighbors). Assume the cost of traversing from one cell to another is the product of a per-unit-distance friction and the Euclidean distance of the move. The friction at a cell is the resistance per unit distance and is assumed to be an isotropic scalar. Use the following setup.\n\nFundamental base and assumptions:\n- The raster is indexed by integer row and column coordinates $(i,j)$ with $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,3\\}$, where $(1,1)$ is the upper-left cell and rows increase downward.\n- The friction field $F(i,j)$ is defined on the raster cells and represents resistance per unit distance. The raster cell size is $s$, the edge length of each square cell. The Euclidean distance of a single-step move is $s$ for orthogonal moves and $s\\sqrt{2}$ for diagonal moves.\n- The movement cost of a single step from a cell $(p,q)$ to an adjacent cell $(i,j)$ is modeled as the product of the Euclidean step length and the average of the two endpoint frictions, that is, $\\left(\\frac{F(p,q)+F(i,j)}{2}\\right)$ times the step length.\n- The accumulated cost $C(i,j)$ is defined as the minimal sum of step costs over all valid paths from the source cell to $(i,j)$. The source cell $(i_{0},j_{0})$ has $C(i_{0},j_{0})=0$.\n\nTask:\n1. Starting from the core definitions of path cost on a weighted graph and the principle of optimality for dynamic programming, derive a recurrence for the accumulated cost $C(i,j)$ over an $8$-connected raster. Clearly state the neighbor set and the transition cost used in the recurrence.\n2. Using the recurrence you derive, compute the accumulated cost $C(3,3)$ for the following $3 \\times 3$ raster with cell size $s$ and friction field $F(i,j)$:\n$$\nF=\\begin{pmatrix}\n2 & 3 & 5 \\\\\n4 & 1 & 2 \\\\\n6 & 2 & 1\n\\end{pmatrix},\n\\quad s=1,\n\\quad (i_{0},j_{0})=(2,2).\n$$\nExpress the final accumulated cost as a closed-form analytic expression in cost-units. No rounding is required. The answer must be a single real-valued number or a single closed-form analytic expression.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It presents a standard least-cost path problem on a raster grid, a fundamental topic in Geographic Information Science and computational geography. All parameters and definitions required for a unique solution are provided. We may therefore proceed with the solution.\n\nThe problem is divided into two parts: first, the derivation of a general recurrence for accumulated cost, and second, the application of this principle to compute a specific cost on a given raster.\n\n### Part 1: Derivation of the Recurrence for Accumulated Cost\n\nThe problem of finding the minimal accumulated cost from a source cell to all other cells on a friction grid is equivalent to the single-source shortest path problem on a weighted graph. Let the graph be $G=(V, E)$, where the set of vertices $V$ consists of the center points of the raster cells $(i,j)$, and the set of edges $E$ connects each cell to its $8$ neighbors.\n\nThe cost, or weight, of traversing an edge from a cell $(p,q)$ to an adjacent cell $(i,j)$ is given as the transition cost $T((p,q), (i,j))$. According to the problem statement, this is:\n$$\nT((p,q), (i,j)) = \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j))\n$$\nwhere $F(i,j)$ is the friction at cell $(i,j)$ and $d((p,q), (i,j))$ is the Euclidean distance between the cell centers. Given a cell size of $s$, the distance is:\n$$\nd((p,q), (i,j)) =\n\\begin{cases}\ns & \\text{if } (i,j) \\text{ is an orthogonal neighbor of } (p,q) \\\\\ns\\sqrt{2} & \\text{if } (i,j) \\text{ is a diagonal neighbor of } (p,q)\n\\end{cases}\n$$\nThe set of neighbors for a cell $(i,j)$, denoted $\\mathcal{N}(i,j)$, is the set of $8$ cells $(p,q)$ such that $\\max(|i-p|, |j-q|) = 1$.\n\nThe accumulated cost $C(i,j)$ is the cost of the shortest path from the source cell $(i_0, j_0)$ to the cell $(i,j)$. The derivation of its recurrence relation is based on the principle of optimality (as formulated by Bellman). This principle states that if a path from $(i_0, j_0)$ to $(i,j)$ is a shortest path, then any subpath of it is also a shortest path.\n\nConsider a shortest path to an arbitrary cell $(i,j)$ from the source $(i_0, j_0)$. This path must arrive at $(i,j)$ from one of its neighbors, say $(p,q) \\in \\mathcal{N}(i,j)$. The principle of optimality implies that the portion of the path from $(i_0, j_0)$ to $(p,q)$ must be the shortest path to $(p,q)$. The cost of this path to $(i,j)$ via $(p,q)$ is therefore the sum of the minimal cost to reach $(p,q)$, which is $C(p,q)$, and the transition cost from $(p,q)$ to $(i,j)$, which is $T((p,q), (i,j))$.\n\nSince $C(i,j)$ must be the minimal cost, it must be the minimum of the costs of all possible paths arriving from any of its neighbors. This leads to the general recurrence relation for the accumulated cost:\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\{ C(p,q) + T((p,q), (i,j)) \\}\n$$\nSubstituting the definition of the transition cost, we get:\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\left\\{ C(p,q) + \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j)) \\right\\}\n$$\nThis recurrence holds for all cells $(i,j)$ not equal to the source cell. The base case for the recurrence is the cost at the source cell, which is defined to be zero:\n$$\nC(i_0, j_0) = 0\n$$\nThese equations define the properties of the final accumulated cost surface. Iterative algorithms, such as Dijkstra's algorithm or its variants (e.g., A*), are used to solve this system of equations and compute the cost values, starting from the source and expanding outward.\n\n### Part 2: Computation of Accumulated Cost C(3,3)\n\nWe are given the following problem-specific data:\n- Cell size $s=1$.\n- Source cell $(i_0, j_0) = (2,2)$.\n- Friction field $F$:\n$$\nF=\\begin{pmatrix}\n2 & 3 & 5 \\\\\n4 & 1 & 2 \\\\\n6 & 2 & 1\n\\end{pmatrix}\n$$\nThis means $F(1,1)=2$, $F(1,2)=3$, $F(1,3)=5$, $F(2,1)=4$, $F(2,2)=1$, $F(2,3)=2$, $F(3,1)=6$, $F(3,2)=2$, and $F(3,3)=1$.\nOur goal is to compute $C(3,3)$. We will employ Dijkstra's algorithm, which systematically finds the shortest path from a source node to all other nodes in a graph with non-negative edge weights.\n\n1.  **Initialization**:\n    The cost at the source cell is $C(2,2) = 0$. The costs for all other cells are initialized to infinity. We maintain a set of \"visited\" cells for which the minimal cost is finalized. Initially, this set is empty. We use a priority queue of \"unvisited\" cells, ordered by their current tentative minimum cost.\n    - $C(2,2) = 0$.\n    - $C(i,j) = \\infty$ for all $(i,j) \\neq (2,2)$.\n\n2.  **First Iteration**:\n    The algorithm selects the node with the minimum cost, which is the source $(2,2)$. We finalize its cost and update the tentative costs of its $8$ neighbors. The friction at the source is $F(2,2)=1$.\n\n    -   **Path to $(1,1)$ (diagonal)**: $d=\\sqrt{2}$. $F(1,1)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,1)}{2}d = 0 + \\frac{1+2}{2}\\sqrt{2} = \\frac{3}{2}\\sqrt{2}$.\n    -   **Path to $(1,2)$ (orthogonal)**: $d=1$. $F(1,2)=3$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,2)}{2}d = 0 + \\frac{1+3}{2}(1) = 2$.\n    -   **Path to $(1,3)$ (diagonal)**: $d=\\sqrt{2}$. $F(1,3)=5$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,3)}{2}d = 0 + \\frac{1+5}{2}\\sqrt{2} = 3\\sqrt{2}$.\n    -   **Path to $(2,1)$ (orthogonal)**: $d=1$. $F(2,1)=4$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(2,1)}{2}d = 0 + \\frac{1+4}{2}(1) = \\frac{5}{2}$.\n    -   **Path to $(2,3)$ (orthogonal)**: $d=1$. $F(2,3)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(2,3)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$.\n    -   **Path to $(3,1)$ (diagonal)**: $d=\\sqrt{2}$. $F(3,1)=6$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,1)}{2}d = 0 + \\frac{1+6}{2}\\sqrt{2} = \\frac{7}{2}\\sqrt{2}$.\n    -   **Path to $(3,2)$ (orthogonal)**: $d=1$. $F(3,2)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,2)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$.\n    -   **Path to $(3,3)$ (diagonal)**: $d=\\sqrt{2}$. $F(3,3)=1$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,3)}{2}d = 0 + \\frac{1+1}{2}\\sqrt{2} = \\sqrt{2}$.\n\n3.  **Second Iteration**:\n    The tentative costs for the neighbors of the source are now:\n    $C(1,1) = \\frac{3\\sqrt{2}}{2} \\approx 2.121$\n    $C(1,2) = 2$\n    $C(1,3) = 3\\sqrt{2} \\approx 4.243$\n    $C(2,1) = 2.5$\n    $C(2,3) = 1.5$\n    $C(3,1) = \\frac{7\\sqrt{2}}{2} \\approx 4.950$\n    $C(3,2) = 1.5$\n    $C(3,3) = \\sqrt{2} \\approx 1.414$\n\n    Dijkstra's algorithm now selects the unvisited cell with the minimum tentative cost. Comparing the values, the minimum is $C(3,3) = \\sqrt{2}$.\n\n    Because our target cell $(3,3)$ is the one selected from the priority queue, its minimal cost has been found. The algorithm guarantees this because all edge weights (transition costs) are non-negative. Any alternative path to $(3,3)$ must pass through another unvisited cell $(p,q)$. However, at this stage, all other unvisited cells $(p,q)$ have a tentative cost $C(p,q) \\ge C(3,3) = \\sqrt{2}$. Therefore, any path routed through such a cell could not possibly result in a total cost less than $\\sqrt{2}$. The shortest path to $(3,3)$ is the direct diagonal move from $(2,2)$.\n\nThe accumulated cost at $(3,3)$ is thus the cost of this direct path.\n$$\nC(3,3) = \\sqrt{2}\n$$",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        }
    ]
}