{
    "hands_on_practices": [
        {
            "introduction": "在栅格数据分析中，理解像元之间如何连接以形成对象或区域是基础。连接性规则的选择（例如，四邻域或八邻域）会极大地改变空间分析的结果。本练习将让你亲手实践这两种基本的连接性定义，通过使用两种规则分析同一个栅格掩模，你将直接观察到这个看似微小的选择如何导致对空间格局的截然不同解读，例如洪泛区的数量。这有助于你深刻理解在模型中精确定义拓扑关系的重要性。",
            "id": "3840460",
            "problem": "二元栅格掩膜是一种离散的网格表示，其中每个网格单元存储一个二元状态。考虑一个 $6 \\times 6$ 的二元栅格，它表示从地理信息系统（GIS）中的卫星分类派生出的淹没单元（$1$）和未淹没单元（$0$）。该掩膜为\n$$\n\\begin{bmatrix}\n1  0  0  0  0  0 \\\\\n0  1  0  0  1  0 \\\\\n0  0  1  1  1  0 \\\\\n0  0  1  0  0  0 \\\\\n1  1  0  1  1  0 \\\\\n1  1  0  0  0  1\n\\end{bmatrix}.\n$$\n使用以下核心定义作为基本依据：\n- 当且仅当两个栅格单元的曼哈顿距离为 $1$ 时，它们在 $4$-邻域连通性下被认为是相邻的，即，对于中心位于整数坐标 $(i,j)$ 和 $(k,\\ell)$ 的单元，当 $|i-k|+|j-\\ell|=1$ 时，邻接关系成立。\n- 当且仅当两个栅格单元的切比雪夫距离为 $1$ 时，它们在 $8$-邻域连通性下被认为是相邻的，即，当 $\\max\\{|i-k|,|j-\\ell|\\}=1$ 时，邻接关系成立。\n- 连通分量是值为 $1$ 的单元的最大集合，其中集合中的任意一对单元都通过一条由成对相邻且值为 $1$ 的单元组成的路径相连接。\n\n任务：\n1. 仅使用这些定义，确定在 $4$-邻域连通性和 $8$-邻域连通性下，给定掩膜中值为 $1$ 的单元的连通分量数量。\n2. 在你的推导过程中，请明确说明该掩膜中存在的对角线连接如何导致两种方案下分量数量的不同，从而证明与 $8$-邻域连通性相比，$4$-邻域连通性如何可能将对角线连续的淹没区域错误地分类为碎片化的。\n\n将你的最终答案以有序对 $(C_{4},C_{8})$ 的形式报告，其中 $C_{4}$ 是在 $4$-邻域连通性下的连通分量数量，$C_{8}$ 是在 $8$-邻域连通性下的连通分量数量。你的最终答案应表示为精确整数。不需要四舍五入，也不适用任何物理单位。",
            "solution": "该问题是有效的。它内容自洽，科学上基于栅格数据分析和图论的原理，并以客观、正式的定义呈现。所有必要的数据，包括栅格掩膜和连通性规则，都已提供，足以确定一个唯一的、可验证的解。\n\n设给定的 $6 \\times 6$ 二元栅格掩膜由矩阵 $M$ 表示。我们将对行和列使用基于 $1$ 的索引，因此一个单元由其坐标 $(i,j)$ 表示，其中 $i,j \\in \\{1, 2, 3, 4, 5, 6\\}$。所有值为 $1$ 的单元集合为：\n$$S = \\{(1,1), (2,2), (2,5), (3,3), (3,4), (3,5), (4,3), (5,1), (5,2), (5,4), (5,5), (6,1), (6,2), (6,6)\\}$$\n\n**1. 4-邻域连通性分析（$C_4$）**\n\n我们应用 $4$-邻域连通性的定义，其中两个单元 $(i,j)$ 和 $(k,\\ell)$ 如果满足 $|i-k|+|j-\\ell|=1$ 则为相邻。这意味着一个单元仅与其正北、正南、正东和正西的紧邻单元相连。我们将通过系统地遍历集合 $S$ 来枚举连通分量。\n\n- **分量 1：** 从单元 $(1,1)$ 开始。其 $4$-邻域邻居是 $(1,2)$ 和 $(2,1)$。掩膜中这些位置的值为 $M_{12}=0$ 和 $M_{21}=0$。因此，$(1,1)$ 没有值为 $1$ 的 $4$-连通邻居。它自身构成一个分量：$C_{4,1} = \\{(1,1)\\}$。\n\n- **分量 2：** 下一个未分配的单元是 $(2,2)$。其 $4$-邻域邻居是 $(1,2)$、$(2,1)$、$(2,3)$ 和 $(3,2)$，它们的值均为 $0$。因此，$(2,2)$ 也是一个孤立分量：$C_{4,2} = \\{(2,2)\\}$。\n\n- **分量 3：** 下一个未分配的单元是 $(2,5)$。其唯一值为 $1$ 的 $4$-邻域邻居是 $(3,5)$。从 $(3,5)$ 出发，它与 $(3,4)$ 是 $4$-连通的。从 $(3,4)$ 出发，它与 $(3,3)$ 是 $4$-连通的。从 $(3,3)$ 出发，它与 $(4,3)$ 是 $4$-连通的。单元 $(4,3)$ 没有其他值为 $1$ 的未分配 $4$-邻域邻居。因此，该分量是集合：$C_{4,3} = \\{(2,5), (3,5), (3,4), (3,3), (4,3)\\}$。\n\n- **分量 4：** 下一个未分配的单元是 $(5,1)$。它与 $(5,2)$ 和 $(6,1)$ 是 $4$-连通的。$(5,2)$ 和 $(6,1)$ 都与 $(6,2)$ 不是 $4$-连通的。等等，这里有个错误。$(5,2)$ 的4-邻居有(5,1), (4,2), (5,3), (6,2)。$(6,1)$的4-邻居有(5,1), (6,2), (7,1), (6,0)。所以(5,2)和(6,1)都与(6,2)是4-连通的。让我们重新分析。\n(5,1) 与 (5,2) 4-连通。\n(5,1) 与 (6,1) 4-连通。\n(5,2) 与 (6,2) 4-连通。\n(6,1) 与 (6,2) 4-连通。\n因此，(5,1), (5,2), (6,1), (6,2) 形成一个连通分量。\n该分量是集合：$C_{4,4} = \\{(5,1), (5,2), (6,1), (6,2)\\}$。\n\n- **分量 5：** 下一个未分配的单元是 $(5,4)$。它与 $(5,5)$ 是 $4$-连通的。单元 $(5,5)$ 没有其他值为 $1$ 的 $4$-邻域邻居。该分量是集合：$C_{4,5} = \\{(5,4), (5,5)\\}$。\n\n- **分量 6：** 最后一个未分配的单元是 $(6,6)$。其 $4$-邻域邻居 $(5,6)$ 和 $(6,5)$ 的值均为 $0$。它构成一个孤立分量：$C_{4,6} = \\{(6,6)\\}$。\n\n集合 $S$ 中的所有单元都已分配到一个分量中。在 $4$-邻域连通性下的不同分量数量为 $6$。因此，$C_{4}=6$。\n\n**2. 8-邻域连通性分析（$C_8$）**\n\n我们现在应用 $8$-邻域连通性的定义，其中两个单元 $(i,j)$ 和 $(k,\\ell)$ 如果满足 $\\max\\{|i-k|, |j-\\ell|\\}=1$ 则为相邻。此规则除了包含 $4$-连通性规则中的基本方位邻居外，还包括了对角线邻居。我们分析这个更广泛的邻接定义如何合并先前识别出的分量。\n\n任务要求我们证明对角线连接如何导致分量数量不同。我们将展示，所有 $6$ 个 $4$-邻域分量通过 $8$-邻域规则启用的新连接被链接成一个单一的分量。\n\n- **合并 $C_{4,1}$ 和 $C_{4,2}$：** 分量 $C_{4,1} = \\{(1,1)\\}$ 和 $C_{4,2} = \\{(2,2)\\}$ 在 $4$-连通性下是分开的。然而，对于单元 $(1,1)$ 和 $(2,2)$，我们有 $\\max\\{|1-2|, |1-2|\\} = \\max\\{1,1\\} = 1$。它们是对角线邻居，因此在 $8$-邻域规则下是连通的。这将它们合并成一个单一的组 $\\{(1,1), (2,2)\\}$。\n\n- **与 $C_{4,3}$ 合并：** 来自新合并组的单元 $(2,2)$ 与分量 $C_{4,3}$ 中的单元 $(3,3)$ 是对角线相邻的，因为 $\\max\\{|2-3|, |2-3|\\} = \\max\\{1,1\\} = 1$。这个连接将组 $\\{(1,1), (2,2)\\}$ 与整个 $C_{4,3}$ 合并。\n\n- **与 $C_{4,4}$ 合并：** 单元 $(4,3)$（现在是不断增大的单一分量的一部分）与分量 $C_{4,4}$ 中的单元 $(5,2)$ 是对角线相邻的，因为 $\\max\\{|4-5|,|3-2|\\} = \\max\\{1,1\\}=1$。这将 $C_{4,4}$ 合并到主分量中。\n\n- **与 $C_{4,5}$ 合并：** 单元 $(4,3)$ 也与分量 $C_{4,5}$ 中的单元 $(5,4)$ 是对角线相邻的，因为 $\\max\\{|4-5|,|3-4|\\} = \\max\\{1,1\\}=1$。这将 $C_{4,5}$ 合并到主分量中。\n\n- **与 $C_{4,6}$ 合并：** 单元 $(5,5)$（在与 $C_{4,5}$ 合并后，现已是主分量的一部分）是分量 $C_{4,6}$ 中单元 $(6,6)$ 的对角线邻居，因为 $\\max\\{|5-6|,|5-6|\\} = \\max\\{1,1\\}=1$。这最后一个连接将 $C_{4,6}$ 合并到主分量中。\n\n通过这一系列的对角线连接，所有在 $4$-连通性下独立的 $6$ 个分量被连接成一个单一的大型连通分量。没有值为 $1$ 的单元留在这个单一分量之外。因此，在 $8$-邻域连通性下的分量数量为 $1$。因此，$C_{8}=1$。\n\n该分析突出了栅格数据建模的一个关键方面。连通性规则的选择直接影响数据的拓扑结构。在视觉上，淹没的单元形成了一个大的、连续的、尽管很窄的对角线特征。$8$-邻域连通性模型正确地将其识别为单个实体。相比之下，更具限制性的 $4$-邻域连通性模型未能捕捉到对角线的连续性，导致将单个特征错误地分类为 $6$ 个零碎且不连通的部分。这在环境建模中具有重要意义，例如，根据所选的连通性方案，测量淹没区域的数量或大小将产生截然不同的结果。\n\n最终的有序对是 $(C_4, C_8) = (6,1)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 6  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "当我们重采样、重投影或叠加栅格数据时，常常需要在未与原始网格对齐的新位置上估算数值。双线性插值是完成此任务的基石算法，尤其适用于处理高程或反射率等连续数据。本练习不仅是简单地应用公式，它要求你从线性插值的第一性原理出发，推导出双线性插值函数。这个过程将巩固你对该算法基本工作原理的理解，使你在处理连续栅格场时能更好地把握其假设和局限性。",
            "id": "3840469",
            "problem": "在用于遥感和环境建模的地理空间栅格影像重采样中，一个常见的操作是使用双线性插值从离散的像素角点值来估计一个连续场。考虑一个表示为单位正方形的单个像素，其坐标在 $[0,1]\\times[0,1]$ 范围内。设四个角点 $(0,0)$、$(1,0)$、$(0,1)$ 和 $(1,1)$ 的地表反射率（无量纲分数）值分别为 $z_{00}$、$z_{10}$、$z_{01}$ 和 $z_{11}$。假设正方形内的目标位置为 $(x,y)$，其中 $x\\in[0,1]$ 且 $y\\in[0,1]$，$x$ 和 $y$ 是从左下角沿 $x$ 轴和 $y$ 轴的归一化偏移量。\n\na) 仅从一维线性插值沿单轴的基本定义出发——即位置 $0$ 的值 $a$ 和位置 $1$ 的值 $b$ 之间的插值由仿射组合 $(1-\\lambda)a+\\lambda b$（其中 $\\lambda\\in[0,1]$）给出——请推导单位正方形上的双线性插值函数 $I(x,y)$，用 $z_{00}$、$z_{10}$、$z_{01}$、$z_{11}$、$x$ 和 $y$ 表示。不要假设已知的形式；通过先沿一个轴再沿另一个轴依次应用一维插值来构建它。\n\nb) 对于一个多光谱影像波段，假设反射率值为 $z_{00}=0.12$、$z_{10}=0.20$、$z_{01}=0.32$ 和 $z_{11}=0.44$，查询点为 $(x,y)=(0.30, 0.60)$。在此点计算推导出的 $I(x,y)$ 的值。将最终反射率表示为小数（无量纲），并将您的答案四舍五入至六位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提法得当、客观，并包含推导双线性插值函数和计算给定数据下的函数值所需的所有必要信息。\n\n### a) 部分 双线性插值函数的推导\n\n核心原理是沿两个正交轴依次应用一维线性插值。问题将参数 $\\lambda \\in [0,1]$ 在位置 $0$ 的值 $a$ 和位置 $1$ 的值 $b$ 之间的一维线性插值定义为 $f(\\lambda) = (1-\\lambda)a + \\lambda b$。我们将把这个原理应用于单位正方形 $[0,1] \\times [0,1]$。\n\n设四个角点的值分别为 $(0,0)$ 处的 $z_{00}$，$(1,0)$ 处的 $z_{10}$，$(0,1)$ 处的 $z_{01}$ 和 $(1,1)$ 处的 $z_{11}$。我们寻求此正方形内一点 $(x,y)$ 的插值 $I(x,y)$。\n\n**步骤1：沿x轴插值。**\n\n首先，我们沿x轴进行两次独立的线性插值。\n\n1.  对于正方形的底边（其中y坐标为 $0$），我们在值 $z_{00}$（在 $x=0$ 处）和 $z_{10}$（在 $x=1$ 处）之间进行插值。插值参数是 $x$。在点 $(x,0)$ 处的插值（我们记为 $I_1$）是：\n    $$I_1 = (1-x)z_{00} + x z_{10}$$\n\n2.  对于正方形的顶边（其中y坐标为 $1$），我们在值 $z_{01}$（在 $x=0$ 处）和 $z_{11}$（在 $x=1$ 处）之间进行插值。插值参数同样是 $x$。在点 $(x,1)$ 处的插值（我们记为 $I_2$）是：\n    $$I_2 = (1-x)z_{01} + x z_{11}$$\n\n我们现在得到两个中间值 $I_1$ 和 $I_2$，它们分别代表在特定x坐标 $x$ 的垂线上，但在高度 $y=0$ 和 $y=1$ 处的插值。\n\n**步骤2：沿y轴插值。**\n\n接下来，我们沿y轴进行最后一次线性插值，以找到目标位置 $(x,y)$ 处的值。我们在中间值 $I_1$（在 $y=0$ 处）和 $I_2$（在 $y=1$ 处）之间进行插值。插值参数现在是 $y$。\n\n最终的插值 $I(x,y)$ 由下式给出：\n$$I(x,y) = (1-y)I_1 + y I_2$$\n\n将步骤1中 $I_1$ 和 $I_2$ 的表达式代入此方程：\n$$I(x,y) = (1-y) \\left( (1-x)z_{00} + x z_{10} \\right) + y \\left( (1-x)z_{01} + x z_{11} \\right)$$\n\n展开此表达式，得到单位正方形上双线性插值的通用公式：\n$$I(x,y) = (1-x)(1-y)z_{00} + x(1-y)z_{10} + (1-x)y z_{01} + xy z_{11}$$\n\n这个函数 $I(x,y)$ 就是推导出的双线性插值函数。它是四个角点值的加权平均，其中每个权重对应于由查询点和被加权角点的对角点所形成的矩形的面积。\n\n### b) 部分 在特定点求值\n\n给定以下反射率值和坐标：\n-   $z_{00} = 0.12$\n-   $z_{10} = 0.20$\n-   $z_{01} = 0.32$\n-   $z_{11} = 0.44$\n-   $(x,y) = (0.30, 0.60)$\n\n我们还计算互补项：\n-   $1-x = 1 - 0.30 = 0.70$\n-   $1-y = 1 - 0.60 = 0.40$\n\n将这些值代入推导出的 $I(x,y)$ 公式中：\n$$I(0.30, 0.60) = (1-0.30)(1-0.60)z_{00} + (0.30)(1-0.60)z_{10} + (1-0.30)(0.60)z_{01} + (0.30)(0.60)z_{11}$$\n$$I(0.30, 0.60) = (0.70)(0.40)(0.12) + (0.30)(0.40)(0.20) + (0.70)(0.60)(0.32) + (0.30)(0.60)(0.44)$$\n\n现在，我们计算每一项：\n-   第1项：$(0.70)(0.40)(0.12) = (0.28)(0.12) = 0.0336$\n-   第2项：$(0.30)(0.40)(0.20) = (0.12)(0.20) = 0.0240$\n-   第3项：$(0.70)(0.60)(0.32) = (0.42)(0.32) = 0.1344$\n-   第4项：$(0.30)(0.60)(0.44) = (0.18)(0.44) = 0.0792$\n\n将这些项相加，得到最终的插值反射率：\n$$I(0.30, 0.60) = 0.0336 + 0.0240 + 0.1344 + 0.0792 = 0.2712$$\n\n问题要求答案四舍五入到六位有效数字。精确值为 $0.2712$。为了用六位有效数字表示，我们追加两个零。\n$$I(0.30, 0.60) = 0.271200$$",
            "answer": "$$\\boxed{0.271200}$$"
        },
        {
            "introduction": "最小成本路径分析是一项强大的地理信息系统（GIS）技术，用于模拟跨越景观的移动和流动，其应用范围从野生动物廊道设计到基础设施规划无所不包。该分析将景观视为一个“成本表面”，穿越每个像元都会产生特定的成本。这项高级练习将引导你深入了解成本距离分析的理论基础。通过推导累积成本的动态规划递推关系，并将其应用于一个小型网格，你将掌握解决此类问题的核心算法（如Dijkstra算法）背后的逻辑，将抽象的图论概念与具体的地理空间问题解决联系起来。",
            "id": "3840444",
            "problem": "在地理信息系统（GIS）中，一个栅格网格以单元格方式的摩擦力值编码了运动阻力的空间场。考虑一个栅格上的离散时间、离散空间运动模型，其中一个代理从单个源单元格开始，在每一步可以移动到其任意一个 $8$ 连接的邻居（四个正交方向和四个对角线方向的邻居）。假设从一个单元格移动到另一个单元格的成本是单位距离摩擦力与移动的欧几里得距离的乘积。单元格的摩擦力是单位距离的阻力，并假定为一个各向同性的标量。使用以下设置。\n\n基本依据和假设：\n- 栅格由整数行和列坐标 $(i,j)$ 索引，其中 $i \\in \\{1,2,3\\}$ 且 $j \\in \\{1,2,3\\}$，$(1,1)$ 是左上角的单元格，行号向下递增。\n- 摩擦力场 $F(i,j)$ 定义在栅格单元格上，表示单位距离的阻力。栅格单元格大小为 $s$，即每个方形单元格的边长。单步移动的欧几里得距离，对于正交移动是 $s$，对于对角线移动是 $s\\sqrt{2}$。\n- 从单元格 $(p,q)$ 到相邻单元格 $(i,j)$ 的单步移动成本模型为欧几里得步长与两个端点摩擦力平均值的乘积，即步长乘以 $\\left(\\frac{F(p,q)+F(i,j)}{2}\\right)$。\n- 累积成本 $C(i,j)$ 定义为从源单元格到 $(i,j)$ 的所有有效路径中，步进成本之和的最小值。源单元格 $(i_{0},j_{0})$ 的成本为 $C(i_{0},j_{0})=0$。\n\n任务：\n1. 从加权图上的路径成本核心定义和动态规划的最优性原理出发，推导出一个 $8$ 连接栅格上累积成本 $C(i,j)$ 的递推关系。清晰地说明递推关系中使用的邻居集合和转移成本。\n2. 使用您推导出的递推关系，计算以下单元格大小为 $s$、摩擦力场为 $F(i,j)$ 的 $3 \\times 3$ 栅格的累积成本 $C(3,3)$：\n$$\nF=\\begin{pmatrix}\n2  3  5 \\\\\n4  1  2 \\\\\n6  2  1\n\\end{pmatrix},\n\\quad s=1,\n\\quad (i_{0},j_{0})=(2,2).\n$$\n将最终累积成本表示为一个封闭形式的解析表达式，单位为成本单位。无需四舍五入。答案必须是一个实数值或一个封闭形式的解析表达式。",
            "solution": "所陈述的问题具有科学依据、问题明确且内部一致。它提出了一个栅格网格上的标准最低成本路径问题，这是地理信息科学和计算地理学中的一个基本课题。求解唯一解所需的所有参数和定义均已提供。因此，我们可以着手求解。\n\n问题分为两部分：首先，推导累积成本的一般递推关系；其次，应用该原理计算给定栅格上的特定成本。\n\n### 第1部分：累积成本递推关系的推导\n\n在摩擦力网格上寻找从源单元格到所有其他单元格的最小累积成本问题，等同于在加权图上的单源最短路径问题。设图为 $G=(V, E)$，其中顶点集 $V$ 由栅格单元格 $(i,j)$ 的中心点组成，边集 $E$ 连接每个单元格与其 $8$ 个邻居。\n\n从单元格 $(p,q)$ 移动到相邻单元格 $(i,j)$ 的边的成本或权重，由转移成本 $T((p,q), (i,j))$ 给出。根据问题陈述，这是：\n$$\nT((p,q), (i,j)) = \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j))\n$$\n其中 $F(i,j)$ 是单元格 $(i,j)$ 的摩擦力，$d((p,q), (i,j))$ 是单元格中心之间的欧几里得距离。给定单元格大小为 $s$，距离为：\n$$\nd((p,q), (i,j)) =\n\\begin{cases}\ns  \\text{若 } (i,j) \\text{ 是 } (p,q) \\text{ 的正交邻居} \\\\\ns\\sqrt{2}  \\text{若 } (i,j) \\text{ 是 } (p,q) \\text{ 的对角线邻居}\n\\end{cases}\n$$\n单元格 $(i,j)$ 的邻居集合，记为 $\\mathcal{N}(i,j)$，是满足 $\\max(|i-p|, |j-q|) = 1$ 的 $8$ 个单元格 $(p,q)$ 的集合。\n\n累积成本 $C(i,j)$ 是从源单元格 $(i_0, j_0)$ 到单元格 $(i,j)$ 的最短路径成本。其递推关系的推导基于最优性原理（由 Bellman 提出）。该原理指出，如果从 $(i_0, j_0)$ 到 $(i,j)$ 的一条路径是最短路径，那么它的任何子路径也都是最短路径。\n\n考虑从源 $(i_0, j_0)$ 到任意单元格 $(i,j)$ 的一条最短路径。这条路径必定是从其某个邻居，比如 $(p,q) \\in \\mathcal{N}(i,j)$，到达 $(i,j)$ 的。最优性原理意味着从 $(i_0, j_0)$ 到 $(p,q)$ 的那部分路径必须是到 $(p,q)$ 的最短路径。因此，经由 $(p,q)$ 到达 $(i,j)$ 的这条路径的成本，是到达 $(p,q)$ 的最小成本 $C(p,q)$ 与从 $(p,q)$到 $(i,j)$ 的转移成本 $T((p,q), (i,j))$之和。\n\n由于 $C(i,j)$ 必须是最小成本，它必须是从其任何邻居到达的所有可能路径成本中的最小值。这就导出了累积成本的一般递推关系：\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\{ C(p,q) + T((p,q), (i,j)) \\}\n$$\n代入转移成本的定义，我们得到：\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\left\\{ C(p,q) + \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j)) \\right\\}\n$$\n这个递推关系对所有不等于源单元格的单元格 $(i,j)$ 都成立。递推的基准情形是源单元格的成本，定义为零：\n$$\nC(i_0, j_0) = 0\n$$\n这些方程定义了最终累积成本曲面的属性。诸如 Dijkstra 算法或其变体（例如 A*）之类的迭代算法被用来求解这个方程组，并从源开始向外扩展计算成本值。\n\n### 第2部分：累积成本 C(3,3)的计算\n\n我们得到以下特定于问题的数据：\n- 单元格大小 $s=1$。\n- 源单元格 $(i_0, j_0) = (2,2)$。\n- 摩擦力场 $F$：\n$$\nF=\\begin{pmatrix}\n2  3  5 \\\\\n4  1  2 \\\\\n6  2  1\n\\end{pmatrix}\n$$\n这意味着 $F(1,1)=2$, $F(1,2)=3$, $F(1,3)=5$, $F(2,1)=4$, $F(2,2)=1$, $F(2,3)=2$, $F(3,1)=6$, $F(3,2)=2$ 且 $F(3,3)=1$。\n我们的目标是计算 $C(3,3)$。我们将使用 Dijkstra 算法，该算法系统地找出图中从一个源节点到所有其他节点的具有非负边权的最短路径。\n\n1.  **初始化**：\n    源单元格的成本是 $C(2,2) = 0$。所有其他单元格的成本初始化为无穷大。我们维护一个“已访问”单元格的集合，其中最小成本已经确定。初始时，该集合为空。我们使用一个“未访问”单元格的优先队列，按其当前的暂定最小成本排序。\n    - $C(2,2) = 0$。\n    - 对于所有 $(i,j) \\neq (2,2)$，$C(i,j) = \\infty$。\n\n2.  **第一次迭代**：\n    算法选择成本最低的节点，即源 $(2,2)$。我们确定其成本，并更新其 $8$ 个邻居的暂定成本。源的摩擦力是 $F(2,2)=1$。\n\n    -   **到 $(1,1)$ 的路径（对角线）**： $d=\\sqrt{2}$。$F(1,1)=2$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(1,1)}{2}d = 0 + \\frac{1+2}{2}\\sqrt{2} = \\frac{3}{2}\\sqrt{2}$。\n    -   **到 $(1,2)$ 的路径（正交）**： $d=1$。$F(1,2)=3$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(1,2)}{2}d = 0 + \\frac{1+3}{2}(1) = 2$。\n    -   **到 $(1,3)$ 的路径（对角线）**： $d=\\sqrt{2}$。$F(1,3)=5$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(1,3)}{2}d = 0 + \\frac{1+5}{2}\\sqrt{2} = 3\\sqrt{2}$。\n    -   **到 $(2,1)$ 的路径（正交）**： $d=1$。$F(2,1)=4$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(2,1)}{2}d = 0 + \\frac{1+4}{2}(1) = \\frac{5}{2}$。\n    -   **到 $(2,3)$ 的路径（正交）**： $d=1$。$F(2,3)=2$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(2,3)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$。\n    -   **到 $(3,1)$ 的路径（对角线）**： $d=\\sqrt{2}$。$F(3,1)=6$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(3,1)}{2}d = 0 + \\frac{1+6}{2}\\sqrt{2} = \\frac{7}{2}\\sqrt{2}$。\n    -   **到 $(3,2)$ 的路径（正交）**： $d=1$。$F(3,2)=2$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(3,2)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$。\n    -   **到 $(3,3)$ 的路径（对角线）**： $d=\\sqrt{2}$。$F(3,3)=1$。\n        成本 = $C(2,2) + \\frac{F(2,2)+F(3,3)}{2}d = 0 + \\frac{1+1}{2}\\sqrt{2} = \\sqrt{2}$。\n\n3.  **第二次迭代**：\n    现在，源的邻居的暂定成本为：\n    $C(1,1) = \\frac{3\\sqrt{2}}{2} \\approx 2.121$\n    $C(1,2) = 2$\n    $C(1,3) = 3\\sqrt{2} \\approx 4.243$\n    $C(2,1) = 2.5$\n    $C(2,3) = 1.5$\n    $C(3,1) = \\frac{7\\sqrt{2}}{2} \\approx 4.950$\n    $C(3,2) = 1.5$\n    $C(3,3) = \\sqrt{2} \\approx 1.414$\n\n    Dijkstra 算法现在选择具有最小暂定成本的未访问单元格。比较这些值，最小值是 $C(3,3) = \\sqrt{2}$。\n\n    因为我们的目标单元格 $(3,3)$ 是从优先队列中选出的，它的最小成本已经找到。算法保证了这一点，因为所有的边权（转移成本）都是非负的。任何到达 $(3,3)$ 的替代路径都必须经过另一个未访问的单元格 $(p,q)$。然而，在此阶段，所有其他未访问的单元格 $(p,q)$ 的暂定成本 $C(p,q) \\ge C(3,3) = \\sqrt{2}$。因此，任何通过这样一个单元格的路径都不可能产生小于 $\\sqrt{2}$ 的总成本。到 $(3,3)$ 的最短路径是从 $(2,2)$ 直接对角线移动。\n\n因此，$(3,3)$ 处的累积成本就是这条直接路径的成本。\n$$\nC(3,3) = \\sqrt{2}\n$$",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        }
    ]
}