## 引言
栅格代数是地理信息科学（GIS）和[环境建模](@entry_id:1124562)领域的基石，它为描述和分析空间连续变化的现象（如温度、高程和污染物浓度）提供了一套强大而简洁的语言。尽管其应用广泛，许多实践者往往将其视为GIS软件中的“黑箱”工具，缺乏对其背后数学原理、操作假设及潜在陷阱的深刻理解。这种知识上的差距可能导致模型构建中的[隐蔽](@entry_id:196364)错误，从而影响科学结论的有效性。

本文旨在弥合这一差距，为读者提供一个关于栅格代数从理论到实践的系统性深度解析。我们将超越简单的[函数调用](@entry_id:753765)，探索其严谨的科学内涵。在“原理与机制”一章中，我们将建立栅格数据的形式化数学定义，系统地剖析局域、[焦点](@entry_id:174388)、分区和全局四种基本操作类型，并探讨量纲分析、[采样理论](@entry_id:268394)等确保计算有效性的核心机制。接下来，在“应用与跨学科联系”一章中，我们将通过[环境科学](@entry_id:187998)、遥感和生态学等领域的丰富案例，展示这些原理如何被创造性地应用于解决复杂的现实世界问题。最后，通过“动手实践”部分，您将有机会亲手实现关键算法，从而将理论知识转化为稳健的编程与分析能力。通过本次学习，您将能够更具批判性地设计、执行和评估[空间分析](@entry_id:183208)工作流，将您的数据处理和建模技能提升到一个新的水平。

## 原理与机制

本章在前一章“引言”的基础上，深入探讨栅格代数的核心科学原理与计算机制。我们将超越将栅格仅仅视为数字矩阵的简单视角，建立一个严谨的数学框架。通过这一框架，我们将系统地分类和解析栅格操作，并探讨在环境建模中确保计算有效性和物理意义所必须满足的条件。本章旨在为您提供一套用于批判性地评估和设计栅格分析工作流的理论工具。

### 栅格的形式化定义：从索引到物理空间

在计算和环境科学中，一个栅格数据的本质并不仅仅是其像元值的集合，更关键的是它如何与真实世界的物理空间建立联系。为了精确地描述这一点，我们将栅格形式化地定义为一个由两部分组成的数学对象：一个将离散索引映射到数值的函数，以及一个将这些索引映射到地理坐标的变换。

具体来说，一个栅格可以表示为函数 $R: \Omega \to V$，其中：
- $\Omega \subset \mathbb{Z}^2$ 是一个离散的二维整数索引集，例如 $\{(i,j) \mid 1 \le i \le N, 1 \le j \le M\}$，代表了栅格的行和列。
- $V$ 是像元值的集合，对于连续数据（如温度、高程），它可以是实数集 $\mathbb{R}$ 的一个子集；对于[分类数据](@entry_id:202244)（如[土地覆盖](@entry_id:1127047)类型），它可以是一个有限的整数或标签集合。

然而，仅有函数 $R$ 只能定义一个通用的[数字图像](@entry_id:275277)，其内部只有“相邻像元”的拓扑关系，而没有物理距离或面积的概念。为了将其转变为地理[空间数据](@entry_id:924273)，我们必须引入第二个关键组成部分：**地理参考变换 (Georeferencing Transform)**。这是一个函数 $T: \mathbb{Z}^2 \to \mathbb{R}^2$，它将每个离散的像元索引 $(i,j)$ 映射到一个特定[坐标参考系统](@entry_id:1123059)（CRS）下的真实世界平面坐标 $(x,y)$。

这个变换 $T$ 的作用至关重要，它在离散的、基于索引的栅格世界和连续的、基于物理定律的环境模型世界之间架起了一座桥梁。其重要性体现在以下几个方面：

1.  **赋予物理尺度与度量**：变换 $T$ 定义了每个像元的空间“足迹”（footprint）——即其在地球表面的具体位置、形状和大小。由此，我们可以计算出每个像元的物理面积（例如，平方米）和像元中心之间的物理距离（例如，米）。没有 $T$，像元面积和距离将是未定义的。

2.  **支持空间算子计算**：环境模型通常由[偏微分](@entry_id:194612)方程（PDEs）描述，例如[污染物扩散](@entry_id:195534)模型 $\partial_t c = \nabla \cdot (D \nabla c) + S$。这些方程包含梯度($\nabla$)、散度($\nabla \cdot$)等空间算子。要在栅格上近似这些算子，例如用有限差分法计算梯度的 $x$ 分量 $\frac{\partial c}{\partial x} \approx \frac{c(x+\Delta x, y) - c(x, y)}{\Delta x}$，我们必须知道物理间距 $\Delta x$。这个 $\Delta x$ 正是由地理参考变换 $T$ 提供的。没有 $T$，我们只能计算一个无量纲的“索引梯度”，这在物理上是无意义的。

3.  **实现数据整合与重采样**：[环境建模](@entry_id:1124562)几乎总是需要整合来自不同来源的数据（如[卫星影像](@entry_id:1131212)、数字高程模型、土壤图）。这些数据通常具有不同的分辨率、范围和[地图投影](@entry_id:149968)。要将它们叠加分析，必须将它们转换到一个共同的[坐标参考系统](@entry_id:1123059)中。这个称为重投影或重采样的过程，本质上是不同地理参考变换 $T$ 之间的变量代换操作，完全依赖于每个栅格的 $T$ 来实现。

因此，一个地理参考的栅格不仅仅是一个数值矩阵，它是一个嵌入在物理空间中的离散场表示，其科学价值的根基在于地理参考变换 $T$。

### 地[图代数](@entry_id:147078)的语言：操作[分类学](@entry_id:172984)

栅格代数，或称地[图代数](@entry_id:147078)，为处理栅格数据提供了一套强大而简洁的语言。根据每个输出像元值的计算所依赖的输入像元范围，所有栅格操作可以被系统地分为四类：局域（Local）、[焦点](@entry_id:174388)（Focal）、分区（Zonal）和全局（Global）操作。 我们可以用“依赖集” $D_{i,j}$ 的概念来精确定义这四类操作，其中 $D_{i,j}$ 是计算输出像元 $E(i,j)$ 时所需要的所有输入像元索引的集合。

#### 局域操作 (Local Operations)

局域操作是最简单的一类，其输出栅格在位置 $(i,j)$ 处的值 $E(i,j)$ 仅依赖于输入栅格在同一位置 $(i,j)$ 处的值。其依赖集是单点集：$D_{i,j} = \{(i,j)\}$。

形式上，对于 $n$ 个输入栅格 $R_1, \dots, R_n$，一个局域操作可以表示为：
$$ E(i,j) = f(R_1(i,j), R_2(i,j), \dots, R_n(i,j)) $$
这个表达式的成立基于一个重要的**对齐假设 (alignment assumption)**：所有输入栅格共享相同的地理参考、分辨率和范围，即它们拥有共同的索引集 $I$。

在实践中，执行局域操作需要关注两个关键的机制问题：

**1. 无数据 (NoData) 值的处理**
真实世界的地理数据常常存在缺失。栅格数据中用一个特殊的**NoData**符号（在形式化定义中记为 $\bot$）来标记这些观测缺失的像元。NoData 不是一个数值（例如 0），而是一个状态，表示“值未知”。在栅格代数中，NoData 的处理规则至关重要，它通常具有“传染性”：如果任何一个参与局域运算的输入像元为 NoData，则输出像元也为 NoData。

将缺失观测错误地编码为数值（如 0）而不是 NoData，可能会导致严重的分析偏差。 考虑一个计算流域总降水量的例子。假设一个 $3 \times 3$ 的栅格中，有 6 个像元有降水观测值（其中一个为 $0\,\mathrm{mm}$），另外 3 个像元因雷达扫描不到而缺失观测。
- **场景一（使用NoData）**：分析师将缺失值设为 NoData。当计算流域平均降雨量时，GIS软件会忽略这 3 个 NoData 像元，仅基于 6 个有效像元计算均值。然后，它可能会错误地将这个均值外推到整个流域（9个像元）来估算总体积，这引入了一种基于“有效数据代表整体”假设的估算偏差。
- **场景二（使用0填充）**：分析师将缺失值设为 $0\,\mathrm{mm}$。这错误地断言了这些区域没有降雨。当计算平均值时，这 3 个 0 值会拉低整体均值，导致对总体积的严重低估。
在计算“湿润区比例”（降雨量 $\ge$ 某个阈值的面积占比）时，两种处理方式也会得出截然不同的结论。将缺失值设为 0 会错误地将这些区域归为“干旱区”，而使用 NoData 则会将它们排除在比例计算的分母之外，同样导致结果的偏差。这个例子清楚地表明，正确使用 NoData 来表示观测的缺失，而非用一个数值来表示“不存在”，是保证科学结论有效性的基本前提。

**2. 物理单位与量纲分析**
栅格像元值通常代表有单位的物理量。栅格代数必须遵循严格的**量纲分析 (dimensional analysis)** 规则，以避免物理上无意义的操作。
- **加减法**：只允许在具有相同物理量纲的栅格之间进行。例如，将以[摄氏度](@entry_id:141511)（$^{\circ}\mathrm{C}$）为单位的温度栅格与以毫米（$\mathrm{mm}$）为单位的降水栅格相加是无效的，即使它们都是数值。因为它们的量纲——温度（$\Theta$）和长度（$L$）——不匹配。
- **乘除法**：可以对不同量纲的栅格进行，结果会产生新的复合量纲。例如，将一个无量纲的归一化植被指数（NDVI）栅格与一个降水（$L$）栅格相乘是有效的操作。其结果的量纲仍然是长度 $L$，物理意义上可以解释为“经植被状态调节后的降水量”。
- **[超越函数](@entry_id:271750)**（如 `log`, `exp`, `sin`）：这些函数的参数必须是无量纲的。例如，直接对一个以 $\mathrm{mm}$ 为单位的降水栅格 $P$ 取对数（$\ln(P)$）是无效的。正确的做法是先将其转换为无量纲比值，例如除以一个基准降水量 $P_0$（如 $1\,\mathrm{mm}$），然后再取对数 $\ln(P/P_0)$。

此外，还需注意**标度类型 (scale types)**。开尔文（K）等**比率标度 (ratio scale)** 具有绝对零点，支持乘除运算。而摄氏度（$^{\circ}\mathrm{C}$）等**仿射标度 (affine scale)** 或区间标度 (interval scale) 的零点是任意设定的，直接进行乘除运算是无意义的。例如，$20\,^{\circ}\mathrm{C}$ 并不是 $10\,^{\circ}\mathrm{C}$ 的两倍热。然而，温度的 *变化量*（如温度异常 $\Delta T$）则表现为比率标度，一个 $10\,^{\circ}\mathrm{C}$ 的温差等于一个 $10\,\mathrm{K}$ 的温差。

#### [焦点](@entry_id:174388)操作 (Focal Operations)

[焦点](@entry_id:174388)操作（或称邻域操作）的输出值 $E(i,j)$ 依赖于输入栅格上以 $(i,j)$ 为中心的某个邻域内的像元值。其依赖集 $D_{i,j} = N(i,j)$，其中 $N(i,j)$ 是一个围绕 $(i,j)$ 的邻域。典型的例子包括用于平滑的均值滤波器、用于去噪的[中值滤波器](@entry_id:264182)，以及用于[形态学](@entry_id:273085)分析的膨胀和腐蚀算子。

**1. 线性与[非线性](@entry_id:637147)[焦点](@entry_id:174388)操作**
[焦点](@entry_id:174388)操作可以根据其数学性质分为线性和[非线性](@entry_id:637147)两类，这决定了它们的行为和分析方法。
- **线性[焦点](@entry_id:174388)操作**：满足[叠加原理](@entry_id:144649)（即 $\mathcal{T}\{\alpha x + \beta y\} = \alpha \mathcal{T}\{x\} + \beta \mathcal{T}\{y\}$）的操作。最常见的线性[焦点](@entry_id:174388)操作是**卷积 (convolution)**。一个 $3 \times 3$ 的均值滤波器就是一个例子，它将输入栅格与一个所有元素均为 $1/9$ 的核进行卷积。
  对于**线性移不变 (Linear Shift-Invariant, LSI)** 系统，我们可以用强大的[傅里叶分析](@entry_id:137640)工具来研究其特性。它的行为完全可以由其**冲激响应**（对单个脉冲输入的响应）$h[n,m]$ 或等价地由其**频率响应**（冲激响应的傅里叶变换）$H(\omega_x, \omega_y)$ 来描述。例如，$3 \times 3$ 均值滤波器的冲激响应是一个 $3 \times 3$ 的、值为 $1/9$ 的[矩形脉冲](@entry_id:273749)，其[频率响应](@entry_id:183149)是一个二维的 `sinc` [类函数](@entry_id:146970) $H(\omega_x, \omega_y) = \frac{1}{9}(1+2\cos\omega_x)(1+2\cos\omega_y)$。[频率响应](@entry_id:183149)告诉我们滤波器如何放大或衰减不同[空间频率](@entry_id:270500)的信号成分，这对于理解其平滑特性至关重要。
- **[非线性](@entry_id:637147)[焦点](@entry_id:174388)操作**：不满足[叠加原理](@entry_id:144649)的操作。一个典型的例子是 $3 \times 3$ **[中值滤波器](@entry_id:264182)**，它输出邻域内 9 个值的**中位数**。[中值滤波器](@entry_id:264182)在去除脉冲噪声（椒盐噪声）方面非常有效，且相比均值滤波器能更好地保留边缘。然而，由于它是[非线性](@entry_id:637147)的，我们不能用冲激响应或[频率响应](@entry_id:183149)来完整描述它。事实上，如果对一个仅在原点为 1、其余为 0 的脉冲图像应用中值滤波，输出将是全[零图](@entry_id:275064)像。这说明传统的[LSI系统](@entry_id:274179)分析方法在此失效，需要依赖排序统计等其他数学工具。

**2. 数学[形态学](@entry_id:273085)**
数学[形态学](@entry_id:273085)是一套基于[集合论](@entry_id:137783)的[非线性](@entry_id:637147)[焦点](@entry_id:174388)操作理论，为形状分析提供了强大工具。其基本操作是**膨胀 (Dilation)** 和 **腐蚀 (Erosion)**。 对于灰度栅格 $R$ 和一个称为**结构元 (structuring element)** $B$ 的邻域核，它们可以定义为：
- **膨胀**：$(R \oplus B)(i,j) = \sup_{(u,v) \in B} \{R(i-u, j-v)\}$，即取结构元覆盖范围内输入像元的最大值。其效果是使亮区扩大，暗区缩小。
- **腐蚀**：$(R \ominus B)(i,j) = \inf_{(u,v) \in B} \{R(i+u, j+v)\}$，即取结构元覆盖范围内输入像元的最小值。其效果是使亮区缩小，暗区扩大。

膨胀和腐蚀之间存在深刻的**对偶性 (duality)**。定义一个补运算 $C_M(R) = M - R$（其中 $M$ 是栅格的最大值）和结构元的反射 $B^r = \{(-u,-v) \mid (u,v) \in B\}$，可以证明腐蚀一个图像等价于先对图像取补，用反射的结构元进行膨胀，再对结果取补。即：$(R \ominus B) = C_M((C_M(R) \oplus B^r))$。这一对偶关系是[形态学](@entry_id:273085)理论的基石。

**3. 边界效应**
当[焦点](@entry_id:174388)操作的邻域窗口移动到栅格边缘时，部分窗口会悬在栅格之外，导致计算无法直接进行。必须采用一种**边界条件 (boundary condition)** 来填充这些缺失的值。 常见的边界条件包括：
- **[零填充](@entry_id:637925) (Zero-padding)**：在外部填充 0。
- **常数扩展 (Constant extension)**：复制边缘像元的值。
- **镜像反射 (Mirror reflection)**：以边界为镜，反射内部的像元值。
- **周期包裹 (Periodic wrap)**：将栅格视为一个环面，从一侧出去的值从对侧进入。

不同的边界条件会在栅格边缘引入不同的**系统性偏差**。例如，对一个值随坐标线性增加的斜坡状栅格 $x_{i,j} = \alpha i + \beta j + \gamma$ 应用 $3 \times 3$ 均值滤波器，在左上角 $(1,1)$ 处，各种边界条件产生的偏差均可精确计算。[零填充](@entry_id:637925)会引入一个与斜坡系数 $\alpha, \beta$ 和截距 $\gamma$ 都有关的负偏差；镜像反射和常数扩展则会引入与斜坡系数成正比的正偏差；而周期包裹的偏差则与整个栅格的尺寸 $N, M$ 相关。在进行高精度建模时，理解并量化这些边缘诱导的偏差是至关重要的。一种严谨的测试方法是，生成具有已知解析形式（如线性斜坡）的合成栅格作为“地面真理”，应用不同边界条件的滤波器，然后逐像元计算输出与真理值之间的差异，并用均方根误差（RMSE）等指标来量化边缘区域的偏差。

#### 分区操作 (Zonal Operations)

分区操作的输出值 $E(i,j)$ 依赖于所有与 $(i,j)$ 位于同一“区域”（zone）的输入像元值。区域由一个单独的、与输入栅格对齐的分类栅格（或称“分区栅格”）$L$ 来定义。对于任意像元 $(i,j)$，其依赖集是所有具有相同分区标签的像元集合：$D_{i,j} = \{(u,v) \mid L(u,v) = L(i,j)\}$。

分区的典型应用是**分区统计 (zonal statistics)**，例如，计算每个[土地覆盖](@entry_id:1127047)类型（区域）内的平均高程（值）。所有属于同一土地覆盖类型的像元，其输出值（该区域的平均高程）将是相同的。

一个科学上**稳健 (robust)** 的分区统计聚合函数 $\phi$ 应具备一些理想的数学性质，以确保其在不同数据条件下的可靠性和可解释性。
- **排列[不变性](@entry_id:140168) (Permutation invariance)**：输出不应依赖于区域内像元值的[计算顺序](@entry_id:749112)。
- **仿射[等变性](@entry_id:636671) (Affine equivariance)**：如果输入值经过线性变换 $ax_i+b$（例如，从摄氏度到华氏度的[单位转换](@entry_id:136593)），输出也应相应地进行同样的线性变换，即 $\phi(\{ax_i+b\}) = a\phi(\{x_i\}) + b$。均值（mean）具备此性质，这保证了统计结果在单位变换下的一致性。
- **抗离群点性 (Resistance to outliers)**：统计结果不应被少数极端异常值过度影响。中位数（median）在这方面远优于均值，它具有很高的**击穿点 (breakdown point)**，意味着需要污染近一半的数据才能使其结果任意偏离。
- **对噪声的稳定性 (Stability under noise)**：输入中的微小扰动（如传感器噪声）应只对输出产生微小的影响。

#### 全局操作 (Global Operations)

全局操作是最广泛的一类，其在任何位置 $(i,j)$ 的输出值都可能依赖于输入栅格中的**所有**像元。其依赖集是整个栅格的索引集：$D_{i,j} = I$。

全局操作的例子包括：
- **栅格[标准化](@entry_id:637219)**：计算整个栅格的均值 $\mu$ 和标准差 $\sigma$，然后对每个像元应用变换 $y_i = (x_i - \mu) / \sigma$。每个输出值 $y_i$ 都依赖于全局统计量 $\mu$ 和 $\sigma$，因此依赖于所有输入像元。
- **[经验累积分布函数](@entry_id:167083) (ECDF) 计算**：计算每个像元值 $x_i$ 在整个栅格中的排序或分位数，即 $y_i = F(x_i) = \frac{1}{|\Omega|} \sum_{j \in \Omega} \mathbf{1}\{x_j \le x_i\}$。这本质上是[直方图均衡化](@entry_id:905440)的一种形式。
- **距离变换**：计算每个像元到某个特定源像元或一组源像元的欧氏距离或其他距离。例如，欧氏距离变换的输出 $Y(i) = \min_{j \in \text{sources}} d(i,j)$，其计算需要考虑所有可能的路径，因此是全局的。

### 从连续场到离散栅格：采样与重采样

栅格数据本质上是对连续现实世界的一种离散化近似。这个从连续到离散的转换过程——采样，以及在不同离散化方案之间转换的过程——[重采样](@entry_id:142583)，都遵循着信号处理的基本原理。

#### 采样、[混叠](@entry_id:146322)与[奈奎斯特定理](@entry_id:270181)

将一个连续的空间场（如地表温度）转换为栅格的过程，可以视为在规则网格上对该场进行**采样 (sampling)**。采样的保真度受限于著名的**奈奎斯特-香农采样定理 (Nyquist-Shannon sampling theorem)**。

该定理指出，为了无损地重建一个连续信号，采样频率必须至少是被采样信号最高频率的两倍。在二维空间中，这意味着对于一个在 $x$ 和 $y$ 方向上的最高频率分别为 $f_{x,\max}$ 和 $f_{y,\max}$ 的场，我们的采样间距 $s_x$ 和 $s_y$ 必须满足：
$$ \frac{1}{s_x} > 2f_{x,\max} \quad \text{and} \quad \frac{1}{s_y} > 2f_{y,\max} $$
如果该条件不被满足（即采样过于稀疏），就会发生**[混叠](@entry_id:146322) (aliasing)**。[混叠](@entry_id:146322)是一种[信号失真](@entry_id:269932)，高频信息会“折叠”并伪装成低频信息。在图像中，这通常表现为[莫列波纹](@entry_id:276058) (moiré patterns)，例如，精细的[平行线](@entry_id:169007)纹理在[欠采样](@entry_id:926727)后可能会显示为粗大的、方向怪异的波纹。

在进行**[降采样](@entry_id:265757) (downsampling)**（即从高分辨率栅格创建低分辨率栅格）时，同样需要警惕[混叠](@entry_id:146322)。一个常见的[降采样](@entry_id:265757)流程是：先进行一次[焦点](@entry_id:174388)平均（作为**[抗混叠](@entry_id:636139)预滤波器**），然后进行抽取（例如，每 $N$ 个像元保留一个）。为了确保[降采样](@entry_id:265757)后的栅格不产生混叠，新的、更稀疏的采样率（$F_{s,x} = 1/(N_x s_x)$）必须仍然满足关于原始信号最高频率的[奈奎斯特定理](@entry_id:270181)。例如，如果一个原始信号的最高频率为 $f_{x,\max} = 0.3\,\text{cycles/m}$，采样间距为 $s_x = 0.25\,\text{m}$，那么为了在[降采样](@entry_id:265757)后避免[混叠](@entry_id:146322)，[降采样因子](@entry_id:268100) $N_x$ 必须满足 $1/(N_x s_x) \ge 2f_{x,\max}$，由此可以计算出 $N_x$ 的最大允许整数值。

#### 原则性的数据整合策略

在实际应用中，我们经常需要整合具有不同分辨率、范围和[坐标参考系统](@entry_id:1123059)的栅格数据。这个过程涉及重投影和[重采样](@entry_id:142583)，如果处理不当，会引入严重的错误。设计一个**原则性的 (principled)** 工作流至关重要。

考虑一个典型任务：估算一个流域内森林区域的总降水量。我们有一个粗分辨率（如 $1\,\text{km}$）的降水栅格 $P$ 和一个精细分辨率（如 $30\,\text{m}$）的土地覆盖栅格 $L$。一个稳健的策略应遵循以下步骤：

1.  **选择目标[坐标参考系统](@entry_id:1123059)**：由于任务涉及面积计算（总降水量 = 降水深度 $\times$ 面积），必须将所有[数据转换](@entry_id:170268)到一个**等面积投影 (equal-area projection)** 下。例如，针对特定区域定制的阿尔伯斯[等积投影](@entry_id:268830)（Albers Equal Area）可以最大限度地减少面积畸变。

2.  **选择分析格网**：我们面临一个选择：是将粗糙的降水栅格 $P$ 重采样到精细的[土地覆盖](@entry_id:1127047)格网，还是反之？关键原则是**尽量避免对主要物理量测量数据进行不必要的插值**。降水栅格 $P$ 的每个像元值是该 $1\,\text{km}^2$ 区域内的平均测量值，将其用插值方法（如[双线性](@entry_id:146819)或三次卷积）“细化”到 $30\,\text{m}$ 分辨率，会制造出虚假的、不存在的细节，并可能改变总量。

3.  **设计最佳工作流**：更优的策略是保持粗糙的降水栅格 $P$ 的格网作为分析的基本单元。具体流程如下：
    a. 将两个栅格都重投影到选定的等面积投影下。
    b. 对于每一个粗糙的降水像元 $\Omega_i$，我们直接使用其给定的降水值 $P_i$ 和其在等面积投影下的真实面积 $A_i$。
    c. 通过将精细的[土地覆盖](@entry_id:1127047)栅格 $L$ 叠加到粗糙的降水格网之上，精确计算每个粗像元 $\Omega_i$ 内部森林覆盖的**面积分数** $f_i$（例如，通过统计落入 $\Omega_i$ 内的森林像元总面积并除以 $A_i$）。
    d. 最终的总降水量估算为一个面积加权和：$\text{Total Precipitation} \approx \sum_i (P_i \cdot f_i \cdot A_i)$。

这个策略最大限度地保留了原始数据的完整性：它不对主要测量值 $P$ 进行插值，并利用了土地覆盖数据 $L$ 的高分辨率信息来精确地划分面积权重。这是在多源栅格数据融合中减少[插值误差](@entry_id:139425)、保证物理量守恒的典范方法。