{
    "hands_on_practices": [
        {
            "introduction": "图像与地图配准的核心在于建立两者坐标系之间的数学关系。仿射变换作为一种基础的几何模型，通过少数几个控制点就能有效地描述平移、旋转、缩放和剪切等形变。本练习将通过一个实际场景，指导你利用三个非共线的地面控制点，从第一性原理出发推导出唯一的仿射变换矩阵，从而将无人机影像精确地配准到地图上。这个过程不仅能加深你对坐标变换背后线性代数原理的理解，也是后续学习更复杂模型的重要基础。",
            "id": "3821081",
            "problem": "一幅小型无人机（UAV）影像必须配准到局部地图上，以用于漫滩生境建模。现有三个非共线的地面控制点（GCPs），其在影像中的像素坐标和在局部地图参考框架中的相应坐标均已知。影像坐标（单位：像素）为：$\\mathbf{p}_{I,1} = \\begin{pmatrix}120 \\\\ 80\\end{pmatrix}$，$\\mathbf{p}_{I,2} = \\begin{pmatrix}420 \\\\ 80\\end{pmatrix}$，以及 $\\mathbf{p}_{I,3} = \\begin{pmatrix}120 \\\\ 380\\end{pmatrix}$。相应的地图坐标（单位：米）为：$\\mathbf{p}_{M,1} = \\begin{pmatrix}325 \\\\ -44\\end{pmatrix}$，$\\mathbf{p}_{M,2} = \\begin{pmatrix}925 \\\\ -344\\end{pmatrix}$，以及 $\\mathbf{p}_{M,3} = \\begin{pmatrix}625 \\\\ 256\\end{pmatrix}$。\n\n假设一个平面的仿射图像到地图模型为 $\\mathbf{p}_{M} = A\\,\\mathbf{p}_{I} + \\mathbf{t}$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 且 $\\mathbf{t} \\in \\mathbb{R}^{2}$。仅使用仿射变换的基本定义以及由非共线性所蕴含的点差分的线性无关性，推导出将这三个图像点映射到其对应地图点的唯一仿射变换 $(A,\\mathbf{t})$。然后，通过计算 $\\det(A)$ 来正式验证其可逆性，并将其解释为配准下的局部面积缩放因子。\n\n请将 $\\det(A)$ 的精确数值作为您的最终答案。将行列式表示为一个纯数，其单位为平方米/平方像素，答案中不要包含任何单位符号。无需四舍五入；报告精确值。",
            "solution": "该问题要求确定一个唯一的仿射变换 $(A, \\mathbf{t})$，该变换将一组三个非共线的图像点映射到一组对应的地图点。该变换由方程 $\\mathbf{p}_{M} = A\\,\\mathbf{p}_{I} + \\mathbf{t}$ 定义，其中 $\\mathbf{p}_{I}$ 是图像坐标，$\\mathbf{p}_{M}$ 是地图坐标，$A \\in \\mathbb{R}^{2 \\times 2}$ 是线性变换矩阵，$\\mathbf{t} \\in \\mathbb{R}^{2}$ 是平移向量。\n\n给定的对应点如下：\n图像坐标（单位：像素）：\n$$ \\mathbf{p}_{I,1} = \\begin{pmatrix}120 \\\\ 80\\end{pmatrix}, \\quad \\mathbf{p}_{I,2} = \\begin{pmatrix}420 \\\\ 80\\end{pmatrix}, \\quad \\mathbf{p}_{I,3} = \\begin{pmatrix}120 \\\\ 380\\end{pmatrix} $$\n地图坐标（单位：米）：\n$$ \\mathbf{p}_{M,1} = \\begin{pmatrix}325 \\\\ -44\\end{pmatrix}, \\quad \\mathbf{p}_{M,2} = \\begin{pmatrix}925 \\\\ -344\\end{pmatrix}, \\quad \\mathbf{p}_{M,3} = \\begin{pmatrix}625 \\\\ 256\\end{pmatrix} $$\n\n仿射关系对每一对对应点都成立：\n$1.$ $\\mathbf{p}_{M,1} = A\\mathbf{p}_{I,1} + \\mathbf{t}$\n$2.$ $\\mathbf{p}_{M,2} = A\\mathbf{p}_{I,2} + \\mathbf{t}$\n$3.$ $\\mathbf{p}_{M,3} = A\\mathbf{p}_{I,3} + \\mathbf{t}$\n\n为了分离出矩阵 $A$，我们可以通过考虑点之间的差分来消除平移向量 $\\mathbf{t}$。将方程($1$)从方程($2$)和($3$)中减去，得到：\n$$ \\mathbf{p}_{M,2} - \\mathbf{p}_{M,1} = (A\\mathbf{p}_{I,2} + \\mathbf{t}) - (A\\mathbf{p}_{I,1} + \\mathbf{t}) = A(\\mathbf{p}_{I,2} - \\mathbf{p}_{I,1}) $$\n$$ \\mathbf{p}_{M,3} - \\mathbf{p}_{M,1} = (A\\mathbf{p}_{I,3} + \\mathbf{t}) - (A\\mathbf{p}_{I,1} + \\mathbf{t}) = A(\\mathbf{p}_{I,3} - \\mathbf{p}_{I,1}) $$\n\n让我们定义差分向量：\n在图像空间中：\n$$ \\Delta\\mathbf{p}_{I,21} = \\mathbf{p}_{I,2} - \\mathbf{p}_{I,1} = \\begin{pmatrix}420 - 120 \\\\ 80 - 80\\end{pmatrix} = \\begin{pmatrix}300 \\\\ 0\\end{pmatrix} $$\n$$ \\Delta\\mathbf{p}_{I,31} = \\mathbf{p}_{I,3} - \\mathbf{p}_{I,1} = \\begin{pmatrix}120 - 120 \\\\ 380 - 80\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 300\\end{pmatrix} $$\n在地图空间中：\n$$ \\Delta\\mathbf{p}_{M,21} = \\mathbf{p}_{M,2} - \\mathbf{p}_{M,1} = \\begin{pmatrix}925 - 325 \\\\ -344 - (-44)\\end{pmatrix} = \\begin{pmatrix}600 \\\\ -300\\end{pmatrix} $$\n$$ \\Delta\\mathbf{p}_{M,31} = \\mathbf{p}_{M,3} - \\mathbf{p}_{M,1} = \\begin{pmatrix}625 - 325 \\\\ 256 - (-44)\\end{pmatrix} = \\begin{pmatrix}300 \\\\ 300\\end{pmatrix} $$\n\n这两个向量方程，$\\Delta\\mathbf{p}_{M,21} = A \\Delta\\mathbf{p}_{I,21}$ 和 $\\Delta\\mathbf{p}_{M,31} = A \\Delta\\mathbf{p}_{I,31}$，可以通过构建以这些差分向量为列的矩阵，合并成一个单一的矩阵方程：\n$$ \\begin{pmatrix} \\Delta\\mathbf{p}_{M,21}  \\Delta\\mathbf{p}_{M,31} \\end{pmatrix} = A \\begin{pmatrix} \\Delta\\mathbf{p}_{I,21}  \\Delta\\mathbf{p}_{I,31} \\end{pmatrix} $$\n令 $P_M = \\begin{pmatrix} \\Delta\\mathbf{p}_{M,21}  \\Delta\\mathbf{p}_{M,31} \\end{pmatrix}$ 且 $P_I = \\begin{pmatrix} \\Delta\\mathbf{p}_{I,21}  \\Delta\\mathbf{p}_{I,31} \\end{pmatrix}$。方程为 $P_M = A P_I$。\n代入计算出的值：\n$$ \\begin{pmatrix} 600  300 \\\\ -300  300 \\end{pmatrix} = A \\begin{pmatrix} 300  0 \\\\ 0  300 \\end{pmatrix} $$\n问题陈述了这些点是非共线的，这意味着在每个空间中的差分向量都是线性无关的。这确保了矩阵 $P_I$ 是可逆的。我们可以通过右乘 $P_I$ 的逆矩阵来求解 $A$：\n$$ A = P_M P_I^{-1} $$\n首先，我们求 $P_I^{-1}$：\n$$ P_I = \\begin{pmatrix} 300  0 \\\\ 0  300 \\end{pmatrix} = 300 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = 300 I $$\n其逆矩阵为：\n$$ P_I^{-1} = \\frac{1}{300} I^{-1} = \\frac{1}{300} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{300}  0 \\\\ 0  \\frac{1}{300} \\end{pmatrix} $$\n现在，我们计算 $A$：\n$$ A = \\begin{pmatrix} 600  300 \\\\ -300  300 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{300}  0 \\\\ 0  \\frac{1}{300} \\end{pmatrix} = \\begin{pmatrix} 600 \\cdot \\frac{1}{300}  300 \\cdot \\frac{1}{300} \\\\ -300 \\cdot \\frac{1}{300}  300 \\cdot \\frac{1}{300} \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ -1  1 \\end{pmatrix} $$\n找到 $A$ 后，我们可以使用第一对对应点来求解 $\\mathbf{t}$：$\\mathbf{t} = \\mathbf{p}_{M,1} - A\\mathbf{p}_{I,1}$。\n$$ \\mathbf{t} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 2  1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 2(120) + 1(80) \\\\ -1(120) + 1(80) \\end{pmatrix} $$\n$$ \\mathbf{t} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 240 + 80 \\\\ -120 + 80 \\end{pmatrix} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 320 \\\\ -40 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ -4 \\end{pmatrix} $$\n因此，唯一的仿射变换由 $A = \\begin{pmatrix} 2  1 \\\\ -1  1 \\end{pmatrix}$ 和 $\\mathbf{t} = \\begin{pmatrix} 5 \\\\ -4 \\end{pmatrix}$ 指定。\n\n最后一步是验证变换的可逆性并解释 $A$ 的行列式。一个变换是可逆的，当且仅当其线性部分（由矩阵 $A$ 表示）是可逆的。这成立的条件是当且仅当 $\\det(A) \\ne 0$。\n让我们计算 $A$ 的行列式：\n$$ \\det(A) = \\det\\begin{pmatrix} 2  1 \\\\ -1  1 \\end{pmatrix} = (2)(1) - (1)(-1) = 2 + 1 = 3 $$\n因为 $\\det(A) = 3 \\ne 0$，所以矩阵 $A$ 是可逆的，因此仿射变换也是可逆的。存在一个唯一的逆变换，可以将点从地图映射回图像。\n\n变换矩阵 $A$ 的行列式表示输出空间（地图）与输入空间（图像）之间面积元素的比率。在此背景下，图像空间的单位是像素（px），地图空间的单位是米（m）。行列式 $\\det(A)$ 的单位是（平方米）/（平方像素），即 $\\text{m}^2/\\text{px}^2$。\n值 $\\det(A) = 3$ 表示图像中 $1$ 平方像素的单位面积对应于地图上 $3$ 平方米的面积。行列式的正号表示该变换是保向的，意味着它不包含反射。\n所要求的最终答案是 $\\det(A)$ 的数值。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "随着遥感技术的发展，简单的几何模型已不足以精确描述现代高分辨率卫星传感器的成像过程。有理多项式相机（RPC）模型作为一种通用的传感器模型，在业界得到了广泛应用。本练习将带你深入RPC模型的内部工作机制，通过具体的系数和地面点坐标，计算出其在影像上的精确位置，并进一步分析高程误差对定位精度的影响。通过这种方式，你将掌握应用复杂传感器模型进行地理配准的实用技能，并学会评估模型对输入数据误差的敏感性。",
            "id": "3821027",
            "problem": "一张卫星图像使用有理多项式相机 (RPC) 模型进行地理配准。数字高程模型 (DEM) 提供了地面高程。给定以下行坐标映射的设置。归一化地面坐标定义为 $$L=\\frac{\\phi-\\phi_{0}}{\\phi_{\\mathrm{scale}}},\\quad S=\\frac{\\lambda-\\lambda_{0}}{\\lambda_{\\mathrm{scale}}},\\quad H=\\frac{Z-Z_{0}}{Z_{\\mathrm{scale}}},$$ 其中 $\\phi$ 是纬度（单位：度），$\\lambda$ 是经度（单位：度），$Z$ 是高程（单位：米）。归一化行坐标由两个多项式的比值给出 $$l_{n}(L,S,H)=\\frac{P(L,S,H)}{Q(L,S,H)},$$ 其中 $$P(L,S,H)=a_{0}+a_{1}L+a_{2}S+a_{3}H+a_{4}LS+a_{5}LH+a_{6}SH+a_{7}L^{2}+a_{8}S^{2}+a_{9}H^{2},$$ $$Q(L,S,H)=1+b_{1}L+b_{2}S+b_{3}H+b_{4}L^{2}+b_{5}S^{2}.$$ 以像素为单位的实际行坐标为 $$\\text{line}=\\text{line}_{\\mathrm{offset}}+\\text{line}_{\\mathrm{scale}}\\;l_{n}(L,S,H).$$ 用于行映射的有理多项式相机 (RPC) 系数和归一化参数如下：\n$$a_{0}=0.001,\\;a_{1}=0.020,\\;a_{2}=-0.015,\\;a_{3}=0.010,\\;a_{4}=0.005,\\;a_{5}=-0.004,\\;a_{6}=0.003,\\;a_{7}=0.010,\\;a_{8}=-0.008,\\;a_{9}=0.002,$$\n$$b_{1}=0.010,\\;b_{2}=-0.020,\\;b_{3}=0.005,\\;b_{4}=0.003,\\;b_{5}=0.002,$$\n$$\\phi_{0}=37.5,\\;\\phi_{\\mathrm{scale}}=0.05,\\;\\lambda_{0}=-122.2,\\;\\lambda_{\\mathrm{scale}}=0.05,\\;Z_{0}=100,\\;Z_{\\mathrm{scale}}=100,$$\n$$\\text{line}_{\\mathrm{offset}}=5000,\\;\\text{line}_{\\mathrm{scale}}=5000.$$\n考虑一个地面点，其纬度和经度为 $$\\phi=37.52,\\quad \\lambda=-122.18,$$ 高程为 $$Z=150.$$ 从上述归一化坐标和有理多项式相机 (RPC) 映射的标准定义出发，计算：\n- 以像素为单位的行图像坐标，以及\n- 行坐标对 DEM 高程误差的局部灵敏度，即在给定地面点处求值的偏导数 $$\\frac{\\partial\\,\\text{line}}{\\partial Z}$$。\n\n以像素表示最终的行坐标，以像素/米表示其导数。将您的数值结果四舍五入到四位有效数字。将包含这两个量的最终答案以单行矩阵的形式给出，顺序为：行坐标，然后是 $\\frac{\\partial\\,\\text{line}}{\\partial Z}$。",
            "solution": "有理多项式相机 (RPC) 模型通过一个有理函数将归一化地面坐标映射到归一化图像坐标，然后通过应用给定的偏移量和比例因子来获得图像行坐标。根据定义 $$L=\\frac{\\phi-\\phi_{0}}{\\phi_{\\mathrm{scale}}},\\quad S=\\frac{\\lambda-\\lambda_{0}}{\\lambda_{\\mathrm{scale}}},\\quad H=\\frac{Z-Z_{0}}{Z_{\\mathrm{scale}}},$$ 我们首先计算指定地面点的归一化坐标。使用给定值 $$\\phi=37.52,\\;\\phi_{0}=37.5,\\;\\phi_{\\mathrm{scale}}=0.05,$$ $$\\lambda=-122.18,\\;\\lambda_{0}=-122.2,\\;\\lambda_{\\mathrm{scale}}=0.05,$$ $$Z=150,\\;Z_{0}=100,\\;Z_{\\mathrm{scale}}=100,$$ 我们得到\n$$L=\\frac{37.52-37.5}{0.05}=\\frac{0.02}{0.05}=0.4,$$\n$$S=\\frac{-122.18-(-122.2)}{0.05}=\\frac{0.02}{0.05}=0.4,$$\n$$H=\\frac{150-100}{100}=\\frac{50}{100}=0.5.$$\n接下来，使用以下公式计算分子多项式 $P(L,S,H)$\n$$P(L,S,H)=a_{0}+a_{1}L+a_{2}S+a_{3}H+a_{4}LS+a_{5}LH+a_{6}SH+a_{7}L^{2}+a_{8}S^{2}+a_{9}H^{2}.$$\n计算所需的单项式：\n$$LS=0.4\\times 0.4=0.16,\\quad LH=0.4\\times 0.5=0.2,\\quad SH=0.4\\times 0.5=0.2,$$\n$$L^{2}=0.4^{2}=0.16,\\quad S^{2}=0.4^{2}=0.16,\\quad H^{2}=0.5^{2}=0.25.$$\n使用给定的系数，\n\n$$\n\\begin{aligned}\nP=0.001+0.020(0.4)+(-0.015)(0.4)+0.010(0.5)+0.005(0.16)+(-0.004)(0.2)+0.003(0.2)\\\\\n\\quad+0.010(0.16)+(-0.008)(0.16)+0.002(0.25)\\\\\n=0.001+0.008-0.006+0.005+0.0008-0.0008+0.0006+0.0016-0.00128+0.0005\\\\\n=0.00942.\n\\end{aligned}\n$$\n\n现在，使用以下公式计算分母多项式 $Q(L,S,H)$\n$$Q(L,S,H)=1+b_{1}L+b_{2}S+b_{3}H+b_{4}L^{2}+b_{5}S^{2}.$$\n代入可得\n\n$$\n\\begin{aligned}\nQ=1+0.010(0.4)+(-0.020)(0.4)+0.005(0.5)+0.003(0.16)+0.002(0.16)\\\\\n=1+0.004-0.008+0.0025+0.00048+0.00032\\\\\n=0.9993.\n\\end{aligned}\n$$\n\n则归一化行坐标为\n$$l_{n}=\\frac{P}{Q}=\\frac{0.00942}{0.9993}.$$\n为了计算以像素为单位的图像行坐标，\n$$\\text{line}=\\text{line}_{\\mathrm{offset}}+\\text{line}_{\\mathrm{scale}}\\,l_{n}=5000+5000\\left(\\frac{0.00942}{0.9993}\\right).$$\n对于 DEM 高程误差的灵敏度，我们计算在给定点处的偏导数 $\\frac{\\partial\\,\\text{line}}{\\partial Z}$。使用链式法则和定义 $H=(Z-Z_{0})/Z_{\\mathrm{scale}}$，我们有\n$$\\frac{\\partial\\,\\text{line}}{\\partial Z}=\\text{line}_{\\mathrm{scale}}\\;\\frac{\\partial l_{n}}{\\partial Z}=\\text{line}_{\\mathrm{scale}}\\;\\frac{\\partial l_{n}}{\\partial H}\\;\\frac{\\partial H}{\\partial Z}=\\text{line}_{\\mathrm{scale}}\\;\\frac{\\partial l_{n}}{\\partial H}\\;\\frac{1}{Z_{\\mathrm{scale}}}.$$\n接下来需要从商 $l_{n}=P/Q$ 计算 $\\frac{\\partial l_{n}}{\\partial H}$。求导，\n$$\\frac{\\partial l_{n}}{\\partial H}=\\frac{Q\\,\\frac{\\partial P}{\\partial H}-P\\,\\frac{\\partial Q}{\\partial H}}{Q^{2}}.$$\n对于 $P$，关于 $H$ 的导数是\n$$\\frac{\\partial P}{\\partial H}=a_{3}+a_{5}L+a_{6}S+2a_{9}H.$$\n代入数值：\n\n$$\n\\begin{aligned}\n\\frac{\\partial P}{\\partial H}=0.010+(-0.004)(0.4)+0.003(0.4)+2(0.002)(0.5)\\\\\n=0.010-0.0016+0.0012+0.002\\\\\n=0.0116.\n\\end{aligned}\n$$\n\n对于 $Q$，关于 $H$ 的导数是\n$$\\frac{\\partial Q}{\\partial H}=b_{3}=0.005.$$\n现在数值计算 $\\frac{\\partial l_{n}}{\\partial H}$：\n\n$$\n\\begin{aligned}\nQ\\,\\frac{\\partial P}{\\partial H}=0.9993\\times 0.0116=0.01159188,\\\\\nP\\,\\frac{\\partial Q}{\\partial H}=0.00942\\times 0.005=0.0000471,\\\\\n\\text{numerator}=0.01159188-0.0000471=0.01154478,\\\\\nQ^{2}=(0.9993)^{2}=0.99860049,\\\\\n\\frac{\\partial l_{n}}{\\partial H}=\\frac{0.01154478}{0.99860049}\\approx 0.011562.\n\\end{aligned}\n$$\n\n因此，\n\n$$\n\\begin{aligned}\n\\frac{\\partial\\,\\text{line}}{\\partial Z}=\\text{line}_{\\mathrm{scale}}\\;\\frac{1}{Z_{\\mathrm{scale}}}\\;\\frac{\\partial l_{n}}{\\partial H}=5000\\times \\frac{1}{100}\\times 0.011562\\\\\n=5000\\times 0.00011562\\\\\n\\approx 0.5781\\;\\text{像素/米}.\n\\end{aligned}\n$$\n\n最后计算行坐标：\n\n$$\n\\begin{aligned}\nl_{n}=\\frac{0.00942}{0.9993}\\approx 0.0094266,\\\\\n\\text{line}=5000+5000(0.0094266)\\approx 5000+47.133\\approx 5047.133.\n\\end{aligned}\n$$\n\n四舍五入到四位有效数字，行坐标为 $5047$ 像素，灵敏度为 $0.5781$ 像素/米。我们按要求将这些值以单行矩阵的形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix}5047  0.5781\\end{pmatrix}}$$"
        },
        {
            "introduction": "在分析地形特征时，理解高程不确定性如何转化为平面位置的不确定性至关重要，例如在等高线生成中，高程模型中的误差会导致等高线发生水平位移。本练习通过一个简化的局部平面模型，引导你从几何原理出发，推导高程测量误差与对应地物点水平位置不确定性之间的定量关系。掌握这种误差分析方法有助于理解地形坡度如何调节误差的传播。",
            "id": "3821033",
            "problem": "在使用数字高程模型（DEM；Digital Elevation Model）对近天底遥感影像进行地图正射校正时，平面配准误差的一个常见一阶来源是 DEM 的垂直不确定性。考虑某点周围的一小块地形，其高程场是可微的，并且可以局部地用一个平面来近似。设真实地形局部模型为 $z(x,y) \\approx z_{0} + \\nabla z \\cdot \\boldsymbol{r}$，其中 $\\boldsymbol{r} = \\begin{pmatrix}x - x_{0} \\\\ y - y_{0}\\end{pmatrix}$，$\\nabla z$ 是高程的水平梯度。假设沿垂直方向进行正射投影（这对于地图正射校正中的小视场是合适的），因此正射影像像素 $(x,y)$ 是其垂直投影与 DEM 表面相交的水平位置。\n\n假设 DEM 具有一个无偏的、标准差为 $\\sigma_{Z}$ 的随机垂直误差，并假设线性近似有效，因此由微小水平位移 $\\delta \\boldsymbol{r}$ 引起的高程一阶变化为 $\\nabla z \\cdot \\delta \\boldsymbol{r}$。设 $\\beta$ 表示从水平面测量的常规地形坡度角，使得 $\\|\\nabla z\\| = \\tan \\beta$，并定义 $\\theta := \\frac{\\pi}{2} - \\beta$ 为从垂直方向测量的余角（因此 $\\tan \\theta = \\cot \\beta$）。在这些假设下，推导由 DEM 垂直不确定性 $\\sigma_{Z}$ 引起的均方根平面配准不确定性 $\\sigma_{XY}$ 的一阶表达式，该表达式用 $\\sigma_{Z}$ 和 $\\theta$ 表示。将 $\\theta$ 以弧度表示，$\\sigma_{XY}$ 以米表示。你的最终答案必须是 $\\sigma_{XY}$ 关于 $\\sigma_{Z}$ 和 $\\theta$ 的单个闭式解析表达式。",
            "solution": "问题要求推导由数字高程模型（DEM）的垂直不确定性（记为 $\\sigma_Z$）引起的均方根（RMS）平面配准不确定性（记为 $\\sigma_{XY}$）的一阶表达式。推导应在局部平面地形表面和正射投影的假设下进行。\n\n设真实地形表面局部由函数 $z_{\\text{true}}(x,y)$ 描述。问题指出该表面可用平面近似。DEM 提供了该表面的一个估计值 $z_{\\text{dem}}(x,y)$，其中包含一个随机、无偏的垂直误差 $\\delta Z$。在任意给定的水平位置 $\\boldsymbol{r} = \\begin{pmatrix}x \\\\ y\\end{pmatrix}$，我们有 $z_{\\text{dem}}(\\boldsymbol{r}) = z_{\\text{true}}(\\boldsymbol{r}) + \\delta Z$。垂直误差 $\\delta Z$ 是一个随机变量，其均值为 $E[\\delta Z] = 0$，标准差为 $\\sigma_Z$。\n\n平面配准误差的本质是，在具有错误高程的 DEM 表面上，有效地寻找位于真实地面某一高程上的地物。这种不匹配迫使需要一个水平位移来在真实表面上找到与该错误高程相对应的点。\n\n让我们考虑 DEM 上一个水平坐标为 $\\boldsymbol{r}$、高程为 $z_{\\text{dem}}(\\boldsymbol{r})$ 的点。当我们试图在真实表面上找到对应点时，便产生了平面误差。我们在真实表面上寻找一个点 $\\boldsymbol{r}' = \\boldsymbol{r} + \\delta \\boldsymbol{r}$，使其高程与有误差的 DEM 表面上 $\\boldsymbol{r}$ 处的高程相同。也就是说，我们寻求水平位移 $\\delta \\boldsymbol{r}$ 使得：\n$$z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) = z_{\\text{dem}}(\\boldsymbol{r})$$\n代入 DEM 误差的定义，我们得到：\n$$z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) = z_{\\text{true}}(\\boldsymbol{r}) + \\delta Z$$\n真实表面上对应于水平位移 $\\delta\\boldsymbol{r}$ 的高程变化为 $\\Delta z_{\\text{true}} = z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) - z_{\\text{true}}(\\boldsymbol{r})$。因此，我们有：\n$$\\Delta z_{\\text{true}} = \\delta Z$$\n该方程建立了核心关系：DEM 中的垂直误差等效于真实地形表面在平面位移矢量 $\\delta\\boldsymbol{r}$ 上的高程变化。\n\n问题将地形局部建模为一个平面。让我们分析这个平面上的几何关系。地形坡度由两个角度定义：与水平面的夹角 $\\beta$，以及与垂直方向的夹角 $\\theta$。它们的关系是 $\\theta = \\frac{\\pi}{2} - \\beta$。\n\n考虑一个直角三角形，其斜边位于倾斜的地形表面上。该三角形的两条直角边分别表示水平位移（设其大小为 $\\delta r_{xy} = \\|\\delta \\boldsymbol{r}\\|$）和相应的垂直位移 $\\Delta z_{\\text{true}}$。垂直方向与倾斜表面（斜边）之间的夹角是 $\\theta$。\n\n根据该直角三角形中正切函数的定义，角度 $\\theta$ 将水平直角边（对边）与垂直直角边（邻边）联系起来：\n$$\\tan \\theta = \\frac{\\delta r_{xy}}{\\Delta z_{\\text{true}}}$$\n代入 $\\Delta z_{\\text{true}} = \\delta Z$，我们得到了单次实现中平面误差大小与 DEM 垂直误差之间的直接关系：\n$$\\delta r_{xy} = \\delta Z \\tan \\theta$$\n这个表达式表明，对于给定的垂直误差 $\\delta Z$，产生的平面误差 $\\delta r_{xy}$ 受到由 $\\tan \\theta$ 表示的地形坡度的调制。\n\n问题要求的是均方根（RMS）平面不确定性 $\\sigma_{XY}$，由于误差是无偏的，它就是 $\\delta r_{xy}$ 的标准差。RMS 值定义为 $\\sigma_{XY} = \\sqrt{E[(\\delta r_{xy})^2]}$。\n我们对 $\\delta r_{xy}$ 的表达式进行平方：\n$$(\\delta r_{xy})^2 = (\\delta Z \\tan \\theta)^2 = (\\delta Z)^2 \\tan^2 \\theta$$\n现在，我们取期望。地形坡度，以及 $\\tan \\theta$，对于所考虑的局部区域来说是一个固定参数。因此，相对于作用于随机变量 $\\delta Z$ 的期望算子，它可以被视为一个常数。\n$$E[(\\delta r_{xy})^2] = E[(\\delta Z)^2 \\tan^2 \\theta] = \\tan^2 \\theta \\cdot E[(\\delta Z)^2]$$\n项 $E[(\\delta Z)^2]$ 是垂直误差的方差，因为误差是无偏的（$E[\\delta Z]=0$）。方差是标准差 $\\sigma_Z$ 的平方。\n$$\\text{Var}(\\delta Z) = E[(\\delta Z - E[\\delta Z])^2] = E[(\\delta Z)^2] = \\sigma_Z^2$$\n将此代入期望平面误差平方的方程中：\n$$E[(\\delta r_{xy})^2] = \\sigma_Z^2 \\tan^2 \\theta$$\nRMS 平面不确定性 $\\sigma_{XY}$ 是该值的平方根：\n$$\\sigma_{XY} = \\sqrt{\\sigma_Z^2 \\tan^2 \\theta} = |\\sigma_Z \\tan \\theta|$$\n根据定义，标准差 $\\sigma_Z$ 是一个非负量。常规坡度角 $\\beta$ 的范围是 $[0, \\frac{\\pi}{2})$。因此，余角 $\\theta = \\frac{\\pi}{2} - \\beta$ 的范围是 $(0, \\frac{\\pi}{2}]$。对于此范围内的 $\\theta$，$\\tan \\theta$ 是非负的。因此，绝对值是不必要的。\n\nRMS 平面配准不确定性的最终一阶表达式是：\n$$\\sigma_{XY} = \\sigma_Z \\tan \\theta$$\n此结果与所给定义一致。为了验证，我们可以用坡度角 $\\beta$ 来表示它。由于 $\\theta = \\frac{\\pi}{2} - \\beta$，我们有 $\\tan \\theta = \\tan(\\frac{\\pi}{2} - \\beta) = \\cot \\beta = \\frac{1}{\\tan \\beta}$。所以，$\\sigma_{XY} = \\frac{\\sigma_Z}{\\tan \\beta}$。这个关系正确地表明，随着地形变得平坦（$\\beta \\to 0, \\tan \\beta \\to 0$），平面误差无限增大；而随着地形变得垂直（$\\beta \\to \\frac{\\pi}{2}, \\tan \\beta \\to \\infty$），误差趋近于零。",
            "answer": "$$\\boxed{\\sigma_{Z} \\tan(\\theta)}$$"
        }
    ]
}