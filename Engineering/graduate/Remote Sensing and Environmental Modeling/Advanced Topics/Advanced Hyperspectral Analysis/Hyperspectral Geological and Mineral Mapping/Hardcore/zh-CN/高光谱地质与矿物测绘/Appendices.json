{
    "hands_on_practices": [
        {
            "introduction": "在高光谱遥感中，传感器记录的原始数据是包含了地表反射信号与大气效应（如路径辐射和透射衰减）混合体的“传感器处辐射率”。为了准确识别地表矿物，我们必须首先将该辐射率数据转换为地表反射率，这是一种不受光照和大气条件影响的材料固有属性。这项实践将引导您基于一个简化的辐射传输模型，推导出从传感器处辐射率反演地表反射率的公式，这是进行任何定量高光谱分析前至关重要的一步 ()。",
            "id": "3820016",
            "problem": "一台高光谱成像光谱仪在以波长 $\\lambda$ 为中心的狭窄地质波段上采集数据，观测晴空条件下的一个矿化露头。假设大气为平行平面大气，地表可近似为朗伯体，无邻近效应，且可忽略大气多次散射（无大气球面反照率）。光谱仪记录了沿视线方向的传感器处光谱辐亮度 $L(\\lambda)$ 和大气路径辐亮度 $L_{p}(\\lambda)$。大气外光谱辐照度为 $E_{0}(\\lambda)$，太阳天顶角为 $\\theta_{s}$。沿太阳和传感器路径的向上和向下大气光谱透过率分别为 $T_{u}(\\lambda)$ 和 $T_{d}(\\lambda)$。请利用光谱辐亮度、光谱辐照度和地表反射率的定义，结合平行平面辐射传输分解为路径项和地表透射项的方法，推导出地表光谱反射率 $\\rho(\\lambda)$ 的表达式，并根据以下测量数据进行计算：\n$$L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}, \\quad L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1},$$\n$$E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}, \\quad T_{u}(\\lambda)T_{d}(\\lambda)=0.7.$$\n此处 $\\rho(\\lambda)$ 是朗伯体假设下地表的定向半球反射率，它通过朗伯特性与双向反射分布函数（BRDF）相关联。请将您计算出的 $\\rho(\\lambda)$ 的最终数值结果四舍五入到四位有效数字，并以无量纲小数的形式表示。",
            "solution": "本问题要求基于简化的辐射传输模型，从传感器处的高光谱测量值推导出地表光谱反射率 $\\rho(\\lambda)$，然后使用所提供的数据进行求值。\n\n首先，我们验证问题陈述的有效性。\n已知条件为：\n- 传感器处光谱辐亮度：$L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- 大气路径辐亮度：$L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- 大气层顶水平光谱辐照度：$E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$，其中 $E_{0}(\\lambda)$ 是大气外光谱辐照度，$\\theta_{s}$ 是太阳天顶角。\n- 向上和向下大气光谱透过率的乘积：$T_{u}(\\lambda)T_{d}(\\lambda)=0.7$\n\n假设为：\n- 平行平面大气。\n- 朗伯体表面。\n- 无邻近效应。\n- 可忽略的大气多次散射。\n\n该问题在科学上基于辐射传输原理，这是遥感和大气物理学中的一个基本概念。所给的物理量及其单位是标准的，并且量纲一致。所提供的值在物理上是合理的。该问题是适定的，为在指定假设下获得唯一解提供了所有必要信息。它是客观且无歧义的。因此，该问题是有效的，我们可以继续求解。\n\n基本原理是，传感器测量的总光谱辐亮度 $L(\\lambda)$，是大气直接散射到传感器视场内的辐亮度（路径辐亮度，$L_p(\\lambda)$）与源自太阳、经地表反射、再穿过大气传输到传感器的辐亮度之和。\n\n传感器处的光谱辐亮度 $L(\\lambda)$ 可以表示为：\n$$L(\\lambda) = L_{p}(\\lambda) + L_{surface-reflected}(\\lambda)$$\n其中 $L_{surface-reflected}(\\lambda)$ 是源自地表反射的辐亮度分量。\n\n我们现在必须构建 $L_{surface-reflected}(\\lambda)$ 这一项。\n1. 大气层顶水平面上的太阳光谱辐照度为 $E_{0}(\\lambda)\\cos\\theta_{s}$。\n2. 该辐射穿过大气传输到地表。向下的大气光谱透过率为 $T_{d}(\\lambda)$。因此，入射到地表的光谱辐照度为 $E_{g}(\\lambda)$。在可忽略多次散射的假设下，我们只考虑直接太阳光束，因此到达地表的总辐照度为：\n    $$E_{g}(\\lambda) = E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda)$$\n3. 地表被假设为朗伯体。对于光谱反射率为 $\\rho(\\lambda)$ 的朗伯体表面，其反射辐亮度是各向同性的（与观测方向无关），并与总的入射半球辐照度 $E_g(\\lambda)$ 通过以下关系式相关联：\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda) E_{g}(\\lambda)}{\\pi}$$\n    因子 $\\pi$ 源于对各向同性辐亮度在出射方向的半球上进行积分，该积分必须等于反射出射度 $M = \\rho(\\lambda) E_g(\\lambda)$。对于朗伯体表面，$M = \\pi L$。\n4. 将 $E_{g}(\\lambda)$ 的表达式代入 $L_{refl}(\\lambda)$ 的方程中：\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} \\left( E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right)$$\n5. 然后，这个来自地表的反射辐亮度 $L_{refl}(\\lambda)$ 在向上穿过大气到达传感器的过程中会发生衰减。沿着传感器路径的向上大气光谱透过率为 $T_{u}(\\lambda)$。因此，到达传感器的地表反射辐亮度为：\n    $$L_{surface-reflected}(\\lambda) = L_{refl}(\\lambda) T_{u}(\\lambda) = \\left( \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right) T_{u}(\\lambda)$$\n\n现在，我们将此代回 $L(\\lambda)$ 的主方程中：\n$$L(\\lambda) = L_{p}(\\lambda) + \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n\n任务的第一部分是推导地表光谱反射率 $\\rho(\\lambda)$ 的表达式。我们重新整理方程以求解 $\\rho(\\lambda)$：\n$$L(\\lambda) - L_{p}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n$$\\rho(\\lambda) = \\frac{\\pi \\left( L(\\lambda) - L_{p}(\\lambda) \\right)}{E_{0}(\\lambda)\\cos\\theta_{s} T_{u}(\\lambda) T_{d}(\\lambda)}$$\n这就是所求的地表光谱反射率的解析表达式。\n\n任务的第二部分是使用给定的数值计算该表达式。为简化计算中的符号，我们省略对 $\\lambda$ 的显式依赖：\n- $L = 100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $L_{p} = 20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $E_{0}\\cos\\theta_{s} = 900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$\n- $T_{u}T_{d} = 0.7$\n\n将这些值代入推导出的 $\\rho$ 公式中：\n$$\\rho = \\frac{\\pi \\left( 100 - 20 \\right)}{900 \\times 0.7}$$\n$$\\rho = \\frac{80\\pi}{630}$$\n$$\\rho = \\frac{8\\pi}{63}$$\n\n现在我们计算数值：\n$$\\rho \\approx \\frac{8 \\times 3.14159265}{63}$$\n$$\\rho \\approx \\frac{25.1327412}{63}$$\n$$\\rho \\approx 0.39893240045...$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3、9、8、9$。第五位有效数字是 $3$，小于 $5$，所以我们舍去（即截断）。\n$$\\rho \\approx 0.3989$$\n这是一个无量纲量，符合反射率的预期。",
            "answer": "$$\\boxed{0.3989}$$"
        },
        {
            "introduction": "成功获取地表反射率光谱后，下一个挑战便是从中识别和量化那些作为矿物“指纹”的诊断性吸收特征。连续统去除是一种标准的光谱分析技术，它通过建立并移除光谱的背景趋势来归一化光谱，从而突出吸收特征。该特征的深度是衡量其强度的关键参数，对矿物填图和丰度反演至关重要。本练习将通过一个具体案例，教您如何计算连续统去除后的吸收深度，这是将光谱数据转化为地质信息的基石 ()。",
            "id": "3820046",
            "problem": "一台高光谱成像（HSI）光谱仪测量了一个富含碳酸盐的露头的地表双向反射因子 $R(\\lambda)$。一个与金属-碳酸盐倍频相关的吸收特征中心位于 $2.33\\,\\mu\\mathrm{m}$ 附近，其谱肩位于 $2.30\\,\\mu\\mathrm{m}$ 和 $2.36\\,\\mu\\mathrm{m}$。测得的反射率分别为 $R(2.30\\,\\mu\\mathrm{m}) = 0.42$，$R(2.36\\,\\mu\\mathrm{m}) = 0.46$，以及一个局部最小值 $R(2.33\\,\\mu\\mathrm{m}) = 0.35$。为了进行包络线去除，将包络线反射率 $R_{c}(\\lambda)$ 定义为穿过 $2.30\\,\\mu\\mathrm{m}$ 和 $2.36\\,\\mu\\mathrm{m}$ 处两个谱肩点的直线。使用在吸收最小值处计算的波段深度的标准包络线去除定义，计算在 $\\lambda = 2.33\\,\\mu\\mathrm{m}$ 处去除包络线后的波段深度。将最终答案表示为一个无量纲分数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算高光谱反射光谱中特定吸收特征的去除包络线后的波段深度。这个过程包括定义一个线性包络线，计算其在吸收最小值处的值，然后应用标准的波段深度公式。\n\n题目给出的已知条件是：\n- 吸收特征的谱肩点位于波长 $\\lambda_1 = 2.30\\,\\mu\\mathrm{m}$ 处，反射率为 $R_1 = R(2.30) = 0.42$；以及位于波长 $\\lambda_2 = 2.36\\,\\mu\\mathrm{m}$ 处，反射率为 $R_2 = R(2.36) = 0.46$。\n- 吸收特征在波长 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处有一个局部最小值，测得的反射率为 $R_{min} = R(2.33) = 0.35$。\n\n第一步是确定包络线反射率 $R_c(\\lambda)$ 的方程，它被定义为穿过两个谱肩点 $(\\lambda_1, R_1)$ 和 $(\\lambda_2, R_2)$ 的直线。线性方程的通用两点式为：\n$$R_c(\\lambda) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda - \\lambda_1)$$\n\n我们需要计算该包络线反射率在吸收最小值波长 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处的值。将给定值代入方程中：\n$$R_c(\\lambda_{min}) = R_c(2.33) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda_{min} - \\lambda_1)$$\n$$R_c(2.33) = 0.42 + \\frac{0.46 - 0.42}{2.36 - 2.30}(2.33 - 2.30)$$\n\n现在，我们计算数值：\n$$R_c(2.33) = 0.42 + \\frac{0.04}{0.06}(0.03)$$\n$$R_c(2.33) = 0.42 + \\left(\\frac{2}{3}\\right)(0.03)$$\n$$R_c(2.33) = 0.42 + 0.02$$\n$$R_c(2.33) = 0.44$$\n这是在吸收最小值波长处包络线的反射率值。\n\n下一步是计算去除包络线后的波段深度，记为 $BD$。波段深度的标准定义是相对于包络线水平对吸收特征的深度进行归一化，使其成为一个无量纲的量。其公式为：\n$$BD(\\lambda) = \\frac{R_c(\\lambda) - R(\\lambda)}{R_c(\\lambda)} = 1 - \\frac{R(\\lambda)}{R_c(\\lambda)}$$\n\n我们使用测得的反射率 $R_{min} = R(2.33) = 0.35$ 和计算出的包络线反射率 $R_c(2.33) = 0.44$ 来计算吸收最小值 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处的波段深度：\n$$BD(2.33) = 1 - \\frac{R(2.33)}{R_c(2.33)}$$\n$$BD(2.33) = 1 - \\frac{0.35}{0.44}$$\n\n为了求得精确的分数值：\n$$BD(2.33) = \\frac{0.44 - 0.35}{0.44} = \\frac{0.09}{0.44} = \\frac{9}{44}$$\n\n最后，我们按照要求将这个分数转换为小数，并四舍五入到四位有效数字：\n$$BD(2.33) = \\frac{9}{44} \\approx 0.20454545...$$\n四舍五入到四位有效数字得到 $0.2045$。",
            "answer": "$$\\boxed{0.2045}$$"
        },
        {
            "introduction": "高光谱数据集通常包含数百个高度相关的波段，并且数据维度巨大，其中许多波段可能由噪声而非有效信号主导。最小噪声分离（Minimum Noise Fraction, MNF）变换是一种强大的数据预处理技术，它通过将数据投影到新的坐标系，按信噪比（Signal-to-Noise Ratio, SNR）对分量进行排序，从而实现降维和去噪。本练习深入探讨了 MNF 变换背后的理论，特别是如何利用数据协方差矩阵的特征值和噪声方差来估算每个分量的信噪比。掌握这项技能，将使您能够为后续的地质分类和填图任务，做出保留多少个有效数据维度的明智决策 ()。",
            "id": "3820058",
            "problem": "一个矿化露头的高光谱场景通过一个加性信号加噪声过程建模，其中每个观测到的光谱向量 $\\mathbf{x} \\in \\mathbb{R}^{p}$ 是一个潜在信号 $\\mathbf{s}$ 和一个加性噪声 $\\mathbf{n}$ 的和，即 $\\mathbf{x} = \\mathbf{s} + \\mathbf{n}$。假设噪声为零均值，与信号不相关，并且是空间白噪声，每个波段的方差为 $\\sigma_{n}^{2}$，因此 $\\mathrm{Cov}(\\mathbf{n}) = \\sigma_{n}^{2}\\mathbf{I}$。您计算了去均值后观测数据的样本协方差，发现其特征值为 $\\{12, 7, 3, 0.8, 0.5\\}$。一项独立的噪声特性分析得出的估计每波段噪声方差为 $\\sigma_{n}^{2} = 1$。在进行地质和矿物填图之前，您打算执行最小噪声分数（MNF）变换以降低维度，只保留信噪比（SNR）至少为 $1$ 的分量（即信号方差至少等于噪声方差）。\n\n仅从加性模型 $\\mathbf{x}=\\mathbf{s}+\\mathbf{n}$、协方差可加性 $\\mathrm{Cov}(\\mathbf{x})=\\mathrm{Cov}(\\mathbf{s})+\\mathrm{Cov}(\\mathbf{n})$、信噪比定义为分量上信号方差与噪声方差之比，以及各向同性噪声下协方差矩阵特征值的性质出发，确定在给定的信噪比阈值下应保留多少个 MNF 分量，并根据观测特征值、信号方差和噪声方差之间的关系证明您的选择。\n\n请提供您的最终答案，以单个整数表示保留分量的数量。无需四舍五入，且无物理单位。",
            "solution": "该问题被认为是有效的，因为它在信号处理和线性代数方面有科学依据，是适定的，具有充分且一致的信息，并且陈述客观。\n\n该问题要求根据信噪比（SNR）标准，确定在最小噪声分数（MNF）变换后要保留的分量数量。我们首先将所给的关系形式化。\n\n观测光谱向量 $\\mathbf{x}$ 由加性模型描述：\n$$\n\\mathbf{x} = \\mathbf{s} + \\mathbf{n}\n$$\n其中 $\\mathbf{s}$ 是潜在信号，$\\mathbf{n}$ 是加性噪声。\n\n信号 $\\mathbf{s}$ 和噪声 $\\mathbf{n}$ 被陈述为不相关。此性质意味着观测数据 $\\mathrm{Cov}(\\mathbf{x})$ 或 $\\boldsymbol{\\Sigma}_x$ 的协方差矩阵是信号协方差矩阵 $\\mathrm{Cov}(\\mathbf{s})$ 或 $\\boldsymbol{\\Sigma}_s$ 与噪声协方差矩阵 $\\mathrm{Cov}(\\mathbf{n})$ 或 $\\boldsymbol{\\Sigma}_n$ 的和：\n$$\n\\boldsymbol{\\Sigma}_x = \\boldsymbol{\\Sigma}_s + \\boldsymbol{\\Sigma}_n\n$$\n\n噪声被指定为空间白噪声，每波段方差为 $\\sigma_{n}^{2}$。这正是各向同性噪声的定义，意味着其协方差矩阵是一个缩放的单位矩阵：\n$$\n\\boldsymbol{\\Sigma}_n = \\sigma_{n}^{2}\\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。\n\n将此代入协方差可加性方程可得：\n$$\n\\boldsymbol{\\Sigma}_x = \\boldsymbol{\\Sigma}_s + \\sigma_{n}^{2}\\mathbf{I}\n$$\n\nMNF 变换识别按信噪比排序的分量。这些分量对应于信号的主成分，即信号协方差矩阵 $\\boldsymbol{\\Sigma}_s$ 的特征向量。设 $\\mathbf{v}_i$ 是 $\\boldsymbol{\\Sigma}_s$ 的一个特征向量，其对应的特征值为 $\\lambda_{s,i}$。特征值 $\\lambda_{s,i}$ 表示沿特征向量 $\\mathbf{v}_i$ 方向的信号方差。\n$$\n\\boldsymbol{\\Sigma}_s\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i\n$$\n\n各向同性噪声的假设使我们能够在信号协方差 $\\boldsymbol{\\Sigma}_s$ 的特征值与观测数据协方差 $\\boldsymbol{\\Sigma}_x$ 的特征值之间建立直接关系。因为 $\\boldsymbol{\\Sigma}_s$ 和 $\\sigma_{n}^{2}\\mathbf{I}$ 可同时对角化（任何矩阵都与单位矩阵可交换），它们共享相同的特征向量集。因此，$\\mathbf{v}_i$ 也是 $\\boldsymbol{\\Sigma}_x$ 的一个特征向量。让我们求出其对应的特征值 $\\lambda_{x,i}$：\n$$\n\\boldsymbol{\\Sigma}_x\\mathbf{v}_i = (\\boldsymbol{\\Sigma}_s + \\sigma_{n}^{2}\\mathbf{I})\\mathbf{v}_i = \\boldsymbol{\\Sigma}_s\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{I}\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{v}_i = (\\lambda_{s,i} + \\sigma_{n}^{2})\\mathbf{v}_i\n$$\n因此，观测数据协方差矩阵的特征值 $\\lambda_{x,i}$ 是该分量方向上信号方差 $\\lambda_{s,i}$ 与噪声方差 $\\sigma_{n}^{2}$ 的和：\n$$\n\\lambda_{x,i} = \\lambda_{s,i} + \\sigma_{n}^{2}\n$$\n这使我们能够用观测到的特征值和噪声方差来表示第 $i$ 个分量的信号方差：\n$$\n\\lambda_{s,i} = \\lambda_{x,i} - \\sigma_{n}^{2}\n$$\n\n第 $i$ 个分量的信噪比定义为其信号方差与噪声方差之比。信号方差为 $\\lambda_{s,i}$。沿任意方向 $\\mathbf{v}_i$（假设 $\\|\\mathbf{v}_i\\|=1$）的噪声方差由 $\\mathbf{v}_i^T \\boldsymbol{\\Sigma}_n \\mathbf{v}_i = \\mathbf{v}_i^T (\\sigma_{n}^{2}\\mathbf{I}) \\mathbf{v}_i = \\sigma_{n}^{2}(\\mathbf{v}_i^T\\mathbf{v}_i) = \\sigma_{n}^{2}$ 给出。\n因此，第 $i$ 个分量的信噪比为：\n$$\n\\mathrm{SNR}_i = \\frac{\\lambda_{s,i}}{\\sigma_{n}^{2}}\n$$\n\n问题规定，我们必须保留信噪比至少为 $1$ 的分量。\n$$\n\\mathrm{SNR}_i \\geq 1\n$$\n这等同于括号中的陈述“信号方差至少等于噪声方差”：\n$$\n\\lambda_{s,i} \\geq \\sigma_{n}^{2}\n$$\n\n为了根据所提供的数据做出决策，我们将用观测特征值 $\\lambda_{x,i}$ 表示的 $\\lambda_{s,i}$ 的表达式代入：\n$$\n\\lambda_{x,i} - \\sigma_{n}^{2} \\geq \\sigma_{n}^{2}\n$$\n这可简化为最终的保留准则：\n$$\n\\lambda_{x,i} \\geq 2\\sigma_{n}^{2}\n$$\n\n我们已知观测数据的样本协方差的特征值为：\n$$\n\\lambda_{x,i} \\in \\{12, 7, 3, 0.8, 0.5\\}\n$$\n以及估计的每波段噪声方差为：\n$$\n\\sigma_{n}^{2} = 1\n$$\n应用保留准则，我们需要找出哪些特征值满足 $\\lambda_{x,i} \\geq 2 \\times 1 = 2$。\n\n让我们逐一检查每个特征值：\n1.  对于第一个分量，$\\lambda_{x,1} = 12$。由于 $12 \\geq 2$，该分量被保留。\n2.  对于第二个分量，$\\lambda_{x,2} = 7$。由于 $7 \\geq 2$，该分量被保留。\n3.  对于第三个分量，$\\lambda_{x,3} = 3$。由于 $3 \\geq 2$，该分量被保留。\n4.  对于第四个分量，$\\lambda_{x,4} = 0.8$。由于 $0.8  2$，该分量被舍弃。\n5.  对于第五个分量，$\\lambda_{x,5} = 0.5$。由于 $0.5  2$，该分量被舍弃。\n\n满足该准则的特征值为 $\\{12, 7, 3\\}$。计算这些分量的数量，我们发现应保留 $3$ 个分量。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}