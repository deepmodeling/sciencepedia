{
    "hands_on_practices": [
        {
            "introduction": "The foundation of full-waveform LiDAR analysis is understanding how a continuous, analog backscatter signal is converted into a discrete, digital representation. This exercise connects the fundamental physics of time-of-flight ranging to the core principles of digital signal processing. By deriving the range-bin size from the system's sampling rate, you will gain a crucial insight into the trade-offs between spatial resolution, data volume, and system design in full-waveform LiDAR .",
            "id": "3813872",
            "problem": "An airborne Light Detection and Ranging (LiDAR) system records full-waveform returns from forest canopies. The digitizer uniformly samples the backscattered analog signal at a rate $f_s$ and stores each sample with a fixed bit depth. The system parameters are:\n- Sampling rate $f_s = 2.5\\,\\mathrm{GHz}$,\n- Record duration per laser shot $T = 20\\,\\mu\\mathrm{s}$,\n- Bit depth per sample $b = 12\\,\\mathrm{bits}$,\n- Speed of light $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nStarting from the two-way time-of-flight relationship between travel time and range, and the definition of uniform sampling, derive the range-bin size for this full-waveform digitization and compute its numerical value. Express the final range-bin size in centimeters and round your answer to four significant figures.\n\nAdditionally, analyze, from first principles, the trade-offs between increasing the sampling rate $f_s$ and the resulting memory footprint for a fixed waveform duration $T$. Your analysis should cover how the number of samples, the total stored bits, and the record duration drive storage requirements, and should contrast these considerations with those of photon-counting LiDAR, where individual photon detection events are timestamped rather than the analog waveform being uniformly sampled. No numerical evaluation of memory is required; provide a symbolic assessment and qualitative discussion only.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of remote sensing and digital signal processing, is well-posed with sufficient information for a unique solution, and is expressed in objective, precise language. All parameters are physically realistic. The problem requires a standard derivation, a numerical calculation, and a conceptual analysis, all of which are appropriate for the domain.\n\nThe problem is addressed in two parts as requested: first, the derivation and calculation of the range-bin size, and second, the qualitative analysis of storage trade-offs.\n\n**Part 1: Derivation and Calculation of Range-Bin Size**\n\nThe fundamental principle of LiDAR is the measurement of the time-of-flight of a pulse of light. The total distance, $d$, travelled by the light from the sensor to a target and back to the sensor is given by the product of the speed of light, $c$, and the two-way travel time, $\\Delta t$.\n$$d = c \\Delta t$$\nThe range, $R$, to the target is one-half of this total distance, as it represents a one-way path.\n$$R = \\frac{d}{2} = \\frac{c \\Delta t}{2}$$\nThis is the two-way time-of-flight relationship.\n\nA full-waveform LiDAR system's digitizer samples the analog backscattered signal at a uniform sampling rate, $f_s$. The time interval between any two consecutive samples is the sampling period, $\\Delta t_s$, which is the reciprocal of the sampling frequency:\n$$\\Delta t_s = \\frac{1}{f_s}$$\nThis sampling period, $\\Delta t_s$, represents the smallest temporal feature that can be resolved in the digitized waveform. Consequently, it determines the finest possible range resolution, known as the range-bin size, $\\Delta R$. The range-bin size is the change in range, $\\Delta R$, that corresponds to the time interval between consecutive samples, $\\Delta t_s$.\n\nBy substituting $\\Delta t_s$ for $\\Delta t$ in the range equation, we can derive the expression for the range-bin size:\n$$\\Delta R = \\frac{c \\Delta t_s}{2}$$\nSubstituting the expression for $\\Delta t_s$ in terms of $f_s$, we arrive at the final formula for the range-bin size:\n$$\\Delta R = \\frac{c}{2 f_s}$$\nNow, we compute the numerical value for $\\Delta R$ using the provided parameters:\n- Speed of light, $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- Sampling rate, $f_s = 2.5\\,\\mathrm{GHz} = 2.5 \\times 10^{9}\\,\\mathrm{s}^{-1}$\n\nSubstituting these values into the derived equation:\n$$\\Delta R = \\frac{2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{2 \\times (2.5 \\times 10^{9}\\,\\mathrm{s}^{-1})} = \\frac{2.99792458 \\times 10^{8}}{5.0 \\times 10^{9}}\\,\\mathrm{m}$$\n$$\\Delta R = 0.0599584916\\,\\mathrm{m}$$\nThe problem requires the answer to be expressed in centimeters. We use the conversion $1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$:\n$$\\Delta R = 0.0599584916 \\times 100\\,\\mathrm{cm} = 5.99584916\\,\\mathrm{cm}$$\nFinally, we round the result to four significant figures:\n$$\\Delta R \\approx 5.996\\,\\mathrm{cm}$$\n\n**Part 2: Analysis of Storage Trade-offs**\n\nThis section analyzes the trade-offs associated with the sampling rate in full-waveform systems and contrasts them with photon-counting systems.\n\nFor a full-waveform LiDAR (FWL) system, the data storage requirement for a single laser shot is deterministic. For a fixed record duration, $T$, and a sampling rate, $f_s$, the total number of samples, $N_{\\text{samples}}$, is given by:\n$$N_{\\text{samples}} = f_s \\times T$$\nEach sample is quantized with a bit depth of $b$ bits. Therefore, the total memory footprint per waveform, $M_{\\text{FWL}}$, is:\n$$M_{\\text{FWL}} = N_{\\text{samples}} \\times b = f_s \\times T \\times b$$\nFrom this relationship, the trade-off of increasing the sampling rate, $f_s$, while keeping the duration $T$ fixed, is clear. The memory footprint, $M_{\\text{FWL}}$, is directly proportional to $f_s$. An increase in $f_s$ yields a smaller range-bin size, $\\Delta R = c/(2f_s)$, which improves the longitudinal resolution and the ability to distinguish closely spaced objects. However, this enhanced resolution comes at the direct cost of a linear increase in data volume, memory requirements, and subsequently, data transmission and processing overhead. For every laser shot, the system must store a large, dense array of sample values, regardless of whether a meaningful signal was returned.\n\nIn contrast, a photon-counting LiDAR (PCL) system operates on a different principle. It does not record a continuous waveform but rather detects discrete photon arrival events and records their timestamps with high precision. The data volume is therefore not fixed per shot. Let $N_{\\text{photons}}$ be the number of photons detected within the observation window for a single laser shot, and let $b_{\\text{ts}}$ be the number of bits required to store a single timestamp. The memory footprint for a PCL system, $M_{\\text{PCL}}$, is approximately:\n$$M_{\\text{PCL}} \\approx N_{\\text{photons}} \\times b_{\\text{ts}}$$\nThe key distinction is that $N_{\\text{photons}}$ is not a fixed system parameter; it is a stochastic variable that depends on the signal strength, which in turn is a function of target reflectivity, range, atmospheric attenuation, and background illumination.\n\nThis leads to the following contrast in storage considerations:\n1.  **Data Structure:** FWL generates dense, regularly structured data. PCL generates sparse, event-driven data.\n2.  **Dependence on Signal:** FWL storage requirements are independent of the returned signal strength. A full waveform is stored even if it contains only noise. PCL storage requirements are directly proportional to the number of detected photons. In low-signal or sparse-return environments (e.g., over water, dark targets, high altitudes), PCL is exceptionally data-efficient.\n3.  **Effect of Resolution:** In FWL, increasing range resolution requires a higher $f_s$, which uniformly increases the data volume for all acquisitions. In PCL, increasing temporal resolution means using a more precise time-tagging unit (effectively increasing $b_{\\text{ts}}$ or the underlying clockrate), which increases the data size per detected photon, but the total data volume remains dependent on $N_{\\text{photons}}$.\n4.  **System Limitations:** FWL gracefully handles high-power returns by recording a high-amplitude signal. PCL systems can suffer from detector saturation in high-signal or high-background-noise conditions, where the rate of incoming photons exceeds the detector's ability to resolve individual events. In such cases, the number of recorded events may not be representative of the true signal, and the data volume could potentially become large.\n\nIn summary, the trade-off for FWL is a direct-cost relationship between range resolution and data volume. The trade-off for PCL is more complex, involving a balance between single-photon sensitivity, data efficiency in sparse conditions, and susceptibility to saturation in high-signal conditions. The choice between the systems depends fundamentally on the application and the expected signal environment.",
            "answer": "$$\n\\boxed{5.996}\n$$"
        },
        {
            "introduction": "Once a waveform is recorded, the next challenge is to estimate the precise time-of-arrival of an echo, which is invariably corrupted by noise. This practice delves into the theoretical limits of estimation precision by introducing the Cramér-Rao Lower Bound (CRLB). By deriving the CRLB for a Gaussian pulse in additive white Gaussian noise, you will learn how to quantify the best possible ranging accuracy as a function of signal-to-noise ratio ($SNR$) and pulse shape, providing a vital benchmark for evaluating real-world algorithms .",
            "id": "3813803",
            "problem": "A Light Detection and Ranging (LiDAR) receiver observes a temporally shifted pulse corrupted by Additive White Gaussian Noise (AWGN). The received waveform is modeled as $y(t) = s(t - \\tau) + n(t)$, where $s(t)$ is a known deterministic template, $\\tau$ is the unknown time-of-arrival parameter to be estimated, and $n(t)$ is zero-mean AWGN with two-sided power spectral density $N_0/2$. Suppose the transmitted pulse is Gaussian in time, $s(t) = A \\exp\\!\\big(-t^2/(2\\sigma^2)\\big)$, with known amplitude $A$ and temporal standard deviation $\\sigma$. The energy of the pulse is $E_s = \\int_{-\\infty}^{\\infty} s^2(t)\\,dt$, and the signal-to-noise ratio is defined as $\\mathrm{SNR} = E_s/N_0$. The full width at half maximum of the Gaussian pulse is $T_{\\mathrm{FWHM}} = 2\\sqrt{2\\ln 2}\\,\\sigma$.\n\nStarting from the definition of Fisher information for a parametric family $p(y|\\tau)$ and the Cramér–Rao lower bound (CRLB) for any unbiased estimator $\\hat{\\tau}$, derive the CRLB on the variance of unbiased time-of-arrival estimators for this LiDAR waveform in AWGN. Express your final bound in closed form as a function of $\\mathrm{SNR}$ and $T_{\\mathrm{FWHM}}$. Provide the final bound in units of seconds squared. No intermediate or numerical approximations are required, and the answer should be a single analytic expression.",
            "solution": "The problem asks for the Cramér–Rao Lower Bound (CRLB) on the variance of any unbiased estimator for the time-of-arrival parameter $\\tau$ of a Gaussian pulse in Additive White Gaussian Noise (AWGN). The final result must be expressed as a function of the signal-to-noise ratio ($\\mathrm{SNR}$) and the pulse's full width at half maximum ($T_{\\mathrm{FWHM}}$).\n\nThe received waveform is given by the model:\n$$y(t) = s(t - \\tau) + n(t)$$\nwhere $s(t)$ is the deterministic signal template, $\\tau$ is the unknown time-of-arrival, and $n(t)$ is a zero-mean white Gaussian noise process with a constant two-sided power spectral density of $\\frac{N_0}{2}$.\n\nFor any unbiased estimator $\\hat{\\tau}$ of the parameter $\\tau$, the CRLB states that its variance is lower-bounded by the reciprocal of the Fisher information, $I(\\tau)$:\n$$\\mathrm{var}(\\hat{\\tau}) \\ge \\frac{1}{I(\\tau)}$$\nFor the given signal model in AWGN, the Fisher information for the time-delay parameter $\\tau$ is given by the formula:\n$$I(\\tau) = \\frac{2}{N_0} \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\partial s(t - \\tau)}{\\partial \\tau} \\right]^2 dt$$\nThe signal template is a Gaussian pulse:\n$$s(t) = A \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)$$\nFirst, we compute the partial derivative of the time-shifted signal $s(t - \\tau)$ with respect to $\\tau$. Let $u = t - \\tau$, so $\\frac{\\partial u}{\\partial \\tau} = -1$.\n$$\\frac{\\partial s(t - \\tau)}{\\partial \\tau} = \\frac{d}{d(t-\\tau)} \\left[ A \\exp\\left(-\\frac{(t-\\tau)^2}{2\\sigma^2}\\right) \\right] \\cdot \\frac{\\partial(t-\\tau)}{\\partial \\tau}$$\n$$\\frac{\\partial s(t - \\tau)}{\\partial \\tau} = \\left[ A \\exp\\left(-\\frac{(t-\\tau)^2}{2\\sigma^2}\\right) \\cdot \\left(-\\frac{2(t-\\tau)}{2\\sigma^2}\\right) \\right] \\cdot (-1)$$\n$$\\frac{\\partial s(t - \\tau)}{\\partial \\tau} = A \\frac{(t-\\tau)}{\\sigma^2} \\exp\\left(-\\frac{(t-\\tau)^2}{2\\sigma^2}\\right)$$\nThis can be recognized as $-s'(t-\\tau)$, where $s'(t)$ is the derivative of $s(t)$ with respect to its argument $t$. The Fisher information integral becomes:\n$$I(\\tau) = \\frac{2}{N_0} \\int_{-\\infty}^{\\infty} \\left[ A \\frac{(t-\\tau)}{\\sigma^2} \\exp\\left(-\\frac{(t-\\tau)^2}{2\\sigma^2}\\right) \\right]^2 dt$$\nSince the integration is over all time from $-\\infty$ to $\\infty$, the value of the integral is independent of the shift $\\tau$. We can simplify the calculation by setting $\\tau=0$:\n$$I(\\tau) = I = \\frac{2}{N_0} \\int_{-\\infty}^{\\infty} \\left[ A \\frac{t}{\\sigma^2} \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) \\right]^2 dt$$\n$$I = \\frac{2A^2}{N_0 \\sigma^4} \\int_{-\\infty}^{\\infty} t^2 \\exp\\left(-\\frac{t^2}{\\sigma^2}\\right) dt$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2) dx = \\frac{(2n-1)!!}{2^n a^n} \\sqrt{\\frac{\\pi}{a}}$. For our case, $n=1$ and $a = \\frac{1}{\\sigma^2}$.\nThe integral evaluates to:\n$$\\int_{-\\infty}^{\\infty} t^2 \\exp\\left(-\\frac{t^2}{\\sigma^2}\\right) dt = \\frac{1}{2(1/\\sigma^2)} \\sqrt{\\frac{\\pi}{1/\\sigma^2}} = \\frac{\\sigma^2}{2} \\sqrt{\\pi\\sigma^2} = \\frac{\\sigma^3\\sqrt{\\pi}}{2}$$\nSubstituting this back into the expression for $I$:\n$$I = \\frac{2A^2}{N_0 \\sigma^4} \\left( \\frac{\\sigma^3\\sqrt{\\pi}}{2} \\right) = \\frac{A^2 \\sqrt{\\pi}}{N_0 \\sigma}$$\nTo express this in terms of the signal energy $E_s$ and SNR, we first calculate $E_s$:\n$$E_s = \\int_{-\\infty}^{\\infty} s^2(t) dt = \\int_{-\\infty}^{\\infty} \\left[ A \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) \\right]^2 dt = A^2 \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t^2}{\\sigma^2}\\right) dt$$\nThis is another standard Gaussian integral, $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\frac{\\pi}{a}}$. With $a=\\frac{1}{\\sigma^2}$, the integral is $\\sqrt{\\pi\\sigma^2} = \\sigma\\sqrt{\\pi}$.\nThus, the signal energy is:\n$$E_s = A^2 \\sigma \\sqrt{\\pi}$$\nWe can rearrange this to find an expression for $A^2\\sqrt{\\pi} = \\frac{E_s}{\\sigma}$. Substituting this into our expression for Fisher information $I$:\n$$I = \\frac{1}{N_0 \\sigma} (A^2 \\sqrt{\\pi}) = \\frac{1}{N_0 \\sigma} \\left( \\frac{E_s}{\\sigma} \\right) = \\frac{E_s}{N_0 \\sigma^2}$$\nThe CRLB is the inverse of the Fisher information:\n$$\\mathrm{CRLB}(\\tau) = \\frac{1}{I} = \\frac{N_0 \\sigma^2}{E_s}$$\nThe problem defines the signal-to-noise ratio as $\\mathrm{SNR} = \\frac{E_s}{N_0}$. Substituting this definition:\n$$\\mathrm{CRLB}(\\tau) = \\frac{\\sigma^2}{E_s/N_0} = \\frac{\\sigma^2}{\\mathrm{SNR}}$$\nFinally, we must express the result in terms of $T_{\\mathrm{FWHM}}$ instead of $\\sigma$. The relationship is given as:\n$$T_{\\mathrm{FWHM}} = 2\\sqrt{2\\ln 2}\\,\\sigma$$\nSolving for $\\sigma^2$:\n$$\\sigma^2 = \\left( \\frac{T_{\\mathrm{FWHM}}}{2\\sqrt{2\\ln 2}} \\right)^2 = \\frac{T_{\\mathrm{FWHM}}^2}{4(2\\ln 2)} = \\frac{T_{\\mathrm{FWHM}}^2}{8\\ln 2}$$\nSubstituting this expression for $\\sigma^2$ into the CRLB formula yields the final answer:\n$$\\mathrm{CRLB}(\\tau) = \\frac{1}{\\mathrm{SNR}} \\left( \\frac{T_{\\mathrm{FWHM}}^2}{8\\ln 2} \\right) = \\frac{T_{\\mathrm{FWHM}}^2}{8 (\\ln 2) (\\mathrm{SNR})}$$\nThis result represents the minimum possible variance for any unbiased estimator of the pulse's time of arrival, given in units of seconds squared.",
            "answer": "$$\\boxed{\\frac{T_{\\mathrm{FWHM}}^2}{8 (\\ln 2) (\\mathrm{SNR})}}$$"
        },
        {
            "introduction": "Photon-counting systems operate on a different principle, detecting discrete photon events rather than a continuous waveform. This practice shifts our focus from signal estimation to statistical detection, tackling the problem of identifying a faint target against a background of random photon arrivals. You will construct a Generalized Likelihood Ratio Test (GLRT) from the underlying Poisson statistics to create a robust decision rule for target detection, a foundational skill for processing photon-counting LiDAR data .",
            "id": "3813853",
            "problem": "A photon-counting Light Detection and Ranging (LiDAR) system observes a time-gated window aligned with a hypothesized target return. The window is discretized into $L$ equal bins of width $\\Delta t$. The background photon flux is spatially and temporally uniform with rate $\\beta$ (photons per second), so that the expected number of background photons in each bin is $b = \\beta \\Delta t$. Under the null hypothesis $\\mathcal{H}_{0}$ (no target), the bin counts $\\{Y_{i}\\}_{i=1}^{L}$ are independent and identically distributed as Poisson with mean $b$. Under the alternative hypothesis $\\mathcal{H}_{1}$ (target present), the target contributes an unknown, nonnegative expected signal count $A \\ge 0$ that is uniformly spread across the $L$ bins, so that the bin means become $b + A/L$. Assume the bins are conditionally independent given the hypothesis.\n\nStarting from the definition of the Poisson probability mass function and independence, formulate the Generalized Likelihood Ratio Test (GLRT) for deciding between $\\mathcal{H}_{0}$ and $\\mathcal{H}_{1}$ when the unknown signal amplitude $A$ is treated as a nuisance parameter to be maximized over under $\\mathcal{H}_{1}$. Show that the GLRT reduces to a threshold test on the aggregated count $S = \\sum_{i=1}^{L} Y_{i}$. Then, by approximating the distribution of $S$ under $\\mathcal{H}_{0}$ by a Gaussian distribution when $L$ is large enough that the total expected background count $\\mu_{0} = L b$ is moderate-to-large, derive an approximate closed-form detection threshold $\\tau_{\\alpha}$ that achieves a fixed false alarm probability $\\alpha_{\\mathrm{FA}}$.\n\nFinally, evaluate $\\tau_{\\alpha}$ numerically for the following parameter values: $\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$, $\\Delta t = 0.5\\,\\mathrm{ns}$, $L = 800$, and $\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$. Report the approximate threshold as a real number, rounded to four significant figures. State your final numerical threshold value (dimensionless) as the answer.",
            "solution": "The problem statement is validated as follows.\n1.  **Givens Extraction**:\n    -   Number of time bins: $L$.\n    -   Bin width: $\\Delta t$.\n    -   Background photon flux rate: $\\beta$ (photons per second).\n    -   Expected background photons per bin: $b = \\beta \\Delta t$.\n    -   Bin counts (observations): $\\{Y_{i}\\}_{i=1}^{L}$.\n    -   Null Hypothesis, $\\mathcal{H}_{0}$: $Y_{i} \\sim \\text{Poisson}(b)$ independently for $i=1, \\dots, L$.\n    -   Alternative Hypothesis, $\\mathcal{H}_{1}$: $Y_{i} \\sim \\text{Poisson}(b + A/L)$ independently for $i=1, \\dots, L$, where $A \\ge 0$ is an unknown, non-negative signal count.\n    -   Aggregated count: $S = \\sum_{i=1}^{L} Y_{i}$.\n    -   Total expected background count under $\\mathcal{H}_0$: $\\mu_{0} = L b$.\n    -   Approximation condition: $\\mu_0$ is moderate-to-large, allowing a Gaussian approximation for the distribution of $S$ under $\\mathcal{H}_0$.\n    -   Target false alarm probability: $\\alpha_{\\mathrm{FA}}$.\n    -   Numerical values: $\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$, $\\Delta t = 0.5\\,\\mathrm{ns}$, $L = 800$, $\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$.\n\n2.  **Validation**:\n    -   **Scientifically Grounded**: The problem is a standard application of statistical decision theory (Generalized Likelihood Ratio Test) to photon-counting LiDAR data analysis. The use of the Poisson distribution for photon counts is a fundamental model in optics and remote sensing. The Gaussian approximation for the sum of many independent random variables is justified by the Central Limit Theorem. The problem is scientifically and mathematically sound.\n    -   **Well-Posed**: The problem is clearly defined with all necessary parameters, hypotheses, and constraints. It requests a specific derivation and a numerical calculation, which leads to a unique solution.\n    -   **Objective**: The problem is stated using precise, unambiguous mathematical and scientific language.\n\n3.  **Verdict**: The problem is valid.\n\nA complete solution is provided below.\n\nThe Generalized Likelihood Ratio Test (GLRT) is used to decide between the two hypotheses, $\\mathcal{H}_{0}$ and $\\mathcal{H}_{1}$. The test statistic is the ratio of the maximized likelihood under $\\mathcal{H}_{1}$ to the likelihood under $\\mathcal{H}_{0}$.\n\nLet the observed data be $\\mathbf{y} = \\{y_1, y_2, \\ldots, y_L\\}$. The probability mass function (PMF) for a Poisson random variable with mean $\\lambda$ is $p(k|\\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$.\n\nUnder the null hypothesis $\\mathcal{H}_{0}$, the likelihood of observing $\\mathbf{y}$ is:\n$$p(\\mathbf{y} | \\mathcal{H}_{0}) = \\prod_{i=1}^{L} \\frac{b^{y_i} \\exp(-b)}{y_i!} = \\frac{b^{\\sum_{i=1}^{L} y_i} \\exp(-Lb)}{\\prod_{i=1}^{L} y_i!}$$\nLet $S = \\sum_{i=1}^{L} y_i$ be the total count. The likelihood becomes:\n$$p(\\mathbf{y} | \\mathcal{H}_{0}) = \\frac{b^{S} \\exp(-Lb)}{\\prod_{i=1}^{L} y_i!}$$\n\nUnder the alternative hypothesis $\\mathcal{H}_{1}$, the likelihood depends on the unknown nuisance parameter $A \\ge 0$:\n$$p(\\mathbf{y} | \\mathcal{H}_{1}, A) = \\prod_{i=1}^{L} \\frac{(b + A/L)^{y_i} \\exp(-(b + A/L))}{y_i!} = \\frac{(b + A/L)^{S} \\exp(-L(b + A/L))}{\\prod_{i=1}^{L} y_i!} = \\frac{(b + A/L)^{S} \\exp(-Lb - A)}{\\prod_{i=1}^{L} y_i!}$$\nTo formulate the GLRT, we first find the maximum likelihood estimate (MLE) of $A$, denoted $\\hat{A}_{\\text{ML}}$, by maximizing $p(\\mathbf{y} | \\mathcal{H}_{1}, A)$ with respect to $A \\ge 0$. It is equivalent and simpler to maximize the log-likelihood:\n$$\\ln p(\\mathbf{y} | \\mathcal{H}_{1}, A) = S \\ln(b + A/L) - Lb - A - \\sum_{i=1}^{L} \\ln(y_i!)$$\nDifferentiating with respect to $A$:\n$$\\frac{d}{dA} \\ln p(\\mathbf{y} | \\mathcal{H}_{1}, A) = \\frac{S}{b + A/L} \\cdot \\frac{1}{L} - 1 = \\frac{S}{Lb + A} - 1$$\nSetting the derivative to zero yields $S = Lb + A$, or $A = S - Lb$. We must respect the constraint $A \\ge 0$.\n- If $S - Lb \\ge 0$, the unconstrained maximum is in the valid region, so $\\hat{A}_{\\text{ML}} = S - Lb$.\n- If $S - Lb  0$, the derivative is negative for all $A \\ge 0$, meaning the function is decreasing. The maximum thus occurs at the boundary $A=0$, so $\\hat{A}_{\\text{ML}} = 0$.\nCombining these cases, the MLE is $\\hat{A}_{\\text{ML}} = \\max(0, S - Lb)$.\n\nThe numerator of the GLRT statistic is the likelihood under $\\mathcal{H}_1$ evaluated at $\\hat{A}_{\\text{ML}}$:\n$$\\sup_{A \\ge 0} p(\\mathbf{y} | \\mathcal{H}_{1}, A) = p(\\mathbf{y} | \\mathcal{H}_{1}, \\hat{A}_{\\text{ML}})$$\n- If $S \\le Lb$, then $\\hat{A}_{\\text{ML}} = 0$, and the supremum is $p(\\mathbf{y} | \\mathcal{H}_{1}, 0) = p(\\mathbf{y} | \\mathcal{H}_{0})$.\n- If $S  Lb$, then $\\hat{A}_{\\text{ML}} = S - Lb$. The mean per bin becomes $b + \\hat{A}_{\\text{ML}}/L = b + (S - Lb)/L = S/L$. The maximized likelihood is:\n$$\\frac{(S/L)^{S} \\exp(-L(S/L))}{\\prod_{i=1}^{L} y_i!} = \\frac{(S/L)^{S} \\exp(-S)}{\\prod_{i=1}^{L} y_i!}$$\n\nThe GLRT statistic $\\Lambda(\\mathbf{y})$ is the ratio:\n$$\\Lambda(\\mathbf{y}) = \\frac{\\sup_{A \\ge 0} p(\\mathbf{y} | \\mathcal{H}_{1}, A)}{p(\\mathbf{y} | \\mathcal{H}_{0})}$$\n- If $S \\le Lb$, $\\Lambda(\\mathbf{y}) = 1$.\n- If $S  Lb$, $\\Lambda(\\mathbf{y}) = \\frac{(S/L)^{S} \\exp(-S) / (\\prod y_i!)}{b^S \\exp(-Lb) / (\\prod y_i!)} = \\left(\\frac{S}{Lb}\\right)^S \\exp(-(S - Lb))$.\n\nThe decision rule is to choose $\\mathcal{H}_{1}$ if $\\Lambda(\\mathbf{y})  \\gamma$ for a threshold $\\gamma  1$.\nConsider the log-likelihood ratio, $T(S) = \\ln(\\Lambda(\\mathbf{y}))$.\n$T(S) = \\begin{cases} S \\ln(S/Lb) - (S - Lb)  \\text{if } S  Lb \\\\ 0  \\text{if } S \\le Lb \\end{cases}$\nTo show this test is equivalent to a threshold on $S$, we examine the derivative of $T(S)$ for $S  Lb$:\n$$\\frac{d T(S)}{d S} = \\frac{d}{dS}[S\\ln S - S\\ln(Lb) - S + Lb] = (\\ln S + 1) - \\ln(Lb) - 1 = \\ln\\left(\\frac{S}{Lb}\\right)$$\nFor $S  Lb$, $S/Lb  1$, so $\\ln(S/Lb)  0$. This means $T(S)$ is a strictly increasing function of $S$ for $S  Lb$. Since $T(S)$ is $0$ for $S \\le Lb$ and positive and increasing for $S  Lb$, it is a non-decreasing function of $S$ everywhere. Therefore, the test $\\Lambda(\\mathbf{y})  \\gamma$ (or $T(S)  \\ln\\gamma$) is entirely equivalent to a simpler test $S  \\tau$ for some threshold $\\tau$. This confirms that the GLRT reduces to a threshold test on the aggregated count $S$.\n\nNext, we derive the approximate threshold $\\tau_{\\alpha}$ for a given false alarm probability $\\alpha_{\\mathrm{FA}}$.\nUnder $\\mathcal{H}_{0}$, the counts $Y_i$ are independent and identically distributed as $\\text{Poisson}(b)$. The sum $S = \\sum_{i=1}^{L} Y_i$ follows a Poisson distribution with mean $\\mu_0 = Lb$. So, $S | \\mathcal{H}_0 \\sim \\text{Poisson}(Lb)$.\nFor large $\\mu_0 = Lb$, the Poisson distribution can be approximated by a Gaussian distribution with the same mean and variance. The variance of a $\\text{Poisson}(Lb)$ distribution is also $Lb$.\nThus, $S | \\mathcal{H}_0 \\approx \\mathcal{N}(\\mu_0, \\sigma_0^2)$, where $\\mu_0 = Lb$ and $\\sigma_0^2 = Lb$.\n\nThe false alarm probability is the probability of deciding $\\mathcal{H}_1$ when $\\mathcal{H}_0$ is true:\n$$\\alpha_{\\mathrm{FA}} = P(S  \\tau_{\\alpha} | \\mathcal{H}_0)$$\nUsing the Gaussian approximation, we standardize the variable $S$. Let $Z = \\frac{S - \\mu_0}{\\sigma_0}$ be an approximately standard normal variable, $Z \\sim \\mathcal{N}(0, 1)$.\n$$\\alpha_{\\mathrm{FA}} = P\\left(\\frac{S - \\mu_0}{\\sigma_0}  \\frac{\\tau_{\\alpha} - \\mu_0}{\\sigma_0}\\right) \\approx P\\left(Z  \\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right)$$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution. Then $P(Z  z) = 1 - \\Phi(z)$.\nSo, $\\alpha_{\\mathrm{FA}} = 1 - \\Phi\\left(\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right)$.\nThis implies $\\Phi\\left(\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right) = 1 - \\alpha_{\\mathrm{FA}}$.\nBy applying the inverse normal CDF, $\\Phi^{-1}$:\n$$\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}} = \\Phi^{-1}(1 - \\alpha_{\\mathrm{FA}})$$\nSolving for $\\tau_{\\alpha}$:\n$$\\tau_{\\alpha} = Lb + \\sqrt{Lb} \\cdot \\Phi^{-1}(1 - \\alpha_{\\mathrm{FA}})$$\nThis is the desired closed-form expression for the approximate threshold.\n\nFinally, we evaluate $\\tau_{\\alpha}$ for the given numerical parameters:\n- $\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$\n- $\\Delta t = 0.5\\,\\mathrm{ns} = 0.5 \\times 10^{-9}\\,\\mathrm{s}$\n- $L = 800$\n- $\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$\n\nFirst, calculate the expected number of background photons per bin, $b$:\n$$b = \\beta \\Delta t = (5.0 \\times 10^{7}) \\times (0.5 \\times 10^{-9}) = 0.025$$\nNext, calculate the total expected background count, $\\mu_0$:\n$$\\mu_0 = Lb = 800 \\times 0.025 = 20$$\nThe standard deviation of the total count under $\\mathcal{H}_0$ is:\n$$\\sigma_0 = \\sqrt{Lb} = \\sqrt{20}$$\nThe value $\\mu_0 = 20$ is sufficiently large to justify the Gaussian approximation.\nWe need the quantile from the standard normal distribution corresponding to $1-\\alpha_{\\mathrm{FA}}$:\n$$z_{\\alpha_{\\mathrm{FA}}} = \\Phi^{-1}(1 - 1.0 \\times 10^{-3}) = \\Phi^{-1}(0.999)$$\nFrom standard statistical tables or a calculator, $\\Phi^{-1}(0.999) \\approx 3.09023$.\n\nNow, substitute these values into the expression for $\\tau_{\\alpha}$:\n$$\\tau_{\\alpha} = 20 + \\sqrt{20} \\cdot \\Phi^{-1}(0.999) \\approx 20 + (4.472136) \\times (3.09023)$$\n$$\\tau_{\\alpha} \\approx 20 + 13.81932 = 33.81932$$\nRounding to four significant figures, we get:\n$$\\tau_{\\alpha} \\approx 33.82$$\n\nThis is the approximate detection threshold on the total number of photons counted. If the observed count $S$ exceeds this value, the system declares the presence of a target.",
            "answer": "$$\\boxed{33.82}$$"
        }
    ]
}