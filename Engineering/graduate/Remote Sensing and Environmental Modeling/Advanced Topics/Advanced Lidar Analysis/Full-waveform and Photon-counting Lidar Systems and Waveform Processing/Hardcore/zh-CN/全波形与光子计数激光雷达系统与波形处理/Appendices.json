{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了全波形激光雷达（LiDAR）系统的数字采样率与其空间分辨率之间的基本联系。理解这种关系对于解译波形数据以及在系统设计和数据存储方面做出明智决策至关重要。通过这个练习 ，你将从第一性原理出发推导距离分辨率（range-bin size），并分析分辨率与数据量之间的关键权衡。",
            "id": "3813872",
            "problem": "一个机载光探测和测距（LiDAR）系统记录来自森林冠层的全波形回波。数字化仪以速率 $f_s$ 对反向散射的模拟信号进行均匀采样，并以固定的位深度存储每个样本。系统参数如下：\n- 采样率 $f_s = 2.5\\,\\mathrm{GHz}$，\n- 每次激光发射的记录时长 $T = 20\\,\\mu\\mathrm{s}$，\n- 每个样本的位深度 $b = 12\\,\\mathrm{bits}$，\n- 光速 $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n从传播时间与距离之间的双程飞行时间关系以及均匀采样的定义出发，推导该全波形数字化的距离仓大小，并计算其数值。将最终的距离仓大小以厘米表示，并将答案四舍五入到四位有效数字。\n\n此外，从第一性原理出发，分析在固定波形时长 $T$ 的情况下，增加采样率 $f_s$ 与由此产生的内存占用之间的权衡关系。您的分析应涵盖样本数量、总存储比特数和记录时长如何影响存储需求，并应将这些考量与光子计数激光雷达进行对比，后者是对单个光子探测事件加盖时间戳，而不是对模拟波形进行均匀采样。不需要对内存进行数值评估；仅提供符号评估和定性讨论。",
            "solution": "问题陈述被评估为有效。它在科学上基于遥感和数字信号处理的原理，问题是适定的（well-posed），有足够的信息得到唯一解，并以客观、精确的语言表达。所有参数都符合物理实际。该问题需要进行标准推导、数值计算和概念分析，所有这些都适用于该领域。\n\n按照要求，该问题分两部分解决：首先，推导和计算距离仓大小；其次，对存储权衡进行定性分析。\n\n**第一部分：距离仓大小的推导与计算**\n\nLiDAR的基本原理是测量光脉冲的飞行时间。光从传感器传播到目标再返回传感器的总距离 $d$ 是由光速 $c$ 与双程传播时间 $\\Delta t$ 的乘积给出的。\n$$d = c \\Delta t$$\n到目标的距离 $R$ 是这个总距离的一半，因为它代表单程路径。\n$$R = \\frac{d}{2} = \\frac{c \\Delta t}{2}$$\n这就是双程飞行时间关系。\n\n全波形LiDAR系统的数字化仪以均匀采样率 $f_s$ 对模拟反向散射信号进行采样。任意两个连续样本之间的时间间隔是采样周期 $\\Delta t_s$，它是采样频率的倒数：\n$$\\Delta t_s = \\frac{1}{f_s}$$\n这个采样周期 $\\Delta t_s$ 代表了数字化波形中可以分辨的最小时间特征。因此，它决定了可能达到的最精细的距离分辨率，即距离仓大小 $\\Delta R$。距离仓大小是与连续样本之间的时间间隔 $\\Delta t_s$ 相对应的距离变化量 $\\Delta R$。\n\n通过在距离方程中用 $\\Delta t_s$ 替代 $\\Delta t$，我们可以推导出距离仓大小的表达式：\n$$\\Delta R = \\frac{c \\Delta t_s}{2}$$\n将 $\\Delta t_s$ 用 $f_s$ 表示的表达式代入，我们得到距离仓大小的最终公式：\n$$\\Delta R = \\frac{c}{2 f_s}$$\n现在，我们使用给定的参数计算 $\\Delta R$ 的数值：\n- 光速, $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 采样率, $f_s = 2.5\\,\\mathrm{GHz} = 2.5 \\times 10^{9}\\,\\mathrm{s}^{-1}$\n\n将这些值代入推导出的方程：\n$$\\Delta R = \\frac{2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{2 \\times (2.5 \\times 10^{9}\\,\\mathrm{s}^{-1})} = \\frac{2.99792458 \\times 10^{8}}{5.0 \\times 10^{9}}\\,\\mathrm{m}$$\n$$\\Delta R = 0.0599584916\\,\\mathrm{m}$$\n问题要求答案以厘米表示。我们使用换算关系 $1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$：\n$$\\Delta R = 0.0599584916 \\times 100\\,\\mathrm{cm} = 5.99584916\\,\\mathrm{cm}$$\n最后，我们将结果四舍五入到四位有效数字：\n$$\\Delta R \\approx 5.996\\,\\mathrm{cm}$$\n\n**第二部分：存储权衡分析**\n\n本节分析全波形系统中与采样率相关的权衡，并将其与光子计数系统进行对比。\n\n对于全波形激光雷达（FWL）系统，单次激光发射的数据存储需求是确定性的。对于固定的记录时长 $T$ 和采样率 $f_s$，总样本数 $N_{\\text{samples}}$ 由下式给出：\n$$N_{\\text{samples}} = f_s \\times T$$\n每个样本以 $b$ 比特的位深度进行量化。因此，每个波形的总内存占用 $M_{\\text{FWL}}$ 为：\n$$M_{\\text{FWL}} = N_{\\text{samples}} \\times b = f_s \\times T \\times b$$\n从这个关系中，在保持时长 $T$ 固定的情况下增加采样率 $f_s$ 的权衡是显而易见的。内存占用 $M_{\\text{FWL}}$ 与 $f_s$ 成正比。增加 $f_s$ 会产生更小的距离仓大小 $\\Delta R = c/(2f_s)$，这提高了纵向分辨率和区分近距离物体的能力。然而，这种增强的分辨率是以数据量、内存需求以及随后的数据传输和处理开销的线性增加为直接代价的。对于每次激光发射，系统都必须存储一个庞大而密集的样本值数组，无论是否返回了有意义的信号。\n\n相比之下，光子计数激光雷达（PCL）系统的工作原理不同。它不记录连续的波形，而是探测离散的光子到达事件，并高精度地记录它们的时间戳。因此，每次发射的数据量不是固定的。设 $N_{\\text{photons}}$ 为单次激光发射在观测窗口内探测到的光子数，并设 $b_{\\text{ts}}$ 为存储单个时间戳所需的比特数。PCL系统的内存占用 $M_{\\text{PCL}}$ 近似为：\n$$M_{\\text{PCL}} \\approx N_{\\text{photons}} \\times b_{\\text{ts}}$$\n关键区别在于 $N_{\\text{photons}}$ 不是一个固定的系统参数；它是一个随机变量，取决于信号强度，而信号强度又是目标反射率、距离、大气衰减和背景光照的函数。\n\n这导致了存储考量上的以下对比：\n1.  **数据结构：** FWL生成密集的、规则结构的数据。PCL生成稀疏的、事件驱动的数据。\n2.  **对信号的依赖性：** FWL的存储需求与返回信号的强度无关。即使波形只包含噪声，也会被完整存储。PCL的存储需求与探测到的光子数成正比。在低信号或稀疏回波环境（例如，水面、暗目标、高海拔）中，PCL的数据效率极高。\n3.  **分辨率的影响：** 在FWL中，提高距离分辨率需要更高的 $f_s$，这会统一增加所有采集的数据量。在PCL中，提高时间分辨率意味着使用更精确的时间标记单元（实际上是增加 $b_{\\text{ts}}$ 或底层的时钟速率），这会增加每个探测到的光子的数据大小，但总数据量仍然取决于 $N_{\\text{photons}}$。\n4.  **系统局限性：** FWL通过记录高振幅信号来平稳处理高功率回波。PCL系统在高信号或高背景噪声条件下可能会遭受探测器饱和的影响，此时入射光子的速率超过了探测器分辨单个事件的能力。在这种情况下，记录的事件数量可能无法代表真实信号，并且数据量可能会变得很大。\n\n总而言之，FWL的权衡是距离分辨率和数据量之间的直接成本关系。PCL的权衡更为复杂，涉及单光子灵敏度、稀疏条件下的数据效率以及高信号条件下对饱和的敏感性之间的平衡。系统之间的选择根本上取决于应用和预期的信号环境。",
            "answer": "$$\n\\boxed{5.996}\n$$"
        },
        {
            "introduction": "本练习将解决在光子计数激光雷达（LiDAR）中一个核心挑战：在噪声背景下探测微弱信号。你将运用统计决策理论的原理来设计一个广义似然比检验（GLRT），这是完成此类任务的强大工具。通过该实践 ，你将学习如何构建假设并推导决策阈值，以满足如固定虚警率 $P_{FA}$ 等特定的性能标准。",
            "id": "3813853",
            "problem": "一个光子计数激光雷达（LiDAR）系统观测一个与假设目标回波对齐的时间门控窗口。该窗口被离散化为 $L$ 个宽度为 $\\Delta t$ 的等长区间。背景光子通量在空间和时间上是均匀的，其速率为 $\\beta$（光子/秒），因此每个区间中背景光子的期望数为 $b = \\beta \\Delta t$。在零假设 $\\mathcal{H}_{0}$（无目标）下，各区间的计数值 $\\{Y_{i}\\}_{i=1}^{L}$ 独立同分布，服从均值为 $b$ 的泊松分布。在备择假设 $\\mathcal{H}_{1}$（有目标）下，目标贡献了一个未知的、非负的期望信号计数值 $A \\ge 0$，该值均匀分布在 $L$ 个区间上，因此各区间的均值变为 $b + A/L$。假设在给定假设的条件下，各区间是条件独立的。\n\n从泊松概率质量函数和独立性的定义出发，当未知信号幅度 $A$ 在 $\\mathcal{H}_{1}$ 下被视为一个待最大化的讨厌参数时，构建用于在 $\\mathcal{H}_{0}$ 和 $\\mathcal{H}_{1}$ 之间进行决策的广义似然比检验（GLRT）。证明该GLRT可简化为对总计数值 $S = \\sum_{i=1}^{L} Y_{i}$ 的阈值检验。然后，当 $L$ 足够大，使得总期望背景计数值 $\\mu_{0} = L b$ 为中到大时，通过用高斯分布近似 $S$ 在 $\\mathcal{H}_{0}$ 下的分布，推导出一个近似的闭式解检测阈值 $\\tau_{\\alpha}$，该阈值可达到一个固定的虚警概率 $\\alpha_{\\mathrm{FA}}$。\n\n最后，对以下参数值进行 $\\tau_{\\alpha}$ 的数值计算：$\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$，$\\Delta t = 0.5\\,\\mathrm{ns}$，$L = 800$ 以及 $\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$。将近似阈值报告为一个实数，四舍五入至四位有效数字。将最终的数值阈值（无量纲）作为答案。",
            "solution": "问题陈述的验证如下。\n1.  **已知条件提取**：\n    -   时间区间数量：$L$。\n    -   区间宽度：$\\Delta t$。\n    -   背景光子通量速率：$\\beta$（光子/秒）。\n    -   每个区间的期望背景光子数：$b = \\beta \\Delta t$。\n    -   区间计数值（观测值）：$\\{Y_{i}\\}_{i=1}^{L}$。\n    -   零假设 $\\mathcal{H}_{0}$：对于 $i=1, \\dots, L$，$Y_{i} \\sim \\text{Poisson}(b)$ 且相互独立。\n    -   备择假设 $\\mathcal{H}_{1}$：对于 $i=1, \\dots, L$，$Y_{i} \\sim \\text{Poisson}(b + A/L)$ 且相互独立，其中 $A \\ge 0$ 是一个未知的非负信号计数值。\n    -   总计数值：$S = \\sum_{i=1}^{L} Y_{i}$。\n    -   $\\mathcal{H}_0$ 下的总期望背景计数值：$\\mu_{0} = L b$。\n    -   近似条件：$\\mu_0$ 为中到大值，允许对 $\\mathcal{H}_0$ 下的 $S$ 的分布进行高斯近似。\n    -   目标虚警概率：$\\alpha_{\\mathrm{FA}}$。\n    -   数值：$\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$，$\\Delta t = 0.5\\,\\mathrm{ns}$，$L = 800$，$\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$。\n\n2.  **验证**：\n    -   **科学依据**：该问题是统计决策理论（广义似然比检验）在光子计数激光雷达数据分析中的一个标准应用。使用泊松分布来模拟光子计数是光学和遥感领域的一个基本模型。对大量独立随机变量之和使用高斯近似是由中心极限定理保证的。该问题在科学上和数学上都是合理的。\n    -   **良态问题**：该问题定义清晰，包含了所有必要的参数、假设和约束。它要求进行特定的推导和数值计算，这会导出一个唯一的解。\n    -   **客观性**：该问题使用精确、无歧义的数学和科学语言进行陈述。\n\n3.  **结论**：该问题有效。\n\n下面提供一个完整的解答。\n\n广义似然比检验（GLRT）用于在两个假设 $\\mathcal{H}_{0}$ 和 $\\mathcal{H}_{1}$ 之间进行决策。检验统计量是在 $\\mathcal{H}_{1}$ 下的最大化似然与在 $\\mathcal{H}_{0}$ 下的似然之比。\n\n设观测数据为 $\\mathbf{y} = \\{y_1, y_2, \\ldots, y_L\\}$。均值为 $\\lambda$ 的泊松随机变量的概率质量函数（PMF）为 $p(k|\\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。\n\n在零假设 $\\mathcal{H}_{0}$ 下，观测到 $\\mathbf{y}$ 的似然为：\n$$p(\\mathbf{y} | \\mathcal{H}_{0}) = \\prod_{i=1}^{L} \\frac{b^{y_i} \\exp(-b)}{y_i!} = \\frac{b^{\\sum_{i=1}^{L} y_i} \\exp(-Lb)}{\\prod_{i=1}^{L} y_i!}$$\n令 $S = \\sum_{i=1}^{L} y_i$ 为总计数值。似然函数变为：\n$$p(\\mathbf{y} | \\mathcal{H}_{0}) = \\frac{b^{S} \\exp(-Lb)}{\\prod_{i=1}^{L} y_i!}$$\n\n在备择假设 $\\mathcal{H}_{1}$ 下，似然函数依赖于未知的讨厌参数 $A \\ge 0$：\n$$p(\\mathbf{y} | \\mathcal{H}_{1}, A) = \\prod_{i=1}^{L} \\frac{(b + A/L)^{y_i} \\exp(-(b + A/L))}{y_i!} = \\frac{(b + A/L)^{S} \\exp(-L(b + A/L))}{\\prod_{i=1}^{L} y_i!} = \\frac{(b + A/L)^{S} \\exp(-Lb - A)}{\\prod_{i=1}^{L} y_i!}$$\n为构建GLRT，我们首先通过关于 $A \\ge 0$ 最大化 $p(\\mathbf{y} | \\mathcal{H}_{1}, A)$ 来找到 $A$ 的最大似然估计（MLE），记为 $\\hat{A}_{\\text{ML}}$。这等价于最大化对数似然，且更简单：\n$$\\ln p(\\mathbf{y} | \\mathcal{H}_{1}, A) = S \\ln(b + A/L) - Lb - A - \\sum_{i=1}^{L} \\ln(y_i!)$$\n对 $A$ 求导：\n$$\\frac{d}{dA} \\ln p(\\mathbf{y} | \\mathcal{H}_{1}, A) = \\frac{S}{b + A/L} \\cdot \\frac{1}{L} - 1 = \\frac{S}{Lb + A} - 1$$\n令导数为零得到 $S = Lb + A$，即 $A = S - Lb$。我们必须遵守约束 $A \\ge 0$。\n- 如果 $S - Lb \\ge 0$，无约束最大值在有效区域内，因此 $\\hat{A}_{\\text{ML}} = S - Lb$。\n- 如果 $S - Lb  0$，对于所有 $A \\ge 0$ 导数都为负，意味着函数是递减的。因此最大值出现在边界 $A=0$ 处，所以 $\\hat{A}_{\\text{ML}} = 0$。\n综合这两种情况，MLE为 $\\hat{A}_{\\text{ML}} = \\max(0, S - Lb)$。\n\nGLRT统计量的分子是在 $\\hat{A}_{\\text{ML}}$ 处求值的 $\\mathcal{H}_1$ 下的似然函数：\n$$\\sup_{A \\ge 0} p(\\mathbf{y} | \\mathcal{H}_{1}, A) = p(\\mathbf{y} | \\mathcal{H}_{1}, \\hat{A}_{\\text{ML}})$$\n- 如果 $S \\le Lb$，则 $\\hat{A}_{\\text{ML}} = 0$，上确界为 $p(\\mathbf{y} | \\mathcal{H}_{1}, 0) = p(\\mathbf{y} | \\mathcal{H}_{0})$。\n- 如果 $S  Lb$，则 $\\hat{A}_{\\text{ML}} = S - Lb$。每个区间的均值变为 $b + \\hat{A}_{\\text{ML}}/L = b + (S - Lb)/L = S/L$。最大化的似然为：\n$$\\frac{(S/L)^{S} \\exp(-L(S/L))}{\\prod_{i=1}^{L} y_i!} = \\frac{(S/L)^{S} \\exp(-S)}{\\prod_{i=1}^{L} y_i!}$$\n\nGLRT统计量 $\\Lambda(\\mathbf{y})$ 是该比率：\n$$\\Lambda(\\mathbf{y}) = \\frac{\\sup_{A \\ge 0} p(\\mathbf{y} | \\mathcal{H}_{1}, A)}{p(\\mathbf{y} | \\mathcal{H}_{0})}$$\n- 如果 $S \\le Lb$，$\\Lambda(\\mathbf{y}) = 1$。\n- 如果 $S  Lb$，$\\Lambda(\\mathbf{y}) = \\frac{(S/L)^{S} \\exp(-S) / (\\prod y_i!)}{b^S \\exp(-Lb) / (\\prod y_i!)} = \\left(\\frac{S}{Lb}\\right)^S \\exp(-(S - Lb))$。\n\n决策规则是，如果 $\\Lambda(\\mathbf{y})  \\gamma$（对于某个阈值 $\\gamma  1$），则选择 $\\mathcal{H}_{1}$。\n考虑对数似然比，$T(S) = \\ln(\\Lambda(\\mathbf{y}))$。\n$T(S) = \\begin{cases} S \\ln(S/Lb) - (S - Lb)  \\text{if } S  Lb \\\\ 0  \\text{if } S \\le Lb \\end{cases}$\n为证明此检验等价于对 $S$ 的阈值检验，我们考察当 $S  Lb$ 时 $T(S)$ 的导数：\n$$\\frac{d T(S)}{d S} = \\frac{d}{dS}[S\\ln S - S\\ln(Lb) - S + Lb] = (\\ln S + 1) - \\ln(Lb) - 1 = \\ln\\left(\\frac{S}{Lb}\\right)$$\n对于 $S  Lb$，$S/Lb  1$，因此 $\\ln(S/Lb)  0$。这意味着当 $S  Lb$ 时，$T(S)$ 是 $S$ 的一个严格递增函数。由于当 $S \\le Lb$ 时 $T(S)$ 为 $0$，而当 $S  Lb$ 时为正且递增，所以它在任何地方都是 $S$ 的一个非递减函数。因此，检验 $\\Lambda(\\mathbf{y})  \\gamma$（或 $T(S)  \\ln\\gamma$）完全等价于一个更简单的检验 $S  \\tau$（对于某个阈值 $\\tau$）。这证实了GLRT可简化为对总计数值 $S$ 的阈值检验。\n\n接下来，我们为给定的虚警概率 $\\alpha_{\\mathrm{FA}}$ 推导近似阈值 $\\tau_{\\alpha}$。\n在 $\\mathcal{H}_{0}$ 下，计数值 $Y_i$ 独立同分布于 $\\text{Poisson}(b)$。其和 $S = \\sum_{i=1}^{L} Y_i$ 服从均值为 $\\mu_0 = Lb$ 的泊松分布。因此，$S | \\mathcal{H}_0 \\sim \\text{Poisson}(Lb)$。\n对于较大的 $\\mu_0 = Lb$，泊松分布可以由具有相同均值和方差的高斯分布来近似。$\\text{Poisson}(Lb)$ 分布的方差也是 $Lb$。\n因此，$S | \\mathcal{H}_0 \\approx \\mathcal{N}(\\mu_0, \\sigma_0^2)$，其中 $\\mu_0 = Lb$ 且 $\\sigma_0^2 = Lb$。\n\n虚警概率是在 $\\mathcal{H}_0$ 为真时做出 $\\mathcal{H}_1$ 决策的概率：\n$$\\alpha_{\\mathrm{FA}} = P(S  \\tau_{\\alpha} | \\mathcal{H}_0)$$\n使用高斯近似，我们对变量 $S$ 进行标准化。令 $Z = \\frac{S - \\mu_0}{\\sigma_0}$ 为一个近似的标准正态变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$\\alpha_{\\mathrm{FA}} = P\\left(\\frac{S - \\mu_0}{\\sigma_0}  \\frac{\\tau_{\\alpha} - \\mu_0}{\\sigma_0}\\right) \\approx P\\left(Z  \\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right)$$\n令 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF）。那么 $P(Z  z) = 1 - \\Phi(z)$。\n所以，$\\alpha_{\\mathrm{FA}} = 1 - \\Phi\\left(\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right)$。\n这意味着 $\\Phi\\left(\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}}\\right) = 1 - \\alpha_{\\mathrm{FA}}$。\n通过应用标准正态分布的逆累积分布函数 $\\Phi^{-1}$：\n$$\\frac{\\tau_{\\alpha} - Lb}{\\sqrt{Lb}} = \\Phi^{-1}(1 - \\alpha_{\\mathrm{FA}})$$\n求解 $\\tau_{\\alpha}$：\n$$\\tau_{\\alpha} = Lb + \\sqrt{Lb} \\cdot \\Phi^{-1}(1 - \\alpha_{\\mathrm{FA}})$$\n这就是所求的近似阈值的闭式解表达式。\n\n最后，我们对给定的数值参数计算 $\\tau_{\\alpha}$：\n- $\\beta = 5.0 \\times 10^{7}\\,\\mathrm{s}^{-1}$\n- $\\Delta t = 0.5\\,\\mathrm{ns} = 0.5 \\times 10^{-9}\\,\\mathrm{s}$\n- $L = 800$\n- $\\alpha_{\\mathrm{FA}} = 1.0 \\times 10^{-3}$\n\n首先，计算每个区间的期望背景光子数 $b$：\n$$b = \\beta \\Delta t = (5.0 \\times 10^{7}) \\times (0.5 \\times 10^{-9}) = 0.025$$\n接着，计算总期望背景计数值 $\\mu_0$：\n$$\\mu_0 = Lb = 800 \\times 0.025 = 20$$\n在 $\\mathcal{H}_0$ 下总计数值的标准差是：\n$$\\sigma_0 = \\sqrt{Lb} = \\sqrt{20}$$\n$\\mu_0 = 20$ 这个值足够大，可以证明使用高斯近似是合理的。\n我们需要从标准正态分布中找到对应于 $1-\\alpha_{\\mathrm{FA}}$ 的分位数：\n$$z_{\\alpha_{\\mathrm{FA}}} = \\Phi^{-1}(1 - 1.0 \\times 10^{-3}) = \\Phi^{-1}(0.999)$$\n从标准统计表或计算器可知，$\\Phi^{-1}(0.999) \\approx 3.09023$。\n\n现在，将这些值代入 $\\tau_{\\alpha}$ 的表达式中：\n$$\\tau_{\\alpha} = 20 + \\sqrt{20} \\cdot \\Phi^{-1}(0.999) \\approx 20 + (4.472136) \\times (3.09023)$$\n$$\\tau_{\\alpha} \\approx 20 + 13.81932 = 33.81932$$\n四舍五入到四位有效数字，我们得到：\n$$\\tau_{\\alpha} \\approx 33.82$$\n\n这就是总光子计数的近似检测阈值。如果观测到的计数值 $S$ 超过此值，系统就宣告存在目标。",
            "answer": "$$\\boxed{33.82}$$"
        },
        {
            "introduction": "一个检测算法的优劣必须通过可量化的性能来评判。作为本章的综合性练习，本实践将指导你使用接收者操作特征（ROC）曲线来构建和评估全波形与光子计数激光雷达的探测器。通过模拟不同的信噪比场景并计算曲线下面积（AUC），你将获得在量化系统性能和进行客观比较方面的实践经验 。",
            "id": "3813798",
            "problem": "您的任务是针对两种系统模型——全波形激光雷达和光子计数激光雷达，构建并评估一种用于激光雷达 (LiDAR) 回波检测的检测算法。对于这两种系统，您需要推导出真阳性率和假阳性率作为判决阈值的函数，并构建接收者操作特征 (ROC) 曲线。然后，使用数值积分计算ROC曲线下面积 (AUC)。程序的最终输出必须是一个浮点值列表，其中每个值是指定测试用例的AUC。\n\n该问题必须基于检测理论的基本原理，使用以下基本模型进行求解。\n\n对于全波形激光雷达模型，考虑一个采样电压波形，其中接收信号被建模为一个嵌入在加性噪声中的已知模板。设信号模板是在均匀时间网格上定义的、以零时刻为中心的高斯脉冲。将在时间 $t_i$ 上的模板采样表示为 $g_i$，噪声采样表示为 $n_i$。在零假设（无回波）下，观测到的波形采样为 $v_i = n_i$；在备择假设（有回波）下，观测到的波形采样为 $v_i = s_i + n_i$，其中 $s_i = A g_i$，$A$ 是一个以伏特为单位的非负振幅。假设 $n_i$ 是独立同分布的零均值高斯随机变量，其标准差为 $\\sigma_n$（单位：伏特），并且判决统计量是在同一网格上使用模板 $g_i$ 的匹配滤波器内积。您的任务是推导匹配滤波器判决统计量在两种假设下的分布，并由此计算给定判决阈值下的假阳性率和真阳性率。\n\n对于光子计数激光雷达模型，考虑在单个时间仓（或门）中收集的计数数据。在零假设下，观测到的计数是一个泊松随机变量，其平均背景率为 $\\lambda_b$（单位：每个门内的计数值）；在备择假设下，它是一个泊松随机变量，其均值为 $\\lambda_b + \\lambda_s$，其中 $\\lambda_s$ 是平均信号贡献（单位：每个门内的计数值）。使用计数阈值（一个整数计数值）作为判决阈值，并推导假阳性率和真阳性率作为该阈值的函数。\n\n科学真实性要求在计算中使用以下选择：\n- 模板 $g_i$ 是一个高斯脉冲 $g(t) = \\exp\\!\\left(-\\frac{t^2}{2 \\sigma_p^2}\\right)$，它在一个覆盖对称窗口 $[-T,T]$、均匀间距为 $\\Delta t$ 的均匀时间网格 $t_i$ 上采样。脉冲宽度 $\\sigma_p$ 的单位是纳秒，$T$ 的单位是纳秒，$\\Delta t$ 的单位是纳秒。振幅 $A$ 的单位是伏特，噪声标准差 $\\sigma_n$ 的单位是伏特。\n- 对于光子计数，阈值是一个整数计数值，速率 $\\lambda_b$ 和 $\\lambda_s$ 的单位是每个门内的计数值。\n\n您必须针对一系列从始终接受（极低阈值）到始终拒绝（极高阈值）的阈值，计算 $(\\text{FPR}, \\text{TPR})$ 对和相应的ROC曲线。将ROC曲线下面积 (AUC) 表示为一个浮点数。所有输出均无单位。\n\n您的程序必须实现以下测试套件。每个测试用例定义了系统类型和参数。对于全波形激光雷达的用例，模板如上所述，在从 $-T$ 到 $T$（包含端点）的 $t_i$ 上以均匀间距 $\\Delta t$ 采样，检测阈值选择在一个能完全覆盖实际判决行为的范围内。对于光子计数激光雷达的用例，计数阈值是一个从0开始到足够大的最大计数值的连续整数范围。这四个测试用例如下：\n\n- 测试用例1（全波形激光雷达，中等信噪比）：$A = 0.15$ 伏特，$\\sigma_n = 0.05$ 伏特，$\\sigma_p = 2.0$ 纳秒，$T = 10.0$ 纳秒，$\\Delta t = 0.1$ 纳秒，阈值数量 $N_\\theta = 201$。\n- 测试用例2（全波形激光雷达，低信噪比）：$A = 0.05$ 伏特，$\\sigma_n = 0.05$ 伏特，$\\sigma_p = 2.0$ 纳秒，$T = 10.0$ 纳秒，$\\Delta t = 0.1$ 纳秒，阈值数量 $N_\\theta = 201$。\n- 测试用例3（光子计数激光雷达，中等信号贡献）：$\\lambda_b = 0.5$ 每个门内的计数值，$\\lambda_s = 2.0$ 每个门内的计数值，使用从0到覆盖实际范围的最大计数值的整数阈值。\n- 测试用例4（光子计数激光雷达，无信号边缘情况）：$\\lambda_b = 1.0$ 每个门内的计数值，$\\lambda_s = 0.0$ 每个门内的计数值，使用从0到覆盖实际范围的最大计数值的整数阈值。\n\n对于每个测试用例，您必须：\n- 根据给定的模型推导判决统计量在两种假设下的分布，并计算 $\\text{FPR}(\\theta)$ 和 $\\text{TPR}(\\theta)$ 作为阈值 $\\theta$ 的函数。\n- 在阈值扫描范围内，将 $(\\text{FPR}, \\text{TPR})$ 对组合成ROC曲线。\n- 使用梯形法则，将 $\\text{TPR}$ 作为 $\\text{FPR}$ 的函数，计算ROC曲线下面积 (AUC)。\n\n您的程序应生成单行输出，其中包含四个测试用例的AUC值，格式为一个由方括号括起来的、逗号分隔的列表。例如，输出格式必须与 $[\\text{auc}_1,\\text{auc}_2,\\text{auc}_3,\\text{auc}_4]$ 完全一样，其中每个 $\\text{auc}_k$ 是一个浮点数。输出中不需要物理单位。",
            "solution": "该问题要求针对两种不同的激光雷达检测场景——全波形系统和光子计数系统——推导并计算接收者操作特征 (ROC) 曲线及曲线下面积 (AUC)。这是一个信号处理中经典的统计决策理论问题。解决方案首先验证问题陈述，该陈述被认为是有效的、有科学依据且定义明确的。然后，我们从基本原理出发，为两个系统推导必要的理论模型。\n\n### 全波形激光雷达回波检测\n\n在全波形模型中，我们的任务是检测一个嵌入在加性高斯白噪声中的已知形状的确定性信号。这是一个信号完全已知 (SKE) 的检测问题。\n\n**1. 模型构建**\n\n离散时间观测电压波形由一个长度为 $N$ 的向量 $\\mathbf{v}$ 表示。两种假设如下：\n-   零假设 ($H_0$, 无回波): 接收到的波形仅包含噪声。\n    $$H_0: v_i = n_i$$\n-   备择假设 ($H_1$, 有回波): 接收到的波形包含信号和噪声。\n    $$H_1: v_i = s_i + n_i = A g_i + n_i$$\n这里，$g_i$ 是已知高斯脉冲模板 $g(t) = \\exp(-t^2 / (2\\sigma_p^2))$ 在均匀时间网格 $t_i$ 上的采样点。$A$ 是信号振幅，$n_i$ 是来自零均值高斯分布 $n_i \\sim \\mathcal{N}(0, \\sigma_n^2)$ 的独立同分布 (i.i.d.) 随机噪声采样。\n\n**2. 判决统计量：匹配滤波器**\n\n对于加性高斯白噪声中的已知信号，最优检测器是匹配滤波器。判决统计量 $\\Lambda$ 是通过计算观测波形向量 $\\mathbf{v}$ 与信号模板向量 $\\mathbf{g}$ 的内积形成的：\n$$\\Lambda = \\mathbf{g}^T \\mathbf{v} = \\sum_{i=0}^{N-1} g_i v_i$$\n由于 $\\Lambda$ 是高斯随机变量 ($v_i$) 的线性组合，因此在两种假设下，$\\Lambda$ 本身也是一个高斯随机变量。我们现在来确定其参数。\n\n**3. 判决统计量的分布**\n\n-   **在 $H_0$ 下**: $\\mathbf{v} = \\mathbf{n}$。\n    统计量为 $\\Lambda_0 = \\sum_i g_i n_i$。\n    $\\Lambda_0$ 的均值为：\n    $$\\mu_0 = E[\\Lambda_0] = E\\left[\\sum_i g_i n_i\\right] = \\sum_i g_i E[n_i] = 0$$\n    $\\Lambda_0$ 的方差为：\n    $$\\sigma_\\Lambda^2 = \\text{Var}(\\Lambda_0) = \\text{Var}\\left(\\sum_i g_i n_i\\right) = \\sum_i g_i^2 \\text{Var}(n_i) = \\sigma_n^2 \\sum_i g_i^2$$\n    令 $E_g = \\sum_i g_i^2$ 为离散模板的能量。那么，$\\sigma_\\Lambda^2 = \\sigma_n^2 E_g$。\n    因此，在 $H_0$ 下，判决统计量服从分布 $\\Lambda \\sim \\mathcal{N}(0, \\sigma_n^2 E_g)$。\n\n-   **在 $H_1$ 下**: $\\mathbf{v} = A\\mathbf{g} + \\mathbf{n}$。\n    统计量为 $\\Lambda_1 = \\sum_i g_i (A g_i + n_i) = A\\sum_i g_i^2 + \\sum_i g_i n_i = A E_g + \\Lambda_0$。\n    $\\Lambda_1$ 的均值为：\n    $$\\mu_1 = E[\\Lambda_1] = E[A E_g + \\Lambda_0] = A E_g + E[\\Lambda_0] = A E_g$$\n    $\\Lambda_1$ 的方差为：\n    $$\\text{Var}(\\Lambda_1) = \\text{Var}(A E_g + \\Lambda_0) = \\text{Var}(\\Lambda_0) = \\sigma_n^2 E_g = \\sigma_\\Lambda^2$$\n    因此，在 $H_1$ 下，判决统计量服从分布 $\\Lambda \\sim \\mathcal{N}(A E_g, \\sigma_n^2 E_g)$。\n\n**4. 假阳性率和真阳性率**\n\n通过将统计量 $\\Lambda$ 与阈值 $\\theta$ 进行比较来做出判决。如果 $\\Lambda  \\theta$，我们判定为 $H_1$。\n\n-   **假阳性率 (FPR)**: 在 $H_0$ 为真时，错误地判定为 $H_1$ 的概率。\n    $$\\text{FPR}(\\theta) = P(\\Lambda  \\theta | H_0) = \\int_\\theta^\\infty \\frac{1}{\\sqrt{2\\pi}\\sigma_\\Lambda} \\exp\\left(-\\frac{x^2}{2\\sigma_\\Lambda^2}\\right) dx$$\n    这可以用标准正态分布的互补累积分布函数（或Q函数）$Q(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_z^\\infty e^{-u^2/2} du$ 来表示。\n    $$\\text{FPR}(\\theta) = Q\\left(\\frac{\\theta - \\mu_0}{\\sigma_\\Lambda}\\right) = Q\\left(\\frac{\\theta}{\\sigma_n \\sqrt{E_g}}\\right)$$\n\n-   **真阳性率 (TPR)**: 在 $H_1$ 为真时，正确地判定为 $H_1$ 的概率。\n    $$\\text{TPR}(\\theta) = P(\\Lambda  \\theta | H_1) = \\int_\\theta^\\infty \\frac{1}{\\sqrt{2\\pi}\\sigma_\\Lambda} \\exp\\left(-\\frac{(x - \\mu_1)^2}{2\\sigma_\\Lambda^2}\\right) dx$$\n    $$\\text{TPR}(\\theta) = Q\\left(\\frac{\\theta - \\mu_1}{\\sigma_\\Lambda}\\right) = Q\\left(\\frac{\\theta - A E_g}{\\sigma_n \\sqrt{E_g}}\\right)$$\nQ函数可以通过互补误差函数 $\\text{erfc}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_z^\\infty e^{-u^2}du$ 来计算，其关系为 $Q(z) = \\frac{1}{2}\\text{erfc}(z/\\sqrt{2})$。\n\n### 光子计数激光雷达回波检测\n\n在光子计数模型中，观测值是在给定时间门内检测到的光子数 $K$（一个整数）。其统计特性由泊松分布决定。\n\n**1. 模型构建**\n\n-   零假设 ($H_0$, 仅背景): 光子计数服从均值为 $\\lambda_b$ 的泊松分布。\n    $$H_0: K \\sim \\text{Poisson}(\\lambda_b)$$\n-   备择假设 ($H_1$, 信号加背景): 光子计数服从均值为 $\\lambda_b + \\lambda_s$ 的泊松分布。\n    $$H_1: K \\sim \\text{Poisson}(\\lambda_b + \\lambda_s)$$\n\n**2. 判决规则和比率**\n\n判决基于将观测到的计数值 $K$ 与整数阈值 $k_{th}$ 进行比较。如果 $K \\ge k_{th}$，我们判定为 $H_1$。\n\n-   **假阳性率 (FPR)**:\n    $$\\text{FPR}(k_{th}) = P(K \\ge k_{th} | H_0) = \\sum_{k=k_{th}}^\\infty \\frac{e^{-\\lambda_b} \\lambda_b^k}{k!} = 1 - P(K \\le k_{th}-1 | H_0)$$\n    这是泊松分布在 $k_{th}-1$ 处的生存函数。\n\n-   **真阳性率 (TPR)**:\n    $$\\text{TPR}(k_{th}) = P(K \\ge k_{th} | H_1) = \\sum_{k=k_{th}}^\\infty \\frac{e^{-(\\lambda_b+\\lambda_s)} (\\lambda_b+\\lambda_s)^k}{k!} = 1 - P(K \\le k_{th}-1 | H_1)$$\n\n### ROC曲线和AUC计算\n\nROC曲线是针对所有可能的阈值绘制的TPR与FPR的关系图。对于连续值统计量 $\\Lambda$，将 $\\theta$ 从 $+\\infty$ 扫描到 $-\\infty$ 会描绘出一条从 $(0,0)$ 到 $(1,1)$ 的平滑曲线。对于离散计数值 $K$，改变整数阈值 $k_{th}$ 会产生一系列点，形成一条阶梯状曲线。\n\n曲线下面积 (AUC) 是检测器性能的一个总结性度量。AUC为1.0代表一个完美的分类器，而AUC为0.5则表示其性能不优于随机猜测。问题指定使用梯形法则对AUC进行数值计算。对于一组按 $x_i$ 递增排序的ROC点 $(x_i, y_i) = (\\text{FPR}_i, \\text{TPR}_i)$，AUC的近似计算公式为：\n$$\\text{AUC} \\approx \\sum_{i=1}^{M-1} \\frac{1}{2}(y_i + y_{i-1})(x_i - x_{i-1})$$\n其中 $M$ 是点的数量。这通过 `numpy.trapz` 实现。对于光子计数的情况，我们通过将整数阈值 $k_{th}$ 从一个足够大的最大值扫描到0来生成ROC点。对于波形的情况，我们在一个覆盖两个概率分布主体的范围内扫描连续阈值 $\\theta$，以确保生成的 (FPR, TPR) 对能够覆盖从接近 $(0,0)$ 到接近 $(1,1)$ 的整条曲线。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\nfrom scipy.stats import poisson\n\ndef solve_waveform_auc(A, sigma_n, sigma_p, T, dt, N_theta):\n    \"\"\"\n    Computes the AUC for a full-waveform LiDAR system.\n\n    Args:\n        A (float): Signal amplitude in volts.\n        sigma_n (float): Noise standard deviation in volts.\n        sigma_p (float): Gaussian pulse width in nanoseconds.\n        T (float): Half-width of the time window in nanoseconds.\n        dt (float): Time grid spacing in nanoseconds.\n        N_theta (int): Number of thresholds for the ROC curve.\n\n    Returns:\n        float: The calculated Area Under the ROC Curve (AUC).\n    \"\"\"\n    # 1. Generate template and compute its energy\n    t = np.arange(-T, T + dt / 2, dt)\n    g = np.exp(-t**2 / (2 * sigma_p**2))\n    E_g = np.sum(g**2)\n\n    # 2. Derive parameters of the decision statistic distributions\n    mu_0 = 0.0\n    mu_1 = A * E_g\n    sigma_lambda = sigma_n * np.sqrt(E_g)\n\n    # 3. Define a threshold range that spans from always-reject to always-accept\n    # A wide range ensures the ROC curve covers the full [0, 1] range.\n    # The range is chosen to cover several standard deviations around both means.\n    # We sweep from high to low theta to get an ascending FPR/TPR curve.\n    theta_max = mu_1 + 6 * sigma_lambda\n    theta_min = mu_0 - 6 * sigma_lambda\n    theta = np.linspace(theta_max, theta_min, N_theta)\n\n    # 4. Calculate FPR and TPR arrays\n    # The Q-function Q(x) is 0.5 * erfc(x / sqrt(2))\n    arg_fpr = (theta - mu_0) / (np.sqrt(2) * sigma_lambda)\n    arg_tpr = (theta - mu_1) / (np.sqrt(2) * sigma_lambda)\n    fpr = 0.5 * erfc(arg_fpr)\n    tpr = 0.5 * erfc(arg_tpr)\n\n    # 5. Compute AUC using the trapezoidal rule\n    # Since theta is swept from high to low, fpr is already sorted in increasing order.\n    auc = np.trapz(tpr, fpr)\n    \n    return auc\n\n\ndef solve_photon_auc(lambda_b, lambda_s):\n    \"\"\"\n    Computes the AUC for a photon-counting LiDAR system.\n\n    Args:\n        lambda_b (float): Mean background count rate per gate.\n        lambda_s (float): Mean signal count rate per gate.\n\n    Returns:\n        float: The calculated Area Under the ROC Curve (AUC).\n    \"\"\"\n    # 1. Define mean count rates for both hypotheses\n    lambda_0 = lambda_b\n    lambda_1 = lambda_b + lambda_s\n\n    # 2. Define the range of integer thresholds\n    # The maximum threshold must be large enough to make the survival function\n    # practically zero for both distributions.\n    # The '+1' term in max handles the case where rates are  1.\n    max_rate = max(lambda_0, lambda_1, 1.0)\n    k_max = int(max_rate + 15 * np.sqrt(max_rate)) + 15\n    k_th_values = np.arange(k_max, -1, -1)  # Sweep from k_max down to 0\n\n    # 3. Calculate FPR and TPR for each threshold\n    # P(K >= k_th) = 1 - P(K = k_th - 1), which is the survival function sf(k_th - 1)\n    fpr = poisson.sf(k_th_values - 1, lambda_0)\n    tpr = poisson.sf(k_th_values - 1, lambda_1)\n\n    # 4. Compute AUC using the trapezoidal rule\n    # As k_th decreases, FPR and TPR increase, so the arrays are correctly ordered.\n    # The points cover the range from near (0,0) to exactly (1,1).\n    auc = np.trapz(tpr, fpr)\n    \n    return auc\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'type': 'waveform', 'params': {'A': 0.15, 'sigma_n': 0.05, 'sigma_p': 2.0, 'T': 10.0, 'dt': 0.1, 'N_theta': 201}},\n        {'type': 'waveform', 'params': {'A': 0.05, 'sigma_n': 0.05, 'sigma_p': 2.0, 'T': 10.0, 'dt': 0.1, 'N_theta': 201}},\n        {'type': 'photon', 'params': {'lambda_b': 0.5, 'lambda_s': 2.0}},\n        {'type': 'photon', 'params': {'lambda_b': 1.0, 'lambda_s': 0.0}}\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'waveform':\n            auc = solve_waveform_auc(**case['params'])\n        elif case['type'] == 'photon':\n            auc = solve_photon_auc(**case['params'])\n        results.append(auc)\n\n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}