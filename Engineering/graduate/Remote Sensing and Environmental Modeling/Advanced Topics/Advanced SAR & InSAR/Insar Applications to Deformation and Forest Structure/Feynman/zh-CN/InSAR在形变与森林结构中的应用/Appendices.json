{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在建立干涉雷达（InSAR）相位观测值与地表物理形变之间的基本联系。通过从第一性原理出发，计算给定雷达波长 $\\lambda$ 和形变量 $s$ 所产生的干涉“条纹”数量，并评估相位解缠中发生混叠的风险，你将建立解读干涉图的核心直觉，并理解测量的基本限制。这项实践对于掌握InSAR如何量化地表运动至关重要。",
            "id": "3822661",
            "problem": "给定一个干涉合成孔径雷达（InSAR）观测同震形变的一维理想化模型。通过干涉测量法测得的电磁相位在雷达波长上是周期性的，并与往返路径长度差相关。请使用以下基本原理，不要依赖任何预先推导的 InSAR 特定简化公式：\n\n- 波长为 $\\lambda$ 的单色电磁波沿长度为 $r$ 的传播路径累积的相位与 $r/\\lambda$ 成正比。\n- 在重复轨道干涉测量中，视线距离的变化会产生双程路径长度变化，从而导致两次采集之间的相位差。\n- 条纹定义为缠繞干涉相位中 $2\\pi$ 的相位周期。\n- 对于采样间距为 $p$ 的相邻像素之间的相位解缠，避免混叠的一个充分（但非必要）条件是，相邻样本之间的干涉相位差的最大绝对值严格小于 $\\pi$ 弧度。\n\n假设 InSAR 观测到的浅层走滑断层具有以下理想化形变模型：\n\n- 穿过断层的视线位移场近似为一个线性斜坡，在以断层迹线为中心、宽度为 $W$（单位：米）的剪切带上，从 $0$ 变化到最大视线位移 $s$。在剪切带之外，位移是恒定的。\n- 干涉相位被缠繞到区间 $(-\\pi,\\pi]$ 弧度。\n- 雷达波长为 $\\lambda$（单位：米），像素间距为 $p$（单位：米），所有角度必须以弧度处理。\n\n需对每个测试用例执行的任务：\n\n1) 仅使用上述基本原理，从第一性原理出发，推导并计算与最大视线位移量 $s$ 和波长 $\\lambda$ 相关的预期条紋数 $N$。将 $N$ 报告为四舍五入到六位小数的浮点数（无量纲）。\n\n2) 仅使用上述基本原理，推导一个最近邻准则，以评估在最大相位斜率出现在线性剪切带内的假设下，相位解缠是否可行而不会产生混叠。通过检查相邻像素之间可能的最大缠繞相位差是否严格小于 $\\pi$ 弧度来确定布尔可行性。将可行性报告为布尔值。\n\n测试套件（每个为元组 $(\\lambda, s, W, p)$，所有长度单位均为米）：\n\n- 情况 1: $(0.056, 0.5, 200.0, 20.0)$\n- 情况 2: $(0.23, 0.05, 500.0, 30.0)$\n- 情况 3: $(0.031, 0.02, 100.0, 3.0)$\n- 情况 4（边界情况）: $(0.056, 1.4, 100.0, 1.0)$\n- 情况 5（无形变）: $(0.24, 0.0, 50.0, 10.0)$\n\n程序要求：\n\n- 您的程序必须为每个情况计算一个配对，包括预期的条纹数 $N$（四舍五入到六位小数）和基于最近邻准则的无混叠解缠的布尔可行性。\n- 最终输出格式必须是包含一个 Python 风格列表的单行，其中每个内部列表的形式为 $[N, \\text{feasible}]$。例如：$[[N_1,\\text{True}],[N_2,\\text{False}],\\dots]$。\n- 确保所有计算都按规定使用弧度处理角度，并使用米作为长度单位。",
            "solution": "该问题已经过验证，被认为是合理的。它具有科学依据、问题明確、客观，并包含完整解答所需的所有信息。所提供的参数对于 InSAR 观测同震形变是物理上现实的。这些任务要求从第一性原理推导基本关系，这是一项有效且有启发性的练习。\n\n解答分为两部分，对应每个测试用例要求的两项任务。所有推导均基于问题陈述中提供的原理。\n\n### 第一部分：条紋数 ($N$) 的推导\n\n电磁波的相位 $\\phi$、其传播路径长度 $r$ 及其波长 $\\lambda$ 之间的关系被设定为成正比。一个完整周期 $2\\pi$ 弧度的标准物理关系是：\n$$ \\phi = 2\\pi \\frac{r}{\\lambda} $$\n在重复轨道干涉合成孔径雷达（InSAR）中，传感器测量两次采集之间的相位差 $\\Delta\\phi$。该相位差是由卫星与地面上一点之间的视线（LOS）距离的变化引起的。视线距离的变化（我们称之为 $d_{los}$）改变了雷达信号的往返路径长度。信号从卫星传播到地面再返回，因此总路径长度变化是视线位移的两倍，即 $2d_{los}$。\n\n因此，干涉相位差 $\\Delta\\phi$ 与视线位移 $d_{los}$ 的关系为：\n$$ \\Delta\\phi = 2\\pi \\frac{2d_{los}}{\\lambda} = \\frac{4\\pi d_{los}}{\\lambda} $$\n问题将一个条纹定义为一个 $2\\pi$ 的相位周期。穿过形变区域的总条纹数 $N$ 是总累积相位变化 $\\Delta\\phi_{total}$ 除以 $2\\pi$。问题指定了最大视线位移量为 $s$，这代表了穿过断层剪切带的总位移。与该位移 $s$ 相关的总相位变化为：\n$$ \\Delta\\phi_{max} = \\frac{4\\pi s}{\\lambda} $$\n因此，总条纹数 $N$ 计算如下：\n$$ N = \\frac{\\Delta\\phi_{max}}{2\\pi} = \\frac{4\\pi s / \\lambda}{2\\pi} $$\n简化后得到条纹数的最终表达式：\n$$ N = \\frac{2s}{\\lambda} $$\n该值是无量纲的。对于每个测试用例，我们将使用给定的 $s$ 和 $\\lambda$ 值计算 $N$，并将结果四舍五入到六位小数。\n\n### 第二部分：解缠可行性准则的推导\n\n相位解缠旨在从其被限制在区间 $(-\\pi, \\pi]$ 内的缠绕表示中重建原始的连续相位场。当相位梯度过陡，导致相邻样本之间的相位差超过半个周期（$\\pi$ 弧度）时，就会发生混叠。这会导致在加减 $2\\pi$ 周期数时出现模糊性。\n\n问题提供了一个避免混叠的充分条件：相邻像素之间的干涉相位差的最大绝对值 $\\Delta\\phi_{adj}$ 必须严格小于 $\\pi$ 弧度。\n$$ |\\Delta\\phi_{adj}|_{max}  \\pi $$\n我们需要找到 $|\\Delta\\phi_{adj}|_{max}$ 的表达式。问题假设了一个理想化的形变模型，其中视线位移 $d_{los}$ 在宽度为 $W$ 的剪切带上从 $0$ 线性变化到 $s$。在此区域内，位移梯度是恒定的，并处于其最大值。设 $x$ 为垂直于断层迹线的坐标。位移梯度为：\n$$ \\frac{\\partial d_{los}}{\\partial x} = \\frac{s}{W} $$\n在剪切带之外，位移是恒定的，梯度为 $0$。\n\n相位梯度与位移梯度相关：\n$$ \\frac{\\partial\\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{4\\pi d_{los}(x)}{\\lambda} \\right) = \\frac{4\\pi}{\\lambda} \\frac{\\partial d_{los}}{\\partial x} $$\n最大相位梯度出现在剪切带内：\n$$ \\left( \\frac{\\partial\\phi}{\\partial x} \\right)_{max} = \\frac{4\\pi}{\\lambda} \\frac{s}{W} = \\frac{4\\pi s}{\\lambda W} $$\n两个间距为 $p$ 的相邻像素之间的相位差可以使用一阶泰勒展开（或有限差分）来近似，假设梯度在距离 $p$ 上是恒定的：\n$$ \\Delta\\phi_{adj} \\approx \\frac{\\partial\\phi}{\\partial x} \\cdot p $$\n相邻像素之间的最大相位差 $|\\Delta\\phi_{adj}|_{max}$ 将出现在相位梯度最大的地方：\n$$ |\\Delta\\phi_{adj}|_{max} = \\left( \\frac{\\partial\\phi}{\\partial x} \\right)_{max} \\cdot p = \\left( \\frac{4\\pi s}{\\lambda W} \\right) p $$\n应用混叠条件：\n$$ \\frac{4\\pi s p}{\\lambda W}  \\pi $$\n两边同除以 $\\pi$（因为 $\\pi > 0$），我们得到无混叠解缠的准则：\n$$ \\frac{4sp}{\\lambda W}  1 $$\n对于每个测试用例，我们将使用给定的 $s$、$p$、$\\lambda$ 和 $W$ 值来评估此不等式。结果是一个布尔值，指示在给定模型和采样条件下，解缠是否可行而不会产生混叠。\n\n### 计算公式总结\n\n对于每个测试用例 $(\\lambda, s, W, p)$:\n1.  条纹数：$N = \\frac{2s}{\\lambda}$\n2.  解缠可行性：如果 $\\frac{4sp}{\\lambda W}  1$ 则为 `True`，否则为 `False`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used or needed.\n\ndef solve():\n    \"\"\"\n    Computes InSAR fringe count and unwrapping feasibility for given test cases.\n\n    The solution is derived from first principles as outlined in the problem statement.\n    \n    1. Number of Fringes (N):\n       The interferometric phase change for a line-of-sight displacement 's' is\n       Δφ = 4πs/λ. A fringe is a 2π cycle.\n       Therefore, N = Δφ / 2π = 2s/λ.\n\n    2. Unwrapping Feasibility:\n       Aliasing is avoided if the phase difference between adjacent pixels is  π.\n       The displacement gradient is s/W in the shear zone.\n       The phase gradient is (4π/λ) * (s/W).\n       The phase difference between pixels spaced by 'p' is approx. p * (phase gradient).\n       So, |p * 4πs / (λW)|  π, which simplifies to 4sp / (λW)  1.\n    \"\"\"\n    # Test Suite (lambda, s, W, p) in meters.\n    test_cases = [\n        # Case 1: (λ, s, W, p)\n        (0.056, 0.5, 200.0, 20.0),\n        # Case 2\n        (0.23, 0.05, 500.0, 30.0),\n        # Case 3\n        (0.031, 0.02, 100.0, 3.0),\n        # Case 4 (boundary case)\n        (0.056, 1.4, 100.0, 1.0),\n        # Case 5 (no deformation)\n        (0.24, 0.0, 50.0, 10.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        lmbda, s, W, p = case\n\n        # Task 1: Calculate the number of fringes N\n        # Handle division by zero for lambda, although test cases are valid.\n        if lmbda == 0:\n            # Physically unrealistic, but for code robustness\n            n_fringes = float('inf') if s > 0 else 0.0\n        else:\n            n_fringes = 2 * s / lmbda\n\n        # Task 2: Determine phase unwrapping feasibility\n        # Handle division by zero for lambda or W\n        if lmbda == 0 or W == 0:\n            # A zero-width shear zone implies an infinite gradient if s > 0.\n            # A zero wavelength implies infinite phase for any displacement.\n            # In both scenarios, aliasing is guaranteed if s > 0.\n            feasible = (s == 0)\n        else:\n            # Criterion: 4 * s * p / (lambda * W)  1\n            aliasing_metric = 4 * s * p / (lmbda * W)\n            feasible = aliasing_metric  1\n\n        results.append([n_fringes, feasible])\n\n    # Format the final output string exactly as specified.\n    # N is formatted to six decimal places, and feasibility as a boolean literal.\n    output_parts = []\n    for n, f in results:\n        # Format N to 6 decimal places, ensuring trailing zeros.\n        n_str = f\"{n:.6f}\"\n        # Convert boolean to string \"True\" or \"False\".\n        f_str = str(f)\n        output_parts.append(f\"[{n_str},{f_str}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "虽然相位测量的是地表位移，但相位测量的“质量”——即相干性（coherence）——却揭示了关于地表覆盖的丰富信息。本练习将深入探讨森林中不同散射机制（如体散射、二次散射和地表散射）如何共同构成最终观测到的总相干性。通过这个案例，你将学会如何利用InSAR不仅测量形变，还能表征植被等复杂地表的结构特性。",
            "id": "3822603",
            "problem": "在L波段以重复轨道模式对热带雨林进行了一次干涉合成孔径雷达（InSAR）观测。两次合成孔径雷达（SAR）采集的时间间隔为 $\\Delta t = 3$ 天，垂直基线很短，因此几何去相干可以忽略不计。大气相位和热噪声的贡献可以忽略不计，并且在所有极化方式中均相同。在给定极化方式下，总后向散射复数场是几个相互不相关的散射分量之和：表面散射、二次散射和植被体散射。每个分量都经历时间去相干，该过程可建模为一个具有特征时间常数的平稳一阶过程，从而导致相干性幅度取决于 $\\Delta t$ 和该分量的时间常数。森林冠层为成熟林，结构复杂，具有以下物理上合理的、依赖于极化的功率贡献分数（归一化后总和为 $1$）：\n\n- 对于水平发射、水平接收（$\\mathrm{HH}$）：$f_{\\mathrm{vol}} = 0.50$, $f_{\\mathrm{db}} = 0.40$, $f_{\\mathrm{s}} = 0.10$。\n- 对于水平发射、垂直接收（$\\mathrm{HV}$）：$f_{\\mathrm{vol}} = 0.90$, $f_{\\mathrm{db}} = 0.05$, $f_{\\mathrm{s}} = 0.05$。\n- 对于垂直发射、垂直接收（$\\mathrm{VV}$）：$f_{\\mathrm{vol}} = 0.70$, $f_{\\mathrm{db}} = 0.10$, $f_{\\mathrm{s}} = 0.20$。\n\n此处，$f_{\\mathrm{vol}}$ 表示植被体散射分数，$f_{\\mathrm{db}}$ 表示二次散射（地-干）分数，$f_{\\mathrm{s}}$ 表示表面（地面）散射分数。各分量特有的时间相干性遵循指数衰减，其特征时间常数代表了雨林的动态特性：$\\tau_{\\mathrm{vol}} = 1.5$ 天，$\\tau_{\\mathrm{db}} = 7$ 天，$\\tau_{\\mathrm{s}} = 10$ 天。假设在两个日期之间，每种极化方式的总强度保持不变。\n\n从复数干涉相干性的基本定义和基础散射物理出发，推导一个表达式，用于表示每种极化方式下预期的干涉相干性幅度，该表达式应以 $\\Delta t$、$\\tau_{\\mathrm{vol}}$、$\\tau_{\\mathrm{db}}$、$\\tau_{\\mathrm{s}}$ 和功率贡献分数表示。然后，计算 $\\mathrm{HH}$、$\\mathrm{HV}$ 和 $\\mathrm{VV}$ 的数值，并以 $\\mathrm{HH}$、$\\mathrm{HV}$、$\\mathrm{VV}$ 的顺序，将最终答案表示为单行矩阵。将每个条目四舍五入至三位有效数字。相干性是无量纲的。您的推导和计算还必须根据散射物理学，论证哪种极化方式在雨林中预期具有最高的相干性，并说明原因。",
            "solution": "该问题已经过验证，被认为是有效的，因为它具有科学依据、问题明确且客观。它为雷达遥感中的一个标准问题提供了完整且一致的设定。\n\n解决方案首先推导在给定散射模型下的干涉相干性幅度的一般表达式，然后应用该表达式计算每种极化方式的具体数值。\n\n复数干涉相干性 $\\gamma$ 的基本定义是，在两个不同时间采集的两幅复数合成孔径雷达（SAR）图像 $E_1$ 和 $E_2$ 之间的关系，由下式给出：\n$$\n\\gamma = \\frac{\\langle E_1 E_2^* \\rangle}{\\sqrt{\\langle |E_1|^2 \\rangle \\langle |E_2|^2 \\rangle}}\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在一个处理窗口上的空间集合平均，$E^*$ 是 $E$ 的复共轭。\n\n问题指出，对于任何给定的极化方式，总后向散射复数场 $E$ 是三个相互不相关的散射分量之和：体散射（$E_{\\mathrm{vol}}$）、二次散射（$E_{\\mathrm{db}}$）和表面散射（$E_{\\mathrm{s}}$）。因此，对于两次采集，我们有：\n$$\nE_1 = E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}\n$$\n$$\nE_2 = E_{\\mathrm{vol},2} + E_{\\mathrm{db},2} + E_{\\mathrm{s},2}\n$$\n相互不相关的性质意味着不同分量之间的互相关为零，即对于 $i \\neq j$，有 $\\langle E_{i,m} E_{j,n}^* \\rangle = 0$，其中 $i, j \\in \\{\\mathrm{vol}, \\mathrm{db}, \\mathrm{s}\\}$ 且 $m, n \\in \\{1, 2\\}$。\n\n让我们展开相干性表达式的分子：\n$$\n\\langle E_1 E_2^* \\rangle = \\langle (E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}) (E_{\\mathrm{vol},2}^* + E_{\\mathrm{db},2}^* + E_{\\mathrm{s},2}^*) \\rangle\n$$\n由于各分量不相关，所有交叉项在求平均后都为零。表达式简化为各分量自相关之和：\n$$\n\\langle E_1 E_2^* \\rangle = \\langle E_{\\mathrm{vol},1} E_{\\mathrm{vol},2}^* \\rangle + \\langle E_{\\mathrm{db},1} E_{\\mathrm{db},2}^* \\rangle + \\langle E_{\\mathrm{s},1} E_{\\mathrm{s},2}^* \\rangle\n$$\n现在，我们分析分母。它包含每次采集的总功率（强度）。问题指出总强度不变，所以 $\\langle |E_1|^2 \\rangle = \\langle |E_2|^2 \\rangle$。我们将总功率表示为 $\\sigma^0_{\\mathrm{total}} = \\langle |E|^2 \\rangle$。\n$$\n\\sigma^0_{\\mathrm{total}} = \\langle |E_1|^2 \\rangle = \\langle |E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}|^2 \\rangle\n$$\n展开此式并再次使用不相关性，我们发现总功率是各分量功率之和：\n$$\n\\sigma^0_{\\mathrm{total}} = \\langle |E_{\\mathrm{vol},1}|^2 \\rangle + \\langle |E_{\\mathrm{db},1}|^2 \\rangle + \\langle |E_{\\mathrm{s},1}|^2 \\rangle = \\sigma^0_{\\mathrm{vol}} + \\sigma^0_{\\mathrm{db}} + \\sigma^0_{\\mathrm{s}}\n$$\n其中 $\\sigma^0_i$ 是分量 $i$ 的后向散射功率。因此，相干性表达式的分母变为 $\\sqrt{(\\sigma^0_{\\mathrm{total}})^2} = \\sigma^0_{\\mathrm{total}}$。\n\n将这些展开式代入分子和分母，我们得到：\n$$\n\\gamma = \\frac{\\langle E_{\\mathrm{vol},1} E_{\\mathrm{vol},2}^* \\rangle + \\langle E_{\\mathrm{db},1} E_{\\mathrm{db},2}^* \\rangle + \\langle E_{\\mathrm{s},1} E_{\\mathrm{s},2}^* \\rangle}{\\sigma^0_{\\mathrm{vol}} + \\sigma^0_{\\mathrm{db}} + \\sigma^0_{\\mathrm{s}}}\n$$\n单个分量 $i$ 的复数相干性定义为 $\\gamma_i = \\frac{\\langle E_{i,1} E_{i,2}^* \\rangle}{\\sqrt{\\langle |E_{i,1}|^2 \\rangle \\langle |E_{i,2}|^2 \\rangle}}$。由于过程是平稳的，$\\langle |E_{i,1}|^2 \\rangle = \\langle |E_{i,2}|^2 \\rangle = \\sigma^0_i$。因此，我们可以将每个分量的干涉互相关写为 $\\langle E_{i,1} E_{i,2}^* \\rangle = \\gamma_i \\sigma^0_i$。将其代入总相干性 $\\gamma$ 的表达式中：\n$$\n\\gamma = \\frac{\\gamma_{\\mathrm{vol}}\\sigma^0_{\\mathrm{vol}} + \\gamma_{\\mathrm{db}}\\sigma^0_{\\mathrm{db}} + \\gamma_{\\mathrm{s}}\\sigma^0_{\\mathrm{s}}}{\\sigma^0_{\\mathrm{total}}}\n$$\n问题给出了功率贡献分数，$f_i = \\sigma^0_i / \\sigma^0_{\\mathrm{total}}$。使用此定义，总复数相干性成为分量复数相干性的加权和：\n$$\n\\gamma = f_{\\mathrm{vol}}\\gamma_{\\mathrm{vol}} + f_{\\mathrm{db}}\\gamma_{\\mathrm{db}} + f_{\\mathrm{s}}\\gamma_{\\mathrm{s}}\n$$\n每个分量的复数相干性 $\\gamma_i$ 包括时间去相干的影响以及与散射体垂直位置相关的相位项。然而，问题侧重于时间去相干，并且没有提供确定散射分量之间相位差（这取决于森林高度和基线）的信息。在这种模型中，当不明确求解垂直结构时，一个常见且合理的简化是假设相位贡献可以忽略或对齐，从而允许将总相干性*幅度*近似为分量时间相干性幅度的加权和。我们将采用这个模型。\n$$\n|\\gamma| \\approx f_{\\mathrm{vol}}|\\gamma_{\\mathrm{vol}}| + f_{\\mathrm{db}}|\\gamma_{\\mathrm{db}}| + f_{\\mathrm{s}}|\\gamma_{\\mathrm{s}}|\n$$\n问题指出，每个分量的时间去相干遵循一个平稳的一阶过程，这对应于相干性幅度 $|\\gamma_i|$ 的指数衰减模型。在几何、热噪声和大气去相干可以忽略的情况下，每个分量的相干性主要由时间去相干决定：\n$$\n|\\gamma_i| = \\exp\\left(-\\frac{\\Delta t}{\\tau_i}\\right)\n$$\n其中 $\\Delta t$ 是重复轨道的时间间隔，$\\tau_i$ 是分量 $i$ 的特征去相干时间常数。\n\n因此，预期的干涉相干性幅度的最终表达式是：\n$$\n|\\gamma| = f_{\\mathrm{vol}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{vol}}}\\right) + f_{\\mathrm{db}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{db}}}\\right) + f_{\\mathrm{s}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{s}}}\\right)\n$$\n我们现在使用给定的数据计算数值：$\\Delta t = 3$ 天，$\\tau_{\\mathrm{vol}} = 1.5$ 天，$\\tau_{\\mathrm{db}} = 7$ 天，以及 $\\tau_{\\mathrm{s}} = 10$ 天。\n\n首先，我们计算分量的相干性幅度：\n$|\\gamma_{\\mathrm{vol}}| = \\exp\\left(-\\frac{3}{1.5}\\right) = \\exp(-2) \\approx 0.135335$\n$|\\gamma_{\\mathrm{db}}| = \\exp\\left(-\\frac{3}{7}\\right) \\approx 0.651430$\n$|\\gamma_{\\mathrm{s}}| = \\exp\\left(-\\frac{3}{10}\\right) = \\exp(-0.3) \\approx 0.740818$\n\n接下来，我们使用每种极化特定的功率贡献分数来计算其总相干性幅度。\n\n对于 HH 极化（$f_{\\mathrm{vol}} = 0.50$, $f_{\\mathrm{db}} = 0.40$, $f_{\\mathrm{s}} = 0.10$）：\n$|\\gamma_{\\mathrm{HH}}| = 0.50 \\times |\\gamma_{\\mathrm{vol}}| + 0.40 \\times |\\gamma_{\\mathrm{db}}| + 0.10 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{HH}}| \\approx 0.50(0.135335) + 0.40(0.651430) + 0.10(0.740818)$\n$|\\gamma_{\\mathrm{HH}}| \\approx 0.067668 + 0.260572 + 0.074082 = 0.402322$\n四舍五入至三位有效数字， $|\\gamma_{\\mathrm{HH}}| \\approx 0.402$。\n\n对于 HV 极化（$f_{\\mathrm{vol}} = 0.90$, $f_{\\mathrm{db}} = 0.05$, $f_{\\mathrm{s}} = 0.05$）：\n$|\\gamma_{\\mathrm{HV}}| = 0.90 \\times |\\gamma_{\\mathrm{vol}}| + 0.05 \\times |\\gamma_{\\mathrm{db}}| + 0.05 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{HV}}| \\approx 0.90(0.135335) + 0.05(0.651430) + 0.05(0.740818)$\n$|\\gamma_{\\mathrm{HV}}| \\approx 0.121802 + 0.032572 + 0.037041 = 0.191415$\n四舍五入至三位有效数字， $|\\gamma_{\\mathrm{HV}}| \\approx 0.191$。\n\n对于 VV 极化（$f_{\\mathrm{vol}} = 0.70$, $f_{\\mathrm{db}} = 0.10$, $f_{\\mathrm{s}} = 0.20$）：\n$|\\gamma_{\\mathrm{VV}}| = 0.70 \\times |\\gamma_{\\mathrm{vol}}| + 0.10 \\times |\\gamma_{\\mathrm{db}}| + 0.20 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{VV}}| \\approx 0.70(0.135335) + 0.10(0.651430) + 0.20(0.740818)$\n$|\\gamma_{\\mathrm{VV}}| \\approx 0.094735 + 0.065143 + 0.148164 = 0.308042$\n四舍五入至三位有效数字， $|\\gamma_{\\mathrm{VV}}| \\approx 0.308$。\n\n最后，我们论证哪种极化方式具有最高的相干性。计算出的值为 $|\\gamma_{\\mathrm{HH}}| \\approx 0.402$, $|\\gamma_{\\mathrm{HV}}| \\approx 0.191$, 和 $|\\gamma_{\\mathrm{VV}}| \\approx 0.308$。HH 极化产生了最高的相干性。\n\n这个结果在物理上是合理的。根据时间常数，散射分量的时间相干性排序如下：$|\\gamma_{\\mathrm{vol}}|  |\\gamma_{\\mathrm{db}}|  |\\gamma_{\\mathrm{s}}|$。体散射分量（冠层树叶和小树枝）动态性最强，去相干最快，而表面散射和二次散射分量（涉及地面和树干）则更稳定。总相干性是这些分量相干性的加权平均值。\n- HV 通道主要由体散射主导（$f_{\\mathrm{vol, HV}} = 0.90$），而体散射是最不稳定的分量，导致其总体相干性最低。这是植被区域交叉极化的典型特征。\n- VV 通道有较大但稍小的体散射贡献（$f_{\\mathrm{vol, VV}} = 0.70$），以及来自稳定表面分量的更显著贡献（$f_{\\mathrm{s, VV}} = 0.20$）。\n- HH 通道来自不稳定体散射分量的贡献最小（$f_{\\mathrm{vol, HH}} = 0.50$），而来自中等稳定的二次散射分量的贡献最大（$f_{\\mathrm{db, HH}} = 0.40$）。\nHH 极化对来自地-干相互作用的相对稳定的二面角散射敏感，这种散射在森林中（尤其是在L波段）非常显著，使其能够比 VV 和 HV 保持更高的相干性。因此，预期 HH 极化具有最高的相干性，这一结论也为计算所证实。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.402  0.191  0.308\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实的InSAR测量数据常常被噪声污染，特别是来自大气延迟 $\\phi_{\\mathrm{atm}}$ 和植被变化的噪声。这项最终的实践将演示一种强大的技术——时间序列叠加（stacking），用以从随机噪声源中区分出长期、一致的形变信号。你将亲手计算要达到一个可靠的信噪比（$\\mathrm{SNR}$）目标所需的最少观测次数，这是现代大地测量学中的一项关键技能。",
            "id": "3822666",
            "problem": "一个以常绿森林为主的沿海低地，在干涉合成孔径雷达（InSAR）产品中显示出准线性的视线方向相位梯度。为了检验该梯度是由大气延迟结构还是构造形变引起的，您需要设计一个通过调控采集时间和叠加策略的实验。从InSAR相位可观测量的第一性原理以及相关随机场的基本统计特性出发。\n\n假设在位置 $x$ 和时间 $t$ 的干涉相位可以建模为\n$$\n\\phi(x,t) = \\frac{4\\pi}{\\lambda}\\,u_{\\mathrm{LOS}}(x,t) + \\phi_{\\mathrm{atm}}(x,t) + \\phi_{\\mathrm{noise}}(x,t),\n$$\n其中 $\\lambda$ 是雷达波长，$u_{\\mathrm{LOS}}$ 是视线方向的位移，$\\phi_{\\mathrm{atm}}$ 是对流层延迟相位，$\\phi_{\\mathrm{noise}}$ 包括仪器和残余的体去相关效应。考虑在残余地形相位已被移除的平缓变化地形上测量的空间相位梯度 $g(x,t) = \\partial \\phi(x,t)/\\partial x$。\n\n您将在同一区域上实现两组干涉图叠加：\n\n- 一个“匹配时间”叠加组，由采集时间在相同本地时间的 $\\pm 10$ 分钟内且在同一季节窗口内的干涉图构成；该叠加组旨在保留大气相关性。\n- 一个“随机时间”叠加组，由采集时间广泛跨越昼夜周期和多个季节的干涉图构成；该叠加组旨在最小化干涉图之间的大气相关性。\n\n假设以下物理上合理的参数：\n\n- 雷达波长 $\\lambda = 0.056\\,\\mathrm{m}$ (C波段)。\n- 区域应变几何的视线方向投影系数 $c_{\\mathrm{LOS}} = 0.8$。\n- 均匀水平应变率 $\\epsilon = 5.0\\times 10^{-6}\\,\\mathrm{yr}^{-1}$，在干涉时间基线 $\\Delta t$ 上产生一个恒定的位移梯度 $\\partial u/\\partial x = \\epsilon\\,\\Delta t$。\n- 叠加组中每个干涉图的干涉时间基线 $\\Delta t = 24$ 天 $= \\frac{24}{365.25}\\,\\mathrm{yr}$。\n- 每个干涉图的大气相位梯度建模为一个零均值高斯随机变量 $a_i$，其方差为 $\\sigma_{\\mathrm{atm}}^{2}$，叠加组中不同干涉图之间的等相关系数为 $\\rho$；取 $\\sigma_{\\mathrm{atm}} = 0.08\\,\\mathrm{rad/km}$，对于随机时间叠加组，$\\rho = 0.005$。\n- 每个干涉图的仪器加残余体去相关梯度建模为一个零均值高斯随机变量 $n_i$，在不同干涉图间独立，方差为 $\\sigma_{\\mathrm{instr}}^{2}$；取 $\\sigma_{\\mathrm{instr}} = 0.02\\,\\mathrm{rad/km}$。\n\n设 $g_i$ 表示随机时间叠加组中第 $i$ 个干涉图的测量梯度，其中 $g_i = g_{\\mathrm{def}} + a_i + n_i$，$g_{\\mathrm{def}}$ 是确定性的形变引起的相位梯度。使用随机时间叠加组的均值 $\\bar{g} = \\frac{1}{N}\\sum_{i=1}^{N} g_i$，您将基于信噪比（SNR）设定一个探测准则，要求\n$$\n\\mathrm{SNR} = \\frac{|g_{\\mathrm{def}}|}{\\sqrt{\\mathrm{Var}(\\bar{g})}} \\geq 4.\n$$\n\n从上述定义出发，仅使用关于相位到位移转换和等相关条件下均值方差的成熟结论，推导给定 $\\epsilon$、$\\Delta t$、$c_{\\mathrm{LOS}}$ 和 $\\lambda$ 下的 $g_{\\mathrm{def}}$，并用 $N$、$\\sigma_{\\mathrm{atm}}$、$\\rho$ 和 $\\sigma_{\\mathrm{instr}}$ 表示随机时间叠加组的 $\\mathrm{Var}(\\bar{g})$。然后求解满足信噪比准则的随机时间叠加组中干涉图的最小数量 $N_{\\min}$。\n\n将 $N_{\\min}$ 报告为整数。无需按有效数字取整，最终报告值中不应包含单位。",
            "solution": "问题陈述经核实具有科学依据、问题明确且客观。它为解决InSAR时间序列分析中的一个形式化问题提供了一套完整且一致的参数，该问题与指定主题直接相关。所有给定值在物理上都是合理的。该问题是一个标准的信号检测练习，其根源在于干涉测量法和统计信号处理的基本原理。因此，将推导求解。\n\n目标是找到随机时间叠加组中干涉图的最小数量 $N_{\\min}$，使得平均相位梯度 $\\bar{g}$ 的信噪比（$\\mathrm{SNR}$）至少为 $4$。$\\mathrm{SNR}$ 定义为：\n$$\n\\mathrm{SNR} = \\frac{|g_{\\mathrm{def}}|}{\\sqrt{\\mathrm{Var}(\\bar{g})}} \\geq 4\n$$\n这需要推导确定性形变梯度 $g_{\\mathrm{def}}$ 和平均梯度方差 $\\mathrm{Var}(\\bar{g})$ 的表达式。\n\n首先，我们推导由形变引起的相位梯度 $g_{\\mathrm{def}}$ 的表达式。由形变引起的相位分量由所提供模型的第一项给出：\n$$\n\\phi_{\\mathrm{def}}(x,t) = \\frac{4\\pi}{\\lambda}\\,u_{\\mathrm{LOS}}(x,t)\n$$\n相应的相位梯度 $g_{\\mathrm{def}}$ 是该项的空间导数：\n$$\ng_{\\mathrm{def}} = \\frac{\\partial \\phi_{\\mathrm{def}}}{\\partial x} = \\frac{4\\pi}{\\lambda}\\,\\frac{\\partial u_{\\mathrm{LOS}}}{\\partial x}\n$$\n问题陈述一个均匀的水平应变率 $\\epsilon$ 在干涉时间基线 $\\Delta t$ 上产生一个水平位移梯度 $\\frac{\\partial u}{\\partial x} = \\epsilon\\,\\Delta t$。视线方向投影系数 $c_{\\mathrm{LOS}}$ 将水平位移梯度与视线方向位移梯度联系起来。因此，我们有：\n$$\n\\frac{\\partial u_{\\mathrm{LOS}}}{\\partial x} = c_{\\mathrm{LOS}}\\,\\frac{\\partial u}{\\partial x} = c_{\\mathrm{LOS}}\\,\\epsilon\\,\\Delta t\n$$\n将此代入 $g_{\\mathrm{def}}$ 的表达式，得到：\n$$\ng_{\\mathrm{def}} = \\frac{4\\pi}{\\lambda}\\,c_{\\mathrm{LOS}}\\,\\epsilon\\,\\Delta t\n$$\n\n接下来，我们推导平均梯度的方差 $\\mathrm{Var}(\\bar{g})$。第 $i$ 个干涉图的测量梯度为 $g_i = g_{\\mathrm{def}} + a_i + n_i$，其中 $g_{\\mathrm{def}}$ 是一个常数，$a_i$ 是大气相位梯度，$n_i$ 是仪器和去相关噪声梯度。$N$ 个干涉图的平均梯度为：\n$$\n\\bar{g} = \\frac{1}{N}\\sum_{i=1}^{N} g_i = \\frac{1}{N}\\sum_{i=1}^{N} (g_{\\mathrm{def}} + a_i + n_i) = g_{\\mathrm{def}} + \\frac{1}{N}\\sum_{i=1}^{N} a_i + \\frac{1}{N}\\sum_{i=1}^{N} n_i\n$$\n$\\bar{g}$ 的方差是随机部分的方差：\n$$\n\\mathrm{Var}(\\bar{g}) = \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} a_i + \\frac{1}{N}\\sum_{i=1}^{N} n_i\\right)\n$$\n由于大气噪声项 ($a_i$) 和仪器噪声项 ($n_i$) 是独立的，它们的和的方差是它们方差的和：\n$$\n\\mathrm{Var}(\\bar{g}) = \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} a_i\\right) + \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} n_i\\right) = \\frac{1}{N^2}\\left[\\mathrm{Var}\\left(\\sum_{i=1}^{N} a_i\\right) + \\mathrm{Var}\\left(\\sum_{i=1}^{N} n_i\\right)\\right]\n$$\n仪器噪声项 $n_i$ 是独立的，方差为 $\\sigma_{\\mathrm{instr}}^2$。因此，它们的和的方差是它们方差的和：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{N} n_i\\right) = \\sum_{i=1}^{N} \\mathrm{Var}(n_i) = N\\,\\sigma_{\\mathrm{instr}}^2\n$$\n大气噪声项 $a_i$ 是零均值高斯随机变量，方差为 $\\sigma_{\\mathrm{atm}}^2$，对于任何一对不同的干涉图（$i \\neq j$），等相关系数为 $\\rho$。它们的和的方差是：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{N} a_i\\right) = \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\mathrm{Cov}(a_i, a_j) = \\sum_{i=1}^{N} \\mathrm{Var}(a_i) + \\sum_{i \\neq j} \\mathrm{Cov}(a_i, a_j)\n$$\n有 $N$ 个方差项 ($\\mathrm{Var}(a_i) = \\sigma_{\\mathrm{atm}}^2$) 和 $N(N-1)$ 个协方差项。对于 $i \\neq j$，$\\mathrm{Cov}(a_i, a_j) = \\rho\\,\\sqrt{\\mathrm{Var}(a_i)\\mathrm{Var}(a_j)} = \\rho\\,\\sigma_{\\mathrm{atm}}^2$。\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{N} a_i\\right) = N\\,\\sigma_{\\mathrm{atm}}^2 + N(N-1)\\,\\rho\\,\\sigma_{\\mathrm{atm}}^2 = N\\,\\sigma_{\\mathrm{atm}}^2\\,[1+(N-1)\\rho]\n$$\n将这些代回 $\\mathrm{Var}(\\bar{g})$ 的表达式中：\n$$\n\\mathrm{Var}(\\bar{g}) = \\frac{1}{N^2} \\left[ N\\,\\sigma_{\\mathrm{atm}}^2\\,(1+(N-1)\\rho) + N\\,\\sigma_{\\mathrm{instr}}^2 \\right] = \\frac{1}{N} \\left[ \\sigma_{\\mathrm{atm}}^2\\,(1+(N-1)\\rho) + \\sigma_{\\mathrm{instr}}^2 \\right]\n$$\n这个表达式可以重排，以分离出依赖于 $N$ 和不依赖于 $N$ 的项：\n$$\n\\mathrm{Var}(\\bar{g}) = \\frac{\\sigma_{\\mathrm{atm}}^2(1-\\rho) + \\sigma_{\\mathrm{instr}}^2}{N} + \\rho\\,\\sigma_{\\mathrm{atm}}^2\n$$\n现在我们使用 $\\mathrm{SNR}$ 条件：\n$$\n\\frac{g_{\\mathrm{def}}^2}{\\mathrm{Var}(\\bar{g})} \\geq 16 \\implies g_{\\mathrm{def}}^2 \\geq 16\\,\\mathrm{Var}(\\bar{g})\n$$\n代入 $\\mathrm{Var}(\\bar{g})$ 的表达式：\n$$\ng_{\\mathrm{def}}^2 \\geq 16 \\left( \\frac{\\sigma_{\\mathrm{atm}}^2(1-\\rho) + \\sigma_{\\mathrm{instr}}^2}{N} + \\rho\\,\\sigma_{\\mathrm{atm}}^2 \\right)\n$$\n我们求解 $N$：\n$$\ng_{\\mathrm{def}}^2 - 16\\,\\rho\\,\\sigma_{\\mathrm{atm}}^2 \\geq \\frac{16}{N} \\left( \\sigma_{\\mathrm{atm}}^2(1-\\rho) + \\sigma_{\\mathrm{instr}}^2 \\right)\n$$\n$$\nN \\geq \\frac{16 \\left( \\sigma_{\\mathrm{atm}}^2(1-\\rho) + \\sigma_{\\mathrm{instr}}^2 \\right)}{g_{\\mathrm{def}}^2 - 16\\,\\rho\\,\\sigma_{\\mathrm{atm}}^2}\n$$\n干涉图的最小数量 $N_{\\min}$ 是满足此不等式的最小整数。\n\n最后，我们代入给定的数值：\n$\\lambda = 0.056\\,\\mathrm{m}$\n$c_{\\mathrm{LOS}} = 0.8$\n$\\epsilon = 5.0\\times 10^{-6}\\,\\mathrm{yr}^{-1}$\n$\\Delta t = \\frac{24}{365.25}\\,\\mathrm{yr}$\n$\\sigma_{\\mathrm{atm}} = 0.08\\,\\mathrm{rad/km}$，所以 $\\sigma_{\\mathrm{atm}}^2 = 0.0064\\,\\mathrm{rad}^2/\\mathrm{km}^2$\n$\\sigma_{\\mathrm{instr}} = 0.02\\,\\mathrm{rad/km}$，所以 $\\sigma_{\\mathrm{instr}}^2 = 0.0004\\,\\mathrm{rad}^2/\\mathrm{km}^2$\n$\\rho = 0.005$\n\n首先，计算 $g_{\\mathrm{def}}$。噪声参数的单位是 $\\mathrm{rad/km}$，所以我们必须通过乘以 $1000\\,\\mathrm{m/km}$ 将 $g_{\\mathrm{def}}$ 转换为这些单位。\n$$\ng_{\\mathrm{def}} = \\frac{4\\pi}{0.056\\,\\mathrm{m}}\\,(0.8)\\,(5.0\\times 10^{-6}\\,\\mathrm{yr}^{-1})\\,\\left(\\frac{24}{365.25}\\,\\mathrm{yr}\\right) \\times (1000\\,\\mathrm{m/km}) \\approx 0.058983\\,\\mathrm{rad/km}\n$$\n$$\ng_{\\mathrm{def}}^2 \\approx 0.0034790\\,\\mathrm{rad}^2/\\mathrm{km}^2\n$$\n现在，计算 $N$ 的不等式中的各项：\n分子：\n$$\n16 \\left( \\sigma_{\\mathrm{atm}}^2(1-\\rho) + \\sigma_{\\mathrm{instr}}^2 \\right) = 16 \\left( 0.0064(1-0.005) + 0.0004 \\right)\n$$\n$$\n= 16 \\left( 0.0064 \\times 0.995 + 0.0004 \\right) = 16 \\left( 0.006368 + 0.0004 \\right) = 16(0.006768) = 0.108288\n$$\n分母：\n$$\ng_{\\mathrm{def}}^2 - 16\\,\\rho\\,\\sigma_{\\mathrm{atm}}^2 \\approx 0.0034790 - 16(0.005)(0.0064) = 0.0034790 - 0.000512 = 0.0029670\n$$\n现在，计算比率：\n$$\nN \\geq \\frac{0.108288}{0.0029670} \\approx 36.497\n$$\n由于 $N$ 必须是整数，所需的最小干涉图数量是大于或等于此值的最小整数。\n$$\nN_{\\min} = \\lceil 36.497 \\rceil = 37\n$$",
            "answer": "$$\\boxed{37}$$"
        }
    ]
}