{
    "hands_on_practices": [
        {
            "introduction": "光与光滑表面的相互作用遵循电磁学的基本原理。本练习将引导您直接从麦克斯韦方程组的边界条件出发，推导描述光在电介质界面上反射和透射行为的菲涅尔方程。通过将这些方程应用于一个实际的遥感场景——水体上的太阳耀斑——您不仅将计算反射率，还将预测由此产生的偏振效应，这是BRDF各向异性研究中的一个关键方面。",
            "id": "3857433",
            "problem": "一台遥感成像光谱偏振仪观测到深邃、光学光滑水面上的太阳耀光现象。在观测波长下，水可以被建模为折射率为 $n_{2} = 1.33$ 的非磁性、各向同性、无损耗电介质，其上方的空气近似为折射率为 $n_{1} = 1.000$ 的非吸收性介质。一束准直、非偏振的太阳辐射光束从大气入射到平坦的水面上，其入射角 $\\theta_{i} = 60^{\\circ}$（相对于表面法线测量）。仪器位于镜面（高光）反射方向，因此反射方向满足反射定律。\n\n从平面界面处的电磁边界条件（电场和磁场切向分量的连续性）以及边界上的相位匹配条件出发，推导相对于入射面定义的两种正交线偏振态的振幅反射系数：电场垂直于入射面的偏振（$s$-偏振）和电场平行于入射面的偏振（$p$-偏振）。利用这些系数，计算在给定入射角 $\\theta_{i}$ 和折射率下的相应反射率系数 $F_{s}$ 和 $F_{p}$（$s$ 和 $p$ 偏振的反射辐照度与入射辐照度之比）。\n\n假设水面在镜面反射方向附近的双向反射分布函数（BRDF）主要由该平面界面的菲涅尔镜面反射项决定。利用能量守恒和在镜面反射方向收集的反射光束的线性偏振度定义，预测仪器测量的反射辐射亮度的线性偏振度（以无量纲分数表示）。将您的最终答案表示为三个数字，顺序为 $F_{s}$、$F_{p}$ 和线性偏振度。每个数字四舍五入到四位有效数字。整个过程中角度必须以度为单位处理。",
            "solution": "经评估，问题陈述有效。其科学依据是经典电磁学原理，特别是电磁波在电介质界面上的行为。该问题是适定的 (well-posed)，提供了推导菲涅尔方程和计算所需量所需的所有信息（$n_1=1.000$，$n_2=1.33$，$\\theta_i=60^{\\circ}$，非偏振入射光）。语言客观，场景物理上真实。\n\n我们首先建立几何和物理框架。设两种介质之间的界面为 $z=0$ 平面。入射面为 $x-z$ 平面。一束入射平面电磁波在介质1（折射率 $n_1$）中传播并射向界面，产生一束在介质1中的反射波和一束在介质2（折射率 $n_2$）中的透射波。入射、反射和透射电场可以写为：\n$$ \\vec{E}_i(\\vec{r}, t) = \\vec{E}_{0i} \\exp[i(\\vec{k}_i \\cdot \\vec{r} - \\omega t)] $$\n$$ \\vec{E}_r(\\vec{r}, t) = \\vec{E}_{0r} \\exp[i(\\vec{k}_r \\cdot \\vec{r} - \\omega t)] $$\n$$ \\vec{E}_t(\\vec{r}, t) = \\vec{E}_{0t} \\exp[i(\\vec{k}_t \\cdot \\vec{r} - \\omega t)] $$\n波矢由下式给出 $\\vec{k}_i = k_1(\\sin\\theta_i \\hat{x} + \\cos\\theta_i \\hat{z})$，$\\vec{k}_r = k_1(\\sin\\theta_r \\hat{x} - \\cos\\theta_r \\hat{z})$，以及 $\\vec{k}_t = k_2(\\sin\\theta_t \\hat{x} + \\cos\\theta_t \\hat{z})$，其中 $k_1 = n_1 \\omega/c$ 且 $k_2 = n_2 \\omega/c$。\n\n电磁边界条件要求电场 $\\vec{E}$ 和磁场 $\\vec{H}$ 的切向分量在 $z=0$ 的界面上是连续的。为了使这些条件在界面上的所有点和所有时间都成立，三束波的相位在 $z=0$ 处必须相等。这个相位匹配条件，$(\\vec{k}_i \\cdot \\vec{r})_{z=0} = (\\vec{k}_r \\cdot \\vec{r})_{z=0} = (\\vec{k}_t \\cdot \\vec{r})_{z=0}$，导出了两个基本定律：\n$1$. 反射定律：$\\theta_i = \\theta_r$。\n$2$. 斯涅尔定律：$n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$。\n\n边界条件是：\n$1$. $(\\vec{E}_i + \\vec{E}_r)_{\\parallel} = (\\vec{E}_t)_{\\parallel}$\n$2$. $(\\vec{H}_i + \\vec{H}_r)_{\\parallel} = (\\vec{H}_t)_{\\parallel}$\n\n我们现在推导两种正交偏振态的振幅反射系数。\n\n**1. 垂直（$s$-）偏振**\n对于 $s$-偏振，电场矢量垂直于入射面，即在 $y$-方向。\n$\\vec{E}_i = E_{0i} \\hat{y}$，$\\vec{E}_r = E_{0r} \\hat{y}$，$\\vec{E}_t = E_{0t} \\hat{y}$。\n第一个边界条件（切向 $\\vec{E}$ 连续）给出：\n$$ E_{0i} + E_{0r} = E_{0t} $$\n磁场与电场的关系为 $\\vec{H} = \\frac{1}{\\mu_0 \\omega} (\\vec{k} \\times \\vec{E})$。$\\vec{H}$ 的切向分量位于 $x$-方向。\n$H_{ix} = -H_i \\cos\\theta_i = -\\frac{n_1}{c\\mu_0} E_{0i} \\cos\\theta_i$。\n$H_{rx} = H_r \\cos\\theta_r = \\frac{n_1}{c\\mu_0} E_{0r} \\cos\\theta_i$（由于 $\\vec{k}_r$ 的 $z$-分量为负，符号为正）。\n$H_{tx} = -H_t \\cos\\theta_t = -\\frac{n_2}{c\\mu_0} E_{0t} \\cos\\theta_t$。\n第二个边界条件（切向 $\\vec{H}$ 连续）给出：\n$$ -\\frac{n_1}{c\\mu_0} E_{0i} \\cos\\theta_i + \\frac{n_1}{c\\mu_0} E_{0r} \\cos\\theta_i = -\\frac{n_2}{c\\mu_0} E_{0t} \\cos\\theta_t $$\n$$ n_1 \\cos\\theta_i (E_{0i} - E_{0r}) = n_2 \\cos\\theta_t E_{0t} $$\n将 $E_{0t} = E_{0i} + E_{0r}$ 代入此方程：\n$$ n_1 \\cos\\theta_i (E_{0i} - E_{0r}) = n_2 \\cos\\theta_t (E_{0i} + E_{0r}) $$\n求解振幅反射系数 $r_s = E_{0r}/E_{0i}$：\n$$ E_{0r} (-n_1 \\cos\\theta_i - n_2 \\cos\\theta_t) = E_{0i} (n_2 \\cos\\theta_t - n_1 \\cos\\theta_i) $$\n$$ r_s = \\frac{E_{0r}}{E_{0i}} = \\frac{n_1 \\cos\\theta_i - n_2 \\cos\\theta_t}{n_1 \\cos\\theta_i + n_2 \\cos\\theta_t} $$\n\n**2. 平行（$p$-）偏振**\n对于 $p$-偏振，磁场矢量垂直于入射面，即在 $y$-方向。\n$\\vec{H}_i = H_{0i} \\hat{y}$，$\\vec{H}_r = H_{0r} \\hat{y}$，$\\vec{H}_t = H_{0t} \\hat{y}$。\n第二个边界条件给出：\n$$ H_{0i} + H_{0r} = H_{0t} $$\n电场位于 $x-z$ 平面。切向分量在 $x$-方向。对于非磁性介质，$E = Z H = \\frac{Z_0}{n} H$，其中 $Z_0=\\sqrt{\\mu_0/\\epsilon_0}$。\n$E_{ix} = E_i \\cos\\theta_i = \\frac{Z_0}{n_1} H_{0i} \\cos\\theta_i$。\n$E_rx = -E_r \\cos\\theta_r = -\\frac{Z_0}{n_1} H_{0r} \\cos\\theta_i$。\n$E_{tx} = E_t \\cos\\theta_t = \\frac{Z_0}{n_2} H_{0t} \\cos\\theta_t$。\n第一个边界条件给出：\n$$ \\frac{Z_0}{n_1} H_{0i} \\cos\\theta_i - \\frac{Z_0}{n_1} H_{0r} \\cos\\theta_i = \\frac{Z_0}{n_2} H_{0t} \\cos\\theta_t $$\n$$ \\frac{\\cos\\theta_i}{n_1} (H_{0i} - H_{0r}) = \\frac{\\cos\\theta_t}{n_2} H_{0t} $$\n代入 $H_{0t} = H_{0i} + H_{0r}$：\n$$ \\frac{\\cos\\theta_i}{n_1} (H_{0i} - H_{0r}) = \\frac{\\cos\\theta_t}{n_2} (H_{0i} + H_{0r}) $$\n通常使用电场的振幅反射系数 $r_p = E_{0r}/E_{0i}$。根据场的符号约定（$E_{r} \\propto -H_r$, $E_{i} \\propto H_i$），我们得到 $r_p = -H_{0r}/H_{0i}$。然而，存在不同的约定。直接推导 $r_p$（或使用许多标准教科书中显示的等价关系）给出：\n$$ r_p = \\frac{E_{0r}}{E_{0i}} = \\frac{n_2 \\cos\\theta_i - n_1 \\cos\\theta_t}{n_2 \\cos\\theta_i + n_1 \\cos\\theta_t} $$\n\n**数值计算**\n给定值为 $n_1 = 1.000$，$n_2 = 1.33$，以及 $\\theta_i = 60^{\\circ}$。\n首先，根据斯涅尔定律求出透射角 $\\theta_t$：$n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$。\n$$ \\sin\\theta_t = \\frac{n_1}{n_2} \\sin\\theta_i = \\frac{1.000}{1.33} \\sin(60^{\\circ}) \\approx 0.651147 $$\n$$ \\theta_t = \\arcsin(0.651147) \\approx 40.6272^{\\circ} $$\n我们还需要这些角度的余弦值：\n$\\cos\\theta_i = \\cos(60^{\\circ}) = 0.5$\n$\\cos\\theta_t = \\cos(40.6272^{\\circ}) \\approx 0.758954$\n\n现在我们可以计算反射率系数 $F_s$ 和 $F_p$，它们是反射辐照度与入射辐照度之比，等于振幅反射系数模的平方：$F = |r|^2$。\n对于 $s$-偏振：\n$$ r_s = \\frac{1.000 \\times 0.5 - 1.33 \\times 0.758954}{1.000 \\times 0.5 + 1.33 \\times 0.758954} = \\frac{0.5 - 1.009409}{0.5 + 1.009409} \\approx -0.33751 $$\n$$ F_s = |r_s|^2 \\approx (-0.33751)^2 \\approx 0.113915 $$\n对于 $p$-偏振：\n$$ r_p = \\frac{1.33 \\times 0.5 - 1.000 \\times 0.758954}{1.33 \\times 0.5 + 1.000 \\times 0.758954} = \\frac{0.665 - 0.758954}{0.665 + 0.758954} \\approx -0.065981 $$\n$$ F_p = |r_p|^2 \\approx (-0.065981)^2 \\approx 0.0043535 $$\n\n**线性偏振度**\n入射的太阳辐射是非偏振的，这意味着它包含等量的 $s$-偏振光和 $p$-偏振光辐照度。设总入射辐照度为 $I_i$。则 $I_{is} = I_{ip} = I_i/2$。\n每个分量的反射辐照度为：\n$I_{rs} = F_s I_{is} = F_s (I_i/2)$\n$I_{rp} = F_p I_{ip} = F_p (I_i/2)$\n反射光束的线性偏振度（DoLP）定义为正交偏振分量之间的归一化差异：\n$$ \\text{DoLP} = \\frac{|I_{rs} - I_{rp}|}{I_{rs} + I_{rp}} $$\n代入反射辐照度的表达式：\n$$ \\text{DoLP} = \\frac{|F_s (I_i/2) - F_p (I_i/2)|}{F_s (I_i/2) + F_p (I_i/2)} = \\frac{|F_s - F_p|}{F_s + F_p} $$\n使用计算出的 $F_s$ 和 $F_p$ 值：\n$$ \\text{DoLP} = \\frac{|0.113915 - 0.0043535|}{0.113915 + 0.0043535} = \\frac{0.1095615}{0.1182685} \\approx 0.92638 $$\n将最终结果四舍五入到四位有效数字：\n$F_s \\approx 0.1139$\n$F_p \\approx 0.004354$\n$\\text{DoLP} \\approx 0.9264$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1139  0.004354  0.9264 \\end{pmatrix} } $$"
        },
        {
            "introduction": "大多数自然地表并非完美光滑，其粗糙度显著影响其反射特性。微面元理论通过将粗糙表面处理为无数微观、完美镜面反射的集合，为模拟这些效应提供了强大的框架。本问题将挑战您使用应用广泛的Cook-Torrance BRDF模型，探索微面元朝向的统计分布如何决定镜面反射峰的形状和宽度。",
            "id": "3857382",
            "problem": "一个粗糙的电介质表面使用 Cook–Torrance 微面元双向反射分布函数 (BRDF) 进行建模，其中微面元朝向遵循各向同性的贝克曼法线分布。粗糙度参数是均方根斜率 $\\sigma$，折射率为 $n$，入射方向 $\\boldsymbol{\\omega}_{i}$ 由入射平面内从表面法线测量的极角 $\\theta_{i}$ 指定。BRDF 取决于半角向量 $\\boldsymbol{h} = (\\boldsymbol{\\omega}_{i} + \\boldsymbol{\\omega}_{o})/\\|\\boldsymbol{\\omega}_{i} + \\boldsymbol{\\omega}_{o}\\|$、微面元法线的贝克曼分布、电介质的菲涅尔反射因子以及遮蔽-阴影项。\n\n使用上述物理模型和微面元反射几何的第一性原理，对 $\\sigma = 0.2$ (无量纲斜率)、$n = 1.5$ 和 $\\theta_{i} = 40^\\circ$ 进行以下操作：\n\n1. 确定出射极角 $\\theta_{r}$（在入射平面内从表面法线测量），在该角度下 BRDF 的镜面反射波瓣达到其最大值（镜面反射峰值方向）。假设为非偏振反射，并从确定峰值的驻点条件进行论证。\n\n2. 在波瓣顶部附近的贝克曼分布的小角度近似下（即 $\\tan \\theta_{h} \\approx \\theta_{h}$，其中 $\\theta_{h}$ 是半角向量与法线的倾斜角），并假设菲涅尔因子和遮蔽-阴影项在峰值附近变化缓慢，推导镜面反射波瓣在入射平面内的半峰全宽 (FWHM) 作为 $\\sigma$ 函数的解析表达式。然后对给定的 $\\sigma$ 数值计算此 FWHM。\n\n将两个角度（峰值方向 $\\theta_{r}$ 和 FWHM）均以度表示。将结果四舍五入到三位有效数字。",
            "solution": "该问题提法明确，具有科学依据，并提供了足够的信息来确定所要求的量。所用的物理模型，即带有贝克曼法线分布的 Cook-Torrance 双向反射分布函数 (BRDF)，是物理学和计算机图形学中一个标准且成熟的模型。提供的参数，粗糙度 $\\sigma = 0.2$、折射率 $n = 1.5$ 和入射角 $\\theta_{i} = 40^\\circ$，在物理上是现实的。因此，我们可以进行完整的求解。\n\nCook-Torrance 微面元 BRDF 由以下表达式给出：\n$$f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) = \\frac{F(\\boldsymbol{\\omega}_o, \\boldsymbol{h}) G(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o, \\boldsymbol{h}) D(\\boldsymbol{h})}{4 (\\boldsymbol{n} \\cdot \\boldsymbol{\\omega}_i) (\\boldsymbol{n} \\cdot \\boldsymbol{\\omega}_o)}$$\n其中 $\\boldsymbol{\\omega}_i$ 和 $\\boldsymbol{\\omega}_o$ 是入射和出射方向，$\\boldsymbol{n}$ 是宏观表面法线，$\\boldsymbol{h}$ 是半角向量，$F$ 是菲涅尔反射项，$G$ 是 Smith 几何（遮蔽-阴影）项，$D$ 是微面元法线分布函数 (NDF)。对于本问题，NDF 是各向同性的贝克曼分布：\n$$D(\\boldsymbol{h}) = \\frac{1}{\\pi \\sigma^2 \\cos^4 \\theta_h} \\exp\\left(-\\frac{\\tan^2 \\theta_h}{\\sigma^2}\\right)$$\n此处，$\\theta_h$ 是半角向量 $\\boldsymbol{h}$ 和宏观表面法线 $\\boldsymbol{n}$ 之间的夹角。\n\n第一部分：确定镜面反射峰值方向 $\\theta_r$。\n\nBRDF 的镜面反射波瓣是围绕镜面反射方向的反射能量的尖锐峰值。此峰值的形状和位置绝大部分由 NDF 项 $D(\\boldsymbol{h})$ 决定。与 NDF 在其最大值附近的快速变化相比，菲涅尔项 $F$、几何项 $G$ 以及分母中的余弦项随出射角 $\\boldsymbol{\\omega}_o$ 的变化要慢得多。问题陈述支持这一点，允许假设 $F$ 和 $G$ 是缓慢变化的。因此，BRDF 的峰值对应于 NDF $D(\\boldsymbol{h})$ 的最大值。\n\n为了找到 $D(\\boldsymbol{h})$ 的最大值，我们通过对 $\\theta_h$ 求导并将其设为零来找到驻点。找到 $\\ln(D(\\boldsymbol{h}))$ 的最大值会更简单。\n$$\\ln(D(\\boldsymbol{h})) = -\\ln(\\pi \\sigma^2) - 4\\ln(\\cos \\theta_h) - \\frac{\\tan^2 \\theta_h}{\\sigma^2}$$\n$$\\frac{d}{d\\theta_h} \\ln(D(\\boldsymbol{h})) = -4 \\frac{-\\sin \\theta_h}{\\cos \\theta_h} - \\frac{1}{\\sigma^2} (2 \\tan \\theta_h \\sec^2 \\theta_h) = 4\\tan \\theta_h - \\frac{2\\tan \\theta_h}{\\sigma^2 \\cos^2 \\theta_h} = 2\\tan\\theta_h \\left(2 - \\frac{1}{\\sigma^2 \\cos^2\\theta_h}\\right)$$\n当 $\\tan \\theta_h = 0$ 时，导数为零，这意味着 $\\theta_h = 0$；或者当 $2 - \\frac{1}{\\sigma^2 \\cos^2\\theta_h} = 0$ 时导数为零。第二个条件给出 $\\cos^2\\theta_h = \\frac{1}{2\\sigma^2}$。对于给定的 $\\sigma=0.2$，我们有 $\\sigma^2=0.04$，因此 $\\cos^2\\theta_h = \\frac{1}{2(0.04)} = \\frac{1}{0.08} = 12.5$。这是不可能的，因为 $\\cos^2\\theta_h \\le 1$。因此，唯一符合物理实际的驻点，即对应于分布最大值的点，出现在 $\\theta_h = 0$ 处。\n\n条件 $\\theta_h = 0$ 意味着半角向量 $\\boldsymbol{h}$ 与宏观表面法线 $\\boldsymbol{n}$ 对齐。根据定义，半角向量 $\\boldsymbol{h}$ 平分入射方向 $\\boldsymbol{\\omega}_i$ 和出射方向 $\\boldsymbol{\\omega}_o$ 之间的夹角。当 $\\boldsymbol{h}$ 与 $\\boldsymbol{n}$ 对齐时，法线 $\\boldsymbol{n}$ 也必须平分 $\\boldsymbol{\\omega}_i$ 和 $\\boldsymbol{\\omega}_o$ 之间的夹角。对于入射平面内的反射，这是宏观表面发生完美镜面反射的几何条件。这要求出射极角 $\\theta_r$ 等于入射极角 $\\theta_i$。\n给定 $\\theta_{i} = 40^\\circ$，镜面反射峰值出现在：\n$$\\theta_r = \\theta_i = 40^\\circ$$\n四舍五入到三位有效数字，镜面反射峰值方向为 $\\theta_r = 40.0^\\circ$。\n\n第二部分：推导和计算半峰全宽 (FWHM)。\n\n为了找到镜面反射波瓣的 FWHM，我们分析其峰值附近 NDF 的形状。问题指定对贝克曼分布使用小角度近似，其中 $\\tan \\theta_h \\approx \\theta_h$，因此 $\\cos \\theta_h \\approx 1$。在此近似下，NDF 简化为关于 $\\theta_h$ 的高斯函数：\n$$D(\\theta_h) \\approx \\frac{1}{\\pi \\sigma^2} \\exp\\left(-\\frac{\\theta_h^2}{\\sigma^2}\\right)$$\n该分布的最大值出现在 $\\theta_h=0$ 处，为 $D_{\\text{max}} = \\frac{1}{\\pi \\sigma^2}$。FWHM 是通过找到使函数值等于其最大值一半的角度 $\\theta_h$ 来确定的：$D(\\theta_h) = \\frac{1}{2} D_{\\text{max}}$。\n$$\\frac{1}{\\pi \\sigma^2} \\exp\\left(-\\frac{\\theta_h^2}{\\sigma^2}\\right) = \\frac{1}{2} \\left(\\frac{1}{\\pi \\sigma^2}\\right)$$\n$$\\exp\\left(-\\frac{\\theta_h^2}{\\sigma^2}\\right) = \\frac{1}{2}$$\n对两边取自然对数，得到：\n$$-\\frac{\\theta_h^2}{\\sigma^2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln 2$$\n$$\\theta_h^2 = \\sigma^2 \\ln 2$$\n因此，半角向量角度的半峰值点为 $\\theta_h = \\pm \\sigma \\sqrt{\\ln 2}$。\n\n接下来，我们必须将半角向量角 $\\theta_h$ 与出射观测角 $\\theta_r$ 联系起来。让我们定义一个坐标系，其中表面法线为 $\\boldsymbol{n}=(0,1)$，表面位于 x 轴上。对于入射平面内的反射，入射和出射向量可以写为 $\\boldsymbol{\\omega}_i = (-\\sin\\theta_i, \\cos\\theta_i)$ 和 $\\boldsymbol{\\omega}_o = (\\sin\\theta_r, \\cos\\theta_r)$。半角向量 $\\boldsymbol{h}$ 与它们的和成正比：\n$$\\boldsymbol{h} \\propto \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o = (\\sin\\theta_r - \\sin\\theta_i, \\cos\\theta_r + \\cos\\theta_i)$$\n该向量与法线 $\\boldsymbol{n}$ 的夹角 $\\theta_h$ 由 $\\tan \\theta_h = \\frac{h_x}{h_y}$ 给出：\n$$\\tan \\theta_h = \\frac{\\sin\\theta_r - \\sin\\theta_i}{\\cos\\theta_r + \\cos\\theta_i}$$\n使用和差化积三角恒等式，这可以简化为：\n$$\\tan \\theta_h = \\frac{2\\cos\\left(\\frac{\\theta_r+\\theta_i}{2}\\right)\\sin\\left(\\frac{\\theta_r-\\theta_i}{2}\\right)}{2\\cos\\left(\\frac{\\theta_r+\\theta_i}{2}\\right)\\cos\\left(\\frac{\\theta_r-\\theta_i}{2}\\right)} = \\tan\\left(\\frac{\\theta_r-\\theta_i}{2}\\right)$$\n对于小角度，$\\tan(x) \\approx x$，这意味着 $\\theta_h \\approx \\frac{\\theta_r - \\theta_i}{2}$。实际上，这个几何关系是精确的：$\\theta_h = \\frac{\\theta_r - \\theta_i}{2}$。\n\n在半峰值点，我们将此关系代入我们关于 $\\theta_h$ 的条件中：\n$$\\frac{\\theta_r - \\theta_i}{2} = \\pm \\sigma \\sqrt{\\ln 2}$$\n定义 FWHM 的两个出射角 $\\theta_{r,1}$ 和 $\\theta_{r,2}$ 是：\n$$\\theta_{r,1} = \\theta_i + 2\\sigma\\sqrt{\\ln 2}$$\n$$\\theta_{r,2} = \\theta_i - 2\\sigma\\sqrt{\\ln 2}$$\nFWHM 是这两个角度之差，$\\text{FWHM} = \\theta_{r,1} - \\theta_{r,2}$。\n$$\\text{FWHM} = (\\theta_i + 2\\sigma\\sqrt{\\ln 2}) - (\\theta_i - 2\\sigma\\sqrt{\\ln 2}) = 4\\sigma\\sqrt{\\ln 2}$$\n这是推导出的 FWHM 作为 $\\sigma$ 函数的解析表达式（以弧度为单位）。\n\n为了进行数值计算，我们使用给定的值 $\\sigma = 0.2$。以弧度为单位的 FWHM 是：\n$$\\text{FWHM}_{\\text{rad}} = 4(0.2)\\sqrt{\\ln 2} = 0.8\\sqrt{\\ln 2} \\approx 0.8 \\times 0.83255 \\approx 0.66604 \\text{ rad}$$\n问题要求答案以度为单位。从弧度转换为度：\n$$\\text{FWHM}_{\\text{deg}} = \\text{FWHM}_{\\text{rad}} \\times \\frac{180^\\circ}{\\pi} \\approx 0.66604 \\times \\frac{180^\\circ}{3.14159} \\approx 38.158^\\circ$$\n将结果四舍五入到三位有效数字，我们得到 FWHM 为 $38.2^\\circ$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.0  38.2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "BRDF模型在遥感中的实用价值在于，可以利用观测数据对其进行反演，以获取定量的地表参数。本练习将从理论转向应用，要求您为一个核驱动的BRDF模型实现加权最小二乘反演。通过将模型拟合到综合的多角度观测数据，您不仅将估计出关键的模型系数，还将学会如何正确地传递观测不确定性，从而得出反演参数的最终不确定度。",
            "id": "3857436",
            "problem": "考虑一个核驱动的双向反射分布函数（BRDF）模型，其中多角度表面反射率观测值表示为具有物理意义的基函数的线性组合。设太阳天顶角为 $\\theta_s$，观测天顶角为 $\\theta_v$，相对方位角为 $\\phi$。所有角度均以度为单位提供，但在进行任何三角计算之前必须转换为弧度。定义以下三个核：\n- 各向同性核：$K_{\\text{iso}}(\\theta_s,\\theta_v,\\phi) = 1$。\n- 体散射核：$K_{\\text{vol}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\theta_s) + \\cos(\\theta_v)$。\n- 几何光学核：$K_{\\text{geo}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\alpha)$，其中相角余弦为 $\\cos(\\alpha) = \\cos(\\theta_s)\\cos(\\theta_v) + \\sin(\\theta_s)\\sin(\\theta_v)\\cos(\\phi)$。\n\n设在 $n$ 个多角度几何下的反射率观测向量为 $\\mathbf{y} \\in \\mathbb{R}^n$（无量纲），核设计矩阵为 $\\mathbf{K} \\in \\mathbb{R}^{n \\times 3}$，其行由在每个几何下评估的 $\\left[K_{\\text{iso}}, K_{\\text{vol}}, K_{\\text{geo}}\\right]$ 构成。设系数向量为 $\\mathbf{f} = [f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}]^T$。假设一个加性噪声模型 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$，其中协方差矩阵 $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{n \\times n}$ 为已知的正定矩阵。观测值满足 $\\mathbf{y} = \\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}$。\n\n任务：根据上述统计和物理定义，实现一个加权最小二乘反演，从 $(\\mathbf{K}, \\mathbf{y}, \\boldsymbol{\\Sigma})$ 估计 $\\widehat{\\mathbf{f}}$，并计算由 $\\widehat{\\mathbf{f}}$ 的后验协方差矩阵的对角线元素的平方根量化的后验不确定度。使用以度为单位的角度，并在计算三角函数之前将它们转换为弧度。反射率是无量纲的，协方差条目是反射率的平方（无量纲的平方）。对于每个测试用例，你的程序必须输出一个包含6个浮点数的列表，顺序为 $[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}]$，其中 $\\sigma_{f_i}$ 表示相应系数的后验标准差。将所有测试用例的结果汇总到一行，打印为由方括号括起来的逗号分隔列表，每个测试用例的结果本身也是一个由方括号括起来的逗号分隔列表。例如，精确打印形如 $[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$ 的单行。\n\n测试套件：\n- 测试用例 $1$（通用，良态）：\n  - 太阳天顶角 $\\theta_s = 35^\\circ$。\n  - 观测天顶角 $\\theta_v = [\\,0^\\circ,\\,15^\\circ,\\,30^\\circ,\\,45^\\circ,\\,60^\\circ\\,]$。\n  - 相对方位角 $\\phi = [\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ\\,]$。\n  - 观测值 $\\mathbf{y} = [\\,0.09107876,\\,0.089902325,\\,0.08826754,\\,0.08292132,\\,0.07738777\\,]$（无量纲）。\n  - 协方差 $\\boldsymbol{\\Sigma} = \\operatorname{diag}([\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6}\\,])$（无量纲的平方）。\n- 测试用例 $2$（相关噪声，更倾斜的几何结构）：\n  - 太阳天顶角 $\\theta_s = 60^\\circ$。\n  - 观测天顶角 $\\theta_v = [\\,10^\\circ,\\,35^\\circ,\\,50^\\circ,\\,70^\\circ,\\,80^\\circ\\,]$。\n  - 相对方位角 $\\phi = [\\,180^\\circ,\\,150^\\circ,\\,120^\\circ,\\,90^\\circ,\\,60^\\circ\\,]$。\n  - 观测值 $\\mathbf{y} = [\\,0.081806256,\\,0.076078325,\\,0.073304186,\\,0.067395453,\\,0.066140008\\,]$（无量纲）。\n  - 协方差 $\\boldsymbol{\\Sigma} = 10^{-6}\\times \\begin{bmatrix}\n    4  1  0.6  0.3  0.1 \\\\\n    1  4  1  0.6  0.3 \\\\\n    0.6  1  4  1  0.6 \\\\\n    0.3  0.6  1  4  1 \\\\\n    0.1  0.3  0.6  1  4\n  \\end{bmatrix}$（无量纲的平方）。\n- 测试用例 $3$（边界情况，观测数等于系数数）：\n  - 太阳天顶角 $\\theta_s = 25^\\circ$。\n  - 观测天顶角 $\\theta_v = [\\,10^\\circ,\\,40^\\circ,\\,70^\\circ\\,]$。\n  - 相对方位角 $\\phi = [\\,0^\\circ,\\,90^\\circ,\\,180^\\circ\\,]$。\n  - 观测值 $\\mathbf{y} = [\\,0.092351932,\\,0.0871184046,\\,0.0744293686\\,]$（无量纲）。\n  - 协方差 $\\boldsymbol{\\Sigma} = \\operatorname{diag}([\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6}\\,])$（无量纲的平方）。\n\n算法要求：\n- 通过在每个几何下使用转换为弧度的角度评估 $K_{\\text{iso}}$、$K_{\\text{vol}}$ 和 $K_{\\text{geo}}$ 来构建 $\\mathbf{K}$。\n- 实现一个基于协方差为 $\\boldsymbol{\\Sigma}$ 的高斯似然推导出的、符合统计学原理的加权最小二乘估计器。\n- 在线性高斯模型假设下，计算 $\\widehat{\\mathbf{f}}$ 的后验协方差。\n- 提取后验不确定度，即后验协方差矩阵对角线元素的平方根。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含按上述测试用例顺序排列的结果，格式为由方括号括起来的逗号分隔列表。即，打印 $[\\,[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}],\\,[\\cdots],\\,[\\cdots]\\,]$。",
            "solution": "该问题要求从多角度反射率观测中估计线性双向反射分布函数（BRDF）模型的参数。这是一个统计信号处理和遥感领域的经典参数估计问题，可以使用加权最小二乘法（WLS）来解决。\n\n模型由以下线性方程给出：\n$$\n\\mathbf{y} = \\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}\n$$\n其中：\n- $\\mathbf{y} \\in \\mathbb{R}^n$ 是 $n$ 个反射率观测值的向量。\n- $\\mathbf{K} \\in \\mathbb{R}^{n \\times 3}$ 是设计矩阵，其行由在每个观测几何下评估的三个核函数构成。\n- $\\mathbf{f} = [f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}]^T$ 是待估计的 $3$ 个未知系数的向量。\n- $\\boldsymbol{\\epsilon} \\in \\mathbb{R}^n$ 是观测噪声向量，建模为均值为零、协方差矩阵为已知的正定矩阵 $\\boldsymbol{\\Sigma}$ 的多元正态分布，即 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$。\n\n三个核函数根据太阳天顶角 $\\theta_s$、观测天顶角 $\\theta_v$ 和相对方位角 $\\phi$ 定义。至关重要的是，所有以度为单位给出的角度，在使用任何三角函数之前都必须转换为弧度。\n- 各向同性核：$K_{\\text{iso}}(\\theta_s,\\theta_v,\\phi) = 1$。此核代表在所有方向上均一的各向同性散射。\n- 体散射核：$K_{\\text{vol}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\theta_s) + \\cos(\\theta_v)$。此核模拟来自一个体积（如植被冠层）的散射，其中光穿过介质的路径长度是一个关键因素。\n- 几何光学核：$K_{\\text{geo}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\alpha)$，其中相角余弦由 $\\cos(\\alpha) = \\cos(\\theta_s)\\cos(\\theta_v) + \\sin(\\theta_s)\\sin(\\theta_v)\\cos(\\phi)$ 给出。此核解释了几何效应，如阴影和场景组分间的相互遮蔽。\n\n任务是找到系数向量的最佳估计 $\\widehat{\\mathbf{f}}$，并量化该估计的不确定度。\n\n给定高斯噪声模型，参数 $\\mathbf{f}$ 的似然函数为：\n$$\n\\mathcal{L}(\\mathbf{f} | \\mathbf{y}, \\mathbf{K}, \\boldsymbol{\\Sigma}) \\propto \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})\\right)\n$$\n最大化此似然函数等同于最小化负对数似然，这简化为最小化指数中的二次型，通常表示为卡方统计量：\n$$\nS(\\mathbf{f}) = (\\mathbf{y} - \\mathbf{K}\\mathbf{f})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})\n$$\n这个最小化问题被称为加权最小二乘法，其权重矩阵是噪声协方差矩阵的逆，即 $\\mathbf{W} = \\boldsymbol{\\Sigma}^{-1}$。\n\n为了找到 $S(\\mathbf{f})$ 的最小值，我们计算其关于 $\\mathbf{f}$ 的梯度并令其为零：\n$$\n\\nabla_{\\mathbf{f}} S(\\mathbf{f}) = \\nabla_{\\mathbf{f}} \\left( \\mathbf{y}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} - 2\\mathbf{f}^T \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + \\mathbf{f}^T \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K} \\mathbf{f} \\right) = -2 \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + 2 \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K} \\mathbf{f} = \\mathbf{0}\n$$\n这导致了WLS问题的所谓正规方程：\n$$\n(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) \\mathbf{f} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}\n$$\n假设矩阵 $(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})$ 是可逆的（通常在观测数量 $n$ 至少等于参数数量（$3$）且 $\\mathbf{K}$ 的列线性无关时成立），我们可以解出估计量 $\\widehat{\\mathbf{f}}$：\n$$\n\\widehat{\\mathbf{f}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}\n$$\n这是参数向量 $\\mathbf{f}$ 的WLS解。\n\n下一步是确定与此估计相关的不确定度。在频率学派框架中，这对应于估计量 $\\widehat{\\mathbf{f}}$ 的协方差。利用协方差的性质，特别是对于常数矩阵 $\\mathbf{A}$，有 $\\operatorname{Cov}(\\mathbf{A}\\mathbf{x}) = \\mathbf{A}\\operatorname{Cov}(\\mathbf{x})\\mathbf{A}^T$，我们得到：\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\operatorname{Cov}(\\widehat{\\mathbf{f}}) = \\operatorname{Cov}\\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} \\right)\n$$\n令 $\\mathbf{M} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1}$。由于 $\\mathbf{f}$ 是一个固定（但未知）的量，$\\operatorname{Cov}(\\mathbf{y}) = \\operatorname{Cov}(\\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}) = \\operatorname{Cov}(\\boldsymbol{\\epsilon}) = \\boldsymbol{\\Sigma}$。\n因此：\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\mathbf{M} \\operatorname{Cov}(\\mathbf{y}) \\mathbf{M}^T = \\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\right) \\boldsymbol{\\Sigma} \\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\right)^T\n$$\n利用 $\\boldsymbol{\\Sigma}$ 和 $(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})$ 是对称的这一事实，此表达式可大大简化：\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1}) \\boldsymbol{\\Sigma} (\\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) ((\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1})\n$$\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1}\n$$\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1}\n$$\n这个矩阵 $\\mathbf{C}_{\\widehat{\\mathbf{f}}}$ 是估计参数的后验协方差矩阵（在贝叶斯背景下使用平坦先验，或在频率学派背景下是估计量的抽样分布的协方差）。每个参数的后验不确定度是该矩阵对角线元素的平方根：\n$$\n\\sigma_{f_i} = \\sqrt{(\\mathbf{C}_{\\widehat{\\mathbf{f}}})_{ii}}\n$$\n其中 $i \\in \\{\\text{iso}, \\text{vol}, \\text{geo}\\}$。\n\n待实现的算法如下：\n1. 对于每个测试用例，解析所提供的角度 $(\\theta_s, \\theta_v, \\phi)$、观测向量 $\\mathbf{y}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$。\n2. 将所有角度值从度转换为弧度。\n3. 通过为 $n$ 个观测几何中的每一个计算 $K_{\\text{iso}}$、$K_{\\text{vol}}$ 和 $K_{\\text{geo}}$ 的值，构建 $n \\times 3$ 的设计矩阵 $\\mathbf{K}$。\n4. 计算观测协方差矩阵的逆 $\\boldsymbol{\\Sigma}^{-1}$。\n5. 计算矩阵 $\\mathbf{A} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}$。\n6. 后验协方差矩阵是 $\\mathbf{A}$ 的逆：$\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\mathbf{A}^{-1}$。\n7. 计算向量 $\\mathbf{b} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}$。\n8. 计算估计的参数向量：$\\widehat{\\mathbf{f}} = \\mathbf{C}_{\\widehat{\\mathbf{f}}} \\mathbf{b}$。\n9. 通过取 $\\mathbf{C}_{\\widehat{\\mathbf{f}}}$ 对角线元素的平方根来提取后验标准差。\n10. 为每个测试用例组装六个输出值 $[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}]$ 并按要求格式化。",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1 (general, well-conditioned)\n        {\n            \"theta_s_deg\": 35.0,\n            \"theta_v_deg\": np.array([0.0, 15.0, 30.0, 45.0, 60.0]),\n            \"phi_deg\": np.array([0.0, 30.0, 60.0, 90.0, 120.0]),\n            \"y\": np.array([0.09107876, 0.089902325, 0.08826754, 0.08292132, 0.07738777]),\n            \"Sigma\": np.diag([1e-6] * 5),\n        },\n        # Test Case 2 (correlated noise, more oblique geometries)\n        {\n            \"theta_s_deg\": 60.0,\n            \"theta_v_deg\": np.array([10.0, 35.0, 50.0, 70.0, 80.0]),\n            \"phi_deg\": np.array([180.0, 150.0, 120.0, 90.0, 60.0]),\n            \"y\": np.array([0.081806256, 0.076078325, 0.073304186, 0.067395453, 0.066140008]),\n            \"Sigma\": 1e-6 * np.array([\n                [4.0, 1.0, 0.6, 0.3, 0.1],\n                [1.0, 4.0, 1.0, 0.6, 0.3],\n                [0.6, 1.0, 4.0, 1.0, 0.6],\n                [0.3, 0.6, 1.0, 4.0, 1.0],\n                [0.1, 0.3, 0.6, 1.0, 4.0]\n            ]),\n        },\n        # Test Case 3 (boundary case, n=p)\n        {\n            \"theta_s_deg\": 25.0,\n            \"theta_v_deg\": np.array([10.0, 40.0, 70.0]),\n            \"phi_deg\": np.array([0.0, 90.0, 180.0]),\n            \"y\": np.array([0.092351932, 0.0871184046, 0.0744293686]),\n            \"Sigma\": np.diag([1e-6] * 3),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = estimate_brdf_params(\n            case[\"theta_s_deg\"],\n            case[\"theta_v_deg\"],\n            case[\"phi_deg\"],\n            case[\"y\"],\n            case[\"Sigma\"]\n        )\n        results.append(result)\n\n    # Convert each inner list to its string representation\n    # and join them with commas.\n    str_results = [str(res) for res in results]\n    final_output = f\"[{','.join(str_results)}]\"\n    print(final_output)\n\ndef estimate_brdf_params(theta_s_deg, theta_v_deg, phi_deg, y, Sigma):\n    \"\"\"\n    Estimates BRDF model parameters and their uncertainties using Weighted Least Squares.\n\n    Args:\n        theta_s_deg (float): Solar zenith angle in degrees.\n        theta_v_deg (np.ndarray): Array of view zenith angles in degrees.\n        phi_deg (np.ndarray): Array of relative azimuth angles in degrees.\n        y (np.ndarray): Vector of reflectance observations.\n        Sigma (np.ndarray): Covariance matrix of the observations.\n\n    Returns:\n        list: A list of 6 floats: [f_iso, f_vol, f_geo, sigma_f_iso, sigma_f_vol, sigma_f_geo].\n    \"\"\"\n    # Convert angles from degrees to radians\n    theta_s = np.deg2rad(theta_s_deg)\n    theta_v = np.deg2rad(theta_v_deg)\n    phi = np.deg2rad(phi_deg)\n\n    # Pre-compute trigonometric values\n    cos_ts, sin_ts = np.cos(theta_s), np.sin(theta_s)\n    cos_tv, sin_tv = np.cos(theta_v), np.sin(theta_v)\n    cos_phi = np.cos(phi)\n\n    # Construct the design matrix K\n    n_obs = len(y)\n    K = np.zeros((n_obs, 3))\n\n    # K_iso\n    K[:, 0] = 1.0\n\n    # K_vol\n    K[:, 1] = cos_ts + cos_tv\n    \n    # K_geo\n    K[:, 2] = cos_ts * cos_tv + sin_ts * sin_tv * cos_phi\n\n    # Perform Weighted Least Squares\n    # WLS solution: f_hat = (K.T * Sigma^-1 * K)^-1 * K.T * Sigma^-1 * y\n    \n    # Inverse of the covariance matrix (Weight matrix)\n    Sigma_inv = linalg.inv(Sigma)\n\n    # Compute the posterior covariance matrix of parameters: (K.T * Sigma^-1 * K)^-1\n    # This is a 3x3 matrix.\n    KT_Sigma_inv_K = K.T @ Sigma_inv @ K\n    \n    # Using scipy.linalg.inv as specified in the execution environment\n    post_cov_f = linalg.inv(KT_Sigma_inv_K)\n\n    # Compute the parameter estimates\n    KT_Sigma_inv_y = K.T @ Sigma_inv @ y\n    f_hat = post_cov_f @ KT_Sigma_inv_y\n\n    # Compute uncertainties (standard deviations)\n    # These are the square roots of the diagonal elements of the posterior covariance matrix\n    uncertainties = np.sqrt(np.diag(post_cov_f))\n\n    # Assemble the result vector\n    result_list = list(f_hat) + list(uncertainties)\n    \n    return result_list\n\nsolve()\n\n```"
        }
    ]
}