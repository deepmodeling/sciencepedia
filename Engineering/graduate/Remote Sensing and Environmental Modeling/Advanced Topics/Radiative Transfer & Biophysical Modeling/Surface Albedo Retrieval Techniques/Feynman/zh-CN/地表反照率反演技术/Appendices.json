{
    "hands_on_practices": [
        {
            "introduction": "地表反照率不是一个固定的数值，而是依赖于光照和观测几何。为了从定向反射数据中准确反演反照率，我们必须理解地表反射的各向异性，这通常由双向反射分布函数（BRDF）来描述。这项练习将指导您从一个简化的、由核驱动的BRDF模型出发，通过半球积分来推导黑空反照率（准直光照下的方向-半球反射率），从而掌握从BRDF到反照率的基本计算方法。",
            "id": "3856738",
            "problem": "一个均匀、水平广阔的绿色植被冠层的表面双向反射分布函数 (BRDF) 由一个核驱动展开式表示，该展开式捕捉了各向同性、体积散射和几何各向异性的贡献。设反射因子建模为\n$$\nR(\\theta_{0},\\theta_{v},\\phi)=f_{\\text{iso}}\\,K_{\\text{iso}}(\\theta_{0},\\theta_{v},\\phi)+f_{\\text{vol}}\\,K_{\\text{vol}}(\\theta_{0},\\theta_{v},\\phi)+f_{\\text{geo}}\\,K_{\\text{geo}}(\\theta_{0},\\theta_{v},\\phi),\n$$\n其中 $\\theta_{0}$ 是太阳天顶角，$\\theta_{v}$ 是观测天顶角，$\\phi$ 是相对方位角。考虑以下具有物理动机的一阶核函数：\n$$\nK_{\\text{iso}}(\\theta_{0},\\theta_{v},\\phi)=1,\\quad K_{\\text{vol}}(\\theta_{0},\\theta_{v},\\phi)=\\cos\\theta_{0}\\cos\\theta_{v},\\quad K_{\\text{geo}}(\\theta_{0},\\theta_{v},\\phi)=\\sin\\theta_{0}\\sin\\theta_{v}\\cos\\phi.\n$$\n黑空反照率（平行光照射下的方向-半球反射率），记为 $\\alpha_{bs}(\\theta_{0})$，根据第一性原理定义为反射因子经投影因子加权后的半球积分，并由 $\\pi$ 进行归一化：\n$$\n\\alpha_{bs}(\\theta_{0})=\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\int_{0}^{\\pi/2}R(\\theta_{0},\\theta_{v},\\phi)\\,\\cos\\theta_{v}\\,\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}\\,\\mathrm{d}\\phi.\n$$\n假设在可见光波段，核驱动参数对于中等密度的阔叶植被是典型的：\n$$\nf_{\\text{iso}}=0.12,\\quad f_{\\text{vol}}=0.35,\\quad f_{\\text{geo}}=-0.05.\n$$\n角度以度为单位。从上述定义出发，推导此核驱动 BRDF 的 $\\alpha_{bs}(\\theta_{0})$ 的解析表达式，然后计算在 $\\theta_{0}=30^{\\circ}$ 和 $\\theta_{0}=60^{\\circ}$ 时的 $\\alpha_{bs}$ 值。计算其差值\n$$\n\\Delta\\alpha_{bs}=\\alpha_{bs}(60^{\\circ})-\\alpha_{bs}(30^{\\circ})\n$$\n结果表示为无量纲小数，并将最终数值结果四舍五入至四位有效数字。",
            "solution": "双向反射分布函数 (BRDF) 的反射因子由下式给出\n$$\nR(\\theta_{0},\\theta_{v},\\phi)=f_{\\text{iso}}+f_{\\text{vol}}\\cos\\theta_{0}\\cos\\theta_{v}+f_{\\text{geo}}\\sin\\theta_{0}\\sin\\theta_{v}\\cos\\phi,\n$$\n使用指定的核函数。黑空反照率定义为\n$$\n\\alpha_{bs}(\\theta_{0})=\\frac{1}{\\pi}\\int_{0}^{2\\pi}\\int_{0}^{\\pi/2}\\left(f_{\\text{iso}}+f_{\\text{vol}}\\cos\\theta_{0}\\cos\\theta_{v}+f_{\\text{geo}}\\sin\\theta_{0}\\sin\\theta_{v}\\cos\\phi\\right)\\cos\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}\\,\\mathrm{d}\\phi.\n$$\n我们利用线性性质逐项计算该积分。\n\n对于各向同性项，\n$$\nI_{\\text{iso}}=\\frac{1}{\\pi}f_{\\text{iso}}\\int_{0}^{2\\pi}\\int_{0}^{\\pi/2}\\cos\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}\\,\\mathrm{d}\\phi.\n$$\n首先进行 $\\phi$ 的积分，\n$$\n\\int_{0}^{2\\pi}\\mathrm{d}\\phi=2\\pi,\n$$\n对于 $\\theta_{v}$，使用换元法 $u=\\cos\\theta_{v}$，则 $\\mathrm{d}u=-\\sin\\theta_{v}\\mathrm{d}\\theta_{v}$，其中 $\\theta_{v}\\in[0,\\pi/2]\\Rightarrow u\\in[1,0]$：\n$$\n\\int_{0}^{\\pi/2}\\cos\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}=\\int_{1}^{0}u(-\\mathrm{d}u)=\\int_{0}^{1}u\\,\\mathrm{d}u=\\frac{1}{2}.\n$$\n因此，\n$$\nI_{\\text{iso}}=\\frac{1}{\\pi}f_{\\text{iso}}(2\\pi)\\left(\\frac{1}{2}\\right)=f_{\\text{iso}}.\n$$\n\n对于体积散射项，\n$$\nI_{\\text{vol}}=\\frac{1}{\\pi}f_{\\text{vol}}\\cos\\theta_{0}\\int_{0}^{2\\pi}\\int_{0}^{\\pi/2}\\cos\\theta_{v}\\cos\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}\\,\\mathrm{d}\\phi=\\frac{1}{\\pi}f_{\\text{vol}}\\cos\\theta_{0}\\int_{0}^{2\\pi}\\mathrm{d}\\phi\\int_{0}^{\\pi/2}\\cos^{2}\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}.\n$$\n使用同样的换元法 $u=\\cos\\theta_{v}$，\n$$\n\\int_{0}^{\\pi/2}\\cos^{2}\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}=\\int_{1}^{0}u^{2}(-\\mathrm{d}u)=\\int_{0}^{1}u^{2}\\,\\mathrm{d}u=\\frac{1}{3}.\n$$\n因此，\n$$\nI_{\\text{vol}}=\\frac{1}{\\pi}f_{\\text{vol}}\\cos\\theta_{0}(2\\pi)\\left(\\frac{1}{3}\\right)=\\frac{2}{3}f_{\\text{vol}}\\cos\\theta_{0}.\n$$\n\n对于几何项，\n$$\nI_{\\text{geo}}=\\frac{1}{\\pi}f_{\\text{geo}}\\sin\\theta_{0}\\int_{0}^{2\\pi}\\int_{0}^{\\pi/2}\\sin\\theta_{v}\\cos\\phi\\,\\cos\\theta_{v}\\sin\\theta_{v}\\,\\mathrm{d}\\theta_{v}\\,\\mathrm{d}\\phi=\\frac{1}{\\pi}f_{\\text{geo}}\\sin\\theta_{0}\\int_{0}^{2\\pi}\\cos\\phi\\,\\mathrm{d}\\phi\\int_{0}^{\\pi/2}\\cos\\theta_{v}\\sin^{2}\\theta_{v}\\,\\mathrm{d}\\theta_{v}.\n$$\n由于对称性，方位角积分为零，\n$$\n\\int_{0}^{2\\pi}\\cos\\phi\\,\\mathrm{d}\\phi=0,\n$$\n所以\n$$\nI_{\\text{geo}}=0.\n$$\n\n综合这些结果，得到解析表达式\n$$\n\\alpha_{bs}(\\theta_{0})=f_{\\text{iso}}+\\frac{2}{3}f_{\\text{vol}}\\cos\\theta_{0}.\n$$\n现在代入给定的参数 $f_{\\text{iso}}=0.12$，$f_{\\text{vol}}=0.35$，并在两个太阳天顶角处求值。角度以度为单位，\n$$\n\\cos(30^{\\circ})=\\frac{\\sqrt{3}}{2},\\quad \\cos(60^{\\circ})=\\frac{1}{2}.\n$$\n因此，\n$$\n\\alpha_{bs}(30^{\\circ})=0.12+\\frac{2}{3}\\cdot 0.35\\cdot \\frac{\\sqrt{3}}{2}=0.12+\\left(\\frac{2}{3}\\cdot 0.35\\right)\\left(\\frac{\\sqrt{3}}{2}\\right),\n$$\n以及\n$$\n\\alpha_{bs}(60^{\\circ})=0.12+\\frac{2}{3}\\cdot 0.35\\cdot \\frac{1}{2}=0.12+\\left(\\frac{2}{3}\\cdot 0.35\\right)\\left(\\frac{1}{2}\\right).\n$$\n计算公共因子：\n$$\n\\frac{2}{3}\\cdot 0.35=0.233333333333333.\n$$\n于是，\n$$\n\\alpha_{bs}(30^{\\circ})=0.12+0.233333333333333\\cdot 0.866025403784439\\approx 0.12+0.202072593\\approx 0.322072593,\n$$\n以及\n$$\n\\alpha_{bs}(60^{\\circ})=0.12+0.233333333333333\\cdot 0.5=0.12+0.116666666666667=0.236666666666667.\n$$\n所求的差值为\n$$\n\\Delta\\alpha_{bs}=\\alpha_{bs}(60^{\\circ})-\\alpha_{bs}(30^{\\circ})\\approx 0.236666666666667-0.322072593\\approx -0.085405926333333.\n$$\n四舍五入到四位有效数字，无量纲的差值为\n$$\n-0.08541.\n$$",
            "answer": "$$\\boxed{-0.08541}$$"
        },
        {
            "introduction": "卫星传感器通常只在几个离散的窄波段内测量地表反射率，而气候模型等应用需要的是覆盖整个太阳光谱范围的宽波段反照率。因此，将窄波段反照率转换为宽波段反照率是反照率反演中的一个关键步骤。该练习模拟了这一过程，您将学习如何利用给定的窄波段反照率和太阳光谱辐照度信息，通过加权平均来估算宽波段反照率。",
            "id": "3856768",
            "problem": "一个多光谱光学遥感仪器被用于反演地表反照率。根据第一性原理，宽波段短波地表反照率定义为光谱积分的反射辐照度与入射辐照度之比，即 $\\alpha_{\\mathrm{BB}} \\equiv \\dfrac{\\int_{\\Lambda} E_{\\downarrow}(\\lambda)\\,\\alpha(\\lambda)\\,d\\lambda}{\\int_{\\Lambda} E_{\\downarrow}(\\lambda)\\,d\\lambda}$，其中 $\\alpha(\\lambda)$ 是光谱地表反照率，$E_{\\downarrow}(\\lambda)$ 是地表的下行光谱辐照度，$\\Lambda$ 表示感兴趣的短波光谱范围。在晴空近天底条件下，受限于传感器的估算中，通常使用大气层顶(TOA)的太阳光谱辐照度 $E_{\\odot}(\\lambda)$ 与仪器的波段光谱响应函数 $S_b(\\lambda)$ 相结合来近似加权。\n\n考虑三个具有顶帽状光谱响应的非重叠波段\n$$\nS_1(\\lambda) = \\begin{cases}\n1,  \\lambda \\in [0.45,\\,0.52]\\,\\mu\\mathrm{m} \\\\\n0,  \\text{否则}\n\\end{cases},\\quad\nS_2(\\lambda) = \\begin{cases}\n1,  \\lambda \\in [0.52,\\,0.60]\\,\\mu\\mathrm{m} \\\\\n0,  \\text{否则}\n\\end{cases},\\quad\nS_3(\\lambda) = \\begin{cases}\n1,  \\lambda \\in [0.77,\\,0.90]\\,\\mu\\mathrm{m} \\\\\n0,  \\text{否则}\n\\end{cases}.\n$$\n在这些波段的并集范围内，将大气层顶的太阳光谱辐照度近似为线性函数\n$$\nE_{\\odot}(\\lambda) = 2.2 \\times 10^{3} - 1.5 \\times 10^{3}\\,\\lambda \\quad \\text{W m}^{-2}\\,\\mu\\mathrm{m}^{-1}.\n$$\n假设这些波段的窄波段反照率反演值为\n$$\n\\alpha_1 = 0.09,\\quad \\alpha_2 = 0.12,\\quad \\alpha_3 = 0.48.\n$$\n从宽波段反照率的基本定义以及给定的 $E_{\\odot}(\\lambda)$ 和 $S_b(\\lambda)$ 出发，推导一个使用所提供物理量的光谱加权窄波段到宽波段的 $\\alpha_{\\mathrm{BB}}$ 近似公式，然后计算其数值。将您的最终数值答案四舍五入到四位有效数字。将您的答案表示为无量纲小数（不加百分号）。",
            "solution": "宽波段短波反照率 $\\alpha_{\\mathrm{BB}}$ 的基本定义是在光谱范围 $\\Lambda$ 内，光谱积分的反射辐照度与光谱积分的入射辐照度之比：\n$$ \\alpha_{\\mathrm{BB}} = \\frac{\\int_{\\Lambda} \\alpha(\\lambda) E_{\\downarrow}(\\lambda)\\,d\\lambda}{\\int_{\\Lambda} E_{\\downarrow}(\\lambda)\\,d\\lambda} $$\n其中 $\\alpha(\\lambda)$ 是光谱反照率，$E_{\\downarrow}(\\lambda)$ 是地表的下行光谱辐照度。\n\n该问题要求对此量进行近似，我们将其表示为 $\\hat{\\alpha}_{\\mathrm{BB}}$，基于一系列简化：\n$1$. 地表下行辐照度 $E_{\\downarrow}(\\lambda)$ 由大气层顶(TOA)的太阳辐照度 $E_{\\odot}(\\lambda)$ 近似。\n$2$. 光谱积分域 $\\Lambda$ 被限制在仪器三个非重叠光谱波段的并集内。\n$3$. 真实的光谱反照率 $\\alpha(\\lambda)$ 被建模为分段常数函数，假设在整个波段 $b$ 内其值等于反演得到的窄波段反照率 $\\alpha_b$。\n\n应用这些条件，近似的宽波段反照率表示为各波段的加权和：\n$$ \\hat{\\alpha}_{\\mathrm{BB}} = \\frac{\\sum_{b=1}^{3} \\int_{\\text{波段 } b} E_{\\odot}(\\lambda) \\alpha(\\lambda) \\,d\\lambda}{\\sum_{b=1}^{3} \\int_{\\text{波段 } b} E_{\\odot}(\\lambda) \\,d\\lambda} = \\frac{\\sum_{b=1}^{3} \\alpha_b \\int_{\\text{波段 } b} E_{\\odot}(\\lambda) \\,d\\lambda}{\\sum_{b=1}^{3} \\int_{\\text{波段 } b} E_{\\odot}(\\lambda) \\,d\\lambda} $$\n令 $W_b = \\int_{\\text{波段 } b} E_{\\odot}(\\lambda) \\,d\\lambda$ 为波段 $b$ 内的积分辐照度。该公式即为一个加权平均：\n$$ \\hat{\\alpha}_{\\mathrm{BB}} = \\frac{\\alpha_1 W_1 + \\alpha_2 W_2 + \\alpha_3 W_3}{W_1 + W_2 + W_3} $$\n太阳光谱辐照度被给定为波长 $\\lambda$ (单位为 $\\mu\\text{m}$)的线性函数：\n$$ E_{\\odot}(\\lambda) = C_1 - C_2 \\lambda $$\n其中常数为 $C_1 = 2.2 \\times 10^3\\,\\text{W m}^{-2}\\,\\mu\\text{m}^{-1}$ 和 $C_2 = 1.5 \\times 10^3\\,\\text{W m}^{-2}\\,\\mu\\text{m}^{-2}$。\n我们对每个波段计算 $W_b = \\int_{\\lambda_{\\text{min},b}}^{\\lambda_{\\text{max},b}} (C_1 - C_2 \\lambda) \\,d\\lambda$。其反导数为 $F(\\lambda) = C_1 \\lambda - \\frac{1}{2} C_2 \\lambda^2$。\n\n对于波段1，其光谱范围为 $[\\lambda_{1,\\min}, \\lambda_{1,\\max}] = [0.45, 0.52]\\,\\mu\\text{m}$：\n$$ W_1 = F(0.52) - F(0.45) = [C_1(0.52) - \\frac{C_2}{2}(0.52)^2] - [C_1(0.45) - \\frac{C_2}{2}(0.45)^2] $$\n$$ W_1 = C_1(0.52 - 0.45) - \\frac{C_2}{2}(0.52^2 - 0.45^2) = (2.2 \\times 10^3)(0.07) - \\frac{1.5 \\times 10^3}{2}(0.2704 - 0.2025) $$\n$$ W_1 = 154 - (750)(0.0679) = 154 - 50.925 = 103.075 $$\n\n对于波段2，其光谱范围为 $[\\lambda_{2,\\min}, \\lambda_{2,\\max}] = [0.52, 0.60]\\,\\mu\\text{m}$：\n$$ W_2 = F(0.60) - F(0.52) = C_1(0.60 - 0.52) - \\frac{C_2}{2}(0.60^2 - 0.52^2) $$\n$$ W_2 = (2.2 \\times 10^3)(0.08) - \\frac{1.5 \\times 10^3}{2}(0.36 - 0.2704) $$\n$$ W_2 = 176 - (750)(0.0896) = 176 - 67.2 = 108.8 $$\n\n对于波段3，其光谱范围为 $[\\lambda_{3,\\min}, \\lambda_{3,\\max}] = [0.77, 0.90]\\,\\mu\\text{m}$：\n$$ W_3 = F(0.90) - F(0.77) = C_1(0.90 - 0.77) - \\frac{C_2}{2}(0.90^2 - 0.77^2) $$\n$$ W_3 = (2.2 \\times 10^3)(0.13) - \\frac{1.5 \\times 10^3}{2}(0.81 - 0.5929) $$\n$$ W_3 = 286 - (750)(0.2171) = 286 - 162.825 = 123.175 $$\n\n三个波段的总积分辐照度是这些单个值的总和：\n$$ W_{\\text{total}} = W_1 + W_2 + W_3 = 103.075 + 108.8 + 123.175 = 335.05 $$\n现在我们将这些积分辐照度（权重）和给定的窄波段反照率（$\\alpha_1=0.09$，$\\alpha_2=0.12$，$\\alpha_3=0.48$）代入 $\\hat{\\alpha}_{\\mathrm{BB}}$ 的表达式中。分子是总反射辐照度：\n$$ W_{\\text{refl}} = \\alpha_1 W_1 + \\alpha_2 W_2 + \\alpha_3 W_3 $$\n$$ W_{\\text{refl}} = (0.09)(103.075) + (0.12)(108.8) + (0.48)(123.175) $$\n$$ W_{\\text{refl}} = 9.27675 + 13.056 + 59.124 = 81.45675 $$\n宽波段反照率是总反射辐照度与总入射辐照度之比：\n$$ \\hat{\\alpha}_{\\mathrm{BB}} = \\frac{W_{\\text{refl}}}{W_{\\text{total}}} = \\frac{81.45675}{335.05} \\approx 0.24311192... $$\n问题要求将最终答案四舍五入到四位有效数字。\n$$ \\hat{\\alpha}_{\\mathrm{BB}} \\approx 0.2431 $$",
            "answer": "$$\\boxed{0.2431}$$"
        },
        {
            "introduction": "地表反照率不仅是一个物理参数，它在气候系统中扮演着至关重要的角色，尤其是在冰雪反照率反馈机制中。准确量化这种反馈的强度对于气候变化研究至关重要。本练习将带您超越反照率的反演，进入其应用的领域，通过分析反照率和太阳入射辐射的时间序列数据，您将推导并计算出反照率变化对季节性能量平衡的具体贡献。",
            "id": "3856762",
            "problem": "给定一个时间序列，包含从方向反射率通过双向反射分布函数（BRDF）归一化和窄波段到宽波段转换反演得到的宽波段地表反照率 $\\alpha(t)$，以及相应的地表向下短波日射 $S_{in}(t)$，两者都是在一个季节内每日采样的。从辐射能量守恒的基本原理以及地表反照率作为地表反射的入射短波辐射比例的定义出发，推导一个数学上严谨的表达式，用于表示时变雪反照率对地表季节性能量平衡的贡献，并量化其对净辐射 $R_{n}$ 的影响。为分离短波反馈的贡献，将长波分量视为独立于 $\\alpha(t)$。你的推导必须从地表能量平衡方程 $R_{n}(t) = R_{sw}(t) + R_{lw}(t)$ 以及反射和反照率的定义开始，并推导出一个季节平均表达式，该表达式能分离出可归因于 $\\alpha(t)$ 和 $S_{in}(t)$ 时间协变性的项。\n\n你的程序必须实现推导出的表达式，为每个测试用例计算以下两个量：\n- 雪反照率反馈对净辐射的季节平均贡献，单位为瓦特/平方米，以浮点数表示（单位：$\\mathrm{W\\,m^{-2}}$）。\n- 雪反照率反馈的季节性积分能量贡献，单位为焦耳/平方米，以浮点数表示（单位：$\\mathrm{J\\,m^{-2}}$），使用恒定的每日时间步长 $dt = 86400$ 秒。\n\n使用以下测试套件，其中 $t \\in \\{0,1,\\dots,N-1\\}$ 表示天数，所有日射值单位均为 $\\mathrm{W\\,m^{-2}}$：\n\n- 测试用例 $1$（典型的春季融雪伴随日射增加）：$N = 90$， $S_{in}(t) = 250 + 150 \\sin\\!\\left(\\frac{2\\pi t}{N}\\right)$， $\\alpha(t) = 0.80 - 0.40\\frac{t}{N-1}$。这代表一个高反照率的雪面随着季节性日射增加和积雪融化而逐渐变暗。\n- 测试用例 $2$（无反照率变化）：$N = 120$， $S_{in}(t) = 300 + 100 \\sin\\!\\left(\\frac{2\\pi t}{N}\\right)$， $\\alpha(t) = 0.50$。该用例分离出无雪反照率反馈的情况。\n- 测试用例 $3$（极夜）：$N = 60$， $S_{in}(t) = 0$， $\\alpha(t) = 0.70 - 0.10\\sin\\!\\left(\\frac{2\\pi t}{N}\\right)$。该用例反映了无短波输入的情况，因此任何反照率变化都不应产生短波能量效应。\n- 测试用例 $4$（反照率随日射增加而增加）：$N = 90$， $S_{in}(t) = 220 + 180 \\sin\\!\\left(\\frac{2\\pi t}{N}\\right)$， $\\alpha(t) = 0.30 + 0.50\\frac{t}{N-1}$。该用例代表地表随着日射增加而变亮，这应减少净短波吸收。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果以包含两个浮点数的列表形式报告，顺序为 $[\\text{季节平均贡献，单位 }\\mathrm{W\\,m^{-2}}, \\text{季节性积分能量，单位 }\\mathrm{J\\,m^{-2}}]$。例如，输出格式必须与 $[[x_{1},y_{1}],[x_{2},y_{2}],[x_{3},y_{3}],[x_{4},y_{4}]]$ 完全一样，其中 $x_{i}$ 和 $y_{i}$ 是浮点数。",
            "solution": "该问题要求推导一个表达式，用于表示时变雪反照率对季节性地表能量平衡的贡献，并对几个测试用例进行数值量化。推导必须从辐射能量守恒的基本原理开始。\n\n瞬时地表能量平衡由以下公式给出：\n$$R_{n}(t) = R_{sw}(t) + R_{lw}(t)$$\n其中 $R_{n}(t)$ 是地表净辐射，$R_{sw}(t)$ 是净短波辐射，$R_{lw}(t)$ 是净长波辐射，均为时间 $t$ 的函数。问题指出，长波分量可以被视为与地表反照率 $\\alpha(t)$ 无关。因此，时变反照率对净辐射的影响完全通过其对净短波辐射的影响来体现。因此，我们的重点是由 $\\alpha(t)$ 变化引起的 $\\Delta R_{sw}(t)$。\n\n净短波辐射 $R_{sw}(t)$ 是入射的向下短波辐射（日射）$S_{in}(t)$ 与地表反射的短波辐射 $S_{ref}(t)$ 之间的差值：\n$$R_{sw}(t) = S_{in}(t) - S_{ref}(t)$$\n宽波段地表反照率 $\\alpha(t)$ 定义为被反射的入射短波辐射的比例：\n$$\\alpha(t) = \\frac{S_{ref}(t)}{S_{in}(t)}$$\n根据这个定义，我们可以将反射辐射表示为 $S_{ref}(t) = \\alpha(t) S_{in}(t)$。将其代入 $R_{sw}(t)$ 的表达式中得到：\n$$R_{sw}(t) = S_{in}(t) - \\alpha(t) S_{in}(t) = (1 - \\alpha(t)) S_{in}(t)$$\n该方程描述了地表吸收的瞬时净短波辐射。\n\n为了分析季节性效应，我们计算 $R_{sw}(t)$ 的季节平均值。对于一个包含 $N$ 天的离散时间序列，一个量 $X(t)$ 的平均值用 $\\overline{X}$ 表示，并计算为 $\\overline{X} = \\frac{1}{N} \\sum_{t=0}^{N-1} X(t)$。季节平均净短波辐射为：\n$$\\overline{R_{sw}} = \\overline{(1 - \\alpha(t)) S_{in}(t)} = \\overline{S_{in}(t) - \\alpha(t) S_{in}(t)}$$\n利用平均算子的线性性质，我们得到：\n$$\\overline{R_{sw}} = \\overline{S_{in}(t)} - \\overline{\\alpha(t) S_{in}(t)}$$\n为了分离反照率和日射协变性的贡献，我们应用雷诺分解。任何随时间变化的变量 $X(t)$ 都可以分解为其季节平均值 $\\overline{X}$ 和偏离该平均值的时间变化扰动 $X'(t)$：\n$$X(t) = \\overline{X} + X'(t)$$\n根据定义，扰动的平均值为零，即 $\\overline{X'} = 0$。将此应用于 $\\alpha(t)$ 和 $S_{in}(t)$：\n$$\\alpha(t) = \\overline{\\alpha} + \\alpha'(t)$$\n$$S_{in}(t) = \\overline{S_{in}} + S_{in}'(t)$$\n现在，我们展开乘积项 $\\overline{\\alpha(t) S_{in}(t)}$：\n$$\\overline{\\alpha(t) S_{in}(t)} = \\overline{(\\overline{\\alpha} + \\alpha'(t)) (\\overline{S_{in}} + S_{in}'(t))}$$\n$$\\overline{\\alpha(t) S_{in}(t)} = \\overline{\\overline{\\alpha} \\overline{S_{in}} + \\overline{\\alpha} S_{in}'(t) + \\alpha'(t) \\overline{S_{in}} + \\alpha'(t) S_{in}'(t)}$$\n逐项应用平均算子，并利用 $\\overline{S_{in}'(t)} = 0$ 和 $\\overline{\\alpha'(t)} = 0$ 的事实：\n$$\\overline{\\alpha(t) S_{in}(t)} = \\overline{\\alpha}\\,\\overline{S_{in}} + \\overline{\\alpha}\\,\\overline{S_{in}'(t)} + \\overline{S_{in}}\\,\\overline{\\alpha'(t)} + \\overline{\\alpha'(t) S_{in}'(t)}$$\n$$\\overline{\\alpha(t) S_{in}(t)} = \\overline{\\alpha}\\,\\overline{S_{in}} + \\overline{\\alpha'(t) S_{in}'(t)}$$\n$\\overline{\\alpha'(t) S_{in}'(t)}$ 项是反照率和日射扰动之间的协方差。\n\n将这个展开形式代回 $\\overline{R_{sw}}$ 的方程中：\n$$\\overline{R_{sw}} = \\overline{S_{in}} - (\\overline{\\alpha}\\,\\overline{S_{in}} + \\overline{\\alpha'(t) S_{in}'(t)})$$\n$$\\overline{R_{sw}} = (1 - \\overline{\\alpha}) \\overline{S_{in}} - \\overline{\\alpha'(t) S_{in}'(t)}$$\n这个最终表达式将季节平均净短波辐射分为两个分量：\n1. $(1 - \\overline{\\alpha}) \\overline{S_{in}}$ 项表示如果反照率和日射都恒定在其季节平均值时将被吸收的净短波辐射。\n2. $- \\overline{\\alpha'(t) S_{in}'(t)}$ 项是由于反照率和日射的时间协变性而对平均净辐射产生的修正。该项量化了反照率反馈效应。负协方差（例如，在融雪期间，反照率随着日射增加而降低）导致该项为正值，从而增强吸收，这是一个正反馈。相反，正协方差减少吸收，代表一个负反馈。\n\n问题要求的是这种时变反照率反馈对净辐射的贡献。这正是第二项。我们将此贡献称为 $\\overline{\\Delta R_{n, \\text{feedback}}}$。\n$$\\overline{\\Delta R_{n, \\text{feedback}}} = - \\overline{\\alpha'(t) S_{in}'(t)}$$\n为了计算方便，使用从分解中导出的关系更直接：\n$$\\overline{\\alpha'(t) S_{in}'(t)} = \\overline{\\alpha(t) S_{in}(t)} - \\overline{\\alpha}\\,\\overline{S_{in}}$$\n因此，雪反照率反馈对净辐射的季节平均贡献（单位为 $\\mathrm{W\\,m^{-2}}$）是：\n$$\\overline{\\Delta R_{n, \\text{feedback}}} = - (\\overline{\\alpha(t) S_{in}(t)} - \\overline{\\alpha}\\,\\overline{S_{in}}) = \\overline{\\alpha}\\,\\overline{S_{in}} - \\overline{\\alpha(t) S_{in}(t)}$$\n这是要计算的第一个量。\n\n第二个量是季节性积分能量贡献 $E_{\\text{feedback}}$，单位为 $\\mathrm{J\\,m^{-2}}$。这是通过将平均功率密度（通量）乘以季节的总持续时间得到的。这个季节有 $N$ 天，每天的持续时间为 $dt = 86400 \\, \\mathrm{s}$。总持续时间为 $T = N \\times dt$。\n$$E_{\\text{feedback}} = \\overline{\\Delta R_{n, \\text{feedback}}} \\times T = (\\overline{\\alpha}\\,\\overline{S_{in}} - \\overline{\\alpha(t) S_{in}(t)}) \\times N \\times dt$$\n将实现这两个表达式以解决给定测试用例的问题。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the contribution of snow albedo feedback to the seasonal energy balance\n    for a suite of test cases.\n    \"\"\"\n\n    dt = 86400.0  # seconds in a day\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, S_in_function, alpha_function)\n    test_cases = [\n        (\n            90,\n            lambda t, N: 250.0 + 150.0 * np.sin(2 * np.pi * t / N),\n            lambda t, N: 0.80 - 0.40 * t / (N - 1)\n        ),\n        (\n            120,\n            lambda t, N: 300.0 + 100.0 * np.sin(2 * np.pi * t / N),\n            lambda t, N: 0.50 + 0.0 * t # Constant albedo\n        ),\n        (\n            60,\n            lambda t, N: 0.0 + 0.0 * t, # Zero insolation\n            lambda t, N: 0.70 - 0.10 * np.sin(2 * np.pi * t / N)\n        ),\n        (\n            90,\n            lambda t, N: 220.0 + 180.0 * np.sin(2 * np.pi * t / N),\n            lambda t, N: 0.30 + 0.50 * t / (N - 1)\n        )\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, S_in_func, alpha_func = case\n\n        # Create the time array for the season, from day 0 to N-1\n        t = np.arange(N)\n\n        # Generate the time series for insolation and albedo\n        # Handle N=1 case to avoid division by zero in N-1\n        if N == 1:\n            # For a single day, the linear term factor is 0\n            t_scaled = 0.0\n            S_in = S_in_func(t_scaled, N)\n            alpha = alpha_func(t_scaled, N)\n        else:\n            S_in = S_in_func(t, N)\n            alpha = alpha_func(t, N)\n\n        # Calculate the seasonal means\n        mean_S_in = np.mean(S_in)\n        mean_alpha = np.mean(alpha)\n\n        # Calculate the mean of the product of the time series\n        mean_product_S_alpha = np.mean(S_in * alpha)\n\n        # 1. Calculate the seasonal-mean contribution of the albedo feedback (in W/m^2)\n        # This is the term representing the effect of the co-variability.\n        # It is calculated as (mean_alpha * mean_S_in) - mean(alpha * S_in)\n        mean_contribution_W_m2 = mean_alpha * mean_S_in - mean_product_S_alpha\n\n        # 2. Calculate the seasonally integrated energy contribution (in J/m^2)\n        # This is the mean power density contribution multiplied by the total duration of the season.\n        total_seconds = N * dt\n        integrated_energy_J_m2 = mean_contribution_W_m2 * total_seconds\n        \n        results.append([mean_contribution_W_m2, integrated_energy_J_m2])\n\n    # Format the final output string as a list of lists of floats\n    list_of_strings = [f\"[{r[0]},{r[1]}]\" for r in results]\n    final_string = f\"[{','.join(list_of_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_string)\n\nsolve()\n```"
        }
    ]
}