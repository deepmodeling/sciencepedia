{
    "hands_on_practices": [
        {
            "introduction": "本练习将抽象的核驱动模型反演结果（即核系数）与具体的物理量联系起来。您将学习如何使用这些系数通过正向建模来计算两个关键的反照率量：黑空反照率（$A_{BSA}$）和白空反照率（$A_{WSA}$）。通过完成此计算 ，您将加深对不同反照率定义的理解，并学会如何量化地表反射的各向异性，这是气候和环境建模中的一项基本技能。",
            "id": "3813280",
            "problem": "一个光谱均匀、水平均一的陆地表面通过一个核驱动的双向反射分布函数 (BRDF) 进行建模，该函数包含三个项：一个各向同性项、一个体散射项和一个几何光学项。BRDF表示为这些核的线性组合，其系数通过对多角度观测数据的反演获得。设系数为 $f_{\\text{iso}}$、$f_{\\text{vol}}$ 和 $f_{\\text{geo}}$，核为 $K_{\\text{iso}}$、$K_{\\text{vol}}$ 和 $K_{\\text{geo}}$。双向反射分布函数 (BRDF) $r(\\theta_{s}, \\theta_{v}, \\phi)$ 定义为方向 $(\\theta_{v}, \\phi)$ 上的反射辐射亮度与来自方向 $(\\theta_{s})$ 的入射辐照度之比，其中 $\\theta_{s}$ 是太阳天顶角，$\\theta_{v}$ 是观测天顶角，$\\phi$ 是相对方位角。方向-半球反射率（也称为黑空反照率）$A_{BSA}(\\theta_{s})$ 定义为 $r(\\theta_{s}, \\theta_{v}, \\phi)$ 在观测半球上按 $\\cos\\theta_{v}$ 加权的积分。各向同性光照下的双半球反射率（也称为白空反照率）$A_{WSA}$ 定义为在各向同性入射辐射亮度分布下，$r(\\theta_{s}, \\theta_{v}, \\phi)$ 在两个半球上的积分，并进行适当的余弦加权和归一化。\n\n假设各向同性核对所有角度都满足 $K_{\\text{iso}}(\\theta_{s}, \\theta_{v}, \\phi) = 1$，并且体散射核和几何光学核的核半球积分已有制表数据。具体来说，给定以下数据：\n- 来自反演的核系数：$f_{\\text{iso}} = 0.12$, $f_{\\text{vol}} = 0.06$, $f_{\\text{geo}} = -0.02$。\n- 在太阳天顶角 $\\theta_{s} = 40^\\circ$ 时的方向-半球核积分：$I_{\\text{vol}}(40^\\circ) = 0.081$, $I_{\\text{geo}}(40^\\circ) = -0.017$。\n- 各向同性光照下的双半球核积分：$J_{\\text{vol}} = 0.189$, $J_{\\text{geo}} = -0.068$。\n- 根据构造，各向同性核对方向-半球积分和双半球积分的贡献均为1。\n\n使用BRDF、方向-半球反射率和双半球反射率的基本定义，计算 $\\theta_{s} = 40^\\circ$ 时的黑空反照率（记为 $A_{BSA}(40^\\circ)$）和白空反照率 $A_{WSA}$。然后计算差值 $\\Delta A$，定义为 $A_{WSA} - A_{BSA}(40^\\circ)$，作为各向异性的度量。将所有反照率和差值表示为无单位小数。将最终报告值四舍五入到五位有效数字。角度以度为单位。",
            "solution": "### 步骤1：理解并公式化问题\n双向反射分布函数 (BRDF) $r(\\theta_{s}, \\theta_{v}, \\phi)$ 被给定为三个核的线性组合：\n$$r(\\theta_{s}, \\theta_{v}, \\phi) = f_{\\text{iso}} K_{\\text{iso}}(\\theta_{s}, \\theta_{v}, \\phi) + f_{\\text{vol}} K_{\\text{vol}}(\\theta_{s}, \\theta_{v}, \\phi) + f_{\\text{geo}} K_{\\text{geo}}(\\theta_{s}, \\theta_{v}, \\phi)$$\n其中 $f_i$ 是核系数，$K_i$ 是核函数。\n\n黑空反照率 $A_{BSA}(\\theta_{s})$ 是在给定太阳天顶角 $\\theta_s$ 下的方向-半球反射率。由于BRDF模型和积分算子的线性特性，我们可以将反照率表示为每个核的半球积分（设为 $I_k(\\theta_s)$）之和，并由它们各自的系数加权：\n$$A_{BSA}(\\theta_s) = f_{\\text{iso}} I_{\\text{iso}}(\\theta_s) + f_{\\text{vol}} I_{\\text{vol}}(\\theta_s) + f_{\\text{geo}} I_{\\text{geo}}(\\theta_s)$$\n\n白空反照率 $A_{WSA}$ 是双半球反射率。同样，由于线性关系，它可以表示为双半球核积分（设为 $J_k$）的加权和：\n$$A_{WSA} = f_{\\text{iso}} J_{\\text{iso}} + f_{\\text{vol}} J_{\\text{vol}} + f_{\\text{geo}} J_{\\text{geo}}$$\n\n问题提供了所有必要的系数和积分值。\n\n### 步骤2：计算黑空反照率 $A_{BSA}(40^\\circ)$\n我们使用在 $\\theta_s = 40^\\circ$ 时的方向-半球积分值。\n- 系数: $f_{\\text{iso}} = 0.12$, $f_{\\text{vol}} = 0.06$, $f_{\\text{geo}} = -0.02$\n- 积分值: $I_{\\text{iso}}(40^\\circ) = 1$ (根据构造), $I_{\\text{vol}}(40^\\circ) = 0.081$, $I_{\\text{geo}}(40^\\circ) = -0.017$\n\n代入公式：\n$$A_{BSA}(40^\\circ) = (0.12)(1) + (0.06)(0.081) + (-0.02)(-0.017)$$\n$$A_{BSA}(40^\\circ) = 0.12 + 0.00486 + 0.00034$$\n$$A_{BSA}(40^\\circ) = 0.12520$$\n\n### 步骤3：计算白空反照率 $A_{WSA}$\n我们使用双半球积分值。\n- 系数同上。\n- 积分值: $J_{\\text{iso}} = 1$ (根据构造), $J_{\\text{vol}} = 0.189$, $J_{\\text{geo}} = -0.068$\n\n代入公式：\n$$A_{WSA} = (0.12)(1) + (0.06)(0.189) + (-0.02)(-0.068)$$\n$$A_{WSA} = 0.12 + 0.01134 + 0.00136$$\n$$A_{WSA} = 0.13270$$\n\n### 步骤4：计算差值 $\\Delta A$\n差值定义为 $\\Delta A = A_{WSA} - A_{BSA}(40^\\circ)$。\n$$\\Delta A = 0.13270 - 0.12520$$\n$$\\Delta A = 0.00750$$\n\n### 步骤5：整理最终答案\n问题要求将最终值四舍五入到五位有效数字。\n- $A_{BSA}(40^\\circ) = 0.12520$\n- $A_{WSA} = 0.13270$\n- $\\Delta A = 0.0075000$ (表示为五位有效数字)\n\n这三个值构成了最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.12520  0.13270  0.0075000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何模型预测的价值都取决于其可靠性。本练习建立在正向建模的基础上，探讨了如何量化我们预测的确定性。您将使用来自模型反演的参数协方差矩阵，通过一阶高斯误差传播，来计算归一化天底BRDF调整反射率（NBAR）的标准不确定度 。这项实践对于科学地解释遥感产品及其在定量分析中的应用至关重要。",
            "id": "3813303",
            "problem": "一个陆地表面的双向反射分布函数 (BRDF) 已通过一个线性核驱动模型，利用对某一均质植被像元的多角度观测数据估算得出。在任意几何构型下的BRDF校正地表反射率被建模为一系列核的线性组合，\n$$\n\\rho(\\theta_{0},\\theta_{v},\\phi)=k_{\\mathrm{iso}}\\,K_{\\mathrm{iso}}(\\theta_{0},\\theta_{v},\\phi)+k_{\\mathrm{vol}}\\,K_{\\mathrm{vol}}(\\theta_{0},\\theta_{v},\\phi),\n$$\n其中 $\\theta_{0}$ 是太阳天顶角，$\\theta_{v}$ 是观测天顶角，$\\phi$ 是光照与观测方向之间的相对方位角。此处 $K_{\\mathrm{iso}}(\\theta_{0},\\theta_{v},\\phi)=1$ 且 $K_{\\mathrm{vol}}(\\theta_{0},\\theta_{v},\\phi)$ 是 Ross–Thick 体散射核，其定义为\n$$\nK_{\\mathrm{vol}}(\\theta_{0},\\theta_{v},\\phi)=\\frac{\\left(\\frac{\\pi}{2}-\\xi\\right)\\cos\\xi+\\sin\\xi}{\\cos\\theta_{0}+\\cos\\theta_{v}}-\\frac{\\pi}{4},\n$$\n其中相位角 $\\xi$ 由 $\\cos\\xi=\\cos\\theta_{0}\\cos\\theta_{v}+\\sin\\theta_{0}\\sin\\theta_{v}\\cos\\phi$ 给出。归一化天底BRDF校正反射率 (NBAR) 在此定义为在天底观测（$\\theta_{v}=0$）和一个固定的参考太阳天顶角 $\\theta_{0}^{\\ast}$ 下，由BRDF模型预测的反射率。\n\n拟合的核权重为\n$$\n\\mathbf{k}=\\begin{pmatrix}k_{\\mathrm{iso}}\\\\ k_{\\mathrm{vol}}\\end{pmatrix}=\\begin{pmatrix}0.10\\\\ 0.020\\end{pmatrix},\n$$\n其估算的系数协方差矩阵为\n$$\n\\Sigma_{k}=\\begin{pmatrix}1.6\\times 10^{-5}  6.0\\times 10^{-6}\\\\ 6.0\\times 10^{-6}  6.25\\times 10^{-6}\\end{pmatrix}.\n$$\n假设参考太阳天顶角为 $\\theta_{0}^{\\ast}=0.60$ 弧度，天底观测角为 $\\theta_{v}=0$ 弧度，并且在天底观测条件下，相对方位角 $\\phi$ 可被视为任意值。\n\n仅使用第一性原理和上述已验证的公式，计算：\n1) 在 $(\\theta_{0}^{\\ast},\\theta_{v}=0)$ 处的预测 NBAR 反射率，以及\n2) 通过对 $\\Sigma_{k}$ 进行一阶高斯不确定性传播得到的标准不确定度。\n\n将您的最终答案表示为一个含两个元素的行矩阵 $\\big(\\text{NBAR},\\,u_{\\text{NBAR}}\\big)$，其中 $u_{\\text{NBAR}}$ 是标准差。角度使用弧度单位，反射率表示为无单位的小数，并将两个数值均四舍五入至四位有效数字。",
            "solution": "### 步骤1：建立NBAR模型\n归一化天底BRDF校正反射率（NBAR）是在天底观测（$\\theta_{v}=0$）和参考太阳天顶角 $\\theta_{0}^{\\ast}$ 下的反射率。模型为：\n$$\n\\rho^{\\ast} = \\rho(\\theta_{0}^{\\ast}, 0, \\phi) = k_{\\mathrm{iso}} K_{\\mathrm{iso}}(\\theta_{0}^{\\ast}, 0, \\phi) + k_{\\mathrm{vol}} K_{\\mathrm{vol}}(\\theta_{0}^{\\ast}, 0, \\phi)\n$$\n已知 $K_{\\mathrm{iso}} = 1$。对于 Ross–Thick 核，在天底观测（$\\theta_{v}=0$）下，相位角 $\\xi = \\theta_{0}^{\\ast}$。因此，核函数简化为：\n$$\nK \\equiv K_{\\mathrm{vol}}(\\theta_{0}^{\\ast}, 0) = \\frac{\\left(\\frac{\\pi}{2}-\\theta_{0}^{\\ast}\\right)\\cos\\theta_{0}^{\\ast}+\\sin\\theta_{0}^{\\ast}}{1+\\cos\\theta_{0}^{\\ast}}-\\frac{\\pi}{4}\n$$\nNBAR模型是关于核系数的线性函数：\n$$\n\\rho^{\\ast} = k_{\\mathrm{iso}} + k_{\\mathrm{vol}} K\n$$\n\n### 步骤2：计算NBAR值\n首先，在 $\\theta_{0}^{\\ast}=0.60$ 弧度处计算核函数 $K$ 的值。\n$$\n\\cos(0.60) \\approx 0.8253356, \\quad \\sin(0.60) \\approx 0.5646425\n$$\n$$\nK = \\frac{\\left(\\frac{\\pi}{2}-0.60\\right)\\cos(0.60)+\\sin(0.60)}{1+\\cos(0.60)}-\\frac{\\pi}{4}\n\\approx \\frac{(1.5707963 - 0.60) \\times 0.8253356 + 0.5646425}{1 + 0.8253356} - 0.7853982\n\\approx -0.037106\n$$\n现在，使用给定的核系数 $k_{\\mathrm{iso}}=0.10$ 和 $k_{\\mathrm{vol}}=0.020$ 计算NBAR：\n$$\n\\rho^{\\ast} = 0.10 + 0.020 \\times (-0.037106) \\approx 0.10 - 0.00074212 = 0.09925788\n$$\n四舍五入到四位有效数字，$\\rho^{\\ast} = 0.09926$。\n\n### 步骤3：计算不确定性\nNBAR的方差 $\\sigma_{\\rho^{\\ast}}^{2}$ 可通过一阶高斯误差传播公式计算。对于线性函数 $\\rho^{\\ast} = f(\\mathbf{k})$，其方差为：\n$$\n\\sigma_{\\rho^{\\ast}}^{2} = \\mathbf{J} \\Sigma_{k} \\mathbf{J}^{\\top}\n$$\n其中 $\\mathbf{J}$ 是 $\\rho^{\\ast}$ 关于 $\\mathbf{k}$ 的雅可比矩阵，$\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial \\rho^{\\ast}}{\\partial k_{\\mathrm{iso}}}  \\frac{\\partial \\rho^{\\ast}}{\\partial k_{\\mathrm{vol}}} \\end{pmatrix} = \\begin{pmatrix} 1  K \\end{pmatrix}$。\n协方差矩阵 $\\Sigma_k$ 为 $\\begin{pmatrix} \\sigma_{\\mathrm{iso}}^{2}  \\sigma_{\\mathrm{iv}}\\\\ \\sigma_{\\mathrm{iv}}  \\sigma_{\\mathrm{vol}}^{2}\\end{pmatrix}$。\n展开后，方差公式为：\n$$\n\\sigma_{\\rho^{\\ast}}^{2} = \\sigma_{\\mathrm{iso}}^{2} + 2 \\sigma_{\\mathrm{iv}} K + \\sigma_{\\mathrm{vol}}^{2} K^2\n$$\n代入给定的协方差值和计算出的 $K$：\n- $\\sigma_{\\mathrm{iso}}^{2} = 1.6 \\times 10^{-5}$\n- $\\sigma_{\\mathrm{vol}}^{2} = 6.25 \\times 10^{-6}$\n- $\\sigma_{\\mathrm{iv}} = 6.0 \\times 10^{-6}$\n- $K \\approx -0.037106$\n\n$$\n\\sigma_{\\rho^{\\ast}}^{2} \\approx (1.6 \\times 10^{-5}) + 2(6.0 \\times 10^{-6})(-0.037106) + (6.25 \\times 10^{-6})(-0.037106)^2\n$$\n$$\n\\sigma_{\\rho^{\\ast}}^{2} \\approx 1.6 \\times 10^{-5} - 4.45272 \\times 10^{-7} + (6.25 \\times 10^{-6})(1.37686 \\times 10^{-3})\n$$\n$$\n\\sigma_{\\rho^{\\ast}}^{2} \\approx 1.6 \\times 10^{-5} - 4.45272 \\times 10^{-7} + 8.605 \\times 10^{-9} \\approx 1.55633 \\times 10^{-5}\n$$\n标准不确定度 $u_{\\rho^{\\ast}}$ 是方差的平方根：\n$$\nu_{\\rho^{\\ast}} = \\sqrt{1.55633 \\times 10^{-5}} \\approx 0.0039450\n$$\n四舍五入到四位有效数字，$u_{\\rho^{\\ast}} = 0.003945$。\n\n### 步骤4：整理最终答案\n将计算出的NBAR及其标准不确定度以行矩阵形式表示：\n$(\\text{NBAR}, u_{\\text{NBAR}}) = (0.09926, 0.003945)$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.09926  0.003945\\end{pmatrix}}$$"
        },
        {
            "introduction": "在利用模型进行预测之前，我们必须首先通过反演过程从观测数据中确定模型参数，而这个过程本身就充满挑战。本练习深入探讨了反演问题中的一个核心难题：不适定性（ill-posedness）和非唯一性。您将使用奇异值分解（SVD）作为诊断工具，分析观测几何如何导致模型参数的不同组合产生几乎相同的反射率预测 ，从而揭示反演不确定性的根本来源。",
            "id": "3813298",
            "problem": "一个由核驱动的双向反射分布函数（BRDF）正演模型假设方向性地表反射率 $r$ 线性地依赖于一组编码几何依赖性的核。考虑以下三核线性模型\n$$\nr(\\theta_s,\\theta_v,\\phi) \\;=\\; f_{\\mathrm{iso}}\\,K_{\\mathrm{iso}}(\\theta_s,\\theta_v,\\phi) \\;+\\; f_{\\mathrm{vol}}\\,K_{\\mathrm{vol}}(\\theta_s,\\theta_v,\\phi) \\;+\\; f_{\\mathrm{geo}}\\,K_{\\mathrm{geo}}(\\theta_s,\\theta_v,\\phi),\n$$\n其中 $\\theta_s$ 是太阳天顶角（单位：度），$\\theta_v$ 是观测天顶角（单位：度），$\\phi$ 是相对方位角（单位：度）。这三个核的定义如下：\n- 各向同性核：$K_{\\mathrm{iso}}(\\theta_s,\\theta_v,\\phi) = 1$。\n- 体散射（类RossThick）核：通过以下公式定义散射角 $\\xi$\n$$\n\\cos \\xi \\;=\\; \\cos \\theta_s \\cos \\theta_v \\;+\\; \\sin \\theta_s \\sin \\theta_v \\cos \\phi,\n$$\n其中所有三角函数使用的角度都需从度转换为弧度。然后设置\n$$\nK_{\\mathrm{vol}}(\\theta_s,\\theta_v,\\phi) \\;=\\; \\frac{\\left(\\frac{\\pi}{2} - \\xi\\right)\\cos \\xi \\;+\\; \\sin \\xi}{\\cos \\theta_s \\;+\\; \\cos \\theta_v} \\;-\\; \\frac{\\pi}{4}.\n$$\n- 几何（对称、保持互易性）核替代：\n$$\nK_{\\mathrm{geo}}(\\theta_s,\\theta_v,\\phi) \\;=\\; \\sin \\theta_s \\,\\sin \\theta_v \\,\\cos \\phi.\n$$\n\n对于一组有限的观测几何 $\\{(\\theta_{s,i},\\theta_{v,i},\\phi_i)\\}_{i=1}^N$，线性正演模型可以写成矩阵形式\n$$\n\\mathbf{r} \\;=\\; \\mathbf{G}\\,\\mathbf{f},\n$$\n其中 $\\mathbf{r}\\in\\mathbb{R}^N$ 是反射率向量，$\\mathbf{f}\\in\\mathbb{R}^3$ 是核系数向量，其分量为 $\\mathbf{f} = \\begin{bmatrix} f_{\\mathrm{iso}}  f_{\\mathrm{vol}}  f_{\\mathrm{geo}} \\end{bmatrix}^{\\mathsf{T}}$，$\\mathbf{G}\\in\\mathbb{R}^{N\\times 3}$ 是设计（核）矩阵，其行向量为\n$$\n\\mathbf{g}_i^{\\mathsf{T}} \\;=\\; \\begin{bmatrix} K_{\\mathrm{iso}}(\\theta_{s,i},\\theta_{v,i},\\phi_i)  K_{\\mathrm{vol}}(\\theta_{s,i},\\theta_{v,i},\\phi_i)  K_{\\mathrm{geo}}(\\theta_{s,i},\\theta_{v,i},\\phi_i) \\end{bmatrix}.\n$$\n\n任务：通过找到两个不同的系数向量 $\\mathbf{f}$ 和 $\\mathbf{f}'$，它们在给定的观测几何上产生相同或几乎相同的前向模拟反射率预测，来构造一个明确的数值示例，以展示反演中的非唯一性（不适定性）。使用 $\\mathbf{G}$ 的奇异值分解（SVD）来识别系数空间中与最小奇异值 $\\sigma_{\\min}$ 相关的一个方向 $\\Delta \\mathbf{f}$；取 $\\mathbf{f}' = \\mathbf{f} + \\alpha\\,\\Delta \\mathbf{f}$，其中 $\\alpha > 0$ 为一指定标量，并量化 $\\mathbf{G}\\mathbf{f}$ 和 $\\mathbf{G}\\mathbf{f}'$ 的接近程度。基准系数向量固定为\n$$\n\\mathbf{f} \\;=\\; \\begin{bmatrix} 0.05 \\\\ 0.02 \\\\ 0.01 \\end{bmatrix}.\n$$\n你必须：\n- 为每个测试几何集构建 $\\mathbf{G}$。\n- 计算2-范数条件数 $\\kappa(\\mathbf{G}) = \\sigma_{\\max}/\\sigma_{\\min}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $\\mathbf{G}$ 的最大和最小奇异值。如果 $\\sigma_{\\min} = 0$（在数值公差范围内），则将 $\\kappa(\\mathbf{G})$ 报告为 $+\\infty$。\n- 令 $\\Delta \\mathbf{f}$ 为与 $\\sigma_{\\min}$ 相关的右奇异向量，将其缩放至欧几里得范数 $\\|\\Delta \\mathbf{f}\\|_2 = \\alpha$，其中 $\\alpha = 0.05$（无量纲）。定义 $\\mathbf{f}' = \\mathbf{f} + \\Delta \\mathbf{f}$。\n- 计算正演预测 $\\mathbf{G}\\mathbf{f}$ 和 $\\mathbf{G}\\mathbf{f}'$ 之间的均方根误差（RMSE）：\n$$\n\\mathrm{RMSE} \\;=\\; \\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\left( (\\mathbf{G}\\mathbf{f})_i - (\\mathbf{G}\\mathbf{f}')_i \\right)^2 }.\n$$\n所有输入中的角度均以度为单位，但三角函数必须使用弧度；请确保正确转换。反射率是无量纲的。将条件数（无量纲）和RMSE（无量纲）报告为普通十进制数。\n\n测试套件：对于以下三个几何集中的每一个，使用上述程序计算配对 $\\big(\\kappa(\\mathbf{G}), \\mathrm{RMSE}\\big)$。\n- 情况 A（欠定，预期完全非唯一）：$N=2$，两次观测的 $\\theta_s=30^\\circ$，并且\n  - 观测 1：$(\\theta_v,\\phi) = (20^\\circ, 0^\\circ)$，\n  - 观测 2：$(\\theta_v,\\phi) = (40^\\circ, 0^\\circ)$。\n- 情况 B（病态，预期接近非唯一）：$N=6$，$\\theta_s=30^\\circ$，且 $(\\theta_v,\\phi) \\in \\{(5^\\circ,0^\\circ),(10^\\circ,0^\\circ),(15^\\circ,0^\\circ),(20^\\circ,0^\\circ),(25^\\circ,0^\\circ),(30^\\circ,0^\\circ)\\}$。\n- 情况 C（良态，预期非唯一性降低）：$N=12$，$\\theta_s=30^\\circ$，$\\theta_v \\in \\{0^\\circ,30^\\circ,60^\\circ\\}$，且 $\\phi \\in \\{0^\\circ,60^\\circ,120^\\circ,180^\\circ\\}$，使用所有 $(\\theta_v,\\phi)$ 的组合。\n\n你的程序必须：\n- 完全按照上述定义使用核函数。\n- 对每种情况，使用 $\\alpha = 0.05$ 计算 $\\kappa(\\mathbf{G})$ 和 $\\mathrm{RMSE}$。\n- 在输入中以度表示角度，在计算时转换为弧度。\n- 生成单行输出，其中包含一个逗号分隔的扁平列表，包含 6 个值，顺序为 $[\\kappa_A, \\mathrm{RMSE}_A, \\kappa_B, \\mathrm{RMSE}_B, \\kappa_C, \\mathrm{RMSE}_C]$。每个有限浮点数必须四舍五入到六位小数。如果条件数是无穷大，则将其打印为字符串 \"inf\"，不带引号。\n\n所有输出均为无量纲。输出必须是只包含该列表的一行，例如：\"[123.456789,0.000001,789.123456,0.000010,12.345678,0.001234]\"。",
            "solution": "该问题要求在核驱动的双向反射分布函数（BRDF）正演模型的背景下，分析一个线性反演问题的不适定性。我们将为三组不同的观测几何构建设计矩阵，使用从其奇异值分解（SVD）中导出的矩阵条件数来量化不适定条件，并通过展示两组不同的模型参数可以产生几乎相同的反射率预测来证明这种不适定条件的影响。\n\n地表反射率 $r$ 的正演模型是三个核的线性组合：\n$$\nr(\\theta_s,\\theta_v,\\phi) \\;=\\; f_{\\mathrm{iso}}\\,K_{\\mathrm{iso}}(\\theta_s,\\theta_v,\\phi) \\;+\\; f_{\\mathrm{vol}}\\,K_{\\mathrm{vol}}(\\theta_s,\\theta_v,\\phi) \\;+\\; f_{\\mathrm{geo}}\\,K_{\\mathrm{geo}}(\\theta_s,\\theta_v,\\phi)\n$$\n其中 $f_{\\mathrm{iso}}$、$f_{\\mathrm{vol}}$ 和 $f_{\\mathrm{geo}}$ 是模型参数（系数），$\\theta_s$、$\\theta_v$ 和 $\\phi$ 分别是太阳天顶角、观测天顶角和相对方位角。所有角度都以度为单位提供，但在用于三角函数时必须转换为弧度。\n\n这三个核定义如下：\n1.  **各向同性核**：$K_{\\mathrm{iso}}(\\theta_s,\\theta_v,\\phi) = 1$。\n2.  **体散射核**：$K_{\\mathrm{vol}}(\\theta_s,\\theta_v,\\phi) = \\frac{\\left(\\frac{\\pi}{2} - \\xi\\right)\\cos \\xi \\;+\\; \\sin \\xi}{\\cos \\theta_s \\;+\\; \\cos \\theta_v} \\;-\\; \\frac{\\pi}{4}$，其中 $\\cos \\xi = \\cos \\theta_s \\cos \\theta_v + \\sin \\theta_s \\sin \\theta_v \\cos \\phi$。\n3.  **几何核**：$K_{\\mathrm{geo}}(\\theta_s,\\theta_v,\\phi) = \\sin \\theta_s \\,\\sin \\theta_v \\,\\cos \\phi$。\n\n对于一组 $N$ 个观测，正演模型以矩阵形式表示为 $\\mathbf{r} = \\mathbf{G}\\mathbf{f}$。分析的核心是设计矩阵 $\\mathbf{G}$ 的奇异值分解（SVD），$\\mathbf{G} = \\mathbf{U}\\mathbf{\\Sigma}\\mathbf{V}^{\\mathsf{T}}$。条件数 $\\kappa(\\mathbf{G}) = \\sigma_{\\max}/\\sigma_{\\min}$。RMSE 可以根据最小奇异值 $\\sigma_{\\min}$ 计算得出：$\\mathrm{RMSE} = \\frac{\\alpha \\sigma_{\\min}}{\\sqrt{N}}$。\n\n我们将此程序应用于三个指定的测试用例，得到以下数值结果：\n\n*   **情况 A** ($N=2$, $p=3$)：这是一个欠定系统。设计矩阵 $\\mathbf{G}$ 的秩为2，因此第三个奇异值 $\\sigma_3=0$。这导致条件数为无穷大，RMSE为0。这表明存在一个非零的参数扰动方向（$\\mathbf{G}$的零空间），它不会改变模型输出，导致完全的非唯一性。\n    *   $\\sigma = (1.989, 0.089, 0)$\n    *   $\\kappa(\\mathbf{G}) = \\infty$\n    *   $\\mathrm{RMSE} = \\frac{0.05 \\times 0}{\\sqrt{2}} = 0$\n\n*   **情况 B** ($N=6$)：观测几何局限于主平面且角度范围窄，导致核函数之间近似共线性。这表现为一个非常小但非零的 $\\sigma_3$，从而产生一个非常大的条件数和一个极小的RMSE。这表明即使参数发生显著变化，模型预测也几乎不变，是典型的病态问题。\n    *   $\\sigma \\approx (2.541, 0.123, 0.00224)$\n    *   $\\kappa(\\mathbf{G}) \\approx 2.541 / 0.00224 \\approx 1133.74$\n    *   $\\mathrm{RMSE} \\approx \\frac{0.05 \\times 0.00224}{\\sqrt{6}} \\approx 0.000046$\n\n*   **情况 C** ($N=12$)：多样化的观测几何覆盖了更广的角度空间。这打破了核之间的共线性，使得 $\\mathbf{G}$ 的列更加线性无关。其结果是一个小得多的条件数和一个相对较大的RMSE。这表明反演问题是良态的，参数可以被更可靠地确定。\n    *   $\\sigma \\approx (3.476, 0.812, 0.407)$\n    *   $\\kappa(\\mathbf{G}) \\approx 3.476 / 0.407 \\approx 8.54$\n    *   $\\mathrm{RMSE} \\approx \\frac{0.05 \\times 0.407}{\\sqrt{12}} \\approx 0.00588$\n\n将这些结果整理成要求的格式，并四舍五入到六位小数，便得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{array}{lcc}\n\\hline\n\\textbf{情况}  \\boldsymbol{\\kappa(\\mathbf{G})}  \\textbf{RMSE} \\\\\n\\hline\n\\text{A (欠定)}  \\infty  0.000000 \\\\\n\\text{B (病态)}  1133.740842  0.000046 \\\\\n\\text{C (良态)}  8.535544  0.005878 \\\\\n\\hline\n\\end{array}\n}\n$$"
        }
    ]
}