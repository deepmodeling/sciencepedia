{
    "hands_on_practices": [
        {
            "introduction": "普通克里金法是地质统计学的核心工具，尤其适用于空间场的均值未知但假定为常数的情况，这在实际应用中非常普遍。本练习将引导你从第一性原理出发，推导普通克里金方程组，并将其应用于一个实际的环境监测场景，从而掌握在未采样点进行最优线性无偏估计的核心技能 。",
            "id": "3817477",
            "problem": "一项遥感监测活动监测一个 $100\\,\\mathrm{m} \\times 100\\,\\mathrm{m}$ 城市街区内的细颗粒物浓度，该浓度由随机函数 $Z(\\mathbf{s})$ 表示，单位为 $\\mathrm{mg\\,m^{-3}}$。假设该过程满足内蕴平稳性，具有未知的常数局部均值，以及带有块金效应的各向同性指数半变异函数，其表达式为\n$$\n\\gamma(h) \\;=\\; c_{0} \\;+\\; c \\left(1 - \\exp\\!\\left(-\\frac{h}{a}\\right)\\right),\n$$\n其中 $c_{0} = 0.2\\,\\mathrm{(mg\\,m^{-3})^{2}}$，$c = 1.0\\,\\mathrm{(mg\\,m^{-3})^{2}}$，以及 $a = 50\\,\\mathrm{m}$。现有三个具有精确地理定位的原位参考测量值：\n- $Z(\\mathbf{s}_{1}) = 12\\,\\mathrm{mg\\,m^{-3}}$，位于 $\\mathbf{s}_{1} = (0, 50)\\,\\mathrm{m}$ 处，\n- $Z(\\mathbf{s}_{2}) = 10\\,\\mathrm{mg\\,m^{-3}}$，位于 $\\mathbf{s}_{2} = (50, 0)\\,\\mathrm{m}$ 处，\n- $Z(\\mathbf{s}_{3}) = 15\\,\\mathrm{mg\\,m^{-3}}$，位于 $\\mathbf{s}_{3} = (50, 50)\\,\\mathrm{m}$ 处。\n\n你需要使用普通克里金法来估算目标位置 $\\mathbf{s}_{0} = (0, 0)\\,\\mathrm{m}$ 处的浓度。从内蕴平稳过程的半变异函数定义\n$$\n\\gamma(\\mathbf{h}) \\;=\\; \\frac{1}{2}\\,\\mathbb{E}\\!\\left[\\big(Z(\\mathbf{s}+\\mathbf{h}) - Z(\\mathbf{s})\\big)^{2}\\right],\n$$\n出发，并结合具有未知常数均值的普通克里金法的无偏性条件，推导出使估算方差最小化的普通克里金权重，并计算普通克里金估算值 $\\hat{Z}(\\mathbf{s}_{0})$。根据定义，始终将 $\\gamma(0)$ 视为 $0$。最终估算值以 $\\mathrm{mg\\,m^{-3}}$ 为单位表示，并将你的答案四舍五入到四位有效数字。",
            "solution": "我们将 $Z(\\mathbf{s})$ 建模为一个内蕴平稳随机函数，其局部均值 $m$ 为未知的常数，半变异函数 $\\gamma(h)$ 如题所述。在 $\\mathbf{s}_{0}$ 处的普通克里金估算量为\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;=\\; \\sum_{i=1}^{n} w_{i}\\, Z(\\mathbf{s}_{i}),\n$$\n其中 $n = 3$，权重 $\\{w_{i}\\}$ 的选择需满足无偏性并使估算方差最小化。对于普通克里金法，在均值为未知常数的情况下，无偏性要求\n$$\n\\sum_{i=1}^{n} w_{i} \\;=\\; 1.\n$$\n内蕴平稳过程的估算方差可以用半变异函数表示为\n$$\n\\sigma^{2}_{\\mathrm{OK}}(\\mathbf{s}_{0}) \\;=\\; \\mathrm{Var}\\!\\left(\\hat{Z}(\\mathbf{s}_{0}) - Z(\\mathbf{s}_{0})\\right)\n\\;=\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{i} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{j}\\|\\right)\n- 2 \\sum_{i=1}^{n} w_{i}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{0}\\|\\right).\n$$\n为了在最小化 $\\sigma^{2}_{\\mathrm{OK}}(\\mathbf{s}_{0})$ 的同时施加无偏性约束，我们构建拉格朗日函数\n$$\n\\mathcal{L}(\\mathbf{w}, \\mu) \\;=\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{i} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{j}\\|\\right)\n- 2 \\sum_{i=1}^{n} w_{i}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{0}\\|\\right)\n+ 2\\mu \\left(\\sum_{i=1}^{n} w_{i} - 1\\right),\n$$\n并令其关于 $w_{k}$ 的偏导数为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{k}} \\;=\\; 2 \\sum_{j=1}^{n} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{j}\\|\\right)\n- 2\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{0}\\|\\right)\n+ 2\\mu \\;=\\; 0.\n$$\n两边同除以 $2$ 得到半变异函数形式的普通克里金方程组：\n$$\n\\sum_{j=1}^{n} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{j}\\|\\right) + \\mu \\;=\\; \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{0}\\|\\right), \\quad k = 1, \\dots, n,\n$$\n以及约束条件 $\\sum_{i=1}^{n} w_{i} = 1$。由于 $\\gamma(0) = 0$，对角线元素满足 $\\gamma(\\|\\mathbf{s}_{i} - \\mathbf{s}_{i}\\|) = 0$。\n\n我们计算所有需要的距离。目标位置为 $\\mathbf{s}_{0} = (0, 0)\\,\\mathrm{m}$，数据点位置为 $\\mathbf{s}_{1} = (0, 50)\\,\\mathrm{m}$，$\\mathbf{s}_{2} = (50, 0)\\,\\mathrm{m}$，$\\mathbf{s}_{3} = (50, 50)\\,\\mathrm{m}$。两两之间的距离为：\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{0}\\| = \\sqrt{(0-0)^{2} + (50-0)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{2} - \\mathbf{s}_{0}\\| = \\sqrt{(50-0)^{2} + (0-0)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{3} - \\mathbf{s}_{0}\\| = \\sqrt{(50-0)^{2} + (50-0)^{2}} = 50\\sqrt{2}\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{2}\\| = \\sqrt{(0-50)^{2} + (50-0)^{2}} = 50\\sqrt{2}\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{3}\\| = \\sqrt{(0-50)^{2} + (50-50)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbfs}_{2} - \\mathbf{s}_{3}\\| = \\sqrt{(50-50)^{2} + (0-50)^{2}} = 50\\,\\mathrm{m}$。\n\n定义\n$$\n\\gamma_{50} \\;=\\; \\gamma(50) \\;=\\; c_{0} + c\\left(1 - \\exp\\!\\left(-\\frac{50}{a}\\right)\\right)\n\\;=\\; 0.2 + 1.0\\left(1 - \\exp(-1)\\right)\n\\;=\\; 1.2 - \\exp(-1),\n$$\n$$\n\\gamma_{70} \\;=\\; \\gamma(50\\sqrt{2}) \\;=\\; c_{0} + c\\left(1 - \\exp\\!\\left(-\\frac{50\\sqrt{2}}{a}\\right)\\right)\n\\;=\\; 0.2 + 1.0\\left(1 - \\exp(-\\sqrt{2})\\right)\n\\;=\\; 1.2 - \\exp(-\\sqrt{2}).\n$$\n数值上，\n$$\n\\exp(-1) \\approx 0.367879441, \\quad \\exp(-\\sqrt{2}) \\approx 0.243116734,\n$$\n所以\n$$\n\\gamma_{50} \\approx 0.832120559, \\quad \\gamma_{70} \\approx 0.956883266.\n$$\n\n设权重为 $w_{1}, w_{2}, w_{3}$，拉格朗日乘子为 $\\mu$。普通克里金方程组变为\n$$\n\\begin{aligned}\n\\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{2}\\|) w_{2} + \\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{3}\\|) w_{3} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{0}\\|), \\\\\n\\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{1}\\|) w_{1} + \\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{3}\\|) w_{3} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{0}\\|), \\\\\n\\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{1}\\|) w_{1} + \\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{2}\\|) w_{2} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{0}\\|), \\\\\nw_{1} + w_{2} + w_{3} \\;=\\; 1,\n\\end{aligned}\n$$\n代入距离后，方程组为\n$$\n\\begin{aligned}\n\\gamma_{70}\\, w_{2} + \\gamma_{50}\\, w_{3} + \\mu \\;=\\; \\gamma_{50}, \\\\\n\\gamma_{70}\\, w_{1} + \\gamma_{50}\\, w_{3} + \\mu \\;=\\; \\gamma_{50}, \\\\\n\\gamma_{50}\\, w_{1} + \\gamma_{50}\\, w_{2} + \\mu \\;=\\; \\gamma_{70}, \\\\\nw_{1} + w_{2} + w_{3} \\;=\\; 1.\n\\end{aligned}\n$$\n根据几何构型相对于 $\\mathbf{s}_{0}$ 的对称性，我们有 $w_{1} = w_{2} = w$。设 $w_{3} = v$。方程组简化为\n$$\n\\begin{aligned}\n\\gamma_{70}\\, w + \\gamma_{50}\\, v + \\mu \\;=\\; \\gamma_{50}, \\\\\n2\\,\\gamma_{50}\\, w + \\mu \\;=\\; \\gamma_{70}, \\\\\n2w + v \\;=\\; 1.\n\\end{aligned}\n$$\n第一个方程减去第二个方程以消去 $\\mu$：\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50}\\right) w + \\gamma_{50}\\, v \\;=\\; \\gamma_{50} - \\gamma_{70}.\n$$\n使用约束条件 $v = 1 - 2w$，我们得到\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50}\\right) w + \\gamma_{50} (1 - 2w) \\;=\\; \\gamma_{50} - \\gamma_{70},\n$$\n化简后得到\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50} - 2\\gamma_{50}\\right) w + \\gamma_{50} \\;=\\; \\gamma_{50} - \\gamma_{70},\n$$\n$$\n\\left(\\gamma_{70} - 4\\gamma_{50}\\right) w \\;=\\; -\\gamma_{70}.\n$$\n等价地（保留之前聚合的系数），\n$$\n-2.37159897\\, w \\;\\approx\\; -0.956883266 \\quad\\Rightarrow\\quad w \\;\\approx\\; 0.403477.\n$$\n则\n$$\nv \\;=\\; 1 - 2w \\;\\approx\\; 1 - 0.806954 \\;\\approx\\; 0.193046.\n$$\n普通克里金估算值为\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;=\\; w\\, Z(\\mathbf{s}_{1}) + w\\, Z(\\mathbf{s}_{2}) + v\\, Z(\\mathbf{s}_{3})\n\\;=\\; w\\,(12 + 10) + v\\,(15)\n\\;=\\; 22w + 15v.\n$$\n数值上，\n$$\n22w \\;\\approx\\; 22 \\times 0.403477 \\;\\approx\\; 8.876494, \\quad 15v \\;\\approx\\; 15 \\times 0.193046 \\;\\approx\\; 2.895690,\n$$\n所以\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;\\approx\\; 8.876494 + 2.895690 \\;\\approx\\; 11.772184\\,\\mathrm{mg\\,m^{-3}}.\n$$\n四舍五入到四位有效数字并以 $\\mathrm{mg\\,m^{-3}}$ 为单位表示，普通克里金估算值为 $11.77\\,\\mathrm{mg\\,m^{-3}}$。",
            "answer": "$$\\boxed{11.77}$$"
        },
        {
            "introduction": "一个地质统计模型的质量不仅取决于其结构，还取决于对变异来源的深刻理解。本练习将深入探讨块金效应的构成，将其分解为真实的微观尺度空间变异和独立的测量误差，这对于精确评估预测不确定性至关重要 。通过从第一性原理推导，你将学会如何构建和分析更细致的协方差模型，并理解不同变异来源对克里金估计的影响。",
            "id": "3817474",
            "problem": "一个遥感团队正在对沿直线路径的近地表土壤湿度进行一维横断面建模，其位置由空间坐标 $s \\in \\mathbb{R}$ 索引。设潜在的真实土壤湿度场为 $Y(s) = S(s) + M(s)$，其中 $S(s)$ 是一个二阶平稳的结构化分量，其协方差函数为 $C_{S}(h)$，$M(s)$ 是一个空间不相关的微尺度分量（白噪声），其方差为 $\\sigma_{\\mathrm{micro}}^{2}$，且独立于 $S(s)$。仪器返回的观测值为 $Z(s) = Y(s) + \\epsilon(s)$，其中 $\\epsilon(s)$ 是独立的测量误差，其方差为 $\\sigma_{\\epsilon}^{2}$，且独立于 $S(s)$ 和 $M(s)$。假设所有过程的均值为零。\n\n您的任务是使用形式为 $\\hat{Y}(0) = \\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2})$ 的线性估计量来预测在 $s_{0} = 0$ 处的真实场 $Y(s_{0})$，其中 $s_{1} = -0.5$ 和 $s_{2} = +0.5$（单位为千米）。结构化分量具有指数协方差\n$$\nC_{S}(h) = \\sigma_{S}^{2} \\exp\\!\\left(-\\frac{|h|}{\\phi}\\right),\n$$\n其中 $\\sigma_{S}^{2} = 4$ 且 $\\phi = 1$（单位为千米）。微尺度方差为 $\\sigma_{\\mathrm{micro}}^{2} = 1$，测量误差方差为 $\\sigma_{\\epsilon}^{2} = 0.5$。所有协方差参数和距离对于此横断面在物理上都是合理的。\n\n从二阶平稳性、协方差和线性估计量的均方误差的定义出发，并且仅使用这些基本依据（不假设任何预先推导的克里金方程），推导出在给定模型下使 $Y(0)$ 的均方预测误差最小化的最优权重 $(\\lambda_{1}, \\lambda_{2})$。然后，利用您的推导，计算最小化的均方预测误差（在块金效应分解为微尺度变异和测量误差的情况下，$Y(0)$ 的简单克里金方差），并将其表示为封闭形式的解析表达式。将您的最终答案表示为包含 $\\exp(\\cdot)$ 的单个解析表达式，不进行数值舍入，也不带单位（为报告目的，将方差视为无量纲）。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良态性及客观性。\n\n### 步骤 1：提取已知条件\n-   空间域：$s \\in \\mathbb{R}$。\n-   真实场模型：$Y(s) = S(s) + M(s)$。\n-   $S(s)$：二阶平稳结构化分量，均值为零。\n-   $M(s)$：空间不相关的微尺度分量（白噪声），均值为零，方差为 $\\sigma_{\\mathrm{micro}}^{2} = 1$。\n-   观测模型：$Z(s) = Y(s) + \\epsilon(s) = S(s) + M(s) + \\epsilon(s)$。\n-   $\\epsilon(s)$：独立的测量误差，均值为零，方差为 $\\sigma_{\\epsilon}^{2} = 0.5$。\n-   独立性：$S(s)$、$M(s)$ 和 $\\epsilon(s)$ 是相互独立的过程。\n-   $S(s)$ 的协方差：$C_{S}(h) = \\sigma_{S}^{2} \\exp(-|h|/\\phi)$，其中 $\\sigma_{S}^{2} = 4$ 且 $\\phi = 1$。\n-   预测目标：$s_{0} = 0$ 处的 $Y(s_{0})$。\n-   线性估计量：$\\hat{Y}(0) = \\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2})$。\n-   观测位置：$s_{1} = -0.5$ 和 $s_{2} = +0.5$。\n-   目标：找到最优权重 $(\\lambda_{1}, \\lambda_{2})$ 以最小化均方预测误差（MSPE），并计算该最小误差。推导必须从基本定义开始。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了一个用于空间数据的标准地质统计模型，包括结构化信号、微尺度变异和测量误差。指数协方差函数是一个标准的有效模型。该设置是克里金法（地质统计学的基石）的经典应用。该问题是科学上合理的。\n-   **良态性**：任务是最小化一个关于两个变量（$\\lambda_1, \\lambda_2$）的二次函数（MSPE），这是一个定义明确且具有唯一解的优化问题。所有必要的参数和函数都已提供。该问题在数学上是良态的。\n-   **客观性**：该问题使用精确的量化语言陈述。没有主观或模糊的术语。\n\n### 步骤 3：结论与行动\n问题有效。我们将从第一性原理开始进行完整推导。\n\n### 推导\n\n目标是找到线性估计量 $\\hat{Y}(0) = \\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2})$ 的权重 $\\lambda_{1}$ 和 $\\lambda_{2}$，以最小化均方预测误差（MSPE）。MSPE 定义为：\n$$\n\\sigma_{\\text{MSPE}}^{2} = E\\left[ \\left( \\hat{Y}(0) - Y(0) \\right)^{2} \\right]\n$$\n由于所有过程的均值均为零，估计量和真实值的均值也为零，因此 MSPE 等于预测误差的方差：\n$$\n\\sigma_{\\text{MSPE}}^{2} = \\text{Var}\\left( \\hat{Y}(0) - Y(0) \\right)\n$$\n利用方差的性质，我们可以展开这个表达式：\n$$\n\\sigma_{\\text{MSPE}}^{2} = \\text{Var}(\\hat{Y}(0)) + \\text{Var}(Y(0)) - 2\\text{Cov}(\\hat{Y}(0), Y(0))\n$$\n我们现在必须推导这三项中的每一项。\n\n1.  **真实场的方差，$\\text{Var}(Y(0))$**：\n    真实场为 $Y(s) = S(s) + M(s)$。由于 $S(s)$ 和 $M(s)$ 是独立过程：\n    $$\n    \\text{Var}(Y(s)) = \\text{Var}(S(s) + M(s)) = \\text{Var}(S(s)) + \\text{Var}(M(s))\n    $$\n    这是 $Y(s)$ 在滞后距 $h=0$ 处的协方差。我们将其表示为 $C_Y(0)$。\n    $\\text{Var}(S(s)) = C_{S}(0) = \\sigma_{S}^{2} \\exp(0) = \\sigma_{S}^{2}$。\n    $\\text{Var}(M(s)) = \\sigma_{\\mathrm{micro}}^{2}$。\n    因此，对于任何位置 $s$，包括 $s_0=0$：\n    $$\n    \\text{Var}(Y(0)) = \\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2}\n    $$\n\n2.  **估计量与真实值之间的协方差，$\\text{Cov}(\\hat{Y}(0), Y(0))$**：\n    估计量为 $\\hat{Y}(0) = \\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2})$。利用协方差的双线性性：\n    $$\n    \\text{Cov}(\\hat{Y}(0), Y(0)) = \\text{Cov}(\\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2}), Y(0)) = \\lambda_{1} \\text{Cov}(Z(s_{1}), Y(0)) + \\lambda_{2} \\text{Cov}(Z(s_{2}), Y(0))\n    $$\n    我们需要求出交叉协方差 $\\text{Cov}(Z(s_{i}), Y(s_{0}))$。\n    $Z(s_{i}) = S(s_{i}) + M(s_{i}) + \\epsilon(s_{i})$ 且 $Y(s_{0}) = S(s_{0}) + M(s_{0})$。由于 $S$、$M$ 和 $\\epsilon$ 的相互独立性：\n    $$\n    \\text{Cov}(Z(s_{i}), Y(s_{0})) = \\text{Cov(S(s_i), S(s_0))} + \\text{Cov(M(s_i), M(s_0))} + \\text{Cov(\\epsilon(s_i), S(s_0))} + \\text{Cov(\\epsilon(s_i), M(s_0))}\n    $$\n    后两项为零。第一项是 $C_{S}(s_{0} - s_{i})$。第二项 $\\text{Cov(M(s_i), M(s_0))}$ 为零，因为 $M(s)$ 是一个空间不相关（白噪声）过程，并且我们的观测点 $s_{1}$ 和 $s_{2}$ 与预测点 $s_{0}$ 不同。\n    因此，$\\text{Cov}(Z(s_{i}), Y(s_{0})) = C_{S}(s_{0} - s_{i})$。\n    对于 $s_{0}=0$，$s_{1}=-0.5$ 和 $s_{2}=0.5$：\n    $\\text{Cov}(Z(s_{1}), Y(0)) = C_{S}(0 - (-0.5)) = C_{S}(0.5)$。\n    $\\text{Cov}(Z(s_{2}), Y(0)) = C_{S}(0 - 0.5) = C_{S}(-0.5)$。\n    由于 $C_S(h)$ 取决于 $|h|$，因此 $C_{S}(0.5) = C_{S}(-0.5)$。\n    所以，总协方差为：\n    $$\n    \\text{Cov}(\\hat{Y}(0), Y(0)) = (\\lambda_{1} + \\lambda_{2})C_{S}(0.5)\n    $$\n\n3.  **估计量的方差，$\\text{Var}(\\hat{Y}(0))$**：\n    $$\n    \\text{Var}(\\hat{Y}(0)) = \\text{Var}(\\lambda_{1} Z(s_{1}) + \\lambda_{2} Z(s_{2})) = \\lambda_{1}^{2}\\text{Var}(Z(s_{1})) + \\lambda_{2}^{2}\\text{Var}(Z(s_{2})) + 2\\lambda_{1}\\lambda_{2}\\text{Cov}(Z(s_{1}), Z(s_{2}))\n    $$\n    我们需要观测过程 $Z(s)$ 的协方差函数。我们称之为 $C_Z(h)$。\n    $Z(s) = S(s) + M(s) + \\epsilon(s)$。\n    $C_{Z}(h) = \\text{Cov}(Z(s), Z(s+h)) = \\text{Cov}(S(s)+M(s)+\\epsilon(s), S(s+h)+M(s+h)+\\epsilon(s+h))$。\n    由于独立性，这可以简化为：\n    $C_{Z}(h) = C_{S}(h) + C_{M}(h) + C_{\\epsilon}(h)$。\n    由于 $M(s)$ 和 $\\epsilon(s)$ 是白噪声过程，它们的协方差函数仅在 $h=0$ 时非零。\n    $C_{M}(h) = \\sigma_{\\mathrm{micro}}^{2}\\delta(h)$ 和 $C_{\\epsilon}(h) = \\sigma_{\\epsilon}^{2}\\delta(h)$，其中 $\\delta(h)$ 是克罗内克 delta 函数。\n    所以，$C_{Z}(h) = C_{S}(h) + (\\sigma_{\\mathrm{micro}}^{2} + \\sigma_{\\epsilon}^{2})\\delta(h)$。\n    项 $c_{N} = \\sigma_{\\mathrm{micro}}^{2} + \\sigma_{\\epsilon}^{2}$ 是总块金效应方差。\n    现在我们可以计算 $\\text{Var}(\\hat{Y}(0))$ 的各项：\n    $\\text{Var}(Z(s_{i})) = C_Z(0) = C_S(0) + c_N = \\sigma_S^2 + c_N$。这对 $s_1$ 和 $s_2$ 都是相同的。\n    $\\text{Cov}(Z(s_1), Z(s_2)) = C_Z(s_2-s_1) = C_Z(0.5 - (-0.5)) = C_Z(1)$。\n    由于滞后距 $h=1 \\neq 0$，delta 函数为零，所以 $\\text{Cov}(Z(s_{1}), Z(s_{2})) = C_{S}(1)$。\n    将这些代入方差表达式：\n    $$\n    \\text{Var}(\\hat{Y}(0)) = (\\lambda_{1}^{2} + \\lambda_{2}^{2})(\\sigma_{S}^{2} + c_{N}) + 2\\lambda_{1}\\lambda_{2}C_{S}(1)\n    $$\n\n**优化**：\n我们将 MSPE 组装为 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的函数：\n$$\n\\sigma_{\\text{MSPE}}^{2}(\\lambda_1, \\lambda_2) = [(\\lambda_{1}^{2} + \\lambda_{2}^{2})(\\sigma_{S}^{2} + c_{N}) + 2\\lambda_{1}\\lambda_{2}C_{S}(1)] - 2(\\lambda_{1} + \\lambda_{2})C_{S}(0.5) + (\\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2})\n$$\n为求最优权重，我们对 $\\lambda_{1}$ 和 $\\lambda_{2}$ 求偏导数，并令其为零。\n$$\n\\frac{\\partial \\sigma_{\\text{MSPE}}^{2}}{\\partial \\lambda_{1}} = 2\\lambda_{1}(\\sigma_{S}^{2} + c_{N}) + 2\\lambda_{2}C_{S}(1) - 2C_{S}(0.5) = 0\n$$\n$$\n\\frac{\\partial \\sigma_{\\text{MSPE}}^{2}}{\\partial \\lambda_{2}} = 2\\lambda_{2}(\\sigma_{S}^{2} + c_{N}) + 2\\lambda_{1}C_{S}(1) - 2C_{S}(0.5) = 0\n$$\n这得到以下线性方程组（称为简单克里金方程）：\n$$\n\\lambda_{1}(\\sigma_{S}^{2} + c_{N}) + \\lambda_{2}C_{S}(1) = C_{S}(0.5)\n$$\n$$\n\\lambda_{1}C_{S}(1) + \\lambda_{2}(\\sigma_{S}^{2} + c_{N}) = C_{S}(0.5)\n$$\n由于问题的对称性（观测点关于预测点对称），我们预期 $\\lambda_{1} = \\lambda_{2}$。设 $\\lambda = \\lambda_{1} = \\lambda_{2}$。将此代入第一个方程：\n$$\n\\lambda(\\sigma_{S}^{2} + c_{N}) + \\lambda C_{S}(1) = C_{S}(0.5) \\implies \\lambda [(\\sigma_{S}^{2} + c_{N}) + C_{S}(1)] = C_{S}(0.5)\n$$\n求解 $\\lambda$：\n$$\n\\lambda = \\frac{C_{S}(0.5)}{(\\sigma_{S}^{2} + c_{N}) + C_{S}(1)}\n$$\n\n**最小化 MSPE 的计算**：\n将最优权重代回 MSPE 公式，可以得到最小化 MSPE 的简化表达式。标准结果是：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = \\text{Var}(Y(0)) - \\text{Cov}(\\hat{Y}_{\\text{opt}}(0), Y(0))\n$$\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = (\\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2}) - (\\lambda_{1} C_{S}(0.5) + \\lambda_{2} C_{S}(0.5))\n$$\n当 $\\lambda_1 = \\lambda_2 = \\lambda$ 时：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = (\\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2}) - 2\\lambda C_{S}(0.5)\n$$\n代入 $\\lambda$ 的表达式：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = (\\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2}) - 2 \\frac{[C_S(0.5)]^2}{(\\sigma_{S}^{2} + c_{N}) + C_{S}(1)}\n$$\n\n**使用给定参数的最终计算**：\n给定的参数是：\n$\\sigma_{S}^{2} = 4$\n$\\sigma_{\\mathrm{micro}}^{2} = 1$\n$\\sigma_{\\epsilon}^{2} = 0.5$\n$\\phi = 1$\n推导出的参数是：\n$c_{N} = \\sigma_{\\mathrm{micro}}^{2} + \\sigma_{\\epsilon}^{2} = 1 + 0.5 = 1.5$\n$C_{S}(h) = 4 \\exp(-|h|)$.\n$C_{S}(0.5) = 4 \\exp(-0.5)$.\n$C_{S}(1) = 4 \\exp(-1)$.\n$\\sigma_{S}^{2} + \\sigma_{\\mathrm{micro}}^{2} = 4 + 1 = 5$.\n$\\sigma_{S}^{2} + c_{N} = 4 + 1.5 = 5.5$.\n\n将这些代入 MSPE 公式：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = 5 - 2 \\frac{[4\\exp(-0.5)]^2}{5.5 + 4\\exp(-1)}\n$$\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = 5 - \\frac{2 \\cdot 16 \\exp(-1)}{5.5 + 4\\exp(-1)}\n$$\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = 5 - \\frac{32 \\exp(-1)}{5.5 + 4\\exp(-1)}\n$$\n为了得到一个单一的分数表达式，我们求公分母：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = \\frac{5(5.5 + 4\\exp(-1)) - 32\\exp(-1)}{5.5 + 4\\exp(-1)}\n$$\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = \\frac{27.5 + 20\\exp(-1) - 32\\exp(-1)}{5.5 + 4\\exp(-1)}\n$$\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = \\frac{27.5 - 12\\exp(-1)}{5.5 + 4\\exp(-1)}\n$$\n为了消除小数点，我们将分子和分母同乘以 $2$：\n$$\n\\sigma_{\\text{MSPE, min}}^{2} = \\frac{2(27.5 - 12\\exp(-1))}{2(5.5 + 4\\exp(-1))} = \\frac{55 - 24\\exp(-1)}{11 + 8\\exp(-1)}\n$$\n这就是最小化均方预测误差的最终封闭形式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{55 - 24 \\exp(-1)}{11 + 8 \\exp(-1)}}\n$$"
        },
        {
            "introduction": "建立一个地质统计模型只是第一步，评估其预测性能同样至关重要。本练习将介绍一种关键的模型验证技术——留一法交叉验证（LOOCV），它能有效评估模型在未知点上的预测能力 。你将通过计算均方标准化误差（MSSE）这一诊断指标，来检验所选变异函数模型是否恰当，以及克里金方差是否真实反映了预测的不确定性。",
            "id": "3817496",
            "problem": "一个遥感团队使用合成孔径雷达（SAR）来估计一小块农田的表层土壤水分含量。三个地面验证点排列成一个边长为 $1$ $\\mathrm{km}$ 的等边三角形，其坐标分别为 $\\left(0,0\\right)$、$\\left(1,0\\right)$ 和 $\\left(\\frac{1}{2},\\frac{\\sqrt{3}}{2}\\right)$，测得的土壤水分含量为 $\\left(z_{1},z_{2},z_{3}\\right)=\\left(0.32,0.40,0.28\\right)$。假设土壤湿度是一个二阶平稳高斯随机场，其各向同性指数协方差函数为 $C\\!\\left(h\\right)=\\sigma^{2}\\exp\\!\\left(-\\frac{h}{\\phi}\\right)$，块金效应为零，偏基台值为 $\\sigma^{2}=0.02$，变程参数为 $\\phi=1$ $\\mathrm{km}$。\n\n使用普通克里金法（未知恒定均值），在每个站点进行留一法交叉验证（LOOCV）：在预测位置 $\\mathbf{x}_{i}$ 时，仅使用其余两个点作为训练集。仅从普通克里金法作为最佳线性无偏估计量的定义以及无偏约束下的方差最小化原理出发，推导普通克里金系统，确定每次LOOCV预测的权重，推导LOOCV目标点对应的克里金方差，并计算均方标准化误差（MSSE）\n$$\n\\mathrm{MSSE}=\\frac{1}{n}\\sum_{i=1}^{n}\\frac{\\left(z_{i}-\\hat{z}_{-i}\\right)^{2}}{\\sigma_{K,-i}^{2}},\n$$\n其中 $n=3$，$\\hat{z}_{-i}$ 是在 $\\mathbf{x}_{i}$ 处使用另外两个点进行的LOOCV普通克里金预测值，$\\sigma_{K,-i}^{2}$ 是相关的LOOCV普通克里金方差。将最终的MSSE四舍五入到四位有效数字，并以无单位小数表示。",
            "solution": "任务是使用普通克里金法，通过留一法交叉验证（LOOCV）程序计算均方标准化误差（MSSE）。我们首先从第一性原理推导普通克里金系统。\n\n设随机场为 $Z(\\mathbf{x})$，假设其为二阶平稳，具有一个恒定但未知的均值 $E[Z(\\mathbf{x})] = \\mu$ 和一个已知的协方差函数 $\\mathrm{Cov}(Z(\\mathbf{x}), Z(\\mathbf{y})) = C(\\mathbf{x}-\\mathbf{y})$。\n目标是使用在 $N$ 个位置 $\\mathbf{x}_1, \\dots, \\mathbf{x}_N$ 观测到的值 $z_i = Z(\\mathbf{x}_i)$ 的线性组合来预测位置 $\\mathbf{x}_0$ 处的值 $Z(\\mathbf{x}_0)$。估计量为\n$$\n\\hat{Z}(\\mathbf{x}_0) = \\sum_{i=1}^N w_i z_i\n$$\n其中 $w_i$ 是待确定的权重。\n\n为使估计量无偏，即 $E[\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0)] = 0$，我们要求：\n$$\nE[\\hat{Z}(\\mathbf{x}_0)] = E\\left[\\sum_{i=1}^N w_i Z(\\mathbf{x}_i)\\right] = \\sum_{i=1}^N w_i E[Z(\\mathbf{x}_i)] = \\mu \\sum_{i=1}^N w_i\n$$\n由于 $E[Z(\\mathbf{x}_0)] = \\mu$，无偏性条件要求 $\\mu \\sum_{i=1}^N w_i = \\mu$。因为这必须对未知均值 $\\mu$ 的任何值都成立，我们必须施加约束：\n$$\n\\sum_{i=1}^N w_i = 1\n$$\n克里金法通过最小化估计方差 $\\sigma_K^2 = E[(\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0))^2]$ 来确定权重，同时满足此无偏性约束。估计方差可以展开为：\n$$\n\\sigma_K^2 = \\mathrm{Var}(\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0)) = \\mathrm{Cov}\\left(\\sum_i w_i Z_i - Z_0, \\sum_j w_j Z_j - Z_0\\right)\n$$\n$$\n\\sigma_K^2 = \\sum_{i=1}^N \\sum_{j=1}^N w_i w_j C_{ij} - 2\\sum_{i=1}^N w_i C_{i0} + C_{00}\n$$\n其中 $Z_i = Z(\\mathbf{x}_i)$，$C_{ij} = \\mathrm{Cov}(Z_i, Z_j)$，$C_{i0} = \\mathrm{Cov}(Z_i, Z_0)$，以及 $C_{00} = \\mathrm{Var}(Z_0)$。\n\n为了解决这个有约束的最小化问题，我们使用拉格朗日乘数法。我们定义拉格朗日函数 $\\mathcal{L}$：\n$$\n\\mathcal{L}(\\mathbf{w}, \\lambda) = \\sum_{i=1}^N \\sum_{j=1}^N w_i w_j C_{ij} - 2\\sum_{i=1}^N w_i C_{i0} + C_{00} - 2\\lambda\\left(\\sum_{i=1}^N w_i - 1\\right)\n$$\n将关于每个权重 $w_k$ 的偏导数设为零，得到：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial w_k} = 2\\sum_{i=1}^N w_i C_{ik} - 2C_{k0} - 2\\lambda = 0 \\implies \\sum_{i=1}^N w_i C_{ik} - \\lambda = C_{k0} \\quad (k=1, \\dots, N)\n$$\n关于 $\\lambda$ 的导数恢复了约束 $\\sum w_i = 1$。由此产生的 $N+1$ 个线性方程组构成了普通克里金系统，其矩阵形式为：\n$$\n\\begin{pmatrix}\nC_{11}  \\cdots  C_{1N}  1 \\\\\n\\vdots  \\ddots  \\vdots  \\vdots \\\\\nC_{N1}  \\cdots  C_{NN}  1 \\\\\n1  \\cdots  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_1 \\\\\n\\vdots \\\\\nw_N \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{10} \\\\\n\\vdots \\\\\nC_{N0} \\\\\n1\n\\end{pmatrix}\n$$\n最小化的克里金方差由 $\\sigma_K^2 = C_{00} - \\sum_{i=1}^N w_i C_{i0} - \\lambda$ 给出。\n\n现在，我们将此框架应用于具体问题。坐标为 $\\mathbf{x}_1=(0,0)$、$\\mathbf{x}_2=(1,0)$ 和 $\\mathbf{x}_3=(\\frac{1}{2},\\frac{\\sqrt{3}}{2})$。任意两点之间的距离都是 $1$ $\\mathrm{km}$。各向同性指数协方差函数为 $C(h) = \\sigma^2 \\exp(-h/\\phi)$，偏基台值为 $\\sigma^2 = 0.02$，变程为 $\\phi = 1$ $\\mathrm{km}$。因此，$C(h) = 0.02 \\exp(-h)$。\n场的方差是 $C(0) = 0.02$。三个站点中任意两个之间的协方差是 $C(1) = 0.02 \\exp(-1)$。我们将其记为 $C_0 = 0.02$ 和 $C_1 = 0.02e^{-1}$。\n\n我们对 $n=3$ 个站点中的每一个进行留一法交叉验证。由于等边三角形的几何特性，每次LOOCV预测的设置都是相同的。例如，当使用来自 $\\mathbf{x}_2$ 和 $\\mathbf{x}_3$ 的数据（$N=2$）在 $\\mathbf{x}_1$（目标点，$\\mathbf{x}_0$）进行预测时，克里金系统为：\n$$\n\\begin{pmatrix}\nC(\\mathbf{x}_2, \\mathbf{x}_2)  C(\\mathbf{x}_2, \\mathbf{x}_3)  1 \\\\\nC(\\mathbf{x}_3, \\mathbf{x}_2)  C(\\mathbf{x}_3, \\mathbf{x}_3)  1 \\\\\n1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_2 \\\\\nw_3 \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC(\\mathbf{x}_2, \\mathbf{x}_1) \\\\\nC(\\mathbf{x}_3, \\mathbf{x}_1) \\\\\n1\n\\end{pmatrix}\n$$\n对于不同点的点对，距离均为 $h=1$ $\\mathrm{km}$。因此，对于 $i \\neq j$，$C(\\mathbf{x}_i, \\mathbf{x}_i) = C_0$ 且 $C(\\mathbf{x}_i, \\mathbf{x}_j) = C_1$。系统变为：\n$$\n\\begin{pmatrix}\nC_0  C_1  1 \\\\\nC_1  C_0  1 \\\\\n1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_2 \\\\\nw_3 \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_1 \\\\\nC_1 \\\\\n1\n\\end{pmatrix}\n$$\n这得到三个方程：\n1. $w_2 C_0 + w_3 C_1 + \\lambda = C_1$\n2. $w_2 C_1 + w_3 C_0 + \\lambda = C_1$\n3. $w_2 + w_3 = 1$\n\n第一个方程减去第二个方程得到 $w_2(C_0 - C_1) - w_3(C_0 - C_1) = 0$。因为 $C_0 \\neq C_1$，我们可以除以 $(C_0 - C_1)$ 得到 $w_2 = w_3$。将此代入第三个方程得到 $2w_2 = 1$，所以 $w_2 = w_3 = 0.5$。\n由于对称性，对于任何LOOCV预测，两个可用的数据点将始终获得 $0.5$ 的权重。\n\n克里金方差 $\\sigma_{K,-i}^2$ 对于每个留一实例也将是相同的。让我们为在 $\\mathbf{x}_1$ 处的预测计算它：\n$$ \\sigma_{K,-1}^2 = C(\\mathbf{x}_1, \\mathbf{x}_1) - (w_2 C(\\mathbf{x}_2, \\mathbf{x}_1) + w_3 C(\\mathbf{x}_3, \\mathbf{x}_1)) - \\lambda $$\n为了找到 $\\lambda$，我们使用第一个方程：$0.5 C_0 + 0.5 C_1 + \\lambda = C_1 \\implies \\lambda = 0.5 C_1 - 0.5 C_0$。\n$$ \\sigma_{K,-1}^2 = C_0 - (0.5 C_1 + 0.5 C_1) - (0.5 C_1 - 0.5 C_0) = C_0 - C_1 - 0.5 C_1 + 0.5 C_0 $$\n$$ \\sigma_{K,-1}^2 = 1.5 C_0 - 1.5 C_1 = 1.5(C_0 - C_1) $$\n代入数值 $C_0 = 0.02$ 和 $C_1 = 0.02e^{-1}$：\n$$ \\sigma_{K,-1}^2 = 1.5(0.02 - 0.02e^{-1}) = 0.03(1 - e^{-1}) $$\n这个恒定的克里金方差对于所有三个实例都记为 $\\sigma_{K}^2$。\n\n现在我们计算LOOCV的预测值和误差：\n测量值为 $(z_1, z_2, z_3) = (0.32, 0.40, 0.28)$。\n1.  在 $\\mathbf{x}_1$ 处的预测：$\\hat{z}_{-1} = 0.5 z_2 + 0.5 z_3 = 0.5(0.40 + 0.28) = 0.34$。\n    误差平方：$(z_1 - \\hat{z}_{-1})^2 = (0.32 - 0.34)^2 = (-0.02)^2 = 0.0004$。\n2.  在 $\\mathbf{x}_2$ 处的预测：$\\hat{z}_{-2} = 0.5 z_1 + 0.5 z_3 = 0.5(0.32 + 0.28) = 0.30$。\n    误差平方：$(z_2 - \\hat{z}_{-2})^2 = (0.40 - 0.30)^2 = (0.10)^2 = 0.01$。\n3.  在 $\\mathbf{x}_3$ 处的预测：$\\hat{z}_{-3} = 0.5 z_1 + 0.5 z_2 = 0.5(0.32 + 0.40) = 0.36$。\n    误差平方：$(z_3 - \\hat{z}_{-3})^2 = (0.28 - 0.36)^2 = (-0.08)^2 = 0.0064$。\n\n最后，我们计算均方标准化误差（MSSE）：\n$$ \\mathrm{MSSE} = \\frac{1}{n}\\sum_{i=1}^{n}\\frac{(z_i - \\hat{z}_{-i})^2}{\\sigma_{K,-i}^2} $$\n因为对于所有 $i$，$n=3$ 且 $\\sigma_{K,-i}^2 = \\sigma_{K}^2 = 0.03(1 - e^{-1})$：\n$$ \\mathrm{MSSE} = \\frac{1}{3 \\sigma_{K}^2} \\sum_{i=1}^3 (z_i - \\hat{z}_{-i})^2 $$\n误差平方和为 $0.0004 + 0.01 + 0.0064 = 0.0168$。\n$$ \\mathrm{MSSE} = \\frac{0.0168}{3 \\times 0.03(1 - e^{-1})} = \\frac{0.0168}{0.09(1 - e^{-1})} $$\n对此表达式进行数值计算：\n$$ \\mathrm{MSSE} = \\frac{0.0168}{0.09 \\times (1 - \\exp(-1))} \\approx \\frac{0.0168}{0.09 \\times (1 - 0.367879)} = \\frac{0.0168}{0.09 \\times 0.632121} \\approx \\frac{0.0168}{0.0568909} \\approx 0.295311 $$\n四舍五入到四位有效数字，我们得到 $0.2953$。",
            "answer": "$$\n\\boxed{0.2953}\n$$"
        }
    ]
}