{
    "hands_on_practices": [
        {
            "introduction": "Global Sensitivity Analysis (GSA) is a powerful tool, but its application requires careful planning, starting with an assessment of its computational cost. The Morris method is widely valued as an efficient screening technique, ideal for identifying the most influential inputs in models with many parameters. This exercise  provides a foundational understanding of how to calculate the number of model evaluations required for a Morris analysis, a critical skill for designing feasible and cost-effective computational experiments.",
            "id": "3817788",
            "problem": "A satellite-based evapotranspiration model maps remote sensing inputs into latent heat flux using a parameterized land surface energy balance. To assess global sensitivity of this model under realistic environmental variability, a researcher adopts the Morris method, also known as the One-At-a-Time (OAT) design, implemented as random trajectories across a discretized input space. The input space is the hypercube $[0,1]^{d}$, uniformly discretized into $p$ equally spaced levels per dimension. A random OAT trajectory is constructed by selecting a random base point in the grid and then perturbing one input at a time by a fixed grid-consistent step, proceeding through a randomized order of the $d$ dimensions. Each distinct point along the trajectory requires a single forward model evaluation.\n\nAssume the model has $d=8$ uncertain inputs and the researcher draws $r=50$ independent random OAT trajectories on a $p$-level grid with $p=8$. Based on the foundational definition of a random OAT trajectory across a $p$-level grid in the Morris method, determine the total number of unique model evaluations required to complete the sensitivity analysis. Express your answer as a single number. No rounding is required and no physical units apply.",
            "solution": "The problem requires calculating the total number of model evaluations for a sensitivity analysis using the Morris method. The total number of evaluations, denoted by $N$, is the primary measure of the computational cost of this experimental design.\n\nFirst, we must determine the number of model evaluations required for a single One-At-a-Time (OAT) trajectory. The problem states that a trajectory is constructed as follows:\n1.  A random base point is selected in the $d$-dimensional input space. This requires one model evaluation.\n2.  Subsequently, each of the $d$ input variables is perturbed one at a time. This creates $d$ new points, each requiring a separate model evaluation.\n\nTherefore, for a single trajectory, the total number of points evaluated is the initial base point plus one additional point for each of the $d$ dimensions. Let $N_{traj}$ be the number of evaluations per trajectory:\n$$N_{traj} = 1 + d$$\nThe research plan involves generating $r$ independent random OAT trajectories. The total number of model evaluations, $N$, is the product of the number of trajectories ($r$) and the number of evaluations per trajectory ($N_{traj}$):\n$$N = r \\times N_{traj} = r(d+1)$$\nThe problem provides the following specific values:\n- The number of dimensions (inputs), $d = 8$.\n- The number of trajectories, $r = 50$.\n\nThe number of grid levels, $p=8$, defines the discretization of the input space but does not influence the number of points in a trajectory.\n\nSubstituting the given values of $d$ and $r$ into the cost formula:\n$$N = 50 \\times (8 + 1)$$\n$$N = 50 \\times 9$$\n$$N = 450$$\nThus, the total number of model evaluations required is 450.",
            "answer": "$$\\boxed{450}$$"
        },
        {
            "introduction": "While the Morris method is excellent for screening, a full quantitative GSA often employs variance-based techniques like the Sobol' method to precisely attribute output variance to main effects and interactions. This added insight comes at a higher computational price. This practice  focuses on calculating the cost of a Sobol' analysis using the widely adopted Saltelli sampling scheme, allowing for a direct comparison with the Morris method and illustrating the fundamental trade-off between analytical depth and computational resources.",
            "id": "3817705",
            "problem": "A scalar remote sensing forward operator $f:\\mathbb{R}^{d}\\rightarrow\\mathbb{R}$ maps an input vector of $d$ uncertain environmental parameters to the daily average net radiation at the surface retrieved from satellite observations. Consider $d=9$ uncertain inputs aggregated over a study domain: near-surface air temperature, specific humidity, wind speed, atmospheric transmittance, aerosol optical depth, surface broadband albedo, surface emissivity, leaf area index, and soil moisture. Let $Y=f(\\mathbf{X})$ denote the scalar model output for a random input vector $\\mathbf{X}=(X_{1},\\dots,X_{d})$ with independent components. You aim to estimate all first-order Sobol' indices $S_{i}$ and total-order Sobol' indices $S_{Ti}$ of $Y$ with respect to the $d$ inputs, based on the variance decomposition of Analysis Of Variance (ANOVA) and the definitions $S_{i}=\\mathrm{Var}\\!\\left(\\mathbb{E}[Y\\mid X_{i}]\\right)/\\mathrm{Var}(Y)$ and $S_{Ti}=1-\\mathrm{Var}\\!\\left(\\mathbb{E}[Y\\mid \\mathbf{X}_{\\sim i}]\\right)/\\mathrm{Var}(Y)$, where $\\mathbf{X}_{\\sim i}$ denotes all inputs except $X_{i}$.\n\nYou adopt the Saltelli sampling design to construct Monte Carlo estimators for all $S_{i}$ and $S_{Ti}$ simultaneously. The design uses two independent sampling matrices $\\mathbf{A},\\mathbf{B}\\in\\mathbb{R}^{N\\times d}$ whose rows are independent and identically distributed (i.i.d.) draws of $\\mathbf{X}$. For each input dimension $i\\in\\{1,\\dots,d\\}$, form an auxiliary matrix $\\mathbf{A}_{B}^{(i)}\\in\\mathbb{R}^{N\\times d}$ by replacing the $i$-th column of $\\mathbf{A}$ with the $i$-th column of $\\mathbf{B}$, leaving the other columns of $\\mathbf{A}$ unchanged. Assume the model $f$ is deterministic and each evaluation returns a single scalar $Y$.\n\nUnder this design, compute the total number of model evaluations required to estimate all first-order and all total-order Sobol' indices. Use the specific values $N=2048$ and $d=9$. Express your final answer as an integer count of evaluations. No rounding instruction is necessary because the answer is exact and unitless.",
            "solution": "The objective is to calculate the total number of model evaluations required to estimate all first-order and total-order Sobol' indices for a model with $d$ inputs, using the Saltelli sampling scheme with a base sample size of $N$.\n\nThe Saltelli sampling design generates a set of input points at which the model function $f$ must be evaluated. The total cost is the number of these unique points. The scheme is constructed as follows:\n\n1.  Two independent sample matrices, $\\mathbf{A}$ and $\\mathbf{B}$, are generated. Each matrix has dimensions $N \\times d$, containing $N$ samples of the $d$-dimensional input vector. Evaluating the model for all $N$ rows of matrix $\\mathbf{A}$ requires $N$ evaluations.\n2.  Similarly, evaluating the model for all $N$ rows of matrix $\\mathbf{B}$ requires another $N$ evaluations.\n3.  For each of the $d$ input parameters, an auxiliary matrix $\\mathbf{A}_{B}^{(i)}$ is constructed by taking matrix $\\mathbf{A}$ and replacing its $i$-th column with the $i$-th column from matrix $\\mathbf{B}$. This must be done for each input $i \\in \\{1, \\dots, d\\}$. Each of the $d$ resulting matrices requires $N$ model evaluations. This step contributes $d \\times N$ evaluations to the total.\n\nThe total number of model evaluations, $C_{total}$, is the sum of the evaluations required for matrices $\\mathbf{A}$, $\\mathbf{B}$, and all $d$ of the $\\mathbf{A}_{B}^{(i)}$ matrices:\n$$C_{total} = (\\text{evaluations for } \\mathbf{A}) + (\\text{evaluations for } \\mathbf{B}) + (\\text{evaluations for all } \\mathbf{A}_{B}^{(i)})$$\n$$C_{total} = N + N + d \\times N$$\n$$C_{total} = N(d+2)$$\nThis is the general formula for the computational cost of the Saltelli sampling scheme for estimating all first-order and total-order indices.\n\nThe problem provides the specific values:\n- Base sample size: $N = 2048$\n- Number of input dimensions: $d = 9$\n\nSubstituting these values into the formula:\n$$C_{total} = 2048 \\times (9 + 2)$$\n$$C_{total} = 2048 \\times 11$$\n$$C_{total} = 22528$$\nTherefore, a total of 22,528 model evaluations are required.",
            "answer": "$$\\boxed{22528}$$"
        },
        {
            "introduction": "To truly master GSA, one must look beyond cost calculation and understand how model structure gives rise to sensitivity indices. This exercise  moves from planning to interpretation by using the Ishigami function, a classic GSA benchmark that elegantly combines nonlinearity and parameter interaction. By analytically deriving the Sobol' indices from first principles, you will gain a deep, mechanistic understanding of how main effects and, crucially, interaction effects are defined and quantified within the variance decomposition framework.",
            "id": "3817785",
            "problem": "A remote sensing environmental model’s nonlinear response to three independent, uniformly distributed input factors can be idealized by the Ishigami function, a benchmark in Global Sensitivity Analysis (GSA): $$f(x_{1},x_{2},x_{3})=\\sin(x_{1})+a\\,\\sin^{2}(x_{2})+b\\,x_{3}^{4}\\,\\sin(x_{1}),$$ where $x_{1}$, $x_{2}$, and $x_{3}$ are independent and identically distributed as $\\mathcal{U}(-\\pi,\\pi)$ and angles are measured in radians. This structure mimics multiplicative amplitude modulation often encountered in remote sensing forward models (for example, when a path term $x_{3}^{4}$ modulates a trigonometric signal $\\sin(x_{1})$ in a reflectance function). Using the variance-based GSA foundation (analysis of variance decomposition and Sobol’ sensitivity indices), do the following for this model:\n- Derive closed-form expressions for the first-order Sobol’ indices $S_{1}$, $S_{2}$, and $S_{3}$, and for the second-order interaction index $S_{13}$, in terms of $a$, $b$, and $\\pi$.\n- Evaluate these expressions numerically for the canonical Ishigami parameters $a=7$ and $b=0.1$.\n- Interpret the source of strong interaction between $x_{1}$ and $x_{3}$ in the term $b\\,x_{3}^{4}\\,\\sin(x_{1})$ within the framework of the variance decomposition.\n\nExpress your final numerical values for $S_{1}$, $S_{2}$, $S_{3}$, and $S_{13}$ as dimensionless quantities. Round your answers to four significant figures.",
            "solution": "The problem requires the analytical derivation of Sobol' indices for the Ishigami function:\n$$f(x_{1},x_{2},x_{3})=\\sin(x_{1})+a\\,\\sin^{2}(x_{2})+b\\,x_{3}^{4}\\,\\sin(x_{1})$$\nwhere the inputs $x_{1}$, $x_{2}$, $x_{3}$ are i.i.d. $\\mathcal{U}(-\\pi,\\pi)$.\n\nThe Sobol' indices are based on the ANOVA decomposition of the model output variance, $V$. The first-order index is $S_i = V_i / V$, where $V_i = \\mathrm{Var}_{x_i}(\\mathbb{E}_{\\mathbf{x}_{\\sim i}}[f(\\mathbf{x})])$. The second-order index is $S_{ij} = V_{ij} / V$, where $V_{ij}$ is the variance of the two-way interaction term.\n\nFirst, we compute the expectations of the elementary functions, using $\\mathbb{E}[g(x_i)] = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} g(x_i) dx_i$:\n\\begin{itemize}\n    \\item $\\mathbb{E}[\\sin(x_1)] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\sin(x_1) dx_1 = 0$\n    \\item $\\mathbb{E}[\\sin^2(x_1)] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\frac{1-\\cos(2x_1)}{2} dx_1 = \\frac{1}{2}$\n    \\item $\\mathbb{E}[x_3^n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} x_3^n dx_3 = \\frac{\\pi^n}{n+1}$ (for even integer $n \\ge 0$). Thus, $\\mathbb{E}[x_3^4] = \\frac{\\pi^4}{5}$ and $\\mathbb{E}[x_3^8] = \\frac{\\pi^8}{9}$.\n\\end{itemize}\n\nThe mean of the output $\\mathbb{E}[f]$ is:\n$$\\mathbb{E}[f] = \\mathbb{E}[\\sin(x_1)] + a \\mathbb{E}[\\sin^2(x_2)] + b \\mathbb{E}[x_3^4]\\mathbb{E}[\\sin(x_1)] = 0 + a(\\frac{1}{2}) + 0 = \\frac{a}{2}$$\n\nThe ANOVA decomposition for the Ishigami function contains only terms $f_1, f_2, f_{13}$, so the total variance is $V = V_1 + V_2 + V_{13}$. We calculate these partial variances.\n\n**Partial Variance $V_2$ (due to $x_2$):**\n$\\mathbb{E}_{\\mathbf{x}_{\\sim 2}}[f] = \\mathbb{E}_{x_1,x_3}[f] = a\\sin^2(x_2)$.\n$V_2 = \\mathrm{Var}_{x_2}[a\\sin^2(x_2)] = a^2 \\mathrm{Var}(\\sin^2(x_2))$.\n$\\mathrm{Var}(\\sin^2(x_2)) = \\mathbb{E}[\\sin^4(x_2)] - (\\mathbb{E}[\\sin^2(x_2)])^2 = \\frac{3}{8} - (\\frac{1}{2})^2 = \\frac{1}{8}$.\nSo, $V_2 = \\frac{a^2}{8}$.\n\n**Partial Variance $V_1$ (due to $x_1$):**\n$\\mathbb{E}_{\\mathbf{x}_{\\sim 1}}[f] = \\mathbb{E}_{x_2,x_3}[f] = \\sin(x_1) + a \\mathbb{E}[\\sin^2(x_2)] + b \\mathbb{E}[x_3^4]\\sin(x_1) = (1 + \\frac{b\\pi^4}{5})\\sin(x_1) + \\frac{a}{2}$.\n$V_1 = \\mathrm{Var}_{x_1}[\\mathbb{E}_{\\mathbf{x}_{\\sim 1}}[f]] = \\mathrm{Var}[(1 + \\frac{b\\pi^4}{5})\\sin(x_1)] = (1 + \\frac{b\\pi^4}{5})^2 \\mathrm{Var}(\\sin(x_1)) = \\frac{1}{2}(1 + \\frac{b\\pi^4}{5})^2$.\n\n**Partial Variance $V_3$ (due to $x_3$):**\n$\\mathbb{E}_{\\mathbf{x}_{\\sim 3}}[f] = \\mathbb{E}_{x_1,x_2}[f] = \\mathbb{E}[\\sin(x_1)] + a \\mathbb{E}[\\sin^2(x_2)] + b x_3^4 \\mathbb{E}[\\sin(x_1)] = \\frac{a}{2}$.\n$V_3 = \\mathrm{Var}_{x_3}[\\frac{a}{2}] = 0$. Thus, $S_3 = 0$.\n\n**Interaction Variance $V_{13}$ (due to $x_1, x_3$):**\nThe interaction term is $f_{13}(x_1, x_3) = \\mathbb{E}_{x_2}[f] - f_1(x_1) - f_3(x_3) - f_0$.\n$f_{13}(x_1, x_3) = (\\sin(x_1) + \\frac{a}{2} + bx_3^4\\sin(x_1)) - ((1 + \\frac{b\\pi^4}{5})\\sin(x_1)) - 0 - \\frac{a}{2} = b(x_3^4 - \\frac{\\pi^4}{5})\\sin(x_1)$.\n$V_{13} = \\mathrm{Var}(f_{13}) = \\mathbb{E}[f_{13}^2]$ since $\\mathbb{E}[f_{13}]=0$.\n$V_{13} = \\mathbb{E}[b^2(x_3^4 - \\mathbb{E}[x_3^4])^2 \\sin^2(x_1)] = b^2 \\mathrm{Var}(x_3^4) \\mathbb{E}[\\sin^2(x_1)]$.\n$\\mathrm{Var}(x_3^4) = \\mathbb{E}[x_3^8] - (\\mathbb{E}[x_3^4])^2 = \\frac{\\pi^8}{9} - (\\frac{\\pi^4}{5})^2 = \\frac{16\\pi^8}{225}$.\n$V_{13} = b^2 (\\frac{16\\pi^8}{225}) (\\frac{1}{2}) = \\frac{8b^2\\pi^8}{225}$.\n\nThe Sobol' indices are the partial variances normalized by the total variance $V = V_1 + V_2 + V_{13}$.\n\n**Numerical evaluation for $a=7$ and $b=0.1$:**\n- $V_2 = \\frac{7^2}{8} = 6.125$.\n- $V_1 = \\frac{1}{2}(1 + \\frac{0.1\\pi^4}{5})^2 \\approx 4.3459$.\n- $V_{13} = \\frac{8(0.1)^2\\pi^8}{225} \\approx 3.3737$.\n- Total variance $V = V_1 + V_2 + V_{13} \\approx 4.3459 + 6.125 + 3.3737 \\approx 13.8446$.\n\nThe indices are (rounded to four significant figures):\n- $S_1 = V_1/V \\approx 4.3459 / 13.8446 \\approx 0.3139$.\n- $S_2 = V_2/V \\approx 6.125 / 13.8446 \\approx 0.4424$.\n- $S_3 = 0.0000$.\n- $S_{13} = V_{13}/V \\approx 3.3737 / 13.8446 \\approx 0.2437$.\n\n**Interpretation of the interaction:**\nThe term $b\\,x_{3}^{4}\\,\\sin(x_{1})$ is multiplicative, which makes the model non-additive. The effect of $x_1$ on the output $f$ depends on the value of $x_3$, and vice-versa. Formally, this is captured by the non-zero ANOVA interaction term $f_{13}(x_1, x_3) = b(x_3^4 - \\mathbb{E}[x_3^4])\\sin(x_1)$. The variance of this term, $V_{13}$, quantifies the portion of the output's total variance that is due to this synergistic effect. The resulting index $S_{13} \\approx 0.2437$ indicates that about 24.4% of the model's total output variance stems from this interaction, a contribution comparable in magnitude to the main effects of $x_1$ ($S_1 \\approx 31.4\\%$) and $x_2$ ($S_2 \\approx 44.2\\%$).",
            "answer": "$$\\boxed{S_1 = 0.3139, \\ S_2 = 0.4424, \\ S_3 = 0.0000, \\ S_{13} = 0.2437}$$"
        }
    ]
}