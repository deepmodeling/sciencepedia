{
    "hands_on_practices": [
        {
            "introduction": "从根本上说，像BFAST和LandTrendr这样的断点检测算法是在解决一个统计估计问题。本练习将引导你从第一性原理出发，推导出单个变化点的基本估计量，从而为你理解这些方法如何识别时间序列中的结构性突变建立坚实的理论基础。通过这个推导，你将看到最小化残差平方和与最大化高斯误差模型下的似然函数之间的直接联系。",
            "id": "3799277",
            "problem": "一位遥感分析师正在研究一个可能受到砍伐事件干扰的森林像素的年度归一化植被指数 (NDVI)。该分析师旨在将高斯误差下单均值断点的统计估计量与 Breaks For Additive Season and Trend (BFAST) 和 Landsat-based Detection of Trends in Disturbance and Recovery (LandTrendr) 中使用的操作逻辑联系起来。考虑一个单变量时间序列 $\\{x_t\\}_{t=1}^{n}$，其模型为\n$$\nx_t =\n\\begin{cases}\n\\mu_1 + \\varepsilon_t,  t \\le \\tau, \\\\\n\\mu_2 + \\varepsilon_t,  t > \\tau,\n\\end{cases}\n$$\n其中 $\\varepsilon_t \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$，方差 $\\sigma^2$ 已知，变化点索引 $\\tau$ 是一个满足 $2 \\le \\tau \\le n-1$ 的未知整数。假设误差在时间 $t$ 上是独立的，并且高斯模型是正确设定的。从独立高斯观测的似然函数出发，通过轮廓化（profiling out）$\\mu_1$ 和 $\\mu_2$ 来推导 $\\tau$ 的最大似然估计量。在您的推导中，不要假设任何专门的变化点检验统计量；从高斯似然函数开始，并根据第一性原理进行推导。然后，阐明该估计量如何推广到在断点处具有连续性约束的分段线性趋势模型中的单斜率变化，并简要地将此推广与 BFAST 和 LandTrendr 中采用的估计逻辑联系起来。\n\n最后，将您推导出的估计量应用于以下具有 $n=12$ 个年度观测值的 NDVI 时间序列（这些值实际上是无单位的，但界于 $0$ 和 $1$ 之间）：\n$$\nx_1 = 0.75,\\; x_2 = 0.75,\\; x_3 = 0.75,\\; x_4 = 0.75,\\; x_5 = 0.75,\\; x_6 = 0.75,\\; x_7 = 0.55,\\; x_8 = 0.55,\\; x_9 = 0.55,\\; x_{10} = 0.55,\\; x_{11} = 0.55,\\; x_{12} = 0.55.\n$$\n报告使您推导的似然准则最大化的整数索引 $\\hat{\\tau}$。最终答案以无单位的整数形式表示。由于答案是整数，因此不需要舍入说明。",
            "solution": "基础是独立观测值的高斯似然函数。在模型\n$$\nx_t =\n\\begin{cases}\n\\mu_1 + \\varepsilon_t,  t \\le \\tau, \\\\\n\\mu_2 + \\varepsilon_t,  t > \\tau,\n\\end{cases}\n\\quad\\text{with}\\quad \\varepsilon_t \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2),\n$$\n下，对于一个候选变化点 $\\tau$ 的联合似然函数是\n$$\nL(\\mu_1,\\mu_2,\\tau) = \\prod_{t=1}^{\\tau} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\!\\left(-\\frac{(x_t - \\mu_1)^2}{2\\sigma^2}\\right) \\cdot \\prod_{t=\\tau+1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\!\\left(-\\frac{(x_t - \\mu_2)^2}{2\\sigma^2}\\right).\n$$\n对数似然函数是\n$$\n\\ell(\\mu_1,\\mu_2,\\tau) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\left( \\sum_{t=1}^{\\tau} (x_t - \\mu_1)^2 + \\sum_{t=\\tau+1}^{n} (x_t - \\mu_2)^2 \\right).\n$$\n对于一个固定的 $\\tau$，$\\mu_1$ 和 $\\mu_2$ 的最大似然估计量是它们各自段上的样本均值，通过将偏导数设为零得到：\n$$\n\\hat{\\mu}_1(\\tau) = \\frac{1}{\\tau} \\sum_{t=1}^{\\tau} x_t, \\qquad \\hat{\\mu}_2(\\tau) = \\frac{1}{n-\\tau} \\sum_{t=\\tau+1}^{n} x_t.\n$$\n将这些代入 $\\ell$ 得到轮廓对数似然函数\n$$\n\\ell_{\\text{prof}}(\\tau) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\left( \\sum_{t=1}^{\\tau} (x_t - \\hat{\\mu}_1(\\tau))^2 + \\sum_{t=\\tau+1}^{n} (x_t - \\hat{\\mu}_2(\\tau))^2 \\right).\n$$\n因为 $-\\frac{n}{2}\\ln(2\\pi\\sigma^2)$ 对于 $\\tau$ 是一个常数，所以最大化 $\\ell_{\\text{prof}}(\\tau)$ 等价于最小化段内平方误差和\n$$\n\\text{SSE}(\\tau) = \\sum_{t=1}^{\\tau} (x_t - \\hat{\\mu}_1(\\tau))^2 + \\sum_{t=\\tau+1}^{n} (x_t - \\hat{\\mu}_2(\\tau))^2.\n$$\n通常将 $\\text{SSE}(\\tau)$ 相对于单均值模型来表示会很方便。令 $\\bar{x} = \\frac{1}{n}\\sum_{t=1}^{n} x_t$ 为总体均值。那么在 $\\tau$ 处分割所带来的平方和减少量是\n$$\n\\Delta(\\tau) = \\sum_{t=1}^{n} (x_t - \\bar{x})^2 - \\text{SSE}(\\tau).\n$$\n最小二乘法中的一个标准投影论证表明\n$$\n\\Delta(\\tau) = \\frac{\\tau(n-\\tau)}{n}\\left(\\hat{\\mu}_1(\\tau) - \\hat{\\mu}_2(\\tau)\\right)^2.\n$$\n因此，最小化 $\\text{SSE}(\\tau)$ 等价于最大化 $\\Delta(\\tau)$，或者等价于最大化\n$$\nJ(\\tau) = \\tau(n-\\tau)\\left(\\hat{\\mu}_1(\\tau) - \\hat{\\mu}_2(\\tau)\\right)^2.\n$$\n因此，变化点的最大似然估计量是\n$$\n\\hat{\\tau} = \\arg\\max_{2 \\le \\tau \\le n-1} \\; \\tau(n-\\tau)\\left(\\hat{\\mu}_1(\\tau) - \\hat{\\mu}_2(\\tau)\\right)^2.\n$$\n\n推广到单斜率变化：考虑在断点处具有连续性约束的分段线性模型，\n$$\nx_t =\n\\begin{cases}\n\\alpha + \\beta_1 t + \\varepsilon_t,  t \\le \\tau, \\\\\n\\alpha + \\beta_1 \\tau + \\beta_2 (t-\\tau) + \\varepsilon_t,  t > \\tau,\n\\end{cases}\n$$\n其中 $\\varepsilon_t \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$ 且 $\\sigma^2$ 已知。对于固定的 $\\tau$，参数 $(\\alpha,\\beta_1,\\beta_2)$ 是线性进入的，因此最大似然估计量是基于设计矩阵的正规方程的普通最小二乘解，该设计矩阵包括截距、$t$ 和分段回归量 $(t-\\tau)_{+}$ 的列，其中 $(t-\\tau)_{+} = \\max\\{0, t-\\tau\\}$。轮廓化 $(\\alpha,\\beta_1,\\beta_2)$ 得到轮廓对数似然函数\n$$\n\\ell_{\\text{prof}}^{\\text{slope}}(\\tau) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\text{SSE}^{\\text{slope}}(\\tau),\n$$\n其中 $\\text{SSE}^{\\text{slope}}(\\tau)$ 是在 $\\tau$ 处进行分段回归拟合的残差平方和。因此，\n$$\n\\hat{\\tau}_{\\text{slope}} = \\arg\\min_{2 \\le \\tau \\le n-1} \\; \\text{SSE}^{\\text{slope}}(\\tau).\n$$\n这种推广通过以下方式与 Breaks For Additive Season and Trend (BFAST) 和 Landsat-based Detection of Trends in Disturbance and Recovery (LandTrendr) 联系起来：BFAST 将时间序列分解为趋势、季节和残余分量，然后通过比较各段的拟合来检验每个分量中的结构性变化；在操作上，这与在趋势分量中针对候选断点最小化分段残差平方和是一致的。LandTrendr 将一系列线性段拟合到具有未知断点的光谱指数上，通过选择断点的数量和位置来最小化基于残差方差和模型简约性的总成本。在这两种方法中，针对单斜率变化的核心估计逻辑都与选择能够优化分段线性最小二乘准则的 $\\tau$ 相一致。\n\n应用于给定的 NDVI 序列：令 $n=12$ 且\n$$\nx_1 = 0.75,\\; x_2 = 0.75,\\; x_3 = 0.75,\\; x_4 = 0.75,\\; x_5 = 0.75,\\; x_6 = 0.75,\\; x_7 = 0.55,\\; x_8 = 0.55,\\; x_9 = 0.55,\\; x_{10} = 0.55,\\; x_{11} = 0.55,\\; x_{12} = 0.55.\n$$\n定义当 $t \\le 6$ 时 $a = 0.75$ 且当 $t > 6$ 时 $b = 0.55$。对于给定的 $\\tau$，分段均值为\n$$\n\\hat{\\mu}_1(\\tau) =\n\\begin{cases}\na,  \\tau \\le 6, \\\\\n\\frac{6a + (\\tau - 6)b}{\\tau},  \\tau \\ge 6,\n\\end{cases}\n\\qquad\n\\hat{\\mu}_2(\\tau) =\n\\begin{cases}\n\\frac{(6 - \\tau)a + 6b}{12 - \\tau},  \\tau \\le 6, \\\\\nb,  \\tau \\ge 6.\n\\end{cases}\n$$\n因此，对于 $\\tau \\le 6$，\n$$\n\\hat{\\mu}_1(\\tau) - \\hat{\\mu}_2(\\tau) = a - \\frac{(6 - \\tau)a + 6b}{12 - \\tau} = \\frac{6(a - b)}{12 - \\tau},\n$$\n而对于 $\\tau \\ge 6$，\n$$\n\\hat{\\mu}_1(\\tau) - \\hat{\\mu}_2(\\tau) = \\frac{6a + (\\tau - 6)b}{\\tau} - b = \\frac{6(a - b)}{\\tau}.\n$$\n因此，目标函数 $J(\\tau)$ 变为\n$$\nJ(\\tau) =\n\\begin{cases}\n\\tau(12 - \\tau)\\left(\\frac{6(a - b)}{12 - \\tau}\\right)^2 = 36(a - b)^2 \\cdot \\frac{\\tau}{12 - \\tau},  \\tau \\le 6, \\\\\n\\tau(12 - \\tau)\\left(\\frac{6(a - b)}{\\tau}\\right)^2 = 36(a - b)^2 \\cdot \\frac{12 - \\tau}{\\tau},  \\tau \\ge 6.\n\\end{cases}\n$$\n这两个表达式在各自的定义域内对 $\\tau$ 都是单调的：对于 $\\tau \\le 6$，$J(\\tau)$ 随 $\\tau$ 增加而增加；对于 $\\tau \\ge 6$，$J(\\tau)$ 随 $\\tau$ 增加而减少。因此 $J(\\tau)$ 在 $\\tau = 6$ 处达到最大值。由于 $a - b = 0.20$，我们也可以计算\n$$\nJ(6) = 6 \\cdot 6 \\cdot (0.20)^2 = 36 \\cdot 0.04 = 1.44,\n$$\n且根据上面建立的单调性，对于任何 $\\tau \\neq 6$，$J(\\tau)  1.44$。因此，最大似然变化点估计为\n$$\n\\hat{\\tau} = 6.\n$$",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "当算法识别出一个断点后，下一步是赋予其生态学意义。本练习演示了如何解析时间序列模型的原始输出，通过校正季节性效应和背景趋势，来分离并量化环境扰动的真实速率。这项实践将统计输出与有意义的生态指标联系起来，展示了如何从数据中提取关于干扰事件（如森林砍伐）强度和性质的关键信息。",
            "id": "3799342",
            "problem": "单个像素的归一化燃烧指数（NBR）时间序列，记为 $y(t)$，根据加性季节和趋势断点（BFAST）框架进行加性分解：$y(t) = \\tau(t) + S(t) + \\varepsilon(t)$，其中 $\\tau(t)$ 是一个缓慢变化的趋势项，$S(t)$ 是一个周期性的季节性分量，$\\varepsilon(t)$ 是一个随机残差。在扰动发生之前，趋势项在局部可以很好地用线性形式 $\\tau(t) = a + b\\,t$ 来近似。季节性分量由其一阶谐波建模，$S(t) = C \\cos(2\\pi t) + D \\sin(2\\pi t)$，其中 $t$ 以年为单位，因此周期为1年。一个扰动窗口 $[t_b, t_e]$ 由基于Landsat的趋势和扰动检测算法（LandTrendr）识别出来，该窗口是在顶点 $t_b$ 和 $t_e$ 之间的一个单调线性段。在此窗口内，提供以下信息：\n- 扰动前趋势斜率 $b = 0.005$ (指数单位/年)，\n- 季节性系数 $C = 0.10$ 和 $D = 0.05$，\n- 扰动开始时间 $t_b = 2015.25$ 和结束时间 $t_e = 2015.75$，\n- NBR观测值 $y(t_b) = 0.68$ 和 $y(t_e) = 0.42$。\n\n从加性分解的定义、作为差商的斜率概念，以及将季节性变化和基线趋势与结构性扰动分离的思路出发，推导在 $[t_b, t_e]$ 区间上的扰动率的解析表达式，该扰动率定义为去季节化LandTrendr段的趋势校正斜率。使用所提供的参数计算此扰动率。将最终速率以指数单位/年表示，并将答案四舍五入到四位有效数字。最后，解释该速率的大小和符号如何与皆伐和选择性采伐的生态学解释相关联，将您的讨论建立在NBR变化的物理意义以及建模分量 $S(t)$ 和 $\\tau(t)$ 的基础上。",
            "solution": "### 解答推导\n\n目标是推导扰动率（记为 $R_d$）的解析表达式，然后对其进行求值。问题将 $R_d$ 定义为“去季节化LandTrendr段的趋势校正斜率”。我们将分步构建此量。\n\n1.  **LandTrendr段的斜率：** 观测到的LandTrendr段连接了两个点 $(t_b, y(t_b))$ 和 $(t_e, y(t_e))$。在此区间上观测到的NBR的总变化率（即斜率）由差商给出：\n    $$m_{obs} = \\frac{y(t_e) - y(t_b)}{t_e - t_b}$$\n    这个观测斜率聚合了来自背景趋势、季节性以及扰动事件本身的变化。\n\n2.  **去季节化段的斜率：** 为了对数据进行去季节化处理，我们从观测值 $y(t)$ 中减去季节性分量 $S(t)$。去季节化后的数据点为 $y'(t_b) = y(t_b) - S(t_b)$ 和 $y'(t_e) = y(t_e) - S(t_e)$。去季节化段的斜率 $m_{deseasoned}$ 为：\n    $$m_{deseasoned} = \\frac{y'(t_e) - y'(t_b)}{t_e - t_b} = \\frac{[y(t_e) - S(t_e)] - [y(t_b) - S(t_b)]}{t_e - t_b}$$\n    整理各项，我们得到：\n    $$m_{deseasoned} = \\frac{y(t_e) - y(t_b) - (S(t_e) - S(t_b))}{t_e - t_b}$$\n    这个斜率代表了所有类趋势分量引起的变化率，在此背景下，它既包括缓慢的既有趋势，也包括由扰动引起的突变。随机项 $\\varepsilon(t)$ 被忽略，因为我们是基于给定的顶点来建模变化率。\n\n3.  **趋势校正与扰动率 $R_d$：** 去季节化的斜率 $m_{deseasoned}$ 是背景趋势和扰动两者变化率的组合。背景趋势的变化率已知为 $b$。因此，为了分离出扰动率 $R_d$，我们必须从去季节化斜率中减去背景趋势的贡献。\n    $$R_d = m_{deseasoned} - b$$\n    代入 $m_{deseasoned}$ 的表达式，我们得到扰动率的最终解析表达式：\n    $$R_d = \\frac{y(t_e) - y(t_b) - (S(t_e) - S(t_b))}{t_e - t_b} - b$$\n    该表达式分离出了仅由扰动引起的变化率，因为它已经校正了季节性波动和既有的线性趋势。\n\n### 数值计算\n\n现在我们将提供的数值代入推导出的表达式。\n给定的参数是：\n- $t_b = 2015.25$ 年\n- $t_e = 2015.75$ 年\n- $y(t_b) = 0.68$\n- $y(t_e) = 0.42$\n- $b = 0.005$ 年$^{-1}$\n- $C = 0.10$\n- $D = 0.05$\n\n首先，我们计算在 $t_b$ 和 $t_e$ 处的季节性分量 $S(t) = C \\cos(2\\pi t) + D \\sin(2\\pi t)$。\n对于 $t_b = 2015.25$：\n$$2\\pi t_b = 2\\pi (2015 + 0.25) = 4030\\pi + \\frac{\\pi}{2}$$\n$$\\cos(2\\pi t_b) = \\cos\\left(4030\\pi + \\frac{\\pi}{2}\\right) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0$$\n$$\\sin(2\\pi t_b) = \\sin\\left(4030\\pi + \\frac{\\pi}{2}\\right) = \\sin\\left(\\frac{\\pi}{2}\\right) = 1$$\n因此，$S(t_b) = C(0) + D(1) = D = 0.05$。\n\n对于 $t_e = 2015.75$：\n$$2\\pi t_e = 2\\pi (2015 + 0.75) = 4030\\pi + \\frac{3\\pi}{2}$$\n$$\\cos(2\\pi t_e) = \\cos\\left(4030\\pi + \\frac{3\\pi}{2}\\right) = \\cos\\left(\\frac{3\\pi}{2}\\right) = 0$$\n$$\\sin(2\\pi t_e) = \\sin\\left(4030\\pi + \\frac{3\\pi}{2}\\right) = \\sin\\left(\\frac{3\\pi}{2}\\right) = -1$$\n因此，$S(t_e) = C(0) + D(-1) = -D = -0.05$。\n\n现在，我们可以计算季节性分量的变化：\n$$S(t_e) - S(t_b) = -0.05 - 0.05 = -0.10$$\n时间间隔是：\n$$t_e - t_b = 2015.75 - 2015.25 = 0.50 \\text{ 年}$$\n观测到的NBR的变化是：\n$$y(t_e) - y(t_b) = 0.42 - 0.68 = -0.26$$\n\n最后，我们将这些值代入 $R_d$ 的表达式中：\n$$R_d = \\frac{-0.26 - (-0.10)}{0.50} - 0.005$$\n$$R_d = \\frac{-0.26 + 0.10}{0.50} - 0.005$$\n$$R_d = \\frac{-0.16}{0.50} - 0.005$$\n$$R_d = -0.32 - 0.005 = -0.325$$\n四舍五入到四位有效数字，扰动率为-0.3250指数单位/年。\n\n### 生态学解释\n\n归一化燃烧指数（NBR）是一种对植被健康和覆盖度敏感的卫星遥感指数，其高值对应于健康、茂密的植被，而低值则表示植被受到胁迫或地面裸露。\n计算出的扰动率 $R_d = -0.3250$ 年$^{-1}$ 是负值，且量级很大。\n\n-   **符号的意义**：负号表示NBR的迅速下降，这在物理上与植被的丧失或胁迫有关。这是扰动的定义性特征。\n\n-   **量级的意义**：观测到的NBR在0.5年内下降了$0.26$。我们的分析将这一变化分解为：\n    -   由于季节性衰老（从晚春到晚秋），预计会下降$0.10$。\n    -   由于缓慢的、既有的正向趋势（例如，森林生长），预计会增加 $b \\times (t_e-t_b) = 0.005 \\times 0.5 = 0.0025$。\n    -   剩余的变化 $-0.26 - (-0.10) - 0.0025 = -0.1625$ 归因于这0.5年内的扰动事件。这对应于我们计算出的年化率 $R_d = -0.1625 / 0.5 = -0.325$。\n\n-   **皆伐与选择性采伐的对比**：\n    -   **选择性采伐** 涉及移除一部分树木，导致树冠覆盖度变稀疏，从而使NBR适度下降。\n    -   **皆伐** 涉及移除几乎所有树木，导致森林冠层被土壤和采伐剩余物急剧取代。这会导致NBR出现剧烈、大幅度的下降。\n\n计算出的扰动率是相当大的。NBR从$0.68$（健康植被）下降到$0.42$，这是一个显著的下降。在对季节和背景趋势进行校正后，这一变化仍然对应于$-0.3250$ 年$^{-1}$的速率，这一事实表明发生了一个严重的、改变林分结构的事件。如此迅速和大量的光合有效生物量的移除，其特征远比典型的选择性采伐作业更符合**皆伐**。该扰动的量级超过了季节周期和既有正向生长趋势的影响。",
            "answer": "$$ \\boxed{-0.3250} $$"
        },
        {
            "introduction": "为特定应用选择合适的算法需要严谨而公平的比较。这最后一个练习要求你像一名研究科学家一样思考，设计一个全面的实验来对BFAST和LandTrendr进行基准测试。它强调了恰当的实验设计、无偏的超参数调整和选择合适的评估指标对于得出有效科学结论的至关重要性，这在面对类别不平衡和时空自相关等现实挑战时尤为关键。",
            "id": "3799336",
            "problem": "一个遥感团队必须对“加性季节和趋势断点分析”（Breaks For Additive Season and Trend, BFAST）和“基于Landsat的干扰和恢复趋势检测”（Landsat-based Detection of Trends in Disturbance and Recovery, LandTrendr）两种算法进行基准测试，以用于检测卫星植被时间序列中的干扰。这两种算法都将反射率衍生指数的时间序列分割成分段平滑的分量，并输出指示推定干扰的断点。假设可以获取温带森林的Level-2 Landsat地表反射率数据、部分事件的辅助干扰范围（包含起火或采伐日期），并且能够通过向真实的无云时间序列中注入已知的阶跃变化来构建合成干扰。该团队必须设计一个公平、统计上有效的实验，该实验能够分离出算法本身的性能，而不是预处理或参数化过程产生的伪影。同时，必须指定能够忠实量化在类别不平衡情况下检测、时间点和幅度性能的评估指标。\n\n根据检测理论和时间序列分解的基本原理，团队认识到单变量指数时间序列 $y_t$ 可以建模为 $y_t = \\mu_t + s_t + d_t + \\varepsilon_t$，其中 $\\mu_t$ 是低频趋势， $s_t$ 是季节性分量（如果使用年度合成数据，则可能不存在），$d_t$ 将干扰编码为水平或斜率的突变，而 $\\varepsilon_t$ 是具有时空自相关的噪声。地面真值事件是具有已知干扰时间 $t^\\ast$ 的像素集合，对于合成情况，还具有已知幅度 $\\Delta y$。任何公平的比较都必须确保可比较的输入表示、无偏的超参数调整，以及能够解释事件时间点标定不确定性和受干扰与未受干扰像素之间严重类别不平衡的性能量化。\n\n哪种实验设计和指标套件最能满足这些要求？\n\nA. 为所有像素构建统一的年度中值归一化燃烧指数（NBR）时间序列，以统一时间分辨率并减少季节性影响。对于合成地面真值，通过对所有 $t^\\ast$ 之后的观测值添加水平偏移，将已知幅度 $\\Delta y$ 的阶跃变化在已知时间 $t^\\ast$ 注入到真实的未受干扰年度序列中，保留经验噪声 $\\varepsilon_t$ 和自相关性。对于真实地面真值，使用独立绘制的野火和采伐范围及其起火或作业日期，并在训练时排除 $t^\\ast$ 周围 $\\pm \\delta t$ 的缓冲区以避免泄露；根据合成不确定性设置 $\\delta t$。在相同的年度序列上运行两种算法，对于年度数据，在BFAST中禁用季节项。使用带有空间分块折叠的嵌套交叉验证来调整超参数，以防止空间泄露；在最终评估前锁定调整好的设置。在 $t^\\ast$ 周围使用一个时间容差窗口 $\\pm \\tau$ 来评估事件级检测，并计算精确率 $=\\frac{TP}{TP+FP}$、召回率 $=\\frac{TP}{TP+FN}$ 和调和平均数 $F_1$。用绝对时间误差 $\\lvert \\hat{t} - t^\\ast\\rvert$ 和延迟 $\\hat{t}-t^\\ast$ 来量化断点时间点标定，对于合成情况，用幅度误差 $\\lvert \\widehat{\\Delta y}-\\Delta y\\rvert$ 来量化幅度。通过算法置信度分数的精确率-召回率曲线下面积（AUPRC）和受试者工作特征（ROC）曲线下面积（AUC）来总结区分能力，报告每个序列的过分割和欠分割率、拟合后残差均方根误差（RMSE）以及计算成本。使用配对统计检验（例如，对匹配的像素-事件结果使用McNemar检验和自助法置信区间）来评估显著性。\n\nB. 生成完全模拟的月度归一化植被指数（NDVI）序列，作为带有偶然阶跃变化的自回归高斯噪声；在月度NDVI上运行BFAST，在年度NBR上运行LandTrendr，以反映典型用法。调整超参数以最大化测试集上的总体准确率。仅通过总体准确率评估性能，当 $\\hat{t}=t^\\ast$ 完全相等时才算作正确检测，并忽略时间和幅度误差，因为它们次要于检测。\n\nC. 使用真实的野火范围，为LandTrendr计算年度NBR，为BFAST计算月度NDVI，允许每种算法在其惯用的指数和频率上运行。通过计算检测到的断点幅度与范围内像素的独立燃烧严重程度之间的皮尔逊相关性进行评估；忽略未受干扰的区域以避免类别不平衡。认为相关性较高的算法更优。\n\nD. 将每个站点的时间序列划分为 $K$ 个连续的时间折叠进行交叉验证，并通过轮换留出的时间折叠在同一站点内进行调整和测试。在折叠间保持像素位置固定以控制空间变异性。仅使用具有零时间容差的 $F_1$ 分数进行评估，仅当 $\\hat{t}=t^\\ast$ 完全相等时才声明为真阳性。为比较不同粒度的分割结果，在计算 $F_1$ 之前，通过对段均值进行无监督聚类来匹配段落。\n\n选择最佳选项。",
            "solution": "问题陈述在科学上是合理的、表述清晰的，并且描述了遥感时间序列分析中一个标准但复杂的任务。它要求设计一个严谨的实验方案，以比较两种断点检测算法BFAST和LandTrendr的性能。如陈述所述，一个有效设计的核心要求是：1）通过统一的输入和无偏的参数调整来确保公平比较；2）采用一套全面的指标来评估检测、时间点和幅度的准确性；3）正确处理类别不平衡、时间点标定不确定性和时空自相关等统计挑战。我们将根据这些标准评估每个选项。\n\n### 逐项分析\n\n**A. 为所有像素构建统一的年度中值归一化燃烧指数（NBR）时间序列，以统一时间分辨率...**\n\n这个选项提出了一个精心设计的实验，该实验遵循了统计验证和遥感实践的最高标准。\n1.  **公平比较：** 它通过使用“为所有像素构建统一的年度中值归一化燃烧指数（NBR）时间序列”正确地建立了公平比较的基础。这确保了两种算法都在完全相同的输入数据上运行，从而将算法性能与数据预处理、指数选择或时间分辨率产生的伪影隔离开来。它还明确指出在使用年度数据时禁用BFAST中的季节模型，这是确保与不模拟季节性的LandTrendr进行同类比较的正确程序。\n2.  **无偏超参数调整：** 提议使用“带有空间分块折叠的嵌套交叉验证”是黄金标准。嵌套交叉验证通过将超参数调整过程与最终模型评估分开，提供了对未见数据性能的无偏估计。“空间分块折叠”正确地解决了提示中提到的时空自相关问题，防止了因在空间上相邻、非独立的像素上进行训练和测试而导致的过于乐观的结果。在最终评估前锁定参数是进行有效推断的关键步骤。\n3.  **全面的指标与不确定性处理：** 该评估框架堪称典范。\n    *   **检测：** 它通过使用`精确率`、`召回率`、`$F_1$`分数，以及最重要的精确率-召回率曲线下面积（`AUPRC`）来解决类别不平衡问题，AUPRC是不平衡检测任务中最具信息量的汇总指标。它还通过在 $t^\\ast$ 周围使用一个“时间容差窗口 $\\pm \\tau$”来考虑事件时间点标定的不确定性，这是一种现实且必要的处理方式。\n    *   **时间点与幅度：** 它为时间点（`绝对时间误差 $\\lvert \\hat{t} - t^\\ast\\rvert$` 和 `延迟 $\\hat{t}-t^\\ast$`）和幅度（`幅度误差 $\\lvert \\widehat{\\Delta y}-\\Delta y\\rvert$`）指定了不同且适当的指标，直接解决了算法性能的多面性问题。\n    *   **补充指标：** 包含`过分割和欠分割率`、`拟合后残差均方根误差（RMSE）`和`计算成本`，为每种算法的行为提供了一个全面而细致的描绘。\n4.  **统计严谨性：** 推荐使用“配对统计检验（例如，McNemar检验...）”是正确的，因为算法在同一数据集上运行，使得观测结果是配对的，需要此类检验来确定性能差异是否具有统计显著性。使用“自助法置信区间”也是量化不确定性的一种稳健方法。\n5.  **地面真值：** 同时使用真实（辅助范围）和合成地面真值是一个强大的组合，它允许在具有已知事件参数（$\\Delta y$, $t^\\ast$）的真实噪声条件（$\\varepsilon_t$）下进行评估。\n\n这个选项是严谨实验设计的教科书式范例。\n\n**结论：正确**\n\n**B. 生成完全模拟的月度归一化植被指数（NDVI）序列，作为自回归高斯噪声...**\n\n这个选项在几个关键方面存在方法论上的缺陷。\n1.  **不公平比较：** 它提议“在月度NDVI上运行BFAST，在年度NBR上运行LandTrendr”。这从根本上违反了公平比较的原则。任何观察到的性能差异都可能归因于不同的时间频率（月度 vs 年度）或不同的光谱指数（NDVI vs NBR），而不是核心算法本身。这个实验是混淆的。\n2.  **无效的超参数调整：** 它建议“调整超参数以最大化测试集上的总体准确率”。这是机器学习和统计学中的一个基本错误，被称为数据泄露或数据窥探。测试集必须被保留，并且只用于最终的、无偏的评估。在测试集上进行调整会产生人为夸大且无效的性能指标。\n3.  **不恰当的指标：** 它仅依赖于“总体准确率”，这对于不平衡数据集来说是一个众所周知的差且具有误导性的指标，因为一个总是预测多数类（无干扰）的平凡分类器可以达到非常高的准确率。此外，要求完全匹配（$\\hat{t}=t^\\ast$）忽略了事件时间点标定中固有且可接受的不确定性。忽略时间和幅度误差则丢弃了关于算法性能的关键信息。\n\n**结论：不正确**\n\n**C. 使用真实的野火范围，为LandTrendr计算年度NBR，为BFAST计算月度NDVI...**\n\n这个选项存在与选项B类似的缺陷，并且其评估策略中还有一个额外的关键错误。\n1.  **不公平比较：** 与选项B一样，使用不同的输入（“为LandTrendr使用年度NBR，为BFAST使用月度NDVI”）使得无法分离出算法本身的性能。这个比较从一开始就是混淆的。\n2.  **无效的评估范围：** 提议“忽略未受干扰的区域以避免类别不平衡”是对问题的灾难性误解。干扰检测算法的一个关键功能是*不要*在稳定的土地上产生误报。通过排除未受干扰的区域，实验无法测量假阳性率（$FP$），从而无法计算精确率或任何相关指标。这只测试了检测问题的一半（对受干扰像素的敏感性），而完全忽略了特异性。\n3.  **不完整的指标：** 仅依赖于“检测到的断点幅度与独立燃烧严重程度之间的皮尔逊相关性”是不够的。这个指标虽然可能作为补充有用，但它完全没有说明事件是否首先被检测到（召回率）、误报率（精确率）或检测时间点的准确性。\n\n**结论：不正确**\n\n**D. 将每个站点的时间序列划分为K个连续的时间折叠进行交叉验证...**\n\n这个选项提出的设计不如选项A稳健和现实。\n1.  **不恰当的交叉验证：** 虽然时间交叉验证在某些情况下是一种有效的技术，但在这里它不是最佳选择。问题陈述明确指出噪声具有“时空自相关性”。时间折叠并未解决这种自相关的空间分量。如选项A所提议的，空间分块交叉验证是处理空间依赖性并对新地理区域的泛化性能产生更现实估计的正确方法。\n2.  **不现实的评估标准：** 与选项B一样，它提出了“零时间容差”（$\\hat{t}=t^\\ast$）的不现实要求，这会因微小、实际上无足轻重的时间误差而不公平地惩罚算法。\n3.  **复杂且不完整的指标：** “仅使用$F_1$分数”进行评估不如选项A中的指标套件全面。提议在计算`$F_1$`分数之前“通过无监督聚类来匹配段落”是一种临时的、过于复杂且非标准的程序。断点检测的功效最好通过直接比较检测到的事件与地面真值事件来评估，而不是通过间接比较段落。这种方法引入了其自身的误差和模糊性来源。\n\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}