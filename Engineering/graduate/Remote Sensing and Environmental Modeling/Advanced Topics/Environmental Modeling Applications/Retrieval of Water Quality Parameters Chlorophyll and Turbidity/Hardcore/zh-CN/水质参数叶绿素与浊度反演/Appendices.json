{
    "hands_on_practices": [
        {
            "introduction": "理解遥感反射率（$R_{rs}$）如何响应水中各组分的变化，是设计有效反演算法的基础。本练习将指导您进行一次敏感性分析，以确定浮游植物吸收与颗粒物后向散射对 $R_{rs}$ 信号的相对影响。通过推导这个敏感性比率，您将深入了解为何某些光谱区域对叶绿素反演更具信息量，而另一些区域则更适合评估浊度 。",
            "id": "3842879",
            "problem": "一个成像光谱仪从上方观测沿海水体，其遥感反射率（RRS，记作$R_{rs}(\\lambda)$）由一个广泛使用的两项展开式建模，该展开式依赖于单一参数$u(\\lambda)$，其中$u(\\lambda)$是总后向散射系数与总吸收系数和总后向散射系数之和的比值。具体来说，假设\n$$\nR_{rs}(\\lambda) = g_{0}\\,u(\\lambda) + g_{1}\\,u(\\lambda)^{2},\n$$\n其中$g_{0}$和$g_{1}$是由几何形状和辐射传输决定的与波长无关的常数，并且\n$$\nu(\\lambda) = \\frac{b_{b}(\\lambda)}{a(\\lambda) + b_{b}(\\lambda)}.\n$$\n总吸收系数$a(\\lambda)$是纯水吸收$a_{w}(\\lambda)$、浮游植物（以叶绿素a为主）吸收$a_{ph}(\\lambda)$以及任何其他背景吸收$a_{bg}(\\lambda)$的总和，因此$a(\\lambda) = a_{w}(\\lambda) + a_{ph}(\\lambda) + a_{bg}(\\lambda)$。总后向散射系数是纯水后向散射$b_{bw}(\\lambda)$和与浊度相关的颗粒物后向散射$b_{bp}(\\lambda)$的总和，因此$b_{b}(\\lambda) = b_{bw}(\\lambda) + b_{bp}(\\lambda)$。将$a_{ph}(\\lambda)$和$b_{bp}(\\lambda)$视为独立的控制变量，可以在固定的$\\lambda$下进行扰动，而所有其他项保持不变。\n\n从这些定义和标准微积分出发，推导灵敏度比的解析表达式\n$$\nS(\\lambda) = \\frac{\\partial R_{rs}(\\lambda)/\\partial a_{ph}(\\lambda)}{\\partial R_{rs}(\\lambda)/\\partial b_{bp}(\\lambda)}.\n$$\n您的推导必须从给定的$R_{rs}(\\lambda)$–$u(\\lambda)$关系开始，并且只能使用一般性原理（例如，链式法则），不得使用任何快捷恒等式。请将您的最终答案表示为固有光学特性$a(\\lambda)$和$b_{b}(\\lambda)$的单个闭式、无量纲函数。不需要进行数值计算；不要为任何常数代入数值。在找到$S(\\lambda)$之后，请基于$S(\\lambda)$的符号和大小以及$a_{w}(\\lambda)$、$a_{ph}(\\lambda)$和$b_{bp}(\\lambda)$的普遍观测到的光谱行为，解释哪些波长区域对于叶绿素吸收与浊度的信息最丰富。最终报告的答案必须仅为$S(\\lambda)$的解析表达式，不带单位。无需四舍五入。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n步骤 1：提取已知条件\n已知条件如下：\n- 遥感反射率模型：$R_{rs}(\\lambda) = g_{0}\\,u(\\lambda) + g_{1}\\,u(\\lambda)^{2}$\n- 常数：$g_{0}$ 和 $g_{1}$ 与波长无关。\n- $u(\\lambda)$ 的定义：$u(\\lambda) = \\frac{b_{b}(\\lambda)}{a(\\lambda) + b_{b}(\\lambda)}$\n- 总吸收系数 $a(\\lambda)$ 的定义：$a(\\lambda) = a_{w}(\\lambda) + a_{ph}(\\lambda) + a_{bg}(\\lambda)$\n- 总后向散射系数 $b_{b}(\\lambda)$ 的定义：$b_{b}(\\lambda) = b_{bw}(\\lambda) + b_{bp}(\\lambda)$\n- 用于扰动的独立控制变量：$a_{ph}(\\lambda)$ 和 $b_{bp}(\\lambda)$。\n- 扰动期间的固定量：$a_{w}(\\lambda)$、$a_{bg}(\\lambda)$、$b_{bw}(\\lambda)$。\n- 推导的目标量：灵敏度比 $S(\\lambda) = \\frac{\\partial R_{rs}(\\lambda)/\\partial a_{ph}(\\lambda)}{\\partial R_{rs}(\\lambda)/\\partial b_{bp}(\\lambda)}$。\n- 最终表达式的格式要求：一个关于固有光学特性 $a(\\lambda)$ 和 $b_{b}(\\lambda)$ 的单个闭式、无量纲函数。\n- 附加任务：解释 $S(\\lambda)$ 如何确定哪些波长区域对于叶绿素吸收与浊度的信息最丰富。\n\n步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** $R_{rs}(\\lambda)$ 的模型是海洋光学中一个公认的半解析模型，源自辐射传输理论近似。将固有光学特性（$a(\\lambda)$ 和 $b_b(\\lambda)$）分解为其组成部分是水生生物光学中的标准方法。该问题具有科学合理性。\n- **适定性：** 问题要求从一组给定的方程和明确定义的变量中推导一个数学表达式。所需的操作（偏微分、链式法则）是标准的数学程序。存在唯一的解析解。\n- **客观性：** 问题陈述使用了精确、正式且无偏见的科学语言。\n- **不完整或矛盾的设置：** 问题提供了执行推导所需的所有必要定义和约束。它清楚地说明了哪些变量是独立的，哪些需要保持不变。没有矛盾之处。\n- **不切实际或不可行：** 该物理模型和数学设置代表了环境遥感中一个标准但简化的情景。在其理论背景下是完全现实的。\n- **不适定或结构不良：** 术语定义清晰，目标明确。\n\n步骤 3：结论与行动\n该问题是**有效的**。这是一个在遥感和环境建模领域中适定且有科学依据的问题。我将继续进行推导。\n\n目标是推导灵敏度比 $S(\\lambda)$ 的解析表达式。\n$$\nS(\\lambda) = \\frac{\\partial R_{rs}(\\lambda)/\\partial a_{ph}(\\lambda)}{\\partial R_{rs}(\\lambda)/\\partial b_{bp}(\\lambda)}\n$$\n遥感反射率 $R_{rs}(\\lambda)$ 是 $u(\\lambda)$ 的函数，而 $u(\\lambda)$ 又是 $a(\\lambda)$ 和 $b_b(\\lambda)$ 的函数。总吸收 $a(\\lambda)$ 是浮游植物吸收 $a_{ph}(\\lambda)$ 的函数，总后向散射 $b_b(\\lambda)$ 是颗粒物后向散射 $b_{bp}(\\lambda)$ 的函数。我们必须应用偏微分的链式法则。\n\n我们首先分析分子：$\\frac{\\partial R_{rs}}{\\partial a_{ph}}$。我们按如下方式应用链式法则：\n$$\n\\frac{\\partial R_{rs}}{\\partial a_{ph}} = \\frac{d R_{rs}}{d u} \\frac{\\partial u}{\\partial a} \\frac{\\partial a}{\\partial a_{ph}}\n$$\n我们现在计算这个乘积中的每一项。\n\n首先，$R_{rs}$ 对 $u$ 的导数：\n给定 $R_{rs}(\\lambda) = g_{0}\\,u(\\lambda) + g_{1}\\,u(\\lambda)^{2}$，\n$$\n\\frac{d R_{rs}}{d u} = g_{0} + 2g_{1}u(\\lambda)\n$$\n\n其次，$u$ 对 $a$ 的偏导数：\n给定 $u(\\lambda) = \\frac{b_{b}(\\lambda)}{a(\\lambda) + b_{b}(\\lambda)}$，对于此偏导数，我们将 $b_{b}$ 视为常数。\n$$\n\\frac{\\partial u}{\\partial a} = \\frac{\\partial}{\\partial a} \\left[ b_{b} (a + b_{b})^{-1} \\right] = b_{b} \\cdot (-1) (a + b_{b})^{-2} \\cdot \\frac{\\partial}{\\partial a}(a+b_b) = -b_{b} (a + b_{b})^{-2} \\cdot 1 = -\\frac{b_{b}}{(a + b_{b})^{2}}\n$$\n为简洁起见，在上下文中明确的情况下，我们将省略对 $\\lambda$ 的显式依赖，因此 $a=a(\\lambda)$ 且 $b_b=b_b(\\lambda)$。\n\n第三，$a$ 对 $a_{ph}$ 的偏导数：\n给定 $a(\\lambda) = a_{w}(\\lambda) + a_{ph}(\\lambda) + a_{bg}(\\lambda)$，并将 $a_w$ 和 $a_{bg}$ 视为常数，\n$$\n\\frac{\\partial a}{\\partial a_{ph}} = \\frac{\\partial}{\\partial a_{ph}} [a_{w} + a_{ph} + a_{bg}] = 1\n$$\n结合这些项，$S(\\lambda)$ 的分子是：\n$$\n\\frac{\\partial R_{rs}}{\\partial a_{ph}} = (g_{0} + 2g_{1}u) \\left( -\\frac{b_{b}}{(a + b_{b})^{2}} \\right) (1) = -(g_{0} + 2g_{1}u) \\frac{b_{b}}{(a + b_{b})^{2}}\n$$\n接下来，我们分析 $S(\\lambda)$ 的分母：$\\frac{\\partial R_{rs}}{\\partial b_{bp}}$。我们再次应用链式法则：\n$$\n\\frac{\\partial R_{rs}}{\\partial b_{bp}} = \\frac{d R_{rs}}{d u} \\frac{\\partial u}{\\partial b_{b}} \\frac{\\partial b_{b}}{\\partial b_{bp}}\n$$\n第一项 $\\frac{d R_{rs}}{d u}$ 和之前一样。我们计算另外两项。\n\n首先，$u$ 对 $b_b$ 的偏导数：\n给定 $u(\\lambda) = \\frac{b_{b}(\\lambda)}{a(\\lambda) + b_{b}(\\lambda)}$，我们将 $a$ 视为常数，并使用商法则。\n$$\n\\frac{\\partial u}{\\partial b_{b}} = \\frac{(\\frac{\\partial}{\\partial b_b} b_b)(a+b_b) - b_b(\\frac{\\partial}{\\partial b_b}(a+b_b))}{(a+b_b)^2} = \\frac{1 \\cdot (a+b_b) - b_b \\cdot 1}{(a+b_b)^2} = \\frac{a}{(a+b_b)^2}\n$$\n\n其次，$b_b$ 对 $b_{bp}$ 的偏导数：\n给定 $b_{b}(\\lambda) = b_{bw}(\\lambda) + b_{bp}(\\lambda)$，并将 $b_{bw}$ 视为常数，\n$$\n\\frac{\\partial b_{b}}{\\partial b_{bp}} = \\frac{\\partial}{\\partial b_{bp}} [b_{bw} + b_{bp}] = 1\n$$\n结合这些项，$S(\\lambda)$ 的分母是：\n$$\n\\frac{\\partial R_{rs}}{\\partial b_{bp}} = (g_{0} + 2g_{1}u) \\left( \\frac{a}{(a + b_{b})^{2}} \\right) (1) = (g_{0} + 2g_{1}u) \\frac{a}{(a + b_{b})^{2}}\n$$\n最后，我们计算比率 $S(\\lambda)$：\n$$\nS(\\lambda) = \\frac{\\frac{\\partial R_{rs}}{\\partial a_{ph}}}{\\frac{\\partial R_{rs}}{\\partial b_{bp}}} = \\frac{-(g_{0} + 2g_{1}u) \\frac{b_{b}}{(a + b_{b})^{2}}}{(g_{0} + 2g_{1}u) \\frac{a}{(a + b_{b})^{2}}}\n$$\n项 $(g_{0} + 2g_{1}u)$ 代表 $\\frac{d R_{rs}}{d u}$，对于任何反射率对水体成分敏感的物理上有意义的模型，该项都是非零的。该项从分子和分母中消去。项 $\\frac{1}{(a + b_{b})^{2}}$ 也消去。剩下：\n$$\nS(\\lambda) = \\frac{-b_{b}(\\lambda)}{a(\\lambda)}\n$$\n这是灵敏度比的最终解析表达式。根据要求，它是一个关于 $a(\\lambda)$ 和 $b_b(\\lambda)$ 的无量纲函数。\n\n对于问题的第二部分，我们分析 $S(\\lambda)$ 的含义。比率 $S(\\lambda) = -b_b(\\lambda)/a(\\lambda)$ 有两个关键特征：其符号和其大小。\n符号始终为负，因为 $a(\\lambda)$ 和 $b_b(\\lambda)$ 是正定的物理量。这表明浮游植物吸收（$a_{ph}$）的增加和颗粒物后向散射（$b_{bp}$）的增加对离水信号 $R_{rs}$ 有相反的影响。具体来说，增加吸收会使水体变暗并降低 $R_{rs}$，而增加散射会使水体变亮并增加 $R_{rs}$。\n\n大小 $|S(\\lambda)| = \\frac{b_b(\\lambda)}{a(\\lambda)}$ 是 $R_{rs}$ 对 $a_{ph}$ 单位变化的灵敏度与对 $b_{bp}$ 单位变化的灵敏度之比。\n- 如果 $|S(\\lambda)| \\ll 1$，即 $b_b(\\lambda) \\ll a(\\lambda)$，那么 $R_{rs}$ 对后向散射（$b_{bp}$）的变化比对吸收（$a_{ph}$）的变化更敏感。这些波长区域对于浊度的信息最丰富。这个条件，$a(\\lambda) \\gg b_b(\\lambda)$，是近红外（NIR）光谱（例如 $\\lambda > 750\\,\\mathrm{nm}$）的特征，在该区域纯水的吸收 $a_w(\\lambda)$ 变得非常大并主导总吸收 $a(\\lambda)$。因此，NIR波长通常用于反演浊度，因为反射信号几乎完全是散射在黑暗、高吸收背景下的函数。\n- 如果 $|S(\\lambda)| > 1$，即 $b_b(\\lambda) > a(\\lambda)$，那么 $R_{rs}$ 对浮游植物吸收（$a_{ph}$）的变化比对后向散射（$b_{bp}$）的变化更敏感。这些波长区域对于叶绿素的信息最丰富。这个条件，$b_b(\\lambda) > a(\\lambda)$，发生在总吸收较低的光谱区域。在清澈的海洋水体中，这可能发生在光谱的蓝绿部分。然而，叶绿素的实际反演还取决于 $a_{ph}(\\lambda)$ 的光谱特征是否显著。标准算法通过将叶绿素在蓝色波段（例如440 nm附近）的强吸收与叶绿素吸收最小的绿色波段（例如550 nm附近）的反射率形成比值来利用这一点。\n- 如果 $|S(\\lambda)| \\approx 1$，或 $b_b(\\lambda) \\approx a(\\lambda)$，则灵敏度相当。这使得难以明确地区分叶绿素和浊度的影响，这是近岸和内陆水体遥感中的一个常见问题，特别是在光谱的绿色部分。",
            "answer": "$$\n\\boxed{-\\frac{b_{b}(\\lambda)}{a(\\lambda)}}\n$$"
        },
        {
            "introduction": "只有当传感器能够探测到信号变化时，反射率对水质参数的理论敏感性才有实际意义。本练习将生物光学理论与仪器规格联系起来，探讨传感器信噪比（SNR）与反演不确定性之间的关系。您将计算在一个关键的蓝色波段上达到叶绿素浓度目标精度所需的最低信噪比，这是为海洋水色卫星定义任务需求的关键一步 。",
            "id": "3842865",
            "problem": "使用科研级海洋水色传感器，通过蓝色波段的遥感反射率来反演叶绿素浓度。考虑近水面、水上遥感反射率，其定义为 $R_{rs}(\\lambda) = L_{w}(\\lambda)/E_{d}(\\lambda)$，其中 $L_{w}(\\lambda)$ 是离水辐亮度，$E_{d}(\\lambda)$ 是向下辐照度。假设在中心波长为 $\\lambda = 443\\,\\text{nm}$ 的蓝色波段，与离水辐亮度的不确定度相比，向下辐照度的不确定度可以忽略不计，并且 $L_{w}(443)$ 中的测量噪声由信噪比（SNR）来表征，其定义为 $\\mathrm{SNR} = L_{w}(443)/\\sigma_{L_{w}(443)}$，其中 $\\sigma_{L_{w}(443)}$ 是零均值加性噪声的标准差。在这些假设下，$R_{rs}(443)$ 的不确定度满足 $\\sigma_{R_{rs}(443)} \\approx R_{rs}(443)/\\mathrm{SNR}$。\n\n为了模拟 $R_{rs}(443)$ 对叶绿素的敏感性，采用由辐射传输推导出的、经过充分检验的离水反射率两项近似模型：\n$$\nR_{rs}(\\lambda) \\approx g_{0}\\,u(\\lambda) + g_{1}\\,u(\\lambda)^{2},\n$$\n其中 $u(\\lambda) = \\dfrac{b_{b}(\\lambda)}{a(\\lambda) + b_{b}(\\lambda)}$，$a(\\lambda)$ 是总吸收系数，$b_{b}(\\lambda)$ 是总后向散射系数，$g_{0}$ 和 $g_{1}$ 是半经验的、与波长无关的系数。假设在 $\\lambda = 443\\,\\text{nm}$ 处有：\n- $g_{0} = 0.0949$, $g_{1} = 0.0794$。\n- 总吸收分解为 $a(443) = a_{w}(443) + a_{\\mathrm{CDOM}}(443) + a_{\\mathrm{ph}}(443)$，其中 $a_{w}(443) = 0.0070\\,\\text{m}^{-1}$ 是纯水吸收，$a_{\\mathrm{CDOM}}(443) = 0.0100\\,\\text{m}^{-1}$ 是有色可溶性有机物吸收，浮游植物吸收遵循 $a_{\\mathrm{ph}}(443) = a_{\\mathrm{ph}}^{*}(443)\\,\\mathrm{Chl}$，其中 $a_{\\mathrm{ph}}^{*}(443) = 0.040\\,\\text{m}^{2}\\,\\text{mg}^{-1}$ 是在 $443\\,\\text{nm}$ 处的叶绿素比吸收系数。\n- 在 $443\\,\\text{nm}$ 处的总后向散射为 $b_{b}(443) = 0.0010\\,\\text{m}^{-1}$，并且在本文考虑的贫营养状态下，其在局部对 $\\mathrm{Chl}$ 不敏感。\n- 真实的叶绿素浓度为 $\\mathrm{Chl} = 0.200\\,\\text{mg}\\,\\text{m}^{-3}$。\n\n假设在所述条件附近进行单波段局部线性反演，因此叶绿素不确定度通过一阶误差传播与反射率不确定度相关，即 $\\sigma_{\\mathrm{Chl}} \\approx \\sigma_{R_{rs}(443)} / \\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|$。任务要求规定叶绿素反演的目标相对不确定度为 $\\sigma_{\\mathrm{Chl}}/\\mathrm{Chl} = 0.10$。\n\n从第一性原理推导连接 $\\mathrm{SNR}$ 与目标相对不确定度的表达式，该连接通过 $R_{rs}(443)$ 对 $\\mathrm{Chl}$ 的敏感性建立；使用给定参数对其进行求值，并计算在 $443\\,\\text{nm}$ 处为达到目标不确定度所需的最小 $\\mathrm{SNR}$。将最终的 $\\mathrm{SNR}$ 表示为无量纲数，并将最终结果四舍五入到四位有效数字。",
            "solution": "该问题要求计算在 $\\lambda = 443\\,\\text{nm}$ 处，传感器为达到指定的叶绿素浓度（$\\mathrm{Chl}$）目标相对不确定度所需的最小信噪比（$\\mathrm{SNR}$）。\n\n求解过程分为三个主要步骤：\n1.  通过组合给定的不确定度关系式，推导出所需 $\\mathrm{SNR}$ 的正式表达式。\n2.  在指定条件下，计算必要的量，即遥感反射率 $R_{rs}(443)$ 及其对叶绿素的敏感度 $\\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}}$。\n3.  将计算出的数值代入 $\\mathrm{SNR}$ 的表达式中，得到最终的数值结果。\n\n首先，我们建立 $\\mathrm{SNR}$ 与叶绿素不确定度之间的关系。题目给出了两个关于不确定度传播的关键近似式：\n叶绿素不确定度 $\\sigma_{\\mathrm{Chl}}$ 与反射率不确定度 $\\sigma_{R_{rs}(443)}$ 的关系为：\n$$\n\\sigma_{\\mathrm{Chl}} \\approx \\frac{\\sigma_{R_{rs}(443)}}{\\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|}\n$$\n反射率不确定度与传感器的 $\\mathrm{SNR}$ 的关系为：\n$$\n\\sigma_{R_{rs}(443)} \\approx \\frac{R_{rs}(443)}{\\mathrm{SNR}}\n$$\n将第二个表达式代入第一个表达式，得到以 $\\mathrm{SNR}$ 表示的叶绿素不确定度：\n$$\n\\sigma_{\\mathrm{Chl}} \\approx \\frac{R_{rs}(443)/\\mathrm{SNR}}{\\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|} = \\frac{1}{\\mathrm{SNR}} \\frac{R_{rs}(443)}{\\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|}\n$$\n题目指定了目标相对不确定度 $U_{rel} = \\dfrac{\\sigma_{\\mathrm{Chl}}}{\\mathrm{Chl}} = 0.10$。我们可以重排上述方程来求解 $\\mathrm{SNR}$：\n$$\n\\frac{\\sigma_{\\mathrm{Chl}}}{\\mathrm{Chl}} = U_{rel} \\approx \\frac{1}{\\mathrm{SNR}} \\frac{R_{rs}(443)}{\\mathrm{Chl} \\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|}\n$$\n$$\n\\mathrm{SNR} \\approx \\frac{1}{U_{rel}} \\frac{R_{rs}(443)}{\\mathrm{Chl} \\left| \\dfrac{\\partial R_{rs}(443)}{\\partial \\mathrm{Chl}} \\right|}\n$$\n这就是连接 $\\mathrm{SNR}$ 与目标不确定度的表达式。为了对其求值，我们必须计算在给定叶绿素浓度 $\\mathrm{Chl} = 0.200\\,\\text{mg}\\,\\text{m}^{-3}$ 下的 $R_{rs}(443)$ 及其导数。为简化符号，在中间步骤中将省略显式的波长依赖性 $(443)$。\n\n总吸收 $a$ 是其各组分之和：\n$a = a_{w} + a_{\\mathrm{CDOM}} + a_{\\mathrm{ph}}$。\n浮游植物吸收 $a_{\\mathrm{ph}}$ 取决于叶绿素浓度：$a_{\\mathrm{ph}} = a_{\\mathrm{ph}}^{*} \\cdot \\mathrm{Chl}$。\n令 $a_{non-alg} = a_{w} + a_{\\mathrm{CDOM}}$ 为非藻类组分的吸收。已知条件为：\n$a_{w} = 0.0070\\,\\text{m}^{-1}$\n$a_{\\mathrm{CDOM}} = 0.0100\\,\\text{m}^{-1}$\n$a_{\\mathrm{ph}}^{*} = 0.040\\,\\text{m}^{2}\\,\\text{mg}^{-1}$\n$b_{b} = 0.0010\\,\\text{m}^{-1}$\n$\\mathrm{Chl} = 0.200\\,\\text{mg}\\,\\text{m}^{-3}$\n\n我们首先计算总吸收 $a$：\n$a_{non-alg} = 0.0070\\,\\text{m}^{-1} + 0.0100\\,\\text{m}^{-1} = 0.0170\\,\\text{m}^{-1}$。\n$a_{\\mathrm{ph}} = (0.040\\,\\text{m}^{2}\\,\\text{mg}^{-1}) \\cdot (0.200\\,\\text{mg}\\,\\text{m}^{-3}) = 0.0080\\,\\text{m}^{-1}$。\n$a = a_{non-alg} + a_{\\mathrm{ph}} = 0.0170\\,\\text{m}^{-1} + 0.0080\\,\\text{m}^{-1} = 0.0250\\,\\text{m}^{-1}$。\n\n接下来，我们计算变量 $u = \\dfrac{b_{b}}{a + b_{b}}$：\n$a + b_{b} = 0.0250\\,\\text{m}^{-1} + 0.0010\\,\\text{m}^{-1} = 0.0260\\,\\text{m}^{-1}$。\n$u = \\dfrac{0.0010}{0.0260} = \\dfrac{1}{26}$。\n\n现在，我们使用系数 $g_{0} = 0.0949$ 和 $g_{1} = 0.0794$ 来计算遥感反射率 $R_{rs} \\approx g_{0}\\,u + g_{1}\\,u^{2}$：\n$R_{rs} = (0.0949) \\cdot \\left(\\dfrac{1}{26}\\right) + (0.0794) \\cdot \\left(\\dfrac{1}{26}\\right)^{2}$\n$R_{rs} = \\dfrac{0.0949}{26} + \\dfrac{0.0794}{676} = \\dfrac{0.0949 \\cdot 26 + 0.0794}{676} = \\dfrac{2.4674 + 0.0794}{676} = \\dfrac{2.5468}{676} \\approx 0.0037674556$。\n\n下一步是求导数 $\\dfrac{\\partial R_{rs}}{\\partial \\mathrm{Chl}}$。我们使用链式法则：\n$\\dfrac{\\partial R_{rs}}{\\partial \\mathrm{Chl}} = \\dfrac{\\partial R_{rs}}{\\partial u} \\cdot \\dfrac{\\partial u}{\\partial \\mathrm{Chl}}$。\n\n链式法则的第一部分是 $\\dfrac{\\partial R_{rs}}{\\partial u}$：\n$\\dfrac{\\partial R_{rs}}{\\partial u} = \\dfrac{\\partial}{\\partial u} (g_{0}u + g_{1}u^{2}) = g_{0} + 2g_{1}u$。\n对此进行求值：\n$\\dfrac{\\partial R_{rs}}{\\partial u} = 0.0949 + 2 \\cdot (0.0794) \\cdot \\left(\\dfrac{1}{26}\\right) = 0.0949 + \\dfrac{0.1588}{26} = \\dfrac{0.0949 \\cdot 26 + 0.1588}{26} = \\dfrac{2.4674 + 0.1588}{26} = \\dfrac{2.6262}{26}$。\n\n链式法则的第二部分是 $\\dfrac{\\partial u}{\\partial \\mathrm{Chl}}$。我们再次应用链式法则：$\\dfrac{\\partial u}{\\partial \\mathrm{Chl}} = \\dfrac{\\partial u}{\\partial a} \\cdot \\dfrac{\\partial a}{\\partial \\mathrm{Chl}}$。\n$\\dfrac{\\partial a}{\\partial \\mathrm{Chl}} = \\dfrac{\\partial}{\\partial \\mathrm{Chl}}(a_{non-alg} + a_{\\mathrm{ph}}^{*} \\cdot \\mathrm{Chl}) = a_{\\mathrm{ph}}^{*}$。\n$\\dfrac{\\partial u}{\\partial a} = \\dfrac{\\partial}{\\partial a}\\left(\\dfrac{b_{b}}{a+b_{b}}\\right) = -\\dfrac{b_{b}}{(a+b_{b})^{2}}$。\n将它们组合起来得到：\n$\\dfrac{\\partial u}{\\partial \\mathrm{Chl}} = -\\dfrac{b_{b} \\cdot a_{\\mathrm{ph}}^{*}}{(a+b_{b})^{2}}$。\n对此进行求值：\n$\\dfrac{\\partial u}{\\partial \\mathrm{Chl}} = -\\dfrac{(0.0010) \\cdot (0.040)}{(0.0260)^{2}} = -\\dfrac{0.00004}{0.000676} = -\\dfrac{400}{6760} = -\\dfrac{10}{169}$。\n\n现在我们组合各个部分，求出反射率的全导数：\n$\\dfrac{\\partial R_{rs}}{\\partial \\mathrm{Chl}} = \\left(\\dfrac{2.6262}{26}\\right) \\cdot \\left(-\\dfrac{10}{169}\\right) = -\\dfrac{26.262}{26 \\cdot 169} = -\\dfrac{26.262}{4394} \\approx -0.0059767865$。\n正如预期的那样，导数为负，表明反射率随叶绿素的增加而减小。其绝对值为 $|\\dfrac{\\partial R_{rs}}{\\partial \\mathrm{Chl}}| = \\dfrac{26.262}{4394}$。\n\n最后，我们将所有计算出的值代入 $\\mathrm{SNR}$ 的表达式中：\n$\\mathrm{SNR} \\approx \\dfrac{1}{U_{rel}} \\frac{R_{rs}}{\\mathrm{Chl} \\left| \\dfrac{\\partial R_{rs}}{\\partial \\mathrm{Chl}} \\right|} = \\dfrac{1}{0.10} \\cdot \\dfrac{\\dfrac{2.5468}{676}}{(0.200) \\cdot \\left(\\dfrac{26.262}{4394}\\right)}$。\n$\\mathrm{SNR} \\approx 10 \\cdot \\dfrac{\\dfrac{2.5468}{676}}{\\dfrac{5.2524}{4394}} = 10 \\cdot \\dfrac{2.5468}{676} \\cdot \\dfrac{4394}{5.2524}$。\n使用 $676 = 26^2$ 和 $4394 = 26 \\cdot 169$：\n$\\mathrm{SNR} \\approx 10 \\cdot \\dfrac{2.5468}{26^2} \\cdot \\dfrac{26 \\cdot 169}{5.2524} = 10 \\cdot \\dfrac{2.5468 \\cdot 169}{26 \\cdot 5.2524} = 10 \\cdot \\dfrac{430.4092}{136.5624} \\approx 10 \\cdot 3.15183$。\n$\\mathrm{SNR} \\approx 31.5183$。\n\n题目要求将结果四舍五入到四位有效数字。\n$\\mathrm{SNR} \\approx 31.52$。",
            "answer": "$$\\boxed{31.52}$$"
        },
        {
            "introduction": "同时反演多种水质参数是一个经典的反问题，其解可能不唯一或高度相关。本练习使用贝叶斯框架深入探讨不确定性量化的核心，这是一种评估反演结果可靠性的强大方法。通过分析对数后验概率的Hessian矩阵，您将计算叶绿素和浊度估算值的后验协方差与相关性，从而揭示在给定测量数据和先验知识的情况下，这两种参数能被区分开来的程度 。",
            "id": "3842830",
            "problem": "一个高光谱传感器观测一个沿海水体，目标是反演两个生物地球化学参数：叶绿素浓度 $C$（单位为 $\\mathrm{mg}\\,\\mathrm{m}^{-3}$）和浊度 $T$（单位为福尔马肼散射单位）。为了强制参数为正并对推断进行正则化，反演使用参数向量 $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$，其中 $x_{1} = \\ln C$ 和 $x_{2} = \\ln T$。前向模型 $f(x)$ 预测两个波长（$665\\,\\mathrm{nm}$ 和 $705\\,\\mathrm{nm}$）的离水反射率，记为向量 $r = \\begin{pmatrix} r_{665} \\\\ r_{705} \\end{pmatrix}$。测量误差被建模为零均值高斯分布，其协方差为 $\\Sigma_{\\epsilon}$，而 $x$ 的先验分布是均值为 $\\mu$、协方差为 $\\Sigma_{\\mathrm{prior}}$ 的高斯分布。最大后验（MAP）状态 $x^{\\ast}$ 已被找到，前向模型在 $x^{\\ast}$ 处的雅可比矩阵由下式给出\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial r_{665}}{\\partial x_{1}}  \\frac{\\partial r_{665}}{\\partial x_{2}} \\\\\n\\frac{\\partial r_{705}}{\\partial x_{1}}  \\frac{\\partial r_{705}}{\\partial x_{2}}\n\\end{pmatrix}\\Bigg|_{x^{\\ast}}\n=\n\\begin{pmatrix}\n-0.0020  0.0060 \\\\\n0.0045  0.0055\n\\end{pmatrix}.\n$$\n测量误差协方差是对角的，\n$$\n\\Sigma_{\\epsilon} = \\begin{pmatrix}\n(8.0 \\times 10^{-4})^{2}  0 \\\\\n0  (1.0 \\times 10^{-3})^{2}\n\\end{pmatrix},\n$$\n且先验协方差是对角的，\n$$\n\\Sigma_{\\mathrm{prior}} = \\begin{pmatrix}\n1.0^{2}  0 \\\\\n0  0.8^{2}\n\\end{pmatrix}.\n$$\n假设在 $x^{\\ast}$ 附近模型是局部线性的 $f(x) \\approx f(x^{\\ast}) + J(x - x^{\\ast})$，且服从高斯统计。从高斯误差和高斯先验的负对数后验概率的定义出发，并使用在 $x^{\\ast}$ 附近的一阶泰勒展开，推导出负对数后验概率在 $x^{\\ast}$ 处的黑塞矩阵。然后，使用此黑塞矩阵，计算 $x$ 的后验协方差以及 $x_{1}$ 和 $x_{2}$ 之间的后验相关系数。将最终的相关系数四舍五入到四位有效数字，并以纯数（无单位）形式表示。",
            "solution": "用户希望在一个贝叶斯推断框架中，找到两个参数 $x_1 = \\ln C$ 和 $x_2 = \\ln T$ 之间的后验相关系数。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件：**\n- 参数向量：$x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$，其中 $x_{1} = \\ln C$ 和 $x_{2} = \\ln T$。\n- 前向模型：$f(x)$ 预测反射率向量 $r = \\begin{pmatrix} r_{665} \\\\ r_{705} \\end{pmatrix}$。\n- 测量误差：零均值高斯分布，协方差为 $\\Sigma_{\\epsilon}$。\n- $x$ 的先验：均值为 $\\mu$、协方差为 $\\Sigma_{\\mathrm{prior}}$ 的高斯分布。\n- 前向模型在最大后验状态 $x^{\\ast}$ 处的雅可比矩阵：\n$$\nJ = \\begin{pmatrix}\n-0.0020  0.0060 \\\\\n0.0045  0.0055\n\\end{pmatrix}\n$$\n- 测量误差协方差：\n$$\n\\Sigma_{\\epsilon} = \\begin{pmatrix}\n(8.0 \\times 10^{-4})^{2}  0 \\\\\n0  (1.0 \\times 10^{-3})^{2}\n\\end{pmatrix} = \\begin{pmatrix}\n6.4 \\times 10^{-7}  0 \\\\\n0  1.0 \\times 10^{-6}\n\\end{pmatrix}\n$$\n- 先验协方差：\n$$\n\\Sigma_{\\mathrm{prior}} = \\begin{pmatrix}\n1.0^{2}  0 \\\\\n0  0.8^{2}\n\\end{pmatrix} = \\begin{pmatrix}\n1.0  0 \\\\\n0  0.64\n\\end{pmatrix}\n$$\n- 假设：在 $x^{\\ast}$ 附近模型是局部线性的 $f(x) \\approx f(x^{\\ast}) + J(x - x^{\\ast})$，且误差和先验服从高斯统计。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题描述了贝叶斯最大后验（MAP）估计在遥感参数反演中的一个标准应用。使用对数变换的参数、高斯先验和似然以及用于不确定性分析的局部线性化，都是该领域的成熟技术。该问题具有科学合理性。\n- **适定性：** 所有必要的数据（雅可比矩阵、协方差矩阵）和假设（局部线性、高斯统计）都已明确给出，可以推导出后验协方差和相关性的唯一解。\n- **客观性：** 该问题使用精确的数学语言和定义进行陈述，没有歧义或主观性陈述。\n\n**1.3. 结论与行动：**\n问题有效。将提供完整的解决方案。\n\n### 第 2 步：求解推导\n\n给定测量值 $r$ 的参数 $x$ 的后验概率分布，记为 $p(x|r)$，由贝叶斯定理给出：\n$$\np(x|r) \\propto p(r|x) p(x)\n$$\n其中 $p(r|x)$ 是似然函数，$p(x)$ 是先验分布。负对数后验概率在 MAP 估计中作为成本函数 $L(x)$，其形式为：\n$$\nL(x) = -\\ln(p(r|x)) - \\ln(p(x)) + \\text{constant}\n$$\n给定测量噪声和先验的高斯假设，成本函数为：\n$$\nL(x) = \\frac{1}{2} [r - f(x)]^T \\Sigma_{\\epsilon}^{-1} [r - f(x)] + \\frac{1}{2} [x - \\mu]^T \\Sigma_{\\mathrm{prior}}^{-1} [x - \\mu]\n$$\n问题要求此成本函数的黑塞矩阵。黑塞矩阵 $H(x)$ 是 $L(x)$ 的二阶偏导数矩阵。其一般形式为：\n$$\nH(x) = J(x)^T \\Sigma_{\\epsilon}^{-1} J(x) - \\sum_{k} \\left[ \\Sigma_{\\epsilon}^{-1}(r - f(x)) \\right]_k \\nabla^2 f_k(x) + \\Sigma_{\\mathrm{prior}}^{-1}\n$$\n其中 $J(x)$ 是 $f(x)$ 的雅可比矩阵，$\\nabla^2 f_k(x)$ 是前向模型第 $k$ 个分量的黑塞矩阵。\n\n问题陈述假设模型是局部线性的，$f(x) \\approx f(x^{\\ast}) + J(x - x^{\\ast})$。这一近似意味着前向模型各分量的二阶导数为零，即 $\\nabla^2 f_k(x) = 0$。因此，在 MAP 估计值 $x^{\\ast}$ 处计算的黑塞矩阵简化为：\n$$\nH = J^T \\Sigma_{\\epsilon}^{-1} J + \\Sigma_{\\mathrm{prior}}^{-1}\n$$\n其中 $J$ 是在 $x^{\\ast}$ 处计算的雅可比矩阵。这就是在 $x^{\\ast}$ 处负对数后验概率的黑塞矩阵的表达式。\n\n在后验分布的高斯假设（也称为拉普拉斯近似）下，后验分布被近似为一个以 MAP 估计值 $x^{\\ast}$ 为中心、协方差矩阵 $\\Sigma_{\\mathrm{post}}$ 为黑塞矩阵逆矩阵的多元正态分布：\n$$\n\\Sigma_{\\mathrm{post}} = H^{-1} = (J^T \\Sigma_{\\epsilon}^{-1} J + \\Sigma_{\\mathrm{prior}}^{-1})^{-1}\n$$\n我们现在计算所需的矩阵。对角测量误差协方差矩阵 $\\Sigma_{\\epsilon}$ 的逆矩阵是：\n$$\n\\Sigma_{\\epsilon}^{-1} = \\begin{pmatrix} (6.4 \\times 10^{-7})^{-1}  0 \\\\ 0  (1.0 \\times 10^{-6})^{-1} \\end{pmatrix} = \\begin{pmatrix} 1562500  0 \\\\ 0  1000000 \\end{pmatrix}\n$$\n对角先验协方差矩阵 $\\Sigma_{\\mathrm{prior}}$ 的逆矩阵是：\n$$\n\\Sigma_{\\mathrm{prior}}^{-1} = \\begin{pmatrix} 1.0^{-1}  0 \\\\ 0  0.64^{-1} \\end{pmatrix} = \\begin{pmatrix} 1.0  0 \\\\ 0  1.5625 \\end{pmatrix}\n$$\n接下来，我们计算 $J^T \\Sigma_{\\epsilon}^{-1} J$ 项：\n$$\nJ^T \\Sigma_{\\epsilon}^{-1} J = \\begin{pmatrix} -0.0020  0.0045 \\\\ 0.0060  0.0055 \\end{pmatrix} \\begin{pmatrix} 1562500  0 \\\\ 0  1000000 \\end{pmatrix} \\begin{pmatrix} -0.0020  0.0060 \\\\ 0.0045  0.0055 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -3125  4500 \\\\ 9375  5500 \\end{pmatrix} \\begin{pmatrix} -0.0020  0.0060 \\\\ 0.0045  0.0055 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} (-0.0020)(-3125) + (0.0045)(4500)  (-0.0020)(9375) + (0.0045)(5500) \\\\ (0.0060)(-3125) + (0.0055)(4500)  (0.0060)(9375) + (0.0055)(5500) \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 6.25 + 20.25  -18.75 + 24.75 \\\\ -18.75 + 24.75  56.25 + 30.25 \\end{pmatrix} = \\begin{pmatrix} 26.5  6.0 \\\\ 6.0  86.5 \\end{pmatrix}\n$$\n现在我们计算完整的黑塞矩阵 $H$：\n$$\nH = J^T \\Sigma_{\\epsilon}^{-1} J + \\Sigma_{\\mathrm{prior}}^{-1} = \\begin{pmatrix} 26.5  6.0 \\\\ 6.0  86.5 \\end{pmatrix} + \\begin{pmatrix} 1.0  0 \\\\ 0  1.5625 \\end{pmatrix}\n$$\n$$\nH = \\begin{pmatrix} 27.5  6.0 \\\\ 6.0  88.0625 \\end{pmatrix}\n$$\n后验协方差为 $\\Sigma_{\\mathrm{post}} = H^{-1}$。$x_1$ 和 $x_2$ 之间的相关系数 $\\rho_{12}$ 由下式给出：\n$$\n\\rho_{12} = \\frac{(\\Sigma_{\\mathrm{post}})_{12}}{\\sqrt{(\\Sigma_{\\mathrm{post}})_{11} (\\Sigma_{\\mathrm{post}})_{22}}}\n$$\n对于一个 $2 \\times 2$ 矩阵 $H = \\begin{pmatrix} a  b \\\\ b  d \\end{pmatrix}$，其逆矩阵为 $\\Sigma_{\\mathrm{post}} = H^{-1} = \\frac{1}{ad-b^2} \\begin{pmatrix} d  -b \\\\ -b  a \\end{pmatrix}$。相关系数可以简单地用 $H$ 的元素表示：\n$$\n\\rho_{12} = \\frac{-b / (ad-b^2)}{\\sqrt{(d / (ad-b^2)) (a / (ad-b^2))}} = \\frac{-b}{\\sqrt{ad}}\n$$\n使用我们计算出的黑塞矩阵 $H$ 的元素：$a = 27.5$，$b = 6.0$，以及 $d = 88.0625$。\n$$\n\\rho_{12} = \\frac{-6.0}{\\sqrt{27.5 \\times 88.0625}}\n$$\n首先，我们计算分母中的乘积：\n$$\n27.5 \\times 88.0625 = 2421.71875\n$$\n然后，我们计算相关系数：\n$$\n\\rho_{12} = \\frac{-6.0}{\\sqrt{2421.71875}} \\approx \\frac{-6.0}{49.2109616} \\approx -0.12192135\n$$\n根据要求将结果四舍五入到四位有效数字：\n$$\n\\rho_{12} \\approx -0.1219\n$$\n这就是 $x_1 = \\ln C$ 和 $x_2 = \\ln T$ 之间的后验相关系数。",
            "answer": "$$\\boxed{-0.1219}$$"
        }
    ]
}