{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of surface energy balance models like SEBAL and METRIC is the principle of energy conservation. This first exercise grounds your understanding by tasking you with calculating the latent heat flux ($LE$) as the \"residual\" energy after accounting for net radiation ($R_n$), soil heat flux ($G$), and sensible heat flux ($H$). By converting this energy flux into an equivalent depth of water, you will perform the fundamental calculation that transforms satellite-derived energy measurements into a tangible evapotranspiration rate. ",
            "id": "3811095",
            "problem": "In the context of the Surface Energy Balance Algorithm for Land (SEBAL) and Mapping Evapotranspiration at high Resolution with Internalized Calibration (METRIC), consider a clear-sky satellite overpass for a vegetated pixel where image-based flux retrievals at the overpass time yield net radiation $R_{n}=600\\ \\mathrm{W\\,m^{-2}}$, soil heat flux $G=60\\ \\mathrm{W\\,m^{-2}}$, and sensible heat flux $H=200\\ \\mathrm{W\\,m^{-2}}$. Using only conservation of energy at the land surface and the thermodynamic definition of the latent heat of vaporization, derive from first principles an expression for the latent heat flux $LE$ and then an expression for the instantaneous actual evapotranspiration rate as an equivalent water depth. Use $\\lambda=2.45\\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}$ for the latent heat of vaporization, and the hydrostatic identity that $1\\ \\mathrm{mm}$ of water over $1\\ \\mathrm{m^{2}}$ corresponds to $1\\ \\mathrm{kg}$. State and justify each step, including the unit consistency, and compute the numerical value of the instantaneous actual evapotranspiration rate for this pixel at the satellite overpass. Round your final evapotranspiration rate to four significant figures and express it in $\\mathrm{mm\\,h^{-1}}$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on the fundamental principle of surface energy conservation, a cornerstone of micrometeorology and remote sensing applications like SEBAL and METRIC. All required constants and data are provided, the values are physically realistic, and there are no ambiguities or contradictions. We may therefore proceed with the solution.\n\nThe derivation begins with the principle of conservation of energy at the land surface. The surface energy balance equation states that the net radiation ($R_n$), which is the primary energy source at the surface, is partitioned into several components. For a typical land surface, this balance is expressed as:\n$$\nR_n = G + H + LE\n$$\nwhere:\n- $R_n$ is the net radiation flux, representing the balance between incoming and outgoing shortwave and longwave radiation. Its units are energy per unit time per unit area, expressed as Watts per square meter ($\\mathrm{W\\,m^{-2}}$).\n- $G$ is the soil heat flux, representing the energy transferred into or out of the soil via conduction. Its units are also $\\mathrm{W\\,m^{-2}}$.\n- $H$ is the sensible heat flux, representing the energy transferred to or from the atmosphere by convection and conduction, causing a change in air temperature. Its units are also $\\mathrm{W\\,m^{-2}}$.\n- $LE$ is the latent heat flux, representing the energy consumed during the phase change of water from liquid to vapor (evapotranspiration). Its units are also $\\mathrm{W\\,m^{-2}}$.\n\nIn this formulation, energy storage within the canopy and energy used for photosynthesis are considered negligible, which is a standard assumption in the SEBAL and METRIC models.\n\nOur first objective is to derive an expression for the latent heat flux, $LE$. By algebraically rearranging the surface energy balance equation, we can isolate $LE$:\n$$\nLE = R_n - G - H\n$$\nThis equation establishes that the latent heat flux is the residual energy available at the surface after accounting for heat conduction into the ground and convective heating of the air.\n\nThe second objective is to derive an expression for the instantaneous actual evapotranspiration rate, which we denote as $ET_{inst}$, as an equivalent depth of water. The latent heat flux, $LE$, is by definition the energy flux associated with the mass flux of evapotranspired water, $\\dot{m}_{ET}$. This relationship is mediated by the latent heat of vaporization, $\\lambda$, which is the energy required to vaporize a unit mass of water (in Joules per kilogram, $\\mathrm{J\\,kg^{-1}}$). The thermodynamic definition is:\n$$\nLE = \\lambda \\cdot \\dot{m}_{ET}\n$$\nHere, $\\dot{m}_{ET}$ has units of mass per unit time per unit area, such as $\\mathrm{kg\\,s^{-1}\\,m^{-2}}$. We can solve for this mass flux rate:\n$$\n\\dot{m}_{ET} = \\frac{LE}{\\lambda}\n$$\nThe problem requires the evapotranspiration rate to be expressed as an equivalent water depth per unit time (e.g., in $\\mathrm{mm\\,h^{-1}}$). The mass of a volume of water is given by $m = \\rho_w V$, where $\\rho_w$ is the density of water and $V$ is the volume. Over a unit area $A = 1\\ \\mathrm{m^2}$, a water depth $d$ corresponds to a volume $V = A \\cdot d = d \\cdot (1\\ \\mathrm{m^2})$. The corresponding mass per unit area is $m/A = \\rho_w d$. The problem provides the hydrostatic identity that a depth of $1\\ \\mathrm{mm}$ of water over $1\\ \\mathrm{m^2}$ corresponds to a mass of $1\\ \\mathrm{kg}$. This simplifies the conversion, as it implicitly uses a water density $\\rho_w = 1000\\ \\mathrm{kg\\,m^{-3}}$.\nLet $ET_{inst}$ be the evapotranspiration rate in terms of water depth per unit time. The mass flux $\\dot{m}_{ET}$ is then equivalent to the volumetric flux rate multiplied by the density of water, which translates directly to the rate of change of water depth. Based on the provided identity, a mass flux of $1\\ \\mathrm{kg\\,s^{-1}\\,m^{-2}}$ corresponds to an equivalent water depth rate of $1\\ \\mathrm{mm\\,s^{-1}}$. Therefore, we can write:\n$$\nET_{inst} [\\mathrm{mm\\,s^{-1}}] = \\dot{m}_{ET} [\\mathrm{kg\\,s^{-1}\\,m^{-2}}]\n$$\nSubstituting the expressions for $\\dot{m}_{ET}$ and subsequently for $LE$, we obtain the expression for the instantaneous evapotranspiration rate:\n$$\nET_{inst} = \\frac{LE}{\\lambda} = \\frac{R_n - G - H}{\\lambda}\n$$\nThe units of this expression must be carefully tracked. Given $R_n$, $G$, and $H$ in $\\mathrm{W\\,m^{-2}}$ (or $\\mathrm{J\\,s^{-1}\\,m^{-2}}$) and $\\lambda$ in $\\mathrm{J\\,kg^{-1}}$, the resulting unit for $ET_{inst}$ is $\\mathrm{kg\\,s^{-1}\\,m^{-2}}$, which is numerically equivalent to $\\mathrm{mm\\,s^{-1}}$.\n\nNow, we compute the numerical value for the given pixel. The provided values are:\n$R_n = 600\\ \\mathrm{W\\,m^{-2}}$\n$G = 60\\ \\mathrm{W\\,m^{-2}}$\n$H = 200\\ \\mathrm{W\\,m^{-2}}$\n$\\lambda = 2.45 \\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}$\n\nFirst, we calculate the latent heat flux, $LE$:\n$$\nLE = 600\\ \\mathrm{W\\,m^{-2}} - 60\\ \\mathrm{W\\,m^{-2}} - 200\\ \\mathrm{W\\,m^{-2}} = 340\\ \\mathrm{W\\,m^{-2}}\n$$\nNext, we calculate the instantaneous evapotranspiration rate. The unit $\\mathrm{W\\,m^{-2}}$ is equivalent to $\\mathrm{J\\,s^{-1}\\,m^{-2}}$.\n$$\nET_{inst} = \\frac{340\\ \\mathrm{J\\,s^{-1}\\,m^{-2}}}{2.45 \\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}} \\approx 1.387755 \\times 10^{-4}\\ \\mathrm{kg\\,s^{-1}\\,m^{-2}}\n$$\nBased on the hydrostatic identity, this is numerically equivalent to $1.387755 \\times 10^{-4}\\ \\mathrm{mm\\,s^{-1}}$. The problem requires the final answer in units of millimeters per hour ($\\mathrm{mm\\,h^{-1}}$). There are $3600$ seconds in one hour ($1\\ \\mathrm{h} = 3600\\ \\mathrm{s}$). Therefore, we must multiply our result by this conversion factor:\n$$\nET_{inst} [\\mathrm{mm\\,h^{-1}}] = ET_{inst} [\\mathrm{mm\\,s^{-1}}] \\times 3600\\ \\mathrm{s\\,h^{-1}}\n$$\n$$\nET_{inst} = \\left(\\frac{340}{2.45 \\times 10^{6}}\\right) \\times 3600\\ \\mathrm{mm\\,h^{-1}}\n$$\n$$\nET_{inst} \\approx (1.387755 \\times 10^{-4}) \\times 3600\\ \\mathrm{mm\\,h^{-1}} \\approx 0.4995918\\ \\mathrm{mm\\,h^{-1}}\n$$\nRounding the result to four significant figures as requested, we obtain:\n$$\nET_{inst} \\approx 0.4996\\ \\mathrm{mm\\,h^{-1}}\n$$",
            "answer": "$$\n\\boxed{0.4996}\n$$"
        },
        {
            "introduction": "A key challenge in applying the surface energy balance is accurately determining the sensible heat flux ($H$) for every pixel. This practice explores the innovative internal calibration procedure that is central to both SEBAL and METRIC, which cleverly bypasses the need for complex atmospheric measurements. By anchoring the model with extreme \"hot\" (dry) and \"cold\" (wet) pixels, you will establish the linear relationship that allows for the robust estimation of $H$ and, consequently, $LE$ across an entire landscape. ",
            "id": "3811039",
            "problem": "A remote sensing evapotranspiration retrieval at instantaneous satellite overpass uses the surface energy balance, which partitions net radiation into turbulent and conductive fluxes. For a land surface pixel, conservation of energy at the surface states that the available energy equals the sum of turbulent and ground heat fluxes. In the Surface Energy Balance Algorithm for Land (SEBAL) and the Mapping Evapotranspiration at high Resolution with Internalized Calibration (METRIC) frameworks, calibration proceeds by identifying a hydrologically extreme “hot” pixel (near water-stress, latent heat flux negligible) and a “cold” pixel (well-watered, latent heat flux high), and exploiting aerodynamic theory to relate sensible heat flux to an air–surface temperature difference that is linearly parameterized by radiometric surface temperature.\n\nYou are given two calibration pixels at the satellite overpass time. The “hot” pixel has net radiation $R_{n} = 700\\,\\mathrm{W\\,m^{-2}}$, ground heat flux $G = 100\\,\\mathrm{W\\,m^{-2}}$, and latent heat flux $LE \\approx 0\\,\\mathrm{W\\,m^{-2}}$. The “cold” pixel has net radiation $R_{n} = 600\\,\\mathrm{W\\,m^{-2}}$, ground heat flux $G = 50\\,\\mathrm{W\\,m^{-2}}$, and latent heat flux $LE = 400\\,\\mathrm{W\\,m^{-2}}$.\n\nStarting from the surface energy balance principle and the aerodynamic definition of sensible heat flux, do the following:\n- Derive and compute the sensible heat fluxes $H_{\\text{hot}}$ and $H_{\\text{cold}}$ for the two pixels.\n- Introduce the SEBAL/METRIC calibration relation $dT = a + b\\,T_{s}$, where $dT$ is the near-surface temperature difference and $T_{s}$ is the radiometric surface temperature, and use the aerodynamic bulk formula for sensible heat flux to set up the pair of linear equations that would be solved for the unknown coefficients $a$ and $b$ given pixel-specific parameters. Let the pixel-specific air density be $\\rho_{\\text{hot}}$ and $\\rho_{\\text{cold}}$, the specific heat of air at constant pressure be $c_{p}$, and the aerodynamic resistance be $r_{ah,\\text{hot}}$ and $r_{ah,\\text{cold}}$. Denote the radiometric surface temperatures as $T_{s,\\text{hot}}$ and $T_{s,\\text{cold}}$. Do not solve numerically for $a$ and $b$.\n\nRound your computed sensible heat fluxes to four significant figures and express them in $\\mathrm{W\\,m^{-2}}$.",
            "solution": "The problem statement will first be validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The governing principle is the surface energy balance: $R_n = G + H + LE$, where $R_n$ is net radiation, $G$ is ground heat flux, $H$ is sensible heat flux, and $LE$ is latent heat flux.\n- **Hot Pixel Data**:\n  - Net radiation, $R_{n,\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}}$\n  - Ground heat flux, $G_{\\text{hot}} = 100\\,\\mathrm{W\\,m^{-2}}$\n  - Latent heat flux, $LE_{\\text{hot}} \\approx 0\\,\\mathrm{W\\,m^{-2}}$\n- **Cold Pixel Data**:\n  - Net radiation, $R_{n,\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}}$\n  - Ground heat flux, $G_{\\text{cold}} = 50\\,\\mathrm{W\\,m^{-2}}$\n  - Latent heat flux, $LE_{\\text{cold}} = 400\\,\\mathrm{W\\,m^{-2}}$\n- **SEBAL/METRIC Calibration Relations**:\n  - Aerodynamic definition of sensible heat flux: $H = \\rho c_p \\frac{dT}{r_{ah}}$\n  - Linear relationship for the near-surface temperature difference $dT$: $dT = a + b\\,T_{s}$\n- **Pixel-Specific Parameters**:\n  - Air density: $\\rho_{\\text{hot}}$, $\\rho_{\\text{cold}}$\n  - Specific heat of air at constant pressure: $c_{p}$\n  - Aerodynamic resistance to heat transfer: $r_{ah,\\text{hot}}$, $r_{ah,\\text{cold}}$\n  - Radiometric surface temperature: $T_{s,\\text{hot}}$, $T_{s,\\text{cold}}$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the first law of thermodynamics applied to a land surface, which is the fundamental principle of surface energy balance models like SEBAL and METRIC. The concepts of net radiation, turbulent fluxes ($H$, $LE$), and ground heat flux ($G$) are standard in micrometeorology and remote sensing. The use of \"hot\" and \"cold\" anchor pixels for internal calibration is the defining feature of these widely accepted and validated models. The given numerical values for the energy fluxes are physically realistic for daytime conditions over land.\n- **Well-Posed**: The problem is well-posed. It asks for two distinct tasks: (1) calculation of sensible heat fluxes from the energy balance equation, for which all necessary data are provided, and (2) setting up a system of linear equations using provided definitions, without requiring a solution. This structure ensures a unique and meaningful answer can be derived from the givens.\n- **Objective**: The problem is stated in precise, objective scientific language, free of any subjectivity or ambiguity.\n\nThe problem is self-contained, scientifically sound, and well-posed. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe first step is to compute the sensible heat fluxes, $H_{\\text{hot}}$ and $H_{\\text{cold}}$, for the two calibration pixels. This is achieved by applying the principle of surface energy conservation, which states that net radiation ($R_n$) is partitioned into ground heat flux ($G$), sensible heat flux ($H$), and latent heat flux ($LE$). The surface energy balance equation is:\n$$R_n = G + H + LE$$\nThis equation can be rearranged to solve for the sensible heat flux $H$:\n$$H = R_n - G - LE$$\n\n**For the hot pixel:**\nThe given values are $R_{n,\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}}$, $G_{\\text{hot}} = 100\\,\\mathrm{W\\,m^{-2}}$, and $LE_{\\text{hot}} \\approx 0\\,\\mathrm{W\\,m^{-2}}$. Substituting these into the rearranged energy balance equation:\n$$H_{\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}} - 100\\,\\mathrm{W\\,m^{-2}} - 0\\,\\mathrm{W\\,m^{-2}}$$\n$$H_{\\text{hot}} = 600\\,\\mathrm{W\\,m^{-2}}$$\nRounding to four significant figures as requested, we get $H_{\\text{hot}} = 600.0\\,\\mathrm{W\\,m^{-2}}$.\n\n**For the cold pixel:**\nThe given values are $R_{n,\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}}$, $G_{\\text{cold}} = 50\\,\\mathrm{W\\,m^{-2}}$, and $LE_{\\text{cold}} = 400\\,\\mathrm{W\\,m^{-2}}$. Substituting these values:\n$$H_{\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}} - 50\\,\\mathrm{W\\,m^{-2}} - 400\\,\\mathrm{W\\,m^{-2}}$$\n$$H_{\\text{cold}} = 150\\,\\mathrm{W\\,m^{-2}}$$\nRounding to four significant figures, we get $H_{\\text{cold}} = 150.0\\,\\mathrm{W\\,m^{-2}}$.\n\nThe second part of the task is to set up the pair of linear equations for the calibration coefficients $a$ and $b$. We start with the aerodynamic bulk formula for sensible heat flux $H$:\n$$H = \\rho c_p \\frac{dT}{r_{ah}}$$\nwhere $\\rho$ is the air density, $c_p$ is the specific heat of air at constant pressure, $r_{ah}$ is the aerodynamic resistance to heat transfer, and $dT$ is the near-surface temperature difference.\n\nThe SEBAL/METRIC models assume a linear relationship between $dT$ and the radiometric surface temperature $T_s$:\n$$dT = a + b\\,T_{s}$$\nwhere $a$ and $b$ are the empirical calibration coefficients.\n\nBy substituting the expression for $dT$ into the aerodynamic formula for $H$, we obtain:\n$$H = \\rho c_p \\frac{a + b\\,T_{s}}{r_{ah}}$$\nThis equation forms the basis for the calibration. We apply it to both the hot and cold pixels, for which we have already determined the sensible heat flux $H$.\n\n**For the hot pixel:**\nWe use the calculated $H_{\\text{hot}}$ and the pixel-specific parameters $\\rho_{\\text{hot}}$, $r_{ah,\\text{hot}}$, and $T_{s,\\text{hot}}$:\n$$H_{\\text{hot}} = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}}$$\nSubstituting the numerical value $H_{\\text{hot}} = 600.0\\,\\mathrm{W\\,m^{-2}}$, the first linear equation is:\n$$600.0 = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}}$$\n\n**For the cold pixel:**\nWe use the calculated $H_{\\text{cold}}$ and the pixel-specific parameters $\\rho_{\\text{cold}}$, $r_{ah,\\text{cold}}$, and $T_{s,\\text{cold}}$:\n$$H_{\\text{cold}} = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}$$\nSubstituting the numerical value $H_{\\text{cold}} = 150.0\\,\\mathrm{W\\,m^{-2}}$, the second linear equation is:\n$$150.0 = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}$$\n\nThus, the pair of linear equations in the unknowns $a$ and $b$ is:\n$$\n\\begin{cases}\n600.0 = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}} \\\\\n150.0 = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}\n\\end{cases}\n$$\nThis system would be solved for $a$ and $b$ using measured or estimated values for the temperatures, densities, and resistances.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n600.0 & 150.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Satellite measurements provide powerful but instantaneous snapshots of the land surface. For applications in hydrology and water management, we must translate these snapshots into continuous daily and seasonal water use estimates. This final practice guides you through the essential process of temporal integration, where the evaporative fraction ($ETrF$) is used to interpolate between satellite overpass dates, allowing for the reconstruction of a full seasonal evapotranspiration time series from sparse data. ",
            "id": "3811075",
            "problem": "You are given a pixel-level seasonal reconstruction problem grounded in the Surface Energy Balance Algorithm for Land (SEBAL) and Mapping Evapotranspiration at High Resolution with Internalized Calibration (METRIC). In these approaches, the daily actual evapotranspiration, denoted by $ET_a$, is related to the standardized reference evapotranspiration for alfalfa, denoted by $ETr$, via the evaporative fraction (also called $ETrF$): by core definition, $ETrF(d) = ET_a(d) / ETr(d)$ for day $d$. You have five clear-sky map dates providing $ETrF$ values for the pixel, and a complete daily series of $ETr$ over a specified season. Cloudy days lack direct $ETrF$ observations; you must reconstruct a continuous daily $ETrF(d)$ time series by temporal interpolation and then integrate to obtain seasonal $ET_a$. Additionally, you must quantify the uncertainty due to missing cloudy days using a probabilistic and a worst-case bound.\n\nUse the following physically grounded and scientifically plausible assumptions to reconstruct and integrate:\n- For days $d$ strictly between two observation dates $d_i$ and $d_{i+1}$ with known $ETrF$ values $f_i$ and $f_{i+1}$, estimate $ETrF(d)$ by piecewise-linear interpolation in time.\n- For days earlier than the first observation date, hold $ETrF(d)$ equal to the first observed $ETrF$ value (constant extrapolation). For days later than the last observation date, hold $ETrF(d)$ equal to the last observed value (constant extrapolation).\n- Apply a physical plausibility constraint by clamping the reconstructed $ETrF(d)$ to the closed interval $[0, L]$ with $L$ specified for each test case (this captures that $ETrF$ rarely exceeds unity by large margins under alfalfa reference conditions).\n- For daily actual evapotranspiration, use the core definition $ET_a(d) = ETrF(d) \\times ETr(d)$.\n- For uncertainty from cloudy days, model the true evaporative fraction on a cloudy day $d \\in \\mathcal{C}$ as $ETrF_{\\text{true}}(d) = ETrF_{\\text{interp}}(d) + e_d$, where $ETrF_{\\text{interp}}(d)$ is the clamped baseline from the interpolation rule. Assume the perturbations $e_d$ are independent, zero-mean, with known standard deviation $\\sigma$ and bounded in magnitude by $|e_d| \\le b$. Compute two uncertainty measures on the seasonal total $ET_a$:\n  1. One-standard-deviation uncertainty (root-sum-of-squares) under linear error propagation: $\\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} \\left(\\sigma \\cdot ETr(d)\\right)^2}$.\n  2. A worst-case absolute bound if all errors take the same sign within their magnitude limits: $U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d)$.\n- For uncertainty propagation, treat the baseline $ETrF_{\\text{interp}}(d)$ as already clamped, and do not reapply clamping within the uncertainty aggregation; that is, compute $\\sigma_{ET}$ and $U_{\\text{wc}}$ using the linearized model around the clamped baseline.\n\nYour task:\n- Implement the interpolation, clamping, integration, and uncertainty aggregation precisely as above.\n- For each test case, output a list of three numbers: the seasonal $ET_a$ integrated over the season in millimeters, the one-standard-deviation uncertainty in millimeters, and the worst-case absolute bound in millimeters. Express all outputs in millimeters and round each to exactly three decimal places.\n\nTest Suite:\nFor each test case below, the season is given by a contiguous integer day index range $d = 1, 2, \\dots, D$. Arrays are ordered by day index. Observation days and cloudy days are provided as sets of integer indices.\n\n- Test Case 1 (happy path interpolation and moderate uncertainty):\n  - Season length $D = 10$.\n  - Daily $ETr(d)$ in $\\mathrm{mm \\, d^{-1}}$: $[6.0, 6.1, 6.2, 6.0, 5.8, 5.7, 5.9, 6.0, 6.3, 6.4]$.\n  - Observation days $[1, 3, 5, 7, 10]$ with corresponding $ETrF$ values $[0.9, 0.85, 1.0, 0.95, 0.8]$.\n  - Cloudy day set $\\mathcal{C} = \\{4, 6, 8, 9\\}$.\n  - Clamp limit $L = 1.3$.\n  - Uncertainty parameters: $\\sigma = 0.05$, $b = 0.10$.\n\n- Test Case 2 (boundary extrapolation at the tail and low uncertainty):\n  - Season length $D = 8$.\n  - Daily $ETr(d)$ in $\\mathrm{mm \\, d^{-1}}$: $[5.0, 5.1, 5.2, 5.0, 4.9, 4.8, 4.9, 5.0]$.\n  - Observation days $[1, 2, 3, 4, 8]$ with corresponding $ETrF$ values $[0.6, 0.7, 0.9, 1.2, 1.0]$.\n  - Cloudy day set $\\mathcal{C} = \\{5, 6, 7\\}$.\n  - Clamp limit $L = 1.3$.\n  - Uncertainty parameters: $\\sigma = 0.02$, $b = 0.04$.\n\n- Test Case 3 (long cloudy spell, clamping active near peak):\n  - Season length $D = 12$.\n  - Daily $ETr(d)$ in $\\mathrm{mm \\, d^{-1}}$: $[5.5, 5.6, 5.7, 5.8, 6.0, 6.2, 6.1, 6.0, 5.9, 5.8, 5.7, 5.6]$.\n  - Observation days $[1, 4, 6, 9, 12]$ with corresponding $ETrF$ values $[0.8, 0.95, 1.5, 1.1, 0.85]$.\n  - Cloudy day set $\\mathcal{C} = \\{2, 3, 5, 7, 8, 10, 11\\}$.\n  - Clamp limit $L = 1.3$.\n  - Uncertainty parameters: $\\sigma = 0.08$, $b = 0.12$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is a list of three floats: $[ET\\_a\\_\\text{mm}, \\sigma_{ET}\\_\\text{mm}, U_{\\text{wc}}\\_\\text{mm}]$.\n- All numbers must be rounded to exactly three decimal places.\n- The line must be formatted as a comma-separated list of these lists, enclosed in square brackets, with no spaces. For example: $[[123.456,7.890,12.345],[\\dots],[\\dots]]$.\n\nCompute and output the results for the three test cases exactly as specified above in millimeters, rounded to three decimal places, and formatted in the single-line list-of-lists format described.",
            "solution": "The problem is first assessed for its validity.\n\n### Step 1: Extract Givens\n- **Governing Relation**: The daily actual evapotranspiration, $ET_a(d)$, is related to the reference evapotranspiration, $ETr(d)$, by the evaporative fraction, $ETrF(d)$, such that $ET_a(d) = ETrF(d) \\times ETr(d)$.\n- **Time Series Reconstruction**: A continuous daily time series for $ETrF(d)$ must be constructed from a sparse set of clear-sky observations.\n    - **Interpolation**: For any day $d$ strictly between two observation dates $d_i$ and $d_{i+1}$ with known values $f_i$ and $f_{i+1}$, $ETrF(d)$ is estimated using piecewise-linear interpolation.\n    - **Extrapolation**: For days $d$ before the first observation date, $ETrF(d)$ is held constant at the first observed value. For days $d$ after the last observation date, $ETrF(d)$ is held constant at the last observed value.\n- **Physical Constraint**: The reconstructed $ETrF(d)$ values must be clamped to the closed interval $[0, L]$.\n- **Seasonal Integration**: The total seasonal actual evapotranspiration is the sum of the daily values: $ET_a = \\sum_{d=1}^{D} ET_a(d)$.\n- **Uncertainty Model for Cloudy Days**: On a cloudy day $d \\in \\mathcal{C}$, the true evaporative fraction is modeled as $ETrF_{\\text{true}}(d) = ETrF_{\\text{interp}}(d) + e_d$, where $ETrF_{\\text{interp}}(d)$ is the clamped, interpolated value. The perturbations $e_d$ are independent and zero-mean with a known standard deviation $\\sigma$ and a magnitude bound $|e_d| \\le b$.\n- **Uncertainty Aggregation**:\n    1.  One-standard-deviation uncertainty (probabilistic): $\\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} \\left(\\sigma \\cdot ETr(d)\\right)^2}$.\n    2.  Worst-case absolute bound (deterministic): $U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d)$.\n- **Test Case 1**:\n    - $D = 10$.\n    - $ETr(d)$: $[6.0, 6.1, 6.2, 6.0, 5.8, 5.7, 5.9, 6.0, 6.3, 6.4]$ $\\mathrm{mm \\, d^{-1}}$.\n    - Observations: days $[1, 3, 5, 7, 10]$ with $ETrF$ values $[0.9, 0.85, 1.0, 0.95, 0.8]$.\n    - Cloudy days $\\mathcal{C} = \\{4, 6, 8, 9\\}$.\n    - $L = 1.3$, $\\sigma = 0.05$, $b = 0.10$.\n- **Test Case 2**:\n    - $D = 8$.\n    - $ETr(d)$: $[5.0, 5.1, 5.2, 5.0, 4.9, 4.8, 4.9, 5.0]$ $\\mathrm{mm \\, d^{-1}}$.\n    - Observations: days $[1, 2, 3, 4, 8]$ with $ETrF$ values $[0.6, 0.7, 0.9, 1.2, 1.0]$.\n    - Cloudy days $\\mathcal{C} = \\{5, 6, 7\\}$.\n    - $L = 1.3$, $\\sigma = 0.02$, $b = 0.04$.\n- **Test Case 3**:\n    - $D = 12$.\n    - $ETr(d)$: $[5.5, 5.6, 5.7, 5.8, 6.0, 6.2, 6.1, 6.0, 5.9, 5.8, 5.7, 5.6]$ $\\mathrm{mm \\, d^{-1}}$.\n    - Observations: days $[1, 4, 6, 9, 12]$ with $ETrF$ values $[0.8, 0.95, 1.5, 1.1, 0.85]$.\n    - Cloudy days $\\mathcal{C} = \\{2, 3, 5, 7, 8, 10, 11\\}$.\n    - $L = 1.3$, $\\sigma = 0.08$, $b = 0.12$.\n- **Output Requirement**: For each test case, a list of three numbers: $[ET_a, \\sigma_{ET}, U_{\\text{wc}}]$, with each value rounded to three decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in established remote sensing methodologies (SEBAL/METRIC). The use of piecewise-linear interpolation to fill gaps in satellite-derived time series is a standard and physically plausible technique, representing the assumption of slowly varying surface conditions (e.g., vegetation health) between observations. The clamping of $ETrF$ is a valid physical constraint, as the ratio of actual-to-reference evapotranspiration is physically bounded. The uncertainty analysis employs standard linear error propagation for the probabilistic estimate and a deterministic summation for the worst-case bound, both of which are appropriate for the given model.\n\nThe problem is well-posed. All required data and parameters ($D$, $ETr$ series, observation points, cloud information, clamp limit $L$, and uncertainty parameters $\\sigma, b$) are explicitly provided for each test case. The algorithmic steps are defined unambiguously, ensuring a unique solution can be computed. The problem statement is objective and free of non-formalizable or contradictory elements.\n\n### Step 3: Verdict and Action\nThe problem is valid. A step-by-step solution can be formulated and implemented.\n\n### Algorithmic Solution\nThe solution is constructed by following the prescribed sequence of operations for each test case.\n\n1.  **Reconstruct the $ETrF$ Time Series**:\n    For a given season of length $D$, we define an array of day indices from $1$ to $D$. The provided observation days and corresponding $ETrF$ values serve as anchor points for interpolation. Piecewise-linear interpolation is applied to estimate $ETrF(d)$ for all days in the season. The interpolation function must also handle the specified extrapolation rule: holding values constant before the first observation and after the last observation. The `numpy.interp` function is ideally suited for this task, as it performs piecewise-linear interpolation and its default behavior for out-of-bounds queries is to return the value of the nearest data point.\n\n2.  **Apply Physical Clamping**:\n    The interpolated $ETrF(d)$ time series is then subjected to a physical plausibility constraint. Each value in the series is clamped to the closed interval $[0, L]$, where $L$ is the specified upper limit. This ensures that the evaporative fraction does not take on physically unrealistic values. This operation can be expressed as $ETrF_{\\text{clamped}}(d) = \\max(0, \\min(ETrF_{\\text{interp}}(d), L))$.\n\n3.  **Compute Seasonal Actual Evapotranspiration ($ET_a$)**:\n    With the complete, clamped daily $ETrF(d)$ series, the daily actual evapotranspiration, $ET_a(d)$, is calculated using the definitional relationship $ET_a(d) = ETrF_{\\text{clamped}}(d) \\times ETr(d)$. The total seasonal evapotranspiration is then the sum of these daily values over the entire season: $ET_a = \\sum_{d=1}^{D} ET_a(d)$.\n\n4.  **Quantify Uncertainty**:\n    The uncertainty calculation is performed only for days specified as cloudy, $d \\in \\mathcal{C}$.\n    \n    a. **Probabilistic Uncertainty ($\\sigma_{ET}$)**: This is calculated using the formula for linear propagation of independent errors. For each cloudy day $d \\in \\mathcal{C}$, the uncertainty contribution to the total $ET_a$ is $\\sigma \\cdot ETr(d)$. The total standard deviation is the root-sum-of-squares of these individual contributions:\n    $$ \\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} (\\sigma \\cdot ETr(d))^2} $$\n    \n    b. **Worst-Case Bound ($U_{\\text{wc}}$)**: This represents the maximum possible deviation if all perturbations $e_d$ on cloudy days were to align in the same direction (all positive or all negative) and at their maximum magnitude $b$. The total absolute error bound is the sum of these maximum potential errors:\n    $$ U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d) $$\n    \n    These calculations are performed on the given $ETr(d)$ series and the specified parameters $\\sigma$ and $b$, independent of the interpolated $ETrF$ values, as per the problem statement's model.\n\n5.  **Final Output Formulation**:\n    For each test case, the three computed values ($ET_a$, $\\sigma_{ET}$, $U_{\\text{wc}}$) are rounded to exactly three decimal places and formatted into the specified list-of-lists structure.\n\nThis systematic procedure ensures that all constraints and definitions from the problem statement are met precisely.",
            "answer": "[[54.395,0.600,2.400],[38.740,0.294,0.588],[61.353,2.778,4.167]]"
        }
    ]
}