{
    "hands_on_practices": [
        {
            "introduction": "SEBAL 和 METRIC 模型的核心是地表能量平衡原理。这项练习将帮助您巩固对能量守恒基本原则的理解，展示如何将潜热通量（以及蒸发蒸腾）作为能量平衡方程中的剩余项进行计算，这是所有后续分析的基础。通过这个计算，您将直接地表能量通量（单位：瓦特/平方米）与等效水深（单位：毫米/小时）联系起来。",
            "id": "3811095",
            "problem": "在“地表能量平衡算法”（SEBAL）和“内部校正的高分辨率蒸散发制图”（METRIC）的背景下，考虑一个晴空条件下的卫星过境，对于一个植被像元，在过境时刻基于影像的通量反演得到净辐射 $R_{n}=600\\ \\mathrm{W\\,m^{-2}}$，土壤热通量 $G=60\\ \\mathrm{W\\,m^{-2}}$，以及感热通量 $H=200\\ \\mathrm{W\\,m^{-2}}$。仅使用地表能量守恒原理和汽化潜热的热力学定义，从第一性原理推导潜热通量 $LE$ 的表达式，然后推导以等效水深表示的瞬时实际蒸散发速率的表达式。使用汽化潜热 $\\lambda=2.45\\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}$，以及 $1\\ \\mathrm{m^{2}}$ 面积上 $1\\ \\mathrm{mm}$ 深的水对应 $1\\ \\mathrm{kg}$ 质量的静水平衡关系。陈述并论证每个步骤，包括单位的一致性，并计算该像元在卫星过境时的瞬时实际蒸散发速率的数值。将最终的蒸散发速率四舍五入到四位有效数字，并以 $\\mathrm{mm\\,h^{-1}}$ 为单位表示。",
            "solution": "该问题经核实具有科学依据、提法明确且客观。它基于地表能量守恒基本原理，这是微气象学和遥感应用（如SEBAL和METRIC）的基石。所有必需的常数和数据均已提供，其数值符合物理实际，且没有歧义或矛盾。因此，我们可以进行求解。\n\n推导从地表能量守恒原理开始。地表能量平衡方程指出，作为地表主要能量来源的净辐射（$R_n$）被分配为几个分量。对于典型的地表，这种平衡表示为：\n$$\nR_n = G + H + LE\n$$\n其中：\n- $R_n$ 是净辐射通量，表示入射和出射的短波与长波辐射之间的差额。其单位是单位面积单位时间的能量，表示为瓦特每平方米（$\\mathrm{W\\,m^{-2}}$）。\n- $G$ 是土壤热通量，表示通过传导传入或传出土壤的能量。其单位也是 $\\mathrm{W\\,m^{-2}}$。\n- $H$ 是感热通量，表示通过对流和传导与大气交换的能量，导致气温发生变化。其单位也是 $\\mathrm{W\\,m^{-2}}$。\n- $LE$ 是潜热通量，表示水从液态变为汽态（蒸散发）的相变过程中消耗的能量。其单位也是 $\\mathrm{W\\,m^{-2}}$。\n\n在此公式中，冠层内的能量储存和光合作用消耗的能量被认为可以忽略不计，这是SEBAL和METRIC模型中的一个标准假设。\n\n我们的第一个目标是推导潜热通量 $LE$ 的表达式。通过对地表能量平衡方程进行代数重排，我们可以分离出 $LE$：\n$$\nLE = R_n - G - H\n$$\n该方程表明，潜热通量是地表在扣除传入地下的热传导和对空气的对流加热后可用的剩余能量。\n\n第二个目标是推导以等效水深表示的瞬时实际蒸散发速率（我们记为 $ET_{inst}$）的表达式。根据定义，潜热通量 $LE$ 是与蒸散发水体的质量通量 $\\dot{m}_{ET}$ 相关的能量通量。该关系通过汽化潜热 $\\lambda$（即蒸发单位质量水所需的能量，单位为焦耳每千克，$\\mathrm{J\\,kg^{-1}}$）建立。其热力学定义为：\n$$\nLE = \\lambda \\cdot \\dot{m}_{ET}\n$$\n此处，$\\dot{m}_{ET}$ 的单位是单位面积单位时间的质量，例如 $\\mathrm{kg\\,s^{-1}\\,m^{-2}}$。我们可以求解这个质量通量速率：\n$$\n\\dot{m}_{ET} = \\frac{LE}{\\lambda}\n$$\n问题要求蒸散发速率以单位时间的等效水深（例如 $\\mathrm{mm\\,h^{-1}}$）表示。一体积水的质量由 $m = \\rho_w V$ 给出，其中 $\\rho_w$ 是水的密度，V 是体积。在单位面积 $A = 1\\ \\mathrm{m^2}$ 上，水深 $d$ 对应的体积为 $V = A \\cdot d = d \\cdot (1\\ \\mathrm{m^2})$。相应的单位面积质量为 $m/A = \\rho_w d$。问题给出的静水平衡关系指出，$1\\ \\mathrm{m^2}$ 面积上 $1\\ \\mathrm{mm}$ 深的水对应 $1\\ \\mathrm{kg}$ 的质量。这简化了转换，因为它隐含地使用了水的密度 $\\rho_w = 1000\\ \\mathrm{kg\\,m^{-3}}$。\n设 $ET_{inst}$ 是以单位时间水深表示的蒸散发速率。质量通量 $\\dot{m}_{ET}$ 等于体积通量速率乘以水的密度，这直接转换为水深的变化率。根据所给的关系， $1\\ \\mathrm{kg\\,s^{-1}\\,m^{-2}}$ 的质量通量对应于 $1\\ \\mathrm{mm\\,s^{-1}}$ 的等效水深速率。因此，我们可以写出：\n$$\nET_{inst} [\\mathrm{mm\\,s^{-1}}] = \\dot{m}_{ET} [\\mathrm{kg\\,s^{-1}\\,m^{-2}}]\n$$\n将 $\\dot{m}_{ET}$ 的表达式以及随后 $LE$ 的表达式代入，我们得到瞬时蒸散发速率的表达式：\n$$\nET_{inst} = \\frac{LE}{\\lambda} = \\frac{R_n - G - H}{\\lambda}\n$$\n此表达式的单位必须仔细追踪。已知 $R_n$、$G$ 和 $H$ 的单位是 $\\mathrm{W\\,m^{-2}}$（或 $\\mathrm{J\\,s^{-1}\\,m^{-2}}$），$\\lambda$ 的单位是 $\\mathrm{J\\,kg^{-1}}$，则 $ET_{inst}$ 的结果单位是 $\\mathrm{kg\\,s^{-1}\\,m^{-2}}$，这在数值上等同于 $\\mathrm{mm\\,s^{-1}}$。\n\n现在，我们计算给定像元的数值。所给定的值为：\n$R_n = 600\\ \\mathrm{W\\,m^{-2}}$\n$G = 60\\ \\mathrm{W\\,m^{-2}}$\n$H = 200\\ \\mathrm{W\\,m^{-2}}$\n$\\lambda = 2.45 \\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}$\n\n首先，我们计算潜热通量 $LE$：\n$$\nLE = 600\\ \\mathrm{W\\,m^{-2}} - 60\\ \\mathrm{W\\,m^{-2}} - 200\\ \\mathrm{W\\,m^{-2}} = 340\\ \\mathrm{W\\,m^{-2}}\n$$\n接下来，我们计算瞬时蒸散发速率。单位 $\\mathrm{W\\,m^{-2}}$ 等同于 $\\mathrm{J\\,s^{-1}\\,m^{-2}}$。\n$$\nET_{inst} = \\frac{340\\ \\mathrm{J\\,s^{-1}\\,m^{-2}}}{2.45 \\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}} \\approx 1.387755 \\times 10^{-4}\\ \\mathrm{kg\\,s^{-1}\\,m^{-2}}\n$$\n根据静水平衡关系，这在数值上等同于 $1.387755 \\times 10^{-4}\\ \\mathrm{mm\\,s^{-1}}$。问题要求最终答案以毫米每小时（$\\mathrm{mm\\,h^{-1}}$）为单位。一小时有 $3600$ 秒（$1\\ \\mathrm{h} = 3600\\ \\mathrm{s}$）。因此，我们必须将结果乘以这个转换因子：\n$$\nET_{inst} [\\mathrm{mm\\,h^{-1}}] = ET_{inst} [\\mathrm{mm\\,s^{-1}}] \\times 3600\\ \\mathrm{s\\,h^{-1}}\n$$\n$$\nET_{inst} = \\left(\\frac{340}{2.45 \\times 10^{6}}\\right) \\times 3600\\ \\mathrm{mm\\,h^{-1}}\n$$\n$$\nET_{inst} \\approx (1.387755 \\times 10^{-4}) \\times 3600\\ \\mathrm{mm\\,h^{-1}} \\approx 0.4995918\\ \\mathrm{mm\\,h^{-1}}\n$$\n按要求将结果四舍五入到四位有效数字，我们得到：\n$$\nET_{inst} \\approx 0.4996\\ \\mathrm{mm\\,h^{-1}}\n$$",
            "answer": "$$\n\\boxed{0.4996}\n$$"
        },
        {
            "introduction": "在地表能量平衡中，准确估算大范围区域的感热通量（$H$）是主要挑战。这项练习将引导您了解 SEBAL/METRIC 模型中独创的内部校准方法，该方法利用“热”像元和“冷”像元作为锚点，建立了地表温度与感热通量之间的线性关系。掌握这一过程对于理解这些模型如何能够在缺乏广泛地面气象数据的情况下，可靠地反演整个遥感影像的蒸发蒸腾至关重要。",
            "id": "3811039",
            "problem": "在卫星过境瞬间的遥感蒸散反演利用地表能量平衡，该平衡将净辐射划分为湍流通量和传导通量。对于一个地表像元，地表能量守恒表明，可用能量等于湍流通量和地表热通量之和。在地表能量平衡算法（SEBAL）和高分辨率蒸散发测绘内置定标算法（METRIC）框架中，定标过程是通过识别一个水文极端“热”像元（接近水分胁迫，潜热通量可忽略）和一个“冷”像元（水分充足，潜热通量高）来进行的，并利用空气动力学理论将感热通量与一个由辐射地表温度线性参数化的气-地温差联系起来。\n\n给定卫星过境时刻的两个定标像元。“热”像元的净辐射为 $R_{n} = 700\\,\\mathrm{W\\,m^{-2}}$，地表热通量为 $G = 100\\,\\mathrm{W\\,m^{-2}}$，潜热通量为 $LE \\approx 0\\,\\mathrm{W\\,m^{-2}}$。“冷”像元的净辐射为 $R_{n} = 600\\,\\mathrm{W\\,m^{-2}}$，地表热通量为 $G = 50\\,\\mathrm{W\\,m^{-2}}$，潜热通量为 $LE = 400\\,\\mathrm{W\\,m^{-2}}$。\n\n从地表能量平衡原理和感热通量的空气动力学定义出发，完成以下任务：\n- 推导并计算两个像元的感热通量 $H_{\\text{hot}}$ 和 $H_{\\text{cold}}$。\n- 引入 SEBAL/METRIC 定标关系 $dT = a + b\\,T_{s}$，其中 $dT$ 是近地表温差，$T_{s}$ 是辐射地表温度，并使用感热通量的空气动力学整体公式，建立一个线性方程组，用于在给定像元特定参数的情况下求解未知系数 $a$ 和 $b$。设像元特定的空气密度为 $\\rho_{\\text{hot}}$ 和 $\\rho_{\\text{cold}}$，空气的定压比热为 $c_{p}$，空气动力学阻抗为 $r_{ah,\\text{hot}}$ 和 $r_{ah,\\text{cold}}$。将辐射地表温度表示为 $T_{s,\\text{hot}}$ 和 $T_{s,\\text{cold}}$。不要对 $a$ 和 $b$ 进行数值求解。\n\n将计算出的感热通量四舍五入到四位有效数字，并以 $\\mathrm{W\\,m^{-2}}$ 为单位表示。",
            "solution": "首先将根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n- 控制原理是地表能量平衡：$R_n = G + H + LE$，其中 $R_n$ 是净辐射，$G$ 是地表热通量，$H$ 是感热通量，$LE$ 是潜热通量。\n- **热像元数据**：\n  - 净辐射, $R_{n,\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}}$\n  - 地表热通量, $G_{\\text{hot}} = 100\\,\\mathrm{W\\,m^{-2}}$\n  - 潜热通量, $LE_{\\text{hot}} \\approx 0\\,\\mathrm{W\\,m^{-2}}$\n- **冷像元数据**：\n  - 净辐射, $R_{n,\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}}$\n  - 地表热通量, $G_{\\text{cold}} = 50\\,\\mathrm{W\\,m^{-2}}$\n  - 潜热通量, $LE_{\\text{cold}} = 400\\,\\mathrm{W\\,m^{-2}}$\n- **SEBAL/METRIC 定标关系**：\n  - 感热通量的空气动力学定义: $H = \\rho c_p \\frac{dT}{r_{ah}}$\n  - 近地表温差 $dT$ 的线性关系: $dT = a + b\\,T_{s}$\n- **像元特定参数**：\n  - 空气密度: $\\rho_{\\text{hot}}$, $\\rho_{\\text{cold}}$\n  - 空气的定压比热: $c_{p}$\n  - 热量传输的空气动力学阻抗: $r_{ah,\\text{hot}}$, $r_{ah,\\text{cold}}$\n  - 辐射地表温度: $T_{s,\\text{hot}}$, $T_{s,\\text{cold}}$\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学依据**：该问题基于应用于地表的热力学第一定律，这是像 SEBAL 和 METRIC 这样的地表能量平衡模型的基本原理。净辐射、湍流通量（$H$、$LE$）和地表热通量（$G$）的概念是微气象学和遥感领域的标准概念。使用“热”和“冷”锚定像元进行内部定标是这些被广泛接受和验证的模型的决定性特征。给定的能量通量数值对于陆地白天的条件是物理上现实的。\n- **适定性**：该问题是适定的。它要求完成两个不同的任务：（1）根据能量平衡方程计算感热通量，所有必要数据均已提供；（2）使用提供的定义建立一个线性方程组，而无需求解。这种结构确保可以从给定信息中得出唯一且有意义的答案。\n- **客观性**：该问题以精确、客观的科学语言陈述，没有任何主观性或模糊性。\n\n该问题是自洽的、科学上合理的和适定的。它没有违反任何无效标准。\n\n**步骤 3：结论和行动**\n问题有效。将提供完整的解答。\n\n### 解答\n\n第一步是计算两个定标像元的感热通量 $H_{\\text{hot}}$ 和 $H_{\\text{cold}}$。这可以通过应用地表能量守恒原理来实现，该原理指出净辐射（$R_n$）被分配到地表热通量（$G$）、感热通量（$H$）和潜热通量（$LE$）中。地表能量平衡方程为：\n$$R_n = G + H + LE$$\n这个方程可以重新排列以求解感热通量 $H$：\n$$H = R_n - G - LE$$\n\n**对于热像元：**\n给定值为 $R_{n,\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}}$，$G_{\\text{hot}} = 100\\,\\mathrm{W\\,m^{-2}}$，以及 $LE_{\\text{hot}} \\approx 0\\,\\mathrm{W\\,m^{-2}}$。将这些值代入重新排列的能量平衡方程中：\n$$H_{\\text{hot}} = 700\\,\\mathrm{W\\,m^{-2}} - 100\\,\\mathrm{W\\,m^{-2}} - 0\\,\\mathrm{W\\,m^{-2}}$$\n$$H_{\\text{hot}} = 600\\,\\mathrm{W\\,m^{-2}}$$\n根据要求四舍五入到四位有效数字，我们得到 $H_{\\text{hot}} = 600.0\\,\\mathrm{W\\,m^{-2}}$。\n\n**对于冷像元：**\n给定值为 $R_{n,\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}}$，$G_{\\text{cold}} = 50\\,\\mathrm{W\\,m^{-2}}$，以及 $LE_{\\text{cold}} = 400\\,\\mathrm{W\\,m^{-2}}$。代入这些值：\n$$H_{\\text{cold}} = 600\\,\\mathrm{W\\,m^{-2}} - 50\\,\\mathrm{W\\,m^{-2}} - 400\\,\\mathrm{W\\,m^{-2}}$$\n$$H_{\\text{cold}} = 150\\,\\mathrm{W\\,m^{-2}}$$\n四舍五入到四位有效数字，我们得到 $H_{\\text{cold}} = 150.0\\,\\mathrm{W\\,m^{-2}}$。\n\n任务的第二部分是为定标系数 $a$ 和 $b$ 建立线性方程组。我们从感热通量 $H$ 的空气动力学整体公式开始：\n$$H = \\rho c_p \\frac{dT}{r_{ah}}$$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热，$r_{ah}$ 是热量传输的空气动力学阻抗，$dT$ 是近地表温差。\n\nSEBAL/METRIC 模型假设 $dT$ 与辐射地表温度 $T_s$ 之间存在线性关系：\n$$dT = a + b\\,T_{s}$$\n其中 $a$ 和 $b$ 是经验定标系数。\n\n通过将 $dT$ 的表达式代入 $H$ 的空气动力学公式，我们得到：\n$$H = \\rho c_p \\frac{a + b\\,T_{s}}{r_{ah}}$$\n该方程构成了定标的基础。我们将其应用于热像元和冷像元，我们已经确定了这两个像元的感热通量 $H$。\n\n**对于热像元：**\n我们使用计算出的 $H_{\\text{hot}}$ 和像元特定的参数 $\\rho_{\\text{hot}}$、$r_{ah,\\text{hot}}$ 和 $T_{s,\\text{hot}}$：\n$$H_{\\text{hot}} = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}}$$\n代入数值 $H_{\\text{hot}} = 600.0\\,\\mathrm{W\\,m^{-2}}$，第一个线性方程是：\n$$600.0 = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}}$$\n\n**对于冷像元：**\n我们使用计算出的 $H_{\\text{cold}}$ 和像元特定的参数 $\\rho_{\\text{cold}}$、$r_{ah,\\text{cold}}$ 和 $T_{s,\\text{cold}}$：\n$$H_{\\text{cold}} = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}$$\n代入数值 $H_{\\text{cold}} = 150.0\\,\\mathrm{W\\,m^{-2}}$，第二个线性方程是：\n$$150.0 = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}$$\n\n因此，关于未知数 $a$ 和 $b$ 的线性方程组是：\n$$\n\\begin{cases}\n600.0 = \\rho_{\\text{hot}} c_p \\frac{a + b\\,T_{s,\\text{hot}}}{r_{ah,\\text{hot}}} \\\\\n150.0 = \\rho_{\\text{cold}} c_p \\frac{a + b\\,T_{s,\\text{cold}}}{r_{ah,\\text{cold}}}\n\\end{cases}\n$$\n这个方程组将使用温度、密度和阻抗的测量值或估计值来求解 $a$ 和 $b$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n600.0  150.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "遥感模型提供的是特定时刻的“快照”，但对于水资源管理等应用，我们需要的是连续的、覆盖整个生长季的总量估算。这项计算实践模拟了将瞬时蒸发蒸腾率升级为季节总量的实际工作流程。它将迫使您处理真实世界的数据挑战，例如由多云天气造成的数据缺失，以及量化最终产品不确定性的必要性，从而将理论模型与实际应用联系起来。",
            "id": "3811075",
            "problem": "您面临一个基于地表能量平衡算法 (SEBAL) 和高分辨率内在定标蒸散发制图 (METRIC) 的像素级季节性重建问题。在这些方法中，日实际蒸散发（记作 $ET_a$）通过蒸发比（也称为 $ETrF$）与标准化紫花苜蓿参考蒸散发（记作 $ETr$）相关联：根据核心定义，$ETrF(d) = ET_a(d) / ETr(d)$，其中 $d$ 为具体日期。您拥有五个晴空影像日期，这些日期提供了该像素的 $ETrF$ 值，以及一个指定季节内完整的每日 $ETr$ 序列。阴天缺乏直接的 $ETrF$ 观测值；您必须通过时间插值重建一个连续的每日 $ETrF(d)$ 时间序列，然后进行积分以获得季节性 $ET_a$。此外，您还必须使用概率性界限和最坏情况界限来量化由阴天数据缺失所导致的不确定性。\n\n使用以下具有物理基础和科学合理性的假设来进行重建和积分：\n- 对于严格位于两个观测日期 $d_i$ 和 $d_{i+1}$ 之间且已知 $ETrF$ 值为 $f_i$ 和 $f_{i+1}$ 的日期 $d$，通过时间上的分段线性插值来估计 $ETrF(d)$。\n- 对于早于第一个观测日期的日子，将 $ETrF(d)$ 保持为第一个观测到的 $ETrF$ 值（常数外推）。对于晚于最后一个观测日期的日子，将 $ETrF(d)$ 保持为最后一个观测值（常数外推）。\n- 通过将重建的 $ETrF(d)$ 钳位到闭区间 $[0, L]$ 来施加物理合理性约束，其中 $L$ 为每个测试用例指定（这反映了在紫花苜蓿参考条件下，$ETrF$ 很少会大幅超过1）。\n- 对于日实际蒸散发，使用核心定义 $ET_a(d) = ETrF(d) \\times ETr(d)$。\n- 对于阴天的不确定性，将阴天 $d \\in \\mathcal{C}$ 的真实蒸发比建模为 $ETrF_{\\text{true}}(d) = ETrF_{\\text{interp}}(d) + e_d$，其中 $ETrF_{\\text{interp}}(d)$ 是根据插值规则得到的钳位基线。假设扰动 $e_d$ 是独立的、零均值的，具有已知的标准差 $\\sigma$ 和幅度界限 $|e_d| \\le b$。计算季节总 $ET_a$ 的两种不确定性度量：\n  1. 在线性误差传播下的单标准差不确定性（方和根）：$\\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} \\left(\\sigma \\cdot ETr(d)\\right)^2}$。\n  2. 如果所有误差在其幅度限制内取相同符号的最坏情况绝对界限：$U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d)$。\n- 对于不确定性传播，将基线 $ETrF_{\\text{interp}}(d)$ 视为已钳位，并且在不确定性聚合计算中不再重新应用钳位；也就是说，使用围绕钳位基线的线性化模型计算 $\\sigma_{ET}$ 和 $U_{\\text{wc}}$。\n\n您的任务：\n- 精确地按照上述说明实现插值、钳位、积分和不确定性聚合。\n- 对于每个测试用例，输出一个包含三个数字的列表：整个季节积分的季节性 $ET_a$（单位：毫米），单标准差不确定性（单位：毫米），以及最坏情况绝对界限（单位：毫米）。所有输出均以毫米为单位，并四舍五入到恰好三位小数。\n\n测试套件：\n对于下方的每个测试用例，季节由一个连续的整数日索引范围 $d = 1, 2, \\dots, D$ 给出。数组按日索引排序。观测日和阴天日作为整数索引集提供。\n\n- 测试用例 1（理想路径插值和中等不确定性）：\n  - 季节长度 $D = 10$。\n  - 每日 $ETr(d)$，单位 $\\mathrm{mm \\, d^{-1}}$：$[6.0, 6.1, 6.2, 6.0, 5.8, 5.7, 5.9, 6.0, 6.3, 6.4]$。\n  - 观测日 $[1, 3, 5, 7, 10]$ 及对应的 $ETrF$ 值 $[0.9, 0.85, 1.0, 0.95, 0.8]$。\n  - 阴天集合 $\\mathcal{C} = \\{4, 6, 8, 9\\}$。\n  - 钳位上限 $L = 1.3$。\n  - 不确定性参数：$\\sigma = 0.05$，$b = 0.10$。\n\n- 测试用例 2（尾部边界外推和低不确定性）：\n  - 季节长度 $D = 8$。\n  - 每日 $ETr(d)$，单位 $\\mathrm{mm \\, d^{-1}}$：$[5.0, 5.1, 5.2, 5.0, 4.9, 4.8, 4.9, 5.0]$。\n  - 观测日 $[1, 2, 3, 4, 8]$ 及对应的 $ETrF$ 值 $[0.6, 0.7, 0.9, 1.2, 1.0]$。\n  - 阴天集合 $\\mathcal{C} = \\{5, 6, 7\\}$。\n  - 钳位上限 $L = 1.3$。\n  - 不确定性参数：$\\sigma = 0.02$，$b = 0.04$。\n\n- 测试用例 3（长时段阴天，峰值附近有钳位激活）：\n  - 季节长度 $D = 12$。\n  - 每日 $ETr(d)$，单位 $\\mathrm{mm \\, d^{-1}}$：$[5.5, 5.6, 5.7, 5.8, 6.0, 6.2, 6.1, 6.0, 5.9, 5.8, 5.7, 5.6]$。\n  - 观测日 $[1, 4, 6, 9, 12]$ 及对应的 $ETrF$ 值 $[0.8, 0.95, 1.5, 1.1, 0.85]$。\n  - 阴天集合 $\\mathcal{C} = \\{2, 3, 5, 7, 8, 10, 11\\}$。\n  - 钳位上限 $L = 1.3$。\n  - 不确定性参数：$\\sigma = 0.08$，$b = 0.12$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果都是一个包含三个浮点数的列表：$[ET\\_a\\_\\text{mm}, \\sigma_{ET}\\_\\text{mm}, U_{\\text{wc}}\\_\\text{mm}]$。\n- 所有数字必须四舍五入到恰好三位小数。\n- 该行必须格式化为这些列表的逗号分隔列表，并用方括号括起来，不含空格。例如：$[[123.456,7.890,12.345],[\\dots],[\\dots]]$。\n\n请计算并输出上述三个测试用例的结果，单位为毫米，四舍五入到三位小数，并按所描述的单行列表的列表格式进行格式化。",
            "solution": "首先评估问题的有效性。\n\n### 步骤 1：提取给定信息\n- **主导关系**：日实际蒸散发 $ET_a(d)$ 与参考蒸散发 $ETr(d)$ 通过蒸发比 $ETrF(d)$ 相关联，即 $ET_a(d) = ETrF(d) \\times ETr(d)$。\n- **时间序列重建**：必须从稀疏的晴空观测数据集中构建一个连续的每日 $ETrF(d)$ 时间序列。\n    - **插值**：对于严格位于两个观测日期 $d_i$ 和 $d_{i+1}$ 之间且已知值为 $f_i$ 和 $f_{i+1}$ 的任何日期 $d$，$ETrF(d)$ 通过分段线性插值进行估计。\n    - **外推**：对于早于第一个观测日期的日子，$ETrF(d)$ 保持为第一个观测值不变。对于晚于最后一个观测日期的日子，$ETrF(d)$ 保持为最后一个观测值不变。\n- **物理约束**：重建的 $ETrF(d)$ 值必须被钳位到闭区间 $[0, L]$。\n- **季节性积分**：季节性总实际蒸散发是每日值的总和：$ET_a = \\sum_{d=1}^{D} ET_a(d)$。\n- **阴天的不确定性模型**：在阴天 $d \\in \\mathcal{C}$，真实蒸发比被建模为 $ETrF_{\\text{true}}(d) = ETrF_{\\text{interp}}(d) + e_d$，其中 $ETrF_{\\text{interp}}(d)$ 是经过钳位的插值。扰动 $e_d$ 是独立的、零均值的，具有已知的标准差 $\\sigma$ 和幅度界限 $|e_d| \\le b$。\n- **不确定性聚合**：\n    1.  单标准差不确定性（概率性）：$\\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} \\left(\\sigma \\cdot ETr(d)\\right)^2}$。\n    2.  最坏情况绝对界限（确定性）：$U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d)$。\n- **测试用例 1**：\n    - $D = 10$。\n    - $ETr(d)$：$[6.0, 6.1, 6.2, 6.0, 5.8, 5.7, 5.9, 6.0, 6.3, 6.4]$ $\\mathrm{mm \\, d^{-1}}$。\n    - 观测：日期 $[1, 3, 5, 7, 10]$，对应的 $ETrF$ 值为 $[0.9, 0.85, 1.0, 0.95, 0.8]$。\n    - 阴天 $\\mathcal{C} = \\{4, 6, 8, 9\\}$。\n    - $L = 1.3$，$\\sigma = 0.05$，$b = 0.10$。\n- **测试用例 2**：\n    - $D = 8$。\n    - $ETr(d)$：$[5.0, 5.1, 5.2, 5.0, 4.9, 4.8, 4.9, 5.0]$ $\\mathrm{mm \\, d^{-1}}$。\n    - 观测：日期 $[1, 2, 3, 4, 8]$，对应的 $ETrF$ 值为 $[0.6, 0.7, 0.9, 1.2, 1.0]$。\n    - 阴天 $\\mathcal{C} = \\{5, 6, 7\\}$。\n    - $L = 1.3$，$\\sigma = 0.02$，$b = 0.04$。\n- **测试用例 3**：\n    - $D = 12$。\n    - $ETr(d)$：$[5.5, 5.6, 5.7, 5.8, 6.0, 6.2, 6.1, 6.0, 5.9, 5.8, 5.7, 5.6]$ $\\mathrm{mm \\, d^{-1}}$。\n    - 观测：日期 $[1, 4, 6, 9, 12]$，对应的 $ETrF$ 值为 $[0.8, 0.95, 1.5, 1.1, 0.85]$。\n    - 阴天 $\\mathcal{C} = \\{2, 3, 5, 7, 8, 10, 11\\}$。\n    - $L = 1.3$，$\\sigma = 0.08$，$b = 0.12$。\n- **输出要求**：对于每个测试用例，一个包含三个数字的列表：$[ET_a, \\sigma_{ET}, U_{\\text{wc}}]$，每个值四舍五入到三位小数。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题在科学上基于已建立的遥感方法学（SEBAL/METRIC）。使用分段线性插值来填补卫星衍生的时间序列中的空白是一种标准且物理上合理的技术，它代表了观测之间地表条件（例如，植被健康状况）缓慢变化的假设。$ETrF$ 的钳位是一种有效的物理约束，因为实际蒸散发与参考蒸散发之比在物理上是有界的。不确定性分析对概率性估计采用标准的线性误差传播，对最坏情况界限采用确定性求和，这两种方法都适用于给定的模型。\n\n该问题是适定的。每个测试用例所需的所有数据和参数（$D$、$ETr$ 序列、观测点、云信息、钳位上限 $L$ 以及不确定性参数 $\\sigma, b$）都已明确提供。算法步骤定义明确，确保可以计算出唯一的解。问题陈述是客观的，没有非形式化或矛盾的元素。\n\n### 步骤 3：结论与行动\n问题是有效的。可以制定并实施一个分步解决方案。\n\n### 算法解决方案\n通过为每个测试用例遵循规定的操作序列来构建解决方案。\n\n1.  **重建 $ETrF$ 时间序列**：对于一个长度为 $D$ 的给定季节，我们定义一个从 1 到 $D$ 的日索引数组。提供的观测日及其对应的 $ETrF$ 值作为插值的锚点。应用分段线性插值来估计季节中所有日期的 $ETrF(d)$。插值函数还必须处理指定的外推规则：在第一次观测之前和最后一次观测之后保持数值恒定。`numpy.interp` 函数非常适合此任务，因为它执行分段线性插值，并且其对越界查询的默认行为是返回最近数据点的值。\n\n2.  **应用物理钳位**：然后对插值得到的 $ETrF(d)$ 时间序列施加物理合理性约束。序列中的每个值都被钳位到闭区间 $[0, L]$，其中 $L$ 是指定的上限。这确保了蒸发比不会取物理上不切实际的值。此操作可表示为 $ETrF_{\\text{clamped}}(d) = \\max(0, \\min(ETrF_{\\text{interp}}(d), L))$。\n\n3.  **计算季节性实际蒸散发 ($ET_a$)**：利用完整且经过钳位的每日 $ETrF(d)$ 序列，根据定义关系 $ET_a(d) = ETrF_{\\text{clamped}}(d) \\times ETr(d)$ 计算每日实际蒸散发 $ET_a(d)$。然后，总的季节性蒸散发是整个季节每日值的总和：$ET_a = \\sum_{d=1}^{D} ET_a(d)$。\n\n4.  **量化不确定性**：不确定性计算仅针对指定为阴天的日期 $d \\in \\mathcal{C}$ 执行。\n    \n    a. **概率性不确定性 ($\\sigma_{ET}$)**：这使用独立误差的线性传播公式计算。对于每个阴天 $d \\in \\mathcal{C}$，对总 $ET_a$ 的不确定性贡献是 $\\sigma \\cdot ETr(d)$。总标准差是这些个体贡献的方和根：\n    $$ \\sigma_{ET} = \\sqrt{\\sum_{d \\in \\mathcal{C}} (\\sigma \\cdot ETr(d))^2} $$\n    \n    b. **最坏情况界限 ($U_{\\text{wc}}$)**：这代表了如果阴天的所有扰动 $e_d$ 都朝同一方向（全部为正或全部为负）且达到其最大幅度 $b$ 时可能出现的最大偏差。总绝对误差界限是这些最大潜在误差的总和：\n    $$ U_{\\text{wc}} = \\sum_{d \\in \\mathcal{C}} b \\cdot ETr(d) $$\n    \n    根据问题陈述的模型，这些计算是基于给定的 $ETr(d)$ 序列和指定的参数 $\\sigma$ 和 $b$ 进行的，与插值的 $ETrF$ 值无关。\n\n5.  **最终输出格式化**：对于每个测试用例，将计算出的三个值（$ET_a$, $\\sigma_{ET}$, $U_{\\text{wc}}$）四舍五入到恰好三位小数，并格式化为指定的列表的列表结构。\n\n这个系统化的程序确保了问题陈述中的所有约束和定义都得到精确满足。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the seasonal evapotranspiration reconstruction and uncertainty problem\n    for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"D\": 10,\n            \"etr\": [6.0, 6.1, 6.2, 6.0, 5.8, 5.7, 5.9, 6.0, 6.3, 6.4],\n            \"obs_days\": [1, 3, 5, 7, 10],\n            \"obs_etrf\": [0.9, 0.85, 1.0, 0.95, 0.8],\n            \"cloudy_days\": {4, 6, 8, 9},\n            \"L\": 1.3,\n            \"sigma\": 0.05,\n            \"b\": 0.10,\n        },\n        {\n            \"D\": 8,\n            \"etr\": [5.0, 5.1, 5.2, 5.0, 4.9, 4.8, 4.9, 5.0],\n            \"obs_days\": [1, 2, 3, 4, 8],\n            \"obs_etrf\": [0.6, 0.7, 0.9, 1.2, 1.0],\n            \"cloudy_days\": {5, 6, 7},\n            \"L\": 1.3,\n            \"sigma\": 0.02,\n            \"b\": 0.04,\n        },\n        {\n            \"D\": 12,\n            \"etr\": [5.5, 5.6, 5.7, 5.8, 6.0, 6.2, 6.1, 6.0, 5.9, 5.8, 5.7, 5.6],\n            \"obs_days\": [1, 4, 6, 9, 12],\n            \"obs_etrf\": [0.8, 0.95, 1.5, 1.1, 0.85],\n            \"cloudy_days\": {2, 3, 5, 7, 8, 10, 11},\n            \"L\": 1.3,\n            \"sigma\": 0.08,\n            \"b\": 0.12,\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        D = case[\"D\"]\n        etr_series = np.array(case[\"etr\"])\n        obs_days = np.array(case[\"obs_days\"])\n        obs_etrf = np.array(case[\"obs_etrf\"])\n        cloudy_days = case[\"cloudy_days\"]\n        L = case[\"L\"]\n        sigma = case[\"sigma\"]\n        b = case[\"b\"]\n\n        # Define the full range of days for the season (1-based index)\n        season_days = np.arange(1, D + 1)\n\n        # Step 1: Reconstruct ETrF series using piecewise-linear interpolation.\n        # np.interp handles constant extrapolation at the ends by default.\n        etrf_interp = np.interp(season_days, obs_days, obs_etrf)\n\n        # Step 2: Apply the physical plausibility clamping.\n        etrf_clamped = np.clip(etrf_interp, 0, L)\n\n        # Step 3: Compute seasonal actual evapotranspiration (ETa).\n        eta_daily = etrf_clamped * etr_series\n        seasonal_eta = np.sum(eta_daily)\n\n        # Step 4: Quantify uncertainty from cloudy days.\n        # Get 0-based indices for cloudy days to slice the etr_series array.\n        cloudy_indices_0based = np.array(sorted(list(cloudy_days))) - 1\n        etr_on_cloudy_days = etr_series[cloudy_indices_0based]\n\n        # Calculate one-standard-deviation uncertainty (sigma_ET).\n        sigma_et_terms = (sigma * etr_on_cloudy_days) ** 2\n        sigma_et = np.sqrt(np.sum(sigma_et_terms))\n\n        # Calculate worst-case absolute bound (U_wc).\n        uwc_terms = b * etr_on_cloudy_days\n        u_wc = np.sum(uwc_terms)\n        \n        # Collect results for this case.\n        result_tuple = (seasonal_eta, sigma_et, u_wc)\n        all_results.append(result_tuple)\n\n    # Format the final output string exactly as required.\n    # Numbers are rounded to 3 decimal places using f-string formatting.\n    formatted_results = [f\"[{r[0]:.3f},{r[1]:.3f},{r[2]:.3f}]\" for r in all_results]\n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}