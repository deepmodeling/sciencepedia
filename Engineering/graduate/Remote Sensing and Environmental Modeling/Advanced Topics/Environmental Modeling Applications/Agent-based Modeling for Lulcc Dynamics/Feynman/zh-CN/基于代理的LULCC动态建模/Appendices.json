{
    "hands_on_practices": [
        {
            "introduction": "将理论模型转化为可执行的计算代码是基于智能体的模型（ABM）研究的核心挑战。本练习将指导您从头开始构建一个完整的、空间显式的土地利用和土地覆被变化（LULCC）ABM 。通过为每个地块的智能体定义结合了私利（如农业利润）和公共利益（如生态系统服务价值）的效用函数，您将亲身体验如何在模型中量化复杂的决策过程，并模拟不同政策权重下的系统动态。",
            "id": "3795634",
            "problem": "考虑一个用于土地利用和土地覆被变化（LULCC）的基于网格的基于智能体的模型，其中每个网格单元由一个代表性智能体控制，该智能体选择一种土地利用方式以最大化一个整合了私人利润和生态系统服务估值的效用函数。智能体面临转换成本和破碎化惩罚。模型参数和更新规则使用基本的微观经济学和环境建模原则来定义。\n\n网格与索引：\n- 设网格大小为 $N \\times N$，其中 $N=5$，索引为 $(i,j)$，其中 $i,j \\in \\{0,1,2,3,4\\}$。\n- 定义中心坐标为 $(i_c,j_c) = \\left(\\frac{N-1}{2},\\frac{N-1}{2}\\right) = (2,2)$。\n\n遥感代理指标：\n- 归一化植被指数（NDVI）代理指标 $v_{i,j}$：$$v_{i,j} = 0.2 + 0.8 \\cdot \\frac{i + j}{2(N - 1)}$$\n- 坡度代理指标 $r_{i,j}$：$$r_{i,j} = \\frac{|i - j|}{N - 1}$$\n- 使用到中心的归一化欧几里得距离计算的可达性代理指标 $H_{i,j}$：\n  $$d_{i,j} = \\sqrt{(i - i_c)^2 + (j - j_c)^2}, \\quad d_{\\max} = \\sqrt{2}\\cdot\\frac{N-1}{2}, \\quad H_{i,j} = 1 - \\frac{d_{i,j}}{d_{\\max}}$$\n\n土地利用类型：\n- 土地利用类型集合为 $\\{A,F,U\\}$，其中 $A$ 代表农业， $F$ 代表林业， $U$ 代表城市。\n\n每个地块 $(i,j)$ 上每种土地利用类型 $L \\in \\{A,F,U\\}$ 的私人利润组成部分：\n- 农业：产量 $Y_{i,j} = y_0 \\cdot v_{i,j}$，利润 $\\pi^A_{i,j} = P_A \\cdot Y_{i,j}$。\n- 林业：木材代理指标 $T_{i,j} = t_0 \\cdot v_{i,j}$，利润 $\\pi^F_{i,j} = P_F \\cdot T_{i,j}$。\n- 城市：由可达性驱动的利润 $\\pi^U_{i,j} = P_U \\cdot H_{i,j}$。\n- 使用归一化系数 $y_0 = 1.0$, $t_0 = 0.8$, $P_A = 1.0$, $P_F = 0.7$, $P_U = 1.5$。\n\n生态系统服务估值（社会效益）组成部分：\n- 农业：侵蚀外部性 $b^A_{i,j} = -\\alpha \\cdot r_{i,j}$。\n- 林业：碳汇 $b^F_{i,j} = \\beta \\cdot v_{i,j}$。\n- 城市：服务损失 $b^U_{i,j} = -\\gamma \\cdot v_{i,j}$。\n- 使用系数 $\\alpha = 0.5$, $\\beta = 1.2$, $\\gamma = 1.0$。\n\n智能体效用、转换成本和破碎化惩罚：\n- 设 $w \\in [0,1]$ 表示智能体效用中生态系统服务的权重。\n- 设 $c \\ge 0$ 表示智能体在时间步之间改变土地利用类型时产生的转换成本。\n- 设 $\\phi \\ge 0$ 表示破碎化惩罚系数。对于一个候选的土地利用类型 $L$ 和当前的邻域配置，定义\n  $$\\Delta_{i,j}(L) = \\frac{1}{4} \\sum_{(p,q) \\in \\mathcal{N}_{i,j}} \\mathbf{1}\\{L \\ne L_{p,q}^{\\text{prev}}\\},$$\n  其中 $\\mathcal{N}_{i,j}$ 是 $(i,j)$ 的最多四个正交邻居（上、下、左、右）的集合， $L_{p,q}^{\\text{prev}}$ 是邻居之前的土地利用类型。\n- 地块 $(i,j)$ 在前一土地利用类型为 $L_{i,j}^{\\text{prev}}$ 的情况下选择土地利用类型 $L$ 的效用为\n  $$U_{i,j}(L) = (1 - w) \\cdot \\pi^L_{i,j} + w \\cdot b^L_{i,j} - c \\cdot \\mathbf{1}\\{L \\ne L_{i,j}^{\\text{prev}}\\} - \\phi \\cdot \\Delta_{i,j}(L)$$\n\n决策规则与动态：\n- 时间是离散的，时间范围为 $T = 3$。在每个时间步 $t \\in \\{1,2,3\\}$，智能体通过选择使 $U_{i,j}(L)$ 最大化的 $L \\in \\{A,F,U\\}$ 来同步更新土地利用，该效用是使用前一步的配置计算的。\n- 如果不同土地利用类型的效用值出现平局，则按优先顺序 $F \\succ A \\succ U$（林业优于农业，农业优于城市）确定性地打破平局。\n\n初始化：\n- 初始土地利用类型 $L_{i,j}^{(0)}$ 根据代理指标确定性地分配：\n  $$L_{i,j}^{(0)} = \n  \\begin{cases}\n  U  \\text{如果 } H_{i,j} \\ge 0.75,\\\\\n  F  \\text{否则如果 } v_{i,j} \\ge 0.6,\\\\\n  A  \\text{其他情况。}\n  \\end{cases}$$\n\n输出：\n- 在 $T = 3$ 个时间步后，计算最终配置的以下指标：\n  - 农业、林业和城市地块的比例：$f_A$、$f_F$、$f_U$，每个都表示为 $[0,1]$ 范围内的小数。\n  - 总私人利润 $\\Pi_{\\text{tot}} = \\sum_{i,j} \\pi^{L_{i,j}^{(T)}}_{i,j}$（无量纲的归一化货币指数）。\n  - 总社会效益 $B_{\\text{tot}} = \\sum_{i,j} b^{L_{i,j}^{(T)}}_{i,j}$（无量纲的生态系统服务估值指数）。\n\n测试套件：\n- 对于每个测试用例，参数 $(w,c,\\phi)$ 分别为：\n  1. $(0.0, 0.0, 0.0)$，纯私人利润且无成本的边界情况。\n  2. $(0.5, 0.2, 0.1)$，成本和破碎化惩罚适中的均衡权衡情况。\n  3. $(0.8, 0.2, 0.1)$，成本适中但侧重社会效益的加权情况。\n  4. $(1.0, 0.0, 0.1)$，纯社会效益，无转换成本。\n  5. $(0.25, 0.5, 0.2)$，在偏向利润的机制下，具有高转换成本和较高破碎化惩罚的情况。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果，每个测试用例的结果本身是一个由方括号括起来的逗号分隔列表，包含五个小数，保留六位小数，顺序为 $[f_A,f_F,f_U,\\Pi_{\\text{tot}},B_{\\text{tot}}]$。例如：$[[0.20,0.60,0.20,10.000000,5.000000],[\\dots],\\dots]$。",
            "solution": "该模型基于微观经济学的效用最大化原理，并整合了生态系统服务估值，结合了环境经济学和遥感代理指标中公认的概念。每个控制地块的智能体选择一种土地利用方式，以最大化一个在私人盈利能力和社会效益之间进行权衡的效用函数，同时受到转换成本和破碎化惩罚的约束。\n\n基础与代理指标：\n- 归一化植被指数（NDVI）代理指标 $v_{i,j}$ 作为生物量和潜在生产力的指标，适合作为农业产量和林业木材潜力的标量乘数。所选的函数形式 $v_{i,j} = 0.2 + 0.8 \\cdot \\frac{i + j}{2(N - 1)}$ 是一个在网格上的确定性梯度，确保值在 $[0.2,1.0]$ 范围内。\n- 坡度代理指标 $r_{i,j} = \\frac{|i - j|}{N - 1}$ 捕捉了一个沿对角线方向的简单地形梯度，这与坡度越高侵蚀风险越大的概念一致。\n- 可达性 $H_{i,j} = 1 - \\frac{d_{i,j}}{d_{\\max}}$ 使用到网格中心的归一化欧几里得距离，作为交通和市场准入的代理指标，其中 $H_{i,j} \\in [0,1]$。\n\n私人利润建模：\n- 农业利润为 $\\pi^A_{i,j} = P_A \\cdot y_0 \\cdot v_{i,j}$，其中 $P_A = 1.0$ 且 $y_0 = 1.0$，反映了生产力与 $v_{i,j}$ 成正比。\n- 林业利润为 $\\pi^F_{i,j} = P_F \\cdot t_0 \\cdot v_{i,j}$，其中 $P_F = 0.7$ 且 $t_0 = 0.8$，低于农业，因为假设其市场回报和生产强度较低。\n- 城市利润为 $\\pi^U_{i,j} = P_U \\cdot H_{i,j}$，其中 $P_U = 1.5$，由可达性驱动。\n\n生态系统服务估值：\n- 农业外部性 $b^A_{i,j} = -\\alpha \\cdot r_{i,j}$ 惩罚侵蚀风险，其中 $\\alpha = 0.5$。\n- 林业效益 $b^F_{i,j} = \\beta \\cdot v_{i,j}$ 估算了碳汇和栖息地服务价值，其中 $\\beta = 1.2$。\n- 城市外部性 $b^U_{i,j} = -\\gamma \\cdot v_{i,j}$ 惩罚植被服务的损失，其中 $\\gamma = 1.0$。\n\n效用整合与权衡：\n- 效用定义为\n  $$U_{i,j}(L) = (1 - w) \\cdot \\pi^L_{i,j} + w \\cdot b^L_{i,j} - c \\cdot \\mathbf{1}\\{L \\ne L_{i,j}^{\\text{prev}}\\} - \\phi \\cdot \\Delta_{i,j}(L),$$\n  其中 $w \\in [0,1]$ 是社会价值相对于私人利润的权重。这直接编码了权衡关系：较高的 $w$ 会增加生态系统服务的影响，可能偏好林业；较低的 $w$ 则偏好私人利润，根据 $H_{i,j}$ 和 $v_{i,j}$ 的值可能偏好城市或农业。\n\n破碎化惩罚：\n- 破碎化项 $\\Delta_{i,j}(L) = \\frac{1}{4} \\sum_{(p,q) \\in \\mathcal{N}_{i,j}} \\mathbf{1}\\{L \\ne L_{p,q}^{\\text{prev}}\\}$ 惩罚那些与紧邻邻域不一致的选择，通过鼓励空间上连贯的土地利用集群来减少景观破碎化。除以 $4$ 将惩罚归一化到 $[0,1]$ 范围内。\n\n动态与决策规则：\n- 智能体在 $T = 3$ 个时间步内同步更新，在计算 $\\Delta_{i,j}(L)$ 时使用邻居前一步的土地利用类型。这种同步更新反映了基于智能体的模型中的一种常见设计，即决策基于先前的配置。\n- 打破平局采用确定性顺序 $F \\succ A \\succ U$，以确保可复现性并避免随机结果。\n\n初始化原理：\n- 初始土地利用类型 $L_{i,j}^{(0)}$ 使用与经验直觉一致的阈值：高可达性地块（$H_{i,j} \\ge 0.75$）初始为城市；否则，高NDVI（$v_{i,j} \\ge 0.6$）地块初始为林业；其余地块初始为农业。这产生了一个具有合理空间结构的混合初始景观。\n\n每个测试用例 $(w,c,\\phi)$ 的算法步骤：\n1. 为所有地块 $(i,j)$ 计算 $v_{i,j}$、$r_{i,j}$ 和 $H_{i,j}$。\n2. 根据阈值规则初始化 $L_{i,j}^{(0)}$。\n3. 对于每个时间步 $t = 1,2,3$：\n   - 对于每个地块 $(i,j)$，使用 $\\pi^L_{i,j}$、$b^L_{i,j}$、相对于 $L_{i,j}^{(t-1)}$ 的转换成本以及基于时间 $t-1$ 邻居土地利用类型的破碎化惩罚 $\\Delta_{i,j}(L)$，计算效用 $U_{i,j}(A)$、$U_{i,j}(F)$ 和 $U_{i,j}(U)$。\n   - 选择效用最高的土地利用类型 $L$。如果出现平局，则根据 $F \\succ A \\succ U$ 进行选择。\n   - 同步更新所有 $L_{i,j}^{(t)}$。\n4. 在 $t=3$ 之后，计算：\n   - 通过计算每种土地利用类型的出现次数并除以 $N^2$ 来得到比例 $f_A$、$f_F$、$f_U$。\n   - 总私人利润 $\\Pi_{\\text{tot}} = \\sum_{i,j} \\pi^{L_{i,j}^{(3)}}_{i,j}$。\n   - 总社会效益 $B_{\\text{tot}} = \\sum_{i,j} b^{L_{i,j}^{(3)}}_{i,j}$。\n5. 将每个输出值四舍五入到六位小数，并按指定顺序报告。\n\n测试套件覆盖范围：\n- $(w,c,\\phi) = (0.0, 0.0, 0.0)$ 测试智能体仅最大化私人利润且无调整成本的边界情况。\n- $(w,c,\\phi) = (0.5, 0.2, 0.1)$ 测试在适度转换成本和破碎化惩罚下的均衡加权情况。\n- $(w,c,\\phi) = (0.8, 0.2, 0.1)$ 测试高度重视社会效益的情况，这应在 $v_{i,j}$ 高的区域偏好林地利用。\n- $(w,c,\\phi) = (1.0, 0.0, 0.1)$ 测试决策完全由生态系统服务驱动的极端情况；破碎化仍然抑制分散的变化。\n- $(w,c,\\phi) = (0.25, 0.5, 0.2)$ 测试在偏向利润的机制下，由于高转换成本和更强的破碎化惩罚而产生的对变化的抵抗力。\n\n最终输出格式：\n- 单独打印的一行必须是一个由方括号括起来的逗号分隔列表，其中包含每个测试用例的方括号括起来的结果，不含空格，每个子列表包含 $[f_A,f_F,f_U,\\Pi_{\\text{tot}},B_{\\text{tot}}]$，四舍五入到六位小数，例如：$[[0.240000,0.520000,0.240000,12.345678,3.210987],[\\dots],\\dots]$。\n\n该公式遵循第一性原理的效用最大化决策，并整合了生态系统服务估值，从而可以在不同参数机制下对私人利润和社会福利之间的权衡进行透明分析。",
            "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\n# Land use labels\nA = 0  # Agriculture\nF = 1  # Forest\nU = 2  # Urban\n\ndef compute_proxies(N):\n    # NDVI proxy v, slope proxy r, accessibility proxy H\n    v = np.zeros((N, N), dtype=float)\n    r = np.zeros((N, N), dtype=float)\n    H = np.zeros((N, N), dtype=float)\n    ic = (N - 1) / 2.0\n    jc = (N - 1) / 2.0\n    dmax = np.sqrt(2.0) * (N - 1) / 2.0\n    for i in range(N):\n        for j in range(N):\n            v[i, j] = 0.2 + 0.8 * ((i + j) / (2.0 * (N - 1)))\n            r[i, j] = abs(i - j) / (N - 1)\n            di = np.sqrt((i - ic)**2 + (j - jc)**2)\n            H[i, j] = 1.0 - (di / dmax)\n    return v, r, H\n\ndef initialize_land_use(v, H):\n    # Threshold-based initialization:\n    # U if H >= 0.75, else F if v >= 0.6, else A\n    N = v.shape[0]\n    L0 = np.zeros((N, N), dtype=int)\n    for i in range(N):\n        for j in range(N):\n            if H[i, j] >= 0.75:\n                L0[i, j] = U\n            elif v[i, j] >= 0.6:\n                L0[i, j] = F\n            else:\n                L0[i, j] = A\n    return L0\n\ndef compute_profits_and_benefits(v, r, H, params):\n    # params contains y0, t0, P_A, P_F, P_U, alpha, beta, gamma\n    y0, t0, P_A, P_F, P_U, alpha, beta, gamma = params\n    pi_A = P_A * (y0 * v)\n    pi_F = P_F * (t0 * v)\n    pi_U = P_U * H\n\n    b_A = -alpha * r\n    b_F = beta * v\n    b_U = -gamma * v\n\n    return pi_A, pi_F, pi_U, b_A, b_F, b_U\n\ndef neighbors(i, j, N):\n    # Return list of neighbor indices (up to 4-neighborhood)\n    neigh = []\n    if i > 0:\n        neigh.append((i - 1, j))\n    if i < N - 1:\n        neigh.append((i + 1, j))\n    if j > 0:\n        neigh.append((i, j - 1))\n    if j < N - 1:\n        neigh.append((i, j + 1))\n    return neigh\n\ndef simulate(N, T, w, c, phi, v, r, H, profits_benefits, L0):\n    # Unpack profits and benefits\n    pi_A, pi_F, pi_U, b_A, b_F, b_U = profits_benefits\n\n    # Tie-breaker priority: F > A > U\n    priority = {F: 2, A: 1, U: 0}\n\n    L_prev = L0.copy()\n    for t in range(1, T + 1):\n        L_next = np.zeros_like(L_prev)\n        for i in range(N):\n            for j in range(N):\n                # Fragmentation penalty computed using neighbors from previous step\n                neigh_idxs = neighbors(i, j, N)\n\n                # Candidate land uses\n                candidates = [A, F, U]\n                utilities = []\n                for L in candidates:\n                    # Private profit and social benefit for chosen L\n                    if L == A:\n                        pi = pi_A[i, j]\n                        b = b_A[i, j]\n                    elif L == F:\n                        pi = pi_F[i, j]\n                        b = b_F[i, j]\n                    else:  # U\n                        pi = pi_U[i, j]\n                        b = b_U[i, j]\n\n                    # Switching cost if change from previous\n                    switch = 1.0 if L != L_prev[i, j] else 0.0\n\n                    # Fragmentation penalty: fraction of neighbors not matching L divided by 4\n                    mismatch = 0.0\n                    for (p, q) in neigh_idxs:\n                        if L != L_prev[p, q]:\n                            mismatch += 1.0\n                    delta = mismatch / 4.0\n\n                    UijL = (1.0 - w) * pi + w * b - c * switch - phi * delta\n                    utilities.append((UijL, priority[L], L))\n\n                # Choose max utility, tie-breaking by priority\n                # Sort by utility then priority\n                utilities.sort(key=lambda tup: (tup[0], tup[1]), reverse=True)\n                chosen_L = utilities[0][2]\n                L_next[i, j] = chosen_L\n        L_prev = L_next\n\n    # Compute final fractions and totals\n    total_cells = float(N * N)\n    fA = float(np.sum(L_prev == A)) / total_cells\n    fF = float(np.sum(L_prev == F)) / total_cells\n    fU = float(np.sum(L_prev == U)) / total_cells\n\n    # Totals\n    Pi_tot = 0.0\n    B_tot = 0.0\n    for i in range(N):\n        for j in range(N):\n            L = L_prev[i, j]\n            if L == A:\n                Pi_tot += pi_A[i, j]\n                B_tot += b_A[i, j]\n            elif L == F:\n                Pi_tot += pi_F[i, j]\n                B_tot += b_F[i, j]\n            else:\n                Pi_tot += pi_U[i, j]\n                B_tot += b_U[i, j]\n\n    return fA, fF, fU, Pi_tot, B_tot\n\ndef format_result_list(results):\n    # Results is a list of tuples/lists of floats.\n    # Produce string like [[a,b,c,d,e],[...],...], with values rounded to 6 decimals and no spaces.\n    def fmt(vals):\n        return \"[\" + \",\".join(f\"{x:.6f}\" for x in vals) + \"]\"\n    return \"[\" + \",\".join(fmt(res) for res in results) + \"]\"\n\ndef solve():\n    N = 5\n    T = 3\n\n    # Base parameters\n    y0 = 1.0\n    t0 = 0.8\n    P_A = 1.0\n    P_F = 0.7\n    P_U = 1.5\n    alpha = 0.5\n    beta = 1.2\n    gamma = 1.0\n    params = (y0, t0, P_A, P_F, P_U, alpha, beta, gamma)\n\n    # Compute proxies\n    v, r, H = compute_proxies(N)\n\n    # Initialize land use\n    L0 = initialize_land_use(v, H)\n\n    # Compute profits and benefits (constant across test cases)\n    profits_benefits = compute_profits_and_benefits(v, r, H, params)\n\n    # Test cases: (w, c, phi)\n    test_cases = [\n        (0.0, 0.0, 0.0),  # Pure private profit, no costs\n        (0.5, 0.2, 0.1),  # Balanced trade-off, moderate costs\n        (0.8, 0.2, 0.1),  # Social-benefit-heavy\n        (1.0, 0.0, 0.1),  # Pure social benefit\n        (0.25, 0.5, 0.2), # Profit-leaning, high switching  fragmentation cost\n    ]\n\n    results = []\n    for (w, c, phi) in test_cases:\n        fA, fF, fU, Pi_tot, B_tot = simulate(N, T, w, c, phi, v, r, H, profits_benefits, L0)\n        results.append((fA, fF, fU, Pi_tot, B_tot))\n\n    # Final print statement in the exact required format.\n    print(format_result_list(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "基于智能体的模型（ABM）的输出本质上是随机的，因此，获得可靠的统计结果至关重要。本练习模拟了一个常见的研究情景：为了以一定的置信水平估算模型的平均输出（例如年均森林转化率），我们需要运行多少次随机重复实验？。这个实践将教您如何应用中心极限定理，综合考虑模型内在随机性和外部数据（如遥感分类）不确定性的影响，科学地确定所需的最少模拟次数。",
            "id": "3795593",
            "problem": "一个土地利用和土地覆盖变化（LULCC）动态的基于智能体的模型（ABM）被用来模拟一个固定景观和时间范围内的年度森林向农业转换过程。ABM 的每次随机重复实验（由 $k \\in \\{1, \\dots, n\\}$ 索引）产生一个标量输出 $\\hat{r}_{k}$，其定义为模拟时间范围内的年平均转换率（单位为 $\\mathrm{year}^{-1}$）。在各次重复实验中，$\\hat{r}_{k}$ 被视为一个随机变量 $R$ 的独立同分布实现，其均值为 $\\mu$，方差为 $\\sigma^{2}$。除了来自智能体决策和交互的随机性外，转换率的估计值还包含了模型校准和评估中使用的卫星分类误差所传播的不确定性，这可以表示为一个可加的、独立的方差贡献。\n\n一项包含 $R_{\\mathrm{pilot}} = 12$ 次独立重复实验的预研究得出了 $R$ 的样本方差估计值 $s_{\\mathrm{pilot}}^{2} = 1.44 \\times 10^{-4} \\ \\mathrm{year}^{-2}$，这可归因于模型的随机性。从分类混淆矩阵的误差传播，为每次重复实验的率估计值产生了一个近似独立的、可加的方差分量 $v_{e} = 2.5 \\times 10^{-5} \\ \\mathrm{year}^{-2}$，这是由遥感分类的不确定性造成的。假设各次重复实验相互独立，且中心极限定理适用于样本均值 $\\bar{R}_{n} = \\frac{1}{n} \\sum_{k=1}^{n} \\hat{r}_{k}$。\n\n您希望计划所需的随机重复实验次数 $n$，以使基于 $\\bar{R}_{n}$ 的 $\\mu$ 的双侧 $95\\%$ 置信区间的半宽最多为 $h = 0.005 \\ \\mathrm{year}^{-1}$。从基本统计原理（即中心极限定理和样本均值的方差）出发，使用正态近似进行规划，推导出所需最小 $n$ 的解析表达式，该表达式用临界值、期望的半宽和方差分量表示。然后，使用所提供的数值计算该表达式。报告满足要求的最小整数 $n$。最终报告的整数中不应包含单位。如果任何中间计算需要四舍五入，请保留足够的精度以确保最终整数的正确性；将满足约束的最小整数作为最终答案报告。",
            "solution": "已经根据指定的验证标准对用户提供的问题进行了评估。\n\n### 步骤 1：提取已知条件\n- **模型类型**：用于土地利用和土地覆盖变化（LULCC）动态的基于智能体的模型（ABM）。\n- **重复实验索引**：$k \\in \\{1, \\dots, n\\}$。\n- **重复实验输出**：$\\hat{r}_{k}$，年平均转换率（单位为 $\\mathrm{year}^{-1}$），是随机变量 $R$ 的一个独立同分布（i.i.d.）实现。\n- **$R$ 的参数**：均值 $\\mu$ 和方差 $\\sigma^{2}$。\n- **预研究重复次数**：$R_{\\mathrm{pilot}} = 12$。\n- **预研究样本方差**：$s_{\\mathrm{pilot}}^{2} = 1.44 \\times 10^{-4} \\ \\mathrm{year}^{-2}$。这是可归因于模型随机性的方差分量。\n- **分类误差方差**：$v_{e} = 2.5 \\times 10^{-5} \\ \\mathrm{year}^{-2}$。这是一个可加的、独立的方差分量。\n- **样本均值**：$\\bar{R}_{n} = \\frac{1}{n} \\sum_{k=1}^{n} \\hat{r}_{k}$。\n- **假设**：中心极限定理（CLT）适用于 $\\bar{R}_{n}$。\n- **目标**：为计划的研究确定重复实验次数 $n$。\n- **约束条件**：$\\mu$ 的双侧 $95\\%$ 置信区间的半宽必须最多为 $h = 0.005 \\ \\mathrm{year}^{-1}$。\n- **方法**：使用正态近似进行规划。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题被评估为有效。\n- **科学依据**：该问题是一个标准的统计样本量计算，是设计计算实验中的一项基本任务。ABM、LULCC 和遥感误差传播的背景是一个成熟的科学研究领域。\n- **良构问题**：该问题提供了所有必要的数据和假设（CLT、方差分量的独立性、置信水平、期望精度），以推导出关于最小重复实验次数 $n$ 的唯一且有意义的解。\n- **客观性**：该问题使用精确、定量和无偏的语言进行陈述。\n该问题没有提示中列出的任何缺陷，如科学上不合理、不完整、矛盾或含糊不清。用于表示预研究重复次数的符号 $R_{\\mathrm{pilot}}$ 略显不寻常，但其含义被明确定义为“12 次独立重复实验”，因此没有歧义。\n\n### 步骤 3：结论与行动\n该问题是有效的。下面是完整的、带推理的解答。\n\n目标是找到最小的随机重复实验次数 $n$，使得平均转换率 $\\mu$ 的双侧 $95\\%$ 置信区间的半宽不大于指定值 $h$。\n\n根据中心极限定理，对于足够大的重复实验次数 $n$，样本均值 $\\bar{R}_{n}$ 的分布可以由一个正态分布近似，其均值为 $\\mu$，方差为 $\\frac{\\sigma_{\\text{total}}^{2}}{n}$，其中 $\\sigma_{\\text{total}}^{2}$ 是单次重复实验输出 $\\hat{r}_k$ 的总方差。\n\n$\\mu$ 的一个双侧 $(1-\\alpha) \\times 100\\%$ 置信区间由下式给出：\n$$ \\bar{R}_{n} \\pm h $$\n其中半宽 $h$ 定义为：\n$$ h = z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\bar{R}_{n}) = z_{1-\\alpha/2} \\frac{\\sigma_{\\text{total}}}{\\sqrt{n}} $$\n此处，$z_{1-\\alpha/2}$ 是对应于所需置信水平的标准正态分布的临界值，而 $\\mathrm{SE}(\\bar{R}_{n})$ 是样本均值的标准误。\n\n问题指定了 $95\\%$ 的置信水平，所以 $1-\\alpha = 0.95$，这意味着 $\\alpha = 0.05$。相应的临界值是 $z_{1-\\alpha/2} = z_{0.975}$。$z_{0.975}$ 的标准值约为 $1.96$。\n\n单次重复实验输出的总方差 $\\sigma_{\\text{total}}^{2}$ 是各独立方差分量之和。第一个分量是由于模型随机性引起的方差，我们使用预研究的样本方差 $s_{\\text{pilot}}^{2}$ 对其进行估计。第二个分量是遥感分类不确定性带来的方差 $v_{e}$。\n$$ \\sigma_{\\text{total}}^{2} = s_{\\text{pilot}}^{2} + v_{e} $$\n为了规划目的，我们将此和视为真实的总体方差。\n\n我们得到的约束条件是半宽最多为 $h$：\n$$ z_{1-\\alpha/2} \\frac{\\sigma_{\\text{total}}}{\\sqrt{n}} \\le h $$\n为了求出所需的重复实验次数 $n$，我们对这个不等式求解 $n$：\n$$ \\sqrt{n} \\ge \\frac{z_{1-\\alpha/2} \\sigma_{\\text{total}}}{h} $$\n两边平方得：\n$$ n \\ge \\left( \\frac{z_{1-\\alpha/2} \\sigma_{\\text{total}}}{h} \\right)^2 $$\n代入总方差的表达式，我们得到所需最小 $n$ 的解析表达式：\n$$ n \\ge \\frac{z_{1-\\alpha/2}^2 \\sigma_{\\text{total}}^2}{h^2} = \\frac{z_{1-\\alpha/2}^2 (s_{\\text{pilot}}^{2} + v_{e})}{h^2} $$\n现在，我们将问题陈述中提供的数值代入此表达式。\n给定的值为：\n- $s_{\\text{pilot}}^{2} = 1.44 \\times 10^{-4} \\ \\mathrm{year}^{-2}$\n- $v_{e} = 2.5 \\times 10^{-5} \\ \\mathrm{year}^{-2}$\n- $h = 0.005 \\ \\mathrm{year}^{-1}$\n- $z_{0.975} \\approx 1.96$\n\n首先，计算总方差 $\\sigma_{\\text{total}}^{2}$：\n$$ \\sigma_{\\text{total}}^{2} = 1.44 \\times 10^{-4} + 2.5 \\times 10^{-5} = 1.44 \\times 10^{-4} + 0.25 \\times 10^{-4} = 1.69 \\times 10^{-4} \\ \\mathrm{year}^{-2} $$\n接下来，将这个值和其他值代入关于 $n$ 的不等式中：\n$$ n \\ge \\frac{(1.96)^2 (1.69 \\times 10^{-4})}{(0.005)^2} $$\n我们来计算各项的值：\n$$ (1.96)^2 = 3.8416 $$\n$$ (0.005)^2 = (5 \\times 10^{-3})^2 = 25 \\times 10^{-6} = 2.5 \\times 10^{-5} $$\n现在，计算 $n$ 的值：\n$$ n \\ge \\frac{3.8416 \\times 1.69 \\times 10^{-4}}{2.5 \\times 10^{-5}} $$\n$$ n \\ge \\frac{6.492304 \\times 10^{-4}}{2.5 \\times 10^{-5}} $$\n$$ n \\ge \\left( \\frac{6.492304}{2.5} \\right) \\times 10^{-4 - (-5)} $$\n$$ n \\ge 2.5969216 \\times 10^{1} $$\n$$ n \\ge 25.969216 $$\n由于重复实验次数 $n$ 必须是整数，我们必须对这个值向上取整以满足不等式。满足要求的最小整数 $n$ 是大于或等于 $25.969216$ 的最小整数。\n$$ n_{\\min} = \\lceil 25.969216 \\rceil = 26 $$\n因此，为了达到平均转换率置信区间所需的精度，最少需要 $26$ 次随机重复实验。",
            "answer": "$$\\boxed{26}$$"
        },
        {
            "introduction": "建立模型后，下一步关键是理解不同驱动因素如何影响系统行为。本练习将介绍因子实验设计，这是一种强大的统计方法，用于系统性地评估多个输入参数（如道路影响范围、政策执行强度）及其交互作用对模型输出（如森林保有率）的影响 。通过构建一个$2^{3}$全因子设计，您将学会如何超越简单的“一次只改一个参数”的分析方法，从而高效地探索参数空间，并精确估计关键驱动因素之间复杂的相互依赖关系。",
            "id": "3795628",
            "problem": "一个土地利用与土地覆被变化（LULCC）的基于智能体的模型（ABM）被用来在一个源自遥感土地覆被地图的空间网格上，模拟十年间的森林砍伐动态。输出响应是在模拟期末$T$时剩余的森林分数，记为$Y \\in [0,1]$。基于遥感产品和环境经济驱动因素，选择了三个科学上显著的驱动因素进行实验性操纵：道路影响衰减长度尺度（记为$\\lambda$）、政策执行强度（记为$\\eta$）和全球商品需求压力（记为$\\phi$）。每个驱动因素都在两个水平上进行研究，编码为$-1$（低）和$+1$（高），形成一个具有$2^{3}$个独特设置的全因子设计。对于每个设置，由于智能体层面的内在随机性，进行了$r$次独立的随机ABM运行，从而产生一个总运行次数为$N = 2^{3} r$的平衡重复设计。\n\n假设采用以下研究设计和统计模型：\n-   拟合到ABM输出的线性模型包括一个截距、所有三个主效应以及所有三个双向交互作用；为了保持简约性，排除了三向交互作用。设计矩阵对因子及其交互作用使用正交的$\\{-1,+1\\}$编码。\n-   ABM运行层面的误差是独立同分布的，均值为零，方差为$\\sigma^{2}$，且方差不依赖于设计设置（同方差性）。一项在固定设置下进行的预研究得出的$Y$单次运行标准差估计值为$\\sigma = 0.10$。\n-   置信区间使用学生t分布（Student-t distribution）在置信水平$0.95$下构建。\n\n您的任务是构建$2^{3}$因子设计，并确定所需的ABM最小总运行次数$N$，以使拟合模型中任何双向交互作用系数的双边置信区间半宽最多为$h = 0.02$（以森林分数为单位）。请用设计所隐含的最小整数$N$来表示您的答案。不需要按有效数字进行四舍五入；请报告最小的有效整数$N$。",
            "solution": "用户要求我找到为使估计的交互作用系数达到指定精度所需的基于主体的模型（ABM）的最小总运行次数$N$。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n-   **模型类型**：用于土地利用与土地覆被变化（LULCC）的基于智能体的模型（ABM）。\n-   **响应变量**：剩余森林分数，$Y \\in [0,1]$。\n-   **因子**：3个因子（$\\lambda$、$\\eta$、$\\phi$），每个因子2个水平，编码为-1和+1。\n-   **实验设计**：全因子$2^3$设计，每个设置有$r$次重复。\n-   **总运行次数**：$N = 2^3 r = 8r$。\n-   **统计模型**：一个线性模型，包含一个截距、3个主效应和所有3个双向交互作用。排除了三向交互作用。设计矩阵使用正交的$\\{-1, +1\\}$编码。\n-   **误差假设**：误差是独立同分布的（i.i.d.），均值为0，方差恒为$\\sigma^2$。\n-   **方差估计**：单次运行的标准差估计为$\\sigma = 0.10$。\n-   **置信区间**：基于置信水平为$0.95$的学生t分布。\n-   **精度要求**：任何双向交互作用系数的双边置信区间的半宽必须最多为$h = 0.02$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题设置在环境建模（LULCC）的背景下，并使用标准统计方法进行模拟实验的设计和分析（因子设计、线性回归）。这是一个成熟的科学实践。该问题在科学上是合理的。\n-   **定义明确**：问题被清晰地阐明。它提供了一个具体的目标（找到最小的$N$）和解决它所需的所有信息（模型结构、误差方差、期望精度、置信水平）。可以推导出一个唯一的、有意义的解。\n-   **客观性**：问题使用精确、正式、客观的语言陈述，没有任何主观或模棱两可的术语。\n-   **额外检查**：问题没有违反任何其他有效性标准。它是可形式化的、完整的、一致的并且是科学上可验证的。\n\n### 步骤3：结论与行动\n该问题是**有效的**。我将继续进行解答。\n\n单次运行的响应$Y$的线性模型由下式给出：\n$$Y_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\beta_3 x_{i3} + \\beta_{12} x_{i,12} + \\beta_{13} x_{i,13} + \\beta_{23} x_{i,23} + \\epsilon_i$$\n其中$x_{i1}, x_{i2}, x_{i3}$是第$i$次运行的三个主因子的编码水平（-1或+1）。交互作用项是主效应项的乘积，例如，$x_{i,12} = x_{i1}x_{i2}$。项$\\epsilon_i$代表第$i$次运行的随机误差，其中$\\epsilon_i \\sim \\text{i.i.d. } \\mathcal{N}(0, \\sigma^2)$。该模型有$p=7$个参数需要估计（一个截距，三个主效应，三个双向交互作用）。\n\n总运行次数为$N = 2^3 r = 8r$，其中$r$是8个独特实验设置中每个设置的重复次数。该模型的设计矩阵$X$是一个$N \\times p$矩阵。对于一个使用$\\{-1, +1\\}$编码和$r$次重复的$2^k$因子设计，设计矩阵的所有列（包括全为+1的截距列）都是相互正交的。$X$的任何一列中元素的平方和等于$N$。\n这种正交性意味着矩阵$X^T X$是一个对角矩阵：\n$$X^T X = \\text{diag}(N, N, N, N, N, N, N) = N \\cdot I_p$$\n其中$I_p$是$p \\times p$的单位矩阵，$p=7$。\n\n估计系数的向量由$\\hat{\\boldsymbol{\\beta}} = (X^T X)^{-1} X^T \\mathbf{Y}$给出。这些估计的方差-协方差矩阵是：\n$$\\text{Var}(\\hat{\\boldsymbol{\\beta}}) = (X^T X)^{-1} \\sigma^2 = (N \\cdot I_p)^{-1} \\sigma^2 = \\frac{\\sigma^2}{N} I_p$$\n这个结果表明，任何估计系数$\\hat{\\beta}_j$（无论是主效应还是交互作用）的方差都是相同的：\n$$\\text{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{N}$$\n因此，任何系数估计的标准误（SE）是：\n$$\\text{SE}(\\hat{\\beta}_j) = \\sqrt{\\frac{\\sigma^2}{N}} = \\frac{\\sigma}{\\sqrt{N}}$$\n系数$\\beta_j$的双边置信区间构建为$\\hat{\\beta}_j \\pm h$，其中$h$是半宽，由下式给出：\n$$h = t_{\\alpha/2, \\nu} \\cdot \\text{SE}(\\hat{\\beta}_j)$$\n这里，置信水平是$0.95$，所以$\\alpha = 1 - 0.95 = 0.05$，且$\\alpha/2 = 0.025$。误差项的自由度$\\nu$是总运行次数减去估计参数的数量：$\\nu = N - p = N - 7$。\n\n我们被给予的要求是半宽$h$必须最多为$0.02$。我们还被给予估计值$\\sigma = 0.10$。现在我们可以建立一个不等式来求解$N$：\n$$t_{0.025, N-7} \\cdot \\frac{\\sigma}{\\sqrt{N}} \\le h$$\n$$t_{0.025, N-7} \\cdot \\frac{0.10}{\\sqrt{N}} \\le 0.02$$\n重新整理不等式以求解$N$：\n$$\\frac{\\sqrt{N}}{t_{0.025, N-7}} \\ge \\frac{0.10}{0.02}$$\n$$\\sqrt{N} \\ge 5 \\cdot t_{0.025, N-7}$$\n这个不等式必须对$N$求解。由于$N$既明确出现，又出现在t分布的自由度中，我们必须使用迭代方法或测试候选值。我们还有一个约束条件，$N$必须是$2^3=8$的整数倍，因为$N=8r$。\n\n对于大的$N$，学生t分布接近标准正态分布，其临界值$z_{0.025}$约为$1.96$。让我们用这个值来得到$N$的初始估计：\n$$\\sqrt{N} \\approx 5 \\times 1.96 = 9.8$$\n$$N \\approx (9.8)^2 = 96.04$$\n因为$N$必须是8的倍数，所以大于$96.04$的最小的8的整数倍是$104$。让我们检查$N=104$是否满足不等式。我们还需要检查$N=96$是否可能足够，因为我们的初始估计使用了近似值。\n\n测试 $N=96$：\n对于$N=96$，重复次数为$r = 96/8 = 12$。自由度为$\\nu = 96 - 7 = 89$。临界值为$t_{0.025, 89} \\approx 1.9870$。\n我们检查不等式：$\\sqrt{96} \\ge 5 \\cdot t_{0.025, 89}$\n$$9.798 \\ge 5 \\times 1.9870$$\n$$9.798 \\ge 9.935$$\n这个陈述是错误的。因此，$N=96$次运行是不够的。\n\n测试 $N=104$：\n对于$N=104$，重复次数为$r = 104/8 = 13$。自由度为$\\nu = 104 - 7 = 97$。临界值为$t_{0.025, 97} \\approx 1.9847$。\n我们检查不等式：$\\sqrt{104} \\ge 5 \\cdot t_{0.025, 97}$\n$$10.198 \\ge 5 \\times 1.9847$$\n$$10.198 \\ge 9.9235$$\n这个陈述是正确的。因此，$N=104$次运行是足够的。\n\n因为$N$必须是8的倍数，而$N=96$不足够，$N=104$足够，所以所需的ABM最小总运行次数是$104$。",
            "answer": "$$\\boxed{104}$$"
        }
    ]
}