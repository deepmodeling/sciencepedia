{
    "hands_on_practices": [
        {
            "introduction": "The foundation of all terrestrial thermal analysis rests on the physics of electromagnetic radiation. This exercise grounds your understanding by tasking you with a derivation of the Stefan-Boltzmann law for a realistic graybody surface, starting from the more fundamental Planck's law. By then calculating the error introduced by incorrectly assuming a surface is a perfect blackbody, you will gain a quantitative appreciation for the importance of emissivity, a critical parameter in every thermal remote sensing model .",
            "id": "3861005",
            "problem": "In a thermal anomaly detection workflow for terrestrial surfaces, an analyst estimates the upward longwave hemispheric radiative flux from a land surface pixel by inferring surface temperature from thermal infrared radiance and then applying a graybody surface model. Assume the following physically realistic conditions: the surface behaves as a Lambertian graybody of wavelength-independent emissivity, the atmosphere above the pixel is transparent in the thermal band used for temperature retrieval, and there is no reflected downwelling longwave contribution.\n\nStarting from Planck’s law for spectral radiance $B_{\\lambda}(T)$ and the definition of hemispheric exitance as the integral of directional radiance weighted by the cosine of the zenith angle over the hemisphere, derive the expression for the hemispheric radiative flux (exitance) $F$ of a Lambertian graybody as a function of emissivity $\\epsilon$ and temperature $T$. Then, evaluate the true flux for a mineral surface with emissivity $\\epsilon=0.95$ at temperature $T=320\\ \\mathrm{K}$.\n\nAn operational algorithm, however, erroneously assumes a perfect blackbody $\\epsilon=1$ for this pixel. Using your derived expression, compute the absolute error and the fractional error in the flux caused by this assumption. Use the Stefan–Boltzmann constant $\\sigma=5.670374419\\times 10^{-8}\\ \\mathrm{W\\ m^{-2}\\ K^{-4}}$. Express fluxes in $\\mathrm{W\\ m^{-2}}$ and the fractional error as a unitless decimal. Round all reported numbers to four significant figures.\n\nReport only the fractional error as your final numeric answer.",
            "solution": "The user-provided problem has been validated and is determined to be sound. It is scientifically grounded in the principles of radiative transfer and thermal physics, well-posed with a unique solution, and stated with objective, unambiguous language. All necessary data and boundary conditions are provided.\n\nThe problem requires the derivation of the hemispheric radiative flux for a Lambertian graybody and then the calculation of errors arising from a faulty blackbody assumption.\n\nFirst, we derive the expression for the hemispheric radiative flux, $F$.\nThe starting point is Planck's law for the spectral radiance of a blackbody, $B_{\\lambda}(T)$, which gives the radiance per unit wavelength, per unit solid angle. For a graybody with wavelength-independent emissivity $\\epsilon$, the spectral radiance $L_{\\lambda}$ is given by:\n$$L_{\\lambda} = \\epsilon B_{\\lambda}(T)$$\nThe problem states the surface is Lambertian, which means its radiance is uniform in all directions of the hemisphere above it. Thus, $L_{\\lambda}$ is independent of the zenith angle $\\theta$ and the azimuth angle $\\phi$.\n\nThe hemispheric exitance, or flux $F$, is the total power radiated per unit area into the hemisphere. It is found by integrating the directional radiance over the solid angle of the hemisphere. The spectral exitance $M_{\\lambda}$ (flux per unit wavelength) is given by:\n$$M_{\\lambda} = \\int_{\\Omega} L_{\\lambda}(\\theta, \\phi) \\cos(\\theta) d\\Omega$$\nwhere $d\\Omega = \\sin(\\theta) d\\theta d\\phi$ is the differential solid angle element. The integration is performed over the hemisphere, i.e., for $\\phi$ from $0$ to $2\\pi$ and for $\\theta$ from $0$ to $\\pi/2$.\n\nSince the surface is Lambertian, $L_{\\lambda}$ is constant and can be taken out of the integral:\n$$M_{\\lambda} = L_{\\lambda} \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\cos(\\theta) \\sin(\\theta) d\\theta d\\phi$$\nWe evaluate the angular integral:\n$$\\int_{0}^{2\\pi} d\\phi = 2\\pi$$\n$$\\int_{0}^{\\pi/2} \\cos(\\theta) \\sin(\\theta) d\\theta = \\left[ \\frac{1}{2} \\sin^2(\\theta) \\right]_{0}^{\\pi/2} = \\frac{1}{2}(\\sin^2(\\pi/2) - \\sin^2(0)) = \\frac{1}{2}(1 - 0) = \\frac{1}{2}$$\nThe total value of the angular integral is the product of these two results, which is $(2\\pi) \\times (\\frac{1}{2}) = \\pi$.\nThus, the relationship between spectral exitance and spectral radiance for a Lambertian surface is:\n$$M_{\\lambda} = \\pi L_{\\lambda}$$\nSubstituting $L_{\\lambda} = \\epsilon B_{\\lambda}(T)$, we get the spectral exitance for a Lambertian graybody:\n$$M_{\\lambda} = \\epsilon \\pi B_{\\lambda}(T)$$\nTo find the total hemispheric flux $F$, we integrate the spectral exitance $M_{\\lambda}$ over all wavelengths from $0$ to $\\infty$:\n$$F = \\int_{0}^{\\infty} M_{\\lambda} d\\lambda = \\int_{0}^{\\infty} \\epsilon \\pi B_{\\lambda}(T) d\\lambda$$\nSince the emissivity $\\epsilon$ is wavelength-independent (a graybody), it can be taken out of the integral:\n$$F = \\epsilon \\int_{0}^{\\infty} \\pi B_{\\lambda}(T) d\\lambda$$\nThe integral $\\int_{0}^{\\infty} \\pi B_{\\lambda}(T) d\\lambda$ represents the total hemispheric exitance of a perfect blackbody. By the Stefan-Boltzmann law, this quantity is equal to $\\sigma T^4$, where $\\sigma$ is the Stefan-Boltzmann constant.\nTherefore, the derived expression for the hemispheric radiative flux of a Lambertian graybody is:\n$$F = \\epsilon \\sigma T^4$$\n\nNext, we evaluate the true flux $F_{true}$ for the mineral surface with emissivity $\\epsilon = 0.95$ and temperature $T = 320 \\ \\mathrm{K}$. The Stefan-Boltzmann constant is given as $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W\\ m^{-2}\\ K^{-4}}$.\n$$F_{true} = (0.95) \\times (5.670374419 \\times 10^{-8} \\ \\mathrm{W\\ m^{-2}\\ K^{-4}}) \\times (320 \\ \\mathrm{K})^4$$\n$$F_{true} = 0.95 \\times (5.670374419 \\times 10^{-8}) \\times (1.048576 \\times 10^{10}) \\ \\mathrm{W\\ m^{-2}}$$\n$$F_{true} \\approx 564.8843 \\ \\mathrm{W\\ m^{-2}}$$\nRounding to four significant figures, the true flux is $F_{true} = 564.9 \\ \\mathrm{W\\ m^{-2}}$.\n\nThe operational algorithm erroneously assumes a perfect blackbody, i.e., an emissivity $\\epsilon_{assumed} = 1$. The flux calculated under this assumption, $F_{assumed}$, is:\n$$F_{assumed} = (1) \\times \\sigma T^4 = (5.670374419 \\times 10^{-8}) \\times (1.048576 \\times 10^{10}) \\ \\mathrm{W\\ m^{-2}}$$\n$$F_{assumed} \\approx 594.6150 \\ \\mathrm{W\\ m^{-2}}$$\nRounding to four significant figures, the assumed flux is $F_{assumed} = 594.6 \\ \\mathrm{W\\ m^{-2}}$.\n\nThe absolute error $\\Delta F$ is the difference between the assumed and true flux values:\n$$\\Delta F = F_{assumed} - F_{true}$$\n$$\\Delta F = (1) \\sigma T^4 - \\epsilon \\sigma T^4 = (1 - \\epsilon) \\sigma T^4$$\n$$\\Delta F = (1 - 0.95) \\times (594.6150 \\ \\mathrm{W\\ m^{-2}}) = 0.05 \\times (594.6150 \\ \\mathrm{W\\ m^{-2}})$$\n$$\\Delta F \\approx 29.73075 \\ \\mathrm{W\\ m^{-2}}$$\nRounding to four significant figures, the absolute error is $\\Delta F = 29.73 \\ \\mathrm{W\\ m^{-2}}$.\n\nThe fractional error, $f_{err}$, is the absolute error divided by the true flux:\n$$f_{err} = \\frac{\\Delta F}{F_{true}} = \\frac{F_{assumed} - F_{true}}{F_{true}}$$\nSubstituting the expressions in terms of $\\epsilon$ and $T$:\n$$f_{err} = \\frac{\\sigma T^4 - \\epsilon \\sigma T^4}{\\epsilon \\sigma T^4} = \\frac{(1 - \\epsilon) \\sigma T^4}{\\epsilon \\sigma T^4}$$\nThe term $\\sigma T^4$ cancels out, providing a simple expression for the fractional error that depends only on the emissivity:\n$$f_{err} = \\frac{1 - \\epsilon}{\\epsilon}$$\nUsing the given value $\\epsilon = 0.95$:\n$$f_{err} = \\frac{1 - 0.95}{0.95} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\nAs a decimal, this is:\n$$f_{err} = 0.052631578...$$\nThe problem requests the final numeric answer to be rounded to four significant figures.\n$$f_{err} \\approx 0.05263$$\nThis is the final answer to be reported.",
            "answer": "$$\\boxed{0.05263}$$"
        },
        {
            "introduction": "While surface emission is the source of the thermal signal, what we measure is radiance at a sensor, filtered and modified by the atmosphere. This practice moves our analysis from the ground to the satellite, focusing on the standard single-channel model for retrieving Land Surface Temperature ($T_s$). You will employ first-order error propagation to quantify how uncertainty in surface emissivity, $\\epsilon$, propagates through the radiative transfer model to create error in the final $T_s$ estimate, a crucial skill for assessing the reliability of any remote sensing product .",
            "id": "3860982",
            "problem": "A thermal anomaly in a terrestrial system is being monitored using a single-channel retrieval of Land Surface Temperature (LST), denoted by $T_{s}$, from Thermal Infrared (TIR) Top-Of-Atmosphere (TOA) spectral radiance, denoted by $L_{\\text{TOA}}$, measured at wavelength $\\lambda = 11~\\mu\\text{m}$. Assume the surface behaves as a Lambertian emitter with spectral emissivity $\\epsilon$, and the atmosphere is characterized by channel transmittance $\\tau$, upwelling path radiance $L_{u}$, and downwelling sky radiance $L_{d}$. The at-sensor radiance is modeled by the standard thermal radiative transfer expression\n$$\nL_{\\text{TOA}} = \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u},\n$$\nwhere $B_{\\lambda}(\\lambda, T)$ is the spectral Planck radiance given by\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwith $h$ the Planck constant, $c$ the speed of light, and $k_{B}$ the Boltzmann constant. The instrument radiances $L_{\\text{TOA}}$, $L_{u}$, and $L_{d}$ are expressed in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$, and $\\lambda$ is expressed in meters in the Planck function.\n\nYou are given the following physically consistent parameters for a clear-sky observation over heterogeneous soil-vegetation:\n- $\\lambda = 11 \\times 10^{-6}~\\text{m}$,\n- $L_{\\text{TOA}} = 11.65~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $\\tau = 0.85$,\n- $L_{u} = 1.20~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $L_{d} = 4.00~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- baseline emissivity $\\epsilon_{0} = 0.97$.\n\nSuppose the emissivity used in the retrieval is misestimated by $\\Delta \\epsilon = +0.02$ relative to $\\epsilon_{0}$. Using first principles (Planck’s law and the forward radiative transfer model), derive the local sensitivity $\\partial T_{s} / \\partial \\epsilon$ at $\\epsilon = \\epsilon_{0}$ and use first-order error propagation $\\Delta T_{s} \\approx \\left( \\partial T_{s} / \\partial \\epsilon \\right) \\Delta \\epsilon$ to quantify the resulting error in the retrieved land surface temperature. Use the exact physical constants $h = 6.62607015 \\times 10^{-34}~\\text{J}\\cdot\\text{s}$, $c = 2.99792458 \\times 10^{8}~\\text{m}\\,\\text{s}^{-1}$, and $k_{B} = 1.380649 \\times 10^{-23}~\\text{J}\\,\\text{K}^{-1}$, and treat the channel as monochromatic at $\\lambda$. Express your final numerical value of $\\Delta T_{s}$ in kelvin and round your answer to three significant figures.",
            "solution": "The user wants me to validate and solve a problem from the field of remote sensing and environmental modeling.\n\n### Step 1: Extract Givens\n\n-   **Radiative Transfer Model**:\n    $L_{\\text{TOA}} = \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u}$\n-   **Planck's Law**:\n    $B_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1}$\n-   **Parameters**:\n    -   Wavelength: $\\lambda = 11~\\mu\\text{m} = 11 \\times 10^{-6}~\\text{m}$\n    -   TOA radiance: $L_{\\text{TOA}} = 11.65~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Atmospheric transmittance: $\\tau = 0.85$\n    -   Upwelling path radiance: $L_{u} = 1.20~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Downwelling sky radiance: $L_{d} = 4.00~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Baseline emissivity: $\\epsilon_{0} = 0.97$\n    -   Emissivity misestimation: $\\Delta \\epsilon = +0.02$\n-   **Physical Constants**:\n    -   Planck constant: $h = 6.62607015 \\times 10^{-34}~\\text{J}\\cdot\\text{s}$\n    -   Speed of light: $c = 2.99792458 \\times 10^{8}~\\text{m}\\,\\text{s}^{-1}$\n    -   Boltzmann constant: $k_{B} = 1.380649 \\times 10^{-23}~\\text{J}\\,\\text{K}^{-1}$\n-   **Task**:\n    1.  Derive the local sensitivity $\\partial T_{s} / \\partial \\epsilon$ at $\\epsilon = \\epsilon_{0}$.\n    2.  Use first-order error propagation, $\\Delta T_{s} \\approx \\left( \\partial T_{s} / \\partial \\epsilon \\right) \\Delta \\epsilon$, to find the error in retrieved $T_s$.\n    3.  Provide a numerical answer for $\\Delta T_s$ in kelvin, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is based on the fundamental radiative transfer equation and Planck's law of black-body radiation, which are cornerstone principles in physics and remote sensing. The context of LST retrieval is a standard application in Earth observation. All principles are well-established.\n-   **Well-Posed**: The problem is clearly stated with all necessary parameters provided. It asks for a sensitivity analysis, which is a standard mathematical procedure. A unique, stable solution exists.\n-   **Objective**: The language is precise and quantitative. The task is specific and computational. There are no subjective or opinion-based elements.\n-   The given numerical values for atmospheric and surface parameters are physically realistic for a clear-sky scene in the thermal infrared. The setup is self-contained and free of contradictions.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. I will now proceed with a complete solution.\n\n### Detailed Solution\n\nThe core of the problem is to determine how a small error in the assumed surface emissivity, $\\epsilon$, propagates into an error in the retrieved land surface temperature, $T_s$. This requires calculating the sensitivity, $\\frac{\\partial T_s}{\\partial \\epsilon}$, and then applying the first-order approximation.\n\nFirst, we must establish the baseline state of the system corresponding to the baseline emissivity $\\epsilon_0 = 0.97$. This involves finding the baseline surface-leaving spectral radiance, $B_{\\lambda}(\\lambda, T_{s,0})$, and the corresponding baseline temperature, $T_{s,0}$.\n\nThe given radiances ($L_{\\text{TOA}}$, $L_{u}$, $L_{d}$) are in units of $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$, while the Planck function is provided for SI units, which yields radiance in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$. To maintain consistency, we will convert all radiances to SI units. The conversion factor is $1~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1} = 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$.\n\n-   $L_{\\text{TOA}, \\text{SI}} = 11.65 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n-   $L_{u, \\text{SI}} = 1.20 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n-   $L_{d, \\text{SI}} = 4.00 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n\n**1. Calculate Baseline Surface Radiance and Temperature**\n\nWe rearrange the radiative transfer equation to solve for the spectral radiance emitted by the surface, $B_{\\lambda}(\\lambda, T_s)$:\n$$\nB_{\\lambda}(\\lambda, T_{s}) = \\frac{1}{\\epsilon} \\left[ \\frac{L_{\\text{TOA}} - L_{u}}{\\tau} - (1 - \\epsilon) L_{d} \\right]\n$$\nUsing the baseline parameters ($\\epsilon_0 = 0.97$) and SI radiances:\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ \\frac{11.65 \\times 10^6 - 1.20 \\times 10^6}{0.85} - (1 - 0.97) \\times 4.00 \\times 10^6 \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ \\frac{10.45 \\times 10^6}{0.85} - 0.03 \\times 4.00 \\times 10^6 \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ (1.22941176... \\times 10^7) - (0.12 \\times 10^6) \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1.21741176... \\times 10^7}{0.97} = 1.25506367... \\times 10^7~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}\n$$\nNext, we invert Planck's law to find the baseline temperature, $T_{s,0}$. Let $c_1 = 2hc^2$ and $c_2 = hc/k_B$.\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{c_1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1} \\implies T = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 B_{\\lambda}} + 1\\right)}\n$$\nWe compute the constants $c_1$ and $c_2$:\n$c_1 = 2 (6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^8)^2 = 1.19104297... \\times 10^{-16}~\\text{W}\\cdot\\text{m}^2\\cdot\\text{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} = 1.43877687... \\times 10^{-2}~\\text{m}\\cdot\\text{K}$\n\nWith $\\lambda = 11 \\times 10^{-6}~\\text{m}$, we find $T_{s,0}$:\n$$\n\\frac{c_1}{\\lambda^5 B_{\\lambda,0}} = \\frac{1.19104297... \\times 10^{-16}}{(11 \\times 10^{-6})^5 \\times (1.25506367... \\times 10^7)} = 58.925925...\n$$\n$$\nT_{s,0} = \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) \\ln(58.925925... + 1)} = \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) \\times 4.0930960...} = 319.55835...~\\text{K}\n$$\n\n**2. Derive and Calculate Sensitivity $\\frac{\\partial T_s}{\\partial \\epsilon}$**\n\nWe find the sensitivity by implicitly differentiating the radiative transfer equation with respect to $\\epsilon$, treating $T_s$ as a function of $\\epsilon$ and all other parameters as constants.\n$$\n\\frac{\\partial}{\\partial \\epsilon} (L_{\\text{TOA}}) = \\frac{\\partial}{\\partial \\epsilon} \\left( \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}(\\epsilon)) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u} \\right)\n$$\n$$\n0 = \\tau \\left[ B_{\\lambda} + \\epsilon \\frac{\\partial B_{\\lambda}}{\\partial \\epsilon} - L_d \\right]\n$$\nUsing the chain rule, $\\frac{\\partial B_{\\lambda}}{\\partial \\epsilon} = \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\frac{\\partial T_s}{\\partial \\epsilon}$:\n$$\n0 = \\tau \\left[ B_{\\lambda} - L_d + \\epsilon \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\frac{\\partial T_s}{\\partial \\epsilon} \\right]\n$$\nSolving for the sensitivity $\\frac{\\partial T_s}{\\partial \\epsilon}$:\n$$\n\\frac{\\partial T_s}{\\partial \\epsilon} = - \\frac{B_{\\lambda}(\\lambda, T_s) - L_d}{\\epsilon \\frac{\\partial B_{\\lambda}}{\\partial T_s}}\n$$\nTo evaluate this expression, we need the derivative of the Planck function with respect to temperature:\n$$\n\\frac{\\partial B_{\\lambda}}{\\partial T_s} = \\frac{\\partial}{\\partial T_s} \\left[ \\frac{c_1}{\\lambda^5} \\left(\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1\\right)^{-1} \\right] = B_{\\lambda}(\\lambda, T_s) \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1} \\frac{c_2}{\\lambda T_s^2}\n$$\nWe evaluate this derivative at the baseline temperature $T_{s,0} = 319.55835...~\\text{K}$. Let $x_0 = \\frac{c_2}{\\lambda T_{s,0}} = \\ln(59.925925...) = 4.0930960...$.\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = B_{\\lambda,0} \\left( \\frac{\\exp(x_0)}{\\exp(x_0) - 1} \\right) \\frac{c_2}{\\lambda T_{s,0}^2}\n$$\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = (1.25506367... \\times 10^7) \\left( \\frac{59.925925...}{58.925925...} \\right) \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) (319.55835...)^2}\n$$\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = (1.25506367... \\times 10^7) \\times (1.0169697...) \\times (0.0128087...) = 1.636834... \\times 10^5~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}\\,\\text{K}^{-1}\n$$\nNow, substitute all values back into the sensitivity expression, evaluated at $\\epsilon_0$:\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = - \\frac{B_{\\lambda,0} - L_{d, \\text{SI}}}{\\epsilon_0 \\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}}}\n$$\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = - \\frac{1.25506367... \\times 10^7 - 4.00 \\times 10^6}{0.97 \\times (1.636834... \\times 10^5)} = - \\frac{8.5506367... \\times 10^6}{1.587729... \\times 10^5}\n$$\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = -53.8568...~\\text{K}\n$$\n\n**3. Calculate the Temperature Error $\\Delta T_s$**\n\nFinally, we apply the first-order error propagation formula with $\\Delta \\epsilon = +0.02$:\n$$\n\\Delta T_s \\approx \\left( \\frac{\\partial T_s}{\\partial \\epsilon} \\right) \\Delta \\epsilon = (-53.8568...~\\text{K}) \\times (0.02)\n$$\n$$\n\\Delta T_s \\approx -1.07713...~\\text{K}\n$$\nRounding the result to three significant figures, we get:\n$$\n\\Delta T_s \\approx -1.08~\\text{K}\n$$\nThe negative sign indicates that overestimating the emissivity (using a value that is too high) leads to an underestimation of the retrieved land surface temperature.",
            "answer": "$$\\boxed{-1.08}$$"
        },
        {
            "introduction": "With a time-series of retrieved Land Surface Temperature ($T_s$) data, the challenge shifts from physics and retrieval to statistical analysis: how do we define what is \"normal\" in order to detect what is \"anomalous\"? This hands-on exercise guides you through the implementation of a powerful non-parametric method, Kernel Density Estimation (KDE), to build a background thermal model from historical data. By calculating anomaly scores and analyzing the critical role of the smoothing bandwidth, you will develop practical skills in building and evaluating a data-driven anomaly detection system .",
            "id": "3861018",
            "problem": "You are given historical Land Surface Temperature (LST) measurements at fixed terrestrial locations obtained via thermal infrared remote sensing. Let the LST at location $x$ be denoted by $T_s(x)$, expressed in $\\mathrm{K}$ (Kelvin). Assume that historical measurements at a fixed location $x$ are independent and identically distributed realizations of a background random variable $T_s \\mid x$ with an unknown probability density function. The goal is to construct a background model $b(x)$ for location $x$ as a smoothed probability density over $T_s$, and to analyze how the smoothing bandwidth impacts the sensitivity of anomaly detection.\n\nStarting from fundamental probability concepts, define a background density estimate $b(x)$ as a smoothed version of the empirical distribution of historical $T_s$ at location $x$ using Kernel Density Estimation (KDE). Use a kernel that is normalized, symmetric, nonnegative, integrates to $1$, and has unit variance. In your implementation, use the standard Gaussian kernel. For a given bandwidth parameter $h  0$, define the anomaly score for an observed temperature $t_{\\mathrm{obs}}$ at location $x$ as the negative log-likelihood under the background model, namely $-\\log b(x)(t_{\\mathrm{obs}})$. An anomaly decision is made by comparing the anomaly score to a fixed threshold $\\theta$ (dimensionless): the observation is anomalous if and only if $-\\log b(x)(t_{\\mathrm{obs}}) \\ge \\theta$. Analyze how the choice of $h$ influences the anomaly sensitivity by quantifying how the anomaly score changes with respect to $h$.\n\nImplement a program that, for each test case, performs the following steps:\n- Construct $b(x)$ via KDE using the standard Gaussian kernel and the specified bandwidths $h$.\n- For each bandwidth $h$, compute the background density $b(x)(t_{\\mathrm{obs}})$ in $\\mathrm{K}^{-1}$ and the anomaly score $-\\log b(x)(t_{\\mathrm{obs}})$ (dimensionless).\n- For each bandwidth $h$, compute the anomaly decision as a boolean using the threshold $\\theta$ (dimensionless).\n- Quantify bandwidth sensitivity using the finite-difference slope of the anomaly score with respect to $h$, defined as $\\left(-\\log b_{h_{\\mathrm{large}}}(x)(t_{\\mathrm{obs}}) - \\left(-\\log b_{h_{\\mathrm{small}}}(x)(t_{\\mathrm{obs}})\\right)\\right) / (h_{\\mathrm{large}} - h_{\\mathrm{small}})$, reported in $\\mathrm{K}^{-1}$.\n\nReport all density values $b(x)(t_{\\mathrm{obs}})$ in $\\mathrm{K}^{-1}$, all anomaly scores $-\\log b(x)(t_{\\mathrm{obs}})$ as dimensionless floats, and sensitivity in $\\mathrm{K}^{-1}$. Round all floating-point outputs to six decimal places. The boolean decisions should be exact booleans. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result should be a list of the form\n$[b_{h_1}, b_{h_2}, b_{h_3}, s_{h_1}, s_{h_2}, s_{h_3}, d_{h_1}, d_{h_2}, d_{h_3}, \\Delta_s]$\nwhere $b_{h_i}$ are densities in $\\mathrm{K}^{-1}$, $s_{h_i}$ are anomaly scores (dimensionless), $d_{h_i}$ are booleans, and $\\Delta_s$ is the sensitivity in $\\mathrm{K}^{-1}$. Aggregate the three test case results into a single outer list, and print that single list on one line, for example $[[\\dots],[\\dots],[\\dots]]$.\n\nUse the following test suite, designed to probe bandwidth-dependent anomaly sensitivity in realistic terrestrial thermal contexts:\n\n- Test Case $1$ (unimodal background, moderate warm anomaly):\n    - Historical $T_s$ at location $x$: $\\{299.5, 300.1, 300.3, 299.8, 300.0, 301.2, 298.9, 300.7, 299.6, 300.4, 300.2, 299.7, 301.0, 299.3, 300.6, 300.5, 299.9, 300.8, 299.2, 300.9\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $307.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.5 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\n- Test Case $2$ (bimodal background, observation between modes):\n    - Historical $T_s$ at location $x$: $\\{294.8, 295.2, 295.0, 295.5, 294.9, 295.1, 295.3, 294.7, 295.4, 295.0, 295.6, 294.8, 309.6, 310.2, 310.5, 309.8, 310.0, 310.1, 309.9, 310.3, 309.7, 310.4, 309.6, 310.2\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $304.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.5 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\n- Test Case $3$ (boundary behavior with extremely narrow bandwidth when $t_{\\mathrm{obs}}$ coincides with a historical value):\n    - Historical $T_s$ at location $x$: $\\{300.0, 299.6, 300.4, 299.8, 300.2, 299.9, 300.1, 299.7, 300.3, 299.5\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $300.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.05 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the outer list contains one inner list per test case in the order given above. For example, it should look like $[[\\text{case1\\_result}],[\\text{case2\\_result}],[\\text{case3\\_result}]]$.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be **valid**. It is scientifically grounded in the principles of non-parametric statistics, specifically Kernel Density Estimation (KDE), and is directly applicable to the domain of environmental modeling and remote sensing. The problem is well-posed, providing all necessary data—historical temperature measurements, observed temperatures, model parameters (bandwidths), and decision thresholds—to compute a unique and verifiable solution. The language is objective and the requirements are formalizable into a computational algorithm.\n\nThe core of the problem is to construct a statistical background model for Land Surface Temperature ($T_s$) at a specific location, and then use this model to detect anomalous temperature observations.\n\nFirst, we define the background model. Given a set of $N$ historical, independent and identically distributed (i.i.d.) temperature measurements $\\{T_i\\}_{i=1}^N$ (in $\\mathrm{K}$), we estimate the underlying probability density function using KDE. The KDE, which serves as our background model $b(x)$ at location $x$, is defined as:\n$$b(x)(t) = \\frac{1}{N h} \\sum_{i=1}^{N} K\\left(\\frac{t - T_i}{h}\\right)$$\nHere, $t$ is the temperature at which the density is evaluated, $h  0$ is the smoothing bandwidth parameter (in $\\mathrm{K}$), and $K$ is a kernel function. The problem specifies a standard Gaussian kernel, which is the probability density function (PDF) of a standard normal distribution, $\\mathcal{N}(0, 1)$. The kernel is given by:\n$$K(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2} u^2\\right)$$\nThis kernel satisfies the required properties: it is non-negative, symmetric, integrates to $1$, and has unit variance. Substituting this into the KDE formula, our background density model for an observed temperature $t_{\\mathrm{obs}}$ is:\n$$b(x)(t_{\\mathrm{obs}}) = \\frac{1}{N h \\sqrt{2\\pi}} \\sum_{i=1}^{N} \\exp\\left(-\\frac{1}{2} \\left(\\frac{t_{\\mathrm{obs}} - T_i}{h}\\right)^2\\right)$$\nThe unit of this density is $\\mathrm{K}^{-1}$.\n\nNext, we define the anomaly score. In information theory and statistical modeling, the negative log-likelihood is a standard measure of \"surprisal\" or anomaly. An observation is considered anomalous if it is highly improbable under the background model. The anomaly score $s$ for an observation $t_{\\mathrm{obs}}$ is thus defined as:\n$$s(t_{\\mathrm{obs}}) = -\\log b(x)(t_{\\mathrm{obs}})$$\nThis score is a dimensionless quantity. A higher score indicates a lower probability density, and thus a more anomalous observation.\n\nAn anomaly decision, $d$, is made by comparing the score $s$ to a predefined dimensionless threshold $\\theta$:\n$$d = \\begin{cases} \\text{True}  \\text{if } s(t_{\\mathrm{obs}}) \\ge \\theta \\\\ \\text{False}  \\text{if } s(t_{\\mathrm{obs}})  \\theta \\end{cases}$$\n\nFinally, we analyze the sensitivity of the anomaly score to the choice of bandwidth $h$. The problem defines this sensitivity, $\\Delta_s$, as the finite-difference slope of the score with respect to $h$, using the smallest ($h_{\\mathrm{small}}$) and largest ($h_{\\mathrm{large}}$) bandwidths provided in each test case:\n$$\\Delta_s = \\frac{s_{h_{\\mathrm{large}}} - s_{h_{\\mathrm{small}}}}{h_{\\mathrm{large}} - h_{\\mathrm{small}}} = \\frac{-\\log b_{h_{\\mathrm{large}}}(x)(t_{\\mathrm{obs}}) - (-\\log b_{h_{\\mathrm{small}}}(x)(t_{\\mathrm{obs}}))}{h_{\\mathrm{large}} - h_{\\mathrm{small}}}$$\nThis quantity, with units of $\\mathrm{K}^{-1}$, indicates how the anomaly score changes per unit change in bandwidth. A negative $\\Delta_s$ implies that increasing the bandwidth decreases the anomaly score (i.e., makes the observation appear less anomalous), which is typical for observations far from the historical data modes. A positive $\\Delta_s$ implies the opposite, often seen when an observation lies within a dense cluster of historical data and the bandwidth is increased from a very small value.\n\nThe algorithm proceeds as follows for each test case:\n$1$. Take the set of historical temperatures $\\{T_i\\}$, the observed temperature $t_{\\mathrm{obs}}$, the set of bandwidths $\\{h_j\\}$, and the threshold $\\theta$.\n$2$. For each bandwidth $h_j$ in the set:\n    a. Calculate the density $b_{h_j}(x)(t_{\\mathrm{obs}})$ using the Gaussian KDE formula.\n    b. Calculate the anomaly score $s_{h_j} = -\\log b_{h_j}(x)(t_{\\mathrm{obs}})$.\n    c. Determine the anomaly decision $d_{h_j}$ by comparing $s_{h_j}$ with $\\theta$.\n$3$. Identify $h_{\\mathrm{small}}$ and $h_{\\mathrm{large}}$ from the set of bandwidths and their corresponding scores $s_{h_{\\mathrm{small}}}$ and $s_{h_{\\mathrm{large}}}$.\n$4$. Calculate the sensitivity $\\Delta_s$ using the finite-difference formula.\n$5$. Collate the results—three densities, three scores, three boolean decisions, and one sensitivity value—into a single list for the test case, rounding all floating-point numbers to six decimal places. The final output aggregates these lists from all test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermal anomaly detection problem using Kernel Density Estimation (KDE)\n    for a given suite of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"historical_T\": [299.5, 300.1, 300.3, 299.8, 300.0, 301.2, 298.9, 300.7, 299.6, 300.4, 300.2, 299.7, 301.0, 299.3, 300.6, 300.5, 299.9, 300.8, 299.2, 300.9],\n            \"t_obs\": 307.0,\n            \"bandwidths\": [0.5, 1.5, 4.0],\n            \"theta\": 4.0\n        },\n        {\n            \"historical_T\": [294.8, 295.2, 295.0, 295.5, 294.9, 295.1, 295.3, 294.7, 295.4, 295.0, 295.6, 294.8, 309.6, 310.2, 310.5, 309.8, 310.0, 310.1, 309.9, 310.3, 309.7, 310.4, 309.6, 310.2],\n            \"t_obs\": 304.0,\n            \"bandwidths\": [0.5, 1.5, 4.0],\n            \"theta\": 4.0\n        },\n        {\n            \"historical_T\": [300.0, 299.6, 300.4, 299.8, 300.2, 299.9, 300.1, 299.7, 300.3, 299.5],\n            \"t_obs\": 300.0,\n            \"bandwidths\": [0.05, 1.5, 4.0],\n            \"theta\": 4.0\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        hist_T = np.array(case[\"historical_T\"])\n        t_obs = case[\"t_obs\"]\n        bandwidths = case[\"bandwidths\"]\n        theta = case[\"theta\"]\n        \n        N = len(hist_T)\n        \n        b_vals = []\n        s_vals = []\n        d_vals = []\n\n        for h in bandwidths:\n            # Argument for the standard Gaussian kernel\n            u = (t_obs - hist_T) / h\n            \n            # Evaluate the Gaussian kernel for all historical points\n            # K(u) = (1 / sqrt(2*pi)) * exp(-0.5 * u^2)\n            kernel_evals = (1 / np.sqrt(2 * np.pi)) * np.exp(-0.5 * u**2)\n            \n            # Compute the KDE background density\n            b = np.sum(kernel_evals) / (N * h)\n            \n            # Compute the anomaly score (negative log-likelihood)\n            # Handle potential underflow where b is effectively zero\n            if b  0:\n                s = -np.log(b)\n            else:\n                s = np.inf # A true zero probability gives an infinite score\n\n            # Make the anomaly decision\n            d = s = theta\n\n            b_vals.append(b)\n            s_vals.append(s)\n            d_vals.append(d)\n        \n        # Calculate bandwidth sensitivity using the smallest and largest h\n        h_small, h_large = bandwidths[0], bandwidths[-1]\n        s_small, s_large = s_vals[0], s_vals[-1]\n        \n        delta_s = (s_large - s_small) / (h_large - h_small)\n        \n        # Assemble the formatted results for the current case\n        case_result_str_list = (\n            [f\"{v:.6f}\" for v in b_vals] +\n            [f\"{v:.6f}\" for v in s_vals] +\n            [str(v) for v in d_vals] +\n            [f\"{delta_s:.6f}\"]\n        )\n        case_str = f\"[{','.join(case_result_str_list)}]\"\n        all_results.append(case_str)\n        \n    # Print the final aggregated result in the specified format\n    final_output_str = f\"[{','.join(all_results)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}