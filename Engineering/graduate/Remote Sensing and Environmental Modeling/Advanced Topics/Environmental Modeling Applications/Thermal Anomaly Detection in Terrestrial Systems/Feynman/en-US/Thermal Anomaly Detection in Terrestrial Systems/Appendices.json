{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any thermal anomaly analysis is the accurate retrieval of Land Surface Temperature ($T_s$) from the radiance measured by a satellite. This retrieval, however, is not a direct measurement and is highly sensitive to the physical parameters used in the model, particularly surface emissivity ($\\epsilon$). This exercise will guide you through a fundamental sensitivity analysis, using first-order error propagation to quantify exactly how an error in your assumed emissivity translates into an error in the retrieved surface temperature, a crucial skill for assessing the reliability of thermal data products. ",
            "id": "3860982",
            "problem": "A thermal anomaly in a terrestrial system is being monitored using a single-channel retrieval of Land Surface Temperature (LST), denoted by $T_{s}$, from Thermal Infrared (TIR) Top-Of-Atmosphere (TOA) spectral radiance, denoted by $L_{\\text{TOA}}$, measured at wavelength $\\lambda = 11~\\mu\\text{m}$. Assume the surface behaves as a Lambertian emitter with spectral emissivity $\\epsilon$, and the atmosphere is characterized by channel transmittance $\\tau$, upwelling path radiance $L_{u}$, and downwelling sky radiance $L_{d}$. The at-sensor radiance is modeled by the standard thermal radiative transfer expression\n$$\nL_{\\text{TOA}} = \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u},\n$$\nwhere $B_{\\lambda}(\\lambda, T)$ is the spectral Planck radiance given by\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwith $h$ the Planck constant, $c$ the speed of light, and $k_{B}$ the Boltzmann constant. The instrument radiances $L_{\\text{TOA}}$, $L_{u}$, and $L_{d}$ are expressed in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$, and $\\lambda$ is expressed in meters in the Planck function.\n\nYou are given the following physically consistent parameters for a clear-sky observation over heterogeneous soil-vegetation:\n- $\\lambda = 11 \\times 10^{-6}~\\text{m}$,\n- $L_{\\text{TOA}} = 11.65~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $\\tau = 0.85$,\n- $L_{u} = 1.20~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $L_{d} = 4.00~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- baseline emissivity $\\epsilon_{0} = 0.97$.\n\nSuppose the emissivity used in the retrieval is misestimated by $\\Delta \\epsilon = +0.02$ relative to $\\epsilon_{0}$. Using first principles (Planck’s law and the forward radiative transfer model), derive the local sensitivity $\\partial T_{s} / \\partial \\epsilon$ at $\\epsilon = \\epsilon_{0}$ and use first-order error propagation $\\Delta T_{s} \\approx \\left( \\partial T_{s} / \\partial \\epsilon \\right) \\Delta \\epsilon$ to quantify the resulting error in the retrieved land surface temperature. Use the exact physical constants $h = 6.62607015 \\times 10^{-34}~\\text{J}\\cdot\\text{s}$, $c = 2.99792458 \\times 10^{8}~\\text{m}\\,\\text{s}^{-1}$, and $k_{B} = 1.380649 \\times 10^{-23}~\\text{J}\\,\\text{K}^{-1}$, and treat the channel as monochromatic at $\\lambda$. Express your final numerical value of $\\Delta T_{s}$ in kelvin and round your answer to three significant figures.",
            "solution": "The user wants me to validate and solve a problem from the field of remote sensing and environmental modeling.\n\n### Step 1: Extract Givens\n\n-   **Radiative Transfer Model**:\n    $L_{\\text{TOA}} = \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u}$\n-   **Planck's Law**:\n    $B_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1}$\n-   **Parameters**:\n    -   Wavelength: $\\lambda = 11~\\mu\\text{m} = 11 \\times 10^{-6}~\\text{m}$\n    -   TOA radiance: $L_{\\text{TOA}} = 11.65~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Atmospheric transmittance: $\\tau = 0.85$\n    -   Upwelling path radiance: $L_{u} = 1.20~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Downwelling sky radiance: $L_{d} = 4.00~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$\n    -   Baseline emissivity: $\\epsilon_{0} = 0.97$\n    -   Emissivity misestimation: $\\Delta \\epsilon = +0.02$\n-   **Physical Constants**:\n    -   Planck constant: $h = 6.62607015 \\times 10^{-34}~\\text{J}\\cdot\\text{s}$\n    -   Speed of light: $c = 2.99792458 \\times 10^{8}~\\text{m}\\,\\text{s}^{-1}$\n    -   Boltzmann constant: $k_{B} = 1.380649 \\times 10^{-23}~\\text{J}\\,\\text{K}^{-1}$\n-   **Task**:\n    1.  Derive the local sensitivity $\\partial T_{s} / \\partial \\epsilon$ at $\\epsilon = \\epsilon_{0}$.\n    2.  Use first-order error propagation, $\\Delta T_{s} \\approx \\left( \\partial T_{s} / \\partial \\epsilon \\right) \\Delta \\epsilon$, to find the error in retrieved $T_s$.\n    3.  Provide a numerical answer for $\\Delta T_s$ in kelvin, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is based on the fundamental radiative transfer equation and Planck's law of black-body radiation, which are cornerstone principles in physics and remote sensing. The context of LST retrieval is a standard application in Earth observation. All principles are well-established.\n-   **Well-Posed**: The problem is clearly stated with all necessary parameters provided. It asks for a sensitivity analysis, which is a standard mathematical procedure. A unique, stable solution exists.\n-   **Objective**: The language is precise and quantitative. The task is specific and computational. There are no subjective or opinion-based elements.\n-   The given numerical values for atmospheric and surface parameters are physically realistic for a clear-sky scene in the thermal infrared. The setup is self-contained and free of contradictions.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. I will now proceed with a complete solution.\n\n### Detailed Solution\n\nThe core of the problem is to determine how a small error in the assumed surface emissivity, $\\epsilon$, propagates into an error in the retrieved land surface temperature, $T_s$. This requires calculating the sensitivity, $\\frac{\\partial T_s}{\\partial \\epsilon}$, and then applying the first-order approximation.\n\nFirst, we must establish the baseline state of the system corresponding to the baseline emissivity $\\epsilon_0 = 0.97$. This involves finding the baseline surface-leaving spectral radiance, $B_{\\lambda}(\\lambda, T_{s,0})$, and the corresponding baseline temperature, $T_{s,0}$.\n\nThe given radiances ($L_{\\text{TOA}}$, $L_{u}$, $L_{d}$) are in units of $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$, while the Planck function is provided for SI units, which yields radiance in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$. To maintain consistency, we will convert all radiances to SI units. The conversion factor is $1~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1} = 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$.\n\n-   $L_{\\text{TOA}, \\text{SI}} = 11.65 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n-   $L_{u, \\text{SI}} = 1.20 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n-   $L_{d, \\text{SI}} = 4.00 \\times 10^6~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}$\n\n**1. Calculate Baseline Surface Radiance and Temperature**\n\nWe rearrange the radiative transfer equation to solve for the spectral radiance emitted by the surface, $B_{\\lambda}(\\lambda, T_s)$:\n$$\nB_{\\lambda}(\\lambda, T_{s}) = \\frac{1}{\\epsilon} \\left[ \\frac{L_{\\text{TOA}} - L_{u}}{\\tau} - (1 - \\epsilon) L_{d} \\right]\n$$\nUsing the baseline parameters ($\\epsilon_0 = 0.97$) and SI radiances:\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ \\frac{11.65 \\times 10^6 - 1.20 \\times 10^6}{0.85} - (1 - 0.97) \\times 4.00 \\times 10^6 \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ \\frac{10.45 \\times 10^6}{0.85} - 0.03 \\times 4.00 \\times 10^6 \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1}{0.97} \\left[ (1.22941176... \\times 10^7) - (0.12 \\times 10^6) \\right]\n$$\n$$\nB_{\\lambda,0} = \\frac{1.21741176... \\times 10^7}{0.97} = 1.25506367... \\times 10^7~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}\n$$\nNext, we invert Planck's law to find the baseline temperature, $T_{s,0}$. Let $c_1 = 2hc^2$ and $c_2 = hc/k_B$.\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{c_1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1} \\implies T = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 B_{\\lambda}} + 1\\right)}\n$$\nWe compute the constants $c_1$ and $c_2$:\n$c_1 = 2 (6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^8)^2 = 1.19104297... \\times 10^{-16}~\\text{W}\\cdot\\text{m}^2\\cdot\\text{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} = 1.43877687... \\times 10^{-2}~\\text{m}\\cdot\\text{K}$\n\nWith $\\lambda = 11 \\times 10^{-6}~\\text{m}$, we find $T_{s,0}$:\n$$\n\\frac{c_1}{\\lambda^5 B_{\\lambda,0}} = \\frac{1.19104297... \\times 10^{-16}}{(11 \\times 10^{-6})^5 \\times (1.25506367... \\times 10^7)} = 58.925925...\n$$\n$$\nT_{s,0} = \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) \\ln(58.925925... + 1)} = \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) \\times 4.0930960...} = 319.55835...~\\text{K}\n$$\n\n**2. Derive and Calculate Sensitivity $\\frac{\\partial T_s}{\\partial \\epsilon}$**\n\nWe find the sensitivity by implicitly differentiating the radiative transfer equation with respect to $\\epsilon$, treating $T_s$ as a function of $\\epsilon$ and all other parameters as constants.\n$$\n\\frac{\\partial}{\\partial \\epsilon} (L_{\\text{TOA}}) = \\frac{\\partial}{\\partial \\epsilon} \\left( \\tau \\left[ \\epsilon\\, B_{\\lambda}(\\lambda, T_{s}(\\epsilon)) + (1 - \\epsilon)\\, L_{d} \\right] + L_{u} \\right)\n$$\n$$\n0 = \\tau \\left[ B_{\\lambda} + \\epsilon \\frac{\\partial B_{\\lambda}}{\\partial \\epsilon} - L_d \\right]\n$$\nUsing the chain rule, $\\frac{\\partial B_{\\lambda}}{\\partial \\epsilon} = \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\frac{\\partial T_s}{\\partial \\epsilon}$:\n$$\n0 = \\tau \\left[ B_{\\lambda} - L_d + \\epsilon \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\frac{\\partial T_s}{\\partial \\epsilon} \\right]\n$$\nSolving for the sensitivity $\\frac{\\partial T_s}{\\partial \\epsilon}$:\n$$\n\\frac{\\partial T_s}{\\partial \\epsilon} = - \\frac{B_{\\lambda}(\\lambda, T_s) - L_d}{\\epsilon \\frac{\\partial B_{\\lambda}}{\\partial T_s}}\n$$\nTo evaluate this expression, we need the derivative of the Planck function with respect to temperature:\n$$\n\\frac{\\partial B_{\\lambda}}{\\partial T_s} = \\frac{\\partial}{\\partial T_s} \\left[ \\frac{c_1}{\\lambda^5} \\left(\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1\\right)^{-1} \\right] = B_{\\lambda}(\\lambda, T_s) \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1} \\frac{c_2}{\\lambda T_s^2}\n$$\nWe evaluate this derivative at the baseline temperature $T_{s,0} = 319.55835...~\\text{K}$. Let $x_0 = \\frac{c_2}{\\lambda T_{s,0}} = \\ln(59.925925...) = 4.0930960...$.\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = B_{\\lambda,0} \\left( \\frac{\\exp(x_0)}{\\exp(x_0) - 1} \\right) \\frac{c_2}{\\lambda T_{s,0}^2}\n$$\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = (1.25506367... \\times 10^7) \\left( \\frac{59.925925...}{58.925925...} \\right) \\frac{1.43877687... \\times 10^{-2}}{(11 \\times 10^{-6}) (319.55835...)^2}\n$$\n$$\n\\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}} = (1.25506367... \\times 10^7) \\times (1.0169697...) \\times (0.0128087...) = 1.636834... \\times 10^5~\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\text{m}^{-1}\\,\\text{K}^{-1}\n$$\nNow, substitute all values back into the sensitivity expression, evaluated at $\\epsilon_0$:\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = - \\frac{B_{\\lambda,0} - L_{d, \\text{SI}}}{\\epsilon_0 \\left. \\frac{\\partial B_{\\lambda}}{\\partial T_s} \\right|_{T_{s,0}}}\n$$\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = - \\frac{1.25506367... \\times 10^7 - 4.00 \\times 10^6}{0.97 \\times (1.636834... \\times 10^5)} = - \\frac{8.5506367... \\times 10^6}{1.587729... \\times 10^5}\n$$\n$$\n\\left. \\frac{\\partial T_s}{\\partial \\epsilon} \\right|_{\\epsilon_0} = -53.8568...~\\text{K}\n$$\n\n**3. Calculate the Temperature Error $\\Delta T_s$**\n\nFinally, we apply the first-order error propagation formula with $\\Delta \\epsilon = +0.02$:\n$$\n\\Delta T_s \\approx \\left( \\frac{\\partial T_s}{\\partial \\epsilon} \\right) \\Delta \\epsilon = (-53.8568...~\\text{K}) \\times (0.02)\n$$\n$$\n\\Delta T_s \\approx -1.07713...~\\text{K}\n$$\nRounding the result to three significant figures, we get:\n$$\n\\Delta T_s \\approx -1.08~\\text{K}\n$$\nThe negative sign indicates that overestimating the emissivity (using a value that is too high) leads to an underestimation of the retrieved land surface temperature.",
            "answer": "$$\\boxed{-1.08}$$"
        },
        {
            "introduction": "Real-world land surfaces are rarely uniform, and a single satellite pixel often contains a mixture of different materials like soil, water, and vegetation. This exercise delves into the sub-pixel heterogeneity problem, a significant challenge in thermal remote sensing. You will derive an exact analytical expression for the temperature bias introduced when a mixed pixel is treated as a single, uniform surface, providing deep insight into the non-linear effects of radiance mixing and the limitations of simplified surface models. ",
            "id": "3861025",
            "problem": "A thermal anomaly detection pipeline for terrestrial systems estimates Land Surface Temperature (LST) from thermal infrared radiance by inverting Planck’s law under a graybody assumption. Consider a single sensor pixel of ground area that contains two homogeneous materials, denoted A and B, each of which is isothermal at the same true surface temperature $T_{s}$ over the sensor’s integration time. The pixel’s fractional areal coverages are $f$ for material A and $1-f$ for material B, with $0 \\leq f \\leq 1$. At a fixed thermal infrared wavelength $\\lambda$ within an atmospheric window, the spectral emissivities of the two materials are $\\epsilon_{1}$ and $\\epsilon_{2}$, respectively, and the emission can be treated as Lambertian. Assume that the measured radiance is the surface-leaving spectral radiance (at the surface) after perfect atmospheric correction, and neglect reflected downwelling terms.\n\nThe anomaly detection pipeline assumes a uniform emissivity $\\epsilon_{u}$ for the entire pixel and retrieves an estimated temperature $\\hat{T}_{s}$ by inverting Planck’s law at wavelength $\\lambda$. Starting strictly from fundamental radiative concepts (Planck’s law for spectral radiance and the definition of spectral emissivity as a multiplicative factor relative to a blackbody), and using only area-weighted radiance mixing for the two materials, derive an exact closed-form analytical expression for the temperature bias $\\Delta T_{s} = \\hat{T}_{s} - T_{s}$ caused solely by the uniform emissivity assumption. Your expression must be written in terms of $\\lambda$, $f$, $\\epsilon_{1}$, $\\epsilon_{2}$, $\\epsilon_{u}$, $T_{s}$, the Planck constant $h$, the speed of light $c$, and the Boltzmann constant $k_{B}$. Express the final answer as a single analytic expression. Do not perform any numerical evaluation.",
            "solution": "The physically consistent starting point is Planck’s law for monochromatic blackbody spectral radiance, written as a function of wavelength $\\lambda$ and thermodynamic temperature $T$,\n$$\nB_{\\lambda}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light, and $k_{B}$ is the Boltzmann constant. For a graybody with spectral emissivity $\\epsilon_{\\lambda}$ (assumed here equal to its directional emissivity under Lambertian emission), the surface-leaving spectral radiance at the surface is\n$$\nL_{\\lambda} = \\epsilon_{\\lambda}\\, B_{\\lambda}(T).\n$$\n\nWithin the pixel, materials A and B have the same true surface temperature $T_{s}$ but different spectral emissivities at wavelength $\\lambda$, denoted $\\epsilon_{1}$ and $\\epsilon_{2}$. Under area-weighted linear mixing of radiances from isothermal subpixel components, the surface-leaving radiance measured at wavelength $\\lambda$ is\n$$\nL_{\\lambda} = f\\,\\epsilon_{1}\\,B_{\\lambda}(T_{s}) + (1-f)\\,\\epsilon_{2}\\,B_{\\lambda}(T_{s}) = \\epsilon_{\\mathrm{eff}}\\,B_{\\lambda}(T_{s}),\n$$\nwhere the effective emissivity from mixing at wavelength $\\lambda$ is\n$$\n\\epsilon_{\\mathrm{eff}} = f\\,\\epsilon_{1} + (1-f)\\,\\epsilon_{2}.\n$$\n\nThe retrieval algorithm assumes a uniform emissivity $\\epsilon_{u}$ and inverts Planck’s law to find $\\hat{T}_{s}$ such that\n$$\nL_{\\lambda} = \\epsilon_{u}\\,B_{\\lambda}(\\hat{T}_{s}).\n$$\nEquating the two expressions for $L_{\\lambda}$,\n$$\n\\epsilon_{u}\\,B_{\\lambda}(\\hat{T}_{s}) = \\epsilon_{\\mathrm{eff}}\\,B_{\\lambda}(T_{s}).\n$$\nIntroduce the ratio\n$$\nR \\equiv \\frac{\\epsilon_{\\mathrm{eff}}}{\\epsilon_{u}} = \\frac{f\\,\\epsilon_{1} + (1-f)\\,\\epsilon_{2}}{\\epsilon_{u}}.\n$$\nThen\n$$\nB_{\\lambda}(\\hat{T}_{s}) = R\\,B_{\\lambda}(T_{s}).\n$$\n\nUsing the explicit form of $B_{\\lambda}$, define the dimensionless variables\n$$\nx_{s} \\equiv \\frac{h c}{\\lambda k_{B} T_{s}}, \\quad x_{\\hat{s}} \\equiv \\frac{h c}{\\lambda k_{B} \\hat{T}_{s}}.\n$$\nPlanck’s law can be written as\n$$\nB_{\\lambda}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\,\\frac{1}{\\exp(x) - 1},\n$$\nso the ratio becomes\n$$\n\\frac{B_{\\lambda}(\\hat{T}_{s})}{B_{\\lambda}(T_{s})} = \\frac{\\frac{1}{\\exp(x_{\\hat{s}}) - 1}}{\\frac{1}{\\exp(x_{s}) - 1}} = \\frac{\\exp(x_{s}) - 1}{\\exp(x_{\\hat{s}}) - 1} = R.\n$$\nRearrange to solve for $x_{\\hat{s}}$:\n$$\n\\exp(x_{\\hat{s}}) - 1 = \\frac{\\exp(x_{s}) - 1}{R}\n\\quad \\Rightarrow \\quad\nx_{\\hat{s}} = \\ln\\!\\left(1 + \\frac{\\exp(x_{s}) - 1}{R}\\right).\n$$\nRecover $\\hat{T}_{s}$ from $x_{\\hat{s}}$:\n$$\n\\hat{T}_{s} = \\frac{h c}{\\lambda k_{B}} \\,\\frac{1}{x_{\\hat{s}}}\n= \\frac{h c}{\\lambda k_{B}} \\left[\\ln\\!\\left(1 + \\frac{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T_{s}}\\right) - 1}{R}\\right)\\right]^{-1}.\n$$\n\nThe bias induced purely by the uniform emissivity assumption is\n$$\n\\Delta T_{s} \\equiv \\hat{T}_{s} - T_{s}\n= \\frac{h c}{\\lambda k_{B}} \\left[\\ln\\!\\left(1 + \\frac{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T_{s}}\\right) - 1}{R}\\right)\\right]^{-1} - T_{s},\n$$\nwith $R = \\dfrac{f\\,\\epsilon_{1} + (1-f)\\,\\epsilon_{2}}{\\epsilon_{u}}$.\n\nThis closed-form expression isolates the impact of the emissivity mismatch. Its qualitative behavior follows from the monotonicity of the Planck function: if $\\epsilon_{u}  \\epsilon_{\\mathrm{eff}}$ then $R  1$, yielding $x_{\\hat{s}}  x_{s}$ and thus $\\hat{T}_{s}  T_{s}$ (negative bias); if $\\epsilon_{u}  \\epsilon_{\\mathrm{eff}}$ then $R  1$, $x_{\\hat{s}}  x_{s}$ and $\\hat{T}_{s}  T_{s}$ (positive bias). The magnitude of $\\Delta T_{s}$ is amplified at shorter wavelengths (smaller $\\lambda$) and for larger $x_{s}$ (colder $T_{s}$), reflecting the exponential nonlinearity of Planck’s law.",
            "answer": "$$\\boxed{\\frac{h c}{k_B \\lambda}\\left[\\ln\\!\\left(1+\\frac{\\exp\\!\\left(\\frac{h c}{k_B \\lambda T_{s}}\\right)-1}{\\frac{f\\,\\epsilon_{1}+(1-f)\\,\\epsilon_{2}}{\\epsilon_{u}}}\\right)\\right]^{-1}-T_{s}}$$"
        },
        {
            "introduction": "After retrieving a time series of surface temperatures, the next step is to distinguish unusual events from normal fluctuations. This computational practice moves from the physics of retrieval to the statistics of detection, challenging you to build a non-parametric background model from historical data using Kernel Density Estimation (KDE). By defining an anomaly score and analyzing its sensitivity to the model's smoothing bandwidth, you will gain practical experience in developing and critically evaluating a data-driven anomaly detection system. ",
            "id": "3861018",
            "problem": "You are given historical Land Surface Temperature (LST) measurements at fixed terrestrial locations obtained via thermal infrared remote sensing. Let the LST at location $x$ be denoted by $T_s(x)$, expressed in $\\mathrm{K}$ (Kelvin). Assume that historical measurements at a fixed location $x$ are independent and identically distributed realizations of a background random variable $T_s \\mid x$ with an unknown probability density function. The goal is to construct a background model $b(x)$ for location $x$ as a smoothed probability density over $T_s$, and to analyze how the smoothing bandwidth impacts the sensitivity of anomaly detection.\n\nStarting from fundamental probability concepts, define a background density estimate $b(x)$ as a smoothed version of the empirical distribution of historical $T_s$ at location $x$ using Kernel Density Estimation (KDE). Use a kernel that is normalized, symmetric, nonnegative, integrates to $1$, and has unit variance. In your implementation, use the standard Gaussian kernel. For a given bandwidth parameter $h  0$, define the anomaly score for an observed temperature $t_{\\mathrm{obs}}$ at location $x$ as the negative log-likelihood under the background model, namely $-\\log b(x)(t_{\\mathrm{obs}})$. An anomaly decision is made by comparing the anomaly score to a fixed threshold $\\theta$ (dimensionless): the observation is anomalous if and only if $-\\log b(x)(t_{\\mathrm{obs}}) \\ge \\theta$. Analyze how the choice of $h$ influences the anomaly sensitivity by quantifying how the anomaly score changes with respect to $h$.\n\nImplement a program that, for each test case, performs the following steps:\n- Construct $b(x)$ via KDE using the standard Gaussian kernel and the specified bandwidths $h$.\n- For each bandwidth $h$, compute the background density $b(x)(t_{\\mathrm{obs}})$ in $\\mathrm{K}^{-1}$ and the anomaly score $-\\log b(x)(t_{\\mathrm{obs}})$ (dimensionless).\n- For each bandwidth $h$, compute the anomaly decision as a boolean using the threshold $\\theta$ (dimensionless).\n- Quantify bandwidth sensitivity using the finite-difference slope of the anomaly score with respect to $h$, defined as $\\left(-\\log b_{h_{\\mathrm{large}}}(x)(t_{\\mathrm{obs}}) - \\left(-\\log b_{h_{\\mathrm{small}}}(x)(t_{\\mathrm{obs}})\\right)\\right) / (h_{\\mathrm{large}} - h_{\\mathrm{small}})$, reported in $\\mathrm{K}^{-1}$.\n\nReport all density values $b(x)(t_{\\mathrm{obs}})$ in $\\mathrm{K}^{-1}$, all anomaly scores $-\\log b(x)(t_{\\mathrm{obs}})$ as dimensionless floats, and sensitivity in $\\mathrm{K}^{-1}$. Round all floating-point outputs to six decimal places. The boolean decisions should be exact booleans. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result should be a list of the form\n$[b_{h_1}, b_{h_2}, b_{h_3}, s_{h_1}, s_{h_2}, s_{h_3}, d_{h_1}, d_{h_2}, d_{h_3}, \\Delta_s]$\nwhere $b_{h_i}$ are densities in $\\mathrm{K}^{-1}$, $s_{h_i}$ are anomaly scores (dimensionless), $d_{h_i}$ are booleans, and $\\Delta_s$ is the sensitivity in $\\mathrm{K}^{-1}$. Aggregate the three test case results into a single outer list, and print that single list on one line, for example $[[\\dots],[\\dots],[\\dots]]$.\n\nUse the following test suite, designed to probe bandwidth-dependent anomaly sensitivity in realistic terrestrial thermal contexts:\n\n- Test Case $1$ (unimodal background, moderate warm anomaly):\n    - Historical $T_s$ at location $x$: $\\{299.5, 300.1, 300.3, 299.8, 300.0, 301.2, 298.9, 300.7, 299.6, 300.4, 300.2, 299.7, 301.0, 299.3, 300.6, 300.5, 299.9, 300.8, 299.2, 300.9\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $307.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.5 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\n- Test Case $2$ (bimodal background, observation between modes):\n    - Historical $T_s$ at location $x$: $\\{294.8, 295.2, 295.0, 295.5, 294.9, 295.1, 295.3, 294.7, 295.4, 295.0, 295.6, 294.8, 309.6, 310.2, 310.5, 309.8, 310.0, 310.1, 309.9, 310.3, 309.7, 310.4, 309.6, 310.2\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $304.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.5 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\n- Test Case $3$ (boundary behavior with extremely narrow bandwidth when $t_{\\mathrm{obs}}$ coincides with a historical value):\n    - Historical $T_s$ at location $x$: $\\{300.0, 299.6, 300.4, 299.8, 300.2, 299.9, 300.1, 299.7, 300.3, 299.5\\} \\,\\mathrm{K}$.\n    - Observed $t_{\\mathrm{obs}}$: $300.0 \\,\\mathrm{K}$.\n    - Bandwidths: $h \\in \\{0.05 \\,\\mathrm{K}, 1.5 \\,\\mathrm{K}, 4.0 \\,\\mathrm{K}\\}$.\n    - Threshold: $\\theta = 4.0$ (dimensionless).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the outer list contains one inner list per test case in the order given above. For example, it should look like $[[\\text{case1\\_result}],[\\text{case2\\_result}],[\\text{case3\\_result}]]$.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be **valid**. It is scientifically grounded in the principles of non-parametric statistics, specifically Kernel Density Estimation (KDE), and is directly applicable to the domain of environmental modeling and remote sensing. The problem is well-posed, providing all necessary data—historical temperature measurements, observed temperatures, model parameters (bandwidths), and decision thresholds—to compute a unique and verifiable solution. The language is objective and the requirements are formalizable into a computational algorithm.\n\nThe core of the problem is to construct a statistical background model for Land Surface Temperature ($T_s$) at a specific location, and then use this model to detect anomalous temperature observations.\n\nFirst, we define the background model. Given a set of $N$ historical, independent and identically distributed (i.i.d.) temperature measurements $\\{T_i\\}_{i=1}^N$ (in $\\mathrm{K}$), we estimate the underlying probability density function using KDE. The KDE, which serves as our background model $b(x)$ at location $x$, is defined as:\n$$b(x)(t) = \\frac{1}{N h} \\sum_{i=1}^{N} K\\left(\\frac{t - T_i}{h}\\right)$$\nHere, $t$ is the temperature at which the density is evaluated, $h  0$ is the smoothing bandwidth parameter (in $\\mathrm{K}$), and $K$ is a kernel function. The problem specifies a standard Gaussian kernel, which is the probability density function (PDF) of a standard normal distribution, $\\mathcal{N}(0, 1)$. The kernel is given by:\n$$K(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2} u^2\\right)$$\nThis kernel satisfies the required properties: it is non-negative, symmetric, integrates to $1$, and has unit variance. Substituting this into the KDE formula, our background density model for an observed temperature $t_{\\mathrm{obs}}$ is:\n$$b(x)(t_{\\mathrm{obs}}) = \\frac{1}{N h \\sqrt{2\\pi}} \\sum_{i=1}^{N} \\exp\\left(-\\frac{1}{2} \\left(\\frac{t_{\\mathrm{obs}} - T_i}{h}\\right)^2\\right)$$\nThe unit of this density is $\\mathrm{K}^{-1}$.\n\nNext, we define the anomaly score. In information theory and statistical modeling, the negative log-likelihood is a standard measure of \"surprisal\" or anomaly. An observation is considered anomalous if it is highly improbable under the background model. The anomaly score $s$ for an observation $t_{\\mathrm{obs}}$ is thus defined as:\n$$s(t_{\\mathrm{obs}}) = -\\log b(x)(t_{\\mathrm{obs}})$$\nThis score is a dimensionless quantity. A higher score indicates a lower probability density, and thus a more anomalous observation.\n\nAn anomaly decision, $d$, is made by comparing the score $s$ to a predefined dimensionless threshold $\\theta$:\n$$d = \\begin{cases} \\text{True}  \\text{if } s(t_{\\mathrm{obs}}) \\ge \\theta \\\\ \\text{False}  \\text{if } s(t_{\\mathrm{obs}})  \\theta \\end{cases}$$\n\nFinally, we analyze the sensitivity of the anomaly score to the choice of bandwidth $h$. The problem defines this sensitivity, $\\Delta_s$, as the finite-difference slope of the score with respect to $h$, using the smallest ($h_{\\mathrm{small}}$) and largest ($h_{\\mathrm{large}}$) bandwidths provided in each test case:\n$$\\Delta_s = \\frac{s_{h_{\\mathrm{large}}} - s_{h_{\\mathrm{small}}}}{h_{\\mathrm{large}} - h_{\\mathrm{small}}} = \\frac{-\\log b_{h_{\\mathrm{large}}}(x)(t_{\\mathrm{obs}}) - (-\\log b_{h_{\\mathrm{small}}}(x)(t_{\\mathrm{obs}}))}{h_{\\mathrm{large}} - h_{\\mathrm{small}}}$$\nThis quantity, with units of $\\mathrm{K}^{-1}$, indicates how the anomaly score changes per unit change in bandwidth. A negative $\\Delta_s$ implies that increasing the bandwidth decreases the anomaly score (i.e., makes the observation appear less anomalous), which is typical for observations far from the historical data modes. A positive $\\Delta_s$ implies the opposite, often seen when an observation lies within a dense cluster of historical data and the bandwidth is increased from a very small value.\n\nThe algorithm proceeds as follows for each test case:\n$1$. Take the set of historical temperatures $\\{T_i\\}$, the observed temperature $t_{\\mathrm{obs}}$, the set of bandwidths $\\{h_j\\}$, and the threshold $\\theta$.\n$2$. For each bandwidth $h_j$ in the set:\n    a. Calculate the density $b_{h_j}(x)(t_{\\mathrm{obs}})$ using the Gaussian KDE formula.\n    b. Calculate the anomaly score $s_{h_j} = -\\log b_{h_j}(x)(t_{\\mathrm{obs}})$.\n    c. Determine the anomaly decision $d_{h_j}$ by comparing $s_{h_j}$ with $\\theta$.\n$3$. Identify $h_{\\mathrm{small}}$ and $h_{\\mathrm{large}}$ from the set of bandwidths and their corresponding scores $s_{h_{\\mathrm{small}}}$ and $s_{h_{\\mathrm{large}}}$.\n$4$. Calculate the sensitivity $\\Delta_s$ using the finite-difference formula.\n$5$. Collate the results—three densities, three scores, three boolean decisions, and one sensitivity value—into a single list for the test case, rounding all floating-point numbers to six decimal places. The final output aggregates these lists from all test cases.",
            "answer": "[[0.000000,0.003504,0.024629,64.341138,5.653926,3.702781,True,True,False,-17.325245],[0.000000,0.000109,0.027003,63.830027,9.121332,3.611802,True,True,False,-17.205207],[0.798100,0.334538,0.100543,0.225522,1.093944,2.296996,False,False,False,0.524424]]"
        }
    ]
}