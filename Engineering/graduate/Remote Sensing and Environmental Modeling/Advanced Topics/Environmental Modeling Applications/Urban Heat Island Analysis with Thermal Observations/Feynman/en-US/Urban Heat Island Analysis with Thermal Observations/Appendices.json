{
    "hands_on_practices": [
        {
            "introduction": "Quantitative analysis begins with converting raw sensor signals into meaningful physical units. This practice explores radiometric calibration, the process of translating sensor Digital Numbers ($DN$) into at-sensor radiance, and the critical concept of uncertainty propagation. By working through this exercise , you will learn how errors in calibration coefficients affect the final brightness temperature, a foundational skill for ensuring the accuracy of all subsequent analyses.",
            "id": "3864235",
            "problem": "A thermal infrared imaging spectrometer aboard a polar-orbiting satellite is used to study the Urban Heat Island (UHI) over a megacity. For a nadir-view pixel in the 10.8 micrometer band, the sensor outputs a Digital Number (DN) of $700$. The radiometric calibration for converting DN to at-sensor spectral radiance (per micrometer) is modeled as linear: $L_{\\mu\\mathrm{m}} = a \\cdot \\mathrm{DN} + b$, where $L_{\\mu\\mathrm{m}}$ is in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$. The calibration coefficients are characterized by uncertainties: $a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$ with standard deviation $\\sigma_{a} = 1.00 \\times 10^{-4} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$, and $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$ with standard deviation $\\sigma_{b} = 0.05 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$. The calibration errors of $a$ and $b$ have correlation coefficient $\\rho_{ab} = -0.3$.\n\nAssume the band is sufficiently narrow that the at-sensor spectral radiance at the band center wavelength $\\lambda = 10.8 \\ \\mu\\mathrm{m}$ can be treated as monochromatic. Define the brightness temperature $T_{b}$ as the temperature of an ideal blackbody that would produce the same at-sensor spectral radiance at wavelength $\\lambda$, i.e., $L_{\\lambda} = B(\\lambda, T_{b})$, where $B(\\lambda, T)$ is the Planck spectral radiance given by\n$$\nB(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwith Planck constant $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J}\\,\\mathrm{s}$, speed of light $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, and Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J}\\,\\mathrm{K}^{-1}$. Note that $L_{\\mu\\mathrm{m}}$ must be converted to $L_{\\lambda}$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ before using the Planck relation.\n\nStarting from these fundamentals and treating calibration uncertainties as Gaussian, derive the conversion from DN to at-sensor spectral radiance and propagate the calibration uncertainty into the standard deviation of the brightness temperature $\\sigma_{T_{b}}$ using first-order uncertainty propagation, including the covariance between $a$ and $b$. Compute the numerical value of $\\sigma_{T_{b}}$ for the given pixel, and:\n\n- Express the final standard deviation in Kelvin.\n- Round your answer to three significant figures.",
            "solution": "The user wants to find the standard deviation of the brightness temperature, $\\sigma_{T_b}$, by propagating the uncertainties from the radiometric calibration coefficients of a thermal infrared sensor.\n\nThe problem is deemed valid as it is scientifically grounded in the principles of blackbody radiation and measurement uncertainty analysis, is well-posed with all necessary information provided, and is formulated objectively. The requested calculation is a standard procedure in quantitative remote sensing.\n\nThe overall analysis proceeds in four stages:\n1.  Calculation of the at-sensor spectral radiance, $L_{\\lambda}$, and its uncertainty, $\\sigma_{L_{\\lambda}}$.\n2.  Inversion of the Planck function to determine the brightness temperature, $T_b$.\n3.  Derivation of the sensitivity of the brightness temperature to the at-sensor radiance, $\\frac{dT_b}{dL_{\\lambda}}$.\n4.  Combination of the radiance uncertainty and the temperature sensitivity to compute the final brightness temperature uncertainty, $\\sigma_{T_b}$.\n\n**1. At-Sensor Spectral Radiance and its Uncertainty**\n\nThe problem provides a linear calibration model to convert the sensor's Digital Number ($\\mathrm{DN}$) to at-sensor spectral radiance, $L_{\\mu\\mathrm{m}}$, in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$:\n$$L_{\\mu\\mathrm{m}} = a \\cdot \\mathrm{DN} + b$$\nGiven $\\mathrm{DN} = 700$, $a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$, and $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$, the nominal radiance is:\n$$L_{\\mu\\mathrm{m}} = (0.012) \\cdot (700) + 1.20 = 8.40 + 1.20 = 9.60 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$$\nThe Planck function is given in terms of spectral radiance per unit wavelength in meters ($L_{\\lambda}$). We must convert $L_{\\mu\\mathrm{m}}$ to $L_{\\lambda}$, which is in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$. The conversion factor is $10^6 \\ \\mu\\mathrm{m}/\\mathrm{m}$.\n$$L_{\\lambda} = L_{\\mu\\mathrm{m}} \\times 10^6 = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\nThe general expression for $L_{\\lambda}$ as a function of the calibration coefficients is:\n$$L_{\\lambda}(a, b) = (a \\cdot \\mathrm{DN} + b) \\times 10^6$$\nTo find the uncertainty in $L_{\\lambda}$, we use the first-order Taylor series expansion for uncertainty propagation. The variance of $L_{\\lambda}$, denoted $\\sigma_{L_{\\lambda}}^2$, is given by:\n$$\\sigma_{L_{\\lambda}}^2 = \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right)^2 \\sigma_b^2 + 2 \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right) \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right) \\sigma_{ab}$$\nwhere $\\sigma_{ab} = \\rho_{ab} \\sigma_a \\sigma_b$ is the covariance between $a$ and $b$. The partial derivatives are:\n$$\\frac{\\partial L_{\\lambda}}{\\partial a} = \\mathrm{DN} \\times 10^6$$\n$$\\frac{\\partial L_{\\lambda}}{\\partial b} = 1 \\times 10^6$$\nSubstituting these into the variance equation:\n$$\\sigma_{L_{\\lambda}}^2 = (\\mathrm{DN} \\times 10^6)^2 \\sigma_a^2 + (10^6)^2 \\sigma_b^2 + 2 (\\mathrm{DN} \\times 10^6)(10^6) \\rho_{ab} \\sigma_a \\sigma_b$$\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\left[ (\\mathrm{DN} \\cdot \\sigma_a)^2 + \\sigma_b^2 + 2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b \\right]$$\nWe are given the values: $\\mathrm{DN} = 700$, $\\sigma_a = 1.00 \\times 10^{-4}$, $\\sigma_b = 0.05$, and $\\rho_{ab} = -0.3$. Let's compute the terms in the bracket:\n$$(\\mathrm{DN} \\cdot \\sigma_a)^2 = (700 \\cdot 1.00 \\times 10^{-4})^2 = (0.07)^2 = 0.0049$$\n$$\\sigma_b^2 = (0.05)^2 = 0.0025$$\n$$2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b = 2 \\cdot (700) \\cdot (-0.3) \\cdot (1.00 \\times 10^{-4}) \\cdot (0.05) = -0.0021$$\nThe term in the bracket, which is the variance of $L_{\\mu\\mathrm{m}}$, is:\n$$\\sigma_{L_{\\mu\\mathrm{m}}}^2 = 0.0049 + 0.0025 - 0.0021 = 0.0053 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1})^2$$\nThe variance of $L_{\\lambda}$ is then:\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\cdot 0.0053 = 5.3 \\times 10^9 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^2$$\nThe standard deviation of the radiance is:\n$$\\sigma_{L_{\\lambda}} = \\sqrt{5.3 \\times 10^9} \\approx 72801.1 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n\n**2. Calculation of Brightness Temperature, $T_b$**\n\nThe brightness temperature $T_b$ is found by inverting the Planck function, $L_{\\lambda} = B(\\lambda, T_b)$:\n$$L_{\\lambda} = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T_b}\\right) - 1}$$\nLet $c_1 = 2hc^2$ and $c_2 = hc/k_B$. The equation becomes $L_{\\lambda} = \\frac{c_1}{\\lambda^5} (\\exp(\\frac{c_2}{\\lambda T_b}) - 1)^{-1}$.\nSolving for $T_b$:\n$$\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) = \\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1$$\n$$T_b = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1\\right)}$$\nUsing the given physical constants:\n$c_1 = 2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)^2 \\approx 1.19104297 \\times 10^{-16} \\ \\mathrm{W}\\,\\mathrm{m}^2\\,\\mathrm{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} \\approx 0.01438777 \\ \\mathrm{m}\\,\\mathrm{K}$\nWith $\\lambda = 10.8 \\ \\mu\\mathrm{m} = 10.8 \\times 10^{-6} \\ \\mathrm{m}$ and $L_{\\lambda} = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$:\n$$\\frac{c_1}{\\lambda^5 L_{\\lambda}} = \\frac{1.191043 \\times 10^{-16}}{(10.8 \\times 10^{-6})^5 \\cdot (9.60 \\times 10^6)} \\approx \\frac{1.191043 \\times 10^{-16}}{1.411281 \\times 10^{-18}} \\approx 84.3946$$\n$$T_b = \\frac{0.01438777}{(10.8 \\times 10^{-6}) \\ln(84.3946 + 1)} \\approx \\frac{0.01438777}{(10.8 \\times 10^{-6}) (4.44723)} \\approx 299.56 \\ \\mathrm{K}$$\n\n**3. Sensitivity of Temperature to Radiance, $\\frac{dT_b}{dL_{\\lambda}}$**\n\nThe uncertainty in $T_b$ due to the uncertainty in $L_{\\lambda}$ is given by $\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$. We need to compute the derivative $\\frac{dT_b}{dL_{\\lambda}}$. It is most convenient to find its reciprocal, $\\frac{dL_{\\lambda}}{dT_b}$, by differentiating the Planck function with respect to temperature.\n$$\\frac{dL_{\\lambda}}{dT_b} = \\frac{\\partial B(\\lambda,T)}{\\partial T} \\bigg|_{T=T_b}$$\n$$\\frac{\\partial B}{\\partial T} = \\frac{c_1}{\\lambda^5} (-1) \\left(\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1\\right)^{-2} \\exp\\left(\\frac{c_2}{\\lambda T}\\right) \\left(-\\frac{c_2}{\\lambda T^2}\\right)$$\nThis expression can be simplified by factoring out the original Planck function $B(\\lambda, T)$:\n$$\\frac{\\partial B}{\\partial T} = B(\\lambda, T) \\cdot \\frac{c_2}{\\lambda T^2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1}$$\nTherefore, the derivative $\\frac{dT_b}{dL_{\\lambda}}$ is:\n$$\\frac{dT_b}{dL_{\\lambda}} = \\left( \\frac{dL_{\\lambda}}{dT_b} \\right)^{-1} = \\frac{1}{L_{\\lambda}} \\cdot \\frac{\\lambda T_b^2}{c_2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) - 1}{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right)} = \\frac{\\lambda T_b^2}{c_2 L_{\\lambda}} \\left(1 - \\exp\\left(-\\frac{c_2}{\\lambda T_b}\\right)\\right)$$\nWe have already calculated the argument of the exponential: $\\frac{c_2}{\\lambda T_b} \\approx 4.44723$.\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{(10.8 \\times 10^{-6}) (299.56)^2}{(0.01438777)(9.60 \\times 10^6)} \\left(1 - \\exp(-4.44723)\\right)$$\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{0.96910}{138122.6} (1 - 0.01171) \\approx (7.0163 \\times 10^{-6})(0.98829) \\approx 6.9344 \\times 10^{-6} \\ \\mathrm{K} \\cdot (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^{-1}$$\n\n**4. Final Brightness Temperature Uncertainty, $\\sigma_{T_b}$**\n\nFinally, we combine the results. The uncertainty in brightness temperature is the product of the radiance sensitivity and the standard deviation of the radiance:\n$$\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$$\n$$\\sigma_{T_b} \\approx (6.9344 \\times 10^{-6}) \\cdot (72801.1) \\approx 0.50484 \\ \\mathrm{K}$$\nThe problem asks for the answer to be rounded to three significant figures.\n$$\\sigma_{T_b} \\approx 0.505 \\ \\mathrm{K}$$",
            "answer": "$$\n\\boxed{0.505}\n$$"
        },
        {
            "introduction": "Urban surfaces are complex mosaics of materials like asphalt, concrete, and vegetation. To accurately measure their temperature from space, we must first characterize their emissivity, which governs how efficiently they radiate heat. This exercise  introduces linear spectral unmixing as a powerful technique to estimate the effective emissivity of a mixed pixel from the known spectra of its constituent materials, providing a robust method for handling real-world surface complexity.",
            "id": "3864262",
            "problem": "You are given a remote sensing scenario in the Thermal Infrared (TIR) domain for urban heat island analysis. A single pixel is known to be an areal mixture of asphalt, concrete, and vegetation, each with known band emissivity spectra from a spectral library. Your task is to derive, implement, and apply a principled algorithm that uses spectral libraries and linear spectral unmixing to estimate the pixel’s band emissivity from simulated thermal observations, starting from first principles of thermal emission and physically consistent mixture modeling.\n\nBegin from the following fundamental bases and definitions, and derive an algorithm entirely from these, avoiding any shortcut formulas:\n- Planck’s law relates blackbody spectral radiance to temperature. For wavelength $\\lambda$ and temperature $T$, the spectral radiance $B(\\lambda, T)$ has the standard form given by well-tested physics.\n- Emissivity is defined as the ratio of the material’s emitted spectral radiance to the blackbody spectral radiance at the same temperature.\n- For a sub-pixel areal mixture under isothermal conditions and negligible atmospheric effects, the observed spectral radiance is the area-weighted sum of the individual emitted spectral radiances of the constituent endmembers.\n\nAssume the following physically realistic and self-consistent setup:\n- Three TIR bands with central wavelengths $\\lambda_1 = 8.7\\,\\mu\\mathrm{m}$, $\\lambda_2 = 11.0\\,\\mu\\mathrm{m}$, and $\\lambda_3 = 12.0\\,\\mu\\mathrm{m}$.\n- Spectral library band emissivities (dimensionless) for endmembers asphalt ($\\mathrm{asp}$), concrete ($\\mathrm{con}$), and vegetation ($\\mathrm{veg}$) arranged as a matrix with rows indexed by band and columns indexed by endmember:\n  - Band $\\lambda_1$: $[\\;0.95,\\;0.90,\\;0.985\\;]$ for $[\\;\\mathrm{asp},\\;\\mathrm{con},\\;\\mathrm{veg}\\;]$.\n  - Band $\\lambda_2$: $[\\;0.97,\\;0.92,\\;0.990\\;]$ for $[\\;\\mathrm{asp},\\;\\mathrm{con},\\;\\mathrm{veg}\\;]$.\n  - Band $\\lambda_3$: $[\\;0.98,\\;0.93,\\;0.990\\;]$ for $[\\;\\mathrm{asp},\\;\\mathrm{con},\\;\\mathrm{veg}\\;]$.\n- Negligible atmosphere approximation: unit transmittance and zero path radiance so that the top-of-atmosphere radiance equals the surface-leaving radiance.\n- Isothermal mixtures: all endmembers share the same kinetic temperature $T$ within each test case.\n\nFrom these bases, you must:\n- Compute band blackbody spectral radiance using Planck’s law for each provided temperature and wavelength.\n- Simulate observed band spectral radiances by forming the area-weighted mixture of endmember emissivities and multiplying by the corresponding blackbody spectral radiance. Then apply specified small multiplicative noise factors to each band’s radiance to represent measurement perturbations. Noise factors are dimensionless multipliers applied to the radiance in the form $(1 + \\delta_b)$ for band $b$.\n- Estimate apparent band emissivity for the pixel by dividing the simulated observed band radiance by the band blackbody spectral radiance, constraining each band emissivity to the physically plausible interval $[0, 1]$.\n- Perform linear spectral unmixing to estimate non-negative endmember fractions that sum to $1$ by solving a least-squares problem with an equality constraint and projecting the solution onto the probability simplex to ensure physical feasibility.\n- Compute the final estimated band emissivity for the pixel as the area-weighted combination of endmember emissivities using the estimated fractions.\n\nUnits and output requirements:\n- Wavelengths must be treated in meters for radiance calculations, but are specified above in micrometers for readability; convert $\\mu\\mathrm{m}$ to $\\mathrm{m}$ as $1\\,\\mu\\mathrm{m} = 10^{-6}\\,\\mathrm{m}$.\n- Radiance is internally computed in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$, but the emissivity estimation relies on a radiance ratio, so units cancel in the ratio; ensure internal consistency by using the same units for both numerator and denominator.\n- Emissivity is dimensionless; report emissivity values as decimal floats rounded to six decimal places.\n- The angle unit is not applicable for this thermal radiometry problem.\n\nTest suite:\nProvide results for the following three test cases, which cover a general case, a pure endmember boundary case, and a noise-perturbed mixed case. In each case, endmember fractions are $[f_{\\mathrm{asp}}, f_{\\mathrm{con}}, f_{\\mathrm{veg}}]$, temperature is $T$, and band-specific multiplicative noise factors are $[\\delta_1, \\delta_2, \\delta_3]$:\n1. Case $1$: fractions $[0.5, 0.3, 0.2]$, temperature $315\\,\\mathrm{K}$, noise $[0.0, 0.0, 0.0]$.\n2. Case $2$: fractions $[1.0, 0.0, 0.0]$, temperature $320\\,\\mathrm{K}$, noise $[0.0, 0.0, 0.0]$.\n3. Case $3$: fractions $[0.05, 0.45, 0.50]$, temperature $300\\,\\mathrm{K}$, noise $[0.01, -0.008, 0.005]$.\n\nAlgorithmic constraints:\n- Use a least-squares estimator with the equality constraint that the fractions sum to $1$, followed by projection onto the non-negative simplex to enforce $f_{\\mathrm{asp}} \\ge 0$, $f_{\\mathrm{con}} \\ge 0$, $f_{\\mathrm{veg}} \\ge 0$, and $f_{\\mathrm{asp}} + f_{\\mathrm{con}} + f_{\\mathrm{veg}} = 1$.\n- Do not rely on any external files or inputs. Use the spectral library and test suite provided herein.\n\nFinal output format:\n- Your program should produce a single line of output containing the emissivity estimates for each test case as a comma-separated list of lists, each inner list giving the three band emissivities rounded to six decimal places, in the order of the test cases, enclosed in square brackets. For example, the printed line should look like $[\\,[e_{1,1},e_{1,2},e_{1,3}],\\,[e_{2,1},e_{2,2},e_{2,3}],\\,[e_{3,1},e_{3,2},e_{3,3}]\\,]$, where $e_{k,b}$ denotes the emissivity for test case $k$ and band $b$.",
            "solution": "The problem requires the derivation and implementation of an algorithm to estimate the band emissivities of a mixed pixel from simulated thermal infrared observations. The solution is developed from first principles of thermal radiometry and linear spectral mixture analysis.\n\n### Part 1: Theoretical Foundation and Model Formulation\n\nWe begin from the fundamental principles provided.\n\n**1. Planck's Law of Blackbody Radiation:**\nA blackbody at an absolute temperature $T$ emits electromagnetic radiation. The spectral radiance $B(\\lambda, T)$, representing the power emitted per unit area, per unit solid angle, per unit wavelength, is given by Planck's law:\n$$\nB(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\frac{1}{e^{\\frac{h c}{\\lambda k_B T}} - 1}\n$$\nwhere $\\lambda$ is the wavelength, $T$ is the absolute temperature in Kelvin, $h$ is Planck's constant ($6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\cdot\\mathrm{s}$), $c$ is the speed of light in vacuum ($299792458\\,\\mathrm{m/s}$), and $k_B$ is the Boltzmann constant ($1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$).\n\n**2. Emissivity and Surface Radiance:**\nReal materials, known as greybodies, emit less energy than a blackbody at the same temperature. The spectral emissivity, $\\epsilon(\\lambda)$, is a dimensionless quantity between $0$ and $1$ that quantifies this efficiency. It is defined as the ratio of the material's spectral radiance $L(\\lambda, T)$ to that of a blackbody at the same temperature:\n$$\n\\epsilon(\\lambda) = \\frac{L(\\lambda, T)}{B(\\lambda, T)}\n$$\nTherefore, the spectral radiance from a real surface is:\n$$\nL(\\lambda, T) = \\epsilon(\\lambda) B(\\lambda, T)\n$$\n\n**3. Linear Mixture Model for a Pixel:**\nThe problem states that a pixel is an areal mixture of $M$ constituent materials (endmembers), and all components within the pixel share the same kinetic temperature $T$ (isothermal condition). Under the assumption of negligible atmospheric effects, the sensor-observed spectral radiance is the area-weighted sum of the radiances from each endmember. For a given spectral band $b$ centered at wavelength $\\lambda_b$, the total observed radiance $L_b^{\\text{obs}}$ is:\n$$\nL_b^{\\text{obs}} = \\sum_{m=1}^{M} f_m L_{b,m}(T) = \\sum_{m=1}^{M} f_m E_{bm} B(\\lambda_b, T)\n$$\nwhere $f_m$ is the fractional area of endmember $m$ (with $\\sum_{m=1}^{M} f_m = 1$), and $E_{bm}$ is the emissivity of endmember $m$ in band $b$.\nWe can factor out the blackbody radiance term:\n$$\nL_b^{\\text{obs}} = \\left( \\sum_{m=1}^{M} f_m E_{bm} \\right) B(\\lambda_b, T)\n$$\nThe term in the parentheses represents the effective band emissivity of the mixed pixel, $\\epsilon_b$:\n$$\n\\epsilon_b = \\sum_{m=1}^{M} f_m E_{bm}\n$$\nIn matrix notation, for a set of $N$ bands, the pixel's emissivity vector $\\boldsymbol{\\epsilon} \\in \\mathbb{R}^N$ is related to the endmember fraction vector $\\mathbf{f} \\in \\mathbb{R}^M$ and the endmember emissivity matrix $\\mathbf{E} \\in \\mathbb{R}^{N \\times M}$ by:\n$$\n\\boldsymbol{\\epsilon} = \\mathbf{E} \\mathbf{f}\n$$\n\n### Part 2: Simulation of Observed Data\n\nFor each test case, we simulate the 'observed' data by following these steps:\n1.  **Calculate Blackbody Radiance:** For each band $b$ with central wavelength $\\lambda_b$ and a given temperature $T$, calculate the blackbody spectral radiance $B_b(T) = B(\\lambda_b, T)$ using Planck's law. Wavelengths must be converted from micrometers ($\\mu\\mathrm{m}$) to meters ($\\mathrm{m}$).\n2.  **Calculate True Pixel Emissivity:** Using the given true fractions $\\mathbf{f}^{\\text{true}} = [f_{\\mathrm{asp}}, f_{\\mathrm{con}}, f_{\\mathrm{veg}}]$ and the spectral library matrix $\\mathbf{E}$, calculate the true pixel emissivity vector $\\boldsymbol{\\epsilon}^{\\text{true}} = \\mathbf{E} \\mathbf{f}^{\\text{true}}$.\n3.  **Simulate Observed Radiance:** Calculate the noise-free radiance $L_b^{\\text{true}} = \\epsilon_b^{\\text{true}} B_b(T)$. Then, apply the specified multiplicative noise factors $\\delta_b$ to simulate measurement perturbations: $L_b^{\\text{obs}} = (1 + \\delta_b) L_b^{\\text{true}}$.\n\n### Part 3: Inversion Algorithm for Emissivity Estimation\n\nThe core task is to estimate the pixel's band emissivity from the simulated $L_b^{\\text{obs}}$, assuming $T$ is known. This involves an inversion process.\n\n**1. Estimation of Apparent Emissivity:**\nFrom the simulated observed radiance $L_b^{\\text{obs}}$, we calculate an \"apparent\" band emissivity, $\\hat{\\epsilon}_b^{\\text{app}}$, by inverting the radiance equation:\n$$\n\\hat{\\epsilon}_b^{\\text{app}} = \\frac{L_b^{\\text{obs}}}{B_b(T)}\n$$\nDue to measurement noise, this value may fall outside the physically plausible range of $[0, 1]$. We enforce this constraint by clipping the value:\n$\\hat{\\epsilon}_b^{\\text{app}} = \\mathrm{clip}(\\hat{\\epsilon}_b^{\\text{app}}, 0, 1)$.\n\n**2. Constrained Linear Spectral Unmixing:**\nWe now seek to find the endmember fractions $\\hat{\\mathbf{f}}$ that best explain the apparent emissivity vector $\\hat{\\boldsymbol{\\epsilon}}^{\\text{app}}$ according to the linear model $\\hat{\\boldsymbol{\\epsilon}}^{\\text{app}} \\approx \\mathbf{E} \\hat{\\mathbf{f}}$. The fractions must satisfy two physical constraints: the sum-to-one constraint ($\\sum_m \\hat{f}_m = 1$) and the non-negativity constraint ($\\hat{f}_m \\ge 0$ for all $m$).\n\nThe problem specifies solving a least-squares problem with an equality constraint, followed by a projection. We first minimize the sum of squared errors subject to the sum-to-one constraint:\n$$\n\\min_{\\hat{\\mathbf{f}}} \\|\\mathbf{E} \\hat{\\mathbf{f}} - \\hat{\\boldsymbol{\\epsilon}}^{\\text{app}}\\|_2^2 \\quad \\text{subject to} \\quad \\mathbf{1}^T \\hat{\\mathbf{f}} = 1\n$$\nThis is a classic equality-constrained least squares problem, which can be solved using the method of Lagrange multipliers. The Lagrangian is:\n$$\n\\mathcal{L}(\\hat{\\mathbf{f}}, \\mu) = \\frac{1}{2} (\\mathbf{E} \\hat{\\mathbf{f}} - \\hat{\\boldsymbol{\\epsilon}}^{\\text{app}})^T (\\mathbf{E} \\hat{\\mathbf{f}} - \\hat{\\boldsymbol{\\epsilon}}^{\\text{app}}) + \\mu(\\mathbf{1}^T \\hat{\\mathbf{f}} - 1)\n$$\nSetting the gradient with respect to $\\hat{\\mathbf{f}}$ to zero gives:\n$$\n\\nabla_{\\hat{\\mathbf{f}}} \\mathcal{L} = \\mathbf{E}^T(\\mathbf{E} \\hat{\\mathbf{f}} - \\hat{\\boldsymbol{\\epsilon}}^{\\text{app}}) + \\mu\\mathbf{1} = \\mathbf{0}\n$$\nSolving for $\\hat{\\mathbf{f}}$ yields:\n$$\n\\hat{\\mathbf{f}} = (\\mathbf{E}^T\\mathbf{E})^{-1}(\\mathbf{E}^T\\hat{\\boldsymbol{\\epsilon}}^{\\text{app}} - \\mu\\mathbf{1})\n$$\nSubstituting this into the constraint equation $\\mathbf{1}^T \\hat{\\mathbf{f}} = 1$ allows us to solve for the Lagrange multiplier $\\mu$:\n$$\n\\mu = \\frac{\\mathbf{1}^T (\\mathbf{E}^T\\mathbf{E})^{-1} \\mathbf{E}^T \\hat{\\boldsymbol{\\epsilon}}^{\\text{app}} - 1}{\\mathbf{1}^T (\\mathbf{E}^T\\mathbf{E})^{-1} \\mathbf{1}}\n$$\nWith $\\mu$ known, we compute the solution $\\hat{\\mathbf{f}}_{\\text{s1}}$ that satisfies the sum-to-one constraint. This solution may still have negative components.\n\n**3. Projection onto the Probability Simplex:**\nTo enforce the non-negativity constraint, we project the vector $\\hat{\\mathbf{f}}_{\\text{s1}}$ onto the probability simplex (i.e., the set of vectors with non-negative components that sum to $1$). A standard algorithm for this projection is used. For a vector $\\mathbf{y} \\in \\mathbb{R}^M$, the projection $\\mathbf{x} = \\text{proj}_{\\Delta}(\\mathbf{y})$ is found by:\n1. Sort the components of $\\mathbf{y}$ in descending order: $y_{(1)} \\ge y_{(2)} \\ge \\dots \\ge y_{(M)}$.\n2. Find the largest integer $\\rho$ such that $y_{(\\rho)} - \\frac{1}{\\rho}(\\sum_{i=1}^\\rho y_{(i)} - 1) > 0$.\n3. Define a threshold $\\tau = \\frac{1}{\\rho}(\\sum_{i=1}^\\rho y_{(i)} - 1)$.\n4. The projected vector components are $x_j = \\max(y_j - \\tau, 0)$.\nThe resulting vector $\\hat{\\mathbf{f}} = \\text{proj}_{\\Delta}(\\hat{\\mathbf{f}}_{\\text{s1}})$ is our final estimate for the endmember fractions.\n\n**4. Final Emissivity Estimation:**\nUsing the estimated, physically valid fractions $\\hat{\\mathbf{f}}$, we compute the final estimated band emissivity vector $\\hat{\\boldsymbol{\\epsilon}}^{\\text{final}}$ by re-applying the linear mixture model:\n$$\n\\hat{\\boldsymbol{\\epsilon}}^{\\text{final}} = \\mathbf{E} \\hat{\\mathbf{f}}\n$$\nThis final vector represents the algorithm's best estimate of the pixel's true band emissivities, consistent with the spectral library and the constrained linear model. This process is repeated for each of the three test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the remote sensing emissivity estimation problem based on first principles.\n    \"\"\"\n    # Physical Constants\n    H = 6.62607015e-34  # Planck's constant (J*s)\n    C = 299792458.0    # Speed of light (m/s)\n    KB = 1.380649e-23   # Boltzmann constant (J/K)\n\n    # Problem Givens\n    # Wavelengths in meters\n    wavelengths = np.array([8.7e-6, 11.0e-6, 12.0e-6])\n\n    # Endmember emissivity matrix (rows: bands, cols: endmembers)\n    # Endmembers: [asphalt, concrete, vegetation]\n    E = np.array([\n        [0.95, 0.90, 0.985],  # Band 1 (lambda_1)\n        [0.97, 0.92, 0.990],  # Band 2 (lambda_2)\n        [0.98, 0.93, 0.990],  # Band 3 (lambda_3)\n    ])\n\n    test_cases = [\n        # (fractions, temperature, noise_factors)\n        ([0.5, 0.3, 0.2], 315.0, [0.0, 0.0, 0.0]),\n        ([1.0, 0.0, 0.0], 320.0, [0.0, 0.0, 0.0]),\n        ([0.05, 0.45, 0.50], 300.0, [0.01, -0.008, 0.005]),\n    ]\n\n    def planck_radiance(lam, T):\n        \"\"\"Calculates blackbody spectral radiance using Planck's Law.\"\"\"\n        exponent_term = (H * C) / (lam * KB * T)\n        return (2 * H * C**2) / (lam**5 * (np.exp(exponent_term) - 1))\n\n    def project_to_simplex(y):\n        \"\"\"Projects a vector y onto the probability simplex.\"\"\"\n        m = len(y)\n        y_sorted = np.sort(y)[::-1]\n        \n        # Cumulative sum of sorted y\n        y_cumsum = np.cumsum(y_sorted)\n        \n        # Find rho\n        rho_candidates = np.where(y_sorted - (y_cumsum - 1) / np.arange(1, m + 1) > 0)[0]\n        if len(rho_candidates) == 0:\n            rho = -1 # Should not happen for this problem's setup\n        else:\n            rho = np.max(rho_candidates)\n        \n        # Define threshold tau\n        tau = (y_cumsum[rho] - 1) / (rho + 1)\n        \n        # The projection\n        x = np.maximum(0, y - tau)\n        return x\n\n    def solve_unmixing(E_matrix, eps_app_vec):\n        \"\"\"\n        Performs constrained linear spectral unmixing.\n        1. Solves least squares with sum-to-one constraint.\n        2. Projects the result onto the probability simplex.\n        \"\"\"\n        # Step 1: Solve sum-to-one constrained least squares via Lagrange multipliers\n        E_T_E = E_matrix.T @ E_matrix\n        E_T_E_inv = np.linalg.inv(E_T_E)\n        \n        ones_vec = np.ones(E_matrix.shape[1])\n        \n        mu_numerator = ones_vec.T @ E_T_E_inv @ E_matrix.T @ eps_app_vec - 1\n        mu_denominator = ones_vec.T @ E_T_E_inv @ ones_vec\n        \n        mu = mu_numerator / mu_denominator\n        \n        f_s1 = E_T_E_inv @ (E_matrix.T @ eps_app_vec - mu * ones_vec)\n        \n        # Step 2: Project onto probability simplex to enforce non-negativity\n        f_hat = project_to_simplex(f_s1)\n        \n        return f_hat\n\n    results = []\n    for case in test_cases:\n        fractions, T, noise_factors = case\n        fractions = np.array(fractions)\n        noise_factors = np.array(noise_factors)\n        \n        # --- Part 1: Simulation ---\n        \n        # Calculate blackbody radiance for each band\n        B_T = planck_radiance(wavelengths, T)\n        \n        # Calculate true mixed pixel emissivity\n        eps_true = E @ fractions\n        \n        # Calculate noise-free radiance\n        L_true = eps_true * B_T\n        \n        # Simulate observed radiance with noise\n        L_obs = (1 + noise_factors) * L_true\n        \n        # --- Part 2: Inversion ---\n        \n        # Estimate apparent emissivity\n        eps_app = L_obs / B_T\n        # Constrain to physical range [0, 1]\n        eps_app = np.clip(eps_app, 0, 1)\n\n        # Perform constrained linear unmixing to get estimated fractions\n        f_hat = solve_unmixing(E, eps_app)\n        \n        # Compute final estimated band emissivity\n        eps_final = E @ f_hat\n        \n        results.append(np.round(eps_final, 6).tolist())\n\n    # Format the final output as a single string\n    output_str = '[' + ','.join(map(str, results)) + ']'\n    output_str = output_str.replace(\" \", \"\") # Remove spaces for exact format\n\n\n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The radiance measured by a satellite is altered by the atmosphere before it reaches the sensor. To retrieve the true Land Surface Temperature ($T_s$), a cornerstone of UHI analysis, we must correct for these atmospheric effects and for the surface's non-ideal emissivity. This practice  implements a generalized split-window algorithm, which leverages observations in two adjacent thermal channels to disentangle surface temperature from atmospheric and emissivity contributions, providing direct experience with a state-of-the-art retrieval technique.",
            "id": "3864213",
            "problem": "A nocturnal urban heat island retrieval over a dense urban core is performed using thermal infrared observations from a polar-orbiting sensor with two atmospheric window channels centered at $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$. Let $T_{11}$ and $T_{12}$ denote the top-of-atmosphere brightness temperatures in kelvin for the $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels, respectively. The urban surface is assumed isothermal within the pixel and Lambertian in the thermal domain, with known mean emissivity $\\varepsilon$ and emissivity difference $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$. The atmospheric state is summarized by the total column water vapor $W$ in $\\mathrm{g}\\,\\mathrm{cm}^{-2}$. The goal is to estimate the land surface temperature $T_{s}$ for this urban pixel, as part of an urban heat island analysis workflow.\n\nStarting from the thermal infrared radiative transfer equation for upwelling radiance at the top of the atmosphere and the definition of brightness temperature as the inverse Planck function applied to radiance, derive the functional dependence of $T_{s}$ on $T_{11}$, $T_{12}$, $\\varepsilon$, $\\Delta \\varepsilon$, and $W$ under a split-window linearization and second-order correction in the inter-channel brightness temperature difference. Then, using the provided regression coefficients that encapsulate sensor spectral response and representative mid-latitude atmospheric transmittance behavior, evaluate $T_{s}$ for the specific scene described below.\n\nUse the following inputs for the urban pixel:\n- $T_{11} = 315.2\\,\\mathrm{K}$,\n- $T_{12} = 313.7\\,\\mathrm{K}$,\n- $\\varepsilon = 0.964$,\n- $\\Delta \\varepsilon = 0.010$,\n- $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$.\n\nAdopt the following split-window regression coefficients (dimensionless unless otherwise noted), calibrated for a sensor with $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels under mid-latitude summer atmospheres:\n- $a_{0} = -0.268$,\n- $a_{1} = 1.378$,\n- $a_{2} = 0.183$,\n- $a_{3} = 54.3$,\n- $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$,\n- $a_{5} = -129.2$,\n- $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$.\n\nCompute and report the land surface temperature $T_{s}$ for this pixel. Express the final answer in kelvin and round your answer to four significant figures.",
            "solution": "The user wants to solve a thermal remote sensing problem.\n\n### Step 1: Extract Givens\n-   **Sensor Channels:** $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$.\n-   **Top-of-Atmosphere Brightness Temperatures:** $T_{11}$ and $T_{12}$.\n-   **Surface Properties:** Mean emissivity $\\varepsilon$, emissivity difference $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$.\n-   **Atmospheric State:** Total column water vapor $W$.\n-   **Objective:** Estimate land surface temperature $T_{s}$.\n-   **Methodology:** Derive the functional dependence of $T_{s}$ on $T_{11}$, $T_{12}$, $\\varepsilon$, $\\Delta \\varepsilon$, and $W$ using a split-window linearization and second-order correction in the inter-channel brightness temperature difference. Then, evaluate $T_s$ using provided data.\n-   **Input Data for Calculation:**\n    -   $T_{11} = 315.2\\,\\mathrm{K}$\n    -   $T_{12} = 313.7\\,\\mathrm{K}$\n    -   $\\varepsilon = 0.964$\n    -   $\\Delta \\varepsilon = 0.010$\n    -   $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$\n-   **Regression Coefficients:**\n    -   $a_{0} = -0.268$\n    -   $a_{1} = 1.378$\n    -   $a_{2} = 0.183$\n    -   $a_{3} = 54.3$\n    -   $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n    -   $a_{5} = -129.2$\n    -   $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n-   **Final Answer Requirement:** Report $T_s$ in kelvin, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard application in the field of quantitative thermal remote sensing. It asks for the calculation of Land Surface Temperature (LST) using a split-window algorithm, a well-established technique that utilizes observations in two adjacent thermal infrared atmospheric window channels.\n\n-   **Scientific Grounding:** The problem is firmly grounded in the principles of radiative transfer theory and remote sensing science. The radiative transfer equation, Planck's law, the concept of brightness temperature, and the physical basis for split-window algorithms (differential atmospheric absorption, primarily by water vapor) are all fundamental to the discipline. The specified algorithm structure, including corrections for atmospheric effects and surface emissivity, represents a common and valid approach.\n-   **Well-Posedness:** The problem provides a complete set of input parameters and regression coefficients, along with a sufficiently detailed description of the algorithm type (\"split-window linearization and second-order correction\"). This information implicitly defines a specific mathematical formula, ensuring a unique solution can be calculated. The values of the inputs ($T_{11}$, $T_{12}$, $\\varepsilon$, $W$) are physically plausible for a nocturnal urban environment during a warm season.\n-   **Objectivity and Consistency:** The problem is stated using objective, precise scientific language. All provided data and coefficients are numerically and dimensionally consistent with the structure of common generalized split-window algorithms. There are no internal contradictions, ambiguities, or subjective claims.\n\nThe problem is a well-defined, scientifically valid, and solvable physics problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation and Calculation\n\nThe estimation of Land Surface Temperature ($T_s$) from spaceborne thermal sensors requires correcting for the effects of the intervening atmosphere and the non-blackbody nature of the surface (i.e., emissivity $\\varepsilon < 1$). The split-window technique is a widely used method for this purpose.\n\nThe physical basis is the radiative transfer equation (RTE) for thermal radiation measured by a sensor in channel $i$:\n$$L_{i} = \\varepsilon_{i} B_{i}(T_s) \\tau_{i} + L^{\\uparrow}_{i, \\text{atm}} + (1 - \\varepsilon_{i}) L^{\\downarrow}_{i, \\text{atm}} \\tau_{i}$$\nHere, $L_{i}$ is the at-sensor radiance, $\\varepsilon_{i}$ is the surface emissivity, $B_{i}(T_s)$ is the Planck function integrated over the channel's response for a surface at temperature $T_s$, $\\tau_i$ is the atmospheric transmittance, and $L^{\\uparrow}_{i, \\text{atm}}$ and $L^{\\downarrow}_{i, \\text{atm}}$ are the upwelling and downwelling atmospheric path radiances, respectively.\n\nThe brightness temperature $T_{i}$ is defined as the temperature of a blackbody that would emit the same radiance $L_i$, i.e., $L_i = B_i(T_i)$. Solving the RTE for $T_s$ is an ill-posed inverse problem because it involves multiple unknowns ($T_s$, $\\varepsilon_i$, $\\tau_i$, $L^{\\uparrow}_{i, \\text{atm}}$, $L^{\\downarrow}_{i, \\text{atm}}$) and only two measurements ($T_{11}$, $T_{12}$).\n\nThe split-window approach overcomes this by exploiting the differential absorption between the $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels, which is primarily a function of the total column water vapor ($W$). By linearizing the Planck function and making approximations, one can express $T_s$ as a function of the measured brightness temperatures $T_{11}$ and $T_{12}$, and corrections for emissivity. The inclusion of a term quadratic in the brightness temperature difference, $(T_{11} - T_{12})^2$, enhances the correction for a wider range of atmospheric conditions, as requested by the problem's specification of a \"second-order correction\".\n\nThe problem implies a specific regression-based algorithm structure, common in the literature, which formalizes these corrections. Based on the provided variables and coefficients ($a_0$ through $a_6$), the functional form for $T_s$ is a generalized split-window algorithm:\n$$T_s = T_{11} + a_1(T_{11}-T_{12}) + a_2(T_{11}-T_{12})^2 + a_0 + (a_3 + a_4 W)(1-\\varepsilon) + (a_5 + a_6 W)\\Delta\\varepsilon$$\nThis equation accounts for:\n-   A baseline temperature ($T_{11}$).\n-   A first-order atmospheric correction, linear in the brightness temperature difference ($a_1(T_{11}-T_{12})$).\n-   A second-order atmospheric correction, quadratic in the difference ($a_2(T_{11}-T_{12})^2$).\n-   A constant offset ($a_0$).\n-   A correction for emissivity magnitude, where the term $(1-\\varepsilon)$ is related to reflected downwelling radiance. The coefficient for this term depends on column water vapor $W$.\n-   A correction for the spectral contrast in emissivity, related to $\\Delta\\varepsilon$, whose coefficient also depends on $W$.\n\nWe now proceed to calculate $T_s$ by substituting the given values into this equation.\n\nFirst, we calculate the intermediate quantities:\n-   Brightness temperature difference: $T_{11} - T_{12} = 315.2\\,\\mathrm{K} - 313.7\\,\\mathrm{K} = 1.5\\,\\mathrm{K}$.\n-   Squared difference: $(T_{11} - T_{12})^2 = (1.5\\,\\mathrm{K})^2 = 2.25\\,\\mathrm{K}^2$.\n-   Emissivity term: $1 - \\varepsilon = 1 - 0.964 = 0.036$.\n-   Emissivity difference: $\\Delta \\varepsilon = 0.010$.\n\nNext, we calculate the main components of the equation:\n-   Term 1 ($T_{11}$): $315.2\\,\\mathrm{K}$\n-   Term 2 (Linear atmospheric correction): $a_1(T_{11}-T_{12}) = 1.378 \\times 1.5 = 2.067\\,\\mathrm{K}$\n-   Term 3 (Quadratic atmospheric correction): $a_2(T_{11}-T_{12})^2 = 0.183 \\times 2.25 = 0.41175\\,\\mathrm{K}$\n-   Term 4 (Offset): $a_0 = -0.268\\,\\mathrm{K}$\n-   Term 5 (Emissivity magnitude correction): $(a_3 + a_4 W)(1-\\varepsilon)$\n    -   Water vapor dependent part: $a_3 + a_4 W = 54.3 + (-2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = 54.3 - 4.9236 = 49.3764$. The problem statement implies the units of $a_3$ and $a_5$ should be kelvin for dimensional consistency, so this term has units of kelvin.\n    -   Full term: $49.3764\\,\\mathrm{K} \\times 0.036 = 1.7775504\\,\\mathrm{K}$\n-   Term 6 (Emissivity spectral contrast correction): $(a_5 + a_6 W)\\Delta\\varepsilon$\n    -   Water vapor dependent part: $a_5 + a_6 W = -129.2 + (16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = -129.2 + 36.08 = -93.12$. This term has units of kelvin.\n    -   Full term: $-93.12\\,\\mathrm{K} \\times 0.010 = -0.9312\\,\\mathrm{K}$\n\nFinally, we sum all the terms to find $T_s$:\n$$T_s = 315.2 + 2.067 + 0.41175 - 0.268 + 1.7775504 - 0.9312$$\n$$T_s = 318.2571004\\,\\mathrm{K}$$\n\nRounding the final result to four significant figures as requested:\n$$T_s \\approx 318.3\\,\\mathrm{K}$$",
            "answer": "$$\n\\boxed{318.3}\n$$"
        }
    ]
}