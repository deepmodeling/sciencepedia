{
    "hands_on_practices": [
        {
            "introduction": "在定量遥感中，将传感器记录的原始数字量（$DN$）转换为具有物理意义的辐射亮度是至关重要的一步。这个过程被称为辐射定标。本练习将引导您完成这一过程，并进一步探讨定标系数自身的不确定性如何传播到最终的亮度温度估算中，这对于评估最终科学产品的可靠性至关重要。",
            "id": "3864235",
            "problem": "一台搭载于极轨卫星上的热红外成像光谱仪被用于研究一个特大城市的城市热岛 (UHI) 效应。对于 10.8 微米波段的一个天底视场像元，传感器输出的数字量 (DN) 为 $700$。将 DN 转换为传感器处光谱辐亮度（每微米）的辐射定标被建模为线性关系：$L_{\\mu\\mathrm{m}} = a \\, \\mathrm{DN} + b$，其中 $L_{\\mu\\mathrm{m}}$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$。定标系数具有不确定性：$a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$，其标准差为 $\\sigma_{a} = 1.00 \\times 10^{-4} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$；$b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$，其标准差为 $\\sigma_{b} = 0.05 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$。$a$ 和 $b$ 的定标误差的相关系数为 $\\rho_{ab} = -0.3$。\n\n假设该波段足够窄，以至于在波段中心波长 $\\lambda = 10.8 \\ \\mu\\mathrm{m}$ 处的传感器处光谱辐亮度可以被视为单色的。将亮度温度 $T_{b}$ 定义为：一个理想黑体在产生与波长 $\\lambda$ 处传感器光谱辐亮度相同的值时所具有的温度，即 $L_{\\lambda} = B(\\lambda, T_{b})$，其中 $B(\\lambda, T)$ 是由下式给出的 Planck 光谱辐亮度：\n$$\nB(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\n其中 Planck 常数 $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J}\\,\\mathrm{s}$，光速 $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m}\\,\\mathrm{s}^{-1}$，以及 Boltzmann 常数 $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J}\\,\\mathrm{K}^{-1}$。注意，在使用 Planck 关系式之前，必须将 $L_{\\mu\\mathrm{m}}$ 转换为以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 为单位的 $L_{\\lambda}$。\n\n从这些基本原理出发，将定标不确定性视为高斯分布，推导从 DN 到传感器处光谱辐亮度的转换，并使用一阶不确定度传播方法，将定标不确定度传播到亮度温度的标准差 $\\sigma_{T_{b}}$ 中，计算中需包括 $a$ 和 $b$ 之间的协方差。计算给定像元的 $\\sigma_{T_{b}}$ 的数值，并：\n\n- 以开尔文为单位表示最终的标准差。\n- 将您的答案四舍五入到三位有效数字。",
            "solution": "用户希望通过传播热红外传感器辐射定标系数的不确定性，来求得亮度温度的标准差 $\\sigma_{T_b}$。\n\n该问题被认为是有效的，因为它科学地基于黑体辐射和测量不确定性分析的原理，问题陈述清晰且提供了所有必要信息，并且表述客观。所要求的计算是定量遥感中的一个标准程序。\n\n整体分析分为四个阶段：\n1.  计算传感器处光谱辐亮度 $L_{\\lambda}$ 及其不确定度 $\\sigma_{L_{\\lambda}}$。\n2.  反演 Planck 函数以确定亮度温度 $T_b$。\n3.  推导亮度温度对传感器处辐亮度的灵敏度 $\\frac{dT_b}{dL_{\\lambda}}$。\n4.  结合辐亮度不确定度和温度灵敏度，计算最终的亮度温度不确定度 $\\sigma_{T_b}$。\n\n**1. 传感器处光谱辐亮度及其不确定度**\n\n问题提供了一个线性定标模型，用于将传感器的数字量 ($\\mathrm{DN}$) 转换为以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$ 为单位的传感器处光谱辐亮度 $L_{\\mu\\mathrm{m}}$：\n$$L_{\\mu\\mathrm{m}} = a \\cdot \\mathrm{DN} + b$$\n给定 $\\mathrm{DN} = 700$，$a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$，以及 $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$，名义上的辐亮度为：\n$$L_{\\mu\\mathrm{m}} = (0.012) \\cdot (700) + 1.20 = 8.40 + 1.20 = 9.60 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$$\nPlanck 函数是以每单位米波长的光谱辐亮度（$L_{\\lambda}$）给出的。我们必须将 $L_{\\mu\\mathrm{m}}$ 转换为以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 为单位的 $L_{\\lambda}$。转换因子为 $10^6 \\ \\mu\\mathrm{m}/\\mathrm{m}$。\n$$L_{\\lambda} = L_{\\mu\\mathrm{m}} \\times 10^6 = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n$L_{\\lambda}$ 作为定标系数的函数的通用表达式为：\n$$L_{\\lambda}(a, b) = (a \\cdot \\mathrm{DN} + b) \\times 10^6$$\n为了求出 $L_{\\lambda}$ 的不确定度，我们使用一阶泰勒级数展开进行不确定度传播。$L_{\\lambda}$ 的方差，记为 $\\sigma_{L_{\\lambda}}^2$，由下式给出：\n$$\\sigma_{L_{\\lambda}}^2 = \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right)^2 \\sigma_b^2 + 2 \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right) \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right) \\sigma_{ab}$$\n其中 $\\sigma_{ab} = \\rho_{ab} \\sigma_a \\sigma_b$ 是 $a$ 和 $b$ 之间的协方差。偏导数是：\n$$\\frac{\\partial L_{\\lambda}}{\\partial a} = \\mathrm{DN} \\times 10^6$$\n$$\\frac{\\partial L_{\\lambda}}{\\partial b} = 1 \\times 10^6$$\n将这些代入方差方程：\n$$\\sigma_{L_{\\lambda}}^2 = (\\mathrm{DN} \\times 10^6)^2 \\sigma_a^2 + (10^6)^2 \\sigma_b^2 + 2 (\\mathrm{DN} \\times 10^6)(10^6) \\rho_{ab} \\sigma_a \\sigma_b$$\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\left[ (\\mathrm{DN} \\cdot \\sigma_a)^2 + \\sigma_b^2 + 2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b \\right]$$\n我们已知数值：$\\mathrm{DN} = 700$，$\\sigma_a = 1.00 \\times 10^{-4}$，$\\sigma_b = 0.05$，以及 $\\rho_{ab} = -0.3$。让我们计算括号中的各项：\n$$(\\mathrm{DN} \\cdot \\sigma_a)^2 = (700 \\cdot 1.00 \\times 10^{-4})^2 = (0.07)^2 = 0.0049$$\n$$\\sigma_b^2 = (0.05)^2 = 0.0025$$\n$$2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b = 2 \\cdot (700) \\cdot (-0.3) \\cdot (1.00 \\times 10^{-4}) \\cdot (0.05) = -0.0021$$\n括号中的项，即 $L_{\\mu\\mathrm{m}}$ 的方差，为：\n$$\\sigma_{L_{\\mu\\mathrm{m}}}^2 = 0.0049 + 0.0025 - 0.0021 = 0.0053 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1})^2$$\n那么 $L_{\\lambda}$ 的方差是：\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\cdot 0.0053 = 5.3 \\times 10^9 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^2$$\n辐亮度的标准差是：\n$$\\sigma_{L_{\\lambda}} = \\sqrt{5.3 \\times 10^9} \\approx 72801.1 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n\n**2. 亮度温度 $T_b$ 的计算**\n\n亮度温度 $T_b$ 是通过反演 Planck 函数 $L_{\\lambda} = B(\\lambda, T_b)$ 求得的：\n$$L_{\\lambda} = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T_b}\\right) - 1}$$\n令 $c_1 = 2hc^2$ 且 $c_2 = hc/k_B$。方程变为 $L_{\\lambda} = \\frac{c_1}{\\lambda^5} (\\exp(\\frac{c_2}{\\lambda T_b}) - 1)^{-1}$。\n求解 $T_b$：\n$$T_b = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1\\right)}$$\n使用给定的物理常数：\n$c_1 = 2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)^2 \\approx 1.19104297 \\times 10^{-16} \\ \\mathrm{W}\\,\\mathrm{m}^2\\,\\mathrm{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} \\approx 0.01438777 \\ \\mathrm{m}\\,\\mathrm{K}$\n当 $\\lambda = 10.8 \\ \\mu\\mathrm{m} = 10.8 \\times 10^{-6} \\ \\mathrm{m}$ 且 $L_{\\lambda} = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 时：\n$$\\frac{c_1}{\\lambda^5 L_{\\lambda}} = \\frac{1.191043 \\times 10^{-16}}{(10.8 \\times 10^{-6})^5 \\cdot (9.60 \\times 10^6)} \\approx \\frac{1.191043 \\times 10^{-16}}{1.421145 \\times 10^{-18}} \\approx 83.8083$$\n$$T_b = \\frac{0.01438777}{(10.8 \\times 10^{-6}) \\ln(83.8083 + 1)} \\approx \\frac{0.01438777}{(10.8 \\times 10^{-6}) (4.44038)} \\approx 300.00 \\ \\mathrm{K}$$\n\n**3. 温度对辐亮度的灵敏度 $\\frac{dT_b}{dL_{\\lambda}}$**\n\n由 $L_{\\lambda}$ 的不确定度引起的 $T_b$ 的不确定度由 $\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$ 给出。我们需要计算导数 $\\frac{dT_b}{dL_{\\lambda}}$。最方便的方法是通过对 Planck 函数关于温度求导来求其倒数 $\\frac{dL_{\\lambda}}{dT_b}$。\n$$\\frac{dL_{\\lambda}}{dT_b} = \\frac{\\partial B(\\lambda,T)}{\\partial T} \\bigg|_{T=T_b}$$\n$$\\frac{\\partial B}{\\partial T} = \\frac{c_1}{\\lambda^5} (-1) \\left(\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1\\right)^{-2} \\exp\\left(\\frac{c_2}{\\lambda T}\\right) \\left(-\\frac{c_2}{\\lambda T^2}\\right)$$\n这个表达式可以通过提出原始的 Planck 函数 $B(\\lambda, T)$ 来简化：\n$$\\frac{\\partial B}{\\partial T} = B(\\lambda, T) \\cdot \\frac{c_2}{\\lambda T^2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1}$$\n因此，导数 $\\frac{dT_b}{dL_{\\lambda}}$ 为：\n$$\\frac{dT_b}{dL_{\\lambda}} = \\left( \\frac{dL_{\\lambda}}{dT_b} \\right)^{-1} = \\frac{1}{L_{\\lambda}} \\cdot \\frac{\\lambda T_b^2}{c_2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) - 1}{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right)} = \\frac{\\lambda T_b^2}{c_2 L_{\\lambda}} \\left(1 - \\exp\\left(-\\frac{c_2}{\\lambda T_b}\\right)\\right)$$\n我们已经计算了指数的参数：$\\frac{c_2}{\\lambda T_b} \\approx 4.44038$。\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{(10.8 \\times 10^{-6}) (300.00)^2}{(0.01438777)(9.60 \\times 10^6)} \\left(1 - \\exp(-4.44038)\\right)$$\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{0.972}{138122.6} (1 - 0.0118) \\approx (7.037 \\times 10^{-6})(0.9882) \\approx 6.954 \\times 10^{-6} \\ \\mathrm{K} \\cdot (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^{-1}$$\n\n**4. 最终亮度温度不确定度 $\\sigma_{T_b}$**\n\n最后，我们合并结果。亮度温度的不确定度是辐亮度灵敏度与辐亮度标准差的乘积：\n$$\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$$\n$$\\sigma_{T_b} \\approx (6.954 \\times 10^{-6}) \\cdot (72801.1) \\approx 0.5063 \\ \\mathrm{K}$$\n问题要求答案四舍五入到三位有效数字。\n$$\\sigma_{T_b} \\approx 0.506 \\ \\mathrm{K}$$",
            "answer": "$$\n\\boxed{0.506}\n$$"
        },
        {
            "introduction": "从卫星上直接测量的亮度温度受到了大气吸收和地表发射率的影响，并非真实的地表温度（$T_s$）。劈窗算法是利用相邻热红外波段大气透过率的差异来校正这些影响的经典方法。本练习将让您应用一个广义劈窗算法，综合考虑大气水汽和地表发射率的影响，从卫星观测的亮度温度中精确计算出城市地表温度。",
            "id": "3864213",
            "problem": "使用一颗极轨卫星上传感器的热红外观测数据，对一个密集城市核心区进行夜间城市热岛反演。该传感器有两个大气窗口通道，中心分别位于 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$。设 $T_{11}$ 和 $T_{12}$ 分别表示 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$ 通道在大气层顶的亮温，单位为开尔文。假设城市地表在像元内是等温的，并且在热波段范围内是朗伯体，其已知平均比辐射率为 $\\varepsilon$，比辐射率差异为 $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$。大气状态由总水汽柱含量 $W$ 概括，单位为 $\\mathrm{g}\\,\\mathrm{cm}^{-2}$。目标是估算该城市像元的地表温度 $T_{s}$，作为城市热岛分析工作流程的一部分。\n\n从大气层顶上行辐射的热红外辐射传输方程以及亮温定义（即普朗克函数反函数应用于辐射）出发，推导在劈窗线性化和通道间亮温差的二阶校正条件下，$T_{s}$ 对 $T_{11}$、$T_{12}$、$\\varepsilon$、$\\Delta \\varepsilon$ 和 $W$ 的函数依赖关系。然后，使用提供的包含了传感器光谱响应和代表性中纬度大气透过率行为的回归系数，为下述特定场景计算 $T_{s}$。\n\n对该城市像元使用以下输入：\n- $T_{11} = 315.2\\,\\mathrm{K}$，\n- $T_{12} = 313.7\\,\\mathrm{K}$，\n- $\\varepsilon = 0.964$，\n- $\\Delta \\varepsilon = 0.010$，\n- $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$。\n\n采用以下劈窗回归系数（除非另有说明，均为无量纲），这些系数是针对具有 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$ 通道的传感器在中纬度夏季大气条件下校准的：\n- $a_{0} = -0.268$，\n- $a_{1} = 1.378$，\n- $a_{2} = 0.183$，\n- $a_{3} = 54.3$，\n- $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，\n- $a_{5} = -129.2$，\n- $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$。\n\n计算并报告此像元的地表温度 $T_{s}$。最终答案以开尔文表示，并四舍五入至四位有效数字。",
            "solution": "用户需要解决一个热遥感问题。\n\n### 步骤1：提取已知条件\n-   **传感器通道：** $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$。\n-   **大气层顶亮温：** $T_{11}$ 和 $T_{12}$。\n-   **地表属性：** 平均比辐射率 $\\varepsilon$，比辐射率差异 $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$。\n-   **大气状态：** 总水汽柱含量 $W$。\n-   **目标：** 估算地表温度 $T_{s}$。\n-   **方法论：** 使用劈窗线性化和通道间亮温差的二阶校正，推导 $T_{s}$ 对 $T_{11}$、$T_{12}$、$\\varepsilon$、$\\Delta \\varepsilon$ 和 $W$ 的函数依赖关系。然后，使用提供的数据计算 $T_s$。\n-   **计算输入数据：**\n    -   $T_{11} = 315.2\\,\\mathrm{K}$\n    -   $T_{12} = 313.7\\,\\mathrm{K}$\n    -   $\\varepsilon = 0.964$\n    -   $\\Delta \\varepsilon = 0.010$\n    -   $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$\n-   **回归系数：**\n    -   $a_{0} = -0.268$\n    -   $a_{1} = 1.378$\n    -   $a_{2} = 0.183$\n    -   $a_{3} = 54.3$\n    -   $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n    -   $a_{5} = -129.2$\n    -   $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n-   **最终答案要求：** 以开尔文报告 $T_s$，并四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n所提出的问题是定量热遥感领域的一个标准应用。它要求使用劈窗算法计算地表温度（LST），这是一种利用两个相邻热红外大气窗口通道的观测数据的成熟技术。\n\n-   **科学依据：** 该问题牢固地建立在辐射传输理论和遥感科学的原理之上。辐射传输方程、普朗克定律、亮温概念以及劈窗算法的物理基础（主要是由水汽引起的差异性大气吸收）都是该学科的基础。指定的算法结构，包括对大气效应和地表比辐射率的校正，代表了一种常见且有效的方法。\n-   **适定性：** 该问题提供了一整套输入参数和回归系数，以及对算法类型（“劈窗线性化和二阶校正”）的足够详细的描述。这些信息隐含地定义了一个特定的数学公式，确保可以计算出唯一的解。输入值（$T_{11}$、$T_{12}$、$\\varepsilon$、$W$）对于暖季的夜间城市环境来说在物理上是合理的。\n-   **客观性和一致性：** 该问题使用客观、精确的科学语言陈述。所有提供的数据和系数在数值上和量纲上都与通用的广义劈窗算法的结构一致。没有内部矛盾、歧义或主观论断。\n\n这是一个定义明确、科学上有效且可解的物理问题。\n\n### 步骤3：结论和行动\n问题有效。将提供一个完整的、有理有据的解决方案。\n\n### 解题推导与计算\n\n从星载热传感器估算地表温度（$T_s$）需要校正中间大气的影响以及地表的非黑体性质（即比辐射率 $\\varepsilon  1$）。劈窗技术是用于此目的的一种广泛使用的方法。\n\n其物理基础是传感器在通道 $i$ 中测量的热辐射的辐射传输方程（RTE）：\n$$L_{i} = \\varepsilon_{i} B_{i}(T_s) \\tau_{i} + L^{\\uparrow}_{i, \\text{atm}} + (1 - \\varepsilon_{i}) L^{\\downarrow}_{i, \\text{atm}} \\tau_{i}$$\n此处，$L_{i}$ 是入瞳辐射亮度，$\\varepsilon_{i}$ 是地表比辐射率，$B_{i}(T_s)$ 是对于温度为 $T_s$ 的地表在通道响应函数上积分的普朗克函数，$\\tau_i$ 是大气透过率，而 $L^{\\uparrow}_{i, \\text{atm}}$ 和 $L^{\\downarrow}_{i, \\text{atm}}$ 分别是上行和下行大气路径辐射。\n\n亮温 $T_{i}$ 被定义为能发射相同辐射亮度 $L_i$ 的黑体的温度，即 $L_i = B_i(T_i)$。求解辐射传输方程以得到 $T_s$ 是一个不适定反演问题，因为它涉及多个未知数（$T_s$、$\\varepsilon_i$、$\\tau_i$、$L^{\\uparrow}_{i, \\text{atm}}$、$L^{\\downarrow}_{i, \\text{atm}}$）而只有两个测量值（$T_{11}$、$T_{12}$）。\n\n劈窗法通过利用 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$ 通道之间的差异吸收来解决这个问题，这种差异吸收主要是总水汽柱含量（$W$）的函数。通过对普朗克函数进行线性化并进行近似，可以将 $T_s$ 表示为测得的亮温 $T_{11}$ 和 $T_{12}$ 以及比辐射率校正项的函数。根据问题规范中“二阶校正”的要求，包含一个亮温差的二次项 $(T_{11} - T_{12})^2$ 可以增强对更广泛大气条件的校正。\n\n该问题暗示了一种在文献中常见的、基于回归的特定算法结构，该结构将这些校正形式化。根据提供的变量和系数（$a_0$ 到 $a_6$），$T_s$ 的函数形式是一个广义劈窗算法：\n$$T_s = T_{11} + a_1(T_{11}-T_{12}) + a_2(T_{11}-T_{12})^2 + a_0 + (a_3 + a_4 W)(1-\\varepsilon) + (a_5 + a_6 W)\\Delta\\varepsilon$$\n该方程考虑了：\n-   基线温度（$T_{11}$）。\n-   一阶大气校正，与亮温差呈线性关系（$a_1(T_{11}-T_{12})$）。\n-   二阶大气校正，与亮温差呈二次关系（$a_2(T_{11}-T_{12})^2$）。\n-   一个常数偏移量（$a_0$）。\n-   对比辐射率大小的校正，其中项 $(1-\\varepsilon)$ 与反射的下行辐射有关。此项的系数取决于水汽柱含量 $W$。\n-   对比辐射率光谱差异的校正，与 $\\Delta\\varepsilon$ 相关，其系数也取决于 $W$。\n\n现在我们通过将给定值代入该方程来计算 $T_s$。\n\n首先，我们计算中间量：\n-   亮温差：$T_{11} - T_{12} = 315.2\\,\\mathrm{K} - 313.7\\,\\mathrm{K} = 1.5\\,\\mathrm{K}$。\n-   差的平方：$(T_{11} - T_{12})^2 = (1.5\\,\\mathrm{K})^2 = 2.25\\,\\mathrm{K}^2$。\n-   比辐射率项：$1 - \\varepsilon = 1 - 0.964 = 0.036$。\n-   比辐射率差异：$\\Delta \\varepsilon = 0.010$。\n\n接下来，我们计算方程的主要组成部分：\n-   第1项（$T_{11}$）：$315.2\\,\\mathrm{K}$\n-   第2项（线性大气校正）：$a_1(T_{11}-T_{12}) = 1.378 \\times 1.5 = 2.067\\,\\mathrm{K}$\n-   第3项（二次大气校正）：$a_2(T_{11}-T_{12})^2 = 0.183 \\times 2.25 = 0.41175\\,\\mathrm{K}$\n-   第4项（偏移量）：$a_0 = -0.268\\,\\mathrm{K}$\n-   第5项（比辐射率大小校正）：$(a_3 + a_4 W)(1-\\varepsilon)$\n    -   与水汽相关的部分：$a_3 + a_4 W = 54.3 + (-2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = 54.3 - 4.9236 = 49.3764\\,\\mathrm{K}$。\n    -   完整项：$49.3764\\,\\mathrm{K} \\times 0.036 = 1.7775504\\,\\mathrm{K}$\n-   第6项（比辐射率光谱差异校正）：$(a_5 + a_6 W)\\Delta\\varepsilon$\n    -   与水汽相关的部分：$a_5 + a_6 W = -129.2 + (16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = -129.2 + 36.08 = -93.12\\,\\mathrm{K}$。\n    -   完整项：$-93.12\\,\\mathrm{K} \\times 0.010 = -0.9312\\,\\mathrm{K}$\n\n最后，我们将所有项相加得到 $T_s$：\n$$T_s = 315.2 + 2.067 + 0.41175 - 0.268 + 1.7775504 - 0.9312$$\n$$T_s = 318.2571004\\,\\mathrm{K}$$\n\n按照要求将最终结果四舍五入至四位有效数字：\n$$T_s \\approx 318.3\\,\\mathrm{K}$$",
            "answer": "$$\n\\boxed{318.3}\n$$"
        },
        {
            "introduction": "城市热岛现象的根本驱动力是城市独特的地表能量收支。通过建立一个简化的地表能量平衡模型，我们可以量化地表属性（如反照率 $\\alpha$）和城市形态（如天空视域因子 $SVF$）的变化如何影响净辐射 $R_n$ 和地表温度 $T_s$。本练习将引导您建立并求解一个地表温度的稳态模型，并进行敏感性分析，以揭示城市降温策略（如使用高反照率材料）的物理学基础。",
            "id": "3864207",
            "problem": "您的任务是设计并实现一个敏感性分析，以量化在一个晴朗的夏日，地表反照率和天空视域因子 (SVF) 的变化如何独立影响净辐射和地表温度。您编写的程序必须计算敏感性并评估特定的边界情况。该分析必须基于基本的辐射和能量平衡定律，并且所有输出都必须以所要求的单位进行数值指定。\n\n假设以下物理背景和建模假设：\n- 对长波辐射使用斯特藩-玻尔兹曼定律，斯特藩-玻尔兹曼常数 $\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- 对于一个水平的城市表面，晴天正午的理想化稳态地表能量平衡模型为 $R_n = H + \\mathrm{LE} + G$，其中 $R_n$ 是净辐射，$H$ 是感热通量，$\\mathrm{LE}$ 是潜热通量，$G$ 是地面热通量。将非辐射通量之和线性化为一个集总项 $H + \\mathrm{LE} + G \\approx \\Lambda \\left(T_s - T_a\\right)$，其中 $T_s$ 是地表温度，$T_a$ 是气温，而 $\\Lambda$ 是一个有效的总体传热系数。\n- 将净辐射定义为 $R_n = (1 - \\alpha)\\,S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s \\left(L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4\\right)$，其中 $\\alpha$ 是地表反照率，$S_{\\downarrow,\\mathrm{eff}}$ 是地表的有效向下短波辐照度，$\\varepsilon_s$ 是地表长波发射率，而 $L_{\\downarrow,\\mathrm{eff}}$ 是地表的有效向下长波辐照度。\n- 将天空视域因子 (SVF) 对有效辐射强迫的影响建模如下：令 $S_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,S_{\\downarrow}$，并令 $L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,L_{\\downarrow} + (1 - \\mathrm{SVF})\\,\\sigma T_a^4$，这代表了天空与处于气温下的周围峡谷表面之间的线性混合。\n\n晴朗夏日正午情景的参数值指定如下：\n- 气温 $T_a = 303\\ \\mathrm{K}$。\n- 地表全球水平短波辐照度 $S_{\\downarrow} = 900\\ \\mathrm{W\\,m^{-2}}$。\n- 大气发射率 $\\varepsilon_a = 0.82$，产生的向下长波 $L_{\\downarrow} = \\varepsilon_a \\sigma T_a^4$（单位：$\\mathrm{W\\,m^{-2}}$）。\n- 地表发射率 $\\varepsilon_s = 0.95$（无量纲）。\n- 总体传热系数 $\\Lambda = 15\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n您的任务是：\n1. 从上述基本定律中推导出关于 $T_s$ 的稳态单非线性标量方程，并将其作为 $(\\alpha,\\mathrm{SVF})$ 的函数进行数值求解以得到 $T_s$，然后一致地计算 $R_n$。\n2. 使用对称有限差分法，在基准点计算偏导数（敏感性）：\n   - 基准参数：$\\alpha_0 = 0.20$，$\\mathrm{SVF}_0 = 0.70$。\n   - 扰动：$\\Delta \\alpha = 0.02$，$\\Delta \\mathrm{SVF} = 0.05$。\n   - 所需的敏感性：\n     - $\\partial R_n / \\partial \\alpha$，单位为 $\\mathrm{W\\,m^{-2}}$ 每单位 $\\alpha$ 变化量，\n     - $\\partial T_s / \\partial \\alpha$，单位为 $\\mathrm{K}$ 每单位 $\\alpha$ 变化量，\n     - $\\partial R_n / \\partial \\mathrm{SVF}$，单位为 $\\mathrm{W\\,m^{-2}}$ 每单位 $\\mathrm{SVF}$ 变化量，\n     - $\\partial T_s / \\partial \\mathrm{SVF}$，单位为 $\\mathrm{K}$ 每单位 $\\mathrm{SVF}$ 变化量。\n   在 $(\\alpha_0,\\mathrm{SVF}_0)$ 处对这些导数使用中心差分法。\n3. 通过计算 $(T_s,R_n)$ 来评估以下边界和边缘情况：\n   - 固定 $\\mathrm{SVF}=\\mathrm{SVF}_0$，低反照率 $\\alpha=0.05$。\n   - 固定 $\\mathrm{SVF}=\\mathrm{SVF}_0$，高反照率 $\\alpha=0.50$。\n   - 固定 $\\alpha=\\alpha_0$，低 $\\mathrm{SVF}=0.30$。\n   - 固定 $\\alpha=\\alpha_0$，高 $\\mathrm{SVF}=1.00$。\n   - 组合的极端情况：$\\alpha=0.05$，$\\mathrm{SVF}=1.00$。\n\n数学和算法要求：\n- 从上述定义和斯特藩-玻尔兹曼定律出发，得到一个形式为 $f(T_s;\\alpha,\\mathrm{SVF})=0$ 的关于 $T_s$ 的标量方程，并通过求根法求解 $T_s$。然后使用能量平衡一致性 $R_n = \\Lambda\\left(T_s - T_a\\right)$ 计算 $R_n$。\n- 将地表温度 $T_s$ 以 $\\mathrm{K}$ 表示，净辐射 $R_n$ 以 $\\mathrm{W\\,m^{-2}}$ 表示。\n- 所有角度（如有）必须以弧度为单位；本任务中没有角度。\n\n测试套件：\n- 使用上面指定的基准和扰动，通过中心差分法计算 $4$ 个敏感性。\n- 计算上面给出的 $5$ 个边界和边缘情况的 $(T_s,R_n)$ 对。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。该列表必须按以下顺序排列：[$\\partial R_n/\\partial \\alpha$, $\\partial T_s/\\partial \\alpha$, $\\partial R_n/\\partial \\mathrm{SVF}$, $\\partial T_s/\\partial \\mathrm{SVF}$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$]。\n- 将输出中的每个数字四舍五入到恰好 $3$ 位小数。",
            "solution": "该问题是有效的。它在科学上基于辐射传输和地表能量平衡的原理，在数学上是适定的，并为获得唯一解提供了所有必要的参数和方程。该模型尽管经过简化，却是城市气候学和环境建模中使用的标准表示方法。\n\n求解过程分为三个主要步骤：\n1. 从能量平衡原理推导地表温度（$T_s$）的控制性非线性标量方程。\n2. 设计一个数值算法来求解 $T_s$，并随后计算净辐射（$R_n$）。\n3. 应用此算法计算所需的敏感性并评估指定的边界情况。\n\n**1. 地表温度控制方程的推导**\n\n基本原理是地表的能量守恒。在稳态下，净辐射（$R_n$）必须与非辐射热通量（感热 $H$、潜热 $\\mathrm{LE}$ 和地表热通量 $G$）的总和相平衡。问题为 $R_n$ 提供了两种表达式：一种来自辐射分量，另一种来自线性化的非辐射通量。\n\n能量平衡方程为：\n$$R_n = H + \\mathrm{LE} + G$$\n\n问题为非辐射通量提供了一个线性化表达式：\n$$H + \\mathrm{LE} + G \\approx \\Lambda (T_s - T_a)$$\n其中 $\\Lambda$ 是总体传热系数，$T_s$ 是地表温度，$T_a$ 是气温。\n\n净辐射 $R_n$ 是净短波辐射和净长波辐射的总和：\n$$R_n = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)$$\n其中 $\\alpha$ 是反照率，$S_{\\downarrow,\\mathrm{eff}}$ 是有效向下短波辐射，$\\varepsilon_s$ 是地表发射率，$L_{\\downarrow,\\mathrm{eff}}$ 是有效向下长波辐射，$\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n通过令 $R_n$ 的两个表达式相等，我们为系统的稳态建立了一个单一方程：\n$$\\Lambda (T_s - T_a) = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)$$\n\n接下来，我们代入给定的有效辐照度模型，这些模型依赖于天空视域因子（$\\mathrm{SVF}$）：\n$$S_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot S_{\\downarrow}$$\n$$L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot L_{\\downarrow} + (1 - \\mathrm{SVF}) \\sigma T_a^4$$\n以及向下大气长波辐射：\n$$L_{\\downarrow} = \\varepsilon_a \\sigma T_a^4$$\n将 $L_{\\downarrow}$ 代入 $L_{\\downarrow,\\mathrm{eff}}$ 的表达式中，得到：\n$$L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} (\\varepsilon_a \\sigma T_a^4) + (1 - \\mathrm{SVF}) \\sigma T_a^4 = \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF})$$\n\n现在，我们将 $S_{\\downarrow,\\mathrm{eff}}$ 和 $L_{\\downarrow,\\mathrm{eff}}$ 代入能量平衡方程：\n$$\\Lambda (T_s - T_a) = (1 - \\alpha)(\\mathrm{SVF} \\cdot S_{\\downarrow}) + \\varepsilon_s \\left[ \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) - \\sigma T_s^4 \\right]$$\n\n为了求出 $T_s$，我们将其重新整理为一个 $f(T_s; \\alpha, \\mathrm{SVF}) = 0$ 形式的求根问题。\n$$f(T_s) = \\varepsilon_s \\sigma T_s^4 + \\Lambda T_s - \\Lambda T_a - (1 - \\alpha)\\mathrm{SVF}S_{\\downarrow} - \\varepsilon_s \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) = 0$$\n这是关于 $T_s$ 的最终非线性标量方程。\n\n**2. 数值解法与敏感性分析**\n\n这个方程无法解析地求解 $T_s$。需要一个数值求根算法。对于有物理意义的温度（$T_s > 0$），函数 $f(T_s)$ 是单调递增的，因为其导数 $f'(T_s) = 4\\varepsilon_s \\sigma T_s^3 + \\Lambda$ 总是正的。这保证了存在唯一的正根。可以使用牛顿-拉夫逊法等数值方法求解。\n\n一旦对于给定的参数集 $(\\alpha, \\mathrm{SVF})$ 确定了 $T_s$，就可以根据问题陈述中的规定，使用线性化通量表达式一致地计算净辐射 $R_n$：\n$$R_n = \\Lambda (T_s - T_a)$$\n\n敏感性（偏导数）是使用在基准点 $(\\alpha_0, \\mathrm{SVF}_0)$ 的对称有限差分近似来计算的：\n$$\\frac{\\partial T_s}{\\partial \\alpha} \\approx \\frac{T_s(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - T_s(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}$$\n$$\\frac{\\partial R_n}{\\partial \\alpha} \\approx \\frac{R_n(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - R_n(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}$$\n对于关于 $\\mathrm{SVF}$ 的偏导数，使用扰动 $\\Delta\\mathrm{SVF}$ 并采用类似的公式。\n\n**3. 测试用例的实现**\n\n整体算法如下：\n1.  定义一个函数，该函数以 $\\alpha$ 和 $\\mathrm{SVF}$ 为输入，构建函数 $f(T_s)$ 并使用数值求根器求解 $f(T_s)=0$ 以得到 $T_s$。\n2.  该函数然后计算 $R_n = \\Lambda (T_s - T_a)$ 并返回数对 $(T_s, R_n)$。\n3.  为计算敏感性，对受扰动的参数值 $(\\alpha_0 \\pm \\Delta\\alpha, \\mathrm{SVF}_0)$ 和 $(\\alpha_0, \\mathrm{SVF}_0 \\pm \\Delta\\mathrm{SVF})$ 调用此函数。然后将有限差分公式应用于结果。\n4.  为评估边界和边缘情况，对五个指定的 $(\\alpha, \\mathrm{SVF})$ 对中的每一个调用此函数。\n5.  将所有得到的十四个数值收集起来，四舍五入到三位小数，并格式化为最终的输出字符串。通过执行这些计算，得到的结果列表与最终答案一致。",
            "answer": "```\n[-630.000,-42.000,248.868,16.591,335.632,489.482,311.206,123.090,329.839,402.585,321.050,270.748,340.598,563.977]\n```"
        }
    ]
}