{
    "hands_on_practices": [
        {
            "introduction": "The journey from a satellite image to scientific insight begins with converting raw sensor signals into meaningful physical quantities. This exercise focuses on the foundational step of radiometric calibration, transforming a sensor's digital number (DN) into at-sensor radiance. You will also practice propagating the uncertainty from the calibration process into the final brightness temperature, a critical skill for any quantitative analysis in remote sensing. ",
            "id": "3864235",
            "problem": "A thermal infrared imaging spectrometer aboard a polar-orbiting satellite is used to study the Urban Heat Island (UHI) over a megacity. For a nadir-view pixel in the 10.8 micrometer band, the sensor outputs a Digital Number (DN) of $700$. The radiometric calibration for converting DN to at-sensor spectral radiance (per micrometer) is modeled as linear: $L_{\\mu\\mathrm{m}} = a \\, \\mathrm{DN} + b$, where $L_{\\mu\\mathrm{m}}$ is in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$. The calibration coefficients are characterized by uncertainties: $a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$ with standard deviation $\\sigma_{a} = 1.00 \\times 10^{-4} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$, and $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$ with standard deviation $\\sigma_{b} = 0.05 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$. The calibration errors of $a$ and $b$ have correlation coefficient $\\rho_{ab} = -0.3$.\n\nAssume the band is sufficiently narrow that the at-sensor spectral radiance at the band center wavelength $\\lambda = 10.8 \\ \\mu\\mathrm{m}$ can be treated as monochromatic. Define the brightness temperature $T_{b}$ as the temperature of an ideal blackbody that would produce the same at-sensor spectral radiance at wavelength $\\lambda$, i.e., $L_{\\lambda} = B(\\lambda, T_{b})$, where $B(\\lambda, T)$ is the Planck spectral radiance given by\n$$\nB(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwith Planck constant $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J}\\,\\mathrm{s}$, speed of light $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, and Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J}\\,\\mathrm{K}^{-1}$. Note that $L_{\\mu\\mathrm{m}}$ must be converted to $L_{\\lambda}$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ before using the Planck relation.\n\nStarting from these fundamentals and treating calibration uncertainties as Gaussian, derive the conversion from DN to at-sensor spectral radiance and propagate the calibration uncertainty into the standard deviation of the brightness temperature $\\sigma_{T_{b}}$ using first-order uncertainty propagation, including the covariance between $a$ and $b$. Compute the numerical value of $\\sigma_{T_{b}}$ for the given pixel, and:\n\n- Express the final standard deviation in Kelvin.\n- Round your answer to three significant figures.",
            "solution": "The user wants to find the standard deviation of the brightness temperature, $\\sigma_{T_b}$, by propagating the uncertainties from the radiometric calibration coefficients of a thermal infrared sensor.\n\nThe problem is deemed valid as it is scientifically grounded in the principles of blackbody radiation and measurement uncertainty analysis, is well-posed with all necessary information provided, and is formulated objectively. The requested calculation is a standard procedure in quantitative remote sensing.\n\nThe overall analysis proceeds in four stages:\n1.  Calculation of the at-sensor spectral radiance, $L_{\\lambda}$, and its uncertainty, $\\sigma_{L_{\\lambda}}$.\n2.  Inversion of the Planck function to determine the brightness temperature, $T_b$.\n3.  Derivation of the sensitivity of the brightness temperature to the at-sensor radiance, $\\frac{dT_b}{dL_{\\lambda}}$.\n4.  Combination of the radiance uncertainty and the temperature sensitivity to compute the final brightness temperature uncertainty, $\\sigma_{T_b}$.\n\n**1. At-Sensor Spectral Radiance and its Uncertainty**\n\nThe problem provides a linear calibration model to convert the sensor's Digital Number ($\\mathrm{DN}$) to at-sensor spectral radiance, $L_{\\mu\\mathrm{m}}$, in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$:\n$$L_{\\mu\\mathrm{m}} = a \\cdot \\mathrm{DN} + b$$\nGiven $\\mathrm{DN} = 700$, $a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$, and $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$, the nominal radiance is:\n$$L_{\\mu\\mathrm{m}} = (0.012) \\cdot (700) + 1.20 = 8.40 + 1.20 = 9.60 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$$\nThe Planck function is given in terms of spectral radiance per unit wavelength in meters ($L_{\\lambda}$). We must convert $L_{\\mu\\mathrm{m}}$ to $L_{\\lambda}$, which is in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$. The conversion factor is $10^6 \\ \\mu\\mathrm{m}/\\mathrm{m}$.\n$$L_{\\lambda} = L_{\\mu\\mathrm{m}} \\times 10^6 = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\nThe general expression for $L_{\\lambda}$ as a function of the calibration coefficients is:\n$$L_{\\lambda}(a, b) = (a \\cdot \\mathrm{DN} + b) \\times 10^6$$\nTo find the uncertainty in $L_{\\lambda}$, we use the first-order Taylor series expansion for uncertainty propagation. The variance of $L_{\\lambda}$, denoted $\\sigma_{L_{\\lambda}}^2$, is given by:\n$$\\sigma_{L_{\\lambda}}^2 = \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right)^2 \\sigma_b^2 + 2 \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right) \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right) \\sigma_{ab}$$\nwhere $\\sigma_{ab} = \\rho_{ab} \\sigma_a \\sigma_b$ is the covariance between $a$ and $b$. The partial derivatives are:\n$$\\frac{\\partial L_{\\lambda}}{\\partial a} = \\mathrm{DN} \\times 10^6$$\n$$\\frac{\\partial L_{\\lambda}}{\\partial b} = 1 \\times 10^6$$\nSubstituting these into the variance equation:\n$$\\sigma_{L_{\\lambda}}^2 = (\\mathrm{DN} \\times 10^6)^2 \\sigma_a^2 + (10^6)^2 \\sigma_b^2 + 2 (\\mathrm{DN} \\times 10^6)(10^6) \\rho_{ab} \\sigma_a \\sigma_b$$\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\left[ (\\mathrm{DN} \\cdot \\sigma_a)^2 + \\sigma_b^2 + 2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b \\right]$$\nWe are given the values: $\\mathrm{DN} = 700$, $\\sigma_a = 1.00 \\times 10^{-4}$, $\\sigma_b = 0.05$, and $\\rho_{ab} = -0.3$. Let's compute the terms in the bracket:\n$$(\\mathrm{DN} \\cdot \\sigma_a)^2 = (700 \\cdot 1.00 \\times 10^{-4})^2 = (0.07)^2 = 0.0049$$\n$$\\sigma_b^2 = (0.05)^2 = 0.0025$$\n$$2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b = 2 \\cdot (700) \\cdot (-0.3) \\cdot (1.00 \\times 10^{-4}) \\cdot (0.05) = -0.0021$$\nThe term in the bracket, which is the variance of $L_{\\mu\\mathrm{m}}$, is:\n$$\\sigma_{L_{\\mu\\mathrm{m}}}^2 = 0.0049 + 0.0025 - 0.0021 = 0.0053 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1})^2$$\nThe variance of $L_{\\lambda}$ is then:\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\cdot 0.0053 = 5.3 \\times 10^9 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^2$$\nThe standard deviation of the radiance is:\n$$\\sigma_{L_{\\lambda}} = \\sqrt{5.3 \\times 10^9} \\approx 72801.1 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n\n**2. Calculation of Brightness Temperature, $T_b$**\n\nThe brightness temperature $T_b$ is found by inverting the Planck function, $L_{\\lambda} = B(\\lambda, T_b)$:\n$$L_{\\lambda} = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T_b}\\right) - 1}$$\nLet $c_1 = 2hc^2$ and $c_2 = hc/k_B$. The equation becomes $L_{\\lambda} = \\frac{c_1}{\\lambda^5} (\\exp(\\frac{c_2}{\\lambda T_b}) - 1)^{-1}$.\nSolving for $T_b$:\n$$\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) = \\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1$$\n$$T_b = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1\\right)}$$\nUsing the given physical constants:\n$c_1 = 2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)^2 \\approx 1.19104297 \\times 10^{-16} \\ \\mathrm{W}\\,\\mathrm{m}^2\\,\\mathrm{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} \\approx 0.01438777 \\ \\mathrm{m}\\,\\mathrm{K}$\nWith $\\lambda = 10.8 \\ \\mu\\mathrm{m} = 10.8 \\times 10^{-6} \\ \\mathrm{m}$ and $L_{\\lambda} = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$:\n$$\\frac{c_1}{\\lambda^5 L_{\\lambda}} = \\frac{1.191043 \\times 10^{-16}}{(10.8 \\times 10^{-6})^5 \\cdot (9.60 \\times 10^6)} \\approx \\frac{1.191043 \\times 10^{-16}}{1.411281 \\times 10^{-18}} \\approx 84.3946$$\n$$T_b = \\frac{0.01438777}{(10.8 \\times 10^{-6}) \\ln(84.3946 + 1)} \\approx \\frac{0.01438777}{(10.8 \\times 10^{-6}) (4.44723)} \\approx 299.56 \\ \\mathrm{K}$$\n\n**3. Sensitivity of Temperature to Radiance, $\\frac{dT_b}{dL_{\\lambda}}$**\n\nThe uncertainty in $T_b$ due to the uncertainty in $L_{\\lambda}$ is given by $\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$. We need to compute the derivative $\\frac{dT_b}{dL_{\\lambda}}$. It is most convenient to find its reciprocal, $\\frac{dL_{\\lambda}}{dT_b}$, by differentiating the Planck function with respect to temperature.\n$$\\frac{dL_{\\lambda}}{dT_b} = \\frac{\\partial B(\\lambda,T)}{\\partial T} \\bigg|_{T=T_b}$$\n$$\\frac{\\partial B}{\\partial T} = \\frac{c_1}{\\lambda^5} (-1) \\left(\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1\\right)^{-2} \\exp\\left(\\frac{c_2}{\\lambda T}\\right) \\left(-\\frac{c_2}{\\lambda T^2}\\right)$$\nThis expression can be simplified by factoring out the original Planck function $B(\\lambda, T)$:\n$$\\frac{\\partial B}{\\partial T} = B(\\lambda, T) \\cdot \\frac{c_2}{\\lambda T^2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1}$$\nTherefore, the derivative $\\frac{dT_b}{dL_{\\lambda}}$ is:\n$$\\frac{dT_b}{dL_{\\lambda}} = \\left( \\frac{dL_{\\lambda}}{dT_b} \\right)^{-1} = \\frac{1}{L_{\\lambda}} \\cdot \\frac{\\lambda T_b^2}{c_2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) - 1}{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right)} = \\frac{\\lambda T_b^2}{c_2 L_{\\lambda}} \\left(1 - \\exp\\left(-\\frac{c_2}{\\lambda T_b}\\right)\\right)$$\nWe have already calculated the argument of the exponential: $\\frac{c_2}{\\lambda T_b} \\approx 4.44723$.\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{(10.8 \\times 10^{-6}) (299.56)^2}{(0.01438777)(9.60 \\times 10^6)} \\left(1 - \\exp(-4.44723)\\right)$$\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{0.96910}{138122.6} (1 - 0.01171) \\approx (7.0163 \\times 10^{-6})(0.98829) \\approx 6.9344 \\times 10^{-6} \\ \\mathrm{K} \\cdot (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^{-1}$$\n\n**4. Final Brightness Temperature Uncertainty, $\\sigma_{T_b}$**\n\nFinally, we combine the results. The uncertainty in brightness temperature is the product of the radiance sensitivity and the standard deviation of the radiance:\n$$\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$$\n$$\\sigma_{T_b} \\approx (6.9344 \\times 10^{-6}) \\cdot (72801.1) \\approx 0.50484 \\ \\mathrm{K}$$\nThe problem asks for the answer to be rounded to three significant figures.\n$$\\sigma_{T_b} \\approx 0.505 \\ \\mathrm{K}$$",
            "answer": "$$\n\\boxed{0.505}\n$$"
        },
        {
            "introduction": "The brightness temperature measured by a satellite is not the true temperature of the ground; it's a value altered by the atmosphere and the surface's specific emissive properties. This practice demonstrates how to correct for these effects using a generalized split-window algorithm, a cornerstone of thermal remote sensing. By applying this technique, you will retrieve the Land Surface Temperature ($T_s$), the primary variable used to quantify the urban heat island effect from space. ",
            "id": "3864213",
            "problem": "A nocturnal urban heat island retrieval over a dense urban core is performed using thermal infrared observations from a polar-orbiting sensor with two atmospheric window channels centered at $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$. Let $T_{11}$ and $T_{12}$ denote the top-of-atmosphere brightness temperatures in kelvin for the $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels, respectively. The urban surface is assumed isothermal within the pixel and Lambertian in the thermal domain, with known mean emissivity $\\varepsilon$ and emissivity difference $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$. The atmospheric state is summarized by the total column water vapor $W$ in $\\mathrm{g}\\,\\mathrm{cm}^{-2}$. The goal is to estimate the land surface temperature $T_{s}$ for this urban pixel, as part of an urban heat island analysis workflow.\n\nStarting from the thermal infrared radiative transfer equation for upwelling radiance at the top of the atmosphere and the definition of brightness temperature as the inverse Planck function applied to radiance, derive the functional dependence of $T_{s}$ on $T_{11}$, $T_{12}$, $\\varepsilon$, $\\Delta \\varepsilon$, and $W$ under a split-window linearization and second-order correction in the inter-channel brightness temperature difference. Then, using the provided regression coefficients that encapsulate sensor spectral response and representative mid-latitude atmospheric transmittance behavior, evaluate $T_{s}$ for the specific scene described below.\n\nUse the following inputs for the urban pixel:\n- $T_{11} = 315.2\\,\\mathrm{K}$,\n- $T_{12} = 313.7\\,\\mathrm{K}$,\n- $\\varepsilon = 0.964$,\n- $\\Delta \\varepsilon = 0.010$,\n- $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$.\n\nAdopt the following split-window regression coefficients (dimensionless unless otherwise noted), calibrated for a sensor with $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels under mid-latitude summer atmospheres:\n- $a_{0} = -0.268$,\n- $a_{1} = 1.378$,\n- $a_{2} = 0.183$,\n- $a_{3} = 54.3$,\n- $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$,\n- $a_{5} = -129.2$,\n- $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$.\n\nCompute and report the land surface temperature $T_{s}$ for this pixel. Express the final answer in kelvin and round your answer to four significant figures.",
            "solution": "The user wants to solve a thermal remote sensing problem.\n\n### Step 1: Extract Givens\n-   **Sensor Channels:** $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$.\n-   **Top-of-Atmosphere Brightness Temperatures:** $T_{11}$ and $T_{12}$.\n-   **Surface Properties:** Mean emissivity $\\varepsilon$, emissivity difference $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$.\n-   **Atmospheric State:** Total column water vapor $W$.\n-   **Objective:** Estimate land surface temperature $T_{s}$.\n-   **Methodology:** Derive the functional dependence of $T_{s}$ on $T_{11}$, $T_{12}$, $\\varepsilon$, $\\Delta \\varepsilon$, and $W$ using a split-window linearization and second-order correction in the inter-channel brightness temperature difference. Then, evaluate $T_s$ using provided data.\n-   **Input Data for Calculation:**\n    -   $T_{11} = 315.2\\,\\mathrm{K}$\n    -   $T_{12} = 313.7\\,\\mathrm{K}$\n    -   $\\varepsilon = 0.964$\n    -   $\\Delta \\varepsilon = 0.010$\n    -   $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$\n-   **Regression Coefficients:**\n    -   $a_{0} = -0.268$\n    -   $a_{1} = 1.378$\n    -   $a_{2} = 0.183$\n    -   $a_{3} = 54.3$\n    -   $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n    -   $a_{5} = -129.2$\n    -   $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n-   **Final Answer Requirement:** Report $T_s$ in kelvin, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard application in the field of quantitative thermal remote sensing. It asks for the calculation of Land Surface Temperature (LST) using a split-window algorithm, a well-established technique that utilizes observations in two adjacent thermal infrared atmospheric window channels.\n\n-   **Scientific Grounding:** The problem is firmly grounded in the principles of radiative transfer theory and remote sensing science. The radiative transfer equation, Planck's law, the concept of brightness temperature, and the physical basis for split-window algorithms (differential atmospheric absorption, primarily by water vapor) are all fundamental to the discipline. The specified algorithm structure, including corrections for atmospheric effects and surface emissivity, represents a common and valid approach.\n-   **Well-Posedness:** The problem provides a complete set of input parameters and regression coefficients, along with a sufficiently detailed description of the algorithm type (\"split-window linearization and second-order correction\"). This information implicitly defines a specific mathematical formula, ensuring a unique solution can be calculated. The values of the inputs ($T_{11}$, $T_{12}$, $\\varepsilon$, $W$) are physically plausible for a nocturnal urban environment during a warm season.\n-   **Objectivity and Consistency:** The problem is stated using objective, precise scientific language. All provided data and coefficients are numerically and dimensionally consistent with the structure of common generalized split-window algorithms. There are no internal contradictions, ambiguities, or subjective claims.\n\nThe problem is a well-defined, scientifically valid, and solvable physics problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation and Calculation\n\nThe estimation of Land Surface Temperature ($T_s$) from spaceborne thermal sensors requires correcting for the effects of the intervening atmosphere and the non-blackbody nature of the surface (i.e., emissivity $\\varepsilon < 1$). The split-window technique is a widely used method for this purpose.\n\nThe physical basis is the radiative transfer equation (RTE) for thermal radiation measured by a sensor in channel $i$:\n$$L_{i} = \\varepsilon_{i} B_{i}(T_s) \\tau_{i} + L^{\\uparrow}_{i, \\text{atm}} + (1 - \\varepsilon_{i}) L^{\\downarrow}_{i, \\text{atm}} \\tau_{i}$$\nHere, $L_{i}$ is the at-sensor radiance, $\\varepsilon_{i}$ is the surface emissivity, $B_{i}(T_s)$ is the Planck function integrated over the channel's response for a surface at temperature $T_s$, $\\tau_i$ is the atmospheric transmittance, and $L^{\\uparrow}_{i, \\text{atm}}$ and $L^{\\downarrow}_{i, \\text{atm}}$ are the upwelling and downwelling atmospheric path radiances, respectively.\n\nThe brightness temperature $T_{i}$ is defined as the temperature of a blackbody that would emit the same radiance $L_i$, i.e., $L_i = B_i(T_i)$. Solving the RTE for $T_s$ is an ill-posed inverse problem because it involves multiple unknowns ($T_s$, $\\varepsilon_i$, $\\tau_i$, $L^{\\uparrow}_{i, \\text{atm}}$, $L^{\\downarrow}_{i, \\text{atm}}$) and only two measurements ($T_{11}$, $T_{12}$).\n\nThe split-window approach overcomes this by exploiting the differential absorption between the $11\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$ channels, which is primarily a function of the total column water vapor ($W$). By linearizing the Planck function and making approximations, one can express $T_s$ as a function of the measured brightness temperatures $T_{11}$ and $T_{12}$, and corrections for emissivity. The inclusion of a term quadratic in the brightness temperature difference, $(T_{11} - T_{12})^2$, enhances the correction for a wider range of atmospheric conditions, as requested by the problem's specification of a \"second-order correction\".\n\nThe problem implies a specific regression-based algorithm structure, common in the literature, which formalizes these corrections. Based on the provided variables and coefficients ($a_0$ through $a_6$), the functional form for $T_s$ is a generalized split-window algorithm:\n$$T_s = T_{11} + a_1(T_{11}-T_{12}) + a_2(T_{11}-T_{12})^2 + a_0 + (a_3 + a_4 W)(1-\\varepsilon) + (a_5 + a_6 W)\\Delta\\varepsilon$$\nThis equation accounts for:\n-   A baseline temperature ($T_{11}$).\n-   A first-order atmospheric correction, linear in the brightness temperature difference ($a_1(T_{11}-T_{12})$).\n-   A second-order atmospheric correction, quadratic in the difference ($a_2(T_{11}-T_{12})^2$).\n-   A constant offset ($a_0$).\n-   A correction for emissivity magnitude, where the term $(1-\\varepsilon)$ is related to reflected downwelling radiance. The coefficient for this term depends on column water vapor $W$.\n-   A correction for the spectral contrast in emissivity, related to $\\Delta\\varepsilon$, whose coefficient also depends on $W$.\n\nWe now proceed to calculate $T_s$ by substituting the given values into this equation.\n\nFirst, we calculate the intermediate quantities:\n-   Brightness temperature difference: $T_{11} - T_{12} = 315.2\\,\\mathrm{K} - 313.7\\,\\mathrm{K} = 1.5\\,\\mathrm{K}$.\n-   Squared difference: $(T_{11} - T_{12})^2 = (1.5\\,\\mathrm{K})^2 = 2.25\\,\\mathrm{K}^2$.\n-   Emissivity term: $1 - \\varepsilon = 1 - 0.964 = 0.036$.\n-   Emissivity difference: $\\Delta \\varepsilon = 0.010$.\n\nNext, we calculate the main components of the equation:\n-   Term 1 ($T_{11}$): $315.2\\,\\mathrm{K}$\n-   Term 2 (Linear atmospheric correction): $a_1(T_{11}-T_{12}) = 1.378 \\times 1.5 = 2.067\\,\\mathrm{K}$\n-   Term 3 (Quadratic atmospheric correction): $a_2(T_{11}-T_{12})^2 = 0.183 \\times 2.25 = 0.41175\\,\\mathrm{K}$\n-   Term 4 (Offset): $a_0 = -0.268\\,\\mathrm{K}$\n-   Term 5 (Emissivity magnitude correction): $(a_3 + a_4 W)(1-\\varepsilon)$\n    -   Water vapor dependent part: $a_3 + a_4 W = 54.3 + (-2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = 54.3 - 4.9236 = 49.3764$. The problem statement implies the units of $a_3$ and $a_5$ should be kelvin for dimensional consistency, so this term has units of kelvin.\n    -   Full term: $49.3764\\,\\mathrm{K} \\times 0.036 = 1.7775504\\,\\mathrm{K}$\n-   Term 6 (Emissivity spectral contrast correction): $(a_5 + a_6 W)\\Delta\\varepsilon$\n    -   Water vapor dependent part: $a_5 + a_6 W = -129.2 + (16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = -129.2 + 36.08 = -93.12$. This term has units of kelvin.\n    -   Full term: $-93.12\\,\\mathrm{K} \\times 0.010 = -0.9312\\,\\mathrm{K}$\n\nFinally, we sum all the terms to find $T_s$:\n$$T_s = 315.2 + 2.067 + 0.41175 - 0.268 + 1.7775504 - 0.9312$$\n$$T_s = 318.2571004\\,\\mathrm{K}$$\n\nRounding the final result to four significant figures as requested:\n$$T_s \\approx 318.3\\,\\mathrm{K}$$",
            "answer": "$$\n\\boxed{318.3}\n$$"
        },
        {
            "introduction": "Once we have an accurate map of Land Surface Temperature ($T_s$), we can begin to ask *why* certain areas are hotter than others. This practice delves into the physics of the urban surface energy balance to explore the relationship between urban form and temperature. You will conduct a sensitivity analysis to quantify how modifications to surface albedo and urban canyon geometry (via the Sky View Factor) directly influence the net radiation and resulting surface temperature, providing a quantitative basis for evaluating UHI mitigation strategies. ",
            "id": "3864207",
            "problem": "You are tasked with designing and implementing a sensitivity analysis to quantify how changes in surface albedo and Sky View Factor (SVF) independently affect net radiation and surface temperature for a clear-sky summer day. The program you write must compute sensitivities and evaluate specific boundary cases. The analysis must be based on fundamental radiative and energy balance laws, and all outputs must be numerically specified in the units requested.\n\nAssume the following physical context and modeling assumptions:\n- Use the Stefan–Boltzmann law for longwave radiation, with the Stefan–Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- For a horizontal urban surface, idealized steady-state surface energy balance on a clear-sky midday is modeled as $R_n = H + \\mathrm{LE} + G$, where $R_n$ is net radiation, $H$ is sensible heat flux, $\\mathrm{LE}$ is latent heat flux, and $G$ is ground heat flux. Linearize the sum of non-radiative fluxes as a bulk term $H + \\mathrm{LE} + G \\approx \\Lambda \\left(T_s - T_a\\right)$, where $T_s$ is surface temperature and $T_a$ is air temperature, and $\\Lambda$ is an effective bulk heat transfer coefficient.\n- Define net radiation as $R_n = (1 - \\alpha)\\,S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s \\left(L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4\\right)$, where $\\alpha$ is surface albedo, $S_{\\downarrow,\\mathrm{eff}}$ is the effective downwelling shortwave irradiance at the surface, $\\varepsilon_s$ is surface longwave emissivity, and $L_{\\downarrow,\\mathrm{eff}}$ is the effective downwelling longwave irradiance at the surface.\n- Model the effect of Sky View Factor (SVF) on effective radiative forcing as follows: let $S_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,S_{\\downarrow}$, and let $L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,L_{\\downarrow} + (1 - \\mathrm{SVF})\\,\\sigma T_a^4$, representing a linear mixture between the sky and the surrounding canyon surfaces at the air temperature.\n\nParameter values for a clear-sky summer midday scenario are specified as:\n- Air temperature $T_a = 303\\ \\mathrm{K}$.\n- Global horizontal shortwave irradiance at the surface $S_{\\downarrow} = 900\\ \\mathrm{W\\,m^{-2}}$.\n- Atmospheric emissivity $\\varepsilon_a = 0.82$, giving downwelling longwave $L_{\\downarrow} = \\varepsilon_a \\sigma T_a^4$ in $\\mathrm{W\\,m^{-2}}$.\n- Surface emissivity $\\varepsilon_s = 0.95$ (dimensionless).\n- Bulk transfer coefficient $\\Lambda = 15\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n\nYour task is to:\n1. Derive from the fundamental laws above a single nonlinear scalar equation in $T_s$ for steady state and solve it numerically for $T_s$ as a function of $(\\alpha,\\mathrm{SVF})$, then compute $R_n$ consistently.\n2. Using symmetric finite differences, compute the partial derivatives (sensitivities) at a baseline:\n   - Baseline parameters: $\\alpha_0 = 0.20$, $\\mathrm{SVF}_0 = 0.70$.\n   - Perturbations: $\\Delta \\alpha = 0.02$, $\\Delta \\mathrm{SVF} = 0.05$.\n   - Required sensitivities:\n     - $\\partial R_n / \\partial \\alpha$ in $\\mathrm{W\\,m^{-2}}$ per unit change in $\\alpha$,\n     - $\\partial T_s / \\partial \\alpha$ in $\\mathrm{K}$ per unit change in $\\alpha$,\n     - $\\partial R_n / \\partial \\mathrm{SVF}$ in $\\mathrm{W\\,m^{-2}}$ per unit change in $\\mathrm{SVF}$,\n     - $\\partial T_s / \\partial \\mathrm{SVF}$ in $\\mathrm{K}$ per unit change in $\\mathrm{SVF}$.\n   Use central differences for these derivatives at $(\\alpha_0,\\mathrm{SVF}_0)$.\n3. Evaluate boundary and edge cases by computing $(T_s,R_n)$ for:\n   - Fixed $\\mathrm{SVF}=\\mathrm{SVF}_0$, low albedo $\\alpha=0.05$.\n   - Fixed $\\mathrm{SVF}=\\mathrm{SVF}_0$, high albedo $\\alpha=0.50$.\n   - Fixed $\\alpha=\\alpha_0$, low $\\mathrm{SVF}=0.30$.\n   - Fixed $\\alpha=\\alpha_0$, high $\\mathrm{SVF}=1.00$.\n   - Combined extreme: $\\alpha=0.05$, $\\mathrm{SVF}=1.00$.\n\nMathematical and algorithmic requirements:\n- Start from the definitions above and the Stefan–Boltzmann law to obtain a scalar equation for $T_s$ of the form $f(T_s;\\alpha,\\mathrm{SVF})=0$, and solve for $T_s$ by root finding. Then compute $R_n$ using energy balance consistency $R_n = \\Lambda\\left(T_s - T_a\\right)$.\n- Express surface temperature $T_s$ in $\\mathrm{K}$ and net radiation $R_n$ in $\\mathrm{W\\,m^{-2}}$.\n- All angles, if any, must be in radians; there are no angles in this task.\n\nTest suite:\n- Use the baseline and perturbations specified above to compute the $4$ sensitivities via central differences.\n- Compute the $5$ $(T_s,R_n)$ pairs for the boundary and edge cases given above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be ordered as\n  [$\\partial R_n/\\partial \\alpha$, $\\partial T_s/\\partial \\alpha$, $\\partial R_n/\\partial \\mathrm{SVF}$, $\\partial T_s/\\partial \\mathrm{SVF}$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$].\n- Round every number in the output to exactly $3$ decimal places.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of radiative transfer and surface energy balance, is mathematically well-posed, and provides all necessary parameters and equations for a unique solution. The model, though simplified, is a standard representation used in urban climatology and environmental modeling.\n\nThe solution proceeds in three main steps:\n1. Derivation of the governing nonlinear scalar equation for surface temperature ($T_s$) from the principle of energy balance.\n2. Design of a numerical algorithm to solve for $T_s$ and subsequently compute net radiation ($R_n$).\n3. Application of this algorithm to compute the required sensitivities and evaluate the specified boundary cases.\n\n**1. Derivation of the Governing Equation for Surface Temperature**\n\nThe fundamental principle is the conservation of energy at the surface. At steady state, the net radiation ($R_n$) must be balanced by the sum of non-radiative heat fluxes (sensible heat $H$, latent heat $\\mathrm{LE}$, and ground heat $G$). The problem provides two expressions for $R_n$: one from the radiative components and one from the linearized non-radiative fluxes.\n\nThe energy balance equation is:\n$$\nR_n = H + \\mathrm{LE} + G\n$$\nThe problem provides a linearized expression for the non-radiative fluxes:\n$$\nH + \\mathrm{LE} + G \\approx \\Lambda (T_s - T_a)\n$$\nwhere $\\Lambda$ is the bulk heat transfer coefficient, $T_s$ is the surface temperature, and $T_a$ is the air temperature.\n\nThe net radiation $R_n$ is the sum of net shortwave and net longwave radiation:\n$$\nR_n = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)\n$$\nwhere $\\alpha$ is the albedo, $S_{\\downarrow,\\mathrm{eff}}$ is the effective downwelling shortwave radiation, $\\varepsilon_s$ is the surface emissivity, $L_{\\downarrow,\\mathrm{eff}}$ is the effective downwelling longwave radiation, and $\\sigma$ is the Stefan-Boltzmann constant. The term $\\varepsilon_s \\sigma T_s^4$ represents the outgoing longwave radiation from the surface, consistent with the Stefan-Boltzmann law and Kirchhoff's law of thermal radiation (absorptivity equals emissivity).\n\nBy equating the two expressions for $R_n$, we establish a single equation for the system's steady state:\n$$\n\\Lambda (T_s - T_a) = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)\n$$\nNext, we substitute the given models for the effective irradiances, which depend on the Sky View Factor ($\\mathrm{SVF}$):\n$$\nS_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot S_{\\downarrow}\n$$\n$$\nL_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot L_{\\downarrow} + (1 - \\mathrm{SVF}) \\sigma T_a^4\n$$\nAnd the downwelling atmospheric longwave radiation:\n$$\nL_{\\downarrow} = \\varepsilon_a \\sigma T_a^4\n$$\nSubstituting $L_{\\downarrow}$ into the expression for $L_{\\downarrow,\\mathrm{eff}}$ gives:\n$$\nL_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} (\\varepsilon_a \\sigma T_a^4) + (1 - \\mathrm{SVF}) \\sigma T_a^4 = \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF})\n$$\nNow, we substitute $S_{\\downarrow,\\mathrm{eff}}$ and $L_{\\downarrow,\\mathrm{eff}}$ into the energy balance equation:\n$$\n\\Lambda (T_s - T_a) = (1 - \\alpha)(\\mathrm{SVF} \\cdot S_{\\downarrow}) + \\varepsilon_s \\left[ \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) - \\sigma T_s^4 \\right]\n$$\nTo find $T_s$, we rearrange this into a root-finding problem of the form $f(T_s; \\alpha, \\mathrm{SVF}) = 0$.\n$$\nf(T_s) = \\varepsilon_s \\sigma T_s^4 + \\Lambda T_s - \\Lambda T_a - (1 - \\alpha)\\mathrm{SVF}S_{\\downarrow} - \\varepsilon_s \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) = 0\n$$\nThis is the final nonlinear scalar equation for $T_s$.\n\n**2. Numerical Solution and Sensitivity Analysis**\n\nThis equation cannot be solved for $T_s$ analytically. A numerical root-finding algorithm is required. The function $f(T_s)$ is monotonically increasing for physically meaningful temperatures ($T_s > 0$), as its derivative $f'(T_s) = 4\\varepsilon_s \\sigma T_s^3 + \\Lambda$ is always positive. This guarantees a unique positive root. We will use a Newton-Raphson based solver.\n\nOnce $T_s$ is determined for a given set of parameters $(\\alpha, \\mathrm{SVF})$, the net radiation $R_n$ is computed consistently using the linearized flux expression, as specified in the problem statement:\n$$\nR_n = \\Lambda (T_s - T_a)\n$$\nThe sensitivities (partial derivatives) are computed using the symmetric finite difference approximation at the baseline point $(\\alpha_0, \\mathrm{SVF}_0)$:\n$$\n\\frac{\\partial T_s}{\\partial \\alpha} \\approx \\frac{T_s(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - T_s(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}\n$$\n$$\n\\frac{\\partial R_n}{\\partial \\alpha} \\approx \\frac{R_n(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - R_n(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}\n$$\nAnalogous formulas are used for the partial derivatives with respect to $\\mathrm{SVF}$, using the perturbation $\\Delta\\mathrm{SVF}$.\n\n**3. Implementation for Test Cases**\n\nThe overall algorithm is as follows:\n1.  Define a function that takes $\\alpha$ and $\\mathrm{SVF}$ as inputs, constructs the function $f(T_s)$ and its derivative $f'(T_s)$, and solves $f(T_s)=0$ for $T_s$ using a numerical root-finder. The air temperature $T_a$ serves as a good initial guess.\n2.  The function then calculates $R_n = \\Lambda (T_s - T_a)$ and returns the pair $(T_s, R_n)$.\n3.  To compute the sensitivities, this function is called for the perturbed parameter values $(\\alpha_0 \\pm \\Delta\\alpha, \\mathrm{SVF}_0)$ and $(\\alpha_0, \\mathrm{SVF}_0 \\pm \\Delta\\mathrm{SVF})$. The finite difference formulas are then applied to the results.\n4.  To evaluate the boundary and edge cases, the function is called for each of the five specified $(\\alpha, \\mathrm{SVF})$ pairs.\n5.  All resulting fourteen numerical values are collected, rounded to three decimal places, and formatted into the final output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import newton as root_finder\n\ndef solve():\n    \"\"\"\n    Solves the urban surface energy balance problem, calculating sensitivities\n    and boundary case values for surface temperature and net radiation.\n    \"\"\"\n    #\n    # Step 1: Define physical constants and scenario parameters\n    #\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\n    TA = 303.0               # Air temperature (K)\n    S_DOWN = 900.0           # Global horizontal shortwave irradiance (W m^-2)\n    EPS_A = 0.82             # Atmospheric emissivity (dimensionless)\n    EPS_S = 0.95             # Surface emissivity (dimensionless)\n    LAMBDA = 15.0            # Bulk transfer coefficient (W m^-2 K^-1)\n\n    # Pre-calculate constants\n    L_DOWN_ATM = EPS_A * SIGMA * TA**4\n    TA_TERM_LONGWAVE = SIGMA * TA**4\n\n    def calculate_Ts_Rn(alpha, svf):\n        \"\"\"\n        Calculates steady-state surface temperature (Ts) and net radiation (Rn)\n        for a given albedo (alpha) and Sky View Factor (svf).\n        \n        Args:\n            alpha (float): Surface albedo (dimensionless, 0-1).\n            svf (float): Sky View Factor (dimensionless, 0-1).\n\n        Returns:\n            tuple[float, float]: A tuple containing (Ts in K, Rn in W/m^2).\n        \"\"\"\n        # Effective radiative forcings based on SVF\n        S_down_eff = svf * S_DOWN\n        L_down_eff = svf * L_DOWN_ATM + (1 - svf) * TA_TERM_LONGWAVE\n\n        # Define the function f(Ts) = 0 to be solved.\n        # f(Ts) = ε_s*σ*Ts^4 + Λ*Ts - (all other constant terms) = 0\n        constant_terms = (\n            LAMBDA * TA\n            + (1 - alpha) * S_down_eff\n            + EPS_S * L_down_eff\n        )\n        \n        def f(Ts):\n            return EPS_S * SIGMA * Ts**4 + LAMBDA * Ts - constant_terms\n\n        # Define the derivative of f(Ts) for a more efficient solver\n        def f_prime(Ts):\n            return 4 * EPS_S * SIGMA * Ts**3 + LAMBDA\n\n        # Solve for Ts using Newton-Raphson method with an initial guess of Ta\n        Ts = root_finder(f, x0=TA, fprime=f_prime)\n        \n        # Calculate Rn consistently with the found Ts\n        Rn = LAMBDA * (Ts - TA)\n        \n        return Ts, Rn\n\n    #\n    # Step 2: Calculate sensitivities using symmetric finite differences\n    #\n    alpha0 = 0.20\n    svf0 = 0.70\n    delta_alpha = 0.02\n    delta_svf = 0.05\n\n    # Perturbations for albedo\n    Ts_alpha_plus, Rn_alpha_plus = calculate_Ts_Rn(alpha0 + delta_alpha, svf0)\n    Ts_alpha_minus, Rn_alpha_minus = calculate_Ts_Rn(alpha0 - delta_alpha, svf0)\n\n    # Perturbations for SVF\n    Ts_svf_plus, Rn_svf_plus = calculate_Ts_Rn(alpha0, svf0 + delta_svf)\n    Ts_svf_minus, Rn_svf_minus = calculate_Ts_Rn(alpha0, svf0 - delta_svf)\n\n    # Compute sensitivities\n    dRn_dalpha = (Rn_alpha_plus - Rn_alpha_minus) / (2 * delta_alpha)\n    dTs_dalpha = (Ts_alpha_plus - Ts_alpha_minus) / (2 * delta_alpha)\n    dRn_dsvf = (Rn_svf_plus - Rn_svf_minus) / (2 * delta_svf)\n    dTs_dsvf = (Ts_svf_plus - Ts_svf_minus) / (2 * delta_svf)\n\n    sensitivities = [dRn_dalpha, dTs_dalpha, dRn_dsvf, dTs_dsvf]\n\n    #\n    # Step 3: Evaluate boundary and edge cases\n    #\n    boundary_cases = [\n        (0.05, svf0),   # low albedo, baseline SVF\n        (0.50, svf0),   # high albedo, baseline SVF\n        (alpha0, 0.30), # baseline albedo, low SVF\n        (alpha0, 1.00), # baseline albedo, high SVF\n        (0.05, 1.00),   # combined extreme: low albedo, high SVF\n    ]\n    \n    boundary_results = []\n    for alpha_case, svf_case in boundary_cases:\n        Ts_case, Rn_case = calculate_Ts_Rn(alpha_case, svf_case)\n        boundary_results.extend([Ts_case, Rn_case])\n\n    #\n    # Step 4: Combine all results and format for output\n    #\n    all_results = sensitivities + boundary_results\n    \n    formatted_results = [f\"{val:.3f}\" for val in all_results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}