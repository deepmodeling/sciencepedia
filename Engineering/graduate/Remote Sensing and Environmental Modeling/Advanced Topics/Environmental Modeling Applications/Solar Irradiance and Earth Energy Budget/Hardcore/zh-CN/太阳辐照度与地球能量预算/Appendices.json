{
    "hands_on_practices": [
        {
            "introduction": "任何地球能量收支模型的基础都是准确量化到达大气层顶的太阳辐射。本练习将指导您从基本的天体几何学原理出发，推导出决定任意纬度和季节日照时数和日总辐射量的核心方程。通过将这些原理转化为计算模型，您将掌握构建气候和环境模型中关键输入模块的核心技能 。",
            "id": "3849412",
            "problem": "您的任务是基于球面几何，推导并实现一个物理上严谨的晴空、大气层顶（TOA）每日总辐射模型。请从基本的几何学和运动学原理出发，不要假定任何预先推导出的昼长或日平均总辐射公式。\n\n出发点和假设：\n- 将地球表示为一个理想球体，其轴倾角由太阳赤纬角来体现。忽略大气折射和衰减。水平面上的瞬时大气层顶太阳辐照度为 $I(t) = S_0 \\max\\{0,\\cos \\theta_z(t)\\}$，其中 $S_0$ 是太阳常数，$\\theta_z$ 是太阳天顶角。\n- 使用单位球面点积关系来表示太阳天顶角：在纬度为 $\\varphi$、太阳赤纬为 $\\delta$ 的位置，构建指向太阳方向和本地天顶方向的地心单位向量，并引入因地球自转而均匀增加的时角 $h$。根据天球的球面几何以及纬度和赤纬的定义，太阳天顶角的余弦满足 $\\cos \\theta_z(h) = \\sin \\varphi \\,\\sin \\delta + \\cos \\varphi \\,\\cos \\delta \\,\\cos h$。\n- 地球以均匀的角速度 $\\omega_s = 2\\pi/86400$（单位为 $\\mathrm{rad\\,s^{-1}}$）自转，因此 $\\mathrm{d}t = \\mathrm{d}h/\\omega_s$，其中 $h$ 以弧度表示。\n- 当且仅当 $\\cos \\theta_z(h)  0$ 时，太阳位于地平线之上。日出和日落发生在 $\\cos \\theta_z(h_0) = 0$ 时。以小时为单位的昼长由 $\\cos \\theta_z(h)  0$ 的时角区间大小和自转速率决定。\n\n任务：\n1. 仅使用上述原理，通过求解地平线条件 $\\cos \\theta_z(h_0) = 0$ 来得出日出/日落时角 $h_0$，从而推导出作为纬度 $\\varphi$ 和太阳赤纬 $\\delta$ 函数的昼长。请仔细处理由 $h_0$ 的球面几何约束所隐含的三种情况：正常昼夜、持续白昼（极昼）和持续黑暗（极夜）。\n2. 使用推导出的 $h_0$，对瞬时辐照度 $I(t)$ 在白昼时段内进行解析积分，以获得单位为 $\\mathrm{J\\,m^{-2}\\,day^{-1}}$ 的每日积分大气层顶总辐射 $E_{\\mathrm{day}}(\\varphi,\\delta,S_0)$。通过除以 $10^{6}$，将最终结果表示为 $\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$。您必须注意使用 $\\mathrm{d}t = \\mathrm{d}h/\\omega_s$ 将时间积分表示为对时角 $h$ 的积分，并遵守由昼长情况所决定的正确积分限。\n3. 实现一个程序，为下面的每个测试用例计算：\n   - 昼长 $L$（单位为小时），四舍五入到 $6$ 位小数。\n   - 每日积分大气层顶总辐射 $E_{\\mathrm{day}}$（单位为 $\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$），四舍五入到 $6$ 位小数。\n   使用双精度浮点运算。输入的角度以度为单位提供，必须在内部转换为弧度。$S_0$ 的值取自测试集。忽略地球-太阳距离的变化，即将地球轨道视为具有恒定 $S_0$ 的圆形轨道。\n\n角度单位：\n- 所有纬度 $\\varphi$ 和赤纬 $\\delta$ 的输入均以度为单位。在所有三角函数运算中，需在内部将其转换为弧度。时角 $h$ 必须以弧度处理。\n\n物理单位：\n- 以小时报告 $L$。\n- 以 $\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$ 报告 $E_{\\mathrm{day}}$。\n\n边界情况与物理真实性：\n- 您的推导必须识别并正确处理由日出和日落的球面几何条件所隐含的极昼（持续白昼）和极夜（持续黑暗）情况。假设没有大气折射，因此几何地平线定义了日出/日落。\n- 该算法必须对发生情况转换的边界情况具有鲁棒性。\n\n测试集：\n- 使用以下参数集，每个参数集指定为 $(\\varphi,\\delta,S_0)$，其中 $\\varphi$ 和 $\\delta$ 的单位为度，$S_0$ 的单位为 $\\mathrm{W\\,m^{-2}}$：\n  - 情况 1：$(0.0^{\\circ}, 0.0^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n  - 情况 2：$(45.0^{\\circ}, 23.44^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n  - 情况 3：$(45.0^{\\circ}, -23.44^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n  - 情况 4：$(75.0^{\\circ}, 23.44^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n  - 情况 5：$(75.0^{\\circ}, -23.44^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n  - 情况 6：$(66.56^{\\circ}, 23.44^{\\circ}, 1361.0\\,\\mathrm{W\\,m^{-2}})$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述测试用例顺序排列的结果，格式为逗号分隔的列表的列表。每个内部列表必须包含两个浮点数：昼长 $L$（单位为小时）和每日积分大气层顶总辐射 $E_{\\mathrm{day}}$（单位为 $\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$），两者都四舍五入到 $6$ 位小数。例如：[[$L_1$,$E_1$],[$L_2$,$E_2$],...,[$L_6$,$E_6$]]。方括号和逗号必须与此格式完全匹配，不得有任何额外文本。",
            "solution": "用户提供的问题陈述被认为是有效的。它在科学上基于球面天文学和辐射传输的原理，问题设定良好，提供了足够的信息以获得唯一解，并以客观、正式的语言表达。这些任务是大气物理学和遥感领域中一个标准且不简单的练习，要求从第一性原理进行严谨的推导。\n\n解决方案首先推导昼长 $L$，然后推导每日积分总辐射 $E_{\\mathrm{day}}$。\n\n### 1. 昼长的推导\n\n大气层顶水平面上的瞬时太阳辐照度由 $I(t) = S_0 \\max\\{0, \\cos \\theta_z(t)\\}$ 给出，其中 $S_0$ 是太阳常数，$\\theta_z$ 是太阳天顶角。当 $\\cos \\theta_z  0$ 时，太阳位于地平线之上。太阳天顶角的余弦是纬度 $\\varphi$、太阳赤纬 $\\delta$ 和时角 $h$ 的函数：\n$$ \\cos \\theta_z(h) = \\sin \\varphi \\sin \\delta + \\cos \\varphi \\cos \\delta \\cos h $$\n所有角度（$\\varphi$、$\\delta$、$h$）在计算中均使用弧度。\n\n日出和日落发生在太阳盘面位于几何地平线时，即 $\\theta_z = \\pi/2$，对应于 $\\cos \\theta_z = 0$。设 $h_0$ 为日出和日落时角的绝对值（太阳正午时 $h=0$，日出在 $-h_0$，日落在 $+h_0$）。令 $\\cos \\theta_z(h_0) = 0$ 得：\n$$ \\sin \\varphi \\sin \\delta + \\cos \\varphi \\cos \\delta \\cos h_0 = 0 $$\n假设 $\\cos \\varphi \\neq 0$（即不在两极）且 $\\cos \\delta \\neq 0$（即不在春分或秋分，尽管公式仍然成立），解出 $\\cos h_0$：\n$$ \\cos h_0 = -\\frac{\\sin \\varphi \\sin \\delta}{\\cos \\varphi \\cos \\delta} = -\\tan \\varphi \\tan \\delta $$\n因此，日出/日落时角为 $h_0 = \\arccos(-\\tan \\varphi \\tan \\delta)$。$h_0$ 的值代表太阳在地平线上方角路径的一半。总白昼时长跨越 $2h_0$ 的角度。地球的自转速率为 $\\omega_s = 2\\pi / T_{\\text{day}}$，其中 $T_{\\text{day}} = 86400 \\, \\mathrm{s}$。以小时为单位的昼长 $L$ 为：\n$$ L = \\frac{2 h_0}{\\omega_s} \\times \\frac{1 \\, \\mathrm{hr}}{3600 \\, \\mathrm{s}} = \\frac{2 h_0}{2\\pi / 86400} \\times \\frac{1}{3600} = \\frac{86400}{3600} \\frac{h_0}{\\pi} = \\frac{24}{\\pi} h_0 $$\n反余弦函数的参数，我们记为 $X = -\\tan \\varphi \\tan \\delta$，必须位于区间 $[-1, 1]$ 内，才能存在 $h_0$ 的实数解。这个约束定义了三种不同的物理情况：\n\n1.  **正常昼夜 ($ -1  X  1 $)**：发生一次日出和一次日落。日出/日落时角为 $h_0 = \\arccos(X)$，其范围在 $(0, \\pi)$ 内。昼长为 $L = \\frac{24}{\\pi}\\arccos(-\\tan \\varphi \\tan \\delta)$ 小时，其中 $0  L  24$。\n\n2.  **极昼 / 持续白昼 ($ X \\le -1 $)**：这发生在 $\\tan \\varphi \\tan \\delta \\ge 1$ 时。在这种情况下，$\\cos \\theta_z(h)$ 始终为正，意味着太阳永不落下。太阳在天上的时角跨越整个圆周，所以我们取 $h_0 = \\pi$。这导致昼长为 $L = \\frac{24}{\\pi}(\\pi) = 24$ 小时。条件 $\\tan \\varphi \\tan \\delta \\ge 1$ 等价于 $\\cos(\\varphi+\\delta) \\le 0$（假设 $\\cos\\varphi\\cos\\delta>0$），这表示在午夜（$h=\\pi$，太阳高度最低）时，太阳仍然在地平线或地平线以上。\n\n3.  **极夜 / 持续黑暗 ($ X \\ge 1 $)**：这发生在 $-\\tan \\varphi \\tan \\delta \\ge 1$ 时。在这种情况下，$\\cos \\theta_z(h)$ 始终为非正值，意味着太阳永不升起。没有白昼时间，所以我们取 $h_0 = 0$。这导致昼长为 $L = 0$ 小时。条件 $-\\tan \\varphi \\tan \\delta \\ge 1$ 等价于 $\\cos(\\varphi-\\delta) \\le 0$，这表示在正午（$h=0$，太阳高度最高）时，太阳仍然在地平线或地平线以下。\n\n### 2. 每日积分总辐射的推导\n\n每日积分大气层顶总辐射 $E_{\\mathrm{day}}$ 是瞬时辐照度 $I(t)$ 在单日白昼时段内的积分。\n$$ E_{\\mathrm{day}} = \\int_{\\text{daylight}} I(t) \\, \\mathrm{d}t = \\int_{\\text{daylight}} S_0 \\cos \\theta_z(t) \\, \\mathrm{d}t $$\n使用关系式 $\\mathrm{d}t = \\mathrm{d}h / \\omega_s$，我们可以将积分转换到时角域。积分限对应于日出（$-h_0$）和日落（$+h_0$）。\n$$ E_{\\mathrm{day}} = \\int_{-h_0}^{+h_0} S_0 \\left( \\sin \\varphi \\sin \\delta + \\cos \\varphi \\cos \\delta \\cos h \\right) \\frac{\\mathrm{d}h}{\\omega_s} $$\n被积函数是关于 $h$ 的偶函数。我们可以简化积分为：\n$$ E_{\\mathrm{day}} = \\frac{2S_0}{\\omega_s} \\int_{0}^{h_0} \\left( \\sin \\varphi \\sin \\delta + \\cos \\varphi \\cos \\delta \\cos h \\right) \\mathrm{d}h $$\n进行积分：\n$$ E_{\\mathrm{day}} = \\frac{2S_0}{\\omega_s} \\left[ h \\sin \\varphi \\sin \\delta + \\sin h \\cos \\varphi \\cos \\delta \\right]_{0}^{h_0} $$\n$$ E_{\\mathrm{day}} = \\frac{2S_0}{\\omega_s} \\left( h_0 \\sin \\varphi \\sin \\delta + \\sin h_0 \\cos \\varphi \\cos \\delta \\right) $$\n代入 $\\omega_s = 2\\pi / T_{\\text{day}}$（其中 $T_{\\text{day}} = 86400 \\, \\mathrm{s}$），我们得到单位为 $\\mathrm{J\\,m^{-2}}$ 的最终表达式：\n$$ E_{\\mathrm{day}} = \\frac{S_0 T_{\\text{day}}}{\\pi} \\left( h_0 \\sin \\varphi \\sin \\delta + \\sin h_0 \\cos \\varphi \\cos \\delta \\right) $$\n通过使用合适的 $h_0$ 值，这个单一公式对所有三种情况都有效：\n- 对于正常昼夜，$h_0 = \\arccos(-\\tan \\varphi \\tan \\delta)$。\n- 对于极昼，$h_0 = \\pi$。公式简化为 $E_{\\mathrm{day}} = S_0 T_{\\text{day}} \\sin \\varphi \\sin \\delta$。\n- 对于极夜，$h_0 = 0$。公式简化为 $E_{\\mathrm{day}} = 0$。\n\n为了将结果表示为兆焦耳每平方米每天（$\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$），我们除以 $10^6$。\n\n### 3. 算法实现\n\n对于给定的参数集 $(\\varphi_{\\text{deg}}, \\delta_{\\text{deg}}, S_0)$，计算算法如下：\n1.  将纬度 $\\varphi_{\\text{deg}}$ 和赤纬 $\\delta_{\\text{deg}}$ 从度转换为弧度：$\\varphi = \\varphi_{\\text{deg}} \\frac{\\pi}{180}$ 和 $\\delta = \\delta_{\\text{deg}} \\frac{\\pi}{180}$。\n2.  计算反余弦的参数：$X = -\\tan \\varphi \\tan \\delta$。\n3.  为了在边界附近鲁棒地处理三种情况和潜在的浮点不精确性，将 $X$ 的值裁剪到有效范围 $[-1, 1]$ 内。\n4.  计算日出/日落时角：$h_0 = \\arccos(\\text{clip}(X, -1, 1))$。这个单一操作能正确地得出极夜的 $h_0=0$，极昼的 $h_0=\\pi$，以及正常昼夜的相应中间值。\n5.  计算昼长（单位为小时）：$L = \\frac{24}{\\pi} h_0$。\n6.  计算每日积分总辐射（单位为 $\\mathrm{J\\,m^{-2}}$）：$E_{\\text{J/m}^2} = \\frac{S_0 \\cdot 86400}{\\pi} (h_0 \\sin \\varphi \\sin \\delta + \\sin h_0 \\cos \\varphi \\cos \\delta)$。\n7.  将总辐射转换为 $\\mathrm{MJ\\,m^{-2}\\,day^{-1}}$：$E_{\\mathrm{day}} = E_{\\text{J/m}^2} / 10^6$。\n8.  按照要求将 $L$ 和 $E_{\\mathrm{day}}$ 都四舍五入到6位小数。\n\n该过程在提供的 Python 代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes day length and TOA daily insolation based on spherical geometry.\n    \"\"\"\n    # The problem specifies using a mean solar day of 86400 seconds.\n    T_DAY = 86400.0  # seconds in a mean solar day\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (latitude_deg, declination_deg, solar_constant_W_m2).\n    test_cases = [\n        (0.0, 0.0, 1361.0),\n        (45.0, 23.44, 1361.0),\n        (45.0, -23.44, 1361.0),\n        (75.0, 23.44, 1361.0),\n        (75.0, -23.44, 1361.0),\n        (66.56, 23.44, 1361.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        phi_deg, delta_deg, S0 = case\n\n        # Convert angles from degrees to radians for trigonometric functions\n        phi = np.deg2rad(phi_deg)\n        delta = np.deg2rad(delta_deg)\n        \n        # --- Task 1: Calculate Day Length ---\n        \n        # Calculate the argument for arccos. Handle poles where tan is infinite.\n        # At poles (phi_deg = +/-90), tan(phi) is infinite.\n        if np.isclose(np.abs(phi_deg), 90.0):\n            # For North Pole (phi > 0), if delta > 0, it's 24h day. If delta  0, 0h day.\n            # For South Pole (phi  0), if delta  0, it's 24h day. If delta > 0, 0h day.\n            # This is equivalent to checking the sign of phi * delta.\n            if phi * delta >= 0:\n                h0 = np.pi  # Polar day\n            else:\n                h0 = 0.0   # Polar night\n        else:\n            # For non-polar latitudes, use the derived formula.\n            X = -np.tan(phi) * np.tan(delta)\n            \n            # Use np.clip for numerical stability at the boundaries of the arccos domain.\n            # This robustly handles the three regimes:\n            # X > 1  (polar night) -> clip to 1 -> arccos(1) = 0\n            # X  -1 (polar day)   -> clip to -1 -> arccos(-1) = pi\n            # -1 = X = 1 (normal day) -> arccos(X)\n            h0 = np.arccos(np.clip(X, -1.0, 1.0))\n\n        # Day length L in hours\n        L = (24.0 / np.pi) * h0\n\n        # --- Task 2: Calculate Daily-Integrated Insolation ---\n        \n        # The derived formula for daily insolation in J/m^2\n        # E_day = (S0 * T_day / pi) * (h0*sin(phi)*sin(delta) + sin(h0)*cos(phi)*cos(delta))\n        term1 = h0 * np.sin(phi) * np.sin(delta)\n        term2 = np.sin(h0) * np.cos(phi) * np.cos(delta)\n        \n        # Insolation in J m^-2 day^-1\n        E_J_per_m2 = (S0 * T_DAY / np.pi) * (term1 + term2)\n        \n        # Convert to MJ m^-2 day^-1\n        E_day = E_J_per_m2 / 1e6\n        \n        # Round the results to 6 decimal places as required\n        L_rounded = round(L, 6)\n        E_day_rounded = round(E_day, 6)\n        \n        # Format the result for this case as a string '[L,E]'\n        results.append(f\"[{L_rounded},{E_day_rounded}]\")\n\n    # Final print statement in the exact required format.\n    # Join the individual case results with commas, enclosed in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当太阳辐射穿过大气层时，它会与气溶胶和云粒子发生复杂的相互作用，其中散射是关键过程。本练习将通过经典的Henyey-Greenstein相函数，让您深入探究散射的方向性及其对能量分配的影响。您将通过分析和计算，理解不对称因子 $g$ 如何决定了向前散射与向后散射的比例，这对于精确模拟地表接收的直接辐射与漫射辐射至关重要 。",
            "id": "3849390",
            "problem": "在无云大气中，一个均匀的平行平面气溶胶层根据 Henyey–Greenstein 相函数散射入射的太阳辐射，该相函数是在单位球面上定义的单位立体角的概率密度。设散射角为 $\\theta$（以弧度为单位），并定义 $\\mu = \\cos(\\theta)$。相函数为\n$$\np(\\mu) = \\frac{1 - g^{2}}{4\\pi \\left(1 + g^{2} - 2 g \\mu\\right)^{3/2}},\n$$\n其中 $g \\in (-1,1)$ 是不对称因子，$p(\\mu)$ 被归一化，使得 $\\int_{4\\pi} p(\\mu)\\, \\mathrm{d}\\Omega = 1$。使用球面上立体角积分的第一性原理以及 $p(\\mu)$ 的归一化条件，推导散射到前向半球的光子分数 $F(g)$ 的精确表达式。前向半球定义为 $0 \\leq \\theta \\leq \\frac{\\pi}{2}$（等效于 $0 \\leq \\mu \\leq 1$）。然后，对 $g = 0.75$ 的情况进行数值计算，求出 $F(g)$ 的值，并将最终数值答案四舍五入到四位有效数字，表示为无单位的十进制小数。在辐射传输推理的层面上，简要讨论在单次散射、光学薄极限下，$F(g)$ 的增加如何影响向下地表辐照度的直射和漫射分量。",
            "solution": "散射到前向半球的光子分数 $F(g)$，是通过将相函数 $p(\\mu)$ 在对应于前向半球的立体角上积分得到的。在球坐标系中，立体角元 $\\mathrm{d}\\Omega$ 由 $\\mathrm{d}\\Omega = \\sin(\\theta) \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi$ 给出，其中 $\\theta$ 是极角（此处为散射角），$\\phi$ 是方位角。\n\n前向半球定义为 $0 \\leq \\theta \\leq \\frac{\\pi}{2}$ 和 $0 \\leq \\phi \\leq 2\\pi$。因此，$F(g)$ 的积分为：\n$$\nF(g) = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} p(\\cos(\\theta)) \\sin(\\theta) \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n由于 Henyey-Greenstein 相函数 $p(\\mu)$ 仅依赖于 $\\mu = \\cos(\\theta)$ 而不依赖于方位角 $\\phi$，因此对 $\\phi$ 的积分产生一个因子 $2\\pi$：\n$$\nF(g) = 2\\pi \\int_{0}^{\\pi/2} p(\\cos(\\theta)) \\sin(\\theta) \\, \\mathrm{d}\\theta\n$$\n我们进行变量代换，从 $\\theta$ 换为 $\\mu = \\cos(\\theta)$。微分量为 $\\mathrm{d}\\mu = -\\sin(\\theta) \\, \\mathrm{d}\\theta$。积分限变化如下：当 $\\theta = 0$ 时，$\\mu = \\cos(0) = 1$；当 $\\theta = \\frac{\\pi}{2}$ 时，$\\mu = \\cos(\\frac{\\pi}{2}) = 0$。将这些代入积分中：\n$$\nF(g) = 2\\pi \\int_{1}^{0} p(\\mu) (-\\mathrm{d}\\mu) = 2\\pi \\int_{0}^{1} p(\\mu) \\, \\mathrm{d}\\mu\n$$\n现在，我们代入 $p(\\mu)$ 的表达式：\n$$\nF(g) = 2\\pi \\int_{0}^{1} \\frac{1 - g^{2}}{4\\pi \\left(1 + g^{2} - 2 g \\mu\\right)^{3/2}} \\, \\mathrm{d}\\mu\n$$\n因子 $2\\pi$ 消掉，我们可以将常数项提到积分外面：\n$$\nF(g) = \\frac{1 - g^{2}}{2} \\int_{0}^{1} \\left(1 + g^{2} - 2 g \\mu\\right)^{-3/2} \\, \\mathrm{d}\\mu\n$$\n为了计算这个积分，令 $u = 1 + g^{2} - 2 g \\mu$。那么 $\\mathrm{d}u = -2g \\, \\mathrm{d}\\mu$，这意味着 $\\mathrm{d}\\mu = -\\frac{\\mathrm{d}u}{2g}$。不定积分为：\n$$\n\\int u^{-3/2} \\left(-\\frac{\\mathrm{d}u}{2g}\\right) = -\\frac{1}{2g} \\frac{u^{-1/2}}{-1/2} = \\frac{1}{g} u^{-1/2} = \\frac{1}{g\\sqrt{u}}\n$$\n代回 $u$，反导数为 $\\frac{1}{g\\sqrt{1 + g^{2} - 2 g \\mu}}$。我们现在计算定积分：\n$$\nF(g) = \\frac{1 - g^{2}}{2} \\left[ \\frac{1}{g\\sqrt{1 + g^{2} - 2 g \\mu}} \\right]_{0}^{1}\n$$\n在上限（$\\mu=1$）和下限（$\\mu=0$）处计算表达式的值：\n当 $\\mu = 1$ 时：$\\frac{1}{g\\sqrt{1 + g^{2} - 2g}} = \\frac{1}{g\\sqrt{(1-g)^2}} = \\frac{1}{g|1-g|}$。由于 $g \\in (-1,1)$，$1-g > 0$，所以 $|1-g| = 1-g$。该项为 $\\frac{1}{g(1-g)}$。\n当 $\\mu = 0$ 时：$\\frac{1}{g\\sqrt{1 + g^{2}}}$。\n将这些结果代回 $F(g)$ 的表达式中：\n$$\nF(g) = \\frac{1 - g^{2}}{2} \\left( \\frac{1}{g(1-g)} - \\frac{1}{g\\sqrt{1+g^2}} \\right)\n$$\n我们可以简化这个表达式。从括号中提出因子 $\\frac{1}{g}$ 并使用 $1 - g^2 = (1-g)(1+g)$：\n$$\nF(g) = \\frac{(1-g)(1+g)}{2g} \\left( \\frac{1}{1-g} - \\frac{1}{\\sqrt{1+g^2}} \\right)\n$$\n$$\nF(g) = \\frac{1+g}{2g} - \\frac{(1-g)(1+g)}{2g\\sqrt{1+g^2}} = \\frac{1+g}{2g} - \\frac{1-g^2}{2g\\sqrt{1+g^2}}\n$$\n这是 $F(g)$ 的精确解析表达式。\n\n接下来，我们计算当 $g = 0.75$ 时该表达式的值。我们使用精确的分数形式 $g = \\frac{3}{4}$：\n- $1+g = 1 + \\frac{3}{4} = \\frac{7}{4}$\n- $1-g = 1 - \\frac{3}{4} = \\frac{1}{4}$\n- $2g = 2 \\left(\\frac{3}{4}\\right) = \\frac{3}{2}$\n- $1-g^2 = 1 - \\left(\\frac{3}{4}\\right)^2 = 1 - \\frac{9}{16} = \\frac{7}{16}$\n- $1+g^2 = 1 + \\left(\\frac{3}{4}\\right)^2 = 1 + \\frac{9}{16} = \\frac{25}{16}$\n- $\\sqrt{1+g^2} = \\sqrt{\\frac{25}{16}} = \\frac{5}{4}$\n将这些代入推导出的公式中：\n$$\nF\\left(\\frac{3}{4}\\right) = \\frac{7/4}{3/2} - \\frac{7/16}{(3/2)(5/4)}\n$$\n$$\nF\\left(\\frac{3}{4}\\right) = \\left(\\frac{7}{4}\\right)\\left(\\frac{2}{3}\\right) - \\frac{7/16}{15/8} = \\frac{14}{12} - \\left(\\frac{7}{16}\\right)\\left(\\frac{8}{15}\\right)\n$$\n$$\nF\\left(\\frac{3}{4}\\right) = \\frac{7}{6} - \\frac{7}{30} = \\frac{35}{30} - \\frac{7}{30} = \\frac{28}{30} = \\frac{14}{15}\n$$\n精确值为 $\\frac{14}{15}$。为了得到数值答案，我们将此分数转换为小数：\n$$\nF(0.75) = \\frac{14}{15} \\approx 0.933333...\n$$\n四舍五入到四位有效数字，我们得到 $F(0.75) \\approx 0.9333$。\n\n最后，我们讨论其物理含义。向下地表辐照度是到达地球表面的单位面积太阳功率。它包括两个分量：\n1.  **直射辐照度 ($E_{dir}$)**：从太阳直接到达地表而未被散射的辐射。\n2.  **漫射辐照度 ($E_{dif}$)**：在到达地表前至少被大气成分（如气溶胶）散射过一次的辐射。\n\n问题指定了单次散射、光学薄极限。在这种情况下（$\\tau \\ll 1$，其中 $\\tau$ 是气溶胶光学厚度），我们只考虑最多被散射一次的光子。\n- **直射辐照度**因散射事件而衰减，这些事件将光子从直射光束中移除。衰减量由总散射光学厚度决定，它代表光子被散射的概率。散射的方向不影响光子是否从直射光束中被移除。因此，在保持总光学厚度不变的情况下，通过增加 $F(g)$ 来改变相函数的形状，对**直射辐照度没有影响**。$E_{dir} \\approx E_0 \\exp(-\\tau/\\mu_0)$，其中 $E_0$ 是地外辐照度，$\\mu_0$ 是太阳天顶角的余弦。\n\n- 地表的**漫射辐照度**由被散射到向下方路径的光子组成。量 $F(g)$ 正是散射到前向（向下）半球的光子所占的比例。$F(g)$ 的增加对应于一个更强的前向峰值相函数。这意味着，对于相同总数的散射事件（固定的光学厚度），更大比例的散射光子将被重定向到地表。因此，$F(g)$的增加会导致**向下地表辐照度的漫射分量增加**。",
            "answer": "$$\\boxed{0.9333}$$"
        },
        {
            "introduction": "将理论模型与实际观测联系起来是遥感科学的核心。此项练习模拟了一个典型的遥感反演问题：如何利用地面太阳光度计的直接辐射测量值来推断整个大气柱的光学深度。通过应用比尔-朗伯-布格定律，您将学会从衰减后的信号中“反演”出描述大气透明度的关键物理量 $\\tau_{\\lambda}$，从而完成从理论到应用的闭环 。",
            "id": "3849375",
            "problem": "一台地基太阳光度计在晴空条件下观测到波长 $\\lambda = 675\\,\\mathrm{nm}$ 处的法向直接光谱辐照度。测量值为 $I_{\\lambda} = 0.95\\,\\mathrm{W\\,m^{-2}\\,nm^{-1}}$。经过观测时刻地日距离订正后，大气层顶 (TOA) 的大气外光谱辐照度为 $I_{0,\\lambda} = 1.50\\,\\mathrm{W\\,m^{-2}\\,nm^{-1}}$。从太阳几何关系可知，几何大气质量为 $m = 2.05$。\n\n仅使用沿直接太阳光束的辐射能量守恒原理，以及在水平均匀的平面平行大气中（在 $\\lambda = 675\\,\\mathrm{nm}$ 波长处，光束内发射和源项可忽略不计）消光和光学厚度的定义，推导出用 $I_{\\lambda}$、$I_{0,\\lambda}$ 和 $m$ 表示光谱光学厚度 $\\tau_{\\lambda}$ 的表达式，然后根据所提供的数据计算其值。\n\n最后，结合衰减过程以及沿直接路径传输到地面的太阳能分数，简要解释在此背景下 $\\tau_{\\lambda}$ 的物理意义。\n\n报告 $\\tau_{\\lambda}$ 的数值，该值为无量纲量，并四舍五入到四位有效数字。",
            "solution": "该问题陈述已经过验证，具有科学依据，提法得当且客观。它是一个基于比尔-朗伯-布格定律的大气辐射传输领域的标准问题。所有必要数据均已提供，且所作假设在此背景下是物理上合适的。\n\n控制直接太阳辐射穿过大气层衰减的物理原理是比尔-朗伯-布格定律。该定律源于光束穿过散射和/或吸收辐射的介质时的辐射能量守恒原理。对于光谱辐照度为 $I_{\\lambda}$ 的单色光束，其在微分路径长度 $ds$ 上的微分变化 $dI_{\\lambda}$ 与辐照度本身成正比：\n$$dI_{\\lambda} = - \\sigma_{e,\\lambda} I_{\\lambda} ds$$\n其中 $\\sigma_{e,\\lambda}$ 是波长 $\\lambda$ 处的体消光系数。负号表示辐照度沿路径衰减（减小）。问题陈述中指出，在给定的波长 $\\lambda = 675\\,\\mathrm{nm}$ 处，光束内发射和其他源项可忽略不计，这证明了该公式的合理性。\n\n沿大气中的斜程路径 $s$，将此微分方程从辐照度为 $I_{0,\\lambda}$ 的大气层顶 (TOA) 积分到辐照度为 $I_{\\lambda}$ 的地表，可得：\n$$I_{\\lambda} = I_{0,\\lambda} \\exp\\left(-\\int_{path} \\sigma_{e,\\lambda} ds\\right)$$\n指数中的积分是沿斜程路径的总光学厚度。\n\n问题指明了这是一个水平均匀的平面平行大气。在此模型中，斜程光学厚度通过几何大气质量 $m$ 与垂直光学厚度 $\\tau_{\\lambda}$ 相关联。垂直光学厚度（或光学厚度）定义为消光系数在整个大气垂直柱上的积分：\n$$\\tau_{\\lambda} = \\int_{0}^{\\infty} \\sigma_{e,\\lambda}(z) dz$$\n其中 $z$ 是垂直坐标。斜程光学厚度则由 $m \\tau_{\\lambda}$ 给出。将此代入积分后的定律，得到地表法向直接辐照度的方程：\n$$I_{\\lambda} = I_{0,\\lambda} \\exp(-m \\tau_{\\lambda})$$\n该方程将地表测量的辐照度 ($I_{\\lambda}$) 与已知的大气外辐照度 ($I_{0,\\lambda}$)、路径的几何参数 ($m$) 以及我们希望求得的量——光谱光学厚度 ($\\tau_{\\lambda}$) 联系起来。\n\n为了推导 $\\tau_{\\lambda}$ 的表达式，我们对该方程进行代数整理。\n首先，两边同除以 $I_{0,\\lambda}$：\n$$\\frac{I_{\\lambda}}{I_{0,\\lambda}} = \\exp(-m \\tau_{\\lambda})$$\n接下来，两边取自然对数以消去指数函数：\n$$\\ln\\left(\\frac{I_{\\lambda}}{I_{0,\\lambda}}\\right) = -m \\tau_{\\lambda}$$\n最后，我们解出 $\\tau_{\\lambda}$：\n$$\\tau_{\\lambda} = -\\frac{1}{m} \\ln\\left(\\frac{I_{\\lambda}}{I_{0,\\lambda}}\\right)$$\n利用对数的性质 $\\ln(a/b) = -\\ln(b/a)$，该式也可以写成：\n$$\\tau_{\\lambda} = \\frac{1}{m} \\ln\\left(\\frac{I_{0,\\lambda}}{I_{\\lambda}}\\right)$$\n这就是用给定物理量表示光谱光学厚度的所求表达式。\n\n现在，我们使用所提供的数据计算 $\\tau_{\\lambda}$ 的数值：\n-   $I_{\\lambda} = 0.95\\,\\mathrm{W\\,m^{-2}\\,nm^{-1}}$\n-   $I_{0,\\lambda} = 1.50\\,\\mathrm{W\\,m^{-2}\\,nm^{-1}}$\n-   $m = 2.05$\n\n将这些值代入推导出的表达式：\n$$\\tau_{\\lambda} = \\frac{1}{2.05} \\ln\\left(\\frac{1.50}{0.95}\\right)$$\n$$\\tau_{\\lambda} = \\frac{1}{2.05} \\ln(1.578947...)$$\n$$\\tau_{\\lambda} = \\frac{1}{2.05} (0.456740...)$$\n$$\\tau_{\\lambda} \\approx 0.2227999...$$\n按要求四舍五入到四位有效数字，光谱光学厚度为：\n$$\\tau_{\\lambda} \\approx 0.2228$$\n\n光谱光学厚度 $\\tau_{\\lambda}$ 的物理意义是，它是一个无量纲的量，用于衡量在特定波长 $\\lambda$ 下，大气在垂直方向（即对于一个直视天顶的观测者而言）的总透明度。它量化了辐射束在垂直穿过整个大气层时所经历的总衰减（由散射和吸收共同引起）。$\\tau_{\\lambda}$ 的值越大，意味着大气越不透明，衰减越大；而接近于零的值则意味着大气几乎是透明的。\n\n在此背景下，$\\lambda = 675\\,\\mathrm{nm}$ 处的 $\\tau_{\\lambda} = 0.2228$ 代表了在观测到的晴空条件下，由分子（瑞利）散射以及气溶胶散射和吸收共同造成的总消光。\n\n垂直穿过大气的能量传输分数（即，如果太阳位于天顶，此时 $m=1$）由透射率 $T_{\\lambda} = \\exp(-\\tau_{\\lambda})$ 给出。对于我们计算出的值：\n$$T_{\\lambda} = \\exp(-0.2228) \\approx 0.7999$$\n这意味着在波长 $\\lambda = 675\\,\\mathrm{nm}$ 处，大约有 $80.0\\%$ 的直接太阳辐射会沿着垂直路径传输到地表。剩余的 $20.0\\%$ 则被衰减，即被从直接光束中散射出去或被大气成分吸收。对于大气质量 $m = 2.05$ 的实际观测，沿斜程路径的透射率为 $\\exp(-m \\tau_{\\lambda}) = \\exp(-2.05 \\times 0.2228) \\approx 0.633$，这恰好是比率 $I_{\\lambda}/I_{0,\\lambda} = 0.95/1.50$。",
            "answer": "$$\\boxed{0.2228}$$"
        }
    ]
}