{
    "hands_on_practices": [
        {
            "introduction": "从光谱反射率数据中量化植被特性的能力是作物监测的基础。本练习聚焦于三个最重要的植被指数：归一化植被指数（$NDVI$）、土壤调节植被指数（$SAVI$）和增强型植被指数（$EVI$）。通过为稀疏作物和裸土计算这些指数，您将获得对其公式的实践经验，并深入理解它们如何被设计用来减弱土壤亮度和大气噪声等混淆因素的影响 。",
            "id": "3803509",
            "problem": "为监测作物健康状况并使用归一化植被指数区分稀疏植被与裸土，进行了一次多光谱遥感活动。考虑在晴朗天空下的地方太阳正午时观测到的两个相邻田地。已应用大气校正以获得地表反射率。田地 $\\mathrm{S}$ 为稀疏的新生作物冠层，田地 $\\mathrm{B}$ 为裸土。对于每块田地，测得的波段反射率如下：田地 $\\mathrm{S}$ 的 $R_{\\mathrm{NIR}}=0.42$，$R_{\\mathrm{Red}}=0.15$，$R_{\\mathrm{Blue}}=0.07$。田地 $\\mathrm{B}$ 的 $R_{\\mathrm{NIR}}=0.30$，$R_{\\mathrm{Red}}=0.22$，$R_{\\mathrm{Blue}}=0.19$。从地表反射率的基本定义（即在一个光谱波段上积分的上行辐射亮度与下行辐射照度的无量纲比值），以及归一化光谱对比度抑制乘性光照和传感器增益效应的原理出发，推导归一化植被指数（NDVI）、土壤调节植被指数（SAVI）和增强型植被指数（EVI）的显式表达式。在您的推导中，为 SAVI 加入冠层背景调整参数 $L$，并为 EVI 加入一个利用蓝光波段的气溶胶阻抗项。使用中分辨率成像光谱仪（MODIS）文献中定义的 EVI 标准操作常数，即 $G=2.5$，$C_{1}=6$，$C_{2}=7.5$，以及 EVI 分母中的 $L=1$，并取 SAVI 的 $L=0.5$。然后计算田地 $\\mathrm{S}$ 和 $\\mathrm{B}$ 的 NDVI、SAVI 和 EVI。为评估哪个指数能最好地区分稀疏作物和裸土，计算每个指数的绝对类间差异，定义为 $|I_{\\mathrm{S}}-I_{\\mathrm{B}}|$，其中 $I_{\\mathrm{S}}$ 和 $I_{\\mathrm{B}}$ 分别表示田地 $\\mathrm{S}$ 和田地 $\\mathrm{B}$ 的指数值。将 NDVI、SAVI 和 EVI 中的最大绝对差异报告为单个十进制数值，四舍五入至四位有效数字。最终结果不带单位。",
            "solution": "该问题要求推导三种标准植被指数的表达式，计算它们在两种不同土地覆盖类型下的值，并评估它们区分这两种类型的能力。对问题陈述的验证发现其科学基础扎实、提法恰当、客观且完整。因此，在此给出完整解答。\n\n基本概念是地表反射率 $R$，它是一个无量纲的量，表示在给定光谱波段内，地表反射的入射太阳辐射的比例。对于中心波长为 $\\lambda$ 的波段，反射率 $R_{\\lambda}$ 定义为上行光谱辐射亮度 $L_{\\uparrow, \\lambda}$ 与下行光谱辐射照度 $E_{\\downarrow, \\lambda}$ 的比值。乘性因素，如太阳角度或大气雾霾引起的光照变化，以及传感器增益伪影，往往会以相关的方式影响不同光谱波段的反射率。植被指数旨在利用光谱对比度，同时抑制这些混淆因素。比值，特别是归一化差异，对于此目的非常有效。\n\n健康、具有光合作用活性的植被的主要光谱特征是，叶绿素在光谱的红色部分强烈吸收辐射，而叶片的内部细胞结构在近红外（NIR）部分强烈反射。相比之下，裸土的反射率通常从红色到近红外波段呈现更为平缓的增长。植被指数的构建就是为了量化这种对比度。\n\n1.  **归一化植被指数 (NDVI)**\n    NDVI 旨在增强红光与近红外光的对比度，同时对光照条件进行归一化。它被构建为近红外和红光反射率之间的归一化差异。设 $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 分别为相应波段的反射率，NDVI 定义为：\n    $$\n    \\mathrm{NDVI} = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}\n    $$\n    该公式将指数的值界定在 $-1$ 和 $+1$ 之间，并减轻了乘性噪声的影响。\n\n2.  **土壤调节植被指数 (SAVI)**\n    在植被稀疏的场景中，光谱信号是植被与下层土壤背景的混合。NDVI 对土壤亮度可能很敏感，这会导致解释 NDVI 值时出现模糊性。SAVI 通过引入一个冠层背景调整参数 $L$ 来修改 NDVI 方程，以最小化这种由土壤引起的变异。参数 $L$ 是一个取决于冠层密度的常数；如此问题所述，对于中等植被覆盖度，通常使用 $L=0.5$ 的值。SAVI 的表达式为：\n    $$\n    \\mathrm{SAVI} = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}} + L} (1+L)\n    $$\n    对于此问题，我们使用 $L=0.5$。\n\n3.  **增强型植被指数 (EVI)**\n    EVI 的开发旨在改善 NDVI 在高生物量区域（NDVI 在此区域会饱和）的灵敏度，并进一步减少土壤背景和大气的影响。EVI 包含了蓝光波段反射率 $R_{\\mathrm{Blue}}$，以校正气溶胶散射，因为气溶胶散射对红光波段的影响大于近红外波段。EVI 表达式包括一个增益因子 $G$、两个气溶胶阻抗系数 $C_1$ 和 $C_2$，以及一个土壤调整项 $L$。EVI 的标准 MODIS 操作公式为：\n    $$\n    \\mathrm{EVI} = G \\times \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + C_1 R_{\\mathrm{Red}} - C_2 R_{\\mathrm{Blue}} + L}\n    $$\n    问题提供了标准的 MODIS 常数：$G=2.5$，$C_1=6$，$C_2=7.5$ 和 $L=1$。\n\n现在，我们为稀疏作物（田地 $\\mathrm{S}$）和裸土（田地 $\\mathrm{B}$）计算这三个指数的值。\n\n**给定反射率：**\n-   田地 $\\mathrm{S}$：$R_{\\mathrm{NIR,S}}=0.42$，$R_{\\mathrm{Red,S}}=0.15$，$R_{\\mathrm{Blue,S}}=0.07$。\n-   田地 $\\mathrm{B}$：$R_{\\mathrm{NIR,B}}=0.30$，$R_{\\mathrm{Red,B}}=0.22$，$R_{\\mathrm{Blue,B}}=0.19$。\n\n**田地 S（稀疏作物）的计算：**\n-   $\\mathrm{NDVI}_{\\mathrm{S}} = \\frac{0.42 - 0.15}{0.42 + 0.15} = \\frac{0.27}{0.57} \\approx 0.473684$\n-   $\\mathrm{SAVI}_{\\mathrm{S}} = \\frac{0.42 - 0.15}{0.42 + 0.15 + 0.5} (1+0.5) = \\frac{0.27}{1.07} \\times 1.5 \\approx 0.378505$\n-   $\\mathrm{EVI}_{\\mathrm{S}} = 2.5 \\times \\frac{0.42 - 0.15}{0.42 + (6 \\times 0.15) - (7.5 \\times 0.07) + 1} = 2.5 \\times \\frac{0.27}{0.42 + 0.90 - 0.525 + 1} = 2.5 \\times \\frac{0.27}{1.795} \\approx 0.376045$\n\n**田地 B（裸土）的计算：**\n-   $\\mathrm{NDVI}_{\\mathrm{B}} = \\frac{0.30 - 0.22}{0.30 + 0.22} = \\frac{0.08}{0.52} \\approx 0.153846$\n-   $\\mathrm{SAVI}_{\\mathrm{B}} = \\frac{0.30 - 0.22}{0.30 + 0.22 + 0.5} (1+0.5) = \\frac{0.08}{1.02} \\times 1.5 \\approx 0.117647$\n-   $\\mathrm{EVI}_{\\mathrm{B}} = 2.5 \\times \\frac{0.30 - 0.22}{0.30 + (6 \\times 0.22) - (7.5 \\times 0.19) + 1} = 2.5 \\times \\frac{0.08}{0.30 + 1.32 - 1.425 + 1} = 2.5 \\times \\frac{0.08}{1.195} \\approx 0.167364$\n\n最后，我们计算每个指数的绝对类间差异 $|I_{\\mathrm{S}} - I_{\\mathrm{B}}|$，以确定哪个指数能最好地区分这两个田地。\n-   $\\Delta_{\\mathrm{NDVI}} = |\\mathrm{NDVI}_{\\mathrm{S}} - \\mathrm{NDVI}_{\\mathrm{B}}| = |0.473684 - 0.153846| \\approx 0.319838$\n-   $\\Delta_{\\mathrm{SAVI}} = |\\mathrm{SAVI}_{\\mathrm{S}} - \\mathrm{SAVI}_{\\mathrm{B}}| = |0.378505 - 0.117647| \\approx 0.260858$\n-   $\\Delta_{\\mathrm{EVI}} = |\\mathrm{EVI}_{\\mathrm{S}} - \\mathrm{EVI}_{\\mathrm{B}}| = |0.376045 - 0.167364| \\approx 0.208681$\n\n比较这三个差异：\n$\\max(\\Delta_{\\mathrm{NDVI}}, \\Delta_{\\mathrm{SAVI}}, \\Delta_{\\mathrm{EVI}}) = \\max(0.319838, 0.260858, 0.208681) = 0.319838$。\n最大绝对差异由 NDVI 提供。问题要求将此值四舍五入至四位有效数字。\n$0.319838 \\approx 0.3198$。",
            "answer": "$$\\boxed{0.3198}$$"
        },
        {
            "introduction": "在任何真实的遥感分析中，不确定性都是不可避免的，而理解其影响对于确保科学严谨性至关重要。本实践将指导您通过蒙特卡洛模拟，量化大气校正参数中的不确定性如何通过作物分类工作流进行传播，并最终影响分类图的精度 。完成这项练习将为您提供一个强大的不确定性分析框架，并让您更深刻地理解分析结果的稳健性。",
            "id": "3803451",
            "problem": "您的任务是设计并实现一个完整、可运行的程序，该程序使用蒙特卡洛采样方法，将大气校正参数中的不确定性传播到一个监督式作物类型分类过程中，并报告地图精度的置信区间。该场景设定为用于农业监测的光学遥感。\n\n使用的基本原理：\n- 大气层顶反射率与地表反射率之间的线性化辐射传输关系模型为 $\\,\\rho^{\\mathrm{TOA}}_{b} = \\rho_{b}\\,T_{b} + \\rho^{\\mathrm{path}}_{b}\\,$，其中 $\\,\\rho^{\\mathrm{TOA}}_{b}\\,$ 是在波段 $\\,b\\,$ 测得的大气层顶反射率，$\\,\\rho_{b}\\,$ 是期望的地表反射率，$\\,T_{b}\\,$ 是波段 $\\,b\\,$ 的向下加向上大气透射率因子，$\\,\\rho^{\\mathrm{path}}_{b}\\,$ 是路径反射率贡献。对于中等气溶胶负载下的光学波段，此关系式是一个被广泛使用且科学上合理的简化模型。\n- 在具有共享协方差矩阵的多元正态类条件密度下的 Bayes 决策理论，这是一种在反射率特征空间中进行线性判别分类的有效且经过充分检验的模型。您必须使用与此假设一致的 Bayes 分类器，但不得假设任何绕过此基础推导的快捷公式。\n- 用于不确定性传播的蒙特卡洛采样。将大气参数视为具有给定分布的随机变量。生成独立样本，执行大气校正，进行分类，并计算地图精度的经验分布。\n\n您的程序必须从上述基本原理出发，实现以下内容：\n\n1. 大气校正。对于每次蒙特卡洛抽样，将大气参数 $\\,T_{R}\\,$, $\\,T_{N}\\,$, $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 和 $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 视为从指定分布中抽取的全景常量。对于每个像素 $\\,i\\,$ 和波段 $\\,b \\in \\{R,N\\}\\,$，使用物理上一致的反演公式 $\\,\\rho_{i,b} = (\\rho^{\\mathrm{TOA}}_{i,b} - \\rho^{\\mathrm{path}}_{b}) / T_{b}\\,$ 计算校正后的地表反射率，并通过裁剪将 $\\,\\rho_{i,b}\\,$ 约束在物理有效区间 $\\,[0,1]\\,$ 内。\n2. 分类。用二维特征向量 $\\,\\mathbf{x}_{i} = [\\rho_{i,R},\\,\\rho_{i,N}]^{\\top}\\,$ 表示每个像素。假设有三个作物类别，索引为 $\\,k \\in \\{0,1,2\\}\\,$，其类条件多元正态密度共享一个协方差矩阵。使用这些假设所隐含的 Bayes 分类器（类别先验概率如下所示）来标记每次蒙特卡洛抽样中的每个像素。\n3. 地图精度。对于每次蒙特卡洛抽样，计算总体精度 $\\,\\mathrm{OA}\\,$，即预测类别与所提供的地面真值标签相等的像素比例。在所有抽样中，报告 $\\,\\mathrm{OA}\\,$ 的经验 0.025 和 0.975 分位数，作为 95% 置信区间的下限和上限。将精度值表示为小数（例如，使用 0.92 而不是百分比）。反射率是一个无单位的分数，不需要物理单位。\n\n对所有测试用例使用以下固定的场景数据：\n- 像素数量 $\\,N = 12\\,$。\n- 波段：$\\,R\\,$ (红光) 和 $\\,N\\,$ (近红外)。\n- 测得的大气层顶反射率 $\\,\\rho^{\\mathrm{TOA}}_{i,R}\\,$ (对于 $\\,i=1,\\dots,12\\,$): $[\\,0.0938,\\,0.0902,\\,0.0965,\\,0.0920,\\,0.0749,\\,0.0722,\\,0.0767,\\,0.0740,\\,0.1091,\\,0.1127,\\,0.1073,\\,0.1109\\,]$。\n- 测得的大气层顶反射率 $\\,\\rho^{\\mathrm{TOA}}_{i,N}\\,$ (对于 $\\,i=1,\\dots,12\\,$): $[\\,0.4444,\\,0.43965,\\,0.4501,\\,0.43585,\\,0.5394,\\,0.5356,\\,0.54415,\\,0.53275,\\,0.3969,\\,0.3931,\\,0.39975,\\,0.39025\\,]$。\n- 地面真值作物类别标签 $\\,y_{i}\\,$ (对于 $\\,i=1,\\dots,12\\,$): $[\\,0,\\,0,\\,0,\\,0,\\,1,\\,1,\\,1,\\,1,\\,2,\\,2,\\,2,\\,2\\,]$。\n- 类别均值 $\\,\\boldsymbol{\\mu}_{0} = [\\,0.08,\\,0.45\\,]^{\\top}\\,$, $\\,\\boldsymbol{\\mu}_{1} = [\\,0.06,\\,0.55\\,]^{\\top}\\,$, $\\,\\boldsymbol{\\mu}_{2} = [\\,0.10,\\,0.40\\,]^{\\top}\\,$.\n- 共享协方差矩阵 $\\,\\boldsymbol{\\Sigma} = \\begin{bmatrix} 0.0004  0.0001 \\\\ 0.0001  0.0016 \\end{bmatrix}\\,$。这是对称且正定的。\n- 类别先验概率 $\\,\\pi_{0} = \\pi_{1} = \\pi_{2} = 1/3\\,$.\n\n蒙特卡洛采样细节：\n- 对于每个测试用例，从具有指定均值和标准差的正态分布中抽取 $\\,N_{s}\\,$ 个 $\\,T_{R}\\,$, $\\,T_{N}\\,$, $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 和 $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 的独立样本，然后将每次抽样裁剪到指定边界内以保持物理合理性。每次抽样都被视为全景范围的，并应用于该次抽样中的所有像素。\n- 为保证可复现性，使用随机种子 $\\,42\\,$。\n- 计算 $\\,\\mathrm{OA}\\,$ 值集合的经验 $\\,0.025\\,$ 和 $\\,0.975\\,$ 分位数。\n\n测试套件：\n为以下四组参数集提供结果，每组代表一个不同的大气情景：\n- 情况 $\\,1\\,$ (中等不确定性，典型气溶胶):\n  - $\\,T_{R}\\,$ 均值 $\\,0.90\\,$, 标准差 $\\,0.03\\,$.\n  - $\\,T_{N}\\,$ 均值 $\\,0.95\\,$, 标准差 $\\,0.02\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 均值 $\\,0.02\\,$, 标准差 $\\,0.005\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 均值 $\\,0.015\\,$, 标准差 $\\,0.005\\,$.\n  - 边界: $\\,T_{R}, T_{N}\\,$ 裁剪到 $[\\,0.70,\\,1.00\\,]$, $\\,\\rho^{\\mathrm{path}}_{R}, \\rho^{\\mathrm{path}}_{N}\\,$ 裁剪到 $[\\,0.0,\\,0.10\\,]$。\n  - $\\,N_{s} = 5000\\,$.\n- 情况 $\\,2\\,$ (更高的气溶胶负载和不确定性):\n  - $\\,T_{R}\\,$ 均值 $\\,0.85\\,$, 标准差 $\\,0.07\\,$.\n  - $\\,T_{N}\\,$ 均值 $\\,0.92\\,$, 标准差 $\\,0.05\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 均值 $\\,0.03\\,$, 标准差 $\\,0.01\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 均值 $\\,0.025\\,$, 标准差 $\\,0.01\\,$.\n  - 边界: $\\,T_{R}, T_{N}\\,$ 裁剪到 $[\\,0.60,\\,1.00\\,]$, $\\,\\rho^{\\mathrm{path}}_{R}, \\rho^{\\mathrm{path}}_{N}\\,$ 裁剪到 $[\\,0.0,\\,0.10\\,]$。\n  - $\\,N_{s} = 6000\\,$.\n- 情况 $\\,3\\,$ (低不确定性，特征明确的大气):\n  - $\\,T_{R}\\,$ 均值 $\\,0.90\\,$, 标准差 $\\,0.005\\,$.\n  - $\\,T_{N}\\,$ 均值 $\\,0.95\\,$, 标准差 $\\,0.005\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 均值 $\\,0.02\\,$, 标准差 $\\,0.001\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 均值 $\\,0.015\\,$, 标准差 $\\,0.001\\,$.\n  - 边界: $\\,T_{R}, T_{N}\\,$ 裁剪到 $[\\,0.80,\\,1.00\\,]$, $\\,\\rho^{\\mathrm{path}}_{R}, \\rho^{\\mathrm{path}}_{N}\\,$ 裁剪到 $[\\,0.0,\\,0.05\\,]$。\n  - $\\,N_{s} = 5000\\,$.\n- 情况 $\\,4\\,$ (非常晴朗的大气，路径反射率小但非零):\n  - $\\,T_{R}\\,$ 均值 $\\,0.98\\,$, 标准差 $\\,0.01\\,$.\n  - $\\,T_{N}\\,$ 均值 $\\,0.99\\,$, 标准差 $\\,0.01\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{R}\\,$ 均值 $\\,0.005\\,$, 标准差 $\\,0.003\\,$.\n  - $\\,\\rho^{\\mathrm{path}}_{N}\\,$ 均值 $\\,0.005\\,$, 标准差 $\\,0.003\\,$.\n  - 边界: $\\,T_{R}, T_{N}\\,$ 裁剪到 $[\\,0.85,\\,1.00\\,]$, $\\,\\rho^{\\mathrm{path}}_{R}, \\rho^{\\mathrm{path}}_{N}\\,$ 裁剪到 $[\\,0.0,\\,0.02\\,]$。\n  - $\\,N_{s} = 4000\\,$.\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素应为一个双元素列表 $[\\,\\text{lower},\\,\\text{upper}\\,]$，给出相应测试用例的 $\\,\\mathrm{OA}\\,$ 的经验 95% 置信区间的下限和上限。例如，您的输出必须类似于 $[[l_{1},u_{1}],[l_{2},u_{2}],[l_{3},u_{3}],[l_{4},u_{4}]]$，并用数值替换。",
            "solution": "用户提供了一个有效且定义明确的问题。\n\n该问题要求实现一个蒙特卡洛模拟，以将大气参数的不确定性通过遥感分析工作流进行传播。该工作流包括大气校正和随后的监督式作物类型分类。最终输出是总体分类精度的 95% 置信区间。解决方案被构建为一系列程序步骤，每一步都基于已确立的科学原理。\n\n首先，我们确定所提供的数据和参数。场景包含 $N=12$ 个像素，每个像素都有在两个光谱波段（红色 $R$ 和近红外 $N$）中测量的大气层顶反射率 $\\rho^{\\mathrm{TOA}}$。每个像素 $i$ 的地面真值类别标签 $y_i$ 是已知的。分类模型假设有三个作物类别（$k \\in \\{0,1,2\\}$），其类条件密度为二维多元正态分布 $p(\\mathbf{x}|C_k) \\sim \\mathcal{N}(\\boldsymbol{\\mu}_k, \\boldsymbol{\\Sigma})$，具有已知的均值 $\\boldsymbol{\\mu}_k$ 和一个共享的协方差矩阵 $\\boldsymbol{\\Sigma}$。类别先验概率 $\\pi_k$ 被给定为相等的，即 $\\pi_0 = \\pi_1 = \\pi_2 = 1/3$。\n\n总体流程如下：\n1. 对于 $N_s$ 次蒙特卡洛模拟中的每一次以及每种大气情景（测试用例），我们生成大气参数的随机样本。\n2. 在每次模拟中，使用这些参数对 $\\rho^{\\mathrm{TOA}}$ 数据进行大气校正，从而得到所有像素的地表反射率 $\\rho$。\n3. 然后，使用从给定的统计模型推导出的 Bayes 分类器对得到的地表反射率向量进行分类。\n4. 通过将预测标签与地面真值进行比较，计算分类图的总体精度（$\\mathrm{OA}$）。\n5. $N_s$ 个总体精度值的集合形成一个经验分布，从中计算 0.025 和 0.975 分位数，以构成 95% 置信区间。\n\n下面提供了详细的、分步的推导和程序纲要。\n\n步骤 1：大气参数的蒙特卡洛采样\n大气参数是透射率（$T_R$, $T_N$）和路径反射率（$\\rho^{\\mathrm{path}}_R$, $\\rho^{\\mathrm{path}}_N$）。对于每个测试用例和 $N_s$ 次模拟中的每一次，都会抽取一组这四个参数。问题规定，每个参数都从具有给定均值和标准差的正态分布中抽取，然后裁剪到指定的物理合理范围内。对于单次模拟运行 $s$，我们生成参数集 $\\{\\,T_{R}^{(s)}, T_{N}^{(s)}, \\rho^{\\mathrm{path},(s)}_{R}, \\rho^{\\mathrm{path},(s)}_{N}\\,\\}$。在该次模拟运行中，这组参数对所有像素都是恒定的。为保证每个测试用例的可复现性，随机数生成器以 42 为种子。\n\n步骤 2：大气校正\n大气层顶反射率 $\\rho^{\\mathrm{TOA}}_{b}$ 和地表反射率 $\\rho_{b}$ 之间的关系由线性化模型 $\\rho^{\\mathrm{TOA}}_{b} = \\rho_{b}\\,T_{b} + \\rho^{\\mathrm{path}}_{b}$ 给出。为了求得地表反射率，我们必须反演此方程。对于每次模拟 $s$、每个像素 $i$ 和每个波段 $b \\in \\{R, N\\}$，地表反射率计算如下：\n$$\n\\rho^{(s)}_{i,b} = \\frac{\\rho^{\\mathrm{TOA}}_{i,b} - \\rho^{\\mathrm{path},(s)}_{b}}{T^{(s)}_{b}}\n$$\n反射率是通量之比，物理上必须被约束在区间 $[0, 1]$ 内。因此，计算出的值 $\\rho^{(s)}_{i,b}$ 会被裁剪到此范围内。在模拟 $s$ 中，每个像素 $i$ 的校正后数据形成一个二维特征向量 $\\mathbf{x}^{(s)}_{i} = [\\rho^{(s)}_{i,R}, \\rho^{(s)}_{i,N}]^{\\top}$。\n\n步骤 3：贝叶斯分类\n每个像素向量 $\\mathbf{x}$ 到 $K=3$ 个类别之一的分类是使用 Bayes 决策规则进行的，该规则旨在最小化错分概率。该规则是分配使后验概率 $P(C_k | \\mathbf{x})$ 最大化的类别 $k$。\n$$\n\\hat{k} = \\arg\\max_{k \\in \\{0,1,2\\}} P(C_k | \\mathbf{x})\n$$\n根据 Bayes 定理，后验概率为 $P(C_k | \\mathbf{x}) = \\frac{p(\\mathbf{x} | C_k)P(C_k)}{p(\\mathbf{x})}$，其中 $p(\\mathbf{x} | C_k)$ 是类条件概率密度，$P(C_k) = \\pi_k$ 是类别先验概率，$p(\\mathbf{x})$ 是证据。由于 $p(\\mathbf{x})$ 对所有类别都相同，因此在最大化过程中可以忽略。最大化后验概率等价于最大化其对数：\n$$\n\\hat{k} = \\arg\\max_{k} \\left( \\ln p(\\mathbf{x} | C_k) + \\ln \\pi_k \\right)\n$$\n问题陈述了类条件密度是具有共享协方差矩阵 $\\boldsymbol{\\Sigma}$ 的多元正态分布：\n$$\np(\\mathbf{x} | C_k) = \\frac{1}{(2\\pi)^{d/2} |\\boldsymbol{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{x} - \\boldsymbol{\\mu}_k)^\\top \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x} - \\boldsymbol{\\mu}_k)\\right)\n$$\n其中 $d=2$ 是特征空间的维度。将此代入对数后验概率表达式，得到判别函数 $g_k(\\mathbf{x})$：\n$$\ng_k(\\mathbf{x}) = -\\frac{1}{2}\\ln\\left((2\\pi)^{d}|\\boldsymbol{\\Sigma}|\\right) - \\frac{1}{2} (\\mathbf{x} - \\boldsymbol{\\mu}_k)^\\top \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x} - \\boldsymbol{\\mu}_k) + \\ln \\pi_k\n$$\n在所有类别 $k$ 中都为常数的项可以从最大化中舍去。这些项包括 $-\\frac{1}{2}\\ln\\left((2\\pi)^{d}|\\boldsymbol{\\Sigma}|\\right)$。展开二次型：\n$$\ng_k(\\mathbf{x}) = -\\frac{1}{2} \\left( \\mathbf{x}^\\top\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} - 2\\mathbf{x}^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k + \\boldsymbol{\\mu}_k^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k \\right) + \\ln \\pi_k\n$$\n项 $-\\frac{1}{2}\\mathbf{x}^\\top\\boldsymbol{\\Sigma}^{-1}\\mathbf{x}$ 对所有类别也是共同的，可以舍去。这导出了一个简化的线性判别函数：\n$$\ng_k(\\mathbf{x}) = \\mathbf{x}^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k - \\frac{1}{2} \\boldsymbol{\\mu}_k^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k + \\ln \\pi_k\n$$\n此外，问题指定了相等的先验概率 $\\pi_k = 1/3$，所以项 $\\ln \\pi_k$ 也是常数，可以舍弃。最终的决策规则是将 $\\mathbf{x}$ 分类到使以下函数最大化的类别 $k$：\n$$\ng_k(\\mathbf{x}) = \\mathbf{x}^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k - \\frac{1}{2} \\boldsymbol{\\mu}_k^\\top\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_k\n$$\n对每个像素向量 $\\mathbf{x}^{(s)}_{i}$ 和每个类别 $k$ 计算该函数，得出预测标签 $\\hat{y}^{(s)}_{i} = \\arg\\max_k g_k(\\mathbf{x}^{(s)}_{i})$。\n\n步骤 4：总体精度计算\n对于每次蒙特卡洛模拟 $s$，总体精度 $\\mathrm{OA}^{(s)}$ 计算为正确分类的像素所占的比例。\n$$\n\\mathrm{OA}^{(s)} = \\frac{1}{N} \\sum_{i=1}^{N} I(\\hat{y}^{(s)}_{i} = y_i)\n$$\n其中 $N=12$ 是像素总数，$I(\\cdot)$ 是指示函数，如果其参数为真则为 1，否则为 0。\n\n步骤 5：置信区间估计\n在对给定的测试用例运行所有 $N_s$ 次模拟后，我们得到一组精度值 $\\{\\mathrm{OA}^{(1)}, \\mathrm{OA}^{(2)}, \\dots, \\mathrm{OA}^{(N_s)}\\}$。在给定的不确定性模型下，该集合代表了总体精度的经验概率分布。95% 置信区间通过找到该分布的经验 0.025 和 0.975 分位数来确定。这些分位数分别对应于置信区间的下限和上限。对问题陈述中指定的四个测试用例中的每一个重复整个过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Propagates atmospheric parameter uncertainties through a remote sensing\n    classification workflow using Monte Carlo simulation to find confidence\n    intervals on overall map accuracy.\n    \"\"\"\n\n    # --- Fixed Scene Data ---\n    N_pixels = 12\n    rho_toa_r = np.array([0.0938, 0.0902, 0.0965, 0.0920, 0.0749, 0.0722, 0.0767, 0.0740, 0.1091, 0.1127, 0.1073, 0.1109])\n    rho_toa_n = np.array([0.4444, 0.43965, 0.4501, 0.43585, 0.5394, 0.5356, 0.54415, 0.53275, 0.3969, 0.3931, 0.39975, 0.39025])\n    # Shape: (N_pixels, 2) for [R, N] bands\n    rho_toa = np.stack([rho_toa_r, rho_toa_n], axis=1)\n\n    y_true = np.array([0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2], dtype=int)\n\n    # --- Classifier Parameters ---\n    mus = np.array([\n        [0.08, 0.45],  # Class 0\n        [0.06, 0.55],  # Class 1\n        [0.10, 0.40]   # Class 2\n    ])\n    Sigma = np.array([\n        [0.0004, 0.0001],\n        [0.0001, 0.0016]\n    ])\n    # Priors are equal, so log(pi_k) term can be dropped from discriminant.\n\n    # --- Pre-calculate parts of the linear discriminant function ---\n    # g_k(x) = x^T @ Sigma^-1 @ mu_k - 0.5 * mu_k^T @ Sigma^-1 @ mu_k\n    # Let W = Sigma^-1 @ mu_k (shape 2x3)\n    # Let W0 = -0.5 * diag(mu_k^T @ Sigma^-1 @ mu_k) (shape 3,)\n    # scores = x @ W + W0\n    inv_Sigma = np.linalg.inv(Sigma)\n    W = mus @ inv_Sigma  # Shape (3, 2)\n    W0 = -0.5 * np.sum((mus @ inv_Sigma) * mus, axis=1) # Shape (3,)\n\n    # --- Test Suite ---\n    test_cases = [\n        # Case 1\n        {'Ns': 5000,\n         'params': {\n             'T_R': {'mean': 0.90, 'std': 0.03, 'clip': [0.70, 1.00]},\n             'T_N': {'mean': 0.95, 'std': 0.02, 'clip': [0.70, 1.00]},\n             'rho_path_R': {'mean': 0.02, 'std': 0.005, 'clip': [0.0, 0.10]},\n             'rho_path_N': {'mean': 0.015, 'std': 0.005, 'clip': [0.0, 0.10]}\n         }},\n        # Case 2\n        {'Ns': 6000,\n         'params': {\n             'T_R': {'mean': 0.85, 'std': 0.07, 'clip': [0.60, 1.00]},\n             'T_N': {'mean': 0.92, 'std': 0.05, 'clip': [0.60, 1.00]},\n             'rho_path_R': {'mean': 0.03, 'std': 0.01, 'clip': [0.0, 0.10]},\n             'rho_path_N': {'mean': 0.025, 'std': 0.01, 'clip': [0.0, 0.10]}\n         }},\n        # Case 3\n        {'Ns': 5000,\n         'params': {\n             'T_R': {'mean': 0.90, 'std': 0.005, 'clip': [0.80, 1.00]},\n             'T_N': {'mean': 0.95, 'std': 0.005, 'clip': [0.80, 1.00]},\n             'rho_path_R': {'mean': 0.02, 'std': 0.001, 'clip': [0.0, 0.05]},\n             'rho_path_N': {'mean': 0.015, 'std': 0.001, 'clip': [0.0, 0.05]}\n         }},\n        # Case 4\n        {'Ns': 4000,\n         'params': {\n             'T_R': {'mean': 0.98, 'std': 0.01, 'clip': [0.85, 1.00]},\n             'T_N': {'mean': 0.99, 'std': 0.01, 'clip': [0.85, 1.00]},\n             'rho_path_R': {'mean': 0.005, 'std': 0.003, 'clip': [0.0, 0.02]},\n             'rho_path_N': {'mean': 0.005, 'std': 0.003, 'clip': [0.0, 0.02]}\n         }}\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Ns = case['Ns']\n        params = case['params']\n        \n        #\n        # For reproducibility, reset seed for each independent case\n        #\n        rng = np.random.default_rng(42)\n\n        #_ --- Step 1: Monte Carlo Sampling of Atmospheric Parameters ---\n        # Draw Ns samples for each of the 4 parameters\n        T_R_samples = rng.normal(params['T_R']['mean'], params['T_R']['std'], Ns)\n        T_N_samples = rng.normal(params['T_N']['mean'], params['T_N']['std'], Ns)\n        rho_path_R_samples = rng.normal(params['rho_path_R']['mean'], params['rho_path_R']['std'], Ns)\n        rho_path_N_samples = rng.normal(params['rho_path_N']['mean'], params['rho_path_N']['std'], Ns)\n\n        # Clip samples to physically plausible bounds\n        T_R_samples = np.clip(T_R_samples, params['T_R']['clip'][0], params['T_R']['clip'][1])\n        T_N_samples = np.clip(T_N_samples, params['T_N']['clip'][0], params['T_N']['clip'][1])\n        rho_path_R_samples = np.clip(rho_path_R_samples, params['rho_path_R']['clip'][0], params['rho_path_R']['clip'][1])\n        rho_path_N_samples = np.clip(rho_path_N_samples, params['rho_path_N']['clip'][0], params['rho_path_N']['clip'][1])\n\n        # Reshape for broadcasting: (Ns, 1, 2)\n        T_samples = np.stack([T_R_samples, T_N_samples], axis=1)[:, np.newaxis, :]\n        rho_path_samples = np.stack([rho_path_R_samples, rho_path_N_samples], axis=1)[:, np.newaxis, :]\n        \n        # --- Step 2: Atmospheric Correction (Vectorized) ---\n        # rho_toa shape (1, N_pixels, 2) for broadcasting\n        # Result rho_surf_all shape (Ns, N_pixels, 2)\n        rho_surf_all = (rho_toa[np.newaxis, :, :] - rho_path_samples) / T_samples\n        rho_surf_all = np.clip(rho_surf_all, 0.0, 1.0)\n        \n        # --- Step 3: Bayesian Classification (Vectorized) ---\n        # rho_surf_all (Ns, 12, 2) @ W.T (2, 3) - scores_all (Ns, 12, 3)\n        # W0 (3,) is broadcast\n        scores_all = rho_surf_all @ W.T + W0\n        predicted_labels_all = np.argmax(scores_all, axis=2) # Shape (Ns, 12)\n        \n        # --- Step 4: Overall Accuracy Calculation (Vectorized) ---\n        # y_true (12,) is broadcast against predicted_labels_all (Ns, 12)\n        correct_classifications = (predicted_labels_all == y_true)\n        oa_samples = np.mean(correct_classifications, axis=1) # Shape (Ns,)\n\n        # --- Step 5: Confidence Interval Estimation ---\n        ci_bounds = np.quantile(oa_samples, [0.025, 0.975])\n        all_results.append(ci_bounds.tolist())\n\n    # Format the final output string exactly as specified\n    # e.g., \"[[l1,u1],[l2,u2]]\" with no spaces\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "有效的作物监测不仅关乎复杂的算法，也涉及明智的规划和资源管理。本练习要求您扮演项目经理的角色，解决一个地面实况数据收集中的优化资源分配问题 。通过运用约束优化的原理，您将学习如何以最佳方式分配有限的预算以实现信息增益的最大化，这是设计兼具成本效益和科学稳健性的遥感研究项目的关键技能。",
            "id": "3803455",
            "problem": "一个遥感团队正在利用从卫星观测中提取的多光谱反射率和合成孔径雷达（SAR）特征构建一个作物类型分类器，以支持作物健康监测，包括从归一化植被指数（NDVI）得出的叶面积指数等指标。该团队必须通过实地考察收集地面真实标签来校准分类器，这可以根据分配给各类田地的考察小时数来相应减少类别不确定性。共有三（$3$）个作物类别：一个稀有类别（$R$）、一个中等流行类别（$M$）和一个常见类别（$C$）。设 $n_{R}$、$n_{M}$ 和 $n_{C}$ 表示分配给每个类别的实地考察小时数的决策变量。由于空间分散性和访问难度，每考察小时的成本因类别而异：$c_{R} = 3$，$c_{M} = 2$，$c_{C} = 1$。总预算为 $B = 20$ 个成本单位。\n\n基于香农熵的基本定义 $H = -\\sum_{k} p_{k} \\ln(p_{k})$，以及额外的独立标记样本会以边际效益递减的方式减少参数不确定性的原理，假设分配 $n_{i}$ 考察小时所带来的预期信息增益（近似于类别 $i$ 的熵和错分不确定性的预期减少量）被建模为凹函数 $g_{i}(n_{i}) = w_{i} \\alpha_{i} \\ln\\!\\big(1 + \\beta_{i} n_{i}\\big)$，其中 $w_{i}$ 是反映稀有类别重要性的稀有性权重，$\\alpha_{i}$ 是信息量系数，$\\beta_{i}$ 是捕捉边际效益递减率的尺度因子。使用以下由作物制图领域的经验性先验研究证明的参数：对于稀有类别，$w_{R} = 5$，$\\alpha_{R} = 2$，$\\beta_{R} = 1$；对于中等类别，$w_{M} = 3$，$\\alpha_{M} = 1.5$，$\\beta_{M} = 1$；对于常见类别，$w_{C} = 1$，$\\alpha_{C} = 1$，$\\beta_{C} = 1$。\n\n建立在预算约束下最大化总预期信息增益的最优分配问题，并求解以小时为单位的最优连续分配 $(n_{R}, n_{M}, n_{C})$。您必须从第一性原理（对数的凹性、可行域的凸性以及约束优化的最优性条件）出发，并使用严谨的优化论证完整地推导出分配方案。以小时为单位表示最终分配。无需四舍五入。您的最终答案必须以单行矩阵 $\\big(n_{R} \\;\\; n_{M} \\;\\; n_{C}\\big)$ 的形式提供。",
            "solution": "问题陈述经评估有效。这是一个有科学依据、适定且客观的优化问题。所有必要的参数、函数和约束均已提供，从而可以得到一个唯一且有意义的解。该问题是一个经典的资源分配任务，构建于一个真实的遥感背景下，可以使用标准的约束优化方法来解决。\n\n问题是在预算约束下最大化总预期信息增益 $G$。决策变量是每个作物类别的实地考察小时数：$n_{R}$ 用于稀有类别，$n_{M}$ 用于中等流行类别，$n_{C}$ 用于常见类别。\n\n首先，我们建立优化问题。总信息增益是每个类别增益的总和：\n$$G(n_{R}, n_{M}, n_{C}) = g_{R}(n_{R}) + g_{M}(n_{M}) + g_{C}(n_{C})$$\n增益函数的具体形式为 $g_{i}(n_{i}) = w_{i} \\alpha_{i} \\ln(1 + \\beta_{i} n_{i})$。代入给定参数：\n- 对于类别 $R$：$w_{R}=5$，$\\alpha_{R}=2$，$\\beta_{R}=1$。因此，$g_{R}(n_{R}) = 5 \\times 2 \\times \\ln(1 + 1 \\cdot n_{R}) = 10 \\ln(1 + n_{R})$。\n- 对于类别 $M$：$w_{M}=3$，$\\alpha_{M}=1.5$，$\\beta_{M}=1$。因此，$g_{M}(n_{M}) = 3 \\times 1.5 \\times \\ln(1 + 1 \\cdot n_{M}) = 4.5 \\ln(1 + n_{M})$。\n- 对于类别 $C$：$w_{C}=1$，$\\alpha_{C}=1$，$\\beta_{C}=1$。因此，$g_{C}(n_{C}) = 1 \\times 1 \\times \\ln(1 + 1 \\cdot n_{C}) = \\ln(1 + n_{C})$。\n\n需要最大化的目标函数是：\n$$G(n_{R}, n_{M}, n_{C}) = 10 \\ln(1 + n_{R}) + 4.5 \\ln(1 + n_{M}) + \\ln(1 + n_{C})$$\n预算约束由总成本不超过总预算 $B=20$ 给出。每小时的成本为 $c_{R}=3$，$c_{M}=2$，$c_{C}=1$。因此，约束条件是：\n$$3n_{R} + 2n_{M} + n_{C} \\le 20$$\n此外，小时数不能为负，所以我们有非负约束：\n$$n_{R} \\ge 0, \\quad n_{M} \\ge 0, \\quad n_{C} \\ge 0$$\n\n目标函数 $G$ 是缩放对数函数的和。由于对数函数是严格凹函数，且缩放因子为正，因此目标函数 $G$ 是严格凹的。由线性不等式定义的可行域是一个凸集。在凸集上最大化一个严格凹函数，可以保证任何局部最大值都是唯一的全局最大值。\n\n信息增益函数 $g_i(n_i)$ 随 $n_i$ 严格递增。因此，为了最大化总增益，必须用完整个预算。预算约束将是激活的，即以等式形式满足：\n$$3n_{R} + 2n_{M} + n_{C} = 20$$\n我们使用拉格朗日乘数法来解决这个约束优化问题。拉格朗日函数 $\\mathcal{L}$ 是：\n$$\\mathcal{L}(n_{R}, n_{M}, n_{C}, \\lambda) = 10 \\ln(1 + n_{R}) + 4.5 \\ln(1 + n_{M}) + \\ln(1 + n_{C}) - \\lambda(3n_{R} + 2n_{M} + n_{C} - 20)$$\n我们寻求一个内部解，其中 $n_{R}, n_{M}, n_{C}  0$。Karush-Kuhn-Tucker (KKT) 条件要求拉格朗日函数对每个决策变量的偏导数为零：\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{R}} = \\frac{10}{1 + n_{R}} - 3\\lambda = 0 \\implies \\frac{10}{1 + n_{R}} = 3\\lambda$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{M}} = \\frac{4.5}{1 + n_{M}} - 2\\lambda = 0 \\implies \\frac{4.5}{1 + n_{M}} = 2\\lambda$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{C}} = \\frac{1}{1 + n_{C}} - \\lambda = 0 \\implies \\frac{1}{1 + n_{C}} = \\lambda$$\n拉格朗日乘数 $\\lambda$ 代表每单位预算的边际增益。在最优点，所有活动的单位成本边际增益 $\\frac{\\partial g_i / \\partial n_i}{c_i}$ 相等。\n从第三个方程，我们可以用 $n_{C}$ 来表示 $\\lambda$。由于 $g_C$ 是递增的，$\\lambda$ 必须为正。\n$$\\lambda = \\frac{1}{1 + n_{C}}$$\n将这个 $\\lambda$ 的表达式代入前两个方程，可以让我们用 $n_{C}$ 来表示 $n_{R}$ 和 $n_{M}$：\n对于 $n_{R}$：\n$$\\frac{10}{1 + n_{R}} = 3 \\left( \\frac{1}{1 + n_{C}} \\right) \\implies 10(1 + n_{C}) = 3(1 + n_{R}) \\implies 1 + n_{R} = \\frac{10}{3}(1 + n_{C})$$\n$$n_{R} = \\frac{10}{3}(1 + n_{C}) - 1$$\n对于 $n_{M}$：\n$$\\frac{4.5}{1 + n_{M}} = 2 \\left( \\frac{1}{1 + n_{C}} \\right) \\implies 4.5(1 + n_{C}) = 2(1 + n_{M}) \\implies 1 + n_{M} = \\frac{4.5}{2}(1 + n_{C}) = 2.25(1 + n_{C})$$\n$$n_{M} = 2.25(1 + n_{C}) - 1 = \\frac{9}{4}(1 + n_{C}) - 1$$\n现在，将 $n_{R}$ 和 $n_{M}$ 的这些表达式代入预算方程 $3n_{R} + 2n_{M} + n_{C} = 20$：\n$$3\\left[\\frac{10}{3}(1 + n_{C}) - 1\\right] + 2\\left[\\frac{9}{4}(1 + n_{C}) - 1\\right] + n_{C} = 20$$\n$$[10(1 + n_{C}) - 3] + \\left[\\frac{9}{2}(1 + n_{C}) - 2\\right] + n_{C} = 20$$\n$$10 + 10n_{C} - 3 + 4.5 + 4.5n_{C} - 2 + n_{C} = 20$$\n合并包含 $n_{C}$ 的项和常数项：\n$$(10 + 4.5 + 1)n_{C} + (10 - 3 + 4.5 - 2) = 20$$\n$$15.5 n_{C} + 9.5 = 20$$\n$$15.5 n_{C} = 10.5$$\n$$n_{C} = \\frac{10.5}{15.5} = \\frac{105}{155} = \\frac{21}{31}$$\n由于 $n_{C} = \\frac{21}{31}  0$，我们关于内部解的假设目前是有效的。现在我们可以求出 $n_{R}$ 和 $n_{M}$：\n$$1 + n_{C} = 1 + \\frac{21}{31} = \\frac{52}{31}$$\n对于 $n_{M}$：\n$$1 + n_{M} = 2.25(1 + n_{C}) = \\frac{9}{4}\\left(\\frac{52}{31}\\right) = \\frac{9 \\times 13}{31} = \\frac{117}{31}$$\n$$n_{M} = \\frac{117}{31} - 1 = \\frac{117 - 31}{31} = \\frac{86}{31}$$\n对于 $n_{R}$：\n$$1 + n_{R} = \\frac{10}{3}(1 + n_{C}) = \\frac{10}{3}\\left(\\frac{52}{31}\\right) = \\frac{520}{93}$$\n$$n_{R} = \\frac{520}{93} - 1 = \\frac{520 - 93}{93} = \\frac{427}{93}$$\n所有计算出的值都是正数，因此最优解是一个内点：\n$n_{R} = \\frac{427}{93}$，$n_{M} = \\frac{86}{31}$，$n_{C} = \\frac{21}{31}$。\n\n我们可以验证这个解满足预算约束：\n$$3\\left(\\frac{427}{93}\\right) + 2\\left(\\frac{86}{31}\\right) + \\frac{21}{31} = \\frac{427}{31} + \\frac{172}{31} + \\frac{21}{31} = \\frac{427+172+21}{31} = \\frac{620}{31} = 20$$\n预算约束被精确满足。最优连续分配为 $(n_{R}, n_{M}, n_{C}) = (\\frac{427}{93}, \\frac{86}{31}, \\frac{21}{31})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{427}{93}  \\frac{86}{31}  \\frac{21}{31} \\end{pmatrix}}$$"
        }
    ]
}