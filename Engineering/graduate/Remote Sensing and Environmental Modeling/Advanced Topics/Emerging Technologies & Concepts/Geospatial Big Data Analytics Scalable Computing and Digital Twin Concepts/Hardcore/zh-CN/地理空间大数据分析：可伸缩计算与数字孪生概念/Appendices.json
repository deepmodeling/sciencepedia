{
    "hands_on_practices": [
        {
            "introduction": "地理空间大数据系统，特别是那些为网络可视化而设计的系统，经常使用网络墨卡托投影 (Web Mercator projection)。虽然这种投影在无缝缩放和拼接地图瓦片方面非常方便，但它会引入巨大的面积畸变，尤其是在高纬度地区。这项实践将通过推导和计算局部面积比例因子来量化这种畸变，这对于在数字孪生中准确计算流域面积或土地覆盖统计等任务至关重要。",
            "id": "3816672",
            "problem": "一个全国范围的流域环境数字孪生系统部署在地理空间大数据管道上，该管道以Web墨卡托（Web Mercator）投影存储栅格瓦片，其投影由欧洲石油调查组织（European Petroleum Survey Group, EPSG）代码 $3857$ 标识。为了大规模计算流域统计数据，该管道目前使用基于瓦片像素计数的平面面积。为了校正这些统计数据，你需要量化高纬度地区小地物的局部面积夸大程度。\n\n假设地球为半径为 $R$ 的球体，并使用标准地理坐标 $(\\phi, \\lambda)$，其中 $\\phi$ 为大地纬度，$\\lambda$ 为经度。球面度规为\n$$\n\\mathrm{d}s^{2} = R^{2}\\left(\\mathrm{d}\\phi^{2} + \\cos^{2}\\!\\phi\\,\\mathrm{d}\\lambda^{2}\\right),\n$$\nWeb墨卡托（球面墨卡托）正向投影变换为\n$$\nx = R\\,\\lambda, \\qquad y = R\\,\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right).\n$$\n微积分计算中使用的所有角度均以弧度为单位。\n\n仅使用这些定义以及局部线性比例尺（即给定方向上投影后的微分距离与真实微分距离之比）的概念，首先确定Web墨卡托投影在纬度 $\\phi$ 处的通用局部线性比例因子 $k(\\phi)$（注意该投影为正形投影），然后推导出局部面积比例因子 $a(\\phi)$，其值为正交方向上线性比例尺的乘积。最后，计算在纬度 $\\phi = 60^\\circ$（相当于 $\\phi = \\pi/3$ 弧度）处的局部面积比例因子，并将其报告为一个无单位的纯数。无需四舍五入。在你的推理中，简要解释如果使用未经校正的 EPSG:3857 平面面积，这对数字孪生系统中高纬度小地物的面积测量意味着什么。",
            "solution": "我们从球面度规和Web墨卡托正向投影变换开始。对于沿子午线的运动（保持 $\\lambda$ 不变，即 $\\mathrm{d}\\lambda=0$），球面上的地面微分弧长为\n$$\n\\mathrm{d}s_{\\text{merid}} = R\\,|\\mathrm{d}\\phi|.\n$$\n对于沿纬线的东-西向运动（保持 $\\phi$ 不变，即 $\\mathrm{d}\\phi=0$），地面微分弧长为\n$$\n\\mathrm{d}s_{\\text{parallel}} = R\\,\\cos\\!\\phi\\,|\\mathrm{d}\\lambda|.\n$$\n\n在投影平面上，正向投影变换的微分为\n$$\n\\mathrm{d}x = R\\,\\mathrm{d}\\lambda, \\qquad \\mathrm{d}y = R\\,\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right)\\right]\\mathrm{d}\\phi.\n$$\n为了计算该导数，使用恒等式\n$$\n\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right) = \\frac{1+\\sin\\!\\phi}{\\cos\\!\\phi},\n$$\n从而有\n$$\n\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right) = \\ln\\!\\big(1+\\sin\\!\\phi\\big) - \\ln\\!\\big(\\cos\\!\\phi\\big).\n$$\n对 $\\phi$ （角度以弧度为单位）求导，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\big(1+\\sin\\!\\phi\\big) - \\ln\\!\\big(\\cos\\!\\phi\\big)\\right] = \\frac{\\cos\\!\\phi}{1+\\sin\\!\\phi} + \\tan\\!\\phi.\n$$\n将右侧通分以进行化简：\n$$\n\\frac{\\cos\\!\\phi}{1+\\sin\\!\\phi} + \\frac{\\sin\\!\\phi}{\\cos\\!\\phi} = \\frac{\\cos^{2}\\!\\phi + \\sin\\!\\phi\\,(1+\\sin\\!\\phi)}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{\\cos^{2}\\!\\phi + \\sin\\!\\phi + \\sin^{2}\\!\\phi}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{1+\\sin\\!\\phi}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{1}{\\cos\\!\\phi}.\n$$\n因此，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right)\\right] = \\sec\\!\\phi,\n$$\n进而\n$$\n\\mathrm{d}y = R\\,\\sec\\!\\phi\\,\\mathrm{d}\\phi.\n$$\n\n现在，我们计算正交方向上的局部线性比例因子，即投影后的微分与真实微分之比。\n\n在子午线方向上，\n$$\nk_{\\text{merid}}(\\phi) = \\frac{|\\mathrm{d}y|}{\\mathrm{d}s_{\\text{merid}}} = \\frac{R\\,\\sec\\!\\phi\\,|\\mathrm{d}\\phi|}{R\\,|\\mathrm{d}\\phi|} = \\sec\\!\\phi.\n$$\n\n在纬线（东-西）方向上，\n$$\nk_{\\text{parallel}}(\\phi) = \\frac{|\\mathrm{d}x|}{\\mathrm{d}s_{\\text{parallel}}} = \\frac{R\\,|\\mathrm{d}\\lambda|}{R\\,\\cos\\!\\phi\\,|\\mathrm{d}\\lambda|} = \\sec\\!\\phi.\n$$\n\n由于墨卡托投影是正形投影，局部线性比例尺是各向同性的，因此通用的局部线性比例因子为\n$$\nk(\\phi) = \\sec\\!\\phi.\n$$\n\n局部面积比例因子 $a(\\phi)$ 是正交方向上线性比例尺的乘积，\n$$\na(\\phi) = k_{\\text{merid}}(\\phi)\\,k_{\\text{parallel}}(\\phi) = \\big(\\sec\\!\\phi\\big)^{2} = \\sec^{2}\\!\\phi.\n$$\n\n在纬度 $\\phi = 60^\\circ = \\pi/3$ 弧度处进行计算。利用 $\\cos\\!\\left(\\pi/3\\right) = \\frac{1}{2}$，我们得到\n$$\n\\sec\\!\\left(\\frac{\\pi}{3}\\right) = 2 \\quad \\Longrightarrow \\quad a\\!\\left(\\frac{\\pi}{3}\\right) = \\big(2\\big)^{2} = 4.\n$$\n\n在数字孪生背景下的解释：对于中心位于纬度 $\\phi=60^\\circ$ 的小地物，直接在 EPSG:3857 瓦片上测量的平面面积相对于其在球面上的真实表面积被夸大了4倍。因此，对于高纬度流域，未经校正的、基于面积的统计数据在 $\\phi=60^\\circ$ 附近将有高达4倍的正向偏差。在大规模应用中，地理空间大数据管道要么应对像素面积应用 $1/a(\\phi) = \\cos^{2}\\!\\phi$ 的权重，要么在等面积投影中执行计算，以获得无偏差的面积估算。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "数字孪生中的物理过程模拟，如洪水淹没，依赖于精确的地形高程数据。然而，源自全球导航卫星系统 (Global Navigation Satellite System, GNSS) 和激光雷达 (Light Detection and Ranging, LiDAR) 的高程通常是基于几何椭球体的椭球高 ($h$)，而水流等重力驱动过程遵循的是与平均海平面近似的大地水准面。此练习将演示如何将椭球高转换为物理意义上更准确的正高 ($H$)，这是确保水文模型可靠性的基础步骤。",
            "id": "3816651",
            "problem": "一个国家级水文数字孪生（DT）集成了从参考于1984年世界大地坐标系（WGS84）椭球体的全球导航卫星系统（GNSS）测量中获得的光探测和测距（LiDAR）高程数据，并且必须将其转换为参考于大地水准面的正高，以用于洪水建模。考虑一个位于沿海洪泛区的单点，其椭球高为 $h=100.0$，由2008年地球引力场模型（EGM2008）提供的当地大地水准面起伏为 $N=-28.5$。仅使用核心的大地测量学定义，即 (i) 椭球高是点在参考椭球体上方的高度，(ii) 正高是点在大地水准面上方的高度，以及 (iii) 大地水准面起伏是该点处大地水准面与椭球体之间的带符号间距（当大地水准面位于椭球体之上时为正），推导与这些定义一致的 $h$、$H$ 和 $N$ 之间的关系，并计算该点的正高 $H$。用两句话总结，在处理 $10^{9}$ 个点的高性能计算（HPC）环境下的地理空间大数据管道中，为何将高程转换为正高对于洪水淹没建模至关重要。以米为单位表示最终的正高，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导椭球高（$h$）、正高（$H$）和大地水准面起伏（$N$）之间的关系，然后进行计算并简要解释其相关性。我们将使用所提供的定义来建立这种关系。\n\n让我们将地球表面的一个点表示为 $P$。\n设参考椭球体为一个数学旋转曲面，$S_{E}$。\n设大地水准面为地球引力场的一个等势面，它近似于平均海平面，$S_{G}$。\n\n根据定义 (i)，椭球高 $h$ 是从 $S_{E}$ 到 $P$ 的距离，沿椭球体的法线测量。\n根据定义 (ii)，正高 $H$ 是从 $S_{G}$ 到 $P$ 的距离，沿铅垂线测量。\n根据定义 (iii)，大地水准面起伏 $N$ 是从 $S_{E}$ 到 $S_{G}$ 的距离。符号约定至关重要：如果 $S_{G}$ 在 $S_{E}$ 之上，则 $N$ 为正；如果 $S_{G}$ 在 $S_{E}$ 之下，则 $N$ 为负。\n\n在此背景下的实际应用中，椭球法线和铅垂线可以被认为是共线的。点 $P$ 在椭球体上方的高度 $h$ 可以沿此线在几何上分解为两段：大地水准面 $S_{G}$ 在椭球体 $S_{E}$ 上方的高度（即 $N$），以及点 $P$ 在大地水准面 $S_{G}$ 上方的高度（即 $H$）。\n\n因此，总高度 $h$ 是 $H$ 和 $N$ 的和。这给出了基本的大地测量关系式：\n$$h = H + N$$\n\n为了计算正高 $H$，我们重排这个方程：\n$$H = h - N$$\n\n现在，我们将给定的值代入这个方程。\n椭球高为 $h = 100.0$ 米。\n大地水准面起伏为 $N = -28.5$ 米。\n\n$N$ 的负号表示，在这个特定位置，大地水准面位于WGS84椭球体表面以下 $28.5$ 米。\n\n代入数值：\n$$H = 100.0 - (-28.5)$$\n$$H = 100.0 + 28.5$$\n$$H = 128.5$$\n\n得到的正高为 $H = 128.5$ 米。题目要求答案四舍五入到四位有效数字。计算值 $128.5$ 已经恰好是四位有效数字。\n\n最后，问题要求总结为何在大规模数据处理背景下，这种转换为洪水建模非常重要。\n转换为正高至关重要，因为水流受重力控制，这意味着它遵循大地水准面（一个近似于平均海平面的等势面）的轮廓，而不是几何定义的椭球体。在处理 $10^{9}$ 个点的大数据背景下，在高性能计算（HPC）管道内自动化这种大地测量校正，可确保海量的LiDAR数据集能够一致地参考到这个具有物理意义的垂直基准，这对于在数字孪生中进行精确的大规模洪水淹没模拟至关重要。",
            "answer": "$$\\boxed{128.5}$$"
        },
        {
            "introduction": "在处理海量遥感数据时，通过聚合像素进行重采样是降低数据量和统一空间分辨率的常用技术。然而，这个过程会改变数据的不确定性，而忽略原始像素之间的空间相关性会导致严重低估聚合后数据的不确定性。本练习通过一个具体的例子来探讨这一问题，量化空间相关性如何影响重采样后数据方差的变化，这对于在数字孪生中进行可靠的不确定性传播至关重要。",
            "id": "3816731",
            "problem": "一个用于流域能量平衡的云原生数字孪生 (DT) 以公里级分辨率运行，并同化来自卫星星座的陆地表面温度数据。为减少地理空间大数据管道中的数据量和延迟，该系统通过算术平均法将每个 $3 \\times 3$ 的原始像素块聚合成一个更粗糙的像素，从而对原始分辨率的反演数据进行重采样。设给定块中像素 $i$ 的反演误差为一个零均值随机变量 $X_i$，其共同方差为 $\\operatorname{Var}(X_i)=\\sigma^{2}$。考虑一个块内 $n=9$ 个像素的两种误差结构：\n1. 独立性：对于 $i \\neq j$，$\\operatorname{Cov}(X_i,X_j)=0$。\n2. 等相关空间依赖性：对于所有 $i \\neq j$，$\\operatorname{Corr}(X_i,X_j)=\\rho$，其中 $\\rho=0.3$（假设由于短程各向同性相关，这在 $3 \\times 3$ 块内是一个有效的近似）。\n\n该数字孪生的不确定性传播模块将块平均值 $\\,\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_i\\,$ 的方差作为重采样后不确定性的度量。仅从方差、协方差的定义以及随机变量线性组合下的方差性质出发，推导以下比率\n$$R \\equiv \\frac{\\text{在等相关（}\\rho=0.3\\text{）情况下的}\\operatorname{Var}(\\bar{X})}{\\text{在独立情况下的}\\operatorname{Var}(\\bar{X})}$$\n其中 $n=9$。将 $R$ 报告为一个纯数，四舍五入到四位有效数字。不要包含任何单位。",
            "solution": "该问题要求计算在两种不同相关结构下样本均值方差的比率。我们从方差的基本性质开始。\n\n设块平均值定义为 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n}X_i$，其中 $n=9$。\n随机变量线性组合 $Y = \\sum_{i=1}^{n} a_i X_i$ 的方差由下式给出：\n$$ \\operatorname{Var}(Y) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} a_i X_i\\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} a_i a_j \\operatorname{Cov}(X_i, X_j) $$\n对于样本均值 $\\bar{X}$，所有系数为 $a_i = \\frac{1}{n}$（$i=1, \\dots, n$）。将此代入通用公式：\n$$ \\operatorname{Var}(\\bar{X}) = \\operatorname{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} X_i\\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\left(\\frac{1}{n}\\right)\\left(\\frac{1}{n}\\right) \\operatorname{Cov}(X_i, X_j) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\operatorname{Cov}(X_i, X_j) $$\n我们可以将双重求和分解为 $i=j$ 的项（方差项）和 $i \\neq j$ 的项（协方差项）。\n$$ \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\operatorname{Cov}(X_i, X_j) = \\sum_{i=1}^{n} \\operatorname{Cov}(X_i, X_i) + \\sum_{i \\neq j} \\operatorname{Cov}(X_i, X_j) $$\n根据定义，$\\operatorname{Cov}(X_i, X_i) = \\operatorname{Var}(X_i)$。已知对于所有 $i$，$\\operatorname{Var}(X_i) = \\sigma^2$。第一个求和中有 $n$ 个相同的项。\n$$ \\sum_{i=1}^{n} \\operatorname{Var}(X_i) = \\sum_{i=1}^{n} \\sigma^2 = n\\sigma^2 $$\n第二个求和包含所有非对角协方差项。总共有 $n^2$ 对索引 $(i,j)$，其中有 $n$ 对满足 $i=j$。因此，有 $n^2-n = n(n-1)$ 对满足 $i \\neq j$。\n代回到 $\\operatorname{Var}(\\bar{X})$ 的表达式中：\n$$ \\operatorname{Var}(\\bar{X}) = \\frac{1}{n^2} \\left( n\\sigma^2 + \\sum_{i \\neq j} \\operatorname{Cov}(X_i, X_j) \\right) $$\n这个通用公式将用于分析指定的两种情况。\n\n**情况 1：独立性**\n在像素误差之间相互独立的假设下，任何不同像素对之间的协方差为零。\n$$ \\operatorname{Cov}(X_i, X_j) = 0 \\quad \\text{for } i \\neq j $$\n协方差项之和为零：\n$$ \\sum_{i \\neq j} \\operatorname{Cov}(X_i, X_j) = 0 $$\n将此结果代入我们关于 $\\operatorname{Var}(\\bar{X})$ 的通用公式，得到独立情况下的方差，我们将其表示为 $\\operatorname{Var}(\\bar{X})_{\\text{indep}}$：\n$$ \\operatorname{Var}(\\bar{X})_{\\text{indep}} = \\frac{1}{n^2} (n\\sigma^2 + 0) = \\frac{n\\sigma^2}{n^2} = \\frac{\\sigma^2}{n} $$\n\n**情况 2：等相关空间依赖性**\n在这种情况下，任何两个不同像素误差之间的相关性是一个常数 $\\rho$。\n$$ \\operatorname{Corr}(X_i, X_j) = \\rho = 0.3 \\quad \\text{for } i \\neq j $$\n相关的基本定义是 $\\operatorname{Corr}(X_i, X_j) = \\frac{\\operatorname{Cov}(X_i, X_j)}{\\sqrt{\\operatorname{Var}(X_i)\\operatorname{Var}(X_j)}}$。\n由于所有像素的 $\\operatorname{Var}(X_i) = \\sigma^2$，我们可以写出：\n$$ \\rho = \\frac{\\operatorname{Cov}(X_i, X_j)}{\\sqrt{\\sigma^2 \\cdot \\sigma^2}} = \\frac{\\operatorname{Cov}(X_i, X_j)}{\\sigma^2} $$\n由此，我们求出任何不同像素对的协方差：\n$$ \\operatorname{Cov}(X_i, X_j) = \\rho \\sigma^2 \\quad \\text{for } i \\neq j $$\n现在我们计算所有 $n(n-1)$ 个此类协方差项的总和：\n$$ \\sum_{i \\neq j} \\operatorname{Cov}(X_i, X_j) = \\sum_{i \\neq j} \\rho \\sigma^2 = n(n-1)\\rho \\sigma^2 $$\n将此结果代入我们关于 $\\operatorname{Var}(\\bar{X})$ 的通用公式，得到等相关情况下的方差，表示为 $\\operatorname{Var}(\\bar{X})_{\\text{equicorr}}$：\n$$ \\operatorname{Var}(\\bar{X})_{\\text{equicorr}} = \\frac{1}{n^2} \\left[ n\\sigma^2 + n(n-1)\\rho \\sigma^2 \\right] $$\n我们可以从方括号中的项中提出因子 $n\\sigma^2$：\n$$ \\operatorname{Var}(\\bar{X})_{\\text{equicorr}} = \\frac{n\\sigma^2}{n^2} \\left[ 1 + (n-1)\\rho \\right] = \\frac{\\sigma^2}{n} \\left[ 1 + (n-1)\\rho \\right] $$\n\n**比率 R 的推导**\n问题要求计算比率 $R$：\n$$ R = \\frac{\\operatorname{Var}(\\bar{X})_{\\text{equicorr}}}{\\operatorname{Var}(\\bar{X})_{\\text{indep}}} $$\n代入上面推导出的表达式：\n$$ R = \\frac{\\frac{\\sigma^2}{n} \\left[ 1 + (n-1)\\rho \\right]}{\\frac{\\sigma^2}{n}} $$\n项 $\\frac{\\sigma^2}{n}$ 被消去，留下一个关于 $R$ 的简单表达式：\n$$ R = 1 + (n-1)\\rho $$\n这个表达式有时被称为由相关性引起的方差膨胀因子。\n\n**最终计算**\n我们已知数值 $n=9$（来自 $3 \\times 3$ 块）和 $\\rho=0.3$。我们将这些值代入我们推导出的 $R$ 的公式中。\n$$ R = 1 + (9-1)(0.3) $$\n$$ R = 1 + (8)(0.3) $$\n$$ R = 1 + 2.4 $$\n$$ R = 3.4 $$\n问题要求答案四舍五入到四位有效数字。为了将 $3.4$ 表示为四位有效数字，我们将其写为 $3.400$。",
            "answer": "$$\\boxed{3.400}$$"
        }
    ]
}