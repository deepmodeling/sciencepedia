{
    "hands_on_practices": [
        {
            "introduction": "辐射传输模型依赖于像HITRAN这样的光谱数据库，这些数据库为无数吸收谱线提供了基本参数。本练习是一项基础实践，旨在应用这些参数来计算在特定大气温度和压力条件下谱线的吸收截面。掌握这种计算对于精确模拟大气透射至关重要。",
            "id": "3796319",
            "problem": "在近红外区观测到一条孤立的水蒸气转振吸收谱线。谱线中心波数为 $\\tilde{\\nu}_0 = 7225.37\\ \\mathrm{cm}^{-1}$，低能态能量为 $E'' = 550.0\\ \\mathrm{cm}^{-1}$，参考温度 $T_0 = 296\\ \\mathrm{K}$ 时，来自高分辨率透射分子吸收光谱数据库 (HITRAN) 的谱线强度为 $S_0 = 1.25 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}$。$T_0$ 下的空气展宽半高半宽为 $\\gamma_{\\mathrm{air},0} = 7.0 \\times 10^{-2}\\ \\mathrm{cm}^{-1}\\, \\mathrm{atm}^{-1}$，温度指数 $n = 0.75$。忽略自展宽。第二辐射常数为 $c_2 = h c / k_B = 1.4387769\\ \\mathrm{cm \\cdot K}$。总压强为 $P = 0.60\\ \\mathrm{atm}$，温度为 $T = 250\\ \\mathrm{K}$。内部分配函数的值为 $Q(T_0) = 174.6$ 和 $Q(T) = 129.3$。\n\n从吸收截面与谱线强度和归一化线型的关系这一第一性原理出发，利用低能态玻尔兹曼布居和分配函数，通过受激发射修正将 $S(T)$ 与 $S_0$ 联系起来，并假设在给定条件下谱线为纯粹的碰撞展宽洛伦兹线型。推导谱线中心吸收截面 $\\sigma_{\\tilde{\\nu}_0}$ 的表达式，并计算其在给定 $T$ 和 $P$ 下的数值。将您的答案四舍五入到四位有效数字。以 $\\mathrm{cm^2\\, molecule^{-1}}$ 为单位表示最终的吸收截面。",
            "solution": "用户要求我解决以下问题：\n在近红外区观测到一条孤立的水蒸气转振吸收谱线。谱线中心波数为 $\\tilde{\\nu}_0 = 7225.37\\ \\mathrm{cm}^{-1}$，低能态能量为 $E'' = 550.0\\ \\mathrm{cm}^{-1}$，参考温度 $T_0 = 296\\ \\mathrm{K}$ 时，来自高分辨率透射分子吸收光谱数据库 (HITRAN) 的谱线强度为 $S_0 = 1.25 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}$。$T_0$ 下的空气展宽半高半宽为 $\\gamma_{\\mathrm{air},0} = 7.0 \\times 10^{-2}\\ \\mathrm{cm}^{-1}\\, \\mathrm{atm}^{-1}$，温度指数 $n = 0.75$。忽略自展宽。第二辐射常数为 $c_2 = h c / k_B = 1.4387769\\ \\mathrm{cm \\cdot K}$。总压强为 $P = 0.60\\ \\mathrm{atm}$，温度为 $T = 250\\ \\mathrm{K}$。内部分配函数的值为 $Q(T_0) = 174.6$ 和 $Q(T) = 129.3$。\n\n从吸收截面与谱线强度和归一化线型的关系这一第一性原理出发，利用低能态玻尔兹曼布居和分配函数，通过受激发射修正将 $S(T)$ 与 $S_0$ 联系起来，并假设在给定条件下谱线为纯粹的碰撞展宽洛伦兹线型。推导谱线中心吸收截面 $\\sigma_{\\tilde{\\nu}_0}$ 的表达式，并计算其在给定 $T$ 和 $P$ 下的数值。将您的答案四舍五入到四位有效数字。以 $\\mathrm{cm^2\\, molecule^{-1}}$ 为单位表示最终的吸收截面。\n\n### 步骤 1：提取已知条件\n- 谱线中心波数：$\\tilde{\\nu}_0 = 7225.37\\ \\mathrm{cm}^{-1}$\n- 低能态能量：$E'' = 550.0\\ \\mathrm{cm}^{-1}$\n- 参考谱线强度：$S_0 = 1.25 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}$\n- 参考温度：$T_0 = 296\\ \\mathrm{K}$\n- 参考空气展宽半高半宽：$\\gamma_{\\mathrm{air},0} = 7.0 \\times 10^{-2}\\ \\mathrm{cm}^{-1}\\, \\mathrm{atm}^{-1}$\n- 展宽温度指数：$n = 0.75$\n- 第二辐射常数：$c_2 = 1.4387769\\ \\mathrm{cm \\cdot K}$\n- 总压强：$P = 0.60\\ \\mathrm{atm}$\n- 环境温度：$T = 250\\ \\mathrm{K}$\n- 参考分配函数：$Q(T_0) = 174.6$\n- 环境分配函数：$Q(T) = 129.3$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它展示了大气物理学和分子光谱学中的一个标准计算，使用了公认的原理和关系。各物理量及其数值均符合物理实际。该问题要求在单条吸收谱线的背景下应用比尔-朗伯定律，涉及谱线强度和线型的温度与压力修正，这些都是该领域的基本概念。使用 HITRAN 数据库的参数是标准做法。问题是自洽的，提供了所有必要的数据。不存在矛盾、歧义或违反科学原理之处。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行完整解答。\n\n单个分子的吸收截面 $\\sigma(\\tilde{\\nu})$ 是波数 $\\tilde{\\nu}$ 的函数，定义为谱线强度 $S(T)$ 与归一化线型函数 $f(\\tilde{\\nu} - \\tilde{\\nu}_0)$ 的乘积。\n$$\n\\sigma(\\tilde{\\nu}) = S(T) f(\\tilde{\\nu} - \\tilde{\\nu}_0)\n$$\n$\\sigma$ 的单位是 $\\mathrm{cm}^2\\,\\mathrm{molecule}^{-1}$，$S(T)$ 的单位是 $\\mathrm{cm}\\,\\mathrm{molecule}^{-1}$，$f(\\tilde{\\nu} - \\tilde{\\nu}_0)$ 的单位是 $\\mathrm{cm}$。线型函数是归一化的，满足 $\\int_{-\\infty}^{\\infty} f(\\tilde{\\nu} - \\tilde{\\nu}_0) d\\tilde{\\nu} = 1$。\n\n问题指定了纯粹的碰撞展宽（洛伦兹）线型。归一化的洛伦兹线型函数由下式给出：\n$$\nf(\\tilde{\\nu} - \\tilde{\\nu}_0) = \\frac{1}{\\pi} \\frac{\\gamma_L}{(\\tilde{\\nu} - \\tilde{\\nu}_0)^2 + \\gamma_L^2}\n$$\n其中 $\\gamma_L$ 是在给定压强 $P$ 和温度 $T$ 下的洛伦兹半高半宽 (HWHM)，单位为 $\\mathrm{cm}^{-1}$。\n\n我们需要求出谱线中心（即 $\\tilde{\\nu} = \\tilde{\\nu}_0$）处的吸收截面。在这一点，线型函数达到其最大值：\n$$\nf(0) = \\frac{1}{\\pi} \\frac{\\gamma_L}{(0)^2 + \\gamma_L^2} = \\frac{1}{\\pi \\gamma_L}\n$$\n因此，谱线中心处的吸收截面 $\\sigma_{\\tilde{\\nu}_0}$ 为：\n$$\n\\sigma_{\\tilde{\\nu}_0} = S(T) f(0) = \\frac{S(T)}{\\pi \\gamma_L}\n$$\n为了计算这个值，我们必须首先确定在指定温度 $T = 250\\ \\mathrm{K}$ 和压强 $P = 0.60\\ \\mathrm{atm}$ 下的谱线强度 $S(T)$ 和洛伦兹半宽 $\\gamma_L$。\n\n首先，我们计算洛伦兹半宽 $\\gamma_L$。它依赖于参考半宽 $\\gamma_{\\mathrm{air},0}$、压强 $P$ 和温度 $T$，其关系如下：\n$$\n\\gamma_L(P, T) = \\gamma_{\\mathrm{air},0} P \\left(\\frac{T_0}{T}\\right)^n\n$$\n代入给定值：\n$$\n\\gamma_L = (7.0 \\times 10^{-2}\\ \\mathrm{cm}^{-1}\\, \\mathrm{atm}^{-1}) (0.60\\ \\mathrm{atm}) \\left(\\frac{296\\ \\mathrm{K}}{250\\ \\mathrm{K}}\\right)^{0.75}\n$$\n$$\n\\gamma_L = (0.042\\ \\mathrm{cm}^{-1}) (1.184)^{0.75} \\approx 0.042 \\times 1.13560 = 0.0476952\\ \\mathrm{cm}^{-1}\n$$\n\n接下来，我们计算谱线强度 $S(T)$。从参考温度 $T_0$ 下的参考强度 $S_0$ 进行温度定标，其标准公式考虑了通过分配函数引起的转动和振动布居数的变化，通过玻尔兹曼因子引起的低能态布居数的变化，以及对受激发射的修正。\n$$\nS(T) = S_0 \\frac{Q(T_0)}{Q(T)} \\frac{\\exp\\left(-\\frac{c_2 E''}{T}\\right)}{\\exp\\left(-\\frac{c_2 E''}{T_0}\\right)} \\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_0}\\right)}\n$$\n这可以重写为：\n$$\nS(T) = S_0 \\frac{Q(T_0)}{Q(T)} \\exp\\left[-c_2 E''\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)\\right] \\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_0}\\right)}\n$$\n我们来计算各项。低能态布居数的指数项为：\n$$\nc_2 E''\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) = (1.4387769\\ \\mathrm{cm \\cdot K})(550.0\\ \\mathrm{cm}^{-1})\\left(\\frac{1}{250\\ \\mathrm{K}} - \\frac{1}{296\\ \\mathrm{K}}\\right)\n$$\n$$\n= (791.327\\dots)\\left(0.004 - 0.003378\\dots\\right)\\ \\mathrm{K}^{-1} \\cdot \\mathrm{K} = (791.327\\dots)(0.0006216\\dots) \\approx 0.491920\n$$\n所以，布居因子为 $\\exp(-0.491920) \\approx 0.611463$。\n\n现在计算受激发射修正因子：\n温度 $T$ 下指数的宗量是：\n$$\n\\frac{c_2 \\tilde{\\nu}_0}{T} = \\frac{(1.4387769\\ \\mathrm{cm \\cdot K})(7225.37\\ \\mathrm{cm}^{-1})}{250\\ \\mathrm{K}} \\approx 41.5828\n$$\n温度 $T_0$ 下指数的宗量是：\n$$\n\\frac{c_2 \\tilde{\\nu}_0}{T_0} = \\frac{(1.4387769\\ \\mathrm{cm \\cdot K})(7225.37\\ \\mathrm{cm}^{-1})}{296\\ \\mathrm{K}} \\approx 35.1206\n$$\n项 $\\exp(-41.5828)$ 和 $\\exp(-35.1206)$ 极小，分别约为 $10^{-19}$ 和 $10^{-16}$。因此，受激发射修正因子 $\\frac{1 - \\exp(-41.5828)}{1 - \\exp(-35.1206)}$ 在很高的精度上与 $1$ 没有区别。\n\n现在我们可以计算 $S(T)$：\n$$\nS(T) = (1.25 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}) \\left(\\frac{174.6}{129.3}\\right) (0.611463) (1)\n$$\n$$\nS(T) \\approx (1.25 \\times 10^{-23}) (1.350348) (0.611463) \\approx 1.03350 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}\n$$\n\n最后，我们计算谱线中心处的吸收截面 $\\sigma_{\\tilde{\\nu}_0}$：\n$$\n\\sigma_{\\tilde{\\nu}_0} = \\frac{S(T)}{\\pi \\gamma_L} = \\frac{1.03350 \\times 10^{-23}\\ \\mathrm{cm\\, molecule^{-1}}}{\\pi (0.0476952\\ \\mathrm{cm}^{-1})}\n$$\n$$\n\\sigma_{\\tilde{\\nu}_0} = \\frac{1.03350 \\times 10^{-23}}{0.149840}\\ \\mathrm{cm^2\\, molecule^{-1}}\n$$\n$$\n\\sigma_{\\tilde{\\nu}_0} \\approx 6.89735 \\times 10^{-23}\\ \\mathrm{cm^2\\, molecule^{-1}}\n$$\n\n按照要求将结果四舍五入到四位有效数字：\n$$\n\\sigma_{\\tilde{\\nu}_0} = 6.897 \\times 10^{-23}\\ \\mathrm{cm^2\\, molecule^{-1}}\n$$\n推导出的截面表达式为：\n$$\n\\sigma_{\\tilde{\\nu}_0} = \\frac{S_0}{\\pi \\gamma_{\\mathrm{air},0} P} \\left(\\frac{T}{T_0}\\right)^n \\frac{Q(T_0)}{Q(T)} \\exp\\left[-c_2 E''\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)\\right] \\frac{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T}\\right)}{1 - \\exp\\left(-\\frac{c_2 \\tilde{\\nu}_0}{T_0}\\right)}\n$$",
            "answer": "$$\n\\boxed{6.897 \\times 10^{-23}}\n$$"
        },
        {
            "introduction": "在吸收截面概念的基础上，比尔-朗伯定律描述了光在穿过大气层时如何被衰减。本实践练习使用一个简化的波段模型来探索吸收饱和现象，这是遥感中的一个关键概念。通过比较一个强的和一个弱的二氧化碳吸收带，你将量化为何当吸收物总量变得非常大时，测量的灵敏度会下降。",
            "id": "3796294",
            "problem": "考虑一个平整、晴空、二氧化碳均匀混合且忽略散射的大气层。在特定波长下，沿斜路径穿过大气的单色透射率遵循 Beer–Lambert 定律，该定律指出，透射辐照度由 $I = I_{0}\\exp(-\\tau)$ 给出，其中 $I_{0}$ 是入射辐照度，$\\tau$ 是光学深度。对于一种吸收气体，其带平均分子吸收截面为 $\\sigma$（单位为 $\\mathrm{m^2\\,molecule^{-1}}$），吸收分子的柱总量为 $N$（单位为 $\\mathrm{molecule\\,m^{-2}}$），则沿斜路径的光学深度可建模为\n$$\n\\tau = \\frac{\\sigma N}{\\mu},\n$$\n其中 $\\mu = \\cos(\\theta)$ 是平整大气中斜路径的投影因子，$\\theta$ 是以度为单位指定的太阳天顶角 (SZA)。因此，单色透射率为\n$$\nT = \\exp\\left(-\\frac{\\sigma N}{\\mu}\\right).\n$$\n在近红外波段，二氧化碳在 $2.06\\,\\mu\\mathrm{m}$ 附近有一个较强的吸收带，在 $1.6\\,\\mu\\mathrm{m}$ 附近有一个较弱的吸收带。对于本问题，使用在标准温度和压力下的带平均有效吸收截面来处理每个吸收带，并假定该截面相对于压力和温度为常数：\n- 对于 $2.06\\,\\mu\\mathrm{m}$ 吸收带：$\\sigma_{2.06} = 1.3\\times 10^{-26}\\,\\mathrm{m^2\\,molecule^{-1}}$。\n- 对于 $1.6\\,\\mu\\mathrm{m}$ 吸收带：$\\sigma_{1.6} = 3.5\\times 10^{-27}\\,\\mathrm{m^2\\,molecule^{-1}}$。\n\n定义一个有限增量饱和度度量，用于量化在固定 SZA 下，柱总量增加 $10\\%$ 所引起的透射率绝对减少量：\n$$\nD_{\\mathrm{abs}}(N,\\theta;\\sigma) = T(N,\\theta;\\sigma) - T(1.1N,\\theta;\\sigma),\n$$\n其中 $T(N,\\theta;\\sigma) = \\exp\\left(-\\frac{\\sigma N}{\\cos(\\theta)}\\right)$，角度 $\\theta$ 以度为单位， $N$ 的单位为 $\\mathrm{molecule\\,m^{-2}}$。该度量分离出了当吸收带接近饱和（即大 $\\tau$）时，增加更多吸收体所带来的绝对效应递减的现象。\n\n任务：对于下方的每个测试用例，计算并返回四元组\n$$\n\\left[T_{2.06},\\;T_{1.6},\\;D_{\\mathrm{abs},2.06},\\;D_{\\mathrm{abs},1.6}\\right],\n$$\n其中 $T_{2.06} = T(N,\\theta;\\sigma_{2.06})$，$T_{1.6} = T(N,\\theta;\\sigma_{1.6})$，$D_{\\mathrm{abs},2.06} = D_{\\mathrm{abs}}(N,\\theta;\\sigma_{2.06})$，以及 $D_{\\mathrm{abs},1.6} = D_{\\mathrm{abs}}(N,\\theta;\\sigma_{1.6})$。\n\n所有角度必须以度为单位处理，最终的透射率和饱和度度量是无量纲的。将所有输出表示为浮点数。\n\n使用以下测试套件，它涵盖了典型情景、低和高柱总量、极端斜路径几何形状以及一个边界情况：\n1. $N = 9.0\\times 10^{25}\\,\\mathrm{molecule\\,m^{-2}}$，$\\theta = 60^\\circ$。\n2. $N = 1.0\\times 10^{24}\\,\\mathrm{molecule\\,m^{-2}}$，$\\theta = 0^\\circ$。\n3. $N = 3.0\\times 10^{26}\\,\\mathrm{molecule\\,m^{-2}}$，$\\theta = 45^\\circ$。\n4. $N = 9.0\\times 10^{25}\\,\\mathrm{molecule\\,m^{-2}}$，$\\theta = 85^\\circ$。\n5. $N = 0\\,\\mathrm{molecule\\,m^{-2}}$，$\\theta = 70^\\circ$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是按指定顺序包含四个浮点数的列表。例如，格式为\n$$\n[\\,[T_{2.06}^{(1)},T_{1.6}^{(1)},D_{\\mathrm{abs},2.06}^{(1)},D_{\\mathrm{abs},1.6}^{(1)}],\\,[T_{2.06}^{(2)},T_{1.6}^{(2)},D_{\\mathrm{abs},2.06}^{(2)},D_{\\mathrm{abs},1.6}^{(2)}],\\,\\ldots\\,]\n$$\n不含任何额外文本。确保计算中使用以度为单位的 $\\theta$ 和以 $\\mathrm{molecule\\,m^{-2}}$ 为单位的 $N$。",
            "solution": "问题陈述具有科学依据，提法恰当且客观。它基于光谱学和大气科学的基石——基本的 Beer–Lambert 定律。所提供的平整大气中光学深度的模型是一个标准且有效的公式。所有必需的常数、变量和函数形式都得到了明确的定义，使得每个测试用例都能得到唯一且稳定的解。物理参数，如 $\\text{CO}_2$ 的柱总量和太阳天顶角，都在现实范围内。因此，该问题被认为是**有效的**，下方提供了解决方案。\n\n核心任务是计算二氧化碳两个不同吸收带的单色透射率和一个派生的饱和度度量。单色透射率 $T$ 由 Beer–Lambert 定律给出，是光学深度 $\\tau$ 的函数：\n$$\nT = \\exp(-\\tau)\n$$\n穿过平整大气的斜路径的光学深度 $\\tau$ 定义为：\n$$\n\\tau = \\frac{\\sigma N}{\\mu}\n$$\n其中 $\\sigma$ 是带平均分子吸收截面，$N$ 是吸收气体的垂直柱总量，$\\mu$ 是太阳天顶角 (SZA) $\\theta$ 的余弦。角度 $\\theta$ 以度为单位提供，必须转换为弧度才能用于余弦函数，即 $\\mu = \\cos(\\theta_{\\mathrm{degrees}} \\times \\frac{\\pi}{180})$。将 $\\tau$ 的表达式代入透射率方程，得到透射率作为问题参数的完整表达式：\n$$\nT(N,\\theta;\\sigma) = \\exp\\left(-\\frac{\\sigma N}{\\cos(\\theta)}\\right)\n$$\n问题指定了两个具有不同截面的吸收带：一个在 $2.06\\,\\mu\\mathrm{m}$ 处的强吸收带，其 $\\sigma_{2.06} = 1.3\\times 10^{-26}\\,\\mathrm{m^2\\,molecule^{-1}}$；以及一个在 $1.6\\,\\mu\\mathrm{m}$ 处的弱吸收带，其 $\\sigma_{1.6} = 3.5\\times 10^{-27}\\,\\mathrm{m^2\\,molecule^{-1}}$。我们将计算每个吸收带的透射率，分别表示为 $T_{2.06}$ 和 $T_{1.6}$。\n\n接下来，我们必须计算有限增量饱和度度量 $D_{\\mathrm{abs}}$，它量化了吸收体柱总量 $N$ 增加 $10\\%$ 导致的透射率减少量。其定义如下：\n$$\nD_{\\mathrm{abs}}(N,\\theta;\\sigma) = T(N,\\theta;\\sigma) - T(1.1N,\\theta;\\sigma)\n$$\n通过代入透射率的表达式，可以写成：\n$$\nD_{\\mathrm{abs}}(N,\\theta;\\sigma) = \\exp\\left(-\\frac{\\sigma N}{\\cos(\\theta)}\\right) - \\exp\\left(-\\frac{\\sigma (1.1N)}{\\cos(\\theta)}\\right) = \\exp(-\\tau) - \\exp(-1.1\\tau)\n$$\n将为两个吸收带计算此度量，得到 $D_{\\mathrm{abs},2.06}$ 和 $D_{\\mathrm{abs},1.6}$。\n\n对于每个由一对值 $(N, \\theta)$ 定义的测试用例，其计算步骤如下：\n1. 将太阳天顶角 $\\theta$ 从度转换为弧度。\n2. 计算投影因子 $\\mu = \\cos(\\theta)$。\n3. 对于每个吸收截面 $\\sigma \\in \\{\\sigma_{2.06}, \\sigma_{1.6}\\}$：\n    a. 计算基础柱总量的光学深度：$\\tau = \\frac{\\sigma N}{\\mu}$。\n    b. 计算初始透射率：$T = \\exp(-\\tau)$。\n    c. 计算增加后柱总量的透射率：$T_{1.1N} = \\exp(-1.1\\tau)$。\n    d. 计算饱和度度量：$D_{\\mathrm{abs}} = T - T_{1.1N}$。\n4. 将测试用例的最终结果组合成四元组 $[T_{2.06}, T_{1.6}, D_{\\mathrm{abs},2.06}, D_{\\mathrm{abs},1.6}]$。\n\n一个值得注意的特殊情况是当 $N=0$ 时。在这种情况下，对于任何 $\\sigma$ 和 $\\theta$，光学深度 $\\tau$ 均为零。因此，透射率 $T = \\exp(0) = 1$，饱和度度量 $D_{\\mathrm{abs}} = T(N=0) - T(N=0) = 1 - 1 = 0$。这提供了一个逻辑基准，即不存在吸收体时具有完美的透射率且没有饱和效应。该算法能正确处理此边界条件。以下程序系统地将此过程应用于所有指定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes transmittance and a saturation metric for atmospheric CO2 absorption\n    based on the Beer-Lambert law for a set of test cases.\n    \"\"\"\n\n    # Define constants given in the problem statement.\n    # Absorption cross-section for the 2.06 micron band [m^2 molecule^-1].\n    SIGMA_206 = 1.3e-26\n    # Absorption cross-section for the 1.6 micron band [m^2 molecule^-1].\n    SIGMA_16 = 3.5e-27\n\n    # Define the test suite from the problem statement.\n    # Each case is a tuple of (N, theta), where:\n    # N: column amount of absorbing molecules [molecule m^-2]\n    # theta: Solar Zenith Angle (SZA) [degrees]\n    test_cases = [\n        (9.0e25, 60.0),\n        (1.0e24, 0.0),\n        (3.0e26, 45.0),\n        (9.0e25, 85.0),\n        (0.0, 70.0),\n    ]\n\n    def calculate_metrics(N, theta_deg, sigma):\n        \"\"\"\n        Calculates transmittance and saturation for a given set of parameters.\n\n        Args:\n            N (float): Column amount of absorbing molecules [molecule m^-2].\n            theta_deg (float): Solar Zenith Angle [degrees].\n            sigma (float): Absorption cross-section [m^2 molecule^-1].\n\n        Returns:\n            tuple: A tuple containing (transmittance, saturation_metric).\n        \"\"\"\n        # A Solar Zenith Angle of 90 degrees would lead to division by zero\n        # in a simple plane-parallel model. We'll handle it gracefully if it occurs,\n        # although it is not in the test cases.\n        if theta_deg >= 90.0:\n            return 0.0, 0.0\n\n        # Handle the special case of zero absorber amount.\n        if N == 0.0:\n            return 1.0, 0.0\n\n        # Convert SZA from degrees to radians for numpy's cos function.\n        theta_rad = np.deg2rad(theta_deg)\n        mu = np.cos(theta_rad)\n\n        # Calculate optical depth.\n        tau = (sigma * N) / mu\n\n        # Calculate transmittance for the initial column amount N.\n        transmittance = np.exp(-tau)\n\n        # Calculate transmittance for the 10% increased column amount (1.1 * N).\n        # This is equivalent to multiplying the optical depth by 1.1.\n        transmittance_11N = np.exp(-1.1 * tau)\n\n        # Calculate the saturation metric D_abs.\n        d_abs = transmittance - transmittance_11N\n\n        return transmittance, d_abs\n\n    # This list will store the result quadruples for each test case.\n    results = []\n\n    # Iterate through each test case and perform the calculations.\n    for N, theta in test_cases:\n        # Calculate metrics for the 2.06 micron band.\n        T_206, D_abs_206 = calculate_metrics(N, theta, SIGMA_206)\n\n        # Calculate metrics for the 1.6 micron band.\n        T_16, D_abs_16 = calculate_metrics(N, theta, SIGMA_16)\n\n        # Append the quadruple to the results list.\n        results.append([T_206, T_16, D_abs_206, D_abs_16])\n\n    # Format the final output string as specified in the problem statement:\n    # [[r1_1,r1_2,...],[r2_1,r2_2,...],...]\n    formatted_cases = []\n    for case in results:\n        inner_str = ','.join(map(str, case))\n        formatted_cases.append(f'[{inner_str}]')\n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n\n    # The final print statement must produce only the required output.\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "理想的光谱仪会完美地测量进入其光圈的真实辐射，但真实仪器存在缺陷，可能会扭曲信号。这个问题处理了仪器杂散光这一常见问题，杂散光会人为地“填充”吸收谱线的最深部分。通过这个练习，你将推导并量化由杂散光引起的测量偏差，从而深入了解数据质量评估的一个关键方面。",
            "id": "3796303",
            "problem": "一台天底观测成像光谱仪用于测量波长 $\\lambda_{0}$ 附近的氧气A波段中的大气吸收线。该光谱仪具有已知的仪器线型 (ILS)，由一个光谱响应函数 $R(\\lambda - \\lambda')$ 表示，该函数为非负，并归一化为 $\\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, d\\lambda' = 1$。该光谱仪还存在杂散光：窗口内光谱积分辐射亮度的一部分（比例为 $s$）被均匀地散射到每个光谱通道中。窗口内区间定义为 $[\\lambda_{0} - \\Delta/2, \\lambda_{0} + \\Delta/2]$，其中 $\\Delta$ 的选择是为了覆盖整个反演窗口。\n\n在此窄窗口内，大气被建模为一个对光谱平坦的连续谱辐射亮度 $L_{c}$ 的无源衰減器。单色透过率由 Beer–Lambert 定律给出，$T(\\lambda) = \\exp(-\\tau(\\lambda))$，其中 $\\tau(\\lambda)$ 是沿仪器视线方向的光学厚度。因此，进入光谱仪的真实单色辐射亮度为 $L_{\\text{true}}(\\lambda) = L_{c} \\, T(\\lambda)$。\n\n假设窗口内有一条中心位于 $\\lambda_{0}$ 的窄而深的吸收线，但窗口平均透过率是有限的。因此，在波长 $\\lambda$ 处测量到的辐射亮度可以写成经过仪器线型(ILS)卷积后的真实辐射亮度与一个和窗口平均辐射亮度成正比的均匀杂散光贡献之和：\n$$\nL_{m}(\\lambda) \\;=\\; \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, L_{\\text{true}}(\\lambda') \\, d\\lambda' \\;+\\; s \\, \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} L_{\\text{true}}(\\lambda') \\, d\\lambda'.\n$$\n定义窗口平均透过率\n$$\n\\bar{T} \\;=\\; \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} T(\\lambda') \\, d\\lambda'.\n$$\n\n从 Beer–Lambert 定律和上述线性仪器模型出发，推导测量透过率 $T_{m}(\\lambda) = L_{m}(\\lambda)/L_{c}$ 的表达式。利用此表达式，明确展示仪器杂散光如何通过在 $T_{m}(\\lambda)$ 中产生一个相对于无杂散光情况的加性偏移来“填充”吸收线，并推导透过率偏差 $B(\\lambda) = T_{m}(\\lambda) - T_{0}(\\lambda)$ 的闭式表达式，其中 $T_{0}(\\lambda)$ 是没有杂散光时测得的透过率。\n\n最后，对于一个窗口平均透过率为 $\\bar{T} = 0.915$、光谱仪杂散光比例为 $s = 3.2 \\times 10^{-3}$ 的窗口，计算吸收线中心的偏差 $B(\\lambda_{0})$。将最终偏差表示为无量纲小数或科学记数法，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导由于仪器杂散光引起的测量透过率 $T_{m}(\\lambda)$ 和透过率偏差 $B(\\lambda)$ 的表达式，然后对吸收线中心的偏差进行数值计算。\n\n起点是为测量辐射亮度 $L_{m}(\\lambda)$ 提供的线性仪器模型：\n$$\nL_{m}(\\lambda) = \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, L_{\\text{true}}(\\lambda') \\, d\\lambda' + s \\, \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} L_{\\text{true}}(\\lambda') \\, d\\lambda'\n$$\n此处，$R(\\lambda - \\lambda')$ 是仪器线型函数，$s$ 是杂散光比例，积分分别代表卷积和窗口平均过程。\n\n进入仪器的真实单色辐射亮度为 $L_{\\text{true}}(\\lambda) = L_{c} \\, T(\\lambda)$，其中 $L_{c}$ 是光谱平坦的连续谱辐射亮度，$T(\\lambda)$ 是单色大气透过率。由于 $L_{c}$ 在光谱窗口内是一个常数，可以将其从积分中提取出来。将 $L_{\\text{true}}(\\lambda')$ 的这个表达式代入 $L_{m}(\\lambda)$ 的方程中，得到：\n$$\nL_{m}(\\lambda) = \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, L_{c} \\, T(\\lambda') \\, d\\lambda' + s \\, \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} L_{c} \\, T(\\lambda') \\, d\\lambda'\n$$\n$$\nL_{m}(\\lambda) = L_{c} \\left( \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, T(\\lambda') \\, d\\lambda' \\right) + s \\, L_{c} \\left( \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} T(\\lambda') \\, d\\lambda' \\right)\n$$\n问题将测量透过率定义为 $T_{m}(\\lambda) = L_{m}(\\lambda) / L_{c}$。为了得到 $T_{m}(\\lambda)$ 的表达式，我们将整个方程除以 $L_{c}$：\n$$\nT_{m}(\\lambda) = \\frac{L_{m}(\\lambda)}{L_{c}} = \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, T(\\lambda') \\, d\\lambda' + s \\, \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} T(\\lambda') \\, d\\lambda'\n$$\n问题还提供了窗口平均透过率 $\\bar{T}$ 的定义：\n$$\n\\bar{T} = \\frac{1}{\\Delta} \\int_{\\lambda_{0} - \\Delta/2}^{\\lambda_{0} + \\Delta/2} T(\\lambda') \\, d\\lambda'\n$$\n将这个定义代入 $T_{m}(\\lambda)$ 的表达式中，我们得出测量透过率的所需表达式：\n$$\nT_{m}(\\lambda) = \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, T(\\lambda') \\, d\\lambda' + s \\, \\bar{T}\n$$\n接下来，我们被要求通过考虑没有杂散光的情况来分析杂散光的影响，这对应于将杂散光比例 $s$ 设置为零。令 $T_{0}(\\lambda)$ 为这种理想情况（$s=0$）下的测量透过率：\n$$\nT_{0}(\\lambda) = \\int_{-\\infty}^{\\infty} R(\\lambda - \\lambda') \\, T(\\lambda') \\, d\\lambda'\n$$\n这一项代表了真实的大气透过率光谱 $T(\\lambda)$ 与仪器线型函数 $R$ 的卷积。\n\n通过将 $T_{0}(\\lambda)$ 代回到我们关于 $T_{m}(\\lambda)$ 的表达式中，我们可以明确地看到杂散光的影响：\n$$\nT_{m}(\\lambda) = T_{0}(\\lambda) + s \\, \\bar{T}\n$$\n这个方程表明，在存在杂散光的情况下测得的透过率 $T_{m}(\\lambda)$ 等于理想的卷积后透过率 $T_{0}(\\lambda)$ 加上一个加性偏移项 $s \\, \\bar{T}$。由于 $s$ 和 $\\bar{T}$ 相对于波长 $\\lambda$ 都是常数，所以这个偏移在整个光谱窗口内是均匀的。这种恒定的正偏移具有“填充”吸收特征的效果，使其看起来比实际要浅。例如，在 $T_{0}(\\lambda)$ 很小的深吸收线底部，加上 $s \\, \\bar{T}$ 这一项会人为地增加测量信号。\n\n透过率偏差 $B(\\lambda)$ 定义为有杂散光时的测量透过率与无杂散光时的测量透过率之差：\n$$\nB(\\lambda) = T_{m}(\\lambda) - T_{0}(\\lambda)\n$$\n使用上面推导的关系：\n$$\nB(\\lambda) = (T_{0}(\\lambda) + s \\, \\bar{T}) - T_{0}(\\lambda)\n$$\n这可以简化为偏差的闭式表达式：\n$$\nB(\\lambda) = s \\, \\bar{T}\n$$\n如图所示，偏差 $B(\\lambda)$ 在整个光谱窗口内是一个常数，与 $\\lambda$ 无关。\n\n最后，我们被要求在给定具体值 $\\bar{T} = 0.915$ 和 $s = 3.2 \\times 10^{-3}$ 的情况下，计算吸收线中心的偏差 $B(\\lambda_{0})$。由于偏差是恒定的，对于任何 $\\lambda$，$B(\\lambda_{0})$ 都与 $B(\\lambda)$ 相同。\n$$\nB(\\lambda_{0}) = s \\, \\bar{T} = (3.2 \\times 10^{-3}) \\times 0.915\n$$\n进行乘法运算：\n$$\nB(\\lambda_{0}) = 0.0032 \\times 0.915 = 0.002928\n$$\n按照要求，将此结果表示为科学记数法并四舍五入到四位有效数字，得到：\n$$\nB(\\lambda_{0}) = 2.928 \\times 10^{-3}\n$$",
            "answer": "$$\\boxed{2.928 \\times 10^{-3}}$$"
        }
    ]
}