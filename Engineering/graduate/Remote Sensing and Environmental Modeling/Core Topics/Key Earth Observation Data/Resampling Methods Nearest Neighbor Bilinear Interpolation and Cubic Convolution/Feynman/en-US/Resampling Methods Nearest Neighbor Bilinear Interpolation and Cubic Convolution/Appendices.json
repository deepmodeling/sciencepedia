{
    "hands_on_practices": [
        {
            "introduction": "This first practice builds the ubiquitous bilinear interpolation algorithm from its fundamental components. By constructing the two-dimensional estimator from separable, one-dimensional basis functions, you will gain a deeper intuition for how continuous surfaces are modeled from discrete grid data. This exercise  is essential for understanding the assumptions of linearity and separability that underpin many common interpolation schemes.",
            "id": "3842119",
            "problem": "In a remote sensing resampling task, a single-grid-cell model of the continuous radiance field is constructed from a raster using the following principles: locality, linearity, and separability of the sensor’s Point Spread Function (PSF). Under these assumptions, the radiance field inside one cell is approximated by a tensor-product of one-dimensional piecewise-affine basis functions whose coefficients are the corner Digital Numbers (DN). Consider a unit square cell with corners at $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$, and let the corner values be $f_{00}=10$, $f_{10}=14$, $f_{01}=8$, and $f_{11}=12$, where each $f_{ij}$ denotes the DN at corner $(i,j)$. A resampling query is made at the normalized subpixel coordinate $(x,y)=(0.2,0.7)$ obtained by georeferencing the image-to-map transformation and normalizing by the cell dimensions.\n\nStarting from the one-dimensional partition-of-unity “hat” basis on $[0,1]$, and invoking separability to construct the two-dimensional estimator, derive the four nonnegative weights that act on the corner values as barycentric coordinates within the cell. Use these weights to compute the bilinear estimate of the radiance at $(x,y)=(0.2,0.7)$. Express the final answer as a real number. No rounding is required, and no physical units are attached because the DN is dimensionless.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of signal processing and numerical analysis, specifically bilinear interpolation, and is well-posed with all necessary information provided for a unique solution.\n\nThe problem requires the derivation of an estimated radiance value at a subpixel coordinate using bilinear interpolation, framed in the context of remote sensing. The method must be derived from first principles, starting with one-dimensional basis functions and extending to two dimensions through a tensor product.\n\nLet the normalized coordinates within the unit square cell be $(x,y)$, where $x, y \\in [0,1]$. The problem specifies starting with the one-dimensional partition-of-unity \"hat\" basis on the interval $[0,1]$. These are piecewise-affine (linear) functions. For a 1D grid with nodes at $u=0$ and $u=1$, the two basis functions, $\\phi_0(u)$ and $\\phi_1(u)$, are defined such that they are equal to $1$ at one node and $0$ at the other.\nThe basis function associated with the node at $u=0$ is:\n$$ \\phi_0(u) = 1-u $$\nThis function is $1$ at $u=0$ and $0$ at $u=1$.\nThe basis function associated with the node at $u=1$ is:\n$$ \\phi_1(u) = u $$\nThis function is $0$ at $u=0$ and $1$ at $u=1$. These functions are non-negative on $[0,1]$ and sum to one, $\\phi_0(u) + \\phi_1(u) = (1-u) + u = 1$, forming a partition of unity.\n\nThe problem states that the two-dimensional estimator is constructed by invoking separability, which implies that the two-dimensional basis functions are formed by a tensor product of the one-dimensional basis functions. The four corners of the unit cell are $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$. The corresponding 2D basis functions, $\\Psi_{ij}(x,y)$, for a corner at $(i,j)$ where $i,j \\in \\{0,1\\}$, are given by the product of the 1D basis functions for each coordinate:\n$$ \\Psi_{ij}(x,y) = \\phi_i(x) \\phi_j(y) $$\nThese four functions are the non-negative weights that act as barycentric coordinates for any point $(x,y)$ inside the cell. Let's derive them explicitly:\n1.  Weight for corner $(0,0)$: $w_{00}(x,y) = \\Psi_{00}(x,y) = \\phi_0(x)\\phi_0(y) = (1-x)(1-y)$\n2.  Weight for corner $(1,0)$: $w_{10}(x,y) = \\Psi_{10}(x,y) = \\phi_1(x)\\phi_0(y) = x(1-y)$\n3.  Weight for corner $(0,1)$: $w_{01}(x,y) = \\Psi_{01}(x,y) = \\phi_0(x)\\phi_1(y) = (1-x)y$\n4.  Weight for corner $(1,1)$: $w_{11}(x,y) = \\Psi_{11}(x,y) = \\phi_1(x)\\phi_1(y) = xy$\n\nThe bilinearly interpolated value, $f(x,y)$, is the weighted sum of the corner Digital Numbers (DNs), $f_{ij}$, using these basis functions as weights:\n$$ f(x,y) = f_{00} \\Psi_{00}(x,y) + f_{10} \\Psi_{10}(x,y) + f_{01} \\Psi_{01}(x,y) + f_{11} \\Psi_{11}(x,y) $$\nSubstituting the expressions for the basis functions gives the standard formula for bilinear interpolation:\n$$ f(x,y) = f_{00}(1-x)(1-y) + f_{10}x(1-y) + f_{01}(1-x)y + f_{11}xy $$\n\nWe are given the corner values: $f_{00}=10$, $f_{10}=14$, $f_{01}=8$, and $f_{11}=12$. The resampling query is at the normalized subpixel coordinate $(x,y)=(0.2,0.7)$.\n\nFirst, we calculate the numerical values of the four weights at the point $(x,y) = (0.2, 0.7)$:\n$w_{00} = (1 - 0.2)(1 - 0.7) = (0.8)(0.3) = 0.24$\n$w_{10} = (0.2)(1 - 0.7) = (0.2)(0.3) = 0.06$\n$w_{01} = (1 - 0.2)(0.7) = (0.8)(0.7) = 0.56$\n$w_{11} = (0.2)(0.7) = 0.14$\n\nAs a check, the weights should sum to $1$: $0.24 + 0.06 + 0.56 + 0.14 = 0.30 + 0.70 = 1.0$.\n\nNow, we use these weights to compute the bilinear estimate of the radiance at $(0.2, 0.7)$:\n$$ f(0.2, 0.7) = f_{00}w_{00} + f_{10}w_{10} + f_{01}w_{01} + f_{11}w_{11} $$\nSubstituting the given DN values and the calculated weights:\n$$ f(0.2, 0.7) = (10)(0.24) + (14)(0.06) + (8)(0.56) + (12)(0.14) $$\n$$ f(0.2, 0.7) = 2.4 + 0.84 + 4.48 + 1.68 $$\n$$ f(0.2, 0.7) = 3.24 + 6.16 $$\n$$ f(0.2, 0.7) = 9.4 $$\n\nThe bilinearly interpolated value at the coordinate $(0.2, 0.7)$ is $9.4$.",
            "answer": "$$\\boxed{9.4}$$"
        },
        {
            "introduction": "While interpolating resamplers like bilinear create new data values, nearest neighbor resampling preserves the original pixel values, a crucial property for some applications. However, this method is not without its own artifacts. This exercise  challenges you to analyze how the interaction between the target grid and the nearest neighbor rule can introduce a systematic positional bias, shifting the perceived location of features like sharp boundaries.",
            "id": "3842123",
            "problem": "A source image on a Cartesian grid is modeled as samples of a piecewise-constant scalar field acquired at pixel centers on the integer lattice $\\mathbb{Z}^{2}$. Each source pixel with index $(i,j) \\in \\mathbb{Z}^{2}$ has its center at $(x,y)=(i,j)$ and its spatial support as $[i-\\tfrac{1}{2},i+\\tfrac{1}{2}) \\times [j-\\tfrac{1}{2},j+\\tfrac{1}{2})$. A reprojection is performed to a target grid whose pixel centers map into the source coordinate system as $(x_{t},y_{t})=(m+\\delta,n+\\delta)$ for each target pixel index $(m,n) \\in \\mathbb{Z}^{2}$, with a fixed subpixel offset $\\delta=0.49$. Nearest neighbor resampling is used, defined as choosing the source pixel whose center is closest in Euclidean distance to $(x_{t},y_{t})$, equivalently $(i_{s},j_{s})=(\\operatorname{round}(x_{t}),\\operatorname{round}(y_{t}))$, where $\\operatorname{round}(\\cdot)$ denotes rounding to the nearest integer (ties do not occur here because $\\delta \\neq 0.5$).\n  \n1) Starting from these definitions, derive the mapping $(m,n) \\mapsto (i_{s},j_{s})$ symbolically for a generic target pixel $(m,n)$ under nearest neighbor resampling with $\\delta=0.49$.\n\n2) To assess positional bias at a sharp boundary, consider the one-dimensional slice along the $x$-axis of a binary field $f(x)$ that is $0$ for $x<0$ and $1$ for $x \\ge 0$. Using only nearest neighbor resampling under the same offset $\\delta=0.49$, the target pixel at index $m \\in \\mathbb{Z}$ samples the source at $x_{t}=m+\\delta$ and is assigned label $\\ell_{m}=f\\!\\left(\\operatorname{round}(x_{t})\\right)$. Define the observed boundary location along $x$ as the midpoint between the centers of the last target pixel labeled $0$ and the first target pixel labeled $1$. Compute the signed bias of this observed boundary location relative to the true boundary at $x=0$, expressed in pixel units. Provide the exact value as a single decimal number (no rounding instruction is needed).",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of digital image processing and remote sensing, well-posed with all necessary information provided for a unique solution, and stated objectively. The problem proceeds in two parts.\n\nPart 1: Derivation of the symbolic mapping\nThe problem defines the reprojection of a target pixel with index $(m,n)$ into the source coordinate system as $(x_t, y_t) = (m+\\delta, n+\\delta)$, where $\\delta=0.49$.\nThe nearest neighbor resampling rule states that the assigned source pixel index $(i_s, j_s)$ is determined by rounding the target coordinates to the nearest integer:\n$$ (i_s, j_s) = (\\operatorname{round}(x_t), \\operatorname{round}(y_t)) $$\nSubstituting the expression for $(x_t, y_t)$, we get:\n$$ (i_s, j_s) = (\\operatorname{round}(m+\\delta), \\operatorname{round}(n+\\delta)) $$\nGiven $\\delta=0.49$ and that $m$ and $n$ are integers, we analyze the rounding operation for the $x$-coordinate. The function $\\operatorname{round}(z)$ finds the integer $k$ that minimizes the distance $|z-k|$. For the coordinate $x_t=m+0.49$:\nThe distance to the integer $m$ is $|(m+0.49) - m| = |0.49| = 0.49$.\nThe distance to the next integer $m+1$ is $|(m+0.49) - (m+1)| = |-0.51| = 0.51$.\nSince $0.49 < 0.51$, the nearest integer to $m+0.49$ is $m$.\nTherefore, $\\operatorname{round}(m+0.49) = m$.\nBy identical reasoning for the $y$-coordinate, $\\operatorname{round}(n+0.49) = n$.\nSubstituting these results back into the mapping equation gives:\n$$ (i_s, j_s) = (m, n) $$\nThis shows that for the given subpixel offset $\\delta=0.49$, the nearest neighbor resampling algorithm maps each target pixel $(m,n)$ to the source pixel with the identical index $(m,n)$.\n\nPart 2: Computation of the boundary bias\nThis part considers a one-dimensional slice along the $x$-axis. The true boundary is located at $x=0$, defined by the binary field $f(x)$:\n$$ f(x) = \\begin{cases} 0 & \\text{if } x  0 \\\\ 1  \\text{if } x \\ge 0 \\end{cases} $$\nA target pixel at index $m \\in \\mathbb{Z}$ has its center mapped to the source coordinate $x_t = m + \\delta = m + 0.49$. The label assigned to this target pixel, $\\ell_m$, is determined by applying nearest neighbor resampling, which means evaluating the field $f(x)$ at the center of the nearest source pixel. The coordinate of the center of the nearest source pixel is found by $\\operatorname{round}(x_t)$.\n$$ \\ell_m = f(\\operatorname{round}(x_t)) = f(\\operatorname{round}(m+0.49)) $$\nFrom Part 1, we established that $\\operatorname{round}(m+0.49) = m$ for any integer $m$. Thus, the label for the target pixel $m$ is:\n$$ \\ell_m = f(m) $$\nUsing the definition of $f(x)$, we can find the labels for integer values of $m$:\nFor $m  0$ (e.g., $m=-1, -2, \\dots$), $\\ell_m = f(m) = 0$.\nFor $m \\ge 0$ (e.g., $m=0, 1, \\dots$), $\\ell_m = f(m) = 1$.\nThe transition from label $0$ to label $1$ occurs between target pixel $m=-1$ and target pixel $m=0$.\nThe last target pixel labeled $0$ is at index $m_{last\\_0} = -1$.\nThe first target pixel labeled $1$ is at index $m_{first\\_1} = 0$.\n\nThe problem defines the observed boundary location, $x_{obs}$, as the midpoint between the centers of these two target pixels, as located in the source coordinate system.\nThe location of the center of target pixel $m$ in the source coordinate system is $m+\\delta$.\nLocation of the center of pixel $m_{last\\_0} = -1$: $x_{t,-1} = -1 + \\delta$.\nLocation of the center of pixel $m_{first\\_1} = 0$: $x_{t,0} = 0 + \\delta = \\delta$.\n\nThe observed boundary location is the midpoint:\n$$ x_{obs} = \\frac{x_{t,-1} + x_{t,0}}{2} = \\frac{(-1 + \\delta) + \\delta}{2} = \\frac{2\\delta - 1}{2} = \\delta - \\frac{1}{2} $$\nThe signed bias is the difference between the observed boundary location and the true boundary location, $x_{true}=0$.\n$$ \\text{Bias} = x_{obs} - x_{true} = \\left(\\delta - \\frac{1}{2}\\right) - 0 = \\delta - 0.5 $$\nSubstituting the given value $\\delta = 0.49$:\n$$ \\text{Bias} = 0.49 - 0.5 = -0.01 $$\nThe bias is $-0.01$ pixel units, indicating a slight shift of the observed boundary in the negative direction relative to the true boundary.",
            "answer": "$$\\boxed{-0.01}$$"
        },
        {
            "introduction": "A frequent challenge in environmental modeling is resampling categorical data, such as land-cover maps. Applying methods designed for continuous fields, like bilinear interpolation, to discrete classes is conceptually problematic and can introduce significant errors. This advanced problem  provides a framework for quantifying the misclassification rate that arises from this mismatch, using probabilistic methods to calculate the expected error at a class boundary.",
            "id": "3842075",
            "problem": "A binary categorical land-cover map is defined on the continuous plane by the indicator function $I(x,y)$ that equals $1$ in class $A$ and $0$ in class $B$. Consider a simple boundary geometry in which the true boundary within a single original pixel cell coincides with a straight line parallel to the $y$-axis, so that within the unit square $[0,1]\\times[0,1]$ the true class is $A$ if and only if $x \\ge s$ for some offset $s \\in (0,1)$. The four original pixel-center samples are located at the corners $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$, and each stores the categorical value $I(x,y)\\in\\{0,1\\}$ at its location.\n\nA target grid is produced by resampling this categorical map with bilinear interpolation, followed by hard assignment to the nearest label: the bilinear interpolant $b(x,y)$ is evaluated at every point $(x,y)$ within $[0,1]\\times[0,1]$, and the resampled label $\\hat{I}(x,y)$ is set to $1$ if $b(x,y) \\ge 0.5$ and to $0$ otherwise. Define the within-cell misclassification rate as the area fraction of $[0,1]\\times[0,1]$ on which $\\hat{I}(x,y)\\neq I(x,y)$.\n\nAssume that the registration between the true boundary and the original grid is random so that $S$ is uniformly distributed on $(0,1)$, representing the unknown offset of the vertical boundary within a generic unit cell. Under the foregoing assumptions and using only first principles and standard definitions of bilinear interpolation and area measure, derive the expected misclassification rate $\\mathbb{E}[\\text{misclassification rate}]$ with respect to $S$. Express your final answer as an exact, dimensionless fraction (no units, no percentage sign).",
            "solution": "The problem is first validated and found to be well-posed, scientifically grounded, and objective. It is a formalizable problem in the domain of digital image processing and remote sensing, with all necessary components defined.\n\nThe solution proceeds as follows.\n\nFirst, we determine the values of the indicator function $I(x,y)$ at the four corner sample points of the unit square $[0,1] \\times [0,1]$. These points are $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$. The indicator function is defined as $I(x,y) = 1$ if $x \\ge s$ and $I(x,y) = 0$ if $x  s$, where $s$ is the boundary offset and is known to be in the interval $(0,1)$.\n\nLet $v_{ij} = I(i,j)$ for $i,j \\in \\{0,1\\}$ be the values at the corner points.\n- At $(0,0)$, the x-coordinate is $x=0$. Since $s \\in (0,1)$, we have $0  s$. Therefore, $v_{00} = I(0,0) = 0$.\n- At $(0,1)$, the x-coordinate is $x=0$. Similarly, $0  s$, so $v_{01} = I(0,1) = 0$.\n- At $(1,0)$, the x-coordinate is $x=1$. Since $s \\in (0,1)$, we have $1  s$. Therefore, $v_{10} = I(1,0) = 1$.\n- At $(1,1)$, the x-coordinate is $x=1$. Similarly, $1  s$, so $v_{11} = I(1,1) = 1$.\n\nNotably, for any choice of $s \\in (0,1)$, the corner values are fixed: $v_{00}=0$, $v_{01}=0$, $v_{10}=1$, and $v_{11}=1$.\n\nSecond, we write the expression for the bilinear interpolant $b(x,y)$ within the unit square. The general formula is:\n$$b(x,y) = v_{00}(1-x)(1-y) + v_{10}x(1-y) + v_{01}(1-x)y + v_{11}xy$$\nSubstituting the determined corner values:\n$$b(x,y) = 0 \\cdot (1-x)(1-y) + 1 \\cdot x(1-y) + 0 \\cdot (1-x)y + 1 \\cdot xy$$\n$$b(x,y) = x(1-y) + xy$$\n$$b(x,y) = x - xy + xy = x$$\nThe bilinear interpolant simplifies to just the x-coordinate, $b(x,y)=x$.\n\nThird, we determine the resampled categorical map $\\hat{I}(x,y)$. The rule is to assign the label $1$ if $b(x,y) \\ge 0.5$ and $0$ otherwise. Since $b(x,y)=x$, this becomes:\n$$\\hat{I}(x,y) = \\begin{cases} 1  \\text{if } x \\ge 0.5 \\\\ 0  \\text{if } x  0.5 \\end{cases}$$\nThis result indicates that the resampling process creates a new boundary at the fixed location $x=0.5$, regardless of the true boundary's position $s$.\n\nFourth, we calculate the misclassification rate for a fixed boundary offset $s$. The misclassification rate is the area of the region within the unit square where the true map $I(x,y)$ and the resampled map $\\hat{I}(x,y)$ do not match. Let this rate be denoted $M(s)$.\nThe total area of the unit cell is $1$, so the rate is equal to the misclassified area.\n- The true map has a boundary at $x=s$.\n- The resampled map has a boundary at $x=0.5$.\nMisclassification occurs in the vertical strip between $x=s$ and $x=0.5$. The width of this strip is $|s-0.5|$, and its height is $1$.\nThe area of misclassification is thus $|s-0.5| \\times 1 = |s-0.5|$.\nSo, the misclassification rate as a function of $s$ is:\n$$M(s) = |s - 0.5| = \\left|s - \\frac{1}{2}\\right|$$\n\nFinally, we compute the expected misclassification rate, $\\mathbb{E}[M(S)]$, where the boundary offset $S$ is a random variable uniformly distributed on $(0,1)$. The probability density function of $S$ is $f_S(s)=1$ for $s \\in (0,1)$ and $0$ otherwise.\nThe expectation is given by the integral of $M(s)$ over its probability distribution:\n$$\\mathbb{E}[M(S)] = \\int_0^1 M(s) f_S(s) ds = \\int_0^1 \\left|s - \\frac{1}{2}\\right| ds$$\nTo evaluate this integral, we split the domain at the point where the argument of the absolute value changes sign, which is $s=1/2$:\n$$\\mathbb{E}[M(S)] = \\int_0^{1/2} \\left(\\frac{1}{2} - s\\right) ds + \\int_{1/2}^1 \\left(s - \\frac{1}{2}\\right) ds$$\nWe evaluate each integral separately.\nFor the first integral:\n$$ \\int_0^{1/2} \\left(\\frac{1}{2} - s\\right) ds = \\left[ \\frac{1}{2}s - \\frac{s^2}{2} \\right]_0^{1/2} = \\left(\\frac{1}{2}\\cdot\\frac{1}{2} - \\frac{(1/2)^2}{2}\\right) - (0) = \\frac{1}{4} - \\frac{1/4}{2} = \\frac{1}{4} - \\frac{1}{8} = \\frac{1}{8} $$\nFor the second integral:\n$$ \\int_{1/2}^1 \\left(s - \\frac{1}{2}\\right) ds = \\left[ \\frac{s^2}{2} - \\frac{1}{2}s \\right]_{1/2}^1 = \\left(\\frac{1^2}{2} - \\frac{1}{2}\\cdot1\\right) - \\left(\\frac{(1/2)^2}{2} - \\frac{1}{2}\\cdot\\frac{1}{2}\\right) = \\left(\\frac{1}{2} - \\frac{1}{2}\\right) - \\left(\\frac{1/4}{2} - \\frac{1}{4}\\right) = 0 - \\left(\\frac{1}{8} - \\frac{1}{4}\\right) = -\\left(-\\frac{1}{8}\\right) = \\frac{1}{8} $$\nThe total expected misclassification rate is the sum of these two results:\n$$\\mathbb{E}[M(S)] = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}$$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        }
    ]
}