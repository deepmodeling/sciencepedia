{
    "hands_on_practices": [
        {
            "introduction": "A robust understanding of thermal remote sensing is built upon the foundation of Planck's law. This exercise solidifies that foundation by guiding you through its derivation from first principles of quantum statistics and exploring the useful, though limited, classical approximations. By calculating the errors of the Rayleigh-Jeans and Wien approximations, you will develop a quantitative feel for their domains of validity, a critical skill for interpreting sensor data .",
            "id": "3861826",
            "problem": "An orbiting thermal imager relies on a window channel centered at $\\lambda=11\\,\\mu\\text{m}$ in the longwave infrared to retrieve land surface temperature under clear-sky conditions. Assume the surface is an ideal blackbody in local thermodynamic equilibrium at temperature $T=300\\,\\text{K}$ and that the upwelling radiation field is isotropic at the surface. Starting from the quantization of electromagnetic modes in a cavity and the Bose–Einstein photon occupancy, derive the spectral radiance per unit wavelength for a blackbody, and obtain its two classical limiting forms appropriate to remote sensing: the long-wavelength/high-temperature Rayleigh–Jeans approximation and the short-wavelength/low-temperature Wien approximation.\n\nUse the following well-tested bases:\n- The photon energy is $h\\nu$, where $h$ is Planck’s constant and $\\nu$ is frequency.\n- The average photon number per mode at equilibrium is $\\bar{n}(\\nu)=\\left[\\exp\\!\\left(\\frac{h\\nu}{k_{B}T}\\right)-1\\right]^{-1}$, where $k_{B}$ is the Boltzmann constant and $T$ is absolute temperature.\n- The electromagnetic mode density per unit volume per unit frequency (including two polarizations) is $g(\\nu)=\\frac{8\\pi\\nu^{2}}{c^{3}}$, where $c$ is the speed of light.\n- For an isotropic radiation field, the spectral radiance per unit frequency $B_{\\nu}(\\nu,T)$ and the spectral energy density per unit frequency $u_{\\nu}(\\nu,T)$ are related by $B_{\\nu}(\\nu,T)=\\frac{c}{4}\\,u_{\\nu}(\\nu,T)$.\n- Frequency and wavelength are related by $\\nu=\\frac{c}{\\lambda}$, and $B_{\\lambda}(\\lambda,T)\\,d\\lambda=B_{\\nu}(\\nu,T)\\,d\\nu$.\n\nDefine the relative error of an approximation $B_{\\lambda,\\text{approx}}(\\lambda,T)$ to the exact blackbody spectral radiance $B_{\\lambda}(\\lambda,T)$ as\n$$\n\\epsilon=\\frac{\\left|B_{\\lambda,\\text{approx}}(\\lambda,T)-B_{\\lambda}(\\lambda,T)\\right|}{B_{\\lambda}(\\lambda,T)}.\n$$\nAfter deriving the exact expression and the two limiting approximations from the bases above, compute the relative errors for the Rayleigh–Jeans and Wien approximations at $\\lambda=11\\,\\mu\\text{m}$ and $T=300\\,\\text{K}$, using $h=6.62607015\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$, $k_{B}=1.380649\\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}$, and $c=2.99792458\\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1}$. Report the pair $\\left(\\epsilon_{\\text{RJ}},\\epsilon_{\\text{Wien}}\\right)$ as decimal numbers, rounded to four significant figures. No units are required in the final numerical pair.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Context:** An orbiting thermal imager observing a land surface.\n- **Wavelength:** $\\lambda=11\\,\\mu\\text{m}$.\n- **Surface Temperature:** $T=300\\,\\text{K}$.\n- **Surface Emissivity:** The surface is assumed to be an ideal blackbody.\n- **Radiation Field:** Isotropic at the surface.\n- **Task 1: Derivation:** Starting from fundamental principles, derive the blackbody spectral radiance per unit wavelength, $B_{\\lambda}(\\lambda,T)$, and its two classical limiting forms: the Rayleigh–Jeans approximation ($B_{\\lambda,\\text{RJ}}$) and the Wien approximation ($B_{\\lambda,\\text{Wien}}$).\n- **Task 2: Calculation:** Compute the relative errors ($\\epsilon_{\\text{RJ}}$, $\\epsilon_{\\text{Wien}}$) of the two approximations at the given $\\lambda$ and $T$.\n- **Fundamental Bases Provided:**\n    1.  Photon energy: $h\\nu$.\n    2.  Bose–Einstein photon occupancy: $\\bar{n}(\\nu)=\\left[\\exp\\!\\left(\\frac{h\\nu}{k_{B}T}\\right)-1\\right]^{-1}$.\n    3.  Electromagnetic mode density per unit volume per unit frequency: $g(\\nu)=\\frac{8\\pi\\nu^{2}}{c^{3}}$.\n    4.  Radiance-density relation for isotropic fields: $B_{\\nu}(\\nu,T)=\\frac{c}{4}\\,u_{\\nu}(\\nu,T)$.\n    5.  Frequency-wavelength relations: $\\nu=\\frac{c}{\\lambda}$ and $B_{\\lambda}(\\lambda,T)\\,d\\lambda=B_{\\nu}(\\nu,T)\\,d\\nu$.\n- **Error Definition:** $\\epsilon=\\frac{\\left|B_{\\lambda,\\text{approx}}(\\lambda,T)-B_{\\lambda}(\\lambda,T)\\right|}{B_{\\lambda}(\\lambda,T)}$.\n- **Constants:**\n    - $h = 6.62607015\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n    - $k_{B} = 1.380649\\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}$\n    - $c = 2.99792458\\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1}$\n- **Required Output:** A pair of decimal numbers $(\\epsilon_{\\text{RJ}},\\epsilon_{\\text{Wien}})$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded:** The problem requires the derivation of Planck's radiation law from first principles of quantum statistics, a cornerstone of modern physics. All provided bases are standard and correct. The application to remote sensing is scientifically appropriate and realistic.\n- **Well-Posed:** The problem is structured as a guided derivation followed by a specific calculation. All necessary physical laws, relationships, and constants are provided. The objective is clear, and a unique numerical solution exists.\n- **Objective:** The language is formal, precise, and devoid of subjectivity.\n- **Conclusion:** The problem is free of scientific unsoundness, ambiguity, missing information, or other flaws.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n**Derivation of Planck's Law of Blackbody Radiation**\n\nThe spectral energy density per unit frequency, $u_{\\nu}(\\nu,T)$, of photons in a cavity is the product of three quantities: the energy of a single photon, $h\\nu$; the average number of photons per mode, $\\bar{n}(\\nu)$; and the density of states (modes) per unit volume per unit frequency, $g(\\nu)$.\n\n$$\nu_{\\nu}(\\nu,T) = (h\\nu) \\cdot \\bar{n}(\\nu) \\cdot g(\\nu)\n$$\n\nSubstituting the provided expressions for $\\bar{n}(\\nu)$ and $g(\\nu)$:\n$$\nu_{\\nu}(\\nu,T) = (h\\nu) \\cdot \\left[\\exp\\left(\\frac{h\\nu}{k_B T}\\right)-1\\right]^{-1} \\cdot \\left(\\frac{8\\pi\\nu^2}{c^3}\\right)\n$$\n$$\nu_{\\nu}(\\nu,T) = \\frac{8\\pi h\\nu^3}{c^3} \\frac{1}{\\exp\\left(\\frac{h\\nu}{k_B T}\\right)-1}\n$$\n\nFor an isotropic radiation field, the spectral radiance per unit frequency, $B_{\\nu}(\\nu,T)$, is related to the spectral energy density by $B_{\\nu}(\\nu,T) = \\frac{c}{4}u_{\\nu}(\\nu,T)$.\n$$\nB_{\\nu}(\\nu,T) = \\frac{c}{4} \\left( \\frac{8\\pi h\\nu^3}{c^3} \\frac{1}{\\exp\\left(\\frac{h\\nu}{k_B T}\\right)-1} \\right) = \\frac{2h\\nu^3}{c^2} \\frac{1}{\\exp\\left(\\frac{h\\nu}{k_B T}\\right)-1}\n$$\nThis is the Planck function in terms of frequency. To convert to wavelength, we use the relationship $B_{\\lambda}(\\lambda,T)d\\lambda = B_{\\nu}(\\nu,T)d\\nu$. The spectral radiances are therefore related by the Jacobian of the transformation:\n$$\nB_{\\lambda}(\\lambda,T) = B_{\\nu}(\\nu,T) \\left|\\frac{d\\nu}{d\\lambda}\\right|\n$$\nGiven $\\nu = \\frac{c}{\\lambda}$, the derivative is $\\frac{d\\nu}{d\\lambda} = -\\frac{c}{\\lambda^2}$. The absolute value is $\\left|\\frac{d\\nu}{d\\lambda}\\right| = \\frac{c}{\\lambda^2}$.\n\nSubstituting $\\nu = \\frac{c}{\\lambda}$ and $\\left|\\frac{d\\nu}{d\\lambda}\\right|$ into the expression for $B_{\\lambda}(\\lambda,T)$:\n$$\nB_{\\lambda}(\\lambda,T) = \\left( \\frac{2h(c/\\lambda)^3}{c^2} \\frac{1}{\\exp\\left(\\frac{h(c/\\lambda)}{k_B T}\\right)-1} \\right) \\cdot \\left( \\frac{c}{\\lambda^2} \\right)\n$$\n$$\nB_{\\lambda}(\\lambda,T) = \\left( \\frac{2hc^3}{c^2\\lambda^3} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)-1} \\right) \\cdot \\left( \\frac{c}{\\lambda^2} \\right)\n$$\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)-1}\n$$\nThis is the exact expression for the blackbody spectral radiance per unit wavelength, known as Planck's law.\n\n**Derivation of Limiting Approximations**\n\nLet us define the dimensionless variable $x = \\frac{hc}{\\lambda k_B T}$. Planck's law can be written as:\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp(x)-1}\n$$\n\n1.  **Rayleigh–Jeans Approximation (Long-Wavelength/High-Temperature Limit)**\n    This limit corresponds to $\\lambda T \\to \\infty$, which implies $x \\to 0$. For small $x$, we can use the Taylor series expansion of the exponential function, $\\exp(x) \\approx 1 + x$.\n    The denominator becomes $\\exp(x)-1 \\approx (1+x)-1 = x$.\n    Substituting this approximation into Planck's law gives the Rayleigh-Jeans formula:\n    $$\n    B_{\\lambda,\\text{RJ}}(\\lambda,T) \\approx \\frac{2hc^2}{\\lambda^5} \\frac{1}{x} = \\frac{2hc^2}{\\lambda^5} \\left(\\frac{\\lambda k_B T}{hc}\\right) = \\frac{2ck_B T}{\\lambda^4}\n    $$\n\n2.  **Wien Approximation (Short-Wavelength/Low-Temperature Limit)**\n    This limit corresponds to $\\lambda T \\to 0$, which implies $x \\to \\infty$. For large $x$, $\\exp(x) \\gg 1$, so the term $\\exp(x)-1 \\approx \\exp(x)$.\n    Substituting this approximation into Planck's law gives the Wien formula:\n    $$\n    B_{\\lambda,\\text{Wien}}(\\lambda,T) \\approx \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp(x)} = \\frac{2hc^2}{\\lambda^5} \\exp(-x) = \\frac{2hc^2}{\\lambda^5} \\exp\\left(-\\frac{hc}{\\lambda k_B T}\\right)\n    $$\n\n**Calculation of Relative Errors**\n\nThe relative error is $\\epsilon=\\frac{\\left|B_{\\lambda,\\text{approx}}-B_{\\lambda}\\right|}{B_{\\lambda}} = \\left|\\frac{B_{\\lambda,\\text{approx}}}{B_{\\lambda}}-1\\right|$.\n\n1.  **Error of the Rayleigh–Jeans Approximation ($\\epsilon_{\\text{RJ}}$)**\n    $$\n    \\frac{B_{\\lambda,\\text{RJ}}}{B_{\\lambda}} = \\frac{\\frac{2ck_B T}{\\lambda^4}}{\\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp(x)-1}} = \\frac{ck_B T \\lambda^5 (\\exp(x)-1)}{hc^2 \\lambda^4} = \\frac{k_B T \\lambda}{hc}(\\exp(x)-1) = \\frac{\\exp(x)-1}{x}\n    $$\n    The error is:\n    $$\n    \\epsilon_{\\text{RJ}} = \\left|\\frac{\\exp(x)-1}{x}-1\\right| = \\left|\\frac{\\exp(x)-1-x}{x}\\right|\n    $$\n    Since $x = \\frac{hc}{\\lambda k_B T} > 0$, the Taylor series for $\\exp(x) = 1+x+\\frac{x^2}{2!}+\\dots$ shows that $\\exp(x)-1-x > 0$. Thus, the absolute value is redundant.\n    $$\n    \\epsilon_{\\text{RJ}} = \\frac{\\exp(x)-1-x}{x}\n    $$\n\n2.  **Error of the Wien Approximation ($\\epsilon_{\\text{Wien}}$)**\n    $$\n    \\frac{B_{\\lambda,\\text{Wien}}}{B_{\\lambda}} = \\frac{\\frac{2hc^2}{\\lambda^5} \\exp(-x)}{\\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp(x)-1}} = \\exp(-x)(\\exp(x)-1) = 1 - \\exp(-x)\n    $$\n    The error is:\n    $$\n    \\epsilon_{\\text{Wien}} = |(1-\\exp(-x))-1| = |-\\exp(-x)| = \\exp(-x)\n    $$\n\n**Numerical Calculation**\n\nFirst, we compute the value of the dimensionless parameter $x$ for the given conditions:\n$\\lambda = 11\\,\\mu\\text{m} = 11 \\times 10^{-6}\\,\\text{m}$\n$T = 300\\,\\text{K}$\n$h=6.62607015\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n$k_{B}=1.380649\\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}$\n$c=2.99792458\\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1}$\n\n$$\nx = \\frac{hc}{\\lambda k_{B} T} = \\frac{(6.62607015\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}) \\cdot (2.99792458\\times 10^{8}\\,\\text{m}\\cdot\\text{s}^{-1})}{(11 \\times 10^{-6}\\,\\text{m}) \\cdot (1.380649\\times 10^{-23}\\,\\text{J}\\cdot\\text{K}^{-1}) \\cdot (300\\,\\text{K})}\n$$\n$$\nx = \\frac{1.98644586 \\times 10^{-25}\\,\\text{J}\\cdot\\text{m}}{4.5561417 \\times 10^{-26}\\,\\text{J}\\cdot\\text{m}} \\approx 4.359960755\n$$\nNow, we compute the errors using this value of $x$.\n\nFor the Rayleigh-Jeans approximation:\n$$\n\\epsilon_{\\text{RJ}} = \\frac{\\exp(4.359960755)-1-4.359960755}{4.359960755} \\approx \\frac{78.251433 - 1 - 4.359960755}{4.359960755} = \\frac{72.891472}{4.359960755} \\approx 16.71836\n$$\nRounding to four significant figures, $\\epsilon_{\\text{RJ}} \\approx 16.72$.\n\nFor the Wien approximation:\n$$\n\\epsilon_{\\text{Wien}} = \\exp(-4.359960755) \\approx 0.0127783\n$$\nRounding to four significant figures, $\\epsilon_{\\text{Wien}} \\approx 0.01278$.\n\nThe pair of relative errors is $(\\epsilon_{\\text{RJ}}, \\epsilon_{\\text{Wien}})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 16.72  0.01278 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Remote sensing instruments provide raw data as digital counts, not direct physical measurements. This practice simulates the crucial operational workflow of converting these raw counts into at-sensor spectral radiance using a calibration model, and then inverting the Planck function to determine the brightness temperature. Mastering this process is fundamental to transforming raw satellite observations into meaningful physical information .",
            "id": "3861814",
            "problem": "A thermal infrared imaging radiometer aboard an environmental monitoring satellite measures raw digital counts from a land surface in a spectrally narrow band centered at wavelength $\\lambda_0 = 10.8 \\,\\mu\\mathrm{m}$. The instrument has been pre-flight and on-orbit calibrated so that the at-sensor monochromatic spectral radiance $L_\\lambda$ at the central wavelength (in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$) is modeled as a quadratic function of the raw counts $C$ after subtraction of the dark offset $C_{\\mathrm{dark}}$:\n$$\nL_\\lambda = G_1 \\left(C - C_{\\mathrm{dark}}\\right) + G_2 \\left(C - C_{\\mathrm{dark}}\\right)^2,\n$$\nwith calibration coefficients $G_1 = 3.0 \\times 10^{-4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{count}^{-1}$ and $G_2 = -1.0 \\times 10^{-10}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{count}^{-2}$. For a particular pixel, the radiometer reports $C = 34{,}567$ counts with $C_{\\mathrm{dark}} = 150$ counts.\n\nAssume the spectral response function is sufficiently narrow that the radiance within the band can be approximated by its monochromatic value at $\\lambda_0$, and that the brightness temperature $T_b$ is defined as the temperature of a perfect blackbody whose monochromatic spectral radiance at $\\lambda_0$ equals the calibrated radiance $L_\\lambda$. Starting from the fundamental Planck radiation law for monochromatic spectral radiance, derive an expression to invert for $T_b$ and compute its value for this pixel.\n\nUse the following physical constants: Planck constant $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$, speed of light in vacuum $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, and Boltzmann constant $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$. Express the final brightness temperature in kelvins, and round your answer to four significant figures.",
            "solution": "The objective is to determine the brightness temperature $T_b$ of a land surface pixel, given the raw digital counts measured by a thermal infrared radiometer and its calibration model. The brightness temperature is defined as the temperature of a perfect blackbody that would emit the same monochromatic spectral radiance at the specified wavelength, $\\lambda_0$. The solution proceeds in four steps: first, calculating the at-sensor spectral radiance from the raw counts; second, stating the Planck radiation law that relates spectral radiance to temperature; third, deriving the algebraic inversion of Planck's law to solve for temperature; and fourth, substituting the calculated radiance and physical constants into the derived expression to compute the numerical value of $T_b$.\n\nFirst, we calculate the at-sensor monochromatic spectral radiance, $L_\\lambda$, using the provided quadratic calibration model:\n$$\nL_\\lambda = G_1 \\left(C - C_{\\mathrm{dark}}\\right) + G_2 \\left(C - C_{\\mathrm{dark}}\\right)^2\n$$\nThe problem provides the following values:\n- Calibration coefficient $G_1 = 3.0 \\times 10^{-4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{count}^{-1}$\n- Calibration coefficient $G_2 = -1.0 \\times 10^{-10}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{count}^{-2}$\n- Raw counts $C = 34,567$\n- Dark offset counts $C_{\\mathrm{dark}} = 150$\n\nThe difference in counts is $C - C_{\\mathrm{dark}} = 34,567 - 150 = 34,417$.\nSubstituting this value into the calibration equation:\n$$\nL_\\lambda = (3.0 \\times 10^{-4})(34,417) + (-1.0 \\times 10^{-10})(34,417)^2\n$$\n$$\nL_\\lambda = 10.3251 - (1.0 \\times 10^{-10})(1,184,520,089)\n$$\n$$\nL_\\lambda = 10.3251 - 0.1184520089 \\approx 10.206648\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\n$$\n\nSecond, we state the fundamental physical principle governing thermal emission, the Planck radiation law. The monochromatic spectral radiance of a blackbody at temperature $T$ and wavelength $\\lambda$, denoted as $B_\\lambda(\\lambda, T)$, is given by:\n$$\nB_\\lambda(\\lambda, T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right) - 1}\n$$\nIn this standard formulation, all quantities must be in SI units. Thus, $\\lambda$ is in meters ($\\mathrm{m}$), and the resulting units of $B_\\lambda$ are watts per square meter, per steradian, per meter of wavelength ($\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$). The calculated radiance $L_\\lambda$ has units of watts per square meter, per steradian, per micrometer of wavelength ($\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$). To ensure consistency, we must convert $L_\\lambda$ to SI units. Let $L_\\lambda^*$ be the spectral radiance in SI units. The conversion is:\n$$\nL_\\lambda^* [\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}] = L_\\lambda [\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}] \\times 10^6\n$$\nSo, the measured radiance in SI units is:\n$$\nL_\\lambda^* = 10.206648 \\times 10^6 \\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}\n$$\nBy definition of brightness temperature $T_b$, this measured radiance is equal to the radiance of a blackbody at that temperature: $L_\\lambda^* = B_\\lambda(\\lambda_0, T_b)$.\n\nThird, we derive the expression for $T_b$ by inverting the Planck function. We set the measured radiance $L_\\lambda^*$ equal to the Planck function at wavelength $\\lambda_0$:\n$$\nL_\\lambda^* = \\frac{2hc^2}{\\lambda_0^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda_0 k_B T_b}\\right) - 1}\n$$\nWe solve for $T_b$ through algebraic manipulation:\n$$\n\\exp\\left(\\frac{hc}{\\lambda_0 k_B T_b}\\right) - 1 = \\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*}\n$$\n$$\n\\exp\\left(\\frac{hc}{\\lambda_0 k_B T_b}\\right) = \\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} + 1\n$$\nTaking the natural logarithm of both sides:\n$$\n\\frac{hc}{\\lambda_0 k_B T_b} = \\ln\\left(\\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} + 1\\right)\n$$\nFinally, isolating $T_b$ gives the inversion formula:\n$$\nT_b = \\frac{hc}{k_B \\lambda_0 \\ln\\left(\\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} + 1\\right)}\n$$\n\nFourth, we substitute the numerical values into this expression. The physical constants and measurement parameters in SI units are:\n- $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$\n- $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n- $\\lambda_0 = 10.8\\,\\mu\\mathrm{m} = 10.8 \\times 10^{-6}\\,\\mathrm{m}$\n- $L_\\lambda^* = 10.206648 \\times 10^6 \\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$\n\nLet's compute the components of the expression. The term in the numerator is related to the second radiation constant:\n$$\n\\frac{hc}{k_B} = \\frac{(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^{8})}{1.380649 \\times 10^{-23}} \\approx 0.0143877686\\,\\mathrm{m}\\,\\mathrm{K}\n$$\nNow we compute the argument of the natural logarithm:\n$$\n\\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} = \\frac{2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^{8})^2}{(10.8 \\times 10^{-6})^5 (10.206648 \\times 10^6)}\n$$\n$$\n\\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} = \\frac{1.19104297 \\times 10^{-16}}{(1.4700844 \\times 10^{-25})(1.0206648 \\times 10^7)} \\approx \\frac{1.19104297 \\times 10^{-16}}{1.5004104 \\times 10^{-18}} \\approx 79.38133\n$$\nThe full argument of the logarithm is:\n$$\n\\frac{2hc^2}{\\lambda_0^5 L_\\lambda^*} + 1 \\approx 79.38133 + 1 = 80.38133\n$$\nNow we can compute the temperature $T_b$:\n$$\nT_b = \\frac{0.0143877686}{(10.8 \\times 10^{-6}) \\ln(80.38133)} \\approx \\frac{0.0143877686}{(10.8 \\times 10^{-6}) (4.386782)}\n$$\n$$\nT_b \\approx \\frac{0.0143877686}{4.737725 \\times 10^{-5}} \\approx 303.7142\\,\\mathrm{K}\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nT_b \\approx 303.7\\,\\mathrm{K}\n$$\nThis value represents the temperature of an ideal blackbody emitting the same amount of thermal radiation at the sensor's wavelength as was measured from the land surface pixel, after accounting for instrument calibration.",
            "answer": "$$\n\\boxed{303.7}\n$$"
        },
        {
            "introduction": "While theoretical treatments often use monochromatic radiance, real-world sensors integrate energy over a specific spectral band. This exercise moves from idealized theory to practical application by requiring the calculation of band-averaged radiance for a sensor with a defined spectral response function. This task necessitates the use of numerical integration, a core computational skill for accurately modeling and interpreting data from actual remote sensing instruments .",
            "id": "3861806",
            "problem": "You are asked to write a complete, runnable program that computes the response-weighted, band-averaged spectral radiance of an idealized thermal emission source (a perfect blackbody with emissivity equal to $1$) as seen by a remote sensing instrument whose spectral response is a top-hat (uniform and nonzero over a finite interval, zero otherwise) in wavenumber space. The calculation must be grounded in the following fundamental base: the Planck spectral radiance per unit frequency for a blackbody, change-of-variables in integrals, and normalization of a weighting function. You must not assume any shortcut formulas beyond these bases.\n\nStart from the well-tested Planck spectral radiance per unit frequency $\\nu$ (in the International System of Units (SI)) for a blackbody at temperature $T$,\nwithout rearranging it into wavenumber form at the outset. Use a correct change-of-variables argument to transform from frequency $\\nu$ to wavenumber $\\tilde{\\nu}$, and then consistently convert to spectrally differential units of inverse centimeter to match a typical infrared remote sensing convention. Then define the band-averaged spectral radiance with respect to the instrument response as a properly normalized integral.\n\nDefinition of quantities and required steps:\n- The instrument has a top-hat relative spectral response $R(\\sigma)$ in wavenumber $\\sigma$ measured in inverse centimeter, where $\\sigma$ is in $\\mathrm{cm}^{-1}$. The top-hat response equals $1$ on a closed interval $[\\sigma_1,\\sigma_2]$ and $0$ elsewhere.\n- The blackbody spectral radiance per unit frequency $\\nu$ is a well-tested physical law. Use it as your starting point, then convert to spectral radiance per unit wavenumber (first per meter, then per centimeter) using the appropriate Jacobian factors. Do not skip the change-of-variables step.\n- The band-averaged spectral radiance in wavenumber space shall be computed as the response-weighted average of the spectral radiance per unit wavenumber divided by the integral of the response. For a top-hat response of unit height, this reduces to the integral over the band divided by the band width.\n- All computations must use SI base units internally, with explicit attention to the conversion from $\\mathrm{m}^{-1}$ to $\\mathrm{cm}^{-1}$ where needed.\n- Physical constants to be used (SI exact values): Planck constant $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$, speed of light $c = 2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$, Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n\nMathematical requirements:\n- Begin from the Planck spectral radiance per unit frequency $B_{\\nu}(T)$ and transform it to spectral radiance per unit wavenumber in $\\mathrm{m}^{-1}$ by an appropriate change of variables. Then convert that result to spectral radiance per unit wavenumber in $\\mathrm{cm}^{-1}$ by correct unit conversion.\n- For a top-hat response of unit height on $[\\sigma_1,\\sigma_2]$, compute the band-averaged spectral radiance as the integral of the spectral radiance per $\\mathrm{cm}^{-1}$ over $[\\sigma_1,\\sigma_2]$ divided by the band width $(\\sigma_2-\\sigma_1)$, where $\\sigma$ is in $\\mathrm{cm}^{-1}$.\n\nUnits and output:\n- Report the band-averaged spectral radiance as a floating-point number in units of $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,(cm^{-1})^{-1}}$.\n- Express the final numerical outputs in scientific notation with exactly $6$ digits after the decimal point (for example, $1.234567\\mathrm{e}{-3}$ should be printed as $1.234567e-03$). All final outputs must be rounded to this precision.\n\nTest suite:\nYour program must compute the band-averaged spectral radiance for the following five test cases. In each case, the response is a top-hat of unit height between the indicated limits, and the blackbody temperature is given. All wavenumbers are in $\\mathrm{cm}^{-1}$, all temperatures are in $\\mathrm{K}$.\n\n- Case $1$: $\\sigma_1 = 800$, $\\sigma_2 = 1200$, $T = 300$.\n- Case $2$: $\\sigma_1 = 999$, $\\sigma_2 = 1001$, $T = 300$.\n- Case $3$: $\\sigma_1 = 800$, $\\sigma_2 = 1200$, $T = 150$.\n- Case $4$: $\\sigma_1 = 800$, $\\sigma_2 = 1200$, $T = 1000$.\n- Case $5$: $\\sigma_1 = 200$, $\\sigma_2 = 300$, $T = 300$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $5$.\n- Example of required formatting (using placeholders): \"[v1,v2,v3,v4,v5]\".\n- Each entry must be a single floating-point number in scientific notation with exactly $6$ digits after the decimal point, in units of $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,(cm^{-1})^{-1}}$.\n\nNumerical considerations:\n- Your implementation must perform the band integral numerically using a reliable quadrature scheme with appropriate absolute and relative error tolerances, since no closed-form antiderivative should be assumed.\n- Ensure numerical stability of the Planck denominator for small arguments by using a formulation that avoids catastrophic cancellation near zero in the exponential minus one.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of blackbody radiation, well-posed with all necessary data and definitions, and objective in its formulation. It requests a specific, derivable calculation based on first principles, which is a non-trivial and meaningful task in physics and remote sensing.\n\nThe solution proceeds by first deriving the required form of the Planck function and then implementing the numerical calculation for the specified test cases.\n\n### Step 1: Theoretical Derivation\n\nThe primary task is to compute the band-averaged spectral radiance, $\\langle B_{\\sigma} \\rangle$, for a blackbody at temperature $T$ over a spectral band defined by wavenumbers $[\\sigma_1, \\sigma_2]$. The instrument has a top-hat response function, $R(\\sigma)$, which is $1$ inside this band and $0$ outside.\n\nThe band-averaged radiance is defined by the response-weighted integral:\n$$\n\\langle B_{\\sigma} \\rangle = \\frac{\\int_{0}^{\\infty} B_{\\sigma}(\\sigma, T) R(\\sigma) \\,d\\sigma}{\\int_{0}^{\\infty} R(\\sigma) \\,d\\sigma}\n$$\nFor the specified top-hat response, this simplifies to:\n$$\n\\langle B_{\\sigma} \\rangle_{[\\sigma_1, \\sigma_2]} = \\frac{\\int_{\\sigma_1}^{\\sigma_2} B_{\\sigma}(\\sigma, T) \\,d\\sigma}{\\int_{\\sigma_1}^{\\sigma_2} 1 \\,d\\sigma} = \\frac{1}{\\sigma_2 - \\sigma_1} \\int_{\\sigma_1}^{\\sigma_2} B_{\\sigma}(\\sigma, T) \\,d\\sigma\n$$\nHere, $B_{\\sigma}(\\sigma, T)$ is the Planck spectral radiance per unit wavenumber in $\\mathrm{cm}^{-1}$, which must be derived from first principles as requested.\n\n#### 1a. Planck's Law in Frequency Domain\nThe starting point is the Planck spectral radiance function per unit frequency $\\nu$, in SI units ($\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,Hz^{-1}}$):\n$$\nB_{\\nu}(\\nu, T) = \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu / (k_{\\mathrm{B}}T)} - 1}\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light, and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\n#### 1b. Change of Variables to Wavenumber in $\\mathrm{m}^{-1}$\nWe must transform this function from the frequency domain ($\\nu$) to the wavenumber domain. First, we consider wavenumber $\\tilde{\\nu}$ in SI units of $\\mathrm{m}^{-1}$. The relationship between frequency and wavenumber is $\\nu = c\\tilde{\\nu}$.\nThe principle of conservation of energy requires that the radiance emitted in an infinitesimal interval be the same in both coordinate systems:\n$$\n|B_{\\nu}(\\nu, T) \\, d\\nu| = |B_{\\tilde{\\nu}}(\\tilde{\\nu}, T) \\, d\\tilde{\\nu}|\n$$\nThis implies that the spectral radiance functions are related by the Jacobian of the transformation:\n$$\nB_{\\tilde{\\nu}}(\\tilde{\\nu}, T) = B_{\\nu}(\\nu, T) \\left| \\frac{d\\nu}{d\\tilde{\\nu}} \\right|\n$$\nFrom $\\nu = c\\tilde{\\nu}$, we find the Jacobian to be $\\frac{d\\nu}{d\\tilde{\\nu}} = c$.\nSubstituting $\\nu = c\\tilde{\\nu}$ and the Jacobian into the expression for $B_{\\nu}$ yields:\n$$\nB_{\\tilde{\\nu}}(\\tilde{\\nu}, T) = \\left( \\frac{2h(c\\tilde{\\nu})^3}{c^2} \\frac{1}{e^{hc\\tilde{\\nu} / (k_{\\mathrm{B}}T)} - 1} \\right) \\cdot c = \\frac{2hc^2\\tilde{\\nu}^3}{e^{hc\\tilde{\\nu} / (k_{\\mathrm{B}}T)} - 1}\n$$\nThe units of $B_{\\tilde{\\nu}}(\\tilde{\\nu}, T)$ are $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,(m^{-1})^{-1}}$.\n\n#### 1c. Change of Units to Wavenumber in $\\mathrm{cm}^{-1}$\nThe problem specifies the integration domain in terms of wavenumber $\\sigma$ with units of $\\mathrm{cm}^{-1}$. We must perform a second change of variables from $\\tilde{\\nu}$ (in $\\mathrm{m}^{-1}$) to $\\sigma$ (in $\\mathrm{cm}^{-1}$). The relationship is $\\tilde{\\nu} = 100\\sigma$, since $1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$.\nApplying the conservation of energy principle again:\n$$\n|B_{\\tilde{\\nu}}(\\tilde{\\nu}, T) \\, d\\tilde{\\nu}| = |B_{\\sigma}(\\sigma, T) \\, d\\sigma|\n$$\nThe functions are related by the new Jacobian:\n$$\nB_{\\sigma}(\\sigma, T) = B_{\\tilde{\\nu}}(\\tilde{\\nu}, T) \\left| \\frac{d\\tilde{\\nu}}{d\\sigma} \\right|\n$$\nFrom $\\tilde{\\nu} = 100\\sigma$, we have $\\frac{d\\tilde{\\nu}}{d\\sigma} = 100$.\nTo obtain $B_{\\sigma}(\\sigma, T)$ as a function of $\\sigma$, we substitute $\\tilde{\\nu} = 100\\sigma$ into the expression for $B_{\\tilde{\\nu}}$ and multiply by the Jacobian:\n$$\nB_{\\sigma}(\\sigma, T) = \\left( \\frac{2hc^2(100\\sigma)^3}{e^{hc(100\\sigma) / (k_{\\mathrm{B}}T)} - 1} \\right) \\cdot 100\n$$\nThis is the final form of the integrand. Its units are $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,(cm^{-1})^{-1}}$, as required. The numerical program will integrate this function with respect to $\\sigma$ (in $\\mathrm{cm}^{-1}$) over the interval $[\\sigma_1, \\sigma_2]$.\n\n### Step 2: Numerical Implementation Plan\n\n1.  **Constants**: Define the physical constants $h$, $c$, and $k_{\\mathrm{B}}$ using the specified exact SI values. To improve numerical efficiency and clarity, pre-compute the combinations $c_1 = 2hc^2$ and $c_2 = hc/k_{\\mathrm{B}}$.\n2.  **Integrand Function**: Create a Python function `planck_sigma(sigma, T)` that implements the derived $B_{\\sigma}(\\sigma, T)$.\n    -   The function will take `sigma` in $\\mathrm{cm}^{-1}$ and `T` in $\\mathrm{K}$ as inputs.\n    -   Inside the function, it calculates $\\tilde{\\nu} = 100\\sigma$.\n    -   The term $e^x - 1$ in the denominator, where $x = c_2 \\tilde{\\nu} / T$, will be computed using `numpy.expm1(x)` to maintain numerical precision for small values of $x$.\n    -   The final expression for $B_{\\sigma}(\\sigma, T)$ is implemented: `100 * (c1 * (100*sigma)**3) / np.expm1(c2 * (100*sigma) / T)`.\n3.  **Numerical Integration**: For each test case $(\\sigma_1, \\sigma_2, T)$, the definite integral $\\int_{\\sigma_1}^{\\sigma_2} B_{\\sigma}(\\sigma, T) \\,d\\sigma$ will be computed using the `scipy.integrate.quad` function, which provides robust numerical quadrature.\n4.  **Averaging and Formatting**:\n    -   The result of the integral is divided by the bandwidth $(\\sigma_2 - \\sigma_1)$.\n    -   The final value for each test case is formatted into a string in scientific notation with exactly $6$ digits after the decimal point (e.g., `1.234567e-03`).\n\nThis systematic approach ensures that the solution is not only numerically accurate but also rigorously derived from the fundamental principles specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the band-averaged spectral radiance for a blackbody source\n    as seen by a sensor with a top-hat spectral response.\n    The derivation starts from Planck's law per unit frequency and uses\n    a rigorous change of variables to wavenumber space.\n    \"\"\"\n\n    # Physical constants in SI units (exact values):\n    # Planck constant (J s)\n    H = 6.62607015e-34\n    # Speed of light (m/s)\n    C = 2.99792458e8\n    # Boltzmann constant (J/K)\n    KB = 1.380649e-23\n\n    # Pre-computed combinations of constants for the Planck function\n    # c1 = 2 * h * c^2\n    C1 = 2 * H * C**2\n    # c2 = h * c / k_B\n    C2 = H * C / KB\n\n    def planck_sigma(sigma, T):\n        \"\"\"\n        Calculates the Planck spectral radiance per unit wavenumber in cm^-1.\n        B_sigma(sigma, T) in units of W m^-2 sr^-1 (cm^-1)^-1.\n\n        Args:\n            sigma (float): Wavenumber in cm^-1.\n            T (float): Blackbody temperature in Kelvin.\n\n        Returns:\n            float: Spectral radiance at the given wavenumber and temperature.\n        \"\"\"\n        # Convert wavenumber from cm^-1 to m^-1 for SI-based calculations\n        nu_tilde = sigma * 100.0\n\n        # Argument for the exponential in the Planck function denominator\n        arg = C2 * nu_tilde / T\n\n        # The term exp(arg) - 1 can suffer from floating-point precision loss\n        # for small `arg`. np.expm1(arg) is used for numerical stability.\n        # If arg is too large, exp(arg) will be inf, and expm1 will handle it.\n        # If arg is zero, it would result in division by zero. However, quad\n        # avoids sampling exactly at endpoints if they are singular.\n        if arg == 0:\n            return 0.0\n        \n        # Calculate B_nutilde (radiance per m^-1)\n        # B_nutilde = (2 * h * c^2 * nu_tilde^3) / (exp(h*c*nu_tilde/(k*T)) - 1)\n        b_nu_tilde = (C1 * nu_tilde**3) / np.expm1(arg)\n\n        # Convert radiance from per m^-1 to per cm^-1 using the Jacobian |d(nu_tilde)/d(sigma)| = 100.\n        # B_sigma = B_nutilde * |d(nu_tilde)/d(sigma)|\n        b_sigma = b_nu_tilde * 100.0\n        \n        return b_sigma\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (sigma_1 [cm^-1], sigma_2 [cm^-1], Temperature [K])\n    test_cases = [\n        (800.0, 1200.0, 300.0),\n        (999.0, 1001.0, 300.0),\n        (800.0, 1200.0, 150.0),\n        (800.0, 1200.0, 1000.0),\n        (200.0, 300.0, 300.0),\n    ]\n\n    results = []\n    for sigma1, sigma2, T in test_cases:\n        # Numerically integrate the Planck function B_sigma(sigma, T)\n        # over the interval [sigma1, sigma2].\n        # quad returns the integral result and an estimated error.\n        integral_val, _ = quad(\n            planck_sigma,\n            sigma1,\n            sigma2,\n            args=(T,),\n            epsabs=1e-12, # Absolute error tolerance\n            epsrel=1e-12  # Relative error tolerance\n        )\n\n        # Calculate the band-averaged radiance by dividing the integral\n        # by the bandwidth (sigma2 - sigma1).\n        bandwidth = sigma2 - sigma1\n        if bandwidth == 0:\n            # For a zero-width band, the average is the function value itself.\n            # This is a limiting case not present in test data but good practice.\n            avg_radiance = planck_sigma((sigma1 + sigma2) / 2.0, T)\n        else:\n            avg_radiance = integral_val / bandwidth\n\n        # Format the result to scientific notation with 6 digits after the decimal point\n        results.append(f\"{avg_radiance:.6e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}