{
    "hands_on_practices": [
        {
            "introduction": "陆地表面温度（$T_s$）反演的核心任务，在于从卫星接收到的信号中“剥离”大气和地表属性的影响，这些影响由辐射传输方程（RTE）精确描述。这项练习让您亲手实践这一基础过程，通过编写程序来数值求解RTE，从而得到地表温度。这是理解和开发更复杂算法的基石。",
            "id": "3846866",
            "problem": "给定窄带热红外（TIR）波段的单通道辐射传输方程：$L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$，其中 $L_{\\text{TOA}}$ 是大气层顶光谱辐亮度，$\\tau$ 是大气透射率，$\\varepsilon$ 是地表发射率，$B(\\lambda,T_s)$ 是地表温度为 $T_s$、波长为 $\\lambda$ 时的普朗克光谱辐亮度，$L^{\\downarrow}$ 是入射到地表的下行大气光谱辐亮度，$L^{\\uparrow}$ 是上行大气光谱辐亮度。从该方程和基本的普朗克定律出发，推导出一个通过反演 $B(\\lambda,T_s)$ 来求解 $T_s$ 的数值程序，并在一个程序中实现该过程，使其能为一套测试数据生成所需的输出。\n\n使用以下经过充分检验的公式和物理常数作为基本依据：\n- 普朗克光谱辐亮度定律（单位波长）：$$B(\\lambda,T)=\\frac{2h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}}T}\\right)-1},$$ 其中 $h$ 是普朗克常数，$c$ 是真空中的光速，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 物理常数：$h=6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$，$c=2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$，$k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 所有光谱辐亮度 $L_{\\text{TOA}}$、$L^{\\uparrow}$ 和 $L^{\\downarrow}$ 均视为以 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$ 为单位的窄带光谱辐亮度，$\\lambda$ 以 $\\mu\\mathrm{m}$ 为单位给出。在内部，为了与普朗克定律保持一致，你必须将辐亮度转换为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}}$，并将波长转换为 $\\mathrm{m}$。地表温度 $T_s$ 必须以 $\\mathrm{K}$ 表示。\n\n推导目标和计算任务：\n1. 从 $L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$ 出发，推导出必须通过数值求解以获得 $T_s$ 的单调方程。你需要通过求解 $T_s$ 使得 $B(\\lambda,T_s)$ 等于从给定输入推导出的目标光谱辐亮度来进行反演。不允许使用普朗克函数的显式闭式反演；你必须使用一种基于第一性原理的稳健迭代数值方法。\n2. 描述并实现一个区间迭代程序（例如，带有可选牛顿法优化的二分法），该程序仅利用 $B(\\lambda,T)$ 相对于 $T$ 的单调性，保证在物理实际范围内收敛到 $T_s$ 的解。\n3. 为保证数值稳定性，需要一个覆盖典型陆地条件的 $T_s$（单位为 $\\mathrm{K}$）的区间，以及一个基于光谱辐亮度绝对残差或迭代间温度变化的停止准则。\n\n单位规范和输出要求：\n- 报告每个估算的地表温度 $T_s$，单位为 $\\mathrm{K}$，四舍五入到三位小数。\n- 本问题不涉及角度。\n- 不要使用百分比；任何分数形式的量必须保持为小数。\n\n测试套件：\n使用以下参数值集合创建四个物理上合理的测试场景。在每种情况下，$\\lambda$ 的单位是 $\\mu\\mathrm{m}$，$\\varepsilon$ 无单位，$\\tau$ 无单位，$L^{\\uparrow}$ 和 $L^{\\downarrow}$ 的单位是 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$。对于每个场景，仅提供一个“真实”地表温度 $T_s^{\\text{true}}$ 以通过正演模型生成一个自洽的 $L_{\\text{TOA}}$；你的程序必须通过反演方程从构建的 $L_{\\text{TOA}}$ 中估算 $T_s$。\n\n- 案例 $1$（一般理想情况）：$\\lambda=10.8\\,\\mu\\mathrm{m}$，$\\varepsilon=0.98$，$\\tau=0.85$，$L^{\\uparrow}=1.2\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$L^{\\downarrow}=2.6\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$T_s^{\\text{true}}=300\\,\\mathrm{K}$。\n- 案例 $2$（低发射率地表）：$\\lambda=11.0\\,\\mu\\mathrm{m}$，$\\varepsilon=0.85$，$\\tau=0.95$，$L^{\\uparrow}=0.6\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$L^{\\downarrow}=1.8\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$T_s^{\\text{true}}=320\\,\\mathrm{K}$。\n- 案例 $3$（强路径大气效应）：$\\lambda=12.0\\,\\mu\\mathrm{m}$，$\\varepsilon=0.99$，$\\tau=0.50$，$L^{\\uparrow}=3.5\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$L^{\\downarrow}=4.2\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$T_s^{\\text{true}}=280\\,\\mathrm{K}$。\n- 案例 $4$（近黑体，高透射率）：$\\lambda=10.5\\,\\mu\\mathrm{m}$，$\\varepsilon=1.00$，$\\tau=0.90$，$L^{\\uparrow}=1.0\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$L^{\\downarrow}=2.0\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$，$T_s^{\\text{true}}=295\\,\\mathrm{K}$。\n\n在每种情况下，使用正演辐射传输方程和给定的 $T_s^{\\text{true}}$ 构建 $L_{\\text{TOA}}$，然后通过数值反演方程来估算 $T_s$。你的程序应生成一行输出，其中包含四个估算的温度，格式为用方括号括起来的逗号分隔列表（例如，$[300.000,319.997,280.003,295.000]$），每个值都以 $\\mathrm{K}$ 为单位，并四舍五入到三位小数。",
            "solution": "该问题要求推导并实现一个数值程序，通过反演单通道辐射传输方程来确定地表温度（$T_s$）。验证过程确认了该问题具有科学依据、问题设定良好，并且所有必要的数据和物理常数都已提供。因此，我们可以着手求解。\n\n### 1. 目标方程的推导\n\n起点是用于窄带热红外波段的单通道辐射传输方程（RTE），它模拟了卫星传感器测量的辐亮度：\n$$L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$$\n其中，$L_{\\text{TOA}}$ 是观测到的大气层顶辐亮度，$\\tau$ 是大气透射率，$\\varepsilon$ 是地表发射率，$L^{\\downarrow}$ 和 $L^{\\uparrow}$ 分别是下行和上行大气辐亮度，$B(\\lambda, T_s)$ 是地表在温度 $T_s$ 和波长 $\\lambda$ 下发射的普朗克光谱辐亮度。我们的目标是求解此方程以得到 $T_s$。\n\n为此，我们必须首先在代数上分离出包含未知数 $B(\\lambda, T_s)$ 的项。此过程分步进行：\n\n1.  从方程两边减去上行大气辐亮度 $L^{\\uparrow}$：\n    $$L_{\\text{TOA}} - L^{\\uparrow} = \\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]$$\n2.  除以大气透射率 $\\tau$。这在物理上是允许的，因为对于任何非不透明大气，$\\tau > 0$。此步骤校正了信号穿过大气时的衰减。\n    $$\\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} = \\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}$$\n3.  左边的项代表离开地表的总辐亮度。它由两部分组成：地表发射的辐亮度 $\\varepsilon B(\\lambda, T_s)$，以及地表反射的下行大气辐亮度部分 $(1-\\varepsilon)L^{\\downarrow}$。我们通过减去反射部分来分离出发射部分：\n    $$\\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} = \\varepsilon B(\\lambda,T_s)$$\n4.  最后，为了求出温度为 $T_s$ 的黑体所发射的辐亮度，我们除以地表发射率 $\\varepsilon$。这对任何 $\\varepsilon>0$ 的物理表面都有效。\n    $$B(\\lambda,T_s) = \\frac{1}{\\varepsilon} \\left[ \\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} \\right]$$\n\n该方程为普朗克函数提供了一个目标值。我们将此目标光谱辐亮度表示为 $B_{\\text{target}}$：\n$$B_{\\text{target}} = \\frac{1}{\\varepsilon} \\left[ \\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} \\right]$$\n现在，求解 $T_s$ 的问题简化为求解以下关于 $T_s$ 的方程：\n$$B(\\lambda, T_s) = B_{\\text{target}}$$\n其中 $B(\\lambda, T_s)$ 由普朗克定律给出：\n$$B(\\lambda,T_s)=\\frac{2h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}}T_s}\\right)-1}$$\n\n### 2. 数值反演程序\n\n根据要求，我们不能使用普朗克定律的显式闭式反演。相反，我们必须采用迭代数值方法。这等同于寻找残差函数 $f(T_s)$ 的根，该函数定义为：\n$$f(T_s) = B(\\lambda, T_s) - B_{\\text{target}} = 0$$\n\n数值求根算法的适用性取决于函数 $f(T_s)$ 的性质。普朗克函数关于温度 $T$（对于 $T>0$）的导数为：\n$$\\frac{\\partial B}{\\partial T} = \\frac{2h^2c^3}{\\lambda^6 k_B T^2} \\frac{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)}{\\left(\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)-1\\right)^2} > 0$$\n由于此表达式中的所有物理常数和变量均为正，该导数严格为正。这证明了 $B(\\lambda, T_s)$ 是 $T_s$ 的严格单调递增函数。因此，残差函数 $f(T_s)$ 也是严格单调的，这保证了如果根被限定在一个区间内，则存在唯一的根。\n\n我们将使用**二分法**，这是一种稳健的、利用这种单调性的区间求根算法。其步骤如下：\n1.  **区间设定**：选择一个初始搜索区间 $[T_a, T_b]$，确保解 $T_s$ 包含在内。该区间必须满足 $f(T_a)  0$ 和 $f(T_b) > 0$。对于陆地应用，$[200\\,\\mathrm{K}, 350\\,\\mathrm{K}]$ 是一个保守且稳健的选择，涵盖了从极寒到炎热沙漠的各种条件。\n2.  **迭代**：\n    a. 计算区间的中点：$T_m = (T_a + T_b) / 2$。\n    b. 在中点处评估残差函数，$f(T_m) = B(\\lambda, T_m) - B_{\\text{target}}$。\n    c. 如果 $f(T_m)  0$，根必定位于区间的上半部分，因此新区间变为 $[T_m, T_b]$。\n    d. 如果 $f(T_m) > 0$，根必定位于区间的下半部分，因此新区间变为 $[T_a, T_m]$。\n    e. 如果 $f(T_m) = 0$，则已找到精确的根。\n3.  **终止**：迭代过程持续进行，直到区间大小 $|T_b - T_a|$ 小于预设的容差 $\\delta_T$。容差 $\\delta_T = 10^{-6}\\,\\mathrm{K}$ 足以确保所需的三位小数输出精度。最终的 $T_s$ 估算值取为最终区间的中点。\n\n### 3. 实现细节\n\n实现必须严格遵守物理原理和单位一致性。\n-   **单位转换**：所有输入参数必须转换为国际单位制（SI）基本单位，以便在普朗克函数中使用。波长 $\\lambda$（单位 $\\mu\\text{m}$）通过乘以 $10^{-6}$ 转换为米。光谱辐亮度（$L_{\\text{TOA}}$、$L^{\\uparrow}$、$L^{\\downarrow}$）（单位 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$）通过乘以 $10^6$ 转换为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}}$。\n-   **物理常数**：为提高计算效率，预先计算第一和第二辐射常数：\n    $$c_1 = 2hc^2 \\approx 1.19104297 \\times 10^{-16} \\, \\mathrm{W\\,m^2\\,sr^{-1}}$$\n    $$c_2 = \\frac{hc}{k_{\\mathrm{B}}} \\approx 0.0143877686 \\, \\mathrm{m\\,K}$$\n    然后，普朗克函数计算为 $B(\\lambda, T) = c_1 / (\\lambda^5 (\\exp(c_2 / (\\lambda T)) - 1))$。\n-   **测试案例流程**：对于每个测试案例，我们首先使用给定的参数和 $T_s^{\\text{true}}$ 通过正演RTE计算出合成的 $L_{\\text{TOA}}$。然后，这个 $L_{\\text{TOA}}$ 作为反演算法的输入，用于估算 $T_s$。这个流程验证了反演是否正确地逆转了正演模型，估算出的 $T_s$ 应与 $T_s^{\\text{true}}$ 非常接近，微小差异可归因于浮点精度。\n\n这种严谨的推导与稳健的数值方法相结合，确保了地表温度的求解准确可靠。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a numerical procedure to solve for Land Surface Temperature (LST).\n    \"\"\"\n\n    # Physical constants\n    H = 6.62607015e-34  # Planck's constant (J s)\n    C = 2.99792458e8  # Speed of light in vacuum (m/s)\n    KB = 1.380649e-23  # Boltzmann constant (J/K)\n    \n    # Pre-calculated radiation constants for Planck's law\n    C1 = 2 * H * C**2  # First radiation constant (W m^2 sr^-1)\n    C2 = (H * C) / KB  # Second radiation constant (m K)\n\n    def planck_radiance(lambda_m, temp_k):\n        \"\"\"\n        Calculates spectral radiance using Planck's law.\n        \n        Args:\n            lambda_m (float): Wavelength in meters (m).\n            temp_k (float): Temperature in Kelvin (K).\n            \n        Returns:\n            float: Spectral radiance in W m^-2 sr^-1 m^-1.\n        \"\"\"\n        if temp_k == 0:\n            return 0.0\n        val = C2 / (lambda_m * temp_k)\n        # Handle potential overflow for very large exponents\n        if val > np.log(np.finfo(float).max):\n            return 0.0\n        return C1 / (lambda_m**5 * (np.exp(val) - 1))\n\n    def estimate_lst_bisection(lambda_um, epsilon, tau, L_up_um, L_down_um, L_toa_um):\n        \"\"\"\n        Estimates LST by numerically inverting the radiative transfer equation.\n\n        Args:\n            lambda_um (float): Wavelength in micrometers (µm).\n            epsilon (float): Surface emissivity (unitless).\n            tau (float): Atmospheric transmittance (unitless).\n            L_up_um (float): Upwelling radiance in W m^-2 sr^-1 µm^-1.\n            L_down_um (float): Downwelling radiance in W m^-2 sr^-1 µm^-1.\n            L_toa_um (float): Top-of-atmosphere radiance in W m^-2 sr^-1 µm^-1.\n\n        Returns:\n            float: Estimated Land Surface Temperature in Kelvin (K).\n        \"\"\"\n        # --- Unit Conversion to SI ---\n        # Convert wavelength from µm to m\n        lambda_m = lambda_um * 1e-6\n        # Convert radiances from per-µm to per-m\n        L_up_si = L_up_um * 1e6\n        L_down_si = L_down_um * 1e6\n        L_toa_si = L_toa_um * 1e6\n\n        # --- Inversion Step 1: Calculate Target Blackbody Radiance ---\n        if tau == 0 or epsilon == 0:\n            # Physical constraints, avoid division by zero\n            return -1.0 \n\n        radiance_at_surface = (L_toa_si - L_up_si) / tau\n        emitted_radiance = radiance_at_surface - (1 - epsilon) * L_down_si\n        B_target = emitted_radiance / epsilon\n\n        if B_target  0:\n            # Non-physical result, indicates bad input parameters\n            return -1.0\n\n        # --- Inversion Step 2: Bisection Method ---\n        # Define the residual function to find the root of\n        def residual_function(temp_k):\n            return planck_radiance(lambda_m, temp_k) - B_target\n\n        # Set a robust bracketing interval for terrestrial temperatures\n        Ta = 200.0  # Lower bound in Kelvin\n        Tb = 350.0  # Upper bound in Kelvin\n        \n        # Validate the bracket\n        if residual_function(Ta) > 0 or residual_function(Tb)  0:\n            # Root is not bracketed, which is highly unlikely for valid inputs\n            # Extend bracket if necessary, or return error\n            # For this problem, we assume the initial bracket is sufficient.\n            # A more robust implementation might dynamically find a bracket.\n            pass\n\n        # Set the tolerance for the temperature estimate\n        tolerance = 1e-6\n        \n        # Bisection loop\n        while (Tb - Ta) > tolerance:\n            Tm = (Ta + Tb) / 2\n            if residual_function(Tm)  0:\n                Ta = Tm\n            else:\n                Tb = Tm\n\n        return (Ta + Tb) / 2\n\n    test_cases = [\n        # (lambda_um, epsilon, tau, L_up_um, L_down_um, T_s_true_K)\n        (10.8, 0.98, 0.85, 1.2, 2.6, 300.0),\n        (11.0, 0.85, 0.95, 0.6, 1.8, 320.0),\n        (12.0, 0.99, 0.50, 3.5, 4.2, 280.0),\n        (10.5, 1.00, 0.90, 1.0, 2.0, 295.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_um, epsilon, tau, L_up_um, L_down_um, T_s_true_K = case\n\n        # --- FORWARD MODEL: Generate synthetic L_TOA ---\n        # Convert units for forward calculation\n        lambda_m = lambda_um * 1e-6\n        L_up_si = L_up_um * 1e6\n        L_down_si = L_down_um * 1e6\n\n        # Calculate blackbody radiance for the true temperature\n        B_true_si = planck_radiance(lambda_m, T_s_true_K)\n        \n        # Apply the Radiative Transfer Equation\n        L_toa_si = tau * (epsilon * B_true_si + (1 - epsilon) * L_down_si) + L_up_si\n        \n        # Convert synthetic L_toa back to per-µm units for the inversion function input\n        L_toa_um = L_toa_si / 1e6\n\n        # --- INVERSION: Estimate T_s from synthetic L_TOA ---\n        T_s_estimated = estimate_lst_bisection(\n            lambda_um, epsilon, tau, L_up_um, L_down_um, L_toa_um\n        )\n        \n        results.append(T_s_estimated)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然直接数值反演方法很精确，但业务化算法常采用更简洁的近似形式以提高效率。这项练习将引导您从物理原理出发，推导一个基础的劈窗算法，展示其核心思想：如何利用不同通道对水汽（$W$）吸收的差异来构建对大气不敏感的$T_s$估算。这个过程揭示了劈窗算法系数背后的物理意义。",
            "id": "3846994",
            "problem": "一颗卫星通过一个垂直均匀的平面平行大气层观测地表，观测波段位于热红外分裂窗，中心在两个通道，一个在 $10.8\\,\\mu\\mathrm{m}$ 附近（记其亮温为 $T_{10}$），另一个在 $12.0\\,\\mu\\mathrm{m}$ 附近（记其亮温为 $T_{11}$）。假设天底观测，地表发射率为 $1$，热红外波段的反射和散射可忽略不计，且处于局部热力学平衡（LTE），因此发射遵循普朗克函数。设大气为中纬度夏季类型，其特征为总水汽柱含量 $W$（单位为 $\\mathrm{g}\\,\\mathrm{cm}^{-2}$）。设与通道相关的大气透过率遵循比尔-朗伯定律 $\\tau_{i}(W)=\\exp\\!\\left(-k_{i}\\,W\\right)$，其中吸收系数为 $k_{10}$ 和 $k_{11}$（单位为 $\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$）。采用窄带近似，并将普朗克函数在具有代表性的大气平均辐射温度 $T_{a}$ 附近进行线性化，以将辐亮度与亮温联系起来。\n\n严格从这些原理出发，首先推导斜率 $\\partial\\!\\left(T_{10}-T_{11}\\right)/\\partial W$ 的一个通用表达式，用 $k_{10}$、$k_{11}$、$\\tau_{10}(W)$、$\\tau_{11}(W)$、$T_{a}$ 和地表温度 $T_{s}$ 表示。接下来，考虑用于地表温度（LST）的标准双通道分裂窗估算器 $\\widehat{T}_{s}=T_{11}+a\\left(T_{10}-T_{11}\\right)$，并确定系数 $a$ 的值，使得 $\\widehat{T}_{s}$ 在指定的 $W_{0}$ 附近对 $W$ 的一阶扰动局部不敏感；即，强制 $\\left.\\partial \\widehat{T}_{s}/\\partial W\\right|_{W=W_{0}}=0$，并用 $k_{10}$、$k_{11}$、$\\tau_{10}(W_{0})$ 和 $\\tau_{11}(W_{0})$ 表示 $a$。\n\n最后，对于中纬度夏季的情况，使用 $k_{10}=0.07\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$、$k_{11}=0.13\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$、$W_{0}=3.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$、$T_{s}=302\\,\\mathrm{K}$ 和 $T_{a}=280\\,\\mathrm{K}$，数值计算斜率 $\\left.\\partial\\!\\left(T_{10}-T_{11}\\right)/\\partial W\\right|_{W=W_{0}}$ 和相应的 $a$。\n\n将斜率以 $\\mathrm{K}$ 每 $\\mathrm{g}\\,\\mathrm{cm}^{-2}$ 为单位表示，系数 $a$ 为无量纲。将您的答案四舍五入到三位有效数字。最终答案必须是计算结果。",
            "solution": "我们从与通道相关的大气透过率的比尔-朗伯定律开始，$\\tau_{i}(W)=\\exp\\!\\left(-k_{i}\\,W\\right)$，其中 $i\\in\\{10,11\\}$。在热红外波段，根据所述假设（天底观测，发射率为1，反射/散射可忽略不计，局部热力学平衡），传感器在通道 $i$ 处接收到的上行辐亮度可以建模为衰减后的地表发射和大气自身发射的线性叠加：\n$$\nL_{i}(W)=\\tau_{i}(W)\\,B_{i}(T_{s})+\\left[1-\\tau_{i}(W)\\right]\\,B_{i}(T_{a}),\n$$\n其中 $B_{i}(T)$ 表示通道 $i$ 的波段有效普朗克函数。通道亮温 $T_{i}$ 由 $B_{i}(T_{i})=L_{i}$ 隐式定义。使用窄带近似并将 $B_{i}(T)$ 在 $T_{a}$ 附近进行线性化，\n$$\nB_{i}(T)\\approx B_{i}(T_{a})+B_{i}'(T_{a})\\,(T-T_{a}),\n$$\n我们得到\n$$\nB_{i}(T_{i})\\approx B_{i}(T_{a})+B_{i}'(T_{a})\\,(T_{i}-T_{a})=\\tau_{i}(W)\\,\\big[B_{i}(T_{a})+B_{i}'(T_{a})(T_{s}-T_{a})\\big]+\\big[1-\\tau_{i}(W)\\big]\\,B_{i}(T_{a}).\n$$\n消去 $B_{i}(T_{a})$ 并除以 $B_{i}'(T_{a})$，得到\n$$\nT_{i}\\approx \\tau_{i}(W)\\,T_{s}+\\big[1-\\tau_{i}(W)\\big]\\,T_{a}.\n$$\n因此，分裂窗亮温差为\n$$\nT_{10}-T_{11}\\approx \\big[\\tau_{10}(W)-\\tau_{11}(W)\\big]\\,(T_{s}-T_{a}).\n$$\n对 $W$ 求导并使用 $\\frac{\\partial \\tau_{i}}{\\partial W}=-k_{i}\\,\\tau_{i}(W)$，得到通用斜率\n$$\n\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}=\\Big(-k_{10}\\,\\tau_{10}(W)+k_{11}\\,\\tau_{11}(W)\\Big)\\,(T_{s}-T_{a})=\\Big(k_{11}\\,\\tau_{11}(W)-k_{10}\\,\\tau_{10}(W)\\Big)\\,(T_{s}-T_{a}).\n$$\n\n现在我们将此斜率与地表温度（LST）的双通道分裂窗估算器中的系数 $a$ 联系起来，\n$$\n\\widehat{T}_{s}(W)=T_{11}(W)+a\\big(T_{10}(W)-T_{11}(W)\\big).\n$$\n要求 $\\widehat{T}_{s}$ 在 $W=W_{0}$ 处对 $W$ 具有局部一阶不敏感性，需要\n$$\n\\left.\\frac{\\partial \\widehat{T}_{s}}{\\partial W}\\right|_{W=W_{0}}=\\left.\\frac{\\partial T_{11}}{\\partial W}\\right|_{W=W_{0}}+a\\,\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W=W_{0}}=0.\n$$\n解出 $a$ 得到\n$$\na=-\\frac{\\left.\\frac{\\partial T_{11}}{\\partial W}\\right|_{W_{0}}}{\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}}.\n$$\n从 $T_{i}(W)\\approx \\tau_{i}(W)T_{s}+\\big[1-\\tau_{i}(W)\\big]T_{a}$，我们有\n$$\n\\frac{\\partial T_{i}}{\\partial W}=\\frac{\\partial \\tau_{i}}{\\partial W}\\,(T_{s}-T_{a})=-k_{i}\\,\\tau_{i}(W)\\,(T_{s}-T_{a}).\n$$\n代入 $a$ 的表达式并消去公因子 $(T_{s}-T_{a})$，得到闭合形式关系\n$$\na=\\frac{k_{11}\\,\\tau_{11}(W_{0})}{k_{11}\\,\\tau_{11}(W_{0})-k_{10}\\,\\tau_{10}(W_{0})}.\n$$\n\n我们现在对指定的中纬度夏季情况进行数值计算，以求得斜率和 $a$：$k_{10}=0.07\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，$k_{11}=0.13\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，$W_{0}=3.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$，$T_{s}=302\\,\\mathrm{K}$ 和 $T_{a}=280\\,\\mathrm{K}$。首先计算 $W_{0}$ 处的透过率：\n$$\n\\tau_{10}(W_{0})=\\exp\\!\\big(-k_{10}W_{0}\\big)=\\exp\\!\\big(-0.07\\times 3.2\\big)=\\exp(-0.224)\\approx 0.799369,\n$$\n$$\n\\tau_{11}(W_{0})=\\exp\\!\\big(-k_{11}W_{0}\\big)=\\exp\\!\\big(-0.13\\times 3.2\\big)=\\exp(-0.416)\\approx 0.659748.\n$$\n计算乘积 $k_{10}\\tau_{10}(W_{0})$ 和 $k_{11}\\tau_{11}(W_{0})$：\n$$\nk_{10}\\tau_{10}(W_{0})\\approx 0.07\\times 0.799369\\approx 0.0559558,\\qquad\nk_{11}\\tau_{11}(W_{0})\\approx 0.13\\times 0.659748\\approx 0.0857672.\n$$\n在 $W_{0}$ 处的亮温差斜率为\n$$\n\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}=\\big(k_{11}\\tau_{11}(W_{0})-k_{10}\\tau_{10}(W_{0})\\big)\\,(T_{s}-T_{a})\\approx (0.0857672-0.0559558)\\times (302-280).\n$$\n计算数值：\n$$\n0.0857672-0.0559558=0.0298114,\\quad T_{s}-T_{a}=22,\n$$\n$$\n\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}\\approx 0.0298114\\times 22\\approx 0.655851\\ \\mathrm{K}\\,\\mathrm{(g\\,cm^{-2})}^{-1}.\n$$\n在 $W_{0}$ 处的系数 $a$ 为\n$$\na=\\frac{k_{11}\\tau_{11}(W_{0})}{k_{11}\\tau_{11}(W_{0})-k_{10}\\tau_{10}(W_{0})}\\approx \\frac{0.0857672}{0.0298114}\\approx 2.87731.\n$$\n将两者均四舍五入到三位有效数字，斜率为 $0.656$ $\\mathrm{K}$ 每 $\\mathrm{g}\\,\\mathrm{cm}^{-2}$，系数 $a$ 为 $2.88$（无量纲）。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.656  2.88\\end{pmatrix}}$$"
        },
        {
            "introduction": "任何算法的设计都伴随着权衡。劈窗算法在校正大气效应方面很有效，但它对传感器自身的不完美性（如定标误差）的敏感度如何？这项关键练习通过定量分析和比较单通道与劈窗算法对辐射定标误差的响应，揭示了算法在校正一种误差时可能放大另一种误差的内在特性，这是遥感算法设计中的一个深刻主题。",
            "id": "3847000",
            "problem": "一颗极轨卫星在均一的陆地表面上测量两个通道的热红外窗区辐射率，这两个通道的中心波长分别为 $ \\lambda_{1} = 11\\ \\mu\\mathrm{m} $ 和 $ \\lambda_{2} = 12\\ \\mu\\mathrm{m} $。假设地表温度 (LST)，记为 $ T_{s} $，在空间上是均一的，且等于 $ T_{s} = 300\\ \\mathrm{K} $。地表为近黑体，发射率 $ \\varepsilon \\approx 1 $，观测为天底观测，且大气足够晴朗和干燥，因此为了一阶定标误差灵敏度分析的目的，可以忽略上行和下行路径项，大气透过率近似为1。在这些简化条件下，每个通道中传感器测得的辐射率主要由地表发射决定。\n\n设单位波长的光谱辐射率遵循普朗克定律，\n\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}}\\left(\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1\\right)^{-1},\n$$\n\n其中 $ h $ 是普朗克常数，$ c $ 是光速，$ k_{B} $ 是玻尔兹曼常数。定义 $ c_{2} \\equiv \\frac{h c}{k_{B}} $ 并取 $ c_{2} = 1.4387769 \\times 10^{-2}\\ \\mathrm{m\\cdot K} $。通道 $ i $ 的亮温 $ T_{b,i} $ 定义为满足 $ B_{\\lambda}(\\lambda_{i}, T_{b,i}) = L_{i} $ 的普朗克逆温，其中 $ L_{i} $ 是通道 $ i $ 的传感器接收到的辐射率。\n\n假设通道 $ 1 $ 的辐射定标出现了一个 $ \\delta = 0.005 $ 的乘性增益漂移（即测量辐射率是真实辐射率的 $ (1+\\delta) $ 倍），而通道 $ 2 $ 保持完美定标。你将比较两种地表温度反演方法对这种漂移的灵敏度：\n\n- 一种仅使用通道 $ 1 $ 的单通道算法，在所述假设下，反演得到的 $ T_{s} \\approx T_{b,1} $。\n- 一种劈窗（SW）算法，它使用两个亮温的一阶线性组合来消除水汽依赖性的一阶项。为了从辐射传输中推导系数，采用标准的线性化窗区通道模型\n\n$$\nT_{b,i} \\approx T_{s} - m_{i} W,\n$$\n\n其中 $ W $ 是柱水汽含量描述符，$ m_{i} $ 是与通道相关的非负系数。对于此场景，取 $ m_{1} = 2.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}} $ 和 $ m_{2} = 3.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}} $。施加两个约束条件，使得在没有定标漂移的情况下，SW反演相对于 $ T_{s} $ 是无偏的，并且消除了一阶 $ W $ 依赖性：\n\n$$\nw_{1} + w_{2} = 1,\\quad w_{1} m_{1} + w_{2} m_{2} = 0,\n$$\n\n使得劈窗反演为 $ T_{s,\\mathrm{SW}} \\approx w_{1} T_{b,1} + w_{2} T_{b,2} $。\n\n任务：\n1. 从普朗克定律和一阶微扰分析出发，推导在通道 $ i $ 中响应于一个小的乘性辐射增益误差 $ \\delta $ 的亮温一阶偏差 $ \\Delta T_{b,i} $ 的表达式。你的表达式应以 $ \\delta $、$ T_{b,i} $、$ \\lambda_{i} $ 和 $ c_{2} $ 表示。\n2. 使用任务1中你推导的表达式，计算在 $ \\lambda_{1} = 11\\ \\mu\\mathrm{m} $，$ T_{b,1} \\approx T_{s} = 300\\ \\mathrm{K} $ 和 $ \\delta = 0.005 $ 条件下，通道1的单通道地表温度数值偏差 $ \\Delta T_{s,\\mathrm{SC}} $。以开尔文（Kelvin）表示此偏差。\n3. 根据上述约束条件求解劈窗权重 $ w_{1} $ 和 $ w_{2} $。\n4. 在仅通道 $ 1 $ 存在所述定标漂移的情况下，确定劈窗地表温度偏差 $ \\Delta T_{s,\\mathrm{SW}} $，用 $ \\Delta T_{b,1} $ 和权重 $ w_{1}, w_{2} $ 表示。\n5. 最后，计算比率\n\n$$\nR \\equiv \\frac{|\\Delta T_{s,\\mathrm{SC}}|}{|\\Delta T_{s,\\mathrm{SW}}|}.\n$$\n\n将你的答案 $ R $ 四舍五入到三位有效数字。将 $ R $ 表示为一个纯数（无单位）。在最终的方框答案中不要包含单位。",
            "solution": "首先验证问题以确保其具有科学依据、良定性和客观性。\n\n1.  **已知条件提取**：\n    -   通道波长：$ \\lambda_{1} = 11\\ \\mu\\mathrm{m} $，$ \\lambda_{2} = 12\\ \\mu\\mathrm{m} $。\n    -   地表温度：$ T_{s} = 300\\ \\mathrm{K} $。\n    -   地表发射率：$ \\varepsilon \\approx 1 $。\n    -   大气条件：晴朗，干燥，路径项被忽略，透过率为1。\n    -   普朗克定律：$B_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}}\\left(\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1\\right)^{-1}$。\n    -   常数：$ c_{2} = \\frac{h c}{k_{B}} = 1.4387769 \\times 10^{-2}\\ \\mathrm{m\\cdot K} $。\n    -   亮温定义：$ B_{\\lambda}(\\lambda_{i}, T_{b,i}) = L_{i} $。\n    -   通道1的定标漂移：$ \\delta = 0.005 $。\n    -   单通道 (SC) 算法：$ T_{s,\\mathrm{SC}} \\approx T_{b,1} $。\n    -   劈窗 (SW) 线性化模型：$ T_{b,i} \\approx T_{s} - m_{i} W $。\n    -   模型系数：$ m_{1} = 2.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}} $，$ m_{2} = 3.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}} $。\n    -   SW 算法约束条件：$w_{1} + w_{2} = 1$ 和 $w_{1} m_{1} + w_{2} m_{2} = 0$。\n    -   SW 反演：$ T_{s,\\mathrm{SW}} \\approx w_{1} T_{b,1} + w_{2} T_{b,2} $。\n\n2.  **验证**：\n    -   该问题在科学上基于辐射传输和卫星遥感的原理。使用普朗克定律、亮温以及简化的单通道/劈窗算法是进行灵敏度分析的标准做法。\n    -   该问题是良定的，提供了所有必要的数据和清晰的任务序列，可导出一个唯一解。\n    -   语言是客观和精确的。\n    -   所提供的值在物理上是现实的。\n\n3.  **结论**：该问题是有效的。将提供完整解答。\n\n**任务1：亮温偏差的推导**\n\n辐射率 $L_i$ 和亮温 $T_{b,i}$ 之间的关系由普朗克定律给出，其中 $L_i = B_\\lambda(\\lambda_i, T_{b,i})$。对于热红外波长和典型的地球温度，指数的宗量 $\\frac{hc}{\\lambda k_B T} = \\frac{c_2}{\\lambda T}$ 远大于 $1$。对于 $\\lambda = 11\\ \\mu\\mathrm{m}$ 和 $T=300\\ \\mathrm{K}$，$\\frac{c_2}{\\lambda T} \\approx 4.36 \\gg 1$。因此，$\\exp(\\frac{c_2}{\\lambda T}) \\gg 1$，我们可以使用维恩近似进行一阶分析：\n$$\nL_i = B_{\\lambda}(\\lambda_i, T_{b,i}) \\approx \\frac{2 h c^2}{\\lambda_i^5} \\exp\\left(-\\frac{c_2}{\\lambda_i T_{b,i}}\\right)\n$$\n为了找到辐射率的微小变化 $\\Delta L_i$ 和亮温的微小变化 $\\Delta T_{b,i}$ 之间的关系，我们可以进行微分。首先取自然对数会很方便：\n$$\n\\ln(L_i) \\approx \\ln\\left(\\frac{2 h c^2}{\\lambda_i^5}\\right) - \\frac{c_2}{\\lambda_i T_{b,i}}\n$$\n对 $T_{b,i}$ 和 $L_i$ 求导并考虑小扰动：\n$$\n\\frac{d L_i}{L_i} \\approx \\left(- \\frac{c_2}{\\lambda_i}\\right) \\left(- \\frac{1}{T_{b,i}^2}\\right) d T_{b,i} = \\frac{c_2}{\\lambda_i T_{b,i}^2} d T_{b,i}\n$$\n对 $d T_{b,i}$ 进行整理，并用小的有限变化量 ($\\Delta$) 来近似微分：\n$$\n\\Delta T_{b,i} \\approx \\frac{\\lambda_i T_{b,i}^2}{c_2} \\frac{\\Delta L_i}{L_i}\n$$\n乘性辐射增益误差 $\\delta$ 意味着测量辐射率 $L'_{i}$ 与真实辐射率 $L_i$ 的关系为 $L'_{i} = (1+\\delta)L_i$。辐射率的变化是 $\\Delta L_i = L'_{i} - L_i = \\delta L_i$。因此，分数变化为 $\\frac{\\Delta L_i}{L_i} = \\delta$。\n将此代入我们关于 $\\Delta T_{b,i}$ 的表达式中：\n$$\n\\Delta T_{b,i} \\approx \\frac{\\lambda_i T_{b,i}^2}{c_2} \\delta\n$$\n\n**任务2：单通道LST偏差的计算**\n\n单通道算法将LST反演为 $T_{s,\\mathrm{SC}} \\approx T_{b,1}$。因此，反演的LST偏差 $\\Delta T_{s,\\mathrm{SC}}$ 等于通道1的亮温偏差 $\\Delta T_{b,1}$。使用任务1中针对通道1的表达式：\n$$\n\\Delta T_{s,\\mathrm{SC}} = \\Delta T_{b,1} \\approx \\frac{\\lambda_1 T_{b,1}^2}{c_2} \\delta\n$$\n我们已知以下值：\n- $\\lambda_1 = 11\\ \\mu\\mathrm{m} = 11 \\times 10^{-6}\\ \\mathrm{m}$\n- $T_{b,1} \\approx T_s = 300\\ \\mathrm{K}$\n- $\\delta = 0.005$\n- $c_2 = 1.4387769 \\times 10^{-2}\\ \\mathrm{m\\cdot K}$\n\n代入这些值：\n$$\n\\Delta T_{s,\\mathrm{SC}} \\approx \\frac{(11 \\times 10^{-6}\\ \\mathrm{m}) (300\\ \\mathrm{K})^2}{1.4387769 \\times 10^{-2}\\ \\mathrm{m\\cdot K}} \\times 0.005\n$$\n$$\n\\Delta T_{s,\\mathrm{SC}} \\approx \\frac{(11 \\times 10^{-6}) (9 \\times 10^4)}{1.4387769 \\times 10^{-2}} \\times 0.005\\ \\mathrm{K}\n$$\n$$\n\\Delta T_{s,\\mathrm{SC}} \\approx \\frac{0.99}{0.014387769} \\times 0.005\\ \\mathrm{K} \\approx (68.8066) \\times 0.005\\ \\mathrm{K} \\approx 0.344033\\ \\mathrm{K}\n$$\n所以，单通道LST偏差约为 $0.344\\ \\mathrm{K}$。\n\n**任务3：求解劈窗权重**\n\n劈窗权重 $w_1$ 和 $w_2$ 由以下二元线性方程组确定：\n1. $w_1 + w_2 = 1$\n2. $w_1 m_1 + w_2 m_2 = 0$\n\n从方程 (1) 中，我们得到 $w_2 = 1 - w_1$。将其代入方程 (2) 中：\n$$\nw_1 m_1 + (1 - w_1) m_2 = 0\n$$\n$$\nw_1 m_1 + m_2 - w_1 m_2 = 0\n$$\n$$\nw_1 (m_1 - m_2) = -m_2\n$$\n$$\nw_1 = \\frac{-m_2}{m_1 - m_2} = \\frac{m_2}{m_2 - m_1}\n$$\n我们已知 $m_1 = 2.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}}$ 和 $m_2 = 3.0\\ \\mathrm{K\\,(g\\ cm^{-2})^{-1}}$。\n$$\nw_1 = \\frac{3.0}{3.0 - 2.0} = \\frac{3.0}{1.0} = 3\n$$\n现在，我们求解 $w_2$：\n$$\nw_2 = 1 - w_1 = 1 - 3 = -2\n$$\n权重为 $w_1 = 3$ 和 $w_2 = -2$。\n\n**任务4：确定劈窗LST偏差**\n\n劈窗LST反演由 $T_{s,\\mathrm{SW}} = w_1 T_{b,1} + w_2 T_{b,2}$ 给出。此反演的偏差 $\\Delta T_{s,\\mathrm{SW}}$ 是由于输入亮温的偏差 $\\Delta T_{b,1}$ 和 $\\Delta T_{b,2}$ 引起的反演LST的变化。\n$$\n\\Delta T_{s,\\mathrm{SW}} = w_1 \\Delta T_{b,1} + w_2 \\Delta T_{b,2}\n$$\n问题陈述只有通道1存在定标漂移（$\\delta = 0.005$），而通道2是完美定标的。这意味着通道1存在偏差 $\\Delta T_{b,1}$，但通道2的偏差为零：$\\Delta T_{b,2} = 0$。\n因此，劈窗LST偏差简化为：\n$$\n\\Delta T_{s,\\mathrm{SW}} = w_1 \\Delta T_{b,1}\n$$\n\n**任务5：计算比率R**\n\n我们被要求计算比率 $R \\equiv \\frac{|\\Delta T_{s,\\mathrm{SC}}|}{|\\Delta T_{s,\\mathrm{SW}}|}$。\n根据我们之前的结果：\n- $\\Delta T_{s,\\mathrm{SC}} = \\Delta T_{b,1}$\n- $\\Delta T_{s,\\mathrm{SW}} = w_1 \\Delta T_{b,1}$\n\n将这些代入 $R$ 的定义中：\n$$\nR = \\frac{|\\Delta T_{b,1}|}{|w_1 \\Delta T_{b,1}|}\n$$\n由于 $\\Delta T_{b,1}$ 非零，我们可以从分子和分母中消去它：\n$$\nR = \\frac{1}{|w_1|}\n$$\n使用任务3中得到的值 $w_1 = 3$：\n$$\nR = \\frac{1}{|3|} = \\frac{1}{3}\n$$\n作为小数，$R = 0.3333...$。四舍五入到三位有效数字得到：\n$$\nR \\approx 0.333\n$$",
            "answer": "$$\\boxed{0.333}$$"
        }
    ]
}