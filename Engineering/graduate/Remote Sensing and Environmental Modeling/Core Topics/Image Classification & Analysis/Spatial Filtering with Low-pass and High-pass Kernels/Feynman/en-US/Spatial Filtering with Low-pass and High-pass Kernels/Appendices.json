{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the theory of spatial filtering, it is crucial to grasp the computational demands of the underlying convolution operation. This practice  challenges you to calculate the operational cost for a typical scenario, building an intuition for how this cost scales with kernel size. Such an analysis is fundamental for designing efficient processing pipelines for large remote sensing datasets.",
            "id": "3851048",
            "problem": "A single-band reflectance tile of size $512 \\times 512$ pixels is extracted from a multispectral satellite image for environmental modeling of surface chlorophyll concentrations. To prepare the data for subsequent model fitting, the tile is first smoothed using a low-pass kernel to suppress high-frequency sensor noise and then assessed for fine-structure preservation using a high-pass kernel. Both kernels are square and of size $5 \\times 5$. Assume the filtering is implemented by direct two-dimensional discrete convolution with stride $1$ and zero-padding so that the output has the same dimensions as the input. A multiply-accumulate operation is defined here as one fused multiply followed immediately by one accumulate (add-to-sum).\n\nStarting from the core definition of discrete convolution in image processing, determine the total number of multiply-accumulate operations required to convolve the $512 \\times 512$ image with a single $5 \\times 5$ kernel under the stated assumptions. Express your answer as a pure count (no units). In your reasoning, address how the operation count scales with kernel side length for square kernels, but provide only the single numerical count for the specified case as your final answer.",
            "solution": "The problem statement is confirmed to be valid. It is scientifically grounded in the principles of digital image processing, well-posed with all necessary parameters defined, and objectively stated without subjective or ambiguous language. We may therefore proceed with a formal solution.\n\nThe core of the problem is to determine the total number of multiply-accumulate operations required for a two-dimensional discrete convolution. Let the input image be represented by a matrix $I$ with dimensions $M \\times N$, and the convolution kernel by a matrix $K$ with dimensions $m \\times n$.\n\nThe discrete convolution operation computes an output image $O$ where each pixel $O(i,j)$ is a weighted sum of the pixels in a local neighborhood of the input image $I$. The weights are the elements of the kernel $K$. The formal definition for the element at row $i$ and column $j$ of the output image is:\n$$O(i,j) = (I * K)(i,j) = \\sum_{u=-\\lfloor m/2 \\rfloor}^{\\lfloor m/2 \\rfloor} \\sum_{v=-\\lfloor n/2 \\rfloor}^{\\lfloor n/2 \\rfloor} K(u,v) I(i-u, j-v)$$\nThis expression assumes the kernel $K$ is indexed symmetrically around the origin. For a kernel of odd dimensions, such as the $5 \\times 5$ kernel specified, $\\lfloor m/2 \\rfloor = \\lfloor 5/2 \\rfloor = 2$ and $\\lfloor n/2 \\rfloor = \\lfloor 5/2 \\rfloor = 2$. The indices $u$ and $v$ would therefore range from $-2$ to $2$. The term $I(i-u, j-v)$ refers to pixel values from the input image, which is zero-padded as necessary to handle boundaries.\n\nTo calculate the value of a single output pixel, $O(i,j)$, one must execute the double summation. The number of terms in this sum is equal to the number of elements in the kernel, which is $m \\times n$. Each term involves one multiplication ($K(u,v) \\times I(i-u, j-v)$) and one addition to a running total (an accumulation). The problem defines a \"multiply-accumulate\" (MAC) operation as \"one fused multiply followed immediately by one accumulate\". Therefore, computing a single output pixel requires a number of MAC operations equal to the number of elements in the kernel.\n\nIn this problem, the input image has dimensions $M \\times N$ where $M=512$ and $N=512$. The kernel has dimensions $m \\times n$ where $m=5$ and $n=5$.\n\nThe number of MAC operations required to compute a single output pixel is:\n$$ \\text{Ops}_{\\text{pixel}} = m \\times n = 5 \\times 5 = 25 $$\n\nThe problem states that zero-padding and a stride of $1$ are used such that \"the output has the same dimensions as the input\". Therefore, the total number of pixels in the output image $O$ is identical to that of the input image $I$:\n$$ \\text{Total Pixels}_{\\text{out}} = M \\times N = 512 \\times 512 $$\n\nThe total number of MAC operations for the entire convolution is the product of the operations per pixel and the total number of output pixels:\n$$ \\text{Total Ops} = \\text{Ops}_{\\text{pixel}} \\times \\text{Total Pixels}_{\\text{out}} $$\n$$ \\text{Total Ops} = (m \\times n) \\times (M \\times N) $$\n\nSubstituting the given numerical values:\n$$ \\text{Total Ops} = (5 \\times 5) \\times (512 \\times 512) $$\n$$ \\text{Total Ops} = 25 \\times 512^2 $$\nWe first evaluate the square of $512$:\n$$ 512^2 = 262144 $$\nNext, we perform the final multiplication:\n$$ \\text{Total Ops} = 25 \\times 262144 = 6553600 $$\n\nAs requested, we address the scaling relationship. For a fixed image of size $M \\times N$, the total number of operations depends on the kernel size. For a square kernel of side length $k$, the number of elements is $k^2$. The total operation count is $k^2 \\times M \\times N$. This demonstrates that the computational complexity of the direct convolution scales quadratically with the kernel's side length, a relationship denoted as $O(k^2)$. For the specific case given, $k=5$.\n\nThe final numerical answer is the specific count calculated for the given parameters.",
            "answer": "$$\\boxed{6553600}$$"
        },
        {
            "introduction": "With a grasp of the computational basics, we now turn to the theoretical foundation of low-pass filtering. This exercise  focuses on the Gaussian kernel, a cornerstone of spatial smoothing, and asks you to connect its mathematical form to its function as a low-pass filter using Fourier analysis. Deriving the relationship between the kernel's scale parameter $\\sigma$ and the effective spatial resolution, measured by the Full Width at Half Maximum (FWHM), provides a physically meaningful interpretation of the smoothing process.",
            "id": "3851042",
            "problem": "A remote sensing instrument measures a spatially varying surface reflectance field, and the combined effects of the instrument optics and the atmosphere can be modeled as a linear, shift-invariant system with a point spread function (PSF). In many practical environmental modeling applications, the PSF is well approximated by an isotropic Gaussian, and image formation is modeled as a convolution of the true field with this Gaussian kernel. Let the normalized one-dimensional isotropic Gaussian PSF be defined by\n$$\nG_{\\sigma}(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right),\n$$\nwhere $\\sigma$ is the scale parameter of the smoothing. Consider the blurred image as the convolution $I_{b}(x) = (I * G_{\\sigma})(x)$, where $I(x)$ is the true scene reflectance along a transect.\n\nUsing only fundamental properties of linear shift-invariant systems and the Fourier transform, justify that Gaussian smoothing attenuates high spatial frequencies and therefore behaves as a low-pass filter. Then, adopting the full width at half maximum (FWHM) of the PSF as a physically interpretable measure of effective spatial resolution, derive a closed-form analytical expression for the FWHM as a function of $\\sigma$.\n\nProvide your final answer as a single analytic expression for the FWHM in terms of $\\sigma$. Do not include units in your final answer. No numerical rounding is required.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded, well-posed, objective, and self-contained. The concepts of linear shift-invariant systems, convolution with a Gaussian point spread function (PSF), the Fourier transform, and the full width at half maximum (FWHM) are standard and correctly stated within the context of signal processing and remote sensing. The problem requests a justification and a derivation, both of which can be addressed with standard mathematical methods based on the information provided.\n\nThe problem consists of two parts: first, to justify that Gaussian smoothing acts as a low-pass filter, and second, to derive an expression for the FWHM of the Gaussian PSF.\n\nPart 1: Justification as a Low-Pass Filter\n\nThe imaging process is modeled as a convolution of the true scene reflectance, $I(x)$, with the Gaussian PSF, $G_{\\sigma}(x)$, to produce the blurred image, $I_b(x)$. This is expressed in the spatial domain as:\n$$\nI_{b}(x) = (I * G_{\\sigma})(x) = \\int_{-\\infty}^{\\infty} I(\\tau) G_{\\sigma}(x-\\tau) d\\tau\n$$\nThe system is linear and shift-invariant, which allows for a powerful analysis in the frequency domain using the Fourier transform. The Convolution Theorem states that the Fourier transform of a convolution of two functions is the product of their individual Fourier transforms. Let $\\mathcal{F}$ denote the Fourier transform operator, and let $k$ represent the spatial frequency. Applying the Fourier transform to the convolution equation gives:\n$$\n\\mathcal{F}\\{I_{b}(x)\\}(k) = \\mathcal{F}\\{I(x)\\}(k) \\cdot \\mathcal{F}\\{G_{\\sigma}(x)\\}(k)\n$$\nLet's denote the Fourier transforms of the signals as $\\hat{I}(k)$, $\\hat{I}_{b}(k)$, and $\\hat{G}_{\\sigma}(k)$. The relationship in the frequency domain is thus:\n$$\n\\hat{I}_{b}(k) = \\hat{I}(k) \\cdot \\hat{G}_{\\sigma}(k)\n$$\nThe function $\\hat{G}_{\\sigma}(k)$ is the Optical Transfer Function (OTF) of the system. To understand its filtering properties, we must compute it. The PSF is given by:\n$$\nG_{\\sigma}(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)\n$$\nThe Fourier transform of a Gaussian function is another Gaussian function. We calculate $\\hat{G}_{\\sigma}(k)$ using the definition $\\mathcal{F}\\{f(x)\\}(k) = \\int_{-\\infty}^{\\infty} f(x) e^{-ikx} dx$:\n$$\n\\hat{G}_{\\sigma}(k) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right) e^{-ikx} dx\n$$\nBy completing the square in the exponent of the integrand, it can be shown that the result is:\n$$\n\\hat{G}_{\\sigma}(k) = \\exp\\left(-\\frac{\\sigma^{2}k^{2}}{2}\\right)\n$$\nThe relationship between the frequency spectrum of the true scene and the blurred image is therefore:\n$$\n\\hat{I}_{b}(k) = \\hat{I}(k) \\cdot \\exp\\left(-\\frac{\\sigma^{2}k^{2}}{2}\\right)\n$$\nThe transfer function, $\\exp(-\\frac{\\sigma^{2}k^{2}}{2})$, determines how different spatial frequencies are transmitted through the system. Let's analyze its behavior:\n1.  For low spatial frequencies ($k \\to 0$), the exponent $-\\frac{\\sigma^{2}k^{2}}{2} \\to 0$. Thus, $\\exp(-\\frac{\\sigma^{2}k^{2}}{2}) \\to \\exp(0) = 1$. This means low-frequency components of the original scene are passed through to the blurred image with their amplitudes nearly unchanged.\n2.  For high spatial frequencies ($|k| \\to \\infty$), the exponent $-\\frac{\\sigma^{2}k^{2}}{2} \\to -\\infty$. Thus, $\\exp(-\\frac{\\sigma^{2}k^{2}}{2}) \\to 0$. This means high-frequency components are severely attenuated, with their amplitudes being multiplied by a factor approaching zero.\n\nThis behavior—passing low frequencies while attenuating high frequencies—is the definition of a low-pass filter. Therefore, Gaussian smoothing acts as a low-pass spatial filter.\n\nPart 2: Derivation of the Full Width at Half Maximum (FWHM)\n\nThe FWHM is a measure of the width of the PSF. It is defined as the width of the function at a level that is half of its maximum value.\n\nStep 1: Find the maximum value of the PSF, $G_{\\sigma}(x)$.\nThe function $G_{\\sigma}(x)$ is a Gaussian centered at $x=0$. Its maximum value occurs at this peak.\n$$\nG_{\\text{max}} = G_{\\sigma}(0) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{0^{2}}{2\\sigma^{2}}\\right) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\n$$\n\nStep 2: Determine the half-maximum value.\nThis is simply half of the maximum value:\n$$\n\\frac{1}{2} G_{\\text{max}} = \\frac{1}{2} \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right) = \\frac{1}{2\\sqrt{2\\pi}\\,\\sigma}\n$$\n\nStep 3: Find the values of $x$ for which $G_{\\sigma}(x)$ equals the half-maximum value. Let these values be denoted by $\\pm x_{1/2}$.\n$$\nG_{\\sigma}(x_{1/2}) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}\\right) = \\frac{1}{2\\sqrt{2\\pi}\\,\\sigma}\n$$\nWe can cancel the constant factor $\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}$ from both sides, leaving:\n$$\n\\exp\\left(-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}\\right) = \\frac{1}{2}\n$$\nTo solve for $x_{1/2}$, we take the natural logarithm ($\\ln$) of both sides:\n$$\n\\ln\\left[\\exp\\left(-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}\\right)\\right] = \\ln\\left(\\frac{1}{2}\\right)\n$$\n$$\n-\\frac{x_{1/2}^{2}}{2\\sigma^{2}} = -\\ln(2)\n$$\nMultiplying by $-1$ on both sides:\n$$\n\\frac{x_{1/2}^{2}}{2\\sigma^{2}} = \\ln(2)\n$$\nNow, we solve for $x_{1/2}^{2}$:\n$$\nx_{1/2}^{2} = 2\\sigma^{2}\\ln(2)\n$$\nTaking the square root gives the two positions where the function is at half its maximum:\n$$\nx_{1/2} = \\pm\\sqrt{2\\sigma^{2}\\ln(2)} = \\pm\\sigma\\sqrt{2\\ln(2)}\n$$\n\nStep 4: Calculate the FWHM.\nThe FWHM is the distance between these two points, which is the absolute difference between the positive and negative roots.\n$$\n\\text{FWHM} = \\left(\\sigma\\sqrt{2\\ln(2)}\\right) - \\left(-\\sigma\\sqrt{2\\ln(2)}\\right)\n$$\n$$\n\\text{FWHM} = 2\\sigma\\sqrt{2\\ln(2)}\n$$\nThis is the required closed-form analytical expression for the FWHM of the Gaussian PSF in terms of the scale parameter $\\sigma$.",
            "answer": "$$\\boxed{2\\sigma\\sqrt{2\\ln(2)}}$$"
        },
        {
            "introduction": "Theory and computation are most valuable when applied to real-world scientific problems. This final practice  situates spatial filtering within a common remote sensing workflow: retrieving surface reflectance from satellite-measured radiance. By analyzing a filter with incorrect normalization, you will quantify the resulting bias in a key environmental variable, demonstrating the critical importance of maintaining radiometric integrity during image processing.",
            "id": "3851037",
            "problem": "A radiance-calibrated satellite image in a visible band is processed for environmental modeling. Let the at-sensor spectral radiance field be denoted by $L(x,y)$ with units $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$, and suppose it is spatially uniform over a patch so that $L(x,y)=L_{0}$ is constant. A spatial filter is applied through two-dimensional discrete convolution: for a $3\\times 3$ kernel $K=\\{k_{ij}\\}$, the filtered radiance at pixel $(x,y)$ is\n$$\nL_{f}(x,y)=\\sum_{i=-1}^{1}\\sum_{j=-1}^{1}k_{ij}\\,L(x+i,y+j).\n$$\nAssume a Lambertian surface and first-order atmospheric model so that the radiance–reflectance relationship is\n$$\nL(x,y)=\\frac{E_{\\text{TOA}}\\cos(\\theta_{s})}{\\pi}\\,T\\,\\rho(x,y)+L_{p},\n$$\nwhere $E_{\\text{TOA}}$ is the top-of-atmosphere spectral irradiance, $\\theta_{s}$ is the solar zenith angle, $T$ is the atmospheric transmittance along the illumination–view path, $\\rho$ is the surface reflectance (dimensionless), and $L_{p}$ is the path radiance. For day-of-year correction, take $E_{\\text{TOA}}=E_{0}/d^{2}$, where $E_{0}$ is the mean extraterrestrial spectral irradiance at one astronomical unit and $d$ is the Earth–Sun distance ratio relative to one astronomical unit.\n\nYou are given:\n- The kernel\n$$\nK=\\begin{pmatrix}\n0.05 & 0.10 & 0.05\\\\\n0.10 & 0.50 & 0.10\\\\\n0.05 & 0.10 & 0.05\n\\end{pmatrix}.\n$$\n- Uniform radiance over the patch equal to $L_{0}=35.0$ $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$.\n- Mean extraterrestrial spectral irradiance $E_{0}=185$ $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mu\\mathrm{m}^{-1}$.\n- Earth–Sun distance ratio $d=1.01$ (dimensionless).\n- Solar zenith angle $\\theta_{s}=30^\\circ$ (degrees).\n- Atmospheric transmittance $T=0.80$ (dimensionless).\n- Path radiance $L_{p}=2.0$ $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$.\n\nUsing the convolution definition and the radiance–reflectance relationship above as the fundamental base, analyze whether applying a kernel that does not sum to $1$ violates radiometric conservation on a uniform field, and then quantify the resulting bias in the reflectance estimate caused by applying the given kernel to the uniform patch. Specifically, compute the bias $\\delta \\rho=\\rho_{f}-\\rho_{\\text{true}}$ in the retrieved reflectance, where $\\rho_{f}$ is obtained by applying the reflectance retrieval to the filtered radiance $L_{f}$ and $\\rho_{\\text{true}}$ is obtained by applying the reflectance retrieval to the original radiance $L_{0}$.\n\nExpress the final answer for $\\delta \\rho$ as a decimal (unitless) rounded to four significant figures. Radians or degrees are specified for angles: use degrees as provided.",
            "solution": "The problem requires an analysis of the radiometric effect of applying a spatial convolution filter to a uniform radiance field and a quantitative calculation of the resulting bias in retrieved surface reflectance.\n\nFirst, we validate the problem statement.\nThe givens are:\n- The radiance field is uniform: $L(x,y)=L_{0}$.\n- The value of the uniform radiance is $L_{0}=35.0 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$.\n- The convolution kernel is $K=\\begin{pmatrix} 0.05 & 0.10 & 0.05\\\\ 0.10 & 0.50 & 0.10\\\\ 0.05 & 0.10 & 0.05 \\end{pmatrix}$.\n- The filtered radiance is $L_{f}(x,y)=\\sum_{i=-1}^{1}\\sum_{j=-1}^{1}k_{ij}\\,L(x+i,y+j)$.\n- The radiance-reflectance model is $L(x,y)=\\frac{E_{\\text{TOA}}\\cos(\\theta_{s})}{\\pi}\\,T\\,\\rho(x,y)+L_{p}$.\n- The top-of-atmosphere irradiance is $E_{\\text{TOA}}=E_{0}/d^{2}$.\n- Mean extraterrestrial spectral irradiance: $E_{0}=185 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mu\\mathrm{m}^{-1}$.\n- Earth–Sun distance ratio: $d=1.01$.\n- Solar zenith angle: $\\theta_{s}=30^\\circ$.\n- Atmospheric transmittance: $T=0.80$.\n- Path radiance: $L_{p}=2.0 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$.\n- The objective is to compute the reflectance bias $\\delta \\rho=\\rho_{f}-\\rho_{\\text{true}}$.\n\nThe problem is scientifically grounded in the principles of remote sensing and image processing. The provided model for radiance is a standard first-order approximation, and the convolution operation is a fundamental technique in spatial filtering. All parameters are defined, and their numerical values are physically plausible. The problem is well-posed, self-contained, and objective, leading to a unique and meaningful solution. Therefore, the problem is deemed valid.\n\nWe proceed with the solution.\n\nThe first part of the analysis concerns the kernel's properties. A low-pass filter, or smoothing kernel, is typically normalized such that its elements sum to $1$. This ensures that when applied to a uniform field, the output value is identical to the input value, thereby conserving the mean radiometric quantity. Let's compute the sum of the elements of the given kernel $K$:\n$S_K = \\sum_{i=-1}^{1}\\sum_{j=-1}^{1}k_{ij} = (4 \\times 0.05) + (4 \\times 0.10) + 0.50 = 0.20 + 0.40 + 0.50 = 1.10$.\nSince $S_K = 1.10 \\neq 1$, the kernel is not normalized. When this filter is applied to a uniform radiance field $L(x,y) = L_{0}$, the filtered radiance $L_f$ becomes:\n$$L_{f} = \\sum_{i=-1}^{1}\\sum_{j=-1}^{1}k_{ij}\\,L_{0} = L_{0} \\sum_{i=-1}^{1}\\sum_{j=-1}^{1}k_{ij} = L_{0} S_K.$$\nWith $L_{0}=35.0$ and $S_K=1.10$, the filtered radiance is:\n$$L_{f} = 35.0 \\times 1.10 = 38.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}.$$\nThe application of this kernel artificially inflates the radiance value of a uniform field, thus violating the principle of radiometric conservation for such a field. This introduces a systematic bias.\n\nNext, we quantify the bias in the retrieved surface reflectance, $\\delta\\rho = \\rho_{f} - \\rho_{\\text{true}}$. To do this, we must first express the reflectance $\\rho$ as a function of the at-sensor radiance $L$. By rearranging the given radiance-reflectance relationship:\n$$\nL = \\frac{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}{\\pi}\\rho + L_{p}\n$$\nwe solve for $\\rho$:\n$$\n\\rho(L) = \\frac{\\pi (L - L_p)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}.\n$$\nThe true reflectance, $\\rho_{\\text{true}}$, is obtained from the original radiance $L_0$:\n$$\n\\rho_{\\text{true}} = \\rho(L_0) = \\frac{\\pi (L_0 - L_p)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}.\n$$\nThe reflectance retrieved from the filtered radiance, $\\rho_f$, is:\n$$\n\\rho_{f} = \\rho(L_f) = \\frac{\\pi (L_f - L_p)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}.\n$$\nThe bias $\\delta\\rho$ is the difference between these two quantities:\n$$\n\\delta\\rho = \\rho_f - \\rho_{\\text{true}} = \\frac{\\pi (L_f - L_p)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})} - \\frac{\\pi (L_0 - L_p)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}\n$$\n$$\n\\delta\\rho = \\frac{\\pi (L_f - L_0)}{E_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s})}.\n$$\nThis expression shows that the reflectance bias is directly proportional to the radiance bias introduced by the filter. We have already determined the radiance difference:\n$$L_f - L_0 = (S_K - 1) L_0 = (1.10 - 1) \\times 35.0 = 0.10 \\times 35.0 = 3.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}.$$\nNow we compute the terms in the denominator. First, the top-of-atmosphere irradiance $E_{\\text{TOA}}$:\n$$\nE_{\\text{TOA}} = \\frac{E_0}{d^2} = \\frac{185}{(1.01)^2} = \\frac{185}{1.0201} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mu\\mathrm{m}^{-1}.\n$$\nThe complete denominator is:\n$$\nE_{\\text{TOA}}\\,T\\,\\cos(\\theta_{s}) = \\left(\\frac{185}{1.0201}\\right) \\times 0.80 \\times \\cos(30^\\circ).\n$$\nUsing the given values, $\\theta_s = 30^\\circ$, so $\\cos(30^\\circ) = \\frac{\\sqrt{3}}{2}$.\nSubstituting all numerical values into the expression for $\\delta\\rho$:\n$$\n\\delta\\rho = \\frac{\\pi \\times 3.5}{\\left(\\frac{185}{1.0201}\\right) \\times 0.80 \\times \\frac{\\sqrt{3}}{2}}.\n$$\nLet's evaluate the expression numerically:\n$$\nE_{\\text{TOA}} \\approx 181.354769 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mu\\mathrm{m}^{-1}.\n$$\nThe denominator becomes:\n$$\n181.354769 \\times 0.80 \\times \\frac{\\sqrt{3}}{2} \\approx 181.354769 \\times 0.80 \\times 0.8660254 \\approx 125.655018 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}.\n$$\nThe numerator is:\n$$\n\\pi \\times 3.5 \\approx 10.995574.\n$$\nThus, the reflectance bias is:\n$$\n\\delta\\rho \\approx \\frac{10.995574}{125.655018} \\approx 0.08750613.\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\delta\\rho \\approx 0.08751.\n$$",
            "answer": "$$\n\\boxed{0.08751}\n$$"
        }
    ]
}