{
    "hands_on_practices": [
        {
            "introduction": "分割算法的核心在于将像素有效地组织成有意义的对象。许多现代方法，如简单线性迭代聚类（SLIC），都依赖于迭代优化过程来实现这一目标。通过亲手计算SLIC算法的单次迭代，您将深入了解像素如何基于其颜色和空间位置被分配到不同的聚类中，从而揭示了分割过程的基本机制。",
            "id": "3830739",
            "problem": "考虑一个使用简单线性迭代聚类（SLIC）的面向对象的影像分析分割步骤，该步骤应用于一小块遥感影像。在 SLIC 中，像素在一个联合特征空间中表示，该空间拼接了颜色（在 CIE $L^{\\ast}a^{\\ast}b^{\\ast}$ 空间中）和空间坐标。其分配步骤旨在最小化一个平衡了光谱邻近性和空间邻近性的距离。设该影像块为一个由 $(x,y)$ 索引的 $3 \\times 3$ 网格，其中 $x \\in \\{1,2,3\\}$（列），$y \\in \\{1,2,3\\}$（行）。每个像素的颜色向量 $[L,a,b]$ 如下：\n- 在 $(x,y)=(1,1)$ 处：$[49,0,0]$，\n- $(2,1)$ 处：$[50,2,1]$，\n- $(3,1)$ 处：$[52,4,2]$，\n- $(1,2)$ 处：$[48,-1,0]$，\n- $(2,2)$ 处：$[51,2,1]$，\n- $(3,2)$ 处：$[54,6,3]$，\n- $(1,3)$ 处：$[47,-2,-1]$，\n- $(2,3)$ 处：$[50,1,1]$，\n- $(3,3)$ 处：$[60,10,10]$。\n\n指定两个初始聚类中心如下：\n- 聚类 $1$：颜色 $[50,0,0]$，位置 $(x,y)=(1,1)$，\n- 聚类 $2$：颜色 $[58,8,8]$，位置 $(x,y)=(3,3)$。\n\n假设 SLIC 使用由下式定义的标准复合距离\n$$\nD(p,C_{k}) \\;=\\; \\sqrt{d_{c}(p,C_{k})^{2} \\;+\\; \\left(\\frac{m}{S}\\right)^{2} \\, d_{s}(p,C_{k})^{2}},\n$$\n其中，$d_{c}(p,C_{k})$ 是像素 $p$ 与聚类中心 $C_{k}$ 在 CIE $L^{\\ast}a^{\\ast}b^{\\ast}$ 颜色空间中的欧几里得距离，$d_{s}(p,C_{k})$ 是在图像坐标 $(x,y)$ 中的欧几里得距离。设 SLIC 网格间隔为 $S=2$，紧凑性参数为 $m=10$。在分配步骤中，仅在每个中心周围大小为 $2S \\times 2S$ 的搜索窗口内评估 $D$；对于这个小影像块，所有像素都落在两个中心的搜索窗口内。\n\n从上述初始中心开始，执行一次完整的 SLIC 迭代，包括：\n1. 分配步骤：将每个像素分配给具有最小 $D(p,C_{k})$ 的聚类 $k \\in \\{1,2\\}$。\n2. 更新步骤：在联合特征空间中，从簇内平方和最小化的第一性原理出发，推导出聚类中心的更新规则，并通过对步骤1中分配的像素的特征进行平均来计算更新后的中心。\n\n将最终更新的聚类中心报告为单个行矩阵，其中包含聚类1和聚类2的分量，顺序为 $[L_{1},a_{1},b_{1},x_{1},y_{1},L_{2},a_{2},b_{2},x_{2},y_{2}]$。将报告值四舍五入到四位有效数字。不需要物理单位。\n\n此外，在您的解答中，请根据连续迭代之间聚类中心的变化，为此复合距离下的 SLIC 论证一个有原则的收敛准则。最终的数值答案必须仅为所要求的行矩阵。",
            "solution": "该问题是适定的，有科学依据，并包含了执行一次简单线性迭代聚类（SLIC）算法迭代所需的所有信息。所有提供的数据和参数都是一致的，足以得到唯一解。该任务是图像分析中一个标准算法的直接应用。因此，该问题是有效的。\n\n解题过程涉及 SLIC 算法的单次迭代，包括两个主要步骤：分配步骤和更新步骤。我们将首先执行分配步骤，将 9 个像素中的每一个分配给两个初始聚类中心中最近的一个。然后，我们将推导聚类中心的通用更新规则，并应用它来根据像素分配计算新的中心。最后，将论证一个有原则的收敛准则。\n\n用于分配的复合距离 $D(p,C_{k})$ 由下式给出：\n$$\nD(p,C_{k}) \\;=\\; \\sqrt{d_{c}(p,C_{k})^{2} \\;+\\; \\left(\\frac{m}{S}\\right)^{2} \\, d_{s}(p,C_{k})^{2}}\n$$\n其中 $p$ 代表一个像素，$C_k$ 是一个聚类中心。任何点（像素或中心）的特征向量都在 5 维空间 $[L, a, b, x, y]$ 中给出。\n给定的参数是紧凑性 $m=10$ 和网格间隔 $S=2$。因此，空间距离的缩放因子是 $(\\frac{m}{S})^2 = (\\frac{10}{2})^2 = 5^2 = 25$。比较距离 $D$ 等效于比较它们的平方 $D^2$，这通过移除平方根来简化计算。平方距离是：\n$$\nD(p, C_k)^2 = d_c(p, C_k)^2 + 25 \\, d_s(p, C_k)^2\n$$\n颜色距离 $d_c$ 和空间距离 $d_s$ 是欧几里得距离：\n$$\nd_c(p, C_k)^2 = (L_p - L_k)^2 + (a_p - a_k)^2 + (b_p - b_k)^2\n$$\n$$\nd_s(p, C_k)^2 = (x_p - x_k)^2 + (y_p - y_k)^2\n$$\n初始聚类中心是：\n- $C_1$: 特征 $[L_1, a_1, b_1, x_1, y_1] = [50, 0, 0, 1, 1]$\n- $C_2$: 特征 $[L_2, a_2, b_2, x_2, y_2] = [58, 8, 8, 3, 3]$\n\n**1. 分配步骤**\n我们为 9 个像素中的每一个计算 $D^2(p, C_1)$ 和 $D^2(p, C_2)$，并将该像素分配给距离较小的聚类。我们用 $p(x_p, y_p)$ 表示坐标为 $(x_p, y_p)$ 且颜色为 $[L_p, a_p, b_p]$ 的像素。\n\n作为一个详细的例子，考虑颜色为 $[49, 0, 0]$ 的像素 $p(1,1)$：\n对于聚类 $1$：\n$$d_c(p, C_1)^2 = (49-50)^2 + (0-0)^2 + (0-0)^2 = (-1)^2 = 1$$\n$$d_s(p, C_1)^2 = (1-1)^2 + (1-1)^2 = 0^2 + 0^2 = 0$$\n$$D(p, C_1)^2 = 1 + 25 \\times 0 = 1$$\n对于聚类 $2$：\n$$d_c(p, C_2)^2 = (49-58)^2 + (0-8)^2 + (0-8)^2 = (-9)^2 + (-8)^2 + (-8)^2 = 81 + 64 + 64 = 209$$\n$$d_s(p, C_2)^2 = (1-3)^2 + (1-3)^2 = (-2)^2 + (-2)^2 = 4 + 4 = 8$$\n$$D(p, C_2)^2 = 209 + 25 \\times 8 = 209 + 200 = 409$$\n由于 $1  409$，像素 $p(1,1)$ 被分配给聚类 $1$。\n\n对所有 9 个像素重复此计算，得到以下平方距离和分配结果：\n- $p(1,1): [49,0,0,1,1]$。$D^2(p,C_1)=1$，$D^2(p,C_2)=409$。分配给 $C_1$。\n- $p(2,1): [50,2,1,2,1]$。$D^2(p,C_1)=30$，$D^2(p,C_2)=274$。分配给 $C_1$。\n- $p(3,1): [52,4,2,3,1]$。$D^2(p,C_1)=124$，$D^2(p,C_2)=188$。分配给 $C_1$。\n- $p(1,2): [48,-1,0,1,2]$。$D^2(p,C_1)=30$，$D^2(p,C_2)=370$。分配给 $C_1$。\n- $p(2,2): [51,2,1,2,2]$。$D^2(p,C_1)=56$，$D^2(p,C_2)=184$。分配给 $C_1$。\n- $p(3,2): [54,6,3,3,2]$。$D^2(p,C_1)=186$，$D^2(p,C_2)=70$。分配给 $C_2$。\n- $p(1,3): [47,-2,-1,1,3]$。$D^2(p,C_1)=114$，$D^2(p,C_2)=402$。分配给 $C_1$。\n- $p(2,3): [50,1,1,2,3]$。$D^2(p,C_1)=127$，$D^2(p,C_2)=187$。分配给 $C_1$。\n- $p(3,3): [60,10,10,3,3]$。$D^2(p,C_1)=500$，$D^2(p,C_2)=12$。分配给 $C_2$。\n\n分配总结：\n- 聚类 $1$ ($\\mathcal{P}_1$) 中的像素：$p(1,1), p(2,1), p(3,1), p(1,2), p(2,2), p(1,3), p(2,3)$。像素数量为 $N_1 = 7$。\n- 聚类 $2$ ($\\mathcal{P}_2$) 中的像素：$p(3,2), p(3,3)$。像素数量为 $N_2 = 2$。\n\n**2. 更新步骤**\n\n首先，我们推导更新规则。目标是找到新的中心 $C_k' = [L_k', a_k', b_k', x_k', y_k']$，以最小化其聚类 $\\mathcal{P}_k$ 中所有像素 $p_i$ 的平方距离之和。聚类 $k$ 的总误差为：\n$$ E_k = \\sum_{p_i \\in \\mathcal{P}_k} D(p_i, C_k')^2 = \\sum_{p_i \\in \\mathcal{P}_k} \\left( (L_i - L_k')^2 + (a_i - a_k')^2 + (b_i - b_k')^2 + \\left(\\frac{m}{S}\\right)^2 \\left( (x_i - x_k')^2 + (y_i - y_k')^2 \\right) \\right) $$\n为了找到最小值，我们对 $E_k$ 关于中心 $C_k'$ 的每个分量求偏导数，并令其为零。在这个和中，五个分量是独立的。对于 $L_k'$：\n$$ \\frac{\\partial E_k}{\\partial L_k'} = \\sum_{p_i \\in \\mathcal{P}_k} -2(L_i - L_k') = -2 \\left( \\sum_{p_i \\in \\mathcal{P}_k} L_i - N_k L_k' \\right) = 0 $$\n$$ \\implies N_k L_k' = \\sum_{p_i \\in \\mathcal{P}_k} L_i \\implies L_k' = \\frac{1}{N_k} \\sum_{p_i \\in \\mathcal{P}_k} L_i $$\n同样的逻辑适用于 $a_k'$, $b_k'$, $x_k'$ 和 $y_k'$。因子 $(m/S)^2$ 不影响 $x_k'$ 和 $y_k'$ 的最小值位置，因为它是一个正常数。例如，对于 $x_k'$：\n$$ \\frac{\\partial E_k}{\\partial x_k'} = \\sum_{p_i \\in \\mathcal{P}_k} \\left(\\frac{m}{S}\\right)^2 (-2(x_i - x_k')) = -2\\left(\\frac{m}{S}\\right)^2 \\left( \\sum_{p_i \\in \\mathcal{P}_k} x_i - N_k x_k' \\right) = 0 $$\n$$ \\implies x_k' = \\frac{1}{N_k} \\sum_{p_i \\in \\mathcal{P}_k} x_i $$\n因此，更新后的中心就是分配给该聚类的所有像素的特征向量的均值。\n\n现在我们使用此规则计算更新后的中心。\n\n对于聚类 $1$ ($N_1 = 7$)：\n- $\\sum L_i = 49+50+52+48+51+47+50 = 347$\n- $\\sum a_i = 0+2+4+(-1)+2+(-2)+1 = 6$\n- $\\sum b_i = 0+1+2+0+1+(-1)+1 = 4$\n- $\\sum x_i = 1+2+3+1+2+1+2 = 12$\n- $\\sum y_i = 1+1+1+2+2+3+3 = 13$\n新的中心 $C_1'$ 是：\n$L_1' = \\frac{347}{7} \\approx 49.5714$, $a_1' = \\frac{6}{7} \\approx 0.85714$, $b_1' = \\frac{4}{7} \\approx 0.57142$, $x_1' = \\frac{12}{7} \\approx 1.71428$, $y_1' = \\frac{13}{7} \\approx 1.85714$。\n\n对于聚类 $2$ ($N_2 = 2$)：\n- $\\sum L_i = 54+60 = 114$\n- $\\sum a_i = 6+10 = 16$\n- $\\sum b_i = 3+10 = 13$\n- $\\sum x_i = 3+3 = 6$\n- $\\sum y_i = 2+3 = 5$\n新的中心 $C_2'$ 是：\n$L_2' = \\frac{114}{2} = 57$, $a_2' = \\frac{16}{2} = 8$, $b_2' = \\frac{13}{2} = 6.5$, $x_2' = \\frac{6}{2} = 3$, $y_2' = \\frac{5}{2} = 2.5$。\n\n将新中心的分量四舍五入到四位有效数字：\n- $C_1' = [49.57, 0.8571, 0.5714, 1.714, 1.857]$\n- $C_2' = [57.00, 8.000, 6.500, 3.000, 2.500]$\n\n**3. 收敛准则**\nSLIC 算法，与 k-means 类似，是一个迭代优化过程。它旨在最小化总平方距离和 $E = \\sum_k E_k$。每次完整的迭代（分配和更新步骤）都保证不会增加这个总误差，从而确保算法收敛到局部最小值。一个有原则的收敛准则应反映模型参数的稳定性，这些参数即聚类中心 $C_k = [L_k, a_k, b_k, x_k, y_k]$。\n\n当聚类中心在迭代之间不再有显著移动时，算法即告收敛。衡量这种移动的一种稳健方法是使用与目标函数的距离度量相一致的度量。设 $C_k^{(t)}$ 和 $C_k^{(t+1)}$ 分别是聚类 $k$ 在第 $t$ 次和第 $t+1$ 次迭代时的中心。聚类中心的“位移”可以用 SLIC 距离度量本身来量化，应用于新旧中心向量：\n$$ \\Delta C_k = D(C_k^{(t+1)}, C_k^{(t)}) = \\sqrt{d_c(C_k^{(t+1)}, C_k^{(t)})^2 + \\left(\\frac{m}{S}\\right)^2 d_s(C_k^{(t+1)}, C_k^{(t)})^2} $$\n当所有聚类中心的最大位移低于一个预定义的小阈值 $\\epsilon$ 时，可以宣告收敛：\n$$ \\max_k (\\Delta C_k)  \\epsilon $$\n这个准则是之所以有原则，是因为它使用定义聚类本身的相同缩放距离，直接测量了被优化的参数（即聚类中心）的变化。或者，当像素分配在迭代之间不再改变时，也可以检测到收敛，这意味着中心也将不再改变。\n\n最终要求的输出是更新后的聚类中心的行矩阵。\n$$ [L_1', a_1', b_1', x_1', y_1', L_2', a_2', b_2', x_2', y_2'] $$\n使用四舍五入到四位有效数字的值，结果是：\n$[49.57, 0.8571, 0.5714, 1.714, 1.857, 57.00, 8.000, 6.500, 3.000, 2.500]$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n49.57  0.8571  0.5714  1.714  1.857  57.00  8.000  6.500  3.000  2.500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一旦图像被分割成对象，下一步就是用定量特征来描述它们，以便进行分类。纹理是区分地物（如森林与草地）的关键特征之一，而灰度共生矩阵（GLCM）是量化纹理的经典工具。本练习将指导您从头计算GLCM的对比度和同质性等纹理特征，并探索在多尺度分析中，当对象合并时这些特征如何变化。",
            "id": "3830660",
            "problem": "一位遥感分析师正在对一幅量化为四个灰度级 $\\{0,1,2,3\\}$ 的多光谱影像进行面向对象的影像分析 (OBIA)。在精细分割尺度上，两个相邻的分割块（对象）由以下灰度矩阵表示，其中每个条目表示对象内一个像素的量化辐射值：\n\n$$\nO_{A}=\\begin{pmatrix}\n0  1  1 \\\\\n0  1  2 \\\\\n0  2  2\n\\end{pmatrix},\n\\quad\nO_{B}=\\begin{pmatrix}\n2  2  3 \\\\\n2  3  3 \\\\\n1  2  3\n\\end{pmatrix}.\n$$\n\n分析师使用从灰度共生矩阵 (GLCM) 派生的纹理特征，该矩阵按指定的偏移量定义如下。对于给定的方向 $\\theta$ 和距离 $d$，GLCM $P(i,j)$ 统计灰度级为 $i$ 的像素在给定偏移量处其邻居像素灰度级为 $j$ 的次数；然后通过除以计数的总像元对数，将其归一化为概率质量函数，使得 $\\sum_{i=0}^{3}\\sum_{j=0}^{3}P(i,j)=1$。在本问题中，使用水平偏移量 $\\theta=0^{\\circ}$ 和 $d=1$，因此每个像元对对应一个像素 $(r,c)$ 及其邻居 $(r,c+1)$，并且只计算从左到右的有向像元对（不要对称化）。\n\n从归一化的 GLCM $P$ 中，定义纹理特征对比度 $C$ 和均匀度 $H$ 如下：\n$$\nC=\\sum_{i=0}^{3}\\sum_{j=0}^{3}(i-j)^{2}P(i,j),\n\\quad\nH=\\sum_{i=0}^{3}\\sum_{j=0}^{3}\\frac{P(i,j)}{1+|i-j|}.\n$$\n\n为了研究多尺度分割，分析师考虑一个更粗的尺度，其中两个相邻的分割块通过将 $O_{A}$（左）和 $O_{B}$（右）水平拼接，合并成一个单一的对象 $O_{AB}$，生成一个 $3\\times 6$ 的对象。在合并后的对象上使用相同的 GLCM 偏移量（$\\theta=0^{\\circ}$，$d=1$，从左到右的有向像元对）。\n\n一个 OBIA 分类器采用线性判别分析 (LDA) 分数\n$$\nS=w_{c}C+w_{h}H+b,\n$$\n已知权重 $w_{c}=0.7$ 和 $w_{h}=0.5$；偏差 $b$ 在所有对象中是恒定的。令 $\\Delta S=S_{AB}-S_{A}$ 表示当从精细尺度的对象 $O_{A}$ 移动到更粗尺度的合并对象 $O_{AB}$ 时判别分数的变化。\n\n使用上述定义从第一性原理精确计算 $\\Delta S$。将最终答案表示为一个无量纲的实数，并将答案四舍五入到四位有效数字。",
            "solution": "目标是计算当从精细尺度的对象 $O_A$ 移动到更粗尺度的合并对象 $O_{AB}$ 时，线性判别分析 (LDA) 分数的变化量 $\\Delta S$。分数的变化定义为 $\\Delta S = S_{AB} - S_A$。\n\n一个对象的 LDA 分数 $S$ 由 $S = w_{c}C + w_{h}H + b$ 给出，其中 $C$ 是对比度， $H$ 是均匀度， $w_c$ 和 $w_h$ 是权重， $b$ 是一个常数偏差。\n变化量 $\\Delta S$ 可以表示为：\n$$\n\\Delta S = (w_{c}C_{AB} + w_{h}H_{AB} + b) - (w_{c}C_{A} + w_{h}H_{A} + b)\n$$\n$$\n\\Delta S = w_{c}(C_{AB} - C_A) + w_{h}(H_{AB} - H_A)\n$$\n给定权重 $w_{c} = 0.7$ 和 $w_{h} = 0.5$。为了求出 $\\Delta S$，我们必须首先计算对象 $O_A$ 和 $O_{AB}$ 的对比度和均匀度。这需要构建它们各自的灰度共生矩阵 (GLCM)。\n\n首先，我们分析对象 $O_A$：\n$$\nO_{A}=\\begin{pmatrix}\n0  1  1 \\\\\n0  1  2 \\\\\n0  2  2\n\\end{pmatrix}\n$$\nGLCM 使用距离 $d=1$ 的水平偏移量（从左到右的像元对）计算。我们首先统计像元对 $(i,j)$ 的出现次数：\n- 第 1 行：$(0,1)$, $(1,1)$\n- 第 2 行：$(0,1)$, $(1,2)$\n- 第 3 行：$(0,2)$, $(2,2)$\n\n总像元对数是 $N_A = 3 \\times (3-1) = 6$。未归一化的 GLCM（我们记为 $G_A$）包含这些像元对的计数。对于灰度级 $\\{0,1,2,3\\}$，$G_A$ 的非零条目是：\n- $G_A(0,1) = 2$\n- $G_A(1,1) = 1$\n- $G_A(1,2) = 1$\n- $G_A(0,2) = 1$\n- $G_A(2,2) = 1$\n所有其他条目均为 0。归一化的 GLCM 是 $P_A(i,j) = G_A(i,j) / N_A$。\n\n对比度 $C_A$ 计算如下：\n$$\nC_A=\\sum_{i=0}^{3}\\sum_{j=0}^{3}(i-j)^{2}P_A(i,j) = \\frac{1}{N_A} \\sum_{i=0}^{3}\\sum_{j=0}^{3}(i-j)^{2}G_A(i,j)\n$$\n$$\nC_A = \\frac{1}{6} \\left[ (0-1)^2 G_A(0,1) + (1-1)^2 G_A(1,1) + (1-2)^2 G_A(1,2) + (0-2)^2 G_A(0,2) + (2-2)^2 G_A(2,2) \\right]\n$$\n$$\nC_A = \\frac{1}{6} \\left[ (1)(2) + (0)(1) + (1)(1) + (4)(1) + (0)(1) \\right] = \\frac{1}{6} (2+0+1+4+0) = \\frac{7}{6}\n$$\n均匀度 $H_A$ 计算如下：\n$$\nH_A=\\sum_{i=0}^{3}\\sum_{j=0}^{3}\\frac{P_A(i,j)}{1+|i-j|} = \\frac{1}{N_A} \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\frac{G_A(i,j)}{1+|i-j|}\n$$\n$$\nH_A = \\frac{1}{6} \\left[ \\frac{G_A(0,1)}{1+|0-1|} + \\frac{G_A(1,1)}{1+|1-1|} + \\frac{G_A(1,2)}{1+|1-2|} + \\frac{G_A(0,2)}{1+|0-2|} + \\frac{G_A(2,2)}{1+|2-2|} \\right]\n$$\n$$\nH_A = \\frac{1}{6} \\left[ \\frac{2}{2} + \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{1} \\right] = \\frac{1}{6} \\left( 1 + 1 + \\frac{1}{2} + \\frac{1}{3} + 1 \\right) = \\frac{1}{6} \\left( 3 + \\frac{5}{6} \\right) = \\frac{1}{6} \\left( \\frac{23}{6} \\right) = \\frac{23}{36}\n$$\n\n接下来，我们分析通过水平拼接 $O_A$ 和 $O_B$ 形成的合并对象 $O_{AB}$：\n$$\nO_{AB}=\\begin{pmatrix}\n0  1  1  2  2  3 \\\\\n0  1  2  2  3  3 \\\\\n0  2  2  1  2  3\n\\end{pmatrix}\n$$\n对于 $3 \\times 6$ 矩阵，总像元对数是 $N_{AB} = 3 \\times (6-1) = 15$。我们统计所有从左到右的像元对的出现次数：\n- 第 1 行：$(0,1), (1,1), (1,2), (2,2), (2,3)$\n- 第 2 行：$(0,1), (1,2), (2,2), (2,3), (3,3)$\n- 第 3 行：$(0,2), (2,2), (2,1), (1,2), (2,3)$\n\n未归一化的 GLCM $G_{AB}$ 的非零条目是：\n- $G_{AB}(0,1) = 2$\n- $G_{AB}(0,2) = 1$\n- $G_{AB}(1,1) = 1$\n- $G_{AB}(1,2) = 3$\n- $G_{AB}(2,1) = 1$\n- $G_{AB}(2,2) = 3$\n- $G_{AB}(2,3) = 3$\n- $G_{AB}(3,3) = 1$\n计数总和为 $2+1+1+3+1+3+3+1=15$，与 $N_{AB}$ 相符。\n\n对比度 $C_{AB}$ 是：\n$$\nC_{AB} = \\frac{1}{15} \\left[ (0-1)^2(2) + (0-2)^2(1) + (1-1)^2(1) + (1-2)^2(3) + (2-1)^2(1) + (2-2)^2(3) + (2-3)^2(3) + (3-3)^2(1) \\right]\n$$\n$$\nC_{AB} = \\frac{1}{15} \\left[ (1)(2) + (4)(1) + (0)(1) + (1)(3) + (1)(1) + (0)(3) + (1)(3) + (0)(1) \\right] = \\frac{1}{15}(2+4+0+3+1+0+3+0) = \\frac{13}{15}\n$$\n均匀度 $H_{AB}$ 是：\n$$\nH_{AB} = \\frac{1}{15} \\left[ \\frac{2}{1+|0-1|} + \\frac{1}{1+|0-2|} + \\frac{1}{1+|1-1|} + \\frac{3}{1+|1-2|} + \\frac{1}{1+|2-1|} + \\frac{3}{1+|2-2|} + \\frac{3}{1+|2-3|} + \\frac{1}{1+|3-3|} \\right]\n$$\n$$\nH_{AB} = \\frac{1}{15} \\left[ \\frac{2}{2} + \\frac{1}{3} + \\frac{1}{1} + \\frac{3}{2} + \\frac{1}{2} + \\frac{3}{1} + \\frac{3}{2} + \\frac{1}{1} \\right] = \\frac{1}{15} \\left( 1 + \\frac{1}{3} + 1 + \\frac{3}{2} + \\frac{1}{2} + 3 + \\frac{3}{2} + 1 \\right)\n$$\n$$\nH_{AB} = \\frac{1}{15} \\left( 6 + \\frac{1}{3} + \\frac{7}{2} \\right) = \\frac{1}{15} \\left( \\frac{36+2+21}{6} \\right) = \\frac{1}{15} \\left( \\frac{59}{6} \\right) = \\frac{59}{90}\n$$\n\n最后，我们计算 $\\Delta S$：\n$$\n\\Delta S = w_c (C_{AB} - C_A) + w_h (H_{AB} - H_A)\n$$\n$$\n\\Delta S = 0.7 \\left( \\frac{13}{15} - \\frac{7}{6} \\right) + 0.5 \\left( \\frac{59}{90} - \\frac{23}{36} \\right)\n$$\n我们为差值找到公分母：\n$$\nC_{AB} - C_A = \\frac{13 \\times 2}{30} - \\frac{7 \\times 5}{30} = \\frac{26 - 35}{30} = -\\frac{9}{30} = -\\frac{3}{10}\n$$\n$$\nH_{AB} - H_A = \\frac{59 \\times 2}{180} - \\frac{23 \\times 5}{180} = \\frac{118 - 115}{180} = \\frac{3}{180} = \\frac{1}{60}\n$$\n将这些值代回 $\\Delta S$ 的表达式中：\n$$\n\\Delta S = \\frac{7}{10} \\left( -\\frac{3}{10} \\right) + \\frac{1}{2} \\left( \\frac{1}{60} \\right) = -\\frac{21}{100} + \\frac{1}{120}\n$$\n使用公分母 $600$：\n$$\n\\Delta S = -\\frac{21 \\times 6}{600} + \\frac{1 \\times 5}{600} = \\frac{-126 + 5}{600} = -\\frac{121}{600}\n$$\n转换为十进制值：\n$$\n\\Delta S = -0.201666...\n$$\n四舍五入到四位有效数字，我们得到 $-0.2017$。",
            "answer": "$$\\boxed{-0.2017}$$"
        },
        {
            "introduction": "在多尺度面向对象分析中，我们得到的不仅仅是一个单一的分割结果，而是一个完整的分割层级结构。评估这个层级结构的质量与评估单一尺度分割同样重要。本练习将介绍共表型相关系数，这是一种强大的度量方法，用于比较算法生成的分割层级与“地面真值”层级之间的一致性，从而评估分割在不同尺度上的保真度。",
            "id": "3830662",
            "problem": "在用于遥感和环境建模的面向对象的影像分析 (OBIA) 中，多尺度分割通常通过一个层次聚类树状图来总结，其合并高度量化了对象合并的尺度。为了评估这种分割在多尺度上对地面真实生态层次结构的保留程度，可以将该树状图的共表型距离与来自地面真实层次化对象组合的共表型距离进行比较。\n\n考虑五个标记为 $A$、$B$、$C$、$D$ 和 $E$ 的叶对象。通过层次凝聚生成一个分割树状图，其合并序列和高度如下：\n- 在高度 $0.20$ 处合并 $A$ 和 $B$。\n- 在高度 $0.35$ 处合并 $C$ 和 $D$。\n- 在高度 $0.50$ 处将 $E$ 与簇 $(C,D)$ 合并。\n- 在高度 $0.80$ 处将簇 $(A,B)$ 与簇 $(C,D,E)$ 合并。\n\n一个地面真实的生态层次结构被独立地获得，其合并序列和高度如下：\n- 在高度 $0.15$ 处合并 $A$ 和 $B$。\n- 在高度 $0.40$ 处合并 $C$ 和 $E$。\n- 在高度 $0.45$ 处将簇 $(C,E)$ 与 $D$ 合并。\n- 在高度 $0.75$ 处将簇 $(A,B)$ 与簇 $(C,D,E)$ 合并。\n\n使用基本定义，即两个叶之间的共表型距离是它们在树状图中首次成为同一簇成员时的高度，为分割树状图和地面真实层次结构构建来自 $\\{A,B,C,D,E\\}$ 的所有无序对的共表型距离集。然后，计算共表型相关系数，其定义为这两组共表型距离（取自所有无序叶对）之间的皮尔逊相关系数。将您的最终数值答案四舍五入到四位有效数字。将您的答案表示为一个无量纲数。",
            "solution": "用户希望计算五个对象的两个层次聚类之间的共表型相关系数。这需要系统地分解为三个主要步骤：首先，确定分割树状图中所有对象对的共表型距离集；其次，对地面真实层次结构进行同样的操作；第三，计算这两组距离之间的皮尔逊相关系数。\n\n五个叶对象的集合是 $\\{A, B, C, D, E\\}$。不同对象的无序对数量由二项式系数 $\\binom{5}{2} = \\frac{5 \\times (5-1)}{2} = 10$ 给出。这些对是：$(A,B)$、$(A,C)$、$(A,D)$、$(A,E)$、$(B,C)$、$(B,D)$、$(B,E)$、$(C,D)$、$(C,E)$ 和 $(D,E)$。\n\n**步骤1：计算分割树状图的共表型距离**\n\n两个对象之间的共表型距离定义为它们在树状图中首次被合并到同一个簇时的高度。令 $d_{seg}(i,j)$ 表示分割树状图中对象 $i$ 和 $j$ 之间的共表型距离。\n\n1.  在高度 $0.20$ 处合并 $A$ 和 $B$。这直接给出了共表型距离：\n    $$d_{seg}(A, B) = 0.20$$\n2.  在高度 $0.35$ 处合并 $C$ 和 $D$。\n    $$d_{seg}(C, D) = 0.35$$\n3.  在高度 $0.50$ 处将 $E$ 与簇 $(C,D)$ 合并。这意味着 $E$ 在此高度与 $C$ 和 $D$ 合并。\n    $$d_{seg}(C, E) = 0.50$$\n    $$d_{seg}(D, E) = 0.50$$\n4.  在高度 $0.80$ 处将簇 $(A,B)$ 与簇 $(C,D,E)$ 合并。来自第一个簇 $\\{A,B\\}$ 的任何对象与来自第二个簇 $\\{C,D,E\\}$ 的任何对象首次合并于此高度。\n    $$d_{seg}(A, C) = d_{seg}(A, D) = d_{seg}(A, E) = 0.80$$\n    $$d_{seg}(B, C) = d_{seg}(B, D) = d_{seg}(B, E) = 0.80$$\n\n让我们将这 $10$ 个距离的集合表示为 $X$。按上面列出的对的顺序排列：\n$X = \\{0.20, 0.80, 0.80, 0.80, 0.80, 0.80, 0.80, 0.35, 0.50, 0.50\\}$\n\n**步骤2：计算地面真实层次结构的共表型距离**\n\n同样，令 $d_{gt}(i,j)$ 为地面真实层次结构中的共表型距离。\n\n1.  在高度 $0.15$ 处合并 $A$ 和 $B$。\n    $$d_{gt}(A, B) = 0.15$$\n2.  在高度 $0.40$ 处合并 $C$ 和 $E$。\n    $$d_{gt}(C, E) = 0.40$$\n3.  在高度 $0.45$ 处将簇 $(C,E)$ 与 $D$ 合并。\n    $$d_{gt}(C, D) = 0.45$$\n    $$d_{gt}(E, D) = 0.45$$\n4.  在高度 $0.75$ 处将簇 $(A,B)$ 与簇 $(C,D,E)$ 合并。\n    $$d_{gt}(A, C) = d_{gt}(A, D) = d_{gt}(A, E) = 0.75$$\n    $$d_{gt}(B, C) = d_{gt}(B, D) = d_{gt}(B, E) = 0.75$$\n\n让我们将这 $10$ 个距离的集合表示为 $Y$，对应于相同的对序。\n$Y = \\{0.15, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.45, 0.40, 0.45\\}$\n\n**步骤3：计算共表型相关系数**\n\n共表型相关系数是两组距离 $X = \\{x_1, ..., x_n\\}$ 和 $Y = \\{y_1, ..., y_n\\}$ (其中 $n=10$) 之间的皮尔逊相关系数 $r$。$r$ 的公式是：\n$$r = \\frac{n \\sum_{i=1}^{n} x_i y_i - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{\\sqrt{[n \\sum_{i=1}^{n} x_i^2 - (\\sum_{i=1}^{n} x_i)^2][n \\sum_{i=1}^{n} y_i^2 - (\\sum_{i=1}^{n} y_i)^2]}}$$\n\n首先，我们计算必要的和：\n$\\sum x_i = 0.20 + 6(0.80) + 0.35 + 2(0.50) = 0.20 + 4.80 + 0.35 + 1.00 = 6.35$\n$\\sum y_i = 0.15 + 6(0.75) + 0.45 + 0.40 + 0.45 = 0.15 + 4.50 + 0.90 + 0.40 = 5.95$\n\n接下来，是平方和：\n$\\sum x_i^2 = (0.20)^2 + 6(0.80)^2 + (0.35)^2 + 2(0.50)^2 = 0.04 + 6(0.64) + 0.1225 + 2(0.25) = 0.04 + 3.84 + 0.1225 + 0.50 = 4.5025$\n$\\sum y_i^2 = (0.15)^2 + 6(0.75)^2 + (0.45)^2 + (0.40)^2 + (0.45)^2 = 0.0225 + 6(0.5625) + 0.2025 + 0.16 + 0.2025 = 0.0225 + 3.375 + 0.565 = 3.9625$\n\n接下来，是每对的乘积之和 $x_i y_i$：\n- $(A,B)$: $0.20 \\times 0.15 = 0.03$\n- $6$ 个 $(A/B, C/D/E)$ 形式的对：$6 \\times (0.80 \\times 0.75) = 6 \\times 0.60 = 3.60$\n- $(C,D)$: $0.35 \\times 0.45 = 0.1575$\n- $(C,E)$: $0.50 \\times 0.40 = 0.20$\n- $(D,E)$: $0.50 \\times 0.45 = 0.225$\n$\\sum x_i y_i = 0.03 + 3.60 + 0.1575 + 0.20 + 0.225 = 4.2125$\n\n现在，将这些和代入 $r$ 的公式中。\n分子是：\n$n \\sum x_i y_i - (\\sum x_i)(\\sum y_i) = 10(4.2125) - (6.35)(5.95) = 42.125 - 37.7825 = 4.3425$\n\n分母平方根内的项是：\n$n \\sum x_i^2 - (\\sum x_i)^2 = 10(4.5025) - (6.35)^2 = 45.025 - 40.3225 = 4.7025$\n$n \\sum y_i^2 - (\\sum y_i)^2 = 10(3.9625) - (5.95)^2 = 39.625 - 35.4025 = 4.2225$\n\n分母是：\n$\\sqrt{(4.7025)(4.2225)} = \\sqrt{19.85655625} \\approx 4.4560696$\n\n最后，相关系数是：\n$$r \\approx \\frac{4.3425}{4.4560696} \\approx 0.97451319$$\n\n题目要求四舍五入到四位有效数字。\n$$r \\approx 0.9745$$\n这个高的正相关系数表明分割层次结构与地面真实生态层次结构之间有很强的一致性。",
            "answer": "$$\\boxed{0.9745}$$"
        }
    ]
}