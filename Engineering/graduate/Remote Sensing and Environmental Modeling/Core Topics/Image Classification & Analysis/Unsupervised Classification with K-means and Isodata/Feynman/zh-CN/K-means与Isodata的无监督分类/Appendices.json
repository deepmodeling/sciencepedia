{
    "hands_on_practices": [
        {
            "introduction": "K-均值和 ISODATA 都是迭代算法，一个核心的实际问题是何时停止迭代。本练习将引导你从第一性原理出发，推导出一个基于质心移动的充分停止条件 。通过将质心的最大位移与簇间分离度和簇内半径联系起来，你将深入理解算法收敛的几何本质，并掌握量化分类图稳定性的关键技能。",
            "id": "3863354",
            "problem": "一幅具有 $d$ 个光谱波段的多光谱卫星图像已被归一化，使得每个特征都位于 $[0,1]$ 区间内。您使用 K-均值算法和迭代自组织数据分析技术算法 (ISODATA) 进行非监督分类。令 $\\{\\mu_k^{(t)}\\}_{k=1}^K$ 表示第 $t$ 次迭代时的聚类中心，并定义第 $t-1$ 次和第 $t$ 次迭代之间的最大中心位移为\n$$\n\\Delta^{(t)} \\equiv \\max_{1 \\le k \\le K} \\left\\|\\mu_k^{(t)} - \\mu_k^{(t-1)}\\right\\|.\n$$\n聚类分配是根据欧氏距离下的最近中心法则进行的。定义第 $t-1$ 次迭代时的最小中心间距为\n$$\ns^{(t-1)} \\equiv \\min_{i \\neq j} \\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\|,\n$$\n以及第 $t-1$ 次迭代时的最大簇内半径为\n$$\nr_{\\max}^{(t-1)} \\equiv \\max_{1 \\le k \\le K} \\max_{x \\in C_k^{(t-1)}} \\left\\|x - \\mu_k^{(t-1)}\\right\\|,\n$$\n其中 $C_k^{(t-1)}$ 是分配给中心 $\\mu_k^{(t-1)}$ 的像素集合。\n\n仅从欧氏距离的定义、K-均值分配规则（最近中心）和三角不等式出发，推导一个充分的停止阈值 $\\varepsilon$，使得如果 $\\Delta^{(t)} \\le \\varepsilon$，则在第 $t$ 次迭代时没有像素的聚类标签会改变（即，聚类标签图稳定）。您的推导必须仅用 $s^{(t-1)}$ 和 $r_{\\max}^{(t-1)}$ 来表示 $\\varepsilon$，并且必须对不执行合并或分裂的 K-均值和 ISODATA 迭代都有效。\n\n然后，对于一个特定场景，其中 $s^{(t-1)} = 0.42$ 和 $r_{\\max}^{(t-1)} = 0.11$，计算 $\\varepsilon$ 的数值。将您的答案四舍五入到四位有效数字。由于特征是归一化反射率，请将最终阈值表示为无量纲值。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在非监督机器学习和遥感领域具有科学依据，定义和约束条件齐全，表述客观，并提出了一个基于基本数学原理的可解挑战。\n\n目标是为最大中心位移 $\\Delta^{(t)}$ 推导出一个充分的停止阈值 $\\varepsilon$，使得如果 $\\Delta^{(t)} \\le \\varepsilon$，则在 K-均值或 ISODATA 类型算法（不进行簇的合并或分裂）的第 $t$ 次迭代期间，没有像素会改变其聚类分配。像素的聚类分配由欧氏距离下的最近中心法则确定。该推导必须仅依赖于欧氏距离的定义、分配规则和三角不等式。\n\n设 $x$ 是 $d$ 维特征空间中的任意一个像素。在第 $t-1$ 次迭代时，像素 $x$ 被分配到簇 $C_i^{(t-1)}$，其中心为 $\\mu_i^{(t-1)}$。根据最近中心分配法则，这意味着对于任何其他簇 $j \\ne i$：\n$$\n\\left\\|x - \\mu_i^{(t-1)}\\right\\| \\le \\left\\|x - \\mu_j^{(t-1)}\\right\\|\n$$\n在第 $t$ 次迭代时，中心被更新到新位置 $\\{\\mu_k^{(t)}\\}_{k=1}^K$。为了使聚类分配保持稳定，像素 $x$ 必须仍然被分配到簇 $i$。这要求它到新中心 $\\mu_i^{(t)}$ 的距离小于或等于它到任何其他新中心 $\\mu_j^{(t)}$ 的距离：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| \\le \\left\\|x - \\mu_j^{(t)}\\right\\| \\quad \\text{对所有 } j \\ne i\n$$\n我们的目标是找到一个关于 $\\Delta^{(t)} \\equiv \\max_{k} \\left\\|\\mu_k^{(t)} - \\mu_k^{(t-1)}\\right\\|$ 的条件，以保证该不等式对任何像素 $x$ 都成立。我们将通过找到不等式左边的上界和右边的下界来建立这个条件。\n\n首先，我们求 $\\left\\|x - \\mu_i^{(t)}\\right\\|$ 的上界。通过应用三角不等式，我们可以写出：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| = \\left\\|(x - \\mu_i^{(t-1)}) + (\\mu_i^{(t-1)} - \\mu_i^{(t)})\\right\\| \\le \\left\\|x - \\mu_i^{(t-1)}\\right\\| + \\left\\|\\mu_i^{(t-1)} - \\mu_i^{(t)}\\right\\|\n$$\n由于 $x$ 属于簇 $C_i^{(t-1)}$，它到中心 $\\mu_i^{(t-1)}$ 的距离受最大簇内半径 $r_{\\max}^{(t-1)}$ 的限制：\n$$\n\\left\\|x - \\mu_i^{(t-1)}\\right\\| \\le \\max_{z \\in C_i^{(t-1)}} \\left\\|z - \\mu_i^{(t-1)}\\right\\| \\le r_{\\max}^{(t-1)}\n$$\n中心 $i$ 的位移受所有中心的最大位移 $\\Delta^{(t)}$ 的限制：\n$$\n\\left\\|\\mu_i^{(t-1)} - \\mu_i^{(t)}\\right\\| = \\left\\|\\mu_i^{(t)} - \\mu_i^{(t-1)}\\right\\| \\le \\Delta^{(t)}\n$$\n代入这些界限，我们得到从 $x$ 到其新的“归属”中心的距离的上界：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| \\le r_{\\max}^{(t-1)} + \\Delta^{(t)}\n$$\n\n接下来，我们求对于任何 $j \\ne i$ 的 $\\left\\|x - \\mu_j^{(t)}\\right\\|$ 的下界。使用反三角不等式（$\\|a-b\\| \\ge \\|a\\| - \\|b\\|$），我们有：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| = \\left\\|(x - \\mu_j^{(t-1)}) - (\\mu_j^{(t)} - \\mu_j^{(t-1)})\\right\\| \\ge \\left\\|x - \\mu_j^{(t-1)}\\right\\| - \\left\\|\\mu_j^{(t)} - \\mu_j^{(t-1)}\\right\\|\n$$\n第二项受 $\\Delta^{(t)}$ 限制，所以：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| \\ge \\left\\|x - \\mu_j^{(t-1)}\\right\\| - \\Delta^{(t)}\n$$\n现在，我们需要求 $\\left\\|x - \\mu_j^{(t-1)}\\right\\|$ 的下界，即像素 $x$（在簇 $i$ 中）到前一次迭代中另一个中心 $j$ 的距离。我们对 $x$、$\\mu_i^{(t-1)}$ 和 $\\mu_j^{(t-1)}$ 这三个点应用三角不等式：\n$$\n\\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\| \\le \\left\\|\\mu_i^{(t-1)} - x\\right\\| + \\left\\|x - \\mu_j^{(t-1)}\\right\\|\n$$\n整理后得到：\n$$\n\\left\\|x - \\mu_j^{(t-1)}\\right\\| \\ge \\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\| - \\left\\|x - \\mu_i^{(t-1)}\\right\\|\n$$\n为了找到对于任何像素 $x \\in C_i^{(t-1)}$ 和任何竞争簇 $j$ 都成立的 $\\left\\|x - \\mu_j^{(t-1)}\\right\\|$ 的最紧可能下界，我们必须考虑右侧各项的最坏情况值。项 $\\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\|$ 由最小中心间距 $s^{(t-1)}$ 取得最小值。项 $\\left\\|x - \\mu_i^{(t-1)}\\right\\|$ 由最大簇内半径 $r_{\\max}^{(t-1)}$ 取得最大值。因此：\n$$\n\\left\\|x - \\mu_j^{(t-1)}\\right\\| \\ge s^{(t-1)} - r_{\\max}^{(t-1)}\n$$\n将此结果代回到我们对 $\\left\\|x - \\mu_j^{(t)}\\right\\|$ 的下界中：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| \\ge (s^{(t-1)} - r_{\\max}^{(t-1)}) - \\Delta^{(t)}\n$$\n\n现在我们已经为到新的归属中心的距离建立了一个最坏情况下的上界，以及到任何新的竞争中心的距离建立了一个最坏情况下的下界。为了使所有像素的聚类分配都保持稳定，必须满足以下充分条件：\n$$\n\\text{上界 } \\left\\|x - \\mu_i^{(t)}\\right\\| \\le \\text{下界 } \\left\\|x - \\mu_j^{(t)}\\right\\|\n$$\n$$\nr_{\\max}^{(t-1)} + \\Delta^{(t)} \\le s^{(t-1)} - r_{\\max}^{(t-1)} - \\Delta^{(t)}\n$$\n我们现在可以求解 $\\Delta^{(t)}$ 以找到保证稳定性的条件：\n$$\n2\\Delta^{(t)} \\le s^{(t-1)} - 2r_{\\max}^{(t-1)}\n$$\n$$\n\\Delta^{(t)} \\le \\frac{s^{(t-1)}}{2} - r_{\\max}^{(t-1)}\n$$\n如果最大中心位移 $\\Delta^{(t)}$ 满足这个不等式，则没有像素会改变其聚类分配。因此，充分停止阈值 $\\varepsilon$ 是：\n$$\n\\varepsilon = \\frac{s^{(t-1)}}{2} - r_{\\max}^{(t-1)}\n$$\n\n我们给定了具体数值 $s^{(t-1)} = 0.42$ 和 $r_{\\max}^{(t-1)} = 0.11$。我们现在可以计算 $\\varepsilon$ 的数值：\n$$\n\\varepsilon = \\frac{0.42}{2} - 0.11 = 0.21 - 0.11 = 0.1\n$$\n问题要求答案四舍五入到四位有效数字。由于计算是精确的，我们将结果表示为 $0.1000$。所涉及的量是从归一化特征空间中的距离导出的，因此得到的阈值 $\\varepsilon$ 是一个无量纲值。\n$$\n\\varepsilon = 0.1000\n$$",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "在遥感数据处理中，波段标准化（或z-score归一化）是一个常见步骤，但其理论依据是什么？本练习旨在揭示标准化的深层数学含义 。你将推导出，对标准化数据运行K-均值，等价于在原始数据上使用一种特殊的马氏距离（Mahalanobis distance），从而理解标准化如何隐式地对不同方差的波段进行加权。",
            "id": "3863403",
            "problem": "一幅多光谱卫星图像有 $N$ 个像素，每个像素有 $p$ 个光谱波段，表示为向量 $\\mathbf{x}_{i} \\in \\mathbb{R}^{p}$，其中 $i \\in \\{1,\\dots,N\\}$。考虑通过 K-均值目标函数进行无监督分类，其中数据集被划分为 $K$ 个非空簇 $\\{C_{1},\\dots,C_{K}\\}$，每个簇 $k$ 的质心为 $\\boldsymbol{\\mu}_{k} \\in \\mathbb{R}^{p}$。标准的 K-均值目标函数为\n$$\nJ \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} \\left\\| \\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k} \\right\\|_{2}^{2}.\n$$\n在许多遥感工作流程以及迭代自组织数据分析技术 (Iterative Self-Organizing Data Analysis Technique, ISODATA) 中，通常会在聚类前进行逐波段标准化（也称为 $z$-score 标准化），以减轻高方差光谱波段的主导作用。定义逐波段经验均值 $\\mathbf{m} \\in \\mathbb{R}^{p}$，其分量为 $m_{d} = \\frac{1}{N} \\sum_{i=1}^{N} x_{i d}$，以及逐波段经验标准差 $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{p}$，其分量为 $\\sigma_{d} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (x_{i d} - m_{d})^{2}}$，其中 $d \\in \\{1,\\dots,p\\}$。构建对角缩放矩阵 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{p})$ 和对角方差矩阵 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2})$。\n\n通过 $\\mathbf{z}_{i} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})$ 定义标准化数据 $\\mathbf{z}_{i} \\in \\mathbb{R}^{p}$。设在这个标准化空间中计算的 K-均值目标函数为\n$$\nJ^{(z)} \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} \\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2},\n$$\n其中 $\\boldsymbol{\\nu}_{k}$ 是标准化空间中簇 $k$ 的质心。\n\n仅从这些定义出发，用原始空间中的量 $\\mathbf{x}_{i}$、$\\boldsymbol{\\mu}_{k}$ 和编码在 $\\mathbf{S}$ 中的逐波段方差来明确推导 $J^{(z)}$。假设簇分配 $\\{C_{k}\\}_{k=1}^{K}$ 是固定的，并且 $\\boldsymbol{\\mu}_{k}$ 是 $\\{\\mathbf{x}_{i} : i \\in C_{k}\\}$ 的经验均值。然后，解释与 $J$ 相比，逐波段 $z$-score 标准化如何改变 $J^{(z)}$ 中各波段簇内方差的隐式权重，并解释其与对角马氏度量的联系及其对遥感影像中波段主导作用的影响。\n\n请提供一个仅用 $\\mathbf{x}_{i}$、$\\boldsymbol{\\mu}_{k}$ 和 $\\mathbf{S}$ 表示的 $J^{(z)}$ 的单一闭式解析表达式作为最终答案。无需进行数值计算，最终表达式也无需单位。",
            "solution": "该问题陈述经评估有效。它在科学上基于无监督机器学习和遥感数据分析的原理，问题定义良好，具有清晰的定义和目标，并且没有主观或模糊的语言。所有必要信息都已提供，足以进行严谨的推导和解释。\n\n任务是推导在标准化数据上计算的 K-均值目标函数 $J^{(z)}$ 的表达式，并解释其含义。推导过程如下。\n\n首先，我们用原始空间中的量来表示标准化空间中簇 $C_k$ 的质心 $\\boldsymbol{\\nu}_k$。根据定义，质心是簇内数据点的均值。设 $|C_k|$ 为簇 $k$ 中的像素数。\n$$\n\\boldsymbol{\\nu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{z}_{i}\n$$\n代入标准化数据的定义 $\\mathbf{z}_{i} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})$：\n$$\n\\boldsymbol{\\nu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})\n$$\n由于缩放矩阵 $\\mathbf{D}^{-1}$ 和全局均值向量 $\\mathbf{m}$ 对于簇中所有像素 $i$ 都是常数，我们可以将它们移到求和符号之外：\n$$\n\\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1} \\left( \\left( \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{x}_{i} \\right) - \\left( \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{m} \\right) \\right)\n$$\n括号中的第一项是原始空间中簇质心的定义，即 $\\boldsymbol{\\mu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{x}_{i}$。第二项简化为 $\\frac{|C_k|}{|C_k|}\\mathbf{m} = \\mathbf{m}$。因此，标准化质心 $\\boldsymbol{\\nu}_k$ 与原始空间质心 $\\boldsymbol{\\mu}_k$ 之间的关系与应用于数据点的变换相同：\n$$\n\\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1}(\\boldsymbol{\\mu}_{k} - \\mathbf{m})\n$$\n现在我们可以计算标准化目标函数 $J^{(z)}$ 的求和内的项：\n$$\n\\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m}) - \\mathbf{D}^{-1}(\\boldsymbol{\\mu}_{k} - \\mathbf{m}) = \\mathbf{D}^{-1} \\left( (\\mathbf{x}_{i} - \\mathbf{m}) - (\\boldsymbol{\\mu}_{k} - \\mathbf{m}) \\right) = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n该向量的 $L_2$ 范数平方为：\n$$\n\\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2} = \\left\\| \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right\\|_{2}^{2}\n$$\n为了用矩阵 $\\mathbf{S}$ 表示，我们使用范数平方的二次型表示，即 $\\|\\mathbf{v}\\|_{2}^{2} = \\mathbf{v}^{T}\\mathbf{v}$。\n$$\n\\left\\| \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right\\|_{2}^{2} = \\left( \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right)^{T} \\left( \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol\\mu_{k}) \\right)\n$$\n使用转置性质 $(AB)^T = B^T A^T$：\n$$\n= (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^{-1})^{T} \\mathbf{D}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n矩阵 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{p})$ 是对角矩阵，因此其逆矩阵 $\\mathbf{D}^{-1}$ 也是对角矩阵。对角矩阵是对称的，所以 $(\\mathbf{D}^{-1})^{T} = \\mathbf{D}^{-1}$。该表达式变为：\n$$\n= (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^{-1})^2 (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) = (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^2)^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n根据定义 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2}) = \\mathbf{D}^2$，我们有 $(\\mathbf{D}^2)^{-1} = \\mathbf{S}^{-1}$。因此：\n$$\n\\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2} = (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n最后，将此式代入 $J^{(z)}$ 的定义中，得到所需的表达式：\n$$\nJ^{(z)} \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n该表达式揭示了逐波段标准化如何改变聚类目标。标准的 K-均值目标 $J = \\sum \\sum \\| \\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k} \\|_{2}^{2}$ 隐式地使用平方欧氏距离，该距离可以用二次型写成：$(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{I} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})$。这给予每个光谱波段相同的权重。\n\n相比之下，标准化数据的目标函数 $J^{(z)}$ 等价于最小化原始数据空间中的距离平方和，但距离度量由矩阵 $\\mathbf{S}^{-1}$ 定义。由于 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2})$，其逆为 $\\mathbf{S}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2},\\dots,1/\\sigma_{p}^{2})$。每个波段 $d$ 对距离的贡献现在被其全局方差的倒数 $1/\\sigma_{d}^2$ 缩放。具体来说，单个像素 $i$ 在波段 $d$ 上的平方误差变为 $\\frac{(x_{id} - \\mu_{kd})^2}{\\sigma_d^2}$。\n\n这对遥感中的波段主导问题具有关键意义。具有高方差（大 $\\sigma_d^2$）的光谱波段往往具有较大的平方差数值，因此在标准欧氏距离计算和目标函数 $J$ 中占据主导地位。聚类算法将优先形成在这些高方差波段中减少方差的簇，而常常忽略低方差波段中的信息。通过标准化数据，我们引入了因子 $1/\\sigma_d^2$，它降低了高方差波段的贡献权重，并提高了低方差波段的贡献权重。这有效地使每个波段对聚类过程的影响归一化，从而得到的划分能够对所有波段的模式都敏感，而不仅仅是对那些变化最大的波段。\n\n这种表述直接与马氏距离联系起来。从点 $\\mathbf{x}$ 到均值 $\\boldsymbol{\\mu}$，给定协方差矩阵 $\\mathbf{\\Sigma}$ 的马氏距离平方为 $(\\mathbf{x}-\\boldsymbol{\\mu})^{T}\\mathbf{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})$。目标 $J^{(z)}$ 是每个点 $\\mathbf{x}_i$ 与其簇质心 $\\boldsymbol{\\mu}_k$ 之间马氏距离平方的和。这里使用的协方差矩阵是 $\\mathbf{S}$，一个由全局逐波段方差构成的对角矩阵。这种特定形式，即对角马氏距离，假设了光谱波段之间是不相关的。因此，在 z-标准化数据上进行聚类，在数学上等同于在原始数据上使用这种特定的马氏距离（而非欧氏距离）来执行 K-均值。这为将标准化作为一种解释特征间不同尺度和方差的方法提供了形式化的依据。",
            "answer": "$$\n\\boxed{\\sum_{k=1}^{K} \\sum_{i \\in C_{k}} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})}\n$$"
        },
        {
            "introduction": "标准的K-均值算法对异常值很敏感，而在遥感影像中，阴影像素就是一类典型的异常值。本练习将挑战你设计一个稳健的多波段加权方案，以减轻阴影在可见光波段的干扰效应 。通过应用来自稳健统计学的Huber影响函数并求解一个优化问题，你将学会如何改进核心聚类算法以适应真实世界数据的不完美性。",
            "id": "3863385",
            "problem": "一台推扫式成像光谱仪在植被覆盖的流域上采集了三个反射率波段：蓝光 $B$、红光 $R$ 和近红外 (N)。您需要为使用 K-均值和迭代自组织数据分析技术算法 (ISODATA) 的无监督聚类设计一个鲁棒的多波段加权方案，以减轻阴影像素的影响。这些阴影像素在可见光波段是异常值，但在近红外波段不是。\n\n假设当前的 K-均值植被原型（聚类中心）的反射率均值为 $\\boldsymbol{\\mu}_{\\text{veg}} = [\\mu_B, \\mu_R, \\mu_N] = [0.060, 0.040, 0.480]$。经验估计的内点尺度（簇内距离的各波段标准差）为 $\\boldsymbol{s} = [s_B, s_R, s_N] = [0.008, 0.007, 0.050]$。受植被投射阴影影响的一个像素子集的观测反射率为 $\\boldsymbol{x}_{\\text{sh}} = [x_B, x_R, x_N] = [0.020, 0.015, 0.450]$。所有反射率均为 $[0,1]$ 范围内的无单位分数。\n\n您采用逐波段的 Huber 型鲁棒加权方法，用于 K-均值的分配和 ISODATA 的方差计算。对于每个波段 $b \\in \\{B,R,N\\}$，定义残差 $r_b = x_b - \\mu_b$，标准化残差 $u_b = r_b / s_b$，以及具有公共阈值参数 $\\kappa  0$ 的 Huber 影响函数，其表达式为\n$$\n\\psi_{\\kappa}(u) = \n\\begin{cases}\nu,  |u| \\le \\kappa,\\\\\n\\kappa\\,\\mathrm{sign}(u),  |u|  \\kappa.\n\\end{cases}\n$$\n相应的鲁棒权重为 $w_b(\\kappa) = \\psi_{\\kappa}(u_b)/u_b = \\min\\{1,\\kappa/|u_b|\\}$（当 $u_b \\neq 0$ 时），如果 $u_b=0$，则 $w_b(\\kappa)=1$。这产生了一个用于分配的鲁棒、多波段、缩放的平方距离，\n$$\nD_{\\kappa}^2(\\boldsymbol{x},\\boldsymbol{\\mu}) = \\sum_{b \\in \\{B,R,N\\}} \\left[w_b(\\kappa)\\,\\frac{r_b}{s_b}\\right]^2,\n$$\n并且相同的权重 $w_b(\\kappa)$ 用于计算加权的簇内散布度，以供 ISODATA 进行分裂-合并决策。\n\n您的设计目标是选择一个单一的 $\\kappa$（所有波段通用），对于给定的阴影像素相对于植被原型，该 $\\kappa$ 强制执行以下条件：可见光波段 $B$ 和 $R$ 应处于饱和区 $|u_b|  \\kappa$（因此其影响有界），而近红外波段 N 应处于线性区 $|u_N|  \\kappa$（因此它仍能提供信息）。在所有满足这些区域约束的 $\\kappa$ 中，您将通过解决以下最大最小化问题，来选择能使 $\\kappa$ 与两个区域边界之间的对称分离间隔最大化的那个：\n$$\n\\max_{\\kappa  0} \\;\\; \\min\\!\\left\\{ \\frac{\\kappa}{|u_N|}, \\; \\frac{\\min\\{|u_B|,|u_R|\\}}{\\kappa} \\right\\}\n\\quad \\text{subject to} \\quad |u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}.\n$$\n\n计算解决此问题的 $\\kappa$ 值，使用给定的 $\\boldsymbol{\\mu}_{\\text{veg}}$、$\\boldsymbol{s}$ 和 $\\boldsymbol{x}_{\\text{sh}}$。将您的最终答案四舍五入到四位有效数字。",
            "solution": "问题提出了一个为遥感中的鲁棒无监督分类算法设计加权参数 $\\kappa$ 的任务。在进行求解之前，先对问题陈述进行验证。\n\n**问题验证**\n1.  **已知条件提取**：\n    -   波段：蓝光 ($B$)、红光 ($R$)、近红外 ($N$)。\n    -   植被原型平均反射率：$\\boldsymbol{\\mu}_{\\text{veg}} = [\\mu_B, \\mu_R, \\mu_N] = [0.060, 0.040, 0.480]$。\n    -   内点尺度（标准差）：$\\boldsymbol{s} = [s_B, s_R, s_N] = [0.008, 0.007, 0.050]$。\n    -   阴影像素反射率：$\\boldsymbol{x}_{\\text{sh}} = [x_B, x_R, x_N] = [0.020, 0.015, 0.450]$。\n    -   定义：$r_b = x_b - \\mu_b$, $u_b = r_b / s_b$。\n    -   优化问题：$\\max_{\\kappa  0} \\;\\; \\min\\!\\left\\{ \\frac{\\kappa}{|u_N|}, \\; \\frac{\\min\\{|u_B|,|u_R|\\}}{\\kappa} \\right\\}$，约束条件为 $|u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}$。\n\n2.  **有效性检查**：\n    -   **科学依据**：该问题在鲁棒统计和遥感领域有充分的理论基础。使用 Huber 型影响函数来降低异常值（阴影像素）的权重是一种标准技术。阴影对可见光波段（$B$、$R$）反射率的降低程度远大于近红外波段，这一物理前提对于植被表面是正确的。\n    -   **适定性**：所有必要的数据和定义都已提供。优化问题陈述清晰，结构合理，能够得出一个唯一的、有意义的解。\n    -   **客观性**：问题以精确的数学和技术术语表述，没有主观或含糊不清的语言。\n\n3.  **结论**：问题有效。这是一个基于可靠科学原理的、定义明确的数学优化问题。可以推导出解。\n\n**求解过程**\n\n目标是计算阈值参数 $\\kappa$ 的最优值。第一步是使用给定的尺度 $\\boldsymbol{s}$，计算阴影像素 $\\boldsymbol{x}_{\\text{sh}}$ 相对于植被原型 $\\boldsymbol{\\mu}_{\\text{veg}}$ 的标准化残差 $u_b$。\n\n对于每个波段 $b \\in \\{B, R, N\\}$，残差为 $r_b = x_b - \\mu_b$，标准化残差为 $u_b = r_b / s_b$。\n\n对于蓝光波段 ($B$)：\n$$\nr_B = x_B - \\mu_B = 0.020 - 0.060 = -0.040\n$$\n$$\nu_B = \\frac{r_B}{s_B} = \\frac{-0.040}{0.008} = -5\n$$\n\n对于红光波段 ($R$)：\n$$\nr_R = x_R - \\mu_R = 0.015 - 0.040 = -0.025\n$$\n$$\nu_R = \\frac{r_R}{s_R} = \\frac{-0.025}{0.007} = -\\frac{25}{7}\n$$\n\n对于近红外波段 ($N$)：\n$$\nr_N = x_N - \\mu_N = 0.450 - 0.480 = -0.030\n$$\n$$\nu_N = \\frac{r_N}{s_N} = \\frac{-0.030}{0.050} = -0.6\n$$\n\n优化问题需要这些标准化残差的绝对值：\n$$\n|u_B| = 5\n$$\n$$\n|u_R| = \\frac{25}{7} \\approx 3.5714\n$$\n$$\n|u_N| = 0.6\n$$\n\n优化受约束 $|u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}$ 的限制。我们为此约束定义下界 $L$ 和上界 $U$。\n下界为 $L = |u_N| = 0.6$。\n上界为 $U = \\min\\{|u_B|, |u_R|\\} = \\min\\left\\{5, \\frac{25}{7}\\right\\}$。由于 $5 = \\frac{35}{7}$，最小值为 $\\frac{25}{7}$。因此，$U = \\frac{25}{7}$。\n对 $\\kappa$ 的约束是 $0.6  \\kappa  \\frac{25}{7}$。\n\n问题即求解：\n$$\n\\max_{\\kappa} \\min\\left\\{ \\frac{\\kappa}{L}, \\frac{U}{\\kappa} \\right\\}\n$$\n我们需要最大化函数 $f(\\kappa) = \\min\\left\\{ \\frac{\\kappa}{L}, \\frac{U}{\\kappa} \\right\\}$。其中，$\\frac{\\kappa}{L}$ 随 $\\kappa$ 增大而增大，而 $\\frac{U}{\\kappa}$ 随 $\\kappa$ 增大而减小。这两个函数的最小值的最大值出现在它们相等的地方：\n$$\n\\frac{\\kappa}{L} = \\frac{U}{\\kappa}\n$$\n求解 $\\kappa$（其中 $\\kappa  0$）：\n$$\n\\kappa^2 = L \\cdot U\n$$\n$$\n\\kappa = \\sqrt{L \\cdot U}\n$$\n这个解是边界 $L$ 和 $U$ 的几何平均值。只要 $L  U$，该解就保证位于区间 $(L, U)$ 内，本例中该条件成立（$0.6  \\frac{25}{7}$）。\n\n现在，我们代入 $L$ 和 $U$ 的数值来计算 $\\kappa$。\n$$\nL = 0.6 = \\frac{3}{5}\n$$\n$$\nU = \\frac{25}{7}\n$$\n$$\n\\kappa = \\sqrt{\\left(\\frac{3}{5}\\right) \\cdot \\left(\\frac{25}{7}\\right)} = \\sqrt{\\frac{3 \\cdot 25}{5 \\cdot 7}} = \\sqrt{\\frac{3 \\cdot 5}{7}} = \\sqrt{\\frac{15}{7}}\n$$\n为了得到最终答案，我们计算其数值并按要求四舍五入到四位有效数字。\n$$\n\\kappa = \\sqrt{\\frac{15}{7}} \\approx \\sqrt{2.14285714...} \\approx 1.463850109...\n$$\n四舍五入到四位有效数字得到 $\\kappa \\approx 1.464$。该值位于约束区间 $(0.6, \\frac{25}{7})$ 内，从而证实了其有效性。",
            "answer": "$$\\boxed{1.464}$$"
        }
    ]
}