{
    "hands_on_practices": [
        {
            "introduction": "非监督分类算法从根本上受所选距离度量的指导。虽然欧几里得距离很常用，但诸如按波段标准化的预处理步骤可以显著改变聚类结果。本练习将引导您推导 Z-score 标准化与马氏（Mahalanobis）距离之间的数学联系，揭示这一常用实践如何根据波段方差智能地重新加权光谱波段。",
            "id": "3863403",
            "problem": "一张多光谱卫星图像有 $N$ 个像素，每个像素有 $p$ 个光谱波段，表示为向量 $\\mathbf{x}_{i} \\in \\mathbb{R}^{p}$，其中 $i \\in \\{1,\\dots,N\\}$。考虑通过 $k$-均值目标函数进行非监督分类，其中数据集被划分为 $K$ 个非空簇 $\\{C_{1},\\dots,C_{K}\\}$，每个簇 $k$ 的质心为 $\\boldsymbol{\\mu}_{k} \\in \\mathbb{R}^{p}$。标准的 $k$-均值目标函数为\n$$\nJ \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} \\left\\| \\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k} \\right\\|_{2}^{2}.\n$$\n在许多遥感工作流程和迭代自组织数据分析技术 (Iterative Self-Organizing Data Analysis Technique, ISODATA) 中，通常在聚类前进行按波段标准化（也称为 $z$-分数标准化），以减轻高方差光谱波段的主导作用。定义按波段的经验均值 $\\mathbf{m} \\in \\mathbb{R}^{p}$，其分量为 $m_{d} = \\frac{1}{N} \\sum_{i=1}^{N} x_{i d}$，以及按波段的经验标准差 $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{p}$，其分量为 $\\sigma_{d} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (x_{i d} - m_{d})^{2}}$，其中 $d \\in \\{1,\\dots,p\\}$。构建对角缩放矩阵 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{p})$ 和对角方差矩阵 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2})$。\n\n定义标准化数据 $\\mathbf{z}_{i} \\in \\mathbb{R}^{p}$ 为 $\\mathbf{z}_{i} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})$。令在此标准化空间中计算的 $k$-均值目标函数为\n$$\nJ^{(z)} \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} \\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2},\n$$\n其中 $\\boldsymbol{\\nu}_{k}$ 是标准化空间中簇 $k$ 的质心。\n\n仅从这些定义出发，用原始空间中的量 $\\mathbf{x}_{i}$、$\\boldsymbol{\\mu}_{k}$ 以及编码在 $\\mathbf{S}$ 中的按波段方差来显式推导 $J^{(z)}$。假设簇分配 $\\{C_{k}\\}_{k=1}^{K}$ 是固定的，且 $\\boldsymbol{\\mu}_{k}$ 是 $\\{\\mathbf{x}_{i} : i \\in C_{k}\\}$ 的经验均值。然后，解释与 $J$ 相比，按波段的 $z$-分数标准化如何改变了 $J^{(z)}$ 中跨波段的簇内方差的隐式权重，并解释其与对角马哈拉诺比斯度量的联系及其对遥感图像中波段主导作用的影响。\n\n请仅用 $\\mathbf{x}_{i}$、$\\boldsymbol{\\mu}_{k}$ 和 $\\mathbf{S}$ 写出 $J^{(z)}$ 的单一闭式解析表达式作为最终答案。不需要进行数值计算，最终表达式也无需单位。",
            "solution": "问题陈述经评估是有效的。其科学基础为非监督机器学习和遥感数据分析的原理，问题定义和目标清晰，形式良好（well-posed），且不含主观或模糊的语言。所有必要信息都已提供，足以进行严谨的推导和解释。\n\n任务是推导在标准化数据上计算的 $k$-均值目标函数 $J^{(z)}$ 的表达式，并解释其含义。推导过程如下。\n\n首先，我们用原始空间中的量来表示标准化空间中簇 $C_k$ 的质心 $\\boldsymbol{\\nu}_k$。根据定义，质心是簇内数据点的均值。令 $|C_k|$ 为簇 $k$ 中的像素数量。\n$$\n\\boldsymbol{\\nu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{z}_{i}\n$$\n代入标准化数据的定义 $\\mathbf{z}_{i} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})$：\n$$\n\\boldsymbol{\\nu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m})\n$$\n由于缩放矩阵 $\\mathbf{D}^{-1}$ 和全局均值向量 $\\mathbf{m}$ 对于簇中的所有像素 $i$ 都是常数，我们可以将它们移到求和符号之外：\n$$\n\\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1} \\left( \\left( \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{x}_{i} \\right) - \\left( \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{m} \\right) \\right)\n$$\n括号中的第一项是原始空间簇质心的定义，$\\boldsymbol{\\mu}_{k} = \\frac{1}{|C_k|} \\sum_{i \\in C_k} \\mathbf{x}_{i}$。第二项简化为 $\\frac{|C_k|}{|C_k|}\\mathbf{m} = \\mathbf{m}$。因此，标准化质心 $\\boldsymbol{\\nu}_k$ 与原始空间质心 $\\boldsymbol{\\mu}_k$ 之间的关系，与应用于数据点的变换相同：\n$$\n\\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1}(\\boldsymbol{\\mu}_{k} - \\mathbf{m})\n$$\n现在我们可以计算标准化目标函数 $J^{(z)}$ 求和内的项：\n$$\n\\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\mathbf{m}) - \\mathbf{D}^{-1}(\\boldsymbol{\\mu}_{k} - \\mathbf{m}) = \\mathbf{D}^{-1} \\left( (\\mathbf{x}_{i} - \\mathbf{m}) - (\\boldsymbol{\\mu}_{k} - \\mathbf{m}) \\right) = \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n该向量的 $L_2$ 范数的平方为：\n$$\n\\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2} = \\left\\| \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right\\|_{2}^{2}\n$$\n为了用矩阵 $\\mathbf{S}$ 来表示，我们使用范数平方的二次型表示，$\\|\\mathbf{v}\\|_{2}^{2} = \\mathbf{v}^{T}\\mathbf{v}$。\n$$\n\\left\\| \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right\\|_{2}^{2} = \\left( \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) \\right)^{T} \\left( \\mathbf{D}^{-1}(\\mathbf{x}_{i} - \\boldsymbol\\mu_{k}) \\right)\n$$\n使用转置性质 $(AB)^T = B^T A^T$：\n$$\n= (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^{-1})^{T} \\mathbf{D}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n矩阵 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{p})$ 是对角矩阵，因此其逆矩阵 $\\mathbf{D}^{-1}$ 也是对角矩阵。对角矩阵是对稱的，所以 $(\\mathbf{D}^{-1})^{T} = \\mathbf{D}^{-1}$。表达式变为：\n$$\n= (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^{-1})^2 (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k}) = (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} (\\mathbf{D}^2)^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n根据定义 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2}) = \\mathbf{D}^2$，我们有 $(\\mathbf{D}^2)^{-1} = \\mathbf{S}^{-1}$。因此：\n$$\n\\left\\| \\mathbf{z}_{i} - \\boldsymbol{\\nu}_{k} \\right\\|_{2}^{2} = (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n最后，将此代回 $J^{(z)}$ 的定义中，得到所需的表达式：\n$$\nJ^{(z)} \\;=\\; \\sum_{k=1}^{K} \\sum_{i \\in C_{k}} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})\n$$\n该表达式揭示了按波段标准化如何改变聚类目标。标准的 $k$-均值目标 $J = \\sum \\sum \\| \\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k} \\|_{2}^{2}$ 隐式地使用了欧几里得距离的平方，它可以写成带有单位矩阵的二次型：$(\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{I} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})$。这给予每个光谱波段相同的权重。\n\n相比之下，标准化数据的目标函数 $J^{(z)}$ 等价于在原始数据空间中最小化距离平方和，但其距离度量由矩阵 $\\mathbf{S}^{-1}$ 定义。由于 $\\mathbf{S} = \\mathrm{diag}(\\sigma_{1}^{2},\\dots,\\sigma_{p}^{2})$，其逆矩阵为 $\\mathbf{S}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2},\\dots,1/\\sigma_{p}^{2})$。每个波段 $d$ 对距离的贡献现在按其全局方差的倒数 $1/\\sigma_{d}^2$进行缩放。具体来说，单个像素 $i$ 在波段 $d$ 上的平方误差变为 $\\frac{(x_{id} - \\mu_{kd})^2}{\\sigma_d^2}$。\n\n这对遥感中的波段主导作用具有关键影响。高方差（大的 $\\sigma_d^2$）的光谱波段往往具有较大的差值平方数值，从而在标准欧几里得距离计算和目标函数 $J$ 中占主导地位。聚类算法会优先形成在这些高方差波段中减小方差的簇，而常常忽略低方差波段中的信息。通过标准化数据，我们引入了因子 $1/\\sigma_d^2$，它降低了高方差波段的贡献权重，并提高了低方差波段的贡献权重。这有效地使每个波段对聚类过程的影响归一化，从而得到的划分对所有波段中的模式都敏感，而不仅仅是对变化最大的波段。\n\n该公式直接与马哈拉诺比斯距离（Mahalanobis distance）相联系。给定一个协方差矩阵 $\\mathbf{\\Sigma}$，从点 $\\mathbf{x}$ 到均值 $\\boldsymbol{\\mu}$ 的马哈拉诺比斯距离的平方为 $(\\mathbf{x}-\\boldsymbol{\\mu})^{T}\\mathbf{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})$。目标函数 $J^{(z)}$ 是每个点 $\\mathbf{x}_i$ 与其簇质心 $\\boldsymbol{\\mu}_k$ 之间的马哈拉诺比斯距离平方的总和。此处使用的协方差矩阵是 $\\mathbf{S}$，一个由全局按波段方差组成的对角矩阵。这种特定形式，即对角马哈拉诺比斯距离，假设了光谱波段是不相关的。因此，对z-标准化数据进行聚类，在数学上等同于在原始数据上使用这种特定的马哈拉诺比斯距离（而非欧几里得距离）来执行 $k$-均值算法。这为将标准化作为一种解释不同特征间尺度和方差差异的方法提供了形式化的依据。",
            "answer": "$$\n\\boxed{\\sum_{k=1}^{K} \\sum_{i \\in C_{k}} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})^{T} \\mathbf{S}^{-1} (\\mathbf{x}_{i} - \\boldsymbol{\\mu}_{k})}\n$$"
        },
        {
            "introduction": "K-means 和 ISODATA 算法通过迭代优化聚类中心直至收敛，但这个过程何时才算真正“完成”？仅仅等待质心不再移动可能效率低下。本练习挑战您从第一性原理出发，推导出一个充分的停止条件，将质心移动的量与整个分类图的几何稳定性联系起来。",
            "id": "3863354",
            "problem": "一幅具有 $d$ 个光谱波段的多光谱卫星图像已被归一化，使得每个特征值都位于 $[0,1]$ 区间内。你使用 $k$-均值算法和迭代自组织数据分析技术算法 (ISODATA) 进行非监督分类。设 $\\{\\mu_k^{(t)}\\}_{k=1}^K$ 表示第 $t$ 次迭代时的簇中心，并将第 $t-1$ 次和第 $t$ 次迭代之间的最大中心位移定义为\n$$\n\\Delta^{(t)} \\equiv \\max_{1 \\le k \\le K} \\left\\|\\mu_k^{(t)} - \\mu_k^{(t-1)}\\right\\|.\n$$\n类别分配是根据欧几里得距离下的最近邻中心法则进行的。将第 $t-1$ 次迭代时的最小中心间距定义为\n$$\ns^{(t-1)} \\equiv \\min_{i \\neq j} \\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\|,\n$$\n并将第 $t-1$ 次迭代时的最大簇内半径定义为\n$$\nr_{\\max}^{(t-1)} \\equiv \\max_{1 \\le k \\le K} \\max_{x \\in C_k^{(t-1)}} \\left\\|x - \\mu_k^{(t-1)}\\right\\|,\n$$\n其中 $C_k^{(t-1)}$ 是分配给中心 $\\mu_k^{(t-1)}$ 的像素集合。\n\n仅从欧几里得距离的定义、$k$-均值分配规则（最近邻中心）以及三角不等式出发，推导一个充分的停止阈值 $\\varepsilon$，使得当 $\\Delta^{(t)} \\le \\varepsilon$ 时，在第 $t$ 次迭代中没有像素的类别标签会发生改变（即类别标签图稳定）。你的推导必须仅用 $s^{(t-1)}$ 和 $r_{\\max}^{(t-1)}$ 来表示 $\\varepsilon$，并且必须对不执行合并或分裂操作的 $k$-均值和 ISODATA 迭代都有效。\n\n然后，对于一个 $s^{(t-1)} = 0.42$ 和 $r_{\\max}^{(t-1)} = 0.11$ 的特定场景，计算 $\\varepsilon$ 的数值。将你的答案四舍五入到四位有效数字。由于特征是归一化的反射率，因此将最终阈值表示为无量纲值。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在非监督机器学习和遥感领域具有科学依据，提法恰当，包含了所有必要的定义和约束，表述客观，并提出了一个基于基本数学原理的可解挑战。\n\n目标是为最大中心位移 $\\Delta^{(t)}$ 推导出一个充分的停止阈值 $\\varepsilon$，使得当 $\\Delta^{(t)} \\le \\varepsilon$ 时，在 $k$-均值或 ISODATA 类型算法（不进行簇的分裂或合并）的第 $t$ 次迭代期间，没有像素会改变其簇分配。像素的簇分配由欧几里得距离下的最近邻中心法则确定。推导必须仅依赖于欧几里得距离的定义、分配规则和三角不等式。\n\n设 $x$ 是 $d$ 维特征空间中的一个任意像素。在第 $t-1$ 次迭代时，像素 $x$ 被分配到簇 $C_i^{(t-1)}$，其中心为 $\\mu_i^{(t-1)}$。根据最近邻中心分配规则，这意味着对于任何其他簇 $j \\ne i$：\n$$\n\\left\\|x - \\mu_i^{(t-1)}\\right\\| \\le \\left\\|x - \\mu_j^{(t-1)}\\right\\|\n$$\n在第 $t$ 次迭代时，中心更新到新位置 $\\{\\mu_k^{(t)}\\}_{k=1}^K$。为使簇分配保持稳定，像素 $x$ 必须仍然被分配到簇 $i$。这要求它到新中心 $\\mu_i^{(t)}$ 的距离小于或等于它到任何其他新中心 $\\mu_j^{(t)}$ 的距离：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| \\le \\left\\|x - \\mu_j^{(t)}\\right\\| \\quad \\text{对所有 } j \\ne i\n$$\n我们的目标是找到一个关于 $\\Delta^{(t)} \\equiv \\max_{k} \\left\\|\\mu_k^{(t)} - \\mu_k^{(t-1)}\\right\\|$ 的条件，以保证该不等式对任何像素 $x$ 都成立。我们将通过找到不等式左侧的上限和右侧的下限来建立这个条件。\n\n首先，我们找到 $\\left\\|x - \\mu_i^{(t)}\\right\\|$ 的一个上限。通过应用三角不等式，我们可以写出：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| = \\left\\|(x - \\mu_i^{(t-1)}) + (\\mu_i^{(t-1)} - \\mu_i^{(t)})\\right\\| \\le \\left\\|x - \\mu_i^{(t-1)}\\right\\| + \\left\\|\\mu_i^{(t-1)} - \\mu_i^{(t)}\\right\\|\n$$\n由于 $x$ 属于簇 $C_i^{(t-1)}$，它到中心 $\\mu_i^{(t-1)}$ 的距离以最大簇内半径 $r_{\\max}^{(t-1)}$ 为界：\n$$\n\\left\\|x - \\mu_i^{(t-1)}\\right\\| \\le \\max_{z \\in C_i^{(t-1)}} \\left\\|z - \\mu_i^{(t-1)}\\right\\| \\le r_{\\max}^{(t-1)}\n$$\n中心 $i$ 的位移以所有中心的最大位移 $\\Delta^{(t)}$ 为界：\n$$\n\\left\\|\\mu_i^{(t-1)} - \\mu_i^{(t)}\\right\\| = \\left\\|\\mu_i^{(t)} - \\mu_i^{(t-1)}\\right\\| \\le \\Delta^{(t)}\n$$\n代入这些界限，我们得到了 $x$ 到其新的“归属”中心的距离的一个上限：\n$$\n\\left\\|x - \\mu_i^{(t)}\\right\\| \\le r_{\\max}^{(t-1)} + \\Delta^{(t)}\n$$\n\n接下来，我们为任意 $j \\ne i$ 找到 $\\left\\|x - \\mu_j^{(t)}\\right\\|$ 的一个下限。使用反三角不等式（$\\|a-b\\| \\ge \\|a\\| - \\|b\\|$），我们有：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| = \\left\\|(x - \\mu_j^{(t-1)}) - (\\mu_j^{(t)} - \\mu_j^{(t-1)})\\right\\| \\ge \\left\\|x - \\mu_j^{(t-1)}\\right\\| - \\left\\|\\mu_j^{(t)} - \\mu_j^{(t-1)}\\right\\|\n$$\n第二项以 $\\Delta^{(t)}$ 为界，所以：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| \\ge \\left\\|x - \\mu_j^{(t-1)}\\right\\| - \\Delta^{(t)}\n$$\n现在，我们需要找到 $\\left\\|x - \\mu_j^{(t-1)}\\right\\|$ 的一个下限，即像素 $x$（在簇 $i$ 中）到上一次迭代中另一个中心 $j$ 的距离。我们对 $x$、$\\mu_i^{(t-1)}$ 和 $\\mu_j^{(t-1)}$ 这三个点应用三角不等式：\n$$\n\\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\| \\le \\left\\|\\mu_i^{(t-1)} - x\\right\\| + \\left\\|x - \\mu_j^{(t-1)}\\right\\|\n$$\n重新整理可得：\n$$\n\\left\\|x - \\mu_j^{(t-1)}\\right\\| \\ge \\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\| - \\left\\|x - \\mu_i^{(t-1)}\\right\\|\n$$\n为了找到对任意像素 $x \\in C_i^{(t-1)}$ 和任意竞争簇 $j$ 都成立的 $\\left\\|x - \\mu_j^{(t-1)}\\right\\|$ 的最紧下限，我们必须考虑右侧各项的最坏情况值。项 $\\left\\|\\mu_i^{(t-1)} - \\mu_j^{(t-1)}\\right\\|$ 由最小中心间距 $s^{(t-1)}$ 最小化。项 $\\left\\|x - \\mu_i^{(t-1)}\\right\\|$ 由最大簇内半径 $r_{\\max}^{(t-1)}$ 最大化。因此：\n$$\n\\left\\|x - \\mu_j^{(t-1)}\\right\\| \\ge s^{(t-1)} - r_{\\max}^{(t-1)}\n$$\n将此结果代回到我们为 $\\left\\|x - \\mu_j^{(t)}\\right\\|$ 求得的下限中：\n$$\n\\left\\|x - \\mu_j^{(t)}\\right\\| \\ge (s^{(t-1)} - r_{\\max}^{(t-1)}) - \\Delta^{(t)}\n$$\n\n现在，我们已经确立了到新的归属中心距离的最坏情况上限，以及到任何新的竞争中心距离的最坏情况下限。为了使所有像素的簇分配都稳定，必须满足以下充分条件：\n$$\n\\text{到 } \\mu_i^{(t)} \\text{ 距离的上限 } \\le \\text{到 } \\mu_j^{(t)} \\text{ 距离的下限 }\n$$\n$$\nr_{\\max}^{(t-1)} + \\Delta^{(t)} \\le s^{(t-1)} - r_{\\max}^{(t-1)} - \\Delta^{(t)}\n$$\n我们现在可以解出 $\\Delta^{(t)}$，以找到保证稳定性的条件：\n$$\n2\\Delta^{(t)} \\le s^{(t-1)} - 2r_{\\max}^{(t-1)}\n$$\n$$\n\\Delta^{(t)} \\le \\frac{s^{(t-1)}}{2} - r_{\\max}^{(t-1)}\n$$\n如果最大中心位移 $\\Delta^{(t)}$ 满足此不等式，则没有像素会改变其簇分配。因此，充分的停止阈值 $\\varepsilon$ 是：\n$$\n\\varepsilon = \\frac{s^{(t-1)}}{2} - r_{\\max}^{(t-1)}\n$$\n\n给定具体数值 $s^{(t-1)} = 0.42$ 和 $r_{\\max}^{(t-1)} = 0.11$。我们现在可以计算 $\\varepsilon$ 的数值：\n$$\n\\varepsilon = \\frac{0.42}{2} - 0.11 = 0.21 - 0.11 = 0.1\n$$\n题目要求答案四舍五入到四位有效数字。由于计算结果是精确的，我们将其表示为 $0.1000$。所涉及的量均源自归一化特征空间中的距离，因此所得阈值 $\\varepsilon$ 是一个无量纲值。\n$$\n\\varepsilon = 0.1000\n$$",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "现实世界中的遥感数据很少是完美的，常常包含异常值（例如受阴影影响的像素），这些异常值会破坏聚类结果。标准的 K-means 对此类异常值高度敏感。这个动手实践将您置于一个真实场景中，要求您设计一个稳健的加权方案，利用稳健统计学的原理，逐波段选择性地降低异常值的影响。",
            "id": "3863385",
            "problem": "一台推扫式成像光谱仪获取了一个植被覆盖流域的三个反射率波段：蓝光 $B$、红光 $R$ 和近红外 (NIR)。您将为使用 $k$-means 和迭代自组织数据分析技术算法 (ISODATA) 的无监督聚类设计一个稳健的多波段加权方案，以减轻阴影像素的影响。这些阴影像素在可见光波段是异常值，但在近红外波段不是。\n\n假设当前的 $k$-means 植被原型（聚类中心）的反射率均值为 $\\boldsymbol{\\mu}_{\\text{veg}} = [\\mu_B, \\mu_R, \\mu_N] = [0.060, 0.040, 0.480]$。根据经验估计的内点尺度（簇内距离的各波段标准差）为 $\\boldsymbol{s} = [s_B, s_R, s_N] = [0.008, 0.007, 0.050]$。一个受植被投射阴影影响的像素子集，其观测反射率为 $\\boldsymbol{x}_{\\text{sh}} = [x_B, x_R, x_N] = [0.020, 0.015, 0.450]$。所有反射率均为 $[0,1]$ 范围内的无量纲分数。\n\n您采用逐波段的 Huber 型稳健加权方法进行 $k$-means 分配和 ISODATA 方差计算。对于每个波段 $b \\in \\{B,R,N\\}$，定义残差 $r_b = x_b - \\mu_b$，标准化残差 $u_b = r_b / s_b$，以及具有共同阈值参数 $\\kappa > 0$ 的 Huber 影响函数，其表达式为\n$$\n\\psi_{\\kappa}(u) = \n\\begin{cases}\nu, & |u| \\le \\kappa,\\\\\n\\kappa\\,\\mathrm{sign}(u), & |u| > \\kappa.\n\\end{cases}\n$$\n相应的稳健权重为 $w_b(\\kappa) = \\psi_{\\kappa}(u_b)/u_b = \\min\\{1,\\kappa/|u_b|\\}$（当 $u_b \\neq 0$ 时）以及 $w_b(\\kappa)=1$（当 $u_b=0$ 时）。这产生了一个用于分配的稳健、多波段、缩放的平方距离，\n$$\nD_{\\kappa}^2(\\boldsymbol{x},\\boldsymbol{\\mu}) = \\sum_{b \\in \\{B,R,N\\}} \\left[w_b(\\kappa)\\,\\frac{r_b}{s_b}\\right]^2,\n$$\n并且相同的权重 $w_b(\\kappa)$ 也用于计算 ISODATA 分裂-合并决策中的加权簇内离散度。\n\n您的设计目标是选择一个单一的 $\\kappa$ 值（所有波段通用），对于给定的阴影像素相对于植被原型，该值能强制实现以下条件：可见光波段 $B$ 和 $R$ 应处于饱和区 $|u_b| > \\kappa$（因此它们的影响是有界的），而近红外波段 NIR 应处于线性区 $|u_N| \\le \\kappa$（因此它仍然提供信息）。在所有满足这些区域约束的 $\\kappa$ 中，您将通过解决以下极大化极小值问题来选择一个能使 $\\kappa$ 与两个区域边界之间的对称分离间隔最大化的值：\n$$\n\\max_{\\kappa > 0} \\;\\; \\min\\!\\left\\{ \\frac{\\kappa}{|u_N|}, \\; \\frac{\\min\\{|u_B|,|u_R|\\}}{\\kappa} \\right\\}\n\\quad \\text{subject to} \\quad |u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}.\n$$\n\n计算解决此问题的 $\\kappa$ 值，使用给定的 $\\boldsymbol{\\mu}_{\\text{veg}}$、$\\boldsymbol{s}$ 和 $\\boldsymbol{x}_{\\text{sh}}$。将最终答案四舍五入至四位有效数字。",
            "solution": "该问题提出了为遥感中的稳健无监督分类算法设计一个加权参数 $\\kappa$ 的任务。在进行求解之前，先对问题陈述进行验证。\n\n**问题验证**\n1.  **已知条件提取**：\n    -   波段：蓝光 ($B$)、红光 ($R$)、近红外 ($N$)。\n    -   植被原型平均反射率：$\\boldsymbol{\\mu}_{\\text{veg}} = [\\mu_B, \\mu_R, \\mu_N] = [0.060, 0.040, 0.480]$。\n    -   内点尺度（标准差）：$\\boldsymbol{s} = [s_B, s_R, s_N] = [0.008, 0.007, 0.050]$。\n    -   阴影像素反射率：$\\boldsymbol{x}_{\\text{sh}} = [x_B, x_R, x_N] = [0.020, 0.015, 0.450]$。\n    -   定义：$r_b = x_b - \\mu_b$，$u_b = r_b / s_b$。\n    -   优化问题：$\\max_{\\kappa > 0} \\;\\; \\min\\!\\left\\{ \\frac{\\kappa}{|u_N|}, \\; \\frac{\\min\\{|u_B|,|u_R|\\}}{\\kappa} \\right\\}$，约束条件为 $|u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}$。\n\n2.  **有效性检查**：\n    -   **科学依据**：该问题在稳健统计学和遥感领域有充分的依据。使用 Huber 型影响函数来降低异常值（阴影像素）的权重是一种标准技术。阴影对可见光波段（$B$, $R$）反射率的降低程度远大于近红外波段，这一物理前提对于植被表面是正确的。\n    -   **适定性**：所有必要的数据和定义均已提供。优化问题陈述清晰，其结构可产生唯一且有意义的解。\n    -   **客观性**：问题以精确的数学和技术术语表述，没有主观或模糊的语言。\n\n3.  **结论**：问题有效。这是一个基于可靠科学原理、定义明确的数学优化问题，可以推导出解。\n\n**求解推导**\n\n目标是计算阈值参数 $\\kappa$ 的最优值。第一步是使用给定的尺度 $\\boldsymbol{s}$，计算阴影像素 $\\boldsymbol{x}_{\\text{sh}}$ 相对于植被原型 $\\boldsymbol{\\mu}_{\\text{veg}}$ 的标准化残差 $u_b$。\n\n对于每个波段 $b \\in \\{B, R, N\\}$，残差为 $r_b = x_b - \\mu_b$，标准化残差为 $u_b = r_b / s_b$。\n\n对于蓝光波段 ($B$)：\n$$\nr_B = x_B - \\mu_B = 0.020 - 0.060 = -0.040\n$$\n$$\nu_B = \\frac{r_B}{s_B} = \\frac{-0.040}{0.008} = -5\n$$\n\n对于红光波段 ($R$)：\n$$\nr_R = x_R - \\mu_R = 0.015 - 0.040 = -0.025\n$$\n$$\nu_R = \\frac{r_R}{s_R} = \\frac{-0.025}{0.007} = -\\frac{25}{7}\n$$\n\n对于近红外波段 ($N$)：\n$$\nr_N = x_N - \\mu_N = 0.450 - 0.480 = -0.030\n$$\n$$\nu_N = \\frac{r_N}{s_N} = \\frac{-0.030}{0.050} = -0.6\n$$\n\n优化问题需要这些标准化残差的绝对值：\n$$\n|u_B| = 5\n$$\n$$\n|u_R| = \\frac{25}{7} \\approx 3.5714\n$$\n$$\n|u_N| = 0.6\n$$\n\n优化受约束 $|u_N|  \\kappa  \\min\\{|u_B|,|u_R|\\}$ 的限制。我们为此约束定义下界 $L$ 和上界 $U$。\n下界是 $L = |u_N| = 0.6$。\n上界是 $U = \\min\\{|u_B|, |u_R|\\} = \\min\\left\\{5, \\frac{25}{7}\\right\\}$。因为 $5 = \\frac{35}{7}$，所以最小值是 $\\frac{25}{7}$。因此，$U = \\frac{25}{7}$。\n对 $\\kappa$ 的约束是 $0.6  \\kappa  \\frac{25}{7}$。\n\n问题是要求解：\n$$\n\\max_{\\kappa} \\min\\left\\{ \\frac{\\kappa}{L}, \\frac{U}{\\kappa} \\right\\}\n$$\n我们要最大化函数 $f(\\kappa) = \\min\\left\\{ \\frac{\\kappa}{L}, \\frac{U}{\\kappa} \\right\\}$。其中，$\\frac{\\kappa}{L}$ 项随 $\\kappa$ 增大而增大，而 $\\frac{U}{\\kappa}$ 项随 $\\kappa$ 增大而减小。这两个函数的最小值的最大值出现在它们相等的地方：\n$$\n\\frac{\\kappa}{L} = \\frac{U}{\\kappa}\n$$\n求解 $\\kappa$（其中 $\\kappa > 0$）：\n$$\n\\kappa^2 = L \\cdot U\n$$\n$$\n\\kappa = \\sqrt{L \\cdot U}\n$$\n这个解是边界 $L$ 和 $U$ 的几何平均值。只要 $L  U$，该解就保证位于区间 $(L, U)$ 内，本例中该条件成立（$0.6  \\frac{25}{7}$）。\n\n现在，我们代入 $L$ 和 $U$ 的数值来计算 $\\kappa$。\n$$\nL = 0.6 = \\frac{3}{5}\n$$\n$$\nU = \\frac{25}{7}\n$$\n$$\n\\kappa = \\sqrt{\\left(\\frac{3}{5}\\right) \\cdot \\left(\\frac{25}{7}\\right)} = \\sqrt{\\frac{3 \\cdot 25}{5 \\cdot 7}} = \\sqrt{\\frac{3 \\cdot 5}{7}} = \\sqrt{\\frac{15}{7}}\n$$\n为了得到最终答案，我们计算其数值并按要求四舍五入到四位有效数字。\n$$\n\\kappa = \\sqrt{\\frac{15}{7}} \\approx \\sqrt{2.14285714...} \\approx 1.463850109...\n$$\n四舍五入到四位有效数字得到 $\\kappa \\approx 1.464$。该值位于约束区间 $(0.6, \\frac{25}{7})$ 内，验证了其有效性。",
            "answer": "$$\\boxed{1.464}$$"
        }
    ]
}