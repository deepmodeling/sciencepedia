{
    "hands_on_practices": [
        {
            "introduction": "训练数据的质量始于单个标签的准确性。在遥感领域，一个主要的误差来源是现场测量位置与其对应像素之间的不匹配，即地理定位误差。这项实践将指导你对这种误差进行数学建模，并量化其对标签分配的影响，特别是在类别边界附近，那里的误标风险最高。通过推导在这种误差影响下的预期混淆矩阵 ，你将深入理解位置不确定性如何转化为标签噪声。",
            "id": "3856402",
            "problem": "一个遥感团队正在为一个类别边界局部平滑的区域设计一个用于双类别土地覆盖图（类别 $A$ 和 $B$）的监督训练数据集。训练标签是通过将每个实地观测的地理位置叠加到地图上来分配的；然而，由于全球导航卫星系统（GNSS）的漂移，地理位置存在误差，该误差被建模为一个二元高斯随机向量 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{2 \\times 2}$。在局部，类别边界被近似为一条具有单位法向量 $\\mathbf{n} \\in \\mathbb{R}^{2}$ 的直线。一个真实位置为 $\\mathbf{r}$ 的实地观测点，其到边界的有符号法向距离为 $d = \\mathbf{n}^{\\mathsf{T}}\\mathbf{r}$；按照惯例，$d \\ge 0$ 表示类别 $A$，$d  0$ 表示类别 $B$。训练标签是根据观测位置的有符号距离 $d_{\\text{obs}} = \\mathbf{n}^{\\mathsf{T}}(\\mathbf{r} + \\boldsymbol{\\epsilon})$ 的符号来分配的。\n\n假设团队为表征混淆而有意在边界附近采样：在给定真实类别的条件下，有符号法向距离 $d$ 在以边界为中心、宽度为 $2D$ 的带状区域内均匀分布，即对于类别 $A$，$d \\sim \\text{Uniform}([0, D])$；对于类别 $B$，$d \\sim \\text{Uniform}([-D, 0])$，并且对两个类别的采样投入相等。在此采样方案和误差模型下，定义期望的 $2 \\times 2$ 混淆矩阵 $C(\\Sigma, D, \\mathbf{n})$，其元素 $C_{ij}$ 表示一个真实类别为 $i \\in \\{A,B\\}$ 的观测在计入地理位置误差后被赋予标签 $j \\in \\{A,B\\}$ 的概率。\n\n仅从多元正态分布的基本定义、高斯随机向量的线性泛函仍为高斯分布的性质，以及混淆矩阵作为对 $d$ 的采样分布进行平均的类别条件分配概率的定义出发，推导 $C(\\Sigma, D, \\mathbf{n})$ 的闭式解析表达式。你可以使用标准正态累积分布函数 $\\Phi(\\cdot)$、标准正态概率密度函数 $\\phi(\\cdot)$ 以及标量 $\\sigma_{\\mathbf{n}}^{2} = \\mathbf{n}^{\\mathsf{T}}\\Sigma \\mathbf{n}$ 来表示你的答案。\n\n请以完整的 $2 \\times 2$ 矩阵 $C(\\Sigma, D, \\mathbf{n})$ 的形式给出最终结果。无需进行数值计算；请将表达式保留为闭式形式。",
            "solution": "用户要求在特定的采样和误差模型下，对期望混淆矩阵进行详细推导。\n\n_步骤1：问题验证_\n\n**提取的已知条件：**\n*   **类别：** 两个类别，记为 $A$ 和 $B$。\n*   **类别边界：** 具有单位法向量 $\\mathbf{n} \\in \\mathbb{R}^{2}$ 的局部线性近似。\n*   **真实位置和距离：** 一个点的真实位置为 $\\mathbf{r}$，其到边界的有符号法向距离为 $d = \\mathbf{n}^{\\mathsf{T}}\\mathbf{r}$。\n*   **真实类别定义：** 若 $d \\ge 0$，则为类别 $A$；若 $d  0$，则为类别 $B$。\n*   **地理位置误差模型：** 误差是一个随机向量 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其中 $\\Sigma \\in \\mathbb{R}^{2 \\times 2}$ 是协方差矩阵。\n*   **观测位置和距离：** 观测位置为 $\\mathbf{r} + \\boldsymbol{\\epsilon}$，观测的有符号距离为 $d_{\\text{obs}} = \\mathbf{n}^{\\mathsf{T}}(\\mathbf{r} + \\boldsymbol{\\epsilon})$。\n*   **标签分配规则：** 若 $d_{\\text{obs}} \\ge 0$，则标签为 $A$；若 $d_{\\text{obs}}  0$，则标签为 $B$。\n*   **真实距离 ($d$) 的采样分布：**\n    *   对于真实类别 $A$：$d \\sim \\text{Uniform}([0, D])$。\n    *   对于真实类别 $B$：$d \\sim \\text{Uniform}([-D, 0])$。\n*   **目标输出：** $2 \\times 2$ 期望混淆矩阵 $C(\\Sigma, D, \\mathbf{n})$ 的闭式表达式，其中 $C_{ij}$ 是将标签 $j$ 分配给真实类别为 $i$ 的观测的概率。\n*   **允许使用的函数/符号：** 标准正态累积分布函数 $\\Phi(\\cdot)$，标准正态概率密度函数 $\\phi(\\cdot)$，以及 $\\sigma_{\\mathbf{n}}^{2} = \\mathbf{n}^{\\mathsf{T}}\\Sigma \\mathbf{n}$。\n\n**验证分析：**\n该问题具有科学依据、适定且客观。它提供了一套清晰、自洽的数学定义和统计模型，这些在依赖地理位置的数据分析（如遥感）中很常用。这些假设（线性边界、高斯误差、均匀采样）是为了便于解析处理而进行的明确简化，并非科学上的缺陷。问题要求基于这些假设进行数学推导，这是定量科学中的一项标准任务。所有术语都经过了形式化定义，不存在会妨碍得出唯一解的矛盾、歧义或信息缺失。\n\n**结论：** 该问题有效。\n\n_步骤2：求解推导_\n\n观测的有符号距离 $d_{\\text{obs}}$ 可以表示为真实有符号距离 $d$ 和一个投影误差项的和：\n$$d_{\\text{obs}} = \\mathbf{n}^{\\mathsf{T}}(\\mathbf{r} + \\boldsymbol{\\epsilon}) = \\mathbf{n}^{\\mathsf{T}}\\mathbf{r} + \\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon} = d + \\epsilon_n$$\n其中，我们将沿法向量 $\\mathbf{n}$ 的标量误差分量定义为 $\\epsilon_n = \\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon}$。\n\n地理位置误差 $\\boldsymbol{\\epsilon}$ 是一个多元正态随机向量，$\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$。由于 $\\epsilon_n$ 是 $\\boldsymbol{\\epsilon}$ 的线性变换，因此 $\\epsilon_n$ 也是一个服从正态分布的随机变量。其均值为：\n$$E[\\epsilon_n] = E[\\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon}] = \\mathbf{n}^{\\mathsf{T}}E[\\boldsymbol{\\epsilon}] = \\mathbf{n}^{\\mathsf{T}}\\mathbf{0} = 0$$\n其方差为：\n$$\\text{Var}(\\epsilon_n) = E[\\epsilon_n^2] - (E[\\epsilon_n])^2 = E[(\\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon})(\\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon})^{\\mathsf{T}}] = E[\\mathbf{n}^{\\mathsf{T}}\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^{\\mathsf{T}}\\mathbf{n}] = \\mathbf{n}^{\\mathsf{T}}E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^{\\mathsf{T}}]\\mathbf{n}$$\n鉴于 $E[\\boldsymbol{\\epsilon}] = \\mathbf{0}$，协方差矩阵为 $\\Sigma = E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^{\\mathsf{T}}]$。因此，方差为 $\\text{Var}(\\epsilon_n) = \\mathbf{n}^{\\mathsf{T}}\\Sigma\\mathbf{n}$，此即定义的 $\\sigma_{\\mathbf{n}}^2$。\n因此，垂直于边界的误差分量服从一维正态分布：$\\epsilon_n \\sim \\mathcal{N}(0, \\sigma_{\\mathbf{n}}^2)$。\n\n混淆矩阵 $C$ 的元素为 $C_{ij} = P(\\text{标签}=j | \\text{真实类别}=i)$。矩阵的各行之和必须为1，所以 $C_{AB} = 1 - C_{AA}$ 且 $C_{BA} = 1 - C_{BB}$。我们需要计算对角线元素 $C_{AA}$ 和 $C_{BB}$。\n\n**计算 $C_{AA}$（类别 A 的真阳性率）：**\n$C_{AA}$ 是一个来自真实类别 $A$ 的观测被标记为 $A$ 的概率。这通过对类别 $A$ 样本的真实距离 $d$ 的采样分布进行边缘化来获得。\n$$C_{AA} = P(d_{\\text{obs}} \\ge 0 | \\text{true class A})$$\n根据全概率定律，我们对类别 $A$ 的所有可能的 $d$ 值进行积分：\n$$C_{AA} = \\int_{0}^{D} P(d_{\\text{obs}} \\ge 0 | d) \\cdot p(d | \\text{true class A}) \\, \\mathrm{d}d$$\n给定对于 $d \\in [0, D]$，$p(d | \\text{真实类别 A}) = \\frac{1}{D}$，上式变为：\n$$C_{AA} = \\frac{1}{D} \\int_{0}^{D} P(d + \\epsilon_n \\ge 0) \\, \\mathrm{d}d$$\n积分内的概率为：\n$$P(d + \\epsilon_n \\ge 0) = P(\\epsilon_n \\ge -d)$$\n令 $Z = \\epsilon_n / \\sigma_{\\mathbf{n}}$ 为一个标准正态变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$P(\\epsilon_n \\ge -d) = P\\left(Z \\ge -\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) = 1 - P\\left(Z  -\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) = 1 - \\Phi\\left(-\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) = \\Phi\\left(\\frac{d}{\\sigma_{\\mathbf{n}}}\\right)$$\n将此代回 $C_{AA}$ 的积分中：\n$$C_{AA} = \\frac{1}{D} \\int_{0}^{D} \\Phi\\left(\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) \\, \\mathrm{d}d$$\n为计算此积分，我们进行换元，令 $x = d/\\sigma_{\\mathbf{n}}$，则有 $\\mathrm{d}d = \\sigma_{\\mathbf{n}}\\mathrm{d}x$。积分限从 $[0, D]$ 变为 $[0, D/\\sigma_{\\mathbf{n}}]$。\n$$C_{AA} = \\frac{1}{D} \\int_{0}^{D/\\sigma_{\\mathbf{n}}} \\Phi(x) (\\sigma_{\\mathbf{n}} \\mathrm{d}x) = \\frac{\\sigma_{\\mathbf{n}}}{D} \\int_{0}^{D/\\sigma_{\\mathbf{n}}} \\Phi(x) \\, \\mathrm{d}x$$\n我们使用分部积分法 $\\int u \\, \\mathrm{d}v = uv - \\int v \\, \\mathrm{d}u$，令 $u = \\Phi(x)$ 且 $\\mathrm{d}v = \\mathrm{d}x$。这得到 $\\mathrm{d}u = \\phi(x)\\mathrm{d}x$ 且 $v = x$。不定积分为：\n$$\\int \\Phi(x) \\, \\mathrm{d}x = x\\Phi(x) - \\int x\\phi(x) \\, \\mathrm{d}x$$\n由于 $\\phi(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-x^2/2)$ 的导数是 $\\phi'(x) = -x\\phi(x)$，所以积分 $\\int x\\phi(x) \\, \\mathrm{d}x = -\\phi(x)$。\n$$\\int \\Phi(x) \\, \\mathrm{d}x = x\\Phi(x) + \\phi(x) + \\text{const.}$$\n应用积分限：\n$$\\int_{0}^{D/\\sigma_{\\mathbf{n}}} \\Phi(x) \\, \\mathrm{d}x = \\left[x\\Phi(x) + \\phi(x)\\right]_{0}^{D/\\sigma_{\\mathbf{n}}} = \\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right)\\right) - \\left(0 \\cdot \\Phi(0) + \\phi(0)\\right)$$\n将此结果代回 $C_{AA}$ 的表达式中：\n$$C_{AA} = \\frac{\\sigma_{\\mathbf{n}}}{D} \\left[ \\frac{D}{\\sigma_{\\mathbf{n}}}\\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right]$$\n化简后得到 $C_{AA}$ 的最终表达式：\n$$C_{AA} = \\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)$$\n\n**计算 $C_{BB}$（类别 B 的真阳性率）：**\n$C_{BB}$ 是一个来自真实类别 $B$ 的观测被标记为 $B$ 的概率。采样分布为对于 $d \\in [-D, 0)$，$p(d | \\text{真实类别 B}) = \\frac{1}{D}$。\n$$C_{BB} = P(d_{\\text{obs}}  0 | \\text{true class B}) = \\frac{1}{D} \\int_{-D}^{0} P(d + \\epsilon_n  0) \\, \\mathrm{d}d$$\n积分内的概率为：\n$$P(d + \\epsilon_n  0) = P(\\epsilon_n  -d) = P\\left(Z  -\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) = \\Phi\\left(-\\frac{d}{\\sigma_{\\mathbf{n}}}\\right)$$\n$C_{BB}$ 的积分为：\n$$C_{BB} = \\frac{1}{D} \\int_{-D}^{0} \\Phi\\left(-\\frac{d}{\\sigma_{\\mathbf{n}}}\\right) \\, \\mathrm{d}d$$\n由于问题设置的对称性，我们预期 $C_{BB} = C_{AA}$。我们可以通过换元来证明这一点。令 $u = -d$，则 $\\mathrm{d}u = -\\mathrm{d}d$。$u$ 的积分限变为 $[D, 0]$。\n$$C_{BB} = \\frac{1}{D} \\int_{D}^{0} \\Phi\\left(\\frac{u}{\\sigma_{\\mathbf{n}}}\\right) (-\\mathrm{d}u) = \\frac{1}{D} \\int_{0}^{D} \\Phi\\left(\\frac{u}{\\sigma_{\\mathbf{n}}}\\right) \\, \\mathrm{d}u$$\n该积分在形式上与 $C_{AA}$ 的积分相同，因此 $C_{BB} = C_{AA}$。\n\n**最终混淆矩阵：**\n混淆矩阵是对称的，其对角线元素彼此相等，非对角线元素也彼此相等。\n令 $P_{\\text{correct}} = C_{AA} = C_{BB} = \\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)$。\n非对角线元素为 $P_{\\text{error}} = C_{AB} = C_{BA} = 1 - P_{\\text{correct}}$。\n完整的混淆矩阵为：\n$$C(\\Sigma, D, \\mathbf{n}) = \\begin{pmatrix} P_{\\text{correct}}  1 - P_{\\text{correct}} \\\\ 1 - P_{\\text{correct}}  P_{\\text{correct}} \\end{pmatrix}$$\n代入 $P_{\\text{correct}}$ 的完整表达式，得到最终结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)  1 - \\left(\\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)\\right) \\\\\n1 - \\left(\\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)\\right)  \\Phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) + \\frac{\\sigma_{\\mathbf{n}}}{D} \\left( \\phi\\left(\\frac{D}{\\sigma_{\\mathbf{n}}}\\right) - \\phi(0) \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在考虑了单个标签的质量后，我们必须解决样本之间的关系问题。遥感数据很少是独立同分布的；空间上邻近的位置往往具有相似的数值，这种现象被称为空间自相关。这项实践引入了“有效样本量”这一关键概念 ，它通过对数据中的冗余信息进行校正，为我们提供了一种更真实的、衡量空间相关数据集中信息含量的方法。掌握这个概念对于准确评估模型性能和设计高效的采样方案至关重要。",
            "id": "3856352",
            "problem": "您正在为一个面积为 $A$ 的二维域上的遥感回归任务设计一个监督式训练数据集（例如，一个覆盖大片区域的影像镶嵌图）。设 $Z(\\mathbf{s})$ 表示一个二阶平稳各向同性随机场，代表在空间位置 $\\mathbf{s} \\in \\mathbb{R}^{2}$ 的目标变量（例如，土壤湿度），其均值为 $\\mu$，协方差函数为 $C(h)=\\sigma^{2}\\exp(-h/\\phi)$，其中 $h$ 是分离距离，$\\sigma^{2}$ 是边际方差，$\\phi$ 是相关长度。您以非常高且近似均匀的空间密度收集标签（例如，分辨率远高于 $\\phi$ 的所有像素），并且在训练时将它们视为独立的。将训练集的有效样本量 $n_{\\mathrm{eff}}$ 定义为：从一个方差为 $\\sigma^{2}$ 的随机变量中抽取的独立同分布样本的大小，该样本的空间面积平均值的方差与您实际的空间相关训练数据的方差相同。从二阶平稳随机场和面积平均值方差的基本定义出发，并假设 $A \\gg \\phi^{2}$ 以至于边缘效应可以忽略不计，推导出一个用 $A$ 和 $\\phi$ 表示 $n_{\\mathrm{eff}}$ 的闭式解析表达式。根据您的表达式，得出 $n_{\\mathrm{eff}}$ 如何随域大小和相关长度而变化。仅提供 $n_{\\mathrm{eff}}$ 的最终解析表达式作为答案。不需要进行数值代入，也不需要四舍五入。",
            "solution": "这个问题是有效的。它在科学上基于地质统计学和随机场理论的原理，问题提法得当，信息充分，目标明确，并且用精确、客观的语言表达。\n\n目标是为一个面积为 $A$ 的二维域上的空间相关数据集推导有效样本量 $n_{\\mathrm{eff}}$ 的表达式。代表目标变量的随机场 $Z(\\mathbf{s})$ 是二阶平稳且各向同性的，其均值为 $\\mu$，指数协方差函数为 $C(h) = \\sigma^{2}\\exp(-h/\\phi)$，其中 $h$ 是欧几里得距离，$\\sigma^2$ 是方差，$\\phi$ 是相关长度。\n\n有效样本量 $n_{\\mathrm{eff}}$ 定义为一个假设的独立同分布（i.i.d.）样本的大小，其样本均值的方差与相关场 $Z(\\mathbf{s})$ 的空间面积平均值的方差相同。\n\n首先，考虑一组 $n$ 个独立同分布的随机变量 $\\{X_1, X_2, \\ldots, X_n\\}$，每个变量的方差均为 $\\sigma^2$。它们的样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 的方差由下式给出：\n$$ \\mathrm{Var}(\\bar{X}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\mathrm{Var}(X_i) = \\frac{n\\sigma^2}{n^2} = \\frac{\\sigma^2}{n} $$\n根据问题中提供的定义，对于有效样本量 $n_{\\mathrm{eff}}$，此方差为 $\\frac{\\sigma^2}{n_{\\mathrm{eff}}}$。\n\n接下来，我们必须计算随机场 $Z(\\mathbf{s})$ 在域 $D$（面积为 $A = \\int_D d\\mathbf{s}$）上的空间面积平均值的方差。空间面积平均值 $\\bar{Z}_A$ 定义为：\n$$ \\bar{Z}_A = \\frac{1}{A} \\int_{D} Z(\\mathbf{s}) \\, d\\mathbf{s} $$\n$\\bar{Z}_A$ 的方差为：\n$$ \\mathrm{Var}(\\bar{Z}_A) = \\mathrm{Var}\\left(\\frac{1}{A} \\int_{D} Z(\\mathbf{s}) \\, d\\mathbf{s}\\right) = \\frac{1}{A^2} \\mathrm{Var}\\left(\\int_{D} Z(\\mathbf{s}) \\, d\\mathbf{s}\\right) $$\n对于二阶平稳随机场，该积分的方差由协方差函数在域上的二重积分给出：\n$$ \\mathrm{Var}\\left(\\int_{D} Z(\\mathbf{s}) \\, d\\mathbf{s}\\right) = \\int_{D} \\int_{D} \\mathrm{Cov}(Z(\\mathbf{s}_1), Z(\\mathbf{s}_2)) \\, d\\mathbf{s}_1 \\, d\\mathbf{s}_2 $$\n协方差由 $C(\\|\\mathbf{s}_1 - \\mathbf{s}_2\\|)$ 给出。因此，\n$$ \\mathrm{Var}(\\bar{Z}_A) = \\frac{1}{A^2} \\int_{D} \\int_{D} C(\\|\\mathbf{s}_1 - \\mathbf{s}_2\\|) \\, d\\mathbf{s}_1 \\, d\\mathbf{s}_2 $$\n计算这个四维积分通常很复杂。然而，问题陈述了这样一个假设，即域的面积 $A$ 远大于相关长度的平方，$A \\gg \\phi^2$。这意味着域的空间范围远大于数据点显著相关的范围。这使我们可以忽略边缘效应。\n\n我们可以通过变量替换来简化积分。令 $\\mathbf{h} = \\mathbf{s}_2 - \\mathbf{s}_1$。积分变为：\n$$ \\int_{D} \\int_{D} C(\\|\\mathbf{s}_2 - \\mathbf{s}_1\\|) \\, d\\mathbf{s}_1 \\, d\\mathbf{s}_2 = \\int_{D} \\left( \\int_{D-\\mathbf{s}_1} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} \\right) d\\mathbf{s}_1 $$\n其中 $D-\\mathbf{s}_1$ 是域 $D$ 按向量 $-\\mathbf{s}_1$ 平移后的域。对于任何不靠近 $D$ 边界的点 $\\mathbf{s}_1$（相对于 $\\phi$），协方差函数 $C(\\|\\mathbf{h}\\|)$ 将在积分域 $D-\\mathbf{s}_1$ 内很好地衰减到近似为零。鉴于假设 $A \\gg \\phi^2$，来自靠近边界的点 $\\mathbf{s}_1$ 的贡献可以忽略不计。因此，我们可以通过将其域扩展到整个 $\\mathbb{R}^2$ 来近似内层积分：\n$$ \\int_{D-\\mathbf{s}_1} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} \\approx \\int_{\\mathbb{R}^2} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} $$\n这个近似使得内层积分与 $\\mathbf{s}_1$ 无关。外层积分则变为：\n$$ \\int_{D} \\left(\\ldots\\right) d\\mathbf{s}_1 \\approx A \\int_{\\mathbb{R}^2} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} $$\n将此代回面积平均值方差的表达式中：\n$$ \\mathrm{Var}(\\bar{Z}_A) \\approx \\frac{1}{A^2} \\left( A \\int_{\\mathbb{R}^2} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} \\right) = \\frac{1}{A} \\int_{\\mathbb{R}^2} C(\\|\\mathbf{h}\\|) \\, d\\mathbf{h} $$\n现在我们必须计算给定的协方差函数 $C(h) = \\sigma^2 \\exp(-h/\\phi)$ 在 $\\mathbb{R}^2$ 上的积分。由于函数是各向同性的，我们转换为极坐标 $(h, \\theta)$，其中 $h$ 是径向距离，且 $d\\mathbf{h} = h \\, dh \\, d\\theta$。\n$$ \\int_{\\mathbb{R}^2} C(h) \\, d\\mathbf{h} = \\int_{0}^{2\\pi} \\int_{0}^{\\infty} \\sigma^2 \\exp(-h/\\phi) \\, h \\, dh \\, d\\theta $$\n对 $\\theta$ 从 $0$ 到 $2\\pi$ 的积分得到一个因子 $2\\pi$：\n$$ \\int_{\\mathbb{R}^2} C(h) \\, d\\mathbf{h} = 2\\pi\\sigma^2 \\int_{0}^{\\infty} h \\exp(-h/\\phi) \\, dh $$\n我们使用分部积分法求解剩余的积分，设 $u=h$ 和 $dv = \\exp(-h/\\phi) \\, dh$。这得到 $du=dh$ 和 $v = -\\phi \\exp(-h/\\phi)$。\n\\begin{align*}\n\\int_{0}^{\\infty} h \\exp(-h/\\phi) \\, dh = \\left[ -h\\phi\\exp(-h/\\phi) \\right]_0^{\\infty} - \\int_{0}^{\\infty} (-\\phi) \\exp(-h/\\phi) \\, dh \\\\\n= (0 - 0) + \\phi \\int_{0}^{\\infty} \\exp(-h/\\phi) \\, dh \\\\\n= \\phi \\left[ -\\phi\\exp(-h/\\phi) \\right]_0^{\\infty} \\\\\n= \\phi (0 - (-\\phi \\exp(0))) \\\\\n= \\phi^2\n\\end{align*}\n因此，协方差函数的积分为：\n$$ \\int_{\\mathbb{R}^2} C(h) \\, d\\mathbf{h} = 2\\pi\\sigma^2\\phi^2 $$\n将此结果代入我们对 $\\mathrm{Var}(\\bar{Z}_A)$ 的表达式中：\n$$ \\mathrm{Var}(\\bar{Z}_A) \\approx \\frac{2\\pi\\sigma^2\\phi^2}{A} $$\n最后，我们将此与有效样本量为 $n_{\\mathrm{eff}}$ 的独立同分布样本的方差相等：\n$$ \\frac{\\sigma^2}{n_{\\mathrm{eff}}} = \\frac{2\\pi\\sigma^2\\phi^2}{A} $$\n假设 $\\sigma^2 \\neq 0$，我们可以从两边消去 $\\sigma^2$：\n$$ \\frac{1}{n_{\\mathrm{eff}}} = \\frac{2\\pi\\phi^2}{A} $$\n解出 $n_{\\mathrm{eff}}$ 得到闭式表达式：\n$$ n_{\\mathrm{eff}} = \\frac{A}{2\\pi\\phi^2} $$\n从此表达式中，我们得出结论，有效样本量 $n_{\\mathrm{eff}}$ 与域面积 $A$ 成线性比例（$n_{\\mathrm{eff}} \\propto A$），并与相关长度 $\\phi$ 的平方成反比（$n_{\\mathrm{eff}} \\propto \\phi^{-2}$）。项 $2\\pi\\phi^2$ 可以解释为单个独立样本的有效面积。",
            "answer": "$$\\boxed{\\frac{A}{2\\pi\\phi^{2}}}$$"
        },
        {
            "introduction": "在掌握了样本质量和信息量的基本原则之后，最后一步是设计一个既有效又高效的数据收集策略。这项实践将带你应对一个真实的挑战：在有限的预算内为不同类别分配训练数据，而这些类别的错分成本和收集难度各不相同。你将学习如何构建并解决一个优化问题，以找到能够最大化最终地图总体效用的理想抽样比例 。这个练习将成本、类别不平衡性和学习难度等因素整合到一个统一的决策框架中。",
            "id": "3856398",
            "problem": "一个国家级湿地监测项目使用多光谱卫星图像的监督分类来识别临时性湿地和非湿地背景。该项目希望在不对称错分成本和有限的实地标注资源下，设计一个成本敏感的训练数据收集计划，以最大化最终操作性地图的期望效用。以下情景是科学上现实且自洽的。\n\n考虑两个土地覆盖类别：湿地和背景。令 $p_{w} \\in (0,1)$ 表示感兴趣区域内湿地的发生率，而 $p_{b} = 1 - p_{w}$ 表示背景的发生率。令 $C_{w} > 0$ 表示一个湿地像素被错分（假阴性）时产生的单像素成本，令 $C_{b} > 0$ 表示一个背景像素被错分（假阳性）时产生的单像素成本。假设操作性分类器对湿地和背景的类别条件泛化误差率（分别表示为 $e_{w}$ 和 $e_{b}$）随着特定类别训练标签数量的增加而降低，其关系遵循经验观察到的反比学习曲线：\n$$\ne_{w}(n_{w}) = \\frac{\\alpha_{w}}{n_{w}}, \\quad e_{b}(n_{b}) = \\frac{\\alpha_{b}}{n_{b}},\n$$\n对于 $n_{w} \\ge 1$ 和 $n_{b} \\ge 1$，其中 $\\alpha_{w} > 0$ 和 $\\alpha_{b} > 0$ 是反映类别复杂度、可分性和传感器噪声的常数。每个用于湿地的已标注训练样本需要 $k_{w} > 0$ 单位的实地工作量，每个用于背景的已标注训练样本需要 $k_{b} > 0$ 单位的实地工作量，固定的标注预算 $B > 0$ 施加了以下约束：\n$$\nk_{w} n_{w} + k_{b} n_{b} = B.\n$$\n\n将期望效用定义为区域上期望错分成本的负数，因此最大化期望效用等同于最小化期望风险\n$$\nR(n_{w}, n_{b}) = p_{w} C_{w} e_{w}(n_{w}) + p_{b} C_{b} e_{b}(n_{b}).\n$$\n\n仅使用这些定义和上述约束，构建旨在最大化期望效用的约束优化问题，并从第一性原理出发，推导出在给定的不对称错分成本和类别发生率下，在湿地和背景之间分配训练标签的最优抽样比 $n_{w}/n_{b}$ 的闭式表达式。将 $n_{w}$ 和 $n_{b}$ 视为正实数决策变量。用 $p_{w}$、$p_{b}$、$C_{w}$、$C_{b}$、$\\alpha_{w}$、$\\alpha_{b}$、$k_{w}$ 和 $k_{b}$ 将你的最终答案表示为 $n_{w}/n_{b}$ 的单个解析表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "任务是在不对称错分成本和固定标注预算下，设计一个最大化期望效用的抽样计划。根据期望效用是期望错分成本的负数的定义，最大化效用等同于最小化期望风险。理论基础包括：\n\n- 在类别发生率和单像素错分成本下，一个二分类问题的期望风险定义，\n- 类别条件泛化误差率约与特定类别训练样本数的倒数成反比的经验学习曲线关系，\n- 关于标注成本的线性预算约束。\n\n令 $n_{w} > 0$ 和 $n_{b} > 0$ 分别表示为湿地和背景收集的已标注训练样本数量。根据类别发生率和成本的定义，期望风险为\n$$\nR(n_{w}, n_{b}) = p_{w} C_{w} e_{w}(n_{w}) + p_{b} C_{b} e_{b}(n_{b}).\n$$\n在所述学习曲线模型下，\n$$\ne_{w}(n_{w}) = \\frac{\\alpha_{w}}{n_{w}}, \\quad e_{b}(n_{b}) = \\frac{\\alpha_{b}}{n_{b}}.\n$$\n因此，期望风险变为\n$$\nR(n_{w}, n_{b}) = p_{w} C_{w} \\frac{\\alpha_{w}}{n_{w}} + p_{b} C_{b} \\frac{\\alpha_{b}}{n_{b}}.\n$$\n\n标注预算约束为\n$$\nk_{w} n_{w} + k_{b} n_{b} = B.\n$$\n\n我们寻求在此等式约束下最小化 $R(n_{w}, n_{b})$。这是一个凸优化问题，因为每一项 $p_{i} C_{i} \\alpha_{i}/n_{i}$ 对于 $n_{i} > 0$ 都是凸的，且约束是线性的。拉格朗日乘数法给出了最优性的必要和充分条件。\n\n构建拉格朗日函数\n$$\n\\mathcal{L}(n_{w}, n_{b}, \\lambda) = p_{w} C_{w} \\frac{\\alpha_{w}}{n_{w}} + p_{b} C_{b} \\frac{\\alpha_{b}}{n_{b}} + \\lambda \\left( k_{w} n_{w} + k_{b} n_{b} - B \\right).\n$$\n\n对 $n_{w}$ 和 $n_{b}$ 求偏导数，并在内部最优解处将其设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial n_{w}} = - p_{w} C_{w} \\frac{\\alpha_{w}}{n_{w}^{2}} + \\lambda k_{w} = 0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial n_{b}} = - p_{b} C_{b} \\frac{\\alpha_{b}}{n_{b}^{2}} + \\lambda k_{b} = 0.\n$$\n\n对每个方程求解 $\\lambda$ 可得\n$$\n\\lambda = \\frac{p_{w} C_{w} \\alpha_{w}}{k_{w} n_{w}^{2}} = \\frac{p_{b} C_{b} \\alpha_{b}}{k_{b} n_{b}^{2}}.\n$$\n\n令两个表达式相等，得到 $n_{w}$ 和 $n_{b}$ 之间的关系：\n$$\n\\frac{p_{w} C_{w} \\alpha_{w}}{k_{w} n_{w}^{2}} = \\frac{p_{b} C_{b} \\alpha_{b}}{k_{b} n_{b}^{2}}.\n$$\n\n重新整理以分离出比率 $n_{w}/n_{b}$：\n$$\n\\frac{n_{w}^{2}}{n_{b}^{2}} = \\frac{p_{w} C_{w} \\alpha_{w} k_{b}}{p_{b} C_{b} \\alpha_{b} k_{w}} \\quad \\Longrightarrow \\quad \\frac{n_{w}}{n_{b}} = \\sqrt{ \\frac{p_{w} C_{w} \\alpha_{w} k_{b}}{p_{b} C_{b} \\alpha_{b} k_{w}} }.\n$$\n\n这个表达式是最佳抽样比，它平衡了两个类别之间单位标注工作量所带来的期望错分成本的边际减少量。它随着湿地发生率 $p_{w}$、湿地错分成本 $C_{w}$、湿地学习曲线系数 $\\alpha_{w}$ 和背景样本成本 $k_{b}$ 的增加而增加；随着背景发生率 $p_{b}$、背景错分成本 $C_{b}$、背景学习曲线系数 $\\alpha_{b}$ 和湿地样本成本 $k_{w}$ 的增加而减少。预算 $B$ 决定了绝对样本量，但在比率中被消去，因此只要具有 $n_{w}, n_{b} > 0$ 的内部解是可行的，该比率就不受总预算的影响。\n\n因此，在给定假设下，最优的成本敏感抽样计划根据上面推导出的闭式比率，在湿地和背景之间分配训练标签。",
            "answer": "$$\\boxed{\\sqrt{\\frac{p_{w} C_{w} \\alpha_{w} k_{b}}{p_{b} C_{b} \\alpha_{b} k_{w}}}}$$"
        }
    ]
}