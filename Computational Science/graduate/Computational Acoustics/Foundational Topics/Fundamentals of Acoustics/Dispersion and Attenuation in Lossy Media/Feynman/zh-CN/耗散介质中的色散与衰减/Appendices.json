{
    "hands_on_practices": [
        {
            "introduction": "当声波在空气等流体中传播时，其能量会逐渐耗散，这一现象称为衰减。本练习将引导你从流体动力学的第一性原理出发，推导经典声衰减理论，并定量分析黏滞效应（内摩擦）和热传导这两种主要的物理机制对总衰减的贡献。通过这个实践，你将深入理解宏观衰减现象背后的物理来源。",
            "id": "4120336",
            "problem": "考虑一个角频率为 $\\omega$ 的平面、一维、时谐声波，在标准条件下的静止空气中传播。将空气模拟为牛顿理想气体，其剪切黏度为 $\\eta$，体积黏度为 $\\zeta$，热导率为 $k$，定压比热为 $c_p$，比热比为 $\\gamma$，环境质量密度为 $\\rho_0$。假设在小振幅极限下为线性声学，并忽略分子弛豫过程，因此耗散仅由进入线性化可压缩 Navier–Stokes 方程和包含 Fourier 热传导定律的线性化能量方程的剪切黏度和热传导引起。\n\n从线性化连续性方程、包含黏性应力的线性化动量方程、线性化能量方程以及理想气体状态方程出发，推导平面波的耗散小量的一阶色散关系，并从中确定由剪切黏度和热传导引起的衰减贡献。使用空气在 $T_0 = 293.15\\,\\mathrm{K}$ 时的材料参数：\n- $\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$,\n- $\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$,\n- $\\zeta = 0\\,\\mathrm{Pa\\cdot s}$,\n- $k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$,\n- $c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$,\n- $\\gamma = 1.4$,\n\n以及频率 $f = 10\\,\\mathrm{kHz}$ (其中 $\\omega = 2\\pi f$)，计算剪切黏度和热传导对衰减的相对贡献，定义为无量纲分数\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n\\quad\\text{和}\\quad\n\\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}},\n$$\n其中 $\\alpha_{\\mathrm{shear}}$ 和 $\\alpha_{\\mathrm{thermal}}$ 分别表示您推导的耗散小量一阶色散关系中可归因于剪切黏度和热传导的衰减贡献。使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，将最终答案表示为包含两个无量纲数的单行矩阵，并将每个数字四舍五入到四位有效数字。",
            "solution": "该问题要求推导在黏性导热气体中声波的耗散小量的一阶色散关系，并随后计算剪切黏度和热传导对波衰减的相对贡献。\n\n分析始于流体运动的线性化控制方程，即质量守恒（连续性）、动量守恒（Navier-Stokes）和能量守恒，并辅以理想气体状态方程。对于沿 $x$ 方向传播的一维平面波，这些方程是：\n\n1. **线性化连续性方程**：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n\n2. **线性化动量方程**：\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} = -\\frac{\\partial p'}{\\partial x} + \\left(\\zeta + \\frac{4}{3}\\eta\\right) \\frac{\\partial^2 u'}{\\partial x^2}\n$$\n\n3. **线性化能量方程**：\n$$\n\\rho_0 c_p \\frac{\\partial T'}{\\partial t} - \\frac{\\partial p'}{\\partial t} = k \\frac{\\partial^2 T'}{\\partial x^2}\n$$\n\n4. **线性化理想气体状态方程**：\n$$\n\\frac{p'}{p_0} = \\frac{\\rho'}{\\rho_0} + \\frac{T'}{T_0}\n$$\n\n此处，$\\rho'$, $p'$, $u'$ 和 $T'$ 分别是密度、压力、速度和温度的声学小扰动。环境量为密度 $\\rho_0$、压力 $p_0$ 和温度 $T_0$。材料属性为剪切黏度 $\\eta$、体积黏度 $\\zeta$、热导率 $k$、定压比热 $c_p$ 和比热比 $\\gamma$。\n\n我们假设时谐平面波解的形式为 $q'(x,t) = \\hat{q} \\exp(i(Kx - \\omega t))$，其中 $q'$ 代表任何扰动场变量，$\\hat{q}$ 是其复振幅，$\\omega$ 是角频率，而 $K$ 是复波数。导数变换为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\frac{\\partial}{\\partial x} \\to iK$。将此应用于控制方程，得到一个关于振幅的代数方程组：\n\n1. (连续性) $-i\\omega \\hat{\\rho} + \\rho_0 (iK) \\hat{u} = 0 \\implies \\omega \\hat{\\rho} = \\rho_0 K \\hat{u}$\n2. (动量) $\\rho_0(-i\\omega)\\hat{u} = -iK\\hat{p} + (\\zeta + \\frac{4}{3}\\eta)(iK)^2\\hat{u} \\implies \\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{u} = K\\hat{p}$\n3. (能量) $\\rho_0 c_p(-i\\omega)\\hat{T} - (-i\\omega)\\hat{p} = k(iK)^2\\hat{T} \\implies \\omega\\hat{p} = (\\omega\\rho_0 c_p + ik^2 k)\\hat{T}$\n4. (状态) $\\frac{\\hat{p}}{p_0} = \\frac{\\hat{\\rho}}{\\rho_0} + \\frac{\\hat{T}}{T_0}$\n\n由前两个方程，我们可以建立 $\\hat{p}$ 和 $\\hat{\\rho}$ 之间的关系：\n由(1)式，$\\hat{u} = \\frac{\\omega}{\\rho_0 K}\\hat{\\rho}$。将其代入(2)式：\n$$\n\\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\left(\\frac{\\omega}{\\rho_0 K}\\hat{\\rho}\\right) = K\\hat{p}\n$$\n$$\n\\implies \\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{\\rho} = K^2\\hat{p} \\quad (\\text{A式})\n$$\n由第三和第四个方程，我们推导出 $\\hat{p}$ 和 $\\hat{\\rho}$ 之间的第二个关系：\n由(3)式，$\\hat{T} = \\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}$。将其代入(4)式：\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0} - \\frac{\\hat{T}}{T_0} = \\frac{\\hat{p}}{p_0} - \\frac{1}{T_0}\\left(\\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}\\right)\n$$\n使用理想气体关系式 $p_0 = \\rho_0 R T_0$、$c_0^2 = \\gamma R T_0 = \\gamma p_0/\\rho_0$ 和 $R=c_p-c_v=c_p(1-1/\\gamma)$，我们可以写出 $\\frac{1}{T_0} = \\frac{\\rho_0 R}{p_0} = \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma p_0}$。\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0}\\left[ 1 - \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma} \\frac{\\omega}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{\\hat{p}}{\\gamma p_0}\\left[ \\gamma - \\frac{\\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right]\n$$\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} = \\frac{1}{c_0^2} \\left[ \\frac{\\gamma(\\omega\\rho_0 c_p + iK^2 k) - \\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{1}{c_0^2}\\left[ \\frac{\\omega\\rho_0 c_p + i\\gamma K^2 k}{\\omega\\rho_0 c_p + iK^2 k} \\right] \\quad (\\text{B式})\n$$\n结合(A)式和(B)式，得到精确的色散关系。对于小耗散（$\\eta, k, \\zeta$ 很小），波数 $K$ 接近理想值 $k_0 = \\omega/c_0$。我们在小的耗散项中近似取 $K^2 \\approx k_0^2 = \\omega^2/c_0^2$。\n从(B)式出发，对小 $k$ 进行展开：\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i\\gamma K^2 k}{\\omega\\rho_0 c_p}\\right)\\left(1 - \\frac{iK^2 k}{\\omega\\rho_0 c_p}\\right)^{-1} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right)\n$$\n将此代入(A)式：\n$$\n\\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right] \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right) = K^2\n$$\n$$\n\\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega K^2}{\\omega^2 \\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p} \\right] \\approx K^2\n$$\n求解 $K^2$ 并在右侧近似取 $K^2 \\approx \\omega^2/c_0^2$：\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 - \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]^{-1}\n$$\n对于小的 $x$，使用二项式展开 $(1-x)^{-1} \\approx 1+x$：\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\n取平方根，并对小的 $y$ 使用 $(1+y)^{1/2} \\approx 1+y/2$：\n$$\nK \\approx \\frac{\\omega}{c_0} \\left[ 1 + \\frac{i\\omega}{2\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\n这就是所求的耗散小量的一阶色散关系。复波数为 $K = k_r + i\\alpha$，其中 $k_r$ 是实波数，$\\alpha$ 是衰减系数。波的传播形式为 $\\exp(i(k_r x-\\omega t) - \\alpha x)$。\n$$\nk_r = \\mathrm{Re}(K) \\approx \\frac{\\omega}{c_0}\n$$\n$$\n\\alpha = \\mathrm{Im}(K) \\approx \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right)\n$$\n问题指明耗散源于剪切黏度和热传导，并给定 $\\zeta=0$。总衰减 $\\alpha$ 是剪切黏度贡献 $\\alpha_{\\mathrm{shear}}$ 和热传导贡献 $\\alpha_{\\mathrm{thermal}}$ 的和：\n$$\n\\alpha_{\\mathrm{shear}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{4}{3}\\eta\\right)\n$$\n$$\n\\alpha_{\\mathrm{thermal}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{(\\gamma-1)k}{c_p}\\right)\n$$\n相对贡献定义为：\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}} \\quad\\text{和}\\quad \\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n$$\n公共因子 $\\frac{\\omega^2}{2\\rho_0 c_0^3}$ 在这些比率中被消去。我们只需要比较 $S = \\frac{4}{3}\\eta$ 和 $T = \\frac{(\\gamma-1)k}{c_p}$ 这两项。\n$$\n\\phi_{\\mathrm{shear}} = \\frac{S}{S+T} \\quad\\text{和}\\quad \\phi_{\\mathrm{thermal}} = \\frac{T}{S+T}\n$$\n使用提供的空气材料参数：\n$\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n$k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$\n$c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$\n$\\gamma = 1.4$\n$\\zeta = 0$\n\n我们计算 $S$ 和 $T$ 两项：\n$$\nS = \\frac{4}{3}\\eta = \\frac{4}{3}(1.81 \\times 10^{-5}) \\approx 2.41333 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\n$$\nT = \\frac{(\\gamma-1)k}{c_p} = \\frac{(1.4 - 1)(2.57 \\times 10^{-2})}{1.006 \\times 10^{3}} = \\frac{0.4 \\times 2.57 \\times 10^{-2}}{1006} \\approx 1.02187 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\n总和为 $S+T \\approx (2.41333 + 1.02187) \\times 10^{-5} = 3.43520 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}$。\n\n现在我们计算无量纲分数：\n$$\n\\phi_{\\mathrm{shear}} = \\frac{2.41333 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.702529\n$$\n$$\n\\phi_{\\mathrm{thermal}} = \\frac{1.02187 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.297471\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\phi_{\\mathrm{shear}} = 0.7025\n$$\n$$\n\\phi_{\\mathrm{thermal}} = 0.2975\n$$\n这些值代表了在指定条件下，剪切黏度和热传导对空气中声音的总经典衰减的分数贡献。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7025  0.2975\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在上一个练习中建立的经典衰减模型对于理想气体是相当成功的，但它在更复杂的液体中表现如何？本练习要求你将同样的Stokes-Kirchhoff理论应用于高黏滞性液体——甘油。你的任务是计算理论预测的衰减值，并与已发表的实验数据进行比较，从而揭示理论模型的局限性，并体会到在真实材料中，诸如结构弛豫等更复杂的物理过程的重要性。",
            "id": "4120329",
            "problem": "在有损介质的计算声学中，衰减和色散源于与黏度和热传导相关的不可逆过程。考虑平面波在无界、均匀的牛顿流体（$25\\,\\mathrm{^\\circ C}$下的甘油）中传播，其参数如下\n$ \\rho = 1260\\,\\mathrm{kg\\,m^{-3}}$，$ \\eta = 1.49\\,\\mathrm{Pa\\,s}$，$ \\kappa = 0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$ c_p = 2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$ \\gamma = 1.055$，以及绝热声速 $ c = 1900\\,\\mathrm{m\\,s^{-1}}$。假设体积黏度可忽略不计（即，将体积黏度设为零），并忽略除剪切黏度和热传导之外的内部弛豫机制。一篇文献报道，在相似的热力学条件下，甘油在 $f = 1\\,\\mathrm{MHz}$ 时的衰减系数为 $ \\alpha_{\\mathrm{lit}} = 25\\,\\mathrm{Np\\,m^{-1}}$。\n\n从质量、动量和能量的线性化守恒定律出发，结合适用于牛顿流体中小振幅声学的热力学闭合关系以及平面波拟设，推导由剪切黏度和热传导引起的平面波衰减系数 $ \\alpha(\\omega) $ 的领头阶（小损耗）表达式。然后，使用上述参数计算在 $ f = 1\\,\\mathrm{MHz} $ 时的预测衰减系数 $ \\alpha(\\omega) $，并计算无量纲比值\n$$ R = \\frac{\\alpha_{\\mathrm{pred}}}{\\alpha_{\\mathrm{lit}}}. $$\n将 $ R $ 四舍五入到四位有效数字。最终答案以无单位的纯数表示。对于 $ \\alpha(\\omega) $ 的中间数值计算，衰减单位使用奈培/米。角频率为 $ \\omega = 2\\pi f $，小损耗极限定义为 $ \\alpha \\ll \\omega/c $，因此 $ k \\approx \\omega/c + i\\,\\alpha $ 成立。",
            "solution": "该问题要求推导有损流体中平面波衰减系数 $\\alpha(\\omega)$ 的领头阶表达式，然后对指定频率下的甘油进行数值计算，并与文献值进行比较。\n\n推导始于线性化的流体动力学方程：质量守恒（连续性）方程、动量守恒（Navier-Stokes）方程和能量守恒方程，并辅以牛顿流体的热力学状态方程。对于形式为 $\\exp(i(\\tilde{k}x - \\omega t))$ 的平面波，其中 $\\tilde{k}$ 是复波数，$\\omega$ 是角频率，这些方程可以组合起来，得到关于 $\\omega$ 和流体性质的 $\\tilde{k}$ 的色散关系。\n\n完整的推导过程很长，但复波数平方 $\\tilde{k}^2$ 的标准结果由下式给出：\n$$ \\tilde{k}^2 = \\frac{\\omega^2}{c^2} \\left[ 1 + i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right]^{-1} $$\n其中 $c$ 是绝热声速，$\\rho$ 是密度，$\\eta$ 是剪切黏度，$\\eta_B$ 是体积黏度，$\\gamma$ 是比热比，$\\kappa$ 是热导率， $c_p$ 是定压比热。\n\n问题指定了小损耗极限，这意味着分母中的虚部项远小于 $1$。因此，对于小的 $x$，我们可以使用二项式近似 $(1+x)^{-1} \\approx 1-x$。令\n$$ x = i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) $$\n应用此近似可得：\n$$ \\tilde{k}^2 \\approx \\frac{\\omega^2}{c^2} \\left[ 1 - i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right] $$\n为了求 $\\tilde{k}$，我们取平方根：\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} \\left[ 1 - i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right]^{1/2} $$\n再次使用二项式近似，对于小的 $y$，有 $(1-y)^{1/2} \\approx 1 - \\frac{1}{2}y$：\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} \\left[ 1 - \\frac{i \\omega}{2} \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right] $$\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} - i \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\eta_B + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n沿 x 正方向传播的平面波由压力场 $p(x,t) \\propto \\exp(i(\\tilde{k}x - \\omega t))$ 描述。我们将复波数表示为 $\\tilde{k} = k_r + i\\alpha$，因此 $p(x,t) \\propto \\exp(i(k_r x - \\omega t)) \\exp(-\\alpha x)$，其中 $\\alpha$ 是衰减系数。通过将此形式与我们推导的 $\\tilde{k}$ 表达式进行比较，我们确定衰减系数 $\\alpha$ 是 $\\tilde{k}$ 虚部的相反数。\n$$ \\alpha(\\omega) = \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\eta_B + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n问题要求假设体积黏度可忽略不计，因此我们设 $\\eta_B=0$。得到的领头阶表达式是经典的（Stokes-Kirchhoff）衰减系数：\n$$ \\alpha(\\omega) = \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n现在，我们使用给定的甘油参数来计算该表达式的值。\n已知参数为：\n$f = 1\\,\\mathrm{MHz} = 1 \\times 10^6\\,\\mathrm{Hz}$\n$\\rho = 1260\\,\\mathrm{kg\\,m^{-3}}$\n$\\eta = 1.49\\,\\mathrm{Pa\\,s}$\n$\\kappa = 0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$c_p = 2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$\\gamma = 1.055$\n$c = 1900\\,\\mathrm{m\\,s^{-1}}$\n$\\alpha_{\\mathrm{lit}} = 25\\,\\mathrm{Np\\,m^{-1}}$\n\n首先，计算角频率 $\\omega$：\n$$ \\omega = 2\\pi f = 2\\pi (1 \\times 10^6 \\,\\mathrm{s^{-1}}) = 2\\pi \\times 10^6 \\,\\mathrm{rad\\,s^{-1}} $$\n接下来，我们计算括号内的项，这些项代表了剪切黏度和热传导的贡献。\n黏性贡献：\n$$ \\frac{4}{3}\\eta = \\frac{4}{3}(1.49\\,\\mathrm{Pa\\,s}) \\approx 1.98667\\,\\mathrm{Pa\\,s} $$\n热贡献：\n$$ \\frac{(\\gamma-1)\\kappa}{c_p} = \\frac{(1.055 - 1)(0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})}{2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}} = \\frac{0.055 \\times 0.285}{2410}\\,\\mathrm{Pa\\,s} \\approx 6.504 \\times 10^{-6}\\,\\mathrm{Pa\\,s} $$\n总的等效黏度项是这两者之和：\n$$ \\delta = \\left( \\frac{4}{3}\\eta + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) \\approx 1.98667\\,\\mathrm{Pa\\,s} + 6.504 \\times 10^{-6}\\,\\mathrm{Pa\\,s} \\approx 1.986677\\,\\mathrm{Pa\\,s} $$\n显然，在这些条件下，对于甘油而言，热贡献与黏性贡献相比可以忽略不计。\n\n现在，我们计算预测的衰减系数 $\\alpha_{\\mathrm{pred}}$：\n$$ \\alpha_{\\mathrm{pred}} = \\frac{(2\\pi \\times 10^6\\,\\mathrm{s^{-1}})^2}{2(1260\\,\\mathrm{kg\\,m^{-3}})(1900\\,\\mathrm{m\\,s^{-1}})^3} \\left( 1.986677\\,\\mathrm{Pa\\,s} \\right) $$\n$$ \\alpha_{\\mathrm{pred}} = \\frac{4\\pi^2 \\times 10^{12}}{2(1260)(6.859 \\times 10^9)} (1.986677)\\,\\mathrm{m^{-1}} $$\n$$ \\alpha_{\\mathrm{pred}} = \\frac{4\\pi^2 \\times 10^{12}}{1.728468 \\times 10^{13}} (1.986677)\\,\\mathrm{m^{-1}} $$\n$$ \\alpha_{\\mathrm{pred}} \\approx (2.28402\\,\\mathrm{m\\,J^{-1}}) (1.986677\\,\\mathrm{Pa\\,s}) \\approx 4.53802\\,\\mathrm{Np\\,m^{-1}} $$\n单位 $\\mathrm{m\\,J^{-1}} \\times \\mathrm{Pa\\,s} = \\mathrm{m\\,(N\\,m)^{-1}} \\times \\mathrm{N\\,s\\,m^{-2}} \\times \\mathrm{s} = \\mathrm{m^{-1}}$，这与衰减系数以奈培/米为单位的预期相符。\n\n最后，我们计算无量纲比值 $R$：\n$$ R = \\frac{\\alpha_{\\mathrm{pred}}}{\\alpha_{\\mathrm{lit}}} = \\frac{4.53802\\,\\mathrm{Np\\,m^{-1}}}{25\\,\\mathrm{Np\\,m^{-1}}} \\approx 0.1815208 $$\n四舍五入到四位有效数字，我们得到：\n$$ R \\approx 0.1815 $$\n预测值与文献值之间的显著差异（$R \\ll 1$）对于像甘油这样的缔合液体是众所周知的，这归因于经典Stokes-Kirchhoff理论未考虑的弛豫过程（例如，结构弛豫），以及体积黏度为零的简化假设（这对甘油来说并不准确）。然而，本问题要求仅基于所提供的模型和参数进行计算。",
            "answer": "$$\n\\boxed{0.1815}\n$$"
        },
        {
            "introduction": "将物理模型转化为可靠的计算机模拟是计算声学的重要一环。一个物理上正确的模型，如果数值实现不当，也可能产生完全错误的结果。本练习将带你探究一个常见的陷阱：数值格式本身可能导致能量的非物理增长（非无源性），从而使模拟结果发散。通过对比显式和隐式时间积分方法的稳定性，你将掌握为耗散系统选择和实现稳定数值算法的关键技能。",
            "id": "4120334",
            "problem": "考虑在均匀有损流体中的一维小振幅单色平面声波，其在固定空间位置由标量振幅包络 $A(t)$ 建模。该包络受有效衰减率的控制，而此衰减率依赖于角频率 $\\omega$。假设介质的衰减遵循类热粘性定律 $\\alpha(\\omega) = a_0 + a_2 \\,\\omega^2$，其中 $a_0$ 和 $a_2$ 为实常数，且 $\\omega \\ge 0$。振幅的连续时间演化由以下一阶线性常微分方程描述\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t).\n$$\n该方程与线性声学和能量耗散相符：无源介质对于所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$，从而确保振幅不增加。\n\n您的任务是诊断一个非无源数值时间积分模型，该模型在朴素离散化后会在某些频率上表现出增益（振幅增长）。您需要确定这种违背是由于非物理的参数选择还是由于不稳定的离散化，并修正该格式以恢复其稳定性和无源性。具体来说：\n\n- 仅从上述连续时间模型和基本原理出发，推导以下方法的离散时间放大因子：\n  - 时间步长为 $\\Delta t$ 的一阶显式前向欧拉时间步进法。\n  - 时间步长同样为 $\\Delta t$ 的梯形法则（Crank–Nicolson）时间步进法。\n- 基于推导出的放大因子和无源性的定义，给出显式方法变为非无源（即在某些 $\\omega$ 处出现 $|r(\\omega)| > 1$）的条件，并证明只要介质是无源的（即对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$），梯形法则对于任何 $\\Delta t$ 都是无源的。\n\n为了进行计算诊断，请实现一个程序，该程序：\n- 在 $[0,\\omega_{\\max}]$ 上构建一个包含 $N_\\omega$ 个点的均匀频率网格 $\\{\\omega_k\\}_{k=0}^{N_\\omega-1}$。\n- 对每个测试用例，计算显式前向欧拉法和梯形法则的 $\\alpha(\\omega_k)$ 和离散放大因子 $r(\\omega_k)$。\n- 使用以下分类代码诊断显式方法非无源性的原因：\n  - 代码 $0$：未检测到违背；对所有 $k$ 都有 $|r(\\omega_k)| \\le 1$ 且对所有 $k$ 都有 $\\alpha(\\omega_k) \\ge 0$。\n  - 代码 $1$：违背是由于时间步过大，而参数在物理上是可接受的；即，对所有 $k$ 都有 $\\alpha(\\omega_k) \\ge 0$，但存在某个 $k$ 使得 $|r(\\omega_k)| > 1$。\n  - 代码 $2$：违背是由于非物理衰减（在某个频率上 $\\alpha(\\omega)$ 为负）；即，存在某个 $k$ 使得 $\\alpha(\\omega_k)  0$（与时间步无关）。\n- 通过报告是否对所有 $k$ 都有 $|r(\\omega_k)| \\le 1$ 来测试修正后的梯形法则的无源性。\n\n使用以下测试套件来确保覆盖不同场景。在每种情况下，使用在 $[0,\\omega_{\\max}]$ 上包含 $N_\\omega = 1025$ 个点的均匀网格，并报告在整个网格上汇总的结果：\n- 案例 $1$（常规成功路径）：$a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = 0.01$, $\\omega_{\\max} = 10^4$。\n- 案例 $2$（边界条件）：$a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = \\dfrac{2}{a_0 + a_2 \\,\\omega_{\\max}^2}$, $\\omega_{\\max} = 10^4$。\n- 案例 $3$（时间步引起的非无源性）：$a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = 0.05$, $\\omega_{\\max} = 10^4$。\n- 案例 $4$（参数引起的非无源性）：$a_0 = 0.2$, $a_2 = -10^{-6}$, $\\Delta t = 0.01$, $\\omega_{\\max} = 10^4$。\n\n为本练习之目的，所有量均为无量纲量，角频率 $\\omega$ 的单位是弧度/单位时间。无源性检查使用准则 $|r(\\omega_k)| \\le 1$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每个案例，输出显式方法的违背代码，后跟一个布尔值，指示梯形方法是否对所有频率都是无源的。因此，最终输出应总共有 $8$ 个条目，对应 $4$ 个案例，顺序如下：\n$$\n[\\text{code}_1,\\text{passive}_1,\\text{code}_2,\\text{passive}_2,\\text{code}_3,\\text{passive}_3,\\text{code}_4,\\text{passive}_4].\n$$",
            "solution": "该问题要求分析应用于控制有损介质中声振幅衰减的常微分方程的两种时间积分格式的数值稳定性和无源性。控制方程为：\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t)\n$$\n其中 $A(t)$ 是固定空间位置的标量振幅包络，$\\omega$ 是角频率，$\\alpha(\\omega)$ 是频率相关的衰减率。如果对于所有物理频率 $\\omega \\ge 0$，都有 $\\alpha(\\omega) \\ge 0$，则该介质被定义为无源的。如果只要物理介质是无源的，其离散放大因子 $r(\\omega)$ 的模 $|r(\\omega)| \\le 1$ 就成立，那么该数值方法被认为是无源的。违背无源性（即 $|r(\\omega)| > 1$）会导致非物理的振幅增长。我们将推导前向欧拉法和梯形法则的放大因子，并建立无源性条件。\n\n令 $A_n \\approx A(t_n)$ 为离散时间 $t_n = n \\Delta t$ 处振幅的数值近似，其中 $\\Delta t$ 是时间步长。从一个时间步到下一个时间步的演化由 $A_{n+1} = r(\\omega) A_n$ 描述，其中 $r(\\omega)$ 是数值放大因子。\n\n**1. 显式前向欧拉法**\n\n一阶显式前向欧拉法将时间导数近似为前向差分：\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) A_n\n$$\n求解 $A_{n+1}$ 可得到更新规则：\n$$\nA_{n+1} = A_n - \\alpha(\\omega) \\Delta t \\, A_n = (1 - \\alpha(\\omega) \\Delta t) A_n\n$$\n由此，我们确定前向欧拉法的放大因子 $r_{FE}(\\omega)$ 为：\n$$\nr_{FE}(\\omega) = 1 - \\alpha(\\omega) \\Delta t\n$$\n为使数值格式是无源的（即非放大的），放大因子的模不得超过 $1$：\n$$\n|r_{FE}(\\omega)| \\le 1 \\implies |1 - \\alpha(\\omega) \\Delta t| \\le 1\n$$\n该不等式等价于以下两个条件：\n$$\n-1 \\le 1 - \\alpha(\\omega) \\Delta t \\le 1\n$$\n让我们分别分析每个不等式。\n首先，$1 - \\alpha(\\omega) \\Delta t \\le 1$ 意味着 $-\\alpha(\\omega) \\Delta t \\le 0$。由于 $\\Delta t  0$，这等价于 $\\alpha(\\omega) \\ge 0$。这个条件对应于介质本身的物理无源性。如果介质不是无源的（$\\alpha(\\omega)  0$），数值方法也会如预期那样表现出增益。\n\n其次，$-1 \\le 1 - \\alpha(\\omega) \\Delta t$ 意味着 $\\alpha(\\omega) \\Delta t \\le 2$。\n\n综合这些，前向欧拉法是稳定且无源的，当且仅当：\n$$\n0 \\le \\alpha(\\omega) \\Delta t \\le 2\n$$\n因此，违背无源性（$|r_{FE}(\\omega)| > 1$）可能由两个不同的原因引起：\n- **非物理参数：** 介质本身是有源的，意味着对某些 $\\omega$ 有 $\\alpha(\\omega)  0$。这违背了稳定性条件的第一部分。这对应于 **代码 2** 违背。\n- **数值不稳定性：** 介质是无源的（对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$），但时间步长 $\\Delta t$ 过大，导致对某些 $\\omega$ 有 $\\alpha(\\omega) \\Delta t > 2$。这纯粹是数值计算的产物。这对应于 **代码 1** 违背。\n如果网格上的任何频率都不满足这两个条件，则未检测到违背，对应于 **代码 0**。\n\n**2. 梯形法则（Crank-Nicolson 法）**\n\n梯形法是一种隐式方法，它通过对时间步 $n$ 和 $n+1$ 处的值取平均来近似常微分方程的右侧：\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) \\frac{A_n + A_{n+1}}{2}\n$$\n为了找到放大因子，我们必须求解 $A_{n+1}$：\n$$\nA_{n+1} - A_n = -\\frac{\\alpha(\\omega) \\Delta t}{2} (A_n + A_{n+1})\n$$\n$$\nA_{n+1} \\left(1 + \\frac{\\alpha(\\omega) \\Delta t}{2}\\right) = A_n \\left(1 - \\frac{\\alpha(\\omega) \\Delta t}{2}\\right)\n$$\n$$\nA_{n+1} = \\left( \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t} \\right) A_n\n$$\n因此，梯形法则的放大因子 $r_{CN}(\\omega)$ 为：\n$$\nr_{CN}(\\omega) = \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t}\n$$\n现在，我们分析其无源性。我们假设一个物理上无源的介质，因此对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$。令 $x = \\frac{1}{2}\\alpha(\\omega) \\Delta t$。由于 $\\alpha(\\omega) \\ge 0$ 且 $\\Delta t > 0$，我们有 $x \\ge 0$。放大因子为 $r(x) = \\frac{1-x}{1+x}$。我们必须证明对于所有 $x \\ge 0$，都有 $|r(x)| \\le 1$。\n其模为：\n$$\n|r(x)| = \\left| \\frac{1-x}{1+x} \\right| = \\frac{|1-x|}{1+x}\n$$\n因为 $x \\ge 0$ 意味着 $1+x > 0$。\n- 如果 $0 \\le x \\le 1$，则 $|1-x| = 1-x$。不等式 $|r(x)| \\le 1$ 变为 $\\frac{1-x}{1+x} \\le 1$。因为 $1+x > 0$，这等价于 $1-x \\le 1+x$，化简为 $-x \\le x$，或 $0 \\le 2x$。这对所有 $x \\ge 0$ 都成立。\n- 如果 $x > 1$，则 $|1-x| = -(1-x) = x-1$。不等式 $|r(x)| \\le 1$ 变为 $\\frac{x-1}{x+1} \\le 1$。这等价于 $x-1 \\le x+1$，化简为 $-1 \\le 1$。这永远成立。\n\n因此，对于任何 $x \\ge 0$，我们都有 $|r(x)| \\le 1$。这证明了如果介质是无源的（$\\alpha(\\omega) \\ge 0$），梯形法则对于任何时间步长 $\\Delta t > 0$ 的选择都是无条件无源的。这个属性被称为A-稳定性。然而，如果介质本身不是无源的（即对某些 $\\omega$ 有 $\\alpha(\\omega)  0$），量 $x$ 可能是负的。如果 $x  0$，令 $x = -y$ 且 $y > 0$。那么 $r(-y) = \\frac{1+y}{1-y}$。如果 $0  y  1$，则 $|r(-y)| > 1$，这意味着梯形格式也会表现出增益，正确地反映了底层（非物理）模型的有源性质。\n\n计算实现将遵循此推导逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing numerical schemes for acoustic attenuation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a2, dt, omega_max)\n    # Case 2's dt is calculated dynamically.\n    omega_max_val = 1e4\n    a0_case2, a2_case2 = 0.5, 1e-6\n    dt_case2 = 2.0 / (a0_case2 + a2_case2 * omega_max_val**2)\n\n    test_cases = [\n        # Case 1 (general happy path)\n        (0.5, 1e-6, 0.01, omega_max_val),\n        # Case 2 (boundary condition)\n        (a0_case2, a2_case2, dt_case2, omega_max_val),\n        # Case 3 (time-step induced non-passivity)\n        (0.5, 1e-6, 0.05, omega_max_val),\n        # Case 4 (parameter-induced non-passivity)\n        (0.2, -1e-6, 0.01, omega_max_val),\n    ]\n\n    # Global parameters for the frequency grid\n    N_omega = 1025\n\n    results = []\n    for case in test_cases:\n        a0, a2, dt, omega_max = case\n\n        # 1. Construct the frequency grid and evaluate attenuation\n        omega_k = np.linspace(0, omega_max, N_omega)\n        alpha_k = a0 + a2 * omega_k**2\n\n        # 2. Diagnose the explicit forward Euler method\n        explicit_code = 0  # Default: No violation\n        if np.any(alpha_k  0):\n            # Violation due to unphysical attenuation\n            explicit_code = 2\n        else:\n            # Physical parameters, check for numerical instability\n            r_fe = 1.0 - alpha_k * dt\n            # Using a tolerance of 1e-12 for floating point comparisons\n            if np.any(np.abs(r_fe) > 1.0 + 1e-12):\n                explicit_code = 1\n        \n        results.append(explicit_code)\n\n        # 3. Test the passivity of the trapezoidal (Crank-Nicolson) method\n        # The denominator can be zero or close to zero if alpha_k is negative.\n        # We handle this to avoid division by zero errors, although for the given\n        # test cases it does not occur.\n        denominator = 1.0 + 0.5 * alpha_k * dt\n        # Set to a safe value if zero, although its amplification would be infinite.\n        denominator[denominator == 0] = 1e-16 \n        \n        r_cn = (1.0 - 0.5 * alpha_k * dt) / denominator\n        \n        # Check if the magnitude of the amplification factor is = 1 for all frequencies\n        is_cn_passive = np.all(np.abs(r_cn) = 1.0 + 1e-12)\n        results.append(is_cn_passive)\n\n    # 4. Final print statement in the exact required format.\n    # The boolean values are converted to string as 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}