{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。我们的第一个练习从最基本的声源——单极子——开始。通过从线性声学方程和亥姆霍兹算子的自由空间格林函数出发，严格推导一个紧凑点单极子的总辐射声功率，您将加深对声波产生和能量传播基本物理过程的理解。这项练习是分析更复杂声源的基础。",
            "id": "4115033",
            "problem": "考虑一个平衡密度为 $\\rho_{0}$、声速为 $c$ 的无界、均匀、无粘性流体。一个紧凑型时谐单极子声源位于原点，以角频率 $\\omega$ 和复体积速度幅值 $Q$ 注入流体，其物理场遵循约定 $p(\\mathbf{r}, t) = \\Re\\{\\tilde{p}(\\mathbf{r}) \\exp(- i \\omega t)\\}$ 和 $\\mathbf{u}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{u}}(\\mathbf{r}) \\exp(- i \\omega t)\\}$。假设声源区域是声学紧凑的，即 $ka \\ll 1$，其中 $k = \\omega / c$，$a$ 是声源的特征尺寸，并在自由空间中施加出射辐射条件。\n\n严格地从线性声学方程和亥姆霍兹算子的自由空间格林函数这两个基本点出发，推导该单极子在区域 $r \\gg a$ 内的远场主阶压力幅值 $\\tilde{p}(r)$ 和相应的径向质点速度幅值 $\\tilde{u}_{r}(r)$，仅保留以 $1/r$ 衰减的项，并舍弃电抗性近场项。基于这些结果，计算在半径 $r$ 处的时均声强 $I(r)$，其定义为 $I(r) = \\frac{1}{2} \\Re\\{\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)\\}$，然后将 $I(r)$ 在半径为 $r$ 的球面上积分，以求得总辐射声功率。\n\n仅用 $\\omega$、$\\rho_{0}$、$c$ 和 $|Q|$ 表示最终的总辐射声功率。请以单一的闭式解析表达式给出你的最终答案。以瓦特为单位表示总辐射功率。无需进行数值计算，也不应进行舍入。",
            "solution": "本题要求推导一个在均匀流体中的紧凑型时谐单极子声源所辐射的总声功率。推导过程必须从线性声学方程出发，并利用亥姆霍兹方程的自由空间格林函数。\n\n首先，我们建立声压的控制方程。对于平衡密度为 $\\rho_{0}$ 的无粘性、均匀流体，其线性化的质量和动量守恒方程为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{u} = q_{m}(\\mathbf{r}, t)\n$$\n$$\n\\rho_{0} \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p'\n$$\n其中 $\\rho'$ 和 $p'$ 分别是声密度和声压的扰动量，$\\mathbf{u}$ 是质点速度，$q_{m}$ 是单位体积的质量注入率。线性声学介质的状态方程将压力和密度扰动关联起来，即 $p' = c^2 \\rho'$，其中 $c$ 是声速。\n\n声源是位于原点 $\\mathbf{r}=\\mathbf{0}$ 的一个点单极子，以体积速度 $Q_{v}(t)$ 注入流体。这对应于一个质量源项 $q_{m}(\\mathbf{r}, t) = \\rho_{0} Q_{v}(t) \\delta(\\mathbf{r})$，其中 $\\delta(\\mathbf{r})$ 是狄拉克δ函数。时谐约定表示为 $f(t) = \\Re\\{\\tilde{f} \\exp(-i\\omega t)\\}$。将此应用于声源，得到 $Q_{v}(t) = \\Re\\{Q \\exp(-i\\omega t)\\}$。在此约定下，时间导数算子 $\\frac{\\partial}{\\partial t}$ 在频域中对应于乘以 $-i\\omega$。\n\n我们将线性化方程组结合起来，以形成关于压力 $p'$ 的单一波动方程。对质量守恒方程求时间导数，对动量方程求散度，可得：\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_{0} \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{u}}{\\partial t}\\right) = \\frac{\\partial q_{m}}{\\partial t}\n$$\n$$\n\\rho_{0} \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{u}}{\\partial t}\\right) = -\\nabla^2 p'\n$$\n将 $\\rho' = p'/c^2$ 和动量方程的散度代入经过时间微分的质量方程，得到非齐次波动方程：\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = \\frac{\\partial q_{m}}{\\partial t} = \\rho_{0} \\frac{d Q_{v}}{dt} \\delta(\\mathbf{r})\n$$\n对复压力幅值 $\\tilde{p}(\\mathbf{r})$ 进行频域变换：\n$$\n\\frac{1}{c^2} (-i\\omega)^2 \\tilde{p} - \\nabla^2 \\tilde{p} = \\rho_{0} (-i\\omega Q) \\delta(\\mathbf{r})\n$$\n$$\n-\\frac{\\omega^2}{c^2} \\tilde{p} - \\nabla^2 \\tilde{p} = -i\\omega \\rho_{0} Q \\delta(\\mathbf{r})\n$$\n整理后可得到非齐次亥姆霍兹方程：\n$$\n\\nabla^2 \\tilde{p}(\\mathbf{r}) + k^2 \\tilde{p}(\\mathbf{r}) = i\\omega \\rho_{0} Q \\delta(\\mathbf{r})\n$$\n其中 $k = \\omega/c$ 是声波数。\n\n题目指定使用亥姆霍兹算子的自由空间格林函数，该函数满足 $(\\nabla^2 + k^2)G(\\mathbf{r}|\\mathbf{r}') = -\\delta(\\mathbf{r}-\\mathbf{r}')$ 及出射辐射条件。该格林函数为：\n$$\nG(\\mathbf{r}|\\mathbf{r}') = \\frac{\\exp(ik|\\mathbf{r}-\\mathbf{r'}|)}{4\\pi|\\mathbf{r}-\\mathbf{r'}|}\n$$\n上述非齐次亥姆霍兹方程的解可以通过源项与格林函数的卷积得到。利用δ函数在 $\\mathbf{r}'=\\mathbf{0}$ 处的筛选性质，可得：\n$$\n\\tilde{p}(\\mathbf{r}) = i\\omega \\rho_{0} Q \\frac{\\exp(ik|\\mathbf{r}|)}{4\\pi|\\mathbf{r}|}\n$$\n令 $r = |\\mathbf{r}|$，球对称的压力场为：\n$$\n\\tilde{p}(r) = i\\omega \\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\n$$\n该表达式已经以 $1/r$ 的形式衰减，因此它代表了远场主阶压力。\n\n接下来，我们求解相应的径向质点速度幅值 $\\tilde{u}_{r}(r)$。根据频域中的线性化动量方程，$\\tilde{\\mathbf{u}} = \\frac{1}{-i\\omega\\rho_{0}}(-\\nabla \\tilde{p}) = \\frac{1}{i\\omega\\rho_{0}}\\nabla \\tilde{p}$。由于 $\\tilde{p}$ 仅是 $r$ 的函数，其梯度为 $\\nabla\\tilde{p} = \\frac{\\partial \\tilde{p}}{\\partial r} \\hat{\\mathbf{r}}$，因此径向速度为：\n$$\n\\tilde{u}_{r}(r) = \\frac{1}{i\\omega\\rho_{0}}\\frac{\\partial \\tilde{p}}{\\partial r} = \\frac{1}{i\\omega\\rho_{0}}\\frac{\\partial}{\\partial r}\\left(i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\\right) = Q \\frac{1}{4\\pi}\\frac{\\partial}{\\partial r}\\left(\\frac{\\exp(ikr)}{r}\\right)\n$$\n$$\n\\tilde{u}_{r}(r) = \\frac{Q}{4\\pi}\\left(\\frac{ik\\exp(ikr)}{r} - \\frac{\\exp(ikr)}{r^2}\\right) = -\\frac{Q\\exp(ikr)}{4\\pi r^2}(1-ikr)\n$$\n题目要求只保留以 $1/r$ 衰减的项。项 $\\frac{-Q\\exp(ikr)}{4\\pi r^2}$ 以 $1/r^2$ 衰减，代表近场电抗性速度。项 $ik\\frac{Q\\exp(ikr)}{4\\pi r}$ 以 $1/r$ 衰减，代表远场传播速度。因此，远场近似为：\n$$\n\\tilde{u}_{r}(r) \\approx ik\\frac{Q\\exp(ikr)}{4\\pi r} = \\frac{i\\omega}{c}\\frac{Q\\exp(ikr)}{4\\pi r}\n$$\n我们可以观察到，在远场中，$\\tilde{p}(r) = (\\rho_0 c) \\tilde{u}_r(r)$，这就是平面波阻抗关系。\n\n现在，我们计算时均声强 $I(r)$，其定义为 $I(r) = \\frac{1}{2} \\Re\\{\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)\\}$，其中 $*$ 表示复共轭。\n$$\n\\tilde{p}(r) = i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\n$$\n$$\n\\tilde{u}_{r}^{*}(r) \\approx \\left(ik\\frac{Q\\exp(ikr)}{4\\pi r}\\right)^{*} = -ik\\frac{Q^{*}\\exp(-ikr)}{4\\pi r}\n$$\n乘积 $\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)$ 为：\n$$\n\\tilde{p}(r) \\tilde{u}_{r}^{*}(r) \\approx \\left(i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\\right) \\left(-ik\\frac{Q^{*}\\exp(-ikr)}{4\\pi r}\\right) = (i)(-ik)(\\omega\\rho_{0}) \\frac{QQ^{*}}{(4\\pi r)^2} = k\\omega\\rho_{0} \\frac{|Q|^2}{16\\pi^2 r^2}\n$$\n这个乘积是纯实数，因此 $\\Re$ 算子是平凡的。代入 $k=\\omega/c$：\n$$\nI(r) = \\frac{1}{2}\\left(\\frac{\\omega}{c}\\omega\\rho_{0} \\frac{|Q|^2}{16\\pi^2 r^2}\\right) = \\frac{\\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c r^2}\n$$\n声强是纯径向的，并且在任何以原点为中心的球面上是均匀的。\n\n最后，我们通过将声强在半径为 $r$ 的球面上积分来计算总辐射声功率 $W$。面元为 $dS = r^2 \\sin\\theta d\\theta d\\phi$。\n$$\nW = \\oint_S I(r) dS = I(r) \\times (\\text{球的表面积}) = I(r) \\times (4\\pi r^2)\n$$\n$$\nW = \\left(\\frac{\\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c r^2}\\right) (4\\pi r^2)\n$$\n$r^2$ 项相互抵消，表明总功率与测量距离无关，这正是在无耗散介质中能量守恒的要求。\n$$\nW = \\frac{4\\pi \\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c} = \\frac{\\omega^2 \\rho_{0} |Q|^2}{8 \\pi c}\n$$\n这就是用给定参数表示的总辐射声功率的最终表达式。在国际单位制（SI）中，该量的单位是瓦特。",
            "answer": "$$\n\\boxed{\\frac{\\omega^{2} \\rho_{0} |Q|^{2}}{8 \\pi c}}\n$$"
        },
        {
            "introduction": "在理解了单极子之后，我们进一步构建更复杂的声源。许多实际声源，例如由非定常力产生的声，都表现出偶极子特性。这个练习将指导您如何将偶极子模型化为两个相位相差 $180$ 度的单极子，并推导出其在远场的方向性图样和 $3$ dB 波束宽度，这是表征声源方向辐射能力的关键参数。",
            "id": "4115023",
            "problem": "考虑一种质量密度为 $\\rho_{0}$、声速为 $c_{0}$ 的无损耗均匀流体。设一个时谐声场的角频率为 $\\omega$，其隐式时间依赖关系为 $\\exp(-i \\omega t)$。在线性声学中，稳态声压 $p(\\mathbf{r})$ 满足非齐次亥姆霍兹方程\n$$\n\\nabla^{2} p(\\mathbf{r}) + k^{2} p(\\mathbf{r}) = - S(\\mathbf{r}),\n$$\n其中 $k = \\omega / c_{0}$ 是波数，$S(\\mathbf{r})$ 是声源分布。一个沿z轴取向的紧凑声偶极子可以建模为两个等幅反号的无穷小单极子，它们分别位于 $\\mathbf{r}_{+} = \\tfrac{d}{2} \\hat{\\mathbf{z}}$ 和 $\\mathbf{r}_{-} = -\\tfrac{d}{2} \\hat{\\mathbf{z}}$，且满足 $d \\ll \\lambda$ 以及 $\\lambda = 2 \\pi / k$。亥姆霍兹算子的自由空间格林函数为\n$$\nG(\\mathbf{r};\\mathbf{r}_{0}) = \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{0}|)}{4 \\pi |\\mathbf{r} - \\mathbf{r}_{0}|}.\n$$\n从非齐次亥姆霍兹方程、自由空间格林函数、叠加原理以及远场 ($r \\to \\infty$) 和小间距 ($kd \\ll 1$) 展开出发，推导偶极子远场声压的主阶角向依赖性。然后，将指向性函数定义为相对于从偶极子轴（+z方向）测量的极角 $\\theta$ 的归一化远场振幅，并证明偶极子指向性与 $\\cos \\theta$ 成正比。最后，通过从远场声压中确定时均声强模式，求出主瓣的3分贝(dB)波束宽度，其定义为声强等于其最大值一半的两个角度之间的总角宽度。将最终答案表示为以弧度为单位的单个闭式解析表达式。不要四舍五入，请提供精确表达式。",
            "solution": "该问题要求推导声偶极子的远场声压、其指向性以及主瓣的3dB波束宽度。我们首先验证问题陈述的有效性。\n\n该问题在科学上基于线性声学原理，利用了非齐次亥姆霍兹方程和格林函数的概念，这些都是波动物理学中的标准工具。将偶极子建模为两个间距很近、相位相反的单极子是一个基本概念。这个问题是适定的，提供了所有必要的物理参数（$\\rho_{0}$，$c_{0}$）、数学定义（亥姆霍兹方程、格林函数、时间依赖性）和几何设置（偶极子取向和间距）。约束条件（$d \\ll \\lambda$，$r \\to \\infty$）陈述清晰，并且对于所需的近似具有物理意义。指向性和波束宽度的定义是明确的。该问题是客观的，不包含任何先验矛盾。因此，该问题被认为是有效的，我们继续进行求解。\n\n根据线性亥姆霍兹方程的叠加原理，由声源分布 $S(\\mathbf{r})$ 产生的声压场 $p(\\mathbf{r})$ 可以通过对由自由空间格林函数 $G(\\mathbf{r}; \\mathbf{r}_{0})$ 加权的声源贡献进行积分来求得：\n$$\np(\\mathbf{r}) = \\int S(\\mathbf{r}_{0}) G(\\mathbf{r}; \\mathbf{r}_{0}) dV_{0}\n$$\n该问题描述了一个沿z轴取向的偶极子源，由两个等强度反号的单极子组成。设声源项的强度为 $A$。单极子位于 $\\mathbf{r}_{+} = \\frac{d}{2} \\hat{\\mathbf{z}}$ 和 $\\mathbf{r}_{-} = -\\frac{d}{2} \\hat{\\mathbf{z}}$。使用狄拉克δ函数 $\\delta(\\mathbf{r})$，声源分布可以写为：\n$$\nS(\\mathbf{r}) = A \\delta(\\mathbf{r} - \\mathbf{r}_{+}) - A \\delta(\\mathbf{r} - \\mathbf{r}_{-})\n$$\n将此声源分布代入积分解中，并利用δ函数的筛选性质，总声压是两个单极子场的和：\n$$\np(\\mathbf{r}) = A G(\\mathbf{r}; \\mathbf{r}_{+}) - A G(\\mathbf{r}; \\mathbf{r}_{-})\n$$\n我们已知格林函数 $G(\\mathbf{r};\\mathbf{r}_{0}) = \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{0}|)}{4 \\pi |\\mathbf{r} - \\mathbf{r}_{0}|}$。将其代入声压表达式，得到：\n$$\np(\\mathbf{r}) = \\frac{A}{4\\pi} \\left( \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{+}|)}{|\\mathbf{r} - \\mathbf{r}_{+}|} - \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{-}|)}{|\\mathbf{r} - \\mathbf{r}_{-}|} \\right)\n$$\n现在我们应用远场近似，即观测点距离 $r = |\\mathbf{r}|$ 远大于偶极子间距 $d$（$r \\gg d$）。在此极限下，我们可以对出现在分母（振幅项）和指数（相位项）中的距离 $|\\mathbf{r} - \\mathbf{r}_{0}|$ 进行近似。\n对于振幅项，一个简单的近似就足够了：$|\\mathbf{r} - \\mathbf{r}_{0}| \\approx r$。\n对于相位项，需要更精确的近似，因为相位对微小的程差很敏感。我们使用二项式展开：\n$$\n|\\mathbf{r} - \\mathbf{r}_{0}| = \\sqrt{(\\mathbf{r} - \\mathbf{r}_{0}) \\cdot (\\mathbf{r} - \\mathbf{r}_{0})} = \\sqrt{r^2 - 2 \\mathbf{r} \\cdot \\mathbf{r}_{0} + |\\mathbf{r}_{0}|^2} = r \\sqrt{1 - \\frac{2 \\mathbf{r} \\cdot \\mathbf{r}_{0}}{r^2} + \\frac{|\\mathbf{r}_{0}|^2}{r^2}}\n$$\n对于 $r \\to \\infty$，我们可以将平方根展开到一阶：\n$$\n|\\mathbf{r} - \\mathbf{r}_{0}| \\approx r \\left( 1 - \\frac{\\mathbf{r} \\cdot \\mathbf{r}_{0}}{r^2} \\right) = r - \\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{0}\n$$\n其中 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ 是观测方向上的单位矢量。\n设 $\\theta$ 是从+z轴测量的极角。则 $\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$。对于我们的两个声源：\n$$\n\\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{+} = \\hat{\\mathbf{r}} \\cdot \\left(\\frac{d}{2}\\hat{\\mathbf{z}}\\right) = \\frac{d}{2} \\cos\\theta\n$$\n$$\n\\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{-} = \\hat{\\mathbf{r}} \\cdot \\left(-\\frac{d}{2}\\hat{\\mathbf{z}}\\right) = -\\frac{d}{2} \\cos\\theta\n$$\n所以相位项变为：\n$$\n|\\mathbf{r} - \\mathbf{r}_{+}| \\approx r - \\frac{d}{2} \\cos\\theta\n$$\n$$\n|\\mathbf{r} - \\mathbf{r}_{-}| \\approx r + \\frac{d}{2} \\cos\\theta\n$$\n将这些近似值代入声压表达式：\n$$\np(\\mathbf{r}) \\approx \\frac{A}{4\\pi r} \\left( \\exp\\left(ik\\left(r - \\frac{d}{2}\\cos\\theta\\right)\\right) - \\exp\\left(ik\\left(r + \\frac{d}{2}\\cos\\theta\\right)\\right) \\right)\n$$\n提出公因项 $\\exp(ikr)$：\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( \\exp\\left(-i\\frac{kd}{2}\\cos\\theta\\right) - \\exp\\left(i\\frac{kd}{2}\\cos\\theta\\right) \\right)\n$$\n使用欧拉恒等式 $\\sin(x) = \\frac{\\exp(ix) - \\exp(-ix)}{2i}$，我们可以将括号中的项写为 $-2i \\sin\\left(\\frac{kd}{2}\\cos\\theta\\right)$。\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( -2i \\sin\\left(\\frac{kd}{2}\\cos\\theta\\right) \\right)\n$$\n接下来，我们应用小间距近似 $kd \\ll 1$。这意味着正弦函数的自变量很小，因此我们可以使用一阶泰勒展开 $\\sin(x) \\approx x$。\n$$\n\\sin\\left(\\frac{kd}{2}\\cos\\theta\\right) \\approx \\frac{kd}{2}\\cos\\theta\n$$\n将此代回声压表达式，得到偶极子的主阶远场声压：\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( -2i \\left(\\frac{kd}{2}\\cos\\theta\\right) \\right) = -iAkd \\cos\\theta \\frac{\\exp(ikr)}{4\\pi r}\n$$\n该表达式表明，偶极子远场声压的主阶角向依赖性与 $\\cos\\theta$ 成正比。\n\n指向性函数 $D(\\theta)$ 定义为归一化的远场声压振幅。远场声压振幅 $|p(\\mathbf{r})|$ 为：\n$$\n|p(\\mathbf{r})| = \\left| -iAkd \\cos\\theta \\frac{\\exp(ikr)}{4\\pi r} \\right| = \\frac{|A|kd}{4\\pi r} |\\cos\\theta|\n$$\n振幅作为角度的函数与 $|\\cos\\theta|$ 成正比。当 $|\\cos\\theta|=1$ 时（即在 $\\theta=0$ 和 $\\theta=\\pi$ 处）振幅达到最大值。我们将固定半径 $r$ 处的最大振幅记为 $|p|_{\\text{max}} = \\frac{|A|kd}{4\\pi r}$。则指向性函数为：\n$$\nD(\\theta) = \\frac{|p(\\mathbf{r})|}{|p|_{\\text{max}}} = \\frac{\\frac{|A|kd}{4\\pi r} |\\cos\\theta|}{\\frac{|A|kd}{4\\pi r}} = |\\cos\\theta|\n$$\n问题要求证明指向性与 $\\cos\\theta$ 成正比。对于通常定义在半球 $0 \\le \\theta \\le \\pi/2$ 内的主瓣，$\\cos\\theta$ 是非负的，所以 $D(\\theta) = \\cos\\theta$。\n\n最后，我们确定3dB波束宽度。在远场中，时均声强 $I$ 与声压振幅的平方成正比：\n$$\nI(\\mathbf{r}) \\propto |p(\\mathbf{r})|^2 \\propto \\left( \\frac{|\\cos\\theta|}{r} \\right)^2 = \\frac{\\cos^2\\theta}{r^2}\n$$\n声强的角向依赖性由 $I(\\theta) = I_{\\text{max}} \\cos^2\\theta$ 给出，其中 $I_{\\text{max}}$ 是最大声强，出现在轴线 $\\theta=0$ 处。\n3dB波束宽度是声强为其最大值一半的两个角度之间的总角宽度。3dB点，或称半功率点，是满足 $I(\\theta_h) = I_{\\text{max}}/2$ 的角度 $\\theta_h$。\n$$\nI_{\\text{max}} \\cos^2\\theta_h = \\frac{I_{\\text{max}}}{2}\n$$\n$$\n\\cos^2\\theta_h = \\frac{1}{2}\n$$\n开平方根得到 $|\\cos\\theta_h| = \\frac{1}{\\sqrt{2}}$。\n对于主瓣，我们考虑第一象限中的角度 $\\theta_h$（$0 \\le \\theta_h \\le \\pi/2$），所以我们取正根：\n$$\n\\cos\\theta_h = \\frac{1}{\\sqrt{2}}\n$$\n解得 $\\theta_h$ 为：\n$$\n\\theta_h = \\arccos\\left(\\frac{1}{\\sqrt{2}}\\right) = \\frac{\\pi}{4} \\text{ 弧度}\n$$\n这个角度 $\\theta_h$ 是波束的半角。波束宽度定义为*总角宽度*，由于 $\\cos^2\\theta$ 图案关于轴 $\\theta=0$ 的对称性，波束宽度是该值的两倍。\n$$\n\\text{波束宽度} = 2\\theta_h = 2 \\times \\frac{\\pi}{4} = \\frac{\\pi}{2}\n$$\n因此，主瓣的3dB波束宽度为 $\\frac{\\pi}{2}$ 弧度。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{2}}\n$$"
        },
        {
            "introduction": "从解析推导转向计算实践，我们将探讨如何在充满噪声的测量数据中识别声源类型。在现实世界中，纯粹的单极子或偶极子很少见，并且测量总是伴随着不确定性。本练习要求您运用统计假设检验（特别是广义似然比检验）来构建一个分类算法，从而能够以给定的置信水平区分不同的声源类型。这项计算任务是理论声学与实际信号处理和数据科学之间重要的桥梁。请注意，为了简化模型，本问题中的四极子方向性采用了 $\\cos(2\\theta)$ 作为基函数，这是一种教学上的近似，而严格的轴对称四极子远场方向性由二阶勒让德多项式 $P_2(\\cos\\theta)$ 描述。",
            "id": "4115002",
            "problem": "给定关于声源的角分辨远场声压测量数据，已知这些声源在球多极展开意义下关于一个固定的参考轴是轴对称的。您的任务是构建一个统计假设检验，以在指定的置信水平下，仅使用测量的远场方向图和假设的高斯测量噪声模型，来判断声源应最好地被描述为单极子、偶极子还是四极子。您必须实现一个完整的、可运行的程序，该程序对一个小型测试套件执行此分类，并按下面指定的精确格式输出结果。\n\n从带有简谐拟设的线性化声波方程出发，该方程可推导出亥姆霍兹方程。在远场中，轴对称多极子的角度依赖性可以用前几个轴对称球谐因子来表示。假设轴对称性与测量参考轴对齐，用基函数 $\\phi_0(\\theta) = 1$、$\\phi_1(\\theta) = \\cos\\theta$ 和 $\\phi_2(\\theta) = \\cos(2\\theta)$ 分别近似单极子、偶极子和四极子的角度依赖性，其中 $\\theta$ 是绕轴的极角。设在角度 $\\theta_i$ 处测得的远场声压样本为 $y_i$，并假设一个独立同分布的高斯噪声模型 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，其方差 $\\sigma^2$ 已知。\n\n将测量值建模为线性回归\n$$\ny_i = c_0\\,\\phi_0(\\theta_i) + c_1\\,\\phi_1(\\theta_i) + c_2\\,\\phi_2(\\theta_i) + \\varepsilon_i,\n$$\n其中未知系数 $c_0$、$c_1$ 和 $c_2$ 将通过高斯噪声假设下的最大似然估计来估计，这等同于最小二乘法。考虑以下一组与纯声源类型相对应的互斥复合零假设：\n- 单极子假设 $H_M$：$c_1 = 0$ 且 $c_2 = 0$，\n- 偶极子假设 $H_D$：$c_0 = 0$ 且 $c_2 = 0$，\n- 四极子假设 $H_Q$：$c_0 = 0$ 且 $c_1 = 0$。\n\n为每个受限假设构建一个针对完整三参数模型的广义似然比（GLR）检验，并通过对三个检验使用Bonferroni校正，将族系误差率控制在指定的显著性水平 $\\alpha$。此外，还要求被接受的声源类型的定义性非零系数，通过双边高斯检验，在相同的Bonferroni校正水平上统计显著地不为零。实现一个分类规则，该规则接受其零假设未被拒绝且其定义性系数显著的声源类型，然后选择具有最小受限残差平方和的已接受类型。如果在这三个标准下没有一种类型被接受，则返回代码 $-1$，表示在指定的置信水平下，数据不支持任何纯类型。\n\n所有角度必须以弧度表示，压力以帕斯卡（Pascals）表示。噪声标准差 $\\sigma$ 必须解释为帕斯卡。对于每个测试用例，将角度集生成为 $[0,2\\pi)$ 上的 $N$ 个均匀间隔的样本，并通过将相应的基函数与指定的幅度和具有给定 $\\sigma$ 的加性高斯噪声相结合来生成合成测量值 $y_i$，使用固定的随机种子以确保可复现性。\n\n实现程序以处理以下测试套件，每个套件由 $(N, c_0, c_1, c_2, \\sigma, \\alpha)$ 指定：\n- 案例 1（理想路径单极子）：$(N=\\!360,\\, c_0=\\!2.0\\,\\text{Pa},\\, c_1=\\!0.0\\,\\text{Pa},\\, c_2=\\!0.0\\,\\text{Pa},\\, \\sigma=\\!0.05\\,\\text{Pa},\\, \\alpha=\\!0.05)$。\n- 案例 2（理想路径偶极子，更严格的置信度）：$(N=\\!180,\\, c_0=\\!0.0\\,\\text{Pa},\\, c_1=\\!1.0\\,\\text{Pa},\\, c_2=\\!0.0\\,\\text{Pa},\\, \\sigma=\\!0.10\\,\\text{Pa},\\, \\alpha=\\!0.01)$。\n- 案例 3（理想路径四极子，更高噪声）：$(N=\\!90,\\, c_0=\\!0.0\\,\\text{Pa},\\, c_1=\\!0.0\\,\\text{Pa},\\, c_2=\\!1.5\\,\\text{Pa},\\, \\sigma=\\!0.30\\,\\text{Pa},\\, \\alpha=\\!0.05)$。\n- 案例 4（混合型，应拒绝纯类型）：$(N=\\!120,\\, c_0=\\!0.5\\,\\text{Pa},\\, c_1=\\!0.5\\,\\text{Pa},\\, c_2=\\!0.0\\,\\text{Pa},\\, \\sigma=\\!0.05\\,\\text{Pa},\\, \\alpha=\\!0.05)$。\n- 案例 5（低信号，仅噪声）：$(N=\\!100,\\, c_0=\\!0.0\\,\\text{Pa},\\, c_1=\\!0.0\\,\\text{Pa},\\, c_2=\\!0.0\\,\\text{Pa},\\, \\sigma=\\!0.20\\,\\text{Pa},\\, \\alpha=\\!0.05)$。\n\n使用固定的随机种子 $s=\\!12345$ 来生成高斯噪声，以使结果具有确定性。将每个案例的分类结果编码为一个整数：单极子 $\\rightarrow 0$，偶极子 $\\rightarrow 1$，四极子 $\\rightarrow 2$，无 $\\rightarrow -1$。\n\n您的程序应生成单行输出，其中包含上述五个测试用例的结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_k$ 是案例 $k$ 的整数代码，如上定义。",
            "solution": "该问题要求开发一个统计程序，将轴对称声源分类为单极子、偶极子或四极子。这是通过对测量的远场声压数据执行一系列假设检验来完成的，这些数据使用指定的基函数在一个线性回归框架中进行建模。\n\n### 1. 建模框架\n在极角 $\\theta_i$ 处测得的声压 $y_i$ 被建模为代表不同声源类型的基函数的线性组合，外加高斯噪声 $\\varepsilon_i$。该模型由下式给出：\n$$\ny_i = c_0\\,\\phi_0(\\theta_i) + c_1\\,\\phi_1(\\theta_i) + c_2\\,\\phi_2(\\theta_i) + \\varepsilon_i\n$$\n其中基函数定义为 $\\phi_0(\\theta) = 1$（单极子）、$\\phi_1(\\theta) = \\cos\\theta$（偶极子）和 $\\phi_2(\\theta) = \\cos(2\\theta)$（四极子）。测量噪声 $\\varepsilon_i$ 假设为独立同分布，服从均值为 $0$ 且方差 $\\sigma^2$ 已知的正态分布，记为 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n这可以以矩阵形式表示为一个通用线性模型：\n$$\ny = Xc + \\varepsilon\n$$\n这里，$y$ 是 $N$ 个压力测量的 $N \\times 1$ 向量，$c = [c_0, c_1, c_2]^T$ 是未知系数的 $3 \\times 1$ 向量，$\\varepsilon$ 是 $N \\times 1$ 的噪声向量，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_N)$，$I_N$ 是 $N \\times N$ 的单位矩阵。$N \\times 3$ 的设计矩阵 $X$ 由在每个测量角度 $\\theta_i$ 处求值的基函数构成：\n$$\nX = \\begin{bmatrix}\n\\phi_0(\\theta_0)  \\phi_1(\\theta_0)  \\phi_2(\\theta_0) \\\\\n\\phi_0(\\theta_1)  \\phi_1(\\theta_1)  \\phi_2(\\theta_1) \\\\\n\\vdots  \\vdots  \\vdots \\\\\n\\phi_0(\\theta_{N-1})  \\phi_1(\\theta_{N-1})  \\phi_2(\\theta_{N-1})\n\\end{bmatrix} = \\begin{bmatrix}\n1  \\cos(\\theta_0)  \\cos(2\\theta_0) \\\\\n1  \\cos(\\theta_1)  \\cos(2\\theta_1) \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  \\cos(\\theta_{N-1})  \\cos(2\\theta_{N-1})\n\\end{bmatrix}\n$$\n在高斯噪声假设下，系数向量 $c$ 的最大似然估计（MLE）与普通最小二乘（OLS）估计相同，由下式给出：\n$$\n\\hat{c} = (X^T X)^{-1} X^T y\n$$\n\n### 2. 假设检验策略\n分类任务被构建为一系列假设检验。完整模型（其中所有三个系数都可能非零）作为备择假设 $H_A$。我们检验三个与纯声源类型相对应的互斥复合零假设：\n- **单极子假设 $H_M$**：声源是纯单极子。这施加了约束 $c_1 = 0$ 和 $c_2 = 0$。\n- **偶极子假设 $H_D$**：声源是纯偶极子。这施加了约束 $c_0 = 0$ 和 $c_2 = 0$。\n- **四极子假设 $H_Q$**：声源是纯四极子。这施加了约束 $c_0 = 0$ 和 $c_1 = 0$。\n\n使用广义似然比（GLR）检验来比较每个受限模型（$H_M$、$H_D$、$H_Q$）与完整模型 $H_A$。对于误差方差 $\\sigma^2$ 已知的线性模型，GLR检验统计量 $\\Lambda$ 基于残差平方和（RSS）的变化。设 $RSS_{full} = \\|y - X_{full}\\hat{c}_{full}\\|^2$ 为完整模型的RSS，设 $RSS_{restr} = \\|y - X_{restr}\\hat{c}_{restr}\\|^2$ 为受限模型的RSS。对于给定的零假设 $H_k$，检验统计量为：\n$$\n\\Lambda_k = \\frac{RSS_k - RSS_{full}}{\\sigma^2}\n$$\n在零假设 $H_k$ 下，该统计量服从卡方分布，$\\Lambda_k \\sim \\chi^2(q_k)$，其中 $q_k$ 是施加的独立线性约束的数量。对于 $H_M$、$H_D$ 和 $H_Q$，约束数量在每种情况下均为 $q=2$。\n\n由于我们正在执行三个独立的检验，我们必须进行多重比较校正，以将族系误差率（FWER）控制在指定的水平 $\\alpha$。问题规定使用Bonferroni校正，这将每个独立检验的显著性水平设置为 $\\alpha' = \\alpha/3$。如果一个零假设 $H_k$ 的检验统计量 $\\Lambda_k$ 小于或等于临界值 $\\chi^2_{1-\\alpha'}(2)$（即具有2个自由度的卡方分布的 $(1-\\alpha')$ 分位数），则认为该假设是合理的（即不被拒绝）。\n\n### 3. 系数显著性条件\n接受一个声源类型的附加标准是其定义性系数必须在统计上显著。这确保我们不会基于一个可忽略的分量来对声源进行分类。我们检验从完整模型估计的系数 $\\hat{c}_{full} = [\\hat{c}_0, \\hat{c}_1, \\hat{c}_2]^T$ 的显著性。\n\n估计系数的协方差矩阵为 $\\text{Cov}(\\hat{c}_{full}) = \\sigma^2 (X_{full}^T X_{full})^{-1}$。单个系数估计 $\\hat{c}_j$ 的标准误是该矩阵对应对角线元素的平方根，$SE(\\hat{c}_j) = \\sqrt{[\\text{Cov}(\\hat{c}_{full})]_{jj}}$。\n\n为了检验 $c_j$ 的显著性（即 $H_0: c_j = 0$），我们使用Z检验，因为 $\\sigma$ 是已知的。检验统计量是：\n$$\nZ_j = \\frac{\\hat{c}_j}{SE(\\hat{c}_j)}\n$$\n在零假设 $c_j=0$ 下，$Z_j$ 服从标准正态分布，$Z_j \\sim \\mathcal{N}(0, 1)$。这是一个双边检验，我们应用相同的Bonferroni校正显著性水平 $\\alpha' = \\alpha/3$。如果 $|Z_j| > z_{1-\\alpha'/2}$，我们就拒绝 $c_j=0$ 的零假设，其中 $z_{1-\\alpha'/2}$ 是标准正态分布的 $(1-\\alpha'/2)$ 分位数。\n\n### 4. 算法分类规则\n最终的分类由以下逐步算法确定：\n\n1.  对于每个潜在的声源类型 $k \\in \\{M, D, Q\\}$：\n    a.  执行GLR检验，以检查数据是否与假设 $H_k$ 兼容。如果在Bonferroni校正水平 $\\alpha'$ 下我们不拒绝 $H_k$，则该类型是合理的。\n    b.  执行Z检验，以检查相应的定义性系数（$M$ 对应 $c_0$，$D$ 对应 $c_1$，$Q$ 对应 $c_2$）是否在 $\\alpha'$ 水平下显著不为零。\n2.  如果一个声源类型同时满足条件（a）和（b），则被正式“接受”。\n3.  如果没有声源类型被接受，分类结果为“无”，编码为 $-1$。\n4.  如果一个或多个声源类型被接受，最终分类是具有最小受限残差平方和（$RSS_M$、$RSS_D$ 或 $RSS_Q$）的那一个。这选择了最能拟合数据的最简单的合理模型。\n\n该实现涉及使用固定的随机种子生成合成数据以实现可复现性，执行一系列最小二乘拟合以获得必要的RSS值和系数估计，然后系统地应用上述统计检验和分类逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2, norm\n\ndef classify_source(N, c0_true, c1_true, c2_true, sigma, alpha, rng):\n    \"\"\"\n    Classifies an acoustic source based on synthetic far-field pressure data.\n    \n    Args:\n        N (int): Number of measurement points.\n        c0_true (float): True monopole coefficient.\n        c1_true (float): True dipole coefficient.\n        c2_true (float): True quadrupole coefficient.\n        sigma (float): Standard deviation of Gaussian measurement noise.\n        alpha (float): Family-wise significance level for hypothesis tests.\n        rng (np.random.Generator): NumPy random number generator instance.\n\n    Returns:\n        int: Classification code (0: monopole, 1: dipole, 2: quadrupole, -1: none).\n    \"\"\"\n    # 1. Generate synthetic data\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    phi0 = np.ones(N)\n    phi1 = np.cos(theta)\n    phi2 = np.cos(2 * theta)\n    \n    y_true = c0_true * phi0 + c1_true * phi1 + c2_true * phi2\n    noise = rng.normal(loc=0.0, scale=sigma, size=N)\n    y = y_true + noise\n\n    # 2. Fit full and restricted models using Ordinary Least Squares\n    # Full model: y = c0*phi0 + c1*phi1 + c2*phi2\n    X_full = np.stack([phi0, phi1, phi2], axis=1)\n    c_full, rss_full_arr, _, _ = np.linalg.lstsq(X_full, y, rcond=None)\n    # np.linalg.lstsq returns rss as a 0-d array if y is 1-d\n    rss_full = rss_full_arr[0] if rss_full_arr.size > 0 else 0.0\n\n    # Restricted models\n    # Monopole (H_M): y = c0*phi0\n    X_M = phi0[:, np.newaxis]\n    _, rss_M_arr, _, _ = np.linalg.lstsq(X_M, y, rcond=None)\n    rss_M = rss_M_arr[0] if rss_M_arr.size > 0 else 0.0\n\n    # Dipole (H_D): y = c1*phi1\n    X_D = phi1[:, np.newaxis]\n    _, rss_D_arr, _, _ = np.linalg.lstsq(X_D, y, rcond=None)\n    rss_D = rss_D_arr[0] if rss_D_arr.size > 0 else 0.0\n\n    # Quadrupole (H_Q): y = c2*phi2\n    X_Q = phi2[:, np.newaxis]\n    _, rss_Q_arr, _, _ = np.linalg.lstsq(X_Q, y, rcond=None)\n    rss_Q = rss_Q_arr[0] if rss_Q_arr.size > 0 else 0.0\n\n    # 3. Perform hypothesis tests with Bonferroni correction\n    alpha_corr = alpha / 3.0\n    \n    # 3a. Generalized Likelihood Ratio (GLR) tests\n    # Test statistic is (RSS_restr - RSS_full)/sigma^2 ~ chi2(df=2)\n    # Degrees of freedom for constraints (q) = 3 (full) - 1 (restr) = 2\n    chi2_crit = chi2.ppf(1 - alpha_corr, df=2)\n    \n    lambda_M = (rss_M - rss_full) / (sigma**2)\n    is_plausible_M = lambda_M = chi2_crit\n    \n    lambda_D = (rss_D - rss_full) / (sigma**2)\n    is_plausible_D = lambda_D = chi2_crit\n\n    lambda_Q = (rss_Q - rss_full) / (sigma**2)\n    is_plausible_Q = lambda_Q = chi2_crit\n    \n    # 3b. Coefficient significance Z-tests\n    # Cov(c_hat) = sigma^2 * (X'X)^-1\n    try:\n        cov_c_full = sigma**2 * np.linalg.inv(X_full.T @ X_full)\n        se_c_full = np.sqrt(np.diag(cov_c_full))\n    except np.linalg.LinAlgError:\n        # This case is unlikely with the problem's parameters but is good practice\n        return -1\n\n    z_crit = norm.ppf(1 - alpha_corr / 2.0)\n    \n    is_significant_0 = np.abs(c_full[0] / se_c_full[0]) > z_crit\n    is_significant_1 = np.abs(c_full[1] / se_c_full[1]) > z_crit\n    is_significant_2 = np.abs(c_full[2] / se_c_full[2]) > z_crit\n\n    # 4. Apply classification logic\n    accepted_types = []\n    \n    if is_plausible_M and is_significant_0:\n        accepted_types.append({'rss': rss_M, 'type': 0})\n    \n    if is_plausible_D and is_significant_1:\n        accepted_types.append({'rss': rss_D, 'type': 1})\n        \n    if is_plausible_Q and is_significant_2:\n        accepted_types.append({'rss': rss_Q, 'type': 2})\n\n    if not accepted_types:\n        return -1\n    else:\n        # Select the accepted type with the minimum restricted RSS\n        best_type = min(accepted_types, key=lambda x: x['rss'])\n        return best_type['type']\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Use a single random number generator for all test cases for determinism.\n    rng = np.random.default_rng(12345)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, c0, c1, c2, sigma, alpha)\n        (360, 2.0, 0.0, 0.0, 0.05, 0.05), # Case 1: Monopole\n        (180, 0.0, 1.0, 0.0, 0.10, 0.01), # Case 2: Dipole\n        (90, 0.0, 0.0, 1.5, 0.30, 0.05), # Case 3: Quadrupole\n        (120, 0.5, 0.5, 0.0, 0.05, 0.05), # Case 4: Mixture\n        (100, 0.0, 0.0, 0.0, 0.20, 0.05), # Case 5: Noise-only\n    ]\n\n    results = []\n    for case in test_cases:\n        N, c0, c1, c2, sigma, alpha = case\n        result = classify_source(N, c0, c1, c2, sigma, alpha, rng)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}