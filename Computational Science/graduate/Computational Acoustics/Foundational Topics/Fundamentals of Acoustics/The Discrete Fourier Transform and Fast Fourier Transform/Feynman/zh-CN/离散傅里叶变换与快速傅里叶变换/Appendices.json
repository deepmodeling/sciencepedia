{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在探讨离散傅里叶变换 (DFT) 中一个称为“扇形损失” (scalloping loss) 的基本现象。通过分析一个频率落在 DFT 频率仓 (bin) 之间的纯正弦波，您将推导出其在最差情况下的振幅误差，从而更深入地理解有限长度分析如何影响频谱的准确性。这项练习对于在实际场景中正确解读 DFT 结果至关重要。",
            "id": "4140828",
            "problem": "一个声学实验室记录了一个窄带平面波压力信号，其采样频率足够高，可以忽略混叠效应。在 $N$ 个样本的有限观测中，数据与一个矩形分析窗（对于 $n=0,1,\\dots,N-1$ 等于 $1$，否则等于 $0$）相乘，然后通过离散傅里叶变换（DFT）计算频谱，该变换通过快速傅里叶变换（FFT）进行数值实现。考虑传感器捕获的离散时间复正弦信号 $x[n] = A \\exp\\!\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$，其中 $A \\in \\mathbb{C}$ 是复振幅，$k_{0} \\in \\mathbb{Z}$ 表示一个整数DFT频率仓（bin）索引，而 $\\delta \\in \\mathbb{R}$ 是一个小数频率仓偏移。假设 $|\\delta| \\leq \\tfrac{1}{2}$，因此 $k_{0}$ 是最近的频率仓。\n\n将给定窗的扇形损失（scalloping loss）定义为：当正弦波频率处于半个频率仓偏移（$\\delta = \\tfrac{1}{2}$）时，在最近频率仓处的DFT幅度，与在频率仓中心（$\\delta = 0$）处的DFT幅度之比，此比值为无量纲振幅比，并且两者都在频率仓 $k_{0}$ 处进行评估。仅从DFT的定义\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-j \\frac{2\\pi k n}{N}\\right),\n$$\n出发，推导矩形窗的扇形损失作为 $N$ 的函数的闭式解析表达式。然后确定其在 $N \\to \\infty$ 时的渐近值。将最终的扇形损失表示为一个精确的无量纲数（无单位）。最终报告值无需四舍五入。",
            "solution": "该问题具有科学依据，提法明确，客观，并包含了进行形式推导所需的所有必要信息。这是一个数字信号处理中的标准问题，旨在检验对离散傅里叶变换（DFT）的基本理解。该问题有效。\n\n推导从DFT的定义开始。信号是一个复正弦信号 $x[n] = A \\exp\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$，在 $N$ 个样本上采集，并与一个矩形窗相乘。加窗意味着我们只考虑离散时间索引 $n$ 从 $0$ 到 $N-1$ 的信号。DFT，$X[k]$，由下式给出：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\n代入 $x[n]$ 的表达式：\n$$\nX[k] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\n我们需要在最近的整数频率仓索引 $k=k_0$ 处评估频谱。\n$$\nX[k_0] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k_0 n}{N}\\right)\n$$\n合并指数项得到：\n$$\nX[k_0] = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (k_0 + \\delta - k_0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi \\delta n}{N}\\right)\n$$\n这是一个形式为 $\\sum_{n=0}^{N-1} r^n$ 的等比数列，公比为 $r = \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)$。使用有限等比数列的求和公式 $\\frac{1-r^N}{1-r}$，我们得到：\n$$\nX[k_0] = A \\frac{1 - \\left(\\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)\\right)^N}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)} = A \\frac{1 - \\exp(j 2\\pi \\delta)}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)}\n$$\n为了求幅度 $|X[k_0]|$，我们使用恒等式 $|1 - \\exp(j\\theta)| = | e^{j\\theta/2} (e^{-j\\theta/2} - e^{j\\theta/2}) | = |-2j e^{j\\theta/2} \\sin(\\frac{\\theta}{2})| = 2|\\sin(\\frac{\\theta}{2})|$。将此应用于分子和分母：\n$$\n|X[k_0]| = |A| \\frac{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2}\\right)\\right|}{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2N}\\right)\\right|} = |A| \\frac{|\\sin(\\pi\\delta)|}{|\\sin(\\frac{\\pi\\delta}{N})|}\n$$\n这是在频率仓 $k_0$ 处的幅度作为小数频率仓偏移 $\\delta$ 的函数的一般表达式。\n\n扇形损失定义为在 $\\delta = \\frac{1}{2}$ 处的幅度与在 $\\delta=0$ 处的幅度之比。我们分别评估这两种情况。\n\n情况1：频率仓中心频率，$\\delta=0$。\n在这种情况下，信号频率与一个DFT频率仓完全对齐。我们可以对上述表达式取 $\\delta \\to 0$ 的极限，但回到求和式更直接：\n$$\nX[k_0]|_{\\delta=0} = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp(0) = A \\sum_{n=0}^{N-1} 1 = AN\n$$\n因此，幅度为：\n$$\n|X[k_0]|_{\\delta=0} = |A|N\n$$\n\n情况2：半个频率仓偏移，$\\delta=\\frac{1}{2}$。\n这代表了频率失配的最坏情况。我们将 $\\delta=\\frac{1}{2}$ 代入一般幅度表达式。考虑到 $|\\delta| \\leq \\frac{1}{2}$，这是最大偏移。\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{|\\sin(\\pi \\cdot \\frac{1}{2})|}{|\\sin(\\frac{\\pi \\cdot \\frac{1}{2}}{N})|} = |A| \\frac{|\\sin(\\frac{\\pi}{2})|}{|\\sin(\\frac{\\pi}{2N})|}\n$$\n由于 $\\sin(\\frac{\\pi}{2}) = 1$，且对于任意 $N \\geq 1$ 都有 $\\frac{\\pi}{2N} \\in (0, \\frac{\\pi}{2}]$，所以 $\\sin(\\frac{\\pi}{2N})$ 是正数。因此，可以去掉绝对值符号。\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}\n$$\n扇形损失 $S_L$ 是这两个幅度之比：\n$$\nS_L(N) = \\frac{|X[k_0]|_{\\delta=1/2}}{|X[k_0]|_{\\delta=0}} = \\frac{|A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}}{|A|N} = \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\n这就是矩形窗的扇形损失作为 $N$ 的函数的闭式表达式。\n\n最后一步是确定当 $N \\to \\infty$ 时的渐近值。我们计算该极限：\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} S_L(N) = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\n当 $N \\to \\infty$ 时，正弦函数的自变量 $\\theta = \\frac{\\pi}{2N}$ 趋近于 $0$。我们使用基本三角函数极限 $\\lim_{\\theta\\to 0} \\frac{\\sin(\\theta)}{\\theta} = 1$。我们重新整理表达式以使用此极限。\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})} = \\lim_{N\\to\\infty} \\frac{1}{N \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N} \\cdot \\frac{\\pi}{2N}}\n$$\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{N\\pi}{2N} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{\\pi}{2} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}}\n$$\n由于当 $N \\to \\infty$ 时，$\\frac{\\pi}{2N} \\to 0$，因此 $\\frac{\\sin(\\pi/2N)}{\\pi/2N}$ 项趋近于 $1$。\n$$\nS_{L, \\infty} = \\frac{1}{\\frac{\\pi}{2} \\cdot 1} = \\frac{2}{\\pi}\n$$\n矩形窗的扇形损失的渐近值是 $\\frac{2}{\\pi}$。这个无量纲值约等于 $0.6366$，对应于大约 $3.92$ 分贝的损失。",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi}}\n$$"
        },
        {
            "introduction": "在频谱泄漏概念的基础上，本练习将演示一种实用的方法，以超越 DFT 固有分辨率来提高频率估计的精度。您将利用对 DFT 幅度谱的二次插值，以亚频率仓 (sub-bin) 的精度定位一个音调的频率。该技术在测量和分析中被广泛用于校正 DFT 频率网格的内在量化效应。",
            "id": "4140831",
            "problem": "一个声学实验室使用一个经过校准的窄带源来产生一个稳定的正弦压力音，其真实频率 $f_{0}$ 不是离散傅里叶变换 (DFT) 频率仓间距的整数倍。一个单通道麦克风信号以采样率 $f_{s}$ 被采样 $N$ 个样本，并在使用快速傅里叶变换 (FFT) 算法计算 DFT 之前，预先乘以一个汉宁窗。假设在无噪声、单音条件下，加窗后的幅度谱在主峰附近是局部平滑且单峰的。\n\n给定以下参数和观测值：\n- 采样率 $f_{s} = 48000 \\ \\mathrm{Hz}$。\n- DFT 长度 $N = 4096$。\n- 真实音调频率 $f_{0} = 1000.73 \\ \\mathrm{Hz}$。\n- 幅度谱 $|X[k]|$ 被归一化，使得主频率仓的幅度为 $1.0$。在峰值频率仓 $k_{p}$ 附近，观测到的三点邻域幅度为\n  $|X[k_{p}-1]| = 0.50$， $|X[k_{p}]| = 1.00$， 和 $|X[k_{p}+1]| = 0.94$。\n\n仅从离散傅里叶变换的定义及其频率仓间距的含义出发，按以下步骤进行：\n1. 确定与 $f_{0}$ 对应的最接近的整数频率仓索引 $k_{\\mathrm{near}}$，以及将 $f_{0}$ 量化到该频率仓中心频率所产生的有符号频率估计误差 $e_{0}$。使用由 $f_{s}$ 和 $N$ 所决定的频率仓间距。\n2. 假设幅度谱在其最大值附近的邻域内可以由一个关于频率仓索引的二阶多项式很好地局部近似，通过对三个相邻的幅度样本 $\\{|X[k_{p}-1]|, |X[k_{p}]|, |X[k_{p}+1]|\\}$ 拟合一个二次曲线，来推导子频率仓峰值位置的估计。根据此子频率仓位置，构建一个校正后的频率估计值 $\\hat{f}$。\n\n仅报告最终的校正后频率估计值 $\\hat{f}$，以 $\\mathrm{Hz}$ 为单位表示，并四舍五入至六位有效数字。",
            "solution": "核心概念是离散傅里叶变换 (DFT) 及其解释。对于一个长度为 $N$ 的序列 $x[n]$，其 DFT 为\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\, w[n] \\, \\exp\\!\\left(-\\mathrm{j} \\, 2\\pi \\, \\frac{k n}{N}\\right),\n$$\n其中 $w[n]$ 是汉宁窗。DFT 将均匀采样的时间域数据映射到均匀间隔的频率仓。DFT 的基本频率间距为\n$$\n\\Delta f = \\frac{f_{s}}{N}.\n$$\n一个频率为 $f_{0}$ 的纯音，如果它不与 $\\Delta f$ 的整数倍重合，就不会与某个整数频率仓对齐。最接近的频率仓索引是与以下值最接近的整数\n$$\nk_{0} = \\frac{f_{0}}{\\Delta f} = \\frac{f_{0} N}{f_{s}},\n$$\n且频率仓 $k$ 的中心频率为 $f_{k} = k \\, \\Delta f$。\n\n步骤 1：最近频率仓和量化误差。\n首先，使用给定的采样率和 DFT 长度计算频率仓间距：\n$$\n\\Delta f = \\frac{f_{s}}{N} = \\frac{48000}{4096} = 11.71875.\n$$\n对应于 $f_{0}$ 的非整数频率仓索引为\n$$\nk_{0} = \\frac{f_{0}}{\\Delta f} = \\frac{1000.73}{11.71875}.\n$$\n为了确定 $k_{\\mathrm{near}} = \\mathrm{round}(k_{0})$，我们只需将 $f_{0}$ 与附近的频率仓中心频率进行比较。$k=85$ 和 $k=86$ 的频率仓中心为\n$$\nf_{85} = 85 \\times 11.71875 = 996.09375, \\quad f_{86} = 86 \\times 11.71875 = 1007.8125.\n$$\n计算绝对差值：\n$$\n|f_{0} - f_{85}| = |1000.73 - 996.09375| = 4.63625, \\quad |f_{0} - f_{86}| = |1000.73 - 1007.8125| = 7.0825.\n$$\n因此，最接近的频率仓是\n$$\nk_{\\mathrm{near}} = 85,\n$$\n其有符号量化误差为\n$$\ne_{0} = f_{0} - f_{85} = 1000.73 - 996.09375 = 4.63625.\n$$\n\n步骤 2：通过二次插值进行子频率仓峰值估计。\n汉宁窗的主瓣是平滑的；在最大值附近，幅度谱可以由一个关于频率仓索引的二阶多项式进行局部良好近似。我们将三个相邻频率仓的幅度建模为一个二次函数\n$$\ny(n) = a \\, n^{2} + b \\, n + c\n$$\n在峰值频率仓 $k_{p}$ 周围，其中 $n \\in \\{-1,0,+1\\}$ 对应于 $\\{k_{p}-1, k_{p}, k_{p}+1\\}$。设\n$$\nM_{-} = |X[k_{p}-1]|, \\quad M_{0} = |X[k_{p}]|, \\quad M_{+} = |X[k_{p}+1]|.\n$$\n给定 $M_{-} = 0.50$, $M_{0} = 1.00$, $M_{+} = 0.94$。解方程组\n$$\ny(-1) = a - b + c = M_{-}, \\quad y(0) = c = M_{0}, \\quad y(+1) = a + b + c = M_{+},\n$$\n我们得到\n$$\na = \\frac{M_{+} + M_{-} - 2 M_{0}}{2}, \\quad b = \\frac{M_{+} - M_{-}}{2}, \\quad c = M_{0}.\n$$\n抛物线顶点相对于 $n=0$ (即相对于频率仓 $k_{p}$) 的位置是\n$$\n\\delta = -\\frac{b}{2a} = - \\frac{\\frac{1}{2}(M_{+} - M_{-})}{2 \\cdot \\frac{1}{2}(M_{+} + M_{-} - 2 M_{0})} = \\frac{M_{-} - M_{+}}{2 \\, (M_{-} - 2 M_{0} + M_{+})}.\n$$\n代入测量的幅度值：\n$$\n\\delta = \\frac{0.50 - 0.94}{2 \\, (0.50 - 2 \\cdot 1.00 + 0.94)} = \\frac{-0.44}{2 \\cdot (-0.56)} = \\frac{-0.44}{-1.12} = 0.392857142857\\ldots\n$$\n这个 $\\delta$ 是插值峰值位置相对于 $k_{p}$ 右侧的小数部分频率仓偏移量。因此，子频率仓频率估计为\n$$\n\\hat{f} = (k_{p} + \\delta) \\, \\Delta f.\n$$\n这里 $k_{p} = k_{\\mathrm{near}} = 85$ 且 $\\Delta f = 11.71875$，所以\n$$\n\\hat{f} = (85 + 0.392857142857\\ldots) \\times 11.71875.\n$$\n通过分解来计算乘积：\n$$\n85 \\times 11.71875 = 996.09375, \\quad 0.392857142857\\ldots \\times 11.71875 = \\frac{11}{28} \\times 11.71875 = \\frac{11 \\times 11.71875}{28} = \\frac{128.90625}{28} = 4.603794642857\\ldots\n$$\n因此\n$$\n\\hat{f} = 996.09375 + 4.603794642857\\ldots = 1000.697544642857\\ldots\n$$\n按要求四舍五入到六位有效数字，\n$$\n\\hat{f} \\approx 1000.70.\n$$\n根据题目要求，仅报告最终的校正后频率估计值，以 $\\mathrm{Hz}$ 为单位表示，并四舍五入至六位有效数字。",
            "answer": "$$\\boxed{1000.70}$$"
        },
        {
            "introduction": "要真正领会快速傅里叶变换 (FFT) 的计算效率，理解其算法基础至关重要。本练习要求您从第一性原理出发，为一个长度为 12 的信号推导一个混合基 Cooley-Tukey FFT 算法。通过对 DFT 求和进行变址，并识别出各个计算阶段，您将揭示这种“分而治之”的策略是如何相比直接计算 DFT，从而显著降低计算复杂度的。",
            "id": "4140860",
            "problem": "考虑长度为$N$的离散傅里叶变换 (DFT)，其定义为\n$$\nX[k] \\;=\\; \\sum_{n=0}^{N-1} x[n] \\,\\exp\\!\\left(-j\\,\\frac{2\\pi}{N}\\,n\\,k\\right), \\quad k\\in\\{0,1,\\dots,N-1\\}.\n$$\n仅从该定义以及 $\\exp(-j\\,2\\pi)=1$ 这一事实出发，设计一个适用于计算声学应用的、$N=12$ 的混合基 Cooley–Tukey 快速傅里叶变换 (FFT)。使用按时间抽取 (DIT) 的分解方法，其中 $N=N_1 N_2$，并选择 $N_1=3$ 和 $N_2=4$。您的设计必须从第一性原理出发进行推导，通过显式地对 DFT 求和进行重新变址，并论证每一步代数运算的合理性。具体来说，您必须：\n\n- 从变址映射的角度解释 $N=12=3\\times 4$ 这一分解的合理性，并推导通过 $n=n_2+N_2 n_1$ 和 $k=k_1+N_1 k_2$（其中 $n_1\\in\\{0,1,2\\}$，$n_2\\in\\{0,1,2,3\\}$，$k_1\\in\\{0,1,2\\}$，$k_2\\in\\{0,1,2,3\\}$）对 DFT 重新变址所隐含的级联结构。\n- 識別並推导在较小的 DFT 之间出现的级联旋转因子的精确表达式，并用 $N$ 次单位原根的幂来表示它们。\n- 清晰地描述这种 DIT 混合基分解所导致的数据置换（输入分组和输出变址映射），包括如何从分解后的计算中获得自然顺序的输出 $X[0],X[1],\\dots,X[11]$。\n\n在您完成推导和设计后，计算在您推导的方案下，在旋转因子相乘阶段，对应于 $n_2=3$ 和 $k_1=2$ 的分支上乘以中间数据的特定旋转因子。将您的最终答案表示为一个精确的复数。不要在最终答案框中提供任何中间值；只提供该旋转因子的唯一精确值。若有角度，必须以弧度为单位。无需四舍五入。",
            "solution": "题目要求推导一个针对长度为 $N=12$ 的信号的混合基 Cooley-Tukey 快速傅里叶变换 (FFT)，使用按时间抽取 (DIT) 的分解方法，其中 $N=N_1 N_2$，$N_1=3$，$N_2=4$。\n\n长度为 $N$ 的离散傅里叶变换 (DFT) 定义如下：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi}{N} nk\\right)\n$$\n对于 $k \\in \\{0, 1, \\dots, N-1\\}$。让我们将 $N$ 次单位原根定义为 $W_N = \\exp(-j \\frac{2\\pi}{N})$。于是 DFT可以写成：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] W_N^{nk}\n$$\n\nCooley-Tukey 算法的核心是将一维求和重新变址为多维求和。对于 $N=12$，我们使用分解 $N=N_1 N_2 = 3 \\times 4$。题目指定了以下变址映射：\n- 时间变址：$n = n_2 + N_2 n_1 = n_2 + 4n_1$，其中 $n_1 \\in \\{0,1,2\\}$，$n_2 \\in \\{0,1,2,3\\}$。\n- 频率变址：$k = k_1 + N_1 k_2 = k_1 + 3k_2$，其中 $k_1 \\in \\{0,1,2\\}$，$k_2 \\in \\{0,1,2,3\\}$。\n\n很容易验证这些映射是唯一的双射。对于任意 $n \\in \\{0, \\dots, 11\\}$，存在唯一的数对 $(n_1, n_2)$，其中 $n_1 = \\lfloor n/4 \\rfloor$，$n_2 = n \\pmod 4$。同样地，对于任意 $k \\in \\{0, \\dots, 11\\}$，存在唯一的数对 $(k_1, k_2)$，其中 $k_1 = k \\pmod 3$，$k_2 = \\lfloor k/3 \\rfloor$。\n\n将这些映射代入 DFT 定义，关于 $n$ 的求和变成了关于 $n_1$ 和 $n_2$ 的双重求和：\n$$\nX[k_1+3k_2] = \\sum_{n_1=0}^{2} \\sum_{n_2=0}^{3} x[n_2+4n_1] W_{12}^{(n_2+4n_1)(k_1+3k_2)}\n$$\n单位根的指数可以展开为：\n$$\n(n_2+4n_1)(k_1+3k_2) = n_2 k_1 + 3n_2 k_2 + 4n_1 k_1 + 12n_1 k_2\n$$\n这使我们可以分解 $W_{12}$ 项：\n$$\nW_{12}^{(n_2+4n_1)(k_1+3k_2)} = W_{12}^{n_2 k_1} W_{12}^{3n_2 k_2} W_{12}^{4n_1 k_1} W_{12}^{12n_1 k_2}\n$$\n我们利用性质 $W_N^{m} = W_{N/k}^{m/k}$ 以及给定的恒等式 $\\exp(-j2\\pi)=1$ (这意味着 $W_N^N = 1$) 来简化这些因子中的每一项。\n- $W_{12}^{12n_1 k_2} = (W_{12}^{12})^{n_1 k_2} = 1^{n_1 k_2} = 1$。\n- $W_{12}^{3n_2 k_2} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 3n_2 k_2\\right) = \\exp\\left(-j \\frac{2\\pi}{4} n_2 k_2\\right) = W_4^{n_2 k_2}$。\n- $W_{12}^{4n_1 k_1} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 4n_1 k_1\\right) = \\exp\\left(-j \\frac{2\\pi}{3} n_1 k_1\\right) = W_3^{n_1 k_1}$。\n$W_{12}^{n_2 k_1}$ 项不能以这种方式简化，它将作为“旋转因子”。\n\n将这些代回到 DFT 求和式中：\n$$\nX[k_1+3k_2] = \\sum_{n_1=0}^{2} \\sum_{n_2=0}^{3} x[n_2+4n_1] W_{12}^{n_2 k_1} W_4^{n_2 k_2} W_3^{n_1 k_1}\n$$\n由于求和极限是独立的，我们可以重新排列求和顺序。按求和变址对各项进行分组：\n$$\nX[k_1+3k_2] = \\sum_{n_2=0}^{3} \\left[ \\left( \\sum_{n_1=0}^{2} x[n_2+4n_1] W_3^{n_1 k_1} \\right) W_{12}^{n_2 k_1} \\right] W_4^{n_2 k_2}\n$$\n这个表达式揭示了 DIT-FFT 算法的级联结构。\n\n1.  **第一级：长度为 3 的 DFT。** 内层求和，\n    $$\n    G[k_1, n_2] = \\sum_{n_1=0}^{2} x[n_2+4n_1] W_3^{n_1 k_1}\n    $$\n    是一个长度为 3 的 DFT。这个计算对 $n_2 \\in \\{0,1,2,3\\}$ 的每个值都要执行一次。时间变址映射 $n=n_2+4n_1$ 根据输入样本 $x[n]$ 的变址模 4（即 $n_2$）对其进行分组。这种输入样本的分组是按时间抽取的定义特征。具体来说，我们对以下输入子序列计算 $N_2=4$ 个长度为 $N_1=3$ 的 DFT：\n    - 对于 $n_2=0$: $\\{x[0], x[4], x[8]\\}$\n    - 对于 $n_2=1$: $\\{x[1], x[5], x[9]\\}$\n    - 对于 $n_2=2$: $\\{x[2], x[6], x[10]\\}$\n    - 对于 $n_2=3$: $\\{x[3], x[7], x[11]\\}$\n\n2.  **旋转因子相乘。** 在计算完第一级 DFT 后，结果 $G[k_1, n_2]$ 乘以旋转因子 $W_{12}^{n_2 k_1}$。\n    $$\n    H[k_1, n_2] = G[k_1, n_2] \\cdot W_{12}^{n_2 k_1}\n    $$\n    这些因子是复相位旋转，它们将后续的 DFT 级联起来。旋转因子既依赖于第一级的输出变址（$k_1$），也依赖于输入子序列的变址（$n_2$）。\n\n3.  **第二级：长度为 4 的 DFT。** 将 $H[k_1, n_2]$ 代回主表达式得到：\n    $$\n    X[k_1+3k_2] = \\sum_{n_2=0}^{3} H[k_1, n_2] W_4^{n_2 k_2}\n    $$\n    对于 $k_1 \\in \\{0,1,2\\}$ 的每个值，这个求和是关于变址 $n_2$ 对序列 $H[k_1, n_2]$ 进行的长度为 4 的 DFT。这构成了 $N_1=3$ 个长度为 $N_2=4$ 的 DFT。这一级的输出是最终的 DFT 系数集，但顺序是打乱的。\n\n输出变址映射由 $k = k_1+3k_2$ 给出。设计算得到的二维结果数组为 $Y[k_1, k_2] = X[k_1+3k_2]$。为了获得自然顺序的输出序列 $X[0], X[1], \\dots, X[11]$，必须对 $Y$ 中的值进行解序。对于一个给定的自然顺序变址 $k \\in \\{0, \\dots, 11\\}$，相应的变址 $(k_1, k_2)$ 通过 $k_1 = k \\pmod 3$ 和 $k_2 = \\lfloor k/3 \\rfloor$ 找到。因此，自然顺序的输出通过置换 $X[k] = Y[k \\pmod 3, \\lfloor k/3 \\rfloor]$ 恢复。\n\n最后，我们计算在旋转因子相乘阶段，对应于 $n_2=3$ 和 $k_1=2$ 的分支上乘以中间数据的特定旋转因子。旋转因子的一般表达式为 $W_{12}^{n_2 k_1}$。\n代入给定的值 $n_2=3$ 和 $k_1=2$：\n$$\n\\text{旋转因子} = W_{12}^{3 \\times 2} = W_{12}^{6}\n$$\n我们计算这个复数：\n$$\nW_{12}^{6} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 6\\right) = \\exp(-j\\pi)\n$$\n使用欧拉公式 $\\exp(-j\\theta) = \\cos(\\theta) - j\\sin(\\theta)$:\n$$\n\\exp(-j\\pi) = \\cos(\\pi) - j\\sin(\\pi) = -1 - j(0) = -1\n$$\n因此，这个特定的旋转因子是 $-1$。",
            "answer": "$$\\boxed{-1}$$"
        }
    ]
}