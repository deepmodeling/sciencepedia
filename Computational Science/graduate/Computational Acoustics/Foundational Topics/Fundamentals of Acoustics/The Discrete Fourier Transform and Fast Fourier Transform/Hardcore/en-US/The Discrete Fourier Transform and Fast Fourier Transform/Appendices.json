{
    "hands_on_practices": [
        {
            "introduction": "The Fast Fourier Transform (FFT) is not a different transform from the DFT, but rather a family of highly efficient algorithms for its computation. To truly grasp its power, it is essential to look under the hood and see how it cleverly exploits the symmetries of the DFT definition. This practice guides you through a first-principles derivation of a mixed-radix Cooley-Tukey FFT algorithm, breaking a large transform into smaller, more manageable pieces and revealing the origin of the famous \"butterfly\" computations and \"twiddle factors\" .",
            "id": "4140860",
            "problem": "Consider the length-$N$ Discrete Fourier Transform (DFT) defined by\n$$\nX[k] \\;=\\; \\sum_{n=0}^{N-1} x[n] \\,\\exp\\!\\left(-j\\,\\frac{2\\pi}{N}\\,n\\,k\\right), \\quad k\\in\\{0,1,\\dots,N-1\\}.\n$$\nStarting only from this definition and the fact that $\\exp(-j\\,2\\pi)=1$, design a mixed-radix Cooley–Tukey Fast Fourier Transform (FFT) for $N=12$ suitable for computational acoustics applications. Use a decimation-in-time (DIT) factorization with $N=N_1 N_2$, choosing $N_1=3$ and $N_2=4$. Your design must be derived from first principles by explicitly reindexing the DFT sum and justifying each algebraic step. In particular, you must:\n\n- Justify the factorization $N=12=3\\times 4$ in terms of index mappings, and derive the stage-wise structure implied by reindexing the DFT with $n=n_2+N_2 n_1$ and $k=k_1+N_1 k_2$, where $n_1\\in\\{0,1,2\\}$, $n_2\\in\\{0,1,2,3\\}$, $k_1\\in\\{0,1,2\\}$, and $k_2\\in\\{0,1,2,3\\}$.\n- Identify and derive the exact expressions for the stage-wise twiddle factors that arise between the smaller DFTs, stating them in terms of powers of the primitive $N$th root of unity.\n- Clearly describe the data permutations (input grouping and output index mapping) that this DIT mixed-radix factorization induces, including how to obtain natural-order outputs $X[0],X[1],\\dots,X[11]$ from the factorized computation.\n\nAfter you complete the derivation and layout, evaluate the specific twiddle factor that multiplies the intermediate data at the twiddle-multiplication stage for the branch corresponding to $n_2=3$ and $k_1=2$ under your derived scheme. Express your final answer as an exact complex number. Do not provide any intermediate values in the final answer box; only provide the single exact value of that twiddle factor. Angles, if any, must be understood in radians. No rounding is required.",
            "solution": "The problem requires the derivation of a mixed-radix Cooley-Tukey Fast Fourier Transform (FFT) for a signal of length $N=12$, using a decimation-in-time (DIT) factorization with $N=N_1 N_2$, where $N_1=3$ and $N_2=4$.\n\nThe length-$N$ Discrete Fourier Transform (DFT) is defined as:\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi}{N} nk\\right)\n$$\nfor $k \\in \\{0, 1, \\dots, N-1\\}$. Let us define the primitive $N$th root of unity as $W_N = \\exp(-j \\frac{2\\pi}{N})$. The DFT can then be written as:\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] W_N^{nk}\n$$\n\nThe core of the Cooley-Tukey algorithm is to re-index the one-dimensional sum into a multi-dimensional sum. For $N=12$, we use the factorization $N=N_1 N_2 = 3 \\times 4$. The problem specifies the following index mappings:\n- Time index: $n = n_2 + N_2 n_1 = n_2 + 4n_1$, where $n_1 \\in \\{0,1,2\\}$ and $n_2 \\in \\{0,1,2,3\\}$.\n- Frequency index: $k = k_1 + N_1 k_2 = k_1 + 3k_2$, where $k_1 \\in \\{0,1,2\\}$ and $k_2 \\in \\{0,1,2,3\\}$.\n\nIt is straightforward to verify that these mappings are unique bijections. For any $n \\in \\{0, \\dots, 11\\}$, there is a unique pair $(n_1, n_2)$ with $n_1 = \\lfloor n/4 \\rfloor$ and $n_2 = n \\pmod 4$. Similarly, for any $k \\in \\{0, \\dots, 11\\}$, there exists a unique pair $(k_1, k_2)$ with $k_1 = k \\pmod 3$ and $k_2 = \\lfloor k/3 \\rfloor$.\n\nSubstituting these mappings into the DFT definition, the sum over $n$ becomes a double summation over $n_1$ and $n_2$:\n$$\nX[k_1+3k_2] = \\sum_{n_1=0}^{2} \\sum_{n_2=0}^{3} x[n_2+4n_1] W_{12}^{(n_2+4n_1)(k_1+3k_2)}\n$$\nThe exponent of the root of unity can be expanded:\n$$\n(n_2+4n_1)(k_1+3k_2) = n_2 k_1 + 3n_2 k_2 + 4n_1 k_1 + 12n_1 k_2\n$$\nThis allows us to decompose the $W_{12}$ term:\n$$\nW_{12}^{(n_2+4n_1)(k_1+3k_2)} = W_{12}^{n_2 k_1} W_{12}^{3n_2 k_2} W_{12}^{4n_1 k_1} W_{12}^{12n_1 k_2}\n$$\nWe simplify each of these factors using the property $W_N^{m} = W_{N/k}^{m/k}$ and the given identity $\\exp(-j2\\pi)=1$, which implies $W_N^N = 1$.\n- $W_{12}^{12n_1 k_2} = (W_{12}^{12})^{n_1 k_2} = 1^{n_1 k_2} = 1$.\n- $W_{12}^{3n_2 k_2} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 3n_2 k_2\\right) = \\exp\\left(-j \\frac{2\\pi}{4} n_2 k_2\\right) = W_4^{n_2 k_2}$.\n- $W_{12}^{4n_1 k_1} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 4n_1 k_1\\right) = \\exp\\left(-j \\frac{2\\pi}{3} n_1 k_1\\right) = W_3^{n_1 k_1}$.\nThe term $W_{12}^{n_2 k_1}$ does not simplify in this manner and will serve as the \"twiddle factor\".\n\nSubstituting these back into the DFT summation:\n$$\nX[k_1+3k_2] = \\sum_{n_1=0}^{2} \\sum_{n_2=0}^{3} x[n_2+4n_1] W_{12}^{n_2 k_1} W_4^{n_2 k_2} W_3^{n_1 k_1}\n$$\nWe can rearrange the order of summation, as the limits are independent. Grouping terms by the summation index:\n$$\nX[k_1+3k_2] = \\sum_{n_2=0}^{3} \\left[ \\left( \\sum_{n_1=0}^{2} x[n_2+4n_1] W_3^{n_1 k_1} \\right) W_{12}^{n_2 k_1} \\right] W_4^{n_2 k_2}\n$$\nThis expression reveals the stage-wise structure of the DIT-FFT algorithm.\n\n1.  **Stage 1: Length-3 DFTs.** The inner sum,\n    $$\n    G[k_1, n_2] = \\sum_{n_1=0}^{2} x[n_2+4n_1] W_3^{n_1 k_1}\n    $$\n    is a length-$3$ DFT. This computation is performed for each value of $n_2 \\in \\{0,1,2,3\\}$. The time index mapping $n=n_2+4n_1$ groups the input samples $x[n]$ based on their index modulo $4$, which is $n_2$. This grouping of input samples is the defining characteristic of decimation-in-time. Specifically, we compute $N_2=4$ DFTs of length $N_1=3$ on the following input subsequences:\n    - For $n_2=0$: $\\{x[0], x[4], x[8]\\}$\n    - For $n_2=1$: $\\{x[1], x[5], x[9]\\}$\n    - For $n_2=2$: $\\{x[2], x[6], x[10]\\}$\n    - For $n_2=3$: $\\{x[3], x[7], x[11]\\}$\n\n2.  **Twiddle Factor Multiplication.** After computing the first stage of DFTs, the results $G[k_1, n_2]$ are multiplied by the twiddle factors $W_{12}^{n_2 k_1}$.\n    $$\n    H[k_1, n_2] = G[k_1, n_2] \\cdot W_{12}^{n_2 k_1}\n    $$\n    These factors are complex phase rotations that couple the subsequent DFT stages. The factors depend on both the output index of the first stage ($k_1$) and the input subsequence index ($n_2$).\n\n3.  **Stage 2: Length-4 DFTs.** Substituting $H[k_1, n_2]$ back into the main expression gives:\n    $$\n    X[k_1+3k_2] = \\sum_{n_2=0}^{3} H[k_1, n_2] W_4^{n_2 k_2}\n    $$\n    For each value of $k_1 \\in \\{0,1,2\\}$, this sum is a length-$4$ DFT of the sequence $H[k_1, n_2]$ with respect to the index $n_2$. This constitutes $N_1=3$ DFTs of length $N_2=4$. The output of this stage is the final set of DFT coefficients, but in a scrambled order.\n\nThe output index mapping is given by $k = k_1+3k_2$. Let the computed 2D array of results be $Y[k_1, k_2] = X[k_1+3k_2]$. To obtain the naturally ordered output sequence $X[0], X[1], \\dots, X[11]$, one must unscramble the values from $Y$. For a given natural order index $k \\in \\{0, \\dots, 11\\}$, the corresponding indices $(k_1, k_2)$ are found by $k_1 = k \\pmod 3$ and $k_2 = \\lfloor k/3 \\rfloor$. The natural-order output is thus recovered by the permutation $X[k] = Y[k \\pmod 3, \\lfloor k/3 \\rfloor]$.\n\nFinally, we evaluate the specific twiddle factor that multiplies the intermediate data at the twiddle-multiplication stage for the branch corresponding to $n_2=3$ and $k_1=2$. The general expression for the twiddle factor is $W_{12}^{n_2 k_1}$.\nSubstituting the given values $n_2=3$ and $k_1=2$:\n$$\n\\text{Twiddle Factor} = W_{12}^{3 \\times 2} = W_{12}^{6}\n$$\nWe evaluate this complex number:\n$$\nW_{12}^{6} = \\exp\\left(-j \\frac{2\\pi}{12} \\cdot 6\\right) = \\exp(-j\\pi)\n$$\nUsing Euler's formula, $\\exp(-j\\theta) = \\cos(\\theta) - j\\sin(\\theta)$:\n$$\n\\exp(-j\\pi) = \\cos(\\pi) - j\\sin(\\pi) = -1 - j(0) = -1\n$$\nThus, the specific twiddle factor is $-1$.",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "While the FFT provides a computationally efficient path to the frequency domain, the analysis is performed on a finite-duration signal, a process equivalent to applying a window. This windowing introduces artifacts, most notably spectral leakage and the \"picket-fence effect,\" where a tone's energy is spread across multiple bins and its peak may not align with a DFT bin center. This exercise provides a hands-on derivation to quantify the maximum amplitude error, known as scalloping loss, for the simplest case of a rectangular window, giving you a tangible measure of this fundamental limitation .",
            "id": "4140828",
            "problem": "An acoustic laboratory records a narrowband plane-wave pressure signal with sampling frequency sufficiently high to neglect aliasing. Over a finite observation of $N$ samples, the data are multiplied by a rectangular analysis window (equal to $1$ for $n=0,1,\\dots,N-1$ and $0$ otherwise), and the spectrum is computed via the Discrete Fourier Transform (DFT), implemented numerically by the Fast Fourier Transform (FFT). Consider the discrete-time complex sinusoid $x[n] = A \\exp\\!\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$ captured by the sensor, where $A \\in \\mathbb{C}$ is the complex amplitude, $k_{0} \\in \\mathbb{Z}$ denotes an integer DFT bin index, and $\\delta \\in \\mathbb{R}$ is a fractional bin offset. Assume $|\\delta| \\leq \\tfrac{1}{2}$ so that $k_{0}$ is the nearest bin.\n\nDefine the scalloping loss for a given window as the dimensionless amplitude ratio between the magnitude of the DFT at the nearest bin when the sinusoid’s frequency is at a half-bin offset ($\\delta = \\tfrac{1}{2}$) and the magnitude of the DFT at the bin center ($\\delta = 0$), both evaluated at bin $k_{0}$. Starting only from the DFT definition\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-j \\frac{2\\pi k n}{N}\\right),\n$$\nderive a closed-form analytic expression for the scalloping loss for the rectangular window as a function of $N$. Then determine its asymptotic value as $N \\to \\infty$. Express the final scalloping loss as a single exact, dimensionless number (no units). No rounding is required for the final reported value.",
            "solution": "The derivation begins with the definition of the DFT. The signal is a complex sinusoid $x[n] = A \\exp\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$, captured over $N$ samples and multiplied by a rectangular window. This windowing means we only consider the signal for the discrete-time index $n$ from $0$ to $N-1$. The DFT, $X[k]$, is given by:\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\nSubstituting the expression for $x[n]$:\n$$\nX[k] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\nWe need to evaluate the spectrum at the nearest integer bin index, $k=k_0$.\n$$\nX[k_0] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k_0 n}{N}\\right)\n$$\nCombining the exponents yields:\n$$\nX[k_0] = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (k_0 + \\delta - k_0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi \\delta n}{N}\\right)\n$$\nThis is a geometric series of the form $\\sum_{n=0}^{N-1} r^n$ with common ratio $r = \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)$. Using the sum formula for a finite geometric series, $\\frac{1-r^N}{1-r}$, we get:\n$$\nX[k_0] = A \\frac{1 - \\left(\\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)\\right)^N}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)} = A \\frac{1 - \\exp(j 2\\pi \\delta)}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)}\n$$\nTo find the magnitude $|X[k_0]|$, we use the identity $|1 - \\exp(j\\theta)| = | e^{j\\theta/2} (e^{-j\\theta/2} - e^{j\\theta/2}) | = |-2j e^{j\\theta/2} \\sin(\\frac{\\theta}{2})| = 2|\\sin(\\frac{\\theta}{2})|$. Applying this to the numerator and denominator:\n$$\n|X[k_0]| = |A| \\frac{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2}\\right)\\right|}{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2N}\\right)\\right|} = |A| \\frac{|\\sin(\\pi\\delta)|}{|\\sin(\\frac{\\pi\\delta}{N})|}\n$$\nThis is the general expression for the magnitude at bin $k_0$ as a function of the fractional bin offset $\\delta$.\n\nScalloping loss is defined as the ratio of the magnitude at $\\delta = \\frac{1}{2}$ to the magnitude at $\\delta=0$. We evaluate each case.\n\nCase 1: Bin-center frequency, $\\delta=0$.\nIn this case, the signal frequency aligns perfectly with a DFT bin. One could take the limit of the above expression as $\\delta \\to 0$, but it is more direct to return to the summation:\n$$\nX[k_0]|_{\\delta=0} = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp(0) = A \\sum_{n=0}^{N-1} 1 = AN\n$$\nThe magnitude is therefore:\n$$\n|X[k_0]|_{\\delta=0} = |A|N\n$$\n\nCase 2: Half-bin offset, $\\delta=\\frac{1}{2}$.\nThis represents the worst-case scenario for frequency mismatch. We substitute $\\delta=\\frac{1}{2}$ into the general magnitude expression. Given $|\\delta| \\leq \\frac{1}{2}$, this is the maximum offset.\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{|\\sin(\\pi \\cdot \\frac{1}{2})|}{|\\sin(\\frac{\\pi \\cdot \\frac{1}{2}}{N})|} = |A| \\frac{|\\sin(\\frac{\\pi}{2})|}{|\\sin(\\frac{\\pi}{2N})|}\n$$\nSince $\\sin(\\frac{\\pi}{2}) = 1$ and for any $N \\geq 1$, $\\frac{\\pi}{2N} \\in (0, \\frac{\\pi}{2}]$, $\\sin(\\frac{\\pi}{2N})$ is positive. Thus, the absolute value bars can be removed.\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}\n$$\nThe scalloping loss, $S_L$, is the ratio of these two magnitudes:\n$$\nS_L(N) = \\frac{|X[k_0]|_{\\delta=1/2}}{|X[k_0]|_{\\delta=0}} = \\frac{|A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}}{|A|N} = \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\nThis is the closed-form expression for the scalloping loss for a rectangular window as a function of $N$.\n\nThe final step is to determine the asymptotic value as $N \\to \\infty$. We compute the limit:\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} S_L(N) = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\nAs $N \\to \\infty$, the argument of the sine function, $\\theta = \\frac{\\pi}{2N}$, approaches $0$. We use the fundamental trigonometric limit $\\lim_{\\theta\\to 0} \\frac{\\sin(\\theta)}{\\theta} = 1$. Let's rearrange our expression to use this limit.\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})} = \\lim_{N\\to\\infty} \\frac{1}{N \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N} \\cdot \\frac{\\pi}{2N}}\n$$\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{N\\pi}{2N} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{\\pi}{2} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}}\n$$\nSince $\\frac{\\pi}{2N} \\to 0$ as $N \\to \\infty$, the term $\\frac{\\sin(\\pi/2N)}{\\pi/2N}$ approaches $1$.\n$$\nS_{L, \\infty} = \\frac{1}{\\frac{\\pi}{2} \\cdot 1} = \\frac{2}{\\pi}\n$$\nThe asymptotic value of the scalloping loss for a rectangular window is $\\frac{2}{\\pi}$. This dimensionless value is approximately $0.6366$, which corresponds to a loss of about $3.92$ decibels.",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi}}\n$$"
        },
        {
            "introduction": "The scalloping loss and frequency quantization inherent in the DFT are not insurmountable limitations but engineering challenges that can be addressed with clever post-processing. When high-precision frequency estimation is required, we can interpolate the spectrum between the discrete DFT bins to find a more accurate peak location. This practice demonstrates a common and effective method—quadratic interpolation—using the magnitude of the three points around a spectral peak to refine a frequency estimate well beyond the native resolution of the FFT grid .",
            "id": "4140831",
            "problem": "An acoustic laboratory uses a calibrated narrowband source to generate a steady sinusoidal pressure tone at true frequency $f_{0}$ that is not an integer multiple of the discrete Fourier transform (DFT) bin spacing. A single-channel microphone signal is sampled at rate $f_{s}$ for $N$ samples and pre-multiplied by a Hann window before computing the DFT using a Fast Fourier Transform (FFT) algorithm. Assume a noise-free, single-tone condition and that the windowed magnitude spectrum near the dominant peak is locally smooth and unimodal.\n\nYou are given the following parameters and observations:\n- Sampling rate $f_{s} = 48000 \\ \\mathrm{Hz}$.\n- DFT length $N = 4096$.\n- True tone frequency $f_{0} = 1000.73 \\ \\mathrm{Hz}$.\n- The magnitude spectrum $|X[k]|$ is normalized such that the dominant bin magnitude is $1.0$. Around the peak bin $k_{p}$, the three-point neighborhood magnitudes are observed to be\n  $|X[k_{p}-1]| = 0.50$, $|X[k_{p}]| = 1.00$, and $|X[k_{p}+1]| = 0.94$.\n\nStarting only from the definition of the discrete Fourier transform and the meaning of its frequency bin spacing, proceed as follows:\n1. Determine the nearest integer bin index $k_{\\mathrm{near}}$ corresponding to $f_{0}$, and the signed frequency estimation error $e_{0}$ incurred by quantizing $f_{0}$ to that bin’s center frequency. Use the bin spacing implied by $f_{s}$ and $N$.\n2. Using the assumption that the magnitude spectrum in the immediate neighborhood of its maximum is locally well-approximated by a second-order polynomial in the bin index, derive a sub-bin peak location estimate by fitting a quadratic to the three adjacent magnitude samples $\\{|X[k_{p}-1]|, |X[k_{p}]|, |X[k_{p}+1]|\\}$. From this sub-bin location, construct a corrected frequency estimate $\\hat{f}$.\n\nReport only the final corrected frequency estimate $\\hat{f}$, expressed in $\\mathrm{Hz}$ and rounded to six significant figures.",
            "solution": "The core objects are the discrete Fourier transform (DFT) and its interpretation. For a sequence $x[n]$ of length $N$, the DFT is\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\, w[n] \\, \\exp\\!\\left(-\\mathrm{j} \\, 2\\pi \\, \\frac{k n}{N}\\right),\n$$\nwhere $w[n]$ is the Hann window. The DFT maps uniformly sampled time-domain data to uniformly spaced frequency bins. The fundamental frequency spacing of the DFT is\n$$\n\\Delta f = \\frac{f_{s}}{N}.\n$$\nA pure tone at frequency $f_{0}$ that does not coincide with an integer multiple of $\\Delta f$ will not align with an integer bin. The nearest bin index is the integer closest to\n$$\nk_{0} = \\frac{f_{0}}{\\Delta f} = \\frac{f_{0} N}{f_{s}},\n$$\nand the bin center frequency for bin $k$ is $f_{k} = k \\, \\Delta f$.\n\nStep 1: Nearest bin and quantization error.\nFirst compute the bin spacing using the given sampling rate and DFT length:\n$$\n\\Delta f = \\frac{f_{s}}{N} = \\frac{48000}{4096} = 11.71875.\n$$\nThe non-integer bin index corresponding to $f_{0}$ is\n$$\nk_{0} = \\frac{f_{0}}{\\Delta f} = \\frac{1000.73}{11.71875}.\n$$\nTo determine $k_{\\mathrm{near}} = \\mathrm{round}(k_{0})$, it is enough to compare $f_{0}$ with nearby bin center frequencies. The bin centers for $k=85$ and $k=86$ are\n$$\nf_{85} = 85 \\times 11.71875 = 996.09375, \\quad f_{86} = 86 \\times 11.71875 = 1007.8125.\n$$\nCompute absolute differences:\n$$\n|f_{0} - f_{85}| = |1000.73 - 996.09375| = 4.63625, \\quad |f_{0} - f_{86}| = |1000.73 - 1007.8125| = 7.0825.\n$$\nThus the nearest bin is\n$$\nk_{\\mathrm{near}} = 85,\n$$\nwith the signed quantization error\n$$\ne_{0} = f_{0} - f_{85} = 1000.73 - 996.09375 = 4.63625.\n$$\n\nStep 2: Sub-bin peak estimation by quadratic interpolation.\nThe Hann window’s mainlobe is smooth; near the maximum, the magnitude spectrum can be well-approximated locally by a second-order polynomial in bin index. We model the magnitudes at the three adjacent bins as samples of a quadratic\n$$\ny(n) = a \\, n^{2} + b \\, n + c\n$$\nabout the peak bin $k_{p}$, with $n \\in \\{-1,0,+1\\}$ corresponding to $\\{k_{p}-1, k_{p}, k_{p}+1\\}$. Let\n$$\nM_{-} = |X[k_{p}-1]|, \\quad M_{0} = |X[k_{p}]|, \\quad M_{+} = |X[k_{p}+1]|.\n$$\nWe are given $M_{-} = 0.50$, $M_{0} = 1.00$, $M_{+} = 0.94$. Solving\n$$\ny(-1) = a - b + c = M_{-}, \\quad y(0) = c = M_{0}, \\quad y(+1) = a + b + c = M_{+},\n$$\nwe obtain\n$$\na = \\frac{M_{+} + M_{-} - 2 M_{0}}{2}, \\quad b = \\frac{M_{+} - M_{-}}{2}, \\quad c = M_{0}.\n$$\nThe vertex location of the parabola relative to $n=0$ (i.e., relative to bin $k_{p}$) is\n$$\n\\delta = -\\frac{b}{2a} = - \\frac{\\frac{1}{2}(M_{+} - M_{-})}{2 \\cdot \\frac{1}{2}(M_{+} + M_{-} - 2 M_{0})} = \\frac{M_{-} - M_{+}}{2 \\, (M_{-} - 2 M_{0} + M_{+})}.\n$$\nSubstitute the measured magnitudes:\n$$\n\\delta = \\frac{0.50 - 0.94}{2 \\, (0.50 - 2 \\cdot 1.00 + 0.94)} = \\frac{-0.44}{2 \\cdot (-0.56)} = \\frac{-0.44}{-1.12} = 0.392857142857\\ldots\n$$\nThis $\\delta$ is the fractional-bin offset of the interpolated peak location to the right of $k_{p}$. Therefore, the sub-bin frequency estimate is\n$$\n\\hat{f} = (k_{p} + \\delta) \\, \\Delta f.\n$$\nHere $k_{p} = k_{\\mathrm{near}} = 85$ and $\\Delta f = 11.71875$, so\n$$\n\\hat{f} = (85 + 0.392857142857\\ldots) \\times 11.71875.\n$$\nCompute the product by decomposing:\n$$\n85 \\times 11.71875 = 996.09375, \\quad 0.392857142857\\ldots \\times 11.71875 = \\frac{11}{28} \\times 11.71875 = \\frac{11 \\times 11.71875}{28} = \\frac{128.90625}{28} = 4.603794642857\\ldots\n$$\nThus\n$$\n\\hat{f} = 996.09375 + 4.603794642857\\ldots = 1000.697544642857\\ldots\n$$\nRounded to six significant figures as required,\n$$\n\\hat{f} \\approx 1000.70.\n$$",
            "answer": "$$\\boxed{1000.70}$$"
        }
    ]
}