{
    "hands_on_practices": [
        {
            "introduction": "The speed of sound is not a constant in Earth's atmosphere; it varies significantly with temperature, which in turn changes with altitude. This practice  provides a foundational exercise in atmospheric acoustics by guiding you through the derivation and implementation of a sound speed profile. Starting from first principles like the ideal gas law and hydrostatic balance, you will build a model that accounts for the temperature lapse rate defined by the International Standard Atmosphere (ISA) and incorporates the important effects of humidity.",
            "id": "4122536",
            "problem": "You are asked to derive, implement, and evaluate the speed of sound in air as a function of altitude under International Standard Atmosphere (ISA) conditions using a thermodynamically consistent equation of state and the definition of sound speed from first principles, then systematically quantify deviations introduced by humidity and variable gas composition. Your derivation and implementation must start from fundamental laws and definitions only, without shortcut formulas being provided in the problem statement. The task must be executed in the lower troposphere under a standard lapse-rate model.\n\nRequirements and assumptions:\n- Work within the altitude range $0 \\le z \\le 11000$ measured in meters, where the ISA adopts a constant temperature lapse rate.\n- Use hydrostatic balance, ideal gas behavior, and the thermodynamic definition of sound speed at constant entropy to derive the dry-air expression and its humid-air extension.\n- Model water vapor as an ideal gas and air as a binary ideal gas mixture of dry air and water vapor with composition set by relative humidity (RH).\n- Compute the saturation vapor pressure of water as a function of temperature using a well-tested empirical correlation. You may select a correlation of comparable accuracy to widely used standards; your solution must clearly state and implement the chosen correlation and ensure unit consistency.\n- Adopt the following constants (treated as well-tested values):\n  - Standard gravitational acceleration $g_0 = 9.80665$ in $\\mathrm{m/s^2}$.\n  - Sea-level temperature $T_0 = 288.15$ in $\\mathrm{K}$.\n  - Sea-level pressure $p_0 = 101325$ in $\\mathrm{Pa}$.\n  - Tropospheric lapse rate $L = -0.0065$ in $\\mathrm{K/m}$.\n  - Specific gas constant for dry air $R_d = 287.052$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Specific gas constant for water vapor $R_v = 461.522$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Constant-pressure specific heat for dry air $c_{p,d} = 1004.685$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Constant-pressure specific heat for water vapor $c_{p,v} = 1859.0$ in $\\mathrm{J/(kg\\cdot K)}$.\n- Limit attention to $z \\le 11000$ so that temperature is $T(z) = T_0 + L z$ and pressure is obtained by consistent integration of hydrostatic balance with ideal gas behavior for the dry reference atmosphere.\n\nTasks:\n1. Starting from the thermodynamic definition of speed of sound, the ideal gas equation of state, hydrostatic balance, and the ISA temperature structure, derive a dry-air expression for the speed of sound as a function of altitude $z$ in meters. Express the final speed of sound in meters per second.\n2. Extend the derivation to a humid mixture of dry air and water vapor, treating both as ideal gases and using mixture rules appropriate for specific heats and specific gas constants. Use relative humidity to determine the water vapor partial pressure via an empirically accurate saturation vapor pressure correlation. Derive the mixture sound speed at altitude $z$ in meters and relative humidity $\\mathrm{RH}$ (decimal fraction in $[0,1]$). Express the final speed of sound in meters per second.\n3. Implement your derivations in a complete, runnable program that:\n   - Computes the ISA temperature $T(z)$ in Kelvin and pressure $p(z)$ in Pascal for $0 \\le z \\le 11000$.\n   - Computes the water vapor saturation vapor pressure $e_s(T)$ in Pascal from temperature in Kelvin using a correlation of Arden Buck type or equivalent accuracy, applying the correlation over liquid water for $T \\ge 273.15\\,\\mathrm{K}$ and over ice for $T < 273.15\\,\\mathrm{K}$.\n   - Computes the vapor partial pressure $e = \\mathrm{RH} \\cdot e_s(T)$ in Pascal, enforcing $0 \\le e < p(z)$.\n   - Computes the mixing ratio $r = \\epsilon \\, e/(p-e)$ with $\\epsilon = R_d/R_v$, and the mass fractions $Y_v = r/(1+r)$ and $Y_d = 1 - Y_v$.\n   - Computes mixture properties $R_{\\mathrm{mix}} = Y_d R_d + Y_v R_v$, $c_{p,\\mathrm{mix}} = Y_d c_{p,d} + Y_v c_{p,v}$, and $c_{v,\\mathrm{mix}} = c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}$, then evaluates the speed of sound in the mixture at $(z,\\mathrm{RH})$.\n   - Computes the dry-air speed of sound using dry-air properties for the same $T(z)$.\n   - Returns, for each test case, a list with two floats: dry-air speed of sound and humid-air speed of sound at the specified $(z,\\mathrm{RH})$, each in $\\mathrm{m/s}$, rounded to three decimals.\n\nPhysical units and output specification:\n- Altitude $z$ is in meters.\n- Temperature $T$ must be computed in Kelvin.\n- Pressure $p$ and all partial pressures must be in Pascal.\n- The speed of sound must be expressed in $\\mathrm{m/s}$, rounded to three decimals.\n- Relative humidity $\\mathrm{RH}$ must be a decimal fraction in $[0,1]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain one entry per test case, where each entry is the two-element list described above. For example, the printed output should look like $[[c_{1,\\mathrm{dry}},c_{1,\\mathrm{humid}}],[c_{2,\\mathrm{dry}},c_{2,\\mathrm{humid}}],\\ldots]$ with numerical values in place of the symbols.\n\nTest suite:\nUsing the above model and constants, evaluate the following test cases to exercise normal operation, humidity extremes, and boundary conditions:\n- Case $1$: $z = 0$, $\\mathrm{RH} = 0.0$.\n- Case $2$: $z = 0$, $\\mathrm{RH} = 0.9$.\n- Case $3$: $z = 5000$, $\\mathrm{RH} = 1.0$.\n- Case $4$: $z = 11000$, $\\mathrm{RH} = 0.5$.\n\nYour program must compute and print $[[c_{1,\\mathrm{dry}},c_{1,\\mathrm{humid}}],[c_{2,\\mathrm{dry}},c_{2,\\mathrm{humid}}],[c_{3,\\mathrm{dry}},c_{3,\\mathrm{humid}}],[c_{4,\\mathrm{dry}},c_{4,\\mathrm{humid}}]]$ with each $c$ in $\\mathrm{m/s}$, rounded to three decimals.",
            "solution": "The problem is assessed as valid, as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The problem requires the derivation and implementation of the speed of sound in air as a function of altitude, for both dry and humid conditions, based on first principles of thermodynamics and fluid mechanics within the International Standard Atmosphere (ISA) model.\n\nThe solution proceeds in three main parts:\n1. Derivation of the speed of sound in dry air as a function of altitude.\n2. Derivation of the pressure-altitude relation in the ISA model.\n3. Extension of the derivation to humid air, accounting for mixture effects.\n\n**1. Speed of Sound in an Ideal Gas**\n\nThe speed of sound, $c$, is defined as the propagation speed of an infinitesimal pressure disturbance through a medium. For a fluid, it is given by the square root of the isentropic bulk modulus, which is expressed as the partial derivative of pressure with respect to density at constant entropy $s$:\n$$\nc^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s\n$$\nFor an ideal gas, the equation of state is $p = \\rho R T$, where $p$ is the pressure, $\\rho$ is the density, $T$ is the absolute temperature, and $R$ is the specific gas constant.\nAn isentropic (reversible and adiabatic) process for an ideal gas follows the relation $p \\rho^{-\\gamma} = \\text{constant}$, where $\\gamma = c_p/c_v$ is the heat capacity ratio, with $c_p$ and $c_v$ being the specific heats at constant pressure and constant volume, respectively.\n\nFrom $p = K \\rho^\\gamma$ for some constant $K$, we can take the derivative:\n$$\n\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\gamma K \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^\\gamma} \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho}\n$$\nSubstituting this into the definition of sound speed and using the ideal gas law ($p/\\rho = RT$):\n$$\nc^2 = \\gamma \\frac{p}{\\rho} = \\gamma R T\n$$\nThus, the speed of sound in an ideal gas is:\n$$\nc = \\sqrt{\\gamma R T}\n$$\nThis fundamental result shows that for a given ideal gas (fixed $\\gamma$ and $R$), the speed of sound depends only on the absolute temperature $T$.\n\n**2. Application to Dry Air in the ISA Troposphere**\n\nFor dry air, we use the specific gas constant for dry air, $R_d$, and the heat capacity ratio for dry air, $\\gamma_d$. The problem provides $R_d = 287.052 \\, \\mathrm{J/(kg\\cdot K)}$ and the constant-pressure specific heat $c_{p,d} = 1004.685 \\, \\mathrm{J/(kg\\cdot K)}$.\nFor an ideal gas, Mayer's relation holds: $c_{p,d} - c_{v,d} = R_d$. We can find $c_{v,d}$:\n$$\nc_{v,d} = c_{p,d} - R_d = 1004.685 - 287.052 = 717.633 \\, \\mathrm{J/(kg\\cdot K)}\n$$\nThe heat capacity ratio for dry air is then:\n$$\n\\gamma_d = \\frac{c_{p,d}}{c_{v,d}} = \\frac{1004.685}{717.633} \\approx 1.4000\n$$\nThe International Standard Atmosphere (ISA) model defines a linear temperature profile in the troposphere (for altitude $z \\le 11000 \\, \\mathrm{m}$):\n$$\nT(z) = T_0 + L z\n$$\nwhere $T_0 = 288.15 \\, \\mathrm{K}$ is the sea-level temperature and $L = -0.0065 \\, \\mathrm{K/m}$ is the tropospheric lapse rate.\nThe speed of sound in dry air as a function of altitude $z$ is therefore:\n$$\nc_d(z) = \\sqrt{\\gamma_d R_d T(z)} = \\sqrt{\\gamma_d R_d (T_0 + L z)}\n$$\n\n**3. ISA Pressure Profile**\n\nTo analyze humid air, we need the total atmospheric pressure $p(z)$. This is found by integrating the hydrostatic balance equation, assuming the atmosphere is in equilibrium:\n$$\n\\frac{dp}{dz} = -\\rho g_0\n$$\nwhere $g_0 = 9.80665 \\, \\mathrm{m/s^2}$ is the standard gravitational acceleration. The ISA model uses the dry air equation of state, $\\rho = p/(R_d T)$, to define the reference pressure profile. Substituting this and the temperature profile $T(z) = T_0 + Lz$ into the hydrostatic equation:\n$$\n\\frac{dp}{dz} = - \\frac{p g_0}{R_d (T_0 + L z)} \\implies \\frac{dp}{p} = -\\frac{g_0}{R_d L} \\frac{L \\, dz}{T_0 + L z}\n$$\nIntegrating from sea level ($z=0$, $p=p_0=101325 \\, \\mathrm{Pa}$) to an altitude $z$:\n$$\n\\int_{p_0}^{p(z)} \\frac{dp'}{p'} = -\\frac{g_0}{R_d L} \\int_0^z \\frac{L \\, dz'}{T_0 + L z'}\n$$\n$$\n\\ln\\left(\\frac{p(z)}{p_0}\\right) = -\\frac{g_0}{R_d L} \\ln\\left(\\frac{T_0 + L z}{T_0}\\right) = \\ln\\left[ \\left(\\frac{T(z)}{T_0}\\right)^{-g_0 / (R_d L)} \\right]\n$$\nThis yields the standard ISA pressure-altitude relation for the troposphere:\n$$\np(z) = p_0 \\left( \\frac{T(z)}{T_0} \\right)^{-g_0 / (R_d L)} = p_0 \\left(1 + \\frac{L z}{T_0}\\right)^{-g_0 / (R_d L)}\n$$\n\n**4. Speed of Sound in Humid Air**\n\nHumid air is a mixture of dry air and water vapor. We model it as a binary ideal gas mixture. The speed of sound in the mixture is given by $c_h = \\sqrt{\\gamma_{\\mathrm{mix}} R_{\\mathrm{mix}} T(z)}$. We must determine the mixture properties $R_{\\mathrm{mix}}$ and $\\gamma_{\\mathrm{mix}}$.\n\nThe composition of the mixture is determined by the relative humidity, $\\mathrm{RH}$, which relates the partial pressure of water vapor, $e$, to the saturation vapor pressure, $e_s(T)$:\n$$\ne = \\mathrm{RH} \\cdot e_s(T)\n$$\nThe saturation vapor pressure $e_s$ is a strong function of temperature. As per the problem specification, we use an accurate empirical correlation of the Arden Buck type. The 1996 Buck equations are chosen for their accuracy. The pressure is in Pascals, and temperature $T$ is in Kelvin. Let $T_C = T - 273.15$ be the temperature in Celsius.\n\nFor $T \\ge 273.15 \\, \\mathrm{K}$ (saturation over liquid water):\n$$\ne_s(T) = 611.21 \\exp \\left( \\frac{(18.678 - T_C/234.5) T_C}{T_C + 257.14} \\right)\n$$\nFor $T < 273.15 \\, \\mathrm{K}$ (saturation over ice):\n$$\ne_s(T) = 611.15 \\exp \\left( \\frac{(23.036 - T_C/333.7) T_C}{T_C + 279.82} \\right)\n$$\nThe partial pressure of dry air is $p_d = p(z) - e$. We define the mixing ratio, $r$, as the mass of water vapor per unit mass of dry air:\n$$\nr = \\frac{m_v}{m_d} = \\frac{\\rho_v}{\\rho_d} = \\frac{e/(R_v T)}{(p_d)/(R_d T)} = \\frac{e/(R_v T)}{(p-e)/(R_d T)} = \\frac{R_d}{R_v} \\frac{e}{p-e}\n$$\nLetting $\\epsilon = R_d/R_v = 287.052 / 461.522 \\approx 0.622$, we have $r = \\epsilon \\frac{e}{p-e}$.\n\nThe mass fractions of water vapor ($Y_v$) and dry air ($Y_d$) are:\n$$\nY_v = \\frac{m_v}{m_d + m_v} = \\frac{m_v/m_d}{1 + m_v/m_d} = \\frac{r}{1+r}\n$$\n$$\nY_d = \\frac{m_d}{m_d + m_v} = \\frac{1}{1 + m_v/m_d} = \\frac{1}{1+r} = 1 - Y_v\n$$\nThe mixture properties are found by mass-fraction weighting:\n$$\nR_{\\mathrm{mix}} = Y_d R_d + Y_v R_v\n$$\n$$\nc_{p,\\mathrm{mix}} = Y_d c_{p,d} + Y_v c_{p,v}\n$$\nwhere $R_v = 461.522 \\, \\mathrm{J/(kg\\cdot K)}$ and $c_{p,v} = 1859.0 \\, \\mathrm{J/(kg\\cdot K)}$ are given.\nUsing Mayer's relation for the mixture, $c_{v,\\mathrm{mix}} = c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}$. The heat capacity ratio for the mixture is:\n$$\n\\gamma_{\\mathrm{mix}} = \\frac{c_{p,\\mathrm{mix}}}{c_{v,\\mathrm{mix}}} = \\frac{c_{p,\\mathrm{mix}}}{c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}}\n$$\nFinally, the speed of sound in humid air at altitude $z$ and relative humidity $\\mathrm{RH}$ is:\n$$\nc_h(z, \\mathrm{RH}) = \\sqrt{\\gamma_{\\mathrm{mix}} R_{\\mathrm{mix}} T(z)}\n$$\nThis expression, along with the preceding steps, provides the complete model for computation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the speed of sound in dry and humid air under ISA conditions\n    based on derivations from first principles.\n    \"\"\"\n\n    # --- Givens: Constants and ISA Parameters ---\n    g0 = 9.80665      # Standard gravitational acceleration [m/s^2]\n    T0 = 288.15       # Sea-level standard temperature [K]\n    p0 = 101325.0     # Sea-level standard pressure [Pa]\n    L = -0.0065       # Tropospheric lapse rate [K/m]\n    R_d = 287.052     # Specific gas constant for dry air [J/(kg.K)]\n    R_v = 461.522     # Specific gas constant for water vapor [J/(kg.K)]\n    cp_d = 1004.685   # Constant-pressure specific heat for dry air [J/(kg.K)]\n    cp_v = 1859.0     # Constant-pressure specific heat for water vapor [J/(kg.K)]\n    \n    # --- Derived Dry Air Properties ---\n    # Heat capacity at constant volume for dry air\n    cv_d = cp_d - R_d\n    # Heat capacity ratio for dry air\n    gamma_d = cp_d / cv_d\n    \n    # --- Helper Functions ---\n    def get_isa_temp(z):\n        \"\"\"Computes ISA temperature at altitude z.\"\"\"\n        return T0 + L * z\n\n    def get_isa_pressure(z, temp):\n        \"\"\"Computes ISA pressure at altitude z.\"\"\"\n        # This formula is only valid for L != 0\n        return p0 * (temp / T0)**(-g0 / (R_d * L))\n\n    def get_saturation_vapor_pressure(T):\n        \"\"\"\n        Computes saturation vapor pressure using the Arden Buck (1996) equations.\n        T is temperature in Kelvin. Returns pressure in Pascals.\n        \"\"\"\n        T_C = T - 273.15  # Temperature in Celsius\n\n        if T_C >= 0:\n            # Saturation vapor pressure over liquid water\n            es = 611.21 * np.exp((18.678 - T_C / 234.5) * (T_C / (257.14 + T_C)))\n        else:\n            # Saturation vapor pressure over ice\n            es = 611.15 * np.exp((23.036 - T_C / 333.7) * (T_C / (279.82 + T_C)))\n        return es\n\n    def calculate_sound_speeds(z, RH):\n        \"\"\"\n        Calculates and returns the speed of sound for dry and humid air.\n        z: altitude [m]\n        RH: relative humidity [0, 1]\n        \"\"\"\n        # --- ISA Conditions at Altitude z ---\n        T_z = get_isa_temp(z)\n        p_z = get_isa_pressure(z, T_z)\n\n        # --- Task 1: Dry Air Sound Speed ---\n        c_dry = np.sqrt(gamma_d * R_d * T_z)\n        \n        # --- Task 2: Humid Air Sound Speed ---\n        if RH == 0.0:\n            c_humid = c_dry\n        else:\n            # Calculate vapor pressure\n            e_s = get_saturation_vapor_pressure(T_z)\n            e = RH * e_s\n            \n            # Constraint check: vapor pressure cannot exceed total pressure\n            if e >= p_z:\n                # This physical state implies 100% water vapor or supersaturation\n                # in a way that displaces all air, which is not the model's intent.\n                # For this problem, we cap 'e' to be slightly less than 'p_z'\n                # to avoid division by zero, though test cases do not trigger this.\n                e = p_z * 0.999999\n\n            # Calculate mixing ratio\n            epsilon = R_d / R_v\n            # Avoid division by zero if p_z == e\n            if p_z - e = 0:\n                # Under this extreme, physically unlikely condition, the atmosphere is \n                # pure water vapor. We'll model it as such.\n                r = np.inf\n            else:\n                r = epsilon * e / (p_z - e)\n\n            # Calculate mass fractions\n            if np.isinf(r):\n                Y_v = 1.0\n            else:\n                Y_v = r / (1.0 + r)\n            Y_d = 1.0 - Y_v\n\n            # Calculate mixture properties\n            R_mix = Y_d * R_d + Y_v * R_v\n            cp_mix = Y_d * cp_d + Y_v * cp_v\n            cv_mix = cp_mix - R_mix\n            gamma_mix = cp_mix / cv_mix\n            \n            c_humid = np.sqrt(gamma_mix * R_mix * T_z)\n            \n        return [round(c_dry, 3), round(c_humid, 3)]\n\n    # --- Test Suite ---\n    test_cases = [\n        (0.0, 0.0),       # Case 1: z = 0, RH = 0.0\n        (0.0, 0.9),       # Case 2: z = 0, RH = 0.9\n        (5000.0, 1.0),    # Case 3: z = 5000, RH = 1.0\n        (11000.0, 0.5)    # Case 4: z = 11000, RH = 0.5\n    ]\n\n    results = []\n    for z, RH in test_cases:\n        result = calculate_sound_speeds(z, RH)\n        results.append(result)\n\n    # --- Print Final Output ---\n    # The str() of a list is used to get the inner bracket formatting.\n    # The top-level format is a string of these list strings, comma-separated.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the ideal gas law is effective for many atmospheric applications, engineering and scientific problems often involve fluids near their condensation point or at high pressures where intermolecular forces are significant. In this practice , we move beyond ideal gases to the Peng-Robinson cubic equation of state, a powerful model that describes both liquid and vapor phases. You will develop a complete computational workflow to find the sound speed, tackling the real-world challenges of solving for fluid properties and ensuring your calculations remain numerically stable near phase boundaries.",
            "id": "4122488",
            "problem": "You are tasked with designing and implementing a complete computational workflow to evaluate the sound speed $c$ for a pure fluid modeled by a cubic Equation of State (EOS) inside an acoustics solver. The workflow must include (i) robust root-finding for the specific volume $v$ at given pressure $p$ and temperature $T$, (ii) symbolic derivative evaluation needed for thermodynamic response functions, and (iii) a numerically stable fallback strategy near phase boundaries where derivatives become ill-conditioned. Your implementation must be a single runnable program that produces results for the provided test suite.\n\nFundamental base and definitions to use:\n- The Peng–Robinson (PR) cubic Equation of State (EOS) for a single component fluid is given in the form\n$$\np(T,v) = \\frac{R T}{v - b} - \\frac{a(T)}{v^2 + 2 b v - b^2},\n$$\nwhere $R$ is the universal gas constant, $T$ is the temperature, $v$ is the molar specific volume, and $a(T)$ and $b$ are EOS parameters defined from critical properties and acentric factor.\n- The Peng–Robinson EOS parameters are computed from the fluid’s critical temperature $T_c$, critical pressure $p_c$, and acentric factor $\\omega$:\n$$\na_c = 0.45724 \\frac{R^2 T_c^2}{p_c}, \\quad b = 0.07780 \\frac{R T_c}{p_c},\n$$\n$$\n\\kappa = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2, \\quad \\alpha(T) = \\left( 1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right) \\right)^2,\n$$\n$$\na(T) = a_c \\,\\alpha(T).\n$$\n- The compressibility factor $Z$ is related to the molar volume by $Z = \\frac{p v}{R T}$. For the Peng–Robinson EOS, $Z$ satisfies the cubic polynomial\n$$\nZ^3 - (1 - B) Z^2 + (A - 3 B^2 - 2 B) Z - (A B - B^2 - B^3) = 0,\n$$\nwhere $A = \\frac{a(T) p}{R^2 T^2}$ and $B = \\frac{b p}{R T}$.\n- The isothermal compressibility $\\kappa_T$ and thermal expansion coefficient $\\alpha$ are defined by\n$$\n\\kappa_T = -\\frac{1}{v}\\left( \\frac{\\partial v}{\\partial p} \\right)_T, \\quad \\alpha = \\frac{1}{v}\\left( \\frac{\\partial v}{\\partial T} \\right)_p.\n$$\n- The difference between specific heat at constant pressure $c_p$ and specific heat at constant volume $c_v$ (both expressed per unit mass) is given by\n$$\nc_p - c_v = \\frac{T \\alpha^2 v_{\\text{mass}}}{\\kappa_T},\n$$\nwhere $v_{\\text{mass}}$ is the mass-specific volume and is related to molar volume by $v_{\\text{mass}} = \\frac{v}{M}$ with $M$ the molar mass. Note that $\\kappa_T$ and $\\alpha$ are invariant between molar and mass-specific bases, provided they are computed consistently.\n- The isentropic compressibility $\\kappa_S$ can be expressed as\n$$\n\\kappa_S = \\kappa_T - \\frac{\\alpha^2 T v_{\\text{mass}}}{c_p},\n$$\nand the isentropic sound speed is\n$$\nc^2 = \\frac{1}{\\rho \\kappa_S} = \\frac{v_{\\text{mass}}}{\\kappa_S},\n$$\nwhere $\\rho = \\frac{1}{v_{\\text{mass}}}$ is the mass density.\n\nDerivative evaluations required:\n- The denominator in the attractive term is $D(v,b) = v^2 + 2 b v - b^2$.\n- The needed partial derivatives at constant composition are\n$$\n\\left( \\frac{\\partial p}{\\partial v} \\right)_T = -\\frac{R T}{(v - b)^2} + a(T) \\frac{2 v + 2 b}{D(v,b)^2},\n$$\n$$\n\\left( \\frac{\\partial p}{\\partial T} \\right)_v = \\frac{R}{v - b} - \\frac{a'(T)}{D(v,b)},\n$$\nwhere $a'(T) = \\frac{d a(T)}{d T} = a_c \\alpha'(T)$ and\n$$\n\\alpha'(T) = -\\frac{\\kappa}{T_c \\sqrt{T/T_c}} \\left( 1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right) \\right).\n$$\nFrom the total differential $dp = \\left( \\frac{\\partial p}{\\partial T} \\right)_v dT + \\left( \\frac{\\partial p}{\\partial v} \\right)_T dv$, deduce\n$$\n\\left( \\frac{\\partial v}{\\partial T} \\right)_p = - \\frac{ \\left( \\frac{\\partial p}{\\partial T} \\right)_v }{ \\left( \\frac{\\partial p}{\\partial v} \\right)_T }, \\quad \\left( \\frac{\\partial v}{\\partial p} \\right)_T = \\frac{1}{ \\left( \\frac{\\partial p}{\\partial v} \\right)_T }.\n$$\n\nRoot-finding and fallback requirements:\n- Given $p$ and $T$, you must solve for the molar volume $v$ either by solving the cubic polynomial for $Z$ and mapping to $v = \\frac{Z R T}{p}$, or by direct root-finding on $p(T,v) - p = 0$ if the polynomial solution is unphysical or numerically unstable.\n- When the cubic yields three real roots, choose the physically relevant phase by selecting either the smallest real root for the liquid branch or the largest real root for the vapor branch. Ensure the selected $v$ satisfies $v  b$.\n- Implement a robust bracketing and bisection fallback on $p(T,v) - p = 0$ if the cubic solver fails or yields $v \\le b$, using monotonicity on the chosen branch. For vapor, use $v \\in (b, v_{\\max})$ with $v_{\\max}$ increased adaptively until $p(T,v_{\\max})  p$. For liquid, use $v \\in (b, v_{\\max})$ with $v_{\\max}$ increased until $p(T,v_{\\max})  p$.\n- Near phase boundaries or critical conditions where $\\left( \\frac{\\partial p}{\\partial v} \\right)_T \\approx 0$ or $\\kappa_S \\le 0$, you must apply a numerically stable fallback by setting $\\kappa_S \\leftarrow \\kappa_T$ and computing the isothermal estimate $c_T^2 = \\frac{v_{\\text{mass}}}{\\kappa_T}$ to avoid non-physical or undefined values.\n\nImplementation inputs and constants:\n- Use the universal gas constant $R = 8.314462618 \\, \\mathrm{J/(mol\\cdot K)}$.\n- Fluid property sets to be used:\n    1. Methane: $T_c = 190.564 \\, \\mathrm{K}$, $p_c = 4.5992 \\times 10^6 \\, \\mathrm{Pa}$, $\\omega = 0.01142$, $M = 0.01604 \\, \\mathrm{kg/mol}$, $c_v = 1700 \\, \\mathrm{J/(kg\\cdot K)}$.\n    2. Carbon dioxide: $T_c = 304.1282 \\, \\mathrm{K}$, $p_c = 7.3773 \\times 10^6 \\, \\mathrm{Pa}$, $\\omega = 0.22394$, $M = 0.04401 \\, \\mathrm{kg/mol}$, $c_v = 655 \\, \\mathrm{J/(kg\\cdot K)}$.\n\nTest suite:\n- Case 1 (happy path vapor): methane at $p = 1.0 \\times 10^6$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$, vapor branch.\n- Case 2 (subcritical liquid, multiple roots expected): carbon dioxide at $p = 6.0 \\times 10^6$ $\\mathrm{Pa}$, $T = 280$ $\\mathrm{K}$, liquid branch.\n- Case 3 (near critical vapor, derivative fallback likely): carbon dioxide at $p = 7.0 \\times 10^6$ $\\mathrm{Pa}$, $T = 304$ $\\mathrm{K}$, vapor branch.\n\nRequired outputs:\n- For each case, compute the sound speed $c$ in $\\mathrm{m/s}$ using the isentropic formulation with the fallback rule when necessary.\n- Your program must produce a single line containing a comma-separated list of the three results enclosed in square brackets, in the order of the test cases, expressed as floats in $\\mathrm{m/s}$ and rounded to six decimal places, for example, $[c_1,c_2,c_3]$.\n\nAngle units do not apply. Percentages must not be used. All physical units to be used within the calculations are the ones explicitly stated above; the final values must be in $\\mathrm{m/s}$.\n\nYour program must be self-contained and must not require any inputs. It must implement the complete workflow described, including robust root selection, derivative evaluation, and stability-preserving fallback near phase boundaries.",
            "solution": "The problem requires the design and implementation of a computational workflow to determine the speed of sound, $c$, in a pure fluid described by the Peng–Robinson (PR) Equation of State (EOS). The solution involves a sequence of steps: first, determining the fluid's molar volume, $v$, at a given pressure, $p$, and temperature, $T$; second, calculating the necessary thermodynamic derivatives; and third, computing the sound speed using a formulation that includes a numerically stable fallback for near-critical or two-phase boundary conditions.\n\nThe overall approach is to encapsulate the physical model and computational logic for a given fluid within a structured program. For each test case, we will instantiate this model with the specified fluid properties ($T_c$, $p_c$, $\\omega$, $M$, $c_v$) and then execute the calculation for the given state ($p$, $T$, and phase).\n\nFirst, we determine the fluid-specific and temperature-dependent parameters of the PR EOS. The universal gas constant is $R = 8.314462618 \\, \\mathrm{J/(mol\\cdot K)}$. The parameters $a_c$ and $b$ are constants for a given fluid, derived from its critical temperature, $T_c$, and critical pressure, $p_c$:\n$$\na_c = 0.45724 \\frac{R^2 T_c^2}{p_c}, \\quad b = 0.07780 \\frac{R T_c}{p_c}\n$$\nThe attractive term parameter, $a(T)$, depends on temperature through the function $\\alpha_{\\text{eos}}(T)$:\n$$\na(T) = a_c \\alpha_{\\text{eos}}(T)\n$$\nwhere $\\alpha_{\\text{eos}}(T)$ is defined using the fluid's acentric factor, $\\omega$:\n$$\n\\alpha_{\\text{eos}}(T) = \\left( 1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right) \\right)^2, \\quad \\text{with} \\quad \\kappa = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2\n$$\n\nSecond, we determine the molar volume $v$. The PR EOS is a cubic equation in $v$, but it is more convenient to solve its equivalent form as a cubic polynomial in the compressibility factor, $Z = \\frac{pv}{RT}$. The polynomial is given by:\n$$\nZ^3 - (1 - B) Z^2 + (A - 3 B^2 - 2 B) Z - (A B - B^2 - B^3) = 0\n$$\nwhere $A$ and $B$ are dimensionless groups:\n$$\nA = \\frac{a(T) p}{R^2 T^2}, \\quad B = \\frac{b p}{R T}\n$$\nFor a given state ($p$, $T$), we compute $A$ and $B$ and solve this cubic polynomial for $Z$. The roots can be real or complex. We consider only the real roots, as complex roots lack physical meaning. For each real root $Z_{real}$, we calculate the corresponding molar volume $v = \\frac{Z_{real} R T}{p}$. A volume is physically valid only if it is greater than the excluded volume parameter, $v  b$.\nIf multiple valid real roots exist (typically in the subcritical, two-phase region), the problem specifies a selection criterion: the smallest volume corresponds to the liquid phase, while the largest volume corresponds to the vapor phase. The intermediate root represents an unstable state and is discarded. Based on the specified phase ('liquid' or 'vapor') for each test case, we select the appropriate volume $v$.\n\nThird, we evaluate the necessary thermodynamic derivatives. The sound speed calculation relies on response functions derived from partial derivatives of the EOS. The required derivatives of pressure $p$ with respect to volume $v$ at constant temperature $T$, and with respect to temperature $T$ at constant volume $v$, are:\n$$\n\\left( \\frac{\\partial p}{\\partial v} \\right)_T = -\\frac{R T}{(v - b)^2} + a(T) \\frac{2 v + 2 b}{(v^2 + 2 b v - b^2)^2}\n$$\n$$\n\\left( \\frac{\\partial p}{\\partial T} \\right)_v = \\frac{R}{v - b} - \\frac{a'(T)}{v^2 + 2 b v - b^2}\n$$\nwhere $a'(T) = \\frac{da(T)}{dT}$ is the derivative of the attraction parameter with respect to temperature:\n$$\na'(T) = a_c \\alpha'_{\\text{eos}}(T), \\quad \\text{with} \\quad \\alpha'_{\\text{eos}}(T) = -\\frac{\\kappa}{\\sqrt{T T_c}} \\left( 1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right) \\right)\n$$\nFrom these, we can find the derivatives of volume using standard identities:\n$$\n\\left( \\frac{\\partial v}{\\partial p} \\right)_T = \\frac{1}{ \\left( \\frac{\\partial p}{\\partial v} \\right)_T }, \\quad \\left( \\frac{\\partial v}{\\partial T} \\right)_p = - \\frac{ \\left( \\frac{\\partial p}{\\partial T} \\right)_v }{ \\left( \\frac{\\partial p}{\\partial v} \\right)_T }\n$$\nThese derivatives allow for the calculation of the isothermal compressibility, $\\kappa_T$, and the thermal expansion coefficient, $\\alpha_p$:\n$$\n\\kappa_T = -\\frac{1}{v}\\left( \\frac{\\partial v}{\\partial p} \\right)_T = -\\frac{1}{v \\left( \\frac{\\partial p}{\\partial v} \\right)_T}, \\quad \\alpha_p = \\frac{1}{v}\\left( \\frac{\\partial v}{\\partial T} \\right)_p = -\\frac{\\left( \\frac{\\partial p}{\\partial T} \\right)_v}{v \\left( \\frac{\\partial p}{\\partial v} \\right)_T}\n$$\n\nFourth, we calculate the speed of sound, implementing the specified fallback logic. The calculation requires the mass-specific heat capacity at constant pressure, $c_p$. We obtain this from the provided mass-specific heat capacity at constant volume, $c_v$, using the standard thermodynamic relation:\n$$\nc_p - c_v = \\frac{T \\alpha_p^2 v_{\\text{mass}}}{\\kappa_T}\n$$\nwhere $v_{\\text{mass}} = v/M$ is the mass-specific volume, with $M$ being the molar mass. This gives $c_p = c_v + T \\alpha_p^2 v_{\\text{mass}} / \\kappa_T$.\n\nThe isentropic compressibility, $\\kappa_S$, is then found using:\n$$\n\\kappa_S = \\kappa_T - \\frac{\\alpha_p^2 T v_{\\text{mass}}}{c_p}\n$$\nFinally, the isentropic speed of sound, $c$, is given by:\n$$\nc^2 = \\frac{v_{\\text{mass}}}{\\kappa_S}\n$$\nThe problem demands a robust fallback for conditions where this calculation may become unstable, specifically near critical points or phase boundaries where $(\\partial p / \\partial v)_T \\to 0$. The triggering conditions are when $(\\partial p / \\partial v)_T \\ge 0$ (indicating mechanical instability) or when the calculated $\\kappa_S \\le 0$ (which would lead to an imaginary or infinite sound speed). If either of these conditions is met, the calculation defaults to the isothermal sound speed, $c_T$, defined by:\n$$\nc_T^2 = \\frac{v_{\\text{mass}}}{\\kappa_T}\n$$\nThis fallback ensures a physically meaningful, real-valued result even in regions where the isentropic model is ill-conditioned. The final sound speed is $c = \\sqrt{c^2}$.\n\nThe implementation will follow these steps precisely for each test case, yielding a vector of sound speeds which will be formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation of sound speed for the given test suite.\n    \"\"\"\n\n    class PR_Fluid:\n        \"\"\"\n        A class to encapsulate the Peng-Robinson EOS model and related calculations for a pure fluid.\n        \"\"\"\n        R = 8.314462618  # Universal gas constant in J/(mol·K)\n\n        def __init__(self, Tc, pc, omega, M, cv_mass):\n            \"\"\"\n            Initializes the fluid with its critical properties and other constants.\n            \n            Args:\n                Tc (float): Critical temperature (K).\n                pc (float): Critical pressure (Pa).\n                omega (float): Acentric factor.\n                M (float): Molar mass (kg/mol).\n                cv_mass (float): Mass-specific heat at constant volume (J/(kg·K)).\n            \"\"\"\n            self.Tc = Tc\n            self.pc = pc\n            self.omega = omega\n            self.M = M\n            self.cv_mass = cv_mass\n\n            # Pre-calculate constant EOS parameters\n            self.ac = 0.45724 * (self.R**2 * self.Tc**2) / self.pc\n            self.b = 0.07780 * (self.R * self.Tc) / self.pc\n            self.kappa = 0.37464 + 1.54226 * self.omega - 0.26992 * self.omega**2\n\n        def _calculate_state_params(self, T, p):\n            \"\"\"\n            Calculates temperature-dependent parameters for a given state (T, p).\n            \"\"\"\n            Tr = T / self.Tc\n            self.alpha_eos = (1 + self.kappa * (1 - np.sqrt(Tr)))**2\n            self.a_T = self.ac * self.alpha_eos\n            \n            # Dimensionless groups for the Z-polynomial\n            self.A = (self.a_T * p) / (self.R**2 * T**2)\n            self.B = (self.b * p) / (self.R * T)\n\n        def find_volume(self, T, p, phase):\n            \"\"\"\n            Finds the molar volume v by solving the cubic EOS for the compressibility factor Z.\n            Selects the appropriate root based on the specified phase.\n            \"\"\"\n            self._calculate_state_params(T, p)\n\n            # Coefficients of Z^3 + c2*Z^2 + c1*Z + c0 = 0\n            coeffs = [\n                1,\n                self.B - 1,\n                self.A - 3 * self.B**2 - 2 * self.B,\n                -(self.A * self.B - self.B**2 - self.B**3)\n            ]\n            roots = np.roots(coeffs)\n            \n            # Filter for real roots that correspond to physical volumes (v  b)\n            real_roots = roots[np.isreal(roots)].real\n            valid_volumes = []\n            for Z in real_roots:\n                v = Z * self.R * T / p\n                if v > self.b:\n                    valid_volumes.append(v)\n            \n            if not valid_volumes:\n                raise ValueError(f\"No physical root (v > b) found for T={T} K, p={p} Pa.\")\n            \n            if phase == 'liquid':\n                return min(valid_volumes)\n            elif phase == 'vapor':\n                return max(valid_volumes)\n            else:\n                raise ValueError(\"Invalid phase specified. Must be 'liquid' or 'vapor'.\")\n\n        def calculate_sound_speed(self, T, p, phase):\n            \"\"\"\n            Calculates the sound speed with a stability-preserving fallback.\n            \"\"\"\n            v = self.find_volume(T, p, phase)\n\n            # Derivative of the a(T) parameter\n            Tr = T / self.Tc\n            sqrt_alpha_eos = 1 + self.kappa * (1 - np.sqrt(Tr))\n            d_alpha_eos_dT = (-self.kappa / np.sqrt(T * self.Tc)) * sqrt_alpha_eos\n            d_a_T_dT = self.ac * d_alpha_eos_dT\n            \n            # Partial derivatives of pressure\n            D_vb = v**2 + 2*self.b*v - self.b**2\n            dp_dv_T = -(self.R * T) / (v - self.b)**2 + self.a_T * (2*v + 2*self.b) / (D_vb**2)\n            dp_dT_v = self.R / (v - self.b) - d_a_T_dT / D_vb\n            \n            # Response functions\n            kappa_T = -1 / (v * dp_dv_T)\n            alpha_p = -dp_dT_v / (v * dp_dv_T)\n\n            # Mass-specific properties\n            v_mass = v / self.M\n            cp_minus_cv = (T * alpha_p**2 * v_mass) / kappa_T\n            cp_mass = self.cv_mass + cp_minus_cv\n\n            # Isentropic compressibility\n            kappa_S = kappa_T - (alpha_p**2 * T * v_mass) / cp_mass\n\n            # Fallback logic for numerical stability\n            is_unstable = (dp_dv_T >= 0) or (kappa_S = 0)\n\n            if is_unstable:\n                # Use isothermal sound speed as fallback\n                c_squared = v_mass / kappa_T\n            else:\n                # Use isentropic sound speed\n                c_squared = v_mass / kappa_S\n\n            if c_squared  0:\n                # This indicates the state is deep in an unphysical region\n                return np.nan\n            \n            return np.sqrt(c_squared)\n\n    # Define fluid properties from the problem statement\n    methane_props = {\n        'Tc': 190.564, 'pc': 4.5992e6, 'omega': 0.01142, 'M': 0.01604, 'cv_mass': 1700\n    }\n    co2_props = {\n        'Tc': 304.1282, 'pc': 7.3773e6, 'omega': 0.22394, 'M': 0.04401, 'cv_mass': 655\n    }\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        (methane_props, {'p': 1.0e6, 'T': 300, 'phase': 'vapor'}),\n        (co2_props, {'p': 6.0e6, 'T': 280, 'phase': 'liquid'}),\n        (co2_props, {'p': 7.0e6, 'T': 304, 'phase': 'vapor'}),\n    ]\n\n    results = []\n    for fluid_props, state in test_cases:\n        fluid = PR_Fluid(**fluid_props)\n        c = fluid.calculate_sound_speed(**state)\n        results.append(c)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A mathematical model for a physical system is only useful if it respects fundamental physical laws. For any fluid equation of state, a core requirement is that the medium must be mechanically stable, meaning it resists compression. This principle translates directly into a condition on the sound speed: its square, $c^2$, must be positive. This capstone exercise  challenges you to build a validation tool, deriving the stability criterion from thermodynamics and implementing an algorithm to automatically test whether a given parametric EOS produces physically admissible states.",
            "id": "4122520",
            "problem": "Consider the physical requirement in computational acoustics that mechanically stable media must have strictly positive isentropic bulk modulus, which is equivalent to strictly positive squared sound speed. Negative compressibility states are mechanically unstable and therefore inadmissible. Starting only from fundamental thermodynamic definitions and laws, derive a computable test that, given a parametric equation of state (equation of state (EOS)), rejects any parameter set that produces nonpositive squared sound speed in any admissible thermodynamic state.\n\nYou are to work with a parametric pressure law of the form\n$$\np(\\rho,e;\\theta) = (\\gamma - 1)\\,\\rho\\,e \\;-\\; \\gamma\\,p_{\\infty} \\;+\\; K\\Big[\\Big(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\Big)^{m} - 1\\Big],\n$$\nwhere the parameter vector is $\\theta = (\\gamma,p_{\\infty},K,m)$, density is $\\rho$, and specific internal energy is $e$. All quantities must be interpreted in International System of Units (SI): $\\rho$ in $\\mathrm{kg/m^3}$, $e$ in $\\mathrm{J/kg}$, $p$ in $\\mathrm{Pa}$, $p_{\\infty}$ in $\\mathrm{Pa}$, $K$ in $\\mathrm{Pa}$, and $\\rho_{\\mathrm{ref}}$ in $\\mathrm{kg/m^3}$. The speed of sound satisfies the core acoustical definition\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s},\n$$\nand thermodynamics supplies the First Law in differential form\n$$\n\\mathrm{d}e = T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho,\n$$\nwith temperature $T$ and entropy $s$. No additional shortcut formulas are to be assumed in the derivation.\n\nAdmissible states are restricted to the rectangular set\n$$\n\\rho \\in [\\rho_{\\min},\\rho_{\\max}],\\quad e \\in [e_{\\min},e_{\\max}],\n$$\nwith fixed values\n$$\n\\rho_{\\mathrm{ref}} = 1000\\,\\mathrm{kg/m^3},\\quad \\rho_{\\min} = 800\\,\\mathrm{kg/m^3},\\quad \\rho_{\\max} = 1400\\,\\mathrm{kg/m^3},\n$$\nand\n$$\ne_{\\min} = 1.0\\times 10^{6}\\,\\mathrm{J/kg},\\quad e_{\\max} = 5.0\\times 10^{6}\\,\\mathrm{J/kg}.\n$$\n\nTask 1 (derivation): Starting from the two fundamental relations above, derive a computable expression for $c^2$ in terms of $\\rho$, $e$, and partial derivatives of $p(\\rho,e;\\theta)$ with respect to $\\rho$ and $e$ at fixed $e$ and fixed $\\rho$, respectively. Justify why strictly positive $c^2$ over the admissible set is equivalent to strictly positive isentropic bulk modulus and hence positive compressibility.\n\nTask 2 (algorithm design): Using your derived expression, design an algorithm that, given a parameter set $\\theta$, evaluates $c^2(\\rho,e;\\theta)$ over a uniform tensor grid that includes the boundaries of the admissible rectangle, detects whether $c^2 \\le 0$ at any sampled state, and returns a boolean indicating rejection (return $\\,\\mathrm{True}\\,$ if and only if there exists at least one sampled state with $c^2 \\le 0$).\n\nUse a uniform grid with\n$$\nN_{\\rho} = 129,\\quad N_{e} = 129\n$$\npoints in $\\rho$ and $e$, respectively, spanning the closed intervals $[\\rho_{\\min},\\rho_{\\max}]$ and $[e_{\\min},e_{\\max}]$.\n\nTest suite: Apply your algorithm to the following five parameter sets $\\theta_k = (\\gamma,p_{\\infty},K,m)$, $k \\in \\{1,2,3,4,5\\}$:\n- $\\theta_1 = (4.4, 6.0e8, 1.0e9, 2.0)$,\n- $\\theta_2 = (0.8, 1.0e5, 0.0, 2.0)$,\n- $\\theta_3 = (2.0, 1.0e5, -1.0e9, 2.0)$,\n- $\\theta_4 = (1.0001, 0.0, 0.0, 2.0)$,\n- $\\theta_5 = (1.4, 0.0, 1.0e7, 1.1)$.\n\nYour program must:\n- Implement the derived $c^2(\\rho,e;\\theta)$ formula using only partial derivatives of $p(\\rho,e;\\theta)$ with respect to $\\rho$ and $e$, evaluated at fixed $e$ and fixed $\\rho$, respectively.\n- Sample the admissible set on the specified grid and determine, for each $\\theta_k$, whether there exists any sampled $(\\rho,e)$ with $c^2 \\le 0$.\n- Produce a single line of output containing the results for $k=1,2,3,4,5$ as a comma-separated list of booleans enclosed in square brackets, with entries in order of the parameter sets given above. For example, an output with five boolean results must look like\n$$\n[True,False,True,True,False],\n$$\nbut with the actual values computed by your program. No units are required in the output since the answers are booleans.\n\nScientific realism and units: All constants and parameter values are in SI units, and your implementation must adhere to these units internally. The analysis and algorithm must be universally applicable and independent of programming language specifics; however, your final answer must be a complete and runnable Python program as specified below.",
            "solution": "The user has provided a problem in computational acoustics that requires the derivation of a stability criterion and the design of a computational algorithm to test it. The problem is well-posed, scientifically grounded, and contains all necessary information.\n\n### Task 1: Derivation and Justification\n\nThe first task is to derive a computable expression for the squared speed of sound, $c^2$, and to justify the stability criterion $c^2  0$.\n\n**Derivation of the expression for $c^2$**\n\nWe are tasked to find an expression for the squared speed of sound, defined as the isentropic derivative of pressure with respect to density:\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s}\n$$\nThe provided equation of state (EOS) gives pressure $p$ as a function of density $\\rho$ and specific internal energy $e$, i.e., $p = p(\\rho, e)$. The \"natural\" variables for this EOS are $\\rho$ and $e$. Therefore, our goal is to express the derivative at constant entropy $s$, $(\\partial p/\\partial \\rho)_s$, in terms of partial derivatives at constant energy $e$ and constant density $\\rho$, which are $(\\partial p/\\partial \\rho)_e$ and $(\\partial p/\\partial e)_\\rho$, respectively.\n\nWe start with the total differential of pressure, $p(\\rho, e)$:\n$$\n\\mathrm{d}p = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} \\mathrm{d}\\rho + \\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\mathrm{d}e\n$$\nNext, we use the provided differential form of the First Law of Thermodynamics:\n$$\n\\mathrm{d}e = T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho\n$$\nwhere $T$ is temperature and $s$ is specific entropy. This equation relates the differential $\\mathrm{d}e$ to the differentials $\\mathrm{d}s$ and $\\mathrm{d}\\rho$.\n\nWe can substitute the expression for $\\mathrm{d}e$ from the First Law into the total differential of $p$:\n$$\n\\mathrm{d}p = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} \\mathrm{d}\\rho + \\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\bigg(T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho\\bigg)\n$$\nNow, we group the terms by the differentials $\\mathrm{d}\\rho$ and $\\mathrm{d}s$:\n$$\n\\mathrm{d}p = \\left[ \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\right] \\mathrm{d}\\rho + \\left[ T\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\right] \\mathrm{d}s\n$$\nThis expression is the total differential of pressure in terms of $\\rho$ and $s$, i.e., $p(\\rho, s)$. By definition, the partial derivative of $p$ with respect to $\\rho$ at constant $s$ is the coefficient of the $\\mathrm{d}\\rho$ term when $\\mathrm{d}s=0$. From the equation above, this coefficient is:\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s} = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho}\n$$\nTherefore, the computable expression for the squared speed of sound is:\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho}\n$$\nThis expression depends only on $p$, $\\rho$, and the partial derivatives of the given EOS, $p(\\rho, e)$, with respect to its natural variables.\n\n**Justification for Mechanical Stability**\n\nA medium is considered mechanically stable if it resists compression, meaning an infinitesimal increase in pressure results in an infinitesimal decrease in volume (and thus an increase in density). The quantity that measures this resistance is the bulk modulus. For processes that are sufficiently fast, like the propagation of sound, the relevant quantity is the isentropic bulk modulus, $K_s$. It is defined as:\n$$\nK_s = -V \\Big(\\frac{\\partial p}{\\partial V}\\Big)_s\n$$\nwhere $V$ is the volume. For mechanical stability, the medium must become less voluminous when compressed, so we require $(\\partial p/\\partial V)_s  0$, which implies $K_s  0$.\n\nWe can relate the volume $V$ to the density $\\rho$ via the specific volume $v = 1/\\rho$. Using $v$ in place of $V$ (as they are proportional for a fixed mass), we have:\n$$\nK_s = -v \\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = -\\frac{1}{\\rho} \\Big(\\frac{\\partial p}{\\partial v}\\Big)_s\n$$\nUsing the chain rule, we can change the variable of differentiation from $v$ to $\\rho$:\n$$\n\\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s \\Big(\\frac{\\partial \\rho}{\\partial v}\\Big)\n$$\nSince $\\rho = 1/v$, we have $\\mathrm{d}\\rho/\\mathrm{d}v = -1/v^2 = -\\rho^2$. Substituting this into the chain rule expression gives:\n$$\n\\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s (-\\rho^2)\n$$\nNow, we substitute this back into the expression for $K_s$:\n$$\nK_s = -\\frac{1}{\\rho} \\left[ \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s (-\\rho^2) \\right] = \\rho \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s\n$$\nRecalling the definition $c^2 = (\\partial p/\\partial \\rho)_s$, we arrive at the fundamental relationship:\n$$\nK_s = \\rho c^2\n$$\nSince density $\\rho$ must be positive, the condition for mechanical stability, $K_s  0$, is equivalent to the condition $c^2  0$. The isentropic compressibility, $\\beta_s = 1/K_s$, must also be positive. Consequently, any state where $c^2 \\le 0$ is mechanically unstable or marginally stable and therefore physically inadmissible.\n\n### Task 2: Algorithm Design\n\nThe second task is to design an algorithm to test for $c^2 \\le 0$ over a discrete grid of admissible states.\n\n**1. Analytical Partial Derivatives**\n\nFirst, we compute the necessary partial derivatives of the given EOS:\n$$\np(\\rho,e;\\theta) = (\\gamma - 1)\\,\\rho\\,e \\;-\\; \\gamma\\,p_{\\infty} \\;+\\; K\\Big[\\Big(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\Big)^{m} - 1\\Big]\n$$\nThe partial derivative with respect to $e$ at fixed $\\rho$ is:\n$$\n\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} = \\frac{\\partial}{\\partial e} \\left[ (\\gamma - 1)\\rho e - \\gamma p_{\\infty} + K\\left(\\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m - 1\\right) \\right] = (\\gamma - 1)\\rho\n$$\nThe partial derivative with respect to $\\rho$ at fixed $e$ is:\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} = \\frac{\\partial}{\\partial \\rho} \\left[ (\\gamma - 1)\\rho e - \\gamma p_{\\infty} + K\\left(\\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m - 1\\right) \\right] = (\\gamma - 1)e + K \\frac{\\partial}{\\partial \\rho} \\left(\\frac{\\rho^m}{\\rho_{\\mathrm{ref}}^m}\\right)\n$$\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} = (\\gamma - 1)e + \\frac{K m}{\\rho_{\\mathrm{ref}}^m} \\rho^{m-1} = (\\gamma - 1)e + \\frac{K m}{\\rho} \\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m\n$$\n\n**2. Grid-Based Evaluation Algorithm**\n\nThe algorithm tests a given parameter set $\\theta = (\\gamma, p_{\\infty}, K, m)$ for stability.\n\n**Inputs:**\n- Parameter set $\\theta = (\\gamma, p_{\\infty}, K, m)$.\n- Domain boundaries: $\\rho_{\\min}$, $\\rho_{\\max}$, $e_{\\min}$, $e_{\\max}$.\n- Grid resolution: $N_{\\rho}$, $N_{e}$.\n- Reference density: $\\rho_{\\mathrm{ref}}$.\n\n**Procedure:**\n1.  Generate a uniform tensor grid of thermodynamic states. Create a 1D array of $N_{\\rho}$ density points, $\\rho_i$, linearly spaced from $\\rho_{\\min}$ to $\\rho_{\\max}$. Create a 1D array of $N_{e}$ energy points, $e_j$, linearly spaced from $e_{\\min}$ to $e_{\\max}$. This defines a grid of $N_{\\rho} \\times N_{e}$ states $(\\rho_i, e_j)$.\n\n2.  For each point $(\\rho, e)$ on the grid, and for the given $\\theta$:\n    a. Calculate the pressure $p = p(\\rho, e; \\theta)$ using the EOS formula.\n    b. Calculate the partial derivative $(\\partial p/\\partial \\rho)_e$ using its derived formula.\n    c. Calculate the partial derivative $(\\partial p/\\partial e)_\\rho$ using its derived formula.\n    d. Calculate the squared speed of sound $c^2$ using the derived relation: $c^2 = (\\partial p/\\partial \\rho)_e + (p/\\rho^2)(\\partial p/\\partial e)_\\rho$.\n\n3.  Check for instability. After computing $c^2$ for all points on the grid, determine if any of acomputed values are non-positive (i.e., if $\\min(c^2) \\le 0$).\n\n**Output:**\n- Return $\\mathrm{True}$ if there exists at least one grid point $(\\rho, e)$ for which $c^2 \\le 0$.\n- Return $\\mathrm{False}$ if $c^2  0$ for all grid points.\n\nThis procedure can be implemented efficiently using vectorized numerical libraries (like NumPy in Python) by evaluating the formulas on the entire grid of $\\rho$ and $e$ values simultaneously.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_stability_for_params(params: tuple) - bool:\n    \"\"\"\n    Checks a parameter set for mechanical stability over a specified domain.\n\n    The function evaluates the squared speed of sound c^2 on a grid of\n    (density, specific internal energy) states. It returns True if any\n    sampled state has c^2 = 0, indicating a mechanically unstable or\n    marginally stable region is found.\n\n    Args:\n        params: A tuple containing the equation of state parameters\n                (gamma, p_infinity, K, m).\n\n    Returns:\n        A boolean, True if the parameter set is rejected (instability found),\n        False otherwise.\n    \"\"\"\n    # Unpack the parameter vector theta\n    gamma, p_infinity, K, m = params\n\n    # Define fixed physical constants and domain boundaries in SI units\n    rho_ref = 1000.0  # kg/m^3\n    rho_min = 800.0    # kg/m^3\n    rho_max = 1400.0   # kg/m^3\n    e_min = 1.0e6      # J/kg\n    e_max = 5.0e6      # J/kg\n\n    # Define the grid resolution\n    N_rho = 129\n    N_e = 129\n\n    # Create the uniform tensor grid for density (rho) and specific internal energy (e)\n    rho_grid = np.linspace(rho_min, rho_max, N_rho)\n    e_grid = np.linspace(e_min, e_max, N_e)\n    RHO, E = np.meshgrid(rho_grid, e_grid)\n\n    # --- Vectorized calculation over the grid ---\n\n    # 1. Calculate pressure p(RHO, E)\n    # The EOS is: p = (gamma - 1)*rho*e - gamma*p_inf + K*((rho/rho_ref)^m - 1)\n    # Let's compute term by term for clarity.\n    term1 = (gamma - 1.0) * RHO * E\n    term2 = -gamma * p_infinity\n    term3 = K * (np.power(RHO / rho_ref, m) - 1.0)\n    P = term1 + term2 + term3\n\n    # 2. Calculate partial derivative (dp/de)_rho\n    # (dp/de)_rho = (gamma - 1) * rho\n    dp_de_rho = (gamma - 1.0) * RHO\n\n    # 3. Calculate partial derivative (dp/drho)_e\n    # (dp/drho)_e = (gamma - 1)*e + K*m/rho * (rho/rho_ref)^m\n    # The form (gamma - 1)*e + (K * m / rho_ref**m) * rho**(m-1) is better\n    # to avoid potential division by zero if rho could be zero, though not here.\n    dp_drho_e = (gamma - 1.0) * E + (K * m / np.power(rho_ref, m)) * np.power(RHO, m - 1.0)\n    \n    # 4. Calculate squared speed of sound c^2\n    # c^2 = (dp/drho)_e + (p / rho^2) * (dp/de)_rho\n    c_squared = dp_drho_e + (P / np.power(RHO, 2)) * dp_de_rho\n\n    # 5. Check if any value of c^2 is non-positive\n    # The problem requires rejection if c^2 = 0.\n    is_unstable = np.any(c_squared = 0)\n\n    return is_unstable\n\ndef solve():\n    \"\"\"\n    Main function to run stability checks on all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple theta = (gamma, p_infinity, K, m).\n    test_cases = [\n        (4.4, 6.0e8, 1.0e9, 2.0),      # theta_1\n        (0.8, 1.0e5, 0.0, 2.0),       # theta_2\n        (2.0, 1.0e5, -1.0e9, 2.0),     # theta_3\n        (1.0001, 0.0, 0.0, 2.0),      # theta_4\n        (1.4, 0.0, 1.0e7, 1.1)         # theta_5\n    ]\n\n    results = []\n    for case in test_cases:\n        # For each parameter set, check for stability.\n        # The result is True if rejected, False if stable.\n        result = check_stability_for_params(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The problem example shows [True,False,...], which is the default\n    # string representation of booleans in Python.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}