{
    "hands_on_practices": [
        {
            "introduction": "理解波与边界的相互作用是声学的基础。第一个实践练习将引导您从第一性原理出发，推导声硬边界的反射系数 。通过应用入射波和反射波的叠加，您将巩固对如何将物理边界条件转化为数学模型的理解，这是计算声学的一个基石。",
            "id": "4131551",
            "problem": "一个时谐平面声波在质量密度为 $\\rho_{0}$、声速为 $c$ 的均匀无损流体中传播。该流体占据 $z>0$ 的半空间，位于 $z=0$ 的边界是一个无限大的完美刚性（声硬）平面。设声压场采用复相量表示法，其时间依赖性为 $\\exp(-\\mathrm{i}\\omega t)$，其中 $\\omega$ 是角频率，并定义波数 $k=\\omega/c$。入射平面波的复振幅为 $P_{0}$，在 $x$-$z$ 平面内传播，入射角 $\\theta \\in [0,\\pi/2)$ 是从正 $z$ 轴（从边界指向流体内部的外法线）测量的。在流体中没有声源的情况下，总场是入射场和反射场的叠加，每个场都满足齐次亥姆霍兹方程。刚性边界强制实施诺伊曼边界条件，即质点速度的法向分量在 $z=0$ 处为零。\n\n仅使用线性声学的基本原理，即线性化动量方程（欧拉方程）、线性化连续性方程以及无损流体的绝热本构关系，推导复压强反射系数 $R_{p}$。该系数定义为在边界上对所有 $(x,y)$ 满足 $p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$，其中 $p_{i}$ 和 $p_{r}$ 分别表示入射和反射的压强相量。将 $R_{p}$ 表示为关于给定量的单个闭式解析表达式。您的最终答案必须是单个表达式。无需四舍五入，最终方框内的表达式不应包含任何物理单位。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法得当。\n\n**第1步：提取已知条件**\n- 流体：均匀，无损。\n- 流体属性：质量密度 $\\rho_{0}$，声速 $c$。\n- 区域：半空间 $z>0$。\n- 边界：位于 $z=0$ 的无限大完美刚性（声硬）平面。\n- 时间依赖性：相量表示法，时间因子为 $\\exp(-\\mathrm{i}\\omega t)$。\n- 波数：$k=\\omega/c$。\n- 入射波：时谐平面波，复振幅为 $P_{0}$。\n- 传播平面：$x$-$z$ 平面。\n- 入射角：$\\theta \\in [0,\\pi/2)$，从正 $z$ 轴测量。\n- 总场：入射场 ($p_i$) 和反射场 ($p_r$) 的叠加。\n- 控制方程：齐次亥姆霍兹方程。\n- 边界条件：质点速度的法向分量在 $z=0$ 处为零。\n- 反射系数定义：$p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$。\n- 任务：从基本原理（线性化动量方程、连续性方程和本构关系）推导 $R_{p}$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是声学中波反射的经典教科书案例。它基于基本原理：从 Euler 方程和连续性方程推导出的波动方程，以及刚性表面的诺伊曼边界条件。所有方面都已在科学上得到确立。\n- **适定性**：该问题是适定的。几何形状、介质、入射波和边界条件都已明确定义，这足以确定反射场及其反射系数的唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **完整性和一致性**：问题提供了所有必要信息，且不含内部矛盾。刚性边界的定义与质点速度的诺伊曼条件正确关联。\n- **主题相关性**：该问题直接关系到声波传播背景下*刚性（声硬）*表面的*诺伊曼边界条件*的物理意义和数学实现，这是*计算声学*和波物理学的核心主题。\n\n**第3步：结论与行动**\n问题被判定为**有效**。将从指定的基本原理推导出解答。\n\n**反射系数的推导**\n\n推导从无损、均匀、静止流体的线性声学基本方程开始。设 $p(\\mathbf{r}, t)$ 为声压，$\\mathbf{v}(\\mathbf{r}, t)$ 为质点速度，$\\rho(\\mathbf{r}, t)$ 为声密度扰动。\n\n1.  **基本原理与速度-压强关系：**\n    问题要求从线性化动量方程（Euler 方程）和连续性方程开始。\n    - 线性化动量方程：$\\rho_{0} \\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p$。\n    - 线性化连续性方程：$\\frac{\\partial \\rho}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0$。\n    - 绝热本构关系：$p = c^{2}\\rho$。\n\n    对于时间依赖性为 $\\exp(-\\mathrm{i}\\omega t)$ 的时谐场，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $-\\mathrm{i}\\omega$。将此应用于复相量 $p(\\mathbf{r})$ 和 $\\mathbf{v}(\\mathbf{r})$ 的动量方程：\n    $$\n    \\rho_{0} (-\\mathrm{i}\\omega) \\mathbf{v} = -\\nabla p\n    $$\n    这给出了质点速度相量和压强相量之间的关键关系：\n    $$\n    \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\nabla p\n    $$\n    在边界 $z=0$ 处速度的法向分量是 $z$ 分量 $v_z$。边界条件是 $v_z(x,y,0) = 0$。使用上述关系，这变为：\n    $$\n    v_z = \\hat{\\mathbf{z}} \\cdot \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\frac{\\partial p}{\\partial z}\n    $$\n    因此，边界条件 $v_z(x,y,0) = 0$ 等效于压强场的诺伊曼边界条件：\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = 0\n    $$\n\n2.  **入射波与反射波：**\n    入射平面波在 $x$-$z$ 平面内传播，与 $+z$ 轴成 $\\theta$ 角。入射波矢量 $\\mathbf{k}_i$ 必须具有负的 $z$ 分量，以表示向 $z=0$ 边界的传播。$\\mathbf{k}_i$ 的分量为：\n    $$\n    k_{ix} = k \\sin\\theta, \\quad k_{iy} = 0, \\quad k_{iz} = -k \\cos\\theta\n    $$\n    入射压强相量 $p_i$ 由下式给出：\n    $$\n    p_i(x,z) = P_0 \\exp(\\mathrm{i}\\mathbf{k}_i \\cdot \\mathbf{r}) = P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z))\n    $$\n    对于反射波，Snell 定律规定波矢量的切向分量是守恒的：$k_{rx} = k_{ix} = k \\sin\\theta$。反射波必须从边界传播到 $z>0$ 区域，因此其波矢量的 $z$ 分量 $k_{rz}$ 必须为正。由于波仍在同一介质中传播，其波数大小守恒，即 $|\\mathbf{k}_r| = k$。这得出 $k_{rz} = \\sqrt{k^2 - k_{rx}^2} = \\sqrt{k^2 - k^2\\sin^2\\theta} = k\\cos\\theta$。反射波矢量为：\n    $$\n    \\mathbf{k}_r = (k \\sin\\theta, 0, k \\cos\\theta)\n    $$\n    反射压强相量 $p_r$ 可以用反射系数 $R_p$ 来表示。问题定义 $R_p$ 满足 $p_r(x,y,0) = R_p p_i(x,y,0)$。在 $z=0$ 处，我们有 $p_i(x,0) = P_0 \\exp(\\mathrm{i}k\\sin\\theta\\,x)$ 和 $p_r(x,0) = P_r\\exp(\\mathrm{i}k\\sin\\theta\\,x)$，其中 $P_r$ 是反射波的复振幅。该定义意味着 $P_r = R_p P_0$。因此，反射波为：\n    $$\n    p_r(x,z) = R_p P_0 \\exp(\\mathrm{i}\\mathbf{k}_r \\cdot \\mathbf{r}) = R_p P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z))\n    $$\n\n3.  **总场与边界条件的应用：**\n    总压强场 $p$ 是入射场和反射场的叠加：\n    $$\n    p(x,z) = p_i(x,z) + p_r(x,z) = P_0 \\left[ \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z)) + R_p \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z)) \\right]\n    $$\n    我们可以提出对 $x$ 的共同空间依赖项：\n    $$\n    p(x,z) = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    现在，应用诺伊曼边界条件 $\\frac{\\partial p}{\\partial z}|_{z=0}=0$。首先，计算 $p$ 对 $z$ 的偏导数：\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\frac{\\partial}{\\partial z} \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    接下来，在边界 $z=0$ 处计算该导数：\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(0) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(0) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p)\n    $$\n    为满足边界条件，将此表达式设为零：\n    $$\n    P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p) = 0\n    $$\n    该方程必须对所有 $x$ 成立。由于振幅 $P_0$ 不为零，$k$ 不为零，且入射角 $\\theta$ 在范围 $[0, \\pi/2)$ 内，这意味着 $\\cos\\theta > 0$，因此 $(1 - R_p)$ 项必须为零。\n    $$\n    1 - R_p = 0\n    $$\n\n4.  **结论：**\n    求解反射系数 $R_p$，我们得到：\n    $$\n    R_p = 1\n    $$\n    此结果表明，对于完美刚性（声硬）边界，反射声压波在边界处的振幅和相位与入射声压波相同。这导致表面声压加倍，这是一个众所周知的现象。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "当处理多个声源时，叠加原理的威力才真正显现，这在阵列信号处理中尤为常见。本练习将探讨线性阵列的波束形成，其中定向声场是由单个阵元贡献的精确总和 。通过分析阵元失效的场景，您将深入了解基于叠加原理的系统的鲁棒性，以及不完美性对系统性能的影响。",
            "id": "4145612",
            "problem": "考虑一个由 $N=13$ 个相同的、相互无作用的窄带声单极子组成的均匀线性阵列 (ULA)。这些单极子沿 $x$ 轴放置在位置 $x_n = n d$ 上，其中整数索引 $n \\in \\{-6,-5,\\dots,5,6\\}$，$d$ 是阵元间距。声学介质是均匀、各向同性、无粘性且静止的，并且满足小信号条件，因此线性声学适用。每个阵元都以角频率 $\\omega$ 驱动，产生波数 $k = \\frac{2\\pi}{\\lambda}$，所有角度均以弧度为单位。\n\n假设在远场条件下，通过复权重 $w_n$ 实现波束朝向目标方向 $\\theta_0$ 的转向，这些权重使得所有活动阵元的贡献在 $\\theta_0$ 方向上相位对齐。叠加原理适用，因此在观测方向 $\\theta$ 上的总复压声场是每个阵元贡献的线性和。一部分阵元发生故障，其权重被设为零：具体来说，索引为 $n \\in \\mathcal{S} = \\{-5,-4,-1,1,4,5\\}$ 的阵元发生故障，而所有其他阵元保持活动状态，其权重为单位幅值。\n\n假设阵元间距为半波长 $d = \\frac{\\lambda}{2}$，并设 $\\sin(\\theta_0) = \\frac{1}{2}$。设退化的、转向补偿的、方向相关的复阵列因子定义为\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\!\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|,\n$$\n该因子由完整的 $N$ 阵元 ULA 的理想转向轴增益进行归一化。\n\n仅使用线性声学和远场叠加的第一性原理，推导 $A_{\\mathrm{fail}}(\\theta)$ 的形式，然后计算 $A_{\\mathrm{fail}}(\\theta)$ 在 $\\theta = 0$ 时的数值。将最终数值答案四舍五入到四位有效数字。最终答案应为无量纲。",
            "solution": "本问题要求针对一个特定的均匀线性阵列 (ULA) 配置，推导并评估退化的阵列因子 $A_{\\mathrm{fail}}(\\theta)$。评估将在观测角 $\\theta = 0$ 处进行。该过程将首先根据所述的线性声学和叠加的第一性原理，严格建立阵列因子的形式，然后使用所提供的参数进行系统性计算。\n\n首先，我们建立阵列因子的解析形式。根据线性声学中的叠加原理，远场中的总声压场是阵列中每个独立阵元贡献的总和。对于位于位置 $\\mathbf{r}_n$、以角频率 $\\omega$ 驱动的单个单极子源 $n$，其对远场观测点 $\\mathbf{r}$ 处复压的贡献与 $w_n \\exp(i (\\omega t - k |\\mathbf{r} - \\mathbf{r}_n|))$ 成正比。在远场中， $|\\mathbf{r} - \\mathbf{r}_n| \\approx r - \\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n$，其中 $r=|\\mathbf{r}|$ 且 $\\mathbf{\\hat{r}} = \\mathbf{r}/r$。对于给定的沿 $x$ 轴的 ULA，$\\mathbf{r}_n = x_n \\mathbf{\\hat{x}}$，对于相对于 $y$ 轴（垂射方向）的观测方向 $\\theta$，$\\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n = x_n \\sin(\\theta)$。相位项变为 $\\exp(i k x_n \\sin(\\theta))$。\n\n总复压 $p(\\theta)$ 是所有阵元贡献的总和，由复系数 $w_n$ 加权：\n$$\np(\\theta) \\propto \\sum_n w_n \\exp(i k x_n \\sin(\\theta))\n$$\n波束朝向目标方向 $\\theta_0$ 的转向是通过选择权重 $w_n$ 来实现的，这些权重使得各个信号的相位在 $\\theta_0$ 处相干叠加。这要求对于所有 $n$，$k x_n \\sin(\\theta_0) + \\arg(w_n)$ 都是一个常数。权重的标准选择是 $w_n = \\exp(-i k x_n \\sin(\\theta_0))$，这也满足活动阵元的单位幅值约束。对于故障阵元，权重为 $w_n = 0$。设 $\\mathcal{A}$ 是活动阵元的索引集合。产生的声压场，通常称为阵列因子，是：\n$$\nA(\\theta) = \\sum_{n \\in \\mathcal{A}} \\exp(-i k x_n \\sin(\\theta_0)) \\exp(i k x_n \\sin(\\theta)) = \\sum_{n \\in \\mathcal{A}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big)\n$$\n问题将 $A_{\\mathrm{fail}}(\\theta)$ 定义为此阵列因子的幅值，并由完整的 $N$ 阵元 ULA 的理想转向轴增益进行归一化。对于一个完整的 ULA（无故障），在转向角 $\\theta=\\theta_0$ 处的理想阵列因子将是 $\\sum_{n=-6}^{6} \\exp(0) = N$。因此，归一化因子是 $1/N$。这证实了所提供的表达式：\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|\n$$\n任务是计算 $\\theta = 0$ 时该表达式的值。将 $\\sin(\\theta) = 0$ 代入表达式得到：\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{N} \\left| \\sum_{n \\in \\mathcal{A}} \\exp\\big(-i k x_n \\sin(\\theta_0)\\big) \\right|\n$$\n我们有以下给定参数：\n- 阵元总数：$N = 13$。\n- 阵元位置：$x_n = n d$。\n- 阵元间距：$d = \\frac{\\lambda}{2}$。\n- 波数：$k = \\frac{2\\pi}{\\lambda}$。\n- 转向方向：$\\sin(\\theta_0) = \\frac{1}{2}$。\n- 故障阵元索引集合：$\\mathcal{S} = \\{-5, -4, -1, 1, 4, 5\\}$。\n\n活动阵元的索引集合 $\\mathcal{A}$ 是 $\\mathcal{S}$ 在全集 $\\{-6, \\dots, 6\\}$ 中的补集：\n$$\n\\mathcal{A} = \\{-6, -3, -2, 0, 2, 3, 6\\}\n$$\n接下来，我们计算指数项的宗量 $-i k x_n \\sin(\\theta_0)$：\n$$\n-i k x_n \\sin(\\theta_0) = -i \\left(\\frac{2\\pi}{\\lambda}\\right) (n d) \\left(\\frac{1}{2}\\right)\n$$\n代入 $d = \\frac{\\lambda}{2}$：\n$$\n-i \\left(\\frac{2\\pi}{\\lambda}\\right) \\left(n \\frac{\\lambda}{2}\\right) \\left(\\frac{1}{2}\\right) = -i \\frac{n\\pi}{2}\n$$\n$A_{\\mathrm{fail}}(0)$ 的表达式变为：\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} \\left| \\sum_{n \\in \\{-6, -3, -2, 0, 2, 3, 6\\}} \\exp\\left(-i \\frac{n\\pi}{2}\\right) \\right|\n$$\n我们现在对每个活动索引 $n \\in \\mathcal{A}$ 逐项计算这个和，设其为 $S$：\n- 对于 $n = -6$: $\\exp\\left(-i \\frac{(-6)\\pi}{2}\\right) = \\exp(i 3\\pi) = \\cos(3\\pi) + i\\sin(3\\pi) = -1$。\n- 对于 $n = -3$: $\\exp\\left(-i \\frac{(-3)\\pi}{2}\\right) = \\exp\\left(i \\frac{3\\pi}{2}\\right) = \\cos\\left(\\frac{3\\pi}{2}\\right) + i\\sin\\left(\\frac{3\\pi}{2}\\right) = -i$。\n- 对于 $n = -2$: $\\exp\\left(-i \\frac{(-2)\\pi}{2}\\right) = \\exp(i \\pi) = \\cos(\\pi) + i\\sin(\\pi) = -1$。\n- 对于 $n = 0$: $\\exp(0) = 1$。\n- 对于 $n = 2$: $\\exp\\left(-i \\frac{2\\pi}{2}\\right) = \\exp(-i \\pi) = \\cos(-\\pi) + i\\sin(-\\pi) = -1$。\n- 对于 $n = 3$: $\\exp\\left(-i \\frac{3\\pi}{2}\\right) = \\cos\\left(-\\frac{3\\pi}{2}\\right) + i\\sin\\left(-\\frac{3\\pi}{2}\\right) = i$。\n- 对于 $n = 6$: $\\exp\\left(-i \\frac{6\\pi}{2}\\right) = \\exp(-i 3\\pi) = \\cos(-3\\pi) + i\\sin(-3\\pi) = -1$。\n\n将这些复数值相加：\n$$\nS = (-1) + (-i) + (-1) + (1) + (-1) + (i) + (-1)\n$$\n合并实部和虚部：\n$$\nS = ((-1) - 1 + 1 - 1 - 1) + i(-1 + 1) = -3 + i(0) = -3\n$$\n该和的模为 $|S| = |-3| = 3$。\n\n最后，我们计算 $A_{\\mathrm{fail}}(0)$ 的值：\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} |S| = \\frac{3}{13}\n$$\n为了提供数值答案，我们计算其小数值并四舍五入到四位有效数字：\n$$\n\\frac{3}{13} \\approx 0.23076923...\n$$\n四舍五入到四位有效数字得到 $0.2308$。",
            "answer": "$$\\boxed{0.2308}$$"
        },
        {
            "introduction": "对于计算科学家而言，一个理论原则的价值最终体现在其数值实现上。最后一个实践练习要求您连接理论与代码，在一个亥姆霍兹方程的有限差分模拟中验证叠加原理 。这项任务为测试数值模型的线性度提供了一个实用蓝图，这是代码验证与确认中的关键一步。",
            "id": "4145617",
            "problem": "您需要从第一性原理出发，对线性声学中的叠加原理进行数值验证，具体方法是检查计算出的声压场在整个空间域上是否在指定容差内与源振幅成线性比例。其基本物理基础应为在密度和声速恒定的均匀、静止介质中，时谐激励下的线性化声学方程。需要离散化的控制频域偏微分方程是带有非齐次源的齐次压力亥姆霍兹方程，该方程在一个有界矩形上服从齐次狄利克雷边界条件。所有物理和数值参数必须以科学上一致的方式处理。\n\n基本原理：\n- 线性化声学动量方程为 $ \\nabla p = - \\rho_0 \\, \\partial \\mathbf{v} / \\partial t $，其中 $ p $ 是声压，$ \\mathbf{v} $ 是质点速度，$ \\rho_0 $ 是环境密度。\n- 线性化连续性方程为 $ \\partial \\rho / \\partial t + \\rho_0 \\, \\nabla \\cdot \\mathbf{v} = 0 $。\n- 对于角频率为 $ \\omega $ 的时谐场，假设 $ p(\\mathbf{x},t) = \\Re\\{ \\hat{p}(\\mathbf{x}) e^{- i \\omega t} \\} $，对 $ \\mathbf{v} $ 也作类似假设。在声速 $ c $ 和密度 $ \\rho_0 $ 恒定的均匀介质中，这些方程可简化为关于压力的标量亥姆霍兹方程，$ \\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s} $，其中 $ k = \\omega / c $ 是声波数，$ \\hat{s} $ 是代表体积力的有效源项。叠加原理预测，如果 $ \\hat{s} $ 按因子 $ \\alpha $ 缩放，只要算子是线性的且边界条件是齐次的，解 $ \\hat{p} $ 也应按相同的因子 $ \\alpha $ 缩放。\n\n您的程序必须：\n- 使用 $ N_x \\times N_y $ 个点的均匀笛卡尔网格对二维域 $ \\Omega = [0,L_x] \\times [0,L_y] $ 进行离散化，其中 $ N_x \\ge 3 $ 且 $ N_y \\ge 3 $。使用二阶中心有限差分来近似 $ \\nabla^2 \\hat{p} $，并在 $ \\partial \\Omega $ 上施加齐次狄利克雷边界条件 $ \\hat{p} = 0 $。离散线性系统必须仅针对内部节点进行组合。\n- 构造一个空间局域化的高斯源 $ \\hat{s}(x,y) = A_s \\exp\\!\\big( -\\frac{(x-x_0)^2 + (y-y_0)^2}{2 \\sigma^2} \\big) $，中心位于 $ x_0 = L_x/2 $，$ y_0 = L_y/2 $，宽度为 $ \\sigma $。振幅 $ A_s $ 的单位必须是帕斯卡每平方米，以使最终的压力场单位为帕斯卡。将 $ \\hat{s} $ 视为亥姆霍兹方程中的体积源项。数值离散化必须在科学上与这些单位保持一致。\n- 求解离散线性系统 $ \\mathbf{A} \\, \\mathbf{p} = - \\mathbf{s} $，以获得基本源振幅 $ A_s $ 对应的基本内部压力向量 $ \\mathbf{p}_0 $（单位为帕斯卡）。然后，对于每个缩放因子 $ \\alpha $，构造缩放后的源 $ \\alpha \\mathbf{s} $，并求解 $ \\mathbf{A} \\, \\mathbf{p}_\\alpha = - \\alpha \\mathbf{s} $ 以获得 $ \\mathbf{p}_\\alpha $。\n- 通过计算无穷范数偏差 $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha \\, p_{0,i} | $ 和参考量级 $ M_\\infty = \\max_i | \\alpha \\, p_{0,i} | $ 来验证数值线性。如果 $ \\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} \\, M_\\infty $，则声明测试通过，其中 $ \\varepsilon_{\\mathrm{abs}} $ 是绝对容差（单位为帕斯卡），$ \\varepsilon_{\\mathrm{rel}} $ 是无量纲的相对容差。\n\n物理常数和单位：\n- 声速必须设置为 $ c = 343 \\, \\mathrm{m/s} $。\n- 频率必须以赫兹为单位指定，以便 $ \\omega = 2 \\pi f $（单位为弧度/秒），$ k = \\omega / c $（单位为弧度/米）。\n- 域长度必须以米为单位指定。\n- 所有压力单位必须是帕斯卡，容差 $ \\varepsilon_{\\mathrm{abs}} $ 的单位也必须是帕斯卡。\n\n角度单位：\n- 出现的任何角度（例如，在 $ \\omega $ 或 $ k $ 中）都应以弧度处理。\n\n对于以下参数集测试套件，您的程序必须生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个结果都必须是一个布尔值，指示该参数集的线性度检查是否通过。\n\n测试套件（每个元组为 $(L_x, L_y, N_x, N_y, f, A_s, \\sigma, \\alpha, \\varepsilon_{\\mathrm{abs}}, \\varepsilon_{\\mathrm{rel}})$）：\n1. 正常路径： $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 2.5, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$。\n2. 零缩放边界情况： $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 0.0, 1.0\\times 10^{-12}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$。\n3. 大缩放因子压力测试： $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 100.0, 1.0\\times 10^{-9}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$。\n4. 粗网格边缘情况： $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 12, 9, 50\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 5.0, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$。\n5. 紧容差失败哨兵： $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 3.0, 0.0\\,\\mathrm{Pa}, 0.0)$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4},\\mathrm{result5}]$，其中每个 $ \\mathrm{resulti} $ 为 $ \\mathrm{True} $ 或 $ \\mathrm{False} $。",
            "solution": "问题陈述经评估有效。它在科学上以线性声学原理为基础，在数学上是适定的，并为数值验证任务提供了一套完整、一致且可形式化的要求。\n\n问题的核心是验证时谐声波方程（即线性亥姆霍兹方程）的叠加原理。叠加原理是线性的直接推论，它指出如果系统的输入按某个因子缩放，其输出也按相同的因子缩放。在这里，输入是源项 $ \\hat{s} $，输出是声压场 $ \\hat{p} $。\n\n实现过程分为四个阶段：对控制偏微分方程（PDE）进行离散化，组合生成的线性代数系统，针对两种不同的源缩放求解该系统，以及对解进行最终的定量比较。\n\n**1. 亥姆霍兹方程的离散化**\n\n在二维均匀介质中，控制复压幅 $ \\hat{p}(x,y) $ 的偏微分方程是亥姆霍兹方程：\n$$\n\\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s}(x,y)\n$$\n其中 $ \\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} $ 是拉普拉斯算子，$ k = \\omega/c $ 是声波数，角频率为 $ \\omega = 2 \\pi f $，声速为 $ c $。问题定义在矩形域 $ \\Omega = [0, L_x] \\times [0, L_y] $ 上，带有齐次狄利克雷边界条件，即在边界 $ \\partial\\Omega $ 上 $ \\hat{p} = 0 $。\n\n我们使用一个在 $ x $ 方向有 $ N_x $ 个点、在 $ y $ 方向有 $ N_y $ 个点的均匀笛卡尔网格来离散化该域。网格间距为 $ h_x = L_x / (N_x - 1) $ 和 $ h_y = L_y / (N_y - 1) $。一个网格点表示为 $ (x_i, y_j) $，其中 $ x_i = i h_x $（$ i=0, \\dots, N_x-1 $）以及 $ y_j = j h_y $（$ j=0, \\dots, N_y-1 $）。该点的离散压力为 $ \\hat{p}_{i,j} $。\n\n拉普拉斯算子使用二阶中心有限差分格式进行近似。在内部网格点 $ (x_i, y_j) $（其中 $ 1 \\le i \\le N_x-2 $ 且 $ 1 \\le j \\le N_y-2 $），偏微分方程变为：\n$$\n\\frac{\\hat{p}_{i-1,j} - 2\\hat{p}_{i,j} + \\hat{p}_{i+1,j}}{h_x^2} + \\frac{\\hat{p}_{i,j-1} - 2\\hat{p}_{i,j} + \\hat{p}_{i,j+1}}{h_y^2} + k^2 \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\n其中 $ \\hat{s}_{i,j} $ 是在 $ (x_i, y_j) $ 处求值的源项。边界条件 $ \\hat{p}=0 $ 通过将边界网格点上的压力值设为 $ 0 $ 来施加。对未知数 $ \\hat{p}_{i,j} $ 重新整理各项，得到每个内部点的离散线性方程：\n$$\n\\frac{1}{h_x^2} \\hat{p}_{i-1,j} + \\frac{1}{h_x^2} \\hat{p}_{i+1,j} + \\frac{1}{h_y^2} \\hat{p}_{i,j-1} + \\frac{1}{h_y^2} \\hat{p}_{i,j+1} + \\left(k^2 - \\frac{2}{h_x^2} - \\frac{2}{h_y^2}\\right) \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\n\n**2. 线性系统构建**\n\n所有 $ (N_x-2)(N_y-2) $ 个内部点的离散方程集构成一个大型稀疏线性方程组，可以表示为矩阵形式：\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}\n$$\n此处，$ \\mathbf{p} $ 是一个长度为 $ N_{int} = (N_x-2)(N_y-2) $ 的向量，包含内部网格点上的未知复压幅 $ \\hat{p}_{i,j} $，使用行主序（row-major）扁平化方案排序。右侧向量 $ \\mathbf{b} = -\\mathbf{s} $，其中 $ \\mathbf{s} $ 是相同内部点上源项值的扁平化向量。矩阵 $ \\mathbf{A} $ 是一个大小为 $ N_{int} \\times N_{int} $ 的稀疏复值矩阵，代表离散化的亥姆霍兹算子。\n\n一种构建 $ \\mathbf{A} $ 的稳健而优雅的方法是使用克罗内克积（Kronecker products）。离散的二维拉普拉斯算子 $ L_{2D} $ 可以表示为：\n$$\nL_{2D} = I_y \\otimes L_{1D,x} + L_{1D,y} \\otimes I_x\n$$\n其中 $ L_{1D,x} $ 和 $ L_{1D,y} $ 分别是表示 $ x $ 和 $ y $ 方向上的一维二阶有限差分拉普拉斯算子的稀疏矩阵，$ I_x $ 和 $ I_y $ 是适当大小的单位矩阵。完整的系统矩阵 $ \\mathbf{A} $ 则为：\n$$\n\\mathbf{A} = L_{2D} + k^2 I\n$$\n其中 $ I $ 是大小为 $ N_{int} $ 的单位矩阵。这种构造方法产生一个可以被高效求解的稀疏矩阵。\n\n**3. 数值验证程序**\n\n叠加原理的验证按以下方式执行。首先，根据指定的高斯函数和基本振幅 $ A_s $ 构建源向量 $ \\mathbf{s} $。求解线性系统以获得基本压力场 $ \\mathbf{p}_0 $：\n$$\n\\mathbf{A} \\mathbf{p}_0 = -\\mathbf{s}\n$$\n接下来，将源按因子 $ \\alpha $ 缩放，并再次求解系统以获得缩放后的压力场 $ \\mathbf{p}_\\alpha $：\n$$\n\\mathbf{A} \\mathbf{p}_\\alpha = -(\\alpha \\mathbf{s})\n$$\n由于矩阵方程的线性，缩放后系统的精确解析解就是 $ \\alpha \\mathbf{p}_0 $，因为 $ \\mathbf{A}(\\alpha \\mathbf{p}_0) = \\alpha (\\mathbf{A} \\mathbf{p}_0) = \\alpha(-\\mathbf{s}) = -(\\alpha\\mathbf{s}) $。然而，使用有限精度浮点运算得到的数值解会表现出微小的差异。目标是量化这种数值偏差。\n\n该偏差通过计算出的缩放解 $ \\mathbf{p}_\\alpha $ 与缩放后的基准解 $ \\alpha \\mathbf{p}_0 $ 之差的无穷范数来衡量：\n$$\n\\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha p_{0,i} |\n$$\n将此偏差与一个混合的绝对-相对容差标准进行比较。参考量级是预期缩放解的无穷范数：\n$$\nM_\\infty = \\max_i | \\alpha p_{0,i} |\n$$\n如果偏差在指定的容差范围内，则认为叠加原理得到了数值验证：\n$$\n\\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} M_\\infty\n$$\n其中 $ \\varepsilon_{\\mathrm{abs}} $ 是绝对容差（单位为帕斯卡），$ \\varepsilon_{\\mathrm{rel}} $ 是无量纲的相对容差。此检查确认了数值实现（包括线性求解器）在可预测和可控制的浮点误差水平内表现出线性行为。对于 $ \\alpha = 0 $ 的特殊情况，缩放后的源为零，导致预期解为零。检查简化为 $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} | \\le \\varepsilon_{\\mathrm{abs}} $。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.sparse\nimport scipy.sparse.linalg\n\ndef _create_laplacian_1d(num_points, h):\n    \"\"\"\n    Creates a 1D finite difference Laplacian matrix for interior points.\n\n    Args:\n        num_points (int): Total number of grid points in the dimension.\n        h (float): Grid spacing.\n\n    Returns:\n        scipy.sparse.csr_matrix: The (num_points-2) x (num_points-2) sparse matrix.\n    \"\"\"\n    M = num_points - 2\n    if M == 0:\n        return scipy.sparse.csr_matrix((0, 0))\n    \n    # Stencil for d^2/dx^2 is [1, -2, 1] / h^2\n    diag_vals = np.ones(M, dtype=np.float64)\n    offsets = [-1, 0, 1]\n    L_1d = scipy.sparse.spdiags([diag_vals, -2 * diag_vals, diag_vals], offsets, M, M, format='csr') / h**2\n    return L_1d\n\ndef _run_verification(Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel):\n    \"\"\"\n    Performs the superposition principle verification for a single test case.\n    \"\"\"\n    # Physical and numerical constants\n    C_SOUND = 343.0\n    \n    # Discretization parameters\n    hx = Lx / (Nx - 1)\n    hy = Ly / (Ny - 1)\n    \n    # Physics parameters\n    omega = 2.0 * np.pi * f\n    k = omega / C_SOUND\n    \n    # Interior grid dimensions\n    Nx_int = Nx - 2\n    Ny_int = Ny - 2\n    N_int = Nx_int * Ny_int\n\n    if N_int == 0:\n        # No interior points. The pressure vector is empty.\n        # This case is excluded by problem constraints (Nx, Ny >= 3),\n        # but for robustness, we define success as the deviation (0) being\n        # less than or equal to the absolute tolerance.\n        return 0.0 = eps_abs\n\n    # Assemble the Helmholtz operator matrix A using Kronecker products\n    L_1d_x = _create_laplacian_1d(Nx, hx)\n    L_1d_y = _create_laplacian_1d(Ny, hy)\n    \n    I_x = scipy.sparse.identity(Nx_int)\n    I_y = scipy.sparse.identity(Ny_int)\n    \n    L_2d = scipy.sparse.kron(I_y, L_1d_x) + scipy.sparse.kron(L_1d_y, I_x)\n    A = L_2d + (k**2) * scipy.sparse.identity(N_int)\n    \n    # Use complex numbers as is standard for frequency-domain problems\n    A = A.astype(np.complex128)\n\n    # Assemble the source vector s\n    x_int = np.linspace(hx, Lx - hx, Nx_int)\n    y_int = np.linspace(hy, Ly - hy, Ny_int)\n    X_int, Y_int = np.meshgrid(x_int, y_int)\n    \n    x0, y0 = Lx / 2.0, Ly / 2.0\n    source_grid = As * np.exp(-((X_int - x0)**2 + (Y_int - y0)**2) / (2.0 * sigma**2))\n    s_vec = source_grid.flatten().astype(np.complex128)\n    \n    # We solve Ap = -s. The right-hand side is -s.\n    rhs_base = -s_vec\n    \n    # Solve for the base pressure field p0\n    p0 = scipy.sparse.linalg.spsolve(A, rhs_base)\n    \n    # Solve for the scaled pressure field p_alpha\n    rhs_scaled = -alpha * s_vec\n    p_alpha = scipy.sparse.linalg.spsolve(A, rhs_scaled)\n    \n    # Perform the verification check\n    # The comparison alpha * p0 represents the expected result from linearity\n    expected_p_alpha = alpha * p0\n    \n    # Calculate infinity-norm deviation\n    # Using np.abs for complex magnitude\n    delta_inf = np.max(np.abs(p_alpha - expected_p_alpha))\n    \n    # Calculate reference magnitude\n    M_inf = np.max(np.abs(expected_p_alpha))\n    \n    # Apply the verification criterion\n    passed = delta_inf = eps_abs + eps_rel * M_inf\n    \n    return passed\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel)\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 2.5, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 0.0, 1.0e-12, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 100.0, 1.0e-9, 1.0e-12),\n        (1.0, 1.0, 12, 9, 50.0, 1.0, 0.05, 5.0, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 3.0, 0.0, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = _run_verification(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}