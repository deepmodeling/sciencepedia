{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational problem: the reflection of a plane wave from a rigid surface. This exercise requires using the superposition principle to construct a total acoustic field, comprising incident and reflected components, that satisfies a specific physical boundary condition. By working from first principles, this practice reinforces the direct link between the physical constraint of a rigid wall and its mathematical representation as a Neumann boundary condition, a core skill for setting up computational models. ",
            "id": "4131551",
            "problem": "A time-harmonic plane acoustic wave propagates in a homogeneous, lossless fluid of mass density $\\rho_{0}$ and sound speed $c$. The fluid occupies the half-space $z>0$, and the boundary at $z=0$ is an infinite, perfectly rigid (sound-hard) plane. Let the acoustic pressure field be described in the complex phasor convention with time dependence $\\exp(-\\mathrm{i}\\omega t)$, where $\\omega$ is the angular frequency, and define the wavenumber $k=\\omega/c$. The incident plane wave has complex pressure amplitude $P_{0}$ and propagates in the $x$-$z$ plane at an incidence angle $\\theta \\in [0,\\pi/2)$ measured from the positive $z$-axis (the outward normal of the boundary into the fluid). In the absence of sources in the fluid, the total field is the superposition of the incident and reflected fields, each satisfying the homogeneous Helmholtz equation. The rigid boundary enforces the Neumann boundary condition that the normal component of the particle velocity vanishes on $z=0$.\n\nUsing only first principles of linear acoustics, namely the linearized momentum equation (Euler equation), the linearized continuity equation, and the adiabatic constitutive relation for a lossless fluid, derive the complex pressure reflection coefficient $R_{p}$ defined by $p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$ for all $(x,y)$ on the boundary, where $p_{i}$ and $p_{r}$ denote the incident and reflected pressure phasors, respectively. Express $R_{p}$ as a single closed-form analytic expression in terms of the given quantities. Your final answer must be a single expression. No rounding is required, and no physical units should be included in the final boxed expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Fluid: Homogeneous, lossless.\n- Fluid properties: Mass density $\\rho_{0}$, sound speed $c$.\n- Domain: Half-space $z>0$.\n- Boundary: Infinite, perfectly rigid (sound-hard) plane at $z=0$.\n- Time dependence: Phasor convention with $\\exp(-\\mathrm{i}\\omega t)$.\n- Wavenumber: $k=\\omega/c$.\n- Incident wave: Time-harmonic plane wave with complex pressure amplitude $P_{0}$.\n- Propagation plane: $x$-$z$ plane.\n- Incidence angle: $\\theta \\in [0,\\pi/2)$ measured from the positive $z$-axis.\n- Total field: Superposition of incident ($p_i$) and reflected ($p_r$) fields.\n- Governing equation: Homogeneous Helmholtz equation.\n- Boundary condition: The normal component of the particle velocity vanishes on $z=0$.\n- Definition of reflection coefficient: $p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$.\n- Task: Derive $R_{p}$ from first principles (linearized momentum, continuity, and constitutive relation).\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is a classic textbook case of wave reflection in acoustics. It is based on fundamental principles: the wave equation derived from Euler's and continuity equations, and the Neumann boundary condition for a rigid surface. All aspects are scientifically established.\n- **Well-Posedness**: The problem is well-posed. The geometry, medium, incident wave, and boundary conditions are all clearly defined, which is sufficient to determine a unique solution for the reflected field and thus the reflection coefficient.\n- **Objectivity**: The problem is stated in precise, objective, mathematical language.\n- **Completeness and Consistency**: The problem provides all necessary information and contains no internal contradictions. The definition of a rigid boundary is correctly linked to the Neumann condition on particle velocity.\n- **Topic Relevance**: The problem is directly concerned with the physical meaning and mathematical implementation of a *Neumann boundary condition* for a *rigid (sound-hard)* surface in the context of acoustic wave propagation, which is a central theme in *computational acoustics* and wave physics.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived from the specified first principles.\n\n**Derivation of the Reflection Coefficient**\n\nThe derivation begins with the fundamental equations of linear acoustics for a lossless, homogeneous, and quiescent fluid. Let $p(\\mathbf{r}, t)$ be the acoustic pressure, $\\mathbf{v}(\\mathbf{r}, t)$ be the particle velocity, and $\\rho(\\mathbf{r}, t)$ be the acoustic density fluctuation.\n\n1.  **First Principles and Velocity-Pressure Relation:**\n    The problem asks to start from the linearized momentum equation (Euler's equation) and continuity equation.\n    - Linearized momentum equation: $\\rho_{0} \\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p$.\n    - Linearized continuity equation: $\\frac{\\partial \\rho}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0$.\n    - Adiabatic constitutive relation: $p = c^{2}\\rho$.\n\n    For time-harmonic fields with time dependence $\\exp(-\\mathrm{i}\\omega t)$, the time derivative operator $\\frac{\\partial}{\\partial t}$ is replaced by a multiplication by $-\\mathrm{i}\\omega$. Applying this to the momentum equation for the complex phasors $p(\\mathbf{r})$ and $\\mathbf{v}(\\mathbf{r})$:\n    $$\n    \\rho_{0} (-\\mathrm{i}\\omega) \\mathbf{v} = -\\nabla p\n    $$\n    This provides the crucial relationship between the particle velocity phasor and the pressure phasor:\n    $$\n    \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\nabla p\n    $$\n    The normal component of the velocity at the boundary $z=0$ is the $z$-component, $v_z$. The boundary condition is $v_z(x,y,0) = 0$. Using the relation above, this becomes:\n    $$\n    v_z = \\hat{\\mathbf{z}} \\cdot \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\frac{\\partial p}{\\partial z}\n    $$\n    Therefore, the boundary condition $v_z(x,y,0) = 0$ is equivalent to the Neumann boundary condition on the pressure field:\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = 0\n    $$\n\n2.  **Incident and Reflected Waves:**\n    The incident plane wave propagates in the $x$-$z$ plane at an angle $\\theta$ with respect to the $+z$-axis. The incident wave vector, $\\mathbf{k}_i$, must have a negative $z$-component to represent propagation towards the boundary at $z=0$. The components of $\\mathbf{k}_i$ are:\n    $$\n    k_{ix} = k \\sin\\theta, \\quad k_{iy} = 0, \\quad k_{iz} = -k \\cos\\theta\n    $$\n    The incident pressure phasor $p_i$ is given by:\n    $$\n    p_i(x,z) = P_0 \\exp(\\mathrm{i}\\mathbf{k}_i \\cdot \\mathbf{r}) = P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z))\n    $$\n    For the reflected wave, Snell's law dictates that the tangential component of the wave vector is conserved: $k_{rx} = k_{ix} = k \\sin\\theta$. The reflected wave must propagate away from the boundary into the $z>0$ region, so its $z$-component of the wave vector, $k_{rz}$, must be positive. Since the wave still propagates in the same medium, its wavenumber magnitude is conserved, $|\\mathbf{k}_r| = k$. This gives $k_{rz} = \\sqrt{k^2 - k_{rx}^2} = \\sqrt{k^2 - k^2\\sin^2\\theta} = k\\cos\\theta$. The reflected wave vector is:\n    $$\n    \\mathbf{k}_r = (k \\sin\\theta, 0, k \\cos\\theta)\n    $$\n    The reflected pressure phasor $p_r$ can be written in terms of the reflection coefficient $R_p$. The problem defines $R_p$ such that $p_r(x,y,0) = R_p p_i(x,y,0)$. At $z=0$, we have $p_i(x,0) = P_0 \\exp(\\mathrm{i}k\\sin\\theta\\,x)$ and $p_r(x,0) = P_r\\exp(\\mathrm{i}k\\sin\\theta\\,x)$, where $P_r$ is the complex amplitude of the reflected wave. The definition implies $P_r = R_p P_0$. Thus, the reflected wave is:\n    $$\n    p_r(x,z) = R_p P_0 \\exp(\\mathrm{i}\\mathbf{k}_r \\cdot \\mathbf{r}) = R_p P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z))\n    $$\n\n3.  **Total Field and Boundary Condition Application:**\n    The total pressure field $p$ is the superposition of the incident and reflected fields:\n    $$\n    p(x,z) = p_i(x,z) + p_r(x,z) = P_0 \\left[ \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z)) + R_p \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z)) \\right]\n    $$\n    We can factor out the common spatial dependence on $x$:\n    $$\n    p(x,z) = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    Now, apply the Neumann boundary condition $\\frac{\\partial p}{\\partial z}|_{z=0}=0$. First, compute the partial derivative of $p$ with respect to $z$:\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\frac{\\partial}{\\partial z} \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    Next, evaluate this derivative at the boundary $z=0$:\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(0) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(0) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p)\n    $$\n    Setting this expression to zero to satisfy the boundary condition:\n    $$\n    P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p) = 0\n    $$\n    This equation must hold for all $x$. Since the amplitude $P_0$ is non-zero, $k$ is non-zero, and the angle of incidence $\\theta$ is in the range $[0, \\pi/2)$, which means $\\cos\\theta > 0$, the term $(1 - R_p)$ must be zero.\n    $$\n    1 - R_p = 0\n    $$\n\n4.  **Conclusion:**\n    Solving for the reflection coefficient $R_p$, we find:\n    $$\n    R_p = 1\n    $$\n    This result indicates that for a perfectly rigid (sound-hard) boundary, the reflected pressure wave has the same amplitude and phase as the incident pressure wave at the boundary. This leads to a doubling of acoustic pressure at the surface, a well-known phenomenon.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Next, we apply the superposition principle to a practical engineering context: acoustic beamforming with an array of sources. This problem demonstrates how constructive and destructive interference, governed by superposition, can be harnessed to steer acoustic energy in a desired direction. By analyzing the system's performance when some elements fail, you will gain a tangible understanding of array robustness and how critical the linear summation of every contribution is to the final beam pattern. ",
            "id": "4145612",
            "problem": "Consider a Uniform Linear Array (ULA) of $N=13$ identical, mutually non-interacting, narrowband acoustic monopoles placed along the $x$-axis at positions $x_n = n d$ for integer indices $n \\in \\{-6,-5,\\dots,5,6\\}$, where $d$ is the inter-element spacing. The acoustic medium is homogeneous, isotropic, inviscid, and quiescent, and small-signal conditions hold so that linear acoustics applies. Each element is driven at angular frequency $\\omega$ producing a wavenumber $k = \\frac{2\\pi}{\\lambda}$, and all angles are measured in radians.\n\nUnder far-field conditions, suppose beam steering toward a target direction $\\theta_0$ is achieved by complex weights $w_n$ that phase-align the contributions from all active elements toward $\\theta_0$. The superposition principle applies, so the total complex pressure field at an observation direction $\\theta$ is the linear sum of the contributions from each element. A subset of elements suffer failures such that their weights are set to zero: specifically, the elements with indices $n \\in \\mathcal{S} = \\{-5,-4,-1,1,4,5\\}$ are failed, and all other elements remain active with unit-magnitude weights.\n\nAssume half-wavelength spacing $d = \\frac{\\lambda}{2}$ and set $\\sin(\\theta_0) = \\frac{1}{2}$. Let the degraded, steering-compensated, direction-dependent complex array factor be defined as\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\!\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|,\n$$\nwhich is normalized by the ideal steering-axis gain of the full $N$-element ULA.\n\nUsing only first principles of linear acoustics and far-field superposition, derive the form of $A_{\\mathrm{fail}}(\\theta)$ and then compute the numerical value of $A_{\\mathrm{fail}}(\\theta)$ at $\\theta = 0$. Round your final numerical answer to four significant figures. The final answer should be unitless.",
            "solution": "The problem requires the derivation and evaluation of the degraded array factor, $A_{\\mathrm{fail}}(\\theta)$, for a specific Uniform Linear Array (ULA) configuration. The evaluation is to be performed at the observation angle $\\theta = 0$. The process will begin by rigorously establishing the form of the array factor from the stated first principles of linear acoustics and superposition, followed by a systematic calculation using the provided parameters.\n\nFirst, we establish the analytical form of the array factor. According to the principle of superposition in linear acoustics, the total acoustic pressure field in the far-field is the sum of the contributions from each individual element of the array. For a single monopole source $n$ located at position $\\mathbf{r}_n$ and driven with angular frequency $\\omega$, its contribution to the complex pressure at a far-field observation point $\\mathbf{r}$ is proportional to $w_n \\exp(i (\\omega t - k |\\mathbf{r} - \\mathbf{r}_n|))$. In the far-field, $|\\mathbf{r} - \\mathbf{r}_n| \\approx r - \\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n$, where $r=|\\mathbf{r}|$ and $\\mathbf{\\hat{r}} = \\mathbf{r}/r$. For the given ULA along the $x$-axis, $\\mathbf{r}_n = x_n \\mathbf{\\hat{x}}$, and for an observation direction $\\theta$ relative to the $y$-axis (broadside), $\\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n = x_n \\sin(\\theta)$. The phase term becomes $\\exp(i k x_n \\sin(\\theta))$.\n\nThe total complex pressure $p(\\theta)$ is the sum of contributions from all elements, weighted by complex coefficients $w_n$:\n$$\np(\\theta) \\propto \\sum_n w_n \\exp(i k x_n \\sin(\\theta))\n$$\nBeam steering toward a target direction $\\theta_0$ is accomplished by choosing weights $w_n$ that cause the individual signal phases to align constructively at $\\theta_0$. This requires $k x_n \\sin(\\theta_0) + \\arg(w_n)$ to be constant for all $n$. A standard choice for the weights, which also satisfies the unit-magnitude constraint for active elements, is $w_n = \\exp(-i k x_n \\sin(\\theta_0))$. For failed elements, the weight is $w_n = 0$. Let $\\mathcal{A}$ be the set of indices of active elements. The resulting pressure field, conventionally called the array factor, is:\n$$\nA(\\theta) = \\sum_{n \\in \\mathcal{A}} \\exp(-i k x_n \\sin(\\theta_0)) \\exp(i k x_n \\sin(\\theta)) = \\sum_{n \\in \\mathcal{A}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big)\n$$\nThe problem defines $A_{\\mathrm{fail}}(\\theta)$ as the magnitude of this array factor, normalized by the ideal steering-axis gain of the full $N$-element ULA. For a full ULA (no failures), the ideal array factor at the steering angle $\\theta=\\theta_0$ would be $\\sum_{n=-6}^{6} \\exp(0) = N$. Thus, the normalization factor is $1/N$. This confirms the provided expression:\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|\n$$\nThe task is to compute this value for $\\theta = 0$. Substituting $\\sin(\\theta) = 0$ into the expression gives:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{N} \\left| \\sum_{n \\in \\mathcal{A}} \\exp\\big(-i k x_n \\sin(\\theta_0)\\big) \\right|\n$$\nWe are given the following parameters:\n- Total number of elements: $N = 13$.\n- Element positions: $x_n = n d$.\n- Inter-element spacing: $d = \\frac{\\lambda}{2}$.\n- Wavenumber: $k = \\frac{2\\pi}{\\lambda}$.\n- Steering direction: $\\sin(\\theta_0) = \\frac{1}{2}$.\n- Set of failed element indices: $\\mathcal{S} = \\{-5, -4, -1, 1, 4, 5\\}$.\n\nThe set of active element indices $\\mathcal{A}$ is the complement of $\\mathcal{S}$ in the full set $\\{-6, \\dots, 6\\}$:\n$$\n\\mathcal{A} = \\{-6, -3, -2, 0, 2, 3, 6\\}\n$$\nNext, we evaluate the argument of the exponential term, $-i k x_n \\sin(\\theta_0)$:\n$$\n-i k x_n \\sin(\\theta_0) = -i \\left(\\frac{2\\pi}{\\lambda}\\right) (n d) \\left(\\frac{1}{2}\\right)\n$$\nSubstituting $d = \\frac{\\lambda}{2}$:\n$$\n-i \\left(\\frac{2\\pi}{\\lambda}\\right) \\left(n \\frac{\\lambda}{2}\\right) \\left(\\frac{1}{2}\\right) = -i \\frac{n\\pi}{2}\n$$\nThe expression for $A_{\\mathrm{fail}}(0)$ becomes:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} \\left| \\sum_{n \\in \\{-6, -3, -2, 0, 2, 3, 6\\}} \\exp\\left(-i \\frac{n\\pi}{2}\\right) \\right|\n$$\nWe now evaluate the sum, let it be $S$, term by term for each active index $n \\in \\mathcal{A}$:\n- For $n = -6$: $\\exp\\left(-i \\frac{(-6)\\pi}{2}\\right) = \\exp(i 3\\pi) = \\cos(3\\pi) + i\\sin(3\\pi) = -1$.\n- For $n = -3$: $\\exp\\left(-i \\frac{(-3)\\pi}{2}\\right) = \\exp\\left(i \\frac{3\\pi}{2}\\right) = \\cos\\left(\\frac{3\\pi}{2}\\right) + i\\sin\\left(\\frac{3\\pi}{2}\\right) = -i$.\n- For $n = -2$: $\\exp\\left(-i \\frac{(-2)\\pi}{2}\\right) = \\exp(i \\pi) = \\cos(\\pi) + i\\sin(\\pi) = -1$.\n- For $n = 0$: $\\exp(0) = 1$.\n- For $n = 2$: $\\exp\\left(-i \\frac{2\\pi}{2}\\right) = \\exp(-i \\pi) = \\cos(-\\pi) + i\\sin(-\\pi) = -1$.\n- For $n = 3$: $\\exp\\left(-i \\frac{3\\pi}{2}\\right) = \\cos\\left(-\\frac{3\\pi}{2}\\right) + i\\sin\\left(-\\frac{3\\pi}{2}\\right) = i$.\n- For $n = 6$: $\\exp\\left(-i \\frac{6\\pi}{2}\\right) = \\exp(-i 3\\pi) = \\cos(-3\\pi) + i\\sin(-3\\pi) = -1$.\n\nSumming these complex values:\n$$\nS = (-1) + (-i) + (-1) + (1) + (-1) + (i) + (-1)\n$$\nCollecting the real and imaginary parts:\n$$\nS = ((-1) - 1 + 1 - 1 - 1) + i(-1 + 1) = -3 + i(0) = -3\n$$\nThe magnitude of the sum is $|S| = |-3| = 3$.\n\nFinally, we compute the value of $A_{\\mathrm{fail}}(0)$:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} |S| = \\frac{3}{13}\n$$\nTo provide the numerical answer, we compute the decimal value and round to four significant figures:\n$$\n\\frac{3}{13} \\approx 0.23076923...\n$$\nRounding to four significant figures yields $0.2308$.",
            "answer": "$$\\boxed{0.2308}$$"
        },
        {
            "introduction": "Our final practice takes the superposition principle into the heart of computational acoustics: implementing and verifying it in code. You are tasked with building a numerical solver for the Helmholtz equation and designing a test to confirm its linearityâ€”the mathematical property that enables superposition. This exercise is crucial for developing confidence in numerical tools, as it provides a method to verify that a complex simulation correctly adheres to the fundamental principles it is based upon. ",
            "id": "4145617",
            "problem": "You are to implement, from first principles, a numerical verification of the superposition principle in linear acoustics by checking whether a computed acoustic pressure field scales linearly with source amplitude across a spatial domain, within specified tolerances. The fundamental physical base shall be the linearized equations of acoustics under time-harmonic excitation in a homogeneous, stationary medium of constant density and sound speed. The governing frequency-domain partial differential equation to be discretized is the homogeneous-pressure Helmholtz equation with an inhomogeneous source, subject to homogeneous Dirichlet boundary conditions on a bounded rectangle. All physical and numerical parameters must be handled in a scientifically consistent manner.\n\nFundamental base:\n- The linearized momentum equation for acoustics is $ \\nabla p = - \\rho_0 \\frac{\\partial \\mathbf{v}}{\\partial t} $, where $ p $ is acoustic pressure, $ \\mathbf{v} $ is particle velocity, and $ \\rho_0 $ is the ambient density.\n- The linearized continuity equation is $ \\frac{\\partial \\rho}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{v} = 0 $.\n- For time-harmonic fields with angular frequency $ \\omega $, assume $ p(\\mathbf{x},t) = \\Re\\{ \\hat{p}(\\mathbf{x}) e^{- i \\omega t} \\} $ and similarly for $ \\mathbf{v} $. In a homogeneous medium with constant sound speed $ c $ and density $ \\rho_0 $, these reduce to the scalar Helmholtz equation for pressure, $ \\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s} $, where $ k = \\omega / c $ is the acoustic wavenumber and $ \\hat{s} $ is an effective source term representing body forcing. The superposition principle predicts that if $ \\hat{s} $ is scaled by a factor $ \\alpha $, the solution $ \\hat{p} $ should scale by the same factor $ \\alpha $ provided the operator is linear and boundary conditions are homogeneous.\n\nYour program must:\n- Discretize the two-dimensional domain $ \\Omega = [0,L_x] \\times [0,L_y] $ using a uniform Cartesian grid of $ N_x \\times N_y $ points, where $ N_x \\ge 3 $ and $ N_y \\ge 3 $. Use second-order central finite differences to approximate $ \\nabla^2 \\hat{p} $, and impose homogeneous Dirichlet boundary conditions $ \\hat{p} = 0 $ on $ \\partial \\Omega $. The discrete linear system must be assembled for interior nodes only.\n- Construct a spatially localized Gaussian source $ \\hat{s}(x,y) = A_s \\exp\\!\\big( -\\frac{(x-x_0)^2 + (y-y_0)^2}{2 \\sigma^2} \\big) $ centered at $ x_0 = L_x/2 $, $ y_0 = L_y/2 $, with width $ \\sigma $. The amplitude $ A_s $ must be given in pascals per square meter so that the resulting pressure field has units of pascals. Treat $ \\hat{s} $ as a volumetric source term in the Helmholtz equation. The numerical discretization must be scientifically consistent with these units.\n- Solve the discrete linear system $ \\mathbf{A} \\, \\mathbf{p} = - \\mathbf{s} $ for the base source amplitude $ A_s $ to obtain the base interior pressure vector $ \\mathbf{p}_0 $ in pascals. Then, for each scaling factor $ \\alpha $, form the scaled source $ \\alpha \\mathbf{s} $ and solve $ \\mathbf{A} \\, \\mathbf{p}_\\alpha = - \\alpha \\mathbf{s} $ to obtain $ \\mathbf{p}_\\alpha $.\n- Verify numerical linearity by computing the infinity-norm deviation $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha \\, p_{0,i} | $ and the reference magnitude $ M_\\infty = \\max_i | \\alpha \\, p_{0,i} | $. Declare the test to pass if $ \\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} \\, M_\\infty $, where $ \\varepsilon_{\\mathrm{abs}} $ is an absolute tolerance in pascals and $ \\varepsilon_{\\mathrm{rel}} $ is a dimensionless relative tolerance.\n\nPhysical constants and units:\n- Sound speed must be set to $ c = 343 \\, \\mathrm{m/s} $.\n- Frequency must be specified in hertz so that $ \\omega = 2 \\pi f $ (radians per second) and $ k = \\omega / c $ (radians per meter).\n- Domain lengths must be specified in meters.\n- All pressures must be in pascals, and tolerances $ \\varepsilon_{\\mathrm{abs}} $ must be in pascals.\n\nAngle unit:\n- Any angle that appears (e.g., in $ \\omega $ or $ k $) is to be treated in radians.\n\nYour program must produce, for the following test suite of parameter sets, a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must be a boolean indicating whether the linearity check passed for that parameter set.\n\nTest suite (each tuple is $(L_x, L_y, N_x, N_y, f, A_s, \\sigma, \\alpha, \\varepsilon_{\\mathrm{abs}}, \\varepsilon_{\\mathrm{rel}})$):\n1. Happy path: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 2.5, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n2. Zero scaling boundary case: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 0.0, 1.0\\times 10^{-12}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n3. Large scaling factor stress test: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 100.0, 1.0\\times 10^{-9}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n4. Coarse grid edge case: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 12, 9, 50\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 5.0, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n5. Tight tolerance failure sentinel: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 3.0, 0.0\\,\\mathrm{Pa}, 0.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4},\\mathrm{result5}]$, where each $ \\mathrm{resulti} $ is either $ \\mathrm{True} $ or $ \\mathrm{False} $.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of linear acoustics, mathematically well-posed, and provides a complete, consistent, and formalizable set of requirements for a numerical verification task.\n\nThe core of the problem is to verify the superposition principle for the time-harmonic acoustic wave equation, which is the linear Helmholtz equation. The principle of superposition, a direct consequence of linearity, states that if a system's input is scaled by a factor, its output is scaled by the same factor. Here, the input is a source term $ \\hat{s} $ and the output is the acoustic pressure field $ \\hat{p} $.\n\nThe implementation proceeds in four stages: discretization of the governing partial differential equation (PDE), assembly of the resulting linear algebraic system, solution of the system for two different source scalings, and a final quantitative comparison of the solutions.\n\n**1. Discretization of the Helmholtz Equation**\n\nThe governing PDE for the complex pressure amplitude $ \\hat{p}(x,y) $ in a two-dimensional homogeneous medium is the Helmholtz equation:\n$$\n\\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s}(x,y)\n$$\nwhere $ \\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} $ is the Laplacian operator, $ k = \\omega/c $ is the acoustic wavenumber with angular frequency $ \\omega = 2 \\pi f $ and sound speed $ c $. The problem is defined on a rectangular domain $ \\Omega = [0, L_x] \\times [0, L_y] $ with homogeneous Dirichlet boundary conditions, $ \\hat{p} = 0 $ on the boundary $ \\partial\\Omega $.\n\nWe discretize this domain using a uniform Cartesian grid with $ N_x $ points in the $ x $-direction and $ N_y $ points in the $ y $-direction. The grid spacings are $ h_x = L_x / (N_x - 1) $ and $ h_y = L_y / (N_y - 1) $. A grid point is denoted by $ (x_i, y_j) $ where $ x_i = i h_x $ for $ i=0, \\dots, N_x-1 $ and $ y_j = j h_y $ for $ j=0, \\dots, N_y-1 $. The discrete pressure at this point is $ \\hat{p}_{i,j} $.\n\nThe Laplacian operator is approximated using a second-order central finite difference scheme. At an interior grid point $ (x_i, y_j) $, where $ 1 \\le i \\le N_x-2 $ and $ 1 \\le j \\le N_y-2 $, the PDE becomes:\n$$\n\\frac{\\hat{p}_{i-1,j} - 2\\hat{p}_{i,j} + \\hat{p}_{i+1,j}}{h_x^2} + \\frac{\\hat{p}_{i,j-1} - 2\\hat{p}_{i,j} + \\hat{p}_{i,j+1}}{h_y^2} + k^2 \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\nwhere $ \\hat{s}_{i,j} $ is the source term evaluated at $ (x_i, y_j) $. The boundary conditions $ \\hat{p}=0 $ are enforced by setting the pressure values on the boundary grid points to $ 0 $. Rearranging the terms for the unknown $ \\hat{p}_{i,j} $ gives the discrete linear equation for each interior point:\n$$\n\\frac{1}{h_x^2} \\hat{p}_{i-1,j} + \\frac{1}{h_x^2} \\hat{p}_{i+1,j} + \\frac{1}{h_y^2} \\hat{p}_{i,j-1} + \\frac{1}{h_y^2} \\hat{p}_{i,j+1} + \\left(k^2 - \\frac{2}{h_x^2} - \\frac{2}{h_y^2}\\right) \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\n\n**2. Linear System Formulation**\n\nThe set of discrete equations for all $ (N_x-2)(N_y-2) $ interior points forms a large, sparse system of linear equations, which can be expressed in matrix form as:\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}\n$$\nHere, $ \\mathbf{p} $ is a vector of length $ N_{int} = (N_x-2)(N_y-2) $ containing the unknown complex pressure amplitudes $ \\hat{p}_{i,j} $ at the interior grid points, ordered using a row-major flattening scheme. The right-hand side vector $ \\mathbf{b} = -\\mathbf{s} $, where $ \\mathbf{s} $ is the flattened vector of source term values at the same interior points. The matrix $ \\mathbf{A} $ is a sparse, complex-valued matrix of size $ N_{int} \\times N_{int} $ representing the discretized Helmholtz operator.\n\nA robust and elegant method for constructing $ \\mathbf{A} $ is via Kronecker products. The discrete 2D Laplacian operator $ L_{2D} $ can be expressed as:\n$$\nL_{2D} = I_y \\otimes L_{1D,x} + L_{1D,y} \\otimes I_x\n$$\nwhere $ L_{1D,x} $ and $ L_{1D,y} $ are the sparse matrices representing the 1D second-order finite difference Laplacian in the $ x $ and $ y $ directions, respectively, and $ I_x $ and $ I_y $ are identity matrices of appropriate sizes. The full system matrix $ \\mathbf{A} $ is then:\n$$\n\\mathbf{A} = L_{2D} + k^2 I\n$$\nwhere $ I $ is the identity matrix of size $ N_{int} $. This construction yields a sparse matrix that can be solved efficiently.\n\n**3. Numerical Verification Procedure**\n\nThe verification of the superposition principle is performed as follows. First, the source vector $ \\mathbf{s} $ is constructed from the specified Gaussian function with base amplitude $ A_s $. The linear system is solved for the base pressure field $ \\mathbf{p}_0 $:\n$$\n\\mathbf{A} \\mathbf{p}_0 = -\\mathbf{s}\n$$\nNext, the source is scaled by a factor $ \\alpha $, and the system is solved again for the scaled pressure field $ \\mathbf{p}_\\alpha $:\n$$\n\\mathbf{A} \\mathbf{p}_\\alpha = -(\\alpha \\mathbf{s})\n$$\nDue to the linearity of the matrix equation, the exact analytical solution for the scaled system is simply $ \\alpha \\mathbf{p}_0 $, since $ \\mathbf{A}(\\alpha \\mathbf{p}_0) = \\alpha (\\mathbf{A} \\mathbf{p}_0) = \\alpha(-\\mathbf{s}) = -(\\alpha\\mathbf{s}) $. However, numerical solutions obtained using finite-precision floating-point arithmetic will exhibit small discrepancies. The goal is to quantify this numerical deviation.\n\nThe deviation is measured by the infinity-norm of the difference between the computed scaled solution $ \\mathbf{p}_\\alpha $ and the scaled base solution $ \\alpha \\mathbf{p}_0 $:\n$$\n\\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha p_{0,i} |\n$$\nThis deviation is compared against a mixed absolute-relative tolerance criterion. The reference magnitude is the infinity-norm of the expected scaled solution:\n$$\nM_\\infty = \\max_i | \\alpha p_{0,i} |\n$$\nThe superposition principle is considered numerically verified if the deviation is within the specified tolerance bounds:\n$$\n\\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} M_\\infty\n$$\nwhere $ \\varepsilon_{\\mathrm{abs}} $ is the absolute tolerance (in Pascals) and $ \\varepsilon_{\\mathrm{rel}} $ is the dimensionless relative tolerance. This check confirms that the numerical implementation, including the linear solver, behaves linearly up to a predictable and controllable level of floating-point error. For the special case where $ \\alpha = 0 $, the scaled source is zero, leading to an expected solution of zero. The check simplifies to $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} | \\le \\varepsilon_{\\mathrm{abs}} $.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.sparse\nimport scipy.sparse.linalg\n\ndef _create_laplacian_1d(num_points, h):\n    \"\"\"\n    Creates a 1D finite difference Laplacian matrix for interior points.\n\n    Args:\n        num_points (int): Total number of grid points in the dimension.\n        h (float): Grid spacing.\n\n    Returns:\n        scipy.sparse.csr_matrix: The (num_points-2) x (num_points-2) sparse matrix.\n    \"\"\"\n    M = num_points - 2\n    if M = 0:\n        return scipy.sparse.csr_matrix((0, 0))\n    \n    # Stencil for d^2/dx^2 is [1, -2, 1] / h^2\n    diag_vals = np.ones(M, dtype=np.float64)\n    offsets = [-1, 0, 1]\n    L_1d = scipy.sparse.spdiags([diag_vals, -2 * diag_vals, diag_vals], offsets, M, M, format='csr') / h**2\n    return L_1d\n\ndef _run_verification(Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel):\n    \"\"\"\n    Performs the superposition principle verification for a single test case.\n    \"\"\"\n    # Physical and numerical constants\n    C_SOUND = 343.0\n    \n    # Discretization parameters\n    hx = Lx / (Nx - 1)\n    hy = Ly / (Ny - 1)\n    \n    # Physics parameters\n    omega = 2.0 * np.pi * f\n    k = omega / C_SOUND\n    \n    # Interior grid dimensions\n    Nx_int = Nx - 2\n    Ny_int = Ny - 2\n    N_int = Nx_int * Ny_int\n\n    if N_int == 0:\n        # No interior points. The pressure vector is empty.\n        # This case is excluded by problem constraints (Nx, Ny >= 3),\n        # but for robustness, we define success as the deviation (0) being\n        # less than or equal to the absolute tolerance.\n        return 0.0 = eps_abs\n\n    # Assemble the Helmholtz operator matrix A using Kronecker products\n    L_1d_x = _create_laplacian_1d(Nx, hx)\n    L_1d_y = _create_laplacian_1d(Ny, hy)\n    \n    I_x = scipy.sparse.identity(Nx_int)\n    I_y = scipy.sparse.identity(Ny_int)\n    \n    L_2d = scipy.sparse.kron(I_y, L_1d_x) + scipy.sparse.kron(L_1d_y, I_x)\n    A = L_2d + (k**2) * scipy.sparse.identity(N_int)\n    \n    # Use complex numbers as is standard for frequency-domain problems\n    A = A.astype(np.complex128)\n\n    # Assemble the source vector s\n    x_int = np.linspace(hx, Lx - hx, Nx_int)\n    y_int = np.linspace(hy, Ly - hy, Ny_int)\n    X_int, Y_int = np.meshgrid(x_int, y_int)\n    \n    x0, y0 = Lx / 2.0, Ly / 2.0\n    source_grid = As * np.exp(-((X_int - x0)**2 + (Y_int - y0)**2) / (2.0 * sigma**2))\n    s_vec = source_grid.flatten().astype(np.complex128)\n    \n    # We solve Ap = -s. The right-hand side is -s.\n    rhs_base = -s_vec\n    \n    # Solve for the base pressure field p0\n    p0 = scipy.sparse.linalg.spsolve(A, rhs_base)\n    \n    # Solve for the scaled pressure field p_alpha\n    rhs_scaled = -alpha * s_vec\n    p_alpha = scipy.sparse.linalg.spsolve(A, rhs_scaled)\n    \n    # Perform the verification check\n    # The comparison alpha * p0 represents the expected result from linearity\n    expected_p_alpha = alpha * p0\n    \n    # Calculate infinity-norm deviation\n    # Using np.abs for complex magnitude\n    delta_inf = np.max(np.abs(p_alpha - expected_p_alpha))\n    \n    # Calculate reference magnitude\n    M_inf = np.max(np.abs(expected_p_alpha))\n    \n    # Apply the verification criterion\n    passed = delta_inf = eps_abs + eps_rel * M_inf\n    \n    return passed\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel)\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 2.5, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 0.0, 1.0e-12, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 100.0, 1.0e-9, 1.0e-12),\n        (1.0, 1.0, 12, 9, 50.0, 1.0, 0.05, 5.0, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 3.0, 0.0, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = _run_verification(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
            "answer": "`[True,True,True,True,False]`"
        }
    ]
}