{
    "hands_on_practices": [
        {
            "introduction": "In a standing wave, energy does not propagate but is spatially localized. This foundational exercise guides you through a first-principles derivation of how this trapped energy is partitioned between kinetic and potential forms. By analyzing this \"sloshing\" of energy , you will develop a deeper physical intuition for what pressure and velocity nodes and antinodes represent from an energetic standpoint.",
            "id": "4112657",
            "problem": "A lossless, homogeneous fluid of mass density $\\rho$ and adiabatic sound speed $c$ supports small-amplitude one-dimensional acoustic motion along the $x$-axis. Consider a monochromatic standing plane wave formed by the superposition of two counter-propagating, equal-amplitude traveling waves of angular frequency $\\omega$ and wavenumber $k$. Let $p(x,t)$ denote the acoustic pressure fluctuation and $v(x,t)$ the particle velocity. Starting strictly from the linearized momentum equation and the linearized continuity equation for adiabatic acoustics,\n$$\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x},\\qquad \\frac{\\partial p}{\\partial t}=-\\rho c^{2}\\,\\frac{\\partial v}{\\partial x},$$\nderive the explicit real-valued spatiotemporal fields $p(x,t)$ and $v(x,t)$ for the standing wave in terms of a real pressure amplitude $P$.\n\nUsing the fundamental definitions of instantaneous kinetic and potential acoustic energy densities,\n$$u_{k}(x,t)=\\frac{1}{2}\\,\\rho\\,v(x,t)^{2},\\qquad u_{p}(x,t)=\\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}},$$\ncompute the cycle-averaged ratio $R(x)=\\langle u_{k}(x,t)\\rangle_{t}/\\langle u_{p}(x,t)\\rangle_{t}$ as a closed-form function of position $x$, where $\\langle\\cdot\\rangle_{t}$ denotes averaging over one temporal period $T=2\\pi/\\omega$. From this $R(x)$, evaluate and interpret the behavior at pressure antinodes and velocity antinodes, explaining the local “sloshing” of energy between kinetic and potential forms and its phase structure in time. Express your final answer for the function $R(x)$ as a symbolic expression; no numerical rounding is required. The interpretation should be qualitative, but the reported $R(x)$ must be an analytic expression.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Fluid Properties**: Lossless, homogeneous fluid with mass density $\\rho$ and adiabatic sound speed $c$.\n- **Motion**: One-dimensional ($x$-axis), small-amplitude acoustic motion.\n- **Wave Type**: Monochromatic standing plane wave with angular frequency $\\omega$ and wavenumber $k$.\n- **Governing Equations (Linearized)**:\n  - Momentum: $\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x}$\n  - Continuity: $\\frac{\\partial p}{\\partial t}=-\\rho c^{2}\\,\\frac{\\partial v}{\\partial x}$\n- **Field Variables**: Acoustic pressure fluctuation $p(x,t)$, particle velocity $v(x,t)$.\n- **Energy Density Definitions (Instantaneous)**:\n  - Kinetic: $u_{k}(x,t)=\\frac{1}{2}\\,\\rho\\,v(x,t)^{2}$\n  - Potential: $u_{p}(x,t)=\\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}}$\n- **Required Output**:\n  1. Explicit real-valued spatiotemporal fields $p(x,t)$ and $v(x,t)$ in terms of a real pressure amplitude $P$.\n  2. The cycle-averaged ratio $R(x)=\\langle u_{k}(x,t)\\rangle_{t}/\\langle u_{p}(x,t)\\rangle_{t}$, where averaging is over one temporal period $T=2\\pi/\\omega$.\n  3. Interpretation of $R(x)$ at pressure and velocity antinodes, including the local energy \"sloshing\".\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is examined against the validation criteria.\n\n- **Scientifically Grounded**: The problem is based on the fundamental linearized equations of acoustics, which are a cornerstone of wave physics. The definitions of kinetic and potential energy density are standard for acoustic fields. The concept of a standing wave formed by a superposition of counter-propagating waves is a classic and physically sound model. All premises are factually and scientifically sound.\n- **Well-Posed**: The problem provides all necessary equations, definitions, and constraints to derive the requested quantities. The tasks are clearly defined, leading to a unique analytical solution for the ratio $R(x)$.\n- **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology. It is free of subjective language or opinion.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed, scientifically grounded problem from the field of acoustics. A solution will now be derived.\n\nFirst, we derive the expressions for the pressure field $p(x,t)$ and velocity field $v(x,t)$ for a standing wave. A one-dimensional standing wave can be represented as the superposition of two identical traveling waves propagating in opposite directions. Let the two pressure waves be $p_1(x,t)$ and $p_2(x,t)$, representing forward and backward propagation respectively. In complex notation, these can be written as:\n$$p_1(x,t) = \\tilde{A} \\exp(i(\\omega t - kx))$$\n$$p_2(x,t) = \\tilde{A} \\exp(i(\\omega t + kx))$$\nThe total pressure field $p(x,t)$ is the real part of their sum:\n$$p(x,t) = \\Re[p_1(x,t) + p_2(x,t)] = \\Re[\\tilde{A} \\exp(i\\omega t) (\\exp(-ikx) + \\exp(ikx))]$$\nUsing Euler's formula, $\\exp(-ikx) + \\exp(ikx) = 2\\cos(kx)$, we get:\n$$p(x,t) = \\Re[2\\tilde{A} \\cos(kx) \\exp(i\\omega t)]$$\nThe problem specifies that the fields should be in terms of a real pressure amplitude $P$. We can set the complex amplitude $2\\tilde{A}$ to be the real value $P$. This choice corresponds to setting the phase of the standing wave.\n$$p(x,t) = \\Re[P \\cos(kx) (\\cos(\\omega t) + i \\sin(\\omega t))] = P \\cos(kx) \\cos(\\omega t)$$\n\nNext, we derive the particle velocity $v(x,t)$ from the pressure $p(x,t)$ using the linearized momentum equation:\n$$\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x}$$\nFirst, compute the spatial derivative of the pressure:\n$$\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x} [P \\cos(kx) \\cos(\\omega t)] = -Pk \\sin(kx) \\cos(\\omega t)$$\nSubstitute this into the momentum equation:\n$$\\rho\\,\\frac{\\partial v}{\\partial t} = -(-Pk \\sin(kx) \\cos(\\omega t)) = Pk \\sin(kx) \\cos(\\omega t)$$\nTo find $v(x,t)$, we integrate with respect to time $t$:\n$$v(x,t) = \\int \\frac{Pk}{\\rho} \\sin(kx) \\cos(\\omega t) dt = \\frac{Pk}{\\rho\\omega} \\sin(kx) \\sin(\\omega t)$$\nThe constant of integration is zero for a purely oscillatory acoustic field with no mean flow. For a lossless medium, the dispersion relation is $\\omega = ck$, which implies $k/\\omega = 1/c$. Substituting this, we obtain the final expression for velocity:\n$$v(x,t) = \\frac{P}{\\rho c} \\sin(kx) \\sin(\\omega t)$$\nThese expressions for $p(x,t)$ and $v(x,t)$ show that the pressure and velocity are in spatial quadrature ($\\cos(kx)$ vs. $\\sin(kx)$) and temporal quadrature ($\\cos(\\omega t)$ vs. $\\sin(\\omega t)$).\n\nNow, we compute the instantaneous kinetic and potential energy densities using their definitions:\n$$u_{k}(x,t) = \\frac{1}{2}\\,\\rho\\,v(x,t)^{2} = \\frac{1}{2}\\rho \\left(\\frac{P}{\\rho c} \\sin(kx) \\sin(\\omega t)\\right)^2 = \\frac{P^2}{2\\rho c^2} \\sin^2(kx) \\sin^2(\\omega t)$$\n$$u_{p}(x,t) = \\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}} = \\frac{(P \\cos(kx) \\cos(\\omega t))^2}{2\\rho c^2} = \\frac{P^2}{2\\rho c^2} \\cos^2(kx) \\cos^2(\\omega t)$$\n\nThe next step is to compute the time-average of these quantities over one period $T = 2\\pi/\\omega$. The time-average of a function $f(t)$ is $\\langle f(t) \\rangle_{t} = \\frac{1}{T}\\int_{0}^{T} f(t) dt$. We need the average of the trigonometric terms:\n$$\\langle \\sin^2(\\omega t) \\rangle_t = \\frac{1}{T}\\int_{0}^{T} \\sin^2(\\omega t) dt = \\frac{1}{T}\\int_{0}^{T} \\frac{1 - \\cos(2\\omega t)}{2} dt = \\frac{1}{2}$$\n$$\\langle \\cos^2(\\omega t) \\rangle_t = \\frac{1}{T}\\int_{0}^{T} \\cos^2(\\omega t) dt = \\frac{1}{T}\\int_{0}^{T} \\frac{1 + \\cos(2\\omega t)}{2} dt = \\frac{1}{2}$$\nThe integrals of $\\cos(2\\omega t)$ over the period $T$ are zero.\n\nUsing these results, we find the time-averaged energy densities:\n$$\\langle u_{k}(x,t) \\rangle_{t} = \\frac{P^2}{2\\rho c^2} \\sin^2(kx) \\langle \\sin^2(\\omega t) \\rangle_{t} = \\frac{P^2}{4\\rho c^2} \\sin^2(kx)$$\n$$\\langle u_{p}(x,t) \\rangle_{t} = \\frac{P^2}{2\\rho c^2} \\cos^2(kx) \\langle \\cos^2(\\omega t) \\rangle_{t} = \\frac{P^2}{4\\rho c^2} \\cos^2(kx)$$\n\nFinally, we compute the ratio $R(x)$:\n$$R(x) = \\frac{\\langle u_{k}(x,t)\\rangle_{t}}{\\langle u_{p}(x,t)\\rangle_{t}} = \\frac{\\frac{P^2}{4\\rho c^2} \\sin^2(kx)}{\\frac{P^2}{4\\rho c^2} \\cos^2(kx)} = \\frac{\\sin^2(kx)}{\\cos^2(kx)} = \\tan^2(kx)$$\n\nInterpretation of the result:\n- **At pressure antinodes**: These are locations where the pressure amplitude $|\\cos(kx)|$ is maximal, i.e., $|\\cos(kx)|=1$. This occurs at $kx = n\\pi$ for any integer $n$. At these points, $\\sin(kx) = 0$, so $R(x) = \\tan^2(n\\pi) = 0$. This signifies that the time-averaged kinetic energy density is zero. These are velocity nodes, where $v(x,t)=0$ for all $t$. The acoustic energy at these locations is, on average, purely potential.\n- **At velocity antinodes**: These are locations where the velocity amplitude $|\\sin(kx)|$ is maximal, i.e., $|\\sin(kx)|=1$. This occurs at $kx = (n + 1/2)\\pi$ for any integer $n$. At these points, $\\cos(kx) = 0$, and the ratio $R(x) = \\tan^2((n+1/2)\\pi)$ is singular (approaches infinity). This signifies that the time-averaged potential energy density is zero. These are pressure nodes, where $p(x,t)=0$ for all $t$. The acoustic energy at these locations is, on average, purely kinetic.\n\nThe local \"sloshing\" of energy refers to the temporal exchange between kinetic and potential forms. At any fixed position $x$ (that is not a node or antinode), the energy continuously transforms. The instantaneous kinetic energy $u_k \\propto \\sin^2(\\omega t)$ is maximum when the potential energy $u_p \\propto \\cos^2(\\omega t)$ is zero, and vice-versa. This is because $p(x,t)$ and $v(x,t)$ are out of phase by $\\pi/2$ in time. Energy is entirely potential at $t=n\\pi/\\omega$ and entirely kinetic a quarter-period later at $t=(n+1/2)\\pi/\\omega$. This periodic conversion from one form to another at a fixed point, without net propagation, is the characteristic energy dynamic of a standing wave. The function $R(x) = \\tan^2(kx)$ quantifies the spatial partitioning of the time-averaged energy budget between its kinetic and potential forms. Note that the total time-averaged energy density $\\langle u \\rangle_t = \\langle u_k \\rangle_t + \\langle u_p \\rangle_t = \\frac{P^2}{4\\rho c^2}(\\sin^2(kx) + \\cos^2(kx)) = \\frac{P^2}{4\\rho c^2}$ is constant in space, a hallmark of an ideal one-dimensional standing wave.",
            "answer": "$$\\boxed{\\tan^2(kx)}$$"
        },
        {
            "introduction": "Acoustic signals are often transient pulses rather than continuous waves. This practice investigates the evolution of a wave packet's energy as it travels through a realistic, dispersive medium, where different frequencies travel at different speeds. Applying Fourier methods , you will demonstrate that while group velocity dispersion causes the pulse to broaden and its peak energy density to decrease, the total integrated energy is conserved, a crucial concept in wave dynamics.",
            "id": "4112663",
            "problem": "Consider one-dimensional, small-amplitude, plane-wave propagation in a linear, lossless, weakly dispersive acoustic medium along the coordinate $z$. Let the carrier angular frequency be $\\omega_{0}$ and the corresponding phase speed be $c_{0} = \\omega_{0}/k_{0}$, where $k_{0} = k(\\omega_{0})$ is the wavenumber at the carrier. The medium’s wavenumber is analytic near $\\omega_{0}$ and admits the Taylor expansion $k(\\omega_{0} + \\Omega) = k_{0} + k_{1} \\Omega + \\tfrac{1}{2} k_{2} \\Omega^{2}$, where $k_{1} = \\left.\\dfrac{d k}{d \\omega}\\right|_{\\omega_{0}}$ and $k_{2} = \\left.\\dfrac{d^{2} k}{d \\omega^{2}}\\right|_{\\omega_{0}}$. The parameter $k_{2}$ is the Group Velocity Dispersion (GVD), and the product $k_{2} z$ is the Group Delay Dispersion (GDD) accrued over the distance $z$.\n\nAt $z = 0$, launch a narrowband, zero-chirp Gaussian complex pressure envelope $\\tilde{p}(t,0) = p_{0} \\exp\\!\\big(-t^{2}/(2 T_{0}^{2})\\big)$, modulating the carrier at $\\omega_{0}$. Assume plane-wave impedance $Z_{0} = \\rho c_{0}$, with $\\rho$ the ambient mass density, and that the narrowband relation $\\tilde{v}(t,0) \\approx \\tilde{p}(t,0)/(\\rho c_{0})$ holds for the complex envelope of particle velocity. Define the cycle-averaged acoustic energy density of the envelope by $u_{\\mathrm{env}}(t,z) = \\dfrac{|\\tilde{p}(t,z)|^{2}}{2 \\rho c_{0}^{2}}$, which follows from the standard plane-wave partition into kinetic and potential energy densities in linear acoustics.\n\nUsing a spectral (Fourier) propagation model consistent with computational acoustics and the given dispersion expansion, derive the exact Gaussian-envelope solution at distance $z$ in the retarded time $\\tau = t - k_{1} z$, and use it to:\n- demonstrate qualitatively and quantitatively that nonzero GVD ($k_{2} \\neq 0$) broadens the envelope while preserving the total cycle-averaged energy $\\int_{-\\infty}^{\\infty} u_{\\mathrm{env}}(\\tau,z)\\, d\\tau$ in this lossless medium,\n- and obtain the exact analytic expression for the peak cycle-averaged acoustic energy density $u_{\\mathrm{peak}}(z) = \\max_{\\tau} u_{\\mathrm{env}}(\\tau,z)$.\n\nExpress your final answer for $u_{\\mathrm{peak}}(z)$ as a single closed-form analytic expression in Joules per cubic meter (J m$^{-3}$). No numerical evaluation or rounding is required; provide the symbolic expression only.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Medium:** One-dimensional, linear, lossless, weakly dispersive acoustic medium.\n- **Propagation direction:** $z$-axis.\n- **Wave type:** Small-amplitude plane wave.\n- **Carrier angular frequency:** $\\omega_{0}$.\n- **Phase speed at carrier:** $c_{0} = \\omega_{0}/k_{0}$, where $k_{0} = k(\\omega_{0})$.\n- **Wavenumber expansion:** $k(\\omega_{0} + \\Omega) = k_{0} + k_{1} \\Omega + \\tfrac{1}{2} k_{2} \\Omega^{2}$, with $\\Omega = \\omega - \\omega_{0}$.\n- **Dispersion parameters:** $k_{1} = \\left.\\dfrac{d k}{d \\omega}\\right|_{\\omega_{0}}$, $k_{2} = \\left.\\dfrac{d^{2} k}{d \\omega^{2}}\\right|_{\\omega_{0}}$.\n- **Initial condition at $z=0$:** Complex pressure envelope $\\tilde{p}(t,0) = p_{0} \\exp\\big(-t^{2}/(2 T_{0}^{2})\\big)$. The envelope is a zero-chirp Gaussian.\n- **Acoustic impedance:** $Z_{0} = \\rho c_{0}$, where $\\rho$ is the ambient mass density.\n- **Particle velocity envelope:** $\\tilde{v}(t,0) \\approx \\tilde{p}(t,0)/(\\rho c_{0})$.\n- **Energy density definition:** Cycle-averaged acoustic energy density of the envelope is $u_{\\mathrm{env}}(t,z) = \\dfrac{|\\tilde{p}(t,z)|^{2}}{2 \\rho c_{0}^{2}}$.\n- **Frame of reference:** Retarded time $\\tau = t - k_{1} z$.\n- **Method:** Spectral (Fourier) propagation model.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is a standard exercise in linear wave propagation theory, specifically analyzing pulse dispersion in acoustics.\n- **Scientifically Grounded:** The setup is based on fundamental principles of linear acoustics. The use of a Taylor series for the dispersion relation $k(\\omega)$ is a standard and valid approximation for narrowband pulses in weakly dispersive media. The definitions of group velocity and group velocity dispersion are standard. The expressions for acoustic impedance and energy density are correct for plane waves.\n- **Well-Posed:** The problem provides a well-defined initial condition (a Gaussian pulse) and a clear physical model for its propagation (linear wave equation with second-order dispersion). This structure guarantees that a unique, stable, and meaningful solution exists.\n- **Objective:** The problem is stated using precise mathematical and physical terminology, free of ambiguity or subjective claims.\n\nThe problem is free of any of the invalidating flaws listed in the instructions. It represents a classic, solvable problem in wave physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Propagated Envelope\nThe solution is found using a spectral method, which involves transforming the initial condition to the frequency domain, applying a propagation operator, and then transforming back to the time domain.\n\nThe complex envelope of the pressure at $z=0$ is given by\n$$\n\\tilde{p}(t,0) = p_{0} \\exp\\left(-\\frac{t^{2}}{2 T_{0}^{2}}\\right)\n$$\nWe define the Fourier transform pair for the envelope, with $\\Omega = \\omega - \\omega_{0}$ being the frequency offset from the carrier, as:\n$$\n\\tilde{P}(\\Omega, z) = \\int_{-\\infty}^{\\infty} \\tilde{p}(t,z) \\exp(i\\Omega t) \\,dt\n$$\n$$\n\\tilde{p}(t, z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{P}(\\Omega,z) \\exp(-i\\Omega t) \\,d\\Omega\n$$\nFirst, we find the Fourier transform of the initial envelope at $z=0$:\n$$\n\\tilde{P}(\\Omega, 0) = \\int_{-\\infty}^{\\infty} p_{0} \\exp\\left(-\\frac{t^{2}}{2 T_{0}^{2}}\\right) \\exp(i\\Omega t) \\,dt\n$$\nThis is a standard Gaussian integral. Using the formula $\\int_{-\\infty}^{\\infty} \\exp(-at^{2})\\exp(ibt) \\,dt = \\sqrt{\\pi/a} \\exp(-b^{2}/(4a))$, with $a = 1/(2T_{0}^{2})$ and $b=\\Omega$, we get:\n$$\n\\tilde{P}(\\Omega, 0) = p_{0} \\sqrt{\\frac{\\pi}{1/(2T_{0}^{2})}} \\exp\\left(-\\frac{\\Omega^{2}}{4/(2T_{0}^{2})}\\right) = p_{0} T_{0} \\sqrt{2\\pi} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right)\n$$\nIn a linear medium, each spectral component propagates with a phase factor $\\exp(i k(\\omega) z)$. For the complex envelope, the propagator relative to the carrier wavenumber $k_{0}$ is $\\exp(i[k(\\omega_{0}+\\Omega) - k_{0}]z)$. Using the given Taylor expansion for $k(\\omega_{0}+\\Omega)$:\n$$\nk(\\omega_{0}+\\Omega) - k_{0} = k_{1}\\Omega + \\frac{1}{2} k_{2}\\Omega^{2}\n$$\nThe spectral envelope at distance $z$ is then:\n$$\n\\tilde{P}(\\Omega, z) = \\tilde{P}(\\Omega, 0) \\exp\\left(i\\left[k_{1}\\Omega + \\frac{1}{2} k_{2}\\Omega^{2}\\right]z\\right)\n$$\nSubstituting the expression for $\\tilde{P}(\\Omega, 0)$:\n$$\n\\tilde{P}(\\Omega, z) = p_{0} T_{0} \\sqrt{2\\pi} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right) \\exp\\left(i k_{1}z\\Omega\\right) \\exp\\left(i\\frac{k_{2}z}{2}\\Omega^{2}\\right)\n$$\nTo find the envelope in the time domain, $\\tilde{p}(t,z)$, we perform the inverse Fourier transform:\n$$\n\\tilde{p}(t, z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{P}(\\Omega, z) \\exp(-i\\Omega t) \\,d\\Omega\n$$\n$$\n\\tilde{p}(t, z) = \\frac{p_{0} T_{0} \\sqrt{2\\pi}}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right) \\exp\\left(i k_{1}z\\Omega\\right) \\exp\\left(i\\frac{k_{2}z}{2}\\Omega^{2}\\right) \\exp(-i\\Omega t) \\,d\\Omega\n$$\nCombine terms in the exponent:\n$$\n\\tilde{p}(t, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\left[T_{0}^{2} - i k_{2}z\\right]\\Omega^{2} - i(t - k_{1}z)\\Omega\\right) \\,d\\Omega\n$$\nUsing the retarded time $\\tau = t - k_{1}z$, the integral becomes:\n$$\n\\tilde{p}(\\tau, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\left[T_{0}^{2} - i k_{2}z\\right]\\Omega^{2} - i\\tau\\Omega\\right) \\,d\\Omega\n$$\nThis is another Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-A\\Omega^{2} - B\\Omega) \\,d\\Omega = \\sqrt{\\pi/A} \\exp(B^{2}/(4A))$, with $A = \\frac{1}{2}(T_{0}^{2} - i k_{2}z)$ and $B = i\\tau$.\n$$\n\\int_{-\\infty}^{\\infty} \\dots \\,d\\Omega = \\sqrt{\\frac{\\pi}{\\frac{1}{2}(T_{0}^{2} - i k_{2}z)}} \\exp\\left(\\frac{(i\\tau)^{2}}{4 \\cdot \\frac{1}{2}(T_{0}^{2} - i k_{2}z)}\\right) = \\sqrt{\\frac{2\\pi}{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\nSubstituting this back into the expression for $\\tilde{p}(\\tau, z)$:\n$$\n\\tilde{p}(\\tau, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\sqrt{\\frac{2\\pi}{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\n$$\n\\tilde{p}(\\tau, z) = p_{0} \\frac{T_{0}}{\\sqrt{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\nThis is the exact Gaussian-envelope solution in the retarded time frame.\n\n### Envelope Broadening and Energy Conservation\nTo analyze the physical properties, we examine the magnitude squared of the envelope, $|\\tilde{p}(\\tau,z)|^{2}$.\n$$\n|\\tilde{p}(\\tau,z)|^{2} = |p_{0}|^{2} \\frac{|T_{0}|^{2}}{|T_{0}^{2} - i k_{2}z|} \\left|\\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\\right|^{2}\n$$\nAssuming $p_0$ and $T_0$ are real, $|p_0|^2=p_0^2$ and $|T_0|^2=T_0^2$. The denominator term is $|T_{0}^{2} - i k_{2}z| = \\sqrt{(T_{0}^{2})^{2} + (-k_{2}z)^{2}} = \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}$.\nThe exponential term's squared magnitude is $\\exp[2 \\cdot \\mathrm{Re}(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)})]$.\nThe argument of the exponent is:\n$$\n-\\frac{\\tau^{2}}{2} \\frac{1}{T_{0}^{2} - i k_{2}z} = -\\frac{\\tau^{2}}{2} \\frac{T_{0}^{2} + i k_{2}z}{T_{0}^{4} + (k_{2}z)^{2}}\n$$\nIts real part is $-\\frac{\\tau^{2}T_{0}^{2}}{2(T_{0}^{4} + (k_{2}z)^{2})}$. Thus, the squared magnitude of the exponential is $\\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right)$.\nCombining the parts:\n$$\n|\\tilde{p}(\\tau,z)|^{2} = p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right)\n$$\nThe initial intensity profile is $|\\tilde{p}(t,0)|^{2} = p_{0}^{2}\\exp(-t^{2}/T_{0}^{2})$. Its characteristic width squared (at $1/e$ of the peak) is $T_{0}^{2}$. The propagated intensity profile can be written as $|\\tilde{p}(\\tau,z)|^{2} = A(z)\\exp(-\\tau^{2}/T(z)^{2})$, where the new width squared is:\n$$\nT(z)^{2} = \\frac{T_{0}^{4} + (k_{2}z)^{2}}{T_{0}^{2}} = T_{0}^{2}\\left(1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}\\right)\n$$\nSince $(k_{2}z/T_{0}^{2})^{2} \\ge 0$, the pulse width $T(z)$ is always greater than or equal to the initial width $T_{0}$. $T(z) = T_0$ only if $k_2=0$ or $z=0$. This quantitatively demonstrates that nonzero GVD ($k_{2} \\neq 0$) causes the envelope to broaden as it propagates.\n\nNext, we check the conservation of total cycle-averaged energy, $E_{\\mathrm{total}} = \\int_{-\\infty}^{\\infty} u_{\\mathrm{env}}(\\tau,z)\\, d\\tau$.\n$$\nE_{\\mathrm{total}}(z) = \\int_{-\\infty}^{\\infty} \\frac{|\\tilde{p}(\\tau,z)|^{2}}{2 \\rho c_{0}^{2}} \\,d\\tau = \\frac{1}{2 \\rho c_{0}^{2}} \\int_{-\\infty}^{\\infty} |\\tilde{p}(\\tau,z)|^{2} \\,d\\tau\n$$\n$$\nE_{\\mathrm{total}}(z) = \\frac{p_{0}^{2} T_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right) \\,d\\tau\n$$\nThe integral is of the form $\\int_{-\\infty}^{\\infty} \\exp(-a\\tau^{2})d\\tau = \\sqrt{\\pi/a}$, with $a = T_{0}^{2}/(T_{0}^{4} + (k_{2}z)^{2})$.\n$$\n\\int_{-\\infty}^{\\infty} \\dots \\,d\\tau = \\sqrt{\\frac{\\pi (T_{0}^{4} + (k_{2}z)^{2})}{T_{0}^{2}}} = \\frac{\\sqrt{\\pi} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}{T_{0}}\n$$\nSubstituting this into the energy expression:\n$$\nE_{\\mathrm{total}}(z) = \\frac{p_{0}^{2} T_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\cdot \\frac{\\sqrt{\\pi} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}{T_{0}} = \\frac{p_{0}^{2} T_{0} \\sqrt{\\pi}}{2 \\rho c_{0}^{2}}\n$$\nThis expression is independent of $z$, which demonstrates that the total cycle-averaged energy is conserved, as expected for a lossless medium.\n\n### Peak Cycle-Averaged Acoustic Energy Density\nThe cycle-averaged acoustic energy density is $u_{\\mathrm{env}}(\\tau,z) = \\frac{|\\tilde{p}(\\tau,z)|^{2}}{2 \\rho c_{0}^{2}}$. The expression for $|\\tilde{p}(\\tau,z)|^{2}$ is a Gaussian function of $\\tau$ centered at $\\tau=0$. Its maximum value occurs at $\\tau=0$.\nThe peak energy density $u_{\\mathrm{peak}}(z)$ is the value of $u_{\\mathrm{env}}(\\tau,z)$ at $\\tau=0$.\n$$\nu_{\\mathrm{peak}}(z) = u_{\\mathrm{env}}(0,z) = \\frac{|\\tilde{p}(0,z)|^{2}}{2 \\rho c_{0}^{2}}\n$$\nSetting $\\tau=0$ in our expression for $|\\tilde{p}(\\tau,z)|^{2}$:\n$$\n|\\tilde{p}(0,z)|^{2} = p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}\n$$\nTherefore, the peak energy density is:\n$$\nu_{\\mathrm{peak}}(z) = \\frac{1}{2 \\rho c_{0}^{2}} \\left( p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\right) = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4}\\left(1 + \\frac{(k_{2}z)^{2}}{T_{0}^{4}}\\right)}}\n$$\n$$\nu_{\\mathrm{peak}}(z) = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{T_{0}^{2}}{T_{0}^{2}\\sqrt{1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}}} = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{1}{\\sqrt{1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}}}\n$$\nThe peak energy density at $z=0$ is $u_{\\mathrm{peak}}(0) = p_{0}^{2}/(2\\rho c_{0}^{2})$. As the pulse broadens, its peak amplitude decreases to conserve energy. The derived expression captures this physical behavior.",
            "answer": "$$\n\\boxed{\\frac{p_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{1 + \\left(\\frac{k_{2} z}{T_{0}^{2}}\\right)^{2}}}}\n$$"
        },
        {
            "introduction": "The ultimate test of understanding is often to build a predictive model from first principles. This advanced computational practice challenges you to implement a full numerical simulation of a transient acoustic scattering event. By computing the instantaneous acoustic energy flux from your simulation results , you will not only visualize the flow of energy in time but also verify causality—a cornerstone of physics—confirming the physical validity of your model.",
            "id": "4112673",
            "problem": "Design a numerical experiment in one spatial dimension to simulate a transient acoustic scattering event and to verify causality by ensuring that no energy flux arrives at a specified receiver location earlier than the earliest physically admissible travel time. The simulation must be based entirely on first principles for linear acoustics and must compute the instantaneous acoustic energy density and the instantaneous acoustic energy flux from the evolving acoustic pressure field and particle velocity field.\n\nStart from the linearized momentum conservation and mass conservation for a compressible, inviscid fluid with spatially varying material properties. The medium is piecewise homogeneous with one planar interface at a prescribed position. Implement a staggered-grid, explicit, second-order accurate finite-difference time-domain scheme that respects the Courant–Friedrichs–Lewy stability condition, and include an absorbing boundary treatment to avoid spurious reflections from the computational boundaries. Drive the system with a compact, bandlimited, scalar source at a single grid point using a physically sensible source-time function. The simulation must yield the transient acoustic pressure and particle velocity fields over time.\n\nFrom the simulated fields, compute at the receiver location the instantaneous acoustic energy density and the instantaneous acoustic energy flux. The instantaneous acoustic energy density combines the kinetic component and the compressive potential component. The instantaneous acoustic energy flux equals the acoustic intensity. In one dimension, the sign of the intensity indicates the direction of energy transport. You must derive the expressions used for these quantities from the governing first-principles equations; direct use of pre-memorized target formulas is not permitted.\n\nDefine the earliest physically admissible arrival time at the receiver as the path integral of the reciprocal local sound speed along the straight path between source and receiver through the piecewise homogeneous layers. In one dimension with a single interface at position $x_0$, source position $x_s$, and receiver position $x_r$, this earliest time reduces to a sum of segment lengths divided by the corresponding constant sound speeds in each segment.\n\nVerification of causality must proceed by thresholding the receiver’s instantaneous acoustic intensity time series: declare a causality violation if, for any time $t$ strictly less than the earliest travel time, the absolute magnitude of the instantaneous intensity exceeds a small fraction of the peak absolute intensity observed over the entire simulated time window. Use a fractional threshold of $10^{-5}$ of the peak, and guard against division by zero by adding a small positive floor if necessary.\n\nYour program must implement this experiment and perform the causality check for each of the following test cases. All quantities must be treated in the International System of Units, and any reported time must be in seconds. All distances are in meters, speeds in meters per second, densities in kilograms per cubic meter, pressure in pascals, and time in seconds. Angles do not appear and thus require no specification.\n\nEach test case is a tuple specifying the domain and material parameters, source and receiver placement, and numerical parameters:\n1. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1500.0, 1000.0, 1000.0, 1500.0, 1.5, 0.5, 2.5, 1200.0, 100.0, 0.7, 0.003)$\n2. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1500.0, 1500.0, 1000.0, 1000.0, 1.0, 0.6, 2.6, 2000.0, 80.0, 0.9, 0.003)$\n3. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1400.0, 800.0, 950.0, 1600.0, 2.4, 0.7, 2.45, 2500.0, 60.0, 0.8, 0.002)$\n4. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.2, 0.004, 1500.0, 2000.0, 1000.0, 1200.0, 1.3, 0.4, 2.8, 1800.0, 70.0, 0.99, 0.002)$\n\nWhere:\n- $L$ is the domain length,\n- $\\Delta x$ is the spatial grid spacing,\n- $c_1$ and $c_2$ are the sound speeds in the left and right layers, respectively,\n- $\\rho_1$ and $\\rho_2$ are the densities in the left and right layers, respectively,\n- $x_0$ is the interface position,\n- $x_s$ is the source position,\n- $x_r$ is the receiver position,\n- $f_0$ is the central frequency of a bandlimited source-time function,\n- $A$ is the source amplitude (pressure units),\n- $\\text{CFL}$ is the Courant number for the time step,\n- $T_{\\text{end}}$ is the total simulated time.\n\nYour program must:\n- Implement a staggered-grid finite-difference time-domain update for one-dimensional linear acoustics with spatially varying material properties and absorbing boundary layers.\n- Use a compact, bandlimited source-time function such as a Ricker wavelet centered at time $t_0 = \\frac{3}{f_0}$.\n- Compute at the receiver the instantaneous acoustic energy density and the instantaneous acoustic intensity at consistent time instants.\n- Compute the earliest travel time as the sum of segment lengths divided by the corresponding sound speeds along the straight source-to-receiver path through the two layers.\n- Decide causality for each test case by checking if the absolute intensity exceeds $10^{-5}$ of its peak value at any time earlier than the earliest travel time.\n- Produce a single line of output containing the boolean results for the four test cases as a comma-separated list enclosed in square brackets (for example, \"[True,False,True,True]\").\n\nYour final answers must be booleans for each of the four test cases, and the program must print them in the specified single-line format.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n\nThe problem provides the following data, definitions, and constraints for a numerical experiment in one-dimensional computational acoustics:\n\n**Governing Principles:**\n- Linearized momentum and mass conservation for a compressible, inviscid fluid.\n- Spatially varying material properties ($\\rho(x)$, $c(x)$).\n- A piecewise homogeneous medium with a single planar interface at $x_0$.\n- A staggered-grid, explicit, second-order accurate finite-difference time-domain (FDTD) scheme.\n- Courant–Friedrichs–Lewy (CFL) stability condition must be respected.\n- An absorbing boundary treatment is required.\n- A compact, bandlimited, scalar source at a single grid point, with a defined source-time function (e.g., Ricker wavelet).\n\n**Quantities to Compute and Analyze:**\n- Transient acoustic pressure field $p(x,t)$ and particle velocity field $v(x,t)$.\n- Instantaneous acoustic energy density, derived from first principles.\n- Instantaneous acoustic energy flux (intensity), derived from first principles.\n\n**Causality Verification Procedure:**\n- Define the earliest physically admissible arrival time $t_{\\text{arrival}}$ as the path integral of the reciprocal local sound speed. For the given 1D setup with source at $x_s$, receiver at $x_r$, interface at $x_0$, and sound speeds $c_1$ and $c_2$, this simplifies to a sum of travel times through segments.\n- Monitor the instantaneous intensity $I(t)$ at the receiver location $x_r$.\n- A causality violation is declared if $|I(t)| > 10^{-5} \\times \\max_t|I(t)|$ for any time $t < t_{\\text{arrival}}$. A small positive floor must be added to $\\max_t|I(t)|$ to prevent division by zero.\n\n**Test Cases (Parameters):**\nEach test case is a tuple: $(L, \\Delta x, c_1, c_2, \\rho_1, \\rho_2, x_0, x_s, x_r, f_0, A, \\text{CFL}, T_{\\text{end}})$.\n1. $(3.0, 0.005, 1500.0, 1000.0, 1000.0, 1500.0, 1.5, 0.5, 2.5, 1200.0, 100.0, 0.7, 0.003)$\n2. $(3.0, 0.005, 1500.0, 1500.0, 1000.0, 1000.0, 1.0, 0.6, 2.6, 2000.0, 80.0, 0.9, 0.003)$\n3. $(3.0, 0.005, 1400.0, 800.0, 950.0, 1600.0, 2.4, 0.7, 2.45, 2500.0, 60.0, 0.8, 0.002)$\n4. $(3.2, 0.004, 1500.0, 2000.0, 1000.0, 1200.0, 1.3, 0.4, 2.8, 1800.0, 70.0, 0.99, 0.002)$\n\n**Source-Time Function:**\n- Ricker wavelet centered at time $t_0 = 3/f_0$.\n\n**Output Format:**\n- A single line containing a comma-separated list of boolean results (e.g., `[True,False,True,True]`).\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded (Critical):** The problem is firmly rooted in the fundamental principles of linear acoustics, described by the linearized Euler equations. The FDTD method is a standard, scientifically validated technique for solving wave propagation problems. The concept of causality is a cornerstone of physics, and its verification in a numerical simulation is a standard and meaningful exercise. All proposed steps are based on established physics and numerical analysis.\n- **Well-Posed:** The problem provides all necessary parameters, governing equations, initial conditions (quiescent medium), boundary conditions (absorbing), and source terms to set up a well-posed initial-boundary value problem. The solution is expected to be unique and stable, given the satisfaction of the CFL condition.\n- **Objective (Critical):** The problem is stated in precise, objective, and quantitative terms. All parameters are explicitly defined, and the criteria for verification (the causality check) are unambiguous.\n- **No Flaws Detected:** The problem statement does not violate any of the invalidity criteria. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, trivial, or unverifiable. It describes a standard numerical experiment in computational physics.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A full solution will be provided.\n\n## Solution Derivation and Implementation Strategy\n\nThe solution involves simulating the one-dimensional linear acoustic equations and analyzing the results at a receiver to verify causality. The process is broken down into the following steps.\n\n**1. Governing Equations and Energy Conservation**\n\nWe begin with the first-principles equations for linear acoustics in an inviscid, compressible fluid. These are the linearized Euler equations for momentum and mass conservation in one dimension:\n$$\n\\rho_0(x) \\frac{\\partial v(x,t)}{\\partial t} = -\\frac{\\partial p(x,t)}{\\partial x} \\quad \\text{(Momentum Conservation)}\n$$\n$$\n\\frac{1}{K(x)} \\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial v(x,t)}{\\partial x} \\quad \\text{(Mass Conservation)}\n$$\nwhere $p$ is the acoustic pressure, $v$ is the particle velocity, $\\rho_0(x)$ is the ambient fluid density, and $K(x) = \\rho_0(x) c(x)^2$ is the bulk modulus, with $c(x)$ being the local sound speed.\n\nTo derive the law of energy conservation, we multiply the momentum equation by $v$ and the mass conservation equation by $p$:\n$$\n\\rho_0 v \\frac{\\partial v}{\\partial t} = -v \\frac{\\partial p}{\\partial x}\n$$\n$$\n\\frac{p}{K} \\frac{\\partial p}{\\partial t} = -p \\frac{\\partial v}{\\partial x}\n$$\nRecognizing that $u \\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t}(\\frac{1}{2}u^2)$, we can rewrite these as:\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\rho_0 v^2\\right) = -v \\frac{\\partial p}{\\partial x}\n$$\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\frac{p^2}{K}\\right) = -p \\frac{\\partial v}{\\partial x}\n$$\nSumming these two equations gives:\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\rho_0 v^2 + \\frac{1}{2}\\frac{p^2}{K}\\right) = -v \\frac{\\partial p}{\\partial x} - p \\frac{\\partial v}{\\partial x}\n$$\nThe right-hand side is the negative of the divergence of the product $pv$, i.e., $-\\frac{\\partial (pv)}{\\partial x}$. This yields the acoustic energy conservation law in differential form:\n$$\n\\frac{\\partial E(x,t)}{\\partial t} + \\frac{\\partial I_x(x,t)}{\\partial x} = 0\n$$\nFrom this derivation, we identify:\n- **Instantaneous Acoustic Energy Density ($E$)**: The sum of kinetic and potential energy densities.\n  $$ E(x,t) = \\underbrace{\\frac{1}{2}\\rho_0(x) v(x,t)^2}_{\\text{Kinetic}} + \\underbrace{\\frac{1}{2}\\frac{p(x,t)^2}{\\rho_0(x) c(x)^2}}_{\\text{Potential}} $$\n- **Instantaneous Acoustic Energy Flux or Intensity ($I_x$)**: The rate of energy transport per unit area.\n  $$ I_x(x,t) = p(x,t) v(x,t) $$\nThese expressions will be used to compute the required quantities from the simulated fields.\n\n**2. Finite-Difference Time-Domain (FDTD) Scheme**\n\nWe employ a staggered grid (Yee grid) for the numerical solution. Pressure $p$ is defined at integer spatial indices $i$ and integer time indices $n$, while velocity $v$ is defined at half-integer spatial indices $i+1/2$ and half-integer time indices $n+1/2$.\n- $p_i^n \\approx p(i\\Delta x, n\\Delta t)$\n- $v_{i+1/2}^{n+1/2} \\approx v((i+1/2)\\Delta x, (n+1/2)\\Delta t)$\n\nThe governing equations are discretized using second-order accurate central differences, leading to a leapfrog time-stepping scheme:\n$$\n\\frac{v_{i+1/2}^{n+1/2} - v_{i+1/2}^{n-1/2}}{\\Delta t} = -\\frac{1}{\\rho_{i+1/2}} \\frac{p_{i+1}^n - p_i^n}{\\Delta x}\n$$\n$$\n\\frac{p_i^{n+1} - p_i^n}{\\Delta t} = -K_i \\frac{v_{i+1/2}^{n+1/2} - v_{i-1/2}^{n+1/2}}{\\Delta x}\n$$\nThe material properties $\\rho_{i+1/2}$ on the velocity grid are computed by averaging the values from the adjacent pressure grid points: $\\rho_{i+1/2} = (\\rho_i + \\rho_{i+1})/2$.\nThe update equations are:\n1.  **Velocity Update**:\n    $$ v_{i+1/2}^{n+1/2} = v_{i+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_{i+1/2}\\Delta x} (p_{i+1}^n - p_i^n) $$\n2.  **Pressure Update**:\n    $$ p_i^{n+1} = p_i^n - \\frac{\\Delta t K_i}{\\Delta x} (v_{i+1/2}^{n+1/2} - v_{i-1/2}^{n+1/2}) $$\n\nThe time step $\\Delta t$ is selected based on the CFL condition to ensure stability: $\\Delta t = \\text{CFL} \\frac{\\Delta x}{c_{\\max}}$, where $c_{\\max} = \\max(c_1, c_2)$ and $\\text{CFL} \\le 1$.\n\n**3. Source, Boundaries, and Receiver**\n\n- **Source**: A soft source is implemented by adding a term to the pressure update equation at the source location $i_s$:\n  $$ p_{i_s}^{n+1} \\rightarrow p_{i_s}^{n+1} + \\Delta t \\cdot S(n\\Delta t) $$\n  The source-time function $S(t)$ is a Ricker wavelet:\n  $$ S(t) = A\\left(1 - 2\\pi^2 f_0^2 (t-t_0)^2\\right) e^{-\\pi^2 f_0^2 (t-t_0)^2} $$\n  with the peak-delay time $t_0 = 3/f_0$.\n\n- **Absorbing Boundary Conditions (ABCs)**: To prevent spurious reflections from the domain edges, first-order absorbing boundary conditions are applied. These simulate an outgoing wave by enforcing the one-way wave equation at the boundaries. At the left boundary ($i=0$) and right boundary ($i=N_x-1$):\n  $$ p_0^{n+1} = p_0^n(1 - \\alpha_0) + p_1^n \\alpha_0 $$\n  $$ p_{N_x-1}^{n+1} = p_{N_x-1}^n(1 - \\alpha_{N_x-1}) + p_{N_x-2}^n \\alpha_{N_x-1} $$\n  where $\\alpha_i = c_i \\Delta t / \\Delta x$ is the local Courant number. These updates use pressure values from the previous time step $n$ to explicitly compute the new boundary values at $n+1$.\n\n- **Receiver**: To compute intensity $I(t)$ at the receiver location $x_r$ (grid index $i_r$), we require $p$ and $v$ at the same time and location. Since the grid is staggered, interpolation is necessary. We compute quantities at half-integer time steps $t_{n+1/2}$:\n  - The velocity $v_{i_r}^{n+1/2}$ is spatially interpolated: $v_{i_r}^{n+1/2} = 0.5(v_{i_r-1/2}^{n+1/2} + v_{i_r}^{n+1/2})$. (Note: in code, if `v` has length `N-1`, this is `0.5*(v[ir-1] + v[ir])`).\n  - The pressure $p_{i_r}^{n+1/2}$ is temporally interpolated: $p_{i_r}^{n+1/2} = 0.5(p_{i_r}^n + p_{i_r}^{n+1})$.\n  The intensity is then $I_{i_r}^{n+1/2} = p_{i_r}^{n+1/2} \\cdot v_{i_r}^{n+1/2}$.\n\n**4. Causality Verification**\n\n- **Earliest Arrival Time ($t_{\\text{arrival}}$)**: This is the time taken for a wave to travel from the source $x_s$ to the receiver $x_r$. For a piecewise medium with an interface at $x_0$:\n  - If source and receiver are in the same segment (e.g., $x_s, x_r < x_0$ or $x_s, x_r > x_0$): $t_{\\text{arrival}} = |x_r - x_s| / c_{\\text{segment}}$.\n  - If they are in different segments (e.g., $x_s < x_0 < x_r$): $t_{\\text{arrival}} = |x_0 - x_s|/c_{\\text{source\\_segment}} + |x_r - x_0|/c_{\\text{receiver\\_segment}}$.\n\n- **Check**: We compute the peak absolute intensity $I_{\\text{peak}} = \\max_t|I(t)|$ over the entire simulation. The causality threshold is $I_{\\text{thresh}} = 10^{-5} \\times (I_{\\text{peak}} + \\epsilon)$, where $\\epsilon$ is a small machine epsilon to guard against a zero peak. We then iterate through the recorded intensity time series. If $|I(t_k)| > I_{\\text{thresh}}$ for any time $t_k < t_{\\text{arrival}}$, a causality violation is flagged. Otherwise, causality is considered verified. The result is a boolean `True` (causality respected) or `False` (violated).\n\nThis comprehensive procedure is implemented for each of the four test cases.",
            "answer": "$$\n\\boxed{\\text{[True,True,True,True]}}\n$$"
        }
    ]
}