{
    "hands_on_practices": [
        {
            "introduction": "驻波是声学中的一种基本干涉模式，其中能量不会净传播，而是在局部区域内存储和交换。本练习将通过分析一维理想驻波中动能和势能密度的分布，来深入理解这种能量的“晃荡”行为。通过从第一性原理出发推导动能与势能密度的时间平均值之比 ，您将能够清晰地揭示在波节和波腹等不同位置，声能是如何在两种形式之间转换的。",
            "id": "4112657",
            "problem": "一种无损的均匀流体，其质量密度为 $\\rho$，绝热声速为 $c$，支持沿 $x$ 轴的小振幅一维声学运动。考虑一个由角频率为 $\\omega$、波数为 $k$ 的两个振幅相等、反向传播的行波叠加而成的单色平面驻波。令 $p(x,t)$ 表示声压涨落，$v(x,t)$ 表示质点速度。严格从绝热声学的线性化动量方程和线性化连续性方程出发，\n$$\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x},\\qquad \\frac{\\partial p}{\\partial t}=-\\rho c^{2}\\,\\frac{\\partial v}{\\partial x},$$\n推导出该驻波的显式实值时空场 $p(x,t)$ 和 $v(x,t)$，用实值压力振幅 $P$ 表示。\n\n使用瞬时动能和势能声能密度的基本定义，\n$$u_{k}(x,t)=\\frac{1}{2}\\,\\rho\\,v(x,t)^{2},\\qquad u_{p}(x,t)=\\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}},$$\n计算周期平均比率 $R(x)=\\langle u_{k}(x,t)\\rangle_{t}/\\langle u_{p}(x,t)\\rangle_{t}$，作为位置 $x$ 的闭合形式函数，其中 $\\langle\\cdot\\rangle_{t}$ 表示在一个时间周期 $T=2\\pi/\\omega$ 内的平均。基于此 $R(x)$，评估并解释在压力波腹和速度波腹处的行为，解释能量在动能和势能形式之间的局部“晃荡”及其随时间变化的相位结构。将函数 $R(x)$ 的最终答案表示为符号表达式；无需进行数值舍入。解释应为定性的，但所报告的 $R(x)$ 必须是解析表达式。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n- **流体属性**：无损、均匀流体，质量密度为 $\\rho$，绝热声速为 $c$。\n- **运动**：一维（$x$ 轴）、小振幅声学运动。\n- **波类型**：单色平面驻波，角频率为 $\\omega$，波数为 $k$。\n- **控制方程（线性化）**：\n  - 动量方程：$\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x}$\n  - 连续性方程：$\\frac{\\partial p}{\\partial t}=-\\rho c^{2}\\,\\frac{\\partial v}{\\partial x}$\n- **场变量**：声压涨落 $p(x,t)$，质点速度 $v(x,t)$。\n- **能量密度定义（瞬时）**：\n  - 动能：$u_{k}(x,t)=\\frac{1}{2}\\,\\rho\\,v(x,t)^{2}$\n  - 势能：$u_{p}(x,t)=\\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}}$\n- **要求输出**：\n  1. 用实值压力振幅 $P$ 表示的显式实值时空场 $p(x,t)$ 和 $v(x,t)$。\n  2. 周期平均比率 $R(x)=\\langle u_{k}(x,t)\\rangle_{t}/\\langle u_{p}(x,t)\\rangle_{t}$，其中平均是在一个时间周期 $T=2\\pi/\\omega$ 内进行。\n  3. 对 $R(x)$ 在压力波腹和速度波腹处的解释，包括局部能量的“晃荡”。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准审查问题陈述。\n\n- **科学依据**：该问题基于声学的基本线性化方程，这是波物理学的基石。动能和势能密度的定义是声场的标准定义。由反向传播波叠加形成驻波的概念是一个经典且物理上合理的模型。所有前提在事实上和科学上都是合理的。\n- **适定性**：问题提供了推导所求量所需的所有方程、定义和约束。任务定义清晰，可以导出一个唯一的关于比率 $R(x)$ 的解析解。\n- **客观性**：问题使用精确、无歧义的数学和物理术语进行陈述。它不含主观语言或观点。\n\n### 步骤3：结论与行动\n问题是**有效的**。这是一个来自声学领域的、适定的、有科学依据的问题。现在将推导解答。\n\n首先，我们推导驻波的压力场 $p(x,t)$ 和速度场 $v(x,t)$ 的表达式。一维驻波可以表示为两个在相反方向上传播的相同行波的叠加。设两个压力波分别为 $p_1(x,t)$ 和 $p_2(x,t)$，分别代表前向和后向传播。用复数表示法，它们可以写成：\n$$p_1(x,t) = \\tilde{A} \\exp(i(\\omega t - kx))$$\n$$p_2(x,t) = \\tilde{A} \\exp(i(\\omega t + kx))$$\n总压力场 $p(x,t)$ 是它们和的实部：\n$$p(x,t) = \\Re[p_1(x,t) + p_2(x,t)] = \\Re[\\tilde{A} \\exp(i\\omega t) (\\exp(-ikx) + \\exp(ikx))]$$\n使用欧拉公式 $\\exp(-ikx) + \\exp(ikx) = 2\\cos(kx)$，我们得到：\n$$p(x,t) = \\Re[2\\tilde{A} \\cos(kx) \\exp(i\\omega t)]$$\n问题规定场应该用实值压力振幅 $P$ 来表示。我们可以将复振幅 $2\\tilde{A}$ 设为实数值 $P$。这个选择对应于设定驻波的相位。\n$$p(x,t) = \\Re[P \\cos(kx) (\\cos(\\omega t) + i \\sin(\\omega t))] = P \\cos(kx) \\cos(\\omega t)$$\n\n接下来，我们使用线性化动量方程从压力 $p(x,t)$ 推导质点速度 $v(x,t)$：\n$$\\rho\\,\\frac{\\partial v}{\\partial t}=-\\frac{\\partial p}{\\partial x}$$\n首先，计算压力的空间导数：\n$$\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x} [P \\cos(kx) \\cos(\\omega t)] = -Pk \\sin(kx) \\cos(\\omega t)$$\n将此代入动量方程：\n$$\\rho\\,\\frac{\\partial v}{\\partial t} = -(-Pk \\sin(kx) \\cos(\\omega t)) = Pk \\sin(kx) \\cos(\\omega t)$$\n为了求得 $v(x,t)$，我们对时间 $t$ 进行积分：\n$$v(x,t) = \\int \\frac{Pk}{\\rho} \\sin(kx) \\cos(\\omega t) dt = \\frac{Pk}{\\rho\\omega} \\sin(kx) \\sin(\\omega t)$$\n对于没有平均流动的纯振荡声场，积分常数为零。对于无损介质，色散关系为 $\\omega = ck$，这意味着 $k/\\omega = 1/c$。代入此关系，我们得到速度的最终表达式：\n$$v(x,t) = \\frac{P}{\\rho c} \\sin(kx) \\sin(\\omega t)$$\n$p(x,t)$ 和 $v(x,t)$ 的这些表达式表明，压力和速度在空间上相位相差 $\\pi/2$（$\\cos(kx)$ 对 $\\sin(kx)$），在时间上也相位相差 $\\pi/2$（$\\cos(\\omega t)$ 对 $\\sin(\\omega t)$）。\n\n现在，我们使用它们的定义来计算瞬时动能和势能密度：\n$$u_{k}(x,t) = \\frac{1}{2}\\,\\rho\\,v(x,t)^{2} = \\frac{1}{2}\\rho \\left(\\frac{P}{\\rho c} \\sin(kx) \\sin(\\omega t)\\right)^2 = \\frac{P^2}{2\\rho c^2} \\sin^2(kx) \\sin^2(\\omega t)$$\n$$u_{p}(x,t) = \\frac{p(x,t)^{2}}{2\\,\\rho\\,c^{2}} = \\frac{(P \\cos(kx) \\cos(\\omega t))^2}{2\\rho c^2} = \\frac{P^2}{2\\rho c^2} \\cos^2(kx) \\cos^2(\\omega t)$$\n\n下一步是计算这些量在一个周期 $T = 2\\pi/\\omega$ 内的时间平均值。函数 $f(t)$ 的时间平均值为 $\\langle f(t) \\rangle_{t} = \\frac{1}{T}\\int_{0}^{T} f(t) dt$。我们需要三角函数项的平均值：\n$$\\langle \\sin^2(\\omega t) \\rangle_t = \\frac{1}{T}\\int_{0}^{T} \\sin^2(\\omega t) dt = \\frac{1}{T}\\int_{0}^{T} \\frac{1 - \\cos(2\\omega t)}{2} dt = \\frac{1}{2}$$\n$$\\langle \\cos^2(\\omega t) \\rangle_t = \\frac{1}{T}\\int_{0}^{T} \\cos^2(\\omega t) dt = \\frac{1}{T}\\int_{0}^{T} \\frac{1 + \\cos(2\\omega t)}{2} dt = \\frac{1}{2}$$\n$\\cos(2\\omega t)$ 在周期 $T$ 上的积分为零。\n\n使用这些结果，我们求得时间平均能量密度：\n$$\\langle u_{k}(x,t) \\rangle_{t} = \\frac{P^2}{2\\rho c^2} \\sin^2(kx) \\langle \\sin^2(\\omega t) \\rangle_{t} = \\frac{P^2}{4\\rho c^2} \\sin^2(kx)$$\n$$\\langle u_{p}(x,t) \\rangle_{t} = \\frac{P^2}{2\\rho c^2} \\cos^2(kx) \\langle \\cos^2(\\omega t) \\rangle_{t} = \\frac{P^2}{4\\rho c^2} \\cos^2(kx)$$\n\n最后，我们计算比率 $R(x)$：\n$$R(x) = \\frac{\\langle u_{k}(x,t)\\rangle_{t}}{\\langle u_{p}(x,t)\\rangle_{t}} = \\frac{\\frac{P^2}{4\\rho c^2} \\sin^2(kx)}{\\frac{P^2}{4\\rho c^2} \\cos^2(kx)} = \\frac{\\sin^2(kx)}{\\cos^2(kx)} = \\tan^2(kx)$$\n\n结果解释：\n- **在压力波腹处**：这些是压力振幅 $|\\cos(kx)|$ 达到最大的位置，即 $|\\cos(kx)|=1$。这发生在 $kx = n\\pi$（$n$ 为任意整数）处。在这些点，$\\sin(kx) = 0$，所以 $R(x) = \\tan^2(n\\pi) = 0$。这表示时间平均动能密度为零。这些点是速度波节，在所有时间 $t$ 都有 $v(x,t)=0$。在这些位置，声能平均而言纯粹是势能。\n- **在速度波腹处**：这些是速度振幅 $|\\sin(kx)|$ 达到最大的位置，即 $|\\sin(kx)|=1$。这发生在 $kx = (n + 1/2)\\pi$（$n$ 为任意整数）处。在这些点，$\\cos(kx) = 0$，比率 $R(x) = \\tan^2((n+1/2)\\pi)$ 是奇异的（趋于无穷大）。这表示时间平均势能密度为零。这些点是压力波节，在所有时间 $t$ 都有 $p(x,t)=0$。在这些位置，声能平均而言纯粹是动能。\n\n局部能量“晃荡”指的是动能和势能形式之间随时间的交换。在任何固定位置 $x$（非波节或波腹处），能量会持续转换。瞬时动能 $u_k \\propto \\sin^2(\\omega t)$ 在势能 $u_p \\propto \\cos^2(\\omega t)$ 为零时达到最大，反之亦然。这是因为 $p(x,t)$ 和 $v(x,t)$ 在时间上相位相差 $\\pi/2$。在 $t=n\\pi/\\omega$ 时能量完全是势能，而在四分之一个周期后的 $t=(n+1/2)\\pi/\\omega$ 时完全是动能。在一个固定点上，能量从一种形式到另一种形式的这种周期性转换，而没有净传播，是驻波的特征性能量动力学。函数 $R(x) = \\tan^2(kx)$ 量化了时间平均能量预算在其动能和势能形式之间的空间分配。注意，总时间平均能量密度 $\\langle u \\rangle_t = \\langle u_k \\rangle_t + \\langle u_p \\rangle_t = \\frac{P^2}{4\\rho c^2}(\\sin^2(kx) + \\cos^2(kx)) = \\frac{P^2}{4\\rho c^2}$ 在空间上是恒定的，这是理想一维驻波的一个标志。",
            "answer": "$$\\boxed{\\tan^2(kx)}$$"
        },
        {
            "introduction": "在从稳态波过渡到传播波之后，我们来研究一个更贴近实际的课题：声脉冲在色散介质中的传播。本练习探讨了一个高斯脉冲的演化，通过运用傅里叶分析方法，您将推导并量化群速度色散（GVD）如何导致脉冲在传播过程中展宽。这个过程虽然降低了脉冲的峰值能量密度，但在无损介质中，总能量是守恒的 ，这一结论对于理解信号保真度和能量在实际介质中的分布至关重要。",
            "id": "4112663",
            "problem": "考虑在一维、线性、无损耗、弱色散声学介质中，沿坐标$z$传播的小振幅平面波。设载波角频率为$\\omega_{0}$，相应的相速度为$c_{0} = \\omega_{0}/k_{0}$，其中$k_{0} = k(\\omega_{0})$是载波处的波数。介质的波数在$\\omega_{0}$附近是解析的，并可进行泰勒展开$k(\\omega_{0} + \\Omega) = k_{0} + k_{1} \\Omega + \\tfrac{1}{2} k_{2} \\Omega^{2}$，其中$k_{1} = \\left.\\dfrac{d k}{d \\omega}\\right|_{\\omega_{0}}$且$k_{2} = \\left.\\dfrac{d^{2} k}{d \\omega^{2}}\\right|_{\\omega_{0}}$。参数$k_{2}$是群速度色散(GVD)，其与距离$z$的乘积$k_{2}z$是在该距离上累积的群延迟色散(GDD)。\n\n在$z = 0$处，发射一个调制着载波$\\omega_{0}$的窄带、零啁啾高斯复压强包络$\\tilde{p}(t,0) = p_{0} \\exp\\!\\big(-t^{2}/(2 T_{0}^{2})\\big)$。假设平面波阻抗为$Z_{0} = \\rho c_{0}$，其中$\\rho$是环境质量密度，并且对于质点速度的复包络，窄带关系$\\tilde{v}(t,0) \\approx \\tilde{p}(t,0)/(\\rho c_{0})$成立。将包络的周期平均声能密度定义为$u_{\\mathrm{env}}(t,z) = \\dfrac{|\\tilde{p}(t,z)|^{2}}{2 \\rho c_{0}^{2}}$，这可以从线性声学中标准的平面波动能密度和势能密度划分推导出来。\n\n使用与计算声学和给定色散展开一致的频谱（傅里叶）传播模型，在推迟时间$\\tau = t - k_{1} z$下，推导在距离$z$处的精确高斯包络解，并用它来：\n- 定性和定量地证明，在此无损耗介质中，非零的群速度色散（$k_{2} \\neq 0$）会使包络展宽，同时保持总周期平均能量$\\int_{-\\infty}^{\\infty} u_{\\mathrm{env}}(\\tau,z)\\, d\\tau$守恒，\n- 并求出峰值周期平均声能密度$u_{\\mathrm{peak}}(z) = \\max_{\\tau} u_{\\mathrm{env}}(\\tau,z)$的精确解析表达式。\n\n将您关于$u_{\\mathrm{peak}}(z)$的最终答案表示为以焦耳每立方米 (J m$^{-3}$)为单位的单个闭式解析表达式。不需要进行数值计算或四舍五入；仅提供符号表达式。",
            "solution": "首先验证问题，以确保其科学上成立、内容自洽且提法恰当。\n\n### 第1步：提取已知条件\n- **介质：** 一维、线性、无损耗、弱色散声学介质。\n- **传播方向：** $z$轴。\n- **波类型：** 小振幅平面波。\n- **载波角频率：** $\\omega_{0}$。\n- **载波处相速度：** $c_{0} = \\omega_{0}/k_{0}$，其中$k_{0} = k(\\omega_{0})$。\n- **波数展开：** $k(\\omega_{0} + \\Omega) = k_{0} + k_{1} \\Omega + \\tfrac{1}{2} k_{2} \\Omega^{2}$，其中$\\Omega = \\omega - \\omega_{0}$。\n- **色散参数：** $k_{1} = \\left.\\dfrac{d k}{d \\omega}\\right|_{\\omega_{0}}$，$k_{2} = \\left.\\dfrac{d^{2} k}{d \\omega^{2}}\\right|_{\\omega_{0}}$。\n- **$z=0$处的初始条件：** 复压强包络$\\tilde{p}(t,0) = p_{0} \\exp\\big(-t^{2}/(2 T_{0}^{2})\\big)$。该包络为零啁啾高斯型。\n- **声阻抗：** $Z_{0} = \\rho c_{0}$，其中$\\rho$是环境质量密度。\n- **质点速度包络：** $\\tilde{v}(t,0) \\approx \\tilde{p}(t,0)/(\\rho c_{0})$。\n- **能量密度定义：** 包络的周期平均声能密度为$u_{\\mathrm{env}}(t,z) = \\dfrac{|\\tilde{p}(t,z)|^{2}}{2 \\rho c_{0}^{2}}$。\n- **参考系：** 推迟时间$\\tau = t - k_{1} z$。\n- **方法：** 频谱（傅里叶）传播模型。\n\n### 第2步：使用提取的已知条件进行验证\n该问题陈述是线性波传播理论中的一个标准练习，特别是分析声学中的脉冲色散。\n- **科学上成立：** 该设置基于线性声学的基本原理。对色散关系$k(\\omega)$使用泰勒级数是在弱色散介质中对窄带脉冲的标准且有效的近似。群速度和群速度色散的定义是标准的。声阻抗和能量密度的表达式对于平面波是正确的。\n- **提法恰当：** 问题提供了一个明确定义的初始条件（高斯脉冲）和一个清晰的传播物理模型（带有二阶色散的线性波动方程）。这种结构保证了唯一、稳定且有意义的解的存在。\n- **目标明确：** 问题使用精确的数学和物理术语陈述，没有歧义或主观论断。\n\n该问题不含说明中列出的任何使其无效的缺陷。它代表了波物理学中一个经典的、可解的问题。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 传播后包络的推导\n解可以通过频谱方法找到，该方法包括将初始条件转换到频域，应用一个传播算子，然后变换回时域。\n\n在$z=0$处的复压强包络由下式给出\n$$\n\\tilde{p}(t,0) = p_{0} \\exp\\left(-\\frac{t^{2}}{2 T_{0}^{2}}\\right)\n$$\n我们定义包络的傅里叶变换对，其中$\\Omega = \\omega - \\omega_{0}$是相对于载波的频率偏移，如下所示：\n$$\n\\tilde{P}(\\Omega, z) = \\int_{-\\infty}^{\\infty} \\tilde{p}(t,z) \\exp(i\\Omega t) \\,dt\n$$\n$$\n\\tilde{p}(t, z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{P}(\\Omega,z) \\exp(-i\\Omega t) \\,d\\Omega\n$$\n首先，我们求出$z=0$处初始包络的傅里叶变换：\n$$\n\\tilde{P}(\\Omega, 0) = \\int_{-\\infty}^{\\infty} p_{0} \\exp\\left(-\\frac{t^{2}}{2 T_{0}^{2}}\\right) \\exp(i\\Omega t) \\,dt\n$$\n这是一个标准的高斯积分。使用公式$\\int_{-\\infty}^{\\infty} \\exp(-at^{2})\\exp(ibt) \\,dt = \\sqrt{\\pi/a} \\exp(-b^{2}/(4a))$，其中$a = 1/(2T_{0}^{2})$和$b=\\Omega$，我们得到：\n$$\n\\tilde{P}(\\Omega, 0) = p_{0} \\sqrt{\\frac{\\pi}{1/(2T_{0}^{2})}} \\exp\\left(-\\frac{\\Omega^{2}}{4/(2T_{0}^{2})}\\right) = p_{0} T_{0} \\sqrt{2\\pi} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right)\n$$\n在线性介质中，每个频谱分量以相位因子$\\exp(i k(\\omega) z)$传播。对于复包络，相对于载波波数$k_{0}$的传播算子是$\\exp(i[k(\\omega_{0}+\\Omega) - k_{0}]z)$。使用给定的$k(\\omega_{0}+\\Omega)$的泰勒展开：\n$$\nk(\\omega_{0}+\\Omega) - k_{0} = k_{1}\\Omega + \\frac{1}{2} k_{2}\\Omega^{2}\n$$\n那么，在距离$z$处的频谱包络是：\n$$\n\\tilde{P}(\\Omega, z) = \\tilde{P}(\\Omega, 0) \\exp\\left(i\\left[k_{1}\\Omega + \\frac{1}{2} k_{2}\\Omega^{2}\\right]z\\right)\n$$\n代入$\\tilde{P}(\\Omega, 0)$的表达式：\n$$\n\\tilde{P}(\\Omega, z) = p_{0} T_{0} \\sqrt{2\\pi} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right) \\exp\\left(i k_{1}z\\Omega\\right) \\exp\\left(i\\frac{k_{2}z}{2}\\Omega^{2}\\right)\n$$\n为了求出时域中的包络$\\tilde{p}(t,z)$，我们进行傅里叶逆变换：\n$$\n\\tilde{p}(t, z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{P}(\\Omega, z) \\exp(-i\\Omega t) \\,d\\Omega\n$$\n$$\n\\tilde{p}(t, z) = \\frac{p_{0} T_{0} \\sqrt{2\\pi}}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\Omega^{2}T_{0}^{2}}{2}\\right) \\exp\\left(i k_{1}z\\Omega\\right) \\exp\\left(i\\frac{k_{2}z}{2}\\Omega^{2}\\right) \\exp(-i\\Omega t) \\,d\\Omega\n$$\n合并指数中的项：\n$$\n\\tilde{p}(t, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\left[T_{0}^{2} - i k_{2}z\\right]\\Omega^{2} - i(t - k_{1}z)\\Omega\\right) \\,d\\Omega\n$$\n使用推迟时间$\\tau = t - k_{1}z$，积分变为：\n$$\n\\tilde{p}(\\tau, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\left[T_{0}^{2} - i k_{2}z\\right]\\Omega^{2} - i\\tau\\Omega\\right) \\,d\\Omega\n$$\n这是另一个形式为$\\int_{-\\infty}^{\\infty} \\exp(-A\\Omega^{2} - B\\Omega) \\,d\\Omega = \\sqrt{\\pi/A} \\exp(B^{2}/(4A))$的高斯积分，其中$A = \\frac{1}{2}(T_{0}^{2} - i k_{2}z)$，$B = i\\tau$。\n$$\n\\int_{-\\infty}^{\\infty} \\dots \\,d\\Omega = \\sqrt{\\frac{\\pi}{\\frac{1}{2}(T_{0}^{2} - i k_{2}z)}} \\exp\\left(\\frac{(i\\tau)^{2}}{4 \\cdot \\frac{1}{2}(T_{0}^{2} - i k_{2}z)}\\right) = \\sqrt{\\frac{2\\pi}{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\n将此结果代回$\\tilde{p}(\\tau, z)$的表达式中：\n$$\n\\tilde{p}(\\tau, z) = \\frac{p_{0} T_{0}}{\\sqrt{2\\pi}} \\sqrt{\\frac{2\\pi}{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\n$$\n\\tilde{p}(\\tau, z) = p_{0} \\frac{T_{0}}{\\sqrt{T_{0}^{2} - i k_{2}z}} \\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\n$$\n这就是在推迟时间坐标系下的精确高斯包络解。\n\n### 包络展宽与能量守恒\n为了分析其物理性质，我们考察包络的模的平方，$|\\tilde{p}(\\tau,z)|^{2}$。\n$$\n|\\tilde{p}(\\tau,z)|^{2} = |p_{0}|^{2} \\frac{|T_{0}|^{2}}{|T_{0}^{2} - i k_{2}z|} \\left|\\exp\\left(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)}\\right)\\right|^{2}\n$$\n假设$p_0$和$T_0$是实数，则$|p_0|^2=p_0^2$和$|T_0|^2=T_0^2$。分母项为$|T_{0}^{2} - i k_{2}z| = \\sqrt{(T_{0}^{2})^{2} + (-k_{2}z)^{2}} = \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}$。\n指数项的模的平方是$\\exp[2 \\cdot \\mathrm{Re}(-\\frac{\\tau^{2}}{2(T_{0}^{2} - i k_{2}z)})]$。\n指数的宗量是：\n$$\n-\\frac{\\tau^{2}}{2} \\frac{1}{T_{0}^{2} - i k_{2}z} = -\\frac{\\tau^{2}}{2} \\frac{T_{0}^{2} + i k_{2}z}{T_{0}^{4} + (k_{2}z)^{2}}\n$$\n其实部为$-\\frac{\\tau^{2}T_{0}^{2}}{2(T_{0}^{4} + (k_{2}z)^{2})}$。因此，指数的模的平方为$\\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right)$。\n合并各部分：\n$$\n|\\tilde{p}(\\tau,z)|^{2} = p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right)\n$$\n初始强度分布为$|\\tilde{p}(t,0)|^{2} = p_{0}^{2}\\exp(-t^{2}/T_{0}^{2})$。其特征宽度平方（在峰值的$1/e$处）是$T_{0}^{2}$。传播后的强度分布可以写成$|\\tilde{p}(\\tau,z)|^{2} = A(z)\\exp(-\\tau^{2}/T(z)^{2})$，其中新的宽度平方为：\n$$\nT(z)^{2} = \\frac{T_{0}^{4} + (k_{2}z)^{2}}{T_{0}^{2}} = T_{0}^{2}\\left(1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}\\right)\n$$\n由于$(k_{2}z/T_{0}^{2})^{2} \\ge 0$，脉冲宽度$T(z)$总是大于或等于初始宽度$T_{0}$。仅当$k_2=0$或$z=0$时，$T(z)=T_0$。这定量地证明了非零的群速度色散（$k_{2} \\neq 0$）会导致包络在传播过程中展宽。\n\n接下来，我们检验总周期平均能量$E_{\\mathrm{total}} = \\int_{-\\infty}^{\\infty} u_{\\mathrm{env}}(\\tau,z)\\, d\\tau$的守恒性。\n$$\nE_{\\mathrm{total}}(z) = \\int_{-\\infty}^{\\infty} \\frac{|\\tilde{p}(\\tau,z)|^{2}}{2 \\rho c_{0}^{2}} \\,d\\tau = \\frac{1}{2 \\rho c_{0}^{2}} \\int_{-\\infty}^{\\infty} |\\tilde{p}(\\tau,z)|^{2} \\,d\\tau\n$$\n$$\nE_{\\mathrm{total}}(z) = \\frac{p_{0}^{2} T_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\tau^{2}T_{0}^{2}}{T_{0}^{4} + (k_{2}z)^{2}}\\right) \\,d\\tau\n$$\n该积分的形式为$\\int_{-\\infty}^{\\infty} \\exp(-a\\tau^{2})d\\tau = \\sqrt{\\pi/a}$，其中$a = T_{0}^{2}/(T_{0}^{4} + (k_{2}z)^{2})$。\n$$\n\\int_{-\\infty}^{\\infty} \\dots \\,d\\tau = \\sqrt{\\frac{\\pi (T_{0}^{4} + (k_{2}z)^{2})}{T_{0}^{2}}} = \\frac{\\sqrt{\\pi} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}{T_{0}}\n$$\n将此结果代入能量表达式：\n$$\nE_{\\mathrm{total}}(z) = \\frac{p_{0}^{2} T_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\cdot \\frac{\\sqrt{\\pi} \\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}{T_{0}} = \\frac{p_{0}^{2} T_{0} \\sqrt{\\pi}}{2 \\rho c_{0}^{2}}\n$$\n该表达式与$z$无关，这证明了总周期平均能量是守恒的，正如在无损耗介质中所预期的那样。\n\n### 峰值周期平均声能密度\n周期平均声能密度为$u_{\\mathrm{env}}(\\tau,z) = \\frac{|\\tilde{p}(\\tau,z)|^{2}}{2 \\rho c_{0}^{2}}$。$|\\tilde{p}(\\tau,z)|^{2}$的表达式是关于$\\tau$的、以$\\tau=0$为中心的高斯函数。其最大值出现在$\\tau=0$处。\n峰值能量密度$u_{\\mathrm{peak}}(z)$是$u_{\\mathrm{env}}(\\tau,z)$在$\\tau=0$处的值。\n$$\nu_{\\mathrm{peak}}(z) = u_{\\mathrm{env}}(0,z) = \\frac{|\\tilde{p}(0,z)|^{2}}{2 \\rho c_{0}^{2}}\n$$\n在我们的$|\\tilde{p}(\\tau,z)|^{2}$表达式中令$\\tau=0$：\n$$\n|\\tilde{p}(0,z)|^{2} = p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}}\n$$\n因此，峰值能量密度为：\n$$\nu_{\\mathrm{peak}}(z) = \\frac{1}{2 \\rho c_{0}^{2}} \\left( p_{0}^{2} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4} + (k_{2}z)^{2}}} \\right) = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{T_{0}^{2}}{\\sqrt{T_{0}^{4}\\left(1 + \\frac{(k_{2}z)^{2}}{T_{0}^{4}}\\right)}}\n$$\n$$\nu_{\\mathrm{peak}}(z) = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{T_{0}^{2}}{T_{0}^{2}\\sqrt{1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}}} = \\frac{p_{0}^{2}}{2 \\rho c_{0}^{2}} \\frac{1}{\\sqrt{1 + \\left(\\frac{k_{2}z}{T_{0}^{2}}\\right)^{2}}}\n$$\n$z=0$处的峰值能量密度是$u_{\\mathrm{peak}}(0) = p_{0}^{2}/(2\\rho c_{0}^{2})$。随着脉冲展宽，其峰值振幅减小以保持能量守恒。推导出的表达式捕捉了这一物理行为。",
            "answer": "$$\n\\boxed{\\frac{p_{0}^{2}}{2 \\rho c_{0}^{2} \\sqrt{1 + \\left(\\frac{k_{2} z}{T_{0}^{2}}\\right)^{2}}}}\n$$"
        },
        {
            "introduction": "在前两个解析练习的基础上，我们将进入一个综合性的计算实践，旨在展示数值模拟在声学研究中的强大能力。当解析解难以获得时，诸如时域有限差分（FDTD）等计算方法使我们能够模拟复杂的瞬态现象。在此练习中，您将从零开始构建一个FDTD模拟程序，用于研究声脉冲在材料界面上的散射过程，并直接从模拟场中计算瞬时能量密度和能流强度，最终利用这些数据来验证物理学中最基本的原则之一——因果律 。",
            "id": "4112673",
            "problem": "设计一个一维空间中的数值实验，以模拟瞬态声散射事件，并通过确保没有能量通量在最早物理可允许传播时间之前到达指定的接收器位置来验证因果性。该模拟必须完全基于线性声学的第一性原理，并且必须根据演化的声压场和质点速度场计算瞬时声能密度和瞬时声能量通量。\n\n从具有空间变化材料属性的可压缩无粘性流体的线性化动量守恒和质量守恒方程出发。介质是分段均匀的，在预定位置有一个平面界面。实现一个交错网格、显式、二阶精度的时域有限差分格式，该格式遵守 Courant–Friedrichs–Lewy 稳定性条件，并包含吸收边界处理以避免来自计算边界的伪反射。使用物理上合理的震源时间函数，在单个网格点上通过一个紧凑、带限的标量源来驱动系统。该模拟必须得出随时间变化的瞬态声压场和质点速度场。\n\n根据模拟出的场，在接收器位置计算瞬时声能密度和瞬时声能量通量。瞬时声能密度结合了动能分量和压缩势能分量。瞬时声能量通量等于声强。在一维情况下，声强的符号表示能量传输的方向。您必须从控制的第一性原理方程推导出用于这些量的表达式；不允许直接使用预先记忆的目标公式。\n\n将接收器处的最早物理可允许到达时间定义为沿源与接收器之间穿过分段均匀层的直线路径上局部声速倒数的路径积分。在一维情况下，当界面位于位置 $x_0$，源位于位置 $x_s$，接收器位于位置 $x_r$ 时，该最早时间简化为各段长度除以相应段内恒定声速的总和。\n\n因果性验证必须通过对接收器的瞬时声强时间序列进行阈值处理来进行：如果在任何严格小于最早传播时间的时间 $t$，瞬时强度的绝对值超过整个模拟时间窗口内观测到的峰值绝对强度的很小一部分，则宣告存在因果性违背。使用峰值的 $10^{-5}$ 作为分数阈值，并在必要时添加一个小的正数下限以防止除以零。\n\n您的程序必须实现此实验，并对以下每个测试用例执行因果性检查。所有量必须在国际单位制中处理，任何报告的时间都必须以秒为单位。所有距离单位为米，速度单位为米/秒，密度单位为千克/立方米，压力单位为帕斯卡，时间单位为秒。角度不出现，因此无需指定。\n\n每个测试用例是一个元组，指定了域和材料参数、源和接收器的位置以及数值参数：\n1. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1500.0, 1000.0, 1000.0, 1500.0, 1.5, 0.5, 2.5, 1200.0, 100.0, 0.7, 0.003)$\n2. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1500.0, 1500.0, 1000.0, 1000.0, 1.0, 0.6, 2.6, 2000.0, 80.0, 0.9, 0.003)$\n3. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.0, 0.005, 1400.0, 800.0, 950.0, 1600.0, 2.4, 0.7, 2.45, 2500.0, 60.0, 0.8, 0.002)$\n4. $(L,\\Delta x,c_1,c_2,\\rho_1,\\rho_2,x_0,x_s,x_r,f_0,A,\\text{CFL},T_{\\text{end}}) = (3.2, 0.004, 1500.0, 2000.0, 1000.0, 1200.0, 1.3, 0.4, 2.8, 1800.0, 70.0, 0.99, 0.002)$\n\n其中：\n- $L$ 是域长度，\n- $\\Delta x$ 是空间网格间距，\n- $c_1$ 和 $c_2$ 分别是左层和右层的声速，\n- $\\rho_1$ 和 $\\rho_2$ 分别是左层和右层的密度，\n- $x_0$ 是界面位置，\n- $x_s$ 是源位置，\n- $x_r$ 是接收器位置，\n- $f_0$ 是带限震源时间函数的中心频率，\n- $A$ 是源振幅（压力单位），\n- $\\text{CFL}$ 是用于时间步长的 Courant 数，\n- $T_{\\text{end}}$ 是总模拟时间。\n\n您的程序必须：\n- 实现一个用于一维线性声学的交错网格时域有限差分更新，该更新考虑了空间变化的材料属性和吸收边界层。\n- 使用一个紧凑、带限的震源时间函数，例如中心位于时间 $t_0 = \\frac{3}{f_0}$ 的 Ricker 子波。\n- 在接收器处计算瞬时声能密度和瞬时声强，且时间点需保持一致。\n- 沿源到接收器的直线路径，计算最早传播时间，即各段长度除以相应声速的总和。\n- 对每个测试用例判定因果性，方法是检查在早于最早传播时间的任何时刻，绝对强度是否超过其峰值的 $10^{-5}$。\n- 生成单行输出，其中包含四个测试用例的布尔结果，形式为方括号括起来的逗号分隔列表（例如，“[True,False,True,True]”）。\n\n您的最终答案必须是每个测试用例的布尔值，并且程序必须以指定的单行格式打印它们。",
            "solution": "## 问题验证\n\n### 步骤 1：提取给定条件\n\n问题提供了以下数据、定义和约束，用于一维计算声学中的一个数值实验：\n\n**控制原理：**\n- 可压缩无粘性流体的线性化动量和质量守恒。\n- 空间变化的材料属性（$\\rho(x)$, $c(x)$）。\n- 一个在 $x_0$ 处具有单一平面界面的分段均匀介质。\n- 一个交错网格、显式、二阶精度的时域有限差分 (FDTD) 格式。\n- 必须遵守 Courant–Friedrichs–Lewy (CFL) 稳定性条件。\n- 需要吸收边界处理。\n- 在单个网格点上有一个紧凑、带限的标量源，具有定义的震源时间函数（例如，Ricker 子波）。\n\n**要计算和分析的量：**\n- 瞬态声压场 $p(x,t)$ 和质点速度场 $v(x,t)$。\n- 从第一性原理推导出的瞬时声能密度。\n- 从第一性原理推导出的瞬时声能量通量（声强）。\n\n**因果性验证程序：**\n- 将最早物理可允许到达时间 $t_{\\text{arrival}}$ 定义为局部声速倒数的路径积分。对于给定的源在 $x_s$、接收器在 $x_r$、界面在 $x_0$、声速为 $c_1$ 和 $c_2$ 的一维设置，这简化为各段传播时间的总和。\n- 在接收器位置 $x_r$ 监测瞬时强度 $I(t)$。\n- 如果对于任何时间 $t  t_{\\text{arrival}}$，有 $|I(t)| > 10^{-5} \\times \\max_t|I(t)|$，则宣告存在因果性违背。必须向 $\\max_t|I(t)|$ 添加一个小的正数下限以防止除以零。\n\n**测试用例（参数）：**\n每个测试用例是一个元组：$(L, \\Delta x, c_1, c_2, \\rho_1, \\rho_2, x_0, x_s, x_r, f_0, A, \\text{CFL}, T_{\\text{end}})$。\n1. $(3.0, 0.005, 1500.0, 1000.0, 1000.0, 1500.0, 1.5, 0.5, 2.5, 1200.0, 100.0, 0.7, 0.003)$\n2. $(3.0, 0.005, 1500.0, 1500.0, 1000.0, 1000.0, 1.0, 0.6, 2.6, 2000.0, 80.0, 0.9, 0.003)$\n3. $(3.0, 0.005, 1400.0, 800.0, 950.0, 1600.0, 2.4, 0.7, 2.45, 2500.0, 60.0, 0.8, 0.002)$\n4. $(3.2, 0.004, 1500.0, 2000.0, 1000.0, 1200.0, 1.3, 0.4, 2.8, 1800.0, 70.0, 0.99, 0.002)$\n\n**震源时间函数：**\n- 中心位于时间 $t_0 = 3/f_0$ 的 Ricker 子波。\n\n**输出格式：**\n- 一个单行，包含用逗号分隔的布尔结果列表（例如，`[True,False,True,True]`）。\n\n### 步骤 2：使用提取的给定条件进行验证\n\n- **科学依据（关键）：** 该问题牢固地植根于线性声学的基本原理，由线性化欧拉方程描述。FDTD 方法是解决波传播问题的标准、经过科学验证的技术。因果性概念是物理学的基石，在数值模拟中对其进行验证是一项标准且有意义的实践。所有提议的步骤都基于已建立的物理学和数值分析。\n- **适定性：** 问题提供了所有必要的参数、控制方程、初始条件（静态介质）、边界条件（吸收）和源项，以建立一个适定的初边值问题。在满足 CFL 条件的情况下，解预期是唯一且稳定的。\n- **客观性（关键）：** 问题以精确、客观和定量的方式陈述。所有参数都明确定义，验证标准（因果性检查）是明确的。\n- **未检测到缺陷：** 问题陈述没有违反任何无效标准。它不是科学上不合理的、不可形式化的、不完整的、不切实际的、不适定的、琐碎的或不可验证的。它描述了计算物理学中的一个标准数值实验。\n\n### 步骤 3：结论与行动\n\n该问题是 **有效的**。将提供完整的解决方案。\n\n## 求解推导与实现策略\n\n该解决方案涉及模拟一维线性声学方程，并在接收器处分析结果以验证因果性。该过程分为以下几个步骤。\n\n**1. 控制方程与能量守恒**\n\n我们从无粘性、可压缩流体中线性声学的第一性原理方程开始。这些是一维动量和质量守恒的线性化欧拉方程：\n$$\n\\rho_0(x) \\frac{\\partial v(x,t)}{\\partial t} = -\\frac{\\partial p(x,t)}{\\partial x} \\quad \\text{(动量守恒)}\n$$\n$$\n\\frac{1}{K(x)} \\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial v(x,t)}{\\partial x} \\quad \\text{(质量守恒)}\n$$\n其中 $p$ 是声压，$v$ 是质点速度，$\\rho_0(x)$ 是环境流体密度，$K(x) = \\rho_0(x) c(x)^2$ 是体积模量，其中 $c(x)$ 是局部声速。\n\n为了推导能量守恒定律，我们将动量方程乘以 $v$，将质量守恒方程乘以 $p$：\n$$\n\\rho_0 v \\frac{\\partial v}{\\partial t} = -v \\frac{\\partial p}{\\partial x}\n$$\n$$\n\\frac{p}{K} \\frac{\\partial p}{\\partial t} = -p \\frac{\\partial v}{\\partial x}\n$$\n注意到 $u \\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t}(\\frac{1}{2}u^2)$，我们可以将它们重写为：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\rho_0 v^2\\right) = -v \\frac{\\partial p}{\\partial x}\n$$\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\frac{p^2}{K}\\right) = -p \\frac{\\partial v}{\\partial x}\n$$\n将这两个方程相加得到：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{1}{2}\\rho_0 v^2 + \\frac{1}{2}\\frac{p^2}{K}\\right) = -v \\frac{\\partial p}{\\partial x} - p \\frac{\\partial v}{\\partial x}\n$$\n右侧是乘积 $pv$ 散度的负数，即 $-\\frac{\\partial (pv)}{\\partial x}$。这产生了微分形式的声能守恒定律：\n$$\n\\frac{\\partial E(x,t)}{\\partial t} + \\frac{\\partial I_x(x,t)}{\\partial x} = 0\n$$\n从这个推导中，我们确定：\n- **瞬时声能密度 ($E$)**：动能密度和势能密度的和。\n  $$ E(x,t) = \\underbrace{\\frac{1}{2}\\rho_0(x) v(x,t)^2}_{\\text{动能}} + \\underbrace{\\frac{1}{2}\\frac{p(x,t)^2}{\\rho_0(x) c(x)^2}}_{\\text{势能}} $$\n- **瞬时声能量通量或声强 ($I_x$)**：单位面积的能量传输率。\n  $$ I_x(x,t) = p(x,t) v(x,t) $$\n这些表达式将用于从模拟场中计算所需的量。\n\n**2. 时域有限差分 (FDTD) 格式**\n\n我们采用交错网格（Yee 网格）进行数值求解。压力 $p$ 定义在整数空间索引 $i$ 和整数时间索引 $n$ 上，而速度 $v$ 定义在半整数空间索引 $i+1/2$ 和半整数时间索引 $n+1/2$ 上。\n- $p_i^n \\approx p(i\\Delta x, n\\Delta t)$\n- $v_{i+1/2}^{n+1/2} \\approx v((i+1/2)\\Delta x, (n+1/2)\\Delta t)$\n\n控制方程使用二阶精度中心差分进行离散化，从而得到蛙跳法时间步进格式：\n$$\n\\frac{v_{i+1/2}^{n+1/2} - v_{i+1/2}^{n-1/2}}{\\Delta t} = -\\frac{1}{\\rho_{i+1/2}} \\frac{p_{i+1}^n - p_i^n}{\\Delta x}\n$$\n$$\n\\frac{p_i^{n+1} - p_i^n}{\\Delta t} = -K_i \\frac{v_{i+1/2}^{n+1/2} - v_{i-1/2}^{n+1/2}}{\\Delta x}\n$$\n速度网格上的材料属性 $\\rho_{i+1/2}$ 通过对相邻压力网格点的值进行平均计算：$\\rho_{i+1/2} = (\\rho_i + \\rho_{i+1})/2$。\n更新方程是：\n1.  **速度更新**：\n    $$ v_{i+1/2}^{n+1/2} = v_{i+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_{i+1/2}\\Delta x} (p_{i+1}^n - p_i^n) $$\n2.  **压力更新**：\n    $$ p_i^{n+1} = p_i^n - \\frac{\\Delta t K_i}{\\Delta x} (v_{i+1/2}^{n+1/2} - v_{i-1/2}^{n+1/2}) $$\n\n时间步长 $\\Delta t$ 根据 CFL 条件选择以确保稳定性：$\\Delta t = \\text{CFL} \\frac{\\Delta x}{c_{\\max}}$，其中 $c_{\\max} = \\max(c_1, c_2)$ 且 $\\text{CFL} \\le 1$。\n\n**3. 源、边界与接收器**\n\n- **源**：通过在源位置 $i_s$ 的压力更新方程中添加一个项来实现软源：\n  $$ p_{i_s}^{n+1} \\rightarrow p_{i_s}^{n+1} + \\Delta t \\cdot S(n\\Delta t) $$\n  震源时间函数 $S(t)$ 是一个 Ricker 子波：\n  $$ S(t) = A\\left(1 - 2\\pi^2 f_0^2 (t-t_0)^2\\right) e^{-\\pi^2 f_0^2 (t-t_0)^2} $$\n  其中峰值延迟时间 $t_0 = 3/f_0$。\n\n- **吸收边界条件 (ABC)**：为防止来自域边缘的伪反射，应用一阶吸收边界条件。这些条件通过在边界上强制执行单向波动方程来模拟出射波。在左边界（$i=0$）和右边界（$i=N_x-1$）：\n  $$ p_0^{n+1} = p_0^n(1 - \\alpha_0) + p_1^n \\alpha_0 $$\n  $$ p_{N_x-1}^{n+1} = p_{N_x-1}^n(1 - \\alpha_{N_x-1}) + p_{N_x-2}^n \\alpha_{N_x-1} $$\n  其中 $\\alpha_i = c_i \\Delta t / \\Delta x$ 是局部 Courant 数。这些更新使用前一时间步 $n$ 的压力值来显式计算 $n+1$ 时刻的新边界值。\n\n- **接收器**：为了在接收器位置 $x_r$（网格索引 $i_r$）计算强度 $I(t)$，我们需要在相同的时间和位置上的 $p$ 和 $v$。由于网格是交错的，需要进行插值。我们在半整数时间步 $t_{n+1/2}$ 计算这些量：\n  - 速度 $v_{i_r}^{n+1/2}$ 进行空间插值：$v_{i_r}^{n+1/2} = 0.5(v_{i_r-1/2}^{n+1/2} + v_{i_r+1/2}^{n+1/2})$。（注意：在代码中，如果 `v` 的长度为 `N-1`，这表示 `0.5*(v[ir-1] + v[ir])`）。\n  - 压力 $p_{i_r}^{n+1/2}$ 进行时间插值：$p_{i_r}^{n+1/2} = 0.5(p_{i_r}^n + p_{i_r}^{n+1})$。\n  然后，强度为 $I_{i_r}^{n+1/2} = p_{i_r}^{n+1/2} \\cdot v_{i_r}^{n+1/2}$。\n\n**4. 因果性验证**\n\n- **最早到达时间 ($t_{\\text{arrival}}$)**：这是波从源 $x_s$ 传播到接收器 $x_r$ 所需的时间。对于具有界面 $x_0$ 的分段介质：\n  - 如果源和接收器在同一段内（例如，$x_s, x_r  x_0$ 或 $x_s, x_r > x_0$）：$t_{\\text{arrival}} = |x_r - x_s| / c_{\\text{segment}}$。\n  - 如果它们在不同段内（例如，$x_s  x_0  x_r$）：$t_{\\text{arrival}} = |x_0 - x_s|/c_{\\text{source\\_segment}} + |x_r - x_0|/c_{\\text{receiver\\_segment}}$。\n\n- **检查**：我们计算整个模拟过程中的峰值绝对强度 $I_{\\text{peak}} = \\max_t|I(t)|$。因果性阈值为 $I_{\\text{thresh}} = 10^{-5} \\times (I_{\\text{peak}} + \\epsilon)$，其中 $\\epsilon$ 是一个小的机器精度，以防止峰值为零。然后我们遍历记录的强度时间序列。如果在任何时间 $t_k  t_{\\text{arrival}}$ 时，有 $|I(t_k)| > I_{\\text{thresh}}$，则标记为因果性违背。否则，认为因果性得到验证。结果是一个布尔值 `True`（因果性得到遵守）或 `False`（违背）。\n\n对四个测试用例中的每一个都实施这一完整过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (3.0, 0.005, 1500.0, 1000.0, 1000.0, 1500.0, 1.5, 0.5, 2.5, 1200.0, 100.0, 0.7, 0.003),\n        (3.0, 0.005, 1500.0, 1500.0, 1000.0, 1000.0, 1.0, 0.6, 2.6, 2000.0, 80.0, 0.9, 0.003),\n        (3.0, 0.005, 1400.0, 800.0, 950.0, 1600.0, 2.4, 0.7, 2.45, 2500.0, 60.0, 0.8, 0.002),\n        (3.2, 0.004, 1500.0, 2000.0, 1000.0, 1200.0, 1.3, 0.4, 2.8, 1800.0, 70.0, 0.99, 0.002),\n    ]\n\n    results = []\n    for case in test_cases:\n        causality_respected = run_simulation(*case)\n        results.append(causality_respected)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(L, dx, c1, c2, rho1, rho2, x0, xs, xr, f0, A, CFL, T_end):\n    \"\"\"\n    Performs a single 1D FDTD acoustic simulation and causality check.\n    \"\"\"\n    # 1. Grid and material parameter setup\n    Nx = int(L / dx)\n    x = np.linspace(0, L, Nx, endpoint=False)\n    \n    c = np.full(Nx, c1)\n    rho = np.full(Nx, rho1)\n    \n    interface_idx = int(x0 / dx)\n    c[interface_idx:] = c2\n    rho[interface_idx:] = rho2\n    \n    K = rho * c**2\n    \n    c_max = max(c1, c2)\n    dt = CFL * dx / c_max\n    Nt = int(T_end / dt)\n    \n    # Staggered grid density for velocity updates\n    rho_v = 0.5 * (rho[:-1] + rho[1:])\n\n    # 2. Source and Receiver setup\n    isource = int(xs / dx)\n    ireceiver = int(xr / dx)\n    \n    # Ricker wavelet source function\n    t0 = 3.0 / f0\n    def ricker_source(t):\n        arg = np.pi**2 * f0**2 * (t - t0)**2\n        return A * (1 - 2 * arg) * np.exp(-arg)\n\n    # 3. FDTD Initialization\n    p = np.zeros(Nx)       # Pressure at integer time steps\n    v = np.zeros(Nx - 1)   # Velocity at half-integer time steps\n    \n    # Storage for receiver data\n    intensity_series = np.zeros(Nt)\n    time_series = np.zeros(Nt)\n\n    # 4. Main FDTD Loop\n    for n in range(Nt):\n        p_old = p.copy()\n\n        # Update velocity (v^{n+1/2} from p^n)\n        v -= (dt / (rho_v * dx)) * np.diff(p_old)\n\n        # Update pressure (p^{n+1} from v^{n+1/2}) - interior\n        p[1:-1] -= (dt * K[1:-1] / dx) * np.diff(v)\n\n        # Add source term\n        p[isource] += dt * ricker_source(n * dt)\n        \n        # Apply first-order Absorbing Boundary Conditions (ABCs)\n        # using p_old to maintain explicit scheme\n        alpha_0 = c[0] * dt / dx\n        p[0] = p_old[0] * (1 - alpha_0) + p_old[1] * alpha_0\n        \n        alpha_end = c[-1] * dt / dx\n        p[-1] = p_old[-1] * (1 - alpha_end) + p_old[-2] * alpha_end\n\n        # 5. Record data at receiver\n        # Interpolate p and v to the same time and space point\n        \n        # p at time n+1/2 via temporal averaging\n        p_rec_n_half = 0.5 * (p_old[ireceiver] + p[ireceiver])\n        \n        # v at receiver index ireceiver via spatial averaging\n        v_rec_n_half = 0.5 * (v[ireceiver - 1] + v[ireceiver])\n        \n        # Compute and store instantaneous intensity\n        current_intensity = p_rec_n_half * v_rec_n_half\n        intensity_series[n] = current_intensity\n        time_series[n] = (n + 0.5) * dt\n\n    # 6. Causality Verification\n    # Calculate earliest physical arrival time\n    if (xs  x0 and xr  x0) or (xs >= x0 and xr >= x0):\n        c_segment = c1 if xs  x0 else c2\n        t_arrival = abs(xr - xs) / c_segment\n    else:\n        c_s_segment = c1 if xs  x0 else c2\n        c_r_segment = c1 if xr  x0 else c2\n        t_arrival = abs(x0 - xs) / c_s_segment + abs(xr - x0) / c_r_segment\n\n    # Find peak absolute intensity and set threshold\n    peak_intensity = np.max(np.abs(intensity_series))\n    threshold = 1e-5 * (peak_intensity + np.finfo(float).eps)\n\n    # Check for causality violation\n    causality_respected = True\n    pre_arrival_indices = np.where(time_series  t_arrival)[0]\n    \n    if pre_arrival_indices.size > 0:\n        pre_arrival_intensities = np.abs(intensity_series[pre_arrival_indices])\n        if np.any(pre_arrival_intensities > threshold):\n            causality_respected = False\n            \n    return causality_respected\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}