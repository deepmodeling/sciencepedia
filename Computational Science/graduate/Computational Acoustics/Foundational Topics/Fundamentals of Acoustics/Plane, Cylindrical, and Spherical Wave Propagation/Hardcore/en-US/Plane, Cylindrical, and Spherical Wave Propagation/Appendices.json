{
    "hands_on_practices": [
        {
            "introduction": "When solving the wave equation in spherical coordinates, we often decompose the field into a series of multipole components. This exercise focuses on the radial part of these solutions, the spherical Bessel functions, and their behavior near the origin . Understanding why one solution is \"regular\" and the other \"singular\" is fundamental to constructing physically valid acoustic models, especially in domains that include the source region.",
            "id": "4134660",
            "problem": "A time-harmonic acoustic pressure field $p(\\mathbf{x})$ in an inviscid, homogeneous, lossless fluid of constant sound speed $c$ and density $\\rho$ satisfies the scalar Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ with wavenumber $k = \\omega/c$. Consider a multipole component with angular order $\\ell \\in \\mathbb{N}_{0}$ obtained by separating variables in spherical coordinates, so that $p(\\mathbf{x}) = u_{\\ell}(r) Y_{\\ell m}(\\theta,\\phi)$ with $Y_{\\ell m}$ the spherical harmonics and $u_{\\ell}(r)$ satisfying the radial ordinary differential equation $r^{2} u_{\\ell}''(r) + 2 r u_{\\ell}'(r) + \\left(k^{2} r^{2} - \\ell(\\ell+1)\\right) u_{\\ell}(r) = 0$. The two linearly independent solutions are the spherical Bessel functions of the first and second kind, $j_{\\ell}(k r)$ and $y_{\\ell}(k r)$. \n\nStarting from the Helmholtz equation and separation of variables, and using only standard properties of Bessel functions that can be justified from their defining series, derive the leading small-argument asymptotic behavior of $j_{\\ell}(x)$ and $y_{\\ell}(x)$ as $x \\to 0^{+}$. Show that $j_{\\ell}(x)$ is the solution regular at the origin while $y_{\\ell}(x)$ is singular, and relate this to the physical admissibility of multipole fields at $r = 0$. \n\nDefine the dimensionless constant\n$$\nS_{\\ell} \\equiv \\lim_{x \\to 0^{+}} \\frac{1}{x^{2\\ell+1}} \\frac{j_{\\ell}(x)}{y_{\\ell}(x)}.\n$$\nExpress $S_{\\ell}$ in closed form in terms of $\\ell$ using double factorial notation, where for any nonnegative integer $n$, $(2n+1)!! \\equiv (2n+1)(2n-1)\\cdots 3 \\cdot 1$ and $(2n-1)!! \\equiv (2n-1)(2n-3)\\cdots 3 \\cdot 1$ with the convention $(-1)!! \\equiv 1$. \n\nYour final reported answer must be the exact, closed-form analytic expression for $S_{\\ell}$ as a function of $\\ell$. No numerical rounding is required. State no units, as $S_{\\ell}$ is dimensionless. Angles, if any appear in intermediate steps, are measured in radians.",
            "solution": "The problem statement is validated as follows.\n\n**Step 1: Extract Givens**\n- The governing equation is the scalar Helmholtz equation for acoustic pressure $p(\\mathbf{x})$: $\\nabla^{2} p + k^{2} p = 0$.\n- The medium is an inviscid, homogeneous, lossless fluid with constant sound speed $c$ and density $\\rho$.\n- The wavenumber is $k = \\omega/c$.\n- The pressure field is separated in spherical coordinates: $p(\\mathbf{x}) = u_{\\ell}(r) Y_{\\ell m}(\\theta,\\phi)$, with angular order $\\ell \\in \\mathbb{N}_{0}$ and spherical harmonics $Y_{\\ell m}$.\n- The radial function $u_{\\ell}(r)$ satisfies the spherical Bessel differential equation: $r^{2} u_{\\ell}''(r) + 2 r u_{\\ell}'(r) + \\left(k^{2} r^{2} - \\ell(\\ell+1)\\right) u_{\\ell}(r) = 0$.\n- The two linearly independent solutions for $u_{\\ell}(r)$ are the spherical Bessel functions of the first kind, $j_{\\ell}(k r)$, and the second kind, $y_{\\ell}(k r)$.\n- A dimensionless constant $S_{\\ell}$ is defined as the limit: $S_{\\ell} \\equiv \\lim_{x \\to 0^{+}} \\frac{1}{x^{2\\ell+1}} \\frac{j_{\\ell}(x)}{y_{\\ell}(x)}$.\n- The double factorial notation is defined as $(2n+1)!! \\equiv (2n+1)(2n-1)\\cdots 3 \\cdot 1$ and $(2n-1)!! \\equiv (2n-1)(2n-3)\\cdots 3 \\cdot 1$, with the convention $(-1)!! \\equiv 1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on the standard mathematical physics of acoustic wave propagation described by the Helmholtz equation. The use of separation of variables, spherical harmonics, and spherical Bessel functions is the canonical approach to solving this equation in spherical coordinates. The problem is well-posed, with all necessary equations and definitions provided to derive the required quantities. The language is objective and precise. The problem is a standard, non-trivial exercise in mathematical methods for physics and engineering, free of any of the invalidating flaws listed in the instructions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\nThe problem requires the derivation of the small-argument asymptotic behavior of the spherical Bessel functions $j_{\\ell}(x)$ and $y_{\\ell}(x)$, an analysis of their regularity at the origin and its physical implications, and the calculation of the constant $S_{\\ell}$.\n\nWe begin with the spherical Bessel differential equation, obtained by setting $x = kr$ in the given radial equation:\n$$\nx^{2} f''(x) + 2 x f'(x) + \\left(x^{2} - \\ell(\\ell+1)\\right) f(x) = 0\n$$\nwhere $f(x)$ represents either $j_{\\ell}(x)$ or $y_{\\ell}(x)$. The standard method for finding solutions to such an equation is the method of Frobenius, which reveals two indicial roots at $s_{1} = \\ell$ and $s_{2} = -(\\ell+1)$. These roots correspond to two linearly independent solutions with leading behaviors of $x^{\\ell}$ and $x^{-(\\ell+1)}$ respectively. To find the correctly normalized asymptotic forms, we use the standard definitions of spherical Bessel functions in terms of the ordinary Bessel functions, $J_{\\nu}(x)$:\n$$\nj_{\\ell}(x) = \\sqrt{\\frac{\\pi}{2x}} J_{\\ell+1/2}(x)\n$$\n$$\ny_{\\ell}(x) = \\sqrt{\\frac{\\pi}{2x}} Y_{\\ell+1/2}(x) = (-1)^{\\ell+1} \\sqrt{\\frac{\\pi}{2x}} J_{-(\\ell+1/2)}(x)\n$$\nThe second equality for $y_{\\ell}(x)$ uses the relation for Bessel functions of the second kind, $Y_{\\nu}(x)$, when the order $\\nu$ is a half-integer.\n\nThe defining series for the Bessel function of the first kind, $J_{\\nu}(x)$, is:\n$$\nJ_{\\nu}(x) = \\sum_{m=0}^{\\infty} \\frac{(-1)^{m}}{m! \\Gamma(m+\\nu+1)} \\left(\\frac{x}{2}\\right)^{2m+\\nu}\n$$\nwhere $\\Gamma$ is the Gamma function.\n\n**1. Asymptotic Behavior of $j_{\\ell}(x)$**\nTo find the small-argument behavior of $j_{\\ell}(x)$ as $x \\to 0^{+}$, we consider the leading term ($m=0$) of the series for $J_{\\ell+1/2}(x)$:\n$$\nJ_{\\ell+1/2}(x) \\sim \\frac{1}{\\Gamma(\\ell+1/2+1)} \\left(\\frac{x}{2}\\right)^{\\ell+1/2} = \\frac{1}{\\Gamma(\\ell+3/2)} \\left(\\frac{x}{2}\\right)^{\\ell+1/2}\n$$\nSubstituting this into the definition of $j_{\\ell}(x)$:\n$$\nj_{\\ell}(x) \\sim \\sqrt{\\frac{\\pi}{2x}} \\left( \\frac{1}{\\Gamma(\\ell+3/2)} \\left(\\frac{x}{2}\\right)^{\\ell+1/2} \\right) = \\sqrt{\\frac{\\pi}{2}} x^{-1/2} \\frac{1}{\\Gamma(\\ell+3/2)} \\frac{x^{\\ell+1/2}}{2^{\\ell+1/2}} = \\frac{\\sqrt{\\pi}}{2^{\\ell+1} \\Gamma(\\ell+3/2)} x^{\\ell}\n$$\nWe use the property of the Gamma function $\\Gamma(z+1) = z\\Gamma(z)$ and the value $\\Gamma(1/2) = \\sqrt{\\pi}$ to express $\\Gamma(\\ell+3/2)$ in terms of a double factorial:\n$$\n\\Gamma(\\ell+3/2) = \\left(\\ell+\\frac{1}{2}\\right) \\left(\\ell-\\frac{1}{2}\\right) \\cdots \\frac{1}{2} \\Gamma\\left(\\frac{1}{2}\\right) = \\frac{(2\\ell+1)(2\\ell-1)\\cdots 1}{2^{\\ell+1}} \\sqrt{\\pi} = \\frac{(2\\ell+1)!!}{2^{\\ell+1}} \\sqrt{\\pi}\n$$\nSubstituting this into the expression for $j_{\\ell}(x)$:\n$$\nj_{\\ell}(x) \\sim \\frac{\\sqrt{\\pi}}{2^{\\ell+1}} \\frac{1}{\\frac{(2\\ell+1)!!}{2^{\\ell+1}} \\sqrt{\\pi}} x^{\\ell} = \\frac{x^{\\ell}}{(2\\ell+1)!!}\n$$\nThis is the leading small-argument asymptotic behavior of $j_{\\ell}(x)$.\n\n**2. Asymptotic Behavior of $y_{\\ell}(x)$**\nSimilarly, for $y_{\\ell}(x)$, we use the leading term of the series for $J_{-(\\ell+1/2)}(x)$:\n$$\nJ_{-(\\ell+1/2)}(x) \\sim \\frac{1}{\\Gamma(-(\\ell+1/2)+1)} \\left(\\frac{x}{2}\\right)^{-(\\ell+1/2)} = \\frac{1}{\\Gamma(1/2-\\ell)} \\left(\\frac{x}{2}\\right)^{-(\\ell+1/2)}\n$$\nSubstituting this into the definition of $y_{\\ell}(x)$:\n$$\ny_{\\ell}(x) \\sim (-1)^{\\ell+1} \\sqrt{\\frac{\\pi}{2x}} \\left( \\frac{1}{\\Gamma(1/2-\\ell)} \\left(\\frac{x}{2}\\right)^{-(\\ell+1/2)} \\right) = \\frac{(-1)^{\\ell+1} \\sqrt{\\pi} 2^{\\ell}}{\\Gamma(1/2-\\ell)} x^{-(\\ell+1)}\n$$\nUsing the reflection formula for the Gamma function, $\\Gamma(z)\\Gamma(1-z) = \\frac{\\pi}{\\sin(\\pi z)}$, with $z = \\ell+1/2$:\n$$\n\\Gamma(\\ell+1/2) \\Gamma(1/2-\\ell) = \\frac{\\pi}{\\sin(\\pi(\\ell+1/2))} = \\frac{\\pi}{(-1)^{\\ell}}\n$$\nThus, $\\Gamma(1/2-\\ell) = \\frac{(-1)^{\\ell} \\pi}{\\Gamma(\\ell+1/2)}$. We know $\\Gamma(\\ell+1/2) = \\frac{(2\\ell-1)!!}{2^{\\ell}}\\sqrt{\\pi}$.\n$$\n\\Gamma(1/2-\\ell) = \\frac{(-1)^{\\ell} \\pi}{\\frac{(2\\ell-1)!!}{2^{\\ell}}\\sqrt{\\pi}} = \\frac{(-1)^{\\ell}\n\\sqrt{\\pi} 2^{\\ell}}{(2\\ell-1)!!}\n$$\nHere we use the convention that $(-1)!!=1$. Substituting this into the asymptotic expression for $y_{\\ell}(x)$:\n$$\ny_{\\ell}(x) \\sim \\frac{(-1)^{\\ell+1} \\sqrt{\\pi} 2^{\\ell}}{\\frac{(-1)^{\\ell} \\sqrt{\\pi} 2^{\\ell}}{(2\\ell-1)!!}} x^{-(\\ell+1)} = (-1) (2\\ell-1)!! x^{-(\\ell+1)}\n$$\nThis is the leading small-argument asymptotic behavior of $y_{\\ell}(x)$.\n\n**3. Regularity, Singularity, and Physical Admissibility**\nThe asymptotic forms are:\n$$\nj_{\\ell}(x) \\sim \\frac{x^{\\ell}}{(2\\ell+1)!!} \\quad \\text{as } x \\to 0^{+}\n$$\n$$\ny_{\\ell}(x) \\sim -(2\\ell-1)!! x^{-(\\ell+1)} \\quad \\text{as } x \\to 0^{+}\n$$\nFor any non-negative integer $\\ell \\in \\mathbb{N}_{0}$, the exponent $\\ell \\ge 0$. Thus, $j_{\\ell}(x)$ approaches a finite value as $x \\to 0$ ($j_0(0)=1$ and $j_{\\ell}(0)=0$ for $\\ell > 0$). This function is regular at the origin.\nFor any $\\ell \\in \\mathbb{N}_{0}$, the exponent $-(\\ell+1) \\le -1$. Thus, $|y_{\\ell}(x)| \\to \\infty$ as $x \\to 0$. This function is singular at the origin.\n\nIn a physical problem, the acoustic pressure field $p(\\mathbf{x}) = u_{\\ell}(r) Y_{\\ell m}(\\theta,\\phi)$ must remain finite everywhere in the domain of interest. If the domain includes the origin ($r=0$), any solution component that becomes infinite at the origin is physically inadmissible, as it would represent an infinite energy density. The general radial solution is a linear combination $u_{\\ell}(r) = A j_{\\ell}(kr) + B y_{\\ell}(kr)$. To ensure a finite pressure at $r=0$, the coefficient $B$ of the singular solution $y_{\\ell}(kr)$ must be zero. Therefore, for acoustic fields within a region containing the origin, only the regular solution $j_{\\ell}(kr)$ is physically admissible. The singular solution $y_{\\ell}(kr)$ is only valid in regions that exclude the origin, e.g., the exterior of a radiating object.\n\n**4. Calculation of $S_{\\ell}$**\nWe now compute the defined limit for $S_{\\ell}$:\n$$\nS_{\\ell} \\equiv \\lim_{x \\to 0^{+}} \\frac{1}{x^{2\\ell+1}} \\frac{j_{\\ell}(x)}{y_{\\ell}(x)}\n$$\nWe substitute the derived asymptotic expressions for $j_{\\ell}(x)$ and $y_{\\ell}(x)$ into the fraction:\n$$\n\\frac{j_{\\ell}(x)}{y_{\\ell}(x)} \\sim \\frac{\\frac{x^{\\ell}}{(2\\ell+1)!!}}{-(2\\ell-1)!! x^{-(\\ell+1)}} = -\\frac{1}{(2\\ell+1)!! (2\\ell-1)!!} x^{\\ell - (-(\\ell+1))} = -\\frac{x^{2\\ell+1}}{(2\\ell+1)!! (2\\ell-1)!!}\n$$\nNow, we evaluate the limit for $S_{\\ell}$:\n$$\nS_{\\ell} = \\lim_{x \\to 0^{+}} \\frac{1}{x^{2\\ell+1}} \\left( -\\frac{x^{2\\ell+1}}{(2\\ell+1)!! (2\\ell-1)!!} \\right)\n$$\nThe terms involving $x$ cancel out, leaving a constant:\n$$\nS_{\\ell} = -\\frac{1}{(2\\ell+1)!! (2\\ell-1)!!}\n$$\nThis is the closed-form expression for $S_{\\ell}$ as a function of $\\ell$.",
            "answer": "$$\n\\boxed{-\\frac{1}{(2\\ell+1)!! (2\\ell-1)!!}}\n$$"
        },
        {
            "introduction": "While simple geometric spreading laws like $1/r$ are useful first approximations, real-world media are often inhomogeneous, causing wave amplitudes to scale differently. This practice introduces the Wentzel–Kramers–Brillouin (WKB) approximation, a powerful high-frequency technique for analyzing wave propagation through slowly varying media . By deriving the amplitude scaling in a medium with a variable sound speed, you will gain insight into how energy is conserved along ray paths and see how familiar homogeneous-medium behaviors emerge as special cases.",
            "id": "4134620",
            "problem": "Consider a lossless, inviscid acoustic medium of constant mass density, with a spherically symmetric but spatially varying sound speed given by $c(r) = c_{0}\\bigl(1 + \\alpha r^{2}\\bigr)$, where $\\alpha \\ge 0$ and $c_{0} > 0$ are constants, and $r$ is the radial distance from a source. A time-harmonic, high-frequency source located on a reference sphere of radius $r_{0} > 0$ launches outward-propagating rays. Adopt the scalar acoustic pressure description and the high-frequency Wentzel–Kramers–Brillouin (WKB) ansatz, and treat the wavefront geometry as locally separable from the medium inhomogeneity so that the rays remain radial. Begin from the scalar wave equation for the complex pressure amplitude $P(\\boldsymbol{x})$ under time-harmonic excitation,\n$$\n\\nabla^{2} P(\\boldsymbol{x}) + \\frac{\\omega^{2}}{c^{2}(\\boldsymbol{x})}\\,P(\\boldsymbol{x}) = 0,\n$$\nwith angular frequency $\\omega \\gg 1$ in nondimensional units. Insert the WKB form $P(\\boldsymbol{x}) = a(\\boldsymbol{x}) \\exp\\!\\bigl(i \\omega \\tau(\\boldsymbol{x})\\bigr)$ and, by asymptotic separation of orders in $\\omega$, derive the eikonal and transport equations. Next, use the transport equation to obtain a conservation law for the product of the squared amplitude and an appropriate geometric factor along a ray tube. In a spherically symmetric medium with radial rays, the cross-sectional “area” of a narrow ray tube scales as\n$$\nA(r) \\propto r^{2\\gamma},\n$$\nwhere the geometric spreading exponent $\\gamma$ is defined by $\\gamma = 1$ for spherical spreading (point-source geometry in three dimensions) and $\\gamma = \\tfrac{1}{2}$ for cylindrical spreading (line-source geometry in two dimensions, per unit axial length).\n\nFollowing this procedure, obtain a closed-form expression for the amplitude ratio $a(r)/a(r_{0})$ along an outward radial ray in the given medium. Express your final result as a single analytic expression in terms of $r$, $r_{0}$, $\\alpha$, and $\\gamma$ only. Then, as part of your derivation, take the limit $\\alpha \\to 0$ and verify that the result reduces to the familiar homogeneous-medium behaviors corresponding to spherical spreading proportional to $1/r$ when $\\gamma = 1$ and cylindrical spreading proportional to $1/\\sqrt{r}$ when $\\gamma = \\tfrac{1}{2}$.\n\nYour final reported answer must be only the single closed-form expression for $a(r)/a(r_{0})$ as instructed above. No numerical evaluation or rounding is required.",
            "solution": "The problem is first validated.\n\nStep 1: Extract Givens\n-   Governing Equation: The time-harmonic scalar wave equation (Helmholtz equation) for the complex pressure amplitude $P(\\boldsymbol{x})$ is $\\nabla^{2} P(\\boldsymbol{x}) + \\frac{\\omega^{2}}{c^{2}(\\boldsymbol{x})}\\,P(\\boldsymbol{x}) = 0$.\n-   Acoustic Medium: Lossless, inviscid, constant mass density.\n-   Sound Speed Profile: Spherically symmetric and spatially varying, given by $c(r) = c_{0}\\bigl(1 + \\alpha r^{2}\\bigr)$, where $r$ is the radial distance, and $\\alpha \\ge 0$, $c_{0} > 0$ are constants.\n-   Source: Time-harmonic, high-frequency ($\\omega \\gg 1$), located on a reference sphere of radius $r_{0} > 0$.\n-   Wave Propagation: Outward-propagating rays are assumed to remain radial.\n-   WKB Ansatz: The solution is of the form $P(\\boldsymbol{x}) = a(\\boldsymbol{x}) \\exp\\!\\bigl(i \\omega \\tau(\\boldsymbol{x})\\bigr)$, where $a(\\boldsymbol{x})$ is the amplitude and $\\tau(\\boldsymbol{x})$ is the eikonal (phase).\n-   Ray Tube Geometry: The cross-sectional area of a narrow ray tube scales as $A(r) \\propto r^{2\\gamma}$.\n-   Geometric Spreading Exponent: $\\gamma = 1$ for spherical spreading, and $\\gamma = \\tfrac{1}{2}$ for cylindrical spreading.\n-   Objective: Derive a closed-form expression for the amplitude ratio $a(r)/a(r_{0})$ in terms of $r$, $r_{0}$, $\\alpha$, and $\\gamma$.\n\nStep 2: Validate Using Extracted Givens\n-   Scientific Grounding: The problem is firmly rooted in the principles of wave mechanics, specifically high-frequency asymptotic analysis (WKB method) applied to the scalar wave equation. This is a standard and valid approach in acoustics and other fields of physics. The assumed sound speed profile is a physically plausible model for an inhomogeneous medium. The assumption of radial rays in a spherically symmetric medium for a radial source is consistent.\n-   Well-Posedness: The problem is well-posed. It provides a governing partial differential equation, a specific form for the medium's properties, a prescribed solution ansatz, and a clear objective. The provided information is sufficient to derive a unique solution for the amplitude ratio.\n-   Objectivity: The problem is stated in precise, objective, and mathematical language, free from ambiguity or subjective claims.\n\nStep 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. A solution will be derived.\n\nThe starting point is the Helmholtz equation for the complex pressure amplitude $P(\\boldsymbol{x})$:\n$$\n\\nabla^{2} P + k^{2} P = 0\n$$\nwhere the wavenumber $k(\\boldsymbol{x}) = \\omega / c(\\boldsymbol{x})$. We substitute the WKB ansatz, $P(\\boldsymbol{x}) = a(\\boldsymbol{x}) \\exp(i\\omega\\tau(\\boldsymbol{x}))$, into this equation. First, we compute the Laplacian of $P$:\n$$\n\\nabla P = (\\nabla a + i\\omega a \\nabla\\tau) \\exp(i\\omega\\tau)\n$$\n$$\n\\nabla^{2} P = \\nabla \\cdot (\\nabla P) = [\\nabla^{2} a + i\\omega(2\\nabla a \\cdot \\nabla\\tau + a\\nabla^{2}\\tau) - \\omega^{2} a (\\nabla\\tau)^{2}] \\exp(i\\omega\\tau)\n$$\nSubstituting this into the Helmholtz equation and dividing by $\\exp(i\\omega\\tau)$ yields:\n$$\n\\nabla^{2} a + i\\omega(2\\nabla a \\cdot \\nabla\\tau + a\\nabla^{2}\\tau) - \\omega^{2} a (\\nabla\\tau)^{2} + \\frac{\\omega^{2}}{c^{2}} a = 0\n$$\nWe group terms by powers of $\\omega$. In the high-frequency limit, $\\omega \\gg 1$, we can asymptotically separate the equation.\n\nThe terms of order $\\mathcal{O}(\\omega^{2})$ must vanish independently:\n$$\n- \\omega^{2} a (\\nabla\\tau)^{2} + \\frac{\\omega^{2}}{c^{2}} a = 0 \\implies (\\nabla\\tau)^{2} = \\frac{1}{c^{2}}\n$$\nThis is the **eikonal equation**. It determines the phase function $\\tau(\\boldsymbol{x})$. Its solutions, surfaces of constant $\\tau$, represent the wavefronts.\n\nThe terms of order $\\mathcal{O}(\\omega^{1})$ must also vanish:\n$$\ni\\omega(2\\nabla a \\cdot \\nabla\\tau + a\\nabla^2\\tau) = 0 \\implies 2\\nabla a \\cdot \\nabla\\tau + a\\nabla^2\\tau = 0\n$$\nThis is the **transport equation**. It governs the wave amplitude $a(\\boldsymbol{x})$.\n\nTo find a conservation law, we multiply the transport equation by $a$:\n$$\n2a \\nabla a \\cdot \\nabla\\tau + a^{2} \\nabla^2\\tau = 0\n$$\nRecognizing that $2a\\nabla a = \\nabla(a^{2})$, we have:\n$$\n\\nabla(a^{2}) \\cdot \\nabla\\tau + a^{2} \\nabla^2\\tau = 0\n$$\nThis expression is the divergence of the vector field $a^{2}\\nabla\\tau$, i.e., $\\nabla \\cdot (a^{2}\\nabla\\tau)$. Therefore, the transport equation is equivalent to the conservation law:\n$$\n\\nabla \\cdot (a^{2} \\nabla\\tau) = 0\n$$\nThis law states that the flux of the quantity $a^{2}\\nabla\\tau$ is conserved. The vector $\\nabla\\tau$ is normal to the wavefronts and points in the direction of the rays. From the eikonal equation, its magnitude is $|\\nabla\\tau| = 1/c$. So, $\\nabla\\tau = \\hat{\\boldsymbol{s}}/c$, where $\\hat{\\boldsymbol{s}}$ is the unit vector tangent to the ray.\n\nIntegrating the conservation law over an infinitesimally thin ray tube and applying the divergence theorem, we find that the quantity $a^{2}|\\nabla\\tau|A$ is constant along the ray, where $A$ is the cross-sectional area of the ray tube.\n$$\na^{2} \\frac{1}{c} A = \\text{constant}\n$$\nThis is a statement of energy conservation, as the intensity is proportional to $a^{2}/c$ in this formulation (assuming constant density) and $A$ is the area through which the energy flows. For two points on a ray, at $r_{0}$ and $r$, we have:\n$$\n\\frac{a^{2}(r) A(r)}{c(r)} = \\frac{a^{2}(r_{0}) A(r_{0})}{c(r_{0})}\n$$\nWe can solve for the amplitude ratio $a(r)/a(r_{0})$:\n$$\n\\left(\\frac{a(r)}{a(r_{0})}\\right)^{2} = \\frac{A(r_{0})}{A(r)} \\frac{c(r)}{c(r_{0})} \\implies \\frac{a(r)}{a(r_{0})} = \\sqrt{\\frac{A(r_{0})}{A(r)}} \\sqrt{\\frac{c(r)}{c(r_{0})}}\n$$\nNow, we substitute the specific forms provided in the problem.\nThe sound speed is $c(r) = c_{0}(1 + \\alpha r^{2})$. The ratio of sound speeds is:\n$$\n\\frac{c(r)}{c(r_{0})} = \\frac{c_{0}(1 + \\alpha r^{2})}{c_{0}(1 + \\alpha r_{0}^{2})} = \\frac{1 + \\alpha r^{2}}{1 + \\alpha r_{0}^{2}}\n$$\nThe ray tube area scales as $A(r) \\propto r^{2\\gamma}$, which means $A(r) = C r^{2\\gamma}$ for some constant $C$. The ratio of areas is:\n$$\n\\frac{A(r_{0})}{A(r)} = \\frac{C r_{0}^{2\\gamma}}{C r^{2\\gamma}} = \\left(\\frac{r_{0}}{r}\\right)^{2\\gamma}\n$$\nSubstituting these two ratios into the expression for the amplitude ratio:\n$$\n\\frac{a(r)}{a(r_{0})} = \\sqrt{\\left(\\frac{r_{0}}{r}\\right)^{2\\gamma}} \\sqrt{\\frac{1 + \\alpha r^{2}}{1 + \\alpha r_{0}^{2}}}\n$$\nSince $r, r_0 > 0$, we can simplify the first term:\n$$\n\\frac{a(r)}{a(r_{0})} = \\left(\\frac{r_{0}}{r}\\right)^{\\gamma} \\sqrt{\\frac{1 + \\alpha r^{2}}{1 + \\alpha r_{0}^{2}}}\n$$\nThis is the final closed-form expression for the amplitude ratio.\n\nAs a verification, we examine the limit as $\\alpha \\to 0$, which corresponds to a homogeneous medium where $c(r) \\to c_{0}$.\n$$\n\\lim_{\\alpha \\to 0} \\frac{a(r)}{a(r_{0})} = \\lim_{\\alpha \\to 0} \\left[ \\left(\\frac{r_{0}}{r}\\right)^{\\gamma} \\sqrt{\\frac{1 + \\alpha r^{2}}{1 + \\alpha r_{0}^{2}}} \\right] = \\left(\\frac{r_{0}}{r}\\right)^{\\gamma} \\sqrt{\\frac{1}{1}} = \\left(\\frac{r_{0}}{r}\\right)^{\\gamma}\n$$\nThis implies $a(r) = a(r_{0}) (r_{0}/r)^{\\gamma}$, so $a(r) \\propto r^{-\\gamma}$.\nFor spherical spreading, $\\gamma = 1$, so $a(r) \\propto 1/r$.\nFor cylindrical spreading, $\\gamma = 1/2$, so $a(r) \\propto 1/\\sqrt{r}$.\nThese results match the known amplitude decay laws for spherical and cylindrical waves in a homogeneous medium, validating the derived expression.",
            "answer": "$$\n\\boxed{\\left(\\frac{r_{0}}{r}\\right)^{\\gamma} \\sqrt{\\frac{1 + \\alpha r^{2}}{1 + \\alpha r_{0}^{2}}}}\n$$"
        },
        {
            "introduction": "Translating the continuous wave equation into a discrete algorithm for computer simulation inevitably introduces artifacts that are not present in the original physics. This hands-on coding exercise delves into one of the most critical of these: numerical dispersion, where the wave speed becomes dependent on frequency and propagation direction relative to the grid . By analyzing a standard finite-difference scheme, you will derive the discrete dispersion relation and quantify the resulting phase error, a crucial skill for assessing the accuracy of any wave propagation simulation.",
            "id": "4134634",
            "problem": "Consider the two-dimensional linear acoustic wave equation in a homogeneous medium,\n$$\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\left( \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} \\right),$$\nwhere $p$ is the acoustic pressure field and $c$ is the speed of sound. On a uniform Cartesian grid with spatial steps $\\Delta x$ and $\\Delta y$ and time step $\\Delta t$, approximate the second derivatives by standard second-order centered finite differences in space and time. This leads to the explicit second-order finite difference scheme\n$$\\frac{p_{i,j}^{n+1} - 2 p_{i,j}^{n} + p_{i,j}^{n-1}}{\\Delta t^2} = c^2 \\left( \\frac{p_{i+1,j}^{n} - 2 p_{i,j}^{n} + p_{i-1,j}^{n}}{\\Delta x^2} + \\frac{p_{i,j+1}^{n} - 2 p_{i,j}^{n} + p_{i,j-1}^{n}}{\\Delta y^2} \\right),$$\nwhere $i$ and $j$ index the grid in space and $n$ indexes time. Starting from the linear acoustic wave equation and its discrete approximation above, perform a plane wave analysis by substituting a discrete plane wave of the form\n$$p_{i,j}^{n} = A \\exp\\left( \\mathrm{i} \\left( k_x i \\Delta x + k_y j \\Delta y - \\omega n \\Delta t \\right) \\right),$$\nwhere $A$ is a constant amplitude, $k_x$ and $k_y$ are the Cartesian components of the wavenumber vector $\\mathbf{k}$ with magnitude $|\\mathbf{k}| = k$, and $\\omega$ is the angular frequency. Derive the discrete dispersion relation $\\omega(\\mathbf{k})$ of this scheme. Use the principal branch for the angular frequency such that $0 \\le \\omega \\Delta t \\le \\pi$.\n\nUsing the derived $\\omega(\\mathbf{k})$, define the numerical phase speed $c_{\\mathrm{num}} = \\omega / k$. Quantify the angle-dependent phase speed error by computing the relative error\n$$\\varepsilon = \\frac{c_{\\mathrm{num}}}{c} - 1,$$\nas a decimal (for example, an error of $5\\%$ must be reported as $0.05$). Angles must be expressed in radians. All physical quantities must be handled in Standard International (SI) units: meters ($\\mathrm{m}$), seconds ($\\mathrm{s}$), and radians ($\\mathrm{rad}$).\n\nYour program must implement the derived discrete dispersion relation and evaluate $\\varepsilon$ for each of the following test cases. For cases where a Courant number is specified, use the relation $\\Delta t = S \\Delta x / c$ for isotropic grids with $\\Delta x = \\Delta y$, and for anisotropic grids use $\\Delta t = S_x \\Delta x / c$ (which implies an effective $S_y = c \\Delta t / \\Delta y$). Ensure that the stability condition is respected implicitly by these choices.\n\nTest suite parameter sets (each case specifies $(c, \\Delta x, \\Delta y, \\Delta t, k, \\theta)$ with $\\theta$ the propagation angle measured from the $x$-axis):\n- Case $1$: $c = 343\\,\\mathrm{m/s}$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.01\\,\\mathrm{m}$, $S = 0.7$ so $\\Delta t = S \\Delta x / c$, $k = 200\\,\\mathrm{rad/m}$, $\\theta = 0$.\n- Case $2$: $c = 343\\,\\mathrm{m/s}$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.01\\,\\mathrm{m}$, $S = 0.7$ so $\\Delta t = S \\Delta x / c$, $k = 200\\,\\mathrm{rad/m}$, $\\theta = \\pi/4$.\n- Case $3$: $c = 343\\,\\mathrm{m/s}$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.01\\,\\mathrm{m}$, $S = 0.7$ so $\\Delta t = S \\Delta x / c$, $k = 10\\,\\mathrm{rad/m}$, $\\theta = \\pi/8$.\n- Case $4$: $c = 343\\,\\mathrm{m/s}$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.01\\,\\mathrm{m}$, $S = 0.7$ so $\\Delta t = S \\Delta x / c$, $k = 0.95 \\pi / \\Delta x\\,\\mathrm{rad/m}$, $\\theta = \\pi/4$.\n- Case $5$: $c = 343\\,\\mathrm{m/s}$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\Delta y = 0.015\\,\\mathrm{m}$, $S_x = 0.6$ so $\\Delta t = S_x \\Delta x / c$ and $S_y = c \\Delta t / \\Delta y$, $k = 180\\,\\mathrm{rad/m}$, $\\theta = \\pi/3$.\n- Case $6$: $c = 1500\\,\\mathrm{m/s}$, $\\Delta x = 0.02\\,\\mathrm{m}$, $\\Delta y = 0.02\\,\\mathrm{m}$, $S = 0.6$ so $\\Delta t = S \\Delta x / c$, $k = 80\\,\\mathrm{rad/m}$, $\\theta = \\pi/6$.\n\nYour program should produce a single line of output containing the relative phase speed errors $\\varepsilon$ for these six cases as a comma-separated list enclosed in square brackets (for example, $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_5,\\varepsilon_6]$). The values must be dimensionless decimals (no percentage sign), in the order listed above.",
            "solution": "The objective is to derive the discrete dispersion relation for a second-order finite-difference scheme for the two-dimensional linear acoustic wave equation and to use this relation to quantify the numerical phase speed error for a given set of parameters.\n\nThe starting point is the two-dimensional linear acoustic wave equation in a homogeneous, lossless medium:\n$$ \\frac{\\partial^2 p}{\\partial t^2} = c^2 \\left( \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} \\right) $$\nwhere $p(x,y,t)$ is the acoustic pressure, and $c$ is the constant speed of sound. This equation is discretized on a uniform Cartesian grid with spatial steps $\\Delta x$ and $\\Delta y$, and a time step $\\Delta t$. The pressure at grid point $(i\\Delta x, j\\Delta y)$ and time $n\\Delta t$ is denoted by $p_{i,j}^{n}$. Using second-order centered finite differences for all second derivatives, we obtain the explicit finite-difference time-domain (FDTD) scheme:\n$$ \\frac{p_{i,j}^{n+1} - 2 p_{i,j}^{n} + p_{i,j}^{n-1}}{\\Delta t^2} = c^2 \\left( \\frac{p_{i+1,j}^{n} - 2 p_{i,j}^{n} + p_{i-1,j}^{n}}{\\Delta x^2} + \\frac{p_{i,j+1}^{n} - 2 p_{i,j}^{n} + p_{i,j-1}^{n}}{\\Delta y^2} \\right) $$\n\nTo perform a plane wave analysis (also known as von Neumann analysis), we substitute a discrete plane-wave solution, or ansatz, of the form\n$$ p_{i,j}^{n} = A \\exp\\left( \\mathrm{i} \\left( k_x i \\Delta x + k_y j \\Delta y - \\omega n \\Delta t \\right) \\right) $$\ninto the numerical scheme. Here, $A$ is a constant amplitude, $k_x$ and $k_y$ are the Cartesian components of the wavenumber vector $\\mathbf{k}$, $\\omega$ is the angular frequency, and $\\mathrm{i}$ is the imaginary unit.\n\nSubstituting the ansatz requires evaluating the pressure at shifted grid points $(i\\pm 1, j, n)$, $(i, j\\pm 1, n)$, and $(i, j, n\\pm 1)$:\n\\begin{itemize}\n    \\item $p_{i,j}^{n\\pm 1} = p_{i,j}^{n} \\exp(\\mp \\mathrm{i} \\omega \\Delta t)$\n    \\item $p_{i\\pm 1,j}^{n} = p_{i,j}^{n} \\exp(\\pm \\mathrm{i} k_x \\Delta x)$\n    \\item $p_{i,j\\pm 1}^{n} = p_{i,j}^{n} \\exp(\\pm \\mathrm{i} k_y \\Delta y)$\n\\end{itemize}\nPlugging these into the FDTD scheme and dividing by the common non-zero factor $p_{i,j}^{n}$:\n$$ \\frac{\\exp(-\\mathrm{i} \\omega \\Delta t) - 2 + \\exp(\\mathrm{i} \\omega \\Delta t)}{\\Delta t^2} = c^2 \\left( \\frac{\\exp(\\mathrm{i} k_x \\Delta x) - 2 + \\exp(-\\mathrm{i} k_x \\Delta x)}{\\Delta x^2} + \\frac{\\exp(\\mathrm{i} k_y \\Delta y) - 2 + \\exp(-\\mathrm{i} k_y \\Delta y)}{\\Delta y^2} \\right) $$\nUsing Euler's formula, $\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi) = 2 \\cos(\\phi)$, the equation simplifies to:\n$$ \\frac{2 \\cos(\\omega \\Delta t) - 2}{\\Delta t^2} = c^2 \\left( \\frac{2 \\cos(k_x \\Delta x) - 2}{\\Delta x^2} + \\frac{2 \\cos(k_y \\Delta y) - 2}{\\Delta y^2} \\right) $$\nNext, we employ the half-angle identity $1 - \\cos(\\phi) = 2 \\sin^2(\\phi/2)$:\n$$ \\frac{-4 \\sin^2(\\omega \\Delta t / 2)}{\\Delta t^2} = c^2 \\left( \\frac{-4 \\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{-4 \\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right) $$\nCanceling the common factor of $-4$ yields:\n$$ \\frac{\\sin^2(\\omega \\Delta t / 2)}{\\Delta t^2} = c^2 \\left( \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right) $$\nTo solve for $\\omega$, we first isolate $\\sin(\\omega \\Delta t / 2)$. The problem specifies using the principal branch for $\\omega$, such that $0 \\le \\omega \\Delta t \\le \\pi$. This implies $0 \\le \\omega \\Delta t / 2 \\le \\pi/2$, for which $\\sin(\\omega \\Delta t / 2)$ is non-negative. Taking the positive square root:\n$$ \\sin(\\omega \\Delta t / 2) = c \\Delta t \\sqrt{ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} } $$\nApplying the arcsin function and solving for $\\omega$ gives the discrete dispersion relation:\n$$ \\omega(\\mathbf{k}) = \\frac{2}{\\Delta t} \\arcsin\\left( c \\Delta t \\sqrt{ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} } \\right) $$\nThis equation relates the numerical angular frequency $\\omega$ to the wavenumber components $k_x$ and $k_y$, and it differs from the continuous dispersion relation $\\omega = c k = c \\sqrt{k_x^2 + k_y^2}$. This difference is the source of numerical dispersion.\n\nThe numerical phase speed $c_{\\mathrm{num}}$ is defined as $\\omega/k$, where $k = |\\mathbf{k}| = \\sqrt{k_x^2 + k_y^2}$. The relative phase speed error $\\varepsilon$ is then computed as:\n$$ \\varepsilon = \\frac{c_{\\mathrm{num}}}{c} - 1 = \\frac{\\omega(\\mathbf{k})}{c k} - 1 $$\nSubstituting the expression for $\\omega(\\mathbf{k})$:\n$$ \\varepsilon = \\frac{1}{c k} \\left[ \\frac{2}{\\Delta t} \\arcsin\\left( c \\Delta t \\sqrt{ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} } \\right) \\right] - 1 $$\nThe wavenumber components are related to the propagation angle $\\theta$ (measured from the $x$-axis) and magnitude $k$ by $k_x = k \\cos(\\theta)$ and $k_y = k \\sin(\\theta)$.\n\nFor implementation, the following steps are executed for each test case:\n1.  Obtain the parameters: $c, \\Delta x, \\Delta y, k, \\theta$, and the Courant number ($S$ or $S_x$).\n2.  Calculate the time step $\\Delta t$ using the provided Courant number definition. For isotropic grids ($\\Delta x = \\Delta y$), $\\Delta t = S \\Delta x / c$. For the anisotropic case, $\\Delta t = S_x \\Delta x / c$.\n3.  Calculate the wavenumber components $k_x = k \\cos(\\theta)$ and $k_y = k \\sin(\\theta)$.\n4.  Evaluate the argument of the arcsin function: $A = c \\Delta t \\sqrt{ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} }$.\n5.  Calculate the numerical angular frequency $\\omega = (2/\\Delta t) \\arcsin(A)$.\n6.  Calculate the numerical phase speed $c_{\\mathrm{num}} = \\omega / k$.\n7.  Compute the relative error $\\varepsilon = c_{\\mathrm{num}}/c - 1$.\nThe stability of this scheme is ensured by the Courant-Friedrichs-Lewy (CFL) condition, which requires that the argument of the arcsin function be less than or equal to $1$ for all possible wavenumbers. This leads to the condition $c \\Delta t \\sqrt{1/\\Delta x^2 + 1/\\Delta y^2} \\le 1$. The Courant numbers in the test cases are chosen to satisfy this condition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are required.\n\ndef solve():\n    \"\"\"\n    Derives the discrete dispersion relation for the 2D FDTD acoustic wave scheme\n    and calculates the relative phase speed error for several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (c, dx, dy, S_or_Sx, k, theta).\n    # For isotropic grids, the fourth element is the Courant number S.\n    # For anisotropic grids, it is Sx.\n    test_cases = [\n        (343.0, 0.01, 0.01, 0.7, 200.0, 0.0),\n        (343.0, 0.01, 0.01, 0.7, 200.0, np.pi/4),\n        (343.0, 0.01, 0.01, 0.7, 10.0, np.pi/8),\n        (343.0, 0.01, 0.01, 0.7, 0.95 * np.pi / 0.01, np.pi/4),\n        (343.0, 0.01, 0.015, 0.6, 180.0, np.pi/3),\n        (1500.0, 0.02, 0.02, 0.6, 80.0, np.pi/6),\n    ]\n\n    results = []\n    \n    # Differentiate case 5 as it has an anisotropic grid definition\n    # for the Courant number.\n    anisotropic_case_index = 4 # Case 5 is index 4\n\n    for i, case in enumerate(test_cases):\n        c, dx, dy, s_param, k, theta = case\n        \n        # Calculate time step dt based on Courant number definition\n        if i == anisotropic_case_index:\n            # Case 5: S_x is given\n            Sx = s_param\n            dt = Sx * dx / c\n        else:\n            # All other cases: S is given for isotropic grid\n            S = s_param\n            dt = S * dx / c\n\n        # Calculate wavenumber components\n        kx = k * np.cos(theta)\n        ky = k * np.sin(theta)\n\n        # Calculate terms inside the square root of the dispersion relation\n        term_x_arg = kx * dx / 2.0\n        term_y_arg = ky * dy / 2.0\n        \n        # Handle the case where dx or dy is zero, although not in test cases\n        if dx == 0:\n            term_x = (kx / 2.0)**2\n        else:\n            term_x = (np.sin(term_x_arg) / dx)**2\n\n        if dy == 0:\n            term_y = (ky / 2.0)**2\n        else:\n            term_y = (np.sin(term_y_arg) / dy)**2\n\n        # Argument for the arcsin function\n        # The stability condition ensures this is = 1.0\n        arcsin_arg = c * dt * np.sqrt(term_x + term_y)\n\n        # Calculate numerical angular frequency omega\n        omega_num = (2.0 / dt) * np.arcsin(arcsin_arg)\n\n        # Calculate numerical phase speed\n        # Handle k=0 case to avoid division by zero, although not in tests\n        if k == 0:\n            c_num = c # In the limit k->0, dispersion error is zero\n        else:\n            c_num = omega_num / k\n\n        # Calculate relative phase speed error\n        epsilon = c_num / c - 1.0\n        results.append(epsilon)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}