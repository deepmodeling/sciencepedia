{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在巩固PML的理论基础。我们将通过解析推导PML界面处的反射系数，来证明在理想的连续介质条件下，以及采用恰当的分离场（split-field）PML公式时，为何该吸收层对于任意入射角的平面波都能实现完美的无反射吸收。通过这个推导，你将深刻理解PML设计的核心原理，即通过坐标变换使得波在PML内部衰减，同时在界面处保持阻抗匹配。",
            "id": "4133649",
            "problem": "考虑在密度为 $\\rho_0$、体积模量为 $K$ 的均匀、无粘性流体中的线性声波传播。假设时间谐波依赖关系为因子 $\\exp(i \\omega t)$，角频率为 $\\omega$，声速 $c$ 满足 $c^2 = K/\\rho_0$。\n\n一个压力为 $p^{\\text{inc}}(x,y) = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big)$ 的二维斜平面波从半空间 $x  0$ 入射到位于 $x = 0$ 的平面界面上。波数满足 $k_x = k \\cos \\theta$, $k_y = k \\sin \\theta$ 和 $k = \\omega/c$，其中入射角 $\\theta \\in (0,\\pi/2)$ 是一个固定值。半空间 $x \\ge 0$ 被一个完美匹配层（PML）占据，该PML通过复坐标拉伸的分裂场公式实现，其中空间导数被修改为 $\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x$ 和 $\\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y$。拉伸因子为 $s_x(x) = 1 + \\sigma_x(x)/(i \\omega)$ 和 $s_y(y) = 1 + \\sigma_y(y)/(i \\omega)$，其中 $\\sigma_x$ 和 $\\sigma_y$ 分别是定义在 $x \\ge 0$ 和 $y \\in \\mathbb{R}$ 上的分段常数函数。在物理半空间 $x  0$ 中，$s_x = s_y = 1$。假设设计确保 $s_y(0^+) = 1$，这样在入口界面处不施加切向拉伸，而允许 $s_x(0^+) \\neq 1$。\n\n从线性化声学方程和上述PML修正出发，推导反射系数 $R$。$R$ 定义为在界面 $x = 0$ 处，给定斜入射条件下，反射压力与入射压力的复振幅之比，即 $R = p^{\\text{ref}}(0,y)/p^{\\text{inc}}(0,y)$。您的推导必须从动量方程和连续性方程开始，强制施加适当的边界连续性条件，并确定PML介质中与修正后的色散关系一致的透射波。将 $R$ 表示为 $\\rho_0$、$K$、$\\omega$、$\\theta$ 以及入口值 $s_x(0^+)$ 和 $s_y(0^+)$ 的闭式解析表达式，然后根据所述的入口条件 $s_y(0^+) = 1$ 进行简化，以得出最终答案。最后，利用您推导出的表达式论证，在任意可接受的连续剖面 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的分段常数近似的连续极限下，$x=0$ 处的反射系数为零。最终答案必须是 $R$ 的单个闭式表达式。无需四舍五入，答案是无量纲的。",
            "solution": "我们从具有时间谐波依赖关系 $\\exp(i \\omega t)$ 的线性化声学方程开始：\n\n$$\n\\rho_0\\, i \\omega\\, \\mathbf{v} = - \\nabla p, \\qquad \\frac{i \\omega}{K}\\, p = - \\nabla \\cdot \\mathbf{v},\n$$\n\n其中 $p$ 是压力，$\\mathbf{v} = (v_x, v_y)$ 是质点速度。在均匀的物理介质（无PML）中，平面波 $p = A \\exp\\!\\big(i \\mathbf{k} \\cdot \\mathbf{x}\\big)$ 满足 $\\mathbf{v} = - \\frac{\\mathbf{k}}{\\omega \\rho_0}\\, p$ 和色散关系 $|\\mathbf{k}|^2 = \\frac{\\omega^2 \\rho_0}{K} = k^2$。\n\n在分裂场完美匹配层（PML）区域中，空间导数被修改为\n\n$$\n\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x, \\qquad \\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y,\n$$\n\n其中\n\n$$\ns_x(x) = 1 + \\frac{\\sigma_x(x)}{i \\omega}, \\qquad s_y(y) = 1 + \\frac{\\sigma_y(y)}{i \\omega},\n$$\n\n其中 $\\sigma_x$ 和 $\\sigma_y$ 是非负的分段常数剖面。在入口界面 $x=0$ 附近，我们允许 $s_x(0^+) \\neq 1$，同时假设 $s_y(0^+) = 1$（在界面处无切向拉伸），以确保斜入射匹配。\n\n在频域中，PML修正后的动量方程和连续性方程（在二维情况下，且 $s_x$、$s_y$ 局部为分段常数）为\n\n$$\n\\rho_0\\, i \\omega\\, v_x = - \\frac{1}{s_x}\\, \\partial_x p, \\qquad \\rho_0\\, i \\omega\\, v_y = - \\frac{1}{s_y}\\, \\partial_y p,\n$$\n\n\n$$\n\\frac{i \\omega}{K}\\, p = - \\left( \\frac{1}{s_x}\\, \\partial_x v_x + \\frac{1}{s_y}\\, \\partial_y v_y \\right).\n$$\n\n我们考虑PML中的一个形式为 $p^{\\text{tr}}(x,y) = T \\exp\\!\\big(i k_x^{\\text{tr}} x + i k_y y\\big)$ 的透射平面波，其中切向分量 $k_y$ 因沿 $y$ 方向的平移不变性而守恒。将PML动量关系应用于此拟设可得\n\n$$\nv_x^{\\text{tr}} = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, p^{\\text{tr}}, \\qquad v_y^{\\text{tr}} = - \\frac{k_y}{\\omega \\rho_0 s_y}\\, p^{\\text{tr}}.\n$$\n\n代入PML连续性方程，并使用 $\\partial_x p^{\\text{tr}} = i k_x^{\\text{tr}} p^{\\text{tr}}$ 和 $\\partial_y p^{\\text{tr}} = i k_y p^{\\text{tr}}$，我们得到PML的色散关系\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + \\frac{k_y^2}{s_y^2} = \\frac{\\omega^2 \\rho_0}{K} = k^2.\n$$\n\n在界面 $x=0$ 处，物理介质占据 $x0$ 的区域，其中 $s_x = s_y = 1$；PML占据 $x \\ge 0$ 的区域，其局部常数为 $s_x(0^+)$ 和 $s_y(0^+)$。在 $x0$ 区域中的入射场和反射场为\n\n$$\np^{\\text{inc}} = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big), \\qquad p^{\\text{ref}} = R\\, p_0 \\exp\\!\\big(i (-k_x) x + i k_y y\\big),\n$$\n\n因此在 $x=0$ 处，$p^{\\text{left}}(0,y) = p_0(1+R) \\exp(i k_y y)$。相应的法向质点速度，使用物理动量关系 $\\mathbf{v} = - \\frac{\\mathbf{k}}{\\omega \\rho_0} p$，为\n\n$$\nv_x^{\\text{inc}} = - \\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{inc}}, \\qquad v_x^{\\text{ref}} = - \\frac{(-k_x)}{\\omega \\rho_0}\\, p^{\\text{ref}} = \\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{ref}}.\n$$\n\n因此，在 $x=0$ 处，$x0$ 区域中的总法向速度为\n\n$$\nv_x^{\\text{left}}(0,y) = \\left( - \\frac{k_x}{\\omega \\rho_0}\\, p_0 + \\frac{k_x}{\\omega \\rho_0}\\, R p_0 \\right) \\exp(i k_y y) = - \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R)\\, \\exp(i k_y y).\n$$\n\n\n在PML一侧，$x=0$ 处的透射压力为 $p^{\\text{tr}}(0,y) = T \\exp(i k_y y)$，相应的法向速度为\n\n$$\nv_x^{\\text{tr}}(0,y) = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T \\exp(i k_y y),\n$$\n\n其中 $s_x = s_x(0^+)$ 且 $s_y = s_y(0^+)$。在 $x=0$ 处的边界条件是压力和法向速度的连续性：\n\n$$\np^{\\text{left}}(0,y) = p^{\\text{tr}}(0,y), \\qquad v_x^{\\text{left}}(0,y) = v_x^{\\text{tr}}(0,y).\n$$\n\n这得到\n\n$$\np_0 (1 + R) = T, \\qquad - \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R) = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T.\n$$\n\n消去 $T$ 并化简可得到一个关于 $R$ 的关系式：\n\n$$\nk_x (1 - R) = \\frac{k_x^{\\text{tr}}}{s_x} (1 + R).\n$$\n\n解出 $R$：\n\n$$\nR = \\frac{k_x - \\frac{k_x^{\\text{tr}}}{s_x}}{k_x + \\frac{k_x^{\\text{tr}}}{s_x}}.\n$$\n\n为了封闭此式，我们必须根据入口值 $s_x(0^+)$ 和 $s_y(0^+)$ 从PML色散关系中确定 $k_x^{\\text{tr}}$。PML色散关系要求\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + \\frac{k_y^2}{s_y^2} = k^2.\n$$\n\n在物理介质中，$k_x^2 + k_y^2 = k^2$。因此，如果在入口界面处 $s_y(0^+) = 1$（无切向拉伸），我们有\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + k_y^2 = k^2 \\quad \\Longrightarrow \\quad \\frac{k_x^{\\text{tr}\\,2}}{s_x^2} = k^2 - k_y^2 = k_x^2 \\quad \\Longrightarrow \\quad \\frac{k_x^{\\text{tr}}}{s_x} = \\pm k_x.\n$$\n\n物理上正确的选择是取透射波在 $x \\ge 0$ 中向前衰减，这与 $s_x = 1 + \\sigma_x/(i \\omega)$（其中 $\\Re(s_x) = 1$ 且 $\\Im(s_x) \\le 0$）相符，从而得到 $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$。将 $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$ 代入 $R$ 的表达式中可得\n\n$$\nR = \\frac{k_x - k_x}{k_x + k_x} = 0.\n$$\n\n因此，在给定的入口条件 $s_y(0^+) = 1$ 并且分裂场PML拉伸应用于法向方向的情况下，对于所有 $\\omega$ 和所有斜入射角 $\\theta \\in (0,\\pi/2)$，反射系数都为零：\n\n$$\nR = 0.\n$$\n\n\n最后，考虑PML内部任意可接受的连续剖面 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的分段常数近似。$x=0$ 处的反射仅取决于入口值 $s_x(0^+)$ 和 $s_y(0^+)$。只要入口设计保持 $s_y(0^+) = 1$ 且 $s_x(0^+) = 1 + \\sigma_x(0^+)/(i \\omega)$，上述匹配条件 $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$ 就精确成立，因此 $R=0$ 与内部的分段结构无关。在分段常数剖面收敛到连续的 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的连续极限下，入口值保持不变，因此在连续极限下，$x=0$ 处的反射系数恒为零。因此，最终计算出的反射系数是\n\n$$\nR = 0.\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理论上的“完美”匹配在数值实现中会面临新的挑战。这项练习将探讨一个常见的实践陷阱：在物理域与PML的交界处，由于有限差分格式的不一致，会产生人为的阻抗失配，从而导致伪反射。通过分析这一现象，你将更深刻地体会到在实现数值边界条件时所需要的严谨性，并理解即使是微小的实现细节也可能影响整个计算的精度。",
            "id": "4133660",
            "problem": "考虑由以下一阶系统控制的一维线性声学\n$$\\partial_{t} p + \\rho c^{2} \\,\\partial_{x} u = 0,\\qquad \\partial_{t} u + \\frac{1}{\\rho}\\,\\partial_{x} p = 0,$$\n其中 $p$ 是声压，$u$ 是质点速度，$\\rho$ 是质量密度，$c$ 是声速。为了截断无界域，在 $x0$ 处附加了一个完美匹配层（PML）区域。假设在间距为 $\\Delta x$ 的均匀网格上进行半离散空间近似（时间连续，空间离散）。\n\n在 $x0$ 的物理域中，$p$ 和 $u$ 都使用一阶导数的四阶中心有限差分近似，\n$$D^{(4)} f_{i} = \\frac{-f_{i+2} + 8 f_{i+1} - 8 f_{i-1} + f_{i-2}}{12\\,\\Delta x},$$\n而在 $x0$ 的PML中，由于界面处的模板不一致，压力方程使用二阶中心导数\n$$D^{(2)} f_{i} = \\frac{f_{i+1} - f_{i-1}}{2\\,\\Delta x},$$\n而速度方程保留 $D^{(4)}$。PML通过频域中的标准复坐标伸展实现，即将空间导数乘以一个复数因子 $s_{x} = 1 + i\\,\\sigma/\\omega$，该因子在PML内部的压力和速度方程中被相同地应用，其中 $\\sigma$ 是一个非负阻尼剖面，$\\omega$ 是角频率。假设角频率为 $\\omega$ 的时谐平面波从物理域垂直入射到 $x=0$ 处的界面上。\n\n令作用于 $e^{i \\xi i}$ 的 $D^{(2)}$ 的离散傅里叶符号为 $i K_{2}(\\xi)$，而 $D^{(4)}$ 的离散傅里叶符号为 $i K_{4}(\\xi)$，其中\n$$K_{2}(\\xi) = \\frac{\\sin \\xi}{\\Delta x},\\qquad K_{4}(\\xi) = \\frac{16 \\sin \\xi - 2 \\sin(2\\xi)}{12\\,\\Delta x},$$\n其中 $\\xi = k\\,\\Delta x$，$k$ 是长波极限下入射平面波的物理波数。通过假设 $\\xi \\ll 1$ 将模板失配视为微小量，并计算到 $\\xi$ 的主阶项。\n\n从控制方程出发，并在 $x=0$ 处施加 $p$ 和 $u$ 的连续性条件，推导由上述模板不一致性引起的、仅由离散化导致的界面阻抗跳跃所产生的复反射系数 $r$（反射压力振幅与入射压力振幅之比）的主阶解析表达式。将最终答案表示为关于 $k$ 和 $\\Delta x$ 的单个封闭形式表达式，不带单位，且不要四舍五入。你的结果应该是 $\\xi$ 的主阶项。",
            "solution": "为了推导由离散化模板失配引起的反射系数，我们在频域中进行分析。假设所有场量都具有时谐依赖性 $e^{-i\\omega t}$，控制方程组变为：\n$$\n-i\\omega p + \\rho c^{2} \\,\\partial_{x} u = 0\n$$\n$$\n-i\\omega u + \\frac{1}{\\rho}\\,\\partial_{x} p = 0\n$$\n我们分别分析物理域和PML域的数值特性。\n\n**1. 物理域 ($x0$) 的数值阻抗**\n\n在物理域中，空间导数 $\\partial_x$ 由四阶中心差分算子 $D^{(4)}$ 近似。对于一个形式为 $e^{i k_{num} x}$ 的平面波（在离散网格上为 $e^{i \\xi_{num} j}$，其中 $\\xi_{num} = k_{num} \\Delta x$），$D^{(4)}$ 的作用是乘以其傅里叶符号 $iK_4(\\xi_{num})$。因此，半离散方程为：\n$$\n-i\\omega p + \\rho c^{2} (iK_4) u = 0\n$$\n$$\n-i\\omega u + \\frac{1}{\\rho} (iK_4) p = 0\n$$\n联立两式可得数值色散关系 $\\omega^2 = c^2 K_4^2(\\xi_{num})$。对于一个向右传播的波（入射波），我们取正根 $\\omega = c K_4(\\xi_{num})$。\n该区域的数值特征阻抗 $Z_4 = p/u$ 可以从第二个方程得到：\n$$\nZ_4 = \\frac{p}{u} = \\frac{\\omega \\rho}{K_4(\\xi_{num})} = \\frac{c K_4(\\xi_{num}) \\rho}{K_4(\\xi_{num})} = \\rho c\n$$\n这表明，在物理域内部，四阶一致格式的数值阻抗与连续介质的阻抗相同。物理域中的总场是入射波 ($p_I$) 和反射波 ($p_R$) 的叠加。\n\n**2. PML域 ($x0$) 在界面处的数值阻抗**\n\n在PML域的入口 $x=0$ 处，阻尼 $\\sigma(0)=0$，因此伸展因子 $s_x=1$。然而，导数算子是不匹配的：压力方程使用 $D^{(2)}$，而速度方程使用 $D^{(4)}$。对于一个形式为 $e^{i k_{mix} x}$ 的透射波，半离散方程变为：\n$$\n-i\\omega p + \\rho c^{2} (iK_2) u = 0\n$$\n$$\n-i\\omega u + \\frac{1}{\\rho} (iK_4) p = 0\n$$\n其中 $K_2$ 和 $K_4$ 是对应算子的傅里叶符号，参数为 $\\xi_{mix} = k_{mix}\\Delta x$。\n该混合格式的数值色散关系为 $\\omega^2 = c^2 K_2(\\xi_{mix}) K_4(\\xi_{mix})$。\n此区域的数值阻抗 $Z_{mix} = p/u$ 为：\n$$\nZ_{mix} = \\frac{\\omega \\rho}{K_4(\\xi_{mix})} = \\frac{c \\sqrt{K_2(\\xi_{mix}) K_4(\\xi_{mix})} \\rho}{K_4(\\xi_{mix})} = \\rho c \\sqrt{\\frac{K_2(\\xi_{mix})}{K_4(\\xi_{mix})}}\n$$\n这表明，由于模板失配，数值阻抗不再是 $\\rho c$。\n\n**3. 反射系数的主阶分析**\n\n在界面 $x=0$ 处，压力和速度是连续的。这导致反射系数 $r = p_R/p_I$ 的标准表达式为：\n$$\nr = \\frac{Z_{mix} - Z_4}{Z_{mix} + Z_4} = \\frac{Z_{mix} - \\rho c}{Z_{mix} + \\rho c}\n$$\n为了计算主阶项，我们在长波极限下（$\\xi = k\\Delta x \\ll 1$）展开 $Z_{mix}$。首先计算符号比：\n$$\n\\frac{K_2(\\xi_{mix})}{K_4(\\xi_{mix})} = \\frac{\\frac{\\sin \\xi_{mix}}{\\Delta x}}{\\frac{16 \\sin \\xi_{mix} - 2 \\sin(2\\xi_{mix})}{12\\,\\Delta x}} = \\frac{12 \\sin \\xi_{mix}}{16 \\sin \\xi_{mix} - 4 \\sin \\xi_{mix} \\cos \\xi_{mix}} = \\frac{3}{4 - \\cos \\xi_{mix}}\n$$\n对 $\\cos \\xi_{mix} \\approx 1 - \\frac{\\xi_{mix}^2}{2}$ 进行泰勒展开，我们得到：\n$$\n\\frac{K_2(\\xi_{mix})}{K_4(\\xi_{mix})} \\approx \\frac{3}{4 - (1 - \\frac{\\xi_{mix}^2}{2})} = \\frac{3}{3 + \\frac{\\xi_{mix}^2}{2}} = \\frac{1}{1 + \\frac{\\xi_{mix}^2}{6}} \\approx 1 - \\frac{\\xi_{mix}^2}{6}\n$$\n因此，数值阻抗为：\n$$\nZ_{mix} \\approx \\rho c \\sqrt{1 - \\frac{\\xi_{mix}^2}{6}} \\approx \\rho c \\left(1 - \\frac{\\xi_{mix}^2}{12}\\right)\n$$\n在长波极限下，数值波数与物理波数近似相等，即 $\\xi_{mix} \\approx \\xi = k\\Delta x$。代入上式：\n$$\nZ_{mix} \\approx \\rho c \\left(1 - \\frac{(k \\Delta x)^2}{12}\\right)\n$$\n最后，计算反射系数 $r$ 的主阶项：\n$$\nr \\approx \\frac{\\rho c \\left(1 - \\frac{(k \\Delta x)^2}{12}\\right) - \\rho c}{\\rho c \\left(1 - \\frac{(k \\Delta x)^2}{12}\\right) + \\rho c} = \\frac{-\\rho c \\frac{(k \\Delta x)^2}{12}}{2\\rho c - \\rho c \\frac{(k \\Delta x)^2}{12}} \\approx \\frac{-\\rho c \\frac{(k \\Delta x)^2}{12}}{2\\rho c} = -\\frac{(k \\Delta x)^2}{24}\n$$\n这个非零反射是纯粹由界面两侧离散化方案不一致造成的数值伪影。",
            "answer": "$$\\boxed{-\\frac{(k \\Delta x)^{2}}{24}}$$"
        },
        {
            "introduction": "为了克服标准PML在吸收低频波和倏逝波方面的局限性，研究人员发展了复频移PML（CFS-PML）技术。这项练习将带你进入现代PML设计的实践领域，要求你为特定的宽带脉冲信号优化CFS-PML的参数，以在整个频带上最小化反射。这个过程模拟了计算声学中一个真实的工程设计挑战，需要你结合理论公式与数值优化方法来寻找最佳解决方案。",
            "id": "4133786",
            "problem": "考虑一维声波在均匀介质中的传播，其由声速为 $c$ 的均匀介质中压强 $p(x,t)$ 的线性声波方程描述：\n$$\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}.$$\n对于角频率为 $\\omega$ 的时谐分析，并约定 $p(x,t) = \\Re\\{P(x) e^{i \\omega t}\\}$，场 $P(x)$ 满足亥姆霍兹方程\n$$\\frac{d^2 P}{dx^2} + k_0^2 P = 0,\\quad k_0 = \\frac{\\omega}{c}.$$\n为了在模拟无界介质的同时截断计算域，引入一个厚度为 $L$ 的复频移完全匹配层 (Complex-Frequency-Shifted Perfectly Matched Layer, CFS-PML)，该层占据 $x \\in [0,L]$ 并实现复坐标拉伸：\n$$\\tilde{x}(x,\\omega) = \\int_0^x s_x(\\xi,\\omega)\\,d\\xi,$$\n其拉伸函数为\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha},$$\n其中 $\\kappa_x(x)$ 是一个无量纲缩放（实数且为正），$\\sigma_x(x)$ 是一个单位为秒的倒数的阻尼剖面，$\\alpha$ 是复频移 (CFS) 参数，单位为弧度每秒。假设一个多项式阻尼剖面 $\\sigma_x(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m$，其中整数 $m \\ge 1$，并取 $\\kappa_x(x) \\equiv 1$。一个在 $x=0$ 处进入 PML 的右行平面波会累积复相位 $i k_0 \\int_0^x s_x(\\xi,\\omega)\\,d\\xi$；其幅度根据拉伸函数的虚部衰减。如果 PML 在 $x=L$ 处以一个全反射边界终止，则由于该终止而在物理域中感受到的净反射振幅可以很好地近似为\n$$R(\\omega) \\approx \\exp\\!\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right).$$\n对于上述 CFS-PML 拉伸函数，用 $\\sigma_x(x)$ 和 $\\alpha$ 显式写出 $\\operatorname{Im}\\{s_x(x,\\omega)\\}$，然后对于多项式剖面计算路径积分 $\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx$。利用此结果，推导出 $R(\\omega)$ 关于 $\\omega$、$c$、$L$、$m$、$\\sigma_{\\max}$ 和 $\\alpha$ 的闭式表达式。\n\n设宽带脉冲在角频率带 $[\\omega_{\\min},\\omega_{\\max}]$ 上具有谱权重 $W(\\omega)$。使用高斯权重\n$$W(\\omega) = \\exp\\!\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right),$$\n其中 $\\omega_0$ 是中心角频率，$\\sigma_\\omega$ 是角频率展宽。定义归一化积分反射度量\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}.$$\n你的任务是：\n- 从控制方程和 CFS-PML 的定义出发，针对给定的 $\\sigma_x(x)$ 和 $\\kappa_x(x)$，推导出 $\\operatorname{Im}\\{s_x(x,\\omega)\\}$ 和 $R(\\omega)$ 的表达式。\n- 使用 $R(\\omega)$ 的表达式，实现一个程序，该程序对下文定义的每个测试用例，搜索一个有限的 $(\\sigma_{\\max},\\alpha)$ 对的候选集，并返回使 $J(\\sigma_{\\max},\\alpha)$ 最小化的对，以及 $J$ 的最小值。\n\n假设和单位：\n- 声速 $c$ 的单位是米/秒。\n- PML 厚度 $L$ 的单位是米。\n- 阻尼振幅 $\\sigma_{\\max}$ 的单位是秒的倒数。\n- 复频移参数 $\\alpha$ 的单位是弧度/秒。\n- 频率以赫兹 (Hz) 为单位；通过 $\\omega = 2\\pi f$ 将其转换为角频率，单位为弧度/秒。\n- 所有输出均表示为无单位的纯数字；内部计算必须遵循所述单位。\n\n测试套件：\n- 案例1（正常路径，水，中等厚度PML，宽带）：$c = 1500$ m/s, $L=0.02$ m, $m=3$, $f_{\\min}=1000$ Hz, $f_{\\max}=50000$ Hz, $f_0=20000$ Hz, $\\Delta f = 15000$ Hz，因此 $\\sigma_\\omega = 2\\pi \\Delta f$。候选集：$\\sigma_{\\max} \\in \\{2{\\times}10^5, 5{\\times}10^5, 1{\\times}10^6\\}$ s$^{-1}$，$\\alpha \\in \\{2\\pi\\cdot 500, 2\\pi\\cdot 2000, 2\\pi\\cdot 5000\\}$ rad/s。\n- 案例2（空气中低频主导的脉冲，较厚PML，包括无频移边界情况）：$c = 343$ m/s, $L=0.05$ m, $m=3$, $f_{\\min}=100$ Hz, $f_{\\max}=5000$ Hz, $f_0=1000$ Hz, $\\Delta f = 800$ Hz，$\\sigma_{\\max} \\in \\{2{\\times}10^4, 5{\\times}10^4, 1{\\times}10^5\\}$ s$^{-1}$，$\\alpha \\in \\{0, 2\\pi\\cdot 100, 2\\pi\\cdot 500\\}$ rad/s。\n- 案例3（水中薄PML，高频带）：$c = 1500$ m/s, $L=0.005$ m, $m=3$, $f_{\\min}=10000$ Hz, $f_{\\max}=200000$ Hz, $f_0=60000$ Hz, $\\Delta f = 30000$ Hz，$\\sigma_{\\max} \\in \\{1{\\times}10^5, 2{\\times}10^5, 3{\\times}10^5\\}$ s$^{-1}$，$\\alpha \\in \\{2\\pi\\cdot 2000, 2\\pi\\cdot 10000\\}$ rad/s。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含三个案例的结果，格式为逗号分隔的列表的列表。每个内部列表必须是 $[\\sigma_{\\max},\\kappa,\\alpha,J]$ 的形式，其中 $\\kappa$ 固定为 $1$，$J$ 是该案例的最小归一化积分反射。例如，输出应如下所示：\n$[[\\sigma_{\\max}^{(1)},1,\\alpha^{(1)},J^{(1)}],[\\sigma_{\\max}^{(2)},1,\\alpha^{(2)},J^{(2)}],[\\sigma_{\\max}^{(3)},1,\\alpha^{(3)},J^{(3)}]]$。",
            "solution": "该问题被评估为有效。它在科学上基于计算声学的原理，特别是完全匹配层的理论。该问题是适定的，为推导解决方案和执行指定的数值优化提供了所有必要的参数和定义。语言是客观的，要求是明确的。\n\n解决过程包括两个主要阶段：首先，解析推导给定复频移完全匹配层 (CFS-PML) 的反射系数 $R(\\omega)$；其次，通过数值实现一个搜索算法，以找到使加权的积分反射度量 $J$ 最小化的最优PML参数 $(\\sigma_{\\max}, \\alpha)$。\n\n第一步是确定复拉伸函数 $s_x(x,\\omega)$ 的虚部。拉伸函数定义为：\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\n给定 $\\kappa_x(x) \\equiv 1$，我们有：\n$$s_x(x,\\omega) = 1 + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\n为了求虚部，我们将复数分数的分子和分母同乘以分母的复共轭 $(\\omega - i\\alpha)$，以进行有理化：\n$$\\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha} = \\frac{i\\,\\sigma_x(x)}{(\\omega + i \\alpha)} \\frac{(\\omega - i \\alpha)}{(\\omega - i \\alpha)} = \\frac{i\\omega\\sigma_x(x) - i^2\\alpha\\sigma_x(x)}{\\omega^2 - (i\\alpha)^2} = \\frac{\\alpha\\sigma_x(x) + i\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\n因此，拉伸函数可以写成实部和虚部分离的形式：\n$$s_x(x,\\omega) = \\left(1 + \\frac{\\alpha\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right) + i\\left(\\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right)$$\n负责波衰减的虚部是：\n$$\\operatorname{Im}\\{s_x(x,\\omega)\\} = \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\n下一步是计算该量在 PML 厚度 $L$ 上的积分，这决定了总的单向衰减：\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\int_0^L \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2} \\, dx$$\n项 $\\frac{\\omega}{\\omega^2 + \\alpha^2}$ 与 $x$ 无关，可以从积分中提出。给定多项式阻尼剖面 $\\sigma_x(x) = \\sigma_{\\max} (x/L)^m$。\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\omega}{\\omega^2 + \\alpha^2} \\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx$$\n计算空间剖面的积分：\n$$\\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\int_0^L x^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max}}{L^m} \\frac{L^{m+1}}{m+1} = \\frac{\\sigma_{\\max}L}{m+1}$$\n将此结果代回，我们得到总衰减积分的解析表达式：\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}$$\n由 PML 终端引起的反射振幅 $R(\\omega)$ 由往返衰减因子给出：\n$$R(\\omega) \\approx \\exp\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right)$$\n使用 $k_0 = \\omega/c$ 和积分表达式，我们得到：\n$$R(\\omega) = \\exp\\left(-2 \\frac{\\omega}{c} \\left[\\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}\\right]\\right) = \\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\n这是所要求的 $R(\\omega)$ 的闭式表达式。由于指数的参数是实数，所以 $R(\\omega)$ 是一个实值函数。\n\n第二阶段是实现优化。我们需要从一个有限的候选集中找到使归一化积分反射度量 $J$ 最小化的对 $(\\sigma_{\\max}, \\alpha)$：\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}$$\n权重函数是高斯函数 $W(\\omega) = \\exp\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right)$。由于 $R(\\omega)$ 是实数，所以 $|R(\\omega)|^2 = R(\\omega)^2$。分子中的被积函数是 $W(\\omega) R(\\omega)^2$。\n$$R(\\omega)^2 = \\left[\\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)\\right]^2 = \\exp\\left(-\\frac{4\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\n对于每个测试用例，数值过程如下：\n1.  定义固定参数 $c, L, m$ 和频率参数 $f_{\\min}, f_{\\max}, f_0, \\Delta f$。通过 $\\omega = 2\\pi f$ 将频率转换为角频率 (rad/s)。同时定义 $\\sigma_{\\max}$ 和 $\\alpha$ 的候选集。注意 $\\sigma_\\omega = 2\\pi \\Delta f$。\n2.  计算分母积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) \\, d\\omega$。对于给定的测试用例，该值是常数，不依赖于 PML 参数，因此只需计算一次。\n3.  对所有候选对 $(\\sigma_{\\max}, \\alpha)$ 进行网格搜索。对于每一对：\n    a. 计算分子积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) R(\\omega)^2 \\, d\\omega$。被积函数依赖于 $\\sigma_{\\max}$ 和 $\\alpha$ 的具体选择。\n    b. 使用稳健的求积方法（如 `scipy.integrate.quad`）进行数值积分。\n    c. 通过将分子积分除以分母积分来计算 $J$ 的值。\n4.  识别产生最小 $J$ 值的对 $(\\sigma_{\\max}, \\alpha)$，并记录此最小 $J$ 值。\n5.  收集所有测试用例的最优参数和最小 $J$ 值，并将其格式化为所需的输出字符串。根据指定，在输出中包含固定值 $\\kappa=1$。\n此过程系统地评估了每种 PML 设计的性能，并根据指定的度量标准选择了最佳设计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the CFS-PML optimization problem for a set of test cases.\n    It derives the reflection coefficient, defines a performance metric, and\n    searches a parameter space to find the optimal PML design.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"c\": 1500, \"L\": 0.02, \"m\": 3,\n            \"f_min\": 1000, \"f_max\": 50000, \"f_0\": 20000, \"delta_f\": 15000,\n            \"sigma_max_candidates\": [2e5, 5e5, 1e6],\n            \"alpha_candidates\": [2 * np.pi * 500, 2 * np.pi * 2000, 2 * np.pi * 5000]\n        },\n        # Case 2\n        {\n            \"c\": 343, \"L\": 0.05, \"m\": 3,\n            \"f_min\": 100, \"f_max\": 5000, \"f_0\": 1000, \"delta_f\": 800,\n            \"sigma_max_candidates\": [2e4, 5e4, 1e5],\n            \"alpha_candidates\": [0, 2 * np.pi * 100, 2 * np.pi * 500]\n        },\n        # Case 3\n        {\n            \"c\": 1500, \"L\": 0.005, \"m\": 3,\n            \"f_min\": 10000, \"f_max\": 200000, \"f_0\": 60000, \"delta_f\": 30000,\n            \"sigma_max_candidates\": [1e5, 2e5, 3e5],\n            \"alpha_candidates\": [2 * np.pi * 2000, 2 * np.pi * 10000]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        c = case[\"c\"]\n        L = case[\"L\"]\n        m = case[\"m\"]\n        sigma_max_candidates = case[\"sigma_max_candidates\"]\n        alpha_candidates = case[\"alpha_candidates\"]\n\n        # Convert frequencies from Hz to rad/s\n        omega_min = 2 * np.pi * case[\"f_min\"]\n        omega_max = 2 * np.pi * case[\"f_max\"]\n        omega_0 = 2 * np.pi * case[\"f_0\"]\n        sigma_omega = 2 * np.pi * case[\"delta_f\"]\n\n        # Define the Gaussian spectral weight W(omega)\n        def W(omega):\n            return np.exp(-(omega - omega_0)**2 / (2 * sigma_omega**2))\n\n        # Denominator integral is constant for the case\n        denominator_integral, _ = integrate.quad(W, omega_min, omega_max)\n\n        min_J = float('inf')\n        best_sigma_max = None\n        best_alpha = None\n\n        # Perform the grid search over the candidate parameters\n        for sigma_max in sigma_max_candidates:\n            for alpha in alpha_candidates:\n                # Pre-calculate the constant part of the exponent in R(omega)^2\n                pml_const = (4 * sigma_max * L) / (c * (m + 1))\n\n                # Define the integrand for the numerator\n                def numerator_integrand(omega):\n                    # Handle omega=0 and alpha=0 case to avoid 0/0\n                    if omega == 0 and alpha == 0:\n                        reflection_exponent_term = 1.0\n                    else:\n                        reflection_exponent_term = (omega**2) / (omega**2 + alpha**2)\n                    \n                    R_squared = np.exp(-pml_const * reflection_exponent_term)\n                    return W(omega) * R_squared\n                \n                # Calculate the numerator integral\n                numerator_integral, _ = integrate.quad(\n                    numerator_integrand, omega_min, omega_max, limit=100\n                )\n\n                # Calculate J\n                if denominator_integral > 0:\n                    current_J = numerator_integral / denominator_integral\n                else: \n                    # This case should not happen with the given parameters\n                    current_J = float('inf')\n\n                # Update if a new minimum is found\n                if current_J  min_J:\n                    min_J = current_J\n                    best_sigma_max = sigma_max\n                    best_alpha = alpha\n        \n        # kappa is fixed to 1\n        kappa = 1\n        results.append([best_sigma_max, kappa, best_alpha, min_J])\n\n    # Final print statement in the exact required format.\n    # Convert results to a string without extra spaces for compactness.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}