{
    "hands_on_practices": [
        {
            "introduction": "总场-散射场（TF/SF）方法的有效性取决于在交界面上精确构建等效源。第一个实践练习提供了一个基础性的训练，旨在为一个标准的二阶有限差分格式推导这些源项。通过进行这项计算  并分析其形式精度阶数，您将对入射场的注入方式以及如何量化这种注入的数值精度有一个具体的理解。",
            "id": "4148530",
            "problem": "考虑在声速 $c$ 为常数的均匀介质中的二维时谐声学问题。在角频率为 $\\omega$ 时，复声压 $u(x,y)$ 在自由空间中满足亥姆霍兹方程 $-\\Delta u - k^{2} u = 0$，其中 $k = \\omega/c$ 是波数，$\\Delta$ 是拉普拉斯算子。使用总场-散射场 (Total-Field/Scattered-Field, TF/SF) 公式将一个已知的入射场 $u^{\\text{inc}}(x,y)$ 注入到一个矩形的总场区域，同时允许出射的散射波无反射地通过。\n\n设 TF/SF 边界与间距为 $h$ 的笛卡尔网格对齐，网格点为 $(x_{i},y_{j}) = (x_{0} + i h, y_{0} + j h)$，并设 TF/SF 矩形为内部索引的集合 $\\{(i,j): 1 \\le i \\le N_{x}-1, 1 \\le j \\le N_{y}-1\\}$，使其四个面位于索引线 $i = 0$、$i = N_{x}$、$j = 0$ 和 $j = N_{y}$ 上。考虑作用于网格函数 $v_{i,j}$ 的标准二阶中心差分离散亥姆霍兹算子 $L_{h}$：\n$$\n(L_{h} v)_{i,j} = \\frac{v_{i+1,j} - 2 v_{i,j} + v_{i-1,j}}{h^{2}} + \\frac{v_{i,j+1} - 2 v_{i,j} + v_{i,j-1}}{h^{2}} + k^{2} v_{i,j},\n$$\n该算子定义在模板点完全位于 TF/SF 矩形内的内部索引 $(i,j)$ 上。为了通过 TF/SF 方法注入入射场，我们引入离散等效源 $s_{i,j}$，其仅支撑在紧邻每个 TF/SF 面的单层网格厚的内部节点上。配置法构造要求，对于每个其模板点引用了 TF/SF 矩形外一个邻近点的内部节点，缺失的邻近点贡献必须由一个源项 $s_{i,j}$ 精确替代，该源项由已知入射场在虚拟邻近点上的采样值计算得出。\n\n假设入射场为光滑平面波 $u^{\\text{inc}}(x,y) = \\exp(i k_{x} x + i k_{y} y)$，且满足 $k_{x}^{2} + k_{y}^{2} = k^{2}$。使用上述配置法，推导在紧邻 TF/SF 面的四个内部层上的等效源强度 $s_{i,j}$ 的显式公式，用在 TF/SF 矩形外一步的适当虚拟点上采样的 $u^{\\text{inc}}$ 来表示。然后，在假设使用这些源的离散亥姆霍兹问题 $L_{h}$ 是稳定的且 $k h$ 足够小的前提下，严格分析 TF/SF 矩形内部对 $u^{\\text{inc}}$ 的内部重构 $u_{h}$ 的形式精度阶数 $m$。你的分析应从基本定律和核心定义出发，包括连续亥姆霍兹方程和 $L_{h}$ 的定义，并且不应引用任何未从这些基础推导出的简化公式。将最终阶数 $m$ 表示为单个整数。最终答案中不包含不等式。最终答案应只包含 $m$ 的值，不带单位，也无附加文本。",
            "solution": "该问题要求关于二维亥姆霍兹方程的总场/散射场 (TF/SF) 公式的两个结果。首先，我们必须推导用于注入入射平面波的离散等效源 $s_{i,j}$ 的显式公式。其次，我们必须确定在总场区域内对入射场进行纯源重构的形式精度阶数 $m$。\n\n该问题是适定的，并且其科学基础在于计算声学和偏微分方程数值分析的原理。所有必要信息均已提供，并且其设置与 TF/SF 方法的标准（尽管是简化的）实现方式一致。因此，我们可以进行完整的求解。\n\n连续亥姆霍兹方程由下式给出\n$$\n\\Delta u + k^{2} u = 0,\n$$\n其中 $k = \\omega/c$ 是波数。入射场为平面波 $u^{\\text{inc}}(x,y) = \\exp(i k_{x} x + i k_{y} y)$，当 $k_{x}^{2} + k_{y}^{2} = k^{2}$ 时，它是该方程的精确解。\n\n离散算子 $L_{h}$ 是亥姆霍兹算子 $\\Delta + k^{2}$ 的标准二阶中心差分近似：\n$$\n(L_{h} v)_{i,j} = \\frac{v_{i+1,j} - 2 v_{i,j} + v_{i-1,j}}{h^{2}} + \\frac{v_{i,j+1} - 2 v_{i,j} + v_{i,j-1}}{h^{2}} + k^{2} v_{i,j}.\n$$\n总场 $u_{i,j}$ 的计算域由网格索引 $\\{(i,j): 1 \\le i \\le N_{x}-1, 1 \\le j \\le N_{y}-1\\}$ 组成。\n\n第一部分：源项 $s_{i,j}$ 的推导\n\n源项 $s_{i,j}$ 仅在紧邻 TF/SF 边界的单层网格厚的内部节点上非零。“配置法构造”规定，对于任何其五点模板延伸到计算域外的“虚拟”邻近点的节点，该虚拟节点上的值将被替换为在该位置采样的已知入射场 $u^{\\text{inc}}$ 的值。这一修改随后被视为一个源项。\n\n让我们为域内部、但位于边界邻近层上的一个节点 $(i,j)$ 写出离散方程。考虑一个节点 $(1,j)$，其中 $1 < j < N_y - 1$。如果离散亥姆霍兹方程要被完美满足，则有 $(L_h u)_{1,j} = 0$。展开此式得到：\n$$\n\\frac{u_{2,j} - 2 u_{1,j} + u_{0,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = 0.\n$$\n在此方程中，$u_{1,j}$、$u_{2,j}$、$u_{1,j+1}$ 和 $u_{1,j-1}$ 是域内未知的总场值。节点 $(0,j)$ 是一个虚拟节点。根据问题的规定，我们将 $u_{0,j}$ 替换为 $u^{\\text{inc}}_{0,j} = u^{\\text{inc}}(x_0, y_j)$。\n方程变为：\n$$\n\\frac{u_{2,j} - 2 u_{1,j} + u^{\\text{inc}}_{0,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = 0.\n$$\n为了将其表示为 TF 区域内未知数 $u_{i,j}$ 的线性系统，我们将包含已知入射场的项移到右侧。\n$$\n\\frac{u_{2,j} - 2 u_{1,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = -\\frac{u^{\\text{inc}}_{0,j}}{h^{2}}.\n$$\n右侧即为源项 $s_{1,j}$。我们可以系统地推导所有四个边界邻近层和角落的源。令 $u^{\\text{inc}}_{i,j} = u^{\\text{inc}}(x_{i}, y_j)$。\n\n1.  左边界层 ($i=1, 1 < j < N_y - 1$)：模板涉及虚拟节点 $(0,j)$。\n    $$s_{1,j} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{0,j}$$\n2.  右边界层 ($i=N_x - 1, 1 < j < N_y - 1$)：模板涉及虚拟节点 $(N_x,j)$。\n    $$s_{N_x-1,j} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{N_x, j}$$\n3.  底边界层 ($j=1, 1 < i < N_x - 1$)：模板涉及虚拟节点 $(i,0)$。\n    $$s_{i,1} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{i,0}$$\n4.  顶边界层 ($j=N_y - 1, 1 < i < N_x - 1$)：模板涉及虚拟节点 $(i,N_y)$。\n    $$s_{i,N_y-1} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{i,N_y}$$\n角点涉及两个虚拟邻近点。\n5.  左下角点 ($i=1, j=1$)：模板涉及虚拟节点 $(0,1)$ 和 $(1,0)$。\n    $$s_{1,1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{0,1} + u^{\\text{inc}}_{1,0} \\right)$$\n6.  右下角点 ($i=N_x-1, j=1$)：模板涉及虚拟节点 $(N_x,1)$ 和 $(N_x-1,0)$。\n    $$s_{N_x-1,1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{N_x,1} + u^{\\text{inc}}_{N_x-1,0} \\right)$$\n7.  左上角点 ($i=1, j=N_y-1$)：模板涉及虚拟节点 $(0,N_y-1)$ 和 $(1,N_y)$。\n    $$s_{1,N_y-1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{0,N_y-1} + u^{\\text{inc}}_{1,N_y} \\right)$$\n8.  右上角点 ($i=N_x-1, j=N_y-1$)：模板涉及虚拟节点 $(N_x,N_y-1)$ 和 $(N_x-1,N_y)$。\n    $$s_{N_x-1,N_y-1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{N_x,N_y-1} + u^{\\text{inc}}_{N_x-1,N_y} \\right)$$\n对于所有其他内部节点 $\\{(i,j): 1 < i < N_x-1, 1 < j < N_y-1\\}$，源项为零：$s_{i,j}=0$。\n\n第二部分：形式精度阶数的分析\n\n形式精度阶数由局部截断误差 (Local Truncation Error, LTE) $\\tau_{i,j}$ 的阶数决定。LTE 是将精确连续解 $u^{\\text{inc}}(x,y)$ 代入离散数值格式时得到的残差。\n\n设 $A_h$ 为 TF 区域内未知数的离散算子矩阵，设 $\\mathbf{s}$ 为上面推导出的源项向量。数值解 $\\mathbf{u}_h$ 通过求解线性系统 $A_h \\mathbf{u}_h = \\mathbf{s}$ 得到。\n\n节点 $(i,j)$ 处的 LTE 为 $\\tau_{i,j} = (A_h \\mathbf{u}^{\\text{inc}})_{i,j} - s_{i,j}$，其中 $\\mathbf{u}^{\\text{inc}}$ 是精确解在网格点上的采样值向量。\n\n让我们检查不同节点类型的 $\\tau_{i,j}$。\n- 对于不与边界相邻的节点 $(i,j)$ ($1 < i < N_x-1, 1 < j < N_y-1$)：\n离散方程为 $(L_h u_h)_{i,j} = 0$，因此 $(A_h \\mathbf{u}_h)_{i,j} = (L_h u_h)_{i,j}$ 且 $s_{i,j} = 0$。\nLTE 为 $\\tau_{i,j} = (L_h u^{\\text{inc}})_{i,j} - 0 = (L_h u^{\\text{inc}})_{i,j}$。\n\n- 对于边界层上的节点，例如 $(1,j)$，其中 $1 < j < N_y-1$：\n离散方程为 $\\frac{u_{h,2,j} - 2u_{h,1,j}}{h^2} + \\frac{u_{h,1,j+1} - 2u_{h,1,j} + u_{h,1,j-1}}{h^2} + k^2 u_{h,1,j} = s_{1,j}$。\n因此，$(A_h \\mathbf{u}^{\\text{inc}})_{1,j} = \\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j}$。\n源项为 $s_{1,j} = -u^{\\text{inc}}_{0,j}/h^2$。\nLTE 为：\n$$\n\\tau_{1,j} = \\left(\\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j}\\right) - \\left(-\\frac{u^{\\text{inc}}_{0,j}}{h^2}\\right)\n$$\n$$\n\\tau_{1,j} = \\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{0,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j} = (L_h u^{\\text{inc}})_{1,j}.\n$$\n这表明，源项的特定选择确保了对于 TF 区域的所有内部节点 $(i,j)$，LTE 都具有相同的形式 $\\tau_{i,j} = (L_h u^{\\text{inc}})_{i,j}$。\n\n为了找到 LTE 的阶数，我们对 $u^{\\text{inc}}(x,y)$ 在点 $(x_i, y_j)$ 周围进行泰勒级数展开。令 $u \\equiv u^{\\text{inc}}$ 并且所有导数都在 $(x_i, y_j)$ 处求值。\n$$\nu(x_i \\pm h, y_j) = u \\pm h \\frac{\\partial u}{\\partial x} + \\frac{h^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} \\pm \\frac{h^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(h^5)\n$$\n$x$ 方向二阶导数的中心差分为：\n$$\n\\frac{u(x_i+h,y_j) - 2u(x_i,y_j) + u(x_i-h,y_j)}{h^2} = \\frac{1}{h^2} \\left( (u + h u_x + \\frac{h^2}{2}u_{xx} + \\dots) - 2u + (u - h u_x + \\frac{h^2}{2}u_{xx} - \\dots) \\right)\n$$\n$$\n= \\frac{1}{h^2} \\left( 2\\frac{h^2}{2}u_{xx} + 2\\frac{h^4}{24}u_{xxxx} + O(h^6) \\right) = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial x^4} + O(h^4).\n$$\n对于 $y$ 方向的导数，也存在相同的结果。\n现在，我们将这些代入 $\\tau_{i,j}$ 的表达式中：\n$$\n\\tau_{i,j} = (L_h u)_{i,j} = \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial x^4} + O(h^4) \\right) + \\left( \\frac{\\partial^2 u}{\\partial y^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial y^4} + O(h^4) \\right) + k^2 u.\n$$\n合并项：\n$$\n\\tau_{i,j} = \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + k^2 u \\right) + \\frac{h^2}{12} \\left( \\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4} \\right) + O(h^4).\n$$\n第一个括号中的项是作用于 $u = u^{\\text{inc}}$ 的连续亥姆霍兹算子。由于 $u^{\\text{inc}}$ 是一个精确解，该项为零：\n$$\n\\Delta u^{\\text{inc}} + k^2 u^{\\text{inc}} = 0.\n$$\n因此，局部截断误差为：\n$$\n\\tau_{i,j} = \\frac{h^2}{12} \\left( \\frac{\\partial^4 u^{\\text{inc}}}{\\partial x^4} + \\frac{\\partial^4 u^{\\text{inc}}}{\\partial y^4} \\right) + O(h^4).\n$$\nLTE 中的主阶项是 $h^2$ 阶。形式精度阶数 $m$ 是此主阶项中 $h$ 的指数。因此，$m=2$。稳定性的假设确保了数值解 $u_h$ 的全局误差与 LTE 具有相同的阶数。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "实用的计算声学常常采用高阶、交错网格格式来提高精度和稳定性。本练习  旨在挑战您将 TF/SF 的概念推广到一个四阶精度的时域交错网格求解器中。您将从第一性原理出发，推导所需的高阶差分格式和插值公式，从而深入了解高级 TF/SF 公式的实现细节。",
            "id": "4148468",
            "problem": "考虑在均匀、无损耗介质中的一维线性声学问题，其常数质量密度为 $\\rho_{0}$，声速为 $c$，由以下一階系统控制\n$$\n\\partial_{t} p(x,t) \\;=\\; -\\,\\rho_{0}\\,c^{2}\\,\\partial_{x} u(x,t),\n\\qquad\n\\partial_{t} u(x,t) \\;=\\; -\\,\\frac{1}{\\rho_{0}}\\,\\partial_{x} p(x,t),\n$$\n其中 $p$ 是声压，$u$ 是质点速度。使用均匀交错网格：压力 $p_{i}^{n}$ 存储在整数空间索引 $x_{i} = i\\,\\Delta x$ 和整数时间 $t^{n} = n\\,\\Delta t$ 处，而速度 $u_{i+1/2}^{n+1/2}$ 存储在半整数空间索引 $x_{i+1/2} = (i+\\tfrac{1}{2})\\,\\Delta x$ 和半整数时间 $t^{n+1/2} = (n+\\tfrac{1}{2})\\,\\Delta t$ 处。更新采用标准的蛙跳格式，\n$$\nu_{i+1/2}^{\\,n+1/2} \\;=\\; u_{i+1/2}^{\\,n-1/2} \\;-\\; \\frac{\\Delta t}{\\rho_{0}}\\,\\big(D_{x} p\\big)_{i+1/2}^{\\,n},\n\\qquad\np_{i}^{\\,n+1} \\;=\\; p_{i}^{\\,n} \\;-\\; \\rho_{0} c^{2} \\Delta t\\,\\big(D_{x} u\\big)_{i}^{\\,n+1/2},\n$$\n其中 $\\big(D_{x} p\\big)_{i+1/2}$ 和 $\\big(D_{x} u\\big)_{i}$ 分别是在相应网格位置上对 $\\partial_{x} p$ 和 $\\partial_{x} u$ 的离散近似。假设两个空间导数均采用由与交錯网格一致的最小对称模板构成的四阶精度中心有限差分进行近似。\n\n使用总场-散射场 (TF/SF) 公式将一个已知的右行入射平面波注入计算域。在总场-散射场 (TF/SF) 方法中，计算域在界面索引 $i = i_{b}$ 处被划分，使得当 $i \\le i_{b}$ 时，推进的是全场；而当 $i > i_{b}$ 时，仅更新散射场。在 TF/SF 界面处，压力更新中用于 $\\big(D_{x} u\\big)_{i_{b}}$ 的四阶模板跨越了半网格速度值 $u_{i_{b}-3/2}^{\\,n+1/2}$、$u_{i_{b}-1/2}^{\\,n+1/2}$、$u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$，其中最右边的两项位于全场区域之外，必须与入射波一致地提供。假设入射压力场 $p_{\\text{inc}}(x,t)$ 是解析的且右行的，因此 $u_{\\text{inc}}(x,t) = p_{\\text{inc}}(x,t)/(\\rho_{0} c)$。为将入射场耦合到交错的速度位置上，使用四阶精度的中点插值，从四个相邻的整数位置压力采样值 $\\{p_{\\text{inc}}(x_{i-1},t), p_{\\text{inc}}(x_{i},t), p_{\\text{inc}}(x_{i+1},t), p_{\\text{inc}}(x_{i+2},t)\\}$ 来计算 $x_{i+1/2}$ 处的 $u_{\\text{inc}}$。\n\n从连续控制方程和关于界面的泰勒级数展开出发，推导：\n1. 在交錯网格上，用 $u_{i\\pm1/2}$ 和 $u_{i\\pm3/2}$ 表示 $\\big(D_{x} u\\big)_{i}$ 的四阶精度中心差分模板。\n2. 用四个相邻整数位置上的入射压力采样值以及关系式 $u_{\\text{inc}} = p_{\\text{inc}}/(\\rho_{0}c)$ 表示 $u_{\\text{inc},\\,i+1/2}(t)$ 的四阶精度中点插值公式。\n3. 必须加到索引 $i_{b}$ 处压力更新中的显式总场-散射场修正项 $\\mathcal{C}_{p}(i_{b})$，该项通过第2项中的插值方法，匹配来自鬼点半网格速度 $u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$ 的入射通量贡献而得到。\n\n将你的最终答案表示为 $\\mathcal{C}_{p}(i_{b})$ 的单个闭式解析表达式，用 $j \\in \\{i_{b}-1, i_{b}, i_{b}+1, i_{b}+2, i_{b}+3\\}$ 处的入射压力采样值 $\\{p_{\\text{inc},\\,j}^{\\,n+1/2}\\}$ 以及常数 $c$、$\\Delta t$ 和 $\\Delta x$ 来表示。无需进行数值四舍五入。最终方框内的答案不应包含单位。",
            "solution": "线性化的一阶声学系统提供了支撑有限差分更新算子的连续通量形式。在交錯网格上，蛙跳格式使用 $p$ 在半步长处的空间导数来更新 $u$，并使用 $u$ 在整数步长处的导数来更新 $p$。为了在给定的交錯网格上构造四阶精度的中心差分算子，我们围绕目标空间位置进行泰勒展开，并构建能够抵消低阶截断误差项的对称模板。\n\n首先，使用交錯的半整数索引，推导在整数位置 $x_i$ 处 $\\big(D_{x} u\\big)_{i}$ 的四阶中心差分。考虑通用的对称四点近似\n$$\n\\big(D_{x} u\\big)_{i} \\;\\approx\\; \\frac{1}{\\Delta x}\\,\\Big[\\,a\\,\\big(u_{i+1/2}-u_{i-1/2}\\big) \\;+\\; b\\,\\big(u_{i+3/2}-u_{i-3/2}\\big)\\,\\Big],\n$$\n其中待定未知系数 $a$ 和 $b$ 需使得该近似达到四阶精度。将 $u_{i\\pm 1/2}$ 和 $u_{i\\pm 3/2}$ 在 $x_i$ 附近进行泰勒级数展开：\n$$\nu_{i\\pm 1/2} \\;=\\; u(x_{i}) \\;\\pm\\; \\tfrac{1}{2}\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{1}{8}\\Delta x^{2}\\,u''(x_{i}) \\;\\pm\\; \\tfrac{1}{48}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\tfrac{1}{384}\\Delta x^{4}\\,u^{(4)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}),\n$$\n$$\nu_{i\\pm 3/2} \\;=\\; u(x_{i}) \\;\\pm\\; \\tfrac{3}{2}\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{9}{8}\\Delta x^{2}\\,u''(x_{i}) \\;\\pm\\; \\tfrac{27}{48}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\tfrac{81}{384}\\Delta x^{4}\\,u^{(4)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}).\n$$\n构建差分：\n$$\nu_{i+1/2}-u_{i-1/2} \\;=\\; \\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{1}{24}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}),\n$$\n$$\nu_{i+3/2}-u_{i-3/2} \\;=\\; 3\\,\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{27}{24}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}).\n$$\n代入近似式并合并同类项：\n$$\n\\frac{1}{\\Delta x}\\,\\Big[\\,a\\,(u_{i+1/2}-u_{i-1/2}) + b\\,(u_{i+3/2}-u_{i-3/2})\\Big]\n\\;=\\; (a + 3b)\\,u'(x_{i}) \\;+\\; \\Big(\\tfrac{a}{24} + \\tfrac{27b}{24}\\Big)\\,\\Delta x^{2}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n为了达到四阶精度，我们需要 $a + 3b = 1$ 来匹配一阶导数，且 $\\tfrac{a}{24} + \\tfrac{27b}{24} = 0$ 以消除 $\\Delta x^{2}u^{(3)}$ 项。求解得到，\n$$\na + 3b = 1,\\qquad a + 27b = 0 \\;\\;\\Rightarrow\\;\\; b = -\\,\\frac{1}{24},\\quad a = \\frac{9}{8}.\n$$\n因此，\n$$\n\\big(D_{x} u\\big)_{i} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(u_{i+1/2}-u_{i-1/2}\\big) \\;-\\; \\frac{1}{24}\\,\\big(u_{i+3/2}-u_{i-3/2}\\big)\\,\\right] \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n通过在相反的交錯网格上进行相同的推理，$\\big(D_{x} p\\big)_{i+1/2}$ 的四阶中心差分为\n$$\n\\big(D_{x} p\\big)_{i+1/2} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(p_{i+1}-p_{i}\\big) \\;-\\; \\frac{1}{24}\\,\\big(p_{i+2}-p_{i-1}\\big)\\,\\right] \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n\n其次，推导将整数位置的压力采样值映射到半整数索引速度位置的四阶中点插值公式。考虑一个光滑函数 $f$ 的通用中点插值：\n$$\nf_{i+1/2} \\;\\approx\\; w_{-1}\\,f_{i-1} \\;+\\; w_{0}\\,f_{i} \\;+\\; w_{1}\\,f_{i+1} \\;+\\; w_{2}\\,f_{i+2},\n$$\n其中权重 $\\{w_{-1},w_{0},w_{1},w_{2}\\}$ 的选取应使近似在 $x_{i+1/2}$ 处达到四阶精度。使用关于 $x_i$ 的泰勒展开：\n$$\nf_{i-1} = f(x_{i}) - \\Delta x\\,f'(x_{i}) + \\tfrac{1}{2}\\Delta x^{2}\\,f''(x_{i}) - \\tfrac{1}{6}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{24}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots,\n$$\n$$\nf_{i} = f(x_{i}),\n\\qquad\nf_{i+1} = f(x_{i}) + \\Delta x\\,f'(x_{i}) + \\tfrac{1}{2}\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{1}{6}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{24}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots,\n$$\n$$\nf_{i+2} = f(x_{i}) + 2\\Delta x\\,f'(x_{i}) + 2\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{4}{3}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{2}{3}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots.\n$$\n此外，\n$$\nf(x_{i+1/2}) = f(x_{i}) + \\tfrac{1}{2}\\Delta x\\,f'(x_{i}) + \\tfrac{1}{8}\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{1}{48}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{384}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots.\n$$\n通过施加以下条件来匹配截至 $\\Delta x^{4}$ 的系数\n$$\nw_{-1}+w_{0}+w_{1}+w_{2} = 1,\n$$\n$$\n(-1)w_{-1} + 0\\cdot w_{0} + 1\\cdot w_{1} + 2 w_{2} = \\tfrac{1}{2},\n$$\n$$\n\\tfrac{1}{2}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{2}w_{1} + 2 w_{2} = \\tfrac{1}{8},\n$$\n$$\n-\\tfrac{1}{6}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{6}w_{1} + \\tfrac{4}{3} w_{2} = \\tfrac{1}{48},\n$$\n$$\n\\tfrac{1}{24}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{24}w_{1} + \\tfrac{2}{3} w_{2} = \\tfrac{1}{384}.\n$$\n求解此方程组可得唯一的四阶中点权重\n$$\nw_{-1} = -\\,\\frac{1}{16},\\qquad w_{0} = \\frac{9}{16},\\qquad w_{1} = \\frac{9}{16},\\qquad w_{2} = -\\,\\frac{1}{16}.\n$$\n因此，利用右行平面波关系 $u_{\\text{inc}} = p_{\\text{inc}}/(\\rho_{0}c)$，在半整数索引处入射速度所需的插值为\n$$\nu_{\\text{inc},\\,i+1/2}(t) \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i-1}(t) \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i}(t) \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i+1}(t) \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i+2}(t)\\,\\Big].\n$$\n\n第三，推导总场-散射场修正项。在界面索引 $i = i_{b}$ 处，出现在压力更新中的 $\\big(D_{x} u\\big)_{i_{b}}$ 的四阶模板包含了来自界面两侧的半网格速度值：\n$$\n\\big(D_{x} u\\big)_{i_{b}} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(u_{i_{b}+1/2}-u_{i_{b}-1/2}\\big) \\;-\\; \\frac{1}{24}\\,\\big(u_{i_{b}+3/2}-u_{i_{b}-3/2}\\big)\\,\\right].\n$$\n值 $u_{i_{b}-1/2}^{\\,n+1/2}$ 和 $u_{i_{b}-3/2}^{\\,n+1/2}$ 位于全场区域内部，并作为全场进行推进，因此在那里不需要修正。值 $u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$ 位于外部；为了与入射波一致地注入，这些鬼点所贡献的离散通量必须等于入射场的通量。因此，在时间 $n+1$ 时，加到 $i_{b}$ 处压力更新的修正项是来自那些鬼点半网格点的入射通量贡献：\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\rho_{0} c^{2}\\,\\Delta t\\;\\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,u_{\\text{inc},\\,i_{b}+1/2}^{\\,n+1/2} \\;-\\; \\frac{1}{24}\\,u_{\\text{inc},\\,i_{b}+3/2}^{\\,n+1/2}\\,\\right].\n$$\n对每个所需的半整数索引应用中点插值：\n$$\nu_{\\text{inc},\\,i_{b}+1/2}^{\\,n+1/2} \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}\\,\\Big],\n$$\n$$\nu_{\\text{inc},\\,i_{b}+3/2}^{\\,n+1/2} \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\,\\Big].\n$$\n代入并使用 $-\\rho_{0} c^{2} \\times (1/(\\rho_{0} c)) = -\\,c$ 进行化简：\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\frac{c\\,\\Delta t}{\\Delta x}\\,\\Bigg\\{\n\\frac{9}{8}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} - \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}\\Big]\n\\;-\\;\n\\frac{1}{24}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} - \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\Big]\n\\Bigg\\}.\n$$\n合并每个整数索引的系数：\n- 在 $i_{b}-1$ 处：系数 $-\\tfrac{9}{8}\\cdot\\tfrac{1}{16} = -\\tfrac{9}{128}$。\n- 在 $i_{b}$ 处：系数 $\\tfrac{9}{8}\\cdot\\tfrac{9}{16} + \\tfrac{1}{24}\\cdot\\tfrac{1}{16} = \\tfrac{81}{128} + \\tfrac{1}{384} = \\tfrac{244}{384} = \\tfrac{61}{96}$。\n- 在 $i_{b}+1$ 处：系数 $\\tfrac{9}{8}\\cdot\\tfrac{9}{16} - \\tfrac{1}{24}\\cdot\\tfrac{9}{16} = \\tfrac{81}{128} - \\tfrac{9}{384} = \\tfrac{234}{384} = \\tfrac{39}{64}$。\n- 在 $i_{b}+2$ 处：系数 $-\\tfrac{9}{8}\\cdot\\tfrac{1}{16} - \\tfrac{1}{24}\\cdot\\tfrac{9}{16} = -\\tfrac{9}{128} - \\tfrac{9}{384} = -\\tfrac{36}{384} = -\\tfrac{3}{32}$。\n- 在 $i_{b}+3$ 处：系数 $\\tfrac{1}{24}\\cdot\\tfrac{1}{16} = \\tfrac{1}{384}$。\n\n因此，闭式 TF/SF 修正项为\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\frac{c\\,\\Delta t}{\\Delta x}\\,\\left[\\,-\\frac{9}{128}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} \\;+\\; \\frac{61}{96}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{39}{64}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;-\\; \\frac{3}{32}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} \\;+\\; \\frac{1}{384}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2} \\right].\n$$\n此表达式实现了四阶有限差分格式在 TF/SF 界面上的入射通量匹配，它使用四阶中点插值方法，从已知的入射压力采样值来填充所需的鬼点半网格速度。",
            "answer": "$$\\boxed{-\\frac{c\\,\\Delta t}{\\Delta x}\\left[-\\frac{9}{128}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2}+\\frac{61}{96}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2}+\\frac{39}{64}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2}-\\frac{3}{32}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}+\\frac{1}{384}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\right]}$$"
        },
        {
            "introduction": "TF/SF 方法在均匀介质中所展现的简洁性，在应用于真实的非均匀环境时可能产生误导。最后一个实践练习探讨了一个关键挑战：当一个不正确的入射场被注入到可变介质背景中时，会产生伪散射。通过分析这个误差的来源 ，您将理解为什么简单的平面波通常是不够的，并了解到在复杂介质中正确模拟波注入所需的先进技术。",
            "id": "4148520",
            "problem": "考虑一个有界计算域 $\\,\\Omega\\,$ 中的线性声学问题，其中密度 $\\,\\rho(\\mathbf{x})\\,$ 和声速 $\\,c(\\mathbfx)\\,$ 随空间变化，且均为光滑严格正函数。控制二阶压力方程为\n$$\nL_b p \\equiv \\frac{1}{c^2(\\mathbf{x})}\\,\\partial_{tt} p(\\mathbf{x},t)\\;-\\;\\nabla\\cdot\\!\\left(\\frac{1}{\\rho(\\mathbf{x})}\\,\\nabla p(\\mathbf{x},t)\\right)\\;=\\;0\\quad\\text{in}\\ \\Omega,\n$$\n该方程定义了非均匀背景算子 $\\,L_b\\,$。在计算声学的总场-散射场 (Total-Field/Scattered-Field, TF/SF) 公式中，将域划分为全场子域 $\\,\\Omega_T\\subset\\Omega\\,$、散射场子域 $\\,\\Omega_S=\\Omega\\setminus\\overline{\\Omega_T}\\,$ 以及一个界面 $\\,\\Gamma=\\partial\\Omega_T\\cap\\partial\\Omega_S\\,$。入射场通过此界面注入，以分离出目标散射。其目标是通过 $\\,\\Gamma\\,$ 注入一个入射场 $\\,p^{\\mathrm{inc}}\\,$，该入射场应在实际的非均匀背景中传播，从而使得在 $\\,\\Omega_S\\,$ 中记录到的散射仅由 $\\,\\Omega_T\\,$ 中的目标引起。\n\n假设我们尝试注入一个均匀介质平面波 $\\,p^{\\mathrm{pw}}\\,$，它满足\n$$\nL_0 p^{\\mathrm{pw}} \\equiv \\frac{1}{c_0^2}\\,\\partial_{tt} p^{\\mathrm{pw}}(\\mathbf{x},t)\\;-\\;\\frac{1}{\\rho_0}\\,\\Delta p^{\\mathrm{pw}}(\\mathbf{x},t)\\;=\\;0\\quad\\text{in}\\ \\mathbb{R}^d,\n$$\n其中 $\\,\\rho_0>0\\,$ 和 $\\,c_0>0\\,$ 是常数，并且在时谐情况下满足通常的平面波关系 $\\,\\|\\mathbf{k}\\|=\\omega/c_0\\,$。在实践中，人们会使用 $\\,p^{\\mathrm{pw}}\\,$ 的迹（及其相关的通量或速度）来驱动 TF/SF 界面 $\\,\\Gamma\\,$，就好像它是背景入射场一样。\n\n请从第一性原理出发，解释为什么即使在 $\\,\\Omega_T\\,$ 中没有物理目标，向非均匀背景 $\\,L_b\\,$ 注入这种波通常也会产生伪散射，并提出一种方法，通过在实际非均匀背景中进行数值射线或偏微分方程 (PDE) 求解，来预计算 $\\,\\Gamma\\,$ 上的入射迹，以消除这种伪散射。你的解释必须从控制算子 $\\,L_b\\,$ 和 $\\,L_0\\,$ 以及 TF/SF 界面概念出发，推导出注入 $\\,p^{\\mathrm{pw}}\\,$ 时产生的残余强迫项，并说明如何消除它。\n\n以下哪些陈述是正确的？\n\nA. 产生伪散射是因为 $\\,p^{\\mathrm{pw}}\\,$ 满足 $\\,L_0 p^{\\mathrm{pw}}=0\\,$，而不是 $\\,L_b p^{\\mathrm{pw}}=0\\,$。在 $\\,\\Omega_T\\,$ 内部，非均匀算子作用于 $\\,p^{\\mathrm{pw}}\\,$ 会产生一个非零残差 $\\,r(\\mathbf{x},t)=(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$，即使在没有物理目标的情况下，该残差也充当等效体力，驱动一个散射场。要消除这种情况，需要注入一个在真实背景中满足 $\\,L_b p^{\\mathrm{bg}}=0\\,$ 的入射场 $\\,p^{\\mathrm{bg}}\\,$。\n\nB. 为抑制 $\\,\\Gamma\\,$ 处的伪散射，应通过求解 $\\,L_b p^{\\mathrm{bg}}=0\\,$（例如，通过纯背景时域 PDE 求解或高频数值射线）来预计算背景入射场 $\\,p^{\\mathrm{bg}}\\,$，记录压力迹 $\\,p^{\\mathrm{bg}}|_\\Gamma\\,$ 和与之对应的一致法向通量迹 $\\,q^{\\mathrm{bg}}|_\\Gamma=\\mathbf{n}\\cdot\\left(\\frac{1}{\\rho(\\mathbf{x})}\\nabla p^{\\mathrm{bg}}(\\mathbf{x},t)\\right)\\big|_{\\Gamma}\\,$，并将这些迹作为特征边界数据或双边边界数据施加于 TF/SF 注入。\n\nC. 在高频情况下，仅通过求解程函方程 $\\,\\|\\nabla T(\\mathbf{x})\\|=1/c(\\mathbf{x})\\,$ 预计算相位，然后注入具有该相位的恒定振幅波形就足够了。由几何扩散和阻抗引起的振幅变化不会影响 $\\,\\Gamma\\,$ 处的伪散射。\n\nD. 在 $\\,\\Gamma\\,$ 周围设置一个具有大阻尼系数的薄海绵层，总能消除因注入违反 $\\,L_b\\,$ 的 $\\,p^{\\mathrm{pw}}\\,$ 所引起的伪散射，而无论背景的非均匀性如何，从而使预计算入射迹变得不必要。\n\nE. 预计算背景迹的一种替代方法是，在注入 $\\,p^{\\mathrm{pw}}\\,$ 的同时，在 $\\,\\Omega_T\\,$ 中添加一个等于 $\\,f(\\mathbf{x},t)=-(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$ 的体校正源。这使得在 $\\,\\Omega_T\\,$ 中强制满足 $\\,L_b(p^{\\mathrm{pw}})+f=0\\,$，从而在没有目标的情况下消除了残差和相关的伪散射。\n\n选择所有适用的选项。",
            "solution": "用户希望我验证问题陈述的有效性，如果有效，则提供详细的解答。\n\n### 步骤 1: 提取已知条件\n-   **控制方程：** 在非均匀背景中的压力场 $\\,p(\\mathbf{x},t)\\,$ 由算子 $\\,L_b\\,$ 控制，定义为\n    $$\n    L_b p \\equiv \\frac{1}{c^2(\\mathbf{x})}\\,\\partial_{tt} p(\\mathbf{x},t)\\;-\\;\\nabla\\cdot\\!\\left(\\frac{1}{\\rho(\\mathbf{x})}\\,\\nabla p(\\mathbf{x},t)\\right)\\;=\\;0.\n    $$\n    域为 $\\,\\Omega\\,$，密度 $\\,\\rho(\\mathbf{x})\\,$ 和声速 $\\,c(\\mathbf{x})\\,$ 是光滑且严格为正的。\n-   **TF/SF 划分：** 域 $\\,\\Omega\\,$ 被划分为总场子域 $\\,\\Omega_T\\subset\\Omega\\,$、散射场子域 $\\,\\Omega_S=\\Omega\\setminus\\overline{\\Omega_T}\\,$ 和界面 $\\,\\Gamma=\\partial\\Omega_T\\cap\\partial\\Omega_S\\,$。\n-   **理想注入：** 目标是注入一个入射场 $\\,p^{\\mathrm{inc}}\\,$，该入射场是非均匀背景下的一个解，即 $\\,L_b p^{\\mathrm{inc}} = 0\\,$。\n-   **建议的注入：** 尝试注入一个均匀介质平面波 $\\,p^{\\mathrm{pw}}\\,$，它是以下方程的解\n    $$\n    L_0 p^{\\mathrm{pw}} \\equiv \\frac{1}{c_0^2}\\,\\partial_{tt} p^{\\mathrm{pw}}(\\mathbf{x},t)\\;-\\;\\frac{1}{\\rho_0}\\,\\Delta p^{\\mathrm{pw}}(\\mathbf{x},t)\\;=\\;0,\n    $$\n    其中 $\\,\\rho_0 > 0\\,$ 和 $\\,c_0 > 0\\,$ 为常数。\n-   **问题：** 该问题要求两件事：\n    1.  从第一性原理出发，解释为什么注入 $\\,p^{\\mathrm{pw}}\\,$ 会产生伪散射。\n    2.  提出一种预计算 $\\,\\Gamma\\,$ 上正确入射迹的方法以消除这种伪散射。\n\n### 步骤 2: 使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固地植根于波传播理论和偏微分方程（PDE）的数值方法。非均匀介质的声波方程（$\\,L_b p = 0\\,$）是标准的。总场-散射场（TF/SF）公式是计算电磁学和声学中一种成熟的技术，用于将入射场引入仿真域。在实现此类方法时，解析已知的入射场（如均匀介质中的平面波）与实际非均匀背景之间的算子不匹配是一个真实且关键的挑战。该问题在科学上是合理的。\n2.  **适定性：** 问题陈述清晰。它定义了所有相关算子和概念。它要求一个概念性的解释和一个有效方法的提议，这两者都可以根据 PDE 理论和数值分析得出确切的答案。\n3.  **客观性：** 语言正式、精确、客观，使用了物理学和应用数学的标准术语。\n4.  **完整性：** 问题提供了所有必要信息，以便对基本原理进行推理。没有缺少任何必要的定义或条件。\n5.  **未检测到其他缺陷。** 问题并非微不足道、不切实际或不适定的。\n\n### 步骤 3: 结论与行动\n问题陈述是 **有效的**。将制定一个完整的解答。\n\n### 推导与选项分析\n\n总场-散射场 (TF/SF) 方法依赖于控制波动方程的线性。总压力场 $\\,p\\,$ 分解为一个入射场 $\\,p^{\\mathrm{inc}}\\,$ 和一个散射场 $\\,p^{\\mathrm{scat}}\\,$：\n$$\np(\\mathbf{x},t) = p^{\\mathrm{inc}}(\\mathbf{x},t) + p^{\\mathrm{scat}}(\\mathbf{x},t).\n$$\n入射场 $\\,p^{\\mathrm{inc}}\\,$ 定义为在没有任何散射体的情况下*背景介质*中存在的场。散射场 $\\,p^{\\mathrm{scat}}\\,$ 是由于散射体的存在而对该入射场产生的扰动。为了使 TF/SF 公式是“干净的”，即在没有物理散射体的情况下计算出的散射场为零（$\\,p^{\\mathrm{scat}}=0\\,$），入射场 $\\,p^{\\mathrm{inc}}\\,$ 必须是背景介质中控制方程的一个解。在这个问题中，背景是非均匀的，因此条件是 $\\,L_b p^{\\mathrm{inc}} = 0\\,$。\n\n该问题描述了违反此条件的情景。选择了一个入射场 $\\,p^{\\mathrm{pw}}\\,$，它满足*均匀*介质的波动方程 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，其中 $\\,L_0\\,$ 与真实的背景算子 $\\,L_b\\,$ 不同。由于一般情况下 $\\,c(\\mathbf{x}) \\neq c_0\\,$ 或 $\\,\\rho(\\mathbf{x}) \\neq \\rho_0\\,$，$\\,p^{\\mathrm{pw}}\\,$ 不是背景波动方程的解：$\\,L_b p^{\\mathrm{pw}} \\neq 0\\,$。\n\n为了理解其后果，我们将背景算子 $\\,L_b\\,$ 应用于所选的入射场 $\\,p^{\\mathrm{pw}}\\,$：\n$$\nL_b p^{\\mathrm{pw}} = (L_b - L_0) p^{\\mathrm{pw}} + L_0 p^{\\mathrm{pw}}.\n$$\n由于 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，这简化为\n$$\nL_b p^{\\mathrm{pw}} = (L_b - L_0) p^{\\mathrm{pw}}.\n$$\n让我们将这个残差项称为 $\\,r(\\mathbf{x},t) = (L_b - L_0) p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$。在背景介质属性 $\\,(\\rho(\\mathbf{x}), c(\\mathbf{x}))\\,$与参考常数 $\\,(\\rho_0, c_0)\\,$ 不同的任何地方，该残差项都非零。\n\n现在考虑在没有任何物理目标的情况下总场 $\\,p\\,$ 的方程。它必须满足 $\\,L_b p = 0\\,$。如果我们使用错误选择的入射场将 $\\,p\\,$ 分解为 $\\,p = p^{\\mathrm{pw}} + p^{\\mathrm{scat}}\\,$，并将其代入控制方程，我们得到：\n$$\nL_b (p^{\\mathrm{pw}} + p^{\\mathrm{scat}}) = 0.\n$$\n根据线性性质，\n$$\nL_b p^{\\mathrm{pw}} + L_b p^{\\mathrm{scat}} = 0.\n$$\n代入残差 $\\,r = L_b p^{\\mathrm{pw}}\\,$，我们找到了散射场必须满足的方程：\n$$\nL_b p^{\\mathrmat}} = -r(\\mathbf{x},t) = -(L_b - L_0) p^{\\mathrm{pw}}(\\mathbf{x},t).\n$$\n这是一个由非零源项 $\\,-r(\\mathbf{x},t)\\,$ 驱动的散射场 $\\,p^{\\mathrm{scat}}\\,$ 的波动方程。这个源项即使在没有物理目标的情况下也存在；它是注入场与背景介质之间不匹配的产物。由此源产生的场 $\\,p^{\\mathrm{scat}}\\,$ 就是*伪散射*。TF/SF 界面 $\\,\\Gamma\\,$ 是数值方案有效引入这种不一致性的地方，然后这种不一致性表现为一个源。\n\n为了消除这种伪散射，必须使用一个真实背景问题的解作为入射场 $\\,p^{\\mathrm{bg}}\\,$，即 $\\,L_b p^{\\mathrm{bg}}=0\\,$。由于对于非均匀背景，$\\,p^{\\mathrm{bg}}\\,$ 通常没有解析解，因此必须进行数值预计算。两种主要方法是：\n1.  **基于 PDE 的预计算：** 在一个代表背景介质的、更大的独立仿真域中求解背景方程 $\\,L_b p=0\\,$。可以使用一个局部源来生成一个在感兴趣区域变为平面的波。然后将得到的场 $\\,p^{\\mathrm{bg}}(\\mathbf{x},t)\\,$ 及其法向通量 $\\,q^{\\mathrm{bg}} = \\mathbf{n}\\cdot(\\frac{1}{\\rho}\\nabla p^{\\mathrm{bg}})\\,$ 在表面 $\\,\\Gamma\\,$ 上随时间记录下来。这些记录下来的迹随后被用作主 TF/SF 仿真的注入数据。\n2.  **高频渐近法（射线理论）：** 对于高频波，可以使用射线理论（WKBJ近似）来近似 $\\,p^{\\mathrm{bg}}\\,$。这涉及求解程函方程 $\\,\\|\\nabla T\\|=1/c(\\mathbf{x})\\,$ 以获得走时场 $\\,T(\\mathbf{x})\\,$，以及求解输运方程以获得振幅 $\\,A(\\mathbf{x})\\,$，该振幅考虑了几何扩散和阻抗变化。入射场随后构建为 $\\,p^{\\mathrm{bg}} \\approx A(\\mathbf{x})F(t-T(\\mathbf{x}))\\,$。相位和振幅都必须正确计算。\n\n一种替代方法是通过修正控制方程本身来避免预计算，如选项 E 所探讨的那样。\n\n现在，我们评估每个选项。\n\n**A. 产生伪散射是因为...**\n该陈述正确地指出了根本原因：$\\,p^{\\mathrm{pw}}\\,$ 不是背景方程 $\\,L_b p=0\\,$ 的解。它正确地将残差 $\\,r(\\mathbf{x},t)=(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$ 识别为驱动伪散射场的“等效体力”（或源项）。这与我们推导出的 $\\,L_b p^{\\mathrm{scat}} = -r\\,$ 完全一致。结论是必须注入一个满足 $\\,L_b p^{\\mathrm{bg}}=0\\,$ 的场 $\\,p^{\\mathrm{bg}}\\,$ 来消除这个问题，这也是正确的。\n**结论：正确。**\n\n**B. 为抑制 $\\,\\Gamma\\,$ 处的伪散射，应预计算...**\n该陈述描述了在非均匀介质中正确实现 TF/SF 的主要标准方法。它正确地指出必须使用诸如完整 PDE 求解或数值射线等方法来求解背景问题 $\\,L_b p^{\\mathrm{bg}}=0\\,$。关键是，它指出了必须同时记录压力迹 $\\,p^{\\mathrm{bg}}|_\\Gamma\\,$ 和一致的法向通量迹 $\\,q^{\\mathrm{bg}}|_\\Gamma\\,$。使用压力和通量（或速度）允许一个鲁棒的“双边”或基于特征的注入方案，该方案能正确地在全场区域内再现场 $\\,p^{\\mathrm{bg}}\\,$，同时确保在纯背景情况下外部的散射场为零。通量的公式对于给定的算子 $\\,L_b\\,$是正确的。\n**结论：正确。**\n\n**C. 在高频情况下，仅预计算相位就足够了...**\n该陈述是不正确的。一个高频渐近解的形式为 $\\,p^{\\mathrm{bg}}(\\mathbf{x}, t) \\approx A(\\mathbf{x}) F(t - T(\\mathbf{x}))\\,$。虽然相位（走时 $\\,T(\\mathbf{x})\\,$）由程函方程确定，但振幅 $\\,A(\\mathbf{x})\\,$ 不是恒定的。它根据一个输运方程变化，该方程解释了波折射和介质阻抗 $\\,\\rho(\\mathbf{x})c(\\mathbf{x})\\,$ 变化时的能量守恒。注入一个具有正确相位但恒定（不正确）振幅的波，意味着注入场仍然不满足 $\\,L_b p = 0\\,$，这将产生一个残差源项，从而导致伪散射。振幅和相位的变化都是至关重要的。\n**结论：不正确。**\n\n**D. 在 $\\,\\Gamma\\,$ 周圍設置一个具有大阻尼系数的薄海绵层...**\n该陈述代表了对 TF/SF 界面和吸收层作用的根本误解。海绵层或完美匹配层（PMLs）放置在计算域的*外部边界*，以吸收出射波并模拟无界介质。在*内部* TF/SF 界面 $\\,\\Gamma\\,$ 处设置阻尼层会无差别地衰减所有通过它的场：正在注入的入射场、任何期望的来自目标的散射场以及伪散射场。它会破坏物理相互作用并摧毁 TF/SF 分解的逻辑，而不是修复注入错误。问题是源错误，而不是反射错误。\n**结论：不正确。**\n\n**E. 預計算背景跡的一种替代方法是添加一个体校正源...**\n这描述了一种有效且已知的替代技术。目标是使 $\\,p^{\\mathrm{pw}}\\,$ 在背景模拟中成为一个有效的解。如果我们将 $\\,\\Omega_T\\,$ 内部的控制方程从 $\\,L_b p = 0\\,$ 修改为 $\\,L_b p = f_{corr}\\,$，我们可以选择源 $\\,f_{corr}\\,$ 使得 $\\,p^{\\mathrm{pw}}\\,$ 是一个解。这要求 $\\,L_b p^{\\mathrm{pw}} = f_{corr}\\,$。从我们的推导中，我们知道 $\\,L_b p^{\\mathrm{pw}} = (L_b-L_0)p^{\\mathrm{pw}}\\,$。该选项建议在 $\\,L_b p + \\text{sources} = 0\\,$ 形式的方程中添加一个源 $\\,f = -(L_b-L_0)p^{\\mathrm{pw}}\\,$。让我们验证一下：我们希望 $\\,\\Omega_T\\,$ 中的总场为 $\\,p^{\\mathrm{pw}}\\,$（在没有目标的情况下）。我们建议在 $\\,\\Omega_T\\,$ 内部求解方程 $\\,L_b p + f = 0\\,$。让我们测试 $\\,p=p^{\\mathrm{pw}}\\,$ 是否是一个解：\n$$\nL_b p^{\\mathrm{pw}} + f = L_b p^{\\mathrm{pw}} - (L_b-L_0)p^{\\mathrm{pw}} = L_b p^{\\mathrm{pw}} - L_b p^{\\mathrm{pw}} + L_0 p^{\\mathrm{pw}} = L_0 p^{\\mathrm{pw}}.\n$$\n由于 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，方程 $\\,L_b p^{\\mathrm{pw}} + f = 0\\,$ 被满足。因此，通过在 $\\,\\Omega_T\\,$ 内部添加这个精确定义的校正源，我们修改了问题，使得简单的平面波 $\\,p^{\\mathrm{pw}}\\,$ 成为局部控制方程的合法解。这消除了否则会产生伪散射的残差。这是一种正确但计算上不同的解决问题的方法。\n**结论：正确。**",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}