{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习旨在探究诺伊曼边界条件在声学中的基本物理意义。通过分析平面波从刚性墙反射的经典场景，您将从第一性原理——即线性化的欧拉方程和连续性方程——出发，推导出为何“声硬”表面对应于零压力梯度。这项练习对于建立坚实的直觉，将零质点速度的物理约束与其数学表示联系起来至关重要。",
            "id": "4131551",
            "problem": "一列时谐平面声波在质量密度为 $\\rho_{0}$、声速为 $c$ 的均匀无损耗流体中传播。流体占据 $z>0$ 的半空间，位于 $z=0$ 的边界是一个无限大的完美刚性（声硬）平面。设声压场采用复相量表示法，其时间依赖关系为 $\\exp(-\\mathrm{i}\\omega t)$，其中 $\\omega$ 是角频率，并定义波数 $k=\\omega/c$。入射平面波的复压强振幅为 $P_{0}$，在 $x$-$z$ 平面内传播，入射角为 $\\theta \\in [0,\\pi/2)$，从正 $z$ 轴（边界指向流体的外法线方向）量起。在流体中无声源的情况下，总场是入射场和反射场的叠加，且每个场都满足齐次 Helmholtz 方程。刚性边界强制施加 Neumann 边界条件，即质点速度的法向分量在 $z=0$ 处为零。\n\n仅使用线性声学的基本原理，即线性化动量方程（Euler 方程）、线性化连续性方程以及无损耗流体的绝热本构关系，推导复压强反射系数 $R_{p}$。其定义为在边界上对所有 $(x,y)$ 满足 $p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$，其中 $p_{i}$ 和 $p_{r}$ 分别表示入射和反射的压强相量。将 $R_{p}$ 表示为仅含给定量的单个闭式解析表达式。最终答案必须是单个表达式。无需四舍五入，最终方框内的表达式不应包含物理单位。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法得当。\n\n**步骤1：提取已知条件**\n- 流体：均匀，无损耗。\n- 流体属性：质量密度 $\\rho_{0}$，声速 $c$。\n- 区域：半空间 $z>0$。\n- 边界：位于 $z=0$ 的无限大完美刚性（声硬）平面。\n- 时间依赖性：相量表示法，时间因子为 $\\exp(-\\mathrm{i}\\omega t)$。\n- 波数：$k=\\omega/c$。\n- 入射波：时谐平面波，复压强振幅为 $P_{0}$。\n- 传播平面：$x$-$z$ 平面。\n- 入射角：$\\theta \\in [0,\\pi/2)$，从正 $z$ 轴量起。\n- 总场：入射场 ($p_i$) 和反射场 ($p_r$) 的叠加。\n- 控制方程：齐次 Helmholtz 方程。\n- 边界条件：质点速度的法向分量在 $z=0$ 处为零。\n- 反射系数定义：$p_{r}(x,y,0)=R_{p}\\,p_{i}(x,y,0)$。\n- 任务：从基本原理（线性化动量方程、连续性方程和本构关系）推导 $R_{p}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是声学中波反射的经典教科书案例。它基于基本原理：从 Euler 方程和连续性方程推导出的波动方程，以及刚性表面的 Neumann 边界条件。所有方面都已在科学上得到确立。\n- **适定性**：该问题是适定的。几何形状、介质、入射波和边界条件都已明确定义，这足以确定反射场及其反射系数的唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **完整性与一致性**：问题提供了所有必要信息，且不含内部矛盾。刚性边界的定义与质点速度的 Neumann 条件正确关联。\n- **主题相关性**：该问题直接涉及声波传播背景下，*刚性（声硬）*表面的*Neumann 边界条件*的物理意义和数学实现，这是*计算声学*和波物理学的核心主题。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将根据指定的基本原理推导解答。\n\n**反射系数的推导**\n\n推导从无损耗、均匀、静态流体的线性声学基本方程开始。设 $p(\\mathbf{r}, t)$ 为声压，$\\mathbf{v}(\\mathbf{r}, t)$ 为质点速度，$\\rho(\\mathbf{r}, t)$ 为声密度扰动。\n\n1.  **基本原理与速度-压强关系：**\n    问题要求从线性化动量方程（Euler 方程）和连续性方程出发。\n    - 线性化动量方程：$\\rho_{0} \\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p$。\n    - 线性化连续性方程：$\\frac{\\partial \\rho}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0$。\n    - 绝热本构关系：$p = c^{2}\\rho$。\n\n    对于时间依赖关系为 $\\exp(-\\mathrm{i}\\omega t)$ 的时谐场，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $-\\mathrm{i}\\omega$。将此应用于复相量 $p(\\mathbf{r})$ 和 $\\mathbf{v}(\\mathbf{r})$ 的动量方程：\n    $$\n    \\rho_{0} (-\\mathrm{i}\\omega) \\mathbf{v} = -\\nabla p\n    $$\n    这给出了质点速度相量和压强相量之间的关键关系：\n    $$\n    \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\nabla p\n    $$\n    在边界 $z=0$ 处，速度的法向分量是 $z$ 分量 $v_z$。边界条件为 $v_z(x,y,0) = 0$。使用上述关系，这变为：\n    $$\n    v_z = \\hat{\\mathbf{z}} \\cdot \\mathbf{v} = \\frac{1}{\\mathrm{i}\\omega\\rho_{0}} \\frac{\\partial p}{\\partial z}\n    $$\n    因此，边界条件 $v_z(x,y,0) = 0$ 等效于压强场的 Neumann 边界条件：\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = 0\n    $$\n\n2.  **入射波与反射波：**\n    入射平面波在 $x$-$z$ 平面内以相对于 $+z$ 轴成 $\\theta$ 角的方向传播。入射波矢量 $\\mathbf{k}_i$ 必须有一个负的 $z$ 分量，以表示向 $z=0$ 边界的传播。$\\mathbf{k}_i$ 的分量为：\n    $$\n    k_{ix} = k \\sin\\theta, \\quad k_{iy} = 0, \\quad k_{iz} = -k \\cos\\theta\n    $$\n    入射压强相量 $p_i$ 由下式给出：\n    $$\n    p_i(x,z) = P_0 \\exp(\\mathrm{i}\\mathbf{k}_i \\cdot \\mathbf{r}) = P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z))\n    $$\n    对于反射波，Snell 定律规定波矢量的切向分量是守恒的：$k_{rx} = k_{ix} = k \\sin\\theta$。反射波必须从边界传播到 $z>0$ 区域，因此其波矢量的 $z$ 分量 $k_{rz}$ 必须为正。由于波仍在同一介质中传播，其波数大小守恒，即 $|\\mathbf{k}_r| = k$。这给出 $k_{rz} = \\sqrt{k^2 - k_{rx}^2} = \\sqrt{k^2 - k^2\\sin^2\\theta} = k\\cos\\theta$。反射波矢量为：\n    $$\n    \\mathbf{k}_r = (k \\sin\\theta, 0, k \\cos\\theta)\n    $$\n    反射压强相量 $p_r$ 可以用反射系数 $R_p$ 表示。问题定义 $R_p$ 使得 $p_r(x,y,0) = R_p p_i(x,y,0)$。在 $z=0$ 处，我们有 $p_i(x,0) = P_0 \\exp(\\mathrm{i}k\\sin\\theta\\,x)$ 和 $p_r(x,0) = P_r\\exp(\\mathrm{i}k\\sin\\theta\\,x)$，其中 $P_r$ 是反射波的复振幅。该定义意味着 $P_r = R_p P_0$。因此，反射波为：\n    $$\n    p_r(x,z) = R_p P_0 \\exp(\\mathrm{i}\\mathbf{k}_r \\cdot \\mathbf{r}) = R_p P_0 \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z))\n    $$\n\n3.  **总场与边界条件应用：**\n    总压强场 $p$ 是入射场和反射场的叠加：\n    $$\n    p(x,z) = p_i(x,z) + p_r(x,z) = P_0 \\left[ \\exp(\\mathrm{i}(k \\sin\\theta \\, x - k \\cos\\theta \\, z)) + R_p \\exp(\\mathrm{i}(k \\sin\\theta \\, x + k \\cos\\theta \\, z)) \\right]\n    $$\n    我们可以提出对 $x$ 的共同空间依赖项：\n    $$\n    p(x,z) = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    现在，应用 Neumann 边界条件 $\\frac{\\partial p}{\\partial z}|_{z=0}=0$。首先，计算 $p$ 对 $z$ 的偏导数：\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\frac{\\partial}{\\partial z} \\left[ \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(-\\mathrm{i}k \\cos\\theta \\, z) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(\\mathrm{i}k \\cos\\theta \\, z) \\right]\n    $$\n    接下来，在边界 $z=0$ 处计算此导数：\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) \\left[ (-\\mathrm{i}k \\cos\\theta) \\exp(0) + R_p (\\mathrm{i}k \\cos\\theta) \\exp(0) \\right]\n    $$\n    $$\n    \\frac{\\partial p}{\\partial z} \\bigg|_{z=0} = P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p)\n    $$\n    将此表达式设为零以满足边界条件：\n    $$\n    P_0 \\exp(\\mathrm{i}k \\sin\\theta \\, x) (-\\mathrm{i}k \\cos\\theta) (1 - R_p) = 0\n    $$\n    该方程必须对所有 $x$ 成立。由于振幅 $P_0$ 非零，$k$ 非零，且入射角 $\\theta$ 在范围 $[0, \\pi/2)$ 内，这意味着 $\\cos\\theta > 0$，因此 $(1 - R_p)$ 项必须为零。\n    $$\n    1 - R_p = 0\n    $$\n\n4.  **结论：**\n    解出反射系数 $R_p$，我们得到：\n    $$\n    R_p = 1\n    $$\n    该结果表明，对于一个完美刚性（声硬）边界，在边界处反射声压波的振幅和相位与入射声压波相同。这导致表面声压加倍，这是一个众所周知的现象。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "从物理学转向数值实现，本练习将探讨如何在有限差分法（FDM）框架内精确地施加诺伊曼边界条件。您将使用一个高阶模板，并确定域外的“虚拟点”的适当值。这不仅仅是一个数值技巧；您将利用控制波动方程本身来推导这些值，从而揭示偏微分方程（PDE）与确保高阶精度的边界条件之间的深刻联系。",
            "id": "4131522",
            "problem": "考虑在密度为 $\\rho_{0}$、声速为 $c$ 的均匀静止流体中的小振幅、无损耗、一维声学问题。设 $x \\in [0,L]$ 表示直管道中的轴向坐标，其左端 $x=0$ 处为理想刚性声硬壁。声场由压力 $p(x,t)$ 和质点速度 $v(x,t)$ 的线性化连续性方程和动量方程描述：\n$$\\frac{\\partial \\rho}{\\partial t} + \\rho_{0}\\frac{\\partial v}{\\partial x} = 0,\\qquad \\rho_{0}\\frac{\\partial v}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0,$$\n以及线性状态方程 $p=c^{2}\\rho$。壁面的不渗透性要求法向速度边界条件为 $v(0,t)=0$ 对所有 $t$ 成立。\n\n根据这些定律，推导管道中 $p(x,t)$ 的标量波动方程，并证明刚性壁在 $x=0$ 处对 $p$ 施加了诺伊曼（Neumann）边界条件。在均匀网格 $x_{i}=i h$（其中 $i$ 为整数，$h>0$）上，令 $p_{i}(t)\\equiv p(x_{i},t)$ 表示节点压力。假设内部空间二阶导数使用标准的四阶中心五点格式进行离散化：\n$$\\left.\\frac{\\partial^{2} p}{\\partial x^{2}}\\right|_{x=x_{i}} \\approx \\frac{-p_{i+2}(t) + 16 p_{i+1}(t) - 30 p_{i}(t) + 16 p_{i-1}(t) - p_{i-2}(t)}{12 h^{2}},\\qquad i\\geq 2.$$\n为了在边界节点 $i=0$ 处应用此格式，需要两个虚拟点值 $p_{-1}(t)$ 和 $p_{-2}(t)$。仅使用上述基本定律、在 $x=0$ 附近的严格泰勒（Taylor）展开以及刚性壁条件的数学推论，确定虚拟点值 $p_{-1}(t)$ 和 $p_{-2}(t)$ 的线性表达式。这些表达式应表示为同一时刻 $t$ 的内部节点值的函数，与四阶精度的诺伊曼边界条件相符，并使得中心格式在 $i=0$ 处能达到完全的四阶精度。\n\n按顺序报告您最终的 $p_{-1}(t)$ 和 $p_{-2}(t)$ 的表达式，形式为仅包含 $p_{1}(t)$ 和 $p_{2}(t)$ 的闭式解析表达式。不需要进行数值计算。如果您使用时间层级为 $t^{n}$ 的离散时间表示，您可以统一使用 $p_{i}^{n}$ 代替 $p_{i}(t)$，但所要求的最终表达式形式保持不变。将最终答案表示为无单位的解析表达式。",
            "solution": "用户提供了一个计算声学问题，要求推导一维声学波动方程、刚性壁处的相应边界条件，以及确定一个高阶有限差分格式的虚拟点值。\n\n### 第1步：波动方程与边界条件的推导\n\n问题提供了均匀静止流体中的线性化一维连续性方程和动量方程，以及一个线性状态方程：\n1.  连续性方程：$\\frac{\\partial \\rho}{\\partial t} + \\rho_{0}\\frac{\\partial v}{\\partial x} = 0$\n2.  动量方程：$\\rho_{0}\\frac{\\partial v}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0$\n3.  状态方程：$p = c^{2}\\rho$\n\n这里，$p(x,t)$ 是声压，$\\rho(x,t)$ 是声学密度扰动，$v(x,t)$ 是质点速度，$\\rho_0$ 是平均流体密度，$c$ 是声速。\n\n首先，我们推导压力 $p(x,t)$ 的标量波动方程。根据状态方程 (3)，由于 $c$ 和 $\\rho$ 是扰动量，我们可以写出 $\\rho = p/c^2$。假设 $c$ 是常数，对其求时间导数得到 $\\frac{\\partial \\rho}{\\partial t} = \\frac{1}{c^2}\\frac{\\partial p}{\\partial t}$。将此式代入连续性方程 (1)：\n$$\n\\frac{1}{c^2}\\frac{\\partial p}{\\partial t} + \\rho_{0}\\frac{\\partial v}{\\partial x} = 0\n$$\n为了消去速度 $v$，我们可以对上述方程求时间导数，并对动量方程 (2) 求空间导数：\n$$\n\\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} + \\rho_{0}\\frac{\\partial^2 v}{\\partial t \\partial x} = 0\n$$\n$$\n\\rho_{0}\\frac{\\partial^2 v}{\\partial x \\partial t} + \\frac{\\partial^2 p}{\\partial x^2} = 0\n$$\n假设声场变量足够光滑，求导顺序无关，因此 $\\frac{\\partial^2 v}{\\partial t \\partial x} = \\frac{\\partial^2 v}{\\partial x \\partial t}$。从第二个求导后的方程中，我们分离出混合导数项：$\\rho_{0}\\frac{\\partial^2 v}{\\partial x \\partial t} = -\\frac{\\partial^2 p}{\\partial x^2}$。将其代入第一个求导后的方程得到：\n$$\n\\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} - \\frac{\\partial^2 p}{\\partial x^2} = 0\n$$\n整理后得到一维声压波动方程：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}\n$$\n接下来，我们推导在 $x=0$ 处刚性壁上的压力边界条件。刚性壁的不渗透性表述为 $v(0,t)=0$ 对所有时间 $t$ 成立。因为此条件对所有 $t$ 成立，其时间导数也必须为零：$\\frac{\\partial v}{\\partial t}(0,t)=0$。动量方程 (2) 必须在整个区域内成立，包括边界 $x=0$ 处：\n$$\n\\rho_{0}\\frac{\\partial v}{\\partial t}(0,t) + \\frac{\\partial p}{\\partial x}(0,t) = 0\n$$\n将 $\\frac{\\partial v}{\\partial t}(0,t)=0$ 代入此方程得到：\n$$\n\\frac{\\partial p}{\\partial x}(0,t) = 0\n$$\n这是在刚性壁上对压力 $p$ 的齐次诺伊曼（Neumann）边界条件。\n\n### 第2步：虚拟点值的确定\n\n问题要求找到虚拟点压力 $p_{-1}(t)$ 和 $p_{-2}(t)$ 的表达式，使得给定的中心五点格式在边界节点 $i=0$ 处应用时，仍能保持二阶导数的四阶精度。该格式为：\n$$\n\\left.\\frac{\\partial^{2} p}{\\partial x^{2}}\\right|_{x=x_i} \\approx \\frac{-p_{i+2} + 16 p_{i+1} - 30 p_{i} + 16 p_{i-1} - p_{i-2}}{12 h^{2}}\n$$\n确定虚拟点值的关键在于，将诺伊曼边界条件的全部含义与控制波动方程结合起来使用。如上所示，$\\frac{\\partial p}{\\partial x}(0,t) = 0$。\n\n当我们在 $x=0$ 处考察高阶空间导数时，会得出一个至关重要的推论。在刚性壁处，压力的所有奇数阶空间导数均为零。我们可以通过归纳法证明这一点。\n基础情况 ($k=0$)：$\\frac{\\partial p}{\\partial x}(0,t) = 0$，我们已经证明了这一点。\n归纳步骤：假设对于某个整数 $k \\ge 1$，有 $\\frac{\\partial^{2k-1} p}{\\partial x^{2k-1}}(0,t) = 0$。我们将波动方程对 $x$ 求 $(2k-1)$ 次导数：\n$$\n\\frac{\\partial}{\\partial x^{2k-1}}\\left(\\frac{\\partial^2 p}{\\partial t^2}\\right) = \\frac{\\partial}{\\partial x^{2k-1}}\\left(c^2 \\frac{\\partial^2 p}{\\partial x^2}\\right) \\implies \\frac{\\partial^2}{\\partial t^2}\\left(\\frac{\\partial^{2k-1} p}{\\partial x^{2k-1}}\\right) = c^2 \\frac{\\partial^{2k+1} p}{\\partial x^{2k+1}}\n$$\n在 $x=0$ 处求值：\n$$\n\\frac{\\partial^2}{\\partial t^2}\\left(\\frac{\\partial^{2k-1} p}{\\partial x^{2k-1}}(0,t)\\right) = c^2 \\frac{\\partial^{2k+1} p}{\\partial x^{2k+1}}(0,t)\n$$\n根据我们的归纳假设，$\\frac{\\partial^{2k-1} p}{\\partial x^{2k-1}}(0,t) = 0$ 对所有 $t$ 成立。因此，其二阶时间导数也为零。方程的左侧为零。\n$$\nc^2 \\frac{\\partial^{2k+1} p}{\\partial x^{2k+1}}(0,t) = 0 \\implies \\frac{\\partial^{2k+1} p}{\\partial x^{2k+1}}(0,t) = 0\n$$\n通过归纳法，压力 $p$ 的所有奇数阶空间导数在 $x=0$ 处对所有时间 $t$ 均为零。\n\n这个性质意味着 $p(x,t)$ 在 $x=0$ 附近的泰勒（Taylor）级数展开（对于固定的时间 $t$）只包含 $x$ 的偶数次幂：\n$$\np(x,t) = p(0,t) + \\frac{x^2}{2!}\\frac{\\partial^2 p}{\\partial x^2}(0,t) + \\frac{x^4}{4!}\\frac{\\partial^4 p}{\\partial x^4}(0,t) + \\dots\n$$\n这表明 $p(x,t)$ 是一个关于边界 $x=0$ 的空间坐标 $x$ 的偶函数。也就是说，$p(x,t) = p(-x,t)$。\n在离散网格 $x_i = ih$ 上，这个性质意味着：\n$$\np(ih, t) = p(-ih, t) \\implies p_i(t) = p_{-i}(t)\n$$\n对于所需的特定虚拟点，我们设 $i=1$ 和 $i=2$：\n$$\np_{-1}(t) = p_1(t)\n$$\n$$\np_{-2}(t) = p_2(t)\n$$\n这些就是所要求的虚拟点值 $p_{-1}(t)$ 和 $p_{-2}(t)$ 的线性表达式。\n\n### 第3步：精度验证\n\n为了严谨起见，我们必须验证这种虚拟点的选择是否在边界 $i=0$ 处保持了数值格式的四阶精度。我们将 $p_{-1}=p_1$ 和 $p_{-2}=p_2$ 代入 $i=0$ 处的格式：\n$$\n\\left.\\frac{\\partial^{2} p}{\\partial x^{2}}\\right|_{x=0} \\approx \\frac{-p_{2} + 16 p_{1} - 30 p_{0} + 16 p_{1} - p_{2}}{12 h^{2}} = \\frac{-2p_2 + 32p_1 - 30p_0}{12h^2} = \\frac{-p_2 + 16p_1 - 15p_0}{6h^2}\n$$\n让我们使用在 $x=0$ 附近的泰勒级数展开来分析这个单边格式的截断误差，并回顾所有奇数阶导数都为零。为简洁起见，我们记 $p^{(n)}_0 = \\frac{\\partial^n p}{\\partial x^n}(0,t)$。\n$$\np_1 = p_0 + \\frac{h^2}{2} p_0'' + \\frac{h^4}{24} p_0^{(4)} + \\frac{h^6}{720} p_0^{(6)} + O(h^8)\n$$\n$$\np_2 = p_0 + \\frac{(2h)^2}{2} p_0'' + \\frac{(2h)^4}{24} p_0^{(4)} + \\frac{(2h)^6}{720} p_0^{(6)} + O(h^8) = p_0 + 2h^2 p_0'' + \\frac{2h^4}{3} p_0^{(4)} + \\frac{8h^6}{90} p_0^{(6)} + O(h^8)\n$$\n将这些代入分子 $-p_2 + 16p_1 - 15p_0$ 中：\n分子 = $- (p_0 + 2h^2 p_0'' + \\frac{2h^4}{3} p_0^{(4)} + \\frac{8h^6}{90} p_0^{(6)}) + 16 (p_0 + \\frac{h^2}{2} p_0'' + \\frac{h^4}{24} p_0^{(4)} + \\frac{h^6}{720} p_0^{(6)}) - 15p_0 + O(h^8)$\n\n按 $h$ 的幂次收集各项：\n- $p_0$ 项：$(-1 + 16 - 15) p_0 = 0$\n- $p_0''$ 项：$(-2h^2 + 16\\frac{h^2}{2}) p_0'' = (-2+8)h^2 p_0'' = 6h^2 p_0''$\n- $p_0^{(4)}$ 项：$(-\\frac{2h^4}{3} + 16\\frac{h^4}{24}) p_0^{(4)} = (-\\frac{2}{3} + \\frac{2}{3})h^4 p_0^{(4)} = 0$\n- $p_0^{(6)}$ 项：$(-\\frac{8h^6}{90} + 16\\frac{h^6}{720}) p_0^{(6)} = (-\\frac{64}{720} + \\frac{16}{720})h^6 p_0^{(6)} = -\\frac{48}{720}h^6 p_0^{(6)} = -\\frac{h^6}{15}p_0^{(6)}$\n\n分子为 $6h^2 p_0'' - \\frac{h^6}{15}p_0^{(6)} + O(h^8)$。因此，该格式计算结果为：\n$$\n\\frac{6h^2 p_0'' - \\frac{h^6}{15}p_0^{(6)} + O(h^8)}{6h^2} = p_0'' - \\frac{h^4}{90}p_0^{(6)} + O(h^6)\n$$\n截断误差为 $O(h^4)$，这证实了应用简单的虚拟点关系式 $p_{-1}(t)=p_1(t)$ 和 $p_{-2}(t)=p_2(t)$ 成功地在诺伊曼边界上保持了内部格式的四阶精度。\n\n虚拟点值的最终表达式为：\n$p_{-1}(t) = p_1(t)$\n$p_{-2}(t) = p_2(t)$\n这些表达式按要求只涉及内部节点值 $p_1(t)$ 和 $p_2(t)$。",
            "answer": "$$\n\\boxed{\\begin{aligned} p_{-1}(t) = p_1(t) \\\\ p_{-2}(t) = p_2(t) \\end{aligned}}\n$$"
        },
        {
            "introduction": "最后的这个练习将探索有限元法（FEM）处理诺伊曼边界条件的优雅方式。您将推导亥姆霍兹方程的弱形式（或变分形式），并发现诺伊曼条件如何在该公式中作为“自然边界条件”出现。理解这一概念是现代计算声学的基础，因为它简化了实现过程，并为多样的边值问题提供了一个强大的框架。",
            "id": "4131580",
            "problem": "考虑在质量密度为常数 $\\rho_0$、声速为 $c$ 的均匀、无粘性流体中的时谐声学问题，其时间依赖关系为 $\\exp(-\\mathrm{i}\\omega t)$。声学质点速度表示为 $\\mathbf{u}(\\mathbf{x})$，声压表示为 $p(\\mathbf{x})$。控制线性化方程为频域连续性方程和频域动量平衡方程。绝对刚性（声硬）壁在边界上施加零法向质点速度条件。\n\n任务1（推导）：从这些基本定律和定义出发，推导声压的控制标量偏微分方程 (PDE)，然后通过与任意函数 $q \\in H^1(\\Omega)$ 作检验，得到其弱（变分）形式，其中 $H^1(\\Omega)$ 是在域 $\\Omega$ 上一阶导数平方可积的平方可积函数所构成的 Sobolev 空间。明确指出分部积分中出现的边界项，并解释在有限元 (FE) 方法的背景下，为什么它被称为自然边界条件。将刚性壁条件与此自然边界项联系起来。\n\n任务2（求值）：为具体化该弱形式，考虑一个无量纲方形域 $\\Omega = (0,1)\\times(0,1)$，其边界 $\\Gamma$ 上的外单位法向量为 $\\mathbf{n}$，并在整个 $\\Gamma$ 上施加刚性壁（声硬）边界条件。设无量纲波数为 $\\kappa = \\pi$。使用您推导的弱形式，对以下双线性形式进行求值：\n$$\na(p,q) \\;=\\; \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\,\\mathrm{d}\\Omega \\;-\\; \\kappa^{2} \\int_{\\Omega} p\\,q \\,\\mathrm{d}\\Omega\n$$\n其中选取 $p(x,y) = x(1-y)$ 和 $q(x,y) = x(1-y)$。您必须根据刚性壁的假设，谨慎处理与自然边界条件相关的边界贡献。将最终结果表示为单个闭式解析表达式。无需单位。不要四舍五入，请给出精确表达式。",
            "solution": "该问题经评估是有效的，因为它具有科学依据、自洽且适定。它构成了声学 Helmholtz 方程弱形式推导与应用的一个标准练习。\n\n**任务1：推导与解释**\n\n在均匀、无粘性流体中，时谐声学的基本控制定律是频域连续性方程和动量方程。我们首先陈述线性化的时域方程。设 $p'(\\mathbf{x}, t)$ 为声压扰动，$\\mathbf{u}'(\\mathbf{x}, t)$ 为质点速度，$\\rho'(\\mathbf{x}, t)$ 为密度扰动。恒定的环境密度为 $\\rho_0$，声速为 $c$。\n\n连续性方程（质量守恒）为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u}' = 0\n$$\n动量平衡方程（线性化 Euler 方程）为：\n$$\n\\rho_0 \\frac{\\partial \\mathbf{u}'}{\\partial t} = -\\nabla p'\n$$\n对于绝热过程，压力和密度扰动通过声速相关联：$p' = c^2 \\rho'$。将 $\\rho' = p'/c^2$ 代入连续性方程得到：\n$$\n\\frac{1}{c^2} \\frac{\\partial p'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u}' = 0\n$$\n我们假设时间依赖关系为时谐形式 $\\exp(-\\mathrm{i}\\omega t)$，其中 $\\omega$ 是角频率，$\\mathrm{i}$ 是虚数单位。因此，场可以写为 $p'(\\mathbf{x}, t) = p(\\mathbf{x})\\exp(-\\mathrm{i}\\omega t)$ 和 $\\mathbf{u}'(\\mathbf{x}, t) = \\mathbf{u}(\\mathbf{x})\\exp(-\\mathrm{i}\\omega t)$，其中 $p(\\mathbf{x})$ 和 $\\mathbf{u}(\\mathbf{x})$ 是复值空间振幅。时间导数 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $-\\mathrm{i}\\omega$。将此应用于两个控制方程，得到它们的频域对应形式：\n\n1.  连续性方程：\n    $$\n    -\\frac{\\mathrm{i}\\omega}{c^2} p + \\rho_0 \\nabla \\cdot \\mathbf{u} = 0 \\quad \\implies \\quad \\nabla \\cdot \\mathbf{u} = \\frac{\\mathrm{i}\\omega}{\\rho_0 c^2} p\n    $$\n2.  动量方程：\n    $$\n    -\\mathrm{i}\\omega \\rho_0 \\mathbf{u} = -\\nabla p \\quad \\implies \\quad \\mathbf{u} = \\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla p\n    $$\n\n为推导声压 $p$ 的单个标量偏微分方程，我们取动量方程的散度：\n$$\n\\nabla \\cdot \\mathbf{u} = \\nabla \\cdot \\left(\\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla p\\right) = \\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla^2 p\n$$\n然后，我们将此结果与连续性方程中的表达式相等，以消去 $\\nabla \\cdot \\mathbf{u}$：\n$$\n\\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla^2 p = \\frac{\\mathrm{i}\\omega}{\\rho_0 c^2} p\n$$\n乘以 $\\mathrm{i}\\omega \\rho_0$ 并整理各项得到：\n$$\n\\nabla^2 p = \\frac{(\\mathrm{i}\\omega)^2}{c^2} p = -\\frac{\\omega^2}{c^2} p\n$$\n这就得到了声压的标准 Helmholtz 方程：\n$$\n\\nabla^2 p + k^2 p = 0\n$$\n其中 $k = \\omega/c$ 是声波数。这就是声压振幅 $p(\\mathbf{x})$ 的控制标量偏微分方程。\n\n为得到弱（变分）形式，我们将 Helmholtz 方程乘以一个任意的检验函数 $q \\in H^1(\\Omega)$ 并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (\\nabla^2 p + k^2 p) q \\, \\mathrm{d}\\Omega = 0\n$$\n分开各项，我们有：\n$$\n\\int_{\\Omega} (\\nabla \\cdot (\\nabla p)) q \\, \\mathrm{d}\\Omega + \\int_{\\Omega} k^2 p q \\, \\mathrm{d}\\Omega = 0\n$$\n我们对第一项应用分部积分，使用 Green 第一恒等式：$\\int_{\\Omega} (\\nabla \\cdot \\mathbf{F}) \\phi \\, \\mathrm{d}\\Omega = \\int_{\\Gamma} \\phi (\\mathbf{F} \\cdot \\mathbf{n}) \\, \\mathrm{d}\\Gamma - \\int_{\\Omega} \\mathbf{F} \\cdot \\nabla \\phi \\, \\mathrm{d}\\Omega$。这里，我们设 $\\mathbf{F} = \\nabla p$ 和 $\\phi = q$。项 $\\nabla p \\cdot \\mathbf{n}$ 是法向导数 $\\frac{\\partial p}{\\partial n}$。\n$$\n\\int_{\\Omega} (\\nabla \\cdot (\\nabla p)) q \\, \\mathrm{d}\\Omega = \\int_{\\Gamma} q (\\nabla p \\cdot \\mathbf{n}) \\, \\mathrm{d}\\Gamma - \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega\n$$\n将此代回到积分方程中得到：\n$$\n-\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega + \\int_{\\Omega} k^2 p q \\, \\mathrm{d}\\Omega + \\int_{\\Gamma} q \\frac{\\partial p}{\\partial n} \\, \\mathrm{d}\\Gamma = 0\n$$\n整理成标准弱形式，我们寻找 $p \\in H^1(\\Omega)$，使得对于所有 $q \\in H^1(\\Omega)$：\n$$\n\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega - k^2 \\int_{\\Omega} p q \\, \\mathrm{d}\\Omega = \\int_{\\Gamma} q \\frac{\\partial p}{\\partial n} \\, \\mathrm{d}\\Gamma\n$$\n边界项是右侧的积分，$\\int_{\\Gamma} q \\frac{\\partial p}{\\partial n} \\, \\mathrm{d}\\Gamma$。这种涉及解变量导数（如 $\\frac{\\partial p}{\\partial n}$）的边界条件，在有限元 (FE) 方法的背景下被称为**自然边界条件**。这是因为它通过分部积分从变分公式中“自然”产生。它通过指定边界积分的值来施加，而不是通过显式约束允许解的空间。例如，如果我们在边界上指定 $\\frac{\\partial p}{\\partial n} = g$，则右侧变为 $\\int_{\\Gamma} q g \\, \\mathrm{d}\\Gamma$。如果我们不指定任何东西，该项被隐式地设为零，这自然地强制执行 $\\frac{\\partial p}{\\partial n} = 0$。\n\n现在，我们将物理上的刚性壁条件与此自然边界项联系起来。一个绝对刚性（声硬）壁意味着在边界 $\\Gamma$ 上质点速度的法向分量为零：\n$$\n\\mathbf{u} \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\Gamma\n$$\n使用频域动量方程 $\\mathbf{u} = \\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla p$，我们将其代入边界条件：\n$$\n\\left(\\frac{1}{\\mathrm{i}\\omega \\rho_0} \\nabla p\\right) \\cdot \\mathbf{n} = 0\n$$\n由于 $\\mathrm{i}$、$\\omega$ 和 $\\rho_0$ 是非零常数，这直接意味着：\n$$\n\\nabla p \\cdot \\mathbf{n} = 0 \\quad \\text{or} \\quad \\frac{\\partial p}{\\partial n} = 0\n$$\n这是压力 $p$ 的齐次 Neumann 边界条件。将此条件代入弱形式的边界项中，导致该积分为零：\n$$\n\\int_{\\Gamma} q \\frac{\\partial p}{\\partial n} \\, \\mathrm{d}\\Gamma = \\int_{\\Gamma} q (0) \\, \\mathrm{d}\\Gamma = 0\n$$\n因此，对于由刚性壁包围的域，弱形式简化为寻找 $p \\in H^1(\\Omega)$，使得对于所有 $q \\in H^1(\\Omega)$：\n$$\n\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega - k^2 \\int_{\\Omega} p q \\, \\mathrm{d}\\Omega = 0\n$$\n\n**任务2：求值**\n\n我们被要求在一个具体情况下计算双线性形式 $a(p,q)$：\n$$\na(p,q) = \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\,\\mathrm{d}\\Omega - \\kappa^{2} \\int_{\\Omega} p\\,q \\,\\mathrm{d}\\Omega\n$$\n问题指定了一个无量纲公式，其中波数由 $\\kappa$ 表示。域是单位正方形 $\\Omega = (0,1)\\times(0,1)$，波数为 $\\kappa = \\pi$，函数为 $p(x,y) = x(1-y)$ 和 $q(x,y) = x(1-y)$。$\\Gamma$ 上的边界条件是刚性壁，这证明了我们上面推导的双线性形式 $a(p,q)$ 的结构（即，没有边界积分项）是合理的。\n\n首先，我们计算被积函数的必要组成部分。\n由于 $p(x,y) = q(x,y) = x(1-y) = x - xy$，它们的梯度是相同的：\n$$\n\\nabla p = \\nabla q = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(x-xy) \\\\ \\frac{\\partial}{\\partial y}(x-xy) \\end{pmatrix} = \\begin{pmatrix} 1-y \\\\ -x \\end{pmatrix}\n$$\n梯度的点积是：\n$$\n\\nabla p \\cdot \\nabla q = (1-y)(1-y) + (-x)(-x) = (1-y)^2 + x^2 = 1 - 2y + y^2 + x^2\n$$\n函数的乘积是：\n$$\np(x,y)q(x,y) = (x(1-y))^2 = x^2 (1-y)^2 = x^2(1 - 2y + y^2)\n$$\n\n接下来，我们计算在域 $\\Omega$ 上的两个积分。\n第一个积分是：\n$$\n\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\,\\mathrm{d}\\Omega = \\int_0^1 \\int_0^1 (1 - 2y + y^2 + x^2) \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n首先对 $x$ 积分：\n$$\n\\int_0^1 (1 - 2y + y^2 + x^2) \\,\\mathrm{d}x = \\left[ (1 - 2y + y^2)x + \\frac{x^3}{3} \\right]_0^1 = (1 - 2y + y^2)(1) + \\frac{1^3}{3} - 0 = \\frac{4}{3} - 2y + y^2\n$$\n现在，对 $y$ 积分：\n$$\n\\int_0^1 \\left(\\frac{4}{3} - 2y + y^2\\right) \\,\\mathrm{d}y = \\left[ \\frac{4}{3}y - y^2 + \\frac{y^3}{3} \\right]_0^1 = \\left(\\frac{4}{3} - 1 + \\frac{1}{3}\\right) - 0 = \\frac{5}{3} - 1 = \\frac{2}{3}\n$$\n\n第二个积分是：\n$$\n\\int_{\\Omega} p\\,q \\,\\mathrm{d}\\Omega = \\int_0^1 \\int_0^1 x^2(1 - 2y + y^2) \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n这个积分是可分离的：\n$$\n\\int_0^1 \\int_0^1 x^2(1-y)^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = \\left( \\int_0^1 x^2 \\,\\mathrm{d}x \\right) \\left( \\int_0^1 (1-y)^2 \\,\\mathrm{d}y \\right)\n$$\n第一个因子是：\n$$\n\\int_0^1 x^2 \\,\\mathrm{d}x = \\left[ \\frac{x^3}{3} \\right]_0^1 = \\frac{1}{3}\n$$\n第二个因子是：\n$$\n\\int_0^1 (1-y)^2 \\,\\mathrm{d}y = \\left[ -\\frac{(1-y)^3}{3} \\right]_0^1 = \\left(-\\frac{(1-1)^3}{3}\\right) - \\left(-\\frac{(1-0)^3}{3}\\right) = 0 - \\left(-\\frac{1}{3}\\right) = \\frac{1}{3}\n$$\n因此，第二个积分的计算结果为：\n$$\n\\int_{\\Omega} p\\,q \\,\\mathrm{d}\\Omega = \\frac{1}{3} \\times \\frac{1}{3} = \\frac{1}{9}\n$$\n\n最后，我们使用 $\\kappa = \\pi$（因此 $\\kappa^2 = \\pi^2$）来组合 $a(p,q)$ 的表达式：\n$$\na(p,q) = \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\,\\mathrm{d}\\Omega - \\kappa^{2} \\int_{\\Omega} p\\,q \\,\\mathrm{d}\\Omega = \\frac{2}{3} - \\pi^2 \\left(\\frac{1}{9}\\right)\n$$\n$$\na(p,q) = \\frac{2}{3} - \\frac{\\pi^2}{9} = \\frac{6}{9} - \\frac{\\pi^2}{9} = \\frac{6-\\pi^2}{9}\n$$\n这是最终的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{6 - \\pi^2}{9}}\n$$"
        }
    ]
}