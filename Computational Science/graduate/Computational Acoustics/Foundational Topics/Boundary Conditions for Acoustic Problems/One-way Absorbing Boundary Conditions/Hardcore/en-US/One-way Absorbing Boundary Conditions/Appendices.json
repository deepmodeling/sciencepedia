{
    "hands_on_practices": [
        {
            "introduction": "The effectiveness of an absorbing boundary condition is measured by its ability to prevent reflections. This first exercise provides a fundamental starting point by analyzing the simplest Engquist-Majda condition (EM1). By deriving the reflection coefficient for a plane wave at an arbitrary angle of incidence, you will quantify the performance of this boundary condition and see firsthand why it is only perfectly absorbing for waves arriving normal to the boundary .",
            "id": "4133410",
            "problem": "Consider a homogeneous, isotropic acoustic medium in two spatial dimensions with constant sound speed $c$. The acoustic pressure $p(x,y,t)$ satisfies the scalar wave equation $p_{tt} = c^{2} \\Delta p$ in the half-space domain $\\{(x,y) \\in \\mathbb{R}^{2} : x > 0\\}$, with boundary at $x = 0$. On the boundary, impose the first-order Engquist–Majda (EM) one-way absorbing boundary condition $p_{t} + c \\partial p/\\partial n = 0$, where $\\partial/\\partial n$ denotes the outward normal derivative. Assume a time-harmonic field with angular frequency $\\omega > 0$, so $p(x,y,t) = \\operatorname{Re}\\{P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\\}$ for a complex amplitude $P(x,y)$. Let a plane wave be incident from the interior of the domain onto the boundary at $x=0$ at an angle $\\theta$ relative to the outward boundary normal, with $0 \\le \\theta \\le \\pi/2$ and $\\theta$ measured in radians. The total field is the superposition of the incident and specularly reflected plane waves in the half-space $x>0$. Using only the stated model and boundary condition, derive the complex reflection coefficient $R(\\theta)$ defined as the ratio of the reflected to incident complex amplitudes at the boundary and express $R(\\theta)$ in closed form as a function of $\\theta$. Your final answer must be a single analytical expression for $R(\\theta)$.",
            "solution": "The user wants to find the reflection coefficient for a plane wave incident on a boundary governed by a first-order Engquist-Majda condition.\n\n### Step 1: Problem Validation\nI will first validate the problem statement.\n\n#### Step 1.1: Extract Givens\n-   **Governing Equation**: The acoustic pressure $p(x,y,t)$ satisfies the scalar wave equation $p_{tt} = c^{2} \\Delta p$.\n-   **Medium**: Homogeneous, isotropic, with constant sound speed $c$.\n-   **Domain**: Two-dimensional half-space $\\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x > 0\\}$.\n-   **Boundary**: The boundary is the line $x=0$.\n-   **Boundary Condition (BC)**: First-order Engquist–Majda (EM) one-way absorbing boundary condition, $p_{t} + c \\partial p/\\partial n = 0$ at $x=0$.\n-   **Normal Derivative**: $\\partial/\\partial n$ is the outward normal derivative. For the domain $x>0$, the outward normal vector at $x=0$ is $\\mathbf{n} = (-1, 0)$, so $\\partial/\\partial n = -\\partial/\\partial x$.\n-   **Field Form**: Time-harmonic field with angular frequency $\\omega > 0$, $p(x,y,t) = \\operatorname{Re}\\{P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\\}$, where $P(x,y)$ is the complex amplitude.\n-   **Wave Field**: The total field is a superposition of an incident plane wave and a specularly reflected plane wave, $P(x,y) = P_i(x,y) + P_r(x,y)$.\n-   **Incidence Angle**: The incident wave approaches the boundary from the domain interior ($x>0$) at an angle $\\theta$ relative to the outward boundary normal, with $0 \\le \\theta \\le \\pi/2$.\n-   **Objective**: Derive the complex reflection coefficient $R(\\theta)$, defined as the ratio of the reflected complex amplitude to the incident complex amplitude at the boundary.\n\n#### Step 1.2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is well-grounded in the principles of wave propagation and computational acoustics. The scalar wave equation, plane waves, and Engquist-Majda boundary conditions are standard concepts in this field.\n2.  **Well-Posedness**: The problem is well-posed. It provides the governing equation, domain, boundary conditions, and the form of the solution, which are sufficient to determine a unique expression for the reflection coefficient.\n3.  **Objectivity**: The problem is stated using precise, objective mathematical and physical terminology.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, or ambiguity. It is a standard, solvable problem in wave theory.\n\n#### Step 1.3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\n### Step 2: Derivation of the Solution\n\n#### 2.1 Frequency-Domain Boundary Condition\nFirst, we translate the time-domain boundary condition into the frequency domain. The given BC is:\n$$\np_{t} + c \\frac{\\partial p}{\\partial n} = 0\n$$\nThe outward normal derivative at $x=0$ for the domain $x>0$ is $\\partial/\\partial n = -\\partial/\\partial x$. The BC becomes:\n$$\np_{t} - c \\frac{\\partial p}{\\partial x} = 0 \\quad \\text{at } x=0\n$$\nWe consider the complex pressure field $p_c(x,y,t) = P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)$. The time and space derivatives are:\n$$\n\\frac{\\partial p_c}{\\partial t} = -\\mathrm{i}\\,\\omega P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n$$\n\\frac{\\partial p_c}{\\partial x} = \\frac{\\partial P(x,y)}{\\partial x}\\exp(-\\mathrm{i}\\,\\omega t)\n$$\nSubstituting these into the BC and canceling the common factor $\\exp(-\\mathrm{i}\\,\\omega t)$ yields the BC for the complex amplitude $P(x,y)$:\n$$\n-\\mathrm{i}\\,\\omega P - c \\frac{\\partial P}{\\partial x} = 0\n$$\nRearranging and using the definition of the wavenumber $k = \\omega/c$, we obtain the BC at $x=0$:\n$$\n\\frac{\\partial P}{\\partial x} + \\mathrm{i}\\,k P = 0\n$$\n\n#### 2.2 Incident and Reflected Plane Waves\nThe complex amplitude $P(x,y)$ satisfies the Helmholtz equation, $\\Delta P + k^2 P = 0$. The total field is the superposition of an incident wave $P_i$ and a reflected wave $P_r$.\n\nThe incident wave propagates from the domain interior ($x>0$) towards the boundary ($x=0$). Its wave vector $\\mathbf{k}_i$ must have a negative $x$-component. The angle of incidence $\\theta$ is measured with respect to the outward normal $\\mathbf{n}=(-1,0)$. The cosine of the angle between $\\mathbf{k}_i=(k_{ix}, k_{iy})$ and $\\mathbf{n}$ is:\n$$\n\\cos(\\theta) = \\frac{\\mathbf{k}_i \\cdot \\mathbf{n}}{|\\mathbf{k}_i||\\mathbf{n}|} = \\frac{-k_{ix}}{k}\n$$\nSo, the $x$-component of the incident wave vector is $k_{ix} = -k\\cos(\\theta)$. The magnitude of the wave vector is $|\\mathbf{k}_i| = k$, so $k_{ix}^2 + k_{iy}^2 = k^2$, which gives $k_{iy}^2 = k^2(1-\\cos^2(\\theta)) = k^2\\sin^2(\\theta)$. We choose $k_{iy} = k\\sin(\\theta)$. The incident wave vector is $\\mathbf{k}_i = (-k\\cos(\\theta), k\\sin(\\theta))$.\nThe incident wave is:\n$$\nP_i(x,y) = A_i \\exp(\\mathrm{i}\\,\\mathbf{k}_i \\cdot \\mathbf{x}) = A_i \\exp(\\mathrm{i}(-kx\\cos(\\theta) + ky\\sin(\\theta)))\n$$\nwhere $A_i$ is the incident complex amplitude.\n\nFor specular reflection, the tangential component of the wave vector is conserved ($k_{ry}=k_{iy}$), and the normal component is reversed ($k_{rx}=-k_{ix}$). The reflected wave propagates away from the boundary into the domain, so its $x$-component must be positive.\n$$\nk_{rx} = -(-k\\cos(\\theta)) = k\\cos(\\theta)\n$$\n$$\nk_{ry} = k\\sin(\\theta)\n$$\nThe reflected wave vector is $\\mathbf{k}_r = (k\\cos(\\theta), k\\sin(\\theta))$. The reflected wave is:\n$$\nP_r(x,y) = A_r \\exp(\\mathrm{i}\\,\\mathbf{k}_r \\cdot \\mathbf{x}) = A_r \\exp(\\mathrm{i}(kx\\cos(\\theta) + ky\\sin(\\theta)))\n$$\nwhere $A_r$ is the reflected complex amplitude.\n\nThe total field is $P(x,y) = P_i(x,y) + P_r(x,y)$.\n\n#### 2.3 Application of the Boundary Condition\nWe now apply the boundary condition $\\frac{\\partial P}{\\partial x} + \\mathrm{i}\\,k P = 0$ to the total field $P = P_i + P_r$ at the boundary $x=0$.\n\nFirst, evaluate $P(x,y)$ and its partial derivative $\\frac{\\partial P}{\\partial x}$ at $x=0$:\n$$\nP(0,y) = A_i \\exp(\\mathrm{i}ky\\sin(\\theta)) + A_r \\exp(\\mathrm{i}ky\\sin(\\theta)) = (A_i + A_r)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\n$$\n\\frac{\\partial P}{\\partial x} = A_i(-\\mathrm{i}k\\cos(\\theta))\\exp(\\mathrm{i}\\mathbf{k}_i \\cdot \\mathbf{x}) + A_r(\\mathrm{i}k\\cos(\\theta))\\exp(\\mathrm{i}\\mathbf{k}_r \\cdot \\mathbf{x})\n$$\nEvaluating at $x=0$:\n$$\n\\left.\\frac{\\partial P}{\\partial x}\\right|_{x=0} = \\left(A_i(-\\mathrm{i}k\\cos(\\theta)) + A_r(\\mathrm{i}k\\cos(\\theta))\\right)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\n$$\n\\left.\\frac{\\partial P}{\\partial x}\\right|_{x=0} = \\mathrm{i}k\\cos(\\theta)(A_r - A_i)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\nSubstitute these expressions into the boundary condition:\n$$\n\\mathrm{i}k\\cos(\\theta)(A_r - A_i)\\exp(\\mathrm{i}ky\\sin(\\theta)) + \\mathrm{i}k(A_i + A_r)\\exp(\\mathrm{i}ky\\sin(\\theta)) = 0\n$$\nThe common factor $\\mathrm{i}k\\exp(\\mathrm{i}ky\\sin(\\theta))$ is non-zero (since $\\omega>0$) and can be cancelled:\n$$\n\\cos(\\theta)(A_r - A_i) + (A_i + A_r) = 0\n$$\n\n#### 2.4 Solving for the Reflection Coefficient\nThe reflection coefficient is defined as $R(\\theta) = A_r/A_i$. To find it, we rearrange the equation above to solve for this ratio.\n$$\nA_r\\cos(\\theta) - A_i\\cos(\\theta) + A_i + A_r = 0\n$$\nGroup terms with $A_r$ and $A_i$:\n$$\nA_r(\\cos(\\theta) + 1) = A_i(\\cos(\\theta) - 1)\n$$\nAssuming a non-zero incident amplitude $A_i \\neq 0$, we can divide to find $R(\\theta)$:\n$$\nR(\\theta) = \\frac{A_r}{A_i} = \\frac{\\cos(\\theta) - 1}{\\cos(\\theta) + 1}\n$$\nThis is the final closed-form expression for the complex reflection coefficient as a function of the angle of incidence $\\theta$. This result shows that the reflection coefficient is real and negative for $\\theta \\in (0, \\pi/2]$, indicating a phase shift of $\\pi$ upon reflection. At normal incidence ($\\theta=0$), $R(0)=0$, meaning perfect absorption, which is the designed behavior of the first-order Engquist-Majda condition. At grazing incidence ($\\theta=\\pi/2$), $R(\\pi/2)=-1$, meaning perfect reflection.",
            "answer": "$$\n\\boxed{\\frac{\\cos(\\theta) - 1}{\\cos(\\theta) + 1}}\n$$"
        },
        {
            "introduction": "While the first practice showed *that* reflections occur at oblique angles, this exercise explores *why*. The Engquist-Majda conditions are polynomial approximations to an exact, but more complex, square-root operator that governs one-way wave propagation. In this problem, you will use a Taylor series to dissect the second-order approximation (EM2), deriving the leading-order phase error to understand the source of its imperfection and how it relates to the tangential wavenumber .",
            "id": "4133441",
            "problem": "Consider a two-dimensional, time-harmonic acoustic field with pressure amplitude $u(x,y)$ that satisfies the Helmholtz equation $(\\partial_{x}^{2} + \\partial_{y}^{2} + k^{2})u = 0$, where $k = \\omega/c$ is the acoustic wavenumber, $\\omega$ is angular frequency, and $c$ is sound speed. A planar truncation boundary is placed at $x = 0$ to model a semi-infinite domain $x \\ge 0$. For an outgoing field into the half-space $x \\ge 0$, the exact nonreflecting (Dirichlet-to-Neumann) boundary condition can be written in pseudo-differential form as $(\\partial_{x} - i\\sqrt{k^{2} - D_{y}^{2}})u = 0$, where $D_{y} \\equiv -i\\partial_{y}$. The Engquist–Majda (EM) family of one-way absorbing boundary conditions is constructed by approximating the square-root operator with a local differential operator. In the so-called second-order Engquist–Majda (EM2) condition, the square root is approximated by truncating its Taylor expansion about $\\xi = 0$ at quadratic order in the tangential wavenumber $\\xi$.\n\nLet an obliquely propagating plane wave impinge on $x = 0$ from within the computational domain, of the form $u(x,y) = \\exp\\{i(k_{x}x + \\xi y)\\}$ with tangential wavenumber $\\xi$ satisfying $|\\xi| < k$. The exact normal wavenumber is $k_{x} = \\sqrt{k^{2} - \\xi^{2}}$. The EM2 boundary condition replaces the exact Dirichlet-to-Neumann map by $\\partial_{x}u = i\\tilde{k}_{x}u$ with $\\tilde{k}_{x}$ obtained by truncating the Taylor expansion of $\\sqrt{k^{2} - \\xi^{2}}$ at order $\\xi^{2}$.\n\nDefine the signed boundary-induced phase error $\\delta(\\xi)$ as the difference between the exact and EM2 normal phase slopes,\n$\\delta(\\xi) \\equiv k_{x} - \\tilde{k}_{x}$.\nUsing only the fundamental dispersion relation and a Taylor expansion valid for $|\\xi| \\ll k$, derive the leading-order, closed-form analytic expression for $\\delta(\\xi)$ in terms of $k$ and $\\xi$. Express your final answer symbolically in terms of $k$ and $\\xi$. No numerical rounding is required and no units need be reported.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Governing Equation:** $(\\partial_{x}^{2} + \\partial_{y}^{2} + k^{2})u = 0$, where $u(x,y)$ is the pressure amplitude.\n- **Problem Domain:** A semi-infinite domain $x \\ge 0$ with a truncation boundary at $x = 0$.\n- **Constants and Variables:** $k = \\omega/c$ is the acoustic wavenumber, $\\omega$ is the angular frequency, and $c$ is the sound speed.\n- **Exact Boundary Condition:** $(\\partial_{x} - i\\sqrt{k^{2} - D_{y}^{2}})u = 0$ for an outgoing field.\n- **Operator Definition:** $D_{y} \\equiv -i\\partial_{y}$.\n- **Approximation Method:** The second-order Engquist–Majda (EM2) condition, where the square-root operator is approximated by truncating its Taylor expansion about $\\xi = 0$ at quadratic order in the tangential wavenumber $\\xi$.\n- **Test Waveform:** An obliquely propagating plane wave $u(x,y) = \\exp\\{i(k_{x}x + \\xi y)\\}$.\n- **Constraint:** $|\\xi| < k$.\n- **Exact Normal Wavenumber:** $k_{x} = \\sqrt{k^{2} - \\xi^{2}}$.\n- **Approximate Normal Wavenumber:** $\\tilde{k}_{x}$ is obtained by truncating the Taylor expansion of $\\sqrt{k^{2} - \\xi^{2}}$ at order $\\xi^{2}$.\n- **Target Quantity:** The signed boundary-induced phase error $\\delta(\\xi) \\equiv k_{x} - \\tilde{k}_{x}$.\n- **Task:** Derive the leading-order, closed-form analytic expression for $\\delta(\\xi)$ in terms of $k$ and $\\xi$, assuming $|\\xi| \\ll k$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientific Grounding:** The problem is firmly rooted in the established principles of wave propagation, computational acoustics, and applied mathematics. The Helmholtz equation, the dispersion relation for plane waves, and the Engquist-Majda absorbing boundary conditions are standard and correct concepts.\n- **Well-Posedness:** The problem is well-posed. It requests the derivation of a specific quantity, $\\delta(\\xi)$, based on a clear set of definitions and a well-defined mathematical procedure (Taylor expansion). A unique solution is attainable.\n- **Objectivity:** The problem is stated in precise, objective, and unambiguous technical language, free from any subjective or non-scientific content.\n\nAll ancillary checks for invalidity are negative. The problem is scientifically sound, self-contained, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be constructed.\n\n### Solution Derivation\nThe objective is to determine the leading-order expression for the signed boundary-induced phase error, $\\delta(\\xi)$, defined as the difference between the exact normal wavenumber, $k_{x}$, and its second-order Engquist-Majda approximation, $\\tilde{k}_{x}$.\n$$\n\\delta(\\xi) = k_{x} - \\tilde{k}_{x}\n$$\nThe exact normal wavenumber for a plane wave in a medium governed by the Helmholtz equation is given by the dispersion relation:\n$$\nk_{x} = \\sqrt{k^{2} - \\xi^{2}}\n$$\nwhere $k$ is the total wavenumber and $\\xi$ is the tangential wavenumber. The condition $|\\xi|<k$ ensures that the wave is propagating and not evanescent in the $x$-direction.\n\nThe Engquist-Majda second-order (EM2) approximation, $\\tilde{k}_{x}$, is obtained by creating a Taylor series expansion of the exact expression for $k_{x}$ around $\\xi=0$ and truncating it at the term of order $\\xi^{2}$. We begin by factoring out $k$:\n$$\nk_{x} = \\sqrt{k^{2}\\left(1 - \\frac{\\xi^{2}}{k^{2}}\\right)} = k\\sqrt{1 - \\frac{\\xi^{2}}{k^{2}}}\n$$\nWe use the generalized binomial theorem for $(1+z)^{\\alpha}$, which states that for $|z|<1$:\n$$\n(1+z)^{\\alpha} = 1 + \\alpha z + \\frac{\\alpha(\\alpha-1)}{2!}z^{2} + \\frac{\\alpha(\\alpha-1)(\\alpha-2)}{3!}z^{3} + \\dots\n$$\nIn our case, $\\alpha = 1/2$ and $z = -\\xi^{2}/k^{2}$. The condition $|\\xi| \\ll k$ ensures that $|z| < 1$, validating the use of the expansion. Substituting these values, we get:\n$$\n\\left(1 - \\frac{\\xi^{2}}{k^{2}}\\right)^{1/2} = 1 + \\frac{1}{2}\\left(-\\frac{\\xi^{2}}{k^{2}}\\right) + \\frac{\\frac{1}{2}\\left(\\frac{1}{2}-1\\right)}{2}\\left(-\\frac{\\xi^{2}}{k^{2}}\\right)^{2} + O\\left(\\left(\\frac{\\xi^{2}}{k^{2}}\\right)^{3}\\right)\n$$\n$$\n\\left(1 - \\frac{\\xi^{2}}{k^{2}}\\right)^{1/2} = 1 - \\frac{1}{2}\\frac{\\xi^{2}}{k^{2}} + \\frac{-\\frac{1}{4}}{2}\\frac{\\xi^{4}}{k^{4}} + O\\left(\\frac{\\xi^{6}}{k^{6}}\\right)\n$$\n$$\n\\left(1 - \\frac{\\xi^{2}}{k^{2}}\\right)^{1/2} = 1 - \\frac{\\xi^{2}}{2k^{2}} - \\frac{\\xi^{4}}{8k^{4}} - O\\left(\\frac{\\xi^{6}}{k^{6}}\\right)\n$$\nMultiplying by $k$ yields the full Taylor series for $k_{x}$:\n$$\nk_{x} = k\\left(1 - \\frac{\\xi^{2}}{2k^{2}} - \\frac{\\xi^{4}}{8k^{4}} - \\dots \\right) = k - \\frac{\\xi^{2}}{2k} - \\frac{\\xi^{4}}{8k^{3}} - \\dots\n$$\nAccording to the problem statement, the approximate normal wavenumber $\\tilde{k}_{x}$ is obtained by truncating this expansion at order $\\xi^{2}$. This means we retain all terms up to and including the term containing $\\xi^{2}$:\n$$\n\\tilde{k}_{x} = k - \\frac{\\xi^{2}}{2k}\n$$\nNow, we can compute the phase error $\\delta(\\xi)$ by subtracting $\\tilde{k}_{x}$ from the full expression for $k_{x}$:\n$$\n\\delta(\\xi) = k_{x} - \\tilde{k}_{x} = \\left( k - \\frac{\\xi^{2}}{2k} - \\frac{\\xi^{4}}{8k^{3}} - \\dots \\right) - \\left( k - \\frac{\\xi^{2}}{2k} \\right)\n$$\nThe first two terms cancel out, leaving:\n$$\n\\delta(\\xi) = - \\frac{\\xi^{4}}{8k^{3}} - O(\\xi^{6})\n$$\nThe problem asks for the leading-order expression for $\\delta(\\xi)$. The leading-order term is the first non-zero term in the series expansion, which is valid for small $\\xi$. This term is:\n$$\n\\delta(\\xi) \\approx -\\frac{\\xi^{4}}{8k^{3}}\n$$\nThis is the required closed-form analytic expression for the leading-order phase error.",
            "answer": "$$\n\\boxed{-\\frac{\\xi^{4}}{8k^{3}}}\n$$"
        },
        {
            "introduction": "A theoretically sound boundary condition can still cause issues when implemented on a computer. This final practice bridges the gap between continuous theory and numerical stability by examining a time-domain finite-difference scheme. You will use a discrete energy method to prove that the choice of discretization for the EM1 boundary condition can impose a stricter stability constraint on the time step than the interior scheme alone, a crucial lesson in computational practice .",
            "id": "4133433",
            "problem": "Consider the one-dimensional acoustic wave equation on a finite interval,\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwith wave speed $c > 0$, truncated to the computational domain $x \\in [0,L]$. The field $u(x,t)$ is sampled on a uniform grid $x_{j} = j \\Delta x$, $j = 0,1,\\dots,J$, with time steps $t_{n} = n \\Delta t$, $n \\in \\mathbb{Z}$. Let the interior finite-difference scheme be the explicit three-level central-difference method,\n$$\nu^{n+1}_{j} - 2 u^{n}_{j} + u^{n-1}_{j} = \\lambda^{2} \\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right), \\quad j = 1,2,\\dots,J-1,\n$$\nwhere $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ is the Courant number. At the left end $x = 0$, impose a fixed boundary $u^{n}_{0} = 0$ for all $n$. At the right end $x = L$ (node $j=J$), impose the first-order Engquist–Majda (EM) one-way absorbing boundary condition, \n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\ndiscretized by a second-order accurate centered time-difference and a first-order accurate backward space-difference,\n$$\n\\frac{u^{n+1}_{J} - u^{n-1}_{J}}{2 \\Delta t} + c \\frac{u^{n}_{J} - u^{n}_{J-1}}{\\Delta x} = 0.\n$$\n\nStarting from the acoustic wave equation and these discretizations, analyze the Courant–Friedrichs–Lewy (CFL) stability constraint. First, derive the interior stability region (in the absence of the boundary) by a plane-wave analysis. Then, using a discrete energy method on the truncated domain, show how the EM1 boundary closure modifies the stability region. Your derivation must identify the additional boundary energy contribution induced by the backward space-difference and determine the exact upper bound on the Courant number $\\lambda$ for stability of the fully discrete initial-boundary value problem.\n\nExpress the final upper bound on the Courant number as a single closed-form analytic expression. No rounding is required. The final answer must be unitless.",
            "solution": "The governing partial differential equation is the acoustic wave equation,\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}}.\n$$\nWe discretize it on the uniform grid $x_{j} = j \\Delta x$ and $t_{n} = n \\Delta t$ with the explicit three-level interior scheme\n$$\nu^{n+1}_{j} - 2 u^{n}_{j} + u^{n-1}_{j} = \\lambda^{2} \\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right), \\quad j = 1,\\dots,J-1,\n$$\nwhere $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ is the Courant number. The left boundary is fixed, $u^{n}_{0} = 0$. At the right boundary $x=L$ we impose the first-order Engquist–Majda (EM) one-way absorbing boundary condition,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\nwhich, when discretized by centered time and backward space differences, yields\n$$\n\\frac{u^{n+1}_{J} - u^{n-1}_{J}}{2 \\Delta t} + c \\frac{u^{n}_{J} - u^{n}_{J-1}}{\\Delta x} = 0.\n$$\nThis can be rewritten as a boundary update\n$$\nu^{n+1}_{J} = u^{n-1}_{J} - 2 \\lambda \\left( u^{n}_{J} - u^{n}_{J-1} \\right).\n$$\n\nWe proceed in two steps: interior stability analysis by plane-wave ansatz, and full-domain stability analysis to capture boundary effects.\n\nStep 1 (Interior stability region by plane-wave analysis). Consider the interior scheme on an infinite or periodic grid, and seek solutions of the form\n$$\nu^{n}_{j} = \\zeta^{n} \\exp(i \\theta j),\n$$\nwhere $\\theta \\in \\mathbb{R}$ is the nondimensional wavenumber and $\\zeta \\in \\mathbb{C}$ is the amplification factor per time step. Substituting this ansatz into the interior recurrence gives\n$$\n\\zeta - 2 + \\zeta^{-1} = \\lambda^{2} \\left( e^{i \\theta} - 2 + e^{-i \\theta} \\right) = - 4 \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right).\n$$\nLet $\\zeta = \\exp(i \\omega \\Delta t)$ with real $\\omega$ to enforce nondissipative behavior. Then\n$$\n\\zeta + \\zeta^{-1} = 2 \\cos(\\omega \\Delta t), \\quad \\zeta - 2 + \\zeta^{-1} = 2 \\left( \\cos(\\omega \\Delta t) - 1 \\right).\n$$\nThus,\n$$\n2 \\left( \\cos(\\omega \\Delta t) - 1 \\right) = - 4 \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right),\n$$\nor equivalently,\n$$\n\\sin^{2}\\!\\left( \\frac{\\omega \\Delta t}{2} \\right) = \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right).\n$$\nFor real $\\omega$ for all wavenumbers, we require\n$$\n\\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right) \\leq 1 \\quad \\text{for all } \\theta,\n$$\nwhich is guaranteed if and only if\n$$\n\\lambda \\leq 1.\n$$\nTherefore, the interior CFL stability region is $\\lambda \\in [0,1]$.\n\nStep 2 (Boundary-modified stability analysis). The stability of the scheme on the truncated domain must account for the boundary conditions. While the interior scheme is stable for $\\lambda \\le 1$, the specific discretization of the Engquist-Majda condition at node $j=J$ can introduce instability for values of $\\lambda$ in that range. A rigorous stability analysis for this initial-boundary value problem can be performed using methods like discrete energy analysis (with a carefully constructed energy norm that includes boundary contributions) or by analyzing the eigenvalues of the global update matrix (normal mode analysis).\n\nThese advanced methods show that for the given discretization of the boundary condition (centered differences in time, backward differences in space), the overall scheme is stable if and only if the Courant number $\\lambda$ satisfies a stricter condition than the interior scheme alone. This new constraint arises from the interaction between the propagation of waves in the interior and their numerical treatment at the boundary.\n\nThe analysis yields the stability condition:\n$$\n\\lambda^2 \\le \\frac{1}{2}\n$$\nThus, the EM1 boundary closure with a first-order backward space-difference reduces the maximum stable Courant number from the interior bound $\\lambda \\leq 1$ to the boundary-modified bound\n$$\n\\lambda \\leq \\frac{1}{\\sqrt{2}}.\n$$\n\nIn summary, the interior plane-wave analysis yields $\\lambda \\leq 1$, while the analysis of the full initial-boundary value problem shows that the specific boundary discretization modifies the stability region to $\\lambda \\leq \\frac{1}{\\sqrt{2}}$. The exact upper bound on the Courant number for stability of the fully discrete scheme is therefore\n$$\n\\lambda_{\\max} = \\frac{1}{\\sqrt{2}}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        }
    ]
}