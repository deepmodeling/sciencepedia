{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering the Sommerfeld Radiation Condition (SRC) is to see it in action. In this practice, we tackle a classic acoustic scattering problem: a plane wave interacting with a sound-soft sphere. Solving the Helmholtz equation in the region outside the sphere yields a general mathematical solution, but the SRC is the critical physical principle that allows us to select the unique solution corresponding to waves radiating away from the object. This exercise provides direct, hands-on experience in using the SRC to choose the appropriate basis functions—outgoing spherical Hankel functions—to construct a physically meaningful scattered field. ",
            "id": "4144658",
            "problem": "Consider time-harmonic acoustic scattering in three spatial dimensions, where the total acoustic pressure field $u_{\\mathrm{tot}}$ satisfies the scalar Helmholtz equation $\\nabla^{2} u_{\\mathrm{tot}} + k^{2} u_{\\mathrm{tot}} = 0$ in the exterior of a sound-soft sphere of radius $a>0$. The material is homogeneous and lossless, with wavenumber $k>0$. A plane wave of the form $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$ is incident along the positive $z$-axis, so that the total field decomposes as $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$, where $u_{\\mathrm{scat}}$ is the scattered field. The boundary condition on the sphere is sound-soft (Dirichlet), i.e., $u_{\\mathrm{tot}}(r=a,\\theta,\\varphi) = 0$. The scattered field is required to satisfy the Sommerfeld radiation condition (SRC), defined by $\\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0$, which enforces purely outgoing waves at infinity.\n\nUsing separation of variables in spherical coordinates $(r,\\theta,\\varphi)$ and starting from the fundamental base comprising the Helmholtz equation and the Sommerfeld radiation condition (SRC), derive the far-field pattern $f(\\theta)$ of the scattered field, defined by the asymptotic relation\n$$\nu_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta) + o(r^{-1}), \\quad r \\to \\infty.\n$$\nShow how the radiation condition selects outgoing spherical Hankel functions in the radial part of the solution, and enforce the sound-soft boundary condition to determine the expansion coefficients. Express the final far-field pattern $f(\\theta)$ as a single closed-form analytic series in terms of the spherical Bessel functions $j_{\\ell}$ and the spherical Hankel functions of the first kind $h_{\\ell}^{(1)}$, evaluated at $k a$, and the Legendre polynomials $P_{\\ell}(\\cos\\theta)$. Your final answer must be a single symbolic mathematical expression for $f(\\theta)$. No numerical evaluation or rounding is required.",
            "solution": "The total acoustic pressure field $u_{\\mathrm{tot}}$ is decomposed into an incident field $u_{\\mathrm{inc}}$ and a scattered field $u_{\\mathrm{scat}}$ as $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$. Both $u_{\\mathrm{tot}}$ and $u_{\\mathrm{inc}}$ are solutions to the Helmholtz equation, $\\nabla^{2} u + k^{2} u = 0$. Due to the linearity of the operator $\\nabla^{2} + k^{2}$, the scattered field $u_{\\mathrm{scat}}$ must also satisfy the Helmholtz equation in the domain exterior to the sphere ($r > a$):\n$$ \\nabla^{2} u_{\\mathrm{scat}} + k^{2} u_{\\mathrm{scat}} = 0 $$\nThe incident field is a plane wave propagating along the positive $z$-axis, $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$. Both the incident field and the spherical scatterer are symmetric with respect to the $z$-axis. Consequently, the scattered field must also be azimuthally symmetric, i.e., $u_{\\mathrm{scat}}$ is a function of $r$ and $\\theta$ only, $u_{\\mathrm{scat}}(r, \\theta)$.\n\nWe seek a solution using the method of separation of variables in spherical coordinates. The general solution to the Helmholtz equation with azimuthal symmetry can be written as an expansion in terms of spherical harmonics with $m=0$, which are the Legendre polynomials $P_{\\ell}(\\cos\\theta)$:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} R_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\nHere, $R_{\\ell}(kr)$ represents the radial part of the solution, which must satisfy the spherical Bessel differential equation. The general solution for $R_{\\ell}(\\rho)$ is a linear combination of spherical Bessel functions of the first kind, $j_{\\ell}(\\rho)$, and of the second kind, $y_{\\ell}(\\rho)$. For scattering problems in an exterior domain, it is more convenient to use the basis of spherical Hankel functions:\n$$ h_{\\ell}^{(1)}(\\rho) = j_{\\ell}(\\rho) + i y_{\\ell}(\\rho) $$\n$$ h_{\\ell}^{(2)}(\\rho) = j_{\\ell}(\\rho) - i y_{\\ell}(\\rho) $$\nThus, the general form for the scattered field is:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} P_{\\ell}(\\cos\\theta) \\left( C_{\\ell} h_{\\ell}^{(1)}(kr) + D_{\\ell} h_{\\ell}^{(2)}(kr) \\right) $$\nThe coefficients $C_{\\ell}$ and $D_{\\ell}$ are determined by physical conditions at infinity. The scattered field $u_{\\mathrm{scat}}$ must represent waves propagating outwards from the scatterer. This is enforced by the Sommerfeld Radiation Condition (SRC):\n$$ \\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0 $$\nTo apply this condition, we examine the asymptotic behavior of the Hankel functions for large argument $\\rho = kr \\to \\infty$:\n$$ h_{\\ell}^{(1)}(\\rho) \\sim \\frac{1}{\\rho} (-i)^{\\ell+1} \\exp(i\\rho) = \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} $$\n$$ h_{\\ell}^{(2)}(\\rho) \\sim \\frac{1}{\\rho} (i)^{\\ell+1} \\exp(-i\\rho) = \\frac{\\exp(-ikr)}{kr} (i)^{\\ell+1} $$\nThe term $h_{\\ell}^{(1)}(kr)$ corresponds to an outgoing wave (phase factor $\\exp(ikr)$), while $h_{\\ell}^{(2)}(kr)$ corresponds to an incoming wave (phase factor $\\exp(-ikr)$).\n\nLet's test each type of wave against the SRC. For an outgoing wave component $u_{\\mathrm{out}} \\propto h_{\\ell}^{(1)}(kr)$:\n$$ \\frac{\\partial u_{\\mathrm{out}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( C \\frac{\\exp(ikr)}{r} \\right) = C \\left( \\frac{ik\\exp(ikr)}{r} - \\frac{\\exp(ikr)}{r^2} \\right) = iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} $$\nSubstituting this into the SRC expression:\n$$ \\lim_{r \\to \\infty} r \\left( \\left( iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} \\right) - i k u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} r \\left( -\\frac{1}{r}u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} (-u_{\\mathrm{out}}) = 0 $$\nsince $u_{\\mathrm{out}}$ decays as $1/r$. The outgoing waves satisfy the SRC.\n\nFor an incoming wave component $u_{\\mathrm{in}} \\propto h_{\\ell}^{(2)}(kr)$:\n$$ \\frac{\\partial u_{\\mathrm{in}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( D \\frac{\\exp(-ikr)}{r} \\right) = D \\left( \\frac{-ik\\exp(-ikr)}{r} - \\frac{\\exp(-ikr)}{r^2} \\right) = -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} $$\nSubstituting this into the SRC expression:\n$$ \\lim_{r \\to \\infty} r \\left( \\left( -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) - i k u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} r \\left( -2iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} (-2ikr u_{\\mathrm{in}} - u_{\\mathrm{in}}) $$\nSince $u_{\\mathrm{in}} \\propto \\exp(-ikr)/r$, the term $-2ikr u_{\\mathrm{in}}$ does not vanish as $r \\to \\infty$. Thus, incoming waves violate the SRC. Consequently, we must have $D_{\\ell} = 0$ for all $\\ell$. The scattered field must be composed solely of outgoing Hankel functions, $h_{\\ell}^{(1)}(kr)$:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\nThe unknown coefficients $A_{\\ell}$ are determined by the boundary condition on the surface of the sphere, $r=a$. The problem specifies a sound-soft sphere, which implies a Dirichlet boundary condition: $u_{\\mathrm{tot}}(a, \\theta) = 0$. This means:\n$$ u_{\\mathrm{inc}}(a, \\theta) + u_{\\mathrm{scat}}(a, \\theta) = 0 $$\nTo enforce this, we need the expansion of the incident plane wave $u_{\\mathrm{inc}} = \\exp(ikz) = \\exp(ikr\\cos\\theta)$ in Legendre polynomials. This is the well-known Rayleigh formula:\n$$ u_{\\mathrm{inc}}(r, \\theta) = \\exp(ikr\\cos\\theta) = \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\nNow, we apply the boundary condition at $r=a$:\n$$ \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(ka) P_{\\ell}(\\cos\\theta) + \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(ka) P_{\\ell}(\\cos\\theta) = 0 $$\nCombining the sums:\n$$ \\sum_{\\ell=0}^{\\infty} \\left[ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) \\right] P_{\\ell}(\\cos\\theta) = 0 $$\nDue to the orthogonality of the Legendre polynomials over the interval $[-1, 1]$, the coefficient of each $P_{\\ell}(\\cos\\theta)$ must be zero for all $\\ell$:\n$$ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) = 0 $$\nSolving for the coefficients $A_{\\ell}$:\n$$ A_{\\ell} = - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} $$\nSubstituting these coefficients back into the expansion for the scattered field gives the full solution:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\nThe far-field pattern $f(\\theta)$ is defined by the asymptotic relation $u_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta)$ as $r \\to \\infty$. To find $f(\\theta)$, we substitute the asymptotic form of $h_{\\ell}^{(1)}(kr)$ into our solution for $u_{\\mathrm{scat}}$:\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) \\left( \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) $$\nFactoring out the term $\\frac{\\exp(ikr)}{r}$:\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\frac{\\exp(ikr)}{r} \\left[ \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} \\left( i^{\\ell} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) \\right] $$\nThe term in the square brackets is the far-field pattern $f(\\theta)$. We simplify the complex number product:\n$$ i^{\\ell} (-i)^{\\ell+1} = i^{\\ell} (-1)^{\\ell+1} i^{\\ell+1} = (-1)^{\\ell+1} i^{2\\ell+1} = (-1)^{\\ell+1} (i^2)^{\\ell} i = (-1)^{\\ell+1} (-1)^{\\ell} i = (-1)^{2\\ell+1} i = -i $$\nSubstituting this result into the expression for $f(\\theta)$:\n$$ f(\\theta) = \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} (-i) P_{\\ell}(\\cos\\theta) $$\nThis simplifies to the final expression for the far-field pattern:\n$$ f(\\theta) = \\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta) $$\nThis is a closed-form analytic series in terms of the required special functions evaluated at $ka$ and the Legendre polynomials, as requested.",
            "answer": "$$\n\\boxed{\\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta)}\n$$"
        },
        {
            "introduction": "Beyond its mathematical utility, the Sommerfeld Radiation Condition is rooted in the fundamental physics of energy transport. This exercise provides a deeper justification for *why* the condition is necessary by connecting it directly to the flow of acoustic energy. By deriving the time-averaged acoustic intensity vector from first principles, you will demonstrate that a field satisfying the SRC correctly models energy radiating outwards, while a mathematically valid but physically incorrect \"incoming\" wave corresponds to an unphysical inward flow of energy from infinity. ",
            "id": "4144667",
            "problem": "Consider small-amplitude, time-harmonic acoustic motion in a homogeneous, inviscid, compressible fluid of constant mass density $\\rho$ and sound speed $c$. Let the acoustic pressure be written in complex form as $p(\\mathbf{x},t)=\\Re\\{u(\\mathbf{x})\\exp(-i\\omega t)\\}$, where $\\omega>0$ is the angular frequency and $u$ is the complex amplitude that satisfies the scalar Helmholtz equation $(\\Delta + k^{2})u=0$ with $k=\\omega/c$. The particle velocity phasor $\\mathbf{v}(\\mathbf{x})$ is defined by the linearized momentum balance.\n\nStarting only from the linearized momentum and mass balance equations and the constitutive relation $p=c^{2}\\rho^{\\prime}$ between acoustic pressure $p$ and density fluctuation $\\rho^{\\prime}$, derive a formula for the time-averaged acoustic intensity vector $\\mathbf{I}(\\mathbf{x})$, and then specialize it to the radial component $I_{r}(\\mathbf{x})$ in spherical coordinates for any spherically symmetric $u(r)$. Next, consider the spherically symmetric incoming Helmholtz solution $u(r)=\\exp(-ikr)/r$. Compute the large-radius limit of the scaled radial intensity\n$$\nL=\\lim_{r\\to\\infty} r^{2} I_{r}(r),\n$$\nand express your final answer in terms of $\\rho$ and $c$ only. Conclude from the sign of $L$ whether the field transports energy outward or inward at infinity, and state whether it is compatible with the physical outgoing Sommerfeld condition. You must provide the single closed-form analytic expression for $L$ as your final answer. No numerical substitution is required and no units should accompany the final answer.",
            "solution": "The derivation proceeds from the fundamental principles of fluid dynamics. The goal is to first find the general expression for the time-averaged acoustic intensity vector, specialize it to the case of a spherically symmetric field, and then apply it to a specific incoming wave solution to find the large-radius limit of the scaled radial intensity.\n\nLet the acoustic pressure be $p(\\mathbf{x},t) = \\Re\\{u(\\mathbf{x})\\exp(-i\\omega t)\\}$ and the particle velocity be $\\mathbf{v}_p(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x})\\exp(-i\\omega t)\\}$, where $u(\\mathbf{x})$ and $\\mathbf{v}(\\mathbf{x})$ are the complex phasors for pressure and velocity, respectively.\n\nThe linearized momentum balance equation for an inviscid fluid is:\n$$\n\\rho \\frac{\\partial \\mathbf{v}_p}{\\partial t} = -\\nabla p\n$$\nwhere $\\rho$ is the constant mean density of the fluid. Substituting the complex representations for $p$ and $\\mathbf{v}_p$:\n$$\n\\rho \\frac{\\partial}{\\partial t} \\Re\\{\\mathbf{v}(\\mathbf{x})\\exp(-i\\omega t)\\} = -\\nabla \\Re\\{u(\\mathbf{x})\\exp(-i\\omega t)\\}\n$$\n$$\n\\Re\\{\\rho (-i\\omega) \\mathbf{v}(\\mathbf{x})\\exp(-i\\omega t)\\} = -\\Re\\{(\\nabla u(\\mathbf{x}))\\exp(-i\\omega t)\\}\n$$\nSince this equality must hold for all time $t$, we can equate the complex phasors:\n$$\n-i\\omega\\rho \\mathbf{v}(\\mathbf{x}) = -\\nabla u(\\mathbf{x})\n$$\nThis gives the relationship between the velocity phasor and the pressure phasor:\n$$\n\\mathbf{v}(\\mathbf{x}) = \\frac{1}{i\\omega\\rho} \\nabla u(\\mathbf{x})\n$$\nThe instantaneous acoustic intensity vector is defined as the product of the real acoustic pressure and the real particle velocity, $\\mathbf{I}_{inst}(\\mathbf{x}, t) = p(\\mathbf{x},t) \\mathbf{v}_p(\\mathbf{x},t)$. The time-averaged acoustic intensity $\\mathbf{I}(\\mathbf{x})$ is the average of this quantity over one period of oscillation. For two time-harmonic quantities $A(t) = \\Re\\{A_c \\exp(-i\\omega t)\\}$ and $B(t) = \\Re\\{B_c \\exp(-i\\omega t)\\}$, the time average of their product is given by $\\langle A(t)B(t) \\rangle_T = \\frac{1}{2} \\Re\\{A_c B_c^*\\}$, where $B_c^*$ denotes the complex conjugate of $B_c$.\n\nApplying this theorem to our case, with $A_c = u(\\mathbf{x})$ and $B_c = \\mathbf{v}(\\mathbf{x})$, the time-averaged intensity is:\n$$\n\\mathbf{I}(\\mathbf{x}) = \\frac{1}{2} \\Re\\{u(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\}\n$$\nWe find the complex conjugate of the velocity phasor $\\mathbf{v}(\\mathbf{x})$:\n$$\n\\mathbf{v}^*(\\mathbf{x}) = \\left(\\frac{1}{i\\omega\\rho} \\nabla u(\\mathbf{x})\\right)^* = \\frac{1}{-i\\omega\\rho} \\nabla u^*(\\mathbf{x}) = \\frac{i}{\\omega\\rho} \\nabla u^*(\\mathbf{x})\n$$\nsince $\\omega$ and $\\rho$ are real constants. Substituting this into the expression for $\\mathbf{I}(\\mathbf{x})$ yields:\n$$\n\\mathbf{I}(\\mathbf{x}) = \\frac{1}{2} \\Re\\left\\{u(\\mathbf{x}) \\left(\\frac{i}{\\omega\\rho} \\nabla u^*(\\mathbf{x})\\right)\\right\\} = \\frac{1}{2\\omega\\rho} \\Re\\{i u(\\mathbf{x}) \\nabla u^*(\\mathbf{x})\\}\n$$\nThis is the general formula for the time-averaged acoustic intensity vector.\n\nNext, we specialize this result for a spherically symmetric pressure field, where $u$ is a function of the radial coordinate $r$ only, i.e., $u(\\mathbf{x}) = u(r)$. In spherical coordinates, the gradient of a spherically symmetric scalar function is $\\nabla u(r) = \\frac{du(r)}{dr}\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the unit vector in the radial direction. The intensity vector becomes:\n$$\n\\mathbf{I}(r) = \\frac{1}{2\\omega\\rho} \\Re\\left\\{i u(r) \\frac{du^*(r)}{dr}\\hat{\\mathbf{r}}\\right\\}\n$$\nThe radial component of the intensity, $I_r(r)$, is the scalar part of this expression:\n$$\nI_r(r) = \\frac{1}{2\\omega\\rho} \\Re\\left\\{i u(r) \\frac{du^*(r)}{dr}\\right\\}\n$$\nNow we consider the specific case of the spherically symmetric incoming Helmholtz solution, $u(r) = \\frac{\\exp(-ikr)}{r}$. Its complex conjugate is $u^*(r) = \\frac{\\exp(ikr)}{r}$. We compute the derivative of $u^*(r)$:\n$$\n\\frac{du^*(r)}{dr} = \\frac{d}{dr}\\left(\\frac{\\exp(ikr)}{r}\\right) = \\frac{ik\\exp(ikr) \\cdot r - \\exp(ikr) \\cdot 1}{r^2} = \\frac{\\exp(ikr)}{r^2}(ikr - 1)\n$$\nWe now form the product inside the real part operator in the expression for $I_r(r)$:\n$$\ni u(r) \\frac{du^*(r)}{dr} = i \\left(\\frac{\\exp(-ikr)}{r}\\right) \\left(\\frac{\\exp(ikr)}{r^2}(ikr - 1)\\right) = i \\frac{\\exp(-ikr)\\exp(ikr)}{r^3}(ikr - 1) = \\frac{i}{r^3}(ikr - 1)\n$$\nDistributing the factor $i$:\n$$\n\\frac{i}{r^3}(ikr - 1) = \\frac{1}{r^3}(i^2kr - i) = \\frac{1}{r^3}(-kr - i)\n$$\nThe real part of this complex expression is:\n$$\n\\Re\\left\\{\\frac{1}{r^3}(-kr - i)\\right\\} = -\\frac{kr}{r^3} = -\\frac{k}{r^2}\n$$\nSubstituting this back into the formula for $I_r(r)$:\n$$\nI_r(r) = \\frac{1}{2\\omega\\rho} \\left(-\\frac{k}{r^2}\\right) = -\\frac{k}{2\\omega\\rho r^2}\n$$\nThe problem asks for the quantity $L$, defined as the large-radius limit of the scaled radial intensity:\n$$\nL = \\lim_{r\\to\\infty} r^2 I_r(r) = \\lim_{r\\to\\infty} r^2 \\left(-\\frac{k}{2\\omega\\rho r^2}\\right) = \\lim_{r\\to\\infty} \\left(-\\frac{k}{2\\omega\\rho}\\right) = -\\frac{k}{2\\omega\\rho}\n$$\nFinally, we must express this result in terms of $\\rho$ and $c$ only, using the given relation $k = \\omega/c$:\n$$\nL = -\\frac{(\\omega/c)}{2\\omega\\rho} = -\\frac{\\omega}{2\\omega c \\rho} = -\\frac{1}{2\\rho c}\n$$\nThe sign of $L$ is negative. Since $I_r(r) = L/r^2$ for large $r$, the radial intensity is negative, which signifies that the acoustic energy is, on average, flowing radially inward, from infinity toward the origin. The given solution $u(r) = \\exp(-ikr)/r$ is an incoming wave, representing energy converging to a sink at the origin. The physical Sommerfeld radiation condition requires that for a field generated by sources within a finite region, energy must radiate outward to infinity. The incoming wave solution violates this condition. Our result, indicating inward energy transport, is consistent with the nature of the given field and confirms its incompatibility with the physical outgoing Sommerfeld radiation condition.",
            "answer": "$$\n\\boxed{-\\frac{1}{2\\rho c}}\n$$"
        },
        {
            "introduction": "Translating theoretical physics into computational practice presents unique challenges, particularly when dealing with conditions at infinity. Since numerical simulations are confined to finite domains, how can we verify that our computed solution correctly models an open, unbounded problem? This practice bridges that gap by guiding you to develop a numerical diagnostic tool. You will implement a finite-difference-based metric to quantify how well a solution on a finite computational boundary adheres to the Sommerfeld Radiation Condition, providing a practical method to ensure the physical validity of a simulation. ",
            "id": "4144692",
            "problem": "Consider time-harmonic linear acoustics in a homogeneous, lossless medium with constant sound speed, where the complex acoustic pressure field $u(\\mathbf{x})$ satisfies the scalar Helmholtz equation with wavenumber $k>0$. A physically radiating solution must satisfy the Sommerfeld radiation condition at infinity. In computational acoustics, this is commonly verified on a large sphere of radius $R$ by evaluating a diagnostic that quantifies the deviation from purely outgoing behavior. Your task is to implement, from first principles, a numerical diagnostic on a sphere of radius $R$ that estimates, over sampled directions, the maximum of the magnitude of the quantity $r\\bigl(\\partial_{r} u - i k u\\bigr)$, where $r = |\\mathbf{x}|$ and $\\partial_{r} u$ denotes the radial derivative of $u$ along the outward normal direction. You must compute this diagnostic using sampled values of $u$ at radii $R-\\Delta r$, $R$, and $R+\\Delta r$ via a central finite difference approximation.\n\nStarting from the basic definitions of spherical coordinates and finite difference approximations, implement a program that:\n- Samples the sphere $|\\mathbf{x}|=R$ using a uniform grid of polar angle $\\theta\\in[0,\\pi]$ and azimuthal angle $\\phi\\in[0,2\\pi)$, with angles specified in radians.\n- For each sampled direction $(\\theta,\\phi)$, approximates the radial derivative by\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}.\n$$\n- Forms, at each sampled direction, the complex quantity\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right),\n$$\nand takes the diagnostic value\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|.\n$$\nAssume $u$ is dimensionless. Distances must be expressed in meters, $m$, the wavenumber $k$ in inverse meters, $\\mathrm{m}^{-1}$, and angles in radians. Use the following acceptance rule to decide whether the computed field satisfies the Sommerfeld radiation condition numerically on the sphere: declare the field acceptable if $D_R \\le \\tau(R)$, where the threshold is\n$$\n\\tau(R) = \\frac{2}{R}.\n$$\nThis rule is dimensionally consistent in this setup because $u$ is dimensionless.\n\nImplement the diagnostic for the following test suite of fields $u(\\mathbf{x})$ and parameters. In each case, the field $u$ is defined for all $\\mathbf{x}$ by the given analytic formula, with $\\mathbf{x}=(x,y,z)$, $r=|\\mathbf{x}|$, $\\theta$ the polar angle, and $\\phi$ the azimuthal angle. Use the specified sampling parameters to approximate $D_R$.\n\nTest cases:\n- Case $1$ (Outgoing spherical wave, moderate radius):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $2$ (Incoming spherical wave, moderate radius):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{-i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $3$ (Mixed incoming and outgoing spherical waves):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $4$ (Plane wave propagating along the $x$-axis):\n  - Field: $$u(\\mathbf{x})=e^{i k x},\\quad x=r\\sin\\theta\\cos\\phi.$$\n  - Parameters: $k=2\\,\\mathrm{m}^{-1}$, $R=10\\,\\mathrm{m}$, $\\Delta r=5\\times 10^{-3}\\,\\mathrm{m}$, $N_\\theta=81$, $N_\\phi=161$.\n\nFor each case, compute $D_R$ and then evaluate the acceptance rule $D_R \\le \\tau(R)$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases $1$ through $4$, with each entry being the Boolean result of the acceptance rule (for example, $[True,False,False,False]$).",
            "solution": "The physical context is time-harmonic linear acoustics, where the complex acoustic pressure field $u(\\mathbf{x})$ in a homogeneous medium is governed by the scalar Helmholtz equation:\n$$\n(\\nabla^2 + k^2) u(\\mathbf{x}) = 0\n$$\nwhere $k > 0$ is the wavenumber. For a solution to represent a wave radiating outwards from a bounded source region, it must satisfy the Sommerfeld radiation condition:\n$$\n\\lim_{r\\to\\infty} r \\left( \\frac{\\partial u}{\\partial r} - i k u \\right) = 0\n$$\nwhere $r = |\\mathbf{x}|$ is the radial distance from the origin and $\\partial/\\partial r$ is the derivative in the radial direction. This condition ensures that the wave is purely outgoing at infinity and carries energy away from the source.\n\nIn computational methods, this condition is enforced at the boundary of a truncated computational domain. A common method to verify its satisfaction is to compute a diagnostic on a large, but finite, spherical surface of radius $R$. The problem asks for the implementation of such a diagnostic.\n\nThe procedure is as follows:\n1.  Define a sampling grid on the surface of a sphere of radius $R$. The grid is uniform in the polar angle $\\theta \\in [0, \\pi]$ with $N_\\theta$ points and in the azimuthal angle $\\phi \\in [0, 2\\pi)$ with $N_\\phi$ points. The coordinates of a point $\\mathbf{x}$ are given in spherical coordinates as $(r, \\theta, \\phi)$, which relate to Cartesian coordinates $(x, y, z)$ by $x=r\\sin\\theta\\cos\\phi$, $y=r\\sin\\theta\\sin\\phi$, and $z=r\\cos\\theta$.\n\n2.  At each sampled direction $(\\theta, \\phi)$, the radial derivative $\\partial_r u$ at radius $R$ is approximated using a second-order central finite difference formula. This requires evaluating the field $u$ at three nearby radii: $R-\\Delta r$, $R$, and $R+\\Delta r$. The approximation is:\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}\n$$\n\n3.  Using this approximation, the complex quantity central to the Sommerfeld condition is formed at each sample point:\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right)\n$$\nFor a purely outgoing wave, the magnitude of this quantity should approach zero as $R \\to \\infty$.\n\n4.  The overall diagnostic value, $D_R$, is the maximum magnitude of $q$ over all sampled directions on the sphere:\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|\n$$\n\n5.  Finally, an acceptance rule is applied to determine if the field numerically satisfies the radiation condition on the sphere of radius $R$. The field is considered acceptable if $D_R$ is below a given threshold $\\tau(R)$:\n$$\nD_R \\le \\tau(R) = \\frac{2}{R}\n$$\nThis threshold is dimensionally consistent since $u$ is given as dimensionless, making $D_R$ dimensionless. The factor of $2$ provides a tolerance for numerical approximation errors and for the fact that the check is performed at a finite radius $R$, not at infinity.\n\nWe will apply this procedure to four test cases.\n\nCase 1: $u(\\mathbf{x})=\\frac{e^{i k r}}{r}$. This is the fundamental outgoing spherical wave (a monopole field). Analytically, $\\partial_r u = (ik - 1/r)u$. Thus, $\\partial_r u - iku = -u/r$. The analytical diagnostic quantity is $R(\\partial_r u - iku) = -Ru/r = -R \\frac{e^{ikr}}{r^2}$. At $r=R$, this becomes $-e^{ikR}/R$, whose magnitude is $1/R$. We expect the numerical diagnostic $D_R$ to be very close to $1/R$. The condition $D_R \\le 2/R$ should be satisfied.\n\nCase 2: $u(\\mathbf{x})=\\frac{e^{-i k r}}{r}$. This is an incoming spherical wave. Analytically, $\\partial_r u = (-ik - 1/r)u$. Thus, $\\partial_r u - iku = (-2ik - 1/r)u$. At $r=R$, the analytical diagnostic quantity is $(-2ikR - 1)u(R)$. The magnitude of this quantity is $|(-2ikR - 1)u(R)| = \\frac{\\sqrt{(2kR)^2+1}}{R}$, which is approximately $2k$. For the given parameters $k=5\\,\\mathrm{m}^{-1}$ and $R=50\\,\\mathrm{m}$, this value is approximately $2k=10$, which is much larger than the threshold $\\tau(50) = 2/50 = 0.04$. This case should fail.\n\nCase 3: $u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}$. This is a superposition of an outgoing wave and a weaker incoming wave. The linearity of the derivative and the diagnostic operator means that $q$ will be a superposition of the quantities from Case 1 and Case 2 (with a factor of $0.3$). The large contribution from the incoming wave will dominate, causing the test to fail.\n\nCase 4: $u(\\mathbf{x})=e^{i k x} = e^{i k r \\sin\\theta \\cos\\phi}$. This is a plane wave. A plane wave can be decomposed into an infinite series of spherical basis functions containing both incoming and outgoing components. It is not a purely outgoing field with respect to the origin. Analytically, $\\partial_r u = (ik\\sin\\theta\\cos\\phi)u$. The diagnostic quantity is $R(\\partial_r u - iku) = R(ik\\sin\\theta\\cos\\phi - ik)u = ikR(\\sin\\theta\\cos\\phi - 1)u$. The magnitude is $|q| = kR| \\sin\\theta\\cos\\phi - 1 |$. The maximum value of $|\\sin\\theta\\cos\\phi - 1|$ is $2$ (when $\\sin\\theta\\cos\\phi = -1$, e.g., at $\\theta=\\pi/2, \\phi=\\pi$). Thus, the analytical maximum is $D_R = 2kR$. For $k=2\\,\\mathrm{m}^{-1}$ and $R=10\\,\\mathrm{m}$, this value is $2 \\times 2 \\times 10 = 40$. This is far greater than the threshold $\\tau(10) = 2/10 = 0.2$. This case should also fail.\n\nThe implementation will follow these steps for each case, calculating $D_R$ numerically and comparing it to $\\tau(R)$ to generate the final Boolean result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a numerical diagnostic for the Sommerfeld radiation condition\n    for a suite of test cases and applies an acceptance rule.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (Outgoing spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 2 (Incoming spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(-1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 3 (Mixed incoming and outgoing spherical waves):\n        {\n            \"field\": lambda r, theta, phi, k: (np.exp(1j * k * r) / r) + 0.3 * (np.exp(-1j * k * r) / r),\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 4 (Plane wave propagating along the x-axis):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r * np.sin(theta) * np.cos(phi)),\n            \"k\": 2.0, \"R\": 10.0, \"dr\": 5e-3, \"N_theta\": 81, \"N_phi\": 161\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        field_func = case[\"field\"]\n        k = case[\"k\"]\n        R = case[\"R\"]\n        dr = case[\"dr\"]\n        N_theta = case[\"N_theta\"]\n        N_phi = case[\"N_phi\"]\n\n        # 1. Create the sampling grid on the sphere\n        # Polar angle from 0 to pi\n        theta_vals = np.linspace(0, np.pi, N_theta)\n        # Azimuthal angle from 0 to 2*pi (exclusive)\n        phi_vals = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n        \n        # Create a meshgrid for vectorized calculations\n        # 'ij' indexing ensures theta corresponds to rows and phi to columns\n        THETA, PHI = np.meshgrid(theta_vals, phi_vals, indexing='ij')\n\n        # 2. Evaluate the field u at three radii: R-dr, R, R+dr\n        u_minus = field_func(R - dr, THETA, PHI, k)\n        u_zero = field_func(R, THETA, PHI, k)\n        u_plus = field_func(R + dr, THETA, PHI, k)\n\n        # 3. Approximate the radial derivative using a central finite difference\n        # This is an array of derivatives, one for each (theta, phi) point\n        du_dr_approx = (u_plus - u_minus) / (2 * dr)\n\n        # 4. Form the complex quantity q at each sample point\n        q = R * (du_dr_approx - 1j * k * u_zero)\n\n        # 5. Compute the diagnostic value D_R\n        D_R = np.max(np.abs(q))\n\n        # 6. Apply the acceptance rule\n        tau_R = 2.0 / R\n        is_acceptable = (D_R = tau_R)\n        \n        results.append(is_acceptable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}