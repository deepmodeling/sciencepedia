{
    "hands_on_practices": [
        {
            "introduction": "要从根本上理解波的辐射，一个核心的实践是从最基本的第一性原理出发，推导出由点源产生的波场。本练习将指导你完成这一过程，即在三维空间中，仅利用亥姆霍兹方程和索末菲辐射条件，推导单位强度单极子源的格林函数。通过这个练习，你将亲身体会到辐射条件如何作为数学上的“物理过滤器”，从众多可能的解中筛选出唯一代表向外传播能量的物理现实解。",
            "id": "4144660",
            "problem": "考虑$\\mathbb{R}^{3}$中的时谐声学问题，角频率为$\\omega>0$，声速为$c$，波数为$k=\\omega/c>0$。令$u:\\mathbb{R}^{3}\\setminus\\{0\\}\\to\\mathbb{C}$表示复声压场，其时间依赖项$\\exp(-\\mathrm{i}\\omega t)$已被略去。由位于原点的单位强度单极子源产生的场，可以用出射自由空间格林函数$G(\\mathbf{x},\\mathbf{0})$来建模，该函数满足非齐次亥姆霍兹偏微分方程 (PDE)\n$$\n(\\Delta + k^{2})\\,G(\\mathbf{x},\\mathbf{0}) = -\\delta(\\mathbf{x}),\n$$\n此方程在分布意义下成立，并满足索末菲辐射条件\n$$\n\\lim_{r\\to\\infty} r\\left(\\frac{\\partial G}{\\partial r}(\\mathbf{x},\\mathbf{0}) - \\mathrm{i}k\\,G(\\mathbf{x},\\mathbf{0})\\right)=0,\n\\quad r=|\\mathbf{x}|,\n$$\n该条件强制要求在无穷远处只存在向外传播的能量。\n\n仅从这些定义和基本定律出发（不使用任何预先制表的格林函数），按以下步骤进行：\n\n1. 利用球对称性和辐射条件，确定当$r=|\\mathbf{x}|>0$时$G(\\mathbf{x},\\mathbf{0})$的一般形式。\n\n2. 通过将亥姆霍兹偏微分方程在一个以原点为中心、半径为$\\varepsilon>0$的球上积分，并应用散度定理，然后取极限$\\varepsilon\\to 0^{+}$，来确定归一化常数。\n\n3. 对于单极子场$u(\\mathbf{x})=G(\\mathbf{x},\\mathbf{0})$，将远场模式$F(\\hat{\\mathbf{x}})$定义为\n$$\nF(\\hat{\\mathbf{x}}) \\equiv \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\,u(r\\hat{\\mathbf{x}}),\n\\quad \\hat{\\mathbf{x}}=\\frac{\\mathbf{x}}{|\\mathbf{x}|}\\in\\mathbb{S}^{2},\n$$\n显式计算$F(\\hat{\\mathbf{x}})$，并根据你的表达式确认其幅值是否依赖于方向$\\hat{\\mathbf{x}}$。\n\n你的最终答案必须是$F(\\hat{\\mathbf{x}})$的单一闭式表达式，并尽可能简化。不需要进行数值计算或四舍五入，最终答案中也不应包含单位。",
            "solution": "该问题要求推导三维亥姆霍兹方程的自由空间格林函数，并随后计算其远场模式。推导过程如问题陈述中所概述，分为三个主要阶段。\n\n首先，我们确定格林函数$G(\\mathbf{x}, \\mathbf{0})$在$\\mathbf{x} \\neq \\mathbf{0}$时的一般形式。源是位于原点的点单极子，这意味着产生的场必须是球对称的。因此，我们可以写出$G(\\mathbf{x}, \\mathbf{0}) = g(r)$，其中$r = |\\mathbf{x}| = \\sqrt{x_1^2 + x_2^2 + x_3^2}$。对于$r > 0$，非齐次亥姆霍兹方程$(\\Delta + k^2)G = -\\delta(\\mathbf{x})$变为齐次方程：\n$$\n(\\Delta + k^2)g(r) = 0\n$$\n在球坐标系中，对于一个只依赖于径向坐标$r$的函数，拉普拉斯算子为$\\Delta g(r) = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dg}{dr}\\right) = \\frac{d^2g}{dr^2} + \\frac{2}{r}\\frac{dg}{dr}$。因此，齐次亥姆霍兹方程变为关于$g(r)$的二阶常微分方程 (ODE)：\n$$\n\\frac{d^2g}{dr^2} + \\frac{2}{r}\\frac{dg}{dr} + k^2 g(r) = 0\n$$\n为求解此方程，我们引入替换$g(r) = \\frac{h(r)}{r}$。其导数为：\n$$\n\\frac{dg}{dr} = \\frac{1}{r}\\frac{dh}{dr} - \\frac{h(r)}{r^2}\n$$\n$$\n\\frac{d^2g}{dr^2} = \\frac{1}{r}\\frac{d^2h}{dr^2} - \\frac{2}{r^2}\\frac{dh}{dr} + \\frac{2h(r)}{r^3}\n$$\n将这些代入常微分方程得到：\n$$\n\\left(\\frac{1}{r}\\frac{d^2h}{dr^2} - \\frac{2}{r^2}\\frac{dh}{dr} + \\frac{2h(r)}{r^3}\\right) + \\frac{2}{r}\\left(\\frac{1}{r}\\frac{dh}{dr} - \\frac{h(r)}{r^2}\\right) + k^2 \\frac{h(r)}{r} = 0\n$$\n将整个方程乘以$r$并化简，我们发现包含$\\frac{dh}{dr}$和$h(r)$的项相互抵消，留下一个关于$h(r)$的更简单的常微分方程：\n$$\n\\frac{d^2h}{dr^2} + k^2 h(r) = 0\n$$\n这个简谐振子方程的通解是$h(r) = A_1 \\cos(kr) + A_2 \\sin(kr)$，用复指数可以更方便地写成$h(r) = C_1 \\exp(\\mathrm{i}kr) + C_2 \\exp(-\\mathrm{i}kr)$，其中$C_1$和$C_2$是复常数。代回后，$g(r)$的通解为：\n$$\ng(r) = \\frac{C_1 \\exp(\\mathrm{i}kr)}{r} + \\frac{C_2 \\exp(-\\mathrm{i}kr)}{r}\n$$\n项$\\frac{\\exp(\\mathrm{i}kr)}{r}$代表一个出射球面波（其相位随着时间依赖项$\\exp(-\\mathrm{i}\\omega t)$向外传播），而$\\frac{\\exp(-\\mathrm{i}kr)}{r}$代表一个入射球面波。为了选择物理上正确的解，我们施加索末菲辐射条件，该解必须只包含从源向外辐射的波。条件是：\n$$\n\\lim_{r\\to\\infty} r\\left(\\frac{\\partial G}{\\partial r} - \\mathrm{i}k\\,G\\right)=0\n$$\n让我们为我们的通解$G(\\mathbf{x}, \\mathbf{0}) = g(r)$计算括号中的项。\n$$\n\\frac{\\partial g}{\\partial r} = C_1\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2}\\right) + C_2\\left(\\frac{-\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} - \\frac{\\exp(-\\mathrm{i}kr)}{r^2}\\right)\n$$\n于是，\n$$\n\\frac{\\partial g}{\\partial r} - \\mathrm{i}k g = C_1\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2} - \\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r}\\right) + C_2\\left(\\frac{-\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} - \\frac{\\exp(-\\mathrm{i}kr)}{r^2} - \\frac{\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r}\\right)\n$$\n$$\n= -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r^2} - C_2\\left(\\frac{2\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} + \\frac{\\exp(-\\mathrm{i}kr)}{r^2}\\right)\n$$\n乘以$r$：\n$$\nr\\left(\\frac{\\partial g}{\\partial r} - \\mathrm{i}k g\\right) = -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r} - C_2\\left(2\\mathrm{i}k\\exp(-\\mathrm{i}kr) + \\frac{\\exp(-\\mathrm{i}kr)}{r}\\right)\n$$\n取$r \\to \\infty$的极限：\n$$\n\\lim_{r\\to\\infty} \\left[ -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r} - C_2\\left(2\\mathrm{i}k\\exp(-\\mathrm{i}kr) + \\frac{\\exp(-\\mathrm{i}kr)}{r}\\right) \\right] = \\lim_{r\\to\\infty} [-2\\mathrm{i}k C_2 \\exp(-\\mathrm{i}kr)]\n$$\n这个极限必须为$0$。由于$k > 0$且$|\\exp(-\\mathrm{i}kr)|=1$，这要求$C_2=0$。因此，辐射条件消除了入射波分量。解必须具有$G(\\mathbf{x}, \\mathbf{0}) = A \\frac{\\exp(\\mathrm{i}kr)}{r}$的形式，其中$A$为某个常数。\n\n其次，我们确定归一化常数$A$。我们将非齐次亥姆霍兹偏微分方程在一个以原点为中心、半径为$\\varepsilon$的球$B_\\varepsilon$上积分：\n$$\n\\int_{B_\\varepsilon} (\\Delta + k^2)G \\, dV = \\int_{B_\\varepsilon} -\\delta(\\mathbf{x}) \\, dV = -1\n$$\n左侧可以分为两项。对于第一项，我们使用散度定理：\n$$\n\\int_{B_\\varepsilon} \\Delta G \\, dV = \\int_{\\partial B_\\varepsilon} \\nabla G \\cdot \\mathbf{n} \\, dS\n$$\n其中$\\partial B_\\varepsilon$是半径为$\\varepsilon$的球面$S_\\varepsilon$，$\\mathbf{n}$是向外的单位法向量。由于球对称性，$\\nabla G = \\frac{dG}{dr}\\hat{\\mathbf{r}}$且$\\mathbf{n}=\\hat{\\mathbf{r}}$，所以$\\nabla G \\cdot \\mathbf{n} = \\frac{dG}{dr}$。由于$\\frac{dG}{dr}$在$S_\\varepsilon$上是常数，该积分为导数与表面积$4\\pi\\varepsilon^2$的乘积。\n$$\n\\frac{dG}{dr} = A \\frac{d}{dr}\\left(\\frac{\\exp(\\mathrm{i}kr)}{r}\\right) = A\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2}\\right)\n$$\n在$r=\\varepsilon$处求值并乘以面积：\n$$\n\\int_{S_\\varepsilon} \\frac{dG}{dr} dS = 4\\pi\\varepsilon^2 \\cdot A\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}k\\varepsilon)}{\\varepsilon} - \\frac{\\exp(\\mathrm{i}k\\varepsilon)}{\\varepsilon^2}\\right) = 4\\pi A(\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) - \\exp(\\mathrm{i}k\\varepsilon))\n$$\n第二项是$\\int_{B_\\varepsilon} k^2 G \\, dV = \\int_{B_\\varepsilon} k^2 A \\frac{\\exp(\\mathrm{i}kr)}{r} \\, dV$。在极限$\\varepsilon\\to 0^+$下，积分体积消失。被积函数的行为类似于$1/r$，所以积分的阶数是$\\int_0^\\varepsilon \\frac{1}{r} r^2 dr = \\int_0^\\varepsilon r dr = \\frac{\\varepsilon^2}{2}$。当$\\varepsilon \\to 0^+$时，该项消失。\n对整个方程取极限$\\varepsilon \\to 0^+$：\n$$\n\\lim_{\\varepsilon \\to 0^+} \\left[ 4\\pi A(\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) - \\exp(\\mathrm{i}k\\varepsilon)) + \\int_{B_\\varepsilon} k^2 G \\, dV \\right] = -1\n$$\n当$\\varepsilon \\to 0^+$时，$\\exp(\\mathrm{i}k\\varepsilon) \\to 1$且$\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) \\to 0$。体积分趋于$0$。\n$$\n4\\pi A(0 - 1) + 0 = -1 \\quad \\implies \\quad -4\\pi A = -1 \\quad \\implies \\quad A = \\frac{1}{4\\pi}\n$$\n因此，$\\mathbb{R}^3$中亥姆霍兹方程的自由空间格林函数是：\n$$\nG(\\mathbf{x}, \\mathbf{0}) = \\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\n$$\n\n第三，我们计算场$u(\\mathbf{x}) = G(\\mathbf{x}, \\mathbf{0})$的远场模式$F(\\hat{\\mathbf{x}})$。定义如下：\n$$\nF(\\hat{\\mathbf{x}}) \\equiv \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\,u(r\\hat{\\mathbf{x}})\n$$\n我们代入$u(r\\hat{\\mathbf{x}})=G(r\\hat{\\mathbf{x}}, \\mathbf{0})$的表达式：\n$$\nF(\\hat{\\mathbf{x}}) = \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\left(\\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\\right)\n$$\n极限内的表达式可以显著简化：\n$$\nr\\,\\exp(-\\mathrm{i}kr)\\left(\\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\\right) = \\frac{r}{4\\pi r}\\,\\exp(-\\mathrm{i}kr + \\mathrm{i}kr) = \\frac{1}{4\\pi}\\exp(0) = \\frac{1}{4\\pi}\n$$\n该表达式与$r$无关，因此极限是平凡的。\n$$\nF(\\hat{\\mathbf{x}}) = \\frac{1}{4\\pi}\n$$\n这个结果是一个常数，与方向向量$\\hat{\\mathbf{x}}$无关。这证实了单极子源的远场模式的幅值（和相位）是各向同性的，即在所有方向上均等地辐射能量。",
            "answer": "$$ \\boxed{\\frac{1}{4\\pi}} $$"
        },
        {
            "introduction": "掌握了点源的基本情况后，我们将把索末菲辐射条件应用到一个更复杂但经典的场景中：声波散射。本练习要求你分析一个平面波被一个声学软球体散射的问题，这是一个声学和波物理学中的典范问题。你将通过变量分离法求解，并在此过程中看到，索末菲辐射条件如何指导我们选择正确的径向函数（即第一类球汉克尔函数），以确保散射场在无穷远处表现为纯粹的出射波。",
            "id": "4144658",
            "problem": "考虑三维空间中的时谐声散射问题，其中总声压场 $u_{\\mathrm{tot}}$ 在一个半径为 $a>0$ 的声软球外部满足标量亥姆霍兹方程 $\\nabla^{2} u_{\\mathrm{tot}} + k^{2} u_{\\mathrm{tot}} = 0$。介质是均匀无损的，波数为 $k>0$。一个形式为 $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$ 的平面波沿 $z$ 轴正方向入射，因此总场分解为 $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$，其中 $u_{\\mathrm{scat}}$ 是散射场。球体上的边界条件是声软的（狄利克雷），即 $u_{\\mathrm{tot}}(r=a,\\theta,\\varphi) = 0$。散射场需要满足索末菲辐射条件（SRC），定义为 $\\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0$，该条件确保在无穷远处只有出射波。\n\n在球坐标系 $(r,\\theta,\\varphi)$ 中使用分离变量法，并从亥姆霍兹方程和索末菲辐射条件（SRC）这两个基本出发点，推导散射场的远场模式 $f(\\theta)$，其由渐近关系式定义\n$$\nu_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta) + o(r^{-1}), \\quad r \\to \\infty.\n$$\n说明辐射条件如何筛选出解的径向部分中的出射球汉克尔函数，并施加声软边界条件以确定展开系数。将最终的远场模式 $f(\\theta)$ 表示为关于球贝塞尔函数 $j_{\\ell}$、第一类球汉克尔函数 $h_{\\ell}^{(1)}$（在 $ka$ 处取值）以及勒让德多项式 $P_{\\ell}(\\cos\\theta)$ 的单个闭式解析级数。你的最终答案必须是 $f(\\theta)$ 的单个符号数学表达式。不需要进行数值计算或四舍五入。",
            "solution": "用户提供的问题是声散射理论中的一个标准、适定问题，因此是有效的。我们着手求解。\n\n总声压场 $u_{\\mathrm{tot}}$ 分解为入射场 $u_{\\mathrm{inc}}$ 和散射场 $u_{\\mathrm{scat}}$，即 $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$。$u_{\\mathrm{tot}}$ 和 $u_{\\mathrm{inc}}$ 都是亥姆霍兹方程 $\\nabla^{2} u + k^{2} u = 0$ 的解。由于算子 $\\nabla^{2} + k^{2}$ 的线性性质，散射场 $u_{\\mathrm{scat}}$ 在球体外部区域（$r > a$）也必须满足亥姆霍兹方程：\n$$ \\nabla^{2} u_{\\mathrm{scat}} + k^{2} u_{\\mathrm{scat}} = 0 $$\n入射场是沿 $z$ 轴正方向传播的平面波，$u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$。入射场和球形散射体都关于 $z$ 轴对称。因此，散射场也必须是方位对称的，即 $u_{\\mathrm{scat}}$ 仅是 $r$ 和 $\\theta$ 的函数， $u_{\\mathrm{scat}}(r, \\theta)$。\n\n我们使用分离变量法在球坐标系中求解。具有方位对称性的亥姆霍兹方程的通解可以写成关于 $m=0$ 的球谐函数的展开式，这些球谐函数即为勒让德多项式 $P_{\\ell}(\\cos\\theta)$：\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} R_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\n这里，$R_{\\ell}(kr)$ 表示解的径向部分，它必须满足球贝塞尔微分方程。$R_{\\ell}(\\rho)$ 的通解是第一类球贝塞尔函数 $j_{\\ell}(\\rho)$ 和第二类球贝塞尔函数 $y_{\\ell}(\\rho)$ 的线性组合。对于外域散射问题，使用球汉克尔函数作为基底更为方便：\n$$ h_{\\ell}^{(1)}(\\rho) = j_{\\ell}(\\rho) + i y_{\\ell}(\\rho) $$\n$$ h_{\\ell}^{(2)}(\\rho) = j_{\\ell}(\\rho) - i y_{\\ell}(\\rho) $$\n因此，散射场的通解形式为：\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} P_{\\ell}(\\cos\\theta) \\left( C_{\\ell} h_{\\ell}^{(1)}(kr) + D_{\\ell} h_{\\ell}^{(2)}(kr) \\right) $$\n系数 $C_{\\ell}$ 和 $D_{\\ell}$ 由无穷远处的物理条件确定。散射场 $u_{\\mathrm{scat}}$ 必须表示从散射体向外传播的波。这由索末菲辐射条件（SRC）强制执行：\n$$ \\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0 $$\n为了应用此条件，我们考察汉克尔函数在大宗量 $\\rho = kr \\to \\infty$ 时的渐近行为：\n$$ h_{\\ell}^{(1)}(\\rho) \\sim \\frac{1}{\\rho} (-i)^{\\ell+1} \\exp(i\\rho) = \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} $$\n$$ h_{\\ell}^{(2)}(\\rho) \\sim \\frac{1}{\\rho} (i)^{\\ell+1} \\exp(-i\\rho) = \\frac{\\exp(-ikr)}{kr} (i)^{\\ell+1} $$\n$h_{\\ell}^{(1)}(kr)$ 项对应于出射波（相位因子为 $\\exp(ikr)$），而 $h_{\\ell}^{(2)}(kr)$ 项对应于入射波（相位因子为 $\\exp(-ikr)$）。\n\n我们来检验每种波是否满足SRC。对于出射波分量 $u_{\\mathrm{out}} \\propto h_{\\ell}^{(1)}(kr)$：\n$$ \\frac{\\partial u_{\\mathrm{out}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( C \\frac{\\exp(ikr)}{r} \\right) = C \\left( \\frac{ik\\exp(ikr)}{r} - \\frac{\\exp(ikr)}{r^2} \\right) = iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} $$\n将此代入SRC表达式中：\n$$ \\lim_{r \\to \\infty} r \\left( \\left( iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} \\right) - i k u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} r \\left( -\\frac{1}{r}u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} (-u_{\\mathrm{out}}) = 0 $$\n因为 $u_{\\mathrm{out}}$ 按 $1/r$ 衰减。出射波满足SRC。\n\n对于入射波分量 $u_{\\mathrm{in}} \\propto h_{\\ell}^{(2)}(kr)$：\n$$ \\frac{\\partial u_{\\mathrm{in}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( D \\frac{\\exp(-ikr)}{r} \\right) = D \\left( \\frac{-ik\\exp(-ikr)}{r} - \\frac{\\exp(-ikr)}{r^2} \\right) = -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} $$\n将此代入SRC表达式中：\n$$ \\lim_{r \\to \\infty} r \\left( \\left( -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) - i k u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} r \\left( -2iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} (-2ikr u_{\\mathrm{in}} - u_{\\mathrm{in}}) $$\n由于 $u_{\\mathrm{in}} \\propto \\exp(-ikr)/r$，项 $-2ikr u_{\\mathrm{in}}$ 在 $r \\to \\infty$ 时不为零。因此，入射波违反了SRC。因此，对所有 $\\ell$ 必须有 $D_{\\ell} = 0$。散射场必须仅由出射汉克尔函数 $h_{\\ell}^{(1)}(kr)$ 组成：\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\n未知系数 $A_{\\ell}$ 由球体表面 $r=a$ 上的边界条件确定。问题指定了声软球，这意味着狄利克雷边界条件：$u_{\\mathrm{tot}}(a, \\theta) = 0$。这意味着：\n$$ u_{\\mathrm{inc}}(a, \\theta) + u_{\\mathrm{scat}}(a, \\theta) = 0 $$\n为了施加此条件，我们需要将入射平面波 $u_{\\mathrm{inc}} = \\exp(ikz) = \\exp(ikr\\cos\\theta)$ 展开为勒让德多项式。这就是著名的瑞利公式：\n$$ u_{\\mathrm{inc}}(r, \\theta) = \\exp(ikr\\cos\\theta) = \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\n现在，我们在 $r=a$ 处应用边界条件：\n$$ \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(ka) P_{\\ell}(\\cos\\theta) + \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(ka) P_{\\ell}(\\cos\\theta) = 0 $$\n合并级数：\n$$ \\sum_{\\ell=0}^{\\infty} \\left[ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) \\right] P_{\\ell}(\\cos\\theta) = 0 $$\n由于勒让德多项式在区间 $[-1, 1]$ 上的正交性，每个 $P_{\\ell}(\\cos\\theta)$ 的系数对于所有 $\\ell$ 都必须为零：\n$$ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) = 0 $$\n求解系数 $A_{\\ell}$：\n$$ A_{\\ell} = - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} $$\n将这些系数代回到散射场的展开式中，得到完整解：\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\n远场模式 $f(\\theta)$ 由渐近关系 $u_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta)$ 在 $r \\to \\infty$ 时定义。为了求得 $f(\\theta)$，我们将 $h_{\\ell}^{(1)}(kr)$ 的渐近形式代入我们对 $u_{\\mathrm{scat}}$ 的解中：\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) \\left( \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) $$\n提出因子 $\\frac{\\exp(ikr)}{r}$：\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\frac{\\exp(ikr)}{r} \\left[ \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} \\left( i^{\\ell} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) \\right] $$\n方括号中的项即为远场模式 $f(\\theta)$。我们简化复数的乘积：\n$$ i^{\\ell} (-i)^{\\ell+1} = i^{\\ell} (-1)^{\\ell+1} i^{\\ell+1} = (-1)^{\\ell+1} i^{2\\ell+1} = (-1)^{\\ell+1} (i^2)^{\\ell} i = (-1)^{\\ell+1} (-1)^{\\ell} i = (-1)^{2\\ell+1} i = -i $$\n将此结果代入 $f(\\theta)$ 的表达式中：\n$$ f(\\theta) = \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} (-i) P_{\\ell}(\\cos\\theta) $$\n这简化为远场模式的最终表达式：\n$$ f(\\theta) = \\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta) $$\n这是一个关于在 $ka$ 处求值的所需特殊函数和勒让德多项式的闭式解析级数，符合题目要求。",
            "answer": "$$\n\\boxed{\\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta)}\n$$"
        },
        {
            "introduction": "从解析理论过渡到计算实践，一个关键问题是如何验证数值解是否满足物理约束。由于计算总是在有限的区域内进行，我们无法直接检验无穷远处的行为。本练习旨在弥合理论与实践之间的差距，要求你编写一个程序来实现一种数值诊断工具。通过在有限半径的球面上采样场值并计算一个特定的量，你可以定量地判断一个计算出的场是否在数值上满足索末菲辐射条件，这在计算声学仿真中是一项至关重要的验证技能。",
            "id": "4144692",
            "problem": "考虑在声速恒定的均匀无损介质中的时谐线性声学，其中复声压场 $u(\\mathbf{x})$ 满足标量亥姆霍兹方程，波数 $k>0$。一个物理上辐射的解必须在无穷远处满足 Sommerfeld 辐射条件。在计算声学中，这通常通过在一个半径为 $R$ 的大球面上评估一个诊断量来验证，该诊断量化了与纯向外传播行为的偏差。你的任务是，从第一性原理出发，在半径为 $R$ 的球面上实现一个数值诊断，该诊断在采样的方向上估计量 $r\\bigl(\\partial_{r} u - i k u\\bigr)$ 的模的最大值，其中 $r = |\\mathbf{x}|$ 且 $\\partial_{r} u$ 表示 $u$ 沿向外法线方向的径向导数。你必须通过中心有限差分近似，使用在半径 $R-\\Delta r$、$R$ 和 $R+\\Delta r$ 处 $u$ 的采样值来计算此诊断量。\n\n从球坐标和有限差分近似的基本定义出发，实现一个程序，该程序：\n- 使用极角 $\\theta\\in[0,\\pi]$ 和方位角 $\\phi\\in[0,2\\pi)$ 的均匀网格对球面 $|\\mathbf{x}|=R$ 进行采样，角度以弧度为单位。\n- 对于每个采样方向 $(\\theta,\\phi)$，通过以下公式近似径向导数\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}.\n$$\n- 在每个采样方向上，构造复数量\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right),\n$$\n并取诊断值为\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|.\n$$\n假设 $u$ 是无量纲的。距离必须以米（m）表示，波数 $k$ 以米分之一（$\\mathrm{m}^{-1}$）表示，角度以弧度表示。使用以下接受准则来判断计算出的场是否在数值上满足球面上的 Sommerfeld 辐射条件：如果 $D_R \\le \\tau(R)$，则声明该场是可接受的，其中阈值为\n$$\n\\tau(R) = \\frac{2}{R}.\n$$\n在此设置中，该准则是量纲一致的，因为 $u$ 是无量纲的。\n\n为以下场 $u(\\mathbf{x})$ 和参数的测试套件实现该诊断。在每种情况下，场 $u$ 对所有 $\\mathbf{x}$ 都由给定的解析公式定义，其中 $\\mathbf{x}=(x,y,z)$，$r=|\\mathbf{x}|$，$\\theta$ 是极角，$\\phi$ 是方位角。使用指定的采样参数来近似 $D_R$。\n\n测试用例：\n- 情况 1（出射球面波，中等半径）：\n  - 场：$$u(\\mathbf{x})=\\frac{e^{i k r}}{r}$$\n  - 参数：$k=5\\,\\mathrm{m}^{-1}$，$R=50\\,\\mathrm{m}$，$\\Delta r=10^{-2}\\,\\mathrm{m}$，$N_\\theta=61$，$N_\\phi=121$。\n- 情况 2（入射球面波，中等半径）：\n  - 场：$$u(\\mathbf{x})=\\frac{e^{-i k r}}{r}$$\n  - 参数：$k=5\\,\\mathrm{m}^{-1}$，$R=50\\,\\mathrm{m}$，$\\Delta r=10^{-2}\\,\\mathrm{m}$，$N_\\theta=61$，$N_\\phi=121$。\n- 情况 3（混合的入射和出射球面波）：\n  - 场：$$u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}$$\n  - 参数：$k=5\\,\\mathrm{m}^{-1}$，$R=50\\,\\mathrm{m}$，$\\Delta r=10^{-2}\\,\\mathrm{m}$，$N_\\theta=61$，$N_\\phi=121$。\n- 情况 4（沿 $x$ 轴传播的平面波）：\n  - 场：$$u(\\mathbf{x})=e^{i k x},\\quad x=r\\sin\\theta\\cos\\phi$$\n  - 参数：$k=2\\,\\mathrm{m}^{-1}$，$R=10\\,\\mathrm{m}$，$\\Delta r=5\\times 10^{-3}\\,\\mathrm{m}$，$N_\\theta=81$，$N_\\phi=161$。\n\n对于每种情况，计算 $D_R$，然后评估接受准则 $D_R \\le \\tau(R)$。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况 1 到 4 的顺序排列结果，每个条目都是接受准则的布尔结果（例如，$[True,False,False,False]$）。",
            "solution": "该问题要求实现一个数值诊断，以验证几个给定声场的 Sommerfeld 辐射条件。这个任务是有效的、自洽的，并且在科学上基于波传播和计算声学的原理。\n\n物理背景是时谐线性声学，其中均匀介质中的复声压场 $u(\\mathbf{x})$ 由标量亥姆霍兹方程控制：\n$$\n(\\nabla^2 + k^2) u(\\mathbf{x}) = 0\n$$\n其中 $k > 0$ 是波数。为了使一个解表示从有界源区域向外辐射的波，它必须满足 Sommerfeld 辐射条件：\n$$\n\\lim_{r\\to\\infty} r \\left( \\frac{\\partial u}{\\partial r} - i k u \\right) = 0\n$$\n其中 $r = |\\mathbf{x}|$ 是距原点的径向距离，$\\partial/\\partial r$ 是径向导数。此条件确保波在无穷远处是纯向外的，并将能量从源带走。\n\n在计算方法中，此条件在截断的计算域的边界上强制执行。验证其满足情况的一个常用方法是在一个大的、但有限的半径为 $R$ 的球面上计算一个诊断量。该问题要求实现这样一个诊断。\n\n步骤如下：\n1.  在半径为 $R$ 的球面上定义一个采样网格。该网格在极角 $\\theta \\in [0, \\pi]$ 上有 $N_\\theta$ 个点，是均匀的；在方位角 $\\phi \\in [0, 2\\pi)$ 上有 $N_\\phi$ 个点，也是均匀的。点 $\\mathbf{x}$ 的坐标在球坐标系中表示为 $(r, \\theta, \\phi)$，通过 $x=r\\sin\\theta\\cos\\phi$、$y=r\\sin\\theta\\sin\\phi$ 和 $z=r\\cos\\theta$ 与笛卡尔坐标 $(x, y, z)$ 相关联。\n\n2.  在每个采样方向 $(\\theta, \\phi)$，半径 $R$ 处的径向导数 $\\partial_r u$ 使用二阶中心有限差分公式进行近似。这需要在三个邻近的半径处评估场 $u$：$R-\\Delta r$、$R$ 和 $R+\\Delta r$。近似公式为：\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}\n$$\n\n3.  使用此近似，在每个采样点形成 Sommerfeld 条件的核心复数量：\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right)\n$$\n对于一个纯出射波，当 $R \\to \\infty$ 时，这个量的模应趋近于零。\n\n4.  总诊断值 $D_R$ 是 $q$ 在球面上所有采样方向上的最大模：\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|\n$$\n\n5.  最后，应用一个接受准则来确定该场是否在数值上满足半径为 $R$ 的球面上的辐射条件。如果 $D_R$ 低于给定的阈值 $\\tau(R)$，则认为该场是可接受的：\n$$\nD_R \\le \\tau(R) = \\frac{2}{R}\n$$\n这个阈值在量纲上是一致的，因为给定的 $u$ 是无量纲的，这使得 $D_R$ 也是无量纲的。因子 $2$ 为数值近似误差以及检查是在有限半径 $R$ 而非无穷远处执行这一事实提供了容差。\n\n我们将把这个程序应用于四个测试用例。\n\n情况 1：$u(\\mathbf{x})=\\frac{e^{i k r}}{r}$。这是基本的出射球面波（一个单极子场）。解析上，$\\partial_r u = (ik - 1/r)u$。因此，$\\partial_r u - iku = -u/r$。解析诊断量为 $R(\\partial_r u - iku) = -Ru/r = -R \\frac{e^{ikr}}{r^2}$。在 $r=R$ 时，这变成 $-e^{ikR}/R$，其模为 $1/R$。我们期望数值诊断 $D_R$ 非常接近 $1/R$。条件 $D_R \\le 2/R$ 应该被满足。\n\n情况 2：$u(\\mathbf{x})=\\frac{e^{-i k r}}{r}$。这是一个入射球面波。解析上，$\\partial_r u = (-ik - 1/r)u$。因此，$\\partial_r u - iku = (-2ik - 1/r)u$。诊断量为 $R(\\partial_r u - iku) = R(-2ik - 1/r)u$。在 $r=R$ 时，这是 $(-2ikR - 1)u(R)$。其模为 $|-2ikR-1| |u(R)| = \\sqrt{(2kR)^2+1}/R \\approx 2k$。对于给定的参数 $k=5\\,\\mathrm{m}^{-1}$ 和 $R=50\\,\\mathrm{m}$，这个值大约是 $2 \\times 5 \\times 50 / 50 = 10$，远大于阈值 $\\tau(50) = 2/50 = 0.04$。这个情况应该会失败。\n\n情况 3：$u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}$。这是一个出射波和一个较弱的入射波的叠加。导数和诊断算子的线性意味着 $q$ 将是情况 1 和情况 2 的量的叠加（带有一个因子 0.3）。来自入射波的巨大贡献将占主导地位，导致测试失败。\n\n情况 4：$u(\\mathbf{x})=e^{i k x} = e^{i k r \\sin\\theta \\cos\\phi}$。这是一个平面波。平面波可以分解为包含入射和出射分量的无穷级数球谐基函数。它相对于原点不是一个纯出射场。解析上，$\\partial_r u = (ik\\sin\\theta\\cos\\phi)u$。诊断量为 $R(\\partial_r u - iku) = R(ik\\sin\\theta\\cos\\phi - ik)u = ikR(\\sin\\theta\\cos\\phi - 1)u$。其模为 $|q| = kR| \\sin\\theta\\cos\\phi - 1 |$。$|\\sin\\theta\\cos\\phi - 1|$ 的最大值为 $2$（当 $\\sin\\theta\\cos\\phi = -1$ 时，例如，在 $\\theta=\\pi/2, \\phi=\\pi$）。因此，解析最大值为 $D_R = 2kR$。对于 $k=2\\,\\mathrm{m}^{-1}$ 和 $R=10\\,\\mathrm{m}$，该值为 $2 \\times 2 \\times 10 = 40$。这远大于阈值 $\\tau(10) = 2/10 = 0.2$。这个情况也应该会失败。\n\n实现将对每种情况遵循这些步骤，数值计算 $D_R$ 并将其与 $\\tau(R)$ 比较，以生成最终的布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a numerical diagnostic for the Sommerfeld radiation condition\n    for a suite of test cases and applies an acceptance rule.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (Outgoing spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 2 (Incoming spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(-1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 3 (Mixed incoming and outgoing spherical waves):\n        {\n            \"field\": lambda r, theta, phi, k: (np.exp(1j * k * r) / r) + 0.3 * (np.exp(-1j * k * r) / r),\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 4 (Plane wave propagating along the x-axis):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r * np.sin(theta) * np.cos(phi)),\n            \"k\": 2.0, \"R\": 10.0, \"dr\": 5e-3, \"N_theta\": 81, \"N_phi\": 161\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        field_func = case[\"field\"]\n        k = case[\"k\"]\n        R = case[\"R\"]\n        dr = case[\"dr\"]\n        N_theta = case[\"N_theta\"]\n        N_phi = case[\"N_phi\"]\n\n        # 1. Create the sampling grid on the sphere\n        # Polar angle from 0 to pi\n        theta_vals = np.linspace(0, np.pi, N_theta)\n        # Azimuthal angle from 0 to 2*pi (exclusive)\n        phi_vals = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n        \n        # Create a meshgrid for vectorized calculations\n        # 'ij' indexing ensures theta corresponds to rows and phi to columns\n        THETA, PHI = np.meshgrid(theta_vals, phi_vals, indexing='ij')\n\n        # 2. Evaluate the field u at three radii: R-dr, R, R+dr\n        u_minus = field_func(R - dr, THETA, PHI, k)\n        u_zero = field_func(R, THETA, PHI, k)\n        u_plus = field_func(R + dr, THETA, PHI, k)\n\n        # 3. Approximate the radial derivative using a central finite difference\n        # This is an array of derivatives, one for each (theta, phi) point\n        du_dr_approx = (u_plus - u_minus) / (2 * dr)\n\n        # 4. Form the complex quantity q at each sample point\n        q = R * (du_dr_approx - 1j * k * u_zero)\n\n        # 5. Compute the diagnostic value D_R\n        D_R = np.max(np.abs(q))\n\n        # 6. Apply the acceptance rule\n        tau_R = 2.0 / R\n        is_acceptable = D_R = tau_R\n        \n        results.append(is_acceptable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}