{
    "hands_on_practices": [
        {
            "introduction": "The simplest radiating system is a point source in free space, which forms the fundamental building block for more complex problems. This foundational exercise guides you through the derivation of its mathematical description—the free-space Green's function—directly from the Helmholtz equation and the principle of spherical symmetry. You will see firsthand how the Sommerfeld radiation condition is the essential tool that selects the physically correct outgoing wave from the set of all possible mathematical solutions. ",
            "id": "4144660",
            "problem": "Consider time-harmonic acoustics in $\\mathbb{R}^{3}$ with angular frequency $\\omega>0$ and wavenumber $k=\\omega/c>0$, where $c$ is the sound speed. Let $u:\\mathbb{R}^{3}\\setminus\\{\\mathbf{0}\\}\\to\\mathbb{C}$ denote the complex acoustic pressure field with the time dependence $\\exp(-\\mathrm{i}\\omega t)$ suppressed. The field due to a unit-strength monopole source at the origin is modeled by the outgoing free-space Green’s function $G(\\mathbf{x},\\mathbf{0})$, which satisfies the inhomogeneous Helmholtz partial differential equation (PDE)\n$$\n(\\Delta + k^{2})\\,G(\\mathbf{x},\\mathbf{0}) = -\\delta(\\mathbf{x}),\n$$\nin the sense of distributions, together with the Sommerfeld radiation condition\n$$\n\\lim_{r\\to\\infty} r\\left(\\frac{\\partial G}{\\partial r}(\\mathbf{x},\\mathbf{0}) - \\mathrm{i}k\\,G(\\mathbf{x},\\mathbf{0})\\right)=0,\n\\quad r=|\\mathbf{x}|,\n$$\nwhich enforces that only outward-propagating energy is present at infinity.\n\nStarting from these definitions and fundamental laws only (no pre-tabulated Green’s functions), proceed as follows:\n\n1. Using spherical symmetry and the radiation condition, determine the general form of $G(\\mathbf{x},\\mathbf{0})$ for $r=|\\mathbf{x}|>0$.\n\n2. Determine the normalization constant by integrating the Helmholtz PDE over a ball of radius $\\varepsilon>0$ centered at the origin and applying the divergence theorem, then passing to the limit $\\varepsilon\\to 0^{+}$.\n\n3. Define the far-field pattern $F(\\hat{\\mathbf{x}})$ by\n$$\nF(\\hat{\\mathbf{x}}) \\equiv \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\,u(r\\hat{\\mathbf{x}}),\n\\quad \\hat{\\mathbf{x}}=\\frac{\\mathbf{x}}{|\\mathbf{x}|}\\in\\mathbb{S}^{2},\n$$\nfor the monopole field $u(\\mathbf{x})=G(\\mathbf{x},\\mathbf{0})$. Compute $F(\\hat{\\mathbf{x}})$ explicitly and confirm from your expression whether its magnitude depends on direction $\\hat{\\mathbf{x}}$.\n\nYour final answer must be the single closed-form expression for $F(\\hat{\\mathbf{x}})$, simplified as much as possible. No numerical evaluation or rounding is required, and no units are to be reported in the final answer.",
            "solution": "The problem requires the derivation of the free-space Green's function for the Helmholtz equation in three dimensions and the subsequent computation of its far-field pattern. The derivation proceeds in three main stages as outlined in the problem statement.\n\nFirst, we determine the general form of the Green's function $G(\\mathbf{x}, \\mathbf{0})$ for $\\mathbf{x} \\neq \\mathbf{0}$. The source is a point monopole at the origin, which implies that the resulting field must be spherically symmetric. We can therefore write $G(\\mathbf{x}, \\mathbf{0}) = g(r)$, where $r = |\\mathbf{x}| = \\sqrt{x_1^2 + x_2^2 + x_3^2}$. For $r > 0$, the inhomogeneous Helmholtz equation $(\\Delta + k^2)G = -\\delta(\\mathbf{x})$ becomes the homogeneous equation:\n$$\n(\\Delta + k^2)g(r) = 0\n$$\nIn spherical coordinates, for a function that depends only on the radial coordinate $r$, the Laplacian is $\\Delta g(r) = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dg}{dr}\\right) = \\frac{d^2g}{dr^2} + \\frac{2}{r}\\frac{dg}{dr}$. The homogeneous Helmholtz equation thus becomes a second-order ordinary differential equation (ODE) for $g(r)$:\n$$\n\\frac{d^2g}{dr^2} + \\frac{2}{r}\\frac{dg}{dr} + k^2 g(r) = 0\n$$\nTo solve this equation, we introduce a substitution $g(r) = \\frac{h(r)}{r}$. The derivatives are:\n$$\n\\frac{dg}{dr} = \\frac{1}{r}\\frac{dh}{dr} - \\frac{h(r)}{r^2}\n$$\n$$\n\\frac{d^2g}{dr^2} = \\frac{1}{r}\\frac{d^2h}{dr^2} - \\frac{2}{r^2}\\frac{dh}{dr} + \\frac{2h(r)}{r^3}\n$$\nSubstituting these into the ODE gives:\n$$\n\\left(\\frac{1}{r}\\frac{d^2h}{dr^2} - \\frac{2}{r^2}\\frac{dh}{dr} + \\frac{2h(r)}{r^3}\\right) + \\frac{2}{r}\\left(\\frac{1}{r}\\frac{dh}{dr} - \\frac{h(r)}{r^2}\\right) + k^2 \\frac{h(r)}{r} = 0\n$$\nMultiplying the entire equation by $r$ and simplifying, we find that terms involving $\\frac{dh}{dr}$ and $h(r)$ cancel, leaving a much simpler ODE for $h(r)$:\n$$\n\\frac{d^2h}{dr^2} + k^2 h(r) = 0\n$$\nThe general solution to this simple harmonic oscillator equation is $h(r) = A_1 \\cos(kr) + A_2 \\sin(kr)$, which can be more conveniently written in terms of complex exponentials as $h(r) = C_1 \\exp(\\mathrm{i}kr) + C_2 \\exp(-\\mathrm{i}kr)$ for some complex constants $C_1$ and $C_2$. Substituting back, the general solution for $g(r)$ is:\n$$\ng(r) = \\frac{C_1 \\exp(\\mathrm{i}kr)}{r} + \\frac{C_2 \\exp(-\\mathrm{i}kr)}{r}\n$$\nThe term $\\frac{\\exp(\\mathrm{i}kr)}{r}$ represents an outgoing spherical wave (its phase advances outward with time dependence $\\exp(-\\mathrm{i}\\omega t)$), while $\\frac{\\exp(-\\mathrm{i}kr)}{r}$ represents an incoming spherical wave. The Sommerfeld radiation condition is imposed to select the physically correct solution, which must consist only of waves radiating outwards from the source. The condition is:\n$$\n\\lim_{r\\to\\infty} r\\left(\\frac{\\partial G}{\\partial r} - \\mathrm{i}k\\,G\\right)=0\n$$\nLet's compute the term in the parentheses for our general solution $G(\\mathbf{x}, \\mathbf{0}) = g(r)$.\n$$\n\\frac{\\partial g}{\\partial r} = C_1\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2}\\right) + C_2\\left(\\frac{-\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} - \\frac{\\exp(-\\mathrm{i}kr)}{r^2}\\right)\n$$\nThen,\n$$\n\\frac{\\partial g}{\\partial r} - \\mathrm{i}k g = C_1\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2} - \\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r}\\right) + C_2\\left(\\frac{-\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} - \\frac{\\exp(-\\mathrm{i}kr)}{r^2} - \\frac{\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r}\\right)\n$$\n$$\n= -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r^2} - C_2\\left(\\frac{2\\mathrm{i}k\\exp(-\\mathrm{i}kr)}{r} + \\frac{\\exp(-\\mathrm{i}kr)}{r^2}\\right)\n$$\nMultiplying by $r$:\n$$\nr\\left(\\frac{\\partial g}{\\partial r} - \\mathrm{i}k g\\right) = -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r} - C_2\\left(2\\mathrm{i}k\\exp(-\\mathrm{i}kr) + \\frac{\\exp(-\\mathrm{i}kr)}{r}\\right)\n$$\nTaking the limit as $r \\to \\infty$:\n$$\n\\lim_{r\\to\\infty} \\left[ -C_1 \\frac{\\exp(\\mathrm{i}kr)}{r} - C_2\\left(2\\mathrm{i}k\\exp(-\\mathrm{i}kr) + \\frac{\\exp(-\\mathrm{i}kr)}{r}\\right) \\right] = \\lim_{r\\to\\infty} [-2\\mathrm{i}k C_2 \\exp(-\\mathrm{i}kr)]\n$$\nThis limit must be $0$. Since $k > 0$ and $|\\exp(-\\mathrm{i}kr)|=1$, this requires $C_2=0$. Thus, the radiation condition eliminates the incoming wave component. The solution must have the form $G(\\mathbf{x}, \\mathbf{0}) = A \\frac{\\exp(\\mathrm{i}kr)}{r}$ for some constant $A$.\n\nSecond, we determine the normalization constant $A$. We integrate the inhomogeneous Helmholtz PDE over a ball $B_\\varepsilon$ of radius $\\varepsilon$ centered at the origin:\n$$\n\\int_{B_\\varepsilon} (\\Delta + k^2)G \\, dV = \\int_{B_\\varepsilon} -\\delta(\\mathbf{x}) \\, dV = -1\n$$\nThe left side can be split into two terms. For the first term, we use the divergence theorem:\n$$\n\\int_{B_\\varepsilon} \\Delta G \\, dV = \\int_{\\partial B_\\varepsilon} \\nabla G \\cdot \\mathbf{n} \\, dS\n$$\nwhere $\\partial B_\\varepsilon$ is the sphere $S_\\varepsilon$ of radius $\\varepsilon$ and $\\mathbf{n}$ is the outward unit normal vector. Due to spherical symmetry, $\\nabla G = \\frac{dG}{dr}\\hat{\\mathbf{r}}$ and $\\mathbf{n}=\\hat{\\mathbf{r}}$, so $\\nabla G \\cdot \\mathbf{n} = \\frac{dG}{dr}$. Since $\\frac{dG}{dr}$ is constant on $S_\\varepsilon$, the integral is the product of the derivative and the surface area, $4\\pi\\varepsilon^2$.\n$$\n\\frac{dG}{dr} = A \\frac{d}{dr}\\left(\\frac{\\exp(\\mathrm{i}kr)}{r}\\right) = A\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kr)}{r} - \\frac{\\exp(\\mathrm{i}kr)}{r^2}\\right)\n$$\nEvaluating at $r=\\varepsilon$ and multiplying by the area:\n$$\n\\int_{S_\\varepsilon} \\frac{dG}{dr} dS = 4\\pi\\varepsilon^2 \\cdot A\\left(\\frac{\\mathrm{i}k\\exp(\\mathrm{i}k\\varepsilon)}{\\varepsilon} - \\frac{\\exp(\\mathrm{i}k\\varepsilon)}{\\varepsilon^2}\\right) = 4\\pi A(\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) - \\exp(\\mathrm{i}k\\varepsilon))\n$$\nThe second term is $\\int_{B_\\varepsilon} k^2 G \\, dV = \\int_{B_\\varepsilon} k^2 A \\frac{\\exp(\\mathrm{i}kr)}{r} \\, dV$. In the limit $\\varepsilon\\to 0^+$, the volume of integration vanishes. The integrand behaves as $1/r$, so the integral is of order $\\int_0^\\varepsilon \\frac{1}{r} r^2 dr = \\int_0^\\varepsilon r dr = \\frac{\\varepsilon^2}{2}$. The term vanishes as $\\varepsilon \\to 0^+$.\nTaking the limit $\\varepsilon \\to 0^+$ of the full equation:\n$$\n\\lim_{\\varepsilon \\to 0^+} \\left[ 4\\pi A(\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) - \\exp(\\mathrm{i}k\\varepsilon)) + \\int_{B_\\varepsilon} k^2 G \\, dV \\right] = -1\n$$\nAs $\\varepsilon \\to 0^+$, $\\exp(\\mathrm{i}k\\varepsilon) \\to 1$ and $\\mathrm{i}k\\varepsilon\\exp(\\mathrm{i}k\\varepsilon) \\to 0$. The volume integral goes to $0$.\n$$\n4\\pi A(0 - 1) + 0 = -1 \\quad \\implies \\quad -4\\pi A = -1 \\quad \\implies \\quad A = \\frac{1}{4\\pi}\n$$\nThus, the free-space Green's function for the Helmholtz equation in $\\mathbb{R}^3$ is:\n$$\nG(\\mathbf{x}, \\mathbf{0}) = \\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\n$$\n\nThird, we compute the far-field pattern $F(\\hat{\\mathbf{x}})$ for the field $u(\\mathbf{x}) = G(\\mathbf{x}, \\mathbf{0})$. The definition is:\n$$\nF(\\hat{\\mathbf{x}}) \\equiv \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\,u(r\\hat{\\mathbf{x}})\n$$\nWe substitute our expression for $u(r\\hat{\\mathbf{x}})=G(r\\hat{\\mathbf{x}}, \\mathbf{0})$:\n$$\nF(\\hat{\\mathbf{x}}) = \\lim_{r\\to\\infty} r\\,\\exp(-\\mathrm{i}kr)\\left(\\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\\right)\n$$\nThe expression inside the limit simplifies significantly:\n$$\nr\\,\\exp(-\\mathrm{i}kr)\\left(\\frac{\\exp(\\mathrm{i}kr)}{4\\pi r}\\right) = \\frac{r}{4\\pi r}\\,\\exp(-\\mathrm{i}kr + \\mathrm{i}kr) = \\frac{1}{4\\pi}\\exp(0) = \\frac{1}{4\\pi}\n$$\nThe expression is independent of $r$, so the limit is trivial.\n$$\nF(\\hat{\\mathbf{x}}) = \\frac{1}{4\\pi}\n$$\nThis result is a constant, independent of the direction vector $\\hat{\\mathbf{x}}$. This confirms that the magnitude (and phase) of the far-field pattern of a monopole source is isotropic, radiating energy equally in all directions.",
            "answer": "$$ \\boxed{\\frac{1}{4\\pi}} $$"
        },
        {
            "introduction": "With the free-space solution established, we now apply the radiation condition to a more practical scenario: acoustic scattering from an object. This classic problem involves a plane wave hitting a sound-soft sphere, a canonical case in wave physics. By employing the method of separation of variables, you will discover how the Sommerfeld radiation condition directly dictates the choice of radial functions—specifically, the outgoing spherical Hankel functions—that correctly represent the scattered field radiating away from the sphere. ",
            "id": "4144658",
            "problem": "Consider time-harmonic acoustic scattering in three spatial dimensions, where the total acoustic pressure field $u_{\\mathrm{tot}}$ satisfies the scalar Helmholtz equation $\\nabla^{2} u_{\\mathrm{tot}} + k^{2} u_{\\mathrm{tot}} = 0$ in the exterior of a sound-soft sphere of radius $a>0$. The material is homogeneous and lossless, with wavenumber $k>0$. A plane wave of the form $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$ is incident along the positive $z$-axis, so that the total field decomposes as $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$, where $u_{\\mathrm{scat}}$ is the scattered field. The boundary condition on the sphere is sound-soft (Dirichlet), i.e., $u_{\\mathrm{tot}}(r=a,\\theta,\\varphi) = 0$. The scattered field is required to satisfy the Sommerfeld radiation condition (SRC), defined by $\\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0$, which enforces purely outgoing waves at infinity.\n\nUsing separation of variables in spherical coordinates $(r,\\theta,\\varphi)$ and starting from the fundamental base comprising the Helmholtz equation and the Sommerfeld radiation condition (SRC), derive the far-field pattern $f(\\theta)$ of the scattered field, defined by the asymptotic relation\n$$\nu_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta) + o(r^{-1}), \\quad r \\to \\infty.\n$$\nShow how the radiation condition selects outgoing spherical Hankel functions in the radial part of the solution, and enforce the sound-soft boundary condition to determine the expansion coefficients. Express the final far-field pattern $f(\\theta)$ as a single closed-form analytic series in terms of the spherical Bessel functions $j_{\\ell}$ and the spherical Hankel functions of the first kind $h_{\\ell}^{(1)}$, evaluated at $k a$, and the Legendre polynomials $P_{\\ell}(\\cos\\theta)$. Your final answer must be a single symbolic mathematical expression for $f(\\theta)$. No numerical evaluation or rounding is required.",
            "solution": "The total acoustic pressure field $u_{\\mathrm{tot}}$ is decomposed into an incident field $u_{\\mathrm{inc}}$ and a scattered field $u_{\\mathrm{scat}}$ as $u_{\\mathrm{tot}} = u_{\\mathrm{inc}} + u_{\\mathrm{scat}}$. Both $u_{\\mathrm{tot}}$ and $u_{\\mathrm{inc}}$ are solutions to the Helmholtz equation, $\\nabla^{2} u + k^{2} u = 0$. Due to the linearity of the operator $\\nabla^{2} + k^{2}$, the scattered field $u_{\\mathrm{scat}}$ must also satisfy the Helmholtz equation in the domain exterior to the sphere ($r > a$):\n$$ \\nabla^{2} u_{\\mathrm{scat}} + k^{2} u_{\\mathrm{scat}} = 0 $$\nThe incident field is a plane wave propagating along the positive $z$-axis, $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k z)$. Both the incident field and the spherical scatterer are symmetric with respect to the $z$-axis. Consequently, the scattered field must also be azimuthally symmetric, i.e., $u_{\\mathrm{scat}}$ is a function of $r$ and $\\theta$ only, $u_{\\mathrm{scat}}(r, \\theta)$.\n\nWe seek a solution using the method of separation of variables in spherical coordinates. The general solution to the Helmholtz equation with azimuthal symmetry can be written as an expansion in terms of spherical harmonics with $m=0$, which are the Legendre polynomials $P_{\\ell}(\\cos\\theta)$:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} R_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\nHere, $R_{\\ell}(kr)$ represents the radial part of the solution, which must satisfy the spherical Bessel differential equation. The general solution for $R_{\\ell}(\\rho)$ is a linear combination of spherical Bessel functions of the first kind, $j_{\\ell}(\\rho)$, and of the second kind, $y_{\\ell}(\\rho)$. For scattering problems in an exterior domain, it is more convenient to use the basis of spherical Hankel functions:\n$$ h_{\\ell}^{(1)}(\\rho) = j_{\\ell}(\\rho) + i y_{\\ell}(\\rho) $$\n$$ h_{\\ell}^{(2)}(\\rho) = j_{\\ell}(\\rho) - i y_{\\ell}(\\rho) $$\nThus, the general form for the scattered field is:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} P_{\\ell}(\\cos\\theta) \\left( C_{\\ell} h_{\\ell}^{(1)}(kr) + D_{\\ell} h_{\\ell}^{(2)}(kr) \\right) $$\nThe coefficients $C_{\\ell}$ and $D_{\\ell}$ are determined by physical conditions at infinity. The scattered field $u_{\\mathrm{scat}}$ must represent waves propagating outwards from the scatterer. This is enforced by the Sommerfeld Radiation Condition (SRC):\n$$ \\lim_{r \\to \\infty} r \\left( \\frac{\\partial u_{\\mathrm{scat}}}{\\partial r} - i k\\, u_{\\mathrm{scat}} \\right) = 0 $$\nTo apply this condition, we examine the asymptotic behavior of the Hankel functions for large argument $\\rho = kr \\to \\infty$:\n$$ h_{\\ell}^{(1)}(\\rho) \\sim \\frac{1}{\\rho} (-i)^{\\ell+1} \\exp(i\\rho) = \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} $$\n$$ h_{\\ell}^{(2)}(\\rho) \\sim \\frac{1}{\\rho} (i)^{\\ell+1} \\exp(-i\\rho) = \\frac{\\exp(-ikr)}{kr} (i)^{\\ell+1} $$\nThe term $h_{\\ell}^{(1)}(kr)$ corresponds to an outgoing wave (phase factor $\\exp(ikr)$), while $h_{\\ell}^{(2)}(kr)$ corresponds to an incoming wave (phase factor $\\exp(-ikr)$).\n\nLet's test each type of wave against the SRC. For an outgoing wave component $u_{\\mathrm{out}} \\propto h_{\\ell}^{(1)}(kr)$:\n$$ \\frac{\\partial u_{\\mathrm{out}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( C \\frac{\\exp(ikr)}{r} \\right) = C \\left( \\frac{ik\\exp(ikr)}{r} - \\frac{\\exp(ikr)}{r^2} \\right) = iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} $$\nSubstituting this into the SRC expression:\n$$ \\lim_{r \\to \\infty} r \\left( \\left( iku_{\\mathrm{out}} - \\frac{1}{r}u_{\\mathrm{out}} \\right) - i k u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} r \\left( -\\frac{1}{r}u_{\\mathrm{out}} \\right) = \\lim_{r \\to \\infty} (-u_{\\mathrm{out}}) = 0 $$\nsince $u_{\\mathrm{out}}$ decays as $1/r$. The outgoing waves satisfy the SRC.\n\nFor an incoming wave component $u_{\\mathrm{in}} \\propto h_{\\ell}^{(2)}(kr)$:\n$$ \\frac{\\partial u_{\\mathrm{in}}}{\\partial r} \\approx \\frac{\\partial}{\\partial r} \\left( D \\frac{\\exp(-ikr)}{r} \\right) = D \\left( \\frac{-ik\\exp(-ikr)}{r} - \\frac{\\exp(-ikr)}{r^2} \\right) = -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} $$\nSubstituting this into the SRC expression:\n$$ \\lim_{r \\to \\infty} r \\left( \\left( -iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) - i k u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} r \\left( -2iku_{\\mathrm{in}} - \\frac{1}{r}u_{\\mathrm{in}} \\right) = \\lim_{r \\to \\infty} (-2ikr u_{\\mathrm{in}} - u_{\\mathrm{in}}) $$\nSince $u_{\\mathrm{in}} \\propto \\exp(-ikr)/r$, the term $-2ikr u_{\\mathrm{in}}$ does not vanish as $r \\to \\infty$. Thus, incoming waves violate the SRC. Consequently, we must have $D_{\\ell} = 0$ for all $\\ell$. The scattered field must be composed solely of outgoing Hankel functions, $h_{\\ell}^{(1)}(kr)$:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\nThe unknown coefficients $A_{\\ell}$ are determined by the boundary condition on the surface of the sphere, $r=a$. The problem specifies a sound-soft sphere, which implies a Dirichlet boundary condition: $u_{\\mathrm{tot}}(a, \\theta) = 0$. This means:\n$$ u_{\\mathrm{inc}}(a, \\theta) + u_{\\mathrm{scat}}(a, \\theta) = 0 $$\nTo enforce this, we need the expansion of the incident plane wave $u_{\\mathrm{inc}} = \\exp(ikz) = \\exp(ikr\\cos\\theta)$ in Legendre polynomials. This is the well-known Rayleigh formula:\n$$ u_{\\mathrm{inc}}(r, \\theta) = \\exp(ikr\\cos\\theta) = \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(kr) P_{\\ell}(\\cos\\theta) $$\nNow, we apply the boundary condition at $r=a$:\n$$ \\sum_{\\ell=0}^{\\infty} i^{\\ell} (2\\ell+1) j_{\\ell}(ka) P_{\\ell}(\\cos\\theta) + \\sum_{\\ell=0}^{\\infty} A_{\\ell} h_{\\ell}^{(1)}(ka) P_{\\ell}(\\cos\\theta) = 0 $$\nCombining the sums:\n$$ \\sum_{\\ell=0}^{\\infty} \\left[ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) \\right] P_{\\ell}(\\cos\\theta) = 0 $$\nDue to the orthogonality of the Legendre polynomials over the interval $[-1, 1]$, the coefficient of each $P_{\\ell}(\\cos\\theta)$ must be zero for all $\\ell$:\n$$ i^{\\ell} (2\\ell+1) j_{\\ell}(ka) + A_{\\ell} h_{\\ell}^{(1)}(ka) = 0 $$\nSolving for the coefficients $A_{\\ell}$:\n$$ A_{\\ell} = - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} $$\nSubstituting these coefficients back into the expansion for the scattered field gives the full solution:\n$$ u_{\\mathrm{scat}}(r, \\theta) = \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) h_{\\ell}^{(1)}(kr) P_{\\ell}(\\cos\\theta) $$\nThe far-field pattern $f(\\theta)$ is defined by the asymptotic relation $u_{\\mathrm{scat}}(r,\\theta) = \\frac{\\exp(i k r)}{r}\\, f(\\theta)$ as $r \\to \\infty$. To find $f(\\theta)$, we substitute the asymptotic form of $h_{\\ell}^{(1)}(kr)$ into our solution for $u_{\\mathrm{scat}}$:\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\sum_{\\ell=0}^{\\infty} \\left( - (2\\ell+1) i^{\\ell} \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\right) \\left( \\frac{\\exp(ikr)}{kr} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) $$\nFactoring out the term $\\frac{\\exp(ikr)}{r}$:\n$$ u_{\\mathrm{scat}}(r, \\theta) \\sim \\frac{\\exp(ikr)}{r} \\left[ \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} \\left( i^{\\ell} (-i)^{\\ell+1} \\right) P_{\\ell}(\\cos\\theta) \\right] $$\nThe term in the square brackets is the far-field pattern $f(\\theta)$. We simplify the complex number product:\n$$ i^{\\ell} (-i)^{\\ell+1} = i^{\\ell} (-1)^{\\ell+1} i^{\\ell+1} = (-1)^{\\ell+1} i^{2\\ell+1} = (-1)^{\\ell+1} (i^2)^{\\ell} i = (-1)^{\\ell+1} (-1)^{\\ell} i = (-1)^{2\\ell+1} i = -i $$\nSubstituting this result into the expression for $f(\\theta)$:\n$$ f(\\theta) = \\sum_{\\ell=0}^{\\infty} - (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} \\frac{1}{k} (-i) P_{\\ell}(\\cos\\theta) $$\nThis simplifies to the final expression for the far-field pattern:\n$$ f(\\theta) = \\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta) $$\nThis is a closed-form analytic series in terms of the required special functions evaluated at $ka$ and the Legendre polynomials, as requested.",
            "answer": "$$\n\\boxed{\\frac{i}{k} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) \\frac{j_{\\ell}(ka)}{h_{\\ell}^{(1)}(ka)} P_{\\ell}(\\cos\\theta)}\n$$"
        },
        {
            "introduction": "Finally, we bridge the gap between analytical theory and computational practice. In numerical simulations, the infinite domain is truncated, and the radiation condition must be approximated on an artificial outer boundary. This hands-on coding exercise challenges you to implement a numerical diagnostic to verify whether a computed field satisfies the Sommerfeld condition, a crucial step in validating any computational acoustics model. ",
            "id": "4144692",
            "problem": "Consider time-harmonic linear acoustics in a homogeneous, lossless medium with constant sound speed, where the complex acoustic pressure field $u(\\mathbf{x})$ satisfies the scalar Helmholtz equation with wavenumber $k>0$. A physically radiating solution must satisfy the Sommerfeld radiation condition at infinity. In computational acoustics, this is commonly verified on a large sphere of radius $R$ by evaluating a diagnostic that quantifies the deviation from purely outgoing behavior. Your task is to implement, from first principles, a numerical diagnostic on a sphere of radius $R$ that estimates, over sampled directions, the maximum of the magnitude of the quantity $r\\bigl(\\partial_{r} u - i k u\\bigr)$, where $r = |\\mathbf{x}|$ and $\\partial_{r} u$ denotes the radial derivative of $u$ along the outward normal direction. You must compute this diagnostic using sampled values of $u$ at radii $R-\\Delta r$, $R$, and $R+\\Delta r$ via a central finite difference approximation.\n\nStarting from the basic definitions of spherical coordinates and finite difference approximations, implement a program that:\n- Samples the sphere $|\\mathbf{x}|=R$ using a uniform grid of polar angle $\\theta\\in[0,\\pi]$ and azimuthal angle $\\phi\\in[0,2\\pi)$, with angles specified in radians.\n- For each sampled direction $(\\theta,\\phi)$, approximates the radial derivative by\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}.\n$$\n- Forms, at each sampled direction, the complex quantity\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right),\n$$\nand takes the diagnostic value\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|.\n$$\nAssume $u$ is dimensionless. Distances must be expressed in meters, $m$, the wavenumber $k$ in inverse meters, $\\mathrm{m}^{-1}$, and angles in radians. Use the following acceptance rule to decide whether the computed field satisfies the Sommerfeld radiation condition numerically on the sphere: declare the field acceptable if $D_R \\le \\tau(R)$, where the threshold is\n$$\n\\tau(R) = \\frac{2}{R}.\n$$\nThis rule is dimensionally consistent in this setup because $u$ is dimensionless.\n\nImplement the diagnostic for the following test suite of fields $u(\\mathbf{x})$ and parameters. In each case, the field $u$ is defined for all $\\mathbf{x}$ by the given analytic formula, with $\\mathbf{x}=(x,y,z)$, $r=|\\mathbf{x}|$, $\\theta$ the polar angle, and $\\phi$ the azimuthal angle. Use the specified sampling parameters to approximate $D_R$.\n\nTest cases:\n- Case $1$ (Outgoing spherical wave, moderate radius):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $2$ (Incoming spherical wave, moderate radius):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{-i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $3$ (Mixed incoming and outgoing spherical waves):\n  - Field: $$u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}.$$\n  - Parameters: $k=5\\,\\mathrm{m}^{-1}$, $R=50\\,\\mathrm{m}$, $\\Delta r=10^{-2}\\,\\mathrm{m}$, $N_\\theta=61$, $N_\\phi=121$.\n- Case $4$ (Plane wave propagating along the $x$-axis):\n  - Field: $$u(\\mathbf{x})=e^{i k x},\\quad x=r\\sin\\theta\\cos\\phi.$$\n  - Parameters: $k=2\\,\\mathrm{m}^{-1}$, $R=10\\,\\mathrm{m}$, $\\Delta r=5\\times 10^{-3}\\,\\mathrm{m}$, $N_\\theta=81$, $N_\\phi=161$.\n\nFor each case, compute $D_R$ and then evaluate the acceptance rule $D_R \\le \\tau(R)$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases $1$ through $4$, with each entry being the Boolean result of the acceptance rule (for example, $[True,False,False,False]$).",
            "solution": "The physical context is time-harmonic linear acoustics, where the complex acoustic pressure field $u(\\mathbf{x})$ in a homogeneous medium is governed by the scalar Helmholtz equation:\n$$\n(\\nabla^2 + k^2) u(\\mathbf{x}) = 0\n$$\nwhere $k > 0$ is the wavenumber. For a solution to represent a wave radiating outwards from a bounded source region, it must satisfy the Sommerfeld radiation condition:\n$$\n\\lim_{r\\to\\infty} r \\left( \\frac{\\partial u}{\\partial r} - i k u \\right) = 0\n$$\nwhere $r = |\\mathbf{x}|$ is the radial distance from the origin and $\\partial/\\partial r$ is the derivative in the radial direction. This condition ensures that the wave is purely outgoing at infinity and carries energy away from the source.\n\nIn computational methods, this condition is enforced at the boundary of a truncated computational domain. A common method to verify its satisfaction is to compute a diagnostic on a large, but finite, spherical surface of radius $R$. The problem asks for the implementation of such a diagnostic.\n\nThe procedure is as follows:\n1.  Define a sampling grid on the surface of a sphere of radius $R$. The grid is uniform in the polar angle $\\theta \\in [0, \\pi]$ with $N_\\theta$ points and in the azimuthal angle $\\phi \\in [0, 2\\pi)$ with $N_\\phi$ points. The coordinates of a point $\\mathbf{x}$ are given in spherical coordinates as $(r, \\theta, \\phi)$, which relate to Cartesian coordinates $(x, y, z)$ by $x=r\\sin\\theta\\cos\\phi$, $y=r\\sin\\theta\\sin\\phi$, and $z=r\\cos\\theta$.\n\n2.  At each sampled direction $(\\theta, \\phi)$, the radial derivative $\\partial_r u$ at radius $R$ is approximated using a second-order central finite difference formula. This requires evaluating the field $u$ at three nearby radii: $R-\\Delta r$, $R$, and $R+\\Delta r$. The approximation is:\n$$\n\\partial_r u(R,\\theta,\\phi) \\approx \\frac{u(R+\\Delta r,\\theta,\\phi) - u(R-\\Delta r,\\theta,\\phi)}{2\\,\\Delta r}\n$$\n\n3.  Using this approximation, the complex quantity central to the Sommerfeld condition is formed at each sample point:\n$$\nq(R,\\theta,\\phi) = R\\left(\\partial_r u(R,\\theta,\\phi) - i\\,k\\,u(R,\\theta,\\phi)\\right)\n$$\nFor a purely outgoing wave, the magnitude of this quantity should approach zero as $R \\to \\infty$.\n\n4.  The overall diagnostic value, $D_R$, is the maximum magnitude of $q$ over all sampled directions on the sphere:\n$$\nD_R = \\max_{\\theta,\\phi} \\left| q(R,\\theta,\\phi) \\right|\n$$\n\n5.  Finally, an acceptance rule is applied to determine if the field numerically satisfies the radiation condition on the sphere of radius $R$. The field is considered acceptable if $D_R$ is below a given threshold $\\tau(R)$:\n$$\nD_R \\le \\tau(R) = \\frac{2}{R}\n$$\nThis threshold is dimensionally consistent since $u$ is given as dimensionless, making $D_R$ dimensionless. The factor of $2$ provides a tolerance for numerical approximation errors and for the fact that the check is performed at a finite radius $R$, not at infinity.\n\nWe will apply this procedure to four test cases.\n\nCase 1: $u(\\mathbf{x})=\\frac{e^{i k r}}{r}$. This is the fundamental outgoing spherical wave (a monopole field). Analytically, $\\partial_r u = (ik - 1/r)u$. Thus, $\\partial_r u - iku = -u/r$. The analytical diagnostic quantity is $R(\\partial_r u - iku) = -Ru/r = -R \\frac{e^{ikr}}{r^2}$. At $r=R$, this becomes $-e^{ikR}/R$, whose magnitude is $1/R$. We expect the numerical diagnostic $D_R$ to be very close to $1/R$. The condition $D_R \\le 2/R$ should be satisfied.\n\nCase 2: $u(\\mathbf{x})=\\frac{e^{-i k r}}{r}$. This is an incoming spherical wave. Analytically, $\\partial_r u = (-ik - 1/r)u$. Thus, $\\partial_r u - iku = (-2ik - 1/r)u$. The diagnostic quantity is $R(\\partial_r u - iku) = R(-2ik - 1/r)u$. At $r=R$, this is $(-2ikR - 1)u(R)$. Its magnitude is $|-2ikR-1| |u(R)| = \\sqrt{(2kR)^2+1}/R \\approx 2k$. For the given parameters $k=5\\,\\mathrm{m}^{-1}$ and $R=50\\,\\mathrm{m}$, this is approximately $2 \\times 5 \\times 50 = 500$, which is much larger than the threshold $\\tau(50) = 2/50 = 0.04$. This case should fail.\n\nCase 3: $u(\\mathbf{x})=\\frac{e^{i k r}}{r} + 0.3\\,\\frac{e^{-i k r}}{r}$. This is a superposition of an outgoing wave and a weaker incoming wave. The linearity of the derivative and the diagnostic operator means that $q$ will be a superposition of the quantities from Case 1 and Case 2 (with a factor of $0.3$). The large contribution from the incoming wave will dominate, causing the test to fail.\n\nCase 4: $u(\\mathbf{x})=e^{i k x} = e^{i k r \\sin\\theta \\cos\\phi}$. This is a plane wave. A plane wave can be decomposed into an infinite series of spherical basis functions containing both incoming and outgoing components. It is not a purely outgoing field with respect to the origin. Analytically, $\\partial_r u = (ik\\sin\\theta\\cos\\phi)u$. The diagnostic quantity is $R(\\partial_r u - iku) = R(ik\\sin\\theta\\cos\\phi - ik)u = ikR(\\sin\\theta\\cos\\phi - 1)u$. The magnitude is $|q| = kR| \\sin\\theta\\cos\\phi - 1 |$. The maximum value of $|\\sin\\theta\\cos\\phi - 1|$ is $2$ (when $\\sin\\theta\\cos\\phi = -1$, e.g., at $\\theta=\\pi/2, \\phi=\\pi$). Thus, the analytical maximum is $D_R = 2kR$. For $k=2\\,\\mathrm{m}^{-1}$ and $R=10\\,\\mathrm{m}$, this value is $2 \\times 2 \\times 10 = 40$. This is far greater than the threshold $\\tau(10) = 2/10 = 0.2$. This case should also fail.\n\nThe implementation will follow these steps for each case, calculating $D_R$ numerically and comparing it to $\\tau(R)$ to generate the final Boolean result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a numerical diagnostic for the Sommerfeld radiation condition\n    for a suite of test cases and applies an acceptance rule.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (Outgoing spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 2 (Incoming spherical wave, moderate radius):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(-1j * k * r) / r,\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 3 (Mixed incoming and outgoing spherical waves):\n        {\n            \"field\": lambda r, theta, phi, k: (np.exp(1j * k * r) / r) + 0.3 * (np.exp(-1j * k * r) / r),\n            \"k\": 5.0, \"R\": 50.0, \"dr\": 1e-2, \"N_theta\": 61, \"N_phi\": 121\n        },\n        # Case 4 (Plane wave propagating along the x-axis):\n        {\n            \"field\": lambda r, theta, phi, k: np.exp(1j * k * r * np.sin(theta) * np.cos(phi)),\n            \"k\": 2.0, \"R\": 10.0, \"dr\": 5e-3, \"N_theta\": 81, \"N_phi\": 161\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        field_func = case[\"field\"]\n        k = case[\"k\"]\n        R = case[\"R\"]\n        dr = case[\"dr\"]\n        N_theta = case[\"N_theta\"]\n        N_phi = case[\"N_phi\"]\n\n        # 1. Create the sampling grid on the sphere\n        # Polar angle from 0 to pi\n        theta_vals = np.linspace(0, np.pi, N_theta)\n        # Azimuthal angle from 0 to 2*pi (exclusive)\n        phi_vals = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n        \n        # Create a meshgrid for vectorized calculations\n        # 'ij' indexing ensures theta corresponds to rows and phi to columns\n        THETA, PHI = np.meshgrid(theta_vals, phi_vals, indexing='ij')\n\n        # 2. Evaluate the field u at three radii: R-dr, R, R+dr\n        u_minus = field_func(R - dr, THETA, PHI, k)\n        u_zero = field_func(R, THETA, PHI, k)\n        u_plus = field_func(R + dr, THETA, PHI, k)\n\n        # 3. Approximate the radial derivative using a central finite difference\n        # This is an array of derivatives, one for each (theta, phi) point\n        du_dr_approx = (u_plus - u_minus) / (2 * dr)\n\n        # 4. Form the complex quantity q at each sample point\n        q = R * (du_dr_approx - 1j * k * u_zero)\n\n        # 5. Compute the diagnostic value D_R\n        D_R = np.max(np.abs(q))\n\n        # 6. Apply the acceptance rule\n        tau_R = 2.0 / R\n        is_acceptable = (D_R <= tau_R)\n        \n        results.append(is_acceptable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}