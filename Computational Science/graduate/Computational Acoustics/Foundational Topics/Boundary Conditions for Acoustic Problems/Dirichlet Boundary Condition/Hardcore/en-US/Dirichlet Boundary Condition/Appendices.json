{
    "hands_on_practices": [
        {
            "introduction": "Understanding a boundary condition begins with its most direct physical consequence. This practice guides you through a foundational derivation in acoustics, connecting the abstract mathematical statement of the Dirichlet condition ($p=0$) to the tangible physics of wave reflection. By analyzing a plane wave incident on a sound-soft surface, you will derive from first principles why such a boundary acts as a perfect, phase-inverting reflector, a cornerstone result that governs wave behavior in countless applications .",
            "id": "4120025",
            "problem": "Consider a homogeneous, inviscid, compressible fluid occupying the half-space $z>0$ with constant density $\\rho$ and sound speed $c$. A time-harmonic plane acoustic wave of angular frequency $\\omega$ is incident from within the fluid onto the planar boundary at $z=0$. The boundary is pressure-release (sound-soft), so the acoustic pressure satisfies the Dirichlet boundary condition $p(x,z=0,t)=0$ for all $x$ and $t$. Let the incident wavevector make an angle $\\theta \\in (0,\\pi/2)$ with the unit normal pointing from the fluid toward the boundary, and assume two-dimensional dependence in the $x$-$z$ plane.\n\nStarting from the linearized equations of acoustics and the equation of state, derive the scalar Helmholtz partial differential equation (PDE) satisfied by the complex pressure amplitude $p(x,z)$ under a time-harmonic ansatz. Then, using only the boundary condition, homogeneity of the medium, and translational invariance of the boundary, show from first principles that the component of the wavevector tangent to the boundary is preserved under reflection. Finally, determine the complex pressure reflection coefficient $R_p$ defined by $p_r = R_p\\,p_i$ at $z=0$, where $p_i$ and $p_r$ are the incident and reflected complex pressure fields, respectively.\n\nProvide as your final answer a single closed-form expression for $R_p$ (dimensionless). No numerical rounding is required. All angles, if needed, should be treated in radians.",
            "solution": "The problem asks for three distinct derivations related to the reflection of a plane acoustic wave from a pressure-release boundary. We will address each part in sequence, starting from the fundamental principles of linear acoustics.\n\nThe governing equations for acoustics in a homogeneous, inviscid, compressible fluid with equilibrium density $\\rho_0$ and pressure $p_0$ are the linearized Euler's equation (conservation of momentum) and the continuity equation (conservation of mass). For small perturbations in pressure $p$, density $\\rho'$, and fluid velocity $\\mathbf{u}$, these are:\n$$\n\\rho_0 \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p \\quad \\text{(Momentum)}\n$$\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{(Continuity)}\n$$\nThe system is closed by the linearized equation of state, which relates pressure and density perturbations for an isentropic process:\n$$\np = c^2 \\rho'\n$$\nwhere $c = \\sqrt{(\\partial p/\\partial \\rho)_S}$ is the speed of sound, which is constant in this homogeneous medium.\n\n**Part 1: Derivation of the Helmholtz Equation**\n\nOur goal is to combine these three equations into a single partial differential equation (PDE) for the acoustic pressure $p$.\n\nFirst, we take the divergence of the momentum equation:\n$$\n\\nabla \\cdot \\left( \\rho_0 \\frac{\\partial \\mathbf{u}}{\\partial t} \\right) = -\\nabla \\cdot (\\nabla p)\n$$\nSince $\\rho_0$ is a constant and spatial and temporal derivatives commute, we get:\n$$\n\\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = -\\nabla^2 p\n$$\nNext, we take the time derivative of the continuity equation:\n$$\n\\frac{\\partial}{\\partial t} \\left( \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u} \\right) = 0\n$$\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nNow, substitute $\\rho' = p/c^2$ from the equation of state into this result:\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} + \\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nWe can isolate the term $\\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u})$ from the divergence of the momentum equation, which gives $\\rho_0 \\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{u}) = -\\nabla^2 p$. Substituting this into the previous equation yields:\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = 0\n$$\nThis is the homogeneous acoustic wave equation for the pressure field $p(x,z,t)$.\n\nThe problem specifies a time-harmonic wave of angular frequency $\\omega$. We thus employ a time-harmonic ansatz for the pressure, expressing the total pressure field as the real part of a complex quantity. Following standard convention in physics and engineering, we write the full time-dependent pressure as $p_{total}(x,z,t) = p(x,z)e^{-i\\omega t}$, where $p(x,z)$ is the complex pressure amplitude. Substituting this into the wave equation:\n$$\n\\nabla^2 (p(x,z)e^{-i\\omega t}) - \\frac{1}{c^2} \\frac{\\partial^2}{\\partial t^2} (p(x,z)e^{-i\\omega t}) = 0\n$$\nSince $p(x,z)$ does not depend on time $t$, we can perform the differentiation with respect to $t$: $\\frac{\\partial}{\\partial t} (e^{-i\\omega t}) = -i\\omega e^{-i\\omega t}$ and $\\frac{\\partial^2}{\\partial t^2} (e^{-i\\omega t}) = (-i\\omega)^2 e^{-i\\omega t} = -\\omega^2 e^{-i\\omega t}$. The equation becomes:\n$$\ne^{-i\\omega t} \\nabla^2 p(x,z) - \\frac{1}{c^2} p(x,z) (-\\omega^2 e^{-i\\omega t}) = 0\n$$\nWe can factor out the non-zero term $e^{-i\\omega t}$:\n$$\n\\nabla^2 p(x,z) + \\frac{\\omega^2}{c^2} p(x,z) = 0\n$$\nDefining the wavenumber as $k = \\omega/c$, we arrive at the scalar Helmholtz PDE for the complex pressure amplitude:\n$$\n\\nabla^2 p(x,z) + k^2 p(x,z) = 0\n$$\n\n**Part 2: Conservation of the Tangential Wavevector Component**\n\nThe total pressure field $p(x,z)$ in the fluid is the superposition of the incident wave $p_i(x,z)$ and the reflected wave $p_r(x,z)$:\n$$\np(x,z) = p_i(x,z) + p_r(x,z)\n$$\nAs plane waves satisfying the Helmholtz equation, the incident and reflected fields have the general form:\n$$\np_i(x,z) = P_i e^{i(k_{ix}x + k_{iz}z)}\n$$\n$$\np_r(x,z) = P_r e^{i(k_{rx}x + k_{rz}z)}\n$$\nwhere $P_i$ and $P_r$ are complex amplitudes, and $\\mathbf{k}_i = (k_{ix}, k_{iz})$ and $\\mathbf{k}_r = (k_{rx}, k_{rz})$ are the incident and reflected wavevectors, respectively. The homogeneity of the medium requires that both waves travel at the same speed $c$, so their wavenumbers must have the same magnitude: $|\\mathbf{k}_i| = |\\mathbf{k}_r| = k = \\omega/c$.\n\nThe boundary condition is that of a pressure-release surface at $z=0$, which means the total acoustic pressure is zero at all points on the boundary for all time. In terms of the complex amplitude, this is:\n$$\np(x,z=0) = 0 \\quad \\text{for all } x\n$$\nSubstituting the expressions for the incident and reflected waves into the boundary condition:\n$$\np_i(x,0) + p_r(x,0) = 0\n$$\n$$\nP_i e^{i(k_{ix}x + k_{iz} \\cdot 0)} + P_r e^{i(k_{rx}x + k_{rz} \\cdot 0)} = 0\n$$\n$$\nP_i e^{ik_{ix}x} + P_r e^{ik_{rx}x} = 0\n$$\nThis equation must hold for all values of $x$ along the boundary. This is the crucial consequence of the boundary's translational invariance. The functions $\\{e^{i\\lambda x} | \\lambda \\in \\mathbb{R}\\}$ form a set of linearly independent basis functions. For a linear combination of two such functions to be zero for all $x$, one of two conditions must be met:\n1. The coefficients are both zero ($P_i=0$ and $P_r=0$), which corresponds to the trivial case of no wave.\n2. The exponents are identical ($k_{ix} = k_{rx}$) and the sum of the coefficients is zero ($P_i + P_r = 0$).\n\nAssuming a non-trivial incident wave ($P_i \\neq 0$), the second condition must hold. Therefore, we must have:\n$$\nk_{ix} = k_{rx}\n$$\nThis proves from first principles (homogeneity, translational invariance, and the boundary condition) that the component of the wavevector tangent to the boundary is conserved upon reflection. This is the foundation of Snell's law of reflection.\n\n**Part 3: Determination of the Pressure Reflection Coefficient**\n\nThe complex pressure reflection coefficient $R_p$ is defined by the relation $p_r = R_p p_i$ evaluated at the boundary $z=0$.\n$$\nR_p = \\frac{p_r(x,z=0)}{p_i(x,z=0)}\n$$\nUsing the plane wave expressions at $z=0$:\n$$\nR_p = \\frac{P_r e^{ik_{rx}x}}{P_i e^{ik_{ix}x}}\n$$\nFrom the result of Part 2, we know $k_{ix} = k_{rx}$. The expression for $R_p$ simplifies to the ratio of the complex amplitudes:\n$$\nR_p = \\frac{P_r}{P_i}\n$$\nAlso from Part 2, the boundary condition requires that $P_i + P_r = 0$, which implies $P_r = -P_i$. Substituting this into the expression for $R_p$:\n$$\nR_p = \\frac{-P_i}{P_i} = -1\n$$\nThus, the complex pressure reflection coefficient for a plane wave incident on a pressure-release boundary is $-1$. This indicates that the reflected pressure wave has the same amplitude as the incident wave but is perfectly out of phase (a phase shift of $\\pi$ radians) at the boundary, ensuring their sum is always zero. This result is independent of the angle of incidence $\\theta$.",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "While ideal planar boundaries provide crucial insights, real-world acoustic environments are often defined by complex geometries with sharp corners and edges. This exercise moves beyond smooth surfaces to explore the local behavior of an acoustic field near a re-entrant corner, where the solution to the Helmholtz equation can become singular. Analytically determining the nature of this singularity using separation of variables is a vital skill, as it reveals the inherent mathematical challenges that numerical methods must overcome to achieve accuracy in realistic domains .",
            "id": "4120022",
            "problem": "Consider a two-dimensional time-harmonic acoustic pressure field $p(x,y)$ governed by the scalar Helmholtz Partial Differential Equation (PDE) $\\nabla^{2}p + k^{2}p = 0$ with real wavenumber $k > 0$, in a neighborhood of the origin in a planar wedge domain. In polar coordinates $(r,\\theta)$, the wedge is defined by $0 < \\theta < \\omega$ with interior angle $\\omega \\in (\\pi,2\\pi)$, and the wedge boundaries $\\theta = 0$ and $\\theta = \\omega$ impose the pressure-release (sound-soft) Dirichlet boundary condition $p = 0$. Assume there are no sources at the vertex and that the solution $p$ is locally square-integrable.\n\nStarting from first principles for separation of variables in polar coordinates applied to the Helmholtz PDE, formulate the local angular eigenproblem associated with the wedge and determine the admissible angular eigenvalues. Using the radial equation that emerges in the separation, deduce the leading-order asymptotic behavior of $p(r,\\theta)$ as $r \\to 0$ and identify the singularity exponent that governs the local behavior near the vertex. For the specific re-entrant corner angle $\\omega = \\tfrac{3\\pi}{2}$, compute the smallest positive singularity exponent.\n\nYour final answer must be a single real number representing the smallest positive singularity exponent for $\\omega = \\tfrac{3\\pi}{2}$. No rounding is required.",
            "solution": "The solution proceeds by applying the method of separation of variables to the Helmholtz equation in polar coordinates.\n\nThe Helmholtz equation $\\nabla^{2}p + k^{2}p = 0$ in two-dimensional polar coordinates $(r, \\theta)$ is written as:\n$$\n\\frac{1}{r} \\frac{\\partial}{\\partial r} \\left(r \\frac{\\partial p}{\\partial r}\\right) + \\frac{1}{r^2} \\frac{\\partial^2 p}{\\partial \\theta^2} + k^2 p = 0\n$$\nWe seek a separable solution of the form $p(r, \\theta) = R(r)\\Theta(\\theta)$. Substituting this into the PDE yields:\n$$\n\\frac{1}{r} (r R')' \\Theta + \\frac{1}{r^2} R \\Theta'' + k^2 R \\Theta = 0\n$$\nwhere primes denote differentiation with respect to the function's single argument. Multiplying by $\\frac{r^2}{R\\Theta}$ allows for the separation of variables:\n$$\n\\frac{r^2}{R} R'' + \\frac{r}{R} R' + \\frac{\\Theta''}{\\Theta} + k^2 r^2 = 0\n$$\nRearranging the terms separates the $r$-dependent and $\\theta$-dependent parts:\n$$\n\\frac{r^2 R'' + r R'}{R} + k^2 r^2 = - \\frac{\\Theta''}{\\Theta}\n$$\nSince the left side depends only on $r$ and the right side depends only on $\\theta$, both must be equal to a constant. Let this separation constant be $\\nu^2$. This gives rise to two ordinary differential equations (ODEs):\n\n1.  **The Angular Eigenproblem:**\n    $$\n    -\\frac{\\Theta''}{\\Theta} = \\nu^2 \\implies \\Theta''(\\theta) + \\nu^2 \\Theta(\\theta) = 0\n    $$\n    The boundary conditions $p(r, 0) = 0$ and $p(r, \\omega) = 0$ translate to $\\Theta(0) = 0$ and $\\Theta(\\omega) = 0$ for a non-trivial solution ($R(r) \\not\\equiv 0$). The general solution to this ODE is $\\Theta(\\theta) = A\\cos(\\nu\\theta) + B\\sin(\\nu\\theta)$.\n    Applying the first boundary condition, $\\Theta(0) = 0$:\n    $$\n    A\\cos(0) + B\\sin(0) = A = 0\n    $$\n    Thus, the solution must be of the form $\\Theta(\\theta) = B\\sin(\\nu\\theta)$.\n    Applying the second boundary condition, $\\Theta(\\omega) = 0$:\n    $$\n    B\\sin(\\nu\\omega) = 0\n    $$\n    For a non-trivial solution, we require $B \\neq 0$, which implies $\\sin(\\nu\\omega) = 0$. This condition is satisfied if $\\nu\\omega = n\\pi$ for any integer $n$.\n    The admissible eigenvalues are therefore:\n    $$\n    \\nu_n = \\frac{n\\pi}{\\omega}, \\quad \\text{for } n = 1, 2, 3, \\ldots\n    $$\n    We take $n$ to be positive integers, as $n=0$ yields the trivial solution $\\Theta(\\theta) = 0$, and negative integers do not produce new linearly independent eigenfunctions (since $\\sin(-x) = -\\sin(x)$). The corresponding eigenfunctions are $\\Theta_n(\\theta) = \\sin\\left(\\frac{n\\pi}{\\omega}\\theta\\right)$.\n\n2.  **The Radial Equation:**\n    $$\n    \\frac{r^2 R_n'' + r R_n'}{R_n} + k^2 r^2 = \\nu_n^2\n    $$\n    $$\n    r^2 R_n'' + r R_n' + (k^2 r^2 - \\nu_n^2) R_n = 0\n    $$\n    This is Bessel's differential equation of order $\\nu_n$. The general solution is a linear combination of the Bessel function of the first kind, $J_{\\nu_n}(kr)$, and the Bessel function of the second kind, $Y_{\\nu_n}(kr)$:\n    $$\n    R_n(r) = C_n J_{\\nu_n}(kr) + D_n Y_{\\nu_n}(kr)\n    $$\n    The problem statement specifies that the solution $p$ must be locally square-integrable and that there are no sources at the vertex. We examine the behavior of the Bessel functions as $r \\to 0$. For non-integer $\\nu > 0$, their asymptotic forms are:\n    $$\n    J_{\\nu}(z) \\sim \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{z}{2}\\right)^{\\nu} \\quad \\text{as } z \\to 0^{+}\n    $$\n    $$\n    Y_{\\nu}(z) \\sim -\\frac{\\Gamma(\\nu)}{\\pi}\\left(\\frac{2}{z}\\right)^{\\nu} \\quad \\text{as } z \\to 0^{+}\n    $$\n    In our problem, the order is $\\nu_n = \\frac{n\\pi}{\\omega} > 0$. As $r \\to 0$, $Y_{\\nu_n}(kr)$ behaves as $r^{-\\nu_n}$, which is singular at the origin. A term with this behavior would violate the condition of no sources at the vertex and, more formally, the condition of local square-integrability (or finite local energy), which requires the solution to be less singular than $r^{-1}$. Since $\\nu_n > 0$, the $Y_{\\nu_n}$ term is always too singular. Therefore, we must set $D_n = 0$ for all $n$.\n\nThe full solution is a superposition of the valid modes:\n$$\np(r, \\theta) = \\sum_{n=1}^{\\infty} C_n J_{\\nu_n}(kr) \\sin\\left(\\frac{n\\pi}{\\omega}\\theta\\right)\n$$\nWe are interested in the leading-order asymptotic behavior as $r \\to 0$. This behavior is dominated by the term in the series with the slowest decay (or fastest growth), which corresponds to the smallest positive exponent of $r$. The radial behavior of the $n$-th term is given by $J_{\\nu_n}(kr)$, which behaves as $r^{\\nu_n}$ for small $r$:\n$$\nJ_{\\nu_n}(kr) \\propto r^{\\nu_n} = r^{n\\pi/\\omega}\n$$\nThe exponents are $\\frac{\\pi}{\\omega}, \\frac{2\\pi}{\\omega}, \\frac{3\\pi}{\\omega}, \\ldots$. Since $\\omega > 0$, the smallest positive exponent occurs for $n=1$. This exponent is $\\nu_1 = \\frac{\\pi}{\\omega}$.\n\nThis leading exponent $\\nu_1$ is the singularity exponent. It governs the local behavior of the field near the vertex:\n$$\np(r, \\theta) \\sim C_1 r^{\\pi/\\omega} \\sin\\left(\\frac{\\pi}{\\omega}\\theta\\right) \\quad \\text{as } r \\to 0\n$$\nThe gradient of the pressure, $\\nabla p$, will then behave as $r^{(\\pi/\\omega)-1}$. For a re-entrant corner, $\\omega > \\pi$, which implies the exponent $(\\pi/\\omega) - 1$ is negative, indicating a singular gradient at the vertex.\n\nFinally, we compute the value of this smallest positive singularity exponent for the specific case where the wedge angle is $\\omega = \\frac{3\\pi}{2}$.\n$$\n\\text{Singularity exponent} = \\nu_1 = \\frac{\\pi}{\\omega} = \\frac{\\pi}{\\frac{3\\pi}{2}} = \\frac{2}{3}\n$$\nThe smallest positive singularity exponent is $\\frac{2}{3}$.",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "The transition from analytical theory to computational practice is where many key challenges in scientific computing emerge. This problem addresses one of the most common issues: representing a smooth, curved boundary on a discrete, rectilinear grid. You will implement a finite-difference scheme to simulate an acoustic mode in a circular domain, allowing you to directly observe and quantify the 'staircasing' error introduced by this geometric approximation. Developing a scaling law for this error provides a practical tool for mesh refinement, a fundamental task in ensuring the fidelity of numerical simulations .",
            "id": "4120000",
            "problem": "Consider time-harmonic acoustic pressure governed by the scalar Helmholtz equation in two spatial dimensions with a pressure-release (sound-soft) boundary, meaning the pressure satisfies a Dirichlet condition equal to zero on the boundary. A standard reduced formulation uses the Dirichlet Laplacian eigenproblem to characterize modal wavenumbers. Specifically, for a bounded domain with smooth boundary, the first mode is given by the smallest eigenpair of the operator $-\\Delta$ with Dirichlet boundary condition $p=0$ on the boundary, satisfying\n$$\n-\\Delta p = \\lambda p, \\quad p|_{\\partial \\Omega}=0.\n$$\nWhen the boundary is curved (for example, a circle) but discretized on a Cartesian grid, the boundary is approximated using a staircasing mask. This geometric approximation introduces errors in the computed eigenvalue and field, even if the interior finite-difference operator is nominally second-order. Your task is to quantify the staircasing error in the first Dirichlet eigenvalue for a disk and to propose a mesh refinement criterion based on first-principles scaling.\n\nStarting from fundamental laws and core definitions, formulate the computational procedure as follows:\n- The physical domain is a disk of radius $R$ (expressed in meters), centered at the origin, with the Dirichlet boundary condition $p=0$ at $r=R$.\n- The continuous first Dirichlet eigenvalue for a disk is given by\n$$\n\\lambda_{\\text{anal}} = \\frac{j_{0,1}^2}{R^2},\n$$\nwhere $j_{0,1}$ is the first positive zero of the Bessel function of the first kind of order zero.\n- Approximate the disk on a uniform Cartesian grid with spacing $h$ (expressed in meters). Construct a binary mask for grid nodes whose coordinates $(x,y)$ satisfy $x^2+y^2<R^2$; treat nodes outside the mask as the Dirichlet boundary with prescribed pressure equal to zero. Assemble the standard five-point finite-difference matrix for the operator $-\\Delta$ on masked interior nodes using the stencil\n$$\n(-\\Delta_h p)_{i,j} = \\frac{4p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1}}{h^2},\n$$\nwith neighbors outside the mask contributing zero due to the Dirichlet boundary.\n- Compute the smallest eigenvalue $\\lambda_{\\text{num}}$ of the discrete operator using a symmetric eigensolver, and quantify the relative staircasing error\n$$\n\\varepsilon = \\left|\\frac{\\lambda_{\\text{num}}-\\lambda_{\\text{anal}}}{\\lambda_{\\text{anal}}}\\right|.\n$$\n\nUsing domain perturbation reasoning, the leading-order contribution of geometric staircasing on a smooth boundary suggests the scaling\n$$\n\\varepsilon \\approx C \\frac{h}{R},\n$$\nfor some dimensionless constant $C$ that depends on the boundary enforcement strategy but is approximately constant across $R$ and $h$ for the same staircasing approach. Estimate $C$ empirically from the computed errors by fitting $\\varepsilon$ versus $h/R$ and then propose a mesh refinement criterion: for a specified error tolerance $\\varepsilon_{\\text{tol}}$ (dimensionless, expressed as a decimal), choose\n$$\nh_{\\max} \\approx \\frac{\\varepsilon_{\\text{tol}}\\,R}{C}.\n$$\n\nImplement a complete, runnable program that:\n1. Builds the masked finite-difference operator on a Cartesian grid for the disk and computes $\\lambda_{\\text{num}}$ for each test case using a symmetric sparse eigensolver.\n2. Computes $\\varepsilon$ for each test case.\n3. Estimates the constant $C$ using a robust one-parameter fit $C \\approx \\text{median}\\left(\\varepsilon \\, / \\, (h/R)\\right)$ over all test cases, and computes a recommended maximum mesh spacing $h_{\\max}$ for each case using the formula above.\n4. Reports, for each test case, whether the given $h$ meets the refinement criterion, i.e., whether $h \\le h_{\\max}$.\n\nScientific realism requirements:\n- Use the disk of radius $R$ and a grid spanning $[-R,R]\\times[-R,R]$ with uniform spacing $h$. The eigenvalue units are in inverse square meters ($\\text{m}^{-2}$). The relative error $\\varepsilon$ is dimensionless. The recommended mesh spacing $h_{\\max}$ is reported in meters.\n\nTest suite and answer specification:\n- Use the following test cases, each provided as a tuple $(R,h,\\varepsilon_{\\text{tol}})$ with $R$ and $h$ in meters and $\\varepsilon_{\\text{tol}}$ as a decimal:\n    1. $(1.0, 0.05, 0.02)$ representing a typical refinement target on a unit-radius disk.\n    2. $(1.0, 0.2, 0.05)$ representing a coarse grid on a unit-radius disk.\n    3. $(0.5, 0.025, 0.01)$ representing a smaller disk with comparatively fine grid.\n    4. $(1.0, 0.0125, 0.005)$ representing a fine grid on a unit-radius disk.\n- For each test case, compute and return the triple $[\\varepsilon, h_{\\max}, \\text{meets}]$, where $\\varepsilon$ and $h_{\\max}$ are floats and $\\text{meets}$ is a boolean indicating whether $h \\le h_{\\max}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of case results enclosed in square brackets, for example,\n$$\n\\text{[}[\\varepsilon_1,h_{\\max,1},\\text{meets}_1],[\\varepsilon_2,h_{\\max,2},\\text{meets}_2],\\ldots\\text{]}.\n$$\n\nAll mathematical symbols must be presented in LaTeX, and all physical units must be faithfully adhered to as specified above. The final program must be self-contained and must not require any input. The final output format must strictly be a single line containing the list of per-case results.",
            "solution": "The task is to analyze the numerical error introduced by a staircase approximation of a circular boundary when computing the first eigenvalue of the Dirichlet Laplacian using a finite-difference method. We will formulate the computational procedure, implement it to analyze specific test cases, and derive a practical mesh refinement criterion based on the observed error scaling.\n\n**1. The Continuous Eigenproblem**\n\nThe physical problem concerns the time-harmonic acoustic pressure, $p$, in a two-dimensional domain, $\\Omega$. The pressure field is governed by the scalar Helmholtz equation. For modal analysis, this reduces to the eigenvalue problem for the negative Laplacian operator, $-\\Delta$. The domain $\\Omega$ is a disk of radius $R$ centered at the origin. The boundary condition is of the pressure-release or sound-soft type, which corresponds to a homogeneous Dirichlet condition, $p=0$, on the boundary $\\partial\\Omega$. The problem is thus stated as:\n$$\n-\\Delta p = \\lambda p \\quad \\text{in } \\Omega, \\qquad p|_{\\partial\\Omega} = 0.\n$$\nThe solutions to this problem are the eigenpairs $(\\lambda_k, p_k)$, where $\\lambda_k$ are the eigenvalues (related to modal wavenumbers) and $p_k$ are the corresponding eigenfunctions (modes).\n\nFor a disk of radius $R$, the eigenfunctions are separable in polar coordinates. The first, or fundamental, mode is radially symmetric. The analytical expression for the smallest eigenvalue, $\\lambda_{\\text{anal}}$, is known and given by:\n$$\n\\lambda_{\\text{anal}} = \\left(\\frac{j_{0,1}}{R}\\right)^2,\n$$\nwhere $j_{0,1}$ is the first positive root of the Bessel function of the first kind of order zero, $J_0(x)$. The value is approximately $j_{0,1} \\approx 2.4048255577$. The units of $\\lambda$ are inverse length squared, here $\\text{m}^{-2}$.\n\n**2. The Discrete Approximation**\n\nTo solve the problem numerically, we employ the finite-difference method. The continuous domain is replaced by a discrete set of points on a uniform Cartesian grid with spacing $h$. We define a computational grid that covers the square domain $[-R, R] \\times [-R, R]$. A grid point $(x_i, y_j)$ is considered an *interior* point if it lies inside the disk, i.e., $x_i^2 + y_j^2 < R^2$. All other points are considered part of the boundary where the pressure is fixed at $p=0$.\n\nThe negative Laplacian operator $-\\Delta$ is approximated at each interior grid point $(i, j)$ using the standard five-point stencil:\n$$\n(-\\Delta_h p)_{i,j} = \\frac{4p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1}}{h^2}.\n$$\nApplying this approximation at every interior point results in a system of linear equations. Let $N_{\\text{int}}$ be the total number of interior grid points. We can represent the values of the pressure $p$ at these points as a vector $\\mathbf{p}$ of size $N_{\\text{int}}$. The discrete eigenproblem can then be written in matrix form:\n$$\nA \\mathbf{p} = \\lambda \\mathbf{p}.\n$$\nHere, $A$ is an $N_{\\text{int}} \\times N_{\\text{int}}$ sparse matrix representing the discrete operator $-\\Delta_h$. The entries of $A$ are constructed as follows:\n- For each interior point, map its $2$D grid coordinates $(i,j)$ to a unique $1$D index $k \\in \\{0, 1, \\dots, N_{\\text{int}}-1\\}$.\n- The diagonal entry corresponding to point $k$ is $A_{k,k} = 4/h^2$.\n- For each neighbor of point $k$ that is also an interior point (with index $k'$), an off-diagonal entry is set: $A_{k,k'} = -1/h^2$.\n- If a neighbor is on or outside the boundary, its pressure value is $0$ by the Dirichlet condition. This contribution is naturally incorporated into the stencil sum, so no specific matrix entry is needed for these boundary interactions.\n\nThe resulting matrix $A$ is real, symmetric, and positive definite. The smallest eigenvalue of this matrix, which we denote $\\lambda_{\\text{num}}$, is the numerical approximation of $\\lambda_{\\text{anal}}$. It can be computed efficiently using a sparse symmetric eigensolver.\n\n**3. Error Analysis and Scaling Law**\n\nThe discretization introduces errors. The primary source of error in this formulation is the \"staircase\" approximation of the smooth, curved boundary of the disk. While the five-point stencil is second-order accurate, $O(h^2)$, in the interior of the domain, the geometric error at the boundary is only first-order, $O(h)$. This lower-order error dominates the total error.\n\nWe quantify the relative error, $\\varepsilon$, in the computed eigenvalue as:\n$$\n\\varepsilon = \\left|\\frac{\\lambda_{\\text{num}}-\\lambda_{\\text{anal}}}{\\lambda_{\\text{anal}}}\\right|.\n$$\nBased on domain perturbation theory, the leading-order error is expected to scale linearly with the mesh spacing relative to the domain size:\n$$\n\\varepsilon \\approx C \\frac{h}{R},\n$$\nwhere $C$ is a dimensionless constant that depends on the geometry and the specific boundary implementation but is approximately independent of $h$ and $R$ for small $h/R$.\n\n**4. Mesh Refinement Criterion**\n\nThe goal is to determine a suitable mesh spacing $h$ to achieve a desired error tolerance $\\varepsilon_{\\text{tol}}$. First, we estimate the constant $C$ empirically. By running simulations for several combinations of $R$ and $h$ (the provided test cases), we compute the ratio $\\varepsilon / (h/R)$ for each case. A robust estimate for $C$ is obtained by taking the median of these values.\n\nOnce $C$ is known, we can invert the scaling law to determine the maximum permissible mesh spacing, $h_{\\max}$, for a given tolerance $\\varepsilon_{\\text{tol}}$:\n$$\nh_{\\max} \\approx \\frac{\\varepsilon_{\\text{tol}} R}{C}.\n$$\nA given mesh with spacing $h$ is considered sufficiently refined if it satisfies the criterion $h \\le h_{\\max}$.\n\nThe implemented program will execute these steps:\n1. For each test case $(R, h, \\varepsilon_{\\text{tol}})$, construct the matrix $A$ and compute $\\lambda_{\\text{num}}$.\n2. Calculate the corresponding relative error $\\varepsilon$.\n3. After processing all cases, estimate the scaling constant $C$ as the median of all computed $\\varepsilon / (h/R)$ ratios.\n4. For each test case, calculate the recommended $h_{\\max}$ using the estimated $C$ and the case-specific $\\varepsilon_{\\text{tol}}$ and $R$.\n5. Report the computed triple $[\\varepsilon, h_{\\max}, (h \\le h_{\\max})]$ for each case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn_zeros\nfrom scipy.sparse import coo_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef solve():\n    \"\"\"\n    Computes staircasing error for the Dirichlet-Laplacian eigenvalue on a disk,\n    estimates the error scaling constant, and proposes a mesh refinement criterion.\n    \"\"\"\n    # The first positive zero of the Bessel function of the first kind of order zero, J0(x).\n    j01 = jn_zeros(0, 1)[0]\n    \n    # Test cases: (R, h, eps_tol)\n    # R: radius in meters\n    # h: grid spacing in meters\n    # eps_tol: target relative error tolerance (dimensionless)\n    test_cases = [\n        (1.0, 0.05, 0.02),\n        (1.0, 0.2, 0.05),\n        (0.5, 0.025, 0.01),\n        (1.0, 0.0125, 0.005),\n    ]\n\n    # --- Pass 1: Compute numerical errors for all test cases ---\n    computed_data = []\n    ratios_for_C = []\n\n    for R, h, eps_tol in test_cases:\n        # 1. Grid and Mask Generation\n        # Create a centered Cartesian grid that encloses the disk.\n        # The number of points from center to edge is determined by floor(R/h).\n        lim = int(np.floor(R / h))\n        coords = np.arange(-lim, lim + 1) * h\n        grid_dim = len(coords)\n        xx, yy = np.meshgrid(coords, coords)\n        \n        # Create a boolean mask for grid points inside the disk.\n        mask = (xx**2 + yy**2) < R**2\n        \n        n_interior = np.sum(mask)\n        \n        # Map 2D grid indices of interior points to 1D linear indices.\n        idx_map = -np.ones((grid_dim, grid_dim), dtype=int)\n        idx_map[mask] = np.arange(n_interior)\n\n        # 2. Matrix Assembly using Coordinate (COO) format for efficiency\n        row_ind, col_ind, data = [], [], []\n        \n        # Iterate over all grid points to build the discrete operator matrix.\n        for i in range(grid_dim):\n            for j in range(grid_dim):\n                if mask[i, j]:\n                    k = idx_map[i, j]\n                    \n                    # Diagonal element from the 5-point stencil (4 * p_ij)\n                    row_ind.append(k)\n                    col_ind.append(k)\n                    data.append(4.0)\n\n                    # Off-diagonal elements for neighbors (-1 * p_neighbor)\n                    # For neighbors outside the mask, the pressure is 0 (Dirichlet BC),\n                    # so they don't contribute to the matrix for interior points.\n                    for ni, nj in [(i - 1, j), (i + 1, j), (i, j - 1), (i, j + 1)]:\n                        if 0 <= ni < grid_dim and 0 <= nj < grid_dim and mask[ni, nj]:\n                            k_neighbor = idx_map[ni, nj]\n                            row_ind.append(k)\n                            col_ind.append(k_neighbor)\n                            data.append(-1.0)\n        \n        # Scale matrix entries by 1/h^2.\n        mat_data = np.array(data) / (h**2)\n        \n        # Create the sparse matrix and convert to CSR format for fast arithmetic.\n        A = coo_matrix((mat_data, (row_ind, col_ind)), shape=(n_interior, n_interior)).tocsr()\n        \n        # 3. Eigenvalue Computation\n        # Use a sparse symmetric eigensolver to find the smallest magnitude eigenvalue.\n        eigenvalues, _ = eigsh(A, k=1, which='SM')\n        lambda_num = eigenvalues[0]\n        \n        # 4. Error Calculation\n        lambda_anal = (j01 / R)**2\n        epsilon = np.abs(lambda_num - lambda_anal) / lambda_anal\n        \n        # Store results for the second pass.\n        computed_data.append({'R': R, 'h': h, 'eps_tol': eps_tol, 'epsilon': epsilon})\n        ratios_for_C.append(epsilon / (h / R))\n\n    # --- Pass 2: Estimate C, compute h_max, and check criterion ---\n    \n    # Estimate the scaling constant C as the median of the observed ratios.\n    C = np.median(ratios_for_C)\n    \n    final_results = []\n    for data_point in computed_data:\n        R = data_point['R']\n        h = data_point['h']\n        eps_tol = data_point['eps_tol']\n        epsilon = data_point['epsilon']\n        \n        # Calculate the recommended maximum mesh spacing h_max based on the fitted C.\n        h_max = (eps_tol * R) / C\n        \n        # Check if the given mesh spacing h meets the refinement criterion.\n        meets_criterion = h <= h_max\n        \n        final_results.append([epsilon, h_max, meets_criterion])\n\n    # --- Format and Print Output ---\n    def format_case_result(res):\n        eps_val, hmax_val, meets_val = res\n        # Format booleans as lowercase 'true'/'false' for consistent output.\n        meets_str = str(meets_val).lower()\n        return f\"[{eps_val},{hmax_val},{meets_str}]\"\n\n    output_str = f\"[{','.join([format_case_result(res) for res in final_results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}