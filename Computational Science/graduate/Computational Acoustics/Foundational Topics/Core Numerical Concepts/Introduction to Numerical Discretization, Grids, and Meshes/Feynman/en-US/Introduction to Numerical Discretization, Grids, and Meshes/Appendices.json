{
    "hands_on_practices": [
        {
            "introduction": "Before we can numerically solve equations, we must first represent continuous fields on a discrete grid. This practice explores the fundamental limitation of this process, known as aliasing. By modeling sampling in the frequency domain, we can understand why a grid with spacing $h$ can only uniquely represent wavenumbers in the range $|k| \\le \\pi/h$, and how to correctly interpret or mitigate the errors that arise when this condition is violated .",
            "id": "4127352",
            "problem": "Consider a one-dimensional linear acoustic pressure field $p(x,t)$ on the infinite line, whose spatial structure at a fixed time $t=t_0$ is $p(x)=\\operatorname{Re}\\{\\hat{p}(k)\\,e^{\\mathrm{i} k x}\\}$ for each plane-wave component of wavenumber $k$. Suppose we sample $p(x)$ on a uniform spatial grid with spacing $h>0$, i.e., we observe $p_j=p(jh)$ for all integers $j\\in\\mathbb{Z}$. Using only the following fundamental bases: (i) the definition of spatial Fourier transform, (ii) linearity of the Fourier transform, and (iii) the sampling operation as multiplication by a Dirac comb in space and its corresponding effect in wavenumber, reason from first principles about when aliasing occurs and how it can be mitigated.\n\nAssume the spatial Fourier transform is defined by $P(k)=\\int_{-\\infty}^{\\infty} p(x)\\,e^{-\\mathrm{i} k x}\\,dx$. Sampling with spacing $h$ corresponds to multiplying $p(x)$ by the Dirac comb $\\Sha_h(x)=\\sum_{j\\in\\mathbb{Z}}\\delta(x-jh)$, so the sampled field is $p_s(x)=p(x)\\,\\Sha_h(x)$, and recall that multiplication in $x$ corresponds to convolution in $k$.\n\nUsing this framework, determine which of the following statements are correct. Select all that apply.\n\nA. When sampling a continuous plane wave $p(x)=e^{\\mathrm{i} k x}$ on a uniform grid of spacing $h$, the discrete spectrum consists of impulses located at $k+2\\pi m/h$ for all integers $m$, i.e., the spectrum is periodic in wavenumber with period $2\\pi/h$. Consequently, if $\\lvert k\\rvert > \\pi/h$, the sampled data are indistinguishable (from the perspective of the discrete spectrum restricted to the primary interval $(-\\pi/h,\\pi/h]$) from a plane wave with an aliased wavenumber $k_{\\mathrm{alias}}=k-2\\pi m/h$ chosen so that $k_{\\mathrm{alias}}\\in(-\\pi/h,\\pi/h]$.\n\nB. For a plane wave with $k=(1.3)\\pi/h$, the aliased wavenumber observed in the principal interval is $k_{\\mathrm{alias}}=-(0.7)\\pi/h$.\n\nC. Using a fourth-order centered finite-difference stencil to approximate the second derivative in space increases the Nyquist wavenumber beyond $\\pi/h$, thereby eliminating aliasing for $\\lvert k\\rvert\\le 2\\pi/h$ even on the same grid.\n\nD. Applying a spatial low-pass filter to the continuous field with a cutoff strictly below the Nyquist wavenumber $\\pi/h$ prior to sampling can remove aliasing, provided the field is thus made bandlimited.\n\nE. Applying a digital low-pass filter after sampling can always remove aliasing introduced by under-resolution.\n\nF. Halving the grid spacing $h$ guarantees alias-free sampling for any finite-energy field $p(x)\\in L^2(\\mathbb{R})$.\n\nAnswer by selecting the correct option(s).",
            "solution": "The user wants me to act as a meticulous STEM professor. This involves critically validating the provided problem statement before attempting a solution. If the statement is valid, I will derive the solution from first principles and analyze each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Field:** A one-dimensional linear acoustic pressure field $p(x,t)$.\n*   **Spatial Structure:** At a fixed time $t=t_0$, the spatial structure for a plane-wave component is $p(x)=\\operatorname{Re}\\{\\hat{p}(k)\\,e^{\\mathrm{i} k x}\\}$ with wavenumber $k$.\n*   **Sampling:** The field $p(x)$ is sampled on a uniform spatial grid with spacing $h>0$, yielding discrete values $p_j=p(jh)$ for all integers $j\\in\\mathbb{Z}$.\n*   **Sampling Model:** The sampling operation is modeled as the multiplication of the continuous field $p(x)$ by a Dirac comb, $\\Sha_h(x)=\\sum_{j\\in\\mathbb{Z}}\\delta(x-jh)$. The sampled field is $p_s(x)=p(x)\\,\\Sha_h(x)$.\n*   **Fourier Transform Definition:** The spatial Fourier transform is defined as $P(k)=\\int_{-\\infty}^{\\infty} p(x)\\,e^{-\\mathrm{i} k x}\\,dx$.\n*   **Convolution Rule:** Multiplication in the spatial domain ($x$) corresponds to convolution in the wavenumber domain ($k$).\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of Fourier analysis and digital signal processing. The use of the Dirac comb to model sampling and the subsequent analysis in the frequency domain is the standard, canonical approach taught in physics, engineering, and applied mathematics. All concepts are well-established.\n2.  **Well-Posed:** The problem provides a clear theoretical framework (definitions of sampling, Fourier transform) and asks for an evaluation of statements based on this framework. A unique determination of the correctness of each statement is possible.\n3.  **Objective:** The problem is stated using precise, unambiguous mathematical language. There are no subjective elements.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, and objective. It contains no contradictions or missing information required to answer the question. It is a valid problem that can be solved as stated.\n\n### Derivation from First Principles\n\nThe core of the problem is to understand the effect of sampling on the spectrum of a continuous signal. We start with the given model.\n\nThe sampled signal is $p_s(x) = p(x)\\Sha_h(x)$, where $p(x)$ is the continuous signal and $\\Sha_h(x) = \\sum_{j \\in \\mathbb{Z}} \\delta(x-jh)$ is the Dirac comb with spacing $h$. The problem states that multiplication in the spatial domain corresponds to convolution in the wavenumber domain. Let $P(k) = \\mathcal{F}\\{p(x)\\}$ and $P_s(k) = \\mathcal{F}\\{p_s(x)\\}$. Then, up to a constant scaling factor, $P_s(k)$ is the convolution of $P(k)$ and $\\mathcal{F}\\{\\Sha_h(x)\\}$.\n\nLet's find the Fourier transform of the Dirac comb. Using the Poisson summation formula or properties of Fourier series for periodic distributions, it can be shown that the Fourier transform of a Dirac comb is another Dirac comb:\n$$ \\mathcal{F}\\{\\Sha_h(x)\\} = \\mathcal{F}\\left\\{\\sum_{j \\in \\mathbb{Z}} \\delta(x-jh)\\right\\} = \\frac{2\\pi}{h} \\sum_{m \\in \\mathbb{Z}} \\delta\\left(k - \\frac{2\\pi m}{h}\\right) $$\nThe convolution theorem for the specified Fourier transform pair is $\\mathcal{F}\\{f(x)g(x)\\} = \\frac{1}{2\\pi} \\left( \\mathcal{F}\\{f\\} * \\mathcal{F}\\{g\\} \\right)(k)$.\nApplying this to our sampled signal $p_s(x)$:\n$$ P_s(k) = \\mathcal{F}\\{p(x)\\Sha_h(x)\\} = \\frac{1}{2\\pi} \\left( P(k) * \\mathcal{F}\\{\\Sha_h(x)\\} \\right) $$\n$$ P_s(k) = \\frac{1}{2\\pi} \\left( P(k) * \\left( \\frac{2\\pi}{h} \\sum_{m \\in \\mathbb{Z}} \\delta\\left(k - \\frac{2\\pi m}{h}\\right) \\right) \\right) $$\n$$ P_s(k) = \\frac{1}{h} \\left( P(k) * \\sum_{m \\in \\mathbb{Z}} \\delta\\left(k - \\frac{2\\pi m}{h}\\right) \\right) $$\nConvolution with a shifted Dirac delta $\\delta(k-a)$ results in a shift of the original function: $(f * \\delta_a)(k) = f(k-a)$. Thus, we get:\n$$ P_s(k) = \\frac{1}{h} \\sum_{m \\in \\mathbb{Z}} P\\left(k - \\frac{2\\pi m}{h}\\right) $$\nThis is the fundamental result: the spectrum of the sampled signal is an infinite sum of copies of the original signal's spectrum, $P(k)$, scaled by $1/h$ and shifted by integer multiples of the sampling wavenumber $k_s = 2\\pi/h$.\n\n**Aliasing** occurs when these spectral copies overlap. The baseband spectrum is the copy for $m=0$, centered at $k=0$. The next copies are centered at $k = \\pm 2\\pi/h$. Overlap is avoided if the original spectrum $P(k)$ is zero for all wavenumbers with magnitude greater than or equal to half the sampling wavenumber. This limit is the **Nyquist wavenumber**, $k_N = k_s/2 = \\pi/h$. If $P(k)$ has non-zero components for $|k| \\ge \\pi/h$, the \"tails\" of the spectrum will fold back into the primary interval $(-\\pi/h, \\pi/h]$, corrupting the baseband spectrum. This phenomenon is aliasing.\n\n### Option-by-Option Analysis\n\n**A. When sampling a continuous plane wave $p(x)=e^{\\mathrm{i} k x}$ on a uniform grid of spacing $h$, the discrete spectrum consists of impulses located at $k+2\\pi m/h$ for all integers $m$, i.e., the spectrum is periodic in wavenumber with period $2\\pi/h$. Consequently, if $\\lvert k\\rvert > \\pi/h$, the sampled data are indistinguishable (from the perspective of the discrete spectrum restricted to the primary interval $(-\\pi/h,\\pi/h]$) from a plane wave with an aliased wavenumber $k_{\\mathrm{alias}}=k-2\\pi m/h$ chosen so that $k_{\\mathrm{alias}}\\in(-\\pi/h,\\pi/h]$.**\n\nLet's test this statement. For a single plane wave $p(x) = e^{\\mathrm{i} k_0 x}$ (using $k_0$ to denote the specific wavenumber), its Fourier transform is a Dirac delta function: $P(k) = \\mathcal{F}\\{e^{\\mathrm{i} k_0 x}\\} = 2\\pi\\delta(k-k_0)$.\nUsing our derived formula for the sampled spectrum:\n$$ P_s(k) = \\frac{1}{h} \\sum_{m \\in \\mathbb{Z}} 2\\pi \\delta\\left(\\left(k - \\frac{2\\pi m}{h}\\right)-k_0\\right) = \\frac{2\\pi}{h} \\sum_{m \\in \\mathbb{Z}} \\delta\\left(k - \\left(k_0+\\frac{2\\pi m}{h}\\right)\\right) $$\nThis shows the spectrum is a train of impulses at locations $k = k_0 + 2\\pi m/h$ for all integers $m$. It is periodic with period $2\\pi/h$. The first part of the statement is correct (using $k$ instead of $k_0$ is just a notational choice).\nNow, for the second part. Consider the sampled values: $p_j = p(jh) = e^{\\mathrm{i} k_0 j h}$. If we have an aliased wavenumber $k_{\\mathrm{alias}} = k_0 - 2\\pi m_0/h$ for some integer $m_0$, the sampled values of a wave with this wavenumber would be:\n$$ e^{\\mathrm{i} k_{\\mathrm{alias}} j h} = e^{\\mathrm{i} (k_0 - 2\\pi m_0/h) j h} = e^{\\mathrm{i} k_0 j h} e^{-\\mathrm{i} (2\\pi m_0 j h)/h} = e^{\\mathrm{i} k_0 j h} e^{-\\mathrm{i} 2\\pi m_0 j} $$\nSince $j$ and $m_0$ are integers, Euler's formula gives $e^{-\\mathrm{i} 2\\pi m_0 j} = \\cos(-2\\pi m_0 j) + \\mathrm{i}\\sin(-2\\pi m_0 j) = 1$. Thus, $e^{\\mathrm{i} k_{\\mathrm{alias}} j h} = e^{\\mathrm{i} k_0 j h}$. The sampled values are identical. If $|k_0| > \\pi/h$, we can always find a unique integer $m_0$ to shift $k_0$ into the principal interval $(-\\pi/h,\\pi/h]$. The sampled data are therefore computationally indistinguishable.\nThe statement is **Correct**.\n\n**B. For a plane wave with $k=(1.3)\\pi/h$, the aliased wavenumber observed in the principal interval is $k_{\\mathrm{alias}}=-(0.7)\\pi/h$.**\n\nThe principal interval for analysis is $(-\\pi/h, \\pi/h]$. The given wavenumber is $k_0 = 1.3\\pi/h$. This is outside the interval, as $1.3 > 1$. We must find an integer $m$ such that $k_{\\mathrm{alias}} = k_0 - 2\\pi m/h$ falls within this interval.\nLet's try $m=1$:\n$$ k_{\\mathrm{alias}} = 1.3\\frac{\\pi}{h} - \\frac{2\\pi(1)}{h} = (1.3 - 2.0)\\frac{\\pi}{h} = -0.7\\frac{\\pi}{h} $$\nThe resulting wavenumber $k_{\\mathrm{alias}} = -0.7\\pi/h$ satisfies $-\\pi/h  -0.7\\pi/h \\le \\pi/h$. It is correctly located in the principal interval.\nThe statement is **Correct**.\n\n**C. Using a fourth-order centered finite-difference stencil to approximate the second derivative in space increases the Nyquist wavenumber beyond $\\pi/h$, thereby eliminating aliasing for $\\lvert k\\rvert\\le 2\\pi/h$ even on the same grid.**\n\nThis statement is fundamentally flawed. The Nyquist wavenumber, $k_N = \\pi/h$, is solely determined by the grid spacing $h$. It represents the highest wavenumber that can be uniquely represented on that grid. Applying a numerical operator, such as a finite-difference stencil, is an operation performed on the *already sampled* data. At the point of sampling, any information about wavenumbers $|k| > \\pi/h$ has already been irrecoverably corrupted by aliasing. No subsequent processing on the discrete data, regardless of its order of accuracy, can restore this information or change the fundamental sampling limit of the grid. A higher-order stencil improves the accuracy of the derivative approximation for wavenumbers *within* the representable range $(-\\pi/h, \\pi/h]$, but it cannot expand this range.\nThe statement is **Incorrect**.\n\n**D. Applying a spatial low-pass filter to the continuous field with a cutoff strictly below the Nyquist wavenumber $\\pi/h$ prior to sampling can remove aliasing, provided the field is thus made bandlimited.**\n\nThis describes the standard and correct procedure for anti-aliasing. Aliasing occurs when the continuous signal contains energy at wavenumbers $|k| \\ge \\pi/h$. If an ideal low-pass filter with a cutoff wavenumber $k_c  \\pi/h$ is applied to the continuous signal $p(x)$ *before* it is sampled, all components with $|k| \\ge k_c$ are removed. The resulting signal is bandlimited to the interval $(-k_c, k_c)$. Since this interval is entirely contained within the Nyquist interval $(-\\pi/h, \\pi/h)$, the spectral replicas created by sampling will not overlap. Thus, aliasing is prevented.\nThe statement is **Correct**.\n\n**E. Applying a digital low-pass filter after sampling can always remove aliasing introduced by under-resolution.**\n\nThis is the opposite of option D and is incorrect. Once sampling has occurred, aliasing has already mixed high-wavenumber components into the low-wavenumber range. For example, as shown in option B, a component at $k_0 = 1.3\\pi/h$ becomes indistinguishable from a component at $k_{\\mathrm{alias}} = -0.7\\pi/h$. A digital filter, which operates on the sampled data, cannot distinguish between a true signal component at $-0.7\\pi/h$ and the aliased component from $1.3\\pi/h$. Therefore, a digital low-pass filter can remove high frequencies present in the sampled spectrum (i.e., those near $\\pm\\pi/h$), but it cannot \"un-alias\" or restore the original high-frequency components that have been folded down to lower frequencies.\nThe statement is **Incorrect**.\n\n**F. Halving the grid spacing $h$ guarantees alias-free sampling for any finite-energy field $p(x)\\in L^2(\\mathbb{R})$.**\n\nHalving the grid spacing to $h/2$ doubles the Nyquist wavenumber to $k_N = \\pi/(h/2) = 2\\pi/h$. This doubles the range of wavenumbers that can be sampled without aliasing. However, the statement makes an absolute claim for *any* finite-energy field, i.e., any $p(x) \\in L^2(\\mathbb{R})$. By the Plancherel theorem, a function is in $L^2(\\mathbb{R})$ if and only if its Fourier transform is in $L^2(\\mathbb{R})$. This condition does not require the function to be band-limited. For example, a Gaussian function $p(x) = e^{-ax^2}$ is in $L^2(\\mathbb{R})$, but its Fourier transform, $P(k) \\propto e^{-k^2/(4a)}$, has infinite support (it is non-zero for all $k$). For such a non-band-limited signal, no matter what finite sampling interval $h$ is chosen, there will always be some energy at wavenumbers $|k| \\ge \\pi/h$. Therefore, some amount of aliasing, however small, will always occur. The statement's guarantee of \"alias-free\" sampling is too strong.\nThe statement is **Incorrect**.",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "Once a field is represented on a grid, we need numerical tools to approximate operators like derivatives. This exercise guides you through the construction of a fourth-order accurate finite difference stencil for the second derivative, $\\partial_{xx} p$, from first principles using Taylor series expansions. Mastering this process is key to developing and understanding the accuracy and dispersive properties of numerical schemes used in computational acoustics .",
            "id": "4127380",
            "problem": "Consider the $1$-dimensional linear acoustic wave equation $\\partial_{tt} p = c^{2} \\partial_{xx} p$ on a uniform spatial grid $x_{j} = j h$ with grid spacing $h > 0$, and leave time continuous (semi-discrete model). Construct a symmetric $5$-point finite difference approximation $D_{h} p(x_{j}, t)$ to the spatial second derivative $\\partial_{xx} p(x_{j}, t)$ that is $4$th-order accurate in $h$. Use only the definition of the derivative and Taylor expansion about $x_{j}$ to determine the stencil coefficients; require that the approximation annihilates constants and linear functions, reproduces the quadratic second derivative, and suppresses the leading even-order truncation term so that the first nonzero truncation term scales like $h^{4}$. Then, for the semi-discrete wave model $\\partial_{tt} p(x_{j}, t) = c^{2} D_{h} p(x_{j}, t)$, analyze plane wave solutions of the form $p(x, t) = \\exp(i(k x - \\omega t))$ with wavenumber $k \\in \\mathbb{R}$ and angular frequency $\\omega \\in \\mathbb{R}$. Compute the discrete Fourier symbol $\\sigma_{4}(\\xi)$ of $D_{h}$, where $\\xi \\equiv k h$, and verify that the semi-discrete dispersion relation satisfies $\\omega^{2} = - c^{2} \\sigma_{4}(\\xi)$ and that $\\sigma_{4}(\\xi)$ recovers the continuum symbol $-k^{2}$ to $4$th-order accuracy as $h \\to 0$. Your final answer must be the fully simplified closed-form analytic expression for $\\sigma_{4}(\\xi)$ in terms of $\\xi$ and $h$, with no numerical approximation or rounding.",
            "solution": "The problem statement will first be validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Governing Equation**: $1$-dimensional linear acoustic wave equation, $\\partial_{tt} p = c^{2} \\partial_{xx} p$.\n-   **Spatial Grid**: Uniform grid $x_{j} = j h$, with grid spacing $h > 0$.\n-   **Discretization Model**: Semi-discrete, with time left continuous.\n-   **Task 1**: Construct a symmetric $5$-point finite difference approximation, denoted $D_{h} p(x_{j}, t)$, for the second spatial derivative $\\partial_{xx} p(x_{j}, t)$.\n-   **Approximation Properties**: The approximation must be $4$th-order accurate in $h$.\n-   **Derivation Method**: Use Taylor expansion about $x_{j}$ under the constraints that the approximation:\n    1.  Annihilates constants and linear functions.\n    2.  Reproduces the second derivative of a quadratic function exactly.\n    3.  Suppresses the leading even-order truncation term, such that the first non-zero truncation term is of order $h^{4}$.\n-   **Task 2**: For the semi-discrete model $\\partial_{tt} p(x_{j}, t) = c^{2} D_{h} p(x_{j}, t)$, analyze plane wave solutions of the form $p(x, t) = \\exp(i(k x - \\omega t))$, where $k \\in \\mathbb{R}$ is the wavenumber and $\\omega \\in \\mathbb{R}$ is the angular frequency.\n-   **Task 3**: Compute the discrete Fourier symbol $\\sigma_{4}(\\xi)$ of the operator $D_{h}$, where $\\xi \\equiv k h$.\n-   **Task 4**: Verify that the semi-discrete dispersion relation is $\\omega^{2} = - c^{2} \\sigma_{4}(\\xi)$.\n-   **Task 5**: Verify that $\\sigma_{4}(\\xi)$ converges to the continuum symbol, $-k^{2}$, with $4$th-order accuracy as $h \\to 0$.\n-   **Required Final Answer**: The fully simplified closed-form analytic expression for $\\sigma_{4}(\\xi)$ in terms of $\\xi$ and $h$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem concerns the numerical discretization of the wave equation, a fundamental topic in computational physics and engineering, particularly computational acoustics. The methods specified (finite differences, Taylor series analysis, Fourier analysis) are standard and mathematically rigorous. The problem is free of scientific inaccuracies.\n-   **Well-Posed**: The problem is clearly stated and provides a complete set of constraints to uniquely determine the finite difference stencil. The subsequent analysis follows a standard, well-defined procedure. A unique and meaningful solution exists.\n-   **Objective**: The language is formal, precise, and devoid of subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and complete. It is a valid, standard problem in numerical analysis for partial differential equations. The solution process may proceed.\n\n### Solution\n\nThe first step is to derive the coefficients of the symmetric $5$-point stencil for the second derivative, $\\partial_{xx} p$. A general symmetric $5$-point stencil centered at $x_j = jh$ for an operator $D_h$ approximating $\\partial_{xx}$ can be written as:\n$$\nD_{h} p(x_{j}) = \\frac{1}{h^2} \\left( c_{-2} p(x_{j-2}) + c_{-1} p(x_{j-1}) + c_0 p(x_j) + c_1 p(x_{j+1}) + c_2 p(x_{j+2}) \\right)\n$$\nSymmetry requires that $c_m = c_{-m}$, so we have $c_1 = c_{-1}$ and $c_2 = c_{-2}$. The stencil becomes:\n$$\nD_{h} p_j = \\frac{1}{h^2} \\left[ c_2 p_{j-2} + c_1 p_{j-1} + c_0 p_j + c_1 p_{j+1} + c_2 p_{j+2} \\right]\n$$\nwhere we use the shorthand $p_j \\equiv p(x_j)$. To determine the coefficients $c_0, c_1, c_2$, we perform a Taylor series expansion of each term $p_{j+m}$ around $x_j$. For a sufficiently smooth function $p(x)$:\n$$\np(x_j \\pm m h) = p_j \\pm (mh) p'_j + \\frac{(mh)^2}{2!} p''_j \\pm \\frac{(mh)^3}{3!} p'''_j + \\frac{(mh)^4}{4!} p^{(4)}_j + \\frac{(mh)^5}{5!} p^{(5)}_j + \\frac{(mh)^6}{6!} p^{(6)}_j + O(h^7)\n$$\nSubstituting these expansions into the stencil expression and grouping terms gives:\n\\begin{align*}\nh^2 D_h p_j = c_2(p_{j+2} + p_{j-2}) + c_1(p_{j+1} + p_{j-1}) + c_0 p_j \\\\\n= c_2 \\left( 2p_j + \\frac{(2h)^2}{2} p''_j + \\frac{(2h)^4}{24} p^{(4)}_j + \\frac{(2h)^6}{720} p^{(6)}_j + \\dots \\right) \\\\\n\\quad + c_1 \\left( 2p_j + \\frac{h^2}{2} p''_j + \\frac{h^4}{24} p^{(4)}_j + \\frac{h^6}{720} p^{(6)}_j + \\dots \\right) + c_0 p_j \\\\\n= p_j (2c_1 + 2c_2 + c_0) \\\\\n\\quad + p''_j h^2 (c_1 + 4c_2) \\\\\n\\quad + p^{(4)}_j h^4 \\left( \\frac{c_1}{12} + \\frac{16c_2}{12} \\right) \\\\\n\\quad + p^{(6)}_j h^6 \\left( \\frac{c_1}{360} + \\frac{64c_2}{360} \\right) + O(h^8)\n\\end{align*}\nFor $D_h p_j$ to be a consistent approximation of $p''_j$, we must match the coefficients of the derivatives. To have $D_h p_j = p''_j + (\\text{error})$, we require:\n\\begin{enumerate}\n    \\item Coefficient of $p_j$ must be $0$: $c_0 + 2c_1 + 2c_2 = 0$. This ensures the stencil annihilates constant functions. Since the stencil is symmetric, it automatically annihilates linear functions as well.\n    \\item Coefficient of $p''_j$ must be $1$: $c_1 + 4c_2 = 1$.\n    \\item For $4$th-order accuracy, the $h^2$ error term (proportional to $p^{(4)}_j$) must vanish: $\\frac{c_1}{12} + \\frac{16c_2}{12} = 0$, which simplifies to $c_1 + 16c_2 = 0$.\n\\end{enumerate}\nWe now have a system of three linear equations for the three unknown coefficients:\n\\begin{align*}\nc_0 + 2c_1 + 2c_2 = 0 \\\\\nc_1 + 4c_2 = 1 \\\\\nc_1 + 16c_2 = 0\n\\end{align*}\nSubtracting the second equation from the third yields $12c_2 = -1$, so $c_2 = -\\frac{1}{12}$.\nSubstituting $c_2$ into the third equation gives $c_1 + 16(-\\frac{1}{12}) = 0$, so $c_1 = \\frac{16}{12} = \\frac{4}{3}$.\nFinally, substituting $c_1$ and $c_2$ into the first equation: $c_0 + 2(\\frac{4}{3}) + 2(-\\frac{1}{12}) = 0 \\Rightarrow c_0 + \\frac{8}{3} - \\frac{1}{6} = 0 \\Rightarrow c_0 + \\frac{15}{6} = 0 \\Rightarrow c_0 = -\\frac{5}{2}$.\nThe finite difference operator is thus:\n$$\nD_h p_j = \\frac{1}{h^2} \\left[ -\\frac{1}{12}p_{j-2} + \\frac{4}{3}p_{j-1} - \\frac{5}{2}p_j + \\frac{4}{3}p_{j+1} - \\frac{1}{12}p_{j+2} \\right] = \\frac{1}{12h^2} \\left[ -p_{j-2} + 16p_{j-1} - 30p_j + 16p_{j+1} - p_{j+2} \\right]\n$$\nThe leading error term is given by the coefficient of $p^{(6)}_j$:\n$$\n\\text{Error} = h^4 \\left( \\frac{c_1}{360} + \\frac{64c_2}{360} \\right) p^{(6)}_j = \\frac{h^4}{360} \\left( \\frac{4}{3} + 64(-\\frac{1}{12}) \\right) p^{(6)}_j = \\frac{h^4}{360} \\left( \\frac{4}{3} - \\frac{16}{3} \\right) p^{(6)}_j = -\\frac{12h^4}{3 \\cdot 360} p^{(6)}_j = -\\frac{h^4}{90} p^{(6)}_j\n$$\nThe approximation is indeed $4$th-order accurate.\n\nNext, we analyze the semi-discrete equation $\\partial_{tt} p_j(t) = c^2 D_h p_j(t)$ with a plane wave solution $p(x,t) = \\exp(i(kx - \\omega t))$. At grid point $x_j=jh$, this becomes $p_j(t) = \\exp(i(kjh - \\omega t))$.\nThe time derivative is $\\partial_{tt} p_j(t) = (-i\\omega)^2 p_j(t) = -\\omega^2 p_j(t)$.\nTo find the action of $D_h$ on $p_j(t)$, we note that $p_{j+m}(t) = \\exp(i(k(j+m)h - \\omega t)) = \\exp(imkh) p_j(t) = \\exp(im\\xi) p_j(t)$, where $\\xi=kh$.\nApplying the operator $D_h$:\n\\begin{align*}\nD_h p_j(t) = \\frac{1}{12h^2} \\left[ -p_{j-2} + 16p_{j-1} - 30p_j + 16p_{j+1} - p_{j+2} \\right] \\\\\n= \\frac{p_j(t)}{12h^2} \\left[ -\\exp(-2i\\xi) + 16\\exp(-i\\xi) - 30 + 16\\exp(i\\xi) - \\exp(2i\\xi) \\right]\n\\end{align*}\nThe discrete Fourier symbol $\\sigma_4(\\xi)$ is defined as the multiplier of $p_j(t)$, so $D_h p_j(t) = \\sigma_4(\\xi) p_j(t)$.\n$$\n\\sigma_4(\\xi) = \\frac{1}{12h^2} \\left[ 16(\\exp(i\\xi) + \\exp(-i\\xi)) - (\\exp(2i\\xi) + \\exp(-2i\\xi)) - 30 \\right]\n$$\nUsing the identity $\\cos(z) = \\frac{\\exp(iz) + \\exp(-iz)}{2}$, we simplify the symbol:\n$$\n\\sigma_4(\\xi) = \\frac{1}{12h^2} \\left[ 32\\cos(\\xi) - 2\\cos(2\\xi) - 30 \\right] = \\frac{1}{6h^2} \\left[ 16\\cos(\\xi) - \\cos(2\\xi) - 15 \\right]\n$$\nTo obtain a more compact form, we use the double-angle identity $\\cos(2\\xi) = 2\\cos^2(\\xi) - 1$:\n\\begin{align*}\n\\sigma_4(\\xi) = \\frac{1}{6h^2} \\left[ 16\\cos(\\xi) - (2\\cos^2(\\xi) - 1) - 15 \\right] \\\\\n= \\frac{1}{6h^2} \\left[ -2\\cos^2(\\xi) + 16\\cos(\\xi) - 14 \\right] \\\\\n= -\\frac{1}{3h^2} \\left[ \\cos^2(\\xi) - 8\\cos(\\xi) + 7 \\right]\n\\end{align*}\nThe quadratic in $\\cos(\\xi)$ can be factored:\n$$\n\\sigma_4(\\xi) = -\\frac{1}{3h^2} (\\cos(\\xi) - 1)(\\cos(\\xi) - 7)\n$$\nThis is the required simplified closed-form expression for the symbol.\n\nNow, we verify the dispersion relation. Substituting the expressions for $\\partial_{tt} p_j$ and $D_h p_j$ into the semi-discrete wave equation yields:\n$$\n-\\omega^2 p_j(t) = c^2 \\sigma_4(\\xi) p_j(t)\n$$\nDividing by $p_j(t)$ (which is non-trivial) gives $\\omega^2 = - c^2 \\sigma_4(\\xi)$, which confirms the specified dispersion relation.\n\nFinally, we verify the accuracy of the symbol. The symbol of the continuum operator $\\partial_{xx}$ is $-k^2$. We must show that $\\sigma_4(\\xi) \\to -k^2$ with an error of $O(h^4)$. We expand $\\sigma_4(\\xi)$ in a Taylor series for small $\\xi = kh$.\n$$\n\\cos(\\xi) = 1 - \\frac{\\xi^2}{2!} + \\frac{\\xi^4}{4!} - \\frac{\\xi^6}{6!} + O(\\xi^8) = 1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24} - \\frac{\\xi^6}{720} + O(\\xi^8)\n$$\nFrom the coefficient calculation for the general Taylor expansion of the operator, we know that the operator expansion is $D_h = \\partial_{xx} - \\frac{h^4}{90} \\partial_{xxxxxx} + O(h^6)$.\nApplying this to $p(x) = \\exp(ikx)$ gives:\n$$\n\\sigma_4(\\xi) = (ik)^2 - \\frac{h^4}{90} (ik)^6 + O(h^6) = -k^2 - \\frac{h^4}{90}(-k^6) + O(h^6) = -k^2 + \\frac{k^6 h^4}{90} + O(h^6)\n$$\nThus, $\\sigma_4(\\xi) = -k^2 + O(h^4)$, which verifies that the discrete symbol recovers the continuous symbol to $4$th-order accuracy in $h$.\n\nThe final answer is the derived expression for $\\sigma_4(\\xi)$.",
            "answer": "$$\n\\boxed{-\\frac{1}{3h^2} (\\cos(\\xi) - 1)(\\cos(\\xi) - 7)}\n$$"
        },
        {
            "introduction": "Numerical methods on structured grids can introduce artifacts where simulated waves travel at different speeds depending on their direction relative to the grid axes. This practice delves into this phenomenon of numerical anisotropy by analyzing the group velocity error in two dimensions. Understanding this concept is crucial for predicting and interpreting the distortion of wavefronts, a common challenge in long-range acoustic propagation simulations .",
            "id": "4127346",
            "problem": "Consider small-amplitude linear acoustics in a homogeneous medium of constant sound speed $c$, modeled by the scalar pressure field $p(\\mathbf{x}, t)$ satisfying the wave equation $\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\nabla^{2} p$. Discretize space on a uniform Cartesian grid with spacing $h$ in both $x$ and $y$ directions, replacing the continuous Laplacian $\\nabla^{2}$ by the standard second-order central-difference operator, but keep time continuous. Assume a narrowband plane-wave solution $p(\\mathbf{x}, t) = \\operatorname{Re}\\{\\hat{p} \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))\\}$ with wavevector $\\mathbf{k}$ of magnitude $k$ and orientation angle $\\theta$ (in radians) measured from the $x$-axis, so that $k_{x} = k \\cos \\theta$ and $k_{y} = k \\sin \\theta$. Define the numerical group velocity magnitude along the direction of propagation by $c_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k}$ at fixed $\\theta$, and the relative group-velocity error by $\\delta(\\theta) = \\frac{c_{g}(\\theta)}{c} - 1$.\n\nStarting only from the continuous wave equation and the definition of the second-order central-difference spatial discretization on the Cartesian grid, derive the semi-discrete dispersion relation, compute $c_{g}(\\theta)$, and obtain the leading-order small-parameter asymptotic formula for $\\delta(\\theta)$ as $kh \\to 0$. Express your final answer as a single closed-form analytic expression for $\\delta(\\theta)$, correct to order $(kh)^{2}$, in terms of $k$, $h$, and $\\theta$ (in radians). Finally, explain how the sign and angular dependence of $\\delta(\\theta)$ implies the late-time wavefront distortions in long-range acoustic propagation simulations, but report only the requested analytic expression for $\\delta(\\theta)$ as your final answer. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- Governing equation: $\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\nabla^{2} p$ for the scalar pressure field $p(\\mathbf{x}, t)$.\n- Medium: Homogeneous with constant sound speed $c$.\n- Discretization: Uniform Cartesian grid with spacing $h$ in both $x$ and $y$ directions. Time remains continuous.\n- Discrete Laplacian: The continuous Laplacian $\\nabla^{2}$ is replaced by the standard second-order central-difference operator.\n- Assumed solution: A narrowband plane-wave $p(\\mathbf{x}, t) = \\operatorname{Re}\\{\\hat{p} \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))\\}$.\n- Wavevector: $\\mathbf{k}$ with magnitude $k$ and orientation angle $\\theta$ (in radians) from the $x$-axis.\n- Wavevector components: $k_{x} = k \\cos \\theta$ and $k_{y} = k \\sin \\theta$.\n- Numerical group velocity magnitude: $c_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k}$ at fixed $\\theta$.\n- Relative group-velocity error: $\\delta(\\theta) = \\frac{c_{g}(\\theta)}{c} - 1$.\n- Objective: Derive the semi-discrete dispersion relation, compute $c_{g}(\\theta)$, and obtain the leading-order small-parameter asymptotic formula for $\\delta(\\theta)$ as $kh \\to 0$, correct to order $(kh)^{2}$. The final answer is the expression for $\\delta(\\theta)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard and fundamental analysis in the field of computational acoustics: the study of numerical dispersion for a finite-difference scheme. The physical model (wave equation), the numerical method (second-order central differences), and the analysis technique (von Neumann analysis to find the dispersion relation and subsequent asymptotic expansion) are all standard and correct. All necessary information is provided, there are no contradictions, and the terms are well-defined. The problem is a formal and verifiable mathematical derivation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Derivation\nThe continuous two-dimensional wave equation is given by\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\nabla^{2} p = c^{2} \\left( \\frac{\\partial^{2} p}{\\partial x^{2}} + \\frac{\\partial^{2} p}{\\partial y^{2}} \\right)\n$$\nWe discretize space on a uniform Cartesian grid where a point is denoted by $(x_j, y_l) = (jh, lh)$, with $j$ and $l$ being integers and $h$ the grid spacing. The pressure at this grid point is $p_{j,l}(t) = p(x_j, y_l, t)$. The standard second-order central-difference approximation for the spatial derivatives are:\n$$\n\\frac{\\partial^{2} p}{\\partial x^{2}} \\bigg|_{(x_j, y_l)} \\approx \\frac{p_{j+1,l}(t) - 2 p_{j,l}(t) + p_{j-1,l}(t)}{h^{2}}\n$$\n$$\n\\frac{\\partial^{2} p}{\\partial y^{2}} \\bigg|_{(x_j, y_l)} \\approx \\frac{p_{j,l+1}(t) - 2 p_{j,l}(t) + p_{j,l-1}(t)}{h^{2}}\n$$\nSubstituting these into the wave equation gives the semi-discrete equation of motion for the pressure at grid point $(j,l)$:\n$$\n\\frac{d^{2} p_{j,l}}{d t^{2}} = \\frac{c^{2}}{h^{2}} \\left[ p_{j+1,l} + p_{j-1,l} + p_{j,l+1} + p_{j,l-1} - 4 p_{j,l} \\right]\n$$\nNext, we substitute the plane-wave solution $p(\\mathbf{x}, t) = \\hat{p} \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))$ into this semi-discrete equation. At grid point $(j,l)$, the solution is $p_{j,l}(t) = \\hat{p} \\exp(i(k_x j h + k_y l h - \\omega t))$. The derivatives and shifted terms are:\n$$\n\\frac{d^{2} p_{j,l}}{d t^{2}} = (-i\\omega)^{2} p_{j,l} = -\\omega^{2} p_{j,l}\n$$\n$$\np_{j+1,l} = \\hat{p} \\exp(i(k_x (j+1) h + k_y l h - \\omega t)) = p_{j,l} \\exp(i k_x h)\n$$\n$$\np_{j-1,l} = p_{j,l} \\exp(-i k_x h)\n$$\n$$\np_{j,l+1} = p_{j,l} \\exp(i k_y h)\n$$\n$$\np_{j,l-1} = p_{j,l} \\exp(-i k_y h)\n$$\nSubstituting these into the semi-discrete equation and cancelling the common factor $p_{j,l}$:\n$$\n-\\omega^{2} = \\frac{c^{2}}{h^{2}} \\left[ \\exp(i k_x h) + \\exp(-i k_x h) + \\exp(i k_y h) + \\exp(-i k_y h) - 4 \\right]\n$$\nUsing Euler's identity, $\\cos(\\alpha) = \\frac{\\exp(i\\alpha) + \\exp(-i\\alpha)}{2}$:\n$$\n-\\omega^{2} = \\frac{c^{2}}{h^{2}} \\left[ 2\\cos(k_x h) + 2\\cos(k_y h) - 4 \\right] = \\frac{2c^{2}}{h^{2}} \\left[ (\\cos(k_x h) - 1) + (\\cos(k_y h) - 1) \\right]\n$$\nUsing the half-angle identity, $1 - \\cos(\\alpha) = 2\\sin^{2}(\\frac{\\alpha}{2})$:\n$$\n-\\omega^{2} = \\frac{2c^{2}}{h^{2}} \\left[ -2\\sin^{2}\\left(\\frac{k_x h}{2}\\right) - 2\\sin^{2}\\left(\\frac{k_y h}{2}\\right) \\right] = -\\frac{4c^{2}}{h^{2}} \\left[ \\sin^{2}\\left(\\frac{k_x h}{2}\\right) + \\sin^{2}\\left(\\frac{k_y h}{2}\\right) \\right]\n$$\nThis yields the semi-discrete dispersion relation:\n$$\n\\omega(k_x, k_y) = \\frac{2c}{h} \\sqrt{\\sin^{2}\\left(\\frac{k_x h}{2}\\right) + \\sin^{2}\\left(\\frac{k_y h}{2}\\right)}\n$$\nTo find the leading-order behavior as $kh \\to 0$, we perform a Taylor expansion. The arguments of the sine functions are small. For a small argument $z$, $\\sin(z) \\approx z - \\frac{z^{3}}{6} + O(z^{5})$, so $\\sin^{2}(z) \\approx \\left(z - \\frac{z^{3}}{6}\\right)^{2} \\approx z^{2} - \\frac{z^{4}}{3} + O(z^{6})$. Applying this expansion to the dispersion relation:\n$$\n\\sin^{2}\\left(\\frac{k_x h}{2}\\right) \\approx \\left(\\frac{k_x h}{2}\\right)^{2} - \\frac{1}{3}\\left(\\frac{k_x h}{2}\\right)^{4} = \\frac{(k_x h)^{2}}{4} - \\frac{(k_x h)^{4}}{48}\n$$\n$$\n\\sin^{2}\\left(\\frac{k_y h}{2}\\right) \\approx \\frac{(k_y h)^{2}}{4} - \\frac{(k_y h)^{4}}{48}\n$$\nThe term inside the square root becomes:\n$$\n\\frac{h^{2}}{4}(k_x^{2} + k_y^{2}) - \\frac{h^{4}}{48}(k_x^{4} + k_y^{4}) + O((kh)^{6})\n$$\nSubstituting $k_x = k \\cos\\theta$, $k_y = k \\sin\\theta$, and $k_x^{2} + k_y^{2} = k^{2}$:\n$$\n\\frac{(kh)^{2}}{4} - \\frac{(kh)^{4}}{48}(\\cos^{4}\\theta + \\sin^{4}\\theta) + O((kh)^{6})\n$$\nThe dispersion relation becomes:\n$$\n\\omega(k, \\theta) = \\frac{2c}{h} \\sqrt{\\frac{(kh)^{2}}{4} \\left[ 1 - \\frac{(kh)^{2}}{12}(\\cos^{4}\\theta + \\sin^{4}\\theta) + \\dots \\right]}\n$$\n$$\n\\omega(k, \\theta) = \\frac{2c}{h} \\frac{kh}{2} \\sqrt{1 - \\frac{(kh)^{2}}{12}(\\cos^{4}\\theta + \\sin^{4}\\theta) + \\dots}\n$$\nUsing the binomial approximation $\\sqrt{1-u} \\approx 1 - \\frac{u}{2}$ for small $u$:\n$$\n\\omega(k, \\theta) \\approx ck \\left( 1 - \\frac{(kh)^{2}}{24}(\\cos^{4}\\theta + \\sin^{4}\\theta) \\right) = ck - \\frac{ch^{2}}{24}(\\cos^{4}\\theta + \\sin^{4}\\theta) k^{3}\n$$\nThis is the asymptotic form of the dispersion relation. The numerical group velocity is found by differentiating with respect to $k$ at fixed $\\theta$:\n$$\nc_g(\\theta) = \\frac{\\partial \\omega}{\\partial k} \\approx \\frac{\\partial}{\\partial k} \\left( ck - \\frac{ch^{2}}{24}(\\cos^{4}\\theta + \\sin^{4}\\theta) k^{3} \\right)\n$$\n$$\nc_g(\\theta) \\approx c - \\frac{ch^{2}}{24}(\\cos^{4}\\theta + \\sin^{4}\\theta) (3 k^{2}) = c - \\frac{c(kh)^{2}}{8}(\\cos^{4}\\theta + \\sin^{4}\\theta)\n$$\nFinally, the relative group-velocity error $\\delta(\\theta)$ is:\n$$\n\\delta(\\theta) = \\frac{c_g(\\theta)}{c} - 1 \\approx \\frac{c - \\frac{c(kh)^{2}}{8}(\\cos^{4}\\theta + \\sin^{4}\\theta)}{c} - 1\n$$\n$$\n\\delta(\\theta) \\approx 1 - \\frac{(kh)^{2}}{8}(\\cos^{4}\\theta + \\sin^{4}\\theta) - 1 = -\\frac{(kh)^{2}}{8}(\\cos^{4}\\theta + \\sin^{4}\\theta)\n$$\nThis is the required leading-order asymptotic formula for the relative group-velocity error, correct to order $(kh)^{2}$.\n\nAs requested, an explanation of the physical implication of this result follows. The error $\\delta(\\theta)$ is always negative (since $(kh)^{2} \\ge 0$ and $\\cos^{4}\\theta + \\sin^{4}\\theta \\ge 0$), meaning the numerical group velocity $c_g(\\theta)$ is always less than or equal to the true sound speed $c$. This leads to a lagging of the numerical wavefront compared to the true physical wavefront. Furthermore, the magnitude of the error depends on the propagation direction $\\theta$ via the term $\\cos^{4}\\theta + \\sin^{4}\\theta$. This term is maximized (equal to $1$) for propagation along the grid axes ($\\theta = 0, \\frac{\\pi}{2}, \\pi, \\dots$) and minimized (equal to $\\frac{1}{2}$) for propagation along the grid diagonals ($\\theta = \\frac{\\pi}{4}, \\frac{3\\pi}{4}, \\dots$). This anisotropy means that waves travel slowest along the grid axes and fastest (least slow) along the diagonals. Consequently, an initially circular wavefront emanating from a point source will distort as it propagates, becoming squarish in shape, with its corners pointing along the grid diagonals. This numerical anisotropy is a hallmark of finite-difference methods on Cartesian grids.",
            "answer": "$$\n\\boxed{-\\frac{(kh)^{2}}{8}(\\cos^{4}\\theta + \\sin^{4}\\theta)}\n$$"
        }
    ]
}