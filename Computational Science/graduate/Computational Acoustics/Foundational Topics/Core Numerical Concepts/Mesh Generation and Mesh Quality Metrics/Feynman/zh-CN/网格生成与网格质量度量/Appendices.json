{
    "hands_on_practices": [
        {
            "introduction": "在计算声学中，为了精确模拟带有弯曲边界的复杂几何体，我们常常使用等参单元。这些单元通过一个数学变换，将一个简单的标准形状（如标准三角形）映射到物理空间中的弯曲形状。为了保证这种变换的有效性，即单元不会发生自我翻转或折叠，其雅可比行列式 $J$ 必须在单元内的每一点都保持为正。这个练习将引导你亲手计算一个二阶弯曲三角形单元的雅可比行列式，并验证其有效性，这是理解和确保有限元网格质量的基石。",
            "id": "4128648",
            "problem": "一个二维声腔使用有限元法 (FEM) 和弯曲的等参二次三角形单元进行离散化，以贴合光滑边界。考虑一个单一的 $6$ 节点等参二次三角形，其从参考三角形 $(\\xi,\\eta)$（重心坐标为 $\\zeta = 1 - \\xi - \\eta$，域为 $0 \\leq \\xi, \\eta, \\xi + \\eta \\leq 1$）到物理坐标 $(x,y)$ 的映射由在以下物理节点位置（所有坐标单位为 $\\mathrm{m}$）的二次拉格朗日插值定义：\n- 顶点节点：节点 $1$ 位于 $(x_{1},y_{1}) = (0,0)$，节点 $2$ 位于 $(x_{2},y_{2}) = (1,0)$，节点 $3$ 位于 $(x_{3},y_{3}) = (0,1)$。\n- 边中节点：节点 $4$ 位于边 $1$–$2$ 上，坐标为 $(x_{4},y_{4}) = (0.5, 0.05)$；节点 $5$ 位于边 $2$–$3$ 上，坐标为 $(x_{5},y_{5}) = (0.5, 0.55)$；节点 $6$ 位于边 $3$–$1$ 上，坐标为 $(x_{6},y_{6}) = (-0.05, 0.5)$。\n\n从等参插值的定义和参考三角形上二次拉格朗日多项式的节点插值条件出发，推导二次形函数 $N_{i}(\\xi,\\eta)$，$i=1,\\dots,6$，并用它们构建等参映射 $(x(\\xi,\\eta), y(\\xi,\\eta)) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) (x_{i}, y_{i})$。从基本原理出发，计算在整个参数域 $0 \\leq \\xi, \\eta, \\xi + \\eta \\leq 1$ 上的雅可比行列式\n$$\nJ(\\xi,\\eta) = \\det\\!\\left( \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} \\right)\n$$\n并确定其在该域上的最小值。基于此最小值，判断 $J(\\xi,\\eta) > 0$ 是否在单元内处处成立，并解释此结果对于计算声学中网格有效性的意义。\n\n用 $\\mathrm{m^{2}}$ 单位表示雅可比行列式的最终最小值，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个特定的 $6$ 节点等参二次三角形的雅可比行列式的最小值，并讨论该结果的意义。求解过程分四个阶段进行：(1) 在参考单元上定义二次形函数，(2) 构建等参坐标映射，(3) 计算雅可比行列式，以及 (4) 在单元域上找到雅可比行列式的最小值。\n\n步骤1：推导二次形函数 $N_{i}(\\xi,\\eta)$\n该单元是一个 $6$ 节点的二次三角形。形函数 $N_i(\\xi, \\eta)$ 定义在 $(\\xi, \\eta)$ 平面中的一个参考三角形上，其顶点位于 $(0,0)$, $(1,0)$ 和 $(0,1)$。使用重心坐标 $\\zeta = 1 - \\xi - \\eta$, $\\xi$ 和 $\\eta$ 会很方便。一个 $6$ 节点拉格朗日三角形的形函数由以下公式给出：\n对于顶点节点 $i=1,2,3$：$N_i = L_i(2L_i-1)$\n对于边中节点 $i=4,5,6$：$N_{jk} = 4L_j L_k$\n节点的参考坐标为：\n节点 1: $(\\xi,\\eta)=(0,0)$，此时 $\\zeta=1$。\n节点 2: $(\\xi,\\eta)=(1,0)$，此时 $\\xi=1$。\n节点 3: $(\\xi,\\eta)=(0,1)$，此时 $\\eta=1$。\n节点 4 (1-2的中点): $(\\xi,\\eta)=(0.5,0)$。\n节点 5 (2-3的中点): $(\\xi,\\eta)=(0.5,0.5)$。\n节点 6 (3-1的中点): $(\\xi,\\eta)=(0,0.5)$。\n\n使用重心坐标 $L_1=\\zeta=1-\\xi-\\eta$, $L_2=\\xi$ 和 $L_3=\\eta$，形函数为：\n顶点节点：\n$N_1(\\xi,\\eta) = \\zeta(2\\zeta-1) = (1-\\xi-\\eta)(2(1-\\xi-\\eta)-1) = (1-\\xi-\\eta)(1-2\\xi-2\\eta)$\n$N_2(\\xi,\\eta) = \\xi(2\\xi-1)$\n$N_3(\\xi,\\eta) = \\eta(2\\eta-1)$\n\n边中节点：\n$N_4(\\xi,\\eta) = 4L_1 L_2 = 4\\zeta\\xi = 4\\xi(1-\\xi-\\eta)$ (对于边 1-2)\n$N_5(\\xi,\\eta) = 4L_2 L_3 = 4\\xi\\eta$ (对于边 2-3)\n$N_6(\\xi,\\eta) = 4L_3 L_1 = 4\\eta\\zeta = 4\\eta(1-\\xi-\\eta)$ (对于边 3-1)\n\n步骤2：构建等参映射\n等参映射使用相同的形函数将物理坐标 $(x,y)$ 与参考坐标 $(\\xi,\\eta)$ 关联起来：\n$$x(\\xi,\\eta) = \\sum_{i=1}^{6} N_i(\\xi,\\eta) x_i$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{6} N_i(\\xi,\\eta) y_i$$\n给定的物理节点坐标为：\n$(x_1, y_1) = (0,0)$, $(x_2, y_2) = (1,0)$, $(x_3, y_3) = (0,1)$,\n$(x_4, y_4) = (0.5, 0.05)$, $(x_5, y_5) = (0.5, 0.55)$, $(x_6, y_6) = (-0.05, 0.5)$。\n\n将节点坐标和形函数代入 $x(\\xi,\\eta)$：\n$x(\\xi,\\eta) = x_1 N_1 + x_2 N_2 + x_3 N_3 + x_4 N_4 + x_5 N_5 + x_6 N_6$\n$x(\\xi,\\eta) = (0)N_1 + (1)N_2 + (0)N_3 + (0.5)N_4 + (0.5)N_5 + (-0.05)N_6$\n$x(\\xi,\\eta) = \\xi(2\\xi-1) + 0.5 \\cdot 4\\xi(1-\\xi-\\eta) + 0.5 \\cdot 4\\xi\\eta - 0.05 \\cdot 4\\eta(1-\\xi-\\eta)$\n$x(\\xi,\\eta) = 2\\xi^2-\\xi + 2\\xi(1-\\xi-\\eta) + 2\\xi\\eta - 0.2\\eta(1-\\xi-\\eta)$\n$x(\\xi,\\eta) = 2\\xi^2-\\xi + 2\\xi - 2\\xi^2 - 2\\xi\\eta + 2\\xi\\eta - 0.2\\eta + 0.2\\xi\\eta + 0.2\\eta^2$\n$x(\\xi,\\eta) = \\xi - 0.2\\eta + 0.2\\eta^2 + 0.2\\xi\\eta$\n\n代入 $y(\\xi,\\eta)$：\n$y(\\xi,\\eta) = y_1 N_1 + y_2 N_2 + y_3 N_3 + y_4 N_4 + y_5 N_5 + y_6 N_6$\n$y(\\xi,\\eta) = (0)N_1 + (0)N_2 + (1)N_3 + (0.05)N_4 + (0.55)N_5 + (0.5)N_6$\n$y(\\xi,\\eta) = \\eta(2\\eta-1) + 0.05 \\cdot 4\\xi(1-\\xi-\\eta) + 0.55 \\cdot 4\\xi\\eta + 0.5 \\cdot 4\\eta(1-\\xi-\\eta)$\n$y(\\xi,\\eta) = 2\\eta^2-\\eta + 0.2\\xi-0.2\\xi^2-0.2\\xi\\eta + 2.2\\xi\\eta + 2\\eta-2\\xi\\eta-2\\eta^2$\n$y(\\xi,\\eta) = \\eta + 0.2\\xi - 0.2\\xi^2 + (-0.2+2.2-2.0)\\xi\\eta$\n$y(\\xi,\\eta) = \\eta + 0.2\\xi - 0.2\\xi^2$\n\n步骤3：计算雅可比行列式\n变换的雅可比矩阵为 $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$。其分量是映射函数的偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = 1 + 0.2\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = -0.2 + 0.4\\eta + 0.2\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = 0.2 - 0.4\\xi$\n$\\frac{\\partial y}{\\partial \\eta} = 1$\n\n雅可比行列式为 $J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$：\n$J(\\xi,\\eta) = (1 + 0.2\\eta)(1) - (-0.2 + 0.2\\xi + 0.4\\eta)(0.2 - 0.4\\xi)$\n$J(\\xi,\\eta) = 1 + 0.2\\eta - [-0.04 + 0.08\\xi + 0.04\\xi - 0.08\\xi^2 + 0.08\\eta - 0.16\\xi\\eta]$\n$J(\\xi,\\eta) = 1 + 0.2\\eta - [-0.04 + 0.12\\xi - 0.08\\xi^2 + 0.08\\eta - 0.16\\xi\\eta]$\n$J(\\xi,\\eta) = 1 + 0.2\\eta + 0.04 - 0.12\\xi + 0.08\\xi^2 - 0.08\\eta + 0.16\\xi\\eta$\n$J(\\xi,\\eta) = 1.04 - 0.12\\xi + 0.12\\eta + 0.08\\xi^2 + 0.16\\xi\\eta$\n\n步骤4：求雅可比行列式的最小值\n为了在由 $0 \\leq \\xi$, $0 \\leq \\eta$ 和 $\\xi+\\eta \\leq 1$ 定义的域上找到 $J(\\xi,\\eta)$ 的最小值，我们首先通过将 $J$ 的梯度设为零来检查内部的临界点：\n$\\frac{\\partial J}{\\partial \\xi} = -0.12 + 0.16\\xi + 0.16\\eta = 0$\n$\\frac{\\partial J}{\\partial \\eta} = 0.12 + 0.16\\xi = 0$\n由第二个方程可得 $0.16\\xi = -0.12$，即 $\\xi = -0.12/0.16 = -0.75$。此点在域外，因此最小值必然位于参考三角形的边界上。边界由三条边段组成：\n1. 边 $\\eta=0$，对于 $0 \\leq \\xi \\leq 1$：\n   $J(\\xi,0) = 1.04 - 0.12\\xi + 0.08\\xi^2$。\n   为求此边段上的最小值，我们对 $\\xi$ 求导：\n   $\\frac{dJ}{d\\xi} = -0.12 + 0.16\\xi = 0 \\implies \\xi = 0.12/0.16 = 0.75$。\n   此点在区间 $[0,1]$ 内。雅可比行列式在此点的值为：\n   $J(0.75, 0) = 1.04 - 0.12(0.75) + 0.08(0.75)^2 = 1.04 - 0.09 + 0.08(0.5625) = 0.95 + 0.045 = 0.995$。\n   此边段端点处的值为 $J(0,0)=1.04$ 和 $J(1,0)=1.04-0.12+0.08=1$。\n\n2. 边 $\\xi=0$，对于 $0 \\leq \\eta \\leq 1$：\n   $J(0,\\eta) = 1.04 + 0.12\\eta$。这是一个关于 $\\eta$ 的线性增函数。其在 $[0,1]$ 上的最小值出现在 $\\eta=0$ 处，得到 $J(0,0)=1.04$。\n\n3. 边 $\\eta=1-\\xi$，对于 $0 \\leq \\xi \\leq 1$：\n   $J(\\xi, 1-\\xi) = 1.04 - 0.12\\xi + 0.12(1-\\xi) + 0.08\\xi^2 + 0.16\\xi(1-\\xi)$\n   $J(\\xi, 1-\\xi) = 1.04 - 0.12\\xi + 0.12 - 0.12\\xi + 0.08\\xi^2 + 0.16\\xi - 0.16\\xi^2$\n   $J(\\xi, 1-\\xi) = 1.16 - 0.08\\xi - 0.08\\xi^2$。\n   其导数为 $\\frac{dJ}{d\\xi} = -0.08 - 0.16\\xi$。令其为零得到 $\\xi = -0.5$，此点在 $[0,1]$ 之外。由于对于 $\\xi \\in [0,1]$，导数是负的，该函数是递减的。此边段上的最小值出现在 $\\xi=1$ 处，对应于点 $(1,0)$。其值为 $J(1,0)=1$，如前所算。\n\n通过比较所有候选值（$0.995$，$1.04$ 和 $1$），雅可比行列式的最小值为 $J_{min} = 0.995$。\n\n结论与意义\n在整个单元上，雅可比行列式的最小值为 $J_{min} = 0.995$。由于节点坐标的单位是米 $(\\mathrm{m})$，雅可比行列式的单位是面积单位 $\\mathrm{m^2}$。\n条件 $J(\\xi,\\eta) > 0$ 在单元内处处满足。这是有效的有限元网格的一个关键要求。\n严格为正的雅可比行列式的意义如下：\n1.  **几何有效性**：一个正的 $J$ 确保从参考单元到物理单元的映射是一对一且保持方向的。这意味着单元不会自身折叠或反转。在任何点 $J \\leq 0$ 的单元都被认为是畸变或无效单元。\n2.  **数值积分**：在有限元法中，物理单元域 $\\Omega_e$ 上的函数积分是通过将它们变换到参考域来计算的：$\\int_{\\Omega_e} f(x,y)\\,dx\\,dy = \\int_0^1 \\int_0^{1-\\xi} f(x(\\xi,\\eta), y(\\xi,\\eta)) J(\\xi,\\eta)\\,d\\eta\\,d\\xi$。如果 $J \\leq 0$，面积微元 $dA=J\\,d\\xi\\,d\\eta$ 将为非正值，这在物理上是无意义的，并将导致不正确的结果。\n3.  **求解器稳定性**：网格中存在具有非正雅可比行列式的单元通常会导致奇异或病态的全局刚度矩阵，从而导致数值求解器失败或产生物理上无意义的结果。因此，对于任何基于有限元法的模拟（包括计算声学），确保所有单元的 $J > 0$ 是网格生成中的一个基本检查。\n\n雅可比行列式的最小值为 $0.995 \\, \\mathrm{m^2}$。四舍五入到四位有效数字，即为 $0.9950 \\, \\mathrm{m^2}$。",
            "answer": "$$\n\\boxed{0.9950}\n$$"
        },
        {
            "introduction": "一个几何上有效（即雅可比行列式为正）的单元，其形状也可能非常差，从而影响数值计算的稳定性和精度。狭长四面体（sliver tetrahedron）就是这类病态单元的典型例子，它的四个顶点几乎共面，导致其体积与其边长相比小得不成比例。本练习将通过一个具体案例，教你如何计算一个标准化的无量纲体积度量指标，并用它来识别和量化这类影响网格质量的病态单元。",
            "id": "4128627",
            "problem": "在计算声学中，声波方程离散化的精度和稳定性对四面体网格的质量很敏感。在病态单元中，扁平体（slivers）是顶点近似共面的四面体，其体积相对于边长而言非常小。这会恶化有限元法（FEM）矩阵的条件数，并导致色散误差。常用于检测此类扁平体的一个无量纲质量度量是归一化体积，定义为 $V/L_{\\max}^{3}$，其中 $V$ 是四面体的体积，$L_{\\max}$ 是其六条边中的最大边长。\n\n考虑一个顶点为 $A=(1,0,0)$、$B=(0,1,0)$、$C=(1,1,10^{-3})$ 和 $D=(0,0,0)$ 的四面体。使用向量几何的第一性原理，不借助任何预先制定的网格质量公式，计算其归一化体积 $V/L_{\\max}^{3}$，并根据以下规则将其分类：如果 $V/L_{\\max}^{3}  \\tau$ 则声明为“扁平体”，否则为“非扁平体”，其中阈值 $\\tau=10^{-3}$。将此分类编码为一个指示符 $I$，如果该单元是扁平体，则 $I=1$，否则 $I=0$。\n\n将归一化体积 $V/L_{\\max}^{3}$ 四舍五入到四位有效数字。将最终答案的两个分量都表示为无量纲数。以一个二分量行矩阵 $\\begin{pmatrix}V/L_{\\max}^{3}  I\\end{pmatrix}$ 的形式提供最终答案。",
            "solution": "该问题被验证为具有科学依据、适定且客观。它通过顶点清晰地定义了四面体，给出了一个待计算的特定质量度量，以及一个精确的分类规则。所有必要信息均已提供且前后一致。\n\n任务是为一个给定的四面体计算归一化体积 $Q = V/L_{\\max}^{3}$ 并将其分类为扁平体。该四面体的顶点为 $A=(1,0,0)$，$B=(0,1,0)$，$C=(1,1,10^{-3})$ 和 $D=(0,0,0)$。\n\n首先，我们计算四面体的体积 $V$。对于一个顶点在原点 $D$，其他顶点为 $A$、$B$ 和 $C$ 的四面体，其体积等于向量 $\\vec{DA}$、$\\vec{DB}$ 和 $\\vec{DC}$ 的标量三重积绝对值的六分之一。\n这些向量是：\n$\\vec{DA} = A - D = (1,0,0) - (0,0,0) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$\\vec{DB} = B - D = (0,1,0) - (0,0,0) = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n$\\vec{DC} = C - D = (1,1,10^{-3}) - (0,0,0) = \\begin{pmatrix} 1 \\\\ 1 \\\\ 10^{-3} \\end{pmatrix}$\n\n标量三重积可以计算为以这些向量为列（或行）的矩阵的行列式。\n$$V = \\frac{1}{6} |(\\vec{DA} \\times \\vec{DB}) \\cdot \\vec{DC}| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 0  0  10^{-3} \\end{pmatrix} \\right|$$\n沿第一列展开行列式：\n$$ \\det \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 0  0  10^{-3} \\end{pmatrix} = 1 \\cdot \\det \\begin{pmatrix} 1  1 \\\\ 0  10^{-3} \\end{pmatrix} - 0 + 0 = 1 \\cdot (1 \\cdot 10^{-3} - 1 \\cdot 0) = 10^{-3} $$\n因此，体积为：\n$$V = \\frac{1}{6} |10^{-3}| = \\frac{1}{6} \\times 10^{-3}$$\n\n接下来，我们求出四面体六条边中的最大边长 $L_{\\max}$。这些边是 $DA$、$DB$、$DC$、$AB$、$AC$ 和 $BC$。为了方便比较，我们计算每条边长的平方。\n对应于各边的向量是：\n$\\vec{DA} = (1,0,0)$\n$\\vec{DB} = (0,1,0)$\n$\\vec{DC} = (1,1,10^{-3})$\n$\\vec{AB} = B - A = (0-1, 1-0, 0-0) = (-1,1,0)$\n$\\vec{AC} = C - A = (1-1, 1-0, 10^{-3}-0) = (0,1,10^{-3})$\n$\\vec{BC} = C - B = (1-0, 1-1, 10^{-3}-0) = (1,0,10^{-3})$\n\n边长的平方是这些向量模的平方：\n$L_{DA}^2 = 1^2 + 0^2 + 0^2 = 1$\n$L_{DB}^2 = 0^2 + 1^2 + 0^2 = 1$\n$L_{DC}^2 = 1^2 + 1^2 + (10^{-3})^2 = 1 + 1 + 10^{-6} = 2 + 10^{-6}$\n$L_{AB}^2 = (-1)^2 + 1^2 + 0^2 = 1 + 1 = 2$\n$L_{AC}^2 = 0^2 + 1^2 + (10^{-3})^2 = 1 + 10^{-6}$\n$L_{BC}^2 = 1^2 + 0^2 + (10^{-3})^2 = 1 + 10^{-6}$\n\n比较这些长度的平方：$1$、$1$、$2+10^{-6}$、$2$、$1+10^{-6}$、$1+10^{-6}$。最大边长的平方是 $L_{\\max}^2 = 2 + 10^{-6}$。\n因此，最大边长为 $L_{\\max} = \\sqrt{2 + 10^{-6}}$。\n\n现在，我们计算归一化体积 $Q = V/L_{\\max}^{3}$：\n$$Q = \\frac{V}{L_{\\max}^3} = \\frac{\\frac{1}{6} \\times 10^{-3}}{(\\sqrt{2 + 10^{-6}})^3} = \\frac{10^{-3}}{6(2 + 10^{-6})^{3/2}}$$\n为了得到数值，我们计算该表达式：\n$$(2 + 10^{-6})^{3/2} = (2.000001)^{1.5} \\approx 2.82842924$$\n$$Q \\approx \\frac{10^{-3}}{6 \\times 2.82842924} = \\frac{10^{-3}}{16.97057544} \\approx 0.0589255 \\times 10^{-3}$$\n用科学记数法表示，这是 $5.89255 \\times 10^{-5}$。\n按要求四舍五入到四位有效数字，我们得到：\n$$Q \\approx 5.893 \\times 10^{-5}$$\n\n最后，我们对该单元进行分类。规则是，如果 $Q  \\tau$，则将其分类为“扁平体”，其中阈值 $\\tau = 10^{-3}$。该分类由一个指示符 $I$ 编码，其中扁平体为 $I=1$，否则为 $I=0$。\n我们将计算出的归一化体积 $Q$ 与阈值 $\\tau$ 进行比较：\n$$5.893 \\times 10^{-5}  10^{-3}$$\n该不等式成立，因为 $5.893 \\times 10^{-5} = 0.00005893$ 且 $10^{-3} = 0.001$。\n因此，该单元是一个扁平体，指示符为 $I=1$。\n\n最终答案由四舍五入后的归一化体积和指示符 $I$ 组成，以一个二分量行矩阵 $\\begin{pmatrix} Q  I \\end{pmatrix}$ 的形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 5.893 \\times 10^{-5}  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "网格的质量不仅体现在单个单元的几何形状上，更根本地体现在它对物理模拟精度的影响上。由于离散化的存在，数值波在网格上传播的速度会与真实的物理波速产生偏差，这种现象被称为数值色散。本练习将带你深入分析一维亥姆霍兹方程的有限元离散格式，推导其数值波数 $k_{\\text{eff}}$ 与物理波数 $k$ 之间的关系，从而揭示网格尺寸 $h$ 是如何直接影响声波传播模拟的精度。",
            "id": "4128596",
            "problem": "考虑由无限长均匀直线上的标量亥姆霍兹方程所描述的一维时谐声学问题：\n$$\\frac{d^{2} u}{dx^{2}} + k^{2} u = 0,$$\n其中 $u(x)$ 是声压幅值，$k$ 是物理波数（单位为弧度/米）。使用标准的伽辽金有限元法（FEM），在单元尺寸为 $h$ 的均匀网格上，采用连续分片线性基函数对该问题进行离散化。假设采用一致（非集中）质量矩阵。设无限均匀网格上的节点自由度表示为 $\\{U_{j}\\}_{j \\in \\mathbb{Z}}$。\n\n从弱形式以及线性形函数的单元刚度矩阵和质量矩阵的定义出发，组装全局离散系统，并引入布洛赫波（Bloch-wave）拟设 $U_{j} = \\exp\\!\\left(i j \\theta\\right)$，其中 $\\theta$ 为某一实相位。通过 $\\theta = k_{\\text{eff}} h$ 定义有效（数值）波数 $k_{\\text{eff}}$。推导连接 $k$ 和 $k_{\\text{eff}}$ 的离散色散关系，然后求出 $k_{\\text{eff}}$ 关于无量纲网格分辨率参数 $kh$ 的幂级数展开，直到并包括 $O\\!\\left((kh)^{3}\\right)$ 阶项。\n\n将 $k_{\\text{eff}}$ 的最终结果（单位为弧度/米）表示为以 $k$ 和 $h$ 为变量的解析表达式。无需四舍五入。",
            "solution": "用户希望求解一维亥姆霍兹方程的有限元法（FEM）离散化中，数值波数的级数展开式。\n\n### 步骤 1：问题陈述的验证\n\n**1. 提取已知条件：**\n- **控制方程：** 一维时谐声学问题由无限长均匀直线上的标量亥姆霍兹方程描述：\n$$ \\frac{d^{2} u}{dx^{2}} + k^{2} u = 0 $$\n- **变量与常数：**\n  - $u(x)$：声压幅值。\n  - $k$：物理波数，单位为弧度/米。\n  - $h$：均匀网格的单元尺寸。\n- **方法：**\n  - 离散化：标准伽辽金有限元法（FEM）。\n  - 基函数：连续分片线性。\n  - 质量矩阵：一致（非集中）。\n  - 节点自由度：无限均匀网格上的 $\\{U_{j}\\}_{j \\in \\mathbb{Z}}$。\n- **拟设与定义：**\n  - 布洛赫波拟设：$U_{j} = \\exp(i j \\theta)$，其中 $\\theta$ 为某一实相位。\n  - 有效（数值）波数 $k_{\\text{eff}}$ 由 $\\theta = k_{\\text{eff}} h$ 定义。\n- **目标：**\n  - 推导连接 $k$ 和 $k_{\\text{eff}}$ 的离散色散关系。\n  - 求出 $k_{\\text{eff}}$ 关于无量纲参数 $kh$ 的幂级数展开，直到并包括 $O((kh)^{3})$ 阶项。\n  - 将 $k_{\\text{eff}}$ 的最终结果表示为以 $k$ 和 $h$ 为变量的解析表达式。\n\n**2. 验证分析：**\n- **科学依据：** 该问题牢固地植根于计算声学和偏微分方程数值分析的基本原理。亥姆霍兹方程是时谐波传播的标准模型。伽辽金有限元法是现代计算科学的基石。使用布洛赫波（或 von Neumann）拟设进行数值色散分析是评估数值格式准确性的标准且关键的技术。该问题在科学上是合理的，并且是一个经典的教科书练习题。\n- **适定性：** 问题陈述清晰，包含了推导唯一解所需的所有信息。各项规定（线性基函数、一致质量矩阵）是精确的。目标是明确的。\n- **客观性：** 语言是形式化的、数学化的，不含任何主观或推测性内容。\n\n**3. 结论与行动：**\n该问题在科学上是合理的、适定的且客观的。它没有违反任何无效性标准。因此，该问题是**有效的**。我们开始推导解答。\n\n### 步骤 2：解答推导\n\n**A. 弱形式与有限元离散化**\n亥姆霍兹方程为 $u'' + k^2 u = 0$。通过乘以一个检验函数 $v$ 并在定义域 $\\mathbb{R}$ 上积分，得到其弱形式。\n$$ \\int_{-\\infty}^{\\infty} (u'' v + k^2 u v) \\, dx = 0 $$\n对第一项进行分部积分，我们得到：\n$$ \\left[u' v\\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} u' v' \\, dx + k^2 \\int_{-\\infty}^{\\infty} u v \\, dx = 0 $$\n假设场在无穷远处消失，则边界项为零。弱形式为：寻找 $u$，使得对于所有合适的检验函数 $v$ 都满足：\n$$ \\int_{-\\infty}^{\\infty} (u' v' - k^2 u v) \\, dx = 0 $$\n在伽辽金有限元法中，我们将解 $u(x)$ 近似为基函数 $N_j(x)$ 的线性组合：$u_h(x) = \\sum_{j \\in \\mathbb{Z}} U_j N_j(x)$。检验函数也从同一组基函数中选取，$v = N_i(x)$。这导出了一个代数方程组 $(S - k^2 M) \\mathbf{U} = \\mathbf{0}$，其中 $S$ 是刚度矩阵，$M$ 是质量矩阵。\n\n**B. 线性基函数的单元矩阵**\n对于一个长度为 $h$ 的通用单元，其线性形函数的单元刚度矩阵 $S^e$ 和一致质量矩阵 $M^e$ 由下式给出：\n$$ S^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n**C. 全局系统方程的组装**\n我们为通用节点 $j$ 组装离散方程。第 $j$ 个自由度 $U_j$ 的方程涉及到单元 $[x_{j-1}, x_j]$ 和 $[x_j, x_{j+1}]$ 的贡献。由此产生的计算模板连接了节点 $j-1$、$j$ 和 $j+1$。\n第 $j$ 行的离散方程为：\n$$ (S_{j,j-1} - k^2 M_{j,j-1})U_{j-1} + (S_{jj} - k^2 M_{jj})U_j + (S_{j,j+1} - k^2 M_{j,j+1})U_{j+1} = 0 $$\n组装后的矩阵项为：\n- $S_{j,j-1} = -\\frac{1}{h}$, $S_{jj} = \\frac{2}{h}$, $S_{j,j+1} = -\\frac{1}{h}$。\n- $M_{j,j-1} = \\frac{h}{6}$, $M_{jj} = \\frac{2h}{3}$, $M_{j,j+1} = \\frac{h}{6}$。\n\n将这些项代入节点 $j$ 的方程中：\n$$ \\left(-\\frac{1}{h} - k^2 \\frac{h}{6}\\right)U_{j-1} + \\left(\\frac{2}{h} - k^2 \\frac{2h}{3}\\right)U_j + \\left(-\\frac{1}{h} - k^2 \\frac{h}{6}\\right)U_{j+1} = 0 $$\n整理各项得到计算模板：\n$$ -\\frac{1}{h}(U_{j-1} - 2U_j + U_{j+1}) - k^2 \\frac{h}{6}(U_{j-1} + 4U_j + U_{j+1}) = 0 $$\n\n**D. 离散色散关系**\n我们引入布洛赫波拟设 $U_j = \\exp(ij\\theta)$，其中 $\\theta = k_{\\text{eff}}h$。这给出 $U_{j\\pm 1} = \\exp(\\pm i\\theta) U_j$。将此代入离散方程并除以 $U_j \\neq 0$：\n$$ -\\frac{1}{h}(\\exp(-i\\theta) - 2 + \\exp(i\\theta)) - k^2 \\frac{h}{6}(\\exp(-i\\theta) + 4 + \\exp(i\\theta)) = 0 $$\n使用恒等式 $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$，表达式变为：\n$$ -\\frac{1}{h}(2\\cos(\\theta) - 2) - k^2 \\frac{h}{6}(2\\cos(\\theta) + 4) = 0 $$\n$$ \\frac{2}{h}(1 - \\cos(\\theta)) - k^2 \\frac{h}{3}(\\cos(\\theta) + 2) = 0 $$\n求解 $k^2$ 得到离散色散关系：\n$$ k^2 = \\frac{6}{h^2} \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)} $$\n\n**E. 数值波数的级数展开**\n我们需要用 $k$ 来表示 $k_{\\text{eff}}$。为此，我们对色散关系在小 $\\theta$ 处进行展开，这对应于一个被良好解析的波（$kh \\ll 1$）。我们使用 $\\cos(\\theta)$ 在 $\\theta=0$ 附近的泰勒级数：\n$$ \\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6) $$\n将此代入色散关系中：\n$$ k^2 = \\frac{6}{h^2} \\frac{1 - \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)}{2 + \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)} $$\n$$ k^2 = \\frac{6}{h^2} \\frac{\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + O(\\theta^6)}{3 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)} $$\n两边乘以 $h^2$ 并从分母中提出因子 3：\n$$ (kh)^2 = 2 \\frac{\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + O(\\theta^6)}{1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + O(\\theta^6)} $$\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + O(\\theta^6)\\right)^{-1} $$\n使用几何级数展开 $(1-x)^{-1} = 1 + x + x^2 + \\dots$：\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 + \\left(\\frac{\\theta^2}{6} - \\frac{\\theta^4}{72}\\right) + \\left(\\frac{\\theta^2}{6}\\right)^2 + O(\\theta^6)\\right) $$\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 + \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + \\dots \\right) $$\n将级数相乘并收集到 $\\theta^4$ 阶的项：\n$$ (kh)^2 = \\theta^2 + \\frac{\\theta^4}{6} - \\frac{\\theta^4}{12} + O(\\theta^6) = \\theta^2 + \\frac{\\theta^4}{12} + O(\\theta^6) $$\n现在我们需要反转这个级数来求出以 $kh$ 表示的 $\\theta$。由于色散关系的对称性，我们假设 $\\theta(kh)$ 是一个奇次幂级数，$\\theta(kh) = c_1(kh) + c_3(kh)^3 + O((kh)^5)$。\n$$ \\theta^2 = c_1^2(kh)^2 + 2c_1c_3(kh)^4 + O((kh)^6) $$\n$$ \\theta^4 = c_1^4(kh)^4 + O((kh)^6) $$\n将这些代入关系式 $(kh)^2 = \\theta^2 + \\frac{1}{12}\\theta^4 + O(\\theta^6)$ 中：\n$$ (kh)^2 = \\left(c_1^2(kh)^2 + 2c_1c_3(kh)^4\\right) + \\frac{1}{12}c_1^4(kh)^4 + O((kh)^6) $$\n通过比较 $kh$ 的各次幂的系数：\n- 对于 $(kh)^2$：$1 = c_1^2 \\implies c_1 = 1$（取物理上有意义的根，即当 $kh$ 很小时，$\\theta \\approx kh$）。\n- 对于 $(kh)^4$：$0 = 2c_1c_3 + \\frac{1}{12}c_1^4$。当 $c_1=1$ 时，得到 $0 = 2c_3 + \\frac{1}{12}$，这意味着 $c_3 = -\\frac{1}{24}$。\n\n所以，$\\theta$ 的级数是：\n$$ \\theta = kh - \\frac{1}{24}(kh)^3 + O((kh)^5) $$\n使用定义 $\\theta = k_{\\text{eff}}h$：\n$$ k_{\\text{eff}}h = kh - \\frac{k^3h^3}{24} + O(k^5h^5) $$\n两边除以 $h$ 得到数值波数 $k_{\\text{eff}}$ 的表达式：\n$$ k_{\\text{eff}} = k - \\frac{k^3h^2}{24} + O(k^5h^4) $$\n$k_{\\text{eff}}$ 按 $kh$ 的幂次展开为 $k_{\\text{eff}} = k \\left(1 - \\frac{1}{24}(kh)^2 + O((kh)^4)\\right)$。问题要求展开到并包括 $O((kh)^3)$ 阶项。由于对称性，$(kh)^1$ 和 $(kh)^3$ 项的系数为零，因此所要求的展开是在 $(kh)^2$ 项之后截断的表达式。\n\n最终表达式为：\n$$ k_{\\text{eff}} = k - \\frac{k^3 h^2}{24} $$\n该结果表明，对于使用线性单元和一致质量矩阵的伽辽金有限元法，由于 $k_{\\text{eff}}  k$，数值相速度大于物理相速度（相位超前）。",
            "answer": "$$ \\boxed{k - \\frac{k^{3}h^{2}}{24}} $$"
        }
    ]
}