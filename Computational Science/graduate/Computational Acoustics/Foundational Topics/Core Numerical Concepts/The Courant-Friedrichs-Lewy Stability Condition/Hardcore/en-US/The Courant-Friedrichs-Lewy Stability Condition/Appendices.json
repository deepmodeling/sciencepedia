{
    "hands_on_practices": [
        {
            "introduction": "Understanding the CFL condition begins with its most direct application. This first practice problem places you in the role of a computational physicist who has encountered a common issue: a simulation becoming numerically unstable. By analyzing a standard explicit finite difference scheme for the 1D wave equation, you will calculate the maximum allowable time step to restore stability, thereby reinforcing the fundamental relationship between wave speed ($v$), grid spacing ($\\Delta x$), and time step ($\\Delta t$).",
            "id": "2164733",
            "problem": "A computational physicist is developing a simulation for wave propagation along a tense string. The physical behavior is governed by the one-dimensional wave equation $\\frac{\\partial^2 u}{\\partial t^2} = v^2 \\frac{\\partial^2 u}{\\partial x^2}$, where $u$ is the transverse displacement of the string, $v$ is the wave propagation speed, $t$ is time, and $x$ is the position along the string.\n\nThe physicist uses an explicit finite difference method to solve this equation numerically. For this type of numerical scheme, stability is governed by the Courant-Friedrichs-Lewy (CFL) condition. This condition states that the dimensionless Courant number, defined as $C = \\frac{v \\Delta t}{\\Delta x}$, must not exceed a critical value. For the specific scheme being used, the stability condition is $C \\le 1$. Here, $\\Delta t$ is the time step and $\\Delta x$ is the spatial grid spacing.\n\nIn the simulation setup, the wave speed is $v = 350 \\text{ m/s}$, and the string is discretized with a spatial step of $\\Delta x = 7.0 \\text{ mm}$. The physicist's initial attempt, using a time step of $\\Delta t = 25$ microseconds, resulted in a numerically unstable solution where the wave amplitude grew without bound.\n\nTo correct this, calculate the maximum possible time step, $\\Delta t_{\\text{max}}$, that can be used while ensuring the numerical stability of the simulation. Express your answer in microseconds (Î¼s).",
            "solution": "The explicit finite difference scheme for the one-dimensional wave equation has the Courant number $C$ defined by\n$$\nC = \\frac{v \\Delta t}{\\Delta x}.\n$$\nStability requires $C \\leq 1$, so the maximum stable time step satisfies\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{v}.\n$$\nWith $\\Delta x = 7.0 \\text{ mm} = 7.0 \\times 10^{-3} \\text{ m}$ and $v = 350 \\text{ m/s}$, compute\n$$\n\\Delta t_{\\max} = \\frac{7.0 \\times 10^{-3}}{350}\\ \\text{s} = \\frac{7.0}{350} \\times 10^{-3}\\ \\text{s} = \\frac{1}{50} \\times 10^{-3}\\ \\text{s} = 2 \\times 10^{-5}\\ \\text{s}.\n$$\nTo express this in microseconds, note that $1 \\text{ s} = 10^{6}$ microseconds, hence\n$$\n2 \\times 10^{-5}\\ \\text{s} = 2 \\times 10^{-5} \\times 10^{6}\\ \\text{microseconds} = 2 \\times 10^{1}\\ \\text{microseconds} = 20\\ \\text{microseconds}.\n$$\nAs a consistency check for the unstable attempt, the Courant number with $\\Delta t = 25$ microseconds is\n$$\nC = \\frac{350 \\times 25 \\times 10^{-6}}{7.0 \\times 10^{-3}} = \\frac{350}{7} \\times 25 \\times 10^{-3} = 50 \\times 25 \\times 10^{-3} = 1.25 > 1,\n$$\nconfirming instability. Therefore, the maximum stable time step is $20$ microseconds.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "Real-world media are rarely homogeneous, and physical properties often vary in space. This exercise moves beyond the constant-coefficient case to explore stability in a heterogeneous medium where the wave speed $c(x)$ is not uniform. The challenge is to determine a single, global time step that guarantees stability across the entire computational domain. Through a principle-based argument, you will discover that the stability of the entire system is dictated by the region with the highest wave speed, a critical insight for modeling complex physical systems.",
            "id": "4140096",
            "problem": "Consider the one-dimensional linear acoustic wave equation with spatially varying sound speed, $$\\frac{\\partial^2 p}{\\partial t^2} = c(x)^2 \\frac{\\partial^2 p}{\\partial x^2},$$ where $p(x,t)$ is the acoustic pressure and $c(x)$ is the local sound speed satisfying $0 < c_{\\min} \\le c(x) \\le c_{\\max} < \\infty$. Let the computational domain be discretized into a uniform grid $x_j = j\\,\\Delta x$ for integer $j$, and let time be advanced using a uniform time step $\\Delta t$. A standard explicit second-order accurate finite difference scheme for this problem is obtained by centered approximations in time and space:\n$$p_j^{n+1} = 2\\,p_j^n - p_j^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{j+1}^n - 2\\,p_j^n + p_{j-1}^n\\right),$$\nwhere $p_j^n$ approximates $p(x_j, n\\,\\Delta t)$ and $c_j = c(x_j)$. Assume periodic boundary conditions and linear analysis. Using a principle-based argument that starts from the governing partial differential equation, the discrete scheme above, and a local frozen-coefficient Fourier analysis, determine which global time-step restriction on $\\Delta t$ is sufficient to ensure linear stability consistent with the Courant-Friedrichs-Lewy (CFL) condition for spatially varying $c_j$.\n\nChoose the correct statement from the following options:\n\nA. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$\n\nB. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$\n\nC. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$\n\nD. No single global $\\Delta t$ can ensure stability when $c_j$ varies; one must choose local time steps $\\Delta t_j$ so that $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$ for each $j$\n\nE. The scheme is unconditionally stable in one spatial dimension, so no restriction on $\\Delta t$ is required",
            "solution": "### Solution Derivation\n\nThe problem requires a stability analysis of the given finite difference scheme for the wave equation with a spatially varying coefficient $c(x)$. The specified method is a local frozen-coefficient Fourier analysis, also known as a von Neumann stability analysis with frozen coefficients. This approach assesses stability by analyzing the scheme at each spatial point $x_j$ as if the coefficient $c_j=c(x_j)$ were constant in the neighborhood of that point.\n\nAt a given grid point $x_j$, we freeze the coefficient $c_j$ and analyze the scheme:\n$$p_k^{n+1} = 2\\,p_k^n - p_k^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{k+1}^n - 2\\,p_k^n + p_{k-1}^n\\right)$$\nHere, $k$ is the running spatial index for the Fourier analysis, and $c_j$ is a fixed constant for this local analysis. We seek a solution of the form of a single Fourier mode, $p_k^n = g^n e^{i \\kappa k \\Delta x}$, where $g$ is the amplification factor per time step, $\\kappa$ is the wavenumber, and $i = \\sqrt{-1}$. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber, i.e., $|g| \\le 1$.\n\nSubstituting the Fourier mode into the difference equation:\n$$g^{n+1} e^{i \\kappa k \\Delta x} = 2\\,g^n e^{i \\kappa k \\Delta x} - g^{n-1} e^{i \\kappa k \\Delta x} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left[ g^n e^{i \\kappa (k+1) \\Delta x} - 2\\,g^n e^{i \\kappa k \\Delta x} + g^n e^{i \\kappa (k-1) \\Delta x} \\right]$$\nDividing by $g^{n-1} e^{i \\kappa k \\Delta x}$ (assuming $g \\neq 0$ and $e^{i \\kappa k \\Delta x} \\neq 0$) yields a quadratic equation for $g$:\n$$g^2 = 2g - 1 + g \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left( e^{i \\kappa \\Delta x} - 2 + e^{-i \\kappa \\Delta x} \\right)$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$, the term in parenthesis becomes $2\\cos(\\kappa\\Delta x) - 2$. This can be further simplified using the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$, which gives $2\\cos(\\kappa\\Delta x) - 2 = -4\\sin^2(\\frac{\\kappa\\Delta x}{2})$.\n\nSubstituting this back, we have:\n$$g^2 = 2g - 1 - g \\left( 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right)$$\nRearranging into standard quadratic form, $Ag^2 + Bg + C = 0$:\n$$g^2 - \\left[ 2 - 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right] g + 1 = 0$$\nThis equation is of the form $g^2 - 2\\beta g + 1 = 0$, where the roots are $g = \\beta \\pm \\sqrt{\\beta^2 - 1}$ and $\\beta = 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2})$.\nFor stability, we require $|g| \\le 1$. If $\\beta^2 > 1$, the roots are real and their product is $1$, so one root must have magnitude greater than $1$, leading to instability. If $\\beta^2 \\le 1$, the roots are complex conjugates with magnitude $|g| = \\sqrt{\\beta^2 + (1-\\beta^2)} = 1$. Thus, the stability condition is $|\\beta| \\le 1$, or $-1 \\le \\beta \\le 1$.\n\nWe must satisfy:\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\nThe right-hand inequality, $1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 1$, simplifies to $-2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 0$, which is always true as all terms are non-negative.\nThe left-hand inequality provides the actual restriction:\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right)$$\n$$2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 2$$\n$$\\frac{c_j^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\nThis inequality must hold for all wavenumbers $\\kappa$. The most restrictive case (the \"worst case\") occurs when the term $\\sin^2(\\frac{\\kappa\\Delta x}{2})$ is maximized. Its maximum value is $1$, which occurs for the highest frequency mode resolved by the grid, $\\kappa\\Delta x = \\pi$.\nThe condition thus becomes:\n$$\\frac{c_j \\Delta t}{\\Delta x} \\le 1$$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for the local point $x_j$, which can be written as a restriction on the local time step: $\\Delta t \\le \\frac{\\Delta x}{c_j}$.\n\nFor the entire scheme to be stable using a single, global time step $\\Delta t$, this time step must be small enough to satisfy the local stability condition at every grid point $j$ in the domain.\nTherefore, $\\Delta t$ must be less than or equal to the minimum of all the local maximum time steps:\n$$\\Delta t \\le \\min_{j} \\left( \\frac{\\Delta x}{c_j} \\right)$$\nSince $\\Delta x$ is a positive constant, minimizing the fraction $\\frac{\\Delta x}{c_j}$ is equivalent to maximizing the denominator $c_j$. This means the global time step is constrained by the maximum wave speed in the domain:\n$$\\Delta t \\le \\frac{\\Delta x}{\\max_{j}(c_j)}$$\nThe expression $\\min_j \\left( \\frac{\\Delta x}{c_j} \\right)$ is precisely the statement that ensures this.\n\n### Option-by-Option Analysis\n\n**A. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$**\nAs derived above, this is the correct condition for ensuring stability across the entire computational domain with a single global time step $\\Delta t$. It ensures that the CFL condition is satisfied even in the region with the highest sound speed $c_j$, which is the most restrictive case.\nVerdict: **Correct**.\n\n**B. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$**\nThis condition uses the arithmetic average of the sound speed. This is incorrect. If the domain contains a small region with a very high sound speed (e.g., $c_j \\gg \\text{avg}(c)$), the average speed would be much lower than the local maximum. A time step based on the average speed would be too large for the high-speed region, violating the local CFL condition there and leading to numerical instability.\nVerdict: **Incorrect**.\n\n**C. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$**\nThis expression is equivalent to $\\Delta t \\le \\dfrac{\\Delta x}{\\min_j c_j}$, as maximizing $\\frac{\\Delta x}{c_j}$ is equivalent to minimizing $c_j$. This condition bases the time step on the *minimum* sound speed. Such a time step would be far too large for regions where the sound speed is greater than the minimum, leading to a severe violation of the CFL condition and immediate instability.\nVerdict: **Incorrect**.\n\n**D. No single global $\\Delta t$ can ensure stability when $c_j$ varies; one must choose local time steps $\\Delta t_j$ so that $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$ for each $j$**\nThis statement is false. While local time-stepping is a valid and often more efficient numerical strategy for such problems, it is not a necessity for stability. A single global time step, chosen according to the most restrictive local condition (i.e., based on $c_{\\max}$), is perfectly sufficient to guarantee stability for the entire domain, as shown in the derivation for option A.\nVerdict: **Incorrect**.\n\n**E. The scheme is unconditionally stable in one spatial dimension, so no restriction on $\\Delta t$ is required**\nThis is false. The von Neumann analysis explicitly derived a stability condition that depends on $\\Delta t$, $\\Delta x$, and $c_j$. Explicit finite difference schemes for hyperbolic PDEs, like the one given, are almost always conditionally stable. Unconditional stability is a property typically associated with implicit schemes.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The CFL principle is not limited to finite difference methods; it is a fundamental concept that applies to a wide range of numerical schemes. This advanced problem demonstrates how the stability constraint manifests in higher-order techniques like spectral methods. You will analyze the 1D advection equation solved using a Fourier collocation method paired with a Strong Stability Preserving Runge-Kutta (SSP-RK3) time integrator. Your task is to derive the stability constraint, which connects the time step not to a grid spacing $\\Delta x$, but to the number of Fourier modes $N$ and the specific properties of the time integration algorithm.",
            "id": "2164725",
            "problem": "Consider the one-dimensional linear advection equation, given by $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$, defined on a spatial domain $x \\in [0, 2\\pi]$ with periodic boundary conditions. In this equation, $u(x,t)$ is a scalar field and $c$ is a non-zero, real-valued constant representing the wave speed.\n\nThis partial differential equation is to be solved numerically. The spatial discretization is handled by a Fourier collocation spectral method using $N$ equidistant points, where $N$ is an even integer. A key property of this spatial discretization is that the eigenvalues of the resulting differentiation matrix are purely imaginary, and the discretization accurately represents Fourier modes $e^{ikx}$ with integer wavenumbers $k$ up to a maximum magnitude of $|k|_{max} = N/2$.\n\nFor the time integration of the semi-discretized system, which takes the form of an autonomous system of ordinary differential equations $\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u})$, the three-stage, third-order Strong Stability Preserving Runge-Kutta (SSP-RK3) method is employed. The formulation of this method for a single time step from $t^n$ to $t^{n+1} = t^n + \\Delta t$ is as follows:\n$$ \\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t \\mathbf{F}(\\mathbf{u}^n) $$\n$$ \\mathbf{u}^{(2)} = \\frac{3}{4} \\mathbf{u}^n + \\frac{1}{4} \\left( \\mathbf{u}^{(1)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(1)}) \\right) $$\n$$ \\mathbf{u}^{n+1} = \\frac{1}{3} \\mathbf{u}^n + \\frac{2}{3} \\left( \\mathbf{u}^{(2)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(2)}) \\right) $$\n\nThe stability of this numerical scheme is limited by a Courant-Friedrichs-Lewy (CFL) condition that imposes an upper bound on the time step $\\Delta t$. Derive an expression for the maximum possible time step, $\\Delta t_{max}$, that ensures the stability of the method for all resolvable Fourier modes. Your final answer should be expressed in terms of the magnitude of the wave speed, $|c|$, and the number of collocation points, $N$.",
            "solution": "The one-dimensional linear advection equation $u_{t} + c u_{x} = 0$ with periodic boundary conditions, discretized in space by Fourier collocation on $[0,2\\pi]$ with $N$ equidistant points, leads to a semi-discrete ODE system\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u}) = -c D \\mathbf{u},\n$$\nwhere $D$ is the spectral first-derivative matrix. Because the Fourier collocation method represents Fourier modes $e^{ikx}$ exactly for integer $k$ with $|k| \\leq N/2$, each mode is an eigenvector of $D$ with eigenvalue $ik$. Therefore the semi-discrete operator has eigenvalues\n$$\n\\lambda_{k} = -i c k,\\quad |k| \\leq \\frac{N}{2}.\n$$\nFor time integration with the three-stage, third-order SSP-RK3 method applied to the linear test equation $y'=\\lambda y$, a single time step satisfies\n$$\ny^{n+1} = R(z)\\,y^{n},\\quad z = \\lambda \\Delta t,\n$$\nwhere the stability function $R(z)$ of this SSP-RK3 scheme is\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6}.\n$$\nFor the present semi-discrete system, $z = \\lambda_{k} \\Delta t = -i c k \\Delta t$. Let $y = c k \\Delta t$ and write $z = i(-y)$; since stability depends on $|z|$ along the imaginary axis, it suffices to consider $z = i y$ with real $y$. Then\n$$\nR(i y) = 1 + i y - \\frac{y^{2}}{2} - i \\frac{y^{3}}{6},\n$$\nso\n$$\n|R(i y)|^{2} = \\left(1 - \\frac{y^{2}}{2}\\right)^{2} + \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n= 1 - \\frac{y^{4}}{12} + \\frac{y^{6}}{36}.\n$$\nThe stability boundary on the imaginary axis is obtained from $|R(i y)|^{2} = 1$, which gives\n$$\n-\\frac{y^{4}}{12} + \\frac{y^{6}}{36} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{y^{4}}{36}\\left(y^{2} - 3\\right) = 0\n\\;\\;\\Longleftrightarrow\\;\\;\ny^{2} = 3.\n$$\nHence the method is stable for $|y| \\leq \\sqrt{3}$, i.e.,\n$$\n|c|\\,|k|\\,\\Delta t \\leq \\sqrt{3}.\n$$\nTo ensure stability for all resolvable Fourier modes, impose this for the largest resolvable wavenumber magnitude $|k|_{\\max} = N/2$, which yields\n$$\n\\Delta t_{\\max} = \\frac{\\sqrt{3}}{|c|\\,|k|_{\\max}} = \\frac{\\sqrt{3}}{|c|\\,(N/2)} = \\frac{2\\sqrt{3}}{|c|\\,N}.\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{3}}{|c|\\,N}}$$"
        }
    ]
}