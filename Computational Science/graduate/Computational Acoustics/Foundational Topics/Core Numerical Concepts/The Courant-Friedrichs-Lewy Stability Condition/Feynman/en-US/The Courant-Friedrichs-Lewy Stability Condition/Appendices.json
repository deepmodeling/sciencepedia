{
    "hands_on_practices": [
        {
            "introduction": "To build a stable numerical model, one must first understand the fundamental relationship between the time step, $\\Delta t$, and the spatial grid spacing, $\\Delta x$. This exercise provides a foundational scenario for calculating the maximum allowable time step for a simple wave equation simulation using an explicit finite difference scheme. By working through this problem, you will gain hands-on experience in applying the Courant-Friedrichs-Lewy (CFL) condition, a critical step in preventing the non-physical, explosive growth of errors that characterizes an unstable simulation .",
            "id": "2164733",
            "problem": "A computational physicist is developing a simulation for wave propagation along a tense string. The physical behavior is governed by the one-dimensional wave equation $\\frac{\\partial^2 u}{\\partial t^2} = v^2 \\frac{\\partial^2 u}{\\partial x^2}$, where $u$ is the transverse displacement of the string, $v$ is the wave propagation speed, $t$ is time, and $x$ is the position along the string.\n\nThe physicist uses an explicit finite difference method to solve this equation numerically. For this type of numerical scheme, stability is governed by the Courant-Friedrichs-Lewy (CFL) condition. This condition states that the dimensionless Courant number, defined as $C = \\frac{v \\Delta t}{\\Delta x}$, must not exceed a critical value. For the specific scheme being used, the stability condition is $C \\le 1$. Here, $\\Delta t$ is the time step and $\\Delta x$ is the spatial grid spacing.\n\nIn the simulation setup, the wave speed is $v = 350 \\text{ m/s}$, and the string is discretized with a spatial step of $\\Delta x = 7.0 \\text{ mm}$. The physicist's initial attempt, using a time step of $\\Delta t = 25$ microseconds, resulted in a numerically unstable solution where the wave amplitude grew without bound.\n\nTo correct this, calculate the maximum possible time step, $\\Delta t_{\\max}$, that can be used while ensuring the numerical stability of the simulation. Express your answer in microseconds (Î¼s).",
            "solution": "The explicit finite difference scheme for the one-dimensional wave equation has the Courant number $C$ defined by\n$$\nC = \\frac{v\\,\\Delta t}{\\Delta x}.\n$$\nStability requires $C \\leq 1$, so the maximum stable time step satisfies\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{v}.\n$$\nWith $\\Delta x = 7.0 \\text{ mm} = 7.0 \\times 10^{-3} \\text{ m}$ and $v = 350 \\text{ m s}^{-1}$, compute\n$$\n\\Delta t_{\\max} = \\frac{7.0 \\times 10^{-3}}{350}\\ \\text{s} = \\frac{7.0}{350} \\times 10^{-3}\\ \\text{s} = \\frac{1}{50} \\times 10^{-3}\\ \\text{s} = 2 \\times 10^{-5}\\ \\text{s}.\n$$\nTo express this in microseconds, note that $1 \\text{ s} = 10^{6}$ microseconds, hence\n$$\n2 \\times 10^{-5}\\ \\text{s} = 2 \\times 10^{-5} \\times 10^{6}\\ \\text{microseconds} = 2 \\times 10^{1}\\ \\text{microseconds} = 20\\ \\text{microseconds}.\n$$\nAs a consistency check for the unstable attempt, the Courant number with $\\Delta t = 25$ microseconds is\n$$\nC = \\frac{350 \\times 25 \\times 10^{-6}}{7.0 \\times 10^{-3}} = \\frac{350}{7} \\times 25 \\times 10^{-3} = 50 \\times 25 \\times 10^{-3} = 1.25 > 1,\n$$\nconfirming instability. Therefore, the maximum stable time step is $20$ microseconds.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "Real-world acoustic environments are rarely uniform; the speed of sound often varies significantly throughout the medium. This practice moves beyond idealized scenarios to address the crucial question of stability in heterogeneous media, where the wave speed $c(x)$ is a function of position. Using a principle-based argument rooted in local Fourier analysis, this exercise guides you to determine how the global time step is constrained by local variations in material properties, leading to the important conclusion that the fastest wave speed in the domain dictates the stability for the entire simulation .",
            "id": "4140096",
            "problem": "Consider the one-dimensional linear acoustic wave equation with spatially varying sound speed,\n$$\\frac{\\partial^2 p}{\\partial t^2}(x,t) = c(x)^2\\,\\frac{\\partial^2 p}{\\partial x^2}(x,t),$$\nwhere $p(x,t)$ is the acoustic pressure and $c(x)$ is the local sound speed satisfying $0 < c_{\\min} \\le c(x) \\le c_{\\max} < \\infty$. Let the computational domain be discretized into a uniform grid $x_j = j\\Delta x$ for integer $j$, and let time be advanced using a uniform time step $\\Delta t$. A standard explicit second-order accurate finite difference scheme for this problem is obtained by centered approximations in time and space:\n$$p_j^{n+1} = 2\\,p_j^n - p_j^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{j+1}^n - 2\\,p_j^n + p_{j-1}^n\\right),$$\nwhere $p_j^n$ approximates $p(x_j, n\\Delta t)$ and $c_j = c(x_j)$. Assume periodic boundary conditions and linear analysis. Using a principle-based argument that starts from the governing partial differential equation, the discrete scheme above, and a local frozen-coefficient Fourier analysis, determine which global time-step restriction on $\\Delta t$ is sufficient to ensure linear stability consistent with the Courant-Friedrichs-Lewy (CFL) condition for spatially varying $c_j$.\n\nChoose the correct statement from the following options:\n\nA. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$\n\nB. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$\n\nC. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$\n\nD. No single global $\\Delta t$ can ensure stability when $c_j$ varies; one must choose local time steps $\\Delta t_j$ so that $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$ for each $j$\n\nE. The scheme is unconditionally stable in one spatial dimension, so no restriction on $\\Delta t$ is required",
            "solution": "The stability of the numerical scheme for a varying coefficient $c(x)$ is determined by a local von Neumann (or frozen-coefficient) analysis. At each grid point $x_j$, we \"freeze\" the coefficient $c_j = c(x_j)$ and analyze the stability as if it were a constant-coefficient problem. For the standard explicit second-order scheme, the stability analysis for a constant coefficient $c_j$ yields the local Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\frac{c_j \\Delta t}{\\Delta x} \\le 1\n$$\nThis inequality must be satisfied for each point $j$ in the computational domain. Since the simulation uses a single, global time step $\\Delta t$, this time step must be small enough to satisfy the most restrictive condition. The most restrictive case occurs where the wave speed $c_j$ is at its maximum value, $c_{\\max} = \\max_j(c_j)$. To satisfy the condition for $c_{\\max}$, we must have:\n$$\n\\Delta t \\le \\frac{\\Delta x}{c_{\\max}} = \\frac{\\Delta x}{\\max_j(c_j)}\n$$\nThis is equivalent to choosing $\\Delta t$ to be less than or equal to the minimum of all possible local time step limits:\n$$\n\\Delta t \\le \\min_j \\left(\\frac{\\Delta x}{c_j}\\right)\n$$\nTherefore, the stability of the entire simulation is dictated by the region with the fastest wave speed. This corresponds to option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Modern computational acoustics frequently employs high-order numerical methods to achieve superior accuracy. This advanced problem explores how the CFL condition manifests when using sophisticated tools like Fourier spectral methods for spatial discretization and Strong Stability Preserving Runge-Kutta (SSP-RK) schemes for time integration. This practice demonstrates that the stability limit is a more general concept determined by the interplay between the eigenvalues of the spatial operator and the specific stability region of the time integrator, moving beyond the simple fraction $\\frac{c \\Delta t}{\\Delta x}$ to a more nuanced analysis essential for high-fidelity modeling .",
            "id": "2164725",
            "problem": "Consider the one-dimensional linear advection equation, given by $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$, defined on a spatial domain $x \\in [0, 2\\pi]$ with periodic boundary conditions. In this equation, $u(x,t)$ is a scalar field and $c$ is a non-zero, real-valued constant representing the wave speed.\n\nThis partial differential equation is to be solved numerically. The spatial discretization is handled by a Fourier collocation spectral method using $N$ equidistant points, where $N$ is an even integer. A key property of this spatial discretization is that the eigenvalues of the resulting differentiation matrix are purely imaginary, and the discretization accurately represents Fourier modes $e^{ikx}$ with integer wavenumbers $k$ up to a maximum magnitude of $|k|_{\\max} = N/2$.\n\nFor the time integration of the semi-discretized system, which takes the form of an autonomous system of ordinary differential equations $\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u})$, the three-stage, third-order Strong Stability Preserving Runge-Kutta (SSP-RK3) method is employed. The formulation of this method for a single time step from $t^n$ to $t^{n+1} = t^n + \\Delta t$ is as follows:\n$$ \\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t \\mathbf{F}(\\mathbf{u}^n) $$\n$$ \\mathbf{u}^{(2)} = \\frac{3}{4} \\mathbf{u}^n + \\frac{1}{4} \\left( \\mathbf{u}^{(1)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(1)}) \\right) $$\n$$ \\mathbf{u}^{n+1} = \\frac{1}{3} \\mathbf{u}^n + \\frac{2}{3} \\left( \\mathbf{u}^{(2)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(2)}) \\right) $$\n\nThe stability of this numerical scheme is limited by a Courant-Friedrichs-Lewy (CFL) condition that imposes an upper bound on the time step $\\Delta t$. Derive an expression for the maximum possible time step, $\\Delta t_{\\max}$, that ensures the stability of the method for all resolvable Fourier modes. Your final answer should be expressed in terms of the magnitude of the wave speed, $|c|$, and the number of collocation points, $N$.",
            "solution": "The one-dimensional linear advection equation $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$ with periodic boundary conditions, discretized in space by Fourier collocation on $[0,2\\pi]$ with $N$ equidistant points, leads to a semi-discrete ODE system\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u}) = -c D \\mathbf{u},\n$$\nwhere $D$ is the spectral first-derivative matrix. Because the Fourier collocation method represents Fourier modes $e^{ikx}$ exactly for integer $k$ with $|k| \\le N/2$, each mode is an eigenvector of $D$ with eigenvalue $ik$. Therefore the semi-discrete operator has eigenvalues\n$$\n\\lambda_{k} = -ick,\\quad |k| \\le \\frac{N}{2}.\n$$\nFor time integration with the three-stage, third-order SSP-RK3 method applied to the linear test equation $y'=\\lambda y$, a single time step satisfies\n$$\ny^{n+1} = R(z)\\,y^{n},\\quad z = \\lambda \\Delta t,\n$$\nwhere the stability function $R(z)$ of this SSP-RK3 scheme is\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6}.\n$$\nFor the present semi-discrete system, $z = \\lambda_{k} \\Delta t = -ick \\Delta t$. Let $y = ck \\Delta t$ and write $z = -iy$; since stability depends on $|z|$ along the imaginary axis, it suffices to consider $z = iy$ with real $y$. Then\n$$\nR(iy) = 1 + iy - \\frac{y^{2}}{2} - i \\frac{y^{3}}{6},\n$$\nso\n$$\n|R(iy)|^{2} = \\left(1 - \\frac{y^{2}}{2}\\right)^{2} + \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n= 1 - \\frac{y^{4}}{12} + \\frac{y^{6}}{36}.\n$$\nThe stability boundary on the imaginary axis is obtained from $|R(iy)|^{2} = 1$, which gives\n$$\n-\\frac{y^{4}}{12} + \\frac{y^{6}}{36} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{y^{4}}{36}\\left(y^{2} - 3\\right) = 0\n\\;\\;\\Longleftrightarrow\\;\\;\ny^{2} = 3.\n$$\nHence the method is stable for $|y| \\le \\sqrt{3}$, i.e.,\n$$\n|c|\\,|k|\\,\\Delta t \\le \\sqrt{3}.\n$$\nTo ensure stability for all resolvable Fourier modes, we impose this for the largest resolvable wavenumber magnitude $|k|_{\\max} = N/2$, which yields\n$$\n\\Delta t_{\\max} = \\frac{\\sqrt{3}}{|c|\\,|k|_{\\max}} = \\frac{\\sqrt{3}}{|c|\\,(N/2)} = \\frac{2\\sqrt{3}}{|c|\\,N}.\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{3}}{|c|\\,N}}$$"
        }
    ]
}