{
    "hands_on_practices": [
        {
            "introduction": "在掌握了色散关系保持（DRP）格式的理论之后，一个关键的实践步骤是确定在给定的误差容限下，数值模拟所需的网格分辨率。这个练习通过计算维持特定相速度误差所需的每波长点数（PPW），将抽象的色散误差概念与实际的网格划分参数直接联系起来。通过这个计算，您可以深入理解DRP格式的效率以及数值色散对模拟精度的影响 ()。",
            "id": "4120627",
            "problem": "考虑声速为 $c$ 的均匀、无粘性介质中的一维小振幅声波传播，其由以下线性声学方程组控制：\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \n\\qquad \n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是质点速度，$\\rho_{0}$ 是平均密度。对于形式为 $p(x,t) = \\hat{p} \\exp\\!\\big(i(k x - \\omega t)\\big)$ 的平面波解，连续色散关系意味着真实相速度为 $c_{\\text{true}} = \\omega/k = c$。\n\n一种保色散关系 (Dispersion-Relation-Preserving, DRP) 的有限差分空间离散方法使用对称的7点中心差分格式，在间距为 $h$ 的均匀网格上近似 $\\partial/\\partial x$：\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}\\big(q_{i+1}-q_{i-1}\\big) + a_{2}\\big(q_{i+2}-q_{i-2}\\big) + a_{3}\\big(q_{i+3}-q_{i-3}\\big)\\Big),\n$$\n其系数为 $a_{1} = \\frac{3}{4}$，$a_{2} = -\\frac{3}{20}$，$a_{3} = \\frac{1}{60}$，这些系数在色散优化的中心格式中常用。假设时间积分为精确的（半离散分析），因此数值相速度仅由空间算子产生。\n\n将相速度误差定义为数值相速度与真实相速度的相对偏差，即 $\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$。对于频率为 $f$、波长为 $\\lambda = c/f$ 的平面波，无量纲波数为 $\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$。数值相速度与真实相速度之比 $c_{\\text{num}}/c_{\\text{true}}$ 等于修正波数 $k^{\\ast}$ 与真实波数 $k$ 之比。\n\n给定 $c = 343\\,\\mathrm{m/s}$ 和 $f = 3\\,\\mathrm{kHz}$，确定所需的最小每波长点数 $\\lambda/h$，以使相速度误差不超过 $0.5$%，这可解释为 $0.005$ 的小数容差。所有三角函数参数均使用弧度制，并报告满足误差界限的最小整数值 $\\lambda/h$。由于所求量为整数，无需按有效数字取整。",
            "solution": "首先验证问题以确保其自洽、有科学依据且适定。\n\n### 步骤 1：提取给定信息\n- 控制方程：$\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0$，$\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0$。\n- 平面波解：$p(x,t) = \\hat{p} \\exp(i(k x - \\omega t))$。\n- 真实相速度：$c_{\\text{true}} = \\omega/k = c$。\n- 空间导数近似（7点中心差分格式）：\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}(q_{i+1}-q_{i-1}) + a_{2}(q_{i+2}-q_{i-2}) + a_{3}(q_{i+3}-q_{i-3})\\Big)\n$$\n- 差分格式系数：$a_{1} = \\frac{3}{4}$，$a_{2} = -\\frac{3}{20}$，$a_{3} = \\frac{1}{60}$。\n- 时间积分为精确的（半离散分析）。\n- 相速度误差定义：$\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$。\n- 无量纲波数：$\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$。\n- 数值相速度比：$c_{\\text{num}}/c_{\\text{true}} = k^{\\ast}/k$。\n- 物理常数：$c = 343\\,\\mathrm{m/s}$，$f = 3\\,\\mathrm{kHz}$。\n- 误差容差：相速度误差不得超过 $0.5\\%$，即小数容差为 $0.005$。\n- 目标：求每波长点数 $\\lambda/h$ 的最小整数值。\n\n### 步骤 2：使用提取的给定信息进行验证\n1.  **科学依据**：该问题基于标准的线性声学波动方程，并使用成熟的傅里叶分析方法（冯·诺依曼分析）来评估有限差分格式的色散特性。特定的7点差分格式系数出自 Tam 和 Webb (1993) 关于保色散关系 (DRP) 格式的开创性论文，该论文是计算声学领域的基石。该问题在科学上和数学上都是合理的。\n2.  **适定性**：所有必要信息均已提供。误差、波数和数值算子的定义都非常精确。目标陈述清晰。预期存在唯一的最小整数解。\n3.  **客观性**：语言精确，没有主观性。\n4.  **一致性**：给定信息是一致的。所提供的 $c=343\\,\\mathrm{m/s}$ 和 $f=3\\,\\mathrm{kHz}$ 值是为了提供物理背景，但如下文所示，它们并非确定无量纲量 $\\lambda/h$ 所必需的，这使得该问题成为一个关于数值格式属性的普适性问题。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将构建解答。\n\n### 解答推导\n\n半离散分析首先将有限差分空间算子应用于单个傅里叶模式 $q_j = \\hat{q} \\exp(i(kx_j - \\omega t))$，其中 $x_j = j h$ 是第 $j$ 个网格点的坐标，$h$ 是均匀网格间距。该模式的精确空间导数为 $\\frac{\\partial q}{\\partial x} = ikq$。有限差分算子将其转换为数值近似，实际上是用项 $ik^*$ 替代 $ik$，其中 $k^*$ 是修正波数。\n\n让我们将给定的7点差分格式应用于 $q_j$：\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{1}{h} \\sum_{m=1}^{3} a_m (q_{j+m} - q_{j-m})\n$$\n代入 $q_{j \\pm m} = \\hat{q} \\exp(i(k(j \\pm m)h - \\omega t)) = q_j \\exp(\\pm i k m h)$:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (\\exp(i m k h) - \\exp(-i m k h))\n$$\n使用欧拉公式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们得到：\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (2i \\sin(m k h)) = i \\left( \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h) \\right) q_j\n$$\n通过与精确导数 $ikq_j$ 进行比较，我们确定修正波数 $k^*$：\n$$\nk^* = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h)\n$$\n问题将无量纲波数定义为 $\\kappa = kh$。将上式乘以 $h$ 得到无量纲修正波数 $\\kappa^* = k^*h$：\n$$\n\\kappa^* = 2a_1\\sin(\\kappa) + 2a_2\\sin(2\\kappa) + 2a_3\\sin(3\\kappa)\n$$\n数值相速度与真实相速度之比为 $c_{\\text{num}}/c_{\\text{true}} = k^*/k$。这可以用无量纲量表示：\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{k^*h}{kh} = \\frac{\\kappa^*}{\\kappa}\n$$\n代入 $\\kappa^*$ 的表达式和给定的系数 $a_1=\\frac{3}{4}$，$a_2=-\\frac{3}{20}$，$a_3=\\frac{1}{60}$：\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( 2\\left(\\frac{3}{4}\\right)\\sin(\\kappa) + 2\\left(-\\frac{3}{20}\\right)\\sin(2\\kappa) + 2\\left(\\frac{1}{60}\\right)\\sin(3\\kappa) \\right)\n$$\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( \\frac{3}{2}\\sin(\\kappa) - \\frac{3}{10}\\sin(2\\kappa) + \\frac{1}{30}\\sin(3\\kappa) \\right)\n$$\n我们将此相速度比表示为 $R(\\kappa)$。问题要求相速度误差不超过 $0.5\\%$：\n$$\n\\left| \\frac{c_{\\text{num}}}{c_{\\text{true}}} - 1 \\right| \\le 0.005 \\quad \\implies \\quad 0.995 \\le R(\\kappa) \\le 1.005\n$$\n这种特定的DRP格式被设计为在其有效波数范围内，数值相速度小于或等于真实相速度，即 $R(\\kappa) \\le 1$。因此，误差条件简化为：\n$$\nR(\\kappa) \\ge 0.995\n$$\n无量纲波数 $\\kappa$ 与每波长点数 $N = \\lambda/h$ 的关系为：\n$$\n\\kappa = kh = \\frac{2\\pi}{\\lambda}h = \\frac{2\\pi}{\\lambda/h} = \\frac{2\\pi}{N}\n$$\n我们需要找到满足 $R(2\\pi/N) \\ge 0.995$ 的最小整数 $N$。随着 $N$ 增大，$\\kappa$ 减小并趋向于 $0$，而 $R(\\kappa)$ 趋向于 $1$。我们需要测试 $N$ 的整数值来找到临界值。\n\n让我们测试 $N = 6$：\n对于 $N=6$，$\\kappa = \\frac{2\\pi}{6} = \\frac{\\pi}{3}$。\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{\\pi/3} \\left( \\frac{3}{2}\\sin\\left(\\frac{\\pi}{3}\\right) - \\frac{3}{10}\\sin\\left(\\frac{2\\pi}{3}\\right) + \\frac{1}{30}\\sin(\\pi) \\right)\n$$\n我们知道 $\\sin(\\pi/3) = \\frac{\\sqrt{3}}{2}$，$\\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}$，以及 $\\sin(\\pi) = 0$。\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{3}{\\pi} \\left( \\frac{3}{2} \\cdot \\frac{\\sqrt{3}}{2} - \\frac{3}{10} \\cdot \\frac{\\sqrt{3}}{2} + 0 \\right) = \\frac{3}{\\pi} \\left( \\frac{3\\sqrt{3}}{4} - \\frac{3\\sqrt{3}}{20} \\right) = \\frac{3}{\\pi} \\left( \\frac{15\\sqrt{3} - 3\\sqrt{3}}{20} \\right)\n$$\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{3}{\\pi} \\frac{12\\sqrt{3}}{20} = \\frac{36\\sqrt{3}}{20\\pi} = \\frac{9\\sqrt{3}}{5\\pi}\n$$\n数值上，$R\\left(\\frac{\\pi}{3}\\right) \\approx \\frac{9 \\times 1.73205}{5 \\times 3.14159} \\approx \\frac{15.58845}{15.70795} \\approx 0.99239$。\n值 $0.99239$ 小于 $0.995$。因此，$N=6$ 是不够的。\n\n让我们测试 $N = 7$：\n对于 $N=7$，$\\kappa = \\frac{2\\pi}{7}$。\n$$\nR\\left(\\frac{2\\pi}{7}\\right) = \\frac{7}{2\\pi} \\left( \\frac{3}{2}\\sin\\left(\\frac{2\\pi}{7}\\right) - \\frac{3}{10}\\sin\\left(\\frac{4\\pi}{7}\\right) + \\frac{1}{30}\\sin\\left(\\frac{6\\pi}{7}\\right) \\right)\n$$\n在计算器上使用弧度模式：\n$\\sin(2\\pi/7) \\approx 0.781831$\n$\\sin(4\\pi/7) \\approx 0.974928$\n$\\sin(6\\pi/7) = \\sin(\\pi - \\pi/7) = \\sin(\\pi/7) \\approx 0.433884$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} \\left( \\frac{3}{2}(0.781831) - \\frac{3}{10}(0.974928) + \\frac{1}{30}(0.433884) \\right)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} (1.172747 - 0.292478 + 0.014463) = \\frac{7}{2\\pi} (0.894732)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{6.263124}{2\\pi} \\approx 0.99684\n$$\n值 $0.99684$ 大于 $0.995$。因此，$N=7$ 足以将相速度误差保持在 $0.5\\%$ 以下。\n由于 $N=6$ 不足而 $N=7$ 足够，所以每波长点数的最小整数值为 $7$。给定的 $c=343\\,\\mathrm{m/s}$ 和 $f=3\\,\\mathrm{kHz}$ 的值与真实世界场景一致，但计算无量纲比率 $\\lambda/h$ 并不需要它们。",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "DRP格式只是设计高阶差分算子的一种方法，另一种常见的方法是基于泰勒级数展开以最大化精度阶数。本练习通过直接比较一个优化后的DRP格式和一个标准的六阶中心差分格式，让您能够可视化并量化这两种不同设计哲学在整个波数域内的性能差异 ()。这有助于理解为何DRP格式在波动模拟中通常表现更优，尽管其在低波数区的局部截断误差可能并非最小。",
            "id": "4120595",
            "problem": "在计算声学中，考虑用于设计能够保持线性波传播色散关系的数值空间差分算子的平面波分析框架。保色散关系 (Dispersion-Relation-Preserving, DRP) 格式是一种有限差分离散方法，其离散空间算子产生的修正波数在一个很宽的无量纲波数范围内与精确的连续波数非常匹配。\n\n从以下基本出发点开始：应用于均匀网格（间距为 $h$）上的离散网格函数 $u_j = u(x_j)$ 的一维空间导数近似，可以使用中心反对称模板写为\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right),\n$$\n其中 $a_m$ 是常数模板系数，$M$ 是模板的半宽。对于波数为 $k$ 的空间傅里叶模式 $u(x) = e^{i k x}$，一个线性、常系数、移不变模板的作用可以通过由离散符号定义的修正波数 $k_{\\text{eff}}(k)$ 来表征。使用无量纲量 $\\hat{k}(\\theta)$（其中 $\\theta \\equiv k h$）来比较数值色散与精确关系，其中精确的连续行为对应于 $\\hat{k}(\\theta) = \\theta$。\n\n在本问题中，您将比较两种特定的用于一阶导数的中心反对称模板：\n- 一个优化的7点保色散关系 (DRP) 模板，其半宽为 $M = 3$，系数为 $a_1 = 0.77088238$、$a_2 = -0.16670590$、$a_3 = 0.02084314$，选择这些系数是为了满足主导一致性条件 $\\sum_{m=1}^{3} m\\,a_m = 1/2$，并在一个实际的 $\\theta$ 范围内优化数值色散。\n- 一个标准6阶中心差分模板，用于一阶导数，其半宽为 $M = 3$，系数为 $a_1 = 3/4$、$a_2 = -3/20$、$a_3 = 1/60$，这些系数满足 $\\sum_{m=1}^{3} m\\,a_m = 1/2$ 并产生 $O(h^6)$ 阶的截断误差。\n\n您的任务：\n1. 使用平面波拟设 $u_j = e^{i k x_j}$ 和线性移不变算子的离散符号定义，为中心反对称模板推导无量纲修正波数 $\\hat{k}(\\theta)$ 作为 $\\theta$ 和模板系数 $a_m$ 的函数表达式。不要假设任何已有的 $\\hat{k}(\\theta)$ 公式；通过将模板应用于 $u_j = e^{i k x_j}$ 从第一性原理进行推导。\n2. 实现一个程序，对于每个模板，在 $\\theta \\in [0,\\pi/2]$ 的范围内计算无量纲修正波数 $\\hat{k}(\\theta)$，其中 $\\theta$ 以弧度为单位。\n3. 计算并报告在 $\\theta \\in [0,\\pi/2]$ 范围内两个修正波数之间的最大绝对偏差，即 $\\max_{\\theta \\in [0,\\pi/2]} \\left|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)\\right|$，以及出现此最大值时的 $\\theta$ 值（以弧度为单位）。\n\n角度单位必须是弧度。所有数值输出必须四舍五入到六位小数。\n\n测试套件和要求的输出：\n- 使用三个测试用例，每个用例由用于离散化 $\\theta \\in [0,\\pi/2]$ 的均匀间隔采样点数 $N$ 定义：\n  1. $N = 10001$ (一个高分辨率的“理想路径”用例)。\n  2. $N = 101$ (一个中等分辨率的边界用例)。\n  3. $N = 2$ (一个仅采样端点的边缘用例)。\n- 对于每个测试用例，在指定的 $\\theta$ 值网格上评估两个修正波数曲线，计算最大绝对偏差和相应的 $\\theta$ 位置，并返回这两个值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个按 $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$ 顺序排列的双元素列表。例如，包含三个测试用例的输出必须如下所示：\n$$\n[[x_1,y_1],[x_2,y_2],[x_3,y_3]]\n$$\n无空格，其中 $x_i$ 和 $y_i$ 是四舍五入到六位小数的浮点数。",
            "solution": "问题陈述具有科学依据，表述清晰，客观且自洽，因此被认为是有效的。我们进行分步解答。\n\n### 第1部分：无量纲修正波数的推导\n\n主要任务是为一个通用的中心反对称有限差分模板推导无量纲修正波数 $\\hat{k}(\\theta)$ 的表达式。\n\n该模板将函数 $u(x)$ 在网格点 $x_j$ 处的一阶空间导数近似为：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right)\n$$\n在这里，$u_j = u(x_j)$，$h$ 是均匀网格间距，$a_m$ 是模板系数，$M$ 是模板半宽。这个数值算子，我们记为 $D_h$，是线性和移不变的。\n\n为了在傅里叶域中分析其行为，我们将该算子应用于单个空间傅里叶模式，也称为平面波。这就是平面波拟设：\n$$\nu(x) = e^{i k x}\n$$\n其中 $k$ 是连续波数，$i = \\sqrt{-1}$。在离散网格上，$x_j = j h$，函数表示为：\n$$\nu_j = e^{i k x_j} = e^{i k j h}\n$$\n在相邻网格点 $x_{j \\pm m} = (j \\pm m)h$ 处的值为：\n$$\nu_{j+m} = e^{i k (j+m)h} = e^{i k j h} e^{i m k h} = u_j e^{i m k h}\n$$\n$$\nu_{j-m} = e^{i k (j-m)h} = e^{i k j h} e^{-i m k h} = u_j e^{-i m k h}\n$$\n模板求和中的差分项变为：\n$$\nu_{j+m} - u_{j-m} = u_j e^{i m k h} - u_j e^{-i m k h} = u_j \\left(e^{i m k h} - e^{-i m k h}\\right)\n$$\n使用欧拉公式 $e^{i\\phi} - e^{-i\\phi} = 2i \\sin(\\phi)$，我们可以简化这个差分：\n$$\nu_{j+m} - u_{j-m} = u_j \\cdot 2i \\sin(m k h)\n$$\n将其代回模板公式，我们得到数值算子 $D_h$ 对平面波 $u_j$ 的作用：\n$$\nD_h[u_j] = \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left( u_j \\cdot 2i \\sin(m k h) \\right)\n$$\n由于 $u_j$ 和 $i$ 不依赖于求和索引 $m$，我们可以将它们提出：\n$$\nD_h[u_j] = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\n平面波 $u(x)=e^{ikx}$ 的精确连续导数为：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} (e^{i k x}) = i k e^{i k x} = (i k) u(x)\n$$\n通过类比，离散算子 $D_h$ 对离散平面波 $u_j$ 的作用定义了修正波数 $k_{\\text{eff}}$，它是满足以下条件的标量：\n$$\nD_h[u_j] = (i k_{\\text{eff}}) u_j\n$$\n通过令我们得到的两个 $D_h[u_j]$ 表达式相等，可得：\n$$\n(i k_{\\text{eff}}) u_j = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\n消去两边的公因子 $i u_j$ 可得到修正波数的表达式：\n$$\nk_{\\text{eff}} = \\frac{2}{h} \\sum_{m=1}^{M} a_m \\sin(m k h)\n$$\n为了得到无量纲形式，我们引入无量纲波数 $\\theta = k h$ 并定义无量纲修正波数为 $\\hat{k}(\\theta) = k_{\\text{eff}} h$。我们将 $k_{\\text{eff}}$ 的方程两边乘以 $h$：\n$$\nk_{\\text{eff}} h = 2 \\sum_{m=1}^{M} a_m \\sin(m (k h))\n$$\n代入无量纲变量，我们得到最终的推导表达式：\n$$\n\\hat{k}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta)\n$$\n该公式通过模板系数 $a_m$ 将有效的数值色散 $\\hat{k}(\\theta)$ 与理想色散 $\\hat{k}(\\theta)=\\theta$ 联系起来。\n\n### 第2部分和第3部分：数值计算与比较\n\n下一步是为给定的两个模板实现此公式，并计算它们各自的修正波数在区间 $\\theta \\in [0, \\pi/2]$ 上的最大绝对偏差。\n\n模板的系数如下：\n1.  **7点DRP模板 ($M=3$)：**\n    $a_1 = 0.77088238$\n    $a_2 = -0.16670590$\n    $a_3 = 0.02084314$\n2.  **6阶中心差分 (CD6) 模板 ($M=3$)：**\n    $a_1 = 3/4 = 0.75$\n    $a_2 = -3/20 = -0.15$\n    $a_3 = 1/60 \\approx 0.01666667$\n\n对于每个由 $N$（采样点数）定义的测试用例，我们将执行以下步骤：\n1.  在 $[0, \\pi/2]$ 范围内为 $\\theta$ 创建一个包含 $N$ 个点的均匀网格。\n2.  对于此网格上的每个 $\\theta$，使用DRP系数和推导出的公式计算 $\\hat{k}_{\\text{DRP}}(\\theta)$。\n3.  类似地，使用CD6系数计算 $\\hat{k}_{\\text{CD6}}(\\theta)$。\n4.  计算网格上所有点的绝对差 $|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)|$。\n5.  找到这个差的最大值以及它出现时对应的 $\\theta$ 值。\n6.  每个测试用例的结果 $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$ 将被收集并按规定格式化。\n\n计算逻辑将被封装在一个 Python 脚本中，利用 `numpy` 库进行高效的向量化计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing DRP and CD6 finite difference schemes.\n    \n    This function performs the following steps:\n    1. Defines the coefficients for the 7-point DRP and 6th-order centered\n       difference (CD6) stencils.\n    2. Defines the test cases based on the number of sample points N.\n    3. Implements a vectorized function to calculate the dimensionless \n       modified wavenumber for a given set of coefficients and theta values.\n    4. Iterates through each test case:\n       a. Creates a grid of theta values.\n       b. Computes the modified wavenumbers for both DRP and CD6 schemes.\n       c. Calculates the absolute difference between the two.\n       d. Finds the maximum deviation and the theta at which it occurs.\n    5. Formats and prints the final results as specified in the problem statement.\n    \"\"\"\n\n    # Stencil coefficients for M=3\n    # 7-point Dispersion-Relation-Preserving (DRP) stencil\n    coeffs_drp = np.array([0.77088238, -0.16670590, 0.02084314])\n    \n    # 6th-order Centered Difference (CD6) stencil\n    coeffs_cd6 = np.array([3.0/4.0, -3.0/20.0, 1.0/60.0])\n\n    # Test cases defined by the number of sample points N\n    test_cases = [10001, 101, 2]\n\n    results = []\n\n    def calculate_k_hat(theta_grid, coeffs):\n        \"\"\"\n        Calculates the dimensionless modified wavenumber k_hat(theta).\n        Formula: k_hat(theta) = 2 * sum_{m=1 to M} a_m * sin(m*theta)\n        \n        Args:\n            theta_grid (np.ndarray): An array of dimensionless wavenumbers theta.\n            coeffs (np.ndarray): The stencil coefficients [a_1, a_2, ..., a_M].\n\n        Returns:\n            np.ndarray: An array of k_hat values corresponding to the theta_grid.\n        \"\"\"\n        M = len(coeffs)\n        m_vals = np.arange(1, M + 1)\n        \n        # Create a matrix of m*theta values where rows correspond to theta\n        # and columns correspond to m.\n        m_theta_matrix = np.outer(theta_grid, m_vals)\n        \n        # Apply sin function element-wise\n        sin_matrix = np.sin(m_theta_matrix)\n        \n        # Compute the sum via matrix-vector multiplication\n        # (N, M) @ (M,) - (N,)\n        k_hat_values = 2 * (sin_matrix @ coeffs)\n        return k_hat_values\n\n    for n_points in test_cases:\n        # Create a uniform grid for theta in the range [0, pi/2]\n        theta_grid = np.linspace(0, np.pi/2, n_points)\n        \n        # Calculate the modified wavenumbers for both schemes\n        k_hat_drp = calculate_k_hat(theta_grid, coeffs_drp)\n        k_hat_cd6 = calculate_k_hat(theta_grid, coeffs_cd6)\n        \n        # Compute the absolute difference\n        abs_deviation = np.abs(k_hat_drp - k_hat_cd6)\n        \n        # Find the index of the maximum deviation\n        max_dev_index = np.argmax(abs_deviation)\n        \n        # Get the maximum deviation and the theta at which it occurs\n        max_dev = abs_deviation[max_dev_index]\n        theta_at_max = theta_grid[max_dev_index]\n        \n        results.append([max_dev, theta_at_max])\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_pair in results:\n        max_dev, theta_val = res_pair\n        # Format each number to 6 decimal places and create a string like \"[x.xxxxxx,y.yyyyyy]\"\n        formatted_pair = f\"[{max_dev:.6f},{theta_val:.6f}]\"\n        formatted_results.append(formatted_pair)\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在长时间的波动模拟中，每一步产生的微小相位误差会逐渐累积，最终导致与真实物理现象产生显著偏差。这个练习旨在阐明这一关键概念，通过计算一个驻波在数千个周期后累积的总相位误差，来量化不同空间离散格式的长期保真度 ()。这突显了在计算声学和其他波动问题中，选择低色散格式对于获得可靠的长期模拟结果是何等重要。",
            "id": "4120598",
            "problem": "考虑周期性域中的一维线性化声学问题。声压 $p(x,t)$ 和质点速度 $u(x,t)$ 的控制方程为以下一阶系统\n$p_t + K u_x = 0$ 和 $u_t + \\frac{1}{\\rho} p_x = 0$，其中 $K$ 为体积模量，$\\rho$ 为密度，声速为 $c = \\sqrt{K/\\rho}$。在长度为 $L$ 且具有周期性边界条件的连续域上，驻波初始条件 $p(x,0) = \\cos(k x)$，$u(x,0) = 0$ 会导出 $p(x,t) = \\cos(k x)\\cos(\\omega t)$，其角频率为 $\\omega = c\\,|k|$。我们关注的是半离散（空间离散，时间连续）情况，其中空间通过一种保色散关系 (DRP) 的中心有限差分格式进行离散以逼近空间一阶导数，而时间则进行精确积分（无时间离散误差）。空间网格有 $M$ 个点，均匀间距为 $\\Delta x = L/M$。离散一阶导数的格式是反对称的，形式如下\n$D[u]_n = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(u_{n+j} - u_{n-j})$，\n其中 $a_j$ 是给定的系数，$J$ 是半宽。假设在半离散一阶声学系统中使用该离散微分算子。对于波数为 $k = 2\\pi m/L$（其中 $m$ 为整数）的模态，半离散系统会再现一个振荡，其数值角频率 $\\omega_{\\text{num}}$ 由离散空间算子决定。长时间的驻波相位误差会根据 $\\Delta\\phi(T) = (\\omega_{\\text{num}} - \\omega)\\,T$ 线性累积，以弧度为单位。将在 $N$ 个精确连续周期 $T = N\\,\\frac{2\\pi}{\\omega}$ 后的展开累积相位误差定义为标量\n$\\Delta\\phi_N = (\\omega_{\\text{num}}/\\omega - 1)\\,2\\pi N$，\n这是需要计算的量。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 从基本声学模型和给定的离散空间导数出发，使用傅里叶分析来获得半离散色散关系，并由此推导出 $\\omega_{\\text{num}}$。\n- 对下面列出的每个测试用例，实现展开累积相位误差 $\\Delta\\phi_N$ 的计算。\n- 将结果以单行形式输出，用方括号括起，并以逗号分隔。\n\n所有物理量必须使用以下单位：$L$ 的单位是 $\\mathrm{m}$，$c$ 的单位是 $\\mathrm{m/s}$，累积相位误差 $\\Delta\\phi_N$ 必须以弧度报告。角度必须以弧度为单位。由于时间积分是精确的，因此没有时间步长。\n\n要使用的格式系数集（反对称中心差分一阶导数格式）：\n- 二阶中心差分：$J=1$，系数 $a_1 = 0.5$。\n- 四阶中心差分：$J=2$，系数 $a_1 = 0.6666666666666666$, $a_2 = -0.08333333333333333$。\n- 七点保色散关系优化格式 (Tam–Webb 类型)：$J=3$，系数 $a_1 = 0.770882380518225$, $a_2 = -0.166705904414580$, $a_3 = 0.020843142770311$。\n\n参数集 $(\\text{格式}, L, c, M, m, N)$ 的测试套件：\n- 用例 A（理想情况，良解析度的 DRP）：七点 DRP，$L = 1.0\\,\\mathrm{m}$，$c = 340.0\\,\\mathrm{m/s}$，$M = 256$，$m = 4$，$N = 1000$。\n- 用例 B（极低波数下的长时间累积）：七点 DRP，$L = 1.0\\,\\mathrm{m}$，$c = 340.0\\,\\mathrm{m/s}$，$M = 256$，$m = 1$，$N = 10000$。\n- 用例 C（中心差分格式的奈奎斯特边界情况）：二阶中心差分，$L = 1.0\\,\\mathrm{m}$，$c = 340.0\\,\\mathrm{m/s}$，$M = 128$，$m = 64$，$N = 5$。\n- 用例 D（中等解析度，非 DRP 高阶格式）：四阶中心差分，$L = 1.0\\,\\mathrm{m}$，$c = 340.0\\,\\mathrm{m/s}$，$M = 48$，$m = 9$，$N = 800$。\n\n您的程序必须：\n- 对于每个测试用例，计算 $\\Delta x = L/M$、连续波数 $k = 2\\pi m/L$，并使用空间格式获得该 $k$ 对应的离散修正波数 $\\tilde{k}$。\n- 利用半离散系统的精确时间积分特性，从离散空间算子获得 $\\omega_{\\text{num}}$，然后计算如上定义的展开累积相位误差 $\\Delta\\phi_N$。\n- 按用例 A-D 的顺序，将四个结果作为单行打印到标准输出，包含一个类似 Python 列表的字符串，其中有 4 个浮点数值，四舍五入到 10 位小数，例如 $[x_1,x_2,x_3,x_4]$。\n\n以弧度为单位作答。将每个结果四舍五入到 10 位小数。最终程序不得读取输入。",
            "solution": "该问题是有效的，因为它具有科学依据，提法明确，并包含了推导唯一解所需的所有信息。\n\n该解是通过分析半离散化声学方程的色散特性得出的。我们从连续系统开始，建立其色散关系，然后将其与由空间有限差分近似产生的数值色散关系进行对比。\n\n一维线性化声学方程以压力 $p(x,t)$ 和质点速度 $u(x,t)$ 的一阶系统形式给出：\n$$\n\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0 \\\\\n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0\n$$\n其中 $K$ 是体积模量，$\\rho$ 是密度。通过将第一个方程对时间 $t$ 求导，第二个方程对空间 $x$ 求导，并进行代入，可以将这些方程组合成一个二阶波动方程，得到：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}\n$$\n其中 $c = \\sqrt{K/\\rho}$ 是声速。\n为了找到连续色散关系，我们考虑一个形式为 $p(x,t) = \\hat{p} e^{i(kx - \\omega t)}$ 的平面波解。将其代入波动方程得到：\n$$\n(-i\\omega)^2 e^{i(kx - \\omega t)} = c^2 (ik)^2 e^{i(kx - \\omega t)} \\\\\n-\\omega^2 = -c^2 k^2\n$$\n这给出了精确的色散关系 $\\omega^2 = c^2 k^2$，即 $\\omega = c|k|$，其中 $k$ 是波数，$\\omega$ 是角频率。\n\n在半离散方法中，空间导数使用有限差分格式进行近似，而时间保持连续。网格点定义为 $x_n = n \\Delta x$，其中 $\\Delta x = L/M$ 是网格间距。空间导数算子由下式给出：\n$$\nD[f]_n = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(f_{n+j} - f_{n-j})\n$$\n半离散方程组变为：\n$$\n\\frac{d p_n}{dt} = -K D[u]_n \\\\\n\\frac{d u_n}{dt} = -\\frac{1}{\\rho} D[p]_n\n$$\n为了分析该系统的色散特性，我们考察其在单个空间傅里叶模态 $f_n = e^{ikx_n} = e^{ikn\\Delta x}$ 上的行为。将离散算子 $D$ 应用于此模态，得到：\n$$\nD[e^{ikn\\Delta x}] = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(e^{ik(n+j)\\Delta x} - e^{ik(n-j)\\Delta x}) \\\\\n= \\frac{e^{ikn\\Delta x}}{\\Delta x} \\sum_{j=1}^{J} a_j\\,(e^{ikj\\Delta x} - e^{-ikj\\Delta x})\n$$\n使用恒等式 $\\sin(\\theta) = (e^{i\\theta} - e^{-i\\theta})/(2i)$，上式简化为：\n$$\nD[e^{ikn\\Delta x}] = \\frac{e^{ikn\\Delta x}}{\\Delta x} \\sum_{j=1}^{J} a_j\\,(2i \\sin(kj\\Delta x)) \\\\\n= i \\left( \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x) \\right) e^{ikn\\Delta x}\n$$\n这表明对于一个傅里叶模态，离散微分算子 $D$ 的作用相当于乘以 $i\\tilde{k}$，其中 $\\tilde{k}$ 是*修正波数*：\n$$\n\\tilde{k}(k) = \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x)\n$$\n修正波数 $\\tilde{k}$ 是数值格式所“看到”的有效波数。$\\tilde{k}$ 与 $k$ 的任何偏差都会导致色散误差。\n\n将傅里叶模态表示 $p_n(t) = \\hat{p}(t)e^{ikn\\Delta x}$ 和 $u_n(t) = \\hat{u}(t)e^{ikn\\Delta x}$ 代入半离散系统，我们得到关于时变振幅 $\\hat{p}(t)$ 和 $\\hat{u}(t)$ 的常微分方程组：\n$$\n\\frac{d\\hat{p}}{dt} = -K (i\\tilde{k}) \\hat{u} \\\\\n\\frac{d\\hat{u}}{dt} = -\\frac{1}{\\rho} (i\\tilde{k}) \\hat{p}\n$$\n合并这些方程得到关于 $\\hat{p}(t)$ 的二阶常微分方程：\n$$\n\\frac{d^2\\hat{p}}{dt^2} = -K (i\\tilde{k}) \\frac{d\\hat{u}}{dt} = -K (i\\tilde{k}) \\left(-\\frac{1}{\\rho} (i\\tilde{k}) \\hat{p}\\right) = -\\frac{K}{\\rho}\\tilde{k}^2 \\hat{p} = -c^2 \\tilde{k}^2 \\hat{p}\n$$\n这是一个谐振子方程 $\\frac{d^2\\hat{p}}{dt^2} + (c\\tilde{k})^2 \\hat{p} = 0$，其解以数值角频率 $\\omega_{\\text{num}}$ 振荡，满足：\n$$\n\\omega_{\\text{num}}^2 = c^2 \\tilde{k}^2 \\implies \\omega_{\\text{num}} = c|\\tilde{k}|\n$$\n问题要求计算 $N$ 个连续周期后累积的展开相位误差，其定义为：\n$$\n\\Delta\\phi_N = \\left(\\frac{\\omega_{\\text{num}}}{\\omega} - 1\\right) 2\\pi N\n$$\n代入 $\\omega = c|k|$ 和 $\\omega_{\\text{num}} = c|\\tilde{k}|$ 的表达式，我们得到：\n$$\n\\Delta\\phi_N = \\left(\\frac{c|\\tilde{k}|}{c|k|} - 1\\right) 2\\pi N = \\left(\\frac{|\\tilde{k}|}{|k|} - 1\\right) 2\\pi N\n$$\n对于给定的问题设置，模态数 $m$ 为非负数，因此波数 $k = 2\\pi m/L \\ge 0$。反对称格式确保了在奈奎斯特极限以下的波数范围内，$\\tilde{k}$ 与 $k$ 的符号相同，因此我们可以去掉绝对值符号。\n$$\n\\Delta\\phi_N = \\left(\\frac{\\tilde{k}}{k} - 1\\right) 2\\pi N\n$$\n比率 $\\tilde{k}/k$ 可以用无量纲波数 $\\alpha = k\\Delta x$ 表示：\n$$\n\\frac{\\tilde{k}}{k} = \\frac{1}{k} \\left( \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x) \\right) = \\frac{2}{k\\Delta x} \\sum_{j=1}^{J} a_j \\sin(j(k\\Delta x)) = \\frac{2}{\\alpha} \\sum_{j=1}^{J} a_j \\sin(j\\alpha)\n$$\n对于每个测试用例，我们计算参数 $L, c, M, m, N$，它们决定了 $\\Delta x = L/M$ 和 $k=2\\pi m/L$。然后我们计算 $\\alpha = k\\Delta x = 2\\pi m/M$。使用适当的格式系数 $\\{a_j\\}$，我们计算比率 $\\tilde{k}/k$，并随后计算相位误差 $\\Delta\\phi_N$。\n\n具体的格式系数是：\n- 二阶中心差分：$J=1$，系数 $a_1 = 0.5$。\n- 四阶中心差分：$J=2$，系数 $a_1 = 2/3 \\approx 0.6666666666666666$，$a_2 = -1/12 \\approx -0.08333333333333333$。\n- 七点 DRP：$J=3$，系数 $a_1 = 0.770882380518225$，$a_2 = -0.166705904414580$，$a_3 = 0.020843142770311$。\n\n通过将这些公式直接应用于每个测试用例来进行计算。\n对于一个给定的测试用例 $(\\text{格式类型}, L, c, M, m, N)$：\n1. 计算 $\\alpha = 2\\pi m / M$。\n2. 为指定的格式选择系数 $a_j$。\n3. 如果 $\\alpha=0$，则比率 $\\tilde{k}/k = 1$。如果 $\\alpha \\neq 0$，则计算比率 $\\frac{\\tilde{k}}{k} = \\frac{2}{\\alpha} \\sum_{j=1}^{J} a_j \\sin(j\\alpha)$。\n4. 计算相位误差 $\\Delta\\phi_N = (\\tilde{k}/k - 1)2\\pi N$。\n该过程得出了所需的数值结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the accumulated unwrapped phase error for several\n    semi-discrete acoustic simulation test cases.\n    \"\"\"\n    \n    # Stencil coefficients for the discrete first derivative operator.\n    # D[u]_n = (1/dx) * sum_{j=1 to J} a_j * (u_{n+j} - u_{n-j})\n    stencils = {\n        \"second-order\": {\n            \"J\": 1,\n            \"a\": [0.5]\n        },\n        \"fourth-order\": {\n            \"J\": 2,\n            \"a\": [0.6666666666666666, -0.08333333333333333]\n        },\n        \"seven-point-drp\": {\n            \"J\": 3,\n            \"a\": [0.770882380518225, -0.166705904414580, 0.020843142770311]\n        }\n    }\n\n    # Test suite of parameter sets (stencil_name, L, c, M, m, N)\n    test_cases = [\n        # Case A\n        (\"seven-point-drp\", 1.0, 340.0, 256, 4, 1000),\n        # Case B\n        (\"seven-point-drp\", 1.0, 340.0, 256, 1, 10000),\n        # Case C\n        (\"second-order\", 1.0, 340.0, 128, 64, 5),\n        # Case D\n        (\"fourth-order\", 1.0, 340.0, 48, 9, 800),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        stencil_name, L, c, M, m, N = case\n        \n        # Calculate derived physical and numerical parameters\n        # delta_x = L / M\n        # k = 2 * np.pi * m / L\n        # alpha is the dimensionless wavenumber k * delta_x\n        # which simplifies to 2 * pi * m / M\n        alpha = 2 * np.pi * m / M\n        \n        stencil_data = stencils[stencil_name]\n        a_coeffs = stencil_data[\"a\"]\n        \n        # Calculate the ratio of numerical to exact frequency, which equals\n        # the ratio of modified to exact wavenumber, k_tilde / k.\n        \n        # Handle the case alpha = 0 to avoid division by zero, though not\n        # present in test cases. For alpha->0, k_tilde/k -> 1.\n        if alpha == 0:\n            ratio_k_tilde_over_k = 1.0\n        else:\n            # Calculate the sum term for the modified wavenumber formula\n            sum_term = 0.0\n            for j, a_j in enumerate(a_coeffs, 1):\n                sum_term += a_j * np.sin(j * alpha)\n            \n            # The ratio k_tilde/k = (2/alpha) * sum(...)\n            ratio_k_tilde_over_k = 2 * sum_term / alpha\n\n        # Calculate the unwrapped accumulated phase error\n        # delta_phi_N = (omega_num/omega - 1) * 2 * pi * N\n        # which is (k_tilde/k - 1) * 2 * pi * N\n        phase_error = (ratio_k_tilde_over_k - 1) * 2 * np.pi * N\n        \n        results.append(phase_error)\n\n    # Format output as a list of strings with 10 decimal places.\n    formatted_results = [f\"{res:.10f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}