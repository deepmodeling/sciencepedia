{
    "hands_on_practices": [
        {
            "introduction": "A stable simulation is the first prerequisite for obtaining meaningful results with the Finite-Difference Time-Domain (FDTD) method. This exercise establishes the fundamental rule governing this stability, the Courant-Friedrichs-Lewy (CFL) condition, by having you calculate the maximum permissible time step for a given spatial grid. Mastering this calculation is an essential first step for any practitioner in computational wave modeling, as it directly connects the spatial resolution, time step, and material properties .",
            "id": "1581145",
            "problem": "A researcher is developing a numerical model for light propagation within a silicon-based integrated photonic circuit. The model uses the Finite-Difference Time-Domain (FDTD) method to solve Maxwell's equations along a one-dimensional path corresponding to the core of a straight waveguide. The spatial domain is discretized into a uniform grid with a cell size of $\\Delta z = 1.50 \\, \\mu\\text{m}$. The waveguide core is made of silicon, which can be modeled as a simple, non-magnetic, lossless dielectric medium with a relative permittivity of $\\epsilon_r = 11.68$.\n\nTo ensure the FDTD simulation remains numerically stable and produces physically meaningful results, the time step $\\Delta t$ used in the simulation must be chosen carefully. Calculate the maximum possible time step, $\\Delta t_{\\text{max}}$, that guarantees the stability of this 1D simulation.\n\nFor your calculation, use the speed of light in vacuum, $c = 2.998 \\times 10^8 \\, \\text{m/s}$.\n\nExpress your final answer in femtoseconds ($fs$). Round your final answer to three significant figures.",
            "solution": "For a one-dimensional Yee FDTD scheme, the Courant stability condition requires that the Courant number based on the medium wave speed satisfy\n$$\nS \\equiv \\frac{v\\,\\Delta t}{\\Delta z} \\leq 1,\n$$\nwhere $v$ is the electromagnetic wave speed in the medium. Therefore, the maximum stable time step is\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z}{v}.\n$$\nIn a simple, non-magnetic, lossless dielectric with relative permittivity $\\epsilon_{r}$ and $\\mu_{r}=1$, the wave speed is\n$$\nv=\\frac{1}{\\sqrt{\\mu \\epsilon}}=\\frac{c}{\\sqrt{\\epsilon_{r}}},\n$$\nso\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z\\,\\sqrt{\\epsilon_{r}}}{c}.\n$$\n\nSubstituting the given values $\\Delta z=1.50 \\times 10^{-6}\\ \\text{m}$, $\\epsilon_{r}=11.68$, and $c=2.998 \\times 10^{8}\\ \\text{m/s}$,\n$$\n\\Delta t_{\\text{max}}=\\frac{\\left(1.50 \\times 10^{-6}\\right)\\sqrt{11.68}}{2.998 \\times 10^{8}}\\ \\text{s}.\n$$\nCompute $\\sqrt{11.68} \\approx 3.4176$, giving\n$$\n\\Delta t_{\\text{max}}=\\frac{1.50 \\times 10^{-6} \\times 3.4176}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\frac{5.1264 \\times 10^{-6}}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{5.1264}{2.998}\\right)\\times 10^{-14}\\ \\text{s}\n\\approx 1.70995 \\times 10^{-14}\\ \\text{s}.\n$$\nConverting to femtoseconds using $1\\ \\text{fs}=10^{-15}\\ \\text{s}$,\n$$\n\\Delta t_{\\text{max}} \\approx 17.0995\\ \\text{fs}.\n$$\nRounding to three significant figures yields $17.1\\ \\text{fs}$.",
            "answer": "$$\\boxed{17.1}$$"
        },
        {
            "introduction": "While the Courant condition provides a simple rule for stability, a deeper understanding comes from analyzing how errors propagate within the numerical scheme. This problem guides you through a formal von Neumann stability analysis, a cornerstone technique that reveals the origin of numerical instability by examining the amplification of different Fourier modes over time. You will demonstrate analytically not just that a scheme is unstable, but precisely *how* violating the Courant condition leads to exponential error growth for specific wavenumbers, a critical insight for diagnosing and designing robust FDTD codes .",
            "id": "4141995",
            "problem": "Consider one-dimensional lossless linear acoustics modeled by the scalar wave equation for acoustic pressure $p(x,t)$,\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2}\\,\\frac{\\partial^{2} p}{\\partial x^{2}},\n$$\nwhere $c$ is the sound speed. Discretize this equation on a uniform grid using the standard second-order central-difference scheme in both space and time, located on the same grid (no staggering). That is, let $x_i = i\\,\\Delta x$ and $t^n = n\\,\\Delta t$ for integers $i$ and $n$, and approximate the second derivatives with centered finite differences to obtain a fully explicit time-marching scheme of the Finite-Difference Time-Domain (FDTD) type.\n\nPerform a von Neumann (Fourier) stability analysis: assume a discrete Fourier mode $p_i^n = \\lambda^n \\exp(\\mathrm{i} k x_i)$ and derive the scalar quadratic satisfied by the amplification factor $\\lambda$ as a function of the dimensionless Courant number $\\sigma = c\\,\\Delta t / \\Delta x$ and the nondimensional wavenumber $\\theta = k\\,\\Delta x$. Use this to obtain an analytic expression for the two roots $\\lambda_{\\pm}(\\theta)$ and their magnitudes.\n\nNow, provide a concrete numerical example with $c = 343$ m/s (speed of sound in air at room temperature), $\\Delta x = 0.01$ m, and choose $\\Delta t$ so that the Courant number equals $\\sigma = c\\,\\Delta t/\\Delta x = 1.05$. For the most critical discrete spatial Fourier mode on a uniform grid, namely the Nyquist mode with $\\theta = \\pi$, evaluate the magnitude $|\\lambda|$ of the unstable root. Round your answer to four significant figures. Express the final result as a dimensionless number (no units). Along the way, demonstrate analytically why the scheme becomes unstable when $\\sigma = 1.05$ by showing that $|\\lambda| > 1$ for that mode.",
            "solution": "**1. FDTD Scheme and von Neumann Analysis**\n\nThe one-dimensional wave equation is discretized using second-order central differences in space and time on a collocated grid:\n$$\n\\frac{p_i^{n+1} - 2p_i^n + p_i^{n-1}}{(\\Delta t)^{2}} = c^{2} \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^{2}}\n$$\nUsing the Courant number $\\sigma = c\\,\\Delta t / \\Delta x$, this can be rearranged into the explicit FDTD scheme:\n$$\np_i^{n+1} - 2p_i^n + p_i^{n-1} = \\sigma^{2} (p_{i+1}^n - 2p_i^n + p_{i-1}^n)\n$$\nTo perform a von Neumann stability analysis, we substitute the Fourier mode ansatz $p_i^n = \\lambda^n \\exp(\\mathrm{i} k x_i)$ into the scheme. Defining the nondimensional wavenumber $\\theta = k\\,\\Delta x$, and dividing by $\\lambda^{n-1}\\exp(\\mathrm{i}i\\theta)$, we obtain:\n$$\n\\lambda^2 - 2\\lambda + 1 = \\sigma^2 \\lambda (e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta})\n$$\nUsing Euler's identity ($e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos\\theta$) and the half-angle identity ($1-\\cos\\theta = 2\\sin^2(\\theta/2)$), we arrive at the quadratic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^{2} - 2\\left(1 - 2\\sigma^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right)\\lambda + 1 = 0\n$$\n\n**2. Stability Condition and Analysis**\n\nThe quadratic equation has the form $\\lambda^2 - 2A\\lambda + 1 = 0$, with roots $\\lambda_{\\pm} = A \\pm \\sqrt{A^2-1}$. For the scheme to be stable, the magnitude of the roots must be less than or equal to 1 for all $\\theta$. This occurs when the discriminant is non-positive ($A^2 \\le 1$), which means $|A| \\le 1$. This condition is:\n$$\n\\left|1 - 2\\sigma^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right| \\le 1\n$$\nThis inequality must hold for the most restrictive case, which is the Nyquist mode ($\\theta=\\pi$, so $\\sin^2(\\theta/2)=1$). This yields the Courant-Friedrichs-Lewy (CFL) stability condition: $\\sigma \\le 1$.\n\nIn this problem, $\\sigma = 1.05$, which violates the CFL condition. For the Nyquist mode ($\\theta=\\pi$):\n$$\nA = 1 - 2(1.05)^2 \\sin^2(\\pi/2) = 1 - 2(1.1025) = -1.205\n$$\nSince $|A| > 1$, the roots are real, and one root will have a magnitude greater than 1, indicating instability. The unstable root is $\\lambda_{-} = A - \\sqrt{A^2 - 1}$.\n\n**3. Numerical Evaluation**\n\nThe magnitude of the unstable root is:\n$$\n|\\lambda_{\\text{unstable}}| = |A - \\sqrt{A^2 - 1}| = -A + \\sqrt{A^2 - 1}\n$$\nPlugging in $A = -1.205$:\n$$\n|\\lambda_{\\text{unstable}}| = 1.205 + \\sqrt{(-1.205)^2 - 1} = 1.205 + \\sqrt{1.452025 - 1}\n$$\n$$\n|\\lambda_{\\text{unstable}}| = 1.205 + \\sqrt{0.452025} \\approx 1.205 + 0.672328 = 1.877328...\n$$\nRounding to four significant figures gives $1.877$.",
            "answer": "$$\\boxed{1.877}$$"
        },
        {
            "introduction": "Beyond basic stability, accurate FDTD simulations require careful handling of source injection to avoid introducing non-physical artifacts. This problem addresses the subtle but common issue of a spurious DC offset, a persistent, non-propagating bias in the pressure field that can contaminate simulation results. By analyzing the properties of the discrete source and its interaction with the update equations and boundary conditions, you will learn a crucial technique for ensuring the physical fidelity of your simulations and understand why seemingly perfect absorbing boundaries like PMLs cannot correct for this type of error .",
            "id": "4141938",
            "problem": "In computational acoustics, a common way to excite waves in the Finite-Difference Time-Domain (FDTD) method is to inject a compactly supported source waveform at a point as an additive term in the pressure update equation. Consider a one-dimensional ($1$D) linear acoustic medium described by the linearized momentum and continuity equations, with pressure $p(x,t)$, particle velocity $u(x,t)$, mass density $\\rho_0$, speed of sound $c$, and isentropic compressibility $\\kappa = 1/(\\rho_0 c^2)$. On a standard staggered grid, let $p$ be updated at integer time indices $n$ and $u$ at half-indices $n+\\tfrac{1}{2}$, using a conventional second-order accurate explicit scheme. A point source is implemented as an additive term $q^n$ at a single pressure grid point in the $p$-update over $n = 0,\\dots, N-1$, where $q^n$ is the sampled source sequence $s^n$ with time step $\\Delta t$. The spatial domain is large and terminated by a Perfectly Matched Layer (PML) chosen to effectively absorb outgoing time-varying waves with minimal reflection.\n\nA spurious direct current (DC) offset, i.e., a nonzero quasi-static bias in $p$, can appear after the source pulse if the source waveform is not appropriately conditioned, even though the PMLs are in place. Which of the following statements correctly explain design steps that prevent a spurious DC offset in the FDTD acoustic pressure field for such source injection? Select all that apply.\n\nA. Enforce the discrete-time zero-mean condition over the excitation window, specifically choose $s^n$ such that $\\sum_{n=0}^{N-1} s^n \\,\\Delta t = 0$, otherwise a net bias accumulates through the discrete pressure update.\n\nB. Ensuring the continuous-time condition $\\int_{0}^{T} s(t)\\,\\mathrm{d}t = 0$ for some $T = N \\Delta t$ is always sufficient; any deviation of $\\sum_{n=0}^{N-1} s^n \\,\\Delta t$ from zero due to sampling will be removed by the PML.\n\nC. Placing the source exactly at a pressure node on the staggered grid eliminates DC offset without the need to enforce zero mean in $s^n$, because the grid staggering inherently cancels any static bias.\n\nD. Precondition the discrete source by subtracting its discrete mean, i.e., use $s^n_{\\text{zc}} = s^n - \\bar{s}$ with $\\bar{s} = \\frac{1}{N}\\sum_{n=0}^{N-1} s^n$, so that $\\sum_{n=0}^{N-1} s^n_{\\text{zc}} \\,\\Delta t = 0$ and no net bias is injected.\n\nE. Relying on the PML alone suffices: even if $\\sum_{n=0}^{N-1} s^n \\,\\Delta t \\neq 0$, the PML will absorb any static offset as though it were an outgoing wave.",
            "solution": "A spurious DC offset in an FDTD simulation arises when the source injection process creates a net, non-propagating pressure bias. This occurs if the discrete time integral of the source term is non-zero. Let's analyze why and how to prevent it.\n\nThe homogeneous FDTD equations for linear acoustics support a trivial steady-state solution where the pressure is constant everywhere ($p_i = P_0$) and the velocity is zero ($u_{i+1/2}=0$). If a source injects a net \"charge\" into the domain—that is, if the sum of all additive source terms over time is non-zero—the system can settle into this non-physical state after the propagating waves have dissipated or left the domain.\n\nPerfectly Matched Layers (PMLs) are designed to absorb *time-varying* waves by creating a lossy, impedance-matched medium. They are ineffective at absorbing a static (zero-frequency) DC offset. Therefore, the PML cannot correct for a DC bias introduced by the source.\n\nBased on this understanding, let's evaluate the options:\n\n**A. Correct.** This statement correctly identifies the root cause. The discrete time integral of the source is $\\sum_{n=0}^{N-1} s^n \\Delta t$. Forcing this sum to be zero ensures no net pressure bias is added to the system over the source duration.\n\n**B. Incorrect.** The FDTD scheme operates on the discrete sequence $s^n$. A continuous function $s(t)$ with a zero integral might not yield a discrete sum of zero due to sampling. The discrete condition is what matters. Furthermore, the PML will not remove the resulting DC offset.\n\n**C. Incorrect.** The problem arises from the time-integration of the source term, not its spatial location. The staggered grid supports a DC offset as a valid solution, so placing the source on a pressure node does nothing to prevent it.\n\n**D. Correct.** This describes a standard and correct procedure to enforce the condition in (A). By calculating the discrete mean $\\bar{s}$ of the source sequence and subtracting it from each sample, the resulting sequence $s^n_{\\text{zc}}$ is guaranteed to have a sum of zero, thus preventing the injection of a DC offset.\n\n**E. Incorrect.** PMLs absorb propagating waves, not static pressure offsets. A DC bias will persist in the domain despite the presence of PMLs.\n\nTherefore, the correct design steps are to ensure the discrete source signal has a zero mean, as described in options A and D.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}