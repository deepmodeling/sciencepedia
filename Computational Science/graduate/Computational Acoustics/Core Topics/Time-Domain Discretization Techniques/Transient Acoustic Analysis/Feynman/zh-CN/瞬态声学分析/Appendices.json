{
    "hands_on_practices": [
        {
            "introduction": "在开发或使用任何数值求解器之前，首要任务是验证其能否准确再现已知的物理现象。本练习  旨在通过两个经典的基准问题——一维黎曼问题和三维自由空间脉冲——来巩固这一核心理念。您需要推导出精确的验证标准，包括波的到达时间、振幅变化和能量守恒特性，这些是评估瞬态声学仿真保真度的黄金标准。",
            "id": "4149226",
            "problem": "考虑一个线性化小振幅声学模型，在一维空间中用于一个基准 Riemann 问题，在三维空间中用于一个基准自由空间出射脉冲。一维模型（对静态的微小扰动有效）由线性化的连续性方程和动量方程控制，对于压力 $p(x,t)$ 和质点速度 $u(x,t)$，方程为 $p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$，其中 $\\rho_0$ 是恒定的参考密度， $c$ 是声速。三维模型中，压力场 $p(\\mathbf{x},t)$ 由自由空间中的齐次声波方程 $p_{tt} - c^2 \\Delta p = 0$ 控制。\n\n基准 1 (一维 Riemann 问题)：在 $x=0$ 处取一个初始间断，$p(x,0) = p_0 H(x)$ 且 $u(x,0) = 0$，其中 $H(x)$ 是 Heaviside 阶跃函数。设 $\\rho_0 = 1.2$ (参考密度，单位为千克/立方米)，$c = 343$ (声速，单位为米/秒)，$p_0 = 1.0$ (压力幅值，单位为帕斯卡)。一个探头放置在 $x = -L$ 处，其中 $L=0.5$ (米)。被验证的数值格式应能复现正确的波速、到达时间和波幅，并应满足该线性化系统的适当能量性质。\n\n基准 2 (三维自由空间出射脉冲)：考虑一个球对称的纯出射脉冲，通过指定初始数据 $p(\\mathbf{x},0) = 0$ 和 $p_t(\\mathbf{x},0) = g(|\\mathbf{x}|)$ 生成，其中 $g$ 是一个紧支集的径向对称函数，使得得到的解是一个出射球面波。在从原点出发的任意射线上，于半径 $R_1 = 0.5$ 和 $R_2 = 1.0$ (米) 处放置两个探头。被验证的数值解应表现出正确的几何扩散、脉冲峰值的到达时间，以及与声波方程相关的物理上适当的守恒性质。\n\n哪个选项为这些基准问题最佳地规定了物理上正确且精确的验证标准，包括到达时间、振幅和基于范数的检验？\n\nA. 对于基准 1，压力和速度分裂为速度为 $\\pm c$ 的左行波和右行波。在探头 $x = -L$ 处，首次非零到达发生在时间 $t^* = L/c \\approx 0.001458$ (秒)。到达后瞬间，$p(-L,t^*+) = p_0/2 = 0.5$ 且 $u(-L,t^*+) = -\\dfrac{p_0}{2 \\rho_0 c} \\approx -0.00121$ (米/秒)，负号表示向左运动。一个稳健的验证必须包括一维的离散声能检验，使用能量密度 $\\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\dfrac{p^2}{\\rho_0 c^2}$，并报告相对能量随时间的变化。对于基准 2，出射球面波表现出与 $1/r$ 成正比的振幅衰减，脉冲峰值在半径 $R$ 处到达的时间为 $t_R = R/c$，因此 $t_{R_1} \\approx 0.001458$ 且 $t_{R_2} \\approx 0.002915$ (秒)。峰值振幅比满足 $p_{\\max}(R_2)/p_{\\max}(R_1) = R_1/R_2 = 0.5$，一个适当的验证包括将测量的 $L^\\infty$ 振幅与 $1/r$ 定律进行比较，并进行球面上的能量通量一致性检验。\n\nB. 对于基准 1，在 $x=-L$ 处的到达时间为 $t^* = 2L/c \\approx 0.002915$ (秒)，并且观察到完全跳跃 $p(-L,t^*+) = p_0 = 1.0$，同时 $u(-L,t^*+) = +\\dfrac{p_0}{\\rho_0 c}$ (米/秒)。验证基于压力 $p$ 的 $L^2$ 范数在空间上的守恒。对于基准 2，振幅按 $1/r^2$ 衰减，峰值到达时间为 $t_{R_1} = R_1/c$ 和 $t_{R_2} = R_2/c$，且 $p_{\\max}(R_2)/p_{\\max}(R_1) = (R_1/R_2)^2 = 0.25$。\n\nC. 对于基准 1，选择探头在 $x = +L$ 处，并预期首次到达时间为 $t^* = L/c \\approx 0.001458$ (秒)，此时 $p(+L,t^*+) = p_0/2 = 0.5$ 且 $u(+L,t^*+) = +\\dfrac{p_0}{2 \\rho_0 c}$ (米/秒)。验证使用 $p$ 的 $L^2$ 范数，并要求它在数值容差范围内不变。对于基准 2，半径 $R$ 处的振幅与 $R$ 无关，因此 $p_{\\max}(R_2)/p_{\\max}(R_1) = 1$，峰值在 $t_R = R/c$ 到达。\n\nD. 对于基准 1，波速取决于初始跳跃的局部波数，因此由于色散，在 $x=-L$ 处的到达时间满足 $t^* > L/c$，并且到达后的平台值为 $p_0$，同时 $u=0$。对于基准 2，球面脉冲表现出扩散性展宽，因此振幅比 $1/r^2$ 衰减得更快，在半径 $R$ 处的峰值到达时间晚于 $R/c$，因此验证应侧重于匹配一个小于 $c$ 的频率相关群速度和 $L^2$ 范数的耗散衰减。",
            "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n\n**基准 1：一维 Riemann 问题**\n- 控制方程：$p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$。\n- 变量：压力 $p(x,t)$，质点速度 $u(x,t)$。\n- 常数：参考密度 $\\rho_0 = 1.2$ kg/m$^3$，声速 $c = 343$ m/s。\n- 初始条件 ($t=0$)：$p(x,0) = p_0 H(x)$ 和 $u(x,0) = 0$，压力幅值 $p_0 = 1.0$ Pa， $H(x)$ 为 Heaviside 阶跃函数。\n- 探头位置：$x = -L$，其中 $L = 0.5$ m。\n- 陈述的验证目标：正确的波速、到达时间、波幅和能量性质。\n\n**基准 2：三维自由空间出射脉冲**\n- 控制方程：自由空间中的 $p_{tt} - c^2 \\Delta p = 0$。\n- 变量：压力场 $p(\\mathbf{x},t)$。\n- 初始条件 ($t=0$)：$p(\\mathbf{x},0) = 0$ 和 $p_t(\\mathbf{x},0) = g(|\\mathbf{x}|)$，其中 $g$ 是一个紧支集的径向对称函数。\n- 预期解：一个纯出射的球对称波。\n- 探头位置：半径 $R_1 = 0.5$ m 和 $R_2 = 1.0$ m。\n- 陈述的验证目标：正确的几何扩散、脉冲峰值到达时间以及守恒性质。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **有科学依据**：该问题基于一维和三维声学的基本线性化方程。这些是标准的教科书模型。初始值问题（一个 Riemann 问题和一个脉冲生成问题）是计算波物理中的经典基准问题。所有物理参数对于标准条件下的空气都是现实的。该问题在科学上是合理的。\n- **适定性**：带 Riemann 数据的一维双曲系统和带光滑、紧支集初始数据的三维波动方程是适定初值问题的经典例子，其存在唯一且稳定的解，并且可以解析地求出。\n- **客观性**：该问题使用精确、无歧义的数学和物理术语进行陈述。它不含主观或基于观点的内容。\n\n**第 3 步：结论和行动**\n问题陈述是有效的。它有科学依据、适定且客观。我将继续推导解答并评估各个选项。\n\n**解析解的推导**\n\n**基准 1：一维 Riemann 问题**\n方程组 $p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$ 是一个标准的双曲系统，其解以特征速度 $\\lambda = \\pm c$ 传播。通解可以表示为一个右行波 $f(x-ct)$ 和一个左行波 $g(x+ct)$ 的叠加。\n对于状态向量 $(p, u)$，解为：\n$$ p(x,t) = f(x-ct) + g(x+ct) $$\n$$ u(x,t) = \\frac{1}{\\rho_0 c} f(x-ct) - \\frac{1}{\\rho_0 c} g(x+ct) $$\n初始条件为 $p(x,0) = p_0 H(x)$ 和 $u(x,0) = 0$。\n在 $t=0$ 时：\n$p(x,0) = f(x) + g(x) = p_0 H(x)$\n$u(x,0) = \\frac{1}{\\rho_0 c} [f(x) - g(x)] = 0 \\implies f(x) = g(x)$\n将 $f(x) = g(x)$ 代入第一个方程得到 $2f(x) = p_0 H(x)$，所以 $f(x) = g(x) = \\frac{p_0}{2}H(x)$。\n因此，完整解为：\n$$ p(x,t) = \\frac{p_0}{2} H(x-ct) + \\frac{p_0}{2} H(x+ct) $$\n$$ u(x,t) = \\frac{p_0}{2\\rho_0 c} H(x-ct) - \\frac{p_0}{2\\rho_0 c} H(x+ct) $$\n这表明在 $x=0$ 处的初始跳跃分裂成两个振幅减半、方向相反的波。\n一个探头位于 $x = -L = -0.5$ m。该探头只会受到左行波的影响，该波由宗量为 $x+ct$ 的项描述。波前在时间 $t^*$ 到达 $x=-L$，满足 $-L + ct^* = 0$，从而得出 $t^* = L/c$。\n使用给定值 $L=0.5$ m 和 $c=343$ m/s，到达时间为：\n$$ t^* = \\frac{0.5}{343} \\approx 0.0014577 \\text{ s} \\approx 0.001458 \\text{ s} $$\n对于 $t > t^*$，探头 $x = -L$ 处的状态是确定的。在此位置，对于所有 $t>0$，都有 $x-ct = -L-ct  0$，因此 $H(x-ct)=0$。宗量 $x+ct = -L+ct  0$，因此 $H(x+ct)=1$。\n对于 $t  t^*$，探头处的压力和速度为：\n$$ p(-L, tt^*) = \\frac{p_0}{2}(0) + \\frac{p_0}{2}(1) = \\frac{p_0}{2} = \\frac{1.0}{2} = 0.5 \\text{ Pa} $$\n$$ u(-L, tt^*) = \\frac{p_0}{2\\rho_0 c}(0) - \\frac{p_0}{2\\rho_0 c}(1) = -\\frac{p_0}{2\\rho_0 c} = -\\frac{1.0}{2(1.2)(343)} \\approx -0.0012147 \\text{ m/s} \\approx -0.00121 \\text{ m/s} $$\n负速度表示质点在 $-x$ 方向（向左）运动，与波的传播方向一致。\n对于这个非耗散系统，总声能是一个守恒量，其能量密度为 $E_d = \\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\frac{p^2}{\\rho_0 c^2}$。验证其离散模拟量的守恒性是数值格式的一个标准且关键的测试。\n\n**基准 2：三维自由空间出射脉冲**\n对于径向对称压力 $p(r,t)$，三维波动方程 $p_{tt} - c^2 \\Delta p = 0$ 可以通过代换 $q(r,t) = r p(r,t)$ 来简化，得到一维波动方程 $q_{tt} - c^2 q_{rr} = 0$。\n$p(r,t)$ 的通解为 $p(r,t) = \\frac{f(r-ct)}{r} + \\frac{g(r+ct)}{r}$。\n问题指定了一个“纯出射脉冲”，对应于解 $p(r,t) = \\frac{f(r-ct)}{r}$。这个函数形式表明，波形 $f$ 的振幅按 $1/r$ 衰减。这种现象被称为几何扩散。\n压力脉冲在半径 $R$ 处的峰值振幅，记为 $p_{\\max}(R)$，与 $1/R$ 成正比。在两个半径 $R_1$ 和 $R_2$ 处的峰值振幅之比为：\n$$ \\frac{p_{\\max}(R_2)}{p_{\\max}(R_1)} = \\frac{k/R_2}{k/R_1} = \\frac{R_1}{R_2} $$\n当 $R_1 = 0.5$ m 和 $R_2 = 1.0$ m 时，该比值为 $0.5/1.0 = 0.5$。\n波形以速度 $c$ 向外传播。因此，脉冲的峰值（位于 $f$ 的宗量的某个位置）在时间 $t_R = R/c$（相对于其从原点的“发射”时间）到达半径 $R$。\n在探头处的到达时间为：\n$$ t_{R_1} = \\frac{R_1}{c} = \\frac{0.5}{343} \\approx 0.001458 \\text{ s} $$\n$$ t_{R_2} = \\frac{R_2}{c} = \\frac{1.0}{343} \\approx 0.002915 \\text{ s} $$\n对于一个三维出射球面波，流过任何包围声源的半径为 $r$ 的球面的总声功率是恒定的。声强（单位面积的功率）为 $I_r \\propto p^2$。总功率为 $P = I_r \\times (\\text{面积}) = I_r \\times (4\\pi r^2)$。由于 $p \\propto 1/r$，则 $I_r \\propto p^2 \\propto 1/r^2$。因此，$P \\propto (1/r^2) \\times (4\\pi r^2)$，这与 $r$ 无关。验证数值计算的能量通量在不同半径的球面上是一致的，是一个稳健的验证检验。\n\n**逐项分析**\n\n**A. 对于基准 1，压力和速度分裂为速度为 $\\pm c$ 的左行波和右行波。在探头 $x = -L$ 处，首次非零到达发生在时间 $t^* = L/c \\approx 0.001458$ (秒)。到达后瞬间，$p(-L,t^*+) = p_0/2 = 0.5$ 且 $u(-L,t^*+) = -\\dfrac{p_0}{2 \\rho_0 c} \\approx -0.00121$ (米/秒)，负号表示向左运动。一个稳健的验证必须包括一维的离散声能检验，使用能量密度 $\\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\dfrac{p^2}{\\rho_0 c^2}$，并报告相对能量随时间的变化。对于基准 2，出射球面波表现出与 $1/r$ 成正比的振幅衰减，脉冲峰值在半径 $R$ 处到达的时间为 $t_R = R/c$，因此 $t_{R_1} \\approx 0.001458$ 且 $t_{R_2} \\approx 0.002915$ (秒)。峰值振幅比满足 $p_{\\max}(R_2)/p_{\\max}(R_1) = R_1/R_2 = 0.5$，一个适当的验证包括将测量的 $L^\\infty$ 振幅与 $1/r$ 定律进行比较，并进行球面上的能量通量一致性检验。**\n- 该选项对基准 1 的描述与上面推导的解析解完全一致：波的分裂、速度、到达时间以及 $p$ 和 $u$ 的到达后值都是正确的。提议的能量守恒检验在物理上是正确的。\n- 对基准 2 的描述也完全正确：$1/r$ 振幅衰减、峰值到达时间、峰值振幅比以及提议的验证检验（$L^\\infty$ 范数衰减和能量通量）都是适当且准确的。\n- **结论：正确。**\n\n**B. 对于基准 1，在 $x=-L$ 处的到达时间为 $t^* = 2L/c \\approx 0.002915$ (秒)，并且观察到完全跳跃 $p(-L,t^*+) = p_0 = 1.0$，同时 $u(-L,t^*+) = +\\dfrac{p_0}{\\rho_0 c}$ (米/秒)。验证基于压力 $p$ 的 $L^2$ 范数在空间上的守恒。对于基准 2，振幅按 $1/r^2$ 衰减，峰值到达时间为 $t_{R_1} = R_1/c$ 和 $t_{R_2} = R_2/c$，且 $p_{\\max}(R_2)/p_{\\max}(R_1) = (R_1/R_2)^2 = 0.25$。**\n- 基准 1：到达时间不正确（应为 $L/c$，而非 $2L/c$）。压力跳跃不正确（应为 $p_0/2$，而非 $p_0$）。速度的大小和符号都不正确。$p$ 的 $L^2$ 范数对于该系统不是守恒量。\n- 基准 2：振幅衰减定律不正确（应为 $1/r$，而非 $1/r^2$）。因此，峰值振幅比也不正确。\n- **结论：不正确。**\n\n**C. 对于基准 1，选择探头在 $x = +L$ 处，并预期首次到达时间为 $t^* = L/c \\approx 0.001458$ (秒)，此时 $p(+L,t^*+) = p_0/2 = 0.5$ 且 $u(+L,t^*+) = +\\dfrac{p_0}{2 \\rho_0 c}$ (米/秒)。验证使用 $p$ 的 $L^2$ 范数，并要求它在数值容差范围内不变。对于基准 2，半径 $R$ 处的振幅与 $R$ 无关，因此 $p_{\\max}(R_2)/p_{\\max}(R_1) = 1$，峰值在 $t_R = R/c$ 到达。**\n- 基准 1：该选项通过将探头移动到 $x=+L$ 修改了问题。虽然为这个新位置描述的物理现象大部分是正确的，但提议的验证指标（$p$ 的 $L^2$ 范数守恒）是不正确的。\n- 基准 2：振幅与 $R$ 无关的说法是不正确的；这描述的是平面波，而不是球面波，并且会违反能量守恒。\n- **结论：不正确。**\n\n**D. 对于基准 1，波速取决于初始跳跃的局部波数，因此由于色散，在 $x=-L$ 处的到达时间满足 $t^*  L/c$，并且到达后的平台值为 $p_0$，同时 $u=0$。对于基准 2，球面脉冲表现出扩散性展宽，因此振幅比 $1/r^2$ 衰减得更快，在半径 $R$ 处的峰值到达时间晚于 $R/c$，因此验证应侧重于匹配一个小于 $c$ 的频率相关群速度和 $L^2$ 范数的耗散衰减。**\n- 基准 1：这是不正确的。指定的模型方程是非色散的；所有频率都以速度 $c$ 传播。到达时间恰好是 $L/c$。到达后的状态也是不正确的。\n- 基准 2：这是不正确的。波动方程是双曲型的，不是抛物型的，因此它表现为传播，而不是扩散。所描述的现象（扩散性展宽、到达时间晚于 $R/c$、耗散）是不同物理模型（例如，粘性或导热流体）的特征。\n- **结论：不正确。**\n\n基于详细分析，选项 A 是唯一一个为两个基准问题提供了物理上和数学上都正确的验证标准的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "数值方法的理论精度（例如，二阶精度）必须通过经验验证来确认其实际性能。编码错误或不当的参数设置都可能导致求解器的实际收敛阶数达不到理论预期。本练习  要求您动手实现一个时域有限差分（FDTD）求解器，并进行系统的网格加密研究，以经验性地计算其收敛阶数，这是代码验证（Code Verification）流程中不可或缺的一步。",
            "id": "4149240",
            "problem": "您的任务是设计并实现一个数值实验，以经验性地确定和比较一个应用于一维线性声学问题的瞬态求解器在时间和空间上的收敛率。其控制方程源于可压缩介质中小扰动的质量守恒和动量守恒，是一个由以下耦合方程给出的一阶系统：\n$$\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0,$$\n$$\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0,$$\n其中 $p$ 是声压，单位为帕斯卡（$\\mathrm{Pa}$）；$u$ 是质点速度，单位为米/秒（$\\mathrm{m/s}$）；$K$ 是体积模量，单位为帕斯卡（$\\mathrm{Pa}$）；$\\rho$ 是质量密度，单位为千克/立方米（$\\mathrm{kg/m^3}$）；$x$ 表示一维空间坐标，单位为米（$\\mathrm{m}$）。波速为 $c = \\sqrt{K/\\rho}$，单位为米/秒（$\\mathrm{m/s}$）。\n\n考虑空间域 $x \\in [0, L]$，其中 $L = 1$ $\\mathrm{m}$，并采用周期性边界条件。使用以下初始条件：\n$$p(x,0) = \\sin(2\\pi x) \\ \\mathrm{Pa}, \\quad u(x,0) = 0 \\ \\mathrm{m/s},$$\n其中角度的单位为弧度。对于这些数据，上述系统在时间 $t$ 的精确解为：\n$$p_{\\text{exact}}(x,t) = \\sin(2\\pi x)\\cos(2\\pi c t),$$\n$$u_{\\text{exact}}(x,t) = -\\frac{c}{K}\\cos(2\\pi x)\\sin(2\\pi c t).$$\n\n您必须实现一个二阶精度的显式瞬态求解器，该求解器在周期性边界条件下，使用空间中心差分和时间交错蛙跳格式来对上述一阶系统进行积分。设空间网格有 $N_x$ 个点，均匀间距为 $\\Delta x = L/N_x$。对空间导数使用中心差分近似，并交错时间积分，使得 $u$ 在半个时间层级上推进，$p$ 在整数时间层级上推进。请确保时间步长 $\\Delta t$ 满足与用于类对流双曲系统的显式二阶中心格式相一致的 Courant-Friedrichs-Lewy (CFL) 稳定性限制，并通过量化经验精度来进行设计，而不是依赖任何稳定性捷径公式；求解器必须仅依赖于基本定义和广泛接受的数值离散化原则。\n\n对于每次运行，计算声压 $p(x,t)$ 的解，直到指定的最终时间 $T$，并根据精确解评估离散 $L^2$ 范数误差，\n$$E = \\left( \\Delta x \\sum_{i=0}^{N_x-1} \\left[p_i(T) - p_{\\text{exact}}(x_i,T)\\right]^2 \\right)^{1/2},$$\n其中 $x_i = i \\Delta x$，$p_i(T)$ 表示节点 $i$ 在时间 $T$ 的数值压力。两次运行的经验收敛阶 (EOC) 由特征步长 $h_1$ 和 $h_2$ 及相应的误差 $E_1$ 和 $E_2$ 计算得出，公式如下：\n$$\\mathrm{EOC} = \\frac{\\log(E_1/E_2)}{\\log(h_1/h_2)}.$$\n当在时间上加密时，取 $h = \\Delta t$。当在空间上加密时，取 $h = \\Delta x$。\n\n您的程序必须通过系统性的网格加密来计算时间和空间加密的经验收敛率，并将观察到的阶数与理论预测的 $2$ 阶进行比较。使用以下物理参数：$\\rho = 1.2$ $\\mathrm{kg/m^3}$，$K = 142000$ $\\mathrm{Pa}$，这意味着 $c = \\sqrt{K/\\rho}$，单位为 $\\mathrm{m/s}$。\n\n为确保覆盖范围，请实现四个测试用例：\n- 测试用例 1（时间加密，理想情况）：$N_x = 1024$，$\\Delta t \\in \\{1.5\\times 10^{-6}, 7.5\\times 10^{-7}, 3.75\\times 10^{-7}\\}$ $\\mathrm{s}$，以及 $T = 3.0\\times 10^{-5}$ $\\mathrm{s}$。计算 $\\Delta t$ 连续加密的误差和 EOC 值，然后报告两个连续对的平均 EOC，以及一个布尔值，该值指示平均 EOC 是否在理论阶数 $2$ 的 $\\pm 0.2$ 范围内。\n- 测试用例 2（时间加密，接近稳定性边界）：$N_x = 256$，设置 $\\Delta t$ 为 $\\{0.98, 0.49, 0.245\\}\\times \\Delta x / c$ $\\mathrm{s}$，以及 $T = 3.0\\times 10^{-4}$ $\\mathrm{s}$。计算误差、连续 EOC、平均 EOC，以及一个表示通过/失败的布尔值，其容差与之前相同，为 $2 \\pm 0.2$。\n- 测试用例 3（空间加密，理想情况）：$N_x \\in \\{64, 128, 256\\}$，其中 $\\Delta t$ 选择为 $\\Delta t = \\sigma \\Delta x^2 / c$ $\\mathrm{s}$，使用 $\\sigma = 0.3$（无量纲），以及 $T = 2.0\\times 10^{-5}$ $\\mathrm{s}$。计算误差、使用 $h=\\Delta x$ 的连续 EOC、平均 EOC，以及一个表示通过/失败的布尔值，其容差与之前相同，为 $2 \\pm 0.2$。\n- 测试用例 4（空间加密，粗网格情况）：$N_x \\in \\{16, 32, 64\\}$，其中 $\\Delta t = \\sigma \\Delta x^2 / c$ 与测试用例 3 相同，以及 $T = 2.0\\times 10^{-5}$ $\\mathrm{s}$。计算误差、使用 $h=\\Delta x$ 的连续 EOC、平均 EOC，以及一个表示通过/失败的布尔值，其容差与之前相同，为 $2 \\pm 0.2$。\n\n三角函数中的所有角度都必须解释为弧度。时间值单位必须为秒（$\\mathrm{s}$），长度单位必须为米（$\\mathrm{m}$），如上所述。您输出的量（EOC 值和布尔值）是无量纲的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，具体格式如下：\n$$[\\text{EOC}_1, \\text{pass}_1, \\text{EOC}_2, \\text{pass}_2, \\text{EOC}_3, \\text{pass}_3, \\text{EOC}_4, \\text{pass}_4],$$\n其中 $\\text{EOC}_k$ 是测试用例 $k$ 的平均经验收敛阶，$\\text{pass}_k$ 是一个布尔值，指示测试用例 $k$ 的平均 EOC 是否在容差区间 $[2-0.2, 2+0.2]$ 内。",
            "solution": "该问题是有效的，因为它提出了一个计算声学领域中适定的、有科学依据的任务，该任务是完整的、一致的，并且需要非平凡的数值求解和分析。所有提供的数据、方程和条件都是标准的且可验证的。\n\n该解决方案涉及为一维线性声学方程实现一个时域有限差分 (FDTD) 求解器，并进行经验性收敛研究。其方法论分步详述如下。\n\n**1. 控制方程与离散化**\n\n问题由以下一阶线性声学系统控制：\n$$ \\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0 $$\n$$ \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0 $$\n其中 $p$ 是声压，$u$ 是质点速度，$K$ 是体积模量，$\\rho$ 是质量密度。空间域为 $x \\in [0, L]$，其中 $L=1$ m，我们施加周期性边界条件。\n\n我们将空间域离散为 $N_x$ 个点 $x_i = i \\Delta x$，其中 $i = 0, 1, \\dots, N_x-1$，$\\Delta x = L/N_x$。时间以 $\\Delta t$ 为步长进行离散。采用交错蛙跳格式，其中压力 $p_i^n$ 在整数时间步 $t^n = n \\Delta t$ 进行计算，而速度 $u_i^{n+1/2}$ 在半整数时间步 $t^{n+1/2} = (n+1/2) \\Delta t$ 进行计算。\n\n空间导数使用二阶精度的中心差分格式近似：\n$$ \\frac{\\partial f}{\\partial x}\\bigg|_{x_i} \\approx \\frac{f_{i+1} - f_{i-1}}{2 \\Delta x} $$\n时间导数使用二阶中心差分（蛙跳）方法近似：\n$$ \\frac{\\partial p}{\\partial t}\\bigg|_{(x_i, t^{n+1/2})} \\approx \\frac{p_i^{n+1} - p_i^n}{\\Delta t} $$\n$$ \\frac{\\partial u}{\\partial t}\\bigg|_{(x_i, t^{n})} \\approx \\frac{u_i^{n+1/2} - u_i^{n-1/2}}{\\Delta t} $$\n\n**2. 数值格式：交错蛙跳 (FDTD)**\n\n将离散近似代入控制方程，得到显式更新规则。$\\partial p / \\partial t$ 方程在时间 $t^{n+1/2}$ 处中心化，而 $\\partial u / \\partial t$ 方程在时间 $t^n$ 处中心化。这与标准的 Yee 交错网格在记法上略有不符，但最终的数值格式是相同且正确的。一个更一致的中心化方式是：\n$$ \\frac{p_i^{n+1} - p_i^n}{\\Delta t} = -K \\frac{u_{i+1}^{n+1/2} - u_{i-1}^{n+1/2}}{2 \\Delta x} $$\n$$ \\frac{u_i^{n+1/2} - u_i^{n-1/2}}{\\Delta t} = -\\frac{1}{\\rho} \\frac{p_{i+1}^n - p_{i-1}^n}{2 \\Delta x} $$\n整理这些方程，得到求解器的显式更新方程：\n1. 速度 $u$ 的更新：\n$$ u_i^{n+1/2} = u_i^{n-1/2} - \\frac{\\Delta t}{\\rho (2 \\Delta x)} (p_{i+1}^n - p_{i-1}^n) $$\n2. 压力 $p$ 的更新：\n$$ p_i^{n+1} = p_i^n - K \\frac{\\Delta t}{2 \\Delta x} (u_{i+1}^{n+1/2} - u_{i-1}^{n+1/2}) $$\n该格式在时间和空间上均为二阶精度，$O(\\Delta t^2, \\Delta x^2)$。\n\n**3. 格式初始化**\n\n模拟从 $t=0$ 开始，给定初始条件 $p(x,0)$ 和 $u(x,0)$。我们设置 $p_i^0 = \\sin(2\\pi x_i)$ 和 $u_i^0 = 0$。蛙跳格式需要半个时间步长的 $u$ 才能开始。为了求得 $u_i^{1/2}$，我们对 $u$ 从 $t=0$ 到 $t=\\Delta t/2$ 执行一个单步前向欧拉半步更新：\n$$ u_i^{1/2} = u_i^0 - \\frac{\\Delta t/2}{\\rho} \\left(\\frac{\\partial p}{\\partial x}\\right)_i^0 \\approx u_i^0 - \\frac{\\Delta t/2}{\\rho} \\frac{p_{i+1}^0 - p_{i-1}^0}{2\\Delta x} $$\n由于 $u_i^0=0$，该式简化为：\n$$ u_i^{1/2} = - \\frac{\\Delta t}{4 \\rho \\Delta x} (p_{i+1}^0 - p_{i-1}^0) $$\n这个“启动”步骤的局部截断误差为 $O(\\Delta t^2)$，这与主蛙跳算法的全局二阶精度一致，不会降低整体的收敛率。\n\n**4. 边界条件**\n\n周期性边界条件 $f(0,t) = f(L,t)$ 的实现方式是：对于网格点 $i=0$，其 $i-1$ 的邻居是 $N_x-1$；对于网格点 $i=N_x-1$，其 $i+1$ 的邻居是 $0$。在基于向量的实现中，这可以通过使用 `numpy.roll` 对表示场 $p$ 和 $u$ 的数组执行循环移位来高效处理。\n\n**5. 误差分析与经验收敛阶 (EOC)**\n\n数值解运行至最终时间 $T_{final}$。最终时间由 $T_{final} = N_t \\Delta t$ 确定，其中 $N_t = \\lceil T/\\Delta t \\rceil$ 以确保模拟时间至少达到目标时间 $T$。数值压力 $p_i(T_{final})$ 的精度通过与精确解 $p_{\\text{exact}}(x_i, T_{final})$ 比较，使用离散 $L^2$ 范数来衡量：\n$$ E = \\left( \\Delta x \\sum_{i=0}^{N_x-1} \\left[p_i(T_{final}) - p_{\\text{exact}}(x_i, T_{final})\\right]^2 \\right)^{1/2} $$\n经验收敛阶 (EOC) 由两次运行的特征步长 $h_1$ 和 $h_2$（其中 $h$ 可以是 $\\Delta t$ 或 $\\Delta x$）及相应的误差 $E_1$ 和 $E_2$ 计算得出：\n$$ \\mathrm{EOC} = \\frac{\\log(E_1/E_2)}{\\log(h_1/h_2)} $$\n对于 $h_2=h_1/2$ 的加密情况，该式简化为 $\\mathrm{EOC} = \\log_2(E_1/E_2)$。\n\n**6. 收敛性研究设计**\n\n四个测试用例旨在验证该格式在时间和空间上的理论二阶收敛性。\n- **时间加密（用例 1 和 2）**：空间分辨率 $N_x$ 保持不变，同时对时间步长 $\\Delta t$ 进行系统性加密。预计误差将由时间离散化主导，关于 $\\Delta t$ 的 EOC 应约等于 $2$。用例 1 使用精细的空间网格和小的 Courant 数，代表了理想情况。用例 2 探究了接近稳定性极限（Courant 数 $\\approx 1$）时的行为。\n- **空间加密（用例 3 和 4）**：对空间分辨率 $N_x$ 进行加密，且时间步长 $\\Delta t$ 通过 $\\Delta t = \\sigma \\Delta x^2 / c$ 与空间步长耦合。总误差的形式为 $O(\\Delta t^2, \\Delta x^2) = O((\\Delta x^2)^2, \\Delta x^2) = O(\\Delta x^4, \\Delta x^2)$。随着 $\\Delta x$ 减小，$O(\\Delta x^2)$ 项占主导地位。这种设计有效地分离出了空间收敛率，其预期值约等于 $2$。用例 3 使用相对精细的网格，而用例 4 使用粗网格，在粗网格上，前渐近效应可能会降低观察到的 EOC。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_solver(Nx, dt, T, L, K, rho, c):\n    \"\"\"\n    Solves the 1D linear acoustic equations using a second-order FDTD scheme.\n\n    Args:\n        Nx (int): Number of spatial grid points.\n        dt (float): Time step size.\n        T (float): Target final time.\n        L (float): Length of the spatial domain.\n        K (float): Bulk modulus.\n        rho (float): Mass density.\n        c (float): Wave speed.\n\n    Returns:\n        float: The L2-norm of the error in pressure at the final time.\n    \"\"\"\n    # Discretization parameters\n    dx = L / Nx\n    x = np.linspace(0, L, Nx, endpoint=False)\n    \n    # Adjust final time to be an integer multiple of dt\n    Nt = int(np.ceil(T / dt))\n    T_final = Nt * dt\n    \n    # Initialize fields based on initial conditions\n    # p is at t=0\n    p = np.sin(2 * np.pi * x)\n    # u is at t=0\n    u_full = np.zeros(Nx) # represents u at integer time steps for kick-start\n    \n    # Kick-start: advance u to the first half-time step (t=dt/2)\n    # This uses a first-order forward Euler step over dt/2, but it is equivalent to\n    # a second-order method for the leapfrog scheme initialization.\n    dpdx_0 = (np.roll(p, -1) - np.roll(p, 1)) / (2 * dx)\n    u_half = u_full - (dt / 2.0) / rho * dpdx_0\n    \n    # Main leapfrog time-stepping loop\n    # In loop 'n', p goes from t=n*dt to t=(n+1)*dt\n    # and u goes from t=n*dt+dt/2 to t=(n+1)*dt+dt/2\n    current_p = p\n    for _ in range(Nt):\n        # Update velocity u using p at the previous full-step to get next half-step\n        dpdx_full = (np.roll(current_p, -1) - np.roll(current_p, 1)) / (2 * dx)\n        u_next_half = u_half - dt / rho * dpdx_full\n\n        # Update pressure p using u at the current half-step to get next full-step\n        dudx_half = (np.roll(u_half, -1) - np.roll(u_half, 1)) / (2 * dx)\n        current_p = current_p - K * dt * dudx_half\n        \n        # Advance u for the next iteration\n        u_half = u_next_half\n        \n\n    # After the loop, p is evaluated at T_final\n    p_final = current_p\n    # Compute the exact solution for pressure at the final time\n    p_exact = np.sin(2 * np.pi * x) * np.cos(2 * np.pi * c * T_final)\n    \n    # Compute the discrete L2-norm of the error\n    error = np.sqrt(dx * np.sum((p_final - p_exact)**2))\n    \n    return error\n\ndef calculate_eoc(errors, h_steps):\n    \"\"\"Calculates the average EOC from a series of errors and step sizes.\"\"\"\n    eoc1 = np.log(errors[0] / errors[1]) / np.log(h_steps[0] / h_steps[1])\n    eoc2 = np.log(errors[1] / errors[2]) / np.log(h_steps[1] / h_steps[2])\n    avg_eoc = (eoc1 + eoc2) / 2.0\n    return avg_eoc\n\ndef solve():\n    \"\"\"\n    Main function to run the four test cases for the convergence study.\n    \"\"\"\n    # Define physical parameters\n    rho = 1.2\n    K = 142000.0\n    L = 1.0\n    c = np.sqrt(K / rho)\n    \n    all_results = []\n\n    # --- Test Case 1: Time refinement, happy path ---\n    Nx_1 = 1024\n    dts_1 = [1.5e-6, 7.5e-7, 3.75e-7]\n    T_1 = 3.0e-5\n    errors_1 = [run_solver(Nx_1, dt, T_1, L, K, rho, c) for dt in dts_1]\n    eoc_avg_1 = calculate_eoc(errors_1, dts_1)\n    pass_1 = 1.8 = eoc_avg_1 = 2.2\n    all_results.extend([eoc_avg_1, pass_1])\n\n    # --- Test Case 2: Time refinement near stability boundary ---\n    Nx_2 = 256\n    dx_2 = L / Nx_2\n    cfl_factors = [0.98, 0.49, 0.245]\n    dts_2 = [f * dx_2 / c for f in cfl_factors]\n    T_2 = 3.0e-4\n    errors_2 = [run_solver(Nx_2, dt, T_2, L, K, rho, c) for dt in dts_2]\n    eoc_avg_2 = calculate_eoc(errors_2, dts_2)\n    pass_2 = 1.8 = eoc_avg_2 = 2.2\n    all_results.extend([eoc_avg_2, pass_2])\n\n    # --- Test Case 3: Space refinement, happy path ---\n    Nxs_3 = [64, 128, 256]\n    sigma_3 = 0.3\n    T_3 = 2.0e-5\n    errors_3 = []\n    dxs_3 = []\n    for nx_val in Nxs_3:\n        dx_val = L / nx_val\n        dt_val = sigma_3 * dx_val**2 / c\n        errors_3.append(run_solver(nx_val, dt_val, T_3, L, K, rho, c))\n        dxs_3.append(dx_val)\n    eoc_avg_3 = calculate_eoc(errors_3, dxs_3)\n    pass_3 = 1.8 = eoc_avg_3 = 2.2\n    all_results.extend([eoc_avg_3, pass_3])\n    \n    # --- Test Case 4: Space refinement, coarse-grid boundary ---\n    Nxs_4 = [16, 32, 64]\n    sigma_4 = 0.3\n    T_4 = 2.0e-5\n    errors_4 = []\n    dxs_4 = []\n    for nx_val in Nxs_4:\n        dx_val = L / nx_val\n        dt_val = sigma_4 * dx_val**2 / c\n        errors_4.append(run_solver(nx_val, dt_val, T_4, L, K, rho, c))\n        dxs_4.append(dx_val)\n    eoc_avg_4 = calculate_eoc(errors_4, dxs_4)\n    pass_4 = 1.8 = eoc_avg_4 = 2.2\n    all_results.extend([eoc_avg_4, pass_4])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "理想的数值仿真应只包含物理上真实的波现象，但离散化过程常常会引入虚假的高频振荡，从而污染结果。本练习  探讨了一种常见的稳定化技术——人工粘性，它能选择性地衰减这些非物理的瞬态波。您的任务是分析其工作机理，并推导出一个标准，以在有效抑制数值噪声和保持物理波形保真度之间取得最佳平衡。",
            "id": "4149248",
            "problem": "考虑一维线性化声压波方程，该方程是在密度和声速恒定的均匀介质中，由小扰动下的线性化动量和连续性方程导出的，其形式为 $p_{tt} - c^{2} p_{xx} = 0$，其中 $p(x,t)$ 是压力，$c$ 是声速，下标表示偏导数。在计算声学中，当在网格上离散化此方程时，数值色散和混叠可能会引起高频伪瞬态。一种常见的稳定化方法是在右侧添加人工粘性项 $\\nu\\, p_{xxt}$，得到 $p_{tt} - c^{2} p_{xx} = \\nu\\, p_{xxt}$，其中 $\\nu$ 是一个量纲为 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 的正常数。另一种方法是在傅里叶空间中进行显式滤波，以在每个时间步衰减高波数分量。这两种方法都旨在抑制伪高频内容，同时对感兴趣的物理频带的干扰最小化。\n\n从波动力学和模态（傅里叶）分析的第一性原理出发，解释人工粘性或滤波选择性地阻尼高波数模式的机理。然后，推导一个准则，确保在时间 $T$ 时，感兴趣的物理频带上的相对振幅衰减被一个指定的阈值所下界，而伪频带则被衰减到指定的水平以下。具体而言，设物理频带由波数 $|k| \\leq k_{p}$ 定义，其中对于最大物理频率 $f_{p}$，$k_{p} = 2\\pi f_{p}/c$；设伪频带由 $|k| \\geq k_{s}$ 表征，其中在间距为 $\\Delta x$ 的均匀网格上，$k_{s}$ 可近似为数值奈奎斯特波数 $k_{s} = \\pi/\\Delta x$。设物理频带在时间 $T$ 后的可接受相对振幅损失不超过 $\\varepsilon$（因此振幅必须保持为其初始值的至少 $1 - \\varepsilon$），而伪频带所需的衰减因子至多为 $r$（因此振幅必须减小到其初始值的 $r$ 或更少）。\n\n对于以下科学上符合实际的参数，计算在时间 $T$ 满足这两个约束的最小人工粘性系数 $\\nu$：\n- 声速 $c = 1500\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- 网格间距 $\\Delta x = 0.1\\,\\mathrm{m}$，\n- 最大物理频率 $f_{p} = 1000\\,\\mathrm{Hz}$，\n- 时间范围 $T = 0.020\\,\\mathrm{s}$，\n- 物理频带容差 $\\varepsilon = 0.010$，\n- 伪频带衰减目标 $r = 0.600$。\n\n以 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 为单位表示最终的 $\\nu$，并将您的答案四舍五入到四位有效数字。您的推导应从控制方程开始，使用模态分析获得依赖于波数的衰减，由此您将构建联系 $\\nu$、$k_{p}$、$k_{s}$、$\\varepsilon$、$r$ 和 $T$ 的准则，然后根据给定参数计算所需的 $\\nu$ 值。最终答案必须是一个实数值。",
            "solution": "问题要求解释在一维声波方程背景下人工粘性的选择性阻尼机理，并推导满足物理频带和伪频带特定衰减标准的最小粘性系数 $\\nu$。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n- **含人工粘性的控制方程**：$p_{tt} - c^{2} p_{xx} = \\nu\\, p_{xxt}$，其中 $p(x,t)$ 是压力，$c$ 是声速，$\\nu$ 是人工粘性系数。\n- **物理频带波数**：$|k| \\leq k_{p}$，其中 $k_{p} = \\frac{2\\pi f_{p}}{c}$。\n- **伪频带波数**：$|k| \\geq k_{s}$，其中 $k_{s} = \\frac{\\pi}{\\Delta x}$。\n- **物理频带约束**：相对振幅损失不超过 $\\varepsilon$，意味着在时间 $T$ 时的最终振幅必须至少为初始振幅的 $1 - \\varepsilon$ 倍。\n- **伪频带约束**：衰减因子至多为 $r$，意味着在时间 $T$ 时的最终振幅必须不大于初始振幅的 $r$ 倍。\n- **参数**:\n  - 声速：$c = 1500\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n  - 网格间距：$\\Delta x = 0.1\\,\\mathrm{m}$\n  - 最大物理频率：$f_{p} = 1000\\,\\mathrm{Hz}$\n  - 时间范围：$T = 0.020\\,\\mathrm{s}$\n  - 物理频带容差：$\\varepsilon = 0.010$\n  - 伪频带衰减目标：$r = 0.600$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：这个问题在科学上是合理的。线性化声波方程是一个基本模型。添加 $p_{xxt}$ 项是为双曲型偏微分方程的数值格式引入人工粘性以进行稳定化的一种标准且被广泛理解的方法。通过傅里叶模态进行分析是研究此类方程色散和耗散特性的正确且标准的方法。\n- **适定性**：问题是适定的。它对单个参数 $\\nu$ 提供了两个不等式约束，并要求求出满足这些约束的最小值。这是一个定义明确的优化问题。提供了所有必要的数据。\n- **客观性**：问题以精确、客观和定量的术语陈述。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学依据、适定性、客观性，并包含一套完整且一致的数据和约束。我将继续进行完整求解。\n\n### 解题推导\n\n控制方程是带有人工粘性项修正的一维声波方程：\n$$p_{tt} - c^{2} p_{xx} = \\nu p_{xxt}$$\n为分析不同频率分量的行为，我们进行模态分析。我们寻求如下形式的平面波解：\n$$p(x,t) = \\hat{p}(k) \\exp(i(kx - \\omega t))$$\n其中 $k$ 是实值波数，$\\omega$ 是可能为复值的角频率。$\\omega$ 的虚部将描述振幅随时间的衰减或增长。\n\n我们计算此解形式的偏导数：\n- $p_{tt} = (-i\\omega)^{2} p = -\\omega^{2} p$\n- $p_{xx} = (ik)^{2} p = -k^{2} p$\n- $p_{xxt} = (ik)^{2}(-i\\omega) p = i\\omega k^{2} p$\n\n将这些代入控制方程，得到特征方程，也称为色散关系：\n$$-\\omega^{2} p - c^{2}(-k^{2} p) = \\nu (i\\omega k^{2} p)$$\n除以 $p$（对于非平凡解，$p$ 不为零），我们得到：\n$$-\\omega^{2} + c^{2} k^{2} = i\\nu\\omega k^{2}$$\n这可以重排为关于 $\\omega$ 的二次方程：\n$$\\omega^{2} + (i\\nu k^{2})\\omega - c^{2} k^{2} = 0$$\n我们使用二次公式求解 $\\omega$：\n$$\\omega = \\frac{-i\\nu k^{2} \\pm \\sqrt{(i\\nu k^{2})^{2} - 4(1)(-c^{2} k^{2})}}{2} = \\frac{-i\\nu k^{2} \\pm \\sqrt{-\\nu^{2} k^{4} + 4c^{2} k^{2}}}{2}$$\n$$\\omega = \\frac{-i\\nu k^{2} \\pm |k|\\sqrt{4c^{2} - \\nu^{2} k^{2}}}{2}$$\n我们可以将 $\\omega$ 分解为实部和虚部，$\\omega = \\omega_{R} + i\\omega_{I}$。\n$$\\omega_{R} = \\pm \\frac{|k|}{2}\\sqrt{4c^{2} - \\nu^{2} k^{2}}$$\n$$\\omega_{I} = -\\frac{\\nu k^{2}}{2}$$\n对于给定的模态 $k$，解为 $p_k(x,t) = \\hat{p}(k) \\exp(i(kx - \\omega_R t)) \\exp(\\omega_I t)$。该模态的振幅随时间演变为 $A(t) = A(0) \\exp(\\omega_I t) = A(0) \\exp\\left(-\\frac{\\nu k^{2}}{2} t\\right)$。\n\n**选择性阻尼机理：**\n阻尼由项 $\\exp(-\\frac{\\nu k^{2}}{2} t)$ 控制。由于 $\\nu  0$，每个模态的振幅都随时间减小。关键的观察是，衰减率由指数 $-\\frac{\\nu k^{2} t}{2}$ 给出，它与 $k^{2}$ 成正比。这意味着具有高波数（大 $|k|$）的模态——它们对应于高空间频率，并且通常作为伪数值伪影出现——比具有低波数（小 $|k|$）的模态——它们代表波的物理、大尺度特征——被更强烈地阻尼。这就是人工粘性选择性地抑制高频数值噪声的机理。\n\n**$\\nu$ 准则的推导：**\n经过时间 $T$ 后，波数为 $k$ 的模态的相对振幅是：\n$$A_{rel}(k, T) = \\frac{A(T)}{A(0)} = \\exp\\left(-\\frac{\\nu k^{2} T}{2}\\right)$$\n\n**约束1：物理频带 ($|k| \\leq k_{p}$)**\n振幅损失不得超过 $\\varepsilon$，因此相对振幅必须至少为 $1-\\varepsilon$。在此频带的上边缘 $|k|=k_{p}$ 处，阻尼最强。为了满足整个频带的约束，我们必须在这个最坏情况点满足它：\n$$A_{rel}(k_p, T) = \\exp\\left(-\\frac{\\nu k_{p}^{2} T}{2}\\right) \\geq 1 - \\varepsilon$$\n对两边取自然对数：\n$$-\\frac{\\nu k_{p}^{2} T}{2} \\geq \\ln(1 - \\varepsilon)$$\n乘以 $-1$ 会反转不等号：\n$$\\frac{\\nu k_{p}^{2} T}{2} \\leq -\\ln(1 - \\varepsilon) = \\ln\\left(\\frac{1}{1 - \\varepsilon}\\right)$$\n这给出了 $\\nu$ 的一个上界：\n$$\\nu \\leq \\frac{2}{k_{p}^{2} T} \\ln\\left(\\frac{1}{1 - \\varepsilon}\\right)$$\n\n**约束2：伪频带 ($|k| \\geq k_{s}$)**\n振幅必须衰减到至多为因子 $r$。在此频带的下边缘 $|k|=k_{s}$ 处，阻尼最弱。为确保所有伪模态都得到充分衰减，我们必须在这个阻尼最弱的点满足约束：\n$$A_{rel}(k_s, T) = \\exp\\left(-\\frac{\\nu k_{s}^{2} T}{2}\\right) \\leq r$$\n取自然对数：\n$$-\\frac{\\nu k_{s}^{2} T}{2} \\leq \\ln(r)$$\n$$\\frac{\\nu k_{s}^{2} T}{2} \\geq -\\ln(r) = \\ln\\left(\\frac{1}{r}\\right)$$\n这给出了 $\\nu$ 的一个下界：\n$$\\nu \\geq \\frac{2}{k_{s}^{2} T} \\ln\\left(\\frac{1}{r}\\right)$$\n\n**最小 $\\nu$ 的计算：**\n我们需要一个满足两个推导出的不等式的 $\\nu$ 值。为了找到这样的最小 $\\nu$，我们必须选择满足第二个约束的最小可能值，即下界本身。如果这个选择不违反第一个约束，那么它是有效的。\n因此，最小粘性系数为：\n$$\\nu_{min} = \\frac{2}{k_{s}^{2} T} \\ln\\left(\\frac{1}{r}\\right)$$\n\n现在，我们代入给定的数值参数。\n首先，计算波数 $k_{p}$ 和 $k_{s}$：\n$$k_{p} = \\frac{2\\pi f_{p}}{c} = \\frac{2\\pi (1000)}{1500} = \\frac{4\\pi}{3}\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$$\n$$k_{s} = \\frac{\\pi}{\\Delta x} = \\frac{\\pi}{0.1} = 10\\pi\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$$\n\n现在，使用 $k_{s} = 10\\pi$，$T = 0.020$ 和 $r = 0.600$ 计算 $\\nu_{min}$：\n$$\\nu_{min} = \\frac{2}{(10\\pi)^{2} (0.020)} \\ln\\left(\\frac{1}{0.600}\\right) = \\frac{2}{100\\pi^{2} (0.020)} \\ln\\left(\\frac{1}{0.6}\\right) = \\frac{1}{\\pi^{2}} \\ln\\left(\\frac{5}{3}\\right)$$\n数值计算：\n$$\\ln\\left(\\frac{5}{3}\\right) \\approx 0.51082562376$$\n$$\\pi^{2} \\approx 9.8696044011$$\n$$\\nu_{min} \\approx \\frac{0.51082562}{9.8696044} \\approx 0.05175743\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$$\n我们必须验证这个最小的 $\\nu$ 也满足物理频带的约束：\n$\\nu \\leq \\frac{2}{k_{p}^{2} T} \\ln\\left(\\frac{1}{1 - \\varepsilon}\\right)$。让我们计算这个上界 $\\nu_{max}$：\n$$\\nu_{max} = \\frac{2}{\\left(\\frac{4\\pi}{3}\\right)^{2} (0.020)} \\ln\\left(\\frac{1}{1 - 0.010}\\right) = \\frac{2}{\\frac{16\\pi^{2}}{9} (0.020)} \\ln\\left(\\frac{1}{0.99}\\right) = \\frac{18}{0.32\\pi^{2}} \\ln\\left(\\frac{1}{0.99}\\right)$$\n数值计算：\n$$\\ln\\left(\\frac{1}{0.99}\\right) \\approx 0.01005033585$$\n$$\\nu_{max} \\approx \\frac{18}{0.32\\pi^{2}} (0.01005033) \\approx \\frac{0.180906}{3.15827} \\approx 0.057280\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$$\n由于 $\\nu_{min} \\approx 0.051757$ 确实小于 $\\nu_{max} \\approx 0.057280$，因此存在一个有效的 $\\nu$ 范围，其最小值为 $\\nu_{min}$。\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$\\nu \\approx 0.05176\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$$\n用标准科学记数法表示为 $5.176 \\times 10^{-2}$。",
            "answer": "$$\\boxed{5.176 \\times 10^{-2}}$$"
        }
    ]
}