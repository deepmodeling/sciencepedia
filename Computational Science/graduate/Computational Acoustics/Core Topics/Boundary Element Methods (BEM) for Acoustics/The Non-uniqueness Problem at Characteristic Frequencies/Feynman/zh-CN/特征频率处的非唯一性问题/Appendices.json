{
    "hands_on_practices": [
        {
            "introduction": "要解决特征频率处的非唯一性问题，第一步是准确识别这些频率。本练习将通过一个二维圆盘这一典型几何模型，指导你从第一性原理出发，推导其内部亥姆霍兹问题的特征波数。通过这个过程，你将掌握如何将抽象的亥姆霍兹方程和边界条件，转化为涉及贝塞尔函数 (Bessel functions) 的具体数学条件，从而深刻理解特征频率的物理和数学起源。",
            "id": "4144474",
            "problem": "考虑平面上半径为 $a$ 的圆盘上的内部声学亥姆霍兹边界值问题。设 $p(r,\\theta)$ 在开圆盘 $\\{(r,\\theta) : 0 \\le r  a\\}$ 内满足偏微分方程 (PDE) $\\nabla^{2} p + k^{2} p = 0$，其中 $\\nabla^{2}$ 是极坐标下的二维拉普拉斯算子。在 $r=a$ 处考虑两种经典边界条件：声软（狄利克雷）边界条件 $p|_{r=a} = 0$ 和声硬（诺伊曼）边界条件 $\\frac{\\partial p}{\\partial r}\\big|_{r=a} = 0$。在计算声学中，当齐次内部问题存在非平凡解时，对应的特征波数 $k$ 会导致边界积分公式出现非唯一性问题。\n\n从偏微分方程和边界条件出发，通过在极坐标下使用分离变量法，从第一性原理推导狄利克雷和诺伊曼情况下的特征波数离散集。施加原点处的正则性条件，并根据与角向相关的方位角指数 $m \\in \\{0,1,2,\\dots\\}$ 确定每个特征波数的重数。设 $J_{m}(x)$ 表示 $m$ 阶第一类贝塞尔函数，$J_{m}'(x)$ 表示其对其宗量的导数。定义 $j_{m,n}$ 为 $J_{m}(x)$ 的第 $n$ 个正根，$j_{m,n}'$ 为 $J_{m}'(x)$ 的第 $n$ 个正根，其中 $n \\in \\{1,2,\\dots\\}$。\n\n将您的最终答案表示为三个解析表达式：狄利克雷特征波数 $k_{\\mathrm{D}}(m,n)$，诺伊曼特征波数 $k_{\\mathrm{N}}(m,n)$，以及每个特征波数的重数 $\\mu(m)$，形式为一个单行矩阵。不需要进行数值近似。",
            "solution": "该问题要求推导半径为 $a$ 的圆盘上内部声学亥姆霍兹问题的特征波数。控制偏微分方程 (PDE) 是亥姆霍兹方程，$\\nabla^{2} p + k^{2} p = 0$。\n\n在二维极坐标 $(r, \\theta)$ 中，拉普拉斯算子 $\\nabla^{2}$ 由 $\\nabla^{2} = \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\frac{\\partial}{\\partial r}) + \\frac{1}{r^{2}}\\frac{\\partial^{2}}{\\partial \\theta^{2}}$ 给出。因此，亥姆霍兹方程为：\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial p}{\\partial r}\\right) + \\frac{1}{r^{2}}\\frac{\\partial^{2} p}{\\partial \\theta^{2}} + k^{2} p = 0 $$\n我们寻求在圆盘 $0 \\le r  a$ 内满足此偏微分方程，并且在 $r=a$ 处满足特定边界条件的非平凡解 $p(r, \\theta)$。采用分离变量法。我们假设解的形式为 $p(r, \\theta) = R(r)\\Theta(\\theta)$。将其代入偏微分方程得到：\n$$ \\frac{\\Theta(\\theta)}{r}\\frac{d}{dr}\\left(r\\frac{dR}{dr}\\right) + \\frac{R(r)}{r^{2}}\\frac{d^{2}\\Theta}{d\\theta^{2}} + k^{2} R(r)\\Theta(\\theta) = 0 $$\n为了分离变量，我们乘以 $\\frac{r^{2}}{R(r)\\Theta(\\theta)}$：\n$$ \\frac{r}{R(r)}\\frac{d}{dr}\\left(r\\frac{dR}{dr}\\right) + k^{2}r^{2} = -\\frac{1}{\\Theta(\\theta)}\\frac{d^{2}\\Theta}{d\\theta^{2}} $$\n等式左边只依赖于 $r$，右边只依赖于 $\\theta$。为了让等式对所有的 $r$ 和 $\\theta$ 都成立，两边必须等于同一个常数，我们称之为 $\\lambda$。\n\n这给出了两个常微分方程：\n1. 角向方程：$\\frac{d^{2}\\Theta}{d\\theta^{2}} + \\lambda\\Theta = 0$\n2. 径向方程：$\\frac{r}{R}\\frac{d}{dr}(r\\frac{dR}{dr}) + k^{2}r^{2} = \\lambda$，可以重写为 $r^{2}\\frac{d^{2}R}{dr^{2}} + r\\frac{dR}{dr} + (k^{2}r^{2} - \\lambda)R = 0$。\n\n对于角向方程，问题的物理性质决定了解必须是关于 $\\theta$ 的周期函数，周期为 $2\\pi$，即 $\\Theta(\\theta + 2\\pi) = \\Theta(\\theta)$。这个条件要求分离常数 $\\lambda$ 是一个非负整数的平方，$\\lambda = m^{2}$，其中 $m \\in \\{0, 1, 2, \\dots\\}$。整数 $m$ 被称为方位角指数。$\\Theta(\\theta)$ 的通解是正弦函数的线性组合：\n$$ \\Theta(\\theta) = A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta) $$\n\n将 $\\lambda = m^{2}$ 代入径向方程得到：\n$$ r^{2}\\frac{d^{2}R}{dr^{2}} + r\\frac{dR}{dr} + (k^{2}r^{2} - m^{2})R = 0 $$\n这是贝塞尔微分方程。其通解是第一类贝塞尔函数 $J_{m}(kr)$ 和第二类贝塞尔函数 $Y_{m}(kr)$ 的线性组合：\n$$ R(r) = C_{m}J_{m}(kr) + D_{m}Y_{m}(kr) $$\n问题要求解在整个定义域内，包括原点 $r=0$ 在内，都是正则的（即有限的）。第二类贝塞尔函数 $Y_{m}(x)$ 在 $x=0$ 处是奇异的。因此，为了确保在圆盘中心有一个物理上有意义的、有限的压力场，我们必须设置系数 $D_{m}=0$。因此，径向解被限制为：\n$$ R(r) = C_{m}J_{m}(kr) $$\n\n解的单个模态的一般形式是 $p_{m}(r, \\theta) = J_{m}(kr) (A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta))$，其中常数 $C_m$ 已被吸收到 $A_m$ 和 $B_m$ 中。一个非平凡解（$p \\not\\equiv 0$）要求对于某个 $m$， $A_m$ 或 $B_m$ 中至少有一个不为零。特征波数 $k$ 是在给定的齐次边界条件下存在此类非平凡解的特定值。\n\n**1. 狄利克雷（声软）边界条件**\n边界条件为 $p(a, \\theta) = 0$。对于单个模态，这转化为：\n$$ J_{m}(ka) (A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta)) = 0 $$\n为了使该式对所有 $\\theta \\in [0, 2\\pi)$ 成立，并且 $A_m, B_m$ 中至少有一个不为零，我们必须有：\n$$ J_{m}(ka) = 0 $$\n设 $j_{m,n}$ 是贝塞尔函数 $J_m(x)$ 的第 $n$ 个正根，其中 $n \\in \\{1, 2, \\dots\\}$。条件 $J_m(ka)=0$ 意味着宗量 $ka$ 必须等于这些根中的一个。\n$$ ka = j_{m,n} $$\n这定义了狄利克雷问题的特征波数离散集：\n$$ k_{\\mathrm{D}}(m,n) = \\frac{j_{m,n}}{a} $$\n\n**2. 诺伊曼（声硬）边界条件**\n边界条件为 $\\frac{\\partial p}{\\partial r}\\big|_{r=a} = 0$。我们首先计算单个模态的径向导数：\n$$ \\frac{\\partial p_m}{\\partial r} = \\frac{d}{dr}[J_{m}(kr)] (A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta)) = k J_{m}'(kr) (A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta)) $$\n其中 $J_{m}'(x)$ 是 $J_m(x)$ 对其宗量 $x$ 的导数。在 $r=a$ 处求值并设为零得到：\n$$ k J_{m}'(ka) (A_{m}\\cos(m\\theta) + B_{m}\\sin(m\\theta)) = 0 $$\n对于非平凡解（$k \\neq 0$），我们必须有：\n$$ J_{m}'(ka) = 0 $$\n设 $j_{m,n}'$ 是导数 $J_m'(x)$ 的第 $n$ 个正根，其中 $n \\in \\{1, 2, \\dots\\}$。此条件意味着宗量 $ka$ 必须是这些根之一。注意，对于 $m \\ge 1$, $x=0$ 是 $J_m'(x)$ 的一个根，但这对应于 $k=0$ 的平凡情况，而根据 $j'_{m,n}$ 作为正根的定义，这种情况被排除了。对于 $m=0, J_0'(0)=0$，也是一个平凡情况。问题指定 $n \\in \\{1,2,\\dots\\}$ 为正根，所以我们只考虑 $k0$。\n$$ ka = j_{m,n}' $$\n这定义了诺伊曼问题的特征波数离散集：\n$$ k_{\\mathrm{N}}(m,n) = \\frac{j_{m,n}'}{a} $$\n\n**3. 特征波数的重数**\n一个特征波数的重数 $\\mu$ 是对应于该波数的线性无关特征函数（或模态）的数量。特征函数为 $p_{m,n}(r, \\theta) = J_m(k(m,n)r) \\Theta_m(\\theta)$。重数由角向函数 $\\Theta_m(\\theta)$ 的解空间的维度决定。我们假设没有偶然简并（即，对于 $(m,n) \\neq (m',n')$，有 $k(m,n) \\neq k(m',n')$）。\n- 对于 $m=0$ （径向对称模态）：角向解为 $\\Theta_0(\\theta) = A_0\\cos(0) + B_0\\sin(0) = A_0$，是一个常数。只有一个线性无关的角向函数（常数函数）。因此，对于每个波数 $k(0,n)$，只有一个特征函数。重数为 $\\mu(0) = 1$。\n- 对于 $m > 0$ （方位角模态）：角向解为 $\\Theta_m(\\theta) = A_m\\cos(m\\theta) + B_m\\sin(m\\theta)$。对于任何整数 $m \\ge 1$，函数 $\\cos(m\\theta)$ 和 $\\sin(m\\theta)$ 是线性无关的。这意味着对于每个 $m \\ge 1$ 的波数 $k(m,n)$，有两个线性无关的特征函数：一个与 $\\cos(m\\theta)$ 成比例，另一个与 $\\sin(m\\theta)$ 成比例。对于 $m \\in \\{1, 2, \\dots\\}$，重数为 $\\mu(m) = 2$。\n\n我们可以用克罗内克 δ 函数 $\\delta_{ij}$（当 $i=j$ 时为 $1$，否则为 $0$）将 $m \\in \\{0, 1, 2, \\dots\\}$ 的重数 $\\mu(m)$ 表示为一个单一表达式。\n$$ \\mu(m) = 2 - \\delta_{m0} $$\n\n所要求的三个表达式是 $k_{\\mathrm{D}}(m,n)$、$k_{\\mathrm{N}}(m,n)$ 和 $\\mu(m)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{j_{m,n}}{a}  \\frac{j_{m,n}'}{a}  2 - \\delta_{m0} \\end{pmatrix} } $$"
        },
        {
            "introduction": "CHIEF (组合亥姆霍兹积分方程公式) 方法是克服非唯一性问题的经典技术之一。该方法的有效性取决于正确识别问题频率所对应的简并度 (degeneracy)，即线性无关的特征函数的数量。本练习要求你计算一个声软球体在其前几个内部狄利克雷 (Dirichlet) 特征频率处所需的最小CHIEF点数，从而将球谐函数 (spherical harmonics) 的简并性与方法的实际应用直接联系起来。",
            "id": "4144467",
            "problem": "考虑一个半径为 $a$ 的软声球体嵌入在声速为 $c$ 的均匀介质中的外部声散射问题。外部的声压场 $p$ 满足亥姆霍兹方程 $$(\\nabla^{2} + k^{2})\\,p = 0$$ 以及在球体表面 $r=a$ 上的狄利克雷边界条件 $p=0$。众所周知，该问题的边界积分方程 (BIE) 公式在特征频率处会遇到非唯一性问题，即当波数 $k$ 与球体的内部狄利克雷本征频率重合时。组合亥姆霍兹积分方程公式 (CHIEF) 方法通过增加内部点约束来增强边界积分方程，以抑制非唯一性。\n\n从球坐标系下内部狄利克雷本征问题的分离变量解出发，确定按 $k$ 值递增排列的球体前四个内部狄利克雷本征频率处，每一个频率必须添加的最小 CHIEF 点数。此外，简要解释球谐函数的结构如何指导这些 CHIEF 点的空间选择，以使增加的约束能够消除与共振相关的零空间。\n\n您的最终答案必须是按 $k$ 值递增排列的前四个本征频率的最小 CHIEF 点数的序列，表示为单行矩阵。最终答案无需四舍五入，也无需物理单位。",
            "solution": "该问题的核心是确定球体内亥姆霍兹方程的前四个内部狄利克雷本征频率的简并度。这种简并度直接对应于在这些特征频率下 BIE 算子的零空间维度，而这又决定了恢复唯一解所需的最小 CHIEF 点数。\n\n半径为 $a$ 的球体内部的声场 $\\psi$ 满足亥姆霍兹方程和一个齐次狄利克雷边界条件：\n$$(\\nabla^{2} + k^{2})\\psi = 0 \\quad \\text{for } r  a$$\n$$\\psi = 0 \\quad \\text{for } r = a$$\n我们使用分离变量法在球坐标系 $(r, \\theta, \\phi)$ 中求解此本征值问题，解的形式为 $\\psi(r, \\theta, \\phi) = R(r)Y(\\theta, \\phi)$。角向部分 $Y(\\theta, \\phi)$ 产生球谐函数 $Y_n^m(\\theta, \\phi)$，它们是曲面拉普拉斯算子的本征函数。指数 $n$ 是一个非负整数 ($n=0, 1, 2, ...$)，指数 $m$ 是一个整数，满足 $-n \\le m \\le n$。径向部分 $R(r)$ 满足球贝塞尔微分方程：\n$$r^{2} \\frac{d^{2}R}{dr^{2}} + 2r \\frac{dR}{dr} + (k^{2}r^{2} - n(n+1))R = 0$$\n该方程的通解是第一类球贝塞尔函数 $j_n(kr)$ 和第二类球贝塞尔函数 $y_n(kr)$ 的线性组合。对于内部问题，解在原点 ($r=0$) 必须保持有限。由于 $y_n(kr)$ 在 $r=0$ 处是奇异的，我们必须舍弃它。因此，物理上可接受的解的形式为：\n$$\\psi_{nm}(r, \\theta, \\phi) = A_{nm} j_n(kr) Y_n^m(\\theta, \\phi)$$\n其中 $A_{nm}$ 是一个常数。\n\n在 $r=a$ 处的狄利克雷边界条件要求 $\\psi(a, \\theta, \\phi) = 0$。对于一个非平凡解 ($A_{nm} \\neq 0$)，这意味着：\n$$j_n(ka) = 0$$\n这是决定本征波数 $k$ 的特征方程。令 $z_{ns}$ 表示球贝塞尔函数 $j_n(z)$ 的第 $s$ 个正根，其中 $s=1, 2, 3, ...$。那么本征波数由 $k_{ns} = z_{ns}/a$ 给出。\n\n当外部问题的波数 $k$ 等于这些内部本征波数 $k_{ns}$ 之一时，BIE 公式就会出现非唯一性。由此产生的积分算子零空间由与此 $k_{ns}$ 对应的所有本征函数的集合所张成。该零空间的维度就是本征值的简并度。对于给定的整数 $n$，存在 $2n+1$ 个线性无关的球谐函数 $Y_n^m(\\theta, \\phi)$，对应于 $m = -n, -n+1, ..., n-1, n$。\n\n假设对于最小的几个根，给定 $n$ 的根 $z_{ns}$ 不会与 $n' \\neq n$ 的根 $z_{n's'}$ 重合，那么与 $k_{ns}$ 相关的本征频率的简并度恰好是 $2n+1$。CHIEF 方法需要增加等于此简并度的内部点约束数量，以使系统超定并消除零空间。因此，最小 CHIEF 点数为 $2n+1$。\n\n为了找到前四个本征频率，我们必须找到按大小递增排列的前四个根 $z_{ns}$。我们列出 $n=0, 1, 2, ...$ 的前几个根：\n- 对于 $n=0$：$j_0(z) = \\frac{\\sin(z)}{z}$。根为 $z_{0s} = s\\pi$。\n  - $z_{01} = \\pi \\approx 3.14159$\n  - $z_{02} = 2\\pi \\approx 6.28318$\n- 对于 $n=1$：$j_1(z) = \\frac{\\sin(z)}{z^2} - \\frac{\\cos(z)}{z}$。根是 $\\tan(z)=z$ 的解。\n  - $z_{11} \\approx 4.49341$\n- 对于 $n=2$：$j_2(z) = (\\frac{3}{z^2}-1)\\frac{\\sin(z)}{z} - \\frac{3\\cos(z)}{z^2}$。\n  - $z_{21} \\approx 5.76346$\n- 对于 $n=3$：\n  - $z_{31} \\approx 6.98793$\n\n将这些根按值递增排序，得到前四个特征频率的序列：\n1. 第一个本征频率对应于 $z_{01} = \\pi$，其中 $n=0$。\n2. 第二个本征频率对应于 $z_{11} \\approx 4.493$，其中 $n=1$。\n3. 第三个本征频率对应于 $z_{21} \\approx 5.763$，其中 $n=2$。\n4. 第四个本征频率对应于 $z_{02} = 2\\pi$，其中 $n=0$。\n\n现在我们为这些情况计算最小 CHIEF 点数 $2n+1$：\n1. 对于第一个本征频率 ($n=0$)：点数 = $2(0)+1 = 1$。\n2. 对于第二个本征频率 ($n=1$)：点数 = $2(1)+1 = 3$。\n3. 对于第三个本征频率 ($n=2$)：点数 = $2(2)+1 = 5$。\n4. 对于第四个本征频率 ($n=0$)：点数 = $2(0)+1 = 1$。\n\n得到的最小 CHIEF 点数序列为 $(1, 3, 5, 1)$。\n\n关于 CHIEF 点的空间选择，目标是选择一组内部点 $\\{\\mathbf{r}_j\\}$（$j=1, ..., 2n+1$），使得元素为 $M_{jm} = \\psi_{nm}(\\mathbf{r}_j) = j_n(k_{ns} |\\mathbf{r}_j|) Y_n^m(\\hat{\\mathbf{r}}_j)$ 的约束矩阵是非奇异的。由于对于给定的 $j$，径向部分 $j_n(k_{ns}r)$ 是一个公共因子，关键部分是来自球谐函数 $Y_n^m(\\theta, \\phi)$ 的角向依赖性。所选点不能位于与张成零空间的 $2n+1$ 个球谐函数的任何非平凡线性组合的节面相对应的几何构型上。例如，对于 $n=1$ 的情况，零空间基函数与笛卡尔分量 $x$、$y$ 和 $z$ 相关。将所需的 $3$ 个点放置在穿过原点的同一直线上将是一种简并构型，因为它们相对于基函数不是线性无关的。通常，在球体内随机放置点是一种稳健的实用策略，以避免此类简并，确保生成的约束矩阵是满秩的，并成功消除零空间。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  3  5  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "复频率偏移是另一种强大而通用的正则化技术，其原理是通过引入微小的介质损耗，将边界积分算子的谱点从原点移开，从而消除奇异性。本练习是一个动手编程实践，将引导你推导圆形边界上单层位势算子的谱表示，并编写一个算法来量化复数偏移对系统条件数的影响，最终找到满足目标条件数所需的最小阻尼参数。",
            "id": "4144412",
            "problem": "考虑由时谐亥姆霍兹方程控制的二维声学问题，该问题定义于一个光滑闭合边界 $\\Gamma$ 的外部区域。控制方程为 $\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0$，并带有索末菲辐射条件 (Sommerfeld radiation condition)，其中 $k$ 是实波数（单位：$\\mathrm{m}^{-1}$）。边界积分公式使用外行基本解 $G_k(\\mathbf{x}, \\mathbf{y})$，而狄利克雷外部问题 (Dirichlet exterior problem) 的经典边界积分方程 (BIE) 算子是单层势算子 $\\mathcal{S}_k$，它通过对核函数 $G_k(\\mathbf{x}, \\mathbf{y})$ 的积分作用于边界密度 $\\varphi$。众所周知，在特征（内部）频率处，与 $\\mathcal{S}_k$ 相关的 BIE 会因与内部狄利克雷特征频率 (interior Dirichlet eigenfrequencies) 相关的谱分量消失而失去唯一性。\n\n一种标准的计算修正方法是引入复频率偏移，将实波数 $k$ 替换为复波数 $k_c = k(1 + i\\alpha)$，其中 $\\alpha$ 是一个非负的无量纲参数。在物理上，这对应于增加均匀吸收，从而修改了外行格林函数 (Green's function)，并因此改变了边界算子的谱。本任务的目标是，对于一个可以从基本原理推导出精确谱表示的典范几何，量化这种复数偏移的谱效应，并计算为满足目标条件数所需的最小 $\\alpha$。\n\n任务：\n- 考虑半径为 $R$（单位：$\\mathrm{m}$）的单位圆作为边界 $\\Gamma$。使用变量分离法和格拉夫加法定理 (Graf's addition theorem) 来获得经典单层算子 $\\mathcal{S}_{k_c}$ 在由整数 $n$ 索引的傅里叶模式上的谱表示。利用此表示推导出逐模态特征值 $\\lambda_n(k_c, R)$，然后计算有限模态条件数\n$$\n\\kappa(k_c, R, M) = \\frac{\\max_{0 \\le n \\le M} |\\lambda_n(k_c, R)|}{\\min_{0 \\le n \\le M} |\\lambda_n(k_c, R)|}\n$$\n其中 $M$ 是一个非负整数截断。\n- 解释圆的内部狄利克雷特征频率如何导致经典单层 BIE 的非唯一性，以及为什么使用 $\\alpha  0$ 的复数偏移可以正则化其谱。\n- 设计一个算法，对于给定的 $(R, k, M)$ 和目标条件数 $\\kappa_{\\mathrm{target}}$，计算最小的 $\\alpha \\ge 0$，使得 $\\kappa(k(1+i\\alpha), R, M) \\le \\kappa_{\\mathrm{target}}$。如果当 $\\alpha = 0$ 时就已经满足 $\\kappa(k, R, M) \\le \\kappa_{\\mathrm{target}}$，则最小 $\\alpha$ 应报告为 $0.0$。如果在搜索区间内没有 $\\alpha$ 值能够达到目标，则返回 $\\mathrm{NaN}$ (Not-a-Number)。所有 $\\alpha$ 值都是无量纲的，并应以浮点数形式报告。\n\n您必须使用的基本原理：\n- 亥姆霍兹方程 $\\nabla^2 p + k^2 p = 0$ 和二维情况下的外行格林函数 $G_k$。\n- 由 $G_k$ 构造的单层算子 $\\mathcal{S}_k$。\n- 圆上的变量分离法和傅里叶模式的正交性。\n- 在变量分离法和格拉夫加法定理中出现的第一类贝塞尔函数和第一类汉克尔函数的性质。\n\n您不得使用任何绕过基于这些原理推导的快捷公式。推导必须从上述原理开始，进而进行谱表征，然后到条件数的算法计算。\n\n数值规格和单位：\n- $R$ 的单位为 $\\mathrm{m}$，$k$ 的单位为 $\\mathrm{m}^{-1}$。\n- $\\alpha$ 是无量纲的。\n- 将最终计算出的最小 $\\alpha$ 值表示为浮点数（无量纲）。\n- 在变量分离或参数化中内部使用的角度以弧度为单位。\n\n测试套件：\n为以下四个测试用例提供最小 $\\alpha$ 值，每个用例指定为 $(R, k, M, \\kappa_{\\mathrm{target}}, \\alpha_{\\max})$：\n1. $(R = 1.0\\,\\mathrm{m},\\ k = 2.4048255577\\,\\mathrm{m}^{-1},\\ M = 12,\\ \\kappa_{\\mathrm{target}} = 100.0,\\ \\alpha_{\\max} = 0.5)$。此处的 $kR$ 是 $J_0$ 的第一个零点，用于测试 $n=0$ 模态的精确特征频率。\n2. $(R = 1.0\\,\\mathrm{m},\\ k = 8.7714838160\\,\\mathrm{m}^{-1},\\ M = 12,\\ \\kappa_{\\mathrm{target}} = 200.0,\\ \\alpha_{\\max} = 0.5)$。此处的 $kR$ 接近 $J_5$ 的第一个零点，用于测试一个高阶特征频率。\n3. $(R = 1.0\\,\\mathrm{m},\\ k = 5.0\\,\\mathrm{m}^{-1},\\ M = 12,\\ \\kappa_{\\mathrm{target}} = 50.0,\\ \\alpha_{\\max} = 0.5)$。这是一个非共振情况。\n4. $(R = 2.0\\,\\mathrm{m},\\ k = 2.7600390551\\,\\mathrm{m}^{-1},\\ M = 16,\\ \\kappa_{\\mathrm{target}} = 150.0,\\ \\alpha_{\\max} = 0.5)$。此处 $kR \\approx 5.5200781102$ 是 $J_0$ 的第二个零点，按半径缩放，用于测试不同几何形状下的共振。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[result_1,result_2,result_3,result_4]$）。结果必须是按上述顺序排列的四个测试用例的最小 $\\alpha$ 值。不应打印任何其他文本。",
            "solution": "该问题要求推导单层势算子在圆上的谱特性，解释在特征频率处的非唯一性问题，并设计一个算法来找到最小的正则化参数。\n\n**1. 圆上单层势算子的谱分析**\n\n二维外部区域 $\\Omega_e$ 中的时谐声压场 $p(\\mathbf{x})$ 由亥姆霍兹方程控制：\n$$ \\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0, \\quad \\mathbf{x} \\in \\Omega_e $$\n其中 $k$ 是实波数。该场还必须满足索末菲辐射条件，以确保波在无穷远处是外行的。\n\n边界积分公式依赖于亥姆霍兹方程的基本解（或格林函数），它满足 $(\\nabla^2 + k^2)G_k(\\mathbf{x}, \\mathbf{y}) = -\\delta(\\mathbf{x} - \\mathbf{y})$。对于二维外行情况，它是：\n$$ G_k(\\mathbf{x}, \\mathbf{y}) = \\frac{i}{4} H_0^{(1)}(k|\\mathbf{x} - \\mathbf{y}|) $$\n其中 $H_0^{(1)}$ 是第 0 阶第一类汉克尔函数。\n\n单层势算子 $\\mathcal{S}_k$ 将定义在边界 $\\Gamma$ 上的密度函数 $\\varphi$ 映射到 $\\Gamma$ 自身上的一个函数，通过以下积分实现：\n$$ (\\mathcal{S}_k \\varphi)(\\mathbf{x}) = \\int_{\\Gamma} G_k(\\mathbf{x}, \\mathbf{y}) \\varphi(\\mathbf{y}) \\, ds(\\mathbf{y}), \\quad \\mathbf{x} \\in \\Gamma $$\n\n对于此问题，边界 $\\Gamma$ 是一个以原点为中心、半径为 $R$ 的圆。我们可以使用极坐标来参数化圆上的点。设 $\\mathbf{x} = (R, \\theta_x)$ 和 $\\mathbf{y} = (R, \\theta_y)$，其中 $\\theta_x, \\theta_y$ 分别是它们的极角。弧长元是 $ds(\\mathbf{y}) = R \\, d\\theta_y$。算子变为：\n$$ (\\mathcal{S}_k \\varphi)(\\theta_x) = \\int_{0}^{2\\pi} \\left[ \\frac{i}{4} H_0^{(1)}(k|\\mathbf{x} - \\mathbf{y}|) \\right] \\varphi(\\theta_y) R \\, d\\theta_y $$\n\n算子 $\\mathcal{S}_k$ 是圆上的一个卷积算子。其特征函数是复傅里叶基函数 $\\psi_n(\\theta) = e^{in\\theta}$，其中 $n \\in \\mathbb{Z}$。为了找到相应的特征值，我们令 $\\varphi(\\theta_y) = e^{in\\theta_y}$ 并计算该积分。关键是使用格拉夫加法定理展开核函数 $H_0^{(1)}(k|\\mathbf{x} - \\mathbf{y}|)$。对于极坐标为 $(r_, \\theta_1)$ 和 $(r_, \\theta_2)$ 且 $r_ > r_$ 的两个点，该定理表述为：\n$$ H_0^{(1)}(k |\\mathbf{r}_1 - \\mathbf{r}_2|) = \\sum_{m=-\\infty}^{\\infty} J_m(k r_) H_m^{(1)}(k r_) e^{im(\\theta_1 - \\theta_2)} $$\n其中 $J_m$ 是第一类贝塞尔函数，$H_m^{(1)}$ 是第一类汉克尔函数，两者均为 $m$ 阶。由于我们的积分是在同一半径为 $R$ 的圆上的点 $\\mathbf{x, y}$ 上进行的，我们必须采用一个极限过程。我们在半径为 $r_x  R$ 的点 $\\mathbf{x}$ 处评估由 $\\Gamma$（半径为 $R$）上的密度产生的势，然后取 $r_x \\to R^+$ 的极限。\n$$ (\\mathcal{S}_k e^{in\\cdot})(\\mathbf{x}) = \\int_{0}^{2\\pi} \\frac{iR}{4} \\left[ \\sum_{m=-\\infty}^{\\infty} J_m(kR) H_m^{(1)}(kr_x) e^{im(\\theta_x - \\theta_y)} \\right] e^{in\\theta_y} \\, d\\theta_y $$\n由于复指数函数的正交性，$\\int_{0}^{2\\pi} e^{i(n-m)\\theta_y} d\\theta_y = 2\\pi \\delta_{mn}$，该和式坍缩为 $m=n$ 的单项：\n$$ (\\mathcal{S}_k e^{in\\cdot})(\\mathbf{x}) = \\frac{iR}{4} J_n(kR) H_n^{(1)}(kr_x) e^{in\\theta_x} (2\\pi) = \\frac{i\\pi R}{2} J_n(kR) H_n^{(1)}(kr_x) e^{in\\theta_x} $$\n当 $\\mathbf{x}$ 从外部趋近边界（$r_x \\to R^+$）时取极限，我们得到算子作用于特征函数 $e^{in\\theta_x}$ 的结果：\n$$ (\\mathcal{S}_k e^{in\\cdot})(\\theta_x) = \\left( \\frac{i\\pi R}{2} J_n(kR) H_n^{(1)}(kR) \\right) e^{in\\theta_x} $$\n因此，算子 $\\mathcal{S}_k$ 对应于特征函数 $e^{in\\theta}$ 的特征值 $\\lambda_n$ 是：\n$$ \\lambda_n(k, R) = \\frac{i\\pi R}{2} J_n(kR) H_n^{(1)}(kR) $$\n此表达式对所有整数 $n$ 均有效。使用恒等式 $J_{-n}(z) = (-1)^n J_n(z)$ 和 $H_{-n}^{(1)}(z) = (-1)^n H_n^{(1)}(z)$，我们发现 $\\lambda_{-n}(k, R) = \\lambda_n(k, R)$。因此，我们只需要考虑非负整数 $n \\ge 0$。\n\n**2. 特征频率处的非唯一性及正则化**\n\n当外部狄利克雷问题的边界积分方程表述为 $\\mathcal{S}_k \\varphi = f$ 时，如果算子 $\\mathcal{S}_k$ 存在非平凡零空间，则方程解不唯一。这种情况发生在存在一个非零密度 $\\varphi$ 使得在 $\\Gamma$ 上 $\\mathcal{S}_k \\varphi = 0$。这等价于对某个模态 $n$，存在特征值 $\\lambda_n(k, R) = 0$。\n从特征值公式可知，$\\lambda_n(k, R) = 0$ 当且仅当 $J_n(kR) = 0$（因为对于实数 $z0$，$H_n^{(1)}(z)$ 和 $J_n(z)$ 没有共同的零点）。条件 $J_n(kR)=0$（对于某个整数 $n$）恰好定义了半径为 $R$ 的圆形区域的内部狄利克雷特征频率。在这些所谓的“特征频率”处，BIE 公式是不适定的。算子的谱包含零，而定义为最大奇异值（或特征值模）与最小奇异值之比的条件数变为无穷大。\n\n标准的修正方法是在介质中引入少量人为阻尼，即使用复波数 $k_c = k(1+i\\alpha)$，其中 $\\alpha$ 是一个小的正无量纲参数。这将亥姆霍兹方程修改为 $\\nabla^2 p + k_c^2 p = 0$。正则化算子 $\\mathcal{S}_{k_c}$ 的特征值通过将 $k$ 替换为 $k_c$ 得到：\n$$ \\lambda_n(k_c, R) = \\frac{i\\pi R}{2} J_n(k_c R) H_n^{(1)}(k_c R) $$\n贝塞尔函数和汉克尔函数的宗量现在是复数：$z_c = k_c R = kR(1+i\\alpha)$。对于 $\\alpha  0$，$z_c$ 具有非零的虚部。贝塞尔函数 $J_n(z)$（对于实整数 $n$）的一个基本性质是其所有零点都是实数。因此，如果 $\\mathrm{Im}(z_c) \\neq 0$，那么对于任何 $n$，都有 $J_n(z_c) \\neq 0$。\n这意味着对于任何 $\\alpha  0$，所有特征值 $\\lambda_n(k_c, R)$ 都是非零的。复数偏移将所有特征值移离原点，从而“正则化”了算子的谱。算子 $\\mathcal{S}_{k_c}$ 变得可逆，其条件数变为有限。\n\n**3. 最小正则化的算法设计**\n\n目标是在搜索范围 $[0, \\alpha_{\\max}]$ 内找到最小的 $\\alpha \\ge 0$，使得条件数 $\\kappa(k_c, R, M)$ 不大于目标值 $\\kappa_{\\mathrm{target}}$。条件数是为最高为 $n=M$ 的模态定义的：\n$$ \\kappa(\\alpha) \\equiv \\kappa(k(1+i\\alpha), R, M) = \\frac{\\max_{0 \\le n \\le M} |\\lambda_n(k(1+i\\alpha), R)|}{\\min_{0 \\le n \\le M} |\\lambda_n(k(1+i\\alpha), R)|} $$\n算法流程如下：\n1.  定义一个函数来计算给定 $(R, k, M)$ 时的 $\\kappa(\\alpha)$。这涉及计算特征值 $\\lambda_n(k_c, R) = \\frac{i\\pi R}{2} J_n(k_c R) H_n^{(1)}(k_c R)$ 在 $n=0, 1, \\dots, M$ 时的模，其中 $k_c = k(1+i\\alpha)$，然后求最大模与最小模之比。\n2.  对于一个给定的测试用例 $(R, k, M, \\kappa_{\\mathrm{target}}, \\alpha_{\\max})$，首先在 $\\alpha = 0$ 时评估条件数：$\\kappa_0 = \\kappa(0)$。如果 $\\kappa_0 \\le \\kappa_{\\mathrm{target}}$，则问题在没有正则化的情况下已经解决，所需的最小 $\\alpha$ 为 $0.0$。\n3.  如果 $\\kappa_0  \\kappa_{\\mathrm{target}}$（这种情况发生在特征频率处或其附近），我们必须找到一个 $\\alpha  0$。从共振点开始，函数 $\\kappa(\\alpha)$ 预计对于 $\\alpha  0$ 是单调递减的。我们寻求最小的 $\\alpha$ 使得 $\\kappa(\\alpha) \\le \\kappa_{\\mathrm{target}}$。这等价于求方程 $f(\\alpha) = \\kappa(\\alpha) - \\kappa_{\\mathrm{target}} = 0$ 的根。\n4.  首先，通过计算 $\\kappa(\\alpha_{\\max})$ 来检查在允许的范围内是否存在解。如果 $\\kappa(\\alpha_{\\max})  \\kappa_{\\mathrm{target}}$，则在 $[0, \\alpha_{\\max}]$ 内没有 $\\alpha$ 值能满足条件，结果为“非数值”(NaN)。\n5.  如果保证在 $(0, \\alpha_{\\max}]$ 内存在解，则二分搜索是一种稳健的求根方法。我们在区间 $[0, \\alpha_{\\max}]$ 内搜索 $\\alpha$。\n    - 初始化 `low = 0` 和 `high = alpha_max`。\n    - 重复二分区间：取 `mid = (low + high) / 2`。\n    - 如果 $\\kappa(\\mathrm{mid}) \\le \\kappa_{\\mathrm{target}}$，则在 `mid` 处找到了一个有效解。最小解可能更小，所以我们通过设置 `high = mid` 在下半部分继续搜索。\n    - 如果 $\\kappa(\\mathrm{mid})  \\kappa_{\\mathrm{target}}$，则 `mid` 太小。我们必须通过设置 `low = mid` 在上半部分搜索。\n    - 重复此过程，直到达到固定的迭代次数或区间 `[low, high]` 足够小。`high` 的值将收敛到满足条件的最小 $\\alpha$。\n\n此过程为数值确定最小正则化参数提供了一种稳健的方法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jv, hankel1\n\ndef compute_kappa(alpha, R, k, M):\n    \"\"\"\n    Computes the finite-mode condition number for a given alpha.\n    \"\"\"\n    if k == 0:\n        return 1.0 # Trivial case\n\n    # Complex wavenumber and argument for Bessel/Hankel functions\n    k_c = k * (1 + 1j * alpha)\n    z_c = k_c * R\n\n    # For kR=0, eigenvalues are not well-defined by the formula, but S is smoothing\n    # and for a circle, the operator is not singular. However, test cases avoid kR=0.\n    # We must handle the edge case where z_c is zero or very small.\n    if np.abs(z_c)  1e-12:\n        return 1.0\n\n    eigenvalue_magnitudes = []\n    for n in range(M + 1):\n        # Eigenvalue formula: lambda_n = (i*pi*R/2) * J_n(k_c*R) * H_n^(1)(k_c*R)\n        # We need its magnitude: |lambda_n| = (pi*R/2) * |J_n(z_c)| * |H_n^(1)(z_c)|\n        # scipy functions jv(n, z) and hankel1(n, z) are used.\n        jn_val = jv(n, z_c)\n        h1n_val = hankel1(n, z_c)\n        \n        # At resonance (alpha=0, kR is a zero of J_n), jn_val is ~0.\n        # This will lead to a very small |lambda_n| and large kappa.\n        mag = (np.pi * R / 2.0) * np.abs(jn_val * h1n_val)\n        eigenvalue_magnitudes.append(mag)\n    \n    mags = np.array(eigenvalue_magnitudes)\n\n    # Handle potential inf/nan issues if a magnitude is exactly zero\n    min_mag = np.min(mags)\n    if min_mag  1e-16: # Effectively zero, condition number is infinite\n        return np.inf\n\n    max_mag = np.max(mags)\n    \n    return max_mag / min_mag\n\ndef find_minimal_alpha(R, k, M, kappa_target, alpha_max):\n    \"\"\"\n    Finds the minimal alpha = 0 such that kappa = kappa_target.\n    \"\"\"\n    # 1. Check if regularization is needed at all\n    kappa_at_0 = compute_kappa(0, R, k, M)\n    if kappa_at_0 = kappa_target:\n        return 0.0\n\n    # 2. Check if the target is achievable within the given alpha_max\n    kappa_at_max = compute_kappa(alpha_max, R, k, M)\n    if kappa_at_max > kappa_target:\n        return np.nan\n\n    # 3. Use bisection search to find the minimal alpha\n    low = 0.0\n    high = alpha_max\n    \n    # Bisection search for 100 iterations, sufficient for double precision.\n    for _ in range(100):\n        mid = (low + high) / 2.0\n        # If interval becomes too small, stop.\n        if mid == low or mid == high:\n            break\n        \n        kappa_at_mid = compute_kappa(mid, R, k, M)\n        \n        if kappa_at_mid = kappa_target:\n            # A solution is found at mid, try to find a smaller alpha\n            high = mid\n        else:\n            # mid is too small, need a larger alpha\n            low = mid\n            \n    # `high` converges to the minimal alpha satisfying the condition\n    return high\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (R, k, M, kappa_target, alpha_max)\n    test_cases = [\n        (1.0, 2.4048255577, 12, 100.0, 0.5),\n        (1.0, 8.7714838160, 12, 200.0, 0.5),\n        (1.0, 5.0, 12, 50.0, 0.5),\n        (2.0, 2.7600390551, 16, 150.0, 0.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        R, k, M, kappa_target, alpha_max = case\n        result = find_minimal_alpha(R, k, M, kappa_target, alpha_max)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Format results to a reasonable number of decimal places for consistency\n    formatted_results = [f\"{res:.8f}\" if not np.isnan(res) else \"nan\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}