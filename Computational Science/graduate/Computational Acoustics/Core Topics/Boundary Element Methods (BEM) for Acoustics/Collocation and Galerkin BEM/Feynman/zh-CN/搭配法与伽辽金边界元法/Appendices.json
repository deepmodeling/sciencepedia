{
    "hands_on_practices": [
        {
            "introduction": "边界元方法（BEM）虽然功能强大，但一些看似直接的公式构建可能会在特定条件下失效。一个经典的例子是“伪共振”（spurious resonances）现象，它源于积分算子本身的数学特性，而非外部问题的物理特性。这项练习将揭示这一抽象概念背后的原理，通过为一个简单的几何体（圆形）从第一性原理推导共振条件，您将亲手计算出导致数值模拟失败的具体频率。",
            "id": "4118324",
            "problem": "考虑角频率为 $\\omega$、波数为 $k$ 的二维时谐声学问题，其中 $k = \\omega / c$，$c$ 为声速。假设一个半径为 $a$ 的软声圆形障碍物（一个圆盘）位于平面的原点。外部散射问题在边界 $r = a$ 上施加狄利克雷边界条件 $p = 0$，其中 $p$ 是在外部区域满足亥姆霍兹方程 $\\Delta p + k^{2} p = 0$ 的声压。在标准的配置边界元法 (BEM) 中，当使用纯双层边界积分方程求解外部狄利克雷问题时，在与圆盘内部狄利克雷特征值相关的特定波数处，可能会出现非唯一性（伪共振）问题。\n\n从亥姆霍兹方程 $\\Delta u + k^{2} u = 0$ 和内部狄利克雷边界条件 $u|_{r=a} = 0$ 出发，使用极坐标下的变量分离法推导圆盘内部的特征值条件。然后，通过将此条件与纯双层配置方程可逆性的丧失联系起来，找出在声速 $c = 343$ $\\mathrm{m/s}$ 的空气中，对于半径为 $a = 0.5$ $\\mathrm{m}$ 的圆盘，出现伪共振的前三个最低非零频率（以赫兹为单位）。通过 $f = \\omega/(2\\pi) = c k/(2\\pi)$ 将每个频率 $f$ 表示为赫兹，并将您的答案四舍五入到四位有效数字。将三个共振频率按升序排列，表示为一个单行向量。在您的推导中，请论证为什么这些内部特征值会导致配置双层边界元法中的非唯一性，并简要解释接近这样一个频率对配置解的定性影响。最终的数值答案必须以 $\\mathrm{Hz}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "本题要求推导涉及软声圆形圆盘的二维外部声散射问题的伪共振频率。这是在使用纯双层势公式时，边界元法 (BEM) 中的一个经典问题。\n\n首先，我们必须找到相应内部狄利克雷问题的特征值。这涉及到在半径为 $a$ 的圆盘内部求解亥姆霍兹方程 $\\Delta u + k^{2} u = 0$，并满足边界 $r=a$ 上的边界条件 $u = 0$。我们使用极坐标 $(r, \\theta)$ 下的变量分离法。亥姆霍兹方程在极坐标下的形式为：\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} + k^2 u = 0 $$\n设解的形式为 $u(r, \\theta) = R(r) \\Theta(\\theta)$。将其代入方程并分离变量可得：\n$$ \\frac{r}{R(r)} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) + k^2r^2 = - \\frac{1}{\\Theta(\\theta)} \\frac{d^2 \\Theta(\\theta)}{d\\theta^2} $$\n等式两边必须等于一个常数，我们记为 $n^2$。解在 $\\theta$ 上是单值的要求，即 $\\Theta(\\theta) = \\Theta(\\theta + 2\\pi)$，将 $n$ 限制为整数，$n \\in \\{0, 1, 2, \\dots\\}$。\n\n角向方程为 $\\frac{d^2 \\Theta}{d\\theta^2} + n^2 \\Theta = 0$，其解的形式为 $\\Theta(\\theta) = A_n \\cos(n\\theta) + B_n \\sin(n\\theta)$。\n\n径向方程变为：\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} + (k^2r^2 - n^2)R = 0 $$\n这是 $n$ 阶贝塞尔微分方程。其通解是第一类贝塞尔函数 $J_n(kr)$ 和第二类贝塞尔函数 $Y_n(kr)$ 的线性组合。因此，$u(r, \\theta)$ 的完整解为：\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} \\left[ C_n J_n(kr) + D_n Y_n(kr) \\right] (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\n对于内部问题，解在原点 ($r=0$) 处必须是有限的。由于第二类贝塞尔函数 $Y_n(z)$ 在 $z=0$ 处是奇异的，我们必须将所有系数 $D_n=0$ 以确保解具有物理意义。\n\n解简化为：\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} C_n J_n(kr) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\n应用狄利克雷边界条件 $u(a, \\theta) = 0$：\n$$ \\sum_{n=0}^{\\infty} C_n J_n(ka) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) = 0 $$\n为了使该方程对所有 $\\theta$ 都成立，每个傅里叶模态的系数必须为零。要存在非平凡解（即系数 $A_n, B_n, C_n$ 不全为零），我们必须有：\n$$ J_n(ka) = 0 $$\n这就是内部狄利克雷问题的特征值条件。对于任何整数 $n \\geq 0$，满足此条件的波数 $k$ 即为特征值。设 $z_{n,m}$ 是贝塞尔函数 $J_n(z)$ 的第 $m$ 个正根。那么共振波数由 $k_{n,m} = z_{n,m}/a$ 给出。\n\n外部问题配置边界元法非唯一性的问题源于其积分方程公式。外部狄利克雷问题，当用纯双层势公式表示时，会得到边界积分方程 $( \\frac{1}{2}I + K_k ) \\mu = 0$，其中 $K_k$ 是双层边界积分算子（依赖于 $k$），$\\mu$ 是未知的密度函数。这个齐次方程有非平凡解 $\\mu$ 的充要条件是算子 $(\\frac{1}{2}I + K_k)$ 是奇异的。根据弗雷德霍姆择一性理论和位势算子的性质，这种奇异性恰好在波数 $k$ 是内部狄利克雷问题的特征值时发生，即对于某个 $n$ 有 $J_n(ka) = 0$。因此，这些波数被称为“伪”波数，因为它们是数学公式的人为产物，而不是外部散射问题本身的物理共振。\n\n在进行数值配置边界元法时，积分算子被离散化为一个矩阵 $A$。当波数 $k$ 接近一个伪共振波数 $k_{n,m}$ 时，连续算子趋于奇异，导致矩阵 $A$ 的条件数无界增长。这种病态意味着数值方程组变得近乎奇异，计算出的密度 $\\mu$ 的解会变得任意大，并被数值误差所破坏，从而导致一个没有物理意义的发散声压场。\n\n为了找到前三个最低的非零频率，我们需要找到 $J_n(z)=0$ 的三个最小正根。我们列出前几个根：\n$J_0(z)=0$ 的根是 $z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$, ...\n$J_1(z)=0$ 的根是 $z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$, ...\n$J_2(z)=0$ 的根是 $z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$, ...\n$J_3(z)=0$ 的根是 $z_{3,1} \\approx 6.3802$, ...\n\n将所有根 $z_{n,m}$ 按升序排列，得到以下序列：\n$z_{0,1} \\approx 2.4048$\n$z_{1,1} \\approx 3.8317$\n$z_{2,1} \\approx 5.1356$\n这是三个最小的正根。\n\n相应的频率 $f$ 使用公式 $f = \\frac{ck}{2\\pi} = \\frac{c z_{n,m}}{2\\pi a}$ 计算。\n给定参数 $c = 343 \\, \\mathrm{m/s}$ 和 $a = 0.5 \\, \\mathrm{m}$：\n$$ f_{n,m} = \\frac{343}{2\\pi(0.5)} z_{n,m} = \\frac{343}{\\pi} z_{n,m} $$\n1. 第一个最低频率（来自 $z_{0,1}$）：\n$$ f_1 = f_{0,1} = \\frac{343}{\\pi} \\times 2.404825... \\approx 262.5699... \\, \\mathrm{Hz} $$\n四舍五入到四位有效数字得到 $262.6 \\, \\mathrm{Hz}$。\n\n2. 第二个最低频率（来自 $z_{1,1}$）：\n$$ f_2 = f_{1,1} = \\frac{343}{\\pi} \\times 3.831706... \\approx 418.3245... \\, \\mathrm{Hz} $$\n四舍五入到四位有效数字得到 $418.3 \\, \\mathrm{Hz}$。\n\n3. 第三个最低频率（来自 $z_{2,1}$）：\n$$ f_3 = f_{2,1} = \\frac{343}{\\pi} \\times 5.135622... \\approx 560.7246... \\, \\mathrm{Hz} $$\n四舍五入到四位有效数字得到 $560.7 \\, \\mathrm{Hz}$。\n\n这三个频率代表了指定问题的前三个伪共振。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n262.6 & 418.3 & 560.7\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了一种理论上的陷阱之后，我们转向边界元方法中一个普遍存在的实践挑战：数值计算边界积分。当计算点（或称为“场点”）靠近积分单元但又不在其上时，格林函数的核函数会出现一个尖锐的峰值，这使得标准的高斯积分等方法失效。这个问题对于开发精确高效的BEM代码至关重要，本练习将引导您评估和比较解决“近奇异”积分问题的不同策略。",
            "id": "4118338",
            "problem": "在计算声学中，考虑一个具有单位外法向场的声硬散射体的外部亥姆霍兹问题，其中声压 $p$ 满足波数为 $k$ 的亥姆霍兹方程，并通过使用亥姆霍兹算子的基本解表示为边界积分。在边界元法 (BEM) 中，配置法形式和伽辽金法形式都要求精确计算其核函数为弱奇异或近奇异的曲面积分。考虑一个由局部坐标卡 $(u,v) \\mapsto \\mathbf{y}(u,v)$ 参数化的光滑曲面元 $\\Gamma_{e}$ 上的单层势，其面积元为 $d\\Gamma = \\left\\lVert \\partial_{u} \\mathbf{y} \\times \\partial_{v} \\mathbf{y} \\right\\rVert \\, du \\, dv$。在不在 $\\Gamma_{e}$ 上的目标点 $\\mathbf{x}$ 处需要计算的积分为\n$$\nU(\\mathbf{x}) = \\int_{\\Gamma_{e}} G_{k}(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, d\\Gamma,\n$$\n其中在三维空间中 $G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$，且 $\\sigma$ 是一个光滑密度函数。假设 $\\mathbf{x}$ 靠近 $\\Gamma_{e}$，其意义是它到 $\\Gamma_{e}$ 上最近点 $\\mathbf{y}_{0}$ 的有向法向距离是一个小参数 $\\delta > 0$，但 $\\mathbf{x} \\notin \\Gamma_{e}$。\n\n从基本解 $G_{k}$ 和曲面测度的定义出发，分析被积函数在最近点 $\\mathbf{y}_{0}$ 附近的局部结构，并解释为什么在没有进行任何特殊处理的情况下，当 $\\delta \\to 0$ 时，在 $(u,v)$ 上的标准张量积高斯求积会产生很大的误差。然后，基于基本原理，选择一个或多个策略，这些策略能够正确地正则化或解决近奇异行为，并在配置法和伽辽金 BEM 设置中，对 $\\delta$ 小至单元尺寸的目标点都能一致地提供高阶精度。\n\n哪些选项是正确的？\n\nA. 在参数空间中，以最近坐标卡点 $(u_{0},v_{0})$ 为中心引入一个局部极坐标爆破，通过 $(u,v) = (u_{0},v_{0}) + \\rho \\, \\mathbf{t}(\\theta)$ 将 $(u,v)$ 映射到 $(\\rho,\\theta)$，其中 $\\mathbf{t}(\\theta)$ 张成 $\\mathbf{y}_{0}$ 处的切平面；然后应用径向重参数化 $\\rho = s^{2}$；使用高阶乘积高斯法则在 $(s,\\theta)$ 中积分，使得雅可比因子消除了 $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert$ 的峰值，从而在 $s$ 上得到一个光滑的被积函数。\n\nB. 保留原始的 $(u,v)$ 参数化，并简单地在 $\\Gamma_{e}$ 上均匀增加高斯节点的阶数和数量；这最终会收敛，因此足以在 $\\delta \\to 0$ 时控制近奇异求积误差。\n\nC. 通过将 $\\Gamma_{e}$ 细分为向 $(u_{0},v_{0})$ 几何聚集的分级子面元来进行自适应加密，使得最小子面元的直径与 $O(\\delta)$ 成比例；在每个子面元上应用标准高斯求积，选择一个分级指数来平衡局部的 $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert$ 行为，以实现一致的高阶精度。\n\nD. 在 $\\Gamma_{e}$ 上将核函数 $G_{k}(\\mathbf{x},\\mathbf{y})$ 替换为常数 $G_{k}(\\mathbf{x},\\mathbf{y}_{0})$ 以移除近奇异峰值，并用标准高斯求积法对得到的常数核积分进行积分。\n\nE. 直接在 $(u,v)$ 中使用针对振荡因子 $e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$ 调整的 Filon 型求积法，不进行任何局部爆破或网格加密，因为主要困难是振荡而不是近奇异性。",
            "solution": "问题陈述描述了在求解外部亥姆霍兹问题的边界元法 (BEM) 中出现的单层势积分的数值计算。核心挑战在于，当计算点 $\\mathbf{x}$ 靠近积分曲面元 $\\Gamma_e$ 但不在其上时，如何精确计算该积分。这种情况被称为近奇异积分。\n\n### 第一步：提取已知条件\n\n-   **问题领域：** 计算声学，外部亥姆霍兹问题。\n-   **方法：** 边界元法 (BEM)，特别是配置法和伽辽金法形式。\n-   **积分：** 单层势, $U(\\mathbf{x}) = \\int_{\\Gamma_{e}} G_{k}(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, d\\Gamma$。\n-   **核函数：** $3$D 亥姆霍兹基本解, $G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$。\n-   **曲面元：** $\\Gamma_e$, 一个由 $\\mathbf{y}(u,v)$ 参数化的光滑单元，其面积元为 $d\\Gamma = J(u,v) \\, du \\, dv$, 其中 $J(u,v) = \\left\\lVert \\partial_{u} \\mathbf{y} \\times \\partial_{v} \\mathbf{y} \\right\\rVert$。\n-   **密度：** $\\sigma(\\mathbf{y})$ 是一个光滑函数。\n-   **目标点配置：** $\\mathbf{x} \\notin \\Gamma_e$。$\\Gamma_e$ 上距离 $\\mathbf{x}$ 最近的点是 $\\mathbf{y}_{0}$。有向法向距离为 $\\delta > 0$，且 $\\delta$ 是一个小参数。\n-   **主要任务：** 解释当 $\\delta \\to 0$ 时标准高斯求积法失效的原因，并找出能实现一致高阶精度的正确正则化策略。\n\n### 第二步：使用提取的已知条件进行验证\n\n问题陈述是科学上合理且适定的。\n-   **科学依据：** 该问题是边界积分方程数值分析中的一个标准且关键的课题。亥姆霍兹方程、其基本解以及层势的构建都是声学和波传播领域的基石概念。评估近奇异积分的挑战是 BEM 实现中一个有充分文献记载的基本问题。所有提出的概念在事实上和数学上都是正确的。\n-   **适定性：** 问题定义清晰。它要求分析一种数值方法的失效原因，并从给定列表中找出有效的修正策略。所给的设定提供了足够的信息来分析被积函数的局部行为。“一致的高阶精度”在数值分析中有精确的含义，即收敛率与小参数 $\\delta$ 无关。\n-   **客观性：** 语言是技术性的、精确的，并且没有主观或模糊的术语。\n\n### 第三步：结论与行动\n\n该问题是**有效的**。其设定是一致的、有科学依据的、并且是适定的。我现在将进行推导和评估。\n\n### 推导与选项分析\n\n**标准求积法失效分析**\n\n令 $\\mathbf{y}_{0} = \\mathbf{y}(u_0, v_0)$ 为光滑曲面元 $\\Gamma_e$ 上与目标点 $\\mathbf{x}$ 唯一的最近点。根据定义，向量 $\\mathbf{x} - \\mathbf{y}_0$ 与 $\\Gamma_e$ 在 $\\mathbf{y}_0$ 处的切平面正交。我们可以写出 $\\mathbf{x} = \\mathbf{y}_{0} + \\delta \\mathbf{n}(\\mathbf{y}_0)$，其中 $\\mathbf{n}$ 是单位法向量，$\\delta > 0$ 是距离。\n\n对于 $\\Gamma_e$ 上靠近 $\\mathbf{y}_0$ 的点 $\\mathbf{y}$，我们可以通过其在 $\\mathbf{y}_0$ 处切平面上的投影来近似距离向量 $\\mathbf{y} - \\mathbf{y}_0$。设 $(u,v)$ 为 $\\Gamma_e$ 的局部参数。设 $\\mathbf{t}_u = \\partial_u \\mathbf{y}$ 和 $\\mathbf{t}_v = \\partial_v \\mathbf{y}$ 为 $(u_0, v_0)$ 处的切向量。对于小的 $\\Delta u = u-u_0$ 和 $\\Delta v = v - v_0$，我们有泰勒展开：\n$$\n\\mathbf{y}(u,v) \\approx \\mathbf{y}_0 + \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v\n$$\n从 $\\mathbf{x}$ 到 $\\mathbf{y}$ 的向量则为：\n$$\n\\mathbf{x} - \\mathbf{y} \\approx (\\mathbf{y}_0 + \\delta\\mathbf{n}) - (\\mathbf{y}_0 + \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v) = \\delta\\mathbf{n} - (\\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v)\n$$\n由于 $\\mathbf{n}$ 与切向量 $\\mathbf{t}_u$ 和 $\\mathbf{t}_v$ 正交，距离的平方为：\n$$\n\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert^2 \\approx \\delta^2 + \\left\\lVert \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v \\right\\rVert^2 = \\delta^2 + g_{uu}(\\Delta u)^2 + 2g_{uv}\\Delta u \\Delta v + g_{vv}(\\Delta v)^2\n$$\n其中 $g_{ij}$ 是 $\\mathbf{y}_0$ 处第一基本形式（度量张量）的分量。该二次型表示从 $\\mathbf{y}_0$ 到 $\\mathbf{y}$ 在曲面上的测地距离的平方 $r^2$。因此，局部地，$\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert \\approx \\sqrt{\\delta^2 + r^2}$。\n\n被积函数包含项 $1/\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert \\approx (\\delta^2+r^2)^{-1/2}$。当 $\\delta \\to 0$ 时，该函数在 $r=0$ 处形成一个高度为 $1/\\delta$ 的尖峰。标准高斯求积依赖于用多项式逼近被积函数。对于一个 $N$ 点法则，只有当被积函数的 $2N$ 阶导数很小时，这种逼近才是准确的。我们来考察核函数关于某个参数坐标（比如与 $r$ 相关的 $u$）的导数。\n$$\n\\frac{\\partial}{\\partial r} \\left( \\frac{1}{\\sqrt{\\delta^2+r^2}} \\right) = -r(\\delta^2+r^2)^{-3/2}\n$$\n该导数的量级在 $r=\\delta/\\sqrt{2}$ 附近达到峰值，其大小与 $O(\\delta^{-2})$ 成比例。更高阶的导数表现出更强的爆破行为，对于 $n$ 阶导数，其大小与 $O(\\delta^{-n-1})$ 成比例。由于多项式逼近理论要求有界导数才能有好的性能，任何固定阶数的高斯求积法则在 $\\delta \\to 0$ 时都会产生无限增大的误差。这解释了标准张量积高斯求积法的失效。\n\n**逐项选项分析**\n\n**A. 在参数空间中引入一个局部极坐标爆破……**\n该选项描述了一种坐标变换方法，这是一种复杂而正确的方法。\n1.  **局部极坐标爆破**：第一步是将参数平面中的笛卡尔坐标 $(u,v)$ 变为以 $(u_0, v_0)$ 为中心的极坐标 $(\\rho,\\theta)$。测度变为 $du\\,dv = \\rho\\,d\\rho\\,d\\theta$。曲面上的距离 $r$ 在 $(u_0, v_0)$ 附近约与 $\\rho$ 成正比。被积函数的近奇异部分变得与 $\\frac{\\rho}{\\sqrt{\\delta^2+c\\rho^2}}$ 成正比（对于某个常数 $c>0$）。这个函数有界但有一个边界层：它关于 $\\rho$ 在 $\\rho=0$ 处的导数与 $1/\\delta$ 成正比，因此不是一致有界的。\n2.  **径向重参数化**：应用第二次非线性的径向坐标变换：$\\rho = s^2$。微分变为 $d\\rho = 2s\\,ds$。完整的变换是从 $(u,v)$到 $(s,\\theta)$，从 $(s,\\theta)$ 到 $(u,v)$ 的映射的雅可比行列式，除去度量中的一个比例因子，为 $2s^3$。核函数的行为是 $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert \\approx 1/\\sqrt{\\delta^2 + c(s^2)^2} = 1/\\sqrt{\\delta^2+cs^4}$。\n3.  **最终的被积函数**：积分的径向部分现在涉及一个形如 $\\frac{1}{\\sqrt{\\delta^2+cs^4}} \\times (\\text{光滑函数}) \\times (2s^3\\,ds)$ 的项。需要分析的关键函数是 $f(s) = \\frac{s^3}{\\sqrt{\\delta^2+cs^4}}$。这个函数在 $s=0$ 处关于 $s$ 是光滑的（无限可微），并且它的所有导数关于 $\\delta \\ge 0$ 都是一致有界的。例如，$f(0)=0$ 且 $f'(0)=0$。这个过程，称为正则化，将近奇异被积函数转换为在新坐标 $(s, \\theta)$ 下的光滑函数。然后可以在 $(s, \\theta)$ 中应用标准张量积高斯求积，以固定的点数实现一致于 $\\delta$ 的高阶精度。“雅可比因子消除了……峰值”是一种略微非正式但概念上可接受的描述，说明了新的积分测度如何正则化被积函数。此选项描述了文献中一种有效且强大的策略（例如，与 Sauter-Schwab 求积法相关）。\n**结论：正确**\n\n**B. 保留原始的 $(u,v)$ 参数化，并简单地增加高斯节点的阶数和数量……**\n正如分析所确立的，对于任何固定的求积点数 $N$，都可以找到一个足够小的 $\\delta > 0$，使得求积误差大到不可接受。为了在 $\\delta \\to 0$ 时保持恒定的精度水平，点数 $N$ 必须增加，通常与 $N \\propto 1/\\delta$ 成比例。这在计算上是低效的，并且不满足“一致地提供高阶精度”的要求（对于固定的计算成本）。这种暴力方法不被认为是稳健数值算法意义上的“特殊处理”。\n**结论：错误**\n\n**C. 通过将 $\\Gamma_{e}$ 细分为分级子面元来进行自适应加密……**\n该选项描述了另一种基于几何的策略。其核心思想是通过在问题区域加密网格来解决被积函数的尖峰问题。\n1.  **自适应细分**：单元 $\\Gamma_e$被递归地划分为更小的子面元。\n2.  **分级**：加密不是均匀的。子面元在投影点 $\\mathbf{y}_0$ 附近逐渐变小。最小子面元（最靠近 $\\mathbf{y}_0$ 的那些）的直径与 $O(\\delta)$ 成比例这一条件是关键。\n3.  **机理**：在一个大小为 $h$、距离 $\\mathbf{y}_0$ 为 $d$ 的子面元上，到目标点 $\\mathbf{x}$ 的距离近似为 $\\sqrt{\\delta^2+d^2}$。核函数在该子面元上的相对变化由比率 $h/\\sqrt{\\delta^2+d^2}$ 控制。通过确保该比率在任何地方都保持较小（分级几何加密可以实现这一点，特别是在 $\\mathbf{y}_0$ 附近的子面元，其中 $d \\approx 0$ 且我们选择 $h \\sim \\delta$），被积函数在每个子面元上都可以很好地被低阶多项式逼近。然后可以在每个子面元上应用标准高斯求积以获得高精度。“分级指数”控制着面元尺寸在远离加密中心时增大的速度，从而平衡精度和计算成本。这是一种成熟、正确且稳健的方法。\n**结论：正确**\n\n**D. 在 $\\Gamma_{e}$ 上将核函数 $G_{k}(\\mathbf{x},\\mathbf{y})$ 替换为常数 $G_{k}(\\mathbf{x},\\mathbf{y}_{0})$……**\n这是一种非常粗略的近似。函数 $G_{k}(\\mathbf{x},\\mathbf{y})$ 在 $\\mathbf{y}_0$ 处有一个尖峰，并随着远离该点而衰减。在整个单元上用其最大值（暂不考虑相位）$1/(4\\pi\\delta)$ 来替换该函数，将严重高估远离 $\\mathbf{y}_0$ 的单元部分的贡献。这对应于一个零阶近似（如果 $\\mathbf{y}_0$ 投影到中心，则为整个单元的中点法则）。它不可能提供“高阶精度”。\n**结论：错误**\n\n**E. 使用针对振荡因子调整的 Filon 型求积法……**\n此选项错误地识别了困难的主要来源。问题关注的是 $\\delta \\to 0$ 的极限。在此极限下，主要的数值挑战是代数近奇异性 $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert \\sim 1/\\delta$。Filon 型求积法是为处理高度振荡积分而设计的，即当波数 $k$ 很大时。虽然亥姆霍兹核是振荡的，但 Filon 方法旨在用多项式逼近*幅值*函数。在这里，幅值函数是 $\\frac{\\sigma(\\mathbf{y})}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$，而这正是那个不光滑并导致标准求积法失效的函数。直接应用 Filon 方法而不解决幅值函数的近奇异性，在 $\\delta \\to 0$ 时也无法产生准确的结果。这两个困难（近奇异性和高频振荡）是不同的，需要分开或结合处理。\n**结论：错误**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "探索了理论陷阱和关键的积分数值技术后，最后的实践是将这些知识融会贯通，构建BEM系统矩阵。本练习将引导您实现伽辽金（Galerkin）方法的矩阵组装过程，这涉及双重积分、雅可比行列式处理和积分点的应用。这项练习是最终的动手实践，它将数学公式与功能性算法联系起来，通过编写矩阵组装的嵌套循环，您将具体了解BEM求解器是如何从头构建的。",
            "id": "4118364",
            "problem": "您需要实现并论证一个在三角化曲面上针对声学单层算子的伽辽金边界元法 (BEM) 组装过程。控制偏微分方程是用于时谐声学的亥姆霍兹方程，在均匀自由空间中表示为 $-\\Delta u - k^2 u = 0$（在 $\\mathbb{R}^3 \\setminus \\Gamma$ 中），其中 $\\Gamma$ 是一个光滑曲面。亥姆霍兹方程的自由空间格林函数为 $G_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}$，其中 $k$ 是波数，单位为弧度/米 (rad/m)。单层边界积分算子的伽辽金离散化构建了矩阵 $V$，其元素是由基函数加权的核函数的曲面二重积分。\n\n从以下基本基础开始：\n- 亥姆霍兹方程 $-\\Delta u - k^2 u = 0$ 及其自由空间格林函数 $G_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}$。\n- 采用伽辽金方法，每个三角形单元使用分片常数基函数，因此与三角形 $T_p$ 关联的基函数在 $T_p$ 上为 $1$，在其他地方为 $0$。\n- 面积为 $\\tfrac{1}{2}$ 的参考三角形，其坐标为 $(\\xi,\\eta)$，并通过仿射映射到具有顶点 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 的物理三角形，在该映射下，曲面雅可比行列式为常数，等于 $J = 2 A$，其中 $A$ 是物理三角形的面积。\n\n您必须推导并实现伽辽金 $V$ 矩阵的组装算法，并满足以下要求：\n- 矩阵元素由\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}},\n$$\n定义，适用于三角化曲面上的三角形 $T_p$ 和 $T_q$。使用分片常数基函数，因此除了每个三角形上的常数 $1$ 之外，没有额外的基函数因子。\n- 在参考三角形上使用局部求积法则来近似每个曲面积分。具体来说，设 $\\{(\\xi_i,\\eta_i), w_i\\}_{i=1}^{N_q}$ 为面积为 $\\tfrac{1}{2}$ 的参考三角形上的求积节点和权重，并将它们仿射映射到每个物理三角形。雅可比因子 $J = 2 A$ 必须乘以每个局部权重 $w_i$ 以考虑面积缩放。二重积分通过三角形求积的张量积来近似：\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i \\, J_p \\; w_j \\, J_q \\; G_k\\!\\big(\\mathbf{x}_p(\\xi_i,\\eta_i), \\mathbf{y}_q(\\xi_j,\\eta_j)\\big),\n$$\n其中 $J_p = 2 A_p$ 且 $J_q = 2 A_q$。\n- 为确保在存在弱奇点时的数值稳定性，引入一个小的正则化参数 $\\varepsilon > 0$，并在 $G_k$ 的分母中用 $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ 替换 $\\|\\mathbf{x}-\\mathbf{y}\\|$。这是一种算法正则化；请在推导中说明其可接受的原因。参数 $\\varepsilon$ 的单位是米 (m)。\n- 实现遍历所有三角形 $T_p$ 和 $T_q$ 的单元循环，在每个三角形上执行局部求积，并使用雅可比和基函数乘积来累加贡献。您必须包含使用张量积结构在求积节点上的累加。\n- 使用以下确定性的三角化曲面进行测试（坐标单位为米）：\n    - 三角形 $T_0$：顶点 $\\mathbf{a}_0 = (0,0,0)$，$\\mathbf{b}_0 = (1,0,0)$，$\\mathbf{c}_0 = (0,1,0)$。\n    - 三角形 $T_1$：顶点 $\\mathbf{a}_1 = (1,1,0)$，$\\mathbf{b}_1 = (0,1,0)$，$\\mathbf{c}_1 = (1,0,0)$。\n    - 三角形 $T_2$：顶点 $\\mathbf{a}_2 = (2,0.2,0.3)$，$\\mathbf{b}_2 = (2.4,0.1,0.4)$，$\\mathbf{c}_2 = (2.1,0.5,0.2)$。\n- 在参考三角形上使用重心求积法则：\n    - 1 阶：单个形心节点，重心坐标为 $(\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}\\right)$，权重为 $w = \\tfrac{1}{2}$。\n    - 3 阶：三个节点，分别位于 $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$、$(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$ 和 $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$，每个节点的权重为 $w = \\tfrac{1}{6}$。通过 $\\mathbf{x} = \\lambda_1 \\mathbf{a} + \\lambda_2 \\mathbf{b} + \\lambda_3 \\mathbf{c}$ 将重心坐标转换为笛卡尔坐标。\n\n您的程序必须为下面指定的每个测试案例组装 $3 \\times 3$ 矩阵 $V$，并计算其弗罗贝尼乌斯范数：\n$$\n\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}.\n$$\n\n测试套件（参数以元组 $(k, \\varepsilon, N_q)$ 的形式给出，其中 $k$ 的单位是弧度/米，$\\varepsilon$ 的单位是米，$N_q$ 表示如上定义的所选求积阶数）：\n- $(0.0, 10^{-6}, 3)$：$k=0$ 的拉普拉斯极限，小正则化，三点求积。\n- $(20.0, 10^{-6}, 3)$：中等波数，小正则化，三点求积。\n- $(60.0, 10^{-5}, 3)$：较高波数，稍大正则化，三点求积。\n- $(60.0, 5 \\times 10^{-2}, 1)$：较高波数，大正则化，仅形心求积。\n\n您的程序应生成单行输出，其中包含四个测试案例的 $V$ 矩阵的弗罗贝尼乌斯范数，形式为方括号括起来的逗号分隔列表（例如：$\"[r_1,r_2,r_3,r_4]\"$）。每个弗罗贝尼乌斯范数以立方米 ($\\mathrm{m}^3$) 表示。不允许有其他输出。\n\n您的推导必须说明 $V$ 矩阵是什么，为什么组装算法是正确的，以及它是如何从基本基础推导出来的。您的论证中必须明确包括单元循环、局部求积、雅可比缩放以及使用基函数乘积的累加。避免使用超出上述基础的简化公式。确保所有步骤和参数选择都具有科学真实性。",
            "solution": "该问题是有效的。它在科学上是合理的、适定的，并且为声学单层算子的伽辽金边界元法 (BEM) 矩阵的组装提供了所有必要的数据和定义。将按规定解决该问题。\n\n分析始于单层边界积分算子的伽辽金矩阵元素 $V_{pq}$ 的定义，该算子使用分片常数基函数进行离散。对于曲面网格 $\\Gamma$ 上的两个三角形 $T_p$ 和 $T_q$，矩阵元素由以下曲面二重积分给出：\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}}\n$$\n此处，$G_k(\\mathbf{x},\\mathbf{y})$ 是亥姆霍兹方程的自由空间格林函数，或称为基本解，它描述了时谐声波的传播。其表达式为：\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}\n$$\n其中 $k$ 是波数，单位为 $\\mathrm{rad/m}$，$\\mathbf{x}$ 和 $\\mathbf{y}$ 是 $\\mathbb{R}^3$ 中的点，且 $\\mathrm{i} = \\sqrt{-1}$。分片常数基函数在其各自的三角形上等于 $1$，在其他地方等于 $0$，它们不显式出现在积分中，但定义了积分的域。\n\n这个四维积分的直接计算是难以处理的。因此，使用数值求积来近似它。该过程涉及将物理三角形 $T_p$ 和 $T_q$ 映射到一个单一的参考三角形 $T_{ref}$。我们考虑对每个具有顶点 $\\mathbf{a}_p, \\mathbf{b}_p, \\mathbf{c}_p$ 的三角形 $T_p$ 使用一个仿射映射 $\\mathbf{x}_p(\\boldsymbol{\\xi}): T_{ref} \\to T_p$。问题指定使用重心坐标 $\\boldsymbol{\\lambda} = (\\lambda_1, \\lambda_2, \\lambda_3)$，其中 $\\lambda_1+\\lambda_2+\\lambda_3=1$，使得 $T_p$ 中的一个点 $\\mathbf{x}$ 由 $\\mathbf{x} = \\lambda_1 \\mathbf{a}_p + \\lambda_2 \\mathbf{b}_p + \\lambda_3 \\mathbf{c}_p$ 给出。在这种仿射变换下，曲面元变换为 $\\mathrm{d}S_{\\mathbf{x}} = J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}}$，其中 $J_p$ 是映射的常数雅可比行列式。该雅可比行列式等于物理三角形面积的两倍，即 $J_p = 2A_p$。面积 $A_p$ 计算为 $A_p = \\frac{1}{2} \\|(\\mathbf{b}_p - \\mathbf{a}_p) \\times (\\mathbf{c}_p - \\mathbf{a}_p)\\|$。\n\n因此，物理三角形 $T_p$ 上的曲面积分被转换为参考单元上的积分，然后通过在 $T_{ref}$ 上定义的求积法则 $\\{\\boldsymbol{\\lambda}_i, w_i\\}_{i=1}^{N_q}$ 来近似：\n$$\n\\int_{T_p} f(\\mathbf{x}) \\, \\mathrm{d}S_{\\mathbf{x}} = \\int_{T_{ref}} f(\\mathbf{x}_p(\\boldsymbol{\\lambda})) J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}} \\approx \\sum_{i=1}^{N_q} w_i J_p f(\\mathbf{x}_p(\\boldsymbol{\\lambda}_i))\n$$\n问题指定权重 $\\{w_i\\}$ 是为面积为 $\\frac{1}{2}$ 的参考三角形定义的，因此权重之和为 $\\sum_i w_i = \\frac{1}{2}$。\n\n为了计算 $V_{pq}$，我们将此近似过程顺序地应用于外层和内层积分。这产生了一个张量积求积法则：\n$$\nV_{pq} \\approx \\int_{T_p} \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}, \\mathbf{y}_{q,j}) \\right) \\mathrm{d}S_{\\mathbf{x}}\n$$\n其中 $\\mathbf{y}_{q,j}$ 是三角形 $T_q$ 上的物理求积点。将求积法则应用于剩余的 $T_p$ 上的积分，得到：\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} w_i J_p \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j}) \\right)\n$$\n这可以重新整理为最终的计算公式：\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} (w_i J_p) (w_j J_q) G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j})\n$$\n其中 $\\mathbf{x}_{p,i}$ 和 $\\mathbf{y}_{q,j}$ 分别是三角形 $T_p$ 和 $T_q$ 上的第 $i$ 个和第 $j$ 个物理求积点。\n\n核函数 $G_k(\\mathbf{x},\\mathbf{y})$ 在 $\\mathbf{x} \\to \\mathbf{y}$ 时具有 $1/\\|\\mathbf{x}-\\mathbf{y}\\|$ 的奇点。对于对角线元素 $V_{pp}$（重合三角形）或相邻三角形，此奇点可能导致标准求积法则失效。问题指定了一种算法正则化，即在 $G_k$ 的分母中用 $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ 替换 $\\|\\mathbf{x}-\\mathbf{y}\\|$。这限制了核函数的值，消除了奇点，并允许使用标准求积法则。这是入门级 BEM 实现中公认的一种简化方法，尽管它会引入一个依赖于 $\\varepsilon$ 值的建模误差。对于不接触的单元，如果 $\\varepsilon$ 小于它们之间的最小距离，则此正则化没有效果。\n\n组装算法如下：\n1. 对于每个三角形 $p \\in \\{0, 1, 2\\}$，计算其面积 $A_p$ 和雅可比行列式 $J_p = 2A_p$。\n2. 对于指定的求积阶数（1 或 3），检索重心坐标 $\\{\\boldsymbol{\\lambda}_i\\}$ 和权重 $\\{w_i\\}$。\n3. 对于每个三角形 $p$ 和每个节点 $i$，计算物理空间求积点 $\\mathbf{x}_{p,i}$。\n4. 初始化一个 $3 \\times 3$ 的复值矩阵 $V$ 为零。\n5. 遍历所有三角形对 $(p, q)$，其中 $p, q \\in \\{0, 1, 2\\}$。\n6. 对于每对 $(p, q)$，通过遍历所有求积点对 $(i, j)$ 来计算 $V_{pq}$：\n   a. 获取物理点 $\\mathbf{x} = \\mathbf{x}_{p,i}$ 和 $\\mathbf{y} = \\mathbf{y}_{q,j}$。\n   b. 使用参数 $\\varepsilon$ 计算正则化的格林函数 $G_k(\\mathbf{x}, \\mathbf{y})$。\n   c. 将贡献 $(w_i J_p)(w_j J_q)G_k(\\mathbf{x}, \\mathbf{y})$ 累加到 $V_{pq}$。\n7. 循环完成后，计算弗罗贝尼乌斯范数 $\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}$。\n\n$V_{pq}$ 的单位是 $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^2) \\cdot (\\mathrm{m}^2) = \\mathrm{m}^3$，因为 $G_k$ 的单位是 $1/\\text{长度}$，而两个曲面微分 $\\mathrm{d}S$ 的单位是 $\\text{长度}^2$。因此，弗罗贝尼乌斯范数 $\\|V\\|_F$ 的单位也是 $\\mathrm{m}^3$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norm of the Galerkin BEM matrix for the acoustic\n    single-layer operator for several test cases.\n    \"\"\"\n    \n    # Define the triangulated surface geometry\n    triangles = [\n        np.array([[0.0, 0.0, 0.0], [1.0, 0.0, 0.0], [0.0, 1.0, 0.0]]), # T_0\n        np.array([[1.0, 1.0, 0.0], [0.0, 1.0, 0.0], [1.0, 0.0, 0.0]]), # T_1\n        np.array([[2.0, 0.2, 0.3], [2.4, 0.1, 0.4], [2.1, 0.5, 0.2]])  # T_2\n    ]\n    num_triangles = len(triangles)\n\n    # Pre-compute geometric properties: areas and Jacobians\n    areas = np.zeros(num_triangles)\n    jacobians = np.zeros(num_triangles)\n    for i, tri in enumerate(triangles):\n        v1 = tri[1] - tri[0]  # Vector from vertex a to b\n        v2 = tri[2] - tri[0]  # Vector from vertex a to c\n        cross_product = np.cross(v1, v2)\n        area = 0.5 * np.linalg.norm(cross_product)\n        areas[i] = area\n        jacobians[i] = 2.0 * area # Jacobian is 2 * Area\n\n    # Define barycentric quadrature rules for a reference triangle of area 0.5\n    # Format: {order: (barycentric_coordinates, weights)}\n    quad_rules = {\n        1: (np.array([[1/3, 1/3, 1/3]]), np.array([0.5])),\n        3: (np.array([[0.5, 0.5, 0.0], [0.5, 0.0, 0.5], [0.0, 0.5, 0.5]]), \n            np.array([1/6, 1/6, 1/6]))\n    }\n\n    # Test suite: (k, epsilon, quadrature_order)\n    test_cases = [\n        (0.0, 1e-6, 3),\n        (20.0, 1e-6, 3),\n        (60.0, 1e-5, 3),\n        (60.0, 5e-2, 1)\n    ]\n\n    results = []\n\n    def green_function(x_point, y_point, k, eps):\n        \"\"\"Computes the regularized Helmholtz Green's function.\"\"\"\n        dist = np.linalg.norm(x_point - y_point)\n        # Regularization: denominator is max(dist, eps)\n        reg_dist = max(dist, eps)\n        denominator = 4.0 * np.pi * reg_dist\n        \n        if k == 0.0: # Laplace case\n            return 1.0 / denominator\n        else: # Helmholtz case\n            return np.exp(1j * k * dist) / denominator\n\n    for k_val, eps_val, quad_order in test_cases:\n        bary_coords, weights = quad_rules[quad_order]\n        num_quad_points = len(weights)\n        \n        # Pre-compute physical quadrature points for all triangles\n        physical_quad_points = np.zeros((num_triangles, num_quad_points, 3))\n        for i in range(num_triangles):\n            verts = triangles[i]\n            for j in range(num_quad_points):\n                # Map barycentric coords to physical coords: x = l1*a + l2*b + l3*c\n                physical_quad_points[i, j, :] = (bary_coords[j, 0] * verts[0] +\n                                                 bary_coords[j, 1] * verts[1] +\n                                                 bary_coords[j, 2] * verts[2])\n\n        # Initialize the Galerkin matrix V\n        V = np.zeros((num_triangles, num_triangles), dtype=np.complex128)\n\n        # Assemble the matrix V\n        for p in range(num_triangles):\n            for q in range(num_triangles):\n                vpq_val = 0.0 + 0.0j\n                # Double-loop over quadrature points (tensor product)\n                for i in range(num_quad_points):\n                    for j in range(num_quad_points):\n                        x_pi = physical_quad_points[p, i]\n                        y_qj = physical_quad_points[q, j]\n                        \n                        g_k = green_function(x_pi, y_qj, k_val, eps_val)\n                        \n                        # Accumulate contribution to V_pq\n                        weight_prod = (weights[i] * jacobians[p] * \n                                       weights[j] * jacobians[q])\n                        vpq_val += weight_prod * g_k\n                \n                V[p, q] = vpq_val\n\n        # Calculate and store the Frobenius norm of V\n        norm_f = np.linalg.norm(V, 'fro')\n        results.append(norm_f)\n\n    # Final print statement in the exact required format\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]}]\")\n\nsolve()\n```"
        }
    ]
}