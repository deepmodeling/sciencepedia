{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Boundary Element Method lies in transforming continuous integral equations into a discrete system of linear equations. This first practice provides a direct, hands-on experience in building the system matrix, specifically the Galerkin matrix for the single-layer potential operator, denoted as $V$. By following the steps to implement the assembly algorithm , you will translate the abstract double integral into a concrete computational routine involving nested loops, quadrature rules, and geometric transformations, solidifying your understanding of how BEM is realized in code.",
            "id": "4118364",
            "problem": "You are to implement and reason about a Galerkin Boundary Element Method (BEM) assembly for the acoustic single-layer operator over a triangulated surface. The governing partial differential equation is the Helmholtz equation for time-harmonic acoustics, which in homogeneous free space reads $-\\Delta u - k^2 u = 0$ in $\\mathbb{R}^3 \\setminus \\Gamma$, where $\\Gamma$ is a smooth surface. The free-space Green's function for the Helmholtz equation is $G_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}$, where $k$ is the wavenumber, expressed in radians per meter (rad/m). The Galerkin discretization of the single-layer boundary integral operator builds the matrix $V$ whose entries are surface double integrals of the kernel weighted by the basis functions.\n\nStart from the following fundamental base:\n- The Helmholtz equation $-\\Delta u - k^2 u = 0$ and its free-space Green's function $G_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}$.\n- The Galerkin method with piecewise-constant basis functions per triangle element, so that the basis function associated with triangle $T_p$ is $1$ on $T_p$ and $0$ elsewhere.\n- The reference triangle with coordinates $(\\xi,\\eta)$ and area $\\tfrac{1}{2}$, and an affine mapping to a physical triangle with vertices $\\mathbf{a}$, $\\mathbf{b}$, and $\\mathbf{c}$, under which the surface Jacobian determinant is constant and equal to $J = 2 A$, where $A$ is the area of the physical triangle.\n\nYou must derive and implement the assembly algorithm for the Galerkin $V$ matrix with the following requirements:\n- The matrix entries are defined by\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}},\n$$\nfor triangles $T_p$ and $T_q$ on a triangulated surface. Use piecewise-constant basis functions, so there are no additional basis factors beyond the constant $1$ on each triangle.\n- Use local quadrature rules on the reference triangle to approximate each surface integral. Specifically, let $\\{(\\xi_i,\\eta_i), w_i\\}_{i=1}^{N_q}$ be quadrature nodes and weights on the reference triangle, which has area $\\tfrac{1}{2}$, and map them affinely to each physical triangle. The Jacobian factor $J = 2 A$ must multiply each local weight $w_i$ to account for the area scaling. The double integral is to be approximated by a tensor-product of the triangular quadrature:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i \\, J_p \\; w_j \\, J_q \\; G_k\\!\\big(\\mathbf{x}_p(\\xi_i,\\eta_i), \\mathbf{y}_q(\\xi_j,\\eta_j)\\big),\n$$\nwhere $J_p = 2 A_p$ and $J_q = 2 A_q$.\n- To ensure numerical stability in the presence of weak singularities, introduce a small regularization parameter $\\varepsilon > 0$ and replace $\\|\\mathbf{x}-\\mathbf{y}\\|$ by $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ in the denominator of $G_k$. This is an algorithmic regularization; justify why it is acceptable in the derivation. The parameter $\\varepsilon$ has units of meters (m).\n- Implement the element loops that iterate over all triangles $T_p$ and $T_q$, perform local quadrature on each, and accumulate contributions using the Jacobian and basis products. You must include the accumulation over quadrature nodes with the tensor-product structure.\n- Use the following deterministic triangulated surface for testing (coordinates in meters):\n    - Triangle $T_0$: vertices $\\mathbf{a}_0 = (0,0,0)$, $\\mathbf{b}_0 = (1,0,0)$, $\\mathbf{c}_0 = (0,1,0)$.\n    - Triangle $T_1$: vertices $\\mathbf{a}_1 = (1,1,0)$, $\\mathbf{b}_1 = (0,1,0)$, $\\mathbf{c}_1 = (1,0,0)$.\n    - Triangle $T_2$: vertices $\\mathbf{a}_2 = (2,0.2,0.3)$, $\\mathbf{b}_2 = (2.4,0.1,0.4)$, $\\mathbf{c}_2 = (2.1,0.5,0.2)$.\n- Use barycentric quadrature rules on the reference triangle:\n    - For order $1$: a single centroid node with barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}\\right)$ and weight $w = \\tfrac{1}{2}$.\n    - For order $3$: three nodes at $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$, $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$, and $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$, each with weight $w = \\tfrac{1}{6}$. Convert barycentric coordinates to Cartesian coordinates via $\\mathbf{x} = \\lambda_1 \\mathbf{a} + \\lambda_2 \\mathbf{b} + \\lambda_3 \\mathbf{c}$.\n\nYour program must assemble the $3 \\times 3$ matrix $V$ for each test case specified below and compute its Frobenius norm:\n$$\n\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}.\n$$\n\nTest suite (parameters given as tuples $(k, \\varepsilon, N_q)$ where $k$ is in radians per meter, $\\varepsilon$ in meters, and $N_q$ denotes the chosen quadrature order as defined above):\n- $(0.0, 10^{-6}, 3)$: the Laplace limit with $k = 0$, small regularization, three-point quadrature.\n- $(20.0, 10^{-6}, 3)$: moderate wavenumber, small regularization, three-point quadrature.\n- $(60.0, 10^{-5}, 3)$: higher wavenumber, slightly larger regularization, three-point quadrature.\n- $(60.0, 5 \\times 10^{-2}, 1)$: higher wavenumber, large regularization, centroid-only quadrature.\n\nYour program should produce a single line of output containing the Frobenius norms of $V$ for the four test cases as a comma-separated list enclosed in square brackets (e.g., $\"[r_1,r_2,r_3,r_4]\"$). Express each Frobenius norm in meters cubed ($\\mathrm{m}^3$). No other output is permitted.\n\nYour derivation must show what the $V$ matrix is, why the assembly algorithm is correct, and how it is derived from the fundamental base. You must explicitly include the element loops, local quadrature, Jacobian scaling, and accumulation with basis products in your reasoning. Avoid shortcut formulas beyond the base stated above. Ensure scientific realism in all steps and parameter choices.",
            "solution": "The problem is valid. It is scientifically sound, well-posed, and all necessary data and definitions are provided for the assembly of the Galerkin Boundary Element Method (BEM) matrix for the acoustic single-layer operator. The problem will be solved as stated.\n\nThe analysis begins with the definition of the Galerkin matrix entries $V_{pq}$ for the single-layer boundary integral operator, discretized with piecewise-constant basis functions. For two triangles, $T_p$ and $T_q$, on a surface mesh $\\Gamma$, a matrix entry is given by the double surface integral:\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}}\n$$\nHere, $G_k(\\mathbf{x},\\mathbf{y})$ is the free-space Green's function, or fundamental solution, for the Helmholtz equation, which describes time-harmonic acoustic wave propagation. It is given by:\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}\n$$\nwhere $k$ is the wavenumber in $\\mathrm{rad/m}$, $\\mathbf{x}$ and $\\mathbf{y}$ are points in $\\mathbb{R}^3$, and $\\mathrm{i} = \\sqrt{-1}$. The piecewise-constant basis functions, being equal to $1$ on their respective triangles and $0$ elsewhere, do not appear explicitly in the integral but define its domain.\n\nThe direct evaluation of this four-dimensional integral is intractable. Therefore, it is approximated using numerical quadrature. The process involves mapping the physical triangles $T_p$ and $T_q$ to a single reference triangle, $T_{ref}$. We consider an affine map $\\mathbf{x}_p(\\boldsymbol{\\xi}): T_{ref} \\to T_p$ for each triangle $T_p$ with vertices $\\mathbf{a}_p, \\mathbf{b}_p, \\mathbf{c}_p$. The problem specifies using barycentric coordinates $\\boldsymbol{\\lambda} = (\\lambda_1, \\lambda_2, \\lambda_3)$ where $\\lambda_1+\\lambda_2+\\lambda_3=1$, such that a point $\\mathbf{x} \\in T_p$ is given by $\\mathbf{x} = \\lambda_1 \\mathbf{a}_p + \\lambda_2 \\mathbf{b}_p + \\lambda_3 \\mathbf{c}_p$. Under this affine transformation, the differential surface element transforms as $\\mathrm{d}S_{\\mathbf{x}} = J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}}$, where $J_p$ is the constant Jacobian determinant of the map. This Jacobian is equal to twice the area of the physical triangle, $J_p = 2A_p$. The area $A_p$ is calculated as $A_p = \\frac{1}{2} \\|(\\mathbf{b}_p - \\mathbf{a}_p) \\times (\\mathbf{c}_p - \\mathbf{a}_p)\\|$.\n\nA surface integral over a physical triangle $T_p$ is thus transformed into an integral over the reference element, which is then approximated by a quadrature rule $\\{\\boldsymbol{\\lambda}_i, w_i\\}_{i=1}^{N_q}$ defined on $T_{ref}$:\n$$\n\\int_{T_p} f(\\mathbf{x}) \\, \\mathrm{d}S_{\\mathbf{x}} = \\int_{T_{ref}} f(\\mathbf{x}_p(\\boldsymbol{\\lambda})) J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}} \\approx \\sum_{i=1}^{N_q} w_i J_p f(\\mathbf{x}_p(\\boldsymbol{\\lambda}_i))\n$$\nThe problem specifies that the weights $\\{w_i\\}$ are defined for a reference triangle of area $\\frac{1}{2}$, so the sum of the weights $\\sum_i w_i = \\frac{1}{2}$.\n\nTo evaluate $V_{pq}$, we apply this approximation process sequentially to the outer and inner integrals. This results in a tensor-product quadrature rule:\n$$\nV_{pq} \\approx \\int_{T_p} \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}, \\mathbf{y}_{q,j}) \\right) \\mathrm{d}S_{\\mathbf{x}}\n$$\nwhere $\\mathbf{y}_{q,j}$ are the physical quadrature points on triangle $T_q$. Applying the quadrature rule to the remaining integral over $T_p$ yields:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} w_i J_p \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j}) \\right)\n$$\nThis can be rearranged into the final computational formula:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} (w_i J_p) (w_j J_q) G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j})\n$$\nwhere $\\mathbf{x}_{p,i}$ and $\\mathbf{y}_{q,j}$ are the $i$-th and $j$-th physical quadrature points on triangles $T_p$ and $T_q$, respectively.\n\nThe kernel $G_k(\\mathbf{x},\\mathbf{y})$ has a $1/\\|\\mathbf{x}-\\mathbf{y}\\|$ singularity as $\\mathbf{x} \\to \\mathbf{y}$. For diagonal entries $V_{pp}$ (coincident triangles) or adjacent triangles, this singularity can cause standard quadrature rules to fail. The problem specifies an algorithmic regularization by replacing $\\|\\mathbf{x}-\\mathbf{y}\\|$ with $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ in the denominator of $G_k$. This bounds the value of the kernel, removing the singularity and allowing the use of a standard quadrature rule. This is an accepted simplification for introductory BEM implementations, though it introduces a modeling error dependent on the value of $\\varepsilon$. For non-touching elements, if $\\varepsilon$ is smaller than the minimum distance between them, this regularization has no effect.\n\nThe assembly algorithm is as follows:\n1. For each triangle $p \\in \\{0, 1, 2\\}$, compute its area $A_p$ and Jacobian $J_p = 2A_p$.\n2. For the specified quadrature order ($1$ or $3$), retrieve the barycentric coordinates $\\{\\boldsymbol{\\lambda}_i\\}$ and weights $\\{w_i\\}$.\n3. For each triangle $p$ and each node $i$, compute the physical-space quadrature point $\\mathbf{x}_{p,i}$.\n4. Initialize a $3 \\times 3$ complex-valued matrix $V$ to zeros.\n5. Iterate through all triangle pairs $(p, q)$, where $p, q \\in \\{0, 1, 2\\}$.\n6. For each pair $(p, q)$, compute $V_{pq}$ by iterating through all quadrature point pairs $(i, j)$:\n   a. Retrieve the physical points $\\mathbf{x} = \\mathbf{x}_{p,i}$ and $\\mathbf{y} = \\mathbf{y}_{q,j}$.\n   b. Compute the regularized Green's function $G_k(\\mathbf{x}, \\mathbf{y})$ using the parameter $\\varepsilon$.\n   c. Add the contribution $(w_i J_p)(w_j J_q)G_k(\\mathbf{x}, \\mathbf{y})$ to $V_{pq}$.\n7. After the loops complete, compute the Frobenius norm $\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}$.\n\nThe units of $V_{pq}$ are $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^2) \\cdot (\\mathrm{m}^2) = \\mathrm{m}^3$, as $G_k$ has units of $1/\\text{length}$ and the two surface differentials $\\mathrm{d}S$ have units of $\\text{length}^2$. Consequently, the Frobenius norm $\\|V\\|_F$ also has units of $\\mathrm{m}^3$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norm of the Galerkin BEM matrix for the acoustic\n    single-layer operator for several test cases.\n    \"\"\"\n    \n    # Define the triangulated surface geometry\n    triangles = [\n        np.array([[0.0, 0.0, 0.0], [1.0, 0.0, 0.0], [0.0, 1.0, 0.0]]), # T_0\n        np.array([[1.0, 1.0, 0.0], [0.0, 1.0, 0.0], [1.0, 0.0, 0.0]]), # T_1\n        np.array([[2.0, 0.2, 0.3], [2.4, 0.1, 0.4], [2.1, 0.5, 0.2]])  # T_2\n    ]\n    num_triangles = len(triangles)\n\n    # Pre-compute geometric properties: areas and Jacobians\n    areas = np.zeros(num_triangles)\n    jacobians = np.zeros(num_triangles)\n    for i, tri in enumerate(triangles):\n        v1 = tri[1] - tri[0]  # Vector from vertex a to b\n        v2 = tri[2] - tri[0]  # Vector from vertex a to c\n        cross_product = np.cross(v1, v2)\n        area = 0.5 * np.linalg.norm(cross_product)\n        areas[i] = area\n        jacobians[i] = 2.0 * area # Jacobian is 2 * Area\n\n    # Define barycentric quadrature rules for a reference triangle of area 0.5\n    # Format: {order: (barycentric_coordinates, weights)}\n    quad_rules = {\n        1: (np.array([[1/3, 1/3, 1/3]]), np.array([0.5])),\n        3: (np.array([[0.5, 0.5, 0.0], [0.5, 0.0, 0.5], [0.0, 0.5, 0.5]]), \n            np.array([1/6, 1/6, 1/6]))\n    }\n\n    # Test suite: (k, epsilon, quadrature_order)\n    test_cases = [\n        (0.0, 1e-6, 3),\n        (20.0, 1e-6, 3),\n        (60.0, 1e-5, 3),\n        (60.0, 5e-2, 1)\n    ]\n\n    results = []\n\n    def green_function(x_point, y_point, k, eps):\n        \"\"\"Computes the regularized Helmholtz Green's function.\"\"\"\n        dist = np.linalg.norm(x_point - y_point)\n        # Regularization: denominator is max(dist, eps)\n        reg_dist = max(dist, eps)\n        denominator = 4.0 * np.pi * reg_dist\n        \n        if k == 0.0: # Laplace case\n            return 1.0 / denominator\n        else: # Helmholtz case\n            return np.exp(1j * k * dist) / denominator\n\n    for k_val, eps_val, quad_order in test_cases:\n        bary_coords, weights = quad_rules[quad_order]\n        num_quad_points = len(weights)\n        \n        # Pre-compute physical quadrature points for all triangles\n        physical_quad_points = np.zeros((num_triangles, num_quad_points, 3))\n        for i in range(num_triangles):\n            verts = triangles[i]\n            for j in range(num_quad_points):\n                # Map barycentric coords to physical coords: x = l1*a + l2*b + l3*c\n                physical_quad_points[i, j, :] = (bary_coords[j, 0] * verts[0] +\n                                                 bary_coords[j, 1] * verts[1] +\n                                                 bary_coords[j, 2] * verts[2])\n\n        # Initialize the Galerkin matrix V\n        V = np.zeros((num_triangles, num_triangles), dtype=np.complex128)\n\n        # Assemble the matrix V\n        for p in range(num_triangles):\n            for q in range(num_triangles):\n                vpq_val = 0.0 + 0.0j\n                # Double-loop over quadrature points (tensor product)\n                for i in range(num_quad_points):\n                    for j in range(num_quad_points):\n                        x_pi = physical_quad_points[p, i]\n                        y_qj = physical_quad_points[q, j]\n                        \n                        g_k = green_function(x_pi, y_qj, k_val, eps_val)\n                        \n                        # Accumulate contribution to V_pq\n                        weight_prod = (weights[i] * jacobians[p] * \n                                       weights[j] * jacobians[q])\n                        vpq_val += weight_prod * g_k\n                \n                V[p, q] = vpq_val\n\n        # Calculate and store the Frobenius norm of V\n        norm_f = np.linalg.norm(V, 'fro')\n        results.append(norm_f)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust BEM implementation requires more than just a basic assembly loop; it demands accurate evaluation of integrals whose kernels can be challenging. This is especially true for 'near-singular' integrals, which arise when the observation point is close to, but not on, the integration patch. This practice  challenges you to analyze why standard quadrature methods fail in this scenario and to identify the sophisticated, industry-standard strategies like coordinate transformation and adaptive refinement that are essential for achieving reliable, high-fidelity acoustic simulations.",
            "id": "4118338",
            "problem": "In computational acoustics, consider the exterior Helmholtz problem for a sound-hard scatterer with outward unit normal field, where the acoustic pressure $p$ satisfies the Helmholtz equation with wave number $k$, and is represented via a boundary integral using the fundamental solution of the Helmholtz operator. In the Boundary Element Method (BEM), both the collocation form and the Galerkin form require accurate evaluation of surface integrals whose kernels are weakly singular or nearly singular. Focus on the single-layer potential for a smooth surface element $\\Gamma_{e}$ parameterized by a local chart $(u,v) \\mapsto \\mathbf{y}(u,v)$, with area element $d\\Gamma = \\left\\lVert \\partial_{u} \\mathbf{y} \\times \\partial_{v} \\mathbf{y} \\right\\rVert \\, du \\, dv$. The integral to be evaluated at a target point $\\mathbf{x}$ not on $\\Gamma_{e}$ is\n$$\nU(\\mathbf{x}) = \\int_{\\Gamma_{e}} G_{k}(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, d\\Gamma,\n$$\nwhere $G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$ in three spatial dimensions and $\\sigma$ is a smooth density. Suppose $\\mathbf{x}$ is close to $\\Gamma_{e}$ in the sense that its signed normal distance to the closest point $\\mathbf{y}_{0} \\in \\Gamma_{e}$ is a small parameter $\\delta > 0$, but $\\mathbf{x} \\notin \\Gamma_{e}$.\n\nStarting from the fundamental solution $G_{k}$ and the definition of the surface measure, analyze the local structure of the integrand near the closest point $\\mathbf{y}_{0}$ and explain why standard tensor-product Gaussian quadrature in $(u,v)$ exhibits large error as $\\delta \\to 0$ if used without any special treatment. Then, based on first principles, select the strategy or strategies that correctly regularize or resolve the near-singular behavior and deliver high-order accuracy uniformly for targets with $\\delta$ as small as the element size, in both collocation and Galerkin BEM settings.\n\nWhich options are correct?\n\nA. Introduce a local polar blow-up in parameter space centered at the closest chart point $(u_{0},v_{0})$ mapping $(u,v)$ to $(\\rho,\\theta)$ via $(u,v) = (u_{0},v_{0}) + \\rho \\, \\mathbf{t}(\\theta)$ with $\\mathbf{t}(\\theta)$ spanning the tangent plane at $\\mathbf{y}_{0}$, and then apply a radial reparameterization $\\rho = s^{2}$; integrate in $(s,\\theta)$ using high-order product Gaussian rules so that the Jacobian factor cancels the $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert$ peak and yields a smooth integrand in $s$.\n\nB. Keep the original $(u,v)$ parameterization and simply increase the degree and number of Gaussian nodes uniformly over $\\Gamma_{e}$; this will eventually converge and is thus sufficient for controlling the near-singular quadrature error as $\\delta \\to 0$.\n\nC. Perform adaptive refinement by subdividing $\\Gamma_{e}$ into graded subpanels that cluster geometrically toward $(u_{0},v_{0})$ so that the smallest subpanel diameters scale like $\\mathcal{O}(\\delta)$; apply standard Gaussian quadrature on each subpanel, choosing a grading exponent that balances the local $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert$ behavior to achieve uniform high-order accuracy.\n\nD. Replace the kernel $G_{k}(\\mathbf{x},\\mathbf{y})$ by the constant $G_{k}(\\mathbf{x},\\mathbf{y}_{0})$ over $\\Gamma_{e}$ to remove the near-singular peak, and integrate the resulting constant-kernel integral with standard Gaussian quadrature.\n\nE. Use Filon-type quadrature tuned to the oscillatory factor $e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$ directly in $(u,v)$ without any local blow-up or mesh refinement, since the principal difficulty is the oscillation rather than the near-singularity.",
            "solution": "The problem statement describes the numerical evaluation of a single-layer potential integral arising in the Boundary Element Method (BEM) for the exterior Helmholtz problem. The core challenge is the accurate computation of the integral when the evaluation point $\\mathbf{x}$ is close to the integration surface element $\\Gamma_e$, but not on it. This situation is known as near-singular integration.\n\n### Step 1: Extract Givens\n\n-   **Problem Domain:** Computational acoustics, exterior Helmholtz problem.\n-   **Method:** Boundary Element Method (BEM), specifically collocation and Galerkin forms.\n-   **Integral:** Single-layer potential, $U(\\mathbf{x}) = \\int_{\\Gamma_{e}} G_{k}(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, d\\Gamma$.\n-   **Kernel:** $3$D Helmholtz fundamental solution, $G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$.\n-   **Surface Element:** $\\Gamma_e$, a smooth element parameterized by $\\mathbf{y}(u,v)$ with area element $d\\Gamma = J(u,v) \\, du \\, dv$, where $J(u,v) = \\left\\lVert \\partial_{u} \\mathbf{y} \\times \\partial_{v} \\mathbf{y} \\right\\rVert$.\n-   **Density:** $\\sigma(\\mathbf{y})$ is a smooth function.\n-   **Target Point Configuration:** $\\mathbf{x} \\notin \\Gamma_e$. The closest point on $\\Gamma_e$ to $\\mathbf{x}$ is $\\mathbf{y}_{0}$. The signed normal distance is $\\delta > 0$, and $\\delta$ is a small parameter.\n-   **Primary Task:** Explain the failure of standard Gaussian quadrature as $\\delta \\to 0$ and identify correct regularization strategies that achieve uniform high-order accuracy.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is scientifically sound and well-posed.\n-   **Scientific Grounding:** The problem is a standard, critical topic in the numerical analysis of boundary integral equations. The Helmholtz equation, its fundamental solution, and the formulation of layer potentials are all cornerstone concepts in acoustics and wave propagation. The challenge of evaluating nearly singular integrals is a well-documented and fundamental issue in the implementation of BEM. All presented concepts are factually and mathematically correct.\n-   **Well-Posedness:** The problem is clearly defined. It asks for an analysis of a numerical method's failure and the identification of valid correction strategies from a given list. The setup provides sufficient information to analyze the local behavior of the integrand. The term \"high-order accuracy uniformly\" has a precise meaning in numerical analysis, implying that the convergence rate is independent of the small parameter $\\delta$.\n-   **Objectivity:** The language is technical, precise, and free of subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. The setup is consistent, scientifically grounded, and well-posed. I will now proceed with the derivation and evaluation.\n\n### Derivation and Option Analysis\n\n**Analysis of Standard Quadrature Failure**\n\nLet $\\mathbf{y}_{0} = \\mathbf{y}(u_0, v_0)$ be the unique closest point on the smooth surface element $\\Gamma_e$ to the target point $\\mathbf{x}$. By definition, the vector $\\mathbf{x} - \\mathbf{y}_0$ is orthogonal to the tangent plane of $\\Gamma_e$ at $\\mathbf{y}_0$. We can write $\\mathbf{x} = \\mathbf{y}_{0} + \\delta \\mathbf{n}(\\mathbf{y}_0)$, where $\\mathbf{n}$ is the unit normal vector and $\\delta > 0$ is the distance.\n\nFor a point $\\mathbf{y} \\in \\Gamma_e$ near $\\mathbf{y}_0$, we can approximate the distance vector $\\mathbf{y} - \\mathbf{y}_0$ by its projection onto the tangent plane at $\\mathbf{y}_0$. Let $(u,v)$ be the local parameters for $\\Gamma_e$. Let $\\mathbf{t}_u = \\partial_u \\mathbf{y}$ and $\\mathbf{t}_v = \\partial_v \\mathbf{y}$ be the tangent vectors at $(u_0, v_0)$. For small $\\Delta u = u-u_0$ and $\\Delta v = v - v_0$, we have the Taylor expansion:\n$$\n\\mathbf{y}(u,v) \\approx \\mathbf{y}_0 + \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v\n$$\nThe vector from $\\mathbf{x}$ to $\\mathbf{y}$ is then:\n$$\n\\mathbf{x} - \\mathbf{y} \\approx (\\mathbf{y}_0 + \\delta\\mathbf{n}) - (\\mathbf{y}_0 + \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v) = \\delta\\mathbf{n} - (\\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v)\n$$\nSince $\\mathbf{n}$ is orthogonal to the tangent vectors $\\mathbf{t}_u$ and $\\mathbf{t}_v$, the squared distance is:\n$$\n\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert^2 \\approx \\delta^2 + \\left\\lVert \\mathbf{t}_u \\Delta u + \\mathbf{t}_v \\Delta v \\right\\rVert^2 = \\delta^2 + g_{uu}(\\Delta u)^2 + 2g_{uv}\\Delta u \\Delta v + g_{vv}(\\Delta v)^2\n$$\nwhere $g_{ij}$ are the components of the first fundamental form (metric tensor) at $\\mathbf{y}_0$. The quadratic form represents the squared geodesic distance $r^2$ from $\\mathbf{y}_0$ to $\\mathbf{y}$ on the surface. Thus, locally, $\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert \\approx \\sqrt{\\delta^2 + r^2}$.\n\nThe integrand contains the term $1/\\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert \\approx (\\delta^2+r^2)^{-1/2}$. As $\\delta \\to 0$, this function develops a sharp peak of height $1/\\delta$ at $r=0$. Standard Gaussian quadrature relies on approximating the integrand by a polynomial. For an $N$-point rule, this approximation is accurate only if the integrand's derivatives of order $2N$ are small. Let's inspect the derivatives of the kernel with respect to a parameter coordinate, say $u$, which is related to $r$.\n$$\n\\frac{\\partial}{\\partial r} \\left( \\frac{1}{\\sqrt{\\delta^2+r^2}} \\right) = -r(\\delta^2+r^2)^{-3/2}\n$$\nThe magnitude of this derivative peaks near $r=\\delta/\\sqrt{2}$, where it scales as $\\mathcal{O}(\\delta^{-2})$. Higher-order derivatives exhibit even stronger blow-up behavior, scaling as $\\mathcal{O}(\\delta^{-n-1})$ for the $n$-th derivative. Since polynomial approximation theory requires bounded derivatives for good performance, any fixed-order Gaussian quadrature rule will produce errors that grow unboundedly as $\\delta \\to 0$. This explains the failure of standard tensor-product Gaussian quadrature.\n\n**Option-by-Option Analysis**\n\n**A. Introduce a local polar blow-up in parameter space...**\nThis option describes a coordinate transformation method, a sophisticated and correct approach.\n1.  **Local Polar Blow-up**: Changing from Cartesian coordinates $(u,v)$ in the parameter plane to polar coordinates $(\\rho,\\theta)$ centered at $(u_0, v_0)$ is the first step. The measure becomes $du\\,dv = \\rho\\,d\\rho\\,d\\theta$. The distance $r$ on the surface is approximately proportional to $\\rho$ near $(u_0, v_0)$. The integrand's near-singular part becomes proportional to $\\frac{\\rho}{\\sqrt{\\delta^2+c\\rho^2}}$ for some constant $c>0$. This function is bounded but has a boundary layer: its derivative with respect to $\\rho$ at $\\rho=0$ is proportional to $1/\\delta$ and is thus not uniformly bounded.\n2.  **Radial Reparameterization**: A second, non-linear transformation of the radial coordinate is applied: $\\rho = s^2$. The differential becomes $d\\rho = 2s\\,ds$. The full transformation is from $(u,v)$ to $(s,\\theta)$, and the Jacobian determinant of the mapping from $(s,\\theta)$ to $(u,v)$ is $2s^3$ up to a scaling factor from the metric. The kernel's behavior is $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert \\approx 1/\\sqrt{\\delta^2 + c(s^2)^2} = 1/\\sqrt{\\delta^2+cs^4}$.\n3.  **Resulting Integrand**: The radial part of the integral now involves a term like $\\frac{1}{\\sqrt{\\delta^2+cs^4}} \\times (\\text{smooth functions}) \\times (2s^3\\,ds)$. The key function to analyze is $f(s) = \\frac{s^3}{\\sqrt{\\delta^2+cs^4}}$. This function is smooth (infinitely differentiable) in $s$ at $s=0$, and all its derivatives are bounded uniformly with respect to $\\delta \\ge 0$. For instance, $f(0)=0$ and $f'(0)=0$. This process, known as regularization, transforms the near-singular integrand into a smooth function in the new coordinates $(s, \\theta)$. Standard tensor-product Gaussian quadrature can then be applied in $(s, \\theta)$ to achieve high-order accuracy with a fixed number of points, uniformly in $\\delta$. The phrase \"Jacobian factor cancels the [...] peak\" is a slightly informal but conceptually acceptable description of how the new integration measure regularizes the integrand. This option describes a valid and powerful strategy known in the literature (e.g., related to Sauter-Schwab quadratures).\n**Verdict: Correct**\n\n**B. Keep the original $(u,v)$ parameterization and simply increase the degree and number of Gaussian nodes...**\nAs established in the analysis, for any fixed number of quadrature points $N$, one can find a $\\delta > 0$ small enough to make the quadrature error unacceptably large. To maintain a constant level of accuracy as $\\delta \\to 0$, the number of points $N$ must increase, often as $N \\propto 1/\\delta$. This is computationally inefficient and fails the requirement of achieving \"high-order accuracy uniformly\" for a fixed computational cost. This brute-force approach is not considered a \"special treatment\" in the sense of a robust numerical algorithm.\n**Verdict: Incorrect**\n\n**C. Perform adaptive refinement by subdividing $\\Gamma_{e}$ into graded subpanels...**\nThis option describes an alternative, geometry-based strategy. The core idea is to resolve the sharp peak of the integrand by refining the mesh in the problematic region.\n1.  **Adaptive Subdivision**: The element $\\Gamma_e$ is recursively divided into smaller subpanels.\n2.  **Grading**: The refinement is not uniform. The subpanels are made progressively smaller near the projection point $\\mathbf{y}_0$. The condition that the smallest subpanels (those closest to $\\mathbf{y}_0$) have diameters scaling like $\\mathcal{O}(\\delta)$ is key.\n3.  **Mechanism**: On a subpanel of size $h$, located at a distance $d$ from $\\mathbf{y}_0$, the distance to the target point $\\mathbf{x}$ is approximately $\\sqrt{\\delta^2+d^2}$. The relative variation of the kernel across this subpanel is controlled by the ratio $h/\\sqrt{\\delta^2+d^2}$. By ensuring this ratio remains small everywhere (which the geometric grading achieves, especially for panels near $\\mathbf{y}_0$ where $d \\approx 0$ and we choose $h \\sim \\delta$), the integrand becomes well-approximated by a low-degree polynomial on each subpanel. Standard Gaussian quadrature can then be applied on each subpanel with high accuracy. The \"grading exponent\" controls how fast the panel sizes increase away from the refinement center, balancing accuracy and computational cost. This is a well-established, correct, and robust method.\n**Verdict: Correct**\n\n**D. Replace the kernel $G_{k}(\\mathbf{x},\\mathbf{y})$ by the constant $G_{k}(\\mathbf{x},\\mathbf{y}_{0})$ over $\\Gamma_{e}$...**\nThis is a very crude approximation. The function $G_{k}(\\mathbf{x},\\mathbf{y})$ has a sharp peak at $\\mathbf{y}_0$ and decays away from it. Replacing the function over the entire element with its maximum value (ignoring the phase for a moment), $1/(4\\pi\\delta)$, will grossly overestimate the contribution from parts of the element far from $\\mathbf{y}_0$. This corresponds to a zero-order approximation (a midpoint rule for the entire element if $\\mathbf{y}_0$ projects to the center). It cannot possibly deliver \"high-order accuracy\".\n**Verdict: Incorrect**\n\n**E. Use Filon-type quadrature tuned to the oscillatory factor...**\nThis option misidentifies the primary source of difficulty. The problem focuses on the limit $\\delta \\to 0$. In this limit, the dominant numerical challenge is the algebraic near-singularity $1/\\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert \\sim 1/\\delta$. Filon-type quadrature is designed to handle highly oscillatory integrals, i.e., when the wave number $k$ is large. While the Helmholtz kernel is oscillatory, Filon methods are designed to approximate the *amplitude* function with a polynomial. Here, the amplitude function is $\\frac{\\sigma(\\mathbf{y})}{4\\pi \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert}$, which is exactly the function that is not smooth and causes standard quadrature to fail. Applying a Filon method directly without addressing the near-singularity of the amplitude function would also fail to produce accurate results as $\\delta \\to 0$. The two difficulties (near-singularity and high-frequency oscillation) are distinct and require separate, or combined, treatments.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "Having learned to construct and accurately evaluate the BEM system matrix, we now turn to a more profound challenge: the choice of the integral equation itself. Certain formulations, while mathematically valid, suffer from a critical flaw known as non-uniqueness, leading to erroneous results at specific 'spurious' frequencies. This practice  guides you through a classic analysis to derive these spurious frequencies for a circular scatterer, revealing the deep connection between the failure of a boundary integral equation and the interior eigenmodes of the scattering object.",
            "id": "4118324",
            "problem": "Consider two-dimensional time-harmonic acoustics with angular frequency $\\omega$ and wavenumber $k$, where $k = \\omega / c$ and $c$ is the speed of sound. Let a sound-soft circular obstacle (a disk) of radius $a$ be centered at the origin in the plane. The exterior scattering problem enforces the Dirichlet boundary condition $p = 0$ on the boundary $r = a$, where $p$ is the acoustic pressure satisfying the Helmholtz equation $\\Delta p + k^{2} p = 0$ in the exterior. In the standard collocation Boundary Element Method (BEM), using the pure double-layer boundary integral equation for the exterior Dirichlet problem, non-uniqueness (spurious resonances) can occur at specific wavenumbers tied to the interior Dirichlet eigenvalues of the disk.\n\nStarting from the Helmholtz equation $\\Delta u + k^{2} u = 0$ and the interior Dirichlet boundary condition $u|_{r=a} = 0$, use separation of variables in polar coordinates to derive the eigenvalue condition for the interior of the disk. Then, by connecting this condition to the loss of invertibility of the pure double-layer collocation equation, identify the first three lowest nonzero frequencies (in hertz) at which spurious resonances occur for a disk of radius $a = 0.5$ $\\mathrm{m}$ in air with speed of sound $c = 343$ $\\mathrm{m/s}$. Express each frequency $f$ in hertz via $f = \\omega/(2\\pi) = c k/(2\\pi)$, and round your answers to four significant figures. State the three resonance frequencies in ascending order as a single row vector. In your derivation, justify why these interior eigenvalues cause non-uniqueness in the collocation double-layer BEM and briefly explain the qualitative effect of approaching such a frequency on the collocation solution. The final numerical answer must be given in $\\mathrm{Hz}$ and rounded to four significant figures.",
            "solution": "The problem requires the derivation of the spurious resonance frequencies for a two-dimensional exterior acoustic scattering problem involving a sound-soft circular disk. This is a classic issue in the Boundary Element Method (BEM) when using a pure double-layer potential formulation.\n\nFirst, we must find the eigenvalues of the corresponding interior Dirichlet problem. This involves solving the Helmholtz equation, $\\Delta u + k^{2} u = 0$, inside a disk of radius $a$ subject to the boundary condition $u = 0$ on the boundary $r=a$. We use separation of variables in polar coordinates $(r, \\theta)$. The Helmholtz equation in polar coordinates is:\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} + k^2 u = 0 $$\nLet the solution be of the form $u(r, \\theta) = R(r) \\Theta(\\theta)$. Substituting this into the equation and separating variables yields:\n$$ \\frac{r}{R(r)} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) + k^2r^2 = - \\frac{1}{\\Theta(\\theta)} \\frac{d^2 \\Theta(\\theta)}{d\\theta^2} $$\nBoth sides must equal a constant, which we denote by $n^2$. The requirement that the solution be single-valued in $\\theta$, i.e., $\\Theta(\\theta) = \\Theta(\\theta + 2\\pi)$, restricts $n$ to be an integer, $n \\in \\{0, 1, 2, \\dots\\}$.\n\nThe angular equation is $\\frac{d^2 \\Theta}{d\\theta^2} + n^2 \\Theta = 0$, which has solutions of the form $\\Theta(\\theta) = A_n \\cos(n\\theta) + B_n \\sin(n\\theta)$.\n\nThe radial equation becomes:\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} + (k^2r^2 - n^2)R = 0 $$\nThis is Bessel's differential equation of order $n$. Its general solution is a linear combination of the Bessel function of the first kind, $J_n(kr)$, and the Bessel function of the second kind, $Y_n(kr)$. The full solution for $u(r, \\theta)$ is thus:\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} \\left[ C_n J_n(kr) + D_n Y_n(kr) \\right] (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\nFor the interior problem, the solution must be finite at the origin ($r=0$). Since the Bessel function of the second kind, $Y_n(z)$, is singular at $z=0$, we must set all coefficients $D_n=0$ to ensure a physically valid solution.\n\nThe solution simplifies to:\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} C_n J_n(kr) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\nApplying the Dirichlet boundary condition $u(a, \\theta) = 0$:\n$$ \\sum_{n=0}^{\\infty} C_n J_n(ka) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) = 0 $$\nFor this equation to hold for all $\\theta$, the coefficient of each Fourier mode must be zero. For a non-trivial solution to exist (i.e., not all coefficients $A_n, B_n, C_n$ are zero), we must have:\n$$ J_n(ka) = 0 $$\nThis is the eigenvalue condition for the interior Dirichlet problem. The wavenumbers $k$ that satisfy this condition for any integer $n \\geq 0$ are the eigenvalues. Let $z_{n,m}$ be the $m$-th positive root of the Bessel function $J_n(z)$. Then the resonant wavenumbers are given by $k_{n,m} = z_{n,m}/a$.\n\nThe connection to the non-uniqueness of the collocation BEM for the exterior problem arises from the integral equation formulation. The exterior Dirichlet problem, when formulated with a pure double-layer potential, leads to the boundary integral equation $( \\frac{1}{2}I + K_k ) \\mu = 0$, where $K_k$ is the double-layer boundary integral operator (which depends on $k$) and $\\mu$ is the unknown density function. This homogeneous equation has a non-trivial solution $\\mu$ if and only if the operator $(\\frac{1}{2}I + K_k)$ is singular. By the Fredholm alternative and properties of potential operators, this singularity occurs precisely when the wavenumber $k$ is an eigenvalue of the interior Dirichlet problem, i.e., when $J_n(ka) = 0$ for some $n$. These wavenumbers are thus called \"spurious\" because they are artifacts of the mathematical formulation, not a physical resonance of the exterior scattering problem itself.\n\nWhen performing a numerical collocation BEM, the integral operator is discretized into a matrix $A$. As the wavenumber $k$ approaches a spurious resonant wavenumber $k_{n,m}$, the continuous operator approaches singularity, causing the condition number of the matrix $A$ to grow without bound. This ill-conditioning means the numerical system of equations becomes nearly singular, and the computed solution for the density $\\mu$ becomes arbitrarily large and corrupted by numerical errors, leading to a physically meaningless, divergent pressure field.\n\nTo find the first three lowest nonzero frequencies, we need to find the three smallest positive roots $z_{n,m}$ of $J_n(z)=0$. We list the first few roots:\nThe roots of $J_0(z)=0$ are $z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$, ...\nThe roots of $J_1(z)=0$ are $z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$, ...\nThe roots of $J_2(z)=0$ are $z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$, ...\nThe roots of $J_3(z)=0$ are $z_{3,1} \\approx 6.3802$, ...\n\nOrdering all roots $z_{n,m}$ in ascending value gives the sequence:\n$z_{0,1} \\approx 2.4048$\n$z_{1,1} \\approx 3.8317$\n$z_{2,1} \\approx 5.1356$\nThese are the three smallest positive roots.\n\nThe corresponding frequencies $f$ are calculated using the formula $f = \\frac{ck}{2\\pi} = \\frac{c z_{n,m}}{2\\pi a}$.\nGiven the parameters $c = 343 \\, \\mathrm{m/s}$ and $a = 0.5 \\, \\mathrm{m}$:\n$$ f_{n,m} = \\frac{343}{2\\pi(0.5)} z_{n,m} = \\frac{343}{\\pi} z_{n,m} $$\n1. First lowest frequency (from $z_{0,1}$):\n$$ f_1 = f_{0,1} = \\frac{343}{\\pi} \\times 2.404825... \\approx 262.5699... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $262.6 \\, \\mathrm{Hz}$.\n\n2. Second lowest frequency (from $z_{1,1}$):\n$$ f_2 = f_{1,1} = \\frac{343}{\\pi} \\times 3.831706... \\approx 418.3245... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $418.3 \\, \\mathrm{Hz}$.\n\n3. Third lowest frequency (from $z_{2,1}$):\n$$ f_3 = f_{2,1} = \\frac{343}{\\pi} \\times 5.135622... \\approx 560.7246... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $560.7 \\, \\mathrm{Hz}$.\n\nThese three frequencies represent the first three spurious resonances for the specified problem.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n262.6 & 418.3 & 560.7\n\\end{pmatrix}\n}\n$$"
        }
    ]
}