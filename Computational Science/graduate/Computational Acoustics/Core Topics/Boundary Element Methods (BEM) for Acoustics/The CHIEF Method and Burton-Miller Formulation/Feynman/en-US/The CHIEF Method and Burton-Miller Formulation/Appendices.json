{
    "hands_on_practices": [
        {
            "introduction": "To effectively address the non-uniqueness problem in boundary element methods, we must first understand its analytical origins. This practice explores the classic case of acoustic scattering from a sound-soft sphere . By deriving the exact solution using separation of variables, you will directly connect the resonant frequencies of the sphere's interior to the mathematical breakdown that occurs in standard integral equation formulations, providing a foundational insight into the nature of these \"fictitious frequencies.\"",
            "id": "4139725",
            "problem": "Consider time-harmonic acoustic scattering of a plane wave by a sound-soft sphere in a homogeneous, inviscid fluid. Let the total acoustic pressure field $p(\\mathbf{x})$ satisfy the Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ in the exterior of a sphere of radius $a$, with the Dirichlet boundary condition $p|_{r=a} = 0$, and the Sommerfeld radiation condition at infinity. Assume a time dependence $\\exp(-\\mathrm{i} \\omega t)$, so that $k = \\omega / c$, with $c$ the sound speed. A plane wave of unit amplitude is incident along the $z$-axis, $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i} k z)$.\n\nStarting from the Helmholtz equation and the separation-of-variables representation in spherical coordinates, derive the far-field scattering amplitude $f(\\theta)$ such that in the far field $p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i} k r)}{r} f(\\theta)$ as $r \\to \\infty$, where $p^{\\mathrm{s}}$ is the scattered field and $\\theta$ is the polar angle. In addition, identify the frequencies at which interior resonances occur for the exterior Dirichlet problem, in the sense that the conventional boundary integral equation possesses non-unique solutions at those frequencies; connect this identification to the modal separation-of-variables analysis.\n\nFinally, for a sphere of radius $a = 0.50$ m in water with sound speed $c = 1.50 \\times 10^{3}$ m/s, compute the lowest positive interior resonant angular frequency $\\omega_{1}$ (in radians per second) associated with the $l=0$ mode. Round your numerical result to four significant figures and express the angular frequency in radians per second. You may assume the following well-tested facts: the plane-wave expansion in spherical harmonics and the far-field asymptotics of spherical Hankel functions. In your derivation, explicitly define the Combined Helmholtz Integral Equation Formulation (CHIEF) and the Burton–Miller combined-field integral equation on their first appearances, and explain at a conceptual level how each removes spurious non-uniqueness due to interior resonances without altering the physical scattering amplitude derived by separation of variables.\n\nYour final answer must consist of two components presented as a single row matrix: the closed-form series expression for $f(\\theta)$, and the computed value of $\\omega_{1}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It represents a standard problem in acoustic scattering theory and is therefore valid.\n\nThe total acoustic pressure field $p(\\mathbf{x})$ is the sum of the incident plane wave $p^{\\mathrm{i}}(\\mathbf{x})$ and the scattered field $p^{\\mathrm{s}}(\\mathbf{x})$, so $p(\\mathbf{x}) = p^{\\mathrm{i}}(\\mathbf{x}) + p^{\\mathrm{s}}(\\mathbf{x})$. Both $p$ and $p^{\\mathrm{i}}$ satisfy the Helmholtz equation, $\\nabla^{2} \\phi + k^{2} \\phi = 0$, thus the scattered field $p^{\\mathrm{s}}$ must also satisfy it.\n\nThe incident plane wave propagating along the $z$-axis is given by $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i}kz) = \\exp(\\mathrm{i}kr\\cos\\theta)$. Its expansion in terms of Legendre polynomials $P_l(\\cos\\theta)$ and spherical Bessel functions of the first kind $j_l(kr)$ is:\n$$ p^{\\mathrm{i}}(r, \\theta) = \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(kr) P_l(\\cos\\theta) $$\nDue to the azimuthal symmetry of the incident wave and the spherical scatterer, the scattered field $p^{\\mathrm{s}}$ will also be independent of the azimuthal angle $\\phi$. We can express $p^{\\mathrm{s}}$ as a series of partial waves. To satisfy the Sommerfeld radiation condition, which dictates that the scattered wave must be purely outgoing at infinity, we use spherical Hankel functions of the first kind, $h_l^{(1)}(kr)$:\n$$ p^{\\mathrm{s}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(kr) P_l(\\cos\\theta) $$\nThe coefficients $A_l$ are determined by the boundary condition on the surface of the sphere. For a sound-soft sphere of radius $a$, the total pressure is zero on the boundary: $p(a, \\theta) = 0$. This implies $p^{\\mathrm{s}}(a, \\theta) = -p^{\\mathrm{i}}(a, \\theta)$.\nSubstituting the series expansions into the boundary condition gives:\n$$ \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(ka) P_l(\\cos\\theta) = - \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(ka) P_l(\\cos\\theta) $$\nBy the orthogonality of the Legendre polynomials, we can equate the coefficients for each mode $l$:\n$$ A_l h_l^{(1)}(ka) = - \\mathrm{i}^l (2l+1) j_l(ka) $$\nSolving for the unknown coefficients $A_l$:\n$$ A_l = - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} $$\nThe scattered field is thus:\n$$ p^{\\mathrm{s}}(r, \\theta) = - \\sum_{l=0}^{\\infty} (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} h_l^{(1)}(kr) P_l(\\cos\\theta) $$\nTo find the far-field scattering amplitude $f(\\theta)$, we examine the asymptotic behavior of $p^{\\mathrm{s}}$ as $r \\to \\infty$. The spherical Hankel functions have the asymptotic form:\n$$ h_l^{(1)}(kr) \\sim \\frac{1}{kr} \\exp\\left(\\mathrm{i}\\left(kr - \\frac{(l+1)\\pi}{2}\\right)\\right) = \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) $$\nSubstituting this into the expression for $p^{\\mathrm{s}}$:\n$$ p^{\\mathrm{s}}(r, \\theta) \\sim \\sum_{l=0}^{\\infty} A_l P_l(\\cos\\theta) \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) = \\frac{\\exp(\\mathrm{i}kr)}{r} \\left( \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) \\right) $$\nBy comparing this with the definition $p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i}kr)}{r} f(\\theta)$, we identify the scattering amplitude:\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\nSubstituting the expression for $A_l$:\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} \\left( - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} \\right) (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} [- \\mathrm{i}^l (-\\mathrm{i})^{l+1}] P_l(\\cos\\theta) $$\nThe term in the square brackets simplifies as: $- \\mathrm{i}^l (-1)^{l+1} \\mathrm{i}^{l+1} = (-1)^{l+2} \\mathrm{i}^{2l+1} = (-1)^l (-1)^l \\mathrm{i} = \\mathrm{i}$.\nThus, the far-field scattering amplitude is:\n$$ f(\\theta) = \\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) $$\n\nThe problem of interior resonances arises when solving this scattering problem using Boundary Integral Equation (BIE) methods. For an exterior Dirichlet problem (like the sound-soft scatterer), a common approach is to use a direct BIE formulation for the unknown normal derivative of the pressure on the surface. This leads to an integral equation of the form $S\\phi = g$, where $S$ is the single-layer potential operator. This formulation fails, leading to non-unique solutions, at certain characteristic frequencies. These frequencies correspond to the eigenvalues of the associated *interior* problem. For the exterior Dirichlet problem, the associated interior problem is the interior Dirichlet problem for the Helmholtz equation: $\\nabla^2 u + k^2 u = 0$ inside the volume enclosed by the boundary, with $u=0$ on the boundary.\nThe connection to the modal separation-of-variables analysis is direct. The non-trivial solutions (eigenfunctions) to the interior Dirichlet problem for the sphere exist only at specific wavenumbers $k$. Using separation of variables for the interior, a solution regular at the origin is of the form $u(r,\\theta,\\phi) = \\sum_{l,m} C_{lm} j_l(kr) Y_l^m(\\theta,\\phi)$. The boundary condition $u(a,\\theta,\\phi)=0$ requires that $j_l(ka)=0$ for some non-negative integer $l$. The wavenumbers $k$ satisfying this condition for any $l$ are the resonant wavenumbers. At these wavenumbers, the integral operator $S$ has a non-trivial null space, and the BIE is ill-posed.\n\nTo overcome this non-uniqueness, several methods have been developed.\nThe **Combined Helmholtz Integral Equation Formulation (CHIEF)** is a method that enforces the integral representation of the scattered field to be zero at a number of points selected inside the scattering body. The Helmholtz integral representation for the exterior scattered field $p^{\\mathrm{s}}$ yields zero for any point $\\mathbf{x}_{\\text{int}}$ in the interior domain. These additional constraint equations are appended to the original discretized surface BIE, forming an overdetermined system of linear equations. This system is then typically solved in a least-squares sense. The spurious solutions associated with the interior resonances generally do not satisfy these additional interior constraints (unless a CHIEF point happens to lie on a nodal surface of the interior eigenmode), thus ensuring a unique solution is found.\n\nThe **Burton–Miller combined-field integral equation** regularizes the problem by forming a linear combination of the standard surface Helmholtz integral equation and its normal derivative. The resulting combined equation is of the form $\\mathcal{A} + \\alpha \\mathcal{B} = g$, where $\\mathcal{A}$ is the original ill-posed equation, $\\mathcal{B}$ is its normal derivative, and $\\alpha$ is a complex coupling parameter. A common formulation for the exterior Dirichlet problem is to combine the single-layer and hypersingular operators, $(S + \\alpha N) v = g_{\\text{new}}$, where $v$ is the unknown normal derivative and $N$ is the hypersingular operator. It can be proven that if the imaginary part of $\\alpha$ is non-zero (a common choice is $\\alpha = \\mathrm{i}/k$), the combined operator is invertible for all real, positive wavenumbers $k$. This robustly removes the non-uniqueness issue for all geometries and frequencies, unlike CHIEF, which can fail if the interior points are chosen poorly.\n\nFinally, we compute the lowest positive interior resonant angular frequency $\\omega_{1}$ for the $l=0$ mode. This corresponds to the lowest positive wavenumber $k_1$ for which $j_0(k_1a)=0$.\nThe spherical Bessel function of order $0$ is $j_0(x) = \\frac{\\sin(x)}{x}$.\nThe condition $j_0(k_1a) = 0$ requires $\\frac{\\sin(k_1a)}{k_1a} = 0$. Since we are looking for a positive frequency, $k_1 a > 0$, so we must have $\\sin(k_1a)=0$.\nThe smallest positive solution for the argument is $k_1 a = \\pi$.\nThe wavenumber $k$ is related to the angular frequency $\\omega$ by $k = \\omega/c$. Therefore, $k_1 = \\omega_1/c$.\nSubstituting this into our condition:\n$$ \\frac{\\omega_1 a}{c} = \\pi $$\nSolving for $\\omega_1$:\n$$ \\omega_1 = \\frac{\\pi c}{a} $$\nThe problem provides the values $a = 0.50$ m and $c = 1.50 \\times 10^3$ m/s.\n$$ \\omega_1 = \\frac{\\pi (1.50 \\times 10^3 \\text{ m/s})}{0.50 \\text{ m}} = \\pi \\times 3.0 \\times 10^3 \\text{ rad/s} $$\nNumerically, this is $\\omega_1 \\approx 9424.777...$ rad/s.\nRounding to four significant figures, we get $\\omega_1 = 9425$ rad/s, or in scientific notation, $9.425 \\times 10^3$ rad/s.",
            "answer": "$$\n\\boxed{\n\\pmatrix{\n\\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) & 9.425 \\times 10^{3}\n}\n}\n$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice, this exercise provides a direct numerical demonstration of the interior resonance problem and its solutions . You will implement a simple boundary element method for a circular scatterer and observe firsthand how the system matrix becomes severely ill-conditioned at a resonant frequency. By then implementing and comparing the Burton-Miller and CHIEF formulations, you will gain practical experience in how these methods restore numerical stability and ensure a unique, physical solution.",
            "id": "4139731",
            "problem": "Consider time-harmonic acoustic scattering in two spatial dimensions governed by the Helmholtz equation for the total acoustic pressure field $p(\\mathbf{x})$,\n$$\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0,$$\nwhere $k$ is the acoustic wavenumber expressed in $1/\\mathrm{m}$. The geometry is the unit-radius circle in the plane, namely the set $\\Gamma = \\{\\mathbf{x} \\in \\mathbb{R}^2 : \\|\\mathbf{x}\\| = R\\}$ with $R = 1\\,\\mathrm{m}$, and outward unit normal $\\mathbf{n}_\\Gamma(\\mathbf{y})$ at a boundary point $\\mathbf{y} \\in \\Gamma$. The fundamental solution (Green’s function) of the two-dimensional Helmholtz operator is \n$$G(\\mathbf{x},\\mathbf{y};k) = \\frac{i}{4} H_0^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big),$$\nwhere $H_0^{(1)}$ is the zeroth-order Hankel function of the first kind. The classical double-layer potential operator $D$ and the normal derivative of the single-layer potential operator $P$ (taken with respect to the observation point’s normal $\\partial/\\partial n_{\\mathbf{x}}$) have kernels\n$$K_D(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{y}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{y}-\\mathbf{x})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n$$K_P(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{x}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{x})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\nwhere $H_1^{(1)}$ is the first-order Hankel function of the first kind, and all angles are in radians. For a smooth boundary, the direct boundary integral equation for sound-soft (Dirichlet) scattering uses the operator $(\\tfrac{1}{2}I + D)$ acting on an unknown density function; the Burton–Miller formulation combines the direct boundary integral equation with its normal derivative to remove non-uniqueness at interior resonant wavenumbers. The Combined Helmholtz Integral Equation Formulation (CHIEF) adds homogeneous interior field constraints at a set of interior collocation points to stabilize the system at these resonant wavenumbers.\n\nTask: Using the unit circle geometry, discretize the boundary using $N$ equispaced collocation points with trapezoidal-rule weights $w = 2\\pi R / N$, and form three matrices:\n- the direct boundary operator\n$$A(k) = \\tfrac{1}{2}I + D(k),$$\n- the Burton–Miller-style combined operator\n$$A_{\\mathrm{BM}}(k,\\alpha) = \\tfrac{1}{2}I + D(k) + i \\alpha\\,P(k),$$\nwith $\\alpha$ a dimensionless coupling parameter,\n- the CHIEF-augmented operator\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} \\tfrac{1}{2}I + D(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix},$$\nwhere the interior constraint block $C_{\\mathrm{int}}(k)$ evaluates the double-layer potential at $Q$ interior points $\\mathbf{x}_c^\\ell$ (with no jump term on the interior) so that the homogeneous scattered field vanishes at those interior collocation points. In all three matrices, approximate the boundary integrals by the trapezoidal rule, using only off-diagonal kernel evaluations and assigning the diagonal entries of $D(k)$ and $P(k)$ to $0$ while maintaining the $\\tfrac{1}{2}I$ jump term in $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$ as written.\n\nPart (a): Compute the first few interior Dirichlet eigenfrequencies for the unit disk, understood as the smallest positive wavenumbers $k$ (in $1/\\mathrm{m}$) at which there exist nontrivial solutions to the homogeneous interior Helmholtz boundary value problem with $p|_{\\Gamma} = 0$. Use separation of variables and the fact that these wavenumbers occur at the positive zeros of the Bessel functions of the first kind $J_m(kr)$ for integer azimuthal order $m \\in \\mathbb{Z}_{\\ge 0}$. Report the first $5$ smallest such wavenumbers computed from orders $m = 0,1,2$ with up to $2$ zeros per order, sorted ascending. Express all wavenumbers in $1/\\mathrm{m}$.\n\nPart (b): Using the discretization described above with $R = 1\\,\\mathrm{m}$, $N = 64$, $\\alpha = 1$, and $Q = 4$ interior points placed at radius $0.5\\,\\mathrm{m}$ with equispaced angles, compute the $2$-norm condition number $\\kappa_2$ of the square matrices $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$, and the pseudo-condition number of the rectangular matrix $A_{\\mathrm{aug}}(k)$ defined as the ratio of the largest to smallest singular values of $A_{\\mathrm{aug}}(k)$, at the following wavenumbers (all in $1/\\mathrm{m}$):\n- a general case $k = 2.0$,\n- a near-resonant case $k = k_1 - 0.01$, where $k_1$ is the smallest wavenumber obtained in Part (a),\n- an exactly resonant case $k = k_1$.\n\nUse radians for all angle computations. For each case, return three floats: $\\kappa_2\\!\\big(A(k)\\big)$, $\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k,\\alpha)\\big)$, and the pseudo-condition number of $A_{\\mathrm{aug}}(k)$.\n\nTest Suite and Final Output Format:\n- Compute the list of the first $5$ interior wavenumbers from Part (a) as the first output item.\n- Compute the three condition numbers for each of the three specified wavenumbers in Part (b).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, structured as\n$$\\text{[eigs, [cd_1, cbm_1, caug_1], [cd_2, cbm_2, caug_2], [cd_3, cbm_3, caug_3]]},$$\nwhere $\\text{eigs}$ is the list of $5$ floats (in $1/\\mathrm{m}$) for Part (a), and for each $j \\in \\{1,2,3\\}$, $\\text{cd}_j$ is $\\kappa_2\\!\\big(A(k_j)\\big)$, $\\text{cbm}_j$ is $\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k_j,\\alpha)\\big)$, and $\\text{caug}_j$ is the pseudo-condition number of $A_{\\mathrm{aug}}(k_j)$, all reported as floats.",
            "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the principles of computational acoustics, specifically the boundary integral equation (BIE) method for the Helmholtz equation. The problem is well-posed, with all necessary parameters and definitions provided, and contains no internal contradictions or factual errors. The task is to analyze the numerical stability of three different BIE formulations for acoustic scattering from a circular obstacle, particularly in the context of interior resonance phenomena.\n\nThe solution proceeds in two parts as specified. Part (a) identifies the resonant wavenumbers (interior Dirichlet eigenfrequencies) for the unit disk. Part (b) involves the numerical implementation and analysis of the condition numbers of matrices corresponding to the direct BIE formulation, the Burton–Miller formulation, and the CHIEF method at resonant and non-resonant wavenumbers.\n\n### Part (a): Interior Dirichlet Eigenfrequencies\n\nThe interior Dirichlet problem for the Helmholtz equation, $\\nabla^2 p + k^2 p = 0$, within a disk of radius $R$ subject to the boundary condition $p=0$ on its boundary $\\Gamma$, is a classical eigenvalue problem. The solutions (eigenfunctions) can be found using separation of variables in polar coordinates $(r, \\theta)$. Solutions that are finite at the origin ($r=0$) are of the form\n$$p(r, \\theta) = \\sum_{m=0}^{\\infty} J_m(kr) (A_m \\cos(m\\theta) + B_m \\sin(m\\theta)),$$\nwhere $J_m$ is the Bessel function of the first kind of integer order $m$. The boundary condition $p(R, \\theta) = 0$ for all $\\theta$ imposes the constraint that $J_m(kR) = 0$ for each azimuthal mode $m$.\n\nFor the given unit disk geometry, $R=1\\,\\mathrm{m}$, the condition simplifies to $J_m(k)=0$. The interior resonant wavenumbers $k$ are therefore the positive zeros of the Bessel functions of the first kind, $J_m(x)$, for non-negative integer orders $m$. We are asked to find the first $5$ smallest such wavenumbers, considering orders $m=0, 1, 2$.\n\nLet $z_{m,n}$ denote the $n$-th positive zero of $J_m(x)$. We compute the first two zeros for $m=0, 1, 2$:\n- Zeros of $J_0(x)$: $z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$\n- Zeros of $J_1(x)$: $z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$\n- Zeros of $J_2(x)$: $z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$\n\nCollecting these six values and sorting them in ascending order yields the sequence:\n$2.4048\\dots, 3.8317\\dots, 5.1356\\dots, 5.5201\\dots, 7.0156\\dots, 8.4172\\dots$.\nThe first $5$ smallest resonant wavenumbers (in $1/\\mathrm{m}$) are approximately $2.4048$, $3.8317$, $5.1356$, $5.5201$, and $7.0156$. The smallest of these, which we denote $k_1$, is $k_1 = z_{0,1} \\approx 2.4048\\,\\mathrm{m}^{-1}$.\n\n### Part (b): Matrix Discretization and Condition Number Analysis\n\nWe discretize the circular boundary $\\Gamma$ using $N=64$ equispaced collocation points $\\mathbf{y}_j$ for $j=0, \\dots, N-1$. A point $\\mathbf{y}_j$ is given by $\\mathbf{y}_j = (R\\cos\\theta_j, R\\sin\\theta_j)$ with $R=1\\,\\mathrm{m}$ and $\\theta_j = 2\\pi j/N$. The outward unit normal at $\\mathbf{y}_j$ is $\\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\cos\\theta_j, \\sin\\theta_j)$. Boundary integrals are approximated using the trapezoidal rule with uniform weight $w = 2\\pi R / N = \\pi/32$.\n\nThe integral operators are discretized into $N \\times N$ matrices. For an operator with kernel $K(\\mathbf{x}, \\mathbf{y})$, the Nyström discretization leads to matrix entries $K_{ij} = w \\cdot K(\\mathbf{y}_i, \\mathbf{y}_j)$ for off-diagonal elements ($i \\ne j$). As specified, the diagonal entries of the integral operator matrices $D(k)$ and $P(k)$ are set to $0$.\n\n**1. The $D(k)$ and $P(k)$ Operators**\nThe matrices $D(k)$ and $P(k)$ have entries given by $D_{ij} = w \\cdot K_D(\\mathbf{y}_i, \\mathbf{y}_j; k)$ and $P_{ij} = w \\cdot K_P(\\mathbf{y}_i, \\mathbf{y}_j; k)$ for $i \\ne j$. For the specific case of a circle, the kernels $K_D$ and $K_P$ are identical when both points $\\mathbf{x}=\\mathbf{y}_i$ and $\\mathbf{y}=\\mathbf{y}_j$ lie on the boundary. This is because $(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\mathbf{y}_i-\\mathbf{y}_j)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_i) = R(1 - \\cos(\\theta_j-\\theta_i))$. Therefore, the matrices are equal: $D(k) = P(k)$. We denote this common matrix as $K_{\\mathrm{mat}}(k)$. Its entries for $i \\neq j$ are:\n$$(K_{\\mathrm{mat}})_{ij} = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{y}_i-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{y}_i-\\mathbf{y}_j\\|} \\right),$$\nwith $(K_{\\mathrm{mat}})_{ii} = 0$.\n\n**2. The $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$ Matrices**\nThe matrices for the direct and Burton-Miller formulations are constructed as:\n- $A(k) = \\frac{1}{2}I + D(k) = \\frac{1}{2}I_N + K_{\\mathrm{mat}}(k)$\n- $A_{\\mathrm{BM}}(k,\\alpha) = \\frac{1}{2}I + D(k) + i \\alpha P(k) = \\frac{1}{2}I_N + (1+i\\alpha)K_{\\mathrm{mat}}(k)$\nWith $\\alpha=1$, this becomes $A_{\\mathrm{BM}}(k,1) = \\frac{1}{2}I_N + (1+i)K_{\\mathrm{mat}}(k)$. These are both $N \\times N$ square matrices.\n\n**3. The CHIEF Matrix $A_{\\mathrm{aug}}(k)$**\nThe CHIEF method augments the direct formulation with $Q=4$ interior constraint equations. The interior points $\\mathbf{x}_c^\\ell$ for $\\ell=0, \\dots, Q-1$ are located at a radius of $r_c = 0.5\\,\\mathrm{m}$ with equispaced angles $\\phi_\\ell = 2\\pi \\ell / Q$. The constraint equations require the scattered field (represented by a double-layer potential) to be zero at these points. This gives rise to a $Q \\times N$ constraint matrix $C_{\\mathrm{int}}(k)$ with entries:\n$$(C_{\\mathrm{int}})_{\\ell j} = w \\cdot K_D(\\mathbf{x}_c^\\ell, \\mathbf{y}_j; k) = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{x}_c^\\ell)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|} \\right).$$\nThe augmented matrix is an $(N+Q) \\times N$ rectangular matrix, formed by stacking $A(k)$ and $C_{\\mathrm{int}}(k)$:\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} A(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix}.$$\n\n**4. Condition Number Calculation**\nWe compute the condition numbers at three wavenumbers: a non-resonant case $k=2.0\\,\\mathrm{m}^{-1}$, a near-resonant case $k=k_1-0.01$, and the exact resonant case $k=k_1$.\nFor the square matrices $A(k)$ and $A_{\\mathrm{BM}}(k,1)$, the $2$-norm condition number is $\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$, where $\\sigma$ are the singular values of $M$. For the rectangular matrix $A_{\\mathrm{aug}}(k)$, the pseudo-condition number is defined identically as the ratio of its largest to its smallest singular value.\nAt the resonant wavenumber $k=k_1$, the operator $\\frac{1}{2}I+D(k)$ has a non-trivial null space, which manifests as an extremely large condition number for its discretization $A(k)$. Both the Burton-Miller and CHIEF formulations are designed to remedy this by creating systems that are well-conditioned at all wavenumbers. The computations will verify this behavior.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jn_zeros, hankel1\n\ndef compute_condition_numbers(k, R, N, alpha, Q, r_c):\n    \"\"\"\n    Computes the condition numbers for the three BEM matrices for a given wavenumber k.\n    \"\"\"\n    # 1. Geometry and Discretization Setup\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    y_boundary = R * np.array([np.cos(theta), np.sin(theta)]).T  # Shape (N, 2)\n    normals_boundary = y_boundary / R  # Shape (N, 2)\n    weight = 2 * np.pi * R / N\n\n    # 2. Assemble K_mat for D(k) and P(k) operators\n    # For a circle, D(k) = P(k)\n    K_mat = np.zeros((N, N), dtype=np.complex128)\n    for i in range(N):\n        for j in range(N):\n            if i == j:\n                continue\n            \n            yi = y_boundary[i, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n            \n            vec_ji = yj - yi\n            dist = np.linalg.norm(vec_ji)\n            \n            # Kernel for double-layer potential\n            dot_prod = np.dot(vec_ji, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n            \n            K_mat[i, j] = weight * kernel_val\n\n    # 3. Construct A(k) and A_BM(k, alpha)\n    I_N = np.eye(N)\n    A = 0.5 * I_N + K_mat\n    A_BM = 0.5 * I_N + (1.0 + 1j * alpha) * K_mat\n\n    # 4. Assemble CHIEF constraint matrix C_int(k)\n    C_int = np.zeros((Q, N), dtype=np.complex128)\n    phi = np.linspace(0, 2 * np.pi, Q, endpoint=False)\n    x_interior = r_c * np.array([np.cos(phi), np.sin(phi)]).T  # Shape (Q, 2)\n\n    for l in range(Q):\n        for j in range(N):\n            xl = x_interior[l, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n\n            vec_jl = yj - xl\n            dist = np.linalg.norm(vec_jl)\n            \n            dot_prod = np.dot(vec_jl, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n\n            C_int[l, j] = weight * kernel_val\n\n    # 5. Construct augmented matrix A_aug(k)\n    A_aug = np.vstack([A, C_int])\n\n    # 6. Compute condition numbers\n    cond_A = np.linalg.cond(A)\n    cond_ABM = np.linalg.cond(A_BM)\n    cond_Aaug = np.linalg.cond(A_aug)\n    \n    return [cond_A, cond_ABM, cond_Aaug]\n\n\ndef solve():\n    # Part (a): Compute interior Dirichlet eigenfrequencies\n    # Get first 2 positive zeros for J_0, J_1, J_2\n    zeros_j0 = jn_zeros(0, 2)\n    zeros_j1 = jn_zeros(1, 2)\n    zeros_j2 = jn_zeros(2, 2)\n    \n    # Combine, sort, and take the first 5\n    all_zeros = np.concatenate([zeros_j0, zeros_j1, zeros_j2])\n    eigs = sorted(all_zeros)[:5]\n    \n    k1 = eigs[0] # Smallest resonant wavenumber\n\n    # Part (b): Compute condition numbers\n    \n    # Define parameters\n    R = 1.0\n    N = 64\n    alpha = 1.0\n    Q = 4\n    r_c = 0.5\n\n    # Define wavenumbers for testing\n    k_values = [\n        2.0,           # General case\n        k1 - 0.01,     # Near-resonant case\n        k1             # Exactly resonant case\n    ]\n    \n    results_part_b = []\n    for k_val in k_values:\n        conds = compute_condition_numbers(k_val, R, N, alpha, Q, r_c)\n        results_part_b.append(conds)\n\n    # Format the final output as a single string\n    # The structure is [[eigs], [conds_k1], [conds_k2], [conds_k3]]\n    # where Python's str() on a list gives the '[...]' format.\n    final_results = [eigs] + results_part_b\n    output_str = \",\".join(map(str, final_results))\n    \n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having seen that the Burton-Miller formulation successfully overcomes fictitious frequencies, a crucial question for practical implementation is how to choose its coupling parameter for optimal performance. This advanced practice delves into the underlying theory, guiding you to determine the best choice for the parameter $\\eta$ by analyzing the spectral properties of the combined field operator . This exercise connects the abstract mathematics of operator theory with the practical goal of minimizing computational cost in high-frequency scattering simulations.",
            "id": "4139828",
            "problem": "Consider time-harmonic acoustic scattering in three dimensions governed by the Helmholtz equation for the total pressure field $p(\\mathbf{x})$ at angular frequency $\\omega$, with wavenumber $k = \\omega / c$, where $c$ is the speed of sound. Let $\\Omega^{+}$ denote the unbounded exterior of a smooth, strictly convex obstacle with boundary $\\Gamma$ and characteristic size $a$ defined as the radius of the smallest circumscribed sphere. The exterior Dirichlet problem seeks $p$ satisfying $\\Delta p + k^{2} p = 0$ in $\\Omega^{+}$ and $p = -p^{\\text{inc}}$ on $\\Gamma$, where $p^{\\text{inc}}$ is a given incident field.\n\nDefine the Combined Field Integral Equation (CFIE) operator associated with the Burton-Miller formulation as\n$$\n\\mathcal{A}_{\\eta} := \\left(\\tfrac{1}{2} I + \\mathcal{D}\\right) - i \\eta \\,\\mathcal{S},\n$$\nwhere $\\mathcal{S}$ is the Helmholtz single-layer boundary integral operator on $\\Gamma$ and $\\mathcal{D}$ is the Helmholtz double-layer boundary integral operator on $\\Gamma$. The Combined Helmholtz Integral Equation Formulation (CHIEF) method augments the boundary integral system with additional constraints evaluated at selected interior points to suppress non-uniqueness associated with interior resonances.\n\nUsing a spectral analysis of $\\mathcal{A}_{\\eta}$ on a sphere of radius $a$ as a canonical geometry, and asymptotic considerations justified by pseudodifferential operator theory for smooth convex boundaries, determine the leading-order optimal choice of the coupling parameter $\\eta$ (in the purely imaginary setting $\\alpha = i \\eta$ with $\\eta > 0$) as a function of $k$ and $a$ that minimizes the condition number of $\\mathcal{A}_{\\eta}$ over the propagating modal subset whose surface-tangential wavenumbers are comparable to $k$. Your answer should be a single closed-form analytic expression for the leading-order optimal $\\eta$ in terms of $k$ and $a$. The analysis must explicitly connect the choice of $\\eta$ to the balancing of the CFIE operator’s spectrum and explain the role of CHIEF in relation to interior resonances, but the final reported answer must be only the expression for $\\eta$ and must not include any inequalities. Express the final answer as an analytic expression without units.",
            "solution": "The problem asks for the optimal choice of the real coupling parameter $\\eta > 0$ for the Combined Field Integral Equation (CFIE) operator, also known as the Burton-Miller formulation. The goal is to minimize the operator's condition number in the high-frequency regime ($ka \\gg 1$), which is crucial for the efficiency of iterative solvers.\n\nThe Burton-Miller formulation robustly solves the interior resonance problem that plagues simpler formulations (which CHIEF addresses differently by adding constraints). While invertibility is guaranteed for any $\\eta>0$, the condition number is highly sensitive to the choice of $\\eta$.\n\nThe optimal choice can be understood through a physical and spectral argument.\n1.  **Dimensional Analysis**: The double-layer operator $\\mathcal{D}$ and the identity $I$ are dimensionless. The single-layer operator $\\mathcal{S}$ has units of length. For the operator $\\mathcal{A}_{\\eta}$ to be dimensionally consistent, the product $\\eta\\mathcal{S}$ must be dimensionless. This requires the coupling parameter $\\eta$ to have units of inverse length, i.e., $[\\eta] = L^{-1}$. The primary physical parameter with these units is the wavenumber $k$.\n\n2.  **Impedance Matching and Spectral Balancing**: In the high-frequency limit, a scattered wave locally behaves like a plane wave. A good approximation for an outgoing wave on the boundary $\\Gamma$ is the first-order absorbing boundary condition (or impedance condition): $\\frac{\\partial p_s}{\\partial n} \\approx i k p_s$. This relates the field's normal derivative to the field itself via the impedance $ik$. The Burton-Miller formulation combines an operator related to the field value (the single-layer potential $\\mathcal{S}$) with an operator related to the normal derivative (the hypersingular operator, which is related to the normal derivative of the double-layer potential, or in this formulation, the term $\\frac{1}{2}I+\\mathcal{D}$). By choosing $\\eta = k$, we align the integral equation with this physical impedance condition. This choice effectively balances the spectrum of the constituent operators $\\mathcal{S}$ and $\\mathcal{D}$, preventing the eigenvalues of the combined operator $\\mathcal{A}_{\\eta}$ from clustering near zero or growing uncontrollably.\n\nPseudodifferential operator theory confirms this intuition. In the high-frequency limit ($ka \\to \\infty$), the choice $\\eta \\propto k$ is necessary to prevent linear growth of the condition number with $ka$. Specifically, setting $\\eta=k$ results in a condition number that grows only logarithmically, $\\kappa(\\mathcal{A}_k) \\sim O(\\log(ka))$, which is considered optimal. The dependence on the obstacle's characteristic size $a$ only appears in lower-order correction terms, so the *leading-order* optimal choice is independent of $a$.\n\nThus, by matching the coupling parameter to the physical impedance of the radiating wave, we obtain the leading-order optimal choice that minimizes the condition number.",
            "answer": "$$\\boxed{k}$$"
        }
    ]
}