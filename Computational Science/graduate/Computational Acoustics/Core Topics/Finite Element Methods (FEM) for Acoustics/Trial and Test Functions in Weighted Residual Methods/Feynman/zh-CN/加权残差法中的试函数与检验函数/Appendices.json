{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践是一项基础练习，它将引导你完成将一个连续的偏微分方程转化为离散的有限元矩阵的全过程。我们将从一维亥姆霍兹方程入手，应用伽辽金法（Galerkin method），这是加权余量法中最常见的选择。这项练习的目标是清晰地展示如何从方程的弱形式出发，通过积分计算，得到构成任何有限元模拟基础的单元刚度矩阵 $K_{e}$ 和质量矩阵 $M_{e}$。",
            "id": "4149623",
            "problem": "考虑一个一维、均匀、无损耗的声学管道，其横截面积为单位面积，其中时谐声压场满足亥姆霍兹偏微分方程（PDE）\n$$\n\\frac{d^{2}p}{dx^{2}} + k^{2} p = 0\n$$\n在一个长度为 $h = x_{b} - x_{a}$ 的通用有限元 $e = [x_{a}, x_{b}]$ 上，其中 $k$ 是声波数。使用加权余量法（WRM），并选择伽辽金（Galerkin）测试函数（即试探函数和测试函数取自同一有限维空间），来推导单元级弱形式。假设这是一个内部单元，因此在组装时单元间的通量项会相互抵消，并且在单元级别上不会产生外部边界贡献。\n\n在单元上采用线性拉格朗日（Lagrange）试探函数和测试函数，并使用局部单元坐标 $x \\in [0,h]$，因此两个节点形函数为\n$$\nN_{1}(x) = 1 - \\frac{x}{h}, \\qquad N_{2}(x) = \\frac{x}{h}.\n$$\n从强形式和WRM表述出发，通过分部积分得到弱形式，并确定单元质量矩阵 $M_{e}$ 和刚度矩阵 $K_{e}$。然后，为 $M_{e}$ 和 $K_{e}$ 的所有元素写出显式闭合形式表达式（仅含 $h$），并由此得出亥姆霍兹单元矩阵\n$$\nH_{e} = K_{e} - k^{2} M_{e}.\n$$\n\n答案规范：\n- 以包含 $2 \\times 2$ 矩阵 $H_{e}$ 的元素 $\\bigl[H_{11},\\, H_{12},\\, H_{21},\\, H_{22}\\bigr]$ 的行向量形式报告您的最终答案，并采用精确解析形式。\n- 最终答案中不要包含单位。不需要四舍五入。",
            "solution": "问题陈述经评估有效。这是一个来自计算声学领域的适定、有科学依据的问题，要求对一维亥姆霍兹方程进行有限元矩阵的标准推导。所有必要信息均已提供，没有矛盾或模糊之处。\n\n推导从控制偏微分方程（PDE）的强形式开始，即单元域 $e = [0,h]$上的亥姆霍兹方程：\n$$\n\\frac{d^{2}p}{dx^{2}} + k^{2} p = 0, \\quad x \\in [0,h]\n$$\n这就构成了余量 $R(p) = \\frac{d^{2}p}{dx^{2}} + k^{2} p$。加权余量法（WRM）要求余量乘以测试函数 $w(x)$ 在单元域上的积分为零：\n$$\n\\int_{0}^{h} w(x) R(p(x)) dx = \\int_{0}^{h} w(x) \\left( \\frac{d^{2}p}{dx^{2}} + k^{2} p \\right) dx = 0\n$$\n问题指定了伽辽金法，其中测试函数 $w(x)$ 与用于近似场变量 $p(x)$ 的试探函数取自同一空间。声压场 $p(x)$ 使用给定的线性拉格朗日形函数 $N_{1}(x)$ 和 $N_{2}(x)$ 以及节点压力值 $p_{1}$ 和 $p_{2}$ 近似为 $p_{h}(x)$：\n$$\np(x) \\approx p_{h}(x) = N_{1}(x) p_{1} + N_{2}(x) p_{2} = \\sum_{j=1}^{2} N_{j}(x) p_{j}\n$$\n在伽辽金框架下，我们对每个测试函数 $w(x) = N_{i}(x)$（其中 $i=1,2$）强制执行加权余量表述。这产生一个包含两个方程的方程组：\n$$\n\\int_{0}^{h} N_{i}(x) \\left( \\frac{d^{2}p_{h}}{dx^{2}} + k^{2} p_{h} \\right) dx = 0, \\quad \\text{for } i=1,2\n$$\n为得到弱形式，我们对二阶导数项应用分部积分法来降低最高阶导数的阶数。令 $u = N_{i}(x)$ 且 $dv = \\frac{d^{2}p_{h}}{dx^{2}} dx$。则 $du = \\frac{dN_{i}}{dx} dx$ 且 $v = \\frac{dp_{h}}{dx}$。\n$$\n\\int_{0}^{h} N_{i}(x) \\frac{d^{2}p_{h}}{dx^{2}} dx = \\left[ N_{i}(x) \\frac{dp_{h}}{dx} \\right]_{0}^{h} - \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dp_{h}}{dx} dx\n$$\n边界项 $\\left[ N_{i}(x) \\frac{dp_{h}}{dx} \\right]_{0}^{h}$ 代表单元节点的通量。根据题目要求，我们考虑的是一个内部单元，在全局组装时，这些通量项预计会与相邻单元相互抵消。因此，在推导单元级方程时，省略此边界项。\n\n将分部积分的结果代回WRM表述，得到单元的弱形式：\n$$\n- \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dp_{h}}{dx} dx + \\int_{0}^{h} N_{i}(x) k^{2} p_{h}(x) dx = 0\n$$\n用其展开式 $\\sum_{j=1}^{2} N_{j}(x) p_{j}$ 替换 $p_{h}(x)$，我们得到：\n$$\n- \\int_{0}^{h} \\frac{dN_{i}}{dx} \\left( \\sum_{j=1}^{2} \\frac{dN_{j}}{dx} p_{j} \\right) dx + k^{2} \\int_{0}^{h} N_{i}(x) \\left( \\sum_{j=1}^{2} N_{j}(x) p_{j} \\right) dx = 0\n$$\n由于节点值 $p_{j}$ 相对于积分是常数，我们可以写出：\n$$\n\\sum_{j=1}^{2} \\left( \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx \\right) p_{j} - k^{2} \\sum_{j=1}^{2} \\left( \\int_{0}^{h} N_{i}(x) N_{j}(x) dx \\right) p_{j} = 0\n$$\n这个关于 $i=1,2$ 的方程组可以写成矩阵形式 $(K_{e} - k^{2} M_{e}) \\mathbf{p}_{e} = \\mathbf{0}$，其中 $\\mathbf{p}_{e} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}$。单元刚度矩阵 $K_{e}$ 和质量矩阵 $M_{e}$ 的元素由以下公式给出：\n$$\n(K_{e})_{ij} = \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx \\qquad \\text{and} \\qquad (M_{e})_{ij} = \\int_{0}^{h} N_{i}(x) N_{j}(x) dx\n$$\n形函数及其导数为：\n$N_{1}(x) = 1 - \\frac{x}{h} \\implies \\frac{dN_{1}}{dx} = -\\frac{1}{h}$\n$N_{2}(x) = \\frac{x}{h} \\implies \\frac{dN_{2}}{dx} = \\frac{1}{h}$\n\n我们现在计算 $2 \\times 2$ 矩阵 $K_{e}$ 和 $M_{e}$ 的元素。\n对于刚度矩阵 $K_{e}$：\n$(K_{e})_{11} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) dx = \\frac{1}{h^{2}} \\int_{0}^{h} dx = \\frac{h}{h^{2}} = \\frac{1}{h}$\n$(K_{e})_{12} = (K_{e})_{21} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^{2}} \\int_{0}^{h} dx = -\\frac{h}{h^{2}} = -\\frac{1}{h}$\n$(K_{e})_{22} = \\int_{0}^{h} \\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = \\frac{1}{h^{2}} \\int_{0}^{h} dx = \\frac{h}{h^{2}} = \\frac{1}{h}$\n因此，$K_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n\n对于质量矩阵 $M_{e}$：\n$(M_{e})_{11} = \\int_{0}^{h} N_{1}^{2}(x) dx = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)^{2} dx = \\left[ -\\frac{h}{3}\\left(1-\\frac{x}{h}\\right)^{3} \\right]_{0}^{h} = 0 - \\left(-\\frac{h}{3}(1)^{3}\\right) = \\frac{h}{3}$\n$(M_{e})_{12} = (M_{e})_{21} = \\int_{0}^{h} N_{1}(x)N_{2}(x) dx = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)\\left(\\frac{x}{h}\\right) dx = \\int_{0}^{h} \\left(\\frac{x}{h} - \\frac{x^{2}}{h^{2}}\\right) dx = \\left[ \\frac{x^{2}}{2h} - \\frac{x^{3}}{3h^{2}} \\right]_{0}^{h} = \\frac{h^{2}}{2h} - \\frac{h^{3}}{3h^{2}} = \\frac{h}{2} - \\frac{h}{3} = \\frac{h}{6}$\n$(M_{e})_{22} = \\int_{0}^{h} N_{2}^{2}(x) dx = \\int_{0}^{h} \\left(\\frac{x}{h}\\right)^{2} dx = \\frac{1}{h^{2}} \\int_{0}^{h} x^{2} dx = \\frac{1}{h^{2}} \\left[ \\frac{x^{3}}{3} \\right]_{0}^{h} = \\frac{h^{3}}{3h^{2}} = \\frac{h}{3}$\n因此，$M_{e} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$。\n\n最后，亥姆霍兹单元矩阵 $H_{e}$ 构造为 $H_{e} = K_{e} - k^{2}M_{e}$：\n$$\nH_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} - k^{2} \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h} - \\frac{2k^{2}h}{6} & -\\frac{1}{h} - \\frac{k^{2}h}{6} \\\\ -\\frac{1}{h} - \\frac{k^{2}h}{6} & \\frac{1}{h} - \\frac{2k^{2}h}{6} \\end{pmatrix}\n$$\n简化各项，我们得到：\n$H_{11} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\n$H_{12} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{21} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{22} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\n所要求的最终答案是这四个元素组成的行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{h} - \\frac{k^2 h}{3} & -\\frac{1}{h} - \\frac{k^2 h}{6} & -\\frac{1}{h} - \\frac{k^2 h}{6} & \\frac{1}{h} - \\frac{k^2 h}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在构建了单元矩阵之后，一个关键问题随之而来：我们的数值解的精度如何？本练习深入探讨了数值色散分析，这是评估波动问题数值方法性能的核心工具。通过研究波在离散网格上的传播方式，我们将推导出真实波数 $k$ 与数值波数 $k_{h}$ 之间的关系，从而量化方法固有的相位误差。 这个过程揭示了为什么数值解会“污染”并偏离真实解，尤其是在高频情况下。",
            "id": "4149538",
            "problem": "考虑由齐次亥姆霍兹方程 $- \\frac{d^{2}p}{dx^{2}} - k^{2} p = 0$ 描述的一维时谐声波传播，其中 $p(x)$ 是声压场，$k$ 是实波数。使用加权余量法，并采用检验函数等于试函数的 Galerkin 选择，在间距为 $h$ 的均匀网格上，用连续分段线性基函数来近似 $p(x)$。假设网格是无限均匀的，因此在由 $j \\in \\mathbb{Z}$ 索引的节点上，离散布洛赫波拟设 $p_{j} = A \\exp(i j \\theta)$（其中 $\\theta = k_{h} h$）成立，这里 $k_{h}$ 是数值（离散）波数。\n\n从亥姆霍兹问题的弱形式出发，并仅使用与 Galerkin 有限元法产生的刚度矩阵和质量矩阵相关的双线性形式的标准定义，推导该离散化下连接 $k$ 和 $k_{h}$ 的离散色散关系。然后，将相对相位误差定义为 $\\delta_{\\phi}(k h) = \\frac{k_{h} - k}{k}$，并将其表示为无量纲参数 $k h$ 的闭式解析函数。所有角度都应理解为弧度。提供 $\\delta_{\\phi}(k h)$ 的最终答案，该答案应为仅以 $k h$ 表示的单个解析表达式。不需要进行数值近似或四舍五入。",
            "solution": "用户想要推导亥姆霍兹方程的一维有限元离散化的相对相位误差。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件**\n-   控制方程：$- \\frac{d^{2}p}{dx^{2}} - k^{2} p = 0$\n-   $p(x)$：声压场\n-   $k$：实波数\n-   方法：加权余量法，采用 Galerkin 选择（检验函数等于试函数）\n-   基函数：连续分段线性基函数\n-   网格：间距为 $h$ 的无限均匀网格\n-   离散化：在由 $j \\in \\mathbb{Z}$ 索引的节点上的节点值 $p_j$\n-   拟设：离散布洛赫波拟设 $p_{j} = A \\exp(i j \\theta)$，其中 $\\theta = k_{h} h$\n-   $k_{h}$：数值（离散）波数\n-   定义：相对相位误差 $\\delta_{\\phi}(k h) = \\frac{k_{h} - k}{k}$\n-   目标：推导离散色散关系，然后将 $\\delta_{\\phi}(k h)$ 表示为无量纲参数 $k h$ 的闭式解析函数。\n\n**1.2. 使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于亥姆霍兹方程（时谐波传播的标准模型）和 Galerkin 有限元法（计算力学的基石）。使用布洛赫波拟设来分析周期性网格（均匀网格）上的波传播是数值分析中的一种标准且有效的方法。该问题在科学上是合理的。\n-   **适定性**：问题陈述清晰，提供了所有必要信息，并要求进行特定的推导，以得到唯一的解析表达式。\n-   **客观性**：问题以精确、客观和数学化的语言陈述。\n-   **完整性和一致性**：问题是自洽的。控制方程、边界条件（隐含在无限网格假设中）、基函数和分析方法都已指定，并且相互一致。\n-   **可行性**：所要求的推导是波传播数值方法分析中的一个标准练习，完全可行。\n\n**1.3. 结论与行动**\n问题有效。将继续进行求解过程。\n\n### 第 2 步：求解推导\n\n该过程从亥姆霍兹方程的弱形式开始。其强形式为：\n$$ - \\frac{d^{2}p}{dx^{2}} - k^{2} p = 0 $$\n我们乘以一个检验函数 $w(x)$ 并在定义域 $\\Omega = (-\\infty, \\infty)$ 上积分。\n$$ \\int_{-\\infty}^{\\infty} w \\left( - \\frac{d^{2}p}{dx^{2}} - k^{2} p \\right) dx = 0 $$\n对二阶导数项应用分部积分：\n$$ \\int_{-\\infty}^{\\infty} \\left( \\frac{dw}{dx} \\frac{dp}{dx} - k^{2} w p \\right) dx - \\left[ w \\frac{dp}{dx} \\right]_{-\\infty}^{\\infty} = 0 $$\n由于检验函数（和基函数）具有紧支集，边界项消失。弱形式为：求 $p(x)$，使得对于所有容许的检验函数 $w(x)$：\n$$ \\int_{-\\infty}^{\\infty} \\left( \\frac{dw}{dx} \\frac{dp}{dx} - k^{2} w p \\right) dx = 0 $$\n\n接下来，我们应用 Galerkin 有限元法。声压 $p(x)$ 由连续分段线性基函数 $N_j(x)$ 的线性组合来近似：\n$$ p(x) \\approx p_{h}(x) = \\sum_{j \\in \\mathbb{Z}} p_{j} N_{j}(x) $$\n其中 $p_j$ 是位于 $x_j = jh$ 处的节点 $j$ 上的压力节点值。函数 $N_j(x)$ 是标准的“帽子”函数，仅在区间 $[(j-1)h, (j+1)h]$ 上非零。在 Galerkin 方法中，检验函数选自与基函数相同的空间，因此我们为每个节点 $i \\in \\mathbb{Z}$ 设置 $w(x) = N_{i}(x)$。\n将近似解 $p_h(x)$ 和检验函数 $N_i(x)$ 代入弱形式，得到离散方程组：\n$$ \\sum_{j \\in \\mathbb{Z}} p_{j} \\left( \\int_{-\\infty}^{\\infty} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx - k^{2} \\int_{-\\infty}^{\\infty} N_{i} N_{j} dx \\right) = 0 \\quad \\forall i \\in \\mathbb{Z} $$\n这可以写成矩阵形式 $(\\mathbf{K} - k^2 \\mathbf{M})\\mathbf{p} = 0$，其中刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 的元素为：\n$$ K_{ij} = \\int_{-\\infty}^{\\infty} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx \\quad \\text{和} \\quad M_{ij} = \\int_{-\\infty}^{\\infty} N_{i} N_{j} dx $$\n\n由于基函数的局部支集特性，通用节点 $i$ 的方程仅涉及其直接邻居 $i-1$ 和 $i+1$。我们计算与一个通用节点（不失一般性地，我们可以将其标记为节点 0）相对应的行的非零矩阵元素。\n基函数 $N_0(x)$ 定义为：\n$$ N_0(x) = \\begin{cases} 1 + x/h & \\text{for } x \\in [-h, 0] \\\\ 1 - x/h & \\text{for } x \\in [0, h] \\\\ 0 & \\text{otherwise} \\end{cases} \\quad \\implies \\quad \\frac{dN_0}{dx} = \\begin{cases} 1/h & \\text{for } x \\in (-h, 0) \\\\ -1/h & \\text{for } x \\in (0, h) \\\\ 0 & \\text{otherwise} \\end{cases} $$\n刚度矩阵元素为：\n$$ K_{00} = \\int_{-h}^{h} \\left( \\frac{dN_{0}}{dx} \\right)^{2} dx = \\int_{-h}^{0} \\left(\\frac{1}{h}\\right)^{2} dx + \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)^{2} dx = \\frac{1}{h^2}(h) + \\frac{1}{h^2}(h) = \\frac{2}{h} $$\n$$ K_{01} = \\int_{0}^{h} \\frac{dN_{0}}{dx} \\frac{dN_{1}}{dx} dx = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right) \\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^2} (h) = -\\frac{1}{h} $$\n根据对称性，$K_{0,-1} = K_{01} = -1/h$。\n\n质量矩阵元素为：\n$$ M_{00} = \\int_{-h}^{h} N_{0}(x)^{2} dx = \\int_{-h}^{0} (1+x/h)^{2} dx + \\int_{0}^{h} (1-x/h)^{2} dx = 2 \\int_{0}^{h} (1-x/h)^{2} dx = 2 \\left[ -\\frac{h}{3}(1-x/h)^3 \\right]_{0}^{h} = \\frac{2h}{3} $$\n$$ M_{01} = \\int_{0}^{h} N_{0}(x) N_{1}(x) dx = \\int_{0}^{h} (1-x/h)(x/h) dx = \\left[ \\frac{x^2}{2h} - \\frac{x^3}{3h^2} \\right]_{0}^{h} = \\frac{h}{2} - \\frac{h}{3} = \\frac{h}{6} $$\n根据对称性，$M_{0,-1} = M_{01} = h/6$。\n\n因此，通用节点 $j$ 的方程为：\n$$ K_{j,j-1}p_{j-1} + K_{j,j}p_{j} + K_{j,j+1}p_{j+1} - k^2(M_{j,j-1}p_{j-1} + M_{j,j}p_{j} + M_{j,j+1}p_{j+1}) = 0 $$\n代入计算出的值：\n$$ -\\frac{1}{h} p_{j-1} + \\frac{2}{h} p_{j} - \\frac{1}{h} p_{j+1} - k^{2} \\left( \\frac{h}{6} p_{j-1} + \\frac{2h}{3} p_{j} + \\frac{h}{6} p_{j+1} \\right) = 0 $$\n现在我们代入离散布洛赫波拟设 $p_{j} = A \\exp(i j \\theta)$，其中 $\\theta = k_h h$。这得到 $p_{j-1} = p_{j} \\exp(-i\\theta)$ 和 $p_{j+1} = p_{j} \\exp(i\\theta)$。代入并除以 $p_j$ 得到：\n$$ -\\frac{1}{h} \\exp(-i\\theta) + \\frac{2}{h} - \\frac{1}{h} \\exp(i\\theta) - k^{2}h \\left( \\frac{1}{6} \\exp(-i\\theta) + \\frac{2}{3} + \\frac{1}{6} \\exp(i\\theta) \\right) = 0 $$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$，我们对各项进行分组：\n$$ \\frac{1}{h} (2 - (\\exp(i\\theta) + \\exp(-i\\theta))) - \\frac{k^{2}h}{6} ((\\exp(i\\theta) + \\exp(-i\\theta)) + 4) = 0 $$\n$$ \\frac{2}{h} (1 - \\cos\\theta) - \\frac{k^{2}h}{6} (2\\cos\\theta + 4) = 0 $$\n$$ \\frac{2}{h} (1 - \\cos\\theta) = \\frac{k^{2}h}{3} (\\cos\\theta + 2) $$\n这就是离散色散关系。我们对其进行重排以求解 $\\cos\\theta$：\n$$ 6(1 - \\cos\\theta) = (kh)^{2} (2 + \\cos\\theta) $$\n$$ 6 - 6\\cos\\theta = 2(kh)^{2} + (kh)^{2}\\cos\\theta $$\n$$ 6 - 2(kh)^{2} = \\cos\\theta (6 + (kh)^{2}) $$\n$$ \\cos\\theta = \\cos(k_{h}h) = \\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}} $$\n为了求 $k_h$，我们取反余弦。由于波数是非负的，我们取主值。\n$$ k_{h}h = \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) $$\n$$ k_{h} = \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) $$\n相对相位误差定义为 $\\delta_{\\phi}(kh) = \\frac{k_{h} - k}{k} = \\frac{k_h}{k} - 1$。\n代入 $k_h$ 的表达式：\n$$ \\delta_{\\phi}(kh) = \\frac{1}{k} \\left( \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) \\right) - 1 $$\n将括号中的项乘以 $h/h$：\n$$ \\delta_{\\phi}(kh) = \\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) - 1 $$\n这就是相对相位误差作为无量纲参数 $kh$ 的函数的最终闭式表达式。\narccos 的自变量可以简化为 $\\frac{3 - (kh)^2}{3 + \\frac{1}{2}(kh)^2}$，但形式 $\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}$ 在算术上是等价的，并且是直接推导出来的。",
            "answer": "$$\\boxed{\\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) - 1}$$"
        },
        {
            "introduction": "伽辽金法，即选择与试函数相同的检验函数，虽然应用广泛，但并非总是最佳选择。本练习将介绍一种更广义的框架——彼得罗夫-伽辽金法（Petrov-Galerkin method），特别是流线迎风彼得罗夫-伽辽金（SUPG）技术。通过精心选择与试函数不同的检验函数，我们可以为数值格式引入稳定性，以解决更具挑战性的问题。 这项实践展示了加权余量法框架的强大功能和灵活性，突显了检验函数在控制解的性质方面的关键作用。",
            "id": "4149589",
            "problem": "考虑一个长度为 $L>0$、具有恒定质量密度 $\\rho>0$ 和声速 $c>0$ 的管道中的一维、均匀、无损、频域声学问题。令 $p(x)$ 表示声压，$u(x)$ 表示质点速度。对于角频率为 $\\omega>0$ 的频域线性声学问题，其控制一阶方程组为\n$$\n\\partial_{x} p(x) + i\\,\\omega\\,\\rho\\,u(x) = 0, \\qquad \\partial_{x} u(x) + i\\,\\omega\\,\\kappa\\,p(x) = 0,\n$$\n其中可压缩性为 $\\kappa = \\frac{1}{\\rho\\,c^{2}}$，亥姆霍兹波数为 $k = \\frac{\\omega}{c}$。假设在 $x=0$ 和 $x=L$ 处有适当的边界条件，这些条件不改变内部的加权残差构造。\n\n在包含 $N$ 个尺寸为 $h = \\frac{L}{N}$ 的单元的均匀网格上，使用连续分段线性试探函数对 $p(x)$ 和 $u(x)$ 进行离散化。令 $\\{N_{j}(x)\\}_{j=1}^{M}$ 为试探空间的节点基底（其中 $M = N+1$），并近似为\n$$\np_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,p_{j}, \\qquad u_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,u_{j},\n$$\n其中 $\\{p_{j}\\}$ 和 $\\{u_{j}\\}$ 是节点自由度。\n\n使用流线迎风Petrov-Galerkin (SUPG) 方法，在 $+x$ 方向上构造一个带有轻微迎风偏置的Petrov-Galerkin测试基底：对于每个试探基函数 $N_{i}(x)$，定义相应的测试函数\n$$\nW_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x),\n$$\n其中稳定化参数取为\n$$\n\\tau = \\frac{\\beta}{i\\,k},\n$$\n其中无量纲偏置参数 $\\beta \\in (0,1)$ 指定了一个相对于由 $k$ 设定的局部振荡尺度的轻微迎风加权。\n\n从控制一阶方程组出发，使用加权残差法和Petrov-Galerkin测试函数 $\\{W_{i}\\}$ 来推导修正后的离散残差方程。将与 $N_{i}$ 相关的两个残差项（表示为 $R_{i}^{p}$ 和 $R_{i}^{u}$）表示为包含 $\\{N_{j}\\}$ 及其导数、节点未知数 $\\{p_{j}\\}$ 和 $\\{u_{j}\\}$ 的闭式解析表达式，并通过 $\\tau$ 包含SUPG修正项。\n\n你的最终答案必须是表示为双元素行矩阵的 $(R_{i}^{p}, R_{i}^{u})$ 对的单个闭式解析表达式。不需要进行数值计算，也不适用四舍五入。在你的最终方框表达式中不要包含物理单位。",
            "solution": "根据既定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **控制方程组：** $\\partial_{x} p(x) + i\\,\\omega\\,\\rho\\,u(x) = 0$ 和 $\\partial_{x} u(x) + i\\,\\omega\\,\\kappa\\,p(x) = 0$。\n-   **域：** 长度为 $L>0$ 的一维管道。\n-   **物理常数：** 质量密度 $\\rho>0$，声速 $c>0$，角频率 $\\omega>0$。\n-   **派生参数：** 可压缩性 $\\kappa = \\frac{1}{\\rho\\,c^{2}}$，亥姆霍兹波数 $k = \\frac{\\omega}{c}$。\n-   **边界条件：** 假设为适当的，不改变内部公式。\n-   **试探函数：** 在均匀网格上的连续分段线性函数 $\\{N_{j}(x)\\}_{j=1}^{M}$（$M=N+1$）。\n-   **离散近似：** $p_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,p_{j}$ 和 $u_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,u_{j}$。\n-   **测试函数 (Petrov-Galerkin)：** $W_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)$。\n-   **稳定化参数：** $\\tau = \\frac{\\beta}{i\\,k}$，其中 $\\beta \\in (0,1)$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 控制方程代表了线性、时谐声学的标准一阶系统。流线迎风Petrov-Galerkin (SUPG) 方法是一种成熟且科学上合理的数值技术，用于稳定求解平流-扩散-反应型方程，亥姆霍兹方程（可从此系统导出）即属于此类。稳定化参数 $\\tau$ 的选择与亥姆霍兹问题的标准做法一致。\n-   **适定性：** 任务是推导离散残差方程，这是一个定义明确的数学推导过程。它不需要求解该系统，因此对边界条件的抽象说明是足够的。\n-   **客观性与清晰度：** 问题使用来自物理学和数值分析的精确、标准术语陈述，没有歧义或主观语言。\n-   **完整性与一致性：** 提供了执行推导所需的所有必要信息（控制方程、离散化方案、测试函数、参数定义）。没有矛盾之处。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的和自洽的。因此，它被判定为**有效**。现在开始进行解答的推导。\n\n### 残差方程的推导\n\n加权残差法要求，用近似解 $p_{h}(x)$ 和 $u_{h}(x)$ 计算的控制微分方程的残差，与测试函数空间 $\\{W_{i}(x)\\}$ 正交。\n\n压力和速度方程的残差为：\n$$\n\\text{Res}_{p}(x) = \\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\n$$\n$$\n\\text{Res}_{u}(x) = \\partial_{x} u_{h}(x) + i\\,\\omega\\,\\kappa\\,p_{h}(x)\n$$\n\n第 $i$ 个节点的离散残差方程是通过将测试函数 $W_{i}(x)$ 与方程残差的乘积在域 $\\Omega = [0, L]$ 上积分得到的。\n$$\nR_{i}^{p} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{p}(x) \\,dx = 0\n$$\n$$\nR_{i}^{u} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{u}(x) \\,dx = 0\n$$\n\n问题要求给出 $R_{i}^{p}$ 和 $R_{i}^{u}$ 的表达式。我们将SUPG测试函数的定义 $W_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)$ 代入这些积分中。\n\n对于压力残差 $R_{i}^{p}$：\n$$\nR_{i}^{p} = \\int_{0}^{L} \\left(N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)\\right) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx\n$$\n这可以分为标准Galerkin项和SUPG稳定项：\n$$\nR_{i}^{p} = \\int_{0}^{L} N_{i}(x) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx + \\tau \\int_{0}^{L} \\partial_{x} N_{i}(x) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx\n$$\n现在，代入离散近似 $p_{h}(x) = \\sum_{j=1}^{M} p_{j}N_{j}(x)$ 和 $u_{h}(x) = \\sum_{j=1}^{M} u_{j}N_{j}(x)$：\n$$\nR_{i}^{p} = \\int_{0}^{L} N_{i} \\left(\\sum_{j=1}^{M} p_{j} \\partial_{x}N_{j} + i\\,\\omega\\,\\rho \\sum_{j=1}^{M} u_{j}N_{j}\\right) \\,dx + \\tau \\int_{0}^{L} \\partial_{x} N_{i} \\left(\\sum_{j=1}^{M} p_{j} \\partial_{x}N_{j} + i\\,\\omega\\,\\rho \\sum_{j=1}^{M} u_{j}N_{j}\\right) \\,dx\n$$\n由于节点值 $p_j$ 和 $u_j$ 相对于积分是常数，我们可以重新排列求和与积分：\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} p_{j} \\left(\\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx\\right) + \\sum_{j=1}^{M} u_{j} \\left(i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\rho\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx\\right)\n$$\n\n类似地，对于速度残差 $R_{i}^{u}$：\n$$\nR_{i}^{u} = \\int_{0}^{L} \\left(N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)\\right) \\left(\\partial_{x} u_{h}(x) + i\\,\\omega\\,\\kappa\\,p_{h}(x)\\right) \\,dx\n$$\n遵循相同的步骤：\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} u_{j} \\left(\\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx\\right) + \\sum_{j=1}^{M} p_{j} \\left(i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\kappa\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx\\right)\n$$\n这些是关于 $\\tau$ 的通用表达式。为了得到最终形式，我们代入 $\\tau = \\frac{\\beta}{i\\,k}$ 并使用 $k = \\frac{\\omega}{c}$ 和 $\\kappa = \\frac{1}{\\rho\\,c^2}$ 来简化系数。\n\n考虑 $R_i^p$ 中 $u_j$ 项的稳定化系数：\n$$\ni\\,\\omega\\,\\rho\\,\\tau = i\\,\\omega\\,\\rho \\left(\\frac{\\beta}{i\\,k}\\right) = \\frac{\\omega\\,\\rho\\,\\beta}{k} = \\frac{\\omega\\,\\rho\\,\\beta}{\\omega/c} = \\rho\\,c\\,\\beta\n$$\n考虑 $R_i^u$ 中 $p_j$ 项的稳定化系数：\n$$\ni\\,\\omega\\,\\kappa\\,\\tau = i\\,\\omega\\,\\kappa \\left(\\frac{\\beta}{i\\,k}\\right) = \\frac{\\omega\\,\\kappa\\,\\beta}{k} = \\frac{\\omega (\\frac{1}{\\rho\\,c^2}) \\beta}{\\omega/c} = \\frac{\\beta}{\\rho\\,c}\n$$\n对于导数项，$\\tau = \\frac{\\beta}{i\\,k} = -i\\frac{\\beta}{k}$。\n\n将这些简化形式代回 $R_i^p$ 和 $R_i^u$ 的表达式中，即可得到最终的闭式表达式。\n\n对于 $R_{i}^{p}$：\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n$$\n对于 $R_{i}^{u}$：\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n$$\n这些表达式代表了声学方程SUPG离散化后所得线性系统的第 $i$ 行。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n&\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n\\end{pmatrix}\n}\n$$"
        }
    ]
}