{
    "hands_on_practices": [
        {
            "introduction": "The journey from a continuous partial differential equation to a solvable algebraic system is the cornerstone of the Finite Element Method. This first practice lays the groundwork by taking you through this fundamental process in the simplest setting: a one-dimensional acoustic duct. By applying the Galerkin weighted residual method, you will derive the element stiffness and mass matrices from first principles, providing a concrete understanding of how physical properties are encoded into the discrete system .",
            "id": "4149623",
            "problem": "Consider a one-dimensional, homogeneous, lossless acoustic duct of unit cross-sectional area, in which the time-harmonic acoustic pressure field satisfies the Helmholtz partial differential equation (PDE)\n$$\n\\frac{d^{2}p}{dx^{2}} + k^{2} p = 0\n$$\non a generic finite element $e = [x_{a}, x_{b}]$ of length $h = x_{b} - x_{a}$, where $k$ is the acoustic wavenumber. Use the Weighted Residual Method (WRM) with the Galerkin choice of test functions (trial and test functions drawn from the same finite-dimensional space) to derive the element-level weak form. Assume an interior element so that inter-element flux terms cancel upon assembly, and no external boundary contribution arises at the element level.\n\nAdopt linear Lagrange trial and test functions on the element, and use a local element coordinate with $x \\in [0,h]$ so that the two nodal shape functions are\n$$\nN_{1}(x) = 1 - \\frac{x}{h}, \\qquad N_{2}(x) = \\frac{x}{h}.\n$$\nStarting from the strong form and the WRM statement, perform the integration by parts to obtain the weak form and identify the element mass and stiffness matrices $M_{e}$ and $K_{e}$. Then, write explicit closed-form expressions (in terms of $h$ only) for all entries of $M_{e}$ and $K_{e}$, and hence for the Helmholtz element matrix\n$$\nH_{e} = K_{e} - k^{2} M_{e}.\n$$\n\nAnswer specification:\n- Report your final answer as the row vector containing the entries $\\bigl[H_{11},\\, H_{12},\\, H_{21},\\, H_{22}\\bigr]$ of the $2 \\times 2$ matrix $H_{e}$, in exact analytic form.\n- Do not include units in your final answer. No rounding is required.",
            "solution": "The Weighted Residual Method (WRM) begins with the governing PDE, which defines the residual $R(p) = \\frac{d^{2}p}{dx^{2}} + k^{2} p$. The method requires that the integral of this residual, weighted by a test function $w(x)$, is zero over the element domain $e = [0,h]$:\n$$\n\\int_{0}^{h} w(x) R(p(x)) dx = \\int_{0}^{h} w(x) \\left( \\frac{d^{2}p}{dx^{2}} + k^{2} p \\right) dx = 0\n$$\nTo obtain the weak form, we apply integration by parts to the second-derivative term:\n$$\n\\int_{0}^{h} w(x) \\frac{d^{2}p}{dx^{2}} dx = \\left[ w(x) \\frac{dp}{dx} \\right]_{0}^{h} - \\int_{0}^{h} \\frac{dw}{dx} \\frac{dp}{dx} dx\n$$\nFor an interior element, the boundary flux terms are disregarded at the element level. Substituting this back into the WRM statement gives the element weak form:\n$$\n- \\int_{0}^{h} \\frac{dw}{dx} \\frac{dp}{dx} dx + \\int_{0}^{h} w(x) k^{2} p(x) dx = 0\n$$\nIn the Galerkin method, we approximate the pressure field $p(x)$ as $p_{h}(x) = \\sum_{j=1}^{2} N_{j}(x) p_{j}$ and use the basis functions themselves as test functions, $w(x) = N_{i}(x)$ for $i=1,2$. This yields a system of two equations:\n$$\n\\sum_{j=1}^{2} \\left( \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx \\right) p_{j} - k^{2} \\sum_{j=1}^{2} \\left( \\int_{0}^{h} N_{i}(x) N_{j}(x) dx \\right) p_{j} = 0\n$$\nThis system can be expressed in matrix form as $(K_{e} - k^{2} M_{e}) \\mathbf{p}_{e} = \\mathbf{0}$, where the entries of the element stiffness matrix $K_{e}$ and mass matrix $M_{e}$ are:\n$$\n(K_{e})_{ij} = \\int_{0}^{h} \\frac{dN_{i}}{dx} \\frac{dN_{j}}{dx} dx \\qquad \\text{and} \\qquad (M_{e})_{ij} = \\int_{0}^{h} N_{i}(x) N_{j}(x) dx\n$$\nThe derivatives of the shape functions are $\\frac{dN_{1}}{dx} = -\\frac{1}{h}$ and $\\frac{dN_{2}}{dx} = \\frac{1}{h}$. We compute the matrix entries:\nFor the stiffness matrix $K_{e}$:\n$(K_{e})_{11} = \\int_{0}^{h} (-\\frac{1}{h})(-\\frac{1}{h}) dx = \\frac{1}{h}$\n$(K_{e})_{12} = (K_{e})_{21} = \\int_{0}^{h} (-\\frac{1}{h})(\\frac{1}{h}) dx = -\\frac{1}{h}$\n$(K_{e})_{22} = \\int_{0}^{h} (\\frac{1}{h})(\\frac{1}{h}) dx = \\frac{1}{h}$\nThus, $K_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nFor the mass matrix $M_{e}$:\n$(M_{e})_{11} = \\int_{0}^{h} (1-\\frac{x}{h})^{2} dx = \\frac{h}{3}$\n$(M_{e})_{12} = (M_{e})_{21} = \\int_{0}^{h} (1-\\frac{x}{h})(\\frac{x}{h}) dx = \\frac{h}{6}$\n$(M_{e})_{22} = \\int_{0}^{h} (\\frac{x}{h})^{2} dx = \\frac{h}{3}$\nThus, $M_{e} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$.\n\nThe Helmholtz element matrix $H_{e} = K_{e} - k^{2}M_{e}$ is:\n$$\nH_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} - k^{2} \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h} - \\frac{k^{2}h}{3} & -\\frac{1}{h} - \\frac{k^{2}h}{6} \\\\ -\\frac{1}{h} - \\frac{k^{2}h}{6} & \\frac{1}{h} - \\frac{k^{2}h}{3} \\end{pmatrix}\n$$\nThe requested final answer is the row vector of these four entries.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{h} - \\frac{k^2 h}{3} & -\\frac{1}{h} - \\frac{k^2 h}{6} & -\\frac{1}{h} - \\frac{k^2 h}{6} & \\frac{1}{h} - \\frac{k^2 h}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After discretizing a problem, a crucial question arises: how accurately does our numerical model capture the true physics? For wave phenomena, this is often a question of phase accuracy. This exercise moves from matrix construction to method analysis by introducing the concept of numerical dispersion, quantifying the error between the computed wave speed and the exact wave speed as a function of mesh size. By performing a Bloch-wave analysis on a uniform mesh, you will derive the phase error, a critical metric for assessing the fidelity of wave propagation simulations .",
            "id": "4149538",
            "problem": "Consider one-dimensional time-harmonic acoustic propagation described by the homogeneous Helmholtz equation $- \\frac{d^{2}p}{dx^{2}} - k^{2} p = 0$, where $p(x)$ is the acoustic pressure field and $k$ is the real wavenumber. Using the method of weighted residuals with the Galerkin choice of test functions equal to the trial functions, approximate $p(x)$ on a uniform mesh of spacing $h$ with continuous, piecewise-linear basis functions. Assume an infinite, uniform mesh so that a discrete Bloch-wave ansatz $p_{j} = A \\exp(i j \\theta)$ with $\\theta = k_{h} h$ holds at the nodes indexed by $j \\in \\mathbb{Z}$, where $k_{h}$ is the numerical (discrete) wavenumber.\n\nStarting from the weak form of the Helmholtz problem and using only the standard definitions of the bilinear forms associated with the stiffness and mass matrices that arise from the Galerkin finite element method, derive the discrete dispersion relation linking $k$ and $k_{h}$ for this discretization. Then, define the relative phase error as $\\delta_{\\phi}(k h) = \\frac{k_{h} - k}{k}$ and express it as a closed-form analytic function of the dimensionless parameter $k h$. All angles are to be understood in radians. Provide the final answer as a single analytic expression for $\\delta_{\\phi}(k h)$ in terms of $k h$ only. No numerical approximation or rounding is required.",
            "solution": "The weak form of the Helmholtz equation is derived by multiplying by a test function $w$ and integrating by parts: Find $p$ such that for all $w$, $\\int \\frac{dw}{dx} \\frac{dp}{dx} dx - k^2 \\int w p dx = 0$.\nWe apply the Galerkin finite element method using continuous, piecewise-linear basis functions $N_j(x)$ on a uniform mesh. The discrete equation for a generic interior node $j$ involves contributions from itself and its neighbors, $j-1$ and $j+1$:\n$$\n\\sum_{m=j-1}^{j+1} \\left( K_{jm} - k^2 M_{jm} \\right) p_m = 0,\n$$\nwhere $p_m$ is the nodal value at node $m$, and $K_{jm}$ and $M_{jm}$ are the global stiffness and mass matrix entries. For linear elements, the stencil is:\n$K_{j,j-1} = -1/h$, $K_{jj} = 2/h$, $K_{j,j+1} = -1/h$\n$M_{j,j-1} = h/6$, $M_{jj} = 2h/3$, $M_{j,j+1} = h/6$\n\nThe resulting equation for node $j$ is:\n$$\n\\left(-\\frac{1}{h} p_{j-1} + \\frac{2}{h} p_{j} - \\frac{1}{h} p_{j+1}\\right) - k^2 \\left(\\frac{h}{6} p_{j-1} + \\frac{2h}{3} p_{j} + \\frac{h}{6} p_{j+1}\\right) = 0\n$$\nWe now substitute the discrete Bloch-wave ansatz $p_{j} = A e^{i j \\theta}$, with $\\theta = k_h h$. This implies $p_{j-1} = p_j e^{-i\\theta}$ and $p_{j+1} = p_j e^{i\\theta}$. Substituting and dividing by $p_j$ yields the discrete dispersion relation:\n$$\n\\left(-\\frac{1}{h} e^{-i\\theta} + \\frac{2}{h} - \\frac{1}{h} e^{i\\theta}\\right) - k^2 \\left(\\frac{h}{6} e^{-i\\theta} + \\frac{2h}{3} + \\frac{h}{6} e^{i\\theta}\\right) = 0\n$$\nUsing Euler's formula, $\\cos\\theta = (e^{i\\theta} + e^{-i\\theta})/2$, we can simplify the expressions in parentheses:\n$$\n\\frac{1}{h}(2 - 2\\cos\\theta) - k^2 h \\left(\\frac{1}{3}\\cos\\theta + \\frac{2}{3}\\right) = 0\n$$\nMultiplying by $h$ and rearranging gives:\n$$\n2(1 - \\cos\\theta) = \\frac{(kh)^2}{3}(2 + \\cos\\theta)\n$$\nWe now solve for $\\cos\\theta = \\cos(k_h h)$:\n$$\n6(1 - \\cos\\theta) = (kh)^2 (2 + \\cos\\theta) \\implies 6 - 6\\cos\\theta = 2(kh)^2 + (kh)^2 \\cos\\theta\n$$\n$$\n6 - 2(kh)^2 = \\cos\\theta (6 + (kh)^2) \\implies \\cos(k_h h) = \\frac{6 - 2(kh)^2}{6 + (kh)^2}\n$$\nSolving for the numerical wavenumber $k_h$:\n$$\nk_h = \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^2}{6 + (kh)^2}\\right)\n$$\nThe relative phase error is defined as $\\delta_{\\phi}(kh) = \\frac{k_h - k}{k} = \\frac{k_h}{k} - 1$. Substituting our expression for $k_h$:\n$$\n\\delta_{\\phi}(kh) = \\frac{1}{k} \\left( \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^2}{6 + (kh)^2}\\right) \\right) - 1\n$$\n$$\n\\delta_{\\phi}(kh) = \\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^2}{6 + (kh)^2}\\right) - 1\n$$\nThis is the final closed-form expression for the relative phase error as a function of the dimensionless parameter $kh$.",
            "answer": "$$\\boxed{\\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) - 1}$$"
        },
        {
            "introduction": "While the Galerkin method, where test and trial functions are identical, is a powerful default, there are compelling reasons to choose them differently. This practice introduces the Petrov-Galerkin framework, a paradigm where the test space is intentionally modified to enhance the numerical scheme. You will construct a Streamline Upwind Petrov-Galerkin (SUPG) method for a first-order acoustic system, demonstrating how adding a carefully designed \"upwind\" bias to the test function can introduce stabilization, a key technique for solving challenging wave problems .",
            "id": "4149589",
            "problem": "Consider one-dimensional, homogeneous, lossless, frequency-domain acoustics in a duct of length $L>0$ with constant mass density $\\rho>0$ and sound speed $c>0$. Let $p(x)$ denote the acoustic pressure and $u(x)$ the particle velocity. The governing first-order system corresponding to linear acoustics in the frequency domain with angular frequency $\\omega>0$ is\n$$\n\\partial_{x} p(x) + i\\,\\omega\\,\\rho\\,u(x) = 0, \\qquad \\partial_{x} u(x) + i\\,\\omega\\,\\kappa\\,p(x) = 0,\n$$\nwhere the compressibility is $\\kappa = \\frac{1}{\\rho\\,c^{2}}$, and the Helmholtz wavenumber is $k = \\frac{\\omega}{c}$. Assume suitable boundary conditions at $x=0$ and $x=L$ that do not alter the interior weighted residual construction.\n\nDiscretize $p(x)$ and $u(x)$ by continuous, piecewise linear trial functions on a uniform mesh of $N$ elements of size $h = \\frac{L}{N}$. Let $\\{N_{j}(x)\\}_{j=1}^{M}$ be the nodal basis for the trial space (with $M = N+1$), and approximate\n$$\np_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,p_{j}, \\qquad u_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,u_{j},\n$$\nwhere $\\{p_{j}\\}$ and $\\{u_{j}\\}$ are the nodal degrees of freedom.\n\nConstruct a Petrov-Galerkin test basis with slight upwind bias in the $+x$ direction using a Streamline Upwind Petrov-Galerkin (SUPG) choice: for each trial basis function $N_{i}(x)$, define the corresponding test function\n$$\nW_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x),\n$$\nwhere the stabilization parameter is taken to be\n$$\n\\tau = \\frac{\\beta}{i\\,k},\n$$\nwith a dimensionless bias parameter $\\beta \\in (0,1)$ prescribing a slight upwind weighting relative to the local oscillatory scale set by $k$.\n\nStarting from the governing first-order system, use the weighted residual method with the Petrov-Galerkin test functions $\\{W_{i}\\}$ to derive the modified discrete residual equations. Express the two residual entries associated with $N_{i}$, denoted $R_{i}^{p}$ and $R_{i}^{u}$, as closed-form analytic expressions in terms of $\\{N_{j}\\}$, their derivatives, and the nodal unknowns $\\{p_{j}\\}$ and $\\{u_{j}\\}$, including the SUPG modification via $\\tau$.\n\nYour final answer must be a single closed-form analytic expression for the pair $(R_{i}^{p}, R_{i}^{u})$ written as a two-entry row matrix. No numerical evaluation is required and no rounding applies. Do not include physical units in your final boxed expression.",
            "solution": "The weighted residual method requires that the residuals of the governing equations, when evaluated with the approximate solutions $p_h(x)$ and $u_h(x)$, are orthogonal to the test function space $\\{W_i(x)\\}$. The residuals for the two first-order equations are:\n$$\n\\text{Res}_{p}(x) = \\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\n$$\n$$\n\\text{Res}_{u}(x) = \\partial_{x} u_{h}(x) + i\\,\\omega\\,\\kappa\\,p_{h}(x)\n$$\nThe discrete residual equations for the $i$-th node, $R_i^p$ and $R_i^u$, are formed by integrating the product of the test function $W_i(x)$ and the corresponding residual over the domain $\\Omega = [0, L]$:\n$$\nR_{i}^{p} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{p}(x) \\,dx = 0, \\qquad R_{i}^{u} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{u}(x) \\,dx = 0\n$$\nWe substitute the definition of the SUPG test function, $W_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)$, into these integrals.\n\nFor the pressure residual, $R_{i}^{p}$:\n$$\nR_{i}^{p} = \\int_{0}^{L} \\left(N_{i} + \\tau\\,\\partial_{x} N_{i}\\right) \\left(\\partial_{x} p_{h} + i\\,\\omega\\,\\rho\\,u_{h}\\right) \\,dx\n$$\nThis expands into the standard Galerkin term plus the SUPG stabilization term. Substituting the trial function expansions $p_{h} = \\sum_{j} N_{j} p_{j}$ and $u_{h} = \\sum_{j} N_{j} u_{j}$, we get:\n$$\nR_{i}^{p} = \\int_{0}^{L} \\left(N_{i} + \\tau\\,\\partial_{x} N_{i}\\right) \\left(\\sum_{j} (\\partial_{x}N_{j}) p_{j} + i\\,\\omega\\,\\rho \\sum_{j} N_{j} u_{j}\\right) \\,dx\n$$\nGrouping terms by the nodal unknowns $p_j$ and $u_j$:\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} p_{j} \\left( \\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx \\right) + \\sum_{j=1}^{M} u_{j} \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\rho\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx \\right)\n$$\nSimilarly, for the velocity residual, $R_{i}^{u}$:\n$$\nR_{i}^{u} = \\int_{0}^{L} \\left(N_{i} + \\tau\\,\\partial_{x} N_{i}\\right) \\left(\\partial_{x} u_{h} + i\\,\\omega\\,\\kappa\\,p_{h}\\right) \\,dx\n$$\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} u_{j} \\left( \\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx \\right) + \\sum_{j=1}^{M} p_{j} \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\kappa\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx \\right)\n$$\nWe substitute $\\tau = \\frac{\\beta}{ik}$ and use $k=\\frac{\\omega}{c}$ and $\\kappa=\\frac{1}{\\rho c^2}$ to simplify the coefficients. The term $\\tau$ becomes $-i\\frac{\\beta}{k}$. The coefficient $i\\omega\\rho\\tau$ becomes $\\rho c \\beta$. The coefficient $i\\omega\\kappa\\tau$ becomes $\\frac{\\beta}{\\rho c}$.\nSubstituting these simplified forms gives the final expressions:\nFor $R_{i}^{p}$:\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n$$\nFor $R_{i}^{u}$:\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n$$\nThese expressions represent the $i$-th rows of the linear system arising from the SUPG discretization.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n&\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n\\end{pmatrix}\n}\n$$"
        }
    ]
}