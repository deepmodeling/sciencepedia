{
    "hands_on_practices": [
        {
            "introduction": "这项练习是理解有限元方法的基础实践。它将引导您通过伽辽金法，从亥姆霍兹方程的弱形式出发，推导出单元刚度矩阵和质量矩阵，从而将连续的偏微分方程转化为离散的单元级代数系统。掌握这个过程是构建复杂声学仿真工具的第一步。",
            "id": "4149623",
            "problem": "考虑一个单位横截面积的一维、均匀、无损声管，其中时谐声压场满足亥姆霍兹偏微分方程 (PDE)\n$$\n\\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p = 0\n$$\n在长度为 $h = x_{b} - x_{a}$ 的通用有限元 $e = [x_{a}, x_{b}]$ 上，其中 $k$ 是声波数。使用加权余量法 (WRM)，并选择 Galerkin 检验函数（试探函数和检验函数取自同一有限维空间），来推导单元级弱形式。假设这是一个内部单元，因此单元间的通量项在组装时会相互抵消，并且在单元级别上不会产生外部边界贡献。\n\n在单元上采用线性 Lagrange 试探函数和检验函数，并使用局部单元坐标 $x \\in [0,h]$，使得两个节点形函数为\n$$\nN_{1}(x) = 1 - \\frac{x}{h}, \\qquad N_{2}(x) = \\frac{x}{h}.\n$$\n从强形式和 WRM 陈述出发，通过分部积分得到弱形式，并确定单元质量矩阵 $M_{e}$ 和刚度矩阵 $K_{e}$。然后，为 $M_{e}$ 和 $K_{e}$ 的所有元素写出显式闭合形式表达式（仅用 $h$ 表示），并由此得到亥姆霍兹单元矩阵\n$$\nH_{e} = K_{e} - k^{2} M_{e}.\n$$\n\n答案规格：\n- 以精确解析形式，将你的最终答案报告为包含 $2 \\times 2$ 矩阵 $H_{e}$ 元素 $\\bigl[H_{11},\\, H_{12},\\, H_{21},\\, H_{22}\\bigr]$ 的行向量。\n- 最终答案中不要包含单位。无需四舍五入。",
            "solution": "推导从控制偏微分方程 (PDE) 的强形式开始，也就是在单元域 $e = [0,h]$ 上的亥姆霍兹方程：\n$$\n\\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p = 0, \\quad x \\in [0,h]\n$$\n这构成了残差，$R(p) = \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p$。加权余量法 (WRM) 要求残差与检验函数 $w(x)$ 加权后在单元域上的积分为零：\n$$\n\\int_{0}^{h} w(x) R(p(x)) \\mathrm{d}x = \\int_{0}^{h} w(x) \\left( \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p \\right) \\mathrm{d}x = 0\n$$\n问题指定了 Galerkin 方法，其中检验函数 $w(x)$ 与用于近似场变量 $p(x)$ 的试探函数选自同一空间。声压场 $p(x)$ 使用给定的线性 Lagrange 形函数 $N_{1}(x)$ 和 $N_{2}(x)$ 以及节点压力值 $p_{1}$ 和 $p_{2}$ 近似为 $p_{h}(x)$：\n$$\np(x) \\approx p_{h}(x) = N_{1}(x) p_{1} + N_{2}(x) p_{2} = \\sum_{j=1}^{2} N_{j}(x) p_{j}\n$$\n在 Galerkin 框架下，我们对每个检验函数 $w(x) = N_{i}(x)$（其中 $i=1,2$）强制执行加权余量陈述。这会产生一个包含两个方程的方程组：\n$$\n\\int_{0}^{h} N_{i}(x) \\left( \\frac{\\mathrm{d}^{2}p_{h}}{\\mathrm{d}x^{2}} + k^{2} p_{h} \\right) \\mathrm{d}x = 0, \\quad \\text{for } i=1,2\n$$\n为了得到弱形式，我们对二阶导数项应用分部积分，以降低最高阶导数的阶数。令 $u = N_{i}(x)$ 且 $\\mathrm{d}v = \\frac{\\mathrm{d}^{2}p_{h}}{\\mathrm{d}x^{2}} \\mathrm{d}x$。则 $\\mathrm{d}u = \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\mathrm{d}x$ 且 $v = \\frac{\\mathrm{d}p_{h}}{\\mathrm{d}x}$。\n$$\n\\int_{0}^{h} N_{i}(x) \\frac{\\mathrm{d}^{2}p_{h}}{\\mathrm{d}x^{2}} \\mathrm{d}x = \\left[ N_{i}(x) \\frac{\\mathrm{d}p_{h}}{\\mathrm{d}x} \\right]_{0}^{h} - \\int_{0}^{h} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}p_{h}}{\\mathrm{d}x} \\mathrm{d}x\n$$\n边界项 $\\left[ N_{i}(x) \\frac{\\mathrm{d}p_{h}}{\\mathrm{d}x} \\right]_{0}^{h}$ 代表单元节点处的通量。如问题所述，我们考虑的是一个内部单元，在全局组装时，这些通量项预计会与相邻单元相互抵消。因此，在推导单元级方程时，此边界项被省略。\n\n将分部积分的结果代回 WRM 陈述，得到单元的弱形式：\n$$\n- \\int_{0}^{h} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}p_{h}}{\\mathrm{d}x} \\mathrm{d}x + \\int_{0}^{h} N_{i}(x) k^{2} p_{h}(x) \\mathrm{d}x = 0\n$$\n将 $p_{h}(x)$ 替换为其展开式 $\\sum_{j=1}^{2} N_{j}(x) p_{j}$，我们得到：\n$$\n- \\int_{0}^{h} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\left( \\sum_{j=1}^{2} \\frac{\\mathrm{d}N_{j}}{\\mathrm{d}x} p_{j} \\right) \\mathrm{d}x + k^{2} \\int_{0}^{h} N_{i}(x) \\left( \\sum_{j=1}^{2} N_{j}(x) p_{j} \\right) \\mathrm{d}x = 0\n$$\n由于节点值 $p_{j}$ 相对于积分是常数，我们可以写出：\n$$\n\\sum_{j=1}^{2} \\left( \\int_{0}^{h} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}N_{j}}{\\mathrm{d}x} \\mathrm{d}x \\right) p_{j} - k^{2} \\sum_{j=1}^{2} \\left( \\int_{0}^{h} N_{i}(x) N_{j}(x) \\mathrm{d}x \\right) p_{j} = 0\n$$\n这个对于 $i=1,2$ 的方程组可以表示为矩阵形式 $(K_{e} - k^{2} M_{e}) \\mathbf{p}_{e} = \\mathbf{0}$，其中 $\\mathbf{p}_{e} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}$。单元刚度矩阵 $K_{e}$ 和质量矩阵 $M_{e}$ 的元素由以下公式给出：\n$$\n(K_{e})_{ij} = \\int_{0}^{h} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}N_{j}}{\\mathrm{d}x} \\mathrm{d}x \\qquad \\text{and} \\qquad (M_{e})_{ij} = \\int_{0}^{h} N_{i}(x) N_{j}(x) \\mathrm{d}x\n$$\n形函数及其导数为：\n$N_{1}(x) = 1 - \\frac{x}{h} \\implies \\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{h}$\n$N_{2}(x) = \\frac{x}{h} \\implies \\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{h}$\n\n我们现在计算 $2 \\times 2$ 矩阵 $K_{e}$ 和 $M_{e}$ 的元素。\n对于刚度矩阵 $K_{e}$：\n$(K_{e})_{11} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) \\mathrm{d}x = \\frac{1}{h^{2}} \\int_{0}^{h} \\mathrm{d}x = \\frac{h}{h^{2}} = \\frac{1}{h}$\n$(K_{e})_{12} = (K_{e})_{21} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\mathrm{d}x = -\\frac{1}{h^{2}} \\int_{0}^{h} \\mathrm{d}x = -\\frac{h}{h^{2}} = -\\frac{1}{h}$\n$(K_{e})_{22} = \\int_{0}^{h} \\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\mathrm{d}x = \\frac{1}{h^{2}} \\int_{0}^{h} \\mathrm{d}x = \\frac{h}{h^{2}} = \\frac{1}{h}$\n因此，$K_{e} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n\n对于质量矩阵 $M_{e}$：\n$(M_{e})_{11} = \\int_{0}^{h} N_{1}^{2}(x) \\mathrm{d}x = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)^{2} \\mathrm{d}x = \\left[ -\\frac{h}{3}\\left(1-\\frac{x}{h}\\right)^{3} \\right]_{0}^{h} = 0 - \\left(-\\frac{h}{3}(1)^{3}\\right) = \\frac{h}{3}$\n$(M_{e})_{12} = (M_{e})_{21} = \\int_{0}^{h} N_{1}(x)N_{2}(x) \\mathrm{d}x = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)\\left(\\frac{x}{h}\\right) \\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{x}{h} - \\frac{x^{2}}{h^{2}}\\right) \\mathrm{d}x = \\left[ \\frac{x^{2}}{2h} - \\frac{x^{3}}{3h^{2}} \\right]_{0}^{h} = \\frac{h^{2}}{2h} - \\frac{h^{3}}{3h^{2}} = \\frac{h}{2} - \\frac{h}{3} = \\frac{h}{6}$\n$(M_{e})_{22} = \\int_{0}^{h} N_{2}^{2}(x) \\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{x}{h}\\right)^{2} \\mathrm{d}x = \\frac{1}{h^{2}} \\int_{0}^{h} x^{2} \\mathrm{d}x = \\frac{1}{h^{2}} \\left[ \\frac{x^{3}}{3} \\right]_{0}^{h} = \\frac{h^{3}}{3h^{2}} = \\frac{h}{3}$\n因此，$M_{e} = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$。\n\n最后，亥姆霍兹单元矩阵 $H_{e}$ 构造为 $H_{e} = K_{e} - k^{2}M_{e}$：\n$$\nH_{e} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} - k^{2} \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h} - \\frac{2k^{2}h}{6}  -\\frac{1}{h} - \\frac{k^{2}h}{6} \\\\ -\\frac{1}{h} - \\frac{k^{2}h}{6}  \\frac{1}{h} - \\frac{2k^{2}h}{6} \\end{pmatrix}\n$$\n化简各项，我们得到：\n$H_{11} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\n$H_{12} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{21} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{22} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\n所要求的最终答案是这四个元素组成的行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{h} - \\frac{k^2 h}{3}  -\\frac{1}{h} - \\frac{k^2 h}{6}  -\\frac{1}{h} - \\frac{k^2 h}{6}  \\frac{1}{h} - \\frac{k^2 h}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在一维情形的基础上，本问题将有限元公式推广到使用三角形单元的二维域。这个实践引入了等参映射和雅可比矩阵这两个关键概念，它们是处理复杂几何形状的重要工具。通过完成这个例子，您将学会如何计算多维问题的单元矩阵项，这是计算声学中的一项核心技能。",
            "id": "4149576",
            "problem": "考虑在均匀无损介质中，声压 $p(\\mathbf{x})$ 的频域声学亥姆霍兹方程，其中密度和声速已无量纲化（设为1）：\n$$\n-\\nabla^{2} p(\\mathbf{x}) - k^{2} p(\\mathbf{x}) = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $k$ 是无量纲波数。在有限元法 (FEM) 中使用 Galerkin 加权余量法 (WRM)，对于单元 $E \\subset \\Omega$ 上的一个检验函数 $w(\\mathbf{x})$ 和一个试探函数 $p(\\mathbf{x})$，其单元级双线性形式为\n$$\na(w,p) = \\int_{E} \\nabla w \\cdot \\nabla p \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} w p \\, \\mathrm{d}\\Omega.\n$$\n\n令 $E$ 为 $\\mathbb{R}^{2}$ 中的一个三角形单元，其顶点为 $\\mathbf{r}_{1} = (0,0)$，$\\mathbf{r}_{2} = (2,1)$ 和 $\\mathbf{r}_{3} = (1,3)$。在坐标为 $(\\xi,\\eta)$、顶点为 $(0,0)$, $(1,0)$, $(0,1)$ 的参考三角形上定义（线性）多项式 Lagrange 基的试探函数和检验函数：\n$$\n\\hat{N}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta, \\quad \\hat{N}_{2}(\\xi,\\eta) = \\xi, \\quad \\hat{N}_{3}(\\xi,\\eta) = \\eta.\n$$\n使用等参映射\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{3} \\mathbf{r}_{i} \\hat{N}_{i}(\\xi,\\eta)\n$$\n来定义相应的物理单元形函数 $N_{i}(\\mathbf{x}) = \\hat{N}_{i}(\\xi(\\mathbf{x}),\\eta(\\mathbf{x}))$。\n\n任务：\n1. 推导该映射的雅可比矩阵 $\\mathbf{J}(\\xi,\\eta) = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$，并证明它在 $E$ 上是一个常数。\n2. 使用梯度映射公式\n$$\n\\nabla_{\\mathbf{x}} N_{i} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{i},\n$$\n获得 $\\nabla N_{2}$ 和 $\\nabla N_{3}$ 在 $E$ 上的显式表达式。\n3. 使用双线性形式 $a(w,p)$，计算对应于检验函数 $N_{2}$ 和试探函数 $N_{3}$ 的单个单元矩阵项，\n$$\nA_{23}^{(E)} = \\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega,\n$$\n并将您的最终答案表示为关于 $k$ 的解析闭式表达式。无需四舍五入。最终答案不带单位。",
            "solution": "目标是计算三角形单元 $E$ 的单元矩阵项 $A_{23}^{(E)}$，其定义如下：\n$$\nA_{23}^{(E)} = \\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega\n$$\n其中 $N_2$ 和 $N_3$ 是 $E$ 上的线性 Lagrange 基函数。\n\n**任务1：推导雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$**\n\n从参考坐标 $(\\xi,\\eta)$ 到物理坐标 $\\mathbf{x} = (x,y)$ 的等参映射由下式给出\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{3} \\mathbf{r}_{i} \\hat{N}_{i}(\\xi,\\eta)\n$$\n顶点为 $\\mathbf{r}_{1} = (0,0)$，$\\mathbf{r}_{2} = (2,1)$ 和 $\\mathbf{r}_{3} = (1,3)$。参考基函数为 $\\hat{N}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$，$\\hat{N}_{2}(\\xi,\\eta) = \\xi$ 和 $\\hat{N}_{3}(\\xi,\\eta) = \\eta$。\n\n该映射的分量为：\n$$\nx(\\xi,\\eta) = x_1 \\hat{N}_1 + x_2 \\hat{N}_2 + x_3 \\hat{N}_3 = (0)(1 - \\xi - \\eta) + (2)(\\xi) + (1)(\\eta) = 2\\xi + \\eta\n$$\n$$\ny(\\xi,\\eta) = y_1 \\hat{N}_1 + y_2 \\hat{N}_2 + y_3 \\hat{N}_3 = (0)(1 - \\xi - \\eta) + (1)(\\xi) + (3)(\\eta) = \\xi + 3\\eta\n$$\n此变换的雅可比矩阵 $\\mathbf{J}$ 定义为\n$$\n\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(2\\xi + \\eta) = 2\n\\quad , \\quad\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(2\\xi + \\eta) = 1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi + 3\\eta) = 1\n\\quad , \\quad\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi + 3\\eta) = 3\n$$\n因此，雅可比矩阵为\n$$\n\\mathbf{J} = \\begin{pmatrix}\n2  1 \\\\\n1  3\n\\end{pmatrix}\n$$\n由于 $\\mathbf{J}$ 的所有项都是常数，因此雅可比矩阵在整个单元 $E$ 上是恒定的。这是线性等参单元的一个典型特征。\n\n**任务2：获得 $\\nabla N_{2}$ 和 $\\nabla N_{3}$ 的显式表达式**\n\n形函数 $N_i$ 在物理坐标 $\\mathbf{x}$ 中的梯度与其在参考坐标 $(\\xi, \\eta)$ 中的对应部分 $\\hat{N}_i$ 的梯度通过以下公式相关联：\n$$\n\\nabla_{\\mathbf{x}} N_{i} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{i}\n$$\n首先，我们计算参考形函数 $\\hat{N}_{2}$ 和 $\\hat{N}_{3}$ 的梯度：\n$$\n\\nabla_{(\\xi,\\eta)} \\hat{N}_{2} = \\begin{pmatrix} \\frac{\\partial \\hat{N}_{2}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_{2}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi}(\\xi) \\\\ \\frac{\\partial}{\\partial \\eta}(\\xi) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla_{(\\xi,\\eta)} \\hat{N}_{3} = \\begin{pmatrix} \\frac{\\partial \\hat{N}_{3}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_{3}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi}(\\eta) \\\\ \\frac{\\partial}{\\partial \\eta}(\\eta) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们求雅可比矩阵的逆转置 $\\mathbf{J}^{-T}$。$\\mathbf{J}$ 的行列式为 $\\det(\\mathbf{J}) = (2)(3) - (1)(1) = 5$。$\\mathbf{J}$ 的逆矩阵为：\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n逆转置矩阵 $\\mathbf{J}^{-T} = (\\mathbf{J}^{-1})^T$ 为：\n$$\n\\mathbf{J}^{-T} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix}^T = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n现在我们可以计算物理形函数 $N_2$ 和 $N_3$ 的梯度：\n$$\n\\nabla N_{2} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{2} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\nabla N_{3} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{3} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n这些梯度是常向量，这与三角形单元上的线性基函数的预期相符。\n\n**任务3：计算单元矩阵项 $A_{23}^{(E)}$**\n\n$A_{23}^{(E)}$ 的表达式由两个积分组成。我们称它们为类刚度项 $I_S$ 和类质量项 $I_M$。\n$$\nA_{23}^{(E)} = \\underbrace{\\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega}_{I_S} - k^{2} \\underbrace{\\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega}_{I_M}\n$$\n首先，我们计算类刚度项 $I_S$。梯度的点积为：\n$$\n\\nabla N_{2} \\cdot \\nabla N_{3} = \\left(\\frac{1}{5} \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}\\right) \\cdot \\left(\\frac{1}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\\right) = \\frac{1}{25} \\left( (3)(-1) + (-1)(2) \\right) = \\frac{1}{25}(-3-2) = -\\frac{5}{25} = -\\frac{1}{5}\n$$\n由于该被积函数在单元 $E$ 上是常数，该积分是该常数值与单元面积 Area($E$) 的乘积：\n$$\nI_S = \\left(-\\frac{1}{5}\\right) \\text{Area}(E)\n$$\n物理单元 $E$ 的面积通过雅可比行列式与参考单元 $\\hat{E}$ 的面积相关联：Area($E$) = $|\\det(\\mathbf{J})| \\text{Area}(\\hat{E})$。参考单元是一个顶点在 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的直角三角形，所以它的面积是 $\\frac{1}{2}$。\n$$\n\\text{Area}(E) = |5| \\times \\frac{1}{2} = \\frac{5}{2}\n$$\n因此，类刚度项为：\n$$\nI_S = \\left(-\\frac{1}{5}\\right) \\left(\\frac{5}{2}\\right) = -\\frac{1}{2}\n$$\n接下来，我们计算类质量项 $I_M$。我们通过变量替换到参考坐标系来计算积分。面积微元变换为 $\\mathrm{d}\\Omega = |\\det(\\mathbf{J})| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 5 \\, \\mathrm{d}\\xi \\mathrm{d}\\eta$。函数 $N_i$ 变为 $\\hat{N}_i$。\n$$\nI_M = \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega = \\int_{\\hat{E}} \\hat{N}_{2}(\\xi,\\eta) \\hat{N}_{3}(\\xi,\\eta) |\\det(\\mathbf{J})| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n代入 $\\hat{N}_2 = \\xi$ 和 $\\hat{N}_3 = \\eta$：\n$$\nI_M = \\int_{\\hat{E}} \\xi \\eta (5) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 5 \\int_{\\hat{E}} \\xi \\eta \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n积分区域为参考三角形，由 $\\xi \\ge 0$，$\\eta \\ge 0$，$\\xi+\\eta \\le 1$ 定义。\n$$\n\\int_{\\hat{E}} \\xi \\eta \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = \\int_{0}^{1} \\int_{0}^{1-\\xi} \\xi \\eta \\, \\mathrm{d}\\eta \\mathrm{d}\\xi = \\int_{0}^{1} \\xi \\left[ \\frac{\\eta^2}{2} \\right]_{0}^{1-\\xi} \\mathrm{d}\\xi = \\int_{0}^{1} \\frac{\\xi(1-\\xi)^2}{2} \\mathrm{d}\\xi\n$$\n$$\n= \\frac{1}{2} \\int_{0}^{1} (\\xi - 2\\xi^2 + \\xi^3) \\mathrm{d}\\xi = \\frac{1}{2} \\left[ \\frac{\\xi^2}{2} - \\frac{2\\xi^3}{3} + \\frac{\\xi^4}{4} \\right]_{0}^{1} = \\frac{1}{2} \\left(\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4}\\right) = \\frac{1}{2} \\left(\\frac{6 - 8 + 3}{12}\\right) = \\frac{1}{24}\n$$\n因此，类质量项为：\n$$\nI_M = 5 \\times \\frac{1}{24} = \\frac{5}{24}\n$$\n最后，我们合并各项得到 $A_{23}^{(E)}$：\n$$\nA_{23}^{(E)} = I_S - k^{2} I_M = -\\frac{1}{2} - k^{2} \\frac{5}{24}\n$$\n这就是指定单元矩阵项的解析闭式表达式。",
            "answer": "$$\n\\boxed{-\\frac{1}{2} - \\frac{5}{24}k^2}\n$$"
        },
        {
            "introduction": "这项实践将重点从组装单元矩阵转移到分析所得数值解的质量。通过推导离散色散关系，您将研究有限元离散化在多大程度上能够准确表示声波的传播，并与精确的连续解进行比较。该分析揭示了数值色散现象并量化了相位误差，为理解该方法在波动问题中的精度和局限性提供了关键见解。",
            "id": "4149538",
            "problem": "考虑由齐次亥姆霍兹方程 $- \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} - k^{2} p = 0$ 描述的一维时谐声传播，其中 $p(x)$ 是声压场，$k$ 是实波数。使用加权余量法，并采用检验函数等于试探函数的伽辽金选择，在间距为 $h$ 的均匀网格上，用连续分片线性基函数来近似 $p(x)$。假设网格是无限且均匀的，因此离散布洛赫波拟设 $p_{j} = A \\exp(i j \\theta)$（其中 $\\theta = k_{h} h$）在由 $j \\in \\mathbb{Z}$ 索引的节点上成立，其中 $k_{h}$ 是数值（离散）波数。\n\n从亥姆霍兹问题的弱形式出发，并仅使用与伽辽金有限元法产生的刚度矩阵和质量矩阵相关的双线性形式的标准定义，推导该离散化下连接 $k$ 和 $k_{h}$ 的离散色散关系。然后，将相对相位误差定义为 $\\delta_{\\phi}(k h) = \\frac{k_{h} - k}{k}$，并将其表示为无量纲参数 $k h$ 的闭式解析函数。所有角度均以弧度为单位。提供 $\\delta_{\\phi}(k h)$ 的最终答案，形式为仅含 $k h$ 的单个解析表达式。不需要进行数值近似或舍入。",
            "solution": "该推导从亥姆霍兹方程的弱形式开始。其强形式为：\n$$ - \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} - k^{2} p = 0 $$\n我们乘以一个检验函数 $w(x)$ 并在定义域 $\\Omega = (-\\infty, \\infty)$ 上积分。\n$$ \\int_{-\\infty}^{\\infty} w \\left( - \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} - k^{2} p \\right) \\mathrm{d}x = 0 $$\n对二阶导数项应用分部积分法：\n$$ \\int_{-\\infty}^{\\infty} \\left( \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\frac{\\mathrm{d}p}{\\mathrm{d}x} - k^{2} w p \\right) \\mathrm{d}x - \\left[ w \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\right]_{-\\infty}^{\\infty} = 0 $$\n由于检验函数（和基函数）具有紧支集，边界项消失。弱形式为：求 $p(x)$，使得对于所有容许的检验函数 $w(x)$：\n$$ \\int_{-\\infty}^{\\infty} \\left( \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\frac{\\mathrm{d}p}{\\mathrm{d}x} - k^{2} w p \\right) \\mathrm{d}x = 0 $$\n\n接下来，我们应用伽辽金有限元法。声压 $p(x)$ 由连续分片线性基函数 $N_j(x)$ 的线性组合来近似：\n$$ p(x) \\approx p_{h}(x) = \\sum_{j \\in \\mathbb{Z}} p_{j} N_{j}(x) $$\n其中 $p_j$ 是位于 $x_j = jh$ 处的节点 $j$ 的压力节点值。函数 $N_j(x)$ 是标准的“帽函数”，仅在区间 $[(j-1)h, (j+1)h]$ 上非零。在伽辽金方法中，检验函数选自与基函数相同的空间，因此我们为每个节点 $i \\in \\mathbb{Z}$ 设置 $w(x) = N_{i}(x)$。\n将近似解 $p_h(x)$ 和检验函数 $N_i(x)$ 代入弱形式，得到离散方程组：\n$$ \\sum_{j \\in \\mathbb{Z}} p_{j} \\left( \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}N_{j}}{\\mathrm{d}x} \\mathrm{d}x - k^{2} \\int_{-\\infty}^{\\infty} N_{i} N_{j} \\mathrm{d}x \\right) = 0 \\quad \\forall i \\in \\mathbb{Z} $$\n这可以写成矩阵形式 $(\\mathbf{K} - k^2 \\mathbf{M})\\mathbf{p} = 0$，其中刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 的元素为：\n$$ K_{ij} = \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}N_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}N_{j}}{\\mathrm{d}x} \\mathrm{d}x \\quad \\text{和} \\quad M_{ij} = \\int_{-\\infty}^{\\infty} N_{i} N_{j} \\mathrm{d}x $$\n\n由于基函数的局部支集特性，任意节点 $i$ 的方程仅涉及其紧邻节点 $i-1$ 和 $i+1$。我们计算对应于一个一般节点的行的非零矩阵元素，不失一般性地，我们可以将其标记为节点 0。\n基函数 $N_0(x)$ 定义为：\n$$ N_0(x) = \\begin{cases} 1 + x/h  \\text{for } x \\in [-h, 0] \\\\ 1 - x/h  \\text{for } x \\in [0, h] \\\\ 0  \\text{otherwise} \\end{cases} \\quad \\implies \\quad \\frac{\\mathrm{d}N_0}{\\mathrm{d}x} = \\begin{cases} 1/h  \\text{for } x \\in (-h, 0) \\\\ -1/h  \\text{for } x \\in (0, h) \\\\ 0  \\text{otherwise} \\end{cases} $$\n刚度矩阵元素为：\n$$ K_{00} = \\int_{-h}^{h} \\left( \\frac{\\mathrm{d}N_{0}}{\\mathrm{d}x} \\right)^{2} \\mathrm{d}x = \\int_{-h}^{0} \\left(\\frac{1}{h}\\right)^{2} \\mathrm{d}x + \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)^{2} \\mathrm{d}x = \\frac{1}{h^2}(h) + \\frac{1}{h^2}(h) = \\frac{2}{h} $$\n$$ K_{01} = \\int_{0}^{h} \\frac{\\mathrm{d}N_{0}}{\\mathrm{d}x} \\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} \\mathrm{d}x = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right) \\left(\\frac{1}{h}\\right) \\mathrm{d}x = -\\frac{1}{h^2} (h) = -\\frac{1}{h} $$\n根据对称性，$K_{0,-1} = K_{01} = -1/h$。\n\n质量矩阵元素为：\n$$ M_{00} = \\int_{-h}^{h} N_{0}(x)^{2} \\mathrm{d}x = \\int_{-h}^{0} (1+x/h)^{2} \\mathrm{d}x + \\int_{0}^{h} (1-x/h)^{2} \\mathrm{d}x = 2 \\int_{0}^{h} (1-x/h)^{2} \\mathrm{d}x = 2 \\left[ -\\frac{h}{3}(1-x/h)^3 \\right]_{0}^{h} = \\frac{2h}{3} $$\n$$ M_{01} = \\int_{0}^{h} N_{0}(x) N_{1}(x) \\mathrm{d}x = \\int_{0}^{h} (1-x/h)(x/h) \\mathrm{d}x = \\left[ \\frac{x^2}{2h} - \\frac{x^3}{3h^2} \\right]_{0}^{h} = \\frac{h}{2} - \\frac{h}{3} = \\frac{h}{6} $$\n根据对称性，$M_{0,-1} = M_{01} = h/6$。\n\n因此，任意节点 $j$ 的方程为：\n$$ K_{j,j-1}p_{j-1} + K_{j,j}p_{j} + K_{j,j+1}p_{j+1} - k^2(M_{j,j-1}p_{j-1} + M_{j,j}p_{j} + M_{j,j+1}p_{j+1}) = 0 $$\n代入计算出的值：\n$$ -\\frac{1}{h} p_{j-1} + \\frac{2}{h} p_{j} - \\frac{1}{h} p_{j+1} - k^{2} \\left( \\frac{h}{6} p_{j-1} + \\frac{2h}{3} p_{j} + \\frac{h}{6} p_{j+1} \\right) = 0 $$\n现在我们代入离散布洛赫波拟设 $p_{j} = A \\exp(i j \\theta)$，其中 $\\theta = k_h h$。这得到 $p_{j-1} = p_{j} \\exp(-i\\theta)$ 和 $p_{j+1} = p_{j} \\exp(i\\theta)$。代入并除以 $p_j$ 可得：\n$$ -\\frac{1}{h} \\exp(-i\\theta) + \\frac{2}{h} - \\frac{1}{h} \\exp(i\\theta) - k^{2}h \\left( \\frac{1}{6} \\exp(-i\\theta) + \\frac{2}{3} + \\frac{1}{6} \\exp(i\\theta) \\right) = 0 $$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$，我们合并各项：\n$$ \\frac{1}{h} (2 - (\\exp(i\\theta) + \\exp(-i\\theta))) - \\frac{k^{2}h}{6} ((\\exp(i\\theta) + \\exp(-i\\theta)) + 4) = 0 $$\n$$ \\frac{2}{h} (1 - \\cos\\theta) - \\frac{k^{2}h}{6} (2\\cos\\theta + 4) = 0 $$\n$$ \\frac{2}{h} (1 - \\cos\\theta) = \\frac{k^{2}h}{3} (\\cos\\theta + 2) $$\n这就是离散色散关系。我们重新整理它来求解 $\\cos\\theta$：\n$$ 6(1 - \\cos\\theta) = (kh)^{2} (2 + \\cos\\theta) $$\n$$ 6 - 6\\cos\\theta = 2(kh)^{2} + (kh)^{2}\\cos\\theta $$\n$$ 6 - 2(kh)^{2} = \\cos\\theta (6 + (kh)^{2}) $$\n$$ \\cos\\theta = \\cos(k_{h}h) = \\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}} $$\n为了求出 $k_h$，我们取反余弦。由于波数是非负的，我们取其主值。\n$$ k_{h}h = \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) $$\n$$ k_{h} = \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) $$\n相对相位误差定义为 $\\delta_{\\phi}(kh) = \\frac{k_{h} - k}{k} = \\frac{k_h}{k} - 1$。\n代入 $k_h$ 的表达式：\n$$ \\delta_{\\phi}(kh) = \\frac{1}{k} \\left( \\frac{1}{h} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) \\right) - 1 $$\n将括号中的项乘以 $h/h$：\n$$ \\delta_{\\phi}(kh) = \\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) - 1 $$\n这就是相对相位误差作为无量纲参数 $kh$ 的函数的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{1}{kh} \\arccos\\left(\\frac{6 - 2(kh)^{2}}{6 + (kh)^{2}}\\right) - 1}$$"
        }
    ]
}