{
    "hands_on_practices": [
        {
            "introduction": "The first step in any finite element analysis is to transform the continuous weak form of a governing equation into a discrete algebraic system at the element level. This foundational exercise demonstrates this process for the 1D Helmholtz equation using the Galerkin method, where trial and test functions are identical. Mastering the derivation of the element stiffness matrix $K_{e}$ and mass matrix $M_{e}$ is crucial for understanding how physical laws are discretized into computable models. ",
            "id": "4149623",
            "problem": "Consider a one-dimensional, homogeneous, lossless acoustic duct of unit cross-sectional area, in which the time-harmonic acoustic pressure field satisfies the Helmholtz partial differential equation (PDE)\n$$\n\\frac{d^{2}p}{dx^{2}} + k^{2} p = 0\n$$\non a generic finite element $e = [x_{a}, x_{b}]$ of length $h = x_{b} - x_{a}$, where $k$ is the acoustic wavenumber. Use the Weighted Residual Method (WRM) with the Galerkin choice of test functions (trial and test functions drawn from the same finite-dimensional space) to derive the element-level weak form. Assume an interior element so that inter-element flux terms cancel upon assembly, and no external boundary contribution arises at the element level.\n\nAdopt linear Lagrange trial and test functions on the element, and use a local element coordinate with $x \\in [0,h]$ so that the two nodal shape functions are\n$$\nN_{1}(x) = 1 - \\frac{x}{h}, \\qquad N_{2}(x) = \\frac{x}{h}.\n$$\nStarting from the strong form and the WRM statement, perform the integration by parts to obtain the weak form and identify the element mass and stiffness matrices $M_{e}$ and $K_{e}$. Then, write explicit closed-form expressions (in terms of $h$ only) for all entries of $M_{e}$ and $K_{e}$, and hence for the Helmholtz element matrix\n$$\nH_{e} = K_{e} - k^{2} M_{e}.\n$$\n\nAnswer specification:\n- Report your final answer as the row vector containing the entries $\\bigl[H_{11},\\, H_{12},\\, H_{21},\\, H_{22}\\bigr]$ of the $2 \\times 2$ matrix $H_{e}$, in exact analytic form.\n- Do not include units in your final answer. No rounding is required.",
            "solution": "The problem statement is assessed to be valid. It is a well-posed, scientifically grounded problem from the field of computational acoustics that requests a standard derivation of the finite element matrix for the one-dimensional Helmholtz equation. All necessary information is provided, and there are no contradictions or ambiguities.\n\nThe derivation proceeds from the strong form of the governing partial differential equation (PDE), which is the Helmholtz equation on the element domain $e = [0,h]$:\n$$\n\\frac{d^{2}p}{dx^{2}} + k^{2} p = 0, \\quad x \\in [0,h]\n$$\nThis constitutes the residual, $R(p) = \\frac{d^{2}p}{dx^{2}} + k^{2} p$. The Weighted Residual Method (WRM) requires the integral of the residual, weighted by a test function $w(x)$, to be zero over the element domain:\n$$\n\\int_{0}^{h} w(x) R(p(x)) dx = \\int_{0}^{h} w(x) \\left( \\frac{d^{2}p}{dx^{2}} + k^{2} p \\right) dx = 0\n$$\nThe problem specifies the Galerkin method, where the test functions $w(x)$ are chosen from the same space as the trial functions used to approximate the field variable $p(x)$. The pressure field $p(x)$ is approximated as $p_{h}(x)$ using the given linear Lagrange shape functions $N_{1}(x)$ and $N_{2}(x)$ and the nodal pressure values $p_{1}$ and $p_{2}$:\n$$\np(x) \\approx p_{h}(x) = N_{1}(x) p_{1} + N_{2}(x) p_{2} = \\sum_{j=1}^{2} N_{j}(x) p_{j}\n$$\nIn the Galerkin framework, we enforce the weighted residual statement for each test function $w(x) = N_{i}(x)$, where $i=1,2$. This yields a system of two equations:\n$$\n\\int_{0}^{h} N_{i}(x) \\left( \\frac{d^{2}p_{h}}{dx^{2}} + k^{2} p_{h} \\right) dx = 0, \\quad \\text{for } i=1,2\n$$\nTo obtain the weak form, we reduce the order of the highest derivative by applying integration by parts to the second-derivative term. Let $u = N_{i}(x)$ and $dv = \\frac{d^{2}p_{h}}{dx^{2}} dx$. Then $du = \\frac{d N_{i}}{dx} dx$ and $v = \\frac{dp_{h}}{dx}$.\n$$\n\\int_{0}^{h} N_{i}(x) \\frac{d^{2}p_{h}}{dx^{2}} dx = \\left[ N_{i}(x) \\frac{dp_{h}}{dx} \\right]_{0}^{h} - \\int_{0}^{h} \\frac{d N_{i}}{dx} \\frac{dp_{h}}{dx} dx\n$$\nThe boundary term $\\left[ N_{i}(x) \\frac{dp_{h}}{dx} \\right]_{0}^{h}$ represents the flux at the element nodes. As specified, we consider an interior element where these flux terms are expected to cancel with adjacent elements upon global assembly. Therefore, for the derivation of the element-level equations, this boundary term is omitted.\n\nSubstituting the result of the integration by parts back into the WRM statement gives the weak form for the element:\n$$\n- \\int_{0}^{h} \\frac{d N_{i}}{dx} \\frac{dp_{h}}{dx} dx + \\int_{0}^{h} N_{i}(x) k^{2} p_{h}(x) dx = 0\n$$\nReplacing $p_{h}(x)$ with its expansion $\\sum_{j=1}^{2} N_{j}(x) p_{j}$, we get:\n$$\n- \\int_{0}^{h} \\frac{d N_{i}}{dx} \\left( \\sum_{j=1}^{2} \\frac{d N_{j}}{dx} p_{j} \\right) dx + k^{2} \\int_{0}^{h} N_{i}(x) \\left( \\sum_{j=1}^{2} N_{j}(x) p_{j} \\right) dx = 0\n$$\nSince the nodal values $p_{j}$ are constants with respect to the integration, we can write:\n$$\n\\sum_{j=1}^{2} \\left( \\int_{0}^{h} \\frac{d N_{i}}{dx} \\frac{d N_{j}}{dx} dx \\right) p_{j} - k^{2} \\sum_{j=1}^{2} \\left( \\int_{0}^{h} N_{i}(x) N_{j}(x) dx \\right) p_{j} = 0\n$$\nThis system of equations for $i=1,2$ can be expressed in matrix form as $(K_{e} - k^{2} M_{e}) \\mathbf{p}_{e} = \\mathbf{0}$, where $\\mathbf{p}_{e} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}$. The entries of the element stiffness matrix $K_{e}$ and mass matrix $M_{e}$ are given by:\n$$\n(K_{e})_{ij} = \\int_{0}^{h} \\frac{d N_{i}}{dx} \\frac{d N_{j}}{dx} dx \\qquad \\text{and} \\qquad (M_{e})_{ij} = \\int_{0}^{h} N_{i}(x) N_{j}(x) dx\n$$\nThe shape functions and their derivatives are:\n$N_{1}(x) = 1 - \\frac{x}{h} \\implies \\frac{d N_{1}}{dx} = -\\frac{1}{h}$\n$N_{2}(x) = \\frac{x}{h} \\implies \\frac{d N_{2}}{dx} = \\frac{1}{h}$\n\nWe now compute the entries for the $2 \\times 2$ matrices $K_{e}$ and $M_{e}$.\nFor the stiffness matrix $K_{e}$:\n$(K_{e})_{11} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) dx = \\frac{1}{h^{2}} \\int_{0}^{h} dx = \\frac{h}{h^{2}} = \\frac{1}{h}$\n$(K_{e})_{12} = (K_{e})_{21} = \\int_{0}^{h} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^{2}} \\int_{0}^{h} dx = -\\frac{h}{h^{2}} = -\\frac{1}{h}$\n$(K_{e})_{22} = \\int_{0}^{h} \\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = \\frac{1}{h^{2}} \\int_{0}^{h} dx = \\frac{h}{h^{2}} = \\frac{1}{h}$\nThus, $K_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nFor the mass matrix $M_{e}$:\n$(M_{e})_{11} = \\int_{0}^{h} N_{1}^{2}(x) dx = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)^{2} dx = \\left[ -\\frac{h}{3}\\left(1-\\frac{x}{h}\\right)^{3} \\right]_{0}^{h} = 0 - \\left(-\\frac{h}{3}(1)^{3}\\right) = \\frac{h}{3}$\n$(M_{e})_{12} = (M_{e})_{21} = \\int_{0}^{h} N_{1}(x)N_{2}(x) dx = \\int_{0}^{h} \\left(1-\\frac{x}{h}\\right)\\left(\\frac{x}{h}\\right) dx = \\int_{0}^{h} \\left(\\frac{x}{h} - \\frac{x^{2}}{h^{2}}\\right) dx = \\left[ \\frac{x^{2}}{2h} - \\frac{x^{3}}{3h^{2}} \\right]_{0}^{h} = \\frac{h^{2}}{2h} - \\frac{h^{3}}{3h^{2}} = \\frac{h}{2} - \\frac{h}{3} = \\frac{h}{6}$\n$(M_{e})_{22} = \\int_{0}^{h} N_{2}^{2}(x) dx = \\int_{0}^{h} \\left(\\frac{x}{h}\\right)^{2} dx = \\frac{1}{h^{2}} \\int_{0}^{h} x^{2} dx = \\frac{1}{h^{2}} \\left[ \\frac{x^{3}}{3} \\right]_{0}^{h} = \\frac{h^{3}}{3h^{2}} = \\frac{h}{3}$\nThus, $M_{e} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$.\n\nFinally, the Helmholtz element matrix $H_{e}$ is constructed as $H_{e} = K_{e} - k^{2}M_{e}$:\n$$\nH_{e} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} - k^{2} \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h} - \\frac{2k^{2}h}{6} & -\\frac{1}{h} - \\frac{k^{2}h}{6} \\\\ -\\frac{1}{h} - \\frac{k^{2}h}{6} & \\frac{1}{h} - \\frac{2k^{2}h}{6} \\end{pmatrix}\n$$\nSimplifying the terms, we obtain:\n$H_{11} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\n$H_{12} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{21} = -\\frac{1}{h} - \\frac{k^{2}h}{6}$\n$H_{22} = \\frac{1}{h} - \\frac{k^{2}h}{3}$\nThe requested final answer is the row vector of these four entries.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{h} - \\frac{k^2 h}{3} & -\\frac{1}{h} - \\frac{k^2 h}{6} & -\\frac{1}{h} - \\frac{k^2 h}{6} & \\frac{1}{h} - \\frac{k^2 h}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world problems rarely conform to simple, axis-aligned grids, requiring a method to handle arbitrary geometries. The isoparametric mapping technique bridges this gap by transforming simple 'reference' elements into complex 'physical' shapes in the actual problem domain. This practice builds upon the fundamentals by extending the analysis to a 2D triangular element, where you will compute the Jacobian matrix $\\mathbf{J}$ and transformed gradients essential for assembling the system matrices. ",
            "id": "4149576",
            "problem": "Consider the frequency-domain acoustical Helmholtz equation for pressure $p(\\mathbf{x})$ in a homogeneous, lossless medium with nondimensionalized density and sound speed (set to unity):\n$$\n-\\nabla^{2} p(\\mathbf{x}) - k^{2} p(\\mathbf{x}) = 0 \\quad \\text{in } \\Omega,\n$$\nwhere $k$ is the nondimensional wavenumber. Using the Galerkin Weighted Residual Method (WRM) within the Finite Element Method (FEM), the element-level bilinear form for a test function $w(\\mathbf{x})$ and a trial function $p(\\mathbf{x})$ over an element $E \\subset \\Omega$ is\n$$\na(w,p) = \\int_{E} \\nabla w \\cdot \\nabla p \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} w p \\, \\mathrm{d}\\Omega.\n$$\n\nLet $E$ be a single triangular element in $\\mathbb{R}^{2}$ with vertices at $\\mathbf{r}_{1} = (0,0)$, $\\mathbf{r}_{2} = (2,1)$, and $\\mathbf{r}_{3} = (1,3)$. Define the polynomial Lagrange basis (linear) trial and test functions on the reference triangle with coordinates $(\\xi,\\eta)$ and vertices $(0,0)$, $(1,0)$, $(0,1)$:\n$$\n\\hat{N}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta, \\quad \\hat{N}_{2}(\\xi,\\eta) = \\xi, \\quad \\hat{N}_{3}(\\xi,\\eta) = \\eta.\n$$\nUse the isoparametric mapping\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{3} \\mathbf{r}_{i} \\hat{N}_{i}(\\xi,\\eta)\n$$\nto define the corresponding physical-element shape functions $N_{i}(\\mathbf{x}) = \\hat{N}_{i}(\\xi(\\mathbf{x}),\\eta(\\mathbf{x}))$.\n\nTasks:\n1. Derive the Jacobian matrix $\\mathbf{J}(\\xi,\\eta) = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$ of the mapping and show that it is constant on $E$.\n2. Using the gradient mapping formula\n$$\n\\nabla_{\\mathbf{x}} N_{i} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{i},\n$$\nobtain explicit expressions for $\\nabla N_{2}$ and $\\nabla N_{3}$ on $E$.\n3. Using the bilinear form $a(w,p)$, compute the single element matrix entry corresponding to the test function $N_{2}$ and the trial function $N_{3}$,\n$$\nA_{23}^{(E)} = \\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega,\n$$\nand express your final answer as a closed-form analytic expression in terms of $k$. No rounding is required. Provide your final answer with no units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided problem is a standard exercise in the Finite Element Method (FEM) applied to the Helmholtz equation. It presents a clear, self-contained task with all necessary data: the governing equation, the bilinear form, element geometry, basis functions, and the specific quantity to be computed. The methodology and terminologies are standard in computational mechanics and acoustics. The problem is therefore deemed valid. The solution proceeds by following the three tasks outlined in the problem statement.\n\nThe objective is to compute the element matrix entry $A_{23}^{(E)}$ for a triangular element $E$, defined as:\n$$\nA_{23}^{(E)} = \\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega - k^{2} \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega\n$$\nwhere $N_2$ and $N_3$ are linear Lagrange basis functions on $E$.\n\n**Task 1: Derive the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$**\n\nThe isoparametric mapping from the reference coordinates $(\\xi,\\eta)$ to the physical coordinates $\\mathbf{x} = (x,y)$ is given by\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{3} \\mathbf{r}_{i} \\hat{N}_{i}(\\xi,\\eta)\n$$\nThe vertices are $\\mathbf{r}_{1} = (0,0)$, $\\mathbf{r}_{2} = (2,1)$, and $\\mathbf{r}_{3} = (1,3)$. The reference basis functions are $\\hat{N}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$, $\\hat{N}_{2}(\\xi,\\eta) = \\xi$, and $\\hat{N}_{3}(\\xi,\\eta) = \\eta$.\n\nThe components of the mapping are:\n$$\nx(\\xi,\\eta) = x_1 \\hat{N}_1 + x_2 \\hat{N}_2 + x_3 \\hat{N}_3 = (0)(1 - \\xi - \\eta) + (2)(\\xi) + (1)(\\eta) = 2\\xi + \\eta\n$$\n$$\ny(\\xi,\\eta) = y_1 \\hat{N}_1 + y_2 \\hat{N}_2 + y_3 \\hat{N}_3 = (0)(1 - \\xi - \\eta) + (1)(\\xi) + (3)(\\eta) = \\xi + 3\\eta\n$$\nThe Jacobian matrix $\\mathbf{J}$ of this transformation is defined as\n$$\n\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(2\\xi + \\eta) = 2\n\\quad , \\quad\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(2\\xi + \\eta) = 1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi + 3\\eta) = 1\n\\quad , \\quad\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi + 3\\eta) = 3\n$$\nThus, the Jacobian matrix is\n$$\n\\mathbf{J} = \\begin{pmatrix}\n2 & 1 \\\\\n1 & 3\n\\end{pmatrix}\n$$\nSince all entries of $\\mathbf{J}$ are constants, the Jacobian matrix is constant over the entire element $E$. This is a characteristic feature of linear isoparametric elements.\n\n**Task 2: Obtain explicit expressions for $\\nabla N_{2}$ and $\\nabla N_{3}$**\n\nThe gradient of a shape function $N_i$ in physical coordinates $\\mathbf{x}$ is related to the gradient of its counterpart $\\hat{N}_i$ in reference coordinates $(\\xi, \\eta)$ by the formula:\n$$\n\\nabla_{\\mathbf{x}} N_{i} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{i}\n$$\nFirst, we compute the gradients of the reference shape functions $\\hat{N}_{2}$ and $\\hat{N}_{3}$:\n$$\n\\nabla_{(\\xi,\\eta)} \\hat{N}_{2} = \\begin{pmatrix} \\frac{\\partial \\hat{N}_{2}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_{2}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi}(\\xi) \\\\ \\frac{\\partial}{\\partial \\eta}(\\xi) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla_{(\\xi,\\eta)} \\hat{N}_{3} = \\begin{pmatrix} \\frac{\\partial \\hat{N}_{3}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_{3}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi}(\\eta) \\\\ \\frac{\\partial}{\\partial \\eta}(\\eta) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nNext, we find the inverse transpose of the Jacobian, $\\mathbf{J}^{-T}$. The determinant of $\\mathbf{J}$ is $\\det(\\mathbf{J}) = (2)(3) - (1)(1) = 5$. The inverse of $\\mathbf{J}$ is:\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\nThe inverse transpose, $\\mathbf{J}^{-T} = (\\mathbf{J}^{-1})^T$, is:\n$$\n\\mathbf{J}^{-T} = \\frac{1}{5} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix}^T = \\frac{1}{5} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\nNow we can compute the gradients of the physical shape functions $N_2$ and $N_3$:\n$$\n\\nabla N_{2} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{2} = \\frac{1}{5} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\nabla N_{3} = \\mathbf{J}^{-T} \\nabla_{(\\xi,\\eta)} \\hat{N}_{3} = \\frac{1}{5} \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\nThese gradients are constant vectors, as expected for linear basis functions on a triangular element.\n\n**Task 3: Compute the element matrix entry $A_{23}^{(E)}$**\n\nThe expression for $A_{23}^{(E)}$ is composed of two integrals. Let's call them the stiffness-like term $I_S$ and the mass-like term $I_M$.\n$$\nA_{23}^{(E)} = \\underbrace{\\int_{E} \\nabla N_{2} \\cdot \\nabla N_{3} \\, \\mathrm{d}\\Omega}_{I_S} - k^{2} \\underbrace{\\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega}_{I_M}\n$$\nFirst, we compute the stiffness-like term $I_S$. The dot product of the gradients is:\n$$\n\\nabla N_{2} \\cdot \\nabla N_{3} = \\left(\\frac{1}{5} \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}\\right) \\cdot \\left(\\frac{1}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\\right) = \\frac{1}{25} \\left( (3)(-1) + (-1)(2) \\right) = \\frac{1}{25}(-3-2) = -\\frac{5}{25} = -\\frac{1}{5}\n$$\nSince this integrand is constant over the element $E$, the integral is the product of the constant value and the area of the element, Area($E$):\n$$\nI_S = \\left(-\\frac{1}{5}\\right) \\text{Area}(E)\n$$\nThe area of the physical element $E$ is related to the area of the reference element $\\hat{E}$ by the Jacobian determinant: Area($E$) = $|\\det(\\mathbf{J})| \\text{Area}(\\hat{E})$. The reference element is a right triangle with vertices at $(0,0)$, $(1,0)$, and $(0,1)$, so its area is $\\frac{1}{2}$.\n$$\n\\text{Area}(E) = |5| \\times \\frac{1}{2} = \\frac{5}{2}\n$$\nTherefore, the stiffness-like term is:\n$$\nI_S = \\left(-\\frac{1}{5}\\right) \\left(\\frac{5}{2}\\right) = -\\frac{1}{2}\n$$\nNext, we compute the mass-like term $I_M$. We evaluate the integral by changing variables to the reference coordinate system. The differential area element transforms as $\\mathrm{d}\\Omega = |\\det(\\mathbf{J})| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 5 \\, \\mathrm{d}\\xi \\mathrm{d}\\eta$. The functions $N_i$ become $\\hat{N}_i$.\n$$\nI_M = \\int_{E} N_{2} N_{3} \\, \\mathrm{d}\\Omega = \\int_{\\hat{E}} \\hat{N}_{2}(\\xi,\\eta) \\hat{N}_{3}(\\xi,\\eta) |\\det(\\mathbf{J})| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\nSubstituting $\\hat{N}_2 = \\xi$ and $\\hat{N}_3 = \\eta$:\n$$\nI_M = \\int_{\\hat{E}} \\xi \\eta (5) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 5 \\int_{\\hat{E}} \\xi \\eta \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\nThe integral is over the reference triangle, defined by $\\xi \\ge 0$, $\\eta \\ge 0$, $\\xi+\\eta \\le 1$.\n$$\n\\int_{\\hat{E}} \\xi \\eta \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = \\int_{0}^{1} \\int_{0}^{1-\\xi} \\xi \\eta \\, \\mathrm{d}\\eta \\mathrm{d}\\xi = \\int_{0}^{1} \\xi \\left[ \\frac{\\eta^2}{2} \\right]_{0}^{1-\\xi} \\mathrm{d}\\xi = \\int_{0}^{1} \\frac{\\xi(1-\\xi)^2}{2} \\mathrm{d}\\xi\n$$\n$$\n= \\frac{1}{2} \\int_{0}^{1} (\\xi - 2\\xi^2 + \\xi^3) \\mathrm{d}\\xi = \\frac{1}{2} \\left[ \\frac{\\xi^2}{2} - \\frac{2\\xi^3}{3} + \\frac{\\xi^4}{4} \\right]_{0}^{1} = \\frac{1}{2} \\left(\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4}\\right) = \\frac{1}{2} \\left(\\frac{6 - 8 + 3}{12}\\right) = \\frac{1}{24}\n$$\nThus, the mass-like term is:\n$$\nI_M = 5 \\times \\frac{1}{24} = \\frac{5}{24}\n$$\nFinally, we combine the terms to find $A_{23}^{(E)}$:\n$$\nA_{23}^{(E)} = I_S - k^{2} I_M = -\\frac{1}{2} - k^{2} \\frac{5}{24}\n$$\nThis is the closed-form analytic expression for the specified element matrix entry.",
            "answer": "$$\n\\boxed{-\\frac{1}{2} - \\frac{5}{24}k^2}\n$$"
        },
        {
            "introduction": "While the Galerkin method is powerful, choosing test functions that differ from trial functions—the core idea of the Petrov-Galerkin method—can offer significant advantages. This exercise introduces the Streamline Upwind Petrov-Galerkin (SUPG) technique, a method that adds numerical stability by modifying the test functions with a carefully chosen derivative term. By deriving the modified residual equations for a first-order acoustic system, you will see how a deliberate choice of test functions can enhance the performance of a numerical scheme for wave propagation problems. ",
            "id": "4149589",
            "problem": "Consider one-dimensional, homogeneous, lossless, frequency-domain acoustics in a duct of length $L>0$ with constant mass density $\\rho>0$ and sound speed $c>0$. Let $p(x)$ denote the acoustic pressure and $u(x)$ the particle velocity. The governing first-order system corresponding to linear acoustics in the frequency domain with angular frequency $\\omega>0$ is\n$$\n\\partial_{x} p(x) + i\\,\\omega\\,\\rho\\,u(x) = 0, \\qquad \\partial_{x} u(x) + i\\,\\omega\\,\\kappa\\,p(x) = 0,\n$$\nwhere the compressibility is $\\kappa = \\frac{1}{\\rho\\,c^{2}}$, and the Helmholtz wavenumber is $k = \\frac{\\omega}{c}$. Assume suitable boundary conditions at $x=0$ and $x=L$ that do not alter the interior weighted residual construction.\n\nDiscretize $p(x)$ and $u(x)$ by continuous, piecewise linear trial functions on a uniform mesh of $N$ elements of size $h = \\frac{L}{N}$. Let $\\{N_{j}(x)\\}_{j=1}^{M}$ be the nodal basis for the trial space (with $M = N+1$), and approximate\n$$\np_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,p_{j}, \\qquad u_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,u_{j},\n$$\nwhere $\\{p_{j}\\}$ and $\\{u_{j}\\}$ are the nodal degrees of freedom.\n\nConstruct a Petrov-Galerkin test basis with slight upwind bias in the $+x$ direction using a Streamline Upwind Petrov-Galerkin (SUPG) choice: for each trial basis function $N_{i}(x)$, define the corresponding test function\n$$\nW_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x),\n$$\nwhere the stabilization parameter is taken to be\n$$\n\\tau = \\frac{\\beta}{i\\,k},\n$$\nwith a dimensionless bias parameter $\\beta \\in (0,1)$ prescribing a slight upwind weighting relative to the local oscillatory scale set by $k$.\n\nStarting from the governing first-order system, use the weighted residual method with the Petrov-Galerkin test functions $\\{W_{i}\\}$ to derive the modified discrete residual equations. Express the two residual entries associated with $N_{i}$, denoted $R_{i}^{p}$ and $R_{i}^{u}$, as closed-form analytic expressions in terms of $\\{N_{j}\\}$, their derivatives, and the nodal unknowns $\\{p_{j}\\}$ and $\\{u_{j}\\}$, including the SUPG modification via $\\tau$.\n\nYour final answer must be a single closed-form analytic expression for the pair $(R_{i}^{p}, R_{i}^{u})$ written as a two-entry row matrix. No numerical evaluation is required and no rounding applies. Do not include physical units in your final boxed expression.",
            "solution": "The problem is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n-   **Governing System:** $\\partial_{x} p(x) + i\\,\\omega\\,\\rho\\,u(x) = 0$ and $\\partial_{x} u(x) + i\\,\\omega\\,\\kappa\\,p(x) = 0$.\n-   **Domain:** One-dimensional duct of length $L>0$.\n-   **Physical Constants:** Mass density $\\rho>0$, sound speed $c>0$, angular frequency $\\omega>0$.\n-   **Derived Parameters:** Compressibility $\\kappa = \\frac{1}{\\rho\\,c^{2}}$, Helmholtz wavenumber $k = \\frac{\\omega}{c}$.\n-   **Boundary Conditions:** Assumed suitable, not altering the interior formulation.\n-   **Trial Functions:** Continuous, piecewise linear functions $\\{N_{j}(x)\\}_{j=1}^{M}$ on a uniform mesh ($M=N+1$).\n-   **Discrete Approximations:** $p_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,p_{j}$ and $u_{h}(x) = \\sum_{j=1}^{M} N_{j}(x)\\,u_{j}$.\n-   **Test Functions (Petrov-Galerkin):** $W_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)$.\n-   **Stabilization Parameter:** $\\tau = \\frac{\\beta}{i\\,k}$, with $\\beta \\in (0,1)$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding:** The governing equations represent the standard first-order system for linear, time-harmonic acoustics. The Streamline Upwind Petrov-Galerkin (SUPG) method is a well-established and scientifically sound numerical technique for stabilizing solutions to advection-diffusion-reaction type equations, to which the Helmholtz equation (derivable from this system) belongs. The choice of the stabilization parameter $\\tau$ is consistent with standard practice for Helmholtz problems.\n-   **Well-Posedness:** The task is to derive the discrete residual equations, which is a well-defined mathematical derivation. It does not require solving the system, thus the abstract specification of boundary conditions is sufficient.\n-   **Objectivity & Clarity:** The problem is stated using precise, standard terminology from physics and numerical analysis, free of ambiguity or subjective language.\n-   **Completeness and Consistency:** All necessary information (governing equations, discretization scheme, test functions, parameter definitions) is provided to perform the derivation. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and self-contained. It is therefore deemed **valid**. The derivation of the solution will now proceed.\n\n### Derivation of the Residual Equations\n\nThe weighted residual method requires that the residuals of the governing differential equations, evaluated with the approximate solutions $p_{h}(x)$ and $u_{h}(x)$, be orthogonal to the space of test functions $\\{W_{i}(x)\\}$.\n\nThe residuals for the pressure and velocity equations are:\n$$\n\\text{Res}_{p}(x) = \\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\n$$\n$$\n\\text{Res}_{u}(x) = \\partial_{x} u_{h}(x) + i\\,\\omega\\,\\kappa\\,p_{h}(x)\n$$\n\nThe discrete residual equations for the $i$-th node are formed by integrating the product of the test function $W_{i}(x)$ and the equation residuals over the domain $\\Omega = [0, L]$.\n$$\nR_{i}^{p} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{p}(x) \\,dx = 0\n$$\n$$\nR_{i}^{u} = \\int_{0}^{L} W_{i}(x) \\text{Res}_{u}(x) \\,dx = 0\n$$\n\nThe problem asks for the expressions for $R_{i}^{p}$ and $R_{i}^{u}$. We substitute the definition of the SUPG test function, $W_{i}(x) = N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)$, into these integrals.\n\nFor the pressure residual, $R_{i}^{p}$:\n$$\nR_{i}^{p} = \\int_{0}^{L} \\left(N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)\\right) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx\n$$\nThis can be split into the standard Galerkin term and the SUPG stabilization term:\n$$\nR_{i}^{p} = \\int_{0}^{L} N_{i}(x) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx + \\tau \\int_{0}^{L} \\partial_{x} N_{i}(x) \\left(\\partial_{x} p_{h}(x) + i\\,\\omega\\,\\rho\\,u_{h}(x)\\right) \\,dx\n$$\nNow, substitute the discrete approximations $p_{h}(x) = \\sum_{j=1}^{M} p_{j}N_{j}(x)$ and $u_{h}(x) = \\sum_{j=1}^{M} u_{j}N_{j}(x)$:\n$$\nR_{i}^{p} = \\int_{0}^{L} N_{i} \\left(\\sum_{j=1}^{M} p_{j} \\partial_{x}N_{j} + i\\,\\omega\\,\\rho \\sum_{j=1}^{M} u_{j}N_{j}\\right) \\,dx + \\tau \\int_{0}^{L} \\partial_{x} N_{i} \\left(\\sum_{j=1}^{M} p_{j} \\partial_{x}N_{j} + i\\,\\omega\\,\\rho \\sum_{j=1}^{M} u_{j}N_{j}\\right) \\,dx\n$$\nSince the nodal values $p_j$ and $u_j$ are constants with respect to integration, we can rearrange the summations and integrals:\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} p_{j} \\left(\\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx\\right) + \\sum_{j=1}^{M} u_{j} \\left(i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\rho\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx\\right)\n$$\n\nSimilarly, for the velocity residual, $R_{i}^{u}$:\n$$\nR_{i}^{u} = \\int_{0}^{L} \\left(N_{i}(x) + \\tau\\,\\partial_{x} N_{i}(x)\\right) \\left(\\partial_{x} u_{h}(x) + i\\,\\omega\\,\\kappa\\,p_{h}(x)\\right) \\,dx\n$$\nFollowing the same steps:\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} u_{j} \\left(\\int_{0}^{L} N_{i} \\partial_{x}N_{j} \\,dx + \\tau \\int_{0}^{L} \\partial_{x}N_{i} \\partial_{x}N_{j} \\,dx\\right) + \\sum_{j=1}^{M} p_{j} \\left(i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} \\,dx + i\\,\\omega\\,\\kappa\\,\\tau \\int_{0}^{L} \\partial_{x}N_{i} N_{j} \\,dx\\right)\n$$\nThese are the general expressions in terms of $\\tau$. To obtain the final form, we substitute $\\tau = \\frac{\\beta}{i\\,k}$ and simplify the coefficients using $k = \\frac{\\omega}{c}$ and $\\kappa = \\frac{1}{\\rho\\,c^2}$.\n\nConsider the stabilization coefficient for the $u_j$ term in $R_i^p$:\n$$\ni\\,\\omega\\,\\rho\\,\\tau = i\\,\\omega\\,\\rho \\left(\\frac{\\beta}{i\\,k}\\right) = \\frac{\\omega\\,\\rho\\,\\beta}{k} = \\frac{\\omega\\,\\rho\\,\\beta}{\\omega/c} = \\rho\\,c\\,\\beta\n$$\nConsider the stabilization coefficient for the $p_j$ term in $R_i^u$:\n$$\ni\\,\\omega\\,\\kappa\\,\\tau = i\\,\\omega\\,\\kappa \\left(\\frac{\\beta}{i\\,k}\\right) = \\frac{\\omega\\,\\kappa\\,\\beta}{k} = \\frac{\\omega (\\frac{1}{\\rho\\,c^2}) \\beta}{\\omega/c} = \\frac{\\beta}{\\rho\\,c}\n$$\nAnd for the derivative terms, $\\tau = \\frac{\\beta}{i\\,k} = -i\\frac{\\beta}{k}$.\n\nSubstituting these simplified forms back into the expressions for $R_i^p$ and $R_i^u$ gives the final closed-form expressions.\n\nFor $R_{i}^{p}$:\n$$\nR_{i}^{p} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n$$\nFor $R_{i}^{u}$:\n$$\nR_{i}^{u} = \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n$$\nThese expressions represent the $i$-th rows of the linear system that results from the SUPG discretization of the acoustic equations.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) p_{j} + \\left( i\\,\\omega\\,\\rho \\int_{0}^{L} N_{i} N_{j} dx + \\rho\\,c\\,\\beta \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) u_{j} \\right]\n&\n\\displaystyle \\sum_{j=1}^{M} \\left[ \\left( \\int_{0}^{L} N_{i} \\partial_{x} N_{j} dx - \\frac{i\\,\\beta}{k} \\int_{0}^{L} \\partial_{x} N_{i} \\partial_{x} N_{j} dx \\right) u_{j} + \\left( i\\,\\omega\\,\\kappa \\int_{0}^{L} N_{i} N_{j} dx + \\frac{\\beta}{\\rho\\,c} \\int_{0}^{L} \\partial_{x} N_{i} N_{j} dx \\right) p_{j} \\right]\n\\end{pmatrix}\n}\n$$"
        }
    ]
}