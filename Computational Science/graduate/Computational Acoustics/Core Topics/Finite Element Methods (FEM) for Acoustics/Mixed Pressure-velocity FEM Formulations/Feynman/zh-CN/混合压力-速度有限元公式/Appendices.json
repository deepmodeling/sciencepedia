{
    "hands_on_practices": [
        {
            "introduction": "为了有效地使用一种数值方法，我们必须首先理解其内在误差，特别是对于波动问题，数值色散会使波的相位失真。第一个实践将引导您对一个简单的一维混合有限元离散格式进行动手分析。通过推导离散色散关系并计算数值波数和误差，您将对该格式的精度如何依赖于网格尺寸和波数有一个定量的理解。",
            "id": "4128956",
            "problem": "考虑在密度为常数 $\\rho_{0}$、声速为 $c$ 的均匀、无粘性介质中的一维线性声学。声压 $p(x,t)$ 和质点速度 $u(x,t)$ 的一阶系统为\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0.\n$$\n在间距为 $h>0$ 的均匀网格上，采用混合有限元法（FEM）进行半离散化。其中，压力未知数 $p_{j}(t)$位于单元中心 $x_{j} = j h$，速度未知数 $u_{j+1/2}(t)$ 位于单元面 $x_{j+1/2} = (j+1/2) h$。这与一维情况下，通量（速度）使用最低阶的 Raviart–Thomas 空间、压力使用分段常数的处理方式一致。半离散的混合方程（在均匀网格上组装后）可以写作\n$$\n\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} + \\rho_{0} c^{2} \\frac{u_{j+1/2} - u_{j-1/2}}{h} = 0, \\qquad \\frac{\\mathrm{d} u_{j+1/2}}{\\mathrm{d} t} + \\frac{1}{\\rho_{0}} \\frac{p_{j+1} - p_{j}}{h} = 0,\n$$\n对所有整数索引 $j$ 成立。\n\n假设一个角频率为 $\\omega>0$ 的传播时谐波模式，其离散 Bloch 形式为\n$$\np_{j}(t) = \\Re\\left\\{\\hat{p} \\exp\\!\\big(i j \\theta - i \\omega t\\big)\\right\\}, \\qquad u_{j+1/2}(t) = \\Re\\left\\{\\hat{u} \\exp\\!\\big(i (j+1/2) \\theta - i \\omega t\\big)\\right\\},\n$$\n其中 $\\theta \\in \\mathbb{R}$ 是每个单元的离散相位增量。定义数值波数 $k_{\\mathrm{num}}$ 为 $k_{\\mathrm{num}} := \\theta / h$，并令真实波数为 $k := \\omega / c$。\n\n仅使用控制方程和指定的混合半离散格式，推导离散色散关系，并计算在以下参数下的数值波数 $k_{\\mathrm{num}}$：$\\rho_{0} = 1.225$ $\\mathrm{kg/m^{3}}$，$c = 343$ $\\mathrm{m/s}$，$k = 40$ $\\mathrm{rad/m}$，$h = 0.02$ $\\mathrm{m}$。然后，对于相同的离散模式，估计：\n\n- 振幅误差，定义为离散模式的压速振幅比与精确连续关系之间的相对差异，即\n$$\nE_{A} := \\left|\\frac{|\\hat{u}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right),\n$$\n- 相位误差，定义为\n$$\nE_{\\phi} := \\frac{k_{\\mathrm{num}} - k}{k}.\n$$\n\n$k_{\\mathrm{num}}$ 的最终数值以弧度/米为单位，$E_{A}$ 和 $E_{\\phi}$ 为无量纲小数。将这三个量均四舍五入至四位有效数字。你的最终答案必须仅包含这三个值，顺序为 $(k_{\\mathrm{num}}, E_{A}, E_{\\phi})$。",
            "solution": "问题验证如下。\n\n### 第1步：提取已知条件\n-   **控制连续方程**：$\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0$ 和 $\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0$。\n-   **介质属性**：密度 $\\rho_{0}$ 和声速 $c$ 为常数。\n-   **半离散方程**：$\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} + \\rho_{0} c^{2} \\frac{u_{j+1/2} - u_{j-1/2}}{h} = 0$ 和 $\\frac{\\mathrm{d} u_{j+1/2}}{\\mathrm{d} t} + \\frac{1}{\\rho_{0}} \\frac{p_{j+1} - p_{j}}{h} = 0$。\n-   **网格**：均匀网格，间距 $h > 0$。压力 $p_j$ 位于单元中心 $x_j=jh$，速度 $u_{j+1/2}$ 位于单元面 $x_{j+1/2}=(j+1/2)h$。\n-   **假定的离散解形式**：$p_{j}(t) = \\Re\\left\\{\\hat{p} \\exp\\!\\big(i j \\theta - i \\omega t\\big)\\right\\}$ 和 $u_{j+1/2}(t) = \\Re\\left\\{\\hat{u} \\exp\\!\\big(i (j+1/2) \\theta - i \\omega t\\big)\\right\\}$，角频率 $\\omega > 0$，相位增量 $\\theta \\in \\mathbb{R}$。$\\hat{p}$ 和 $\\hat{u}$ 是复振幅。\n-   **定义**：数值波数 $k_{\\mathrm{num}} := \\theta / h$，真实波数 $k := \\omega / c$。\n-   **数值**：$\\rho_{0} = 1.225$ $\\mathrm{kg/m^{3}}$，$c = 343$ $\\mathrm{m/s}$，$k = 40$ $\\mathrm{rad/m}$，$h = 0.02$ $\\mathrm{m}$。\n-   **误差定义**：振幅误差 $E_{A} := \\left|\\frac{|\\hat{u}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right)$ 和相位误差 $E_{\\phi} := \\frac{k_{\\mathrm{num}} - k}{k}$。\n-   **任务**：计算 $k_{\\mathrm{num}}$、$E_{A}$ 和 $E_{\\phi}$ 的数值，并四舍五入至四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，特别是声波方程的有限差分/元格式的色散分析。\n-   **科学依据**：物理模型（线性声学）和数值方法（交错网格有限差分，等效于最低阶一维 Raviart-Thomas 混合有限元法）是计算物理和工程中的基本概念。\n-   **适定的**：问题陈述清晰，提供了所有必要的方程、定义和参数值，以得到唯一解。\n-   **客观性**：问题以精确的数学语言表述，没有歧义或主观论断。\n所有有效性标准均已满足。\n\n### 第3步：结论与行动\n问题有效。我们继续求解。\n\n### 离散色散关系的推导\n为进行色散分析，我们将复值 ansatz（试探解） $p_j(t) = \\hat{p} e^{i(j\\theta - \\omega t)}$ 和 $u_{j+1/2}(t) = \\hat{u} e^{i((j+1/2)\\theta - \\omega t)}$ 代入半离散方程。方程的线性性质允许我们使用复数形式进行计算，并忽略 $\\Re\\{\\cdot\\}$ 算子，直到最后进行物理解释。\n\n时间导数为：\n$$\n\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} = -i \\omega \\hat{p} e^{i(j\\theta - \\omega t)} = -i \\omega p_j\n$$\n$$\n\\frac{\\mathrm{d} u_{j+1/2}}{\\mathrm{d} t} = -i \\omega \\hat{u} e^{i((j+1/2)\\theta - \\omega t)} = -i \\omega u_{j+1/2}\n$$\n\n将这些代入半离散方程：\n1.  对于节点 $j$ 处的压力方程：\n$$\n-i\\omega \\hat{p} e^{ij\\theta} + \\rho_0 c^2 \\frac{\\hat{u} e^{i(j+1/2)\\theta} - \\hat{u} e^{i(j-1/2)\\theta}}{h} = 0\n$$\n除以公因子 $e^{ij\\theta}$：\n$$\n-i\\omega \\hat{p} + \\frac{\\rho_0 c^2 \\hat{u}}{h} (e^{i\\theta/2} - e^{-i\\theta/2}) = 0\n$$\n使用欧拉公式，$e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，这可简化为：\n$$\n-i\\omega \\hat{p} + \\frac{\\rho_0 c^2 \\hat{u}}{h} (2i \\sin(\\theta/2)) = 0\n$$\n除以 $i$（因为 $\\omega>0$）得到我们的第一个代数方程：\n$$\n-\\omega \\hat{p} + \\frac{2 \\rho_0 c^2}{h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{u} = 0 \\quad \\text{(I)}\n$$\n\n2.  对于面 $j+1/2$ 处的速度方程：\n$$\n-i\\omega \\hat{u} e^{i(j+1/2)\\theta} + \\frac{1}{\\rho_0} \\frac{\\hat{p} e^{i(j+1)\\theta} - \\hat{p} e^{ij\\theta}}{h} = 0\n$$\n除以公因子 $e^{i(j+1/2)\\theta}$：\n$$\n-i\\omega \\hat{u} + \\frac{\\hat{p}}{\\rho_0 h} (e^{i\\theta/2} - e^{-i\\theta/2}) = 0\n$$\n这可以类似地简化为：\n$$\n-i\\omega \\hat{u} + \\frac{\\hat{p}}{\\rho_0 h} (2i \\sin(\\theta/2)) = 0\n$$\n除以 $i$ 得到我们的第二个代数方程：\n$$\n-\\omega \\hat{u} + \\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{p} = 0 \\quad \\text{(II)}\n$$\n\n方程 (I) 和 (II) 构成一个关于振幅 $(\\hat{p}, \\hat{u})$ 的齐次线性系统：\n$$\n\\begin{pmatrix}\n-\\omega  \\frac{2 \\rho_0 c^2}{h} \\sin(\\frac{\\theta}{2}) \\\\\n\\frac{2}{\\rho_0 h} \\sin(\\frac{\\theta}{2})  -\\omega\n\\end{pmatrix}\n\\begin{pmatrix} \\hat{p} \\\\ \\hat{u} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n为使非平凡解存在，该矩阵的行列式必须为零：\n$$\n(-\\omega)(-\\omega) - \\left(\\frac{2 \\rho_0 c^2}{h} \\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\left(\\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right)\\right) = 0\n$$\n$$\n\\omega^2 - \\frac{4 c^2}{h^2} \\sin^2\\left(\\frac{\\theta}{2}\\right) = 0\n$$\n由于 $\\omega > 0$，我们取正根，得到离散色散关系：\n$$\n\\omega = \\frac{2 c}{h} \\left|\\sin\\left(\\frac{\\theta}{2}\\right)\\right|\n$$\n对于 $\\theta=k_{\\text{num}}h$ 较小的传播波，我们可以假设 $\\sin(\\theta/2) > 0$。\n$$\n\\omega = \\frac{2 c}{h} \\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n\n### 数值波数 $k_{\\mathrm{num}}$ 的计算\n数值波数为 $k_{\\mathrm{num}} = \\theta/h$。我们求解色散关系以得到 $\\theta$。使用真实波数的定义 $k=\\omega/c$，我们可以写出 $\\omega = kc$。\n$$\nkc = \\frac{2 c}{h} \\sin\\left(\\frac{\\theta}{2}\\right) \\implies \\sin\\left(\\frac{\\theta}{2}\\right) = \\frac{kh}{2}\n$$\n这给出 $\\theta = 2 \\arcsin\\left(\\frac{kh}{2}\\right)$。因此，数值波数为：\n$$\nk_{\\mathrm{num}} = \\frac{\\theta}{h} = \\frac{2}{h} \\arcsin\\left(\\frac{kh}{2}\\right)\n$$\n使用给定值 $k = 40$ $\\mathrm{rad/m}$ 和 $h = 0.02$ $\\mathrm{m}$：\n$$\n\\frac{kh}{2} = \\frac{(40)(0.02)}{2} = \\frac{0.8}{2} = 0.4\n$$\n$$\nk_{\\mathrm{num}} = \\frac{2}{0.02} \\arcsin(0.4) = 100 \\arcsin(0.4)\n$$\n使用计算器（弧度模式），$\\arcsin(0.4) \\approx 0.4115168$。\n$$\nk_{\\mathrm{num}} \\approx 100 \\times 0.4115168 = 41.15168 \\text{ rad/m}\n$$\n四舍五入至四位有效数字，$k_{\\mathrm{num}} = 41.15$ $\\mathrm{rad/m}$。\n\n### 振幅误差 $E_A$ 的计算\n振幅误差为 $E_{A} = \\left|\\frac{|\\hat{u}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right)$。我们需要比值 $|\\hat{u}|/|\\hat{p}|$。从方程 (II) 可得：\n$$\n\\omega \\hat{u} = \\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{p} \\implies \\frac{\\hat{u}}{\\hat{p}} = \\frac{2}{\\rho_0 h \\omega} \\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n从色散关系中，我们有 $\\sin(\\theta/2) = \\frac{\\omega h}{2c}$。将其代入：\n$$\n\\frac{\\hat{u}}{\\hat{p}} = \\frac{2}{\\rho_0 h \\omega} \\left(\\frac{\\omega h}{2c}\\right) = \\frac{1}{\\rho_0 c}\n$$\n离散模式的振幅比为 $\\frac{|\\hat{u}|}{|\\hat{p}|} = \\frac{1}{\\rho_0 c}$，这与平面波的精确连续关系完全相同。因此，振幅误差为：\n$$\nE_{A} = \\left|\\frac{1}{\\rho_{0} c} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right) = 0\n$$\n由于这是一个精确结果，其值为 $0$。为使其报告格式与其他值一致，我们写作 $0.0000$。\n\n### 相位误差 $E_\\phi$ 的计算\n相位误差为 $E_{\\phi} = \\frac{k_{\\mathrm{num}} - k}{k} = \\frac{k_{\\mathrm{num}}}{k} - 1$。\n$$\n\\frac{k_{\\mathrm{num}}}{k} = \\frac{\\frac{2}{h} \\arcsin\\left(\\frac{kh}{2}\\right)}{k} = \\frac{2}{kh} \\arcsin\\left(\\frac{kh}{2}\\right)\n$$\n使用值 $kh/2 = 0.4$：\n$$\n\\frac{k_{\\mathrm{num}}}{k} = \\frac{\\arcsin(0.4)}{0.4} \\approx \\frac{0.4115168}{0.4} \\approx 1.028792\n$$\n相位误差为：\n$$\nE_{\\phi} \\approx 1.028792 - 1 = 0.028792\n$$\n四舍五入至四位有效数字，$E_{\\phi} = 0.02879$。\n\n### 结果总结\n-   $k_{\\mathrm{num}} \\approx 41.15$ $\\mathrm{rad/m}$\n-   $E_{A} = 0.0000$\n-   $E_{\\phi} \\approx 0.02879$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n41.15  0.0000  0.02879\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "如果一个数值格式不稳定，那么它的精度就毫无意义。对于混合格式，Ladyzhenskaya–Babuška–Brezzi (LBB) 或 inf-sup 条件为其稳定性提供了基本的理论保证。本练习旨在检验您对 LBB 稳定性的概念性理解，探讨为何某些有限元空间配对是不稳定的，以及如何通过诸如用气泡函数丰富速度空间等稳定化技术来恢复其鲁棒性。",
            "id": "4128952",
            "problem": "考虑在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^d$ 中的一阶线性声学方程，其单位外法向量为 $\\mathbf{n}$，密度为 $\\rho > 0$，体积模量为 $\\kappa > 0$：\n$$\n\\rho \\,\\partial_t \\mathbf{u} + \\nabla p = \\mathbf{0}, \\quad \\kappa^{-1}\\,\\partial_t p + \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\mathbf{u}$ 是声学质点速度，$p$ 是声压。在混合有限元方法 (FEM) 格式中，我们在离散空间中寻找 $(p_h,\\mathbf{u}_h)$，其中压力空间为 $Q_h \\subset L^2(\\Omega)$，速度空间为 $\\mathbf{V}_h \\subset H(\\mathrm{div};\\Omega)$，使得离散双线性形式能够继承连续问题的稳定性。一个基本的稳定性要求是针对散度-压力耦合的 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件：存在一个与网格无关的常数 $\\beta > 0$ 使得\n$$\n\\inf_{q_h \\in Q_h} \\sup_{\\mathbf{v}_h \\in \\mathbf{V}_h} \\frac{(\\nabla \\cdot \\mathbf{v}_h,\\, q_h)_{L^2(\\Omega)}}{\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}\\;\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta,\n$$\n其中 $\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}^2 = \\|\\mathbf{v}_h\\|_{L^2(\\Omega)}^2 + \\|\\nabla \\cdot \\mathbf{v}_h\\|_{L^2(\\Omega)}^2$。该条件必须对网格尺寸一致成立，并且对于时谐或瞬态问题，其常数不随参数变化而退化。一种常见的策略是，对于不满足 inf-sup 条件的次优配对 $(\\mathbf{V}_h,Q_h)$，通过在每个网格单元 $K$ 上添加法向通量在 $\\partial K$ 上为零的单元局部泡函数来丰富 $\\mathbf{V}_h$，从而扩大可达的散度空间，以期满足局部 inf-sup 检验。对于将 $\\Omega$ 剖分为单纯形 $K$ 的形状正则三角剖分，以及配对 $\\mathbf{V}_h = \\mathrm{RT}_0$ (最低阶 Raviart–Thomas 空间) 和 $Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$ (分片线性、不连续压力)，我们考虑一个丰富的速度空间\n$$\n\\mathbf{V}_h^{\\mathrm{enr}} := \\mathrm{RT}_0 \\oplus \\mathbf{B}_h,\n$$\n其中 $\\mathbf{B}_h$ 是单元局部子空间 $\\mathbf{B}_h|_K \\subset H(\\mathrm{div};K)$ 的直和，且对于所有 $\\mathbf{v}\\in \\mathbf{B}_h|_K$ 都有 $\\mathbf{v}\\cdot \\mathbf{n}|_{\\partial K}=0$。在 $K$ 上的局部 inf-sup 检验要求在 $\\mathbf{B}_h|_K$ 到 $Q_h|_K$ 上存在一个一致有界的散度算子右逆，即对于所有 $q \\in Q_h|_K$，存在 $\\mathbf{v} \\in \\mathbf{B}_h|_K$ 使得\n$$\n\\nabla \\cdot \\mathbf{v} = q \\quad \\text{in } K, \\qquad \\|\\mathbf{v}\\|_{H(\\mathrm{div};K)} \\le C \\,\\|q\\|_{L^2(K)},\n$$\n其中常数 $C$ 与 $K$ 和网格尺寸无关，这通常通过从一个参考单元经由保持 $H(\\mathrm{div})$ 空间的 Piola 变换来定义 $\\mathbf{B}_h|_K$ 实现。回答以下多项选择题，选择所有关于泡函数丰富的速度空间以及混合声学问题局部 inf-sup 检验中可接受的丰富化准则的正确陈述。\n\nA. 在每个单元上，散度算子的局部满射性，即 $\\nabla \\cdot \\mathbf{B}_h|_K = Q_h|_K$，足以保证一个对网格一致的全局 LBB 常数，无论 $Q_h$ 是连续还是不连续，并且不需要对局部右逆有任何额外的有界性要求。\n\nB. 在三角形网格上，当 $Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$ 时，通过为每个单元添加一个三维的 $H(\\mathrm{div})$ 泡函数子空间 $\\mathbf{B}_h|_K$ 来丰富 $\\mathrm{RT}_0$，该子空间由法向迹为零的 $H(\\mathrm{div})$ 协调泡函数构成，并通过 Piola 变换从参考单元映射而来，使得 $\\nabla \\cdot \\mathbf{B}_h|_K$ 张成 $\\{1,x,y\\}$，对于形状正则的网格，这会产生一个与单元形状无关的有界局部 inf-sup 常数。\n\nC. 对于 $Q_h = \\mathbb{P}_0^{\\mathrm{disc}}$ (分片常数)，配对 $(\\mathrm{RT}_0,\\mathbb{P}_0^{\\mathrm{disc}})$ 已经满足散度-压力 LBB 条件；在这种情况下，为了恢复混合格式的稳定性，对 $\\mathbf{V}_h$ 进行泡函数丰富化是不必要的。\n\nD. 如果 $Q_h = \\mathbb{P}_1^{\\mathrm{cont}}$ (连续、分片线性压力)，纯粹的单元局部泡函数丰富化（法向通量为零）通常不能恢复全局 LBB 条件，因为 $Q_h$ 上的连续性约束耦合了各个单元；需要采用宏单元(片)丰富化或替代的全局稳定化机制来克服压力的单元间连续性。\n\nE. 在时谐声学中，频率参数的存在消除了对散度-压力 inf-sup 条件的需求，因为质量项占主导；因此，任何离散配对 $(\\mathbf{V}_h,Q_h)$ 无需丰富化就是稳定的。",
            "solution": "该问题陈述是偏微分方程数值分析领域内的一个有效理论问题，具体涉及计算声学的混合有限元方法。所给的设定在科学上是合理的、适定的且客观的。它准确地描述了一阶声学方程、混合格式、Ladyzhenskaya–Babuška–Brezzi (LBB) 稳定性条件，以及针对次优单元配对的泡函数稳定化策略。所有术语和概念在相关文献中都是标准的。因此，我们可以着手评估每个陈述。\n\n问题的核心在于混合有限元格式的稳定性，该稳定性由散度-压力耦合的 LBB inf-sup 条件决定：\n$$\n\\inf_{q_h \\in Q_h} \\sup_{\\mathbf{v}_h \\in \\mathbf{V}_h} \\frac{(\\nabla \\cdot \\mathbf{v}_h,\\, q_h)_{L^2(\\Omega)}}{\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}\\;\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta > 0\n$$\n一个稳定的方法要求常数 $\\beta$ 与网格尺寸 $h$ 无关。该问题探讨了对不满足此条件的配对 $(\\mathbf{V}_h, Q_h)$（例如 $(\\mathrm{RT}_0, \\mathbb{P}_1^{\\mathrm{disc}})$）进行稳定化的问题，方法是通过局部泡函数来丰富速度空间 $\\mathbf{V}_h$。\n\n**选项 A 的分析**\n\n该陈述声称，散度算子的局部满射性，即 $\\nabla \\cdot \\mathbf{B}_h|_K = Q_h|_K$，是一个充分条件，足以保证全局稳定性，甚至不需要对局部右逆有有界性要求。\n\n正如问题描述中正确指出的，局部 inf-sup 条件需要两点：\n1. 对于任何 $q \\in Q_h|_K$，存在一个 $\\mathbf{v} \\in \\mathbf{B}_h|_K$ 使得 $\\nabla \\cdot \\mathbf{v} = q$。这是满射性部分。\n2. 存在一个与单元 $K$ 和网格尺寸无关的常数 $C$，使得这个 $\\mathbf{v}$ 满足 $\\|\\mathbf{v}\\|_{H(\\mathrm{div};K)} \\le C \\,\\|q\\|_{L^2(K)}$。这是对散度算子右逆的关键有界性要求。\n\n如果没有第二个条件，所需速度修正的范数 $\\|\\mathbf{v}\\|_{H(\\mathrm{div};K)}$ 可能会在网格加密或单元形状退化（即使在形状正则族内）时无界增长。这会导致全局稳定性常数 $\\beta$ 依赖于网格尺寸 $h$ 并趋于零，从而无法建立一致的稳定性。有界性不是一个可选项；它是稳定性证明的一个组成部分。因此，仅有局部满射性是不够的。\n\n此外，声称这“无论 $Q_h$ 是连续还是不连续”都成立是错误的。正如选项 D 的分析中所讨论的，用纯粹的局部泡函数来稳定连续压力空间通常是不可能的。\n\n**A 的结论：** 错误。\n\n**选项 B 的分析**\n\n该陈述考虑了三角形网格、$Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$ (不连续分片线性压力) 以及 $\\mathbf{V}_h = \\mathrm{RT}_0$ 的特定情况。散度空间 $\\nabla \\cdot \\mathrm{RT}_0|_K$ 是 $\\mathbb{P}_0(K)$，即单元 $K$ 上的常数空间。局部压力空间 $Q_h|_K = \\mathbb{P}_1(K)$ 是线性多项式空间，在二维情况下其维度为 3。配对 $(\\mathrm{RT}_0, \\mathbb{P}_1^{\\mathrm{disc}})$ 是出了名的不稳定，因为速度空间的散度太小了。\n\n提议的稳定化方法是用一个泡函数子空间 $\\mathbf{B}_h|_K$ 来丰富 $\\mathrm{RT}_0$，使其散度 $\\nabla \\cdot \\mathbf{B}_h|_K$ 张成 $\\{1,x,y\\}$，这正是整个局部压力空间 $\\mathbb{P}_1(K)$。这确保了丰富后的空间 $\\mathbf{V}_h^{\\mathrm{enr}}|_K = \\mathrm{RT}_0|_K \\oplus \\mathbf{B}_h|_K$ 的散度等于 $\\mathbb{P}_1(K)$。这样的泡函数空间确实可以被构造出来。该陈述指明它们是通过 Piola 变换从参考单元映射而来的。Piola 变换正是有限元理论中用来在从参考单元映射到物理单元时保持向量值基函数性质（包括散度算子的结构）的工具。对于形状正则的网格族，这确保了在参考单元上证明的任何稳定性常数将对网格中的所有单元一致成立。\n\n因此，所描述的构造是一种标准且有效的方法，用于获得一个其常数与单元几何形状无关（对于形状正则的三角剖分）的局部 inf-sup 条件，这是证明丰富后单元全局 LBB 稳定性的关键一步。\n\n**B 的结论：** 正确。\n\n**选项 C 的分析**\n\n该陈述涉及配对 $(\\mathrm{RT}_0, \\mathbb{P}_0^{\\mathrm{disc}})$。速度空间 $\\mathbf{V}_h = \\mathrm{RT}_0$ 在每个单纯形 $K$ 上由形式为 $\\mathbf{a} + b\\mathbf{x}$ 的分片向量多项式组成。$\\mathrm{RT}_0|_K$ 中任何函数的散度都是一个常数。因此，散度空间 $\\nabla \\cdot \\mathbf{V}_h$ 正是 $Q_h = \\mathbb{P}_0^{\\mathrm{disc}}$，即分片常数函数空间。\n\n由于散度算子将 $\\mathbf{V}_h$ *满射*到 $Q_h$ 上，LBB 不等式所需的满射性条件得到满足。对于 $k \\ge 0$ 的配对 $(\\mathrm{RT}_k, \\mathbb{P}_k^{\\mathrm{disc}})$ 是二阶椭圆问题的典型 LBB 稳定混合有限元族。最低阶情况 $k=0$ 即为 $(\\mathrm{RT}_0, \\mathbb{P}_0^{\\mathrm{disc}})$。由于这个配对是内在地稳定的，因此不需要像泡函数丰富化这样的修改。\n\n**C 的结论：** 正确。\n\n**选项 D 的分析**\n\n该陈述讨论了连续分片线性压力空间 $Q_h = \\mathbb{P}_1^{\\mathrm{cont}}$ 的情况。这种空间的自由度与网格的顶点相关联，并且连续性约束将解耦合在单元边界上。提议的稳定化是“纯粹的单元局部泡函数丰富化”，意味着泡函数 $\\mathbf{b} \\in \\mathbf{B}_h$ 的支集包含在单个单元 $K$ 内，因此在边界 $\\partial K$ 上的法向通量为零。\n\nLBB 条件要求为任何给定的压力函数找到一个合适的速度。对于压力 $q_h \\in \\mathbb{P}_1^{\\mathrm{cont}}$，其行为由全局顶点值决定。一个支集在单元 $K$ 上的纯粹局部泡函数 $\\mathbf{b}_K$ 只能通过其在该特定单元上的贡献，即 $(\\nabla \\cdot \\mathbf{b}_K, q_h)_K$，来影响积分 $(\\nabla \\cdot \\mathbf{v}_h, q_h)$。然而，为连续压力空间满足全局 inf-sup 条件需要控制全局的“伪”压力模式，这是对单个单元之外一无所知的校正项无法做到的。$q_h$ 的连续性施加了一个局部泡函数无法“看到”或有效控制的全局结构。为了稳定这样的配对，通常需要一个在更大尺度上起作用的稳定化机制，例如宏单元（单元片）或像伽辽金/最小二乘 (GLS) 这样的全局格式，这些机制会向整个变分形式中添加依赖于网格的项。\n\n**D 的结论：** 正确。\n\n**选项 E 的分析**\n\n该陈述考虑了时谐情况，其中 $\\partial_t$ 被替换为 $i\\omega$。得到的系统是：\n$$\ni\\omega\\rho \\,\\mathbf{u} + \\nabla p = \\mathbf{0}, \\quad i\\omega\\kappa^{-1}\\, p + \\nabla \\cdot \\mathbf{u} = \\mathbf{0}\n$$\n其主张是，对于任何 $\\omega > 0$，包含 $i\\omega$ 的质量项使得问题对于任何配对 $(\\mathbf{V}_h, Q_h)$ 都是稳定的，从而消除了对 LBB 条件的需求。\n\n这在根本上是错误的。数值格式的稳定性必须在相关物理参数（包括频率 $\\omega$）的整个范围内都是鲁棒的。一个关键的测试是低频极限，即 $\\omega \\to 0$。当 $\\omega \\to 0$ 时，时谐方程极限趋向于静态方程 $\\nabla p = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{u} = 0$。这个极限系统的离散化稳定性完全由散度-压力 LBB 条件决定。如果一个离散配对 $(\\mathbf{V}_h, Q_h)$ 不满足 LBB 条件，那么对于小的 $\\omega$，得到的离散系统将是奇异的或接近奇异的。这会导致灾难性的精度损失，这种现象被称为“低频失效”。因此，为了获得一个对所有频率都可靠的鲁棒方法，LBB 条件仍然是一个至关重要的要求。“*任何*”配对都是稳定的这一说法是错误的。\n\n**E 的结论：** 错误。",
            "answer": "$$\\boxed{BCD}$$"
        },
        {
            "introduction": "协调混合有限元方法精确地保证了速度法向分量在单元交界面上的连续性。这种界面耦合的思想在功能强大的间断 Galerkin (DG) 方法框架中，通过使用数值通量得到了推广。最后的这个实践是一个编程练习，您将实现并验证这些通量的关键性质，从而加深对 DG 方法中的弱连续性与协调混合方法中的精确连续性之间联系的理解。",
            "id": "4128966",
            "problem": "考虑一个一维线性声学系统，其以一阶形式定义在某个域上，其中未知量为声压 $p(x,t)$ 和质点速度 $u(x,t)$。介质由质量密度 $\\rho(x)$ 和体积模量 $K(x)$ 建模，声阻抗定义为 $Z(x) = \\rho(x) c(x)$，其中 $c(x) = \\sqrt{K(x)/\\rho(x)}$ 是声速。控制方程为\n$$\n\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0, \\qquad \\rho \\frac{\\partial u}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0.\n$$\n在混合有限元格式中，如果 $u$ 在一个散度协调空间 $H(\\mathrm{div})$ 中近似，那么 $u$ 的法向分量在单元界面上是精确连续的。在间断Galerkin (DG) 格式中，$p$ 和 $u$ 都由在界面上可以不连续的函数来近似，而弱连续性是通过数值通量来强制施加的。对于一维情况，在一个给定的界面上，其左迹为 $(p_L, u_L)$，介质阻抗为 $Z_L$；右迹为 $(p_R, u_R)$，介质阻抗为 $Z_R$。数值通量提供了在弱形式中使用的界面值 $(p^*, u^*)$。\n\n两种典型的数值通量选择是：\n- 中心通量：$p^* = \\frac{p_L + p_R}{2}$ 和 $u^* = \\frac{u_L + u_R}{2}$。\n- 迎风通量，它是通过求解基于特征变量 $w^\\pm = p \\pm Z u$（其速度为 $\\pm c$）的局部黎曼问题的精确解得到的。强制界面处的出射特征等于入射特征可得\n$$\np^* + Z_L u^* = p_L + Z_L u_L, \\qquad p^* - Z_R u^* = p_R - Z_R u_R,\n$$\n这意味着\n$$\nu^* = \\frac{p_L - p_R + Z_L u_L + Z_R u_R}{Z_L + Z_R}, \\qquad p^* = \\frac{Z_R p_L + Z_L p_R + Z_L Z_R (u_L - u_R)}{Z_L + Z_R}.\n$$\n这些公式是通过将系统对角化为特征变量，从基本守恒律推导出来的。\n\n你的任务是实现一个程序，对于一个选定的界面状态和阻抗测试套件，计算数值通量并验证两个一致性属性：\n- 与精确法向连续性的一致性：如果精确解在界面处是连续的，即 $p_L = p_R$ 和 $u_L = u_R$，那么中心通量和迎风通量都必须简化为公共迹 $(p_L, u_L)$。这代表了弱连续性（DG）和精确法向连续性（协调混合方法）之间的一致性。\n- 迎风通量的黎曼一致性：对于一般的左、右状态，迎风通量必须满足特征匹配条件 $p^* + Z_L u^* = p_L + Z_L u_L$ 和 $p^* - Z_R u^* = p_R - Z_R u_R$。除非界面状态是连续的，否则中心通量通常不满足此条件。\n\n实现函数来计算中心和迎风数值通量，并为以下测试套件检查这些属性。在比较浮点数时，使用绝对容差 $\\epsilon = 10^{-12}$。\n\n测试套件参数值：\n- 测试 $1$ （正常情况）：$Z_L = Z_R = 1.0$, $p_L = 0.3$, $u_L = -0.7$, $p_R = 0.3$, $u_R = -0.7$。检查中心通量是否等于 $(p_L, u_L)$。\n- 测试 $2$ （正常情况）：$Z_L = Z_R = 1.0$, $p_L = 0.3$, $u_L = -0.7$, $p_R = 0.3$, $u_R = -0.7$。检查迎风通量是否等于 $(p_L, u_L)$。\n- 测试 $3$ （一般间断，介质相同）：$Z_L = Z_R = 1.0$, $p_L = 1.0$, $u_L = 0.0$, $p_R = 0.0$, $u_R = 1.0$。检查迎风通量是否满足 $p^* + Z_L u^* = p_L + Z_L u_L$ 和 $p^* - Z_R u^* = p_R - Z_R u_R$。\n- 测试 $4$ （阻抗突变）：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = 1.2$, $u_L = -0.4$, $p_R = -0.3$, $u_R = 0.8$。检查迎风通量是否满足 $p^* + Z_L u^* = p_L + Z_L u_L$ 和 $p^* - Z_R u^* = p_R - Z_R u_R$。\n- 测试 $5$ （跨越阻抗突变的连续状态）：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = p_R = 0.6$, $u_L = u_R = -0.2$。检查中心通量是否等于 $(0.6, -0.2)$。\n- 测试 $6$ （跨越阻抗突变的连续状态）：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = p_R = 0.6$, $u_L = u_R = -0.2$。检查迎风通量是否等于 $(0.6, -0.2)$。\n- 测试 $7$ （负一致性情况）：$Z_L = Z_R = 1.0$, $p_L = 1.0$, $u_L = 0.0$, $p_R = 0.0$, $u_R = 1.0$。检查中心通量是否不满足黎曼条件，即 $p^* + Z_L u^* = p_L + Z_L u_L$ 或 $p^* - Z_R u^* = p_R - Z_R u_R$ 中至少有一个不成立。\n\n你的程序应生成单行输出，其中包含测试 $1$ 到 $7$ 的结果，形式为一个逗号分隔的布尔值列表，并用方括号括起来（例如，\"[True,False,True,True,False,True,True]\"）。输出中不需要物理单位，因为所有检查都是无量纲的布尔评估。",
            "solution": "所给出的问题是有效的。它在科学上基于计算声学原理以及双曲型偏微分方程数值方法的理论。一维线性声学的控制方程表述正确。中心通量和迎风通量的定义是标准的，并且在数学上是正确的。从系统的特征分解和局部黎曼问题的解推导迎风通量的过程也是准确的。测试套件的所有参数都已提供，使得问题是自洽的、适定的和客观的。没有矛盾、歧义或事实错误。\n\n任务是实现这些数值通量，并针对一组给定的测试用例验证其基本属性。需要验证的属性是一致性和黎曼一致性，它们是数值格式分析的基石。\n\n声压 $p(x,t)$ 和质点速度 $u(x,t)$ 的控制方程为：\n$$\n\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\rho \\frac{\\partial u}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0\n$$\n其中 $\\rho$ 是质量密度，$K$ 是体积模量。声阻抗为 $Z = \\rho c$，声速为 $c = \\sqrt{K/\\rho}$。\n\n在具有阻抗 $Z_L$ 的左状态 $(p_L, u_L)$ 和具有阻抗 $Z_R$ 的右状态 $(p_R, u_R)$ 之间的界面处，我们计算一个界面通量 $(p^*, u^*)$。\n\n中心通量定义为左、右状态的算术平均值：\n$$\np^*_{\\text{central}} = \\frac{p_L + p_R}{2}\n$$\n$$\nu^*_{\\text{central}} = \\frac{u_L + u_R}{2}\n$$\n\n迎风通量由界面处入射波和出射波的特征方程推导得出：\n$$\np^* + Z_L u^* = p_L + Z_L u_L\n$$\n$$\np^* - Z_R u^* = p_R - Z_R u_R\n$$\n求解这个关于 $(p^*, u^*)$ 的 $2 \\times 2$ 线性系统，得到显式公式：\n$$\nu^*_{\\text{upwind}} = \\frac{p_L - p_R + Z_L u_L + Z_R u_R}{Z_L + Z_R}\n$$\n$$\np^*_{\\text{upwind}} = \\frac{Z_R p_L + Z_L p_R + Z_L Z_R (u_L - u_R)}{Z_L + Z_R}\n$$\n\n我们现在将使用绝对容差 $\\epsilon = 10^{-12}$ 来验证每个测试用例的属性。\n\n**测试 $1$**：检查对于连续状态，中心通量是否等于 $(p_L, u_L)$。\n给定：$Z_L = 1.0$, $Z_R = 1.0$, $p_L = 0.3$, $u_L = -0.7$, $p_R = 0.3$, $u_R = -0.7$。\n我们计算中心通量：\n$p^* = \\frac{0.3 + 0.3}{2} = 0.3$。\n$u^* = \\frac{-0.7 + (-0.7)}{2} = -0.7$。\n通量 $(p^*, u^*) = (0.3, -0.7)$ 确实等于 $(p_L, u_L)$。检验通过。\n\n**测试 $2$**：检查对于阻抗不变的连续状态，迎风通量是否等于 $(p_L, u_L)$。\n给定：$Z_L = 1.0$, $Z_R = 1.0$, $p_L = 0.3$, $u_L = -0.7$, $p_R = 0.3$, $u_R = -0.7$。\n我们计算迎风通量：\n$u^* = \\frac{0.3 - 0.3 + 1.0(-0.7) + 1.0(-0.7)}{1.0 + 1.0} = \\frac{-1.4}{2.0} = -0.7$。\n$p^* = \\frac{1.0(0.3) + 1.0(0.3) + 1.0 \\cdot 1.0 (-0.7 - (-0.7))}{1.0 + 1.0} = \\frac{0.6 + 0}{2.0} = 0.3$。\n通量 $(p^*, u^*) = (0.3, -0.7)$ 等于 $(p_L, u_L)$。检验通过。\n\n**测试 $3$**：检查对于不连续状态，迎风通量是否满足黎曼一致性条件。\n给定：$Z_L = 1.0$, $Z_R = 1.0$, $p_L = 1.0$, $u_L = 0.0$, $p_R = 0.0$, $u_R = 1.0$。\n我们计算迎风通量：\n$u^* = \\frac{1.0 - 0.0 + 1.0(0.0) + 1.0(1.0)}{1.0 + 1.0} = \\frac{2.0}{2.0} = 1.0$。\n$p^* = \\frac{1.0(1.0) + 1.0(0.0) + 1.0 \\cdot 1.0 (0.0 - 1.0)}{1.0 + 1.0} = \\frac{1.0 - 1.0}{2.0} = 0.0$。\n通量为 $(p^*, u^*) = (0.0, 1.0)$。\n我们检查两个特征条件：\n$1$. $p^* + Z_L u^* = 0.0 + 1.0(1.0) = 1.0$。右侧：$p_L + Z_L u_L = 1.0 + 1.0(0.0) = 1.0$。这成立。\n$2$. $p^* - Z_R u^* = 0.0 - 1.0(1.0) = -1.0$。右侧：$p_R - Z_R u_R = 0.0 - 1.0(1.0) = -1.0$。这也成立。\n两个条件都满足。检验通过。\n\n**测试 $4$**：检查有阻抗突变时迎风通量的黎曼一致性。\n给定：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = 1.2$, $u_L = -0.4$, $p_R = -0.3$, $u_R = 0.8$。\n我们计算迎风通量：\n$u^* = \\frac{1.2 - (-0.3) + 2.0(-0.4) + 0.5(0.8)}{2.0 + 0.5} = \\frac{1.5 - 0.8 + 0.4}{2.5} = \\frac{1.1}{2.5} = 0.44$。\n$p^* = \\frac{0.5(1.2) + 2.0(-0.3) + 2.0 \\cdot 0.5 (-0.4 - 0.8)}{2.0 + 0.5} = \\frac{0.6 - 0.6 + 1.0(-1.2)}{2.5} = \\frac{-1.2}{2.5} = -0.48$。\n通量为 $(p^*, u^*) = (-0.48, 0.44)$。\n我们检查两个特征条件：\n$1$. $p^* + Z_L u^* = -0.48 + 2.0(0.44) = -0.48 + 0.88 = 0.4$。右侧：$p_L + Z_L u_L = 1.2 + 2.0(-0.4) = 1.2 - 0.8 = 0.4$。这成立。\n$2$. $p^* - Z_R u^* = -0.48 - 0.5(0.44) = -0.48 - 0.22 = -0.7$。右侧：$p_R - Z_R u_R = -0.3 - 0.5(0.8) = -0.3 - 0.4 = -0.7$。这也成立。\n两个条件都满足。检验通过。\n\n**测试 $5$**：检查在阻抗突变界面上，对于连续状态，中心通量是否等于 $(p_L, u_L)$。\n给定：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = 0.6$, $u_L = -0.2$, $p_R = 0.6$, $u_R = -0.2$。\n我们计算中心通量：\n$p^* = \\frac{0.6 + 0.6}{2} = 0.6$。\n$u^* = \\frac{-0.2 + (-0.2)}{2} = -0.2$。\n通量 $(p^*, u^*) = (0.6, -0.2)$ 等于连续状态 $(p_L, u_L)$。检验通过。\n\n**测试 $6$**：检查在阻抗突变界面上，对于连续状态，迎风通量是否等于 $(p_L, u_L)$。\n给定：$Z_L = 2.0$, $Z_R = 0.5$, $p_L = 0.6$, $u_L = -0.2$, $p_R = 0.6$, u_R = -0.2。\n我们计算迎风通量：\n$u^* = \\frac{0.6 - 0.6 + 2.0(-0.2) + 0.5(-0.2)}{2.0 + 0.5} = \\frac{0 - 0.4 - 0.1}{2.5} = \\frac{-0.5}{2.5} = -0.2$。\n$p^* = \\frac{0.5(0.6) + 2.0(0.6) + 2.0 \\cdot 0.5 (-0.2 - (-0.2))}{2.0 + 0.5} = \\frac{0.3 + 1.2 + 0}{2.5} = \\frac{1.5}{2.5} = 0.6$。\n通量 $(p^*, u^*) = (0.6, -0.2)$ 等于连续状态 $(p_L, u_L)$。检验通过。\n\n**测试 $7$**：检查对于不连续状态，中心通量是否不满足黎曼一致性条件。\n给定：$Z_L = 1.0$, $Z_R = 1.0$, $p_L = 1.0$, $u_L = 0.0$, $p_R = 0.0$, $u_R = 1.0$。\n我们计算中心通量：\n$p^* = \\frac{1.0 + 0.0}{2} = 0.5$。\n$u^* = \\frac{0.0 + 1.0}{2} = 0.5$。\n通量为 $(p^*, u^*) = (0.5, 0.5)$。\n我们检查两个特征条件：\n$1$. $p^* + Z_L u^* = 0.5 + 1.0(0.5) = 1.0$。右侧：$p_L + Z_L u_L = 1.0 + 1.0(0.0) = 1.0$。这个条件恰好成立。\n$2$. $p^* - Z_R u^* = 0.5 - 1.0(0.5) = 0.0$。右侧：$p_R - Z_R u_R = 0.0 - 1.0(1.0) = -1.0$。这个条件不成立，因为 $0.0 \\neq -1.0$。\n由于至少一个黎曼条件不满足，中心通量在这种间断情况下未能通过黎曼一致性检验。对此失效情况的检验通过。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies numerical fluxes for the 1D linear acoustics system.\n    \"\"\"\n\n    TOLERANCE = 1e-12\n\n    def central_flux(p_L, u_L, p_R, u_R):\n        \"\"\"Computes the central numerical flux.\"\"\"\n        p_star = (p_L + p_R) / 2.0\n        u_star = (u_L + u_R) / 2.0\n        return p_star, u_star\n\n    def upwind_flux(p_L, u_L, Z_L, p_R, u_R, Z_R):\n        \"\"\"Computes the upwind numerical flux.\"\"\"\n        denominator = Z_L + Z_R\n        if np.isclose(denominator, 0, atol=TOLERANCE):\n            # This case should not happen with physical impedances.\n            # Handle to avoid division by zero.\n            # In the limit ZL -> -ZR, the flux can be ill-defined.\n            # However, Z is always non-negative.\n            return None, None \n\n        p_star_num = Z_R * p_L + Z_L * p_R + Z_L * Z_R * (u_L - u_R)\n        u_star_num = p_L - p_R + Z_L * u_L + Z_R * u_R\n        \n        p_star = p_star_num / denominator\n        u_star = u_star_num / denominator\n        return p_star, u_star\n\n    def check_continuity_consistency(p_star, u_star, p_L, u_L):\n        \"\"\"\n        Checks if the flux (p_star, u_star) equals the given state (p_L, u_L).\n        \"\"\"\n        p_match = np.isclose(p_star, p_L, atol=TOLERANCE)\n        u_match = np.isclose(u_star, u_L, atol=TOLERANCE)\n        return p_match and u_match\n\n    def check_riemann_consistency(p_star, u_star, p_L, u_L, Z_L, p_R, u_R, Z_R):\n        \"\"\"\n        Checks if the upwind flux satisfies the characteristic matching conditions.\n        \"\"\"\n        # Outgoing characteristic from left side\n        left_char_flux = p_star + Z_L * u_star\n        # Incoming characteristic from left side\n        left_char_state = p_L + Z_L * u_L\n        \n        # Outgoing characteristic from right side\n        right_char_flux = p_star - Z_R * u_star\n        # Incoming characteristic from right side\n        right_char_state = p_R - Z_R * u_R\n        \n        left_match = np.isclose(left_char_flux, left_char_state, atol=TOLERANCE)\n        right_match = np.isclose(right_char_flux, right_char_state, atol=TOLERANCE)\n        \n        return left_match and right_match\n\n    test_cases = [\n        # Test 1: Central flux, continuous state\n        {'Z_L': 1.0, 'Z_R': 1.0, 'p_L': 0.3, 'u_L': -0.7, 'p_R': 0.3, 'u_R': -0.7, 'flux': 'central', 'check': 'continuity'},\n        # Test 2: Upwind flux, continuous state\n        {'Z_L': 1.0, 'Z_R': 1.0, 'p_L': 0.3, 'u_L': -0.7, 'p_R': 0.3, 'u_R': -0.7, 'flux': 'upwind', 'check': 'continuity'},\n        # Test 3: Upwind flux, Riemann consistency\n        {'Z_L': 1.0, 'Z_R': 1.0, 'p_L': 1.0, 'u_L': 0.0, 'p_R': 0.0, 'u_R': 1.0, 'flux': 'upwind', 'check': 'riemann'},\n        # Test 4: Upwind flux, Riemann consistency with impedance contrast\n        {'Z_L': 2.0, 'Z_R': 0.5, 'p_L': 1.2, 'u_L': -0.4, 'p_R': -0.3, 'u_R': 0.8, 'flux': 'upwind', 'check': 'riemann'},\n        # Test 5: Central flux, continuous state with impedance contrast\n        {'Z_L': 2.0, 'Z_R': 0.5, 'p_L': 0.6, 'u_L': -0.2, 'p_R': 0.6, 'u_R': -0.2, 'flux': 'central', 'check': 'continuity'},\n        # Test 6: Upwind flux, continuous state with impedance contrast\n        {'Z_L': 2.0, 'Z_R': 0.5, 'p_L': 0.6, 'u_L': -0.2, 'p_R': 0.6, 'u_R': -0.2, 'flux': 'upwind', 'check': 'continuity'},\n        # Test 7: Central flux, negative consistency (failure of Riemann consistency)\n        {'Z_L': 1.0, 'Z_R': 1.0, 'p_L': 1.0, 'u_L': 0.0, 'p_R': 0.0, 'u_R': 1.0, 'flux': 'central', 'check': 'riemann_fail'},\n    ]\n\n    results = []\n    for params in test_cases:\n        p_L, u_L, Z_L = params['p_L'], params['u_L'], params['Z_L']\n        p_R, u_R, Z_R = params['p_R'], params['u_R'], params['Z_R']\n        \n        p_star, u_star = (0.0, 0.0)\n        \n        if params['flux'] == 'central':\n            p_star, u_star = central_flux(p_L, u_L, p_R, u_R)\n        elif params['flux'] == 'upwind':\n            p_star, u_star = upwind_flux(p_L, u_L, Z_L, p_R, u_R, Z_R)\n\n        result = False\n        if params['check'] == 'continuity':\n            result = check_continuity_consistency(p_star, u_star, p_L, u_L)\n        elif params['check'] == 'riemann':\n            result = check_riemann_consistency(p_star, u_star, p_L, u_L, Z_L, p_R, u_R, Z_R)\n        elif params['check'] == 'riemann_fail':\n            # This check passes if the Riemann consistency check fails.\n            result = not check_riemann_consistency(p_star, u_star, p_L, u_L, Z_L, p_R, u_R, Z_R)\n        \n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}