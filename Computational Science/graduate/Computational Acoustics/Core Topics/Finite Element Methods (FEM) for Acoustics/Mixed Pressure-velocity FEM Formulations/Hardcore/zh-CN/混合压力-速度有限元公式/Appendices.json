{
    "hands_on_practices": [
        {
            "introduction": "对于任何用于求解波动方程的数值方法，一个关键的初始测试是分析其如何传播一个简单的平面波。这个过程揭示了数值色散（numerical dispersion），即不同频率的波以不同的数值速度传播，从而导致相位误差。本练习  将通过一个具体的计算任务，帮助你量化评估一种基础混合有限元离散格式的数值波数、振幅误差和相位误差，从而直观地理解该方法的精度和“污染”效应。",
            "id": "4128956",
            "problem": "考虑在密度为常数 $\\rho_{0}$、声速为 $c$ 的均匀无粘性介质中的一维线性声学。声压 $p(x,t)$ 和质点速度 $v(x,t)$ 的一阶系统为\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial v}{\\partial x} = 0, \\qquad \\frac{\\partial v}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0.\n$$\n在间距为 $h>0$ 的均匀网格上采用混合有限元方法（FEM）进行半离散化，其中压力未知数 $p_{j}(t)$ 位于单元中心 $x_{j} = j h$，速度未知数 $v_{j+1/2}(t)$ 位于单元面 $x_{j+1/2} = (j+1/2) h$。这与一维最低阶的 Raviart–Thomas 空间（用于通量/速度）和分片常数（用于压力）相一致。（在均匀网格上进行组装后）半离散混合方程可以写为\n$$\n\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} + \\rho_{0} c^{2} \\frac{v_{j+1/2} - v_{j-1/2}}{h} = 0, \\qquad \\frac{\\mathrm{d} v_{j+1/2}}{\\mathrm{d} t} + \\frac{1}{\\rho_{0}} \\frac{p_{j+1} - p_{j}}{h} = 0,\n$$\n对所有整数索引 $j$ 成立。\n\n假设一个角频率为 $\\omega>0$ 的传播时间谐波模式，其离散 Bloch 形式为\n$$\np_{j}(t) = \\Re\\left\\{\\hat{p} \\exp\\!\\big(i j \\theta - i \\omega t\\big)\\right\\}, \\qquad v_{j+1/2}(t) = \\Re\\left\\{\\hat{v} \\exp\\!\\big(i (j+1/2) \\theta - i \\omega t\\big)\\right\\},\n$$\n其中 $\\theta \\in \\mathbb{R}$ 是每个单元的离散相位增量。定义数值波数 $k_{\\mathrm{num}}$ 为 $k_{\\mathrm{num}} := \\theta / h$，并令真实波数为 $k := \\omega / c$。\n\n仅使用控制方程和指定的混合半离散化，推导离散色散关系，并计算在以下参数下的数值波数 $k_{\\mathrm{num}}$：$\\rho_{0} = 1.225$ $\\mathrm{kg/m^{3}}$，$c = 343$ $\\mathrm{m/s}$，$k = 40$ $\\mathrm{rad/m}$ 以及 $h = 0.02$ $\\mathrm{m}$。然后，对于相同的离散模式，估计：\n\n- 振幅误差，定义为离散模式下的压力-速度振幅比与精确连续介质关系之间的相对差异，即\n$$\nE_{A} := \\left|\\frac{|\\hat{v}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right),\n$$\n- 相位误差，定义为\n$$\nE_{\\phi} := \\frac{k_{\\mathrm{num}} - k}{k}.\n$$\n\n提供 $k_{\\mathrm{num}}$（单位为弧度/米）以及 $E_{A}$ 和 $E_{\\phi}$（无量纲小数）的最终数值。将这三个量均四舍五入到四位有效数字。您的最终答案必须只包含这三个值，并按 $(k_{\\mathrm{num}}, E_{A}, E_{\\phi})$ 的顺序排列。",
            "solution": "该问题验证如下。\n\n### 第一步：提取已知条件\n-   **控制连续介质方程**: $\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial v}{\\partial x} = 0$ 和 $\\frac{\\partial v}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0$。\n-   **介质属性**: 密度 $\\rho_{0}$ 和声速 $c$ 为常数。\n-   **半离散方程**: $\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} + \\rho_{0} c^{2} \\frac{v_{j+1/2} - v_{j-1/2}}{h} = 0$ 和 $\\frac{\\mathrm{d} v_{j+1/2}}{\\mathrm{d} t} + \\frac{1}{\\rho_{0}} \\frac{p_{j+1} - p_{j}}{h} = 0$。\n-   **网格**: 均匀网格，间距 $h > 0$。压力 $p_j$ 位于单元中心 $x_j=jh$，速度 $v_{j+1/2}$ 位于单元面 $x_{j+1/2}=(j+1/2)h$。\n-   **假设的离散解形式**: $p_{j}(t) = \\Re\\left\\{\\hat{p} \\exp\\!\\big(i j \\theta - i \\omega t\\big)\\right\\}$ 和 $v_{j+1/2}(t) = \\Re\\left\\{\\hat{v} \\exp\\!\\big(i (j+1/2) \\theta - i \\omega t\\big)\\right\\}$，其中角频率 $\\omega > 0$，相位增量 $\\theta \\in \\mathbb{R}$。$\\hat{p}$ 和 $\\hat{v}$ 是复振幅。\n-   **定义**: 数值波数 $k_{\\mathrm{num}} := \\theta / h$，真实波数 $k := \\omega / c$。\n-   **数值**: $\\rho_{0} = 1.225$ $\\mathrm{kg/m^{3}}$，$c = 343$ $\\mathrm{m/s}$，$k = 40$ $\\mathrm{rad/m}$，$h = 0.02$ $\\mathrm{m}$。\n-   **误差定义**: 振幅误差 $E_{A} := \\left|\\frac{|\\hat{v}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right)$ 和相位误差 $E_{\\phi} := \\frac{k_{\\mathrm{num}} - k}{k}$。\n-   **任务**: 计算 $k_{\\mathrm{num}}$、$E_{A}$ 和 $E_{\\phi}$ 的数值，并四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，特别是声波方程的有限差分/有限元格式的色散分析。\n-   **科学依据**: 物理模型（线性声学）和数值方法（交错网格有限差分法，等效于一维最低阶 Raviart-Thomas 混合有限元法）是计算物理和工程中的基本概念。\n-   **适定性**: 问题陈述清晰，提供了得出唯一解所需的所有方程、定义和参数值。\n-   **客观性**: 问题以精确的数学语言表述，没有歧义或主观论断。\n所有有效性标准均已满足。\n\n### 第三步：结论与行动\n问题有效。我们继续进行求解。\n\n### 离散色散关系的推导\n为进行色散分析，我们将复数值的 ansatz，$p_j(t) = \\hat{p} e^{i(j\\theta - \\omega t)}$ 和 $v_{j+1/2}(t) = \\hat{v} e^{i((j+1/2)\\theta - \\omega t)}$，代入半离散方程中。方程的线性特性允许我们使用复数形式进行处理，并在最终进行物理解释前忽略 $\\Re\\{\\cdot\\}$ 算子。\n\n时间导数为：\n$$\n\\frac{\\mathrm{d} p_{j}}{\\mathrm{d} t} = -i \\omega \\hat{p} e^{i(j\\theta - \\omega t)} = -i \\omega p_j\n$$\n$$\n\\frac{\\mathrm{d} v_{j+1/2}}{\\mathrm{d} t} = -i \\omega \\hat{v} e^{i((j+1/2)\\theta - \\omega t)} = -i \\omega v_{j+1/2}\n$$\n\n将这些代入半离散方程中：\n1.  对于节点 $j$ 处的压力方程：\n$$\n-i\\omega \\hat{p} e^{ij\\theta} + \\rho_0 c^2 \\frac{\\hat{v} e^{i(j+1/2)\\theta} - \\hat{v} e^{i(j-1/2)\\theta}}{h} = 0\n$$\n除以公因子 $e^{ij\\theta}$：\n$$\n-i\\omega \\hat{p} + \\frac{\\rho_0 c^2 \\hat{v}}{h} (e^{i\\theta/2} - e^{-i\\theta/2}) = 0\n$$\n使用欧拉公式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，上式简化为：\n$$\n-i\\omega \\hat{p} + \\frac{\\rho_0 c^2 \\hat{v}}{h} (2i \\sin(\\theta/2)) = 0\n$$\n除以 $i$（因为 $\\omega>0$）得到我们的第一个代数方程：\n$$\n-\\omega \\hat{p} + \\frac{2 \\rho_0 c^2}{h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{v} = 0 \\quad \\text{(I)}\n$$\n\n2.  对于面 $j+1/2$ 处的速度方程：\n$$\n-i\\omega \\hat{v} e^{i(j+1/2)\\theta} + \\frac{1}{\\rho_0} \\frac{\\hat{p} e^{i(j+1)\\theta} - \\hat{p} e^{ij\\theta}}{h} = 0\n$$\n除以公因子 $e^{i(j+1/2)\\theta}$：\n$$\n-i\\omega \\hat{v} + \\frac{\\hat{p}}{\\rho_0 h} (e^{i\\theta/2} - e^{-i\\theta/2}) = 0\n$$\n类似地，这可以简化为：\n$$\n-i\\omega \\hat{v} + \\frac{\\hat{p}}{\\rho_0 h} (2i \\sin(\\theta/2)) = 0\n$$\n除以 $i$ 得到我们的第二个代数方程：\n$$\n-\\omega \\hat{v} + \\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{p} = 0 \\quad \\text{(II)}\n$$\n\n方程 (I) 和 (II) 构成了关于振幅 $(\\hat{p}, \\hat{v})$ 的齐次线性系统：\n$$\n\\begin{pmatrix}\n-\\omega & \\frac{2 \\rho_0 c^2}{h} \\sin(\\frac{\\theta}{2}) \\\\\n\\frac{2}{\\rho_0 h} \\sin(\\frac{\\theta}{2}) & -\\omega\n\\end{pmatrix}\n\\begin{pmatrix} \\hat{p} \\\\ \\hat{v} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n为了存在非平凡解，该矩阵的行列式必须为零：\n$$\n(-\\omega)(-\\omega) - \\left(\\frac{2 \\rho_0 c^2}{h} \\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\left(\\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right)\\right) = 0\n$$\n$$\n\\omega^2 - \\frac{4 c^2}{h^2} \\sin^2\\left(\\frac{\\theta}{2}\\right) = 0\n$$\n由于 $\\omega > 0$，我们取正根以获得离散色散关系：\n$$\n\\omega = \\frac{2 c}{h} \\left|\\sin\\left(\\frac{\\theta}{2}\\right)\\right|\n$$\n对于小 $\\theta=k_{\\text{num}}h$ 的传播波，我们可以假设 $\\sin(\\theta/2) > 0$。\n$$\n\\omega = \\frac{2 c}{h} \\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n\n### 数值波数 $k_{\\mathrm{num}}$ 的计算\n数值波数为 $k_{\\mathrm{num}} = \\theta/h$。我们求解色散关系以得到 $\\theta$。使用真实波数的定义 $k=\\omega/c$，我们可以写出 $\\omega = kc$。\n$$\nkc = \\frac{2 c}{h} \\sin\\left(\\frac{\\theta}{2}\\right) \\implies \\sin\\left(\\frac{\\theta}{2}\\right) = \\frac{kh}{2}\n$$\n这给出 $\\theta = 2 \\arcsin\\left(\\frac{kh}{2}\\right)$。因此，数值波数为：\n$$\nk_{\\mathrm{num}} = \\frac{\\theta}{h} = \\frac{2}{h} \\arcsin\\left(\\frac{kh}{2}\\right)\n$$\n使用给定值 $k = 40$ $\\mathrm{rad/m}$ 和 $h = 0.02$ $\\mathrm{m}$：\n$$\n\\frac{kh}{2} = \\frac{(40)(0.02)}{2} = \\frac{0.8}{2} = 0.4\n$$\n$$\nk_{\\mathrm{num}} = \\frac{2}{0.02} \\arcsin(0.4) = 100 \\arcsin(0.4)\n$$\n在弧度模式下使用计算器，$\\arcsin(0.4) \\approx 0.4115168$。\n$$\nk_{\\mathrm{num}} \\approx 100 \\times 0.4115168 = 41.15168 \\text{ rad/m}\n$$\n四舍五入到四位有效数字，$k_{\\mathrm{num}} = 41.15$ $\\mathrm{rad/m}$。\n\n### 振幅误差 $E_A$ 的计算\n振幅误差为 $E_{A} = \\left|\\frac{|\\hat{v}|}{|\\hat{p}|} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right)$。我们需要比值 $|\\hat{v}|/|\\hat{p}|$。从方程 (II) 可得：\n$$\n\\omega \\hat{v} = \\frac{2}{\\rho_0 h} \\sin\\left(\\frac{\\theta}{2}\\right) \\hat{p} \\implies \\frac{\\hat{v}}{\\hat{p}} = \\frac{2}{\\rho_0 h \\omega} \\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n从色散关系中，我们有 $\\sin(\\theta/2) = \\frac{\\omega h}{2c}$。将其代入：\n$$\n\\frac{\\hat{v}}{\\hat{p}} = \\frac{2}{\\rho_0 h \\omega} \\left(\\frac{\\omega h}{2c}\\right) = \\frac{1}{\\rho_0 c}\n$$\n离散模式的振幅比为 $\\frac{|\\hat{v}|}{|\\hat{p}|} = \\frac{1}{\\rho_0 c}$，这与平面波的精确连续介质关系完全相同。因此，振幅误差为：\n$$\nE_{A} = \\left|\\frac{1}{\\rho_{0} c} - \\frac{1}{\\rho_{0} c}\\right| \\bigg/ \\left(\\frac{1}{\\rho_{0} c}\\right) = 0\n$$\n由于这是一个精确结果，其值为 $0$。为了以与其他数值一致的格式报告，我们写作 $0.0000$。\n\n### 相位误差 $E_\\phi$ 的计算\n相位误差为 $E_{\\phi} = \\frac{k_{\\mathrm{num}} - k}{k} = \\frac{k_{\\mathrm{num}}}{k} - 1$。\n$$\n\\frac{k_{\\mathrm{num}}}{k} = \\frac{\\frac{2}{h} \\arcsin\\left(\\frac{kh}{2}\\right)}{k} = \\frac{2}{kh} \\arcsin\\left(\\frac{kh}{2}\\right)\n$$\n使用值 $kh/2 = 0.4$：\n$$\n\\frac{k_{\\mathrm{num}}}{k} = \\frac{\\arcsin(0.4)}{0.4} \\approx \\frac{0.4115168}{0.4} \\approx 1.028792\n$$\n相位误差是：\n$$\nE_{\\phi} \\approx 1.028792 - 1 = 0.028792\n$$\n四舍五入到四位有效数字，$E_{\\phi} = 0.02879$。\n\n### 结果总结\n-   $k_{\\mathrm{num}} \\approx 41.15$ $\\mathrm{rad/m}$\n-   $E_{A} = 0.0000$\n-   $E_{\\phi} \\approx 0.02879$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n41.15 & 0.0000 & 0.02879\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在评估了数值方法的精度之后，下一个关键问题是其稳定性。混合有限元方法的稳定性由 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件（或称 inf-sup 条件）来保证，这是该理论的基石。本练习  旨在探讨为何某些压力和速度近似空间的组合是稳定的，而另一些则不然，并介绍如何通过气泡函数（bubble function）等增强技术来恢复稳定性。理解 LBB 条件是正确选择和使用混合有限元方法的关键。",
            "id": "4128952",
            "problem": "考虑有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 中的一阶线性声学方程，其单位外法向量为 $\\mathbf{n}$，密度为 $\\rho > 0$，体积模量为 $\\kappa > 0$：\n$$\n\\rho \\,\\partial_t \\mathbf{v} + \\nabla p = \\mathbf{0}, \\quad \\kappa^{-1}\\,\\partial_t p + \\nabla \\cdot \\mathbf{v} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\mathbf{v}$ 是声学粒子速度，$p$ 是声压。在混合有限元方法 (FEM) 格式中，我们在离散空间 $Q_h \\subset L^2(\\Omega)$ (用于压力) 和 $\\mathbf{V}_h \\subset H(\\mathrm{div};\\Omega)$ (用于速度) 中求解 $(p_h,\\mathbf{v}_h)$，使得离散双线性形式继承连续问题的稳定性。一个基本的稳定性要求是针对散度-压力耦合的 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件：存在一个与网格无关的常数 $\\beta > 0$，使得\n$$\n\\inf_{q_h \\in Q_h} \\sup_{\\mathbf{v}_h \\in \\mathbf{V}_h} \\frac{(\\nabla \\cdot \\mathbf{v}_h,\\, q_h)_{L^2(\\Omega)}}{\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}\\;\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta,\n$$\n其中 $\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}^2 = \\|\\mathbf{v}_h\\|_{L^2(\\Omega)}^2 + \\|\\nabla \\cdot \\mathbf{v}_h\\|_{L^2(\\Omega)}^2$。此条件必须对网格尺寸一致成立，并且对于时谐或瞬态问题，其常数不会随着参数的变化而退化。一种常见的稳定化不满足 inf-sup 条件的次优配对 $(\\mathbf{V}_h,Q_h)$ 的策略是，通过对每个网格单元 $K$ 增加在 $\\partial K$ 上法向通量为零的单元局部气泡函数来扩充 $\\mathbf{V}_h$，从而扩大可达散度空间，以满足局部 inf-sup 检验。对于将 $\\Omega$ 剖分为单纯形 $K$ 的形状正则三角剖分，以及配对 $\\mathbf{V}_h = \\mathrm{RT}_0$ (最低阶 Raviart–Thomas 空间) 和 $Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$ (分片线性、不连续压力)，我们考虑一个扩充的速度空间\n$$\n\\mathbf{V}_h^{\\mathrm{enr}} := \\mathrm{RT}_0 \\oplus \\mathbf{B}_h,\n$$\n其中 $\\mathbf{B}_h$ 是单元局部子空间 $\\mathbf{B}_h|_K \\subset H(\\mathrm{div};K)$ 的直和，对于所有 $\\mathbf{v}\\in \\mathbf{B}_h|_K$ 都有 $\\mathbf{v}\\cdot \\mathbf{n}|_{\\partial K}=0$。在 $K$ 上的局部 inf-sup 检验要求存在一个从 $\\mathbf{B}_h|_K$ 映到 $Q_h|_K$ 的散度算子的一致有界右逆，即对于所有 $q \\in Q_h|_K$，存在 $\\mathbf{v} \\in \\mathbf{B}_h|_K$ 使得\n$$\n\\nabla \\cdot \\mathbf{v} = q \\quad \\text{in } K, \\qquad \\|\\mathbf{v}\\|_{H(\\mathrm{div};K)} \\le C \\,\\|q\\|_{L^2(K)},\n$$\n其中常数 $C$ 与 $K$ 和网格尺寸无关，这通常通过从参考单元出发，利用保持 H(div) 的 Piola 变换来定义 $\\mathbf{B}_h|_K$ 实现。回答以下多项选择题，选择所有关于气泡函数扩充的速度空间以及混合声学问题中局部 inf-sup 检验的可接受扩充标准方面正确的陈述。\n\nA. 在每个单元上散度算子的局部满射性，即 $\\nabla \\cdot \\mathbf{B}_h|_K = Q_h|_K$，足以保证全局 LBB 常数在网格上一致，无论 $Q_h$ 是连续还是不连续，也无需对局部右逆施加任何额外的有界性要求。\n\nB. 对于三角形单元和 $Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$，通过为每个单元添加一个三维的 $H(\\mathrm{div})$ 气泡子空间 $\\mathbf{B}_h|_K$ 来扩充 $\\mathrm{RT}_0$，该子空间由法向迹为零的 $H(\\mathrm{div})$ 协调气泡函数构成，并通过 Piola 变换从参考单元映射而来，使得 $\\nabla \\cdot \\mathbf{B}_h|_K$ 张成 $\\{1,x,y\\}$，这样对于形状正则的网格，可以得到一个与单元形状无关的有界局部 inf-sup 常数。\n\nC. 对于 $Q_h = \\mathbb{P}_0^{\\mathrm{disc}}$ (分片常数)，配对 $(\\mathrm{RT}_0,\\mathbb{P}_0^{\\mathrm{disc}})$ 已经满足散度-压力 LBB 条件；在这种情况下，不需要通过气泡函数扩充 $\\mathbf{V}_h$ 来恢复混合格式的稳定性。\n\nD. 如果 $Q_h = \\mathbb{P}_1^{\\mathrm{cont}}$ (连续分片线性压力)，纯粹的具有零法向通量的单元局部气泡扩充通常无法恢复全局 LBB 条件，因为 $Q_h$ 上的连续性约束耦合了各个单元；需要采用宏单元（片）扩充或其他全局稳定化机制来克服压力的单元间连续性问题。\n\nE. 在时谐声学中，频率参数的存在消除了对散度-压力 inf-sup 条件的需求，因为质量项占主导地位；因此，任何离散配对 $(\\mathbf{V}_h,Q_h)$ 无需扩充都是稳定的。",
            "solution": "问题陈述是偏微分方程数值分析领域内的一个有效理论问题，具体涉及计算声学的混合有限元方法。所提供的设定在科学上是合理的、适定的且客观的。它准确地描述了一阶声学方程、混合格式、Ladyzhenskaya–Babuška–Brezzi (LBB) 稳定性条件，以及针对次优单元配对的气泡函数稳定化策略。所有术语和概念在相关文献中都是标准的。因此，我们可以着手评估每个陈述。\n\n问题的核心在于混合有限元格式的稳定性，这由散度-压力耦合的 LBB inf-sup 条件决定：\n$$\n\\inf_{q_h \\in Q_h} \\sup_{\\mathbf{v}_h \\in \\mathbf{V}_h} \\frac{(\\nabla \\cdot \\mathbf{v}_h,\\, q_h)_{L^2(\\Omega)}}{\\|\\mathbf{v}_h\\|_{H(\\mathrm{div};\\Omega)}\\;\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta > 0\n$$\n一个稳定的方法要求常数 $\\beta$ 与网格尺寸 $h$ 无关。该问题讨论了对不满足此条件的配对（例如 $(\\mathrm{RT}_0, \\mathbb{P}_1^{\\mathrm{disc}})$）进行稳定化的方法，即通过局部气泡函数来扩充速度空间 $\\mathbf{V}_h$。\n\n**对选项 A 的分析**\n\n该陈述声称，散度算子的局部满射性，即 $\\nabla \\cdot \\mathbf{B}_h|_K = Q_h|_K$，是保证全局稳定性的充分条件，即使没有对局部右逆的有界性要求。\n\n局部 inf-sup 条件，如问题描述中正确陈述的那样，需要两个条件：\n1. 对于任何 $q \\in Q_h|_K$，存在一个 $\\mathbf{v} \\in \\mathbf{B}_h|_K$ 使得 $\\nabla \\cdot \\mathbf{v} = q$。这是满射性部分。\n2. 存在一个与单元 $K$ 和网格尺寸无关的常数 $C$，使得这个 $\\mathbf{v}$ 满足 $\\|\\mathbf{v}\\|_{H(\\mathrm{div};K)} \\le C \\,\\|q\\|_{L^2(K)}$。这是对散度算子右逆的关键有界性要求。\n\n如果没有第二个条件，所需速度校正的范数 $\\|\\mathbf{v}\\|_{H(\\mathrm{div};K)}$ 可能会随着网格加密或单元形状退化（即使在形状正则族内）而无界增长。这将导致全局稳定性常数 $\\beta$ 依赖于网格尺寸 $h$ 并趋于零，从而无法建立一致稳定性。有界性不是一个可有可无的额外条件；它是稳定性证明的一个组成部分。因此，仅有局部满射性是不够的。\n\n此外，声称这“无论 $Q_h$ 是连续还是不连续”都成立是错误的。如选项 D 的分析中所讨论的，用纯局部气泡函数来稳定化连续压力空间通常是不可行的。\n\n**对 A 的判断：**错误。\n\n**对选项 B 的分析**\n\n该陈述考虑了三角形网格、$Q_h = \\mathbb{P}_1^{\\mathrm{disc}}$ (不连续分片线性压力) 和 $\\mathbf{V}_h = \\mathrm{RT}_0$ 的特定情况。散度空间 $\\nabla \\cdot \\mathrm{RT}_0|_K$ 是 $\\mathbb{P}_0(K)$，即单元 $K$ 上的常数空间。局部压力空间 $Q_h|_K = \\mathbb{P}_1(K)$ 是线性多项式空间，在二维情况下其维数为 3。配对 $(\\mathrm{RT}_0, \\mathbb{P}_1^{\\mathrm{disc}})$ 是众所周知的不稳定配对，因为速度空间的散度空间太小。\n\n所提出的稳定化方法是用一个气泡子空间 $\\mathbf{B}_h|_K$ 来扩充 $\\mathrm{RT}_0$，使其散度 $\\nabla \\cdot \\mathbf{B}_h|_K$ 张成 $\\{1,x,y\\}$，这正是整个局部压力空间 $\\mathbb{P}_1(K)$。这确保了扩充空间 $\\mathbf{V}_h^{\\mathrm{enr}}|_K = \\mathrm{RT}_0|_K \\oplus \\mathbf{B}_h|_K$ 的散度等于 $\\mathbb{P}_1(K)$。这样的气泡函数空间确实可以被构造出来。陈述中指出它们是通过 Piola 变换从参考单元映射而来的。Piola 变换正是有限元理论中用于在从参考单元映射到物理单元时保持向量值基函数性质（包括散度算子结构）的工具。对于形状正则的网格族，这确保了在参考单元上证明的任何稳定性常数都将一致地适用于网格中的所有单元。\n\n因此，所述的构造是一种标准且有效的方法，用以获得一个与单元几何形状无关的（对于形状正则的三角剖分）局部 inf-sup 常数，这是证明扩充后单元全局 LBB 稳定性的关键一步。\n\n**对 B 的判断：**正确。\n\n**对选项 C 的分析**\n\n该陈述涉及配对 $(\\mathrm{RT}_0, \\mathbb{P}_0^{\\mathrm{disc}})$。速度空间 $\\mathbf{V}_h = \\mathrm{RT}_0$ 在每个单纯形 $K$ 上由形式为 $\\mathbf{a} + b\\mathbf{x}$ 的分片向量多项式组成。$\\mathrm{RT}_0|_K$ 中任何函数的散度都是一个常数。因此，散度空间 $\\nabla \\cdot \\mathbf{V}_h$ 正好是 $Q_h = \\mathbb{P}_0^{\\mathrm{disc}}$，即分片常数函数空间。\n\n由于散度算子将 $\\mathbf{V}_h$ *映上* $Q_h$，LBB 不等式所需的满射性条件得到满足。对于 $k \\ge 0$，配对 $(\\mathrm{RT}_k, \\mathbb{P}_k^{\\mathrm{disc}})$ 是二阶椭圆问题中 LBB 稳定的混合有限元的标准族。最低阶情况 $k=0$ 即为 $(\\mathrm{RT}_0, \\mathbb{P}_0^{\\mathrm{disc}})$。由于该配对本身就是稳定的，因此不需要像气泡扩充这样的修改。\n\n**对 C 的判断：**正确。\n\n**对选项 D 的分析**\n\n该陈述讨论了连续分片线性压力空间 $Q_h = \\mathbb{P}_1^{\\mathrm{cont}}$ 的情况。这样一个空间的自由度与网格的顶点相关联，并且连续性约束将解在单元边界上耦合起来。所提出的稳定化方法是“纯粹的单元局部气泡扩充”，这意味着气泡函数 $\\mathbf{b} \\in \\mathbf{B}_h$ 的支集包含在单个单元 $K$ 内，因此在边界 $\\partial K$ 上的法向通量为零。\n\nLBB 条件要求为任何给定的压力函数找到一个合适的速度。对于一个压力 $q_h \\in \\mathbb{P}_1^{\\mathrm{cont}}$，其行为由全局顶点值决定。一个支集在单元 $K$ 上的纯局部气泡函数 $\\mathbf{b}_K$ 只能通过其在该特定单元上的贡献 $(\\nabla \\cdot \\mathbf{b}_K, q_h)_K$ 来影响积分 $(\\nabla \\cdot \\mathbf{v}_h, q_h)$。然而，要满足连续压力空间的全局 inf-sup 条件，需要控制全局的“伪”压力模式，而对于单个单元之外的情况“视而不见”的校正项是无法做到这一点的。$q_h$ 的连续性施加了一种局部气泡函数无法“看到”或有效控制的全局结构。为了稳定化这类配对，通常需要一种在更大尺度上起作用的稳定化机制，例如宏单元（单元片）或像 Galerkin/最小二乘法 (GLS) 这样的全局方案，后者在整个变分形式中添加了依赖于网格的项。\n\n**对 D 的判断：**正确。\n\n**对选项 E 的分析**\n\n该陈述考虑了时谐情况，其中 $\\partial_t$ 被替换为 $i\\omega$。得到的系统是：\n$$\ni\\omega\\rho \\,\\mathbf{v} + \\nabla p = \\mathbf{0}, \\quad i\\omega\\kappa^{-1}\\, p + \\nabla \\cdot \\mathbf{v} = \\mathbf{0}\n$$\n其主张是，对于任何 $\\omega > 0$，包含 $i\\omega$ 的质量项使得问题对于任何配对 $(\\mathbf{V}_h, Q_h)$ 都是稳定的，从而消除了对 LBB 条件的需要。\n\n这从根本上是错误的。数值格式的稳定性必须在相关物理参数（包括频率 $\\omega$）的整个范围内都是稳健的。一个关键的测试是低频极限，即 $\\omega \\to 0$。当 $\\omega \\to 0$ 时，时谐方程极限趋向于静态方程 $\\nabla p = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{v} = 0$。这个极限系统的离散化稳定性完全由散度-压力 LBB 条件决定。如果一个离散配对 $(\\mathbf{V}_h, Q_h)$ 不满足 LBB 条件，那么对于小的 $\\omega$，得到的离散系统将是奇异或接近奇异的。这会导致灾难性的精度损失，这种现象被称为“低频崩溃”。因此，为了获得一个对所有频率都可靠的稳健方法，LBB 条件仍然是一个至关重要的要求。关于*任何*配对都稳定的说法是错误的。\n\n**对 E 的判断：**错误。",
            "answer": "$$\\boxed{BCD}$$"
        },
        {
            "introduction": "在拥有了一个稳定且精确的格式后，迈向高效、大规模计算的最后一步是提升计算效率。后验误差估计（a posteriori error estimation）和自适应网格加密（adaptive mesh refinement）是为此而生的强大工具，它们能将计算资源集中在最需要的区域。本练习  探讨了如何设计基于残差的误差指示子，并结合 Dörfler 标记策略和各向异性加密等方法，从而高效地解析复杂的波场特征。",
            "id": "4128972",
            "problem": "考虑在有界利普希茨域 $\\Omega \\subset \\mathbb{R}^d$ 上的时谐线性声学问题，其角频率为 $\\omega > 0$，空间变化的密度为 $\\rho(\\mathbf{x}) > 0$，可压缩性为 $\\beta(\\mathbf{x}) > 0$（体积模量为 $K(\\mathbf{x}) = 1/\\beta(\\mathbf{x})$）。复压力 $p$ 和复粒子速度 $\\mathbf{v}$ 的一阶混合压力-速度系统为\n$$\ni \\omega \\rho \\, \\mathbf{v} + \\nabla p = \\mathbf{0} \\quad \\text{in } \\Omega, \\qquad\ni \\omega \\beta \\, p + \\nabla \\cdot \\mathbf{v} = g \\quad \\text{in } \\Omega,\n$$\n为简洁起见，此处省略了适当的边界条件。设 $(p_h,\\mathbf{v}_h)$ 是通过使用速度空间 $V_h \\subset H(\\operatorname{div};\\Omega)$ 和压力空间 $Q_h \\subset L^2(\\Omega)$ 的相容混合格式得到的有限元近似，如在有限元方法（FEM）中。\n\n对网格 $\\mathcal{T}_h$ 的每个单元 $K$ 定义内部残差\n$$\nR_K^{(v)} := i \\omega \\rho \\, \\mathbf{v}_h + \\nabla p_h, \\qquad\nR_K^{(p)} := i \\omega \\beta \\, p_h + \\nabla \\cdot \\mathbf{v}_h - g,\n$$\n并且，对每个内部面 $F \\subset \\partial K \\cap \\mathcal{F}_{\\mathrm{int}}$ 定义压力跳跃\n$$\nJ_F^{(p)} := \\llbracket p_h \\rrbracket := p_h|_{K^+} - p_h|_{K^-},\n$$\n其中 $K^\\pm$ 是共享 $F$ 的两个单元。考虑基于残差的局部指示子\n$$\n\\eta_K^2 := h_K^2 \\left\\| R_K^{(v)} \\right\\|_{0,K}^2 + h_K^2 \\left\\| R_K^{(p)} \\right\\|_{0,K}^2 + \\sum_{F \\subset \\partial K \\cap \\mathcal{F}_{\\mathrm{int}}} h_F \\left\\| J_F^{(p)} \\right\\|_{0,F}^2,\n$$\n其中 $h_K$ 是特征单元尺寸，$h_F$ 是特征面尺寸。\n\n从控制方程及其对 $(p,\\mathbf{v})$ 的正则性影响出发，解释为何在适当的混合范数下，作为误差的后验上界，需要同时包含内部残差项和压力跳跃项，并解释 $h_K$ 和 $h_F$ 尺度的合理性。然后，描述如何使用参数为 $0 < \\theta < 1$ 的Dörfler准则标记一个单元子集进行加密，并讨论一种适合于解析与能量通量对齐的局部波矢量传播波的各向异性加密策略。特别地，使用一阶方程来论证哪个可从 $(p_h,\\mathbf{v}_h)$ 计算的局部方向应指导各向异性的方向，以及单元尺寸的哪个分量应被最积极地减小。\n\n哪个选项正确地指定了基于上述混合残差指示子的Dörfler标记集和针对传播波的物理上合理的各向异性加密策略？\n\nA. 对所有 $K \\in \\mathcal{T}_h$ 计算 $\\eta_K$，使用内部残差 $R_K^{(v)}$, $R_K^{(p)}$ 和压力跳跃 $J_F^{(p)}$，并采用给定的 $h$ 尺度。对于给定的 $0 < \\theta < 1$，选择一个基数最小的集合 $\\mathcal{M} \\subset \\mathcal{T}_h$ 使得 $\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2$（Dörfler准则）。对于各向异性，将单元的短边维度与由 $\\widehat{\\mathbf{d}}_K := \\mathbf{v}_h|_K / \\|\\mathbf{v}_h\\|_{0,K}$（等效地由 $\\nabla p_h$）估计的局部传播方向对齐，因为 $i \\omega \\rho \\, \\mathbf{v} + \\nabla p = \\mathbf{0}$ 意味着对于传播波 $\\mathbf{v} \\parallel \\nabla p$；沿 $\\widehat{\\mathbf{d}}_K$ 的 $h_\\parallel$ 比切向的 $h_\\perp$ 减小得更多。\n\nB. 通过阈值规则 $\\mathcal{M} := \\{ K \\in \\mathcal{T}_h : \\eta_K \\ge \\theta \\max_{J \\in \\mathcal{T}_h} \\eta_J \\}$ 标记单元，仅使用内部残差 $R_K^{(v)}$, $R_K^{(p)}$，不含任何面跳跃项或 $h$ 尺度。对于各向异性，沿 $\\mathbf{v}_h$ 方向拉长单元，使得短边维度与波前相切（与 $\\nabla p_h$ 正交），因为对于平面波，压力沿 $\\mathbf{v}$ 近似恒定。\n\nC. 使用仅含面跳跃的估计子 $\\eta_K^2 := \\sum_{F \\subset \\partial K \\cap \\mathcal{F}_{\\mathrm{int}}} \\left\\| \\llbracket \\mathbf{v}_h \\cdot \\mathbf{n}_F \\rrbracket \\right\\|_{0,F}^2$ 并标记满足 $\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\le \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2$ 的最大集合 $\\mathcal{M}$。对于各向异性，主要在与 $\\mathbf{v}_h$ 正交的方向上减小网格尺寸，因为散度驱动跨流线的振荡。\n\nD. 仅用内部残差计算 $\\eta_K$，但通过频率的倒数进行缩放，即 $\\eta_K^2 := \\omega^{-2} \\big( \\| R_K^{(v)} \\|_{0,K}^2 + \\| R_K^{(p)} \\|_{0,K}^2 \\big)$。标记任何满足 $\\sum_{K \\in \\mathcal{M}} \\eta_K \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K$ 的集合 $\\mathcal{M}$（使用一次幂，而非二次方）。对于各向异性，进行各向同性加密，除非 $\\|\\nabla \\cdot \\mathbf{v}_h\\|_{0,K}$ 很大，此时在所有方向上均等地减小 $h$。\n\n选择正确的选项。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤1：提取已知条件\n- **控制系统：** 有界利普希茨域 $\\Omega \\subset \\mathbb{R}^d$ 上的时谐线性声学问题。\n- **物理参数：** 角频率 $\\omega > 0$，密度 $\\rho(\\mathbf{x}) > 0$，可压缩性 $\\beta(\\mathbf{x}) > 0$。体积模量为 $K(\\mathbf{x}) = 1/\\beta(\\mathbf{x})$。\n- **一阶方程：** 对复压力 $p$ 和复速度 $\\mathbf{v}$：\n  $$i \\omega \\rho \\, \\mathbf{v} + \\nabla p = \\mathbf{0} \\quad \\text{in } \\Omega$$\n  $$i \\omega \\beta \\, p + \\nabla \\cdot \\mathbf{v} = g \\quad \\text{in } \\Omega$$\n- **有限元近似：** 来自相容混合格式的一对解 $(p_h, \\mathbf{v}_h)$。\n- **有限元空间：** 速度空间 $V_h \\subset H(\\operatorname{div};\\Omega)$ 和压力空间 $Q_h \\subset L^2(\\Omega)$。\n- **后验分析的定义：**\n  - **内部残差：** 对于一个单元 $K \\in \\mathcal{T}_h$：\n    $R_K^{(v)} := i \\omega \\rho \\, \\mathbf{v}_h + \\nabla p_h$\n    $R_K^{(p)} := i \\omega \\beta \\, p_h + \\nabla \\cdot \\mathbf{v}_h - g$\n  - **压力跳跃：** 对于一个内部面 $F$：\n    $J_F^{(p)} := \\llbracket p_h \\rrbracket = p_h|_{K^+} - p_h|_{K^-}$\n  - **局部误差指示子：**\n    $\\eta_K^2 := h_K^2 \\left\\| R_K^{(v)} \\right\\|_{0,K}^2 + h_K^2 \\left\\| R_K^{(p)} \\right\\|_{0,K}^2 + \\sum_{F \\subset \\partial K \\cap \\mathcal{F}_{\\mathrm{int}}} h_F \\left\\| J_F^{(p)} \\right\\|_{0,F}^2$\n- **提出的问题：**\n  1. 解释指示子项和尺度的合理性。\n  2. 描述参数为 $0  \\theta  1$ 的Dörfler标记法。\n  3. 讨论一种适合传播波的各向异性加密策略。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础：** 该问题描述了时谐声学的标准一阶系统，以及一个著名的混合有限元格式，其中速度使用 $H(\\operatorname{div};\\Omega)$ 空间，压力使用 $L^2(\\Omega)$ 空间。这种空间选择（例如Raviart-Thomas、BDM）是经典的，并且已知是稳定的，避免了标准伽辽金方法求解二阶亥姆霍兹方程时可能出现的压力不稳定性。基于残差的后验误差估计、压力跳跃、Dörfler标记法和各向异性加密等概念都是数值分析和科学计算中核心且成熟的主题。该问题在科学上是合理的。\n- **良定性：** 该问题要求解释标准的数值分析技术，并在几个选项中选择一个正确的描述。这是一个定义明确的概念性问题，基于已建立的理论，有唯一的正确答案。\n- **客观性：** 问题陈述使用精确、形式化的数学语言编写，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。它在科学上合理、良定、客观，并且对于所提问题是自洽的。我将进行全面的推导和分析。\n\n### 推导与分析\n\n该问题要求理解自适应有限元方法（AFEM）应用于声学混合格式时的三个核心概念：（1）基于残差的误差指示子的结构，（2）Dörfler标记策略，以及（3）针对波问题的各向异性网格加密。\n\n**1. 误差指示子 $\\eta_K$ 的合理性**\n后验误差指示子旨在提供一个可计算的真实误差估计，在此情况下，真实误差由 $p-p_h$ 和 $\\mathbf{v}-\\mathbf{v}_h$ 的范数表示。一个好的指示子 $\\eta = (\\sum_K \\eta_K^2)^{1/2}$ 必须是*可靠的*（它从上方界定误差）和*高效的*（它被误差所界定）。给定的指示子 $\\eta_K$ 是解决此问题的标准且有效的选择。\n\n- **内部残差 ($R_K^{(v)}, R_K^{(p)}$)：** 精确解 $(p, \\mathbf{v})$ 完全满足控制方程，意味着残差处处为零。项 $\\|R_K^{(v)}\\|_{0,K}$ 和 $\\|R_K^{(p)}\\|_{0,K}$ 衡量了离散解 $(p_h, \\mathbf{v}_h)$ 在每个单元 $K$ 内部不满足偏微分方程的程度。这是局部误差的直接度量。\n\n- **压力跳跃项 ($J_F^{(p)}$)：** 混合格式使用速度空间 $V_h \\subset H(\\operatorname{div};\\Omega)$ 和压力空间 $Q_h \\subset L^2(\\Omega)$。\n    - 根据 $H(\\operatorname{div};\\Omega)$ 空间的定义，$V_h$ 中任何函数的法向分量在内部单元面上是单值的。因此，$\\llbracket \\mathbf{v}_h \\cdot \\mathbf{n}_F \\rrbracket = 0$ 是由有限元空间的选择所强制的，速度的法向分量不需要跳跃项。\n    - 相反，压力空间 $Q_h$ 是 $L^2(\\Omega)$ 的一个子空间，其中包含不连续函数。因此，离散压力 $p_h$ 通常在单元面上是不连续的，导致非零的跳跃 $\\llbracket p_h \\rrbracket$。\n    - 然而，精确压力 $p$ 必须具有更好的正则性。动量方程 $i\\omega\\rho\\mathbf{v}+\\nabla p = \\mathbf{0}$ 意味着 $\\nabla p \\in [L^2(\\Omega)]^d$（因为 $\\mathbf{v}\\in H(\\operatorname{div};\\Omega)$ 要求 $\\mathbf{v}\\in [L^2(\\Omega)]^d$），这意味着 $p \\in H^1(\\Omega)$。$H^1(\\Omega)$ 中的函数在内部面上是连续的。因此，跳跃项 $\\|J_F^{(p)}\\|_{0,F} = \\|\\llbracket p_h \\rrbracket\\|_{0,F}$ 度量了离散压力近似相对于真实解的 $H^1(\\Omega)$ 正则性的非协调性所引入的误差。它是误差的一个关键组成部分。\n\n- **尺度因子 ($h_K, h_F$)：** 单元尺寸 $h_K$ 和面尺寸 $h_F$ 的这些幂次来自于可靠性的数学证明。其证明通常涉及使用误差方程的残差形式、分部积分、柯西-施瓦茨不等式、局部插值估计（例如Clément或Scott-Zhang类型）和迹定理。这些尺度因子对于平衡不同单位和范数（例如，单元上的 $L^2$ 范数与面上的 $L^2$ 范数）是必要的，以确保总估计子 $\\eta$ 与其应估计的误差范数具有相同的量纲。对于此类问题和范数，内部残差的 $h^2$ 尺度和面跳跃的 $h^1$ 尺度是标准的。\n\n**2. Dörfler标记准则**\nDörfler标记是一种“体量追踪”或“贪婪”策略，用于选择要加密的单元。为确保自适应算法最优收敛，仅仅加密误差最大的单个单元是不够的。相反，必须加密一个单元集合，该集合共同占总估计误差的显著部分。\n- 给定一个参数 $0  \\theta  1$，Dörfler准则将标记单元的集合 $\\mathcal{M}$ 定义为总网格 $\\mathcal{T}_h$ 中基数最小（元素数量最少）的子集，且满足条件：\n$$ \\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 $$\n- 在实践中，这是通过计算所有局部指示子 $\\eta_K^2$，将它们按降序排序，然后从列表顶部向 $\\mathcal{M}$ 添加单元，直到它们的累积和达到由 $\\theta$ 乘以总和所定义的阈值为止。这确保了加密的计算工作量集中在对全局误差贡献最大的区域。\n\n**3. 针对传播波的各向异性加密**\n- 时谐波解，如压力 $p$，通常是振荡的。对于平面波 $p \\propto e^{i \\mathbf{k} \\cdot \\mathbf{x}}$，解在波矢量 $\\mathbf{k}$ 的方向上快速振荡，但在波前（与 $\\mathbf{k}$ 正交的平面）上是恒定的。\n- 为了在数值上解析这些振荡，网格尺寸 $h$ 必须相对于局部波长 $\\lambda = 2\\pi/|\\mathbf{k}|$ 足够小。对于高频问题，各向同性加密（在所有方向上减小 $h$）效率极低，因为它要求处处都是精细的网格。\n- 各向异性加密使用细长的单元。为了有效地捕捉物理现象，单元的短边维度 $h_\\parallel$ 必须与变化最快的方向——波的传播方向——对齐。长边维度 $h_\\perp$ 可以与变化缓慢的方向——沿着波前——对齐。\n- 局部传播方向必须从数值解 $(p_h, \\mathbf{v}_h)$ 中估计。动量方程 $i \\omega \\rho \\, \\mathbf{v} = - \\nabla p$ 提供了关键见解。对于传播波，该方程意味着粒子速度 $\\mathbf{v}$ 与负压力梯度 $-\\nabla p$ 成正比。这两个矢量都指向波矢量 $\\mathbf{k}$ 的方向。\n- 因此，局部传播方向的一个可靠估计是计算出的速度 $\\mathbf{v}_h$ 的方向，或者等效地，计算出的压力梯度 $\\nabla p_h$ 的方向。因此，各向异性加密策略应该在这个方向上最积极地减小单元尺寸。\n\n### 逐项分析\n\n**A. 对所有 $K \\in \\mathcal{T}_h$ 计算 $\\eta_K$，使用内部残差 $R_K^{(v)}$, $R_K^{(p)}$ 和压力跳跃 $J_F^{(p)}$，并采用给定的 $h$ 尺度。对于给定的 $0  \\theta  1$，选择一个基数最小的集合 $\\mathcal{M} \\subset \\mathcal{T}_h$ 使得 $\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2$（Dörfler准则）。对于各向异性，将单元的短边维度与由 $\\widehat{\\mathbf{d}}_K := \\mathbf{v}_h|_K / \\|\\mathbf{v}_h\\|_{0,K}$（等效地由 $\\nabla p_h$）估计的局部传播方向对齐，因为 $i \\omega \\rho \\, \\mathbf{v} + \\nabla p = \\mathbf{0}$ 意味着对于传播波 $\\mathbf{v} \\parallel \\nabla p$；沿 $\\widehat{\\mathbf{d}}_K$ 的 $h_\\parallel$ 比切向的 $h_\\perp$ 减小得更多。**\n- **误差指示子：** 正确。包含了内部残差和关键的压力跳跃项，并带有正确的 $h$ 尺度。\n- **标记策略：** 正确。这正是Dörfler标记准则的精确定义。\n- **各向异性策略：** 正确。它从动量方程中正确地使用 $\\mathbf{v}_h$ 或 $\\nabla p_h$ 识别了传播方向，并正确地指出单元的短边必须与此方向对齐以解析振荡。\n- **结论：** **正确**。\n\n**B. 通过阈值规则 $\\mathcal{M} := \\{ K \\in \\mathcal{T}_h : \\eta_K \\ge \\theta \\max_{J \\in \\mathcal{T}_h} \\eta_J \\}$ 标记单元，仅使用内部残差 $R_K^{(v)}$, $R_K^{(p)}$，不含任何面跳跃项或 $h$ 尺度。对于各向异性，沿 $\\mathbf{v}_h$ 方向拉长单元，使得短边维度与波前相切（与 $\\nabla p_h$ 正交），因为对于平面波，压力沿 $\\mathbf{v}$ 近似恒定。**\n- **误差指示子与标记：** 不正确。这是一种简单的阈值策略，而不是Dörfler标记。关键是它忽略了必要的压力跳跃项和 $h$ 尺度，使得指示子在理论上不健全。\n- **各向异性策略：** 不正确。它描述的策略与正确的策略完全相反。将长边与 $\\mathbf{v}_h$ 对齐意味着短边与传播方向正交，这将无法解析波。其理由在物理上也是错误的；压力沿着 $\\mathbf{v}$ 变化最快。\n- **结论：** **不正确**。\n\n**C. 使用仅含面跳跃的估计子 $\\eta_K^2 := \\sum_{F \\subset \\partial K \\cap \\mathcal{F}_{\\mathrm{int}}} \\left\\| \\llbracket \\mathbf{v}_h \\cdot \\mathbf{n}_F \\rrbracket \\right\\|_{0,F}^2$ 并标记满足 $\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\le \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2$ 的最大集合 $\\mathcal{M}$。对于各向异性，主要在与 $\\mathbf{v}_h$ 正交的方向上减小网格尺寸，因为散度驱动跨流线的振荡。**\n- **误差指示子与标记：** 不正确。该指示子基于速度跳跃，而对于 $H(\\operatorname{div})$ 相容方法，根据构造，速度跳跃为零。它也忽略了内部残差。标记准则是颠倒的，选择了误差最小的单元。\n- **各向异性策略：** 不正确。它建议在与传播方向正交的方向上加密，这是错误的。其理由含糊不清且不正确。\n- **结论：** **不正确**。\n\n**D. 仅用内部残差计算 $\\eta_K$，但通过频率的倒数进行缩放，即 $\\eta_K^2 := \\omega^{-2} \\big( \\| R_K^{(v)} \\|_{0,K}^2 + \\| R_K^{(p)} \\|_{0,K}^2 \\big)$。标记任何满足 $\\sum_{K \\in \\mathcal{M}} \\eta_K \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K$ 的集合 $\\mathcal{M}$（使用一次幂，而非二次方）。对于各向异性，进行各向同性加密，除非 $\\|\\nabla \\cdot \\mathbf{v}_h\\|_{0,K}$ 很大，此时在所有方向上均等地减小 $h$。**\n- **误差指示子与标记：** 不正确。它忽略了压力跳跃项。频率缩放是临时的，并且在没有标准 $h$ 尺度的情况下是不完整的。标记准则使用了 $\\eta_K$ 的一次幂而不是 $\\eta_K^2$，并且定义松散（“任何集合”）。\n- **各向异性策略：** 不正确。它默认为各向同性加密，并且未能将各向异性与波传播联系起来。所提出的策略对于解析传播波是完全错误的。\n- **结论：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}