## 引言
在[计算声学](@entry_id:172112)领域，[精确模拟](@entry_id:749142)声波的传播、散射和与结构相互作用是核心挑战。混合压力-速度有限元公式作为一种先进的数值方法，通过同时求解声压和质点速度两个变量，为高保真声学仿真提供了强大的框架。与传统的纯压力有限元方法相比，该方法在处理物理边界条件、[多物理场耦合](@entry_id:171389)以及保证局部质量守恒方面表现出独特的优势，但也对函数空间的选择和离散格式的稳定性提出了更严格的数学要求，构成了理解和应用该方法的知识缺口。

本文旨在系统性地填补这一缺口。我们将在第一部分“原理与机制”中，深入剖析该方法的理论根基，从控制方程到核心的inf-sup稳定性条件。接着，在“应用与跨学科联系”部分，我们将展示该方法在处理复杂声学问题（如PML边界、[复杂介质](@entry_id:164088)）和解决其他力学领域（如流体力学）[鞍点问题](@entry_id:174221)时的强大能力。最后，“动手实践”部分将通过具体计算任务，帮助您将理论知识转化为实践技能。通过这三个部分的学习，读者将能够全面掌握混合压力-速度有限元公式的精髓，并将其应用于解决前沿的科学与工程问题。

## 原理与机制

在上一章引言的基础上，本章旨在深入探讨混合压力-速度有限元公式的理论基础和核心机制。我们将从控制方程的物理起源出发，逐步构建其弱形式，并阐明为了确保数值解的稳定性和准确性所必须满足的关键数学原理。内容将涵盖函数空间的选择、协调性要求、稳定性条件，以及构建[稳定有限元](@entry_id:176475)对和处理不稳定对的实用技术。

### [线性声学](@entry_id:1127264)的[一阶系统](@entry_id:147467)

混合公式的出发点是[线性声学](@entry_id:1127264)的一阶控制方程组。这组方程描述了在静止、均匀、可压缩的[无粘性流体](@entry_id:198262)中，微小声扰动（声压 $p$ 和质点速度 $\mathbf{v}$）的传播行为。它们可以从流体动力学的基本守恒定律——[动量守恒](@entry_id:149964)和质量守恒——线性化得到。

**动量守恒**：牛顿第二定律应用于流体微元，即欧拉动量方程，在忽略粘性效应并线性化后，可以写为：
$$
\rho_0 \frac{\partial \mathbf{v}}{\partial t} + \nabla p = \mathbf{f}
$$
其中，$\rho_0$ 是流体的环境密度，$t$ 是时间，$\nabla p$ 是压力梯度。这个方程的每一项都代表单位体积力（单位：$\mathrm{N}/\mathrm{m}^3$）：
- $\rho_0 \frac{\partial \mathbf{v}}{\partial t}$ 是惯性力项，表示单位体积流体因加速度而产生的惯性。
- $\nabla p$ 是压力[梯度力](@entry_id:166847)项，是驱动流体运动的恢复力。
- $\mathbf{f}$ 是可能存在的外体积力源，如电动力扬声器中的洛伦兹力。

**[质量守恒](@entry_id:204015)**：质量[连续性方程](@entry_id:195013)描述了流体密度的变化与[速度场散度](@entry_id:178755)的关系。结合等熵[状态方程](@entry_id:274378)（对于小扰动，$p = c^2 \rho'$，其中 $\rho'$ 是密度扰动，$c$ 是声速），我们可以得到关于压力和速度的方程：
$$
\frac{1}{\rho_0 c^2} \frac{\partial p}{\partial t} + \nabla \cdot \mathbf{v} = \frac{s}{\rho_0 c^2}
$$
这里，$\frac{1}{\rho_0 c^2}$ 通常被称为可压缩性 $\beta$ 或体模量 $K = \rho_0 c^2$ 的倒数。这个方程的各项代表了单位体积的体积变化率（单位：$\mathrm{s}^{-1}$）：
- $\frac{1}{K} \frac{\partial p}{\partial t}$ 代表由于压力随时间变化而引起的[体积应变率](@entry_id:272471)。
- $\nabla \cdot \mathbf{v}$ 代表速度场的散度，直接描述了流体的局部膨胀或压缩。
- $s$ 是一个体积注入源（单位：$\mathrm{Pa}/\mathrm{s}$），与局部质量注入率相关。

将这两个方程联立，我们便得到了描述[线性声学](@entry_id:1127264)的一阶速度-压力系统 。这个系统的一个重要特性是它内在的能量守恒关系。在没有源项（$\mathbf{f}=\mathbf{0}, s=0$）的情况下，系统的总声能，即动能密度 $\frac{1}{2}\rho_0 |\mathbf{v}|^2$ 与势能密度 $\frac{1}{2\kappa} p^2$ 之和，在整个区域内是守恒的，其能量流由声强向量 $\mathbf{J} = p\mathbf{v}$ 描述。这保证了该数学模型在物理上是自洽的。

### 混合弱形式与函数空间要求

直接求解上述强形式的偏微分方程组在数值上是困难的，特别是当解的边界或内部存在不光滑特性时。有限元法（FEM）通过求解其等价的积分形式（即[弱形式](@entry_id:142897)）来规避这一难题。[混合压力-速度公式](@entry_id:1127962)的精髓在于它对压力和速度变量采用不同的处理方式，从而对解的正则性（光滑度）提出了更宽松的要求。

为了推导弱形式，我们将[动量方程](@entry_id:197225)与一个矢量测试函数 $\mathbf{w}$ 做[内积](@entry_id:750660)并在区域 $\Omega$ 上积分，将质量方程与一个标量测试函数 $q$ 做[内积](@entry_id:750660)并积分。对于动量方程中的压力梯度项 $\int_{\Omega} (\nabla p) \cdot \mathbf{w} \, d\mathbf{x}$，我们应用[格林公式](@entry_id:173118)（一种高维度的分部积分）：
$$
\int_{\Omega} (\nabla p) \cdot \mathbf{w} \, d\mathbf{x} = - \int_{\Omega} p (\nabla \cdot \mathbf{w}) \, d\mathbf{x} + \oint_{\partial\Omega} p (\mathbf{w} \cdot \mathbf{n}) \, ds
$$
其中 $\mathbf{n}$ 是边界 $\partial\Omega$ 上的单位外[法向量](@entry_id:264185)。这个操作是混合公式的核心。它将[梯度算子](@entry_id:1125719) $\nabla$ 从未知的压[力场](@entry_id:147325) $p$ 转移到了已知的[测试函数](@entry_id:166589) $\mathbf{w}$ 上。这样做的直接好处是，我们不再需要 $p$ 的梯度是平方可积的，而只需要 $p$ 本身是平方可积的。这就引出了对压力空间的自然选择：$p \in L^2(\Omega)$，即[平方可积函数](@entry_id:200316)的空间 。

相应地，为了使新的体积积分项 $\int_{\Omega} p (\nabla \cdot \mathbf{w}) \, d\mathbf{x}$ 有意义，测试函数 $\mathbf{w}$ 的散度 $\nabla \cdot \mathbf{w}$ 也必须是平方可积的。这个要求定义了一个特殊的[索博列夫空间](@entry_id:141995)，即 $H(\mathrm{div};\Omega)$ 空间。因此，速度变量 $\mathbf{v}$ 和其测试函数 $\mathbf{w}$ 的自然选择便是属于 $H(\mathrm{div};\Omega)$ 空间 。

综上所述，[混合压力-速度公式](@entry_id:1127962)的[弱形式](@entry_id:142897)是：寻找一对解 $(\mathbf{v}, p)$，使其属于[函数空间](@entry_id:143478)对 $(H(\mathrm{div};\Omega), L^2(\Omega))$，并对所有来自相同空间的[测试函数](@entry_id:166589) $(\mathbf{w}, q)$ 满足相应的[积分方程](@entry_id:138643)。这种基于 $(H(\mathrm{div};\Omega), L^2(\Omega))$ 的选择，不仅放宽了对压力解的正则性要求，而且与物理守恒律和微分算子的内在结构高度契合，形成了所谓的“自然配对”。

### [索博列夫空间](@entry_id:141995) $H(\mathrm{div};\Omega)$：性质与协调性

$H(\mathrm{div};\Omega)$ 空间在[混合有限元法](@entry_id:165231)中扮演着至关重要的角色，其定义为：
$$
H(\mathrm{div};\Omega) := \{ \mathbf{w} \in (L^2(\Omega))^d : \nabla \cdot \mathbf{w} \in L^2(\Omega) \}
$$
这意味着空间中的向量场函数自身及其散度都是平方可积的。这个空间最重要的特性之一是其[迹定理](@entry_id:203967) (trace theorem) 。与 $H^1(\Omega)$ 空间中的函数在边界上具有良好定义的迹（值）不同，$H(\mathrm{div};\Omega)$ 空间中的向量场在边界上具有良好定义的**法向分量迹** $\gamma_n(\mathbf{w}) = \mathbf{w} \cdot \mathbf{n}$。这个法向迹通常不属于 $L^2(\partial\Omega)$，而是属于一个更广义的分布空间 $H^{-1/2}(\partial\Omega)$。这一特性至关重要，因为它允许我们在弱形式中严格地施加关于法向通量（如刚性壁条件 $\mathbf{v} \cdot \mathbf{n} = 0$）的边界条件，这些边界条件在混合法中被当作**本质边界条件**来处理。

在[有限元离散化](@entry_id:193156)中，我们需要构建 $H(\mathrm{div};\Omega)$ 的有限维子空间 $V_h$。一个[离散空间](@entry_id:155685) $V_h$ 被称为是 **$H(\mathrm{div})$-协调的 (conforming)**，如果 $V_h$ 是 $H(\mathrm{div};\Omega)$ 的一个子集。在实践中，这要求 $V_h$ 中的任何函数在单元之间的公共边界上其法向分量必须是连续的 。这种法向连续性是 $H(\mathrm{div})$ 协调单元（如后面将要讨论的 Raviart-Thomas 单元）的关键设计原则。它确保了跨单元边界的通量是单值的，从而在离散层面上能够精确地满足局部质量守恒，这是该方法的一个巨大优势。

反之，如果选择的离散[速度空间](@entry_id:181216) $V_h$ 不是 $H(\mathrm{div})$-协调的（例如，采用标准的连续拉格朗日单元，其法向分量在单元间不一定连续），那么在分布意义下，其散度将在单元边界上产生奇异的狄拉克分布项（跳跃项）。此时，单元内部的散度之和不再是整个区域上的真实散度，导致弱形式中的[分部积分公式](@entry_id:145262)失效，从而破坏了格式的**一致性**。这种不协调性通常会导致数值方法不稳定或收敛到错误的解 。

### [混合格式](@entry_id:167436)的稳定性：Inf-Sup 条件

仅仅为速度和压力选择协调的[离散空间](@entry_id:155685)（即 $V_h \subset H(\mathrm{div};\Omega)$ 和 $Q_h \subset L^2(\Omega)$）并不足以保证得到一个可靠的数值方法。一个不恰当的空间配对，即使是协调的，也可能导致数值解中出现非物理的、棋盘状的“[伪压力模式](@entry_id:755261)” 。这种不稳定性现象的根源在于离散[速度空间](@entry_id:181216) $V_h$ “无法看清”或“无法控制”离散压力空间 $Q_h$ 中的某些模式。

为了确保稳定性，[离散空间](@entry_id:155685)对 $(V_h, Q_h)$ 必须满足一个关键的[相容性条件](@entry_id:637057)，即 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件，或称为 **[inf-sup 条件](@entry_id:174538)**。对于我们的声学问题，该条件可以表述为：存在一个与网格尺寸 $h$ 无关的正常数 $\beta > 0$，使得：
$$
\inf_{q_h \in Q_h \setminus \{0\}} \sup_{\mathbf{w}_h \in V_h \setminus \{\mathbf{0}\}} \frac{(\nabla \cdot \mathbf{w}_h, q_h)}{\|\mathbf{w}_h\|_{H(\mathrm{div};\Omega)} \|q_h\|_{L^2(\Omega)}} \ge \beta
$$
其中 $(\cdot, \cdot)$ 代表 $L^2$ [内积](@entry_id:750660)。这个条件在物理和数学上都有深刻的含义 ：
- **物理上**，它表明压力作为施加质量守恒约束（$\nabla \cdot \mathbf{v} \approx 0$）的[拉格朗日乘子](@entry_id:142696)是稳定且适定的。[inf-sup 条件](@entry_id:174538)确保了对于压力空间中任何不可忽略的模式 $q_h$，都存在一个速度场 $\mathbf{w}_h$ 其散度可以“感知”到它，从而避免了伪压力的产生。
- **数学上**，它等价于离散散度算子 $\nabla \cdot: V_h \to Q_h$ 存在一个一致有界的[右逆](@entry_id:161498)。这意味着对于任何压[力场](@entry_id:147325) $q_h \in Q_h$，我们都能找到一个速度场 $\mathbf{w}_h \in V_h$，使得 $\nabla \cdot \mathbf{w}_h = q_h$，并且其范数 $\|\mathbf{w}_h\|_{H(\mathrm{div};\Omega)}$ 被 $\|q_h\|_{L^2(\Omega)}$ 所控制。

如果 LBB 条件不被满足，那么离散算子 $\nabla \cdot$ 的值域 $\mathcal{R}_h = \{\nabla \cdot \mathbf{v}_h : \mathbf{v}_h \in V_h\}$ 将无法覆盖整个压力空间 $Q_h$。此时 $Q_h$ 中存在非零函数 $q_h$ 与 $\mathcal{R}_h$ 正交，这些函数就是[伪压力模式](@entry_id:755261) 。

### 构建稳定的有限元对

在实践中，验证 LBB 条件是复杂的。幸运的是，通过[有限元外微分](@entry_id:174585)（Finite Element Exterior Calculus）的深刻见解，我们有了一个更具构造性的准则来保证 LBB 稳定：选择的有限元空间对 $(V_h, Q_h)$ 应当构成一个**离散精确序列**。对于我们的问题，这简化为一个直接的代数条件 ：
$$
\nabla \cdot V_h = Q_h
$$
即，离散[速度空间](@entry_id:181216) $V_h$ 在[散度算子](@entry_id:265975)作用下的[像空间](@entry_id:918062)，必须恰好是整个离散压力空间 $Q_h$。这一条件确保了[散度算子](@entry_id:265975)是满射的，从而直接满足了 LBB 条件，并杜绝了[伪压力模式](@entry_id:755261)的出现。

满足这一条件的典型[稳定有限元](@entry_id:176475)对包括：

- **Raviart-Thomas (RT) 单元族**：这是最经典的 $H(\mathrm{div})$-协调单元族。在单纯形网格（二维的三角形或三维的四面体）上，最低阶的 $RT_0$ 单元与分片常数压力 $\mathbb{P}_0$ 配对。对于 $k \ge 0$ 阶，$RT_k$ 单元的速度场在每个单元 $K$ 上的局部空间为 $\mathrm{RT}_k(K) := \mathbb{P}_k(K)^d + \mathbf{x}\mathbb{P}_k(K)$，其中 $\mathbb{P}_k(K)$ 是次数不超过 $k$ 的[多项式空间](@entry_id:144410) 。其自由度被巧妙地定义为法向通量在单元边界上的矩和速度场在单元内部的矩，以确保法向分量的连续性。该单元族的关键性质是 $\nabla \cdot (\mathrm{RT}_k) = \mathbb{P}_k$。因此，配对 $(V_h = \mathrm{RT}_k, Q_h = \mathbb{P}_k^{\mathrm{disc}})$ 满足 $\nabla \cdot V_h = Q_h$，是一个稳定的组合 。

- **Brezzi-Douglas-Marini (BDM) 单元族**：这是另一族重要的 $H(\mathrm{div})$-协调单元。$BDM_k$ 单元的速度场局部空间为 $\mathbb{P}_k(K)^d$。其散度空间为 $\mathbb{P}_{k-1}(K)$。因此，配对 $(V_h = \mathrm{BDM}_k, Q_h = \mathbb{P}_{k-1}^{\mathrm{disc}})$ 是稳定的。

这些稳定的配对关系，在更深的层次上，是由所谓的 **de Rham 复形** 的代数拓扑结构所保证的。这个复形将一系列[函数空间](@entry_id:143478)和[微分算子](@entry_id:140145)组织起来：
$$
H^1 \xrightarrow{\nabla} H(\mathrm{curl}) \xrightarrow{\nabla \times} H(\mathrm{div}) \xrightarrow{\nabla \cdot} L^2
$$
选择 $H(\mathrm{div})$ 与 $L^2$ 配对，正是因为它恰好对应于这个序列的最后一步，确保了算子和空间的高度兼容性 。

### 不稳定元对的稳定化技术

尽管存在理论上完美的稳定单元对，但在某些应用中，人们可能倾向于使用更简单的单元，例如对速度和压力都使用标准的连续拉格朗日单元（例如，$\mathbb{P}_1-\mathbb{P}_1$）。这种选择虽然简单，但它不满足 LBB 条件，会导致严重的伪压力振荡。

为了能够使用这类不稳定的单元对，研究者们发展了**稳定化技术**。其核心思想是修改原始的[弱形式](@entry_id:142897)，加入一个额外的惩罚项，以弥补 LBB 条件的缺失。对于压力-速度系统，一种常见且有效的技术是 **grad-div 稳定化** 。

这种技术在原始[双线性形式](@entry_id:746794)中添加一个与[速度散度](@entry_id:264117)相关的项：
$$
S_\gamma((\mathbf{v}_h, p_h), (\mathbf{w}_h, q_h)) = \gamma (\nabla \cdot \mathbf{v}_h, \nabla \cdot \mathbf{w}_h)_\Omega
$$
其中 $\gamma > 0$ 是一个用户选择的稳定化参数。这个附加项有以下几个作用：
1.  **抑制[伪压力模式](@entry_id:755261)**：该项惩罚了[速度场散度](@entry_id:178755)的 $L^2$ 范数。由于[伪压力模式](@entry_id:755261)通常与[速度场散度](@entry_id:178755)的剧烈振荡相关联，这个惩罚项能够有效地抑制这些非物理振荡，从而恢复解的稳定性。
2.  **改善近不可压极限下的表现**：在低频声学中，流体接[近不可压缩](@entry_id:752387)（$\nabla \cdot \mathbf{v} \approx 0$）。对于不稳定的单元，这个约束可能导致“闭锁”现象，使解变得过于僵硬。grad-div 项通过更强地施加散度约束，可以缓解这一问题。

需要强调的是，grad-div 稳定化是一种**非一致性 (inconsistent)** 的方法，因为原始方程的精确解并不能完全满足被修改后的弱形式。这意味着它引入了一个与参数 $\gamma$ 和网格尺寸 $h$ 相关的建模误差。尽管如此，通过审慎选择参数，它在实践中仍然是一种非常有效和流行的技术，能够在保持简单单元优势的同时，获得稳定且足够精确的数值解。