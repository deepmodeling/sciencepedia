{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的有限元模型之前，对问题的物理尺度有基本的把握至关重要。本练习旨在将频率、声阻抗等基本声学量与有限元方法中的关键数值参数（即无量纲数 $kh$ 和阻抗比）联系起来 。通过这个实践，您将学会如何为声学仿真做出关于网格划分和边界条件设置的明智决策，这是确保仿真成功的关键第一步。",
            "id": "4141647",
            "problem": "一个无粘性、均匀、各向同性的流体域在小振幅假设下，使用有限元法（FEM）进行时谐声学建模。一个频率为 $f$ 的单色平面波在 $20^\\circ\\text{C}$ 的空气中传播，流体质量密度为 $\\rho$，声速为 $c$。计算网格使用特征尺寸为 $h$ 的线性单元。外部边界通过一个阻抗边界条件来建模，该条件代表一个具有实数、与频率无关的比声阻抗 $Z_b$ 的局部反应衬垫。分析重点关注无量纲度量 $kh$（声波数 $k$ 与单元尺寸 $h$ 的乘积）和阻抗比 $Z_b/Z$，其中 $Z$ 是流体的平面波声阻抗。\n\n给定以下物理上一致的参数：$f=850\\,\\text{Hz}$，$\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$，$c=343\\,\\text{m}\\,\\text{s}^{-1}$，$h=0.030\\,\\text{m}$，以及 $Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$，请使用基础平面波声学来：\n- 确定波数 $k$ 和无量纲离散化参数 $kh$。\n- 确定流体平面波阻抗 $Z$ 和阻抗比 $Z_b/Z$。\n- 最后，在平面波法向入射到阻抗边界的情况下，基于这些量计算法向入射反射系数的幅值。\n\n将最终的反射系数幅值表示为一个纯数，并将您的答案四舍五入到四位有效数字。最终数值答案中不包含单位。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 频率：$f=850\\,\\text{Hz}$\n- 流体质量密度：$\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$\n- 声速：$c=343\\,\\text{m}\\,\\text{s}^{-1}$\n- 特征单元尺寸：$h=0.030\\,\\text{m}$\n- 边界的比声阻抗：$Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$\n- 该问题涉及单色平面波法向入射到阻抗边界上。\n- 最终要求的量是法向入射反射系数的幅值，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的且客观的。\n- **科学性和事实性：** 该问题基于线性声学的基本原理。所提供的 $20^\\circ\\text{C}$ 时空气的性质值（密度 $\\rho$ 和声速 $c$）是标准的教科书数值。波数、声阻抗和反射系数的概念是波动物理学的核心。单位是一致的：特征阻抗 $Z = \\rho c$ 的单位是 $(\\text{kg}\\,\\text{m}^{-3}) \\times (\\text{m}\\,\\text{s}^{-1}) = \\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。压力的单位帕斯卡是 $\\text{Pa} = \\text{N}\\,\\text{m}^{-2} = (\\text{kg}\\,\\text{m}\\,\\text{s}^{-2})\\,\\text{m}^{-2} = \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-2}$。因此，比阻抗的单位 $\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$ 是 $(\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-2}) \\times \\text{s} \\times \\text{m}^{-1} = \\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$，这与 $Z$ 的量纲一致。\n- **适定性和完整性：** 该问题提供了计算所要求的所有必要数据。所需的公式是标准的，并能得出唯一解。与有限元法（FEM）和参数 $kh$ 相关的背景为计算提供了一个现实的设定，但没有引入模糊性。\n- **客观性：** 问题陈述使用精确的技术语言表达，没有主观或含糊的术语。\n\n### 步骤3：结论和行动\n该问题有效。将提供解答。\n\n解答按要求分三部分进行。\n\n**第1部分：波数 $k$ 和无量纲参数 $kh$**\n\n声波数 $k$ 与角频率 $\\omega$ 和声速 $c$ 相关。角频率为 $\\omega = 2\\pi f$。因此，波数由下式给出：\n$$\nk = \\frac{\\omega}{c} = \\frac{2\\pi f}{c}\n$$\n代入给定值 $f=850\\,\\text{Hz}$ 和 $c=343\\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nk = \\frac{2\\pi(850)}{343} \\approx 15.587\\,\\text{rad}\\,\\text{m}^{-1}\n$$\n无量纲离散化参数 $kh$ 是波数 $k$ 和特征单元尺寸 $h=0.030\\,\\text{m}$ 的乘积：\n$$\nkh = \\left(\\frac{2\\pi f}{c}\\right) h = \\frac{2\\pi(850)(0.030)}{343} \\approx 0.4676\n$$\n这个值表明，在给定频率下，对于线性单元公式，网格分辨率是足够的，因为它遵守了每个波长至少需要10个单元的通用经验法则。\n\n**第2部分：流体阻抗 $Z$ 和阻抗比 $Z_b/Z$**\n\n对于平面波，流体介质的特征比声阻抗 $Z$ 是其密度 $\\rho$ 和声速 $c$ 的乘积：\n$$\nZ = \\rho c\n$$\n代入给定值 $\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$ 和 $c=343\\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nZ = (1.20)\\,(343) = 411.6\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}\n$$\n阻抗比是边界的比声阻抗 $Z_b$ 与流体的特征阻抗 $Z$ 的比值。给定值为 $Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$。\n$$\n\\frac{Z_b}{Z} = \\frac{330}{411.6} \\approx 0.80175\n$$\n\n**第3部分：法向入射反射系数幅值 $|R|$**\n\n对于法向入射到具有法向比声阻抗 $Z_b$ 的表面上的平面波，压力反射系数 $R$ 由下式给出：\n$$\nR = \\frac{Z_b - Z}{Z_b + Z}\n$$\n这可以用阻抗比 $\\frac{Z_b}{Z}$ 来表示：\n$$\nR = \\frac{\\frac{Z_b}{Z} - 1}{\\frac{Z_b}{Z} + 1}\n$$\n代入 $Z_b$ 和 $Z$ 的值：\n$$\nR = \\frac{330 - 411.6}{330 + 411.6} = \\frac{-81.6}{741.6} \\approx -0.110032\n$$\n问题要求的是反射系数的幅值 $|R|$：\n$$\n|R| = \\left| \\frac{-81.6}{741.6} \\right| = \\frac{81.6}{741.6} \\approx 0.110032\n$$\n将此结果四舍五入到四位有效数字，得到 $0.1100$。",
            "answer": "$$\n\\boxed{0.1100}\n$$"
        },
        {
            "introduction": "求解特征值问题以获得系统的固有频率和振型，是有限元方法应用的基石之一。本练习将引导您对一个二维声腔的亥姆霍兹方程进行离散化，构建一个广义特征值问题并进行数值求解 。通过从头开始实现一个有限元求解器，并将计算得到的特征频率与已知的解析解进行验证，您将在从弱形式推导到代码验证的整个有限元工作流程中，获得深刻的实践经验。",
            "id": "4141646",
            "problem": "考虑一个二维矩形声腔，其壁面为刚性，域为 $\\Omega = (0,L_x)\\times(0,L_y)$。假设腔内为均匀无损流体，其质量密度 $\\rho$ 和声速 $c$ 为常数，且扰动很小，因此线性声学适用。从可压缩流体的基本线性化平衡定律和本构关系出发，声压 $p(x,y,t)$ 服从标量波动方程。对于角频率为 $\\omega$ 的时谐场 $p(x,y,t) = \\Re\\{\\phi(x,y)\\,e^{-i\\omega t}\\}$，其空间场 $\\phi(x,y)$ 满足亥姆霍兹方程，并在边界 $\\partial\\Omega$ 上具有刚性壁边界条件。刚性壁意味着法向质点速度为零，这对应于声压的齐次诺伊曼边界条件。在 $\\Omega$ 上建立频域弱问题，并使用有限元法（FEM）对其进行离散化。离散化采用协调分片线性（仿射）形函数，建立在矩形域的三角剖分上，该三角剖分通过将结构化网格的每个矩形单元分割成两个三角形而获得。组装全局对称刚度矩阵和质量矩阵，并求解所得的广义特征值问题，以近似计算腔体的最低非零本征频率。\n\n为进行验证，推导具有刚性壁的矩形腔的解析模态频率。解析波数由满足诺伊曼边界条件的组合给出，并产生依赖于 $(m,n)\\in\\mathbb{N}_0^2$ 的解析本征频率，其中排除了平凡的均匀压力模式。\n\n您的任务是：\n- 根据指定的基本物理定律和边界条件，推导恰当的弱形式。\n- 实现一个协调线性三角形有限元法，在 $\\Omega$ 的结构化三角剖分上组装全局刚度矩阵和质量矩阵，并求解广义对称特征值问题以获得前 $N$ 个非零本征频率。\n- 计算同一腔体对应的前 $N$ 个解析刚性壁模态频率，并通过报告前 $N$ 个非零模态的最大相对误差，将有限元法结果与解析结果进行比较。\n\n使用以下参数集测试套件，其中每个参数集是一个元组 $(L_x,L_y,c,N_x,N_y,N)$:\n- 测试用例 $1$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.2\\,\\text{m},\\,0.8\\,\\text{m},\\,343\\,\\text{m/s},\\,30,\\,20,\\,5\\,)$。\n- 测试用例 $2$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.0\\,\\text{m},\\,1.0\\,\\text{m},\\,343\\,\\text{m/s},\\,10,\\,10,\\,5\\,)$。\n- 测试用例 $3$: $(L_x,L_y,c,N_x,N_y,N) = (\\,2.0\\,\\text{m},\\,0.5\\,\\text{m},\\,343\\,\\text{m/s},\\,40,\\,10,\\,6\\,)$。\n- 测试用例 $4$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.0\\,\\text{m},\\,1.0\\,\\text{m},\\,343\\,\\text{m/s},\\,40,\\,40,\\,6\\,)$。\n\n在每个用例中，$L_x$ 和 $L_y$ 是以米为单位的长度，$c$ 是以米/秒为单位的声速，$(N_x,N_y)$ 指定了用于生成结构化网格的沿 $x$ 和 $y$ 方向的细分数（这将产生 $(N_x+1)\\times(N_y+1)$ 个节点），$N$ 是要比较的非零模态的数量。您必须假设所有边界上都为刚性壁（诺伊曼）边界条件。\n\n物理单位：\n- 所有本征频率以赫兹（Hz）表示。\n- 使用公式 $|f_{\\text{FEM}}-f_{\\text{analytical}}|/f_{\\text{analytical}}$ 计算相对误差，结果为十进制值（无单位）。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个条目对应一个测试用例，并且是该用例前 $N$ 个非零模态的最大相对误差，四舍五入到六位小数（例如，$[0.012345,0.001234,0.000567,0.045678]$）。",
            "solution": "所提出的问题是使用有限元法（FEM）确定具有刚性壁的二维矩形腔的声学本征频率，并根据解析解验证数值结果。该问题具有科学依据，提法完善，并为完整求解提供了所有必要信息。我们着手进行推导和实现。\n\n该物理系统由声压 $p$ 的标量波动方程控制。对于形式为 $p(x,y,t) = \\Re\\{\\phi(x,y)e^{-i\\omega t}\\}$ 的时谐解，域 $\\Omega = (0,L_x)\\times(0,L_y)$ 内的空间压力分布 $\\phi(x,y)$ 满足亥姆霍兹方程：\n$$ \\nabla^2 \\phi + k^2 \\phi = 0 $$\n其中 $k = \\omega/c$ 是波数，$\\omega$ 是角频率，$c$ 是恒定的声速。刚性壁施加了齐次诺伊曼边界条件，因为质点速度的法向分量为零，这转化为压力场的法向梯度为零：\n$$ \\frac{\\partial \\phi}{\\partial n} = \\nabla \\phi \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\partial\\Omega $$\n这构成了关于波数平方 $k^2$ 的一个特征值问题。\n\n为了建立弱问题，我们采用加权残差法。将亥姆霍兹方程乘以一个来自索博列夫空间 $H^1(\\Omega)$ 的任意检验函数 $v$，并在域 $\\Omega$ 上积分，得到：\n$$ \\int_{\\Omega} v(\\nabla^2 \\phi + k^2 \\phi) \\, d\\Omega = 0 $$\n对拉普拉斯项应用格林第一恒等式，我们得到：\n$$ \\int_{\\Omega} (-\\nabla v \\cdot \\nabla \\phi + v k^2 \\phi) \\, d\\Omega + \\oint_{\\partial\\Omega} v \\frac{\\partial \\phi}{\\partial n} \\, dS = 0 $$\n由于齐次诺伊曼边界条件，边界积分 $\\oint_{\\partial\\Omega} v \\frac{\\partial \\phi}{\\partial n} \\, dS$ 为零。在此变分框架内，这是一个自然边界条件。由此产生的弱形式为：求 $\\phi \\in H^1(\\Omega)$ 和 $k^2 \\in \\mathbb{R}$，使得对于所有 $v \\in H^1(\\Omega)$：\n$$ \\int_{\\Omega} \\nabla v \\cdot \\nabla \\phi \\, d\\Omega = k^2 \\int_{\\Omega} v \\phi \\, d\\Omega $$\n\n对于有限元离散化，我们将域 $\\Omega$ 剖分成一个由三角形单元组成的网格。解 $\\phi$ 在有限维子空间 $V_h \\subset H^1(\\Omega)$ 中近似为节点基函数（或形函数）$N_j(x,y)$ 的线性组合：\n$$ \\phi_h(x,y) = \\sum_{j=1}^{N_{nodes}} \\phi_j N_j(x,y) $$\n其中 $\\phi_j$ 是未知系数，表示节点 $j$ 处的压力场值，$N_{nodes}$ 是网格中的总节点数。我们使用协调分片线性基函数，其中 $N_j$ 在节点 $j$ 处等于 $1$，在所有其他节点处等于 $0$。将此近似同时代入解 $\\phi$ 和检验函数 $v$（使用伽辽金法，其中检验函数即为基函数本身，$v = N_i$），我们得到一个线性方程组：\n$$ \\sum_{j=1}^{N_{nodes}} \\left( \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\right) \\phi_j = k^2 \\sum_{j=1}^{N_{nodes}} \\left( \\int_{\\Omega} N_i N_j \\, d\\Omega \\right) \\phi_j \\quad \\text{for } i = 1, \\dots, N_{nodes} $$\n这可以写成广义特征值问题的矩阵形式：\n$$ \\mathbf{K} \\mathbf{\\Phi} = k^2 \\mathbf{M} \\mathbf{\\Phi} $$\n这里，$\\mathbf{\\Phi}$ 是节点未知量向量，$\\lambda = k^2$ 是特征值，$\\mathbf{K}$ 和 $\\mathbf{M}$ 分别是全局刚度矩阵和质量矩阵。它们的元素由下式给出：\n$$ K_{ij} = \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\quad \\text{and} \\quad M_{ij} = \\int_{\\Omega} N_i N_j \\, d\\Omega $$\n这些全局矩阵是通过对每个单元的贡献求和来组装的。对于一个面积为 $A_e$、节点为 $(x_1, y_1), (x_2, y_2), (x_3, y_3)$ 的线性三角形单元 $e$，计算其局部的 $3 \\times 3$ 单元刚度矩阵 $\\mathbf{K}^e$ 和质量矩阵 $\\mathbf{M}^e$。线性形函数的梯度在单元上是常数。单元刚度矩阵的第 $(i,j)$ 个元素是 $K_{ij}^e = (\\nabla N_i \\cdot \\nabla N_j) A_e = (b_i b_j + c_i c_j) A_e$，其中梯度系数为 $b_k = (y_{k+1}-y_{k+2})/(2A_e)$ 和 $c_k = (x_{k+2}-x_{k+1})/(2A_e)$（采用循环索引置换）。线性三角形的单元质量矩阵由标准公式给出：\n$$ \\mathbf{M}^e = \\frac{A_e}{12} \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix} $$\n解出的特征值 $\\lambda_i = k_i^2$ 对应于波数的平方。第一个特征值 $\\lambda_0$ 为零（或数值上接近零），对应于平凡的恒压模式 $(k=0)$。我们感兴趣的是非零本征频率，这些频率由随后的特征值 $\\lambda_i > 0$ 通过关系式 $f_i = \\omega_i/(2\\pi) = c k_i/(2\\pi) = c\\sqrt{\\lambda_i}/(2\\pi)$ 计算得出。\n\n为进行验证，我们推导解析解。在矩形 $\\Omega = (0,L_x)\\times(0,L_y)$ 上的带有齐次诺伊曼边界条件的亥姆霍兹方程是可分离变量的。其本征函数形式为 $\\phi_{mn}(x,y) = \\cos(\\frac{m\\pi x}{L_x})\\cos(\\frac{n\\pi y}{L_y})$，其中 $m$ 和 $n$ 为非负整数模态指数。相应的波数 $k_{mn}$ 必须满足：\n$$ k_{mn}^2 = \\left(\\frac{m\\pi}{L_x}\\right)^2 + \\left(\\frac{n\\pi}{L_y}\\right)^2 $$\n因此，解析本征频率（单位：赫兹）为：\n$$ f_{mn} = \\frac{c k_{mn}}{2\\pi} = \\frac{c}{2} \\sqrt{\\left(\\frac{m}{L_x}\\right)^2 + \\left(\\frac{n}{L_y}\\right)^2} $$\n平凡模态对应于 $(m,n)=(0,0)$，得到 $f_{00}=0$。前 $N$ 个非零模态是通过计算不同 $(m,n)$ 对的 $f_{mn}$ 并将结果按升序排序找到的，同时注意考虑简并模态，即不同的 $(m,n)$ 对产生相同频率的情况。第 $i$ 个有限元法频率 $f_{i, \\text{FEM}}$ 与第 $i$ 个解析频率 $f_{i, \\text{analytical}}$ 之间的比较使用相对误差进行，并报告前 $N$ 个非零模态的最大误差。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef compute_max_error(Lx, Ly, c, Nx, Ny, N):\n    \"\"\"\n    Computes the maximum relative error for acoustic eigenfrequencies in a 2D cavity.\n\n    This function performs the following steps:\n    1. Generates a structured triangular mesh for the rectangular domain.\n    2. Assembles the global stiffness (K) and mass (M) matrices using linear finite elements.\n    3. Solves the generalized eigenvalue problem K*phi = lambda*M*phi for the lowest eigenmodes.\n    4. Calculates the first N non-zero FEM eigenfrequencies.\n    5. Calculates the first N non-zero analytical eigenfrequencies.\n    6. Computes the maximum relative error between the FEM and analytical results.\n    \"\"\"\n    # 1. Mesh Generation\n    num_nodes = (Nx + 1) * (Ny + 1)\n    dx = Lx / Nx\n    dy = Ly / Ny\n    \n    nodes = np.zeros((num_nodes, 2))\n    node_map = np.zeros((Nx + 1, Ny + 1), dtype=int)\n    idx = 0\n    for iy in range(Ny + 1):\n        for ix in range(Nx + 1):\n            nodes[idx, 0] = ix * dx\n            nodes[idx, 1] = iy * dy\n            node_map[ix, iy] = idx\n            idx += 1\n\n    elements = []\n    for iy in range(Ny):\n        for ix in range(Nx):\n            n1 = node_map[ix, iy]      # Bottom-left\n            n2 = node_map[ix + 1, iy]  # Bottom-right\n            n3 = node_map[ix + 1, iy + 1] # Top-right\n            n4 = node_map[ix, iy + 1]   # Top-left\n            # Split rectangle into two triangles along the n1-n3 diagonal\n            elements.append((n1, n2, n3))\n            elements.append((n1, n3, n4))\n\n    # 2. FEM Assembly\n    K = lil_matrix((num_nodes, num_nodes))\n    M = lil_matrix((num_nodes, num_nodes))\n    \n    M_const = np.array([[2, 1, 1], [1, 2, 1], [1, 1, 2]])\n    \n    for el_nodes in elements:\n        p1_idx, p2_idx, p3_idx = el_nodes\n        p1, p2, p3 = nodes[p1_idx], nodes[p2_idx], nodes[p3_idx]\n        \n        # Element area and shape function gradients\n        area = 0.5 * np.abs(p1[0]*(p2[1]-p3[1]) + p2[0]*(p3[1]-p1[1]) + p3[0]*(p1[1]-p2[1]))\n        \n        b = np.array([p2[1]-p3[1], p3[1]-p1[1], p1[1]-p2[1]]) / (2 * area)\n        c_grad = np.array([p3[0]-p2[0], p1[0]-p3[0], p2[0]-p1[0]]) / (2 * area)\n        \n        # Element stiffness matrix\n        Ke = np.zeros((3, 3))\n        for i in range(3):\n            for j in range(3):\n                Ke[i, j] = (b[i] * b[j] + c_grad[i] * c_grad[j]) * area\n        \n        # Element mass matrix\n        Me = (area / 12.0) * M_const\n        \n        # Assembly (add element matrices to global matrices)\n        ix_ = np.ix_(el_nodes, el_nodes)\n        K[ix_] += Ke\n        M[ix_] += Me\n\n    # 3. Eigenvalue Solver\n    # Convert to CSR format for efficient computation\n    K_csr = K.tocsr()\n    M_csr = M.tocsr()\n\n    # Solve the generalized eigenvalue problem. Request N+1 smallest magnitude eigenvalues.\n    # The smallest should be the zero-frequency mode.\n    # Using sigma=-0.1 targets eigenvalues close to zero, which is more robust.\n    try:\n        eigenvalues, _ = eigsh(K_csr, k=N + 1, M=M_csr, sigma=-0.1, which='LM')\n    except Exception:\n        # Fallback to smallest magnitude if sigma method fails\n        eigenvalues, _ = eigsh(K_csr, k=N + 1, M=M_csr, which='SM')\n        \n    # 4. Post-processing FEM results\n    # Eigenvalues from eigsh with sigma are not guaranteed to be sorted.\n    eigenvalues = np.sort(eigenvalues)\n    # The first eigenvalue corresponds to the k=0 mode and should be close to 0. We discard it.\n    fem_lambdas = eigenvalues[1 : N + 1]\n    fem_freqs = (c / (2 * np.pi)) * np.sqrt(np.maximum(0, fem_lambdas))\n\n    # 5. Analytical Frequencies\n    analytical_freqs_list = []\n    # A generous search space for (m,n) pairs to ensure we find the first N modes\n    m_max = int(N * (Lx/Ly if Ly > 0 else 1)) + 5\n    n_max = int(N * (Ly/Lx if Lx > 0 else 1)) + 5\n    for m in range(m_max + 1):\n        for n in range(n_max + 1):\n            if m == 0 and n == 0:\n                continue\n            freq = (c / 2.0) * np.sqrt((m / Lx)**2 + (n / Ly)**2)\n            analytical_freqs_list.append(freq)\n    \n    # Sort frequencies to find the lowest N non-zero modes\n    analytical_freqs_list.sort()\n    analytical_freqs = np.array(analytical_freqs_list[:N])\n\n    # 6. Error Calculation\n    if len(fem_freqs) != N or len(analytical_freqs) != N:\n        raise ValueError(\"Could not find the required number of modes.\")\n        \n    relative_errors = np.abs(fem_freqs - analytical_freqs) / analytical_freqs\n    max_relative_error = np.max(relative_errors)\n    \n    return max_relative_error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (1.2, 0.8, 343, 30, 20, 5),\n        (1.0, 1.0, 343, 10, 10, 5),\n        (2.0, 0.5, 343, 40, 10, 6),\n        (1.0, 1.0, 343, 40, 40, 6),\n    ]\n\n    results = []\n    for params in test_cases:\n        Lx, Ly, c, Nx, Ny, N = params\n        error = compute_max_error(Lx, Ly, c, Nx, Ny, N)\n        results.append(f\"{error:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}