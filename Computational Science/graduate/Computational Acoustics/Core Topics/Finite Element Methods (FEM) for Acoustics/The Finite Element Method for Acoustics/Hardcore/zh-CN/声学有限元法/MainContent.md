## 引言
[声学有限元法](@entry_id:1124981)（Finite Element Method, FEM）是[计算声学](@entry_id:172112)领域中一种功能强大且应用广泛的数值工具，它能够[精确模拟](@entry_id:749142)复杂几何形状和非均匀介质中的声波传播、散射和辐射现象。然而，从物理定律到可靠的数值仿真，需要跨越严谨的数学推导、深刻的[数值分析](@entry_id:142637)以及巧妙的工程应用。本文章旨在为学习者提供一条从理论到实践的完整路径，系统性地解决如何利用FEM解决高级声学问题的挑战。

本文将通过三个核心章节，层层递进地展开对[声学有限元法](@entry_id:1124981)的探讨。首先，在**“原理与机制”**一章中，我们将奠定理论基石，从亥姆霍兹控制方程的推导开始，深入其[变分形式](@entry_id:166033)、[泛函分析](@entry_id:146220)背景，并剖析[数值离散化](@entry_id:752782)过程中的关键问题，如频散与稳定性。接着，在**“应用与跨学科交叉”**一章中，我们将展示该方法的巨大应用潜力，探讨如何模拟复杂的声源、边界条件（如PML）和介质，并将其应用于流固耦合等系统级分析，同时介绍hp自适应和[混合方法](@entry_id:163463)等前沿技术。最后，**“动手实践”**部分将提供一系列精心设计的编程练习，帮助读者将理论知识转化为实际的计算能力，从实现一维求解器到进行二维腔体[模态分析](@entry_id:163921)。通过本章的学习，读者将能够全面掌握[声学有限元法](@entry_id:1124981)的核心思想与应用精髓。

## 原理与机制

本章旨在为[声学有限元法](@entry_id:1124981)（FEM）奠定坚实的理论基础。我们将从描述声波传播的基本物理定律出发，推导出其数学模型——亥姆霍兹方程。随后，我们将探讨如何将此[微分](@entry_id:158422)方程转化为适用于[有限元分析](@entry_id:138109)的变分（或弱）形式。在此过程中，我们将深入研究方法背后严谨的[泛函分析](@entry_id:146220)基础，明确解的适定性和数值离散的合理性。最后，我们将讨论几种关键的数值现象，如数值频散和污染效应，并探讨不同的公式和技术（如高阶元和时域方法）如何影响计算的效率和精度。本章的目的是将物理直觉、数学严谨性和计算实践融为一体。

### 控制方程：从波动方程到[亥姆霍兹方程](@entry_id:149977)

声学现象的研究始于对流体动力学基本定律的线性化。对于一个可压缩、无粘性、无损耗的流体，在[平衡态](@entry_id:270364)附近的小扰动由动量守恒和[质量守恒定律](@entry_id:147377)描述。考虑一个最初静止的均匀介质，其平衡密度为 $\rho_0$，体积模量为 $K$。声压扰动 $p(\mathbf{x},t)$ 和[质点](@entry_id:186768)速度 $\mathbf{v}(\mathbf{x},t)$ 满足以下线性化方程：

1.  **[动量守恒](@entry_id:149964)（线性化的[欧拉方程](@entry_id:177914)）**: $\rho_0 \frac{\partial \mathbf{v}}{\partial t} = - \nabla p$
2.  **质量守恒（[连续性方程](@entry_id:195013)）**: $\frac{\partial p}{\partial t} = -K \nabla \cdot \mathbf{v}$

后者结合了[质量守恒定律](@entry_id:147377) $\frac{\partial \rho'}{\partial t} + \rho_0 \nabla \cdot \mathbf{v} = 0$ 和[状态方程](@entry_id:274378) $p \approx \frac{K}{\rho_0} \rho'$，其中 $\rho'$ 是密度扰动。

为了得到一个只包含声压 $p$ 的单一控制方程，我们可以对[动量方程](@entry_id:197225)求散度，并对质量方程求时间导数，然后联立消去速度 $\mathbf{v}$。这样做会得到经典的**标量[波动方程](@entry_id:139839)**：
$$
\nabla^2 p - \frac{\rho_0}{K} \frac{\partial^2 p}{\partial t^2} = 0
$$
通过与标准波动方程 $\nabla^2 p - \frac{1}{c^2} \frac{\partial^2 p}{\partial t^2} = 0$ 对比，我们立刻可以确定声波在介质中的传播速度 $c$：
$$
c = \sqrt{\frac{K}{\rho_0}}
$$
这个关系式揭示了声速由介质的弹性和惯性特性共同决定。

在许多声学问题中，我们更关心系统在特定频率下的[稳态响应](@entry_id:173787)，而不是瞬态过程。这促使我们采用**时谐分析**。我们假设所有场量都具有 $e^{-i\omega t}$ 的时间依赖性，其中 $\omega$ 是角频率， $i$ 是虚数单位。在这种假设下，时间导数算子可以被代数运算所取代：$\frac{\partial}{\partial t} \rightarrow -i\omega$。将这个代换应用于[波动方程](@entry_id:139839)，我们得到：
$$
\nabla^2 \hat{p} - \frac{\rho_0}{K} (-i\omega)^2 \hat{p} = 0
$$
其中 $\hat{p}(\mathbf{x})$ 是复数声压幅值。整理后得到**[亥姆霍兹方程](@entry_id:149977)**：
$$
\nabla^2 \hat{p} + \left(\frac{\omega^2 \rho_0}{K}\right) \hat{p} = 0
$$
我们定义**[声波数](@entry_id:1120717)** $k$ 为 $k = \omega/c$。利用 $c^2=K/\rho_0$，我们可以看到括号内的项恰好是 $k^2$。因此，均匀介质中的亥姆霍兹方程的[标准形式](@entry_id:153058)为  ：
$$
\nabla^2 \hat{p} + k^2 \hat{p} = 0
$$
波数 $k$ 是一个核心参数，它与波长 $\lambda$ 的关系是 $k = 2\pi/\lambda$，描述了单位长度内波的相位变化。

当介质的性质在空间上变化时，即密度 $\rho_0(\mathbf{x})$ 和体积模量 $K(\mathbf{x})$ 是位置的函数时，推导过程需要更加小心。我们必须从频域中的一阶方程组开始：
1.  [动量守恒](@entry_id:149964): $-i\omega\rho_0(\mathbf{x})\hat{\mathbf{v}} = -\nabla \hat{p} \implies \hat{\mathbf{v}} = \frac{1}{i\omega\rho_0(\mathbf{x})} \nabla \hat{p}$
2.  质量守恒: $-i\omega \hat{p} = -K(\mathbf{x}) \nabla \cdot \hat{\mathbf{v}}$

将第一个方程代入第二个方程，得到：
$$
-i\omega \hat{p} = -K(\mathbf{x}) \nabla \cdot \left( \frac{1}{i\omega\rho_0(\mathbf{x})} \nabla \hat{p} \right)
$$
由于 $\rho_0(\mathbf{x})$ 不再是常数，它不能被移出[散度算子](@entry_id:265975)。整理后，我们得到**[非均匀介质](@entry_id:750241)中的亥姆霍兹方程**：
$$
\nabla \cdot \left( \frac{1}{\rho_0(\mathbf{x})} \nabla \hat{p} \right) + \frac{\omega^2}{K(\mathbf{x})} \hat{p} = 0
$$
这个方程是声学[有限元分析](@entry_id:138109)的出发点，我们称之为问题的**强形式** (strong form)。

### 变分（弱）形式

直接离散强形式的[偏微分](@entry_id:194612)方程（如使用有限差分法）可能会在处理复杂几何和[非均匀介质](@entry_id:750241)时遇到困难。[有限元法](@entry_id:749389)的威力在于它不直接处理强形式，而是处理其等价的**弱形式** (weak form) 或称**[变分形式](@entry_id:166033)** (variational form)。

构建[弱形式](@entry_id:142897)的过程如下：我们将强形式方程乘以一个任意的**检验函数** (test function) $v$，然后在整个求解域 $\Omega$ 上进行积分。对于非均匀[亥姆霍兹方程](@entry_id:149977)，我们有：
$$
\int_{\Omega} v \left[ \nabla \cdot \left( \frac{1}{\rho_0} \nabla p \right) + \frac{\omega^2}{K} p \right] d\Omega = 0
$$
（为了简洁，我们暂时省略了[复数幅值](@entry_id:167344)符号 $\hat{\cdot}$）。

弱形式的关键步骤是使用**[格林第一恒等式](@entry_id:170345)**（即高维度的分部积分）来降低方程中导数的阶数。该恒等式为：
$$
\int_{\Omega} v (\nabla \cdot \mathbf{F}) d\Omega = - \int_{\Omega} \nabla v \cdot \mathbf{F} d\Omega + \oint_{\partial\Omega} v (\mathbf{F} \cdot \mathbf{n}) dS
$$
令 $\mathbf{F} = \frac{1}{\rho_0} \nabla p$，我们可以将包含二阶导数的项转化为包含[一阶导数](@entry_id:749425)的项：
$$
\int_{\Omega} v \left[ \nabla \cdot \left( \frac{1}{\rho_0} \nabla p \right) \right] d\Omega = - \int_{\Omega} \nabla v \cdot \left( \frac{1}{\rho_0} \nabla p \right) d\Omega + \oint_{\partial\Omega} v \left( \frac{1}{\rho_0} \frac{\partial p}{\partial n} \right) dS
$$
其中 $\frac{\partial p}{\partial n} = \nabla p \cdot \mathbf{n}$ 是压力沿边界外[法线](@entry_id:167651) $\mathbf{n}$ 方向的导数。

将此结果代回原积分方程，并重新整理，我们得到[亥姆霍兹方程的弱形式](@entry_id:756664)：寻找声压场 $p$，使其对于所有允许的检验函数 $v$ 均满足：
$$
\int_{\Omega} \left( \frac{1}{\rho_0} \nabla v \cdot \nabla p - \frac{\omega^2}{K} v p \right) d\Omega = \oint_{\partial\Omega} v \left( \frac{1}{\rho_0} \frac{\partial p}{\partial n} \right) dS
$$
这个公式的美妙之处在于，它将求解[二阶微分方程](@entry_id:269365)的问题转化为了一个积分方程问题。注意到最[高阶导数](@entry_id:140882)从二阶降至一阶，这对解的平滑性要求大大降低。同时，边界上的法向导数项 $\frac{\partial p}{\partial n}$ 自然地出现在了边界积分中。

在声学中，常见的边界条件包括：
*   **[声硬边界](@entry_id:1131968)**（刚性壁）：法向[质点](@entry_id:186768)速度为零，$\mathbf{v} \cdot \mathbf{n} = 0$。由动量方程可知，这等价于 $\frac{\partial p}{\partial n} = 0$。这是一种**诺伊曼 (Neumann) 边界条件**。
*   **[声软边界](@entry_id:1131970)**（压力释放）：声压为零，$p=0$。这是一种**狄利克雷 (Dirichlet) 边界条件**。
*   **阻抗边界**：声压与法向质点速度成正比，$p = Z_s (\mathbf{v} \cdot \mathbf{n})$，其中 $Z_s$ 是[比声阻抗](@entry_id:921125)。这转化为关于 $p$ 和其[法向导数](@entry_id:169511)的关系，例如对于均匀介质，$\frac{\partial p}{\partial n} = i\omega\rho_0 \frac{p}{Z_s}$。这是一种**罗宾 (Robin) 边界条件**。

对于诺伊曼和[罗宾边界条件](@entry_id:163914)，我们可以直接将它们代入弱形式的边界积分项中。例如，对于阻抗边界 $\frac{\partial p}{\partial n} = -ik\beta p$（其中 $-ik\beta$ 是一个广义的比例常数），[弱形式](@entry_id:142897)变为 ：
$$
\int_{\Omega} \left( \frac{1}{\rho_0} \nabla \bar{v} \cdot \nabla p - \frac{\omega^2}{K} \bar{v} p \right) d\Omega + \int_{\Gamma_R} ik\beta \frac{1}{\rho_0} \bar{v} p dS = 0
$$
（这里我们明确写出了[复共轭](@entry_id:174690)，因为在[复变函数](@entry_id:175282)空间中，[弱形式](@entry_id:142897)是**[半双线性形式](@entry_id:154766)** (sesquilinear form)）。由于这些边界条件可以通过修改弱形式本身来施加，它们被称为**自然边界条件**。相比之下，狄利克雷边界条件 $p=g$ 必须通过限制解和[检验函数](@entry_id:166589)所在的[函数空间](@entry_id:143478)来强制施加，因此被称为**[本质边界条件](@entry_id:173524)**。

### [泛函分析](@entry_id:146220)基础：[适定性](@entry_id:148590)与[函数空间](@entry_id:143478)

[弱形式](@entry_id:142897)的引入不仅是计算上的技巧，它也为我们提供了使用强大[泛函分析](@entry_id:146220)工具来研究问题[适定性](@entry_id:148590)（解的存在性、唯一性和稳定性）的途径。

弱[形式的积分](@entry_id:158607)要求解 $p$ 和检验函数 $v$ 的[一阶导数](@entry_id:749425)是平方可积的。满足这一条件的函数所构成的空间被称为**[索博列夫空间](@entry_id:141995)** (Sobolev space) $H^1(\Omega)$。其形式化定义为 ：
$$
H^1(\Omega) = \left\{ u \in L^2(\Omega) \, : \, \nabla u \in [L^2(\Omega)]^d \right\}
$$
其中 $L^2(\Omega)$ 是[平方可积函数](@entry_id:200316)空间，$\nabla u$ 是在[弱导数](@entry_id:189356)意义下定义的梯度。$H^1(\Omega)$ 是一个[希尔伯特空间](@entry_id:261193)，其范数为 $\|u\|_{H^1(\Omega)}^2 = \|u\|_{L^2(\Omega)}^2 + \|\nabla u\|_{L^2(\Omega)}^2$。

选择 $H^1(\Omega)$ 作为求解空间，直接决定了[有限元基函数](@entry_id:749279)所需满足的连续性。为了使离散[解空间](@entry_id:200470)成为 $H^1(\Omega)$ 的一个子空间（即**协调 (conforming) 有限元法**），我们选用的分片多项式基函数必须在单元边界上至少是连续的，即具有 $C^0$ **连续性**。如果基函数在单元间不连续，其全局梯度将包含狄拉克 $\delta$ 函数，导致梯度平方不可积。

值得注意的是，我们不需要更高的 $C^1$ 连续性（即梯度也连续）。这不仅没有必要（因为[弱形式](@entry_id:142897)中没有出现二阶导数），而且在物理上是不正确的。在两种不同声学介质的界面处，物理定律要求声压 $p$ 是连续的，但其法向导数通常是不连续的（除非 $\rho_0$ 也恰好连续）。强加 $C^1$ 连续性会违背这一物理现实。[弱形式](@entry_id:142897)通[过积分](@entry_id:753033)的方式自然地处理了这种梯度的[不连续性](@entry_id:144108)。

对于本质（狄利克雷）边界条件，我们要求解 $p$ 在边界 $\partial\Omega$ 的一部分 $\Gamma_D$ 上取指定值 $g$。然而，$H^1(\Omega)$ 中的函数不一定连续，因此它们在边界上的“值”需要严格定义。**[迹定理](@entry_id:203967) (Trace Theorem)** 解决了这个问题。它指出，对于具有足够正则性（例如，利普希茨连续）的边界，存在一个唯一的、有界的[线性算子](@entry_id:149003) $\gamma_0: H^1(\Omega) \to H^{1/2}(\partial\Omega)$，它将一个 $H^1$ 函数映射到其在边界上的“迹”。这里的 $H^{1/2}(\partial\Omega)$ 是一个分数阶[索博列夫空间](@entry_id:141995)，其正则性介于 $L^2(\partial\Omega)$ 和 $H^1(\partial\Omega)$ 之间。因此，为了能够强加[狄利克雷边界条件](@entry_id:173524) $p=g$，边界数据 $g$ 必须属于这个[迹空间](@entry_id:756085)，即 $g \in H^{1/2}(\Gamma_D)$。

### 有限元离散与代数系统

[有限元法](@entry_id:749389)的核心思想是用一个有限维函数空间的函数 $p_h$ 来近似无限维空间 $H^1(\Omega)$ 中的真解 $p$。我们选择一组**基函数**（或**形函数**）$\{N_j(\mathbf{x})\}_{j=1}^N$，使得 $p_h(\mathbf{x}) = \sum_{j=1}^N P_j N_j(\mathbf{x})$。这里的 $P_j$ 是待求的未知系数，通常是声压在网格节点上的值。

**伽辽金法 (Galerkin method)** 是一种系统地将弱形式转化为[代数方程](@entry_id:272665)组的方法。它要求近似解 $p_h$ 的残差与[检验函数](@entry_id:166589)空间中的所有函数正交。在标准的伽辽金法中，[检验函数](@entry_id:166589)空间与基函数空间相同，即我们[选择检验](@entry_id:182706)函数 $v = N_i(\mathbf{x})$，其中 $i = 1, \dots, N$。

将 $p_h$ 的表达式和 $v=N_i$ 代入弱形式（以包含阻抗项的方程为例），我们得到一个 $N \times N$ 的[线性方程组](@entry_id:148943)：
$$
\sum_{j=1}^N P_j \left[ \int_{\Omega} \left( \frac{1}{\rho_0} \nabla N_i \cdot \nabla N_j - \frac{\omega^2}{K} N_i N_j \right) d\Omega + \int_{\Gamma_R} ik\beta \frac{1}{\rho_0} N_i N_j dS \right] = 0 \quad (\text{对于 } i=1, \dots, N)
$$
这个方程组可以写成矩阵形式 $[S]\{P\} = \{F\}$。对于齐次问题，右端项 $\{F\}$ 为零。系统矩阵 $[S]$ 的每一项 $S_{ij}$ 是由单元积分（体积积分）和边界积分（面积积分）贡献的总和。对于均匀介质亥姆霍兹方程，系统矩阵通常分解为**刚度矩阵** $K_{ij} = \int \nabla N_i \cdot \nabla N_j d\Omega$ 和**[质量矩阵](@entry_id:177093)** $M_{ij} = \int N_i N_j d\Omega$，使得 $S = K - k^2 M$。边界条件则会引入额外的矩阵项。

例如，考虑一个施加了[罗宾边界条件](@entry_id:163914)的边界单元。其对系统矩阵的贡献来自于边界积分项。对于一个长度为 $L$ 的直边界边，使用二次[拉格朗日形函数](@entry_id:635448) $N_i(\xi)$（其中 $\xi \in [-1, 1]$ 是参考坐标），其贡献的边界[阻抗矩阵](@entry_id:274892) $[B^e]$ 的项为 ：
$$
B^e_{ij} = ik\beta \int_{\Gamma_e} N_i N_j dS = ik\beta \frac{L}{2} \int_{-1}^{1} N_i(\xi) N_j(\xi) d\xi
$$
通过计算这些积分，我们可以得到一个 $3 \times 3$ 的单元边界矩阵。例如，对角线上的第一个元素（对应于边的第一个节点）的贡献为 $ik\beta \frac{2L}{15}$。这个单元矩阵随后会被**组装**到[全局系统矩阵](@entry_id:1125683)中，即将其元素值加到与相应全局节点对应的位置上。如果一个节点被多个边界单元共享，它在全局矩阵中的对应项就是所有共享单元贡献的总和。

### 亥姆霍兹问题的稳定性与唯一性

一个关键的理论问题是：我们得到的线性系统 $[S]\{P\} = \{F\}$ 是否总是有唯一的、稳定的解？这与[亥姆霍兹算子](@entry_id:202182)本身的性质密切相关，可以通过分析其[弱形式](@entry_id:142897)对应的[半双线性形式](@entry_id:154766) $a(u,v)$ 来研究。

我们定义 $a(u,v) = \int_\Omega (\nabla \bar{v} \cdot \nabla u - k^2 \bar{v} u) d\Omega$。
*   **[埃尔米特性](@entry_id:141899) (Hermitian Property)**: 如果 $a(u,v) = \overline{a(v,u)}$，则称该形式是埃尔米特的。通过计算可以发现，这当且仅当 $k^2$ 是实数时成立。这意味着对于无损耗介质（$k$ 为实数），[亥姆霍兹算子](@entry_id:202182)是自伴的。
*   **[矫顽性](@entry_id:159399) (Coercivity)**: 如果存在常数 $\alpha > 0$ 使得 $\text{Re}\,a(u,u) \ge \alpha \|u\|_{H^1}^2$ 对所有 $u$ 成立，则称该形式是矫顽的。[矫顽性](@entry_id:159399)是保证良态（well-posedness）的一个强有力的条件。对于亥姆霍兹形式，我们有 $\text{Re}\,a(u,u) = \|\nabla u\|_{L^2}^2 - \text{Re}(k^2)\|u\|_{L^2}^2$。
    *   如果 $\text{Re}(k^2)  0$（对应于一个衰减介质），则 $\text{Re}\,a(u,u) \ge \|\nabla u\|_{L^2}^2 + |\text{Re}(k^2)|\|u\|_{L^2}^2$，这显然是矫顽的。
    *   然而，在标准的无损耗声学中，$k^2 > 0$。此时，$\text{Re}\,a(u,u) = \|\nabla u\|_{L^2}^2 - k^2\|u\|_{L^2}^2$。这一项不总是正的。特别地，如果 $k^2$ 接近或超过[拉普拉斯算子](@entry_id:146319)的第一个特征值 $\lambda_1$，那么 $a(u,u)$ 可能会变为负值，从而失去[矫顽性](@entry_id:159399)。只有在低频情况下（即 $k^2  \lambda_1$），[亥姆霍兹算子](@entry_id:202182)才是矫顽的。

对于高频问题，[矫顽性](@entry_id:159399)不成立。但我们仍然可以证明一个较弱的条件——**Gårding 不等式**。它表明存在常数 $\alpha > 0$ 和 $\beta \ge 0$ 使得 ：
$$
\text{Re}\,a(u,u) + \beta \|u\|_{L^2}^2 \ge \alpha \|u\|_{H^1}^2
$$
[亥姆霍兹算子](@entry_id:202182)可以被看作是一个矫顽的[主部](@entry_id:168896)（拉普拉斯项）加上一个[紧算子](@entry_id:139189)（质量项）。这种结构保证了 Gårding 不等式对所有频率都成立。根据**[弗雷德霍姆择一](@entry_id:138045)性理论 (Fredholm Alternative)**，对于满足 Gårding 不等式的算子，其解的存在性和唯一性是等价的：要么对于任意源项，非齐次问题都有唯一解；要么齐次问题（无源项）存在非[平凡解](@entry_id:155162)。

后一种情况正是在物理上被称为**共振**的现象。当激励频率 $\omega$ 与系统的某个固有频率重合时，齐次亥姆霍兹问题会出现非零解，导致非齐次问题无解或有无穷多解。这些固有频率构成一个离散的集合。在实际计算中，这意味着当 $k^2$ 恰好是特征值时，系统矩阵 $[S]$ 会变得奇异。

幸运的是，我们可以通过引入物理耗散来消除这个问题。如果在边界上施加一个具有正实部的阻抗，例如 $\text{Re}(\zeta) > 0$，那么在弱形式的虚部中会产生一个耗散项：$\text{Im}\,a(u,u) = -\omega \int_{\Gamma_R} \text{Re}(\zeta) |u|^2 dS$。对于齐次问题的任何解，必须有 $a(u,u)=0$，因此其虚部也为零。由于 $\omega>0$ 和 $\text{Re}(\zeta)>0$，这要求 $u$ 在整个阻抗边界上为零。根据[唯一延拓](@entry_id:168709)原理，满足亥姆霍兹方程且在边界的一部分上为零的解必须在整个域内恒为零。因此，引入吸收性边界条件可以保证解在所有频率下的唯一性，从而消除了[内部共振](@entry_id:750743)问题。

### 数值精度：频散与污染

有限元解毕竟是近似解，其精度受多种因素影响。对于波动问题，最关键的误差来源之一是**数值频散**。这意味着数值解中的波速依赖于频率和网格尺寸，导致不同频率的波以错误的速度传播，从而产生相位误差。

为了准确地解析一个波长为 $\lambda$ 的波，网格尺寸 $h$ 必须足够小。一个经验法则是，每个波长内需要有足够数量的单元。这个要求可以被形式化为一个无量纲的解析度约束 ：
$$
kh \le \alpha
$$
其中 $\alpha$ 是一个决定精度的常数，通常取值在 $0.5$到 $1$ 之间，对应于每个波长大约6到12个单元。例如，在[水下声学](@entry_id:1129046)中（$c \approx 1500$ m/s），要解析一个 $1000$ Hz 的信号，其波数 $k = 2\pi f/c \approx 4.189$ rad/m。如果要求 $\alpha=0.5$，则最大允许的网格尺寸为 $h_{\max} = \alpha/k \approx 0.119$ m。

然而，一个更微妙且严重的问题是所谓的**污染效应** (pollution effect)。研究表明，即使我们保持每个波长的单元数不变（即保持 $kh$ 为常数），随着频率 $k$ 的增加，[全局解](@entry_id:180992)的相对误差并不会保持不变，反而会增长。

对于使用线性基函数（$p=1$）的 FEM，通[过离散](@entry_id:263748)频散分析可以得到，数值波数 $\tilde{k}$ 与真波数 $k$ 的关系为：
$$
\tilde{k} \approx k \left(1 - C_1 (kh)^2\right)
$$
其中 $C_1$ 是一个正的常数（对于[一致质量矩阵](@entry_id:174630)，$C_1 = 1/24$）。这表明数值波速比物理[波速](@entry_id:186208)慢。在传播了距离 $L$ 之后，累积的相位误差为 $(k-\tilde{k})L \approx C_1 k(kh)^2 L$。如果我们保持 $kh$ 为常数 $C$，那么误差就变为 $(C_1 C^2) kL$。这个误差与 $kL$（即传播距离内的波长数）成正比。这意味着，对于一个电大尺寸问题（$kL \gg 1$），即使局部解析度足够，[全局误差](@entry_id:147874)也会因为污染效应而变得不可接受。

减轻污染效应的有效途径是使用**高阶[有限元法](@entry_id:749389)** ($p$-FEM)。对于 $p$ 阶多项式，数值频散误差的关系变为：
$$
\frac{\tilde{k} - k}{k} \sim (kh)^{2p}
$$
累积相位误差则与 $k(kh)^{2p}L$ 成正比。当 $kh$ 保持不变时，通过增加多项式阶数 $p$，可以指数级地减小误差的比例系数，从而极大地抑制污染效应。当使用**[谱元法](@entry_id:755171)**（一种基于[高斯积分](@entry_id:187139)点的高阶 $p$-FEM）时，对于解析解，误差随 $p$ 的增加呈指数衰减，这使其成为求解高频波动问题的极其强大的工具。

### 可选公式与扩展

除了标准的基于声压 $p$ 的频域有限元法，还存在其他重要的变体和扩展。

#### 速度势公式
声学问题的另一个常见变量是**速度势** $\phi$，其梯度定义了[质点](@entry_id:186768)速度 $\mathbf{v} = \nabla\phi$。在时谐域中，声压和速度势通过动量方程相关联：$p = -i\omega\rho_0\phi$（对于均匀介质）。将 $\mathbf{v} = \nabla\phi$ 代入[连续性方程](@entry_id:195013)，可以得到关于 $\phi$ 的[亥姆霍兹方程](@entry_id:149977)：$\nabla^2\phi + k^2\phi = 0$。

比较基于 $p$ 和基于 $\phi$ 的公式至关重要。
*   在**均匀介质**中，两者是完[全等](@entry_id:273198)价的，因为 $p$ 和 $\phi$ 仅相差一个复常数。它们有相同的控制方程和边界条件类型（例如，[声硬边界](@entry_id:1131968)对两者都是[诺伊曼条件](@entry_id:165471)）。
*   在**[非均匀介质](@entry_id:750241)**中，情况则大不相同。在材料界面处，物理上要求 $p$ 连续，但如果密度 $\rho_0$ 不连续，则由 $[p]=0$ 和 $[\rho_0\phi]=0$ 可知，$\phi$ 必须是**不连续**的。这对标准的 $C^0$ [协调有限元](@entry_id:170866)法提出了挑战，因为后者会错误地强加 $\phi$ 的连续性。因此，在处理多材料问题时，基于压力的公式通常更直接、更受欢迎。
*   在**[流固耦合](@entry_id:1125339)**问题中，流体施加在结构上的力是法向压力 $-p\mathbf{n}$。因此，使用 $p$ 作为未知量可以使耦合更加直接。而使用 $\phi$ 则需要先通过关系式 $p = -i\omega\rho_0\phi$ 计算出压力，然后才能施加载荷。

#### 时域声学
除了[频域分析](@entry_id:1125318)，直接在时域求解波动方程也同样重要，特别是对于宽带瞬态信号。对[波动方程](@entry_id:139839) $\frac{1}{c^2}\ddot{p} - \nabla^2 p = 0$ 进[行空间](@entry_id:148831)上的有限元离散，会得到一个[常微分方程组](@entry_id:907499)：
$$
M\ddot{\mathbf{p}} + K\mathbf{p} = \mathbf{0}
$$
其中 $\mathbf{p}(t)$ 是节点声压随时间变化的向量，$M$ 和 $K$ 分别是全局质量和刚度矩阵。这个方程组可以使用各种[时间积分算法](@entry_id:756002)（如[中心差分法](@entry_id:163679)、Newmark 法）来求解。

在这里，质量矩阵 $M$ 的形式对计算效率和精度有显著影响。
*   **[一致质量矩阵](@entry_id:174630) (Consistent Mass)**: 通过对基函数乘积进行精确积分得到，是带状（非对角）矩阵。它能提供更高的空间精度（即更小的数值频散）。
*   **[集总质量矩阵](@entry_id:173011) (Lumped Mass)**: 通过将[一致质量矩阵](@entry_id:174630)的行元素求和并置于对角线来近似得到，是对角矩阵。

这两种选择导致了重要的权衡。使用**[显式时间积分](@entry_id:165797)**（如[中心差分法](@entry_id:163679)）时，每一步都需要求解形如 $M\mathbf{a} = \mathbf{f}$ 的方程来获得加速度。如果 $M$ 是对角的（集总质量），这个求解过程是平凡的，计算成本极低。如果 $M$ 是非对角的（一致质量），则需要求解一个线性系统，成本高昂得多。因此，显式方法几乎总是与集总质量搭配使用。

然而，这种计算上的便利是有代价的。分析表明，集总质量方案的数值频散误差比一致质量方案更大。此外，它还影响了显式积分的稳定性。稳定性要求时间步长 $\Delta t$ 必须小于某个临界值，该值与系统的最高本征频率成反比。这个稳定性极限被称为**Courant-Friedrichs-Lewy (CFL) 条件**。对于一维线性元，使用集总质量时的稳定性极限为 $\Delta t \le h/c$，而使用一致质量时的极限更为严格，为 $\Delta t \le h/(c\sqrt{3})$。因此，集总质量允许更大的时间步长，但牺牲了空间精度。这种效率与精度之间的权衡是时域[计算声学](@entry_id:172112)中的一个核心主题。