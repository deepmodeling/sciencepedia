{
    "hands_on_practices": [
        {
            "introduction": "Coordinate systems used to model physical phenomena, such as cylindrical coordinates for axisymmetric problems, often contain singularities. While the strong form of the governing PDE may appear ill-behaved at these points, the integral-based weak form used in FEM, combined with an isoparametric mapping, provides an elegant solution. This practice  demonstrates this principle by guiding you through the calculation of a stiffness matrix component for an element at the axis of symmetry, revealing how the transformation correctly handles the singularity.",
            "id": "4127659",
            "problem": "Consider an axisymmetric, time-harmonic acoustic field with pressure $p(r)$ that depends only on the cylindrical radial coordinate $r$ near the axis $r=0$. The governing linear acoustics equation in the absence of mean flow is the Helmholtz equation, and in cylindrical coordinates for axisymmetric fields ($\\partial/\\partial\\theta=0$, $\\partial/\\partial z=0$), the strong form reduces to\n$$\n\\frac{1}{r}\\frac{d}{dr}\\!\\left(r\\frac{dp}{dr}\\right) + k^{2} p = 0,\n$$\nwhere $k$ is the acoustic wavenumber. The standard weak form underpinning the Finite Element Method (FEM) is\n$$\n\\int_{\\Omega} \\left(\\nabla p \\cdot \\nabla q - k^{2} p\\,q\\right)\\,d\\Omega = 0,\n$$\nand for axisymmetry over a radial interval $\\Omega = [0,h]$ with no $z$-dependence and full azimuthal extent, the measure is $d\\Omega = 2\\pi\\,r\\,dr$.\n\nNear $r=0$, the coordinate singularity in the strong form is handled by the weak form, which naturally incorporates the weight $r$ in the measure. Consider the first radial finite element adjacent to the axis, spanning $r\\in[0,h]$, discretized with a one-dimensional, two-node linear isoparametric mapping from the reference coordinate $\\xi\\in[-1,1]$:\n$$\nr(\\xi) = \\frac{h}{2}(\\xi+1), \\qquad J(\\xi) = \\frac{dr}{d\\xi} = \\frac{h}{2}.\n$$\nUse the standard linear shape functions on the reference element,\n$$\nN_{1}(\\xi) = \\frac{1-\\xi}{2}, \\qquad N_{2}(\\xi) = \\frac{1+\\xi}{2},\n$$\nand approximate $p(r)\\approx N_{1}(\\xi)\\,p_{1} + N_{2}(\\xi)\\,p_{2}$ with test function $q(r)$ drawn from the same space.\n\nFocusing only on the gradient (stiffness) part of the weak form and restricting the domain to the single element $\\Omega_e=[0,h]$, derive from first principles and compute exactly the $(1,1)$ entry of the element stiffness matrix,\n$$\nK_{11} \\equiv \\int_{\\Omega_e} \\left(\\frac{dp}{dr}\\right)\\left(\\frac{dq}{dr}\\right)\\,2\\pi\\,r\\,dr \\quad \\text{with}\\quad p\\to N_{1}(\\xi),\\; q\\to N_{1}(\\xi),\n$$\ntaking into account the isoparametric mapping and the coordinate singularity at $r=0$ via the weak form. Express your final answer as a single real number. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All necessary data and definitions for the calculation are provided, and there are no contradictions or ambiguities. The problem represents a standard application of the Finite Element Method (FEM) to the axisymmetric Helmholtz equation, a fundamental topic in computational acoustics. Therefore, the problem is valid and a solution will be provided.\n\nThe objective is to compute the $(1,1)$ entry of the element stiffness matrix, $K_{11}$, for a two-node linear element adjacent to the axis of symmetry, $r=0$. The domain of this element is $\\Omega_e = [0,h]$. The definition for this matrix entry is given by the stiffness part of the weak form, restricted to the shape function $N_1$:\n$$\nK_{11} \\equiv \\int_{\\Omega_e} \\left(\\frac{dp}{dr}\\right)\\left(\\frac{dq}{dr}\\right)\\,2\\pi\\,r\\,dr \\quad \\text{with}\\quad p\\to N_{1}(\\xi),\\; q\\to N_{1}(\\xi).\n$$\nSubstituting the shape function $N_1$ for both the unknown field $p$ and the test function $q$, we have:\n$$\nK_{11} = \\int_{0}^{h} \\left(\\frac{dN_{1}}{dr}\\right)^{2} 2\\pi r dr.\n$$\nThis integral is in the physical coordinate space $r \\in [0, h]$. To evaluate it, we must transform it to the reference coordinate space $\\xi \\in [-1, 1]$ using the provided isoparametric mapping.\n\nThe given mapping is:\n$$\nr(\\xi) = \\frac{h}{2}(\\xi+1).\n$$\nThe transformation of the differential element $dr$ is given by the Jacobian of the mapping, $J(\\xi)$:\n$$\ndr = \\frac{dr}{d\\xi} d\\xi = J(\\xi) d\\xi.\n$$\nThe Jacobian is given as:\n$$\nJ(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{h}{2}(\\xi+1)\\right) = \\frac{h}{2}.\n$$\nNext, we must transform the derivative with respect to $r$ into a derivative with respect to $\\xi$. Using the chain rule for derivatives:\n$$\n\\frac{dN_1}{d\\xi} = \\frac{dN_1}{dr} \\frac{dr}{d\\xi} = \\frac{dN_1}{dr} J(\\xi).\n$$\nRearranging to find the derivative with respect to $r$ gives:\n$$\n\\frac{dN_1}{dr} = \\frac{1}{J(\\xi)} \\frac{dN_1}{d\\xi}.\n$$\nThe given linear shape function is:\n$$\nN_{1}(\\xi) = \\frac{1-\\xi}{2}.\n$$\nIts derivative with respect to $\\xi$ is a constant:\n$$\n\\frac{dN_1}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1-\\xi}{2}\\right) = -\\frac{1}{2}.\n$$\nNow we substitute all these transformed components into the integral for $K_{11}$. The integration limits change from $r \\in [0,h]$ to $\\xi \\in [-1,1]$.\n$$\nK_{11} = \\int_{-1}^{1} \\left(\\frac{1}{J(\\xi)} \\frac{dN_1}{d\\xi}\\right)^2 2\\pi r(\\xi) J(\\xi) d\\xi.\n$$\nSimplifying the expression within the integral:\n$$\nK_{11} = \\int_{-1}^{1} \\frac{1}{(J(\\xi))^2} \\left(\\frac{dN_1}{d\\xi}\\right)^2 2\\pi r(\\xi) J(\\xi) d\\xi = 2\\pi \\int_{-1}^{1} \\frac{1}{J(\\xi)} \\left(\\frac{dN_1}{d\\xi}\\right)^2 r(\\xi) d\\xi.\n$$\nNow, substitute the specific expressions for $J(\\xi)$, $\\frac{dN_1}{d\\xi}$, and $r(\\xi)$:\n$$\nJ(\\xi) = \\frac{h}{2} \\implies \\frac{1}{J(\\xi)} = \\frac{2}{h}\n$$\n$$\n\\frac{dN_1}{d\\xi} = -\\frac{1}{2} \\implies \\left(\\frac{dN_1}{d\\xi}\\right)^2 = \\left(-\\frac{1}{2}\\right)^2 = \\frac{1}{4}\n$$\n$$\nr(\\xi) = \\frac{h}{2}(\\xi+1)\n$$\nSubstituting these into the integral:\n$$\nK_{11} = 2\\pi \\int_{-1}^{1} \\left(\\frac{2}{h}\\right) \\left(\\frac{1}{4}\\right) \\left(\\frac{h}{2}(\\xi+1)\\right) d\\xi.\n$$\nThe integrand contains several constants, which can be factored out of the integral. Notice that the parameter $h$ cancels out:\n$$\nK_{11} = 2\\pi \\left(\\frac{2}{h}\\right) \\left(\\frac{1}{4}\\right) \\left(\\frac{h}{2}\\right) \\int_{-1}^{1} (\\xi+1) d\\xi.\n$$\nThe product of the constants is:\n$$\n2\\pi \\cdot \\frac{2 \\cdot 1 \\cdot h}{h \\cdot 4 \\cdot 2} = 2\\pi \\cdot \\frac{2h}{8h} = 2\\pi \\cdot \\frac{1}{4} = \\frac{\\pi}{2}.\n$$\nSo, the integral simplifies to:\n$$\nK_{11} = \\frac{\\pi}{2} \\int_{-1}^{1} (\\xi+1) d\\xi.\n$$\nNow, we evaluate the definite integral:\n$$\n\\int_{-1}^{1} (\\xi+1) d\\xi = \\left[ \\frac{\\xi^2}{2} + \\xi \\right]_{-1}^{1}.\n$$\nEvaluating at the limits:\n$$\n\\left( \\frac{(1)^2}{2} + (1) \\right) - \\left( \\frac{(-1)^2}{2} + (-1) \\right) = \\left( \\frac{1}{2} + 1 \\right) - \\left( \\frac{1}{2} - 1 \\right) = \\frac{3}{2} - \\left(-\\frac{1}{2}\\right) = \\frac{3}{2} + \\frac{1}{2} = \\frac{4}{2} = 2.\n$$\nFinally, we compute $K_{11}$:\n$$\nK_{11} = \\frac{\\pi}{2} \\cdot 2 = \\pi.\n$$\nThe value of the $(1,1)$ entry of the element stiffness matrix is $\\pi$. The weak form naturally handles the coordinate singularity at $r=0$ by incorporating the weighting factor $r$ in the integral measure $2\\pi r dr$, which becomes $2\\pi r(\\xi) J(\\xi) d\\xi$ in the reference coordinate system. Since $r(\\xi)$ approaches $0$ as $\\xi$ approaches $-1$, the integrand remains well-behaved across the entire element, including at the node corresponding to $r=0$.",
            "answer": "$$\n\\boxed{\\pi}\n$$"
        },
        {
            "introduction": "The accuracy of a finite element simulation is profoundly influenced by the quality of the mesh, specifically the geometric distortion of its elements. The Jacobian and the metric tensor provide the mathematical framework to quantify this distortion. This exercise  invites you to analyze a family of skewed elements, connecting a clear geometric property—the skew angle—to crucial quality indicators like the anisotropy ratio and the spectral condition number of the metric tensor.",
            "id": "4127665",
            "problem": "Consider a two-dimensional linear acoustic medium with constant density $\\rho$ (in $\\mathrm{kg/m^3}$) and constant bulk modulus $B$ (in $\\mathrm{Pa}$). The time-domain acoustic pressure $p(x,y,t)$ satisfies the acoustic wave equation\n$$\n\\frac{1}{B}\\,\\frac{\\partial^2 p}{\\partial t^2} - \\nabla \\cdot \\left( \\frac{1}{\\rho}\\,\\nabla p \\right) = 0,\n$$\nwhere $\\nabla$ denotes the spatial gradient operator with respect to the physical coordinates $(x,y)$. For time-harmonic fields of angular frequency $\\omega$ (in $\\mathrm{rad/s}$), the pressure can be written as $p(x,y,t) = \\Re\\{ \\hat{p}(x,y)\\,e^{\\mathrm{i}\\,\\omega t} \\}$, with complex amplitude $\\hat{p}(x,y)$, leading to the Helmholtz form\n$$\n-\\nabla \\cdot \\left( \\frac{1}{\\rho}\\,\\nabla \\hat{p} \\right) - \\frac{\\omega^2}{B}\\,\\hat{p} = 0.\n$$\n\nIn computational acoustics, the Finite Element Method (FEM) employs an isoparametric mapping from a reference element $\\Omega_{\\xi} = \\{(\\xi,\\eta)\\,|\\,\\xi \\in [-1,1],\\,\\eta \\in [-1,1]\\}$ to a physical element $\\Omega_{x} \\subset \\mathbb{R}^2$. For a four-node bilinear quadrilateral (Q4) element, the mapping is defined by\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i,\n$$\nwhere the shape functions are\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\nand the nodal coordinates $\\mathbf{x}_i = (x_i,y_i)$ define the physical element. The Jacobian matrix of the mapping is\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix},\n$$\nand the metric tensor is defined as\n$$\n\\mathbf{G}(\\xi,\\eta) = \\mathbf{J}(\\xi,\\eta)^{\\top}\\,\\mathbf{J}(\\xi,\\eta),\n$$\nwith inverse $\\mathbf{G}^{-1}(\\xi,\\eta)$. Under this mapping, the spatial gradient transforms as\n$$\n\\nabla_{x,y} = \\mathbf{J}^{-\\top}\\,\\nabla_{\\xi,\\eta},\n$$\nand the weak form of the Helmholtz operator reflects coupling through $\\mathbf{G}^{-1}$. Skew mappings (non-orthogonal $\\mathbf{J}$) induce off-diagonal entries in $\\mathbf{G}^{-1}$, which couple $\\xi$ and $\\eta$ directions. A useful quantitative measure of this coupling is the anisotropy ratio\n$$\n\\mathcal{A} = \\frac{\\left|g^{\\xi\\eta}\\right|}{\\sqrt{g^{\\xi\\xi}\\,g^{\\eta\\eta}}},\n$$\nwhere $g^{\\alpha\\beta}$ are the entries of $\\mathbf{G}^{-1}$; $\\mathcal{A} = 0$ indicates orthogonality, and larger values indicate stronger skew-induced coupling. Another important geometric indicator is the spectral condition number of $\\mathbf{G}$ in the $2$-norm,\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{\\lambda_{\\max}(\\mathbf{G})}{\\lambda_{\\min}(\\mathbf{G})},\n$$\nwhere $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues, respectively. This condition number reflects combined effects of aspect ratio and skew on the mapping.\n\nYou will implement and analyze a family of affine isoparametric mappings that map the reference square to a skewed parallelogram in physical space. The parallelogram is defined by two edge vectors\n$$\n\\mathbf{v}_1 = (L,\\,0),\\quad \\mathbf{v}_2 = (H\\,\\tan \\gamma,\\,H),\n$$\nwith base length $L$ (in $\\mathrm{m}$), height $H$ (in $\\mathrm{m}$), and skew angle $\\gamma$ (in degrees). The nodal coordinates of the physical Q4 element are\n$$\n\\mathbf{x}_1 = (0,\\,0),\\quad\n\\mathbf{x}_2 = (L,\\,0),\\quad\n\\mathbf{x}_3 = (L + H\\,\\tan \\gamma,\\,H),\\quad\n\\mathbf{x}_4 = (H\\,\\tan \\gamma,\\,H).\n$$\nFor this parallelogram, the mapping is affine and the Jacobian $\\mathbf{J}$ and metric $\\mathbf{G}$ are constant over $\\Omega_{\\xi}$.\n\nTask:\n1. For each test case, construct the nodal coordinates $\\mathbf{x}_i$ from $(L,H,\\gamma)$, compute the constant Jacobian $\\mathbf{J}$ using the isoparametric derivatives at the element center $(\\xi,\\eta) = (0,0)$, evaluate $\\mathbf{G} = \\mathbf{J}^{\\top}\\mathbf{J}$, and compute its inverse $\\mathbf{G}^{-1}$.\n2. From $\\mathbf{G}^{-1}$, compute the anisotropy ratio $\\mathcal{A} = \\left|g^{\\xi\\eta}\\right|/\\sqrt{g^{\\xi\\xi} g^{\\eta\\eta}}$.\n3. From $\\mathbf{G}$, compute the spectral condition number $\\kappa_2(\\mathbf{G})$ as the ratio of its largest to smallest eigenvalues.\n4. Report, for each test case, the pair $[\\mathcal{A},\\,\\kappa_2(\\mathbf{G})]$ as dimensionless floats.\n\nAngle unit requirement:\n- All angles $\\gamma$ are specified in degrees. Use degrees for $\\gamma$ when computing $\\tan \\gamma$.\n\nPhysical unit requirement:\n- Use $L$ and $H$ in meters ($\\mathrm{m}$). The reported quantities $\\mathcal{A}$ and $\\kappa_2(\\mathbf{G})$ are dimensionless and should be reported as plain decimal floats.\n\nTest suite:\n- Use $(L,H) = (1.0,\\,1.0)$ in $\\mathrm{m}$ for all cases, and the following skew angles $\\gamma$ in degrees:\n  - Case $1$: $\\gamma = -30$.\n  - Case $2$: $\\gamma = 0$.\n  - Case $3$: $\\gamma = 30$.\n  - Case $4$: $\\gamma = 60$.\n  - Case $5$: $\\gamma = 85$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a two-element list $[\\mathcal{A},\\,\\kappa_2(\\mathbf{G})]$ corresponding to one test case, in the order listed above. For example, the format must be like $[[a_1,k_1],[a_2,k_2],\\dots]$ with no additional text.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the Finite Element Method (FEM), well-posed, and provides a complete and consistent set of givens. The task is to compute two geometric quality measures of an isoparametric mapping for a family of skewed parallelogram elements. We will proceed with a step-by-step derivation of the required quantities.\n\nThe physical coordinates $\\mathbf{x} = (x, y)$ are related to the reference coordinates $(\\xi, \\eta)$ by the isoparametric mapping $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$. The nodal coordinates $\\mathbf{x}_i$ for the parallelogram are given as:\n$\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (L, 0)$, $\\mathbf{x}_3 = (L + H \\tan \\gamma, H)$, and $\\mathbf{x}_4 = (H \\tan \\gamma, H)$.\n\n**1. Jacobian Matrix Derivation**\n\nThe Jacobian matrix $\\mathbf{J}$ has components $J_{kl} = \\partial x_k / \\partial \\xi_l$. For a $2$D mapping, this is:\n$$\n\\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}\n$$\nThe derivatives are computed as $\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i$, and so on for the other components. The problem states that for this affine mapping, $\\mathbf{J}$ is constant and can be evaluated at the element center $(\\xi, \\eta) = (0, 0)$. At this point, the derivatives of the shape functions are:\n$\\partial N_1/\\partial \\xi = -1/4$, $\\partial N_2/\\partial \\xi = 1/4$, $\\partial N_3/\\partial \\xi = 1/4$, $\\partial N_4/\\partial \\xi = -1/4$.\n$\\partial N_1/\\partial \\eta = -1/4$, $\\partial N_2/\\partial \\eta = -1/4$, $\\partial N_3/\\partial \\eta = 1/4$, $\\partial N_4/\\partial \\eta = 1/4$.\n\nUsing these, the components of the Jacobian are:\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}(-x_1 + x_2 + x_3 - x_4) = \\frac{1}{4}(-0 + L + (L + H \\tan\\gamma) - H \\tan\\gamma) = \\frac{2L}{4} = \\frac{L}{2}$\n$J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}(-x_1 - x_2 + x_3 + x_4) = \\frac{1}{4}(-0 - L + (L + H \\tan\\gamma) + H \\tan\\gamma) = \\frac{2H \\tan\\gamma}{4} = \\frac{H \\tan\\gamma}{2}$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}(-y_1 + y_2 + y_3 - y_4) = \\frac{1}{4}(-0 + 0 + H - H) = 0$\n$J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}(-y_1 - y_2 + y_3 + y_4) = \\frac{1}{4}(-0 - 0 + H + H) = \\frac{2H}{4} = \\frac{H}{2}$\n\nThe constant Jacobian matrix is:\n$$\n\\mathbf{J} = \\begin{bmatrix} L/2 & (H \\tan \\gamma)/2 \\\\ 0 & H/2 \\end{bmatrix}\n$$\n\n**2. Metric Tensor and its Inverse**\n\nThe metric tensor is $\\mathbf{G} = \\mathbf{J}^{\\top}\\mathbf{J}$.\n$$\n\\mathbf{G} = \\begin{bmatrix} L/2 & 0 \\\\ (H \\tan \\gamma)/2 & H/2 \\end{bmatrix} \\begin{bmatrix} L/2 & (H \\tan \\gamma)/2 \\\\ 0 & H/2 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} L^2 & LH \\tan \\gamma \\\\ LH \\tan \\gamma & H^2 \\tan^2 \\gamma + H^2 \\end{bmatrix}\n$$\nUsing the identity $1+\\tan^2\\gamma = \\sec^2\\gamma$, we have:\n$$\n\\mathbf{G} = \\frac{1}{4} \\begin{bmatrix} L^2 & LH \\tan \\gamma \\\\ LH \\tan \\gamma & H^2 \\sec^2 \\gamma \\end{bmatrix}\n$$\nThe inverse metric tensor $\\mathbf{G}^{-1}$ can be found from $\\mathbf{G}^{-1} = (\\mathbf{J}^{-1})(\\mathbf{J}^{-1})^{\\top}$. First, we find $\\mathbf{J}^{-1}$:\n$\\det(\\mathbf{J}) = (L/2)(H/2) = LH/4$.\n$$\n\\mathbf{J}^{-1} = \\frac{1}{LH/4} \\begin{bmatrix} H/2 & -(H \\tan \\gamma)/2 \\\\ 0 & L/2 \\end{bmatrix} = \\begin{bmatrix} 2/L & -2 \\tan \\gamma/L \\\\ 0 & 2/H \\end{bmatrix}\n$$\nThen, $\\mathbf{G}^{-1}$ is:\n$$\n\\mathbf{G}^{-1} = \\begin{bmatrix} 2/L & -2 \\tan \\gamma/L \\\\ 0 & 2/H \\end{bmatrix} \\begin{bmatrix} 2/L & 0 \\\\ -2 \\tan \\gamma/L & 2/H \\end{bmatrix} = \\begin{bmatrix} \\frac{4}{L^2}(1+\\tan^2\\gamma) & -\\frac{4 \\tan \\gamma}{LH} \\\\ -\\frac{4 \\tan \\gamma}{LH} & \\frac{4}{H^2} \\end{bmatrix}\n$$\nThis gives the components of $\\mathbf{G}^{-1}$, denoted by $g^{\\alpha\\beta}$:\n$g^{\\xi\\xi} = \\frac{4}{L^2\\cos^2\\gamma}$, $g^{\\xi\\eta} = -\\frac{4\\tan\\gamma}{LH}$, $g^{\\eta\\eta} = \\frac{4}{H^2}$.\n\n**3. Anisotropy Ratio $\\mathcal{A}$**\n\nThe anisotropy ratio is defined as $\\mathcal{A} = \\frac{|g^{\\xi\\eta}|}{\\sqrt{g^{\\xi\\xi} g^{\\eta\\eta}}}$. Substituting the components:\n$$\n\\mathcal{A} = \\frac{\\left|-\\frac{4\\tan\\gamma}{LH}\\right|}{\\sqrt{\\frac{4}{L^2\\cos^2\\gamma} \\cdot \\frac{4}{H^2}}} = \\frac{\\frac{4|\\tan\\gamma|}{LH}}{\\frac{4}{LH|\\cos\\gamma|}} = |\\tan\\gamma||\\cos\\gamma| = \\left|\\frac{\\sin\\gamma}{\\cos\\gamma}\\right||\\cos\\gamma| = |\\sin\\gamma|\n$$\nThis remarkably simple result shows that the anisotropy ratio is the absolute value of the sine of the skew angle.\n\n**4. Spectral Condition Number $\\kappa_2(\\mathbf{G})$**\n\nThe spectral condition number is $\\kappa_2(\\mathbf{G}) = \\lambda_{\\max}(\\mathbf{G})/\\lambda_{\\min}(\\mathbf{G})$. The eigenvalues $\\lambda$ of $\\mathbf{G}$ are the roots of the characteristic equation $\\det(\\mathbf{G} - \\lambda\\mathbf{I}) = 0$. For the test cases, $L=1$ and $H=1$, so the metric tensor simplifies to:\n$$\n\\mathbf{G} = \\frac{1}{4} \\begin{bmatrix} 1 & \\tan\\gamma \\\\ \\tan\\gamma & \\sec^2\\gamma \\end{bmatrix}\n$$\nLet $t = \\tan\\gamma$ and find eigenvalues of $4\\mathbf{G}$. The characteristic equation is $\\det(4\\mathbf{G} - \\lambda'\\mathbf{I})=0$:\n$$\n(1-\\lambda')(1+t^2-\\lambda') - t^2 = 0 \\implies \\lambda'^2 - (2+t^2)\\lambda' + 1 = 0\n$$\nThe roots are $\\lambda' = \\frac{(2+t^2) \\pm \\sqrt{(2+t^2)^2-4}}{2} = \\frac{(2+t^2) \\pm \\sqrt{t^4+4t^2}}{2} = \\frac{1}{2}\\left(2+t^2 \\pm |t|\\sqrt{t^2+4}\\right)$.\nThe eigenvalues of $\\mathbf{G}$ are $\\lambda = \\lambda'/4$. The condition number is the ratio of the eigenvalues, which is independent of the scaling factor $1/4$:\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{\\lambda'_{\\max}}{\\lambda'_{\\min}} = \\frac{2+t^2 + |t|\\sqrt{t^2+4}}{2+t^2 - |t|\\sqrt{t^2+4}}\n$$\nTo improve numerical stability, especially for large $|t|$, we can rationalize the denominator:\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{\\left(2+t^2 + |t|\\sqrt{t^2+4}\\right)^2}{\\left(2+t^2\\right)^2 - t^2(t^2+4)} = \\frac{\\left(2+t^2 + |t|\\sqrt{t^2+4}\\right)^2}{4}\n$$\nThis gives the final, numerically robust formula for the condition number with $t=\\tan\\gamma$:\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{1}{4}\\left(2+\\tan^2\\gamma + |\\tan\\gamma|\\sqrt{\\tan^2\\gamma+4}\\right)^2\n$$\nThese derived formulas for $\\mathcal{A}$ and $\\kappa_2(\\mathbf{G})$ will now be implemented to solve the test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the anisotropy ratio and spectral condition\n    number for a skewed parallelogram element in FEM.\n    \"\"\"\n    # The problem specifies five test cases based on the skew angle gamma.\n    # The base length L and height H are fixed at 1.0 m.\n    test_gammas_deg = [-30.0, 0.0, 30.0, 60.0, 85.0]\n    \n    results = []\n\n    for gamma_deg in test_gammas_deg:\n        # Convert the skew angle from degrees to radians for use in trigonometric functions.\n        gamma_rad = np.deg2rad(gamma_deg)\n\n        # 1. Compute the Anisotropy Ratio (A)\n        # The derivation shows that A = |sin(gamma)|.\n        anisotropy_ratio = np.abs(np.sin(gamma_rad))\n\n        # 2. Compute the Spectral Condition Number (kappa_2(G))\n        # The condition number is derived from the eigenvalues of the metric tensor G.\n        # For L=H=1, it is a function of t = tan(gamma). A numerically stable\n        # formula is used to avoid issues with subtractive cancellation.\n        # kappa_2(G) = (1/4) * ( (2 + t^2) + |t|*sqrt(t^2 + 4) )^2\n        t = np.tan(gamma_rad)\n        \n        # For gamma = 0, the element is a square, and t=0. The metric tensor G\n        # is a multiple of the identity matrix, so its eigenvalues are equal,\n        # and the condition number is exactly 1.\n        if np.isclose(t, 0.0):\n            condition_number = 1.0\n        else:\n            term1 = 2.0 + t**2\n            term2 = np.abs(t) * np.sqrt(t**2 + 4.0)\n            condition_number = 0.25 * (term1 + term2)**2\n            \n        results.append([anisotropy_ratio, condition_number])\n\n    # Format the final output string according to the specification: [[a_1,k_1],[a_2,k_2],...].\n    # A high precision of 12 decimal places is used for the floating-point numbers\n    # to ensure accuracy and reproducibility.\n    result_strings = []\n    for a, k in results:\n        result_strings.append(f\"[{a:.12f},{k:.12f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Print the single-line result to standard output.\n    print(final_output)\n\nsolve()\n\n```"
        },
        {
            "introduction": "Many governing equations in acoustics, including the Helmholtz equation, are based on second-order differential operators. To correctly implement these operators within an isoparametric finite element framework, it is essential to master the transformation of not just the gradient but also the Hessian matrix. This capstone practice  challenges you to derive these transformation rules from first principles and implement them, solidifying a deep, operational understanding of the calculus behind coordinate transformations on curvilinear elements.",
            "id": "4127693",
            "problem": "Consider a scalar acoustic pressure field defined on a reference square in isoparametric coordinates $\\boldsymbol{\\xi} = (\\xi,\\eta)$, with mapping to physical coordinates $\\mathbf{x} = (x,y)$ through a smooth, bijective isoparametric transformation. The computational task is to transform higher-order derivatives of the scalar field from the reference domain to the physical domain, which is required for evaluating second-order operators such as the Helmholtz operator in the Finite Element Method (FEM) for computational acoustics. \n\nStart from first principles: multivariate chain rule, the definition of the Jacobian matrix of a coordinate transformation, and the bilinear form interpretation of second derivatives. Do not assume any pre-derived shortcut formulas for transforming gradients or Hessians. Your derivation must proceed from these fundamentals to construct implementable formulas for the gradient and Hessian in physical coordinates in terms of reference derivatives and the geometric mapping. All trigonometric arguments are in radians.\n\nReference field definition in the isoparametric domain:\n$$\n\\hat{p}(\\xi,\\eta) = \\sin(k\\,\\xi)\\,\\cos(k\\,\\eta) + \\xi^3 - \\xi\\,\\eta^2,\n$$\nwhere $k = \\pi$.\n\nIsoparametric mapping from $(\\xi,\\eta)$ to $(x,y)$:\n$$\nx(\\xi,\\eta) = \\xi + a\\,\\xi\\,\\eta, \\quad y(\\xi,\\eta) = \\eta + b\\,\\xi^2,\n$$\nwith constants $a$ and $b$ chosen so that the mapping is smooth and locally invertible.\n\nTask:\n- Derive, from the multivariate chain rule and the definition of the Jacobian, the expression for the physical gradient $\\nabla_{\\mathbf{x}} p$ in terms of the reference gradient $\\nabla_{\\boldsymbol{\\xi}} \\hat{p}$ and the Jacobian of the mapping.\n- Derive, from first principles, the physical Hessian $\\nabla^2_{\\mathbf{x}} p$ in terms of the reference Hessian $\\nabla^2_{\\boldsymbol{\\xi}} \\hat{p}$, the Jacobian, and the second derivatives of the mapping, including the contribution from the second derivatives of the inverse transformation. Your derivation must make explicit how the second derivatives of the inverse map with respect to physical coordinates arise from differentiating the identity $\\boldsymbol{\\xi}(\\mathbf{x}(\\boldsymbol{\\xi})) = \\boldsymbol{\\xi}$.\n\nImplement a program that, for each test case, computes:\n- The Euclidean norm of the physical gradient, i.e., $\\|\\nabla_{\\mathbf{x}} p\\|_2$.\n- The trace of the physical Hessian, i.e., $\\mathrm{tr}(\\nabla^2_{\\mathbf{x}} p)$, which is the Laplacian in Cartesian coordinates.\n\nUse the following test suite of parameter values $(a,b,\\xi,\\eta)$:\n- Test case $1$: $a = 0.2$, $b = 0.1$, $\\xi = 0.3$, $\\eta = -0.2$.\n- Test case $2$: $a = 0.0$, $b = 0.0$, $\\xi = 0.5$, $\\eta = 0.5$.\n- Test case $3$: $a = -0.3$, $b = 0.0$, $\\xi = -0.8$, $\\eta = 0.9$.\n- Test case $4$: $a = 0.0$, $b = 0.4$, $\\xi = 0.7$, $\\eta = -1.0$.\n- Test case $5$: $a = 0.9$, $b = 0.0$, $\\xi = 0.2$, $\\eta = -1.0$.\n\nDesign for coverage:\n- Test case $1$ is a general curved mapping with both cross-term and quadratic term active.\n- Test case $2$ reduces to the identity mapping, giving a direct consistency check with the reference derivatives.\n- Test case $3$ isolates the cross-term effect with negative $a$ near the boundary of the reference square.\n- Test case $4$ isolates the quadratic stretching effect in $\\xi$ with $b > 0$.\n- Test case $5$ explores near-degenerate Jacobian conditions ($1 + a\\,\\eta$ small but positive).\n\nFinal output format specification:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of pairs, with each pair formatted as $[\\text{gnorm},\\text{laplacian}]$ and the full list enclosed in square brackets, e.g., $[[r_1^1,r_1^2],[r_2^1,r_2^2],\\ldots]$. The entries $\\text{gnorm}$ and $\\text{laplacian}$ must be floating-point numbers. No additional text should be printed.",
            "solution": "The problem is valid. It is a well-posed problem in computational mathematics, specifically concerning the transformation of differential operators under a change of coordinates, a fundamental concept in the Finite Element Method (FEM). The problem is scientifically grounded, self-contained, and objective. All necessary functions and parameters are provided for a unique solution.\n\nThe solution requires the derivation of the transformation rules for the gradient and Hessian of a scalar field $p$ from a reference domain $\\boldsymbol{\\xi}=(\\xi, \\eta)$ to a physical domain $\\mathbf{x}=(x, y)$. The physical field $p(\\mathbf{x})$ is related to the reference field $\\hat{p}(\\boldsymbol{\\xi})$ by the composition $p(\\mathbf{x}) = \\hat{p}(\\boldsymbol{\\xi}(\\mathbf{x}))$, where $\\mathbf{x}(\\boldsymbol{\\xi})$ is the given isoparametric mapping.\n\nLet the forward mapping be $\\mathbf{x}(\\boldsymbol{\\xi})$ and the inverse mapping be $\\boldsymbol{\\xi}(\\mathbf{x})$. The Jacobian matrix of the forward mapping and its inverse are denoted as:\n$$\nJ = \\frac{\\partial \\mathbf{x}}{\\partial \\boldsymbol{\\xi}} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}, \\quad J^{-1} = \\frac{\\partial \\boldsymbol{\\xi}}{\\partial \\mathbf{x}} = \\begin{pmatrix} \\frac{\\partial \\xi}{\\partial x} & \\frac{\\partial \\xi}{\\partial y} \\\\ \\frac{\\partial \\eta}{\\partial x} & \\frac{\\partial \\eta}{\\partial y} \\end{pmatrix}\n$$\n\n**Part 1: Gradient Transformation**\n\nThe gradient of the physical field $p$ with respect to coordinates $\\mathbf{x}$ is found using the multivariate chain rule. The components of the physical gradient $\\nabla_{\\mathbf{x}} p$ are:\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial \\hat{p}}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial x} + \\frac{\\partial \\hat{p}}{\\partial \\eta} \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial \\hat{p}}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial y} + \\frac{\\partial \\hat{p}}{\\partial \\eta} \\frac{\\partial \\eta}{\\partial y}\n$$\nIn matrix notation, this relationship is expressed as:\n$$\n\\nabla_{\\mathbf{x}} p = \\begin{pmatrix} \\frac{\\partial p}{\\partial x} \\\\ \\frac{\\partial p}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial \\xi}{\\partial x} & \\frac{\\partial \\eta}{\\partial x} \\\\ \\frac{\\partial \\xi}{\\partial y} & \\frac{\\partial \\eta}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\hat{p}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{p}}{\\partial \\eta} \\end{pmatrix}\n$$\nRecognizing the matrix as the transpose of the Jacobian of the inverse mapping, $(J^{-1})^T$, and the vector as the reference gradient $\\nabla_{\\boldsymbol{\\xi}} \\hat{p}$, we arrive at the transformation rule for the gradient:\n$$\n\\nabla_{\\mathbf{x}} p = (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} \\hat{p}\n$$\nThis formula allows the computation of the physical gradient from the reference gradient and the inverse of the forward mapping's Jacobian. The Euclidean norm is then $\\|\\nabla_{\\mathbf{x}} p\\|_2 = \\sqrt{ (\\frac{\\partial p}{\\partial x})^2 + (\\frac{\\partial p}{\\partial y})^2 }$.\n\n**Part 2: Hessian Transformation**\n\nThe Hessian matrix of the physical field, $\\nabla^2_{\\mathbf{x}} p$, contains the second-order partial derivatives. We derive its components by differentiating the components of the physical gradient with respect to the physical coordinates. Let $i, j \\in \\{x, y\\}$ be indices for physical coordinates and $\\alpha, \\beta \\in \\{\\xi, \\eta\\}$ for reference coordinates.\nStarting from the expression for the first derivative, $\\frac{\\partial p}{\\partial x_i} = \\sum_{\\alpha} \\frac{\\partial \\hat{p}}{\\partial \\xi_\\alpha} \\frac{\\partial \\xi_\\alpha}{\\partial x_i}$, we differentiate with respect to $x_j$ using the product rule and chain rule:\n$$\n\\frac{\\partial^2 p}{\\partial x_j \\partial x_i} = \\sum_{\\alpha} \\left[ \\left( \\frac{\\partial}{\\partial x_j} \\frac{\\partial \\hat{p}}{\\partial \\xi_\\alpha} \\right) \\frac{\\partial \\xi_\\alpha}{\\partial x_i} + \\frac{\\partial \\hat{p}}{\\partial \\xi_\\alpha} \\frac{\\partial^2 \\xi_\\alpha}{\\partial x_j \\partial x_i} \\right]\n$$\nThe first term inside the bracket is expanded via the chain rule again:\n$$\n\\frac{\\partial}{\\partial x_j} \\frac{\\partial \\hat{p}}{\\partial \\xi_\\alpha} = \\sum_{\\beta} \\frac{\\partial^2 \\hat{p}}{\\partial \\xi_\\beta \\partial \\xi_\\alpha} \\frac{\\partial \\xi_\\beta}{\\partial x_j}\n$$\nSubstituting this back, we get the complete expression for a component of the physical Hessian:\n$$\n\\frac{\\partial^2 p}{\\partial x_j \\partial x_i} = \\sum_{\\alpha, \\beta} \\frac{\\partial^2 \\hat{p}}{\\partial \\xi_\\beta \\partial \\xi_\\alpha} \\frac{\\partial \\xi_\\beta}{\\partial x_j} \\frac{\\partial \\xi_\\alpha}{\\partial x_i} + \\sum_{\\alpha} \\frac{\\partial \\hat{p}}{\\partial \\xi_\\alpha} \\frac{\\partial^2 \\xi_\\alpha}{\\partial x_j \\partial x_i}\n$$\nIn matrix form, this becomes:\n$$\n\\nabla^2_{\\mathbf{x}} p = (J^{-1})^T (\\nabla^2_{\\boldsymbol{\\xi}} \\hat{p}) J^{-1} + \\sum_{\\alpha=1}^{2} (\\nabla_{\\boldsymbol{\\xi}} \\hat{p})_\\alpha (\\nabla^2_{\\mathbf{x}} \\xi_\\alpha)\n$$\nHere, $\\nabla^2_{\\boldsymbol{\\xi}} \\hat{p}$ is the Hessian of the reference field, and $\\nabla^2_{\\mathbf{x}} \\xi_\\alpha$ is the Hessian of the $\\alpha$-th component of the inverse coordinate mapping $\\boldsymbol{\\xi}(\\mathbf{x})$.\n\nThe terms $\\nabla^2_{\\mathbf{x}} \\xi_\\alpha$ are difficult to compute directly. As per the problem's instruction, we derive them by differentiating the identity $\\boldsymbol{\\xi}(\\mathbf{x}(\\boldsymbol{\\xi})) = \\boldsymbol{\\xi}$. Differentiating $\\sum_i \\frac{\\partial \\xi_\\alpha}{\\partial x_i} \\frac{\\partial x_i}{\\partial \\xi_\\beta} = \\delta_{\\alpha\\beta}$ with respect to a reference coordinate $\\xi_\\gamma$ yields:\n$$\n\\sum_i \\left[ \\left( \\sum_k \\frac{\\partial^2 \\xi_\\alpha}{\\partial x_k \\partial x_i} \\frac{\\partial x_k}{\\partial \\xi_\\gamma} \\right) \\frac{\\partial x_i}{\\partial \\xi_\\beta} + \\frac{\\partial \\xi_\\alpha}{\\partial x_i} \\frac{\\partial^2 x_i}{\\partial \\xi_\\gamma \\partial \\xi_\\beta} \\right] = 0\n$$\nThis equation relates the unknown Hessian of the inverse map ($\\nabla^2_{\\mathbf{x}} \\xi_\\alpha$) to the known Hessian of the forward map ($\\nabla^2_{\\boldsymbol{\\xi}} x_i$). In matrix notation, this complex expression is equivalent to:\n$$\nJ^T (\\nabla^2_{\\mathbf{x}} \\xi_\\alpha) J + \\sum_{i=1}^{2} (J^{-1})_{\\alpha i} (\\nabla^2_{\\boldsymbol{\\xi}} x_i) = \\mathbf{0}\n$$\nSolving for the Hessian of the inverse map component $\\xi_\\alpha$:\n$$\n\\nabla^2_{\\mathbf{x}} \\xi_\\alpha = - (J^T)^{-1} \\left( \\sum_{i=1}^{2} (J^{-1})_{\\alpha i} (\\nabla^2_{\\boldsymbol{\\xi}} x_i) \\right) J^{-1}\n$$\nSubstituting this back into the expression for the physical Hessian $\\nabla^2_{\\mathbf{x}} p$ provides the final, implementable formula. The Laplacian is then found by taking the trace of this resulting matrix: $\\mathrm{tr}(\\nabla^2_{\\mathbf{x}} p)$.\n\n**Step-by-step Implementation Plan:**\n\n1.  For each test case `(a, b, xi, eta)`:\n2.  Define the constant $k = \\pi$.\n3.  Compute the first derivatives of $\\hat{p}$: $\\hat{p}_\\xi, \\hat{p}_\\eta$. Form the reference gradient vector $\\nabla_{\\boldsymbol{\\xi}} \\hat{p}$.\n4.  Compute the second derivatives of $\\hat{p}$: $\\hat{p}_{\\xi\\xi}, \\hat{p}_{\\eta\\eta}, \\hat{p}_{\\xi\\eta}$. Form the reference Hessian matrix $\\nabla^2_{\\boldsymbol{\\xi}} \\hat{p}$.\n5.  Compute the first derivatives of the mapping $x(\\xi,\\eta), y(\\xi,\\eta)$: $x_\\xi, x_\\eta, y_\\xi, y_\\eta$. Form the Jacobian matrix $J$.\n6.  Compute the second derivatives of the mapping: $x_{\\xi\\xi}, x_{\\xi\\eta}, x_{\\eta\\eta}$ and $y_{\\xi\\xi}, y_{\\xi\\eta}, y_{\\eta\\eta}$. Form the Hessian matrices $\\nabla^2_{\\boldsymbol{\\xi}} x$ and $\\nabla^2_{\\boldsymbol{\\xi}} y$.\n7.  Calculate the inverse Jacobian $J^{-1}$.\n8.  Calculate the physical gradient: $\\nabla_{\\mathbf{x}} p = (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} \\hat{p}$.\n9.  Calculate the Euclidean norm of the physical gradient, $\\|\\nabla_{\\mathbf{x}} p\\|_2$.\n10. Calculate the Hessians of the inverse coordinate maps $\\nabla^2_{\\mathbf{x}} \\xi$ and $\\nabla^2_{\\mathbf{x}} \\eta$ using the derived formula.\n11. Assemble the full physical Hessian $\\nabla^2_{\\mathbf{x}} p$.\n12. Compute the trace of the physical Hessian to find the Laplacian $\\mathrm{tr}(\\nabla^2_{\\mathbf{x}} p)$.\n\n**Derivatives for the specific problem:**\n-   Field: $\\hat{p}(\\xi,\\eta) = \\sin(k\\xi)\\cos(k\\eta) + \\xi^3 - \\xi\\eta^2$\n    -   $\\hat{p}_\\xi = k\\cos(k\\xi)\\cos(k\\eta) + 3\\xi^2 - \\eta^2$\n    -   $\\hat{p}_\\eta = -k\\sin(k\\xi)\\sin(k\\eta) - 2\\xi\\eta$\n    -   $\\hat{p}_{\\xi\\xi} = -k^2\\sin(k\\xi)\\cos(k\\eta) + 6\\xi$\n    -   $\\hat{p}_{\\eta\\eta} = -k^2\\sin(k\\xi)\\cos(k\\eta) - 2\\xi$\n    -   $\\hat{p}_{\\xi\\eta} = -k^2\\cos(k\\xi)\\sin(k\\eta) - 2\\eta$\n-   Mapping: $x(\\xi,\\eta) = \\xi + a\\xi\\eta$, $y(\\xi,\\eta) = \\eta + b\\xi^2$\n    -   $J = \\begin{pmatrix} 1 + a\\eta & a\\xi \\\\ 2b\\xi & 1 \\end{pmatrix}$\n    -   $\\nabla^2_{\\boldsymbol{\\xi}} x = \\begin{pmatrix} 0 & a \\\\ a & 0 \\end{pmatrix}$\n    -   $\\nabla^2_{\\boldsymbol{\\xi}} y = \\begin{pmatrix} 2b & 0 \\\\ 0 & 0 \\end{pmatrix}$\n\nThese expressions are substituted into the general formulas derived above to obtain the numerical results for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the isoparametric transformation problem for a given set of test cases.\n    It computes the Euclidean norm of the physical gradient and the trace of the\n    physical Hessian (Laplacian) for a scalar field.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 0.1, 0.3, -0.2),   # Test case 1\n        (0.0, 0.0, 0.5, 0.5),    # Test case 2\n        (-0.3, 0.0, -0.8, 0.9),  # Test case 3\n        (0.0, 0.4, 0.7, -1.0),   # Test case 4\n        (0.9, 0.0, 0.2, -1.0),   # Test case 5\n    ]\n\n    results = []\n    k = np.pi\n\n    for a, b, xi, eta in test_cases:\n        # 1. Compute derivatives of the scalar field p(xi, eta)\n        sin_kxi = np.sin(k * xi)\n        cos_kxi = np.cos(k * xi)\n        sin_keta = np.sin(k * eta)\n        cos_keta = np.cos(k * eta)\n\n        p_xi = k * cos_kxi * cos_keta + 3 * xi**2 - eta**2\n        p_eta = -k * sin_kxi * sin_keta - 2 * xi * eta\n        ref_grad = np.array([p_xi, p_eta])\n\n        p_xixi = -k**2 * sin_kxi * cos_keta + 6 * xi\n        p_etaeta = -k**2 * sin_kxi * cos_keta - 2 * xi\n        p_xieta = -k**2 * cos_kxi * sin_keta - 2 * eta\n        ref_hess = np.array([[p_xixi, p_xieta], [p_xieta, p_etaeta]])\n\n        # 2. Compute derivatives of the mapping x(xi, eta), y(xi, eta)\n        # Jacobian of the forward map\n        J = np.array([\n            [1 + a * eta, a * xi],\n            [2 * b * xi, 1.0]\n        ])\n\n        # Hessians of the forward map components\n        H_x = np.array([[0.0, a], [a, 0.0]])\n        H_y = np.array([[2.0 * b, 0.0], [0.0, 0.0]])\n\n        # 3. Perform the coordinate transformation\n        try:\n            J_inv = np.linalg.inv(J)\n        except np.linalg.LinAlgError:\n            # Handle singular Jacobian, though test cases are designed to avoid this\n            results.append([float('nan'), float('nan')])\n            continue\n\n        # 4. Compute physical gradient and its norm\n        phys_grad = J_inv.T @ ref_grad\n        grad_norm = np.linalg.norm(phys_grad)\n        \n        # 5. Compute physical Hessian and its trace (Laplacian)\n        \n        # This is (J^T)^{-1}, which is equivalent to (J^{-1})^T\n        J_T_inv = J_inv.T\n\n        # Compute Hessians of inverse map components: H_xi and H_eta\n        # H_xi = - (J^T)^-1 * (J_inv[0,0]*H_x + J_inv[0,1]*H_y) * J^-1\n        H_xi = -J_T_inv @ (J_inv[0, 0] * H_x + J_inv[0, 1] * H_y) @ J_inv\n        \n        # H_eta = - (J^T)^-1 * (J_inv[1,0]*H_x + J_inv[1,1]*H_y) * J^-1\n        H_eta = -J_T_inv @ (J_inv[1, 0] * H_x + J_inv[1, 1] * H_y) @ J_inv\n\n        # Assemble the full physical Hessian using the derived formula:\n        # H_p = (J^-1)^T * H_p_ref * J^-1 + p_xi * H_xi + p_eta * H_eta\n        phys_hess = J_inv.T @ ref_hess @ J_inv + ref_grad[0] * H_xi + ref_grad[1] * H_eta\n        \n        laplacian = np.trace(phys_hess)\n\n        results.append([grad_norm, laplacian])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, so str(results) produces the correct output string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}