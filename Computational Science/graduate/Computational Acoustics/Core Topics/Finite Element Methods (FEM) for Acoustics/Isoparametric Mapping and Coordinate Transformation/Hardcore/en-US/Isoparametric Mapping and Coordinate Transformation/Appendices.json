{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of the isoparametric approach is the ability to transform differential operators from a simple reference domain to a complex physical domain. This first exercise provides a concrete, step-by-step calculation of this process for a single basis function on a spectral element . By applying the multivariate chain rule and computing the Jacobian of the transformation, you will solidify your understanding of how spatial gradients, a fundamental component of many physical models, are calculated in practice within the Finite Element Method.",
            "id": "4127655",
            "problem": "Consider the acoustic pressure discretization on a quadrilateral spectral element in computational acoustics. The reference element is the square $\\hat{\\Omega} = [-1,1]^2$ with tensor-product Gauss-Lobatto-Legendre (GLL) nodes at $\\{-1,0,1\\}$ along each reference coordinate. The isoparametric mapping $\\boldsymbol{F} : (s,t) \\mapsto (x(s,t),y(s,t))$ from the reference element to the physical element is constructed by interpolating the physical nodal coordinates with the tensor-product Lagrange basis associated with the GLL nodes. The physical nodal coordinates are obtained by evaluating the polynomial mapping\n$$\nx(s,t) = a\\,s + \\alpha\\,s\\,t, \\qquad y(s,t) = b\\,t + \\beta\\,s^2,\n$$\nat the GLL tensor grid points $(s,t) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$, where $a=\\frac{3}{2}$, $b=\\frac{4}{3}$, $\\alpha=\\frac{1}{5}$, and $\\beta=-\\frac{2}{5}$. Because the mapping is interpolated using the same basis space, you may treat $\\boldsymbol{F}$ as exactly equal to the polynomial expressions above throughout $\\hat{\\Omega}$.\n\nLet $\\phi(s,t)$ be the interpolatory shape function associated with the GLL node at $(s,t)=(1,0)$, i.e., $\\phi(s,t) = L_{1}(s)\\,L_{0}(t)$ where $L_{-1}(s)$, $L_{0}(s)$, and $L_{1}(s)$ are the one-dimensional Lagrange polynomials of degree $2$ on the nodes $\\{-1,0,1\\}$, and similarly for $t$. Using the chain rule for coordinate transformation under the isoparametric mapping, determine the squared magnitude of the physical gradient $|\\nabla_{x,y}\\phi|^2$ at the element center $(s,t)=(0,0)$.\n\nProvide your final answer as a single real number with no units. Do not round; give the exact value.",
            "solution": "This problem requires applying the chain rule to transform the gradient of a shape function from the reference element to the physical element. The solution proceeds in the following steps.\n\n**1. Define the Shape Function**\nThe problem specifies the shape function $\\phi(s,t)$ for the node at $(s,t)=(1,0)$. It is formed by the tensor product of the 1D quadratic Lagrange polynomials $L_k$ on the nodes $\\{-1,0,1\\}$. The required polynomials are:\n$$\nL_1(s) = \\frac{(s-0)(s-(-1))}{(1-0)(1-(-1))} = \\frac{1}{2}s(s+1)\n$$\n$$\nL_0(t) = \\frac{(t-(-1))(t-1)}{(0-(-1))(0-1)} = -(t+1)(t-1) = 1-t^2\n$$\nThe 2D shape function is therefore:\n$$\n\\phi(s,t) = L_1(s)L_0(t) = \\frac{1}{2}(s^2+s)(1-t^2)\n$$\n\n**2. Compute the Gradient in Reference Coordinates**\nWe compute the partial derivatives of $\\phi$ with respect to the reference coordinates $s$ and $t$:\n$$\n\\frac{\\partial\\phi}{\\partial s} = \\frac{1}{2}(2s+1)(1-t^2)\n$$\n$$\n\\frac{\\partial\\phi}{\\partial t} = \\frac{1}{2}(s^2+s)(-2t) = -t(s^2+s)\n$$\nAt the element center $(s,t)=(0,0)$, the gradient vector is:\n$$\n\\nabla_{s,t}\\phi|_{(0,0)} = \\begin{pmatrix} \\frac{\\partial\\phi}{\\partial s} \\\\ \\frac{\\partial\\phi}{\\partial t} \\end{pmatrix}_{(0,0)} = \\begin{pmatrix} \\frac{1}{2}(1)(1) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}\n$$\n\n**3. Compute the Jacobian of the Mapping**\nThe isoparametric mapping is given by $\\mathbf{x}(s,t) = (x(s,t), y(s,t))$ where $x(s,t) = as + \\alpha st$ and $y(s,t) = bt + \\beta s^2$. The Jacobian matrix $\\mathbf{J}$ is:\n$$\n\\mathbf{J}(s,t) = \\begin{pmatrix} \\frac{\\partial x}{\\partial s} & \\frac{\\partial x}{\\partial t} \\\\ \\frac{\\partial y}{\\partial s} & \\frac{\\partial y}{\\partial t} \\end{pmatrix} = \\begin{pmatrix} a + \\alpha t & \\alpha s \\\\ 2\\beta s & b \\end{pmatrix}\n$$\nAt the element center $(s,t)=(0,0)$, the Jacobian simplifies to a diagonal matrix:\n$$\n\\mathbf{J}(0,0) = \\begin{pmatrix} a & 0 \\\\ 0 & b \\end{pmatrix}\n$$\n\n**4. Transform the Gradient and Compute its Magnitude**\nThe chain rule relates the physical gradient $\\nabla_{x,y}\\phi$ to the reference gradient $\\nabla_{s,t}\\phi$ via the relation $\\nabla_{s,t}\\phi = \\mathbf{J}^T \\nabla_{x,y}\\phi$. Inverting this gives:\n$$\n\\nabla_{x,y}\\phi = (\\mathbf{J}^T)^{-1} \\nabla_{s,t}\\phi\n$$\nAt $(s,t)=(0,0)$, since $\\mathbf{J}$ is diagonal, $\\mathbf{J}^T = \\mathbf{J}$, and its inverse is trivial:\n$$\n(\\mathbf{J}(0,0)^T)^{-1} = \\begin{pmatrix} 1/a & 0 \\\\ 0 & 1/b \\end{pmatrix}\n$$\nThe physical gradient at the center is:\n$$\n\\nabla_{x,y}\\phi|_{(0,0)} = \\begin{pmatrix} 1/a & 0 \\\\ 0 & 1/b \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/(2a) \\\\ 0 \\end{pmatrix}\n$$\nThe squared magnitude of this physical gradient is:\n$$\n|\\nabla_{x,y}\\phi|^2 = \\left(\\frac{1}{2a}\\right)^2 + 0^2 = \\frac{1}{4a^2}\n$$\n\n**5. Final Calculation**\nSubstituting the given value $a = 3/2$:\n$$\n|\\nabla_{x,y}\\phi|^2 = \\frac{1}{4(3/2)^2} = \\frac{1}{4(9/4)} = \\frac{1}{9}\n$$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        },
        {
            "introduction": "Once we understand the mechanics of transforming derivatives, a critical question arises: how does the geometry of the mapping affect the properties of the discretized physical system? This practice investigates the impact of element distortion, specifically skewness, on the underlying mathematical structure through the metric tensor $\\mathbf{G}$ . By calculating key quality measures like the anisotropy ratio and spectral condition number, you will develop a crucial intuition for why mesh quality is paramount for the accuracy and stability of finite element simulations.",
            "id": "4127665",
            "problem": "Consider a two-dimensional linear acoustic medium with constant density $\\rho$ (in $\\mathrm{kg/m^3}$) and constant bulk modulus $B$ (in $\\mathrm{Pa}$). The time-domain acoustic pressure $p(x,y,t)$ satisfies the acoustic wave equation\n$$\n\\frac{1}{B}\\,\\frac{\\partial^2 p}{\\partial t^2} - \\nabla \\cdot \\left( \\frac{1}{\\rho}\\,\\nabla p \\right) = 0,\n$$\nwhere $\\nabla$ denotes the spatial gradient operator with respect to the physical coordinates $(x,y)$. For time-harmonic fields of angular frequency $\\omega$ (in $\\mathrm{rad/s}$), the pressure can be written as $p(x,y,t) = \\Re\\{ \\hat{p}(x,y)\\,e^{\\mathrm{i}\\,\\omega t} \\}$, with complex amplitude $\\hat{p}(x,y)$, leading to the Helmholtz form\n$$\n-\\nabla \\cdot \\left( \\frac{1}{\\rho}\\,\\nabla \\hat{p} \\right) - \\frac{\\omega^2}{B}\\,\\hat{p} = 0.\n$$\n\nIn computational acoustics, the Finite Element Method (FEM) employs an isoparametric mapping from a reference element $\\Omega_{\\xi} = \\{(\\xi,\\eta)\\,|\\,\\xi \\in [-1,1],\\,\\eta \\in [-1,1]\\}$ to a physical element $\\Omega_{x} \\subset \\mathbb{R}^2$. For a four-node bilinear quadrilateral (Q4) element, the mapping is defined by\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i,\n$$\nwhere the shape functions are\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\nand the nodal coordinates $\\mathbf{x}_i = (x_i,y_i)$ define the physical element. The Jacobian matrix of the mapping is\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix},\n$$\nand the metric tensor is defined as\n$$\n\\mathbf{G}(\\xi,\\eta) = \\mathbf{J}(\\xi,\\eta)^{\\top}\\,\\mathbf{J}(\\xi,\\eta),\n$$\nwith inverse $\\mathbf{G}^{-1}(\\xi,\\eta)$. Under this mapping, the spatial gradient transforms as\n$$\n\\nabla_{x,y} = \\mathbf{J}^{-\\top}\\,\\nabla_{\\xi,\\eta},\n$$\nand the weak form of the Helmholtz operator reflects coupling through $\\mathbf{G}^{-1}$. Skew mappings (non-orthogonal $\\mathbf{J}$) induce off-diagonal entries in $\\mathbf{G}^{-1}$, which couple $\\xi$ and $\\eta$ directions. A useful quantitative measure of this coupling is the anisotropy ratio\n$$\n\\mathcal{A} = \\frac{\\left|g^{\\xi\\eta}\\right|}{\\sqrt{g^{\\xi\\xi}\\,g^{\\eta\\eta}}},\n$$\nwhere $g^{\\alpha\\beta}$ are the entries of $\\mathbf{G}^{-1}$; $\\mathcal{A} = 0$ indicates orthogonality, and larger values indicate stronger skew-induced coupling. Another important geometric indicator is the spectral condition number of $\\mathbf{G}$ in the $2$-norm,\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{\\lambda_{\\max}(\\mathbf{G})}{\\lambda_{\\min}(\\mathbf{G})},\n$$\nwhere $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues, respectively. This condition number reflects combined effects of aspect ratio and skew on the mapping.\n\nYou will implement and analyze a family of affine isoparametric mappings that map the reference square to a skewed parallelogram in physical space. The parallelogram is defined by two edge vectors\n$$\n\\mathbf{v}_1 = (L,\\,0),\\quad \\mathbf{v}_2 = (H\\,\\tan \\gamma,\\,H),\n$$\nwith base length $L$ (in $\\mathrm{m}$), height $H$ (in $\\mathrm{m}$), and skew angle $\\gamma$ (in degrees). The nodal coordinates of the physical Q4 element are\n$$\n\\mathbf{x}_1 = (0,\\,0),\\quad\n\\mathbf{x}_2 = (L,\\,0),\\quad\n\\mathbf{x}_3 = (L + H\\,\\tan \\gamma,\\,H),\\quad\n\\mathbf{x}_4 = (H\\,\\tan \\gamma,\\,H).\n$$\nFor this parallelogram, the mapping is affine and the Jacobian $\\mathbf{J}$ and metric $\\mathbf{G}$ are constant over $\\Omega_{\\xi}$.\n\nTask:\n1. For each test case, construct the nodal coordinates $\\mathbf{x}_i$ from $(L,H,\\gamma)$, compute the constant Jacobian $\\mathbf{J}$ using the isoparametric derivatives at the element center $(\\xi,\\eta) = (0,0)$, evaluate $\\mathbf{G} = \\mathbf{J}^{\\top}\\mathbf{J}$, and compute its inverse $\\mathbf{G}^{-1}$.\n2. From $\\mathbf{G}^{-1}$, compute the anisotropy ratio $\\mathcal{A} = \\left|g^{\\xi\\eta}\\right|/\\sqrt{g^{\\xi\\xi} g^{\\eta\\eta}}$.\n3. From $\\mathbf{G}$, compute the spectral condition number $\\kappa_2(\\mathbf{G})$ as the ratio of its largest to smallest eigenvalues.\n4. Report, for each test case, the pair $[\\mathcal{A},\\,\\kappa_2(\\mathbf{G})]$ as dimensionless floats.\n\nAngle unit requirement:\n- All angles $\\gamma$ are specified in degrees. Use degrees for $\\gamma$ when computing $\\tan \\gamma$.\n\nPhysical unit requirement:\n- Use $L$ and $H$ in meters ($\\mathrm{m}$). The reported quantities $\\mathcal{A}$ and $\\kappa_2(\\mathbf{G})$ are dimensionless and should be reported as plain decimal floats.\n\nTest suite:\n- Use $(L,H) = (1.0,\\,1.0)$ in $\\mathrm{m}$ for all cases, and the following skew angles $\\gamma$ in degrees:\n  - Case $1$: $\\gamma = -30$.\n  - Case $2$: $\\gamma = 0$.\n  - Case $3$: $\\gamma = 30$.\n  - Case $4$: $\\gamma = 60$.\n  - Case $5$: $\\gamma = 85$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a two-element list $[\\mathcal{A},\\,\\kappa_2(\\mathbf{G})]$ corresponding to one test case, in the order listed above. For example, the format must be like $[[a_1,k_1],[a_2,k_2],\\dots]$ with no additional text.",
            "solution": "The solution requires deriving expressions for the anisotropy ratio $\\mathcal{A}$ and the spectral condition number $\\kappa_2(\\mathbf{G})$ for the specified affine mapping. Since the mapping is affine, the Jacobian $\\mathbf{J}$ and metric tensor $\\mathbf{G}$ are constant throughout the element.\n\n**1. Jacobian Matrix Derivation**\nThe physical coordinates $\\mathbf{x} = (x, y)$ are related to the reference coordinates $(\\xi, \\eta)$ by the isoparametric mapping $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$. The components of the Jacobian matrix, $J_{kl} = \\partial x_k / \\partial \\xi_l$, can be computed using the derivatives of the shape functions and the nodal coordinates $\\mathbf{x}_i$:\n$\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (L, 0)$, $\\mathbf{x}_3 = (L + H \\tan \\gamma, H)$, and $\\mathbf{x}_4 = (H \\tan \\gamma, H)$.\n\nSince the map is affine, we can evaluate the derivatives at any point, for instance the center $(\\xi, \\eta) = (0, 0)$. The components of the Jacobian are:\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}(-x_1 + x_2 + x_3 - x_4) = \\frac{1}{4}(0 + L + (L + H \\tan\\gamma) - H \\tan\\gamma) = \\frac{L}{2}$\n$J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}(-x_1 - x_2 + x_3 + x_4) = \\frac{1}{4}(0 - L + (L + H \\tan\\gamma) + H \\tan\\gamma) = \\frac{H \\tan\\gamma}{2}$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}(-y_1 + y_2 + y_3 - y_4) = \\frac{1}{4}(0 + 0 + H - H) = 0$\n$J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}(-y_1 - y_2 + y_3 + y_4) = \\frac{1}{4}(0 - 0 + H + H) = \\frac{H}{2}$\nThe constant Jacobian matrix is:\n$$\n\\mathbf{J} = \\frac{1}{2} \\begin{bmatrix} L & H \\tan \\gamma \\\\ 0 & H \\end{bmatrix}\n$$\n\n**2. Metric Tensor and Its Inverse**\nThe metric tensor is defined as $\\mathbf{G} = \\mathbf{J}^{\\top}\\mathbf{J}$:\n$$\n\\mathbf{G} = \\frac{1}{4} \\begin{bmatrix} L & 0 \\\\ H \\tan \\gamma & H \\end{bmatrix} \\begin{bmatrix} L & H \\tan \\gamma \\\\ 0 & H \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} L^2 & LH \\tan \\gamma \\\\ LH \\tan \\gamma & H^2 \\tan^2 \\gamma + H^2 \\end{bmatrix}\n$$\nUsing the identity $1+\\tan^2\\gamma = \\sec^2\\gamma$:\n$$\n\\mathbf{G} = \\frac{1}{4} \\begin{bmatrix} L^2 & LH \\tan \\gamma \\\\ LH \\tan \\gamma & H^2 \\sec^2 \\gamma \\end{bmatrix}\n$$\nThe inverse metric tensor $\\mathbf{G}^{-1}$ is efficiently found using $\\mathbf{G}^{-1} = (\\mathbf{J}^{-1})(\\mathbf{J}^{-1})^{\\top}$. The inverse Jacobian is:\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{bmatrix} H/2 & -(H \\tan \\gamma)/2 \\\\ 0 & L/2 \\end{bmatrix} = \\frac{4}{LH} \\begin{bmatrix} H/2 & -(H \\tan \\gamma)/2 \\\\ 0 & L/2 \\end{bmatrix} = \\begin{bmatrix} 2/L & -2 \\tan \\gamma/L \\\\ 0 & 2/H \\end{bmatrix}\n$$\nThen, $\\mathbf{G}^{-1}$ is:\n$$\n\\mathbf{G}^{-1} = \\begin{bmatrix} 2/L & -2 \\tan \\gamma/L \\\\ 0 & 2/H \\end{bmatrix} \\begin{bmatrix} 2/L & 0 \\\\ -2 \\tan \\gamma/L & 2/H \\end{bmatrix} = \\begin{bmatrix} \\frac{4}{L^2}(1+\\tan^2\\gamma) & -\\frac{4 \\tan \\gamma}{LH} \\\\ -\\frac{4 \\tan \\gamma}{LH} & \\frac{4}{H^2} \\end{bmatrix}\n$$\nSo, the components $g^{\\alpha\\beta}$ of $\\mathbf{G}^{-1}$ are: $g^{\\xi\\xi} = \\frac{4}{L^2\\cos^2\\gamma}$, $g^{\\xi\\eta} = -\\frac{4\\tan\\gamma}{LH}$, $g^{\\eta\\eta} = \\frac{4}{H^2}$.\n\n**3. Anisotropy Ratio $\\mathcal{A}$**\nThe anisotropy ratio is $\\mathcal{A} = \\frac{|g^{\\xi\\eta}|}{\\sqrt{g^{\\xi\\xi} g^{\\eta\\eta}}}$. Substituting the components:\n$$\n\\mathcal{A} = \\frac{\\left|-\\frac{4\\tan\\gamma}{LH}\\right|}{\\sqrt{\\frac{4}{L^2\\cos^2\\gamma} \\cdot \\frac{4}{H^2}}} = \\frac{\\frac{4|\\tan\\gamma|}{LH}}{\\frac{4}{LH|\\cos\\gamma|}} = |\\tan\\gamma||\\cos\\gamma| = |\\sin\\gamma|\n$$\nThe anisotropy ratio simplifies to the absolute value of the sine of the skew angle.\n\n**4. Spectral Condition Number $\\kappa_2(\\mathbf{G})$**\nFor the test cases, $L=1$ and $H=1$, so the metric tensor is $\\mathbf{G} = \\frac{1}{4} \\begin{bmatrix} 1 & \\tan\\gamma \\\\ \\tan\\gamma & \\sec^2\\gamma \\end{bmatrix}$. The condition number $\\kappa_2(\\mathbf{G}) = \\lambda_{\\max}(\\mathbf{G})/\\lambda_{\\min}(\\mathbf{G})$ is the ratio of its largest to smallest eigenvalues. Let $t = \\tan\\gamma$. The eigenvalues $\\lambda$ of $\\mathbf{G}$ are the roots of $\\det(\\mathbf{G} - \\lambda\\mathbf{I}) = 0$. This leads to the characteristic equation for $4\\mathbf{G}$:\n$$\n\\lambda'^2 - (2+t^2)\\lambda' + 1 = 0\n$$\nThe roots are $\\lambda' = \\frac{1}{2}\\left(2+t^2 \\pm |t|\\sqrt{t^2+4}\\right)$. The condition number is the ratio of the eigenvalues, which is independent of the scaling factor $1/4$:\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{\\lambda'_{\\max}}{\\lambda'_{\\min}} = \\frac{2+t^2 + |t|\\sqrt{t^2+4}}{2+t^2 - |t|\\sqrt{t^2+4}}\n$$\nA more numerically stable formula is obtained by rationalizing the denominator:\n$$\n\\kappa_2(\\mathbf{G}) = \\frac{1}{4}\\left(2+\\tan^2\\gamma + |\\tan\\gamma|\\sqrt{\\tan^2\\gamma+4}\\right)^2\n$$\nThese derived formulas for $\\mathcal{A}$ and $\\kappa_2(\\mathbf{G})$ are implemented in the provided code to solve the test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the anisotropy ratio and spectral condition\n    number for a skewed parallelogram element in FEM.\n    \"\"\"\n    # The problem specifies five test cases based on the skew angle gamma.\n    # The base length L and height H are fixed at 1.0 m.\n    test_gammas_deg = [-30.0, 0.0, 30.0, 60.0, 85.0]\n    \n    results = []\n\n    for gamma_deg in test_gammas_deg:\n        # Convert the skew angle from degrees to radians for use in trigonometric functions.\n        gamma_rad = np.deg2rad(gamma_deg)\n\n        # 1. Compute the Anisotropy Ratio (A)\n        # The derivation shows that A = |sin(gamma)|.\n        anisotropy_ratio = np.abs(np.sin(gamma_rad))\n\n        # 2. Compute the Spectral Condition Number (kappa_2(G))\n        # The condition number is derived from the eigenvalues of the metric tensor G.\n        # For L=H=1, it is a function of t = tan(gamma). A numerically stable\n        # formula is used to avoid issues with subtractive cancellation.\n        # kappa_2(G) = (1/4) * ( (2 + t^2) + |t|*sqrt(t^2 + 4) )^2\n        t = np.tan(gamma_rad)\n        \n        # For gamma = 0, the element is a square, and t=0. The metric tensor G\n        # is a multiple of the identity matrix, so its eigenvalues are equal,\n        # and the condition number is exactly 1.\n        if np.isclose(t, 0.0):\n            condition_number = 1.0\n        else:\n            term1 = 2.0 + t**2\n            term2 = np.abs(t) * np.sqrt(t**2 + 4.0)\n            condition_number = 0.25 * (term1 + term2)**2\n            \n        results.append([anisotropy_ratio, condition_number])\n\n    # Format the final output string according to the specification: [[a_1,k_1],[a_2,k_2],...].\n    # A high precision of 12 decimal places is used for the floating-point numbers\n    # to ensure accuracy and reproducibility.\n    result_strings = []\n    for a, k in results:\n        result_strings.append(f\"[{a:.12f},{k:.12f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Print the single-line result to standard output.\n    print(final_output)\n\nsolve()\n\n```"
        },
        {
            "introduction": "This final exercise brings together the concepts of coordinate transformation and weak-form integration to tackle a common and important challenge in computational acoustics: axisymmetric problems. You will compute an entry of the stiffness matrix for an element at the axis of symmetry, where a coordinate singularity exists in the strong form of the governing equation. This practice powerfully demonstrates how the combination of isoparametric mapping and the variational (weak) formulation elegantly resolves such singularities, a testament to the robustness of the Finite Element Method .",
            "id": "4127659",
            "problem": "Consider an axisymmetric, time-harmonic acoustic field with pressure $p(r)$ that depends only on the cylindrical radial coordinate $r$ near the axis $r=0$. The governing linear acoustics equation in the absence of mean flow is the Helmholtz equation, and in cylindrical coordinates for axisymmetric fields ($\\partial/\\partial\\theta=0$, $\\partial/\\partial z=0$), the strong form reduces to\n$$\n\\frac{1}{r}\\frac{d}{dr}\\!\\left(r\\frac{dp}{dr}\\right) + k^{2} p = 0,\n$$\nwhere $k$ is the acoustic wavenumber. The standard weak form underpinning the Finite Element Method (FEM) is\n$$\n\\int_{\\Omega} \\left(\\nabla p \\cdot \\nabla q - k^{2} p\\,q\\right)\\,d\\Omega = 0,\n$$\nand for axisymmetry over a radial interval $\\Omega = [0,h]$ with no $z$-dependence and full azimuthal extent, the measure is $d\\Omega = 2\\pi\\,r\\,dr$.\n\nNear $r=0$, the coordinate singularity in the strong form is handled by the weak form, which naturally incorporates the weight $r$ in the measure. Consider the first radial finite element adjacent to the axis, spanning $r\\in[0,h]$, discretized with a one-dimensional, two-node linear isoparametric mapping from the reference coordinate $\\xi\\in[-1,1]$:\n$$\nr(\\xi) = \\frac{h}{2}(\\xi+1), \\qquad J(\\xi) = \\frac{dr}{d\\xi} = \\frac{h}{2}.\n$$\nUse the standard linear shape functions on the reference element,\n$$\nN_{1}(\\xi) = \\frac{1-\\xi}{2}, \\qquad N_{2}(\\xi) = \\frac{1+\\xi}{2},\n$$\nand approximate $p(r)\\approx N_{1}(\\xi)\\,p_{1} + N_{2}(\\xi)\\,p_{2}$ with test function $q(r)$ drawn from the same space.\n\nFocusing only on the gradient (stiffness) part of the weak form and restricting the domain to the single element $\\Omega_e=[0,h]$, derive from first principles and compute exactly the $(1,1)$ entry of the element stiffness matrix,\n$$\nK_{11} \\equiv \\int_{\\Omega_e} \\left(\\frac{dp}{dr}\\right)\\left(\\frac{dq}{dr}\\right)\\,2\\pi\\,r\\,dr \\quad \\text{with}\\quad p\\to N_{1}(\\xi),\\; q\\to N_{1}(\\xi),\n$$\ntaking into account the isoparametric mapping and the coordinate singularity at $r=0$ via the weak form. Express your final answer as a single real number. No rounding is required.",
            "solution": "The objective is to compute the $(1,1)$ entry of the element stiffness matrix, $K_{11}$, for a two-node linear element at the axis of symmetry $r=0$. The domain is $\\Omega_e = [0,h]$. The definition for $K_{11}$ is:\n$$\nK_{11} = \\int_{0}^{h} \\left(\\frac{dN_{1}}{dr}\\right)^{2} 2\\pi r dr\n$$\nThis integral is defined in the physical coordinate $r$. To evaluate it, we transform it to the reference coordinate space $\\xi \\in [-1, 1]$.\n\n**1. Define the Coordinate Transformation**\nThe isoparametric mapping and its Jacobian (the transformation of the differential element) are given:\n$$\nr(\\xi) = \\frac{h}{2}(\\xi+1) \\implies dr = J(\\xi) d\\xi \\quad \\text{where} \\quad J(\\xi) = \\frac{dr}{d\\xi} = \\frac{h}{2}\n$$\n\n**2. Transform the Derivative**\nUsing the chain rule, we transform the derivative of the shape function $N_1$ from the physical to the reference coordinate:\n$$\n\\frac{dN_1}{dr} = \\frac{dN_1}{d\\xi} \\frac{d\\xi}{dr} = \\frac{1}{J(\\xi)} \\frac{dN_1}{d\\xi}\n$$\nThe shape function $N_{1}(\\xi) = (1-\\xi)/2$, so its derivative is a constant:\n$$\n\\frac{dN_1}{d\\xi} = -\\frac{1}{2}\n$$\nSubstituting this and the Jacobian gives:\n$$\n\\frac{dN_1}{dr} = \\frac{-1/2}{h/2} = -\\frac{1}{h}\n$$\n\n**3. Assemble and Evaluate the Integral**\nWe substitute the transformed components into the integral for $K_{11}$. The integration limits change from $r \\in [0,h]$ to $\\xi \\in [-1,1]$.\n$$\nK_{11} = \\int_{-1}^{1} \\left(-\\frac{1}{h}\\right)^2 2\\pi r(\\xi) J(\\xi) d\\xi\n$$\nNow, substitute the expressions for $r(\\xi)$ and $J(\\xi)$:\n$$\nK_{11} = \\int_{-1}^{1} \\frac{1}{h^2} \\cdot 2\\pi \\cdot \\left(\\frac{h}{2}(\\xi+1)\\right) \\cdot \\left(\\frac{h}{2}\\right) d\\xi\n$$\nThe terms involving $h$ cancel out, and the constants can be factored out:\n$$\nK_{11} = \\frac{2\\pi}{h^2} \\cdot \\frac{h^2}{4} \\int_{-1}^{1} (\\xi+1) d\\xi = \\frac{\\pi}{2} \\int_{-1}^{1} (\\xi+1) d\\xi\n$$\nEvaluating the simple polynomial integral:\n$$\n\\int_{-1}^{1} (\\xi+1) d\\xi = \\left[ \\frac{\\xi^2}{2} + \\xi \\right]_{-1}^{1} = \\left( \\frac{1}{2} + 1 \\right) - \\left( \\frac{1}{2} - 1 \\right) = \\frac{3}{2} - \\left(-\\frac{1}{2}\\right) = 2\n$$\nFinally, we compute the value of $K_{11}$:\n$$\nK_{11} = \\frac{\\pi}{2} \\cdot 2 = \\pi\n$$\nThe weak form correctly handles the coordinate singularity at $r=0$ by including the weighting factor $r$, which approaches zero as the integration point approaches the axis, ensuring the integral is well-behaved.",
            "answer": "$$\n\\boxed{\\pi}\n$$"
        }
    ]
}