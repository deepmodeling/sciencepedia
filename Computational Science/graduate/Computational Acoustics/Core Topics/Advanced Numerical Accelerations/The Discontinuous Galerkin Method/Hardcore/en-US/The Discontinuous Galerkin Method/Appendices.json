{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of the Discontinuous Galerkin (DG) method, inherited from the broader finite element framework, is the use of a standard 'reference' element for all primary calculations. This modular approach dramatically simplifies implementation. This practice demonstrates the fundamental technique of mapping between a physical element in a computational mesh and this idealized reference element, exploring how the transformation systematically scales the local mass and stiffness matrices. Mastering this concept is the first step toward building a versatile and efficient DG solver capable of handling complex geometries.",
            "id": "4140399",
            "problem": "Consider the one-dimensional linear acoustics equations on a physical element $\\Omega_{e} = [x_{L}, x_{R}]$, and a polynomial basis $\\{\\hat{\\phi}_{i}(\\xi)\\}_{i=0}^{p}$ defined on the reference element $\\hat{\\Omega} = [-1, 1]$. In the Discontinuous Galerkin (DG) method, the local mass matrix $M^{(e)}$ and the local stiffness matrix $K^{(e)}$ on $\\Omega_{e}$ arise from the standard $L^{2}$ inner product and the $H^{1}$ seminorm bilinear form, respectively:\n$$\nM^{(e)}_{ij} = \\int_{\\Omega_{e}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx, \\qquad\nK^{(e)}_{ij} = \\int_{\\Omega_{e}} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,dx,\n$$\nwhere $\\phi_{i}(x)$ are the mapped basis functions defined by $\\phi_{i}(x) = \\hat{\\phi}_{i}(\\xi(x))$ via an affine mapping from $\\hat{\\Omega}$ to $\\Omega_{e}$.\n\nStarting from first principles—namely, the definition of an affine mapping, the change-of-variables formula for integrals, and the chain rule for differentiation—derive the affine mapping $x(\\xi)$ that sends $\\hat{\\Omega}$ to $\\Omega_{e}$ and define its Jacobian $J$. Use this mapping to express $M^{(e)}_{ij}$ and $K^{(e)}_{ij}$ in terms of integrals over $\\hat{\\Omega}$ and show that there exist constants $c_{M}$ and $c_{K}$, independent of the indices $i$ and $j$, such that\n$$\nM^{(e)}_{ij} = c_{M}\\,\\hat{M}_{ij}, \\qquad K^{(e)}_{ij} = c_{K}\\,\\hat{K}_{ij},\n$$\nwhere\n$$\n\\hat{M}_{ij} = \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi, \\qquad\n\\hat{K}_{ij} = \\int_{-1}^{1} \\partial_{\\xi}\\hat{\\phi}_{i}(\\xi)\\,\\partial_{\\xi}\\hat{\\phi}_{j}(\\xi)\\,d\\xi.\n$$\n\nAs a concrete check, take $p=1$ with the basis $\\hat{\\phi}_{0}(\\xi) = 1$ and $\\hat{\\phi}_{1}(\\xi) = \\xi$, compute the reference matrices $\\hat{M}$ and $\\hat{K}$ explicitly, and verify the scaling of the corresponding physical matrices $M^{(e)}$ and $K^{(e)}$ induced by the mapping.\n\nProvide, as your final answer, the pair of scaling factors $(c_{M}, c_{K})$ as a single row matrix in terms of the Jacobian $J$. No numerical rounding is required. The final answer must be a single closed-form analytic expression.",
            "solution": "The derivation proceeds by first establishing the affine mapping and its properties, then applying these properties to transform the integrals for the physical mass and stiffness matrices from the physical element $\\Omega_{e}$ to the reference element $\\hat{\\Omega}$.\n\n**1. Affine Mapping and Jacobian**\n\nAn affine mapping from the reference coordinate $\\xi$ to the physical coordinate $x$ is a linear function of the form:\n$$x(\\xi) = a\\xi + b$$\nThe constants $a$ and $b$ are determined by the requirement that the mapping sends the endpoints of the reference element $\\hat{\\Omega} = [-1, 1]$ to the endpoints of the physical element $\\Omega_{e} = [x_{L}, x_{R}]$.\nThis gives two conditions:\n1.  $x(-1) = x_{L} \\implies -a + b = x_{L}$\n2.  $x(1) = x_{R} \\implies a + b = x_{R}$\n\nThis is a system of two linear equations in $a$ and $b$. Adding the two equations yields:\n$$2b = x_{L} + x_{R} \\implies b = \\frac{x_{L} + x_{R}}{2}$$\nSubtracting the first equation from the second yields:\n$$2a = x_{R} - x_{L} \\implies a = \\frac{x_{R} - x_{L}}{2}$$\nThe mapping is therefore:\n$$x(\\xi) = \\left(\\frac{x_{R} - x_{L}}{2}\\right)\\xi + \\frac{x_{L} + x_{R}}{2}$$\nThe Jacobian of this transformation, denoted by $J$, is the derivative of $x$ with respect to $\\xi$:\n$$J = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi}\\left[ \\left(\\frac{x_{R} - x_{L}}{2}\\right)\\xi + \\frac{x_{L} + x_{R}}{2} \\right] = \\frac{x_{R} - x_{L}}{2}$$\nNote that since the mapping is affine, the Jacobian $J$ is a constant. The length of the physical element is $h_{e} = x_{R} - x_{L}$, so $J = \\frac{h_{e}}{2}$.\n\n**2. Transformation of the Mass Matrix**\n\nThe physical mass matrix $M^{(e)}$ is defined by the integral:\n$$M^{(e)}_{ij} = \\int_{\\Omega_{e}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx = \\int_{x_L}^{x_R} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$$\nWe apply the change-of-variables formula for integration. The differential element $dx$ transforms as $dx = \\frac{dx}{d\\xi}d\\xi = J\\,d\\xi$. The integration limits change from $[x_{L}, x_{R}]$ to $[-1, 1]$. The basis functions are related by $\\phi_{i}(x(\\xi)) = \\hat{\\phi}_{i}(\\xi)$.\nSubstituting these into the integral gives:\n$$M^{(e)}_{ij} = \\int_{-1}^{1} \\phi_{i}(x(\\xi))\\,\\phi_{j}(x(\\xi))\\,(J\\,d\\xi) = \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,J\\,d\\xi$$\nSince $J$ is a constant, it can be factored out of the integral:\n$$M^{(e)}_{ij} = J \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi$$\nThe remaining integral is the definition of the reference mass matrix entry, $\\hat{M}_{ij}$. Therefore:\n$$M^{(e)}_{ij} = J\\,\\hat{M}_{ij}$$\nThis shows that $c_{M} = J$.\n\n**3. Transformation of the Stiffness Matrix**\n\nThe physical stiffness matrix $K^{(e)}$ is defined by:\n$$K^{(e)}_{ij} = \\int_{\\Omega_{e}} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,dx = \\int_{x_L}^{x_R} \\frac{d\\phi_{i}}{dx}(x)\\,\\frac{d\\phi_{j}}{dx}(x)\\,dx$$\nFirst, we must transform the derivatives. Using the chain rule, the derivative with respect to $x$ can be expressed in terms of the derivative with respect to $\\xi$:\n$$\\frac{d\\phi_{i}}{dx} = \\frac{d\\hat{\\phi}_{i}}{d\\xi} \\frac{d\\xi}{dx}$$\nThe term $\\frac{d\\xi}{dx}$ is the inverse of the Jacobian $J=\\frac{dx}{d\\xi}$, so $\\frac{d\\xi}{dx} = \\frac{1}{J}$.\nThus, the derivative of the basis function is:\n$$\\frac{d\\phi_{i}}{dx}(x) = \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi(x))$$\nSubstituting this into the stiffness matrix integral:\n$$K^{(e)}_{ij} = \\int_{x_L}^{x_R} \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi(x)) \\right) \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi(x)) \\right) dx = \\frac{1}{J^2} \\int_{x_L}^{x_R} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi(x))\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi(x))\\,dx$$\nNow, we apply the same change of variables to the integral as before: $dx = J\\,d\\xi$ and the limits change to $[-1, 1]$.\n$$K^{(e)}_{ij} = \\frac{1}{J^2} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,(J\\,d\\xi)$$\nOne factor of $J$ cancels out:\n$$K^{(e)}_{ij} = \\frac{1}{J} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,d\\xi$$\nThe remaining integral is the definition of the reference stiffness matrix entry, $\\hat{K}_{ij}$. Therefore:\n$$K^{(e)}_{ij} = \\frac{1}{J}\\,\\hat{K}_{ij}$$\nThis shows that $c_{K} = \\frac{1}{J}$.\n\n**4. Concrete Check for $p=1$**\n\nFor $p=1$, the basis functions on the reference element are $\\hat{\\phi}_{0}(\\xi) = 1$ and $\\hat{\\phi}_{1}(\\xi) = \\xi$. Their derivatives are $\\partial_{\\xi}\\hat{\\phi}_{0}(\\xi) = 0$ and $\\partial_{\\xi}\\hat{\\phi}_{1}(\\xi) = 1$.\n\n-   **Reference Mass Matrix $\\hat{M}$**:\n    $$ \\hat{M}_{00} = \\int_{-1}^{1} (1)(1)\\,d\\xi = [\\xi]_{-1}^{1} = 2 $$\n    $$ \\hat{M}_{01} = \\hat{M}_{10} = \\int_{-1}^{1} (1)(\\xi)\\,d\\xi = \\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0 $$\n    $$ \\hat{M}_{11} = \\int_{-1}^{1} (\\xi)(\\xi)\\,d\\xi = \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3} $$\n    So, $\\hat{M} = \\begin{pmatrix} 2  0 \\\\ 0  2/3 \\end{pmatrix}$.\n\n-   **Reference Stiffness Matrix $\\hat{K}$**:\n    $$ \\hat{K}_{00} = \\int_{-1}^{1} (0)(0)\\,d\\xi = 0 $$\n    $$ \\hat{K}_{01} = \\hat{K}_{10} = \\int_{-1}^{1} (0)(1)\\,d\\xi = 0 $$\n    $$ \\hat{K}_{11} = \\int_{-1}^{1} (1)(1)\\,d\\xi = [\\xi]_{-1}^{1} = 2 $$\n    So, $\\hat{K} = \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix}$.\n\n-   **Verification of Scaling**:\n    The mapped basis functions are $\\phi_{0}(x) = 1$ and $\\phi_{1}(x) = \\xi(x) = \\frac{x-b}{J}$, where $b=\\frac{x_L+x_R}{2}$. Their derivatives are $\\partial_{x}\\phi_{0}(x) = 0$ and $\\partial_{x}\\phi_{1}(x) = \\frac{1}{J}$.\n    Let's compute an entry of $M^{(e)}$ directly:\n    $$ M^{(e)}_{00} = \\int_{x_L}^{x_R} (1)(1)\\,dx = x_{R} - x_{L} = 2J $$\n    According to our derived scaling, $M^{(e)}_{00} = c_M \\hat{M}_{00} = J \\cdot 2 = 2J$. This is verified.\n    Let's compute an entry of $K^{(e)}$ directly:\n    $$ K^{(e)}_{11} = \\int_{x_L}^{x_R} (\\partial_{x}\\phi_{1}(x))(\\partial_{x}\\phi_{1}(x))\\,dx = \\int_{x_L}^{x_R} \\left(\\frac{1}{J}\\right)^2\\,dx = \\frac{1}{J^2} (x_R-x_L) = \\frac{2J}{J^2} = \\frac{2}{J} $$\n    According to our derived scaling, $K^{(e)}_{11} = c_K \\hat{K}_{11} = \\frac{1}{J} \\cdot 2 = \\frac{2}{J}$. This is also verified. The concrete check confirms our derivation.\n\n**Conclusion**\n\nThe scaling factors relating the physical element matrices to the reference element matrices are $c_{M} = J$ and $c_{K} = \\frac{1}{J}$. The pair $(c_{M}, c_{K})$ is therefore $(J, \\frac{1}{J})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} J  \\frac{1}{J} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once computations are transformed to the reference element, we must choose a set of basis functions to represent our local solution. This choice has profound implications for the structure and efficiency of the numerical method. This exercise guides you through the construction of an orthonormal basis using Legendre polynomials and reveals its powerful consequence: the diagonalization of the elemental mass matrix, which simplifies the time-stepping scheme dramatically . This principle is central to the performance of 'modal' DG formulations, where the degrees of freedom are the coefficients of the basis functions.",
            "id": "4140406",
            "problem": "Consider the one-dimensional linear acoustics system posed on a single reference element $\\Omega_{\\mathrm{ref}}=[-1,1]$ within the Discontinuous Galerkin (DG) method framework. Let the approximation space on $\\Omega_{\\mathrm{ref}}$ be the span of polynomials up to degree $p$, and let the inner product be the standard $L^{2}$ inner product with unit weight, defined by $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,\\mathrm{d}x$. The elemental mass matrix is defined componentwise by $M_{ij}=\\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$, where $\\{\\phi_{n}\\}_{n=0}^{p}$ is a polynomial basis on $\\Omega_{\\mathrm{ref}}$.\n\nStarting from fundamental properties of polynomial approximation in $L^{2}([-1,1])$, construct an orthonormal basis on $\\Omega_{\\mathrm{ref}}$ by appropriately normalizing the classical Legendre polynomials $\\{P_{n}\\}_{n=0}^{p}$. Then, using the fact that Gauss–Legendre quadrature with $q$ points is exact for any polynomial integrand of degree up to $2q-1$, determine the exact diagonal entries of the mass matrix when the integral is evaluated by a Gauss–Legendre rule that is sufficiently rich to be exact for all products $\\phi_{i}\\phi_{j}$ with $i,j\\leq p$.\n\nYour derivation must begin from a valid approximation-theoretic base in computational acoustics and must clearly justify why the chosen normalization yields an orthonormal set in $L^{2}([-1,1])$ and why the diagonal mass matrix entries are reproduced exactly by the quadrature. Conclude by giving a single closed-form analytic expression for the normalized basis function $\\phi_{n}(x)$ and the corresponding diagonal mass entry $M_{nn}$, valid for any $n\\in\\{0,1,\\dots,p\\}$, assuming a Gauss–Legendre rule with $q=p+1$ points is used.\n\nExpress your final answer as a single row vector containing two entries, the general expression for $\\phi_{n}(x)$ and the corresponding $M_{nn}$. No numerical rounding is required, and no physical units apply.",
            "solution": "The problem requires the construction of an orthonormal polynomial basis on the reference interval $\\Omega_{\\mathrm{ref}} = [-1,1]$ and the subsequent determination of the diagonal entries of the corresponding mass matrix, where the matrix entries are computed using a specific Gauss-Legendre quadrature rule.\n\nThe framework is the $L^{2}$ space on the interval $[-1,1]$, denoted $L^{2}([-1,1])$, equipped with the inner product $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,\\mathrm{d}x$. We seek a basis $\\{\\phi_{n}\\}_{n=0}^{p}$ for the space of polynomials of degree up to $p$ that is orthonormal with respect to this inner product, meaning $\\langle \\phi_m, \\phi_n \\rangle = \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta.\n\nWe begin with the classical Legendre polynomials, $\\{P_{n}(x)\\}_{n=0}^{p}$. These polynomials form an orthogonal basis for the space of polynomials on $[-1,1]$. Their fundamental orthogonality property is given by:\n$$\n\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}\n$$\nThis property shows that for $m \\neq n$, the polynomials are orthogonal. For $m=n$, the integral gives the square of the $L^2$-norm of $P_n(x)$:\n$$\n\\|P_n\\|_{L^2}^2 = \\langle P_n, P_n \\rangle = \\int_{-1}^{1} P_n(x)^2 \\,\\mathrm{d}x = \\frac{2}{2n+1}\n$$\nTo construct an orthonormal basis $\\{\\phi_n\\}$, we must normalize the Legendre polynomials. An orthonormal function $\\phi_n(x)$ must have a unit norm, i.e., $\\|\\phi_n\\|_{L^2}=1$. We define our basis functions as $\\phi_n(x) = c_n P_n(x)$, where $c_n$ is a real-valued normalization constant. The condition for unit norm is:\n$$\n\\langle \\phi_n, \\phi_n \\rangle = \\langle c_n P_n, c_n P_n \\rangle = c_n^2 \\langle P_n, P_n \\rangle = 1\n$$\nSubstituting the known value of $\\langle P_n, P_n \\rangle$:\n$$\nc_n^2 \\left( \\frac{2}{2n+1} \\right) = 1\n$$\nSolving for $c_n$ (conventionally taking the positive root) gives the normalization constant:\n$$\nc_n = \\sqrt{\\frac{2n+1}{2}}\n$$\nTherefore, the first part of the answer, the expression for the orthonormal basis functions valid for any $n \\in \\{0, 1, \\dots, p\\}$, is:\n$$\n\\phi_n(x) = \\sqrt{\\frac{2n+1}{2}} P_n(x)\n$$\nBy this construction, the set $\\{\\phi_n(x)\\}_{n=0}^p$ is orthonormal on $\\Omega_{\\mathrm{ref}}=[-1,1]$.\n\nNext, we consider the elemental mass matrix $M$, whose entries are defined by $M_{ij} = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x$. By the definition of the inner product, this is $M_{ij} = \\langle \\phi_i, \\phi_j \\rangle$. Since the basis $\\{\\phi_n\\}$ is orthonormal, the exact analytical value of the mass matrix entries is:\n$$\nM_{ij} = \\langle \\phi_i, \\phi_j \\rangle = \\delta_{ij}\n$$\nThis means the exact mass matrix is the identity matrix, and its diagonal entries are $M_{nn} = 1$ for all $n$.\n\nThe problem states that the integral for the mass matrix is evaluated numerically using a Gauss-Legendre quadrature rule. Let the numerically computed mass matrix be denoted by $M^h$. A Gauss-Legendre rule with $q$ points approximates an integral as $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{k=1}^{q} w_k f(x_k)$, where $x_k$ are the quadrature nodes and $w_k$ are the corresponding weights. A key property of this rule is that it is exact for any polynomial integrand of degree up to $2q-1$.\n\nThe integrand for the mass matrix entry $M_{ij}$ is the product $\\phi_i(x)\\phi_j(x)$. Since $\\phi_n(x)$ is a polynomial of degree $n$, the product $\\phi_i(x)\\phi_j(x)$ is a polynomial of degree $i+j$. In the context of a polynomial approximation space of degree $p$, the indices $i$ and $j$ range from $0$ to $p$. The maximum possible degree of the integrand is for $i=j=p$, which is $p+p=2p$.\n\nThe problem specifies the use of a Gauss-Legendre rule with $q=p+1$ points. The degree of exactness for this rule is $2q-1 = 2(p+1)-1 = 2p+1$. Since the maximum degree of any integrand $\\phi_i(x)\\phi_j(x)$ is $2p$, and $2p+1 \\geq 2p$, the chosen quadrature rule is sufficiently rich to integrate every product $\\phi_i(x)\\phi_j(x)$ exactly for all $i,j \\in \\{0, 1, \\dots, p\\}$.\n\nThis implies that the numerically computed mass matrix is identical to the exact analytical mass matrix:\n$$\nM^h_{ij} = \\sum_{k=1}^{p+1} w_k \\phi_i(x_k)\\phi_j(x_k) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x = M_{ij} = \\delta_{ij}\n$$\nConsequently, the diagonal entries of the mass matrix computed with this quadrature rule are exactly:\n$$\nM_{nn} = 1\n$$\nThis holds for any $n \\in \\{0, 1, \\dots, p\\}$, and it is the second part of the required answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{2n+1}{2}} P_n(x)  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having established the geometric mapping and the local approximation basis, we can now tackle the full spatial discretization of a partial differential equation. This culminating practice walks through the entire DG process for the canonical 1D linear advection equation, $u_{t} + c\\,u_{x} = 0$. You will derive the weak form, perform integration by parts, and critically, introduce the numerical flux that couples adjacent elements—the defining feature of the DG method. The final result is a semi-discrete system of ordinary differential equations, the tangible output of a DG spatial discretization ready for a time integration scheme.",
            "id": "4140358",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + c\\,u_{x} = 0$ on a periodic interval $[0,L]$ with constant wave speed $c0$. Partition the domain into $N$ uniform elements $\\{K_{e}\\}_{e=1}^{N}$ of size $h=L/N$, and on each element map the reference coordinate $\\xi \\in [-1,1]$ to the physical coordinate via $x(\\xi) = x_{e} + \\frac{h}{2}\\,\\xi$. Seek a Discontinuous Galerkin (DG) approximation, which employs element-wise discontinuous trial and test spaces, of the form $u_{h}|_{K_{e}}(x(\\xi),t) = \\sum_{i=1}^{2} U_{e,i}(t)\\,\\ell_{i}(\\xi)$ with local nodal basis functions $\\ell_{1}(\\xi) = \\frac{1-\\xi}{2}$ and $\\ell_{2}(\\xi) = \\frac{1+\\xi}{2}$. Use the same basis for the test functions. Start from the conservation form $u_{t} + (c u)_{x} = 0$, derive the weak form on $K_{e}$, integrate the flux term by parts, and enforce inter-element coupling with the upwind numerical flux $\\widehat{f}(u^{-},u^{+}) = c\\,u^{-}$, where $u^{-}$ denotes the value taken from the left of an interface. \n\n(a) Derive the semi-discrete element-wise system in the form $M_{e}\\,\\dot{\\boldsymbol{U}}_{e} = c\\,S_{e}\\,\\boldsymbol{U}_{e} - c\\,\\boldsymbol{b}_{e}$, where $\\boldsymbol{U}_{e} = (U_{e,1},U_{e,2})^{\\top}$, and identify explicitly the element mass matrix $M_{e}$, the element volume (derivative) matrix $S_{e}$, and the surface flux contribution $\\boldsymbol{b}_{e}$ in terms of traces at the left and right faces of $K_{e}$. \n\n(b) Specialize $\\boldsymbol{b}_{e}$ using the upwind rule for $c0$ to eliminate numerical traces in favor of degrees of freedom from $K_{e}$ and its immediate left neighbor $K_{e-1}$. \n\n(c) Multiply by $M_{e}^{-1}$ to write $\\dot{\\boldsymbol{U}}_{e}$ as a linear operator applied to the vector $(U_{e-1,2},\\,U_{e,1},\\,U_{e,2})^{\\top}$. Report the final compact $2\\times 3$ operator matrix $A_{e}$ such that $\\dot{\\boldsymbol{U}}_{e} = A_{e}\\,(U_{e-1,2},\\,U_{e,1},\\,U_{e,2})^{\\top}$, expressed symbolically in terms of $c$ and $h$. \n\nYour final answer must be the single analytic expression for this $2\\times 3$ matrix. No rounding is required and no units are necessary.",
            "solution": "We start from the conservation law $u_t + (cu)_x = 0$. The DG weak formulation on an element $K_e$ is obtained by multiplying by a test function $v_h$ and integrating by parts:\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - \\int_{K_e} c u_h \\frac{\\partial v_h}{\\partial x} \\,dx + \\left[ \\widehat{cu_h} v_h \\right]_{\\partial K_e} = 0\n$$\nwhere $\\widehat{cu_h}$ is the numerical flux. Let $x_{e \\pm 1/2}$ be the right and left boundaries of element $K_e$. The boundary term expands to $\\widehat{cu_h}(x_{e+1/2}) v_h(x_{e+1/2}^-) - \\widehat{cu_h}(x_{e-1/2}) v_h(x_{e-1/2}^+)$.\nWe substitute the basis expansion $u_h(x,t) = \\sum_{j=1}^2 U_{e,j}(t)\\ell_j(\\xi(x))$ and use test functions $v_h = \\ell_i(\\xi(x))$. This yields a system for the coefficients $\\boldsymbol{U}_e = (U_{e,1}, U_{e,2})^\\top$.\n$$\n\\sum_j \\left(\\int_{K_e} \\ell_i \\ell_j dx\\right) \\dot{U}_{e,j} = \\sum_j \\left(c \\int_{K_e} \\ell_j \\frac{d\\ell_i}{dx} dx\\right) U_{e,j} - \\left( \\widehat{cu_h}(x_{e+1/2}) \\ell_i(x_{e+1/2}) - \\widehat{cu_h}(x_{e-1/2}) \\ell_i(x_{e-1/2}) \\right)\n$$\nThis is the semi-discrete system $M_e \\dot{\\boldsymbol{U}}_e = c S_e \\boldsymbol{U}_e - c \\boldsymbol{b}_e$.\n\n**(a) Derivation of Matrices**\n\nWe transform to the reference element $\\xi \\in [-1,1]$ using $dx = (h/2)d\\xi$ and $d/dx = (2/h)d/d\\xi$.\nThe **mass matrix** $M_e$ has entries $M_{e,ij} = \\int_{K_e} \\ell_i \\ell_j dx = \\frac{h}{2} \\int_{-1}^1 \\ell_i(\\xi) \\ell_j(\\xi) d\\xi$.\n$$ M_{e,11} = \\frac{h}{2} \\int_{-1}^1 \\left(\\frac{1-\\xi}{2}\\right)^2 d\\xi = \\frac{h}{6}, \\quad M_{e,22} = \\frac{h}{6}, \\quad M_{e,12} = \\frac{h}{2} \\int_{-1}^1 \\frac{1-\\xi^2}{4} d\\xi = \\frac{h}{12} $$\nSo, $M_e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$.\n\nThe **volume matrix** $S_e$ has entries $S_{e,ij} = \\int_{K_e} \\ell_j \\frac{d\\ell_i}{dx} dx = \\int_{-1}^1 \\ell_j(\\xi) \\frac{d\\ell_i}{d\\xi}(\\xi) d\\xi$. With $\\ell'_1 = -1/2$ and $\\ell'_2 = 1/2$:\n$$ S_{e,11} = \\int_{-1}^1 \\ell_1 \\ell'_1 d\\xi = -1/2, \\quad S_{e,12} = \\int_{-1}^1 \\ell_2 \\ell'_1 d\\xi = -1/2 $$\n$$ S_{e,21} = \\int_{-1}^1 \\ell_1 \\ell'_2 d\\xi = 1/2, \\quad S_{e,22} = \\int_{-1}^1 \\ell_2 \\ell'_2 d\\xi = 1/2 $$\nSo, $S_e = \\frac{1}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}$.\n\nThe **surface flux contribution** $\\boldsymbol{b}_e$ comes from the boundary term.\nThe $i$-th component of $c\\boldsymbol{b}_e$ is $\\widehat{cu_h}(x_{e+1/2}) \\ell_i(1) - \\widehat{cu_h}(x_{e-1/2}) \\ell_i(-1)$.\nFor $i=1$: $\\widehat{cu_h}(x_{e+1/2})\\cdot 0 - \\widehat{cu_h}(x_{e-1/2})\\cdot 1 = -\\widehat{cu_h}(x_{e-1/2})$.\nFor $i=2$: $\\widehat{cu_h}(x_{e+1/2})\\cdot 1 - \\widehat{cu_h}(x_{e-1/2})\\cdot 0 = \\widehat{cu_h}(x_{e+1/2})$.\nThus, $\\boldsymbol{b}_e = \\begin{pmatrix} -\\widehat{u_h}(x_{e-1/2}) \\\\ \\widehat{u_h}(x_{e+1/2}) \\end{pmatrix}$.\n\n**(b) Specialization for Upwind Flux**\n\nFor $c>0$, the upwind flux is $\\widehat{u_h} = u_h^-$.\nAt the left face $x_{e-1/2}$, the upwind value comes from the right node of element $K_{e-1}$: $\\widehat{u_h}(x_{e-1/2}) = u_h|_{K_{e-1}}(x_{e-1/2},t) = U_{e-1,2}$.\nAt the right face $x_{e+1/2}$, the upwind value comes from the right node of element $K_e$: $\\widehat{u_h}(x_{e+1/2}) = u_h|_{K_e}(x_{e+1/2},t) = U_{e,2}$.\nSubstituting these into $\\boldsymbol{b}_e$ gives $\\boldsymbol{b}_e = \\begin{pmatrix} -U_{e-1,2} \\\\ U_{e,2} \\end{pmatrix}$.\n\n**(c) Derivation of Final Operator Matrix**\n\nThe semi-discrete system is:\n$$\n\\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\dot{\\boldsymbol{U}}_e = \\frac{c}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} \\boldsymbol{U}_e - c \\begin{pmatrix} -U_{e-1,2} \\\\ U_{e,2} \\end{pmatrix}\n$$\nFirst, we find the inverse of the mass matrix:\n$$ M_e^{-1} = \\left(\\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\\right)^{-1} = \\frac{6}{h} \\frac{1}{3} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\frac{2}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\nNow, multiply the system by $M_e^{-1}$ to get $\\dot{\\boldsymbol{U}}_e$:\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{2}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\left( \\frac{c}{2} \\begin{pmatrix} -U_{e,1} - U_{e,2} \\\\ U_{e,1} + U_{e,2} \\end{pmatrix} + c \\begin{pmatrix} U_{e-1,2} \\\\ -U_{e,2} \\end{pmatrix} \\right)\n$$\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} -U_{e,1} - U_{e,2} + 2U_{e-1,2} \\\\ U_{e,1} + U_{e,2} - 2U_{e,2} \\end{pmatrix} = \\frac{c}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 2U_{e-1,2} - U_{e,1} - U_{e,2} \\\\ U_{e,1} - U_{e,2} \\end{pmatrix}\n$$\nPerforming the final matrix multiplication:\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\begin{pmatrix} 2(2U_{e-1,2} - U_{e,1} - U_{e,2}) - (U_{e,1} - U_{e,2}) \\\\ -(2U_{e-1,2} - U_{e,1} - U_{e,2}) + 2(U_{e,1} - U_{e,2}) \\end{pmatrix}\n$$\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\begin{pmatrix} 4U_{e-1,2} - 2U_{e,1} - 2U_{e,2} - U_{e,1} + U_{e,2} \\\\ -2U_{e-1,2} + U_{e,1} + U_{e,2} + 2U_{e,1} - 2U_{e,2} \\end{pmatrix}\n$$\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\begin{pmatrix} 4U_{e-1,2} - 3U_{e,1} - U_{e,2} \\\\ -2U_{e-1,2} + 3U_{e,1} - U_{e,2} \\end{pmatrix}\n$$\nThis can be written as $\\dot{\\boldsymbol{U}}_{e} = A_{e}\\,(U_{e-1,2},\\,U_{e,1},\\,U_{e,2})^{\\top}$, where the operator matrix $A_e$ is:\n$$\nA_e = \\frac{c}{h} \\begin{pmatrix} 4  -3  -1 \\\\ -2  3  -1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\frac{c}{h} \\begin{pmatrix} 4  -3  -1 \\\\ -2  3  -1 \\end{pmatrix}}\n$$"
        }
    ]
}