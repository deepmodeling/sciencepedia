{
    "hands_on_practices": [
        {
            "introduction": "The efficiency of iterative domain decomposition methods is deeply connected to the underlying wave physics at the subdomain interfaces. This first exercise provides a foundational understanding by analyzing the classic problem of a plane wave interacting with a material interface. By deriving the reflection and transmission coefficients, you will uncover the direct link between acoustic impedance matching and the convergence of iterative schemes, providing a crucial physical intuition for designing effective transmission conditions .",
            "id": "4121192",
            "problem": "Consider linear, time-harmonic acoustics governed by the linearized momentum and continuity equations in one spatial dimension $x$, with angular frequency $\\omega$, material density $\\rho$, and speed of sound $c$. The acoustic impedance is defined as $Z=\\rho c$. Two homogeneous subdomains $\\Omega_{1}$ and $\\Omega_{2}$ occupy $x0$ and $x0$, respectively, and meet at a flat interface located at $x=0$. Each subdomain is characterized by a constant impedance, denoted $Z_{1}$ in $\\Omega_{1}$ and $Z_{2}$ in $\\Omega_{2}$. A plane acoustic wave of complex pressure amplitude $A$ is incident from $\\Omega_{1}$ onto the interface at $x=0$, producing a reflected wave in $\\Omega_{1}$ and a transmitted wave in $\\Omega_{2}$. The interface enforces continuity of pressure and continuity of normal particle velocity.\n\nStarting from the fundamental governing equations and the definition of acoustic impedance, derive the dimensionless complex amplitude reflection coefficient $R$ and transmission coefficient $T$ for the pressure field at normal incidence, expressed as ratios of reflected and transmitted complex pressure amplitudes to the incident complex pressure amplitude. Then, interpret how these coefficients influence the convergence of iterative Domain Decomposition (DD) methods that use impedance-type (Robin) transmission conditions, with particular attention to how impedance matching affects error propagation across the interface.\n\nYour final answer must be the pair of symbolic expressions for $R$ and $T$ in terms of $Z_{1}$ and $Z_{2}$, written as a single row matrix. No numerical evaluation or rounding is required. The coefficients are dimensionless and must be expressed as closed-form analytic expressions.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of wave acoustics, well-posed with sufficient conditions for a unique solution, and objectively formulated. We shall proceed with the derivation and interpretation.\n\nThe problem considers linear, time-harmonic acoustic waves. The governing equations for the complex amplitude of pressure, $\\hat{p}(x)$, and normal particle velocity, $\\hat{v}(x)$, assuming a time-dependence of $\\exp(j\\omega t)$, are the linearized momentum and continuity equations in one dimension:\n$$j\\omega\\rho \\hat{v} = -\\frac{d\\hat{p}}{dx} \\quad (\\text{Momentum})$$\n$$\\frac{j\\omega}{\\rho c^2} \\hat{p} = -\\frac{d\\hat{v}}{dx} \\quad (\\text{Continuity})$$\nCombining these two first-order equations yields the second-order Helmholtz equation for pressure:\n$$\\frac{d^2\\hat{p}}{dx^2} + k^2 \\hat{p} = 0$$\nwhere $k = \\omega/c$ is the wavenumber.\n\nIn the subdomain $\\Omega_1 = \\{x | x  0\\}$, the total pressure field $\\hat{p}_1(x)$ is the superposition of an incident plane wave traveling in the $+x$ direction and a reflected plane wave traveling in the $-x$ direction. The incident wave has a complex pressure amplitude $A$. Let the reflected wave have a complex pressure amplitude $B$.\n$$\\hat{p}_1(x) = A \\exp(-jk_1 x) + B \\exp(jk_1 x)$$\nHere, $k_1 = \\omega/c_1$ is the wavenumber in $\\Omega_1$.\n\nIn the subdomain $\\Omega_2 = \\{x | x  0\\}$, the pressure field $\\hat{p}_2(x)$ consists only of a transmitted plane wave traveling in the $+x$ direction, as there are no sources at $x=+\\infty$. Let its complex pressure amplitude be $C$.\n$$\\hat{p}_2(x) = C \\exp(-jk_2 x)$$\nHere, $k_2 = \\omega/c_2$ is the wavenumber in $\\Omega_2$.\n\nNext, we derive the expression for the particle velocity $\\hat{v}$ in each subdomain using the momentum equation, $\\hat{v} = \\frac{j}{\\omega\\rho} \\frac{d\\hat{p}}{dx}$.\nFor $\\Omega_1$:\n$$\\hat{v}_1(x) = \\frac{j}{\\omega\\rho_1} \\frac{d}{dx} \\left( A \\exp(-jk_1 x) + B \\exp(jk_1 x) \\right)$$\n$$\\hat{v}_1(x) = \\frac{j}{\\omega\\rho_1} \\left( -jk_1 A \\exp(-jk_1 x) + jk_1 B \\exp(jk_1 x) \\right)$$\n$$\\hat{v}_1(x) = \\frac{k_1}{\\omega\\rho_1} \\left( A \\exp(-jk_1 x) - B \\exp(jk_1 x) \\right)$$\nUsing $k_1 = \\omega/c_1$ and the definition of acoustic impedance $Z_1=\\rho_1 c_1$, we get:\n$$\\hat{v}_1(x) = \\frac{1}{\\rho_1 c_1} \\left( A \\exp(-jk_1 x) - B \\exp(jk_1 x) \\right) = \\frac{1}{Z_1} \\left( A \\exp(-jk_1 x) - B \\exp(jk_1 x) \\right)$$\n\nFor $\\Omega_2$:\n$$\\hat{v}_2(x) = \\frac{j}{\\omega\\rho_2} \\frac{d}{dx} \\left( C \\exp(-jk_2 x) \\right)$$\n$$\\hat{v}_2(x) = \\frac{j}{\\omega\\rho_2} \\left( -jk_2 C \\exp(-jk_2 x) \\right)$$\n$$\\hat{v}_2(x) = \\frac{k_2}{\\omega\\rho_2} C \\exp(-jk_2 x)$$\nUsing $k_2 = \\omega/c_2$ and $Z_2=\\rho_2 c_2$:\n$$\\hat{v}_2(x) = \\frac{1}{\\rho_2 c_2} C \\exp(-jk_2 x) = \\frac{1}{Z_2} C \\exp(-jk_2 x)$$\n\nAt the interface $x=0$, we apply the two continuity conditions:\n1.  Continuity of pressure: $\\hat{p}_1(0) = \\hat{p}_2(0)$\n    $$A \\exp(0) + B \\exp(0) = C \\exp(0) \\implies A + B = C \\quad (Eq. 1)$$\n2.  Continuity of normal particle velocity: $\\hat{v}_1(0) = \\hat{v}_2(0)$\n    $$\\frac{1}{Z_1} (A \\exp(0) - B \\exp(0)) = \\frac{1}{Z_2} C \\exp(0) \\implies \\frac{1}{Z_1}(A-B) = \\frac{C}{Z_2} \\quad (Eq. 2)$$\n\nWe now solve this system of two linear equations for the unknown amplitudes $B$ and $C$ in terms of the known incident amplitude $A$. The desired coefficients are the ratios $R = B/A$ and $T = C/A$.\nSubstitute $C$ from $Eq. 1$ into $Eq. 2$:\n$$\\frac{1}{Z_1}(A-B) = \\frac{A+B}{Z_2}$$\n$$Z_2(A-B) = Z_1(A+B)$$\n$$Z_2 A - Z_2 B = Z_1 A + Z_1 B$$\nRearrange to solve for $B$:\n$$Z_2 A - Z_1 A = Z_1 B + Z_2 B$$\n$$A (Z_2 - Z_1) = B (Z_1 + Z_2)$$\n$$B = A \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\nThe pressure reflection coefficient $R$ is therefore:\n$$R = \\frac{B}{A} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\n\nTo find the transmission coefficient $T$, we substitute the expression for $B$ back into $Eq. 1$:\n$$C = A + B = A + A \\frac{Z_2 - Z_1}{Z_2 + Z_1} = A \\left( 1 + \\frac{Z_2 - Z_1}{Z_2 + Z_1} \\right)$$\n$$C = A \\left( \\frac{Z_2 + Z_1 + Z_2 - Z_1}{Z_2 + Z_1} \\right) = A \\frac{2Z_2}{Z_1+Z_2}$$\nThe pressure transmission coefficient $T$ is therefore:\n$$T = \\frac{C}{A} = \\frac{2Z_2}{Z_1 + Z_2}$$\n\nInterpretation for Domain Decomposition (DD) Methods:\nIn iterative DD methods, such as the Schwarz method, a global problem domain is decomposed into smaller subdomains ($\\Omega_1, \\Omega_2$). The solution is found by iteratively solving the problem on each subdomain and exchanging information across the interface ($x=0$). This information exchange is governed by transmission conditions (TCs).\n\nThe continuity conditions for pressure and velocity are the exact TCs. An impedance-based (Robin) TC for the problem in $\\Omega_1$ at $x=0$ can be derived from the physics of $\\Omega_2$. For a wave propagating into $\\Omega_2$, the relationship between pressure and velocity at the interface is $\\hat{p}_2(0) = Z_2 \\hat{v}_2(0)$. Using the continuity conditions at $x=0$, this means $\\hat{p}_1(0) = Z_2 \\hat{v}_1(0)$. From the momentum equation in $\\Omega_1$, we have $\\frac{d\\hat{p}_1}{dx} = -j\\omega\\rho_1 \\hat{v}_1$. Substituting for $\\hat{v}_1$, we get the TC applied at $x=0$ for the field in $\\Omega_1$:\n$$\\frac{d\\hat{p}_1}{dx} = -\\frac{j\\omega\\rho_1}{Z_2}\\hat{p}_1 \\implies \\frac{d\\hat{p}_1}{dx} + \\frac{j\\omega\\rho_1}{Z_2}\\hat{p}_1 = 0$$\nThis is a Robin-type condition where the impedance $Z_2$ of the neighboring domain appears.\n\nThe convergence of iterative DD solvers is directly related to how errors propagate across the interface. An error at the interface can be viewed as an outgoing wave from one subdomain. The reflection coefficient $R$ quantifies how much of this error wave is reflected back into the same subdomain, and the transmission coefficient $T$ quantifies how much is passed to the next.\n\nThe convergence factor of a simple Schwarz iteration between two domains is precisely the reflection coefficient $R$. For the iterative process to converge, the magnitude of the error must decrease at each step. This means the magnitude of the convergence factor, $|R|$, must be less than $1$.\n$$|R| = \\left| \\frac{Z_2 - Z_1}{Z_2 + Z_1} \\right|  1$$\nThis inequality holds true as long as $Z_1$ and $Z_2$ are positive real numbers, which they are for non-dissipative media.\n\nThe effect of impedance matching is critical:\n- **Perfect Impedance Matching ($Z_2 = Z_1$)**: In this case, $R = \\frac{Z_1-Z_1}{Z_1+Z_1} = 0$. There is no reflection at the interface. An error wave incident on the boundary is perfectly transmitted into the adjacent domain and is not reflected back. This means the TC is perfectly absorbing. An iterative DD method converges extremely fast, theoretically in a finite number of steps (one per subdomain, per direction of propagation), as there is no feedback of the error into the originating subdomain.\n- **Impedance Mismatch ($Z_2 \\neq Z_1$)**: Here, $|R|  0$. A non-zero fraction of the error wave is reflected back into the originating subdomain at each iteration. This reflected error contaminates the solution in the next iteration and slows down convergence. The greater the mismatch between $Z_1$ and $Z_2$, the closer $|R|$ is to $1$. If $Z_2 \\gg Z_1$ or $Z_1 \\gg Z_2$, then $|R| \\to 1$. A reflection coefficient with magnitude close to $1$ implies that most of the error is reflected back, leading to very slow convergence or stagnation of the iterative scheme.\n\nIn summary, the reflection coefficient $R$ derived from the physical properties of the subdomains acts as a direct measure of the convergence rate of iterative DD methods. Minimizing $|R|$ by designing TCs that accurately approximate the impedance of the neighboring domain is the key to developing efficient and rapidly converging DD solvers for wave propagation problems.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Z_2 - Z_1}{Z_2 + Z_1}  \\frac{2Z_2}{Z_1 + Z_2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the physical intuition of wave reflection, we now move to the formal mathematical language used to analyze and construct domain decomposition methods. This practice introduces the powerful concept of Dirichlet-to-Neumann ($DtN$) maps, which encapsulate the behavior of a subdomain as seen from its boundary. You will derive the iteration operator for the classic Dirichlet-Neumann method, learning how the convergence of the algorithm is governed by the algebraic properties of these interface operators .",
            "id": "4121200",
            "problem": "Consider the time-harmonic acoustic field governed by the Helmholtz equation on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with a non-overlapping partition $\\Omega = \\Omega_{1} \\cup \\Omega_{2}$ and interface $\\Gamma = \\overline{\\Omega}_{1} \\cap \\overline{\\Omega}_{2}$. Let the outward unit normal on $\\partial \\Omega_{i}$ be $\\boldsymbol{n}_{i}$, so that on $\\Gamma$ one has $\\boldsymbol{n}_{2} = - \\boldsymbol{n}_{1}$. Assume homogeneous, well-posed boundary conditions on $\\partial \\Omega \\setminus \\Gamma$ and zero volumetric sources so that subproblems are uniquely solvable. In each subdomain, the field $u_{i}$ satisfies\n$$\n-\\Delta u_{i} - k^{2} u_{i} = 0 \\quad \\text{in } \\Omega_{i},\n$$\nwith wavenumber $k \\in \\mathbb{C}$ such that the subproblems are well-posed. Define the local Dirichlet-to-Neumann map $\\Lambda_{i}$ by: for any Dirichlet trace $\\varphi$ on $\\Gamma$, let $u_{i}$ solve the subproblem in $\\Omega_{i}$ with boundary data $u_{i}\\rvert_{\\Gamma} = \\varphi$, and set\n$$\n\\Lambda_{i} \\varphi := \\partial_{\\boldsymbol{n}_{i}} u_{i} \\rvert_{\\Gamma}.\n$$\nConsider the classical Dirichlet–Neumann iterative method with relaxation parameter $\\omega \\in \\mathbb{R}$: given an iterate $g^{(m)}$ for the Dirichlet trace on $\\Gamma$ from the $\\Omega_{1}$ side, solve in $\\Omega_{1}$ with $u_{1}\\rvert_{\\Gamma} = g^{(m)}$, extract the flux $\\partial_{\\boldsymbol{n}_{1}} u_{1}\\rvert_{\\Gamma}$, impose on $\\Omega_{2}$ the Neumann condition $\\partial_{\\boldsymbol{n}_{2}} u_{2}\\rvert_{\\Gamma} = - \\partial_{\\boldsymbol{n}_{1}} u_{1}\\rvert_{\\Gamma}$, solve in $\\Omega_{2}$, take the resulting Dirichlet trace on $\\Gamma$, and under-relax to form the next iterate\n$$\ng^{(m+1)} = (1 - \\omega) \\, g^{(m)} + \\omega \\, \\big(u_{2}\\rvert_{\\Gamma}\\big).\n$$\nAssuming that $\\Lambda_{2}$ is invertible as a map on interface traces, derive the fixed-point iteration matrix $M_{\\omega}$ acting on the interface trace such that $g^{(m+1)} = M_{\\omega} \\, g^{(m)}$. Express $M_{\\omega}$ solely in terms of $\\Lambda_{1}$, $\\Lambda_{2}$, the identity operator $I$ on interface traces, and the scalar $\\omega$. Your final answer must be a single closed-form analytic expression for $M_{\\omega}$, with no additional commentary.",
            "solution": "We begin from the governing equation in each subdomain $\\Omega_{i}$:\n$$\n-\\Delta u_{i} - k^{2} u_{i} = 0 \\quad \\text{in } \\Omega_{i},\n$$\nwith homogeneous, well-posed boundary conditions on $\\partial \\Omega \\setminus \\Gamma$ and zero volumetric forcing. The outward unit normal vectors satisfy $\\boldsymbol{n}_{2} = - \\boldsymbol{n}_{1}$ on $\\Gamma$.\n\nBy definition of the Dirichlet-to-Neumann map (abbreviated as DtN), for any Dirichlet trace $\\varphi$ on $\\Gamma$, the solution $u_{i}$ of the subproblem in $\\Omega_{i}$ with $u_{i}\\rvert_{\\Gamma} = \\varphi$ has normal derivative trace\n$$\n\\Lambda_{i} \\varphi = \\partial_{\\boldsymbol{n}_{i}} u_{i} \\rvert_{\\Gamma}.\n$$\n\nThe Dirichlet–Neumann iteration proceeds as follows. Given $g^{(m)}$ as the Dirichlet trace on $\\Gamma$ from the $\\Omega_{1}$ side, we solve in $\\Omega_{1}$ with $u_{1}\\rvert_{\\Gamma} = g^{(m)}$. The resulting outward normal derivative on $\\Gamma$ from $\\Omega_{1}$ is\n$$\nq_{1}^{(m)} := \\partial_{\\boldsymbol{n}_{1}} u_{1}\\rvert_{\\Gamma} = \\Lambda_{1} g^{(m)}.\n$$\nImposing continuity of the normal flux with respect to the global outward normals yields on $\\Gamma$\n$$\n\\partial_{\\boldsymbol{n}_{2}} u_{2}\\rvert_{\\Gamma} = - \\partial_{\\boldsymbol{n}_{1}} u_{1}\\rvert_{\\Gamma} = - q_{1}^{(m)}.\n$$\nTo obtain the Dirichlet trace on $\\Gamma$ from the $\\Omega_{2}$ side corresponding to this Neumann data, we use the Neumann-to-Dirichlet map in $\\Omega_{2}$. Under the assumption that $\\Lambda_{2}$ is invertible on the appropriate trace space, the Neumann-to-Dirichlet map is $\\Lambda_{2}^{-1}$. Therefore, the Dirichlet trace on $\\Gamma$ produced by the $\\Omega_{2}$ solve is\n$$\nu_{2}\\rvert_{\\Gamma} = \\Lambda_{2}^{-1}\\big( \\partial_{\\boldsymbol{n}_{2}} u_{2}\\rvert_{\\Gamma} \\big) = \\Lambda_{2}^{-1} \\big( - q_{1}^{(m)} \\big) = - \\Lambda_{2}^{-1} \\Lambda_{1} g^{(m)}.\n$$\n\nThe relaxed update of the Dirichlet trace is prescribed as\n$$\ng^{(m+1)} = (1 - \\omega) \\, g^{(m)} + \\omega \\, \\big( u_{2}\\rvert_{\\Gamma} \\big).\n$$\nSubstituting the expression for $u_{2}\\rvert_{\\Gamma}$ in terms of $g^{(m)}$ gives\n$$\ng^{(m+1)} = (1 - \\omega) \\, g^{(m)} + \\omega \\, \\big( - \\Lambda_{2}^{-1} \\Lambda_{1} g^{(m)} \\big)\n= \\Big[ (1 - \\omega) I - \\omega \\, \\Lambda_{2}^{-1} \\Lambda_{1} \\Big] g^{(m)}.\n$$\nHence, the fixed-point iteration matrix (operator) $M_{\\omega}$ acting on the interface Dirichlet trace is\n$$\nM_{\\omega} = (1 - \\omega) I - \\omega \\, \\Lambda_{2}^{-1} \\Lambda_{1}.\n$$\nThis expression incorporates the interface coupling through the sign that arises from the opposing outward normals on $\\Gamma$ and is written entirely in terms of the local Dirichlet-to-Neumann maps, the identity, and the relaxation parameter.",
            "answer": "$$\\boxed{(1-\\omega)\\,I-\\omega\\,\\Lambda_{2}^{-1}\\Lambda_{1}$$}"
        },
        {
            "introduction": "This final practice bridges theory and computation by applying domain decomposition principles to a practical fluid-structure interaction (FSI) problem. In this exercise, you will computationally construct the discrete interface system, also known as the Schur complement, which is the heart of many DDM solvers. Furthermore, you will investigate the role of preconditioning, a critical technique for making DDM solvers efficient for large-scale, real-world applications .",
            "id": "4121247",
            "problem": "You are given a one-dimensional frequency-domain model of a coupled acoustic fluid and a flexural plate, and your task is to formulate and compute the discrete interface operator arising from domain decomposition and to propose and assess a block preconditioner that decouples fluid and structure contributions for efficient iterations. The derivation must start from the following fundamental base and physical laws: the linearized acoustic wave equation in the frequency domain and the Euler–Bernoulli plate balance in the frequency domain.\n\nThe acoustic fluid in one spatial dimension has pressure field $p(x)$ governed by the Helmholtz equation\n$$\n\\frac{d^2 p}{dx^2} + k^2 p = 0,\n$$\nwhere $k = \\omega / c$ is the wavenumber, $\\omega$ is the angular frequency in radians per second, and $c$ is the sound speed in meters per second. The fluid density is $\\rho$ in kilograms per cubic meter. The domain is the interval $[0,L_f]$ with $x=0$ as the interface with the plate and $x=L_f$ as an artificial boundary with a first-order absorbing condition. At the interface $x=0$, the continuity of normal acceleration imposes a Neumann boundary condition\n$$\n\\frac{dp}{dx}\\bigg|_{x=0} = \\rho \\, \\omega^2 \\, u,\n$$\nwhere $u$ is the plate transverse displacement at the interface. At $x=L_f$, impose the local absorbing (Sommerfeld-type) condition\n$$\n\\frac{dp}{dx}\\bigg|_{x=L_f} = i k \\, p(L_f),\n$$\nwhere $i$ is the imaginary unit. Discretize $[0,L_f]$ using a uniform grid of $N$ points with spacing $h = L_f/(N-1)$ and second-order central differences for interior points.\n\nThe plate is modeled at the interface by a scalar dynamic stiffness\n$$\ns_k = k_{\\mathrm{bend}} - \\omega^2 m + i \\, \\omega \\, c_d,\n$$\nwhere $k_{\\mathrm{bend}}$ is the effective bending stiffness in newtons per cubic meter, $m$ is the effective areal mass in kilograms per square meter, and $c_d$ is a damping coefficient in newton-seconds per cubic meter. The traction balance at the interface in the frequency domain is\n$$\ns_k \\, u + p(0) = 0.\n$$\n\nDefine the discrete fluid Neumann-to-Dirichlet mapping $\\mathcal{M}_f$ as follows: for a given scalar Neumann input $g$ that sets $\\frac{dp}{dx}(0)=g$, solve the discretized fluid system with the absorbing boundary at $x=L_f$, and set $\\mathcal{M}_f(g) = p(0)$. This is a linear mapping, and therefore $\\mathcal{M}_f(g) = M_f \\, g$ for some complex scalar $M_f$ determined by the discretization and parameters. Using the acceleration continuity $g = \\rho \\, \\omega^2 \\, u$, the coupled discrete interface operator acting on $u$ is\n$$\n\\mathcal{S}_c(u) = s_k \\, u + \\mathcal{M}_f(\\rho \\, \\omega^2 \\, u) = \\left(s_k + \\rho \\, \\omega^2 \\, M_f\\right) u.\n$$\n\nConsider the $2\\times 2$ block-structured interface system in the variables $[u, g]^T$,\n$$\n\\begin{bmatrix}\ns_k  M_f \\\\\n- \\rho \\, \\omega^2  1\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ g\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\ 0\n\\end{bmatrix},\n$$\nwhich encodes traction balance and kinematic coupling. Propose a block diagonal preconditioner that decouples fluid and structure contributions,\n$$\n\\mathcal{P} = \n\\begin{bmatrix}\ns_k  0 \\\\\n0  1\n\\end{bmatrix},\n$$\nand assess the efficiency of the preconditioned Richardson iteration matrix\n$$\n\\mathcal{E} = I - \\mathcal{P}^{-1}\n\\begin{bmatrix}\ns_k  M_f \\\\\n- \\rho \\, \\omega^2  1\n\\end{bmatrix},\n$$\nby computing its spectral radius, defined as the maximum absolute value of its eigenvalues.\n\nYour program must:\n- Construct the discrete fluid matrix using second-order finite differences on a uniform grid of $N$ points with spacing $h = L_f/(N-1)$, with the following rows:\n    - Left boundary (Neumann input): $-p_0 + p_1 = h \\, g$.\n    - Interior nodes $i=1,\\dots,N-2$: $p_{i-1} - 2 p_i + p_{i+1} + (k h)^2 p_i = 0$.\n    - Right boundary (absorbing): $-p_{N-2} + (1 - i k h) p_{N-1} = 0$.\n- Compute $M_f$ by solving the discrete fluid system with $g=1$ and reading $p(0)$.\n- Form $s_k$ from the given parameters.\n- Assemble the $2\\times 2$ interface matrix and the block diagonal preconditioner, and compute the spectral radius of $\\mathcal{E}$.\n- For each test case, output two values: the magnitude $\\left|s_k + \\rho \\, \\omega^2 \\, M_f\\right|$ of the discrete coupled interface operator and the spectral radius of $\\mathcal{E}$.\n\nAll quantities are in International System of Units (SI): length in meters, time in seconds, mass in kilograms. Angles are in radians. There are no percentage quantities. The outputs are dimensionless real numbers.\n\nUse the following test suite, covering a typical case, a low-frequency case, and a near-resonance structural case:\n1. Case A (typical): $L_f = 0.5$, $N = 100$, $c = 1500$, $\\rho = 1000$, $m = 5.0$, $k_{\\mathrm{bend}} = 5.0 \\times 10^7$, $c_d = 1.0 \\times 10^4$, $\\omega = 2\\pi \\times 800$.\n2. Case B (low frequency): $L_f = 1.0$, $N = 60$, $c = 1500$, $\\rho = 1000$, $m = 5.0$, $k_{\\mathrm{bend}} = 1.0 \\times 10^7$, $c_d = 2.0 \\times 10^3$, $\\omega = 2\\pi \\times 50$.\n3. Case C (near resonance): $L_f = 0.8$, $N = 80$, $c = 1500$, $\\rho = 1000$, $m = 5.0$, $k_{\\mathrm{bend}} = \\omega^2 m$ with $c_d = 1.0 \\times 10^3$, and $\\omega = 2\\pi \\times 500$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n$$\n\\left[\\left|s_k + \\rho \\, \\omega^2 \\, M_f\\right|_{\\mathrm{A}}, \\; \\rho(\\mathcal{E})_{\\mathrm{A}}, \\; \\left|s_k + \\rho \\, \\omega^2 \\, M_f\\right|_{\\mathrm{B}}, \\; \\rho(\\mathcal{E})_{\\mathrm{B}}, \\; \\left|s_k + \\rho \\, \\omega^2 \\, M_f\\right|_{\\mathrm{C}}, \\; \\rho(\\mathcal{E})_{\\mathrm{C}} \\right],\n$$\nwhere the subscript denotes the case label and $\\rho(\\cdot)$ denotes spectral radius. The outputs must be real numbers; use the magnitude of complex quantities where necessary. No additional text should be printed.",
            "solution": "The user has provided a well-posed problem in computational acoustics, requiring the analysis of a one-dimensional fluid-structure interaction model using domain decomposition. The problem is scientifically grounded in the Helmholtz equation for acoustics and a simplified dynamic model for a flexural plate. The numerical method (finite differences) and boundary conditions are explicitly defined, and all necessary physical parameters for the test cases are provided. The problem is complete, consistent, and objective. Therefore, I will proceed with a full solution.\n\nThe principal objective is to compute two quantities for three distinct test cases: first, the magnitude of the discrete coupled interface operator, denoted as $|\\mathcal{S}_c|$; and second, the spectral radius of a preconditioned iteration matrix, $\\rho(\\mathcal{E})$. This analysis assesses the behavior of the coupled system and the efficiency of a proposed block-diagonal preconditioner.\n\n**1. Discretization of the Acoustic Fluid Domain**\n\nThe acoustic pressure $p(x)$ in the fluid domain $[0, L_f]$ is governed by the Helmholtz equation:\n$$\n\\frac{d^2 p}{dx^2} + k^2 p = 0\n$$\nwhere $k = \\omega/c$ is the acoustic wavenumber. The domain is discretized using a uniform grid with $N$ points $x_j = j \\cdot h$ for $j=0, \\dots, N-1$, where the grid spacing is $h = L_f / (N-1)$. The pressure at these grid points is denoted by $p_j = p(x_j)$.\n\nThe problem specifies a finite difference scheme to approximate the governing equations, resulting in a linear system of equations $A\\mathbf{p} = \\mathbf{b}$, where $\\mathbf{p} = [p_0, p_1, \\dots, p_{N-1}]^T$. The matrix $A$ and vector $\\mathbf{b}$ are constructed row by row according to the specified boundary and interior point conditions.\n\n*   **Left Boundary (Interface, $j=0$):** The problem prescribes a Neumann boundary condition $\\frac{dp}{dx}|_{x=0} = g$, discretized as $-p_0 + p_1 = hg$. This corresponds to the first row of the linear system. Here, $g$ represents the input normal acceleration from the structure.\n*   **Interior Nodes ($j=1, \\dots, N-2$):** A second-order central difference is used for the second derivative: $\\frac{p_{j-1} - 2p_j + p_{j+1}}{h^2} + k^2 p_j = 0$. Rearranging gives the equation for the interior rows of the matrix: $p_{j-1} + ((kh)^2 - 2)p_j + p_{j+1} = 0$.\n*   **Right Boundary (Absorbing, $j=N-1$):** A first-order absorbing (Sommerfeld) condition $\\frac{dp}{dx}|_{x=L_f} = ikp(L_f)$ is discretized using a first-order backward difference: $\\frac{p_{N-1} - p_{N-2}}{h} = ikp_{N-1}$. This leads to the final row of the system: $-p_{N-2} + (1 - ikh)p_{N-1} = 0$.\n\n**2. The Fluid Neumann-to-Dirichlet Map, $M_f$**\n\nThe Neumann-to-Dirichlet (NtD) map, $\\mathcal{M}_f$, relates the Neumann data (flux) at the interface to the Dirichlet data (pressure) at the same location. For this discrete system, the map is a linear operator represented by a complex scalar $M_f$, such that $p_0 = \\mathcal{M}_f(g) = M_f g$. To compute $M_f$, we solve the fluid system with a unit input, $g=1$. The resulting right-hand side vector is $\\mathbf{b} = [h, 0, \\dots, 0]^T$. After solving the system $A\\mathbf{p} = \\mathbf{b}$, the value of $M_f$ is simply the pressure at the first grid point, $M_f = p_0$.\n\n**3. The Coupled Interface System**\n\nThe interaction between the fluid and the structure is described by two conditions at the interface $x=0$:\n\n*   **Kinematic Continuity:** The fluid acceleration is driven by the plate's motion: $\\frac{dp}{dx}|_{x=0} = \\rho \\omega^2 u$. In our formulation, this means the Neumann input is $g = \\rho \\omega^2 u$.\n*   **Traction Balance:** The forces must balance: $s_k u + p(0) = 0$. The plate's dynamic stiffness is given by $s_k = k_{\\mathrm{bend}} - \\omega^2 m + i\\omega c_d$.\n\nSubstituting the NtD relation $p(0) = M_f g$ and the kinematic condition into the traction balance yields the Schur complement equation for the coupled system:\n$$\ns_k u + M_f (\\rho \\omega^2 u) = 0 \\implies (s_k + \\rho \\omega^2 M_f) u = 0\n$$\nThe term $\\mathcal{S}_c = s_k + \\rho \\omega^2 M_f$ is the discrete coupled interface operator. The first required output is its magnitude, $|\\mathcal{S}_c|$.\n\n**4. Preconditioner Analysis**\n\nThe problem presents a $2 \\times 2$ block system formulation based on the interface variables $u$ (plate displacement) and $g$ (fluid acceleration source):\n$$\n\\begin{bmatrix} s_k  M_f \\\\ - \\rho \\, \\omega^2  1 \\end{bmatrix} \\begin{bmatrix} u \\\\ g \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n$$\nA block diagonal preconditioner $\\mathcal{P}$ is proposed to approximate this system matrix, aiming to decouple the structural and fluid contributions:\n$$\n\\mathcal{P} = \\begin{bmatrix} s_k  0 \\\\ 0  1 \\end{bmatrix}\n$$\nThe efficiency of this preconditioner for a Richardson iteration scheme is assessed by the spectral radius of the iteration matrix $\\mathcal{E} = I - \\mathcal{P}^{-1} M_{sys}$. We compute $\\mathcal{E}$:\n$$\n\\mathcal{E} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} 1/s_k  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} s_k  M_f \\\\ - \\rho \\, \\omega^2  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} 1  M_f/s_k \\\\ - \\rho \\, \\omega^2  1 \\end{bmatrix} = \\begin{bmatrix} 0  -M_f/s_k \\\\ \\rho \\, \\omega^2  0 \\end{bmatrix}\n$$\nThe eigenvalues $\\lambda$ of $\\mathcal{E}$ are found from the characteristic equation $\\det(\\mathcal{E} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda  -M_f/s_k \\\\ \\rho \\, \\omega^2  -\\lambda \\end{pmatrix} = \\lambda^2 + \\frac{M_f \\rho \\omega^2}{s_k} = 0 \\implies \\lambda^2 = -\\frac{M_f \\rho \\omega^2}{s_k}\n$$\nThe eigenvalues are $\\lambda = \\pm \\sqrt{- (M_f \\rho \\omega^2) / s_k}$. The spectral radius, $\\rho(\\mathcal{E})$, is the maximum absolute value of the eigenvalues. Since $|\\lambda_1| = |\\lambda_2|$, we have:\n$$\n\\rho(\\mathcal{E}) = \\left| \\sqrt{-\\frac{M_f \\rho \\omega^2}{s_k}} \\right| = \\sqrt{\\left| \\frac{M_f \\rho \\omega^2}{s_k} \\right|}\n$$\nThis analytical expression allows for a direct and robust calculation of the second required output.\n\nThe algorithm proceeds by implementing these steps for each of the three test cases, calculating the numerical values for $|\\mathcal{S}_c|$ and $\\rho(\\mathcal{E})$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the fluid-structure interaction problem for all test cases.\n    \"\"\"\n\n    def solve_case(Lf, N, c, rho, m, k_bend_val, c_d, omega, is_resonant_case):\n        \"\"\"\n        Calculates the coupled operator magnitude and preconditioner spectral radius for a single case.\n        \n        Args:\n            Lf (float): Length of the fluid domain.\n            N (int): Number of grid points.\n            c (float): Speed of sound in the fluid.\n            rho (float): Density of the fluid.\n            m (float): Areal mass of the plate.\n            k_bend_val (float or None): Bending stiffness of the plate. Can be None for resonant case.\n            c_d (float): Damping coefficient of the plate.\n            omega (float): Angular frequency.\n            is_resonant_case (bool): Flag for the near-resonance case.\n\n        Returns:\n            tuple: A tuple containing the magnitude of the coupled interface operator\n                   and the spectral radius of the iteration matrix.\n        \"\"\"\n        # Complex unit\n        i_unit = 1j\n\n        # For the near-resonance case, k_bend is defined relative to m and omega\n        if is_resonant_case:\n            k_bend = omega**2 * m\n        else:\n            k_bend = k_bend_val\n\n        # Derived physical and numerical parameters\n        k_wave = omega / c  # Wavenumber\n        h = Lf / (N - 1)  # Grid spacing\n\n        # --- Step 1: Construct and solve the discrete fluid system to find M_f ---\n        A = np.zeros((N, N), dtype=complex)\n        b = np.zeros(N, dtype=complex)\n        \n        # Set Neumann drive g=1 to compute the Neumann-to-Dirichlet map\n        g = 1.0\n\n        # Row 0: Left boundary (Neumann condition: -p0 + p1 = h*g)\n        A[0, 0] = -1.0\n        A[0, 1] = 1.0\n        b[0] = h * g\n\n        # Rows 1 to N-2: Interior nodes (Discrete Helmholtz equation)\n        helmholtz_diag_term = -2.0 + (k_wave * h)**2\n        for row_idx in range(1, N - 1):\n            A[row_idx, row_idx - 1] = 1.0\n            A[row_idx, row_idx] = helmholtz_diag_term\n            A[row_idx, row_idx + 1] = 1.0\n\n        # Row N-1: Right boundary (Absorbing condition)\n        A[N - 1, N - 2] = -1.0\n        A[N - 1, N - 1] = 1.0 - i_unit * k_wave * h\n        \n        # Solve the linear system A*p = b for the pressure field p\n        p = np.linalg.solve(A, b)\n        \n        # The Neumann-to-Dirichlet map M_f is the pressure at the interface (x=0) for g=1\n        M_f = p[0]\n\n        # --- Step 2: Calculate structural and coupled properties ---\n        \n        # Structural dynamic stiffness s_k\n        s_k = k_bend - omega**2 * m + i_unit * omega * c_d\n        \n        # --- Step 3: Calculate the required outputs ---\n        \n        # Output 1: Magnitude of the discrete coupled interface operator (Schur complement)\n        S_c = s_k + rho * omega**2 * M_f\n        output1 = np.abs(S_c)\n        \n        # Output 2: Spectral radius of the preconditioned Richardson iteration matrix E\n        # rho(E) = sqrt(| (M_f * rho * omega^2) / s_k |)\n        if np.abs(s_k) == 0:\n            # This case is not expected with the given parameters but is handled for robustness.\n            # If s_k is zero, the preconditioner is singular and iteration fails.\n            # The spectral radius would be infinite. We represent this with a large number\n            # or handle as an error, but for this problem, s_k is never zero.\n            output2 = np.inf\n        else:\n            term_inside_sqrt = (M_f * rho * omega**2) / s_k\n            output2 = np.sqrt(np.abs(term_inside_sqrt))\n            \n        return output1, output2\n\n    # Define the test cases from the problem statement.\n    pi = np.pi\n    test_cases = [\n        # Case A (typical)\n        {'Lf': 0.5, 'N': 100, 'c': 1500, 'rho': 1000, 'm': 5.0, 'k_bend_val': 5.0e7,\n         'c_d': 1.0e4, 'omega': 2 * pi * 800, 'is_resonant_case': False},\n        # Case B (low frequency)\n        {'Lf': 1.0, 'N': 60, 'c': 1500, 'rho': 1000, 'm': 5.0, 'k_bend_val': 1.0e7,\n         'c_d': 2.0e3, 'omega': 2 * pi * 50, 'is_resonant_case': False},\n        # Case C (near resonance)\n        {'Lf': 0.8, 'N': 80, 'c': 1500, 'rho': 1000, 'm': 5.0, 'k_bend_val': None,\n         'c_d': 1.0e3, 'omega': 2 * pi * 500, 'is_resonant_case': True},\n    ]\n\n    results = []\n    for case in test_cases:\n        res1, res2 = solve_case(**case)\n        results.append(res1)\n        results.append(res2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}