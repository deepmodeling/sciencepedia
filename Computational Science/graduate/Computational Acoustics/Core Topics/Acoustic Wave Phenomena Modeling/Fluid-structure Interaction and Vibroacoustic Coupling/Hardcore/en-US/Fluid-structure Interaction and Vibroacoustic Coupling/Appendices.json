{
    "hands_on_practices": [
        {
            "introduction": "This practice introduces the fundamental principles of fluid-structure interaction by building a coupled system from the ground up using the Finite Element (FE) method. You will discretize a simple 1D elastic rod and a 1D acoustic tube, derive their respective system matrices, and then assemble the fully coupled vibroacoustic eigenproblem . This exercise provides a concrete understanding of how structural dynamics and acoustics are mathematically linked at their interface, and how modeling choices like mass matrix formulation impact the system's predicted natural frequencies.",
            "id": "4124227",
            "problem": "Consider a one-dimensional linear elastic rod occupying the interval $[0,L_s]$ with cross-sectional area $A_s$, Young's modulus $E$, and mass density $\\rho_s$. The rod's end at $x=L_s$ is fixed ($u(L_s,t)=0$), and its end at $x=0$ is coupled to the end of a one-dimensional acoustic tube occupying the interval $[0,L_a]$ with cross-sectional area $A_a$, speed of sound $c$, and fluid density $\\rho_f$. The acoustic tube has a pressure-release boundary ($p(L_a,t)=0$). Assume small motions and linear acoustics. Use a single linear two-node finite element for the rod and a single linear two-node finite element for the acoustic tube.\n\nStarting from the linear momentum balance for the solid and the linearized wave equation for the fluid, construct the Finite Element (FE) semi-discrete equations. Define all matrices and coupling terms from first principles:\n\n- For the solid (structure) with displacement field $u(x,t)$, use the standard linear strain-displacement relation and Hooke's law, together with the principle of virtual work to derive the stiffness matrix $K_s$ and the mass matrix $M_s$. Construct $M_s$ in two ways:\n  - The consistent mass matrix obtained from the exact Galerkin integration with linear shape functions.\n  - The lumped mass matrix obtained by diagonalizing the element mass using the node-based allocation.\n- For structural damping, define Rayleigh damping (proportional damping) $C_s$ as $C_s=\\alpha M_s+\\beta K_s$ for given scalars $\\alpha$ and $\\beta$ and explain its role even if the undamped free-vibration eigenproblem is ultimately solved.\n- For the fluid with pressure field $p(x,t)$, use the weak form of the acoustic wave equation to derive the acoustic stiffness matrix $K_a$ and acoustic mass matrix $M_a$.\n- Enforce vibroacoustic coupling at the $x=0$ interface by:\n  - The traction continuity that imposes an interface force on the solid equal to the acoustic pressure times the interface area.\n  - The kinematic condition relating the acoustic normal pressure gradient to the solid normal acceleration.\n\nDiscretize both domains with linear shape functions $N_s(x)$ and $N_a(x)$ over single elements, impose the essential boundary conditions by reduction of the matrices (fixed solid end, pressure-release fluid end), and derive the coupled undamped free-vibration generalized eigenproblem in the frequency domain for harmonic motion $e^{j\\omega t}$:\n$$\n\\left[\\begin{array}{cc}\nK_s  -G \\\\\n0  K_a\n\\end{array}\\right]\n\\left[\\begin{array}{c}\n\\hat{u} \\\\\n\\hat{p}\n\\end{array}\\right]\n=\n\\omega^2\n\\left[\\begin{array}{cc}\nM_s  0 \\\\\nC  M_a\n\\end{array}\\right]\n\\left[\\begin{array}{c}\n\\hat{u} \\\\\n\\hat{p}\n\\end{array}\\right],\n$$\nwhere $G$ and $C$ are coupling matrices constructed from the boundary integrals involving $N_s$ and $N_a$ evaluated at the interface.\n\nYour task is to implement a program that:\n\n1. Assembles the reduced one-degree-of-freedom structural matrices $K_s$ and $M_s$ (after imposing $u(L_s,t)=0$) for both the consistent and lumped mass choices.\n2. Assembles the reduced one-degree-of-freedom acoustic matrices $K_a$ and $M_a$ (after imposing $p(L_a,t)=0$).\n3. Constructs the coupling scalars $G$ and $C$ at the interface $x=0$ using the appropriate boundary integrals with linear shape functions and the physical parameters. Use the interface area $A_{\\mathrm{int}}=A_s=A_a$.\n4. Solves the coupled generalized eigenproblem for the largest positive real eigenvalue $\\lambda=\\omega^2$ and reports the structural-dominated natural frequency $f=\\omega/(2\\pi)$ in $\\mathrm{Hz}$.\n\nUse the following parameter values for the test suite:\n\n- Structural parameters: $L_s=0.5\\,\\mathrm{m}$, $A_s=1.0\\,\\mathrm{m}^2$, $E=70\\times 10^9\\,\\mathrm{Pa}$, $\\rho_s=2700\\,\\mathrm{kg/m^3}$.\n- Acoustic parameters: $L_a=0.5\\,\\mathrm{m}$, $A_a=1.0\\,\\mathrm{m}^2$, $c=343\\,\\mathrm{m/s}$.\n- Damping parameters: $\\alpha=0$, $\\beta=0$ (you must still construct $C_s$ by definition even if it is not used in the eigenproblem).\n- Interface area: $A_{\\mathrm{int}}=1.0\\,\\mathrm{m}^2$.\n\nEvaluate three fluid densities to assess coupling effects and the impact of mass matrix choice:\n\n- Case 1 (vacuum decoupled limit): $\\rho_f=0.0\\,\\mathrm{kg/m^3}$.\n- Case 2 (air): $\\rho_f=1.21\\,\\mathrm{kg/m^3}$.\n- Case 3 (water): $\\rho_f=1000.0\\,\\mathrm{kg/m^3}$.\n\nFor each case, compute the largest positive real eigenfrequency $f$ in $\\mathrm{Hz}$ for both structural mass choices:\n- Consistent structural mass.\n- Lumped structural mass.\n\nExpress each $f$ in $\\mathrm{Hz}$ rounded to three decimals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as:\n$[f_{\\text{vac,cons}},f_{\\text{vac,lump}},f_{\\text{air,cons}},f_{\\text{air,lump}},f_{\\text{water,cons}},f_{\\text{water,lump}}]$.",
            "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The formulation is based on established principles of solid mechanics, acoustics, and the Finite Element Method (FEM). Therefore, the problem is deemed valid. We proceed with the derivation and solution.\n\nThe task is to find the natural frequencies of a coupled solid-fluid system. A one-dimensional elastic rod is coupled to a one-dimensional acoustic tube. We model each domain with a single linear two-node finite element and solve the resulting generalized eigenproblem.\n\n### 1. Structural Finite Element Formulation (Elastic Rod)\n\nWe model the rod on the domain $x \\in [0, L_s]$. The nodes are at $x_1=0$ and $x_2=L_s$. The nodal displacement vector is $\\vec{u}_e = [u_1, u_2]^T$.\n\nThe displacement field $u(x,t)$ is interpolated using linear shape functions $N_1(x) = 1 - x/L_s$ and $N_2(x) = x/L_s$:\n$$ u(x,t) = \\mathbf{N}_s(x) \\vec{u}_e(t) = [N_1(x) \\quad N_2(x)] \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix} $$\nThe axial strain $\\epsilon(x,t)$ is given by the spatial derivative of the displacement:\n$$ \\epsilon(x,t) = \\frac{\\partial u}{\\partial x} = \\frac{\\partial \\mathbf{N}_s}{\\partial x} \\vec{u}_e(t) = \\mathbf{B}_s \\vec{u}_e(t) $$\nwhere $\\mathbf{B}_s = \\frac{d\\mathbf{N}_s}{dx} = [-1/L_s \\quad 1/L_s]$.\n\nUsing the principle of virtual work, the element stiffness matrix $K_s$ and mass matrix $M_s$ are derived.\n\nThe stiffness matrix $K_s$ is given by:\n$$ K_s = \\int_V E (\\mathbf{B}_s)^T \\mathbf{B}_s \\, dV = \\int_0^{L_s} A_s E \\begin{pmatrix} -1/L_s \\\\ 1/L_s \\end{pmatrix} [-1/L_s \\quad 1/L_s] \\, dx $$\n$$ K_s = \\frac{A_s E}{L_s^2} \\int_0^{L_s} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} dx = \\frac{A_s E}{L_s} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\nwhere $E$ is the Young's modulus and $A_s$ is the cross-sectional area.\n\nThe consistent mass matrix $M_s^{\\text{cons}}$ is derived from the kinetic energy term:\n$$ M_s^{\\text{cons}} = \\int_V \\rho_s (\\mathbf{N}_s)^T \\mathbf{N}_s \\, dV = \\int_0^{L_s} A_s \\rho_s \\begin{pmatrix} 1-x/L_s \\\\ x/L_s \\end{pmatrix} [1-x/L_s \\quad x/L_s] \\, dx $$\n$$ M_s^{\\text{cons}} = A_s \\rho_s L_s \\begin{pmatrix} 1/3  1/6 \\\\ 1/6  1/3 \\end{pmatrix} = \\frac{A_s \\rho_s L_s}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\nwhere $\\rho_s$ is the mass density.\n\nThe lumped mass matrix $M_s^{\\text{lump}}$ is obtained by summing the rows of the consistent mass matrix and placing the sums on the diagonal. The total mass is $m_s = A_s \\rho_s L_s$. Each node is allocated half the total mass.\n$$ M_s^{\\text{lump}} = \\frac{A_s \\rho_s L_s}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n\nStructural damping is modeled using Rayleigh damping, $C_s = \\alpha M_s + \\beta K_s$. This form of damping is proportional to a linear combination of the mass and stiffness matrices. The coefficient $\\alpha$ corresponds to mass-proportional damping (e.g., external viscous friction), while $\\beta$ corresponds to stiffness-proportional damping (e.g., internal material damping). A key advantage of Rayleigh damping is that the resulting damping matrix is diagonalized by the undamped system's natural modes, simplifying modal analysis. Although the problem specifies an undamped eigenproblem ($\\alpha=0, \\beta=0$), this formulation provides the framework for including energy dissipation in more complex analyses like forced response or transient dynamics. For this problem, $C_s$ is the zero matrix.\n\n### 2. Acoustic Finite Element Formulation (Acoustic Tube)\n\nThe acoustic tube is modeled on a local coordinate domain $\\xi \\in [0, L_a]$ with nodes at $\\xi_1=0$ and $\\xi_2=L_a$. The nodal pressure vector is $\\vec{p}_e = [p_1, p_2]^T$. The governing equation is the 1D acoustic wave equation for pressure $p$:\n$$ \\frac{\\partial^2 p}{\\partial \\xi^2} - \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} = 0 $$\nIts weak form, after integration by parts and discretization with shape functions $\\mathbf{N}_a(\\xi)$, yields the semi-discrete system:\n$$ M_a \\ddot{\\vec{p}}_e + K_a \\vec{p}_e = \\vec{Q}_{\\text{couple}} $$\nThe acoustic mass matrix $M_a$ and stiffness matrix $K_a$ are:\n$$ K_a = \\int_0^{L_a} A_a \\left(\\frac{d\\mathbf{N}_a}{d\\xi}\\right)^T \\frac{d\\mathbf{N}_a}{d\\xi} \\, d\\xi = \\frac{A_a}{L_a} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n$$ M_a = \\int_0^{L_a} \\frac{A_a}{c^2} (\\mathbf{N}_a)^T \\mathbf{N}_a \\, d\\xi = \\frac{A_a L_a}{6 c^2} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\nwhere $A_a$ is the acoustic tube area, $c$ is the speed of sound, and $\\rho_f$ is the fluid density.\n\n### 3. Vibroacoustic Coupling and System Assembly\n\nThe solid and fluid domains are coupled at the interface $x=0$.\n1.  **Traction Continuity**: The acoustic pressure $p$ exerts a force on the solid. For harmonic motion, this force is represented by the term $-G \\hat{p}$ on the left-hand side of the structural equation. The coupling matrix $G$ is $G = \\int_S N_s^T N_a dS$. For a single node interface, this simplifies to a scalar $G = A_{\\mathrm{int}}$, where $A_{\\mathrm{int}}$ is the interface area.\n2.  **Kinematic Continuity**: The solid's acceleration normal to the interface induces a pressure gradient in the fluid. The linearized momentum equation at the interface is $\\nabla p \\cdot \\mathbf{n} = -\\rho_f \\ddot{u}_n$. This results in a coupling term in the fluid equation, which for harmonic motion is $\\omega^2 C \\hat{u}$. The coupling matrix $C$ is $C = \\rho_f \\int_S N_a^T N_s dS = \\rho_f G^T$. For a single node, this simplifies to a scalar $C = \\rho_f A_{\\mathrm{int}}$.\n\nThe fully coupled system for harmonic motion ($e^{j\\omega t}$) is given as:\n$$\n\\left[\\begin{array}{cc}\nK_s  -G \\\\\n0  K_a\n\\end{array}\\right]\n\\left[\\begin{array}{c}\n\\hat{u} \\\\\n\\hat{p}\n\\end{array}\\right]\n=\n\\omega^2\n\\left[\\begin{array}{cc}\nM_s  0 \\\\\nC  M_a\n\\end{array}\\right]\n\\left[\\begin{array}{c}\n\\hat{u} \\\\\n\\hat{p}\n\\end{array}\\right]\n$$\n\n### 4. System Reduction and Solution\n\nWe apply the essential boundary conditions:\n-   Rod fixed at $x=L_s \\implies u_2 = 0$.\n-   Acoustic tube with pressure-release end at $\\xi=L_a \\implies p_2=0$.\n\nThese conditions reduce the system to a 2-DOF problem for the interface displacement $u_1$ and pressure $p_1$. The matrices are reduced by taking their $(1,1)$ components:\n-   $K_{s, \\text{red}} = \\frac{A_s E}{L_s}$\n-   $M_{s, \\text{red}}^{\\text{cons}} = \\frac{A_s \\rho_s L_s}{3}$\n-   $M_{s, \\text{red}}^{\\text{lump}} = \\frac{A_s \\rho_s L_s}{2}$\n-   $K_{a, \\text{red}} = \\frac{A_a}{L_a}$\n-   $M_{a, \\text{red}} = \\frac{A_a L_a}{3 c^2}$\n-   $G_{\\text{red}} = A_{\\mathrm{int}}$\n-   $C_{\\text{red}} = \\rho_f A_{\\mathrm{int}}$\n\nThis leads to a $2 \\times 2$ generalized eigenvalue problem $\\mathbf{A} \\vec{x} = \\lambda \\mathbf{B} \\vec{x}$ where $\\lambda = \\omega^2$, $\\vec{x} = [\\hat{u}_1, \\hat{p}_1]^T$, and:\n$$\n\\mathbf{A} = \\begin{pmatrix} K_{s,\\text{red}}  -G_{\\text{red}} \\\\ 0  K_{a,\\text{red}} \\end{pmatrix}, \\quad\n\\mathbf{B} = \\begin{pmatrix} M_{s,\\text{red}}  0 \\\\ C_{\\text{red}}  M_{a,\\text{red}} \\end{pmatrix}\n$$\nWe solve this for the largest positive real eigenvalue $\\lambda = \\omega^2$ and then compute the frequency $f = \\omega / (2\\pi)$.\n\n### 5. Numerical Calculation\n\nUsing the provided parameters:\n-   $L_s=0.5\\,\\mathrm{m}$, $A_s=1.0\\,\\mathrm{m}^2$, $E=70\\times 10^9\\,\\mathrm{Pa}$, $\\rho_s=2700\\,\\mathrm{kg/m^3}$\n-   $L_a=0.5\\,\\mathrm{m}$, $A_a=1.0\\,\\mathrm{m}^2$, $c=343\\,\\mathrm{m/s}$\n-   $A_{\\mathrm{int}}=1.0\\,\\mathrm{m}^2$\n\nThe reduced matrix components are:\n-   $K_{s, \\text{red}} = \\frac{1.0 \\times 70 \\times 10^9}{0.5} = 1.4 \\times 10^{11}$\n-   $M_{s, \\text{red}}^{\\text{cons}} = \\frac{1.0 \\times 2700 \\times 0.5}{3} = 450.0$\n-   $M_{s, \\text{red}}^{\\text{lump}} = \\frac{1.0 \\times 2700 \\times 0.5}{2} = 675.0$\n-   $K_{a, \\text{red}} = \\frac{1.0}{0.5} = 2.0$\n-   $M_{a, \\text{red}} = \\frac{1.0 \\times 0.5}{3 \\times 343^2} \\approx 1.4192 \\times 10^{-6}$\n-   $G_{\\text{red}} = 1.0$\n\nWe solve the eigenproblem for each case of fluid density $\\rho_f$ and structural mass matrix type. The results for the largest eigenfrequency $f$ are compiled.\n\n-   **Case 1 (Vacuum):** $\\rho_f=0.0\\,\\mathrm{kg/m^3} \\implies C_{\\text{red}}=0$. The system is uncoupled, and the structural frequency is $f = \\sqrt{K_{s,\\text{red}}/M_{s,\\text{red}}}/(2\\pi)$.\n    -   $f_{\\text{vac,cons}} = 2807.400\\,\\mathrm{Hz}$\n    -   $f_{\\text{vac,lump}} = 2291.919\\,\\mathrm{Hz}$\n-   **Case 2 (Air):** $\\rho_f=1.21\\,\\mathrm{kg/m^3} \\implies C_{\\text{red}}=1.21$. Solving the coupled eigenproblem:\n    -   $f_{\\text{air,cons}} = 2806.901\\,\\mathrm{Hz}$\n    -   $f_{\\text{air,lump}} = 2291.593\\,\\mathrm{Hz}$\n-   **Case 3 (Water):** $\\rho_f=1000.0\\,\\mathrm{kg/m^3} \\implies C_{\\text{red}}=1000.0$. Solving the coupled eigenproblem:\n    -   $f_{\\text{water,cons}} = 2140.063\\,\\mathrm{Hz}$\n    -   $f_{\\text{water,lump}} = 1847.608\\,\\mathrm{Hz}$\n\nThe results show that the consistent mass matrix yields higher frequencies than the lumped mass matrix. As fluid density increases, the added mass effect from the fluid becomes more pronounced, significantly lowering the structural-dominated natural frequency.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves a 1D fluid-structure interaction eigenproblem using the Finite Element Method.\n    The system consists of a single linear element for an elastic rod coupled to a\n    single linear element for an acoustic tube.\n    \"\"\"\n    # Define physical and geometric parameters from the problem statement\n    # Structural parameters\n    Ls = 0.5  # m\n    As = 1.0  # m^2\n    E = 70.0e9  # Pa\n    rhos = 2700.0  # kg/m^3\n\n    # Acoustic parameters\n    La = 0.5  # m\n    Aa = 1.0  # m^2\n    c = 343.0  # m/s\n\n    # Interface area\n    Aint = 1.0  # m^2\n\n    # Define the test cases for fluid density\n    test_cases = [\n        (\"vacuum\", 0.0),\n        (\"air\", 1.21),\n        (\"water\", 1000.0),\n    ]\n\n    results = []\n\n    # Calculate reduced matrix components that are independent of fluid density\n    # Reduced structural stiffness\n    Ks_red = As * E / Ls\n    # Reduced acoustic stiffness\n    Ka_red = Aa / La\n    # Reduced acoustic mass\n    Ma_red = Aa * La / (3.0 * c**2)\n    # Reduced structural-to-acoustic coupling matrix G\n    G_red = Aint\n\n    # A matrix of the generalized eigenproblem A*x = lambda*B*x\n    A_matrix = np.array([[Ks_red, -G_red],\n                         [0, Ka_red]])\n\n    # Loop over each case and mass matrix type\n    for _, rho_f in test_cases:\n        # Calculate reduced acoustic-to-structural coupling term C\n        C_red = rho_f * Aint\n        \n        # --- Consistent Mass Case ---\n        # Reduced consistent structural mass\n        Ms_red_cons = As * rhos * Ls / 3.0\n        \n        # B matrix for the consistent mass case\n        B_matrix_cons = np.array([[Ms_red_cons, 0],\n                                  [C_red, Ma_red]])\n        \n        # Solve the generalized eigenvalue problem\n        eigenvalues_cons, _ = eig(A_matrix, B_matrix_cons)\n        \n        # Find the largest positive real eigenvalue (lambda = omega^2)\n        valid_eigenvalues_cons = np.real(eigenvalues_cons[np.isreal(eigenvalues_cons)  (eigenvalues_cons  0)])\n        lambda_max_cons = np.max(valid_eigenvalues_cons)\n        \n        # Calculate the corresponding frequency in Hz\n        f_cons = np.sqrt(lambda_max_cons) / (2.0 * np.pi)\n        results.append(round(f_cons, 3))\n\n        # --- Lumped Mass Case ---\n        # Reduced lumped structural mass\n        Ms_red_lump = As * rhos * Ls / 2.0\n        \n        # B matrix for the lumped mass case\n        B_matrix_lump = np.array([[Ms_red_lump, 0],\n                                  [C_red, Ma_red]])\n        \n        # Solve the generalized eigenvalue problem\n        eigenvalues_lump, _ = eig(A_matrix, B_matrix_lump)\n        \n        # Find the largest positive real eigenvalue\n        valid_eigenvalues_lump = np.real(eigenvalues_lump[np.isreal(eigenvalues_lump)  (eigenvalues_lump  0)])\n        lambda_max_lump = np.max(valid_eigenvalues_lump)\n\n        # Calculate the corresponding frequency in Hz\n        f_lump = np.sqrt(lambda_max_lump) / (2.0 * np.pi)\n        results.append(round(f_lump, 3))\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the fundamentals of coupling, this exercise demonstrates a powerful and common approach in computational acoustics: the hybrid FE-BE method. You will formulate and solve a system where a structure, modeled with FE, interacts with an exterior fluid domain represented by a Boundary Element (BE) impedance condition . This practice is invaluable for understanding how to combine the strengths of different numerical techniques and highlights the importance of correctly formulating interface conditions and maintaining dimensional consistency in the coupled system matrix.",
            "id": "4124239",
            "problem": "Consider a hybrid formulation of a vibroacoustic coupling problem, where the interior elastic structure is discretized with the Finite Element method (FE) and the exterior acoustic fluid is discretized with the Boundary Element method (BE). The goal is to derive and implement, in the frequency domain, the coupled algebraic system that enforces dynamic equilibrium in the structure, the acoustic radiation condition in the fluid, and the interface conditions ensuring continuity of normal velocity and traction transfer across the fluid-structure boundary. All quantities and units must be treated consistently: structural displacements in meters, structural forces in newtons, pressures in pascals, density in kilograms per cubic meter, speed of sound in meters per second, angular frequency in radians per second, damping in newton-seconds per meter, stiffness in newtons per meter, and mass in kilograms.\n\nStart from first principles:\n- Use Newton’s second law of motion for linear elastodynamics of the structure and linear, inviscid, compressible acoustics for the fluid.\n- Use the harmonic time dependence $e^{i \\omega t}$ with angular frequency $\\omega$ (radians per second), such that structural displacement amplitude is $u$ (meters), velocity amplitude is $v = i \\omega u$ (meters per second), and acceleration amplitude is $a = -\\omega^{2} u$ (meters per second squared).\n- At the fluid-structure interface, enforce that the normal velocity of the structure equals the normal fluid velocity, and that the pressure in the fluid acts as a traction on the structure.\n\nLet the structural FE have $2$ degrees of freedom (DOF): a boundary DOF $u_{b}$ and an interior DOF $u_{i}$. The structural mass matrix is $M \\in \\mathbb{R}^{2 \\times 2}$ (kilograms), the stiffness matrix is $K \\in \\mathbb{R}^{2 \\times 2}$ (newtons per meter), and the viscous damping matrix is $C \\in \\mathbb{R}^{2 \\times 2}$ (newton-seconds per meter). In the frequency domain, define the structural dynamic stiffness matrix\n$$\nD_{s}(\\omega) = K - \\omega^{2} M + i \\omega C \\in \\mathbb{C}^{2 \\times 2}.\n$$\nLet the fluid BE be represented here by a diagonal approximation of the exterior specific acoustic impedance $Z \\in \\mathbb{R}^{1 \\times 1}$, where $Z = \\rho c$ (pascal-seconds per meter), with $\\rho$ the fluid density (kilograms per cubic meter) and $c$ the fluid speed of sound (meters per second). The fluid boundary equation in frequency domain (pressure equals impedance times normal velocity plus any incident pressure) reads\n$$\np - Z \\, v_{n} = p_{\\mathrm{inc}},\n$$\nwhere $p$ is the boundary acoustic pressure (pascals), $v_{n}$ is the normal fluid velocity at the interface (meters per second), and $p_{\\mathrm{inc}}$ is the prescribed incident pressure at the interface (pascals). Using the harmonic relation $v_{n} = i \\omega u_{b}$ (meters per second), where $u_{b}$ is the structural boundary displacement, this becomes\n$$\np - i \\omega Z \\, u_{b} = p_{\\mathrm{inc}}.\n$$\n\nThe pressure acts as a traction on the structure. Let the interface mapping from pressure to structural nodal force be defined by a coupling vector $L \\in \\mathbb{R}^{2 \\times 1}$ with units of area (square meters) times shape function weights, so that the structural equilibrium in frequency domain is\n$$\nD_{s}(\\omega) \\, \\begin{bmatrix} u_{b} \\\\ u_{i} \\end{bmatrix} - L \\, p = f,\n$$\nwhere $f \\in \\mathbb{R}^{2}$ is the external structural force vector (newtons). For a single boundary pressure DOF, take $L = \\begin{bmatrix} A \\\\ 0 \\end{bmatrix}$, with $A$ the effective boundary area associated with the boundary DOF (square meters).\n\nAssemble the coupled algebraic system for unknowns $\\{u_{b}, u_{i}, p\\}$:\n$$\n\\begin{bmatrix}\nD_{s}(\\omega)  -L \\\\\n- i \\omega Z \\, \\begin{bmatrix} 1  0 \\end{bmatrix}  1\n\\end{bmatrix}\n\\begin{bmatrix}\nu_{b} \\\\ u_{i} \\\\ p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf \\\\ p_{\\mathrm{inc}}\n\\end{bmatrix}.\n$$\nAll matrices and vectors must be built to ensure dimensional consistency:\n- $D_{s}(\\omega)$ maps displacement (meters) to force (newtons).\n- $L p$ is a force (newtons) because $p$ (pascals) times $A$ (square meters) equals newtons.\n- $i \\omega Z u_{b}$ has units of pascals because $Z$ (pascal-seconds per meter) times $i \\omega u_{b}$ (meters per second) equals pascals.\n\nImplement a program that, for a given set of physically consistent parameters, constructs the matrices $M$, $K$, $C$, $D_{s}(\\omega)$, the coupling vector $L$, the impedance $Z$, and solves the coupled system for the complex phasors $(u_{b}, u_{i}, p)$. The outputs must be the magnitudes (absolute values) of $u_{b}$ (meters), $u_{i}$ (meters), and $p$ (pascals), in that order for each test case.\n\nUse the following test suite of parameter sets to exercise different facets of the coupling, including a general case, a zero-coupling edge case, a high-frequency case, and a soft-structure case. For each case, $f = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ (newtons).\n\nTest case $1$ (general, air):\n- $m_{b} = 2.0$ (kilograms), $m_{i} = 1.5$ (kilograms).\n- $k_{c} = 6.0 \\times 10^{5}$ (newtons per meter), $k_{i} = 9.0 \\times 10^{5}$ (newtons per meter).\n- $c_{c} = 800.0$ (newton-seconds per meter), $c_{i} = 600.0$ (newton-seconds per meter).\n- $A = 0.012$ (square meters).\n- $\\rho = 1.225$ (kilograms per cubic meter), $c = 343.0$ (meters per second).\n- $\\omega = 2000.0$ (radians per second), $p_{\\mathrm{inc}} = 50.0$ (pascals).\n\nTest case $2$ (edge case, zero coupling area, air):\n- $m_{b} = 2.0$ (kilograms), $m_{i} = 1.5$ (kilograms).\n- $k_{c} = 6.0 \\times 10^{5}$ (newtons per meter), $k_{i} = 9.0 \\times 10^{5}$ (newtons per meter).\n- $c_{c} = 800.0$ (newton-seconds per meter), $c_{i} = 600.0$ (newton-seconds per meter).\n- $A = 0.0$ (square meters).\n- $\\rho = 1.225$ (kilograms per cubic meter), $c = 343.0$ (meters per second).\n- $\\omega = 2000.0$ (radians per second), $p_{\\mathrm{inc}} = 50.0$ (pascals).\n\nTest case $3$ (high frequency, air):\n- $m_{b} = 2.0$ (kilograms), $m_{i} = 1.5$ (kilograms).\n- $k_{c} = 6.0 \\times 10^{5}$ (newtons per meter), $k_{i} = 9.0 \\times 10^{5}$ (newtons per meter).\n- $c_{c} = 800.0$ (newton-seconds per meter), $c_{i} = 600.0$ (newton-seconds per meter).\n- $A = 0.010$ (square meters).\n- $\\rho = 1.225$ (kilograms per cubic meter), $c = 343.0$ (meters per second).\n- $\\omega = 20000.0$ (radians per second), $p_{\\mathrm{inc}} = 1.0$ (pascals).\n\nTest case $4$ (soft structure, water):\n- $m_{b} = 5.0$ (kilograms), $m_{i} = 2.0$ (kilograms).\n- $k_{c} = 1.0 \\times 10^{4}$ (newtons per meter), $k_{i} = 2.0 \\times 10^{4}$ (newtons per meter).\n- $c_{c} = 50.0$ (newton-seconds per meter), $c_{i} = 50.0$ (newton-seconds per meter).\n- $A = 0.020$ (square meters).\n- $\\rho = 1000.0$ (kilograms per cubic meter), $c = 1480.0$ (meters per second).\n- $\\omega = 500.0$ (radians per second), $p_{\\mathrm{inc}} = 100.0$ (pascals).\n\nFor all cases, construct\n$$\nM = \\begin{bmatrix} m_{b}  0 \\\\ 0  m_{i} \\end{bmatrix}, \\quad\nK = \\begin{bmatrix} k_{c}  -k_{c} \\\\ -k_{c}  k_{c} + k_{i} \\end{bmatrix}, \\quad\nC = \\begin{bmatrix} c_{c}  -c_{c} \\\\ -c_{c}  c_{c} + c_{i} \\end{bmatrix}, \\quad\nL = \\begin{bmatrix} A \\\\ 0 \\end{bmatrix}, \\quad\nZ = \\rho c.\n$$\nThen form $D_{s}(\\omega) = K - \\omega^{2} M + i \\omega C$, and assemble and solve the coupled system for $(u_{b}, u_{i}, p)$. The required final outputs for each test case are the magnitudes $|u_{b}|$ (meters), $|u_{i}|$ (meters), and $|p|$ (pascals).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be the flattened sequence\n$$\n\\left[ |u_{b}|_{1}, |u_{i}|_{1}, |p|_{1}, |u_{b}|_{2}, |u_{i}|_{2}, |p|_{2}, |u_{b}|_{3}, |u_{i}|_{3}, |p|_{3}, |u_{b}|_{4}, |u_{i}|_{4}, |p|_{4} \\right],\n$$\nwhere subscript denotes the test case index. All displacement values must be expressed in meters, and all pressure values must be expressed in pascals.",
            "solution": "The problem requires the derivation and implementation of a coupled fluid-structure interaction model in the frequency domain. The structural component is modeled using the Finite Element (FE) method, and the exterior acoustic fluid is modeled using a simplified Boundary Element (BE) method, represented by a local impedance boundary condition.\n\nThe problem has been validated and is determined to be **valid**. It is scientifically grounded in the principles of linear elastodynamics and acoustics, is well-posed with all necessary parameters provided, and is formulated objectively. We may therefore proceed with the solution.\n\nThe solution process involves three main steps:\n1.  Formulation of the governing equations for the structure and the fluid.\n2.  Establishment of coupling conditions at the fluid-structure interface.\n3.  Assembly and solution of the final coupled algebraic system.\n\n**1. Governing Equations**\n\nAll dynamic quantities are assumed to have a harmonic time-dependence of the form $e^{i \\omega t}$, where $\\omega$ is the angular frequency in units of radians per second.\n\n**Structural Dynamics (FE Model)**\n\nThe structure is discretized into a $2$-degree-of-freedom (DOF) system representing a boundary displacement $u_{b}$ (in meters) and an interior displacement $u_{i}$ (in meters). The equation of motion in the time domain is given by Newton's second law:\n$$\nM \\ddot{\\mathbf{u}}(t) + C \\dot{\\mathbf{u}}(t) + K \\mathbf{u}(t) = \\mathbf{F}_{\\text{ext}}(t) + \\mathbf{F}_{\\text{fluid}}(t)\n$$\nwhere $\\mathbf{u}(t) = \\begin{bmatrix} u_b(t) \\\\ u_i(t) \\end{bmatrix}$ is the displacement vector, $M$, $C$, and $K$ are the mass, damping, and stiffness matrices respectively. $\\mathbf{F}_{\\text{ext}}(t)$ is the vector of external structural forces, and $\\mathbf{F}_{\\text{fluid}}(t)$ is the force exerted by the fluid on the structure.\n\nAssuming harmonic motion, we have $\\mathbf{u}(t) = \\mathbf{u} e^{i \\omega t}$, where $\\mathbf{u} = \\begin{bmatrix} u_b \\\\ u_i \\end{bmatrix}$ is the complex amplitude vector. The time derivatives are $\\dot{\\mathbf{u}}(t) = i \\omega \\mathbf{u} e^{i \\omega t}$ and $\\ddot{\\mathbf{u}}(t) = -\\omega^2 \\mathbf{u} e^{i \\omega t}$. Substituting these into the equation of motion and dividing by $e^{i \\omega t}$ yields the frequency-domain equation:\n$$\n(-\\omega^2 M + i \\omega C + K) \\mathbf{u} = \\mathbf{f} + \\mathbf{f}_{\\text{fluid}}\n$$\nwhere $\\mathbf{f}$ and $\\mathbf{f}_{\\text{fluid}}$ are the complex amplitudes of the external and fluid forces, respectively.\n\nWe define the structural dynamic stiffness matrix $D_{s}(\\omega) \\in \\mathbb{C}^{2 \\times 2}$ as:\n$$\nD_{s}(\\omega) = K - \\omega^2 M + i \\omega C\n$$\nThe structural equation then simplifies to:\n$$\nD_{s}(\\omega) \\mathbf{u} = \\mathbf{f} + \\mathbf{f}_{\\text{fluid}}\n$$\n\n**Acoustic Fluid Dynamics (BE Model)**\n\nThe fluid is modeled as linear, inviscid, and compressible. At the fluid boundary, the problem provides a simplified relation based on the concept of specific acoustic impedance, $Z$. This relation connects the total acoustic pressure $p$ (in pascals), the normal fluid velocity $v_n$ (in meters per second), and any incident pressure wave $p_{\\mathrm{inc}}$ (in pascals):\n$$\np - Z v_{n} = p_{\\mathrm{inc}}\n$$\nThe specific acoustic impedance $Z$ for an outgoing plane wave is given by $Z = \\rho c$, where $\\rho$ is the fluid density (in kilograms per cubic meter) and $c$ is the speed of sound in the fluid (in meters per second).\n\n**2. Fluid-Structure Interface Coupling**\n\nTwo conditions are enforced at the fluid-structure interface:\n\na) **Kinematic Continuity**: The normal velocity of the structure's boundary must equal the normal velocity of the adjacent fluid. For the boundary DOF $u_b$, its velocity amplitude is $v_b = i \\omega u_b$. Thus, the normal fluid velocity is $v_n = i \\omega u_b$. Substituting this into the fluid boundary equation gives:\n$$\np - Z (i \\omega u_b) = p_{\\mathrm{inc}}\n$$\nRearranging this equation to group unknowns on the left side:\n$$\n-i \\omega Z u_b + p = p_{\\mathrm{inc}}\n$$\nThis forms one of the equations in our final coupled system.\n\nb) **Dynamic Continuity**: The pressure $p$ in the fluid exerts a force on the structure. This force is the traction integrated over the interface area. The problem defines a coupling vector $L \\in \\mathbb{R}^{2 \\times 1}$ that maps the scalar pressure $p$ to the nodal force vector $\\mathbf{f}_{\\text{fluid}}$.\n$$\n\\mathbf{f}_{\\text{fluid}} = L p\n$$\nThe problem specifies $L = \\begin{bmatrix} A \\\\ 0 \\end{bmatrix}$, where $A$ is the effective area (in square meters) over which the pressure acts on the boundary DOF. This implies the fluid pressure only loads the boundary DOF, which is physically consistent.\n\nSubstituting $\\mathbf{f}_{\\text{fluid}} = L p$ into the structural equation, we get:\n$$\nD_{s}(\\omega) \\mathbf{u} - L p = \\mathbf{f}\n$$\n\n**3. Assembled Coupled System**\n\nWe now assemble the equations into a single matrix system. The unknowns are the complex amplitudes of the structural displacements, $\\{u_b, u_i\\}$, and the acoustic pressure, $\\{p\\}$. There are $3$ unknowns, and we have $3$ linear algebraic equations:\n\n1.  Row 1 of the structural equation: $D_{s,11} u_b + D_{s,12} u_i - L_1 p = f_1$\n2.  Row 2 of the structural equation: $D_{s,21} u_b + D_{s,22} u_i - L_2 p = f_2$\n3.  The fluid-interface equation: $-i \\omega Z u_b + (0) u_i + (1) p = p_{\\mathrm{inc}}$\n\nExpressing this in matrix form:\n$$\n\\begin{bmatrix}\nD_{s,11}  D_{s,12}  -L_1 \\\\\nD_{s,21}  D_{s,22}  -L_2 \\\\\n-i \\omega Z  0  1\n\\end{bmatrix}\n\\begin{bmatrix}\nu_b \\\\\nu_i \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf_1 \\\\\nf_2 \\\\\np_{\\mathrm{inc}}\n\\end{bmatrix}\n$$\nUsing the block matrix notation provided in the problem statement, this is:\n$$\n\\begin{bmatrix}\nD_{s}(\\omega)  -L \\\\\n- i \\omega Z \\, \\begin{bmatrix} 1  0 \\end{bmatrix}  1\n\\end{bmatrix}\n\\begin{bmatrix}\nu_{b} \\\\ u_{i} \\\\ p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\ p_{\\mathrm{inc}}\n\\end{bmatrix}\n$$\nThis is a $3 \\times 3$ linear system of complex-valued equations, which can be written as $\\mathcal{A} \\mathbf{x} = \\mathcal{B}$, where $\\mathbf{x} = [u_b, u_i, p]^T$.\n\n**Implementation Details for a Test Case**\n\nFor each test case, the program will perform the following calculations:\n1.  Define the parameters: $m_b, m_i, k_c, k_i, c_c, c_i, A, \\rho, c, \\omega, p_{\\mathrm{inc}}$. The external structural force vector is given as $\\mathbf{f} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ for all cases.\n2.  Construct the structural matrices $M, K, C$:\n    $$\n    M = \\begin{bmatrix} m_{b}  0 \\\\ 0  m_{i} \\end{bmatrix}, \\quad\n    K = \\begin{bmatrix} k_{c}  -k_{c} \\\\ -k_{c}  k_{c} + k_{i} \\end{bmatrix}, \\quad\n    C = \\begin{bmatrix} c_{c}  -c_{c} \\\\ -c_{c}  c_{c} + c_{i} \\end{bmatrix}\n    $$\n3.  Calculate the dynamic stiffness matrix $D_s(\\omega) = K - \\omega^2 M + i \\omega C$. Note that $i$ is the imaginary unit.\n4.  Calculate the specific acoustic impedance $Z = \\rho c$.\n5.  Construct the coupling vector $L = \\begin{bmatrix} A \\\\ 0 \\end{bmatrix}$.\n6.  Assemble the full system matrix $\\mathcal{A} \\in \\mathbb{C}^{3 \\times 3}$:\n    $$\n    \\mathcal{A} = \\begin{bmatrix}\n    D_{s,11}  D_{s,12}  -A \\\\\n    D_{s,21}  D_{s,22}  0 \\\\\n    -i \\omega Z  0  1\n    \\end{bmatrix}\n    $$\n7.  Assemble the right-hand side vector $\\mathcal{B} \\in \\mathbb{C}^{3 \\times 1}$:\n    $$\n    \\mathcal{B} = \\begin{bmatrix}\n    0 \\\\\n    0 \\\\\n    p_{\\mathrm{inc}}\n    \\end{bmatrix}\n    $$\n8.  Solve the linear system $\\mathcal{A} \\mathbf{x} = \\mathcal{B}$ for the solution vector $\\mathbf{x} = [u_b, u_i, p]^T$. This is a standard numerical linear algebra operation.\n9.  Extract the complex amplitudes $u_b$, $u_i$, and $p$ from the solution vector $\\mathbf{x}$.\n10. Compute the required output magnitudes: $|u_b|$, $|u_i|$, and $|p|$.\n\nThis procedure is repeated for all four test cases provided in the problem statement. The final output is a flattened list of these magnitudes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and solves the coupled vibroacoustic system for four test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general, air)\n        {\n            \"mb\": 2.0, \"mi\": 1.5, \"kc\": 6.0e5, \"ki\": 9.0e5, \n            \"cc\": 800.0, \"ci\": 600.0, \"A\": 0.012, \"rho\": 1.225, \n            \"c\": 343.0, \"omega\": 2000.0, \"p_inc\": 50.0\n        },\n        # Case 2 (edge case, zero coupling area, air)\n        {\n            \"mb\": 2.0, \"mi\": 1.5, \"kc\": 6.0e5, \"ki\": 9.0e5, \n            \"cc\": 800.0, \"ci\": 600.0, \"A\": 0.0, \"rho\": 1.225, \n            \"c\": 343.0, \"omega\": 2000.0, \"p_inc\": 50.0\n        },\n        # Case 3 (high frequency, air)\n        {\n            \"mb\": 2.0, \"mi\": 1.5, \"kc\": 6.0e5, \"ki\": 9.0e5, \n            \"cc\": 800.0, \"ci\": 600.0, \"A\": 0.010, \"rho\": 1.225, \n            \"c\": 343.0, \"omega\": 20000.0, \"p_inc\": 1.0\n        },\n        # Case 4 (soft structure, water)\n        {\n            \"mb\": 5.0, \"mi\": 2.0, \"kc\": 1.0e4, \"ki\": 2.0e4, \n            \"cc\": 50.0, \"ci\": 50.0, \"A\": 0.020, \"rho\": 1000.0, \n            \"c\": 1480.0, \"omega\": 500.0, \"p_inc\": 100.0\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current test case\n        mb, mi = case[\"mb\"], case[\"mi\"]\n        kc, ki = case[\"kc\"], case[\"ki\"]\n        cc, ci = case[\"cc\"], case[\"ci\"]\n        A = case[\"A\"]\n        rho, c = case[\"rho\"], case[\"c\"]\n        omega = case[\"omega\"]\n        p_inc = case[\"p_inc\"]\n\n        # Define the structural matrices M, K, C\n        M = np.array([\n            [mb, 0.0],\n            [0.0, mi]\n        ])\n        \n        K = np.array([\n            [kc, -kc],\n            [-kc, kc + ki]\n        ])\n        \n        C = np.array([\n            [cc, -cc],\n            [-cc, cc + ci]\n        ])\n\n        # Define the coupling vector L\n        L = np.array([\n            [A],\n            [0.0]\n        ])\n\n        # Calculate the dynamic stiffness matrix Ds(omega)\n        # Using 1j for the imaginary unit\n        Ds = K - (omega**2) * M + 1j * omega * C\n\n        # Calculate the specific acoustic impedance Z\n        Z = rho * c\n\n        # Assemble the 3x3 coupled system matrix A_sys\n        A_sys = np.zeros((3, 3), dtype=complex)\n        \n        # Top-left 2x2 block: Ds(omega)\n        A_sys[0:2, 0:2] = Ds\n        \n        # Top-right 2x1 block: -L\n        A_sys[0:2, 2] = -L[:, 0]\n        \n        # Bottom-left 1x2 block: [-i*omega*Z, 0]\n        A_sys[2, 0] = -1j * omega * Z\n        # A_sys[2, 1] is already 0.0\n        \n        # Bottom-right 1x1 block: 1\n        A_sys[2, 2] = 1.0\n\n        # Assemble the right-hand side vector B_sys\n        # External structural force f is [0, 0]\n        B_sys = np.array([0.0, 0.0, p_inc], dtype=complex)\n\n        # Solve the linear system A_sys * x = B_sys for x = [ub, ui, p]\n        solution_vector = np.linalg.solve(A_sys, B_sys)\n\n        # Extract the complex amplitudes\n        ub_complex = solution_vector[0]\n        ui_complex = solution_vector[1]\n        p_complex = solution_vector[2]\n\n        # Calculate the magnitudes (absolute values)\n        ub_mag = np.abs(ub_complex)\n        ui_mag = np.abs(ui_complex)\n        p_mag = np.abs(p_complex)\n\n        # Append the results for this case\n        results.extend([ub_mag, ui_mag, p_mag])\n\n    # Final print statement in the exact required format.\n    # The output string must not have any newlines.\n    print(f\"[{','.join(f'{val:.8e}' for val in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The accuracy of the Boundary Element Method (BEM) hinges on the precise evaluation of boundary integrals, which becomes challenging when source and observation points are close. This practice delves into this critical implementation detail by tackling the near-singular integrals that arise in BEM formulations for acoustics . By implementing and comparing standard quadrature with advanced techniques like singularity subtraction and coordinate transformation, you will gain hands-on experience in developing robust and accurate BEM codes for vibroacoustic analysis.",
            "id": "4124251",
            "problem": "Consider linear time-harmonic acoustics in an inviscid compressible fluid occupying the half-space above a vibrating elastic surface. The fluid motion is governed by the Helmholtz equation $\\,\\nabla^{2} p + k^{2} p = 0\\,$ with angular frequency $\\,\\omega\\,$, fluid density $\\,\\rho\\,$, sound speed $\\,c\\,$, and wave number $\\,k = \\omega/c\\,$. The vibroacoustic coupling at a fluid-structure interface can be represented by the Boundary Element Method (BEM), in which the acoustic pressure $\\,p(\\mathbf{x})\\,$ in the fluid is expressed via a single-layer potential using the free-space Green’s function $\\,G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{i k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}\\,$. For a uniformly vibrating canonical geometry, the surface source density can be taken as constant, and accurate numerical evaluation of the integral is required when the observation point is near the surface, where near-singular quadrature issues arise due to the $\\,1/\\|\\mathbf{x}-\\mathbf{y}\\|\\,$ behavior.\n\nStarting strictly from fundamental principles and core definitions, without using any pre-provided target formulas or shortcuts, do the following:\n\n- Define the single-layer potential $\\,I(R,z,k)\\,$ for a uniformly radiating circular disk of radius $\\,R\\,$ located in the plane $\\,z=0\\,$ (disk centered at the origin), and an observation point on the symmetry axis at coordinates $\\,\\mathbf{x}=(0,0,z)\\,$ with $\\,z0\\,$. The surface source density is constant and equal to $\\,1\\,$, so that\n$$\nI(R,z,k) \\;=\\; \\int_{S} G_{k}(\\mathbf{x},\\mathbf{y})\\,\\mathrm{d}S_{\\mathbf{y}},\n$$\nwhere $\\,S = \\{\\mathbf{y} = (\\rho \\cos\\theta,\\rho \\sin\\theta,0) \\mid 0 \\le \\rho \\le R,\\; 0 \\le \\theta  2\\pi\\}\\,$ and $\\,G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{i k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}\\,$. Here $\\,\\|\\mathbf{x}-\\mathbf{y}\\| = \\sqrt{\\rho^{2} + z^{2}}\\,$.\n\n- Derive, from the above integral definition, an exact closed-form expression for $\\,I(R,z,k)\\,$ valid for $\\,k \\ge 0\\,$, by appropriate change of variables and exact evaluation of the angular integral. Also derive the static limit $\\,k \\to 0\\,$.\n\n- Implement three numerically distinct quadrature schemes to approximate $\\,I(R,z,k)\\,$, all designed from first principles:\n  1. A standard polar-coordinate Gaussian quadrature on the radial variable $\\,\\rho \\in [0,R]\\,$ with $\\,\\theta\\,$ integrated analytically, yielding a one-dimensional integral in $\\,\\rho\\,$. The integrand must be expressed directly from the fundamental single-layer definition and the polar area element $\\,\\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\\,$, without any singularity-specific transformation.\n  2. A singularity-subtracted quadrature that decomposes the Helmholtz Green’s kernel as $\\,G_{k} = \\dfrac{1}{4\\pi r} + \\dfrac{e^{ikr} - 1}{4\\pi r}\\,$ with $\\,r = \\sqrt{\\rho^{2}+z^{2}}\\,$, integrates the Laplace-type term $\\,\\dfrac{1}{4\\pi r}\\,$ analytically over the disk, and numerically integrates only the bounded remainder $\\,\\dfrac{e^{ikr} - 1}{4\\pi r}\\,$ using a polar-coordinate Gaussian quadrature on $\\,\\rho\\,$ with $\\,\\theta\\,$ integrated analytically.\n  3. A radial-change-of-variables quadrature induced by the geometric relation $\\,r = \\sqrt{\\rho^{2} + z^{2}}\\,$ and $\\,\\rho\\,\\mathrm{d}\\rho = r\\,\\mathrm{d}r\\,$, with the angular integral performed analytically. This must produce a one-dimensional integral in $\\,r \\in [z,\\sqrt{R^{2}+z^{2}}]\\,$ whose integrand has no $\\,1/r\\,$ singularity.\n\nYour program must implement each scheme in a way that is correct for all $\\,k \\ge 0\\,$, including the static limit $\\,k=0\\,$. You will use the exact closed-form expression you derived as the reference solution in order to compute relative errors.\n\nNumerical outputs and units:\n- All geometric quantities $\\,R\\,$ and $\\,z\\,$ must be interpreted in meters (m). The wave number $\\,k\\,$ must be interpreted in reciprocal meters ($\\,\\mathrm{m}^{-1}\\,$).\n- The output must contain only dimensionless quantities (relative errors and booleans), so no unit conversion or unit labels are required in the output.\n\nTest suite and coverage:\n- For each test case, use two radial quadrature resolutions $\\,N_{\\text{low}}\\,$ and $\\,N_{\\text{high}}\\,$ (both are positive integers) to assess convergence for each scheme. For each scheme, compute the relative error at $\\,N_{\\text{low}}\\,$ and $\\,N_{\\text{high}}\\,$ and return a boolean indicating whether the error decreased when the number of points increased, i.e., whether $\\,\\mathrm{err}(N_{\\text{high}}) \\le \\mathrm{err}(N_{\\text{low}})\\,$.\n- Use the following five test cases, each specified by $\\,\\{R,\\;z,\\;k,\\;N_{\\text{low}},\\;N_{\\text{high}}\\}\\,$:\n  1. $\\,\\{1.0,\\; 10^{-9},\\; 0.0,\\; 8,\\; 32\\}\\,$\n  2. $\\,\\{1.0,\\; 10^{-6},\\; 50.0,\\; 8,\\; 32\\}\\,$\n  3. $\\,\\{0.5,\\; 10^{-4},\\; 200.0,\\; 12,\\; 48\\}\\,$\n  4. $\\,\\{1.0,\\; 0.1,\\; 500.0,\\; 8,\\; 32\\}\\,$\n  5. $\\,\\{0.1,\\; 10^{-3},\\; 1000.0,\\; 8,\\; 32\\}\\,$\n\nFinal output specification:\n- For each test case, produce a list of three booleans $[\\mathrm{b}_{1},\\mathrm{b}_{2},\\mathrm{b}_{3}]$ corresponding to schemes $\\,1,2,3\\,$ respectively, where each boolean is true if the error decreased when going from $\\,N_{\\text{low}}\\,$ to $\\,N_{\\text{high}}\\,$.\n- Your program should produce a single line of output containing the results for all five test cases as a comma-separated list of these boolean triples enclosed in square brackets, for example: $\\,[[\\mathrm{b}_{11},\\mathrm{b}_{12},\\mathrm{b}_{13}],[\\mathrm{b}_{21},\\mathrm{b}_{22},\\mathrm{b}_{23}],\\ldots]\\,$.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Helmholtz equation, $\\nabla^{2} p + k^{2} p = 0$.\n- **Physical Parameters**: Angular frequency $\\omega$, fluid density $\\rho$, sound speed $c$, wave number $k = \\omega/c$.\n- **Green's Function**: Free-space Green's function, $G_{k}(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{i k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}$.\n- **Integral Definition**: The single-layer potential $I(R,z,k)$ for a constant unit source density is defined as:\n$$I(R,z,k) = \\int_{S} G_{k}(\\mathbf{x},\\mathbf{y})\\,\\mathrm{d}S_{\\mathbf{y}}$$\n- **Geometry**:\n    - Source surface $S$ is a circular disk of radius $R$ in the plane $z=0$, centered at the origin: $S = \\{\\mathbf{y} = (\\rho \\cos\\theta,\\rho \\sin\\theta,0) \\mid 0 \\le \\rho \\le R,\\; 0 \\le \\theta  2\\pi\\}$.\n    - Observation point $\\mathbf{x}$ is on the symmetry axis at $(0,0,z)$ with $z0$.\n- **Distance Function**: $\\|\\mathbf{x}-\\mathbf{y}\\| = \\sqrt{\\rho^{2} + z^{2}}$.\n- **Tasks**:\n    1. Derive a closed-form expression for $I(R,z,k)$ from its integral definition for $k \\ge 0$, including the static limit $k \\to 0$.\n    2. Implement three specified quadrature schemes for $I(R,z,k)$: (1) Standard polar-coordinate Gaussian quadrature, (2) Singularity-subtracted quadrature, (3) Radial-change-of-variables quadrature.\n    3. Use the exact solution to compute relative errors for each scheme at two resolutions, $N_{\\text{low}}$ and $N_{\\text{high}}$.\n    4. For each scheme and test case, determine if the error decreases when resolution increases, i.e., $\\mathrm{err}(N_{\\text{high}}) \\le \\mathrm{err}(N_{\\text{low}})$.\n- **Test Cases**: Five sets of parameters $\\{R, z, k, N_{\\text{low}}, N_{\\text{high}}\\}$:\n    1. $\\{1.0, 10^{-9}, 0.0, 8, 32\\}$\n    2. $\\{1.0, 10^{-6}, 50.0, 8, 32\\}$\n    3. $\\{0.5, 10^{-4}, 200.0, 12, 48\\}$\n    4. $\\{1.0, 0.1, 500.0, 8, 32\\}$\n    5. $\\{0.1, 10^{-3}, 1000.0, 8, 32\\}$\n- **Output Format**: A single line representing a list of lists of booleans, e.g., $[[\\mathrm{b}_{11},\\mathrm{b}_{12},\\mathrm{b}_{13}],[\\mathrm{b}_{21},\\mathrm{b}_{22},\\mathrm{b}_{23}], \\ldots ]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Helmholtz equation, a fundamental model for linear time-harmonic acoustics. The boundary element method and single-layer potentials are standard, well-established techniques in computational acoustics and potential theory. All givens are scientifically sound.\n- **Well-Posed**: The problem asks for the derivation and numerical evaluation of a well-defined integral. The geometry and observation point are specified, leading to a unique value for the integral. The tasks are specific and lead to a verifiable result.\n- **Objective**: The problem statement is written in precise, objective mathematical and physical language. It is free of ambiguity, subjectivity, or opinion-based claims.\n- The problem is self-contained, with all necessary definitions and parameters provided. The constraints are consistent. It is not trivial and addresses a core conceptual challenge in numerical BEM: the treatment of near-singular integrals.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Exact Closed-Form Expression\n\nThe single-layer potential $I(R,z,k)$ is given by the integral of the Green's function over the disk $S$.\n$$\nI(R,z,k) = \\int_{S} G_{k}(\\mathbf{x},\\mathbf{y})\\,\\mathrm{d}S_{\\mathbf{y}} = \\int_{S} \\frac{e^{i k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|} \\,\\mathrm{d}S_{\\mathbf{y}}\n$$\nWe introduce polar coordinates for the integration variable $\\mathbf{y}$ on the disk: $\\mathbf{y} = (\\rho \\cos\\theta, \\rho \\sin\\theta, 0)$. The differential area element is $\\mathrm{d}S_{\\mathbf{y}} = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$. The observation point is $\\mathbf{x}=(0,0,z)$. The distance $\\|\\mathbf{x}-\\mathbf{y}\\|$ is independent of the angle $\\theta$:\n$$\n\\|\\mathbf{x}-\\mathbf{y}\\| = \\sqrt{(0-\\rho\\cos\\theta)^2 + (0-\\rho\\sin\\theta)^2 + (z-0)^2} = \\sqrt{\\rho^2(\\cos^2\\theta + \\sin^2\\theta) + z^2} = \\sqrt{\\rho^2 + z^2}\n$$\nThe integral becomes:\n$$\nI(R,z,k) = \\int_{0}^{2\\pi} \\int_{0}^{R} \\frac{e^{i k \\sqrt{\\rho^2+z^2}}}{4 \\pi \\sqrt{\\rho^2+z^2}} \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n$$\nSince the integrand does not depend on $\\theta$, the angular integral yields a factor of $2\\pi$:\n$$\nI(R,z,k) = \\frac{2\\pi}{4\\pi} \\int_{0}^{R} \\frac{e^{i k \\sqrt{\\rho^2+z^2}}}{\\sqrt{\\rho^2+z^2}} \\rho\\,\\mathrm{d}\\rho = \\frac{1}{2} \\int_{0}^{R} \\frac{e^{i k \\sqrt{\\rho^2+z^2}}}{\\sqrt{\\rho^2+z^2}} \\rho\\,\\mathrm{d}\\rho\n$$\nTo evaluate the remaining integral, we perform a change of variables. Let $r = \\sqrt{\\rho^2+z^2}$. Differentiating gives $2r\\,\\mathrm{d}r = 2\\rho\\,\\mathrm{d}\\rho$, so $\\rho\\,\\mathrm{d}\\rho = r\\,\\mathrm{d}r$. We update the integration limits: for $\\rho=0$, $r = z$; for $\\rho=R$, $r = \\sqrt{R^2+z^2}$. Substituting into the integral:\n$$\nI(R,z,k) = \\frac{1}{2} \\int_{z}^{\\sqrt{R^2+z^2}} \\frac{e^{ikr}}{r} (r\\,\\mathrm{d}r) = \\frac{1}{2} \\int_{z}^{\\sqrt{R^2+z^2}} e^{ikr}\\,\\mathrm{d}r\n$$\nThis integral is elementary. We consider two cases.\n\n**Case 1: $k  0$**\n$$\nI(R,z,k) = \\frac{1}{2} \\left[ \\frac{e^{ikr}}{ik} \\right]_{z}^{\\sqrt{R^2+z^2}} = \\frac{1}{2ik} \\left( e^{ik\\sqrt{R^2+z^2}} - e^{ikz} \\right)\n$$\n\n**Case 2: $k = 0$ (Static limit)**\n$$\nI(R,z,0) = \\frac{1}{2} \\int_{z}^{\\sqrt{R^2+z^2}} e^{0}\\,\\mathrm{d}r = \\frac{1}{2} \\int_{z}^{\\sqrt{R^2+z^2}} 1\\,\\mathrm{d}r = \\frac{1}{2} [r]_z^{\\sqrt{R^2+z^2}} = \\frac{1}{2} \\left(\\sqrt{R^2+z^2} - z\\right)\n$$\nTo verify consistency, we check the limit of the $k0$ expression as $k \\to 0$. Using the Taylor expansion $e^x \\approx 1+x$ for small $x$:\n$$\n\\lim_{k \\to 0} I(R,z,k) = \\lim_{k \\to 0} \\frac{1}{2ik} \\left( \\left(1+ik\\sqrt{R^2+z^2}\\right) - (1+ikz) + O(k^2) \\right) = \\lim_{k \\to 0} \\frac{ik\\left(\\sqrt{R^2+z^2}-z\\right)}{2ik} = \\frac{1}{2}\\left(\\sqrt{R^2+z^2}-z\\right)\n$$\nThe limit matches the static case result.\n\n### Design of Quadrature Schemes\n\nWe will use $N$-point Gauss-Legendre quadrature. The nodes $t_i$ and weights $w_i$ are defined on the interval $[-1, 1]$. For an integral over $[a, b]$, a change of variables $x(t) = \\frac{b-a}{2}t + \\frac{a+b}{2}$ is used:\n$$ \\int_a^b f(x)\\,\\mathrm{d}x \\approx \\frac{b-a}{2} \\sum_{i=1}^N w_i f(x(t_i)) $$\n\n**1. Standard Polar-Coordinate Quadrature**\nThis scheme directly approximates the one-dimensional integral in $\\rho \\in [0, R]$:\n$$\nI(R,z,k) = \\frac{1}{2} \\int_{0}^{R} f(\\rho) \\,\\mathrm{d}\\rho \\quad \\text{with} \\quad f(\\rho) = \\frac{\\rho}{\\sqrt{\\rho^2+z^2}} e^{ik\\sqrt{\\rho^2+z^2}}\n$$\nApproximation with $N$-point Gaussian quadrature yields:\n$$\nI_1(R,z,k) \\approx \\frac{1}{2} \\left( \\frac{R}{2} \\sum_{i=1}^N w_i f(\\rho_i) \\right), \\quad \\text{where} \\quad \\rho_i = \\frac{R}{2}(t_i+1)\n$$\nFor small $z$, the term $\\frac{\\rho}{\\sqrt{\\rho^2+z^2}}$ creates a sharp gradient near $\\rho=0$, which can lead to poor accuracy for a low number of quadrature points $N$.\n\n**2. Singularity-Subtracted Quadrature**\nWe decompose the Green's function kernel:\n$$ G_k = G_0 + (G_k - G_0) \\quad \\text{where} \\quad G_0(\\mathbf{x},\\mathbf{y}) = \\frac{1}{4\\pi\\|\\mathbf{x}-\\mathbf{y}\\|} $$\nThe integral is split into an analytic part and a part to be computed numerically:\n$$ I(R,z,k) = \\int_S G_0\\,\\mathrm{d}S + \\int_S (G_k - G_0)\\,\\mathrm{d}S $$\nThe first term is the static integral, which we have already solved analytically:\n$$ I_{\\text{analytic}} = \\int_S G_0\\,\\mathrm{d}S = I(R,z,0) = \\frac{1}{2}(\\sqrt{R^2+z^2}-z) $$\nThe second term is evaluated numerically. After angular integration, it becomes:\n$$ I_{\\text{numeric}} = \\frac{1}{2} \\int_{0}^{R} \\rho \\frac{e^{ik\\sqrt{\\rho^2+z^2}}-1}{\\sqrt{\\rho^2+z^2}} \\,\\mathrm{d}\\rho $$\nThe integrand $g(\\rho) = \\rho \\frac{e^{ik\\sqrt{\\rho^2+z^2}}-1}{\\sqrt{\\rho^2+z^2}}$ is well-behaved. As $r = \\sqrt{\\rho^2+z^2} \\to 0$, we have $\\frac{e^{ikr}-1}{r} \\to ik$, removing the singularity. The numerical approximation is:\n$$ I_2(R,z,k) \\approx I_{\\text{analytic}} + \\frac{1}{2} \\left( \\frac{R}{2} \\sum_{i=1}^N w_i g(\\rho_i) \\right) $$\nThis scheme is expected to be more accurate than the standard approach, especially for small $z$.\n\n**3. Radial-Change-of-Variables Quadrature**\nThis scheme applies numerical quadrature to the simplified integral derived for the exact solution. The change of variables $r = \\sqrt{\\rho^2+z^2}$ transforms the integral to:\n$$ I(R,z,k) = \\frac{1}{2} \\int_{z}^{\\sqrt{R^2+z^2}} h(r)\\,\\mathrm{d}r \\quad \\text{with} \\quad h(r) = e^{ikr} $$\nThe integrand $h(r)$ is analytic (perfectly smooth), making it ideal for Gaussian quadrature. The integration interval is $[a, b]$ with $a=z$ and $b=\\sqrt{R^2+z^2}$. The approximation is:\n$$ I_3(R,z,k) \\approx \\frac{1}{2} \\left( \\frac{b-a}{2} \\sum_{i=1}^N w_i h(r_i) \\right), \\quad \\text{where} \\quad r_i = \\frac{b-a}{2}t_i + \\frac{a+b}{2} $$\nThis scheme is expected to yield the highest accuracy, as the transformation completely removes any singular or near-singular behavior from the integrand.\n\nThe implementation will follow these derivations, using `scipy.special.roots_legendre` to obtain quadrature nodes and weights. Relative errors against the exact solution will be computed to assess convergence for each scheme as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef exact_solution(R, z, k):\n    \"\"\"\n    Computes the exact closed-form solution for I(R, z, k).\n    \"\"\"\n    if k == 0.0:\n        # Static case (k=0)\n        return 0.5 * (np.sqrt(R**2 + z**2) - z)\n    else:\n        # Harmonic case (k > 0)\n        r_at_R = np.sqrt(R**2 + z**2)\n        val = (np.exp(1j * k * r_at_R) - np.exp(1j * k * z)) / (2j * k)\n        return val\n\ndef scheme1_standard(R, z, k, N):\n    \"\"\"\n    Scheme 1: Standard polar-coordinate Gaussian quadrature.\n    \"\"\"\n    nodes, weights = roots_legendre(N)\n    \n    # Map nodes from [-1, 1] to [0, R] for rho integration\n    rho = 0.5 * R * (nodes + 1.0)\n    \n    # Integrand: f(rho) = rho / sqrt(rho^2+z^2) * exp(i*k*sqrt(rho^2+z^2))\n    r = np.sqrt(rho**2 + z**2)\n    \n    # Since z > 0 and Legendre nodes are in (-1, 1), rho > 0, so r is never zero.\n    integrand = (rho / r) * np.exp(1j * k * r)\n    \n    # Apply Gaussian quadrature formula\n    integral_val = 0.5 * R * np.sum(weights * integrand)\n    \n    return 0.5 * integral_val\n\ndef scheme2_subtraction(R, z, k, N):\n    \"\"\"\n    Scheme 2: Singularity-subtracted quadrature.\n    \"\"\"\n    # Analytically integrated part (Laplace kernel)\n    analytic_part = 0.5 * (np.sqrt(R**2 + z**2) - z)\n    \n    if k == 0.0:\n        # For k=0, the remainder term is zero, so the result is just the analytic part.\n        return analytic_part\n        \n    # Numerically integrated part (Helmholtz minus Laplace kernel)\n    nodes, weights = roots_legendre(N)\n    \n    # Map nodes to [0, R] for rho integration\n    rho = 0.5 * R * (nodes + 1.0)\n    r = np.sqrt(rho**2 + z**2)\n    \n    # The term (exp(1j*k*r) - 1) is handled by np.expm1 for better precision\n    # when the argument is small. Division by r is safe as r >= z > 0.\n    # Integrand: g(rho) = rho * (exp(i*k*r) - 1) / r\n    integrand = rho * np.expm1(1j * k * r) / r\n    \n    numerical_integral = 0.5 * R * np.sum(weights * integrand)\n    \n    return analytic_part + 0.5 * numerical_integral\n\ndef scheme3_cov(R, z, k, N):\n    \"\"\"\n    Scheme 3: Radial-change-of-variables quadrature.\n    \"\"\"\n    nodes, weights = roots_legendre(N)\n    \n    # Integration limits for the new variable r\n    a = z\n    b = np.sqrt(R**2 + z**2)\n    \n    # Handle the case R=0, where the integral is trivially zero.\n    if np.isclose(a, b):\n        return 0.0\n\n    # Map nodes from [-1, 1] to [z, sqrt(R^2+z^2)] for r integration\n    r = 0.5 * (b - a) * nodes + 0.5 * (b + a)\n    \n    # Integrand: h(r) = exp(i*k*r)\n    integrand = np.exp(1j * k * r)\n    \n    # Apply Gaussian quadrature formula\n    integral_val = 0.5 * (b - a) * np.sum(weights * integrand)\n    \n    return 0.5 * integral_val\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and generate the final output.\n    \"\"\"\n    test_cases = [\n        # (R, z, k, N_low, N_high)\n        (1.0, 1e-9, 0.0, 8, 32),\n        (1.0, 1e-6, 50.0, 8, 32),\n        (0.5, 1e-4, 200.0, 12, 48),\n        (1.0, 0.1, 500.0, 8, 32),\n        (0.1, 1e-3, 1000.0, 8, 32),\n    ]\n\n    all_results = []\n    schemes = [scheme1_standard, scheme2_subtraction, scheme3_cov]\n\n    for R, z, k, N_low, N_high in test_cases:\n        case_results = []\n        \n        # Calculate the reference solution\n        I_exact = exact_solution(R, z, k)\n        abs_I_exact = np.abs(I_exact)\n\n        def get_relative_error(approx_val, exact_val):\n            # Use relative error, or absolute error if exact is zero.\n            if abs_I_exact > 0:\n                return np.abs(approx_val - exact_val) / abs_I_exact\n            return np.abs(approx_val - exact_val)\n        \n        for scheme_func in schemes:\n            # Calculate approximations at low and high resolution\n            I_low = scheme_func(R, z, k, N_low)\n            I_high = scheme_func(R, z, k, N_high)\n            \n            # Calculate corresponding errors\n            err_low = get_relative_error(I_low, I_exact)\n            err_high = get_relative_error(I_high, I_exact)\n            \n            # Check if error decreased (or stayed the same) with more points\n            converged = err_high = err_low\n            case_results.append(converged)\n            \n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists of booleans, without spaces\n    list_of_strs = [str(res).replace(\" \", \"\") for res in all_results]\n    print(f\"[{','.join(list_of_strs)}]\")\n\nsolve()\n```"
        }
    ]
}