{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你求解一个具有混合边界条件的矩形声腔内的声学模式。与理想化的全刚性或全软边界不同，此处的腔体包含一个压力释放（软）壁和五个刚性（硬）壁，这更贴近实际应用场景。通过这个实践，你将掌握如何通过分离变量法和施加不同的边界条件来确定模态振型和共振频率，这是设计和分析声学谐振系统的核心技能。",
            "id": "4114455",
            "problem": "考虑一个三维矩形声学腔体，占据 $0 \\leq x \\leq L_{x}$，$0 \\leq y \\leq L_{y}$，$0 \\leq z \\leq L_{z}$ 的空间，腔体内充满密度为 $\\rho_{0}$、声速为 $c$ 的均匀、无损耗流体。$x=0$ 处的壁面为压力释放（软）边界，其余五个壁面为刚性（硬）边界。假设为小振幅、无粘性的声学问题。从线性声波方程及其时谐形式出发，推导声压场 $p(x,y,z,t)$ 的分离变量本征值问题，求出满足混合边界条件（$x=0$ 处为狄利克雷条件，所有其他壁面为诺伊曼条件）的模态振型函数，并确定相应的离散轴向、横向和垂向波数。根据你推导出的模态振型，分析沿 $x$ 轴相对于软边界的压力波节的位置，并描述 $x=L_{x}$ 处的刚性壁面是与波节平面重合还是与波腹平面重合。最后，利用你的结果，计算当 $L_{x} = 0.75\\,\\mathrm{m}$、$L_{y} = 0.40\\,\\mathrm{m}$、$L_{z} = 0.30\\,\\mathrm{m}$ 且 $c = 343\\,\\mathrm{m/s}$ 时，腔体的基频（最低的非零频率模态）。将你的答案四舍五入至四位有效数字。频率单位为赫兹（Hz）。",
            "solution": "该问题要求在一个具有混合边界条件的矩形腔体中推导声学模态并计算基频。该过程从线性声波方程开始，通过分离变量法得到一个本征值问题。\n\n在均匀、无损耗流体中，声压扰动 $p(x,y,z,t)$ 的控制方程是线性波方程：\n$$\n\\nabla^2 p - \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} = 0\n$$\n其中 $c$ 是声速。我们寻求形式为 $p(x,y,z,t) = P(x,y,z) \\exp(i\\omega t)$ 的时谐解，其中 $P(x,y,z)$ 是复压幅，$\\omega$ 是角频率，且 $i = \\sqrt{-1}$。将此代入波动方程，得到空间部分 $P(x,y,z)$ 的亥姆霍兹方程：\n$$\n\\nabla^2 P + k^2 P = 0\n$$\n其中 $k = \\omega/c$ 是波数。\n\n边界条件必须转换为针对空间振幅 $P$ 的形式。\n压力释放（软）边界意味着压力为零。在 $x=0$ 处，这给出了一个狄利克雷边界条件：\n$$\nP(0, y, z) = 0\n$$\n刚性（硬）边界意味着法向质点速度为零。根据线性化的欧拉方程 $\\rho_0 \\partial\\vec{u}/\\partial t = -\\nabla p$，该条件变为 $\\nabla p \\cdot \\hat{n} = 0$，其中 $\\hat{n}$ 是外法向向量。对于空间振幅 $P$，这给出了一个诺伊曼边界条件 $\\nabla P \\cdot \\hat{n} = 0$。五个刚性壁面分别位于 $x=L_x$、$y=0$、$y=L_y$、$z=0$ 和 $z=L_z$。条件如下：\n$$\n\\frac{\\partial P}{\\partial x}(L_x, y, z) = 0\n$$\n$$\n\\frac{\\partial P}{\\partial y}(x, 0, z) = 0 \\quad \\text{和} \\quad \\frac{\\partial P}{\\partial y}(x, L_y, z) = 0\n$$\n$$\n\\frac{\\partial P}{\\partial z}(x, y, 0) = 0 \\quad \\text{和} \\quad \\frac{\\partial P}{\\partial z}(x, y, L_z) = 0\n$$\n\n我们使用分离变量法求解亥姆霍兹方程。设 $P(x,y,z) = X(x)Y(y)Z(z)$。将其代入亥姆霍兹方程并除以 $P(x,y,z)$，得到：\n$$\n\\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\frac{1}{Z(z)}\\frac{d^2Z}{dz^2} = -k^2\n$$\n该方程可分离为三个常微分方程，它们构成了分离的本征值问题：\n$$\n\\frac{d^2X}{dx^2} + k_x^2 X = 0\n$$\n$$\n\\frac{d^2Y}{dy^2} + k_y^2 Y = 0\n$$\n$$\n\\frac{d^2Z}{dz^2} + k_z^2 Z = 0\n$$\n并满足色散关系 $k_x^2 + k_y^2 + k_z^2 = k^2$。常数 $k_x$、$k_y$ 和 $k_z$ 分别是轴向、横向和垂向波数。\n\n我们现在求解每个常微分方程及其对应的边界条件。\n\n对于 $x$ 方向：\n通解为 $X(x) = A \\cos(k_x x) + B \\sin(k_x x)$。\n$x=0$ 处的软边界要求 $X(0)=0$。这得出 $A \\cos(0) + B \\sin(0) = A = 0$。因此，$X(x) = B \\sin(k_x x)$。\n$x=L_x$ 处的刚性边界要求 $X'(L_x)=0$。导数为 $X'(x) = B k_x \\cos(k_x x)$。条件为 $B k_x \\cos(k_x L_x) = 0$。对于非平凡解（$B \\neq 0$，$k_x \\neq 0$），必须有 $\\cos(k_x L_x) = 0$。这发生在 $k_x L_x = (m_x - 1/2)\\pi$ 时，其中整数 $m_x = 1, 2, 3, \\ldots$。轴向波数为：\n$$\nk_x = \\frac{(m_x - 1/2)\\pi}{L_x}, \\quad m_x \\in \\{1, 2, 3, \\dots\\}\n$$\n$x$ 方向对应的模态振型函数是 $X_{m_x}(x) = \\sin\\left(\\frac{(m_x - 1/2)\\pi x}{L_x}\\right)$。\n\n对于 $y$ 方向：\n通解为 $Y(y) = C \\cos(k_y y) + D \\sin(k_y y)$。\n$y=0$ 处的刚性边界要求 $Y'(0)=0$。导数为 $Y'(y) = -C k_y \\sin(k_y y) + D k_y \\cos(k_y y)$。在 $y=0$ 处，我们得到 $D k_y \\cos(0) = D k_y = 0$。对于 $k_y \\neq 0$，这意味着 $D=0$。因此 $Y(y) = C \\cos(k_y y)$。如果 $k_y=0$，$Y(y)$ 是一个常数，也满足 $Y'(0)=0$。\n$y=L_y$ 处的刚性边界要求 $Y'(L_y)=0$。这给出 $-C k_y \\sin(k_y L_y) = 0$。对于非平凡解，必须有 $\\sin(k_y L_y) = 0$。这发生在 $k_y L_y = m_y \\pi$ 时，其中整数 $m_y = 0, 1, 2, \\ldots$。$m_y=0$ 的情况给出 $k_y=0$，这对应于 $y$ 方向上恒定的压力分布 $Y(y)=C$，满足两个边界条件。离散的横向波数为：\n$$\nk_y = \\frac{m_y \\pi}{L_y}, \\quad m_y \\in \\{0, 1, 2, \\dots\\}\n$$\n$y$ 方向的模态振型函数是 $Y_{m_y}(y) = \\cos\\left(\\frac{m_y \\pi y}{L_y}\\right)$。\n\n对于 $z$ 方向：\n该问题与 $y$ 方向的情况完全相同。垂向波数为：\n$$\nk_z = \\frac{m_z \\pi}{L_z}, \\quad m_z \\in \\{0, 1, 2, \\dots\\}\n$$\n$z$ 方向的模态振型函数是 $Z_{m_z}(z) = \\cos\\left(\\frac{m_z \\pi z}{L_z}\\right)$。\n\n完整的压力模态振型函数是各个方向函数的乘积，由模态数 $(m_x, m_y, m_z)$ 索引：\n$$\nP_{m_x, m_y, m_z}(x,y,z) = A_{m_x m_y m_z} \\sin\\left(\\frac{(m_x - 1/2)\\pi x}{L_x}\\right) \\cos\\left(\\frac{m_y \\pi y}{L_y}\\right) \\cos\\left(\\frac{m_z \\pi z}{L_z}\\right)\n$$\n其中 $m_x \\in \\{1, 2, 3, \\ldots\\}$ 且 $m_y, m_z \\in \\{0, 1, 2, \\ldots\\}$。\n\n现在我们分析沿 $x$ 轴的压力波节和波腹。压力波节是 $P=0$ 恒成立的平面。这发生在空间模态函数为零的地方。$x=0$ 处的压力释放壁面是一个波节平面，因为 $\\sin(0)=0$。\n在 $x=L_x$ 处的刚性壁面，模态振型中依赖于 $x$ 的部分的值为：\n$$\n\\sin\\left(\\frac{(m_x - 1/2)\\pi L_x}{L_x}\\right) = \\sin\\left((m_x - 1/2)\\pi\\right)\n$$\n对于 $m_x=1, 2, 3, \\ldots$，该表达式的值分别为 $\\sin(\\pi/2)=1$, $\\sin(3\\pi/2)=-1$, $\\sin(5\\pi/2)=1$ 等等。在所有情况下，其幅值均为 $|\\sin((m_x - 1/2)\\pi)| = 1$。由于这是正弦函数的最大可能幅值，因此压幅在该平面上达到最大值。所以，$x=L_x$ 处的刚性壁面与压力波腹平面重合。\n\n共振角频率 $\\omega_{m_x, m_y, m_z}$ 可通过色散关系求得：$\\omega = ck = c\\sqrt{k_x^2 + k_y^2 + k_z^2}$。共振频率 $f = \\omega/(2\\pi)$ 为：\n$$\nf_{m_x, m_y, m_z} = \\frac{c}{2\\pi} \\sqrt{\\left(\\frac{(m_x - 1/2)\\pi}{L_x}\\right)^2 + \\left(\\frac{m_y \\pi}{L_y}\\right)^2 + \\left(\\frac{m_z \\pi}{L_z}\\right)^2}\n$$\n$$\nf_{m_x, m_y, m_z} = \\frac{c}{2} \\sqrt{\\left(\\frac{m_x - 1/2}{L_x}\\right)^2 + \\left(\\frac{m_y}{L_y}\\right)^2 + \\left(\\frac{m_z}{L_z}\\right)^2}\n$$\n基频是最低的非零频率。这对应于整数模态数 $(m_x, m_y, m_z)$ 的最小可能取值，即 $m_x=1$，$m_y=0$ 和 $m_z=0$。因此，基频模态是 $(1,0,0)$ 模态。\n将这些指数代入频率公式：\n$$\nf_{1,0,0} = \\frac{c}{2} \\sqrt{\\left(\\frac{1 - 1/2}{L_x}\\right)^2 + \\left(\\frac{0}{L_y}\\right)^2 + \\left(\\frac{0}{L_z}\\right)^2} = \\frac{c}{2} \\sqrt{\\left(\\frac{1/2}{L_x}\\right)^2} = \\frac{c}{2} \\left(\\frac{1}{2L_x}\\right)\n$$\n$$\nf_{1,0,0} = \\frac{c}{4L_x}\n$$\n这是经典的一端开口、一端闭口的管道的四分之一波长共振频率。\n\n最后，我们使用给定的数据计算数值：$L_x = 0.75\\,\\mathrm{m}$ 和 $c = 343\\,\\mathrm{m/s}$。其他尺寸 $L_y = 0.40\\,\\mathrm{m}$ 和 $L_z = 0.30\\,\\mathrm{m}$ 在这种特定配置下与基频无关。\n$$\nf_{1,0,0} = \\frac{343}{4 \\times 0.75} = \\frac{343}{3} \\approx 114.333\\ldots\\,\\mathrm{Hz}\n$$\n四舍五入到四位有效数字，得到 $114.3\\,\\mathrm{Hz}$。",
            "answer": "$$\n\\boxed{114.3}\n$$"
        },
        {
            "introduction": "在前一个练习的基础上，我们从笛卡尔坐标系转向在管道和波导问题中更常见的圆柱坐标系。本练习深入探讨了模态展开的数学基础，特别是要求你证明声模的正交性并推导其归一化常数。掌握这些形式化的性质至关重要，因为它们是正确运用模态叠加来表示复杂声场、并在计算中确保能量守恒的理论保证。",
            "id": "4114396",
            "problem": "在半径为 $a$ 的圆柱形波导中，一个时谐声压场 $p(r,\\theta,z)$ 充满了均匀、各向同性的流体，该声压场满足标量亥姆霍兹方程 $\\nabla^{2}p + k^{2} p = 0$，其中 $\\nabla^{2}$ 是圆柱坐标 $(r,\\theta,z)$ 中的拉普拉斯算子，$k$ 是声波数。假设 $r=a$ 处的边界是声学软边界（压力释放），因此 $p(r=a,\\theta,z)=0$。通过分离变量法，横截面本征函数可以写为\n$$\n\\Phi_{mn}(r,\\theta) = C_{mn}\\,J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(i m \\theta),\n$$\n其中 $m\\in\\mathbb{Z}$ 是方位角指数，$n\\in\\mathbb{N}$ 是径向指数，$J_{m}$ 是 $m$ 阶第一类贝塞尔函数，$\\zeta_{mn}$ 是 $J_{m}(x)=0$ 的第 $n$ 个正根，$C_{mn}$ 是一个待确定的实数归一化常数。\n\n从控制方程和分离出的圆柱坐标径向算子的自伴随结构出发，严格证明不同横截面模式相对于面积元 $r\\,dr\\,d\\theta$ 的正交性，即证明\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{a} r\\,\\Phi_{mn}(r,\\theta)\\,\\Phi_{m'n'}(r,\\theta)^{*}\\,dr\\,d\\theta = 0\n$$\n当 $(m,n)\\neq(m',n')$ 时成立，其中 ${}^{*}$ 表示复共轭。\n\n然后，推导归一化常数 $C_{mn}$ 的显式闭合表达式，使得集合 $\\{\\Phi_{mn}\\}$ 在横截面上是标准正交的，\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{a} r\\,|\\Phi_{mn}(r,\\theta)|^{2}\\,dr\\,d\\theta = 1.\n$$\n\n将你关于 $C_{mn}$ 的最终答案表示为包含 $a$, $\\pi$, 和 $J_{m+1}(\\zeta_{mn})$ 的单一解析表达式。不需要进行数值计算。",
            "solution": "该问题要求对横截面本征函数 $\\Phi_{mn}(r,\\theta)$ 进行两项推导：首先，建立它们的正交性；其次，确定使本征函数集标准正交的归一化常数 $C_{mn}$。\n\n横截面本征函数由下式给出\n$$ \\Phi_{mn}(r,\\theta) = C_{mn}\\,J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(i m \\theta) $$\n其中 $m \\in \\mathbb{Z}$，$n \\in \\mathbb{N}$，$J_m$ 是 $m$ 阶第一类贝塞尔函数，$\\zeta_{mn}$ 是 $J_m(x)=0$ 的第 $n$ 个正根。边界条件是 $\\Phi_{mn}(a, \\theta) = 0$。\n\n### 第一部分：本征函数的正交性\n\n我们必须证明当 $(m,n)\\neq(m',n')$ 时，下式成立\n$$ \\int_{0}^{2\\pi}\\int_{0}^{a} r\\,\\Phi_{mn}(r,\\theta)\\,\\Phi_{m'n'}(r,\\theta)^{*}\\,dr\\,d\\theta = 0 $$\n我们将这个积分表示为 $I_{(m,n),(m',n')}$。\n代入 $\\Phi_{mn}$ 的表达式及其复共轭 $\\Phi_{m'n'}^{*}$，我们得到：\n$$ I_{(m,n),(m',n')} = \\int_{0}^{2\\pi}\\int_{0}^{a} r \\left[ C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(im\\theta) \\right] \\left[ C_{m'n'}J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right)\\exp(-im'\\theta) \\right] dr\\,d\\theta $$\n由于归一化常数 $C_{mn}$ 是实数，且实数宗量的贝塞尔函数是实数值的，表达式简化为：\n$$ I_{(m,n),(m',n')} = C_{mn}C_{m'n'} \\int_{0}^{2\\pi}\\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right) \\exp(i(m-m')\\theta) \\, dr\\,d\\theta $$\n该积分可以分离为方位角部分和径向部分：\n$$ I_{(m,n),(m',n')} = C_{mn}C_{m'n'} \\left( \\int_{0}^{2\\pi} \\exp(i(m-m')\\theta) d\\theta \\right) \\left( \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right) dr \\right) $$\n\n我们考虑 $(m,n) \\neq (m',n')$ 的两种情况。\n\n**情况1：$m \\neq m'$**\n首先计算方位角积分。由于 $m, m' \\in \\mathbb{Z}$ 且 $m \\neq m'$，差值 $m-m'$ 是一个非零整数。\n$$ \\int_{0}^{2\\pi} \\exp(i(m-m')\\theta) d\\theta = \\left[ \\frac{\\exp(i(m-m')\\theta)}{i(m-m')} \\right]_{0}^{2\\pi} = \\frac{\\exp(i(m-m')2\\pi) - \\exp(0)}{i(m-m')} = \\frac{1-1}{i(m-m')} = 0 $$\n由于方位角积分为零，无论径向积分的值是多少，整个积分 $I_{(m,n),(m',n')}$ 都为零。因此，具有不同方位角指数 $m$ 的本征函数是正交的。\n\n**情况2：$m = m'$ 且 $n \\neq n'$**\n当 $m=m'$ 时，方位角积分变为：\n$$ \\int_{0}^{2\\pi} \\exp(i(m-m)\\theta) d\\theta = \\int_{0}^{2\\pi} \\exp(0) d\\theta = \\int_{0}^{2\\pi} 1 d\\theta = 2\\pi $$\n总积分现在是：\n$$ I_{(m,n),(m,n')} = 2\\pi C_{mn}C_{mn'} \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m}\\!\\left(\\frac{\\zeta_{mn'}}{a}r\\right) dr $$\n为了证明正交性，我们必须证明当 $n \\neq n'$ 时，径向积分为零。按照要求，我们从控制方程开始。横截面本征函数 $\\Phi$ 满足横向亥姆霍兹方程 $\\nabla_t^2 \\Phi + k_t^2 \\Phi = 0$。使用分离变量法 $\\Phi(r,\\theta)=R(r)\\Theta(\\theta)$，径向部分 $R(r)$ 满足贝塞尔微分方程：\n$$ r^2 R'' + r R' + (k_t^2 r^2 - m^2)R = 0 $$\n其中 $R(r)$ 在 $r=0$ 处必须是正则的，并满足边界条件 $R(a)=0$。这可以重写为 Sturm-Liouville 形式：\n$$ \\frac{d}{dr}\\left(r \\frac{dR}{dr}\\right) - \\frac{m^2}{r}R + k_t^2 r R = 0 $$\n这个方程对应于算子 $L = \\frac{d}{dr}(r\\frac{d}{dr}) - \\frac{m^2}{r}$ 的一个 Sturm-Liouville 问题，其特征值为 $\\lambda=k_t^2$，权重函数为 $w(r)=r$。径向本征函数 $R_{mn}(r) = J_m(k_{t,mn}r)$ 满足边界条件，$R_{mn}(0)$ 是有限的且 $R_{mn}(a)=0$。$r=a$ 处的边界条件将横向波数 $k_t$ 量子化，使得 $k_{t,mn}a = \\zeta_{mn}$，或 $k_{t,mn} = \\zeta_{mn}/a$。对应的特征值为 $\\lambda_n = k_{t,mn}^2 = (\\zeta_{mn}/a)^2$。\n对于 $n \\neq n'$，我们有 $\\zeta_{mn} \\neq \\zeta_{mn'}$，这意味着 $\\lambda_n \\neq \\lambda_{n'}$。Sturm-Liouville 理论保证，自伴随算子的对应于不同特征值的本征函数相对于权重函数是正交的。在给定边界条件下，该算子在区间 $[0,a]$ 上是自伴随的。\n因此，径向本征函数 $R_{mn}(r) = J_m(\\frac{\\zeta_{mn}}{a}r)$ 和 $R_{mn'}(r) = J_m(\\frac{\\zeta_{mn'}}{a}r)$ 相对于权重函数 $r$ 是正交的：\n$$ \\int_{0}^{a} r \\, R_{mn}(r) R_{mn'}(r) dr = \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m}\\!\\left(\\frac{\\zeta_{mn'}}{a}r\\right) dr = 0 $$\n这证明了当 $n \\neq n'$ 时，径向积分为零。因此，$I_{(m,n),(m,n')}=0$。\n综合两种情况，对于任何 $(m,n) \\neq (m',n')$，本征函数 $\\Phi_{mn}$ 和 $\\Phi_{m'n'}$ 都是正交的。\n\n### 第二部分：归一化常数的推导\n\n我们需要找到实数常数 $C_{mn}$，使得本征函数集是标准正交的。这要求本征函数的模平方在横截面上的积分为1：\n$$ \\int_{0}^{2\\pi}\\int_{0}^{a} r\\,|\\Phi_{mn}(r,\\theta)|^{2}\\,dr\\,d\\theta = 1 $$\n我们计算 $\\Phi_{mn}$ 的模平方：\n$$ |\\Phi_{mn}(r,\\theta)|^2 = \\left(C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(im\\theta)\\right) \\left(C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(-im\\theta)\\right) = C_{mn}^2 \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 $$\n归一化积分变为：\n$$ C_{mn}^2 \\int_{0}^{2\\pi}\\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr\\,d\\theta = 1 $$\n分离变量：\n$$ C_{mn}^2 \\left(\\int_{0}^{2\\pi} d\\theta\\right) \\left(\\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr\\right) = 1 $$\n方位角积分为 $\\int_{0}^{2\\pi} d\\theta = 2\\pi$。归一化条件简化为：\n$$ 2\\pi C_{mn}^2 \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = 1 $$\n为了计算径向积分，我们使用贝塞尔函数平方的积分的标准恒等式（一个 Lommel 积分）：\n$$ \\int x [J_m(\\alpha x)]^2 dx = \\frac{x^2}{2} \\left( [J_m'(\\alpha x)]^2 + \\left(1 - \\frac{m^2}{\\alpha^2 x^2}\\right) [J_m(\\alpha x)]^2 \\right) $$\n在我们的情况中，积分从 $r=0$ 到 $r=a$，且 $\\alpha = \\zeta_{mn}/a$。\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\left[ \\frac{r^2}{2} \\left( \\left[J_{m}'\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 + \\left(1 - \\frac{m^2}{(\\zeta_{mn}/a)^2 r^2}\\right) \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 \\right) \\right]_{0}^{a} $$\n在下限 $r=0$ 处，积分值为 $0$（对于 $m0$，$J_m(0)=0$；对于 $m=0$，$J_0(0)=1$ 但 $r^2=0$ 起主导作用；对于 $m0$，行为与 $m>0$ 类似）。在上限 $r=a$ 处，我们有 $\\frac{\\zeta_{mn}}{a}r = \\zeta_{mn}$。根据定义，$\\zeta_{mn}$ 是 $J_m(x)$ 的一个根，所以 $J_m(\\zeta_{mn}) = 0$。表达式显著简化为：\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\frac{a^2}{2} \\left[J_{m}'(\\zeta_{mn})\\right]^2 $$\n现在我们使用一个贝塞尔函数递推关系来用 $J_{m+1}$ 表示导数 $J_m'$：\n$$ J_{m}'(z) = -J_{m+1}(z) + \\frac{m}{z}J_m(z) $$\n在 $z = \\zeta_{mn}$ 处计算该式，其中 $J_m(\\zeta_{mn}) = 0$，我们得到：\n$$ J_{m}'(\\zeta_{mn}) = -J_{m+1}(\\zeta_{mn}) $$\n因此，$\\left[J_{m}'(\\zeta_{mn})\\right]^2 = \\left[-J_{m+1}(\\zeta_{mn})\\right]^2 = \\left[J_{m+1}(\\zeta_{mn})\\right]^2$。\n因此，径向积分为：\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\frac{a^2}{2} \\left[J_{m+1}(\\zeta_{mn})\\right]^2 $$\n将此代回归一化条件：\n$$ 2\\pi C_{mn}^2 \\left( \\frac{a^2}{2} [J_{m+1}(\\zeta_{mn})]^2 \\right) = 1 $$\n$$ \\pi a^2 C_{mn}^2 [J_{m+1}(\\zeta_{mn})]^2 = 1 $$\n求解实数常数 $C_{mn}$：\n$$ C_{mn}^2 = \\frac{1}{\\pi a^2 [J_{m+1}(\\zeta_{mn})]^2} $$\n$J_m(z)$ 和 $J_{m+1}(z)$ 的零点已知在 $z \\neq 0$ 时是不同的，所以 $J_{m+1}(\\zeta_{mn}) \\neq 0$。取平方根得到 $C_{mn}$ 的两个可能的实数值。问题要求用 $J_{m+1}(\\zeta_{mn})$ 表示一个表达式，这自然引导我们选择其中一个带符号的值。我们选择表达式：\n$$ C_{mn} = \\frac{1}{a\\sqrt{\\pi}J_{m+1}(\\zeta_{mn})} $$",
            "answer": "$$\n\\boxed{\\frac{1}{a\\sqrt{\\pi}J_{m+1}(\\zeta_{mn})}}\n$$"
        },
        {
            "introduction": "现在，我们将模态分析的知识应用于一个实际的计算问题。你将不再仅仅求解自由振动的本征模，而是利用模态展开来计算由声源激发的声场，并关键性地分析近似计算所引入的误差。这个练习通过构建一个受迫系统的解，并学习如何严格地为截断误差设定界限，从而在理论和计算之间架起了一座桥梁，这是任何数值模拟工作中的一项关键技能。",
            "id": "4114445",
            "problem": "考虑一个一维声压释放声腔，其模型为长度为 $L$ 的线段，并采用时谐线性声学进行描述。介质具有恒定的质量密度 $\\rho_0$ 和声速 $c$。在频域中，位于位置 $x_0$、体积速度幅值为 $Q$ 的谐波点单极子源所产生的声压幅值 $p(x)$ 满足以下非齐次亥姆霍兹边值问题\n$$(\\frac{d^2}{dx^2} + k^2)p(x) = i \\omega \\rho_0 Q \\,\\delta(x - x_0), \\quad p(0)=0,\\quad p(L)=0,$$\n其中 $\\delta(\\cdot)$ 是狄拉克 delta 分布，$\\omega = 2\\pi f$ 是角频率，而 $k = \\omega/c$ 是声波数。解可以使用腔体本征模态来表示，并且由位于 $x_0$ 的声源在点 $x$ 处产生的场可以通过对格林函数的模态展开进行有限项截断来评估。截断会引入一个近似误差，其大小可以使用模态系数的尾部界限来给出上界。\n\n您的任务是：\n- 从第一性原理出发，推导带有声压释放边界条件的算子 $\\frac{d^2}{dx^2}$ 的本征函数和本征值，并获得与服从相同边界条件的亥姆霍兹算子的预解式相对应的格林函数 $G(x,x_0)$ 的模态表示。\n- 使用前 $M$ 个模态实现一个截断模态展开，以近似由位于 $x_0$ 的声源在目标位置 $x$ 引起的声压幅值。使用此方法计算近似声压幅值的大小 $|p_M(x)|$（单位为帕斯卡）。\n- 通过对截断索引之后的模态级数尾部进行界定，建立一个可计算的截断误差上界，其条件是截断索引 $M$ 超过比率 $s = k L/\\pi$。使用单调尾部积分界限，获得一个仅依赖于 $L$、$k$ 和 $M$ 的尾部界限的封闭形式表达式。使用此方法得出 $|p(x) - p_M(x)|$ 的上界（单位为帕斯卡）。\n\n实现一个程序，对于每个测试用例，执行以下操作：\n1. 计算截断模态近似值 $|p_M(x)|$（单位为帕斯卡）。\n2. 基于从模态系数导出的尾部界限，计算截断误差的上界 $E_{\\text{bound}}$（单位为帕斯卡）。\n\n假设和要求：\n- 使用具有 $e^{-i\\omega t}$ 依赖关系的时谐约定。\n- 在 $x=0$ 和 $x=L$ 处使用声压释放边界条件。\n- 声源是体积速度幅值为 $Q$（单位为 $\\mathrm{m}^3/\\mathrm{s}$）的点单极子。\n- 以帕斯卡为单位表示所有最终的压力值。任何三角函数求值中的角度必须以弧度为单位。\n- 对于尾部界限，假设 $M  s$，因此被省略的分母严格为负，可以通过翻转符号来取绝对值。如果违反此条件，则认为尾部界限不适用。\n\n测试套件和参数：\n每个测试用例是一个元组 $(L, c, \\rho_0, f, Q, x_0, x, M)$，单位规定如下：$L$ 单位为米， $c$ 单位为米/秒，$\\rho_0$ 单位为千克/立方米， $f$ 单位为赫兹， $Q$ 单位为立方米/秒， $x_0$ 和 $x$ 单位为米， $M$ 为整数。测试套件必须包括：\n- 一个远离共振的中等频率的一般情况。\n- 一个频率接近但未达到腔体共振的情况。\n- 一个低频情况。\n- 一个 $x$ 非常接近 $x_0$ 的情况。\n\n使用以下测试套件：\n1. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.0, 343.0, 1.200, 200.0, 1.0\\times 10^{-4}, 0.23, 0.81, 80)$。\n2. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.0, 343.0, 1.200, 853.2, 5.0\\times 10^{-5}, 0.40, 0.60, 30)$。\n3. $(L, c, \\rho_0, f, Q, x_0, x, M) = (0.8, 343.0, 1.210, 20.0, 8.0\\times 10^{-5}, 0.10, 0.70, 20)$。\n4. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.2, 343.0, 1.200, 300.0, 1.0\\times 10^{-5}, 0.55, 0.56, 25)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个测试用例一个。每个内部列表包含两个浮点数：截断压力的大小 $|p_M(x)|$（单位为帕斯卡）和截断误差上界 $E_{\\text{bound}}$（单位为帕斯卡）。例如，输出必须采用以下形式：\n$$[ [|p_M|_1, E_{\\text{bound},1}], [|p_M|_2, E_{\\text{bound},2}], [|p_M|_3, E_{\\text{bound},3}], [|p_M|_4, E_{\\text{bound},4}] ].$$",
            "solution": "问题陈述被评估为有效。它在科学上以线性声学原理为基础，在数学上是一个适定的斯特姆-刘维尔边值问题，并为其解决提供了一套完整且一致的数据和约束。\n\n按照要求，解答分为三个部分展开：推导本征问题解和格林函数，构建压力的截断模态近似公式，以及推导可计算的截断误差上界。\n\n### 第1部分：本征函数、本征值和格林函数\n\n时谐声压幅值 $p(x)$ 的控制方程是非齐次亥姆霍兹方程：\n$$\n\\left(\\frac{d^2}{dx^2} + k^2\\right)p(x) = i \\omega \\rho_0 Q \\,\\delta(x - x_0)\n$$\n服从声压释放边界条件 $p(0)=0$ 和 $p(L)=0$。各符号定义如下：$L$ 是腔体长度， $k = \\omega/c$ 是声波数，$\\omega = 2\\pi f$ 是角频率， $c$ 是声速， $\\rho_0$ 是环境质量密度， $Q$ 是声源体积速度幅值， $x_0$ 是声源位置， $\\delta(\\cdot)$ 是狄拉克 delta 分布。\n\n解可以基于具有给定边界条件的微分算子 $\\frac{d^2}{dx^2}$ 的本征函数，使用模态展开来构造。我们首先求解相关的本征值问题：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = \\lambda \\phi(x), \\quad \\phi(0)=0, \\quad \\phi(L)=0\n$$\n微分方程的通解为 $\\phi(x) = A \\sin(\\sqrt{-\\lambda}x) + B \\cos(\\sqrt{-\\lambda}x)$。\n条件 $\\phi(0)=0$ 意味着 $B=0$。解的形式为 $\\phi(x) = A \\sin(\\sqrt{-\\lambda}x)$。\n条件 $\\phi(L)=0$ 要求 $A \\sin(\\sqrt{-\\lambda}L)=0$。对于非平凡解（$A \\neq 0$），必须有 $\\sqrt{-\\lambda}L = n\\pi$，其中 $n$ 为任意大于等于1的整数。\n这给出了算子 $\\frac{d^2}{dx^2}$ 的本征值 $\\lambda_n$：\n$$\n\\lambda_n = -\\left(\\frac{n\\pi}{L}\\right)^2\n$$\n习惯上使用负拉普拉斯算子 $-\\frac{d^2}{dx^2}$ 的本征值，即 $k_n^2 = -\\lambda_n = (\\frac{n\\pi}{L})^2$。这些 $k_n$ 是腔体的共振波数。相应的未归一化本征函数是 $\\phi_n(x) = \\sin(\\frac{n\\pi x}{L})$。\n\n这些本征函数构成一个正交基。我们相对于在 $[0, L]$ 上的 $L^2$ 内积对其进行归一化：\n$$\n\\int_0^L \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\int_0^L \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx = \\frac{1}{2}\\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_0^L = \\frac{L}{2}\n$$\n因此，标准正交本征函数 $\\psi_n(x)$ 为：\n$$\n\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\n解 $p(x)$ 可以在此基上展开为 $p(x) = \\sum_{n=1}^\\infty a_n \\psi_n(x)$。源项也进行展开：$i\\omega\\rho_0 Q \\delta(x-x_0) = \\sum_{n=1}^\\infty b_n \\psi_n(x)$，其中系数 $b_n$ 通过投影得到：\n$$\nb_n = \\int_0^L i\\omega\\rho_0 Q \\delta(x-x_0) \\psi_n(x) dx = i\\omega\\rho_0 Q \\psi_n(x_0)\n$$\n将 $p(x)$ 的展开式代入亥姆霍兹方程：\n$$\n\\sum_{n=1}^\\infty a_n (\\lambda_n + k^2)\\psi_n(x) = \\sum_{n=1}^\\infty i\\omega\\rho_0 Q \\psi_n(x_0) \\psi_n(x)\n$$\n通过令系数相等，我们找到 $a_n$：\n$$\na_n (\\lambda_n + k^2) = i\\omega\\rho_0 Q \\psi_n(x_0) \\implies a_n = \\frac{i\\omega\\rho_0 Q \\psi_n(x_0)}{k^2 - k_n^2}\n$$\n于是压力的完整解为：\n$$\np(x) = \\sum_{n=1}^\\infty \\frac{i\\omega\\rho_0 Q \\psi_n(x_0)}{k^2 - k_n^2} \\psi_n(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^\\infty \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\n这是压力场的模态表示。格林函数 $G(x,x_0)$ 本身由 $(\\frac{d^2}{dx^2} + k^2)G = \\delta(x-x_0)$ 定义，即 $G(x,x_0) = \\frac{p(x)}{i\\omega\\rho_0 Q}$。\n\n### 第2部分：截断模态近似\n\n通过在第 $M$ 项截断无穷级数来近似压力：\n$$\np_M(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\n求和号内的项是实数。$p_M(x)$ 的整个表达式是纯虚数。因此，其大小 $|p_M(x)|$ 为：\n$$\n|p_M(x)| = \\left| i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right| = \\frac{2\\omega\\rho_0 Q}{L} \\left| \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right|\n$$\n由于 $\\omega = kc$，这也可以写成：\n$$\n|p_M(x)| = \\frac{2kc\\rho_0 Q}{L} \\left| \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right|\n$$\n这个公式将用于计算近似声压的大小。\n\n### 第3部分：截断误差界\n\n截断误差是级数的尾部：\n$$\np(x) - p_M(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\n我们寻求该误差大小 $|p(x) - p_M(x)|$ 的一个上界 $E_{\\text{bound}}$。使用三角不等式和 $|\\sin(\\theta)| \\le 1$ 这一事实：\n$$\n|p(x) - p_M(x)| \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{|\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})|}{|k^2 - (n\\pi/L)^2|} \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{1}{|k^2 - (n\\pi/L)^2|}\n$$\n问题指定了条件 $M  s$，其中 $s = kL/\\pi$。对于和中的项（$n \\geq M+1$），我们有 $n  M  s$。这意味着 $n^2  s^2$，所以 $n^2\\pi^2/L^2  k^2$。分母 $k^2 - (n\\pi/L)^2$ 总是负的。因此，其绝对值为 $(n\\pi/L)^2 - k^2$。界限变为：\n$$\n|p(x) - p_M(x)| \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{1}{(n\\pi/L)^2 - k^2} = \\frac{2\\omega\\rho_0 Q L}{\\pi^2} \\sum_{n=M+1}^{\\infty} \\frac{1}{n^2 - (kL/\\pi)^2}\n$$\n这个和可以通过一个积分来获得上界。对于一个正的递减函数 $g(\\nu)$，有 $\\sum_{n=M+1}^{\\infty} g(n) \\le \\int_M^{\\infty} g(\\nu)d\\nu$。令 $g(\\nu) = \\frac{1}{\\nu^2 - s^2}$，当 $\\nu  s$ 时，该函数是递减的。\n$$\n\\sum_{n=M+1}^{\\infty} \\frac{1}{n^2 - s^2} \\le \\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2}\n$$\n该积分使用部分分式法计算：$\\frac{1}{\\nu^2 - s^2} = \\frac{1}{2s}(\\frac{1}{\\nu-s} - \\frac{1}{\\nu+s})$。\n$$\n\\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2} = \\frac{1}{2s}\\left[ \\ln|\\nu-s| - \\ln|\\nu+s| \\right]_M^{\\infty} = \\frac{1}{2s}\\left[ \\ln\\left|\\frac{\\nu-s}{\\nu+s}\\right| \\right]_M^{\\infty}\n$$\n当 $\\nu \\to \\infty$ 时，对数项趋于 $\\ln(1) = 0$。在下限处，由于 $M  s  0$，我们有：\n$$\n\\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2} = 0 - \\frac{1}{2s}\\ln\\left(\\frac{M-s}{M+s}\\right) = \\frac{1}{2s}\\ln\\left(\\frac{M+s}{M-s}\\right)\n$$\n将此积分界限代回误差界的表达式中：\n$$\nE_{\\text{bound}} = \\frac{2\\omega\\rho_0 Q L}{\\pi^2} \\left[ \\frac{1}{2s} \\ln\\left(\\frac{M+s}{M-s}\\right) \\right]\n$$\n现在，代入 $\\omega = kc$ 和 $s = kL/\\pi$：\n$$\nE_{\\text{bound}} = \\frac{2(kc)\\rho_0 Q L}{\\pi^2} \\left[ \\frac{1}{2(kL/\\pi)} \\ln\\left(\\frac{M+kL/\\pi}{M-kL/\\pi}\\right) \\right] = \\frac{c\\rho_0 Q}{\\pi} \\ln\\left(\\frac{M+kL/\\pi}{M-kL/\\pi}\\right)\n$$\n这就是截断误差上界的最终封闭形式表达式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the truncated modal approximation of acoustic pressure and an error bound\n    for a 1D pressure-release cavity.\n    \"\"\"\n    \n    # Test suite: (L, c, rho0, f, Q, x0, x, M)\n    # L: meters, c: m/s, rho0: kg/m^3, f: Hz, Q: m^3/s, x0: m, x: m, M: integer\n    test_cases = [\n        (1.0, 343.0, 1.200, 200.0, 1.0e-4, 0.23, 0.81, 80),\n        (1.0, 343.0, 1.200, 853.2, 5.0e-5, 0.40, 0.60, 30),\n        (0.8, 343.0, 1.210, 20.0, 8.0e-5, 0.10, 0.70, 20),\n        (1.2, 343.0, 1.200, 300.0, 1.0e-5, 0.55, 0.56, 25),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, c, rho0, f, Q, x0, x, M = case\n        \n        # Calculate physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / c\n\n        # Part 1: Compute truncated modal approximation |p_M(x)|\n        \n        prefactor_p = (2.0 * omega * rho0 * Q) / L\n        modal_sum = 0.0\n        \n        # Sum over the first M modes\n        for n in range(1, M + 1):\n            kn = n * np.pi / L\n            numerator = np.sin(n * np.pi * x / L) * np.sin(n * np.pi * x0 / L)\n            denominator = k**2 - kn**2\n            # Avoid division by zero at resonance; problem setup avoids exact resonance.\n            if np.isclose(denominator, 0.0):\n                modal_sum += np.inf # Should not happen with test cases\n            else:\n                modal_sum += numerator / denominator\n\n        p_M_mag = np.abs(prefactor_p * modal_sum)\n\n        # Part 2: Compute the upper bound on the truncation error E_bound\n        \n        s = k * L / np.pi\n        \n        # The bound is derived under the condition M  s\n        if M  s:\n            log_arg = (M + s) / (M - s)\n            E_bound = (c * rho0 * Q / np.pi) * np.log(log_arg)\n        else:\n            # If condition is not met, the bound is not applicable.\n            # For this problem's constraints, we can set it to NaN or handle as specified.\n            # All test cases satisfy M  s.\n            E_bound = np.nan # Placeholder for the \"not applicable\" case.\n\n        results.append([p_M_mag, E_bound])\n\n    # Format the output string as [[val1,err1],[val2,err2],...]\n    inner_strings = [f\"[{r[0]},{r[1]}]\" for r in results]\n    output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}