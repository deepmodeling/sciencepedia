{
    "hands_on_practices": [
        {
            "introduction": "The rectangular cavity is a canonical problem in acoustics, serving as a fundamental building block for understanding resonance phenomena. This exercise moves beyond textbook examples by introducing mixed boundary conditionsâ€”a combination of acoustically soft (pressure-release) and hard (rigid) walls. By deriving the modal solutions for this scenario , you will gain hands-on practice with the method of separation of variables and develop a physical intuition for how different boundary types directly shape the acoustic field and determine the cavity's resonant frequencies.",
            "id": "4114455",
            "problem": "Consider a three-dimensional rectangular acoustic cavity occupying $0 \\leq x \\leq L_{x}$, $0 \\leq y \\leq L_{y}$, $0 \\leq z \\leq L_{z}$, filled with a homogeneous, lossless fluid of density $\\rho_{0}$ and sound speed $c$. The wall at $x=0$ is a pressure-release (soft) boundary, and the other five walls are rigid (hard). Assume small-amplitude, inviscid acoustics. Starting from the linear acoustic wave equation and its time-harmonic form, derive the separated eigenvalue problem for the acoustic pressure field $p(x,y,z,t)$, obtain the modal shape functions that satisfy the mixed boundary conditions (Dirichlet at $x=0$ and Neumann at all other walls), and determine the corresponding discrete axial, lateral, and vertical wavenumbers. Based on your derived mode shapes, analyze the placement of pressure nodes along the $x$-axis relative to the soft wall, and characterize whether the rigid wall at $x=L_{x}$ coincides with a node or an antinode plane. Finally, using your results, compute the fundamental resonance frequency of the cavity (the lowest nonzero frequency mode) for $L_{x} = 0.75\\,\\mathrm{m}$, $L_{y} = 0.40\\,\\mathrm{m}$, $L_{z} = 0.30\\,\\mathrm{m}$, and $c = 343\\,\\mathrm{m/s}$. Round your answer to four significant figures. Express the frequency in Hz.",
            "solution": "The problem requires the derivation of acoustic modes and the calculation of the fundamental resonance frequency in a rectangular cavity with mixed boundary conditions. The process begins with the linear acoustic wave equation and proceeds through separation of variables to an eigenvalue problem.\n\nThe governing equation for the acoustic pressure perturbation $p(x,y,z,t)$ in a homogeneous, lossless fluid is the linear wave equation:\n$$\n\\nabla^2 p - \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} = 0\n$$\nwhere $c$ is the speed of sound. We seek time-harmonic solutions of the form $p(x,y,z,t) = P(x,y,z) \\exp(-i\\omega t)$, where $P(x,y,z)$ is the complex pressure amplitude, $\\omega$ is the angular frequency, and $i = \\sqrt{-1}$. Substituting this into the wave equation yields the Helmholtz equation for the spatial part $P(x,y,z)$:\n$$\n\\nabla^2 P + k^2 P = 0\n$$\nwhere $k = \\omega/c$ is the wavenumber.\n\nThe boundary conditions must be translated for the spatial amplitude $P$.\nA pressure-release (soft) boundary implies zero pressure. At $x=0$, this gives a Dirichlet boundary condition:\n$$\nP(0, y, z) = 0\n$$\nA rigid (hard) boundary implies zero normal particle velocity. From the linearized Euler equation, $\\rho_0 \\partial\\vec{u}/\\partial t = -\\nabla p$, this condition becomes $\\nabla p \\cdot \\hat{n} = 0$, where $\\hat{n}$ is the outward normal vector. For the spatial amplitude $P$, this gives a Neumann boundary condition, $\\nabla P \\cdot \\hat{n} = 0$. The five rigid walls are at $x=L_x$, $y=0$, $y=L_y$, $z=0$, and $z=L_z$. The conditions are:\n$$\n\\frac{\\partial P}{\\partial x}(L_x, y, z) = 0\n$$\n$$\n\\frac{\\partial P}{\\partial y}(x, 0, z) = 0 \\quad \\text{and} \\quad \\frac{\\partial P}{\\partial y}(x, L_y, z) = 0\n$$\n$$\n\\frac{\\partial P}{\\partial z}(x, y, 0) = 0 \\quad \\text{and} \\quad \\frac{\\partial P}{\\partial z}(x, y, L_z) = 0\n$$\n\nWe solve the Helmholtz equation using the method of separation of variables. Let $P(x,y,z) = X(x)Y(y)Z(z)$. Substituting this into the Helmholtz equation and dividing by $P(x,y,z)$ gives:\n$$\n\\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\frac{1}{Z(z)}\\frac{d^2Z}{dz^2} = -k^2\n$$\nThis equation separates into three ordinary differential equations, which form the separated eigenvalue problem:\n$$\n\\frac{d^2X}{dx^2} + k_x^2 X = 0\n$$\n$$\n\\frac{d^2Y}{dy^2} + k_y^2 Y = 0\n$$\n$$\n\\frac{d^2Z}{dz^2} + k_z^2 Z = 0\n$$\nsubject to the dispersion relation $k_x^2 + k_y^2 + k_z^2 = k^2$. The constants $k_x$, $k_y$, and $k_z$ are the axial, lateral, and vertical wavenumbers, respectively.\n\nWe now solve each ODE with its corresponding boundary conditions.\n\nFor the $x$-direction:\nThe general solution is $X(x) = A \\cos(k_x x) + B \\sin(k_x x)$.\nThe soft boundary at $x=0$ requires $X(0)=0$. This yields $A \\cos(0) + B \\sin(0) = A = 0$. Thus, $X(x) = B \\sin(k_x x)$.\nThe rigid boundary at $x=L_x$ requires $X'(L_x)=0$. The derivative is $X'(x) = B k_x \\cos(k_x x)$. The condition is $B k_x \\cos(k_x L_x) = 0$. For a non-trivial solution ($B \\neq 0$, $k_x \\neq 0$), we must have $\\cos(k_x L_x) = 0$. This occurs when $k_x L_x = (m_x - 1/2)\\pi$ for integers $m_x = 1, 2, 3, \\ldots$. The axial wavenumbers are:\n$$\nk_x = \\frac{(m_x - 1/2)\\pi}{L_x}, \\quad m_x \\in \\{1, 2, 3, \\dots\\}\n$$\nThe corresponding modal shape function in $x$ is $X_{m_x}(x) = \\sin\\left(\\frac{(m_x - 1/2)\\pi x}{L_x}\\right)$.\n\nFor the $y$-direction:\nThe general solution is $Y(y) = C \\cos(k_y y) + D \\sin(k_y y)$.\nThe rigid boundary at $y=0$ requires $Y'(0)=0$. The derivative is $Y'(y) = -C k_y \\sin(k_y y) + D k_y \\cos(k_y y)$. At $y=0$, we get $D k_y \\cos(0) = D k_y = 0$. For $k_y \\neq 0$, this implies $D=0$. Thus $Y(y) = C \\cos(k_y y)$. If $k_y=0$, $Y(y)$ is a constant, which also satisfies $Y'(0)=0$.\nThe rigid boundary at $y=L_y$ requires $Y'(L_y)=0$. This gives $-C k_y \\sin(k_y L_y) = 0$. For a non-trivial solution, $\\sin(k_y L_y) = 0$. This occurs when $k_y L_y = m_y \\pi$ for integers $m_y = 0, 1, 2, \\ldots$. The case $m_y=0$ gives $k_y=0$, which corresponds to a constant pressure profile in $y$, $Y(y)=C$, satisfying both boundary conditions. The discrete lateral wavenumbers are:\n$$\nk_y = \\frac{m_y \\pi}{L_y}, \\quad m_y \\in \\{0, 1, 2, \\dots\\}\n$$\nThe modal shape function in $y$ is $Y_{m_y}(y) = \\cos\\left(\\frac{m_y \\pi y}{L_y}\\right)$.\n\nFor the $z$-direction:\nThe problem is identical to the $y$-direction. The vertical wavenumbers are:\n$$\nk_z = \\frac{m_z \\pi}{L_z}, \\quad m_z \\in \\{0, 1, 2, \\dots\\}\n$$\nThe modal shape function in $z$ is $Z_{m_z}(z) = \\cos\\left(\\frac{m_z \\pi z}{L_z}\\right)$.\n\nThe complete modal shape functions for the pressure are products of the individual functions, indexed by the mode numbers $(m_x, m_y, m_z)$:\n$$\nP_{m_x, m_y, m_z}(x,y,z) = A_{m_x m_y m_z} \\sin\\left(\\frac{(m_x - 1/2)\\pi x}{L_x}\\right) \\cos\\left(\\frac{m_y \\pi y}{L_y}\\right) \\cos\\left(\\frac{m_z \\pi z}{L_z}\\right)\n$$\nwhere $m_x \\in \\{1, 2, 3, \\ldots\\}$ and $m_y, m_z \\in \\{0, 1, 2, \\ldots\\}$.\n\nNow we analyze the pressure nodes and antinodes along the $x$-axis. A pressure node is a plane where $P=0$ for all time. This occurs where the spatial modal function is zero. The pressure-release wall at $x=0$ is a nodal plane because $\\sin(0)=0$.\nAt the rigid wall $x=L_x$, the value of the $x$-dependent part of the mode shape is:\n$$\n\\sin\\left(\\frac{(m_x - 1/2)\\pi L_x}{L_x}\\right) = \\sin\\left((m_x - 1/2)\\pi\\right)\n$$\nFor $m_x=1, 2, 3, \\ldots$, this expression evaluates to $\\sin(\\pi/2)=1$, $\\sin(3\\pi/2)=-1$, $\\sin(5\\pi/2)=1$, etc. In all cases, the magnitude is $|\\sin((m_x - 1/2)\\pi)| = 1$. Since this is the maximum possible magnitude of the sine function, the pressure amplitude is maximized at this plane. Therefore, the rigid wall at $x=L_x$ coincides with a pressure antinode plane.\n\nThe resonance angular frequencies $\\omega_{m_x, m_y, m_z}$ are found from the dispersion relation: $\\omega = ck = c\\sqrt{k_x^2 + k_y^2 + k_z^2}$. The resonance frequencies $f = \\omega/(2\\pi)$ are:\n$$\nf_{m_x, m_y, m_z} = \\frac{c}{2\\pi} \\sqrt{\\left(\\frac{(m_x - 1/2)\\pi}{L_x}\\right)^2 + \\left(\\frac{m_y \\pi}{L_y}\\right)^2 + \\left(\\frac{m_z \\pi}{L_z}\\right)^2}\n$$\n$$\nf_{m_x, m_y, m_z} = \\frac{c}{2} \\sqrt{\\left(\\frac{m_x - 1/2}{L_x}\\right)^2 + \\left(\\frac{m_y}{L_y}\\right)^2 + \\left(\\frac{m_z}{L_z}\\right)^2}\n$$\nThe fundamental resonance frequency is the lowest non-zero frequency. This corresponds to the lowest possible values for the integer mode numbers $(m_x, m_y, m_z)$, which are $m_x=1$, $m_y=0$, and $m_z=0$. The fundamental mode is thus the $(1,0,0)$ mode.\nSubstituting these indices into the frequency formula:\n$$\nf_{1,0,0} = \\frac{c}{2} \\sqrt{\\left(\\frac{1 - 1/2}{L_x}\\right)^2 + \\left(\\frac{0}{L_y}\\right)^2 + \\left(\\frac{0}{L_z}\\right)^2} = \\frac{c}{2} \\sqrt{\\left(\\frac{1/2}{L_x}\\right)^2} = \\frac{c}{2} \\left(\\frac{1}{2L_x}\\right)\n$$\n$$\nf_{1,0,0} = \\frac{c}{4L_x}\n$$\nThis is the classic quarter-wavelength resonance frequency for a tube open at one end and closed at the other.\n\nFinally, we compute the numerical value using the given data: $L_x = 0.75\\,\\mathrm{m}$ and $c = 343\\,\\mathrm{m/s}$. The other dimensions, $L_y = 0.40\\,\\mathrm{m}$ and $L_z = 0.30\\,\\mathrm{m}$, are not relevant for the fundamental frequency in this particular configuration.\n$$\nf_{1,0,0} = \\frac{343}{4 \\times 0.75} = \\frac{343}{3} \\approx 114.333\\ldots\\,\\mathrm{Hz}\n$$\nRounding to four significant figures gives $114.3\\,\\mathrm{Hz}$.",
            "answer": "$$\n\\boxed{114.3}\n$$"
        },
        {
            "introduction": "While the previous practice explored modes in Cartesian coordinates, many practical acoustic systems involve cylindrical geometries. This exercise elevates the analysis by tackling modal properties in a circular waveguide, a system described by Bessel functions. Here, you will rigorously derive the orthogonality relationship between different acoustic modes , a fundamental property that stems from the Sturm-Liouville nature of the governing equation. Mastering this derivation is key to understanding why and how any complex sound field within a waveguide can be decomposed into and reconstructed from its fundamental modal components.",
            "id": "4114396",
            "problem": "A time-harmonic acoustic pressure field $p(r,\\theta,z)$ in a cylindrical waveguide of radius $a$ filled with a homogeneous, isotropic fluid satisfies the scalar Helmholtz equation $\\nabla^{2}p + k^{2} p = 0$, where $\\nabla^{2}$ is the Laplacian in cylindrical coordinates $(r,\\theta,z)$ and $k$ is the acoustic wavenumber. Assume the boundary at $r=a$ is acoustically soft (pressure-release), so that $p(r=a,\\theta,z)=0$. By separation of variables, the cross-sectional eigenfunctions can be written as\n$$\n\\Phi_{mn}(r,\\theta) = C_{mn}\\,J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(i m \\theta),\n$$\nwhere $m\\in\\mathbb{Z}$ is the azimuthal index, $n\\in\\mathbb{N}$ is the radial index, $J_{m}$ is the Bessel function of the first kind of order $m$, $\\zeta_{mn}$ is the $n$-th positive root of $J_{m}(x)=0$, and $C_{mn}$ is a real normalization constant to be determined.\n\nStarting from the governing equations and the self-adjoint structure of the separated radial operator in cylindrical coordinates, rigorously establish the orthogonality of distinct cross-sectional modes with respect to the area element $r\\,dr\\,d\\theta$, i.e., show that\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{a} r\\,\\Phi_{mn}(r,\\theta)\\,\\Phi_{m'n'}(r,\\theta)^{*}\\,dr\\,d\\theta = 0\n$$\nwhenever $(m,n)\\neq(m',n')$, where ${}^{*}$ denotes complex conjugation.\n\nThen, derive the explicit closed-form expression for the normalization constants $C_{mn}$ such that the set $\\{\\Phi_{mn}\\}$ is orthonormal over the cross-section,\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{a} r\\,|\\Phi_{mn}(r,\\theta)|^{2}\\,dr\\,d\\theta = 1.\n$$\n\nExpress your final answer for $C_{mn}$ as a single analytical expression in terms of $a$, $\\pi$, and $J_{m+1}(\\zeta_{mn})$. No numerical evaluation is required.",
            "solution": "The problem asks for two derivations concerning the cross-sectional eigenfunctions $\\Phi_{mn}(r,\\theta)$ in a cylindrical waveguide: first, to establish their orthogonality, and second, to determine the normalization constant $C_{mn}$ that makes the set of eigenfunctions orthonormal.\n\nThe cross-sectional eigenfunction is given by\n$$ \\Phi_{mn}(r,\\theta) = C_{mn}\\,J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(i m \\theta) $$\nwhere $m \\in \\mathbb{Z}$, $n \\in \\mathbb{N}$, $J_m$ is the Bessel function of the first kind of order $m$, and $\\zeta_{mn}$ is the $n$-th positive root of $J_m(x)=0$. The boundary condition is $\\Phi_{mn}(a, \\theta) = 0$.\n\n### Part 1: Orthogonality of Eigenfunctions\n\nWe must show that\n$$ \\int_{0}^{2\\pi}\\int_{0}^{a} r\\,\\Phi_{mn}(r,\\theta)\\,\\Phi_{m'n'}(r,\\theta)^{*}\\,dr\\,d\\theta = 0 $$\nwhenever $(m,n)\\neq(m',n')$. Let's denote this integral by $I_{(m,n),(m',n')}$.\nSubstituting the expression for $\\Phi_{mn}$ and its complex conjugate $\\Phi_{m'n'}^{*}$, we have:\n$$ I_{(m,n),(m',n')} = \\int_{0}^{2\\pi}\\int_{0}^{a} r \\left[ C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(im\\theta) \\right] \\left[ C_{m'n'}J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right)\\exp(-im'\\theta) \\right] dr\\,d\\theta $$\nSince the normalization constants $C_{mn}$ are real and the Bessel functions with real arguments are real-valued, the expression simplifies to:\n$$ I_{(m,n),(m',n')} = C_{mn}C_{m'n'} \\int_{0}^{2\\pi}\\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right) \\exp(i(m-m')\\theta) \\, dr\\,d\\theta $$\nThe integral is separable into an azimuthal part and a radial part:\n$$ I_{(m,n),(m',n')} = C_{mn}C_{m'n'} \\left( \\int_{0}^{2\\pi} \\exp(i(m-m')\\theta) d\\theta \\right) \\left( \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m'}\\!\\left(\\frac{\\zeta_{m'n'}}{a}r\\right) dr \\right) $$\n\nWe consider two cases for $(m,n) \\neq (m',n')$.\n\n**Case 1: $m \\neq m'$**\nThe azimuthal integral is evaluated first. Since $m, m' \\in \\mathbb{Z}$ and $m \\neq m'$, the difference $m-m'$ is a non-zero integer.\n$$ \\int_{0}^{2\\pi} \\exp(i(m-m')\\theta) d\\theta = \\left[ \\frac{\\exp(i(m-m')\\theta)}{i(m-m')} \\right]_{0}^{2\\pi} = \\frac{\\exp(i(m-m')2\\pi) - \\exp(0)}{i(m-m')} = \\frac{1-1}{i(m-m')} = 0 $$\nSince the azimuthal integral is zero, the entire integral $I_{(m,n),(m',n')}$ is zero, regardless of the value of the radial integral. Thus, eigenfunctions with different azimuthal indices $m$ are orthogonal.\n\n**Case 2: $m = m'$ and $n \\neq n'$**\nWhen $m=m'$, the azimuthal integral becomes:\n$$ \\int_{0}^{2\\pi} \\exp(i(m-m)\\theta) d\\theta = \\int_{0}^{2\\pi} \\exp(0) d\\theta = \\int_{0}^{2\\pi} 1 d\\theta = 2\\pi $$\nThe total integral is now:\n$$ I_{(m,n),(m,n')} = 2\\pi C_{mn}C_{mn'} \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m}\\!\\left(\\frac{\\zeta_{mn'}}{a}r\\right) dr $$\nTo prove orthogonality, we must show that the radial integral is zero for $n \\neq n'$. As requested, we start from the governing equations. The cross-sectional eigenfunction $\\Phi$ satisfies the transverse Helmholtz equation $\\nabla_t^2 \\Phi + k_t^2 \\Phi = 0$. Using separation of variables $\\Phi(r,\\theta)=R(r)\\Theta(\\theta)$, the radial part $R(r)$ satisfies Bessel's differential equation:\n$$ r^2 R'' + r R' + (k_t^2 r^2 - m^2)R = 0 $$\nwhere $R(r)$ must be regular at $r=0$ and satisfy the boundary condition $R(a)=0$. This can be rewritten in Sturm-Liouville form:\n$$ \\frac{d}{dr}\\left(r \\frac{dR}{dr}\\right) - \\frac{m^2}{r}R + k_t^2 r R = 0 $$\nThis equation corresponds to a Sturm-Liouville problem for the operator $L = \\frac{d}{dr}(r\\frac{d}{dr}) - \\frac{m^2}{r}$ with eigenvalue $\\lambda=k_t^2$ and weight function $w(r)=r$. The radial eigenfunctions $R_{mn}(r) = J_m(k_{t,mn}r)$ satisfy the boundary conditions $R_{mn}(0)$ is finite and $R_{mn}(a)=0$. The boundary condition at $r=a$ quantizes the transverse wavenumber $k_t$ such that $k_{t,mn}a = \\zeta_{mn}$, or $k_{t,mn} = \\zeta_{mn}/a$. The corresponding eigenvalues are $\\lambda_n = k_{t,mn}^2 = (\\zeta_{mn}/a)^2$.\nFor $n \\neq n'$, we have $\\zeta_{mn} \\neq \\zeta_{mn'}$, which implies $\\lambda_n \\neq \\lambda_{n'}$. Sturm-Liouville theory guarantees that eigenfunctions corresponding to distinct eigenvalues of a self-adjoint operator are orthogonal with respect to the weight function. The operator is self-adjoint over the interval $[0,a]$ with the given boundary conditions.\nTherefore, the radial eigenfunctions $R_{mn}(r) = J_m(\\frac{\\zeta_{mn}}{a}r)$ and $R_{mn'}(r) = J_m(\\frac{\\zeta_{mn'}}{a}r)$ are orthogonal with respect to the weight function $r$:\n$$ \\int_{0}^{a} r \\, R_{mn}(r) R_{mn'}(r) dr = \\int_{0}^{a} r \\, J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right) J_{m}\\!\\left(\\frac{\\zeta_{mn'}}{a}r\\right) dr = 0 $$\nThis proves that the radial integral is zero for $n \\neq n'$. Consequently, $I_{(m,n),(m,n')}=0$.\nCombining both cases, the eigenfunctions $\\Phi_{mn}$ and $\\Phi_{m'n'}$ are orthogonal for any $(m,n) \\neq (m',n')$.\n\n### Part 2: Derivation of the Normalization Constant\n\nWe need to find the real constant $C_{mn}$ such that the set of eigenfunctions is orthonormal. This requires the integral of the squared modulus of an eigenfunction over the cross-section to be unity:\n$$ \\int_{0}^{2\\pi}\\int_{0}^{a} r\\,|\\Phi_{mn}(r,\\theta)|^{2}\\,dr\\,d\\theta = 1 $$\nWe compute the squared modulus of $\\Phi_{mn}$:\n$$ |\\Phi_{mn}(r,\\theta)|^2 = \\left(C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(im\\theta)\\right) \\left(C_{mn}J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\exp(-im\\theta)\\right) = C_{mn}^2 \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 $$\nThe normalization integral becomes:\n$$ C_{mn}^2 \\int_{0}^{2\\pi}\\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr\\,d\\theta = 1 $$\nSeparating the variables:\n$$ C_{mn}^2 \\left(\\int_{0}^{2\\pi} d\\theta\\right) \\left(\\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr\\right) = 1 $$\nThe azimuthal integral is $\\int_{0}^{2\\pi} d\\theta = 2\\pi$. The normalization condition reduces to:\n$$ 2\\pi C_{mn}^2 \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = 1 $$\nTo evaluate the radial integral, we use the standard identity for integrals of squared Bessel functions (a Lommel integral):\n$$ \\int x [J_m(\\alpha x)]^2 dx = \\frac{x^2}{2} \\left( [J_m'(\\alpha x)]^2 + \\left(1 - \\frac{m^2}{\\alpha^2 x^2}\\right) [J_m(\\alpha x)]^2 \\right) $$\nIn our case, the integration is from $r=0$ to $r=a$, with $\\alpha = \\zeta_{mn}/a$.\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\left[ \\frac{r^2}{2} \\left( \\left[J_{m}'\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 + \\left(1 - \\frac{m^2}{(\\zeta_{mn}/a)^2 r^2}\\right) \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 \\right) \\right]_{0}^{a} $$\nThe lower limit at $r=0$ evaluates to $0$ (for $m>0$, $J_m(0)=0$; for $m=0$, $J_0(0)=1$ but $r^2=0$ dominates; for $m<0$, behavior is similar to $m>0$). At the upper limit $r=a$, we have $\\frac{\\zeta_{mn}}{a}r = \\zeta_{mn}$. By definition, $\\zeta_{mn}$ is a root of $J_m(x)$, so $J_m(\\zeta_{mn}) = 0$. The expression simplifies significantly:\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\frac{a^2}{2} \\left[J_{m}'(\\zeta_{mn})\\right]^2 $$\nNow we use a Bessel function recurrence relation to express the derivative $J_m'$ in terms of $J_{m+1}$:\n$$ J_{m}'(z) = -J_{m+1}(z) + \\frac{m}{z}J_m(z) $$\nEvaluating this at $z = \\zeta_{mn}$, where $J_m(\\zeta_{mn}) = 0$, we get:\n$$ J_{m}'(\\zeta_{mn}) = -J_{m+1}(\\zeta_{mn}) $$\nTherefore, $\\left[J_{m}'(\\zeta_{mn})\\right]^2 = \\left[-J_{m+1}(\\zeta_{mn})\\right]^2 = \\left[J_{m+1}(\\zeta_{mn})\\right]^2$.\nThe radial integral is thus:\n$$ \\int_{0}^{a} r \\left[J_{m}\\!\\left(\\frac{\\zeta_{mn}}{a}r\\right)\\right]^2 dr = \\frac{a^2}{2} \\left[J_{m+1}(\\zeta_{mn})\\right]^2 $$\nSubstituting this back into the normalization condition:\n$$ 2\\pi C_{mn}^2 \\left( \\frac{a^2}{2} [J_{m+1}(\\zeta_{mn})]^2 \\right) = 1 $$\n$$ \\pi a^2 C_{mn}^2 [J_{m+1}(\\zeta_{mn})]^2 = 1 $$\nSolving for the real constant $C_{mn}$:\n$$ C_{mn}^2 = \\frac{1}{\\pi a^2 [J_{m+1}(\\zeta_{mn})]^2} $$\nThe zeros of $J_m(z)$ and $J_{m+1}(z)$ are known to be distinct for $z \\neq 0$, so $J_{m+1}(\\zeta_{mn}) \\neq 0$. Taking the square root gives two possible real values for $C_{mn}$. The problem asks for an expression in terms of $J_{m+1}(\\zeta_{mn})$, which naturally leads to choosing one of these signed values. We select the expression:\n$$ C_{mn} = \\frac{1}{a\\sqrt{\\pi}J_{m+1}(\\zeta_{mn})} $$",
            "answer": "$$\n\\boxed{\\frac{1}{a\\sqrt{\\pi}J_{m+1}(\\zeta_{mn})}}\n$$"
        },
        {
            "introduction": "This final practice synthesizes the preceding concepts by demonstrating their most powerful application: solving inhomogeneous problems. Here, you will use the principle of modal expansion to construct the solution for a sound field generated by a point source within a cavity. A crucial aspect of any practical implementation is the necessary truncation of the infinite modal series, which introduces an error. This exercise  guides you not only in building the approximate solution but also in deriving a rigorous mathematical bound for the truncation error, a core skill in assessing the validity and accuracy of computational acoustic models.",
            "id": "4114445",
            "problem": "Consider a one-dimensional pressure-release acoustic cavity, modeled as a line segment of length $L$ with time-harmonic linear acoustics. The medium has constant mass density $\\rho_0$ and speed of sound $c$. In the frequency domain, the acoustic pressure amplitude $p(x)$ for a harmonic point monopole source of volume velocity amplitude $Q$ located at position $x_0$ satisfies the inhomogeneous Helmholtz boundary-value problem\n$$(\\frac{d^2}{dx^2} + k^2)p(x) = i \\omega \\rho_0 Q \\,\\delta(x - x_0), \\quad p(0)=0,\\quad p(L)=0,$$\nwhere $\\delta(\\cdot)$ is the Dirac delta distribution, $\\omega = 2\\pi f$ is the angular frequency, and $k = \\omega/c$ is the acoustic wavenumber. The solution can be represented using the cavity eigenmodes, and the field at a point $x$ due to the source at $x_0$ may be evaluated via a modal expansion of the Green's function truncated to a finite number of modes. The truncation introduces an approximation error whose magnitude can be bounded above using tail bounds on the modal coefficients.\n\nYour task is to:\n- From first principles, derive the eigenfunctions and eigenvalues for the operator $\\frac{d^2}{dx^2}$ with pressure-release boundary conditions, and obtain the modal representation of the Green's function $G(x,x_0)$ corresponding to the resolvent of the Helmholtz operator subject to the same boundary conditions.\n- Implement a truncated modal expansion using the first $M$ modes to approximate the pressure amplitude at a target position $x$ caused by a source at $x_0$. Use this to compute the magnitude of the approximate pressure amplitude $|p_M(x)|$ in Pascals.\n- Establish a computable upper bound on the truncation error by bounding the tail of the modal series beyond the truncation index, under the condition that the truncation index $M$ exceeds the ratio $s = k L/\\pi$. Use a monotone tail integral bound to obtain a closed-form expression for a tail bound that depends only on $L$, $k$, and $M$. Use this to produce an upper bound on $|p(x) - p_M(x)|$ in Pascals.\n\nImplement a program that, for each test case, does the following:\n1. Computes the truncated modal approximation $|p_M(x)|$ in Pascals.\n2. Computes the upper bound on the truncation error $E_{\\text{bound}}$ in Pascals based on the tail bound derived from the modal coefficients.\n\nAssumptions and requirements:\n- Use the time-harmonic convention with $e^{-i\\omega t}$ dependence.\n- Use pressure-release boundary conditions at $x=0$ and $x=L$.\n- The source is a point monopole of volume velocity amplitude $Q$ (in $\\mathrm{m}^3/\\mathrm{s}$).\n- Express all final pressure quantities in Pascals. Angles in any trigonometric evaluations must be in radians.\n- For the tail bound, assume $M > s$ so that omitted denominators are strictly negative and the absolute value can be taken by flipping the sign. If this condition is violated, treat the tail bound as not applicable.\n\nTest suite and parameters:\nEach test case is a tuple $(L, c, \\rho_0, f, Q, x_0, x, M)$ with units specified as follows: $L$ in meters, $c$ in meters per second, $\\rho_0$ in kilograms per cubic meter, $f$ in Hertz, $Q$ in cubic meters per second, $x_0$ and $x$ in meters, and $M$ as an integer. The test suite must include:\n- A general case with moderate frequency away from resonance.\n- A case with frequency near but not at a cavity resonance.\n- A low-frequency case.\n- A case where $x$ is very close to $x_0$.\n\nUse the following test suite:\n1. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.0, 343.0, 1.200, 200.0, 1.0\\times 10^{-4}, 0.23, 0.81, 80)$.\n2. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.0, 343.0, 1.200, 853.2, 5.0\\times 10^{-5}, 0.40, 0.60, 30)$.\n3. $(L, c, \\rho_0, f, Q, x_0, x, M) = (0.8, 343.0, 1.210, 20.0, 8.0\\times 10^{-5}, 0.10, 0.70, 20)$.\n4. $(L, c, \\rho_0, f, Q, x_0, x, M) = (1.2, 343.0, 1.200, 300.0, 1.0\\times 10^{-5}, 0.55, 0.56, 25)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per test case. Each inner list contains two floating-point numbers: the magnitude of the truncated pressure $|p_M(x)|$ in Pascals and the truncation error upper bound $E_{\\text{bound}}$ in Pascals. For example, the output must be of the form\n`[ [|p_M|_1, E_{\\text{bound},1}], [|p_M|_2, E_{\\text{bound},2}], [|p_M|_3, E_{\\text{bound},3}], [|p_M|_4, E_{\\text{bound},4}] ].`",
            "solution": "The solution is developed in three parts as requested: derivation of the eigenproblem solution and Green's function, formulation of the truncated modal approximation for the pressure, and derivation of a computable upper bound for the truncation error.\n\n### Part 1: Eigenfunctions, Eigenvalues, and Green's Function\n\nThe governing equation for the time-harmonic acoustic pressure amplitude $p(x)$ is the inhomogeneous Helmholtz equation:\n$$\n\\left(\\frac{d^2}{dx^2} + k^2\\right)p(x) = i \\omega \\rho_0 Q \\,\\delta(x - x_0)\n$$\nsubject to pressure-release boundary conditions $p(0)=0$ and $p(L)=0$. The symbols are defined as: $L$ is the cavity length, $k = \\omega/c$ is the acoustic wavenumber, $\\omega = 2\\pi f$ is the angular frequency, $c$ is the speed of sound, $\\rho_0$ is the ambient mass density, $Q$ is the source volume velocity amplitude, $x_0$ is the source position, and $\\delta(\\cdot)$ is the Dirac delta distribution.\n\nThe solution can be constructed using a modal expansion based on the eigenfunctions of the differential operator $\\frac{d^2}{dx^2}$ with the given boundary conditions. We first solve the associated eigenvalue problem:\n$$\n\\frac{d^2\\phi(x)}{dx^2} = \\lambda \\phi(x), \\quad \\phi(0)=0, \\quad \\phi(L)=0\n$$\nThe general solution to the differential equation is $\\phi(x) = A \\sin(\\sqrt{-\\lambda}x) + B \\cos(\\sqrt{-\\lambda}x)$.\nThe condition $\\phi(0)=0$ implies $B=0$. The solution is of the form $\\phi(x) = A \\sin(\\sqrt{-\\lambda}x)$.\nThe condition $\\phi(L)=0$ requires $A \\sin(\\sqrt{-\\lambda}L)=0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sqrt{-\\lambda}L = n\\pi$ for any integer $n \\geq 1$.\nThis gives the eigenvalues $\\lambda_n$ of the operator $\\frac{d^2}{dx^2}$:\n$$\n\\lambda_n = -\\left(\\frac{n\\pi}{L}\\right)^2\n$$\nIt is conventional to work with the eigenvalues of the negative Laplacian, $-\\frac{d^2}{dx^2}$, which are $k_n^2 = -\\lambda_n = (\\frac{n\\pi}{L})^2$. These $k_n$ are the resonant wavenumbers of the cavity. The corresponding unnormalized eigenfunctions are $\\phi_n(x) = \\sin(\\frac{n\\pi x}{L})$.\n\nThese eigenfunctions form an orthogonal basis. We normalize them with respect to the $L^2$ inner product on $[0, L]$:\n$$\n\\int_0^L \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\int_0^L \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx = \\frac{1}{2}\\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_0^L = \\frac{L}{2}\n$$\nThus, the orthonormal eigenfunctions $\\psi_n(x)$ are:\n$$\n\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nThe solution $p(x)$ can be expanded in this basis as $p(x) = \\sum_{n=1}^\\infty a_n \\psi_n(x)$. The source term is also expanded: $i\\omega\\rho_0 Q \\delta(x-x_0) = \\sum_{n=1}^\\infty b_n \\psi_n(x)$, where the coefficients $b_n$ are found by projection:\n$$\nb_n = \\int_0^L i\\omega\\rho_0 Q \\delta(x-x_0) \\psi_n(x) dx = i\\omega\\rho_0 Q \\psi_n(x_0)\n$$\nSubstituting the expansion of $p(x)$ into the Helmholtz equation:\n$$\n\\sum_{n=1}^\\infty a_n (\\lambda_n + k^2)\\psi_n(x) = \\sum_{n=1}^\\infty i\\omega\\rho_0 Q \\psi_n(x_0) \\psi_n(x)\n$$\nBy equating coefficients, we find $a_n$:\n$$\na_n (\\lambda_n + k^2) = i\\omega\\rho_0 Q \\psi_n(x_0) \\implies a_n = \\frac{i\\omega\\rho_0 Q \\psi_n(x_0)}{k^2 - k_n^2}\n$$\nThe full solution for the pressure is then:\n$$\np(x) = \\sum_{n=1}^\\infty \\frac{i\\omega\\rho_0 Q \\psi_n(x_0)}{k^2 - k_n^2} \\psi_n(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^\\infty \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\nThis is the modal representation of the pressure field. The Green's function $G(x,x_0)$ itself, defined by $(\\frac{d^2}{dx^2} + k^2)G = \\delta(x-x_0)$, is $G(x,x_0) = \\frac{p(x)}{i\\omega\\rho_0 Q}$.\n\n### Part 2: Truncated Modal Approximation\n\nThe pressure is approximated by truncating the infinite series at the $M$-th term:\n$$\np_M(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\nThe term inside the summation is real. The entire expression for $p_M(x)$ is purely imaginary. The magnitude $|p_M(x)|$ is therefore:\n$$\n|p_M(x)| = \\left| i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right| = \\frac{2\\omega\\rho_0 Q}{L} \\left| \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right|\n$$\nSince $\\omega = kc$, this can also be written as:\n$$\n|p_M(x)| = \\frac{2kc\\rho_0 Q}{L} \\left| \\sum_{n=1}^{M} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2} \\right|\n$$\nThis formula will be implemented to compute the approximate pressure magnitude.\n\n### Part 3: Truncation Error Bound\n\nThe truncation error is the tail of the series:\n$$\np(x) - p_M(x) = i\\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})}{k^2 - (n\\pi/L)^2}\n$$\nWe seek an upper bound $E_{\\text{bound}}$ on the magnitude of this error, $|p(x) - p_M(x)|$. Using the triangle inequality and the fact that $|\\sin(\\theta)| \\le 1$:\n$$\n|p(x) - p_M(x)| \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{|\\sin(\\frac{n\\pi x}{L})\\sin(\\frac{n\\pi x_0}{L})|}{|k^2 - (n\\pi/L)^2|} \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{1}{|k^2 - (n\\pi/L)^2|}\n$$\nThe problem specifies the condition $M > s$, where $s = kL/\\pi$. For the terms in the sum ($n \\geq M+1$), we have $n > M > s$. This implies $n^2 > s^2$, so $n^2\\pi^2/L^2 > k^2$. The denominator $k^2 - (n\\pi/L)^2$ is always negative. Thus, its absolute value is $(n\\pi/L)^2 - k^2$. The bound becomes:\n$$\n|p(x) - p_M(x)| \\le \\frac{2\\omega\\rho_0 Q}{L} \\sum_{n=M+1}^{\\infty} \\frac{1}{(n\\pi/L)^2 - k^2} = \\frac{2\\omega\\rho_0 Q L}{\\pi^2} \\sum_{n=M+1}^{\\infty} \\frac{1}{n^2 - (kL/\\pi)^2}\n$$\nThe sum can be bounded above by an integral. For a positive, decreasing function $g(\\nu)$, $\\sum_{n=M+1}^{\\infty} g(n) \\le \\int_M^{\\infty} g(\\nu)d\\nu$. Let $g(\\nu) = \\frac{1}{\\nu^2 - s^2}$, which is decreasing for $\\nu > s$.\n$$\n\\sum_{n=M+1}^{\\infty} \\frac{1}{n^2 - s^2} \\le \\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2}\n$$\nThe integral is evaluated using partial fractions: $\\frac{1}{\\nu^2 - s^2} = \\frac{1}{2s}(\\frac{1}{\\nu-s} - \\frac{1}{\\nu+s})$.\n$$\n\\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2} = \\frac{1}{2s}\\left[ \\ln|\\nu-s| - \\ln|\\nu+s| \\right]_M^{\\infty} = \\frac{1}{2s}\\left[ \\ln\\left|\\frac{\\nu-s}{\\nu+s}\\right| \\right]_M^{\\infty}\n$$\nAs $\\nu \\to \\infty$, the logarithm term goes to $\\ln(1) = 0$. At the lower limit, since $M > s > 0$, we have:\n$$\n\\int_M^{\\infty} \\frac{d\\nu}{\\nu^2 - s^2} = 0 - \\frac{1}{2s}\\ln\\left(\\frac{M-s}{M+s}\\right) = \\frac{1}{2s}\\ln\\left(\\frac{M+s}{M-s}\\right)\n$$\nSubstituting this integral bound back into the expression for the error bound:\n$$\nE_{\\text{bound}} = \\frac{2\\omega\\rho_0 Q L}{\\pi^2} \\left[ \\frac{1}{2s} \\ln\\left(\\frac{M+s}{M-s}\\right) \\right]\n$$\nNow, substituting $\\omega = kc$ and $s = kL/\\pi$:\n$$\nE_{\\text{bound}} = \\frac{2(kc)\\rho_0 Q L}{\\pi^2} \\left[ \\frac{1}{2(kL/\\pi)} \\ln\\left(\\frac{M+kL/\\pi}{M-kL/\\pi}\\right) \\right] = \\frac{c\\rho_0 Q}{\\pi} \\ln\\left(\\frac{M+kL/\\pi}{M-kL/\\pi}\\right)\n$$\nThis is the final closed-form expression for the truncation error upper bound.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the truncated modal approximation of acoustic pressure and an error bound\n    for a 1D pressure-release cavity.\n    \"\"\"\n    \n    # Test suite: (L, c, rho0, f, Q, x0, x, M)\n    # L: meters, c: m/s, rho0: kg/m^3, f: Hz, Q: m^3/s, x0: m, x: m, M: integer\n    test_cases = [\n        (1.0, 343.0, 1.200, 200.0, 1.0e-4, 0.23, 0.81, 80),\n        (1.0, 343.0, 1.200, 853.2, 5.0e-5, 0.40, 0.60, 30),\n        (0.8, 343.0, 1.210, 20.0, 8.0e-5, 0.10, 0.70, 20),\n        (1.2, 343.0, 1.200, 300.0, 1.0e-5, 0.55, 0.56, 25),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, c, rho0, f, Q, x0, x, M = case\n        \n        # Calculate physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / c\n\n        # Part 1: Compute truncated modal approximation |p_M(x)|\n        \n        prefactor_p = (2.0 * omega * rho0 * Q) / L\n        modal_sum = 0.0\n        \n        # Sum over the first M modes\n        for n in range(1, M + 1):\n            kn = n * np.pi / L\n            numerator = np.sin(n * np.pi * x / L) * np.sin(n * np.pi * x0 / L)\n            denominator = k**2 - kn**2\n            # Avoid division by zero at resonance; problem setup avoids exact resonance.\n            if np.isclose(denominator, 0.0):\n                modal_sum += np.inf # Should not happen with test cases\n            else:\n                modal_sum += numerator / denominator\n\n        p_M_mag = np.abs(prefactor_p * modal_sum)\n\n        # Part 2: Compute the upper bound on the truncation error E_bound\n        \n        s = k * L / np.pi\n        \n        # The bound is derived under the condition M > s\n        if M > s:\n            log_arg = (M + s) / (M - s)\n            E_bound = (c * rho0 * Q / np.pi) * np.log(log_arg)\n        else:\n            # If condition is not met, the bound is not applicable.\n            # For this problem's constraints, we can set it to NaN or handle as specified.\n            # All test cases satisfy M > s.\n            E_bound = np.nan # Placeholder for the \"not applicable\" case.\n\n        results.append([p_M_mag, E_bound])\n\n    # Format the output string as [[val1,err1],[val2,err2],...]\n    inner_strings = [f\"[{r[0]},{r[1]}]\" for r in results]\n    output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}