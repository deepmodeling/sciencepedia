{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究复杂的消声器模拟之前，首先必须掌握声波在简单管道中的传播基本原理。本练习将引导您从基本的声学控制方程出发，推导刚性壁面矩形管道中的声学模式。通过计算特定模式的截止频率，您将亲身体验到管道的几何形状如何决定哪些频率的声波可以有效传播，这是理解和应用一维平面波模型的关键前提。",
            "id": "4121356",
            "problem": "考虑一个具有刚性（声学硬）壁的三维矩形管道，其占据的区域为 $x \\in [0,a]$，$y \\in [0,b]$ 和 $z \\in \\mathbb{R}$。管道中充满了静止、无粘、可压缩的流体，其密度均匀为 $\\rho_{0}$，声速为 $c_{0}$。令 $p'(x,y,z,t)$ 表示声压扰动，$\\boldsymbol{u}'(x,y,z,t)$ 表示声学质点速度扰动。假设为小振幅声学，因此适用线性化动力学。\n\n仅从无粘可压缩流体的线性化运动方程（连续性方程、动量方程和等熵状态方程）出发，推导 $p'(x,y,z,t)$ 的控制波动方程。利用时间谐波依赖性和在轴向与横向上的变量分离法，建立在刚性壁边界条件下矩形横截面内的横向特征值问题。由此，求出模态横向波数以及确定各模态截止频率的相应截止条件。\n\n然后，对于宽度 $a = 0.15\\,\\mathrm{m}$、高度 $b = 0.10\\,\\mathrm{m}$ 的矩形管道，声速 $c_{0} = 343\\,\\mathrm{m/s}$，计算模态指数 $m=2$ 和 $n=1$ 时的模态横向波数和相应的截止频率。\n\n将您的数值结果四舍五入至四位有效数字。模态横向波数以 $\\mathrm{rad/m}$ 为单位表示，截止频率以 $\\mathrm{Hz}$ 为单位表示。以两元素行矩阵 $\\bigl(\\gamma_{mn}, f_{mn}\\bigr)$ 的形式提供您的最终答案。",
            "solution": "该问题要求推导声波动方程，建立带刚性壁的矩形管道的横向特征值问题，求出由此产生的模态特性，并进行特定的数值计算。\n\n推导从静止、无粘、可压缩流体的线性化控制方程开始。这些方程是：\n1.  连续性方程：\n    $$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 $$\n2.  动量方程（欧拉方程）：\n    $$ \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} = -\\nabla p' $$\n3.  等熵状态方程，它将压力扰动 $p'$ 与密度扰动 $\\rho'$ 联系起来：\n    $$ p' = c_{0}^{2} \\rho' $$\n此处，$\\rho_{0}$ 是平均流体密度，$c_{0}$ 是声速，$\\boldsymbol{u}'$ 是声学质点速度，$p'$ 是声压。\n\n为了推导声压 $p'$ 的波动方程，我们将这三个方程组合起来。首先，我们使用状态方程将 $\\rho'$ 用 $p'$ 表示：$\\rho' = p'/c_{0}^{2}$。对其求时间导数得到：\n$$ \\frac{\\partial \\rho'}{\\partial t} = \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\n将此代入连续性方程得出：\n$$ \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 \\quad \\implies \\quad \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\n接下来，我们对动量方程取散度。假设平均密度 $\\rho_{0}$ 在空间上是均匀的，我们可以交换散度算子和时间导数算子：\n$$ \\nabla \\cdot \\left( \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\nabla \\cdot (\\nabla p') = -\\nabla^{2} p' $$\n现在，我们将重新整理后的连续性方程对时间求导：\n$$ \\frac{\\partial}{\\partial t} \\left( \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n通过令 $\\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}')$ 的两个表达式相等，我们得到：\n$$ -\\nabla^{2} p' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n这可以简化为齐次声波动方程：\n$$ \\nabla^{2} p' - \\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} = 0 $$\n为了分析沿管道（$z$ 轴）的波传播，我们假设一个形式为 $p'(x,y,z,t) = p(x,y,z) e^{i\\omega t}$ 的时间谐波解，其中 $\\omega = 2\\pi f$ 是角频率。将此代入波动方程，得到复压幅 $p(x,y,z)$ 的亥姆霍兹方程：\n$$ \\nabla^{2} p + \\left(\\frac{\\omega}{c_{0}}\\right)^{2} p = 0 \\quad \\implies \\quad \\nabla^{2} p + k^{2} p = 0 $$\n其中 $k = \\omega/c_{0}$ 是声波数。\n\n我们使用分离变量法求解亥姆霍兹方程。对于沿 $z$ 方向传播的波，我们寻找形式为 $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$ 的解，其中 $\\psi(x,y)$ 是横向模态振型，$k_z$ 是轴向波数。拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$。将分离形式代入亥姆霍茲方程：\n$$ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi e^{\\pm ik_z z} + \\psi \\frac{\\partial^{2}}{\\partial z^{2}} e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\n$$ e^{\\pm ik_z z} \\left[ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi \\right] + \\psi (-k_z^2) e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\n两边同除以 $e^{\\pm ik_z z}$ 并对横向部分进行整理，得到：\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} = -(k^{2} - k_z^{2})\\psi $$\n这是一个二维特征值问题。我们定义横向波数 $\\gamma$，使得 $\\gamma^{2} = k^{2} - k_z^{2}$。这个方程称为色散关系，它将声波数、轴向波数和横向波数联系起来。于是，横向特征值问题为：\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} + \\gamma^{2}\\psi = 0 $$\n边界条件由刚性（声学硬）壁决定。在刚性表面上，质点速度的法向分量必须为零。根据时间谐波形式的动量方程，$\\boldsymbol{u} = \\frac{i}{\\omega \\rho_{0}} \\nabla p$。因此，条件 $\\boldsymbol{u} \\cdot \\hat{n} = 0$（其中 $\\hat{n}$ 是壁面的法向量）意味着 $\\nabla p \\cdot \\hat{n} = 0$。对于矩形管道，这意味着：\n$$ \\frac{\\partial p}{\\partial x} = 0 \\text{ at } x=0, a \\quad \\text{and} \\quad \\frac{\\partial p}{\\partial y} = 0 \\text{ at } y=0, b $$\n由于 $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$，这些条件直接适用于模态振型 $\\psi(x,y)$。\n我们通过进一步分离变量 $\\psi(x,y) = X(x)Y(y)$ 来求解横向特征值问题。这会得到两个常微分方程：\n$$ \\frac{d^{2}X}{dx^{2}} + k_{x}^{2}X = 0 \\quad \\text{and} \\quad \\frac{d^{2}Y}{dy^{2}} + k_{y}^{2}Y = 0 $$\n其中 $\\gamma^{2} = k_{x}^{2} + k_{y}^{2}$。$X(x)$ 的通解是 $A \\cos(k_x x) + B \\sin(k_x x)$。应用边界条件：\n$\\frac{dX}{dx}|_{x=0} = B k_x = 0 \\implies B=0$。所以，$X(x) = A \\cos(k_x x)$。\n$\\frac{dX}{dx}|_{x=a} = -A k_x \\sin(k_x a) = 0 \\implies \\sin(k_x a) = 0$。\n这要求 $k_x a = m\\pi$，其中整数 $m=0, 1, 2, ...$。因此，$k_x = \\frac{m\\pi}{a}$。\n类似地，对于 $Y(y)$，边界条件得出 $k_y = \\frac{n\\pi}{b}$，其中整数 $n=0, 1, 2, ...$。\n因此，$(m,n)$ 模态的模态横向波数为：\n$$ \\gamma_{mn} = \\sqrt{k_{x}^{2} + k_{y}^{2}} = \\sqrt{\\left(\\frac{m\\pi}{a}\\right)^{2} + \\left(\\frac{n\\pi}{b}\\right)^{2}} = \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\n一个模态只有当其轴向波数 $k_z = \\sqrt{k^2 - \\gamma_{mn}^2}$ 是实数时才能传播，这要求 $k^2 \\geq \\gamma_{mn}^2$。从不传播（衰减）到传播的转变发生在截止频率处，此时 $k_z=0$。这个条件是 $k = \\gamma_{mn}$，或 $\\omega/c_0 = \\gamma_{mn}$。截止角频率是 $\\omega_{mn} = c_0 \\gamma_{mn}$。以赫茲（Hz）为单位的截止频率是 $f_{mn} = \\omega_{mn}/(2\\pi)$：\n$$ f_{mn} = \\frac{c_{0}\\gamma_{mn}}{2\\pi} = \\frac{c_{0}}{2\\pi} \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\n\n现在，我们对给定参数进行数值计算：$a = 0.15\\,\\mathrm{m}$，$b = 0.10\\,\\mathrm{m}$，$c_{0} = 343\\,\\mathrm{m/s}$，以及模态指数 $m=2$, $n=1$。\n\n首先，我们计算模态横向波数 $\\gamma_{21}$：\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} $$\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{40}{3}\\right)^{2} + (10)^{2}} = \\pi \\sqrt{\\frac{1600}{9} + 100} = \\pi \\sqrt{\\frac{1600+900}{9}} = \\pi \\sqrt{\\frac{2500}{9}} = \\frac{50\\pi}{3} $$\n其数值为：\n$$ \\gamma_{21} \\approx 52.359877... \\, \\mathrm{rad/m} $$\n四舍五入到四位有效数字，$\\gamma_{21} = 52.36 \\, \\mathrm{rad/m}$。\n\n接下来，我们计算相应的截止频率 $f_{21}$：\n$$ f_{21} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} = \\frac{343}{2} \\sqrt{\\frac{2500}{9}} = \\frac{343}{2} \\left(\\frac{50}{3}\\right) = \\frac{343 \\times 25}{3} = \\frac{8575}{3} $$\n其数值为：\n$$ f_{21} \\approx 2858.333... \\, \\mathrm{Hz} $$\n四舍五入到四位有效数字，$f_{21} = 2858 \\, \\mathrm{Hz}$。\n\n最终答案是数对 $(\\gamma_{21}, f_{21})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n52.36  2858\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实的消声器系统通常由多个声学元件串联或并联而成，直接求解整个系统的波动方程会非常复杂。本练习介绍了一种更高效的模块化建模方法——二端口网络理论。您将学习如何用传递矩阵和导纳矩阵来描述一个声学元件（如穿孔板），并实现它们之间的转换，这是开发可扩展消声器仿真代码的核心实践技能。",
            "id": "4121377",
            "problem": "要求您实现、验证并应用连接管道截面的一维线性声学二端口的参数转换，并使用这些转换来分析用作管道内元件的多孔板。该二端口由端口变量压力 $p$（单位为 $\\mathrm{Pa}$）和体积速度 $U$（单位为 $\\mathrm{m^3/s}$）来表征。此问题的基础是管道中的线性化平面波声学以及定义二端口参数的网络关系。\n\n从标准的传递（也称传输）参数表示法开始，该表示法由以下线性关系定义\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix},\n$$\n其中 $A$、$B$、$C$ 和 $D$ 是与频率相关的复函数，$p_1$、$U_1$、$p_2$ 和 $U_2$ 是在一维平面波假设下，两个端口处压力和体积速度的复相量振幅。同时，定义导纳参数表示法如下\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix},\n$$\n其中 $Y_{ij}$ 是导纳矩阵的复数元素，单位为 $\\mathrm{m^3/(Pa\\cdot s)}$。\n\n您的任务是：\n- 从上述定义的第一性原理出发，推导传递参数 $(A,B,C,D)$ 和导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$ 之间的代数转换关系。不要假设任何已有的快捷公式；通过消元和求解线性方程组来推导这些关系。\n- 实现函数，用于将传递参数 $(A,B,C,D)$ 转换为导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$，反之亦然，并确保在参数有限且非奇异时具有数值鲁棒性。\n- 将插入管道中的多孔板建模为两个端口之间的串联声阻抗 $Z_{\\mathrm{plate}}$。使用一个具有物理依据的模型，该模型包括通过圆孔的振荡流的粘性损耗和惯性：\n  - 对于半径为 $a$、板厚为 $t$ 的圆孔，每个孔的粘性（泊肃叶）阻力近似为\n    $$\n    R_{\\mathrm{hole}} = \\frac{8\\,\\mu\\,t}{\\pi\\,a^4},\n    $$\n    其中 $\\mu$ 是空气的动力粘度，每个孔的惯性质量为\n    $$\n    M_{\\mathrm{hole}} = \\frac{\\rho_0\\,L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}, \\quad L_{\\mathrm{eff}} = t + 1.7\\,a, \\quad S_{\\mathrm{hole}} = \\pi a^2,\n    $$\n    其中 $\\rho_0$ 是环境空气密度。单孔阻抗为\n    $$\n    Z_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\,\\omega\\,M_{\\mathrm{hole}},\n    $$\n    其中 $\\omega$ 是角频率，单位为 $\\mathrm{rad/s}$，$j$ 是虚数单位。对于 $N$ 个并联的相同孔，板的总阻抗为\n    $$\n    Z_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}。\n    $$\n- 将多孔板表示为一个串联元件二端口，其传递矩阵为\n  $$\n  \\begin{bmatrix}\n  A  B \\\\\n  C  D\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  1  Z_{\\mathrm{plate}} \\\\\n  0  1\n  \\end{bmatrix},\n  $$\n  并使用您的转换函数来获取多孔板的导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$。\n- 通过对多孔板进行往返转换（传递参数到导纳参数，再转换回传递参数），数值验证您的转换函数的正确性，并计算 $(A,B,C,D)$ 的最大相对偏差。\n\n使用以下给定的空气属性和常数：\n- 环境空气密度：$\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$。\n- 空气的动力粘度：$\\mu = 1.84\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$。\n- 声速（仅用于提供背景信息，在下面的计算中不直接需要）：$c_0 = 343\\,\\mathrm{m/s}$。\n\n实现您的程序，为以下四个科学上合理的测试用例计算结果，这些用例涵盖了粘性主导和惯性主导的不同区域：\n\n- 测试用例 1：频率 $f = 500\\,\\mathrm{Hz}$，孔半径 $a = 2\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 2\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 100$。\n- 测试用例 2：频率 $f = 2000\\,\\mathrm{Hz}$，孔半径 $a = 2\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 8\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 100$。\n- 测试用例 3：频率 $f = 500\\,\\mathrm{Hz}$，孔半径 $a = 5\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 2\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 500$。\n- 测试用例 4：频率 $f = 2000\\,\\mathrm{Hz}$，孔半径 $a = 5\\times 10^{-4}\\,\\mathrm{m}$，板厚 $t = 10\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 50$。\n\n对于每个测试用例，您的程序必须产生三个输出：\n- $Y_{11}$ 的实部（单位 $\\mathrm{m^3/(Pa\\cdot s)}$）。\n- $Y_{11}$ 的虚部（单位 $\\mathrm{m^3/(Pa\\cdot s)}$）。\n- 往返转换 $(A,B,C,D)\\rightarrow (Y_{11},Y_{12},Y_{21},Y_{22})\\rightarrow (A,B,C,D)$ 的最大相对误差，以十进制数表示（无单位）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含 $12$ 个结果（每个测试用例三个，按测试用例 $1$ 到 $4$ 的顺序排列），格式为方括号内由逗号分隔的列表，例如 $[y11\\_r^{(1)},y11\\_i^{(1)},\\epsilon^{(1)},y11\\_r^{(2)},y11\\_i^{(2)},\\epsilon^{(2)},y11\\_r^{(3)},y11\\_i^{(3)},\\epsilon^{(3)},y11\\_r^{(4)},y11\\_i^{(4)},\\epsilon^{(4)}]$，其中每个 $y11\\_r^{(k)}$ 和 $y11\\_i^{(k)}$ 的单位为 $\\mathrm{m^3/(Pa\\cdot s)}$，每个 $\\epsilon^{(k)}$ 是一个十进制数。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于线性声学和二端口网络理论，是适定的，并包含得出唯一解所需的所有必要信息。\n\n解决方案分三个阶段进行：首先，从第一性原理推导传递矩阵和导纳矩阵表示法之间的代数转换；其次，将多孔板建模为串联声阻抗并确定其传递矩阵；第三，通过计算实现这些模型和转换，以分析指定的测试用例并通过往返计算验证实现。\n\n### 1. 二端口参数转换的推导\n\n线性声学元件两个端口处的压力 $p$ 和体积速度 $U$ 之间的关系可以用不同的矩阵形式来描述。我们已知传递矩阵和导纳矩阵的定义。\n\n传递矩阵关系为：\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix}\n$$\n这可以写成两个独立的线性方程：\n$$\np_1 = A p_2 + B U_2 \\quad (1)\n$$\n$$\nU_1 = C p_2 + D U_2 \\quad (2)\n$$\n\n导纳矩阵关系为：\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix}\n$$\n这也可以写成两个独立的线性方程：\n$$\nU_1 = Y_{11} p_1 + Y_{12} p_2 \\quad (3)\n$$\n$$\nU_2 = Y_{21} p_1 + Y_{22} p_2 \\quad (4)\n$$\n\n我们的目标是通过代数操作，用一个矩阵的元素来表示另一个矩阵的元素。\n\n#### 1.1. 从传递矩阵到导纳矩阵（$T \\rightarrow Y$）\n\n为了求出导纳参数（$Y_{11}, Y_{12}, Y_{21}, Y_{22}$），我们需要使用方程 $(1)$ 和 $(2)$ 将 $U_1$ 和 $U_2$ 表示为 $p_1$ 和 $p_2$ 的函数。\n\n从方程 $(1)$，我们可以解出 $U_2$，假设 $B \\neq 0$：\n$$\nB U_2 = p_1 - A p_2 \\implies U_2 = \\frac{1}{B} p_1 - \\frac{A}{B} p_2\n$$\n该方程的形式与方程 $(4)$，$U_2 = Y_{21} p_1 + Y_{22} p_2$，一致。通过直接比较，我们发现：\n$$\nY_{21} = \\frac{1}{B}\n$$\n$$\nY_{22} = -\\frac{A}{B}\n$$\n现在，我们将 $U_2$ 的表达式代入方程 $(2)$：\n$$\nU_1 = C p_2 + D \\left( \\frac{1}{B} p_1 - \\frac{A}{B} p_2 \\right)\n$$\n按 $p_1$ 和 $p_2$ 重新整理各项：\n$$\nU_1 = \\frac{D}{B} p_1 + \\left( C - \\frac{AD}{B} \\right) p_2 = \\frac{D}{B} p_1 - \\frac{AD - BC}{B} p_2\n$$\n该方程的形式与方程 $(3)$，$U_1 = Y_{11} p_1 + Y_{12} p_2$，一致。通过比较：\n$$\nY_{11} = \\frac{D}{B}\n$$\n$$\nY_{12} = -\\frac{AD - BC}{B}\n$$\n项 $AD - BC = \\det(T)$ 是传递矩阵的行列式。对于无源、互易二端口，该行列式为 1，即 $AD-BC=1$。给定的多孔板模型是互易的。\n\n#### 1.2. 从导纳矩阵到传递矩阵（$Y \\rightarrow T$）\n\n为了求出传递参数（$A, B, C, D$），我们需要使用方程 $(3)$ 和 $(4)$ 将 $p_1$ 和 $U_1$ 表示为 $p_2$ 和 $U_2$ 的函数。\n\n从方程 $(4)$，我们可以解出 $p_1$，假设 $Y_{21} \\neq 0$：\n$$\nY_{21} p_1 = U_2 - Y_{22} p_2 \\implies p_1 = -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2\n$$\n该方程的形式与方程 $(1)$，$p_1 = A p_2 + B U_2$，一致。通过比较：\n$$\nA = -\\frac{Y_{22}}{Y_{21}}\n$$\n$$\nB = \\frac{1}{Y_{21}}\n$$\n现在，我们将 $p_1$ 的表达式代入方程 $(3)$：\n$$\nU_1 = Y_{11} \\left( -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2 \\right) + Y_{12} p_2\n$$\n按 $p_2$ 和 $U_2$ 重新整理各项：\n$$\nU_1 = \\left( Y_{12} - \\frac{Y_{11}Y_{22}}{Y_{21}} \\right) p_2 + \\frac{Y_{11}}{Y_{21}} U_2 = -\\frac{Y_{11}Y_{22} - Y_{12}Y_{21}}{Y_{21}} p_2 + \\frac{Y_{11}}{Y_{21}} U_2\n$$\n该方程的形式与方程 $(2)$，$U_1 = C p_2 + D U_2$，一致。项 $Y_{11}Y_{22} - Y_{12}Y_{21} = \\det(Y)$ 是导纳矩阵的行列式。通过比较：\n$$\nC = -\\frac{\\det(Y)}{Y_{21}}\n$$\n$$\nD = \\frac{Y_{11}}{Y_{21}}\n$$\n这些推导出的公式允许在这两种表示法之间直接转换，前提是分母（分别为 $B$ 和 $Y_{21}$）不为零。\n\n### 2. 多孔板的声学模型\n\n多孔板被建模为一个简单的串联声阻抗 $Z_{\\mathrm{plate}}(\\omega)$，其中 $\\omega = 2\\pi f$ 是角频率。该阻抗考虑了空气在孔中振荡时的粘性损耗和惯性效应。\n\n总阻抗由 $N$ 个相同孔的并联组合决定。单个孔的阻抗 $Z_{\\mathrm{hole}}$ 是一个电阻部分 $R_{\\mathrm{hole}}$ 和一个惯性（类质量）电抗 $j\\omega M_{\\mathrm{hole}}$ 的和。\n$$\nZ_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\omega M_{\\mathrm{hole}}\n$$\n电阻项由半径为 $a$、长度（板厚）为 $t$ 的圆管的泊肃叶流阻给出：\n$$\nR_{\\mathrm{hole}} = \\frac{8\\mu t}{\\pi a^4}\n$$\n其中 $\\mu$ 是空气的动力粘度。惯性质量项包括一个末端修正，以解释与孔口外空气一同运动的流体质量。有效长度 $L_{\\mathrm{eff}}$ 是板厚加上此修正：\n$$\nL_{\\mathrm{eff}} = t + 1.7a\n$$\n每个孔的质量是这个有效体积中的总质量除以面积 $S_{\\mathrm{hole}} = \\pi a^2$：\n$$\nM_{\\mathrm{hole}} = \\frac{\\rho_0 L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}\n$$\n其中 $\\rho_0$ 是环境空气密度。\n\n对于 $N$ 个并联的相同孔，板的总阻抗为：\n$$\nZ_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}\n$$\n在管道中，带有阻抗 $Z$ 的串联元件对应于一个二端口，其中体积速度是连续的（$U_1 = U_2$），并且压力在元件两端下降（$p_1 - p_2 = Z U_1$）。这产生了特定的传递矩阵：\n$$\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  Z_{\\mathrm{plate}} \\\\\n0  1\n\\end{bmatrix}\n$$\n\n### 3. 计算过程与验证\n\n每个测试用例的总体算法如下：\n1. 给定测试用例参数（$f, a, t, N$）和物理常数（$\\rho_0, \\mu$），计算复声阻抗 $Z_{\\mathrm{plate}}(\\omega)$。\n2. 为该板构建初始传递矩阵 $T_{\\mathrm{orig}}$：$A=1$，$B=Z_{\\mathrm{plate}}$，$C=0$，$D=1$。所有参数都是复数，尽管 $A$、$C$、$D$ 的虚部初始为零。\n3. 应用推导的 $T \\rightarrow Y$ 转换公式求出导纳参数 $(Y_{11}, Y_{12}, Y_{21}, Y_{22})$。对于这个特定的 T 矩阵，由于 $A=D=1$，$C=0$ 且 $AD-BC = 1$，公式简化为 $Y_{11} = 1/Z_{\\mathrm{plate}}$，$Y_{12} = -1/Z_{\\mathrm{plate}}$，$Y_{21} = 1/Z_{\\mathrm{plate}}$ 和 $Y_{22} = -1/Z_{\\mathrm{plate}}$。然后提取所需的输出 $\\mathrm{Re}(Y_{11})$ 和 $\\mathrm{Im}(Y_{11})$。\n4. 为验证转换函数的正确性，执行一次往返转换。将 $Y \\rightarrow T$ 转换应用于计算出的导纳矩阵，以获得新的传递矩阵 $T_{\\mathrm{new}} = [A', B', C', D']$。\n5. 理论上，$T_{\\mathrm{new}}$ 应与 $T_{\\mathrm{orig}}$ 相同。任何差异都归因于浮点数精度误差。计算最大相对误差 $\\epsilon$ 以量化此偏差。鉴于某些原始参数为 $0$ 或 $1$，采用混合绝对/相对误差度量是合适的：\n$$\n\\epsilon = \\max\\left( \\left|A' - 1\\right|, \\left|\\frac{B' - B}{B}\\right|, \\left|C' - 0\\right|, \\left|D' - 1\\right| \\right)\n$$\n对所有四个测试用例执行此过程，并将每个用例的结果（$\\mathrm{Re}(Y_{11})$、$\\mathrm{Im}(Y_{11})$、$\\epsilon$）汇总到一个最终列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the duct acoustics problem for perforated plates.\n    This involves deriving and implementing two-port parameter conversions,\n    modeling the plate impedance, and running several test cases.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    RHO_0 = 1.204  # Ambient air density in kg/m^3\n    MU = 1.84e-5   # Dynamic viscosity of air in Pa.s\n\n    def _calculate_plate_impedance(f, a, t, N):\n        \"\"\"\n        Calculates the acoustic impedance of the perforated plate based on\n        the provided physical model.\n\n        Args:\n            f (float): Frequency in Hz.\n            a (float): Hole radius in m.\n            t (float): Plate thickness in m.\n            N (int): Number of holes.\n\n        Returns:\n            complex: The complex acoustic impedance Z_plate.\n        \"\"\"\n        omega = 2 * np.pi * f\n        s_hole = np.pi * a**2\n        \n        # Viscous resistance per hole\n        r_hole = (8 * MU * t) / (np.pi * a**4)\n        \n        # Inertial mass per hole with end correction\n        l_eff = t + 1.7 * a\n        m_hole = (RHO_0 * l_eff) / s_hole\n        \n        # Impedance per hole (complex)\n        z_hole = r_hole + 1j * omega * m_hole\n        \n        # Total impedance for N holes in parallel\n        z_plate = z_hole / N\n        return z_plate\n\n    def _transfer_to_admittance(A, B, C, D):\n        \"\"\"\n        Converts transfer matrix parameters (A, B, C, D) to admittance\n        matrix parameters (Y11, Y12, Y21, Y22).\n        \"\"\"\n        if np.abs(B)  1e-15: # Avoid division by zero\n            raise ValueError(\"Cannot convert to admittance matrix: parameter B is zero.\")\n        det_T = A * D - B * C\n        Y11 = D / B\n        Y12 = -det_T / B\n        Y21 = 1 / B\n        Y22 = -A / B\n        return Y11, Y12, Y21, Y22\n\n    def _admittance_to_transfer(Y11, Y12, Y21, Y22):\n        \"\"\"\n        Converts admittance matrix parameters back to transfer matrix parameters\n        for verification.\n        \"\"\"\n        if np.abs(Y21)  1e-15:  # Avoid division by zero\n            raise ValueError(\"Cannot convert to transfer matrix: parameter Y21 is zero.\")\n        det_Y = Y11 * Y22 - Y12 * Y21\n        A = -Y22 / Y21\n        B = 1 / Y21\n        C = -det_Y / Y21\n        D = Y11 / Y21\n        return A, B, C, D\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (frequency f, hole radius a, plate thickness t, number of holes N)\n        (500, 2e-3, 2e-3, 100),\n        (2000, 2e-3, 8e-3, 100),\n        (500, 5e-3, 2e-3, 500),\n        (2000, 5e-4, 10e-3, 50),\n    ]\n\n    results = []\n    for f, a, t, N in test_cases:\n        # 1. Model plate and get its original transfer matrix T_orig\n        z_plate = _calculate_plate_impedance(f, a, t, N)\n        A_orig, B_orig, C_orig, D_orig = 1.0, z_plate, 0.0, 1.0\n\n        # 2. Convert T_orig to admittance matrix Y\n        Y11, Y12, Y21, Y22 = _transfer_to_admittance(A_orig, B_orig, C_orig, D_orig)\n        \n        # 3. Store required outputs: Re(Y11) and Im(Y11)\n        results.append(Y11.real)\n        results.append(Y11.imag)\n\n        # 4. Perform round-trip conversion: Y back to T_new for verification\n        A_new, B_new, C_new, D_new = _admittance_to_transfer(Y11, Y12, Y21, Y22)\n\n        # 5. Compute the maximum deviation to quantify numerical error\n        # Use absolute error for components that are originally 0 or 1.\n        # Use relative error for B, which is complex and non-zero.\n        err_A = np.abs(A_new - A_orig)\n        err_B = np.abs((B_new - B_orig) / B_orig) if np.abs(B_orig) > 0 else np.abs(B_new)\n        err_C = np.abs(C_new - C_orig)\n        err_D = np.abs(D_new - D_orig)\n        \n        max_error = np.max([err_A, err_B, err_C, err_D])\n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在工程实践中，我们广泛使用平面波模型来简化分析，但任何模型都有其适用边界。当声波频率接近或超过第一个高阶模式的截止频率时，平面波假设会引入多大的误差？本练习将指导您量化这种“模型形式不确定性”，通过分析一个包含高阶模式激励的更精确模型，来评估平面波近似的预测误差，培养对仿真结果进行批判性评估的关键能力。",
            "id": "4121365",
            "problem": "考虑一个半径为 $a$、长度为 $L$ 的刚性直圆形管道，其中充满了质量密度为 $\\rho_0$、声速为 $c$ 的无粘性可压缩流体。假设时间谐波声学，角频率为 $\\omega = 2\\pi f$，复时间约定为 $\\mathrm{e}^{\\mathrm{i}\\omega t}$。声压场 $p(r,z)$ 和轴向质点速度 $u_z(r,z)$ 满足线性化的动量方程和连续性方程，在小振幅和无平均流的假设下，这些方程在柱坐标系中可简化为标量 Helmholtz 方程。使用柱坐标系，径向坐标为 $r$，轴向坐标为 $z$，并仅限于轴对称场。\n\n该管道支持一组正交的轴对称横向模态 $\\{\\Phi_n(r)\\}_{n\\ge 0}$，这些模态在 $r=a$ 处满足刚性壁边界条件，其中 $\\Phi_0(r)$ 是平面波模态，$\\Phi_{n\\ge 1}(r)$ 是高阶径向模态。对于刚性壁，边界条件是壁面处的法向速度为零，这导致了对压力本征函数的 Neumann 条件。对于轴对称模态，这意味着径向本征值 $\\mu_n$ 满足 $J_1(\\mu_n) = 0$（对于 $n \\ge 1$），其中 $J_\\nu$ 表示第一类 $\\nu$ 阶 Bessel 函数，而平面波模态的 $\\mu_0 = 0$ 且 $\\Phi_0(r)$ 为常数。设模态基是归一化的，使得对于所有 $n \\ge 0$ 都有 $\\int_0^a \\Phi_n(r)^2\\, r\\, \\mathrm{d}r = 1$。\n\n假设在 $z=L$ 处为消声终端（在 $z=L$ 处无反射）。在 $z=0$ 处，为轴向质点速度规定一个形式如下的轴对称入口边界条件\n$$\nu_z(r,0) = U_0\\,\\Phi_0(r) + \\epsilon\\,\\Phi_1(r),\n$$\n其中 $U_0>0$ 且 $\\epsilon \\ge 0$。这个边界条件激励了平面波模态和第一高阶轴对称径向模态。设模态 $n$ 的轴向波数为 $k_{z,n} = \\sqrt{k^2 - (\\mu_n/a)^2}$，其中 $k = \\omega/c$ 是自由空间中的声波数，并为倏逝模态（当 $k  \\mu_n/a$ 时）定义物理上可接受的分支，使得 $\\mathrm{e}^{-\\mathrm{i}k_{z,n}z}$ 对于 $z>0$ 衰减。\n\n对于 $z>0$ 的多模态声压场由一个前向传播的叠加表示，\n$$\np(r,z) = \\sum_{n=0}^{\\infty} A_n\\,\\Phi_n(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,n}z},\n$$\n其中模态振幅 $A_n$ 由入口边界条件和线性动量方程确定。平面波近似仅保留 $n=0$ 项。\n\n将 $z=L$ 处平面波近似的模型形式不确定性定义为截断至前两个模态的多模态声压场与平面波声压场之间的横截面均方根相对误差，\n$$\nE(f,\\epsilon) = \\left(\\frac{\\int_0^a \\left|p_{2}(r,L) - p_{0}(r,L)\\right|^2\\, r\\, \\mathrm{d}r}{\\int_0^a \\left|p_{0}(r,L)\\right|^2\\, r\\, \\mathrm{d}r}\\right)^{1/2},\n$$\n其中 $p_{2}(r,L) = A_0\\,\\Phi_0(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,0}L} + A_1\\,\\Phi_1(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}$ 且 $p_{0}(r,L) = A_0\\,\\Phi_0(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,0}L}$。这个 $E(f,\\epsilon)$ 量化了由于第一高阶模态的边缘激励而在平面波模型中产生的预期误差，并提供了一个多模态修正。\n\n从线性化的声学方程、模态正交性和入口边界条件出发，推导模态振幅 $A_0$ 和 $A_1$ 关于 $U_0$、$\\epsilon$、$\\omega$、$\\rho_0$ 和 $k_{z,n}$ 的表达式，然后对下面指定的测试套件评估 $E(f,\\epsilon)$。您的程序必须针对给定参数实现此评估，并生成指定的输出格式。\n\n使用以下科学上一致的参数和单位：\n- 管道半径：$a = 0.05\\,\\mathrm{m}$。\n- 管道长度：$L = 0.20\\,\\mathrm{m}$。\n- 流体质量密度：$\\rho_0 = 1.20\\,\\mathrm{kg/m^3}$。\n- 声速：$c = 343\\,\\mathrm{m/s}$。\n- 平面波入口系数：$U_0 = 1.00$（无量纲，因为它乘以归一化的 $\\Phi_0$）。\n- 第一高阶模态入口系数：$\\epsilon$ 按测试案例给定（无量纲，因为它乘以归一化的 $\\Phi_1$）。\n- 频率值 $f$ 单位为 $\\mathrm{Hz}$。\n\n对于轴对称刚性壁模态，确定 $\\mu_1$ 为 $J_1(\\mu)=0$ 的第一个正根，并用它来计算第一高阶模态的截止条件。确保当频率 $f$ 低于截止频率时，$n=1$ 模态的轴向相关性随 $z$ 的增加而衰减，这与物理上的倏逝现象一致。\n\n测试套件：\n- 案例 1：$f = 3800\\,\\mathrm{Hz}$，$\\epsilon = 0.05$。\n- 案例 2：$f = 4200\\,\\mathrm{Hz}$，$\\epsilon = 0.10$。\n- 案例 3：$f = 5000\\,\\mathrm{Hz}$，$\\epsilon = 0.10$。\n- 案例 4：$f = 4200\\,\\mathrm{Hz}$，$\\epsilon = 0.00$。\n\n计算每个案例的 $E(f,\\epsilon)$。将答案表示为无单位的小数。您的程序应生成单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来（例如，$\"[e_1,e_2,e_3,e_4]\"$），顺序与上述测试案例一致。",
            "solution": "基本依据是无平均流情况下的线性化声学方程，在频域和小振幅运动条件下，这些方程可导出 Helmholtz 方程。在具有轴对称场的刚性直圆形管道中，变量分离法得到径向坐标上的横向本征函数，这些函数在壁面处满足 Neumann 边界条件。径向本征函数与 $J_0(\\mu_n r/a)$ 成正比，其中 $J_0$ 是第一类零阶 Bessel 函数，由于在 $r=a$ 处有 $\\partial J_0(\\mu_n r/a)/\\partial r = 0$ 的条件以及恒等式 $J_0'(\\xi) = -J_1(\\xi)$，本征值 $\\mu_n$ 满足\n$$\nJ_1(\\mu_n) = 0,\\quad n \\ge 1。\n$$\n平面波模态对应于 $\\mu_0 = 0$，并且在 $r$ 方向上空间恒定。\n\n我们考虑一个归一化的模态基 $\\{\\Phi_n(r)\\}_{n\\ge 0}$，使得\n$$\n\\int_0^a \\Phi_n(r)^2\\, r\\, \\mathrm{d}r = 1,\\quad n \\ge 0,\n$$\n其中 $\\Phi_0(r)$ 是常数，$\\Phi_{n\\ge 1}(r) = \\mathcal{N}_n J_0\\!\\left(\\mu_n \\frac{r}{a}\\right)$，其中 $\\mathcal{N}_n$ 是确保单位范数属性的归一化常数。在此归一化下，正交性意味着\n$$\n\\int_0^a \\Phi_m(r)\\,\\Phi_n(r)\\, r\\, \\mathrm{d}r = \\delta_{mn},\n$$\n其中 $\\delta_{mn}$ 是 Kronecker delta。\n\n每个模态的轴向相关性由其通过变量分离得到的轴向波数 $k_{z,n}$ 决定：\n$$\nk_{z,n} = \\sqrt{k^2 - \\left(\\frac{\\mu_n}{a}\\right)^2},\\quad k = \\frac{\\omega}{c}。\n$$\n对于 $k > \\mu_n/a$，模态是传播的且 $k_{z,n}$ 是实数；对于 $k  \\mu_n/a$，模态是倏逝的。为了在倏逝情况下强制实现 $z>0$ 时的物理衰减，我们选择分支\n$$\nk_{z,n} = -\\mathrm{i}\\,\\sqrt{\\left(\\frac{\\mu_n}{a}\\right)^{2} - k^2},\\quad\\text{当 } k  \\frac{\\mu_n}{a} \\text{ 时},\n$$\n使得 $\\mathrm{e}^{-\\mathrm{i}k_{z,n}z} = \\mathrm{e}^{-\\gamma_n z}$，其中 $\\gamma_n = \\sqrt{(\\mu_n/a)^2 - k^2} > 0$。\n\n频域线性化动量方程关联了压力梯度和质点速度：\n$$\n\\mathrm{i}\\omega \\rho_0\\,u_z(r,z) = \\frac{\\partial p(r,z)}{\\partial z}。\n$$\n使用前向传播的多模态表示\n$$\np(r,z) = \\sum_{n=0}^{\\infty} A_n\\,\\Phi_n(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,n}z},\n$$\n在 $z=0$ 处的轴向导数为\n$$\n\\left.\\frac{\\partial p}{\\partial z}\\right|_{z=0} = \\sum_{n=0}^{\\infty} \\left(-\\mathrm{i}k_{z,n} A_n\\right)\\,\\Phi_n(r)。\n$$\n将其与 $\\mathrm{i}\\omega \\rho_0\\,u_z(r,0)$ 相等，并利用入口边界条件\n$$\nu_z(r,0) = U_0\\,\\Phi_0(r) + \\epsilon\\,\\Phi_1(r),\n$$\n以及模态正交性，立即得到模态振幅\n$$\nA_0 = \\frac{\\omega \\rho_0}{k_{z,0}}\\,U_0,\\qquad A_1 = \\frac{\\omega \\rho_0}{k_{z,1}}\\,\\epsilon,\\qquad A_{n\\ge 2} = 0。\n$$\n平面波近似仅保留 $A_0$，而一阶多模态修正则同时包含 $A_0$ 和 $A_1$。\n\n定义在 $z=L$ 处的声压场：\n$$\np_0(r,L) = A_0\\,\\Phi_0(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,0}L},\\qquad\np_2(r,L) = A_0\\,\\Phi_0(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,0}L} + A_1\\,\\Phi_1(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}。\n$$\n模型形式不确定性是相对均方根误差\n$$\nE(f,\\epsilon) = \\left(\\frac{\\int_0^a \\left|A_1\\,\\Phi_1(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}\\right|^2\\, r\\, \\mathrm{d}r}{\\int_0^a \\left|A_0\\,\\Phi_0(r)\\,\\mathrm{e}^{-\\mathrm{i}k_{z,0}L}\\right|^2\\, r\\, \\mathrm{d}r}\\right)^{1/2}。\n$$\n根据归一化，对于 $n=0$ 和 $n=1$ 都有 $\\int_0^a \\Phi_n^2\\, r\\, \\mathrm{d}r = 1$，且 $|\\mathrm{e}^{-\\mathrm{i}k_{z,0}L}| = 1$。因此，\n$$\nE(f,\\epsilon) = \\frac{|A_1|}{|A_0|}\\,\\left|\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}\\right| = \\left|\\frac{\\epsilon}{U_0}\\right|\\,\\left|\\frac{k_{z,0}}{k_{z,1}}\\right|\\,\\left|\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}\\right|。\n$$\n当 $f$ 低于第一截止频率时，$k_{z,1} = -\\mathrm{i}\\gamma_1$ 且 $\\gamma_1 > 0$，因此 $\\left|\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}\\right| = \\mathrm{e}^{-\\gamma_1 L}$，这捕捉了高阶模态的倏逝衰减以及误差随轴向距离的相应减小。当 $f$ 高于截止频率时，$k_{z,1}$ 是实数且 $\\left|\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}\\right| = 1$，因此误差简化为 $\\left|\\epsilon/U_0\\right|\\left|k_{z,0}/k_{z,1}\\right|$。\n\n算法步骤：\n- 计算 $\\mu_1$ 作为 $J_1(\\mu)=0$ 的第一个正根。\n- 对于每个测试案例 $(f,\\epsilon)$，计算 $\\omega = 2\\pi f$，$k = \\omega/c$，$k_{z,0} = k$ 以及使用上述分支选择的 $k_{z,1}$。\n- 计算 $A_0 = (\\omega \\rho_0/k_{z,0})\\,U_0$ 和 $A_1 = (\\omega \\rho_0/k_{z,1})\\,\\epsilon$。\n- 评估 $E(f,\\epsilon) = |A_1/A_0|\\,|\\mathrm{e}^{-\\mathrm{i}k_{z,1}L}|$。\n- 按照要求的单行列表格式报告四个指定案例的 $E$ 值。\n\n给定参数 $a = 0.05\\,\\mathrm{m}$，$L = 0.20\\,\\mathrm{m}$，$\\rho_0 = 1.20\\,\\mathrm{kg/m^3}$，$c = 343\\,\\mathrm{m/s}$，以及 $U_0 = 1.00$，第一个截止频率为 $f_c = \\dfrac{c\\,\\mu_1}{2\\pi a}$，其中 $\\mu_1 \\approx 3.831705970\\ldots$ 满足 $J_1(\\mu_1)=0$。对于 $a=0.05\\,\\mathrm{m}$，数值上 $f_c$ 略高于 $4000\\,\\mathrm{Hz}$，因此所选的测试频率探究了截止频率以下、刚过截止频率和远高于截止频率的情况，以及零高阶模态的边界情况 $\\epsilon=0$。最终的程序实现了这一计算，并将四个 $E$ 值以无单位的、用方括号括起来的单个逗号分隔列表的形式打印出来。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn_zeros\n\ndef solve():\n    # Physical parameters\n    a = 0.05          # duct radius [m]\n    L = 0.20          # duct length [m]\n    rho0 = 1.20       # density [kg/m^3]\n    c = 343.0         # speed of sound [m/s]\n    U0 = 1.0          # plane-wave inlet coefficient (dimensionless)\n\n    # First positive root of J1(mu) = 0 for axisymmetric rigid-wall mode n=1\n    mu1 = jn_zeros(1, 1)[0]\n\n    # Test cases: (frequency [Hz], epsilon [dimensionless])\n    test_cases = [\n        (3800.0, 0.05),  # below cut-off, marginal higher mode\n        (4200.0, 0.10),  # just above cut-off\n        (5000.0, 0.10),  # well above cut-off\n        (4200.0, 0.00),  # zero higher-mode content\n    ]\n\n    results = []\n    for f, eps in test_cases:\n        omega = 2.0 * np.pi * f\n        k = omega / c\n        # Axial wavenumbers\n        kz0 = k\n        kc1 = mu1 / a\n        if k >= kc1:\n            # Propagating first higher mode\n            kz1 = np.sqrt(k**2 - kc1**2)\n        else:\n            # Evanescent first higher mode: choose branch for decay\n            kz1 = -1j * np.sqrt(kc1**2 - k**2)\n\n        # Modal amplitudes\n        A0 = (omega * rho0 / kz0) * U0\n        # Handle eps=0 gracefully; division by kz1 OK for complex\n        A1 = (omega * rho0 / kz1) * eps\n\n        # Error metric E = |A1/A0| * |exp(-i kz1 L)|\n        decay_factor = np.exp(-1j * kz1 * L)\n        E = np.abs(A1 / A0) * np.abs(decay_factor)\n\n        results.append(E)\n\n    # Print in exact required format: single line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}