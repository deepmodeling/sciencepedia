{
    "hands_on_practices": [
        {
            "introduction": "管道中最简单的声音模型是平面波，但这仅在低频时是准确的。本练习将引导您从基本的流体动力学原理出发，推导高阶声学模式的行为。理解这些模式及其“截止频率”（低于该频率，模式将无法传播）对于预测和设计消声器在宽频率范围内的性能至关重要。",
            "id": "4121356",
            "problem": "考虑一个三维矩形管道，其壁面为刚性（声学硬边界），占据区域 $x \\in [0,a]$，$y \\in [0,b]$ 和 $z \\in \\mathbb{R}$。管道内充满了静止、无粘、可压缩的流体，其密度均匀为 $\\rho_{0}$，声速为 $c_{0}$。令 $p'(x,y,z,t)$ 表示声压扰动，$\\boldsymbol{u}'(x,y,z,t)$ 表示声学质点速度扰动。假设为小振幅声学，以便应用线性化动力学。\n\n仅从无粘可压缩流体的线性化运动方程（连续性方程、动量方程和等熵状态方程）出发，推导 $p'(x,y,z,t)$ 的控制波动方程。使用时间谐波依赖性和轴向与横向的变量分离法，建立矩形截面在刚性壁面边界条件下的横向特征值问题。由此，求出模态横向波数以及确定每个模态截止频率的相关截止条件。\n\n然后，对于宽度 $a = 0.15\\,\\mathrm{m}$、高度 $b = 0.10\\,\\mathrm{m}$ 的矩形管道，声速 $c_{0} = 343\\,\\mathrm{m/s}$，计算模态指数 $m=2$ 和 $n=1$ 时的横向模态波数和相应的截止频率。\n\n将您的数值结果四舍五入至四位有效数字。横向模态波数以 $\\mathrm{rad/m}$ 为单位，截止频率以 $\\mathrm{Hz}$ 为单位表示。以一个二元行矩阵 $\\bigl(\\gamma_{mn}, f_{mn}\\bigr)$ 的形式提供您的最终答案。",
            "solution": "该问题要求推导声波方程，建立具有刚性壁面的矩形管道的横向特征值问题，得出模态特性，并进行具体的数值计算。\n\n推导从静止、无粘、可压缩流体的线性化控制方程开始。这些方程是：\n1.  连续性方程：\n    $$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 $$\n2.  动量方程（欧拉方程）：\n    $$ \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} = -\\nabla p' $$\n3.  等熵状态方程，它将压力扰动 $p'$ 与密度扰动 $\\rho'$ 联系起来：\n    $$ p' = c_{0}^{2} \\rho' $$\n在此，$\\rho_{0}$ 是平均流体密度，$c_{0}$ 是声速，$\\boldsymbol{u}'$ 是声学质点速度，$p'$ 是声压。\n\n为了推导声压 $p'$ 的波动方程，我们将这三个方程组合起来。首先，我们使用状态方程将 $\\rho'$ 用 $p'$ 表示：$\\rho' = p'/c_{0}^{2}$。对其求时间导数得到：\n$$ \\frac{\\partial \\rho'}{\\partial t} = \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\n将此代入连续性方程得出：\n$$ \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 \\quad \\implies \\quad \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\n接下来，我们对动量方程取散度。假设平均密度 $\\rho_{0}$ 在空间上是均匀的，我们可以交换散度算子和时间导数算子：\n$$ \\nabla \\cdot \\left( \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\nabla \\cdot (\\nabla p') = -\\nabla^{2} p' $$\n现在，我们将重新整理后的连续性方程对时间求导：\n$$ \\frac{\\partial}{\\partial t} \\left( \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n通过令 $\\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}')$ 的两个表达式相等，我们得到：\n$$ -\\nabla^{2} p' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n这简化为齐次声波方程：\n$$ \\nabla^{2} p' - \\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} = 0 $$\n为分析沿管道（$z$轴）的波传播，我们假设一个形式为 $p'(x,y,z,t) = p(x,y,z) e^{i\\omega t}$ 的时间谐波解，其中 $\\omega = 2\\pi f$ 是角频率。将此代入波动方程，得到复压幅 $p(x,y,z)$ 的亥姆霍兹方程：\n$$ \\nabla^{2} p + \\left(\\frac{\\omega}{c_{0}}\\right)^{2} p = 0 \\quad \\implies \\quad \\nabla^{2} p + k^{2} p = 0 $$\n其中 $k = \\omega/c_{0}$ 是声波数。\n\n我们使用变量分离法求解亥姆霍兹方程。对于在 $z$ 方向传播的波，我们寻找形式为 $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$ 的解，其中 $\\psi(x,y)$ 是横向模态振型，$k_z$ 是轴向波数。拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$。将分离后的形式代入亥姆霍兹方程：\n$$ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi e^{\\pm ik_z z} + \\psi \\frac{\\partial^{2}}{\\partial z^{2}} e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\n$$ e^{\\pm ik_z z} \\left[ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi \\right] + \\psi (-k_z^2) e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\n除以 $e^{\\pm ik_z z}$ 并针对横向部分重新整理得到：\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} = -(k^{2} - k_z^{2})\\psi $$\n这是一个二维特征值问题。我们定义横向波数 $\\gamma$，使得 $\\gamma^{2} = k^{2} - k_z^{2}$。这个方程被称为色散关系，它联系了声波数、轴向波数和横向波数。横向特征值问题即为：\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} + \\gamma^{2}\\psi = 0 $$\n边界条件由刚性（声学硬）壁面确定。在刚性表面上，质点速度的法向分量必须为零。根据时间谐波动量方程，$\\boldsymbol{u} = \\frac{i}{\\omega \\rho_{0}} \\nabla p$。因此，条件 $\\boldsymbol{u} \\cdot \\hat{n} = 0$（其中 $\\hat{n}$ 是壁面的法向量）意味着 $\\nabla p \\cdot \\hat{n} = 0$。对于矩形管道，这意味着：\n$$ \\frac{\\partial p}{\\partial x} = 0 \\text{ at } x=0, a \\quad \\text{and} \\quad \\frac{\\partial p}{\\partial y} = 0 \\text{ at } y=0, b $$\n由于 $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$，这些条件直接适用于模态振型 $\\psi(x,y)$。\n我们通过进一步的变量分离法 $\\psi(x,y) = X(x)Y(y)$ 来求解横向特征值问题。这会得到两个常微分方程：\n$$ \\frac{d^{2}X}{dx^{2}} + k_{x}^{2}X = 0 \\quad \\text{and} \\quad \\frac{d^{2}Y}{dy^{2}} + k_{y}^{2}Y = 0 $$\n其中 $\\gamma^{2} = k_{x}^{2} + k_{y}^{2}$。$X(x)$ 的通解是 $A \\cos(k_x x) + B \\sin(k_x x)$。应用边界条件：\n$\\frac{dX}{dx}|_{x=0} = B k_x = 0 \\implies B=0$。所以，$X(x) = A \\cos(k_x x)$。\n$\\frac{dX}{dx}|_{x=a} = -A k_x \\sin(k_x a) = 0 \\implies \\sin(k_x a) = 0$。\n这要求 $k_x a = m\\pi$，其中整数 $m=0, 1, 2, ...$。因此，$k_x = \\frac{m\\pi}{a}$。\n类似地，对于 $Y(y)$，边界条件得出 $k_y = \\frac{n\\pi}{b}$，其中整数 $n=0, 1, 2, ...$。\n因此，$(m,n)$ 模态的模态横向波数为：\n$$ \\gamma_{mn} = \\sqrt{k_{x}^{2} + k_{y}^{2}} = \\sqrt{\\left(\\frac{m\\pi}{a}\\right)^{2} + \\left(\\frac{n\\pi}{b}\\right)^{2}} = \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\n一个模态只有当其轴向波数 $k_z = \\sqrt{k^2 - \\gamma_{mn}^2}$ 为实数时才能传播，这要求 $k^2 \\geq \\gamma_{mn}^2$。从非传播（倏逝）到传播的过渡发生在截止频率处，此时 $k_z=0$。这个条件是 $k = \\gamma_{mn}$，或 $\\omega/c_0 = \\gamma_{mn}$。截止角频率为 $\\omega_{mn} = c_0 \\gamma_{mn}$。以赫兹为单位的截止频率为 $f_{mn} = \\omega_{mn}/(2\\pi)$：\n$$ f_{mn} = \\frac{c_{0}\\gamma_{mn}}{2\\pi} = \\frac{c_{0}}{2\\pi} \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\n\n现在，我们对给定参数进行数值计算：$a = 0.15\\,\\mathrm{m}$，$b = 0.10\\,\\mathrm{m}$，$c_{0} = 343\\,\\mathrm{m/s}$，以及模态指数 $m=2$, $n=1$。\n\n首先，我们计算横向模态波数 $\\gamma_{21}$：\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} $$\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{40}{3}\\right)^{2} + (10)^{2}} = \\pi \\sqrt{\\frac{1600}{9} + 100} = \\pi \\sqrt{\\frac{1600+900}{9}} = \\pi \\sqrt{\\frac{2500}{9}} = \\frac{50\\pi}{3} $$\n数值上，这等于：\n$$ \\gamma_{21} \\approx 52.359877... \\, \\mathrm{rad/m} $$\n四舍五入到四位有效数字，$\\gamma_{21} = 52.36 \\, \\mathrm{rad/m}$。\n\n接下来，我们计算相应的截止频率 $f_{21}$：\n$$ f_{21} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} = \\frac{343}{2} \\sqrt{\\frac{2500}{9}} = \\frac{343}{2} \\left(\\frac{50}{3}\\right) = \\frac{343 \\times 25}{3} = \\frac{8575}{3} $$\n数值上，这等于：\n$$ f_{21} \\approx 2858.333... \\, \\mathrm{Hz} $$\n四舍五入到四位有效数字，$f_{21} = 2858 \\, \\mathrm{Hz}$。\n\n最终答案是数组 $(\\gamma_{21}, f_{21})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n52.36  2858\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "共振是声学中的一个核心原理，许多消声器利用它来有效衰减特定频率的噪声。本练习通过分析一个经典案例——一端封闭、另一端开放的管道——来深入探讨这一现象。通过施加正确的物理边界条件，您将确定管道发生共振的特定频率，从而为理解调谐式声学滤波器奠定基础。",
            "id": "4121384",
            "problem": "一个长度为 $L$、横截面积恒为 $S$ 的直、均匀、刚性壁管道中，含有一种静止、无粘性、热中性的气体，其环境密度为 $\\rho_{0}$，声速为 $c_{0}$。小振幅的一维平面声波沿着轴向坐标 $x \\in [0,L]$ 传播。该管道在 $x=0$ 处由刚性端封闭，在 $x=L$ 处开口，通向一个大型消声室。假设为线性声学，热粘性损耗可忽略不计，且高阶横截面模式被截止，因此只有平面波模式存在。\n\n从线性化的动量守恒和质量守恒方程，以及等熵状态方程出发，推导管道中声压脉动 $p'(x,t)$ 和声质点速度 $u'(x,t)$ 的控制方程。施加封闭端 $u'(0,t)=0$ 和开口端 $p'(L,t)=0$ 的边界条件，并确定与共振条件相对应的 $p'(x,t)$ 和 $u'(x,t)$ 的允许驻波模式。\n\n将最终答案表示为第 $n$ 个共振频率 $f_{n}$ 的单个闭式解析表达式，该表达式用 $n$、$c_{0}$ 和 $L$ 表示，其中 $n \\in \\{1,2,3,\\ldots\\}$。不要计算任何数值。最终答案仅以解析表达式形式给出；最终表达式中不要包含单位。",
            "solution": "该问题旨在确定长度为 $L$ 的刚性壁管道中小振幅一维平面声波的共振频率及相应的驻波模式。该管道一端（$x=0$）封闭，另一端（$x=L$）开口。分析始于针对静止、无粘性、热中性气体的线性化流体动力学方程。\n\n基本控制方程是线性化的动量守恒和质量守恒方程，以及等熵状态方程。\n\n1.  **线性化动量守恒（欧拉方程）：**\n    对于沿 $x$ 轴的一维流动，该方程将声质点速度 $u'(x,t)$ 的时间变化与声压脉动 $p'(x,t)$ 的空间梯度联系起来。\n    $$ \\rho_{0} \\frac{\\partial u'}{\\partial t} = - \\frac{\\partial p'}{\\partial x} \\quad (1) $$\n    这里，$\\rho_{0}$ 是气体的环境密度。\n\n2.  **线性化质量守恒（连续性方程）：**\n    该方程将声密度脉动 $\\rho'(x,t)$ 的时间变化与声质点速度的空间梯度联系起来。\n    $$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\frac{\\partial u'}{\\partial x} = 0 \\quad (2) $$\n\n3.  **等熵状态方程：**\n    对于小振幅的绝热过程，压力和密度脉动是线性成正比的。\n    $$ p' = c_{0}^{2} \\rho' \\quad (3) $$\n    其中 $c_{0}$ 是介质中的声速。对时间 $t$ 求导可得：\n    $$ \\frac{\\partial p'}{\\partial t} = c_{0}^{2} \\frac{\\partial \\rho'}{\\partial t} \\quad (4) $$\n\n从这三个基本关系式，我们可以推导出一维声波方程。首先，将方程 $(2)$ 中的 $\\frac{\\partial \\rho'}{\\partial t}$ 代入方程 $(4)$：\n$$ \\frac{\\partial p'}{\\partial t} = c_{0}^{2} \\left( - \\rho_{0} \\frac{\\partial u'}{\\partial x} \\right) = - \\rho_{0} c_{0}^{2} \\frac{\\partial u'}{\\partial x} $$\n这可以重排得到第二个耦合的一阶方程：\n$$ \\frac{\\partial u'}{\\partial x} = - \\frac{1}{\\rho_{0} c_{0}^{2}} \\frac{\\partial p'}{\\partial t} \\quad (5) $$\n\n方程 $(1)$ 和 $(5)$ 构成了关于 $p'(x,t)$ 和 $u'(x,t)$ 的两个耦合一阶偏微分方程组。为了获得关于声压 $p'$ 的单个二阶波动方程，我们对方程 $(1)$ 关于 $x$ 求导，对方程 $(5)$ 关于 $t$ 求导：\n$$ \\frac{\\partial}{\\partial x} \\left( \\rho_{0} \\frac{\\partial u'}{\\partial t} \\right) = - \\frac{\\partial^{2} p'}{\\partial x^{2}} \\implies \\rho_{0} \\frac{\\partial^{2} u'}{\\partial x \\partial t} = - \\frac{\\partial^{2} p'}{\\partial x^{2}} $$\n$$ \\frac{\\partial}{\\partial t} \\left( \\frac{\\partial u'}{\\partial x} \\right) = - \\frac{\\partial}{\\partial t} \\left( \\frac{1}{\\rho_{0} c_{0}^{2}} \\frac{\\partial p'}{\\partial t} \\right) \\implies \\frac{\\partial^{2} u'}{\\partial t \\partial x} = - \\frac{1}{\\rho_{0} c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n假设函数足够光滑，使得求导顺序可以互换（$\\frac{\\partial^{2} u'}{\\partial x \\partial t} = \\frac{\\partial^{2} u'}{\\partial t \\partial x}$），我们令两个表达式相等：\n$$ - \\frac{1}{\\rho_{0}} \\frac{\\partial^{2} p'}{\\partial x^{2}} = - \\frac{1}{\\rho_{0} c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\n这可以简化为标准的声压一维齐次波动方程：\n$$ \\frac{\\partial^{2} p'}{\\partial x^{2}} - \\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} = 0 $$\n类似的推导可以得到声质点速度 $u'$ 的相同波动方程。\n\n为了找到对应于共振条件的驻波解，我们使用分离变量法。我们假设一个形式为 $p'(x,t) = \\hat{p}(x) e^{i \\omega t}$ 的时谐解，其中 $\\omega$ 是角频率。将其代入波动方程，得到空间部分 $\\hat{p}(x)$ 的亥姆霍兹方程：\n$$ \\frac{d^{2}\\hat{p}}{dx^{2}} e^{i \\omega t} - \\frac{1}{c_{0}^{2}}(i \\omega)^{2} \\hat{p} e^{i \\omega t} = 0 $$\n$$ \\frac{d^{2}\\hat{p}}{dx^{2}} + \\frac{\\omega^{2}}{c_{0}^{2}} \\hat{p} = 0 $$\n定义波数 $k = \\frac{\\omega}{c_{0}}$，方程变为：\n$$ \\frac{d^{2}\\hat{p}}{dx^{2}} + k^{2} \\hat{p} = 0 $$\n压力幅值 $\\hat{p}(x)$ 的通解为：\n$$ \\hat{p}(x) = A \\cos(kx) + B \\sin(kx) $$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n声质点速度幅值 $\\hat{u}(x)$ 可以通过动量方程 $(1)$ 与 $\\hat{p}(x)$ 相关联：\n$$ \\rho_{0} \\frac{\\partial}{\\partial t}(\\hat{u}(x)e^{i\\omega t}) = - \\frac{d}{dx}(\\hat{p}(x)e^{i\\omega t}) $$\n$$ i \\omega \\rho_{0} \\hat{u}(x) = - \\frac{d\\hat{p}}{dx} \\implies \\hat{u}(x) = \\frac{i}{\\omega \\rho_{0}} \\frac{d\\hat{p}}{dx} $$\n对 $\\hat{p}(x)$ 求导：\n$$ \\frac{d\\hat{p}}{dx} = -Ak \\sin(kx) + Bk \\cos(kx) $$\n将其代入 $\\hat{u}(x)$ 的表达式中：\n$$ \\hat{u}(x) = \\frac{ik}{\\omega \\rho_{0}} (-A \\sin(kx) + B \\cos(kx)) = \\frac{i}{\\rho_{0}c_{0}} (-A \\sin(kx) + B \\cos(kx)) $$\n\n现在我们应用问题中指定的边界条件：\n1.  **$x=0$ 处的封闭端：** 管道由刚性壁终止，因此质点速度必须为零。$u'(0,t) = 0$，这意味着 $\\hat{u}(0)=0$。\n    $$ \\hat{u}(0) = \\frac{i}{\\rho_{0}c_{0}} (-A \\sin(0) + B \\cos(0)) = \\frac{iB}{\\rho_{0}c_{0}} = 0 $$\n    这要求常数 $B=0$。\n\n2.  **$x=L$ 处的开口端：** 管道通向一个大型消声室，其作用相当于一个压力释放面。因此，声压脉动为零。$p'(L,t) = 0$，这意味着 $\\hat{p}(L)=0$。\n    当 $B=0$ 时，$\\hat{p}(x)$ 的解简化为 $\\hat{p}(x) = A \\cos(kx)$。在 $x=L$ 处应用该条件：\n    $$ \\hat{p}(L) = A \\cos(kL) = 0 $$\n    为了得到非平凡解（$A \\neq 0$），我们必须有 $\\cos(kL) = 0$。只有当参数 $kL$ 是 $\\frac{\\pi}{2}$ 的奇数倍时，此条件才成立。\n    $$ k_{n}L = (2n-1)\\frac{\\pi}{2}, \\quad \\text{for } n \\in \\{1, 2, 3, \\ldots\\} $$\n    该方程将波数 $k$ 的可能值量子化，从而得到一组由整数 $n$ 索引的离散共振模式，或称本征模式。允许的波数为：\n    $$ k_{n} = \\frac{(2n-1)\\pi}{2L} $$\n\n共振频率 $f_{n}$ 通过 $\\omega_{n} = 2\\pi f_{n} = c_{0}k_{n}$ 与角频率 $\\omega_{n}$ 和波数 $k_{n}$ 相关联。\n$$ 2\\pi f_{n} = c_{0} \\left( \\frac{(2n-1)\\pi}{2L} \\right) $$\n求解 $f_{n}$ 可得到闭口-开口管道的共振频率表达式：\n$$ f_{n} = \\frac{(2n-1)c_{0}}{4L} $$\n对于每个共振频率 $f_{n}$，都有一个相应的驻波模式。第 $n$ 阶模式的空间形状由以下公式给出：\n声压：\n$$ \\hat{p}_{n}(x) = A_{n} \\cos(k_{n}x) = A_{n} \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right) $$\n声质点速度（当 $B=0$ 且 $k=k_n$ 时）：\n$$ \\hat{u}_{n}(x) = -\\frac{iA_{n}}{\\rho_{0}c_{0}} \\sin(k_{n}x) = -\\frac{iA_{n}}{\\rho_{0}c_{0}} \\sin\\left(\\frac{(2n-1)\\pi x}{2L}\\right) $$\n完整的含时驻波模式是复数解的实部：\n$$ p'_{n}(x,t) = \\text{Re}\\{\\hat{p}_{n}(x)e^{i\\omega_{n}t}\\} = A_{n} \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right) \\cos(\\omega_{n}t) $$\n$$ u'_{n}(x,t) = \\text{Re}\\{\\hat{u}_{n}(x)e^{i\\omega_{n}t}\\} = \\frac{A_{n}}{\\rho_{0}c_{0}} \\sin\\left(\\frac{(2n-1)\\pi x}{2L}\\right) \\sin(\\omega_{n}t) $$\n这些模式显示，在封闭端 $x=0$ 处有一个压力波腹，在开口端 $x=L$ 处有一个压力波节。相反，速度在 $x=0$ 处有一个波节，在 $x=L$ 处有一个波腹。\n所要求的最终答案是第 $n$ 个共振频率 $f_{n}$ 的公式。",
            "answer": "$$\\boxed{\\frac{(2n-1)c_{0}}{4L}}$$"
        },
        {
            "introduction": "模拟一个完整的排气或暖通空调（HVAC）系统，需要对不同组件间的相互作用进行建模。双端口网络形式论是实现这一目标的强大工具，它将每个元件表示为一个具有确定输入/输出关系的“黑盒子”。本计算练习将指导您为一个常见的声学元件——多孔板——进行建模，并将其物理阻抗转换为标准的网络矩阵，这是构建系统级声学仿真的关键技能。",
            "id": "4121377",
            "problem": "您的任务是为连接管道段的一维线性声学二端口实现、验证和应用参数转换，并利用这些转换来分析用作管道内元件的穿孔板。该二端口由端口变量压力 $p$（单位为 $\\mathrm{Pa}$）和体积速度 $U$（单位为 $\\mathrm{m^3/s}$）来表征。本问题的基本基础是管道中的线性化平面波声学以及定义二端口参数的网络关系。\n\n从标准的转移（也称为传输）参数表示法开始，该表示法由以下线性关系定义：\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix},\n$$\n其中 $A$、$B$、$C$ 和 $D$ 是随频率变化的复函数，$p_1$、$U_1$、$p_2$ 和 $U_2$ 是在一维平面波假设下，两个端口处压力和体积速度的复相量振幅。同样，定义导纳参数表示法如下：\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix},\n$$\n其中 $Y_{ij}$ 是导纳矩阵的复数元素，单位为 $\\mathrm{m^3/(Pa\\cdot s)}$。\n\n您的任务是：\n- 基于上述定义的第一性原理，推导转移参数 $(A,B,C,D)$ 和导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$ 之间的代数转换关系。不要假设任何现成的快捷公式；通过消元和求解线性方程组来推导这些关系。\n- 实现函数，用于将转移参数 $(A,B,C,D)$ 转换为导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$，反之亦然，并确保在参数为有限且非奇异时具有数值鲁棒性。\n- 将串联插入管道中的穿孔板建模为两端口之间的串联声阻抗 $Z_{\\mathrm{plate}}$。使用一个具有物理依据的模型，该模型包含通过圆孔的振荡流所产生的粘性损耗和惯性：\n  - 对于半径为 $a$、板厚为 $t$ 的圆孔，每个孔的粘性（泊肃叶）阻力近似为\n    $$\n    R_{\\mathrm{hole}} = \\frac{8\\,\\mu\\,t}{\\pi\\,a^4},\n    $$\n    其中 $\\mu$ 是空气的动力粘度，每个孔的惯性质量为\n    $$\n    M_{\\mathrm{hole}} = \\frac{\\rho_0\\,L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}, \\quad L_{\\mathrm{eff}} = t + 1.7\\,a, \\quad S_{\\mathrm{hole}} = \\pi a^2,\n    $$\n    其中 $\\rho_0$ 是环境空气密度。每个孔的阻抗为\n    $$\n    Z_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\,\\omega\\,M_{\\mathrm{hole}},\n    $$\n    其中 $\\omega$ 是角频率（单位为 $\\mathrm{rad/s}$），$j$ 是虚数单位。对于并联的 $N$ 个相同孔，板的总阻抗为\n    $$\n    Z_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}.\n    $$\n- 将穿孔板表示为一个串联元件二端口，其转移矩阵为\n  $$\n  \\begin{bmatrix}\n  A  B \\\\\n  C  D\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  1  Z_{\\mathrm{plate}} \\\\\n  0  1\n  \\end{bmatrix},\n  $$\n  并使用您的转换函数获取该穿孔板的导纳参数 $(Y_{11},Y_{12},Y_{21},Y_{22})$。\n- 通过对穿孔板执行往返转换（从转移参数到导纳参数，再回到转移参数）来数值上验证您转换函数的正确性，并计算 $(A,B,C,D)$ 的最大相对偏差。\n\n使用以下给定的空气属性和常数：\n- 环境空气密度：$\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$。\n- 空气动力粘度：$\\mu = 1.84\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$。\n- 声速（仅供参考，下面不直接需要）：$c_0 = 343\\,\\mathrm{m/s}$。\n\n实现您的程序，为以下四个科学上合理的测试案例计算结果，这些案例涵盖了粘性主导和惯性主导的不同区间：\n\n- 测试案例1：频率 $f = 500\\,\\mathrm{Hz}$，孔半径 $a = 2\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 2\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 100$。\n- 测试案例2：频率 $f = 2000\\,\\mathrm{Hz}$，孔半径 $a = 2\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 8\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 100$。\n- 测试案例3：频率 $f = 500\\,\\mathrm{Hz}$，孔半径 $a = 5\\times 10^{-3}\\,\\mathrm{m}$，板厚 $t = 2\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 500$。\n- 测试案例4：频率 $f = 2000\\,\\mathrm{Hz}$，孔半径 $a = 5\\times 10^{-4}\\,\\mathrm{m}$，板厚 $t = 10\\times 10^{-3}\\,\\mathrm{m}$，孔数 $N = 50$。\n\n对于每个测试案例，您的程序必须产生三个输出：\n- $Y_{11}$ 的实部（单位 $\\mathrm{m^3/(Pa\\cdot s)}$）。\n- $Y_{11}$ 的虚部（单位 $\\mathrm{m^3/(Pa\\cdot s)}$）。\n- 往返转换 $(A,B,C,D)\\rightarrow (Y_{11},Y_{12},Y_{21},Y_{22})\\rightarrow (A,B,C,D)$ 的最大相对误差，以十进制数表示（无单位）。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含 $12$ 个结果（每个测试案例三个，按测试案例 $1$ 到 $4$ 的顺序排列），格式为一个用方括号括起来的逗号分隔列表，例如 $[y11\\_r^{(1)},y11\\_i^{(1)},\\epsilon^{(1)},y11\\_r^{(2)},y11\\_i^{(2)},\\epsilon^{(2)},y11\\_r^{(3)},y11\\_i^{(3)},\\epsilon^{(3)},y11\\_r^{(4)},y11\\_i^{(4)},\\epsilon^{(4)}]$，其中每个 $y11\\_r^{(k)}$ 和 $y11\\_i^{(k)}$ 的单位是 $\\mathrm{m^3/(Pa\\cdot s)}$，每个 $\\epsilon^{(k)}$ 是一个十进制数。",
            "solution": "问题陈述已经过验证，被认为是有效的。其科学基础在于线性声学和二端口网络理论，问题是适定的，并包含了获得唯一解所需的所有信息。\n\n解决方案分三个阶段进行：首先，从第一性原理推导转移矩阵和导纳矩阵表示法之间的代数转换关系；其次，将穿孔板建模为串联声阻抗并确定其转移矩阵；第三，通过计算实现这些模型和转换，以分析指定的测试案例并通过往返计算验证实现。\n\n### 1. 二端口参数转换的推导\n\n线性声学元件两端口处的压力 $p$ 和体积速度 $U$ 之间的关系可以用不同的矩阵形式来描述。我们已知转移矩阵和导纳矩阵的定义。\n\n转移矩阵关系为：\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix}\n$$\n这可以写成两个独立的线性方程：\n$$\np_1 = A p_2 + B U_2 \\quad (1)\n$$\n$$\nU_1 = C p_2 + D U_2 \\quad (2)\n$$\n\n导纳矩阵关系为：\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix}\n$$\n这也可以写成两个独立的线性方程：\n$$\nU_1 = Y_{11} p_1 + Y_{12} p_2 \\quad (3)\n$$\n$$\nU_2 = Y_{21} p_1 + Y_{22} p_2 \\quad (4)\n$$\n\n我们的目标是通过代数操作，用一个矩阵的元素来表示另一个矩阵的元素。\n\n**1.1. 转移矩阵到导纳矩阵 ($T \\rightarrow Y$)**\n\n为了求导纳参数 ($Y_{11}, Y_{12}, Y_{21}, Y_{22}$)，我们需要使用方程 $(1)$ 和 $(2)$ 将 $U_1$ 和 $U_2$ 表示为 $p_1$ 和 $p_2$ 的函数。\n\n从方程 $(1)$，假设 $B \\neq 0$，我们可以解出 $U_2$：\n$$\nB U_2 = p_1 - A p_2 \\implies U_2 = \\frac{1}{B} p_1 - \\frac{A}{B} p_2\n$$\n该方程的形式与方程 $(4)$ $U_2 = Y_{21} p_1 + Y_{22} p_2$ 相同。通过直接比较，我们得到：\n$$\nY_{21} = \\frac{1}{B}\n$$\n$$\nY_{22} = -\\frac{A}{B}\n$$\n现在，我们将 $U_2$ 的表达式代入方程 $(2)$：\n$$\nU_1 = C p_2 + D \\left( \\frac{1}{B} p_1 - \\frac{A}{B} p_2 \\right)\n$$\n重新整理各项，按 $p_1$ 和 $p_2$ 分组：\n$$\nU_1 = \\frac{D}{B} p_1 + \\left( C - \\frac{AD}{B} \\right) p_2 = \\frac{D}{B} p_1 - \\frac{AD - BC}{B} p_2\n$$\n该方程的形式与方程 $(3)$ $U_1 = Y_{11} p_1 + Y_{12} p_2$ 相同。通过比较得到：\n$$\nY_{11} = \\frac{D}{B}\n$$\n$$\nY_{12} = -\\frac{AD - BC}{B}\n$$\n项 $AD - BC = \\det(T)$ 是转移矩阵的行列式。对于无源、互易的二端口，该行列式为 1，即 $AD-BC=1$。给定的穿孔板模型是互易的。\n\n**1.2. 导纳矩阵到转移矩阵 ($Y \\rightarrow T$)**\n\n为了求转移参数 ($A, B, C, D$)，我们需要使用方程 $(3)$ 和 $(4)$ 将 $p_1$ 和 $U_1$ 表示为 $p_2$ 和 $U_2$ 的函数。\n\n从方程 $(4)$，假设 $Y_{21} \\neq 0$，我们可以解出 $p_1$：\n$$\nY_{21} p_1 = U_2 - Y_{22} p_2 \\implies p_1 = -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2\n$$\n该方程的形式与方程 $(1)$ $p_1 = A p_2 + B U_2$ 相同。通过比较得到：\n$$\nA = -\\frac{Y_{22}}{Y_{21}}\n$$\n$$\nB = \\frac{1}{Y_{21}}\n$$\n现在，我们将 $p_1$ 的表达式代入方程 $(3)$：\n$$\nU_1 = Y_{11} \\left( -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2 \\right) + Y_{12} p_2\n$$\n重新整理各项，按 $p_2$ 和 $U_2$ 分组：\n$$\nU_1 = \\left( Y_{12} - \\frac{Y_{11}Y_{22}}{Y_{21}} \\right) p_2 + \\frac{Y_{11}}{Y_{21}} U_2 = -\\frac{Y_{11}Y_{22} - Y_{12}Y_{21}}{Y_{21}} p_2 + \\frac{Y_{11}}{Y_{21}} U_2\n$$\n该方程的形式与方程 $(2)$ $U_1 = C p_2 + D U_2$ 相同。项 $Y_{11}Y_{22} - Y_{12}Y_{21} = \\det(Y)$ 是导纳矩阵的行列式。通过比较得到：\n$$\nC = -\\frac{\\det(Y)}{Y_{21}}\n$$\n$$\nD = \\frac{Y_{11}}{Y_{21}}\n$$\n这些推导出的公式允许在这两种表示法之间进行直接转换，前提是分母（分别为 $B$ 和 $Y_{21}$）不为零。\n\n### 2. 穿孔板的声学模型\n\n穿孔板被建模为一个简单的串联声阻抗 $Z_{\\mathrm{plate}}(\\omega)$，其中 $\\omega = 2\\pi f$ 是角频率。该阻抗考虑了空气在孔中振荡时的粘性损耗和惯性效应。\n\n总阻抗由 $N$ 个相同孔的并联组合决定。单个孔的阻抗 $Z_{\\mathrm{hole}}$ 是电阻部分 $R_{\\mathrm{hole}}$ 和惯性（类质量）电抗 $j\\omega M_{\\mathrm{hole}}$ 的和。\n$$\nZ_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\omega M_{\\mathrm{hole}}\n$$\n电阻项由半径为 $a$、长度（板厚）为 $t$ 的圆管的泊肃叶流阻给出：\n$$\nR_{\\mathrm{hole}} = \\frac{8\\mu t}{\\pi a^4}\n$$\n其中 $\\mu$ 是空气的动力粘度。惯性质量项包含一个端部修正，以考虑在孔口外部随空气移动的流体质量。有效长度 $L_{\\mathrm{eff}}$ 是板厚加上此修正：\n$$\nL_{\\mathrm{eff}} = t + 1.7a\n$$\n则每个孔的质量是此有效体积中的总质量除以面积 $S_{\\mathrm{hole}} = \\pi a^2$：\n$$\nM_{\\mathrm{hole}} = \\frac{\\rho_0 L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}\n$$\n其中 $\\rho_0$ 是环境空气密度。\n\n对于并联的 $N$ 个相同孔，总板阻抗为：\n$$\nZ_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}\n$$\n管道中阻抗为 $Z$ 的串联元件对应一个二端口，其中体积速度是连续的（$U_1 = U_2$），且压力在元件两端下降（$p_1 - p_2 = Z U_1$）。这产生了特定的转移矩阵：\n$$\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  Z_{\\mathrm{plate}} \\\\\n0  1\n\\end{bmatrix}\n$$\n\n### 3. 计算流程与验证\n\n每个测试案例的总体算法如下：\n1. 给定测试案例参数（$f, a, t, N$）和物理常数（$\\rho_0, \\mu$），计算复声阻抗 $Z_{\\mathrm{plate}}(\\omega)$。\n2. 为该板构建初始转移矩阵 $T_{\\mathrm{orig}}$：$A=1$，$B=Z_{\\mathrm{plate}}$，$C=0$，$D=1$。所有这些都是复数，尽管 $A, C, D$ 的初始虚部为零。\n3. 应用推导出的 $T \\rightarrow Y$ 转换公式求导纳参数 $(Y_{11}, Y_{12}, Y_{21}, Y_{22})$。对于这个特定的 T 矩阵，由于 $A=D=1$，$C=0$，且 $AD-BC = 1$，公式简化为 $Y_{11} = 1/Z_{\\mathrm{plate}}$，$Y_{12} = -1/Z_{\\mathrm{plate}}$，$Y_{21} = 1/Z_{\\mathrm{plate}}$，以及 $Y_{22} = -1/Z_{\\mathrm{plate}}$。然后提取所需的输出 $\\mathrm{Re}(Y_{11})$ 和 $\\mathrm{Im}(Y_{11})$。\n4. 为验证转换函数的正确性，执行一次往返转换。将 $Y \\rightarrow T$ 转换应用于计算出的导纳矩阵，以获得新的转移矩阵 $T_{\\mathrm{new}} = [A', B', C', D']$。\n5. 理论上，$T_{\\mathrm{new}}$ 应与 $T_{\\mathrm{orig}}$ 相同。任何差异都源于浮点数值精度误差。计算最大相对误差 $\\epsilon$ 以量化此偏差。鉴于一些原始参数为 $0$ 或 $1$，采用混合的绝对/相对误差度量是合适的：\n$$\n\\epsilon = \\max\\left( \\left|A' - 1\\right|, \\left|\\frac{B' - B}{B}\\right|, \\left|C' - 0\\right|, \\left|D' - 1\\right| \\right)\n$$\n对所有四个测试案例执行此程序，并将每个案例的结果（$\\mathrm{Re}(Y_{11})$, $\\mathrm{Im}(Y_{11})$, $\\epsilon$）汇总到一个最终列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the duct acoustics problem for perforated plates.\n    This involves deriving and implementing two-port parameter conversions,\n    modeling the plate impedance, and running several test cases.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    RHO_0 = 1.204  # Ambient air density in kg/m^3\n    MU = 1.84e-5   # Dynamic viscosity of air in Pa.s\n\n    def _calculate_plate_impedance(f, a, t, N):\n        \"\"\"\n        Calculates the acoustic impedance of the perforated plate based on\n        the provided physical model.\n\n        Args:\n            f (float): Frequency in Hz.\n            a (float): Hole radius in m.\n            t (float): Plate thickness in m.\n            N (int): Number of holes.\n\n        Returns:\n            complex: The complex acoustic impedance Z_plate.\n        \"\"\"\n        omega = 2 * np.pi * f\n        s_hole = np.pi * a**2\n        \n        # Viscous resistance per hole\n        r_hole = (8 * MU * t) / (np.pi * a**4)\n        \n        # Inertial mass per hole with end correction\n        l_eff = t + 1.7 * a\n        m_hole = (RHO_0 * l_eff) / s_hole\n        \n        # Impedance per hole (complex)\n        z_hole = r_hole + 1j * omega * m_hole\n        \n        # Total impedance for N holes in parallel\n        z_plate = z_hole / N\n        return z_plate\n\n    def _transfer_to_admittance(A, B, C, D):\n        \"\"\"\n        Converts transfer matrix parameters (A, B, C, D) to admittance\n        matrix parameters (Y11, Y12, Y21, Y22).\n        \"\"\"\n        if np.abs(B)  1e-15: # Avoid division by zero\n            raise ValueError(\"Cannot convert to admittance matrix: parameter B is zero.\")\n        det_T = A * D - B * C\n        Y11 = D / B\n        Y12 = -det_T / B\n        Y21 = 1 / B\n        Y22 = -A / B\n        return Y11, Y12, Y21, Y22\n\n    def _admittance_to_transfer(Y11, Y12, Y21, Y22):\n        \"\"\"\n        Converts admittance matrix parameters back to transfer matrix parameters\n        for verification.\n        \"\"\"\n        if np.abs(Y21)  1e-15:  # Avoid division by zero\n            raise ValueError(\"Cannot convert to transfer matrix: parameter Y21 is zero.\")\n        det_Y = Y11 * Y22 - Y12 * Y21\n        A = -Y22 / Y21\n        B = 1 / Y21\n        C = -det_Y / Y21\n        D = Y11 / Y21\n        return A, B, C, D\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (frequency f, hole radius a, plate thickness t, number of holes N)\n        (500, 2e-3, 2e-3, 100),\n        (2000, 2e-3, 8e-3, 100),\n        (500, 5e-3, 2e-3, 500),\n        (2000, 5e-4, 10e-3, 50),\n    ]\n\n    results = []\n    for f, a, t, N in test_cases:\n        # 1. Model plate and get its original transfer matrix T_orig\n        z_plate = _calculate_plate_impedance(f, a, t, N)\n        A_orig, B_orig, C_orig, D_orig = 1.0, z_plate, 0.0, 1.0\n\n        # 2. Convert T_orig to admittance matrix Y\n        Y11, Y12, Y21, Y22 = _transfer_to_admittance(A_orig, B_orig, C_orig, D_orig)\n        \n        # 3. Store required outputs: Re(Y11) and Im(Y11)\n        results.append(Y11.real)\n        results.append(Y11.imag)\n\n        # 4. Perform round-trip conversion: Y back to T_new for verification\n        A_new, B_new, C_new, D_new = _admittance_to_transfer(Y11, Y12, Y21, Y22)\n\n        # 5. Compute the maximum deviation to quantify numerical error\n        # Use absolute error for components that are originally 0 or 1.\n        # Use relative error for B, which is complex and non-zero.\n        err_A = np.abs(A_new - A_orig)\n        err_B = np.abs((B_new - B_orig) / B_orig) if np.abs(B_orig) > 0 else np.abs(B_new)\n        err_C = np.abs(C_new - C_orig)\n        err_D = np.abs(D_new - D_orig)\n        \n        max_error = np.max([err_A, err_B, err_C, err_D])\n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}