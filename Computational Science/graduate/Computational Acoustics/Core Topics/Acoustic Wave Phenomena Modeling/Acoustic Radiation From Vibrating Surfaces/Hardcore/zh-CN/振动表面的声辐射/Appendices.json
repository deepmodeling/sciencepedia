{
    "hands_on_practices": [
        {
            "introduction": "在声学中，量化声源辐射的能量是首要目标之一。本练习  将引导你完成一个基础但至关重要的推导：从线性声学基本方程出发，推导时间平均声强，并将其应用于计算一个典型声源——障板活塞——的总辐射声功率。这项实践旨在巩固你对声能量流的理解，并锻炼你进行严谨数学推导的能力。",
            "id": "4114020",
            "problem": "一种质量密度为 $\\rho_{0}$、声速为 $c_{0}$ 的无粘性可压缩流体支持角频率为 $\\omega$ 的小振幅时谐声场。设声压场和质点速度场分别用其瞬时实数值形式 $p(\\mathbf{x},t)$ 和 $\\mathbf{v}(\\mathbf{x},t)$ 表示，并根据约定 $p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x})\\exp(-i \\omega t)\\}$ 和 $\\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x})\\exp(-i \\omega t)\\}$ 用复相量 $p(\\mathbf{x})$ 和 $\\mathbf{v}(\\mathbf{x})$ 表示。\n\n1) 从时域中的线性声学动量和连续性方程以及瞬时声强 $\\mathbf{I}(t) = p(\\mathbf{x},t)\\,\\mathbf{v}(\\mathbf{x},t)$ 的定义出发，根据第一性原理推导时间平均声强矢量 $\\langle \\mathbf{I} \\rangle$ 关于复相量 $p(\\mathbf{x})$ 和 $\\mathbf{v}(\\mathbf{x})$ 的表达式。你的结果应仅用 $p(\\mathbf{x})$、$\\mathbf{v}(\\mathbf{x})$ 及其复共轭表示。\n\n2) 一块刚性无限大平面障板占据平面 $z=0$。一个半径为 $a$ 的圆形活塞嵌入障板中，以原点为中心，沿着 $+z$ 方向以空间均匀的法向速度相量 $V_{0}$ 振动，即当 $\\sqrt{x^{2}+y^{2}} \\le a$ 且 $z=0$ 时，$\\mathbf{v}(\\mathbf{x}) \\cdot \\hat{\\mathbf{z}} = V_{0}$，而在障板的其他位置法向速度为零。流体占据半空间 $z0$。使用带有 Helmholtz 方程的自由空间格林函数的 Kirchhoff–Helmholtz 表示法，通过在声远场中的一个控制面上对时间平均声强的向外法向分量进行积分，推导进入半空间 $z0$ 的时间平均总辐射声功率。你的推导必须从基本场方程和第 (1) 部分的结果开始，并且不得对 $ka$ 使用任何小宗量或大宗量近似，其中 $k = \\omega/c_{0}$ 是声波数。你的最终闭式解需用 $\\rho_{0}$、$c_{0}$、$a$、$k$、$V_{0}$ 和第一类贝塞尔函数 $J_{1}(\\cdot)$ 表示。\n\n以瓦特为单位表示最终的总辐射功率。最终答案必须是单一的闭式解析表达式。不需要进行数值计算。",
            "solution": "按照要求，本问题的分析分两部分进行。第 (1) 部分要求从第一性原理推导时间平均声强。第 (2) 部分应用此结果计算无限大障板中振动圆形活塞辐射的总声功率。\n\n### 第 1 部分：时间平均声强的推导\n\n该问题置于无粘性可压缩流体的线性声学背景下。其控制方程是线性化的连续性方程和动量方程。\n连续性方程为：\n$$ \\frac{\\partial \\rho'(\\mathbf{x},t)}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{v}(\\mathbf{x},t) = 0 $$\n其中 $\\rho'$ 是声密度扰动。动量方程为：\n$$ \\rho_0 \\frac{\\partial \\mathbf{v}(\\mathbf{x},t)}{\\partial t} = -\\nabla p(\\mathbf{x},t) $$\n这些方程建立了声压 $p(\\mathbf{x},t)$ 和质点速度 $\\mathbf{v}(\\mathbf{x},t)$ 之间的物理关系。瞬时声强矢量 $\\mathbf{I}(\\mathbf{x},t)$ 定义为单位面积的能量流率，由瞬时声压和质点速度的乘积给出：\n$$ \\mathbf{I}(\\mathbf{x},t) = p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) $$\n该问题考虑角频率为 $\\omega$ 的时谐场。瞬时实数值场通过以下约定与其复值相量 $p(\\mathbf{x})$ 和 $\\mathbf{v}(\\mathbf{x})$ 相关联：\n$$ p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\n其中 $\\Re\\{Z\\}$ 表示复数 $Z$ 的实部。\n\n为了求得时间平均声强 $\\langle \\mathbf{I} \\rangle$，我们将 $\\mathbf{I}(\\mathbf{x},t)$ 在一个振荡周期 $T = 2\\pi/\\omega$ 内进行平均。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{T} \\int_0^T \\mathbf{I}(\\mathbf{x},t) dt = \\frac{1}{T} \\int_0^T p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) dt $$\n我们用复相量及其复共轭（用上标星号 $*$ 表示）来表示实数值场。对于任意复量 $Z$，其实部为 $\\Re\\{Z\\} = \\frac{1}{2}(Z + Z^*)$。\n将此应用于压力和速度相量：\n$$ p(\\mathbf{x},t) = \\frac{1}{2} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\frac{1}{2} [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n将这些表达式代入瞬时强度的定义中：\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n展开乘积得到四项：\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) \\exp(-2i \\omega t) + p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) \\exp(2i \\omega t)] $$\n现在，我们对一个周期 $T$ 进行时间平均。含时项涉及复指数的积分：\n$$ \\frac{1}{T} \\int_0^T \\exp(\\pm 2i \\omega t) dt = \\frac{1}{T} \\left[ \\frac{\\exp(\\pm 2i \\omega t)}{\\pm 2i \\omega} \\right]_0^T = \\frac{1}{T} \\frac{\\exp(\\pm 2i \\omega T) - 1}{\\pm 2i \\omega} $$\n由于 $T=2\\pi/\\omega$，我们有 $\\exp(\\pm 2i \\omega T) = \\exp(\\pm i 4\\pi) = 1$。因此，含时项的积分为零。剩下的两项不含时，所以它们的平均值就是它们本身的值。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})] $$\n这个表达式也可以用实部算子来写。由于 $p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) = (p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}))^*$，括号中的和是一个复数加上它的共轭，等于其实部的两倍。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [2\\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\}] = \\frac{1}{2} \\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\} $$\n题目要求结果只用相量及其共轭表示，对此 $\\frac{1}{4}[p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})]$ 是更显式的表示形式。然而，使用实部算子的形式是标准的，我们将在第 2 部分的后续推导中使用它。\n\n### 第 2 部分：活塞的总辐射功率\n\n时间平均总辐射声功率 $\\Pi_{rad}$ 是通过对包围声源的闭合曲面 $S$ 上的时间平均声强矢量 $\\langle\\mathbf{I}\\rangle$ 的法向分量进行积分得到的。我们选择 $S$ 为远场中一个极大半径 $R$ 的半球面，覆盖半空间 $z0$，再加上平面 $z=0$。由于在 $ra$ 的障板上速度为零，并且在 $z=0$ 的半球面上的压力贡献可以忽略不计，我们只需要考虑无穷远处的半球面。\n$$ \\Pi_{rad} = \\iint_S \\langle \\mathbf{I} \\rangle \\cdot d\\mathbf{S} $$\n在远场中，声场局部表现为出射球面波。质点速度是径向的，并与压力同相（就空间依赖性而言，但不一定是复相位），通过介质的特性阻抗 $Z_0 = \\rho_0 c_0$ 相关联。\n$$ \\mathbf{v}(\\mathbf{x}) \\approx \\frac{p(\\mathbf{x})}{\\rho_0 c_0} \\hat{\\mathbf{r}} $$\n其中 $\\hat{\\mathbf{r}}$ 是径向的单位矢量。时间平均声强则是径向的：\n$$ \\langle \\mathbf{I} \\rangle = \\frac{1}{2} \\Re\\left\\{p(\\mathbf{x}) \\left(\\frac{p(\\mathbf{x})}{\\rho_0 c_0} \\hat{\\mathbf{r}}\\right)^*\\right\\} = \\frac{1}{2 \\rho_0 c_0} \\Re\\{|p(\\mathbf{x})|^2 \\hat{\\mathbf{r}}\\} = \\frac{|p(\\mathbf{x})|^2}{2 \\rho_0 c_0} \\hat{\\mathbf{r}} $$\n为了求功率，我们需要远场声压 $p(\\mathbf{x})$。对于无限大障板 ($z=0$) 中的一个平面源，在半空间 $z0$ 中的声压由 Rayleigh 积分给出：\n$$ p(\\mathbf{x}) = \\frac{i\\omega\\rho_0}{2\\pi} \\iint_{S_{source}} v_n(\\mathbf{x}') \\frac{\\exp(ik|\\mathbf{x}-\\mathbf{x}'|)}{|\\mathbf{x}-\\mathbf{x}'|} dS' $$\n这里，$v_n(\\mathbf{x}') = V_0$ 在活塞表面（半径为 $a$ 的圆盘）上，在其他地方为 0。设场点 $\\mathbf{x}$ 在球坐标中为 $(R, \\theta, \\phi)$，源点 $\\mathbf{x}'$ 在柱坐标中为 $(r', \\phi', 0)$。在远场 ($R \\gg a$) 中，我们使用以下近似：\n在分母中（振幅）$|\\mathbf{x}-\\mathbf{x}'| \\approx R$。\n在指数中（相位）$|\\mathbf{x}-\\mathbf{x}'| \\approx R - \\hat{\\mathbf{r}} \\cdot \\mathbf{x}' = R - r'\\sin\\theta\\cos(\\phi-\\phi')$。\n压力积分变为：\n$$ p(R,\\theta,\\phi) \\approx \\frac{i\\omega\\rho_0 V_0}{2\\pi} \\frac{\\exp(ikR)}{R} \\int_0^a \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) r' d\\phi' dr' $$\n关于 $\\phi'$ 的积分可以使用零阶第一类贝塞尔函数的积分表示 $J_0(Z) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(iZ\\cos\\psi)d\\psi$ 来计算。这得到：\n$$ \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) d\\phi' = 2\\pi J_0(kr'\\sin\\theta) $$\n于是声压是轴对称的（与 $\\phi$ 无关）：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\int_0^a J_0(kr'\\sin\\theta) r' dr' $$\n为计算剩余的积分，我们使用恒等式 $\\int u J_0(u) du = u J_1(u)$。令 $b=k\\sin\\theta$。\n$$ \\int_0^a r' J_0(br') dr' = \\frac{1}{b^2} \\int_0^{ba} u J_0(u) du = \\frac{1}{b^2} [u J_1(u)]_0^{ba} = \\frac{ba J_1(ba)}{b^2} = \\frac{a}{b} J_1(ba) $$\n代入 $b = k\\sin\\theta$，积分为 $\\frac{a}{k\\sin\\theta}J_1(ka\\sin\\theta)$。远场声压为：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\frac{a}{k\\sin\\theta} J_1(ka\\sin\\theta) $$\n习惯上，这可以写成活塞面积 $A = \\pi a^2$ 和指向性函数 $D(\\theta)$ 的形式：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 (\\pi a^2) \\exp(ikR)}{2\\pi R} \\left[ \\frac{2 J_1(ka\\sin\\theta)}{ka\\sin\\theta} \\right] $$\n声压的模的平方为：\n$$ |p(R,\\theta)|^2 = \\left( \\frac{\\omega\\rho_0 V_0 a}{R k\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) = \\left( \\frac{\\rho_0 c_0 V_0 a}{R \\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) $$\n其中我们使用了 $k=\\omega/c_0$。\n总辐射功率通过在远场半球面上 ($0 \\le \\theta \\le \\pi/2$, $0 \\le \\phi \\le 2\\pi$) 对强度进行积分得到。面元为 $d\\mathbf{S} = \\hat{\\mathbf{r}} R^2 \\sin\\theta d\\theta d\\phi$。\n$$ \\Pi_{rad} = \\int_0^{2\\pi} \\int_0^{\\pi/2} \\frac{|p(R,\\theta)|^2}{2\\rho_0 c_0} (R^2 \\sin\\theta) d\\theta d\\phi $$\n由于被积函数与 $\\phi$ 无关，对 $\\phi$ 的积分得到 $2\\pi$。$R^2$ 项相互抵消。\n$$ \\Pi_{rad} = \\frac{2\\pi}{2\\rho_0 c_0} \\int_0^{\\pi/2} \\left( \\frac{\\rho_0 c_0 V_0 a}{\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\frac{\\pi (\\rho_0 c_0 V_0 a)^2}{\\rho_0 c_0} \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin^2\\theta} \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\pi \\rho_0 c_0 V_0^2 a^2 \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin\\theta} d\\theta $$\n该积分是贝塞尔函数理论中的一个标准结果。对于 $x0$，恒等式为：\n$$ \\int_0^{\\pi/2} \\frac{J_1^2(x\\sin\\theta)}{\\sin\\theta} d\\theta = \\frac{1}{2} \\left[ 1 - \\frac{J_1(2x)}{x} \\right] $$\n令 $x = ka$，并假设 $V_0$ 是一个实值相量幅值，即 $|V_0|^2=V_0^2$，我们将此恒等式代入功率的表达式中：\n$$ \\Pi_{rad} = \\pi \\rho_0 c_0 V_0^2 a^2 \\left( \\frac{1}{2} \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right] \\right) $$\n这是总辐射功率的最终闭式表达式，在国际单位制中其单位为瓦特。\n\n该结果也可以用活塞的辐射阻抗 $R_m$ 来表示，其中 $\\Pi_{rad} = \\frac{1}{2}R_m V_0^2$。比较表达式可得出著名的辐射阻抗公式：$R_m = \\rho_0 c_0 (\\pi a^2) \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right]$。此处介绍的推导过程按要求通过对远场强度进行积分，从第一性原理得到了这个结果。",
            "answer": "$$ \\boxed{ \\frac{\\pi \\rho_0 c_0 a^2 V_0^2}{2} \\left( 1 - \\frac{J_1(2ka)}{ka} \\right) } $$"
        },
        {
            "introduction": "边界元法（BEM）等数值方法是计算声学中不可或缺的工具，但其代码实现的正确性必须得到验证。本练习  利用声学互易性这一基本原理，构建一个强大的数值一致性检验。你需要通过编程实现瑞利积分的数值计算，并将其与互易对应项进行比较，从而亲身体验确保计算声学软件可靠性的核心方法。",
            "id": "4114007",
            "problem": "考虑一个均匀、无损、互易的声学介质，其质量密度为常数 $\\rho_0$，声速为 $c_0$。设 $\\omega$ 表示角频率，$k$ 是由 $k = \\omega / c_0$ 定义的波数，并设 $\\mathbf{r} \\in \\mathbb{R}^3$ 表示一个场点。外部区域中的声压 $p(\\mathbf{r})$ 满足 Helmholtz 方程，并且可以通过在具有法向速度 $u_n(\\mathbf{s})$（其中 $\\mathbf{s} \\in \\mathcal{S}$）的振动边界面 $\\mathcal{S}$ 上的单层势来表示。Helmholtz 算子的自由空间格林函数是满足互易性的基本解，即对于所有不同的 $\\mathbf{r},\\mathbf{r}'$，有 $G(\\mathbf{r},\\mathbf{r}') = G(\\mathbf{r}',\\mathbf{r})$。\n\n在边界元法（BEM, Boundary Element Method）的配置框架中，表面 $\\mathcal{S}$被离散为一组有限的边界单元，其质心作为配置点。场在面外的测试点进行采样。对于这种离散化，可以通过交换配置点和测试点的角色来构建一个基于互易性的一致性检验。具体方法是比较两个传递函数：一个将所选边界单元上的单位法向速度振幅映射到所选测试点产生的压力；反之，另一个被解释为在测试点放置一个等效点源（其源强度的选择应保持单层势算子所引发的物理共轭配对），在该点源作用下所选配置点处的压力。\n\n从基本定律和核心定义（即互易介质中的线性声学、Helmholtz 方程和格林函数对称性）出发，推导出一个离散传递函数求值方法，以实现以下测试。设振动表面为 $z = 0$ 平面内的一个矩形平面障板，其中心在原点，法线与 $+z$ 轴对齐。考虑一个以原点为中心的单个矩形边界单元（一个面元），其宽度为 $W$，高度为 $H$，因此其面积为 $A = W H$。设一个场（测试）点位于 $\\mathbf{r}_f = (x_f,y_f,z_f)$，其中 $z_f  0$，并设边界单元的配置点为其质心 $\\mathbf{r}_c = (0,0,0)$。假设在整个面元上存在均匀的法向速度，其大小为 $u_0$，单位为 $\\mathrm{m/s}$。\n\n定义以下两个复值传递函数求值：\n- 正向传递：从边界单元到场点，定义为在面元上均匀法向速度 $u_0$ 在 $\\mathbf{r}_f$ 处引起的压力，通过在面元面积上使用求积法则对单层势进行数值积分来计算。\n- 交换传递：从场点到配置点，定义为位于 $\\mathbf{r}_f$ 的一个等效单极子点源在 $\\mathbf{r}_c$ 处产生的压力，该点源的源强度 $Q$ 的选择应使得在交换角色后，单层势算子所蕴含的法向速度与压力之间的共轭配对关系得以保持。用此来定义 $Q$ 与 $\\rho_0$、$\\omega$、 $u_0$ 和 $A$ 的关系。\n\n实现一个程序，针对下面指定的一组测试用例，计算正向传递和交换传递，并报告无量纲的互易性一致性误差\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}.\n$$\n您的正向传递数值积分必须在矩形面元上使用张量积 Gauss–Legendre 求积法。格林函数必须是三维自由空间 Helmholtz 格林函数。所有物理量必须采用国际单位制（SI 单位），其中 $c_0$ 的单位为 $\\mathrm{m/s}$，$\\rho_0$ 的单位为 $\\mathrm{kg/m^3}$，频率 $f$ 的单位为 $\\mathrm{Hz}$，几何尺寸的单位为 $\\mathrm{m}$。\n\n测试用例规范：\n- 对所有测试，使用 $\\rho_0 = 1.225$（单位 $\\mathrm{kg/m^3}$），$c_0 = 343$（单位 $\\mathrm{m/s}$）和 $u_0 = 1$（单位 $\\mathrm{m/s}$）。设 $\\omega = 2\\pi f$ 和 $k = \\omega / c_0$。\n- 用例1（正常路径）：$f = 1000$（单位 $\\mathrm{Hz}$），$W = 0.05$（单位 $\\mathrm{m}$），$H = 0.05$（单位 $\\mathrm{m}$），$\\mathbf{r}_f = (0,0,0.5)$（单位 $\\mathrm{m}$），求积阶数 $N_x = 12$，$N_y = 12$。\n- 用例2（近场）：$f = 1000$（单位 $\\mathrm{Hz}$），$W = 0.10$（单位 $\\mathrm{m}$），$H = 0.10$（单位 $\\mathrm{m}$），$\\mathbf{r}_f = (0,0,0.05)$（单位 $\\mathrm{m}$），求积阶数 $N_x = 48$，$N_y = 48$。\n- 用例3（高频）：$f = 5000$（单位 $\\mathrm{Hz}$），$W = 0.05$（单位 $\\mathrm{m}$），$H = 0.05$（单位 $\\mathrm{m}$），$\\mathbf{r}_f = (0,0,1.0)$（单位 $\\mathrm{m}$），求积阶数 $N_x = 24$，$N_y = 24$。\n- 用例4（离轴场点）：$f = 1500$（单位 $\\mathrm{Hz}$），$W = 0.07$（单位 $\\mathrm{m}$），$H = 0.05$（单位 $\\mathrm{m}$），$\\mathbf{r}_f = (0.02,-0.015,0.3)$（单位 $\\mathrm{m}$），求积阶数 $N_x = 24$，$N_y = 24$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$,$\\text{result4}$]\"），其中每个 $\\text{result}$ 是相应测试用例的 $\\varepsilon$ 的浮点数值，表示为无单位的小数。程序必须是自包含的，不得读取输入，也不得访问任何外部资源。",
            "solution": "该问题的基础是在均匀、无损、互易介质中的时谐声场。对于时间依赖性为 $e^{-i\\omega t}$ 的声压 $p(\\mathbf{r})$，由 Helmholtz 方程决定：\n$$\n(\\nabla^2 + k^2) p(\\mathbf{r}) = 0\n$$\n其中 $\\omega$ 是角频率，$k = \\omega / c_0$ 是波数，$c_0$ 是声速，$\\mathbf{r}$ 是场中的一个点。\n\n对于无限大刚性障板中的振动平面（“平面障板”所隐含的条件），在半空间 $z  0$ 内的压力由 Rayleigh 积分给出：\n$$\np(\\mathbf{r}) = \\frac{i\\omega\\rho_0}{2\\pi} \\int_{\\mathcal{S}} u_n(\\mathbf{s}) \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|} dS(\\mathbf{s})\n$$\n其中 $\\rho_0$ 是介质密度，$u_n(\\mathbf{s})$ 是在位置 $\\mathbf{s} \\in \\mathcal{S}$ 处面元 $dS$ 上的法向速度，而项 $G_R(\\mathbf{r},\\mathbf{s}) = \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|}$ 是积分的核。这种积分形式是障板表面的单层势的一种特定形式。该公式固有地依赖于自由空间格林函数（加倍以考虑障板），并且源密度被确定为与法向速度成正比，即 $\\sigma(\\mathbf{s}) \\propto i\\omega\\rho_0 u_n(\\mathbf{s})$。\n\n该问题需要计算和比较两个传递函数。\n\n**1. 正向传递 ($p_{\\text{forward}}$)**\n\n正向传递定义为由振动面元在场点 $\\mathbf{r}_f = (x_f, y_f, z_f)$ 处产生的压力 $p_{\\text{forward}}$。该面元是一个宽度为 $W$、高度为 $H$ 的矩形 $\\mathcal{S}$，位于 $z=0$ 平面内且以原点为中心，因此 $\\mathcal{S} = [-W/2, W/2] \\times [-H/2, H/2] \\times \\{0\\}$。法向速度是均匀的，$u_n(\\mathbf{s}) = u_0$。\n\n将这些代入 Rayleigh 积分，我们得到：\n$$\np_{\\text{forward}} = p(\\mathbf{r}_f) = \\frac{i\\omega\\rho_0 u_0}{2\\pi} \\int_{-W/2}^{W/2} \\int_{-H/2}^{H/2} \\frac{e^{ik\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}}}{\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}} dx dy\n$$\n该积分使用张量积 Gauss-Legendre 求积法进行数值计算。我们进行变量替换，将积分域从 $[ -W/2, W/2 ] \\times [ -H/2, H/2 ]$ 映射到标准正方形 $[-1, 1] \\times [-1, 1]$。令 $x = (W/2)\\xi$ 和 $y = (H/2)\\eta$。微分面积元变为 $dx dy = (WH/4) d\\xi d\\eta = (A/4) d\\xi d\\eta$，其中 $A=WH$ 是面元的面积。积分变为：\n$$\np_{\\text{forward}} = \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{e^{ik R(\\xi, \\eta)}}{R(\\xi, \\eta)} d\\xi d\\eta\n$$\n其中 $R(\\xi, \\eta) = \\sqrt{(x_f - \\frac{W}{2}\\xi)^2 + (y_f - \\frac{H}{2}\\eta)^2 + z_f^2}$。应用具有 $N_x \\times N_y$ 个点、节点为 $\\{\\xi_i, \\eta_j\\}$、权重为 $\\{w_i, w_j\\}$ 的求积法则，得到离散近似：\n$$\np_{\\text{forward}} \\approx \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} w_i w_j \\frac{e^{ik R_{ij}}}{R_{ij}}\n$$\n其中 $R_{ij} = \\sqrt{(x_f - \\frac{W}{2}\\xi_i)^2 + (y_f - \\frac{H}{2}\\eta_j)^2 + z_f^2}$。\n\n**2. 交换传递 ($p_{\\text{swapped}}$)**\n\n交换传递 $p_{\\text{swapped}}$ 是位于场点 $\\mathbf{r}_f$ 的一个强度为 $Q$ 的等效单极子点源在面元的配置点（其质心 $\\mathbf{r}_c = (0,0,0)$）处产生的压力。\n\n在障板环境中，位于 $\\mathbf{r}_f$ 的一个体积速度强度为 $Q$（单位 $\\mathrm{m^3/s}$）的单极子点源产生的声压场由下式给出：\n$$\np_{\\text{source}}(\\mathbf{r}) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}_f|}}{|\\mathbf{r}-\\mathbf{r}_f|}\n$$\n在配置点 $\\mathbf{r}_c$ 处计算该式，得到交换压力：\n$$\np_{\\text{swapped}} = p_{\\text{source}}(\\mathbf{r}_c) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{|\\mathbf{r}_c-\\mathbf{r}_f|}\n$$\n源强度 $Q$ 的定义必须保持物理配对关系。体现在格林函数对称性中的互易性原理提供了这种联系。由面元 $\\mathcal{S}$ 上的分布源 $\\sigma(\\mathbf{s}) = i\\omega\\rho_0 u_n(\\mathbf{s})$ 在 $\\mathbf{r}_f$ 处产生的压力为：\n$$\np_{\\text{forward}} = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{r}_f, \\mathbf{s}) dS(\\mathbf{s}) = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s})\n$$\n其中 $G_{\\text{baffled}}(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}'|}}{2\\pi|\\mathbf{r}-\\mathbf{r}'|}$。在配置 BEM 中的一个关键近似是，假设一个乘积的积分可以通过在配置点 $\\mathbf{r}_c$ 处计算核的光滑部分来近似：\n$$\n\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s}) \\approx G_{\\text{baffled}}(\\mathbf{r}_c, \\mathbf{r}_f) \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS(\\mathbf{s})\n$$\n该近似的右侧是表达交换传递的另一种方式。面元上的总源强度为 $\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS = \\int_{\\mathcal{S}} i\\omega\\rho_0 u_0 dS = i\\omega\\rho_0 u_0 A$。因此，交换压力为：\n$$\np_{\\text{swapped}} = \\left( \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{2\\pi|\\mathbf{r}_c-\\mathbf{r}_f|} \\right) (i\\omega\\rho_0 u_0 A)\n$$\n通过将其与单极子源压力方程进行比较，我们看到 $i\\omega\\rho_0 Q$ 必须等效于总源强度 $i\\omega\\rho_0 u_0 A$。这引出了等效源强度的定义：\n$$\nQ = u_0 A\n$$\n这在物理上是直观的：等效点源的体积速度等于振动面元的总体积速度。由此，交换压力的最终表达式为：\n$$\np_{\\text{swapped}} = \\frac{i\\omega\\rho_0 (u_0 A)}{2\\pi} \\frac{e^{ik|\\mathbf{r}_f|}}{|\\mathbf{r}_f|}\n$$\n因为 $\\mathbf{r}_c$ 是原点。\n\n**3. 互易性一致性误差 ($\\varepsilon$)**\n\n无量纲误差 $\\varepsilon$ 量化了正向传递的精确积分与用于推导交换传递的单点配置近似之间的差异。它衡量了在此相互作用中，面元能被其质心代表的程度。\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}\n$$\n数值实现将通过求积法计算 $p_{\\text{forward}}$，通过其解析公式计算 $p_{\\text{swapped}}$，然后为每个测试用例计算 $\\varepsilon$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Computes the reciprocity consistency error for a set of acoustic radiation problems.\n    \"\"\"\n    RHO_0 = 1.225  # kg/m^3\n    C_0 = 343.0    # m/s\n    U_0 = 1.0      # m/s\n\n    test_cases = [\n        # Case 1: happy path\n        {'f': 1000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 0.5), 'Nx': 12, 'Ny': 12},\n        # Case 2: near field\n        {'f': 1000.0, 'W': 0.10, 'H': 0.10, 'rf': (0.0, 0.0, 0.05), 'Nx': 48, 'Ny': 48},\n        # Case 3: high frequency\n        {'f': 5000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 1.0), 'Nx': 24, 'Ny': 24},\n        # Case 4: off-axis field point\n        {'f': 1500.0, 'W': 0.07, 'H': 0.05, 'rf': (0.02, -0.015, 0.3), 'Nx': 24, 'Ny': 24},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        f = case['f']\n        W = case['W']\n        H = case['H']\n        xf, yf, zf = case['rf']\n        Nx = case['Nx']\n        Ny = case['Ny']\n\n        # Derived physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / C_0\n        A = W * H\n\n        # --- 1. Forward Transfer Calculation (p_forward) ---\n        # Get Gauss-Legendre quadrature nodes and weights for the interval [-1, 1]\n        xi_nodes, xi_weights = leggauss(Nx)\n        eta_nodes, eta_weights = leggauss(Ny)\n\n        # Create meshgrid for vectorized calculation\n        xi_grid, eta_grid = np.meshgrid(xi_nodes, eta_nodes)\n        wi_grid, wj_grid = np.meshgrid(xi_weights, eta_weights)\n\n        # Map quadrature points to physical coordinates on the patch\n        xs = (W / 2.0) * xi_grid\n        ys = (H / 2.0) * eta_grid\n\n        # Calculate distance from each source point on the patch to the field point\n        R = np.sqrt((xf - xs)**2 + (yf - ys)**2 + zf**2)\n\n        # Calculate the integrand of the Rayleigh integral\n        integrand = np.exp(1j * k * R) / R\n\n        # Perform the numerical integration\n        integral_sum = np.sum(wi_grid * wj_grid * integrand)\n        \n        # The Rayleigh integral for a baffled source is (i*omega*rho/ (2*pi)) * Integral(...)\n        # The change of variables for quadrature introduces a Jacobian of (W/2)*(H/2) = A/4\n        # We combine these factors.\n        p_forward = (1j * omega * RHO_0 * U_0 / (2.0 * np.pi)) * integral_sum * (A / 4.0)\n\n        # --- 2. Swapped Transfer Calculation (p_swapped) ---\n        # The collocation point is the origin\n        rc = np.array([0.0, 0.0, 0.0])\n        rf_vec = np.array([xf, yf, zf])\n\n        # Distance from collocation point to field point\n        R_cf = np.linalg.norm(rf_vec - rc)\n        \n        # Equivalent monopole source strength\n        Q = U_0 * A\n\n        # Calculate the pressure at rc from the point source at rf for a baffled condition\n        if R_cf == 0:\n            p_swapped = np.inf\n        else:\n            p_swapped = (1j * omega * RHO_0 * Q / (2.0 * np.pi)) * (np.exp(1j * k * R_cf) / R_cf)\n\n        # --- 3. Reciprocity Consistency Error (epsilon) ---\n        if np.abs(p_forward) == 0:\n            error = np.inf if np.abs(p_forward - p_swapped) > 0 else 0.0\n        else:\n            error = np.abs(p_forward - p_swapped) / np.abs(p_forward)\n        \n        results.append(error)\n\n    # Format the final output\n    formatted_results = [f\"{res:.10e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}