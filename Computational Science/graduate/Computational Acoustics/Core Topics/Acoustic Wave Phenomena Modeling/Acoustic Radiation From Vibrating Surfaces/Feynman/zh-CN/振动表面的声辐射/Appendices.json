{
    "hands_on_practices": [
        {
            "introduction": "在分析声辐射之前，我们必须首先在数学上定义什么构成了一个从声源向外传播的波。这个练习挑战你使用第一性原理，比如能量流，来确定出射球面波（其形式为$\\frac{\\exp(\\pm i k r)}{r}$）的正确数学形式，这是所有辐射问题的基石。",
            "id": "4113997",
            "problem": "一个由紧凑的、球对称的振动表面辐射到平衡密度为$\\rho_{0}$、声速为$c$的无界静止流体中的时谐声场，在外域满足标量亥姆霍兹方程$\\nabla^{2} p + k^{2} p = 0$，其时间依赖关系为$e^{-i \\omega t}$，波数为$k = \\omega/c  0$。在远场，当$r$很大时，球面解的行为如同$p(r) \\sim \\dfrac{A_{\\pm}\\,e^{\\pm i k r}}{r}$，其中$A_{\\pm}$是复振幅，$r$是径向坐标。\n\n仅使用适用于线性声学的第一性原理（例如，线性化动量平衡和时间平均声强的定义），确定对于所选的时间约定$e^{-i \\omega t}$，$e^{\\pm i k r}/r$中的哪个符号对应于物理上辐射的出射波。你的推理必须明确使用远场能通量的方向或无穷远处的等效辐射条件，并且必须与$k=\\omega/c0$一致。\n\n哪个选项是正确的？\n\nA. 对于$e^{-i \\omega t}$，物理上的出射波是$e^{+ i k r}/r$（而$e^{- i k r}/r$是入射波）。\n\nB. 对于$e^{-i \\omega t}$，物理上的出射波是$e^{- i k r}/r$（而$e^{+ i k r}/r$是入射波）。\n\nC. $e^{+ i k r}/r$和$e^{- i k r}/r$都描述了远场中的出射辐射；如果$\\omega0$，符号的选择是任意的。\n\nD. 如果没有额外的材料参数，符号无法确定；如果$k0$，则$e^{- i k r}/r$是出射波，而如果$k0$，则$e^{+ i k r}/r$是出射波。",
            "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **控制方程：** 时谐声压场$p$满足标量亥姆霍兹方程$\\nabla^{2} p + k^{2} p = 0$。\n- **源/域：** 声场由一个紧凑的、球对称的振动表面辐射到外域中的无界静止流体中。\n- **流体属性：** 流体的平衡密度为$\\rho_{0}$，声速为$c$。\n- **时间约定：** 时间依赖关系为$e^{-i \\omega t}$。\n- **波数：** 波数为$k = \\omega/c  0$。\n- **远场行为：** 当径向距离$r \\to \\infty$时，压力的行为如同$p(r) \\sim \\dfrac{A_{\\pm}\\,e^{\\pm i k r}}{r}$，其中$A_{\\pm}$是复振幅。\n- **任务：** 确定指数中的哪个符号$\\pm$对应于物理上辐射的出射波。\n- **方法论约束：** 确定过程必须使用第一性原理，明确考虑远场能通量（时间平均声强）的方向或等效的辐射条件，并且必须与给定的时间约定和$k0$一致。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题在根本上是合理的。它描述了物理声学中的一个典型问题：确定出射球面波的形式。亥姆霍兹方程、假定的时间依赖关系、远场渐近形式以及声强和辐射条件的概念都是波理论和声学中标准且成熟的原理。\n- **适定性：** 该问题是适定的。它提供了一个特定的时间约定($e^{-i \\omega t}$)和一个物理标准（出射能通量），这两者共同唯一地确定了出射波的正确数学形式。\n- **客观性：** 问题以精确、客观和定量的术语陈述。没有主观或模糊的陈述。\n- **完备性与一致性：** 提供了所有必要的信息。给出了时间约定、控制方程、介质的物理属性以及潜在解的数学形式。没有内部矛盾。例如，条件$k=\\omega/c  0$与频率$\\omega$和声速$c$为正的标准物理假设是一致的。\n\n**第三步：结论与行动**\n- **结论：** 问题是有效的、科学上合理的、且适定的。\n- **行动：** 继续推导解答。\n\n**推导**\n\n由声源产生的辐射波的物理要求是，远场中的净能量流必须指向远离声源的方向。描述单位面积能量流动的速率和方向的量是声强。对于时谐场，我们考虑时间平均声强$\\langle \\mathbf{I} \\rangle$。\n\n1.  **压力与速度之间的关系：** 流体的线性化动量方程是欧拉方程：\n    $$ \\rho_0 \\frac{\\partial \\mathbf{v}(\\mathbf{x}, t)}{\\partial t} = -\\nabla P(\\mathbf{x}, t) $$\n    其中$P(\\mathbf{x}, t)$是瞬时声压，$\\mathbf{v}(\\mathbf{x}, t)$是瞬时流体质点速度。问题指定了时间依赖关系为$e^{-i \\omega t}$。物理量是其复相量表示的实部：\n    $$ P(\\mathbf{x}, t) = \\text{Re}[p(\\mathbf{x}) e^{-i \\omega t}] $$\n    $$ \\mathbf{v}(\\mathbf{x}, t) = \\text{Re}[\\mathbf{u}(\\mathbf{x}) e^{-i \\omega t}] $$\n    将这些代入动量方程得到：\n    $$ \\text{Re}[\\rho_0 (-i \\omega) \\mathbf{u}(\\mathbf{x}) e^{-i \\omega t}] = \\text{Re}[-\\nabla p(\\mathbf{x}) e^{-i \\omega t}] $$\n    这隐含了复振幅（相量）$p$和$\\mathbf{u}$之间的关系：\n    $$ -i \\omega \\rho_0 \\mathbf{u} = -\\nabla p $$\n    $$ \\mathbf{u} = \\frac{1}{i \\omega \\rho_0} \\nabla p $$\n\n2.  **时间平均声强：** 瞬时强度为$\\mathbf{I}(t) = P(t) \\mathbf{v}(t)$。在一个周期$T = 2\\pi/\\omega$内的时间平均值由两个谐波变化量乘积的标准公式给出：\n    $$ \\langle \\mathbf{I} \\rangle = \\frac{1}{2} \\text{Re}[p \\mathbf{u}^*] $$\n    其中$\\mathbf{u}^*$是$\\mathbf{u}$的复共轭。\n\n3.  **远场分析：** 问题陈述在远场中，压力的行为如同$p(r) \\sim \\dfrac{A_{\\pm} e^{\\pm i k r}}{r}$。由于辐射是球对称的，我们关心的是强度的径向分量。我们首先需要速度的径向分量，这需要压力梯度的径向分量。在球坐标中，对于一个只依赖于$r$的函数，有$\\nabla p = \\hat{\\mathbf{r}} \\frac{dp}{dr}$。\n    $$ \\frac{dp}{dr} = \\frac{d}{dr} \\left( \\frac{A_{\\pm} e^{\\pm i k r}}{r} \\right) = A_{\\pm} \\left( \\frac{\\pm i k e^{\\pm i k r}}{r} - \\frac{e^{\\pm i k r}}{r^2} \\right) = \\left( \\pm i k - \\frac{1}{r} \\right) \\frac{A_{\\pm} e^{\\pm i k r}}{r} = \\left( \\pm i k - \\frac{1}{r} \\right) p(r) $$\n    在远场，当$r \\to \\infty$时，项$1/r$与常数$k$相比变得可以忽略不计。因此，我们有以下渐近关系：\n    $$ \\frac{dp}{dr} \\sim (\\pm i k) p(r) $$\n\n4.  **远场速度与强度：** 将此代入速度相量$\\mathbf{u}$的表达式中：\n    $$ \\mathbf{u} \\sim \\hat{\\mathbf{r}} \\frac{1}{i \\omega \\rho_0} (\\pm i k) p = \\hat{\\mathbf{r}} \\frac{\\pm k}{\\omega \\rho_0} p $$\n    使用给定的关系$k = \\omega/c$，这可以简化为：\n    $$ \\mathbf{u} \\sim \\hat{\\mathbf{r}} \\frac{\\pm (\\omega/c)}{\\omega \\rho_0} p = \\hat{\\mathbf{r}} \\frac{\\pm 1}{\\rho_0 c} p $$\n    现在我们可以计算时间平均径向强度$\\langle I_r \\rangle$：\n    $$ \\langle I_r \\rangle = \\frac{1}{2} \\text{Re}[p u_r^*] \\sim \\frac{1}{2} \\text{Re}\\left[p \\left(\\frac{\\pm 1}{\\rho_0 c} p\\right)^*\\right] $$\n    由于$\\rho_0$和$c$是实数、正的物理常数：\n    $$ \\langle I_r \\rangle \\sim \\frac{1}{2} \\text{Re}\\left[p \\frac{\\pm 1}{\\rho_0 c} p^*\\right] = \\frac{\\pm 1}{2 \\rho_0 c} \\text{Re}[p p^*] $$\n    对于任何复数$z$，$z z^* = |z|^2$，它是实数且非负。因此，$p p^* = |p|^2$。\n    $$ \\langle I_r \\rangle \\sim \\frac{\\pm 1}{2 \\rho_0 c} |p|^2 $$\n\n5.  **出射波的物理条件：** 对于出射波，能量必须从位于原点的声源向外流动。这意味着径向强度必须为正，即$\\langle I_r \\rangle  0$。由于$|p|^2$、$2$、$\\rho_0$和$c$都是正的，$\\langle I_r \\rangle$的符号由$\\pm$符号决定。为了使$\\langle I_r \\rangle  0$，我们必须选择“+”号。\n    这个“+”号可以追溯到压力形式$p \\sim \\dfrac{A_+ e^{+ikr}}{r}$。\n\n作为二次检查，我们可以检验相位的传播。完整的复波与$e^{\\pm ikr} e^{-i\\omega t}$成正比。\n- 对于“+”号：$e^{+ikr} e^{-i\\omega t} = e^{i(kr - \\omega t)}$。等相面由$kr - \\omega t = \\text{常数}$定义。对时间求导得到$k \\frac{dr}{dt} - \\omega = 0$，所以相速度为$\\frac{dr}{dt} = \\frac{\\omega}{k} = c$。由于$c  0$，波在$r$增大的方向上传播（出射）。\n- 对于“-”号：$e^{-ikr} e^{-i\\omega t} = e^{-i(kr + \\omega t)}$。等相面由$kr + \\omega t = \\text{常数}$定义。求导得到$k \\frac{dr}{dt} + \\omega = 0$，所以相速度为$\\frac{dr}{dt} = -\\frac{\\omega}{k} = -c$。波在$r$减小的方向上传播（入射）。\n\n两种方法都证实，对于时间约定$e^{-i \\omega t}$，项$e^{+ikr}/r$代表物理上辐射的出射波。\n\n**逐项分析选项**\n\n**A. 对于$e^{-i \\omega t}$，物理上的出射波是$e^{+ i k r}/r$（而$e^{- i k r}/r$是入射波）。**\n这个陈述与我们的推导一致。对于给定的时间约定$e^{-i\\omega t}$和$k0$，向外的能量通量（正的时间平均强度）要求唯一地选择了$e^{+ikr}/r$作为出射波的形式。形式$e^{-ikr}/r$产生向内的能量通量，代表入射波。\n**结论：正确。**\n\n**B. 对于$e^{-i \\omega t}$，物理上的出射波是$e^{- i k r}/r$（而$e^{+ i k r}/r$是入射波）。**\n这个陈述与推导出的结果相反。对于备选的时间约定$e^{+i\\omega t}$，它将是正确的，但问题明确指定了$e^{-i \\omega t}$。\n**结论：不正确。**\n\n**C. $e^{+ i k r}/r$和$e^{- i k r}/r$都描述了远场中的出射辐射；如果$\\omega0$，符号的选择是任意的。**\n这个陈述在物理上是不正确的。符号的选择不是任意的；它由能量传播的物理学决定。一个符号对应于出射能量通量，另一个对应于入射能量通量。辐射源必须产生能量的净流出。\n**结论：不正确。**\n\n**D. 如果没有额外的材料参数，符号无法确定；如果$k0$，则$e^{- i k r}/r$是出射波，而如果$k0$，则$e^{+ i k r}/r$是出射波。**\n第一个从句是错误的；符号由时间约定和能量流动的方向决定，使用给定的参数即可。第二个从句的第一部分，“如果$k>0$则$e^{-ikr}/r$是出射波”，对于给定的时间约定是错误的，如推导所示。$k0$的情况被问题陈述$k=\\omega/c  0$所排除。因此，这个选项有根本性的缺陷。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "建立了出射波的概念后，声学中的一个核心目标是量化一个源辐射的总能量。这项练习将引导你完成一个完整的推导过程，从声强的基本定义出发，计算由振动圆形活塞（声学中最基本的模型之一）辐射的总功率。",
            "id": "4114020",
            "problem": "一种质量密度为$\\rho_{0}$、声速为$c_{0}$的无粘性可压缩流体中，存在角频率为$\\omega$的小振幅时谐声场。设声压场和质点速度场分别由其实时值瞬时形式$p(\\mathbf{x},t)$和$\\mathbf{v}(\\mathbf{x},t)$表示，并由其复数相量$p(\\mathbf{x})$和$\\mathbf{v}(\\mathbf{x})$表示，遵循惯例$p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x})\\exp(-i \\omega t)\\}$和$\\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x})\\exp(-i \\omega t)\\}$。\n\n1) 从时域中的线性声学动量方程和连续性方程，以及瞬时声强度$\\mathbf{I}(t) = p(\\mathbf{x},t)\\,\\mathbf{v}(\\mathbf{x},t)$的定义出发，从第一性原理推导时间平均声强度矢量$\\langle \\mathbf{I} \\rangle$的表达式，该表达式用复数相量$p(\\mathbf{x})$和$\\mathbf{v}(\\mathbf{x})$表示。请仅用$p(\\mathbf{x})$、$\\mathbf{v}(\\mathbf{x})$及其复共轭来表示你的结果。\n\n2) 一个刚性无限大平面障板占据$z=0$平面。一个半径为$a$的圆形活塞嵌入障板中，以原点为中心，沿$+z$方向以空间均匀的法向速度相量$V_{0}$振动，即对于$\\sqrt{x^{2}+y^{2}} \\le a$和$z=0$时，$\\mathbf{v}(\\mathbf{x}) \\cdot \\hat{\\mathbf{z}} = V_{0}$，而在障板的其他地方法向速度为零。流体占据$z0$的半空间。使用亥姆霍兹方程的自由空间格林函数的Kirchhoff–Helmholtz表示，通过在声学远场的控制面上对时间平均强度的外法向分量进行积分，推导出进入$z0$半空间的时间平均总辐射声功率。你的推导必须从基本场方程和第(1)部分的结果开始，并且不得引用$ka$的任何小宗量或大宗量近似，其中$k = \\omega/c_{0}$是声波数。请用$\\rho_{0}$、 $c_{0}$、 $a$、 $k$、 $V_{0}$和第一类贝塞尔函数$J_{1}(\\cdot)$来表示你的最终闭合形式答案。\n\n以瓦特(Watts)为单位表示最终总辐射功率。最终答案必须是单一的闭合形式解析表达式。不需要进行数值计算。",
            "solution": "此问题的分析按要求分为两部分进行。第(1)部分要求从第一性原理推导时间平均声强度。第(2)部分应用此结果来计算无限大障板中的振动圆形活塞所辐射的总声功率。\n\n### 第1部分：时间平均声强度的推导\n\n该问题处于无粘性可压缩流体的线性声学背景下。控制方程是线性化的连续性方程和动量方程。\n连续性方程是：\n$$ \\frac{\\partial \\rho'(\\mathbf{x},t)}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{v}(\\mathbf{x},t) = 0 $$\n其中$\\rho'$是声学密度扰动。动量方程是：\n$$ \\rho_0 \\frac{\\partial \\mathbf{v}(\\mathbf{x},t)}{\\partial t} = -\\nabla p(\\mathbf{x},t) $$\n这些方程建立了声压$p(\\mathbf{x},t)$和质点速度$\\mathbf{v}(\\mathbf{x},t)$之间的物理关系。瞬时声强度矢量$\\mathbf{I}(\\mathbf{x},t)$被定义为单位面积的能量流率，由瞬时压力和质点速度的乘积给出：\n$$ \\mathbf{I}(\\mathbf{x},t) = p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) $$\n该问题考虑角频率为$\\omega$的时谐场。实时值瞬时场通过以下惯例与其复数值相量$p(\\mathbf{x})$和$\\mathbf{v}(\\mathbf{x})$相关联：\n$$ p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\n其中$\\Re\\{Z\\}$表示复数$Z$的实部。\n\n为了求得时间平均声强度$\\langle \\mathbf{I} \\rangle$，我们在一个振荡周期$T = 2\\pi/\\omega$内对$\\mathbf{I}(\\mathbf{x},t)$进行平均。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{T} \\int_0^T \\mathbf{I}(\\mathbf{x},t) dt = \\frac{1}{T} \\int_0^T p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) dt $$\n我们用复数相量及其复共轭（用上标星号$*$表示）来表示实时值场。对于任何复数量$Z$，其实部为$\\Re\\{Z\\} = \\frac{1}{2}(Z + Z^*)$。\n将此应用于压力和速度相量：\n$$ p(\\mathbf{x},t) = \\frac{1}{2} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\frac{1}{2} [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n将这些表达式代入瞬时强度的定义中：\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n展开乘积得到四项：\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) \\exp(-2i \\omega t) + p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) \\exp(2i \\omega t)] $$\n现在，我们对一个周期$T$进行时间平均。含时项涉及复指数的积分：\n$$ \\frac{1}{T} \\int_0^T \\exp(\\pm 2i \\omega t) dt = \\frac{1}{T} \\left[ \\frac{\\exp(\\pm 2i \\omega t)}{\\pm 2i \\omega} \\right]_0^T = \\frac{1}{T} \\frac{\\exp(\\pm 2i \\omega T) - 1}{\\pm 2i \\omega} $$\n由于$T=2\\pi/\\omega$，我们有$\\exp(\\pm 2i \\omega T) = \\exp(\\pm i 4\\pi) = 1$。因此，含时项的积分为零。剩下的两项与时间无关，因此它们的平均值就是它们本身的值。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})] $$\n这个表达式也可以用实部算子来写。由于$p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) = (p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}))^*$，方括号中的和是一个复数加上其共轭，等于其实部的两倍。\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [2\\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\}] = \\frac{1}{2} \\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\} $$\n题目要求结果仅用相量及其共轭表示，对此，形式$\\frac{1}{4}[p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})]$是更明确的表示。然而，使用实部算子的形式是标准的，我们将在第2部分的后续推导中使用它。\n\n### 第2部分：活塞的总辐射功率\n\n时间平均总辐射声功率$\\Pi_{rad}$，是通过在包围声源的封闭曲面$S$上对时间平均声强度矢量$\\langle\\mathbf{I}\\rangle$的法向分量进行积分来求得的。我们选择$S$为一个在远场中半径非常大的半球面，覆盖$z>0$的半空间，再加上$z=0$平面。由于在障板上当$r>a$时速度为零，并且可以忽略来自$z=0$处活塞表面的压力贡献，我们只需要考虑无穷远处的半球面。\n$$ \\Pi_{rad} = \\iint_S \\langle \\mathbf{I} \\rangle \\cdot d\\mathbf{S} $$\n在远场中，声场局部表现为向外传播的球面波。质点速度是径向的，并与压力成比例，通过介质的特征阻抗$Z_0 = \\rho_0 c_0$相互关联。\n$$ \\mathbf{v}(\\mathbf{x}) \\approx \\frac{p(\\mathbf{x})}{\\rho_0 c_0} \\hat{\\mathbf{r}} $$\n其中$\\hat{\\mathbf{r}}$是径向的单位矢量。时间平均强度于是呈径向：\n$$ \\langle \\mathbf{I} \\rangle = \\frac{1}{2} \\Re\\left\\{p(\\mathbf{x}) \\left(\\frac{p(\\mathbf{x})}{\\rho_0 c_0} \\hat{\\mathbf{r}}\\right)^*\\right\\} = \\frac{1}{2 \\rho_0 c_0} \\Re\\{|p(\\mathbf{x})|^2 \\hat{\\mathbf{r}}\\} = \\frac{|p(\\mathbf{x})|^2}{2 \\rho_0 c_0} \\hat{\\mathbf{r}} $$\n为了求得功率，我们需要远场压力$p(\\mathbf{x})$。对于无限大障板($z=0$)中的平面声源，在$z>0$半空间中的压力由瑞利积分给出：\n$$ p(\\mathbf{x}) = \\frac{i\\omega\\rho_0}{2\\pi} \\iint_{S_{source}} v_n(\\mathbf{x}') \\frac{\\exp(ik|\\mathbf{x}-\\mathbf{x}'|)}{|\\mathbf{x}-\\mathbf{x}'|} dS' $$\n这里，$v_n(\\mathbf{x}')$在活塞表面（半径为$a$的圆盘）上等于$V_0$，在其他地方为0。设场点$\\mathbf{x}$在球坐标中为$(R, \\theta, \\phi)$，源点$\\mathbf{x}'$在柱坐标中为$(r', \\phi', 0)$。在远场($R \\gg a$)中，我们使用近似：\n分母中（振幅）$|\\mathbf{x}-\\mathbf{x}'| \\approx R$。\n指数中（相位）$|\\mathbf{x}-\\mathbf{x}'| \\approx R - \\hat{\\mathbf{r}} \\cdot \\mathbf{x}' = R - r'\\sin\\theta\\cos(\\phi-\\phi')$。\n压力积分变为：\n$$ p(R,\\theta,\\phi) \\approx \\frac{i\\omega\\rho_0 V_0}{2\\pi} \\frac{\\exp(ikR)}{R} \\int_0^a \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) r' d\\phi' dr' $$\n关于$\\phi'$的积分可以使用零阶第一类贝塞尔函数的积分表示$J_0(Z) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(iZ\\cos\\psi)d\\psi$来计算。这给出：\n$$ \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) d\\phi' = 2\\pi J_0(kr'\\sin\\theta) $$\n压力随后是轴对称的（与$\\phi$无关）：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\int_0^a J_0(kr'\\sin\\theta) r' dr' $$\n为了计算剩余的积分，我们使用恒等式$\\int u J_0(u) du = u J_1(u)$。令$b=k\\sin\\theta$。\n$$ \\int_0^a r' J_0(br') dr' = \\frac{1}{b^2} \\int_0^{ba} u J_0(u) du = \\frac{1}{b^2} [u J_1(u)]_0^{ba} = \\frac{ba J_1(ba)}{b^2} = \\frac{a}{b} J_1(ba) $$\n代入$b = k\\sin\\theta$，积分为$\\frac{a}{k\\sin\\theta}J_1(ka\\sin\\theta)$。远场压力为：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\frac{a}{k\\sin\\theta} J_1(ka\\sin\\theta) $$\n通常将其写成活塞面积$A = \\pi a^2$和指向性函数$D(\\theta)$的形式：\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 (\\pi a^2) \\exp(ikR)}{2\\pi R} \\left[ \\frac{2 J_1(ka\\sin\\theta)}{ka\\sin\\theta} \\right] $$\n压力的模平方是：\n$$ |p(R,\\theta)|^2 = \\left( \\frac{\\omega\\rho_0 V_0 a}{R k\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) = \\left( \\frac{\\rho_0 c_0 V_0 a}{R \\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) $$\n其中我们使用了$k=\\omega/c_0$。\n总辐射功率是通过在远场半球面（$0 \\le \\theta \\le \\pi/2$，$0 \\le \\phi \\le 2\\pi$）上对强度进行积分得到的。面元为$d\\mathbf{S} = \\hat{\\mathbf{r}} R^2 \\sin\\theta d\\theta d\\phi$。\n$$ \\Pi_{rad} = \\int_0^{2\\pi} \\int_0^{\\pi/2} \\frac{|p(R,\\theta)|^2}{2\\rho_0 c_0} (R^2 \\sin\\theta) d\\theta d\\phi $$\n由于被积函数与$\\phi$无关，对$\\phi$的积分得到$2\\pi$。$R^2$项相互抵消。\n$$ \\Pi_{rad} = \\frac{2\\pi}{2\\rho_0 c_0} \\int_0^{\\pi/2} \\left( \\frac{\\rho_0 c_0 V_0 a}{\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\frac{\\pi (\\rho_0 c_0 V_0 a)^2}{\\rho_0 c_0} \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin^2\\theta} \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\pi \\rho_0 c_0 V_0^2 a^2 \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin\\theta} d\\theta $$\n该积分是贝塞尔函数理论中的一个标准结果。对于$x>0$，恒等式为：\n$$ \\int_0^{\\pi/2} \\frac{J_1^2(x\\sin\\theta)}{\\sin\\theta} d\\theta = \\frac{1}{2} \\left[ 1 - \\frac{J_1(2x)}{x} \\right] $$\n令$x = ka$，并假设$V_0$是一个实值相量幅值，即$|V_0|^2=V_0^2$，我们将此恒等式代入功率表达式中：\n$$ \\Pi_{rad} = \\pi \\rho_0 c_0 V_0^2 a^2 \\left( \\frac{1}{2} \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right] \\right) $$\n这是总辐射功率的最终闭合形式表达式，在国际单位制(SI)中其单位为瓦特(Watts)。\n\n该结果也可以用活塞的辐射电阻$R_m$来表示，其中$\\Pi_{rad} = \\frac{1}{2}R_m |V_0|^2$。比较表达式可得出著名的辐射电阻公式：$R_m = \\rho_0 c_0 (\\pi a^2) \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right]$。此处的推导按要求通过对远场强度进行积分，从第一性原理得到了这个结果。",
            "answer": "$$ \\boxed{ \\frac{\\pi \\rho_0 c_0 a^2 |V_0|^2}{2} \\left( 1 - \\frac{J_1(2ka)}{ka} \\right) } $$"
        },
        {
            "introduction": "将理论与实践联系起来通常涉及数值方法。这项练习展示了如何运用一个深刻的物理原理——互易性——来验证数值模拟的正确性，特别是用于模拟声辐射的边界元法（Boundary Element Method, BEM）。",
            "id": "4114007",
            "problem": "考虑一个均匀、无损、互易的声学介质，其质量密度$\\rho_0$和声速$c_0$均为常数。令$\\omega$表示角频率，$k$表示由$k = \\omega / c_0$定义的波数，并令$\\mathbf{r} \\in \\mathbb{R}^3$表示一个场点。外部区域的声压$p(\\mathbf{r})$满足亥姆霍兹方程，并可以通过在具有法向速度$u_n(\\mathbf{s})$的振动边界面$\\mathcal{S}$上的单层势来表示，其中$\\mathbf{s} \\in \\mathcal{S}$。亥姆霍兹算子的自由空间格林函数是满足互易性的基本解，即对于所有不同的$\\mathbf{r},\\mathbf{r}'$，$G(\\mathbf{r},\\mathbf{r}') = G(\\mathbf{r}',\\mathbf{r})$。\n\n在边界元法(BEM; Boundary Element Method)的配置框架中，表面$\\mathcal{S}$被离散为一组有限的边界元，其质心作为配置点。场在离面测试点进行采样。针对此类离散化，可以通过交换配置点和测试点的角色，并比较两个传递函数来 formulating 一个基于互易性的一致性检验。这两个传递函数分别是：将所选边界元上的单位法向速度幅值映射到所选测试点产生的压力，以及反之，被解释为在测试点放置一个等效点源在所选配置点处产生的压力，该点源的强度经选择以保持单层算子所引发的物理共轭配对。\n\n从基本定律和核心定义（即互易介质中的线性声学、亥姆霍兹方程和格林函数对称性）出发，推导出一个离散传递函数求值方法，以实现以下测试。设振动表面为一个位于$z = 0$平面、中心在原点的矩形平面障板，其法线与$+z$轴对齐。考虑一个以原点为中心的单个矩形边界元（一个面元），其宽度为$W$，高度为$H$，因此其面积为$A = W H$。设一个场（测试）点位于$\\mathbf{r}_f = (x_f,y_f,z_f)$，其中$z_f  0$，并设该边界元的配置点为其质心$\\mathbf{r}_c = (0,0,0)$。假设在面元上具有均匀的法向速度，其大小为$u_0$，单位为$\\mathrm{m/s}$。\n\n定义以下两个复值传递求值：\n- 前向传递，从边界元到场点，定义为在面元上均匀法向速度$u_0$在$\\mathbf{r}_f$处引起的压力，通过使用面元区域上的求积法则对单层势进行数值积分计算。\n- 交换传递，从场点到配置点，定义为位于$\\mathbf{r}_f$的等效单极子点源在$\\mathbf{r}_c$处产生的压力，其源强度$Q$的选择应使得在交换下，单层算子所隐含的法向速度和压力之间的共轭配对得以保持。利用此原理定义$Q$与$\\rho_0$、$\\omega$、$u_0$和$A$的关系。\n\n实现一个程序，对于下面指定的一组测试用例，计算前向传递和交换传递，并报告无量纲互易性一致性误差\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}.\n$$\n您的前向传递数值积分必须在矩形面元上使用张量积高斯-勒让德求积。格林函数必须是三维自由空间亥姆霍兹格林函数。所有物理量必须采用国际单位制（SI 单位），其中$c_0$单位为$\\mathrm{m/s}$，$\\rho_0$单位为$\\mathrm{kg/m^3}$，频率$f$单位为$\\mathrm{Hz}$，几何尺寸单位为$\\mathrm{m}$。\n\n测试用例规范：\n- 所有测试均使用$\\rho_0 = 1.225$（单位$\\mathrm{kg/m^3}$）、$c_0 = 343$（单位$\\mathrm{m/s}$）和$u_0 = 1$（单位$\\mathrm{m/s}$）。令$\\omega = 2\\pi f$和$k = \\omega / c_0$。\n- 用例 1（正常路径）：$f = 1000$（单位$\\mathrm{Hz}$），$W = 0.05$（单位$\\mathrm{m}$），$H = 0.05$（单位$\\mathrm{m}$），$\\mathbf{r}_f = (0,0,0.5)$（单位$\\mathrm{m}$），求积阶数$N_x = 12$，$N_y = 12$。\n- 用例 2（近场）：$f = 1000$（单位$\\mathrm{Hz}$），$W = 0.10$（单位$\\mathrm{m}$），$H = 0.10$（单位$\\mathrm{m}$），$\\mathbf{r}_f = (0,0,0.05)$（单位$\\mathrm{m}$），求积阶数$N_x = 48$，$N_y = 48$。\n- 用例 3（高频）：$f = 5000$（单位$\\mathrm{Hz}$），$W = 0.05$（单位$\\mathrm{m}$），$H = 0.05$（单位$\\mathrm{m}$），$\\mathbf{r}_f = (0,0,1.0)$（单位$\\mathrm{m}$），求积阶数$N_x = 24$，$N_y = 24$。\n- 用例 4（离轴场点）：$f = 1500$（单位$\\mathrm{Hz}$），$W = 0.07$（单位$\\mathrm{m}$），$H = 0.05$（单位$\\mathrm{m}$），$\\mathbf{r}_f = (0.02,-0.015,0.3)$（单位$\\mathrm{m}$），求积阶数$N_x = 24$，$N_y = 24$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$,$\\text{result4}$]”），其中每个$\\text{result}$是相应测试用例的$\\varepsilon$的浮点值，表示为不带单位的小数。程序必须是自包含的，不得读取输入，也不得访问任何外部资源。",
            "solution": "该问题是有效的，因为它在科学上基于线性声学原理，在数学上是适定的，并且陈述客观。它提出了一个在数值方法（BEM）背景下验证基本物理原理——互易性的非平凡计算任务。所有必要的数据和定义都已提供。\n\n该问题的基础是在均匀、无损、互易介质中的时谐声场。对于$e^{-i\\omega t}$的时间依赖性，声压$p(\\mathbf{r})$由亥姆霍兹方程控制：\n$$\n(\\nabla^2 + k^2) p(\\mathbf{r}) = 0\n$$\n其中$\\omega$是角频率，$k = \\omega / c_0$是波数，$c_0$是声速，$\\mathbf{r}$是场中的一个点。\n\n对于无限大刚性障板中的振动平面（“平面障板”所隐含的条件），半空间$z  0$中的压力由瑞利积分给出：\n$$\np(\\mathbf{r}) = \\frac{i\\omega\\rho_0}{2\\pi} \\int_{\\mathcal{S}} u_n(\\mathbf{s}) \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|} dS(\\mathbf{s})\n$$\n其中$\\rho_0$是介质密度，$u_n(\\mathbf{s})$是位于位置$\\mathbf{s} \\in \\mathcal{S}$的表面元$dS$上的法向速度，而项$G(\\mathbf{r},\\mathbf{s}) = \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|}$是积分的核。此积分公式是障板表面的单层势的一种特定形式。该公式本质上依赖于自由空间格林函数（为了考虑障板效应而加倍），并且源密度被确定为与法向速度成正比，即$\\sigma(\\mathbf{s}) \\propto i\\omega\\rho_0 u_n(\\mathbf{s})$。\n\n该问题要求计算和比较两个传递函数。\n\n**1. 前向传递 ($p_{\\text{forward}}$)**\n\n前向传递定义为振动面元在场点$\\mathbf{r}_f = (x_f, y_f, z_f)$处产生的压力$p_{\\text{forward}}$。该面元是一个宽度为$W$、高度为$H$的矩形$\\mathcal{S}$，位于$z=0$平面并以原点为中心，因此$\\mathcal{S} = [-W/2, W/2] \\times [-H/2, H/2] \\times \\{0\\}$。法向速度是均匀的，$u_n(\\mathbf{s}) = u_0$。\n\n将这些代入瑞利积分，我们得到：\n$$\np_{\\text{forward}} = p(\\mathbf{r}_f) = \\frac{i\\omega\\rho_0 u_0}{2\\pi} \\int_{-W/2}^{W/2} \\int_{-H/2}^{H/2} \\frac{e^{ik\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}}}{\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}} dx dy\n$$\n该积分使用张量积高斯-勒让德求积法进行数值计算。我们进行变量替换，将积分域从$[-W/2, W/2] \\times [-H/2, H/2]$映射到规范正方形$[-1, 1] \\times [-1, 1]$。令$x = (W/2)\\xi$和$y = (H/2)\\eta$。微分面积元变为$dx dy = (WH/4) d\\xi d\\eta = (A/4) d\\xi d\\eta$，其中$A=WH$是面元的面积。积分变为：\n$$\np_{\\text{forward}} = \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{e^{ik R(\\xi, \\eta)}}{R(\\xi, \\eta)} d\\xi d\\eta\n$$\n其中$R(\\xi, \\eta) = \\sqrt{(x_f - \\frac{W}{2}\\xi)^2 + (y_f - \\frac{H}{2}\\eta)^2 + z_f^2}$。应用具有$N_x \\times N_y$个点、节点为$\\{\\xi_i, \\eta_j\\}$、权重为$\\{w_i, w_j\\}$的求积法则，得到离散近似：\n$$\np_{\\text{forward}} \\approx \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} w_i w_j \\frac{e^{ik R_{ij}}}{R_{ij}}\n$$\n其中$R_{ij} = \\sqrt{(x_f - \\frac{W}{2}\\xi_i)^2 + (y_f - \\frac{H}{2}\\eta_j)^2 + z_f^2}$。\n\n**2. 交换传递 ($p_{\\text{swapped}}$)**\n\n交换传递$p_{\\text{swapped}}$是指位于场点$\\mathbf{r}_f$、强度为$Q$（单位$\\mathrm{m^3/s}$）的等效单极子点源在面元配置点（其质心$\\mathbf{r}_c = (0,0,0)$）处产生的压力。\n\n在障板环境中，位于$\\mathbf{r}_f$的体积速度强度为$Q$的单极子点源产生的压力场由以下公式给出：\n$$\np_{\\text{source}}(\\mathbf{r}) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}_f|}}{|\\mathbf{r}-\\mathbf{r}_f|}\n$$\n在配置点$\\mathbf{r}_c$处计算该值，得到交换压力：\n$$\np_{\\text{swapped}} = p_{\\text{source}}(\\mathbf{r}_c) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{|\\mathbf{r}_c-\\mathbf{r}_f|}\n$$\n必须定义源强度$Q$以保持物理配对。体现在格林函数对称性中的互易性原理提供了两者之间的联系。由面元$\\mathcal{S}$上的分布源$\\sigma(\\mathbf{s}) = i\\omega\\rho_0 u_n(\\mathbf{s})$在$\\mathbf{r}_f$处产生的压力是：\n$$\np_{\\text{forward}} = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{r}_f, \\mathbf{s}) dS(\\mathbf{s}) = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s})\n$$\n其中$G_{\\text{baffled}}(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}'|}}{2\\pi|\\mathbf{r}-\\mathbf{r}'|}$。在BEM配置中，一个关键近似是假设乘积的积分可以通过在配置点$\\mathbf{r}_c$处评估核函数的光滑部分来近似：\n$$\n\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s}) \\approx G_{\\text{baffled}}(\\mathbf{r}_c, \\mathbf{r}_f) \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS(\\mathbf{s})\n$$\n此近似的右侧是表达交换传递的另一种方式。面元上的总源强度为$\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS = \\int_{\\mathcal{S}} i\\omega\\rho_0 u_0 dS = i\\omega\\rho_0 u_0 A$。因此交换压力是：\n$$\np_{\\text{swapped}} = \\left( \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{2\\pi|\\mathbf{r}_c-\\mathbf{r}_f|} \\right) (i\\omega\\rho_0 u_0 A)\n$$\n通过将其与单极子源压力方程进行比较，我们看到$i\\omega\\rho_0 Q$必须等效于总源强度$i\\omega\\rho_0 u_0 A$。这导致了等效源强度的定义：\n$$\nQ = u_0 A\n$$\n这在物理上是直观的：等效点源的体积速度等于振动面元的总体积速度。据此，交换压力的最终表达式为：\n$$\np_{\\text{swapped}} = \\frac{i\\omega\\rho_0 (u_0 A)}{2\\pi} \\frac{e^{ik|\\mathbf{r}_f|}}{|\\mathbf{r}_f|}\n$$\n因为$\\mathbf{r}_c$是原点。\n\n**3. 互易性一致性误差 ($\\varepsilon$)**\n\n无量纲误差$\\varepsilon$量化了前向传递的精确积分与用于推导交换传递的单点配置近似之间的差异。它衡量了在此相互作用中，面元能被其质心代表的程度。\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}\n$$\n数值实现将通过求积计算$p_{\\text{forward}}$，通过其解析公式计算$p_{\\text{swapped}}$，然后为每个测试用例计算$\\varepsilon$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Computes the reciprocity consistency error for a set of acoustic radiation problems.\n    \"\"\"\n    RHO_0 = 1.225  # kg/m^3\n    C_0 = 343.0    # m/s\n    U_0 = 1.0      # m/s\n\n    test_cases = [\n        # Case 1: happy path\n        {'f': 1000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 0.5), 'Nx': 12, 'Ny': 12},\n        # Case 2: near field\n        {'f': 1000.0, 'W': 0.10, 'H': 0.10, 'rf': (0.0, 0.0, 0.05), 'Nx': 48, 'Ny': 48},\n        # Case 3: high frequency\n        {'f': 5000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 1.0), 'Nx': 24, 'Ny': 24},\n        # Case 4: off-axis field point\n        {'f': 1500.0, 'W': 0.07, 'H': 0.05, 'rf': (0.02, -0.015, 0.3), 'Nx': 24, 'Ny': 24},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        f = case['f']\n        W = case['W']\n        H = case['H']\n        xf, yf, zf = case['rf']\n        Nx = case['Nx']\n        Ny = case['Ny']\n\n        # Derived physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / C_0\n        A = W * H\n\n        # --- 1. Forward Transfer Calculation (p_forward) ---\n        # Get Gauss-Legendre quadrature nodes and weights for the interval [-1, 1]\n        xi_nodes, xi_weights = leggauss(Nx)\n        eta_nodes, eta_weights = leggauss(Ny)\n\n        # Create meshgrid for vectorized calculation\n        xi_grid, eta_grid = np.meshgrid(xi_nodes, eta_nodes)\n        wi_grid, wj_grid = np.meshgrid(xi_weights, eta_weights)\n\n        # Map quadrature points to physical coordinates on the patch\n        xs = (W / 2.0) * xi_grid\n        ys = (H / 2.0) * eta_grid\n\n        # Calculate distance from each source point on the patch to the field point\n        R = np.sqrt((xf - xs)**2 + (yf - ys)**2 + zf**2)\n\n        # Calculate the integrand of the Rayleigh integral\n        # Note: The problem uses the baffled Green's function G = exp(ikR)/(2*pi*R)\n        # So the integral for pressure is i*omega*rho0 * Integral(u_n * G * dS)\n        # In the original, the integral form is (i*omega*rho0)/(2*pi) * Integral(u_n * exp(ikR)/R * dS)\n        # The code is implementing the latter, which is correct.\n        integrand = np.exp(1j * k * R) / R\n\n        # Perform the numerical integration\n        integral_sum = np.sum(wi_grid * wj_grid * integrand)\n\n        # The change of variables introduced a Jacobian of (W/2)*(H/2) = A/4\n        # The integral is multiplied by this Jacobian and the other constants\n        p_forward = (1j * omega * RHO_0 * U_0 / (2.0 * np.pi)) * (A / 4.0) * integral_sum\n        \n        # --- 2. Swapped Transfer Calculation (p_swapped) ---\n        # The collocation point is the origin\n        rc = np.array([0.0, 0.0, 0.0])\n        rf_vec = np.array([xf, yf, zf])\n\n        # Distance from collocation point to field point\n        R_cf = np.linalg.norm(rf_vec - rc)\n        \n        # Equivalent monopole source strength\n        Q = U_0 * A\n\n        # Calculate the pressure at rc from the point source at rf\n        if R_cf == 0:\n            # This case should not occur based on problem description (zf > 0)\n            # but is included for numerical stability.\n            p_swapped = np.inf\n        else:\n            # Pressure from a baffled monopole source of strength Q\n            p_swapped = (1j * omega * RHO_0 * Q / (2.0 * np.pi)) * (np.exp(1j * k * R_cf) / R_cf)\n\n        # --- 3. Reciprocity Consistency Error (epsilon) ---\n        if np.abs(p_forward) == 0:\n            error = np.inf if np.abs(p_forward - p_swapped) > 0 else 0.0\n        else:\n            error = np.abs(p_forward - p_swapped) / np.abs(p_forward)\n        \n        results.append(error)\n\n    # Format the final output\n    # Using f-string formatting to control the number representation\n    formatted_results = [f\"{res:.10e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}