{
    "hands_on_practices": [
        {
            "introduction": "We begin with the simplest scattering scenario: a plane wave interacting with an infinite flat surface. This exercise  solidifies the physical meaning of the fundamental rigid (Neumann) and soft (Dirichlet) boundary conditions. By deriving the reflection coefficients and analyzing energy balance, you will see how these idealizations lead to total reflection and develop an intuition for how boundary conditions dictate wave behavior through phase shifts.",
            "id": "4114745",
            "problem": "A lossless, homogeneous, inviscid fluid of density $\\rho_{0}$ and sound speed $c_{0}$ occupies the half-space $z0$. A time-harmonic acoustic plane wave with angular frequency $\\omega$ and complex pressure amplitude $P_{i}$ is incident from the fluid onto the infinite plane boundary at $z=0$ at an incidence angle $\\theta \\in [0,\\pi/2)$ measured from the outward unit normal $\\hat{\\boldsymbol{n}}=\\hat{\\boldsymbol{z}}$. Adopt the time dependence $\\exp(-i \\omega t)$ and denote the acoustic wavenumber by $k=\\omega/c_{0}$. The linearized conservation of momentum and mass imply the frequency-domain relations between acoustic pressure $p(\\boldsymbol{x})$ and particle velocity $\\boldsymbol{v}(\\boldsymbol{x})$, and the acoustic field satisfies the homogeneous Helmholtz equation in the fluid.\n\nTwo canonical boundary conditions are considered at $z=0$:\n- Rigid (Neumann) boundary: the normal particle velocity vanishes, so $v_{n}=0$ at $z=0$.\n- Soft (Dirichlet, pressure-release) boundary: the acoustic pressure vanishes, so $p=0$ at $z=0$.\n\nDefine the complex pressure reflection coefficient $R$ as the ratio of the reflected to the incident complex pressure amplitudes evaluated at the boundary, $R = P_{r}/P_{i}$, where $P_{r}$ is the complex pressure amplitude of the reflected wave. The phase of $R$ is the argument $\\phi=\\arg(R)$, to be reported in radians.\n\nTasks:\n1) Starting from the linearized governing equations in the frequency domain and the boundary conditions stated above, derive the reflected wave field for oblique incidence and obtain the complex pressure reflection coefficient $R(\\theta)$ for the rigid (Neumann) and soft (Dirichlet) planes.\n\n2) Using the plane-wave fields, compute the normal component of the time-averaged acoustic intensity at $z=0$ for the incident and reflected waves and interpret the energy balance at the boundary for each case.\n\n3) Report the ordered quadruple $\\left(|R_{\\mathrm{N}}|, \\phi_{\\mathrm{N}}, |R_{\\mathrm{D}}|, \\phi_{\\mathrm{D}}\\right)$, where the subscripts $\\mathrm{N}$ and $\\mathrm{D}$ denote the Neumann and Dirichlet boundaries, respectively. Express the phases in radians. No rounding is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard exercise in fundamental acoustics. We proceed with the solution.\n\nThe acoustic field is described in a Cartesian coordinate system $\\boldsymbol{x} = (x, y, z)$. The fluid occupies the half-space $z0$. Without loss of generality, we align the system such that the incident wave vector lies in the $x-z$ plane. The incident plane wave propagates towards the boundary at $z=0$.\n\nThe incident wave vector, $\\boldsymbol{k}_{i}$, has a magnitude equal to the wavenumber $k = \\omega/c_{0}$. The angle of incidence $\\theta$ is measured from the normal $\\hat{\\boldsymbol{z}}$. Thus, the components of $\\boldsymbol{k}_{i}$ are $k_{x} = k \\sin\\theta$ and $k_{z} = -k \\cos\\theta$. The negative sign for $k_{z}$ indicates propagation towards the boundary. The incident pressure field is given by:\n$$p_{i}(\\boldsymbol{x}) = P_{i} \\exp(i \\boldsymbol{k}_{i} \\cdot \\boldsymbol{x}) = P_{i} \\exp(i(k x \\sin\\theta - k z \\cos\\theta))$$\nThe reflected wave propagates away from the boundary. By Snell's law, the tangential component of the wave vector is conserved, so the reflected wave vector, $\\boldsymbol{k}_{r}$, has an $x$-component $k_{r,x} = k_{x} = k \\sin\\theta$. Since the reflected wave must also satisfy the dispersion relation $|\\boldsymbol{k}_{r}| = k$, we have $k_{r,x}^{2} + k_{r,z}^{2} = k^{2}$, which gives $k_{r,z}^{2} = k^{2} - (k \\sin\\theta)^{2} = k^{2} \\cos^{2}\\theta$. As the reflected wave propagates into the $z0$ region, we must choose the positive root, $k_{r,z} = k \\cos\\theta$. The reflected pressure field is:\n$$p_{r}(\\boldsymbol{x}) = P_{r} \\exp(i \\boldsymbol{k}_{r} \\cdot \\boldsymbol{x}) = P_{r} \\exp(i(k x \\sin\\theta + k z \\cos\\theta))$$\nThe total acoustic pressure in the fluid is the superposition of the incident and reflected fields:\n$$p(\\boldsymbol{x}) = p_{i}(\\boldsymbol{x}) + p_{r}(\\boldsymbol{x}) = \\exp(i k x \\sin\\theta) \\left[ P_{i} \\exp(-i k z \\cos\\theta) + P_{r} \\exp(i k z \\cos\\theta) \\right]$$\n\n**Task 1: Derive the complex pressure reflection coefficient $R(\\theta)$**\n\nWe apply the boundary conditions at the plane $z=0$. The reflection coefficient is defined as $R = P_{r}/P_{i}$.\n\n**A) Rigid (Neumann) Boundary**\nThe boundary condition is the vanishing of the normal component of the particle velocity, $v_{n} = v_{z} = 0$ at $z=0$. The linearized momentum equation in the frequency domain is $\\nabla p = i \\omega \\rho_{0} \\boldsymbol{v}$, which gives $\\boldsymbol{v} = \\frac{1}{i \\omega \\rho_{0}} \\nabla p$. The condition $v_{z}=0$ is therefore equivalent to $\\frac{\\partial p}{\\partial z} = 0$ at $z=0$.\n\nWe compute the partial derivative of the total pressure with respect to $z$:\n$$\\frac{\\partial p}{\\partial z} = \\exp(i k x \\sin\\theta) \\left[ P_{i} (-i k \\cos\\theta) \\exp(-i k z \\cos\\theta) + P_{r} (i k \\cos\\theta) \\exp(i k z \\cos\\theta) \\right]$$\nEvaluating at $z=0$:\n$$\\left. \\frac{\\partial p}{\\partial z} \\right|_{z=0} = \\exp(i k x \\sin\\theta) \\left[ -i k P_{i} \\cos\\theta + i k P_{r} \\cos\\theta \\right]$$\nFor this to be zero for all $x$, the term in the square brackets must be zero. Given $\\theta \\in [0, \\pi/2)$, $\\cos\\theta \\neq 0$, and $k \\neq 0$.\n$$-P_{i} + P_{r} = 0 \\implies P_{r} = P_{i}$$\nThe reflection coefficient for the rigid (Neumann) boundary is:\n$$R_{\\mathrm{N}} = \\frac{P_{r}}{P_{i}} = 1$$\n\n**B) Soft (Dirichlet) Boundary**\nThe boundary condition is the vanishing of the total acoustic pressure, $p=0$ at $z=0$.\nEvaluating the total pressure field at $z=0$:\n$$p(x,0) = \\exp(i k x \\sin\\theta) \\left[ P_{i} \\exp(0) + P_{r} \\exp(0) \\right] = \\exp(i k x \\sin\\theta) [P_{i} + P_{r}]$$\nFor this to be zero for all $x$, the term in the square brackets must be zero:\n$$P_{i} + P_{r} = 0 \\implies P_{r} = -P_{i}$$\nThe reflection coefficient for the soft (Dirichlet) boundary is:\n$$R_{\\mathrm{D}} = \\frac{P_{r}}{P_{i}} = -1$$\nNotably, for these ideal lossless boundaries, the reflection coefficient is independent of the angle of incidence $\\theta$.\n\n**Task 2: Acoustic Intensity and Energy Balance**\n\nThe time-averaged acoustic intensity vector is given by $\\boldsymbol{I} = \\frac{1}{2} \\operatorname{Re}\\{p \\boldsymbol{v}^{*}\\}$, where $\\boldsymbol{v}^{*}$ is the complex conjugate of the particle velocity. We are interested in the normal component of the intensity, $I_{z} = \\boldsymbol{I} \\cdot \\hat{\\boldsymbol{z}}$, at the boundary $z=0$.\n\nThe total normal velocity is $v_{z} = \\frac{1}{i\\omega\\rho_{0}}\\frac{\\partial p}{\\partial z}$. At $z=0$, we have:\n$$v_{z}(x,0) = \\frac{1}{i\\omega\\rho_{0}} \\exp(ikx\\sin\\theta) [-ikP_{i}\\cos\\theta + ikP_{r}\\cos\\theta] = \\frac{k\\cos\\theta}{\\omega\\rho_{0}}(P_{r}-P_{i})\\exp(ikx\\sin\\theta)$$\nUsing $k=\\omega/c_{0}$ and $R=P_{r}/P_{i}$, this simplifies to:\n$$v_{z}(x,0) = \\frac{\\cos\\theta}{c_{0}\\rho_{0}} P_{i}(R-1) \\exp(ikx\\sin\\theta)$$\nThe pressure at $z=0$ is:\n$$p(x,0) = P_{i}(1+R) \\exp(ikx\\sin\\theta)$$\nThe normal component of the time-averaged intensity at $z=0$ is:\n$$I_{z}(z=0) = \\frac{1}{2} \\operatorname{Re}\\{ p(x,0) v_{z}^{*}(x,0) \\}$$\n$$I_{z}(z=0) = \\frac{1}{2} \\operatorname{Re}\\left\\{ \\left(P_{i}(1+R) e^{ikx\\sin\\theta}\\right) \\left( \\frac{\\cos\\theta}{c_{0}\\rho_{0}} P_{i}(R-1) e^{ikx\\sin\\theta} \\right)^{*} \\right\\}$$\n$$I_{z}(z=0) = \\frac{1}{2} \\operatorname{Re}\\left\\{ \\frac{|P_{i}|^{2} \\cos\\theta}{c_{0}\\rho_{0}} (1+R)(R^{*}-1) \\right\\} = \\frac{|P_{i}|^{2} \\cos\\theta}{2c_{0}\\rho_{0}} \\operatorname{Re}\\{ |R|^{2} - R + R^{*} - 1 \\}$$\nSince $R-R^{*} = 2i\\operatorname{Im}(R)$, its real part is zero. Thus:\n$$I_{z}(z=0) = \\frac{|P_{i}|^{2} \\cos\\theta}{2c_{0}\\rho_{0}} (|R|^{2} - 1)$$\nThis expression represents the net energy flux per unit area into the boundary. The term $\\frac{|P_{i}|^{2} \\cos\\theta}{2c_{0}\\rho_{0}}$ is the magnitude of the normal component of the incident intensity. The factor $|R|^{2}$ is the reflectivity, or power reflection coefficient.\n\n**Interpretation of Energy Balance:**\n- For the rigid (Neumann) boundary, $R_{\\mathrm{N}}=1$, so $|R_{\\mathrm{N}}|^{2} = 1$. The net normal intensity is $I_{z}(z=0)=0$.\n- For the soft (Dirichlet) boundary, $R_{\\mathrm{D}}=-1$, so $|R_{\\mathrm{D}}|^{2} = 1$. The net normal intensity is $I_{z}(z=0)=0$.\n\nIn both cases, the net energy flux across the boundary is zero. This signifies that no energy is absorbed or transmitted by the boundary. The incident acoustic power is perfectly and entirely reflected back into the fluid. This is expected, as both the rigid and soft boundary conditions describe ideal, lossless interfaces. The normal component of the time-averaged intensity of the incident wave is exactly balanced by the normal component of the time-averaged intensity of the reflected wave, resulting in no net energy transfer.\n\n**Task 3: Report the ordered quadruple**\n\nWe need to find $(|R_{\\mathrm{N}}|, \\phi_{\\mathrm{N}}, |R_{\\mathrm{D}}|, \\phi_{\\mathrm{D}})$, where $\\phi = \\arg(R)$.\n\n- For the Neumann boundary:\n$R_{\\mathrm{N}} = 1$. This is a real number on the positive real axis in the complex plane.\nThe magnitude is $|R_{\\mathrm{N}}| = |1| = 1$.\nThe phase is $\\phi_{\\mathrm{N}} = \\arg(1) = 0$ radians.\n\n- For the Dirichlet boundary:\n$R_{\\mathrm{D}} = -1$. This is a real number on the negative real axis in the complex plane.\nThe magnitude is $|R_{\\mathrm{D}}| = |-1| = 1$.\nThe phase is $\\phi_{\\mathrm{D}} = \\arg(-1) = \\pi$ radians.\n\nThe ordered quadruple is $(1, 0, 1, \\pi)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0  1  \\pi\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from an infinite plane to a finite object, this practice  addresses the canonical problem of acoustic scattering from a rigid sphere. You will apply the powerful method of partial wave expansion—a cornerstone of scattering theory—to solve for the coefficients of the scattered field. This analytical derivation is crucial for understanding how an object's geometry interacts with an incident wave to produce a unique scattering signature.",
            "id": "4114741",
            "problem": "A time-harmonic acoustic plane wave of complex pressure amplitude $p_{0}$ and angular frequency $\\omega$ propagates in the $+z$-direction in a homogeneous, inviscid fluid of density $\\rho_{0}$ and sound speed $c_{0}$. The total acoustic pressure $p(\\mathbf{r})$ satisfies the scalar Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ with wavenumber $k = \\omega / c_{0}$ under the time dependence $\\exp(-\\mathrm{i}\\omega t)$. A rigid, perfectly reflecting sphere of radius $a$ is centered at the origin. The rigid boundary condition requires that the normal particle velocity vanish at the surface, which is equivalent to the Neumann boundary condition $\\partial p / \\partial r = 0$ at $r = a$ for the total pressure.\n\nStarting from the Helmholtz equation, separation of variables in spherical coordinates, and the radiation condition at infinity, expand the incident plane wave about the origin and represent the scattered field as a sum of outgoing spherical waves. By enforcing the Neumann boundary condition at $r = a$ and using orthogonality of the angular basis, determine the coefficient $A_{n}$ that multiplies each outgoing spherical wave in the scattered field representation\n$$\np_{\\mathrm{scat}}(r,\\theta) = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n}\\,A_{n}\\,h_{n}^{(1)}(k r)\\,P_{n}(\\cos\\theta),\n$$\nwhere $h_{n}^{(1)}(\\cdot)$ is the spherical Hankel function of the first kind of order $n$ and $P_{n}(\\cdot)$ is the Legendre polynomial of degree $n$. Express your final answer as a single closed-form analytic expression for $A_{n}$ in terms of $k a$ and spherical Bessel/Hankel functions and their derivatives. No numerical evaluation is required. The final answer must be a single analytic expression.",
            "solution": "The problem presented is a canonical example of acoustic scattering by a sphere, which is a well-posed problem in mathematical physics. All provided information is consistent, scientifically sound, and sufficient for deriving a unique solution. We may therefore proceed with the derivation.\n\nThe total acoustic pressure field $p(\\mathbf{r})$ is the linear superposition of the incident pressure field $p_{\\mathrm{inc}}(\\mathbf{r})$ and the scattered pressure field $p_{\\mathrm{scat}}(\\mathbf{r})$:\n$$\np(\\mathbf{r}) = p_{\\mathrm{inc}}(\\mathbf{r}) + p_{\\mathrm{scat}}(\\mathbf{r})\n$$\nBoth $p_{\\mathrm{inc}}$ and $p_{\\mathrm{scat}}$ are solutions to the Helmholtz equation, $\\nabla^{2} \\phi + k^{2} \\phi = 0$.\n\nThe incident field is a plane wave of amplitude $p_{0}$ propagating in the positive $z$-direction, given by $p_{\\mathrm{inc}}(\\mathbf{r}) = p_{0} \\exp(\\mathrm{i}k z)$. In spherical coordinates $(r, \\theta, \\phi)$, this is written as $p_{\\mathrm{inc}}(r, \\theta) = p_{0} \\exp(\\mathrm{i}k r \\cos\\theta)$. This plane wave can be expanded in a series of spherical basis functions as:\n$$\np_{\\mathrm{inc}}(r, \\theta) = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n}\\,j_{n}(k r)\\,P_{n}(\\cos\\theta)\n$$\nwhere $j_{n}(\\cdot)$ is the spherical Bessel function of the first kind of order $n$, and $P_{n}(\\cdot)$ is the Legendre polynomial of degree $n$.\n\nThe problem statement provides the form of the scattered field, which is an expansion in outgoing spherical waves satisfying the Sommerfeld radiation condition at infinity:\n$$\np_{\\mathrm{scat}}(r,\\theta) = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n}\\,A_{n}\\,h_{n}^{(1)}(k r)\\,P_{n}(\\cos\\theta)\n$$\nHere, $h_{n}^{(1)}(\\cdot)$ is the spherical Hankel function of the first kind of order $n$, and $A_{n}$ are the unknown coefficients to be determined.\n\nCombining the incident and scattered fields, the total pressure field is:\n$$\np(r,\\theta) = p_{\\mathrm{inc}} + p_{\\mathrm{scat}} = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n} \\left[ j_{n}(k r) + A_{n}\\,h_{n}^{(1)}(k r) \\right] P_{n}(\\cos\\theta)\n$$\nThe boundary condition for a rigid, perfectly reflecting sphere is that the normal component of the fluid particle velocity on the surface of the sphere is zero. In an inviscid fluid, the particle velocity $\\mathbf{u}$ is related to the pressure gradient by the linearized Euler's equation, $\\mathbf{u} = \\frac{\\mathrm{i}}{\\omega \\rho_{0}} \\nabla p$. The normal velocity at the surface $r=a$ is the radial component of the velocity, $u_{r} = \\frac{\\mathrm{i}}{\\omega \\rho_{0}} \\frac{\\partial p}{\\partial r}$. The condition $u_{r}|_{r=a} = 0$ is thus equivalent to the Neumann boundary condition on the pressure:\n$$\n\\frac{\\partial p}{\\partial r} \\bigg|_{r=a} = 0\n$$\nTo apply this condition, we first differentiate the expression for the total pressure $p(r,\\theta)$ with respect to $r$:\n$$\n\\frac{\\partial p}{\\partial r} = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n} \\frac{\\partial}{\\partial r} \\left[ j_{n}(k r) + A_{n}\\,h_{n}^{(1)}(k r) \\right] P_{n}(\\cos\\theta)\n$$\nUsing the chain rule, for a spherical function $f_{n}(\\rho)$ with argument $\\rho = kr$, the derivative is $\\frac{\\partial}{\\partial r}f_{n}(kr) = k f_{n}'(kr)$, where the prime denotes differentiation with respect to the argument. Applying this yields:\n$$\n\\frac{\\partial p}{\\partial r} = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n} k \\left[ j_{n}'(k r) + A_{n}\\,(h_{n}^{(1)})'(k r) \\right] P_{n}(\\cos\\theta)\n$$\nNow, we evaluate this expression at the boundary $r=a$ and set it to zero:\n$$\n\\frac{\\partial p}{\\partial r} \\bigg|_{r=a} = p_{0} \\sum_{n=0}^{\\infty} (2n+1)\\,\\mathrm{i}^{n} k \\left[ j_{n}'(k a) + A_{n}\\,(h_{n}^{(1)})'(k a) \\right] P_{n}(\\cos\\theta) = 0\n$$\nThe Legendre polynomials $P_{n}(\\cos\\theta)$ form a complete orthogonal set on the interval $\\theta \\in [0, \\pi]$. For the infinite series to be zero for all values of $\\theta$, the coefficient of each $P_{n}(\\cos\\theta)$ must be identically zero for each $n = 0, 1, 2, \\dots$. Therefore, for each $n$:\n$$\np_{0} (2n+1)\\,\\mathrm{i}^{n} k \\left[ j_{n}'(k a) + A_{n}\\,(h_{n}^{(1)})'(k a) \\right] = 0\n$$\nSince the pre-factors $p_{0}$, $(2n+1)$, $\\mathrm{i}^{n}$, and $k$ are non-zero (assuming a non-trivial incident wave), the term in the square brackets must be zero:\n$$\nj_{n}'(k a) + A_{n}\\,(h_{n}^{(1)})'(k a) = 0\n$$\nWe can now solve for the unknown coefficient $A_{n}$:\n$$\nA_{n}\\,(h_{n}^{(1)})'(k a) = - j_{n}'(k a)\n$$\n$$\nA_{n} = - \\frac{j_{n}'(k a)}{(h_{n}^{(1)})'(k a)}\n$$\nThis is the closed-form analytic expression for the coefficient $A_{n}$, where the prime indicates differentiation with respect to the argument of the function.",
            "answer": "$$\n\\boxed{- \\frac{j_{n}'(k a)}{(h_{n}^{(1)})'(k a)}}\n$$"
        },
        {
            "introduction": "This practice  bridges the gap between analytical theory and practical computation, building upon the partial wave solution for a sphere. You will implement this series solution numerically to compare the scattering from rigid and soft spheres, focusing on how the angular pattern evolves with the dimensionless size parameter $ka$. This computational exercise develops essential skills in translating mathematical formulas into convergent algorithms and interpreting physical results, such as the forward-to-backward scattering ratio.",
            "id": "4114765",
            "problem": "Consider time-harmonic acoustic scattering of a plane wave by a homogeneous sphere in an unbounded, lossless fluid. Let the total acoustic pressure field satisfy the scalar Helmholtz equation with wavenumber $k$, and let the incident field be a plane wave of unit amplitude. The sphere has radius $a$. Two boundary condition models are to be compared: a sound-hard (rigid) sphere that enforces zero normal particle velocity at $r=a$, and a sound-soft (pressure-release) sphere that enforces zero pressure at $r=a$.\n\nStarting from the Helmholtz equation $\\nabla^2 p + k^2 p = 0$, the definition of the far-field scattering amplitude, the plane-wave expansion in spherical coordinates, and the boundary conditions on a sphere, derive an expression suitable for numerical computation of the far-field angular scattering amplitude using a truncated partial-wave series. Your derivation must:\n- Begin from the spherical separation of variables and the representation of the scattered field in terms of spherical Hankel functions of the first kind.\n- Impose the sound-hard and sound-soft boundary conditions at $r=a$ to obtain the corresponding modal coefficients.\n- Express the far-field scattering amplitude in terms of a Legendre series and specify how to evaluate it at angles $\\theta = 0$ (forward) and $\\theta = \\pi$ (backward), with angles measured in radians.\n\nFor numerical computation, implement a truncation rule for the series that guarantees convergence for moderate size parameter $ka$. Use the rule\n$$\nN_{\\max} = \\left\\lceil ka + 4\\,(ka)^{1/3} + 10 \\right\\rceil,\n$$\nand in all cases enforce $N_{\\max} \\ge 5$.\n\nDefine the forward-to-backward differential scattering intensity ratio\n$$\n\\mathcal{R} = \\frac{|f(0)|^2}{|f(\\pi)|^2},\n$$\nwhere $f(\\theta)$ is the far-field scattering amplitude, and $|\\cdot|$ denotes complex modulus.\n\nImplement a program that, for each specified test case, computes $\\mathcal{R}$ using the truncated series for both boundary conditions. You may assume that the fluid density and sound speed are such that nondimensionalization by $a$ and $k$ is valid, so that results depend only on the dimensionless size parameter $ka$. No physical units are required for $\\mathcal{R}$; it is a dimensionless quantity.\n\nTest Suite:\n- Case $1$: $ka = 0.5$ (angles in radians).\n- Case $2$: $ka = 1.0$ (angles in radians).\n- Case $3$: $ka = 2.0$ (angles in radians).\n- Case $4$: $ka = 5.0$ (angles in radians).\n\nFor each case, compute two floats:\n- The value of $\\mathcal{R}$ for a sound-hard (rigid) sphere.\n- The value of $\\mathcal{R}$ for a sound-soft (pressure-release) sphere.\n\nYour program should produce a single line of output containing the results for all cases aggregated in the following order:\n$$\n\\left[ \\mathcal{R}_{\\text{rigid}}(ka{=}0.5), \\mathcal{R}_{\\text{soft}}(ka{=}0.5), \\mathcal{R}_{\\text{rigid}}(ka{=}1.0), \\mathcal{R}_{\\text{soft}}(ka{=}1.0), \\mathcal{R}_{\\text{rigid}}(ka{=}2.0), \\mathcal{R}_{\\text{soft}}(ka{=}2.0), \\mathcal{R}_{\\text{rigid}}(ka{=}5.0), \\mathcal{R}_{\\text{soft}}(ka{=}5.0) \\right].\n$$\nThe list must be printed as a single line, comma-separated, enclosed in square brackets. Each float must be rounded to exactly $6$ decimal places.\n\nAngles must be in radians. No physical units are required for the output because $\\mathcal{R}$ is dimensionless. The program must be self-contained and must not read any input. The result for each test case must be a float. The final output format must be exactly one list on a single line as specified above.",
            "solution": "The user wants me to solve a problem in computational acoustics.\n\nHere's my thinking process:\n\n1.  **Problem Validation**:\n    *   I'll start by meticulously extracting all the givens from the problem statement: the governing equation, the geometry, the incident field, the boundary conditions, the definition of the quantity to be calculated ($\\mathcal{R}$), the specific numerical truncation rule, and the test cases.\n    *   Next, I'll evaluate the problem against the validation criteria. The problem is a standard textbook case of acoustic scattering. It's scientifically sound (based on the Helmholtz equation), well-posed (leads to a unique solution), objective, and self-contained. It's a core problem in computational acoustics, so it's relevant. The idealizations (perfectly rigid/soft sphere) are standard and don't make the problem invalid. Therefore, the problem is **valid**.\n\n2.  **Theoretical Derivation**:\n    *   **Field Representation**: The core of the problem is representing the acoustic pressure fields using partial-wave expansions (series of spherical basis functions). The total pressure field $p$ is the sum of the incident field $p_{\\text{inc}}$ and the scattered field $p_{\\text{scat}}$.\n        *   The incident plane wave, $p_{\\text{inc}} = e^{ikz} = e^{ikr\\cos\\theta}$, has a known expansion in terms of spherical Bessel functions $j_n(kr)$ and Legendre polynomials $P_n(\\cos\\theta)$.\n        *   The scattered field $p_{\\text{scat}}$ must be an outgoing wave at infinity, so its expansion will use spherical Hankel functions of the first kind, $h_n^{(1)}(kr)$. The expansion coefficients are unknown.\n    *   **Boundary Conditions (BCs)**: The unknown coefficients are determined by applying the BCs at the sphere's surface ($r=a$).\n        *   **Sound-soft (Dirichlet BC)**: $p = p_{\\text{inc}} + p_{\\text{scat}} = 0$ at $r=a$. This algebraic condition lets me solve for the scattering coefficients directly.\n        *   **Sound-hard (Neumann BC)**: The normal particle velocity is zero. Since velocity is proportional to the pressure gradient ($\\mathbf{v} \\propto \\nabla p$), this means the normal (radial) derivative of the pressure is zero: $\\frac{\\partial p}{\\partial r} = 0$ at $r=a$. This involves the derivatives of the spherical Bessel and Hankel functions.\n    *   **Far-Field Amplitude**: The scattered field $p_{\\text{scat}}$ behaves like $f(\\theta) \\frac{e^{ikr}}{r}$ as $r \\to \\infty$. I'll use the asymptotic form of the Hankel function $h_n^{(1)}(kr)$ to relate the expansion of $p_{\\text{scat}}$ to this definition and extract the expression for the scattering amplitude, $f(\\theta)$. This will result in a series for $f(\\theta)$ involving the scattering coefficients and Legendre polynomials.\n    *   **Forward/Backward Scattering**: To find the amplitudes in the forward ($\\theta=0$) and backward ($\\theta=\\pi$) directions, I'll use the known values of the Legendre polynomials at these angles: $P_n(\\cos 0) = P_n(1) = 1$ and $P_n(\\cos \\pi) = P_n(-1) = (-1)^n$.\n    *   **Ratio $\\mathcal{R}$**: Finally, I'll construct the ratio $\\mathcal{R} = \\frac{|f(0)|^2}{|f(\\pi)|^2}$. The factors of $1/k$ in the expression for $f(\\theta)$ will cancel out, simplifying the final formula for numerical computation.\n\n3.  **Numerical Implementation**:\n    *   **Code Structure**: I will write a Python script using `numpy` for array operations and `scipy.special` for the required spherical functions ($j_n, y_n,$ and their derivatives).\n    *   **Truncation**: I'll implement the given truncation rule, $N_{\\max} = \\lceil ka + 4(ka)^{1/3} + 10 \\rceil$ with a minimum of $5$, to determine how many terms of the series to compute.\n    *   **Calculation Loop**: The main part of the code will loop through the given test cases ($ka$ values). For each $ka$, it will:\n        1.  Calculate $N_{\\max}$.\n        2.  Generate an array of orders $n$ from $0$ to $N_{\\max}$.\n        3.  Compute the necessary spherical Bessel, Neumann, and Hankel functions (and their derivatives) for all required orders at once using `scipy`'s vectorized functions.\n        4.  Calculate the scattering coefficients ($T_n^{\\text{soft}}$ and $T_n^{\\text{rigid}}$).\n        5.  Compute the sums for the forward and backward amplitudes (numerator and denominator of $\\mathcal{R}$).\n        6.  Calculate $\\mathcal{R}$ for both rigid and soft cases.\n    *   **Output Formatting**: The results will be stored, formatted to exactly 6 decimal places, and printed in a single line as a comma-separated list enclosed in square brackets, as specified in the problem.\n\nThis systematic approach ensures all aspects of the problem are addressed, from the fundamental physics and mathematics to the details of the numerical implementation and output formatting.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n- **Governing Equation**: The scalar Helmholtz equation, $\\nabla^2 p + k^2 p = 0$.\n- **Incident Field**: A plane wave of unit amplitude, $p_{inc}$.\n- **Scatterer**: A homogeneous sphere of radius $a$.\n- **Medium**: An unbounded, lossless fluid.\n- **Boundary Conditions**:\n    1.  Sound-hard (rigid): Zero normal particle velocity at $r=a$.\n    2.  Sound-soft (pressure-release): Zero pressure at $r=a$.\n- **Numerical Series Truncation Rule**: $N_{\\max} = \\left\\lceil ka + 4\\,(ka)^{1/3} + 10 \\right\\rceil$, with a minimum value $N_{\\max} \\ge 5$.\n- **Quantity to Compute**: The forward-to-backward differential scattering intensity ratio, $\\mathcal{R} = \\frac{|f(0)|^2}{|f(\\pi)|^2}$, where $f(\\theta)$ is the far-field scattering amplitude.\n- **Test Cases**: $ka \\in \\{0.5, 1.0, 2.0, 5.0\\}$.\n- **Output Format**: A single-line list of floats, rounded to 6 decimal places, in the order $[\\mathcal{R}_{\\text{rigid}}(0.5), \\mathcal{R}_{\\text{soft}}(0.5), \\mathcal{R}_{\\text{rigid}}(1.0), \\mathcal{R}_{\\text{soft}}(1.0), \\dots]$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a canonical exercise in acoustic scattering theory, based on the fundamental Helmholtz equation and standard boundary conditions. It is scientifically sound. **Pass.**\n2.  **Well-Posed**: The problem is well-posed. The Helmholtz equation, combined with the Sommerfeld radiation condition for the scattered field, guarantees the existence of a unique, stable solution for a given incident field and scatterer geometry/boundary condition. **Pass.**\n3.  **Objective**: The problem is formulated with precise, objective mathematical and physical terminology. All terms are standard and unambiguously defined within the field of acoustics. **Pass.**\n4.  **Completeness and Consistency**: The problem is self-contained and provides all necessary information: the physical model, governing equations, boundary conditions, a specific numerical truncation rule, and test cases. There are no contradictions. **Pass.**\n5.  **Plausibility**: The physical models (perfectly rigid/soft spheres) are standard idealizations in physics and engineering. The given values for the size parameter $ka$ are physically reasonable. **Pass.**\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n## Solution Derivation and Implementation\n\n### 1. Theoretical Framework\nThe problem concerns time-harmonic acoustic scattering, where the total acoustic pressure field $p(\\mathbf{x})$ is governed by the scalar Helmholtz equation:\n$$ \\nabla^2 p + k^2 p = 0 $$\nHere, $p$ is the complex pressure amplitude and $k$ is the acoustic wavenumber. The total field is the sum of the incident field $p_{\\text{inc}}$ and the scattered field $p_{\\text{scat}}$, i.e., $p = p_{\\text{inc}} + p_{\\text{scat}}$. The incident field is a plane wave propagating along the $z$-axis, which in spherical coordinates $(r, \\theta, \\phi)$ is given by $p_{\\text{inc}} = e^{ikz} = e^{ikr\\cos\\theta}$.\n\n### 2. Partial-Wave Expansion\nThe problem's spherical symmetry suggests a solution using separation of variables in spherical coordinates. The incident and scattered fields are expanded in a basis of spherical wave functions.\n\nThe incident plane wave has the standard expansion:\n$$ p_{\\text{inc}}(r, \\theta) = \\sum_{n=0}^{\\infty} (2n+1) i^n j_n(kr) P_n(\\cos\\theta) $$\nwhere $j_n$ are the spherical Bessel functions of the first kind and $P_n$ are the Legendre polynomials.\n\nThe scattered field must satisfy the Sommerfeld radiation condition, meaning it must behave as an outgoing wave at infinity. This dictates the use of spherical Hankel functions of the first kind, $h_n^{(1)}(kr) = j_n(kr) + i y_n(kr)$, where $y_n$ are the spherical Neumann functions. A common and convenient formulation for the scattered field is:\n$$ p_{\\text{scat}}(r, \\theta) = \\sum_{n=0}^{\\infty} (2n+1) i^n T_n h_n^{(1)}(kr) P_n(\\cos\\theta) $$\nThe dimensionless coefficients $T_n$ are the modal scattering coefficients (or T-matrix elements) to be determined by the boundary conditions on the sphere's surface at $r=a$.\n\nThe total pressure field is therefore:\n$$ p(r, \\theta) = \\sum_{n=0}^{\\infty} (2n+1) i^n \\left[ j_n(kr) + T_n h_n^{(1)}(kr) \\right] P_n(\\cos\\theta) $$\n\n### 3. Boundary Conditions\nDue to the orthogonality of the Legendre polynomials, the boundary condition must be satisfied for each mode $n$ independently.\n\n**Sound-Soft (Pressure-Release) Sphere:**\nThe boundary condition is a Dirichlet condition: $p(a, \\theta) = 0$. This requires the term in the brackets of the total pressure expansion to be zero for each $n$:\n$$ j_n(ka) + T_n^{\\text{soft}} h_n^{(1)}(ka) = 0 $$\nSolving for the coefficient $T_n^{\\text{soft}}$ gives:\n$$ T_n^{\\text{soft}} = - \\frac{j_n(ka)}{h_n^{(1)}(ka)} $$\n\n**Sound-Hard (Rigid) Sphere:**\nThe boundary condition is zero normal particle velocity. From Euler's linearized equation of motion, the acoustic particle velocity is $\\mathbf{v} = \\frac{\\nabla p}{i\\omega\\rho_0}$, where $\\rho_0$ is the fluid density and $\\omega=ck$ is the angular frequency. The normal velocity at the sphere's surface is the radial component, $v_r = \\frac{1}{i\\omega\\rho_0} \\frac{\\partial p}{\\partial r}$. The condition $v_r=0$ at $r=a$ is thus a Neumann condition: $\\frac{\\partial p}{\\partial r}|_{r=a} = 0$. Applying this to the series expansion yields:\n$$ \\frac{d}{dr}\\left[ j_n(kr) + T_n^{\\text{rigid}} h_n^{(1)}(kr) \\right]_{r=a} = 0 $$\n$$ k j_n'(ka) + k T_n^{\\text{rigid}} (h_n^{(1)})'(ka) = 0 $$\nwhere the prime denotes the derivative with respect to the argument. Solving for the coefficient $T_n^{\\text{rigid}}$ gives:\n$$ T_n^{\\text{rigid}} = - \\frac{j_n'(ka)}{(h_n^{(1)})'(ka)} $$\n\n### 4. Far-Field Scattering Amplitude\nThe far-field scattering amplitude $f(\\theta)$ is defined by the asymptotic behavior of the scattered field as $r \\to \\infty$:\n$$ p_{\\text{scat}}(r, \\theta) \\sim f(\\theta) \\frac{e^{ikr}}{r} $$\nThe asymptotic form of the spherical Hankel function for large argument is $h_n^{(1)}(kr) \\sim \\frac{1}{kr}(-i)^{n+1}e^{ikr}$. Substituting this into the expansion for $p_{\\text{scat}}$:\n$$ p_{\\text{scat}}(r, \\theta) \\sim \\sum_{n=0}^{\\infty} (2n+1) i^n T_n \\left( \\frac{(-i)^{n+1}}{kr}e^{ikr} \\right) P_n(\\cos\\theta) $$\nSince $i^n (-i)^{n+1} = i^n (-i)^n (-i) = -i$, we can rearrange to find $f(\\theta)$:\n$$ p_{\\text{scat}}(r, \\theta) \\sim \\frac{e^{ikr}}{r} \\left( \\frac{1}{k} \\sum_{n=0}^{\\infty} (2n+1) T_n P_n(\\cos\\theta) \\right) $$\nBy comparison, the scattering amplitude is:\n$$ f(\\theta) = \\frac{1}{k} \\sum_{n=0}^{\\infty} (2n+1) T_n P_n(\\cos\\theta) $$\n\n### 5. Forward-to-Backward Ratio\nThe problem requires the ratio of scattering intensities in the forward ($\\theta=0$) and backward ($\\theta=\\pi$) directions. We use the properties of Legendre polynomials: $P_n(\\cos 0) = P_n(1) = 1$ and $P_n(\\cos \\pi) = P_n(-1) = (-1)^n$.\n\nThe forward scattering amplitude is:\n$$ f(0) = \\frac{1}{k} \\sum_{n=0}^{\\infty} (2n+1) T_n (1) = \\frac{1}{k} \\sum_{n=0}^{\\infty} (2n+1) T_n $$\nThe backward scattering amplitude is:\n$$ f(\\pi) = \\frac{1}{k} \\sum_{n=0}^{\\infty} (2n+1) T_n (-1)^n $$\nThe forward-to-backward scattering intensity ratio $\\mathcal{R}$ is defined as:\n$$ \\mathcal{R} = \\frac{|f(0)|^2}{|f(\\pi)|^2} = \\frac{\\left| \\frac{1}{k} \\sum (2n+1) T_n \\right|^2}{\\left| \\frac{1}{k} \\sum (2n+1) T_n (-1)^n \\right|^2} = \\frac{\\left| \\sum_{n=0}^{\\infty} (2n+1) T_n \\right|^2}{\\left| \\sum_{n=0}^{\\infty} (2n+1) T_n (-1)^n \\right|^2} $$\nThe factor of $1/k$ cancels, simplifying the numerical computation.\n\n### 6. Numerical Implementation\nFor computation, the infinite series is truncated at an index $N_{\\max}$ determined by the rule:\n$$ N_{\\max} = \\max\\left(5, \\lceil ka + 4(ka)^{1/3} + 10 \\rceil\\right) $$\nThe sums for the ratio $\\mathcal{R}$ thus become:\n$$ \\mathcal{R} = \\frac{\\left| \\sum_{n=0}^{N_{\\max}} (2n+1) T_n \\right|^2}{\\left| \\sum_{n=0}^{N_{\\max}} (2n+1) T_n (-1)^n \\right|^2} $$\nThe implementation will calculate this quantity for both $T_n = T_n^{\\text{soft}}$ and $T_n = T_n^{\\text{rigid}}$ for each given value of $ka$. Special functions $j_n(x)$, $y_n(x)$, and their derivatives $j_n'(x)$, $y_n'(x)$ are available in the `scipy.special` library. The Hankel functions and their derivatives are constructed from these as $h_n^{(1)}(x) = j_n(x) + i y_n(x)$ and $(h_n^{(1)})'(x) = j_n'(x) + i y_n'(x)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn, spherical_yn\n\ndef calculate_n_max(ka_val):\n    \"\"\"\n    Calculates the truncation index N_max based on the given rule.\n    N_max = ceil(ka + 4*(ka)^(1/3) + 10), with a minimum of 5.\n    \"\"\"\n    if ka_val  0:\n        raise ValueError(\"ka must be non-negative.\")\n    # The term (ka)**(1/3) can result in complex numbers for negative ka if not handled.\n    # We ensure ka_val is float to avoid potential integer arithmetic issues.\n    n_max_calc = np.ceil(ka_val + 4 * np.power(ka_val, 1/3) + 10)\n    return int(max(5, n_max_calc))\n\ndef compute_scattering_ratio(ka_val, boundary_condition):\n    \"\"\"\n    Computes the forward-to-backward scattering intensity ratio R.\n\n    Args:\n        ka_val (float): The dimensionless size parameter.\n        boundary_condition (str): 'soft' for sound-soft (pressure-release) or\n                                  'rigid' for sound-hard.\n\n    Returns:\n        float: The computed ratio R.\n    \"\"\"\n    n_max = calculate_n_max(ka_val)\n    n = np.arange(0, n_max + 1)  # Array of orders from 0 to n_max\n\n    # Spherical Bessel and Neumann functions and their derivatives evaluated at ka\n    jn = spherical_jn(n, ka_val)\n    yn = spherical_yn(n, ka_val)\n    jn_p = spherical_jn(n, ka_val, derivative=True)\n    yn_p = spherical_yn(n, ka_val, derivative=True)\n\n    # Spherical Hankel function of the first kind and its derivative\n    # h_n^(1)(x) = j_n(x) + i * y_n(x)\n    hn = jn + 1j * yn\n    hn_p = jn_p + 1j * yn_p\n    \n    # Check for division by zero, which can occur if hn or hn_p is zero.\n    # This is highly unlikely for physical ka > 0 but is good practice.\n    if boundary_condition == 'soft':\n        # T_n = -j_n(ka) / h_n(ka)\n        # Avoid division by zero, although h_n(x) is zero only for x=0\n        with np.errstate(divide='raise', invalid='raise'):\n            try:\n                T_n = -jn / hn\n            except FloatingPointError:\n                # Replace NaNs or Infs from division by zero with 0\n                T_n = np.nan_to_num(-jn / hn)\n    elif boundary_condition == 'rigid':\n        # T_n = -j_n'(ka) / h_n'(ka)\n        with np.errstate(divide='raise', invalid='raise'):\n            try:\n                T_n = -jn_p / hn_p\n            except FloatingPointError:\n                T_n = np.nan_to_num(-jn_p / hn_p)\n    else:\n        raise ValueError(\"Invalid boundary condition specified.\")\n\n    # We compute the sums for the forward and backward scattering amplitudes.\n    # The 1/k prefactor cancels in the ratio R.\n    # Sum term is (2n+1) * T_n\n    sum_term = (2 * n + 1) * T_n\n\n    # Forward scattering sum: f(0) ~ sum_{n=0 to N_max} (2n+1)*T_n * P_n(1)\n    # Since P_n(1) = 1\n    f0_sum = np.sum(sum_term)\n\n    # Backward scattering sum: f(pi) ~ sum_{n=0 to N_max} (2n+1)*T_n * P_n(-1)\n    # Since P_n(-1) = (-1)^n\n    p_n_minus_one = (-1)**n\n    fpi_sum = np.sum(sum_term * p_n_minus_one)\n\n    # The ratio R = |f(0)|^2 / |f(pi)|^2\n    # The denominator |f(pi)|^2 should not be zero.\n    fpi_intensity = np.abs(fpi_sum)**2\n    if fpi_intensity == 0:\n        # This case would imply perfect nulling in the backward direction.\n        # It could lead to infinite R. Return a large number or handle as an error.\n        # For this problem, it is not expected to occur.\n        return np.inf\n\n    f0_intensity = np.abs(f0_sum)**2\n    R = f0_intensity / fpi_intensity\n    \n    return R\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    test_cases = [0.5, 1.0, 2.0, 5.0]\n    \n    results = []\n    \n    for ka in test_cases:\n        # Compute R for the sound-hard (rigid) sphere\n        R_rigid = compute_scattering_ratio(ka, 'rigid')\n        results.append(f\"{R_rigid:.6f}\")\n        \n        # Compute R for the sound-soft (pressure-release) sphere\n        R_soft = compute_scattering_ratio(ka, 'soft')\n        results.append(f\"{R_soft:.6f}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}