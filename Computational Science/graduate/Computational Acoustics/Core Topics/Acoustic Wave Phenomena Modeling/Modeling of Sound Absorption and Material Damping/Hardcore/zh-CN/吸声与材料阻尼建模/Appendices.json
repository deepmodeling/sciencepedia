{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨流体介质内部的固有声衰减机制。您将从基本的线性化守恒定律出发，推导经典的斯托克斯-基尔霍夫（Stokes-Kirchhoff）公式，该公式量化了剪切粘度和热导率如何导致无界介质中声能的耗散。这种第一性原理的推导有助于深入理解像空气这样的气体中声音吸收的物理起源。",
            "id": "4129885",
            "problem": "考虑一列角频率为 $\\,\\omega=2\\pi f\\,$ 的一维平面行进声波，在环境条件为 $\\,(p_{0},T_{0})\\,$ 的静止空气中传播，空气被建模为理想气体，其比热比为 $\\gamma$，气体常数为 $R$。考虑剪切黏度和热导率的影响，忽略体积黏度和分子弛豫。从线性化的质量守恒、动量守恒（牛顿黏性应力）和能量守恒（傅里叶热传导）方程以及理想气体状态方程出发，推导在小耗散主导项下，作为复波数 $\\,k(\\omega)\\,$ 虚部的平面波衰减系数 $\\,\\alpha\\,$（单位：奈培/米）。然后用你的结果求出每波长衰减，定义为无量纲量 $\\,\\alpha \\lambda\\,$，其中 $\\,\\lambda\\,$ 是给定频率下的波长。\n\n给定室温条件下空气的以下数据：\n- 频率 $\\,f=1.0\\times 10^{3}\\ \\mathrm{s}^{-1}$，\n- 剪切（动力）黏度 $\\,\\mu=1.84\\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$，\n- 热导率 $\\,\\kappa=2.60\\times 10^{-2}\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，\n- 比热比 $\\,\\gamma=1.4$，\n- 气体常数 $\\,R=287.05\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，\n- 环境压力 $\\,p_{0}=1.01325\\times 10^{5}\\ \\mathrm{Pa}$，\n- 环境温度 $\\,T_{0}=293.15\\ \\mathrm{K}$。\n\n假设定压比热 $\\,c_{p}\\,$ 是由 $\\,\\gamma$ 和 $R$ 决定的理想气体的值。计算并报告在 $\\,f=1\\ \\mathrm{kHz}\\,$ 时每波长的衰减 $\\,\\alpha\\lambda\\,$，并将其与无损耗预测进行简要比较。将最终的每波长衰减表示为一个纯数（奈培/波长），并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导在有黏性和热传导的理想气体中平面行进声波的衰减系数，然后根据给定条件对空气中每波长的衰减进行数值计算。\n\n出发点是线性化的一维质量、动量和能量守恒方程，以及理想气体状态方程。设密度、压力、温度和流体速度（$x$ 方向）的声学扰动分别表示为 $\\rho'$、 $p'$、 $T'$ 和 $u$。环境状态是静止且均匀的，其特征为密度 $\\rho_0$、压力 $p_0$ 和温度 $T_0$。\n\n线性化的控制方程为：\n1. 质量守恒：\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u}{\\partial x} = 0 $$\n2. 动量守恒（Navier-Stokes 方程）：对于一维运动，涉及剪切黏度 $\\mu$ 的黏性应力项为 $\\frac{4}{3}\\mu \\frac{\\partial^2 u}{\\partial x^2}$。根据题目要求，忽略体积黏度。\n$$ \\rho_0 \\frac{\\partial u}{\\partial t} = -\\frac{\\partial p'}{\\partial x} + \\frac{4}{3}\\mu \\frac{\\partial^2 u}{\\partial x^2} $$\n3. 能量守恒：对于理想气体，这可以用温度 $T'$ 和压力 $p'$ 的扰动来表示，其中包括傅里叶热传导定律（热导率为 $\\kappa$）。定压比热为 $c_p$。\n$$ \\rho_0 c_p \\frac{\\partial T'}{\\partial t} - \\frac{\\partial p'}{\\partial t} = \\kappa \\frac{\\partial^2 T'}{\\partial x^2} $$\n4. 状态方程（理想气体定律）：对于小扰动，$p = p_0+p'$，$\\rho = \\rho_0+\\rho'$，$T = T_0+T'$。其线性化形式为：\n$$ \\frac{p'}{p_0} = \\frac{\\rho'}{\\rho_0} + \\frac{T'}{T_0} $$\n\n我们寻求形式为 $q'(x,t) = \\hat{q} \\exp[i(kx - \\omega t)]$ 的平面行进波解，其中 $q'$ 代表任何扰动变量，$\\hat{q}$ 是其复振幅。为了确保沿 $+x$ 方向传播的波会衰减，我们设复波数 $k = k_r + i\\alpha$，其中 $k_r$ 是波数的实部，$\\alpha > 0$ 是衰减系数。在此约定下，波的形式为 $\\exp[i((k_r+i\\alpha)x - \\omega t)] = \\exp(-\\alpha x) \\exp[i(k_r x - \\omega t)]$，表示振幅随 $x$ 指数衰减。\n\n将平面波形式代入线性化方程，可将偏微分方程组转化为关于振幅 $\\hat{\\rho}$、$\\hat{u}$、$\\hat{T}$ 和 $\\hat{p}$ 的代数方程组：\n1'. $-i\\omega \\hat{\\rho} + i k \\rho_0 \\hat{u} = 0 \\implies \\hat{\\rho} = \\frac{\\rho_0 k}{\\omega} \\hat{u}$\n2'. $-i\\omega \\rho_0 \\hat{u} = -ik\\hat{p} + \\frac{4}{3}\\mu (ik)^2 \\hat{u} \\implies \\left( -i\\omega\\rho_0 + \\frac{4}{3}\\mu k^2 \\right) \\hat{u} = -ik\\hat{p}$\n3'. $-i\\omega \\rho_0 c_p \\hat{T} + i\\omega \\hat{p} = \\kappa(ik)^2 \\hat{T} \\implies \\left( -i\\omega\\rho_0 c_p + \\kappa k^2 \\right) \\hat{T} = -i\\omega\\hat{p}$\n4'. $\\frac{\\hat{p}}{p_0} = \\frac{\\hat{\\rho}}{\\rho_0} + \\frac{\\hat{T}}{T_0}$\n\n为了找到色散关系 $k(\\omega)$，我们必须消去这些振幅。从 $(2')$ 和 $(3')$，我们可以用 $\\hat{p}$ 来表示 $\\hat{u}$ 和 $\\hat{T}$：\n$$ \\hat{u} = \\frac{-ik\\hat{p}}{-i\\omega\\rho_0 + \\frac{4}{3}\\mu k^2} $$\n$$ \\hat{T} = \\frac{-i\\omega\\hat{p}}{-i\\omega\\rho_0 c_p + \\kappa k^2} $$\n现在，将这些代入 $(1')$ 中的 $\\hat{\\rho}$ 表达式，然后代入 $(4')$ 中的 $\\hat{p}$ 表达式：\n$$ \\hat{\\rho} = \\frac{\\rho_0 k}{\\omega} \\hat{u} = \\frac{\\rho_0 k}{\\omega} \\frac{-ik\\hat{p}}{-i\\omega\\rho_0 + \\frac{4}{3}\\mu k^2} = \\frac{-i\\rho_0 k^2 \\hat{p}}{\\omega(-i\\omega\\rho_0 + \\frac{4}{3}\\mu k^2)} $$\n将 $\\hat{\\rho}$ 和 $\\hat{T}$ 代入线性化状态方程 $(4')$，并除以 $\\hat{p}$：\n$$ \\frac{1}{p_0} = \\frac{\\hat{\\rho}}{\\rho_0 \\hat{p}} + \\frac{\\hat{T}}{T_0 \\hat{p}} = \\frac{-ik^2}{\\omega(-i\\omega\\rho_0 + \\frac{4}{3}\\mu k^2)} + \\frac{-i\\omega}{T_0(-i\\omega\\rho_0 c_p + \\kappa k^2)} $$\n这是该系统的精确色散关系。为了求解小耗散主导项下的 $k$，我们假设 $\\mu$ 和 $\\kappa$ 很小。这意味着波的性质接近于理想无损耗情况，即 $k \\approx k_0 = \\omega/c_0$，其中 $c_0 = \\sqrt{\\gamma R T_0}$ 是等熵声速。\n重新整理方程，并提取公共因子：\n$$ \\frac{1}{p_0} = \\frac{k^2}{\\omega^2 \\rho_0 (1 + i \\frac{4\\mu k^2}{3\\omega \\rho_0})} + \\frac{1}{\\rho_0 c_p T_0 (1 + i \\frac{\\kappa k^2}{\\omega\\rho_0 c_p})} $$\n使用 $p_0 = \\rho_0 R T_0$、$c_p = \\frac{\\gamma R}{\\gamma-1}$ 和 $c_0^2 = \\gamma R T_0 = \\frac{\\gamma p_0}{\\rho_0}$。\n对于小的 $x$，使用近似 $(1+ix)^{-1} \\approx 1-ix$，并在小的修正项中近似 $k^2 \\approx k_0^2 = \\omega^2/c_0^2$：\n$$ \\frac{\\gamma}{\\rho_0 c_0^2} \\approx \\frac{k^2}{\\omega^2 \\rho_0}\\left(1-i\\frac{4\\mu\\omega}{3\\rho_0 c_0^2}\\right) + \\frac{\\gamma-1}{\\rho_0 c_0^2}\\left(1-i\\frac{\\kappa\\omega}{\\rho_0 c_p c_0^2}\\right) $$\n这里我们使用了 $\\rho_0 c_p T_0 = \\rho_0 \\left(\\frac{\\gamma R}{\\gamma-1}\\right) T_0 = \\frac{\\gamma}{\\gamma-1} p_0 = \\frac{\\rho_0 c_0^2}{\\gamma-1}$。\n分离 $k^2$ 项：\n$$ \\frac{k^2}{\\omega^2} \\left(1-i\\frac{4\\mu\\omega}{3\\rho_0 c_0^2}\\right) \\approx \\frac{\\gamma}{c_0^2} - \\frac{\\gamma-1}{c_0^2}\\left(1-i\\frac{\\kappa\\omega}{\\rho_0 c_p c_0^2}\\right) \\approx \\frac{1}{c_0^2} + i\\frac{(\\gamma-1)\\kappa\\omega}{\\rho_0 c_p c_0^4} $$\n$$ k^2 \\approx \\frac{\\omega^2}{c_0^2} \\left(1+i\\frac{4\\mu\\omega}{3\\rho_0 c_0^2}\\right) \\left(1 + i\\frac{(\\gamma-1)\\kappa\\omega}{\\rho_0 c_p c_0^2}\\right) $$\n忽略高阶小量，得到：\n$$ k^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 + i \\frac{\\omega}{\\rho_0 c_0^2} \\left( \\frac{4\\mu}{3} + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) \\right] $$\n设方括号中的项为 $1+i\\epsilon$。则 $k = \\frac{\\omega}{c_0}\\sqrt{1+i\\epsilon} \\approx \\frac{\\omega}{c_0}(1+\\frac{i\\epsilon}{2})$。\n$k \\approx \\frac{\\omega}{c_0} + i \\frac{\\omega}{2c_0} \\frac{\\omega}{\\rho_0 c_0^2} \\left( \\frac{4\\mu}{3} + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) = \\frac{\\omega}{c_0} + i \\frac{\\omega^2}{2\\rho_0 c_0^3} \\left( \\frac{4\\mu}{3} + \\frac{(\\gamma-1)\\kappa}{c_p} \\right)$。\n因此，衰减系数 $\\alpha = \\text{Im}(k)$ 为：\n$$ \\alpha = \\frac{\\omega^2}{2\\rho_0 c_0^3} \\left( \\frac{4}{3}\\mu + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n这是 Stokes-Kirchhoff 衰减公式。\n\n问题要求的是每波长衰减 $\\alpha\\lambda$。波长为 $\\lambda = 2\\pi/k_r$。对于小耗散，$k_r \\approx k_0 = \\omega/c_0$。\n$$ \\lambda \\approx \\frac{2\\pi c_0}{\\omega} $$\n每波长的衰减为：\n$$ \\alpha\\lambda \\approx \\left[ \\frac{\\omega^2}{2\\rho_0 c_0^3} \\left( \\frac{4\\mu}{3} + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) \\right] \\left(\\frac{2\\pi c_0}{\\omega}\\right) = \\frac{\\pi\\omega}{\\rho_0 c_0^2} \\left( \\frac{4\\mu}{3} + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n使用 $\\rho_0 c_0^2 = \\gamma p_0$ 和 $\\omega=2\\pi f$，上式变为：\n$$ \\alpha\\lambda = \\frac{2\\pi^2 f}{\\gamma p_0} \\left( \\frac{4}{3}\\mu + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\n\n现在我们使用所提供的空气数据计算数值：\n- $f = 1.0 \\times 10^3\\ \\mathrm{s}^{-1}$\n- $\\mu = 1.84 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$\n- $\\kappa = 2.60 \\times 10^{-2}\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n- $\\gamma = 1.4$\n- $R = 287.05\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $p_0 = 1.01325 \\times 10^5\\ \\mathrm{Pa}$\n- $T_0 = 293.15\\ \\mathrm{K}$\n\n首先，我们计算理想气体的 $c_p$：\n$$ c_p = \\frac{\\gamma R}{\\gamma-1} = \\frac{1.4 \\times 287.05}{1.4 - 1} = 1004.675\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n现在我们将所有值代入 $\\alpha\\lambda$ 的表达式中：\n$$ \\alpha\\lambda = \\frac{2\\pi^2 (1.0 \\times 10^3)}{1.4 \\times (1.01325 \\times 10^5)} \\left[ \\frac{4}{3}(1.84 \\times 10^{-5}) + \\frac{(1.4-1)(2.60 \\times 10^{-2})}{1004.675} \\right] $$\n我们来计算括号中的各项：\n- 黏性贡献：$\\frac{4}{3}\\mu = \\frac{4}{3}(1.84 \\times 10^{-5}) \\approx 2.45333 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$\n- 热学贡献：$\\frac{(\\gamma-1)\\kappa}{c_p} = \\frac{0.4 \\times 0.026}{1004.675} \\approx 1.03516 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$\n这两项之和为 $3.4885 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$。\n\n前置因子为：\n$$ \\frac{2\\pi^2 f}{\\gamma p_0} = \\frac{2\\pi^2 (1000)}{1.4 \\times 101325} \\approx \\frac{19739.21}{141855} \\approx 0.13915\\ \\mathrm{m}^2\\,\\mathrm{N}^{-1}\\,\\mathrm{s}^{-1} $$\n将前置因子与括号内的项相乘：\n$$ \\alpha\\lambda \\approx 0.13915 \\times (3.4885 \\times 10^{-5}) \\approx 4.85396 \\times 10^{-6} $$\n结果是一个无量纲量（奈培/波长）。四舍五入到四位有效数字得到 $4.854 \\times 10^{-6}$。\n\n最后，我们将此结果与无损耗预测进行比较。在理想的、无黏性的、非热传导的气体中，$\\mu$ 和 $\\kappa$ 均为零。从推导出的公式可知，如果 $\\mu=0$ 且 $\\kappa=0$，则 $\\alpha=0$，因此 $\\alpha\\lambda=0$。无损耗模型预测衰减为零，意味着波在传播过程中振幅没有任何损失。我们的计算显示，每波长的衰减虽然非常小但非零，约为 $4.854 \\times 10^{-6}$ 奈培。这个小值证实了对于空气中的可闻频率，黏性损耗和热损耗都很弱，这为推导中使用“小耗散”近似提供了依据。",
            "answer": "$$\\boxed{4.854 \\times 10^{-6}}$$"
        },
        {
            "introduction": "从无界介质转向导波，本练习聚焦于管道中的声衰减，此时边界效应变得至关重要。您将研究管壁上的无滑移和等温条件如何产生粘性边界层和热边界层，从而耗散声能。此问题阐明了一种常见情况，即边界现象而非介质的固有属性主导了吸收特性。",
            "id": "4129911",
            "problem": "一个半径为 $a = 5 \\times 10^{-3}\\ \\mathrm{m}$ 的刚性导热圆管中充满了处于环境条件下的静止空气。一个频率为 $f = 2.0 \\times 10^{3}\\ \\mathrm{Hz}$ 的小振幅轴对称平面声波沿 $x$ 方向传播。对该传播过程进行建模，考虑空气的粘性效应和热效应，以及无滑移、等温的壁面边界条件。使用以下代表 $T \\approx 293\\ \\mathrm{K}$ 的空气属性：比热比 $\\gamma = 1.4$，声速 $c_{0} = 343\\ \\mathrm{m/s}$，运动粘度 $\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$，以及热扩散率 $\\alpha = 2.15 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$。假设为线性声学，并采用 $\\exp(-i \\omega t)$ 的时谐约定。\n\n从线性化的质量、动量（包括粘性应力）和能量（包括热传导）守恒方程出发，推导圆形管道中基频平面模式的复轴向波数 $k$ 的色散关系，并用横截面热粘性修正函数表示。在边界层相对于半径很薄的极限情况下，论证这些修正函数的主阶近似的合理性，并获得衰减系数（相对于无损耗平面波预测的额外衰减）作为 $k$ 的虚部的显式近似表达式。\n\n计算在指定频率和半径下，空气中单位长度的额外衰减，并以奈培/米（Np/m）为单位表示最终数值答案。将答案四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个热粘性声学问题。\n\n### **问题验证**\n\n**步骤1：提取给定条件**\n\n*   管半径：$a = 5 \\times 10^{-3}\\ \\mathrm{m}$\n*   频率：$f = 2.0 \\times 10^{3}\\ \\mathrm{Hz}$\n*   比热比：$\\gamma = 1.4$\n*   自由空间声速：$c_{0} = 343\\ \\mathrm{m/s}$\n*   运动粘度：$\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$\n*   热扩散率：$\\alpha = 2.15 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$\n*   空气的环境条件，$T \\approx 293\\ \\mathrm{K}$\n*   传播方向：$x$ 方向\n*   波类型：小振幅、轴对称平面声波\n*   几何形状：刚性、导热圆管\n*   边界条件：在壁面 ($r=a$) 处无滑移 ($\\mathbf{v}' = 0$) 和等温 ($T' = 0$)\n*   时谐约定：$\\exp(-i \\omega t)$\n*   目标量：额外衰减系数，$A_e = \\mathrm{Im}(k)$，单位为奈培/米 (Np/m)\n\n**步骤2：使用提取的给定条件进行验证**\n\n*   **科学依据**：该问题是 Kirchhoff-Helmholtz 管道声传播理论的标准应用，该理论是热粘性声学的基石。它基于线性化的 Navier-Stokes 方程、连续性方程和能量守恒方程。所有物理参数对于标准温度和压力下的空气都是现实的。该问题在科学上是合理的。\n*   **适定性**：该问题是适定的。它要求在给定的一组明确定义的物理条件下，计算一个特定的、可计算的量（衰减系数），用于基频声学模式。存在唯一且稳定的解。\n*   **客观性**：问题以精确、客观和定量的术语陈述。没有歧义或主观语言。\n*   **其他缺陷**：该问题没有违反任何指定的无效标准。它是完整的、一致的、现实的且非平凡的。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### **详细解答**\n\n在粘性和导热流体中，小振幅、轴对称声波的传播由线性化的质量、动量和能量方程控制。假设时谐依赖关系为 $\\exp(-i\\omega t)$ 形式，其中 $\\omega = 2\\pi f$ 是角频率，可以求解这些方程得到复轴向波数 $k$。对于半径为 $a$ 的刚性等温圆管中的基频（平面）波模式，精确的色散关系由 Kirchhoff-Helmholtz 理论给出：\n$$ k^2 = k_0^2 \\frac{1 + (\\gamma - 1) F_t(\\xi_t)}{1 - F_v(\\xi_v)} $$\n其中 $k_0 = \\omega/c_0$ 是自由空间波数，$\\gamma$ 是比热比。\n\n项 $F_v$ 和 $F_t$ 是横截面热粘性修正函数，它们说明了管壁处粘性边界层和热边界层的影响。对于圆形横截面，它们用第一类 Bessel 函数（$J_0$ 和 $J_1$）定义：\n$$ F_v(\\xi_v) = \\frac{2 J_1(i\\xi_v)}{i\\xi_v J_0(i\\xi_v)} \\quad \\text{和} \\quad F_t(\\xi_t) = \\frac{2 J_1(i\\xi_t)}{i\\xi_t J_0(i\\xi_t)} $$\n这些函数的自变量是无量纲参数 $\\xi_v$ 和 $\\xi_t$，它们将管半径与特征粘性边界层和热边界层厚度联系起来：\n$$ \\xi_v = a\\sqrt{\\frac{\\omega}{\\nu}} \\quad \\text{和} \\quad \\xi_t = a\\sqrt{\\frac{\\omega}{\\alpha}} $$\n注意 Bessel 函数的自变量是复数，$i\\xi_v = a\\sqrt{i^2\\omega/\\nu} = a \\sqrt{-\\omega/\\nu}$。另一种更常见的表述使用自变量 $k_v a$ 和 $k_t a$，其中 $k_v = \\sqrt{i\\omega/\\nu}$ 和 $k_t = \\sqrt{i\\omega/\\alpha}$。这给出：\n$$ F_v(k_v a) = \\frac{2 J_1(k_v a)}{k_v a J_0(k_v a)} \\quad \\text{和} \\quad F_t(k_t a) = \\frac{2 J_1(k_t a)}{k_t a J_0(k_t a)} $$\n色散关系保持为 $k^2 = k_0^2 [1 + (\\gamma-1)F_t] / [1 - F_v]$。\n\n问题要求在薄边界层极限下的解，这对应于宽管或高频极限。当边界层厚度 $\\delta_v = \\sqrt{2\\nu/\\omega}$ (粘性) 和 $\\delta_t = \\sqrt{2\\alpha/\\omega}$ (热) 远小于管半径 $a$ 时，此近似有效。让我们用给定的参数验证这个条件。\n\n首先，我们计算 $\\omega$：\n$$ \\omega = 2\\pi f = 2\\pi (2.0 \\times 10^3\\ \\mathrm{Hz}) = 4000\\pi\\ \\mathrm{rad/s} \\approx 12566\\ \\mathrm{rad/s} $$\n接下来，计算边界层厚度：\n$$ \\delta_v = \\sqrt{\\frac{2\\nu}{\\omega}} = \\sqrt{\\frac{2(1.50 \\times 10^{-5}\\ \\mathrm{m^2/s})}{4000\\pi\\ \\mathrm{rad/s}}} \\approx 4.88 \\times 10^{-5}\\ \\mathrm{m} $$\n$$ \\delta_t = \\sqrt{\\frac{2\\alpha}{\\omega}} = \\sqrt{\\frac{2(2.15 \\times 10^{-5}\\ \\mathrm{m^2/s})}{4000\\pi\\ \\mathrm{rad/s}}} \\approx 5.85 \\times 10^{-5}\\ \\mathrm{m} $$\n与半径 $a = 5 \\times 10^{-3}\\ \\mathrm{m}$ 的比值为：\n$$ \\frac{\\delta_v}{a} \\approx \\frac{4.88 \\times 10^{-5}}{5 \\times 10^{-3}} \\approx 0.00976 \\ll 1 $$\n$$ \\frac{\\delta_t}{a} \\approx \\frac{5.85 \\times 10^{-5}}{5 \\times 10^{-3}} \\approx 0.0117 \\ll 1 $$\n薄边界层条件得到了很好的满足。这证明了对修正函数使用渐近近似是合理的。贝塞尔函数的自变量为 $|k_v a| = a\\sqrt{\\omega/\\nu} = a/(\\delta_v/\\sqrt{2}) = a\\sqrt{2}/\\delta_v \\approx 145 \\gg 1$ 和 $|k_t a| = a\\sqrt{2}/\\delta_t \\approx 121 \\gg 1$。对于一个模很大且幅角为 $\\mathrm{arg}(z) = \\pi/4$ 的复自变量 $z$，例如 $k_v a = a\\sqrt{i\\omega/\\nu} = a(1+i)/\\delta_v$，Bessel 函数比的渐近行为是：\n$$ \\frac{J_1(z)}{J_0(z)} \\to i \\quad \\text{当} \\quad |z| \\to \\infty $$\n将此近似应用于修正函数 $F_v$ 和 $F_t$：\n$$ F_v(k_v a) \\approx \\frac{2i}{k_v a} \\quad \\text{和} \\quad F_t(k_t a) \\approx \\frac{2i}{k_t a} $$\n将这些近似代入色散关系：\n$$ k^2 \\approx k_0^2 \\frac{1 + (\\gamma - 1) \\frac{2i}{k_t a}}{1 - \\frac{2i}{k_v a}} $$\n由于修正项的模很小 $(|2i/(k_v a)| = \\sqrt{2}\\delta_v/a \\ll 1)$，我们可以使用二项式近似 $(1-x)^{-1} \\approx 1+x$：\n$$ k^2 \\approx k_0^2 \\left(1 + (\\gamma - 1) \\frac{2i}{k_t a}\\right) \\left(1 + \\frac{2i}{k_v a}\\right) $$\n展开并忽略二阶项（两个修正项的乘积）：\n$$ k^2 \\approx k_0^2 \\left(1 + \\frac{2i(\\gamma - 1)}{k_t a} + \\frac{2i}{k_v a}\\right) $$\n现在，取平方根并对小的 $\\epsilon$ 使用近似 $\\sqrt{1+\\epsilon} \\approx 1+\\epsilon/2$：\n$$ k \\approx k_0 \\left(1 + \\frac{i(\\gamma - 1)}{k_t a} + \\frac{i}{k_v a}\\right) $$\n为了求得衰减，我们代入 $k_v = (1+i)/\\delta_v$ 和 $k_t = (1+i)/\\delta_t$：\n$$ \\frac{1}{k_v a} = \\frac{\\delta_v}{a(1+i)} = \\frac{\\delta_v(1-i)}{2a} $$\n$$ \\frac{1}{k_t a} = \\frac{\\delta_t}{a(1+i)} = \\frac{\\delta_t(1-i)}{2a} $$\n将这些代入 $k$ 的表达式中：\n$$ k \\approx k_0 \\left(1 + \\frac{i(\\gamma-1)\\delta_t(1-i)}{2a} + \\frac{i\\delta_v(1-i)}{2a} \\right) $$\n$$ k \\approx k_0 \\left(1 + \\frac{(\\gamma-1)\\delta_t(i+1)}{2a} + \\frac{\\delta_v(i+1)}{2a} \\right) $$\n$$ k \\approx k_0 \\left(1 + \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a} (1+i) \\right) $$\n$$ k \\approx \\frac{\\omega}{c_0} \\left( \\left[1 + \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a}\\right] + i \\left[\\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a}\\right] \\right) $$\n复波数为 $k = \\beta + iA$，其中 $\\beta$ 是传播常数，A 是衰减系数。问题要求的是额外衰减，即 $k$ 的虚部。\n$$ A = \\mathrm{Im}(k) = \\frac{\\omega}{c_0} \\left( \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a} \\right) $$\n代入 $\\delta_t$ 和 $\\delta_v$ 的定义：\n$$ A = \\frac{\\omega}{2ac_0} \\left( (\\gamma-1)\\sqrt{\\frac{2\\alpha}{\\omega}} + \\sqrt{\\frac{2\\nu}{\\omega}} \\right) $$\n$$ A = \\frac{\\sqrt{\\omega}}{2ac_0} \\left( (\\gamma-1)\\sqrt{2\\alpha} + \\sqrt{2\\nu} \\right) = \\frac{\\sqrt{2\\omega}}{2ac_0} \\left( (\\gamma-1)\\sqrt{\\alpha} + \\sqrt{\\nu} \\right) $$\n这就是衰减系数的显式近似表达式。现在我们计算数值。\n\n给定值：\n$\\omega = 4000\\pi\\ \\mathrm{rad/s}$\n$a = 5 \\times 10^{-3}\\ \\mathrm{m}$\n$c_0 = 343\\ \\mathrm{m/s}$\n$\\gamma = 1.4$\n$\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m^2/s}$\n$\\alpha = 2.15 \\times 10^{-5}\\ \\mathrm{m^2/s}$\n\n$$ A = \\frac{\\sqrt{2 (4000\\pi)}}{2 (5 \\times 10^{-3}) (343)} \\left( (1.4 - 1) \\sqrt{2.15 \\times 10^{-5}} + \\sqrt{1.50 \\times 10^{-5}} \\right) $$\n$$ A = \\frac{\\sqrt{8000\\pi}}{3.43} \\left( 0.4 \\sqrt{2.15 \\times 10^{-5}} + \\sqrt{1.50 \\times 10^{-5}} \\right) $$\n我们来计算各项：\n$$ \\sqrt{8000\\pi} \\approx 158.53309 $$\n$$ \\sqrt{2.15 \\times 10^{-5}} \\approx 0.004636809 $$\n$$ \\sqrt{1.50 \\times 10^{-5}} \\approx 0.003872983 $$\n$$ A \\approx \\frac{158.53309}{3.43} \\left( 0.4 \\times 0.004636809 + 0.003872983 \\right) $$\n$$ A \\approx 46.21956 \\left( 0.001854724 + 0.003872983 \\right) $$\n$$ A \\approx 46.21956 \\left( 0.005727707 \\right) $$\n$$ A \\approx 0.264713\\ \\mathrm{Np/m} $$\n四舍五入到四位有效数字，额外衰减为 $0.2647\\ \\mathrm{Np/m}$。",
            "answer": "$$\\boxed{0.2647}$$"
        },
        {
            "introduction": "在探究了阻尼的物理模型之后，确保其在计算代码中的正确实现至关重要。本实践练习介绍了“制造解方法”（Method of Manufactured Solutions, MMS），这是一种用于软件验证的严谨技术。您将设计一个具有已知解析解的测试用例，以验证求解带阻尼的亥姆霍兹方程的有限差分代码，从而系统地检查材料阻尼和边界吸收的实现情况。",
            "id": "4129953",
            "problem": "考虑由线性亥姆霍兹方程控制的一维频域声压场，其中材料阻尼通过复波数建模。在域 $[0,L]$ 上，外单位法向量在 $x=0$ 处指向 $x$ 减小的方向，在 $x=L$ 处指向 $x$ 增大的方向，模型问题为\n$$\n\\frac{d^2 u}{dx^2} + k^2 u = f(x), \\quad x \\in (0,L),\n$$\n两端均受阻抗边界条件约束，\n$$\n\\frac{\\partial u}{\\partial n}(0) + i k Z_0 u(0) = g_0, \\quad \\frac{\\partial u}{\\partial n}(L) + i k Z_L u(L) = g_L,\n$$\n其中 $u$ 是复声压幅值，$k \\in \\mathbb{C}$ 是复波数（其虚部表示材料阻尼），$Z_0,Z_L \\in \\mathbb{C}$ 是归一化边界阻抗，$i$ 是虚数单位。外法向导数为 $\\frac{\\partial u}{\\partial n}(0)=-\\frac{du}{dx}(0)$ 和 $\\frac{\\partial u}{\\partial n}(L)=+\\frac{du}{dx}(L)$。设计一个构造解，以验证数值代码中材料阻尼和阻抗吸收的实现，并计算观测精度阶。\n\n从适用于频域声学的基本原理出发：在假设角频率为 $\\omega$ 的谐波时间依赖性并消去速度后，线性化的连续性方程和动量方程可推导出一个空间亥姆霍兹方程，其复波数 $k$ 在 $\\operatorname{Im}(k)>0$ 时可以表示衰减。阻抗边界条件强制声压与法向质点速度成正比，在此公式中，这简化为罗宾条件 $\\frac{\\partial u}{\\partial n} + i k Z u = g$。\n\n您的任务是：\n\n- 使用构造解法选择一个精确解 $u_{\\text{ex}}(x)$，并推导出相应的源项 $f(x)$ 和边界数据 $g_0, g_L$，使得 $u_{\\text{ex}}$ 对任意复边界阻抗 $Z_0, Z_L$ 都能满足该模型。\n- 在具有 $N+1$ 个网格点、间距为 $h=L/N$ 的均匀网格上，使用二阶中心有限差分离散内部微分算子。使用二阶单边有限差分离散边界法向导数。组合并求解得到的线性系统，以获得 $u$ 的节点值。\n- 计算数值解与精确构造解之间的离散 $L^2$ 误差，\n$$\n\\|e\\|_{h} = \\left( h \\sum_{j=0}^{N} \\left| u_j - u_{\\text{ex}}(x_j) \\right|^2 \\right)^{1/2},\n$$\n其中 $x_j = j h$。对于一系列 $N$ 加倍的网格加密，估算连续网格之间的观测精度阶 (OOA) 为\n$$\np \\approx \\frac{\\log\\left(\\|e\\|_{h_1}/\\|e\\|_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\n\n构造解设计要求：\n- 取 $u_{\\text{ex}}(x) = e^{i k x}$，其中给定 $k \\in \\mathbb{C}$。推导 $f(x)$、$g_0$ 和 $g_L$，使得 $u_{\\text{ex}}$ 对任意 $Z_0, Z_L$ 都能精确满足问题。\n\n数值离散化要求：\n- 对于内部点 $x_j$ ($j=1,\\dots,N-1$)，必须对 $\\frac{d^2 u}{dx^2}$ 使用标准的二阶中心有限差分。\n- 边界条件必须对一阶导数使用与 $x=0$ 和 $x=L$ 处的外法线一致的二阶单边差分。\n\n测试套件：\n对于下述每个测试用例，使用指定的参数和网格，计算每个网格上的 $L^2$ 误差，并报告在每个用例中最后两次网格加密之间计算出的观测精度阶。\n\n- 用例 1（一般情况，中等阻尼和混合阻抗）：$L=1$，$k = 20 + 2 i$，$Z_0 = 0.7 + 0.2 i$，$Z_L = 1.3 - 0.1 i$，其中 $N \\in \\{ 50, 100, 200, 400 \\}$。\n- 用例 2（短域，较强阻尼）：$L=0.2$，$k = 30 + 5 i$，$Z_0 = 2.0 + 0.0 i$，$Z_L = 0.5 + 0.5 i$，其中 $N \\in \\{ 40, 80, 160, 320 \\}$。\n- 用例 3（弱阻尼，对称阻抗）：$L=1.0$，$k = 40 + 0.1 i$，$Z_0 = 1.0 + 0.0 i$，$Z_L = 1.0 + 0.0 i$，其中 $N \\in \\{ 80, 160, 320, 640 \\}$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。第 $j$ 个条目必须是为用例 $j$ 计算的观测精度阶，按用例 1、2、3 的顺序排列，并四舍五入到三位小数。例如：形如 `[2.000,2.000,2.000]` 的字符串。",
            "solution": "该问题要求设计并验证一种用于一维亥姆霍兹方程的数值方法，该方程模拟了时谐声压场。该模型通过复波数包含了材料阻尼，并通过阻抗条件包含了边界处的能量吸收。验证将使用构造解法 (Method of Manufactured Solutions, MMS) 进行。\n\n该过程包括三个主要部分：\n1.  **解析推导**：选择一个精确解，即“构造”解。将此解代入控制偏微分方程 (PDE) 和边界条件 (BCs) 中，以推导相应的源项 $f(x)$ 和边界数据 $g_0$ 和 $g_L$。\n2.  **数值离散化**：使用均匀网格上的有限差分法，将连续问题近似为线性代数方程组。\n3.  **验证**：对一系列加密的网格实施并求解数值格式。计算数值解与精确解之间的误差，并估计观测精度阶 (OOA)，以验证该实现达到了理论收敛率。\n\n**1. 通过构造解法进行推导**\n\n在域 $x \\in [0,L]$ 上的控制模型为：\n$$\n\\frac{d^2 u}{dx^2} + k^2 u = f(x)\n$$\n$$\n-\\frac{du}{dx}(0) + i k Z_0 u(0) = g_0\n$$\n$$\n\\frac{du}{dx}(L) + i k Z_L u(L) = g_L\n$$\n此处，$k, Z_0, Z_L$ 是复常数，外法向导数被正确指定为 $\\frac{\\partial u}{\\partial n}(0) = -\\frac{du}{dx}(0)$ 和 $\\frac{\\partial u}{\\partial n}(L) = \\frac{du}{dx}(L)$。\n\n给定构造解 $u_{\\text{ex}}(x) = e^{i k x}$。我们必须找到 $f(x)$、$g_0$ 和 $g_L$，使得 $u_{\\text{ex}}$ 是该问题的精确解。\n\n首先，我们求 $u_{\\text{ex}}$ 的导数：\n$$\n\\frac{du_{\\text{ex}}}{dx} = \\frac{d}{dx}(e^{i k x}) = i k e^{i k x}\n$$\n$$\n\\frac{d^2 u_{\\text{ex}}}{dx^2} = \\frac{d}{dx}(i k e^{i k x}) = (i k)^2 e^{i k x} = -k^2 e^{i k x}\n$$\n\n为了找到源项 $f(x)$，我们将 $u_{\\text{ex}}$ 代入亥姆霍兹方程：\n$$\nf(x) = \\frac{d^2 u_{\\text{ex}}}{dx^2} + k^2 u_{\\text{ex}} = (-k^2 e^{i k x}) + k^2(e^{i k x}) = 0\n$$\n因此，体积源项恒为零，$f(x) \\equiv 0$。\n\n接下来，我们推导边界数据 $g_0$ 和 $g_L$。\n对于边界 $x=0$：\n$$\nu_{\\text{ex}}(0) = e^{i k (0)} = 1\n$$\n$$\n\\frac{du_{\\text{ex}}}{dx}(0) = i k e^{i k (0)} = i k\n$$\n将这些代入 $x=0$ 处的边界条件：\n$$\ng_0 = -\\frac{du_{\\text{ex}}}{dx}(0) + i k Z_0 u_{\\text{ex}}(0) = -(i k) + i k Z_0 (1) = i k (Z_0 - 1)\n$$\n\n对于边界 $x=L$：\n$$\nu_{\\text{ex}}(L) = e^{i k L}\n$$\n$$\n\\frac{du_{\\text{ex}}}{dx}(L) = i k e^{i k L}\n$$\n将这些代入 $x=L$ 处的边界条件：\n$$\ng_L = \\frac{du_{\\text{ex}}}{dx}(L) + i k Z_L u_{\\text{ex}}(L) = (i k e^{i k L}) + i k Z_L (e^{i k L}) = i k (1 + Z_L) e^{i k L}\n$$\n利用这些推导出的项 $f(x)$、$g_0$ 和 $g_L$，函数 $u_{\\text{ex}}(x) = e^{i k x}$ 成为该边值问题的精确解。\n\n**2. 有限差分离散**\n\n我们用 $N+1$ 个均匀分布的网格点 $x_j = j h$（其中 $j=0, 1, \\dots, N$）来离散域 $[0,L]$，网格间距为 $h=L/N$。令 $u_j$ 为 $u(x_j)$ 的数值近似。\n\n对于内部点 $x_j$（其中 $j=1, \\dots, N-1$），我们对二阶导数使用二阶中心差分：\n$$\n\\frac{d^2 u}{dx^2}(x_j) \\approx \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2}\n$$\n内部节点的离散化 PDE 为：\n$$\n\\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2} + k^2 u_j = f(x_j) = 0\n$$\n两边乘以 $h^2$ 并重新整理，得到线性系统第 $j$ 行的方程：\n$$\nu_{j-1} + (h^2 k^2 - 2)u_j + u_{j+1} = 0\n$$\n\n对于边界条件，我们对一阶导数使用二阶单边有限差分。\n\n在 $x=0$ 处（节点 $j=0$），我们使用二阶向前差分：\n$$\n\\frac{du}{dx}(0) \\approx \\frac{-3u_0 + 4u_1 - u_2}{2h}\n$$\n外法向导数为 $\\frac{\\partial u}{\\partial n}(0) = -\\frac{du}{dx}(0) \\approx -(\\frac{-3u_0 + 4u_1 - u_2}{2h}) = \\frac{3u_0 - 4u_1 + u_2}{2h}$。\n在 $x=0$ 处的离散化边界条件为：\n$$\n\\frac{3u_0 - 4u_1 + u_2}{2h} + i k Z_0 u_0 = g_0\n$$\n两边乘以 $2h$，得到系统第一行（$j=0$）的方程：\n$$\n(3 + 2h i k Z_0)u_0 - 4u_1 + u_2 = 2h g_0\n$$\n\n在 $x=L$ 处（节点 $j=N$），我们使用二阶向后差分：\n$$\n\\frac{du}{dx}(L) \\approx \\frac{3u_N - 4u_{N-1} + u_{N-2}}{2h}\n$$\n外法向导数为 $\\frac{\\partial u}{\\partial n}(L) = \\frac{du}{dx}(L)$。\n在 $x=L$ 处的离散化边界条件为：\n$$\n\\frac{3u_N - 4u_{N-1} + u_{N-2}}{2h} + i k Z_L u_N = g_L\n$$\n两边乘以 $2h$，得到系统最后一行（$j=N$）的方程：\n$$\nu_{N-2} - 4u_{N-1} + (3 + 2h i k Z_L)u_N = 2h g_L\n$$\n\n这 $N+1$ 个关于未知数 $u_0, u_1, \\dots, u_N$ 的线性方程构成一个矩阵系统 $A\\mathbf{u} = \\mathbf{b}$，其中 $A$ 是一个 $(N+1) \\times (N+1)$ 的复数矩阵，$\\mathbf{u} = [u_0, \\dots, u_N]^T$ 是数值解向量，$\\mathbf{b}$ 是右侧向量。这个系统可以使用标准的线性代数库求解。\n\n**3. 误差分析与精度阶**\n\n一旦计算出数值解 $\\mathbf{u} = [u_0, \\dots, u_N]^T$，我们就在网格点上计算精确解：$\\mathbf{u}_{\\text{ex}} = [u_{\\text{ex}}(x_0), \\dots, u_{\\text{ex}}(x_N)]^T$。\n误差使用离散 $L^2$ 范数来度量：\n$$\n\\|e\\|_h = \\left( h \\sum_{j=0}^{N} |u_j - u_{\\text{ex}}(x_j)|^2 \\right)^{1/2}\n$$\n为了确定观测精度阶 (OOA)，我们对两个网格序列计算此误差，一个是间距为 $h_1$、误差为 $\\|e\\|_{h_1}$ 的粗网格，另一个是间距为 $h_2$、误差为 $\\|e\\|_{h_2}$ 的细网格。如果方法的阶为 $p$，则误差行为类似于 $\\|e\\|_h \\approx C h^p$，其中 $C$ 为某个常数。OOA 随后估计为：\n$$\np \\approx \\frac{\\log(\\|e\\|_{h_1} / \\|e\\|_{h_2})}{\\log(h_1 / h_2)}\n$$\n对于指定的测试用例，网格通过将 $N$ 加倍来加密，这意味着 $h_1/h_2 = 2$。公式简化为：\n$$\np \\approx \\frac{\\log(\\|e\\|_{h_1} / \\|e\\|_{h_2})}{\\log(2)}\n$$\n由于所使用的所有有限差分近似都是二阶精确的，预期的 OOA 为 $p=2$。下面的数值实现将为每个测试用例计算此值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(L, k, Z0, ZL, N):\n    \"\"\"\n    Solves the 1D Helmholtz equation using a finite difference method\n    and returns the discrete L2 error against the manufactured solution.\n\n    Args:\n        L (float): Domain length.\n        k (complex): Wavenumber.\n        Z0 (complex): Impedance at x=0.\n        ZL (complex): Impedance at x=L.\n        N (int): Number of intervals in the grid.\n\n    Returns:\n        tuple: A tuple containing the L2 error (float) and grid spacing h (float).\n    \"\"\"\n    h = L / N\n    # Grid points from 0 to L\n    x = np.linspace(0, L, N + 1)\n\n    # Manufactured solution source terms\n    g0 = 1j * k * (Z0 - 1)\n    gL = 1j * k * (1 + ZL) * np.exp(1j * k * L)\n\n    # Initialize the linear system Ax = b\n    A = np.zeros((N + 1, N + 1), dtype=np.complex128)\n    b = np.zeros(N + 1, dtype=np.complex128)\n\n    # Row 0: Boundary condition at x=0\n    # (3 + 2*h*i*k*Z0)*u_0 - 4*u_1 + u_2 = 2*h*g0\n    A[0, 0] = 3.0 + 2.0 * h * 1j * k * Z0\n    A[0, 1] = -4.0\n    A[0, 2] = 1.0\n    b[0] = 2.0 * h * g0\n\n    # Rows 1 to N-1: Interior points (Helmholtz equation)\n    # u_{j-1} + (h^2*k^2 - 2)*u_j + u_{j+1} = 0\n    for j in range(1, N):\n        A[j, j - 1] = 1.0\n        A[j, j] = h**2 * k**2 - 2.0\n        A[j, j + 1] = 1.0\n        # b[j] is already 0.0\n\n    # Row N: Boundary condition at x=L\n    # u_{N-2} - 4*u_{N-1} + (3 + 2*h*i*k*ZL)*u_N = 2*h*gL\n    A[N, N - 2] = 1.0\n    A[N, N - 1] = -4.0\n    A[N, N] = 3.0 + 2.0 * h * 1j * k * ZL\n    b[N] = 2.0 * h * gL\n\n    # Solve the linear system\n    u_numerical = np.linalg.solve(A, b)\n\n    # Exact manufactured solution on the grid\n    u_exact = np.exp(1j * k * x)\n\n    # Compute the discrete L2 error\n    # ||e||_h = sqrt(h * sum(|u_num - u_ex|^2))\n    error_L2 = np.sqrt(h * np.sum(np.abs(u_numerical - u_exact)**2))\n\n    return error_L2, h\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and compute observed orders of accuracy.\n    \"\"\"\n    test_cases = [\n        # Case 1: general, moderate damping and mixed impedances\n        {'L': 1.0, 'k': 20.0 + 2.0j, 'Z0': 0.7 + 0.2j, 'ZL': 1.3 - 0.1j, 'N_list': [50, 100, 200, 400]},\n        # Case 2: short domain, stronger damping\n        {'L': 0.2, 'k': 30.0 + 5.0j, 'Z0': 2.0 + 0.0j, 'ZL': 0.5 + 0.5j, 'N_list': [40, 80, 160, 320]},\n        # Case 3: weak damping, symmetric impedances\n        {'L': 1.0, 'k': 40.0 + 0.1j, 'Z0': 1.0 + 0.0j, 'ZL': 1.0 + 0.0j, 'N_list': [80, 160, 320, 640]}\n    ]\n\n    results = []\n    for case in test_cases:\n        errors = []\n        h_values = []\n        for N in case['N_list']:\n            error, h = run_simulation(\n                case['L'], case['k'], case['Z0'], case['ZL'], N\n            )\n            errors.append(error)\n            h_values.append(h)\n        \n        # OOA is computed between the last two refinements\n        e1 = errors[-2]  # Coarser grid error\n        e2 = errors[-1]  # Finer grid error\n        h1 = h_values[-2] # Coarser grid spacing\n        h2 = h_values[-1] # Finer grid spacing\n\n        # OOA = log(e1/e2) / log(h1/h2)\n        # Since N doubles, h1/h2 is always 2\n        ooa = np.log(e1 / e2) / np.log(2.0)\n        results.append(f\"{ooa:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}