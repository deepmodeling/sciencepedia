{
    "hands_on_practices": [
        {
            "introduction": "本节练习将为你奠定均匀化理论的坚实基础。我们将从最简单的一维层状介质入手，在长波极限下运用第一性原理推导其等效密度和等效体积模量。通过这个练习，你将理解宏观等效属性如何从微观结构中涌现，并体会不同平均方式（例如，垂直传播与并联/串联混合）之间的物理差异。",
            "id": "4113355",
            "problem": "考虑一个一维周期性分层声学介质，该介质由两种无损、无粘性的流体组成，分别表示为层 $1$ 和层 $2$。设空间周期为 $d$，层厚度分别为 $d_1$ 和 $d_2$，因此体积分数为 $f_1 = d_1/d$ 和 $f_2 = d_2/d$，且满足 $f_1 + f_2 = 1$。每种流体 $i \\in \\{1,2\\}$ 的特性由一个恒定的体积模量 $K_i  0$ 和一个恒定的质量密度 $\\rho_i  0$ 决定。假设在长波长（准静态）均匀化条件下，存在时谐、小振幅、平面纵波，其中波长远大于 $d$，因此在一个单胞内的场变化在主导阶上可以忽略不计。\n\n使用线性声学的基本原理——即线性化的动量平衡和压力与体应变之间的线性本构关系——以及适用于垂直入射到分层的适当的界面连续性条件，推导控制垂直于分层方向传播的有效体积模量 $K_{\\text{eff}}^{\\perp}$ 和有效密度 $\\rho_{\\text{eff}}^{\\perp}$。然后，为了阐明层状复合材料中串联混合与并联混合之间的对比，还需推导在层间均匀体应变假设下（类刚度属性的并联混合）得到的相应混合表达式 $K_{\\text{mix}}^{\\parallel}$，以及在层间均匀动量通量假设下（类惯性属性的串联混合）得到的 $\\rho_{\\text{mix}}^{\\text{series}}$。\n\n以包含 $f_1$、$f_2$、$K_1$、$K_2$、$\\rho_1$ 和 $\\rho_2$ 的解析表达式形式提供您的最终答案。请勿代入数值。无需四舍五入。将四个结果按顺序 $\\left(K_{\\text{eff}}^{\\perp},\\, \\rho_{\\text{eff}}^{\\perp},\\, K_{\\text{mix}}^{\\parallel},\\, \\rho_{\\text{mix}}^{\\text{series}}\\right)$ 表示为单个行矩阵。最终答案中无需单位。为清晰起见，所有数学符号和表达式必须使用 LaTeX 内联数学分隔符书写。",
            "solution": "问题陈述经评估有效。它在科学上基于线性声学和均匀化理论的原理，提法得当且信息充分，并以客观、正式的语言表述。我们可以开始推导。\n\n该问题要求在长波长极限下，推导与一维分层声学介质均匀化相关的四个量。该介质由两种流体的交替层组成，其属性分别为 ($K_1, \\rho_1$) 和 ($K_2, \\rho_2$)，各自的体积分数为 $f_1$ 和 $f_2$。我们将推导用于垂直于分层方向波传播的有效体积模量 $K_{\\text{eff}}^{\\perp}$ 和有效密度 $\\rho_{\\text{eff}}^{\\perp}$。然后，我们将基于指定的假设，推导两个混合法则表达式 $K_{\\text{mix}}^{\\parallel}$ 和 $\\rho_{\\text{mix}}^{\\text{series}}$。\n\n对于非均匀流体，线性声学的一维基本方程是连续性方程（或动量平衡）和本构关系。设 $x$ 为垂直于分层的坐标，$p(x,t)$ 为声压，$v(x,t)$ 为质点速度。\n线性化的动量方程为：\n$$ \\rho(x) \\frac{\\partial v}{\\partial t} = -\\frac{\\partial p}{\\partial x} $$\n压力和体应变 $\\epsilon_V = \\frac{\\partial u}{\\partial x}$（其中 $v = \\frac{\\partial u}{\\partial t}$）之间的线性本构关系，可以写成速率形式：\n$$ \\frac{\\partial p}{\\partial t} = -K(x) \\frac{\\partial v}{\\partial x} $$\n在这个分层介质中，密度 $\\rho(x)$ 和体积模量 $K(x)$ 是位置的分段常数函数。在长波长极限（$\\lambda \\gg d$）下的均匀化过程依赖于对周期为 $d$ 的一个单胞上的场进行空间平均。量 $g(x)$ 的空间平均表示为 $\\langle g \\rangle = \\frac{1}{d}\\int_0^d g(x) dx$。\n\n**1. 有效密度 $\\rho_{\\text{eff}}^{\\perp}$ 的推导**\n\n对于垂直于分层的波传播，有效密度 $\\rho_{\\text{eff}}^{\\perp}$ 将平均质点加速度与宏观压力梯度联系起来。我们对动量方程在一个单胞上进行平均：\n$$ \\left\\langle \\rho(x) \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle = -\\frac{1}{d} \\int_0^d \\frac{\\partial p}{\\partial x} dx = -\\frac{p(d) - p(0)}{d} $$\n右侧代表宏观压力梯度，$\\nabla \\langle p \\rangle$。\n在层与层之间的界面处，法向质点速度 $v$ 必须是连续的，以防止空化或材料重叠。在长波长极限下，速度场 $v(x,t)$ 在单个单胞的微观尺度上变化缓慢。因此，加速度 $\\frac{\\partial v}{\\partial t}$ 在单胞内近似均匀，即 $\\frac{\\partial v}{\\partial t}(x) \\approx \\langle \\frac{\\partial v}{\\partial t} \\rangle$。\n将此应用于平均动量方程的左侧：\n$$ \\left\\langle \\rho(x) \\frac{\\partial v}{\\partial t} \\right\\rangle \\approx \\left\\langle \\rho(x) \\right\\rangle \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\langle \\rho \\rangle \\frac{\\partial \\langle v \\rangle}{\\partial t} $$\n平均密度 $\\langle \\rho \\rangle$ 计算如下：\n$$ \\langle \\rho \\rangle = \\frac{1}{d} \\int_0^d \\rho(x) dx = \\frac{1}{d} (\\rho_1 d_1 + \\rho_2 d_2) = \\rho_1 f_1 + \\rho_2 f_2 $$\n有效动量方程定义为 $\\rho_{\\text{eff}}^{\\perp} \\frac{\\partial \\langle v \\rangle}{\\partial t} = -\\nabla \\langle p \\rangle$。通过与我们推导的平均方程进行比较，我们确定了垂直传播的有效密度：\n$$ \\rho_{\\text{eff}}^{\\perp} = \\langle \\rho \\rangle = f_1 \\rho_1 + f_2 \\rho_2 $$\n这是算术平均值，或称混合法则，对应于承受相同加速度的质量单元的“并联”连接。\n\n**2. 有效体积模量 $K_{\\text{eff}}^{\\perp}$ 的推导**\n\n有效体积模量 $K_{\\text{eff}}^{\\perp}$ 将平均压力与平均应变联系起来。法向应力为 $\\sigma_{xx} = -p$。在流体-流体界面处，法向应力（压力）是连续的。在长波长极限下，压力场 $p(x,t)$ 在一个单胞内近似均匀，因此 $p(x) \\approx \\langle p \\rangle$。\n局部应变率为 $\\frac{\\partial v}{\\partial x} = -\\frac{1}{K(x)} \\frac{\\partial p}{\\partial t}$。我们对这个关系在单胞上进行平均：\n$$ \\left\\langle \\frac{\\partial v}{\\partial x} \\right\\rangle = \\left\\langle -\\frac{1}{K(x)} \\frac{\\partial p}{\\partial t} \\right\\rangle $$\n平均应变率为 $\\langle \\frac{\\partial v}{\\partial x} \\rangle = \\frac{v(d)-v(0)}{d}$，这对应于宏观应变率 $\\frac{\\partial \\langle v \\rangle}{\\partial x}$。\n利用压力的均匀性，我们有 $\\frac{\\partial p}{\\partial t}(x) \\approx \\langle \\frac{\\partial p}{\\partial t} \\rangle = \\frac{\\partial \\langle p \\rangle}{\\partial t}$。\n$$ \\frac{\\partial \\langle v \\rangle}{\\partial x} \\approx -\\left\\langle \\frac{1}{K(x)} \\right\\rangle \\frac{\\partial \\langle p \\rangle}{\\partial t} $$\n体积模量倒数（柔度）的平均值为：\n$$ \\left\\langle \\frac{1}{K} \\right\\rangle = \\frac{1}{d} \\int_0^d \\frac{1}{K(x)} dx = \\frac{1}{d} \\left(\\frac{d_1}{K_1} + \\frac{d_2}{K_2}\\right) = \\frac{f_1}{K_1} + \\frac{f_2}{K_2} $$\n有效本构关系定义为 $\\frac{\\partial \\langle p \\rangle}{\\partial t} = -K_{\\text{eff}}^{\\perp} \\frac{\\partial \\langle v \\rangle}{\\partial x}$。重新整理我们的平均方程得到 $\\frac{\\partial \\langle p \\rangle}{\\partial t} \\approx - \\left( \\left\\langle \\frac{1}{K} \\right\\rangle \\right)^{-1} \\frac{\\partial \\langle v \\rangle}{\\partial x}$。\n通过比较，我们确定了垂直传播的有效体积模量：\n$$ K_{\\text{eff}}^{\\perp} = \\left\\langle \\frac{1}{K} \\right\\rangle^{-1} = \\left( \\frac{f_1}{K_1} + \\frac{f_2}{K_2} \\right)^{-1} $$\n这是调和平均值，对应于承受相同应力的弹簧的“串联”连接。\n\n**3. $K_{\\text{mix}}^{\\parallel}$ 的推导（并联混合法则）**\n\n这个量是在均匀体应变 $\\epsilon(x) = \\langle \\epsilon \\rangle$ 的明确假设下推导的。当各层并联加载时，该条件在物理上得以实现。局部压力为 $p(x) = -K(x)\\epsilon(x)$。我们寻求一个有效模量 $K_{\\text{mix}}^{\\parallel}$，使得 $\\langle p \\rangle = -K_{\\text{mix}}^{\\parallel} \\langle \\epsilon \\rangle$。\n对局部关系进行平均：\n$$ \\langle p \\rangle = \\langle -K(x)\\epsilon(x) \\rangle $$\n在均匀应变假设下，$\\epsilon(x)$ 是常数，可以从平均积分中提取出来：\n$$ \\langle p \\rangle = -\\langle K(x) \\rangle \\langle \\epsilon \\rangle $$\n我们计算平均体积模量 $\\langle K \\rangle$：\n$$ \\langle K \\rangle = \\frac{1}{d} \\int_0^d K(x) dx = \\frac{1}{d}(K_1 d_1 + K_2 d_2) = f_1 K_1 + f_2 K_2 $$\n通过与有效模量的定义进行比较，我们发现：\n$$ K_{\\text{mix}}^{\\parallel} = \\langle K \\rangle = f_1 K_1 + f_2 K_2 $$\n这是算术平均值，即刚度的混合法则。\n\n**4. $\\rho_{\\text{mix}}^{\\text{series}}$ 的推导（串联混合法则）**\n\n这个量是根据“均匀动量通量”和“类惯性属性的串联混合”的假设推导出来的。这类似于 $K_{\\text{eff}}^{\\perp}$ 的推导，其中类“力”量（应力）是均匀的，而类“位移”量（应变）是平均的。对于惯性，“力”是压力梯度 $-\\frac{\\partial p}{\\partial x}$，“响应”是加速度 $\\frac{\\partial v}{\\partial t}$。\n因此，其基本假设是均匀的压力梯度：$-\\frac{\\partial p}{\\partial x}(x) = \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle$。\n根据局部动量方程，加速度为 $\\frac{\\partial v}{\\partial t}(x) = \\frac{1}{\\rho(x)} \\left(-\\frac{\\partial p}{\\partial x}\\right)$。\n对加速度进行平均：\n$$ \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle \\frac{1}{\\rho(x)} \\left(-\\frac{\\partial p}{\\partial x}\\right) \\right\\rangle $$\n利用均匀压力梯度假设，我们将其提取出来：\n$$ \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle \\frac{1}{\\rho} \\right\\rangle \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle $$\n平均密度倒数为：\n$$ \\left\\langle \\frac{1}{\\rho} \\right\\rangle = \\frac{1}{d} \\int_0^d \\frac{1}{\\rho(x)} dx = \\frac{1}{d} \\left(\\frac{d_1}{\\rho_1} + \\frac{d_2}{\\rho_2}\\right) = \\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2} $$\n此类混合的有效动量方程为 $\\rho_{\\text{mix}}^{\\text{series}} \\langle \\frac{\\partial v}{\\partial t} \\rangle = \\langle -\\frac{\\partial p}{\\partial x} \\rangle$。重新整理我们的平均方程得到 $\\langle \\frac{\\partial v}{\\partial t} \\rangle = \\left\\langle \\frac{1}{\\rho} \\right\\rangle \\langle -\\frac{\\partial p}{\\partial x} \\rangle$。\n通过比较，我们发现 $\\rho_{\\text{mix}}^{\\text{series}} = \\left(\\left\\langle \\frac{1}{\\rho} \\right\\rangle\\right)^{-1}$。\n$$ \\rho_{\\text{mix}}^{\\text{series}} = \\left( \\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2} \\right)^{-1} $$\n这是密度的调和平均值，代表惯性的串联混合。\n现在将四个结果汇编成最终答案。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\left(\\frac{f_1}{K_1} + \\frac{f_2}{K_2}\\right)^{-1}  f_1 \\rho_1 + f_2 \\rho_2  f_1 K_1 + f_2 K_2  \\left(\\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2}\\right)^{-1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "超越静态属性的讨论，本练习将深入探讨局域共振声学超材料的核心概念。通过将共振单元简化为质量-弹簧-阻尼系统，你将亲自推导该材料的频率依赖性等效质量密度。这项实践揭示了诸如负等效密度等奇异性质的物理起源，这是众多声学超材料应用的关键。",
            "id": "4113334",
            "problem": "考虑一种一维长波声学超材料，它由质量密度为 $\\rho_{0}$、体积模量为 $K_{0}$ 的均匀主介质组成，其中嵌入了稀疏数密度为 $n$ 的相同亚波长共振夹杂物。每个夹杂物被建模为一个集总质量 $m$，通过刚度为 $\\kappa$ 的线性弹簧和作用于夹杂物绝对速度的系数为 $\\eta$ 的线性阻尼器（粘性阻尼器）连接到主连续介质上。假设主介质经历简谐位移 $u_{h}(t)=\\Re\\{U\\exp(-i\\omega t)\\}$，并设夹杂物的绝对位移为 $u_{m}(t)=\\Re\\{U_{m}\\exp(-i\\omega t)\\}$。弹簧连接 $u_{m}$ 与 $u_{h}$，阻尼器对夹杂物施加一个与 $\\dot{u}_{m}$ 成正比的粘性力。波在空间上是缓变的，因此代表性体积元中的所有夹杂物都经历相同的 $u_{h}(t)$ 和 $u_{m}(t)$。\n\n从夹杂物的牛顿第二定律和复合材料的线动量守恒出发，将均质化介质的等效质量密度 $\\rho_{\\text{eff}}(\\omega)$ 定义为在简谐激励下，平均动量密度与主介质速度 $v_{h}(t)=\\dot{u}_{h}(t)$ 的比值。引入共振角频率 $\\omega_{0}$（通过 $\\omega_{0}^{2}=\\kappa/m$）、阻尼参数 $\\gamma$（通过 $\\gamma=\\eta/m$）和填充因子 $F$（通过 $F=\\frac{n m}{\\rho_{0}}$）。使用这些定义和长波均质化方法，推导以 $\\rho_{0}$、$\\omega$、$\\omega_{0}$、$\\gamma$ 和 $F$ 表示的 $\\rho_{\\text{eff}}(\\omega)$ 的闭合形式表达式。将最终答案表示为单一解析表达式。如果包含物理单位，请使用千克/立方米 ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$)。不要提供简化推导路径的中间公式；从上述基本定律开始，完成整个推导过程。",
            "solution": "目标是推导由主介质及嵌入的共振夹杂物组成的均质化声学超材料的频率依赖等效质量密度 $\\rho_{\\text{eff}}(\\omega)$。推导必须从第一性原理开始：夹杂物的牛顿第二定律和复合材料的动量守恒。长波假设确保了跨越晶胞的空间变化可以忽略不计，因此平均化处理是有效的。\n\n我们首先写出夹杂物质量的牛顿第二定律。夹杂物通过刚度为 $\\kappa$ 的弹簧连接到主介质，并受到作用于其绝对速度的粘性阻尼 $\\eta$。用 $u_{h}(t)$ 表示主介质位移，用 $u_{m}(t)$ 表示夹杂物位移。弹簧力为 $\\kappa\\,(u_{m}-u_{h})$，作用在夹杂物上的阻尼力为 $\\eta\\,\\dot{u}_{m}$。夹杂物的牛顿第二定律得出\n$$\nm\\,\\ddot{u}_{m} + \\eta\\,\\dot{u}_{m} + \\kappa\\,(u_{m}-u_{h}) = 0.\n$$\n假设简谐运动为 $u_{h}(t)=\\Re\\{U\\exp(-i\\omega t)\\}$ 和 $u_{m}(t)=\\Re\\{U_{m}\\exp(-i\\omega t)\\}$。将 $u_{h}(t)$ 和 $u_{m}(t)$ 代入夹杂物的运动方程，并除以 $\\exp(-i\\omega t)$，得到\n$$\n\\left(-m\\omega^{2} - i\\eta\\omega\\right)U_{m} + \\kappa\\,(U_{m}-U) = 0,\n$$\n可重排为\n$$\n(\\kappa - m\\omega^{2} - i\\eta\\omega)\\,U_{m} = \\kappa\\,U.\n$$\n求解传递比 $U_{m}/U$ 得到\n$$\n\\frac{U_{m}}{U} = \\frac{\\kappa}{\\kappa - m\\omega^{2} - i\\eta\\omega}.\n$$\n根据定义 $\\omega_{0}^{2}=\\kappa/m$ 和 $\\gamma=\\eta/m$，我们有\n$$\n\\frac{U_{m}}{U} = \\frac{m\\omega_{0}^{2}}{m(\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega)} = \\frac{\\omega_{0}^{2}}{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega}.\n$$\n\n接下来，在长波近似下，我们构建复合材料的平均动量密度。主介质的速度为 $v_{h}(t)=\\dot{u}_{h}(t)=\\Re\\{-i\\omega U\\exp(-i\\omega t)\\}$，夹杂物的速度为 $v_{m}(t)=\\dot{u}_{m}(t)=\\Re\\{-i\\omega U_{m}\\exp(-i\\omega t)\\}$。夹杂物的数密度为 $n$，因此单位体积内的夹杂物质量为 $nm$。代表性体积元中的平均动量密度 $\\Pi(t)$ 是主介质动量密度和夹杂物动量密度之和，\n$$\n\\Pi(t) = \\rho_{0}\\,v_{h}(t) + n m\\,v_{m}(t).\n$$\n在简谐激励下，夹杂物速度与主介质速度之比等于位移之比：$v_{m}/v_{h} = U_{m}/U$。因此，平均动量密度的简谐振幅可以写为\n$$\n\\Pi = \\rho_{0}\\,v_{h} + n m\\,v_{h}\\left(\\frac{U_{m}}{U}\\right) = v_{h}\\left[\\rho_{0} + n m\\left(\\frac{U_{m}}{U}\\right)\\right].\n$$\n根据等效质量密度的定义，$\\rho_{\\text{eff}}(\\omega)$ 是在均质化下平均动量密度与主介质速度振幅之间的比例因子：\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0} + n m\\left(\\frac{U_{m}}{U}\\right).\n$$\n引入填充因子 $F$（通过 $F=\\frac{n m}{\\rho_{0}}$）。代入传递比和 $F$ 得到\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0}\\left[1 + F\\,\\frac{\\omega_{0}^{2}}{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega}\\right].\n$$\n通常将结果的分母表示为 $(\\omega^{2} - \\omega_{0}^{2} + i\\gamma\\omega)$ 的形式会很方便。将分数的分子和分母同乘以 $-1$ 得到\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0}\\left[1 - F\\,\\frac{\\omega_{0}^{2}}{\\omega^{2} - \\omega_{0}^{2} + i\\gamma\\omega}\\right].\n$$\n这就是从质量-弹簧-阻尼器模型得到的局域共振声学超材料等效质量密度的所求闭合形式表达式，用 $\\rho_{0}$、$\\omega$、$\\omega_{0}$、$\\gamma$ 和 $F$ 表示。量 $\\rho_{\\text{eff}}(\\omega)$ 与 $\\rho_{0}$ 具有相同的物理单位，即千克/立方米，在最终方框表达式之外报告单位时可表示为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$。",
            "answer": "$$\\boxed{\\rho_{0}\\left(1-\\frac{F\\,\\omega_{0}^{2}}{\\omega^{2}-\\omega_{0}^{2}+i\\,\\gamma\\,\\omega}\\right)}$$"
        },
        {
            "introduction": "最后的这项实践将通过计算，架起理论与应用之间的桥梁。你将应用先前推导的动态等效密度模型，计算声波通过有限厚度超材料板的透射率。通过模拟共振频率附近及远端的透射情况，你将亲眼见证由负等效密度导致的带隙——一个强衰减区域——的形成。",
            "id": "4113345",
            "problem": "一维正入射时谐平面声波穿过嵌入均匀背景流体中的有限厚度的局域共振超材料板。背景流体占据了板左右两侧的半无限区域，其特征是恒定的质量密度 $\\rho_0$ 和声速 $c_0$，因此体积模量为 $K_0 = \\rho_0 c_0^2$，声阻抗为 $Z_0 = \\rho_0 c_0$。超材料板的厚度为 $d$，其有效体积模量 $K_{\\text{eff}}(\\omega)$ 假定为无色散且等于背景体积模量 $K_0$，其有效动态质量密度 $\\rho_{\\text{eff}}(\\omega)$ 体现了局域共振行为。\n\n从微小扰动的线性声学方程出发，即线性化动量平衡方程和连续性方程，\n$$\n\\rho(\\mathbf{x})\\,\\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p, \\quad \\frac{\\partial p}{\\partial t} = -K(\\mathbf{x})\\,\\nabla\\cdot \\mathbf{u},\n$$\n并限定在一维沿 $x$ 轴传播、角频率为 $\\omega$ 的时谐场（时间依赖关系为 $e^{-i \\omega t}$）的情况下，推导每个均匀区域中的一维亥姆霍兹方程，指明界面处声压和法向质点速度的连续性条件，并计算穿过板的复振幅透射系数 $t(\\omega)$ 以及相应的功率透射率 $T(\\omega) = |t(\\omega)|^2$。\n\n使用因果洛伦兹型共振模型来描述局域共振超材料的有效密度，\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_b\\left(1 - \\frac{F\\,\\omega^2}{\\omega^2 - \\omega_0^2 + i\\,\\gamma\\,\\omega}\\right),\n$$\n其中 $\\rho_b$ 是基底（主体）密度，$F$ 是满足 $0  F  1$ 的无量纲耦合因子，$\\omega_0$ 是共振角频率，$\\gamma$ 是阻尼率。假定 $K_{\\text{eff}}(\\omega) = K_0$ 以分离出质量密度共振的影响，并假定两侧的背景流体相同且为半无限。在每个均匀区域中使用波数和阻抗的基本定义，\n$$\nk(\\omega) = \\omega\\,\\sqrt{\\frac{\\rho(\\omega)}{K(\\omega)}}, \\quad Z(\\omega) = \\sqrt{\\rho(\\omega)\\,K(\\omega)}.\n$$\n您的程序必须通过施加板界面处声压和法向质点速度的连续性边界条件，以及左侧单位振幅入射波和右侧仅有前向传播透射波的辐射条件，来实现 $t(\\omega)$ 的计算。除指定参数外，不得引入任何额外的拟合参数。\n\n背景流体的物理参数必须设置为 $\\rho_0 = 1.21\\,\\text{kg/m}^3$ 和 $c_0 = 343\\,\\text{m/s}$，因此 $K_0 = \\rho_0 c_0^2$ 且 $Z_0 = \\rho_0 c_0$。取超材料基底密度 $\\rho_b = \\rho_0$。共振角频率使用 $\\omega_0 = 2\\pi \\times 800\\,\\text{rad/s}$。所有角频率在内部必须以 $\\text{rad/s}$ 为单位处理和报告，所有长度以 $\\text{m}$ 为单位，密度以 $\\text{kg/m}^3$ 为单位，模量以 $\\text{Pa}$ 为单位，阻尼率以 $\\text{s}^{-1}$ 为单位。透射率是无量纲的。\n\n构建以下参数集 $(\\omega, d, F, \\gamma)$ 的测试套件，以探测低于、接近和高于 $\\omega_0$ 的频率，包括边界和边缘情况：\n- 情况 A (低于共振): $(\\omega, d, F, \\gamma) = (0.5\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n- 情况 B (接近低于共振): $(\\omega, d, F, \\gamma) = (0.99\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n- 情况 C (接近高于共振): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n- 情况 D (高于共振): $(\\omega, d, F, \\gamma) = (1.5\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n- 情况 E (远高于共振): $(\\omega, d, F, \\gamma) = (3.0\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n- 情况 F (边缘：接近高于共振时阻尼非常低): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 10^{-4}\\,\\omega_0)$。\n- 情况 G (边缘：接近高于共振时耦合弱): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.1, 0.05\\,\\omega_0)$。\n- 情况 H (边界：零厚度): $(\\omega, d, F, \\gamma) = (1.2\\,\\omega_0, 0.0\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$。\n\n您的程序应计算每种情况下的功率透射率 $T(\\omega)$。最终输出格式必须是单行包含一个由方括号括起来的逗号分隔列表，其中包含情况 A 到 H 的透射率，每个值四舍五入到 $6$ 位小数（例如，$[0.123456,0.654321,\\dots]$）。除了计算 $T(\\omega)$，推导过程中应建立将观察到的衰减与 $\\rho_{\\text{eff}}(\\omega)$ 的符号和大小相关联的解释，但程序必须仅按规定输出数值透射率。",
            "solution": "用户提供了计算声学领域一个有效的问题陈述。任务是推导正入射到局域共振超材料板上的平面声波的透射系数，然后计算给定参数集下的功率透射率。该问题提法恰当，科学上合理，并提供了所有必要信息。\n\n### **第 1 部分：一维亥姆霍兹方程的推导**\n\n我们从介质中声压扰动 $p(\\mathbf{x}, t)$ 和质点速度 $\\mathbf{u}(\\mathbf{x}, t)$ 的线性声学方程开始，介质密度为 $\\rho(\\mathbf{x})$，体积模量为 $K(\\mathbf{x})$:\n$$\n\\rho\\,\\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p, \\quad \\frac{\\partial p}{\\partial t} = -K\\,\\nabla\\cdot \\mathbf{u}\n$$\n我们考虑沿 $x$ 轴的一维传播，因此 $\\mathbf{u} = u(x,t)\\hat{\\mathbf{x}}$ 且 $\\nabla = \\frac{\\partial}{\\partial x}\\hat{\\mathbf{x}}$。方程简化为：\n$$\n\\rho(x)\\,\\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x}, \\quad \\frac{\\partial p}{\\partial t} = -K(x)\\,\\frac{\\partial u}{\\partial x}\n$$\n对于角频率为 $\\omega$ 的时谐场，场可以写为 $p(x,t) = p(x)e^{-i\\omega t}$ 和 $u(x,t) = u(x)e^{-i\\omega t}$。时间导数算子变为 $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$。材料属性 $\\rho$ 和 $K$ 现在是依赖于频率的有效参数，即 $\\rho_{\\text{eff}}(\\omega)$ 和 $K_{\\text{eff}}(\\omega)$。在任何均匀区域内，它们在空间上是恒定的。时谐方程为：\n$$\n-i\\omega\\rho_{\\text{eff}}(\\omega)u(x) = -\\frac{dp}{dx} \\implies \\frac{dp}{dx} = i\\omega\\rho_{\\text{eff}}(\\omega)u(x)\n$$\n$$\n-i\\omega p(x) = -K_{\\text{eff}}(\\omega)\\frac{du}{dx} \\implies \\frac{du}{dx} = \\frac{i\\omega}{K_{\\text{eff}}(\\omega)}p(x)\n$$\n为了推导声压的亥姆霍兹方程，我们将第一个方程对 $x$ 求导，并代入第二个方程：\n$$\n\\frac{d^2p}{dx^2} = i\\omega\\rho_{\\text{eff}}(\\omega)\\frac{du}{dx} = i\\omega\\rho_{\\text{eff}}(\\omega)\\left(\\frac{i\\omega}{K_{\\text{eff}}(\\omega)}p(x)\\right) = -\\omega^2\\frac{\\rho_{\\text{eff}}(\\omega)}{K_{\\text{eff}}(\\omega)}p(x)\n$$\n这得到一维亥姆霍兹方程：\n$$\n\\frac{d^2p}{dx^2} + k^2(\\omega)p(x) = 0\n$$\n其中复波数 $k(\\omega)$ 定义为：\n$$\nk(\\omega) = \\omega\\sqrt{\\frac{\\rho_{\\text{eff}}(\\omega)}{K_{\\text{eff}}(\\omega)}}\n$$\n\n### **第 2 部分：波穿过平板的传播**\n\n该系统由三个区域组成：\n- 区域 1 ($x0$): 背景流体，属性为 $\\rho_0$, $K_0 = \\rho_0 c_0^2$。波数 $k_0 = \\omega/c_0$。\n- 区域 2 ($0 \\le x \\le d$): 超材料板，属性为 $\\rho_{\\text{eff}}(\\omega)$, $K_{\\text{eff}}(\\omega) = K_0$。波数 $k_{\\text{eff}}(\\omega) = \\omega\\sqrt{\\rho_{\\text{eff}}(\\omega)/K_0}$。\n- 区域 3 ($x>d$): 背景流体，与区域 1 相同。\n\n每个区域中的声压场是亥姆霍兹方程的解：\n- $p_1(x) = e^{ik_0x} + R\\,e^{-ik_0x}$ for $x0$。入射波振幅为单位振幅。$R$ 是复反射系数。\n- $p_2(x) = A\\,e^{ik_{\\text{eff}}x} + B\\,e^{-ik_{\\text{eff}}x}$ for $0 \\le x \\le d$。\n- $p_3(x) = t\\,e^{ik_0(x-d)}$ for $x>d$。只存在前向传播的透射波。$t$ 是复透射系数。\n\n质点速度 $u(x)$ 与声压的关系为 $u(x) = \\frac{1}{i\\omega\\rho}\\frac{dp}{dx}$。对于平面波 $p=p_0 e^{\\pm ikx}$，$u = \\pm\\frac{k}{\\omega\\rho}p = \\pm\\frac{1}{Z}p$，其中 $Z=\\sqrt{\\rho K}$ 是特征声阻抗。\n阻抗为 $Z_0 = \\sqrt{\\rho_0 K_0}$ 和 $Z_{\\text{eff}} = \\sqrt{\\rho_{\\text{eff}} K_0}$。速度场为：\n- $u_1(x) = \\frac{1}{Z_0}(e^{ik_0x} - R\\,e^{-ik_0x})$\n- $u_2(x) = \\frac{1}{Z_{\\text{eff}}}(A\\,e^{ik_{\\text{eff}}x} - B\\,e^{-ik_{\\text{eff}}x})$\n- $u_3(x) = \\frac{1}{Z_0}t\\,e^{ik_0(x-d)}$\n\n边界条件是声压和质点速度在界面 $x=0$ 和 $x=d$ 处的连续性。一种求解 $t$ 的稳健方法是传递矩阵法。$x=0$ 处的状态向量 $(p(x), u(x))^T$ 通过一个传播矩阵与 $x=d$ 处的状态向量相关联：\n$$\n\\begin{pmatrix} p(0) \\\\ u(0) \\end{pmatrix} = \\begin{pmatrix} \\cos(k_{\\text{eff}}d)  i Z_{\\text{eff}}\\sin(k_{\\text{eff}}d) \\\\ i \\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)  \\cos(k_{\\text{eff}}d) \\end{pmatrix} \\begin{pmatrix} p(d) \\\\ u(d) \\end{pmatrix}\n$$\n从波的解中，我们有：\n- 在 $x=0$: $p_1(0) = 1+R$, $u_1(0) = (1-R)/Z_0$。\n- 在 $x=d$: $p_3(d) = t$, $u_3(d) = t/Z_0$。\n将这些代入矩阵方程中：\n$$\n\\begin{pmatrix} 1+R \\\\ (1-R)/Z_0 \\end{pmatrix} = \\begin{pmatrix} \\cos(k_{\\text{eff}}d)  i Z_{\\text{eff}}\\sin(k_{\\text{eff}}d) \\\\ i \\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)  \\cos(k_{\\text{eff}}d) \\end{pmatrix} \\begin{pmatrix} t \\\\ t/Z_0 \\end{pmatrix}\n$$\n这代表了两个线性方程：\n1. $1+R = t \\left( \\cos(k_{\\text{eff}}d) + i\\frac{Z_{\\text{eff}}}{Z_0}\\sin(k_{\\text{eff}}d) \\right)$\n2. $1-R = t \\left( Z_0 \\left(i\\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)\\right) + Z_0\\left(\\frac{1}{Z_0}\\cos(k_{\\text{eff}}d)\\right) \\right) = t \\left( \\cos(k_{\\text{eff}}d) + i\\frac{Z_0}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d) \\right)$\n\n将这两个方程相加，消去 $R$：\n$$\n2 = t \\left[ 2\\cos(k_{\\text{eff}}d) + i\\left(\\frac{Z_{\\text{eff}}}{Z_0} + \\frac{Z_0}{Z_{\\text{eff}}}\\right)\\sin(k_{\\text{eff}}d) \\right]\n$$\n求解复透射系数 $t \\equiv t(\\omega)$：\n$$\nt(\\omega) = \\left[ \\cos(k_{\\text{eff}}d) + \\frac{i}{2}\\left(\\frac{Z_{\\text{eff}}(\\omega)}{Z_0} + \\frac{Z_0}{Z_{\\text{eff}}(\\omega)}\\right)\\sin(k_{\\text{eff}}d) \\right]^{-1}\n$$\n功率透射率为 $T(\\omega) = |t(\\omega)|^2$。\n\n### **第 3 部分：超材料属性与解释**\n\n有效密度由洛伦兹模型给出：\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_b\\left(1 - \\frac{F\\,\\omega^2}{\\omega^2 - \\omega_0^2 + i\\,\\gamma\\,\\omega}\\right)\n$$\n当 $\\rho_b = \\rho_0$ 时，行为由频率相关的项决定。\n- 在共振频率 $\\omega_0$ 附近，分母变小。\n- 对于略高于 $\\omega_0$ 的频带，$\\omega^2 - \\omega_0^2$ 项为正且很小。对于小阻尼 $\\gamma$，分数 $\\frac{F\\omega^2}{\\dots}$ 可以是一个大于 $1$ 的大实数。\n- 这导致存在一个频率范围，其中 $\\text{Re}(\\rho_{\\text{eff}}(\\omega))$ 为负。\n- 当 $\\rho_{\\text{eff}}$ 为负（为简单起见，假设为实数）时，阻抗 $Z_{\\text{eff}} = \\sqrt{\\rho_{\\text{eff}}K_0}$ 和波数 $k_{\\text{eff}} = \\omega\\sqrt{\\rho_{\\text{eff}}/K_0}$ 变为纯虚数。\n- 一个虚波数，$k_{\\text{eff}} = i\\kappa$（其中 $\\kappa$ 为正实数），意味着波幅在板内呈指数衰减 $e^{-\\kappa x}$。这会产生一个带隙，其透射率非常低，这是此类超材料的一个关键特征。计算将捕捉到这种效应。对于零厚度情况（$d=0$），$\\cos(0)=1$ 和 $\\sin(0)=0$，所以 $t(\\omega)=1$ 和 $T(\\omega)=1$，正如预期。\n\n### **第 4 部分：数值计算算法**\n\n每个测试用例 $(\\omega, d, F, \\gamma)$ 的计算遵循以下步骤：\n1. 定义物理常数：$\\rho_0 = 1.21\\,\\text{kg/m}^3$, $c_0 = 343\\,\\text{m/s}$, $K_0 = \\rho_0 c_0^2$, $Z_0 = \\rho_0 c_0$, 以及 $\\omega_0 = 2\\pi \\times 800\\,\\text{rad/s}$。\n2. 对于给定的 $\\omega, F, \\gamma$，使用洛伦兹模型（其中 $\\rho_b=\\rho_0$）计算复有效密度 $\\rho_{\\text{eff}}(\\omega)$。这需要复数运算。\n3. 计算复有效阻抗 $Z_{\\text{eff}}(\\omega) = \\sqrt{\\rho_{\\text{eff}}(\\omega) K_0}$。`sqrt` 函数必须能处理复数参数，返回主根（实部非负）。\n4. 计算复有效波数 $k_{\\text{eff}}(\\omega) = \\omega \\sqrt{\\rho_{\\text{eff}}(\\omega)/K_0}$。\n5. 将 $k_{\\text{eff}}$, $Z_{\\text{eff}}$, $Z_0$ 和 $d$ 代入推导出的 $t(\\omega)$ 公式中。所有三角函数必须支持复数参数。\n6. 计算功率透射率 $T(\\omega) = |t(\\omega)|^2$。\n7. 对所有测试用例重复此过程，并按规定格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the power transmittance of an acoustic plane wave through\n    a metamaterial slab for a suite of test cases.\n    \"\"\"\n    # Define physical constants for the background fluid (air)\n    rho_0 = 1.21  # kg/m^3\n    c_0 = 343.0  # m/s\n    K_0 = rho_0 * c_0**2  # Pa\n    Z_0 = rho_0 * c_0  # Acoustic impedance (Rayls)\n\n    # Define metamaterial resonance frequency\n    w_0 = 2.0 * np.pi * 800.0  # rad/s\n\n    # Construct the test suite of parameter sets (omega, d, F, gamma)\n    test_cases = [\n        # Case A (below resonance)\n        (0.5 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case B (near below resonance)\n        (0.99 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case C (near above resonance)\n        (1.01 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case D (above resonance)\n        (1.5 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case E (far above resonance)\n        (3.0 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case F (edge: very low damping near above resonance)\n        (1.01 * w_0, 0.1, 0.8, 1.0e-4 * w_0),\n        # Case G (edge: weak coupling near above resonance)\n        (1.01 * w_0, 0.1, 0.1, 0.05 * w_0),\n        # Case H (boundary: zero thickness)\n        (1.2 * w_0, 0.0, 0.8, 0.05 * w_0),\n    ]\n\n    results = []\n    for case in test_cases:\n        w, d, F, gamma = case\n\n        # Step 1: Calculate the complex effective density rho_eff(w)\n        # rho_eff(w) = rho_b * (1 - (F*w^2) / (w^2 - w_0^2 + i*gamma*w))\n        # Assuming base density rho_b = rho_0\n        w2 = w**2\n        w02 = w_0**2\n        numerator = F * w2\n        denominator = (w2 - w02) + 1j * gamma * w\n        \n        # Avoid division by zero, although not expected for real w > 0\n        if np.isclose(denominator, 0):\n            # This case shouldn't be reached with the given parameters\n            rho_eff = np.inf\n        else:\n            rho_eff = rho_0 * (1.0 - numerator / denominator)\n\n        # Step 2: Calculate effective impedance and wavenumber\n        # Z_eff = sqrt(rho_eff * K_eff) where K_eff = K_0\n        # k_eff = w * sqrt(rho_eff / K_eff)\n        # Using numpy's sqrt which properly handles complex numbers (principal root)\n        Z_eff = np.sqrt(rho_eff * K_0)\n        k_eff = w * np.sqrt(rho_eff / K_0)\n        \n        # Step 3: Calculate the complex transmission coefficient t(w)\n        # t(w) = 1 / [cos(k_eff*d) + (i/2)*(Z_eff/Z_0 + Z_0/Z_eff)*sin(k_eff*d)]\n        if d == 0.0:\n            # For zero thickness, transmission is perfect (t=1)\n            t = 1.0\n        else:\n            cos_kd = np.cos(k_eff * d)\n            sin_kd = np.sin(k_eff * d)\n            \n            # Impedance mismatch term\n            # Handle potential division by zero if Z_eff is close to zero\n            if np.isclose(Z_eff, 0):\n                # This corresponds to rho-near-zero resonance\n                # The term with Z_0/Z_eff dominates.\n                # In the limit, t(w) = 1 / ( (i/2) * (Z_0/Z_eff) * (k_eff*d) )\n                # Using k_eff/Z_eff = w/K_0, we can find a finite limit\n                # t_inv = (i/2)*Z_0*(w/K_0)*d = i*k_0*d/2 where k_0 = w*Z_0/K_0\n                k0 = w/c_0\n                t_inv = 0.5j * k0 * d\n                t = 1.0 / t_inv\n            else:\n                impedance_term = (Z_eff / Z_0) + (Z_0 / Z_eff)\n                t_inv = cos_kd + 0.5j * impedance_term * sin_kd\n                t = 1.0 / t_inv\n\n        # Step 4: Calculate the power transmittance T(w) = |t(w)|^2\n        T = np.abs(t)**2\n        results.append(T)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}