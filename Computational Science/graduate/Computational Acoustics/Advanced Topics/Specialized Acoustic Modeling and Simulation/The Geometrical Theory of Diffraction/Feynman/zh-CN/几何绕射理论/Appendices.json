{
    "hands_on_practices": [
        {
            "introduction": "几何衍射理论（GTD）的数学基础源于波动方程的高频渐近解。第一个练习将带您回到这些基本原理。通过从一个简单点声源的亥姆霍兹方程出发，您将推导出构成射线理论基石的程函方程和输运方程，并发现此经典案例中渐近解与精确解之间存在的深刻联系 。",
            "id": "4142709",
            "problem": "考虑一个位于原点的时谐声点源，在声速为常数 $c$ 的均匀、无损介质中辐射。设角频率为 $\\omega$，声波数为 $k=\\omega/c$。在远离声源处，声压场 $u(\\mathbf{x})$ 在 $\\mathbb{R}^{3}\\setminus\\{\\mathbf{0}\\}$ 中满足齐次亥姆霍兹方程 $(\\nabla^{2}+k^{2})u=0$。使用几何衍射理论 (GTD) 和 Wentzel–Kramers–Brillouin (WKB) 方法的基本渐近拟设，将 $u_{\\mathrm{WKB}}(\\mathbf{x})$ 表示为 $u_{\\mathrm{WKB}}(\\mathbf{x})=A_{0}(\\mathbf{x})\\exp\\!\\left(i k S(\\mathbf{x})\\right)$，其中 $S(\\mathbf{x})$ 是程函（相位），$A_{0}(\\mathbf{x})$ 是领阶振幅。\n\n仅从亥姆霍兹方程、索末菲辐射条件和上述 WKB 拟设出发（不引用任何预先给出的射线或振幅公式），完成以下任务：\n\n1. 推导 $S(\\mathbf{x})$ 的程函方程和 $A_{0}(\\mathbf{x})$ 的领阶输运方程。\n2. 利用球对称性，显式求解这些方程，以得到在 $\\mathbb{R}^{3}\\setminus\\{\\mathbf{0}\\}$ 中的出射场，并确定 $S(\\mathbf{x})$ 和 $A_{0}(\\mathbf{x})$（$A_{0}(\\mathbf{x})$ 可带一个乘法常数）。\n3. 施加出射波的索末菲辐射条件以确定 $S(\\mathbf{x})$ 中的符号，并通过将远场形式与此处取为 $u_{\\mathrm{exact}}(r)=\\exp(i k r)/r$（其中 $r=|\\mathbf{x}|$）的标准精确出射球面波相匹配，来归一化 $A_{0}(\\mathbf{x})$。\n4. 定义相对误差 $E(k,r)=\\big(u_{\\mathrm{WKB}}(r)-u_{\\mathrm{exact}}(r)\\big)/u_{\\mathrm{exact}}(r)$，并确定当 $k r\\to\\infty$ 时其领阶渐近项。\n\n将你的最终答案表示为 $E(k,r)$ 的领阶渐近项的单个闭合形式无量纲表达式。不需要四舍五入。如果在中间步骤中出现角度，应以弧度为单位。最终答案必须是单个无单位的表达式。",
            "solution": "该问题要求推导三维空间中声点源的领阶 Wentzel–Kramers–Brillouin (WKB) 或几何衍射理论 (GTD) 解，然后分析其相对于精确解的误差。\n\n**第 1 步：程函方程和输运方程的推导**\n\n起点是在 $\\mathbb{R}^{3}\\setminus\\{\\mathbf{0}\\}$ 中的齐次亥姆霍兹方程：\n$$(\\nabla^{2}+k^{2})u(\\mathbf{x})=0$$\n我们将 WKB 拟设 $u_{\\mathrm{WKB}}(\\mathbf{x})=A_{0}(\\mathbf{x})\\exp(i k S(\\mathbf{x}))$ 代入此方程。我们必须计算 $u_{\\mathrm{WKB}}$ 的拉普拉斯算子。\n首先，$u_{\\mathrm{WKB}}$ 的梯度是：\n$$\\nabla u_{\\mathrm{WKB}} = \\nabla(A_{0} \\exp(ikS)) = (\\nabla A_{0}) \\exp(ikS) + A_{0} (ik \\nabla S) \\exp(ikS)$$\n$$\\nabla u_{\\mathrm{WKB}} = (\\nabla A_{0} + ik A_{0} \\nabla S) \\exp(ikS)$$\n接下来，梯度的散度给出拉普拉斯算子：\n$$\\nabla^{2} u_{\\mathrm{WKB}} = \\nabla \\cdot (\\nabla u_{\\mathrm{WKB}}) = \\nabla \\cdot [(\\nabla A_{0} + ik A_{0} \\nabla S) \\exp(ikS)]$$\n使用散度的乘积法则 $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$，其中 $\\phi = \\exp(ikS)$ 且 $\\mathbf{F} = \\nabla A_{0} + ik A_{0} \\nabla S$：\n$$\\nabla^{2} u_{\\mathrm{WKB}} = \\nabla(\\exp(ikS)) \\cdot (\\nabla A_{0} + ik A_{0} \\nabla S) + \\exp(ikS) \\nabla \\cdot (\\nabla A_{0} + ik A_{0} \\nabla S)$$\n$$\\nabla^{2} u_{\\mathrm{WKB}} = (ik \\nabla S) \\cdot (\\nabla A_{0} + ik A_{0} \\nabla S) \\exp(ikS) + (\\nabla^{2}A_{0} + ik \\nabla \\cdot (A_{0}\\nabla S))\\exp(ikS)$$\n展开各项：\n$$\\nabla^{2} u_{\\mathrm{WKB}} = (ik \\nabla S \\cdot \\nabla A_{0} + (ik)^{2} A_{0} |\\nabla S|^{2}) \\exp(ikS) + (\\nabla^{2}A_{0} + ik (\\nabla A_{0} \\cdot \\nabla S + A_{0}\\nabla^{2}S)) \\exp(ikS)$$\n$$\\nabla^{2} u_{\\mathrm{WKB}} = (-k^{2} A_{0} |\\nabla S|^{2} + ik(2\\nabla A_{0} \\cdot \\nabla S + A_{0} \\nabla^{2}S) + \\nabla^{2}A_{0}) \\exp(ikS)$$\n将此代回亥姆霍兹方程 $(\\nabla^{2}+k^{2})u_{\\mathrm{WKB}}=0$：\n$$(-k^{2} A_{0} |\\nabla S|^{2} + ik(2\\nabla A_{0} \\cdot \\nabla S + A_{0} \\nabla^{2}S) + \\nabla^{2}A_{0} + k^{2}A_{0}) \\exp(ikS) = 0$$\n除以非零的指数项，并按 $k$ 的幂次重新排列：\n$$k^{2} A_{0}(1 - |\\nabla S|^{2}) + ik(2\\nabla A_{0} \\cdot \\nabla S + A_{0} \\nabla^{2}S) + \\nabla^{2}A_{0} = 0$$\nWKB 近似是针对大 $k$ 的渐近展开。为使此方程成立， $k$ 的主导幂次的系数必须独立地为零。\n将 $k^{2}$ 项的系数置为零，得到**程函方程**：\n$$|\\nabla S|^{2} = 1$$\n将 $k$ 项的系数置为零，得到**领阶输运方程**：\n$$2\\nabla A_{0} \\cdot \\nabla S + A_{0} \\nabla^{2}S = 0$$\n余下的项 $\\nabla^{2}A_{0}$ 被认为是较低阶的，在领阶近似中被忽略。\n\n**第 2 步：球对称性下的解**\n\n对于位于原点的点源，场表现出球对称性。因此我们假设 $S(\\mathbf{x}) = S(r)$ 和 $A_{0}(\\mathbf{x}) = A_{0}(r)$，其中 $r = |\\mathbf{x}|$。\n在球坐标系中，径向对称函数 $f(r)$ 的梯度为 $\\nabla f = \\hat{\\mathbf{r}} \\frac{df}{dr}$。\n程函方程变为：\n$$|\\hat{\\mathbf{r}} \\frac{dS}{dr}|^{2} = \\left(\\frac{dS}{dr}\\right)^{2} = 1$$\n解为 $\\frac{dS}{dr} = \\pm 1$，积分得到 $S(r) = \\pm r + S_{c}$。积分常数 $S_c$ 表示一个恒定的相移，可以被吸收到振幅常数中，因此我们设 $S_{c}=0$。于是，$S(r) = \\pm r$。\n\n现在我们求解输运方程。我们需要 $\\nabla A_{0}$、$\\nabla S$ 和 $\\nabla^{2}S$ 这几项。\n$\\nabla A_{0} = \\hat{\\mathbf{r}} \\frac{dA_{0}}{dr}$\n$\\nabla S = \\hat{\\mathbf{r}} \\frac{dS}{dr} = \\pm \\hat{\\mathbf{r}}$\n径向对称函数 $S(r)$ 的拉普拉斯算子是 $\\nabla^{2}S = \\frac{1}{r^{2}}\\frac{d}{dr}\\left(r^{2}\\frac{dS}{dr}\\right)$。\n使用 $\\frac{dS}{dr} = \\pm 1$，我们得到：\n$$\\nabla^{2}S = \\frac{1}{r^{2}}\\frac{d}{dr}(r^{2}(\\pm 1)) = \\frac{1}{r^{2}}(\\pm 2r) = \\pm \\frac{2}{r}$$\n将这些代入输运方程：\n$$2\\left(\\hat{\\mathbf{r}} \\frac{dA_{0}}{dr}\\right) \\cdot (\\pm \\hat{\\mathbf{r}}) + A_{0} \\left(\\pm \\frac{2}{r}\\right) = 0$$\n$$\\pm 2\\frac{dA_{0}}{dr} \\pm \\frac{2}{r} A_{0} = 0$$\n无论符号如何选择，这都简化为同一个常微分方程：\n$$\\frac{dA_{0}}{dr} + \\frac{A_{0}}{r} = 0$$\n这是一个可分离方程：$\\frac{dA_{0}}{A_{0}} = -\\frac{dr}{r}$。积分得到 $\\ln A_{0} = -\\ln r + C'$，或 $A_{0}(r) = \\frac{\\exp(C')}{r}$。我们定义一个新常数 $C_{A} = \\exp(C')$。\n领阶振幅的解是 $A_{0}(r) = \\frac{C_{A}}{r}$。\n\n**第 3 步：施加条件与归一化**\n\nWKB 解的形式为 $u_{\\mathrm{WKB}}(r) = \\frac{C_{A}}{r} \\exp(ik(\\pm r))$。相位中符号的选择由出射波的索末菲辐射条件确定，该条件要求对于时谐依赖关系为 $\\exp(-i\\omega t)$ 的波，有 $\\lim_{r\\to\\infty} r (\\frac{\\partial u}{\\partial r} - iku) = 0$。\n我们来检验符号。\n$$\\frac{\\partial u_{\\mathrm{WKB}}}{\\partial r} = \\frac{\\partial}{\\partial r} \\left(\\frac{C_{A}}{r}\\exp(\\pm ikr)\\right) = -\\frac{C_{A}}{r^{2}}\\exp(\\pm ikr) \\pm ik\\frac{C_{A}}{r}\\exp(\\pm ikr) = \\left(-\\frac{1}{r} \\pm ik\\right) u_{\\mathrm{WKB}}$$\n因此，$r\\left(\\frac{\\partial u_{\\mathrm{WKB}}}{\\partial r} - iku\\right) = r\\left(-\\frac{1}{r} \\pm ik - ik\\right)u_{\\mathrm{WKB}}$。\n对于‘$+$’号：$r\\left(-\\frac{1}{r}\\right)u_{\\mathrm{WKB}} = -u_{\\mathrm{WKB}} = -\\frac{C_{A}}{r}\\exp(ikr)$，当 $r\\to\\infty$ 时趋于 $0$。这对应于出射波。\n对于‘$-$’号：$r\\left(-\\frac{1}{r} - 2ik\\right)u_{\\mathrm{WKB}} = (-1 - 2ikr)u_{\\mathrm{WKB}}$，当 $r\\to\\infty$ 时发散。这对应于入射波。\n我们必须选择‘$+$’号，所以 $S(r) = r$。解为 $u_{\\mathrm{WKB}}(r) = \\frac{C_{A}}{r}\\exp(ikr)$。\n\n问题要求通过将此解与精确出射球面波 $u_{\\mathrm{exact}}(r) = \\frac{\\exp(ikr)}{r}$ 匹配来进行归一化。\n比较这两个表达式，我们看到常数 $C_{A}$ 必须为 $1$。\n因此，归一化后的领阶 WKB 解为：\n$$u_{\\mathrm{WKB}}(r) = \\frac{1}{r}\\exp(ikr)$$\n\n**第 4 步：误差分析**\n\n相对误差定义为 $E(k,r) = \\frac{u_{\\mathrm{WKB}}(r) - u_{\\mathrm{exact}}(r)}{u_{\\mathrm{exact}}(r)}$。\n代入 $u_{\\mathrm{WKB}}(r)$ 和 $u_{\\mathrm{exact}}(r)$ 的表达式：\n$$E(k,r) = \\frac{\\frac{1}{r}\\exp(ikr) - \\frac{1}{r}\\exp(ikr)}{\\frac{1}{r}\\exp(ikr)}$$\n对于所有 $r>0$，分子恒等于零。\n$$E(k,r) = 0$$\n这个结果源于三维均匀介质中亥姆霍兹方程的一个特性。应用于此问题时，WKB 近似过程得出了精确解。在推导输运方程时被忽略的项 $\\nabla^{2}A_0$，对于解 $A_{0}(r)=1/r$（当 $r \\neq 0$ 时）实际上为零，因为 $\\nabla^{2}(1/r) = -4\\pi\\delta(\\mathbf{x})$，在远离原点处为零。因此，领阶 WKB 解精确地满足亥姆霍兹方程，而不仅仅是渐近地满足。\n\n问题要求当 $kr\\to\\infty$ 时 $E(k,r)$ 的领阶渐近项。由于误差 $E(k,r)$ 对所有相关的 $k$ 和 $r$ 都恒等于零，其渐近展开也恒等于零。一个恒等于零的函数的领阶项就是零本身。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "对衍射的理论理解是第一步，而将其在仿真中实现则是关键的下一步。为了让计算模型能够应用GTD，它首先必须能稳健地识别出衍射发生的位置。这项实践要求您设计并实现探测边缘衍射事件的核心逻辑，将物理原理转化为精确的几何判据，这是任何现代射线追踪引擎的基石 。",
            "id": "4142696",
            "problem": "您必须设计并实现一个完整的、可运行的程序，该程序在计算声学中，根据几何衍射理论 (GTD) 对三维射线追踪器中的边缘衍射事件进行形式化和检测。该程序必须定义适当的数据结构，并实现几何可采纳性准则，以针对每个测试用例判断是否存在有效的边缘衍射事件。检测逻辑必须从高频声学的第一性原理推导得出，不得使用本说明中提供的快捷公式。所有距离必须以米表示，所有频率以赫兹表示，所有速度以米/秒表示，所有角度以弧度表示。\n\n设置和约束如下。\n\n- 基本原理：\n  - 从均匀介质中声速为常数 $c$ 的压力场 $p(\\mathbf{x},t)$ 的声波方程出发，并从高频渐近（射线）机制出发，在该机制中，相位 $S(\\mathbf{x})$ 满足程函方程，振幅沿射线传播。\n  - 采纳经典理解，即衍射是作为边缘对高频渐近的贡献而产生的，产生从几何边缘发出的衍射射线，其方向受到边缘几何形状和入射射线方向的约束，这与几何衍射理论相符。\n  - 对于频率 $f$ 和声速 $c$，将声波数 $k$ 定义为 $k = \\frac{2\\pi f}{c}$。\n\n- 所需数据结构：\n  - 一条射线，由原点 $\\mathbf{x}_0 \\in \\mathbb{R}^3$（单位：米）、单位方向 $\\mathbf{u} \\in \\mathbb{R}^3$、频率 $f$（单位：赫兹）和声速 $c$（单位：米/秒）来表征。\n  - 一条边缘，由端点 $\\mathbf{p}_0,\\mathbf{p}_1 \\in \\mathbb{R}^3$（单位：米）以及构成楔形体的两个相邻平面的外向单位法向量 $\\mathbf{n}_1,\\mathbf{n}_2 \\in \\mathbb{R}^3$ 来表征。楔角 $\\alpha$ 是两个面法向量之间的夹角，且必须在开区间 $(0,\\pi)$ 内。\n\n- 需从第一性原理实现的检测准则：\n  - 局部几何邻近性测试，用于确定入射射线是否足够靠近边缘线，其最近距离 $\\rho$ 受一个具有物理动机的阈值 $r_c$ 的限制。您必须根据 $k$ 和每个测试用例提供的无量纲参数 $\\beta$ 来表示 $r_c$。\n  - 前向传播可采纳性测试，用于确定最近点是否位于射线的前向传播方向上。\n  - 线段可采纳性测试，用于确定最近点是否投影到 $\\mathbf{p}_0$ 和 $\\mathbf{p}_1$ 之间的有限边缘线段上。\n  - 照亮测试，用于确定两个面中是否至少有一个被入射射线方向照亮，这符合 GTD 中边缘衍射是由楔形体的照亮所激发的概念。\n  - 简并排除测试，用于排除入射射线方向与边缘近乎平行的配置，该测试由每个测试用例提供的小角度阈值 $\\gamma_{\\min}$ 控制。\n\n- 输出规范：\n  - 您的程序必须对提供的测试套件中的每个测试用例进行检测评估，并生成一行输出，其中包含用方括号括起的、以逗号分隔的布尔结果列表。例如，输出必须类似于 $[\\text{result}_1,\\text{result}_2,\\dots]$。\n\n- 测试套件（所有向量单位为米；角度单位为弧度；速度单位为米/秒；频率单位为赫兹）：\n  - 所有测试用例中使用的全局常量：$c = 343\\,\\mathrm{m/s}$，$\\beta = 2.0$，以及 $\\gamma_{\\min} = 0.01$。\n  - 测试用例 1（正常路径）：\n    - 射线：$\\mathbf{x}_0 = (-0.02,-0.02,0.5)$，$\\mathbf{u} = (1,1,0)$ 归一化， $f = 1000$。\n    - 边缘：$\\mathbf{p}_0 = (0,0,0)$，$\\mathbf{p}_1 = (0,0,1)$，$\\mathbf{n}_1 = (-1,0,0)$，$\\mathbf{n}_2 = (0,-1,0)$。\n    - 在正确推导准则后，预计为可采纳。\n  - 测试用例 2（超出邻近性阈值）：\n    - 射线：$\\mathbf{x}_0 = (-0.1,-0.3,0.5)$，$\\mathbf{u} = (1,1,0)$ 归一化， $f = 1000$。\n    - 边缘：$\\mathbf{p}_0 = (0,0,0)$，$\\mathbf{p}_1 = (0,0,1)$，$\\mathbf{n}_1 = (-1,0,0)$，$\\mathbf{n}_2 = (0,-1,0)$。\n    - 在正确推导后，预计邻近性测试失败。\n  - 测试用例 3（最近点在有限线段之外）：\n    - 射线：$\\mathbf{x}_0 = (-0.02,-0.02,0.5)$，$\\mathbf{u} = (1,1,0)$ 归一化， $f = 1000$。\n    - 边缘：$\\mathbf{p}_0 = (0,0,0)$，$\\mathbf{p}_1 = (0,0,0.4)$，$\\mathbf{n}_1 = (-1,0,0)$，$\\mathbf{n}_2 = (0,-1,0)$。\n    - 在正确推导后，预计线段可采纳性测试失败。\n  - 测试用例 4（未被照亮的楔形体）：\n    - 射线：$\\mathbf{x}_0 = (-0.02,-0.02,0.5)$，$\\mathbf{u} = (-1,-1,0)$ 归一化， $f = 1000$。\n    - 边缘：$\\mathbf{p}_0 = (0,0,0)$，$\\mathbf{p}_1 = (0,0,1)$，$\\mathbf{n}_1 = (-1,0,0)$，$\\mathbf{n}_2 = (0,-1,0)$。\n    - 在正确推导后，预计照亮测试失败。\n  - 测试用例 5（近乎平行的简并情况）：\n    - 射线：$\\mathbf{x}_0 = (-0.05,0.05,0.5)$，$\\mathbf{u} = (0,0,1)$，$f = 1000$。\n    - 边缘：$\\mathbf{p}_0 = (0,0,0)$，$\\mathbf{p}_1 = (0,0,1)$，$\\mathbf{n}_1 = (-1,0,0)$，$\\mathbf{n}_2 = (0,-1,0)$。\n    - 在正确推导后，预计简并排除测试失败。\n\n您的程序必须以一种在坐标系刚体运动下保持不变的方式实现检测函数。最终的打印语句必须按照上述指定的单行格式精确生成一行输出，其中的布尔值按顺序对应五个测试用例。",
            "solution": "所提出的问题是构建一个用于在三维声学射线追踪器中检测边缘衍射事件的计算流程，该流程需符合几何衍射理论 (GTD)。检测将基于一套五个可采纳性准则，这些准则必须从第一性原理推导得出。整个公式体系必须在坐标系的刚体运动下保持不变。\n\n首先，我们建立所涉及实体的数学表示。一条射线是一条半无限直线，由其原点 $\\mathbf{x}_0 \\in \\mathbb{R}^3$、单位方向向量 $\\mathbf{u} \\in \\mathbb{R}^3$ 和路径长度参数 $t \\ge 0$ 进行参数化。射线上的一个点由 $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$ 给出。一条边缘是由其端点 $\\mathbf{p}_0 \\in \\mathbb{R}^3$ 和 $\\mathbf{p}_1 \\in \\mathbb{R}^3$ 定义的有限线段。我们通过点 $\\mathbf{p}_0$ 和单位方向向量 $\\mathbf{e} = (\\mathbf{p}_1 - \\mathbf{p}_0) / \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$ 来定义相关的无限边缘线。该线上的一个点由 $\\mathbf{p}(s) = \\mathbf{p}_0 + s\\mathbf{e}$ 给出，其中 $s \\in \\mathbb{R}$。有限边缘线段对应于区间 $s \\in [0, L_e]$，其中 $L_e = \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$ 是边缘的长度。楔形体的几何形状由在边缘处相交的两个平面的外向单位法向量 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$ 进一步指定。这些法向量之间的夹角 $\\alpha$ 由 $\\alpha = \\arccos(\\mathbf{n}_1 \\cdot \\mathbf{n}_2)$ 给出，被限制在区间 $(0, \\pi)$ 内，这确保了这些面形成一个非简并的楔形体。在完整的 GTD 模型中，这个角度对于计算衍射系数至关重要，但对于检测逻辑本身并非直接需要。\n\n我们的解决方案建立在五个准则的矢量代数公式之上，这保证了在刚体运动（平移和旋转）下的不变性，因为点积和叉积等矢量运算内在地与坐标系无关。\n\n现在我们为五个准则中的每一个推导其形式化测试。\n\n1.  **简并排除测试**：此测试防止入射射线与边缘近乎平行的配置。此类情况通常由不同的物理近似（例如，等效边缘流）处理，并会导致标准衍射公式出现奇异点。条件是射线方向 $\\mathbf{u}$ 与边缘方向 $\\mathbf{e}$ 之间的夹角 $\\gamma$ 不能太接近 $0$ 或 $\\pi$。设 $\\gamma_{\\min}$ 为一个小角度阈值。可采纳性条件是 $\\gamma > \\gamma_{\\min}$ 和 $\\pi - \\gamma > \\gamma_{\\min}$。由于 $\\gamma \\in [0, \\pi]$，这等价于 $\\sin\\gamma > \\sin\\gamma_{\\min}$。使用恒等式 $\\|\\mathbf{u} \\times \\mathbf{e}\\| = \\|\\mathbf{u}\\|\\|\\mathbf{e}\\|\\sin\\gamma$ 以及 $\\mathbf{u}$ 和 $\\mathbf{e}$ 是单位向量的事实，我们得到 $\\sin\\gamma = \\|\\mathbf{u} \\times \\mathbf{e}\\|$。此外，根据拉格朗日恒等式，$\\|\\mathbf{u} \\times \\mathbf{e}\\|^2 = \\|\\mathbf{u}\\|^2\\|\\mathbf{e}\\|^2 - (\\mathbf{u} \\cdot \\mathbf{e})^2 = 1 - (\\mathbf{u} \\cdot \\mathbf{e})^2$。因此，测试变为 $1 - (\\mathbf{u} \\cdot \\mathbf{e})^2 > \\sin^2(\\gamma_{\\min})$。首先执行此检查，以防止在后续计算中出现除以接近零的分母的情况。\n\n2.  **照亮测试**：为使边缘衍射入射射线，该射线必须照亮构成楔形体的至少一个面。对于一个具有外向法向量 $\\mathbf{n}$ 的平面，如果方向为 $\\mathbf{u}$ 的射线撞击其“正面”，则该平面被照亮。这种情况发生在 $\\mathbf{u}$ 和 $\\mathbf{n}$ 之间的夹角为钝角，即大于 $\\pi/2$ 时。代数条件是 $\\mathbf{u} \\cdot \\mathbf{n}  0$。给定两个面法向量 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$，如果 $(\\mathbf{u} \\cdot \\mathbf{n}_1  0) \\lor (\\mathbf{u} \\cdot \\mathbf{n}_2  0)$，则认为边缘被照亮。如果 $\\mathbf{u} \\cdot \\mathbf{n}_1 \\ge 0$ 且 $\\mathbf{u} \\cdot \\mathbf{n}_2 \\ge 0$，则射线从楔形体的几何阴影区接近，不能在边缘处激发衍射。\n\n3.  **局部几何邻近性测试**：在高频声学中，衍射是一种局部现象。一条射线必须“足够近”地通过一条边缘才能激发衍射场。无限射线与无限边缘线之间的最近距离 $\\rho$ 必须小于一个具有物理动机的阈值 $r_c$。两条异面直线 $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$ 和 $\\mathbf{p}(s) = \\mathbf{p}_0 + s\\mathbf{e}$ 之间的距离 $\\rho$ 是连接它们原点的向量 $\\mathbf{w}_0 = \\mathbf{p}_0 - \\mathbf{x}_0$ 在两条线公垂单位向量上的投影长度。该公垂单位向量为 $\\hat{\\mathbf{n}}_{perp} = (\\mathbf{u} \\times \\mathbf{e}) / \\|\\mathbf{u} \\times \\mathbf{e}\\|$。因此，距离为 $\\rho = |\\mathbf{w}_0 \\cdot \\hat{\\mathbf{n}}_{perp}| = \\frac{|(\\mathbf{p}_0 - \\mathbf{x}_0) \\cdot (\\mathbf{u} \\times \\mathbf{e})|}{\\|\\mathbf{u} \\times \\mathbf{e}\\|}$。阈值 $r_c$ 被定义为与声波波长 $\\lambda = c/f = 2\\pi/k$ 成正比，其中 $k = 2\\pi f/c$ 是声波数。问题将 $r_c$ 用 $k$ 和一个无量纲参数 $\\beta$ 来表示，我们将其形式化为 $r_c = \\beta/k$。测试条件是 $\\rho  r_c$。\n\n为了执行最后两个测试，我们必须找到分别对应于边缘线和射线上最近点的参数 $s_{ca}$ 和 $t_{ca}$。这些参数使平方距离 $\\|(\\mathbf{p}_0 + s\\mathbf{e}) - (\\mathbf{x}_0 + t\\mathbf{u})\\|^2$ 最小化。将关于 $s$ 和 $t$ 的偏导数设为零，得到一个关于 $s$ 和 $t$ 的线性方程组：\n$$\n\\begin{pmatrix} 1  -(\\mathbf{u}\\cdot\\mathbf{e}) \\\\ -(\\mathbf{u}\\cdot\\mathbf{e})  1 \\end{pmatrix}\n\\begin{pmatrix} s \\\\ -t \\end{pmatrix} =\n\\begin{pmatrix} -(\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e} \\\\ -(\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u} \\end{pmatrix}\n$$\n解此方程组可得：\n$$s_{ca} = \\frac{(\\mathbf{u}\\cdot\\mathbf{e})((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u}) - ((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e})}{1 - (\\mathbf{u}\\cdot\\mathbf{e})^2}$$\n$$t_{ca} = \\frac{((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u}) - (\\mathbf{u}\\cdot\\mathbf{e})((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e})}{1 - (\\mathbf{u}\\cdot\\mathbf{e})^2}$$\n\n4.  **前向传播可采纳性测试**：射线参数化 $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$ 定义了一个传播方向。物理相互作用只能发生在射线原点的“下游”。因此，对应于射线上最近点的参数 $t_{ca}$ 必须为正。测试条件是 $t_{ca} > 0$。\n\n5.  **线段可采纳性测试**：衍射点必须物理上位于有限的材料边缘上。无限边缘线上的最近点是 $\\mathbf{p}(s_{ca})$。此点必须位于由 $\\mathbf{p}_0$ 和 $\\mathbf{p}_1$ 定义的线段内。这对应于参数 $s_{ca}$ 在区间 $[0, L_e]$ 内，其中 $L_e = \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$。测试条件是 $0 \\le s_{ca} \\le L_e$。\n\n当且仅当所有这五个准则都满足时，衍射事件才是可采纳的。实现将按顺序评估这些测试，一旦有任何一个测试失败，便会终止并返回 `False`。如果所有测试都通过，则返回 `True`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef is_diffraction_admissible(ray_params, edge_params, constants):\n    \"\"\"\n    Checks if a ray-edge interaction constitutes a valid diffraction event\n    based on Geometrical Theory of Diffraction (GTD) criteria.\n\n    Args:\n        ray_params (dict): Dictionary with ray parameters:\n            'x0': np.array, origin of the ray (m).\n            'u': np.array, direction of the ray (unnormalized).\n            'f': float, frequency of the wave (Hz).\n        edge_params (dict): Dictionary with edge parameters:\n            'p0': np.array, first endpoint of the edge segment (m).\n            'p1': np.array, second endpoint of the edge segment (m).\n            'n1': np.array, outward normal of the first face.\n            'n2': np.array, outward normal of the second face.\n        constants (dict): Dictionary with global constants:\n            'c': float, speed of sound (m/s).\n            'beta': float, dimensionless parameter for proximity threshold.\n            'gamma_min': float, minimum angle for non-parallelism (rad).\n\n    Returns:\n        bool: True if the diffraction event is admissible, False otherwise.\n    \"\"\"\n    # Extract parameters and perform initial calculations\n    x0, u_unnormalized, f = ray_params['x0'], ray_params['u'], ray_params['f']\n    p0, p1, n1, n2 = edge_params['p0'], edge_params['p1'], edge_params['n1'], edge_params['n2']\n    c, beta, gamma_min = constants['c'], constants['beta'], constants['gamma_min']\n\n    # Normalize ray direction vector\n    u = u_unnormalized / np.linalg.norm(u_unnormalized)\n\n    # Calculate edge vector, direction, and length\n    edge_vec = p1 - p0\n    Le = np.linalg.norm(edge_vec)\n    if Le == 0:  # Degenerate edge\n        return False\n    e = edge_vec / Le\n\n    # --- Criterion 5: Degeneracy Exclusion Test ---\n    # Check for near-parallelism between ray and edge\n    ue_dot = np.dot(u, e)\n    # sin^2(gamma) = 1 - cos^2(gamma) = 1 - (u.e)^2\n    sin2_gamma = 1.0 - ue_dot**2\n    if sin2_gamma = np.sin(gamma_min)**2:\n        return False\n\n    # --- Criterion 4: Illumination Test ---\n    # At least one face must be illuminated by the ray\n    un1_dot = np.dot(u, n1)\n    un2_dot = np.dot(u, n2)\n    if not (un1_dot  0 or un2_dot  0):\n        return False\n\n    # --- Criterion 1: Local Geometric Proximity Test ---\n    # Distance of closest approach between ray and edge line\n    k = 2.0 * np.pi * f / c\n    rc = beta / k  # Proximity threshold\n    w0 = p0 - x0\n    \n    # rho = |w0 . (u x e)| / ||u x e||\n    # ||u x e|| = sin(gamma)\n    # The scalar triple product w0 . (u x e) can be computed with a determinant\n    rho = np.abs(np.dot(w0, np.cross(u, e))) / np.sqrt(sin2_gamma)\n    \n    if not (rho  rc):\n        return False\n\n    # --- Calculate closest-approach parameters s_ca and t_ca ---\n    # These are needed for the final two tests\n    w0e_dot = np.dot(w0, e)\n    w0u_dot = np.dot(w0, u)\n    \n    # Denominator is sin^2(gamma), already calculated as sin2_gamma\n    denom = sin2_gamma\n    \n    # Parameter for the point on the edge line\n    sca = (ue_dot * w0u_dot - w0e_dot) / denom\n    \n    # Parameter for the point on the ray line\n    tca = (w0u_dot - ue_dot * w0e_dot) / denom\n    \n    # --- Criterion 2: Forward-Propagation Admissibility Test ---\n    # Closest-approach point must be in the forward direction of the ray\n    if not (tca > 0):\n        return False\n\n    # --- Criterion 3: Segment Admissibility Test ---\n    # Closest-approach point must lie on the finite edge segment\n    if not (0 = sca = Le):\n        return False\n\n    # If all tests pass, the event is admissible\n    return True\n\ndef solve():\n    \"\"\"\n    Defines the test suite and runs the diffraction detection logic for each case.\n    \"\"\"\n    constants = {\n        'c': 343.0,\n        'beta': 2.0,\n        'gamma_min': 0.01\n    }\n\n    test_cases = [\n        # Test Case 1 (happy path)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 2 (outside proximity threshold)\n        {\n            'ray': {'x0': np.array([-0.1, -0.3, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 3 (closest point outside the finite segment)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 0.4]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 4 (non-illuminated wedge)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([-1.0, -1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 5 (near-parallel degeneracy)\n        {\n            'ray': {'x0': np.array([-0.05, 0.05, 0.5]), 'u': np.array([0.0, 0.0, 1.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_diffraction_admissible(case['ray'], case['edge'], constants)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在复杂的声学环境中，声波可以通过边缘、顶点等不同几何特征的衍射到达接收点。GTD的一个关键洞见是，这些不同类型的衍射其贡献度并不相等。本练习旨在揭示衍射现象的层级结构，通过比较边缘衍射场和顶点衍射场的渐近幅度缩放规律，您将为“为何边缘衍射通常是修正几何声学的主要一阶效应”这一观点建立起定量的认知 。",
            "id": "4142723",
            "problem": "考虑一个角频率为 $\\omega$ 的时谐声学点源，其复强度为 $S$，在声速为 $c$ 的均匀、无损耗流体中辐射。设波数为 $k = \\omega/c$。声压 $p(\\mathbf{x})$ 满足标量亥姆霍兹方程，自由空间格林函数为 $G(\\mathbf{x},\\mathbf{y}) = \\frac{\\exp(i k |\\mathbf{x}-\\mathbf{y}|)}{4\\pi |\\mathbf{x}-\\mathbf{y}|}$。一个接收器位于距离一个由三个相互正交的理想刚性平面构成的房间角落 $R$ 处。声源也位于距离该角落 $R$ 处，使得能量仅通过从顶点（三面角）发出的衍射线传输到接收器。假设处于高频区域 $k R \\gg 1$。使用几何衍射理论 (Geometrical Theory of Diffraction, GTD)，将顶点衍射的贡献建模为源自角落的局部邻域，并计算在接收器处顶点衍射声压 $|p_{\\mathrm{v}}|$ 的前导阶渐近幅度标度（忽略量级为1的衍射系数和相位因子），用 $k$ 和 $R$ 表示。然后，考虑一个具有相同声源和接收器几何形状的替代路径，但衍射发生在单个直角楔形边（棱边衍射）上，并计算相应的前导阶幅度标度 $|p_{\\mathrm{e}}|$。最后，在可以忽略量级为1的常数（包括与楔形和角落相关的衍射系数及数值因子）且总衍射路径长度与 $R$ 相当的假设下，以 $k$ 和 $R$ 的形式给出一个单一的闭式解析表达式来表示比率 $|p_{\\mathrm{v}}|/|p_{\\mathrm{e}}|$。\n\n将最终比率表示为单个闭式表达式。无需进行数值计算。如果简化需要选择路径长度，则假定其与 $R$ 成正比，并在最终表达式中忽略量级为1的比例常数。你的最终答案必须是一个无单位的单一解析表达式。",
            "solution": "解决方案基于几何衍射理论 (GTD) 的原理，分别分析顶点和棱边情况下衍射声压的标度。\n\n**1. 顶点衍射标度 ($|p_{\\mathrm{v}}|$ )**\n\n根据 GTD，衍射场可以通过考虑衍射点处的入射场来计算，该入射场随后充当次级源。对于顶点衍射，接收器位置处的衍射场 $p_{\\mathrm{v}}$ 由下式给出：\n$$ p_{\\mathrm{v}} \\approx p_{\\mathrm{inc}}(V) \\cdot D_{\\mathrm{v}} \\cdot A_{\\mathrm{v}}(s_{\\mathrm{d}}) \\cdot \\exp(i k s_{\\mathrm{d}}) $$\n其中 $V$ 是顶点位置，$p_{\\mathrm{inc}}(V)$ 是顶点处的入射声压，$D_{\\mathrm{v}}$ 是顶点衍射系数，$s_{\\mathrm{d}}$ 是从顶点到接收器的距离，$A_{\\mathrm{v}}(s_{\\mathrm{d}})$ 是衍射波的空间扩展因子。\n\n-   **入射场**：声源是距离顶点 $s_{\\mathrm{i}} = R$ 的点源。顶点处入射声压的幅度与此距离成反比：\n    $$ |p_{\\mathrm{inc}}(V)| \\propto \\frac{1}{s_{\\mathrm{i}}} = \\frac{1}{R} $$\n\n-   **扩展因子**：顶点充当点衍射体，辐射球面波。该球面波的振幅随距顶点距离 $s_{\\mathrm{d}}$ 的增加而反比衰减。接收器距离顶点 $s_{\\mathrm{d}} = R$。因此，扩展因子的幅度为：\n    $$ |A_{\\mathrm{v}}(R)| = \\frac{1}{R} $$\n\n-   **衍射系数**：顶点衍射系数 $D_{\\mathrm{v}}$ 取决于角落的几何形状以及入射和衍射的角度。关键是，其幅度与波数 $k$ 成标度关系。衍射场源于对顶点附近表面区域上的二维物理光学积分的稳相点评估。此评估引入了一个因子 $k^{-1}$。因此，顶点衍射系数的幅度具有以下标度关系：\n    $$ |D_{\\mathrm{v}}| \\propto \\frac{1}{k} $$\n\n-   **$|p_{\\mathrm{v}}|$ 的总标度**：综合这些因素，接收器处顶点衍射声压的幅度标度如下：\n    $$ |p_{\\mathrm{v}}| \\propto |p_{\\mathrm{inc}}(V)| \\cdot |D_{\\mathrm{v}}| \\cdot |A_{\\mathrm{v}}(R)| \\propto \\frac{1}{R} \\cdot \\frac{1}{k} \\cdot \\frac{1}{R} = \\frac{1}{k R^2} $$\n\n**2. 棱边衍射标度 ($|p_{\\mathrm{e}}|$ )**\n\n对于棱边衍射，衍射场 $p_{\\mathrm{e}}$ 由类似的 GTD 表达式给出：\n$$ p_{\\mathrm{e}} \\approx p_{\\mathrm{inc}}(Q) \\cdot D_{\\mathrm{e}} \\cdot A_{\\mathrm{e}}(s_{\\mathrm{d}}) \\cdot \\exp(i k s_{\\mathrm{d}}) $$\n其中 $Q$ 是棱边上的衍射点，$D_{\\mathrm{e}}$ 是棱边衍射系数，$A_{\\mathrm{e}}(s_{\\mathrm{d}})$ 是相应的扩展因子。\n\n-   **路径长度**：问题指明了“相同的声源和接收器几何形状”以及“总衍射路径长度与 $R$ 相当”。这意味着入射路径长度 $s_{\\mathrm{i}}$（声源到棱边）和衍射路径长度 $s_{\\mathrm{d}}$（棱边到接收器）都在 $R$ 的量级。因此，我们取 $s_{\\mathrm{i}} \\sim R$ 和 $s_{\\mathrm{d}} \\sim R$。\n\n-   **入射场和扩展因子**：棱边处的入射场来自点源，因此 $|p_{\\mathrm{inc}}(Q)| \\propto 1/s_{\\mathrm{i}}$。由球面波激励的直边衍射波，其一个主曲率半径随离边距离 $s_{\\mathrm{d}}$ 线性增长，而另一个主曲率半径则取决于与声源的距离。组合效应由一个像散射线管描述。从声源经由棱边衍射到接收器的总路径的振幅衰减由下式给出：\n    $$ \\frac{|p_{\\mathrm{e}}|}{|S|} \\propto \\frac{1}{\\sqrt{s_{\\mathrm{i}} s_{\\mathrm{d}} (s_{\\mathrm{i}} + s_{\\mathrm{d}})}} $$\n    当 $s_{\\mathrm{i}} \\sim R$ 和 $s_{\\mathrm{d}} \\sim R$ 时，空间衰减的标度为：\n    $$ \\frac{1}{\\sqrt{R \\cdot R \\cdot (R+R)}} = \\frac{1}{\\sqrt{2 R^3}} \\propto \\frac{1}{R^{3/2}} $$\n\n-   **衍射系数**：棱边衍射系数 $D_{\\mathrm{e}}$ 源于沿棱边的物理光学积分的一维稳相点评估。此评估引入了一个因子 $k^{-1/2}$。因此，棱边衍射过程本身的幅度贡献了一个标度因子：\n    $$ |D_{\\mathrm{e}}| \\propto \\frac{1}{\\sqrt{k}} $$\n\n-   **$|p_{\\mathrm{e}}|$ 的总标度**：结合空间和频率相关的标度，我们得到：\n    $$ |p_{\\mathrm{e}}| \\propto \\frac{1}{\\sqrt{k}} \\cdot \\frac{1}{R^{3/2}} = \\frac{1}{\\sqrt{k} R^{3/2}} $$\n\n**3. 幅度之比 ($|p_{\\mathrm{v}}| / |p_{\\mathrm{e}}|$ )**\n\n最后，我们计算顶点衍射声压幅度与棱边衍射声压幅度之比。问题陈述允许我们忽略所有量级为1的常数，只关注与 $k$ 和 $R$ 相关的标度。\n$$ \\frac{|p_{\\mathrm{v}}|}{|p_{\\mathrm{e}}|} = \\frac{C_{\\mathrm{v}} (k R^2)^{-1}}{C_{\\mathrm{e}} (k^{1/2} R^{3/2})^{-1}} $$\n其中 $C_{\\mathrm{v}}$ 和 $C_{\\mathrm{e}}$ 是我们忽略的量级为1的常数。\n$$ \\frac{|p_{\\mathrm{v}}|}{|p_{\\mathrm{e}}|} \\propto \\frac{k^{1/2} R^{3/2}}{k R^2} = k^{1/2 - 1} R^{3/2 - 2} = k^{-1/2} R^{-1/2} = (kR)^{-1/2} $$\n这可以写成：\n$$ \\frac{1}{\\sqrt{kR}} $$\n这一结果证实了 GTD 中的基本层级关系：在高频极限下 ($kR \\gg 1$)，顶点衍射场渐近地小于棱边衍射场。",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{kR}}}$$"
        }
    ]
}