{
    "hands_on_practices": [
        {
            "introduction": "The fundamental premise of hybrid methods like FEM-SEA coupling is to apply the most appropriate computational technique for a given frequency range. This practice provides the theoretical underpinning for this decision by guiding you through the derivation of modal density, a key parameter that dictates the validity of Statistical Energy Analysis (SEA) . By connecting the physical properties of a structure and an acoustic cavity to their high-frequency modal behavior, you will gain a foundational understanding of the criteria used to transition from deterministic (FEM) to statistical (SEA) models in vibro-acoustic analysis.",
            "id": "4126648",
            "problem": "Consider a vibroacoustic system comprised of a thin, homogeneous, isotropic elastic plate closing a rigid-walled rectangular acoustic cavity. The plate is modeled by the Kirchhoff–Love theory, and the cavity is modeled by the scalar acoustic wave equation under rigid boundary conditions. Let the cavity dimensions be $L_{x}$, $L_{y}$, and $L_{z}$, so its volume is $V = L_{x} L_{y} L_{z}$. Let the plate dimensions be $L_{x}$ and $L_{y}$, so its area is $S = L_{x} L_{y}$, thickness is $h$, mass density is $\\rho$, Young’s modulus is $E$, and Poisson’s ratio is $\\nu$. The acoustic medium has sound speed $c$. Assume high-frequency asymptotics where mode counting via phase-space volume is applicable. \n\nStarting from the governing equations appropriate to each subsystem and without invoking any pre-specified counting formulas, derive the asymptotic expressions for the modal density $n(\\omega)$ in terms of angular frequency $\\omega$ for:\n- the rectangular acoustic cavity, and\n- the thin elastic plate.\n\nExpress the cavity modal density $n_{\\mathrm{cav}}(\\omega)$ in terms of $V$ and $c$, and the plate modal density $n_{\\mathrm{plate}}(\\omega)$ in terms of $S$, $h$, $\\rho$, and the bending stiffness $D$. Then write $D$ in terms of $E$, $h$, and $\\nu$. Present the final modal density expressions in closed form.\n\nFinally, using the Statistical Energy Analysis (SEA) modal overlap criterion in angular frequency form $m(\\omega) = \\eta \\, \\omega \\, n(\\omega)$, where $\\eta$ is a dimensionless loss factor for the subsystem, discuss the frequency ranges where SEA assumptions are expected to be valid for the cavity and the plate. Explain briefly how these ranges inform hybrid coupling strategies between the Finite Element Method (FEM) and Statistical Energy Analysis (SEA), and between the Finite Element Method (FEM) or the Boundary Element Method (BEM) and Statistical Energy Analysis (SEA).\n\nYour final answer must be the two derived modal density expressions as a single closed-form analytic row vector. Do not include units in your final answer.",
            "solution": "The objective is to derive high-frequency asymptotic expressions for the modal density $n(\\omega)$ for the acoustic cavity and the thin plate. The modal density $n(\\omega)$ is defined as $n(\\omega) = \\frac{\\mathrm{d}N(\\omega)}{\\mathrm{d}\\omega}$, where $N(\\omega)$ is the number of modes with natural angular frequency less than or equal to $\\omega$. We use asymptotic mode counting via phase-space volume, which is a well-tested approach grounded in the spectral properties of elliptic operators and known as Weyl-type estimates for large wavenumber.\n\nFor the acoustic cavity, the governing equation for time-harmonic acoustic pressure $p(\\mathbf{x}, t) = P(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ under rigid boundaries is\n$$\n\\nabla^{2} P + k^{2} P = 0,\n$$\nwith dispersion relation\n$$\n\\omega = c k,\n$$\nwhere $k = |\\mathbf{k}|$ is the acoustic wavenumber and $c$ is the sound speed. The eigenvalues correspond to discrete wavenumbers indexed by integer triplets $(n_{x}, n_{y}, n_{z})$ determined by the cavity dimensions. In the high-frequency limit, the number of modes with $|\\mathbf{k}| \\leq k$ can be obtained by counting the integer lattice points in the positive octant of a sphere of radius $k$ in $\\mathbf{k}$-space and approximating by the volume. The fundamental cell volume in $\\mathbf{k}$-space is $(\\pi/L_{x})(\\pi/L_{y})(\\pi/L_{z}) = \\pi^{3}/V$. The volume of the positive octant of the sphere is $\\frac{1}{8} \\cdot \\frac{4}{3} \\pi k^{3} = \\frac{1}{6} \\pi k^{3}$. Therefore, the leading-order counting function is\n$$\nN_{\\mathrm{cav}}(k) \\approx \\frac{\\frac{1}{6} \\pi k^{3}}{\\pi^{3}/V} = \\frac{V k^{3}}{6 \\pi^{2}}.\n$$\nUsing the dispersion relation $\\omega = c k$, we obtain\n$$\nN_{\\mathrm{cav}}(\\omega) \\approx \\frac{V}{6 \\pi^{2}} \\left( \\frac{\\omega}{c} \\right)^{3} = \\frac{V \\, \\omega^{3}}{6 \\pi^{2} c^{3}}.\n$$\nDifferentiating with respect to $\\omega$ yields the modal density for the cavity,\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{cav}}}{\\mathrm{d}\\omega} = \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}}.\n$$\n\nFor the thin elastic plate, the Kirchhoff–Love plate equation for time-harmonic transverse displacement $w(\\mathbf{x}, t) = W(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ is\n$$\nD \\nabla^{4} W - \\rho h \\, \\omega^{2} W = 0,\n$$\nwhere $D$ is the bending stiffness. Introducing the bending wavenumber $k$ by writing the biharmonic eigenproblem as\n$$\n\\nabla^{4} W - k^{4} W = 0,\n$$\nthe dispersion relation follows from balancing $D k^{4} W = \\rho h \\, \\omega^{2} W$, giving\n$$\n\\omega = \\sqrt{\\frac{D}{\\rho h}} \\, k^{2}.\n$$\nDefine the parameter\n$$\n\\beta = \\sqrt{\\frac{D}{\\rho h}},\n$$\nso that the dispersion relation is $\\omega = \\beta k^{2}$. For a two-dimensional domain, the high-frequency counting function for wavenumbers $|\\mathbf{k}| \\leq k$ is given by the area of a quarter circle in $\\mathbf{k}$-space divided by the $\\mathbf{k}$-space cell area. The $\\mathbf{k}$-space cell area is $(\\pi/L_{x})(\\pi/L_{y}) = \\pi^{2}/S$, and the area of the positive quadrant of the circle is $\\frac{1}{4} \\cdot \\pi k^{2}$. Hence,\n$$\nN_{\\mathrm{plate}}(k) \\approx \\frac{\\frac{1}{4} \\pi k^{2}}{\\pi^{2}/S} = \\frac{S k^{2}}{4 \\pi}.\n$$\nUsing $\\omega = \\beta k^{2}$, we have $k^{2} = \\omega / \\beta$, and thus\n$$\nN_{\\mathrm{plate}}(\\omega) \\approx \\frac{S}{4 \\pi} \\frac{\\omega}{\\beta}.\n$$\nDifferentiating with respect to $\\omega$ yields the plate modal density,\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{plate}}}{\\mathrm{d}\\omega} = \\frac{S}{4 \\pi} \\frac{1}{\\beta} = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$\nThe bending stiffness is\n$$\nD = \\frac{E h^{3}}{12 \\left( 1 - \\nu^{2} \\right)}.\n$$\nIf desired, substituting $D$ gives\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{ \\frac{\\rho h}{\\frac{E h^{3}}{12 (1 - \\nu^{2})}} } = \\frac{S}{4 \\pi} \\sqrt{ \\frac{12 (1 - \\nu^{2}) \\, \\rho}{E h^{2}} }.\n$$\n\nWe now address Statistical Energy Analysis (SEA) validity via the modal overlap criterion. The modal overlap in angular frequency form is\n$$\nm(\\omega) = \\eta \\, \\omega \\, n(\\omega),\n$$\nwhere $\\eta$ is the dimensionless loss factor representing damping. SEA assumptions are typically valid when $m(\\omega)$ is sufficiently large, often $m(\\omega) \\gtrsim 3$ being a pragmatic threshold for strong modal overlap.\n\nFor the cavity,\n$$\nm_{\\mathrm{cav}}(\\omega) = \\eta \\, \\omega \\, \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}} = \\frac{\\eta V}{2 \\pi^{2} c^{3}} \\, \\omega^{3},\n$$\nwhich grows as $\\omega^{3}$. A threshold angular frequency for SEA validity can be estimated by solving $m_{\\mathrm{cav}}(\\omega) = 3$,\n$$\n\\omega_{\\mathrm{SEA,cav}} \\approx \\left( \\frac{6 \\pi^{2} c^{3}}{\\eta V} \\right)^{1/3}.\n$$\nThis indicates that larger cavity volumes $V$ and smaller damping $\\eta$ push SEA validity to higher frequencies, whereas smaller volumes and higher damping bring the SEA regime down.\n\nFor the plate,\n$$\nm_{\\mathrm{plate}}(\\omega) = \\eta \\, \\omega \\, \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} = \\frac{\\eta S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} \\, \\omega,\n$$\nwhich grows linearly with $\\omega$. The threshold angular frequency follows from $m_{\\mathrm{plate}}(\\omega) = 3$,\n$$\n\\omega_{\\mathrm{SEA,plate}} \\approx \\frac{12 \\pi}{\\eta S} \\sqrt{ \\frac{D}{\\rho h} } = \\frac{12 \\pi \\beta}{\\eta S }.\n$$\nThis shows that larger plate area $S$ and smaller damping $\\eta$ push SEA validity to higher frequencies, while smaller areas or higher damping lower the SEA onset.\n\nImplications for hybrid coupling between the Finite Element Method (FEM) and Statistical Energy Analysis (SEA), and between the Finite Element Method (FEM) or the Boundary Element Method (BEM) and Statistical Energy Analysis (SEA), follow from these trends. In practice, one performs detailed deterministic modeling (FEM for the plate, FEM or BEM for the cavity) up to a crossover frequency where $m(\\omega)$ becomes sufficiently large for the subsystem, above which SEA is employed. Because $m_{\\mathrm{cav}}(\\omega)$ grows faster with frequency than $m_{\\mathrm{plate}}(\\omega)$, the acoustic cavity may enter the SEA regime at a different frequency than the plate; hybrid FEM/SEA coupling can therefore use subsystem-specific crossovers. The derived modal densities provide the necessary inputs to SEA for coupling loss factors and energy flow predictions in the high-frequency regime while FEM/BEM captures low-frequency modal detail and boundary-condition sensitivity.\n\nThe final modal density expressions are thus\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{V \\, \\omega^{2}}{2 \\pi^{2} c^{3}}, \\qquad n_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{V\\,\\omega^{2}}{2\\pi^{2}c^{3}}  \\dfrac{S}{4\\pi}\\sqrt{\\dfrac{\\rho h}{D}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "For hybrid methods involving the Boundary Element Method (BEM), such as FEM-BEM coupling for acoustic radiation, ensuring the numerical robustness of the BEM component is paramount. This exercise tackles the well-known issue of \"irregular frequencies,\" where standard BEM formulations fail to produce a unique solution . By analyzing acoustic scattering from a sphere—a canonical problem with analytical solutions—you will concretely demonstrate this numerical pathology and verify the effectiveness of the Combined Field Integral Equation (CFIE) as a robust remedy, a piece of practical knowledge essential for any user of BEM.",
            "id": "4126605",
            "problem": "Consider exterior acoustic scattering from a perfectly rigid sphere of radius $a$ immersed in a homogeneous fluid of sound speed $c$. The total acoustic pressure field $p(\\mathbf{x})$ satisfies the Helmholtz equation $\\nabla^2 p + k^2 p = 0$ in the unbounded exterior domain, where $k = 2\\pi f / c$ is the wavenumber associated with the excitation frequency $f$ measured in hertz (Hz). The rigid boundary condition is the Neumann condition $\\partial p / \\partial n = 0$ on the sphere surface $\\Gamma$, with $\\partial / \\partial n$ denoting differentiation along the outward normal. In a Boundary Element Method (BEM) setting, one common representation for the scattered field is via a single-layer potential with an unknown density, which leads, upon taking the normal derivative on $\\Gamma$, to a boundary integral operator (often referred to as a hypersingular operator) acting on the density. On a sphere, the spherical harmonics $Y_{\\ell m}$ diagonalize the boundary integral operators. Denote by $\\mathcal{T}$ the normalized Neumann (hypersingular) operator restricted to the boundary and by $\\mathcal{S}$ the normalized single-layer operator restricted to the boundary, both normalized so that their eigenvalues with respect to $Y_{\\ell m}$ depend only on the degree $\\ell$ and are given by $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka)$ and $\\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka)$, respectively, where $j_\\ell$ is the spherical Bessel function of the first kind of order $\\ell$ and $j_\\ell'$ is its derivative with respect to the argument. The Combined Field Integral Equation (CFIE) augments the Neumann operator with a weighted contribution of the single-layer operator to form $\\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S}$, whose eigenvalues on $Y_{\\ell m}$ become $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka)$ for a real positive coupling parameter $\\eta  0$. \n\nYour task is to compute, for a given set of frequencies and parameters, the spectrum of the normalized Neumann BEM operator $\\mathcal{T}$, i.e., the list $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, and the spectrum of the CFIE operator $\\mathcal{C}_\\eta$, i.e., the list $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, and then determine whether the standard Neumann formulation fails (operator is numerically singular) while the CFIE formulation remains unique for the specified frequency. Declare failure of the standard Neumann formulation if $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon$, and declare CFIE uniqueness if $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right|  \\varepsilon$, where $\\varepsilon$ is a specified tolerance. All eigenvalues are dimensionless; $a$ must be provided in meters (m), $c$ in meters per second (m/s), and $f$ in hertz (Hz).\n\nUse the following test suite. For each test case, use the given $(a,c,L_{\\max},\\eta,\\varepsilon)$ and the specified rule for $f$ to determine $k = 2\\pi f / c$ and $z = k a$. When a test case defines $f$ via a root condition, the program must compute $f$ by numerically finding the smallest positive root $z_{\\ell,1}  0$ of $j_\\ell'(z) = 0$ and setting $f = z_{\\ell,1} c / (2\\pi a)$. The test suite is:\n\n- Test case 1 (general case away from resonance): $a = 0.5$ m, $c = 343$ m/s, $L_{\\max} = 6$, $\\eta = 1.0$, $\\varepsilon = 10^{-8}$, and choose $f$ such that $k a = 2.0$.\n- Test case 2 (irregular frequency at $\\ell = 0$): same $a, c, L_{\\max}, \\eta, \\varepsilon$ as above, and choose $f$ such that $k a$ equals the smallest positive root of $j_0'(z) = 0$.\n- Test case 3 (irregular frequency at $\\ell = 1$): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f$ such that $k a$ equals the smallest positive root of $j_1'(z) = 0$.\n- Test case 4 (low-frequency edge case): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f = 1.0$ Hz.\n- Test case 5 (high-frequency case): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f$ such that $k a = 20.0$.\n\nFor each test case, compute the spectra $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$ and $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, then compute the two scalars $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right|$ and $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right|$, and finally the boolean flag indicating whether the standard Neumann formulation fails while the CFIE remains unique, i.e., $\\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon\\right) \\land \\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right|  \\varepsilon\\right)$.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be itself a list of the form $[\\min\\_T, \\min\\_{CFIE}, \\mathrm{flag}]$, where $\\min\\_T$ and $\\min\\_{CFIE}$ are floats (dimensionless) and $\\mathrm{flag}$ is a boolean. For example, the entire output will look like $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The user has provided a valid problem statement grounded in the principles of computational acoustics and the Boundary Element Method (BEM). The problem is self-contained, scientifically sound, and well-posed. I will proceed with a full solution.\n\nThe problem requires an analysis of the eigenvalues of boundary integral operators associated with acoustic scattering from a rigid sphere. The total acoustic pressure field $p(\\mathbf{x})$ in the domain exterior to the sphere $\\Omega_e$ is governed by the Helmholtz equation:\n$$ \\nabla^2 p + k^2 p = 0 \\quad \\text{in } \\Omega_e $$\nwhere $k = 2\\pi f / c$ is the wavenumber, with $f$ being the frequency and $c$ the sound speed. The \"perfectly rigid\" condition translates to a homogeneous Neumann boundary condition on the sphere's surface $\\Gamma$:\n$$ \\frac{\\partial p}{\\partial n} = 0 \\quad \\text{on } \\Gamma $$\nIn the BEM, the problem is reformulated as a boundary integral equation (BIE). For the exterior Neumann problem, a standard approach leads to a BIE involving the hypersingular operator, which we denote by $\\mathcal{T}$. This formulation is known to fail at a discrete set of \"irregular\" or \"fictitious\" frequencies. These frequencies correspond to the eigenfrequencies of the associated *interior* problem. For the Neumann problem, these are the frequencies at which the interior Neumann problem (i.e., the Helmholtz equation inside the sphere with a homogeneous Neumann condition on the boundary) has a non-trivial solution.\n\nOn a sphere of radius $a$, the boundary integral operators are diagonalized by the spherical harmonics $Y_{\\ell m}$. The problem states that the eigenvalues of the normalized hypersingular operator $\\mathcal{T}$ and the normalized single-layer operator $\\mathcal{S}$ are given by:\n$$ \\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) $$\n$$ \\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka) $$\nwhere $j_\\ell$ is the spherical Bessel function of the first kind of order $\\ell$, and $j_\\ell'$ is its derivative with respect to its argument.\n\nThe failure of the standard BIE formulation occurs when the operator $\\mathcal{T}$ becomes singular, which happens if any of its eigenvalues are zero. The irregular frequencies for the exterior Neumann problem are therefore the values of $k$ for which $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) = 0$ for some integer $\\ell \\ge 0$. At these frequencies, the BEM matrix is ill-conditioned or singular, and a unique solution cannot be guaranteed.\n\nTo remedy this, the Combined Field Integral Equation (CFIE) is often employed. It constructs a new operator by taking a linear combination of the hypersingular operator $\\mathcal{T}$ and the single-layer operator $\\mathcal{S}$. The specific form given is:\n$$ \\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S} $$\nwhere $\\eta  0$ is a real coupling parameter. The eigenvalues of this new operator are:\n$$ \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka) $$\nThe CFIE is guaranteed to have a unique solution for all real frequencies provided $\\eta  0$. This is because the irregular frequencies of the interior Neumann problem (where $j_\\ell'(ka) = 0$) and the irregular frequencies of the interior Dirichlet problem (where $j_\\ell(ka) = 0$) are disjoint for a sphere. Thus, if $j_\\ell'(ka) = 0$ for some $\\ell$, then $j_\\ell(ka) \\neq 0$. In this case, the CFIE eigenvalue becomes $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = 0 + i \\eta \\, j_\\ell(ka) = i \\eta \\, j_\\ell(ka)$, which is non-zero. Consequently, the operator $\\mathcal{C}_\\eta$ remains non-singular.\n\nThe task is to verify this behavior for a set of test cases. For each case, we must:\n1.  Determine the non-dimensional frequency parameter $z = ka$. For some cases, this involves numerically finding the smallest positive root of $j'_\\ell(z)=0$.\n2.  Compute the spectra of $\\mathcal{T}$ and $\\mathcal{C}_\\eta$ for $\\ell$ from $0$ to $L_{\\max}$. The spectrum of $\\mathcal{T}$ is the set $\\{\\lambda^{(\\mathcal{T})}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$ and the spectrum of $\\mathcal{C}_\\eta$ is $\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$.\n3.  Find the minimum magnitude of the eigenvalues for each operator: $\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)|$ and $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)|$.\n4.  Apply the conditions: the Neumann formulation fails if $\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)| \\le \\varepsilon$, and the CFIE is unique if $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)|  \\varepsilon$. A boolean flag is set if the first condition is met and the second is also met.\n\nWe will use numerical libraries to evaluate the spherical Bessel functions $j_\\ell(z)$ and their derivatives $j'_\\ell(z)$, and a numerical root-finding algorithm to determine $z$ in the relevant test cases. The derivative of the spherical Bessel function can be obtained using the `derivative=True` argument in `scipy.special.spherical_jn` or via recurrence relations such as $j'_\\ell(z) = j_{\\ell-1}(z) - \\frac{\\ell+1}{z}j_\\ell(z)$. Note that for $\\ell=0$, $j'_0(z) = -j_1(z)$.\n\nThe procedure for each test case is as follows:\n- **Test Case 1:** $z = ka = 2.0$. This is not an irregular frequency for low $\\ell$.\n- **Test Case 2:** $z = ka$ is the smallest positive root of $j'_0(z)=0$. Since $j'_0(z) = -j_1(z)$, we find the smallest positive root of $j_1(z)=0$. This corresponds to an irregular frequency for the $\\ell=0$ mode.\n- **Test Case 3:** $z = ka$ is the smallest positive root of $j'_1(z)=0$. This corresponds to an irregular frequency for the $\\ell=1$ mode.\n- **Test Case 4:** $f = 1.0$ Hz. Calculate $z = ka = (2\\pi f/c)a = (2\\pi \\times 1.0 / 343) \\times 0.5$. This is a very low-frequency case.\n- **Test Case 5:** $z = ka = 20.0$. This is a high-frequency case, not specifically chosen to be an irregular frequency.\n\nThese steps will be implemented programmatically to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the stability of Neumann and CFIE BEM formulations for acoustic scattering\n    from a rigid sphere at various frequencies.\n    \"\"\"\n    \n    # Common parameters for all test cases as specified in the problem.\n    a = 0.5  # meters\n    c = 343.0  # m/s\n    L_max = 6\n    eta = 1.0\n    epsilon = 1e-8\n\n    # Define the test cases based on the problem statement.\n    # The 'type' key specifies how to determine ka (z).\n    test_cases = [\n        {'type': 'fixed_ka', 'value': 2.0},\n        {'type': 'root_j_prime', 'l': 0},\n        {'type': 'root_j_prime', 'l': 1},\n        {'type': 'fixed_f', 'value': 1.0},\n        {'type': 'fixed_ka', 'value': 20.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Determine the non-dimensional wavenumber z = ka\n        z = 0.0\n        if case['type'] == 'fixed_ka':\n            z = case['value']\n        elif case['type'] == 'fixed_f':\n            f = case['value']\n            k = 2 * np.pi * f / c\n            z = k * a\n        elif case['type'] == 'root_j_prime':\n            l_val = case['l']\n            # The function whose root we want to find.\n            func_to_solve = lambda x: spherical_jn(l_val, x, derivative=True)\n            \n            # Find appropriate bracket for root finding.\n            # Roots of j_l'(z) are known to exist. We search in a reasonable interval.\n            if l_val == 0:\n                # j_0'(z) = -j_1(z). Smallest positive root of j_1(z) is ~4.49.\n                # Search bracket [3, 5] is safe.\n                z = brentq(func_to_solve, 3.0, 5.0)\n            elif l_val == 1:\n                # Smallest positive root of j_1'(z) is ~2.08.\n                # Search bracket [1, 3] is safe.\n                z = brentq(func_to_solve, 1.0, 3.0)\n            # Other orders are not required by the problem statement.\n\n        # Step 2: Compute spectra for T and C_eta\n        orders = np.arange(L_max + 1)\n        \n        # Eigenvalues for the Neumann operator T\n        lambda_T = spherical_jn(orders, z, derivative=True)\n        \n        # Eigenvalues for the single-layer operator S\n        lambda_S = spherical_jn(orders, z)\n        \n        # Eigenvalues for the CFIE operator C_eta\n        lambda_CFIE = lambda_T + 1j * eta * lambda_S\n\n        # Step 3: Compute minimum magnitudes\n        min_T = np.min(np.abs(lambda_T))\n        min_CFIE = np.min(np.abs(lambda_CFIE))\n\n        # Step 4: Determine the boolean flag\n        # True if Neumann fails AND CFIE is unique\n        is_failure_remedied = (min_T = epsilon) and (min_CFIE  epsilon)\n        \n        # Store results for this test case\n        results.append([min_T, min_CFIE, is_failure_remedied])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[res1], [res2], ...]\n    # str() on a list gives spaces, so they are removed.\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond ensuring numerical stability, a crucial aspect of practical hybrid modeling is assessing the sensitivity of the results to the various idealizations and discretization choices made during model setup. This practice investigates how the predictions of a coupled vibro-acoustic model are influenced by key modeling parameters, namely the granularity of the BEM surface discretization and the level of truncation in a Component Mode Synthesis (CMS) structural reduction . By performing parameter sweeps and quantifying the robustness of the predictions, you will gain critical insight into the process of model validation and the importance of convergence studies in complex engineering simulations.",
            "id": "4126645",
            "problem": "Consider a hybrid vibroacoustic coupling between a structural subsystem modeled by the Finite Element Method (FEM) and an exterior acoustic field modeled via a Boundary Element Method (BEM)-like radiation impedance discretized into surface patches, with the structural reduction performed by Component Mode Synthesis (CMS). In this problem, you will analyze sensitivity of the hybrid results to surface patch partitioning and CMS choices by performing parameter sweeps and computing robustness metrics.\n\nStart from the following fundamental bases and well-tested facts:\n\n- The structural subsystem obeys linear elastodynamics with mass matrix $\\mathbf{M}$, stiffness matrix $\\mathbf{K}$, and structural damping represented by a small stiffness-proportional loss factor $\\eta_s$, so the frequency-domain dynamic stiffness is $\\mathbf{K}(1 + i \\eta_s) - \\omega^2 \\mathbf{M}$ where $i$ denotes the imaginary unit, $\\omega$ is the angular frequency in $\\mathrm{rad/s}$, and $i^2 = -1$.\n\n- For generalized symmetric eigenproblems $\\mathbf{K} \\boldsymbol{\\phi}_i = \\lambda_i \\mathbf{M} \\boldsymbol{\\phi}_i$ with real eigenvalues $\\lambda_i  0$ and mass-normalized modes $\\boldsymbol{\\phi}_i^\\top \\mathbf{M} \\boldsymbol{\\phi}_i = 1$, the modal receptance at a structural boundary degree-of-freedom (DOF) indexed by $b$ due to a unit harmonic force applied at the same DOF is\n$$\nH(\\omega) = \\sum_{i=1}^{n} \\frac{\\phi_i(b)^2}{\\lambda_i (1 + i \\eta_s) - \\omega^2},\n$$\nwhere $n$ is the number of structural DOFs. A CMS truncation that retains $r$ fixed-interface normal modes approximates this by truncating the sum to $i = 1, \\dots, r$.\n\n- The acoustic field exerts a radiation load on the structure through the boundary pressure. Discretizing the boundary into $p$ patches with areas collected in a vector $\\mathbf{A} \\in \\mathbb{R}^p$, the radiation impedance matrix $\\mathbf{Z}_{\\mathrm{rad}} \\in \\mathbb{R}^{p \\times p}$ maps the normal boundary velocity vector $\\mathbf{v} \\in \\mathbb{C}^p$ to the pressure vector $\\mathbf{p} \\in \\mathbb{C}^p$ by $\\mathbf{p} = \\mathbf{Z}_{\\mathrm{rad}} \\mathbf{v}$. The net acoustic force on the structure is the area-weighted sum $F_a = \\mathbf{A}^\\top \\mathbf{p}$.\n\n- For a boundary DOF with uniform normal velocity across patches, $\\mathbf{v} = i \\omega q_b \\mathbf{1}_p$, where $q_b$ is the complex displacement at DOF $b$ and $\\mathbf{1}_p$ is the $p$-vector of ones. Then $F_a = i \\omega q_b \\Gamma$, with the scalar coupling\n$$\n\\Gamma = \\mathbf{A}^\\top \\mathbf{Z}_{\\mathrm{rad}} \\mathbf{1}_p.\n$$\n\n- The closed-loop boundary displacement under an external harmonic force $F_{\\mathrm{ext}}$ applied at DOF $b$ satisfies\n$$\nq_b(\\omega) = \\frac{H_r(\\omega) F_{\\mathrm{ext}}}{1 + i \\omega \\Gamma H_r(\\omega)},\n$$\nwhere $H_r(\\omega)$ is the CMS-truncated boundary receptance with $r$ retained modes. The total radiated acoustic power is\n$$\nP(\\omega) = \\frac{1}{2} \\mathrm{Re}\\!\\left( \\sum_{i=1}^{p} p_i v_i^* A_i \\right) = \\frac{1}{2} \\omega^2 |q_b(\\omega)|^2 \\, \\mathrm{Re}\\!\\left( \\mathbf{A}^\\top \\mathbf{Z}_{\\mathrm{rad}} \\mathbf{1}_p \\right),\n$$\nwhere $^*$ denotes complex conjugation.\n\nConstruct a self-consistent, solvable model with the following specifications:\n\n1. Structural subsystem: a $3$-DOF mass-spring chain with lumped masses $m = 1\\,\\mathrm{kg}$ and springs of stiffness $k = 10^4\\,\\mathrm{N/m}$, grounded at the left end, with the boundary DOF at the rightmost mass. Use\n$$\n\\mathbf{M} = m \\mathbf{I}_3,\\quad\n\\mathbf{K} = k \\begin{bmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{bmatrix},\n$$\nand a structural loss factor $\\eta_s = 0.02$. Let the external harmonic force amplitude be $F_{\\mathrm{ext}} = 1$ (in $\\mathrm{N}$). Compute the generalized eigenpairs $(\\lambda_i, \\boldsymbol{\\phi}_i)$, $i = 1,2,3$, with mass normalization $\\boldsymbol{\\phi}_i^\\top \\mathbf{M} \\boldsymbol{\\phi}_i = 1$, and denote the undamped natural frequencies by $\\omega_i = \\sqrt{\\lambda_i}$.\n\n2. Acoustic radiation impedance: parameterize patch partitioning by choosing $p \\in \\{1, 2, 4, 8\\}$ patches with uniform area totaling $S = 1\\,\\mathrm{m}^2$, so $\\mathbf{A} = (S/p) \\mathbf{1}_p$. Use a purely resistive radiation impedance model\n$$\n\\mathbf{Z}_{\\mathrm{rad}} = z_0 \\, \\mathrm{diag}(\\mathbf{A}) + \\beta(p) \\left( \\sqrt{\\mathbf{A}} \\, \\sqrt{\\mathbf{A}}^\\top \\right),\n$$\nwhere $z_0 = 400$ (treated as a real positive scalar consistent with air’s characteristic impedance in $\\mathrm{Pa\\cdot s/m}$) and\n$$\n\\beta(p) = \\frac{\\beta_0}{p}, \\quad \\beta_0 = 200.\n$$\nHere, $\\sqrt{\\mathbf{A}}$ denotes the elementwise square root.\n\n3. CMS choices: retain $r$ fixed-interface modes with $r \\in \\{1, 2, 3\\}$; approximate the boundary receptance by\n$$\nH_r(\\omega) = \\sum_{i=1}^{r} \\frac{\\phi_i(b)^2}{\\lambda_i (1 + i \\eta_s) - \\omega^2},\n$$\nwhere $b$ is the index of the boundary DOF (the rightmost mass).\n\n4. Frequencies: define three test frequencies in $\\mathrm{rad/s}$ to probe different modal regions:\n- Case A: $\\omega = 0.95 \\, \\omega_1$.\n- Case B: $\\omega = 1.05 \\, \\omega_2$.\n- Case C: $\\omega = 1.50 \\, \\omega_3$.\n\nFor each case, compute the closed-loop $q_b(\\omega)$ and the radiated power $P(\\omega)$ for each patch count $p \\in \\{1, 2, 4, 8\\}$ under $F_{\\mathrm{ext}} = 1$. Then, define two robustness metrics as dimensionless spreads over patch partitioning at fixed $(r,\\omega)$:\n- The displacement robustness\n$$\nR_q = \\frac{\\max_{p \\in \\{1,2,4,8\\}} |q_b(\\omega; p, r)|}{\\min_{p \\in \\{1,2,4,8\\}} |q_b(\\omega; p, r)|}.\n$$\n- The power robustness\n$$\nR_P = \\frac{\\max_{p \\in \\{1,2,4,8\\}} P(\\omega; p, r)}{\\min_{p \\in \\{1,2,4,8\\}} P(\\omega; p, r)}.\n$$\n\nTest Suite and coverage:\n- Case A (happy-path near the first resonance): $r = 1$, $\\omega = 0.95 \\, \\omega_1$.\n- Case B (intermediate complexity near the second resonance): $r = 2$, $\\omega = 1.05 \\, \\omega_2$.\n- Case C (boundary condition with full CMS at higher frequency): $r = 3$, $\\omega = 1.50 \\, \\omega_3$.\n\nYour program must implement the computational steps described above and produce a single line of output containing the robustness metrics for the three cases in order, flattened as\n$[R_q^{(A)}, R_P^{(A)}, R_q^{(B)}, R_P^{(B)}, R_q^{(C)}, R_P^{(C)}]$,\nwhere each entry is a real-valued float with no units. The output must be printed as a comma-separated list enclosed in square brackets, with no additional text. Angles and frequencies must be in $\\mathrm{rad/s}$ throughout. Since the final answers are dimensionless, no physical units need to be included in the output.",
            "solution": "The user-provided problem has been critically examined and is determined to be valid. It is scientifically grounded in the principles of linear structural dynamics and acoustics, specifically employing standard modeling techniques like the Finite Element Method (FEM), Boundary Element Method (BEM), and Component Mode Synthesis (CMS). The problem is well-posed, with all necessary parameters, equations, and boundary conditions explicitly provided, ensuring a unique and computable solution. The language is objective and the setup is self-consistent and formalizable. Therefore, the solution process shall proceed.\n\nThe objective is to compute robustness metrics for a hybrid vibroacoustic model by analyzing the sensitivity of the system's response to different choices in the acoustic BEM-like surface discretization and the structural CMS truncation. The procedure is as follows.\n\nFirst, we analyze the structural subsystem, a $3$-Degree-of-Freedom ($3$-DOF) mass-spring chain. The mass and stiffness matrices are given as:\n$$\n\\mathbf{M} = m \\mathbf{I}_3 = 1 \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}\\,\\mathrm{kg}\n$$\n$$\n\\mathbf{K} = k \\begin{bmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{bmatrix} = 10^4 \\begin{bmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{bmatrix}\\,\\mathrm{N/m}\n$$\nThe dynamic behavior is governed by the generalized symmetric eigenproblem $\\mathbf{K} \\boldsymbol{\\phi}_i = \\lambda_i \\mathbf{M} \\boldsymbol{\\phi}_i$. Solving this yields $3$ real eigenvalues $\\lambda_i  0$ and the corresponding mass-normalized eigenvectors $\\boldsymbol{\\phi}_i$, which satisfy $\\boldsymbol{\\phi}_i^\\top \\mathbf{M} \\boldsymbol{\\phi}_i = 1$. The undamped natural frequencies are then calculated as $\\omega_i = \\sqrt{\\lambda_i}$ for $i \\in \\{1, 2, 3\\}$. The boundary DOF, where the structure couples to the acoustic field and receives the external force, is the rightmost mass, corresponding to index $b=3$.\n\nSecond, based on the computed natural frequencies, we define the three distinct angular frequencies ($\\omega$) for analysis:\n- Case A: $\\omega = 0.95 \\, \\omega_1$\n- Case B: $\\omega = 1.05 \\, \\omega_2$\n- Case C: $\\omega = 1.50 \\, \\omega_3$\n\nThird, we model the acoustic radiation. The boundary is discretized into $p$ patches, where $p \\in \\{1, 2, 4, 8\\}$. The total area is $S = 1\\,\\mathrm{m}^2$, so the area of each patch is uniform, and the area vector is $\\mathbf{A} = (S/p) \\mathbf{1}_p$, where $\\mathbf{1}_p$ is the $p$-vector of ones. The radiation impedance matrix is given by:\n$$\n\\mathbf{Z}_{\\mathrm{rad}} = z_0 \\, \\mathrm{diag}(\\mathbf{A}) + \\beta(p) \\left( \\sqrt{\\mathbf{A}} \\, \\sqrt{\\mathbf{A}}^\\top \\right)\n$$\nwith $z_0 = 400$, $\\beta(p) = \\beta_0/p$, and $\\beta_0 = 200$. The key coupling term $\\Gamma$ is a scalar representing the total acoustic load for a uniform boundary velocity. It is calculated as $\\Gamma = \\mathbf{A}^\\top \\mathbf{Z}_{\\mathrm{rad}} \\mathbf{1}_p$. A more direct calculation reveals its dependence on $p$:\n$$\n\\mathbf{Z}_{\\mathrm{rad}} = z_0 \\frac{S}{p} \\mathbf{I}_p + \\frac{\\beta_0}{p} \\left( \\sqrt{\\frac{S}{p}} \\mathbf{1}_p \\right) \\left( \\sqrt{\\frac{S}{p}} \\mathbf{1}_p^\\top \\right) = \\frac{S}{p} z_0 \\mathbf{I}_p + \\frac{S \\beta_0}{p^2} \\mathbf{J}_p\n$$\nwhere $\\mathbf{J}_p$ is the $p \\times p$ matrix of ones. Then,\n$$\n\\mathbf{A}^\\top \\mathbf{Z}_{\\mathrm{rad}} \\mathbf{1}_p = \\left( \\frac{S}{p} \\mathbf{1}_p^\\top \\right) \\left( \\frac{S}{p} z_0 \\mathbf{I}_p + \\frac{S \\beta_0}{p^2} \\mathbf{J}_p \\right) \\mathbf{1}_p\n$$\nUsing $\\mathbf{1}_p^\\top \\mathbf{I}_p \\mathbf{1}_p = p$ and $\\mathbf{1}_p^\\top \\mathbf{J}_p \\mathbf{1}_p = p^2$, we find:\n$$\n\\Gamma = \\frac{S^2}{p^2} z_0 p + \\frac{S^2 \\beta_0}{p^3} p^2 = \\frac{S^2}{p} (z_0 + \\beta_0)\n$$\nSince $z_0$ and $\\beta_0$ are real, $\\Gamma$ is a purely real quantity.\n\nFourth, we compute the coupled system response. The structural receptance at the boundary DOF $b=3$ is approximated using a CMS truncation with $r$ modes, where $r \\in \\{1, 2, 3\\}$. The imaginary unit is $i$.\n$$\nH_r(\\omega) = \\sum_{i=1}^{r} \\frac{\\phi_i(b)^2}{\\lambda_i (1 + i \\eta_s) - \\omega^2}\n$$\nHere, $\\eta_s = 0.02$ is the structural loss factor and $\\phi_i(b)$ is the component of the $i$-th eigenvector at the boundary DOF. The closed-loop displacement $q_b(\\omega)$ under an external force $F_{\\mathrm{ext}}$ is:\n$$\nq_b(\\omega) = \\frac{H_r(\\omega) F_{\\mathrm{ext}}}{1 + i \\omega \\Gamma H_r(\\omega)}\n$$\nwhere $F_{\\mathrm{ext}}=1$. The radiated acoustic power $P(\\omega)$ is:\n$$\nP(\\omega) = \\frac{1}{2} \\omega^2 |q_b(\\omega)|^2 \\, \\mathrm{Re}\\left( \\Gamma \\right) = \\frac{1}{2} \\omega^2 |q_b(\\omega)|^2 \\Gamma\n$$\n\nFifth, for each Test Case combination of $(r, \\omega)$, we sweep through the patch counts $p \\in \\{1, 2, 4, 8\\}$ and calculate the corresponding $|q_b(\\omega; p, r)|$ and $P(\\omega; p, r)$. We then compute the two dimensionless robustness metrics:\n$$\nR_q = \\frac{\\max_{p} |q_b(\\omega; p, r)|}{\\min_{p} |q_b(\\omega; p, r)|}, \\quad R_P = \\frac{\\max_{p} P(\\omega; p, r)}{\\min_{p} P(\\omega; p, r)}\n$$\n\nFinally, we perform these calculations for the three specified cases:\n- Case A: $r=1$, $\\omega = 0.95 \\, \\omega_1$\n- Case B: $r=2$, $\\omega = 1.05 \\, \\omega_2$\n- Case C: $r=3$, $\\omega = 1.50 \\, \\omega_3$\n\nThe results for $(R_q, R_P)$ from these three cases will be collected and presented in the required format. The computational implementation will utilize numerical linear algebra to solve the eigenproblem and complex arithmetic to evaluate the system response.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Computes robustness metrics for a hybrid FEM-BEM vibroacoustic model.\n    The solution follows the sequence of steps outlined in the problem statement\n    and the detailed derivation in the solution text.\n    \"\"\"\n\n    # 1. Define constants and structural properties\n    m = 1.0  # kg\n    k = 1.0e4  # N/m\n    eta_s = 0.02  # Structural loss factor\n    F_ext = 1.0  # N\n    S = 1.0  # m^2\n    z_0 = 400.0  # Pa.s/m\n    beta_0 = 200.0  # Parameter for acoustic impedance\n    \n    # Boundary DOF (rightmost mass): 3rd DOF, which is index 2 in 0-based indexing\n    b = 2\n\n    # Mass and Stiffness matrices\n    M = m * np.identity(3)\n    K = k * np.array([[2.0, -1.0, 0.0],\n                        [-1.0, 2.0, -1.0],\n                        [0.0, -1.0, 1.0]])\n\n    # 2. Structural Subsystem Analysis: Solve generalized eigenvalue problem\n    # K*phi = lambda*M*phi. scipy.linalg.eigh with M returns mass-normalized modes.\n    lambdas, phis = eigh(K, M)\n    omegas_n = np.sqrt(lambdas)  # Undamped natural frequencies in rad/s\n\n    # 3. Define test frequencies and CMS choices for the three cases\n    # Each case is a tuple: (r_modes, omega_factor, omega_index)\n    test_cases_params = [\n        (1, 0.95, 0),  # Case A: r=1, omega = 0.95 * omega_1\n        (2, 1.05, 1),  # Case B: r=2, omega = 1.05 * omega_2\n        (3, 1.50, 2)   # Case C: r=3, omega = 1.50 * omega_3\n    ]\n    \n    # Define patch counts for the sweep\n    patch_counts = [1, 2, 4, 8]\n    \n    final_results = []\n\n    # 4. Loop through each test case to compute robustness metrics\n    for r_modes, omega_factor, omega_index in test_cases_params:\n        omega = omega_factor * omegas_n[omega_index]\n        \n        q_b_magnitudes = []\n        powers = []\n        \n        # 5. Sweep over number of patches p\n        for p in patch_counts:\n            # 5a. Calculate acoustic coupling term Gamma\n            # As derived, Gamma = S^2 * (z_0 + beta_0) / p\n            Gamma = (S**2 * (z_0 + beta_0)) / p\n            \n            # 5b. Calculate CMS-truncated boundary receptance H_r(omega)\n            H_r = 0.0j\n            for i in range(r_modes):\n                phi_ib = phis[b, i]\n                denominator = lambdas[i] * (1 + 1j * eta_s) - omega**2\n                H_r += (phi_ib**2) / denominator\n            \n            # 5c. Calculate closed-loop displacement q_b(omega)\n            q_b_denominator = 1 + 1j * omega * Gamma * H_r\n            q_b = (H_r * F_ext) / q_b_denominator\n            \n            # 5d. Calculate radiated power P(omega)\n            # Re(Gamma) = Gamma since Gamma is purely real\n            P_omega = 0.5 * omega**2 * np.abs(q_b)**2 * Gamma\n            \n            q_b_magnitudes.append(np.abs(q_b))\n            powers.append(P_omega)\n            \n        # 6. Calculate robustness metrics R_q and R_P for the current case\n        R_q = max(q_b_magnitudes) / min(q_b_magnitudes)\n        R_P = max(powers) / min(powers)\n\n        final_results.extend([R_q, R_P])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8f}' for res in final_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}