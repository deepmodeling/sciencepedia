{
    "hands_on_practices": [
        {
            "introduction": "在任何沉浸边界或水平集模拟中，首要任务是精确地描述界面的几何形状。本练习旨在提供一项基本技能的直接实践：从离散的水平集场计算法向量和曲率等关键几何量。掌握这项技能对于正确施加边界力或构建幽灵单元值至关重要，是连接离散表示与连续几何的桥梁。",
            "id": "4126954",
            "problem": "考虑在密度为 $\\rho$、声速为 $c$ 的均匀流体中的二维线性声学问题，其中一个光滑刚性夹杂物通过浸入边界法 (IBM) 表示，其几何形状通过水平集方法 (LSM) 捕捉。该夹杂物边界是一个标量场 $\\phi(x,y)$ 的零水平集，该标量场定义在两个方向上间距均为 $h$ 的均匀笛卡尔网格上。在 IBM 使用的离散格式中，需要水平集的外单位法向量和曲率来评估声学边界条件中的高阶界面项，并构建几何一致的浸入边界求积。\n\n给定 $\\phi$ 是到以原点为中心、半径为 $R$ 的圆的符号距离，其中 $R=h$，网格间距为 $h=1.0\\times 10^{-3}$ 米。关注以网格索引 $(i_{0},j_{0})=(1,0)$ 为中心的 $3\\times 3$ 模板，该索引对应于物理位置 $(x,y)=(h,0)$。在此模板上 $\\phi$ 的离散值为\n$$\n\\begin{aligned}\n\\phi_{0,-1}=0, \\quad \\phi_{1,-1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,-1}=(\\sqrt{5}-1)h,\\\\\n\\phi_{0,0}=-h, \\quad \\phi_{1,0}=0, \\quad \\phi_{2,0}=h,\\\\\n\\phi_{0,1}=0, \\quad \\phi_{1,1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,1}=(\\sqrt{5}-1)h.\n\\end{aligned}\n$$\n\n从 $\\mathbb{R}^{2}$ 中隐式定义曲线的微分几何基本原理出发，执行以下操作：\n\n- 推导在 $(i_{0},j_{0})$ 处的外单位法向量 $\\mathbf{n}$（用 $\\phi$ 的空间导数表示），并使用给定模板上的二阶中心有限差分进行计算。\n- 推导在 $(i_{0},j_{0})$ 处的曲率 $\\kappa$（用 $\\phi$ 的一阶和二阶偏导数表示），然后使用给定模板上的二阶中心有限差分进行计算。\n\n假设 $\\phi$ 在模板上是光滑的，并且没有应用滤波或重新初始化。对于数值计算，使用标准二阶中心差分计算一阶和二阶偏导数，包括使用对称4点格式计算混合导数。只提交在 $(i_{0},j_{0})$ 处的曲率；曲率以 $\\mathrm{m}^{-1}$ 为单位表示，并将最终数值结果四舍五入到四位有效数字。",
            "solution": "该问题要求使用二阶有限差分，在离散网格上计算由水平集函数 $\\phi$ 定义的边界的曲率。首先，对问题进行验证。\n\n### 问题验证\n\n**1. 提取已知条件：**\n-   **背景**：二维线性声学，均匀流体（密度 $\\rho$，声速 $c$）。\n-   **方法**：浸入边界法 (IBM) 与水平集方法 (LSM)。\n-   **网格**：均匀笛卡尔网格，间距 $h = 1.0 \\times 10^{-3}$ 米。\n-   **几何**：一个光滑刚性夹杂物，其边界是 $\\phi(x,y)$ 的零水平集。\n-   **水平集函数**：$\\phi$ 是到以原点为中心、半径为 $R=h$ 的圆的符号距离。\n-   **计算点**：$3 \\times 3$ 计算模板以网格索引 $(i_0, j_0)=(1,0)$ 为中心，对应物理位置 $(x_0, y_0)=(h,0)$。\n-   **离散数据**：模板上 $\\phi$ 的值如下：\n    -   $\\phi_{0,-1}=0, \\quad \\phi_{1,-1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,-1}=(\\sqrt{5}-1)h$\n    -   $\\phi_{0,0}=-h, \\quad \\phi_{1,0}=0, \\quad \\phi_{2,0}=h$\n    -   $\\phi_{0,1}=0, \\quad \\phi_{1,1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,1}=(\\sqrt{5}-1)h$\n-   **任务**：\n    1.  推导外单位法向量 $\\mathbf{n}$ 并在 $(h,0)$ 处进行数值计算。\n    2.  推导曲率 $\\kappa$ 并在 $(h,0)$ 处进行数值计算。\n-   **数值方案**：所有导数均采用二阶中心有限差分，混合导数 $\\phi_{xy}$ 采用对称4点格式。\n-   **要求输出**：在 $(h,0)$ 处的曲率 $\\kappa$，单位为 $\\mathrm{m}^{-1}$，并四舍五入到四位有效数字。\n\n**2. 验证分析：**\n-   **科学依据**：该问题在计算物理和数值分析领域有坚实的基础。LSM/IBM 的使用是一种标准技术。从水平集函数推导几何属性（法向量、曲率）的公式是微分几何中的标准内容。\n-   **一致性检查**：水平集函数解析地给出为 $\\phi(x,y) = \\sqrt{x^2+y^2} - R$。当 $R=h$ 时，我们可以验证给定的离散值。一个网格点 $(i,j)$ 对应坐标 $(ih, jh)$。我们检查几个点：\n    -   在 $(i,j)=(1,0)$，即 $(x,y)=(h,0)$ 处，$\\phi(h,0) = \\sqrt{h^2+0^2} - h = 0$，与 $\\phi_{1,0}$ 相符。\n    -   在 $(i,j)=(0,0)$，即 $(x,y)=(0,0)$ 处，$\\phi(0,0) = \\sqrt{0^2+0^2} - h = -h$，与 $\\phi_{0,0}$ 相符。\n    -   在 $(i,j)=(1,1)$，即 $(x,y)=(h,h)$ 处，$\\phi(h,h) = \\sqrt{h^2+h^2} - h = (\\sqrt{2}-1)h$，与 $\\phi_{1,1}$ 相符。\n    所有提供的离散值均与 $\\phi$ 的解析定义一致。\n-   **适定性**：该问题是适定的。它提供了所有必要的数据和获得唯一数值答案的清晰步骤。\n-   **客观性**：该问题以精确、客观的数学和物理术语陈述。\n\n**3. 结论：**\n该问题是有效的。这是一个在计算几何中应用数值方法的定义明确的练习。\n\n### 解答推导与计算\n\n夹杂物的边界由方程 $\\phi(x,y)=0$ 隐式定义。计算在物理点 $(x,y)=(h,0)$ 处进行，该点对应于网格索引 $(i_0, j_0)=(1,0)$。\n\n**第 1 部分：外单位法向量 ($\\mathbf{n}$)**\n\n梯度向量 $\\nabla \\phi = \\left(\\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y}\\right)$ 与 $\\phi$ 的水平集正交。外单位法向量 $\\mathbf{n}$ 通过将梯度归一化得到：\n$$ \\mathbf{n} = \\frac{\\nabla \\phi}{|\\nabla \\phi|} = \\frac{(\\phi_x, \\phi_y)}{\\sqrt{\\phi_x^2 + \\phi_y^2}} $$\n其中下标表示偏微分。对于符号距离函数，有 $|\\nabla \\phi|=1$，因此 $\\mathbf{n} = \\nabla \\phi$。我们将使用通用公式并验证此性质。在 $(i_0, j_0)=(1,0)$ 处的一阶导数 $\\phi_x$ 和 $\\phi_y$ 使用二阶中心差分近似：\n$$ \\phi_x|_{(1,0)} \\approx \\frac{\\phi_{1+1, 0} - \\phi_{1-1, 0}}{2h} = \\frac{\\phi_{2,0} - \\phi_{0,0}}{2h} $$\n$$ \\phi_y|_{(1,0)} \\approx \\frac{\\phi_{1, 0+1} - \\phi_{1, 0-1}}{2h} = \\frac{\\phi_{1,1} - \\phi_{1,-1}}{2h} $$\n代入给定值：\n$$ \\phi_x|_{(1,0)} \\approx \\frac{h - (-h)}{2h} = \\frac{2h}{2h} = 1 $$\n$$ \\phi_y|_{(1,0)} \\approx \\frac{(\\sqrt{2}-1)h - (\\sqrt{2}-1)h}{2h} = \\frac{0}{2h} = 0 $$\n梯度向量的数值估计为 $\\nabla \\phi \\approx (1,0)$。其模为 $|\\nabla \\phi| \\approx \\sqrt{1^2+0^2} = 1$。\n因此，外单位法向量为：\n$$ \\mathbf{n} \\approx \\frac{(1,0)}{1} = (1,0) $$\n\n**第 2 部分：曲率 ($\\kappa$)**\n\n水平集曲线 $\\phi(x,y)=0$ 的曲率 $\\kappa$ 由单位法向量的散度给出，即 $\\kappa = \\nabla \\cdot \\mathbf{n}$。用 $\\phi$ 的偏导数表示为：\n$$ \\kappa = \\frac{\\phi_x^2 \\phi_{yy} - 2\\phi_x \\phi_y \\phi_{xy} + \\phi_y^2 \\phi_{xx}}{(\\phi_x^2 + \\phi_y^2)^{3/2}} $$\n为计算该表达式，我们需要 $\\phi$ 在 $(1,0)$ 处的二阶偏导数。我们对 $\\phi_{xx}$ 和 $\\phi_{yy}$ 使用二阶中心差分，对 $\\phi_{xy}$ 使用指定的对称4点格式。\n\n二阶导数 $\\phi_{xx}$ 为：\n$$ \\phi_{xx}|_{(1,0)} \\approx \\frac{\\phi_{1+1,0} - 2\\phi_{1,0} + \\phi_{1-1,0}}{h^2} = \\frac{\\phi_{2,0} - 2\\phi_{1,0} + \\phi_{0,0}}{h^2} $$\n代入数值：\n$$ \\phi_{xx}|_{(1,0)} \\approx \\frac{h - 2(0) + (-h)}{h^2} = \\frac{0}{h^2} = 0 $$\n\n二阶导数 $\\phi_{yy}$ 为：\n$$ \\phi_{yy}|_{(1,0)} \\approx \\frac{\\phi_{1,0+1} - 2\\phi_{1,0} + \\phi_{1,0-1}}{h^2} = \\frac{\\phi_{1,1} - 2\\phi_{1,0} + \\phi_{1,-1}}{h^2} $$\n代入数值：\n$$ \\phi_{yy}|_{(1,0)} \\approx \\frac{(\\sqrt{2}-1)h - 2(0) + (\\sqrt{2}-1)h}{h^2} = \\frac{2(\\sqrt{2}-1)h}{h^2} = \\frac{2(\\sqrt{2}-1)}{h} $$\n\n混合偏导数 $\\phi_{xy}$ 为：\n$$ \\phi_{xy}|_{(1,0)} \\approx \\frac{\\phi_{1+1, 0+1} - \\phi_{1-1, 0+1} - \\phi_{1+1, 0-1} + \\phi_{1-1, 0-1}}{4h^2} = \\frac{\\phi_{2,1} - \\phi_{0,1} - \\phi_{2,-1} + \\phi_{0,-1}}{4h^2} $$\n代入数值：\n$$ \\phi_{xy}|_{(1,0)} \\approx \\frac{(\\sqrt{5}-1)h - 0 - (\\sqrt{5}-1)h + 0}{4h^2} = \\frac{0}{4h^2} = 0 $$\n\n现在，我们将导数的数值代入曲率公式中：\n-   $\\phi_x \\approx 1$\n-   $\\phi_y \\approx 0$\n-   $\\phi_{xx} \\approx 0$\n-   $\\phi_{yy} \\approx \\frac{2(\\sqrt{2}-1)}{h}$\n-   $\\phi_{xy} \\approx 0$\n\n$$ \\kappa \\approx \\frac{(1)^2 \\left(\\frac{2(\\sqrt{2}-1)}{h}\\right) - 2(1)(0)(0) + (0)^2 (0)}{( (1)^2 + (0)^2 )^{3/2}} $$\n$$ \\kappa \\approx \\frac{\\frac{2(\\sqrt{2}-1)}{h}}{1^{3/2}} = \\frac{2(\\sqrt{2}-1)}{h} $$\n最后一步是计算数值。给定 $h = 1.0 \\times 10^{-3}$ 米：\n$$ \\kappa \\approx \\frac{2(\\sqrt{2} - 1)}{1.0 \\times 10^{-3}} \\ \\mathrm{m}^{-1} $$\n使用 $\\sqrt{2} \\approx 1.41421356$：\n$$ \\kappa \\approx \\frac{2(1.41421356 - 1)}{1.0 \\times 10^{-3}} = \\frac{2(0.41421356)}{1.0 \\times 10^{-3}} = \\frac{0.82842712}{1.0 \\times 10^{-3}} \\approx 828.42712 \\ \\mathrm{m}^{-1} $$\n四舍五入到四位有效数字，我们得到 $828.4 \\ \\mathrm{m}^{-1}$。用标准科学记数法表示，即为 $8.284 \\times 10^2 \\ \\mathrm{m}^{-1}$。",
            "answer": "$$\\boxed{8.284 \\times 10^2}$$"
        },
        {
            "introduction": "计算声学中的许多问题都涉及移动或变形的边界。水平集方法通过演化水平集函数本身来优雅地处理这些拓扑变化。本实践问题聚焦于界面动力学的核心：使用高阶迎风格式对水平集平流方程进行数值求解，这是在模拟移动界面时保持计算精度和稳定性的关键技术。",
            "id": "4126972",
            "problem": "考虑在计算声学中，一个浸入在静止流体中的刚性散射体在给定的声学质点速度场作用下运动的二维水平集表示。设水平集函数为 $ \\phi(x,y,t) $，使得浸入式界面为零水平集 $ \\{ (x,y) \\mid \\phi(x,y,t) = 0 \\} $，其中 $ \\phi(x,y,t) $ 定义为到界面的有符号距离（在散射体外部为正）。在随时间变化的速度场下，$ \\phi $ 的演化由平流方程 $ \\phi_t + \\mathbf{u} \\cdot \\nabla \\phi = 0 $ 控制，其中 $ \\mathbf{u}(x,y,t) = (u(x,y,t), v(x,y,t)) $ 是声学质点速度。假设从时间 $ t^n $ 到 $ t^{n+1} = t^n + \\Delta t $ 进行单步前向欧拉时间推进，其中 $ \\Delta t  0 $ 足够小，以满足与您的离散化方案相一致的 Courant-Friedrichs-Lewy 稳定性条件。\n\n计算域为 $ [-0.5, 0.5] \\times [-0.5, 0.5] $ 米，在均匀笛卡尔网格上进行离散化，该网格在 $ x $ 方向上有 $ N_x = 201 $ 个点，在 $ y $ 方向上有 $ N_y = 201 $ 个点。设 $ \\Delta x = 1/(N_x - 1) $ 米，$ \\Delta y = 1/(N_y - 1) $ 米。初始水平集 $ \\phi(x,y,0) $ 是到以 $ (x_0,y_0) = (0,0) $ 为中心、半径 $ R = 0.2 $ 米的圆的有符号距离，即 $ \\phi(x,y,0) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R $。对数值导数在所有边界上使用周期性边界条件。\n\n在时间 $ t = 0 $ 时，声学质点速度场被指定为一个空间周期场\n$$\nu(x,y,0) = U_0 \\cos\\!\\left(\\frac{2\\pi x}{L}\\right), \\quad v(x,y,0) = \\beta U_0 \\cos\\!\\left(\\frac{2\\pi y}{L}\\right),\n$$\n其中 $ L = 1 $ 米。参数 $ U_0 $ 和 $ \\beta $ 因测试用例而异。在单个时间步内，将 $ \\mathbf{u}(x,y,t) $ 视为在 $ t = 0 $ 时冻结，即对于 $ t \\in [0,\\Delta t] $，$ \\mathbf{u}(x,y,t) = \\mathbf{u}(x,y,0) $。使用对 $ \\nabla \\phi $ 的高阶迎风有限差分近似，根据局部 $ u $ 和 $ v $ 的符号逐维应用，来实现 $ \\phi $ 的单步更新。该格式在光滑区域必须至少具有三阶空间精度，并且必须遵守迎风原理。\n\n在执行单步时间更新以获得 $ \\phi(x,y,\\Delta t) $ 后，通过计算 $ \\phi $ 沿水平中心线 $ y = 0 $ 的最右侧过零点的位移，来估计该线上界面位置的变化。具体来说，将 $ x_{\\text{zc}}^{\\,n} $ 定义为在 $ x \\ge 0 $ 时 $ \\phi(x,0,t^n) $ 过零点的 $ x $ 坐标（使用符号变化点周围相邻网格点之间的线性插值），并类似地从 $ \\phi(x,0,t^{n+1}) $ 定义 $ x_{\\text{zc}}^{\\,n+1} $。每个测试用例所需的输出是位移 $ \\Delta x = x_{\\text{zc}}^{\\,n+1} - x_{\\text{zc}}^{\\,n} $，以米为单位，表示为实值浮点数。\n\n您的推导和实现应基于平流方程 $ \\phi_t + \\mathbf{u} \\cdot \\nabla \\phi = 0 $、水平集方法的标准属性以及迎风离散化原理。不要使用任何 $ \\phi $ 的解析解；您必须推导并实现所要求的高阶迎风有限差分公式。\n\n测试套件：\n- 用例 $ 1 $ (一般情况): $ U_0 = 0.8 $ 米/秒, $ \\beta = 0.3 $, $ \\Delta t = 5 \\times 10^{-4} $ 秒。\n- 用例 $ 2 $ (零速度边缘情况): $ U_0 = 0.0 $ 米/秒, $ \\beta = 0.0 $, $ \\Delta t = 10^{-3} $ 秒。\n- 用例 $ 3 $ (负平流情况): $ U_0 = -0.6 $ 米/秒, $ \\beta = 0.0 $, $ \\Delta t = 4 \\times 10^{-4} $ 秒。\n\n您的程序应生成单行输出，其中包含按上述测试用例顺序排列的结果，格式为方括号括起来的逗号分隔列表，例如 $ [\\Delta x_1,\\Delta x_2,\\Delta x_3] $。每个 $ \\Delta x_i $ 必须是以米为单位的浮点数。",
            "solution": "该问题要求计算一个由水平集函数表示的界面的位移，该界面在给定的速度场作用下平流一个时间步长。解决方案涉及在空间和时间上离散化控制平流方程，然后提取界面的位置。\n\n### 1. 控制方程和数值格式\n\n水平集函数$\\phi(x,y,t)$的演化由平流方程控制：\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\phi = 0\n$$\n其中 $\\mathbf{u} = (u, v)$ 是速度场。问题指定了单步前向欧拉时间推进。在时间上进行离散化，我们得到：\n$$\n\\frac{\\phi^{n+1} - \\phi^n}{\\Delta t} = -(\\mathbf{u} \\cdot \\nabla \\phi)^n\n$$\n这给出了更新公式：\n$$\n\\phi^{n+1}_{i,j} = \\phi^n_{i,j} - \\Delta t (u_{i,j} (\\phi_x)_{i,j}^n + v_{i,j} (\\phi_y)_{i,j}^n)\n$$\n此处，$\\phi^n_{i,j}$ 表示在网格点 $(x_i, y_j)$ 和时间 $t^n$ 处 $\\phi$ 的值。空间导数 $(\\phi_x)_{i,j}^n$ 和 $(\\phi_y)_{i,j}^n$ 在时间 $t^n$ 使用高阶迎风有限差分格式进行评估。\n\n### 2. 高阶迎风空间离散化\n\n对于双曲平流方程，迎风偏置的离散化对于稳定性至关重要。问题要求一个至少三阶精度的格式。我们将使用一个三阶迎风偏置有限差分格式。在每个网格点 $(i,j)$ 处有限差分模板的选择取决于局部速度分量 $u_{i,j}$ 和 $v_{i,j}$ 的符号。\n\n这通过通量分裂方法实现。我们将速度分解为正部和负部，$u = u^+ + u^-$ 和 $v = v^+ + v^-$，其中 $u^+ = \\max(u,0)$，$u^- = \\min(u,0)$，对于 $v$ 也类似。然后，平流项近似为：\n$$\n\\mathbf{u} \\cdot \\nabla \\phi \\approx u^+ (\\phi_x)^- + u^- (\\phi_x)^+ + v^+ (\\phi_y)^- + v^- (\\phi_y)^+\n$$\n其中 $(\\cdot)^-$ 表示后向偏置（对正速度是迎风）的导数，而 $(\\cdot)^+$ 表示前向偏置（对负速度是迎风）的导数。\n\n在网格点 $(i,j)$ 处空间导数的三阶公式为：\n对于 $x$ 方向的导数：\n- 后向偏置（对于 $u > 0$）：\n$$\n(\\phi_x)^-_{i,j} = \\frac{\\phi_{i-2,j} - 6\\phi_{i-1,j} + 3\\phi_{i,j} + 2\\phi_{i+1,j}}{6\\Delta x}\n$$\n- 前向偏置（对于 $u  0$）：\n$$\n(\\phi_x)^+_{i,j} = \\frac{-2\\phi_{i-1,j} - 3\\phi_{i,j} + 6\\phi_{i+1,j} - \\phi_{i+2,j}}{6\\Delta x}\n$$\n问题陈述中指定了一个略有不同但同样有效的三阶迎风格式。我们将使用以上更常见于高阶文献中的迎风标准形式。使用在思考过程中推导出的公式（$(\\phi_x)^- = (2\\phi_{i+1} + 3\\phi_i - 6\\phi_{i-1} + \\phi_{i-2})/(6\\Delta x)$）进行测试表明，对于周期性域，它们在功能上是等效的，因为一个可以通过另一个的索引移位得到。为实现简单起见，我们将使用 $(\\phi_x)^-_{i,j} = (2\\phi_{i+1,j} + 3\\phi_{i,j} - 6\\phi_{i-1,j} + \\phi_{i-2,j})/(6\\Delta x)$ 及其对于 $(\\phi_x)^+_{i,j}$ 的镜像形式。\n\n- 后向偏置（对于 $u > 0$）：\n$$(\\phi_x)^-_{i,j} = \\frac{2\\phi_{i+1,j} + 3\\phi_{i,j} - 6\\phi_{i-1,j} + \\phi_{i-2,j}}{6\\Delta x}$$\n- 前向偏置（对于 $u  0$）：\n$$(\\phi_x)^+_{i,j} = \\frac{-2\\phi_{i-1,j} - 3\\phi_{i,j} + 6\\phi_{i+1,j} - \\phi_{i+2,j}}{6\\Delta x}$$\n\n类似地，通过在 $j$ 索引方向上应用模板，可得到用于 $y$ 方向导数 $(\\phi_y)^-_{i,j}$ 和 $(\\phi_y)^+_{i,j}$ 的公式。由于指定了周期性边界条件，跨越边界的模板将“回卷”到域的另一侧。\n\n### 3. 网格和初始条件\n\n计算域 $[-0.5, 0.5] \\times [-0.5, 0.5]$ 使用 $N_x = 201$ 和 $N_y = 201$ 个点进行离散化。网格间距为 $\\Delta x = \\frac{1.0}{N_x-1} = 0.005$ 米和 $\\Delta y = \\frac{1.0}{N_y-1} = 0.005$ 米。网格坐标为 $x_i = -0.5 + i\\Delta x$ 和 $y_j = -0.5 + j\\Delta y$。\n\n初始水平集函数是到以原点为中心、半径 $R=0.2$ 的圆的有符号距离：\n$$\n\\phi(x,y,0) = \\sqrt{x^2 + y^2} - R\n$$\n速度场在其初始状态下被冻结：\n$$\nu(x,y,t) = U_0 \\cos(2\\pi x/L), \\quad v(x,y,t) = \\beta U_0 \\cos(2\\pi y/L) \\quad \\text{for } t \\in [0, \\Delta t]\n$$\n其中 $L=1.0$ 米。\n\n### 4. 界面位移的计算\n\n目标是找到在 $x \\ge 0$ 时沿直线 $y=0$ 的界面位移。\n1.  **初始位置：** 初始界面是 $\\phi(x,y,0)=0$，即圆 $x^2+y^2=R^2$。在 $x \\ge 0$ 时沿直线 $y=0$，初始过零点位于 $x^2 = R^2 \\implies x=R$。因此，$x_{\\text{zc}}^{\\,n} = 0.2$ 米。\n\n2.  **更新后的位置：** 在使用上述格式计算出 $\\phi^{n+1}$ 后，我们找到新的过零点 $x_{\\text{zc}}^{\\,n+1}$。我们提取沿中心线 $y=0$（网格索引 $j_{\\text{center}} = (N_y-1)/2 = 100$）的 $\\phi^{n+1}$ 值。然后，我们在 $x \\ge 0$ 的区域（即对于 $i \\ge (N_x-1)/2$）搜索 $\\phi^{n+1}$ 符号发生变化的第一个网格区间 $[x_i, x_{i+1}]$。\n\n3.  **线性插值：** 一旦确定了区间 $[x_i, x_{i+1}]$，使得 $\\phi(x_i, 0, \\Delta t)$ 和 $\\phi(x_{i+1}, 0, \\Delta t)$ 符号相反，则使用线性插值找到过零点：\n    $$\n    x_{\\text{zc}}^{\\,n+1} = x_i - \\phi^{n+1}_{i,j_{\\text{center}}} \\frac{x_{i+1}-x_i}{\\phi^{n+1}_{i+1,j_{\\text{center}}}-\\phi^{n+1}_{i,j_{\\text{center}}}} = x_i + \\Delta x \\frac{\\phi^{n+1}_{i,j_{\\text{center}}}}{\\phi^{n+1}_{i,j_{\\text{center}}} - \\phi^{n+1}_{i+1,j_{\\text{center}}}}\n    $$\n\n4.  **最终结果：** 一个测试用例的位移是 $\\Delta_x = x_{\\text{zc}}^{\\,n+1} - x_{\\text{zc}}^{\\,n}$。对测试套件中给出的每一组参数 $(U_0, \\beta, \\Delta t)$ 执行此过程。\n\n这种结构化的方法，将一个成熟的数值方法（带高阶迎风的前向欧拉）与一个精确提取所需量的过程相结合，保证了问题解的正确性和可验证性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_displacement(U0, beta, dt):\n    \"\"\"\n    Computes the interface displacement for one test case.\n    \"\"\"\n    # 1. Grid and Domain Setup\n    Nx = 201\n    Ny = 201\n    domain_size = 1.0\n    dx = domain_size / (Nx - 1)\n    dy = domain_size / (Ny - 1)\n    \n    x = np.linspace(-0.5, 0.5, Nx)\n    y = np.linspace(-0.5, 0.5, Ny)\n    X, Y = np.meshgrid(x, y)\n\n    # 2. Initial Conditions\n    R = 0.2\n    phi = np.sqrt(X**2 + Y**2) - R\n    x_zc_n = R\n\n    # 3. Velocity Field (frozen at t=0)\n    L = 1.0\n    u = U0 * np.cos(2 * np.pi * X / L)\n    v = beta * U0 * np.cos(2 * np.pi * Y / L)\n    \n    u_plus = np.maximum(u, 0)\n    u_minus = np.minimum(u, 0)\n    v_plus = np.maximum(v, 0)\n    v_minus = np.minimum(v, 0)\n    \n    # 4. High-Order Upwind Spatial Discretization\n    # Periodic boundary conditions are handled by np.roll\n    \n    # Derivatives for u > 0 (backward biased)\n    phi_x_minus = (2 * np.roll(phi, -1, axis=1) + 3 * phi - 6 * np.roll(phi, 1, axis=1) + np.roll(phi, 2, axis=1)) / (6 * dx)\n    phi_y_minus = (2 * np.roll(phi, -1, axis=0) + 3 * phi - 6 * np.roll(phi, 1, axis=0) + np.roll(phi, 2, axis=0)) / (6 * dy)\n\n    # Derivatives for u  0 (forward biased)\n    phi_x_plus = (-2 * np.roll(phi, 1, axis=1) - 3 * phi + 6 * np.roll(phi, -1, axis=1) - np.roll(phi, -2, axis=1)) / (6 * dx)\n    phi_y_plus = (-2 * np.roll(phi, 1, axis=0) - 3 * phi + 6 * np.roll(phi, -1, axis=0) - np.roll(phi, -2, axis=0)) / (6 * dy)\n\n    # Combine derivatives based on velocity sign\n    advection_term = (u_plus * phi_x_minus + u_minus * phi_x_plus +\n                      v_plus * phi_y_minus + v_minus * phi_y_plus)\n\n    # 5. Time Integration (Forward Euler)\n    phi_new = phi - dt * advection_term\n\n    # 6. Find New Zero Crossing\n    j_center = (Ny - 1) // 2\n    i_center = (Nx - 1) // 2\n    \n    phi_centerline = phi_new[j_center, :]\n    \n    # Search for the first sign change in the right half of the domain (x >= 0)\n    x_zc_np1 = None\n    # We search from the center to the second-to-last point\n    for i in range(i_center, Nx - 1):\n        # Check for a sign change between phi[i] and phi[i+1]\n        if np.sign(phi_centerline[i]) != np.sign(phi_centerline[i+1]) and phi_centerline[i] * phi_centerline[i+1]  0:\n            # Linear interpolation to find the zero crossing\n            phi_i = phi_centerline[i]\n            phi_i_plus_1 = phi_centerline[i+1]\n            x_i = x[i]\n            \n            x_zc_np1 = x_i + dx * phi_i / (phi_i - phi_i_plus_1)\n            break\n            \n    # Handle the edge case where velocity is zero and the interface doesn't move.\n    # The crossing might remain exactly on a grid point.\n    if x_zc_np1 is None:\n        if np.abs(U0)  1e-15:\n             # Find the index where phi_centerline is close to zero\n             zero_cross_indices = np.where(np.abs(phi_centerline[i_center:])  1e-12)[0]\n             if len(zero_cross_indices) > 0:\n                 x_zc_np1 = x[i_center + zero_cross_indices[0]]\n        else:\n            # If no crossing is found and velocity is non-zero, it indicates an issue.\n            # However, for the given problem settings, this should not happen.\n            # We can raise an error or return NaN. For this problem, we assume it's found.\n            raise ValueError(\"Zero crossing not found.\")\n            \n    # 7. Calculate Displacement\n    displacement = x_zc_np1 - x_zc_n\n    \n    return displacement\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.8, 0.3, 5e-4),    # Case 1\n        (0.0, 0.0, 1e-3),    # Case 2\n        (-0.6, 0.0, 4e-4)    # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        U0, beta, dt = case\n        result = compute_displacement(U0, beta, dt)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "仅仅表示几何形状只是成功的一半，我们还必须在沉浸界面上施加正确的物理边界条件。本练习介绍了用于此目的的强大技术——幽灵流体法 (Ghost Fluid Method, GFM)。通过推导用于施加特定声阻抗条件的“幽灵”值，学习者可以深入理解抽象的边界条件是如何转化为具体的有限差分数值算法的。",
            "id": "4126889",
            "problem": "考虑在质量密度为 $\\rho_{0}$、声速为 $c$ 的均匀介质中的一维（$1\\mathrm{D}$）线性声学。其线性化方程为耦合的一阶偏微分方程（Partial Differential Equations, PDEs）\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是 $x$ 方向的质点速度。定义特征（平面波）阻抗为 $Z_{0} = \\rho_{0} c$。\n\n一个具有给定声阻抗 $Z$（假设为实数、不随时间变化，且 $Z \\neq Z_{0}$）的界面沉浸在计算域中，并通过水平集方法（Level Set Method, LSM）函数 $\\phi(x)$ 进行隐式表示。界面位于 $\\phi(x)=0$ 处，其局部外法线方向与 $x$ 轴负方向一致。在一个间距为 $\\Delta x$ 的均匀有限差分（Finite Difference, FD）网格上，设最近的内部节点索引为 $i=0$，位于 $x_{0}$ 处，此处 $\\phi_{0}  0$；最近的外部（虚拟）节点索引为 $i=-1$，位于 $x_{-1} = x_{0} - \\Delta x$ 处，此处 $\\phi_{-1}  0$。零水平集位于这两个节点之间，其在网格单元内的分数位置为\n$$\n\\theta = \\frac{|\\phi_{0}|}{|\\phi_{0}| + |\\phi_{-1}|} \\in (0,1),\n$$\n因此界面的位置是 $x_{I} = x_{0} - \\theta \\Delta x$。\n\n您在 $i=0$ 处使用二阶中心有限差分格式计算空间导数，这需要虚拟值 $p_{-1}$ 和 $u_{-1}$。为了在界面上施加阻抗边界条件，\n$$\np(x_{I},t) = Z\\, u(x_{I},t),\n$$\n虚拟流体法（Ghost Fluid Method, GFM）通过沿界面法线方向结合内部状态和边界关系来设定与界面一致的值，然后确定虚拟值，使得从内部节点到虚拟节点的线性插值能够恢复这些界面值。\n\n仅从上述偏微分方程、 $Z_{0}$ 的定义以及边界关系 $p(x_{I},t) = Z\\, u(x_{I},t)$ 出发，推导虚拟值 $p_{-1}$ 和 $u_{-1}$ 的闭式表达式。这些表达式应以同一时间步已知的内部值 $p_{0}$ 和 $u_{0}$、参数 $\\rho_{0}$、$c$、$Z$ 以及几何分数 $\\theta$ 来表示。将最终结果表示为 $p_{-1}$ 和 $u_{-1}$ 的解析公式，以确保线性插值\n$$\np(x_{I},t) = (1-\\theta)\\, p_{0} + \\theta\\, p_{-1}, \\qquad u(x_{I},t) = (1-\\theta)\\, u_{0} + \\theta\\, u_{-1}\n$$\n对于给定的 $Z$ 满足 $p(x_{I},t) = Z\\, u(x_{I},t)$。\n\n您的最终答案必须是关于 $p_{-1}$ 和 $u_{-1}$ 的单个闭式解析表达式，并且必须以无单位的形式呈现。如果您引入任何缩写词，请在首次使用时完整写出；例如，水平集方法（Level Set Method, LSM）、虚拟流体法（Ghost Fluid Method, GFM）和有限差分（Finite Difference, FD）。",
            "solution": "该问题要求推导用于有限差分（FD）格式的虚拟单元压力 $p_{-1}$ 和速度 $u_{-1}$ 的闭式表达式。这些表达式必须在一个沉浸式界面上施加特定的声阻抗边界条件，且与虚拟流体法（GFM）的原理一致。\n\n求解策略包括为两个未知数 $p_{-1}$ 和 $u_{-1}$ 建立一个包含两个线性方程的方程组，然后用代数方法求解该方程组。\n\n第一个方程是通过在界面位置 $x_I$ 施加阻抗边界条件推导出来的。问题指出，界面上的压力值 $p(x_I, t)$ 和速度值 $u(x_I, t)$ 是通过在最近的内部节点（$i=0$）和外部虚拟节点（$i=-1$）之间进行线性插值得到的：\n$$\np(x_{I},t) = (1-\\theta)\\, p_{0} + \\theta\\, p_{-1}\n$$\n$$\nu(x_{I},t) = (1-\\theta)\\, u_{0} + \\theta\\, u_{-1}\n$$\n界面处的阻抗边界条件为 $p(x_{I},t) = Z\\, u(x_{I},t)$。将插值公式代入此条件，得到我们的第一个方程：\n$$\n(1-\\theta)\\, p_{0} + \\theta\\, p_{-1} = Z \\left[ (1-\\theta)\\, u_{0} + \\theta\\, u_{-1} \\right]\n\\quad \\quad (1)\n$$\n\n第二个方程源于控制性偏微分方程（PDEs）的内在物理原理，这是 GFM 的一个关键步骤。一维线性声学方程为：\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0\n$$\n利用特征阻抗 $Z_{0} = \\rho_{0} c$ 的定义，这些方程可以重写为特征变量或黎曼不变量的形式。将第二个偏微分方程乘以 $Z_0$ 后（经过整理）与第一个方程相加和相减，我们得到两个解耦的平流方程：\n$$\n\\frac{\\partial}{\\partial t}(p + Z_{0} u) + c \\frac{\\partial}{\\partial x}(p + Z_{0} u) = 0\n$$\n$$\n\\frac{\\partial}{\\partial t}(p - Z_{0} u) - c \\frac{\\partial}{\\partial x}(p - Z_{0} u) = 0\n$$\n这些方程描述了两个波族：$W_1 = p + Z_{0} u$ 以速度 $c$ 向右传播，以及 $W_2 = p - Z_{0} u$ 以速度 $-c$ 向左传播。\n\n流体域被指定在区域 $\\phi > 0$ 内，即对于 $x > x_I$。界面法线指向 $x$ 轴负方向，意味着它从流体域指向虚拟单元区域。从流体域向边界传递信息的特征变量是向 $x$ 轴负方向传播的那个，即 $W_2 = p - Z_0 u$。GFM 通过从流体域外插来规定该量在虚拟区域的值。最简单的零阶外插假设这个量在界面上是恒定的。因此，我们将其在虚拟节点 $x_{-1}$ 处的值设定为与内部节点 $x_0$ 处的值相等：\n$$\np(x_{-1},t) - Z_{0} u(x_{-1},t) = p(x_{0},t) - Z_{0} u(x_{0},t)\n$$\n在我们的离散表示法中，这成为所需的第二个方程：\n$$\np_{-1} - Z_{0} u_{-1} = p_{0} - Z_{0} u_{0}\n\\quad \\quad (2)\n$$\n\n现在我们得到了一个关于 $p_{-1}$ 和 $u_{-1}$ 的二元线性方程组。从方程 $(2)$，我们可以用 $u_{-1}$ 表示 $p_{-1}$：\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}\n$$\n将 $p_{-1}$ 的这个表达式代入方程 $(1)$：\n$$\n(1-\\theta)\\, p_{0} + \\theta\\, (p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}) = Z \\left[ (1-\\theta)\\, u_{0} + \\theta\\, u_{-1} \\right]\n$$\n我们简化并合并包含未知数 $u_{-1}$ 的项：\n$$\np_0 - \\theta p_0 + \\theta p_0 - \\theta Z_0 u_0 + \\theta Z_0 u_{-1} = Z(1-\\theta)u_0 + \\theta Z u_{-1}\n$$\n$$\np_0 - \\theta Z_0 u_0 + \\theta Z_0 u_{-1} = Z u_0 - \\theta Z u_0 + \\theta Z u_{-1}\n$$\n重新整理，将含有 $u_{-1}$ 的项分离到一边：\n$$\n\\theta Z_0 u_{-1} - \\theta Z u_{-1} = Z u_0 - \\theta Z u_0 - p_0 + \\theta Z_0 u_0\n$$\n$$\nu_{-1} \\theta (Z_0 - Z) = u_0 (Z - \\theta Z + \\theta Z_0) - p_0\n$$\n$$\n(u_{-1}-u_0)\\theta(Z_0-Z) = u_0 Z - p_0\n$$\n求解 $u_{-1}$：\n$$\nu_{-1} = u_0 + \\frac{u_0 Z - p_0}{\\theta(Z_0 - Z)} = u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)}\n$$\n\n现在，我们将此结果代回到 $p_{-1}$ 的表达式中：\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}\n$$\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} \\left( u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)} \\right)\n$$\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{0} + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}\n$$\n这给出了 $p_{-1}$ 的最终表达式：\n$$\np_{-1} = p_0 + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}\n$$\n\n因此，虚拟压力 $p_{-1}$ 和虚拟速度 $u_{-1}$ 的结果就用内部值 $p_0, u_0$、阻抗值 $Z, Z_0$ 和几何因子 $\\theta$ 表示出来了。特征阻抗 $Z_0$ 定义为 $\\rho_0 c$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_0 + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}  u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}