{
    "hands_on_practices": [
        {
            "introduction": "In many acoustic scattering problems, the relationship between the object and the scattered field is nonlinear and complex. The first Born approximation linearizes this relationship, but its validity is not universal. This practice invites you to move beyond qualitative rules of thumb by deriving a rigorous, quantitative criterion for the validity of the Born approximation . By deriving a closed-form expression for the validity parameter $\\beta$, you will gain a deeper physical intuition for how it depends on the scatterer's size relative to the wavelength, encapsulated in the term $ka$, and the material contrast $\\chi$.",
            "id": "4112999",
            "problem": "A time-harmonic acoustic field with angular frequency $\\omega$ propagates in a homogeneous background medium of density $\\rho_{0}$ and sound speed $c_{0}$, except for a single spherical inclusion of radius $a$ centered at the origin. Assume the density is uniform and equal to $\\rho_{0}$ everywhere, and that the only contrast is in the squared slowness. Let the background wavenumber be $k = \\omega / c_{0}$ and let the inclusion be characterized by a constant contrast \n$$\\chi = \\frac{c_{0}^{2}}{c^{2}} - 1,$$\nsupported on the ball $D = \\{\\mathbf{r}' \\in \\mathbb{R}^{3} : |\\mathbf{r}'| \\le a\\}$, where $c$ is the sound speed inside the inclusion. The total acoustic pressure $p(\\mathbf{r})$ satisfies the inhomogeneous Helmholtz equation\n$$\\nabla^{2} p(\\mathbf{r}) + k^{2} p(\\mathbf{r}) = - k^{2} \\chi \\, \\mathbf{1}_{D}(\\mathbf{r}) \\, p(\\mathbf{r}),$$\nwith $\\mathbf{1}_{D}$ the indicator function of $D$, and with an incident field $p^{\\mathrm{inc}}(\\mathbf{r})$ solving the homogeneous background equation. The corresponding Lippmann–Schwinger representation is\n$$p(\\mathbf{r}) = p^{\\mathrm{inc}}(\\mathbf{r}) + k^{2} \\int_{D} G_{k}(\\mathbf{r}-\\mathbf{r}') \\, \\chi \\, p(\\mathbf{r}') \\, \\mathrm{d}\\mathbf{r}',$$\nwhere $G_{k}(\\mathbf{r}) = \\exp(i k |\\mathbf{r}|) / (4 \\pi |\\mathbf{r}|)$ is the free-space Green’s function in three spatial dimensions.\n\nThe first Born approximation replaces $p(\\mathbf{r}')$ by $p^{\\mathrm{inc}}(\\mathbf{r}')$ inside the volume integral. A standard sufficient condition for the validity of this approximation is that the operator norm (in the essential supremum norm) of the volume integral operator\n$$\\mathcal{K}[f](\\mathbf{r}) = k^{2} \\int_{D} G_{k}(\\mathbf{r}-\\mathbf{r}') \\, \\chi \\, f(\\mathbf{r}') \\, \\mathrm{d}\\mathbf{r}'$$\nis strictly less than one. Define the dimensionless Born validity parameter $\\beta$ as the upper bound\n$$\\beta \\equiv \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\, k^{2} \\int_{D} |\\chi| \\, |G_{k}(\\mathbf{r}-\\mathbf{r}')| \\, \\mathrm{d}\\mathbf{r}'.$$\n\nStarting from the above fundamental equations, derive a closed-form expression for $\\beta$ for the spherical inclusion described, simplified to a function of $k$, $a$, and $\\chi$ only. Your derivation must make no uncontrolled approximations beyond the use of absolute values to bound the Green’s function kernel. Conclude by providing the final analytic expression for $\\beta(k,a,\\chi)$, and briefly explain how this quantitative criterion encodes both weak-contrast and small-$k a$ regimes for the validity of the Born approximation.\n\nExpress your final answer as a single closed-form analytic expression. Do not round. Do not include units in the final answer.",
            "solution": "The problem is valid. It is a well-posed problem in acoustic scattering theory, based on standard and scientifically sound principles. All necessary information is provided, and the objective is clear and formalizable.\n\nThe task is to derive a closed-form expression for the Born validity parameter $\\beta$, defined as:\n$$ \\beta \\equiv \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\, k^{2} \\int_{D} |\\chi| \\, |G_{k}(\\mathbf{r}-\\mathbf{r}')| \\, \\mathrm{d}\\mathbf{r}' $$\nwhere $D$ is a sphere of radius $a$ centered at the origin, $\\chi$ is a constant contrast, and $G_{k}$ is the 3D free-space Green's function for the Helmholtz equation.\n\nFirst, we substitute the expression for the Green's function, $G_{k}(\\mathbf{r}) = \\frac{\\exp(i k |\\mathbf{r}|)}{4 \\pi |\\mathbf{r}|}$. The magnitude is $|G_{k}(\\mathbf{r})| = \\frac{|\\exp(i k |\\mathbf{r}|)|}{4 \\pi |\\mathbf{r}|} = \\frac{1}{4 \\pi |\\mathbf{r}|}$, since $k$ and $|\\mathbf{r}|$ are real, so $|\\exp(i k |\\mathbf{r}|)| = 1$.\n\nSince the contrast $\\chi$ is constant over the domain $D$, we can take its magnitude $|\\chi|$ outside the integral. The expression for $\\beta$ becomes:\n$$ \\beta = k^{2} |\\chi| \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\int_{D} \\frac{1}{4 \\pi |\\mathbf{r}-\\mathbf{r}'|} \\, \\mathrm{d}\\mathbf{r}' $$\nLet us define the integral term as $V(\\mathbf{r})$:\n$$ V(\\mathbf{r}) = \\frac{1}{4\\pi} \\int_{D} \\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\, \\mathrm{d}\\mathbf{r}' $$\nThis integral is mathematically equivalent to the electrostatic potential at position $\\mathbf{r}$ generated by a uniform charge distribution with unit density over the spherical volume $D$. Due to the spherical symmetry of the integration domain $D$, the potential $V(\\mathbf{r})$ will depend only on the radial distance $r = |\\mathbf{r}|$. We can therefore write $V(\\mathbf{r}) = V(r)$. To find the supremum of $V(\\mathbf{r})$, we can calculate $V(r)$ for all $r \\ge 0$ and find its maximum value.\n\nTo calculate the integral, we align the coordinate system such that the point $\\mathbf{r}$ lies on the $z$-axis, so $\\mathbf{r} = (0, 0, r)$. We use spherical coordinates for the integration variable $\\mathbf{r}' = (r', \\theta', \\phi')$. The volume element is $\\mathrm{d}\\mathbf{r}' = r'^2 \\sin\\theta' \\, \\mathrm{d}r' \\, \\mathrm{d}\\theta' \\, \\mathrm{d}\\phi'$. The distance $|\\mathbf{r}-\\mathbf{r}'|$ is given by the law of cosines:\n$$ |\\mathbf{r}-\\mathbf{r}'| = \\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'} $$\nThe integral for $V(r)$ is:\n$$ V(r) = \\frac{1}{4\\pi} \\int_0^{2\\pi} \\mathrm{d}\\phi' \\int_0^a r'^2 \\mathrm{d}r' \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' $$\nThe integration over $\\phi'$ yields a factor of $2\\pi$.\n$$ V(r) = \\frac{1}{2} \\int_0^a r'^2 \\mathrm{d}r' \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' $$\nLet's evaluate the inner integral over $\\theta'$. Let $u = \\cos\\theta'$, so $\\mathrm{d}u = -\\sin\\theta' \\mathrm{d}\\theta'$.\n$$ \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2+r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' = \\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\sqrt{r^2+r'^2-2rr'u}} = \\left[ -\\frac{\\sqrt{r^2+r'^2-2rr'u}}{rr'} \\right]_{-1}^{1} $$\n$$ = -\\frac{1}{rr'} \\left( \\sqrt{r^2+r'^2-2rr'} - \\sqrt{r^2+r'^2+2rr'} \\right) = -\\frac{1}{rr'} \\left( \\sqrt{(r-r')^2} - \\sqrt{(r+r')^2} \\right) $$\n$$ = -\\frac{1}{rr'} \\left( |r-r'| - (r+r') \\right) $$\nThe value of $|r-r'|$ depends on whether $r > r'$ or $r  r'$.\n\nCase 1: Point $\\mathbf{r}$ is outside or on the surface of the sphere ($r \\ge a$).\nFor any $r' \\in [0, a]$, we have $r \\ge r'$, so $|r-r'| = r-r'$.\nThe $\\theta'$-integral evaluates to:\n$$ -\\frac{1}{rr'} \\left( (r-r') - (r+r') \\right) = -\\frac{1}{rr'} (-2r') = \\frac{2}{r} $$\nSubstituting this into the expression for $V(r)$:\n$$ V(r) = \\frac{1}{2} \\int_0^a r'^2 \\left(\\frac{2}{r}\\right) \\mathrm{d}r' = \\frac{1}{r} \\int_0^a r'^2 \\mathrm{d}r' = \\frac{1}{r} \\left[\\frac{r'^3}{3}\\right]_0^a = \\frac{a^3}{3r} \\quad (\\text{for } r \\ge a) $$\n\nCase 2: Point $\\mathbf{r}$ is inside the sphere ($r \\le a$).\nThe integral over $r'$ must be split at $r'=r$.\nFor $0 \\le r' \\le r$, $|r-r'| = r-r'$, and the inner integral is $\\frac{2}{r}$.\nFor $r \\le r' \\le a$, $|r-r'| = r'-r$, and the inner integral is $-\\frac{1}{rr'} \\left( (r'-r) - (r+r') \\right) = -\\frac{1}{rr'}(-2r) = \\frac{2}{r'}$.\nSo, for $r \\le a$, $V(r)$ becomes:\n$$ V(r) = \\frac{1}{2} \\left( \\int_0^r r'^2 \\left(\\frac{2}{r}\\right) \\mathrm{d}r' + \\int_r^a r'^2 \\left(\\frac{2}{r'}\\right) \\mathrm{d}r' \\right) $$\n$$ V(r) = \\frac{1}{r} \\int_0^r r'^2 \\mathrm{d}r' + \\int_r^a r' \\mathrm{d}r' = \\frac{1}{r} \\left[\\frac{r'^3}{3}\\right]_0^r + \\left[\\frac{r'^2}{2}\\right]_r^a $$\n$$ V(r) = \\frac{r^2}{3} + \\left(\\frac{a^2}{2} - \\frac{r^2}{2}\\right) = \\frac{a^2}{2} - \\frac{r^2}{6} \\quad (\\text{for } r \\le a) $$\n\nNow we must find the supremum of $V(r)$ for $r \\ge 0$.\nFor $r \\ge a$, $V(r) = \\frac{a^3}{3r}$ is a monotonically decreasing function of $r$. Its maximum value in this region is at $r=a$, where $V(a) = \\frac{a^2}{3}$.\nFor $0 \\le r \\le a$, $V(r) = \\frac{a^2}{2} - \\frac{r^2}{6}$ is a parabolic function of $r$ that decreases as $r$ increases from $0$. Its maximum value is at $r=0$, where $V(0) = \\frac{a^2}{2}$.\nSince $\\frac{a^2}{2} > \\frac{a^2}{3}$ for any $a>0$, the global maximum (supremum) of $V(r)$ occurs at the center of the sphere, $r=0$.\n$$ \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} V(\\mathbf{r}) = V(0) = \\frac{a^2}{2} $$\nSubstituting this result back into the expression for $\\beta$:\n$$ \\beta = k^{2} |\\chi| \\left( \\frac{a^2}{2} \\right) = \\frac{1}{2} |\\chi| k^2 a^2 = \\frac{1}{2} |\\chi| (ka)^2 $$\nThis is the closed-form expression for the Born validity parameter $\\beta$.\n\nThe condition for the validity of the first Born approximation is $\\beta  1$, which translates to:\n$$ \\frac{1}{2} |\\chi| (ka)^2  1 $$\nThis single inequality encapsulates two distinct physical regimes:\n1.  **Weak-contrast regime:** If the contrast of the inclusion is small, i.e., $|\\chi| \\ll 1$, the inequality can be satisfied even for moderately large values of $ka$. This means the material properties of the inclusion are very close to those of the background medium.\n2.  **Small-$ka$ regime:** If the dimensionless parameter $ka = \\frac{\\omega a}{c_0} = 2\\pi \\frac{a}{\\lambda_0}$ is small, i.e., $ka \\ll 1$, the inequality can be satisfied even for large values of the contrast $|\\chi|$. This corresponds to the case where the scatterer's size $a$ is much smaller than the wavelength $\\lambda_0$ of the incident acoustic field (the low-frequency or Rayleigh scattering limit).\n\nThus, the criterion demonstrates that the Born approximation is justified when the product of the contrast magnitude and the squared ratio of scatterer size to wavelength is small.",
            "answer": "$$\\boxed{\\frac{1}{2} |\\chi| (ka)^2}$$"
        },
        {
            "introduction": "When designing a sensor array to locate an acoustic source, a critical question is: what is the best possible accuracy we can achieve? This exercise introduces a powerful tool from estimation theory, the Cramér–Rao lower bound (CRLB), to answer precisely this question for a source localization problem . By calculating the CRLB, you will establish a fundamental performance limit dictated by the physics of wave propagation and the statistics of measurement noise, revealing how parameters like sensor geometry, source frequency $k$, and signal-to-noise ratio (related to $|Q|^2$ and $\\sigma^2$) constrain the ultimate precision of any unbiased estimator.",
            "id": "4113013",
            "problem": "Consider a time-harmonic point (monopole) acoustic source in free space with known complex source strength $Q \\in \\mathbb{C}$ and angular frequency $\\omega$, radiating in a homogeneous fluid of sound speed $c$. Let the acoustic wavenumber be $k = \\omega/c$. The complex acoustic pressure at position $\\mathbf{r} \\in \\mathbb{R}^{3}$ due to a source located at $\\mathbf{s} = (x_{0}, y_{0}, 0)^{\\top}$ is modeled by the free-space Green’s function\n$$\np(\\mathbf{r}; \\mathbf{s}) = Q \\, G(\\|\\mathbf{r}-\\mathbf{s}\\|), \\quad G(R) = \\frac{\\exp(i k R)}{4 \\pi R},\n$$\nwhere $R = \\|\\mathbf{r}-\\mathbf{s}\\|$.\n\nSuppose $N \\geq 3$ sensors are placed at known positions $\\{\\mathbf{r}_{n}\\}_{n=1}^{N}$ in the plane $z=0$ uniformly on a circle of radius $a0$ centered at the origin:\n$$\n\\mathbf{r}_{n} = \\big(a \\cos \\varphi_{n}, \\, a \\sin \\varphi_{n}, \\, 0\\big)^{\\top}, \\quad \\varphi_{n} = \\frac{2\\pi (n-1)}{N}.\n$$\nEach sensor provides one complex narrowband measurement\n$$\ny_{n} = p(\\mathbf{r}_{n}; \\mathbf{s}) + w_{n},\n$$\nwhere $w_{n}$ are independent, zero-mean, circularly symmetric complex Gaussian noises with covariance $\\mathbb{E}[w_{n} w_{m}^{\\ast}] = \\sigma^{2} \\delta_{nm}$, and $\\sigma^{2}  0$ is known. The unknown parameter vector is the source location $\\mathbf{s} = (x_{0}, y_{0}, 0)^{\\top}$; the source strength $Q$, the wavenumber $k$, the radius $a$, the number of sensors $N$, and the noise variance $\\sigma^{2}$ are known.\n\nAssume the true source location equals the origin, that is, $(x_{0}, y_{0}) = (0, 0)$. Under this configuration, compute the Cramér–Rao lower bound (CRLB) on the variance of any unbiased estimator for each Cartesian coordinate $x_{0}$ and $y_{0}$, evaluated at the true location. Your final result must be a single closed-form analytic expression for the common bound $\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y}$ as a function of $N$, $a$, $k$, $|Q|$, and $\\sigma^{2}$. Express your answer in square meters. Do not simplify the physical model or introduce additional approximations beyond those stated here.",
            "solution": "We begin from the statistical model for the complex measurements. The measurement vector $\\mathbf{y} \\in \\mathbb{C}^{N}$ has mean $\\boldsymbol{\\mu}(\\boldsymbol{\\theta}) \\in \\mathbb{C}^{N}$ and covariance $\\sigma^{2} \\mathbf{I}_{N}$, where the real parameter vector is $\\boldsymbol{\\theta} = (x_{0}, y_{0})^{\\top}$ and\n$$\n\\mu_{n}(\\boldsymbol{\\theta}) = Q \\, G(R_{n}), \\quad R_{n} = \\|\\mathbf{r}_{n} - \\mathbf{s}\\| = \\sqrt{(a \\cos \\varphi_{n} - x_{0})^{2} + (a \\sin \\varphi_{n} - y_{0})^{2}}.\n$$\nThe likelihood for independent, circularly symmetric complex Gaussian noise with covariance $\\sigma^{2} \\mathbf{I}$ is\n$$\np(\\mathbf{y} \\mid \\boldsymbol{\\theta}) = \\frac{1}{(\\pi \\sigma^{2})^{N}} \\exp\\!\\left( - \\frac{1}{\\sigma^{2}} \\|\\mathbf{y} - \\boldsymbol{\\mu}(\\boldsymbol{\\theta})\\|_{2}^{2} \\right).\n$$\nFor such a model with real parameters and complex mean, the Fisher information matrix $\\mathbf{J}(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{2 \\times 2}$ has entries\n$$\nJ_{ij}(\\boldsymbol{\\theta}) = \\frac{2}{\\sigma^{2}} \\, \\Re \\!\\left\\{ \\sum_{n=1}^{N} \\frac{\\partial \\mu_{n}^{\\ast}}{\\partial \\theta_{i}} \\, \\frac{\\partial \\mu_{n}}{\\partial \\theta_{j}} \\right\\}, \\quad i,j \\in \\{1,2\\},\n$$\nwhere $\\theta_{1} = x_{0}$ and $\\theta_{2} = y_{0}$, and $\\Re\\{\\cdot\\}$ denotes the real part.\n\nThus the Cramér–Rao lower bound (CRLB) for any unbiased estimator $\\widehat{\\boldsymbol{\\theta}}$ is the inverse of the Fisher information matrix,\n$$\n\\operatorname{Cov}(\\widehat{\\boldsymbol{\\theta}}) \\succeq \\mathbf{J}(\\boldsymbol{\\theta})^{-1},\n$$\nand in particular, the variance bounds on $x_{0}$ and $y_{0}$ are $\\operatorname{CRLB}_{x} = [\\mathbf{J}^{-1}]_{11}$ and $\\operatorname{CRLB}_{y} = [\\mathbf{J}^{-1}]_{22}$.\n\nWe compute the needed partial derivatives. Using the chain rule,\n$$\n\\frac{\\partial \\mu_{n}}{\\partial x_{0}} = Q \\, \\frac{\\partial G}{\\partial R}\\Big|_{R=R_{n}} \\, \\frac{\\partial R_{n}}{\\partial x_{0}}, \\quad\n\\frac{\\partial \\mu_{n}}{\\partial y_{0}} = Q \\, \\frac{\\partial G}{\\partial R}\\Big|_{R=R_{n}} \\, \\frac{\\partial R_{n}}{\\partial y_{0}}.\n$$\nFirst, differentiate the Green’s function with respect to range $R$:\n$$\nG(R) = \\frac{\\exp(i k R)}{4\\pi R} \\;\\;\\Rightarrow\\;\\; \\frac{\\mathrm{d}G}{\\mathrm{d}R} = \\frac{1}{4\\pi} \\, \\frac{\\mathrm{d}}{\\mathrm{d}R} \\!\\left( \\frac{\\exp(i k R)}{R} \\right) = \\frac{1}{4\\pi} \\, \\exp(i k R) \\, \\frac{i k R - 1}{R^{2}}.\n$$\nNext, differentiate $R_{n}$ with respect to $x_{0}$ and $y_{0}$. For general $(x_{0}, y_{0})$,\n$$\n\\frac{\\partial R_{n}}{\\partial x_{0}} = - \\frac{a \\cos \\varphi_{n} - x_{0}}{R_{n}}, \\quad \\frac{\\partial R_{n}}{\\partial y_{0}} = - \\frac{a \\sin \\varphi_{n} - y_{0}}{R_{n}}.\n$$\nAt the true location $(x_{0}, y_{0}) = (0,0)$, we have $R_{n} = a$ for all $n$, and\n$$\n\\left.\\frac{\\partial R_{n}}{\\partial x_{0}}\\right|_{(0,0)} = - \\cos \\varphi_{n}, \\quad\n\\left.\\frac{\\partial R_{n}}{\\partial y_{0}}\\right|_{(0,0)} = - \\sin \\varphi_{n}.\n$$\nTherefore,\n$$\n\\left.\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right|_{(0,0)} = - Q \\, \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\, \\cos \\varphi_{n}, \\quad\n\\left.\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right|_{(0,0)} = - Q \\, \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\, \\sin \\varphi_{n}.\n$$\nWe now plug these into the Fisher information entries. Note that the products needed are\n$$\n\\left|\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right|^{2} = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\cos^{2} \\varphi_{n}, \\quad\n\\left|\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right|^{2} = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\sin^{2} \\varphi_{n},\n$$\nand\n$$\n\\left(\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right)^{\\!\\ast} \\left(\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right) = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\cos \\varphi_{n} \\sin \\varphi_{n},\n$$\nwhich are all real-valued in this symmetric evaluation, so the real part operator is redundant. The magnitude of $\\mathrm{d}G/\\mathrm{d}R$ at $R=a$ is\n$$\n\\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2}\n= \\left| \\frac{1}{4\\pi} \\, \\exp(i k a) \\, \\frac{i k a - 1}{a^{2}} \\right|^{2}\n= \\frac{1}{16 \\pi^{2}} \\, \\frac{|i k a - 1|^{2}}{a^{4}}\n= \\frac{1}{16 \\pi^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right).\n$$\nUsing the uniform angular spacing, we exploit the sums\n$$\n\\sum_{n=1}^{N} \\cos^{2} \\varphi_{n} = \\frac{N}{2}, \\quad \\sum_{n=1}^{N} \\sin^{2} \\varphi_{n} = \\frac{N}{2}, \\quad \\sum_{n=1}^{N} \\cos \\varphi_{n} \\sin \\varphi_{n} = 0.\n$$\nTherefore, the Fisher information matrix at $(0,0)$ is diagonal with equal diagonal entries:\n\\begin{align*}\nJ_{xx} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\left| \\frac{\\partial \\mu_{n}}{\\partial x_{0}} \\right|^{2}\n= \\frac{2}{\\sigma^{2}} \\, |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\sum_{n=1}^{N} \\cos^{2} \\varphi_{n} \\\\\n= \\frac{2}{\\sigma^{2}} \\, |Q|^{2} \\left( \\frac{1}{16 \\pi^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right) \\right) \\left( \\frac{N}{2} \\right)\n= \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right), \\\\\nJ_{yy} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\left| \\frac{\\partial \\mu_{n}}{\\partial y_{0}} \\right|^{2}\n= \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right), \\\\\nJ_{xy} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\Re \\!\\left\\{ \\left(\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right)^{\\!\\ast} \\left(\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right) \\right\\} = 0.\n\\end{align*}\nHence $\\mathbf{J}$ is a scalar multiple of the identity, and its inverse is also diagonal with identical entries. The CRLB on each coordinate variance is the reciprocal of $J_{xx}$:\n\\begin{align*}\n\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y} = \\frac{1}{J_{xx}}\n= \\left[ \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right) \\right]^{-1} \\\\\n= \\frac{16 \\pi^{2} \\sigma^{2}}{N \\, |Q|^{2}} \\left( \\frac{1}{\\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}}} \\right)\n= \\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}.\n\\end{align*}\nThis expression has units of square meters, as required: $a$ carries meters, $k$ carries inverse meters, and $|Q|^{2}/\\sigma^{2}$ is dimensionless in this narrowband complex baseband formulation.\n\nTherefore, the common Cramér–Rao lower bound on the variance of any unbiased estimator of either coordinate $x_{0}$ or $y_{0}$ at the origin, given $N$ uniformly spaced sensors on a circle of radius $a$ with known $Q$, $k$, and noise variance $\\sigma^{2}$, is\n$$\n\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y} = \\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}.\n$$\nExpressed in square meters, this is the requested closed-form result.",
            "answer": "$$\\boxed{\\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}}$$"
        },
        {
            "introduction": "While analytical tools are invaluable, most practical scattering problems require numerical computation. This exercise provides a comprehensive, hands-on experience in building a numerical solver from first principles using the boundary integral equation (BIE) method, a cornerstone of computational acoustics . You will implement a Nyström discretization for the single-layer potential on a circular boundary $\\Gamma$, tackling the crucial challenge of the kernel's logarithmic singularity with a specialized quadrature scheme, and finally validate your code against an exact analytical solution.",
            "id": "4113021",
            "problem": "Consider two-dimensional time-harmonic acoustic scattering in free space governed by the Helmholtz equation. Let $\\Gamma$ be a smooth closed curve in $\\mathbb{R}^2$, parameterized by a $2\\pi$-periodic map $\\mathbf{x}(\\tau)$ with $\\tau \\in [0,2\\pi)$ and arclength element $\\mathrm{d}s = \\lvert \\mathbf{x}'(\\tau)\\rvert \\,\\mathrm{d}\\tau$. The exterior scattered field $u^{\\mathrm{scat}}$ satisfies\n$$\n\\Delta u^{\\mathrm{scat}}(\\mathbf{x}) + k^2 u^{\\mathrm{scat}}(\\mathbf{x}) = 0 \\quad \\text{for } \\mathbf{x} \\in \\mathbb{R}^2 \\setminus \\overline{\\Omega}, \n$$\nwith the Sommerfeld radiation condition at infinity, where $\\Omega$ is the bounded domain enclosed by $\\Gamma$ and $k0$ is the wavenumber (in $\\mathrm{m}^{-1}$). For a sound-soft obstacle (Dirichlet boundary condition), the total field $u^{\\mathrm{tot}} = u^{\\mathrm{inc}} + u^{\\mathrm{scat}}$ must satisfy\n$$\nu^{\\mathrm{tot}}(\\mathbf{x}) = 0 \\quad \\text{for } \\mathbf{x} \\in \\Gamma,\n$$\nwhere $u^{\\mathrm{inc}}$ is a given incident field.\n\nA classical boundary integral representation for the scattered field is the single-layer potential\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}) = \\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}),\n$$\nwhere $G_k(r) = \\frac{i}{4} H_0^{(1)}(k r)$ is the two-dimensional Helmholtz Green's function, $H_0^{(1)}$ is the Hankel function of the first kind of order zero, and $\\sigma$ is the unknown density on $\\Gamma$. Imposing the Dirichlet boundary condition yields the boundary integral equation of the first kind\n$$\n\\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}) = -u^{\\mathrm{inc}}(\\mathbf{x}) \\quad \\text{for } \\mathbf{x} \\in \\Gamma.\n$$\n\nYou are to implement a collocation Nyström discretization of this boundary integral equation on the unit circle\n$$\n\\Gamma = \\left\\{ \\mathbf{x}(\\tau) = \\left(\\cos \\tau, \\sin \\tau\\right) : \\tau \\in [0,2\\pi) \\right\\},\n$$\nwith equispaced nodes $\\tau_j = \\frac{2\\pi j}{N}$, $j=0,\\dots,N-1$, and $\\lvert \\mathbf{x}'(\\tau)\\rvert = 1$. The integral kernel $G_k$ has a logarithmic singularity as $\\mathbf{y} \\to \\mathbf{x}$ in two dimensions. Specifically, near $\\mathbf{y} \\to \\mathbf{x}$ one has\n$$\nG_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) = -\\frac{1}{2\\pi} \\log \\lVert \\mathbf{x} - \\mathbf{y}\\rVert + \\text{smooth terms}.\n$$\nOn the unit circle, the local distance satisfies $\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert = \\sqrt{2 - 2\\cos(\\tau - \\tau')} = 2 \\left\\lvert \\sin\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right\\rvert$, hence\n$$\n\\log \\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert = \\frac{1}{2} \\log \\left(4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right).\n$$\nIt is beneficial to split the kernel into a logarithmic singular part and a smooth remainder as\n$$\nG_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) = A_{\\log}\\, \\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right) + B_k(\\tau,\\tau'),\n$$\nwhere $A_{\\log} = -\\frac{1}{4\\pi}$ is a constant coefficient and $B_k$ is a smooth function of $(\\tau,\\tau')$. The diagonal value of the smooth remainder is\n$$\nB_k(\\tau,\\tau) = \\frac{i}{4} - \\frac{1}{4}\\cdot \\frac{2}{\\pi} \\left( \\log\\left(\\frac{k}{2}\\right) + \\gamma \\right),\n$$\nwhere $\\gamma$ is the Euler–Mascheroni constant.\n\nImplement the following:\n\n1. Construct the $N \\times N$ Nyström matrix for the single-layer operator using the above splitting. Use the periodic trapezoidal rule for the smooth part $B_k(\\tau,\\tau')$ and special logarithmic weights for the singular part. Specifically, for equispaced nodes the Kress logarithmic weights for the integral of $\\log\\left(4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right)$ against a smooth density are given by\n$$\nR_d = \\frac{2\\pi}{N}\\left( -2 \\sum_{n=1}^{N-1} \\frac{1}{n} \\cos\\left(\\frac{2\\pi n d}{N}\\right) \\right), \\quad d = 0,1,\\dots,N-1,\n$$\nand the discrete contribution of the log part at node difference $d=\\lvert j-m\\rvert$ is $A_{\\log} \\, R_d$.\n\n2. Form the linear system for the unknown density values $\\sigma_j \\approx \\sigma(\\tau_j)$:\n$$\n\\sum_{m=0}^{N-1} \\left( A_{\\log} R_{\\lvert j-m\\rvert} + \\frac{2\\pi}{N} \\, B_k(\\tau_j,\\tau_m) \\right) \\sigma_m = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau_j)), \\quad j=0,\\dots,N-1.\n$$\n\n3. Use an incident plane wave\n$$\nu^{\\mathrm{inc}}(\\mathbf{x}) = e^{i k \\, \\mathbf{d}\\cdot \\mathbf{x}}, \\quad \\mathbf{d} = (1,0),\n$$\nand solve for $\\sigma$.\n\n4. For a target point $\\mathbf{x}^\\star$ outside the unit circle, evaluate the scattered field via the single-layer potential\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}^\\star) \\approx \\sum_{m=0}^{N-1} G_k\\left(\\lVert \\mathbf{x}^\\star - \\mathbf{x}(\\tau_m)\\rVert \\right) \\sigma_m \\,\\frac{2\\pi}{N}.\n$$\n\n5. Validate the numerical solution against the analytic series for scattering by a sound-soft circular cylinder of radius $a=1$. The scattered field at polar coordinates $(r,\\theta)$ with $r1$ is\n$$\nu^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) = \\sum_{n=-\\infty}^{\\infty} i^n \\, a_n \\, H_n^{(1)}(k r) \\, e^{i n \\theta}, \\quad a_n = -\\frac{J_n(k a)}{H_n^{(1)}(k a)},\n$$\nwhere $J_n$ is the Bessel function of the first kind and $H_n^{(1)}$ is the Hankel function of the first kind. Truncate the series symmetrically at $\\lvert n\\rvert \\leq M$, with $M$ chosen sufficiently large for the prescribed $k$ and $r$.\n\n6. Report, for each test case, the absolute error\n$$\nE = \\left\\lvert u^{\\mathrm{scat}}(\\mathbf{x}^\\star) - u^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) \\right\\rvert,\n$$\nas a floating-point number (dimensionless amplitude).\n\nUse angles in radians throughout. Distances are in meters and wavenumbers in $\\mathrm{m}^{-1}$. For the unit circle, $a=1\\,\\mathrm{m}$.\n\nTest Suite:\n- Case 1 (happy path): $k = 3.0\\,\\mathrm{m}^{-1}$, $N = 32$, $(r,\\theta) = (2.0\\,\\mathrm{m},\\,0.7\\,\\mathrm{rad})$.\n- Case 2 (refined discretization): $k = 3.0\\,\\mathrm{m}^{-1}$, $N = 64$, $(r,\\theta) = (2.0\\,\\mathrm{m},\\,0.7\\,\\mathrm{rad})$.\n- Case 3 (higher frequency, far field): $k = 6.0\\,\\mathrm{m}^{-1}$, $N = 64$, $(r,\\theta) = (5.0\\,\\mathrm{m},\\,1.3\\,\\mathrm{rad})$.\n- Case 4 (near-boundary evaluation): $k = 6.0\\,\\mathrm{m}^{-1}$, $N = 128$, $(r,\\theta) = (1.05\\,\\mathrm{m},\\,2.0\\,\\mathrm{rad})$.\n- Case 5 (edge case, coarse discretization): $k = 6.0\\,\\mathrm{m}^{-1}$, $N = 16$, $(r,\\theta) = (2.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{rad})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be the absolute error $E$ (a float) for the corresponding test case, computed as specified above.",
            "solution": "The present task is to compute the acoustic field scattered by a sound-soft unit circle in two dimensions and to validate the numerical result against a known analytical solution. The governing equation is the Helmholtz equation, and the problem is formulated as a first-kind boundary integral equation (BIE). We will employ a Nyström discretization method with a specialized quadrature to handle the logarithmic singularity of the integral kernel.\n\nThe scattered field $u^{\\mathrm{scat}}$ is represented by a single-layer potential over the boundary $\\Gamma$:\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}) = \\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y})\n$$\nHere, $\\sigma$ is an unknown density function on $\\Gamma$, and $G_k(r) = \\frac{i}{4} H_0^{(1)}(k r)$ is the free-space Green's function for the 2D Helmholtz equation, with $H_0^{(1)}$ being the Hankel function of the first kind and order zero. The wavenumber is denoted by $k$.\n\nImposing the sound-soft (Dirichlet) boundary condition $u^{\\mathrm{tot}} = u^{\\mathrm{inc}} + u^{\\mathrm{scat}} = 0$ on $\\Gamma$ leads to a BIE of the first kind for the unknown density $\\sigma$:\n$$\n\\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}) = -u^{\\mathrm{inc}}(\\mathbf{x}) \\quad \\text{for } \\mathbf{x} \\in \\Gamma\n$$\n\nFor the specific case of the unit circle, we parameterize the boundary $\\Gamma$ as $\\mathbf{x}(\\tau) = (\\cos \\tau, \\sin \\tau)$ for $\\tau \\in [0, 2\\pi)$. The arc-length element is $\\mathrm{d}s = \\lvert \\mathbf{x}'(\\tau) \\rvert \\mathrm{d}\\tau = \\mathrm{d}\\tau$. The BIE becomes:\n$$\n\\int_{0}^{2\\pi} G_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) \\sigma(\\tau') \\,\\mathrm{d}\\tau' = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau))\n$$\n\nA significant challenge in solving this equation numerically is the logarithmic singularity of the kernel $G_k$ as $\\mathbf{y} \\to \\mathbf{x}$ (or $\\tau' \\to \\tau$). To achieve high accuracy, a specialized quadrature is required. The problem specifies a splitting of the kernel into a singular part and a smooth part:\n$$\nG_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) = A_{\\log}\\, \\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right) + B_k(\\tau,\\tau')\n$$\nwhere $A_{\\log} = -\\frac{1}{4\\pi}$. The term $\\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right)$ captures the singular behavior, as $\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert^2 = 4 \\sin^2((\\tau-\\tau')/2)$. The remainder $B_k(\\tau,\\tau')$ is a smooth function, even on the diagonal $\\tau' = \\tau$.\n\nThe numerical solution proceeds via a Nyström collocation method. We introduce $N$ equispaced collocation points $\\tau_j = \\frac{2\\pi j}{N}$ for $j=0, \\dots, N-1$. The integral equation is enforced at these points, and the integral is replaced by a quadrature sum. The integral involving the singular part is handled by special Kress logarithmic weights, while the integral of the smooth part is approximated using the high-order accurate periodic trapezoidal rule.\n\nThe discretized BIE forms an $N \\times N$ linear system for the unknown density values $\\sigma_m \\approx \\sigma(\\tau_m)$:\n$$\n\\sum_{m=0}^{N-1} S_{jm} \\sigma_m = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau_j)), \\quad j=0,\\dots,N-1\n$$\nThe system matrix $S$ is composed of two parts:\n$$\nS_{jm} = S_{jm}^{\\log} + S_{jm}^{\\text{smooth}}\n$$\nThe contribution from the singular part is given by $S_{jm}^{\\log} = A_{\\log} R_{\\lvert j-m\\rvert}$, where $R_d$ are the provided Kress logarithmic weights:\n$$\nR_d = \\frac{2\\pi}{N}\\left( -2 \\sum_{n=1}^{N-1} \\frac{1}{n} \\cos\\left(\\frac{2\\pi n d}{N}\\right) \\right), \\quad d = 0,1,\\dots,N-1\n$$\nThe contribution from the smooth part is obtained via the trapezoidal rule, with weights $\\frac{2\\pi}{N}$, yielding $S_{jm}^{\\text{smooth}} = \\frac{2\\pi}{N} B_k(\\tau_j, \\tau_m)$.\n\nThe entries of the matrix $S$ are constructed as follows:\nFor off-diagonal entries ($j \\neq m$):\n- Let $r_{jm} = \\lVert \\mathbf{x}(\\tau_j) - \\mathbf{x}(\\tau_m) \\rVert$.\n- The smooth part of the kernel is $B_k(\\tau_j, \\tau_m) = G_k(r_{jm}) - A_{\\log} \\log(r_{jm}^2) = \\frac{i}{4} H_0^{(1)}(k r_{jm}) + \\frac{1}{2\\pi} \\log(r_{jm})$.\n- $S_{jm} = A_{\\log} R_{\\lvert j-m\\rvert} + \\frac{2\\pi}{N} \\left( \\frac{i}{4} H_0^{(1)}(k r_{jm}) + \\frac{1}{2\\pi} \\log(r_{jm}) \\right)$.\n\nFor diagonal entries ($j=m$):\n- The trapezoidal rule is applied to the smooth function $B_k(\\tau_j, \\tau')$. For the diagonal term, we need the limit $B_k(\\tau_j, \\tau_j)$. This is provided as:\n$$\nB_k(\\tau,\\tau) = \\frac{i}{4} - \\frac{1}{2\\pi} \\left( \\log\\left(\\frac{k}{2}\\right) + \\gamma \\right)\n$$\nwhere $\\gamma$ is the Euler–Mascheroni constant.\n- $S_{jj} = A_{\\log} R_0 + \\frac{2\\pi}{N} B_k(\\tau_j, \\tau_j)$.\n\nThe right-hand side of the linear system is derived from the incident plane wave $u^{\\mathrm{inc}}(\\mathbf{x}) = e^{i k \\mathbf{d} \\cdot \\mathbf{x}}$ with direction $\\mathbf{d}=(1,0)$. At each collocation point $\\mathbf{x}_j = (\\cos \\tau_j, \\sin \\tau_j)$, the right-hand side vector is $b_j = -e^{i k \\cos \\tau_j}$.\n\nAfter solving the system $S\\mathbf{\\sigma} = \\mathbf{b}$ for the density vector $\\mathbf{\\sigma} = (\\sigma_0, \\dots, \\sigma_{N-1})^T$, we can evaluate the scattered field at any exterior point $\\mathbf{x}^\\star$ using the discretized single-layer potential:\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}^\\star) \\approx \\sum_{m=0}^{N-1} G_k\\left(\\lVert \\mathbf{x}^\\star - \\mathbf{x}(\\tau_m)\\rVert \\right) \\sigma_m \\,\\frac{2\\pi}{N}\n$$\n\nThe final step is to validate this numerical result against the exact analytical solution for scattering from a sound-soft circular cylinder of radius $a=1\\,\\mathrm{m}$. The analytical scattered field at polar coordinates $(r,\\theta)$ is given by the truncated Mie series:\n$$\nu^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) = \\sum_{n=-M}^{M} i^n \\, a_n \\, H_n^{(1)}(k r) \\, e^{i n \\theta}, \\quad \\text{where } a_n = -\\frac{J_n(k a)}{H_n^{(1)}(k a)}\n$$\n$J_n$ and $H_n^{(1)}$ are Bessel and Hankel functions of order $n$, respectively. The truncation index $M$ must be chosen sufficiently large to ensure convergence of the series.\n\nThe absolute error $E = \\left\\lvert u^{\\mathrm{scat}}(\\mathbf{x}^\\star) - u^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) \\right\\rvert$ is then computed for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn, hankel1\n\ndef compute_error(k, N, r, theta):\n    \"\"\"\n    Computes the error of the BIE solution for acoustic scattering from a unit circle.\n\n    Args:\n        k (float): Wavenumber.\n        N (int): Number of discretization points.\n        r (float): Radial coordinate of the evaluation point.\n        theta (float): Angular coordinate of the evaluation point.\n\n    Returns:\n        float: The absolute error between the numerical and analytical solutions.\n    \"\"\"\n    a = 1.0  # Radius of the unit circle\n    gamma = np.euler_gamma\n    A_log = -1.0 / (4.0 * np.pi)\n\n    # 1. Setup discretization grid\n    tau = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    nodes = np.vstack((a * np.cos(tau), a * np.sin(tau))).T\n\n    # 2. Construct Nyström matrix for the single-layer operator\n    \n    # 2a. Compute Kress logarithmic weights R_d\n    R = np.zeros(N)\n    n_vec = np.arange(1, N)\n    # d = 0 case\n    R[0] = (2 * np.pi / N) * (-2 * np.sum(1.0 / n_vec))\n    # d = 1 to N-1 cases\n    for d_idx in range(1, N):\n        cos_terms = np.cos(2 * np.pi * n_vec * d_idx / N)\n        R[d_idx] = (2 * np.pi / N) * (-2 * np.sum(cos_terms / n_vec))\n\n    # 2b. Assemble the full system matrix S\n    S = np.zeros((N, N), dtype=np.complex128)\n    \n    # Diagonal term of the smooth part B_k\n    B_diag = 1j / 4.0 - (1.0 / (2.0 * np.pi)) * (np.log(k * a / 2.0) + gamma)\n\n    # Loop over rows (j) and columns (m)\n    for j in range(N):\n        for m in range(N):\n            if j == m:\n                # Diagonal entry\n                S[j, j] = A_log * R[0] + (2 * np.pi / N) * B_diag\n            else:\n                # Off-diagonal entry\n                dist = np.linalg.norm(nodes[j, :] - nodes[m, :])\n                \n                # Smooth part B_jm\n                B_jm = (1j / 4.0) * hankel1(0, k * dist) + (1.0 / (2.0 * np.pi)) * np.log(dist)\n                \n                d_idx = abs(j - m)\n                S[j, m] = A_log * R[d_idx] + (2 * np.pi / N) * B_jm\n\n    # 3. Form the right-hand side vector for an incident plane wave\n    # u_inc = exp(i * k * d . x), with d = (1, 0)\n    # x-coordinates of nodes are nodes[:, 0]\n    u_inc = np.exp(1j * k * nodes[:, 0])\n    b = -u_inc\n\n    # 4. Solve for the density sigma\n    sigma = np.linalg.solve(S, b)\n\n    # 5. Evaluate the scattered field at the target point\n    x_star = np.array([r * np.cos(theta), r * np.sin(theta)])\n    dists_to_star = np.linalg.norm(nodes - x_star, axis=1)\n    \n    # Green's function G_k at target distances\n    Gk_vals = (1j / 4.0) * hankel1(0, k * dists_to_star)\n    \n    # Discretized single-layer potential sum\n    u_scat_num = np.sum(Gk_vals * sigma) * (2 * np.pi * a / N)\n\n    # 6. Evaluate the analytic series solution\n    # Truncation number for the series. A safe choice based on k*a.\n    M = int(k * a + 5 * (k * a)**(1/3.0)) + 15\n    n_range = np.arange(-M, M + 1)\n\n    # Bessel and Hankel functions\n    jn_ka = jn(n_range, k * a)\n    hn_ka = hankel1(n_range, k * a)\n    hn_kr = hankel1(n_range, k * r)\n\n    # Coefficients an\n    a_n = -jn_ka / hn_ka\n\n    # Sum the series terms\n    terms = (1j**n_range) * a_n * hn_kr * np.exp(1j * n_range * theta)\n    u_scat_ana = np.sum(terms)\n    \n    # 7. Compute absolute error\n    error = np.abs(u_scat_num - u_scat_ana)\n    \n    return error\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # k, N, (r, theta)\n        (3.0, 32, (2.0, 0.7)),\n        (3.0, 64, (2.0, 0.7)),\n        (6.0, 64, (5.0, 1.3)),\n        (6.0, 128, (1.05, 2.0)),\n        (6.0, 16, (2.0, 1.0)),\n    ]\n\n    results = []\n    for k, N, (r, theta) in test_cases:\n        error = compute_error(k, N, r, theta)\n        results.append(f\"{error:.10e}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}