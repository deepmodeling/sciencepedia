{
    "hands_on_practices": [
        {
            "introduction": "在麦克风阵列设计中，一个基本的挑战是空间混叠，它会在波束方向图中产生模糊的“栅瓣”。本练习将引导您深入探讨这个问题，从第一性原理出发，推导出在特定转向角度下，这些伪影出现的精确频率，从而直接将阵列几何结构（$d$）、声速（$c$）和期望方向（$\\theta_0$）与混叠的产生联系起来。",
            "id": "4117593",
            "problem": "一个由 $N \\geq 2$ 个全向麦克风组成的均匀线性阵列 (ULA) 沿着 $x$ 轴放置，阵元间距固定为 $d  0$。假设声波在声速为 $c  0$ 的均匀介质中以远场平面波的形式传播。波束形成器使用相移导向技术将波束指向一个相对于侧射方向（broadside）的角度 $\\theta_{0}$，所有角度均以弧度为单位。令 $f$ 表示声学频率，$\\lambda = c / f$ 表示波长。\n\n仅使用平面波传播的基本原理和跨阵列阵元的相位对齐定义，推导出一个已导向的均匀线性阵列的角度相关混叠条件，并确定第一个栅瓣进入可见区域的最小正频率。可见区域由满足 $\\lvert \\sin \\theta \\rvert \\leq 1$ 的物理可实现的到达角定义。您的推导必须明确地描述频率 $f$ 的增加（等效于波长 $\\lambda$ 的减小）如何以一种依赖于 $\\theta_{0}$ 的方式将栅瓣带入可见区域。\n\n提供一个关于过渡频率 $f_{\\mathrm{gl}}(\\theta_{0})$ 的单一闭式解析表达式，该表达式是 $d$、$c$ 和 $\\theta_{0}$ 的函数，对应于任何栅瓣可见的最小正频率 $f  0$。不要计算任何数值。最终答案必须是最终方框内不含单位的单一解析表达式。角度以弧度为单位。",
            "solution": "本问题要求推导均匀线性阵列（ULA）的角度相关混叠条件，并随后确定栅瓣进入可见区域的最小正频率。\n\n我们首先根据基本原理建立信号模型。考虑一个沿 $x$ 轴放置的、包含 $N$ 个麦克风的均匀线性阵列。第 $n$ 个麦克风（索引从 $n=0$ 到 $N-1$）的位置由向量 $\\vec{p}_n = (nd, 0, 0)$ 给出，其中 $d$ 是阵元间距。一个频率为 $f$、速度为 $c$ 的平面声波从远场传播而来，其到达角 $\\theta$ 是相对于阵列的侧射方向（$y$ 轴）测量的。\n\n到达麦克风 $n$ 的声波相对于参考麦克风（位于原点，$n=0$）的波程差为 $\\Delta L_n = nd \\sin\\theta$。这对应于一个到达时间延迟：\n$$\n\\tau_n(\\theta) = \\frac{\\Delta L_n}{c} = \\frac{nd \\sin\\theta}{c}\n$$\n在频域中，这个时间延迟表现为相移。对于角频率为 $\\omega = 2\\pi f$ 的单色波，麦克风 $n$ 处的信号与参考麦克风 $S_0(\\omega)$ 处的信号关系如下：\n$$\nS_n(\\omega, \\theta) = S_0(\\omega) \\exp(-j\\omega\\tau_n(\\theta)) = S_0(\\omega) \\exp\\left(-j 2\\pi f \\frac{nd \\sin\\theta}{c}\\right)\n$$\n使用关系式 $\\lambda = c/f$（其中 $\\lambda$ 是波长），相位项可以写成：\n$$\nS_n(\\omega, \\theta) = S_0(\\omega) \\exp\\left(-j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta\\right)\n$$\n波束形成器通过对每个麦克风信号施加一组复加权 $w_n$，将阵列指向视向 $\\theta_0$。对于相移导向，这些加权被设计用来精确抵消来自 $\\theta_0$ 方向的声波的相位延迟，使得来自该方向的信号能够相干叠加。第 $n$ 个麦克风的加权为：\n$$\nw_n(\\theta_0) = \\exp(+j\\omega\\tau_n(\\theta_0)) = \\exp\\left(+j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta_0\\right)\n$$\n对于来自方向 $\\theta$ 的入射波，波束形成器的输出 $Y(\\omega, \\theta, \\theta_0)$ 是所有麦克风信号的加权和：\n$$\nY(\\omega, \\theta, \\theta_0) = \\sum_{n=0}^{N-1} w_n(\\theta_0) S_n(\\omega, \\theta) = S_0(\\omega) \\sum_{n=0}^{N-1} \\exp\\left(j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta_0\\right) \\exp\\left(-j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta\\right)\n$$\n合并指数项，我们得到：\n$$\nY(\\omega, \\theta, \\theta_0) = S_0(\\omega) \\sum_{n=0}^{N-1} \\exp\\left(j 2\\pi n \\frac{d}{\\lambda} (\\sin\\theta_0 - \\sin\\theta)\\right)\n$$\n这个求和项被称为阵列因子 $AF(\\theta, \\theta_0)$。当求和中的所有项都同相时，即等于 $1$ 时，波束形成器响应的幅度达到最大。这发生在指数的参数是 $2\\pi$ 的整数倍时。设 $\\theta_g$ 是对应于最大响应的角度。最大相长干涉的条件是：\n$$\n2\\pi \\frac{d}{\\lambda} (\\sin\\theta_0 - \\sin\\theta_g) = 2\\pi m, \\quad \\text{for } m \\in \\mathbb{Z}\n$$\n其中 $m$ 是一个整数。简化此方程可得出响应最大值（波瓣）的位置（用 $\\sin\\theta$ 表示）：\n$$\n\\sin\\theta_g = \\sin\\theta_0 - m \\frac{\\lambda}{d}\n$$\n当 $m=0$ 时，结果为 $\\sin\\theta_g = \\sin\\theta_0$，这对应于正确指向所需视向 $\\theta_0$ 的主瓣。\n当 $m \\neq 0$ 时，对应于栅瓣，它们是波束图中不希望出现的响应最大值。\n\n如果栅瓣对应的角度 $\\theta_g$ 是实数，那么它就具有物理意义，即“可见”。这等价于条件 $|\\sin\\theta_g| \\le 1$。因此，如果存在一个非零整数 $m$ 使得下式成立，则存在可见的栅瓣：\n$$\n-1 \\le \\sin\\theta_0 - m \\frac{\\lambda}{d} \\le 1\n$$\n这个不等式就是角度相关的混叠条件。\n\n为避免任何可见的栅瓣，我们必须确保对于所有非零整数 $m$，条件 $|\\sin\\theta_g|  1$ 都得到满足。\n$$\n\\left| \\sin\\theta_0 - m \\frac{\\lambda}{d} \\right|  1, \\quad \\forall m \\in \\mathbb{Z} \\setminus \\{0\\}\n$$\n这等价于要求对于每个非零整数 $m$，要么 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  1$，要么 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  -1$。\n\n让我们分析这两种可能性：\n1. 对于正整数 $m = 1, 2, 3, \\ldots$：条件 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  1$ 是不可能的，因为 $\\sin\\theta_0 \\le 1$ 且 $m \\frac{\\lambda}{d}  0$。所以我们必须满足 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  -1$。重新整理得到 $m \\frac{\\lambda}{d}  1 + \\sin\\theta_0$，或 $\\frac{\\lambda}{d}  \\frac{1 + \\sin\\theta_0}{m}$。为了对所有 $m \\ge 1$ 满足此条件，我们必须满足最严格的情况，即 $m=1$。因此，我们需要 $\\frac{\\lambda}{d}  1 + \\sin\\theta_0$。\n\n2. 对于负整数 $m = -1, -2, -3, \\ldots$：令 $m = -k$，其中 $k = 1, 2, 3, \\ldots$。条件变为 $|\\sin\\theta_0 + k \\frac{\\lambda}{d}|  1$。可能性 $\\sin\\theta_0 + k \\frac{\\lambda}{d}  -1$ 是不可能的，因为 $\\sin\\theta_0 \\ge -1$ 且 $k\\frac{\\lambda}{d}  0$。所以我们必须满足 $\\sin\\theta_0 + k \\frac{\\lambda}{d}  1$。重新整理得到 $k \\frac{\\lambda}{d}  1 - \\sin\\theta_0$，或 $\\frac{\\lambda}{d}  \\frac{1 - \\sin\\theta_0}{k}$。为了对所有 $k \\ge 1$ 满足此条件，我们必须满足最严格的情况，即 $k=1$。因此，我们需要 $\\frac{\\lambda}{d}  1 - \\sin\\theta_0$。\n\n为了没有任何可见的栅瓣，两个条件必须同时成立：\n$$\n\\frac{\\lambda}{d}  1 + \\sin\\theta_0 \\quad \\text{and} \\quad \\frac{\\lambda}{d}  1 - \\sin\\theta_0\n$$\n这等价于要求 $\\frac{\\lambda}{d}$ 大于两个右侧值的最大值：\n$$\n\\frac{\\lambda}{d}  \\max(1 + \\sin\\theta_0, 1 - \\sin\\theta_0)\n$$\n这两项的最大值可以更紧凑地表示。由于 $\\sin\\theta_0$ 是一个介于 $-1$ 和 $1$ 之间的实数，我们有：\n$$\n\\max(1 + \\sin\\theta_0, 1 - \\sin\\theta_0) = 1 + |\\sin\\theta_0|\n$$\n因此，无栅瓣的可见区域的条件是：\n$$\n\\frac{\\lambda}{d}  1 + |\\sin\\theta_0|\n$$\n问题要求的是第一个栅瓣进入可见区域的最小正频率 $f_{\\mathrm{gl}}(\\theta_0)$。这个频率对应于上述条件的边界。当频率 $f$ 从零开始增加时，波长 $\\lambda = c/f$ 从无穷大开始减小。当 $\\lambda/d$ 首次违反该不等式时，第一个栅瓣出现在可见区域的边缘，这发生在等式成立的临界点。设这个过渡波长为 $\\lambda_{\\mathrm{gl}}$。\n$$\n\\frac{\\lambda_{\\mathrm{gl}}}{d} = 1 + |\\sin\\theta_0|\n$$\n代入 $\\lambda_{\\mathrm{gl}} = c / f_{\\mathrm{gl}}(\\theta_0)$，我们得到：\n$$\n\\frac{c}{f_{\\mathrm{gl}}(\\theta_0) d} = 1 + |\\sin\\theta_0|\n$$\n求解过渡频率 $f_{\\mathrm{gl}}(\\theta_0)$ 得到所需的表达式：\n$$\nf_{\\mathrm{gl}}(\\theta_0) = \\frac{c}{d(1 + |\\sin\\theta_0|)}\n$$\n该表达式给出了栅瓣出现在可见区域边界（$\\sin\\theta_g = \\pm 1$）时的最低频率，该频率依赖于导向角 $\\theta_0$。对于任何频率 $f > f_{\\mathrm{gl}}(\\theta_0)$，在可见区域中将至少存在一个栅瓣。",
            "answer": "$$\n\\boxed{\\frac{c}{d(1 + |\\sin\\theta_0|)}}\n$$"
        },
        {
            "introduction": "波束形成不仅限于按角度区分声源；在近场条件下，我们也可以根据距离来分辨它们。本动手练习旨在探索由阵列孔径决定的角度分辨率与由信号带宽决定的距离分辨率之间的根本权衡。通过编写一个简短的程序，您将能够确定在何种条件下，阵列在距离分辨能力上优于角度分辨能力，这对于近场应用来说是一项关键的洞察。",
            "id": "4117574",
            "problem": "您的任务是分析在二维自由场声学中工作的均匀线性麦克风阵列的距离聚焦和角分辨率的极限。将传播视为由标量声波方程控制，并将声源建模为具有以给定中心频率为中心的带限频谱的紧凑、时间有限的发射器。您的目标是利用第一性原理推导量化距离和角度上最小可分辨间隔的表达式，并确定在何种条件下，通过距离聚焦进行区分优于通过角度分离进行区分。您的最终交付成果是一个程序，该程序为给定的测试套件评估这些条件。\n\n从标量声波方程和球面扩散出发，论证为什么位于均匀线性阵列上位置 $x_n$ 的第 $n$ 个传感器接收到的信号可以表示为源波形经过距离 $r_n$ 传播后的时间延迟和幅度缩放版本，并将距离聚焦形式化为使用假设的点聚焦延迟进行的相干延迟求和。利用带限宽带信号和匹配滤波，推导以米为单位表示的距离上最小可分辨间隔，并考虑信号带宽。另外，利用在中心频率下均匀加权孔径的衍射极限主瓣宽度，推导阵列的最小可分辨角间隔（以弧度为单位），并用声波波长和孔径长度表示。通过比较在给定平均距离下相应的分辨率长度尺度，定义一个条件，在该条件下，通过距离聚焦进行区分的能力超过通过角分辨率进行区分的能力。\n\n具体来说，请执行以下操作：\n\n1.  推导位于 $(x_s,z_s)$ 的点源在每个传感器上接收到的信号形式，用于假设焦点处的近场聚焦延迟形式，以及在这些延迟下的相干和。利用标量波方程和球面波传播来证明聚焦原理。\n2.  使用带宽为 $B$（单位Hz）的带限波形和声速 $c$（单位m/s）进行匹配滤波，推导在相同角度下两个声源之间以米为单位的最小可分辨距离间隔 $\\Delta r$。仅用 $B$ 和 $c$ 提供最终表达式。\n3.  使用长度为 $D$（单位米）、中心频率为 $f_0$（单位Hz）的均匀线性孔径的远场近似，推导在相同距离下两个声源之间以弧度为单位的最小可分辨角间隔 $\\Delta \\theta$。用声波波长 $\\lambda$（单位米）和孔径长度 $D$ 表示此表达式，并指定与均匀加权孔径的半功率波束宽度相关的比例常数。\n4.  定义一个比较条件：如果距离分辨率长度尺度小于投影到该距离上的角分辨率长度尺度（即 $\\Delta r  R\\,\\Delta \\theta$），则距离辨别能力超过角分辨率，其中 $R$ 是两个声源距离的平均值（单位米）。\n5.  实现一个程序，对于每个测试用例，使用您推导的表达式计算不等式 $\\Delta r  R\\,\\Delta \\theta$ 的布尔结果。该程序不得要求任何输入。使用声速 $c = 343$ m/s。所有角度必须以弧度处理，长度以米为单位，频率以赫兹为单位。\n\n测试套件：\n对于以下所有情况，使用一个具有 $N$ 个麦克风、元件间距为 $d$（单位米）、孔径长度 $D = (N-1)d$、中心频率为 $f_0$（单位Hz）和波形带宽 $B$（单位Hz）的均匀线性阵列。两个声源位于侧射方向（零角度），距离分别为 $R_1$ 和 $R_2$（单位米），$R$ 表示它们的平均值 $(R_1+R_2)/2$。您的程序必须为每种情况计算不等式 $\\Delta r  R\\,\\Delta \\theta$ 的布尔值。阵列间距 $d$ 的选择应满足 $d \\le \\lambda/2$ 以避免空间混叠。\n\n-   案例1（理想情况）：$N=16$, $d=0.02$ m, $f_0=4000$ Hz, $B=3000$ Hz, $R_1=3.0$ m, $R_2=3.12$ m。\n-   案例2（低带宽边缘情况）：$N=16$, $d=0.02$ m, $f_0=4000$ Hz, $B=200$ Hz, $R_1=3.0$ m, $R_2=3.12$ m。\n-   案例3（大孔径，高中心频率）：$N=50$, $d=0.017$ m, $f_0=10000$ Hz, $B=5000$ Hz, $R_1=2.0$ m, $R_2=2.2$ m。\n-   案例4（近边界条件）：$N=32$, $d=0.015$ m, $f_0=8000$ Hz, $B=1400$ Hz, $R_1=1.4$ m, $R_2=1.6$ m。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试用例的顺序排列结果，其中每个条目是一个布尔值，指示在该给定情况下，距离辨别能力是否超过角分辨率。例如：“[True,False,True,False]”。",
            "solution": "该问题被评估为有效，因为它在科学上基于波传播和阵列信号处理的原理，问题陈述完整且参数一致，并且表述客观。因此，我们可以着手解决。\n\n分析按要求分为四个部分：信号模型和聚焦原理的推导、距离分辨率的推导、角分辨率的推导，以及比较条件的建立。\n\n1.  **接收信号和近场聚焦原理**\n\n在均匀、各向同性、无耗散介质（自由场）中，声音的传播由标量声波方程控制：\n$$\n\\nabla^2 p(\\mathbf{r}, t) - \\frac{1}{c^2} \\frac{\\partial^2 p(\\mathbf{r}, t)}{\\partial t^2} = 0\n$$\n其中 $p(\\mathbf{r}, t)$ 是位置 $\\mathbf{r}$ 和时间 $t$ 的声压，$c$ 是声速。对于位于 $\\mathbf{r}_s$ 处发射波形 $S(t)$ 的点源，波动方程的解是一个出射的球面波：\n$$\np(\\mathbf{r}, t) = \\frac{A}{|\\mathbf{r} - \\mathbf{r}_s|} S\\left(t - \\frac{|\\mathbf{r} - \\mathbf{r}_s|}{c}\\right)\n$$\n其中 $A$ 是一个与声源相关的幅度常数。\n\n考虑一个由 $N$ 个麦克风组成的均匀线性阵列（ULA）。设第 $n$ 个麦克风的位置为 $\\mathbf{x}_n$。一个点源位于位置 $\\mathbf{x}_s = (x_s, z_s)$。从声源到第 $n$ 个麦克风的距离是 $r_n = |\\mathbf{x}_n - \\mathbf{x}_s|$。第 $n$ 个麦克风接收到的信号是：\n$$\np_n(t) = \\frac{A}{r_n} S\\left(t - \\frac{r_n}{c}\\right)\n$$\n这表明每个传感器接收到的信号是源波形的时间延迟和幅度缩放版本。时间延迟为 $\\tau_n = r_n/c$。\n\n距离聚焦，或称近场延迟求和波束形成，旨在通过对每个麦克风信号应用补偿延迟来对齐来自空间中特定聚焦点 $\\mathbf{x}_f$ 的波前。设从聚焦点 $\\mathbf{x}_f$ 到传感器 $n$ 的传播延迟为 $\\tau_{n,f} = |\\mathbf{x}_n - \\mathbf{x}_f|/c$。通过将每个信号 $p_n(t)$ 的时间轴向后平移 $\\tau_{n,f}$（或等效地，向前平移一个补偿量），然后求和，可以构造聚焦信号 $y(t)$。如果实际声源位于聚焦点（$\\mathbf{x}_s = \\mathbf{x}_f$），那么所有版本的波形 $S(t)$ 在求和前在时间上完全对齐，从而产生最大的相干增益。如果声源不在焦点处，波形会失准，由于相消干涉，求和结果会衰减。\n\n2.  **距离分辨率 $\\Delta r$**\n\n在距离上分辨两个声源的能力取决于接收信号的时间分辨率。对于带宽为 $B$（单位Hz）的带限信号，傅里叶不确定性原理建立了其带宽和其有效时间持续之间的关系。经过匹配滤波器（将接收信号与发射波形的副本进行互相关）处理后，输出是一个尖锐的峰值函数（信号的自相关）。这个峰值的宽度，也即可区分的两个到达之间的最小时间，与信号的带宽成反比。\n\n最小可分辨时间间隔 $\\Delta t$ 由下式给出：\n$$\n\\Delta t \\approx \\frac{1}{B}\n$$\n这个时间间隔对应于来自两个声源的传播距离差异。对于从距离为 $r$ 的声源到接收器的单向传播，传播时间为 $t = r/c$。因此，时间差 $\\Delta t$ 对应于距离差 $\\Delta r$：\n$$\n\\Delta t = \\frac{\\Delta r}{c}\n$$\n通过等同 $\\Delta t$ 的两个表达式，我们找到最小可分辨距离间隔 $\\Delta r$：\n$$\n\\frac{\\Delta r}{c} = \\frac{1}{B} \\implies \\Delta r = \\frac{c}{B}\n$$\n该表达式表明，距离分辨率与距离本身和阵列几何形状无关；它仅是信号带宽 $B$ 和声速 $c$ 的函数。\n\n3.  **角分辨率 $\\Delta \\theta$**\n\n阵列的角分辨率由其波束方向图（或阵列因子）的主瓣宽度决定。对于一个具有 $N$ 个元件、间距为 $d$、均匀加权的 ULA，对于远场源在角度 $\\theta$（相对于阵列侧射方向）的阵列因子是相邻元件之间相位差的函数，该相位差为 $k d \\sin\\theta$，其中 $k = 2\\pi/\\lambda$ 是声波数，$\\lambda = c/f_0$ 是中心频率 $f_0$ 处的波长。\n\n波束方向图的主瓣宽度与总孔径长度 $D = (N-1)d$ 成反比。最小可分辨角间隔 $\\Delta\\theta$ 通常由一个与主瓣宽度相关的标准定义，例如瑞利判据（峰到零点）或半功率波束宽度（HPBW）。问题指定使用HPBW。对于均匀加权的线性孔径，HPBW 由下式给出：\n$$\n\\Delta\\theta \\approx \\kappa \\frac{\\lambda}{D}\n$$\n其中，对于均匀线源的HPBW，比例常数 $\\kappa$ 约为 $0.886$。因此，最小可分辨角间隔为：\n$$\n\\Delta\\theta = 0.886 \\frac{\\lambda}{D} = 0.886 \\frac{c/f_0}{(N-1)d}\n$$\n此分辨率随着波长变长（频率降低）而变差，随着孔径变大而提高。\n\n4.  **比较条件**\n\n问题通过比较各自的分辨率长度尺度来定义距离辨别优于角度辨别的条件。距离分辨率为 $\\Delta r$。角分辨率 $\\Delta\\theta$（以弧度为单位）可以通过弧长公式投影到给定距离 $R$ 处的物理长度：$L = R \\Delta\\theta$。这代表了横向距离方向上的最小可分辨间隔。\n\n条件是距离分辨率长度尺度必须小于投影到距离上的角分辨率长度尺度：\n$$\n\\Delta r  R \\Delta\\theta\n$$\n代入推导出的 $\\Delta r$ 和 $\\Delta\\theta$ 表达式：\n$$\n\\frac{c}{B}  R \\left(0.886 \\frac{\\lambda}{D}\\right)\n$$\n其中 $R$ 是平均距离 $(R_1 + R_2)/2$，$\\lambda = c/f_0$，$D = (N-1)d$。程序将为提供的测试用例评估此不等式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes whether range resolution is superior to angular resolution for a uniform\n    linear microphone array based on derived physical principles.\n    \"\"\"\n    # Define the constant speed of sound in air.\n    c = 343.0  # Speed of sound in m/s\n\n    # Define the test suite as per the problem statement.\n    # Each case is a tuple: (N, d, f0, B, R1, R2)\n    # N: number of microphones\n    # d: inter-element spacing (m)\n    # f0: center frequency (Hz)\n    # B: waveform bandwidth (Hz)\n    # R1, R2: source ranges (m)\n    test_cases = [\n        (16, 0.02, 4000, 3000, 3.0, 3.12),\n        (16, 0.02, 4000, 200, 3.0, 3.12),\n        (50, 0.017, 10000, 5000, 2.0, 2.2),\n        (32, 0.015, 8000, 1400, 1.4, 1.6),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, d, f0, B, R1, R2 = case\n\n        # 1. Calculate the range resolution length scale (delta_r).\n        # This is derived from the signal's temporal resolution (1/B).\n        # delta_r = c / B\n        delta_r = c / B\n\n        # 2. Calculate the angular resolution (delta_theta).\n        # This is derived from the array's diffraction-limited half-power beamwidth.\n        \n        # Aperture length of the uniform linear array\n        D = (N - 1) * d\n        \n        # Wavelength at the center frequency\n        lmbda = c / f0\n        \n        # Proportionality constant for the half-power beamwidth of a uniformly\n        # weighted aperture.\n        kappa = 0.886\n        \n        # Smallest resolvable angular separation\n        delta_theta = kappa * lmbda / D\n\n        # 3. Calculate the angular resolution projected to a physical length at range R.\n        # R is the average of the two source ranges.\n        R_avg = (R1 + R2) / 2.0\n        \n        # Cross-range resolution length scale\n        cross_range_res = R_avg * delta_theta\n\n        # 4. Evaluate the comparison condition.\n        # Range discrimination exceeds angular resolution if the range resolution length\n        # scale is smaller than the cross-range resolution length scale.\n        is_range_superior = delta_r  cross_range_res\n        \n        results.append(is_range_superior)\n\n    # Format the final output as a comma-separated list of booleans in brackets.\n    # Python's str() correctly converts a boolean to \"True\" or \"False\".\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "真实的声学场景很少是静态的，这要求波束形成器能够实时自适应。本仿真练习旨在解决自适应波束形成的核心挑战：在存在干扰的情况下跟踪一个移动的声源。您将实现一个自适应MVDR波束形成器，并研究“遗忘因子”($\\lambda$)如何决定跟踪的灵活性与抑制噪声的稳定性之间的平衡，从而对这一关键参数获得切实的理解。",
            "id": "4117613",
            "problem": "一个阵列处理系统观测一个窄带声场，该声场包含一个时变期望源和一个固定干扰源。考虑一个由$M$个麦克风组成的均匀线性阵列（ULA），这些麦克风沿$x$轴等间距（间距为$d$）放置，并浸没在声速为$c$的均匀介质中。一个声学频率为$f_0$的时谐平面波传播至该阵列。在窄带假设下，离散时间索引$t$处的复基带快照模型为\n$$\n\\mathbf{x}[t] = s[t]\\,\\mathbf{a}(\\theta_s[t]) + i[t]\\,\\mathbf{a}(\\theta_i) + \\mathbf{n}[t],\n$$\n其中$s[t]$和$i[t]$是零均值圆对称复高斯源振幅，其方差分别为$\\sigma_s^2$和$\\sigma_i^2$，而$\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$是空间白噪声。导向矢量$\\mathbf{a}(\\theta)$定义为\n$$\n\\mathbf{a}(\\theta) = \\left[ e^{\\mathrm{j} k x_0 \\sin(\\theta)}, e^{\\mathrm{j} k x_1 \\sin(\\theta)}, \\dots, e^{\\mathrm{j} k x_{M-1} \\sin(\\theta)} \\right]^{\\top},\n$$\n其中$k = \\frac{2\\pi f_0}{c}$是声学波数，$x_m = m d$是第$m$个传感器（$m = 0,1,\\dots,M-1$）的位置。期望源的波达方向（DOA）随时间变化为$\\theta_s[t]$，而干扰源的DOA $\\theta_i$是恒定的。角度在指定时必须以度为单位，并在$\\sin(\\cdot)$中使用时转换为弧度。\n\n在时间$t$的最小方差无失真响应（MVDR）波束形成器求解以下问题：\n$$\n\\min_{\\mathbf{w}\\in\\mathbb{C}^M} \\ \\mathbf{w}^{\\mathrm{H}} \\mathbf{R}[t] \\mathbf{w} \\quad \\text{约束条件为} \\quad \\mathbf{w}^{\\mathrm{H}}\\mathbf{a}(\\theta_s[t]) = 1,\n$$\n其中$\\mathbf{R}[t]$是时间$t$的阵列协方差矩阵。对于所述的随机模型，精确（预言）协方差为\n$$\n\\mathbf{R}_{\\mathrm{true}}[t] = \\sigma_s^2 \\mathbf{a}(\\theta_s[t])\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t]) + \\sigma_i^2 \\mathbf{a}(\\theta_i)\\mathbf{a}^{\\mathrm{H}}(\\theta_i) + \\sigma_n^2 \\mathbf{I}_M.\n$$\nMVDR的解是唯一的矢量\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\frac{\\mathbf{R}^{-1}[t]\\,\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\,\\mathbf{R}^{-1}[t]\\,\\mathbf{a}(\\theta_s[t])}.\n$$\n在实践中，使用指数加权递推协方差估计器：\n$$\n\\widehat{\\mathbf{R}}[t] = \\lambda\\,\\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\,\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t],\n$$\n其中$0  \\lambda  1$是遗忘因子，$\\widehat{\\mathbf{R}}[0]$是初始半正定矩阵。自适应MVDR使用$\\widehat{\\mathbf{R}}[t]$代替$\\mathbf{R}[t]$。\n\n从计算声学和统计信号处理的基本原理出发，推导遗忘因子$\\lambda$应满足的条件，以确保自适应MVDR能够以有界误差跟踪由$\\theta_s[t]$引起的$\\mathbf{R}_{\\mathrm{true}}[t]$的时变性。你的推导必须从平面波阵列模型和MVDR优化定义开始，然后说明指数加权递推如何作为对协方差轨迹的离散时间线性时不变低通滤波器。建立$\\lambda$与$\\theta_s[t]$变化频率之间的关系（考虑一个正弦波达方向变化$\\theta_s[t] = \\Theta \\sin(2\\pi f_v t)$，其中$\\Theta$以度为单位， $f_v$以周期/帧为单位），并推导一个关于$\\lambda$的不等式，以保证在角频率$\\omega_v = 2\\pi f_v$处滤波器幅度响应方面达到指定的跟踪保真度水平。当输入快照被加性白噪声污染时，还需推导一个方差限制条件，以将估计器方差保持在预定界限以下。清晰地陈述将协方差跟踪与MVDR权重跟踪联系起来所需的任何近似。\n\n然后，你必须实现一个程序来模拟此场景，并通过将自适应MVDR权重$\\widehat{\\mathbf{w}}[t]$（使用$\\widehat{\\mathbf{R}}[t]$获得）与预言MVDR权重$\\mathbf{w}_{\\mathrm{MVDR}}[t]$（使用$\\mathbf{R}_{\\mathrm{true}}[t]$获得）进行比较，来凭经验评估跟踪行为。使用以下科学上合理的参数，并确保在问题陈述中角度以度为单位指定，并在计算中转换为弧度：\n- 麦克风数量：$M = 8$。\n- 传感器间距：$d = 0.035\\,\\mathrm{m}$。\n- 声速：$c = 343\\,\\mathrm{m/s}$。\n- 窄带频率：$f_0 = 3000\\,\\mathrm{Hz}$。\n- 期望源DOA变化：$\\theta_s[t] = \\Theta \\sin(2\\pi f_v t)$，振幅$\\Theta = 30\\,\\mathrm{deg}$。\n- 干扰源DOA：$\\theta_i = -20\\,\\mathrm{deg}$。\n- 源、干扰源和噪声方差：$\\sigma_s^2 = 1.0$，$\\sigma_i^2 = 5.0$，$\\sigma_n^2 = 0.1$（无量纲复基带功率单位）。\n- 帧数：$T = 4000$。\n- 每次协方差求逆时增加的对角加载：一个小的常数$\\gamma = 10^{-3}$以确保数值稳定性（无量纲）。\n\n将时间$t$的跟踪误差定义为\n$$\ne[t] = \\left\\|\\widehat{\\mathbf{w}}[t] - \\mathbf{w}_{\\mathrm{MVDR}}[t]\\right\\|_2,\n$$\n并将整体跟踪误差度量定义为均方根误差\n$$\nE = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T} e[t]^2}.\n$$\n\n你的程序必须运行四个测试用例，通过改变遗忘因子$\\lambda$和DOA变化频率$f_v$（单位：周期/帧）来探究不同的跟踪机制。对于每个用例，计算$E$并将其与指定阈值$\\tau$进行比较，以产生一个指示跟踪是否成功的布尔结果。使用以下测试套件：\n- 用例1：$\\lambda = 0.98$，$f_v = \\frac{1}{500}$，阈值$\\tau = 0.20$。\n- 用例2：$\\lambda = 0.98$，$f_v = \\frac{1}{50}$，阈值$\\tau = 0.20$。\n- 用例3：$\\lambda = 0.90$，$f_v = \\frac{1}{20}$，阈值$\\tau = 0.25$。\n- 用例4：$\\lambda = 0.60$，$f_v = \\frac{1}{20}$，阈值$\\tau = 0.25$。\n\n对于每个测试用例，输出一个布尔值，指示是否$E \\le \\tau$。你的程序应生成单行输出，其中包含用方括号括起来的、按上述测试用例顺序排列的、以逗号分隔的结果列表。\n\n在模拟中，所有角度必须在参数中以度为单位指定，然后在内部用于三角函数时转换为弧度。$d$、$c$和$f_0$的物理单位必须完全按照指定使用：$d$用米，$c$用米/秒，$f_0$用赫兹。输出的布尔值列表没有物理单位。",
            "solution": "我们从声学平面波模型和阵列响应开始。在声速为$c$的均匀介质中传播的角频率为$\\omega_0 = 2\\pi f_0$的时谐平面波的波数为$k = \\frac{\\omega_0}{c} = \\frac{2\\pi f_0}{c}$。对于传感器位置为$x_m = m d$（沿$x$轴）的均匀线性阵列（ULA），从方向$\\theta$（从法线方向测量，单位为度，在三角函数中使用时转换为弧度）入射的平面波的窄带复基带导向矢量$\\mathbf{a}(\\theta)$为\n$$\n\\mathbf{a}(\\theta) = \\left[e^{\\mathrm{j} k x_0 \\sin(\\theta)}, e^{\\mathrm{j} k x_1 \\sin(\\theta)}, \\dots, e^{\\mathrm{j} k x_{M-1} \\sin(\\theta)}\\right]^{\\top},\n$$\n这源于相位累积$k\\mathbf{r}\\cdot\\hat{\\mathbf{s}}$，其中$\\hat{\\mathbf{s}}$是单位传播方向。\n\n在窄带叠加模型下，离散时间$t$观测到的快照为\n$$\n\\mathbf{x}[t] = s[t]\\mathbf{a}(\\theta_s[t]) + i[t]\\mathbf{a}(\\theta_i) + \\mathbf{n}[t],\n$$\n其中$s[t]\\sim\\mathcal{CN}(0,\\sigma_s^2)$、$i[t]\\sim\\mathcal{CN}(0,\\sigma_i^2)$和$\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$相互独立。精确的协方差矩阵是各分量协方差之和：\n$$\n\\mathbf{R}_{\\mathrm{true}}[t] = \\mathbb{E}\\left[\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]\\right] = \\sigma_s^2 \\mathbf{a}(\\theta_s[t])\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t]) + \\sigma_i^2 \\mathbf{a}(\\theta_i)\\mathbf{a}^{\\mathrm{H}}(\\theta_i) + \\sigma_n^2 \\mathbf{I}_M.\n$$\n\n最小方差无失真响应（MVDR）波束形成器定义为\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\arg\\min_{\\mathbf{w}} \\ \\mathbf{w}^{\\mathrm{H}}\\mathbf{R}[t]\\mathbf{w} \\quad \\text{约束条件为} \\quad \\mathbf{w}^{\\mathrm{H}}\\mathbf{a}(\\theta_s[t]) = 1.\n$$\n使用拉格朗日乘子法，其解是众所周知的：\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\frac{\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}.\n$$\n我们使用对角加载来确保数值稳定性：将$\\mathbf{R}[t]$替换为$\\mathbf{R}[t]+\\gamma\\mathbf{I}_M$，其中$\\gamma0$是一个小数。\n\n在自适应操作中，协方差通过指数加权移动平均（EWMA）进行递推估计：\n$$\n\\widehat{\\mathbf{R}}[t] = \\lambda \\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t], \\quad 0\\lambda1,\n$$\n并用一个半正定矩阵$\\widehat{\\mathbf{R}}[0]$进行初始化。这个递推对$\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$是线性的，并定义了一个作用于协方差样本$\\mathbf{S}[t] \\triangleq \\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$轨迹的离散时间线性时不变（LTI）滤波器。对任意标量项$\\widehat{R}_{mn}[t] = \\lambda \\widehat{R}_{mn}[t-1] + (1-\\lambda) S_{mn}[t]$写出其分量形式的递推式，进行Z变换得到\n$$\n\\widehat{R}_{mn}(z) = \\frac{(1-\\lambda)}{1 - \\lambda z^{-1}} S_{mn}(z),\n$$\n所以滤波器的传递函数是\n$$\nH(z) = \\frac{(1-\\lambda)}{1 - \\lambda z^{-1}},\n$$\n其极点在$z=\\lambda$。在单位圆$z=e^{\\mathrm{j}\\omega}$上求值，幅度响应为\n$$\n|H(e^{\\mathrm{j}\\omega})| = \\frac{(1-\\lambda)}{\\sqrt{1 + \\lambda^2 - 2\\lambda\\cos\\omega}}.\n$$\n将$\\mathbf{R}_{\\mathrm{true}}[t]$解释为由DOA变化驱动的缓慢时变信号，并将$\\mathbf{S}[t]$解释为该信号的含噪样本，EWMA对每个协方差项起到一阶低通平滑作用。以样本数为单位的有效时间常数约为\n$$\nN_{\\mathrm{eff}} = \\frac{1}{1-\\lambda},\n$$\n因为其冲激响应是$h[t] = (1-\\lambda)\\lambda^{t} u[t]$，其均值索引为$\\frac{\\lambda}{1-\\lambda}$，其$e^{-1}$衰减时间在$\\frac{1}{1-\\lambda}$的量级上。\n\n跟踪保真度要求：假设由于正弦DOA $\\theta_s[t] = \\Theta\\sin(2\\pi f_v t)$，期望协方差在角频率$\\omega_v = 2\\pi f_v$附近近似正弦变化。为确保EWMA对协方差变化幅度的衰减不超过指定的分数$\\alpha\\in(0,1]$，施加\n$$\n|H(e^{\\mathrm{j}\\omega_v})| \\ge \\alpha.\n$$\n代入幅度响应并两边平方，我们得到\n$$\n\\frac{(1-\\lambda)^2}{1 + \\lambda^2 - 2\\lambda\\cos\\omega_v} \\ge \\alpha^2,\n$$\n这可以重新整理为一个关于$\\lambda$的不等式：\n$$\n(1-\\lambda)^2 \\ge \\alpha^2\\left(1 + \\lambda^2 - 2\\lambda\\cos\\omega_v\\right).\n$$\n展开并合并各项，得到\n$$\n1 - 2\\lambda + \\lambda^2 \\ge \\alpha^2 + \\alpha^2\\lambda^2 - 2\\alpha^2\\lambda\\cos\\omega_v.\n$$\n将所有项移到一边，得到一个关于$\\lambda$的二次不等式：\n$$\n(1-\\alpha^2)\\lambda^2 + \\left(-2 + 2\\alpha^2\\cos\\omega_v\\right)\\lambda + (1 - \\alpha^2) \\ge 0.\n$$\n对于选定的$\\alpha$和$\\omega_v$，此不等式定义了一个$\\lambda$值的区间，这些值在$\\omega_v$处至少能达到期望的通带增益。在$\\alpha$接近1的常见情况下，直观条件$N_{\\mathrm{eff}} \\ll \\frac{2\\pi}{\\omega_v}$出现，即滤波器记忆应远短于变化周期：$\\frac{1}{1-\\lambda} \\ll \\frac{2\\pi}{\\omega_v}$，或等价于\n$$\n\\lambda \\ll 1 - \\frac{\\omega_v}{2\\pi}\\cdot c_\\alpha,\n$$\n其中$c_\\alpha$是由期望保真度决定的常数（精确界限由二次不等式给出）。\n\n方差限制要求：EWMA减少了白噪声驱动输入的方差。如果$S_{mn}[t]$包含方差为$\\sigma_{S}^2$的加性白噪声，则$\\widehat{R}_{mn}[t]$的输出方差为\n$$\n\\mathrm{Var}\\{\\widehat{R}_{mn}[t]\\} = \\sigma_{S}^2 \\sum_{k=0}^{\\infty} (1-\\lambda)^2 \\lambda^{2k} = \\sigma_{S}^2 \\frac{(1-\\lambda)^2}{1 - \\lambda^2}.\n$$\n为将估计器方差限制在$\\beta^2$以内，施加\n$$\n\\sigma_{S}^2 \\frac{(1-\\lambda)^2}{1 - \\lambda^2} \\le \\beta^2.\n$$\n解出$\\lambda$得到\n$$\n\\frac{(1-\\lambda)^2}{1 - \\lambda^2} \\le \\frac{\\beta^2}{\\sigma_{S}^2} \\quad \\Rightarrow \\quad \\frac{1-\\lambda}{1+\\lambda} \\le \\frac{\\beta^2}{\\sigma_{S}^2},\n$$\n这得出\n$$\n\\lambda \\ge \\frac{1 - \\frac{\\beta^2}{\\sigma_{S}^2}}{1 + \\frac{\\beta^2}{\\sigma_{S}^2}}.\n$$\n因此，$\\lambda$必须足够接近1以抑制方差，但又不能太近以至于违反在$\\omega_v$处的跟踪保真度。结合保真度和方差界限，可以得到$\\lambda$的允许区间。\n\n连接协方差跟踪与MVDR权重跟踪：MVDR权重通过以下方式平滑地依赖于$\\mathbf{R}^{-1}[t]$\n$$\n\\mathbf{w}[t] = \\frac{\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}.\n$$\n如果$\\widehat{\\mathbf{R}}[t]$在算子范数下以有界误差跟踪$\\mathbf{R}_{\\mathrm{true}}[t]$，并保持正定（例如，通过对角加载$\\gamma\\mathbf{I}_M$），那么根据矩阵求逆在正定矩阵锥上的连续性以及导向矢量映射$\\theta\\mapsto\\mathbf{a}(\\theta)$的光滑性，$\\mathbf{w}[t]$中引起的误差是有界的。因此，EWMA的保真度约束$|H(e^{\\mathrm{j}\\omega_v})|\\ge\\alpha$和噪声方差界限会转化为有界的MVDR权重跟踪误差$E$。\n\n模拟的算法实现：\n- 固定$M$、$d$、$c$和$f_0$，计算$k = \\frac{2\\pi f_0}{c}$。\n- 使用$\\sin(\\theta)$（其中$\\theta$为弧度）定义$\\mathbf{a}(\\theta)$。\n- 对每个测试用例，设置$\\lambda$、$f_v$和阈值$\\tau$；定义$\\theta_s[t] = \\Theta\\sin(2\\pi f_v t)$，其中$\\Theta$以度为单位，将$\\theta_s[t]$和$\\theta_i$转换为弧度用于导向矢量求值。\n- 初始化$\\widehat{\\mathbf{R}}[0] = \\sigma_n^2 \\mathbf{I}_M$。\n- 对于$t=1,\\dots,T$：\n  - 抽取$s[t]\\sim\\mathcal{CN}(0,\\sigma_s^2)$、$i[t]\\sim\\mathcal{CN}(0,\\sigma_i^2)$和$\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$。\n  - 构成$\\mathbf{x}[t] = s[t]\\mathbf{a}(\\theta_s[t]) + i[t]\\mathbf{a}(\\theta_i) + \\mathbf{n}[t]$。\n  - 更新$\\widehat{\\mathbf{R}}[t] = \\lambda\\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$。\n  - 使用$\\sigma_s^2$、$\\sigma_i^2$、$\\sigma_n^2$、$\\mathbf{a}(\\theta_s[t])$和$\\mathbf{a}(\\theta_i)$计算$\\mathbf{R}_{\\mathrm{true}}[t]$。\n  - 通过对角加载$\\gamma\\mathbf{I}_M$，不显式求逆而是通过求解线性系统来计算$\\widehat{\\mathbf{w}}[t]$和$\\mathbf{w}_{\\mathrm{MVDR}}[t]$：令$\\mathbf{v}_{\\mathrm{hat}}[t]$解$(\\widehat{\\mathbf{R}}[t]+\\gamma\\mathbf{I}_M)\\mathbf{v}=\\mathbf{a}(\\theta_s[t])$，并设置$\\widehat{\\mathbf{w}}[t] = \\mathbf{v}_{\\mathrm{hat}}[t]/\\left(\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{v}_{\\mathrm{hat}}[t]\\right)$；对预言值使用$\\mathbf{R}_{\\mathrm{true}}[t]$做同样处理。\n  - 计算$e[t] = \\left\\|\\widehat{\\mathbf{w}}[t] - \\mathbf{w}_{\\mathrm{MVDR}}[t]\\right\\|_2$。\n- 计算$E = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T} e[t]^2}$并与$\\tau$比较，得出测试用例的布尔结果。\n\n科学真实性与边界情况：\n- $0\\lambda1$且初始$\\widehat{\\mathbf{R}}[0]\\succeq \\mathbf{0}$的递推保持了半正定性，因为每次更新都是$\\widehat{\\mathbf{R}}[t-1]$和$\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$的正凸组合。对角加载确保了可逆性。\n- 正弦DOA变化引入了单一的变化频率$\\omega_v$，使得通过$|H(e^{\\mathrm{j}\\omega_v})|$进行保真度分析是恰当的。\n- 方差界限将$\\lambda$与对快照噪声的鲁棒性联系起来。\n\n测试套件覆盖范围：\n- 用例1（慢变化，大$\\lambda$）：$f_v=\\frac{1}{500}$，$\\lambda=0.98$，预期跟踪效果好（$E\\le\\tau$）。\n- 用例2（较快变化，相同$\\lambda$）：$f_v=\\frac{1}{50}$，$\\lambda=0.98$，预期跟踪效果下降（$E\\tau$）。\n- 用例3（中等变化，较小$\\lambda$）：$f_v=\\frac{1}{20}$，$\\lambda=0.90$，预期可接受的权衡（$E\\le\\tau$）。\n- 用例4（中等变化，小$\\lambda$）：$f_v=\\frac{1}{20}$，$\\lambda=0.60$，预期估计噪声大（$E\\tau$）。\n\n该程序实现了这些用例，并按顺序打印出包含四个布尔值的单行结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef steering_vector(theta_deg, k, d, M):\n    \"\"\"\n    Construct ULA steering vector for angle theta_deg (degrees).\n    Uses radians internally for sin.\n    \"\"\"\n    theta_rad = np.deg2rad(theta_deg)\n    # Sensor positions x_m = m*d, m=0..M-1\n    m_idx = np.arange(M)\n    x = m_idx * d\n    return np.exp(1j * k * x * np.sin(theta_rad))\n\ndef mvdr_weights(R, a, gamma=1e-3):\n    \"\"\"\n    MVDR weights with diagonal loading gamma. Avoid explicit inverse by solving.\n    w = R^{-1} a / (a^H R^{-1} a)\n    \"\"\"\n    M = R.shape[0]\n    R_loaded = R + gamma * np.eye(M, dtype=R.dtype)\n    # Solve R_loaded v = a\n    v = np.linalg.solve(R_loaded, a)\n    denom = np.vdot(a, v)  # a^H v\n    # Protect against numerical issues\n    if np.abs(denom)  1e-12:\n        return np.zeros_like(a)\n    return v / denom\n\ndef simulate_case(M, d, c, f0, Theta_deg, theta_i_deg,\n                  sigma_s2, sigma_i2, sigma_n2,\n                  T, lam, f_v, gamma, rng):\n    \"\"\"\n    Simulate adaptive MVDR tracking for a single test case.\n    Returns RMS weight error E.\n    \"\"\"\n    # Wavenumber\n    k = 2.0 * np.pi * f0 / c\n    # Fixed interferer steering\n    a_i = steering_vector(theta_i_deg, k, d, M)\n    # Initialize covariance estimate\n    R_hat = sigma_n2 * np.eye(M, dtype=np.complex128)\n    # Accumulate squared errors\n    err_sq_sum = 0.0\n\n    for t in range(1, T + 1):\n        # Desired DOA varies sinusoidally: theta_s[t] = Theta * sin(2*pi*f_v*t)\n        theta_s_deg = Theta_deg * np.sin(2.0 * np.pi * f_v * t)\n        a_s = steering_vector(theta_s_deg, k, d, M)\n\n        # Draw complex Gaussian amplitudes and noise\n        # Complex CN(0, sigma^2): real and imag ~ N(0, sigma^2/2)\n        s = (np.sqrt(sigma_s2 / 2.0) *\n             (rng.standard_normal() + 1j * rng.standard_normal()))\n        i = (np.sqrt(sigma_i2 / 2.0) *\n             (rng.standard_normal() + 1j * rng.standard_normal()))\n        n = (np.sqrt(sigma_n2 / 2.0) *\n             (rng.standard_normal(M) + 1j * rng.standard_normal(M)))\n\n        # Snapshot\n        x = s * a_s + i * a_i + n\n\n        # Recursive covariance update\n        R_hat = lam * R_hat + (1.0 - lam) * np.outer(x, np.conj(x))\n\n        # Oracle covariance\n        R_true = (sigma_s2 * np.outer(a_s, np.conj(a_s)) +\n                  sigma_i2 * np.outer(a_i, np.conj(a_i)) +\n                  sigma_n2 * np.eye(M, dtype=np.complex128))\n\n        # Weights\n        w_hat = mvdr_weights(R_hat, a_s, gamma=gamma)\n        w_oracle = mvdr_weights(R_true, a_s, gamma=gamma)\n\n        # Error\n        e = np.linalg.norm(w_hat - w_oracle)\n        err_sq_sum += (e * e)\n\n    E = np.sqrt(err_sq_sum / T)\n    return E\n\ndef solve():\n    # Fixed parameters from the problem statement\n    M = 8\n    d = 0.035  # meters\n    c = 343.0  # m/s\n    f0 = 3000.0  # Hz\n    Theta_deg = 30.0  # degrees\n    theta_i_deg = -20.0  # degrees\n    sigma_s2 = 1.0\n    sigma_i2 = 5.0\n    sigma_n2 = 0.1\n    T = 4000\n    gamma = 1e-3\n\n    # Test cases: (lambda, f_v, threshold tau)\n    test_cases = [\n        (0.98, 1.0/500.0, 0.20),  # Case 1\n        (0.98, 1.0/50.0, 0.20),   # Case 2\n        (0.90, 1.0/20.0, 0.25),   # Case 3\n        (0.60, 1.0/20.0, 0.25),   # Case 4\n    ]\n\n    # Seed for reproducibility\n    rng = np.random.default_rng(123456)\n\n    results = []\n    for lam, f_v, tau in test_cases:\n        E = simulate_case(M, d, c, f0, Theta_deg, theta_i_deg,\n                          sigma_s2, sigma_i2, sigma_n2,\n                          T, lam, f_v, gamma, rng)\n        results.append(E = tau)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}