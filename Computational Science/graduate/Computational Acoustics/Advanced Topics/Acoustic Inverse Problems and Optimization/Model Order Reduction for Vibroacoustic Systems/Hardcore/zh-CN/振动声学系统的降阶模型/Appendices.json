{
    "hands_on_practices": [
        {
            "introduction": "在对复杂模型进行降阶之前，理解振动声学耦合的底层物理机制至关重要。本练习从一个简单的双自由度系统入手，引导你通过解析推导其频率响应函数。通过这个过程，你将能直观地看到结构模态与声学模态如何相互作用、耦合如何改变系统的共振频率，以及系统极点与可观测的响应峰值之间的根本联系，从而为处理更复杂的实际问题建立坚实的物理直觉。",
            "id": "4129351",
            "problem": "通过模态截断得到一个单输入单输出 (SISO) 降阶振动声学模型，该模型保留了一个主导结构模态和一个主导声腔模态。保留的广义结构位移为 $q_{s}(t)$，其模态质量为 $m_{s}$，粘性阻尼为 $c_{s}$，刚度为 $k_{s}$。保留的广义声学模态坐标为 $q_{a}(t)$，其模态质量为 $m_{a}$，粘性阻尼为 $c_{a}$，刚度为 $k_{a}$。结构子系统和声学子系统通过由流固耦合功产生的对称耦合系数 $\\kappa$ 进行耦合。一个外部广义力 $u(t)$ 作用于结构模态。测量的输出是声学模态振幅 $y(t) = q_{a}(t)$。在模态坐标下，根据结构的牛顿第二定律和声腔的线性声波方程（模态形式）推导出的控制方程为\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t), \\\\\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0.\n$$\n引入一阶状态 $x(t) = \\big(q_{s}(t),\\, q_{a}(t),\\, \\dot{q}_{s}(t),\\, \\dot{q}_{a}(t)\\big)^{\\top}$，并用适当的常数矩阵 $E$、$A$、$B$、$C$、$D$ 将系统写成标准的状态空间形式 $E\\,\\dot{x}(t) = A\\,x(t) + B\\,u(t)$，$y(t) = C\\,x(t) + D\\,u(t)$。\n\n从线性时不变描述符系统的传递函数定义 $G(s) = C\\,(sE - A)^{-1}B + D$ 出发，完成以下任务：\n- 推导该耦合振动声学系统频率响应 $G(i\\omega)$ 的闭式表达式，该表达式是物理参数 $\\{m_{s},c_{s},k_{s},m_{a},c_{a},k_{a},\\kappa\\}$ 和角频率 $\\omega$ 的函数。\n- 仅使用关于线性系统和传递函数极点的基本原理，阐明在轻阻尼情况下，幅值 $|G(i\\omega)|$ 的峰值与系统极点之间的关系。\n\n最后，考虑无阻尼情况 $c_{s} = 0$ 和 $c_{a} = 0$，并定义非耦合固有频率 $\\omega_{s} = \\sqrt{k_{s}/m_{s}}$ 和 $\\omega_{a} = \\sqrt{k_{a}/m_{a}}$，以及耦合频率参数 $\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$。通过将无阻尼耦合模态频率作为主阶近似，计算在轻阻尼下 $|G(i\\omega)|$ 出现峰值的较低耦合共振频率 $\\omega_{-}$（单位为弧度/秒）。以 $\\omega_{s}$、$\\omega_{a}$ 和 $\\beta$ 的单个解析表达式形式提供您的最终答案。频率以弧度/秒表示。最终答案框中不要包含单位。",
            "solution": "问题要求推导一个二自由度振动声学系统的频率响应函数，解释其共振行为，并计算无阻尼情况下的较低耦合共振频率。对问题陈述的验证已确认其科学合理性和适定性。\n\n首先，我们推导从输入力 $u(t)$ 到输出声学模态振幅 $y(t) = q_a(t)$ 的传递函数 $G(s)$。控制方程为：\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t)\n$$\n$$\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0\n$$\n我们对这些方程应用拉普拉斯变换，并假设初始条件为零。令 $Q_s(s) = \\mathcal{L}\\{q_s(t)\\}$，$Q_a(s) = \\mathcal{L}\\{q_a(t)\\}$，以及 $U(s) = \\mathcal{L}\\{u(t)\\}$。变换后的方程为：\n$$\n(m_{s}s^2 + c_{s}s + k_{s})Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n(m_{a}s^2 + c_{a}s + k_{a})Q_a(s) + \\kappa Q_s(s) = 0\n$$\n为简化符号，我们定义非耦合模态阻抗为 $Z_s(s) = m_{s}s^2 + c_{s}s + k_{s}$ 和 $Z_a(s) = m_{a}s^2 + c_{a}s + k_{a}$。方程组变为：\n$$\nZ_s(s)Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\kappa Q_s(s) + Z_a(s)Q_a(s) = 0\n$$\n输出为 $y(t) = q_a(t)$，因此在拉普拉斯域中的输出为 $Y(s) = Q_a(s)$。传递函数为 $G(s) = Y(s)/U(s) = Q_a(s)/U(s)$。我们求解方程组以得到 $Q_a(s)$。从第二个方程，我们将 $Q_s(s)$ 用 $Q_a(s)$ 表示：\n$$\nQ_s(s) = -\\frac{Z_a(s)}{\\kappa}Q_a(s)\n$$\n将此代入第一个方程：\n$$\nZ_s(s)\\left(-\\frac{Z_a(s)}{\\kappa}Q_a(s)\\right) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\left(-\\frac{Z_s(s)Z_a(s)}{\\kappa} + \\kappa\\right)Q_a(s) = U(s)\n$$\n$$\n\\frac{\\kappa^2 - Z_s(s)Z_a(s)}{\\kappa}Q_a(s) = U(s)\n$$\n因此，传递函数 $G(s)$ 为：\n$$\nG(s) = \\frac{Q_a(s)}{U(s)} = \\frac{\\kappa}{\\kappa^2 - Z_s(s)Z_a(s)}\n$$\n代回 $Z_s(s)$ 和 $Z_a(s)$ 的表达式：\n$$\nG(s) = \\frac{\\kappa}{\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a})}\n$$\n频率响应函数 $G(i\\omega)$ 通过代入 $s = i\\omega$ 得到，其中 $\\omega$ 是角频率。\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (m_{s}(i\\omega)^2 + c_{s}(i\\omega) + k_{s})(m_{a}(i\\omega)^2 + c_{a}(i\\omega) + k_{a})}\n$$\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (-m_{s}\\omega^2 + ic_{s}\\omega + k_{s})(-m_{a}\\omega^2 + ic_{a}\\omega + k_{a})}\n$$\n整理各项得到频率响应的最终表达式：\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - ((k_{s} - m_{s}\\omega^2) + ic_{s}\\omega)((k_{a} - m_{a}\\omega^2) + ic_{a}\\omega)}\n$$\n\n接下来，我们讨论幅值 $|G(i\\omega)|$ 的峰值与系统极点之间的关系。传递函数 $G(s)$ 的极点是特征方程的根，通过将分母设为零得到：\n$$\n\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a}) = 0\n$$\n对于一个有阻尼的稳定系统（$c_s > 0, c_a > 0$），极点是具有负实部 $\\sigma_k < 0$ 的复共轭对 $p_k = \\sigma_k \\pm i\\omega_{d,k}$。当分母的幅值最小时，频率响应的幅值 $|G(i\\omega)| = |\\kappa| / |\\text{denominator}(i\\omega)|$ 将出现一个峰值（共振）。对于靠近虚轴的极点 $p_k$（轻阻尼，意味着 $|\\sigma_k|$ 很小），当 $\\omega$ 接近极点的虚部 $\\omega_{d,k}$ 时，在 $s=i\\omega$ 处计算的分母函数将具有很小的幅值。因此，对于轻阻尼情况， $|G(i\\omega)|$ 的峰值出现在约等于靠近虚轴的系统极点虚部的频率 $\\omega$ 处。\n\n最后，我们考虑无阻尼情况，即 $c_{s} = 0$ 和 $c_{a} = 0$。在这种情况下，系统极点位于虚轴上，$s = \\pm i\\omega$，并对应于耦合固有频率。问题要求的是这些频率中较低的一个，它对应一个共振峰。我们通过求解特征方程来得到 $\\omega$：\n$$\n\\kappa^2 - (m_{s}(i\\omega)^2 + k_{s})(m_{a}(i\\omega)^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (-m_{s}\\omega^2 + k_{s})(-m_{a}\\omega^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (k_{s} - m_{s}\\omega^2)(k_{a} - m_{a}\\omega^2) = 0\n$$\n我们引入非耦合固有频率 $\\omega_{s} = \\sqrt{k_{s}/m_{s}}$ 和 $\\omega_{a} = \\sqrt{k_{a}/m_{a}}$，这意味着 $k_{s} = m_{s}\\omega_{s}^2$ 和 $k_{a} = m_{a}\\omega_{a}^2$。将这些代入方程得到：\n$$\n\\kappa^2 - (m_{s}\\omega_{s}^2 - m_{s}\\omega^2)(m_{a}\\omega_{a}^2 - m_{a}\\omega^2) = 0\n$$\n$$\n\\kappa^2 - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n使用耦合频率参数定义 $\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$，我们得到 $\\kappa^2 = \\beta^2 m_{s}m_{a}$。方程变为：\n$$\n\\beta^2 m_{s}m_{a} - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n两边除以 $m_s m_a$（非零）：\n$$\n\\beta^2 - (\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n我们定义一个新变量 $X = \\omega^2$。该方程是关于 $X$ 的二次方程：\n$$\n\\beta^2 - (\\omega_{s}^2\\omega_{a}^2 - (\\omega_{s}^2+\\omega_{a}^2)X + X^2) = 0\n$$\n$$\nX^2 - (\\omega_{s}^2 + \\omega_{a}^2)X + (\\omega_{s}^2\\omega_{a}^2 - \\beta^2) = 0\n$$\n我们使用二次公式求解 $X$：\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(-(\\omega_{s}^2 + \\omega_{a}^2))^2 - 4(1)(\\omega_{s}^2\\omega_{a}^2 - \\beta^2)}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^4 + 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4) - 4\\omega_{s}^2\\omega_{a}^2 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{\\omega_{s}^4 - 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2}}{2}\n$$\n$\\omega^2$ 的两个解是 $\\omega^2_+$ 和 $\\omega^2_-$。较低的耦合共振频率 $\\omega_-$ 对应于带有负号的 $\\omega^2$ 解，我们将其记为 $\\omega_-^2$。\n$$\n\\omega_-^2 = \\frac{1}{2} \\left[ (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right]\n$$\n取平方根得到较低的耦合频率 $\\omega_{-}：$\n$$\n\\omega_{-} = \\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right)}\n$$\n这就是较低耦合共振频率的最终解析表达式。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^{2} + \\omega_{a}^{2}) - \\sqrt{(\\omega_{s}^{2} - \\omega_{a}^{2})^{2} + 4\\beta^{2}} \\right)}}\n$$"
        },
        {
            "introduction": "接下来，我们将从解析模型转向数据驱动的降阶方法。本练习聚焦于一种核心的降阶技术——本征正交分解（Proper Orthogonal Decomposition, POD），它从仿真或实验数据（“快照”）中构建模型。这项计算任务不仅要求你根据给定的误差容限确定所需的模型阶数，更关键的是，它将引导你把这个抽象的数学误差转化为对声压这一物理量的具体预测误差上界，从而架起模型降阶理论与实际工程应用之间的桥梁。",
            "id": "4129346",
            "problem": "考虑一个通过耦合结构声学方程的空间离散化得到的线性振动声学系统。结构动力学由二阶形式的方程 $M \\ddot{q}(t) + C \\dot{q}(t) + K q(t) = f(t)$ 表示，其中 $M \\in \\mathbb{R}^{n \\times n}$ 是对称正定质量矩阵，$C \\in \\mathbb{R}^{n \\times n}$ 是阻尼矩阵，$K \\in \\mathbb{R}^{n \\times n}$ 是刚度矩阵，$q(t) \\in \\mathbb{R}^{n}$ 是位移向量，$f(t) \\in \\mathbb{R}^{n}$ 是外力。设 $H \\in \\mathbb{R}^{p \\times n}$ 是一个线性观测算子，它通过一个线性化耦合模型将结构位移映射到 $p$ 个麦克风处的声压，因此预测的声压向量为 $p(t) = H q(t)$。\n\n假设 $C$ 和 $K$ 使得系统是稳定的，并且主要关注点是在由 $M$ 诱导的加权范数下近似位移 $q(t)$。定义对称正定权重矩阵 $W_x = M$，并且对于任意向量 $x \\in \\mathbb{R}^{n}$，定义加权范数 $\\|x\\|_{W_x} = \\sqrt{x^{\\mathsf{T}} W_x x}$。声压以 $\\mathrm{Pa}$ 为单位测量，并采用欧几里得范数 $\\|p\\|_{2}$。\n\n给定一个快照矩阵 $S \\in \\mathbb{R}^{n \\times m}$，其列向量为 $m$ 个状态快照 $q(t_j)$，考虑通过投影到加权快照矩阵的前 $r$ 个左奇异向量张成的空间上，构建一个 $r$ 阶的本征正交分解 (POD) 降阶模型 (ROM)。设 $\\varepsilon > 0$ 是在 $W_x$-范数下快照集上最坏情况相对投影误差的给定容差。具体来说，我们要求 ROM 阶数 $r$ 满足\n$$\n\\max_{1 \\leq j \\leq m} \\frac{\\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x}}{\\|q(t_j)\\|_{W_x}} \\leq \\varepsilon,\n$$\n其中 $\\Pi_r$ 表示在 $W_x$-内积下到 $r$ 维 POD 子空间的正交投影算子。假设 $m \\geq 1$ 且快照矩阵的秩至少为 $1$。\n\n此外，将此容差与麦克风处诱导声压预测误差的最坏情况上界联系起来。对于任意快照 $q(t_j)$，声压误差满足\n$$\n\\|H \\left(q(t_j) - \\Pi_r q(t_j)\\right)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x},\n$$\n其中 $W_x^{-1/2}$ 表示 $W_x$ 主平方根的逆，$\\|\\cdot\\|_{2}$ 对矩阵表示谱范数，对向量表示欧几里得范数。使用此关系式，生成一个关于 $\\varepsilon$、$H$、$W_x$ 和 $S$ 的函数，作为快照集上声压误差的最坏情况上界。\n\n您的任务是编写一个完整的、可运行的程序，针对指定的测试套件计算：\n- 保证快照集上的最坏情况相对投影误差在 $W_x$-范数下最多为 $\\varepsilon$ 的最小 POD ROM 阶数 $r$。\n- 相应的快照集上声压预测误差的最坏情况上界，以 $\\mathrm{Pa}$ 为单位表示。\n\n您必须使用以下具体的测试套件。在每种情况下，使用指定的 $W_x$、$H$、$S$ 和 $\\varepsilon$：\n- 测试用例1（理想情况）：\n  - $n = 5$, $m = 8$.\n  - $W_x = M$ 且\n    $$\n    M = \\begin{bmatrix}\n    2.0  0.1  0.0  0.0  0.0 \\\\\n    0.1  1.8  0.05  0.0  0.0 \\\\\n    0.0  0.05  1.5  0.1  0.0 \\\\\n    0.0  0.0  0.1  1.2  0.05 \\\\\n    0.0  0.0  0.0  0.05  1.0\n    \\end{bmatrix}.\n    $$\n  - $H$ 的单位为 $\\mathrm{Pa}/\\mathrm{m}$：\n    $$\n    H = \\begin{bmatrix}\n    100.0  -80.0  60.0  -40.0  20.0 \\\\\n    50.0  40.0  -30.0  20.0  -10.0\n    \\end{bmatrix}.\n    $$\n  - $S$ 的列向量 $s_j$ 由下式给出\n    $$\n    S = \\begin{bmatrix}\n    0.010  0.008  0.006  0.004  0.003  0.002  0.001  0.0005 \\\\\n    0.009  0.007  0.005  0.004  0.003  0.002  0.0015  0.0007 \\\\\n    -0.008  -0.006  -0.005  -0.003  -0.0025  -0.0015  -0.0010  -0.0005 \\\\\n    0.006  0.005  0.004  0.003  0.0020  0.0010  0.0008  0.0004 \\\\\n    -0.004  -0.003  -0.002  -0.0015  -0.0010  -0.0008  -0.0005  -0.0003\n    \\end{bmatrix}.\n    $$\n  - $\\varepsilon = 0.15$。\n\n- 测试用例2（紧容差边界，需要接近全阶）：\n  - 与测试用例1相同的 $W_x$、$H$ 和 $S$。\n  - $\\varepsilon = 0.000001$。\n\n- 测试用例3（宽容差边缘情况，强制使用最小阶数）：\n  - 与测试用例1相同的 $W_x$、$H$ 和 $S$。\n  - $\\varepsilon = 0.5$。\n\n算法要求：\n- 通过对 $W_x$ 进行 Cholesky 分解 $W_x = L^{\\mathsf{T}} L$（其中 $L$ 为上三角矩阵）来计算加权快照矩阵，然后形成 $Y = L S$。\n- 计算 $Y$ 的奇异值，并选择最小的 $r \\geq 1$ 使得相对尾部能量 $\\left(\\sum_{i=r+1}^{k} \\sigma_i^2\\right) / \\left(\\sum_{i=1}^{k} \\sigma_i^2\\right) \\leq \\varepsilon^2$，其中 $\\{\\sigma_i\\}_{i=1}^{k}$ 是 $Y$ 的奇异值，且 $k = \\min(n,m)$。\n- 通过构建 $T = H L^{-1}$ 并取 $T$ 的最大奇异值来计算算子范数 $\\|H W_x^{-1/2}\\|_{2}$。\n- 将快照集上声压误差的最坏情况上界计算为 $\\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x}$，并将此界表示为一个以 $\\mathrm{Pa}$ 为单位的浮点数。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果应为一个形如 $[r,\\mathrm{bound}]$ 的双元素列表，其中 $r$ 是一个整数，$\\mathrm{bound}$ 是计算出的以 $\\mathrm{Pa}$ 为单位、四舍五入到六位小数的最坏情况声压误差界。例如，输出格式应类似于 $[[r_1,b_1],[r_2,b_2],[r_3,b_3]]$。",
            "solution": "该问题提法恰当且科学上合理，基于线性代数、结构动力学和模型降阶的既定原理。所有必要的数据和条件均已提供。我现在将开始进行求解。\n\n目标是确定本征正交分解 (POD) 降阶模型 (ROM) 的最小阶数 $r$，并计算由此产生的声压误差的上界。分析在一个配备了加权内积的向量空间中进行，这对于能量范数具有物理意义的系统是典型的。\n\n首先，我们在加权内积 $\\langle u, v \\rangle_{W_x} = u^{\\mathsf{T}} W_x v$ 的背景下规范化 POD 过程，其诱导范数为 $\\|u\\|_{W_x} = \\sqrt{u^{\\mathsf{T}} W_x u}$。矩阵 $W_x = M$ 是对称正定的，这确保了这是一个有效的内积空间。POD 的目标是找到一个低维子空间，以最优方式捕获所提供的快照数据，这些数据包含在快照矩阵 $S \\in \\mathbb{R}^{n \\times m}$ 的列向量 $s_j = q(t_j)$ 中。\n\n寻找 POD 基的最优化问题通常使用奇异值分解 (SVD) 来解决。为了适应加权范数，我们引入坐标变换。问题指定使用权重矩阵的 Cholesky 分解，$W_x = L^{\\mathsf{T}} L$，其中 $L \\in \\mathbb{R}^{n \\times n}$ 是一个上三角矩阵。利用这个因子，向量 $s_j$ 的加权范数可以表示为变换后向量 $y_j$ 的标准欧几里得范数：\n$$\n\\|s_j\\|_{W_x}^2 = s_j^{\\mathsf{T}} W_x s_j = s_j^{\\mathsf{T}} (L^{\\mathsf{T}} L) s_j = (L s_j)^{\\mathsf{T}} (L s_j) = \\|L s_j\\|_2^2 = \\|y_j\\|_2^2\n$$\n其中 $y_j = L s_j$。此变换有效地对数据相对于权重矩阵 $W_x$ 进行了“白化”。我们将加权快照组装成一个矩阵 $Y = [y_1, y_2, \\ldots, y_m] = L S$。现在，快照 $S$ 在 $W_x$-范数下的 POD 问题等价于加权快照 $Y$ 在欧几里得范数下的标准 POD 问题。\n\n标准 POD 问题的解由快照矩阵的左奇异向量给出。设加权快照矩阵 $Y$ 的 SVD 为 $Y = U \\Sigma \\mathcal{V}^{\\mathsf{T}}$，其中 $U$ 的列是在变换后坐标系中的 POD 模态，而 $\\sigma_1 \\geq \\sigma_2 \\geq \\ldots \\geq \\sigma_k \\geq 0$ 是奇异值，其中 $k = \\min(n, m)$。快照的总能量，以聚合的 $W_x$-范数平方来衡量，与奇异值相关：\n$$\n\\sum_{j=1}^{m} \\|s_j\\|_{W_x}^2 = \\sum_{j=1}^{m} \\|y_j\\|_2^2 = \\|Y\\|_{\\mathrm{F}}^2 = \\sum_{i=1}^{k} \\sigma_i^2\n$$\n其中 $\\|\\cdot\\|_{\\mathrm{F}}$ 是弗罗贝尼乌斯范数。\n\n问题要求选择满足相对尾部能量条件的最小模型阶数 $r \\geq 1$。一个 $r$ 维 POD 模型捕获的能量是 $\\sum_{i=1}^{r} \\sigma_i^2$。残余能量，即模型未捕获的数据部分，是 $\\sum_{i=r+1}^{k} \\sigma_i^2$。指定的准则为：\n$$\n\\frac{\\sum_{i=r+1}^{k} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\leq \\varepsilon^2\n$$\n这等价于找到最小的整数 $r \\geq 1$，使得捕获的能量分数满足某个阈值：\n$$\n\\frac{\\sum_{i=1}^{r} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\geq 1 - \\varepsilon^2\n$$\n我们将计算 $Y$ 的奇异值，找到它们的平方 $\\sigma_i^2$，计算这些平方值的累积和，并确定满足此条件的最小 $r \\geq 1$。\n\n接下来，我们推导声压误差的上界。我们被给予了不等式：\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j - \\Pi_r s_j\\|_{W_x}\n$$\n其中 $\\Pi_r$ 是到 $r$ 维 POD 子空间的 $W_x$-正交投影算子。问题还为任意快照的最坏情况相对投影误差指定了一个容差 $\\varepsilon$：\n$$\n\\frac{\\|s_j - \\Pi_r s_j\\|_{W_x}}{\\|s_j\\|_{W_x}} \\leq \\varepsilon \\quad \\implies \\quad \\|s_j - \\Pi_r s_j\\|_{W_x} \\leq \\varepsilon \\|s_j\\|_{W_x}\n$$\n结合这两个不等式，可以得到单个快照 $s_j$ 的声压误差界：\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\left( \\varepsilon \\|s_j\\|_{W_x} \\right)\n$$\n为了找到整个快照集上的最坏情况上界，我们对所有 $j \\in \\{1, \\ldots, m\\}$ 取最大值：\n$$\n\\max_{1 \\leq j \\leq m} \\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\max_{1 \\leq j \\leq m} \\left( \\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j\\|_{W_x} \\right)\n$$\n由于 $\\varepsilon$ 和矩阵范数 $\\|H W_x^{-1/2}\\|_{2}$ 相对于快照索引 $j$ 是常数，我们可以将界的最终表达式写为：\n$$\n\\text{误差界} = \\varepsilon \\cdot \\|H W_x^{-1/2}\\|_{2} \\cdot \\left( \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x} \\right)\n$$\n计算步骤如下：\n1.  计算 $W_x$ 的上三角 Cholesky 因子 $L$，使得 $W_x = L^{\\mathsf{T}} L$。\n2.  形成加权快照矩阵 $Y = L S$。\n3.  计算 $Y$ 的奇异值 $\\sigma_i$。使用这些值找到满足能量准则的最小 ROM 阶数 $r \\geq 1$。\n4.  计算算子范数 $\\|H W_x^{-1/2}\\|_{2}$。根据问题描述，这通过计算矩阵 $T = H L^{-1}$ 的最大奇异值来实现，这与 $W_x^{-1/2} = L^{-1}$ 的认定是一致的。\n5.  确定快照的最大加权范数 $\\max_{j} \\|s_j\\|_{W_x}$，这等价于找到 $Y$ 的列向量的最大欧几里得范数，即 $\\max_{j} \\|y_j\\|_{2}$。\n6.  结合这些量来计算最终的声压误差界。\n\n将对每个指定的测试用例实施此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import cholesky, solve_triangular\n\ndef solve():\n    \"\"\"\n    Solves the model order reduction problem for the given test cases.\n    \"\"\"\n    \n    # Test Case 1 Data\n    W_x1 = np.array([\n        [2.0, 0.1, 0.0, 0.0, 0.0],\n        [0.1, 1.8, 0.05, 0.0, 0.0],\n        [0.0, 0.05, 1.5, 0.1, 0.0],\n        [0.0, 0.0, 0.1, 1.2, 0.05],\n        [0.0, 0.0, 0.0, 0.05, 1.0]\n    ])\n    \n    H1 = np.array([\n        [100.0, -80.0, 60.0, -40.0, 20.0],\n        [50.0, 40.0, -30.0, 20.0, -10.0]\n    ])\n    \n    S1 = np.array([\n        [0.010, 0.008, 0.006, 0.004, 0.003, 0.002, 0.001, 0.0005],\n        [0.009, 0.007, 0.005, 0.004, 0.003, 0.002, 0.0015, 0.0007],\n        [-0.008, -0.006, -0.005, -0.003, -0.0025, -0.0015, -0.0010, -0.0005],\n        [0.006, 0.005, 0.004, 0.003, 0.0020, 0.0010, 0.0008, 0.0004],\n        [-0.004, -0.003, -0.002, -0.0015, -0.0010, -0.0008, -0.0005, -0.0003]\n    ])\n\n    test_cases = [\n        (W_x1, H1, S1, 0.15),\n        (W_x1, H1, S1, 0.000001),\n        (W_x1, H1, S1, 0.5)\n    ]\n\n    results = []\n    \n    for W_x, H, S, epsilon in test_cases:\n        # Step 1: Cholesky factorization W_x = L^T L with L upper triangular\n        # scipy.linalg.cholesky returns lower triangular C where W_x = C @ C.T\n        # We need W_x = L.T @ L where L is upper. Let's find L such that W_x = L.T @ L.\n        # So, we can take Cholesky of W_x.T, which is just W_x since it's symmetric.\n        # This will give a lower triangular matrix, let's call it L_lower, s.t. W_x = L_lower @ L_lower.T\n        # The problem asks for W_x = L.T @ L with L being upper.\n        # If we take L = L_lower.T, then L is upper, and L.T = L_lower.\n        # So W_x = L.T @ L.T.T = L.T @ L. This is what we need.\n        # Scipy cholesky by default returns upper, so we can use that. L = cholesky(W_x, lower=False)\n        try:\n            L = cholesky(W_x, lower=False)\n        except np.linalg.LinAlgError:\n            results.append([\"Error\", \"Cholesky failed\"])\n            continue\n\n        # Step 2: Form the weighted snapshot matrix Y = L S\n        Y = L @ S\n\n        # Step 3: Compute SVD of Y and select ROM order r\n        sigma = np.linalg.svd(Y, compute_uv=False)\n        \n        sigma_sq = sigma**2\n        \n        total_energy = np.sum(sigma_sq)\n        \n        if total_energy  np.finfo(float).eps:\n             r = 1 \n        else:\n            cum_energy = np.cumsum(sigma_sq)\n            required_energy = (1.0 - epsilon**2) * total_energy\n            \n            candidate_indices = np.where(cum_energy >= required_energy)[0]\n            \n            if candidate_indices.size > 0:\n                r = candidate_indices[0] + 1\n            else:\n                r = len(sigma) \n        \n        r = max(1, r)\n\n        # Step 4: Compute the operator norm ||H W_x^{-1/2}||_2\n        # This is ||H L^{-1}||_2. We compute T = H @ L^{-1}.\n        # It's more stable to solve LX=H^T, then take X^T.\n        H_T = H.T\n        L_inv_H_T = solve_triangular(L, H_T, lower=False)\n        T = L_inv_H_T.T\n        \n        norm_op = np.linalg.svd(T, compute_uv=False)[0]\n        \n        # Step 5: Compute the maximum weighted norm of the snapshots\n        max_s_norm = np.max(np.linalg.norm(Y, axis=0))\n\n        # Step 6: Compute the worst-case pressure error bound\n        pressure_error_bound = epsilon * norm_op * max_s_norm\n        \n        results.append([int(r), round(pressure_error_bound, 6)])\n\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个降阶模型若不经严格验证，其预测结果的可靠性将无从谈起。最后一个练习旨在解决模型验证这一关键步骤，它要求你为参数化的降阶模型设计一个全面的验证方案。此练习将挑战你思考如何评估模型在不同操作条件下的泛化能力，如何选取物理上有意义的观测量进行比较，以及如何运用恰当的误差范数进行量化评估，从而让你掌握计算工程领域中严谨的科学实践准则。",
            "id": "4129280",
            "problem": "一个通过有限元法 (FEM) 离散化的耦合振动声学系统，可以在频域中建模为一个线性时不变 (LTI) 二阶系统。设结构位移向量为 $\\,\\mathbf{u}\\in\\mathbb{R}^{n_s}\\,$，声压向量为 $\\,\\mathbf{p}\\in\\mathbb{R}^{n_a}\\,$。对于输入为 $\\,u(\\omega)\\,$ 和输出为 $\\,y(\\omega)\\,$ 的单输入单输出设置，其全阶模型 (FOM) 的频率响应公式可以写为\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega),\n\\qquad\ny(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega),\n$$\n其中 $\\,\\mathbf{M}_\\star\\,$, $\\,\\mathbf{C}_\\star\\,$ 和 $\\,\\mathbf{K}_\\star\\,$ 分别表示质量、阻尼和刚度矩阵，$\\,\\mathbf{B}_\\star\\,$ 是输入分布向量，$\\,\\mathbf{L}_\\star\\,$ 将状态映射到可测量的观测值（例如，传感器处的结构速度或声压）。降阶模型 (ROM) 是通过投影 $\\,\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)\\,$ 构建的，其中 $\\,\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}\\,$ 是一个低维状态，$\\,\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}\\,$ 是基。这会产生投影算子和相应的降阶传递函数 $\\,G_{\\mathrm{ROM}}(\\omega)\\,$，而 FOM 导出 $\\,G_{\\mathrm{FOM}}(\\omega)\\,$。\n\n运行场景由 $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}\\,$ 参数化，这些参数编码了例如边界阻抗、影响声速 $\\,c(\\boldsymbol{\\mu})\\,$ 的流体特性、阻尼比和激励谱。一个科学上合理的 ROM 验证协议应当评估其在不同 $\\,\\boldsymbol{\\mu}\\,$ 上的泛化能力、关键可观测量的保真度，并报告能够反映在与应用相关的频带 $\\,\\Omega=[\\omega_{\\min},\\omega_{\\max}]\\,$ 内振动声学性能的误差范数。\n\n从上述控制方程和 LTI 系统的输入-输出传递函数定义出发，选择下面一项科学上合理、并且实施了跨运行场景的交叉验证、关键可观测量的比较以及报告基于振动声学第一性原理的误差范数的协议。\n\nA. 将场景参数集 $\\,\\mathcal{D}\\,$ 划分为不相交的训练子集 $\\,\\mathcal{D}_{\\mathrm{train}}\\,$ 和测试子集 $\\,\\mathcal{D}_{\\mathrm{test}}\\,$，并通过对 $\\,\\mathcal{D}\\,$ 本身进行折叠（即，折划分的是场景，而不是时间或频率样本）来执行 $\\,k\\,$-折交叉验证。对于每个 $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}_{\\mathrm{test}}\\,$，在 $\\,\\omega\\in\\Omega\\,$ 上计算 $\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\omega)\\,$ 和 $\\,G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\omega)\\,$，并比较关键可观测量 $\\,y(\\omega)\\,$，如麦克风处的声压、加速度计处的结构速度和辐射声功率。为每个 $\\,\\boldsymbol{\\mu}\\,$ 报告相对输出误差\n$$\n\\varepsilon_{L^2}(\\boldsymbol{\\mu})=\\frac{\\left\\|y_{\\mathrm{ROM}}(\\cdot;\\boldsymbol{\\mu})-y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}}{\\left\\|y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}},\n$$\n$\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\cdot)-G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\cdot)\\,$ 的 $\\,H_2\\,$ 和 $\\,H_\\infty\\,$ 范数，传感器阵列上的最大声压级差异，以及主导耦合模态的模态置信准则 (MAC)。通过检查 ROM 的正实性或耗散性证书来验证稳定性和无源性的保持。通过中位数、四分位距和 $\\,95\\%\\,$ 百分位数统计来总结 $\\,\\mathcal{D}_{\\mathrm{test}}\\,$ 上的误差，并报告每个场景的最坏情况频率分辨误差 $\\,\\max_{\\omega\\in\\Omega}\\left|y_{\\mathrm{ROM}}(\\omega)-y_{\\mathrm{FOM}}(\\omega)\\right|\\,$。\n\nB. 通过将单个运行场景的时域样本随机拆分为折来进行 $\\,k\\,$-折交叉验证。仅比较内部状态向量 $\\,\\mathbf{q}\\,$ 和 $\\,\\mathbf{z}\\,$，并使用在采样时间上的均方状态差 $\\,\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{z}_i-\\mathbf{V}\\mathbf{q}_i\\right\\|_2^2\\,$。仅报告平均状态误差，不进行可观测量比较，并且不区分训练和测试场景，因为状态空间投影已经最小化了状态残差。\n\nC. 通过在 ROM 基预测的一小组共振频率上检查 ROM 来进行验证，跳过非共振频带。允许将训练场景包含在验证集中以增加样本量。报告在这些共振频率上的内部状态误差的 $\\,L^\\infty\\,$ 范数 $\\,\\left\\|\\mathbf{z}-\\mathbf{V}\\mathbf{q}\\right\\|_\\infty\\,$，并事后调整 ROM 阻尼参数，直到输出曲线在这些频带中视觉上匹配。\n\nD. 跨场景执行交叉验证，但仅评估一个可观测量：一个麦克风位置的声压。使用平均绝对误差 $\\,\\frac{1}{|\\Omega|}\\int_{\\Omega}\\left|p_{\\mathrm{ROM}}(\\omega)-p_{\\mathrm{FOM}}(\\omega)\\right|\\,\\mathrm{d}\\omega\\,$ 作为唯一度量。不包括结构可观测量或能量/功率度量，并且只报告所有场景的平均误差，不提供分布统计或最坏情况的频率分辨误差。\n\nE. 使用 $\\,\\boldsymbol{\\mu}\\,$ 的蒙特卡洛采样来构建验证集，但用一个粗化模型替换 FOM 以降低计算成本。将 ROM 输出上采样到粗化的 FOM 网格上进行比较，并在时域中比较短时间窗口的脉冲响应，而不映射到频率。仅报告单个激励的 $\\,L^2\\,$ 时域误差，并且不考虑在 $\\,\\Omega\\,$ 上的 $\\,H_\\infty\\,$ 类型的最坏情况行为。",
            "solution": "在尝试任何解决方案之前，需要对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统类型**：一个通过有限元法 (FEM) 离散化的耦合振动声学系统。\n- **模型类型**：频域中的线性时不变 (LTI) 二阶系统。\n- **状态变量**：结构位移向量 $\\mathbf{u}\\in\\mathbb{R}^{n_s}$ 和声压向量 $\\mathbf{p}\\in\\mathbb{R}^{n_a}$。\n- **全阶模型 (FOM) 方程**：\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega)\n$$\n- **输出方程**：$y(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega)$。\n- **系统矩阵**：结构 ($\\star=s$) 和声学 ($\\star=a$) 域的质量 ($\\mathbf{M}_\\star$)、阻尼 ($\\mathbf{C}_\\star$) 和刚度 ($\\mathbf{K}_\\star$) 矩阵。$\\mathbf{K}_{sa}$ 和 $\\mathbf{K}_{as}$ 是耦合矩阵。\n- **输入/输出向量**：$\\mathbf{B}_\\star$ 是单个输入 $u(\\omega)$ 的输入分布向量。$\\mathbf{L}_\\star$ 是单个输出 $y(\\omega)$ 的输出向量。\n- **降阶模型 (ROM)**：通过使用基 $\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}$ 的投影构建，其中 $\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)$ 且 $\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}$，$r \\ll n_s+n_a$。\n- **传递函数**：$G_{\\mathrm{FOM}}(\\omega)$ 和 $G_{\\mathrm{ROM}}(\\omega)$ 分别是相应模型从输入 $u(\\omega)$ 到输出 $y(\\omega)$ 的传递函数。\n- **参数化**：系统行为依赖于参数 $\\boldsymbol{\\mu}\\in\\mathcal{D}$，这些参数影响声速 $c(\\boldsymbol{\\mu})$、阻尼等量。\n- **验证目标**：为 ROM 选择一个科学上合理的验证协议，该协议能评估跨 $\\boldsymbol{\\mu}$ 的泛化能力、关键可观测量的保真度，并报告在频带 $\\Omega=[\\omega_{\\min},\\omega_{\\max}]$ 上的适当误差范数。\n\n### 步骤2：使用提取的已知条件进行验证\n审查问题陈述的有效性。\n- **科学基础**：该公式是一个频域、有限元离散化、耦合振动声学系统的标准状态空间表示。矩阵（$\\mathbf{M}$, $\\mathbf{C}$, $\\mathbf{K}$）、耦合项（$\\mathbf{K}_{sa}$, $\\mathbf{K}_{as}$）、输入/输出结构，以及基于投影的模型降阶方法都在计算力学和声学中得到了牢固的确立。用于验证所提到的概念（交叉验证、误差范数如 $L^2$, $H_2$, $H_\\infty$、MAC、稳定性、无源性）是 MOR 和控制理论领域的标准和核心概念。该问题是科学上合理的。\n- **适定性**：问题要求从给定列表中确定最科学严谨的验证协议。这是一个概念性问题，基于科学和工程验证的既定原则，它有一个明确的答案。它在计算上不是不适定的。\n- **客观性**：语言精确客观，描述了一个标准的工程问题，没有主观或带偏见的措辞。\n\n未发现任何缺陷。该问题没有违反任何基本原则，对于手头的任务而言不是不完整或矛盾的，并且代表了计算工程中一个现实的、非平凡的问题。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。现在将通过对照参数化系统模型验证的第一性原理评估每个提议的协议来推导解决方案。\n\n### 解决方案推导\n一个科学上合理的参数化降阶模型 (pROM) 验证协议必须满足几个关键标准：\n1.  **泛化能力评估**：pROM 的主要目的是准确预测在其构建过程中未使用的参数值 $\\boldsymbol{\\mu}$ 的系统行为。这需要将参数集 $\\mathcal{D}$ 严格划分为训练集 $\\mathcal{D}_{\\mathrm{train}}$（用于构建 ROM）和测试集 $\\mathcal{D}_{\\mathrm{test}}$（用于验证）。\n2.  **物理可观测量的评估**：验证应侧重于具有物理和工程意义的量，即系统的输出 $y(\\omega)$（例如，麦克风处的压力，加速度计处的速度）。ROM 内部的非物理状态（例如 $\\mathbf{q}$）的误差是次要的。\n3.  **全面的误差量化**：必须在整个操作域（即感兴趣的频带 $\\Omega$）上测量误差。适当的度量包括用于平均误差的积分范数（如 $L^2$ 范数）和用于最坏情况误差的上确界范数（如 $H_\\infty$ 范数），这对于性能保证和稳定性分析至关重要。\n4.  **物理属性的保持**：应检查 ROM 以确保其保留 FOM 的基本物理属性，例如稳定性（所有系统极点的实部为负）和无源性（系统不产生能量）。\n5.  **稳健的统计报告**：在测试参数集 $\\mathcal{D}_{\\mathrm{test}}$ 上进行验证时，仅报告平均误差是不够的。需要一个包括中位数、四分位数和高百分位数或最坏情况误差的统计摘要来表征 ROM 的可靠性和稳健性。\n\n以这些原则为基准，对每个选项进行分析。\n\n### 逐项分析\n\n**A. 将场景参数集 $\\ldots$**\n该协议遵守了严格验证的所有原则。\n- 它通过将参数集 $\\mathcal{D}$ 划分为不相交的训练集和测试集 ($\\mathcal{D}_{\\mathrm{train}}$, $\\mathcal{D}_{\\mathrm{test}}$) 来正确实施交叉验证，这是评估跨运行场景泛化能力的正确方法。\n- 它评估了物理上有意义的输出 ($y(\\omega)$) 和具体的工程量，如声压、结构速度和辐射功率。\n- 它采用了一套基于系统理论和声学的全面误差度量：相对输出 $L^2$ 误差、误差系统的 $H_2$ 和 $H_\\infty$ 范数，以及特定领域的度量，如声压级 (SPL) 差异和模态置信准则 (MAC)。\n- 它明确包括了对基本系统属性（如稳定性和无源性）保持情况的检查。\n- 它建议使用中位数、四分位距 (IQR) 和百分位数对测试集上的误差进行稳健的统计报告，此外还有最坏情况的频率分辨误差。\n该协议是彻底的、多方面的并且是科学上合理的。\n**结论：正确**\n\n**B. 通过将单个运行场景的时域样本随机拆分为折来进行 $\\,k\\,$-折交叉验证 $\\ldots$**\n该协议存在根本性缺陷。\n- 它错误地应用了交叉验证。拆分单个场景 ($\\boldsymbol{\\mu}$) 的时间序列数据无法测试跨不同场景的泛化能力。问题是在频域中提出的，这使得时域样本拆分更加可疑。\n- 它关注内部状态误差 ($\\|\\mathbf{z}_i - \\mathbf{V}\\mathbf{q}_i\\|_2^2$)，这是一个投影误差，而不是物理上有意义的输出误差。\n- 它明确拒绝区分训练和测试场景，这是验证方法论中的一个致命错误。其提供的理由毫无意义。\n**结论：不正确**\n\n**C. 通过在 ROM 基预测的一小组共振频率上检查 ROM 来进行验证 $\\ldots$**\n该协议在方法上是不合理的。\n- 仅在共振频率上进行验证，对 ROM 准确性的了解非常不完整。非共振和反共振行为对系统的动态响应同样重要。\n- 它允许将训练数据包含在验证集中，这使得任何关于泛化能力的声明都无效。\n- 它提议事后“调整”模型参数以实现“视觉匹配”，这将验证与调整混为一谈，并用主观评估取代了客观指标。这使测试无效。\n**结论：不正确**\n\n**D. 跨场景执行交叉验证，但仅评估一个可观测量 $\\ldots$**\n该协议过于简单化和不完整。\n- 虽然它正确地跨场景执行交叉验证，但它将评估限制在单个声压可观测量上。这忽略了耦合的结构动力学，并且没有提供关于其他重要量（如结构速度或基于能量的全局度量，例如辐射功率）的信息。\n- 使用单一误差度量（平均绝对误差）是不够的。它无法捕捉最坏情况的频率行为（与 $H_\\infty$ 相关）或总能量。\n- 仅报告跨场景的平均误差无法表征误差分布，并隐藏了在最坏情况场景中可能出现的差劲性能。\n**结论：不正确**\n\n**E. 使用 $\\,\\boldsymbol{\\mu}\\,$ 的蒙特卡洛采样来构建验证集，但用一个粗化模型替换 FOM $\\ldots$**\n该协议包含一个致命缺陷。\n- 它用一个粗化模型而不是原始的高保真 FOM 来验证 ROM。这不是对 ROM 与基准真相的验证。这是两个不同近似值（$\\text{ROM vs. 粗化 FOM}$）的比较，如果不量化粗化模型本身的误差，所得到的误差是没有意义的。验证的根本基础是与最准确的可用模型（即 FOM）进行比较。\n- 它将评估限制在时域脉冲响应和单个 $L^2$ 误差度量上，忽略了模型定义所在的至关重要的频域视角（特别是最坏情况的 $H_\\infty$ 误差）。\n**结论：不正确**\n\n结论：选项A是唯一描述了一个全面、多方面、科学严谨的验证协议的选项，该协议正确地解决了泛化能力、物理可观测量、适当的误差度量、系统属性和稳健的统计分析问题。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}