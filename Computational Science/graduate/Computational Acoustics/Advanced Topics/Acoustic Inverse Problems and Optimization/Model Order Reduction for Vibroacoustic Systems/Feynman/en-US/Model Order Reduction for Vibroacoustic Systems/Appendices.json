{
    "hands_on_practices": [
        {
            "introduction": "Before we can reduce a model, we must first understand the behavior of the full system. This foundational exercise guides you through analyzing a simplified, two-degree-of-freedom vibroacoustic system, which serves as an intuitive analogue for large-scale models. By deriving the frequency response function from first principles, you will forge a direct link between the physical parameters—mass, stiffness, and coupling—and the observable resonant peaks, a key phenomenon that any effective reduced-order model must capture .",
            "id": "4129351",
            "problem": "A single-input single-output (SISO) reduced-order vibroacoustic model is obtained by modal truncation that retains one dominant structural mode and one dominant acoustic cavity mode. The retained generalized structural displacement is $q_{s}(t)$ with modal mass $m_{s}$, viscous damping $c_{s}$, and stiffness $k_{s}$. The retained generalized acoustic modal coordinate is $q_{a}(t)$ with modal mass $m_{a}$, viscous damping $c_{a}$, and stiffness $k_{a}$. The structural and acoustic subsystems are coupled by a symmetric coupling coefficient $\\kappa$ arising from fluid-structure interaction work. An external generalized force $u(t)$ acts on the structural mode. The measured output is the acoustic modal amplitude $y(t) = q_{a}(t)$. The governing equations in modal coordinates, derived from Newton’s second law for the structure and the linear acoustic wave equation for the cavity in modal form, are\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t), \\\\\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0.\n$$\nIntroduce the first-order state $x(t) = \\big(q_{s}(t),\\, q_{a}(t),\\, \\dot{q}_{s}(t),\\, \\dot{q}_{a}(t)\\big)^{\\top}$ and write the system in the standard state-space form $E\\,\\dot{x}(t) = A\\,x(t) + B\\,u(t)$, $y(t) = C\\,x(t) + D\\,u(t)$ with appropriate constant matrices $E$, $A$, $B$, $C$, $D$.\n\nStarting from the transfer function definition for a linear time-invariant descriptor system $G(s) = C\\,(sE - A)^{-1}B + D$, do the following:\n- Derive a closed-form expression for the frequency response $G(i\\omega)$ of this coupled vibroacoustic system as a function of the physical parameters $\\{m_{s},c_{s},k_{s},m_{a},c_{a},k_{a},\\kappa\\}$ and the angular frequency $\\omega$.\n- Using only fundamental principles about linear systems and poles of transfer functions, identify how peaks in the magnitude $|G(i\\omega)|$ relate to the system poles for light damping.\n\nFinally, consider the undamped case $c_{s} = 0$ and $c_{a} = 0$, and define the uncoupled natural frequencies $\\omega_{s} = \\sqrt{k_{s}/m_{s}}$ and $\\omega_{a} = \\sqrt{k_{a}/m_{a}}$, and the coupling-frequency parameter $\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$. Compute the lower coupled resonance frequency $\\omega_{-}$ (in radians per second) at which $|G(i\\omega)|$ exhibits a peak under light damping by taking the undamped coupled-mode frequency as the leading-order approximation. Provide your final answer as a single analytic expression in terms of $\\omega_{s}$, $\\omega_{a}$, and $\\beta$. Express the frequency in radians per second. Do not include units in your final boxed answer.",
            "solution": "The problem asks for the derivation of the frequency response function for a two-degree-of-freedom vibroacoustic system, an explanation of its resonant behavior, and the calculation of the lower coupled resonance frequency in the undamped case. The validation of the problem statement has confirmed its scientific soundness and well-posed nature.\n\nFirst, we derive the transfer function $G(s)$ from the input force $u(t)$ to the output acoustic modal amplitude $y(t) = q_a(t)$. The governing equations are:\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t)\n$$\n$$\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0\n$$\nWe apply the Laplace transform to these equations, assuming zero initial conditions. Let $Q_s(s) = \\mathcal{L}\\{q_s(t)\\}$, $Q_a(s) = \\mathcal{L}\\{q_a(t)\\}$, and $U(s) = \\mathcal{L}\\{u(t)\\}$. The transformed equations are:\n$$\n(m_{s}s^2 + c_{s}s + k_{s})Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n(m_{a}s^2 + c_{a}s + k_{a})Q_a(s) + \\kappa Q_s(s) = 0\n$$\nTo simplify the notation, we define the uncoupled modal impedances as $Z_s(s) = m_{s}s^2 + c_{s}s + k_{s}$ and $Z_a(s) = m_{a}s^2 + c_{a}s + k_{a}$. The system of equations becomes:\n$$\nZ_s(s)Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\kappa Q_s(s) + Z_a(s)Q_a(s) = 0\n$$\nThe output is $y(t) = q_a(t)$, so the output in the Laplace domain is $Y(s) = Q_a(s)$. The transfer function is $G(s) = Y(s)/U(s) = Q_a(s)/U(s)$. We solve the system for $Q_a(s)$. From the second equation, we express $Q_s(s)$ in terms of $Q_a(s)$:\n$$\nQ_s(s) = -\\frac{Z_a(s)}{\\kappa}Q_a(s)\n$$\nSubstituting this into the first equation:\n$$\nZ_s(s)\\left(-\\frac{Z_a(s)}{\\kappa}Q_a(s)\\right) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\left(-\\frac{Z_s(s)Z_a(s)}{\\kappa} + \\kappa\\right)Q_a(s) = U(s)\n$$\n$$\n\\frac{\\kappa^2 - Z_s(s)Z_a(s)}{\\kappa}Q_a(s) = U(s)\n$$\nThe transfer function $G(s)$ is therefore:\n$$\nG(s) = \\frac{Q_a(s)}{U(s)} = \\frac{\\kappa}{\\kappa^2 - Z_s(s)Z_a(s)}\n$$\nSubstituting back the expressions for $Z_s(s)$ and $Z_a(s)$:\n$$\nG(s) = \\frac{\\kappa}{\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a})}\n$$\nThe frequency response function $G(i\\omega)$ is obtained by substituting $s = i\\omega$, where $\\omega$ is the angular frequency.\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (m_{s}(i\\omega)^2 + c_{s}(i\\omega) + k_{s})(m_{a}(i\\omega)^2 + c_{a}(i\\omega) + k_{a})}\n$$\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (-m_{s}\\omega^2 + ic_{s}\\omega + k_{s})(-m_{a}\\omega^2 + ic_{a}\\omega + k_{a})}\n$$\nRearranging the terms yields the final expression for the frequency response:\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - ((k_{s} - m_{s}\\omega^2) + ic_{s}\\omega)((k_{a} - m_{a}\\omega^2) + ic_{a}\\omega)}\n$$\n\nNext, we address the relationship between peaks in the magnitude $|G(i\\omega)|$ and the system poles. The poles of the transfer function $G(s)$ are the roots of the characteristic equation, obtained by setting the denominator to zero:\n$$\n\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a}) = 0\n$$\nFor a stable system with damping ($c_s > 0, c_a > 0$), the poles are complex conjugate pairs $p_k = \\sigma_k \\pm i\\omega_{d,k}$ with negative real parts $\\sigma_k  0$. The magnitude of the frequency response $|G(i\\omega)| = |\\kappa| / |\\text{denominator}(i\\omega)|$ will exhibit a peak (a resonance) when the magnitude of the denominator is at a minimum. For a pole $p_k$ that is close to the imaginary axis (light damping, meaning $|\\sigma_k|$ is small), the denominator function evaluated at $s=i\\omega$ will have a small magnitude when $\\omega$ is close to the pole's imaginary part, $\\omega_{d,k}$. Thus, for light damping, the peaks in $|G(i\\omega)|$ occur at frequencies $\\omega$ that are approximately equal to the imaginary parts of the system poles that are close to the imaginary axis.\n\nFinally, we consider the undamped case where $c_{s} = 0$ and $c_{a} = 0$. In this case, the system poles lie on the imaginary axis, $s = \\pm i\\omega$, and correspond to the coupled natural frequencies. The problem asks for the lower of these frequencies, which corresponds to a resonance peak. We find these by solving the characteristic equation for $\\omega$:\n$$\n\\kappa^2 - (m_{s}(i\\omega)^2 + k_{s})(m_{a}(i\\omega)^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (-m_{s}\\omega^2 + k_{s})(-m_{a}\\omega^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (k_{s} - m_{s}\\omega^2)(k_{a} - m_{a}\\omega^2) = 0\n$$\nWe introduce the uncoupled natural frequencies $\\omega_{s} = \\sqrt{k_{s}/m_{s}}$ and $\\omega_{a} = \\sqrt{k_{a}/m_{a}}$, which imply $k_{s} = m_{s}\\omega_{s}^2$ and $k_{a} = m_{a}\\omega_{a}^2$. Substituting these into the equation gives:\n$$\n\\kappa^2 - (m_{s}\\omega_{s}^2 - m_{s}\\omega^2)(m_{a}\\omega_{a}^2 - m_{a}\\omega^2) = 0\n$$\n$$\n\\kappa^2 - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\nUsing the coupling-frequency parameter definition $\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$, we have $\\kappa^2 = \\beta^2 m_{s}m_{a}$. The equation becomes:\n$$\n\\beta^2 m_{s}m_{a} - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\nDividing by $m_s m_a$ (which are non-zero):\n$$\n\\beta^2 - (\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\nLet's define a new variable $X = \\omega^2$. The equation is a quadratic equation in $X$:\n$$\n\\beta^2 - (\\omega_{s}^2\\omega_{a}^2 - (\\omega_{s}^2+\\omega_{a}^2)X + X^2) = 0\n$$\n$$\nX^2 - (\\omega_{s}^2 + \\omega_{a}^2)X + (\\omega_{s}^2\\omega_{a}^2 - \\beta^2) = 0\n$$\nWe solve for $X$ using the quadratic formula:\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(-(\\omega_{s}^2 + \\omega_{a}^2))^2 - 4(1)(\\omega_{s}^2\\omega_{a}^2 - \\beta^2)}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^4 + 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4) - 4\\omega_{s}^2\\omega_{a}^2 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{\\omega_{s}^4 - 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2}}{2}\n$$\nThe two solutions for $\\omega^2$ are $\\omega^2_+$ and $\\omega^2_-$. The lower coupled resonance frequency $\\omega_-$ corresponds to the solution for $\\omega^2$ with the minus sign, which we denote $\\omega_-^2$.\n$$\n\\omega_-^2 = \\frac{1}{2} \\left[ (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right]\n$$\nTaking the square root gives the lower coupled frequency $\\omega_{-}$:\n$$\n\\omega_{-} = \\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right)}\n$$\nThis is the final analytical expression for the lower coupled resonance frequency.",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^{2} + \\omega_{a}^{2}) - \\sqrt{(\\omega_{s}^{2} - \\omega_{a}^{2})^{2} + 4\\beta^{2}} \\right)}}\n$$"
        },
        {
            "introduction": "With a grasp of full-order dynamics, we now turn to the practical task of model reduction. This hands-on coding exercise challenges you to implement Proper Orthogonal Decomposition (POD), a cornerstone data-driven technique for creating efficient ROMs from simulation snapshots. You will work with a weighted norm that represents system energy and, most importantly, translate an abstract mathematical projection error, $\\varepsilon$, into a tangible bound on the acoustic pressure prediction error, demonstrating the direct engineering relevance of MOR .",
            "id": "4129346",
            "problem": "Consider a linear vibroacoustic system obtained from spatial discretization of the coupled structural-acoustic equations. The structural dynamics are represented in second-order form by $M \\ddot{q}(t) + C \\dot{q}(t) + K q(t) = f(t)$, where $M \\in \\mathbb{R}^{n \\times n}$ is the symmetric positive definite mass matrix, $C \\in \\mathbb{R}^{n \\times n}$ is the damping matrix, $K \\in \\mathbb{R}^{n \\times n}$ is the stiffness matrix, $q(t) \\in \\mathbb{R}^{n}$ is the displacement vector, and $f(t) \\in \\mathbb{R}^{n}$ is the external force. Let $H \\in \\mathbb{R}^{p \\times n}$ be a linear observation operator that maps structural displacement to acoustic pressure at $p$ microphones through a linearized coupling model, so that the predicted acoustic pressure vector is $p(t) = H q(t)$.\n\nAssume that $C$ and $K$ are such that the system is stable and the primary interest is in approximating the displacement $q(t)$ in a weighted norm induced by $M$. Define the symmetric positive definite weighting matrix $W_x = M$, and for any vector $x \\in \\mathbb{R}^{n}$ define the weighted norm $\\|x\\|_{W_x} = \\sqrt{x^{\\mathsf{T}} W_x x}$. The acoustic pressure is measured in $\\mathrm{Pa}$ and is taken in the Euclidean norm $\\|p\\|_{2}$.\n\nGiven a snapshot matrix $S \\in \\mathbb{R}^{n \\times m}$ collecting $m$ state snapshots $q(t_j)$ as columns, consider constructing a Proper Orthogonal Decomposition (POD) reduced-order model (ROM) of order $r$ by projecting onto the span of the first $r$ left singular vectors of the weighted snapshot matrix. Let $\\varepsilon  0$ be a prescribed tolerance for the worst-case relative projection error over the snapshot set in the $W_x$-norm. Specifically, we require that the ROM order $r$ satisfy\n$$\n\\max_{1 \\leq j \\leq m} \\frac{\\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x}}{\\|q(t_j)\\|_{W_x}} \\leq \\varepsilon,\n$$\nwhere $\\Pi_r$ denotes the orthogonal projector onto the $r$-dimensional POD subspace with respect to the $W_x$-inner product. Assume $m \\geq 1$ and that the snapshot matrix has rank at least $1$.\n\nFurther, relate this tolerance to a worst-case bound on the induced acoustic pressure prediction error at the microphones. For any snapshot $q(t_j)$, the pressure error satisfies\n$$\n\\|H \\left(q(t_j) - \\Pi_r q(t_j)\\right)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x},\n$$\nwhere $W_x^{-1/2}$ denotes the inverse of the principal square root of $W_x$, and $\\|\\cdot\\|_{2}$ denotes the spectral norm for matrices and the Euclidean norm for vectors. Use this to produce a worst-case upper bound on the pressure error over the snapshot set as a function of $\\varepsilon$, $H$, $W_x$, and $S$.\n\nYour task is to write a complete, runnable program that, for a specified test suite, computes:\n- The minimal POD ROM order $r$ that guarantees the worst-case relative projection error over the snapshot set is at most $\\varepsilon$ in the $W_x$-norm.\n- The corresponding worst-case upper bound on the acoustic pressure prediction error over the snapshot set, expressed in $\\mathrm{Pa}$.\n\nYou must work with the following concrete test suite. In each case, use the specified $W_x$, $H$, $S$, and $\\varepsilon$:\n- Test Case $1$ (happy path):\n  - $n = 5$, $m = 8$.\n  - $W_x = M$ with\n    $$\n    M = \\begin{bmatrix}\n    2.0  0.1  0.0  0.0  0.0 \\\\\n    0.1  1.8  0.05  0.0  0.0 \\\\\n    0.0  0.05  1.5  0.1  0.0 \\\\\n    0.0  0.0  0.1  1.2  0.05 \\\\\n    0.0  0.0  0.0  0.05  1.0\n    \\end{bmatrix}.\n    $$\n  - $H$ with units $\\mathrm{Pa}/\\mathrm{m}$:\n    $$\n    H = \\begin{bmatrix}\n    100.0  -80.0  60.0  -40.0  20.0 \\\\\n    50.0  40.0  -30.0  20.0  -10.0\n    \\end{bmatrix}.\n    $$\n  - $S$ with columns $s_j$ given by\n    $$\n    S = \\begin{bmatrix}\n    0.010  0.008  0.006  0.004  0.003  0.002  0.001  0.0005 \\\\\n    0.009  0.007  0.005  0.004  0.003  0.002  0.0015  0.0007 \\\\\n    -0.008  -0.006  -0.005  -0.003  -0.0025  -0.0015  -0.0010  -0.0005 \\\\\n    0.006  0.005  0.004  0.003  0.0020  0.0010  0.0008  0.0004 \\\\\n    -0.004  -0.003  -0.002  -0.0015  -0.0010  -0.0008  -0.0005  -0.0003\n    \\end{bmatrix}.\n    $$\n  - $\\varepsilon = 0.15$.\n\n- Test Case $2$ (tight tolerance boundary requiring near-full order):\n  - Same $W_x$, $H$, and $S$ as Test Case $1$.\n  - $\\varepsilon = 0.000001$.\n\n- Test Case $3$ (loose tolerance edge case with minimum enforced order):\n  - Same $W_x$, $H$, and $S$ as Test Case $1$.\n  - $\\varepsilon = 0.5$.\n\nAlgorithmic requirements:\n- Compute the weighted snapshot matrix by factoring $W_x$ using a Cholesky factorization $W_x = L^{\\mathsf{T}} L$ with $L$ upper triangular, then forming $Y = L S$.\n- Compute the singular values of $Y$ and select the smallest $r \\geq 1$ such that the relative tail energy $\\left(\\sum_{i=r+1}^{k} \\sigma_i^2\\right) / \\left(\\sum_{i=1}^{k} \\sigma_i^2\\right) \\leq \\varepsilon^2$, where $\\{\\sigma_i\\}_{i=1}^{k}$ are the singular values of $Y$ and $k = \\min(n,m)$.\n- Compute the operator norm $\\|H W_x^{-1/2}\\|_{2}$ by forming $T = H L^{-1}$ and taking the largest singular value of $T$.\n- Compute the worst-case bound on the acoustic pressure error over the snapshot set as $\\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x}$, and express this bound in $\\mathrm{Pa}$ as a floating-point number.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result should be a two-element list of the form $[r,\\mathrm{bound}]$, where $r$ is an integer and $\\mathrm{bound}$ is the computed worst-case pressure error bound in $\\mathrm{Pa}$ rounded to six decimal places. For example, the output format should be like $[[r_1,b_1],[r_2,b_2],[r_3,b_3]]$.",
            "solution": "The problem is well-posed and scientifically sound, resting on established principles of linear algebra, structural dynamics, and model order reduction. All necessary data and conditions are provided. I will now proceed with the solution.\n\nThe objective is to determine the minimal order $r$ for a Proper Orthogonal Decomposition (POD) reduced-order model (ROM) and to compute an upper bound on the resulting acoustic pressure error. The analysis is performed in a vector space equipped with a weighted inner product, which is typical for systems where an energy norm is physically meaningful.\n\nFirst, we formalize the POD procedure in the context of the weighted inner product $\\langle u, v \\rangle_{W_x} = u^{\\mathsf{T}} W_x v$, with the induced norm $\\|u\\|_{W_x} = \\sqrt{u^{\\mathsf{T}} W_x u}$. The matrix $W_x = M$ is symmetric and positive definite, ensuring this is a valid inner product space. The goal of POD is to find a low-dimensional subspace that optimally captures the provided snapshot data, contained in the columns $s_j = q(t_j)$ of the snapshot matrix $S \\in \\mathbb{R}^{n \\times m}$.\n\nThe optimization problem for finding the POD basis is typically solved using the Singular Value Decomposition (SVD). To accommodate the weighted norm, we introduce a change of coordinates. The problem specifies using a Cholesky factorization of the weighting matrix, $W_x = L^{\\mathsf{T}} L$, where $L \\in \\mathbb{R}^{n \\times n}$ is an upper triangular matrix. With this factor, the weighted norm of a vector $s_j$ can be expressed as a standard Euclidean norm of a transformed vector $y_j$:\n$$\n\\|s_j\\|_{W_x}^2 = s_j^{\\mathsf{T}} W_x s_j = s_j^{\\mathsf{T}} (L^{\\mathsf{T}} L) s_j = (L s_j)^{\\mathsf{T}} (L s_j) = \\|L s_j\\|_2^2 = \\|y_j\\|_2^2\n$$\nwhere $y_j = L s_j$. This transformation effectively \"whitens\" the data with respect to the weighting matrix $W_x$. We assemble the weighted snapshots into a matrix $Y = [y_1, y_2, \\ldots, y_m] = L S$. The POD problem in the $W_x$-norm for the snapshots $S$ is now equivalent to the standard POD problem in the Euclidean norm for the weighted snapshots $Y$.\n\nThe solution to the standard POD problem is given by the left singular vectors of the snapshot matrix. Let the SVD of the weighted snapshot matrix $Y$ be $Y = U \\Sigma \\mathcal{V}^{\\mathsf{T}}$, where the columns of $U$ are the POD modes in the transformed coordinate system, and $\\sigma_1 \\geq \\sigma_2 \\geq \\ldots \\geq \\sigma_k \\geq 0$ are the singular values, with $k = \\min(n, m)$. The total energy of the snapshots, measured in the aggregate squared $W_x$-norm, is related to the singular values:\n$$\n\\sum_{j=1}^{m} \\|s_j\\|_{W_x}^2 = \\sum_{j=1}^{m} \\|y_j\\|_2^2 = \\|Y\\|_{\\mathrm{F}}^2 = \\sum_{i=1}^{k} \\sigma_i^2\n$$\nwhere $\\|\\cdot\\|_{\\mathrm{F}}$ is the Frobenius norm.\n\nThe problem requires selecting the minimal model order $r \\geq 1$ that satisfies a condition on the relative tail energy. The energy captured by an $r$-dimensional POD model is $\\sum_{i=1}^{r} \\sigma_i^2$. The residual energy, or the part of the data not captured by the model, is $\\sum_{i=r+1}^{k} \\sigma_i^2$. The specified criterion is:\n$$\n\\frac{\\sum_{i=r+1}^{k} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\leq \\varepsilon^2\n$$\nThis is equivalent to finding the smallest integer $r \\geq 1$ such that the fraction of captured energy meets a certain threshold:\n$$\n\\frac{\\sum_{i=1}^{r} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\geq 1 - \\varepsilon^2\n$$\nWe will compute the singular values of $Y$, find their squares $\\sigma_i^2$, calculate the cumulative sum of these squared values, and identify the smallest $r \\geq 1$ that satisfies this condition.\n\nNext, we derive the upper bound for the acoustic pressure error. We are given the inequality:\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j - \\Pi_r s_j\\|_{W_x}\n$$\nwhere $\\Pi_r$ is the $W_x$-orthogonal projector onto the $r$-dimensional POD subspace. The problem also specifies a tolerance $\\varepsilon$ on the worst-case relative projection error for any snapshot:\n$$\n\\frac{\\|s_j - \\Pi_r s_j\\|_{W_x}}{\\|s_j\\|_{W_x}} \\leq \\varepsilon \\quad \\implies \\quad \\|s_j - \\Pi_r s_j\\|_{W_x} \\leq \\varepsilon \\|s_j\\|_{W_x}\n$$\nCombining these two inequalities yields a bound on the pressure error for a single snapshot $s_j$:\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\left( \\varepsilon \\|s_j\\|_{W_x} \\right)\n$$\nTo find the worst-case upper bound over the entire set of snapshots, we take the maximum over all $j \\in \\{1, \\ldots, m\\}$:\n$$\n\\max_{1 \\leq j \\leq m} \\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\max_{1 \\leq j \\leq m} \\left( \\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j\\|_{W_x} \\right)\n$$\nSince $\\varepsilon$ and the matrix norm $\\|H W_x^{-1/2}\\|_{2}$ are constant with respect to the snapshot index $j$, we can write the final expression for the bound as:\n$$\n\\text{Error Bound} = \\varepsilon \\cdot \\|H W_x^{-1/2}\\|_{2} \\cdot \\left( \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x} \\right)\n$$\nThe computational steps are as follows:\n1.  Compute the upper triangular Cholesky factor $L$ of $W_x$ such that $W_x = L^{\\mathsf{T}} L$.\n2.  Form the weighted snapshot matrix $Y = L S$.\n3.  Compute the singular values $\\sigma_i$ of $Y$. Use these to find the minimal ROM order $r \\geq 1$ satisfying the energy criterion.\n4.  Calculate the operator norm $\\|H W_x^{-1/2}\\|_{2}$. As per the problem description, this is achieved by computing the largest singular value of the matrix $T = H L^{-1}$, which is consistent with the identification $W_x^{-1/2} = L^{-1}$.\n5.  Determine the maximum weighted norm of the snapshots, $\\max_{j} \\|s_j\\|_{W_x}$, which is equivalent to finding the maximum Euclidean norm of the columns of $Y$, i.e., $\\max_{j} \\|y_j\\|_{2}$.\n6.  Combine these quantities to calculate the final pressure error bound.\n\nThis procedure will be implemented for each of the specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import cholesky, solve_triangular\n\ndef solve():\n    \"\"\"\n    Solves the model order reduction problem for the given test cases.\n    \"\"\"\n    \n    # Test Case 1 Data\n    W_x1 = np.array([\n        [2.0, 0.1, 0.0, 0.0, 0.0],\n        [0.1, 1.8, 0.05, 0.0, 0.0],\n        [0.0, 0.05, 1.5, 0.1, 0.0],\n        [0.0, 0.0, 0.1, 1.2, 0.05],\n        [0.0, 0.0, 0.0, 0.05, 1.0]\n    ])\n    \n    H1 = np.array([\n        [100.0, -80.0, 60.0, -40.0, 20.0],\n        [50.0, 40.0, -30.0, 20.0, -10.0]\n    ])\n    \n    S1 = np.array([\n        [0.010, 0.008, 0.006, 0.004, 0.003, 0.002, 0.001, 0.0005],\n        [0.009, 0.007, 0.005, 0.004, 0.003, 0.002, 0.0015, 0.0007],\n        [-0.008, -0.006, -0.005, -0.003, -0.0025, -0.0015, -0.0010, -0.0005],\n        [0.006, 0.005, 0.004, 0.003, 0.0020, 0.0010, 0.0008, 0.0004],\n        [-0.004, -0.003, -0.002, -0.0015, -0.0010, -0.0008, -0.0005, -0.0003]\n    ])\n\n    test_cases = [\n        (W_x1, H1, S1, 0.15),\n        (W_x1, H1, S1, 0.000001),\n        (W_x1, H1, S1, 0.5)\n    ]\n\n    results = []\n    \n    for W_x, H, S, epsilon in test_cases:\n        # Step 1: Cholesky factorization W_x = L^T L with L upper triangular\n        # scipy.linalg.cholesky returns lower triangular C where W_x = C @ C.T\n        # We need W_x = L.T @ L where L is upper. So L = C.T\n        try:\n            C = cholesky(W_x, lower=True)\n            L = C.T\n        except np.linalg.LinAlgError:\n            # This should not happen for the given positive definite matrices\n            results.append([\"Error\", \"Cholesky failed\"])\n            continue\n\n        # Step 2: Form the weighted snapshot matrix Y = L S\n        Y = L @ S\n\n        # Step 3: Compute SVD of Y and select ROM order r\n        # We only need the singular values\n        sigma = np.linalg.svd(Y, compute_uv=False)\n        \n        # Sort in descending order just in case, though svd should already do this\n        sigma = np.sort(sigma)[::-1]\n        \n        # Compute squared singular values (energies)\n        sigma_sq = sigma**2\n        \n        # Compute total energy\n        total_energy = np.sum(sigma_sq)\n        \n        # Guard against zero total energy (rank-0 S)\n        if total_energy  np.finfo(float).eps:\n             r = 1 # As per problem, r must be at least 1\n        else:\n            # Compute cumulative energy fraction\n            cum_energy_frac = np.cumsum(sigma_sq) / total_energy\n            \n            # Find the smallest r = 1 such that the captured energy fraction is\n            # at least 1 - epsilon^2\n            # This is equivalent to finding the first index where this is true\n            # and adding 1 to get the number of modes.\n            required_frac = 1.0 - epsilon**2\n            candidate_indices = np.where(cum_energy_frac = required_frac)[0]\n            \n            # The order r is the index + 1. If no index is found, it means even with\n            # all modes, the criterion is not met (due to float precision), so take all modes.\n            if candidate_indices.size  0:\n                r = candidate_indices[0] + 1\n            else:\n                r = len(sigma) # Take all modes\n        \n        # Ensure r is at least 1, as per problem requirement\n        r = max(1, r)\n\n        # Step 4: Compute the operator norm ||H W_x^{-1/2}||_2\n        # This is ||H L^{-1}||_2. We compute T = H @ L^{-1}.\n        # It's more stable to solve L.T @ X = H.T for X, then T = X.T\n        # or solve LX = I for X = L^{-1}\n        I_n = np.identity(L.shape[0])\n        L_inv = solve_triangular(L, I_n, lower=False)\n        T = H @ L_inv\n        \n        # The spectral norm is the largest singular value\n        norm_op = np.linalg.svd(T, compute_uv=False)[0]\n        \n        # Step 5: Compute the maximum weighted norm of the snapshots\n        # max_j ||s_j||_W_x = max_j ||L s_j||_2 = max_j ||y_j||_2\n        # This is the max L2 norm of the columns of Y\n        max_s_norm = np.max(np.linalg.norm(Y, axis=0))\n\n        # Step 6: Compute the worst-case pressure error bound\n        pressure_error_bound = epsilon * norm_op * max_s_norm\n        \n        results.append([r, round(pressure_error_bound, 6)])\n\n    # Format output as a string representing a list of lists.\n    # e.g., [[r1, b1], [r2, b2], [r3, b3]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "A reduced-order model is only useful if it is reliable. This final practice moves from model construction to the critical stage of validation, challenging you to design and identify a scientifically defensible protocol for assessing a ROM's performance and generalization capabilities. You will evaluate different validation strategies, learning to distinguish rigorous methods from common pitfalls and emphasizing the importance of testing across unseen operating conditions using physically meaningful error metrics .",
            "id": "4129280",
            "problem": "A coupled vibroacoustic system, discretized by the Finite Element Method (FEM), may be modeled in the frequency domain as a Linear Time-Invariant (LTI) second-order system. Let the structural displacement vector be $\\,\\mathbf{u}\\in\\mathbb{R}^{n_s}\\,$ and the acoustic pressure vector be $\\,\\mathbf{p}\\in\\mathbb{R}^{n_a}\\,$. The Full-Order Model (FOM) frequency-response formulation for a single-input single-output setting with input $\\,u(\\omega)\\,$ and output $\\,y(\\omega)\\,$ can be written as\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega),\n\\qquad\ny(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega),\n$$\nwhere $\\,\\mathbf{M}_\\star\\,$, $\\,\\mathbf{C}_\\star\\,$, and $\\,\\mathbf{K}_\\star\\,$ denote mass, damping, and stiffness matrices, respectively, $\\,\\mathbf{B}_\\star\\,$ are input distribution vectors, and $\\,\\mathbf{L}_\\star\\,$ map states to the measured observables (e.g., structural velocity or acoustic pressure at sensors). The Reduced-Order Model (ROM) is built via a projection $\\,\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)\\,$, with a low-dimensional state $\\,\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}\\,$ and basis $\\,\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}\\,$, yielding projected operators and the corresponding reduced transfer function $\\,G_{\\mathrm{ROM}}(\\omega)\\,$, while the FOM induces $\\,G_{\\mathrm{FOM}}(\\omega)\\,$.\n\nOperating scenarios are parameterized by $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}\\,$, which encode, for example, boundary impedance, fluid properties affecting sound speed $\\,c(\\boldsymbol{\\mu})\\,$, damping ratios, and excitation spectra. A scientifically sound validation protocol for the ROM should assess generalization across $\\,\\boldsymbol{\\mu}\\,$, fidelity of key observables, and report error norms that reflect vibroacoustic performance over a frequency band $\\,\\Omega=[\\omega_{\\min},\\omega_{\\max}]\\,$ relevant to the application.\n\nStarting from the governing equations above and the definitions of input-output transfer functions for LTI systems, choose the protocol below that is scientifically defensible and implements cross-validation across operating scenarios, comparison of key observables, and reporting of error norms grounded in vibroacoustic first principles.\n\nA. Partition the scenario parameter set $\\,\\mathcal{D}\\,$ into disjoint training and test subsets $\\,\\mathcal{D}_{\\mathrm{train}}\\,$ and $\\,\\mathcal{D}_{\\mathrm{test}}\\,$, and perform $\\,k\\,$-fold cross-validation by folding $\\,\\mathcal{D}\\,$ itself (i.e., folds partition scenarios, not time or frequency samples). For each $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}_{\\mathrm{test}}\\,$, compute $\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\omega)\\,$ and $\\,G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\omega)\\,$ over $\\,\\omega\\in\\Omega\\,$, and compare key observables $\\,y(\\omega)\\,$ such as acoustic pressure at microphones, structural velocity at accelerometers, and radiated acoustic power. Report, for each $\\,\\boldsymbol{\\mu}\\,$, the relative output error\n$$\n\\varepsilon_{L^2}(\\boldsymbol{\\mu})=\\frac{\\left\\|y_{\\mathrm{ROM}}(\\cdot;\\boldsymbol{\\mu})-y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}}{\\left\\|y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}},\n$$\nthe $\\,H_2\\,$ and $\\,H_\\infty\\,$ norms of $\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\cdot)-G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\cdot)\\,$, the maximum Sound Pressure Level difference across the sensor array, and the Modal Assurance Criterion (MAC) for dominant coupled modes. Verify stability and passivity preservation by checking positive-realness or dissipativity certificates of the ROM. Summarize errors across $\\,\\mathcal{D}_{\\mathrm{test}}\\,$ via median, interquartile range, and $\\,95\\%\\,$-percentile statistics, and report worst-case frequency-resolved error $\\,\\max_{\\omega\\in\\Omega}\\left|y_{\\mathrm{ROM}}(\\omega)-y_{\\mathrm{FOM}}(\\omega)\\right|\\,$ per scenario.\n\nB. Use $\\,k\\,$-fold cross-validation by randomly splitting time-domain samples of a single operating scenario into folds. Compare internal state vectors $\\,\\mathbf{q}\\,$ and $\\,\\mathbf{z}\\,$ only, with the mean squared state difference $\\,\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{z}_i-\\mathbf{V}\\mathbf{q}_i\\right\\|_2^2\\,$ over sampled times. Report solely the average state error without observable comparison, and do not separate training and test scenarios since the state-space projection already minimizes state residuals.\n\nC. Validate by checking the ROM at a small set of resonance frequencies predicted by the ROM basis, skipping non-resonant bands. Permit inclusion of training scenarios in the validation set to increase sample size. Report the $\\,L^\\infty\\,$ norm of the internal state error $\\,\\left\\|\\mathbf{z}-\\mathbf{V}\\mathbf{q}\\right\\|_\\infty\\,$ at those resonant frequencies and adjust ROM damping parameters post hoc until the output curves visually match in those bands.\n\nD. Perform cross-validation across scenarios but evaluate only a single observable: the acoustic pressure at one microphone location. Use the mean absolute error $\\,\\frac{1}{|\\Omega|}\\int_{\\Omega}\\left|p_{\\mathrm{ROM}}(\\omega)-p_{\\mathrm{FOM}}(\\omega)\\right|\\,\\mathrm{d}\\omega\\,$ as the sole metric. Do not include structural observables or energy/power metrics, and report only the average error over all scenarios without distributional statistics or worst-case frequency-resolved errors.\n\nE. Use Monte Carlo sampling of $\\,\\boldsymbol{\\mu}\\,$ to build a validation set, but replace the FOM by a coarsened model to reduce computational cost. Upsample ROM outputs to the coarsened FOM mesh for comparison, and compare short time-window impulse responses in the time domain without mapping to frequency. Report only the $\\,L^2\\,$ time-domain error for a single excitation, and do not consider $\\,H_\\infty\\,$-type worst-case behavior over $\\,\\Omega\\,$.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **System Type**: A coupled vibroacoustic system, discretized by the Finite Element Method (FEM).\n- **Model Type**: Linear Time-Invariant (LTI) second-order system in the frequency domain.\n- **State Variables**: Structural displacement vector $\\mathbf{u}\\in\\mathbb{R}^{n_s}$ and acoustic pressure vector $\\mathbf{p}\\in\\mathbb{R}^{n_a}$.\n- **Full-Order Model (FOM) Equation**:\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega)\n$$\n- **Output Equation**: $y(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega)$.\n- **System Matrices**: Mass ($\\mathbf{M}_\\star$), damping ($\\mathbf{C}_\\star$), and stiffness ($\\mathbf{K}_\\star$) for structural ($\\star=s$) and acoustic ($\\star=a$) domains. $\\mathbf{K}_{sa}$ and $\\mathbf{K}_{as}$ are coupling matrices.\n- **Input/Output Vectors**: $\\mathbf{B}_\\star$ are input distribution vectors for a single input $u(\\omega)$. $\\mathbf{L}_\\star$ are output vectors for a single output $y(\\omega)$.\n- **Reduced-Order Model (ROM)**: Constructed via projection with a basis $\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}$, where $\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)$ and $\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}$ with $r \\ll n_s+n_a$.\n- **Transfer Functions**: $G_{\\mathrm{FOM}}(\\omega)$ and $G_{\\mathrm{ROM}}(\\omega)$ are the transfer functions from input $u(\\omega)$ to output $y(\\omega)$ for the respective models.\n- **Parameterization**: System behavior depends on parameters $\\boldsymbol{\\mu}\\in\\mathcal{D}$, affecting quantities like sound speed $c(\\boldsymbol{\\mu})$, damping, etc.\n- **Validation Goal**: To choose a scientifically defensible validation protocol for the ROM that assesses generalization across $\\boldsymbol{\\mu}$, fidelity of key observables, and reports appropriate error norms over a frequency band $\\Omega=[\\omega_{\\min},\\omega_{\\max}]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is examined for validity.\n- **Scientific Grounding**: The formulation is a standard state-space representation of a frequency-domain, FEM-discretized, coupled vibroacoustic system. The matrices ($\\mathbf{M}$, $\\mathbf{C}$, $\\mathbf{K}$), coupling terms ($\\mathbf{K}_{sa}$, $\\mathbf{K}_{as}$), input/output structure, and the use of projection-based model order reduction are all firmly established in computational mechanics and acoustics. The concepts mentioned for validation (cross-validation, error norms like $L^2$, $H_2$, $H_\\infty$, MAC, stability, passivity) are standard and central to the fields of MOR and control theory. The problem is scientifically sound.\n- **Well-Posedness**: The question asks to identify the most scientifically rigorous validation protocol from a given list. This is a conceptual problem that has a well-defined answer based on established principles of scientific and engineering validation. It is not computationally ill-posed.\n- **Objectivity**: The language is precise and objective, describing a standard engineering problem without subjective or biased phrasing.\n\nNo flaws are identified. The problem does not violate any fundamental principles, is not incomplete or contradictory for the task at hand, and represents a realistic, non-trivial problem in computational engineering.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will now be derived by evaluating each proposed protocol against first principles of model validation for parametric systems.\n\n### Solution Derivation\nA scientifically defensible validation protocol for a parametric Reduced-Order Model (pROM) must satisfy several key criteria:\n1.  **Assessment of Generalization**: The primary purpose of a pROM is to accurately predict system behavior for parameter values $\\boldsymbol{\\mu}$ not used in its construction. This necessitates a strict separation of the parameter set $\\mathcal{D}$ into a training set $\\mathcal{D}_{\\mathrm{train}}$ (used to build the ROM) and a testing set $\\mathcal{D}_{\\mathrm{test}}$ (used for validation).\n2.  **Evaluation of Physical Observables**: Validation should focus on the quantities of physical and engineering interest, which are the outputs $y(\\omega)$ of the system (e.g., pressure at a microphone, velocity at an accelerometer). Errors in internal, non-physical states of the ROM (e.g., $\\mathbf{q}$) are of secondary importance.\n3.  **Comprehensive Error Quantification**: Errors must be measured over the entire operational domain, i.e., the frequency band of interest $\\Omega$. Appropriate metrics include integral norms like the $L^2$ norm for average error, and supremum norms like the $H_\\infty$ norm for worst-case error, which is critical for performance guarantees and stability analysis.\n4.  **Preservation of Physical Properties**: The ROM should be checked to ensure it retains fundamental physical properties of the FOM, such as stability (all system poles have negative real parts) and passivity (the system does not generate energy).\n5.  **Robust Statistical Reporting**: When validating over a set of test parameters $\\mathcal{D}_{\\mathrm{test}}$, reporting only an average error is insufficient. A statistical summary including median, quartiles, and high-percentile or worst-case errors is required to characterize the reliability and robustness of the ROM.\n\nWith these principles as a benchmark, each option is analyzed.\n\n### Option-by-Option Analysis\n\n**A. Partition the scenario parameter set $\\ldots$**\nThis protocol adheres to all the principles of rigorous validation.\n- It correctly implements cross-validation by partitioning the parameter set $\\mathcal{D}$ into disjoint training and test sets ($\\mathcal{D}_{\\mathrm{train}}$, $\\mathcal{D}_{\\mathrm{test}}$), which is the correct method for assessing generalization over operating scenarios.\n- It evaluates physically meaningful outputs ($y(\\omega)$) and specific engineering quantities like acoustic pressure, structural velocity, and radiated power.\n- It employs a comprehensive suite of error metrics grounded in systems theory and acoustics: the relative output $L^2$ error, the $H_2$ and $H_\\infty$ norms of the error system, and domain-specific metrics like Sound Pressure Level (SPL) difference and the Modal Assurance Criterion (MAC).\n- It explicitly includes checks for the preservation of fundamental system properties like stability and passivity.\n- It proposes robust statistical reporting of errors across the test set using median, interquartile range (IQR), and percentiles, in addition to worst-case frequency-resolved errors.\nThis protocol is thorough, multifaceted, and scientifically sound.\n**Verdict: Correct**\n\n**B. Use $\\,k\\,$-fold cross-validation by randomly splitting time-domain samples of a single operating scenario $\\ldots$**\nThis protocol is fundamentally flawed.\n- It misapplies cross-validation. Splitting time-series data from a single scenario ($\\boldsymbol{\\mu}$) does not test generalization across different scenarios. The problem is posed in the frequency domain, making time-domain sample splitting even more suspect.\n- It focuses on the internal state error ($\\|\\mathbf{z}_i - \\mathbf{V}\\mathbf{q}_i\\|_2^2$), which is a projection error, not the physically meaningful output error.\n- It explicitly rejects the separation of training and test scenarios, which is a critical failure in validation methodology. The justification provided is nonsensical.\n**Verdict: Incorrect**\n\n**C. Validate by checking the ROM at a small set of resonance frequencies $\\ldots$**\nThis protocol is methodologically unsound.\n- Validating only at resonance frequencies provides a highly incomplete picture of the ROM's accuracy. Off-resonance and anti-resonance behavior is equally important for the system's dynamic response.\n- It allows the inclusion of training data in the validation set, which invalidates any claims of generalization.\n- It proposes post hoc \"tuning\" of model parameters to achieve a \"visual match,\" which conflates validation with tuning and replaces objective metrics with subjective assessment. This invalidates the test.\n**Verdict: Incorrect**\n\n**D. Perform cross-validation across scenarios but evaluate only a single observable $\\ldots$**\nThis protocol is overly simplistic and incomplete.\n- While it correctly performs cross-validation across scenarios, it limits the evaluation to a single acoustic pressure observable. This ignores the coupled structural dynamics and provides no information on other important quantities like structural velocities or global energy-based metrics (e.g., radiated power).\n- The use of a single error metric (mean absolute error) is insufficient. It fails to capture worst-case frequency behavior (relevant to $H_\\infty$) or total energy.\n- Reporting only the average error across scenarios fails to characterize the error distribution and hides potentially poor performance in worst-case scenarios.\n**Verdict: Incorrect**\n\n**E. Use Monte Carlo sampling of $\\,\\boldsymbol{\\mu}\\,$ to build a validation set, but replace the FOM by a coarsened model $\\ldots$**\nThis protocol contains a fatal flaw.\n- It validates the ROM against a coarsened model, not the original high-fidelity FOM. This is not a validation of the ROM against the ground truth. It is a comparison of two different approximations ($\\text{ROM vs. coarse FOM}$), and the resulting error is not meaningful without quantifying the error of the coarse model itself. The very basis of validation is comparison against the most accurate available model, which is the FOM.\n- It limits the evaluation to time-domain impulse responses and a single $L^2$ error metric, neglecting the crucial frequency-domain perspective (especially worst-case $H_\\infty$ errors) where the model was defined.\n**Verdict: Incorrect**\n\nConclusion: Option A is the only one that describes a comprehensive, multi-faceted, and scientifically rigorous validation protocol that correctly addresses generalization, physical observables, appropriate error metrics, system properties, and robust statistical analysis.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}