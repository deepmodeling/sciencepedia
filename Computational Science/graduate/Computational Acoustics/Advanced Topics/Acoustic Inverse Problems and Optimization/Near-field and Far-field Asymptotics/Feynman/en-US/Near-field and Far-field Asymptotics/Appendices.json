{
    "hands_on_practices": [
        {
            "introduction": "The behavior of radiating waves depends fundamentally on the dimensionality of the space in which they propagate. This exercise explores this concept by contrasting two classic cases: a point source radiating in three dimensions and a line source radiating in two dimensions. By deriving the far-field asymptotic forms from their respective Green's functions, you will uncover the distinct algebraic decay rates and see how the directivity function quantifies the angular distribution of energy for these canonical sources .",
            "id": "4131197",
            "problem": "Consider time-harmonic acoustic radiation in a homogeneous, lossless fluid of density $\\rho$ and sound speed $c$, with angular frequency $\\omega$ and wavenumber $k=\\omega/c$. Adopt the time dependence $\\exp(-i \\omega t)$ and the outgoing radiation condition. Let $p(\\mathbf{x})$ denote the complex acoustic pressure amplitude.\n\nStarting from the scalar wave equation and its frequency-domain reduction to the Helmholtz equation together with the appropriate radiation condition, analyze the far-field asymptotics of two canonical sources:\n- a two-dimensional line monopole source (translation-invariant along the $z$-axis) concentrated at the spatial origin in the transverse plane, and\n- a three-dimensional point monopole source concentrated at the spatial origin in space.\n\nFor each case, derive the far-field asymptotic form of $p$ as the distance $r$ from the source tends to infinity, and extract a directivity function defined as follows. In polar or spherical coordinates $(r,\\theta)$, write the far-field expansion in the form\n$$\np(r,\\theta) \\sim A \\, D(\\theta) \\, F(r) \\, \\exp(i k r),\n$$\nwhere $A$ is an angle-independent complex amplitude factor that may depend on $\\rho$, $c$, and $\\omega$, $F(r)$ is a real-valued, positive, angle-independent decay envelope, and $D(\\theta)$ is a dimensionless directivity function. Normalize $D(\\theta)$ in each case so that $\\max_{\\theta} |D(\\theta)| = 1$.\n\nCompute the pair of directivity functions for the two cases, denoted $D_{\\mathrm{2D}}(\\theta)$ and $D_{\\mathrm{3D}}(\\theta)$, as closed-form analytic expressions in $\\theta$. Express your final answer as a single row matrix containing these two expressions, in the order $\\big(D_{\\mathrm{2D}}(\\theta), D_{\\mathrm{3D}}(\\theta)\\big)$. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The analysis begins with the inhomogeneous Helmholtz equation, which governs time-harmonic acoustic pressure fields $p(\\mathbf{x})$ in the frequency domain for a source distribution $f(\\mathbf{x})$. With the specified time dependence $\\exp(-i \\omega t)$ and wavenumber $k = \\omega/c$, the equation is:\n$$\n(\\nabla^2 + k^2) p(\\mathbf{x}) = -f(\\mathbf{x})\n$$\nThe solution to this equation that satisfies the outgoing radiation condition is obtained by convolving the source term with the appropriate Green's function $G(\\mathbf{x}, \\mathbf{x}')$:\n$$\np(\\mathbf{x}) = \\int G(\\mathbf{x}, \\mathbf{x}') f(\\mathbf{x}') d\\mathbf{x}'\n$$\nFor a monopole source concentrated at the origin, the source term is a Dirac delta function, $f(\\mathbf{x}') = S \\delta(\\mathbf{x}')$, where $S$ is the source strength. The integral simplifies, and the pressure field is directly proportional to the Green's function evaluated for a source at the origin:\n$$\np(\\mathbf{x}) = S \\, G(\\mathbf{x}, 0)\n$$\nWe will now analyze the three-dimensional and two-dimensional cases separately.\n\n**1. Three-Dimensional Point Monopole Source**\n\nIn three dimensions, the source is $f(\\mathbf{x}) = S_{3D} \\delta(\\mathbf{x})$, where $\\mathbf{x} \\in \\mathbb{R}^3$ and $S_{3D}$ is the point source strength. The Green's function for the 3D Helmholtz equation satisfying the Sommerfeld radiation condition (for $\\exp(-i\\omega t)$ time dependence) is:\n$$\nG_{3D}(\\mathbf{x}, \\mathbf{x}') = \\frac{\\exp(ik|\\mathbf{x}-\\mathbf{x'}|)}{4\\pi|\\mathbf{x}-\\mathbf{x'}|}\n$$\nSetting the source location $\\mathbf{x}'=0$ and using spherical coordinates where $r = |\\mathbf{x}|$, the pressure field becomes:\n$$\np(\\mathbf{x}) = S_{3D} \\, G_{3D}(\\mathbf{x}, 0) = S_{3D} \\frac{\\exp(ikr)}{4\\pi r}\n$$\nThis expression is the exact solution for all $r > 0$. It is manifestly independent of the spherical angular coordinates $(\\theta, \\phi)$, indicating that the radiation is isotropic.\n\nTo find the directivity function $D_{3D}(\\theta)$, we compare this exact solution with the specified far-field asymptotic form:\n$$\np(r,\\theta) \\sim A \\, D(\\theta) \\, F(r) \\, \\exp(i k r)\n$$\nBy direct comparison with our solution $p(r) = (S_{3D}/(4\\pi)) \\cdot (1/r) \\cdot \\exp(ikr)$, we can identify the components:\n- The phase factor is $\\exp(ikr)$.\n- The real-valued, positive, angle-independent decay envelope is $F(r) = 1/r$.\n- The remaining term is the product of the complex amplitude $A$ and the directivity $D(\\theta)$: $A \\, D(\\theta) = S_{3D}/(4\\pi)$.\n\nSince the term $S_{3D}/(4\\pi)$ is a constant, independent of the angle $\\theta$, the directivity function $D_{3D}(\\theta)$ must also be a constant. Let this constant be $C$. The problem requires normalization such that $\\max_{\\theta} |D_{3D}(\\theta)| = 1$. This implies $|C|=1$. The canonical choice for a dimensionless, shaping function is the real value $C=1$.\nTherefore, the directivity function for the 3D point monopole is:\n$$\nD_{3D}(\\theta) = 1\n$$\nThe complex amplitude factor is then $A = S_{3D}/(4\\pi)$.\n\n**2. Two-Dimensional Line Monopole Source**\n\nIn this case, the source is uniform along the $z$-axis and concentrated at the origin of the transverse $(x,y)$-plane. The problem becomes two-dimensional. Let $\\mathbf{r}$ be the position vector in the transverse plane. The source is $f(\\mathbf{r}) = S_{2D} \\delta(\\mathbf{r})$, where $S_{2D}$ is the source strength per unit length.\n\nThe Green's function for the 2D Helmholtz equation satisfying the outgoing radiation condition is given in terms of the zeroth-order Hankel function of the first kind, $H_0^{(1)}$:\n$$\nG_{2D}(\\mathbf{r}, \\mathbf{r}') = \\frac{i}{4} H_0^{(1)}(k|\\mathbf{r}-\\mathbf{r'}|)\n$$\nFor a source at the origin $\\mathbf{r}'=0$, and using polar coordinates where $r = |\\mathbf{r}|$, the pressure field is:\n$$\np(\\mathbf{r}) = S_{2D} \\, G_{2D}(\\mathbf{r}, 0) = S_{2D} \\frac{i}{4} H_0^{(1)}(kr)\n$$\nThis solution is an exact expression, valid for $r>0$. It is independent of the polar angle $\\theta$, indicating cylindrically isotropic radiation in the transverse plane.\n\nTo find the directivity function, we need the far-field asymptotic expansion of $H_0^{(1)}(z)$ for large argument $z \\to \\infty$:\n$$\nH_0^{(1)}(z) \\sim \\sqrt{\\frac{2}{\\pi z}} \\exp\\left(i\\left(z - \\frac{\\pi}{4}\\right)\\right)\n$$\nSubstituting $z=kr$, the far-field pressure is:\n$$\np(r) \\sim S_{2D} \\frac{i}{4} \\sqrt{\\frac{2}{\\pi kr}} \\exp\\left(i\\left(kr - \\frac{\\pi}{4}\\right)\\right)\n$$\nWe rearrange this expression to match the prescribed asymptotic form $p(r,\\theta) \\sim A \\, D(\\theta) \\, F(r) \\, \\exp(i k r)$:\n$$\np(r) \\sim \\left( S_{2D} \\frac{i}{4} \\sqrt{\\frac{2}{\\pi k}} \\exp\\left(-\\frac{i\\pi}{4}\\right) \\right) \\cdot \\frac{1}{\\sqrt{r}} \\cdot \\exp(ikr)\n$$\nBy direct comparison, we identify the components:\n- The phase factor is $\\exp(ikr)$.\n- The real-valued, positive, angle-independent decay envelope is $F(r) = 1/\\sqrt{r}$.\n- The remaining term is the product $A \\, D(\\theta)$:\n$$\nA \\, D(\\theta) = S_{2D} \\frac{i}{4} \\sqrt{\\frac{2}{\\pi k}} \\exp\\left(-\\frac{i\\pi}{4}\\right)\n$$\nThis entire term is a complex constant, independent of the angle $\\theta$. Thus, the directivity function $D_{2D}(\\theta)$ must be a constant, say $C'$. The normalization condition $\\max_{\\theta} |D_{2D}(\\theta)| = 1$ requires $|C'|=1$. We again choose the canonical value $C'=1$.\nTherefore, the directivity function for the 2D line monopole is:\n$$\nD_{2D}(\\theta) = 1\n$$\nThe complex amplitude factor is $A = S_{2D} \\frac{i}{4} \\sqrt{\\frac{2}{\\pi k}} \\exp(-i\\pi/4)$.\n\n**Conclusion**\n\nFor both the 2D line monopole and the 3D point monopole, the radiation field is isotropic in the respective coordinate systems. This leads to a constant directivity function, which upon normalization becomes unity. The pair of directivity functions is $(D_{\\mathrm{2D}}(\\theta), D_{\\mathrm{3D}}(\\theta)) = (1, 1)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The distinction between the near-field and far-field is not a sharp boundary but a gradual transition governed by phase approximations. This practice examines the field radiated by a piston source, a ubiquitous model in ultrasonics and sonar, to illuminate the physics of this transition. You will perform a paraxial expansion of the phase term to isolate the quadratic component defining the Fresnel region and derive a quantitative criterion for when the simpler far-field approximation becomes valid, a critical skill for both experimental design and computational modeling .",
            "id": "4131115",
            "problem": "An axisymmetric monochromatic acoustic source is modeled as a uniformly vibrating circular piston of radius $a$ mounted in an infinite rigid baffle, radiating into a homogeneous, inviscid fluid of sound speed $c$. Let the acoustic pressure field be time-harmonic with angular frequency $\\omega$, wavenumber $k = \\omega / c$, and consider the on-axis field at a distance $z$ from the piston plane. Using the fundamental outgoing free-space Green's function for the Helmholtz equation, the radiated field can be represented as a surface integral over the piston face whose integrand contains the factor $\\exp(i k r)/r$, where $r$ is the distance from a point on the piston to the observation point.\n\nStarting from this representation and assuming the paraxial regime where the transverse radial coordinate on the piston face $\\rho$ is small compared to $z$ (that is, $\\rho/z$ is a small parameter), perform a systematic expansion of $r$ in powers of $\\rho/z$ sufficient to identify the first nontrivial phase corrections beyond the plane-wave term. Then:\n\n- Identify the term responsible for the quadratic phase that characterizes Fresnel propagation, and briefly explain its role in the near-field diffraction integral.\n- Derive a sufficient far-field condition by requiring that the next nonvanishing phase correction beyond the quadratic term has a maximum magnitude across the piston face bounded by a prescribed phase tolerance $\\phi_{\\mathrm{tol}}$.\n\nFinally, for a piston of radius $a = 2.0 \\times 10^{-2}$ m radiating at frequency $f = 2.0 \\times 10^{5}$ Hz into water where $c = 1.5 \\times 10^{3}$ m/s, and using a phase tolerance $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ radians, compute the minimal on-axis distance $z_{\\min}$ at which the higher-order phase terms beyond the quadratic phase can be neglected according to your criterion. Express your final answer in meters and round your result to three significant figures.",
            "solution": "The problem statement is first validated against the criteria of scientific soundness, well-posedness, and objectivity.\n\n### Step 1: Extract Givens\n- Acoustic source: Axisymmetric, monochromatic, uniformly vibrating circular piston of radius $a$.\n- Baffle: Infinite rigid.\n- Medium: Homogeneous, inviscid fluid with sound speed $c$.\n- Field properties: Time-harmonic with angular frequency $\\omega$, wavenumber $k = \\omega / c$.\n- Observation geometry: On-axis field at a distance $z$ from the piston plane.\n- Integral kernel: The integrand for the radiated field contains the factor $\\exp(ik r)/r$, where $r$ is the distance from a source point on the piston to the observation point.\n- Paraxial regime: The transverse radial coordinate $\\rho$ on the piston is small compared to $z$ ($\\rho/z \\ll 1$).\n- Tasks:\n  1. Expand $r$ in powers of $\\rho/z$.\n  2. Identify the quadratic phase term (Fresnel term) and explain its role.\n  3. Derive a condition for neglecting higher-order terms by bounding the next nonvanishing phase correction by a tolerance $\\phi_{\\mathrm{tol}}$.\n- Numerical values:\n  - Piston radius, $a = 2.0 \\times 10^{-2}$ m.\n  - Frequency, $f = 2.0 \\times 10^{5}$ Hz.\n  - Sound speed in water, $c = 1.5 \\times 10^{3}$ m/s.\n  - Phase tolerance, $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ radians.\n- Final objective: Compute the minimal on-axis distance $z_{\\min}$ based on the derived criterion.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a canonical problem in physical acoustics—the radiation from a baffled piston, analyzed using the Helmholtz equation and the concept of a free-space Green's function. The methods requested, namely paraxial expansion of the phase and the subsequent analysis of Fresnel and higher-order terms, are standard techniques in wave theory and diffraction. The problem is well-posed, providing all necessary information for a unique solution. The language is objective and precise. The numerical values are physically realistic for applications such as underwater acoustics or medical ultrasonics. The problem does not violate any of the specified invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Solution Derivation\n\nAn observation point on the axis of the piston at a distance $z$ has coordinates $(0, 0, z)$. A source point on the face of the piston is described in cylindrical coordinates by its radial position $\\rho$ and azimuthal angle, with coordinates $(\\rho \\cos\\theta, \\rho \\sin\\theta, 0)$, where $0 \\le \\rho \\le a$. The distance $r$ between the source point and the observation point is given by the Euclidean distance formula:\n$$r = \\sqrt{(\\rho \\cos\\theta - 0)^{2} + (\\rho \\sin\\theta - 0)^{2} + (0 - z)^{2}} = \\sqrt{\\rho^2 + z^2}$$\nTo analyze the phase term $\\exp(ikr)$ in the paraxial regime ($\\rho/z \\ll 1$), we expand $r$ in powers of $\\rho/z$. We factor out $z$:\n$$r = z \\sqrt{1 + \\left(\\frac{\\rho}{z}\\right)^2}$$\nUsing the binomial series expansion $(1+x)^{\\alpha} \\approx 1 + \\alpha x + \\frac{\\alpha(\\alpha-1)}{2!}x^2 + \\dots$ with $x = (\\rho/z)^2$ and $\\alpha = 1/2$, we get:\n$$r = z \\left[ 1 + \\frac{1}{2}\\left(\\frac{\\rho}{z}\\right)^2 + \\frac{(\\frac{1}{2})(-\\frac{1}{2})}{2}\\left(\\frac{\\rho}{z}\\right)^4 + O\\left(\\left(\\frac{\\rho}{z}\\right)^6\\right) \\right]$$\n$$r \\approx z \\left[ 1 + \\frac{\\rho^2}{2z^2} - \\frac{\\rho^4}{8z^4} \\right]$$\nDistributing the leading factor of $z$, we obtain the expansion for $r$:\n$$r \\approx z + \\frac{\\rho^2}{2z} - \\frac{\\rho^4}{8z^3}$$\nThe phase of the elementary wave from the source point at $\\rho$ is $\\phi(\\rho) = kr$. Using the expansion for $r$, the phase becomes:\n$$\\phi(\\rho) = kr \\approx kz + \\frac{k\\rho^2}{2z} - \\frac{k\\rho^4}{8z^3}$$\n\nThe first task is completed. The second task is to identify the quadratic phase term and its role.\n- The term $kz$ represents the constant phase delay associated with a plane wave propagating the distance $z$.\n- The term $\\frac{k\\rho^2}{2z}$ is the quadratic phase correction. This term is responsible for the Fresnel approximation of the diffraction integral. It accounts for the first-order deviation from a planar wavefront, modeling the wavefront from the piston as having a spherical curvature. Including this term is crucial for accurately describing the acoustic field in the near-field (or Fresnel region), where significant interference between waves from different parts of the piston face leads to characteristic oscillations in the on-axis intensity.\n\nThe third task is to derive a sufficient far-field condition. The problem defines this by requiring that the next nonvanishing phase correction beyond the quadratic term is negligible. From our expansion, this next term is the quartic phase correction:\n$$\\Delta\\phi_{\\text{quartic}}(\\rho) = - \\frac{k\\rho^4}{8z^3}$$\nThe condition for this term to be negligible is that its maximum magnitude across the piston face, which occurs at the rim where $\\rho = a$, is bounded by a given phase tolerance $\\phi_{\\mathrm{tol}}$.\n$$|\\Delta\\phi_{\\text{quartic}}(a)| \\le \\phi_{\\mathrm{tol}}$$\n$$\\left| - \\frac{ka^4}{8z^3} \\right| \\le \\phi_{\\mathrm{tol}}$$\n$$\\frac{ka^4}{8z^3} \\le \\phi_{\\mathrm{tol}}$$\nWe are asked to find the minimal distance $z_{\\min}$ for which this condition holds. This implies finding the lower bound on $z$:\n$$z^3 \\ge \\frac{ka^4}{8\\phi_{\\mathrm{tol}}}$$\n$$z \\ge \\left( \\frac{ka^4}{8\\phi_{\\mathrm{tol}}} \\right)^{1/3}$$\nTherefore, the minimal on-axis distance is:\n$$z_{\\min} = \\left( \\frac{ka^4}{8\\phi_{\\mathrm{tol}}} \\right)^{1/3}$$\nThis condition defines the transition from the very-near-field, where quartic and potentially higher-order phase terms are significant, to the Fresnel region, where the quadratic phase term provides a sufficient description of diffraction effects.\n\nFinally, we compute the numerical value of $z_{\\min}$ using the provided data.\n- Radius, $a = 2.0 \\times 10^{-2}$ m.\n- Frequency, $f = 2.0 \\times 10^{5}$ Hz.\n- Sound speed, $c = 1.5 \\times 10^{3}$ m/s.\n- Phase tolerance, $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ rad.\n\nFirst, we calculate the wavenumber $k$:\n$$k = \\frac{\\omega}{c} = \\frac{2\\pi f}{c} = \\frac{2\\pi (2.0 \\times 10^{5})}{1.5 \\times 10^{3}} = \\frac{4.0\\pi \\times 10^5}{1.5 \\times 10^3} = \\frac{8\\pi}{3} \\times 10^2 \\text{ m}^{-1}$$\nNow, we substitute the values into the expression for $z_{\\min}$:\n$$z_{\\min} = \\left( \\frac{(\\frac{8\\pi}{3} \\times 10^2) (2.0 \\times 10^{-2})^4}{8(1.0 \\times 10^{-1})} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{(\\frac{8\\pi}{3} \\times 10^2) (16.0 \\times 10^{-8})}{0.8} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{\\frac{128\\pi}{3} \\times 10^{-6}}{0.8} \\right)^{1/3} = \\left( \\frac{128\\pi}{3 \\times 0.8} \\times 10^{-6} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{128\\pi}{2.4} \\times 10^{-6} \\right)^{1/3} = \\left( \\frac{160\\pi}{3} \\times 10^{-6} \\right)^{1/3}$$\nNow, we compute the numerical value:\n$$\\frac{160\\pi}{3} \\approx \\frac{160 \\times 3.14159265}{3} \\approx 167.5516$$\nSo,\n$$z_{\\min} \\approx \\left( 167.5516 \\times 10^{-6} \\right)^{1/3} \\text{ m}$$\n$$z_{\\min} \\approx (167.5516)^{1/3} \\times (10^{-6})^{1/3} \\text{ m} \\approx 5.513 \\times 10^{-2} \\text{ m}$$\nRounding the result to three significant figures, we get:\n$$z_{\\min} \\approx 5.51 \\times 10^{-2} \\text{ m}$$",
            "answer": "$$\\boxed{5.51 \\times 10^{-2}}$$"
        },
        {
            "introduction": "In many practical applications, from antenna design to acoustic imaging, we can measure a field on a surface and need to predict its behavior far away. This hands-on coding exercise translates the theoretical far-field integral into a concrete computational algorithm by demonstrating that the far-field pattern is effectively the Fourier transform of the source distribution. You will first analytically solve for the pattern from a square aperture and then implement a numerical quadrature to approximate the same result, reinforcing the essential practice of verifying computational models against exact solutions .",
            "id": "4131235",
            "problem": "You are given a time-harmonic acoustic field governed by the Helmholtz equation in three-dimensional (3D) space for angular frequency $\\omega$, speed of sound $c$, and wavenumber $k = \\omega/c$. Consider a compact, planar square aperture $\\mathcal{S} \\subset \\mathbb{R}^3$ located in the plane $z = 0$, centered at the origin, with side length $a > 0$. The aperture supports a single-layer source density $q(\\mathbf{y})$ with $\\mathbf{y} = (x,y,0) \\in \\mathcal{S}$, and adopt the time convention $\\mathrm{e}^{- \\mathrm{i} \\omega t}$. Let the observation direction be $\\hat{\\mathbf{x}} = (\\sin \\theta \\cos \\phi, \\sin \\theta \\sin \\phi, \\cos \\theta)$, where $\\theta$ is the polar angle and $\\phi$ is the azimuthal angle, both expressed in radians.\n\nStarting from the Helmholtz equation and the fundamental solution representation for time-harmonic acoustics, use far-field asymptotics to justify that the normalized far-field pattern in direction $\\hat{\\mathbf{x}}$ can be obtained by post-processing the surface data via an oscillatory integral of the form\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nup to a direction-independent multiplicative constant. For the specific case where $q(\\mathbf{y}) = 1$ on the square aperture $\\mathcal{S} = \\{(x,y,0) : x \\in [-a/2,a/2], y \\in [-a/2,a/2]\\}$, analytically evaluate $F(\\hat{\\mathbf{x}})$ in terms of $k$, $a$, $\\theta$, and $\\phi$.\n\nThen, design a numerical quadrature that approximates $F(\\hat{\\mathbf{x}})$ by discretizing $\\mathcal{S}$ with an $N \\times N$ uniform midpoint rule, where $N$ is a positive integer. The numerical approximation must be computed as\n$$\nF_N(\\hat{\\mathbf{x}}) = \\sum_{j=1}^{N} \\sum_{m=1}^{N} q(\\mathbf{y}_{j,m}) \\,\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}_{j,m}} \\,\\Delta S,\n$$\nwhere $\\mathbf{y}_{j,m}$ are the cell center points on the square grid and $\\Delta S$ is the area of each grid cell. Your program must compute $F_N(\\hat{\\mathbf{x}})$ and compare it against the exact analytic $F(\\hat{\\mathbf{x}})$ that you derived. Report the absolute relative error\n$$\nE = \\frac{|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|}{|F(\\hat{\\mathbf{x}})|},\n$$\nand, to avoid division by zero, if $|F(\\hat{\\mathbf{x}})| < \\varepsilon$ for a small tolerance $\\varepsilon$, report $E = |F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|$.\n\nAll physical quantities must use the following units: $k$ in $\\mathrm{rad/m}$, $a$ in $\\mathrm{m}$, angles $\\theta$ and $\\phi$ in radians. The reported error $E$ is dimensionless. For the numerical quadrature, use a uniform square grid and the midpoint rule on each cell. The far-field kernel is $\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}}$.\n\nImplement a complete program that:\n- Computes the analytic $F(\\hat{\\mathbf{x}})$ for the square aperture with $q(\\mathbf{y}) = 1$.\n- Computes the numerical $F_N(\\hat{\\mathbf{x}})$ using the $N \\times N$ midpoint rule.\n- Computes the error $E$ for each of the specified test cases.\n\nTest suite (each tuple is $(k, a, \\theta, \\phi, N)$):\n- Case $1$: $(20.0, 0.2, 0.6, 0.0, 101)$.\n- Case $2$: $(40.0, 0.3, 1.0, \\pi/2, 121)$.\n- Case $3$: $(10.0, 0.5, 10^{-6}, 0.7, 51)$.\n- Case $4$: $(500.0, 0.2, 0.7, 1.1, 101)$.\n- Case $5$: $(100.0, 0.2, 0.4, 2.2, 11)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is the error $E$ for the corresponding test case. Angles must be interpreted in radians. The tolerance $\\varepsilon$ must be set to $\\varepsilon = 10^{-12}$. No external inputs are permitted; all constants must be defined in the program. The output must be dimensionless floating-point numbers.",
            "solution": "We begin from the Helmholtz equation for the acoustic pressure field $p(\\mathbf{x})$ with angular frequency $\\omega$ and speed of sound $c$,\n$$\n\\Delta p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0, \\quad k = \\frac{\\omega}{c},\n$$\nwith the time dependence $\\mathrm{e}^{- \\mathrm{i} \\omega t}$. A standard representation of solutions is obtained via boundary or surface source formulations. For a single-layer distribution supported on a smooth, compact surface $\\mathcal{S}$, the radiated field at $\\mathbf{x}$ is\n$$\np(\\mathbf{x}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\, G_k(\\mathbf{x},\\mathbf{y}) \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nwhere $q(\\mathbf{y})$ is the source density and $G_k(\\mathbf{x},\\mathbf{y})$ is the free-space Green's function,\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\frac{\\mathrm{e}^{\\mathrm{i} k |\\mathbf{x}-\\mathbf{y}|}}{4\\pi |\\mathbf{x}-\\mathbf{y}|}.\n$$\nFor far-field asymptotics, let $r = |\\mathbf{x}|$ and $\\hat{\\mathbf{x}} = \\mathbf{x}/r$. Using the expansion\n$$\n|\\mathbf{x} - \\mathbf{y}| = r \\left( 1 - \\frac{\\hat{\\mathbf{x}} \\cdot \\mathbf{y}}{r} + \\mathcal{O}\\!\\left(\\frac{1}{r^2}\\right) \\right),\n$$\nwe obtain\n$$\n\\frac{\\mathrm{e}^{\\mathrm{i} k |\\mathbf{x}-\\mathbf{y}|}}{|\\mathbf{x}-\\mathbf{y}|} = \\frac{\\mathrm{e}^{\\mathrm{i} k r}}{r} \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\left( 1 + \\mathcal{O}\\!\\left(\\frac{1}{r}\\right) \\right).\n$$\nTherefore, as $r \\to \\infty$,\n$$\np(\\mathbf{x}) = \\frac{\\mathrm{e}^{\\mathrm{i} k r}}{4\\pi r} \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}) + \\mathcal{O}\\!\\left(\\frac{1}{r^2}\\right).\n$$\nThis identifies the far-field amplitude $f(\\hat{\\mathbf{x}})$ (up to the factor $1/(4\\pi)$) as the oscillatory surface integral\n$$\nf(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}).\n$$\nWe adopt the normalized far-field pattern\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nwhich omits the constant prefactor.\n\nNow specialize to the square aperture $\\mathcal{S} = \\{(x,y,0): x \\in [-a/2,a/2], y \\in [-a/2,a/2]\\}$ with constant density $q(\\mathbf{y}) = 1$. Let $\\hat{\\mathbf{x}} = (\\sin \\theta \\cos \\phi, \\sin \\theta \\sin \\phi, \\cos \\theta)$. Since $\\mathbf{y} = (x,y,0)$, we have\n$$\n\\hat{\\mathbf{x}} \\cdot \\mathbf{y} = (\\sin \\theta \\cos \\phi) \\, x + (\\sin \\theta \\sin \\phi) \\, y.\n$$\nDefine the direction cosines\n$$\n\\alpha = \\sin \\theta \\cos \\phi, \\qquad \\beta = \\sin \\theta \\sin \\phi.\n$$\nThen\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{-a/2}^{a/2} \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k (\\alpha x + \\beta y)} \\,\\mathrm{d}x \\,\\mathrm{d}y.\n$$\nThis integral separates into the product of two one-dimensional integrals:\n$$\nI_x = \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k \\alpha x} \\,\\mathrm{d}x, \\qquad I_y = \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k \\beta y} \\,\\mathrm{d}y,\n$$\nso that $F(\\hat{\\mathbf{x}}) = I_x I_y$. Each integral can be evaluated exactly:\n$$\nI_x = \\frac{2 \\sin\\!\\left(\\tfrac{k \\alpha a}{2}\\right)}{k \\alpha}, \\qquad I_y = \\frac{2 \\sin\\!\\left(\\tfrac{k \\beta a}{2}\\right)}{k \\beta}.\n$$\nIntroduce the unnormalized sinc function $\\operatorname{sinc}(z) = \\frac{\\sin z}{z}$ with the convention $\\operatorname{sinc}(0) = 1$. Using $c_x = \\tfrac{k \\alpha a}{2}$ and $c_y = \\tfrac{k \\beta a}{2}$, we can rewrite\n$$\nI_x = a \\,\\operatorname{sinc}(c_x), \\qquad I_y = a \\,\\operatorname{sinc}(c_y).\n$$\nHence the exact normalized far-field pattern for the square aperture with uniform density is\n$$\nF(\\hat{\\mathbf{x}}) = a^2 \\,\\operatorname{sinc}\\!\\left(\\tfrac{k a}{2} \\sin \\theta \\cos \\phi \\right) \\,\\operatorname{sinc}\\!\\left(\\tfrac{k a}{2} \\sin \\theta \\sin \\phi \\right).\n$$\nThis formula remains well-defined when either $\\alpha = 0$ or $\\beta = 0$ by the limit $\\operatorname{sinc}(0) = 1$, which is consistent with L'Hôpital's rule.\n\nNext, we design a numerical quadrature based on an $N \\times N$ uniform midpoint rule on the square $\\mathcal{S}$. Partition each side of length $a$ into $N$ equal subintervals of width $\\Delta = a/N$. The grid cell centers are\n$$\nx_j = -\\frac{a}{2} + \\left(j - \\tfrac{1}{2}\\right) \\Delta, \\quad y_m = -\\frac{a}{2} + \\left(m - \\tfrac{1}{2}\\right) \\Delta, \\quad j,m = 1,\\dots,N,\n$$\nand each cell has area $\\Delta S = \\Delta^2$. The midpoint rule approximation evaluates the integrand at centers and sums:\n$$\nF_N(\\hat{\\mathbf{x}}) = \\sum_{j=1}^{N} \\sum_{m=1}^{N} \\mathrm{e}^{-\\mathrm{i} k (\\alpha x_j + \\beta y_m)} \\,\\Delta^2.\n$$\nBecause the integrand factors as $\\mathrm{e}^{-\\mathrm{i} k \\alpha x} \\mathrm{e}^{-\\mathrm{i} k \\beta y}$, the double sum can be computed as a product of two one-dimensional sums to improve computational efficiency:\n$$\nS_x = \\sum_{j=1}^{N} \\mathrm{e}^{-\\mathrm{i} k \\alpha x_j}, \\qquad S_y = \\sum_{m=1}^{N} \\mathrm{e}^{-\\mathrm{i} k \\beta y_m}, \\qquad F_N(\\hat{\\mathbf{x}}) = \\Delta^2 \\, S_x \\, S_y.\n$$\nFor smooth integrands, the midpoint rule achieves second-order accuracy in $\\Delta$, i.e., the error behaves like $\\mathcal{O}(\\Delta^2)$ for fixed frequency. However, for highly oscillatory integrands (large $k$ or large $|\\alpha|$, $|\\beta|$), resolving the oscillations requires $N$ sufficiently large; otherwise, aliasing induces larger errors.\n\nFor each specified test case $(k, a, \\theta, \\phi, N)$, we compute:\n- The exact analytic $F(\\hat{\\mathbf{x}})$ using the formula $F(\\hat{\\mathbf{x}}) = a^2 \\,\\operatorname{sinc}(c_x) \\,\\operatorname{sinc}(c_y)$ with $c_x = \\tfrac{k a}{2} \\sin \\theta \\cos \\phi$, $c_y = \\tfrac{k a}{2} \\sin \\theta \\sin \\phi$.\n- The numerical $F_N(\\hat{\\mathbf{x}})$ using the midpoint rule described above.\n- The absolute relative error\n$$\nE = \\begin{cases}\n\\dfrac{|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|}{|F(\\hat{\\mathbf{x}})|}, & \\text{if } |F(\\hat{\\mathbf{x}})| \\ge \\varepsilon,\\\n$$1em]\n|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|, & \\text{if } |F(\\hat{\\mathbf{x}})| < \\varepsilon,\n\\end{cases}\n$$\nwith $\\varepsilon = 10^{-12}$.\n\nAlgorithmic steps for each case:\n1. Compute $\\alpha = \\sin \\theta \\cos \\phi$, $\\beta = \\sin \\theta \\sin \\phi$.\n2. Compute the exact amplitude via the sinc-based formula; ensure numerical stability by setting $\\operatorname{sinc}(0) = 1$ when $|c_x|$ or $|c_y|$ is less than a threshold, e.g., $10^{-12}$.\n3. Build the one-dimensional midpoint nodes $x_j$ and $y_m$ and compute $S_x$ and $S_y$.\n4. Compute $F_N(\\hat{\\mathbf{x}}) = \\Delta^2 S_x S_y$.\n5. Compute the error $E$ using the rule above.\n6. Report the list of $E$ values for all cases as a single bracketed, comma-separated line.\n\nThis procedure implements near-field to far-field post-processing for a numerically discretized boundary integral by applying the far-field kernel $\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}}$, and validates the computation against an analytically derivable far-field pattern for a canonical square aperture.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef safe_sinc(z, tol=1e-12):\n    \"\"\"\n    Unnormalized sinc function: sin(z)/z with limit 1 at z=0.\n    \"\"\"\n    if np.abs(z) < tol:\n        return 1.0\n    return np.sin(z) / z\n\ndef exact_far_field(k, a, theta, phi):\n    \"\"\"\n    Exact normalized far-field pattern for a square aperture with q(y)=1:\n    F(hat{x}) = a^2 * sinc(c_x) * sinc(c_y),\n    where c_x = (k a / 2) * sin(theta) * cos(phi),\n          c_y = (k a / 2) * sin(theta) * sin(phi).\n    \"\"\"\n    alpha = np.sin(theta) * np.cos(phi)\n    beta = np.sin(theta) * np.sin(phi)\n    cx = 0.5 * k * a * alpha\n    cy = 0.5 * k * a * beta\n    return (a**2) * safe_sinc(cx) * safe_sinc(cy)\n\ndef numerical_far_field(k, a, theta, phi, N):\n    \"\"\"\n    Midpoint rule approximation of the far-field integral over the square:\n    F_N(hat{x}) = sum_{j=1}^N sum_{m=1}^N e^{-i k (alpha x_j + beta y_m)} * Delta^2,\n    with x_j, y_m being midpoints and Delta = a / N.\n    Uses separability to compute as (Delta^2) * (sum_x) * (sum_y).\n    \"\"\"\n    alpha = np.sin(theta) * np.cos(phi)\n    beta = np.sin(theta) * np.sin(phi)\n    Delta = a / N\n    # Midpoint nodes along one dimension\n    x = np.linspace(-a/2.0, a/2.0 - Delta, N) + 0.5 * Delta\n    y = x  # Same distribution for y since square and uniform grid\n    # Compute 1D sums\n    sum_x = np.sum(np.exp(-1j * k * alpha * x))\n    sum_y = np.sum(np.exp(-1j * k * beta * y))\n    return (Delta**2) * sum_x * sum_y\n\ndef compute_error(num_val, exact_val, eps=1e-12):\n    \"\"\"\n    Absolute relative error unless exact_val is near zero, in which case\n    return absolute error.\n    \"\"\"\n    exact_abs = np.abs(exact_val)\n    num_abs = np.abs(num_val)\n    if exact_abs >= eps:\n        return float(np.abs(num_val - exact_val) / exact_abs)\n    else:\n        return float(np.abs(num_val - exact_val))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (k [rad/m], a [m], theta [rad], phi [rad], N [integer])\n    test_cases = [\n        (20.0, 0.2, 0.6, 0.0, 101),              # Case 1\n        (40.0, 0.3, 1.0, np.pi/2.0, 121),        # Case 2 (alpha = 0 boundary case)\n        (10.0, 0.5, 1e-6, 0.7, 51),              # Case 3 (near axis: alpha ~ beta ~ 0)\n        (500.0, 0.2, 0.7, 1.1, 101),             # Case 4 (high frequency, modest N)\n        (100.0, 0.2, 0.4, 2.2, 11),              # Case 5 (coarse grid, moderate frequency)\n    ]\n\n    results = []\n    for k, a, theta, phi, N in test_cases:\n        exact = exact_far_field(k, a, theta, phi)\n        numeric = numerical_far_field(k, a, theta, phi, N)\n        err = compute_error(numeric, exact, eps=1e-12)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}