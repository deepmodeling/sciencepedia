{
    "hands_on_practices": [
        {
            "introduction": "Understanding the transition from the acoustic near-field to the far-field is crucial for efficient modeling. This practice explores the mathematical foundation of this transition by analyzing wave propagation from a circular piston, a canonical source in acoustics. By performing a paraxial expansion of the acoustic phase, you will identify the quadratic term that defines the Fresnel region and derive a quantitative criterion for when the simpler far-field approximation becomes valid . This exercise provides a tangible understanding of the approximations that underpin many computational and analytical techniques in wave physics.",
            "id": "4131115",
            "problem": "An axisymmetric monochromatic acoustic source is modeled as a uniformly vibrating circular piston of radius $a$ mounted in an infinite rigid baffle, radiating into a homogeneous, inviscid fluid of sound speed $c$. Let the acoustic pressure field be time-harmonic with angular frequency $\\omega$, wavenumber $k = \\omega / c$, and consider the on-axis field at a distance $z$ from the piston plane. Using the fundamental outgoing free-space Green's function for the Helmholtz equation, the radiated field can be represented as a surface integral over the piston face whose integrand contains the factor $\\exp(i k r)/r$, where $r$ is the distance from a point on the piston to the observation point.\n\nStarting from this representation and assuming the paraxial regime where the transverse radial coordinate on the piston face $\\rho$ is small compared to $z$ (that is, $\\rho/z$ is a small parameter), perform a systematic expansion of $r$ in powers of $\\rho/z$ sufficient to identify the first nontrivial phase corrections beyond the plane-wave term. Then:\n\n- Identify the term responsible for the quadratic phase that characterizes Fresnel propagation, and briefly explain its role in the near-field diffraction integral.\n- Derive a sufficient far-field condition by requiring that the next nonvanishing phase correction beyond the quadratic term has a maximum magnitude across the piston face bounded by a prescribed phase tolerance $\\phi_{\\mathrm{tol}}$.\n\nFinally, for a piston of radius $a = 2.0 \\times 10^{-2}$ m radiating at frequency $f = 2.0 \\times 10^{5}$ Hz into water where $c = 1.5 \\times 10^{3}$ m/s, and using a phase tolerance $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ radians, compute the minimal on-axis distance $z_{\\min}$ at which the higher-order phase terms beyond the quadratic phase can be neglected according to your criterion. Express your final answer in meters and round your result to three significant figures.",
            "solution": "The problem statement is first validated against the criteria of scientific soundness, well-posedness, and objectivity.\n\n### Step 1: Extract Givens\n- Acoustic source: Axisymmetric, monochromatic, uniformly vibrating circular piston of radius $a$.\n- Baffle: Infinite rigid.\n- Medium: Homogeneous, inviscid fluid with sound speed $c$.\n- Field properties: Time-harmonic with angular frequency $\\omega$, wavenumber $k = \\omega / c$.\n- Observation geometry: On-axis field at a distance $z$ from the piston plane.\n- Integral kernel: The integrand for the radiated field contains the factor $\\exp(ik r)/r$, where $r$ is the distance from a source point on the piston to the observation point.\n- Paraxial regime: The transverse radial coordinate $\\rho$ on the piston is small compared to $z$ ($\\rho/z \\ll 1$).\n- Tasks:\n  1. Expand $r$ in powers of $\\rho/z$.\n  2. Identify the quadratic phase term (Fresnel term) and explain its role.\n  3. Derive a condition for neglecting higher-order terms by bounding the next nonvanishing phase correction by a tolerance $\\phi_{\\mathrm{tol}}$.\n- Numerical values:\n  - Piston radius, $a = 2.0 \\times 10^{-2}$ m.\n  - Frequency, $f = 2.0 \\times 10^{5}$ Hz.\n  - Sound speed in water, $c = 1.5 \\times 10^{3}$ m/s.\n  - Phase tolerance, $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ radians.\n- Final objective: Compute the minimal on-axis distance $z_{\\min}$ based on the derived criterion.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a canonical problem in physical acoustics—the radiation from a baffled piston, analyzed using the Helmholtz equation and the concept of a free-space Green's function. The methods requested, namely paraxial expansion of the phase and the subsequent analysis of Fresnel and higher-order terms, are standard techniques in wave theory and diffraction. The problem is well-posed, providing all necessary information for a unique solution. The language is objective and precise. The numerical values are physically realistic for applications such as underwater acoustics or medical ultrasonics. The problem does not violate any of the specified invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Solution Derivation\n\nAn observation point on the axis of the piston at a distance $z$ has coordinates $(0, 0, z)$. A source point on the face of the piston is described in cylindrical coordinates by its radial position $\\rho$ and azimuthal angle, with coordinates $(\\rho \\cos\\theta, \\rho \\sin\\theta, 0)$, where $0 \\le \\rho \\le a$. The distance $r$ between the source point and the observation point is given by the Euclidean distance formula:\n$$r = \\sqrt{(\\rho \\cos\\theta - 0)^{2} + (\\rho \\sin\\theta - 0)^{2} + (0 - z)^{2}} = \\sqrt{\\rho^2 + z^2}$$\nTo analyze the phase term $\\exp(ikr)$ in the paraxial regime ($\\rho/z \\ll 1$), we expand $r$ in powers of $\\rho/z$. We factor out $z$:\n$$r = z \\sqrt{1 + \\left(\\frac{\\rho}{z}\\right)^2}$$\nUsing the binomial series expansion $(1+x)^{\\alpha} \\approx 1 + \\alpha x + \\frac{\\alpha(\\alpha-1)}{2!}x^2 + \\dots$ with $x = (\\rho/z)^2$ and $\\alpha = 1/2$, we get:\n$$r = z \\left[ 1 + \\frac{1}{2}\\left(\\frac{\\rho}{z}\\right)^2 + \\frac{(\\frac{1}{2})(-\\frac{1}{2})}{2}\\left(\\frac{\\rho}{z}\\right)^4 + O\\left(\\left(\\frac{\\rho}{z}\\right)^6\\right) \\right]$$\n$$r \\approx z \\left[ 1 + \\frac{\\rho^2}{2z^2} - \\frac{\\rho^4}{8z^4} \\right]$$\nDistributing the leading factor of $z$, we obtain the expansion for $r$:\n$$r \\approx z + \\frac{\\rho^2}{2z} - \\frac{\\rho^4}{8z^3}$$\nThe phase of the elementary wave from the source point at $\\rho$ is $\\phi(\\rho) = kr$. Using the expansion for $r$, the phase becomes:\n$$\\phi(\\rho) = kr \\approx kz + \\frac{k\\rho^2}{2z} - \\frac{k\\rho^4}{8z^3}$$\n\nThe first task is completed. The second task is to identify the quadratic phase term and its role.\n- The term $kz$ represents the constant phase delay associated with a plane wave propagating the distance $z$.\n- The term $\\frac{k\\rho^2}{2z}$ is the quadratic phase correction. This term is responsible for the Fresnel approximation of the diffraction integral. It accounts for the first-order deviation from a planar wavefront, modeling the wavefront from the piston as having a spherical curvature. Including this term is crucial for accurately describing the acoustic field in the near-field (or Fresnel region), where significant interference between waves from different parts of the piston face leads to characteristic oscillations in the on-axis intensity.\n\nThe third task is to derive a sufficient far-field condition. The problem defines this by requiring that the next nonvanishing phase correction beyond the quadratic term is negligible. From our expansion, this next term is the quartic phase correction:\n$$\\Delta\\phi_{\\text{quartic}}(\\rho) = - \\frac{k\\rho^4}{8z^3}$$\nThe condition for this term to be negligible is that its maximum magnitude across the piston face, which occurs at the rim where $\\rho = a$, is bounded by a given phase tolerance $\\phi_{\\mathrm{tol}}$.\n$$|\\Delta\\phi_{\\text{quartic}}(a)| \\le \\phi_{\\mathrm{tol}}$$\n$$\\left| - \\frac{ka^4}{8z^3} \\right| \\le \\phi_{\\mathrm{tol}}$$\n$$\\frac{ka^4}{8z^3} \\le \\phi_{\\mathrm{tol}}$$\nWe are asked to find the minimal distance $z_{\\min}$ for which this condition holds. This implies finding the lower bound on $z$:\n$$z^3 \\ge \\frac{ka^4}{8\\phi_{\\mathrm{tol}}}$$\n$$z \\ge \\left( \\frac{ka^4}{8\\phi_{\\mathrm{tol}}} \\right)^{1/3}$$\nTherefore, the minimal on-axis distance is:\n$$z_{\\min} = \\left( \\frac{ka^4}{8\\phi_{\\mathrm{tol}}} \\right)^{1/3}$$\nThis condition defines the transition from the very-near-field, where quartic and potentially higher-order phase terms are significant, to the Fresnel region, where the quadratic phase term provides a sufficient description of diffraction effects.\n\nFinally, we compute the numerical value of $z_{\\min}$ using the provided data.\n- Radius, $a = 2.0 \\times 10^{-2}$ m.\n- Frequency, $f = 2.0 \\times 10^{5}$ Hz.\n- Sound speed, $c = 1.5 \\times 10^{3}$ m/s.\n- Phase tolerance, $\\phi_{\\mathrm{tol}} = 1.0 \\times 10^{-1}$ rad.\n\nFirst, we calculate the wavenumber $k$:\n$$k = \\frac{\\omega}{c} = \\frac{2\\pi f}{c} = \\frac{2\\pi (2.0 \\times 10^{5})}{1.5 \\times 10^{3}} = \\frac{4.0\\pi \\times 10^5}{1.5 \\times 10^3} = \\frac{8\\pi}{3} \\times 10^2 \\text{ m}^{-1}$$\nNow, we substitute the values into the expression for $z_{\\min}$:\n$$z_{\\min} = \\left( \\frac{(\\frac{8\\pi}{3} \\times 10^2) (2.0 \\times 10^{-2})^4}{8(1.0 \\times 10^{-1})} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{(\\frac{8\\pi}{3} \\times 10^2) (16.0 \\times 10^{-8})}{0.8} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{\\frac{128\\pi}{3} \\times 10^{-6}}{0.8} \\right)^{1/3} = \\left( \\frac{128\\pi}{3 \\times 0.8} \\times 10^{-6} \\right)^{1/3}$$\n$$z_{\\min} = \\left( \\frac{128\\pi}{2.4} \\times 10^{-6} \\right)^{1/3} = \\left( \\frac{160\\pi}{3} \\times 10^{-6} \\right)^{1/3}$$\nNow, we compute the numerical value:\n$$\\frac{160\\pi}{3} \\approx \\frac{160 \\times 3.14159265}{3} \\approx 167.5516$$\nSo,\n$$z_{\\min} \\approx \\left( 167.5516 \\times 10^{-6} \\right)^{1/3} \\text{ m}$$\n$$z_{\\min} \\approx (167.5516)^{1/3} \\times (10^{-6})^{1/3} \\text{ m} \\approx 5.513 \\times 10^{-2} \\text{ m}$$\nRounding the result to three significant figures, we get:\n$$z_{\\min} \\approx 5.51 \\times 10^{-2} \\text{ m}$$",
            "answer": "$$\\boxed{5.51 \\times 10^{-2}}$$"
        },
        {
            "introduction": "In computational acoustics, we often compute field data on a surface enclosing a source and then need to project this information into the far-field. This practice directly addresses this common task by demonstrating that the far-field pattern is fundamentally a Fourier transform of the source distribution on a surface. You will first derive the classic analytical far-field pattern for a uniform square aperture and then implement a numerical quadrature to approximate the same result . This provides invaluable hands-on experience in translating a continuous integral representation into a discrete computational algorithm, a core skill in the field.",
            "id": "4131235",
            "problem": "You are given a time-harmonic acoustic field governed by the Helmholtz equation in three-dimensional (3D) space for angular frequency $\\omega$, speed of sound $c$, and wavenumber $k = \\omega/c$. Consider a compact, planar square aperture $\\mathcal{S} \\subset \\mathbb{R}^3$ located in the plane $z = 0$, centered at the origin, with side length $a  0$. The aperture supports a single-layer source density $q(\\mathbf{y})$ with $\\mathbf{y} = (x,y,0) \\in \\mathcal{S}$, and adopt the time convention $\\mathrm{e}^{- \\mathrm{i} \\omega t}$. Let the observation direction be $\\hat{\\mathbf{x}} = (\\sin \\theta \\cos \\phi, \\sin \\theta \\sin \\phi, \\cos \\theta)$, where $\\theta$ is the polar angle and $\\phi$ is the azimuthal angle, both expressed in radians.\n\nStarting from the Helmholtz equation and the fundamental solution representation for time-harmonic acoustics, use far-field asymptotics to justify that the normalized far-field pattern in direction $\\hat{\\mathbf{x}}$ can be obtained by post-processing the surface data via an oscillatory integral of the form\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nup to a direction-independent multiplicative constant. For the specific case where $q(\\mathbf{y}) = 1$ on the square aperture $\\mathcal{S} = \\{(x,y,0) : x \\in [-a/2,a/2], y \\in [-a/2,a/2]\\}$, analytically evaluate $F(\\hat{\\mathbf{x}})$ in terms of $k$, $a$, $\\theta$, and $\\phi$.\n\nThen, design a numerical quadrature that approximates $F(\\hat{\\mathbf{x}})$ by discretizing $\\mathcal{S}$ with an $N \\times N$ uniform midpoint rule, where $N$ is a positive integer. The numerical approximation must be computed as\n$$\nF_N(\\hat{\\mathbf{x}}) = \\sum_{j=1}^{N} \\sum_{m=1}^{N} q(\\mathbf{y}_{j,m}) \\,\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}_{j,m}} \\,\\Delta S,\n$$\nwhere $\\mathbf{y}_{j,m}$ are the cell center points on the square grid and $\\Delta S$ is the area of each grid cell. Your program must compute $F_N(\\hat{\\mathbf{x}})$ and compare it against the exact analytic $F(\\hat{\\mathbf{x}})$ that you derived. Report the absolute relative error\n$$\nE = \\frac{|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|}{|F(\\hat{\\mathbf{x}})|},\n$$\nand, to avoid division by zero, if $|F(\\hat{\\mathbf{x}})|  \\varepsilon$ for a small tolerance $\\varepsilon$, report $E = |F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|$.\n\nAll physical quantities must use the following units: $k$ in $\\mathrm{rad/m}$, $a$ in $\\mathrm{m}$, angles $\\theta$ and $\\phi$ in radians. The reported error $E$ is dimensionless. For the numerical quadrature, use a uniform square grid and the midpoint rule on each cell. The far-field kernel is $\\mathrm{e}^{- \\mathrm{i} k \\,\\hat{\\mathbf{x}} \\cdot \\mathbf{y}}$.\n\nImplement a complete program that:\n- Computes the analytic $F(\\hat{\\mathbf{x}})$ for the square aperture with $q(\\mathbf{y}) = 1$.\n- Computes the numerical $F_N(\\hat{\\mathbf{x}})$ using the $N \\times N$ midpoint rule.\n- Computes the error $E$ for each of the specified test cases.\n\nTest suite (each tuple is $(k, a, \\theta, \\phi, N)$):\n- Case $1$: $(20.0, 0.2, 0.6, 0.0, 101)$.\n- Case $2$: $(40.0, 0.3, 1.0, \\pi/2, 121)$.\n- Case $3$: $(10.0, 0.5, 10^{-6}, 0.7, 51)$.\n- Case $4$: $(500.0, 0.2, 0.7, 1.1, 101)$.\n- Case $5$: $(100.0, 0.2, 0.4, 2.2, 11)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is the error $E$ for the corresponding test case. Angles must be interpreted in radians. The tolerance $\\varepsilon$ must be set to $\\varepsilon = 10^{-12}$. No external inputs are permitted; all constants must be defined in the program. The output must be dimensionless floating-point numbers.",
            "solution": "We begin from the Helmholtz equation for the acoustic pressure field $p(\\mathbf{x})$ with angular frequency $\\omega$ and speed of sound $c$,\n$$\n\\Delta p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0, \\quad k = \\frac{\\omega}{c},\n$$\nwith the time dependence $\\mathrm{e}^{- \\mathrm{i} \\omega t}$. A standard representation of solutions is obtained via boundary or surface source formulations. For a single-layer distribution supported on a smooth, compact surface $\\mathcal{S}$, the radiated field at $\\mathbf{x}$ is\n$$\np(\\mathbf{x}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\, G_k(\\mathbf{x},\\mathbf{y}) \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nwhere $q(\\mathbf{y})$ is the source density and $G_k(\\mathbf{x},\\mathbf{y})$ is the free-space Green's function,\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\frac{\\mathrm{e}^{\\mathrm{i} k |\\mathbf{x}-\\mathbf{y}|}}{4\\pi |\\mathbf{x}-\\mathbf{y}|}.\n$$\nFor far-field asymptotics, let $r = |\\mathbf{x}|$ and $\\hat{\\mathbf{x}} = \\mathbf{x}/r$. Using the expansion\n$$\n|\\mathbf{x} - \\mathbf{y}| = r \\left( 1 - \\frac{\\hat{\\mathbf{x}} \\cdot \\mathbf{y}}{r} + \\mathcal{O}\\!\\left(\\frac{1}{r^2}\\right) \\right),\n$$\nwe obtain\n$$\n\\frac{\\mathrm{e}^{\\mathrm{i} k |\\mathbf{x}-\\mathbf{y}|}}{|\\mathbf{x}-\\mathbf{y}|} = \\frac{\\mathrm{e}^{\\mathrm{i} k r}}{r} \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\left( 1 + \\mathcal{O}\\!\\left(\\frac{1}{r}\\right) \\right).\n$$\nTherefore, as $r \\to \\infty$,\n$$\np(\\mathbf{x}) = \\frac{\\mathrm{e}^{\\mathrm{i} k r}}{4\\pi r} \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}) + \\mathcal{O}\\!\\left(\\frac{1}{r^2}\\right).\n$$\nThis identifies the far-field amplitude $f(\\hat{\\mathbf{x}})$ (up to the factor $1/(4\\pi)$) as the oscillatory surface integral\n$$\nf(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}).\n$$\nWe adopt the normalized far-field pattern\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{\\mathcal{S}} q(\\mathbf{y}) \\,\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}} \\,\\mathrm{d}S(\\mathbf{y}),\n$$\nwhich omits the constant prefactor.\n\nNow specialize to the square aperture $\\mathcal{S} = \\{(x,y,0): x \\in [-a/2,a/2], y \\in [-a/2,a/2]\\}$ with constant density $q(\\mathbf{y}) = 1$. Let $\\hat{\\mathbf{x}} = (\\sin \\theta \\cos \\phi, \\sin \\theta \\sin \\phi, \\cos \\theta)$. Since $\\mathbf{y} = (x,y,0)$, we have\n$$\n\\hat{\\mathbf{x}} \\cdot \\mathbf{y} = (\\sin \\theta \\cos \\phi) \\, x + (\\sin \\theta \\sin \\phi) \\, y.\n$$\nDefine the direction cosines\n$$\n\\alpha = \\sin \\theta \\cos \\phi, \\qquad \\beta = \\sin \\theta \\sin \\phi.\n$$\nThen\n$$\nF(\\hat{\\mathbf{x}}) = \\int_{-a/2}^{a/2} \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k (\\alpha x + \\beta y)} \\,\\mathrm{d}x \\,\\mathrm{d}y.\n$$\nThis integral separates into the product of two one-dimensional integrals:\n$$\nI_x = \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k \\alpha x} \\,\\mathrm{d}x, \\qquad I_y = \\int_{-a/2}^{a/2} \\mathrm{e}^{-\\mathrm{i} k \\beta y} \\,\\mathrm{d}y,\n$$\nso that $F(\\hat{\\mathbf{x}}) = I_x I_y$. Each integral can be evaluated exactly:\n$$\nI_x = \\frac{2 \\sin\\!\\left(\\tfrac{k \\alpha a}{2}\\right)}{k \\alpha}, \\qquad I_y = \\frac{2 \\sin\\!\\left(\\tfrac{k \\beta a}{2}\\right)}{k \\beta}.\n$$\nIntroduce the unnormalized sinc function $\\operatorname{sinc}(z) = \\frac{\\sin z}{z}$ with the convention $\\operatorname{sinc}(0) = 1$. Using $c_x = \\tfrac{k \\alpha a}{2}$ and $c_y = \\tfrac{k \\beta a}{2}$, we can rewrite\n$$\nI_x = a \\,\\operatorname{sinc}(c_x), \\qquad I_y = a \\,\\operatorname{sinc}(c_y).\n$$\nHence the exact normalized far-field pattern for the square aperture with uniform density is\n$$\nF(\\hat{\\mathbf{x}}) = a^2 \\,\\operatorname{sinc}\\!\\left(\\tfrac{k a}{2} \\sin \\theta \\cos \\phi \\right) \\,\\operatorname{sinc}\\!\\left(\\tfrac{k a}{2} \\sin \\theta \\sin \\phi \\right).\n$$\nThis formula remains well-defined when either $\\alpha = 0$ or $\\beta = 0$ by the limit $\\operatorname{sinc}(0) = 1$, which is consistent with L'Hôpital's rule.\n\nNext, we design a numerical quadrature based on an $N \\times N$ uniform midpoint rule on the square $\\mathcal{S}$. Partition each side of length $a$ into $N$ equal subintervals of width $\\Delta = a/N$. The grid cell centers are\n$$\nx_j = -\\frac{a}{2} + \\left(j - \\tfrac{1}{2}\\right) \\Delta, \\quad y_m = -\\frac{a}{2} + \\left(m - \\tfrac{1}{2}\\right) \\Delta, \\quad j,m = 1,\\dots,N,\n$$\nand each cell has area $\\Delta S = \\Delta^2$. The midpoint rule approximation evaluates the integrand at centers and sums:\n$$\nF_N(\\hat{\\mathbf{x}}) = \\sum_{j=1}^{N} \\sum_{m=1}^{N} \\mathrm{e}^{-\\mathrm{i} k (\\alpha x_j + \\beta y_m)} \\,\\Delta^2.\n$$\nBecause the integrand factors as $\\mathrm{e}^{-\\mathrm{i} k \\alpha x} \\mathrm{e}^{-\\mathrm{i} k \\beta y}$, the double sum can be computed as a product of two one-dimensional sums to improve computational efficiency:\n$$\nS_x = \\sum_{j=1}^{N} \\mathrm{e}^{-\\mathrm{i} k \\alpha x_j}, \\qquad S_y = \\sum_{m=1}^{N} \\mathrm{e}^{-\\mathrm{i} k \\beta y_m}, \\qquad F_N(\\hat{\\mathbf{x}}) = \\Delta^2 \\, S_x \\, S_y.\n$$\nFor smooth integrands, the midpoint rule achieves second-order accuracy in $\\Delta$, i.e., the error behaves like $\\mathcal{O}(\\Delta^2)$ for fixed frequency. However, for highly oscillatory integrands (large $k$ or large $|\\alpha|$, $|\\beta|$), resolving the oscillations requires $N$ sufficiently large; otherwise, aliasing induces larger errors.\n\nFor each specified test case $(k, a, \\theta, \\phi, N)$, we compute:\n- The exact analytic $F(\\hat{\\mathbf{x}})$ using the formula $F(\\hat{\\mathbf{x}}) = a^2 \\,\\operatorname{sinc}(c_x) \\,\\operatorname{sinc}(c_y)$ with $c_x = \\tfrac{k a}{2} \\sin \\theta \\cos \\phi$, $c_y = \\tfrac{k a}{2} \\sin \\theta \\sin \\phi$.\n- The numerical $F_N(\\hat{\\mathbf{x}})$ using the midpoint rule described above.\n- The absolute relative error\n$$\nE = \\begin{cases}\n\\dfrac{|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|}{|F(\\hat{\\mathbf{x}})|},  \\text{if } |F(\\hat{\\mathbf{x}})| \\ge \\varepsilon,\\\n$$1em]\n|F_N(\\hat{\\mathbf{x}}) - F(\\hat{\\mathbf{x}})|,  \\text{if } |F(\\hat{\\mathbf{x}})|  \\varepsilon,\n\\end{cases}\n$$\nwith $\\varepsilon = 10^{-12}$.\n\nAlgorithmic steps for each case:\n1. Compute $\\alpha = \\sin \\theta \\cos \\phi$, $\\beta = \\sin \\theta \\sin \\phi$.\n2. Compute the exact amplitude via the sinc-based formula; ensure numerical stability by setting $\\operatorname{sinc}(0) = 1$ when $|c_x|$ or $|c_y|$ is less than a threshold, e.g., $10^{-12}$.\n3. Build the one-dimensional midpoint nodes $x_j$ and $y_m$ and compute $S_x$ and $S_y$.\n4. Compute $F_N(\\hat{\\mathbf{x}}) = \\Delta^2 S_x S_y$.\n5. Compute the error $E$ using the rule above.\n6. Report the list of $E$ values for all cases as a single bracketed, comma-separated line.\n\nThis procedure implements near-field to far-field post-processing for a numerically discretized boundary integral by applying the far-field kernel $\\mathrm{e}^{-\\mathrm{i} k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}}$, and validates the computation against an analytically derivable far-field pattern for a canonical square aperture.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef safe_sinc(z, tol=1e-12):\n    \"\"\"\n    Unnormalized sinc function: sin(z)/z with limit 1 at z=0.\n    \"\"\"\n    if np.abs(z)  tol:\n        return 1.0\n    return np.sin(z) / z\n\ndef exact_far_field(k, a, theta, phi):\n    \"\"\"\n    Exact normalized far-field pattern for a square aperture with q(y)=1:\n    F(hat{x}) = a^2 * sinc(c_x) * sinc(c_y),\n    where c_x = (k a / 2) * sin(theta) * cos(phi),\n          c_y = (k a / 2) * sin(theta) * sin(phi).\n    \"\"\"\n    alpha = np.sin(theta) * np.cos(phi)\n    beta = np.sin(theta) * np.sin(phi)\n    cx = 0.5 * k * a * alpha\n    cy = 0.5 * k * a * beta\n    return (a**2) * safe_sinc(cx) * safe_sinc(cy)\n\ndef numerical_far_field(k, a, theta, phi, N):\n    \"\"\"\n    Midpoint rule approximation of the far-field integral over the square:\n    F_N(hat{x}) = sum_{j=1}^N sum_{m=1}^N e^{-i k (alpha x_j + beta y_m)} * Delta^2,\n    with x_j, y_m being midpoints and Delta = a / N.\n    Uses separability to compute as (Delta^2) * (sum_x) * (sum_y).\n    \"\"\"\n    alpha = np.sin(theta) * np.cos(phi)\n    beta = np.sin(theta) * np.sin(phi)\n    Delta = a / N\n    # Midpoint nodes along one dimension\n    x = np.linspace(-a/2.0, a/2.0 - Delta, N) + 0.5 * Delta\n    y = x  # Same distribution for y since square and uniform grid\n    # Compute 1D sums\n    sum_x = np.sum(np.exp(-1j * k * alpha * x))\n    sum_y = np.sum(np.exp(-1j * k * beta * y))\n    return (Delta**2) * sum_x * sum_y\n\ndef compute_error(num_val, exact_val, eps=1e-12):\n    \"\"\"\n    Absolute relative error unless exact_val is near zero, in which case\n    return absolute error.\n    \"\"\"\n    exact_abs = np.abs(exact_val)\n    num_abs = np.abs(num_val)\n    if exact_abs = eps:\n        return float(np.abs(num_val - exact_val) / exact_abs)\n    else:\n        return float(np.abs(num_val - exact_val))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (k [rad/m], a [m], theta [rad], phi [rad], N [integer])\n    test_cases = [\n        (20.0, 0.2, 0.6, 0.0, 101),              # Case 1\n        (40.0, 0.3, 1.0, np.pi/2.0, 121),        # Case 2 (alpha = 0 boundary case)\n        (10.0, 0.5, 1e-6, 0.7, 51),              # Case 3 (near axis: alpha ~ beta ~ 0)\n        (500.0, 0.2, 0.7, 1.1, 101),             # Case 4 (high frequency, modest N)\n        (100.0, 0.2, 0.4, 2.2, 11),              # Case 5 (coarse grid, moderate frequency)\n    ]\n\n    results = []\n    for k, a, theta, phi, N in test_cases:\n        exact = exact_far_field(k, a, theta, phi)\n        numeric = numerical_far_field(k, a, theta, phi, N)\n        err = compute_error(numeric, exact, eps=1e-12)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A critical skill for any computational scientist is the ability to quantify and interpret the errors in their numerical simulations. This exercise introduces a rigorous framework for analyzing the accuracy of far-field extraction from numerical data . By working with a synthetic data model that includes both physical near-field effects and numerical discretization errors, you will learn to define a meaningful error metric and use it to compute the observed convergence rate of your method. This practice is essential for developing the ability to distinguish numerical artifacts from physical phenomena and for validating the results of complex acoustic simulations.",
            "id": "4131155",
            "problem": "Consider a time-harmonic acoustic pressure field that satisfies the reduced Helmholtz equation outside a compact source region, which is a well-tested model in acoustics. Let the wavenumber be $k  0$, the observation point be $\\mathbf{x}$ with radius $r = \\|\\mathbf{x}\\|$, and the direction be $\\hat{\\mathbf{x}} = \\mathbf{x} / \\|\\mathbf{x}\\|$. For radiating solutions, it is a widely accepted fact that for large $r$, the field admits an asymptotic expansion of the form $p(\\mathbf{x}) = \\frac{e^{ikr}}{r} f(\\hat{\\mathbf{x}}) + \\text{lower-order terms in } r^{-1}$. In computational practice, a discrete numerical solution with mesh size $h$ approximates the field on a spherical measurement surface of radius $R  0$. Assume that the dominant discretization error scales like $h^{p}$ for some $p  0$. The goal is to define a rotationally invariant far-field extraction error metric by comparing the numerical data against the leading-order far-field model $\\frac{e^{ikr}}{r} f(\\hat{\\mathbf{x}})$, and to compute the observed convergence rate with mesh refinement.\n\nYou must proceed from the following valid and broadly used bases:\n\n- The time-harmonic acoustic field satisfies the reduced Helmholtz equation outside sources, and outgoing radiating solutions have the large-radius behavior $p(\\mathbf{x}) = \\frac{e^{ikr}}{r} f(\\hat{\\mathbf{x}}) + \\mathcal{O}(r^{-2})$.\n- For a stable and consistent numerical method of order $p$ (for example, a method whose truncation error scales as $h^{p}$), the leading discretization error contribution in a smooth regime scales as $h^{p}$ as $h \\to 0$.\n\nDefine the far-field extraction error metric $E(h)$ at a fixed radius $R$ as the root-mean-square (RMS) difference over the unit sphere between the numerical data and the leading-order far-field model, namely\n$$\nE(h) \\equiv \\left(\\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} \\left| p_{h}\\!\\left(R,\\hat{\\mathbf{x}}\\right) - \\frac{e^{ikR}}{R} f(\\hat{\\mathbf{x}}) \\right|^{2} \\, d\\Omega(\\hat{\\mathbf{x}}) \\right)^{1/2},\n$$\nwhere $d\\Omega$ is the solid-angle measure. All angles must be interpreted and used in radians.\n\nTo make the problem strictly quantitative and self-contained, assume a synthetic but scientifically consistent model for the numerical data on the observation sphere:\n$$\np_{h}\\!\\left(R,\\hat{\\mathbf{x}}\\right) = \\frac{e^{ikR}}{R}\\left[f(\\hat{\\mathbf{x}}) + \\frac{B}{kR} \\, g(\\hat{\\mathbf{x}}) + C \\, h^{p}\\, s(\\hat{\\mathbf{x}})\\right],\n$$\nwhere $B \\ge 0$ and $C \\ge 0$ are constants that modulate, respectively, a physical near-field contamination term proportional to $(kR)^{-1}$ and a discretization-error angular mode that scales with $h^{p}$. Use the following smooth angular patterns on the unit sphere, parameterized by polar angle $\\theta \\in [0,\\pi]$ and azimuthal angle $\\phi \\in [0,2\\pi)$ (in radians):\n- Far-field pattern:\n$$\nf(\\theta,\\phi) = 1 + 0.5\\cos\\theta + 0.2 \\sin^{2}\\theta \\cos(2\\phi).\n$$\n- Near-field angular content:\n$$\ng(\\theta,\\phi) = \\cos\\theta - 0.3 \\sin\\theta \\cos\\phi.\n$$\n- Discretization-error angular content:\n$$\ns(\\theta,\\phi) = \\sin\\theta \\cos\\phi + 0.25 \\cos(2\\theta).\n$$\n\nYour program must:\n1. Compute $E(h)$ for a sequence of four mesh sizes $h \\in \\{0.2, 0.1, 0.05, 0.025\\}$ using a numerically stable, rotationally invariant quadrature on the unit sphere. Use a tensor-product quadrature with:\n   - Gauss–Legendre nodes in $\\mu = \\cos\\theta$ with $N_{\\mu} = 64$ points,\n   - Equally spaced trapezoidal nodes in $\\phi$ with $N_{\\phi} = 128$ points.\n   Implement the integral\n   $$\n   \\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} q(\\theta,\\phi)\\, d\\Omega\n   =\n   \\frac{1}{4\\pi}\\int_{0}^{2\\pi}\\int_{-1}^{1} q(\\arccos\\mu,\\phi)\\, d\\mu\\, d\\phi\n   \\approx\n   \\frac{1}{4\\pi}\\sum_{i=1}^{N_{\\mu}} \\sum_{j=1}^{N_{\\phi}} q(\\theta_{i},\\phi_{j})\\, w_{i}\\, \\Delta\\phi,\n   $$\n   where $\\{(\\mu_{i},w_{i})\\}$ are Gauss–Legendre nodes and weights on $[-1,1]$, $\\theta_{i} = \\arccos\\mu_{i}$, and $\\Delta\\phi = \\frac{2\\pi}{N_{\\phi}}$.\n2. Estimate the observed convergence rate $\\hat{\\alpha}$ by a linear least-squares fit of $\\log E(h)$ versus $\\log h$ across the four mesh sizes, that is, fit $\\log E(h) \\approx \\beta + \\hat{\\alpha} \\log h$.\n3. Produce the final output as a single line containing a list of the estimated convergence rates for each test case, rounded to three decimals, with no spaces.\n\nTest Suite:\nFor each parameter set below, compute and report the estimated convergence rate $\\hat{\\alpha}$:\n- Case A (happy path, no near-field contamination): $k = 15$, $R = 40$, $p = 3.0$, $B = 0.0$, $C = 0.3$.\n- Case B (small near-field, mostly $h^{p}$ scaling): $k = 20$, $R = 60$, $p = 2.0$, $B = 0.1$, $C = 0.5$.\n- Case C (near-field dominates at fine meshes, plateau expected): $k = 10$, $R = 12$, $p = 2.0$, $B = 1.0$, $C = 0.2$.\n- Case D (fractional-order method, no near-field): $k = 1$, $R = 50$, $p = 1.5$, $B = 0.0$, $C = 0.4$.\n- Case E (moderate near-field influence): $k = 30$, $R = 10$, $p = 2.0$, $B = 0.2$, $C = 0.4$.\n\nAngle units must be in radians. No physical unit conversions are required beyond those specified. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[x1,x2,x3,x4,x5]\". Each $x_{i}$ must be the corresponding $\\hat{\\alpha}$ for the $i$-th test case, rounded to three decimals, expressed as a decimal number without a percentage sign.",
            "solution": "The core task is to compute an observed order of convergence, $\\hat{\\alpha}$, for a synthetic numerical solution to the Helmholtz equation. This involves evaluating a specified error metric, $E(h)$, for a sequence of mesh sizes, $h$, and then determining the slope of the relationship between $\\log E(h)$ and $\\log h$.\n\nFirst, let's analyze the error metric $E(h)$. It is defined as the root-mean-square difference between the numerical data, $p_h(R, \\hat{\\mathbf{x}})$, and the leading-order far-field model, $p_{\\text{ff}}(R, \\hat{\\mathbf{x}}) = \\frac{e^{ikR}}{R} f(\\hat{\\mathbf{x}})$, integrated over a sphere of radius $R$.\n$$\nE(h) = \\left(\\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} \\left| p_{h}\\!\\left(R,\\hat{\\mathbf{x}}\\right) - \\frac{e^{ikR}}{R} f(\\hat{\\mathbf{x}}) \\right|^{2} \\, d\\Omega(\\hat{\\mathbf{x}}) \\right)^{1/2}\n$$\nThe problem provides a synthetic model for the numerical data:\n$$\np_{h}\\!\\left(R,\\hat{\\mathbf{x}}\\right) = \\frac{e^{ikR}}{R}\\left[f(\\hat{\\mathbf{x}}) + \\frac{B}{kR} \\, g(\\hat{\\mathbf{x}}) + C \\, h^{p}\\, s(\\hat{\\mathbf{x}})\\right]\n$$\nSubstituting this into the error definition, the difference term becomes:\n$$\np_{h}\\!\\left(R,\\hat{\\mathbf{x}}\\right) - \\frac{e^{ikR}}{R} f(\\hat{\\mathbf{x}}) = \\frac{e^{ikR}}{R} \\left( \\frac{B}{kR} g(\\hat{\\mathbf{x}}) + C h^p s(\\hat{\\mathbf{x}}) \\right)\n$$\nThe squared absolute value of this difference is:\n$$\n\\left| p_{h} - p_{\\text{ff}} \\right|^2 = \\left| \\frac{e^{ikR}}{R} \\right|^2 \\left| \\frac{B}{kR} g(\\hat{\\mathbf{x}}) + C h^p s(\\hat{\\mathbf{x}}) \\right|^2 = \\frac{1}{R^2} \\left(\\frac{B}{kR} g(\\hat{\\mathbf{x}}) + C h^p s(\\hat{\\mathbf{x}}) \\right)^2\n$$\nHere, we have used the fact that $|e^{ikR}|=1$ for real $k$ and $R$, and that all other quantities ($B, k, R, C, h, p$, and the functions $g$ and $s$) are real-valued.\n\nThe squared error metric, $E(h)^2$, is the average of this quantity over the unit sphere:\n$$\nE(h)^2 = \\frac{1}{4\\pi R^2} \\int_{\\mathbb{S}^{2}} \\left(\\frac{B}{kR} g(\\hat{\\mathbf{x}}) + C h^p s(\\hat{\\mathbf{x}}) \\right)^2 d\\Omega(\\hat{\\mathbf{x}})\n$$\nExpanding the squared term inside the integral yields:\n$$\n\\left(\\frac{B}{kR} g + C h^p s \\right)^2 = \\left(\\frac{B}{kR}\\right)^2 g^2 + 2 \\frac{B C h^p}{kR} gs + (C h^p)^2 s^2\n$$\nDue to the linearity of integration, we can express $E(h)^2$ in terms of three fundamental integrals that are independent of the test case parameters and the mesh size $h$:\n- $I_{gg} = \\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} g(\\hat{\\mathbf{x}})^2 d\\Omega$\n- $I_{ss} = \\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} s(\\hat{\\mathbf{x}})^2 d\\Omega$\n- $I_{gs} = \\frac{1}{4\\pi}\\int_{\\mathbb{S}^{2}} g(\\hat{\\mathbf{x}}) s(\\hat{\\mathbf{x}}) d\\Omega$\n\nWith these definitions, the expression for the squared error simplifies to a polynomial in $h^p$:\n$$\nE(h)^2 = \\frac{1}{R^2} \\left[ \\left(\\frac{B}{kR}\\right)^2 I_{gg} + 2 \\frac{B C h^p}{kR} I_{gs} + C^2 I_{ss} h^{2p} \\right]\n$$\nThis structure reveals the interplay between the physical near-field error (the term with $B$) and the numerical discretization error (the term with $C$).\n- When $h$ is large, the term proportional to $h^{2p}$ dominates, and thus $E(h) \\approx \\frac{C \\sqrt{I_{ss}}}{R} h^p$. On a log-log scale, this corresponds to a line with slope $p$.\n- When $h \\to 0$, the error approaches a constant floor if $B  0$, $E(h) \\to \\frac{B \\sqrt{I_{gg}}}{kR^2}$. On a log-log scale, this corresponds to a horizontal line with slope $0$.\n\nThe overall observed convergence rate $\\hat{\\alpha}$ is estimated by fitting a line to the pairs $(\\log h, \\log E(h))$ for the given sequence of $h$ values. This rate will therefore represent an average slope over the specified range of $h$, and will fall somewhere between $0$ and $p$, depending on the relative magnitudes of the near-field and discretization error contributions.\n\nThe implementation plan is as follows:\n1.  **Pre-compute Integrals**: The integrals $I_{gg}$, $I_{ss}$, and $I_{gs}$ are constant for all test cases. They will be computed once using the specified numerical quadrature scheme. The scheme involves a tensor product of Gauss-Legendre quadrature for the polar variable $\\mu = \\cos\\theta$ and the trapezoidal rule for the azimuthal variable $\\phi$.\n    - We generate $N_\\mu = 64$ Gauss-Legendre nodes $\\mu_i$ and weights $w_i$ on $[-1, 1]$. The polar angles are $\\theta_i = \\arccos(\\mu_i)$.\n    - We generate $N_\\phi = 128$ equally spaced azimuthal angles $\\phi_j$ in $[0, 2\\pi)$, with step size $\\Delta\\phi = 2\\pi/N_\\phi$.\n    - The integral of a function $q(\\theta, \\phi)$ is approximated by: $\\frac{1}{4\\pi} \\sum_{i=1}^{N_{\\mu}} \\sum_{j=1}^{N_{\\phi}} q(\\theta_i, \\phi_j) w_i \\Delta\\phi$.\n\n2.  **Process Test Cases**: For each test case defined by the parameters $(k, R, p, B, C)$:\n    - A sequence of four mesh sizes $h \\in \\{0.2, 0.1, 0.05, 0.025\\}$ is used.\n    - For each $h$, the error $E(h)$ is calculated using the formula derived above with the pre-computed integrals.\n    - This yields a set of four error values corresponding to the four mesh sizes.\n\n3.  **Estimate Convergence Rate**:\n    - The natural logarithm of the mesh sizes, $\\log h$, and the error values, $\\log E(h)$, are computed.\n    - A linear least-squares fit is performed to find the slope $\\hat{\\alpha}$ of the line that best fits the\n      $(\\log h, \\log E(h))$ data. This is achieved using `numpy.polyfit` with degree $1$.\n\n4.  **Format Output**: The calculated rate $\\hat{\\alpha}$ for each case is rounded to three decimal places and collected into a list. The final output is a single string containing this list in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the observed convergence rate of a far-field extraction error metric\n    for a set of test cases in computational acoustics.\n    \"\"\"\n\n    # Define the angular pattern functions based on the problem statement.\n    # Angles theta and phi are expected in radians.\n    def g_func(theta, phi):\n        \"\"\"Near-field angular content.\"\"\"\n        return np.cos(theta) - 0.3 * np.sin(theta) * np.cos(phi)\n\n    def s_func(theta, phi):\n        \"\"\"Discretization-error angular content.\"\"\"\n        return np.sin(theta) * np.cos(phi) + 0.25 * np.cos(2 * theta)\n    \n    # 1. Pre-compute constant integrals I_gg, I_ss, I_gs using numerical quadrature.\n    \n    # Quadrature parameters\n    N_mu = 64\n    N_phi = 128\n    \n    # Gauss-Legendre quadrature for the polar angle integration over mu = cos(theta)\n    mu_nodes, mu_weights = np.polynomial.legendre.leggauss(N_mu)\n    theta_nodes = np.arccos(mu_nodes)\n    \n    # Trapezoidal rule for the azimuthal angle integration over phi\n    phi_nodes = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n    d_phi = 2 * np.pi / N_phi\n    \n    # Create a 2D grid of quadrature points\n    # Use 'ij' indexing to match summation order: sum_i(w_i * sum_j(f_ij * d_phi))\n    theta_grid, phi_grid = np.meshgrid(theta_nodes, phi_nodes, indexing='ij')\n    \n    # Evaluate the angular functions g and s on the grid\n    g_values = g_func(theta_grid, phi_grid)\n    s_values = s_func(theta_grid, phi_grid)\n    \n    # Define a helper function for the spherical quadrature\n    def integrate_on_sphere(integrand_grid):\n        \"\"\"\n        Computes the integral (1/4pi) * int(f dOmega) using the specified quadrature rule.\n        \"\"\"\n        # Sum over phi dimension (axis=1) using trapezoidal rule (constant weights d_phi)\n        phi_integral = np.sum(integrand_grid, axis=1) * d_phi\n        # Sum over mu/theta dimension (axis=0) using Gauss-Legendre weights\n        mu_integral = np.dot(mu_weights, phi_integral)\n        return mu_integral / (4 * np.pi)\n\n    # Compute the three necessary integrals\n    I_gg = integrate_on_sphere(g_values**2)\n    I_ss = integrate_on_sphere(s_values**2)\n    I_gs = integrate_on_sphere(g_values * s_values)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k, R, p, B, C)\n        (15, 40, 3.0, 0.0, 0.3),   # Case A\n        (20, 60, 2.0, 0.1, 0.5),   # Case B\n        (10, 12, 2.0, 1.0, 0.2),   # Case C\n        (1, 50, 1.5, 0.0, 0.4),    # Case D\n        (30, 10, 2.0, 0.2, 0.4),   # Case E\n    ]\n    \n    h_vals = np.array([0.2, 0.1, 0.05, 0.025])\n    log_h = np.log(h_vals)\n    \n    estimated_rates = []\n    \n    # 2. Process each test case\n    for case in test_cases:\n        k, R, p, B, C = case\n        \n        E_vals = []\n        for h in h_vals:\n            # Calculate the squared error E(h)^2 based on the derived formula\n            # E(h)^2 = 1/R^2 * [ (B/(kR))^2*I_gg + 2*B*C*h^p/(kR)*I_gs + (C*h^p)^2*I_ss ]\n            \n            term_A0 = (B / (k * R))**2 * I_gg\n            term_A1_h_p = 2 * B * C * (h**p) / (k * R) * I_gs\n            term_A2_h_2p = (C * h**p)**2 * I_ss\n            \n            E_squared = (1 / R**2) * (term_A0 + term_A1_h_p + term_A2_h_2p)\n            E = np.sqrt(E_squared)\n            E_vals.append(E)\n            \n        E_vals = np.array(E_vals)\n        \n        # 3. Estimate the convergence rate alpha_hat by fitting log E vs log h\n        log_E = np.log(E_vals)\n        \n        # numpy.polyfit(x, y, 1) returns [slope, intercept] for the best-fit line.\n        # The slope is the estimated convergence rate alpha_hat.\n        alpha_hat = np.polyfit(log_h, log_E, 1)[0]\n        \n        estimated_rates.append(f\"{alpha_hat:.3f}\")\n\n    # 4. Final print statement in the exact required format.\n    print(f\"[{','.join(estimated_rates)}]\")\n\nsolve()\n```"
        }
    ]
}