{
    "hands_on_practices": [
        {
            "introduction": "Any digital implementation of time reversal begins with the crucial step of sampling the acoustic field. This exercise lays the essential groundwork by applying the Nyquist-Shannon theorem to determine the minimum sampling rates in both time and space required to avoid aliasing . Mastering this ensures that the recorded data faithfully represents the continuous wavefield, a non-negotiable prerequisite for successful refocusing.",
            "id": "4147332",
            "problem": "A linear time-reversal mirror consists of $N$ identical, omnidirectional acoustic transducers placed along the $x$-axis at locations $x_m = m d$ for $m = 0,1,\\dots,N-1$, with uniform spacing $d$ and aperture length $(N-1)d$. The medium is homogeneous with sound speed $c_0$ and negligible dispersion over the band of interest. A compact source located in the half-space in front of the array emits a band-limited signal whose acoustic field is well-approximated by a superposition of propagating plane waves with angular frequency support $|\\omega| \\le \\omega_{\\max}$ and angles of arrival (measured from the array normal) bounded by $|\\theta| \\le \\theta_{\\max}$, with $\\theta_{\\max} \\in (0,\\pi/2]$. Each transducer records the local acoustic pressure $p(x_m,t)$, the recordings are low-pass filtered to the band $|\\omega| \\le \\omega_{\\max}$, sampled in time with sampling period $\\Delta t$, time-reversed, and re-emitted by the same array to refocus at the source location.\n\nAssume the time-reversal process is otherwise ideal (perfect time reversal in the continuous limit and negligible transducer self-noise), and that evanescent components (with $|k_x| > k$) are not required for refocusing. Using first principles, derive the minimal sampling constraints in time and space needed to avoid aliasing of the recorded field that would corrupt refocusing. Your derivation must start from the wave equation and the superposition of plane-wave solutions, identify the tangential wavenumber content along the array, and apply the sampling theorem in time and in space to obtain tight Nyquist inequalities in terms of $\\omega_{\\max}$, $c_0$, $d$, and $\\theta_{\\max}$. Then select the option that correctly states these tight constraints.\n\nOptions:\n\nA. The temporal sampling must satisfy $\\Delta t \\le \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/k_x^{\\max}$, with $k_x^{\\max} = k_{\\max}\\,|\\sin\\theta_{\\max}|$ and $k_{\\max} = \\omega_{\\max}/c_0$. For $\\theta_{\\max} = \\pi/2$, this reduces to $d \\le \\pi/k_{\\max}$, i.e., $d \\le \\lambda_{\\min}/2$ where $\\lambda_{\\min} = 2\\pi/k_{\\max}$.\n\nB. The temporal sampling must satisfy $\\Delta t \\le 2\\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/k_{\\max}$, independent of $\\theta_{\\max}$.\n\nC. The temporal sampling must satisfy $\\Delta t \\le \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\lambda_{\\min}$, i.e., $d \\le 2\\pi/k_{\\max}$.\n\nD. The temporal sampling must satisfy $\\Delta t \\le 1/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/\\big(2 k_{\\max}|\\sin\\theta_{\\max}|\\big)$.\n\nE. The temporal sampling must satisfy $\\Delta t \\ge \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\ge \\pi/k_{\\max}$.",
            "solution": "The problem asks for the derivation of minimal sampling constraints for a time-reversal acoustics experiment. This requires applying the Nyquist-Shannon sampling theorem in both the temporal and spatial domains.\n\nFirst, the validity of the problem statement is assessed.\n\n**Step 1: Extract Givens**\n- **Array:** A linear time-reversal mirror with $N$ identical, omnidirectional transducers.\n- **Array Geometry:** Transducers are located at $x_m = m d$ for $m = 0,1,\\dots,N-1$ along the $x$-axis. Spacing is uniform, $d$. Aperture length is $(N-1)d$.\n- **Medium:** Homogeneous, speed of sound $c_0$, negligible dispersion.\n- **Acoustic Field:** A superposition of propagating plane waves.\n- **Temporal Bandwidth:** Angular frequency support is $|\\omega| \\le \\omega_{\\max}$.\n- **Spatial Bandwidth:** Angles of arrival $\\theta$ (measured from the array normal) are bounded by $|\\theta| \\le \\theta_{\\max}$, with $\\theta_{\\max} \\in (0,\\pi/2]$.\n- **Signal Processing:** The recorded pressure $p(x_m,t)$ is low-pass filtered to $|\\omega| \\le \\omega_{\\max}$, then sampled with period $\\Delta t$.\n- **Assumptions:** The time-reversal process is ideal. Evanescent components (with $|k_x|>k$, where $k=\\omega/c_0$) are not required for refocusing.\n- **Objective:** Derive minimal sampling constraints (tight Nyquist inequalities) for $\\Delta t$ and $d$ to avoid aliasing.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the fundamental principles of wave propagation (the wave equation), Fourier analysis, and the Nyquist-Shannon sampling theorem. The setup described is a standard, albeit idealized, model in array signal processing and computational acoustics.\n- **Well-Posed:** The problem is well-posed. It provides all necessary parameters ($\\omega_{\\max}$, $c_0$, $\\theta_{\\max}$) to determine the bandwidth of the signal in both time and space. The request for \"minimal sampling constraints\" or \"tight Nyquist inequalities\" is a clear objective to find the maximum allowable sampling intervals.\n- **Objective:** The problem is stated using precise, objective scientific language. There are no subjective or ambiguous terms.\n\nThe problem statement does not violate any of the invalidity criteria. It is a standard, formal problem in physics and engineering.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A full derivation of the solution follows.\n\n**Derivation of Sampling Constraints**\n\nThe derivation proceeds in two parts: first for the temporal domain, and second for the spatial domain. Both rely on the Nyquist-Shannon sampling theorem, which states that to perfectly reconstruct a band-limited signal, the sampling rate must be at least twice the highest frequency component in the signal.\n\n**1. Temporal Sampling Constraint ($\\Delta t$)**\n\nThe problem explicitly states that the recorded signal is band-limited, with an angular frequency support of $|\\omega| \\le \\omega_{\\max}$. This means the signal contains no frequency components with a magnitude greater than $\\omega_{\\max}$ (in radians per second).\n\nThe highest cyclical frequency in the signal is $f_{\\max} = \\frac{\\omega_{\\max}}{2\\pi}$.\n\nAccording to the Nyquist-Shannon sampling theorem, the sampling frequency, $f_s$, must satisfy:\n$$f_s \\ge 2 f_{\\max}$$\nSubstituting $f_s = 1/\\Delta t$ and $f_{\\max} = \\omega_{\\max}/(2\\pi)$:\n$$\\frac{1}{\\Delta t} \\ge 2 \\left( \\frac{\\omega_{\\max}}{2\\pi} \\right) = \\frac{\\omega_{\\max}}{\\pi}$$\nTo find the tightest constraint on the sampling period $\\Delta t$, we solve for $\\Delta t$:\n$$\\Delta t \\le \\frac{\\pi}{\\omega_{\\max}}$$\nThis is the minimal constraint on the temporal sampling period to avoid temporal aliasing.\n\n**2. Spatial Sampling Constraint ($d$)**\n\nThe acoustic field is a superposition of plane waves. A single plane wave component with angular frequency $\\omega$ and angle of arrival $\\theta$ can be written in two dimensions (with the array on the $x$-axis and the source in the $y>0$ half-space) as:\n$$p(x, y, t) = A \\exp(i(k_x x + k_y y - \\omega t))$$\nwhere $\\mathbf{k} = (k_x, k_y)$ is the wave vector. The magnitude of the wave vector is $k = |\\mathbf{k}| = \\sqrt{k_x^2 + k_y^2} = \\omega/c_0$. The angle $\\theta$ is measured from the array normal (the $y$-axis), so the components of the wave vector are:\n$$k_x = k \\sin\\theta$$\n$$k_y = k \\cos\\theta$$\nThe transducers are located along the $x$-axis (at $y=0$). The field sampled by the array is $p(x_m, 0, t)$. The spatial variation of the field along the array is determined by the phase term $\\exp(i k_x x)$. The quantity $k_x$ is the tangential wavenumber or spatial frequency along the array axis.\n\nTo apply the sampling theorem in space, we must find the spatial bandwidth of the signal along the array. This is determined by the maximum possible value of $|k_x|$.\n$$|k_x| = |k \\sin\\theta| = \\left| \\frac{\\omega}{c_0} \\sin\\theta \\right|$$\nThe maximum value of $|k_x|$, denoted $k_x^{\\max}$, occurs when both $|\\omega|$ and $|\\sin\\theta|$ are maximized.\n- The maximum value of $|\\omega|$ is given as $\\omega_{\\max}$.\n- The angles of arrival are bounded by $|\\theta| \\le \\theta_{\\max}$. Since $\\theta_{\\max} \\in (0, \\pi/2]$, the maximum value of $|\\sin\\theta|$ over this range is $\\sin\\theta_{\\max}$.\n\nTherefore, the maximum tangential wavenumber is:\n$$k_x^{\\max} = \\frac{\\omega_{\\max}}{c_0} \\sin\\theta_{\\max}$$\nLet's define $k_{\\max} = \\omega_{\\max}/c_0$ as the maximum wavenumber, corresponding to the highest temporal frequency. The range of possible angles $|\\theta| \\le \\theta_{\\max}$ means $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$. The highest magnitude of the tangential wavenumber is indeed for $\\theta = \\pm \\theta_{\\max}$, so $|k_x| \\le \\frac{\\omega_{\\max}}{c_0}|\\sin(\\pm \\theta_{\\max})| = k_{\\max} \\sin\\theta_{\\max}$ since $\\sin\\theta_{\\max} > 0$. The problem phrasing with $|\\sin\\theta_{\\max}|$ is equivalent.\n$$k_x^{\\max} = k_{\\max} |\\sin\\theta_{\\max}|$$\nThe signal along the array is thus band-limited in terms of spatial angular frequency $k_x$ to the interval $[-k_x^{\\max}, k_x^{\\max}]$.\n\nApplying the spatial version of the Nyquist-Shannon sampling theorem, the spatial sampling interval $d$ must satisfy:\n$$d \\le \\frac{\\pi}{k_x^{\\max}}$$\nSubstituting the expression for $k_x^{\\max}$:\n$$d \\le \\frac{\\pi}{k_{\\max} |\\sin\\theta_{\\max}|}$$\nThis is the minimal constraint on the spatial sampling interval (transducer spacing) to avoid spatial aliasing.\n\n**Combined Constraints:**\n- Temporal: $\\Delta t \\le \\frac{\\pi}{\\omega_{\\max}}$\n- Spatial: $d \\le \\frac{\\pi}{k_{\\max} |\\sin\\theta_{\\max}|}$, where $k_{\\max} = \\omega_{\\max}/c_0$.\n\n**Evaluation of Options**\n\n**A. The temporal sampling must satisfy $\\Delta t \\le \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/k_x^{\\max}$, with $k_x^{\\max} = k_{\\max}\\,|\\sin\\theta_{\\max}|$ and $k_{\\max} = \\omega_{\\max}/c_0$. For $\\theta_{\\max} = \\pi/2$, this reduces to $d \\le \\pi/k_{\\max}$, i.e., $d \\le \\lambda_{\\min}/2$ where $\\lambda_{\\min} = 2\\pi/k_{\\max}$.**\n- The temporal constraint $\\Delta t \\le \\pi/\\omega_{\\max}$ matches our derivation perfectly.\n- The spatial constraint $d \\le \\pi/k_x^{\\max}$ with $k_x^{\\max} = k_{\\max}\\,|\\sin\\theta_{\\max}|$ also matches our derivation perfectly.\n- For the special case $\\theta_{\\max} = \\pi/2$, $|\\sin(\\pi/2)| = 1$, so the spatial constraint becomes $d \\le \\pi/k_{\\max}$. The minimum wavelength is $\\lambda_{\\min} = 2\\pi c_0 / \\omega_{\\max} = 2\\pi/k_{\\max}$. Substituting this into the constraint gives $d \\le \\pi/(2\\pi/\\lambda_{\\min}) = \\lambda_{\\min}/2$. This reduction is also correct and represents the well-known half-wavelength spacing criterion.\n**Verdict: Correct.**\n\n**B. The temporal sampling must satisfy $\\Delta t \\le 2\\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/k_{\\max}$, independent of $\\theta_{\\max}$.**\n- The temporal constraint $\\Delta t \\le 2\\pi/\\omega_{\\max}$ is incorrect by a factor of $2$. This corresponds to sampling at a rate of $\\omega_{\\max}/(2\\pi)$, which is equal to the highest frequency, not twice it.\n- The spatial constraint $d \\le \\pi/k_{\\max}$ is only correct for the specific case where $\\theta_{\\max} = \\pi/2$. It is not independent of $\\theta_{\\max}$; for $\\theta_{\\max} < \\pi/2$, the constraint is less strict.\n**Verdict: Incorrect.**\n\n**C. The temporal sampling must satisfy $\\Delta t \\le \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\lambda_{\\min}$, i.e., $d \\le 2\\pi/k_{\\max}$.**\n- The temporal constraint is correct.\n- The spatial constraint $d \\le 2\\pi/k_{\\max}$ is equivalent to $d \\le \\lambda_{\\min}$. This is incorrect. The tightest requirement (for $\\theta_{\\max}=\\pi/2$) is $d \\le \\lambda_{\\min}/2$. A spacing of $d=\\lambda_{\\min}$ would cause severe aliasing.\n**Verdict: Incorrect.**\n\n**D. The temporal sampling must satisfy $\\Delta t \\le 1/\\omega_{\\max}$. The spatial sampling must satisfy $d \\le \\pi/\\big(2 k_{\\max}|\\sin\\theta_{\\max}|\\big)$.**\n- The temporal constraint $\\Delta t \\le 1/\\omega_{\\max}$ is incorrect. It is missing a factor of $\\pi$.\n- The spatial constraint $d \\le \\pi/(2 k_{\\max}|\\sin\\theta_{\\max}|)$ is overly restrictive by a factor of $2$. While sampling this densely would avoid aliasing, it is not the \"minimal\" or \"tightest\" constraint requested by the problem.\n**Verdict: Incorrect.**\n\n**E. The temporal sampling must satisfy $\\Delta t \\ge \\pi/\\omega_{\\max}$. The spatial sampling must satisfy $d \\ge \\pi/k_{\\max}$.**\n- Both inequalities are reversed. These constraints would permit arbitrarily large sampling intervals, leading to aliasing.\n**Verdict: Incorrect.**\n\nOnly option A provides the correctly derived tight constraints for both temporal and spatial sampling based on first principles.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While the ideal, lossless wave equation is time-reversal invariant, real-world media introduce dissipation, which breaks this elegant symmetry. This practice tackles the challenge of acoustic attenuation by framing time reversal as an inverse problem, where naive inversion leads to instability . You will derive a Tikhonov-regularized filter that provides a robust method to compensate for losses, revealing the fundamental trade-off between focal fidelity and noise amplification.",
            "id": "4147354",
            "problem": "Consider a single-channel time-reversal experiment in a homogeneous, weakly attenuating medium where linear, time-invariant propagation from a transducer to a focal point is described in the frequency domain by a complex, scalar transfer function $A(\\omega) \\in \\mathbb{C}$. In the absence of attenuation, exact refocusing at the target would be obtained by precompensating the spectrum with the multiplicative inverse $A(\\omega)^{-1}$. However, because attenuation and possible spectral notches make $A(\\omega)$ small over some bands, direct inversion is ill-conditioned and amplifies measurement noise and modeling error. To stabilize the de-attenuation, consider the following Tikhonov-regularized optimization at each angular frequency $\\omega$:\n$$\n\\min_{w(\\omega) \\in \\mathbb{C}} \\; \\left\\lVert A(\\omega)\\,w(\\omega) - 1 \\right\\rVert^{2} \\; + \\; \\lambda \\left\\lVert w(\\omega) \\right\\rVert^{2},\n$$\nwith $\\lambda > 0$. Assume that $A(\\omega)$ and $\\lambda$ are known and fixed, and that the problem decouples over $\\omega$ so that each $\\omega$ can be treated independently. The goal is to obtain a closed-form expression for the minimizer $w^{\\star}(\\omega)$ that is suitable for use as a stable de-attenuation prefilter in time-reversal focusing.\n\nTasks:\n- Starting only from linearity of the propagation model, the definition of the frequency-domain transfer function, and the posed regularized least-squares problem, derive the analytic minimizer $w^{\\star}(\\omega)$.\n- Explain, in terms of the resulting closed-form $A(\\omega) w^{\\star}(\\omega)$, how the choice of $\\lambda$ modulates the retained bandwidth and amplitude at focus, and therefore the fidelity of the refocused wavefield in space and time. Your explanation must relate spectral weighting to qualitative changes in focal amplitude and spatial resolution but does not need to produce a numerical value.\n\nProvide your final answer as a single, closed-form analytic expression for $w^{\\star}(\\omega)$ in terms of $A(\\omega)$ and $\\lambda$. No numerical evaluation is required, and no units are needed in the final answer.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of linear systems, wave propagation, and inverse problem theory. The problem is well-posed, as the Tikhonov-regularized least-squares objective function is strictly convex for $\\lambda > 0$, guaranteeing a unique minimizer. The provided information is complete and consistent, and the terminology is precise and objective. The problem poses a standard, non-trivial task in signal processing and computational acoustics.\n\nThe objective is to find the complex-valued prefilter $w(\\omega)$ that minimizes the cost function $J(w(\\omega))$ for each angular frequency $\\omega$. The cost function is given by:\n$$\nJ(w(\\omega)) = \\left\\lVert A(\\omega)\\,w(\\omega) - 1 \\right\\rVert^{2} \\; + \\; \\lambda \\left\\lVert w(\\omega) \\right\\rVert^{2}\n$$\nFor clarity, we will suppress the explicit dependence on $\\omega$ in the derivation, treating $w$ and $A$ as complex scalars at a fixed frequency. The goal is to solve $\\min_{w \\in \\mathbb{C}} J(w)$.\n\nThe squared norm of a complex number $z$ is given by $\\left\\lVert z \\right\\rVert^{2} = z \\bar{z}$, where $\\bar{z}$ is the complex conjugate of $z$. Applying this to the cost function, we have:\n$$\nJ(w) = (A w - 1) \\overline{(A w - 1)} + \\lambda (w \\bar{w})\n$$\nUsing the properties of complex conjugation, $\\overline{(z_1 z_2)} = \\bar{z}_1 \\bar{z}_2$ and $\\overline{(z_1 - z_2)} = \\bar{z}_1 - \\bar{z}_2$, the first term becomes:\n$$\n(A w - 1) (\\bar{A} \\bar{w} - 1) = A \\bar{A} w \\bar{w} - A w - \\bar{A} \\bar{w} + 1\n$$\nSince $A \\bar{A} = |A|^2$ and $w \\bar{w} = |w|^2$, we can rewrite the cost function as:\n$$\nJ(w) = |A|^2 |w|^2 - A w - \\bar{A} \\bar{w} + 1 + \\lambda |w|^2\n$$\n$$\nJ(w) = (|A|^2 + \\lambda) w \\bar{w} - A w - \\bar{A} \\bar{w} + 1\n$$\nTo find the minimizer $w^{\\star}$, we must find the stationary point of $J(w)$. The function $J(w)$ is a real-valued function of a complex variable $w$. We can find the minimum by using Wirtinger calculus, treating $w$ and $\\bar{w}$ as independent variables. The condition for a minimum is that the complex derivative with respect to $\\bar{w}$ is zero:\n$$\n\\frac{\\partial J}{\\partial \\bar{w}} = 0\n$$\nWe compute the derivative of each term in $J(w)$:\n$$\n\\frac{\\partial}{\\partial \\bar{w}} \\left( (|A|^2 + \\lambda) w \\bar{w} - A w - \\bar{A} \\bar{w} + 1 \\right) = (|A|^2 + \\lambda) w - \\bar{A}\n$$\nSetting this derivative to zero gives the equation for the optimal filter $w^{\\star}$:\n$$\n(|A(\\omega)|^2 + \\lambda) w^{\\star}(\\omega) - \\overline{A(\\omega)} = 0\n$$\nHere, we have reintroduced the explicit dependence on $\\omega$. Solving for $w^{\\star}(\\omega)$ yields the closed-form expression for the analytic minimizer:\n$$\nw^{\\star}(\\omega) = \\frac{\\overline{A(\\omega)}}{|A(\\omega)|^2 + \\lambda}\n$$\nBecause the Hessian of the cost function is positive definite ($\\frac{\\partial^2 J}{\\partial w \\partial \\bar{w}} = |A|^2 + \\lambda > 0$ since $\\lambda > 0$), this stationary point is indeed a unique minimum.\n\nNow, we analyze how the choice of $\\lambda$ modulates the refocused wavefield. The spectrum of the wavefield at the focal point is given by the product of the channel transfer function $A(\\omega)$ and the applied prefilter $w^{\\star}(\\omega)$. Let us call this the effective transfer function, $H_{\\text{eff}}(\\omega)$:\n$$\nH_{\\text{eff}}(\\omega) = A(\\omega) w^{\\star}(\\omega) = A(\\omega) \\left( \\frac{\\overline{A(\\omega)}}{|A(\\omega)|^2 + \\lambda} \\right) = \\frac{|A(\\omega)|^2}{|A(\\omega)|^2 + \\lambda}\n$$\nThis expression reveals the role of the regularization parameter $\\lambda$. The ideal goal of de-attenuation is to achieve $H_{\\text{eff}}(\\omega) = 1$ for all frequencies, which corresponds to perfect refocusing (a temporal delta function). The derived $H_{\\text{eff}}(\\omega)$ is a real-valued filter that approximates this ideal.\n\nThe behavior of $H_{\\text{eff}}(\\omega)$ depends on the magnitude of $|A(\\omega)|^2$ relative to $\\lambda$:\n1.  For frequencies where the channel is strong, i.e., $|A(\\omega)|^2 \\gg \\lambda$, the effective transfer function approaches unity:\n    $$\n    H_{\\text{eff}}(\\omega) = \\frac{|A(\\omega)|^2}{|A(\\omega)|^2 + \\lambda} \\approx \\frac{|A(\\omega)|^2}{|A(\\omega)|^2} = 1\n    $$\n    In these frequency bands, the regularized filter successfully inverts the channel, contributing to a high-fidelity reconstruction.\n\n2.  For frequencies where the channel is weak or attenuated (e.g., spectral notches), i.e., $|A(\\omega)|^2 \\ll \\lambda$, the effective transfer function is attenuated:\n    $$\n    H_{\\text{eff}(\\omega)} = \\frac{|A(\\omega)|^2}{|A(\\omega)|^2 + \\lambda} \\approx \\frac{|A(\\omega)|^2}{\\lambda} \\to 0\n    $$\n    In these bands, where direct inversion would amplify noise, the regularized solution suppresses the contribution. This prevents noise amplification at the cost of not perfectly reconstructing these frequency components.\n\nThe choice of $\\lambda$ thus controls a trade-off:\n-   **Bandwidth and Resolution**: The effective bandwidth of the refocused signal is the range of frequencies for which $H_{\\text{eff}}(\\omega)$ is significantly different from zero. The value of $\\lambda$ acts as a threshold for $|A(\\omega)|^2$. A smaller $\\lambda$ allows more frequencies (where $|A(\\omega)|^2$ is smaller) to pass, widening the effective bandwidth. A wider bandwidth in the frequency domain corresponds to a sharper, more localized pulse in the time and space domains, meaning higher temporal and spatial resolution. Conversely, a larger $\\lambda$ narrows the effective bandwidth, resulting in a smoother, less-resolved focus.\n-   **Focal Amplitude**: The amplitude of the refocused signal is related to the integral of $H_{\\text{eff}}(\\omega)$ over all frequencies. Since $H_{\\text{eff}}(\\omega)$ is always less than or equal to $1$, the peak focal amplitude will be reduced compared to the ideal case. A larger $\\lambda$ causes stronger attenuation across all frequencies, leading to a much lower overall focal amplitude. A smaller $\\lambda$ allows $H_{\\text{eff}}(\\omega)$ to be closer to $1$ over a wider band, resulting in a higher focal amplitude.\n\nIn summary, $\\lambda$ is a tuning parameter that balances the fidelity of the refocusing against the stability of the solution. A small $\\lambda$ favors high resolution and amplitude at the risk of noise amplification, while a large $\\lambda$ ensures stability and robustness at the cost of lower resolution and amplitude.",
            "answer": "$$\n\\boxed{\\frac{\\overline{A(\\omega)}}{|A(\\omega)|^{2} + \\lambda}}\n$$"
        },
        {
            "introduction": "The remarkable focusing capabilities of time reversal are most compelling in complex, inhomogeneous environments like underwater acoustic waveguides. This practice advances from simple media to range-dependent channels, modeled using the powerful parabolic equation approximation . Through this computational exercise, you will discover that for such non-stationary media, true back-propagation requires implementing the adjoint of the forward propagation operator, a concept more profound and general than simple time-reversal of recorded signals.",
            "id": "4147353",
            "problem": "You are to formalize and simulate narrow-angle propagation and time-reversal focusing in a two-dimensional range-depth acoustic waveguide with range-dependent sound speed, using a parabolic equation approximation. Begin from the scalar linear acoustic wave equation in a lossless medium and develop a self-consistent parabolic equation for a monochromatic field that advances in range. Then, specify the time-reversal backpropagation operator as the adjoint of the forward operator in the presence of range dependence. Implement a numerical demonstration with a split-step Fourier solution that shows how accounting for non-stationary (range-dependent) propagation in time reversal is necessary for proper focusing.\n\nThe fundamental starting point is the scalar acoustic wave equation for pressure $p(\\mathbf{x},t)$ in a lossless medium with sound speed $c(\\mathbf{x})$,\n$$\n\\nabla^2 p(\\mathbf{x},t) - \\frac{1}{c^2(\\mathbf{x})}\\frac{\\partial^2 p(\\mathbf{x},t)}{\\partial t^2} = 0,\n$$\nand its monochromatic reduction via $p(\\mathbf{x},t) = \\Re\\{\\hat{p}(\\mathbf{x}) e^{-i \\omega t}\\}$ to the Helmholtz equation,\n$$\n\\nabla^2 \\hat{p}(\\mathbf{x}) + k^2(\\mathbf{x}) \\hat{p}(\\mathbf{x}) = 0,\n$$\nwhere $k(\\mathbf{x}) = \\omega / c(\\mathbf{x})$. Consider two-dimensional propagation in range-depth coordinates $(r,z)$, introduce a reference wavenumber $k_0 = \\omega/c_0$ about a constant reference sound speed $c_0$, and derive a narrow-angle parabolic equation for a complex envelope $\\psi(r,z)$ defined by $\\hat{p}(r,z) = \\psi(r,z) e^{i k_0 r}$. Under forward-propagating, small-angle, and small inhomogeneity conditions, demonstrate that the evolution of $\\psi(r,z)$ can be approximated by a first-order range-marching equation of the form\n$$\n\\frac{\\partial \\psi}{\\partial r} = \\frac{i}{2 k_0} \\frac{\\partial^2 \\psi}{\\partial z^2} + \\frac{i k_0}{2} V(r,z) \\psi,\n$$\nwhere $V(r,z)$ is a dimensionless refraction potential constructed from $c(r,z)$ and $c_0$.\n\nNext, argue from first principles of reciprocity and linear operator adjoints that the correct time-reversal backpropagation operator for range-dependent media must be the adjoint of the forward operator with its $r$-dependent coefficients traversed in reverse order. Explain why replacing the range dependence by a stationary (range-independent) approximation (for example, fixing $V(r,z)$ to $V(R,z)$ for all $r$, where $R$ is the terminal range) generally degrades time-reversal focusing.\n\nYour program must numerically simulate forward propagation and two types of time-reversal backpropagation in a two-dimensional domain by split-step Fourier marching in $r$:\n- The forward operator advances $\\psi(r,z)$ from $r=0$ to $r=R$ using the refraction potential $V(r,z)$ derived from a range-dependent sound speed $c(r,z)$.\n- The correct time-reversal backpropagation advances $\\psi_{\\text{TR}}(r,z)$ from $r=R$ to $r=0$ with negative range steps and the same range-dependent $V(r,z)$ traversed in reverse $r$.\n- The stationary approximation backpropagation advances $\\psi_{\\text{TR,stat}}(r,z)$ from $r=R$ to $r=0$ using a fixed $V(R,z)$ for all $r$.\n\nDefine the sound speed profile by\n$$\nc(r,z) = c_0 \\left[1 + a_z \\left(\\frac{z}{H} - \\frac{1}{2}\\right) + b_r \\left(\\frac{r}{R}\\right)\\right],\n$$\nwith constants $c_0$, $a_z$, and the test parameter $b_r$. Use a depth extent $H$ and a terminal range $R$. Use a monochromatic carrier of angular frequency $\\omega = 2\\pi f$, with $f$ the frequency. Define the refraction potential by\n$$\nV(r,z) = \\left(\\frac{c_0}{c(r,z)}\\right)^2 - 1,\n$$\nwhich is dimensionless. The initial envelope at $r=0$ is a unit-amplitude Gaussian in $z$ centered at a source depth $z_s$ with standard deviation $\\sigma$, namely\n$$\n\\psi(0,z) = \\exp\\left(-\\frac{(z-z_s)^2}{2 \\sigma^2}\\right).\n$$\n\nImplement the split-step Fourier scheme in $z$ on a uniform depth grid with periodic boundary conditions. In each range step $\\Delta r$, apply a half-step refraction phase, a full-step diffraction phase via the Fourier transform in $z$, and another half-step refraction phase. For the diffraction operator, use the spectral multiplier\n$$\n\\exp\\left(-i \\frac{\\Delta r}{2 k_0} k_z^2\\right),\n$$\nwhere $k_z$ is the vertical wavenumber on the discrete grid constructed from the depth spacing. The refraction half-step multiplies the field by $\\exp\\left(i \\frac{k_0 \\Delta r}{2} V(r,z)\\right)$.\n\nWhen performing time reversal, initialize the backpropagation at $r=R$ with the complex conjugate of the forward field $\\psi(R,z)$, and march with negative $\\Delta r$:\n- For correct time reversal, use the $r$-dependent $V(r,z)$ evaluated along the reversed range.\n- For the stationary approximation, use $V(R,z)$ for all $r$.\n\nMeasure focusing quality by the recovered envelope magnitude at the original source depth $z=z_s$ at $r=0$, for both the correct and stationary backpropagations. Report the improvement factor\n$$\n\\Gamma = \\frac{\\left|\\psi_{\\text{TR}}(0,z_s)\\right|}{\\left|\\psi_{\\text{TR,stat}}(0,z_s)\\right|},\n$$\nwhich is dimensionless.\n\nUse the following physically plausible constants and units:\n- Reference sound speed $c_0 = 1500$ m/s.\n- Frequency $f = 250$ Hz (thus angular frequency in radians per second). All angles in radians.\n- Depth extent $H = 2000$ m.\n- Number of depth grid points $N_z = 1024$.\n- Terminal range $R = 20000$ m.\n- Range step $\\Delta r = 50$ m.\n- Depth source location $z_s = H/2$ (meters).\n- Initial Gaussian standard deviation $\\sigma = 30$ m.\n- Depth-gradient fraction $a_z = -0.003$ (dimensionless).\n- Range-gradient fraction $b_r$ varies per test case (dimensionless).\n\nTest suite:\n- Case 1 (homogeneous in range): $b_r = 0.0$.\n- Case 2 (weak range dependence): $b_r = 1.0 \\times 10^{-4}$.\n- Case 3 (stronger range dependence): $b_r = 2.0 \\times 10^{-4}$.\n\nFor each test case, compute and return the improvement factor $\\Gamma$ as a float. Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example, \"[result1,result2,result3]\". The three reported values are dimensionless floats and should be printed with full double precision as produced by Python without additional rounding or unit annotations.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of wave propagation and computational acoustics, well-posed with a complete set of physical and numerical parameters, and objectively formulated. It presents a non-trivial numerical experiment to demonstrate a key concept in time-reversal physics.\n\nThe first step is to derive the narrow-angle parabolic equation (PE) from the two-dimensional Helmholtz equation. The starting point is the Helmholtz equation for a monochromatic pressure field $\\hat{p}(r,z)$ in a medium with a range- and depth-dependent wavenumber $k(r,z) = \\omega/c(r,z)$:\n$$\n\\frac{\\partial^2 \\hat{p}}{\\partial r^2} + \\frac{\\partial^2 \\hat{p}}{\\partial z^2} + k^2(r,z) \\hat{p} = 0\n$$\nWe assume that the field primarily propagates in the positive $r$-direction. This suggests factoring out a fast-varying carrier phase corresponding to a reference wavenumber $k_0 = \\omega/c_0$, where $c_0$ is a constant reference sound speed. We define a slowly varying complex envelope $\\psi(r,z)$ such that:\n$$\n\\hat{p}(r,z) = \\psi(r,z) e^{i k_0 r}\n$$\nThe derivatives of $\\hat{p}$ with respect to $r$ are:\n$$\n\\frac{\\partial \\hat{p}}{\\partial r} = \\left(\\frac{\\partial \\psi}{\\partial r} + i k_0 \\psi\\right) e^{i k_0 r}\n$$\n$$\n\\frac{\\partial^2 \\hat{p}}{\\partial r^2} = \\left(\\frac{\\partial^2 \\psi}{\\partial r^2} + 2 i k_0 \\frac{\\partial \\psi}{\\partial r} - k_0^2 \\psi\\right) e^{i k_0 r}\n$$\nSubstituting this and $\\frac{\\partial^2 \\hat{p}}{\\partial z^2} = \\frac{\\partial^2 \\psi}{\\partial z^2} e^{i k_0 r}$ into the Helmholtz equation and canceling the common factor $e^{i k_0 r}$ yields:\n$$\n\\frac{\\partial^2 \\psi}{\\partial r^2} + 2 i k_0 \\frac{\\partial \\psi}{\\partial r} - k_0^2 \\psi + \\frac{\\partial^2 \\psi}{\\partial z^2} + k^2(r,z) \\psi = 0\n$$\nThe core of the parabolic approximation is the *slowly varying envelope approximation* (SVEA). This assumes that the envelope $\\psi$ varies much more slowly in range $r$ than the carrier phase, which mathematically means $\\left|\\frac{\\partial^2 \\psi}{\\partial r^2}\\right| \\ll \\left|2 k_0 \\frac{\\partial \\psi}{\\partial r}\\right|$. This is valid for narrow-angle propagation where most energy is directed near the $r$-axis. Discarding the $\\frac{\\partial^2 \\psi}{\\partial r^2}$ term, we get:\n$$\n2 i k_0 \\frac{\\partial \\psi}{\\partial r} + \\frac{\\partial^2 \\psi}{\\partial z^2} + (k^2(r,z) - k_0^2) \\psi \\approx 0\n$$\nSolving for the range derivative $\\frac{\\partial \\psi}{\\partial r}$:\n$$\n\\frac{\\partial \\psi}{\\partial r} \\approx \\frac{i}{2 k_0} \\frac{\\partial^2 \\psi}{\\partial z^2} + \\frac{i}{2 k_0} (k^2(r,z) - k_0^2) \\psi\n$$\nThe term $(k^2(r,z) - k_0^2)$ represents the deviation from the reference medium. We can express this using the sound speed $c(r,z)$ and the reference speed $c_0$:\n$$\nk^2(r,z) - k_0^2 = \\frac{\\omega^2}{c^2(r,z)} - \\frac{\\omega^2}{c_0^2} = k_0^2 \\left[ \\left(\\frac{c_0}{c(r,z)}\\right)^2 - 1 \\right]\n$$\nBy defining the dimensionless refraction potential $V(r,z) = \\left(\\frac{c_0}{c(r,z)}\\right)^2 - 1$, the equation becomes:\n$$\n\\frac{\\partial \\psi}{\\partial r} = \\frac{i}{2 k_0} \\frac{\\partial^2 \\psi}{\\partial z^2} + \\frac{i k_0}{2} V(r,z) \\psi\n$$\nThis is the desired parabolic equation, which is a first-order differential equation in range $r$ and can be marched forward from an initial condition at $r=0$.\n\nWe can write this evolution abstractly as $\\frac{\\partial \\psi}{\\partial r} = i(\\mathcal{D} + \\mathcal{V}(r))\\psi$, where $\\mathcal{D} = \\frac{1}{2k_0}\\frac{\\partial^2}{\\partial z^2}$ is the self-adjoint diffraction operator and $\\mathcal{V}(r) = \\frac{k_0}{2}V(r,z)$ is the range-dependent, self-adjoint multiplication operator for refraction. The forward propagator $\\mathcal{G}(R,0)$ that maps the field from $r=0$ to $r=R$ is the path-ordered exponential of the evolution operator. Time reversal aims to reconstruct the original source field from the field measured at $r=R$. This involves conjugating the field $\\psi(R,z)$ and back-propagating. Perfect focusing is achieved if the back-propagation operator is the adjoint of the forward propagator, $\\mathcal{G}_{\\text{TR}}(0,R) = \\mathcal{G}^\\dagger(R,0)$. The adjoint of an operator $\\mathcal{A}$ is defined by the inner product relation $\\langle \\mathcal{A} u, v \\rangle = \\langle u, \\mathcal{A}^\\dagger v \\rangle$. For the evolution operator $i(\\mathcal{D} + \\mathcal{V}(r))$, which is anti-Hermitian, its adjoint is $-i(\\mathcal{D} + \\mathcal{V}(r))$. The adjoint of the full forward propagator $\\mathcal{G}(R,0)$ involves applying these adjoint evolution operators in the reverse order of range $r$. Thus, the correct time-reversal back-propagation must use the same range-dependent potential $V(r,z)$, but evaluated at ranges from $R$ back to $0$.\n\nIf one approximates the medium as stationary during back-propagation (e.g., using $V(R,z)$ for all $r$), the back-propagator is no longer the adjoint of the true forward propagator. This operator mismatch, $\\mathcal{G}_{\\text{TR,stat}} \\neq \\mathcal{G}^\\dagger$, leads to an imperfect reconstruction of the wavefronts at the source location, resulting in degraded focusing. The severity of this degradation increases with the magnitude of the range dependence, quantified here by the parameter $b_r$.\n\nThe numerical solution is implemented using the split-step Fourier (SSF) method. For a single range step $\\Delta r$ from $r_j$ to $r_{j+1}$, the field is advanced using a symmetric Strang splitting:\n$$\n\\psi(r_{j+1}, z) \\approx e^{i\\frac{k_0 \\Delta r}{4} V(r_{j+1}, z)} \\mathcal{F}^{-1} \\left\\{ e^{-i \\frac{\\Delta r}{2 k_0} k_z^2} \\mathcal{F} \\left\\{ e^{i\\frac{k_0 \\Delta r}{4} V(r_j,z)} \\psi(r_j, z) \\right\\} \\right\\}\n$$\nThis is equivalent to the prescribed sequence of a half-step refraction, a full-step diffraction, and another half-step refraction. In practice, we implement this as:\n1. Half-step refraction at $r_j$: $\\psi \\leftarrow \\psi \\cdot \\exp\\left(i \\frac{k_0 \\Delta r}{2} V(r_j,z)\\right)$\n2. Full-step diffraction: $\\psi \\leftarrow \\mathcal{F}^{-1}\\left\\{ \\exp\\left(-i \\frac{\\Delta r}{2 k_0} k_z^2\\right) \\mathcal{F}\\{\\psi\\} \\right\\}$\n3. Half-step refraction at $r_{j+1}$: $\\psi \\leftarrow \\psi \\cdot \\exp\\left(i \\frac{k_0 \\Delta r}{2} V(r_{j+1},z)\\right)$\n\nFor back-propagation, we initialize with $\\psi^*(R,z)$ and march with a negative range step, $-\\Delta r$. This changes the sign in the exponential of each operator, correctly implementing the adjoint operation.\n1. Correct TR: uses $V(r_j, z)$ and $V(r_{j-1}, z)$ in the reverse loop from $r_j$ to $r_{j-1}$.\n2. Stationary TR: uses $V(R,z)$ for all refraction steps.\n\nThe improvement factor $\\Gamma$ directly compares the peak focal amplitude of the correct TR to the stationary approximation, quantifying the necessity of accounting for range dependence. For $b_r=0$, the medium is range-independent, so both TR methods are identical, yielding $\\Gamma=1$. For $b_r>0$, we expect $\\Gamma>1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef solve():\n    \"\"\"\n    Simulates acoustic propagation and time reversal in a range-dependent waveguide\n    using the parabolic equation and split-step Fourier method.\n    \"\"\"\n    \n    # Define physical and numerical constants\n    c0 = 1500.0        # Reference sound speed (m/s)\n    f = 250.0          # Frequency (Hz)\n    H = 2000.0         # Depth extent (m)\n    Nz = 1024          # Number of depth grid points\n    R = 20000.0        # Terminal range (m)\n    dr = 50.0          # Range step (m)\n    zs = H / 2.0       # Source depth (m)\n    sigma = 30.0       # Initial Gaussian standard deviation (m)\n    az = -0.003        # Depth-gradient fraction (dimensionless)\n\n    # Test cases for the range-gradient fraction\n    test_cases = [\n        0.0,             # Case 1: Homogeneous in range\n        1.0e-4,          # Case 2: Weak range dependence\n        2.0e-4           # Case 3: Stronger range dependence\n    ]\n\n    results = []\n\n    # Derived parameters\n    omega = 2.0 * np.pi * f\n    k0 = omega / c0\n    dz = H / Nz\n    z_grid = np.arange(Nz) * dz\n    zs_idx = int(np.round(zs / dz)) % Nz\n    Nr = int(R / dr)\n    r_grid = np.arange(Nr + 1) * dr\n    kz_grid = 2.0 * np.pi * fftfreq(Nz, d=dz)\n\n    # Pre-calculate diffraction operators for forward and backward propagation\n    diff_op_fwd = np.exp(-1j * dr / (2.0 * k0) * kz_grid**2)\n    diff_op_bwd = np.exp(1j * dr / (2.0 * k0) * kz_grid**2)\n\n    for br in test_cases:\n        # --- Define sound speed and refraction potential ---\n        def c(r, z, br_val):\n            return c0 * (1.0 + az * (z / H - 0.5) + br_val * (r / R))\n\n        def V(r, z, br_val):\n            return (c0 / c(r, z, br_val))**2 - 1.0\n\n        # --- Forward Propagation ---\n        # Initial field at r=0\n        psi = np.exp(-(z_grid - zs)**2 / (2.0 * sigma**2)).astype(np.complex128)\n        \n        # Store potentials at each range step to avoid re-calculation\n        V_matrix = np.array([V(r_val, z_grid, br) for r_val in r_grid])\n\n        # SSF loop for forward propagation\n        for j in range(Nr):\n            # First half refraction step\n            psi *= np.exp(0.5j * k0 * dr * V_matrix[j])\n            # Full diffraction step in spectral domain\n            psi_k = fft(psi)\n            psi_k *= diff_op_fwd\n            psi = ifft(psi_k)\n            # Second half refraction step\n            psi *= np.exp(0.5j * k0 * dr * V_matrix[j+1])\n        \n        psi_R = psi  # Field at terminal range R\n\n        # --- Time Reversal: Correct (Adjoint) Back-propagation ---\n        psi_tr = np.conj(psi_R)\n        \n        # SSF loop for back-propagation\n        for j in range(Nr, 0, -1):\n            # First half refraction step\n            psi_tr *= np.exp(-0.5j * k0 * dr * V_matrix[j])\n            # Full diffraction step (adjoint)\n            psi_tr_k = fft(psi_tr)\n            psi_tr_k *= diff_op_bwd\n            psi_tr = ifft(psi_tr_k)\n            # Second half refraction step\n            psi_tr *= np.exp(-0.5j * k0 * dr * V_matrix[j-1])\n        \n        psi_tr_0 = psi_tr # Recovered field at r=0\n\n        # --- Time Reversal: Stationary Approximation Back-propagation ---\n        psi_tr_stat = np.conj(psi_R)\n        V_stat = V_matrix[-1] # Potential at r=R\n        ref_op_stat_half = np.exp(-0.5j * k0 * dr * V_stat)\n        \n        # SSF loop for back-propagation with stationary potential\n        for _ in range(Nr):\n            # First half refraction step (using V(R,z))\n            psi_tr_stat *= ref_op_stat_half\n            # Full diffraction step\n            psi_tr_stat_k = fft(psi_tr_stat)\n            psi_tr_stat_k *= diff_op_bwd\n            psi_tr_stat = ifft(psi_tr_stat_k)\n            # Second half refraction step (using V(R,z))\n            psi_tr_stat *= ref_op_stat_half\n\n        psi_tr_stat_0 = psi_tr_stat # Recovered field at r=0\n\n        # --- Calculate Improvement Factor Gamma ---\n        mag_tr = np.abs(psi_tr_0[zs_idx])\n        mag_tr_stat = np.abs(psi_tr_stat_0[zs_idx])\n\n        # Handle potential division by zero, though unlikely in this problem\n        if mag_tr_stat == 0:\n            # If stationary fails completely, improvement is conceptually infinite\n            # Capping at a large number or setting to 1.0 if both are zero.\n            gamma = 1.0 if mag_tr == 0 else np.finfo(np.float64).max\n        else:\n            gamma = mag_tr / mag_tr_stat\n        \n        results.append(gamma)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}