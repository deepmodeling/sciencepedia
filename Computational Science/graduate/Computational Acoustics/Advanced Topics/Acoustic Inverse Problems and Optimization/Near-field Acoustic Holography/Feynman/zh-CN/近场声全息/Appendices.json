{
    "hands_on_practices": [
        {
            "introduction": "近场声全息（NAH）的核心是利用角谱法在平行平面之间传播声场的能力。该方法首先将声场变换到波数域，然后应用一个传播算子，最后再逆变换回空间域。这个算子的形式关键地取决于波的各个分量是传播波还是倏逝波。\n\n这项动手编程练习将指导您从亥姆霍兹方程这一第一性原理出发，亲手构建传播算子。通过在不同场景下实现并测试它，您将对正向传播的稳定性、反向传播的内在不稳定性，以及为获得有意义的结果而必须采用正则化技术的原因，形成具体而深刻的理解 。",
            "id": "4130700",
            "problem": "在二维空间网格中，从由标量亥姆霍兹方程控制的频域线性声学模型出发，为近场声全息（NAH）实现一个离散角谱传播算子。假设存在一个时谐声压场，其角频率为 $\\omega$、波数量为 $k$、声速为 $c$，使得压强场 $p(x,y,z)$ 在均匀、无损耗介质中的线性声学常规假设下满足亥姆霍兹方程。使用基于 $(x,y)$ 上的二维空间傅里叶变换的角谱表示法，获得关于 $z$ 的模态内容的可分离常微分方程，并强制施加出射波（Sommerfeld 辐射）条件来确定纵向模态波数的正确分支。从此起点出发，推导笛卡尔网格上的离散传播算子，并正确处理传播分量（横向波数大小小于声波数）和倏逝分量（横向波数大小超过声波数），使用与辐射条件一致的适当的复值纵向波数分支。\n\n您的程序必须以自包含的方式实现以下内容：\n\n- 使用基本依据，即时谐压力 $p(x,y,z)$ 满足 $(\\nabla^2 + k^2)p = 0$，其中 $k = \\omega/c = 2\\pi f/c$，$f$ 是以赫兹为单位的时间频率，$c$ 是以米/秒为单位的声速。在 $(x,y)$ 上应用二维傅里叶变换以分离变量，并推导出每个空间频率模式沿 $z$ 方向的常微分方程。不要假设任何预先推导的传播算子；从这些原理出发推导它，并使用辐射条件强制采用物理上正确的分支。\n- 在大小为 $N_x \\times N_y$、间距为 $\\Delta x$ 和 $\\Delta y$（单位为米）的均匀网格上对空间域进行离散化。使用与物理单位中 $2\\pi$ 周期傅里叶核一致的标准离散傅里叶变换频率约定，构建相应的离散空间频率网格 $k_x$ 和 $k_y$（单位为弧度/米）。\n- 根据 $k$、$k_x$ 和 $k_y$ 构建复值纵向波数 $k_z$，选择与辐射条件一致的分支，该分支在 $z$ 方向的正向传播中产生衰减的倏逝模式，并产生出射的传播模式。使用此 $k_z$ 为传播距离 $z$（单位为米）构建正向算子 $H_{\\mathrm{fwd}}(k_x,k_y;z)$ 和反向算子 $H_{\\mathrm{back}}(k_x,k_y;z)$。正向算子将场从 $z=0$ 传播到 $z0$，反向算子将场从 $z0$ 反向传播到 $z=0$。\n- 为反向算子实现一个仅作用于倏逝内容的高斯锥形正则化。具体来说，定义 $k_t=\\sqrt{k_x^2 + k_y^2}$ 和一个无量纲正则化参数 $\\beta0$。使用锥形窗 $W(k_t) = \\exp\\left(-\\left(\\max(0,k_t-k)/(\\beta k)\\right)^2\\right)$，使得对于 $k_t \\le k$ 时 $W(k_t)=1$，并对于 $k_tk$ 时平滑地仅抑制倏逝分量。定义正则化反向算子 $H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}}$。\n- 通过计算离散网格上算子的以下四个无量纲度量，数值表征当 $k_t$ 从下方和上方接近 $k$ 时的稳定性：\n  $1)$ 正向算子的最大幅值 $\\max |H_{\\mathrm{fwd}}|$，\n  $2)$ 反向算子的最大幅值 $\\max |H_{\\mathrm{back}}|$，\n  $3)$ 正则化反向算子的最大幅值 $\\max |H_{\\mathrm{back,reg}}|$，\n  $4)$ 传播模式中的最小归一化纵向波数 $\\min_{k_t \\le k} |k_z|/k$。\n- 所有涉及距离的量必须以米表示，所有频率以赫兹表示，所有速度以米/秒表示。所要求的输出是无量纲的。\n\n使用以下参数集测试套件来检验不同情况，包括一般情况、近掠射边界条件（$k_t$ 接近 $k$）和长距离反向传播边缘情况。对于每种情况，请使用给定的 $(N_x,N_y,\\Delta x,\\Delta y,f,c,z,\\beta)$ 值：\n\n- 情况 A（具有大量倏逝内容但反向传播距离适中的常规路径）：$N_x = 128$，$N_y = 128$，$\\Delta x = 8\\times 10^{-3}$ 米，$\\Delta y = 8\\times 10^{-3}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 5\\times 10^{-2}$ 米，$\\beta = 0.25$。\n- 情况 B（近掠射采样，其中最大横向波数接近 $k$）：$N_x = 128$，$N_y = 128$，$\\Delta x = 5.5\\times 10^{-2}$ 米，$\\Delta y = 5.5\\times 10^{-2}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 1\\times 10^{-1}$ 米，$\\beta = 0.25$。\n- 情况 C（无正则化和有正则化下的强反向传播放大）：$N_x = 128$，$N_y = 128$，$\\Delta x = 8\\times 10^{-3}$ 米，$\\Delta y = 8\\times 10^{-3}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 2\\times 10^{-1}$ 米，$\\beta = 0.25$。\n\n对于每种情况，按顺序 $[\\max |H_{\\mathrm{fwd}}|,\\ \\max |H_{\\mathrm{back}}|,\\ \\max |H_{\\mathrm{back,reg}}|,\\ \\min_{k_t \\le k} |k_z|/k]$ 计算上述四个度量。您的程序应生成单行输出，其中包含所有三种情况的结果，格式为一个逗号分隔的列表，该列表包含三个按案例划分的列表，并用方括号括起来，例如 $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$。输出必须是浮点数。不应打印任何附加文本。",
            "solution": "问题陈述在科学上是合理的、适定的，并提供了推导和实现用于近场声全息的离散角谱传播算子所需的所有必要信息。其基础模型是标量亥姆霍兹方程，这是线性声学的基石。所要求的推导遵循一个标准且物理上正确的程序，涉及空间傅里叶变换和 Sommerfeld 辐射条件的应用。测试用例的参数在物理上是现实的，并且其选择旨在突显传播算子的关键行为，例如反向传播的不稳定性以及正则化的效果。因此，该问题被认为是有效的。\n\n推导和实现过程如下。\n\n在均匀、无损耗介质中，角频率为 $\\omega$ 的时谐波的声压场 $p(x,y,z)$ 由标量亥姆霍兹方程控制：\n$$ (\\nabla^2 + k^2)p(x,y,z) = 0 $$\n其中 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ 是拉普拉斯算子，$k = \\omega/c = 2\\pi f/c$ 是声波数，其中 $f$ 是时间频率，$c$ 是声速。\n\n为使用角谱法求解此偏微分方程，我们对横向坐标 $(x,y)$ 应用二维空间傅里叶变换。变换对定义为：\n$$ P(k_x, k_y, z) = \\mathcal{F}_{xy}\\{p(x,y,z)\\} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} p(x,y,z) e^{-i(k_x x + k_y y)} dx dy $$\n$$ p(x,y,z) = \\frac{1}{(2\\pi)^2} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} P(k_x, k_y, z) e^{i(k_x x + k_y y)} dk_x dk_y $$\n此处，$P(k_x, k_y, z)$ 是压强场的角谱，表示横向波矢量为 $(k_x, k_y)$ 的平面波分量的振幅。将此变换逐项应用于亥姆霍兹方程，并利用傅里叶变换的微分性质 $\\mathcal{F}\\{\\frac{\\partial^n f}{\\partial x^n}\\} = (ik_x)^n \\mathcal{F}\\{f\\}$，我们得到：\n$$ (-k_x^2 - k_y^2 + \\frac{d^2}{dz^2} + k^2) P(k_x, k_y, z) = 0 $$\n令 $k_t = \\sqrt{k_x^2 + k_y^2}$ 为横向波矢量的大小，该方程简化为对每个空间频率分量 $(k_x, k_y)$ 的关于 $z$ 的二阶常微分方程：\n$$ \\frac{d^2P}{dz^2} + (k^2 - k_t^2)P = 0 $$\n定义纵向波数 $k_z$ 为 $k_z^2 = k^2 - k_t^2$，方程变为：\n$$ \\frac{d^2P}{dz^2} + k_z^2 P = 0 $$\n该常微分方程的通解为 $P(z) = A e^{ik_z z} + B e^{-ik_z z}$。为了确定系数 $A$ 和 $B$，我们强制施加 Sommerfeld 辐射条件，该条件规定对于无源区域 $z>0$，波必须要么从源平面（假设在 $z=0$）传播出去，要么在 $z \\to \\infty$ 时衰减至零。假设时间依赖性为 $e^{-i\\omega t}$，则在 $+z$ 方向传播的波具有 $e^{i(k_z z - \\omega t)}$ 的形式。因此，我们必须选择 $e^{ik_z z}$ 项，这意味着 $B=0$。$A$ 的值由 $z=0$ 处的场确定，得出 $A = P(k_x,k_y,0)$。因此解为：\n$$ P(k_x,k_y,z) = P(k_x,k_y,0) e^{ik_z z} $$\n必须选择 $k_z = \\sqrt{k^2 - k_t^2}$ 的正确分支以满足辐射条件：\n$1$. 对于传播波（$k_t^2 \\le k^2$），$k_z$ 是实数。我们选择正根，$k_z = \\sqrt{k^2 - k_t^2}$，对应于正向传播。\n$2$. 对于倏逝波（$k_t^2 > k^2$），$k_z$ 是虚数。我们必须选择具有正虚部的根，$k_z = i\\sqrt{k_t^2 - k^2}$，这样 $e^{ik_z z} = e^{-\\sqrt{k_t^2-k^2}z}$ 就表示随着 $z$ 增加而衰减的场。\n通过选择 $k^2 - k_t^2$ 的具有非负实部和虚部的根，可以同时满足这两个条件。\n\n将场从 $z_0=0$ 平面传播到 $z>0$ 平面的正向传播算子 $H_{\\mathrm{fwd}}$ 由下式给出：\n$$ H_{\\mathrm{fwd}}(k_x,k_y; z) = e^{ik_z z} $$\n从 $z>0$ 处的场重建 $z=0$ 处场的反向传播算子 $H_{\\mathrm{back}}$ 是正向算子的逆：\n$$ H_{\\mathrm{back}}(k_x,k_y; z) = \\frac{1}{H_{\\mathrm{fwd}}(k_x,k_y; z)} = e^{-ik_z z} $$\n正向算子的幅值为 $|H_{\\mathrm{fwd}}| = |e^{ik_z z}|$。对于传播波，$k_z$ 是实数，$|H_{\\mathrm{fwd}}|=1$。对于倏逝波，$k_z$ 是虚数，$|H_{\\mathrm{fwd}}| = e^{-\\text{Im}(k_z)z}  1$。因此，正向传播是一个稳定的过程。\n相反，反向算子的幅值为 $|H_{\\mathrm{back}}| = |e^{-ik_z z}|$。对于传播波，$|H_{\\mathrm{back}}|=1$。对于倏逝波，$|H_{\\mathrm{back}}| = e^{\\text{Im}(k_z)z} > 1$。高频分量（大的 $k_t$）的这种指数级放大使得反向传播成为一个不适定逆问题，对噪声高度敏感。\n\n为了稳定反向传播，应用了正则化锥形窗 $W$。问题指定了一个仅作用于倏逝内容（$k_t > k$）的高斯锥形窗：\n$$ W(k_t) = \\exp\\left(-\\left(\\frac{\\max(0, k_t - k)}{\\beta k}\\right)^2\\right) $$\n其中 $\\beta > 0$ 是一个控制锥形窗宽度的无量纲参数。正则化的反向算子则为：\n$$ H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}} $$\n该锥形窗平滑地抑制了倏逝波的放大，使得重建过程更加稳健。\n\n在大小为 $N_x \\times N_y$、间距为 $\\Delta x$ 和 $\\Delta y$ 的离散网格上，连续波数 $(k_x, k_y)$ 被它们的离散对应物所取代，这些离散对应物从离散傅里叶变换（DFT）的频率约定中获得：\n$$ k_{x,n} = \\frac{2\\pi n}{N_x \\Delta x}, \\quad k_{y,m} = \\frac{2\\pi m}{N_y \\Delta y} $$\n其中 $n$ 和 $m$ 是对应于 DFT 仓的整数索引。\n\n然后在此离散网格上计算所需的度量：\n$1$. $\\max |H_{\\mathrm{fwd}}|$: 正向算子的最大幅值。理论上，这应该是 $1$。\n$2$. $\\max |H_{\\mathrm{back}}|$: 不稳定反向算子的最大幅值，它衡量了最坏情况下的放大。\n$3$. $\\max |H_{\\mathrm{back,reg}}|$: 正则化反向算子的最大幅值，量化了通过正则化实现的稳定性。\n$4$. $\\min_{k_t \\le k} |k_z|/k$: 传播模式的最小归一化纵向波数。当网格上的最高频率传播模式越来越接近 $k_t=k$ 边界时，该度量接近 $0$，这种情况发生在“掠射”条件下。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes the discrete angular-spectrum propagation operator\n    for Near-Field Acoustic Holography (NAH).\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path with significant evanescent content\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 5e-2, \"beta\": 0.25\n        },\n        # Case B: Near-grazing sampling condition\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 5.5e-2, \"dy\": 5.5e-2, \n            \"f\": 3000, \"c\": 343, \"z\": 1e-1, \"beta\": 0.25\n        },\n        # Case C: Strong back-propagation amplification\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 2e-1, \"beta\": 0.25\n        },\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        dx = params[\"dx\"]\n        dy = params[\"dy\"]\n        f = params[\"f\"]\n        c = params[\"c\"]\n        z = params[\"z\"]\n        beta = params[\"beta\"]\n\n        # 1. Calculate acoustic wavenumber k\n        k = 2 * np.pi * f / c\n\n        # 2. Create discrete spatial frequency grids (kx, ky) in rad/m\n        kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n        ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n        kx, ky = np.meshgrid(kx_vec, ky_vec, indexing='ij')\n\n        # 3. Calculate transverse wavenumber grid kt\n        kt_squared = kx**2 + ky**2\n        kt = np.sqrt(kt_squared)\n\n        # 4. Calculate longitudinal wavenumber kz, ensuring correct physical branch\n        # This implementation robustly handles propagating and evanescent modes.\n        kz = np.zeros_like(kt, dtype=np.complex128)\n        \n        # Propagating modes: kt^2 = k^2\n        propagating_mask = kt_squared = k**2\n        kz[propagating_mask] = np.sqrt(k**2 - kt_squared[propagating_mask])\n\n        # Evanescent modes: kt^2 > k^2\n        evanescent_mask = ~propagating_mask\n        kz[evanescent_mask] = 1j * np.sqrt(kt_squared[evanescent_mask] - k**2)\n\n        # 5. Construct propagation operators\n        # Forward operator H_fwd\n        H_fwd = np.exp(1j * kz * z)\n        \n        # Backward operator H_back\n        H_back = np.exp(-1j * kz * z)\n\n        # 6. Construct regularized backward operator H_back_reg\n        # Gaussian taper W(kt)\n        taper_arg = np.maximum(0, kt - k) / (beta * k)\n        W = np.exp(-(taper_arg**2))\n        \n        H_back_reg = W * H_back\n\n        # 7. Compute the four dimensionless metrics\n        \n        # Metric 1: Maximum magnitude of the forward operator\n        max_abs_H_fwd = np.max(np.abs(H_fwd))\n\n        # Metric 2: Maximum magnitude of the backward operator\n        max_abs_H_back = np.max(np.abs(H_back))\n        \n        # Metric 3: Maximum magnitude of the regularized backward operator\n        max_abs_H_back_reg = np.max(np.abs(H_back_reg))\n\n        # Metric 4: Minimum normalized longitudinal wavenumber among propagating modes\n        kz_propagating = kz[propagating_mask]\n        if kz_propagating.size > 0:\n            # np.abs is used for safety, though these kz values should be real\n            min_norm_kz = np.min(np.abs(kz_propagating)) / k\n        else:\n            # This case should not happen as (kx,ky)=(0,0) is always propagating\n            min_norm_kz = 0.0\n\n        case_results = [\n            max_abs_H_fwd,\n            max_abs_H_back,\n            max_abs_H_back_reg,\n            min_norm_kz\n        ]\n        results.append(case_results)\n\n    # Format the final output string as specified in the problem\n    case_results_str = []\n    for r in results:\n        # Format each list of floats into a string \"[f1,f2,f3,f4]\"\n        case_results_str.append(f\"[{','.join(map(str, r))}]\")\n    \n    # Join the case strings into the final format \"[[...],[...],[...]]\"\n    final_output_str = f\"[{','.join(case_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "我们已经学习了如何实现传播算子，并理解了噪声如何限制我们能够可靠重建的波数范围。那么，这最终对声学图像的质量意味着什么呢？一个成像系统的空间分辨率，本质上由其能够处理的空间频率带宽决定。在近场声全息中，这个带宽同时受到硬件能力和噪声的共同制约。\n\n这项综合性练习旨在将抽象的波数带宽概念与具体的物理指标——空间分辨率——联系起来。通过推导一个类瑞利分辨率判据，您将综合运用对倏逝波、噪声限制和傅里叶分析的知识，来预测一个NAH系统能够分辨的最小细节，从而为其性能提供一个切实的量化评估 。",
            "id": "4130720",
            "problem": "在密度为 $\\rho$、声速为 $c$ 的均匀无损耗流体中，角频率为 $\\omega$ 的时谐声压场 $p(x,y,z)$ 满足亥姆霍兹方程 $\\nabla^{2} p + k^{2} p = 0$，其中 $k = \\omega / c$。在近场声全息（NAH）中，声场在 $z = z_{0} > 0$ 处的平面测量表面上被记录，并通过其关于横向坐标 $(x,y)$ 的二维空间傅里叶变换来表示，其中横向波数大小为 $k_{t} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$。对于 $k_{t} > k$ 的情况，相应的频谱分量是倏逝的，并从源平面 $z=0$ 向 $z>0$ 的区域衰减。\n\n假设存在以下科学上符合实际的模型：\n- 约定为 $p(\\mathbf{r},t) = \\Re\\{p(\\mathbf{r}) \\exp(-\\mathrm{i} \\omega t)\\}$。\n- 每个空间傅里叶分量的前向传播场服从色散关系 $k_{z}^{2} = k^{2} - k_{t}^{2}$，其中 $k_{z}$ 是轴向波数。对于 $k_{t} > k$ 的情况，记 $k_{z} = \\mathrm{i} \\gamma(k_{t})$，其中 $\\gamma(k_{t}) = \\sqrt{k_{t}^{2} - k^{2}}$，这会产生一个轴向衰减因子 $\\exp(-\\gamma z)$。\n- 源平面频谱的幅值有界，即对所有 $(k_{x},k_{y})$ 均有 $|P(k_{x},k_{y}; z=0)| \\leq P_{0}$，其中 $P_{0} > 0$ 是源平面上压力频谱振幅的一个已知界限。\n- 测量系统存在一个加性压力噪声基底，其均方根振幅为 $\\sigma_{p} > 0$，并假设其在 $(k_{x},k_{y})$ 上是谱白的且与信号无关。\n\n将测量平面 $z=z_{0}$ 上的最大可用横向波数 $k_{t,\\max}$ 定义为满足以下条件的最大 $k_{t} > k$：在 $z=z_{0}$ 处的倏逝分量幅值没有被噪声淹没，即当从 $z=0$ 处的最坏情况界限 $P_{0}$ 开始时，其幅值至少等于噪声基底 $\\sigma_{p}$。\n\n从基本的亥姆霍兹方程和平面波谱表示出发，推导 $k_{t,\\max}$ 作为 $k$、$z_{0}$、$P_{0}$ 和 $\\sigma_{p}$ 的函数的闭式解析表达式。最终答案以弧度/米为单位表示。不需要提供数值，只需提供符号表达式。如果 $P_{0} \\leq \\sigma_{p}$，你可以按照惯例假设 $k_{t,\\max} = k$（无可用的倏逝内容），但你推导的表达式应反映 $P_{0} > \\sigma_{p}$ 的一般情况。",
            "solution": "该问题要求在近场声全息（NAH）的背景下，推导最大可用横向波数 $k_{t,\\max}$ 的表达式。此推导从由亥姆霍兹方程和声场的平面波谱表示所描述的波传播基本原理开始。\n\n时谐声压场 $p(x,y,z)$ 由亥姆霍兹方程 $\\nabla^{2} p + k^{2} p = 0$ 控制，其中 $k = \\omega/c$ 是声波数。声场可以通过关于横向坐标 $(x,y)$ 的二维空间傅里叶变换表示为平面波的叠加。令 $P(k_x, k_y; z)$ 表示在给定轴向位置 $z$ 处声压场 $p(x,y,z)$ 的空间傅里叶变换。\n\n对于沿 z 轴正向传播的单个平面波分量，亥姆霍兹方程的解具有形式 $P(k_x, k_y; z) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z)$。轴向波数 $k_z$ 由色散关系确定，该关系通过将平面波形式代入亥姆霍兹方程得到：$k_z^2 + k_x^2 + k_y^2 = k^2$。将横向波数大小定义为 $k_t = \\sqrt{k_x^2 + k_y^2}$，色散关系变为 $k_z^2 = k^2 - k_t^2$。\n\n该问题关注的是倏逝波，这对应于 $k_t > k$ 的情况。对于这些分量，$k_z^2$ 是负数。问题指明，对于前向传播场（在 $z>0$ 时衰减），我们必须选择 $k_z$ 的具有正虚部的根。我们写作 $k_z = \\mathrm{i} \\sqrt{k_t^2 - k^2}$。这可以使用实值衰减常数 $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$ 来表示，从而 $k_z = \\mathrm{i} \\gamma(k_t)$。\n\n因此，一个倏逝频谱分量从源平面 $z=0$ 传播到测量平面 $z=z_0 > 0$ 的过程可由以下公式描述：\n$$P(k_x, k_y; z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} (\\mathrm{i} \\gamma(k_t)) z_0) = P(k_x, k_y; 0) \\exp(-\\gamma(k_t) z_0)$$\n对两边取幅值得到：\n$$|P(k_x, k_y; z_0)| = |P(k_x, k_y; 0)| \\exp(-\\gamma(k_t) z_0)$$\n此方程表明，倏逝分量的幅值随与源的距离 $z_0$ 呈指数衰减。衰减率随 $k_t$ 的增加而增加，因为 $\\gamma(k_t)$ 是 $k_t$ 的增函数。\n\n问题将最大可用横向波数 $k_{t,\\max}$ 定义为信号未被噪声淹没的最大 $k_t > k$。这可以通过将测量平面 $z=z_0$ 处的信号幅值设为等于噪声基底 $\\sigma_p$ 来量化。信号幅值在最坏情况（最大）的源条件下进行评估，该条件由界限 $|P(k_x, k_y; z=0)| \\leq P_0$ 给出。因此，我们设定 $|P(k_x, k_y; z=0)| = P_0$。\n\n因此，$k_{t,\\max}$ 的定义方程为：\n$$P_0 \\exp(-\\gamma(k_{t,\\max}) z_0) = \\sigma_p$$\n我们被要求求解 $P_0 > \\sigma_p$ 的情况，这确保了存在一个非平凡范围的可用倏逝波数。我们继续求解 $k_{t,\\max}$：\n$$\\exp(-\\gamma(k_{t,\\max}) z_0) = \\frac{\\sigma_p}{P_0}$$\n对两边取自然对数：\n$$-\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{\\sigma_p}{P_0}\\right)$$\n使用对数恒等式 $\\ln(a/b) = -\\ln(b/a)$，我们得到：\n$$\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n分离出 $\\gamma(k_{t,\\max})$：\n$$\\gamma(k_{t,\\max}) = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n现在，我们代入衰减常数的定义 $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$：\n$$\\sqrt{k_{t,\\max}^2 - k^2} = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n为了求解 $k_{t,\\max}$，我们将方程两边平方。由于 $k_{t,\\max} > k$ 并且我们考虑的是 $P_0 > \\sigma_p$ 的情况，所以两边都为正，这个操作是有效的。\n$$k_{t,\\max}^2 - k^2 = \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\n最后，我们分离出 $k_{t,\\max}^2$ 并取正平方根，因为波数大小必须为非负：\n$$k_{t,\\max}^2 = k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\n$$k_{t,\\max} = \\sqrt{k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2}$$\n这个表达式给出了最大可用横向波数作为给定参数 $k$、$z_0$、$P_0$ 和 $\\sigma_p$ 的函数。单位是一致的：$k$ 的单位是 弧度/米，$z_0$ 的单位是 米，比值 $P_0/\\sigma_p$ 是无量纲的，这使得整个表达式的单位符合要求，为 弧度/米。",
            "answer": "$$ \\boxed{\\sqrt{k^{2} + \\left(\\frac{1}{z_{0}} \\ln\\left(\\frac{P_{0}}{\\sigma_{p}}\\right)\\right)^{2}}} $$"
        },
        {
            "introduction": "我们已经学习了如何实现传播算子，并理解了噪声如何限制我们能够可靠重建的波数范围。那么，这最终对声学图像的质量意味着什么呢？一个成像系统的空间分辨率，本质上由其能够处理的空间频率带宽决定。在近场声全息中，这个带宽同时受到硬件能力和噪声的共同制约。\n\n这项综合性练习旨在将抽象的波数带宽概念与具体的物理指标——空间分辨率——联系起来。通过推导一个类瑞利分辨率判据，您将综合运用对倏逝波、噪声限制和傅里叶分析的知识，来预测一个NAH系统能够分辨的最小细节，从而为其性能提供一个切实的量化评估 。",
            "id": "4130738",
            "problem": "一个位于 $z=0$ 的平面麦克风阵列测量由位于平面 $z=-z_{0}$ 上的源分布在一个声速为 $c$ 的均匀、无损介质中辐射的复声压场 $p(x,0)$。该声场满足标量亥姆霍兹方程 $\\nabla^{2}p + k^{2}p = 0$，其中 $k = \\omega/c$ 是声波数。近场声全息（Near-field Acoustic Holography, NAH）技术通过对横向坐标 $x$ 进行空间傅里叶变换，并利用平面波因子 $\\exp(i k_{z} z)$（其中 $k_{z} = \\sqrt{k^{2} - k_{x}^{2}}$）进行反向传播，来重建源平面声场 $p(x,-z_{0})$。对于 $|k_{x}| \\leq k$，$k_{z}$ 为实数（传播分量）。对于 $|k_{x}| > k$，$k_{z} = i \\alpha$，其中 $\\alpha = \\sqrt{k_{x}^{2} - k^{2}}$（倏逝分量）。\n\n假设重建在横向波数域采用一个矩形低通滤波器，受硬件/处理带宽 $K_{B}$ 的限制（即，保留 $|k_{x}| \\leq K_{B}$ 的分量），并应用截断的逆向反传播，舍弃那些其逆滤波器幅值会超过由全局测量信噪比 $S_{0} > 1$ 指定的无量纲噪声阈值的倏逝分量。也就是说，逆增益 $\\exp(\\alpha z_{0}) > S_{0}$ 的倏逝分量被舍弃。考虑在源平面 $z=-z_{0}$ 上，沿 $x$ 方向相距 $\\Delta x$ 的两个等强度、同相位的线声源。\n\n从亥姆霍兹方程和平面波表示出发，将重建过程视为一个沿 $x$ 方向的带限、移不变系统，其点扩散函数是保留的横向频谱的傅里叶逆变换，完成以下任务：\n\n- 为深度为 $z_{0}$ 的NAH定义一个沿 $x$ 方向的瑞利型分辨率判据，要求最小可分辨距离 $\\Delta x_{R}(z_{0})$ 是使得一个重建的点扩散函数的中心最大值与另一个的第一个零点重合的最小 $\\Delta x$。\n- 推导 $\\Delta x_{R}(z_{0})$ 如何共同取决于保留的横向波数带宽和上述由噪声驱动的截断。\n\n将最终分辨率 $\\Delta x_{R}(z_{0})$ 表示为以米为单位的闭式解析表达式，用 $k$、$z_{0}$、$K_{B}$ 和 $S_{0}$ 表示。无需代入数值，也无需四舍五入。最终答案必须是单一的解析表达式。",
            "solution": "首先验证问题，以确保其在科学上是合理的、内容自洽且适定的。\n\n**第一步：提取已知条件**\n- 控制方程：亥姆霍兹方程，$\\nabla^{2}p + k^{2}p = 0$。\n- 声波数：$k = \\omega/c$。\n- 源平面位置：$z = -z_{0}$。\n- 测量平面位置：$z = 0$。\n- 横向坐标：$x$。\n- 前向传播的波数域关系：$P(k_x, z_2) = P(k_x, z_1) \\exp(ik_z(z_2-z_1))$。\n- 横向波数 $k_z$ 的定义：\n  - 对于传播波 ($|k_x| \\leq k$)：$k_z = \\sqrt{k^2 - k_x^2}$。\n  - 对于倏逝波 ($|k_x| > k$)：$k_z = i\\alpha$，其中 $\\alpha = \\sqrt{k_x^2 - k^2}$。\n- 重建约束1（硬件带宽）：在 $k_x$ 域中的一个矩形低通滤波器只保留 $|k_x| \\leq K_B$ 的分量。\n- 重建约束2（噪声截断）：如果倏逝分量的逆滤波器增益 $\\exp(\\alpha z_{0})$ 超过信噪比阈值 $S_{0} > 1$，则该分量被舍弃。\n- 分辨率判据：瑞利型分辨率 $\\Delta x_{R}(z_{0})$ 是从重建的点扩散函数的中心最大值到其第一个零点的距离。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上基于波传播、傅里叶声学和反问题理论的原理，这些都是近场声全息（NAH）的核心。亥姆霍兹方程和平面波展开是标准模型。所指定的约束，即硬件带宽限制和针对倏逝波的基于噪声的正则化，代表了一个实际（尽管是简化的）NAH系统的模型。重建倏逝波的不适定性（噪声的指数级放大）被正确地指出，而基于信噪比 $S_0$ 的截断是一种标准的正则化形式。问题是客观的、适定的，并且所有术语都已明确定义，从而能够得到唯一的解析解。不存在科学缺陷、矛盾或含糊之处。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n**分辨率的推导**\n\n从平面 $z=0$ 处的测量值重建源平面 $z=-z_0$ 处的声场是一个反问题。设 $p(x,z)$ 为复声压场，$P(k_x,z)$ 为其关于横向坐标 $x$ 的空间傅里叶变换。在傅里叶域中，源平面和测量平面上声场之间的关系由传播算子给出：\n$$ P(k_x, 0) = P(k_x, -z_0) \\exp(ik_z z_0) $$\n重建过程旨在从测量的 $P(k_x, 0)$ 计算出 $P(k_x, -z_0)$ 的估计值。这涉及到应用一个逆滤波器，理想情况下为 $H_{ideal}(k_x) = \\exp(-ik_z z_0)$。\n\n问题指出，重建是一个线性移不变（LSI）系统。该系统的整体行为由其传递函数 $H(k_x)$ 描述，该函数决定了哪些空间频率分量被保留。如果一个分量 $k_x$ 满足所有指定的约束，它就会被保留。对于保留的分量，传递函数 $H(k_x)$ 为1；对于被舍弃的分量，传递函数为0。\n\n我们来分析对保留的波数 $k_x$ 的约束条件。\n1.  **硬件带宽限制**：重建过程受到最大横向波数 $K_B$ 的带限，因此只有 $|k_x| \\leq K_B$ 的分量被处理。\n2.  **噪声驱动的截断**：此约束适用于倏逝波，对于这些波，有 $|k_x|k$ 且 $k_z = i\\alpha = i\\sqrt{k_x^2-k^2}$。这些分量的逆滤波器增益（幅值）为 $|\\exp(-ik_z z_0)| = |\\exp(-i(i\\alpha)z_0)| = \\exp(\\alpha z_0)$。问题指出，如果此增益大于 $S_0$，则分量被舍弃。因此，倏逝分量仅在以下情况下被保留：\n    $$ \\exp(\\alpha z_0) \\leq S_0 $$\n    代入 $\\alpha = \\sqrt{k_x^2 - k^2}$，我们得到：\n    $$ \\exp\\left(z_0 \\sqrt{k_x^2 - k^2}\\right) \\leq S_0 $$\n    对两边取自然对数（因为 $S_0 > 1$，所以 $\\ln(S_0) > 0$）：\n    $$ z_0 \\sqrt{k_x^2 - k^2} \\leq \\ln(S_0) $$\n    $$ \\sqrt{k_x^2 - k^2} \\leq \\frac{\\ln(S_0)}{z_0} $$\n    两边平方并重新整理，得到关于 $k_x^2$ 的条件：\n    $$ k_x^2 - k^2 \\leq \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    $$ k_x^2 \\leq k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    这意味着由于噪声的存在，横向波数的幅值有一个上限：\n    $$ |k_x| \\leq \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2} $$\n    我们将这个由噪声施加的截止波数定义为 $K_{noise} = \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}$。\n\n重建系统仅在空间频率分量 $k_x$ *同时*满足硬件和噪声约束时才保留该分量。这意味着有效通带是两个区域的交集。因此，最大保留横向波数 $K_{eff}$ 是两个独立截止波数中的最小值：\n$$ K_{eff} = \\min\\left(K_B, K_{noise}\\right) = \\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right) $$\nLSI重建系统的传递函数是波数域中的一个矩形窗：\n$$ H(k_x) = \\begin{cases} 1  \\text{if } |k_x| \\leq K_{eff} \\\\ 0  \\text{if } |k_x|  K_{eff} \\end{cases} $$\n系统的点扩散函数（PSF） $h(x)$ 是其传递函数 $H(k_x)$ 的傅里叶逆变换。对于一维系统，傅里叶逆变换定义为：\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(k_x) e^{ik_x x} dk_x $$\n代入 $H(k_x)$ 的表达式：\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-K_{eff}}^{K_{eff}} (1) \\cdot e^{ik_x x} dk_x $$\n计算积分：\n$$ h(x) = \\frac{1}{2\\pi} \\left[ \\frac{e^{ik_x x}}{ix} \\right]_{-K_{eff}}^{K_{eff}} = \\frac{1}{2\\pi ix} \\left( e^{iK_{eff}x} - e^{-iK_{eff}x} \\right) $$\n使用欧拉公式 $\\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i}$，我们可以将其简化为：\n$$ h(x) = \\frac{1}{2\\pi ix} \\left( 2i\\sin\\left(K_{eff}x\\right) \\right) = \\frac{\\sin(K_{eff}x)}{\\pi x} $$\n该表达式是一个缩放的sinc函数。其中心最大值位于 $x=0$。\n\n根据问题中定义的瑞利型分辨率判据，最小可分辨距离 $\\Delta x_R(z_0)$ 是从PSF的中心最大值到其第一个零点的距离。$h(x)$ 的零点出现在分子为零且分母不为零（即 $x \\neq 0$）时。\n$$ \\sin(K_{eff}x) = 0 $$\n当 $K_{eff}x = n\\pi$（其中 $n$ 为任意非零整数）时，此条件得到满足。第一个零点对应于 $n=1$（或 $n=-1$），这给出：\n$$ K_{eff}|x| = \\pi $$\n到这个第一个零点的距离是 $|x| = \\frac{\\pi}{K_{eff}}$。根据定义，这就是分辨率极限。\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{K_{eff}} $$\n代入 $K_{eff}$ 的表达式：\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)} $$\n这是分辨率的最终解析表达式，显示了它对硬件带宽 $K_B$ 和噪声驱动截断的共同依赖关系，而噪声驱动截断本身又取决于 $k$、$z_0$ 和 $S_0$。分辨率受到两个约束中更严格的那个的限制（即，给出更小截止波数的那个）。",
            "answer": "$$ \\boxed{\\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)}} $$"
        }
    ]
}