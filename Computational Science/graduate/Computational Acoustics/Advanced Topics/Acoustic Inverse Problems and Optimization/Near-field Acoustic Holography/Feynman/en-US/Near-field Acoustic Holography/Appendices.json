{
    "hands_on_practices": [
        {
            "introduction": "The angular spectrum method is the computational engine of planar Near-field Acoustic Holography (NAH). This first practice takes you under the hood, guiding you to implement the forward and backward propagation operators from first principles. By coding these operators yourself, you will gain a concrete understanding of how propagating waves maintain their amplitude while evanescent waves decay or grow, directly confronting the numerical instability inherent in back-propagation and the necessity of regularization .",
            "id": "4130700",
            "problem": "Implement a discrete angular-spectrum propagation operator for Near-Field Acoustic Holography (NAH) within a two-dimensional spatial grid, starting from the frequency-domain linear acoustics model governed by the scalar Helmholtz equation. Assume a time-harmonic acoustic pressure field with angular frequency $\\omega$, wavenumber $k$, and sound speed $c$, so that the pressure field $p(x,y,z)$ satisfies the Helmholtz equation under the usual assumptions of linear acoustics in a homogeneous, lossless medium. Use the angular spectrum representation based on the two-dimensional spatial Fourier transform over $(x,y)$ to obtain a separable ordinary differential equation in $z$ for the modal content, and enforce the outgoing-wave (Sommerfeld radiation) condition to determine the correct branch for the longitudinal modal wavenumber. From this starting point, derive the discrete propagation operator on a Cartesian grid, with correct handling of both propagating components (where the transverse wavenumber magnitude is less than the acoustic wavenumber) and evanescent components (where the transverse wavenumber magnitude exceeds the acoustic wavenumber), using the appropriate complex-valued longitudinal wavenumber branch consistent with the radiation condition.\n\nYour program must implement the following in a self-contained way:\n\n- Use the fundamental basis that the time-harmonic pressure $p(x,y,z)$ satisfies $(\\nabla^2 + k^2)p = 0$ with $k = \\omega/c = 2\\pi f/c$, where $f$ is the temporal frequency in hertz and $c$ is the speed of sound in meters per second. Apply a two-dimensional Fourier transform in $(x,y)$ to separate variables and deduce the ordinary differential equation for each spatial frequency mode along $z$. Do not assume any pre-derived propagation operator; derive it from these principles and enforce the physically correct branch using the radiation condition.\n- Discretize the spatial domain on a uniform grid of size $N_x \\times N_y$ with spacings $\\Delta x$ and $\\Delta y$ in meters. Form the corresponding discrete spatial frequency grids $k_x$ and $k_y$ (in radians per meter) using the standard discrete Fourier transform frequency conventions consistent with a $2\\pi$-periodic Fourier kernel in physical units.\n- Construct the complex-valued longitudinal wavenumber $k_z$ from $k$, $k_x$, and $k_y$, selecting the branch that yields decaying evanescent modes for forward propagation in $z$ and outgoing propagating modes, consistent with the radiation condition. Use this to build the forward operator $H_{\\mathrm{fwd}}(k_x,k_y;z)$ and the backward operator $H_{\\mathrm{back}}(k_x,k_y;z)$ for a propagation distance $z$ in meters. The forward operator propagates fields from $z=0$ to $z>0$, and the backward operator back-propagates fields from $z>0$ to $z=0$.\n- Implement a Gaussian taper regularization that acts only on evanescent content for the backward operator. Specifically, define $k_t=\\sqrt{k_x^2 + k_y^2}$ and a dimensionless regularization parameter $\\beta>0$. Use a taper $W(k_t) = \\exp\\left(-\\left(\\frac{\\max(0, k_t-k)}{\\beta k}\\right)^2\\right)$ so that $W(k_t)=1$ for $k_t \\le k$ and smoothly suppresses only evanescent components for $k_t>k$. Define the regularized backward operator $H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}}$.\n- Numerically characterize the stability as $k_t$ approaches $k$ from below and above by computing the following four dimensionless metrics from the operators on the discrete grid:\n  $1)$ the maximum magnitude of the forward operator $\\max |H_{\\mathrm{fwd}}|$,\n  $2)$ the maximum magnitude of the backward operator $\\max |H_{\\mathrm{back}}|$,\n  $3)$ the maximum magnitude of the regularized backward operator $\\max |H_{\\mathrm{back,reg}}|$,\n  $4)$ the minimum normalized longitudinal wavenumber among propagating modes, $\\min_{k_t \\le k} |k_z|/k$.\n- All quantities involving distances must be expressed in meters, all frequencies in hertz, and all speeds in meters per second. The requested outputs are dimensionless.\n\nUse the following test suite of parameter sets to exercise different regimes, including a general case, a near-grazing boundary condition where $k_t$ approaches $k$, and a longer-distance back-propagation edge case. For each case, use the given values for $(N_x,N_y,\\Delta x,\\Delta y,f,c,z,\\beta)$:\n\n- Case A (happy path with substantial evanescent content but moderate back-propagation distance): $N_x = 128$, $N_y = 128$, $\\Delta x = 8\\times 10^{-3}$ meters, $\\Delta y = 8\\times 10^{-3}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 5\\times 10^{-2}$ meters, $\\beta = 0.25$.\n- Case B (near-grazing sampling where the maximum transverse wavenumber is close to $k$): $N_x = 128$, $N_y = 128$, $\\Delta x = 5.5\\times 10^{-2}$ meters, $\\Delta y = 5.5\\times 10^{-2}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 1\\times 10^{-1}$ meters, $\\beta = 0.25$.\n- Case C (strong back-propagation amplification without and with regularization): $N_x = 128$, $N_y = 128$, $\\Delta x = 8\\times 10^{-3}$ meters, $\\Delta y = 8\\times 10^{-3}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 2\\times 10^{-1}$ meters, $\\beta = 0.25$.\n\nFor each case, compute the four metrics listed above in the order $[\\max |H_{\\mathrm{fwd}}|,\\ \\max |H_{\\mathrm{back}}|,\\ \\max |H_{\\mathrm{back,reg}}|,\\ \\min_{k_t \\le k} |k_z|/k]$. Your program should produce a single line of output containing the results for all three cases as a comma-separated list of the three per-case lists, enclosed in square brackets, for example, $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$. The outputs must be floating-point numbers. No additional text should be printed.",
            "solution": "The problem statement is scientifically sound, well-posed, and provides all necessary information to derive and implement the discrete angular-spectrum propagation operator for near-field acoustic holography. The underlying model is the scalar Helmholtz equation, a cornerstone of linear acoustics. The requested derivation follows a standard and physically correct procedure involving the spatial Fourier transform and the application of the Sommerfeld radiation condition. The parameters for the test cases are physically realistic and chosen to highlight key behaviors of the propagation operators, such as the instability of back-propagation and the effect of regularization. The problem is therefore deemed valid.\n\nThe derivation and implementation proceed as follows.\n\nThe acoustic pressure field $p(x,y,z)$ for a time-harmonic wave with angular frequency $\\omega$ in a homogeneous, lossless medium is governed by the scalar Helmholtz equation:\n$$ (\\nabla^2 + k^2)p(x,y,z) = 0 $$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ is the Laplacian operator and $k = \\omega/c = 2\\pi f/c$ is the acoustic wavenumber, with $f$ being the temporal frequency and $c$ the speed of sound.\n\nTo solve this partial differential equation using the angular spectrum method, we apply a two-dimensional spatial Fourier transform with respect to the transverse coordinates $(x,y)$. The transform pair is defined as:\n$$ P(k_x, k_y, z) = \\mathcal{F}_{xy}\\{p(x,y,z)\\} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} p(x,y,z) e^{-i(k_x x + k_y y)} dx dy $$\n$$ p(x,y,z) = \\frac{1}{(2\\pi)^2} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} P(k_x, k_y, z) e^{i(k_x x + k_y y)} dk_x dk_y $$\nHere, $P(k_x, k_y, z)$ is the angular spectrum of the pressure field, representing the amplitude of the plane wave component with transverse wavevector $(k_x, k_y)$. Applying this transform to the Helmholtz equation term by term, and using the differentiation property of Fourier transforms, $\\mathcal{F}\\{\\frac{\\partial^n f}{\\partial x^n}\\} = (ik_x)^n \\mathcal{F}\\{f\\}$, we obtain:\n$$ (-k_x^2 - k_y^2 + \\frac{d^2}{dz^2} + k^2) P(k_x, k_y, z) = 0 $$\nLetting $k_t = \\sqrt{k_x^2 + k_y^2}$ be the magnitude of the transverse wavevector, the equation simplifies to a second-order ordinary differential equation in $z$ for each spatial frequency component $(k_x, k_y)$:\n$$ \\frac{d^2P}{dz^2} + (k^2 - k_t^2)P = 0 $$\nDefining the longitudinal wavenumber $k_z$ as $k_z^2 = k^2 - k_t^2$, the equation becomes:\n$$ \\frac{d^2P}{dz^2} + k_z^2 P = 0 $$\nThe general solution to this ODE is $P(z) = A e^{ik_z z} + B e^{-ik_z z}$. To determine the coefficients $A$ and $B$, we enforce the Sommerfeld radiation condition, which dictates that for a source-free region $z>0$, waves must either propagate away from the source plane (assumed at $z=0$) or decay to zero as $z \\to \\infty$. Assuming a time-dependence of $e^{-i\\omega t}$, a wave propagating in the $+z$ direction has the form $e^{i(k_z z - \\omega t)}$. Thus, we must select the $e^{ik_z z}$ term, which implies $B=0$. The value of $A$ is determined by the field at $z=0$, giving $A = P(k_x,k_y,0)$. The solution is therefore:\n$$ P(k_x,k_y,z) = P(k_x,k_y,0) e^{ik_z z} $$\nThe correct branch for $k_z = \\sqrt{k^2 - k_t^2}$ must be chosen to satisfy the radiation condition:\n$1$. For propagating waves ($k_t^2 \\le k^2$), $k_z$ is real. We choose the positive root, $k_z = \\sqrt{k^2 - k_t^2}$, corresponding to forward propagation.\n$2$. For evanescent waves ($k_t^2 > k^2$), $k_z$ is imaginary. We must choose the root with a positive imaginary part, $k_z = i\\sqrt{k_t^2 - k^2}$, so that $e^{ik_z z} = e^{-\\sqrt{k_t^2-k^2}z}$ represents a decaying field as $z$ increases.\nBoth conditions are satisfied by selecting the root of $k^2 - k_t^2$ that has a non-negative real and imaginary part.\n\nThe forward propagation operator $H_{\\mathrm{fwd}}$ that propagates the field from a plane at $z_0=0$ to a plane at $z>0$ is given by:\n$$ H_{\\mathrm{fwd}}(k_x,k_y; z) = e^{ik_z z} $$\nThe backward propagation operator $H_{\\mathrm{back}}$, which reconstructs the field at $z=0$ from the field at $z>0$, is the inverse of the forward operator:\n$$ H_{\\mathrm{back}}(k_x,k_y; z) = \\frac{1}{H_{\\mathrm{fwd}}(k_x,k_y; z)} = e^{-ik_z z} $$\nThe magnitude of the forward operator is $|H_{\\mathrm{fwd}}| = |e^{ik_z z}|$. For propagating waves, $k_z$ is real and $|H_{\\mathrm{fwd}}|=1$. For evanescent waves, $k_z$ is imaginary and $|H_{\\mathrm{fwd}}| = e^{-\\text{Im}(k_z)z} < 1$. Thus, forward propagation is a stable process.\nConversely, the magnitude of the backward operator is $|H_{\\mathrm{back}}| = |e^{-ik_z z}|$. For propagating waves, $|H_{\\mathrm{back}}|=1$. For evanescent waves, $|H_{\\mathrm{back}}| = e^{\\text{Im}(k_z)z} > 1$. This exponential amplification of high-frequency components (large $k_t$) makes the backward propagation an ill-posed inverse problem, highly sensitive to noise.\n\nTo stabilize the backward propagation, a regularization taper $W$ is applied. The problem specifies a Gaussian taper that acts only on the evanescent content ($k_t > k$):\n$$ W(k_t) = \\exp\\left(-\\left(\\frac{\\max(0, k_t - k)}{\\beta k}\\right)^2\\right) $$\nwhere $\\beta > 0$ is a dimensionless parameter controlling the taper width. The regularized backward operator is then:\n$$ H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}} $$\nThis taper smoothly suppresses the amplification of evanescent waves, making the reconstruction process more robust.\n\nOn a discrete grid of size $N_x \\times N_y$ with spacings $\\Delta x$ and $\\Delta y$, the continuous wavenumbers $(k_x, k_y)$ are replaced by their discrete counterparts, obtained from the Discrete Fourier Transform (DFT) frequency conventions:\n$$ k_{x,n} = \\frac{2\\pi n}{N_x \\Delta x}, \\quad k_{y,m} = \\frac{2\\pi m}{N_y \\Delta y} $$\nwhere $n$ and $m$ are integer indices corresponding to the DFT bins.\n\nThe required metrics are then computed on this discrete grid:\n$1$. $\\max |H_{\\mathrm{fwd}}|$: The maximum magnitude of the forward operator. Theoretically, this should be $1$.\n$2$. $\\max |H_{\\mathrm{back}}|$: The maximum magnitude of the unstable backward operator, which measures the worst-case amplification.\n$3$. $\\max |H_{\\mathrm{back,reg}}|$: The maximum magnitude of the regularized backward operator, quantifying the stability achieved by regularization.\n$4$. $\\min_{k_t \\le k} |k_z|/k$: The minimum normalized longitudinal wavenumber for propagating modes. This metric approaches $0$ as the highest-frequency propagating mode on the grid gets closer to the $k_t=k$ boundary, which occurs in \"grazing\" conditions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes the discrete angular-spectrum propagation operator\n    for Near-Field Acoustic Holography (NAH).\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path with significant evanescent content\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 5e-2, \"beta\": 0.25\n        },\n        # Case B: Near-grazing sampling condition\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 5.5e-2, \"dy\": 5.5e-2, \n            \"f\": 3000, \"c\": 343, \"z\": 1e-1, \"beta\": 0.25\n        },\n        # Case C: Strong back-propagation amplification\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 2e-1, \"beta\": 0.25\n        },\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        dx = params[\"dx\"]\n        dy = params[\"dy\"]\n        f = params[\"f\"]\n        c = params[\"c\"]\n        z = params[\"z\"]\n        beta = params[\"beta\"]\n\n        # 1. Calculate acoustic wavenumber k\n        k = 2 * np.pi * f / c\n\n        # 2. Create discrete spatial frequency grids (kx, ky) in rad/m\n        kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n        ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n        kx, ky = np.meshgrid(kx_vec, ky_vec, indexing='ij')\n\n        # 3. Calculate transverse wavenumber grid kt\n        kt_squared = kx**2 + ky**2\n        kt = np.sqrt(kt_squared)\n\n        # 4. Calculate longitudinal wavenumber kz, ensuring correct physical branch\n        # This implementation robustly handles propagating and evanescent modes.\n        kz = np.zeros_like(kt, dtype=np.complex128)\n        \n        # Propagating modes: kt^2 <= k^2\n        propagating_mask = kt_squared <= k**2\n        kz[propagating_mask] = np.sqrt(k**2 - kt_squared[propagating_mask])\n\n        # Evanescent modes: kt^2 > k^2\n        evanescent_mask = ~propagating_mask\n        kz[evanescent_mask] = 1j * np.sqrt(kt_squared[evanescent_mask] - k**2)\n\n        # 5. Construct propagation operators\n        # Forward operator H_fwd\n        H_fwd = np.exp(1j * kz * z)\n        \n        # Backward operator H_back\n        H_back = np.exp(-1j * kz * z)\n\n        # 6. Construct regularized backward operator H_back_reg\n        # Gaussian taper W(kt)\n        taper_arg = np.maximum(0, kt - k) / (beta * k)\n        W = np.exp(-(taper_arg**2))\n        \n        H_back_reg = W * H_back\n\n        # 7. Compute the four dimensionless metrics\n        \n        # Metric 1: Maximum magnitude of the forward operator\n        max_abs_H_fwd = np.max(np.abs(H_fwd))\n\n        # Metric 2: Maximum magnitude of the backward operator\n        max_abs_H_back = np.max(np.abs(H_back))\n        \n        # Metric 3: Maximum magnitude of the regularized backward operator\n        max_abs_H_back_reg = np.max(np.abs(H_back_reg))\n\n        # Metric 4: Minimum normalized longitudinal wavenumber among propagating modes\n        kz_propagating = kz[propagating_mask]\n        if kz_propagating.size > 0:\n            # np.abs is used for safety, though these kz values should be real\n            min_norm_kz = np.min(np.abs(kz_propagating)) / k\n        else:\n            # This case should not happen as (kx,ky)=(0,0) is always propagating\n            min_norm_kz = 0.0\n\n        case_results = [\n            max_abs_H_fwd,\n            max_abs_H_back,\n            max_abs_H_back_reg,\n            min_norm_kz\n        ]\n        results.append(case_results)\n\n    # Format the final output string as specified in the problem\n    case_results_str = []\n    for r in results:\n        # Format each list of floats into a string \"[f1,f2,f3,f4]\"\n        case_results_str.append(f\"[{','.join(map(str, r))}]\")\n    \n    # Join the case strings into the final format \"[[...],[...],[...]]\"\n    final_output_str = f\"[{','.join(case_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "In theory, the evanescent spectrum contains arbitrarily high spatial frequency information, suggesting unlimited resolution. In practice, however, every measurement system has a noise floor that ultimately limits what can be resolved. This exercise moves from implementation to physical analysis, asking you to derive the maximum usable transverse wavenumber based on a given signal-to-noise ratio . This crucial calculation demonstrates the fundamental trade-off in NAH: the closer you measure to the source, the more high-resolution information you can rescue from the noise.",
            "id": "4130720",
            "problem": "A time-harmonic acoustic pressure field $p(x,y,z)$ in a homogeneous, lossless fluid of density $\\rho$ and sound speed $c$ at angular frequency $\\omega$ satisfies the Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ with $k = \\omega / c$. In Near-field Acoustic Holography (NAH), the field is recorded on a planar measurement surface at $z = z_{0} > 0$ and represented via its two-dimensional spatial Fourier transform over the transverse coordinates $(x,y)$, with transverse wavenumber magnitude $k_{t} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$. For $k_{t} > k$, the corresponding spectral components are evanescent and decay away from the source plane $z=0$ into $z>0$.\n\nAssume the following scientifically realistic model:\n- The convention is $p(\\mathbf{r},t) = \\mathrm{Re}\\{p(\\mathbf{r}) \\exp(-\\mathrm{i} \\omega t)\\}$.\n- The forward-propagating field for each spatial Fourier component obeys the dispersion relation $k_{z}^{2} = k^{2} - k_{t}^{2}$, where $k_{z}$ is the axial wavenumber. For $k_{t} > k$, write $k_{z} = \\mathrm{i} \\gamma(k_{t})$ with $\\gamma(k_{t}) = \\sqrt{k_{t}^{2} - k^{2}}$, yielding an axial decay factor $\\exp(-\\gamma z)$.\n- The magnitude of the source-plane spectrum is bounded as $|P(k_{x},k_{y}; z=0)| \\leq P_{0}$ for all $(k_{x},k_{y})$, where $P_{0} > 0$ is a known bound on the pressure spectral amplitude at the source plane.\n- The measurement system has an additive pressure noise floor with root-mean-square amplitude $\\sigma_{p} > 0$, assumed spectrally white over $(k_{x},k_{y})$ and independent of the signal.\n\nDefine the maximum usable transverse wavenumber $k_{t,\\max}$ at the measurement plane $z=z_{0}$ as the largest $k_{t} > k$ for which the evanescent componentâ€™s magnitude at $z=z_{0}$ is not submerged by noise, i.e., its magnitude is at least equal to the noise floor $\\sigma_{p}$ when starting from the worst-case bound $P_{0}$ at $z=0$.\n\nStarting from the fundamental Helmholtz equation and the plane-wave spectral representation, derive a closed-form analytic expression for $k_{t,\\max}$ as a function of $k$, $z_{0}$, $P_{0}$, and $\\sigma_{p}$. Express your final answer in radians per meter. No numerical values are required; provide the symbolic expression only. If $P_{0} \\leq \\sigma_{p}$, you may assume $k_{t,\\max} = k$ by convention (no usable evanescent content), but your derived expression should reflect the general case $P_{0} > \\sigma_{p}$.",
            "solution": "The problem requires the derivation of an expression for the maximum usable transverse wavenumber, $k_{t,\\max}$, in the context of near-field acoustic holography (NAH). This derivation begins with the fundamental principles of wave propagation as described by the Helmholtz equation and the plane-wave spectral representation of the acoustic field.\n\nThe time-harmonic pressure field $p(x,y,z)$ is governed by the Helmholtz equation, $\\nabla^{2} p + k^{2} p = 0$, where $k = \\omega/c$ is the acoustic wavenumber. The field can be represented as a superposition of plane waves by means of a two-dimensional spatial Fourier transform with respect to the transverse coordinates $(x,y)$. Let $P(k_x, k_y; z)$ denote the spatial Fourier transform of the pressure field $p(x,y,z)$ at a given axial position $z$.\n\nThe solution to the Helmholtz equation for a single plane-wave component propagating in the positive $z$-direction is of the form $P(k_x, k_y; z) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z)$. The axial wavenumber, $k_z$, is determined by the dispersion relation, which arises from substituting the plane-wave form into the Helmholtz equation: $k_z^2 + k_x^2 + k_y^2 = k^2$. Defining the transverse wavenumber magnitude as $k_t = \\sqrt{k_x^2 + k_y^2}$, the dispersion relation becomes $k_z^2 = k^2 - k_t^2$.\n\nThe problem is concerned with evanescent waves, which correspond to the case where $k_t > k$. For these components, $k_z^2$ is negative. The problem specifies that for a forward-propagating field (decaying for $z>0$), we must choose the root for $k_z$ that has a positive imaginary part. We write $k_z = \\mathrm{i} \\sqrt{k_t^2 - k^2}$. This is expressed using the real-valued decay constant $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$, so that $k_z = \\mathrm{i} \\gamma(k_t)$.\n\nThe propagation of an evanescent spectral component from the source plane at $z=0$ to a measurement plane at $z=z_0 > 0$ is thus described by:\n$$P(k_x, k_y; z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} (\\mathrm{i} \\gamma(k_t)) z_0) = P(k_x, k_y; 0) \\exp(-\\gamma(k_t) z_0)$$\nTaking the magnitude of both sides yields:\n$$|P(k_x, k_y; z_0)| = |P(k_x, k_y; 0)| \\exp(-\\gamma(k_t) z_0)$$\nThis equation shows that the magnitude of an evanescent component decays exponentially with distance $z_0$ from the source. The rate of decay increases with $k_t$ since $\\gamma(k_t)$ is an increasing function of $k_t$.\n\nThe problem defines the maximum usable transverse wavenumber, $k_{t,\\max}$, as the largest $k_t > k$ where the signal is not submerged by noise. This is quantified by setting the signal magnitude at the measurement plane $z=z_0$ equal to the noise floor $\\sigma_p$. The signal magnitude is evaluated under the worst-case (largest) source condition, which is given by the bound $|P(k_x, k_y; z=0)| \\leq P_0$. Thus, we set $|P(k_x, k_y; z=0)| = P_0$.\n\nThe defining equation for $k_{t,\\max}$ is therefore:\n$$P_0 \\exp(-\\gamma(k_{t,\\max}) z_0) = \\sigma_p$$\nWe are asked to solve for the case where $P_0 > \\sigma_p$, which ensures that there is a non-trivial range of usable evanescent wavenumbers. We proceed to solve for $k_{t,\\max}$:\n$$\\exp(-\\gamma(k_{t,\\max}) z_0) = \\frac{\\sigma_p}{P_0}$$\nTaking the natural logarithm of both sides:\n$$-\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{\\sigma_p}{P_0}\\right)$$\nUsing the logarithmic identity $\\ln(a/b) = -\\ln(b/a)$, we get:\n$$\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\nIsolating $\\gamma(k_{t,\\max})$:\n$$\\gamma(k_{t,\\max}) = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\nNow, we substitute the definition of the decay constant, $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$:\n$$\\sqrt{k_{t,\\max}^2 - k^2} = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\nTo solve for $k_{t,\\max}$, we square both sides of the equation. Since $k_{t,\\max} > k$ and we consider $P_0 > \\sigma_p$, both sides are positive, so this operation is valid.\n$$k_{t,\\max}^2 - k^2 = \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\nFinally, we isolate $k_{t,\\max}^2$ and take the positive square root, as wavenumber magnitude must be non-negative:\n$$k_{t,\\max}^2 = k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\n$$k_{t,\\max} = \\sqrt{k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2}$$\nThis expression provides the maximum usable transverse wavenumber as a function of the given parameters $k$, $z_0$, $P_0$, and $\\sigma_p$. The units are consistent: $k$ is in rad/m, $z_0$ in m, and the ratio $P_0/\\sigma_p$ is dimensionless, making the entire expression have units of rad/m as required.",
            "answer": "$$ \\boxed{\\sqrt{k^{2} + \\left(\\frac{1}{z_{0}} \\ln\\left(\\frac{P_{0}}{\\sigma_{p}}\\right)\\right)^{2}}} $$"
        },
        {
            "introduction": "The ultimate goal of NAH is to create a clear image of a sound source, which depends on the system's spatial resolution. This final practice synthesizes the concepts of wavenumber bandwidth and noise limitations into a tangible performance metric. By deriving a Rayleigh-type resolution criterion, you will establish a direct mathematical link between the effective wavenumber passband of the reconstruction and the smallest physical feature size, $\\Delta x_{R}$, that the system can distinguish on the source plane .",
            "id": "4130738",
            "problem": "A planar microphone array at $z=0$ measures the complex acoustic pressure field $p(x,0)$ radiated by a distribution of sources located on the plane $z=-z_{0}$ in a homogeneous, lossless medium of sound speed $c$. The field satisfies the scalar Helmholtz equation $\\nabla^{2}p + k^{2}p = 0$, where $k = \\omega/c$ is the acoustic wavenumber. Near-field Acoustic Holography (NAH) reconstructs the source-plane field $p(x,-z_{0})$ by spatial Fourier transformation in the transverse coordinate $x$, and back-propagation by the plane-wave factor $\\exp(i k_{z} z)$ with $k_{z} = \\sqrt{k^{2} - k_{x}^{2}}$. For $|k_{x}| \\leq k$, $k_{z}$ is real (propagating components). For $|k_{x}| > k$, $k_{z} = i \\alpha$ with $\\alpha = \\sqrt{k_{x}^{2} - k^{2}}$ (evanescent components).\n\nAssume the reconstruction employs a rectangular low-pass in the transverse wavenumber domain, limited by a hardware/processing bandwidth $K_{B}$ (i.e., $|k_{x}| \\leq K_{B}$ are retained), and applies truncated inverse back-propagation that discards evanescent components whose inverse filter magnitude would exceed a dimensionless noise threshold specified by a global measurement signal-to-noise ratio $S_{0} > 1$. That is, evanescent components with inverse gain $\\exp(\\alpha z_{0}) > S_{0}$ are rejected. Consider two equal-strength, in-phase line sources separated by a distance $\\Delta x$ along $x$ on the source plane $z=-z_{0}$.\n\nStarting from the Helmholtz equation and the plane-wave representation, and treating the reconstruction as a band-limited, shift-invariant system along $x$ whose point-spread function is the inverse Fourier transform of the retained transverse spectrum, do the following:\n\n- Define a Rayleigh-type resolution criterion along $x$ for NAH at depth $z_{0}$ by requiring that the minimal resolvable separation $\\Delta x_{R}(z_{0})$ is the smallest $\\Delta x$ such that the central maximum of one reconstructed point-spread function coincides with the first zero of the other.\n- Derive how $\\Delta x_{R}(z_{0})$ depends jointly on the retained transverse wavenumber bandwidth and the noise-driven truncation described above.\n\nExpress your final resolution $\\Delta x_{R}(z_{0})$ as a closed-form analytic expression in meters, in terms of $k$, $z_{0}$, $K_{B}$, and $S_{0}$. No numerical values are to be substituted and no rounding is required. The final answer must be a single analytic expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Governing equation: Helmholtz equation, $\\nabla^{2}p + k^{2}p = 0$.\n- Acoustic wavenumber: $k = \\omega/c$.\n- Source-plane location: $z = -z_{0}$.\n- Measurement-plane location: $z = 0$.\n- Transverse coordinate: $x$.\n- Wavenumber-domain relationship for forward propagation: $P(k_x, z_2) = P(k_x, z_1) \\exp(ik_z(z_2-z_1))$.\n- Definition of transverse wavenumber $k_z$:\n  - For propagating waves ($|k_x| \\leq k$): $k_z = \\sqrt{k^2 - k_x^2}$.\n  - For evanescent waves ($|k_x| > k$): $k_z = i\\alpha$, with $\\alpha = \\sqrt{k_x^2 - k^2}$.\n- Reconstruction constraint 1 (Hardware Bandwidth): A rectangular low-pass filter in the $k_x$ domain retains only components where $|k_x| \\leq K_B$.\n- Reconstruction constraint 2 (Noise Truncation): Evanescent components are rejected if their inverse filter gain, $\\exp(\\alpha z_{0})$, exceeds a signal-to-noise ratio threshold, $S_{0} > 1$.\n- Resolution Criterion: The Rayleigh-type resolution $\\Delta x_{R}(z_{0})$ is the distance from the central maximum of a reconstructed point-spread function to its first zero.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of wave propagation, Fourier acoustics, and inverse problem theory, which are central to near-field acoustic holography (NAH). The Helmholtz equation and the plane-wave expansion are standard models. The specified constraints, a hardware bandwidth limit and a noise-based regularization for evanescent waves, represent a realistic, albeit simplified, model of a practical NAH system. The ill-posed nature of reconstructing evanescent waves (exponential amplification of noise) is correctly identified, and the truncation based on a signal-to-noise ratio $S_0$ is a standard form of regularization. The problem is objective, well-posed, and all terms are clearly defined, enabling a unique, analytical solution. No scientific flaws, contradictions, or ambiguities are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Resolution**\n\nThe reconstruction of the acoustic field at the source plane $z=-z_0$ from measurements at the plane $z=0$ is an inverse problem. Let $p(x,z)$ be the complex pressure field and $P(k_x,z)$ be its spatial Fourier transform with respect to the transverse coordinate $x$. The relationship between the fields at the source and measurement planes in the Fourier domain is given by the propagator:\n$$ P(k_x, 0) = P(k_x, -z_0) \\exp(ik_z z_0) $$\nThe reconstruction process seeks to compute an estimate of $P(k_x, -z_0)$ from the measured $P(k_x, 0)$. This involves applying an inverse filter, which ideally is $H_{ideal}(k_x) = \\exp(-ik_z z_0)$.\n\nThe problem states that the reconstruction is a linear, shift-invariant (LSI) system. The overall behavior of this system is described by its transfer function, $H(k_x)$, which dictates which spatial frequency components are retained. A component $k_x$ is retained if it satisfies all specified constraints. The transfer function $H(k_x)$ will be $1$ for retained components and $0$ for rejected components.\n\nLet us analyze the constraints on the retained wavenumbers $k_x$.\n1.  **Hardware Bandwidth Limit**: The reconstruction is band-limited by a maximum transverse wavenumber $K_B$, such that only components with $|k_x| \\leq K_B$ are processed.\n2.  **Noise-Driven Truncation**: This constraint applies to evanescent waves, for which $|k_x|>k$ and $k_z = i\\alpha = i\\sqrt{k_x^2-k^2}$. The inverse filter for these components has a gain (magnitude) of $|\\exp(-ik_z z_0)| = |\\exp(-i(i\\alpha)z_0)| = \\exp(\\alpha z_0)$. The problem states that components are rejected if this gain is greater than $S_0$. Therefore, evanescent components are retained only if:\n    $$ \\exp(\\alpha z_0) \\leq S_0 $$\n    Substituting $\\alpha = \\sqrt{k_x^2 - k^2}$, we get:\n    $$ \\exp\\left(z_0 \\sqrt{k_x^2 - k^2}\\right) \\leq S_0 $$\n    Taking the natural logarithm of both sides (since $S_0 > 1$, $\\ln(S_0) > 0$):\n    $$ z_0 \\sqrt{k_x^2 - k^2} \\leq \\ln(S_0) $$\n    $$ \\sqrt{k_x^2 - k^2} \\leq \\frac{\\ln(S_0)}{z_0} $$\n    Squaring both sides and rearranging gives the condition on $k_x^2$:\n    $$ k_x^2 - k^2 \\leq \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    $$ k_x^2 \\leq k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    This implies an upper limit on the magnitude of the transverse wavenumber due to noise:\n    $$ |k_x| \\leq \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2} $$\n    Let us define this noise-imposed cutoff wavenumber as $K_{noise} = \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}$.\n\nThe reconstruction system retains a spatial frequency component $k_x$ only if it satisfies *both* the hardware and noise constraints. This means the effective passband is the intersection of the two regions. The maximum retained transverse wavenumber, $K_{eff}$, is therefore the minimum of the two individual cutoff wavenumbers:\n$$ K_{eff} = \\min\\left(K_B, K_{noise}\\right) = \\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right) $$\nThe transfer function of the LSI reconstruction system is a rectangular window in the wavenumber domain:\n$$ H(k_x) = \\begin{cases} 1 & \\text{if } |k_x| \\leq K_{eff} \\\\ 0 & \\text{if } |k_x| > K_{eff} \\end{cases} $$\nThe point-spread function (PSF) of the system, $h(x)$, is the inverse Fourier transform of its transfer function $H(k_x)$. For a one-dimensional system, the inverse Fourier transform is defined as:\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(k_x) e^{ik_x x} dk_x $$\nSubstituting the expression for $H(k_x)$:\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-K_{eff}}^{K_{eff}} (1) \\cdot e^{ik_x x} dk_x $$\nEvaluating the integral:\n$$ h(x) = \\frac{1}{2\\pi} \\left[ \\frac{e^{ik_x x}}{ix} \\right]_{-K_{eff}}^{K_{eff}} = \\frac{1}{2\\pi ix} \\left( e^{iK_{eff}x} - e^{-iK_{eff}x} \\right) $$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i}$, we can simplify this to:\n$$ h(x) = \\frac{\\sin(K_{eff}x)}{\\pi x} $$\nThis expression is a scaled sinc function. Its central maximum is at $x=0$.\n\nAccording to the Rayleigh-type resolution criterion defined in the problem, the minimal resolvable separation $\\Delta x_R(z_0)$ is the distance from the central maximum of the PSF to its first zero. The zeros of $h(x)$ occur when the numerator is zero, provided the denominator is non-zero (i.e., $x \\neq 0$).\n$$ \\sin(K_{eff}x) = 0 $$\nThis condition is met when $K_{eff}x = n\\pi$ for any non-zero integer $n$. The first zero corresponds to $n=1$ (or $n=-1$), which gives:\n$$ K_{eff}|x| = \\pi $$\nThe distance to this first zero is $|x| = \\frac{\\pi}{K_{eff}}$. By definition, this is the resolution limit.\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{K_{eff}} $$\nSubstituting the expression for $K_{eff}$:\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)} $$\nThis is the final analytical expression for the resolution, showing its joint dependence on the hardware bandwidth $K_B$ and the noise-driven truncation, which itself depends on $k$, $z_0$, and $S_0$. The resolution is limited by whichever constraint is more restrictive (i.e., whichever gives a smaller cutoff wavenumber).",
            "answer": "$$ \\boxed{\\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)}} $$"
        }
    ]
}