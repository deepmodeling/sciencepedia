{
    "hands_on_practices": [
        {
            "introduction": "这项首个实践旨在奠定航空声学的物理基础。我们将从控制流体运动的基本欧拉方程出发，通过线性化推导出经典的波动方程。这项练习至关重要，因为它揭示了声波传播是如何作为流体动力学更广泛框架内的一种特定现象出现的，并明确地用热力学性质定义了声速 $c_0$，这是所有声学分析的基石 。",
            "id": "4118565",
            "problem": "考虑在计算气动声学 (CAA) 框架下，无粘可压缩理想气体中的一维小振幅声扰动。基态是均匀且静止的，其压力为 $p_0$，密度为 $\\rho_0$，速度为 $u_0=0$。流体为理想气体，其比热比 $\\gamma$ 为常数。假设扰动是等熵的。从无粘可压缩流的质量和动量守恒方程出发，结合等熵热力学封闭关系，推导声场的线性波动方程，并用在基态下求值的等熵热力学导数 $\\left(\\partial p / \\partial \\rho\\right)_s$ 来表示传播速度 $c_0$。然后，仅使用理想气体定律和等熵条件，用 $\\gamma$、$p$ 和 $\\rho$ 表示理想气体的 $\\left(\\partial p / \\partial \\rho\\right)_s$，并将其具体化到基态。最后，根据给定的基态数据 $p_0=101325$ Pa、$\\rho_0=1.225$ kg/m$^3$ 和 $\\gamma=1.4$，计算等熵声速 $c_0$ 的数值。将 $c_0$ 的最终数值答案以 m/s 为单位表示，并将结果四舍五入到四位有效数字。除计算外，推导过程必须明确证明为何等熵声速等于在基态下求值的等熵热力学导数的平方根，从而验证对于此理想气体情况，$c_0^2=\\left(\\partial p / \\partial \\rho\\right)_s$ 成立。",
            "solution": "本问题要求推导静止理想气体中一维等熵扰动的线性声波方程，确定声速，对理想气体的该速度进行热力学评估，最后进行数值计算。该问题具有科学依据，提法恰当且完整。\n\n分析始于无粘可压缩流体的一维 Euler 方程，这些方程代表质量和动量守恒。\n\n质量守恒（连续性方程）：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0\n$$\n\n动量守恒：\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0\n$$\n\n此处，$\\rho$ 是流体密度，$u$ 是流体速度，$p$ 是压力，$t$ 是时间，$x$ 是空间坐标。\n\n我们考虑在均匀、静止的介质中传播的小振幅声扰动。流动变量被分解为一个恒定的基态（下标为 $0$）和一个小的、波动的声学扰动量（带撇号的量）：\n$$\n\\rho(x,t) = \\rho_0 + \\rho'(x,t)\n$$\n$$\np(x,t) = p_0 + p'(x,t)\n$$\n$$\nu(x,t) = u_0 + u'(x,t) = u'(x,t) \\quad (\\text{因为基流是静止的，} u_0 = 0)\n$$\n假设扰动量很小，即 $|\\rho'| \\ll \\rho_0$，$|p'| \\ll p_0$，且 $|u'|$ 很小。我们将这些表达式代入 Euler 方程，并忽略所有二阶及以上的扰动量项（例如 $\\rho'u'$，$u'^2$）。\n\n连续性方程的线性化：\n$$\n\\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0\n$$\n去掉二阶项 $\\rho' u'$，我们得到线性化的连续性方程：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n\\quad (1)\n$$\n\n动量方程的线性化：\n$$\n\\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u'^2 + p_0 + p')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 u'^2 + \\rho' u'^2 + p')}{\\partial x} = 0\n$$\n去掉二阶项 $\\rho'u'$ 和 $(\\rho_0+\\rho')u'^2$，我们得到线性化的动量方程：\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0\n\\quad (2)\n$$\n\n该系统需要一个连接热力学变量的封闭关系。问题说明扰动是等熵的。这意味着在恒定熵 $s$ 下，存在一个函数关系 $p = p(\\rho)$。对于围绕基态 $(\\rho_0, p_0)$ 的小扰动，我们可以使用一阶泰勒级数展开：\n$$\np' = p - p_0 \\approx \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} (\\rho - \\rho_0) = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} \\rho'\n$$\n下标 $s$ 表示导数是在恒定熵的条件下求得的。我们将这个具有速度平方单位的常数系数定义为 $c_0^2$：\n$$\nc_0^2 \\equiv \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0}\n$$\n因此，线性声学的等熵封闭关系为：\n$$\np' = c_0^2 \\rho'\n\\quad (3)\n$$\n\n现在，我们推导波动方程。我们力图将方程 $(1)$、$(2)$ 和 $(3)$ 结合起来，以得到关于某个扰动变量的单一方程。让我们推导压力扰动 $p'$ 的方程。\n\n首先，将方程 $(2)$ 对 $x$ 求导：\n$$\n\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + \\frac{\\partial^2 p'}{\\partial x^2} = 0\n\\quad (4)\n$$\n接下来，使用方程 $(3)$ 将 $\\rho'$ 用 $p'$ 表示为 $\\rho' = p'/c_0^2$。将此式代入方程 $(1)$：\n$$\n\\frac{\\partial}{\\partial t} \\left(\\frac{p'}{c_0^2}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n由于 $c_0^2$ 和 $\\rho_0$ 是常数：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial p'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n现在，将此方程对 $t$ 求导：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0\n\\quad (5)\n$$\n从方程 $(4)$，我们可以将混合导数项表示为 $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -\\frac{\\partial^2 p'}{\\partial x^2}$。将其代入方程 $(5)$ 中可得：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\frac{\\partial^2 p'}{\\partial x^2} = 0\n$$\n整理后可得一维线性波动方程：\n$$\n\\frac{\\partial^2 p'}{\\partial t^2} = c_0^2 \\frac{\\partial^2 p'}{\\partial x^2}\n$$\n此推导明确表明，代表扰动传播速度的参数 $c_0$ 是由我们定义为 $c_0^2$ 的量的平方根给出。因此，声速等于在基态下求值的等熵热力学导数的平方根这一论断得到证实：$c_0^2 = (\\partial p / \\partial \\rho)_s$。\n\n接下来，我们为理想气体计算这个导数。对于理想气体中的等熵过程，压力和密度通过 $p_0/\\rho_0^\\gamma = p/\\rho^\\gamma = K$ 相关联，其中对于给定的熵态，$K$ 是一个常数，而 $\\gamma$ 是比热比。这给出了关系式 $p = K\\rho^\\gamma$。我们现在计算所需的偏导数：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho} (K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1}\n$$\n将常数 $K = p/\\rho^\\gamma$ 的表达式代回：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\left( \\frac{p}{\\rho^\\gamma} \\right) \\gamma \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\n这是理想气体的一般表达式。为了求出静止基态下的声速 $c_0$，我们在 $p=p_0$ 和 $\\rho=\\rho_0$ 处计算该导数：\n$$\nc_0^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} = \\frac{\\gamma p_0}{\\rho_0}\n$$\n因此，理想气体的等熵声速为：\n$$\nc_0 = \\sqrt{\\frac{\\gamma p_0}{\\rho_0}}\n$$\n\n最后，我们使用给定的基态数据计算 $c_0$ 的数值：$p_0 = 101325$ Pa，$\\rho_0 = 1.225$ kg/m$^3$ 和 $\\gamma = 1.4$。\n$$\nc_0 = \\sqrt{\\frac{1.4 \\times 101325}{1.225}}\n$$\n$$\nc_0 = \\sqrt{\\frac{141855}{1.225}} = \\sqrt{115800} \\approx 340.29399 \\text{ m/s}\n$$\n按要求将结果四舍五入到四位有效数字，得到：\n$$\nc_0 \\approx 340.3 \\text{ m/s}\n$$",
            "answer": "$$\\boxed{340.3}$$"
        },
        {
            "introduction": "在理解了声波的传播方式后，下一个合乎逻辑的步骤是为其声源建模。这项实践将探讨多极子展开，这是一种表征紧凑气动声源的强大工具。通过推导简单偶极子和四极子声源的远场指向性图样 ，您将深入了解声源的物理性质如何决定其辐射声音的空间分布，这是噪声预测和控制中的一个关键概念。",
            "id": "4118586",
            "problem": "考虑一密度为常数 $\\rho_0$、声速为 $c_0$ 的均匀、静止流体。令 $(r,\\theta,\\phi)$ 表示球坐标，单位观测矢量为 $\\mathbf{n} = (\\sin\\theta\\cos\\phi,\\sin\\theta\\sin\\phi,\\cos\\theta)$，其中 $\\theta$ 是与 $+z$ 轴的夹角。在角频率为 $\\omega$ 的频域中，由一个空间支集限于以原点为中心、半径为 $a$ 的球内的紧凑时谐源产生的声压幅值 $p(\\mathbf{x})$ 满足非齐次亥姆霍兹方程和自由空间辐射条件，其中 $k a \\ll 1$ 且 $k = \\omega/c_0$。以线性波动方程和自由空间格林函数为出发点，并仅依赖格林表示积分的远场 ($r \\to \\infty$) 紧凑源 ($k a \\ll 1$) 多极展开，推导下列两种源的归一化远场方向性函数，两种源均与 $z$ 轴对齐且位于原点：\n\n- 单极矩为零、非零一阶空间矩矢量与 $+z$ 轴对齐的纯紧凑偶极子。\n\n- 主轴沿 $z$ 轴、其二阶空间矩张量与 $\\mathrm{diag}(-\\tfrac{1}{2},-\\tfrac{1}{2},1)$ 成正比的纯紧凑轴对称、无迹四极子。\n\n将归一化远场方向性 $D(\\theta,\\phi)$ 定义为，在移除所有源强度、频率和量纲前置因子后，乘以领阶渐近幅值 $r^{-1}\\exp(i k r)$ 的实数角度因子，并进行归一化，使其在所有角度上的最大模为 $1$。用 $\\theta$ 和 $\\phi$ 明确表示您的结果。\n\n您的最终答案必须是一个单行矩阵，按顺序包含偶极子和四极子的归一化方向性的两个解析表达式。不包括单位。不要对任何量进行近似或取整。精确保留角度依赖关系。",
            "solution": "首先验证问题。已知条件是：密度为常数 $\\rho_0$、声速为 $c_0$ 的均匀、静止流体；球坐标 $(r,\\theta,\\phi)$；单位观测矢量 $\\mathbf{n}$；角频率 $\\omega$；波数 $k = \\omega/c_0$；一个以原点为中心、半径为 $a$ 的紧凑源，满足 $ka \\ll 1$；控制方程为非齐次亥姆霍兹方程；方法是远场 ($r \\to \\infty$) 紧凑源多极展开。目标是求出与 $z$ 轴对齐的纯偶极子和与 $z$ 轴对齐的纯轴对称、无迹四极子的归一化远场方向性函数 $D(\\theta,\\phi)$。方向性定义为领阶远场声压的实数角度因子，并归一化为最大模为 $1$。\n\n该问题具有科学依据，提法恰当，客观且内部一致。它代表了经典声学理论的一个标准应用。因此，该问题是有效的，我们继续进行求解。\n\n对于源分布 $S(\\mathbf{y})$，频域中的声压 $p(\\mathbf{x})$ 由非齐次亥姆霍兹方程的解给出，该解可使用自由空间格林函数 $G(\\mathbf{x}|\\mathbf{y})$ 写为：\n$$p(\\mathbf{x}) = \\int_{\\mathcal{V}} S(\\mathbf{y}) G(\\mathbf{x}|\\mathbf{y}) d^3\\mathbf{y}$$\n其中源 $S(\\mathbf{y})$ 仅在以原点为中心、半径为 $a$ 的球内非零。三维空间中亥姆霍兹方程 $(\\nabla^2 + k^2)p = -S$ 的自由空间格林函数为：\n$$G(\\mathbf{x}|\\mathbf{y}) = \\frac{\\exp(i k |\\mathbf{x} - \\mathbf{y}|)}{4 \\pi |\\mathbf{x} - \\mathbf{y}|}$$\n这里，$\\mathbf{x}$ 是观测点，$\\mathbf{y}$ 是源点。\n\n我们应用远场近似，即观测者远离声源，即 $r = |\\mathbf{x}| \\to \\infty$。在此极限下，对于限制在 $|\\mathbf{y}| \\le a$ 内的源，距离 $|\\mathbf{x} - \\mathbf{y}|$ 可以进行近似。对于分母中的模，有 $|\\mathbf{x} - \\mathbf{y}| \\approx r$。对于指数中的相位，需要更精确的近似：\n$$|\\mathbf{x} - \\mathbf{y}| = \\sqrt{r^2 - 2\\mathbf{x} \\cdot \\mathbf{y} + |\\mathbf{y}|^2} = r\\sqrt{1 - \\frac{2\\mathbf{n} \\cdot \\mathbf{y}}{r} + \\frac{|\\mathbf{y}|^2}{r^2}} \\approx r \\left(1 - \\frac{\\mathbf{n} \\cdot \\mathbf{y}}{r}\\right) = r - \\mathbf{n} \\cdot \\mathbf{y}$$\n其中 $\\mathbf{n} = \\mathbf{x}/r$ 是指向观测者的单位矢量。将这些代入格林函数，得到远场近似：\n$$G(\\mathbf{x}|\\mathbf{y}) \\approx \\frac{\\exp(i k (r - \\mathbf{n} \\cdot \\mathbf{y}))}{4 \\pi r} = \\frac{\\exp(i k r)}{4 \\pi r} \\exp(-i k \\mathbf{n} \\cdot \\mathbf{y})$$\n对于紧凑源，我们有 $k|\\mathbf{y}| \\le ka \\ll 1$。这允许对指数项 $\\exp(-i k \\mathbf{n} \\cdot \\mathbf{y})$ 进行泰勒级数展开：\n$$\\exp(-i k \\mathbf{n} \\cdot \\mathbf{y}) = \\sum_{m=0}^{\\infty} \\frac{(-i k \\mathbf{n} \\cdot \\mathbf{y})^m}{m!} = 1 - i k (\\mathbf{n} \\cdot \\mathbf{y}) + \\frac{1}{2}(-i k)^2 (\\mathbf{n} \\cdot \\mathbf{y})^2 + \\mathcal{O}((ka)^3)$$\n使用爱因斯坦求和约定的指标记法，其中 $\\mathbf{n} = (n_1, n_2, n_3)$ 和 $\\mathbf{y} = (y_1, y_2, y_3)$，这可以写成：\n$$\\exp(-i k n_j y_j) \\approx 1 - i k n_j y_j - \\frac{k^2}{2} n_j n_l y_j y_l$$\n将这个展开的格林函数代入压力积分，得到声场的多极展开：\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\int_{\\mathcal{V}} S(\\mathbf{y}) \\left( 1 - i k n_j y_j - \\frac{k^2}{2} n_j n_l y_j y_l + \\dots \\right) d^3\\mathbf{y}$$\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left( Q_0 - i k n_j F_j - \\frac{k^2}{2} n_j n_l T_{jl} \\right)$$\n其中我们定义了源分布的多极矩：\n- 单极矩：$Q_0 = \\int S(\\mathbf{y}) d^3\\mathbf{y}$\n- 偶极矩矢量：$F_j = \\int y_j S(\\mathbf{y}) d^3\\mathbf{y}$\n- 四极矩张量：$T_{jl} = \\int y_j y_l S(\\mathbf{y}) d^3\\mathbf{y}$\n\n我们现在分析问题中描述的两种具体情况。\n\n**情况 1：纯紧凑偶极子**\n对于纯偶极子源，单极矩为零，即 $Q_0=0$。展开式中的领阶项是偶极子项。声压为：\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} (-i k n_j F_j) = \\frac{-i k \\exp(i k r)}{4 \\pi r} (\\mathbf{n} \\cdot \\mathbf{F})$$\n问题指出偶极矩矢量 $\\mathbf{F}$ 与 $+z$ 轴对齐。因此，对于某个源强度 $F_z$，有 $\\mathbf{F} = (0, 0, F_z)$。点积变为：\n$$\\mathbf{n} \\cdot \\mathbf{F} = n_z F_z = (\\cos\\theta) F_z$$\n声压场为：\n$$p(\\mathbf{x}) \\approx \\left(\\frac{-i k F_z}{4 \\pi}\\right) \\cos\\theta \\frac{\\exp(i k r)}{r}$$\n方向性函数 $D(\\theta,\\phi)$ 是在移除所有与源强度 ($F_z$)、频率 ($k$) 和量纲 ($4\\pi$) 相关的前置因子后，乘以 $\\exp(ikr)/r$ 项的实数角度因子。该因子是 $\\cos\\theta$。然后我们必须对其进行归一化，使其最大模为 $1$。函数 $f(\\theta) = \\cos\\theta$ 的值域为 $[-1, 1]$，因此其最大模为 $\\max|\\cos\\theta| = 1$。该函数已经归一化。\n因此，与z轴对齐的偶极子的归一化方向性为：\n$$D_{\\text{dipole}}(\\theta, \\phi) = \\cos\\theta$$\n\n**情况 2：纯紧凑轴对称四极子**\n对于纯四极子源，单极矩 $Q_0$ 和偶极矩矢量 $\\mathbf{F}$ 均为零。领阶项是四极子项：\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left( -\\frac{k^2}{2} n_j n_l T_{jl} \\right)$$\n问题指明该源是一个主轴沿 $z$ 轴的轴对称、无迹四极子。其二阶矩张量 $T_{jl}$ 与 $\\mathrm{diag}(-\\frac{1}{2},-\\frac{1}{2},1)$ 成正比。设比例常数为 $C_T$，它包含了源的强度。则：\n$$T_{jl} = C_T \\begin{pmatrix} -1/2  0  0 \\\\ 0  -1/2  0 \\\\ 0  0  1 \\end{pmatrix}$$\n我们计算二次型 $n_j n_l T_{jl}$。在笛卡尔坐标分量下，其中 $\\mathbf{n} = (n_x, n_y, n_z)$：\n$$n_j n_l T_{jl} = n_x^2 T_{xx} + n_y^2 T_{yy} + n_z^2 T_{zz} = C_T \\left(-\\frac{1}{2} n_x^2 - \\frac{1}{2} n_y^2 + n_z^2 \\right)$$\n对于单位矢量 $\\mathbf{n}$，使用恒等式 $n_x^2 + n_y^2 + n_z^2 = 1$，我们有 $n_x^2 + n_y^2 = 1-n_z^2$。代入此式可得：\n$$n_j n_l T_{jl} = C_T \\left(-\\frac{1}{2}(1 - n_z^2) + n_z^2 \\right) = C_T \\left(-\\frac{1}{2} + \\frac{1}{2}n_z^2 + n_z^2 \\right) = C_T \\left(\\frac{3}{2}n_z^2 - \\frac{1}{2}\\right)$$\n在球坐标中，$n_z = \\cos\\theta$。二次型变为：\n$$n_j n_l T_{jl} = C_T \\left(\\frac{3}{2}\\cos^2\\theta - \\frac{1}{2}\\right) = \\frac{C_T}{2}(3\\cos^2\\theta - 1)$$\n声压场为：\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left(-\\frac{k^2}{2}\\right) \\frac{C_T}{2}(3\\cos^2\\theta - 1) = \\left(\\frac{-k^2 C_T}{16\\pi}\\right) (3\\cos^2\\theta - 1) \\frac{\\exp(i k r)}{r}$$\n实数角度因子是 $f(\\theta) = 3\\cos^2\\theta - 1$。为了找到归一化方向性，我们必须将其除以其最大绝对值。我们来求 $f(\\theta)$ 的极值。由于 $\\cos^2\\theta$ 的范围是 $0$ 到 $1$，所以 $f(\\theta)$ 的最大值出现在 $\\cos^2\\theta=1$ 时（即 $\\theta=0, \\pi$），得到 $f_{max} = 3(1) - 1 = 2$。最小值出现在 $\\cos^2\\theta=0$ 时（即 $\\theta=\\pi/2$），得到 $f_{min}=3(0)-1=-1$。$f(\\theta)$ 的最大模为 $\\max(|2|,|-1|) = 2$。\n因此，归一化方向性为：\n$$D_{\\text{quad}}(\\theta, \\phi) = \\frac{3\\cos^2\\theta - 1}{2}$$\n该表达式是二阶勒让德多项式 $P_2(\\cos\\theta)$。\n\n这两个归一化方向性函数是 $D_{\\text{dipole}} = \\cos\\theta$ 和 $D_{\\text{quad}} = \\frac{3\\cos^2\\theta - 1}{2}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\cos\\theta & \\frac{3\\cos^{2}\\theta - 1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的实践练习将弥合连续物理理论与离散数值模拟之间的鸿沟，直面计算航空声学（CAA）的核心挑战之一。这项动手编程练习涉及分析数值色散误差 ，即不同频率的波在计算网格上以不正确的速度传播的现象。通过实现和测试各种数值格式，您将直接观察到为何高保真格式对于准确模拟长距离波传播至关重要，而这正是航空声学问题的一个决定性特征。",
            "id": "4118552",
            "problem": "考虑一个一维线性声学传播模型，由线性平流方程 $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$ 表示，其中 $u(x,t)$ 是一个标量扰动，$c_0$ 是一个恒定的声速。计算航空声学 (CAA, Computational Aeroacoustics) 的基本原理通常通过平面波分析来评估数值格式的色散。令无量纲波数为 $\\theta = k\\,\\Delta x$，其中 $k$ 是物理波数，$\\Delta x$ 是网格间距。对于离散的有限差分空间导数和时间积分器，离散傅里叶分析得出一个由空间差分格式决定的修正波数 $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$，以及一个由时间积分器决定的每个时间步的放大因子 $G(\\theta)$。数值角频率 $\\omega(\\theta)$ 由 $G(\\theta) = \\exp(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t)$ 定义，使用复数辐角的主值；数值相速度为 $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$。我们关心的量是相对相速度误差 $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$，表示为一个无量纲小数。\n\n从线性平流方程出发，在均匀网格 $x_j = j\\,\\Delta x$ 上使用平面波拟设 $u_j^n = \\exp(\\mathrm{i}\\,(j\\,\\theta - n\\,\\omega\\,\\Delta t))$，推导组合的中心有限差分空间格式和显式 Runge–Kutta 时间积分器的半离散和全离散色散关系。使用以下中心有限差分一阶导数格式及其对应的无量纲修正波数函数 $\\alpha(\\theta)$：\n\n- 二阶中心差分 ($p=2$)：$\\alpha_{2}(\\theta) = \\sin(\\theta)$。\n- 四阶中心差分 ($p=4$)：$\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$。\n- 六阶中心差分 ($p=6$)：$\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$。\n\n令 Courant–Friedrichs–Lewy 数为 $\\lambda = c_0\\,\\Delta t/\\Delta x$，并令 $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$。对于显式 Runge–Kutta 时间积分器，使用它们在 $z(\\theta)$ 处求值的稳定性多项式 $R(z)$：\n- 二阶 Runge–Kutta (Heun 方法, $s=2$)：$R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$。\n- 经典四阶 Runge–Kutta ($s=4$)：$R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$。\n\n定义 $G(\\theta) = R_{s}(z(\\theta))$，使用在 $(-\\pi,\\pi]$ 内的辐角主值取 $\\omega(\\theta) = -\\mathrm{arg}(G(\\theta))/\\Delta t$，并用 $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$ 计算 $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$。相对相速度误差为 $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$。仅在 $\\alpha(\\theta) \\neq 0$ 的地方计算 $\\theta$，以避免除以零（不包括 $\\theta=0$ 和 $\\theta=\\pi$）。\n\n您的任务是编写一个完整的、可运行的程序，该程序：\n1. 实现上述分析，使用 $N=4096$ 个均匀间隔的样本，对 $\\theta \\in (\\varepsilon,\\pi-\\varepsilon)$ (其中 $\\varepsilon = 10^{-6}$) 进行密集采样，以计算 $e(\\theta)$。\n2. 对于下面的每个测试用例，从 $e(\\theta)$ 计算三个标量指标：\n   - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$,\n   - $E_{\\text{mid}} = e(\\pi/3)$,\n   - $E_{\\mathrm{rms}} = \\sqrt{\\dfrac{1}{M}\\sum_{m=1}^{M} e(\\theta_m)^2}$，其中 $\\{\\theta_m\\}$ 是采样集合且 $M=N$。\n3. 生成单行输出，其中包含所有测试用例的所有结果，格式为方括号内以逗号分隔的列表，并按下述顺序排列。所有输出均为无量纲小数。\n\n除非另有说明，否则所有用例均使用以下物理和数值参数：\n- 声速 $c_0 = 340$ $\\mathrm{m/s}$。\n- 网格间距 $\\Delta x = 10^{-3}$ $\\mathrm{m}$。\n- 时间步长 $\\Delta t$ 通过 $\\Delta t = \\lambda\\,\\Delta x/c_0$ 由指定的 $\\lambda$ 设定。\n\n测试套件（每个用例指定为 $(p,s,\\lambda)$）：\n- 用例 1: $(2,2,0.3)$。\n- 用例 2: $(4,4,0.5)$。\n- 用例 3: $(6,4,0.9)$。\n- 用例 4: $(4,2,0.9)$。\n- 用例 5: $(6,4,0.05)$。\n\n您的程序应生成单行输出，其中按以下顺序包含结果：\n$[E_{\\max}^{(1)},E_{\\text{mid}}^{(1)},E_{\\mathrm{rms}}^{(1)},E_{\\max}^{(2)},E_{\\text{mid}}^{(2)},E_{\\mathrm{rms}}^{(2)},E_{\\max}^{(3)},E_{\\text{mid}}^{(3)},E_{\\mathrm{rms}}^{(3)},E_{\\max}^{(4)},E_{\\text{mid}}^{(4)},E_{\\mathrm{rms}}^{(4)},E_{\\max}^{(5)},E_{\\text{mid}}^{(5)},E_{\\mathrm{rms}}^{(5)}]$，其中上标表示用例索引。每个条目必须是使用 Python 默认格式打印的浮点数，且所有值都是无量纲小数。",
            "solution": "该问题要求对一维线性平流方程 $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$ 的几种有限差分和时间积分格式进行数值色散分析。目标是计算相对相速度误差 $e(\\theta)$，并为空间和时间格式的几种组合推导出特定的指标。该分析基于离散网格上平面波解的行为。\n\n首先，我们建立理论框架。控制方程模拟了以恒定相速度 $c_0$ 传播的波。我们用均匀网格 $x_j = j\\,\\Delta x$ 对空间域进行离散化，用时间步长 $t_n = n\\,\\Delta t$ 对时间域进行离散化。网格点上的解表示为 $u_j^n = u(x_j, t_n)$。我们采用平面波拟设，即傅里叶模式的离散形式，来分析单个波数分量的行为：\n$$\nu_j^n = \\hat{u}(k) \\exp(\\mathrm{i}(k x_j - \\omega t_n)) = \\hat{u}(k) \\exp(\\mathrm{i}(k j \\Delta x - \\omega n \\Delta t))\n$$\n在此表达式中，$k$ 是物理波数，$\\omega = k c_0$ 是精确角频率。我们引入无量纲波数 $\\theta = k\\,\\Delta x$。\n\n第一步是半离散化，即将空间导数 $\\partial u/\\partial x$ 替换为有限差分近似，我们将其表示为 $\\delta_x u_j$。这将偏微分方程 (PDE) 转化为一个常微分方程组 (ODEs)：\n$$\n\\frac{d u_j}{d t} + c_0 (\\delta_x u_j) = 0\n$$\n对于一个 $p$ 阶中心有限差分格式，其对平面波 $e^{\\mathrm{i} j \\theta}$ 的作用等效于乘以一个因子 $\\mathrm{i} k^*(\\theta) = \\mathrm{i}\\alpha_p(\\theta)/\\Delta x$。函数 $\\alpha_p(\\theta)$ 是由差分算子的泰勒级数展开推导出来的。问题提供了以下关于无量纲修正波数 $\\alpha(\\theta)$ 的函数：\n- 对于 $p=2$：$\\alpha_{2}(\\theta) = \\sin(\\theta)$\n- 对于 $p=4$：$\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$\n- 对于 $p=6$：$\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$\n\n将平面波和差分算子代入半离散方程，得到给定波数下随时间变化的振幅 $\\hat{u}(t)$ 的一个常微分方程：\n$$\n\\frac{d \\hat{u}}{dt} + c_0 \\left( \\frac{\\mathrm{i}\\alpha(\\theta)}{\\Delta x} \\right) \\hat{u} = 0\n$$\n下一步是全离散化，即使用数值时间积分格式求解此常微分方程。对于一个应用于形如 $\\frac{dy}{dt} = \\Lambda y$ 方程的显式 $s$ 级 Runge–Kutta 方法，一个时间步长 $\\Delta t$ 后的解由 $y^{n+1} = R_s(\\Lambda \\Delta t) y^n$ 给出，其中 $R_s(z)$ 是该方法的稳定性多项式。在我们的问题中，特征值为 $\\Lambda = -c_0 \\mathrm{i}\\alpha(\\theta)/\\Delta x$。因此，稳定性多项式的自变量为：\n$$\nz(\\theta) = \\Lambda \\Delta t = - \\frac{\\mathrm{i} c_0 \\alpha(\\theta)}{\\Delta x} \\Delta t = -\\mathrm{i} \\alpha(\\theta) \\frac{c_0 \\Delta t}{\\Delta x}\n$$\n将 Courant–Friedrichs–Lewy (CFL) 数定义为 $\\lambda = c_0\\,\\Delta t/\\Delta x$，我们得到 $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$。数值解随时间推进的关系为 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$，其中放大因子 $G(\\theta)$ 由稳定性多项式在 $z(\\theta)$ 处的值给出：\n$$\nG(\\theta) = R_s(z(\\theta))\n$$\n问题提供了二阶 ($s=2$) 和四阶 ($s=4$) Runge–Kutta 方法的稳定性多项式：\n- $R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$\n- $R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$\n\n经过 $n$ 步后的数值解为 $u_j^n \\propto \\exp(\\mathrm{i} j\\theta) (G(\\theta))^n$。为了分析其相位行为，我们定义一个数值角频率 $\\omega_{\\text{num}}(\\theta)$，使得解的传播部分可以写为 $\\exp(-\\mathrm{i} \\omega_{\\text{num}} n \\Delta t)$。这需要设置 $G(\\theta) = \\exp(-\\mathrm{i} \\omega_{\\text{num}} \\Delta t)$，并假设 $\\omega_{\\text{num}}$ 可能为复数。问题陈述指定仅使用相位分量，通过将数值频率（在此如问题中所述，记为 $\\omega(\\theta)$）定义为一个实数量：\n$$\n\\omega(\\theta) = -\\frac{\\mathrm{arg}(G(\\theta))}{\\Delta t}\n$$\n其中 $\\mathrm{arg}(G(\\theta))$ 是复数 $G(\\theta)$ 的辐角主值，通常在 $(-\\pi, \\pi]$ 范围内。数值相速度则是数值频率与修正波数的比值：\n$$\nc_{\\text{num}}(\\theta) = \\frac{\\omega(\\theta)}{k^*(\\theta)} = \\frac{-\\mathrm{arg}(G(\\theta))/\\Delta t}{\\alpha(\\theta)/\\Delta x} = \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t}\n$$\n我们关心的量是相对相速度误差 $e(\\theta)$，定义为：\n$$\ne(\\theta) = \\frac{c_{\\text{num}}(\\theta)}{c_0} - 1 = \\left( \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t} \\right) \\frac{1}{c_0} - 1\n$$\n通过代入 $\\lambda = c_0 \\Delta t / \\Delta x$（这意味着 $\\frac{\\Delta x}{c_0 \\Delta t} = \\frac{1}{\\lambda}$），我们得到一个简化的误差表达式：\n$$\ne(\\theta) = \\frac{-\\mathrm{arg}(G(\\theta))}{\\lambda\\,\\alpha(\\theta)} - 1 = \\frac{-\\mathrm{arg}(R_s(-\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)))}{\\lambda\\,\\alpha(\\theta)} - 1\n$$\n这个最终表达式巧妙地表明，相对相速度误差仅仅是无量纲波数 $\\theta$、CFL 数 $\\lambda$ 以及所选空间 ($p$) 和时间 ($s$) 格式的函数。它与具体的物理参数 $c_0$、$\\Delta x$ 和 $\\Delta t$ 无关。\n\n计算步骤如下：\n1.  对于由 $(p, s, \\lambda)$ 给出的每个测试用例：\n2.  在区间 $(\\varepsilon, \\pi-\\varepsilon)$ 内生成一个包含 $N=4096$ 个均匀间隔样本的 $\\theta$ 数组，其中 $\\varepsilon=10^{-6}$。\n3.  选择相应的函数 $\\alpha_p(\\theta)$ 和稳定性多项式 $R_s(z)$。\n4.  计算 $\\alpha(\\theta)$ 的值数组。\n5.  计算复数值数组 $z(\\theta) = -\\mathrm{i}\\lambda\\alpha(\\theta)$。\n6.  计算稳定性多项式以获得放大因子数组 $G(\\theta) = R_s(z(\\theta))$。\n7.  计算 $G(\\theta)$ 数组中每个元素的辐角主值（相位）。\n8.  使用简化公式计算相对相位误差数组 $e(\\theta)$。\n9.  从 $e(\\theta)$ 数组中，计算三个所需指标：\n    - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$。\n    - $E_{\\text{mid}} = e(\\pi/3)$，在最接近 $\\theta=\\pi/3$ 的样本点上计算。\n    - $E_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{m=1}^{N} e(\\theta_m)^2}$。\n10. 收集所有测试用例的所有指标，并将其格式化为指定的输出字符串。\n\n该过程在以下 Python 程序中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical dispersion error metrics for various finite-difference\n    and Runge-Kutta schemes applied to the 1D linear advection equation.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 4096  # Number of samples for theta\n    epsilon = 1e-6  # Small offset for theta interval\n\n    # Define the nondimensional wavenumber theta\n    theta = np.linspace(epsilon, np.pi - epsilon, N)\n\n    # --- Scheme Definitions ---\n\n    # Nondimensional modified wavenumber alpha(theta) for centered finite-difference schemes\n    def alpha2(th):\n        return np.sin(th)\n\n    def alpha4(th):\n        return (8 * np.sin(th) - np.sin(2 * th)) / 6\n\n    def alpha6(th):\n        return (45 * np.sin(th) - 9 * np.sin(2 * th) + np.sin(3 * th)) / 30\n\n    alpha_funcs = {2: alpha2, 4: alpha4, 6: alpha6}\n\n    # Stability polynomials R(z) for explicit Runge-Kutta methods\n    def R2(z):\n        return 1 + z + 0.5 * z**2\n\n    def R4(z):\n        return 1 + z + 0.5 * z**2 + (1/6) * z**3 + (1/24) * z**4\n\n    R_funcs = {2: R2, 4: R4}\n\n    # --- Test Suite ---\n    test_cases = [\n        (2, 2, 0.3),  # Case 1\n        (4, 4, 0.5),  # Case 2\n        (6, 4, 0.9),  # Case 3\n        (4, 2, 0.9),  # Case 4\n        (6, 4, 0.05), # Case 5\n    ]\n\n    all_results = []\n\n    for p, s, lambda_val in test_cases:\n        # Select the appropriate functions for the current case\n        alpha_func = alpha_funcs.get(p)\n        R_func = R_funcs.get(s)\n\n        if not alpha_func or not R_func:\n            raise ValueError(f\"Invalid scheme parameters p={p} or s={s}\")\n\n        # --- Calculation of Relative Phase Speed Error e(theta) ---\n\n        # 1. Calculate alpha(theta) for the spatial scheme\n        alpha_theta = alpha_func(theta)\n\n        # 2. Calculate z(theta)\n        z_theta = -1j * lambda_val * alpha_theta\n\n        # 3. Calculate the amplification factor G(theta) using the stability polynomial\n        G_theta = R_func(z_theta)\n\n        # 4. Calculate the relative phase speed error e(theta)\n        # e(theta) = -arg(G(theta)) / (lambda * alpha(theta)) - 1\n        arg_G = np.angle(G_theta)\n        \n        # Avoid division by zero for alpha_theta which can be zero for some theta values,\n        # although the problem statement says to exclude theta=0 and pi.\n        # A small epsilon is added to the denominator for robustness, although with the\n        # given theta range it is not strictly necessary.\n        safe_alpha_theta = alpha_theta + 1e-12\n        e_theta = -arg_G / (lambda_val * safe_alpha_theta) - 1\n\n        # --- Calculation of Metrics ---\n\n        # E_max: Maximum absolute error\n        E_max = np.max(np.abs(e_theta))\n\n        # E_mid: Error at theta = pi/3\n        # Find the index of the theta sample closest to pi/3\n        mid_idx = np.abs(theta - np.pi / 3).argmin()\n        E_mid = e_theta[mid_idx]\n\n        # E_rms: Root mean square error\n        E_rms = np.sqrt(np.mean(e_theta**2))\n\n        # Append results for the current case\n        all_results.extend([E_max, E_mid, E_rms])\n\n    # --- Final Output ---\n    # Format the results as a comma-separated list in brackets\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}