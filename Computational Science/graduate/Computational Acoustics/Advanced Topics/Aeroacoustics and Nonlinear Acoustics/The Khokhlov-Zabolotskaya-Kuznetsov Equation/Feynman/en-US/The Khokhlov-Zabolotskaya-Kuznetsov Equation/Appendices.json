{
    "hands_on_practices": [
        {
            "introduction": "The Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation masterfully unifies the distinct physical effects of diffraction, absorption, and nonlinearity. A powerful way to understand such a comprehensive model is to analyze its behavior in simplified limits where one effect dominates. This exercise explores the weak-signal regime, where the acoustic pressure is small and nonlinear effects become negligible, reducing the KZK equation to the familiar linear paraxial wave equation. By working through this problem, you will solidify your understanding of how the diffraction term governs beam spreading and connects to the classical theory of Gaussian beams .",
            "id": "4143327",
            "problem": "Consider a thermoviscous fluid characterized by ambient mass density $\\rho_{0}$, ambient pressure $p_{0}$, small-signal sound speed $c_{0}$, nonlinearity parameter $\\beta$, and sound diffusivity $\\delta$. Let $p(\\mathbf{r}_{\\perp},z,\\tau)$ denote the acoustic pressure, where $\\mathbf{r}_{\\perp}=(x,y)$ is the transverse coordinate, $z$ is the axial coordinate, and $\\tau=t-z/c_{0}$ is the retarded time. The Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation in mixed-derivative form is\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big),\n$$\nwhere $\\nabla_{\\perp}^{2}=\\frac{\\partial^{2}}{\\partial x^{2}}+\\frac{\\partial^{2}}{\\partial y^{2}}$ is the transverse Laplacian. Assume a monochromatic drive with angular frequency $\\omega$, so that the field can be written as $p(\\mathbf{r}_{\\perp},z,\\tau)=\\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$, where $P$ is a complex amplitude slowly varying in $z$. Work in the weak-signal regime $p\\ll p_{0}$ and assume negligible thermoviscous absorption over the axial distances of interest.\n\nPart A: Starting from the KZK equation and the assumptions above, justify the reduction to the classical linear paraxial diffraction equation for the complex amplitude $P(\\mathbf{r}_{\\perp},z)$ in terms of the wavenumber $k=\\omega/c_{0}$. Clearly state which terms are neglected and why, using the stated physical assumptions, and write the resulting governing equation for $P$.\n\nPart B: Consider an axisymmetric Gaussian beam at $z=0$ with complex amplitude\n$$\nP(r,0)=P_{0}\\,\\exp\\!\\left(-\\frac{r^{2}}{w_{0}^{2}}\\right),\n$$\nwhere $r=|\\mathbf{r}_{\\perp}|$, $P_{0}$ is a constant, and $w_{0}$ is the initial waist radius. Under the reduced linear paraxial diffraction equation found in Part A, determine the axial evolution of the beam waist $w(z)$ such that the transverse profile remains Gaussian, i.e., $P(r,z)$ retains the form $P(r,z)=C(z)\\exp\\!\\big(-r^{2}/w(z)^{2}\\big)$ up to a phase factor. Provide a closed-form analytic expression for $w(z)$ in terms of $w_{0}$, $k$, and $z$.\n\nExpress any lengths (such as $w_{0}$ and $z$) in meters and $k$ in radians per meter. Your final answer must be a single closed-form analytic expression. Do not include units in your final boxed answer.",
            "solution": "We begin from the given Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation in mixed-derivative form,\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big),\n$$\nwith $\\tau=t-z/c_{0}$ the retarded time. Assume a monochromatic field $p(\\mathbf{r}_{\\perp},z,\\tau)=\\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$, and introduce the complex representation $p(\\mathbf{r}_{\\perp},z,\\tau)\\approx P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)$ for the purpose of deriving the governing equation for $P$. Under this representation, time derivatives map as $\\frac{\\partial}{\\partial \\tau}\\mapsto i\\omega$. The left-hand side becomes\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\\;\\to\\;i\\omega\\,\\frac{\\partial P}{\\partial z}\\,\\exp(i\\omega \\tau).\n$$\nThe diffraction term maps to\n$$\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p \\;\\to\\; \\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\\,\\exp(i\\omega \\tau),\n$$\nthe thermoviscous absorption term becomes\n$$\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n\\;\\to\\;\n\\frac{\\delta}{2 c_{0}^{3}}\\,(i\\omega)^{3}P\\,\\exp(i\\omega \\tau)\n=\n-\\;i\\,\\frac{\\delta\\,\\omega^{3}}{2 c_{0}^{3}}\\,P\\,\\exp(i\\omega \\tau),\n$$\nand the nonlinear term reads\n$$\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big)\n\\;\\to\\;\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,(i\\omega)^{2}\\big(P^{2}\\exp(2 i\\omega \\tau)\\big)\n=\n-\\;\\frac{\\beta\\,\\omega^{2}}{2 \\rho_{0} c_{0}^{3}}\\,P^{2}\\,\\exp(2 i\\omega \\tau).\n$$\nIn the weak-signal regime $p\\ll p_{0}$, the nonlinear term proportional to $P^{2}$ is negligible compared to the linear terms because it scales as the square of the acoustic Mach number and drives higher harmonics at frequency $2\\omega$ which are not sustained under small amplitudes. Additionally, we assume negligible absorption over the propagation distances of interest, so the term proportional to $\\delta$ is dropped. Then the balance reduces to\n$$\ni\\omega\\,\\frac{\\partial P}{\\partial z}\\,\\exp(i\\omega \\tau)\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\\,\\exp(i\\omega \\tau).\n$$\nCanceling $\\exp(i\\omega \\tau)$ and introducing the wavenumber $k=\\omega/c_{0}$ yields\n$$\ni\\omega\\,\\frac{\\partial P}{\\partial z}=\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\n\\quad\\Longrightarrow\\quad\n2\\,i\\,k\\,\\frac{\\partial P}{\\partial z}+\\nabla_{\\perp}^{2}P=0.\n$$\nThis is the classical linear paraxial diffraction (paraxial Helmholtz) equation for the complex amplitude $P(\\mathbf{r}_{\\perp},z)$.\n\nNext we determine the evolution of the Gaussian waist under this equation. Assume an axisymmetric Gaussian form\n$$\nP(r,z)=C(z)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big),\n$$\nwith $r=|\\mathbf{r}_{\\perp}|$, complex width parameter $a(z)$, and complex amplitude $C(z)$. The initial condition at $z=0$ is $P(r,0)=P_{0}\\exp(-r^{2}/w_{0}^{2})$, which sets $C(0)=P_{0}$ and $a(0)=1/w_{0}^{2}$.\n\nWe compute the derivatives. The transverse Laplacian for a radial Gaussian satisfies\n$$\n\\nabla_{\\perp}^{2}\\big[\\exp(-a r^{2})\\big]\n=\n\\big(-4 a+4 a^{2}r^{2}\\big)\\,\\exp(-a r^{2}),\n$$\nso\n$$\n\\nabla_{\\perp}^{2}P\n=\nC(z)\\,\\big(-4 a(z)+4 a(z)^{2}r^{2}\\big)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big).\n$$\nThe axial derivative is\n$$\n\\frac{\\partial P}{\\partial z}\n=\n\\Big(C'(z)-C(z)\\,a'(z)\\,r^{2}\\Big)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big).\n$$\nSubstituting into the paraxial equation $2\\,i\\,k\\,\\partial_{z}P+\\nabla_{\\perp}^{2}P=0$ and dividing by $P=C(z)\\exp(-a(z)r^{2})$ gives\n$$\n2\\,i\\,k\\left(\\frac{C'(z)}{C(z)}-a'(z)\\,r^{2}\\right)+\\big(-4 a(z)+4 a(z)^{2}r^{2}\\big)=0.\n$$\nEquating coefficients of like powers of $r$ yields a coupled system:\n$$\n-\\,2\\,i\\,k\\,a'(z)+4\\,a(z)^{2}=0,\n\\qquad\n2\\,i\\,k\\,\\frac{C'(z)}{C(z)}-4\\,a(z)=0.\n$$\nThe width parameter obeys the Riccati equation\n$$\na'(z)=\\frac{2\\,i}{k}\\,a(z)^{2},\n\\qquad\na(0)=\\frac{1}{w_{0}^{2}}.\n$$\nThis separable equation integrates to\n$$\n\\frac{d a}{a^{2}}=\\frac{2\\,i}{k}\\,dz\n\\quad\\Longrightarrow\\quad\n-\\frac{1}{a(z)}=\\frac{2\\,i}{k}\\,z - \\frac{1}{a(0)}=\\frac{2\\,i}{k}\\,z - w_{0}^{2},\n$$\nso\n$$\na(z)=\\frac{1}{w_{0}^{2}-\\frac{2\\,i}{k}\\,z}.\n$$\nWrite $a(z)$ in terms of its real part to identify the physical waist $w(z)$. By definition of the Gaussian envelope, the amplitude profile is $|P(r,z)|\\propto \\exp\\!\\big(-\\operatorname{Re}[a(z)]\\,r^{2}\\big)$, so the waist satisfies\n$$\n\\operatorname{Re}\\big[a(z)\\big]=\\frac{1}{w(z)^{2}}.\n$$\nUsing $a(z)=\\big(w_{0}^{2}-i\\,\\alpha\\big)^{-1}$ with $\\alpha=(2 z)/k$, we have\n$$\na(z)=\\frac{w_{0}^{2}+i\\,\\alpha}{w_{0}^{4}+\\alpha^{2}},\n\\qquad\n\\operatorname{Re}\\big[a(z)\\big]=\\frac{w_{0}^{2}}{w_{0}^{4}+\\alpha^{2}}.\n$$\nTherefore\n$$\n\\frac{1}{w(z)^{2}}=\\frac{w_{0}^{2}}{w_{0}^{4}+\\alpha^{2}}\n\\quad\\Longrightarrow\\quad\nw(z)^{2}=\\frac{w_{0}^{4}+\\alpha^{2}}{w_{0}^{2}}\n=\nw_{0}^{2}+\\frac{\\alpha^{2}}{w_{0}^{2}}\n=\nw_{0}^{2}\\left(1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}\\right).\n$$\nTaking the positive square root yields the axial evolution of the beam waist:\n$$\nw(z)=w_{0}\\,\\sqrt{1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}}.\n$$\nThis is the classical linear diffraction law for a Gaussian beam in the paraxial regime, with an acoustic Rayleigh length $z_{R}=k\\,w_{0}^{2}/2$ implicitly defined by the denominator inside the square root.\n\nAll steps above follow directly from the KZK model under the weak-signal limit $p\\ll p_{0}$ (neglecting the nonlinear term) and negligible absorption (dropping the thermoviscous term), together with monochromatic excitation and the paraxial approximation.",
            "answer": "$$\\boxed{w_{0}\\sqrt{1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}}}$$"
        },
        {
            "introduction": "After isolating diffraction, we now turn to the other two competing effects modeled by the KZK equation: nonlinearity and absorption. This practice examines the plane-wave limit, a scenario where a beam is wide enough that diffractive spreading can be ignored over the distances of interest. The evolution of a high-amplitude wave then becomes a contest between nonlinear steepening, which deforms the waveform and can lead to shocks, and thermoviscous absorption, which dissipates acoustic energy. This exercise will guide you in quantifying this competition by comparing the characteristic length scales for nonlinearity, $L_N$, and absorption, $L_A$, providing a crucial tool for predicting a wave's behavior .",
            "id": "4143383",
            "problem": "A monochromatic, axisymmetric ultrasound beam in a thermoviscous fluid is modeled by the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation. In the plane-wave limit (negligible diffraction), the evolution along the beam axis reduces to the combined effects of nonlinearity and absorption. Starting from the one-dimensional conservation of mass and momentum for a compressible Newtonian fluid and a second-order equation of state (so that the effective quadratic nonlinearity is characterized by the coefficient $\\,\\beta\\,$), and using the standard linear thermoviscous result that the amplitude attenuation coefficient follows a quadratic frequency law $\\,\\alpha(\\omega)=\\alpha_0 \\omega^2\\,$, carry out the following:\n\n- Derive the shock formation distance $\\,L_N\\,$ for a sinusoidal plane wave of angular frequency $\\,\\omega_0\\,$ and pressure amplitude $\\,p_0\\,$ in terms of $\\,\\rho_0\\,$, $\\,c_0\\,$, $\\,\\beta\\,$, $\\,\\omega_0\\,$, and $\\,p_0\\,$ by analyzing nonlinear steepening in the inviscid limit.\n- Using the linear attenuation law, write the absorption length $\\,L_A\\,$ and the attenuation per wavelength $\\,\\mathcal{A}_\\lambda\\,$ in terms of $\\,\\alpha(\\omega_0)\\,$ and the wavelength $\\,\\lambda_0\\,$.\n- Define the dimensionless ratio $\\,R \\equiv L_A/L_N\\,$ as a quantitative measure of the relative importance of absorption versus nonlinearity. If $\\,R \\gg 1\\,$, nonlinear distortion outpaces absorption; if $\\,R \\ll 1\\,$, absorption dominates before appreciable nonlinear distortion occurs.\n\nGiven the following medium and source parameters, compute $\\,\\mathcal{A}_\\lambda\\,$ and then evaluate $\\,R\\,$:\n- Equilibrium density $\\,\\rho_0 = 1000\\,\\mathrm{kg/m^3}$,\n- Small-signal sound speed $\\,c_0 = 1500\\,\\mathrm{m/s}$,\n- Quadratic nonlinearity coefficient $\\,\\beta = 3.5$,\n- Pressure amplitude $\\,p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$,\n- Carrier frequency $\\,f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$ (so $\\,\\omega_0 = 2\\pi f_0\\,$),\n- Thermoviscous absorption parameter $\\,\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$.\n\nUse $\\,\\lambda_0 = c_0/f_0\\,$, report $\\,\\mathcal{A}_\\lambda = \\alpha(\\omega_0)\\lambda_0\\,$ as a dimensionless attenuation per wavelength (in nepers per wavelength), and then compute $\\,R\\,$. Round your final reported value of $\\,R\\,$ to three significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The solution proceeds in three stages: first, the derivation of the characteristic lengths for nonlinearity and absorption; second, the formulation of their ratio; and third, the numerical evaluation of the requested quantities.\n\n**1. Derivation of Characteristic Lengths**\n\n**Shock Formation Distance, $L_N$**\nIn a lossless fluid, the speed of sound is not constant but depends on the local fluid properties. For a second-order equation of state, the propagation speed $c$ of a point on the wave profile is given by $c = c_0 + \\beta u$, where $c_0$ is the small-signal sound speed, $\\beta$ is the coefficient of quadratic nonlinearity, and $u$ is the particle velocity. For a plane progressive wave, the acoustic pressure $p$ and particle velocity $u$ are related by the characteristic impedance of the medium, $p = \\rho_0 c_0 u$, where $\\rho_0$ is the equilibrium density. Thus, we can express the local propagation speed in terms of pressure:\n$$c = c_0 + \\frac{\\beta p}{\\rho_0 c_0}$$\nThis equation shows that points of higher pressure travel faster than points of lower pressure. For an initially sinusoidal wave $p(x=0, t) = p_0 \\sin(\\omega_0 t)$, the wave crests (at pressure $p_0$) travel at a speed $c_{peak} = c_0 + \\frac{\\beta p_0}{\\rho_0 c_0}$, while the troughs (at pressure $-p_0$) travel at $c_{trough} = c_0 - \\frac{\\beta p_0}{\\rho_0 c_0}$. This velocity difference causes the wave profile to steepen as it propagates.\n\nA shock, or a discontinuity in the waveform, forms when the slope of the waveform becomes infinite. This first occurs at a distance known as the shock formation distance, $L_N$. A standard derivation, which we will not reproduce in full detail, shows that this distance for an initially sinusoidal plane wave is given by:\n$$L_N = \\frac{c_0^2}{\\beta u_0 \\omega_0}$$\nwhere $u_0 = p_0/(\\rho_0 c_0)$ is the particle velocity amplitude. Substituting for $u_0$, we obtain the shock formation distance in terms of the given parameters:\n$$L_N = \\frac{c_0^2}{\\beta \\left(\\frac{p_0}{\\rho_0 c_0}\\right) \\omega_0} = \\frac{\\rho_0 c_0^3}{\\beta p_0 \\omega_0}$$\n\n**Absorption Length, $L_A$, and Attenuation per Wavelength, $\\mathcal{A}_\\lambda$**\nThe problem stipulates that the amplitude attenuation coefficient $\\alpha$ follows a quadratic frequency law, $\\alpha(\\omega) = \\alpha_0 \\omega^2$, where $\\alpha_0$ is a constant characteristic of the fluid. For a monochromatic wave of angular frequency $\\omega_0$, the attenuation coefficient is $\\alpha(\\omega_0) = \\alpha_0 \\omega_0^2$.\nIn the absence of nonlinear effects, the wave amplitude decays exponentially with distance $x$ as $p_0 \\exp(-\\alpha(\\omega_0) x)$. The absorption length, $L_A$, is defined as the distance over which the amplitude is attenuated by a factor of $1/e$. This implies $\\alpha(\\omega_0) L_A = 1$, which gives:\n$$L_A = \\frac{1}{\\alpha(\\omega_0)} = \\frac{1}{\\alpha_0 \\omega_0^2}$$\nThe attenuation per wavelength, $\\mathcal{A}_\\lambda$, is a dimensionless measure of absorption, defined as the product of the attenuation coefficient and the wavelength, $\\lambda_0$. The wavelength is given by $\\lambda_0 = c_0/f_0 = 2\\pi c_0 / \\omega_0$.\n$$\\mathcal{A}_\\lambda \\equiv \\alpha(\\omega_0) \\lambda_0 = (\\alpha_0 \\omega_0^2) \\left(\\frac{2\\pi c_0}{\\omega_0}\\right) = 2\\pi \\alpha_0 c_0 \\omega_0$$\n\n**2. Dimensionless Ratio, $R$**\n\nThe ratio $R = L_A/L_N$ quantifies the relative importance of absorption versus nonlinearity. A large $R$ implies that the shock formation distance is much shorter than the absorption length, so nonlinear effects dominate. A small $R$ implies the wave is significantly attenuated before it can steepen into a shock.\nUsing the expressions derived above:\n$$R = \\frac{L_A}{L_N} = \\frac{1/(\\alpha_0 \\omega_0^2)}{(\\rho_0 c_0^3)/(\\beta p_0 \\omega_0)} = \\frac{\\beta p_0 \\omega_0}{\\alpha_0 \\omega_0^2 \\rho_0 c_0^3}$$\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\nThis expression, often referred to as the Gol'dberg number, will be computed.\n\n**3. Numerical Evaluation**\n\nThe given parameters are:\n- Equilibrium density: $\\rho_0 = 1000\\,\\mathrm{kg/m^3}$\n- Small-signal sound speed: $c_0 = 1500\\,\\mathrm{m/s}$\n- Quadratic nonlinearity coefficient: $\\beta = 3.5$\n- Pressure amplitude: $p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$\n- Carrier frequency: $f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$\n- Thermoviscous absorption parameter: $\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$\n\nFirst, we calculate the angular frequency:\n$$\\omega_0 = 2\\pi f_0 = 2\\pi (1.5 \\times 10^{6}\\,\\mathrm{Hz}) = 3\\pi \\times 10^6\\,\\mathrm{rad/s}$$\n\nNow, we compute the attenuation per wavelength, $\\mathcal{A}_\\lambda$, as requested.\n$$\\mathcal{A}_\\lambda = 2\\pi \\alpha_0 c_0 \\omega_0 = 2\\pi (6.0 \\times 10^{-18}\\,\\mathrm{s^2/m})(1500\\,\\mathrm{m/s})(3\\pi \\times 10^6\\,\\mathrm{s^{-1}})$$\n$$\\mathcal{A}_\\lambda = (2\\pi \\times 6.0 \\times 1.5 \\times 10^3 \\times 3\\pi \\times 10^6) \\times 10^{-18} = 54\\pi^2 \\times 10^{-9}$$\n$$\\mathcal{A}_\\lambda \\approx 5.3296 \\times 10^{-7}\\,\\text{(Nepers per wavelength)}$$\n\nNext, we evaluate the dimensionless ratio $R$:\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\nSubstituting the numerical values:\n$$R = \\frac{(3.5)(3.0 \\times 10^5)}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(1000)(1500)^3}$$\n$$R = \\frac{1.05 \\times 10^6}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(10^3)(3.375 \\times 10^9)}$$\n$$R = \\frac{1.05 \\times 10^6}{6.0 \\times 3\\pi \\times 3.375 \\times 10^{(-18+6+3+9)}} = \\frac{1.05 \\times 10^6}{60.75\\pi \\times 10^0}$$\n$$R = \\frac{1050000}{60.75\\pi} \\approx 5501.033$$\nThe problem asks for the final value of $R$ to be rounded to three significant figures.\n$$R \\approx 5.50 \\times 10^3$$\nThe large value of $R$ indicates that for the given parameters, nonlinear effects are strongly dominant over dissipative effects, and a shock wave would form long before the wave is significantly attenuated.",
            "answer": "$$\n\\boxed{5.50 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "Theory and computation are deeply intertwined pillars of modern science. This final practice bridges the analytical concepts from the previous exercises with practical, hands-on implementation by asking you to numerically simulate the diffraction process. You will employ a spectral method, a highly accurate and efficient technique that solves the wave equation in the spatial frequency domain using the Fast Fourier Transform (FFT). By building a simulation and verifying its output against the exact analytical solution for a Gaussian beam, you will gain experience with a state-of-the-art computational tool and reinforce the powerful connection between theoretical models and numerical results .",
            "id": "4143330",
            "problem": "Consider a monochromatic, axisymmetric sound beam of angular frequency $\\omega$ propagating primarily in the $+z$ direction in a thermoviscous fluid of sound speed $c$. Starting from the linear acoustic wave equation and the slowly varying envelope approximation appropriate for directed beams, derive the linear limit of the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation governing diffraction of the complex envelope $U(x,y,z)$ and show how the paraxial Gaussian-beam solution arises as the exact solution of the resulting paraxial model. Then design an algorithm that computes the diffraction of an initially Gaussian beam by numerically solving the linear paraxial KZK model, and compare the numerical result to the paraxial Gaussian-beam solution you derive.\n\nYour program must implement the following:\n\n- Use a two-dimensional transverse computational domain $(x,y)$ with periodic boundary conditions and a spectral method to represent the transverse Laplacian. Assume axisymmetry by choosing an initially axisymmetric Gaussian envelope and using an isotropic transverse operator. Do not include nonlinearity or thermoviscous absorption; work strictly in the linear limit.\n- For a given set of physical parameters $\\{c,\\ f,\\ w_0,\\ z\\}$, where $c$ is the sound speed in $\\mathrm{m/s}$, $f$ is the frequency in $\\mathrm{Hz}$, $w_0$ is the initial $1/e$ amplitude beam waist in $\\mathrm{m}$, and $z$ is the propagation distance in $\\mathrm{m}$, compute\n  - the numerical envelope magnitude along the symmetry line $y=0$ at the plane $z$ by solving the linear paraxial KZK model using a single spectral propagation step, and\n  - the analytical paraxial Gaussian-beam envelope magnitude along the same line at the same plane.\n- Measure the discrepancy by the relative $\\ell_2$ error over the sampled line $y=0$, defined as the ratio of the discrete $\\ell_2$ norm of the difference between the numerical and analytical magnitudes to the discrete $\\ell_2$ norm of the analytical magnitude. This is a dimensionless quantity expressed as a float.\n\nFundamental base you must use in your derivation in the solution:\n- The linear acoustic wave equation for pressure fluctuation $p$: $\\nabla^2 p - \\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} = 0$.\n- The slowly varying envelope representation of a forward-propagating beam: $p(x,y,z,t) = \\Re\\{U(x,y,z)\\, e^{\\mathrm{i}(k z - \\omega t)}\\}$ with $k = \\frac{2\\pi f}{c}$.\n- The paraxial, forward-scattering approximation that neglects backscattering and second $z$-derivatives of the envelope relative to first $z$-derivatives.\n\nNumerical method requirements:\n- Transverse domain: choose a square domain of side length $L = 8 w_0$ and discretize it on a uniform grid of $N \\times N$ points with $N=512$ and spacing $\\Delta x = \\Delta y = L/N$ in $\\mathrm{m}$.\n- Initial condition at $z=0$: an axisymmetric Gaussian envelope with on-axis amplitude $U_0 = 1$ and $1/e$ amplitude waist $w_0$, i.e., $U(x,y,0)$ has Gaussian amplitude in $r = \\sqrt{x^2 + y^2}$.\n- Spectral propagation: use the exact solution operator of the linear paraxial KZK model in the spatial-frequency domain to propagate from $z=0$ to $z$ in a single step.\n\nAnalytical comparison requirements:\n- Derive and use the paraxial Gaussian-beam solution for the same parameters $\\{c,\\ f,\\ w_0,\\ z\\}$ to compute the analytical envelope magnitude along $y=0$.\n- All distances must be in $\\mathrm{m}$, frequency in $\\mathrm{Hz}$, and speed in $\\mathrm{m/s}$. The output discrepancy must be a dimensionless float.\n\nTest suite:\nYour program must execute the following four test cases. In each case, set $U_0 = 1$, $N = 512$, and $L = 8 w_0$.\n1. Happy path near the Rayleigh range: $c = 1500$ $\\mathrm{m/s}$, $f = 1.0 \\times 10^6$ $\\mathrm{Hz}$, $w_0 = 2.0 \\times 10^{-3}$ $\\mathrm{m}$, $z = z_R$, where $z_R$ is the Rayleigh range implied by your derivation.\n2. Boundary condition at source plane: same $c$, $f$, and $w_0$ as case $1$, but $z = 0$ $\\mathrm{m}$.\n3. Broad beam (near-plane-wave) diffraction over moderate distance: $c = 1500$ $\\mathrm{m/s}$, $f = 1.0 \\times 10^6$ $\\mathrm{Hz}$, $w_0 = 1.0 \\times 10^{-2}$ $\\mathrm{m}$, $z = 0.05$ $\\mathrm{m}$.\n4. Strongly diffracting narrow beam in the far field: $c = 1500$ $\\mathrm{m/s}$, $f = 1.0 \\times 10^6$ $\\mathrm{Hz}$, $w_0 = 5.0 \\times 10^{-4}$ $\\mathrm{m}$, $z = 3 z_R$.\n\nFinal output format:\n- Your program should produce a single line of output containing the relative $\\ell_2$ errors for the four test cases as a comma-separated list enclosed in square brackets, for example, $[e_1,e_2,e_3,e_4]$, where each $e_i$ is a float.",
            "solution": "The problem requires the derivation of the linear, lossless paraxial wave equation from the fundamental acoustic wave equation, the derivation of its Gaussian beam solution, and the implementation of a numerical spectral algorithm to simulate beam propagation and compare it against the analytical solution.\n\n### 1. Derivation of the Linear Paraxial Wave Equation\n\nWe begin with the linear acoustic wave equation for the pressure fluctuation $p$ in a homogeneous, lossless fluid with a constant sound speed $c$:\n$$\n\\nabla^2 p - \\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} = 0\n$$\nHere, $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ is the Laplacian operator.\n\nFor a monochromatic beam of angular frequency $\\omega$ traveling primarily in the $+z$ direction, we represent the pressure field using the slowly varying envelope approximation (SVEA). We express the complex pressure field $p_c$ as:\n$$\np_c(x,y,z,t) = U(x,y,z)\\, e^{\\mathrm{i}(k z - \\omega t)}\n$$\nThe physical pressure is the real part of this, $p = \\Re\\{p_c\\}$. The complex envelope $U(x,y,z)$ is assumed to vary slowly with respect to the wavelength in both transverse and axial directions. The parameter $k = \\omega/c$ is the acoustic wavenumber, with $\\omega = 2\\pi f$ where $f$ is the frequency.\n\nSubstituting this ansatz into the wave equation, we first compute the derivatives. The time derivative is $\\frac{\\partial^2 p_c}{\\partial t^2} = (-\\mathrm{i}\\omega)^2 p_c = -\\omega^2 p_c$. The wave equation thus simplifies to the Helmholtz equation:\n$$\n\\nabla^2 p_c + \\frac{\\omega^2}{c^2} p_c = 0 \\implies \\nabla^2 p_c + k^2 p_c = 0\n$$\nNext, we expand the spatial derivatives of $p_c = Ue^{\\mathrm{i}kz}$. The Laplacian is $\\nabla^2 = \\nabla_\\perp^2 + \\frac{\\partial^2}{\\partial z^2}$, where $\\nabla_\\perp^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the transverse Laplacian.\n\nThe derivatives are:\n$$\n\\nabla_\\perp^2 p_c = (\\nabla_\\perp^2 U) e^{\\mathrm{i}kz}\n$$\n$$\n\\frac{\\partial p_c}{\\partial z} = \\left(\\frac{\\partial U}{\\partial z} + \\mathrm{i}k U\\right) e^{\\mathrm{i}kz}\n$$\n$$\n\\frac{\\partial^2 p_c}{\\partial z^2} = \\left(\\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} - k^2 U\\right) e^{\\mathrm{i}kz}\n$$\nSubstituting these into the Helmholtz equation and canceling the common factor $e^{\\mathrm{i}kz}$ yields:\n$$\n(\\nabla_\\perp^2 U) + \\left(\\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} - k^2 U\\right) + k^2 U = 0\n$$\nThis simplifies to the exact equation for the envelope $U$:\n$$\n\\nabla_\\perp^2 U + \\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} = 0\n$$\nThe paraxial approximation, central to the SVEA, posits that the envelope $U$ varies much more slowly along the propagation axis $z$ than the acoustic carrier wave. Mathematically, this means the second derivative of the envelope with respect to $z$ is negligible compared to the first derivative term scaled by the wavenumber:\n$$\n\\left|\\frac{\\partial^2 U}{\\partial z^2}\\right| \\ll \\left|2k \\frac{\\partial U}{\\partial z}\\right|\n$$\nApplying this approximation, we drop the $\\frac{\\partial^2 U}{\\partial z^2}$ term, arriving at the linear paraxial wave equation (PWE):\n$$\n\\nabla_\\perp^2 U + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} = 0\n$$\nRearranging to a standard evolution form gives the model to be solved:\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{\\mathrm{i}}{2k} \\nabla_\\perp^2 U\n$$\nThis is the linear, lossless limit of the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation.\n\n### 2. The Analytical Paraxial Gaussian-Beam Solution\n\nThe paraxial wave equation admits an exact solution for an initial condition that has a Gaussian profile. For an axisymmetric initial beam profile at the source plane $z=0$ given by:\n$$\nU(x,y,0) = U_0 \\exp\\left(-\\frac{x^2+y^2}{w_0^2}\\right)\n$$\nwhere $U_0$ is the on-axis amplitude and $w_0$ is the initial beam waist ($1/e$ amplitude radius), the exact solution to the PWE for $z>0$ is the well-known paraxial Gaussian beam:\n$$\nU(r,z) = U_0 \\frac{w_0}{w(z)} \\exp\\left(-\\frac{r^2}{w(z)^2}\\right) \\exp\\left(-\\mathrm{i}k\\frac{r^2}{2R(z)} + \\mathrm{i}\\zeta(z)\\right)\n$$\nwhere $r = \\sqrt{x^2+y^2}$ is the transverse radial coordinate. The parameters of the beam evolve with propagation distance $z$ as follows:\n- **Beam waist:** $w(z) = w_0 \\sqrt{1 + (z/z_R)^2}$. This describes the beam's diffractive spreading.\n- **Wavefront radius of curvature:** $R(z) = z \\left(1 + (z_R/z)^2\\right)$. This shows the initially planar wavefronts ($R(0)=\\infty$) becoming spherical.\n- **Gouy phase shift:** $\\zeta(z) = \\arctan(z/z_R)$. This is a phase shift relative to a plane wave.\n- **Rayleigh range:** $z_R = \\frac{k w_0^2}{2} = \\frac{\\pi f w_0^2}{c}$. This characteristic distance delineates the near field ($z \\ll z_R$) from the far field ($z \\gg z_R$).\n\nFor the purpose of comparison, we require the magnitude of the envelope, $|U(r,z)|$. Since the complex exponential term describing the phase has unit magnitude, the analytical magnitude is:\n$$\n|U(r,z)| = |U_0| \\frac{w_0}{w(z)} \\exp\\left(-\\frac{r^2}{w(z)^2}\\right)\n$$\n\n### 3. Numerical Algorithm: Spectral Propagation\n\nThe problem specifies using a spectral method to solve the PWE. This is an efficient and highly accurate method for linear equations with constant coefficients on periodic domains. The algorithm proceeds as follows:\n\n1.  **Fourier Transform:** We apply a two-dimensional spatial Fourier transform $\\mathcal{F}_{x,y}$ to the PWE, $\\frac{\\partial U}{\\partial z} = \\frac{\\mathrm{i}}{2k} \\nabla_\\perp^2 U$. Let $\\hat{U}(k_x, k_y, z) = \\mathcal{F}_{x,y}\\{U(x,y,z)\\}$. The transform converts the transverse partial derivatives into algebraic multiplication: $\\mathcal{F}_{x,y}\\{\\nabla_\\perp^2 U\\} = -(k_x^2 + k_y^2)\\hat{U}$, where $k_x$ and $k_y$ are the transverse spatial frequencies.\n2.  **Ordinary Differential Equation:** The PWE transforms into an ordinary differential equation in $z$ for each $(k_x, k_y)$ pair:\n    $$\n    \\frac{\\partial \\hat{U}}{\\partial z} = -\\frac{\\mathrm{i}(k_x^2 + k_y^2)}{2k} \\hat{U}\n    $$\n3.  **Frequency-Domain Solution:** This ODE has the exact solution:\n    $$\n    \\hat{U}(k_x, k_y, z) = \\hat{U}(k_x, k_y, 0) \\exp\\left(-\\frac{\\mathrm{i}(k_x^2 + k_y^2)z}{2k}\\right)\n    $$\n    The term $H(k_x, k_y, z) = \\exp\\left(-\\frac{\\mathrm{i}(k_x^2 + k_y^2)z}{2k}\\right)$ is the exact propagator or transfer function for a propagation distance $z$.\n\nThe numerical implementation steps are:\n1.  **Discretize:** Define a computational grid $(x,y)$ of size $N \\times N$ with side length $L = 8w_0$ and spacing $\\Delta x = \\Delta y = L/N$.\n2.  **Initialize:** Construct the initial field $U(x,y,0)$ on this grid.\n3.  **Forward FFT:** Compute $\\hat{U}(k_x,k_y,0)$ using a 2D Fast Fourier Transform (FFT) of $U(x,y,0)$.\n4.  **Propagate:** Multiply $\\hat{U}(k_x,k_y,0)$ by the discretized propagator $H(k_x, k_y, z)$. The required spatial frequencies $k_x$ and $k_y$ are determined by the grid parameters $N$ and $\\Delta x$.\n5.  **Inverse FFT:** Compute the final field $U(x,y,z)$ by applying a 2D inverse FFT to the propagated spectrum $\\hat{U}(k_x,k_y,z)$.\n6.  **Extract:** Obtain the numerical envelope magnitude $|U(x,y,z)|$ and extract the profile along the line $y=0$.\n\n### 4. Comparison and Error Metric\n\nThe discrepancy between the numerical and analytical solutions is quantified by the relative $\\ell_2$ error. For the discrete numerical profile $\\mathbf{u}_{\\text{num}}$ and analytical profile $\\mathbf{u}_{\\text{ana}}$ (both evaluated on the same grid points along $y=0$), the error $E$ is:\n$$\nE = \\frac{\\|\\mathbf{u}_{\\text{num}} - \\mathbf{u}_{\\text{ana}}\\|_2}{\\|\\mathbf{u}_{\\text{ana}}\\|_2} = \\frac{\\sqrt{\\sum_i (u_{\\text{num},i} - u_{\\text{ana},i})^2}}{\\sqrt{\\sum_i u_{\\text{ana},i}^2}}\n$$\nThis dimensionless metric measures the normalized root-mean-square difference between the two solutions. Since the spectral propagation method is an exact solution to the PWE, the error is expected to be near machine precision, arising only from floating-point arithmetic and discretization effects like aliasing from the FFT. The choice of $L=8w_0$ is designed to be large enough to minimize these boundary artifacts.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diffraction of an initially Gaussian acoustic beam by numerically\n    solving the linear paraxial KZK model via a spectral method, and compares\n    the result to the analytical Gaussian-beam solution.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # U0, N, and L/w0 ratio are constant across all cases.\n    U0 = 1.0\n    N = 512\n\n    # A list of tuples, each defining a test case:\n    # (c [m/s], f [Hz], w0 [m], z description [str or float])\n    test_params = [\n        (1500.0, 1.0e6, 2.0e-3, 'z_R'),      # Case 1: Happy path at Rayleigh range\n        (1500.0, 1.0e6, 2.0e-3, 0.0),        # Case 2: Boundary condition at source plane\n        (1500.0, 1.0e6, 1.0e-2, 0.05),       # Case 3: Broad beam, near field\n        (1500.0, 1.0e6, 5.0e-4, '3*z_R'),    # Case 4: Narrow beam, far field\n    ]\n\n    results = []\n    for c, f, w0, z_desc in test_params:\n        # --- Physical and Numerical Parameters Setup ---\n        omega = 2.0 * np.pi * f\n        k = omega / c\n        zR = (k * w0**2) / 2.0  # Rayleigh range\n\n        if z_desc == 'z_R':\n            z = zR\n        elif z_desc == '3*z_R':\n            z = 3.0 * zR\n        else:\n            z = float(z_desc)\n\n        L = 8.0 * w0  # Transverse domain side length\n        dx = L / N   # Spatial grid spacing\n        # Centered spatial grid coordinates\n        x = dx * np.arange(-N/2, N/2)\n        xx, yy = np.meshgrid(x, x, indexing='xy')\n\n        # --- Numerical Solution: Spectral Propagation ---\n        \n        # 1. Define initial transverse field U(x,y,0)\n        U_initial = U0 * np.exp(-(xx**2 + yy**2) / w0**2)\n\n        # 2. Shift from centered to FFT-compatible order and perform 2D FFT\n        U_initial_fft_ordered = np.fft.ifftshift(U_initial)\n        U_hat_initial = np.fft.fft2(U_initial_fft_ordered)\n\n        # 3. Define k-space grid and propagation operator\n        # Spatial frequencies corresponding to FFT output order\n        k_vals = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n        kx, ky = np.meshgrid(k_vals, k_vals, indexing='xy')\n\n        # Propagator H = exp(-i * (kx^2+ky^2) * z / (2k))\n        propagator = np.exp(-1j * (kx**2 + ky**2) * z / (2.0 * k))\n\n        # 4. Propagate field in the spatial frequency domain\n        U_hat_z = U_hat_initial * propagator\n\n        # 5. Perform inverse 2D FFT and shift back to centered order\n        U_z_fft_ordered = np.fft.ifft2(U_hat_z)\n        U_z = np.fft.fftshift(U_z_fft_ordered)\n\n        # 6. Extract the numerical result (magnitude along the line y=0)\n        numerical_magnitude_profile = np.abs(U_z[N//2, :])\n\n        # --- Analytical Solution ---\n        # Beam waist at distance z: w(z) = w0 * sqrt(1 + (z/zR)^2)\n        w_z = w0 * np.sqrt(1.0 + (z/zR)**2)\n        \n        # Magnitude |U(x,y=0,z)| = |U0 * w0/w(z) * exp(-x^2/w(z)^2)| with U0=1\n        if w_z == 0:\n            analytical_magnitude_profile = np.zeros_like(x)\n        else:\n            analytical_magnitude_profile = (w0 / w_z) * np.exp(-x**2 / w_z**2)\n            \n        # --- Error Calculation ---\n        # Relative l2 error = ||numerical - analytical|| / ||analytical||\n        norm_analytical = np.linalg.norm(analytical_magnitude_profile)\n        \n        if norm_analytical == 0:\n            # This case occurs if the analytical solution is identically zero.\n            # Error is 0 only if the numerical one is also zero.\n            error = 0.0 if np.linalg.norm(numerical_magnitude_profile) == 0 else np.inf\n        else:\n            norm_difference = np.linalg.norm(numerical_magnitude_profile - analytical_magnitude_profile)\n            error = norm_difference / norm_analytical\n        \n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}