{
    "hands_on_practices": [
        {
            "introduction": "A powerful way to understand a complex physical model like the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation is to examine its behavior in simpler, well-understood limits. This first practice challenges you to do just that by stripping the equation down to its linear, lossless core, revealing the familiar physics of paraxial beam diffraction. By deriving how the KZK equation reduces to the standard paraxial wave equation and solving for the evolution of a Gaussian beam, you will connect this advanced model to foundational concepts in wave theory .",
            "id": "4143327",
            "problem": "Consider a thermoviscous fluid characterized by ambient mass density $\\rho_0$, ambient pressure $p_0$, small-signal sound speed $c_0$, nonlinearity parameter $\\beta$, and sound diffusivity $\\delta$. Let $p(\\mathbf{r}_{\\perp},z,\\tau)$ denote the acoustic pressure, where $\\mathbf{r}_{\\perp}=(x,y)$ is the transverse coordinate, $z$ is the axial coordinate, and $\\tau = t-z/c_0$ is the retarded time. The Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation in mixed-derivative form is\n$$\n\\frac{\\partial^{2}p}{\\partial z \\partial \\tau}\n=\n\\frac{c_0}{2} \\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_0^{3}} \\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_0 c_0^{3}} \\frac{\\partial^{2}}{\\partial \\tau^{2}}(p^{2}),\n$$\nwhere $\\nabla_{\\perp}^{2} = \\frac{\\partial^{2}}{\\partial x^{2}}+\\frac{\\partial^{2}}{\\partial y^{2}}$ is the transverse Laplacian. Assume a monochromatic drive with angular frequency $\\omega$, so that the field can be written as $p(\\mathbf{r}_{\\perp},z,\\tau) = \\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$, where $P$ is a complex amplitude slowly varying in $z$. Work in the weak-signal regime $p \\ll p_0$ and assume negligible thermoviscous absorption over the axial distances of interest.\n\nPart A: Starting from the KZK equation and the assumptions above, justify the reduction to the classical linear paraxial diffraction equation for the complex amplitude $P(\\mathbf{r}_{\\perp},z)$ in terms of the wavenumber $k = \\omega/c_0$. Clearly state which terms are neglected and why, using the stated physical assumptions, and write the resulting governing equation for $P$.\n\nPart B: Consider an axisymmetric Gaussian beam at $z=0$ with complex amplitude\n$$\nP(r,0) = P_0 \\exp\\left(-\\frac{r^{2}}{w_0^{2}}\\right),\n$$\nwhere $r = |\\mathbf{r}_{\\perp}|$, $P_0$ is a constant, and $w_0$ is the initial waist radius. Under the reduced linear paraxial diffraction equation found in Part A, determine the axial evolution of the beam waist $w(z)$ such that the transverse profile remains Gaussian, i.e., $P(r,z)$ retains the form $P(r,z)=C(z)\\exp(-r^{2}/w(z)^{2})$ up to a phase factor. Provide a closed-form analytic expression for $w(z)$ in terms of $w_0$, $k$, and $z$.\n\nExpress any lengths (such as $w_0$ and $z$) in meters and $k$ in radians per meter. Your final answer must be a single closed-form analytic expression. Do not include units in your final boxed answer.",
            "solution": "We begin from the given Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation in mixed-derivative form,\n$$\n\\frac{\\partial^{2}p}{\\partial z \\partial \\tau}\n=\n\\frac{c_0}{2} \\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_0^{3}} \\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_0 c_0^{3}} \\frac{\\partial^{2}}{\\partial \\tau^{2}}(p^{2}),\n$$\nwith $\\tau = t-z/c_0$ the retarded time. Assume a monochromatic field $p(\\mathbf{r}_{\\perp},z,\\tau) = \\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$, and introduce the complex representation $p(\\mathbf{r}_{\\perp},z,\\tau) \\approx P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)$ for the purpose of deriving the governing equation for $P$. Under this representation, time derivatives map as $\\frac{\\partial}{\\partial \\tau}\\mapsto i\\omega$. The left-hand side becomes\n$$\n\\frac{\\partial^{2}p}{\\partial z \\partial \\tau} \\to i\\omega \\frac{\\partial P}{\\partial z} \\exp(i\\omega \\tau).\n$$\nThe diffraction term maps to\n$$\n\\frac{c_0}{2} \\nabla_{\\perp}^{2}p \\to \\frac{c_0}{2} \\nabla_{\\perp}^{2}P \\exp(i\\omega \\tau),\n$$\nthe thermoviscous absorption term becomes\n$$\n\\frac{\\delta}{2 c_0^{3}} \\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n\\to\n\\frac{\\delta}{2 c_0^{3}}(i\\omega)^{3}P \\exp(i\\omega \\tau)\n=\n-i \\frac{\\delta \\omega^{3}}{2 c_0^{3}} P \\exp(i\\omega \\tau),\n$$\nand the nonlinear term reads\n$$\n\\frac{\\beta}{2 \\rho_0 c_0^{3}} \\frac{\\partial^{2}}{\\partial \\tau^{2}}(p^{2})\n\\to\n\\frac{\\beta}{2 \\rho_0 c_0^{3}} (i\\omega)^{2}(P^{2}\\exp(2 i\\omega \\tau))\n=\n-\\frac{\\beta \\omega^{2}}{2 \\rho_0 c_0^{3}} P^{2} \\exp(2 i\\omega \\tau).\n$$\nIn the weak-signal regime ($p \\ll p_0$), the nonlinear term proportional to $P^2$ is negligible compared to the linear terms because it scales as the square of the acoustic Mach number and drives higher harmonics at frequency $2\\omega$ which are not sustained under small amplitudes. Additionally, we assume negligible absorption over the propagation distances of interest, so the term proportional to $\\delta$ is dropped. Then the balance reduces to\n$$\ni\\omega \\frac{\\partial P}{\\partial z} \\exp(i\\omega \\tau)\n=\n\\frac{c_0}{2} \\nabla_{\\perp}^{2}P \\exp(i\\omega \\tau).\n$$\nCanceling $\\exp(i\\omega \\tau)$ and introducing the wavenumber $k = \\omega/c_0$ yields\n$$\ni\\omega \\frac{\\partial P}{\\partial z}=\\frac{c_0}{2} \\nabla_{\\perp}^{2}P\n\\quad\\Longrightarrow\\quad\n2ik \\frac{\\partial P}{\\partial z}+\\nabla_{\\perp}^{2}P=0.\n$$\nThis is the classical linear paraxial diffraction (paraxial Helmholtz) equation for the complex amplitude $P(\\mathbf{r}_{\\perp},z)$.\n\nNext we determine the evolution of the Gaussian waist under this equation. Assume an axisymmetric Gaussian form\n$$\nP(r,z)=C(z) \\exp(-a(z) r^{2}),\n$$\nwith $r = |\\mathbf{r}_{\\perp}|$, complex width parameter $a(z)$, and complex amplitude $C(z)$. The initial condition at $z=0$ is $P(r,0)=P_0\\exp(-r^{2}/w_0^{2})$, which sets $C(0)=P_0$ and $a(0)=1/w_0^{2}$.\n\nWe compute the derivatives. The transverse Laplacian for a radial Gaussian satisfies\n$$\n\\nabla_{\\perp}^{2}[\\exp(-a r^{2})]\n=\n(-4 a+4 a^{2}r^{2}) \\exp(-a r^{2}),\n$$\nso\n$$\n\\nabla_{\\perp}^{2}P\n=\nC(z) (-4 a(z)+4 a(z)^{2}r^{2}) \\exp(-a(z) r^{2}).\n$$\nThe axial derivative is\n$$\n\\frac{\\partial P}{\\partial z}\n=\n\\Big(C'(z)-C(z) a'(z) r^{2}\\Big) \\exp(-a(z) r^{2}).\n$$\nSubstituting into the paraxial equation $2ik \\partial_{z}P+\\nabla_{\\perp}^{2}P=0$ and dividing by $P=C(z)\\exp(-a(z)r^{2})$ gives\n$$\n2ik\\left(\\frac{C'(z)}{C(z)}-a'(z) r^{2}\\right)+(-4 a(z)+4 a(z)^{2}r^{2})=0.\n$$\nEquating coefficients of like powers of $r$ yields a coupled system:\n$$\n-2ik a'(z)+4a(z)^{2}=0,\n\\qquad\n2ik \\frac{C'(z)}{C(z)}-4a(z)=0.\n$$\nThe width parameter obeys the Riccati equation\n$$\na'(z)=\\frac{2i}{k}a(z)^{2},\n\\qquad\na(0)=\\frac{1}{w_0^{2}}.\n$$\nThis separable equation integrates to\n$$\n\\frac{d a}{a^{2}}=\\frac{2i}{k}dz\n\\quad\\Longrightarrow\\quad\n-\\frac{1}{a(z)}=\\frac{2i}{k}z - \\frac{1}{a(0)}=\\frac{2i}{k}z - w_0^{2},\n$$\nso\n$$\na(z)=\\frac{1}{w_0^{2}-\\frac{2i}{k}z}.\n$$\nWrite $a(z)$ in terms of its real part to identify the physical waist $w(z)$. By definition of the Gaussian envelope, the amplitude profile is $|P(r,z)|\\propto \\exp(-\\operatorname{Re}[a(z)]r^{2})$, so the waist satisfies\n$$\n\\operatorname{Re}[a(z)]=\\frac{1}{w(z)^{2}}.\n$$\nUsing $a(z)=(w_0^{2}-i\\alpha)^{-1}$ with $\\alpha=(2z)/k$, we have\n$$\na(z)=\\frac{w_0^{2}+i\\alpha}{w_0^{4}+\\alpha^{2}},\n\\qquad\n\\operatorname{Re}[a(z)]=\\frac{w_0^{2}}{w_0^{4}+\\alpha^{2}}.\n$$\nTherefore\n$$\n\\frac{1}{w(z)^{2}}=\\frac{w_0^{2}}{w_0^{4}+\\alpha^{2}}\n\\quad\\Longrightarrow\\quad\nw(z)^{2}=\\frac{w_0^{4}+\\alpha^{2}}{w_0^{2}}\n=\nw_0^{2}+\\frac{\\alpha^{2}}{w_0^{2}}\n=\nw_0^{2}\\left(1+\\left(\\frac{2 z}{k w_0^{2}}\\right)^{2}\\right).\n$$\nTaking the positive square root yields the axial evolution of the beam waist:\n$$\nw(z)=w_0 \\sqrt{1+\\left(\\frac{2 z}{k w_0^{2}}\\right)^{2}}.\n$$\nThis is the classical linear diffraction law for a Gaussian beam in the paraxial regime, with an acoustic Rayleigh length $z_R=k w_0^{2}/2$ implicitly defined by the denominator inside the square root.\n\nAll steps above follow directly from the KZK model under the weak-signal limit $p \\ll p_0$ (neglecting the nonlinear term) and negligible absorption (dropping the thermoviscous term), together with monochromatic excitation and the paraxial approximation.",
            "answer": "$$\\boxed{w_0\\sqrt{1+\\left(\\frac{2 z}{k w_0^{2}}\\right)^{2}}}$$"
        },
        {
            "introduction": "Having explored diffraction, we now turn to the two competing effects that define nonlinear acoustics: wave steepening due to nonlinearity and signal decay due to absorption. This practice focuses on the plane-wave limit to isolate this interplay, tasking you with calculating the characteristic lengths for shock formation ($L_N$) and attenuation ($L_A$). By determining the Gol'dberg number, a key dimensionless ratio, you will gain quantitative intuition for when an acoustic wave is more likely to form a shock versus when it will simply fade away .",
            "id": "4143383",
            "problem": "A monochromatic, axisymmetric ultrasound beam in a thermoviscous fluid is modeled by the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation. In the plane-wave limit (negligible diffraction), the evolution along the beam axis reduces to the combined effects of nonlinearity and absorption. Starting from the one-dimensional conservation of mass and momentum for a compressible Newtonian fluid and a second-order equation of state (so that the effective quadratic nonlinearity is characterized by the coefficient $\\beta$), and using the standard linear thermoviscous result that the amplitude attenuation coefficient follows a quadratic frequency law $\\alpha(\\omega)=\\alpha_0 \\omega^2$, carry out the following:\n\n- Derive the shock formation distance $L_N$ for a sinusoidal plane wave of angular frequency $\\omega_0$ and pressure amplitude $p_0$ in terms of $\\rho_0$, $c_0$, $\\beta$, $\\omega_0$, and $p_0$.\n- Using the linear attenuation law, write the absorption length $L_A$ and the attenuation per wavelength $\\mathcal{A}_\\lambda$ in terms of $\\alpha(\\omega_0)$ and the wavelength $\\lambda_0$.\n- Define the dimensionless ratio $R \\equiv L_A/L_N$ as a quantitative measure of the relative importance of absorption versus nonlinearity. If $R \\gg 1$, nonlinear distortion outpaces absorption; if $R \\ll 1$, absorption dominates before appreciable nonlinear distortion occurs.\n\nGiven the following medium and source parameters, compute $\\mathcal{A}_\\lambda$ and then evaluate $R$:\n- Equilibrium density $\\rho_0 = 1000\\,\\mathrm{kg/m^3}$,\n- Small-signal sound speed $c_0 = 1500\\,\\mathrm{m/s}$,\n- Quadratic nonlinearity coefficient $\\beta = 3.5$,\n- Pressure amplitude $p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$,\n- Carrier frequency $f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$ (so $\\omega_0 = 2\\pi f_0$),\n- Thermoviscous absorption parameter $\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$.\n\nUse $\\lambda_0 = c_0/f_0$, report $\\mathcal{A}_\\lambda = \\alpha(\\omega_0)\\lambda_0$ as a dimensionless attenuation per wavelength (in nepers per wavelength), and then compute $R$. Round your final reported value of $R$ to three significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The solution proceeds in three stages: deriving the characteristic lengths for nonlinearity and absorption, formulating their ratio, and then numerically evaluating the requested quantities.\n\n**1. Derivation of Characteristic Lengths**\n\n**Shock Formation Distance, $L_N$**\nIn a lossless fluid, the propagation speed $c$ of a point on the wave profile is given by $c = c_0 + \\beta u$, where $u$ is the particle velocity. For a plane progressive wave, $p = \\rho_0 c_0 u$. This velocity difference between high and low-pressure parts of the wave causes the profile to steepen. A shock forms when the waveform slope becomes infinite. The distance at which this first occurs, the shock formation distance $L_N$, for an initially sinusoidal plane wave with particle velocity amplitude $u_0 = p_0/(\\rho_0 c_0)$ is:\n$$L_N = \\frac{c_0^2}{\\beta u_0 \\omega_0} = \\frac{c_0^2}{\\beta \\left(\\frac{p_0}{\\rho_0 c_0}\\right) \\omega_0} = \\frac{\\rho_0 c_0^3}{\\beta p_0 \\omega_0}$$\n\n**Absorption Length, $L_A$, and Attenuation per Wavelength, $\\mathcal{A}_\\lambda$**\nGiven the amplitude attenuation coefficient $\\alpha(\\omega) = \\alpha_0 \\omega^2$, for a wave with frequency $\\omega_0$, the coefficient is $\\alpha(\\omega_0) = \\alpha_0 \\omega_0^2$. The absorption length, $L_A$, is the distance over which the amplitude decays by a factor of $1/e$, so $\\alpha(\\omega_0) L_A = 1$. This gives:\n$$L_A = \\frac{1}{\\alpha(\\omega_0)} = \\frac{1}{\\alpha_0 \\omega_0^2}$$\nThe attenuation per wavelength, $\\mathcal{A}_\\lambda$, is a dimensionless measure defined as the product of the attenuation coefficient and the wavelength, $\\lambda_0$. The wavelength is given by $\\lambda_0 = c_0/f_0 = 2\\pi c_0 / \\omega_0$.\n$$\\mathcal{A}_\\lambda \\equiv \\alpha(\\omega_0) \\lambda_0 = (\\alpha_0 \\omega_0^2) \\left(\\frac{2\\pi c_0}{\\omega_0}\\right) = 2\\pi \\alpha_0 c_0 \\omega_0$$\n\n**2. Dimensionless Ratio, $R$**\n\nThe ratio $R = L_A/L_N$, often called the Gol'dberg number, quantifies the relative importance of absorption versus nonlinearity. Using the expressions derived above:\n$$R = \\frac{L_A}{L_N} = \\frac{1/(\\alpha_0 \\omega_0^2)}{(\\rho_0 c_0^3)/(\\beta p_0 \\omega_0)} = \\frac{\\beta p_0 \\omega_0}{\\alpha_0 \\omega_0^2 \\rho_0 c_0^3}$$\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\n\n**3. Numerical Evaluation**\n\nThe given parameters are:\n- $\\rho_0 = 1000\\,\\mathrm{kg/m^3}$\n- $c_0 = 1500\\,\\mathrm{m/s}$\n- $\\beta = 3.5$\n- $p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$\n- $f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$\n- $\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$\n\nFirst, we calculate the angular frequency:\n$$\\omega_0 = 2\\pi f_0 = 2\\pi (1.5 \\times 10^{6}\\,\\mathrm{Hz}) = 3\\pi \\times 10^6\\,\\mathrm{rad/s}$$\n\nNow, we compute the attenuation per wavelength, $\\mathcal{A}_\\lambda$:\n$$\\mathcal{A}_\\lambda = 2\\pi \\alpha_0 c_0 \\omega_0 = 2\\pi (6.0 \\times 10^{-18}\\,\\mathrm{s^2/m})(1500\\,\\mathrm{m/s})(3\\pi \\times 10^6\\,\\mathrm{s^{-1}})$$\n$$\\mathcal{A}_\\lambda = 54\\pi^2 \\times 10^{-9} \\approx 5.3296 \\times 10^{-7}\\,\\text{(Nepers per wavelength)}$$\n\nNext, we evaluate the dimensionless ratio $R$:\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\nSubstituting the numerical values:\n$$R = \\frac{(3.5)(3.0 \\times 10^5)}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(1000)(1500)^3}$$\n$$R = \\frac{1.05 \\times 10^6}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(10^3)(3.375 \\times 10^9)} = \\frac{1.05 \\times 10^6}{60.75\\pi \\times 10^0}$$\n$$R = \\frac{1050000}{60.75\\pi} \\approx 5501.033$$\nRounding to three significant figures, we get:\n$$R \\approx 5.50 \\times 10^3$$\nThe large value of $R$ indicates that for the given parameters, nonlinear effects are strongly dominant over dissipative effects, and a shock wave would form long before the wave is significantly attenuated.",
            "answer": "$$\n\\boxed{5.50 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "Moving from physical analysis to computational practice, a common goal is to implement a numerical solver for the full KZK equation. A critical part of this process is code verification, and this exercise introduces a cornerstone technique for that purpose: the Method of Manufactured Solutions (MMS). You will derive a source term that forces a chosen analytical function to be an exact solution to the equation, providing a powerful and precise tool for debugging and validating your numerical implementation .",
            "id": "4143414",
            "problem": "Consider the Khokhlov-Zabolotskaya-Kuznetsov (KZK) equation, which models paraxial propagation of finite-amplitude sound beams in thermoviscous fluids. The KZK model arises from conservation of mass and momentum in a compressible fluid together with a constitutive relation linking pressure and density, then applying a paraxial approximation and transforming to the retarded time coordinate. In retarded time $\\tau$, axial coordinate $z$, and transverse coordinates $\\mathbf{r}_{\\perp} = (x,y)$, one widely used computational form involves a forward-marching operator in $z$ that balances diffraction, absorption, and quadratic nonlinearity. For the purpose of code verification by the method of manufactured solutions, define the residual operator\n$$\n\\mathcal{K}[p] \\equiv \\frac{\\partial p}{\\partial z} - D \\nabla_{\\perp}^{2}\\left(\\int_{-\\infty}^{\\tau} p\\left(z,\\mathbf{r}_{\\perp},\\tau'\\right)d\\tau'\\right) - A\\frac{\\partial^{2} p}{\\partial \\tau^{2}} - N\\frac{\\partial}{\\partial \\tau}(p^{2}),\n$$\nwhere $D>0$ represents the strength of diffraction in the paraxial regime, $A>0$ represents thermoviscous absorption, and $N>0$ represents the coefficient of quadratic nonlinearity. The transverse Laplacian is $\\nabla_{\\perp}^{2} \\equiv \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}$.\n\nChoose the manufactured pressure field\n$$\np(z,\\mathbf{r}_{\\perp},\\tau) = p_{0}\\exp(-\\mu z)\\exp(-\\gamma\\left| \\mathbf{r}_{\\perp} \\right|^{2})\\exp(\\kappa \\tau)\\sin(\\omega \\tau),\n$$\nwith constants $p_{0}>0$, $\\mu>0$, $\\gamma>0$, $\\kappa>0$, and $\\omega>0$, and where $\\left| \\mathbf{r}_{\\perp} \\right|^{2} = x^{2}+y^{2}$. The exponential factor in $\\tau$ ensures convergence of the time integral as the lower limit tends to $-\\infty$, consistent with the physical definition of retarded time.\n\nDerive, from first principles starting with the stated operator $\\mathcal{K}[p]$ and the definitions of the transverse Laplacian and retarded-time integral, the explicit source term $s(z,\\mathbf{r}_{\\perp},\\tau)$ such that\n$$\n\\mathcal{K}[p] = s(z,\\mathbf{r}_{\\perp},\\tau).\n$$\nExpress the final source $s(z,\\mathbf{r}_{\\perp},\\tau)$ as a single, closed-form analytic expression in terms of $p_{0}$, $\\mu$, $\\gamma$, $\\kappa$, $\\omega$, $D$, $A$, $N$, $z$, $x$, $y$, and $\\tau$. No numerical approximation or rounding is required, and no units need be reported. Your answer must be a single analytic expression.",
            "solution": "The source term $s(z, \\mathbf{r}_{\\perp}, \\tau)$ is obtained by evaluating each term of the operator $\\mathcal{K}[p]$ for the given manufactured pressure field $p$. For convenience, let $p(z, \\mathbf{r}_{\\perp}, \\tau) = p_{0}\\exp(-\\mu z)\\exp(-\\gamma|\\mathbf{r}_{\\perp}|^2)\\exp(\\kappa \\tau)\\sin(\\omega \\tau)$.\n\n1.  **Axial derivative term: $\\frac{\\partial p}{\\partial z}$**\n    The derivative with respect to $z$ only acts on the $\\exp(-\\mu z)$ factor:\n    $$\n    \\frac{\\partial p}{\\partial z} = -\\mu \\left[ p_{0}\\exp(-\\mu z)\\exp(-\\gamma|\\mathbf{r}_{\\perp}|^2)\\exp(\\kappa \\tau)\\sin(\\omega \\tau) \\right] = -\\mu p\n    $$\n\n2.  **Diffraction term: $-D \\nabla_{\\perp}^{2}\\left(\\int_{-\\infty}^{\\tau} p d\\tau'\\right)$**\n    First, we evaluate the integral $I_p = \\int_{-\\infty}^{\\tau} p(z, \\mathbf{r}_{\\perp}, \\tau') d\\tau'$. The integration with respect to $\\tau'$ acts on $\\exp(\\kappa \\tau')\\sin(\\omega \\tau')$. Using the standard integral $\\int e^{au}\\sin(bu)du = \\frac{e^{au}}{a^2+b^2}(a\\sin(bu) - b\\cos(bu))$ and the fact that the integral vanishes at $\\tau' \\to -\\infty$ (since $\\kappa>0$), we get:\n    $$\n    \\int_{-\\infty}^{\\tau} \\exp(\\kappa \\tau')\\sin(\\omega \\tau') d\\tau' = \\frac{\\exp(\\kappa\\tau)}{\\kappa^2+\\omega^2} (\\kappa\\sin(\\omega\\tau) - \\omega\\cos(\\omega\\tau))\n    $$\n    Next, we apply the transverse Laplacian $\\nabla_{\\perp}^{2}$, which acts on the spatial part $\\exp(-\\gamma|\\mathbf{r}_{\\perp}|^2)$:\n    $$\n    \\nabla_{\\perp}^{2} \\exp(-\\gamma|\\mathbf{r}_{\\perp}|^2) = \\left[4\\gamma^2|\\mathbf{r}_{\\perp}|^2 - 4\\gamma\\right]\\exp(-\\gamma|\\mathbf{r}_{\\perp}|^2)\n    $$\n    Combining these results, the full diffraction term is:\n    $$\n    -D \\nabla_{\\perp}^{2}I_p = -D p_{0}e^{-\\mu z}e^{-\\gamma|\\mathbf{r}_{\\perp}|^2}e^{\\kappa\\tau} \\left[4\\gamma(\\gamma|\\mathbf{r}_{\\perp}|^2-1)\\right] \\frac{\\kappa\\sin(\\omega\\tau) - \\omega\\cos(\\omega\\tau)}{\\kappa^2+\\omega^2}\n    $$\n\n3.  **Absorption term: $-A\\frac{\\partial^{2} p}{\\partial \\tau^{2}}$**\n    We differentiate the temporal part $\\exp(\\kappa\\tau)\\sin(\\omega\\tau)$ twice with respect to $\\tau$:\n    $$\n    \\frac{\\partial^2}{\\partial \\tau^2} (\\exp(\\kappa\\tau)\\sin(\\omega\\tau)) = \\exp(\\kappa\\tau) [(\\kappa^2-\\omega^2)\\sin(\\omega\\tau) + 2\\kappa\\omega\\cos(\\omega\\tau)]\n    $$\n    The absorption term is therefore:\n    $$\n    -A\\frac{\\partial^{2} p}{\\partial \\tau^{2}} = -A p_{0}e^{-\\mu z}e^{-\\gamma|\\mathbf{r}_{\\perp}|^2}e^{\\kappa\\tau} [(\\kappa^2-\\omega^2)\\sin(\\omega\\tau) + 2\\kappa\\omega\\cos(\\omega\\tau)]\n    $$\n\n4.  **Nonlinearity term: $-N\\frac{\\partial}{\\partial \\tau}(p^{2})$**\n    First, square the pressure field: $p^2 = p_{0}^{2}e^{-2\\mu z}e^{-2\\gamma|\\mathbf{r}_{\\perp}|^2}e^{2\\kappa \\tau}\\sin^2(\\omega \\tau)$. Then differentiate with respect to $\\tau$:\n    $$\n    \\frac{\\partial}{\\partial\\tau}(e^{2\\kappa \\tau}\\sin^2(\\omega \\tau)) = 2e^{2\\kappa\\tau}\\sin(\\omega\\tau)[\\kappa\\sin(\\omega\\tau) + \\omega\\cos(\\omega\\tau)]\n    $$\n    The full nonlinearity term is:\n    $$\n    -N\\frac{\\partial p^2}{\\partial \\tau} = -2N p_{0}^{2}e^{-2\\mu z}e^{-2\\gamma|\\mathbf{r}_{\\perp}|^2} e^{2\\kappa\\tau} [\\kappa\\sin^2(\\omega\\tau) + \\omega\\sin(\\omega\\tau)\\cos(\\omega\\tau)]\n    $$\n\n**Assembly of the Final Expression**\nThe source term $s(z, x, y, \\tau) = \\mathcal{K}[p]$ is the sum of the four derived terms. Let $|\\mathbf{r}_{\\perp}|^2 = x^2+y^2$. Combining all terms gives the final expression for the source:\n$$\ns(z,x,y,\\tau) = p_{0}\\exp(-\\mu z)\\exp(-\\gamma(x^2+y^2))\\exp(\\kappa\\tau) \\left[ \\left(-\\mu - A(\\kappa^2-\\omega^2) - \\frac{4D\\gamma\\kappa(\\gamma(x^2+y^2)-1)}{\\kappa^2+\\omega^2}\\right)\\sin(\\omega\\tau) + \\left(\\frac{4D\\gamma\\omega(\\gamma(x^2+y^2)-1)}{\\kappa^2+\\omega^2} - 2A\\kappa\\omega\\right)\\cos(\\omega\\tau) \\right] - 2N p_{0}^{2}\\exp(-2\\mu z)\\exp(-2\\gamma(x^2+y^2))\\exp(2\\kappa\\tau) \\left(\\kappa\\sin^2(\\omega\\tau) + \\omega\\sin(\\omega\\tau)\\cos(\\omega\\tau)\\right)\n$$",
            "answer": "$$\n\\boxed{p_{0}\\exp(-\\mu z)\\exp(-\\gamma(x^2+y^2))\\exp(\\kappa\\tau) \\left[ \\left(-\\mu - A(\\kappa^2-\\omega^2) - \\frac{4D\\gamma\\kappa(\\gamma(x^2+y^2)-1)}{\\kappa^2+\\omega^2}\\right)\\sin(\\omega\\tau) + \\left(\\frac{4D\\gamma\\omega(\\gamma(x^2+y^2)-1)}{\\kappa^2+\\omega^2} - 2A\\kappa\\omega\\right)\\cos(\\omega\\tau) \\right] - 2N p_{0}^{2}\\exp(-2\\mu z)\\exp(-2\\gamma(x^2+y^2))\\exp(2\\kappa\\tau) \\left(\\kappa\\sin^2(\\omega\\tau) + \\omega\\sin(\\omega\\tau)\\cos(\\omega\\tau)\\right)}\n$$"
        }
    ]
}