{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on complex simulations, a scientist's or engineer's first step is often to perform a scaling analysis to understand the dominant phenomena at play. This practice involves deriving key nondimensional parameters from the governing equations to quantify the competition between nonlinear wave steepening and viscous dissipation . By calculating values like the Gol'dberg number, you will gain the crucial ability to predict whether a shock is likely to form and how it will evolve, setting the stage for a well-informed numerical study.",
            "id": "4147004",
            "problem": "Consider a one-dimensional progressive plane acoustic wave of angular frequency $\\omega$ and peak pressure amplitude $p_{a}$ propagating through a viscous, thermally nearly isentropic liquid of ambient density $\\rho_{0}$ and small-signal sound speed $c_{0}$. The liquid has shear viscosity $\\mu$ and bulk viscosity $\\zeta$. The material nonlinearity is characterized by the standard coefficient $\\beta$ (defined from the second-order isentropic expansion of the equation of state). Assume thermal effects are negligible compared to viscous effects for this liquid over the frequency range considered.\n\nStarting from the conservation of mass and momentum for a compressible viscous fluid, together with an isentropic second-order equation of state, derive the canonical one-dimensional evolution equation in retarded time for weakly nonlinear, weakly attenuating plane waves. Identify the natural nondimensional groups that multiply the nonlinear steepening term and the dissipative term that represent viscous attenuation. Express these groups in terms of the dimensional parameters $\\{\\rho_{0}, c_{0}, \\beta, \\mu, \\zeta, p_{a}, \\omega\\}$ and the wavenumber $k=\\omega/c_{0}$. From the inviscid limit of this evolution equation, obtain the shock formation distance $x_{s}$ for a sinusoidal wave, and define the Gol'dberg number $\\Gamma$ as the ratio of the shock formation distance to the linear absorption length.\n\nUsing the following scientifically realistic parameter values for a room-temperature liquid:\n- $\\rho_{0}=1000\\,\\mathrm{kg/m^{3}}$,\n- $c_{0}=1500\\,\\mathrm{m/s}$,\n- $\\beta=3.5$,\n- $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$,\n- $\\zeta=2.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$,\n- $p_{a}=1.5\\times 10^{6}\\,\\mathrm{Pa}$,\n- $f=2.0\\,\\mathrm{MHz}$ (so $\\omega=2\\pi f$),\n\ncompute the following four nondimensional groups:\n1. The acoustic Mach number $M$ based on the peak amplitude.\n2. The nonlinear coupling strength $\\epsilon$.\n3. The dimensionless dissipation parameter $\\delta$ appearing in the retarded-time Burgers-type evolution for a plane wave in a viscous liquid.\n4. The Gol'dberg number $\\Gamma$.\n\nRound your four numerical answers to three significant figures and report them as dimensionless numbers. Then, based on their magnitudes, argue which terms dominate the dynamics leading to shock formation and which can be neglected in a time-domain simulation framework for this scenario. For the purposes of this problem, you must present the four nondimensional values as your final answer. Any qualitative justification should appear only in your solution.",
            "solution": "The derivation begins with the one-dimensional conservation equations for mass and momentum for a compressible viscous fluid, and a second-order isentropic equation of state.\n\nThe conservation of mass is:\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\nThe conservation of momentum, including viscous stresses for a longitudinal plane wave, is:\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} \\right) = -\\frac{\\partial p}{\\partial x} + \\left(\\zeta + \\frac{4}{3}\\mu\\right) \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $\\rho$ is the density, $u$ is the particle velocity, $p$ is the pressure, $\\mu$ is the shear viscosity, and $\\zeta$ is the bulk viscosity.\n\nThe equation of state relates pressure and density. For an isentropic process, we can expand $p(\\rho)$ as a Taylor series around the ambient state $(p_0, \\rho_0)$:\n$$ p - p_0 = A \\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right) + \\frac{B}{2} \\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right)^2 + \\mathcal{O}\\left(\\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right)^3\\right) $$\nThe small-signal sound speed $c_0$ is defined by $c_0^2 = (\\partial p/\\partial \\rho)_S |_{\\rho_0} = A/\\rho_0$. The coefficient of nonlinearity $\\beta$ is defined as $\\beta = 1 + \\frac{B}{2A}$.\n\nUsing perturbation analysis for weakly nonlinear ($p'/\\rho_0 c_0^2 \\ll 1$) and weakly dissipative waves, these equations can be combined to form a single evolution equation. This is a standard procedure in nonlinear acoustics. For a progressive wave traveling in the $+x$ direction, it is convenient to use a retarded time coordinate $\\tau = t - x/c_0$. The resulting evolution equation, often a form of the Burgers' equation or the Westervelt equation for plane waves, is:\n$$ \\frac{\\partial p'}{\\partial x} - \\frac{\\beta}{\\rho_0 c_0^3} p' \\frac{\\partial p'}{\\partial \\tau} = \\frac{b}{2\\rho_0 c_0^3} \\frac{\\partial^2 p'}{\\partial \\tau^2} $$\nwhere $p' = p-p_0$ is the acoustic pressure and $b = \\zeta + \\frac{4}{3}\\mu$ is the effective viscosity coefficient.\n\nThis equation describes the change in the wave profile $p'(\\tau)$ as it propagates along $x$. The second term on the left is the nonlinear steepening term, and the term on the right is the dissipative term due to viscosity.\n\nWe now identify the natural nondimensional groups.\n1.  **Acoustic Mach number $M$**: This is the ratio of the peak particle velocity $u_a$ to the sound speed $c_0$. Using the plane-wave acoustic impedance relation $p_a = \\rho_0 c_0 u_a$, we have:\n    $$ M = \\frac{u_a}{c_0} = \\frac{p_a}{\\rho_0 c_0^2} $$\n    This parameter quantifies the wave amplitude.\n\n2.  **Nonlinear coupling strength $\\epsilon$**: While sometimes used interchangeably with $M$, the problem asks for it separately. A logical definition for the strength of the nonlinear term in the evolution equation is the combination $\\beta M$. This parameter, $\\epsilon = \\beta M$, represents the effective nonlinearity by combining the material property $\\beta$ with the wave amplitude $M$.\n    $$ \\epsilon = \\beta M = \\frac{\\beta p_a}{\\rho_0 c_0^2} $$\n\n3.  **Dimensionless dissipation parameter $\\delta$**: A natural dimensionless parameter for dissipation is the inverse of the acoustic Reynolds number, which compares viscous forces to inertial forces at the characteristic frequency $\\omega$.\n    $$ \\delta = \\frac{b\\omega}{\\rho_0 c_0^2} = \\frac{(\\zeta + \\frac{4}{3}\\mu)\\omega}{\\rho_0 c_0^2} $$\n\n4.  **Gol'dberg number $\\Gamma$**: The problem defines this as the ratio of the shock formation distance $x_s$ to the linear absorption length $L_a$.\n    In the inviscid limit ($b=0$), the evolution equation predicts that an initially sinusoidal wave $p'(x=0,t) = p_a \\sin(\\omega t)$ will steepen and form a discontinuity (a shock) at a distance $x_s$:\n    $$ x_s = \\frac{\\rho_0 c_0^3}{\\beta \\omega p_a} $$\n    The linear absorption length $L_a$ is the distance over which the wave amplitude decays by a factor of $1/e$ due to viscous losses alone. It is the reciprocal of the amplitude attenuation coefficient $\\alpha$. From the linear part of the evolution equation, $\\alpha$ is found to be:\n    $$ \\alpha = \\frac{b\\omega^2}{2\\rho_0 c_0^3} $$\n    Thus, $L_a = 1/\\alpha = \\frac{2\\rho_0 c_0^3}{b\\omega^2}$.\n    The Gol'dberg number $\\Gamma$ is then:\n    $$ \\Gamma = \\frac{x_s}{L_a} = x_s \\alpha = \\left(\\frac{\\rho_0 c_0^3}{\\beta \\omega p_a}\\right) \\left(\\frac{b\\omega^2}{2\\rho_0 c_0^3}\\right) = \\frac{b\\omega}{2\\beta p_a} $$\n    Note the relationship between the defined parameters: $\\Gamma = \\frac{1}{2}\\frac{\\delta}{\\epsilon}$.\n\nNow, we compute the numerical values for these four groups using the provided data:\n- $\\rho_{0}=1000\\,\\mathrm{kg/m^{3}}$\n- $c_{0}=1500\\,\\mathrm{m/s}$\n- $\\beta=3.5$\n- $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $\\zeta=2.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $p_{a}=1.5\\times 10^{6}\\,\\mathrm{Pa}$\n- $f=2.0\\,\\mathrm{MHz} = 2.0 \\times 10^6 \\, \\mathrm{Hz}$\n\nFirst, we compute intermediate quantities:\n- Angular frequency: $\\omega = 2\\pi f = 2\\pi (2.0 \\times 10^6) = 4\\pi \\times 10^6 \\, \\mathrm{rad/s} \\approx 1.2566 \\times 10^7 \\, \\mathrm{rad/s}$.\n- Effective viscosity: $b = \\zeta + \\frac{4}{3}\\mu = (2.5 \\times 10^{-3}) + \\frac{4}{3}(1.0 \\times 10^{-3}) = (\\frac{7.5}{3} + \\frac{4}{3}) \\times 10^{-3} = \\frac{11.5}{3} \\times 10^{-3} \\, \\mathrm{Pa\\cdot s} \\approx 3.833 \\times 10^{-3} \\, \\mathrm{Pa\\cdot s}$.\n- Characteristic impedance squared: $\\rho_0 c_0^2 = 1000 \\, (1500)^2 = 10^3 \\times 2.25 \\times 10^6 = 2.25 \\times 10^9 \\, \\mathrm{Pa}$.\n\n1.  **Acoustic Mach number $M$**:\n    $$ M = \\frac{p_a}{\\rho_0 c_0^2} = \\frac{1.5 \\times 10^6}{2.25 \\times 10^9} = \\frac{1.5}{2.25} \\times 10^{-3} = \\frac{2}{3} \\times 10^{-3} \\approx 6.667 \\times 10^{-4} $$\n    To three significant figures, $M = 6.67 \\times 10^{-4}$.\n\n2.  **Nonlinear coupling strength $\\epsilon$**:\n    $$ \\epsilon = \\frac{\\beta p_a}{\\rho_0 c_0^2} = \\beta M = 3.5 \\times \\left(\\frac{2}{3} \\times 10^{-3}\\right) = \\frac{7}{3} \\times 10^{-3} \\approx 2.333 \\times 10^{-3} $$\n    To three significant figures, $\\epsilon = 2.33 \\times 10^{-3}$.\n\n3.  **Dimensionless dissipation parameter $\\delta$**:\n    $$ \\delta = \\frac{b\\omega}{\\rho_0 c_0^2} = \\frac{(\\frac{11.5}{3} \\times 10^{-3}) \\times (4\\pi \\times 10^6)}{2.25 \\times 10^9} = \\frac{46\\pi \\times 10^3}{3 \\times 2.25 \\times 10^9} \\approx 2.141 \\times 10^{-5} $$\n    To three significant figures, $\\delta = 2.14 \\times 10^{-5}$.\n\n4.  **Gol'dberg number $\\Gamma$**:\n    $$ \\Gamma = \\frac{b\\omega}{2\\beta p_a} = \\frac{(\\frac{11.5}{3} \\times 10^{-3}) \\times (4\\pi \\times 10^6)}{2 \\times 3.5 \\times (1.5 \\times 10^6)} = \\frac{46\\pi \\times 10^3}{3 \\times 10.5 \\times 10^6} \\approx 4.587 \\times 10^{-3} $$\n    To three significant figures, $\\Gamma = 4.59 \\times 10^{-3}$.\n\nBased on these values, the Gol'dberg number is $\\Gamma \\approx 4.59 \\times 10^{-3}$, which is much smaller than $1$. Since $\\Gamma = x_s/L_a$, this implies that the shock formation distance $x_s$ is significantly shorter than the absorption length $L_a$. Consequently, nonlinear wave steepening is the dominant physical effect. The acoustic wave will rapidly distort and form a shock-like front well before viscous forces can significantly attenuate the wave as a whole. In a time-domain simulation, the nonlinear term is critical and will drive the dynamics, while the dissipative term, though smaller in overall effect, is essential for regularizing the shock front and determining its finite thickness.",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n6.67 \\times 10^{-4}  2.33 \\times 10^{-3}  2.14 \\times 10^{-5}  4.59 \\times 10^{-3}\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "The cornerstone of computational physics is the ability to build a solver and rigorously verify its correctness. This exercise guides you through the implementation of a finite-volume solver for the full Euler equations, a workhorse for simulating compressible flows and shock waves . By testing your code against the exact solution of the classic Riemann shock tube problem, you will not only gain practical coding experience but also learn the fundamental process of verification, ensuring your numerical tool accurately captures the underlying physics.",
            "id": "4147041",
            "problem": "You are tasked with implementing a one-dimensional, time-domain, finite-volume solver for the compressible Euler equations to simulate shock formation and propagation in an acoustic shock tube. The solver must be verified against an exact Riemann solution for selected initial states that are representative of acoustic configurations. Your program must produce a single line of output containing the requested accuracy metrics for a fixed test suite. All quantities in the problem must be handled in stated physical units.\n\nBegin from the following fundamental base:\n- Conservation of mass, momentum, and energy for a one-dimensional inviscid compressible fluid:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{bmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p \\\\\nu(E + p)\n\\end{bmatrix}\n=\n\\mathbf{0},\n$$\nwhere $ \\rho $ is mass density in $\\mathrm{kg/m^3}$, $ u $ is velocity in $\\mathrm{m/s}$, $ E $ is total energy density in $\\mathrm{J/m^3}$, and $ p $ is pressure in $\\mathrm{Pa}$.\n- Ideal gas equation of state for air modeled as a perfect gas: $ p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right) $, with $ \\gamma = 1.4 $.\n- Speed of sound definition $ a = \\sqrt{\\gamma p / \\rho} $.\n- Numerical flux based on a monotone scheme consistent with the local Lax-Friedrichs (also called Rusanov) flux.\n\nYour solver must:\n- Discretize a spatial domain of length $ L $ in $\\mathrm{m}$, with $ N $ uniform cells and transmissive (zero-gradient) boundary conditions.\n- Use an explicit time-marching scheme with a Courant-Friedrichs-Lewy (CFL) condition computed from the maximum signal speed $ |u| + a $ over the domain.\n- Initialize a shock tube by setting uniform left and right states separated at the midpoint $ x_0 = L/2 $ at time $ t = 0 $.\n- Evolve to a specified final time $ t_{\\mathrm{end}} $ in $\\mathrm{s}$.\n\nFor verification, compute the exact self-similar Riemann solution of the shock tube problem at time $ t_{\\mathrm{end}} $ for the same initial states and ideal gas. Compare the numerical density field $ \\rho_{\\mathrm{num}}(x) $ with the exact density $ \\rho_{\\mathrm{exact}}(x) $ by the domain-integrated $ L^1 $ error:\n$$\n\\varepsilon_{L^1} = \\int_0^L \\left| \\rho_{\\mathrm{num}}(x) - \\rho_{\\mathrm{exact}}(x) \\right| \\, dx,\n$$\nwhich in the discrete uniform mesh reduces to a Riemann sum $ \\varepsilon_{L^1} \\approx \\sum_{i=1}^{N} \\left| \\rho_{\\mathrm{num},i} - \\rho_{\\mathrm{exact},i} \\right| \\Delta x $ with $ \\Delta x = L / N $. Express $ \\varepsilon_{L^1} $ in $\\mathrm{kg/m^2}$ as it is the integral of density difference over length.\n\nImplement your program to run the following test suite, which covers a typical acoustic shock tube, a small-amplitude acoustic jump, and a boundary-condition sanity case:\n- Test case $ 1 $ (acoustic shock tube, Sod-like):\n  - $ \\gamma = 1.4 $,\n  - $ L = 1.0 \\, \\mathrm{m} $,\n  - $ N = 400 $,\n  - $ t_{\\mathrm{end}} = 0.001 \\, \\mathrm{s} $,\n  - Left state $ (\\rho_L, u_L, p_L) = (1.0 \\, \\mathrm{kg/m^3}, 0.0 \\, \\mathrm{m/s}, 1.0 \\times 10^5 \\, \\mathrm{Pa}) $,\n  - Right state $ (\\rho_R, u_R, p_R) = (0.125 \\, \\mathrm{kg/m^3}, 0.0 \\, \\mathrm{m/s}, 1.0 \\times 10^4 \\, \\mathrm{Pa}) $.\n- Test case $ 2 $ (small-amplitude acoustic jump):\n  - $ \\gamma = 1.4 $,\n  - $ L = 1.0 \\, \\mathrm{m} $,\n  - $ N = 400 $,\n  - $ t_{\\mathrm{end}} = 0.001 \\, \\mathrm{s} $,\n  - Left state $ (\\rho_L, u_L, p_L) = (1.05 \\, \\mathrm{kg/m^3}, 0.0 \\, \\mathrm{m/s}, 1.05 \\times 10^5 \\, \\mathrm{Pa}) $,\n  - Right state $ (\\rho_R, u_R, p_R) = (1.0 \\, \\mathrm{kg/m^3}, 0.0 \\, \\mathrm{m/s}, 1.0 \\times 10^5 \\, \\mathrm{Pa}) $.\n- Test case $ 3 $ (uniform state, boundary-condition sanity):\n  - $ \\gamma = 1.4 $,\n  - $ L = 1.0 \\, \\mathrm{m} $,\n  - $ N = 200 $,\n  - $ t_{\\mathrm{end}} = 0.001 \\, \\mathrm{s} $,\n  - Left state $ (\\rho_L, u_L, p_L) = (1.0 \\, \\mathrm{kg/m^3}, 0.0 \\, \\mathrm{m/s}, 1.0 \\times 10^5 \\, \\mathrm{Pa}) $,\n  - Right state identical to left.\n\nYour program should produce a single line of output containing the $ L^1 $ density errors for the three test cases, as a comma-separated Python list enclosed in square brackets. For example, output of the form $ [e_1,e_2,e_3] $ where each $ e_k $ is a floating-point number in $\\mathrm{kg/m^2}$, with no additional text. The output must be in the exact specified format, and values must be computed by your simulation and exact-solution verification.\n\nYou must not rely on any external input and must ensure all computations use the physical units specified. Angles do not appear in this problem. Percentages do not appear in this problem.\n\nNote: This problem expects careful use of conservation laws and ideal gas relations to derive both the numerical scheme and the exact solution. The numerical flux and time stepping must be stable and shock-capturing. Computational Fluid Dynamics (CFD) is the discipline concerned with solving such conservation laws numerically, and the Courant-Friedrichs-Lewy (CFL) condition controls explicit time-step stability.",
            "solution": "### 1. Governing Equations\n\nThe one-dimensional, inviscid, compressible Euler equations express the conservation of mass, momentum, and total energy. In conservative form, they are given by:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = \\mathbf{0} $$\nwhere $\\mathbf{U}$ is the vector of conserved state variables and $\\mathbf{F}(\\mathbf{U})$ is the vector of corresponding fluxes:\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{bmatrix}\n$$\nHere, $\\rho$ is the fluid density, $u$ is the velocity, $E$ is the total energy per unit volume, and $p$ is the pressure. The system is closed by an equation of state. For a perfect gas, this is:\n$$ p = (\\gamma - 1) \\left( E - \\frac{1}{2}\\rho u^2 \\right) $$\nwhere $\\gamma$ is the ratio of specific heats, given as $\\gamma=1.4$ for air. The speed of sound, $a$, is defined as $a = \\sqrt{\\gamma p / \\rho}$.\n\n### 2. Numerical Method: Finite-Volume Scheme\n\nWe discretize the spatial domain of length $L$ into $N$ uniform cells of width $\\Delta x = L/N$. The cell centers are located at $x_i = (i-1/2)\\Delta x$ for $i=1, \\dots, N$. Let $\\mathbf{U}_i(t)$ be the cell-averaged value of the conserved variables in cell $i$ at time $t$.\n\nIntegrating the conservation law over cell $i$ (from $x_{i-1/2}$ to $x_{i+1/2}$) and applying the divergence theorem yields the semi-discrete finite-volume formulation:\n$$ \\frac{d\\mathbf{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left( \\mathbf{F}^*_{i+1/2} - \\mathbf{F}^*_{i-1/2} \\right) $$\nwhere $\\mathbf{F}^*_{i+1/2}$ is the numerical flux at the interface between cell $i$ and cell $i+1$.\n\nFor time integration, we use an explicit first-order Euler method:\n$$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x} \\left( \\mathbf{F}^*_{i+1/2} - \\mathbf{F}^*_{i-1/2} \\right) $$\nwhere the superscript $n$ denotes the time level $t^n$.\n\n### 3. Numerical Flux: Local Lax-Friedrichs (Rusanov)\n\nThe problem specifies a monotone scheme consistent with the local Lax-Friedrichs, or Rusanov, flux. This flux is defined at the interface between a left state $\\mathbf{U}_L$ and a right state $\\mathbf{U}_R$ as:\n$$ \\mathbf{F}^*(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{1}{2} \\left[ \\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R) - S_{\\max} (\\mathbf{U}_R - \\mathbf{U}_L) \\right] $$\nThe term $S_{\\max}$ represents the maximum local signal speed (wave speed) at the interface and provides the necessary numerical dissipation for stability. It is calculated as:\n$$ S_{\\max} = \\max(|u_L| + a_L, |u_R| + a_R) $$\nFor the flux $\\mathbf{F}^*_{i+1/2}$, the left and right states are the cell-averaged values $\\mathbf{U}_i^n$ and $\\mathbf{U}_{i+1}^n$, respectively.\n\n### 4. Time Step and Boundary Conditions\n\nThe stability of this explicit scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. The time step $\\Delta t$ must satisfy:\n$$ \\Delta t \\le \\text{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + a_i)} $$\nwhere the maximum is taken over the entire computational domain. We will use a CFL number of $0.5$ for robustness.\n\nTransmissive (zero-gradient) boundary conditions are implemented using ghost cells. A ghost cell is added at each end of the domain. The state in the left ghost cell ($i=0$) is set equal to the state in the first interior cell ($i=1$), and the state in the right ghost cell ($i=N+1$) is set equal to the state in the last interior cell ($i=N$).\n\n### 5. Verification: Exact Riemann Solution\n\nThe initial condition specifies a Riemann problem: two constant states separated by a diaphragm at $x_0 = L/2$. The solution to this problem is self-similar and depends only on the variable $\\xi = (x - x_0) / t$. The solution structure consists of three waves (a left-going wave, a contact discontinuity, and a right-going wave) separating four constant-state regions. The waves can be either shocks or rarefaction fans.\n\nThe core of the exact solution is finding the pressure $p_*$ and velocity $u_*$ in the region between the left and right waves (the \"star\" region). This is achieved by solving the nonlinear algebraic equation:\n$$ f_L(p_*, \\mathbf{W}_L) + f_R(p_*, \\mathbf{W}_R) + (u_R - u_L) = 0 $$\nwhere $\\mathbf{W}_K = (\\rho_K, u_K, p_K)$ for $K \\in \\{L, R\\}$. The function $f_K$ depends on whether the wave is a shock ($p_* > p_K$) or a rarefaction ($p_* \\le p_K$):\n- Shock: $ f_K(p_*) = (p_* - p_K) \\sqrt{\\frac{2 / ((\\gamma+1)\\rho_K)}{p_* + (\\gamma-1)/(\\gamma+1) p_K}} $\n- Rarefaction: $ f_K(p_*) = \\frac{2a_K}{\\gamma-1} \\left[ \\left(\\frac{p_*}{p_K}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right] $\n\nThis equation is solved for $p_*$ using a numerical root-finding algorithm (e.g., Brent's method). Once $p_*$ is known, $u_*$ and the densities in the star region, $\\rho_{*L}$ and $\\rho_{*R}$, are determined. The structure of the wave pattern (wave speeds and regions) is then fully defined. To obtain the exact density profile $\\rho_{\\mathrm{exact}}(x_i)$ at the final time $t_{\\mathrm{end}}$, we evaluate the solution for each cell center coordinate $x_i$ by calculating $\\xi_i = (x_i - L/2) / t_{\\mathrm{end}}$ and identifying which region $\\xi_i$ falls into.\n\nThe $L^1$ error between the numerical density $\\rho_{\\mathrm{num}, i}$ and the exact density $\\rho_{\\mathrm{exact}}(x_i)$ is then computed as the discrete sum:\n$$ \\varepsilon_{L^1} = \\sum_{i=1}^{N} \\left| \\rho_{\\mathrm{num},i} - \\rho_{\\mathrm{exact},i} \\right| \\Delta x $$\n\n### 6. Implementation for Test Suite\n\nThe above methodology is implemented in a Python program. This program will sequentially execute the three test cases provided. For each case, it initializes the state, runs the time-stepping loop until $t_{\\mathrm{end}}$, computes the exact Riemann solution for verification, calculates the $L^1$ error in density, and appends the result to a list. Finally, it prints the list of errors in the specified format. The third test case, with a uniform initial state, is a crucial sanity check; the exact solution is trivial (no change), so any significant error would point to flaws in the numerical scheme or boundary conditions. For a well-behaved scheme, this error should be close to machine precision.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"gamma\": 1.4, \"L\": 1.0, \"N\": 400, \"t_end\": 0.001,\n            \"left_state\": (1.0, 0.0, 1.0e5),\n            \"right_state\": (0.125, 0.0, 1.0e4)\n        },\n        {\n            \"gamma\": 1.4, \"L\": 1.0, \"N\": 400, \"t_end\": 0.001,\n            \"left_state\": (1.05, 0.0, 1.05e5),\n            \"right_state\": (1.0, 0.0, 1.0e5)\n        },\n        {\n            \"gamma\": 1.4, \"L\": 1.0, \"N\": 200, \"t_end\": 0.001,\n            \"left_state\": (1.0, 0.0, 1.0e5),\n            \"right_state\": (1.0, 0.0, 1.0e5)\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        error = run_simulation_case(**params)\n        results.append(error)\n\n    print(f\"[{','.join(f'{r:.6g}' for r in results)}]\")\n\ndef run_simulation_case(gamma, L, N, t_end, left_state, right_state):\n    \"\"\"\n    Runs a single shock tube simulation case and returns the L1 error.\n    \"\"\"\n    CFL = 0.5\n    dx = L / N\n    x_centers = np.linspace(dx / 2, L - dx / 2, N)\n    x0 = L / 2\n\n    # Helper functions for state conversion\n    def primitive_to_conserved(rho, u, p, g):\n        E = p / (g - 1) + 0.5 * rho * u**2\n        return np.array([rho, rho * u, E])\n\n    def conserved_to_primitive(U, g):\n        rho = U[0, :]\n        u = U[1, :] / rho\n        E = U[2, :]\n        p = (g - 1) * (E - 0.5 * rho * u**2)\n        return rho, u, p\n    \n    def get_flux(U, g):\n        rho, u, p = conserved_to_primitive(U.reshape(3, 1), g)\n        E = U[2]\n        F = np.zeros(3)\n        F[0] = rho * u\n        F[1] = rho * u**2 + p\n        F[2] = u * (E + p)\n        return F\n\n    # --- Initialization ---\n    rho_L, u_L, p_L = left_state\n    rho_R, u_R, p_R = right_state\n    U_L = primitive_to_conserved(rho_L, u_L, p_L, gamma)\n    U_R = primitive_to_conserved(rho_R, u_R, p_R, gamma)\n\n    # N+2 cells to accommodate two ghost cells\n    U = np.zeros((3, N + 2))\n    initial_split = np.where(x_centers  x0, 1, 0)\n    \n    U[0, 1:N+1] = initial_split * rho_L + (1 - initial_split) * rho_R\n    U[1, 1:N+1] = initial_split * (rho_L * u_L) + (1 - initial_split) * (rho_R * u_R)\n    U[2, 1:N+1] = initial_split * (p_L / (gamma-1) + 0.5 * rho_L * u_L**2) + \\\n                  (1 - initial_split) * (p_R / (gamma-1) + 0.5 * rho_R * u_R**2)\n\n    # --- Time Marching Loop ---\n    t = 0.0\n    while t  t_end:\n        # Boundary conditions (zero-gradient)\n        U[:, 0] = U[:, 1]\n        U[:, N+1] = U[:, N]\n\n        # Decode primitive variables\n        rho, u, p = conserved_to_primitive(U, gamma)\n        # Ensure positivity of pressure and density\n        rho = np.maximum(rho, 1e-9)\n        p = np.maximum(p, 1e-9)\n        a = np.sqrt(gamma * p / rho)\n\n        # CFL condition for time step\n        max_signal_speed = np.max(np.abs(u) + a)\n        dt = CFL * dx / max_signal_speed\n        if t + dt > t_end:\n            dt = t_end - t\n\n        # Compute numerical fluxes (Rusanov)\n        F_num = np.zeros((3, N + 1))\n        for i in range(N + 1):\n            U_l, U_r = U[:, i], U[:, i+1]\n            rho_l, u_l, p_l = conserved_to_primitive(U_l.reshape(3, 1), gamma)\n            rho_r, u_r, p_r = conserved_to_primitive(U_r.reshape(3, 1), gamma)\n\n            a_l = np.sqrt(gamma * p_l / rho_l)\n            a_r = np.sqrt(gamma * p_r / rho_r)\n            \n            s_max_local = np.max([np.abs(u_l) + a_l, np.abs(u_r) + a_r])\n            \n            F_l = get_flux(U_l, gamma)\n            F_r = get_flux(U_r, gamma)\n            \n            F_num[:, i] = 0.5 * (F_l + F_r - s_max_local * (U_r - U_l))\n            \n        # Update state vectors\n        U[:, 1:N+1] -= (dt/dx) * (F_num[:, 1:] - F_num[:, :-1])\n        t += dt\n\n    # --- Verification ---\n    rho_num = U[0, 1:N+1]\n    rho_exact = exact_riemann_solver(left_state, right_state, gamma, x_centers - x0, t_end)\n    l1_error = np.sum(np.abs(rho_num - rho_exact)) * dx\n    \n    return l1_error\n\ndef exact_riemann_solver(left_state, right_state, gamma, x, t):\n    \"\"\"\n    Computes the exact solution to the Riemann problem.\n    \"\"\"\n    rho_L, u_L, p_L = left_state\n    rho_R, u_R, p_R = right_state\n    a_L = np.sqrt(gamma * p_L / rho_L)\n    a_R = np.sqrt(gamma * p_R / rho_R)\n\n    def pressure_func(p_star, p_K, rho_K, a_K):\n        if p_star > p_K:  # Shock\n            A = 2 / ((gamma + 1) * rho_K)\n            B = (gamma - 1) / (gamma + 1) * p_K\n            return (p_star - p_K) * np.sqrt(A / (p_star + B))\n        else:  # Rarefaction\n            return (2 * a_K / (gamma - 1)) * ((p_star / p_K)**((gamma - 1) / (2 * gamma)) - 1)\n\n    def total_pressure_func(p_star):\n        return pressure_func(p_star, p_L, rho_L, a_L) + pressure_func(p_star, p_R, rho_R, a_R) + (u_R - u_L)\n\n    # Check for trivial case\n    if np.allclose(left_state, right_state):\n        return np.full_like(x, rho_L)\n\n    try:\n        p_star = brentq(total_pressure_func, 1e-6, 1e7)\n    except ValueError: # Handle no zero in interval, often for vacuum states not in test suite\n        p_star = 1e-6 \n    \n    u_star = 0.5 * (u_L + u_R) + 0.5 * (pressure_func(p_star, p_R, rho_R, a_R) - pressure_func(p_star, p_L, rho_L, a_L))\n    \n    # Solution sampling at xi = x/t\n    xi = x / t if t > 0 else np.zeros_like(x)\n    rho_sol = np.zeros_like(xi)\n\n    # Left wave\n    if p_star > p_L: # Left Shock\n        rho_star_L = rho_L * ((p_star/p_L + (gamma-1)/(gamma+1)) / ((gamma-1)/(gamma+1) * p_star/p_L + 1))\n        S_L = u_L - a_L * np.sqrt((gamma+1)/(2*gamma) * (p_star/p_L) + (gamma-1)/(2*gamma))\n        rho_sol[xi  S_L] = rho_L\n        rho_sol[(xi >= S_L)  (xi  u_star)] = rho_star_L\n    else: # Left Rarefaction\n        rho_star_L = rho_L * (p_star/p_L)**(1/gamma)\n        a_star_L = np.sqrt(gamma*p_star/rho_star_L)\n        S_HL = u_L - a_L\n        S_TL = u_star - a_star_L\n        rho_sol[xi  S_HL] = rho_L\n        rarefaction_region_L = (xi >= S_HL)  (xi  S_TL)\n        rho_sol[rarefaction_region_L] = rho_L * (2/(gamma+1) + (gamma-1)/((gamma+1)*a_L)*(u_L-xi[rarefaction_region_L]))**(2/(gamma-1))\n        rho_sol[(xi >= S_TL)  (xi  u_star)] = rho_star_L\n\n    # Right wave\n    if p_star > p_R: # Right Shock\n        rho_star_R = rho_R * ((p_star/p_R + (gamma-1)/(gamma+1)) / ((gamma-1)/(gamma+1) * p_star/p_R + 1))\n        S_R = u_R + a_R * np.sqrt((gamma+1)/(2*gamma) * (p_star/p_R) + (gamma-1)/(2*gamma))\n        rho_sol[xi > S_R] = rho_R\n        rho_sol[(xi >= u_star)  (xi = S_R)] = rho_star_R\n    else: # Right Rarefaction\n        rho_star_R = rho_R * (p_star/p_R)**(1/gamma)\n        a_star_R = np.sqrt(gamma*p_star/rho_star_R)\n        S_HR = u_R + a_R\n        S_TR = u_star + a_star_R\n        rho_sol[xi > S_HR] = rho_R\n        rarefaction_region_R = (xi > S_TR)  (xi = S_HR)\n        rho_sol[rarefaction_region_R] = rho_R * (2/(gamma+1) - (gamma-1)/((gamma+1)*a_R)*(u_R-xi[rarefaction_region_R]))**(2/(gamma-1))\n        rho_sol[(xi >= u_star)  (xi = S_TR)] = rho_star_R\n        \n    return rho_sol\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A numerically stable solver is not always a physically correct one; it can sometimes converge to solutions that violate fundamental physical laws like the second law of thermodynamics. This practice confronts this advanced topic by investigating entropy violations in common numerical schemes for the Burgers' equation . You will implement and compare different numerical fluxes to see how unphysical rarefaction shocks can arise and learn how to apply an \"entropy fix\" to ensure your simulation produces physically meaningful results.",
            "id": "4147034",
            "problem": "Consider one-dimensional nonlinear acoustic wave steepening modeled by the inviscid scalar conservation law known as Burgers' equation, which is widely used in computational acoustics to approximate shock formation in finite-amplitude waves under one-way propagation:\n$$\n\\partial_t u(x,t) + \\partial_x f\\big(u(x,t)\\big) = 0,\n$$\nwhere the flux is $$f(u) = \\tfrac{1}{2} u^2$$ and the characteristic speed is $$a(u) = f'(u) = u$$. For shock-forming wavefields, the physically relevant solution is the entropy solution, which satisfies the entropy inequality for a convex entropy pair $$\\eta(u) = \\tfrac{1}{2}u^2$$ and $$q(u) = \\tfrac{1}{3}u^3$$:\n$$\n\\partial_t \\eta(u) + \\partial_x q(u) \\le 0,\n$$\nwith strict inequality across shocks. This implies that the spatial integral of $$\\eta$$ over a periodic, closed domain, $$S(t) = \\int_0^L \\eta\\big(u(x,t)\\big) \\, dx,$$ should not increase in time when shocks form, and should remain constant for smooth rarefaction waves in the absence of shocks.\n\nYou are asked to implement a finite-volume, time-domain simulator on a periodic domain $$x \\in [0,L]$$ with $$L=1$$ to compare entropy behavior in different numerical schemes applied to Burgers' equation:\n- A central scheme that uses a simple arithmetic-average interface flux,\n- An upwind scheme based on the Roe linearization without an entropy fix,\n- The same Roe upwind scheme augmented with a Harten entropy fix near sonic points.\n\nThe semi-discrete finite-volume update for cell-averaged $$u_i(t)$$ on a uniform grid with $$N$$ cells of size $$\\Delta x = L/N$$ is\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\nwhere $$F_{i+\\frac{1}{2}}$$ is the numerical flux at interface $$x_{i+\\frac{1}{2}}$$. Use periodic indexing so that $$u_{-1} \\equiv u_{N-1}$$ and $$u_{N} \\equiv u_{0}$$.\n\nDefine the following fluxes:\n- Central average flux:\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{central}} = \\frac{1}{2}\\left(f(u_i) + f(u_{i+1})\\right).\n$$\n- Roe upwind flux without entropy fix:\n$$\na_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{u_i + u_{i+1}}{2}, \\quad\nF_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right| \\left( u_{i+1} - u_i \\right).\n$$\n- Roe upwind flux with Harten entropy fix (near sonic points):\nIntroduce a smoothing threshold $$\\delta_{i+\\frac{1}{2}} = \\varepsilon \\, \\max_j \\left| a_{j+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$ with a small $$\\varepsilon \\in (0,1)$$, and replace $$\\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$ by\n$$\n\\phi\\!\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) =\n\\begin{cases}\n\\frac{1}{2}\\left(\\frac{a^2}{\\delta} + \\delta\\right),  \\text{if } |a|  \\delta, \\\\\n|a|,  \\text{otherwise,}\n\\end{cases}\n$$\nwhere $$a \\equiv a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}$$ and $$\\delta \\equiv \\delta_{i+\\frac{1}{2}}$$. Then define\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{Roe\\text{-}fix}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\, \\phi\\!\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) \\left( u_{i+1} - u_i \\right).\n$$\n\nUse a standard explicit time stepping with a Courant–Friedrichs–Lewy (CFL) rule based on $$\\max_i |u_i|$$:\n$$\n\\Delta t = \\mathrm{CFL} \\, \\frac{\\Delta x}{\\max_i |u_i| + 10^{-12}},\n$$\nwith $$\\mathrm{CFL}=0.2$$ for the central scheme and $$\\mathrm{CFL}=0.5$$ for the Roe variants. Initialize the entropy\n$$\nS(t) = \\sum_{i=0}^{N-1} \\frac{1}{2} u_i(t)^2 \\, \\Delta x,\n$$\nand monitor its change $$\\Delta S = S(t_{\\mathrm{end}}) - S(0)$$.\n\nFor the test suite below, define the initial condition on $$N$$ uniform cells as indicated, and evolve to $$t_{\\mathrm{end}}$$. Use the stated periodic boundary and dimensionless units throughout. For each test case, compute three boolean values indicating whether a scheme exhibits an entropy violation according to the criteria:\n- For shock-forming cases: a violation occurs if $$\\Delta S  10^{-6}$$ (entropy should not increase when shocks form).\n- For smooth rarefaction cases: a violation occurs if $$|\\Delta S|  10^{-6}$$ (entropy should remain constant in the absence of shocks).\n\nTest suite:\n1. Shock-forming sinusoid:\n   - $$N = 400$$, initial condition $$u(x,0) = A \\sin(2\\pi x)$$ with $$A=1.0$$, evolve to $$t_{\\mathrm{end}} = 0.20$$.\n2. Transonic rarefaction step:\n   - $$N = 400$$, initial condition $$u(x,0) = u_L$$ for $$x  0.5$$ and $$u(x,0) = u_R$$ for $$x \\ge 0.5$$ with $$u_L = -0.2$$ and $$u_R = 0.2$$, evolve to $$t_{\\mathrm{end}} = 0.10$$.\n3. Strong rarefaction step:\n   - $$N = 400$$, initial condition $$u(x,0) = u_L$$ for $$x  0.5$$ and $$u(x,0) = u_R$$ for $$x \\ge 0.5$$ with $$u_L = -1.0$$ and $$u_R = 1.0$$, evolve to $$t_{\\mathrm{end}} = 0.05$$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of three boolean values in the order [central,roe,roe_fix]. For example:\n\"[ [False,True,False] , [False,False,False] , [True,False,False] ]\"",
            "solution": "The problem requires the simulation of the one-dimensional inviscid Burgers' equation, a prototypical scalar conservation law, given by:\n$$\n\\partial_t u(x,t) + \\partial_x f(u(x,t)) = 0\n$$\nwhere the state variable is $$u(x,t)$$, and the nonlinear flux is $$f(u) = \\frac{1}{2} u^2$$. The characteristic speed is $$a(u) = f'(u) = u$$. We are to solve this equation on a periodic domain $$x \\in [0,L]$$ with $$L=1$$ using a finite-volume method. The goal is to investigate how different numerical flux functions affect the conservation of a discrete version of the total entropy, $$S(t) = \\int_0^L \\eta(u) \\, dx$$, where $$\\eta(u) = \\frac{1}{2}u^2$$ is the entropy function. For physically correct (entropy) solutions, this quantity must not increase over time, $$S(t_2) \\le S(t_1)$$ for $$t_2 > t_1$$.\n\nThe numerical framework is a semi-discrete finite-volume method on a uniform grid of $$N$$ cells, each of width $$\\Delta x = L/N$$. The update equation for the cell-averaged state $$u_i$$ is:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right)\n$$\nHere, $$F_{i+\\frac{1}{2}}$$ is the numerical flux at the interface between cell $$i$$ and cell $$i+1$$. Periodic boundary conditions are enforced. Time integration is performed using an explicit forward Euler method, with the time step $$\\Delta t$$ determined by a Courant–Friedrichs–Lewy (CFL) condition:\n$$\n\\Delta t = \\mathrm{CFL} \\, \\frac{\\Delta x}{\\max_i |u_i| + 10^{-12}}\n$$\nA small constant, $$10^{-12}$$, is added to the denominator for numerical stability.\n\nWe will implement and compare three distinct numerical flux formulations:\n\n1.  **Central Average Flux**:\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{central}} = \\frac{1}{2}\\left(f(u_i) + f(u_{i+1})\\right)\n    $$\n    This is the simplest possible flux. It is non-dissipative, which means it does not damp numerical oscillations. For hyperbolic problems, this lack of dissipation often leads to instability, especially near shocks, which can cause an unphysical increase in the total entropy.\n\n2.  **Roe Upwind Flux**:\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right| \\left( u_{i+1} - u_i \\right)\n    $$\n    where $$a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{u_i + u_{i+1}}{2}$$ is the Roe-averaged characteristic speed. The second term, proportional to $$|a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}|$$, introduces numerical dissipation that is dependent on the wave speed, making the scheme \"upwind\". This scheme is highly accurate for discontinuities. However, it has a well-known defect at sonic points, where the characteristic speed passes through zero (i.e., $$u_i  0$$ and $$u_{i+1} > 0$$). Here, $$a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}$$ can be close to zero, leading to insufficient dissipation. This allows the formation of entropy-violating rarefaction shocks.\n\n3.  **Roe Upwind Flux with Harten Entropy Fix**:\n    To correct the Roe flux's deficiency, the dissipation term is modified. We replace $$\\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$ with a function $$\\phi(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}})$$ that adds numerical viscosity near sonic points. The modified absolute value function is:\n    $$\n    \\phi(a) =\n    \\begin{cases}\n    \\frac{1}{2}\\left(\\frac{a^2}{\\delta} + \\delta\\right),  \\text{if } |a|  \\delta \\\\\n    |a|,  \\text{otherwise}\n    \\end{cases}\n    $$\n    The threshold $$\\delta$$ is based on the maximum wave speed in the domain, $$\\delta = \\varepsilon \\, \\max_j \\left| a_{j+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$, where we select a small parameter $$\\varepsilon = 0.1$$. This \"entropy fix\" ensures that sufficient numerical dissipation is present to prevent the formation of non-physical shocks in transonic rarefaction waves, thereby enforcing the entropy condition. The flux becomes:\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{Roe\\text{-}fix}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\, \\phi\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) \\left( u_{i+1} - u_i \\right)\n    $$\n\nThe algorithm proceeds by first initializing the state vector $$u_0$$ on $$N$$ cells according to the given test case. The initial discrete entropy $$S(0) = \\sum_{i=0}^{N-1} \\frac{1}{2} u_i(0)^2 \\, \\Delta x$$ is computed and stored. Then, the solution is evolved in time up to $$t_{\\mathrm{end}}$$. In each time step, the appropriate numerical flux is calculated at all cell interfaces, and the state vector $$u$$ is updated. After the final time step, the final entropy $$S(t_{\\mathrm{end}})$$ is computed, and the change $$\\Delta S = S(t_{\\mathrm{end}}) - S(0)$$ is determined.\n\nFinally, we classify whether an entropy violation has occurred based on the provided criteria:\n-   For a shock-forming problem (where some physical dissipation is expected), a violation is flagged if $$\\Delta S > 10^{-6}$$.\n-   For a smooth rarefaction problem (where the exact solution conserves entropy), a violation is flagged if $$|\\Delta S| > 10^{-6}$$.\n\nThis procedure is repeated for each of the three test cases and for each of the three numerical schemes to generate the required boolean matrix of results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef flux_function(u):\n    \"\"\"Computes the Burgers' flux F(u) = 0.5 * u^2.\"\"\"\n    return 0.5 * u**2\n\ndef get_flux_central(u):\n    \"\"\"Computes the central average flux F_{i+1/2}.\"\"\"\n    f_u = flux_function(u)\n    f_u_ip1 = np.roll(f_u, -1)\n    flux_interface = 0.5 * (f_u + f_u_ip1)\n    return flux_interface\n\ndef get_flux_roe(u):\n    \"\"\"Computes the Roe upwind flux F_{i+1/2} without entropy fix.\"\"\"\n    f_u = flux_function(u)\n    u_ip1 = np.roll(u, -1)\n    f_u_ip1 = flux_function(u_ip1)\n\n    a_roe = 0.5 * (u + u_ip1)\n    dissipation = np.abs(a_roe) * (u_ip1 - u)\n\n    flux_interface = 0.5 * (f_u + f_u_ip1) - 0.5 * dissipation\n    return flux_interface\n\ndef get_flux_roe_fix(u, epsilon):\n    \"\"\"Computes the Roe upwind flux F_{i+1/2} with Harten entropy fix.\"\"\"\n    f_u = flux_function(u)\n    u_ip1 = np.roll(u, -1)\n    f_u_ip1 = flux_function(u_ip1)\n\n    a_roe = 0.5 * (u + u_ip1)\n\n    max_abs_a_roe = np.max(np.abs(a_roe))\n    delta = epsilon * max_abs_a_roe\n    \n    phi_a = np.abs(a_roe)\n    # The check for delta > 0 avoids division by zero if all a_roe are zero\n    if delta > 1e-12:\n        sonic_points = np.abs(a_roe)  delta\n        a_sonic = a_roe[sonic_points]\n        phi_a[sonic_points] = 0.5 * (a_sonic**2 / delta + delta)\n\n    dissipation = phi_a * (u_ip1 - u)\n    flux_interface = 0.5 * (f_u + f_u_ip1) - 0.5 * dissipation\n    return flux_interface\n\ndef simulate(u0, N, L, t_end, scheme, cfl, epsilon=0.1):\n    \"\"\"Runs a single finite-volume simulation.\"\"\"\n    dx = L / N\n    u = u0.copy()\n    \n    # Calculate initial entropy: S(t) = sum(eta(u_i) * dx)\n    S0 = 0.5 * np.sum(u**2) * dx\n    \n    t = 0.0\n    while t  t_end:\n        max_u = np.max(np.abs(u))\n        dt = cfl * dx / (max_u + 1e-12)\n        \n        # Ensure the final time step does not overshoot t_end\n        if t + dt > t_end:\n            dt = t_end - t\n            \n        # Select flux calculation based on scheme type\n        if scheme == 'central':\n            flux = get_flux_central(u)\n        elif scheme == 'roe':\n            flux = get_flux_roe(u)\n        elif scheme == 'roe_fix':\n            flux = get_flux_roe_fix(u, epsilon)\n        \n        # Flux at interface i-1/2 is np.roll(flux, 1)\n        flux_im12 = np.roll(flux, 1)\n        \n        # Update cell averages using FV formaula\n        u = u - (dt / dx) * (flux - flux_im12)\n        \n        t += dt\n\n    # Calculate final entropy and the change\n    S_final = 0.5 * np.sum(u**2) * dx\n    delta_S = S_final - S0\n    return delta_S\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # 1. Shock-forming sinusoid\n        {\n            \"N\": 400, \"L\": 1.0, \n            \"u0_func\": lambda x: 1.0 * np.sin(2 * np.pi * x),\n            \"t_end\": 0.20, \"type\": \"shock\",\n        },\n        # 2. Transonic rarefaction step\n        {\n            \"N\": 400, \"L\": 1.0, \n            \"u0_func\": lambda x: np.where(x  0.5, -0.2, 0.2),\n            \"t_end\": 0.10, \"type\": \"rarefaction\",\n        },\n        # 3. Strong rarefaction step\n        {\n            \"N\": 400, \"L\": 1.0,\n            \"u0_func\": lambda x: np.where(x  0.5, -1.0, 1.0),\n            \"t_end\": 0.05, \"type\": \"rarefaction\",\n        }\n    ]\n\n    all_results = []\n    # Epsilon for Harten's entropy fix\n    epsilon_fix = 0.1\n    tolerance = 1e-6\n\n    for case in test_cases:\n        N = case[\"N\"]\n        L = case[\"L\"]\n        dx = L / N\n        # Define cell-centered grid\n        x = (np.arange(N) + 0.5) * dx\n\n        u0 = case[\"u0_func\"](x)\n\n        # CFL numbers for each scheme\n        cfl_central = 0.2\n        cfl_roe = 0.5\n\n        # Run simulations\n        delta_S_central = simulate(u0, N, L, case[\"t_end\"], 'central', cfl=cfl_central)\n        delta_S_roe = simulate(u0, N, L, case[\"t_end\"], 'roe', cfl=cfl_roe)\n        delta_S_roe_fix = simulate(u0, N, L, case[\"t_end\"], 'roe_fix', cfl=cfl_roe, epsilon=epsilon_fix)\n\n        delta_S_values = [delta_S_central, delta_S_roe, delta_S_roe_fix]\n        \n        case_violations = []\n        for ds in delta_S_values:\n            violation = False\n            if case[\"type\"] == \"shock\":\n                if ds > tolerance:\n                    violation = True\n            elif case[\"type\"] == \"rarefaction\":\n                if abs(ds) > tolerance:\n                    violation = True\n            case_violations.append(violation)\n        \n        all_results.append(case_violations)\n\n    # Format the final output string to match the specified format\n    # Example: \"[ [False,True,False] , [False,False,False] ]\"\n    inner_strings = [str(r).replace(\" \", \"\") for r in all_results]\n    final_output_string = f\"[{' , '.join(inner_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}