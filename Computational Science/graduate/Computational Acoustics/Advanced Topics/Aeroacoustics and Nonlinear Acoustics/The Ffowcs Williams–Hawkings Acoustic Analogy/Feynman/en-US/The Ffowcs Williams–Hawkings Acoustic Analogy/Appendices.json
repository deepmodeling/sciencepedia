{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice connects the general Ffowcs Williams–Hawkings (FW-H) framework to the fundamentals of acoustics. We will apply the FW-H thickness term to the classic case of a pulsating sphere and show that it precisely recovers the well-known solution for a simple monopole source. This exercise  is crucial for developing intuition and verifying that this powerful acoustic analogy is consistent with the basic principles you already understand.",
            "id": "3288158",
            "problem": "A rigid sphere of mean radius $a$ is embedded in a quiescent, inviscid, compressible fluid of ambient density $\\rho_0$ and sound speed $c_0$. The sphere undergoes small-amplitude, spatially uniform, radial pulsations described by the surface displacement $\\xi(t)=\\xi_0 \\sin(\\omega t)$, with $\\xi_0 \\ll a$. Assume the acoustic field is linear, the sphere is acoustically compact so that $ka \\ll 1$ where $k=\\omega/c_0$ and $\\lambda=2\\pi/k$ is the wavelength, and the observation point is in the far field at distance $r \\gg a$ from the center. Using only the thickness term of the Ffowcs Williams–Hawkings (FW–H) acoustic analogy, derive the leading-order expression for the radiated acoustic pressure $p'(r,t)$ at the observer due to the pulsation, under the stated assumptions. Then, compare this expression to the classic compact-monopole solution obtained from the volume velocity of the sphere and state whether they coincide.\n\nExpress your final answer for the acoustic pressure in Pascals. No numerical values are provided; give a single closed-form analytic expression in terms of $\\rho_0$, $a$, $r$, $c_0$, $\\xi_0$, and $\\omega$. If you introduce a retarded time, define it explicitly. No rounding is required.",
            "solution": "The problem statement is evaluated as valid. It presents a well-posed, scientifically grounded problem in classical acoustics and aeroacoustics. The premises are physically coherent, and the required data and conditions are provided to derive a unique, meaningful solution. The problem is objective and uses standard terminology and assumptions within the field.\n\nThe problem asks for the acoustic pressure radiated by a pulsating sphere, derived from the thickness term of the Ffowcs Williams–Hawkings (FW–H) analogy. The FW–H equation is an exact rearrangement of the conservation of mass and momentum into an inhomogeneous wave equation. The general solution for the acoustic pressure perturbation $p'(\\mathbf{x}, t) = p(\\mathbf{x}, t) - p_0$ is given by a sum of three integral terms, representing thickness (monopole), loading (dipole), and quadrupole sources.\n\nWe are instructed to use only the thickness term, which accounts for the displacement of fluid by the motion of the surface. For an observer at position $\\mathbf{x}$ at time $t$, this term is given by:\n$$\np'_{T}(\\mathbf{x}, t) = \\frac{1}{4\\pi} \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\frac{\\rho_0 v_n}{r_s |1 - M_r|} \\right]_{\\tau} dS(\\mathbf{y})\n$$\nHere, $S$ is the surface of the body, $\\mathbf{y}$ is a point on the surface, $v_n$ is the local surface velocity normal to the surface (defined positive outwards), $\\rho_0$ is the ambient fluid density, $r_s = |\\mathbf{x} - \\mathbf{y}|$ is the distance from a source point to the observer, $M_r$ is the Mach number of the surface in the direction of the observer, and the notation $[\\cdot]_{\\tau}$ indicates that the quantity in the brackets is evaluated at the retarded time $\\tau = t - r_s/c_0$, where $c_0$ is the speed of sound.\n\nThe problem states several simplifying conditions:\n1.  The fluid is quiescent, meaning there is no background flow, so the sphere's surface motion relative to the fluid is its absolute motion. The sphere is not translating, so its surface Mach number $M_r$ is zero.\n2.  The observer is in the far field, so $r \\gg a$, where $r$ is the distance from the center of the sphere to the observer. This allows the approximation $r_s = |\\mathbf{x} - \\mathbf{y}| \\approx r$. We can therefore move the $1/r_s$ factor outside the integral as $1/r$.\n3.  The sphere is acoustically compact ($ka \\ll 1$, where $k = \\omega/c_0$). This justifies approximating the retarded time for all points on the surface with a single value based on the sphere's center: $\\tau = t - r/c_0$.\n\nApplying these simplifications, the thickness term reduces to:\n$$\np'(r, t) \\approx \\frac{1}{4\\pi r} \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\rho_0 v_n \\right]_{\\tau} dS(\\mathbf{y})\n$$\nwhere $\\tau = t - r/c_0$.\n\nThe sphere undergoes spatially uniform, radial pulsations described by the surface displacement $\\xi(t) = \\xi_0 \\sin(\\omega t)$. The surface velocity $v_n$ is the time derivative of this displacement:\n$$\nv_n(t) = \\frac{d\\xi}{dt} = \\frac{d}{dt} (\\xi_0 \\sin(\\omega t)) = \\xi_0 \\omega \\cos(\\omega t)\n$$\nSince the pulsations are uniform, $v_n$ is constant over the entire surface $S$ at any given instant. We can take it and the constant ambient density $\\rho_0$ out of the integral:\n$$\np'(r, t) \\approx \\frac{\\rho_0}{4\\pi r} \\frac{\\partial}{\\partial t} \\left[ v_n(t) \\right]_{\\tau} \\int_{S} dS\n$$\nThe integral is the surface area of the sphere, which is $4\\pi a^2$.\n$$\np'(r, t) \\approx \\frac{\\rho_0 (4\\pi a^2)}{4\\pi r} \\frac{\\partial}{\\partial t} \\left[ v_n(t) \\right]_{\\tau} = \\frac{\\rho_0 a^2}{r} \\frac{\\partial}{\\partial t} v_n(\\tau)\n$$\nSubstituting the expression for $v_n$ and evaluating at the retarded time $\\tau = t - r/c_0$:\n$$\np'(r, t) = \\frac{\\rho_0 a^2}{r} \\frac{\\partial}{\\partial t} \\left( \\xi_0 \\omega \\cos(\\omega(t - r/c_0)) \\right)\n$$\nPerforming the time differentiation using the chain rule:\n$$\n\\frac{\\partial}{\\partial t} \\left( \\xi_0 \\omega \\cos(\\omega(t - r/c_0)) \\right) = \\xi_0 \\omega \\left( -\\sin(\\omega(t - r/c_0)) \\cdot \\omega \\right) = -\\xi_0 \\omega^2 \\sin(\\omega(t - r/c_0))\n$$\nSubstituting this back gives the final expression for the acoustic pressure:\n$$\np'(r, t) = \\frac{\\rho_0 a^2}{r} \\left( -\\xi_0 \\omega^2 \\sin(\\omega(t - r/c_0)) \\right) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$\n\nThe problem next asks to compare this expression to the classic compact-monopole solution. A compact pulsating sphere is the canonical example of an acoustic monopole, or simple source. The acoustic field of a simple source can be described by a velocity potential $\\phi$ that produces a spherically symmetric, outgoing wave, $\\phi(r,t) = f(t-r/c_0)/r$. The acoustic pressure is $p' = \\rho_0 \\partial \\phi / \\partial t$ and the radial velocity is $u_r = -\\partial \\phi / \\partial r$.\n\nThe boundary condition is that the fluid velocity at the sphere's surface matches the surface velocity: $u_r(a,t) = v_n(t)$. For a compact source ($ka \\ll 1$), the near-field term in the velocity expression dominates, so $u_r(a,t) \\approx f(t)/a^2$.\nThus, $f(t) \\approx a^2 v_n(t) = a^2 \\xi_0 \\omega \\cos(\\omega t)$.\nThe far-field pressure is given by:\n$$\np'(r,t) = \\rho_0 \\frac{\\partial \\phi}{\\partial t} = \\frac{\\rho_0}{r} f'(t-r/c_0)\n$$\nWe find $f'(t)$ by differentiating $f(t)$:\n$$\nf'(t) = \\frac{d}{dt}(a^2 \\xi_0 \\omega \\cos(\\omega t)) = -a^2 \\xi_0 \\omega^2 \\sin(\\omega t)\n$$\nEvaluating this at the retarded time gives:\n$$\np'(r,t) = \\frac{\\rho_0}{r} \\left( -a^2 \\xi_0 \\omega^2 \\sin(\\omega(t-r/c_0)) \\right) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$\nThis result is identical to the one obtained from the FW–H thickness term. Therefore, the thickness term of the FW–H analogy, when applied to a compact pulsating body, correctly reproduces the classic compact-monopole solution. They do coincide. The radiated pressure is proportional to the surface acceleration, hence the $-\\sin$ dependence, which is $90^\\circ$ out of phase with the velocity ($\\cos$).\nThe retarded time is $\\tau = t - r/c_0$.\n\nThe final expression for the acoustic pressure is:\n$$\np'(r, t) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$",
            "answer": "$$\n\\boxed{- \\frac{\\rho_{0} a^{2} \\xi_{0} \\omega^{2}}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_{0}}\\right)\\right)}\n$$"
        },
        {
            "introduction": "Moving from monopole (thickness) noise to dipole (loading) noise, this practice tackles a canonical problem in aeroacoustics: the sound generated by aerodynamic forces on a surface. You will derive the acoustic pressure from a lifting airfoil and use it to compute the Sound Pressure Level ($SPL$), a key metric in noise assessment. This exercise  demonstrates how the FW-H loading term allows us to directly link the forces acting on a body to the sound it radiates into the far field.",
            "id": "4141282",
            "problem": "A rigid, thin, permeable control surface is placed coincident with a stationary airfoil in quiescent air of speed of sound $c$. The acoustic field at a fixed observer location $\\boldsymbol{x}$ in the far field is modeled using the Ffowcs Williams–Hawkings (FW-H) acoustic analogy (Ffowcs Williams–Hawkings, FW-H). The airfoil experiences a spatially uniform, time-harmonic lift (normal surface loading) whose surface integral (the net aerodynamic force along the observer’s line of sight) is given by $F(t) = F_{0} \\cos(\\omega t)$, where $F_{0} > 0$ and $\\omega = 2\\pi f$ with $f$ the forcing frequency. The flow Mach number based on the airfoil motion is negligible, and the observer is located a distance $r$ on the axis of the lift direction. Assume the air is otherwise stationary except for the radiated acoustic field, and that the body is acoustically compact relative to the acoustic wavelength.\n\nStarting from the FW-H acoustic analogy and only invoking physically justified approximations appropriate to the stated conditions (low Mach number, acoustically compact body, far-field observer), derive the leading-order time-domain expression for the acoustic pressure fluctuation $p'(\\boldsymbol{x},t)$ at the observer due to the loading (surface) term. Use this $p'(\\boldsymbol{x},t)$ to compute the root-mean-square pressure $p_{\\mathrm{rms}}$ over a time window that spans an integer number of cycles in steady state. Define the sound pressure level as\n$$\\mathrm{SPL} = 20 \\log_{10}\\!\\left(\\frac{p_{\\mathrm{rms}}}{p_{\\mathrm{ref}}}\\right),$$\nand compute $\\mathrm{SPL}$ for the parameters\n- $F_{0} = 10\\,\\mathrm{N}$,\n- $f = 1000\\,\\mathrm{Hz}$,\n- $c = 343\\,\\mathrm{m/s}$,\n- $r = 50\\,\\mathrm{m}$,\n- $p_{\\mathrm{ref}} = 20 \\times 10^{-6}\\,\\mathrm{Pa}$.\n\nRound your final $\\mathrm{SPL}$ to four significant figures and express it in decibels (dB).",
            "solution": "The problem as stated is scientifically grounded, well-posed, and free of contradictions. All necessary parameters and simplifying assumptions are provided to derive a unique solution based on established principles of aeroacoustics. Therefore, the problem is deemed valid and a full solution follows.\n\nThe acoustic pressure fluctuation $p'(\\boldsymbol{x},t)$ in the far field of a low Mach number flow is given by the Ffowcs Williams–Hawkings (FW-H) acoustic analogy. The solution to the FW-H equation can be expressed as a sum of three terms, representing thickness (monopole), loading (dipole), and quadrupole sources. The problem specifies a stationary airfoil ($v_n=0$) and asks for the contribution from the loading (surface) term only. For a stationary body, the thickness noise is zero, and for low Mach number flows where sound is generated by surface forces, the volume-based quadrupole term is typically negligible compared to the loading term.\n\nThe loading term contribution to the acoustic pressure in the far field is given by the integral:\n$$p'(\\boldsymbol{x}, t) = \\frac{1}{4 \\pi} \\frac{\\partial}{\\partial x_i} \\int_S \\left[ \\frac{l_i}{r|1-M_r|} \\right]_{\\tau} dS(\\boldsymbol{y})$$\nHere, $l_i = (p-p_0) n_i$ is the force per unit area exerted by the surface on the fluid, where $n_i$ is the outward normal vector from the fluid region. The subscript $\\tau$ indicates that the integrand is evaluated at the retarded time $\\tau = t - |\\boldsymbol{x}-\\boldsymbol{y}|/c$. The term $M_r$ is the Mach number of the source in the direction of the observer.\n\nWe apply the simplifying conditions given in the problem:\n1.  **Stationary airfoil**: The source surface is stationary, so the Mach number $M_r = 0$. The denominator $|1-M_r|$ becomes $1$.\n2.  **Far-field observer**: For an observer far from the source, the spatial derivative $\\frac{\\partial}{\\partial x_i}$ can be approximated by a time derivative: $\\frac{\\partial}{\\partial x_i} \\approx -\\frac{\\hat{r}_i}{c} \\frac{\\partial}{\\partial t}$, where $\\hat{r}_i = (x_i-y_i)/r$ is the component of the unit vector pointing from the source element at $\\boldsymbol{y}$ to the observer at $\\boldsymbol{x}$.\n3.  **Acoustically compact body**: The source is small compared to the acoustic wavelength. This allows us to approximate the distance $r = |\\boldsymbol{x}-\\boldsymbol{y}|$ as a constant value $r$ (the distance from the observer to the body's center) for all source points $\\boldsymbol{y}$ on the surface $S$. Consequently, the retarded time $\\tau = t - r/c$ is also constant over the source region, and the unit vector $\\hat{\\boldsymbol{r}}$ is constant.\n\nApplying these simplifications to the loading integral:\n$$p'(\\boldsymbol{x},t) \\approx \\frac{1}{4 \\pi} \\left(-\\frac{\\hat{r}_i}{c} \\frac{\\partial}{\\partial t}\\right) \\int_S \\left[ \\frac{l_i(\\boldsymbol{y}, \\tau)}{r} \\right] dS(\\boldsymbol{y})$$\nDue to compactness, $r$ and $\\hat{r}_i$ can be moved outside the integral:\n$$p'(\\boldsymbol{x},t) \\approx -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} \\int_S \\hat{r}_i [l_i(\\boldsymbol{y}, \\tau)] dS(\\boldsymbol{y}) = -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} \\left[ \\hat{\\boldsymbol{r}} \\cdot \\int_S \\boldsymbol{l}(\\boldsymbol{y}, \\tau) dS(\\boldsymbol{y}) \\right]$$\nThe integral $\\int_S \\boldsymbol{l}(\\boldsymbol{y}, \\tau) dS$ is the net force exerted by the body on the fluid, $\\boldsymbol{F}_\\text{fluid}(\\tau)$. By Newton's third law, this is equal in magnitude and opposite in direction to the aerodynamic force exerted by the fluid on the body, $\\boldsymbol{F}_\\text{body}(\\tau)$, which includes lift. Thus, $\\boldsymbol{F}_\\text{fluid}(\\tau) = -\\boldsymbol{F}_\\text{body}(\\tau)$.\n$$p'(\\boldsymbol{x},t) \\approx -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} [ \\hat{\\boldsymbol{r}} \\cdot (-\\boldsymbol{F}_\\text{body}(\\tau)) ] = \\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} [ \\hat{\\boldsymbol{r}} \\cdot \\boldsymbol{F}_\\text{body}(\\tau) ]$$\nThe problem states that the net aerodynamic force along the observer's line of sight is $F(t) = F_0 \\cos(\\omega t)$. This quantity is precisely the dot product $\\hat{\\boldsymbol{r}} \\cdot \\boldsymbol{F}_\\text{body}(t)$. This is also consistent with the observer being on the axis of the lift direction.\nTherefore, we have:\n$$p'(\\boldsymbol{x},t) = \\frac{1}{4 \\pi c r} \\frac{d}{dt} [F(\\tau)]$$\nwhere $F(\\tau) = F_0 \\cos(\\omega \\tau) = F_0 \\cos(\\omega(t-r/c))$.\nTaking the time derivative with respect to $t$:\n$$\\frac{d}{dt} [F(\\tau)] = \\frac{d}{dt} [F_0 \\cos(\\omega t - \\omega r/c)] = -F_0 \\omega \\sin(\\omega t - \\omega r/c)$$\nSubstituting this back into the expression for $p'(\\boldsymbol{x},t)$, we obtain the first required result:\n$$p'(\\boldsymbol{x},t) = \\frac{1}{4 \\pi c r} (-F_0 \\omega \\sin(\\omega t - \\omega r/c)) = -\\frac{F_0 \\omega}{4 \\pi c r} \\sin\\left(\\omega t - \\frac{\\omega r}{c}\\right)$$\nThis is the time-domain expression for the acoustic pressure fluctuation.\n\nNext, we calculate the root-mean-square (RMS) pressure, $p_\\text{rms}$. For a sinusoidal signal of the form $A \\sin(\\phi)$, the RMS value is $|A|/\\sqrt{2}$. The peak amplitude of the pressure signal is:\n$$p'_\\text{peak} = \\left| -\\frac{F_0 \\omega}{4 \\pi c r} \\right| = \\frac{F_0 \\omega}{4 \\pi c r}$$\nThe RMS pressure is then:\n$$p_\\text{rms} = \\frac{p'_\\text{peak}}{\\sqrt{2}} = \\frac{F_0 \\omega}{4 \\pi \\sqrt{2} c r}$$\nSubstituting $\\omega = 2\\pi f$:\n$$p_\\text{rms} = \\frac{F_0 (2\\pi f)}{4 \\pi \\sqrt{2} c r} = \\frac{F_0 f}{2 \\sqrt{2} c r}$$\n\nNow, we substitute the given numerical values:\n$F_0 = 10\\,\\mathrm{N}$\n$f = 1000\\,\\mathrm{Hz}$\n$c = 343\\,\\mathrm{m/s}$\n$r = 50\\,\\mathrm{m}$\n$$p_\\text{rms} = \\frac{10 \\times 1000}{2 \\sqrt{2} \\times 343 \\times 50} = \\frac{10000}{100 \\sqrt{2} \\times 343} = \\frac{100}{343\\sqrt{2}}\\,\\mathrm{Pa}$$\n$$p_\\text{rms} \\approx 0.2061303\\,\\mathrm{Pa}$$\n\nFinally, we compute the Sound Pressure Level (SPL) using the provided formula and reference pressure $p_\\text{ref} = 20 \\times 10^{-6}\\,\\mathrm{Pa}$:\n$$\\mathrm{SPL} = 20 \\log_{10}\\!\\left(\\frac{p_\\text{rms}}{p_\\text{ref}}\\right) = 20 \\log_{10}\\!\\left(\\frac{0.2061303}{20 \\times 10^{-6}}\\right)$$\n$$\\mathrm{SPL} = 20 \\log_{10}(10306.515)$$\n$$\\mathrm{SPL} \\approx 20 \\times 4.013116 = 80.26232\\,\\mathrm{dB}$$\nRounding the result to four significant figures as required gives $80.26\\,\\mathrm{dB}$.",
            "answer": "$$\\boxed{80.26}$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and computational implementation, a core skill in modern aeroacoustics. You are tasked with developing a numerical program to compute the sound from a moving cylinder and, most importantly, to demonstrate its convergence. By systematically refining your numerical grid and time step, you will verify the accuracy of your code against an analytical solution , gaining hands-on experience with the validation and verification procedures that are essential for reliable computational predictions.",
            "id": "4141205",
            "problem": "Consider the Ffowcs Williams–Hawkings acoustic analogy for a moving impermeable body in a uniform, quiescent medium. Starting from Lighthill’s acoustic analogy and the generalized surface source representation in the Ffowcs Williams–Hawkings equation, derive a numerically implementable expression for the far-field acoustic pressure generated by prescribed unsteady surface loading on a rigid circular cylinder that translates at constant speed. The derivation must be based on first principles, explicitly stating all assumptions needed to reduce the general expressions, and must culminate in a computable formula expressed as a time derivative of a surface integral evaluated at the retarded time.\n\nYou are to implement a numerical program that demonstrates grid and time step convergence of the Ffowcs Williams–Hawkings (FW–H) prediction for a controlled moving-cylinder case in the low-Mach, far-field, compact-body limit:\n\n- Geometry: a right circular cylinder of radius $R$ and span $L_z$, moving at constant speed $U$ along the $x$-axis. The cylinder’s outward unit normal on the lateral surface at azimuthal angle $\\theta$ is $\\boldsymbol{n}(\\theta) = [\\cos\\theta,\\sin\\theta,0]$. The observer lies in the $z=0$ plane at distance $r$ from the cylinder centerline and direction $\\boldsymbol{e}_r = [\\cos\\varphi,\\sin\\varphi,0]$.\n- Surface loading: a prescribed time-harmonic pressure field on the lateral surface given by $p_s(\\theta,t) = p_a \\exp\\!\\big(\\alpha \\cos(\\theta - \\varphi_0)\\big) \\cos(\\omega t)$, where $p_a$ is an amplitude, $\\alpha$ is a spatial concentration parameter, and $\\omega$ is the angular frequency.\n- Kinematics: the cylinder translates at constant speed $U$ with Mach number $M = U/c < 0.3$. In this limit, neglect convective distortion of the free-space Green’s function and approximate the retarded time by $t_r \\approx t - r/c$ for the far-field.\n\nYour numerical implementation must:\n- Discretize the lateral surface integral over $\\theta \\in [0,2\\pi)$ by $N_\\theta$ uniform panels, using the midpoint rule for the azimuthal integration, and assume uniformity in $z$ so that $dS = R\\,L_z\\,d\\theta$.\n- Approximate the time derivative of the surface integral by a backward finite difference with time step $\\Delta t$.\n- Evaluate the far-field acoustic pressure $p'(\\boldsymbol{x},t)$ at a single reference time $t = t_\\star$, chosen such that the harmonic derivative is maximized, specifically $t_\\star = \\frac{r}{c} + \\frac{\\pi}{2\\omega}$.\n- Compute the predicted amplitude $A_{\\text{num}}$ in $\\mathrm{Pa}$ from your discretized FW–H loading term at $t_\\star$.\n- Compute an analytic reference amplitude $A_{\\text{ref}}$ in $\\mathrm{Pa}$ under the same low-Mach, far-field, compact-body assumptions by evaluating the exact azimuthal integral of $p_s(\\theta,t)\\,(\\boldsymbol{n}(\\theta)\\cdot \\boldsymbol{e}_r)$ at retarded time $t_r = t - r/c$. The integral identity $\\int_0^{2\\pi} \\exp\\!\\big(\\alpha \\cos(\\theta - \\varphi_0)\\big)\\cos(\\theta - \\varphi)\\,d\\theta = 2\\pi I_1(\\alpha)\\cos(\\varphi - \\varphi_0)$ may be used, where $I_1(\\cdot)$ is the modified Bessel function of the first kind of order $1$.\n- Report the relative error $E = \\lvert A_{\\text{num}} - A_{\\text{ref}}\\rvert / \\lvert A_{\\text{ref}}\\rvert$ (dimensionless) for each test case.\n\nUse the following fixed parameters (all in the International System of Units):\n- Speed of sound $c = \\,343\\,\\mathrm{m/s}$.\n- Cylinder radius $R = \\,0.05\\,\\mathrm{m}$.\n- Cylinder span $L_z = \\,0.5\\,\\mathrm{m}$.\n- Cylinder speed $U = \\,20\\,\\mathrm{m/s}$ (Mach number $M \\approx \\,0.058$; angles are in radians).\n- Observer distance $r = \\,30\\,\\mathrm{m}$.\n- Observer direction $\\varphi = \\,0.4\\,\\mathrm{rad}$.\n- Loading direction reference $\\varphi_0 = \\,0.1\\,\\mathrm{rad}$.\n- Pressure amplitude $p_a = \\,12\\,\\mathrm{Pa}$.\n- Angular frequency $\\omega = \\,2\\pi \\times 250\\,\\mathrm{rad/s}$.\n- Spatial concentration parameter $\\alpha = \\,1.5$.\n\nDesign a small test suite that demonstrates both grid and time-step convergence by varying $N_\\theta$ and $\\Delta t$ across cases:\n- Case $1$: $N_\\theta = \\,8$, $\\Delta t = \\,10^{-3}\\,\\mathrm{s}$.\n- Case $2$: $N_\\theta = \\,32$, $\\Delta t = \\,2\\times 10^{-4}\\,\\mathrm{s}$.\n- Case $3$: $N_\\theta = \\,128$, $\\Delta t = \\,5\\times 10^{-5}\\,\\mathrm{s}$.\n- Case $4$: $N_\\theta = \\,64$, $\\Delta t = \\,10^{-4}\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the relative errors as a comma-separated list enclosed in square brackets, ordered as in the test suite, for example $[e_1,e_2,e_3,e_4]$. Angles must be in radians, and any reported amplitudes must be in $\\mathrm{Pa}$. The final numerical outputs must be dimensionless relative errors as real-valued decimals.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the established Ffowcs Williams–Hawkings (FW–H) acoustic analogy, well-posed with all necessary constants and boundary conditions provided, and is formulated using objective, formal language. The assumptions of a low-Mach, far-field, compact-body scenario are standard and appropriate for simplifying the general theory into a tractable form.\n\nThe derivation of the acoustic pressure begins with the integral solution to the Ffowcs Williams–Hawkings equation, which describes the sound generated by a body in arbitrary motion. For a stationary observer at position $\\boldsymbol{x}$ in a uniform, quiescent medium, the acoustic pressure perturbation $p'(\\boldsymbol{x}, t)$ is given by:\n$$\n4\\pi p'(\\boldsymbol{x}, t) = \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\frac{\\rho_0 v_n}{r_*(1-M_r)} \\right]_{t_r} dS - \\frac{\\partial}{\\partial x_i} \\int_{S} \\left[ \\frac{p' n_i}{r_*(1-M_r)} \\right]_{t_r} dS + \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int_{\\mathcal{V}} \\left[ \\frac{T_{ij}}{r_*(1-M_r)} \\right]_{t_r} d\\mathcal{V}\n$$\nThe three terms on the right-hand side represent monopole (thickness), dipole (loading), and quadrupole sources, respectively. Here, $S$ is the surface of the body, $\\rho_0$ is the ambient fluid density, $v_n$ is the local normal velocity of the surface, $p'$ is the surface pressure perturbation, $n_i$ are the components of the outward unit normal vector $\\boldsymbol{n}$, $T_{ij}$ is the Lighthill stress tensor, $r_* = |\\boldsymbol{x}-\\boldsymbol{y}|$ is the distance from a source point $\\boldsymbol{y}$ to the observer, $t_r$ is the retarded time, and $(1-M_r)^{-1}$ is the Doppler factor, with $M_r$ being the Mach number component in the observer's direction.\n\nThe problem specifies several simplifying assumptions:\n1.  **Rigid body in constant-velocity translation**: The cylinder moves at a constant speed $U$, so its surface does not deform, and its velocity does not change. The thickness noise source, related to the time derivative of fluid volume displacement, contributes a steady pressure field, not unsteady sound. The unsteady acoustics are generated by the prescribed unsteady surface loading.\n2.  **Low-Mach, far-field, compact-body limit**: For low Mach numbers ($M \\ll 1$), quadrupole sources ($T_{ij}$) are typically negligible compared to dipole sources. In the far-field ($r \\gg R$), we can make several approximations. The problem asks to neglect convective distortion and approximate the Doppler factor $(1-M_r) \\approx 1$. The distance $r_*$ in the denominator can be replaced by the distance to the body's origin, $r$. The retarded time is simplified to $t_r \\approx t - r/c$, where $c$ is the speed of sound.\n\nUnder these assumptions, the FW–H equation reduces to the loading term (dipole source):\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx - \\frac{\\partial}{\\partial x_i} \\int_{S} \\left[ \\frac{p_s n_i}{r} \\right]_{t=t_r} dS\n$$\nwhere $p_s$ is the prescribed surface pressure. The spatial derivative $\\partial/\\partial x_i$ acts on the integrand through the retarded time, $t_r \\approx t-r/c = t - |\\boldsymbol{x}|/c$. The chain rule gives $\\frac{\\partial}{\\partial x_i} = \\frac{\\partial t_r}{\\partial x_i} \\frac{d}{dt_r} = -\\frac{x_i}{rc} \\frac{d}{dt_r} = -\\frac{(\\boldsymbol{e}_r)_i}{c} \\frac{d}{dt_r}$, where $\\boldsymbol{e}_r = \\boldsymbol{x}/r$ is the unit vector towards the observer. Applying this and neglecting near-field terms that decay as $1/r^2$, we retain the dominant far-field radiation term:\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx - \\sum_i \\left( -\\frac{(\\boldsymbol{e}_r)_i}{c} \\right) \\int_S \\left[ \\frac{1}{r} \\frac{\\partial (p_s n_i)}{\\partial t} \\right]_{t=t_r} dS\n$$\nSince the surface normal $\\boldsymbol{n}$ is time-invariant for a rigid body and the observer direction $\\boldsymbol{e}_r$ is fixed, we can write:\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx \\frac{1}{rc} \\boldsymbol{e}_r \\cdot \\int_S \\left[ \\frac{\\partial p_s}{\\partial t} \\boldsymbol{n} \\right]_{t=t_r} dS = \\frac{1}{rc} \\int_S \\left[ \\frac{\\partial p_s}{\\partial t} \\right]_{t=t_r} (\\boldsymbol{n} \\cdot \\boldsymbol{e}_r) dS\n$$\nThis expression can be rewritten in the form requested by the problem statement, \"a time derivative of a surface integral evaluated at the retarded time\":\n$$\np'(\\boldsymbol{x}, t) = \\frac{1}{4\\pi r c} \\frac{\\partial}{\\partial t} \\left[ \\int_S p_s(\\boldsymbol{y}, t) (\\boldsymbol{n}(\\boldsymbol{y}) \\cdot \\boldsymbol{e}_r) dS \\right]_{t=t_r}\n$$\n\nTo find the analytic reference amplitude, $A_{\\text{ref}}$, we first evaluate the surface integral. Given $p_s(\\theta, t) = p_a \\exp(\\alpha \\cos(\\theta - \\varphi_0)) \\cos(\\omega t)$, $\\boldsymbol{n}(\\theta) \\cdot \\boldsymbol{e}_r = \\cos(\\theta - \\varphi)$, and $dS = R L_z d\\theta$ (integrating over the cylinder span $L_z$), the integral is:\n$$\n\\int_S p_s(\\boldsymbol{y}, t) (\\boldsymbol{n} \\cdot \\boldsymbol{e}_r) dS = R L_z p_a \\cos(\\omega t) \\int_0^{2\\pi} \\exp(\\alpha \\cos(\\theta - \\varphi_0)) \\cos(\\theta - \\varphi) d\\theta\n$$\nUsing the provided identity, $\\int_0^{2\\pi} \\exp(\\alpha \\cos(\\theta - \\varphi_0))\\cos(\\theta - \\varphi) d\\theta = 2\\pi I_1(\\alpha)\\cos(\\varphi - \\varphi_0)$, where $I_1$ is the modified Bessel function of the first kind of order $1$, the expression becomes:\n$$\n2\\pi R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\cos(\\omega t)\n$$\nTaking the time derivative and evaluating at the retarded time $t_r = t_\\star - r/c = \\pi/(2\\omega)$:\n$$\n\\frac{\\partial}{\\partial t}[\\dots]_{t_r} = -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\sin(\\omega t_r) = -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0)\n$$\nSubstituting this into the expression for $p'(\\boldsymbol{x}, t)$ yields the reference amplitude:\n$$\nA_{\\text{ref}} = \\frac{1}{4\\pi r c} \\left( -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\right) = - \\frac{\\omega p_a R L_z}{2 c r} I_1(\\alpha) \\cos(\\varphi - \\varphi_0)\n$$\n\nFor the numerical amplitude, $A_{\\text{num}}$, we discretize the formulation. The surface integral at a generic time $t$ is approximated using the midpoint rule with $N_\\theta$ panels of width $\\Delta\\theta = 2\\pi/N_\\theta$ and midpoints $\\theta_j = (j+0.5)\\Delta\\theta$ for $j=0, \\dots, N_\\theta-1$:\n$$\n\\int_S \\dots dS \\approx R L_z \\sum_{j=0}^{N_\\theta-1} p_s(\\theta_j, t) (\\boldsymbol{n}(\\theta_j) \\cdot \\boldsymbol{e}_r) \\Delta\\theta = \\frac{2\\pi R L_z}{N_\\theta} \\sum_{j=0}^{N_\\theta-1} p_s(\\theta_j, t) \\cos(\\theta_j - \\varphi)\n$$\nLet $I_{\\text{num}}(t)$ denote this discretized integral value. The time derivative is approximated by a backward finite difference with step $\\Delta t$:\n$$\n\\frac{\\partial}{\\partial t} [I_{\\text{num}}(t)]_{t_r} \\approx \\frac{I_{\\text{num}}(t_r) - I_{\\text{num}}(t_r - \\Delta t)}{\\Delta t}\n$$\nThe numerical amplitude at $t=t_\\star$ is therefore:\n$$\nA_{\\text{num}} = \\frac{1}{4\\pi r c \\Delta t} \\left( I_{\\text{num}}(t_r) - I_{\\text{num}}(t_r - \\Delta t) \\right)\n$$\nSubstituting $I_{\\text{num}}(t)$ and $t_r = \\pi/(2\\omega)$:\n$$\nI_{\\text{num}}(t_r) = \\frac{2\\pi R L_z p_a}{N_\\theta} \\cos(\\omega t_r) \\sum_{j=0}^{N_\\theta-1} \\exp(\\alpha \\cos(\\theta_j - \\varphi_0)) \\cos(\\theta_j - \\varphi) = 0\n$$\nsince $\\cos(\\omega t_r) = \\cos(\\pi/2)=0$. The expression for $A_{\\text{num}}$ simplifies to:\n$$\nA_{\\text{num}} = - \\frac{1}{4\\pi r c \\Delta t} I_{\\text{num}}(t_r - \\Delta t)\n$$\n$$\nA_{\\text{num}} = - \\frac{1}{4\\pi r c \\Delta t} \\left( \\frac{2\\pi R L_z p_a}{N_\\theta} \\cos(\\omega(t_r - \\Delta t)) \\sum_j \\dots \\right)\n$$\nUsing $\\cos(\\pi/2 - \\omega\\Delta t) = \\sin(\\omega\\Delta t)$, we get:\n$$\nA_{\\text{num}} = - \\frac{R L_z p_a}{2 r c N_\\theta \\Delta t} \\sin(\\omega\\Delta t) \\sum_{j=0}^{N_\\theta-1} \\exp(\\alpha \\cos(\\theta_j - \\varphi_0)) \\cos(\\theta_j - \\varphi)\n$$\nThe relative error is computed as $E = |A_{\\text{num}} - A_{\\text{ref}}| / |A_{\\text{ref}}|$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i1\n\ndef solve():\n    \"\"\"\n    Computes the relative error of a numerical FW-H prediction against\n    an analytical solution for sound from a moving cylinder with prescribed\n    surface pressure.\n    \"\"\"\n\n    # --- Fixed Parameters (SI units) ---\n    c = 343.0           # Speed of sound (m/s)\n    R = 0.05            # Cylinder radius (m)\n    L_z = 0.5           # Cylinder span (m)\n    U = 20.0            # Cylinder speed (m/s)\n    r = 30.0            # Observer distance (m)\n    phi = 0.4           # Observer direction (rad)\n    phi_0 = 0.1         # Loading direction reference (rad)\n    p_a = 12.0          # Pressure amplitude (Pa)\n    omega = 2 * np.pi * 250.0 # Angular frequency (rad/s)\n    alpha = 1.5         # Spatial concentration parameter (dimensionless)\n\n    # --- Test Cases ---\n    test_cases = [\n        # (N_theta, delta_t)\n        (8, 1e-3),\n        (32, 2e-4),\n        (128, 5e-5),\n        (64, 1e-4),\n    ]\n\n    # --- Analytic Reference Amplitude (A_ref) ---\n    # A_ref = - (omega * p_a * R * L_z) / (2 * c * r) * I1(alpha) * cos(phi - phi_0)\n    # This value is constant for all test cases.\n    cos_phi_diff = np.cos(phi - phi_0)\n    i1_alpha = i1(alpha)\n    A_ref = - (omega * p_a * R * L_z) / (2.0 * c * r) * i1_alpha * cos_phi_diff\n    \n    results = []\n    \n    for case in test_cases:\n        N_theta, delta_t = case\n\n        # --- Numerical Amplitude (A_num) ---\n\n        # 1. Discretize the azimuthal integral using the midpoint rule\n        # theta_j are the midpoints of N_theta panels on [0, 2*pi)\n        theta_j = (np.arange(N_theta) + 0.5) * (2.0 * np.pi / N_theta)\n\n        # Integrand: exp(alpha*cos(theta-phi_0)) * cos(theta-phi)\n        integrand_values = np.exp(alpha * np.cos(theta_j - phi_0)) * np.cos(theta_j - phi)\n        \n        # The sum part of the midpoint rule\n        integral_sum = np.sum(integrand_values)\n\n        # 2. Calculate the complete A_num formula\n        # A_num = - (R*L_z*p_a)/(2*r*c*N_theta*delta_t) * sin(omega*delta_t) * sum(...)\n        factor = - (R * L_z * p_a) / (2.0 * r * c * N_theta * delta_t)\n        temporal_term = np.sin(omega * delta_t)\n        \n        A_num = factor * temporal_term * integral_sum\n\n        # 3. Compute relative error\n        if np.abs(A_ref) == 0:\n            # Avoid division by zero, though A_ref is non-zero here.\n            # If A_num is also zero, error is 0. Otherwise, it's infinite.\n            relative_error = 0.0 if np.abs(A_num) == 0 else np.inf\n        else:\n            relative_error = np.abs(A_num - A_ref) / np.abs(A_ref)\n\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}