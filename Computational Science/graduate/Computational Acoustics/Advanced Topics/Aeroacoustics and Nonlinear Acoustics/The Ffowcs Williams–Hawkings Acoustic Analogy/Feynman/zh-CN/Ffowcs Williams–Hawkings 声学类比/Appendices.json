{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在将广义的Ffowcs Williams-Hawkings (FW-H)声学比拟理论与经典声学理论联系起来。通过推导一个脉动球体的声辐射，您将验证FW-H方程中的“厚度项”如何在声学紧致的假设下，精确地重现经典的单极子声源解。这项实践有助于巩固对FW-H理论物理基础的理解。",
            "id": "3288158",
            "problem": "一个平均半径为 $a$ 的刚性球体嵌入在环境密度为 $\\rho_0$、声速为 $c_0$ 的静止、无粘、可压缩流体中。该球体进行小振幅、空间均匀的径向脉动，其表面位移由 $\\xi(t)=\\xi_0 \\sin(\\omega t)$ 描述，其中 $\\xi_0 \\ll a$。假设声场是线性的，球体是声学紧致的，即 $ka \\ll 1$，其中 $k=\\omega/c_0$ 且波长 $\\lambda=2\\pi/k$。观测点位于远场，距离球心 $r \\gg a$。仅使用 Ffowcs Williams–Hawkings (FW–H) 声学类比的厚度项，在所述假设下，推导由脉动引起的观测点处的辐射声压 $p'(r,t)$ 的主阶表达式。然后，将此表达式与从球体体积速度得到的经典紧致单极子解进行比较，并说明它们是否一致。\n\n以帕斯卡为单位表示声压的最终答案。题目不提供数值；请给出一个用 $\\rho_0$、$a$、$r$、$c_0$、$\\xi_0$ 和 $\\omega$ 表示的单一闭式解析表达式。如果引入了推迟时间，请明确定义。无需四舍五入。",
            "solution": "问题陈述被评估为有效。它提出了一个在经典声学和气动声学领域中适定的、有科学依据的问题。其前提在物理上是一致的，并且提供了推导唯一且有意义解所需的数据和条件。该问题是客观的，并使用了该领域的标准术语和假设。\n\n问题要求从 Ffowcs Williams–Hawkings (FW–H) 类比的厚度项推导脉动球体辐射的声压。FW–H 方程是质量守恒和动量守恒定律精确重排后得到的非齐次波动方程。声压扰动 $p'(\\mathbf{x}, t) = p(\\mathbf{x}, t) - p_0$ 的通解由三个积分项之和给出，分别代表厚度（单极子）、载荷（偶极子）和四极子源。\n\n我们被要求只使用厚度项，该项解释了由表面运动引起的流体位移。对于位于位置 $\\mathbf{x}$、时间为 $t$ 的观测者，该项由下式给出：\n$$\np'_{T}(\\mathbf{x}, t) = \\frac{1}{4\\pi} \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\frac{\\rho_0 v_n}{r_s |1 - M_r|} \\right]_{\\tau} dS(\\mathbf{y})\n$$\n此处，$S$ 是物体的表面，$\\mathbf{y}$ 是表面上的一个点，$v_n$ 是垂直于表面的局部表面速度（定义为向外为正），$\\rho_0$ 是环境流体密度，$r_s = |\\mathbf{x} - \\mathbf{y}|$ 是从源点到观测者的距离，$M_r$ 是表面在观测者方向上的马赫数，而记号 $[\\cdot]_{\\tau}$ 表示括号中的量在推迟时间 $\\tau = t - r_s/c_0$ 处进行计算，其中 $c_0$ 是声速。\n\n问题陈述了几个简化条件：\n1.  流体是静止的，意味着没有背景流，因此球体表面相对于流体的运动就是其绝对运动。球体不平移，所以其表面马赫数 $M_r$ 为零。\n2.  观测者位于远场，因此 $r \\gg a$，其中 $r$ 是从球心到观测者的距离。这允许我们进行近似 $r_s = |\\mathbf{x} - \\mathbf{y}| \\approx r$。因此，我们可以将因子 $1/r_s$ 作为 $1/r$ 移到积分之外。\n3.  球体是声学紧致的（$ka \\ll 1$，其中 $k = \\omega/c_0$）。这使得用一个基于球心的单一值来近似表面上所有点的推迟时间是合理的：$\\tau = t - r/c_0$。\n\n应用这些简化，厚度项简化为：\n$$\np'(r, t) \\approx \\frac{1}{4\\pi r} \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\rho_0 v_n \\right]_{\\tau} dS(\\mathbf{y})\n$$\n其中 $\\tau = t - r/c_0$。\n\n球体进行空间均匀的径向脉动，其表面位移由 $\\xi(t) = \\xi_0 \\sin(\\omega t)$ 描述。表面速度 $v_n(t)$ 是该位移的时间导数：\n$$\nv_n(t) = \\frac{d\\xi}{dt} = \\frac{d}{dt} (\\xi_0 \\sin(\\omega t)) = \\xi_0 \\omega \\cos(\\omega t)\n$$\n由于脉动是均匀的，$v_n$ 在任何给定时刻在整个表面 $S$ 上都是恒定的。我们可以将其和恒定的环境密度 $\\rho_0$ 从积分中提出：\n$$\np'(r, t) \\approx \\frac{\\rho_0}{4\\pi r} \\frac{\\partial}{\\partial t} \\left[ v_n(t) \\right]_{\\tau} \\int_{S} dS\n$$\n该积分是球体的表面积，即 $4\\pi a^2$。\n$$\np'(r, t) \\approx \\frac{\\rho_0 (4\\pi a^2)}{4\\pi r} \\frac{\\partial}{\\partial t} \\left[ v_n(t) \\right]_{\\tau} = \\frac{\\rho_0 a^2}{r} \\frac{\\partial}{\\partial t} v_n(\\tau)\n$$\n代入 $v_n$ 的表达式，并在推迟时间 $\\tau = t - r/c_0$ 处求值：\n$$\np'(r, t) = \\frac{\\rho_0 a^2}{r} \\frac{\\partial}{\\partial t} \\left( \\xi_0 \\omega \\cos(\\omega(t - r/c_0)) \\right)\n$$\n使用链式法则进行时间微分：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\xi_0 \\omega \\cos(\\omega(t - r/c_0)) \\right) = \\xi_0 \\omega \\left( -\\sin(\\omega(t - r/c_0)) \\cdot \\omega \\right) = -\\xi_0 \\omega^2 \\sin(\\omega(t - r/c_0))\n$$\n将此结果代回，得到声压的最终表达式：\n$$\np'(r, t) = \\frac{\\rho_0 a^2}{r} \\left( -\\xi_0 \\omega^2 \\sin(\\omega(t - r/c_0)) \\right) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$\n\n接下来，问题要求将此表达式与经典紧致单极子解进行比较。一个紧致的脉动球体是声学单极子（或简单源）的典型例子。一个简单源的声场可以用一个速度势 $\\phi$ 来描述，它产生一个球对称的出射波，$\\phi(r,t) = f(t-r/c_0)/r$。声压为 $p' = \\rho_0 \\partial \\phi / \\partial t$，径向速度为 $u_r = -\\partial \\phi / \\partial r$。\n\n边界条件是在球体表面的流体速度与表面速度匹配：$u_r(a,t) = v_n(t)$。对于紧致源（$ka \\ll 1$），速度表达式中的近场项占主导地位，因此 $u_r(a,t) \\approx f(t)/a^2$。\n因此，$f(t) \\approx a^2 v_n(t) = a^2 \\xi_0 \\omega \\cos(\\omega t)$。\n远场压力由下式给出：\n$$\np'(r,t) = \\rho_0 \\frac{\\partial \\phi}{\\partial t} = \\frac{\\rho_0}{r} f'(t-r/c_0)\n$$\n我们通过对 $f(t)$ 微分来求得 $f'(t)$：\n$$\nf'(t) = \\frac{d}{dt}(a^2 \\xi_0 \\omega \\cos(\\omega t)) = -a^2 \\xi_0 \\omega^2 \\sin(\\omega t)\n$$\n在推迟时间处计算该值，得到：\n$$\np'(r,t) = \\frac{\\rho_0}{r} \\left( -a^2 \\xi_0 \\omega^2 \\sin(\\omega(t-r/c_0)) \\right) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$\n这个结果与从 FW–H 厚度项得到的结果完全相同。因此，当应用于紧致脉动体时，FW–H 类比的厚度项正确地再现了经典的紧致单极子解。它们确实是一致的。辐射压力与表面加速度成正比，因此具有 $-\\sin$ 的相关性，这与速度（$\\cos$）相位相差 $90^\\circ$。推迟时间为 $\\tau = t - r/c_0$。\n\n声压的最终表达式为：\n$$\np'(r, t) = - \\frac{\\rho_0 a^2 \\xi_0 \\omega^2}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_0}\\right)\\right)\n$$",
            "answer": "$$\n\\boxed{- \\frac{\\rho_{0} a^{2} \\xi_{0} \\omega^{2}}{r} \\sin\\left(\\omega \\left(t - \\frac{r}{c_{0}}\\right)\\right)}\n$$"
        },
        {
            "introduction": "在掌握了厚度噪声的基础后，本练习将重点转向在航空声学中至关重要的“载荷噪声”项。您将为一个承受时谐载荷的静止翼型推导远场声压，并计算声压级(SPL)。这个过程不仅能加深您对偶极子声源的理解，还能将抽象的声压公式与实际工程中的噪声评估指标联系起来。",
            "id": "4141282",
            "problem": "一个刚性、薄、可渗透的控制面与静止翼型重合，置于声速为 $c$ 的静止空气中。位于远场固定观察点 $\\boldsymbol{x}$ 处的声场采用 Ffowcs Williams–Hawkings (FW-H) 声学比拟（Ffowcs Williams–Hawkings, FW-H）进行建模。翼型承受一个空间均匀、时间谐波的升力（法向表面载荷），其面积分（沿观察者视线方向的净气动力）由 $F(t) = F_{0} \\cos(\\omega t)$ 给出，其中 $F_{0} > 0$ 且 $\\omega = 2\\pi f$，$f$ 为强迫频率。基于翼型运动的流动马赫数可以忽略不计，观察者位于升力方向轴线上，距离为 $r$。假设除了辐射的声场外，空气在其他方面是静止的，并且物体相对于声波长是声学紧致的。\n\n从 FW-H 声学比拟出发，仅采用适用于所述条件（低马赫数、声学紧致体、远场观察者）的物理上合理的近似，推导由载荷（表面）项引起的观察点处声压脉动 $p'(\\boldsymbol{x},t)$ 的领先阶时域表达式。使用此 $p'(\\boldsymbol{x},t)$ 计算稳态下跨越整数个周期的时间窗口内的均方根压力 $p_{\\mathrm{rms}}$。将声压级定义为\n$$\\mathrm{SPL} = 20 \\log_{10}\\!\\left(\\frac{p_{\\mathrm{rms}}}{p_{\\mathrm{ref}}}\\right),$$\n并根据以下参数计算 $\\mathrm{SPL}$：\n- $F_{0} = 10\\,\\mathrm{N}$，\n- $f = 1000\\,\\mathrm{Hz}$，\n- $c = 343\\,\\mathrm{m/s}$，\n- $r = 50\\,\\mathrm{m}$，\n- $p_{\\mathrm{ref}} = 20 \\times 10^{-6}\\,\\mathrm{Pa}$。\n\n将最终的 $\\mathrm{SPL}$ 四舍五入到四位有效数字，并以分贝（dB）表示。",
            "solution": "所述问题具有科学依据，是适定的，并且没有矛盾之处。所有必要的参数和简化假设都已提供，可以根据已建立的空气声学原理推导出唯一的解。因此，该问题被认为是有效的，完整的解答如下。\n\n低马赫数流场远场中的声压脉动 $p'(\\boldsymbol{x},t)$ 由 Ffowcs Williams–Hawkings (FW-H) 声学比拟给出。FW-H 方程的解可以表示为三项之和，分别代表厚度（单极子）、载荷（偶极子）和四极子声源。问题指定了静止翼型（$v_n=0$），并要求只计算载荷（表面）项的贡献。对于静止物体，厚度噪声为零；对于声源由表面力产生的低马赫数流动，基于体积的四极子项与载荷项相比通常可以忽略不计。\n\n远场中载荷项对声压的贡献由以下积分给出：\n$$p'(\\boldsymbol{x}, t) = \\frac{1}{4 \\pi} \\frac{\\partial}{\\partial x_i} \\int_S \\left[ \\frac{l_i}{r|1-M_r|} \\right]_{\\tau} dS(\\boldsymbol{y})$$\n此处，$l_i = (p-p_0) n_i$ 是表面对流体施加的单位面积上的力，其中 $n_i$ 是从流体区域向外的法向矢量。下标 $\\tau$ 表示被积函数在推迟时间 $\\tau = t - |\\boldsymbol{x}-\\boldsymbol{y}|/c$ 进行计算。$M_r$ 项是声源在观察者方向上的马赫数。\n\n我们应用问题中给出的简化条件：\n1.  **静止翼型**：声源表面是静止的，因此马赫数 $M_r = 0$。分母 $|1-M_r|$ 变为 $1$。\n2.  **远场观察者**：对于远离声源的观察者，空间导数 $\\frac{\\partial}{\\partial x_i}$ 可以近似为时间导数：$\\frac{\\partial}{\\partial x_i} \\approx -\\frac{\\hat{r}_i}{c} \\frac{\\partial}{\\partial t}$，其中 $\\hat{r}_i = (x_i-y_i)/r$ 是从位于 $\\boldsymbol{y}$ 的声源元指向位于 $\\boldsymbol{x}$ 的观察者的单位矢量的分量。\n3.  **声学紧致体**：声源尺寸远小于声波长。这使得我们可以将距离 $r = |\\boldsymbol{x}-\\boldsymbol{y}|$ 近似为一个常数值 $r$（观察者到物体中心的距离），对于表面 $S$ 上的所有源点 $\\boldsymbol{y}$ 均适用。因此，推迟时间 $\\tau = t - r/c$ 在整个源区域内也是恒定的，单位矢量 $\\hat{\\boldsymbol{r}}$ 也是恒定的。\n\n将这些简化应用于载荷积分：\n$$p'(\\boldsymbol{x},t) \\approx \\frac{1}{4 \\pi} \\left(-\\frac{\\hat{r}_i}{c} \\frac{\\partial}{\\partial t}\\right) \\int_S \\left[ \\frac{l_i(\\boldsymbol{y}, \\tau)}{r} \\right] dS(\\boldsymbol{y})$$\n由于紧致性，$r$ 和 $\\hat{r}_i$ 可以移到积分号外：\n$$p'(\\boldsymbol{x},t) \\approx -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} \\int_S \\hat{r}_i [l_i(\\boldsymbol{y}, \\tau)] dS(\\boldsymbol{y}) = -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} \\left[ \\hat{\\boldsymbol{r}} \\cdot \\int_S \\boldsymbol{l}(\\boldsymbol{y}, \\tau) dS(\\boldsymbol{y}) \\right]$$\n积分 $\\int_S \\boldsymbol{l}(\\boldsymbol{y}, \\tau) dS$ 是物体对流体施加的净力，$\\boldsymbol{F}_\\text{fluid}(\\tau)$。根据牛顿第三定律，它与流体对物体施加的气动力 $\\boldsymbol{F}_\\text{body}(\\tau)$（包括升力）大小相等、方向相反。因此，$\\boldsymbol{F}_\\text{fluid}(\\tau) = -\\boldsymbol{F}_\\text{body}(\\tau)$。\n$$p'(\\boldsymbol{x},t) \\approx -\\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} [ \\hat{\\boldsymbol{r}} \\cdot (-\\boldsymbol{F}_\\text{body}(\\tau)) ] = \\frac{1}{4 \\pi c r} \\frac{\\partial}{\\partial t} [ \\hat{\\boldsymbol{r}} \\cdot \\boldsymbol{F}_\\text{body}(\\tau) ]$$\n问题指出，沿观察者视线方向的净气动力为 $F(t) = F_0 \\cos(\\omega t)$。这个量恰好是点积 $\\hat{\\boldsymbol{r}} \\cdot \\boldsymbol{F}_\\text{body}(t)$。这也与观察者位于升力方向轴线上是一致的。\n因此，我们有：\n$$p'(\\boldsymbol{x},t) = \\frac{1}{4 \\pi c r} \\frac{d}{dt} [F(\\tau)]$$\n其中 $F(\\tau) = F_0 \\cos(\\omega \\tau) = F_0 \\cos(\\omega(t-r/c))$。\n对 $t$ 求时间导数：\n$$\\frac{d}{dt} [F(\\tau)] = \\frac{d}{dt} [F_0 \\cos(\\omega t - \\omega r/c)] = -F_0 \\omega \\sin(\\omega t - \\omega r/c)$$\n将此结果代回 $p'(\\boldsymbol{x},t)$ 的表达式，我们得到第一个要求的结果：\n$$p'(\\boldsymbol{x},t) = \\frac{1}{4 \\pi c r} (-F_0 \\omega \\sin(\\omega t - \\omega r/c)) = -\\frac{F_0 \\omega}{4 \\pi c r} \\sin\\left(\\omega t - \\frac{\\omega r}{c}\\right)$$\n这是声压脉动的时域表达式。\n\n接下来，我们计算均方根（RMS）压力 $p_\\text{rms}$。对于形式为 $A \\sin(\\phi)$ 的正弦信号，其 RMS 值为 $|A|/\\sqrt{2}$。压力信号的峰值振幅为：\n$$p'_{\\text{peak}} = \\left| -\\frac{F_0 \\omega}{4 \\pi c r} \\right| = \\frac{F_0 \\omega}{4 \\pi c r}$$\n那么 RMS 压力为：\n$$p_\\text{rms} = \\frac{p'_{\\text{peak}}}{\\sqrt{2}} = \\frac{F_0 \\omega}{4 \\pi \\sqrt{2} c r}$$\n代入 $\\omega = 2\\pi f$：\n$$p_\\text{rms} = \\frac{F_0 (2\\pi f)}{4 \\pi \\sqrt{2} c r} = \\frac{F_0 f}{2 \\sqrt{2} c r}$$\n\n现在，我们代入给定的数值：\n$F_0 = 10\\,\\mathrm{N}$\n$f = 1000\\,\\mathrm{Hz}$\n$c = 343\\,\\mathrm{m/s}$\n$r = 50\\,\\mathrm{m}$\n$$p_\\text{rms} = \\frac{10 \\times 1000}{2 \\sqrt{2} \\times 343 \\times 50} = \\frac{10000}{100 \\sqrt{2} \\times 343} = \\frac{100}{343\\sqrt{2}}\\,\\mathrm{Pa}$$\n$$p_\\text{rms} \\approx 0.2061303\\,\\mathrm{Pa}$$\n\n最后，我们使用给定的公式和参考压力 $p_\\text{ref} = 20 \\times 10^{-6}\\,\\mathrm{Pa}$ 来计算声压级（SPL）：\n$$\\mathrm{SPL} = 20 \\log_{10}\\!\\left(\\frac{p_\\text{rms}}{p_\\text{ref}}\\right) = 20 \\log_{10}\\!\\left(\\frac{0.2061303}{20 \\times 10^{-6}}\\right)$$\n$$\\mathrm{SPL} = 20 \\log_{10}(10306.515)$$\n$$\\mathrm{SPL} \\approx 20 \\times 4.013116 = 80.26232\\,\\mathrm{dB}$$\n按要求将结果四舍五入到四位有效数字，得到 $80.26\\,\\mathrm{dB}$。",
            "answer": "$$\\boxed{80.26}$$"
        },
        {
            "introduction": "本综合练习将理论知识转化为实际的计算技能，是计算航空声学仿真的核心实践。您需要为一个运动圆柱体实现FW-H载荷项的数值积分，并进行网格和时间步长的收敛性研究。这项任务旨在培养您进行代码验证和确保数值解精确性的关键能力，这是所有计算科学家必备的技能。",
            "id": "4141205",
            "problem": "考虑在均匀、静止介质中运动的不可穿透物体的 Ffowcs Williams–Hawkings 声学比拟。从 Lighthill 的声学比拟和 Ffowcs Williams–Hawkings 方程中的广义面源表示出发，推导一个数值上可实现的表达式，用于计算在刚性圆柱体上由给定的非定常表面载荷产生的远场声压，该圆柱体以恒定速度平移。该推导必须基于第一性原理，明确陈述简化通用表达式所需的所有假设，并最终得到一个可计算的公式，该公式表示为在延迟时间计算的面积分的时导数。\n\n你需要实现一个数值程序，在低马赫数、远场、紧凑体极限条件下，针对一个受控的运动圆柱体案例，验证 Ffowcs Williams–Hawkings (FW–H) 预测的网格和时间步长收敛性：\n\n- 几何：一个半径为 $R$、展长为 $L_z$ 的正圆柱体，沿 $x$ 轴以恒定速度 $U$ 移动。在方位角 $\\theta$ 处，圆柱体侧面的外法向单位向量为 $\\boldsymbol{n}(\\theta) = [\\cos\\theta,\\sin\\theta,0]$。观察者位于 $z=0$ 平面，距离圆柱中心线为 $r$，方向为 $\\boldsymbol{e}_r = [\\cos\\varphi,\\sin\\varphi,0]$。\n- 表面载荷：在侧面上给定一个时谐压力场，其表达式为 $p_s(\\theta,t) = p_a \\exp\\!\\big(\\alpha \\cos(\\theta - \\varphi_0)\\big) \\cos(\\omega t)$，其中 $p_a$ 是振幅，$\\alpha$ 是空间集中参数，$\\omega$ 是角频率。\n- 运动学：圆柱体以恒定速度 $U$ 平移，马赫数 $M = U/c  0.3$。在此极限下，对于远场，忽略自由空间格林函数的对流畸变，并用 $t_r \\approx t - r/c$ 近似延迟时间。\n\n你的数值实现必须：\n- 使用 $N_\\theta$ 个均匀面板将侧面积分在 $\\theta \\in [0,2\\pi)$ 上离散化，对方位角积分使用中点法则，并假设在 $z$ 方向上是均匀的，因此 $dS = R\\,L_z\\,d\\theta$。\n- 使用时间步长为 $\\Delta t$ 的后向有限差分来近似面积分的时导数。\n- 在单个参考时间 $t = t_\\star$ 处计算远场声压 $p'(\\boldsymbol{x},t)$，该时间点的选择是为了使谐波导数最大化，具体为 $t_\\star = \\frac{r}{c} + \\frac{\\pi}{2\\omega}$。\n- 在 $t_\\star$ 时刻，根据你离散化的 FW–H 载荷项计算预测振幅 $A_{\\text{num}}$（单位为 Pa）。\n- 在相同的低马赫数、远场、紧凑体假设下，通过在延迟时间 $t_r = t - r/c$ 计算 $p_s(\\theta,t)\\,(\\boldsymbol{n}(\\theta)\\cdot \\boldsymbol{e}_r)$ 的精确方位角积分，来计算解析参考振幅 $A_{\\text{ref}}$（单位为 Pa）。可以使用积分恒等式 $\\int_0^{2\\pi} \\exp\\!\\big(\\alpha \\cos(\\theta - \\varphi_0)\\big)\\cos(\\theta - \\varphi)\\,d\\theta = 2\\pi I_1(\\alpha)\\cos(\\varphi - \\varphi_0)$，其中 $I_1(\\cdot)$ 是第一类 1 阶修正贝塞尔函数。\n- 报告每个测试案例的相对误差 $E = \\lvert A_{\\text{num}} - A_{\\text{ref}}\\rvert / \\lvert A_{\\text{ref}}\\rvert$（无量纲）。\n\n使用以下固定参数（全部采用国际单位制）：\n- 声速 $c = \\,343\\,\\mathrm{m/s}$。\n- 圆柱体半径 $R = \\,0.05\\,\\mathrm{m}$。\n- 圆柱体展长 $L_z = \\,0.5\\,\\mathrm{m}$。\n- 圆柱体速度 $U = \\,20\\,\\mathrm{m/s}$（马赫数 $M \\approx \\,0.058$；角度以弧度为单位）。\n- 观察者距离 $r = \\,30\\,\\mathrm{m}$。\n- 观察者方向 $\\varphi = \\,0.4\\,\\mathrm{rad}$。\n- 载荷方向参考 $\\varphi_0 = \\,0.1\\,\\mathrm{rad}$。\n- 压力振幅 $p_a = \\,12\\,\\mathrm{Pa}$。\n- 角频率 $\\omega = \\,2\\pi \\times 250\\,\\mathrm{rad/s}$。\n- 空间集中参数 $\\alpha = \\,1.5$。\n\n设计一个小型测试套件，通过改变不同案例中的 $N_\\theta$ 和 $\\Delta t$ 来展示网格和时间步长收敛性：\n- 案例 1：$N_\\theta = \\,8$，$\\Delta t = \\,10^{-3}\\,\\mathrm{s}$。\n- 案例 2：$N_\\theta = \\,32$，$\\Delta t = \\,2\\times 10^{-4}\\,\\mathrm{s}$。\n- 案例 3：$N_\\theta = \\,128$，$\\Delta t = \\,5\\times 10^{-5}\\,\\mathrm{s}$。\n- 案例 4：$N_\\theta = \\,64$，$\\Delta t = \\,10^{-4}\\,\\mathrm{s}$。\n\n你的程序应该生成单行输出，其中包含相对误差，形式为用方括号括起来的逗号分隔列表，顺序与测试套件中的顺序相同，例如 $[e_1,e_2,e_3,e_4]$。角度必须以弧度为单位，任何报告的振幅必须以 Pa 为单位。最终的数值输出必须是无量纲的相对误差，以实值小数表示。",
            "solution": "该问题被评估为有效。它在科学上基于已建立的 Ffowcs Williams–Hawkings (FW-H) 声学比拟，所有必要的常数和边界条件都已提供，问题提法是适定的，并且使用客观、正式的语言进行表述。\n\n声压的推导始于 Ffowcs Williams–Hawkings 方程的积分解，该方程描述了任意运动物体产生的声。对于位于均匀、静止介质中位置 $\\boldsymbol{x}$ 的静止观察者，声压扰动 $p'(\\boldsymbol{x}, t)$ 由下式给出：\n$$\n4\\pi p'(\\boldsymbol{x}, t) = \\frac{\\partial}{\\partial t} \\int_{S} \\left[ \\frac{\\rho_0 v_n}{r_*(1-M_r)} \\right]_{t_r} dS - \\frac{\\partial}{\\partial x_i} \\int_{S} \\left[ \\frac{p' n_i}{r_*(1-M_r)} \\right]_{t_r} dS + \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int_{\\mathcal{V}} \\left[ \\frac{T_{ij}}{r_*(1-M_r)} \\right]_{t_r} d\\mathcal{V}\n$$\n右侧的三项分别代表单极子（厚度）源、偶极子（载荷）源和四极子源。这里，$S$ 是物体表面，$\\rho_0$ 是环境流体密度，$v_n$ 是表面的局部法向速度，$p'$ 是表面压力扰动，$n_i$ 是外法向单位向量 $\\boldsymbol{n}$ 的分量，$T_{ij}$ 是 Lighthill 应力张量，$r_* = |\\boldsymbol{x}-\\boldsymbol{y}|$ 是从声源点 $\\boldsymbol{y}$到观察者的距离，$t_r$ 是延迟时间，$(1-M_r)^{-1}$ 是多普勒因子，其中 $M_r$ 是观察者方向上的马赫数分量。\n\n问题指明了几个简化假设：\n1.  **刚体以恒定速度平移**：圆柱体以恒定速度 $U$ 移动，因此其表面不发生变形，速度也不改变。与流体体积位移的时间导数相关的厚度噪声源贡献的是一个稳态压力场，而非非定常声。非定常声是由给定的非定常表面载荷产生的。\n2.  **低马赫数、远场、紧凑体极限**：对于低马赫数 ($M \\ll 1$)，四极子源 ($T_{ij}$) 与偶极子源相比通常可以忽略不计。在远场 ($r \\gg R$)，我们可以做几个近似。问题要求忽略对流畸变，并近似多普勒因子 $(1-M_r) \\approx 1$。分母中的距离 $r_*$ 可以用物体原点的距离 $r$ 代替。延迟时间被简化为 $t_r \\approx t - r/c$，其中 $c$ 是声速。\n\n在这些假设下，FW–H 方程简化为载荷项（偶极子源）：\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx - \\frac{\\partial}{\\partial x_i} \\int_{S} \\left[ \\frac{p_s n_i}{r} \\right]_{t=t_r} dS\n$$\n其中 $p_s$ 是给定的表面压力。空间导数 $\\partial/\\partial x_i$ 通过延迟时间 $t_r \\approx t-r/c = t - |\\boldsymbol{x}|/c$ 作用于被积函数。链式法则给出 $\\frac{\\partial}{\\partial x_i} = \\frac{\\partial t_r}{\\partial x_i} \\frac{d}{dt_r} = -\\frac{x_i}{rc} \\frac{d}{dt_r} = -\\frac{(\\boldsymbol{e}_r)_i}{c} \\frac{d}{dt_r}$，其中 $\\boldsymbol{e}_r = \\boldsymbol{x}/r$ 是指向观察者的单位向量。应用此法则并忽略以 $1/r^2$ 衰减的近场项，我们保留主导的远场辐射项：\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx - \\sum_i \\left( -\\frac{(\\boldsymbol{e}_r)_i}{c} \\right) \\int_S \\left[ \\frac{1}{r} \\frac{\\partial (p_s n_i)}{\\partial t} \\right]_{t=t_r} dS\n$$\n由于对于刚体，表面法向量 $\\boldsymbol{n}$ 不随时间变化，且观察者方向 $\\boldsymbol{e}_r$ 是固定的，我们可以写出：\n$$\n4\\pi p'(\\boldsymbol{x}, t) \\approx \\frac{1}{rc} \\boldsymbol{e}_r \\cdot \\int_S \\left[ \\frac{\\partial p_s}{\\partial t} \\boldsymbol{n} \\right]_{t=t_r} dS = \\frac{1}{rc} \\int_S \\left[ \\frac{\\partial p_s}{\\partial t} \\right]_{t=t_r} (\\boldsymbol{n} \\cdot \\boldsymbol{e}_r) dS\n$$\n此表达式可以改写为题目要求的形式，即“在延迟时间计算的面积分的时导数”：\n$$\np'(\\boldsymbol{x}, t) = \\frac{1}{4\\pi r c} \\frac{\\partial}{\\partial t} \\left[ \\int_S p_s(\\boldsymbol{y}, t) (\\boldsymbol{n}(\\boldsymbol{y}) \\cdot \\boldsymbol{e}_r) dS \\right]_{t=t_r}\n$$\n\n为求得解析参考振幅 $A_{\\text{ref}}$，我们首先计算面积分。给定 $p_s(\\theta, t) = p_a \\exp(\\alpha \\cos(\\theta - \\varphi_0)) \\cos(\\omega t)$，$\\boldsymbol{n}(\\theta) \\cdot \\boldsymbol{e}_r = \\cos(\\theta - \\varphi)$，以及 $dS = R L_z d\\theta$（在圆柱体展长 $L_z$ 上积分），该积分为：\n$$\n\\int_S p_s(\\boldsymbol{y}, t) (\\boldsymbol{n} \\cdot \\boldsymbol{e}_r) dS = R L_z p_a \\cos(\\omega t) \\int_0^{2\\pi} \\exp(\\alpha \\cos(\\theta - \\varphi_0)) \\cos(\\theta - \\varphi) d\\theta\n$$\n使用给定的恒等式 $\\int_0^{2\\pi} \\exp(\\alpha \\cos(\\theta - \\varphi_0))\\cos(\\theta - \\varphi) d\\theta = 2\\pi I_1(\\alpha)\\cos(\\varphi - \\varphi_0)$，其中 $I_1$ 是第一类 1 阶修正贝塞尔函数，表达式变为：\n$$\n2\\pi R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\cos(\\omega t)\n$$\n求时间导数并在延迟时间 $t_r = t_\\star - r/c = \\pi/(2\\omega)$ 处计算：\n$$\n\\frac{\\partial}{\\partial t}[\\dots]_{t_r} = -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\sin(\\omega t_r) = -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0)\n$$\n将此代入 $p'(\\boldsymbol{x}, t)$ 的表达式中，得到参考振幅：\n$$\nA_{\\text{ref}} = \\frac{1}{4\\pi r c} \\left( -2\\pi \\omega R L_z p_a I_1(\\alpha) \\cos(\\varphi - \\varphi_0) \\right) = - \\frac{\\omega p_a R L_z}{2 c r} I_1(\\alpha) \\cos(\\varphi - \\varphi_0)\n$$\n\n对于数值振幅 $A_{\\text{num}}$，我们对公式进行离散化。在任意时间 $t$ 的面积分使用中点法则进行近似，使用 $N_\\theta$ 个宽度为 $\\Delta\\theta = 2\\pi/N_\\theta$ 的面板，中点为 $\\theta_j = (j+0.5)\\Delta\\theta$（$j=0, \\dots, N_\\theta-1$）：\n$$\n\\int_S \\dots dS \\approx R L_z \\sum_{j=0}^{N_\\theta-1} p_s(\\theta_j, t) (\\boldsymbol{n}(\\theta_j) \\cdot \\boldsymbol{e}_r) \\Delta\\theta = \\frac{2\\pi R L_z}{N_\\theta} \\sum_{j=0}^{N_\\theta-1} p_s(\\theta_j, t) \\cos(\\theta_j - \\varphi)\n$$\n令 $I_{\\text{num}}(t)$ 表示此离散积分值。时间导数通过步长为 $\\Delta t$ 的后向有限差分进行近似：\n$$\n\\frac{\\partial}{\\partial t} [I_{\\text{num}}(t)]_{t_r} \\approx \\frac{I_{\\text{num}}(t_r) - I_{\\text{num}}(t_r - \\Delta t)}{\\Delta t}\n$$\n因此，在 $t=t_\\star$ 时的数值振幅为：\n$$\nA_{\\text{num}} = \\frac{1}{4\\pi r c \\Delta t} \\left( I_{\\text{num}}(t_r) - I_{\\text{num}}(t_r - \\Delta t) \\right)\n$$\n代入 $I_{\\text{num}}(t)$ 和 $t_r = \\pi/(2\\omega)$：\n$$\nI_{\\text{num}}(t_r) = \\frac{2\\pi R L_z p_a}{N_\\theta} \\cos(\\omega t_r) \\sum_{j=0}^{N_\\theta-1} \\exp(\\alpha \\cos(\\theta_j - \\varphi_0)) \\cos(\\theta_j - \\varphi) = 0\n$$\n因为 $\\cos(\\omega t_r) = \\cos(\\pi/2)=0$。$A_{\\text{num}}$ 的表达式简化为：\n$$\nA_{\\text{num}} = - \\frac{1}{4\\pi r c \\Delta t} I_{\\text{num}}(t_r - \\Delta t)\n$$\n$$\nA_{\\text{num}} = - \\frac{1}{4\\pi r c \\Delta t} \\left( \\frac{2\\pi R L_z p_a}{N_\\theta} \\cos(\\omega(t_r - \\Delta t)) \\sum_j \\dots \\right)\n$$\n使用 $\\cos(\\pi/2 - \\omega\\Delta t) = \\sin(\\omega\\Delta t)$，我们得到：\n$$\nA_{\\text{num}} = - \\frac{R L_z p_a}{2 r c N_\\theta \\Delta t} \\sin(\\omega\\Delta t) \\sum_{j=0}^{N_\\theta-1} \\exp(\\alpha \\cos(\\theta_j - \\varphi_0)) \\cos(\\theta_j - \\varphi)\n$$\n相对误差计算为 $E = |A_{\\text{num}} - A_{\\text{ref}}| / |A_{\\text{ref}}|$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i1\n\ndef solve():\n    \"\"\"\n    Computes the relative error of a numerical FW-H prediction against\n    an analytical solution for sound from a moving cylinder with prescribed\n    surface pressure.\n    \"\"\"\n\n    # --- Fixed Parameters (SI units) ---\n    c = 343.0           # Speed of sound (m/s)\n    R = 0.05            # Cylinder radius (m)\n    L_z = 0.5           # Cylinder span (m)\n    U = 20.0            # Cylinder speed (m/s)\n    r = 30.0            # Observer distance (m)\n    phi = 0.4           # Observer direction (rad)\n    phi_0 = 0.1         # Loading direction reference (rad)\n    p_a = 12.0          # Pressure amplitude (Pa)\n    omega = 2 * np.pi * 250.0 # Angular frequency (rad/s)\n    alpha = 1.5         # Spatial concentration parameter (dimensionless)\n\n    # --- Test Cases ---\n    test_cases = [\n        # (N_theta, delta_t)\n        (8, 1e-3),\n        (32, 2e-4),\n        (128, 5e-5),\n        (64, 1e-4),\n    ]\n\n    # --- Analytic Reference Amplitude (A_ref) ---\n    # A_ref = - (omega * p_a * R * L_z) / (2 * c * r) * I1(alpha) * cos(phi - phi_0)\n    # This value is constant for all test cases.\n    cos_phi_diff = np.cos(phi - phi_0)\n    i1_alpha = i1(alpha)\n    A_ref = - (omega * p_a * R * L_z) / (2.0 * c * r) * i1_alpha * cos_phi_diff\n    \n    results = []\n    \n    for case in test_cases:\n        N_theta, delta_t = case\n\n        # --- Numerical Amplitude (A_num) ---\n\n        # 1. Discretize the azimuthal integral using the midpoint rule\n        # theta_j are the midpoints of N_theta panels on [0, 2*pi)\n        theta_j = (np.arange(N_theta) + 0.5) * (2.0 * np.pi / N_theta)\n\n        # Integrand: exp(alpha*cos(theta-phi_0)) * cos(theta-phi)\n        integrand_values = np.exp(alpha * np.cos(theta_j - phi_0)) * np.cos(theta_j - phi)\n        \n        # The sum part of the midpoint rule\n        integral_sum = np.sum(integrand_values)\n\n        # 2. Calculate the complete A_num formula\n        # A_num = - (R*L_z*p_a)/(2*r*c*N_theta*delta_t) * sin(omega*delta_t) * sum(...)\n        factor = - (R * L_z * p_a) / (2.0 * r * c * N_theta * delta_t)\n        temporal_term = np.sin(omega * delta_t)\n        \n        A_num = factor * temporal_term * integral_sum\n\n        # 3. Compute relative error\n        if np.abs(A_ref) == 0:\n            # Avoid division by zero, though A_ref is non-zero here.\n            # If A_num is also zero, error is 0. Otherwise, it's infinite.\n            relative_error = 0.0 if np.abs(A_num) == 0 else np.inf\n        else:\n            relative_error = np.abs(A_num - A_ref) / np.abs(A_ref)\n\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}