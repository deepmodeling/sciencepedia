{
    "hands_on_practices": [
        {
            "introduction": "This first practice delves into the heart of the Lighthill analogy: the connection between the source's physical nature and the sound field it produces. By analyzing a specific quadrupole source, you will derive its far-field radiation pattern from first principles. This exercise is fundamental for understanding how the structure of the Lighthill stress tensor, $T_{ij}$, directly determines the directivity of the radiated sound .",
            "id": "4128020",
            "problem": "Consider a compressible, inviscid fluid with uniform ambient density $\\rho_{0}$ and sound speed $c_{0}$. Let $\\mathbf{x}$ denote the observer position with $r = |\\mathbf{x}|$ and unit observation vector $\\mathbf{n} = \\mathbf{x}/r$. Assume a compact source region of characteristic size $a$ satisfying $a \\ll r$ and a small Mach number $M \\ll 1$ so that linear acoustics is valid in the radiation zone. Starting from conservation of mass and momentum, and under the assumption of a homogeneous medium, derive the inhomogeneous wave equation governing the acoustic pressure fluctuation $p'(\\mathbf{x}, t)$ driven by the Lighthill stress tensor $T_{ij}(\\mathbf{y}, t)$.\n\nThe source is specified by a symmetric, time-harmonic Lighthill tensor of the form\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\nwhere $T_{0}$ is a constant amplitude, $f(t)$ is twice continuously differentiable in time, $S_{ij}$ is the constant symmetric matrix\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2} & 0 & 0 \\\\\n0 & -\\frac{1}{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\nand $g(\\mathbf{y})$ is a smooth, compactly supported function satisfying\n$$\n\\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 1, \\quad \\int_{\\mathbb{R}^{3}} y_{k}\\, g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 0 \\quad \\text{for each } k \\in \\{1,2,3\\}.\n$$\nThese integral constraints ensure no net monopole or dipole content. Let $\\theta$ denote the polar angle between $\\mathbf{n}$ and the positive $z$-axis, defined by $\\cos\\theta = n_{z}$ with $\\mathbf{n} = (n_{x}, n_{y}, n_{z})$.\n\nUnder the stated assumptions, determine the leading-order far-field angular dependence of the radiated sound due to this source. Define the normalized angular directivity factor $D(\\theta)$ such that the far-field pressure $p'(\\mathbf{x}, t)$ is proportional to $D(\\theta)$, decays as $1/r$, and depends on the retarded time through $f(t - r/c_{0})$. Normalize $D(\\theta)$ so that its maximum over $\\theta$ equals $1$.\n\nProvide $D(\\theta)$ as a single closed-form analytical expression in terms of $\\theta$. Do not include units in your final answer.",
            "solution": "The derivation begins with the fundamental equations for a compressible fluid: conservation of mass and momentum. Denote the velocity field by $\\mathbf{u}(\\mathbf{x}, t)$, the total pressure by $p(\\mathbf{x}, t)$, and the total density by $\\rho(\\mathbf{x}, t)$. Write the small-amplitude acoustic fluctuations as $p' = p - p_{0}$, $\\rho' = \\rho - \\rho_{0}$, and assume a homogeneous ambient so that $p' = c_{0}^{2}\\, \\rho'$ within linear acoustics.\n\nLighthill's acoustic analogy emerges by combining the exact continuity and momentum equations and rearranging terms to obtain an inhomogeneous wave equation for the density fluctuation:\n$$\n\\frac{\\partial^{2} \\rho'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} \\rho' = \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij},\n$$\nwhere $T_{ij}$ is the Lighthill stress tensor built from the nonlinear and viscous terms of the governing equations. Using $p' = c_{0}^{2}\\, \\rho'$, this yields the inhomogeneous wave equation for the acoustic pressure:\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} p' = c_{0}^{2}\\, \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij}.\n$$\n\nThe formal solution in free space can be expressed using the free-space Green’s function for the wave operator. A standard approach is to perform integration by parts to transfer spatial derivatives from the source to the Green’s function. In the far field with $a \\ll r$, a multipole expansion in powers of $a/r$ is valid. The leading nonvanishing term for sources with zero net monopole and dipole content is the quadrupole term. This term can be written in terms of the volume integral (the zeroth spatial moment) of $T_{ij}$:\n$$\nQ_{ij}(t) \\equiv \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y}.\n$$\nUnder the far-field approximation and after the requisite asymptotics, the leading-order radiated pressure is\n$$\np'(\\mathbf{x}, t) \\sim \\frac{1}{4\\pi\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ n_{i}\\, n_{j}\\, \\frac{Q_{ij}\\!\\left(t - \\frac{r}{c_{0}}\\right)}{c_0^2} \\right],\n$$\nwhere $\\mathbf{n} = \\mathbf{x}/r$ is the unit observation direction and $t - r/c_{0}$ is the retarded time. This form exhibits the angular dependence $n_{i}\\, n_{j}$ contracted with $Q_{ij}$, reflecting the quadrupole directivity.\n\nGiven the specified source,\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\nwith the normalization and moment conditions on $g(\\mathbf{y})$, the integrated quadrupole moment is\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t)\\, \\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t).\n$$\nTherefore,\n$$\np'(\\mathbf{x}, t) \\sim \\frac{T_{0}}{4\\pi\\, c_{0}^{2}\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ f\\!\\left(t - \\frac{r}{c_{0}}\\right)\\, n_{i}\\, n_{j}\\, S_{ij} \\right].\n$$\nThe factor $n_{i}\\, n_{j}\\, S_{ij}$ is purely angular. Define the normalized angular directivity $D(\\theta)$ to be this angular factor scaled so that its maximum over $\\theta$ is $1$. With\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2} & 0 & 0 \\\\\n0 & -\\frac{1}{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}, \\quad \\mathbf{n} = (n_{x}, n_{y}, n_{z}),\n$$\nwe compute\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, n_{x}^{2} - \\frac{1}{2}\\, n_{y}^{2} + 1 \\cdot n_{z}^{2}.\n$$\nIntroduce spherical coordinates for the observation direction,\n$$\n\\mathbf{n} = (\\sin\\theta\\, \\cos\\phi,\\, \\sin\\theta\\, \\sin\\phi,\\, \\cos\\theta),\n$$\nso that\n$$\nn_{x}^{2} + n_{y}^{2} = \\sin^{2}\\theta, \\quad n_{z}^{2} = \\cos^{2}\\theta.\n$$\nThen\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, \\sin^{2}\\theta + \\cos^{2}\\theta = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\nThe maximum of this function over $\\theta$ occurs at $\\theta = 0$ (the positive $z$-axis), where it equals\n$$\n\\frac{3}{2}\\cdot 1 - \\frac{1}{2} = 1,\n$$\nso it is already normalized to have unit maximum. Hence, the normalized angular directivity factor is\n$$\nD(\\theta) = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\nThis is the classical quadrupole directivity proportional to the second Legendre polynomial $P_{2}(\\cos\\theta)$, consistent with the specified symmetric traceless source structure and the multipole expansion of the Lighthill analogy in the far field.",
            "answer": "$$\\boxed{\\frac{3}{2}\\cos^{2}\\theta - \\frac{1}{2}}$$"
        },
        {
            "introduction": "Real-world acoustic sources, such as turbulent eddies in a jet, are rarely stationary. This exercise explores the critical effect of source motion by asking you to derive the famous Doppler shift formula from the retarded-time solution of the Lighthill equation. Mastering this derivation provides a deep understanding of how source convection fundamentally alters the observed frequency of sound .",
            "id": "4128001",
            "problem": "Consider an inviscid, isentropic, compressible fluid with ambient density $\\rho_0$ and constant sound speed $c$. Starting from the compressible continuity equation and the momentum equation (the compressible Navier–Stokes equations), construct the inhomogeneous acoustic wave equation associated with Lighthill’s acoustic analogy for the density perturbation $\\,\\rho'(\\mathbf{x}, t)\\,$, explicitly incorporating a compact external body-force density $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$ that is localized around a source point $\\,\\mathbf{x}_s(t)\\,$ and moves at constant velocity $\\,\\mathbf{U} = U\\,\\hat{\\mathbf{x}}\\,$ with subsonic Mach number $\\,M = U/c < 1\\,$. Assume $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$ produces zero net force and therefore acts as a dipole-like source with a compact support whose characteristic size is much smaller than the acoustic wavelength.\n\nUsing the free-space Green’s function of the acoustic wave operator, write the retarded-time representation of the radiated field and, under the compact-source (far-field) approximation, analyze the time dependence of the received signal at a fixed observer location $\\,\\mathbf{x}\\,$, which is at a large distance from the source compared to its size. Let $\\,\\theta\\,$ be the angle (in radians) between the source velocity direction $\\,\\hat{\\mathbf{x}}\\,$ and the line of sight from the instantaneous source position to the observer. The dipole moment in the source rest frame oscillates harmonically with angular frequency $\\,\\omega_0\\,$.\n\nDerive, from first principles and without invoking any pre-tabulated Doppler formulas, the closed-form expression for the observed angular frequency $\\,\\omega_{\\mathrm{obs}}\\,$ in terms of $\\,\\omega_0\\,$, $\\,M\\,$, and $\\,\\theta\\,$, by carefully accounting for convection through the retarded-time dependence. Your derivation must begin from the governing equations and proceed logically to the retarded-time mapping and its implication for the instantaneous phase observed at $\\,\\mathbf{x}\\,$.\n\nProvide your final answer as a single analytic expression for $\\,\\omega_{\\mathrm{obs}}\\,$ in radians per second. No numerical evaluation is required.",
            "solution": "The task is to derive the expression for the observed angular frequency $\\omega_{\\mathrm{obs}}$ of sound from a moving dipole source, starting from the fundamental equations of fluid dynamics and adhering to the principles of Lighthill's acoustic analogy.\n\nThe derivation proceeds in three main steps:\n1.  Establish the inhomogeneous acoustic wave equation for the density perturbation $\\rho'$ generated by an external body-force density $\\mathbf{b}$.\n2.  Analyze the structure of the retarded-time solution to this equation to establish a relationship between the phase of the observed signal and the phase of the source at the time of emission.\n3.  Perform a kinematic analysis of the retarded-time relationship to determine the mapping between the source time and observer time, which directly yields the Doppler frequency shift.\n\n**Step 1: The Inhomogeneous Acoustic Wave Equation**\n\nWe begin with the compressible continuity and momentum equations for an inviscid fluid subject to an external body-force density $\\mathbf{b}(\\mathbf{x}, t)$.\n\nThe continuity equation is:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nThe momentum equation (compressible Euler equation with a body force) is:\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I}) = \\mathbf{b}\n$$\nwhere $\\rho$ is the fluid density, $\\mathbf{u}$ is the fluid velocity, $p$ is the pressure, and $\\mathbf{I}$ is the identity tensor.\n\nWe consider small perturbations around a quiescent, uniform ambient state characterized by density $\\rho_0$, pressure $p_0$, and zero velocity ($\\mathbf{u}_0 = \\mathbf{0}$). The perturbations are defined as $\\rho' = \\rho - \\rho_0$ and $p' = p - p_0$. The problem states the fluid is isentropic, which implies a direct relationship between pressure and density perturbations, $p' = c^2 \\rho'$, where $c$ is the constant speed of sound.\n\nTo derive the wave equation, we take the time derivative of the continuity equation and the divergence of the momentum equation.\nTime derivative of continuity:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] = 0\n$$\nDivergence of momentum:\n$$\n\\nabla \\cdot \\left[ \\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} \\right] + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I})] = \\nabla \\cdot \\mathbf{b}\n$$\nAssuming sufficient smoothness, we can interchange the temporal and spatial derivatives:\n$$\n\\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] + \\nabla^2 p + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = \\nabla \\cdot \\mathbf{b}\n$$\nwhere $\\nabla^2 p = \\nabla \\cdot (\\nabla p)$. Subtracting the time-differentiated continuity equation from this result eliminates the term involving $\\rho \\mathbf{u}$:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p - \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = -\\nabla \\cdot \\mathbf{b}\n$$\nThis is an exact equation. Lighthill's acoustic analogy proceeds by rearranging this equation into the form of an inhomogeneous wave equation. Let's move all terms except the wave operator to the right-hand side:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2(p - c^2 \\rho) + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] - \\nabla \\cdot \\mathbf{b}\n$$\nSubstituting $\\rho = \\rho_0 + \\rho'$ and noting that $\\frac{\\partial^2 \\rho_0}{\\partial t^2} - c^2 \\nabla^2 \\rho_0 = 0$ for a uniform ambient state, we get:\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} - \\frac{\\partial b_i}{\\partial x_i}\n$$\nwhere $T_{ij} = \\rho u_i u_j + (p - p_0 - c^2 \\rho')\\delta_{ij}$ is the Lighthill stress tensor. For sound generated primarily by the external force $\\mathbf{b}$ rather than by the fluid's self-motion (e.g., turbulence), the dominant source term is the one involving $\\mathbf{b}$. This is equivalent to considering the linearized limit where terms like $\\rho u_i u_j$ are neglected. The linearized wave equation is:\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = - \\nabla \\cdot \\mathbf{b}(\\mathbf{x}, t)\n$$\nThis is the governing inhomogeneous wave equation for the density perturbation generated by the body force.\n\n**Step 2: Retarded-Time Solution and Phase Analysis**\n\nThe solution to this wave equation can be formally expressed using the free-space Green's function for the wave operator $\\frac{\\partial^2}{\\partial t^2} - c^2 \\nabla^2$. The fundamental property of this solution is causality, embodied in the concept of retarded time. The field $\\rho'(\\mathbf{x}, t)$ at an observer location $\\mathbf{x}$ and time $t$ is determined by the state of the source at an earlier emission time $\\tau$.\n\nFor a compact source whose center of volume is at position $\\mathbf{x}_s(\\tau)$ at the emission time $\\tau$, the reception time $t$ is related to the emission time $\\tau$ by:\n$$\nt = \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c}\n$$\nThis equation states that the signal received at time $t$ was emitted at time $\\tau$ and traveled the distance $|\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ at the speed of sound $c$.\n\nThe problem states that the source's dipole moment oscillates harmonically with an angular frequency $\\omega_0$ in its rest frame. This means that the time dependence of the source function $\\mathbf{b}$ is governed by a phase $\\phi_s(\\tau) = \\omega_0 \\tau$. Because the entire acoustic field $\\rho'(\\mathbf{x}, t)$ is generated by this source, the phase of the signal received by the observer at time $t$ must correspond to the phase of the source at the moment of emission, $\\tau$.\nTherefore, the phase of the observed signal is given by:\n$$\n\\phi_{\\mathrm{obs}}(t) = \\phi_s(\\tau(t)) = \\omega_0 \\tau(t)\n$$\nHere, $\\tau(t)$ is the emission time corresponding to the reception time $t$, as defined by the retarded-time equation.\n\n**Step 3: Kinematic Derivation of the Observed Frequency**\n\nThe observed angular frequency, $\\omega_{\\mathrm{obs}}$, is defined as the time rate of change of the observed phase:\n$$\n\\omega_{\\mathrm{obs}} = \\frac{d\\phi_{\\mathrm{obs}}}{dt} = \\frac{d}{dt} [\\omega_0 \\tau(t)] = \\omega_0 \\frac{d\\tau}{dt}\n$$\nTo find $\\omega_{\\mathrm{obs}}$, we must calculate the derivative $\\frac{d\\tau}{dt}$. We achieve this by differentiating the retarded-time equation implicitly with respect to $t$:\n$$\n\\frac{d}{dt}(t) = \\frac{d}{dt} \\left( \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c} \\right)\n$$\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\frac{d}{dt}|\\mathbf{x} - \\mathbf{x}_s(\\tau)|\n$$\nUsing the chain rule on the second term, $\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}$:\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\left( \\frac{d\\tau}{dt} \\frac{d}{d\\tau}|\\mathbf{x} - \\mathbf{x}_s(\\tau)| \\right)\n$$\nFactoring out $\\frac{d\\tau}{dt}$:\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 + \\frac{1}{c} \\frac{d}{d\\tau} R(\\tau) \\right)\n$$\nwhere $R(\\tau) = |\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ is the distance from the source to the observer at the time of emission.\n\nNext, we evaluate the derivative $\\frac{dR}{d\\tau}$. We start with $R^2(\\tau) = (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot (\\mathbf{x} - \\mathbf{x}_s(\\tau))$. Differentiating with respect to $\\tau$:\n$$\n2R \\frac{dR}{d\\tau} = 2 (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot \\left( -\\frac{d\\mathbf{x}_s}{d\\tau} \\right)\n$$\nThe source moves at a constant velocity $\\mathbf{U}$, so $\\frac{d\\mathbf{x}_s}{d\\tau} = \\mathbf{U}$.\n$$\n\\frac{dR}{d\\tau} = -\\frac{\\mathbf{x} - \\mathbf{x}_s(\\tau)}{R} \\cdot \\mathbf{U} = -\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}\n$$\nwhere $\\hat{\\mathbf{R}}(\\tau)$ is the unit vector pointing from the source's position at emission time $\\tau$ towards the fixed observer.\n\nSubstituting this result back into the equation for $\\frac{d\\tau}{dt}$:\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} \\right)\n$$\nSolving for $\\frac{d\\tau}{dt}$:\n$$\n\\frac{d\\tau}{dt} = \\frac{1}{1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c}}\n$$\nThe problem defines $\\theta$ as the angle between the source velocity direction $\\hat{\\mathbf{x}}$ (where $\\mathbf{U} = U\\hat{\\mathbf{x}}$) and the line of sight to the observer, which is the direction of $\\hat{\\mathbf{R}}(\\tau)$. Thus, the dot product is:\n$$\n\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U} = |\\hat{\\mathbf{R}}(\\tau)| |\\mathbf{U}| \\cos\\theta = U \\cos\\theta\n$$\nThe term in the denominator becomes:\n$$\n\\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} = \\frac{U \\cos\\theta}{c} = M \\cos\\theta\n$$\nwhere $M=U/c$ is the subsonic Mach number.\n\nFinally, we substitute this into the expression for the observed angular frequency:\n$$\n\\omega_{\\mathrm{obs}} = \\omega_0 \\frac{d\\tau}{dt} = \\omega_0 \\left( \\frac{1}{1 - M \\cos\\theta} \\right) = \\frac{\\omega_0}{1 - M \\cos\\theta}\n$$\nThis is the classical Doppler shift formula for a moving source and a stationary observer, derived from first principles as required.",
            "answer": "$$\n\\boxed{\\frac{\\omega_0}{1 - M \\cos\\theta}}\n$$"
        },
        {
            "introduction": "To bridge the gap between theoretical derivation and practical application, this final practice challenges you to implement the far-field quadrupole radiation formula in code. You will build a computational tool to predict the acoustic pressure from various canonical quadrupole sources, providing a tangible sense of how analytical solutions are used for benchmarking and prediction. This hands-on coding exercise is invaluable for developing skills in computational acoustics and validating theoretical models .",
            "id": "4127999",
            "problem": "Consider the inhomogeneous acoustic wave radiation in an unbounded, homogeneous, stationary fluid of uniform density and sound speed. You are asked to construct and implement a canonical validation case and analytic benchmark for Lighthill's acoustic analogy at advanced graduate level. The fundamental base must be the conservation of mass and momentum for a compressible fluid, Newton's laws, linear acoustics for small-amplitude perturbations, and free-space radiation in three dimensions. Starting only from these principles, derive the radiated far-field acoustic pressure caused by a compact, time-harmonic quadrupolar source located at the origin.\n\nBegin with the compressible conservation laws written in index notation using the Einstein summation convention. Let $x_i$ denote the Cartesian coordinates ($i \\in \\{1,2,3\\}$), $t$ denote time, $\\rho$ denote density, $u_i$ denote velocity components, $p$ denote pressure, and $\\sigma_{ij}$ denote the viscous stress tensor. Use the small-perturbation linear acoustics relation $p' = c^2 \\rho'$ for acoustic fluctuations, where $c$ is the sound speed and a prime denotes acoustic perturbation. From this base, derive an inhomogeneous acoustic wave equation in free space for the radiated field. Then, by selecting an appropriate free-space Green's function (Green's function (GF)) and invoking the compact-source approximation with observation distance $r$ much larger than the source size, reduce the volume-integral solution to a far-field expression that depends on the volume integral of the Lighthill source term contracted with the radiation direction.\n\nDefine the canonical source for benchmarking as follows. The volume-integrated Lighthill stress tensor is\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}},\n$$\nand, for the benchmark, assume a time-harmonic form\n$$\nQ_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t),\n$$\nwhere $Q_0$ is a constant amplitude with units of newton-meter, $\\omega$ is an angular frequency in radians per second, and $S_{ij}$ is a constant, symmetric, dimensionless pattern tensor that encodes the quadrupole orientation. Let $\\mathbf{x}$ be the observer location, $r = \\|\\mathbf{x}\\|$, and $\\mathbf{n} = \\mathbf{x}/r$ be the radiation unit vector. You must use the free-space radiation solution evaluated at the retarded time $t_r = t - r/c$. The goal is to compute the far-field acoustic pressure $p'(\\mathbf{x}, t)$ in pascals at specified $(\\mathbf{x}, t)$ and source parameters.\n\nImplement a complete, runnable program that:\n- Constructs $S_{ij}$ for three benchmark patterns:\n  - A diagonal quadrupole aligned with the $x$-axis, with $S_{11} = 1$ and all other components equal to $0$.\n  - A symmetric off-diagonal quadrupole with $S_{12} = S_{21} = 1$ and all other components equal to $0$.\n  - An isotropic pattern with $S_{ij} = \\delta_{ij}$.\n- Computes the far-field compact-source acoustic pressure $p'(\\mathbf{x}, t)$ using physically consistent free-space radiation with retarded time, sound speed, and the $1/r$ decay in three dimensions.\n- Expresses the final results in pascals.\n\nDesign your algorithm to evaluate the following test suite. In all cases, answer in pascals, as a float. Use $c = 343$ $\\mathrm{m/s}$ unless otherwise specified. For each case, the observation coordinate $\\mathbf{x}$ is given in meters, the time $t$ in seconds, the amplitude $Q_0$ in newton-meter, and the angular frequency $\\omega$ in radians per second.\n\nTest suite:\n1. Happy path compact diagonal quadrupole: $S_{11} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (1, 2, 2)$; $t = 0.001$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 1000$; $c = 343$.\n2. Isotropic compact quadrupole: $S_{ij} = \\delta_{ij}$; $\\mathbf{x} = (3, 4, 0)$; $t = 0.002$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 500$; $c = 343$.\n3. Geometric null for off-diagonal symmetric quadrupole: $S_{12} = S_{21} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (0, 0, 5)$; $t = 0.010$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 200$; $c = 343$.\n4. Zero-frequency boundary case: $S_{11} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (10, 0, 0)$; $t = 1.000$; $Q_0 = 10^{-3}$; $\\omega = 0$; $c = 343$.\n5. Extreme far field isotropic quadrupole: $S_{ij} = \\delta_{ij}$; $\\mathbf{x} = (1000, 0, 0)$; $t = 0.100$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 50$; $c = 343$.\n\nYour program must implement the far-field compact-source solution derived from Lighthill's acoustic analogy and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $[p_1, p_2, p_3, p_4, p_5]$, where each $p_k$ is the computed float in pascals for case $k$.",
            "solution": "### Step 1: Extract Givens\n- **Fundamental Principles**: Conservation of mass and momentum for a compressible fluid; Newton's laws.\n- **Constitutive Relation**: Linear acoustics relation for small-amplitude perturbations, $p' = c^2 \\rho'$, where $p'$ is acoustic pressure, $\\rho'$ is acoustic density, and $c$ is the sound speed.\n- **Problem Domain**: Unbounded, homogeneous, stationary fluid of uniform density and sound speed.\n- **Source Type**: Compact, time-harmonic quadrupolar source at the origin.\n- **Approximations**: Far-field observation ($r \\gg$ source size) and compact source ($L \\ll \\lambda$).\n- **Objective**: Derive the far-field acoustic pressure $p'(\\mathbf{x}, t)$ and implement a program to compute it for specific cases.\n- **Source Definition**: The volume-integrated Lighthill stress tensor is $Q_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}}$, with a time-harmonic form $Q_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t)$. $Q_0$ is an amplitude, $\\omega$ is angular frequency, and $S_{ij}$ is a constant, symmetric, dimensionless pattern tensor.\n- **Solution Form**: Must use the free-space Green's function, retarded time $t_r = t - r/c$, and exhibit $1/r$ decay.\n- **Benchmark Patterns for $S_{ij}$**:\n    1. Diagonal: $S_{11} = 1$, others $0$.\n    2. Off-diagonal symmetric: $S_{12} = S_{21} = 1$, others $0$.\n    3. Isotropic: $S_{ij} = \\delta_{ij}$.\n- **Test Suite Parameters**:\n    1. $S$: Diagonal, $\\mathbf{x} = (1, 2, 2)$ m, $t = 0.001$ s, $Q_0 = 10^{-3}$ N·m, $\\omega = 2\\pi \\cdot 1000$ rad/s, $c = 343$ m/s.\n    2. $S$: Isotropic, $\\mathbf{x} = (3, 4, 0)$ m, $t = 0.002$ s, $Q_0 = 10^{-3}$ N·m, $\\omega = 2\\pi \\cdot 500$ rad/s, $c = 343$ m/s.\n    3. $S$: Off-diagonal, $\\mathbf{x} = (0, 0, 5)$ m, $t = 0.010$ s, $Q_0 = 10^{-3}$ N·m, $\\omega = 2\\pi \\cdot 200$ rad/s, $c = 343$ m/s.\n    4. $S$: Diagonal, $\\mathbf{x} = (10, 0, 0)$ m, $t = 1.000$ s, $Q_0 = 10^{-3}$ N·m, $\\omega = 0$ rad/s, $c = 343$ m/s.\n    5. $S$: Isotropic, $\\mathbf{x} = (1000, 0, 0)$ m, $t = 0.100$ s, $Q_0 = 10^{-3}$ N·m, $\\omega = 2\\pi \\cdot 50$ rad/s, $c = 343$ m/s.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is founded on the exact conservation laws of fluid mechanics (mass and momentum), which are fundamental principles. The derivation of Lighthill's acoustic analogy from these laws is a standard and cornerstone result in aeroacoustics. The use of a free-space Green's function to solve the resulting inhomogeneous wave equation is a mathematically rigorous technique. All concepts are well-established in physics and engineering.\n- **Well-Posed**: The problem is clearly defined. It specifies the governing equations, the medium, the source characteristics, the observer location, and the desired output quantity ($p'$). The far-field and compact-source approximations are standard assumptions that lead to a unique and well-defined analytical solution.\n- **Objective**: The problem is stated in precise, unbiased, mathematical, and physical language. There are no subjective or opinion-based elements.\n- **Flaw Checklist**:\n    1.  **Scientific/Factual Unsoundness**: The original derivation logic was flawed. It started from an incorrect wave equation but jumped to the correct final formula, which is a significant inconsistency. This has been corrected.\n    2.  **Non-Formalizable/Irrelevant**: None. The problem is a formal derivation and computation directly relevant to the topic of Lighthill's acoustic analogy.\n    3.  **Incomplete/Contradictory Setup**: None. All necessary constants, variables, and conditions for the derivation and the test cases are provided and are self-consistent.\n    4.  **Unrealistic/Infeasible**: The setup is an idealization (e.g., unbounded fluid, point-like compact source), but it is a standard canonical problem used for validation and benchmarking. It is not physically impossible or implausible in this theoretical context.\n    5.  **Ill-Posed/Poorly Structured**: None. The problem structure leads to a unique solution.\n    6.  **Pseudo-Profound/Trivial**: None. The derivation from first principles is a non-trivial exercise requiring a solid understanding of fluid dynamics and wave physics, typical of a graduate-level problem.\n    7.  **Outside Scientific Verifiability**: None. The result is a physically measurable quantity (pressure) that can be calculated and verified.\n\n### Step 3: Verdict and Action\nThe problem is valid and well-posed, but its original solution contained a flawed derivation. I have corrected the derivation to be scientifically sound and consistent with the rest of the article.\n\n### Derivation of the Far-Field Quadrupole Radiation Formula\n\nAs established in the main text, Lighthill's analogy recasts the exact conservation laws of fluid motion into an inhomogeneous wave equation. Starting from the conservation of mass and momentum and using the acoustic relation $p' = c^2 \\rho'$, the governing equation for the acoustic pressure perturbation $p'$ can be written as:\n$$ \\left(\\frac{\\partial^2}{\\partial t^2} - c^2\\nabla^2\\right)p' = c^2 \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} $$\nwhere $T_{ij} = \\rho u_i u_j + (p' - c^2 \\rho')\\delta_{ij} - \\sigma_{ij}$ is the Lighthill stress tensor. This equation describes how the sources on the right-hand side generate sound waves.\n\nThe solution in an unbounded domain is found by convolving the source term with the free-space Green's function. By transferring the spatial derivatives from the source term to the Green's function and applying standard far-field ($r \\gg$ source size) and compact-source approximations, the solution for the acoustic pressure generated by a quadrupole source reduces to a standard result in aeroacoustics:\n$$ p'(\\mathbf{x}, t) \\approx \\frac{n_i n_j}{4\\pi r c^2} \\frac{d^2}{dt^2} \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t-r/c) d^3\\mathbf{y} $$\nwhere $n_i = x_i/r$ is the radiation direction vector. This simplifies to:\n$$ p'(\\mathbf{x}, t) = \\frac{n_i n_j}{4\\pi r c^2} \\ddot{Q}_{ij}(t - r/c) $$\nwhere $Q_{ij}(t)$ is the volume-integrated Lighthill tensor.\n\nFor the specified time-harmonic source, $Q_{ij}(t) = Q_0 S_{ij} \\cos(\\omega t)$. Its second time derivative is:\n$$ \\ddot{Q}_{ij}(t) = -Q_0 \\omega^2 S_{ij} \\cos(\\omega t) $$\nSubstituting this into the far-field pressure formula and evaluating at the retarded time $t_r = t - r/c$ gives the final expression for implementation:\n$$ p'(\\mathbf{x}, t) = -\\frac{Q_0 \\omega^2}{4\\pi r c^2} (n_i S_{ij} n_j) \\cos(\\omega(t - r/c)) $$\nThe term $n_i S_{ij} n_j$ is the quadrupole directivity pattern, a scalar computed from the contraction of the radiation vector $\\mathbf{n}$ with the source tensor $S_{ij}$.\n\n### Algorithmic Design\nThe program will implement the final formula derived above for each of the five test cases. A helper function will compute the pressure given the source parameters and observer location.\n\n1.  For each test case, define the parameters: observer position $\\mathbf{x}$, time $t$, source amplitude $Q_0$, angular frequency $\\omega$, sound speed $c$, and the source pattern tensor $S_{ij}$.\n2.  Calculate the observer distance $r = \\|\\mathbf{x}\\|$.\n3.  If $r=0$, the pressure is singular; however, all test cases have $r>0$.\n4.  Calculate the radiation unit vector $\\mathbf{n} = \\mathbf{x}/r$.\n5.  Calculate the directivity term $D = n_i S_{ij} n_j = \\mathbf{n}^T \\mathbf{S} \\mathbf{n}$.\n6.  Calculate the retarded time phase angle $\\theta = \\omega (t - r/c)$.\n7.  Calculate the pressure amplitude factor, which includes the $1/r$ decay and $\\omega^2$ dependence.\n8.  Combine these components to find the acoustic pressure $p'(\\mathbf{x}, t)$. For the edge case $\\omega=0$, the pressure is zero, which the formula correctly handles.\n\nThis procedure will be applied to each case in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the far-field acoustic pressure for a set of canonical\n    Lighthill quadrupole source test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([1.0, 2.0, 2.0]),\n            \"t\": 0.001,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 1000,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([3.0, 4.0, 0.0]),\n            \"t\": 0.002,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 500,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"off_diagonal\",\n            \"x\": np.array([0.0, 0.0, 5.0]),\n            \"t\": 0.010,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 200,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([10.0, 0.0, 0.0]),\n            \"t\": 1.000,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 0,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([1000.0, 0.0, 0.0]),\n            \"t\": 0.100,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 50,\n            \"c\": 343.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_prime = calculate_far_field_pressure(\n            x=case[\"x\"],\n            t=case[\"t\"],\n            Q0=case[\"Q0\"],\n            omega=2 * np.pi * case[\"omega_hz\"],\n            c=case[\"c\"],\n            pattern=case[\"pattern\"],\n        )\n        results.append(p_prime)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\ndef calculate_far_field_pressure(x: np.ndarray, t: float, Q0: float, omega: float, c: float, pattern: str) -> float:\n    \"\"\"\n    Calculates the far-field acoustic pressure from a compact quadrupole source\n    based on Lighthill's acoustic analogy.\n\n    The formula used is:\n    p'(x, t) = - (Q0 * omega^2) / (4 * pi * r * c^2) * (n^T * S * n) * cos(omega * (t - r/c))\n    \"\"\"\n    \n    # Construct the dimensionless pattern tensor S_ij\n    S = np.zeros((3, 3))\n    if pattern == \"diagonal\":\n        S[0, 0] = 1.0\n    elif pattern == \"off_diagonal\":\n        S[0, 1] = 1.0\n        S[1, 0] = 1.0\n    elif pattern == \"isotropic\":\n        S = np.identity(3)\n\n    # Handle the zero-frequency case directly to avoid division by zero if omega is in a denominator.\n    if omega == 0.0:\n        return 0.0\n\n    # Calculate geometric terms: distance r and radiation unit vector n\n    r = np.linalg.norm(x)\n    if r == 0.0:\n        # Pressure is singular at the origin. For this problem, r > 0.\n        return np.inf\n    n = x / r\n\n    # Calculate the quadrupole directivity term (n_i * S_ij * n_j)\n    # Using numpy's @ operator for matrix-vector multiplication: n.T @ S @ n\n    directivity = n @ S @ n\n    \n    # If directivity is zero (geometric null), pressure is zero\n    if directivity == 0.0:\n        return 0.0\n\n    # Calculate the amplitude factor\n    amplitude_factor = -(Q0 * omega**2) / (4 * np.pi * r * c**2)\n    \n    # Calculate the retarded time argument of the cosine term\n    retarded_time_arg = omega * (t - r / c)\n\n    # Calculate the final acoustic pressure\n    pressure = amplitude_factor * directivity * np.cos(retarded_time_arg)\n    \n    return pressure\n\nsolve()\n```"
        }
    ]
}