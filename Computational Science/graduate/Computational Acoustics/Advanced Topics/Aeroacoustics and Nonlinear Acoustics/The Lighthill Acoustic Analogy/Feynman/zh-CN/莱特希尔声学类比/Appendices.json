{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的流动声学问题之前，我们必须首先掌握最核心的概念：声源的结构如何决定其辐射声场的方向性。本练习将引导你从流体动力学基本守恒定律出发，推导一个典型的四极子声源所产生的远场声压方向性。通过这个实践()，你将深刻理解Lighthill应力张量的物理意义，并学会如何将声源的张量特性与最终的声辐射模式联系起来。",
            "id": "4128020",
            "problem": "考虑一具有均匀环境密度 $\\rho_{0}$ 和声速 $c_{0}$ 的可压缩无粘性流体。令 $\\mathbf{x}$ 表示观测点位置，其中 $r = |\\mathbf{x}|$，单位观测向量为 $\\mathbf{n} = \\mathbf{x}/r$。假设声源区是紧凑的，其特征尺寸 $a$ 满足 $a \\ll r$，且马赫数 $M \\ll 1$ 很小，因此线性声学在辐射区内成立。从质量和动量守恒出发，在均匀介质的假设下，推导由 Lighthill 应力张量 $T_{ij}(\\mathbf{y}, t)$ 驱动的声压脉动 $p'(\\mathbf{x}, t)$ 所满足的非齐次波动方程。\n\n声源由一个对称、时谐的 Lighthill 张量指定，其形式为\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\n其中 $T_{0}$ 是一个恒定振幅，$f(t)$ 是关于时间二阶连续可微的函数，$S_{ij}$ 是常对称矩阵\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2}  & 0  & 0 \\\\\n0  & -\\frac{1}{2}  & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix},\n$$\n并且 $g(\\mathbf{y})$ 是一个满足以下条件的光滑紧支集函数\n$$\n\\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 1, \\quad \\int_{\\mathbb{R}^{3}} y_{k}\\, g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 0 \\quad \\text{对每个 } k \\in \\{1,2,3\\}。\n$$\n这些积分约束确保了没有净单极子或偶极子成分。令 $\\theta$ 表示 $\\mathbf{n}$ 与 z 轴正方向之间的极角，定义为 $\\cos\\theta = n_{z}$，其中 $\\mathbf{n} = (n_{x}, n_{y}, n_{z})$。\n\n在所述假设下，确定该声源产生的辐射声的远场主阶角向依赖性。定义归一化角向指向性因子 $D(\\theta)$，使得远场压力 $p'(\\mathbf{x}, t)$ 与 $D(\\theta)$ 成正比，按 $1/r$ 衰减，并通过 $f(t - r/c_{0})$ 依赖于推迟时间。对 $D(\\theta)$进行归一化，使其关于 $\\theta$ 的最大值为 1。\n\n以 $\\theta$ 的单一闭式解析表达式形式给出 $D(\\theta)$。最终答案中不要包含单位。",
            "solution": "推导始于可压缩流体的基本方程：质量守恒和动量守恒。将速度场记为 $\\mathbf{u}(\\mathbf{x}, t)$，总压力记为 $p(\\mathbf{x}, t)$，总密度记为 $\\rho(\\mathbf{x}, t)$。将小振幅声学脉动写为 $p' = p - p_{0}$、$\\rho' = \\rho - \\rho_{0}$，并假设环境是均匀的，因此在线性声学范围内有 $p' = c_{0}^{2}\\, \\rho'$。\n\n通过联立精确的连续性方程和动量方程，并重新整理各项，可以得到 Lighthill 声学类比，即关于密度脉动的非齐次波动方程：\n$$\n\\frac{\\partial^{2} \\rho'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} \\rho' = \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij},\n$$\n其中 $T_{ij}$ 是由控制方程的非线性项和粘性项构成的 Lighthill 应力张量。使用 $p' = c_{0}^{2}\\, \\rho'$，可以得到声压的非齐次波动方程：\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} p' = c_{0}^{2}\\, \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij}.\n$$\n\n在自由空间中的形式解可以用波动算子的自由空间格林函数来表示。一种标准方法是进行分部积分，将源项上的空间导数转移到格林函数上。在远场中，$a \\ll r$，按 $a/r$ 的幂次进行多极子展开是有效的。对于净单极子和偶极子成分为零的声源，主导非零项是四极子项。该项可以用 $T_{ij}$ 的体积分（零阶空间矩）来表示：\n$$\nQ_{ij}(t) \\equiv \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y}.\n$$\n在远场近似下，并经过必要的渐近分析后，主阶辐射压力为\n$$\np'(\\mathbf{x}, t) \\sim \\frac{1}{4\\pi\\, c_{0}^{2}\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ n_{i}\\, n_{j}\\, Q_{ij}\\!\\left(t - \\frac{r}{c_{0}}\\right) \\right],\n$$\n其中 $\\mathbf{n} = \\mathbf{x}/r$ 是单位观测方向，$t - r/c_{0}$ 是推迟时间。这种形式显示了与 $Q_{ij}$ 缩并的角向依赖性 $n_{i}\\, n_{j}$，反映了四极子指向性。\n\n对于指定的声源，\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\n根据对 $g(\\mathbf{y})$ 的归一化和矩条件，积分四极子矩为\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t)\\, \\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t).\n$$\n因此，\n$$\np'(\\mathbf{x}, t) \\sim \\frac{T_{0}}{4\\pi\\, c_{0}^{2}\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ f\\!\\left(t - \\frac{r}{c_{0}}\\right)\\, n_{i}\\, n_{j}\\, S_{ij} \\right].\n$$\n因子 $n_{i}\\, n_{j}\\, S_{ij}$ 纯粹是角度的函数。定义归一化角向指向性 $D(\\theta)$ 为此角向因子，并进行缩放使其关于 $\\theta$ 的最大值为 1。根据\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2}  & 0  & 0 \\\\\n0  & -\\frac{1}{2}  & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix}, \\quad \\mathbf{n} = (n_{x}, n_{y}, n_{z}),\n$$\n我们计算\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, n_{x}^{2} - \\frac{1}{2}\\, n_{y}^{2} + 1 \\cdot n_{z}^{2}.\n$$\n为观测方向引入球坐标，\n$$\n\\mathbf{n} = (\\sin\\theta\\, \\cos\\phi,\\, \\sin\\theta\\, \\sin\\phi,\\, \\cos\\theta),\n$$\n于是\n$$\nn_{x}^{2} + n_{y}^{2} = \\sin^{2}\\theta, \\quad n_{z}^{2} = \\cos^{2}\\theta.\n$$\n那么\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, \\sin^{2}\\theta + \\cos^{2}\\theta = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\n此函数关于 $\\theta$ 的最大值在 $\\theta = 0$（z 轴正方向）处取得，其值为\n$$\n\\frac{3}{2}\\cdot 1 - \\frac{1}{2} = 1,\n$$\n因此它已经被归一化，最大值为 1。因此，归一化角向指向性因子为\n$$\nD(\\theta) = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\n这就是经典的四极子指向性，与二阶勒让德多项式 $P_{2}(\\cos\\theta)$ 成正比，这与指定的对称无迹源结构以及远场中 Lighthill 类比的多极子展开是一致的。",
            "answer": "$$\\boxed{\\frac{3}{2}\\cos^{2}\\theta - \\frac{1}{2}}$$"
        },
        {
            "introduction": "在真实世界的许多场景中，声源并非静止不动，而是相对于观察者在运动。这个练习将探讨声源运动对声波传播的影响，特别是多普勒效应。你将从基本方程和延迟时间 ($retarded-time$) 的概念出发，一步步推导出运动声源的观测频率公式()，而不是简单地套用现有结论。这个过程将加深你对波传播运动学以及Lighthill声学类比中时间尺度变换的理解。",
            "id": "4128001",
            "problem": "考虑一种无粘性、等熵的可压缩流体，其环境密度为 $\\rho_0$，声速 $c$ 为常数。从可压缩流体的连续性方程和动量方程（即可压缩纳维-斯托克斯方程）出发，构建与 Lighthill 声学类比相关的、针对密度扰动 $\\,\\rho'(\\mathbf{x}, t)\\,$ 的非齐次声波方程。方程应显式地包含一个紧凑的外部体力密度 $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$，该体力密度局域在源点 $\\,\\mathbf{x}_s(t)\\,$ 周围，并以亚音速马赫数 $\\,M = U/c \\ll 1\\,$ 的恒定速度 $\\,\\mathbf{U} = U\\,\\hat{\\mathbf{x}}\\,$ 运动。假设 $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$ 产生的合力为零，因此它作为一个具有紧支撑的类偶极子源，其特征尺寸远小于声波波长。\n\n使用声波算子的自由空间格林函数，写出辐射场的推迟时间表示，并在紧凑源（远场）近似下，分析在固定观测点位置 $\\,\\mathbf{x}\\,$ 处接收信号的时间依赖性，该观测点与声源的距离远大于声源的尺寸。设 $\\,\\theta\\,$ 为源的速度方向 $\\,\\hat{\\mathbf{x}}\\,$ 与从瞬时源位置到观测点的视线之间的夹角（以弧度为单位）。在源的静止参考系中，偶极矩以角频率 $\\,\\omega_0\\,$ 进行谐振。\n\n从第一性原理出发，且不使用任何预先制定的多普勒公式，通过仔细考虑推迟时间依赖性中的对流效应，推导观测角频率 $\\,\\omega_{\\mathrm{obs}}\\,$ 关于 $\\,\\omega_0\\,$、$\\,M\\,$ 和 $\\,\\theta\\,$ 的闭合形式表达式。你的推导必须从控制方程开始，并逻辑地推演至推迟时间映射及其对在 $\\,\\mathbf{x}\\,$ 处观测到的瞬时相位的影响。\n\n请以单个解析表达式的形式给出 $\\,\\omega_{\\mathrm{obs}}\\,$ 的最终答案，单位为弧度/秒。不需要进行数值计算。",
            "solution": "本题的任务是从流体动力学的基本方程出发，并遵循 Lighthill 声学类比的原理，推导从运动偶极子源发出的声音的观测角频率 $\\omega_{\\mathrm{obs}}$ 的表达式。\n\n推导过程主要分为三个步骤：\n1.  建立由外部体力密度 $\\mathbf{b}$ 产生的密度扰动 $\\rho'$ 的非齐次声波方程。\n2.  分析该方程的推迟时间解的结构，以建立观测信号的相位与发射时刻声源相位之间的关系。\n3.  对推迟时间关系进行运动学分析，确定声源时间与观测时间的映射关系，从而直接得出多普勒频移。\n\n**第 1 步：非齐次声波方程**\n\n我们从受外部体力密度 $\\mathbf{b}(\\mathbf{x}, t)$ 作用的无粘性流体的可压缩连续性方程和动量方程开始。\n\n连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n动量方程（带体力的可压缩欧拉方程）为：\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I}) = \\mathbf{b}\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是流体速度， $p$ 是压力，$\\mathbf{I}$ 是单位张量。\n\n我们考虑在静止、均匀的环境状态附近的微小扰动，该状态的特征是密度为 $\\rho_0$，压力为 $p_0$，速度为零（$\\mathbf{u}_0 = \\mathbf{0}$）。扰动定义为 $\\rho' = \\rho - \\rho_0$ 和 $p' = p - p_0$。问题指出流体是等熵的，这意味着压力扰动和密度扰动之间存在直接关系，$p' = c^2 \\rho'$，其中 $c$ 是恒定的声速。\n\n为了推导波动方程，我们对连续性方程求时间导数，并对动量方程求散度。\n连续性方程的时间导数：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] = 0\n$$\n动量方程的散度：\n$$\n\\nabla \\cdot \\left[ \\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} \\right] + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I})] = \\nabla \\cdot \\mathbf{b}\n$$\n假设有足够的光滑性，我们可以交换时间和空间导数：\n$$\n\\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] + \\nabla^2 p + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = \\nabla \\cdot \\mathbf{b}\n$$\n其中 $\\nabla^2 p = \\nabla \\cdot (\\nabla p)$。从此结果中减去求导后的连续性方程，可以消去包含 $\\rho \\mathbf{u}$ 的项：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p - \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = -\\nabla \\cdot \\mathbf{b}\n$$\n这是一个精确方程。Lighthill 声学类比通过将此方程重排成非齐次波动方程的形式来进行。我们将除了波动算子之外的所有项都移到右边：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2(p - c^2 \\rho) + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] - \\nabla \\cdot \\mathbf{b}\n$$\n代入 $\\rho = \\rho_0 + \\rho'$ 并注意到对于均匀环境状态 $\\frac{\\partial^2 \\rho_0}{\\partial t^2} - c^2 \\nabla^2 \\rho_0 = 0$，我们得到：\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} - \\frac{\\partial b_i}{\\partial x_i}\n$$\n其中 $T_{ij} = \\rho u_i u_j + (p - p_0 - c^2 \\rho')\\delta_{ij}$ 是 Lighthill 应力张量。对于主要由外力 $\\mathbf{b}$ 而非流体自身运动（如湍流）产生的声音，主导的源项是涉及 $\\mathbf{b}$ 的项。这等效于考虑线性化极限，其中像 $\\rho u_i u_j$ 这样的项被忽略。线性化的波动方程是：\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = - \\nabla \\cdot \\mathbf{b}(\\mathbf{x}, t)\n$$\n这就是由体力产生的密度扰动的控制性非齐次波动方程。\n\n**第 2 步：推迟时间解与相位分析**\n\n该波动方程的解可以使用波动算子 $\\frac{\\partial^2}{\\partial t^2} - c^2 \\nabla^2$ 的自由空间格林函数来形式化地表示。此解的基本性质是因果性，体现在推迟时间的概念中。在观测点位置 $\\mathbf{x}$ 和时间 $t$ 的场 $\\rho'(\\mathbf{x}, t)$ 由声源在更早的发射时间 $\\tau$ 的状态决定。\n\n对于一个紧凑源，其体积中心在发射时间 $\\tau$ 位于位置 $\\mathbf{x}_s(\\tau)$，接收时间 $t$ 与发射时间 $\\tau$ 的关系为：\n$$\nt = \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c}\n$$\n该方程表明，在时间 $t$ 接收到的信号是在时间 $\\tau$ 发射的，并以声速 $c$ 传播了距离 $|\\mathbf{x} - \\mathbf{x}_s(\\tau)|$。\n\n问题指出，声源的偶极矩在其静止参考系中以角频率 $\\omega_0$ 进行谐振。这意味着源函数 $\\mathbf{b}$ 的时间依赖性由相位 $\\phi_s(\\tau) = \\omega_0 \\tau$ 控制。因为整个声场 $\\rho'(\\mathbf{x}, t)$ 都由该声源产生，所以观测者在时间 $t$ 接收到的信号的相位必须对应于声源在发射时刻 $\\tau$ 的相位。\n因此，观测信号的相位由下式给出：\n$$\n\\phi_{\\mathrm{obs}}(t) = \\phi_s(\\tau(t)) = \\omega_0 \\tau(t)\n$$\n这里，$\\tau(t)$ 是对应于接收时间 $t$ 的发射时间，由推迟时间方程定义。\n\n**第 3 步：观测频率的运动学推导**\n\n观测角频率 $\\omega_{\\mathrm{obs}}$ 定义为观测相位的时间变化率：\n$$\n\\omega_{\\mathrm{obs}} = \\frac{d\\phi_{\\mathrm{obs}}}{dt} = \\frac{d}{dt} [\\omega_0 \\tau(t)] = \\omega_0 \\frac{d\\tau}{dt}\n$$\n为了求出 $\\omega_{\\mathrm{obs}}$，我们必须计算导数 $\\frac{d\\tau}{dt}$。我们通过对推迟时间方程关于 $t$ 进行隐式求导来实现这一点：\n$$\n\\frac{d}{dt}(t) = \\frac{d}{dt} \\left( \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c} \\right)\n$$\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\frac{d}{dt}|\\mathbf{x} - \\mathbf{x}_s(\\tau)|\n$$\n对第二项使用链式法则，$\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}$：\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\left( \\frac{d\\tau}{dt} \\frac{d}{d\\tau}|\\mathbf{x} - \\mathbf{x}_s(\\tau)| \\right)\n$$\n提出因子 $\\frac{d\\tau}{dt}$：\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 + \\frac{1}{c} \\frac{d}{d\\tau} R(\\tau) \\right)\n$$\n其中 $R(\\tau) = |\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ 是发射时刻声源到观测点的距离。\n\n接下来，我们计算导数 $\\frac{dR}{d\\tau}$。我们从 $R^2(\\tau) = (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot (\\mathbf{x} - \\mathbf{x}_s(\\tau))$ 开始。对 $\\tau$ 求导：\n$$\n2R \\frac{dR}{d\\tau} = 2 (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot \\left( -\\frac{d\\mathbf{x}_s}{d\\tau} \\right)\n$$\n声源以恒定速度 $\\mathbf{U}$ 运动，所以 $\\frac{d\\mathbf{x}_s}{d\\tau} = \\mathbf{U}$。\n$$\n\\frac{dR}{d\\tau} = -\\frac{\\mathbf{x} - \\mathbf{x}_s(\\tau)}{R} \\cdot \\mathbf{U} = -\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}\n$$\n其中 $\\hat{\\mathbf{R}}(\\tau)$ 是从发射时间 $\\tau$ 的声源位置指向固定观测点的单位向量。\n\n将此结果代回关于 $\\frac{d\\tau}{dt}$ 的方程中：\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} \\right)\n$$\n解出 $\\frac{d\\tau}{dt}$：\n$$\n\\frac{d\\tau}{dt} = \\frac{1}{1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c}}\n$$\n问题将 $\\theta$ 定义为声源速度方向 $\\hat{\\mathbf{x}}$（其中 $\\mathbf{U} = U\\hat{\\mathbf{x}}$）与指向观测者的视线（即 $\\hat{\\mathbf{R}}(\\tau)$ 的方向）之间的夹角。因此，点积为：\n$$\n\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U} = |\\hat{\\mathbf{R}}(\\tau)| |\\mathbf{U}| \\cos\\theta = U \\cos\\theta\n$$\n分母中的项变为：\n$$\n\\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} = \\frac{U \\cos\\theta}{c} = M \\cos\\theta\n$$\n其中 $M=U/c$ 是亚音速马赫数。\n\n最后，我们将其代入观测角频率的表达式中：\n$$\n\\omega_{\\mathrm{obs}} = \\omega_0 \\frac{d\\tau}{dt} = \\omega_0 \\left( \\frac{1}{1 - M \\cos\\theta} \\right) = \\frac{\\omega_0}{1 - M \\cos\\theta}\n$$\n这就是题目所要求的，从第一性原理推导出的运动声源和静止观测者的经典多普勒频移公式。",
            "answer": "$$\n\\boxed{\\frac{\\omega_0}{1 - M \\cos\\theta}}\n$$"
        },
        {
            "introduction": "理论推导为我们提供了坚实的物理基础，但将其转化为可计算的模型是计算声学工程师的核心技能。本练习旨在将前述的理论知识付诸实践，要求你编写一个程序来计算不同类型的四极子声源在远场所产生的声压()。通过完成这个任务，你不仅能验证自己对Lighthill远场解的理解，还能为更复杂的声学仿真建立一个标准的解析基准。",
            "id": "4127999",
            "problem": "考虑在密度和声速均匀的无界、均匀、静止流体中的非均匀声波辐射。你需要为Lighthill声学类比构建并实现一个研究生高阶水平的典型验证案例和解析基准。其基本原理必须是可压缩流体的质量和动量守恒、牛顿定律、小振幅扰动的线性声学以及三维自由空间辐射。仅从这些原理出发，推导位于原点的紧致、时谐四极子源所产生的远场辐射声压。\n\n从使用爱因斯坦求和约定的指数表示法写出的可压缩守恒定律开始。令 $x_i$ 表示笛卡尔坐标（$i \\in \\{1,2,3\\}$），$t$ 表示时间，$\\rho$ 表示密度，$u_i$ 表示速度分量，$p$ 表示压力，$\\sigma_{ij}$ 表示粘性应力张量。使用小扰动线性声学关系 $p' = c^2 \\rho'$ 来描述声学涨落，其中 $c$ 是声速，撇号表示声学扰动。以此为基础，推导自由空间中辐射场的非齐次声波方程。然后，通过选择合适的自由空间格林函数（GF）并引用观测距离 $r$ 远大于源尺寸的紧致源近似，将体积分解简化为一个远场表达式，该表达式依赖于 Lighthill 源项的体积分与辐射方向的缩并。\n\n为基准测试定义典型源如下。体积分的 Lighthill 应力张量为\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}},\n$$\n并且，为进行基准测试，假设其具有时谐形式\n$$\nQ_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t),\n$$\n其中 $Q_0$ 是一个单位为牛顿-米的恒定振幅，$\\omega$ 是单位为弧度/秒的角频率，$S_{ij}$ 是一个编码四极子方向的恒定、对称、无量纲的方向图张量。令 $\\mathbf{x}$ 为观测点位置，$r = |\\mathbf{x}|$，$ \\mathbf{n} = \\mathbf{x}/r$ 为辐射单位矢量。你必须使用在推迟时间 $t_r = t - r/c$ 处计算的自由空间辐射解。目标是在指定的 $(\\mathbf{x}, t)$ 和源参数下，计算远场声压 $p'(\\mathbf{x}, t)$，单位为帕斯卡。\n\n实现一个完整、可运行的程序，该程序：\n- 为三个基准模式构建 $S_{ij}$：\n  - 一个与 $x$ 轴对齐的对角四极子，其中 $S_{11} = 1$，所有其他分量为 $0$。\n  - 一个对称的非对角四极子，其中 $S_{12} = S_{21} = 1$，所有其他分量为 $0$。\n  - 一个各向同性模式，其中 $S_{ij} = \\delta_{ij}$。\n- 使用物理上一致的自由空间辐射，并考虑推迟时间、声速以及三维空间中的 $1/r$ 衰减，计算远场紧致源声压 $p'(\\mathbf{x}, t)$。\n- 以帕斯卡为单位表示最终结果。\n\n设计你的算法以评估以下测试套件。在所有情况下，以帕斯卡为单位回答，结果为浮点数。除非另有说明，否则使用 $c = 343$ $\\mathrm{m/s}$。对于每个案例，观测坐标 $\\mathbf{x}$ 的单位是米，时间 $t$ 的单位是秒，振幅 $Q_0$ 的单位是牛顿-米，角频率 $\\omega$ 的单位是弧度/秒。\n\n测试套件：\n1. 正常路径紧致对角四极子：$S_{11} = 1$，所有其他 $S_{ij} = 0$；$\\mathbf{x} = (1, 2, 2)$；$t = 0.001$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 1000$；$c = 343$。\n2. 各向同性紧致四极子：$S_{ij} = \\delta_{ij}$；$\\mathbf{x} = (3, 4, 0)$；$t = 0.002$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 500$；$c = 343$。\n3. 非对角对称四极子的几何零点：$S_{12} = S_{21} = 1$，所有其他 $S_{ij} = 0$；$\\mathbf{x} = (0, 0, 5)$；$t = 0.010$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 200$；$c = 343$。\n4. 零频率边界情况：$S_{11} = 1$，所有其他 $S_{ij} = 0$；$\\mathbf{x} = (10, 0, 0)$；$t = 1.000$；$Q_0 = 10^{-3}$；$\\omega = 0$；$c = 343$。\n5. 极端远场各向同性四极子：$S_{ij} = \\delta_{ij}$；$\\mathbf{x} = (1000, 0, 0)$；$t = 0.100$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 50$；$c = 343$。\n\n你的程序必须实现从 Lighthill 声学类比推导出的远场紧致源解，并生成一行输出，其中包含按上述案例顺序排列的、用方括号括起来的逗号分隔列表的结果，例如 $[p_1, p_2, p_3, p_4, p_5]$，其中每个 $p_k$ 是案例 $k$ 计算出的以帕斯卡为单位的浮点数。",
            "solution": "### 远场四极子辐射公式的推导\n\n推导从可压缩流体中的质量守恒和动量守恒开始，以笛卡尔张量表示法和爱因斯坦求和约定书写。\n\n质量守恒为：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0 $$\n动量守恒（Navier-Stokes方程）为：\n$$ \\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j} $$\n其中 $\\rho$ 是密度，$u_i$ 是速度分量，$p$ 是压力，$\\sigma_{ij}$ 是粘性应力张量。\n\n为了推导Lighthill声学类比，将这些方程重新排列成非齐次波动方程的形式。首先，对质量方程取时间导数，并减去动量方程的散度（对 $x_i$ 的导数）：\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial t \\partial x_j}\\right) - \\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial x_i \\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_i \\partial x_j}\\right) $$\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_j)}{\\partial t \\partial x_j} - \\frac{\\partial^2 (\\rho u_i)}{\\partial x_i \\partial t} - \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = \\frac{\\partial^2 p}{\\partial x_i^2} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j} $$\n混合导数项相互抵消。重新整理得到：\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p = \\frac{\\partial^2 (\\rho u_i u_j - \\sigma_{ij})}{\\partial x_i \\partial x_j} $$\n我们在静止环境状态 $(\\rho_0, p_0)$ 周围引入扰动：$\\rho = \\rho_0 + \\rho'$ 和 $p = p_0 + p'$。对于没有热传导的理想流体，声学近似通过声速 $c$ 将压力和密度扰动联系起来：$p' = c^2 \\rho'$。我们通过在左侧加上和减去 $c^2 \\nabla^2 \\rho'$ 来操作方程，并用压力扰动 $p'$ 重写方程，方法是替换 $\\rho' = p'/c^2$。\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2}{\\partial x_i \\partial x_j} (\\rho u_i u_j - \\sigma_{ij} + (p' - c^2 \\rho')\\delta_{ij}) $$\n通过在左手边替换 $\\rho' = p'/c^2$ 将 $p'$作为主变量，得到Lighthill方程：\n$$ \\left(\\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2\\right)p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} $$\n其中 $T_{ij} = \\rho u_i u_j + (p' - c^2 \\rho')\\delta_{ij} - \\sigma_{ij}$ 是 Lighthill 应力张量。此方程是精确的，是守恒定律的重新排列。它描述了右侧的源项如何产生声音，由作用于左侧 $p'$ 的波算子表示。\n\n此非齐次波动方程在无界域中的解是使用自由空间格林函数 $G(\\mathbf{x}, t | \\mathbf{y}, \\tau) = \\frac{\\delta(t - \\tau - |\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|}$ 找到的。$p'(\\mathbf{x}, t)$ 的解是卷积：\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} G(\\mathbf{x}, t | \\mathbf{y}, \\tau) \\frac{\\partial^2 T_{ij}(\\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\n假设源项 $T_{ij}$ 在空间上是局域化的，我们可以通过分部积分（两次）将空间导数转移到格林函数上。这给出了形式解：\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) \\frac{\\partial^2 G(\\mathbf{x}, t | \\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\n由于对于任何关于 $\\mathbf{x}-\\mathbf{y}$ 的函数，都有 $\\partial/\\partial y_i = -\\partial/\\partial x_i$，我们可以写成：\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) G(\\mathbf{x}, t | \\mathbf{y}, \\tau) d^3\\mathbf{y} \\, d\\tau $$\n使用狄拉克δ函数的性质进行时间积分，得到Kirchhoff-Lighthill积分：\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int_{\\mathbb{R}^3} \\frac{T_{ij}(\\mathbf{y}, t-|\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|} d^3\\mathbf{y} $$\n对于位于原点 $\\mathbf{y}=0$ 附近的紧致源和远场（$r = |\\mathbf{x}| \\gg |\\mathbf{y}|$）中的观测者，我们应用以下近似：\n1.  在分母中：$|\\mathbf{x}-\\mathbf{y}| \\approx r$。\n2.  在推迟时间中：$t' = t - |\\mathbf{x}-\\mathbf{y}|/c \\approx t-r/c$。这是紧致源近似，其中忽略了源体积内的相位变化。\n积分简化为：\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{1}{4\\pi r} \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t-r/c) d^3\\mathbf{y} \\right] $$\n我们定义体积分的 Lighthill 张量 $Q_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)d^3\\mathbf{y}$。表达式变为：\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{Q_{ij}(t_r)}{4\\pi r} \\right] $$\n其中 $t_r = t - r/c$ 是推迟时间。导数作用于 $r$ 和 $t_r$，因为它们都依赖于 $\\mathbf{x}$。在远场中，主要贡献来自 $Q_{ij}$ 的二阶时间导数。对 $1/r$ 等项应用导数 $\\partial/\\partial x_k$ 产生的项比 $1/r$ 衰减得更快，因此被忽略。对 $Q_{ij}(t_r)$ 应用链式法则得到 $\\partial/\\partial x_k \\rightarrow (-n_k/c)d/dt_r$，其中 $n_k = x_k/r$ 是辐射方向矢量。应用两次这样的导数得到四极子的远场结果：\n$$ p'(\\mathbf{x}, t) = \\frac{n_i n_j}{4\\pi r c^2} \\frac{d^2 Q_{ij}}{dt^2}\\bigg|_{t_r} = \\frac{n_i n_j}{4\\pi r c^2} \\ddot{Q}_{ij}(t - r/c) $$\n对于指定的时谐源 $Q_{ij}(t) = Q_0 S_{ij} \\cos(\\omega t)$，其二阶时间导数为：\n$$ \\ddot{Q}_{ij}(t) = -Q_0 \\omega^2 S_{ij} \\cos(\\omega t) $$\n将此代入远场压力公式并在推迟时间 $t_r = t - r/c$ 处求值，得到最终的实现表达式：\n$$ p'(\\mathbf{x}, t) = -\\frac{Q_0 \\omega^2}{4\\pi r c^2} (n_i S_{ij} n_j) \\cos(\\omega(t - r/c)) $$\n项 $n_i S_{ij} n_j$ 是四极子指向性模式，是一个通过辐射矢量 $\\mathbf{n}$ 与源张量 $S_{ij}$ 缩并计算得到的标量。\n\n### 算法设计\n程序将为五个测试案例中的每一个实现上面推导出的最终公式。一个辅助函数将根据给定的源参数和观测点位置计算压力。\n\n1.  对于每个测试案例，定义参数：观测点位置 $\\mathbf{x}$、时间 $t$、源振幅 $Q_0$、角频率 $\\omega$、声速 $c$ 以及源方向图张量 $S_{ij}$。\n2.  计算观测点距离 $r = |\\mathbf{x}|$。\n3.  如果 $r=0$，压力是奇异的；但所有测试案例的 $r>0$。\n4.  计算辐射单位矢量 $\\mathbf{n} = \\mathbf{x}/r$。\n5.  计算指向性项 $D = n_i S_{ij} n_j = \\mathbf{n}^T \\mathbf{S} \\mathbf{n}$。\n6.  计算推迟时间相位角 $\\theta = \\omega (t - r/c)$。\n7.  计算振幅因子，包括 $1/r$ 衰减和 $\\omega^2$ 依赖性。\n8.  组合这些分量以求得声压 $p'(\\mathbf{x}, t)$。对于边界情况 $\\omega=0$，压力为零，该公式能正确处理。\n\n此过程将应用于测试套件中的每个案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the far-field acoustic pressure for a set of canonical\n    Lighthill quadrupole source test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([1.0, 2.0, 2.0]),\n            \"t\": 0.001,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 1000,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([3.0, 4.0, 0.0]),\n            \"t\": 0.002,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 500,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"off_diagonal\",\n            \"x\": np.array([0.0, 0.0, 5.0]),\n            \"t\": 0.010,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 200,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([10.0, 0.0, 0.0]),\n            \"t\": 1.000,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 0,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([1000.0, 0.0, 0.0]),\n            \"t\": 0.100,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 50,\n            \"c\": 343.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_prime = calculate_far_field_pressure(\n            x=case[\"x\"],\n            t=case[\"t\"],\n            Q0=case[\"Q0\"],\n            omega=2 * np.pi * case[\"omega_hz\"],\n            c=case[\"c\"],\n            pattern=case[\"pattern\"],\n        )\n        results.append(p_prime)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\ndef calculate_far_field_pressure(x: np.ndarray, t: float, Q0: float, omega: float, c: float, pattern: str) -> float:\n    \"\"\"\n    Calculates the far-field acoustic pressure from a compact quadrupole source\n    based on Lighthill's acoustic analogy.\n\n    The formula used is:\n    p'(x, t) = - (Q0 * omega^2) / (4 * pi * r * c^2) * (n^T * S * n) * cos(omega * (t - r/c))\n    \"\"\"\n    \n    # Construct the dimensionless pattern tensor S_ij\n    S = np.zeros((3, 3))\n    if pattern == \"diagonal\":\n        S[0, 0] = 1.0\n    elif pattern == \"off_diagonal\":\n        S[0, 1] = 1.0\n        S[1, 0] = 1.0\n    elif pattern == \"isotropic\":\n        S = np.identity(3)\n\n    # Handle the zero-frequency case directly to avoid division by zero if omega is in a denominator.\n    if omega == 0.0:\n        return 0.0\n\n    # Calculate geometric terms: distance r and radiation unit vector n\n    r = np.linalg.norm(x)\n    if r == 0.0:\n        # Pressure is singular at the origin. For this problem, r > 0.\n        return np.inf\n    n = x / r\n\n    # Calculate the quadrupole directivity term (n_i * S_ij * n_j)\n    # Using numpy's @ operator for matrix-vector multiplication: n.T @ S @ n\n    directivity = n @ S @ n\n    \n    # If directivity is zero (geometric null), pressure is zero\n    if directivity == 0.0:\n        return 0.0\n\n    # Calculate the amplitude factor\n    amplitude_factor = -(Q0 * omega**2) / (4 * np.pi * r * c**2)\n    \n    # Calculate the retarded time argument of the cosine term\n    retarded_time_arg = omega * (t - r / c)\n\n    # Calculate the final acoustic pressure\n    pressure = amplitude_factor * directivity * np.cos(retarded_time_arg)\n    \n    return pressure\n\nsolve()\n```"
        }
    ]
}