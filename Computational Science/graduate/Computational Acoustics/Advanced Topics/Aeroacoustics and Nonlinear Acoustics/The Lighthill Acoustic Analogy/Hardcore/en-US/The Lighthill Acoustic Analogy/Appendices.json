{
    "hands_on_practices": [
        {
            "introduction": "This first exercise focuses on a cornerstone of aeroacoustics: the sound field of a stationary, compact quadrupole. By deriving the directivity pattern from the Lighthill analogy, you'll gain a fundamental understanding of how the mathematical structure of the Lighthill stress tensor translates into the angular distribution of radiated sound. This practice reinforces the essential link between the source physics and the observable far-field acoustics, a skill crucial for interpreting both analytical and numerical results .",
            "id": "4127998",
            "problem": "A compact turbulent region in an otherwise quiescent, homogeneous, inviscid, barotropic fluid with ambient density $\\rho_{0}$ and sound speed $c_{0}$ radiates sound that can be modeled using Lighthill’s acoustic analogy. Let the characteristic size $a$ of the turbulent region satisfy $ka \\ll 1$, where $k = \\omega/c_{0}$ and $\\omega$ is a single angular frequency of interest, so that the source is acoustically compact. The observer is located at position $\\mathbf{x}$ with $r = |\\mathbf{x}|$ and unit direction vector $\\mathbf{n} = \\mathbf{x}/r$. The fluctuating Lighthill stress tensor integrated over the compact source region is defined by $Q_{ij}(t) = \\int_{V} T_{ij}(\\mathbf{y},t)\\,\\mathrm{d}^{3}y$, and is assumed to be harmonic in time with $Q_{ij}(t) = \\Re\\{\\hat{Q}_{ij}\\exp(-\\mathrm{i}\\omega t)\\}$.\n\nAssume the compact source is axisymmetric about the $z$-axis, with the complex quadrupole strength tensor given by $\\hat{Q}_{ij} = Q_{0}\\,\\mathrm{diag}(-1,-1,2)$, where $Q_{0}$ is a complex constant and $\\mathrm{diag}(\\cdot)$ denotes a diagonal tensor in Cartesian components $(x,y,z)$. Starting only from the conservation of mass, the conservation of momentum, the linear acoustic constitutive relation $p' = c_{0}^{2}\\rho'$ for small perturbations, and the free-space Green’s function for the wave operator, derive the far-field angular dependence of the complex acoustic pressure amplitude $\\hat{p}(r,\\theta)$ at frequency $\\omega$ in the limit $r \\gg a$, where $\\theta$ is the polar angle measured from the $z$-axis. Define the directivity function $D(\\theta)$ by $\\hat{p}(r,\\theta) \\propto D(\\theta)/r$ after factoring out all distance- and frequency-dependent constants common to every direction. Normalize the directivity so that its maximum absolute value over $\\theta \\in [0,\\pi]$ equals $1$.\n\nProvide the final normalized directivity $D(\\theta)$ as a single closed-form analytical expression in terms of $\\theta$ only, with no units. No numerical evaluation is required.",
            "solution": "The problem statement is parsed and validated as follows.\n\n### Step 1: Extract Givens\n- **Fluid:** Quiescent, homogeneous, inviscid, barotropic.\n- **Ambient State:** Density $\\rho_{0}$, sound speed $c_{0}$.\n- **Source:** A compact turbulent region of characteristic size $a$.\n- **Acoustic Compactness:** $ka \\ll 1$, where $k = \\omega/c_{0}$ and $\\omega$ is the single angular frequency.\n- **Observer:** Position $\\mathbf{x}$, distance $r = |\\mathbf{x}|$, direction vector $\\mathbf{n} = \\mathbf{x}/r$. Far-field condition $r \\gg a$.\n- **Lighthill Stress Tensor (Integrated):** $Q_{ij}(t) = \\int_{V} T_{ij}(\\mathbf{y},t)\\,\\mathrm{d}^{3}y$.\n- **Time Dependence:** Harmonic, $Q_{ij}(t) = \\Re\\{\\hat{Q}_{ij}\\exp(-\\mathrm{i}\\omega t)\\}$.\n- **Quadrupole Tensor:** $\\hat{Q}_{ij} = Q_{0}\\,\\mathrm{diag}(-1,-1,2)$ in Cartesian components $(x,y,z)$, with $Q_{0}$ being a complex constant.\n- **Symmetry:** Axisymmetric about the $z$-axis. $\\theta$ is the polar angle from the $z$-axis.\n- **Task:** Derive the far-field angular dependence of the complex acoustic pressure amplitude, $\\hat{p}(r,\\theta)$, defined through the directivity function $D(\\theta)$ where $\\hat{p}(r,\\theta) \\propto D(\\theta)/r$.\n- **Normalization:** The maximum absolute value of $D(\\theta)$ over $\\theta \\in [0,\\pi]$ must be $1$.\n- **Starting Point:** Conservation of mass, conservation of momentum, linear acoustic constitutive relation $p' = c_{0}^{2}\\rho'$, and the free-space Green’s function for the wave operator.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem is a standard application of Lighthill's acoustic analogy, a fundamental theory in aeroacoustics. The physical model (compact quadrupole source) and mathematical setup are well-established. The form of the quadrupole tensor, $\\hat{Q}_{ij} = Q_{0}\\,\\mathrm{diag}(-1,-1,2)$, is traceless ($\\sum_{i} \\hat{Q}_{ii} = -1-1+2=0$) and represents a classical longitudinal quadrupole, which is a physically realistic sound source type. The problem is scientifically sound.\n- **Well-Posedness:** The problem provides all necessary information—the governing physics, the specific source characteristics, and a clear objective with a normalization condition—to determine a unique mathematical expression for the directivity function.\n- **Objectivity:** The problem is formulated using precise, unambiguous scientific terminology and is free of subjective content.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, and objective. A complete solution will be provided.\n\n### Solution Derivation\nThe derivation begins with the fundamental conservation laws for a fluid. The conservation of mass and momentum in an inviscid fluid are given by the continuity and Euler equations, respectively:\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho v_i)}{\\partial x_i} = 0 $$\n$$ \\frac{\\partial (\\rho v_i)}{\\partial t} + \\frac{\\partial (\\rho v_i v_j + p \\delta_{ij})}{\\partial x_j} = 0 $$\nwhere $\\rho$ is the fluid density, $\\mathbf{v}$ is the velocity vector, $p$ is the pressure, and $\\delta_{ij}$ is the Kronecker delta.\n\nTaking the time derivative of the mass conservation equation and the divergence ($\\partial/\\partial x_i$) of the momentum conservation equation gives:\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho v_i)}{\\partial t \\partial x_i} = 0 $$\n$$ \\frac{\\partial^2 (\\rho v_i)}{\\partial x_i \\partial t} + \\frac{\\partial^2 (\\rho v_i v_j + p \\delta_{ij})}{\\partial x_i \\partial x_j} = 0 $$\nSubtracting the second equation from the first yields:\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} - \\frac{\\partial^2 p}{\\partial x_i \\partial x_i} = \\frac{\\partial^2 (\\rho v_i v_j)}{\\partial x_i \\partial x_j} $$\nWe rearrange this by adding and subtracting $c_{0}^{2} \\nabla^2 \\rho$ from the left-hand side, where $\\nabla^2 = \\partial^2/\\partial x_i \\partial x_i$:\n$$ \\left( \\frac{\\partial^2 \\rho}{\\partial t^2} - c_{0}^2 \\nabla^2 \\rho \\right) - (\\nabla^2 p - c_{0}^2 \\nabla^2 \\rho) = \\frac{\\partial^2 (\\rho v_i v_j)}{\\partial x_i \\partial x_j} $$\nLet $\\rho = \\rho_{0} + \\rho'$ and $p = p_{0} + p'$, where $\\rho_{0}$ and $p_{0}$ are the constant ambient density and pressure. The equation becomes:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c_{0}^2 \\nabla^2 \\rho' = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\rho v_i v_j + (p' - c_{0}^2 \\rho') \\delta_{ij} \\right] $$\nUsing the linear acoustic relation $p' = c_{0}^2 \\rho'$ (valid for the propagating sound waves), we can write the equation in terms of the pressure perturbation $p'$:\n$$ \\frac{1}{c_{0}^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} $$\nThis is Lighthill's inhomogeneous wave equation, where $T_{ij} = \\rho v_i v_j + (p' - c_{0}^2 \\rho')\\delta_{ij}$ is the Lighthill stress tensor.\n\nThe solution to this equation is given by the integral over the source volume $V$ using the free-space Green's function, $G(\\mathbf{x},t|\\mathbf{y},\\tau) = \\frac{\\delta(t-\\tau-|\\mathbf{x}-\\mathbf{y}|/c_0)}{4\\pi|\\mathbf{x}-\\mathbf{y}|}$:\n$$ p'(\\mathbf{x}, t) = \\int_{V} \\int_{-\\infty}^{\\infty} \\frac{\\partial^2 T_{ij}(\\mathbf{y},\\tau)}{\\partial y_i \\partial y_j} G(\\mathbf{x}, t|\\mathbf{y}, \\tau) \\, \\mathrm{d}\\tau \\, \\mathrm{d}^{3}y $$\nAssuming the source $T_{ij}$ is confined to the volume $V$ and vanishes on its boundary, we can integrate by parts twice with respect to the source coordinates $\\mathbf{y}$:\n$$ p'(\\mathbf{x}, t) = \\int_{V} \\int_{-\\infty}^{\\infty} T_{ij}(\\mathbf{y},\\tau) \\frac{\\partial^2 G(\\mathbf{x}, t|\\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} \\, \\mathrm{d}\\tau \\, \\mathrm{d}^{3}y $$\nIn the far-field ($r \\gg a$), the spatial derivatives of the Green's function are dominated by the terms arising from differentiating the retarded time argument. Let $R = |\\mathbf{x}-\\mathbf{y}|$. The derivative with respect to $y_i$ is approximately:\n$$ \\frac{\\partial G}{\\partial y_i} \\approx \\frac{1}{4\\pi R c_0} \\frac{d\\delta}{d\\tau} \\frac{\\partial R}{\\partial y_i} = \\frac{1}{4\\pi R c_0} \\frac{d\\delta}{d\\tau} \\frac{y_i-x_i}{R} \\approx \\frac{-n_i}{4\\pi r c_0} \\frac{d\\delta}{d\\tau} $$\nwhere we have used $R \\approx r$ and $(y_i - x_i)/R \\approx -x_i/r = -n_i$. Differentiating a second time yields:\n$$ \\frac{\\partial^2 G}{\\partial y_i \\partial y_j} \\approx \\frac{n_i n_j}{4\\pi r c_0^2} \\frac{d^2\\delta}{d\\tau^2} $$\nSubstituting this into the solution integral and performing the integration over $\\tau$:\n$$ p'(\\mathbf{x}, t) \\approx \\int_{V} \\frac{n_i n_j}{4\\pi |\\mathbf{x}-\\mathbf{y}| c_0^2} \\left[ \\frac{\\partial^2}{\\partial t^2} T_{ij}(\\mathbf{y},t) \\right]_{\\text{ret}} \\, \\mathrm{d}^{3}y $$\nThe retarded time is $t - |\\mathbf{x}-\\mathbf{y}|/c_0$. For a compact source ($ka \\ll 1$), the time variation across the source, $|\\mathbf{y}|/c_0$, is much smaller than the characteristic period $1/\\omega$. Thus, we can approximate the retarded time as uniform across the source, $t - r/c_0$.\n$$ p'(\\mathbf{x}, t) \\approx \\frac{n_i n_j}{4\\pi r c_0^2} \\frac{\\partial^2}{\\partial t^2} \\int_V T_{ij}(\\mathbf{y}, t - r/c_0) \\, \\mathrm{d}^{3}y $$\nRecognizing the definition of the integrated quadrupole moment $Q_{ij}(t) = \\int_V T_{ij}(\\mathbf{y},t) d^3y$, we obtain the classic far-field result for a compact quadrupole source:\n$$ p'(\\mathbf{x}, t) \\approx \\frac{n_i n_j}{4\\pi r c_0^2} \\frac{d^2 Q_{ij}(t-r/c_0)}{dt^2} $$\nFor harmonic time dependence, $Q_{ij}(t) = \\Re\\{\\hat{Q}_{ij}\\exp(-\\mathrm{i}\\omega t)\\}$, the second time derivative is $\\frac{d^2 Q_{ij}}{dt^2} = \\Re\\{(-\\mathrm{i}\\omega)^2 \\hat{Q}_{ij}\\exp(-\\mathrm{i}\\omega t)\\}$. The complex pressure amplitude $\\hat{p}(\\mathbf{x})$, where $p'(\\mathbf{x}, t) = \\Re\\{\\hat{p}(\\mathbf{x}) \\exp(-\\mathrm{i}\\omega t)\\}$, is then:\n$$ \\hat{p}(\\mathbf{x}) = \\frac{n_i n_j}{4\\pi r c_0^2} (-\\omega^2) \\hat{Q}_{ij} \\exp(\\mathrm{i}k r) = -\\frac{k^2}{4\\pi r} n_i n_j \\hat{Q}_{ij} \\exp(\\mathrm{i}k r) $$\nwhere $k=\\omega/c_0$.\nNow we insert the given quadrupole tensor $\\hat{Q}_{ij} = Q_{0}\\,\\mathrm{diag}(-1,-1,2)$. The coordinate system is Cartesian $(x,y,z)$, which we associate with indices $(1,2,3)$. The observer direction vector is $\\mathbf{n} = (\\sin\\theta\\cos\\phi, \\sin\\theta\\sin\\phi, \\cos\\theta)$, where $\\theta$ is the polar angle from the $z$-axis. The contraction $n_i n_j \\hat{Q}_{ij}$ becomes:\n$$ n_i n_j \\hat{Q}_{ij} = n_1^2 \\hat{Q}_{11} + n_2^2 \\hat{Q}_{22} + n_3^2 \\hat{Q}_{33} = Q_{0} [n_1^2(-1) + n_2^2(-1) + n_3^2(2)] $$\n$$ n_i n_j \\hat{Q}_{ij} = Q_{0} [-(n_1^2 + n_2^2) + 2n_3^2] $$\nUsing the identity $n_1^2 + n_2^2 + n_3^2 = 1$, we have $n_1^2 + n_2^2 = 1 - n_3^2$. Substituting this gives:\n$$ n_i n_j \\hat{Q}_{ij} = Q_{0} [-(1-n_3^2) + 2n_3^2] = Q_{0} (-1 + 3n_3^2) $$\nWith $n_3 = \\cos\\theta$, the contraction is $Q_{0}(3\\cos^2\\theta - 1)$.\nThe complex pressure amplitude is then:\n$$ \\hat{p}(r, \\theta) = -\\frac{k^2 Q_0}{4\\pi} \\frac{\\exp(\\mathrm{i}k r)}{r} (3\\cos^2\\theta - 1) $$\nThe problem defines the directivity function $D(\\theta)$ via the proportionality $\\hat{p}(r,\\theta) \\propto D(\\theta)/r$. By inspection, the angular dependence is contained in the term $(3\\cos^2\\theta - 1)$. We can define an un-normalized directivity function as $D_{\\text{un-norm}}(\\theta) = 3\\cos^2\\theta - 1$.\n\nTo normalize this function, we must find its maximum absolute value for $\\theta \\in [0,\\pi]$. Let $f(\\theta) = 3\\cos^2\\theta - 1$. The extrema of this function occur at the boundaries of the domain or where its derivative is zero.\n- At $\\theta=0$, $\\cos\\theta=1$, so $f(0) = 3(1)^2 - 1 = 2$.\n- At $\\theta=\\pi$, $\\cos\\theta=-1$, so $f(\\pi) = 3(-1)^2 - 1 = 2$.\n- The derivative is $f'(\\theta) = 3(2\\cos\\theta)(-\\sin\\theta) = -6\\sin\\theta\\cos\\theta = -3\\sin(2\\theta)$. This is zero at $\\theta=0, \\pi/2, \\pi$.\n- At $\\theta=\\pi/2$, $\\cos\\theta=0$, so $f(\\pi/2) = 3(0)^2 - 1 = -1$.\nThe range of $f(\\theta)$ is $[-1, 2]$. The maximum absolute value is $\\max_{\\theta \\in [0,\\pi]} |f(\\theta)| = |2| = 2$.\n\nThe normalized directivity function $D(\\theta)$ is obtained by dividing the un-normalized function by this maximum absolute value:\n$$ D(\\theta) = \\frac{3\\cos^2\\theta - 1}{2} $$\nThis expression is the Legendre polynomial of degree $2$, $P_2(\\cos\\theta)$. Its maximum absolute value is indeed $1$, which occurs at $\\theta=0$ and $\\theta=\\pi$.",
            "answer": "$$\\boxed{\\frac{3\\cos^2\\theta - 1}{2}}$$"
        },
        {
            "introduction": "Real-world aeroacoustic sources, like the turbulent eddies in a jet, are rarely stationary. This practice introduces the crucial effect of source motion by guiding you to derive the famous Doppler shift formula directly from the retarded-time relationship inherent in the wave equation solution. By approaching this from first principles, you will see that the Doppler effect is not just a separate physical law to be applied, but a natural consequence of the propagation of waves from a moving source, a deeper understanding that is essential for analyzing convecting sound sources .",
            "id": "4128001",
            "problem": "Consider an inviscid, isentropic, compressible fluid with ambient density $\\rho_0$ and constant sound speed $c$. Starting from the compressible continuity equation and the momentum equation (the compressible Navier–Stokes equations), construct the inhomogeneous acoustic wave equation associated with Lighthill’s acoustic analogy for the density perturbation $\\rho'(\\mathbf{x}, t)$, explicitly incorporating a compact external body-force density $\\mathbf{b}(\\mathbf{x}, t)$ that is localized around a source point $\\mathbf{x}_s(t)$ and moves at constant velocity $\\mathbf{U} = U\\hat{\\mathbf{x}}$ with subsonic Mach number $M = U/c < 1$. Assume $\\mathbf{b}(\\mathbf{x}, t)$ produces zero net force and therefore acts as a dipole-like source with a compact support whose characteristic size is much smaller than the acoustic wavelength.\n\nUsing the free-space Green’s function of the acoustic wave operator, write the retarded-time representation of the radiated field and, under the compact-source (far-field) approximation, analyze the time dependence of the received signal at a fixed observer location $\\mathbf{x}$, which is at a large distance from the source compared to its size. Let $\\theta$ be the angle (in radians) between the source velocity direction $\\hat{\\mathbf{x}}$ and the line of sight from the instantaneous source position to the observer. The dipole moment in the source rest frame oscillates harmonically with angular frequency $\\omega_0$.\n\nDerive, from first principles and without invoking any pre-tabulated Doppler formulas, the closed-form expression for the observed angular frequency $\\omega_{\\mathrm{obs}}$ in terms of $\\omega_0$, $M$, and $\\theta$, by carefully accounting for convection through the retarded-time dependence. Your derivation must begin from the governing equations and proceed logically to the retarded-time mapping and its implication for the instantaneous phase observed at $\\mathbf{x}$.\n\nProvide your final answer as a single analytic expression for $\\omega_{\\mathrm{obs}}$ in radians per second. No numerical evaluation is required.",
            "solution": "The task is to derive the expression for the observed angular frequency $\\omega_{\\mathrm{obs}}$ of sound from a moving dipole source, starting from the fundamental equations of fluid dynamics and adhering to the principles of Lighthill's acoustic analogy.\n\nThe derivation proceeds in three main steps:\n1.  Establish the inhomogeneous acoustic wave equation for the density perturbation $\\rho'$ generated by an external body-force density $\\mathbf{b}$.\n2.  Analyze the structure of the retarded-time solution to this equation to establish a relationship between the phase of the observed signal and the phase of the source at the time of emission.\n3.  Perform a kinematic analysis of the retarded-time relationship to determine the mapping between the source time and observer time, which directly yields the Doppler frequency shift.\n\n**Step 1: The Inhomogeneous Acoustic Wave Equation**\n\nWe begin with the compressible continuity and momentum equations for an inviscid fluid subject to an external body-force density $\\mathbf{b}(\\mathbf{x}, t)$.\n\nThe continuity equation is:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nThe momentum equation (compressible Euler equation with a body force) is:\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I}) = \\mathbf{b}\n$$\nwhere $\\rho$ is the fluid density, $\\mathbf{u}$ is the fluid velocity, $p$ is the pressure, and $\\mathbf{I}$ is the identity tensor.\n\nWe consider small perturbations around a quiescent, uniform ambient state characterized by density $\\rho_0$, pressure $p_0$, and zero velocity ($\\mathbf{u}_0 = \\mathbf{0}$). The perturbations are defined as $\\rho' = \\rho - \\rho_0$ and $p' = p - p_0$. The problem states the fluid is isentropic, which implies a direct relationship between pressure and density perturbations, $p' = c^2 \\rho'$, where $c$ is the constant speed of sound.\n\nTo derive the wave equation, we take the time derivative of the continuity equation and the divergence of the momentum equation.\nTime derivative of continuity:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] = 0\n$$\nDivergence of momentum:\n$$\n\\nabla \\cdot \\left[ \\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} \\right] + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I})] = \\nabla \\cdot \\mathbf{b}\n$$\nAssuming sufficient smoothness, we can interchange the temporal and spatial derivatives:\n$$\n\\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] + \\nabla^2 p + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = \\nabla \\cdot \\mathbf{b}\n$$\nwhere $\\nabla^2 p = \\nabla \\cdot (\\nabla p)$. Subtracting the time-differentiated continuity equation from this result eliminates the term involving $\\rho \\mathbf{u}$:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p - \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = -\\nabla \\cdot \\mathbf{b}\n$$\nThis is an exact equation. Lighthill's acoustic analogy proceeds by rearranging this equation into the form of an inhomogeneous wave equation. Let's move all terms except the wave operator to the right-hand side:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2(p - c^2 \\rho) + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] - \\nabla \\cdot \\mathbf{b}\n$$\nSubstituting $\\rho = \\rho_0 + \\rho'$ and noting that $\\frac{\\partial^2 \\rho_0}{\\partial t^2} - c^2 \\nabla^2 \\rho_0 = 0$ for a uniform ambient state, we get:\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} - \\frac{\\partial b_i}{\\partial x_i}\n$$\nwhere $T_{ij} = \\rho u_i u_j + (p - p_0 - c^2 \\rho')\\delta_{ij}$ is the Lighthill stress tensor. For sound generated primarily by the external force $\\mathbf{b}$ rather than by the fluid's self-motion (e.g., turbulence), the dominant source term is the one involving $\\mathbf{b}$. This is equivalent to considering the linearized limit where terms like $\\rho u_i u_j$ are neglected. The linearized wave equation is:\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = - \\nabla \\cdot \\mathbf{b}(\\mathbf{x}, t)\n$$\nThis is the governing inhomogeneous wave equation for the density perturbation generated by the body force.\n\n**Step 2: Retarded-Time Solution and Phase Analysis**\n\nThe solution to this wave equation can be formally expressed using the free-space Green's function for the wave operator $\\frac{\\partial^2}{\\partial t^2} - c^2 \\nabla^2$. The fundamental property of this solution is causality, embodied in the concept of retarded time. The field $\\rho'(\\mathbf{x}, t)$ at an observer location $\\mathbf{x}$ and time $t$ is determined by the state of the source at an earlier emission time $\\tau$.\n\nFor a compact source whose center of volume is at position $\\mathbf{x}_s(\\tau)$ at the emission time $\\tau$, the reception time $t$ is related to the emission time $\\tau$ by:\n$$\nt = \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c}\n$$\nThis equation states that the signal received at time $t$ was emitted at time $\\tau$ and traveled the distance $|\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ at the speed of sound $c$.\n\nThe problem states that the source's dipole moment oscillates harmonically with an angular frequency $\\omega_0$ in its rest frame. This means that the time dependence of the source function $\\mathbf{b}$ is governed by a phase $\\phi_s(\\tau) = \\omega_0 \\tau$. Because the entire acoustic field $\\rho'(\\mathbf{x}, t)$ is generated by this source, the phase of the signal received by the observer at time $t$ must correspond to the phase of the source at the moment of emission, $\\tau$.\nTherefore, the phase of the observed signal is given by:\n$$\n\\phi_{\\mathrm{obs}}(t) = \\phi_s(\\tau(t)) = \\omega_0 \\tau(t)\n$$\nHere, $\\tau(t)$ is the emission time corresponding to the reception time $t$, as defined by the retarded-time equation.\n\n**Step 3: Kinematic Derivation of the Observed Frequency**\n\nThe observed angular frequency, $\\omega_{\\mathrm{obs}}$, is defined as the time rate of change of the observed phase:\n$$\n\\omega_{\\mathrm{obs}} = \\frac{d\\phi_{\\mathrm{obs}}}{dt} = \\frac{d}{dt} [\\omega_0 \\tau(t)] = \\omega_0 \\frac{d\\tau}{dt}\n$$\nTo find $\\omega_{\\mathrm{obs}}$, we must calculate the derivative $\\frac{d\\tau}{dt}$. We achieve this by differentiating the retarded-time equation implicitly with respect to $t$:\n$$\n\\frac{d}{dt}(t) = \\frac{d}{dt} \\left( \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c} \\right)\n$$\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\frac{d}{dt}|\\mathbf{x} - \\mathbf{x}_s(\\tau)|\n$$\nUsing the chain rule on the second term, $\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}$:\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\left( \\frac{d\\tau}{dt} \\frac{d}{d\\tau}|\\mathbf{x} - \\mathbf{x}_s(\\tau)| \\right)\n$$\nFactoring out $\\frac{d\\tau}{dt}$:\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 + \\frac{1}{c} \\frac{d}{d\\tau} R(\\tau) \\right)\n$$\nwhere $R(\\tau) = |\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ is the distance from the source to the observer at the time of emission.\n\nNext, we evaluate the derivative $\\frac{dR}{d\\tau}$. We start with $R^2(\\tau) = (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot (\\mathbf{x} - \\mathbf{x}_s(\\tau))$. Differentiating with respect to $\\tau$:\n$$\n2R \\frac{dR}{d\\tau} = 2 (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot \\left( -\\frac{d\\mathbf{x}_s}{d\\tau} \\right)\n$$\nThe source moves at a constant velocity $\\mathbf{U}$, so $\\frac{d\\mathbf{x}_s}{d\\tau} = \\mathbf{U}$.\n$$\n\\frac{dR}{d\\tau} = -\\frac{\\mathbf{x} - \\mathbf{x}_s(\\tau)}{R} \\cdot \\mathbf{U} = -\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}\n$$\nwhere $\\hat{\\mathbf{R}}(\\tau)$ is the unit vector pointing from the source's position at emission time $\\tau$ towards the fixed observer.\n\nSubstituting this result back into the equation for $\\frac{d\\tau}{dt}$:\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} \\right)\n$$\nSolving for $\\frac{d\\tau}{dt}$:\n$$\n\\frac{d\\tau}{dt} = \\frac{1}{1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c}}\n$$\nThe problem defines $\\theta$ as the angle between the source velocity direction $\\hat{\\mathbf{x}}$ (where $\\mathbf{U} = U\\hat{\\mathbf{x}}$) and the line of sight to the observer, which is the direction of $\\hat{\\mathbf{R}}(\\tau)$. Thus, the dot product is:\n$$\n\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U} = |\\hat{\\mathbf{R}}(\\tau)| |\\mathbf{U}| \\cos\\theta = U \\cos\\theta\n$$\nThe term in the denominator becomes:\n$$\n\\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} = \\frac{U \\cos\\theta}{c} = M \\cos\\theta\n$$\nwhere $M=U/c$ is the subsonic Mach number.\n\nFinally, we substitute this into the expression for the observed angular frequency:\n$$\n\\omega_{\\mathrm{obs}} = \\omega_0 \\frac{d\\tau}{dt} = \\omega_0 \\left( \\frac{1}{1 - M \\cos\\theta} \\right) = \\frac{\\omega_0}{1 - M \\cos\\theta}\n$$\nThis is the classical Doppler shift formula for a moving source and a stationary observer, derived from first principles as required.",
            "answer": "$$\n\\boxed{\\frac{\\omega_0}{1 - M \\cos\\theta}}\n$$"
        },
        {
            "introduction": "The ultimate test of understanding in computational acoustics is the ability to translate theory into a working, verifiable model. This final practice challenges you to implement the far-field quadrupole solution derived from the Lighthill analogy, creating a valuable benchmark tool for more complex computational aeroacoustics (CAA) solvers. By coding the solution and testing it against canonical cases with different source structures, you will solidify your grasp of the underlying physics and develop practical skills in code validation and benchmarking .",
            "id": "4127999",
            "problem": "Consider the inhomogeneous acoustic wave radiation in an unbounded, homogeneous, stationary fluid of uniform density and sound speed. You are asked to construct and implement a canonical validation case and analytic benchmark for Lighthill's acoustic analogy at advanced graduate level. The fundamental base must be the conservation of mass and momentum for a compressible fluid, Newton's laws, linear acoustics for small-amplitude perturbations, and free-space radiation in three dimensions. Starting only from these principles, derive the radiated far-field acoustic pressure caused by a compact, time-harmonic quadrupolar source located at the origin.\n\nBegin with the compressible conservation laws written in index notation using the Einstein summation convention. Let $x_i$ denote the Cartesian coordinates ($i \\in \\{1,2,3\\}$), $t$ denote time, $\\rho$ denote density, $u_i$ denote velocity components, $p$ denote pressure, and $\\sigma_{ij}$ denote the viscous stress tensor. Use the small-perturbation linear acoustics relation $p' = c^2 \\rho'$ for acoustic fluctuations, where $c$ is the sound speed and a prime denotes acoustic perturbation. From this base, derive an inhomogeneous acoustic wave equation in free space for the radiated field. Then, by selecting an appropriate free-space Green's function (Green's function (GF)) and invoking the compact-source approximation with observation distance $r$ much larger than the source size, reduce the volume-integral solution to a far-field expression that depends on the volume integral of the Lighthill source term contracted with the radiation direction.\n\nDefine the canonical source for benchmarking as follows. The volume-integrated Lighthill stress tensor is\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}},\n$$\nand, for the benchmark, assume a time-harmonic form\n$$\nQ_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t),\n$$\nwhere $Q_0$ is a constant amplitude with units of newton-meter, $\\omega$ is an angular frequency in radians per second, and $S_{ij}$ is a constant, symmetric, dimensionless pattern tensor that encodes the quadrupole orientation. Let $\\mathbf{x}$ be the observer location, $r = \\|\\mathbf{x}\\|$, and $\\mathbf{n} = \\mathbf{x}/r$ be the radiation unit vector. You must use the free-space radiation solution evaluated at the retarded time $t_r = t - r/c$. The goal is to compute the far-field acoustic pressure $p'(\\mathbf{x}, t)$ in pascals at specified $(\\mathbf{x}, t)$ and source parameters.\n\nImplement a complete, runnable program that:\n- Constructs $S_{ij}$ for three benchmark patterns:\n  - A diagonal quadrupole aligned with the $x$-axis, with $S_{11} = 1$ and all other components equal to $0$.\n  - A symmetric off-diagonal quadrupole with $S_{12} = S_{21} = 1$ and all other components equal to $0$.\n  - An isotropic pattern with $S_{ij} = \\delta_{ij}$.\n- Computes the far-field compact-source acoustic pressure $p'(\\mathbf{x}, t)$ using physically consistent free-space radiation with retarded time, sound speed, and the $1/r$ decay in three dimensions.\n- Expresses the final results in pascals.\n\nDesign your algorithm to evaluate the following test suite. In all cases, answer in pascals, as a float. Use $c = 343$ $\\mathrm{m/s}$ unless otherwise specified. For each case, the observation coordinate $\\mathbf{x}$ is given in meters, the time $t$ in seconds, the amplitude $Q_0$ in newton-meter, and the angular frequency $\\omega$ in radians per second.\n\nTest suite:\n1. Happy path compact diagonal quadrupole: $S_{11} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (1, 2, 2)$; $t = 0.001$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 1000$; $c = 343$.\n2. Isotropic compact quadrupole: $S_{ij} = \\delta_{ij}$; $\\mathbf{x} = (3, 4, 0)$; $t = 0.002$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 500$; $c = 343$.\n3. Geometric null for off-diagonal symmetric quadrupole: $S_{12} = S_{21} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (0, 0, 5)$; $t = 0.010$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 200$; $c = 343$.\n4. Zero-frequency boundary case: $S_{11} = 1$, all other $S_{ij} = 0$; $\\mathbf{x} = (10, 0, 0)$; $t = 1.000$; $Q_0 = 10^{-3}$; $\\omega = 0$; $c = 343$.\n5. Extreme far field isotropic quadrupole: $S_{ij} = \\delta_{ij}$; $\\mathbf{x} = (1000, 0, 0)$; $t = 0.100$; $Q_0 = 10^{-3}$; $\\omega = 2\\pi \\cdot 50$; $c = 343$.\n\nYour program must implement the far-field compact-source solution derived from Lighthill's acoustic analogy and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $[p_1, p_2, p_3, p_4, p_5]$, where each $p_k$ is the computed float in pascals for case $k$.",
            "solution": "### Derivation of the Far-Field Quadrupole Radiation Formula\n\nThe derivation begins with the conservation of mass and momentum in a compressible fluid, written in Cartesian tensor notation with the Einstein summation convention.\n\nThe conservation of mass is:\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0 $$\nThe conservation of momentum (Navier-Stokes equations) is:\n$$ \\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j} $$\nwhere $\\rho$ is density, $u_i$ are velocity components, $p$ is pressure, and $\\sigma_{ij}$ is the viscous stress tensor.\n\nTo derive Lighthill's acoustic analogy, these equations are rearranged into the form of an inhomogeneous wave equation. First, take the time derivative of the mass equation and subtract the divergence (derivative with respect to $x_i$) of the momentum equation:\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j}\\right) - \\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\\right) $$\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_j)}{\\partial t \\partial x_j} - \\frac{\\partial^2 (\\rho u_i)}{\\partial x_i \\partial t} - \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = \\frac{\\partial^2 p}{\\partial x_i^2} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j} $$\nThe mixed-derivative terms cancel. Rearranging gives:\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p = \\frac{\\partial^2 (\\rho u_i u_j - \\sigma_{ij})}{\\partial x_i \\partial x_j} $$\nWe introduce perturbations around a stationary ambient state $(\\rho_0, p_0)$: $\\rho = \\rho_0 + \\rho'$ and $p = p_0 + p'$. For an ideal fluid with no heat conduction, the acoustic approximation relates pressure and density perturbations via the speed of sound, $c$: $p' = c^2 \\rho'$. We rewrite the equation in terms of the pressure perturbation $p'$ by substituting $\\rho' = p'/c^2$. The equation is manipulated by adding and subtracting $c^2 \\nabla^2 \\rho'$ on the left side:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2}{\\partial x_i \\partial x_j} (\\rho u_i u_j - \\sigma_{ij} + (p' - c^2 \\rho')\\delta_{ij}) $$\nUsing $p'$ as the primary variable by substituting $\\rho' = p'/c^2$ on the left-hand side yields Lighthill's equation:\n$$ \\left(\\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2\\right)p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} $$\nwhere $T_{ij} = \\rho u_i u_j + (p' - c^2 \\rho')\\delta_{ij} - \\sigma_{ij}$ is the Lighthill stress tensor. This equation is exact and is a rearrangement of the conservation laws. It describes how the sources on the right-hand side generate sound, represented by the wave operator acting on $p'$ on the left.\n\nThe solution to this inhomogeneous wave equation in an unbounded domain is found using the free-space Green's function, $G(\\mathbf{x}, t | \\mathbf{y}, \\tau) = \\frac{\\delta(t - \\tau - |\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|}$. The solution for $p'(\\mathbf{x}, t)$ is the convolution:\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} G(\\mathbf{x}, t | \\mathbf{y}, \\tau) \\frac{\\partial^2 T_{ij}(\\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\nAssuming the source terms $T_{ij}$ are localized in space, we can transfer the spatial derivatives onto the Green's function via integration by parts (twice). This gives the formal solution:\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) \\frac{\\partial^2 G(\\mathbf{x}, t | \\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\nSince $\\partial/\\partial y_i = -\\partial/\\partial x_i$ for any function of $\\mathbf{x}-\\mathbf{y}$, we can write:\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) G(\\mathbf{x}, t | \\mathbf{y}, \\tau) d^3\\mathbf{y} \\, d\\tau $$\nPerforming the time integration using the delta function property yields the Kirchhoff-Lighthill integral:\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int_{\\mathbb{R}^3} \\frac{T_{ij}(\\mathbf{y}, t-|\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|} d^3\\mathbf{y} $$\nFor a compact source located near the origin $\\mathbf{y}=0$ and an observer in the far field ($r = |\\mathbf{x}| \\gg |\\mathbf{y}|$), we apply the following approximations:\n1.  In the denominator: $|\\mathbf{x}-\\mathbf{y}| \\approx r$.\n2.  In the retarded time: $t' = t - |\\mathbf{x}-\\mathbf{y}|/c \\approx t-r/c$. This is the compact source approximation, where phase variations across the source volume are neglected.\nThe integral simplifies to:\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{1}{4\\pi r} \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t-r/c) d^3\\mathbf{y} \\right] $$\nWe define the volume-integrated Lighthill tensor $Q_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)d^3\\mathbf{y}$. The expression becomes:\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{Q_{ij}(t_r)}{4\\pi r} \\right] $$\nwhere $t_r = t - r/c$ is the retarded time. The derivatives act on both $r$ and $t_r$ as they depend on $\\mathbf{x}$. In the far field, the dominant contribution comes from the second time derivative of $Q_{ij}$. The derivatives $\\partial/\\partial x_k$ applied to terms like $1/r$ yield terms that decay faster than $1/r$ and are neglected. The chain rule on $Q_{ij}(t_r)$ gives $\\partial/\\partial x_k \\rightarrow (-n_k/c)d/dt_r$, where $n_k = x_k/r$ is the radiation direction vector. Applying two such derivatives yields the far-field result for a quadrupole:\n$$ p'(\\mathbf{x}, t) = \\frac{n_i n_j}{4\\pi r c^2} \\frac{d^2 Q_{ij}}{dt^2}\\bigg|_{t_r} = \\frac{n_i n_j}{4\\pi r c^2} \\ddot{Q}_{ij}(t - r/c) $$\nFor the specified time-harmonic source, $Q_{ij}(t) = Q_0 S_{ij} \\cos(\\omega t)$. Its second time derivative is:\n$$ \\ddot{Q}_{ij}(t) = -Q_0 \\omega^2 S_{ij} \\cos(\\omega t) $$\nSubstituting this into the far-field pressure formula and evaluating at the retarded time $t_r = t - r/c$ gives the final expression for implementation:\n$$ p'(\\mathbf{x}, t) = -\\frac{Q_0 \\omega^2}{4\\pi r c^2} (n_i S_{ij} n_j) \\cos(\\omega(t - r/c)) $$\nThe term $n_i S_{ij} n_j$ is the quadrupole directivity pattern, a scalar computed from the contraction of the radiation vector $\\mathbf{n}$ with the source tensor $S_{ij}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the far-field acoustic pressure for a set of canonical\n    Lighthill quadrupole source test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([1.0, 2.0, 2.0]),\n            \"t\": 0.001,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 1000,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([3.0, 4.0, 0.0]),\n            \"t\": 0.002,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 500,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"off_diagonal\",\n            \"x\": np.array([0.0, 0.0, 5.0]),\n            \"t\": 0.010,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 200,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([10.0, 0.0, 0.0]),\n            \"t\": 1.000,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 0,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([1000.0, 0.0, 0.0]),\n            \"t\": 0.100,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 50,\n            \"c\": 343.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_prime = calculate_far_field_pressure(\n            x=case[\"x\"],\n            t=case[\"t\"],\n            Q0=case[\"Q0\"],\n            omega=2 * np.pi * case[\"omega_hz\"],\n            c=case[\"c\"],\n            pattern=case[\"pattern\"],\n        )\n        results.append(p_prime)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\ndef calculate_far_field_pressure(x: np.ndarray, t: float, Q0: float, omega: float, c: float, pattern: str) -> float:\n    \"\"\"\n    Calculates the far-field acoustic pressure from a compact quadrupole source\n    based on Lighthill's acoustic analogy.\n\n    The formula used is:\n    p'(x, t) = - (Q0 * omega^2) / (4 * pi * r * c^2) * (n^T * S * n) * cos(omega * (t - r/c))\n    \"\"\"\n    \n    # Construct the dimensionless pattern tensor S_ij\n    S = np.zeros((3, 3))\n    if pattern == \"diagonal\":\n        S[0, 0] = 1.0\n    elif pattern == \"off_diagonal\":\n        S[0, 1] = 1.0\n        S[1, 0] = 1.0\n    elif pattern == \"isotropic\":\n        S = np.identity(3)\n\n    # Handle the zero-frequency case directly to avoid division by zero if omega is in a denominator.\n    if omega == 0.0:\n        return 0.0\n\n    # Calculate geometric terms: distance r and radiation unit vector n\n    r = np.linalg.norm(x)\n    if r == 0.0:\n        # Pressure is singular at the origin. For this problem, r > 0.\n        return np.inf\n    n = x / r\n\n    # Calculate the quadrupole directivity term (n_i * S_ij * n_j)\n    # Using numpy's @ operator for matrix-vector multiplication: n.T @ S @ n\n    directivity = n @ S @ n\n    \n    # If directivity is zero (geometric null), pressure is zero\n    if directivity == 0.0:\n        return 0.0\n\n    # Calculate the amplitude factor\n    amplitude_factor = -(Q0 * omega**2) / (4 * np.pi * r * c**2)\n    \n    # Calculate the retarded time argument of the cosine term\n    retarded_time_arg = omega * (t - r / c)\n\n    # Calculate the final acoustic pressure\n    pressure = amplitude_factor * directivity * np.cos(retarded_time_arg)\n    \n    return pressure\n\nsolve()\n```"
        }
    ]
}