{
    "hands_on_practices": [
        {
            "introduction": "瑞利-普莱塞特（Rayleigh-Plesset）方程是描述气泡动力学的基础。虽然其完整的非线性形式很复杂，但通过在平衡点附近进行线性化，我们可以解析地推导出气泡的固有共振频率——这是其声学响应的一个关键特性。本实践旨在通过推导和计算，帮助您理解线性化模型的分析能力，并量化比较等温（isothermal）和多方（polytropic）气体模型对共振频率和品质因子的影响，从而揭示热效应在气泡声学中的重要作用。",
            "id": "4117937",
            "problem": "一个平衡半径为 $R_0$ 的单个球形气泡，在低频声场的驱动下，在密度为 $\\rho_\\ell$、动力粘度为 $\\mu$、表面张力为 $\\sigma$ 的不可压缩液体中振荡。气泡内部的气体遵循以指数 $\\kappa$ 为特征的多方关系。在低声频下，热传导使气体响应趋近于等温极限 $\\kappa = 1$，而在相同环境条件下的绝热或多方模型则使用 $\\kappa = \\kappa_g  1$。严格地从球形气泡的 Rayleigh–Plesset 动量平衡方程和理想气体多方关系出发，推导围绕平衡点的线性化小振荡模型，并在气体热力学的两种模型假设下确定固有（共振）角频率和品质因数（Q）：(i) 多方过程，$\\kappa = \\kappa_g$；(ii) 等温过程，$\\kappa = 1$。品质因数（Q）在线性振子近似中定义为存储的峰值能量的 $2\\pi$ 倍与每个周期耗散的能量之比；对于弱阻尼，这等于 $Q = m \\omega_0 / c$，其中 $m$ 是有效质量系数，$\\omega_0$ 是固有角频率，$c$ 是有效线性阻尼系数。\n\n你的程序必须实现你推导出的共振频率和品质因数的公式，其中仅考虑周围液体的线性粘性阻尼。在计算阻尼时，忽略声辐射损失和液体可压缩性。假设环境静压为 $p_{\\infty 0}$，并对气泡施加力学平衡条件，使得平衡气体压力满足 $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$。对于每个测试用例，程序必须计算：\n- 多方共振频率（单位：赫兹），$f_{\\mathrm{poly}}$。\n- 多方品质因数，$Q_{\\mathrm{poly}}$。\n- 等温共振频率（单位：赫兹），$f_{\\mathrm{iso}}$。\n- 等温品质因数，$Q_{\\mathrm{iso}}$。\n- 热效应引起的偏移量 $\\Delta f = f_{\\mathrm{poly}} - f_{\\mathrm{iso}}$ 和 $\\Delta Q = Q_{\\mathrm{poly}} - Q_{\\mathrm{iso}}$。\n\n使用国际单位制（SI）：$R_0$ 单位为米，$\\rho_\\ell$ 单位为千克/立方米，$\\mu$ 单位为帕斯卡-秒，$\\sigma$ 单位为牛顿/米，$p_{\\infty 0}$ 单位为帕斯卡，频率 $f$ 单位为赫兹。如果对于任何参数集，推导出的固有频率的平方为非正值，你的程序必须在该测试用例的输出列表中，为该模型的频率和品质因数返回浮点值 $\\mathrm{nan}$。\n\n测试套件：\n- A 用例（正常路径，中等大小气泡）：$R_0 = 10\\times 10^{-6}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n- B 用例（更高共振频率，更小气泡）：$R_0 = 2\\times 10^{-6}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n- C 用例（受表面张力影响，极小气泡）：$R_0 = 2\\times 10^{-7}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含所有测试用例的结果，格式为逗号分隔的列表的列表，每个内部列表按 $[f_{\\mathrm{poly}},Q_{\\mathrm{poly}},f_{\\mathrm{iso}},Q_{\\mathrm{iso}},\\Delta f,\\Delta Q]$ 的顺序排列。例如，输出应与以下格式完全一致：\n$[[f_{\\mathrm{poly},A},Q_{\\mathrm{poly},A},f_{\\mathrm{iso},A},Q_{\\mathrm{iso},A},\\Delta f_A,\\Delta Q_A],[f_{\\mathrm{poly},B},Q_{\\mathrm{poly},B},f_{\\mathrm{iso},B},Q_{\\mathrm{iso},B},\\Delta f_B,\\Delta Q_B],[f_{\\mathrm{poly},C},Q_{\\mathrm{poly},C},f_{\\mathrm{iso},C},Q_{\\mathrm{iso},C},\\Delta f_C,\\Delta Q_C]]$。\n所有数值条目必须是使用指定 SI 单位的浮点数，频率单位为赫兹，$Q$ 为无量纲。",
            "solution": "该问题要求推导液体中球形气泡小振幅径向振荡的固有共振频率和品质因数。推导始于 Rayleigh-Plesset 方程，该方程描述了在密度为 $\\rho_\\ell$、动力粘度为 $\\mu$ 的不可压缩液体中，气泡半径 $R(t)$ 的动力学。\n\nRayleigh-Plesset 方程由下式给出：\n$$\n\\rho_\\ell \\left( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 \\right) = p_g(t) - p_\\infty(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu}{R} \\dot{R}\n$$\n此处，$p_g(t)$ 是气泡内的气体压力，$p_\\infty(t)$ 是远离气泡的液体中的压力，$\\sigma$ 是气液界面处的表面张力。点表示对时间的导数。\n\n气体压力 $p_g(t)$ 通过多方关系 $p_g(t) V(t)^\\kappa = \\text{常数}$ 与气泡体积 $V(t) = \\frac{4}{3}\\pi R(t)^3$ 相关。这意味着 $p_g(t) R(t)^{3\\kappa}$ 是一个常数。在平衡状态下，气泡半径为 $R_0$，气体压力为 $p_{g0}$。因此，瞬时气体压力为：\n$$\np_g(t) = p_{g0} \\left( \\frac{R_0}{R(t)} \\right)^{3\\kappa}\n$$\n其中 $\\kappa$ 是多方指数。对于等温过程，$\\kappa=1$；对于多方过程，给定为 $\\kappa = \\kappa_g  1$。\n\n液体中的压力 $p_\\infty(t)$ 由静态环境压力 $p_{\\infty 0}$ 和一个时变声学分量 $p_A(t)$ 组成，因此 $p_\\infty(t) = p_{\\infty 0} + p_A(t)$。在静态平衡时（$R = R_0$, $\\dot{R}=0$, $\\ddot{R}=0$, $p_A(t)=0$），Rayleigh-Plesset 方程简化为力学平衡方程：\n$$\np_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0} = 0 \\implies p_{g0} = p_{\\infty 0} + \\frac{2\\sigma}{R_0}\n$$\n这与问题陈述中提供的平衡条件相符。\n\n为了分析小振荡，我们在平衡状态附近对系统进行线性化。我们将半径表示为对平衡状态的一个小扰动：$R(t) = R_0(1 + x(t))$，其中 $|x(t)| \\ll 1$。因此，$\\dot{R} = R_0 \\dot{x}$ 且 $\\ddot{R} = R_0 \\ddot{x}$。我们将此代入 Rayleigh-Plesset 方程，并只保留 $x$ 及其导数的一次项。\n\n方程中的各项按如下方式线性化：\n- 左侧 (LHS)：$\\rho_\\ell ( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 ) = \\rho_\\ell ( R_0(1+x) R_0 \\ddot{x} + \\frac{3}{2} (R_0 \\dot{x})^2 ) \\approx \\rho_\\ell R_0^2 \\ddot{x}$。$x\\ddot{x}$ 和 $\\dot{x}^2$ 项是二阶项，予以忽略。\n- $p_g(t) = p_{g0} (1+x)^{-3\\kappa} \\approx p_{g0} (1 - 3\\kappa x)$。\n- $p_\\infty(t) = p_{\\infty 0} + p_A(t)$。\n- $\\frac{2\\sigma}{R} = \\frac{2\\sigma}{R_0(1+x)} \\approx \\frac{2\\sigma}{R_0}(1-x)$。\n- $\\frac{4\\mu \\dot{R}}{R} = \\frac{4\\mu R_0 \\dot{x}}{R_0(1+x)} \\approx 4\\mu \\dot{x}$。\n\n将这些线性化表达式代入 Rayleigh-Plesset 方程：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} \\approx \\left[ p_{g0}(1-3\\kappa x) \\right] - \\left[ p_{\\infty 0} + p_A(t) \\right] - \\left[ \\frac{2\\sigma}{R_0}(1-x) \\right] - \\left[ 4\\mu \\dot{x} \\right]\n$$\n合并各项：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left( 3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} \\right) x \\approx (p_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0}) - p_A(t)\n$$\n右侧的静态平衡项为零。我们将 $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$ 代入 $x$ 的系数中：\n$$\n3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} = 3\\kappa \\left( p_{\\infty 0} + \\frac{2\\sigma}{R_0} \\right) - \\frac{2\\sigma}{R_0} = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}\n$$\n描述气泡壁位移 $x(t)$ 的线性化运动方程变为：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left[ 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0} \\right] x = -p_A(t)\n$$\n这是一个受迫阻尼谐振子的方程，$m\\ddot{x} + c\\dot{x} + kx = F(t)$，具有以下有效系数：\n- 有效质量：$m = \\rho_\\ell R_0^2$\n- 有效阻尼系数：$c = 4\\mu$\n- 有效弹簧常数：$k = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}$\n\n无阻尼固有角频率 $\\omega_0$ 由 $\\omega_0 = \\sqrt{k/m}$ 给出。\n$$\n\\omega_0^2 = \\frac{k}{m} = \\frac{3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}}{\\rho_\\ell R_0^2}\n$$\n以赫兹为单位的固有频率为 $f_0 = \\omega_0 / (2\\pi)$。\n\n对于弱阻尼，品质因数 $Q$ 定义为 $Q = m\\omega_0/c$。代入推导出的系数：\n$$\nQ = \\frac{(\\rho_\\ell R_0^2)\\omega_0}{4\\mu}\n$$\n我们现在将这些通用公式应用于两个指定的用例。\n\n(i) 多方过程用例：$\\kappa = \\kappa_g$。\n固有角频率的平方为：\n$$\n\\omega_{0, \\text{poly}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3\\kappa_g p_{\\infty 0} + (3\\kappa_g - 1)\\frac{2\\sigma}{R_0} \\right]\n$$\n如果 $\\omega_{0, \\text{poly}}^2  0$，则多方共振频率为 $f_{\\text{poly}} = \\frac{\\sqrt{\\omega_{0, \\text{poly}}^2}}{2\\pi}$，品质因数为 $Q_{\\text{poly}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{poly}}^2}}{4\\mu}$。\n\n(ii) 等温过程用例：$\\kappa = 1$。\n固有角频率的平方为：\n$$\n\\omega_{0, \\text{iso}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3(1) p_{\\infty 0} + (3(1) - 1)\\frac{2\\sigma}{R_0} \\right] = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3 p_{\\infty 0} + \\frac{4\\sigma}{R_0} \\right]\n$$\n如果 $\\omega_{0, \\text{iso}}^2  0$，则等温共振频率为 $f_{\\text{iso}} = \\frac{\\sqrt{\\omega_{0, \\text{iso}}^2}}{2\\pi}$，品质因数为 $Q_{\\text{iso}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{iso}}^2}}{4\\mu}$。\n\n如果任一用例的 $\\omega_0^2$ 为非正值，则相应的频率和 Q 因数未定义，并将报告为 `nan`。对于给定的物理参数（$\\rho_\\ell, \\mu, \\sigma, p_{\\infty 0}, R_0  0$ 且 $\\kappa \\ge 1$），$k$ 项始终为正，因此 $\\omega_0^2$ 将为正。\n\n程序将实现这些公式，为每个测试用例计算 $f_{\\text{poly}}$、$Q_{\\text{poly}}$、$f_{\\text{iso}}$、$Q_{\\text{iso}}$ 以及差值 $\\Delta f = f_{\\text{poly}} - f_{\\mathrm{iso}}$ 和 $\\Delta Q = Q_{\\mathrm{poly}} - Q_{\\mathrm{iso}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bubble resonance problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    # Each tuple contains: (R0, rho_l, mu, sigma, p_inf0, kappa_g)\n    test_cases = [\n        # Case A (happy path, moderate bubble)\n        (10e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case B (higher resonance, smaller bubble)\n        (2e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case C (surface-tension-influenced, very small bubble)\n        (2e-7, 998, 1.0e-3, 0.072, 101325, 1.4),\n    ]\n\n    def calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa):\n        \"\"\"\n        Calculates resonance frequency (Hz) and Quality factor for a bubble.\n\n        Args:\n            R0 (float): Equilibrium radius in meters.\n            rho_l (float): Liquid density in kg/m^3.\n            mu (float): Liquid dynamic viscosity in Pa*s.\n            sigma (float): Surface tension in N/m.\n            p_inf0 (float): Ambient static pressure in Pa.\n            kappa (float): Polytropic exponent.\n\n        Returns:\n            tuple[float, float]: A tuple containing the resonance frequency (f0)\n                                 and the Quality factor (Q). Returns (nan, nan)\n                                 if resonance frequency is not real.\n        \"\"\"\n        # Numerator of the omega_0^2 expression, related to the effective spring constant k\n        # k = 3*kappa*p_inf0 + (3*kappa - 1) * 2*sigma/R0\n        k_numerator = 3 * kappa * p_inf0 + (3 * kappa - 1) * (2 * sigma / R0)\n\n        # Denominator of the omega_0^2 expression, related to the effective mass m\n        # m = rho_l * R0^2\n        m_denominator = rho_l * R0**2\n        \n        if k_numerator = 0 or m_denominator = 0:\n            return np.nan, np.nan\n\n        # Squared natural angular frequency (rad/s)^2\n        omega0_sq = k_numerator / m_denominator\n\n        # Natural angular frequency in rad/s\n        omega0 = np.sqrt(omega0_sq)\n\n        # Natural frequency in Hz\n        f0 = omega0 / (2 * np.pi)\n\n        # Quality factor Q = m * omega0 / c, where m = rho_l * R0^2 and c = 4 * mu\n        Q = (rho_l * R0**2 * omega0) / (4 * mu)\n        \n        return f0, Q\n\n    results = []\n    for case in test_cases:\n        R0, rho_l, mu, sigma, p_inf0, kappa_g = case\n\n        # (i) Polytropic case\n        f_poly, Q_poly = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa_g)\n\n        # (ii) Isothermal case\n        f_iso, Q_iso = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, 1.0)\n        \n        # Calculate differences\n        if np.isnan(f_poly) or np.isnan(f_iso):\n            delta_f = np.nan\n        else:\n            delta_f = f_poly - f_iso\n            \n        if np.isnan(Q_poly) or np.isnan(Q_iso):\n            delta_Q = np.nan\n        else:\n            delta_Q = Q_poly - Q_iso\n\n        case_results = [f_poly, Q_poly, f_iso, Q_iso, delta_f, delta_Q]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    # Using map(str, ...) and join is robust for formatting the final string.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        },
        {
            "introduction": "从简化的线性模型过渡到完整的非线性瑞利-普莱塞特方程后，我们会遇到一个重大的计算挑战：刚性（stiffness）。当气泡经历剧烈地坍缩时，其半径变化的时间尺度会变得极小，对数值积分器的稳定性提出了严苛的要求。本实践作为一个概念性练习，要求您基于对空化动力学物理特性的理解，辨别出能够准确、高效地求解这类刚性常微分方程系统的数值积分器所必须具备的核心特征。",
            "id": "4117911",
            "problem": "考虑一个在水中的单个球形气泡，受到时变远场声压的作用。气泡动力学通过一个球对称动量平衡模型进行建模，该模型与气体的状态方程和液体的本构定律耦合。一个广泛使用的模型是 Rayleigh–Plesset 方程族及其可压缩扩展（称为 Keller–Miksis 方程），该模型与质量和动量守恒一致，并包含了表面张力、粘性和液体可压缩性的影响。在其常见形式中，气泡半径 $R(t)$ 的控制方程可以写成一个关于 $R(t)$ 的二阶常微分方程，该方程平衡了惯性项 $R \\ddot{R}$ 和 $\\dot{R}^2$ 与压力差、与 $\\dot{R}/R$ 成正比的粘性应力、与 $1/R$ 成正比的表面张力，可能还会增加与 $\\dot{R}/c$ 和压力差的时间导数成比例的项，以考虑液体中有限的声速 $c$。通过引入状态变量 $x_1(t) = R(t)$ 和 $x_2(t) = \\dot{R}(t)$，气泡动力学成为一个一阶非线性系统 $\\dot{\\mathbf{x}} = \\mathbf{f}(t, \\mathbf{x})$。\n\n与声场的耦合通过给定的远场压力 $p_{\\infty}(t)$ 实现，例如 $p_{\\infty}(t) = p_0 + p_a \\sin(2 \\pi f t)$，其中 $p_0$ 是静态偏置压力，$p_a$ 是声振幅，$f$ 是频率。气泡内的气体压力 $p_g(R,t)$ 通过本构定律依赖于 $R(t)$，该定律可能随 $R(t)$ 或 Péclet 数变化，导致系统在塌缩和反弹期间的有效刚度发生剧烈变化。在剧烈塌缩附近，$R(t)$ 可以接近由所选气体模型确定的最小值 $R_{\\min}$（例如，van der Waals 硬核半径），并且 $R(t)$ 保持连续，而其导数如 $\\dot{R}(t)$ 和 $\\ddot{R}(t)$ 会发生非常迅速的变化。在实践中，分段物理模型（例如，根据热时间尺度准则切换气体多方指数）可以在事件阈值处引入加速度 $\\ddot{R}(t)$ 的不连续性。液体属性是典型的水属性：密度 $\\rho$、动力粘度 $\\mu$、表面张力 $\\sigma$ 和声速 $c$。\n\n从第一性原理出发，刚性的产生是因为系统表现出大范围分离的时间尺度。三个相关的时间尺度是：\n- 声驱动周期 $T_a = 1/f$。\n- 声波穿过气泡的传播时间 $\\tau_c \\sim R/c$。\n- 粘性扩散穿过气泡的时间 $\\tau_{\\nu} \\sim R^2/\\nu$，其中 $\\nu = \\mu/\\rho$ 是运动粘度。\n\n对于典型的参数，$R_0$ 在微米量级，$c$ 在数千米/秒量级，$f$ 在数百千赫兹量级，我们有 $\\tau_c \\ll T_a$。在塌缩附近，当 $R(t)$ 变得非常小时，$\\tau_c$ 和 $\\tau_{\\nu}$ 都可以减小几个数量级，从而产生雅可比矩阵 $\\partial \\mathbf{f}/\\partial \\mathbf{x}$ 的大特征值，进而导致刚性。精确的空化计算声学要求数值方法在这些条件下保持稳定和准确，能够调整时间步长以解析快速瞬变，并能检测和定位模型条件或定性行为发生变化的事件（例如，$R(t) - R_{\\min} = 0$ 或 $\\dot{R}(t) = 0$）。\n\n从这些物理定律和时间尺度论证出发，选择最合适的时间积分器来数值求解具有剧烈塌缩的 Rayleigh–Plesset/Keller–Miksis 初值问题。该积分器必须：\n- 为由快速瞬变和小 $R(t)$ 引起的刚性动力学提供鲁棒的稳定性，这通常需要隐式方法，最好是 A-稳定或 L-稳定的。\n- 包括基于局部截断误差的自适应步长和（如果适用）自适应阶数控制，以便在 $|\\dot{R}|$ 和 $|\\ddot{R}|$ 增大时自动减小步长。\n- 通过求根提供事件处理，能够使用密集输出或连续扩展精确地定位诸如 $g_1(t,\\mathbf{x}) = R(t) - R_{\\min}$ 和 $g_2(t,\\mathbf{x}) = \\dot{R}(t)$ 等函数的零点，从而在正确的时间忠实地捕捉具有不连续导数的连续 $R(t)$。\n\n对于与声场耦合的空化动力学，哪种选择最能满足上述要求？\n\nA. 使用经典的显式 Runge–Kutta $(\\text{RK}45)$ 方法，该方法具有嵌入式误差估计器，但使用固定的步长 $\\Delta t = T_a/100$，并通过在 $R_{\\min}$ 处钳制 $R(t)$ 来处理塌缩，不使用求根，在离散网格上越过最小值点。\n\nB. 使用变阶后向分化公式 (BDF) 方法，该方法采用隐式 Newton 迭代和基于雅可比矩阵的线性求解，由局部误差估计驱动的自适应步长和阶数控制，以及通过密集输出（连续扩展）实现的针对 $g_1(t,\\mathbf{x})$ 和 $g_2(t,\\mathbf{x})$ 的求根事件检测，以在用户指定的公差内定位事件。\n\nC. 使用辛 Störmer–Verlet 积分器，其常数 $\\Delta t$ 经过调整以保守气泡动力学的哈密顿代理量，依赖于长时能量行为而非局部误差，并且不实现事件检测。\n\nD. 使用显式 Adams–Bashforth 多步法，该方法具有基于局部截断误差的自适应步长，但没有隐式阶段，仅在连续时间步之间符号发生变化时识别事件，而不使用密集输出插值。\n\nE. 使用一种刚性精确的隐式 Runge-Kutta 配置方法，例如 5 阶的 Radau IIA，具有自适应步长控制、用于阶段方程的 Newton 迭代，以及基于插值的密集输出来对 $g_1(t,\\mathbf{x})$ 和 $g_2(t,\\mathbf{x})$ 进行求根，从而确保 A-稳定性/L-稳定性及精确的事件定位。\n\n选择所有适用项。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤1：提取已知条件\n- **物理系统：** 一个在水中的单个球形气泡，受到远场声压 $p_{\\infty}(t) = p_0 + p_a \\sin(2 \\pi f t)$ 的作用。\n- **控制模型：** 气泡半径演化 $R(t)$ 由 Rayleigh–Plesset/Keller–Miksis 方程族的二阶非线性常微分方程（ODE）描述。\n- **方程结构：** 该常微分方程平衡了惯性项（$R \\ddot{R}$、$\\dot{R}^2$）与压力、粘性应力（$\\propto \\dot{R}/R$）和表面张力（$\\propto 1/R$），并可能包含考虑液体可压缩性的扩展项（涉及声速 $c$ 的项）。\n- **状态空间形式：** 该问题被转换为一阶系统 $\\dot{\\mathbf{x}} = \\mathbf{f}(t, \\mathbf{x})$，状态变量为 $x_1(t) = R(t)$ 和 $x_2(t) = \\dot{R}(t)$。\n- **关键动力学：** 系统表现出剧烈塌缩，其中 $R(t)$ 接近最小值 $R_{\\min}$，而导数如 $\\dot{R}(t)$ 和 $\\ddot{R}(t)$ 变化非常迅速。分段物理模型可能引入 $\\ddot{R}(t)$ 的不连续性。\n- **刚性来源：** 由于时间尺度差异巨大，问题是刚性的：声驱动周期 $T_a = 1/f$、声传播时间 $\\tau_c \\sim R/c$ 和粘性扩散时间 $\\tau_{\\nu} \\sim R^2/\\nu$。在塌缩附近，$R(t)$ 变得非常小，导致 $\\tau_c$ 和 $\\tau_{\\nu}$ 减小，从而产生系统雅可比矩阵 $\\partial \\mathbf{f}/\\partial \\mathbf{x}$ 的大特征值。\n- **数值要求：** 问题要求选择最合适的时间积分器，满足三个特定标准：\n    1.  **刚性动力学的稳定性：** 鲁棒性，要求隐式方法，最好是 A-稳定或 L-稳定。\n    2.  **自适应性：** 基于局部截断误差的自适应步长和阶数控制。\n    3.  **事件处理：** 使用密集输出或连续扩展进行求根，精确地定位事件函数（例如，$g_1(t,\\mathbf{x}) = R(t) - R_{\\min}$ 或 $g_2(t,\\mathbf{x}) = \\dot{R}(t)$）的零点。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于气泡动力学和计算声学的既定物理学。Rayleigh–Plesset 和 Keller–Miksis 方程是标准模型。关于由不同时间尺度引起的数值刚性的描述是准确的，并且是该领域的核心。所有陈述都与流体动力学和数值分析的基本原理一致。\n- **适定性：** 该问题是适定的。它描述了一个常微分方程组的初值问题，并要求根据一组清晰、明确定义的标准选择合适的数值方法。这是科学计算中的一个标准且有意义的问题。\n- **客观性：** 语言技术性强、精确且没有主观性。对数值方法的要求是用数值分析的既定术语表述的。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、适定的和客观的。它完整且一致地描述了一个物理系统及其模拟相关的数值挑战。因此，该问题是**有效的**。接下来的分析将根据所述要求评估给定的选项。\n\n### 求解推导\n问题的核心是为具有高度瞬变行为和关键事件的刚性、非线性常微分方程组选择一个数值积分器。问题陈述中列出的三个要求——刚性稳定性、自适应性和精确的事件处理——是我们评估的基准。\n\n1.  **刚性：** 该问题是刚性的，尤其是在气泡塌缩期间。显式数值方法的稳定性区域是有限的，为了避免数值不稳定性，将被迫采用极小的时间步长，使得模拟成本过高或不稳定。这需要使用具有强稳定性（如 A-稳定性，理想情况下是 L-稳定性）的**隐式方法**，以有效处理大范围的时间尺度。\n2.  **自适应性：** 解的时间尺度在缓慢增长和剧烈塌缩之间变化巨大。固定步长效率极低。**自适应步长控制**至关重要，它只在需要时（塌缩期间）使用小步长，而在其他时候使用大步长，从而确保准确性和效率。\n3.  **事件处理：** 物理过程涉及关键事件，例如气泡达到其最小半径（$R(t) = R_{\\min}$）或其速度为零（$\\dot{R}(t)=0$）。精确地定位这些事件的时间至关重要。这需要一个**求根机制**与积分器的**密集输出**（连续扩展）功能相结合，从而可以在离散时间步之间对解进行精确插值。\n\n我们现在根据这三个标准评估每个选项。\n\n#### 选项 A\n该选项提出了一个具有固定步长的经典显式 Runge–Kutta 方法 (RK45)。\n- **刚性：** 作为一种**显式**方法，RK45 完全不适用于刚性问题。其稳定性将施加一个比任何精度要求都严格得多的步长限制，使得模拟成本高得令人望而却步或不稳定。\n- **自适应性：** 该方案指定了**固定步长**，这对于气泡塌缩和反弹的瞬态动力学来说是低效的。\n- **事件处理：** 建议的在 $R_{\\min}$ 处“钳制”$R(t)$ 并在离散网格上前进是一种粗糙、不准确且物理上不正确的方式来处理反弹。它不使用求根，也无法精确定位事件时间。\n**结论：不正确。** 此方法未能满足任何一个基本要求。\n\n#### 选项 B\n该选项提出了一个变阶后向分化公式 (BDF) 方法。\n- **刚性：** **BDF 方法**是专门为**刚性常微分方程**设计的经典且高效的隐式多步法族。它们至少是刚性稳定的，低阶 BDF 是 A-稳定或 L-稳定的。使用 Newton 迭代和雅可比矩阵是在每个步骤中求解隐式方程的标准程序。此标准完全满足。\n- **自适应性：** 该方案明确包括**自适应步长和阶数控制**，这是现代 BDF 求解器（如 `VODE`、`CVODE` 或 MATLAB 的 `ode15s`）的一个关键特性，非常适合瞬态问题。\n- **事件处理：** 该方案包括通过**密集输出**实现的**求根事件检测**，这是精确定位事件时间的最新方法。\n**结论：正确。** 此选项描述了一种鲁棒、高效且准确的方法，完全符合解决此问题的所有规定要求。\n\n#### 选项 C\n该选项提出了一个辛 Störmer–Verlet 积分器。\n- **刚性：** 辛积分器设计用于在非耗散（哈密顿）系统中守恒某些量。气泡动力学方程包含粘性项（$\\mu$），使系统成为耗散系统。此外，Störmer-Verlet 是一种**显式**方法，不适用于刚性问题。\n- **自适应性：** 它指定了**常数 $\\Delta t$**，这是不合适的。它对长期能量守恒的依赖对于这个问题来说是一个错误的重点，因为在短暂、剧烈的塌缩期间，局部精度至关重要。\n- **事件处理：** 它明确指出**不进行事件检测**，未能满足一个关键要求。\n**结论：不正确。** 此积分器从根本上与问题的物理特性（耗散性、刚性）和数值要求不匹配。\n\n#### 选项 D\n该选项提出了一个显式 Adams–Bashforth 多步法。\n- **刚性：** 与 RK45 一样，Adams–Bashforth 方法是**显式**的，其小的稳定性区域使其不稳定且不适用于刚性问题。\n- **自适应性：** 虽然它提到了自适应性，但主要失败在于刚性。\n- **事件处理：** 仅通过离散步之间的符号变化来识别事件的方法是原始的、不准确的，并且可能完全错过事件。它缺乏所要求的精确机制（带密集输出的求根）。\n**结论：不正确。** 此方法在刚性稳定性的关键要求上失败，并采用了不充分的事件检测方法。\n\n#### 选项 E\n该选项提出了一种刚性精确的隐式 Runge–Kutta (IRK) 配置方法，如 Radau IIA。\n- **刚性：** IRK 方法，特别是 Radau 和 Gauss-Legendre 族，是为高精度求解刚性常微分方程而设计的。**Radau IIA 方法是 L-稳定的**，这是一个优秀的特性，可以抑制无限刚性的分量并提供鲁棒的稳定性。使用 Newton 迭代求解阶段方程是标准做法。此标准完全满足。\n- **自适应性：** 该选项指定了**自适应步长控制**，这是现代 IRK 实现（如 MATLAB 的 `ode23s` 或 SciPy 中带有 'Radau' 选项的 `solve_ivp`）的标准特性。\n- **事件处理：** 该方案正确地指定了使用**基于插值的密集输出**进行求根。配置方法自然地提供了一个高阶多项式插值，非常适合此目的。\n**结论：正确。** 此选项与选项 B 一样，描述了一种适用于该问题的、最先进且高度合适的方法。它通过一个强大的、单步的、L-稳定的积分器满足了所有三个要求。\n\nBDF 方法和像 Radau IIA 这样的刚性精确隐式 Runge-Kutta 方法都被认为是解决此类问题的首选。由于问题要求选择所有适用项，因此 B 和 E 都是正确的。",
            "answer": "$$\\boxed{BE}$$"
        },
        {
            "introduction": "掌握了气泡振荡的基本物理模型和求解非线性动力学的数值方法后，我们便可以挑战一个更接近实际应用的复杂场景。本实践将模拟一个靠近刚性壁面的气泡，在声场作用下，其径向脉动与其平移运动相互耦合。您需要建立一个耦合的微分方程组，其中包含了由声场梯度产生的比耶克尼斯力（Bjerknes force），并通过数值求解来预测气泡的运动轨迹，判断其是否会撞击壁面。",
            "id": "4117935",
            "problem": "一个初始半径为 $R_0$ 的单个球形气泡，在密度为 $\\rho_\\ell$、动力粘度为 $\\mu$、表面张力为 $\\sigma$ 的静止牛顿流体中，靠近位于 $x=0$ 的刚性平壁振荡。气泡中心被约束在沿壁面法向坐标 $x(t)0$ 的一维运动上。该流体由一个与刚性壁面条件相符的一维驻波声场驱动，其声压为 $p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$，其中 $k=\\omega/c$，$c$ 为水中声速。在声场作用下，气泡经历耦合的径向和移动动力学。您必须通过第一性原理推导和数值模拟，对于一组给定的参数，确定气泡是否会撞击壁面（即，在指定的模拟时间范围内，是否存在某个时刻 $t$ 使得 $x(t)-R(t)\\le 0$），如果会，确定首次撞击发生的时间。\n\n您的模型和算法必须从适用于计算声学和空化动力学的有效基本原理推导得出。从应用于气泡界面径向运动和包含附加质量效应的气泡移动的牛顿第二定律出发，并使用经过充分检验的本构关系。需使用以下基于物理的模型假设：\n\n- 气泡内的气体压力遵循多方定律 $p_g(R)=p_{g0}\\left(\\dfrac{R_0}{R}\\right)^{3\\gamma}$，其中 $\\gamma$ 是多方指数，$p_{g0}$ 是与 $t=0$ 时刻力学平衡状态相符的初始气体压力。\n- 远离气泡的远场液体压力为 $p_\\infty(t)=p_0+p_{\\mathrm{ac}}(x(t),t)$，其中 $p_0$ 是环境静压。\n- 气泡界面的径向动力学源于不可压缩、无旋液体流中界面处的法向应力平衡，并加入了适用于小马赫数空化的粘性和毛细管修正。该动力学必须表示为关于 $R(t)$ 的二阶常微分方程。\n- 沿 $x(t)$ 的移动动力学遵循适用于时变附加质量物体的牛顿第二定律。将流体动力附加质量建模为 $m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$，其中 $C_m$ 是势流中球体的附加质量系数，$\\rho_\\ell$ 是液体密度，$V(t)=\\dfrac{4}{3}\\pi R^3(t)$ 是瞬时气泡体积。模型中需包括适用于小雷诺数的粘性阻力，以及由作用于瞬时气泡体积的声场压力梯度产生的主 Bjerknes 力。\n- 主 Bjerknes 力定义为沿 $x$ 方向的 $F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$。使用给定的 $p_{\\mathrm{ac}}(x,t)$ 获得 $F_B(t)$ 作为 $R(t)$、$x(t)$ 和 $t$ 的显式函数。\n- 采用沿 $x$ 方向的洁净气泡 Stokes 阻力 $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$。\n- 以 $ \\dfrac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$ 的形式实现移动动力学，以正确地考虑 $m_{\\mathrm{eff}}(t)$ 的时间变化。\n\n您必须：\n\n1. 根据所述物理假设，推导状态向量 $[R(t),\\dot{R}(t),x(t),\\dot{x}(t)]$ 的耦合常微分方程组。\n2. 实现一个鲁棒的数值积分器来演化状态，直到达到模拟时间上限 $T_{\\mathrm{end}}$ 或发生壁面撞击事件 $x(t)-R(t)=0$。壁面撞击条件必须作为一个在首次发生时终止积分的事件来实现。\n3. 对于每个测试用例，以浮点数形式报告首次撞击时间（单位：秒）。如果在 $T_{\\mathrm{end}}$ 内没有发生撞击，则报告 $-1.0$。\n\n使用以下常数和单位：$\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$，$\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，$\\sigma=0.072\\,\\mathrm{N/m}$，$p_0=101325\\,\\mathrm{Pa}$，$c=1480\\,\\mathrm{m/s}$，$C_m=0.5$ 以及 $\\gamma=1.4$。初始气体压力必须满足 $t=0$ 时的力学平衡条件 $p_g(R_0) = p_0 + \\dfrac{2\\sigma}{R_0}$。\n\n测试套件（每个用例指定 $P_A$（单位：帕斯卡）、$f$（单位：赫兹）、$R_0$（单位：米）、$x_0$（单位：米）和 $T_{\\mathrm{end}}$（单位：秒）；角度通过 $\\sin(\\cdot)$ 和 $\\cos(\\cdot)$ 隐式地以弧度为单位）：\n\n- 用例1（Minnaert 共振附近、中等振幅的一般情况）：$P_A=80000$，$f=300000$，$R_0=8\\times 10^{-6}$，$x_0=6.0\\times 10^{-4}$，$T_{\\mathrm{end}}=1.0\\times 10^{-3}$。\n- 用例2（更高振幅和更近距离下的理想路径撞击）：$P_A=150000$，$f=300000$，$R_0=8\\times 10^{-6}$，$x_0=1.0\\times 10^{-4}$，$T_{\\mathrm{end}}=5.0\\times 10^{-4}$。\n- 用例3（边界条件掠过情景）：$P_A=120000$，$f=330000$，$R_0=1.0\\times 10^{-5}$，$x_0=1.08\\times R_0$，$T_{\\mathrm{end}}=2.0\\times 10^{-4}$。\n- 用例4（极低振幅的边缘情况）：$P_A=5000$，$f=100000$，$R_0=1.0\\times 10^{-5}$，$x_0=5.0\\times 10^{-5}$，$T_{\\mathrm{end}}=1.0\\times 10^{-3}$。\n\n您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个条目是按上述顺序对应的用例的撞击时间（单位：秒），使用单位 $\\mathrm{s}$，并遵循惯例，即 $-1.0$ 表示在 $T_{\\mathrm{end}}$ 内没有发生撞击。例如：$[t_1,t_2,t_3,t_4]$，其中每个 $t_i$ 是一个以秒为单位的浮点数。",
            "solution": "用户提供的问题已经过分析并被确定为有效。以下各节提供了控制方程的完整推导以及为求解这些方程而设计的数值算法的描述。\n\n首先，我们确定问题陈述的有效性。\n该问题具有科学依据、是良定的且客观的。它描述了声场驱动下靠近刚性壁面的单个气泡的耦合径向和移动动力学，这是空化动力学领域的一个典型问题。\n给定条件如下：\n- 液体属性：密度 $\\rho_\\ell$、动力粘度 $\\mu$、表面张力 $\\sigma$。\n- 环境条件：静压 $p_0$、声速 $c$。\n- 几何设置：刚性壁面位于 $x=0$，气泡中心位于 $x(t)$。\n- 初始条件：初始半径 $R_0$、初始位置 $x_0$。液体为“静止”，意味着初始速度 $\\dot{R}(0)=0$ 和 $\\dot{x}(0)=0$。\n- 声场：$p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$，其中 $k=\\omega/c$ 且 $\\omega=2\\pi f$。\n- 气体属性：多方行为 $p_g(R)=p_{g0}\\left(R_0/R\\right)^{3\\gamma}$，初始力学平衡条件为 $p_{g0} = p_0 + 2\\sigma/R_0$。\n- 动力学模型：\n  - 径向运动由一个从法向应力平衡推导出的关于 $R(t)$ 的二阶常微分方程控制。\n  - 沿 $x(t)$ 的移动源于带时变附加质量的牛顿第二定律：$\\frac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$。\n  - 附加质量：$m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$，其中 $V(t)=\\frac{4}{3}\\pi R^3(t)$。\n  - 主 Bjerknes 力：$F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$。\n  - Stokes 阻力：$F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$。\n- 常数：$\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$、$\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$、$\\sigma=0.072\\,\\mathrm{N/m}$、 $p_0=101325\\,\\mathrm{Pa}$、 $c=1480\\,\\mathrm{m/s}$、 $C_m=0.5$、 $\\gamma=1.4$。\n- 任务：对于每个测试用例（$P_A, f, R_0, x_0, T_{\\mathrm{end}}$），找出首次撞击时间 $t_{\\mathrm{impact}}$（即 $x(t)-R(t) \\le 0$ 的时刻），如果到 $T_{\\mathrm{end}}$ 仍未发生撞击，则报告 $-1.0$。\n\n该问题不违反任何科学原理。所规定的模型（用于径向动力学的 Rayleigh-Plesset 方程，用于移动的 Bjerknes 力和附加质量形式体系）是标准的，并且适用于此物理范畴。该设置是自洽的，并且可以数学形式化为一个具有明确定义的初始条件的常微分方程组（ODEs）。因此，该问题被视为有效，并推导出求解方案。\n\n系统在任意时刻 $t$ 的状态可由状态向量 $Y(t) = [R(t), \\dot{R}(t), x(t), \\dot{x}(t)]^T$ 描述。为求解该状态的演化，我们建立一个包含四个耦合一阶常微分方程的方程组 $\\dot{Y} = f(t, Y)$。令 $y_1=R$，$y_2=\\dot{R}$，$y_3=x$ 及 $y_4=\\dot{x}$。该方程组为：\n$$\n\\begin{cases}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\ddot{R}(t) \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\ddot{x}(t)\n\\end{cases}\n$$\n现在我们必须根据问题中概述的物理原理，推导二阶导数 $\\ddot{R}$ 和 $\\ddot{x}$ 的表达式。\n\n径向动力学由 Rayleigh-Plesset 方程控制，该方程源于球坐标下不可压缩流体的动量方程，并结合了气泡界面处的法向应力平衡。该方程为：\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( p_B(t) - p_\\infty(t) \\right) $$\n此处，$p_B(t)$ 是气泡壁处的液体压力，$p_\\infty(t) = p_0 + p_{\\mathrm{ac}}(x(t), t)$ 是远离气泡的压力。压力 $p_B(t)$ 通过法向应力平衡与内部气体压力 $p_g(t)$、表面张力 $\\sigma$ 和粘性应力相关联：\n$$ p_B(t) = p_g(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} $$\n将此式代入 Rayleigh-Plesset 方程，并使用给定的 $p_g$ 和 $p_\\infty$ 表达式，可得：\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) $$\n对 $\\ddot{R}$ 求解，我们得到方程组中的第二个常微分方程：\n$$ \\ddot{R} = \\frac{1}{R\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) - \\frac{4\\mu\\dot{R}}{\\rho_\\ell R^2} - \\frac{3\\dot{R}^2}{2R} $$\n\n移动动力学由适用于时变质量物体的牛顿第二定律控制，写作 $\\frac{d}{dt}(m_{\\mathrm{eff}}\\dot{x}) = F_{\\mathrm{net}}$。展开导数并对加速度 $\\ddot{x}$ 求解，可得：\n$$ \\ddot{x} = \\frac{1}{m_{\\mathrm{eff}}} \\left( F_{\\mathrm{net}} - \\dot{m}_{\\mathrm{eff}}\\dot{x} \\right) $$\n净外力是主 Bjerknes 力 $F_B$ 和阻力之和。问题将方程定义为 $F_B - F_D$，其中 $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ 是 Stokes 阻力。这意味着阻力分量为 $-F_D$。Bjerknes 力为 $F_B(t) = -V(t) \\nabla p_{\\mathrm{ac}}$。$x$ 方向的压力梯度为 $\\frac{\\partial p_{\\mathrm{ac}}}{\\partial x} = -k P_A \\sin(kx) \\sin(\\omega t)$。因此：\n$$ F_B(t) = - \\left(\\frac{4}{3}\\pi R^3\\right) \\left(-k P_A \\sin(kx) \\sin(\\omega t)\\right) = \\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) $$\n有效附加质量为 $m_{\\mathrm{eff}}(t) = C_m \\rho_\\ell V(t) = C_m \\rho_\\ell \\frac{4}{3}\\pi R^3$。其时间导数为 $\\dot{m}_{\\mathrm{eff}}(t) = C_m \\rho_\\ell (4\\pi R^2 \\dot{R})$。\n将这些代入 $\\ddot{x}$ 的方程中：\n$$ \\ddot{x} = \\frac{F_B - F_D}{m_{\\mathrm{eff}}} - \\frac{\\dot{m}_{\\mathrm{eff}}}{m_{\\mathrm{eff}}}\\dot{x} = \\frac{\\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) - 6\\pi \\mu R \\dot{x}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3} - \\frac{C_m \\rho_\\ell 4\\pi R^2 \\dot{R}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3}\\dot{x} $$\n化简此表达式可得到我们方程组中的第四个常微分方程：\n$$ \\ddot{x} = \\frac{k P_A \\sin(kx) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\frac{9\\mu}{2C_m \\rho_\\ell R^2}\\dot{x} - \\frac{3\\dot{R}}{R}\\dot{x} $$\n\n完整的一阶常微分方程组为：\n$$\n\\begin{align*}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\frac{1}{y_1 \\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{y_1}\\right)^{3\\gamma} - \\frac{2\\sigma}{y_1} - p_0 - P_A \\cos(k y_3) \\sin(\\omega t) \\right) - \\frac{4\\mu y_2}{\\rho_\\ell y_1^2} - \\frac{3y_2^2}{2y_1} \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\frac{k P_A \\sin(k y_3) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\left( \\frac{9\\mu}{2C_m \\rho_\\ell y_1^2} + \\frac{3y_2}{y_1} \\right) y_4\n\\end{align*}\n$$\n对应于静止气泡的初始条件为 $Y_0 = [R_0, 0, x_0, 0]^T$。\n\n为求解此初值问题，我们采用一个数值常微分方程求解器。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是一个合适的选择，它提供了鲁棒的自适应步长 Runge-Kutta 方法。每个测试用例的模拟从 $t=0$ 运行到 $t=T_{\\mathrm{end}}$。\n一个关键要求是检测与壁面撞击的时刻。撞击条件是 $x(t) - R(t) \\le 0$。我们将其实现为常微分方程求解器的一个终止事件。我们定义一个事件函数 $g(t,Y) = y_3(t) - y_1(t)$。求解器被指示去寻找该函数的根（即当 $g(t,Y)=0$ 时）并在首次发生时终止积分。由于气泡起始时满足 $x_0  R_0$，事件函数初始为正，因此我们寻找一个向负方向的零点穿越。\n算法按如下步骤进行：对于每个测试用例，我们设置好所有的物理参数和初始条件。然后我们使用常微分方程组、时间区间 $[0, T_{\\mathrm{end}}]$、初始状态向量和壁面撞击事件函数来调用 `solve_ivp`。如果求解器检测到事件，对应的时间被记录为撞击时间。如果积分完成至 $T_{\\mathrm{end}}$ 仍未发生任何事件，则表示没有撞击，结果记录为 $-1.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the coupled equations for bubble radius and translation\n    to determine the wall impact time.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # All values are in SI units.\n    RHO_L = 1000.0  # kg/m^3\n    MU = 1.0e-3    # Pa*s\n    SIGMA = 0.072   # N/m\n    P0 = 101325.0  # Pa\n    C = 1480.0     # m/s\n    C_M = 0.5      # Added-mass coefficient (dimensionless)\n    GAMMA = 1.4    # Polytropic exponent (dimensionless)\n\n    # --- Test Cases ---\n    # Each case: (P_A [Pa], f [Hz], R_0 [m], x_0 [m], T_end [s])\n    test_cases = [\n        (80000.0, 300000.0, 8.0e-6, 6.0e-4, 1.0e-3),\n        (150000.0, 300000.0, 8.0e-6, 1.0e-4, 5.0e-4),\n        (120000.0, 330000.0, 1.0e-5, 1.08 * 1.0e-5, 2.0e-4),\n        (5000.0, 100000.0, 1.0e-5, 5.0e-5, 1.0e-3),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        P_A, f, R0, x0, T_end = case\n        \n        # --- Derived Parameters ---\n        omega = 2.0 * np.pi * f\n        k = omega / C\n        pg0 = P0 + 2.0 * SIGMA / R0\n\n        # --- Pack parameters for the solver ---\n        params = (RHO_L, MU, SIGMA, P0, C_M, GAMMA, P_A, omega, k, R0, pg0)\n\n        def ode_system(t, y, params):\n            \"\"\"\n            Defines the coupled system of 4 first-order ODEs.\n            y = [R, R_dot, x, x_dot]\n            \"\"\"\n            R, R_dot, x, x_dot = y\n            rho_l, mu, sigma, p0, c_m, gamma, pa, w, k_wave, r0, pg_0 = params\n            \n            # Defensive check for non-physical radius\n            if R = 0:\n                return [0, 0, 0, 0]\n\n            # --- Radial Dynamics (Rayleigh-Plesset) ---\n            # y_dot[1] = R_ddot\n            p_acoustic = pa * np.cos(k_wave * x) * np.sin(w * t)\n            \n            pressure_term = (pg_0 * (r0 / R)**(3.0 * gamma) -\n                             2.0 * sigma / R -\n                             4.0 * mu * R_dot / R -\n                             p0 - p_acoustic)\n            \n            R_ddot = (pressure_term / rho_l - 1.5 * R_dot**2) / R\n            \n            # --- Translational Dynamics ---\n            # y_dot[3] = x_ddot\n            bjerknes_term = (k_wave * pa * np.sin(k_wave * x) * np.sin(w * t)) / (c_m * rho_l)\n            drag_term = (9.0 * mu) / (2.0 * c_m * rho_l * R**2) * x_dot\n            added_mass_change_term = (3.0 * R_dot / R) * x_dot\n            \n            x_ddot = bjerknes_term - drag_term - added_mass_change_term\n\n            return [R_dot, R_ddot, x_dot, x_ddot]\n\n        def wall_impact(t, y, params):\n            \"\"\"\n            Event function to detect wall impact: x(t) - R(t) = 0.\n            \"\"\"\n            return y[2] - y[0]\n        \n        wall_impact.terminal = True  # Stop integration at impact\n        wall_impact.direction = -1   # Trigger when going from positive to negative\n\n        # --- Initial Conditions ---\n        y0 = [R0, 0.0, x0, 0.0]  # [R(0), R_dot(0), x(0), x_dot(0)]\n\n        # --- Solve the ODE System ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',  # Standard robust solver\n            args=(params,),\n            events=wall_impact,\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-12\n        )\n\n        # --- Process Results ---\n        if sol.t_events[0].size > 0:\n            impact_time = sol.t_events[0][0]\n            results.append(impact_time)\n        else:\n            results.append(-1.0)\n            \n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}