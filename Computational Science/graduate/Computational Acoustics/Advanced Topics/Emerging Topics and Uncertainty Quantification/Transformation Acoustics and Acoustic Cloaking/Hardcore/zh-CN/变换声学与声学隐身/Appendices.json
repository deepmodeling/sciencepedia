{
    "hands_on_practices": [
        {
            "introduction": "变换声学的核心在于坐标变换。这项练习将引导你完成圆柱形和球形声学斗篷所需各向异性材料属性的基本推导。这个练习对于理解一个简单的几何思想（压缩空间）如何转化为具体的物理参数（密度张量和体积模量）至关重要。",
            "id": "4148856",
            "problem": "一个理想的二维极坐标系中的圆柱形声学隐身罩，是通过以下映射，将半径为 $b$ 的虚拟圆盘压缩到内径为 $a$、外径为 $b$ 的物理环域上而设计的：\n$$\nr' \\;=\\; a \\;+\\; \\frac{b-a}{b}\\, r, \\qquad \\theta' \\;=\\; \\theta,\n$$\n其中，带撇号的坐标表示物理空间坐标，不带撇号的量表示虚拟空间坐标，虚拟空间中充满了质量密度为 $\\rho_{0}$、体积模量为 $\\kappa_{0}$ 的均匀声学介质。令 $\\alpha \\equiv \\frac{b-a}{b} \\in (0,1)$。\n\n从二维极坐标（及其三维球坐标类似形式）的线元出发，并利用主拉伸定义为物理空间与虚拟空间在正交归一方向上无穷小长度之比，完成以下任务：\n\n1) 对于上述给定的二维映射，推导在局部正交归一极坐标基 $\\{\\hat{\\mathbf{e}}_{r},\\hat{\\mathbf{e}}_{\\theta}\\}$ 下表示的变换 $\\mathbf{x}'(\\mathbf{x})$ 的雅可比矩阵 $\\mathbf{A}_{2\\mathrm{D}}$，并计算其行列式 $\\det \\mathbf{A}_{2\\mathrm{D}}$。\n\n2) 将此构造推广到三维球坐标情况，其中 $r' = a + \\alpha r$, $\\theta'=\\theta$, $\\phi'=\\phi$，并推导在局部正交归一球坐标基 $\\{\\hat{\\mathbf{e}}_{r},\\hat{\\mathbf{e}}_{\\theta},\\hat{\\mathbf{e}}_{\\phi}\\}$ 下的行列式 $\\det \\mathbf{A}_{3\\mathrm{D}}$。\n\n3) 利用标量声压方程 $\\nabla \\cdot \\left(\\rho^{-1} \\nabla p\\right) + \\omega^{2}\\kappa^{-1} p = 0$ 的变换声学不变性，以及经过充分检验的各向异性密度公式的参数前推法则，\n$$\n\\boldsymbol{\\rho}' \\;=\\; \\rho_{0}\\,\\frac{\\mathbf{A}\\mathbf{A}^{\\mathsf{T}}}{\\det \\mathbf{A}}, \n\\qquad\n\\kappa' \\;=\\; \\kappa_{0}\\,\\det \\mathbf{A},\n$$\n在二维和三维情况下，辨识当 $r' \\to a^{+}$ 时，$\\boldsymbol{\\rho}'$ 和 $\\kappa'$ 的主分量在内边界处的主导阶行为。特别地，说明每个分量是趋于零、保持有限还是发散，并指出其随 $(r'-a)$ 变化的幂次。\n\n最终答案只需报告雅可比行列式对 $(\\det \\mathbf{A}_{2\\mathrm{D}}, \\det \\mathbf{A}_{3\\mathrm{D}})$，纯粹用 $a$、$b$ 和 $r'$ 表示，并写成使用括号表示法的单个行矩阵。不需要单位，也无需数值取整。所有中间推导过程必须在解题步骤中展示。",
            "solution": "经评估，问题陈述有效。其科学依据是成熟的变换声学理论，问题设定清晰一致、表述良好，并以客观、正式的语言表达。提供了唯一解所需的所有信息。\n\n问题的核心在于分析从虚拟空间（不带撇号的坐标）到物理空间（带撇号的坐标）的坐标变换。当此变换的雅可比矩阵在局部正交归一基下表示时，它描述了实现声学隐身效果所需的各向异性材料属性。\n\n设虚拟空间由坐标 $\\mathbf{x}$ 描述，物理空间由 $\\mathbf{x}'$ 描述。变换由 $\\mathbf{x}'(\\mathbf{x})$ 给出。变换声学参数前推法则所需的雅可比矩阵 $\\mathbf{A}$ 是关联无穷小位移矢量在其局部正交归一基分量的矩阵。也就是说，若 $d\\mathbf{s} = \\sum_i (ds)_i \\hat{\\mathbf{e}}_i$ 且 $d\\mathbf{s}' = \\sum_j (ds')_j \\hat{\\mathbf{e}}'_j$，则分量关系为 $(ds')_j = \\sum_i A_{ji} (ds)_i$。对于给定的这种对角变换，基矢量不发生旋转 ($\\hat{\\mathbf{e}}'_i = \\hat{\\mathbf{e}}_i$)，矩阵 $\\mathbf{A}$ 成为一个由主拉伸 $\\lambda_i$ 构成的对角矩阵。在给定方向上的主拉伸是物理空间中的无穷小长度与虚拟空间中相应无穷小长度之比。\n\n令 $\\alpha \\equiv \\frac{b-a}{b}$。该映射定义于虚拟半径 $r \\in [0,b]$。这映射到物理环域 $r' \\in [a, b]$。\n\n### 第 1 部分：二维 (2D) 情况\n\n变换由 $r' = a + \\alpha r$ 和 $\\theta' = \\theta$ 给出。虚拟空间中极坐标 $(r, \\theta)$ 的线元为 $ds^2 = dr^2 + (r d\\theta)^2$。无穷小正交位移分量为 $ds_r = dr$ 和 $ds_\\theta = r d\\theta$。物理空间中坐标 $(r', \\theta')$ 的线元为 $ds'^2 = dr'^2 + (r' d\\theta')^2$。无穷小正交位移分量为 $ds'_{r'} = dr'$ 和 $ds'_{\\theta'} = r' d\\theta'$。\n\n主拉伸是这些无穷小长度之比。\n径向拉伸 $\\lambda_r$ 为：\n$$\n\\lambda_r = \\frac{ds'_{r'}}{ds_r} = \\frac{dr'}{dr} = \\frac{d}{dr}(a + \\alpha r) = \\alpha\n$$\n切向拉伸 $\\lambda_\\theta$ 为：\n$$\n\\lambda_\\theta = \\frac{ds'_{\\theta'}}{ds_\\theta} = \\frac{r' d\\theta'}{r d\\theta}\n$$\n由于 $\\theta' = \\theta$，我们有 $d\\theta' = d\\theta$。拉伸变为 $\\lambda_\\theta = \\frac{r'}{r}$。为了用物理坐标 $r'$ 表示，我们反转径向变换：$r' = a + \\alpha r \\implies r = \\frac{r'-a}{\\alpha}$。\n$$\n\\lambda_\\theta = \\frac{r'}{(r'-a)/\\alpha} = \\frac{\\alpha r'}{r'-a}\n$$\n在局部正交归一基 $\\{\\hat{\\mathbf{e}}_{r}, \\hat{\\mathbf{e}}_{\\theta}\\}$ 下的雅可比矩阵 $\\mathbf{A}_{2\\mathrm{D}}$ 是由这些主拉伸构成的对角矩阵：\n$$\n\\mathbf{A}_{2\\mathrm{D}} = \\begin{pmatrix} \\lambda_r & 0 \\\\ 0 & \\lambda_\\theta \\end{pmatrix} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\frac{\\alpha r'}{r'-a} \\end{pmatrix}\n$$\n该矩阵的行列式是其对角元素之积：\n$$\n\\det \\mathbf{A}_{2\\mathrm{D}} = \\lambda_r \\lambda_\\theta = \\alpha \\left(\\frac{\\alpha r'}{r'-a}\\right) = \\frac{\\alpha^2 r'}{r'-a}\n$$\n代入 $\\alpha = \\frac{b-a}{b}$，我们得到用给定的几何参数和物理坐标 $r'$ 表示的行列式：\n$$\n\\det \\mathbf{A}_{2\\mathrm{D}} = \\frac{\\left(\\frac{b-a}{b}\\right)^2 r'}{r'-a} = \\frac{(b-a)^2}{b^2} \\frac{r'}{r'-a}\n$$\n\n### 第 2 部分：三维 (3D) 情况\n\n将分析推广到三维球坐标，变换为 $r' = a + \\alpha r$、$\\theta'=\\theta$ 和 $\\phi'=\\phi$。虚拟空间中的线元为 $ds^2 = dr^2 + (r d\\theta)^2 + (r\\sin\\theta d\\phi)^2$。正交位移分量为 $ds_r=dr$、$ds_\\theta=r d\\theta$ 和 $ds_\\phi=r\\sin\\theta d\\phi$。物理空间中的线元为 $ds'^2 = dr'^2 + (r' d\\theta')^2 + (r'\\sin\\theta' d\\phi')^2$。正交位移分量为 $ds'_{r'}=dr'$、$ds'_{\\theta'}=r' d\\theta'$ 和 $ds'_{\\phi'}=r'\\sin\\theta' d\\phi'$。\n\n主拉伸为：\n径向拉伸 $\\lambda_r$：\n$$\n\\lambda_r = \\frac{dr'}{dr} = \\alpha\n$$\n极向拉伸 $\\lambda_\\theta$：\n$$\n\\lambda_\\theta = \\frac{r' d\\theta'}{r d\\theta} = \\frac{r'}{r} = \\frac{\\alpha r'}{r'-a}\n$$\n方位角拉伸 $\\lambda_\\phi$：\n$$\n\\lambda_\\phi = \\frac{r'\\sin\\theta' d\\phi'}{r\\sin\\theta d\\phi} = \\frac{r'\\sin\\theta d\\phi}{r\\sin\\theta d\\phi} = \\frac{r'}{r} = \\frac{\\alpha r'}{r'-a}\n$$\n在局部正交归一基 $\\{\\hat{\\mathbf{e}}_{r}, \\hat{\\mathbf{e}}_{\\theta}, \\hat{\\mathbf{e}}_{\\phi}\\}$ 下的雅可比矩阵为 $\\mathbf{A}_{3\\mathrm{D}} = \\mathrm{diag}(\\lambda_r, \\lambda_\\theta, \\lambda_\\phi)$。行列式是主拉伸之积：\n$$\n\\det \\mathbf{A}_{3\\mathrm{D}} = \\lambda_r \\lambda_\\theta \\lambda_\\phi = \\alpha \\left(\\frac{\\alpha r'}{r'-a}\\right) \\left(\\frac{\\alpha r'}{r'-a}\\right) = \\frac{\\alpha^3 (r')^2}{(r'-a)^2}\n$$\n代入 $\\alpha = \\frac{b-a}{b}$：\n$$\n\\det \\mathbf{A}_{3\\mathrm{D}} = \\frac{\\left(\\frac{b-a}{b}\\right)^3 (r')^2}{(r'-a)^2} = \\frac{(b-a)^3}{b^3} \\frac{(r')^2}{(r'-a)^2}\n$$\n\n### 第 3 部分：材料参数的渐近行为\n\n变换后的材料参数，即各向异性质量密度 $\\boldsymbol{\\rho}'$ 和标量压缩率 $\\kappa'$，由以下公式给出：\n$$\n\\boldsymbol{\\rho}' = \\rho_{0}\\,\\frac{\\mathbf{A}\\mathbf{A}^{\\mathsf{T}}}{\\det \\mathbf{A}}, \\qquad \\kappa' = \\kappa_{0}\\,\\det \\mathbf{A}\n$$\n由于 $\\mathbf{A}$ 是由主拉伸构成的对角矩阵，$\\mathbf{A} = \\mathrm{diag}(\\lambda_i)$，密度张量 $\\boldsymbol{\\rho}'$ 也是对角矩阵，其主分量为 $\\rho'_i = \\rho_0 \\frac{\\lambda_i^2}{\\det \\mathbf{A}}$。\n\n**当 $r' \\to a^{+}$ 时二维情况的渐近分析**：\n令 $r'-a = \\epsilon$，其中 $\\epsilon \\to 0^{+}$。\n行列式为 $\\det \\mathbf{A}_{2\\mathrm{D}} = \\frac{\\alpha^2 r'}{r'-a} \\approx \\frac{\\alpha^2 a}{\\epsilon}$。它以 $(r'-a)^{-1}$ 的形式发散。\n压缩率为 $\\kappa' = \\kappa_0 \\det \\mathbf{A}_{2\\mathrm{D}}$。因此，$\\kappa'$ 以 $(r'-a)^{-1}$ 的形式**发散**。\n密度主分量为：\n$$\n\\rho'_r = \\rho_0 \\frac{\\lambda_r^2}{\\det \\mathbf{A}_{2\\mathrm{D}}} = \\rho_0 \\frac{\\alpha^2}{\\frac{\\alpha^2 r'}{r'-a}} = \\rho_0 \\frac{r'-a}{r'} \\approx \\rho_0 \\frac{\\epsilon}{a}\n$$\n因此，$\\rho'_r$ 以 $(r'-a)^{1}$ 的形式**趋于零**。\n$$\n\\rho'_\\theta = \\rho_0 \\frac{\\lambda_\\theta^2}{\\det \\mathbf{A}_{2\\mathrm{D}}} = \\rho_0 \\frac{\\left(\\frac{\\alpha r'}{r'-a}\\right)^2}{\\frac{\\alpha^2 r'}{r'-a}} = \\rho_0 \\frac{r'}{r'-a} \\approx \\rho_0 \\frac{a}{\\epsilon}\n$$\n因此，$\\rho'_\\theta$ 以 $(r'-a)^{-1}$ 的形式**发散**。\n\n**当 $r' \\to a^{+}$ 时三维情况的渐近分析**：\n令 $r'-a = \\epsilon$，其中 $\\epsilon \\to 0^{+}$。\n行列式为 $\\det \\mathbf{A}_{3\\mathrm{D}} = \\frac{\\alpha^3 (r')^2}{(r'-a)^2} \\approx \\frac{\\alpha^3 a^2}{\\epsilon^2}$。它以 $(r'-a)^{-2}$ 的形式发散。\n压缩率为 $\\kappa' = \\kappa_0 \\det \\mathbf{A}_{3\\mathrm{D}}$。因此，$\\kappa'$ 以 $(r'-a)^{-2}$ 的形式**发散**。\n密度主分量为：\n$$\n\\rho'_r = \\rho_0 \\frac{\\lambda_r^2}{\\det \\mathbf{A}_{3\\mathrm{D}}} = \\rho_0 \\frac{\\alpha^2}{\\frac{\\alpha^3 (r')^2}{(r'-a)^2}} = \\frac{\\rho_0}{\\alpha} \\frac{(r'-a)^2}{(r')^2} \\approx \\frac{\\rho_0}{\\alpha} \\frac{\\epsilon^2}{a^2}\n$$\n因此，$\\rho'_r$ 以 $(r'-a)^{2}$ 的形式**趋于零**。\n$$\n\\rho'_\\theta = \\rho_0 \\frac{\\lambda_\\theta^2}{\\det \\mathbf{A}_{3\\mathrm{D}}} = \\rho_0 \\frac{\\left(\\frac{\\alpha r'}{r'-a}\\right)^2}{\\frac{\\alpha^3 (r')^2}{(r'-a)^2}} = \\rho_0 \\frac{\\frac{\\alpha^2 (r')^2}{(r'-a)^2}}{\\frac{\\alpha^3 (r')^2}{(r'-a)^2}} = \\frac{\\rho_0}{\\alpha}\n$$\n根据对称性，$\\rho'_\\phi = \\rho_0 \\frac{\\lambda_\\phi^2}{\\det \\mathbf{A}_{3\\mathrm{D}}} = \\frac{\\rho_0}{\\alpha}$。\n因此，$\\rho'_\\theta$ 和 $\\rho'_\\phi$ **保持有限**且为常数，趋近于值 $\\frac{\\rho_0}{\\alpha} = \\rho_0 \\frac{b}{b-a}$。\n\n最终答案只需要行列式，这已在第 1 部分和第 2 部分推导得出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{(b-a)^2}{b^2} \\frac{r'}{r'-a} & \\frac{(b-a)^3}{b^3} \\frac{(r')^2}{(r'-a)^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出材料参数之后，我们现在来探索它们的理想效果。这个思想实验研究了声波穿过隐形区域的传播时间。通过在变换框架内应用费马原理，我们可以揭示理想斗篷的一个深刻特性，并理解为什么它们在原则上无法通过飞行时间测量被探测到。",
            "id": "4148901",
            "problem": "考虑一个无界均匀流体中的二维时谐声场，该流体的质量密度为 $\\rho_{0}$，体积模量为 $K_{0}$，声速为 $c_{0} = \\sqrt{K_{0}/\\rho_{0}}$。在高频极限（几何声学）下，声线使传播时间泛函 $T = \\int ds/c$ 取最小值，其中 $ds$ 是欧几里得弧长元，$c$ 是局部声速。一个圆柱形声学斗篷占据了以原点为中心的环形区域 $a \\le r \\le b$，它是通过变换声学设计的，其形式为一个光滑的一对一径向映射，将虚拟（均匀）空间中的半径 $R \\in [0,b]$ 映射到物理空间中的半径 $r \\in [a,b]$：\n$$\nR = \\frac{b}{b - a}\\,(r - a),\\quad \\Theta = \\theta,\n$$\n在 $r \\geq b$ 的区域外为恒等映射。两个点 $\\mathbf{x}_{S} = (-d,0)$ 和 $\\mathbf{x}_{R} = (d,0)$（其中 $d > b$）位于 x 轴上，连接 $\\mathbf{x}_{S}$ 和 $\\mathbf{x}_{R}$ 的一条声线绕过斗篷壳层，即它被斗篷偏转绕过内径 $r = a$，但保持在外部区域或斗篷壳层 $a \\le r \\le b$ 内，而不进入被隐藏的核心区域 $r \\le a$。\n\n从非均匀、可能各向异性的流体中基于压力的声波方程出发，\n$$\n\\nabla \\cdot \\big(\\boldsymbol{\\rho}^{-1}(\\mathbf{x})\\,\\nabla p\\big) + \\omega^{2} K^{-1}(\\mathbf{x})\\,p = 0,\n$$\n以及高频（程函）极限，其中声线由方向 $\\hat{\\mathbf{n}}$ 的局部色散关系表征，\n$$\nv^{2}(\\mathbf{x},\\hat{\\mathbf{n}}) = K(\\mathbf{x})\\,\\hat{\\mathbf{n}}^{\\mathsf{T}}\\,\\boldsymbol{\\rho}^{-1}(\\mathbf{x})\\,\\hat{\\mathbf{n}},\n$$\n在给定坐标变换下，通过将物理空间线元和本构参数与虚拟均匀空间中的相应参数相关联，推导在有斗篷存在的情况下沿声线的传播时间 $T_{\\text{cloak}}$。计算斗篷传播时间与相同端点的自由空间传播时间 $T_{\\text{free}} = |\\mathbf{x}_{R} - \\mathbf{x}_{S}|/c_{0}$ 之间的差值 $\\Delta T = T_{\\text{cloak}} - T_{\\text{free}}$。用秒表示 $\\Delta T$ 的最终答案。结论：一个理想的、无损的、非色散的变换声学斗篷是否能仅基于 $\\Delta T$，通过外部点之间的飞行时间测量来检测到。",
            "solution": "问题要求计算在存在圆柱形声学斗篷的情况下，声源 $\\mathbf{x}_{S}$ 和接收器 $\\mathbf{x}_{R}$ 之间声线的传播时间，与在均匀自由空间中的传播时间之差，即 $\\Delta T = T_{\\text{cloak}} - T_{\\text{free}}$。\n\n变换声学的基本原理是控制波动方程在坐标变换下的形式不变性。在具有非均匀和各向异性质量密度 $\\boldsymbol{\\rho}(\\mathbf{x})$ 以及非均匀体积模量 $K(\\mathbf{x})$ 的流体中，时谐压力场 $p$ 的声波方程为：\n$$\n\\nabla \\cdot \\big(\\boldsymbol{\\rho}^{-1}(\\mathbf{x})\\,\\nabla p\\big) + \\omega^{2} K^{-1}(\\mathbf{x})\\,p = 0\n$$\n在具有恒定参数 $\\rho_0$ 和 $K_0$ 的均匀、各向同性的“虚拟”空间中，此方程简化为亥姆霍兹方程：\n$$\n\\nabla_X^2 p + \\frac{\\omega^2}{c_0^2} p = 0\n$$\n其中 $c_0 = \\sqrt{K_0/\\rho_0}$ 是恒定声速，$\\nabla_X^2$ 是虚拟坐标系 $\\mathbf{X}$ 中的拉普拉斯算子。\n\n变换声学建立了一个从虚拟空间到物理空间 $\\mathbf{x}$ 的映射 $\\mathbf{x}(\\mathbf{X})$，使得虚拟空间中的亥姆霍兹方程变换为物理空间中的一般声学方程。这是通过基于变换的雅可比矩阵来定义物理材料参数 $\\boldsymbol{\\rho}(\\mathbf{x})$ 和 $K(\\mathbf{x})$ 实现的。\n\n这种形式不变性的一个关键推论是，特别是在高频（几何声学）极限下，声线的传播时间在变换下是守恒的。根据费马原理，声线使其取极值的传播时间泛函，在两个空间中是等效的。如果 $dS = |\\mathrm{d}\\mathbf{X}|$ 是虚拟空间中的弧长元，$ds = |\\mathrm{d}\\mathbf{x}|$ 是物理空间中的弧长元，那么这种等效性表示为：\n$$\nT = \\int_{\\text{physical ray}} \\frac{ds}{c(\\mathbf{x})} = \\int_{\\text{virtual ray}} \\frac{dS}{c_0}\n$$\n这里，$c(\\mathbf{x})$ 是物理介质中的有效（且通常是各向异性）声速，$c_0$ 是虚拟介质中的恒定声速。\n\n我们可以使用这个原理来计算存在斗篷时的传播时间 $T_{\\text{cloak}}$。我们需要确定虚拟空间中对应的路径。\n\n给定的变换通过以下函数将物理空间 $r \\in [a, b]$ 映射到虚拟空间 $R \\in [0, b]$：\n$$\nR(r) = \\frac{b}{b - a}(r - a)\n$$\n斗篷外部的区域 $r \\geq b$ 通过恒等映射进行映射，因此 $R=r$。被隐藏的核心区域 $r  a$ 被有效地从传播域中移除，因为整个物理环形区域 $a \\le r \\le b$ 是从虚拟圆盘 $0 \\le R \\le b$ 压缩而来的。斗篷的内边界 $r=a$ 被映射到虚拟空间的原点 $R=0$。\n\n在均匀的虚拟空间中，声线沿直线传播。声源和接收器分别位于 $\\mathbf{x}_{S} = (-d, 0)$ 和 $\\mathbf{x}_{R} = (d, 0)$，其中 $d  b$。由于这些点位于 $rb$ 的区域，它们在虚拟空间中的坐标是相同的：$\\mathbf{X}_{S} = (-d, 0)$ 和 $\\mathbf{X}_{R} = (d, 0)$。\n\n问题指明我们要考虑“绕过内径 $r=a$ 偏转”的声线。在虚拟空间中，这对应于一条穿过点 $R=0$ 的声线路径，而 $R=0$ 是 $r=a$ 的映射。在虚拟空间中连接 $\\mathbf{X}_{S}$ 和 $\\mathbf{X}_{R}$ 的直线直接穿过原点。这条直线就是虚拟空间中的声线路径。\n\n因此，这条声线的传播时间 $T_{\\text{cloak}}$ 就是沿虚拟空间中直线路径的传播时间。这条路径的长度 $L_{\\text{virtual}}$ 是 $\\mathbf{X}_{S}$ 和 $\\mathbf{X}_{R}$ 之间的欧几里得距离：\n$$\nL_{\\text{virtual}} = |\\mathbf{X}_{R} - \\mathbf{X}_{S}| = \\sqrt{(d - (-d))^2 + (0 - 0)^2} = \\sqrt{(2d)^2} = 2d\n$$\n虚拟空间中的传播时间，也就是物理空间中被斗篷作用的声线的传播时间是：\n$$\nT_{\\text{cloak}} = \\frac{L_{\\text{virtual}}}{c_0} = \\frac{2d}{c_0}\n$$\n接下来，我们计算自由空间传播时间 $T_{\\text{free}}$。这是在声速为 $c_0$ 的均匀介质中，声线在相同的两个点 $\\mathbf{x}_{S}$ 和 $\\mathbf{x}_{R}$ 之间传播的时间。在这种情况下，声线是物理空间中的一条直线。问题给出了定义：\n$$\nT_{\\text{free}} = \\frac{|\\mathbf{x}_{R} - \\mathbf{x}_{S}|}{c_{0}}\n$$\n距离与之前计算的相同：\n$$\n|\\mathbf{x}_{R} - \\mathbf{x}_{S}| = 2d\n$$\n所以，自由空间传播时间是：\n$$\nT_{\\text{free}} = \\frac{2d}{c_0}\n$$\n最后，我们计算差值 $\\Delta T$：\n$$\n\\Delta T = T_{\\text{cloak}} - T_{\\text{free}} = \\frac{2d}{c_0} - \\frac{2d}{c_0} = 0\n$$\n传播时间的差值恰好为零。最终答案要求“以秒为单位”。由于值为 $0$，所以是 $0$ 秒。\n\n对于结论性问题：“结论：一个理想的、无损的、非色散的变换声学斗篷是否能仅基于 $\\Delta T$，通过外部点之间的飞行时间测量来检测到。”\n由于 $\\Delta T = 0$，被斗篷偏转的声线的传播时间与相同端点之间在自由空间中传播的声线的传播时间相同。因此，仅基于这种飞行时间测量，理想斗篷的存在是无法被检测到的。声波的表现就如同它在空的、均匀的空间中传播一样，这是完美斗篷的定义性特征。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理想参数包含奇异点，这给数值模拟带来了重大挑战。最后的这项练习通过要求你为一个简化的斗篷实现一个数值模型，从而将理论与计算联系起来。你将研究一个用于“驯服”奇异点的正则化参数 $ \\varepsilon $ 如何影响系统的谱特性，从而为计算声学斗篷设计中的挑战和解决方案提供切实的体验。",
            "id": "4148832",
            "problem": "考虑在圆柱坐标系下一个实现声学隐身的变换介质中的轴对称时谐声学问题。其基本出发点是在非均匀各向异性介质中的标量声波方程，由 $\\nabla \\cdot \\left(\\boldsymbol{\\rho}^{-1} \\nabla p \\right) + \\omega^{2} K^{-1} p = 0$ 给出，其中 $p$ 是声压，$\\boldsymbol{\\rho}$ 是（可能为各向异性的）质量密度张量， $K$ 是体积模量， $\\omega$ 是角频率。在轴对称情况下，假设物理量不依赖于方位角，则径向算子简化为区间 $r' \\in [a,b]$ 上的一维 Sturm–Liouville 形式：\n$$\n\\mathcal{L} u(r') = -\\frac{1}{r'} \\frac{d}{dr'} \\left( r' \\frac{1}{\\rho'_{r}(r')} \\frac{du}{dr'} \\right),\n$$\n服从齐次 Dirichlet 边界条件 $u(a) = 0$ 和 $u(b) = 0$。此处 $\\rho'_{r}(r')$ 表示隐身映射后变换质量密度的径向分量，而 $u(r')$ 是与算子 $\\mathcal{L}$ 相关的本征函数。\n\n在用于圆柱形隐身的理想变换声学中，一类标准的映射会产生在内边界 $r' = a$ 附近表现出奇异性的材料参数。为了使问题在数值上是适定的，引入一个截断（正则化）参数 $\\varepsilon  0$ 并采用截断后的径向质量密度\n$$\n\\rho'_{r}(r') = \\rho_{0} \\frac{r' - a + \\varepsilon}{r'},\n$$\n其中取 $\\rho_{0} = 1$ 以进行无量纲化。假设无量纲体积模量为常数 $K' = 1$，从而使谱分析仅关注由 $\\rho'_{r}(r')$ 引起的刚度。\n\n使用包含 $N$ 个节点（包括端点）的均匀网格对区间 $[a,b]$ 上的算子 $\\mathcal{L}$ 进行离散化，网格间距为 $h = \\frac{b-a}{N-1}$，内部节点由 $i = 1, 2, \\dots, N-2$ 索引，其坐标为 $r_{i} = a + i h$。定义系数\n$$\np(r') = \\frac{r'}{\\rho'_{r}(r')} = \\frac{r'^{2}}{r' - a + \\varepsilon},\n$$\n并使用保守的有限体积离散化方法，得到对称刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{(N-2) \\times (N-2)}$ 和对称正定质量矩阵 $\\mathbf{M} \\in \\mathbb{R}^{(N-2) \\times (N-2)}$：\n- 对于每个内部索引 $i$，定义半网格点 $r_{i+\\frac{1}{2}} = r_{i} + \\frac{h}{2}$ 和 $r_{i-\\frac{1}{2}} = r_{i} - \\frac{h}{2}$，以及对应的 $p_{i+\\frac{1}{2}} = \\frac{r_{i+\\frac{1}{2}}^{2}}{r_{i+\\frac{1}{2}} - a + \\varepsilon}$ 和 $p_{i-\\frac{1}{2}} = \\frac{r_{i-\\frac{1}{2}}^{2}}{r_{i-\\frac{1}{2}} - a + \\varepsilon}$。\n- 设置刚度矩阵的元素\n$$\nK_{ii} = \\frac{r_{i+\\frac{1}{2}} p_{i+\\frac{1}{2}} + r_{i-\\frac{1}{2}} p_{i-\\frac{1}{2}}}{h^{2}}, \\quad\nK_{i,i+1} = -\\frac{r_{i+\\frac{1}{2}} p_{i+\\frac{1}{2}}}{h^{2}}, \\quad\nK_{i,i-1} = -\\frac{r_{i-\\frac{1}{2}} p_{i-\\frac{1}{2}}}{h^{2}},\n$$\n其他位置的元素为零，并通过从未知向量中省略边界节点来施加在 $r' = a$ 和 $r' = b$ 处的齐次 Dirichlet 边界条件。\n- 设置质量矩阵为对角矩阵，其元素为\n$$\nM_{ii} = r_{i}.\n$$\n\n于是，广义离散本征问题为\n$$\n\\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{M} \\mathbf{u},\n$$\n其中 $\\lambda$ 是近似算子 $\\mathcal{L}$ 谱的无量纲本征值。截断水平 $\\varepsilon$ 对 $r' = a$ 附近的奇异点进行正则化，而最小本征值 $\\lambda_{\\min}$ 预计由 $r' = a$ 附近的径向质量加载项 $\\rho'_{r}(r')$ 控制，因此由 $\\rho'_{r}(a) = \\frac{\\varepsilon}{a}$ 控制。\n\n任务：\n- 实现一个完整的程序，对于给定的 $(a,b,\\varepsilon,N)$，按照上述方法组装 $\\mathbf{K}$ 和 $\\mathbf{M}$，并计算 $\\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{M} \\mathbf{u}$ 的最小广义本征值 $\\lambda_{\\min}$。\n- 对于每个测试用例，还需计算缩放积 $S = \\lambda_{\\min} \\times \\rho'_{r}(a) = \\lambda_{\\min} \\times \\frac{\\varepsilon}{a}$，以揭示最小本征值与 $r' = a$ 附近的径向质量加载项之间的关系。\n\n所有量都是无量纲的，因此不需要物理单位。角度不出现。最终输出必须是浮点数。\n\n测试套件：\n- 使用以下参数集 $(a,b,\\varepsilon,N)$：\n    - 情况 $1$：$a = 1$, $b = 2$, $\\varepsilon = 10^{-1}$, $N = 128$。\n    - 情况 $2$：$a = 1$, $b = 2$, $\\varepsilon = 10^{-2}$, $N = 128$。\n    - 情况 $3$：$a = 1$, $b = 2$, $\\varepsilon = 10^{-3}$, $N = 256$。\n    - 情况 $4$：$a = 1$, $b = 2$, $\\varepsilon = 10^{-6}$, $N = 256$。\n    - 情况 $5$ (离散化边缘情况)：$a = 1$, $b = 2$, $\\varepsilon = 10^{-2}$, $N = 32$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是一个包含该用例的 $[\\lambda_{\\min}, S]$ 的双元素列表。例如，输出应类似于 $[[x_{1},y_{1}],[x_{2},y_{2}],\\dots]$，其中每个 $x_{i}$ 和 $y_{i}$ 都是浮点数。",
            "solution": "用户提供了一个计算声学问题，要求对一个由离散化 Sturm–Liouville 算子导出的广义本征值问题进行数值求解。该问题需要针对几组参数进行求解。\n\n### 问题验证\n\n1.  **提取给定信息**：\n    -   **控制算子**：$\\mathcal{L} u(r') = -\\frac{1}{r'} \\frac{d}{dr'} \\left( r' \\frac{1}{\\rho'_{r}(r')} \\frac{du}{dr'} \\right)$ 在 $r' \\in [a,b]$ 上。\n    -   **边界条件**：$u(a) = 0$, $u(b) = 0$。\n    -   **径向质量密度**：$\\rho'_{r}(r') = \\frac{r' - a + \\varepsilon}{r'}$ （其中 $\\rho_0 = 1$）。\n    -   **系数函数**：$p(r') = \\frac{r'}{\\rho'_{r}(r')} = \\frac{r'^{2}}{r' - a + \\varepsilon}$。\n    -   **离散化**：在 $[a,b]$ 上的均匀网格，有 $N$ 个节点，间距为 $h = \\frac{b-a}{N-1}$。内部节点 $r_i = a+ih$ 对于 $i=1, \\dots, N-2$。\n    -   **刚度矩阵 $\\mathbf{K}$** （尺寸 $(N-2) \\times (N-2)$）：\n        -   $K_{ii} = \\frac{r_{i+\\frac{1}{2}} p_{i+\\frac{1}{2}} + r_{i-\\frac{1}{2}} p_{i-\\frac{1}{2}}}{h^{2}}$\n        -   $K_{i,i+1} = -\\frac{r_{i+\\frac{1}{2}} p_{i+\\frac{1}{2}}}{h^{2}}$\n        -   $K_{i,i-1} = -\\frac{r_{i-\\frac{1}{2}} p_{i-\\frac{1}{2}}}{h^{2}}$\n    -   **质量矩阵 $\\mathbf{M}$** （尺寸 $(N-2) \\times (N-2)$）：\n        -   $M_{ii} = r_i$ (对角)。\n    -   **本征问题**：$\\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{M} \\mathbf{u}$。\n    -   **任务**：对于每个参数集 $(a,b,\\varepsilon,N)$，找到最小本征值 $\\lambda_{\\min}$ 并计算缩放积 $S = \\lambda_{\\min} \\times \\frac{\\varepsilon}{a}$。\n    -   **测试用例**：\n        1.  $(a,b,\\varepsilon,N) = (1, 2, 10^{-1}, 128)$\n        2.  $(a,b,\\varepsilon,N) = (1, 2, 10^{-2}, 128)$\n        3.  $(a,b,\\varepsilon,N) = (1, 2, 10^{-3}, 256)$\n        4.  $(a,b,\\varepsilon,N) = (1, 2, 10^{-6}, 256)$\n        5.  $(a,b,\\varepsilon,N) = (1, 2, 10^{-2}, 32)$\n\n2.  **使用提取的给定信息进行验证**：\n    -   **科学依据**：该问题在计算物理学中有坚实的基础。它通过变换声学模拟了一个声学隐身问题的正则化版本，这是一个有效的研究课题。离散化方案是求解 Sturm-Liouville 问题的标准有限体积法。\n    -   **适定性**：连续问题是一个标准的 Sturm-Liouville 问题，是适定的。离散化版本导出一个广义本征值问题 $\\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{M} \\mathbf{u}$。根据构造，刚度矩阵 $\\mathbf{K}$ 是对称的。质量矩阵 $\\mathbf{M}$ 是对角矩阵，其对角元为正值 $r_i = a+ih  a \\ge 1  0$，因此它是对称正定的。这样的广义对称定本征问题是适定的，并且具有实本征值。正则化参数 $\\varepsilon  0$ 避免了系数 $p(r')$ 在 $r'=a$ 处的奇异性，确保了所有矩阵元素都是有限的。\n    -   **客观性**：该问题使用精确的数学定义和客观的语言进行陈述。\n    -   **完整性**：所有必要的信息，包括数学公式、离散化公式、参数值和要求的输出格式，都已提供。该问题是自包含的。\n\n3.  **结论与行动**：该问题是**有效的**。这是一个定义明确且科学上合理的数值练习。我将继续进行求解。\n\n### 解答\n\n任务是求解广义本征值问题 $\\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{M} \\mathbf{u}$ 以获得最小本征值 $\\lambda_{\\min}$。矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是从一维径向算子 $\\mathcal{L}$ 的有限体积离散化中导出的。对每个测试用例，求解过程包括三个主要步骤：a) 组装矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$，b) 求解本征问题，以及 c) 计算缩放积 $S$。\n\n首先，对于一组给定的参数 $(a,b,\\varepsilon,N)$，我们定义离散域。矩阵的大小为 $D = N-2$，对应于内部网格点的数量。网格间距为 $h = \\frac{b-a}{N-1}$。内部网格点位于 $r_k = a + k h$，其中 $k=1, \\dots, D$。这些点对应于矩阵索引 $i=0, \\dots, D-1$（即 $i=k-1$）。\n\n质量矩阵 $\\mathbf{M}$ 是一个大小为 $D \\times D$ 的对角矩阵。其对角元由内部网格点的坐标给出：$M_{ii} = r_{i+1} = a + (i+1)h$。由于 $a=10$，所有对角元均为正，因此 $\\mathbf{M}$ 是正定的。\n\n刚度矩阵 $\\mathbf{K}$ 是一个大小为 $D \\times D$ 的对称三对角矩阵。其元素由在半网格点处求值的系数函数 $p(r') = \\frac{r'^{2}}{r' - a + \\varepsilon}$ 构建。我们定义项 $T_{k \\pm 1/2} = r_{k \\pm 1/2} p(r_{k \\pm 1/2})$，其中 $r_{k \\pm 1/2} = a+(k \\pm 1/2)h$。对于矩阵的第 $i$ 行（对应于网格点 $r_{i+1}$），元素为：\n-   对角元：$K_{ii} = \\frac{T_{i+1+1/2} + T_{i+1-1/2}}{h^{2}} = \\frac{T_{i+3/2} + T_{i+1/2}}{h^{2}}$\n-   非对角元：$K_{i, i+1} = K_{i+1, i} = -\\frac{T_{i+1+1/2}}{h^{2}} = -\\frac{T_{i+3/2}}{h^{2}}$\n\n这些矩阵是通过计算构建的。为了提高效率，我们可以首先计算项 $T_{j+1/2}$（其中 $j=0, \\dots, D$）的一个数组。然后，可以直接组装 $\\mathbf{K}$ 的对角线，而无需显式循环。\n\n一旦 $\\mathbf{K}$ 和 $\\mathbf{M}$ 组装完毕，我们就求解广义本征值问题。由于 $\\mathbf{K}$ 是对称的，而 $\\mathbf{M}$ 是对称正定的，我们可以使用专门的本征求解器，例如 `scipy.linalg.eigh`，它对于这类问题在数值上是稳定且高效的。它按升序返回本征值，因此最小本征值 $\\lambda_{\\min}$ 是返回的本征值数组的第一个元素。\n\n最后，我们计算缩放积 $S = \\lambda_{\\min} \\times \\rho'_{r}(a)$。内边界处的密度由 $\\rho'_{r}(a) = \\frac{a - a + \\varepsilon}{a} = \\frac{\\varepsilon}{a}$ 给出。因此，$S = \\lambda_{\\min} \\frac{\\varepsilon}{a}$。\n\n对所提供的五个测试用例中的每一个都重复此过程。最终输出是一个列表，其中包含每个用例的 $[\\lambda_{\\min}, S]$ 对。",
            "answer": "[[97.355939,9.735594],[962.610023,9.626100],[9629.750374,9.629750],[9630113.842778,9.630114],[958.825227,9.588252]]"
        }
    ]
}