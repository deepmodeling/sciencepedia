{
    "hands_on_practices": [
        {
            "introduction": "Before solving for chemical equilibrium, we must first translate our chemical system into a mathematical framework. This practice  introduces the foundational step of using linear algebra to represent species compositions and reactions. You will explore how to select a numerically stable set of 'basis' species from a larger collection, a critical task for ensuring that geochemical models are both efficient and robust.",
            "id": "4069180",
            "problem": "You are given a stoichiometric matrix $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ where each column encodes the elemental composition of a chemical species in terms of $m$ conserved elements, and there are $n$ total species (primary species and complexes). In algorithms for equilibrium calculations in computational geochemistry, it is often necessary to select a set of basis species (a subset of columns of $\\mathbf{A}$) that spans the column space of $\\mathbf{A}$ and then express every complex as a linear combination of these basis species consistent with elemental conservation.\n\nStarting from the fundamental laws of mass conservation and the definition of the column space in linear algebra, construct an algorithm to:\n\n- Select a basis species set from the column space of $\\mathbf{A}$ using pivoted Quadrature-Reflective decomposition (commonly referred to as QR with column pivoting) that is numerically robust to near dependencies.\n- Derive, for any subset of complexes, a mapping that expresses each complex's elemental composition vector as a linear combination of the selected basis species. That is, for each complex with column vector $\\mathbf{a}_j \\in \\mathbb{R}^m$, determine coefficients $\\mathbf{c}_j \\in \\mathbb{R}^r$ such that $\\mathbf{a}_j$ lies in the span of the selected $r$ basis columns, with all computations done in double precision.\n\nYour program must implement the above for the following test suite. For each test case, you are provided a specific $\\mathbf{A}$ and a list of complex column indices. Indices refer to zero-based positions of species columns. For each complex listed, compute the coefficient vector $\\mathbf{c}_j$ relative to the selected basis species and round each coefficient to $6$ decimal places.\n\nTest Suite:\n\n- Test Case $1$ (Happy path; carbonate system):\n  Elements ordered as $[ \\mathrm{H}, \\mathrm{O}, \\mathrm{C} ]$ with species ordered as $[ \\mathrm{H}^+, \\mathrm{OH}^-, \\mathrm{H_2O}, \\mathrm{HCO_3^-}, \\mathrm{CO_3^{2-}}, \\mathrm{CO_2(aq)} ]$.\n  The stoichiometric matrix $\\mathbf{A}_1 \\in \\mathbb{R}^{3 \\times 6}$ is\n  $$\n  \\mathbf{A}_1 =\n  \\begin{bmatrix}\n  1  1  2  1  0  0 \\\\\n  0  1  1  3  3  2 \\\\\n  0  0  0  1  1  1\n  \\end{bmatrix}.\n  $$\n  Complex indices to map: $[2, 3, 4]$ (i.e., $\\mathrm{H_2O}$, $\\mathrm{HCO_3^-}$, $\\mathrm{CO_3^{2-}}$).\n\n- Test Case $2$ (Boundary; duplicate composition):\n  Elements ordered as $[ \\mathrm{H}, \\mathrm{O}, \\mathrm{C} ]$ with species ordered as $[ \\mathrm{H}^+, \\mathrm{OH}^-, \\mathrm{H_2O}, \\mathrm{H_2O\\_dup} ]$.\n  The stoichiometric matrix $\\mathbf{A}_2 \\in \\mathbb{R}^{3 \\times 4}$ is\n  $$\n  \\mathbf{A}_2 =\n  \\begin{bmatrix}\n  1  1  2  2 \\\\\n  0  1  1  1 \\\\\n  0  0  0  0\n  \\end{bmatrix}.\n  $$\n  Complex indices to map: $[3]$ (i.e., $\\mathrm{H_2O\\_dup}$).\n\n- Test Case $3$ (Edge case; numerical noise):\n  Elements ordered as $[ \\mathrm{H}, \\mathrm{O}, \\mathrm{C} ]$ with species ordered as $[ \\mathrm{H}^+, \\mathrm{OH}^-, \\mathrm{CO_2}, \\mathrm{CO_2\\_noisy}, \\mathrm{H_2O} ]$.\n  The stoichiometric matrix $\\mathbf{A}_3 \\in \\mathbb{R}^{3 \\times 5}$ is\n  $$\n  \\mathbf{A}_3 =\n  \\begin{bmatrix}\n  1  1  0  0  2 \\\\\n  0  1  2  2 + 10^{-12}  1 \\\\\n  0  0  1  1  0\n  \\end{bmatrix}.\n  $$\n  Complex indices to map: $[3]$ (i.e., $\\mathrm{CO_2\\_noisy}$).\n\nAlgorithmic Requirements:\n\n- Use pivoted QR with column pivoting to select a numerically stable set of basis species from the columns of $\\mathbf{A}$; determine the numerical rank $r$ using a tolerance based on machine precision and the scale of the triangular factor.\n- For each complex index $j$ provided, solve the consistent linear system that enforces elemental conservation to obtain $\\mathbf{c}_j$ with respect to the selected basis. Use a method based on triangular solves derived from QR or an equivalent stable least-squares approach suitable for full column rank systems.\n- Round each coefficient to $6$ decimal places.\n\nFinal Output Specification:\n\n- For each test case, output a list of lists. Each inner list contains the rounded coefficients for a complex in the order given by the complex indices, expressed in the order of the selected basis species determined by pivoted QR (i.e., the basis order is the pivot order of the first $r$ columns).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[ \\text{result1}, \\text{result2}, \\text{result3} ]$), where each $\\text{result}$ is itself a list of lists of floats corresponding to that test case.\n- No physical units are involved in this computation, and no angles or percentages are used.\n\nAll computations must be performed in double precision. The program must be fully self-contained and produce the described single-line output without any user input, external files, or network access.",
            "solution": "The fundamental principle governing chemical systems at equilibrium is the conservation of mass. In the context of geochemistry, this means the total amount of each fundamental element (e.g., Carbon, Hydrogen, Oxygen) remains constant, regardless of how these elements are distributed among various aqueous species, gases, or minerals. This conservation law can be elegantly expressed using the language of linear algebra.\n\nLet us define a system with $m$ conserved elements and $n$ chemical species. The elemental composition of each species $j$ can be represented by a column vector $\\mathbf{a}_j \\in \\mathbb{R}^m$, where the $i$-th component of the vector, $(\\mathbf{a}_j)_i$, is the number of atoms of element $i$ in one mole of species $j$. The collection of these vectors for all $n$ species forms the columns of the stoichiometric matrix $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$, where $\\mathbf{A} = [\\mathbf{a}_1, \\mathbf{a}_2, \\dots, \\mathbf{a}_n]$.\n\nAny chemical reaction involving these species is a statement of linear dependence among the columns of $\\mathbf{A}$. For example, the reaction $\\mathrm{H}^+ + \\mathrm{OH}^- \\rightleftharpoons \\mathrm{H_2O}$ corresponds to the vector equation $\\mathbf{a}_{\\mathrm{H}^+} + \\mathbf{a}_{\\mathrm{OH}^-} - \\mathbf{a}_{\\mathrm{H_2O}} = \\mathbf{0}$. The set of all possible stoichiometries of reactions and compositions in the system is spanned by the columns of $\\mathbf{A}$, which defines the column space, $\\mathrm{Col}(\\mathbf{A})$.\n\nTo computationally manage the system, it is efficient to select a minimal set of species, called basis species, from which all other species, called complexes or secondary species, can be formed. Mathematically, this is equivalent to finding a basis for the column space $\\mathrm{Col}(\\mathbf{A})$. A basis is a set of linearly independent vectors that spans the entire space. The number of vectors in this basis is the dimension of the column space, which is the rank of the matrix $\\mathbf{A}$, denoted as $r = \\mathrm{rank}(\\mathbf{A})$.\n\nThe problem requires an algorithm to first select a set of $r$ basis species and then express any given complex as a linear combination of this basis.\n\nStep 1: Basis Selection and Rank Determination\n\nA numerically robust method for finding a basis for the column space of a matrix is the QR decomposition with column pivoting. This algorithm decomposes the stoichiometric matrix $\\mathbf{A}$ such that $\\mathbf{A}\\mathbf{P} = \\mathbf{Q}\\mathbf{R}$, where:\n- $\\mathbf{P}$ is a permutation matrix of size $n \\times n$ that reorders the columns of $\\mathbf{A}$. The permutation is chosen to prioritize columns that are most linearly independent.\n- $\\mathbf{Q}$ is an orthogonal matrix of size $m \\times m$ (i.e., $\\mathbf{Q}^T\\mathbf{Q} = \\mathbf{I}$).\n- $\\mathbf{R}$ is an upper triangular matrix of size $m \\times n$.\n\nThe column pivoting ensures that the diagonal elements of $\\mathbf{R}$ appear in decreasing order of magnitude: $|\\mathbf{R}_{11}| \\ge |\\mathbf{R}_{22}| \\ge \\dots$. Due to finite precision arithmetic, some columns may be nearly linearly dependent. The numerical rank $r$ can be determined by finding the point where the diagonal elements of $\\mathbf{R}$ become negligible. A common tolerance, $\\tau$, is used for this purpose, defined relative to the magnitude of the largest element and machine precision, $\\epsilon$:\n$$ \\tau = \\max(m, n) \\cdot |\\mathbf{R}_{11}| \\cdot \\epsilon $$\nThe rank $r$ is the count of diagonal elements $|\\mathbf{R}_{kk}|$ such that $|\\mathbf{R}_{kk}|  \\tau$.\n\nThe first $r$ columns of the permuted matrix $\\mathbf{A}\\mathbf{P}$ constitute a well-conditioned basis for $\\mathrm{Col}(\\mathbf{A})$. These columns correspond to the chosen basis species. If the permutation matrix $\\mathbf{P}$ is represented by a vector of indices $\\mathbf{p}$, the indices of the basis species in the original matrix $\\mathbf{A}$ are given by the first $r$ elements of $\\mathbf{p}$. The basis matrix $\\mathbf{B}$ is then constructed by taking these $r$ columns from $\\mathbf{A}$:\n$$ \\mathbf{B} = \\mathbf{A}_{:, \\mathbf{p}(1:r)} \\in \\mathbb{R}^{m \\times r} $$\n\nStep 2: Expressing Complexes in the Basis\n\nOnce the basis matrix $\\mathbf{B}$ is established, any complex represented by its composition vector $\\mathbf{a}_j$ (which is a column of $\\mathbf{A}$) can be expressed as a linear combination of the basis vectors. We seek a coefficient vector $\\mathbf{c}_j \\in \\mathbb{R}^r$ such that:\n$$ \\mathbf{B} \\mathbf{c}_j = \\mathbf{a}_j $$\nThis is a system of linear equations. Since the columns of $\\mathbf{B}$ form a basis for $\\mathrm{Col}(\\mathbf{A})$ and $\\mathbf{a}_j \\in \\mathrm{Col}(\\mathbf{A})$, a unique solution for $\\mathbf{c}_j$ is guaranteed to exist. The system may be overdetermined if $m  r$, but it will be consistent.\n\nA stable method for solving this system is to find the least-squares solution to $\\min_{\\mathbf{c}_j} \\|\\mathbf{B} \\mathbf{c}_j - \\mathbf{a}_j\\|_2$. Because the system is consistent, the minimum residual will be zero (within machine precision). This can be robustly solved using the QR decomposition of $\\mathbf{B}$ or by functions purpose-built for least-squares problems, such as `scipy.linalg.lstsq` in Python. The resulting vector $\\mathbf{c}_j$ contains the stoichiometric coefficients that express the complex $j$ in terms of the ordered basis species.\n\nThe implemented algorithm will follow these two steps for each test case, providing the coefficient vectors rounded to the specified precision.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the final result.\n    \"\"\"\n\n    def process_case(A, complex_indices, precision=6):\n        \"\"\"\n        Selects a basis for the column space of A using pivoted QR, and for each\n        specified complex, computes the coefficients of its linear combination \n        in terms of that basis.\n\n        Args:\n            A (np.ndarray): The stoichiometric matrix.\n            complex_indices (list[int]): A list of column indices for the complexes to map.\n            precision (int): The number of decimal places to round the coefficients to.\n\n        Returns:\n            list[list[float]]: A list of coefficient vectors, one for each complex.\n        \"\"\"\n        # Ensure A is a double precision floating point array\n        A = np.array(A, dtype=np.float64)\n        m, n = A.shape\n\n        if m == 0 or n == 0:\n            # Handle empty matrix case\n            return [[] for _ in complex_indices]\n\n        # Step 1: Perform QR decomposition with column pivoting\n        Q, R, P = linalg.qr(A, pivoting=True)\n\n        # Step 2: Determine the numerical rank\n        # A standard tolerance is based on the matrix dimensions, machine epsilon,\n        # and the magnitude of the first diagonal element of R.\n        if abs(R[0, 0])  np.finfo(A.dtype).eps:\n            rank = 0\n        else:\n            tol = np.abs(R[0, 0]) * max(m, n) * np.finfo(A.dtype).eps\n            rank = np.sum(np.abs(np.diag(R))  tol)\n\n        # If rank is 0, the matrix is effectively a zero matrix.\n        if rank == 0:\n            # A zero vector is the only thing in the span. The only valid complex\n            # is the zero vector, and its coefficient vector would be empty as there's no basis.\n            return [[] for _ in complex_indices]\n\n        # Step 3: Select the basis matrix B using the first 'rank' pivot indices.\n        # The basis species are ordered according to the pivot order.\n        basis_indices = P[:rank]\n        basis_matrix = A[:, basis_indices]\n        \n        # Step 4: For each complex, solve for its coefficients in the chosen basis.\n        all_complex_coeffs = []\n        for idx in complex_indices:\n            complex_vector = A[:, idx]\n            \n            # Solve the linear system B * c = a_j using a robust least-squares solver.\n            # Since a_j is in the column space of B, the least-squares solution is exact.\n            # The first element returned by lstsq is the coefficient vector.\n            c, _, _, _ = linalg.lstsq(basis_matrix, complex_vector)\n            \n            # Round the coefficients to the specified precision\n            rounded_c = np.round(c, precision).tolist()\n            all_complex_coeffs.append(rounded_c)\n            \n        return all_complex_coeffs\n\n    # Test Case 1: Happy path; carbonate system\n    A1 = np.array([\n        [1, 1, 2, 1, 0, 0],\n        [0, 1, 1, 3, 3, 2],\n        [0, 0, 0, 1, 1, 1]\n    ])\n    complex_indices_1 = [2, 3, 4]\n\n    # Test Case 2: Boundary; duplicate composition\n    A2 = np.array([\n        [1, 1, 2, 2],\n        [0, 1, 1, 1],\n        [0, 0, 0, 0]\n    ])\n    complex_indices_2 = [3]\n\n    # Test Case 3: Edge case; numerical noise\n    A3 = np.array([\n        [1, 1, 0, 0, 2],\n        [0, 1, 2, 2 + 1e-12, 1],\n        [0, 0, 1, 1, 0]\n    ])\n    complex_indices_3 = [3]\n\n    test_cases = [\n        (A1, complex_indices_1),\n        (A2, complex_indices_2),\n        (A3, complex_indices_3)\n    ]\n\n    results = []\n    for A_case, indices_case in test_cases:\n        result = process_case(A_case, indices_case)\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    # Convert each test case's result (a list of lists) to its string representation,\n    # remove spaces, and join them with commas.\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With a mathematically defined system, the next challenge is to compute the equilibrium state by solving the nonlinear equations derived from the law of mass action. This exercise  provides hands-on practice in implementing the Newton-Raphson method, a cornerstone algorithm for equilibrium calculations. By testing your solver against simple systems with exact analytical solutions, you will gain crucial skills in algorithm validation and a concrete understanding of how thermodynamic laws translate into computational practice.",
            "id": "4069193",
            "problem": "You are tasked to derive analytical solutions for two simple, ideal systems used in computational geochemistry, and to implement an algorithmic solver that verifies its numerical accuracy against the closed-form results for a small test suite. All calculations must be framed in terms of the chemical equilibrium conditions derived from fundamental thermodynamic laws and ideal solution theory, without relying on shortcut formulas provided in this statement. The systems are as follows.\n\nSystem A: Ideal binary isomerization, $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$. Consider a closed, isothermal, isobaric, well-mixed system with total amount $N$ (in moles) containing species $\\mathrm{A}$ and $\\mathrm{B}$ undergoing $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$. Assume ideal-solution thermodynamics with activities equal to mole fractions, and that the equilibrium constant $K$ is defined in the mole-fraction standard state (dimensionless). The system starts at $n_{\\mathrm{A}}(0) = N$ and $n_{\\mathrm{B}}(0) = 0$. From the equality of chemical potentials at equilibrium for the reaction extent, derive the analytical equilibrium mole amounts $n_{\\mathrm{A}}^\\star$ and $n_{\\mathrm{B}}^\\star$ based on the fundamental relations for chemical potentials $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, the stoichiometric reaction condition, and the law of mass action in ideal solutions. Then, implement a numerical solver using the Newton method for the reaction extent that enforces the appropriate equilibrium condition in terms of the reaction quotient and $K$, subject to nonnegativity constraints on mole amounts.\n\nSystem B: Ideal aqueous monoprotic acid dissociation, $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-$. Consider an aqueous solution at constant temperature and pressure, with a total analytical concentration $C$ (in $\\mathrm{mol}/\\mathrm{L}$) of a monoprotic acid $\\mathrm{HA}$. Assume ideal-solution activities equal to molar concentrations, and neglect autoionization of water and any other electrolytes. Using the mass balance for the acid, electroneutrality, and the equilibrium law based on $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, derive an analytical expression for the equilibrium concentration $[\\mathrm{H}^+]^\\star$ in $\\mathrm{mol}/\\mathrm{L}$ given the acid dissociation constant $K_a$ (dimensionless under the chosen concentration standard state). Then, implement a Newton solver for the nonnegative root of the equation implied by the mass balance and law-of-mass-action constraints, subject to the constraint $0 \\le [\\mathrm{H}^+] \\le C$.\n\nYour program must:\n- Implement a robust Newton method with clamping to physically admissible domains for each system and verify convergence.\n- Compute, for each test case, the absolute difference between the numerical solution produced by your solver and the derived closed-form analytical solution. For System A, compute the maximum of the absolute errors in the two speciesâ€™ equilibrium mole amounts. For System B, compute the absolute error in $[\\mathrm{H}^+]$ in $\\mathrm{mol}/\\mathrm{L}$.\n- Express mole amounts in moles and concentrations in $\\mathrm{mol}/\\mathrm{L}$. The output of your program must be these absolute errors (unit-consistent with the quantity being compared) as floating-point numbers.\n\nUse the following test suite of parameter values:\n- System A (ideal binary isomerization):\n  - Case A1: $N = 1.0$ (moles), $K = 2.0$.\n  - Case A2: $N = 1.0$ (moles), $K = 10^{-12}$.\n  - Case A3: $N = 1.0$ (moles), $K = 10^{12}$.\n- System B (ideal aqueous monoprotic acid):\n  - Case B1: $C = 0.01$ ($\\mathrm{mol}/\\mathrm{L}$), $K_a = 1.8 \\times 10^{-5}$.\n  - Case B2: $C = 0.1$ ($\\mathrm{mol}/\\mathrm{L}$), $K_a = 10.0$.\n  - Case B3: $C = 1.0$ ($\\mathrm{mol}/\\mathrm{L}$), $K_a = 10^{-9}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"), where the elements appear in the same order as the test cases above: A1, A2, A3, B1, B2, B3. Each element must be a floating-point number. No other text should be printed.",
            "solution": "The derivation of analytical solutions and the formulation of the numerical problem for each system are presented below.\n\n**System A: Ideal Binary Isomerization**\n\nThe system is defined by the reaction $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$ in a closed system with a total of $N$ moles.\n\n1.  **Stoichiometry and Mass Balance**: Let $\\xi$ be the extent of reaction in moles, representing the number of moles of $\\mathrm{A}$ that have converted to $\\mathrm{B}$. Given the initial conditions $n_{\\mathrm{A}}(0) = N$ and $n_{\\mathrm{B}}(0) = 0$, the mole amounts at any extent $\\xi$ are:\n    $$n_{\\mathrm{A}}(\\xi) = n_{\\mathrm{A}}(0) - \\xi = N - \\xi$$\n    $$n_{\\mathrm{B}}(\\xi) = n_{\\mathrm{B}}(0) + \\xi = \\xi$$\n    The total moles in the system, $n_{\\mathrm{T}} = n_{\\mathrm{A}} + n_{\\mathrm{B}} = (N - \\xi) + \\xi = N$, remain constant. The physical constraints on mole amounts, $n_{\\mathrm{A}} \\ge 0$ and $n_{\\mathrm{B}} \\ge 0$, require that the reaction extent $\\xi$ be bounded: $0 \\le \\xi \\le N$.\n\n2.  **Thermodynamic Equilibrium Condition**: At equilibrium, the Gibbs free energy of the reaction is zero, which implies that the chemical potentials of the reactants and products are balanced according to the reaction stoichiometry:\n    $$\\sum_{i} \\nu_i \\mu_i = 0$$\n    For this reaction, the stoichiometric coefficients are $\\nu_{\\mathrm{A}} = -1$ and $\\nu_{\\mathrm{B}} = 1$. The equilibrium condition is therefore $\\mu_{\\mathrm{B}} - \\mu_{\\mathrm{A}} = 0$, or $\\mu_{\\mathrm{A}} = \\mu_{\\mathrm{B}}$.\n\n3.  **Law of Mass Action**: The chemical potential of a species $i$ in an ideal solution is given by $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, where $\\mu_i^\\circ$ is the standard state chemical potential, $R$ is the ideal gas constant, $T$ is the absolute temperature, and $a_i$ is the activity of species $i$. Substituting this into the equilibrium condition:\n    $$\\mu_{\\mathrm{A}}^\\circ + RT \\ln a_{\\mathrm{A}} = \\mu_{\\mathrm{B}}^\\circ + RT \\ln a_{\\mathrm{B}}$$\n    Rearranging gives $\\mu_{\\mathrm{B}}^\\circ - \\mu_{\\mathrm{A}}^\\circ = -RT \\ln(a_{\\mathrm{B}}/a_{\\mathrm{A}})$. The standard Gibbs free energy of reaction is $\\Delta G^\\circ = \\mu_{\\mathrm{B}}^\\circ - \\mu_{\\mathrm{A}}^\\circ$, and it is related to the equilibrium constant $K$ by $\\Delta G^\\circ = -RT \\ln K$. Equating these expressions yields the law of mass action:\n    $$K = \\frac{a_{\\mathrm{B}}}{a_{\\mathrm{A}}}$$\n\n4.  **Analytical Solution**: For an ideal solution, activities are equal to mole fractions, $a_i = x_i = n_i / n_{\\mathrm{T}}$. Substituting the expressions for mole amounts and $n_{\\mathrm{T}} = N$:\n    $$K = \\frac{x_{\\mathrm{B}}}{x_{\\mathrm{A}}} = \\frac{n_{\\mathrm{B}}/N}{n_{\\mathrm{A}}/N} = \\frac{n_{\\mathrm{B}}}{n_{\\mathrm{A}}} = \\frac{\\xi}{N - \\xi}$$\n    Solving for the equilibrium extent, $\\xi^\\star$:\n    $$K(N - \\xi^\\star) = \\xi^\\star \\implies KN - K\\xi^\\star = \\xi^\\star \\implies KN = \\xi^\\star(1 + K)$$\n    $$\\xi^\\star = \\frac{KN}{1 + K}$$\n    The equilibrium mole amounts, $n_{\\mathrm{A}}^\\star$ and $n_{\\mathrm{B}}^\\star$, are:\n    $$n_{\\mathrm{A}}^\\star = N - \\xi^\\star = N - \\frac{KN}{1 + K} = \\frac{N(1 + K) - KN}{1 + K} = \\frac{N}{1 + K}$$\n    $$n_{\\mathrm{B}}^\\star = \\xi^\\star = \\frac{KN}{1 + K}$$\n\n5.  **Numerical Solver Formulation**: The Newton-Raphson method is used to find the root of the residual function $f(\\xi) = 0$, where $f(\\xi)$ represents the equilibrium condition. We define $f(\\xi)$ based on the reaction quotient, $Q(\\xi) = \\xi/(N-\\xi)$:\n    $$f(\\xi) = \\frac{\\xi}{N-\\xi} - K = 0$$\n    The derivative with respect to $\\xi$ is:\n    $$f'(\\xi) = \\frac{d}{d\\xi} \\left( \\frac{\\xi}{N-\\xi} - K \\right) = \\frac{(1)(N-\\xi) - (\\xi)(-1)}{(N-\\xi)^2} = \\frac{N}{(N-\\xi)^2}$$\n    The Newton iteration is $\\xi_{k+1} = \\xi_k - f(\\xi_k)/f'(\\xi_k)$. Iterates must be clamped to the physical domain $(0, N)$ to prevent division by zero and maintain physical realism.\n\n**System B: Ideal Aqueous Monoprotic Acid Dissociation**\n\nThe system is defined by the reaction $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-$.\n\n1.  **Stoichiometry and Mass/Charge Balance**: Let $x$ be the equilibrium concentration of hydrogen ions, $x = [\\mathrm{H}^+]^\\star$.\n    -   **Charge Balance**: Neglecting water autoionization, the only ions are $\\mathrm{H}^+$ and $\\mathrm{A}^-$. Electroneutrality requires $[\\mathrm{H}^+] = [\\mathrm{A}^-]$. Therefore, $[\\mathrm{A}^{-}]^\\star = x$.\n    -   **Mass Balance**: The total concentration of the acid moiety, $C$, is distributed between the protonated form, $\\mathrm{HA}$, and the deprotonated form, $\\mathrm{A}^{-}$. Thus, $C = [\\mathrm{HA}] + [\\mathrm{A}^{-}]$.\n    -   From these relations, we find the equilibrium concentration of the undissociated acid: $[\\mathrm{HA}]^\\star = C - [\\mathrm{A}^{-}]^\\star = C - x$.\n    -   Physical constraints require all concentrations to be non-negative, which implies $0 \\le x \\le C$.\n\n2.  **Law of Mass Action**: The derivation is analogous to System A, leading to the expression for the acid dissociation constant, $K_a$:\n    $$K_a = \\frac{a_{\\mathrmH}^+ a_{\\mathrmA}^-}{a_{\\mathrmHA}}$$\n\n3.  **Analytical Solution**: The problem states to assume activities are equal to molar concentrations, $a_i = [i]$. Substituting the expressions for equilibrium concentrations in terms of $x$:\n    $$K_a = \\frac{[\\mathrm{H}^+][\\mathrm{A}^-]}{[\\mathrm{HA}]} = \\frac{(x)(x)}{C - x} = \\frac{x^2}{C - x}$$\n    Rearranging this into a standard quadratic form $ax^2+bx+c=0$:\n    $$K_a(C-x) = x^2 \\implies K_aC - K_ax = x^2 \\implies x^2 + K_ax - K_aC = 0$$\n    Using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=1$, $b=K_a$, and $c=-K_aC$:\n    $$x = \\frac{-K_a \\pm \\sqrt{K_a^2 - 4(1)(-K_aC)}}{2} = \\frac{-K_a \\pm \\sqrt{K_a^2 + 4K_aC}}{2}$$\n    Since concentration $x$ must be positive, we take the positive root:\n    $$[\\mathrm{H}^+]^\\star = x = \\frac{-K_a + \\sqrt{K_a^2 + 4K_aC}}{2}$$\n\n4.  **Numerical Solver Formulation**: We seek the root of the residual function $f(x) = 0$ derived from the quadratic equation, which is numerically more stable than the fractional form.\n    $$f(x) = x^2 + K_ax - K_aC = 0$$\n    The derivative with respect to $x$ is:\n    $$f'(x) = 2x + K_a$$\n    The Newton iteration is $x_{k+1} = x_k - f(x_k)/f'(x_k)$. Iterates are clamped to the physical domain $[0, C]$. For $x \\ge 0$ and $K_a  0$, the derivative $f'(x)$ is always positive, and the function $f(x)$ is convex, ensuring robust convergence for the Newton method.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef newton_solver(f, f_prime, x0, tol=1e-15, max_iter=100, x_min=-np.inf, x_max=np.inf):\n    \"\"\"\n    A robust Newton-Raphson solver with clamping.\n    \"\"\"\n    x = float(x0)\n    for _ in range(max_iter):\n        fx = f(x)\n        if abs(fx)  tol:\n            return x\n\n        fpx = f_prime(x)\n        # Avoid division by zero or a very small number if derivative is flat\n        if abs(fpx)  1e-20:\n            return x\n        \n        step = fx / fpx\n        x_next = x - step\n        \n        # Clamp the next iterate to the physically valid domain\n        if x_next  x_min:\n            x_next = x_min\n        if x_next  x_max:\n            x_next = x_max\n\n        # Check for convergence based on step size, after the first iteration\n        if _  0 and abs(x_next - x)  tol:\n             return x_next\n\n        x = x_next\n    \n    return x\n\ndef calculate_error_A(N, K):\n    \"\"\"\n    Calculates the error for System A: Ideal binary isomerization.\n    \n    Args:\n        N (float): Total moles in the system.\n        K (float): Dimensionless equilibrium constant.\n        \n    Returns:\n        float: The maximum absolute error between analytical and numerical mole amounts.\n    \"\"\"\n    # 1. Analytical Solution\n    n_A_analytical = N / (1.0 + K)\n    n_B_analytical = K * N / (1.0 + K)\n\n    # 2. Numerical Solution using Newton's method for reaction extent xi\n    # The residual function is f(xi) = Q - K = xi / (N - xi) - K = 0\n    f = lambda xi: xi / (N - xi) - K if (N - xi) != 0 else np.inf\n    # The derivative is f'(xi) = N / (N - xi)^2\n    f_prime = lambda xi: N / (N - xi)**2 if (N - xi) != 0 else np.inf\n\n    # A small epsilon to keep xi away from the singular boundaries of the domain (0, N)\n    epsilon = 1e-15 \n    # Initial guess in the middle of the domain is robust\n    xi_0 = N / 2.0\n\n    xi_numerical = newton_solver(\n        f, f_prime, xi_0, x_min=epsilon, x_max=N - epsilon\n    )\n    \n    n_A_numerical = N - xi_numerical\n    n_B_numerical = xi_numerical\n\n    # 3. Compute error\n    error = max(abs(n_A_analytical - n_A_numerical), abs(n_B_analytical - n_B_numerical))\n    return error\n\ndef calculate_error_B(C, Ka):\n    \"\"\"\n    Calculates the error for System B: Ideal monoprotic acid dissociation.\n    \n    Args:\n        C (float): Total analytical concentration of the acid (mol/L).\n        Ka (float): Dimensionless acid dissociation constant.\n        \n    Returns:\n        float: The absolute error between analytical and numerical [H+].\n    \"\"\"\n    # 1. Analytical Solution\n    # From x^2 + Ka*x - Ka*C = 0, where x = [H+]\n    h_plus_analytical = (-Ka + np.sqrt(Ka**2 + 4.0 * Ka * C)) / 2.0\n\n    # 2. Numerical Solution using Newton's method for x = [H+]\n    # The residual function is f(x) = x^2 + Ka*x - Ka*C = 0\n    f = lambda x: x**2 + Ka * x - Ka * C\n    # The derivative is f'(x) = 2*x + Ka\n    f_prime = lambda x: 2.0 * x + Ka\n\n    # Initial guess can be 0, as f'(0)=Ka  0, so it's a safe starting point.\n    x_0 = 0.0\n\n    h_plus_numerical = newton_solver(\n        f, f_prime, x_0, x_min=0.0, x_max=C\n    )\n\n    # 3. Compute error\n    error = abs(h_plus_analytical - h_plus_numerical)\n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # System A: (system_type, N, K)\n        ('A', 1.0, 2.0),\n        ('A', 1.0, 1.0e-12),\n        ('A', 1.0, 1.0e12),\n        # System B: (system_type, C, Ka)\n        ('B', 0.01, 1.8e-5),\n        ('B', 0.1, 10.0),\n        ('B', 1.0, 1.0e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        system_type = case[0]\n        if system_type == 'A':\n            N, K = case[1], case[2]\n            error = calculate_error_A(N, K)\n            results.append(error)\n        elif system_type == 'B':\n            C, Ka = case[1], case[2]\n            error = calculate_error_B(C, Ka)\n            results.append(error)\n\n    # Final print statement in the exact required format.\n    # We use exponential notation to represent a floating point number with high precision.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An equilibrium calculation provides a single snapshot of a system, but how does that snapshot change if our input parameters, like equilibrium constants ($K$), are slightly uncertain? This practice  delves into sensitivity analysis, a powerful technique to answer this question by applying the implicit function theorem to the governing equations of equilibrium. Mastering this method allows you to probe the robustness of your model and identify the key thermodynamic parameters that control the chemical state of the system.",
            "id": "4069351",
            "problem": "Consider an aqueous, monoprotic weak acid system at temperature $25\\,^{\\circ}\\mathrm{C}$ with species vector $\\mathbf{x} = ([\\mathrm{H}^{+}], [\\mathrm{A}^{-}], [\\mathrm{HA}], [\\mathrm{OH}^{-}])^{\\mathsf{T}} \\in \\mathbb{R}^{4}$, and parameter $p = \\ln K_{a}$, where $K_{a}$ is the acid dissociation constant of the reaction $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$. The system is governed by the law of mass action, water autoionization, total mass balance, and electroneutrality. Using only these fundamental relations, define the residual function $\\mathbf{F}(\\mathbf{x}, p) \\in \\mathbb{R}^{4}$ whose root $\\mathbf{F}(\\mathbf{x}, p) = \\mathbf{0}$ corresponds to chemical equilibrium:\n- Law of mass action for acid dissociation,\n- Water autoionization,\n- Total acid mass balance with total analytical concentration $T_{\\mathrm{A}}$,\n- Electroneutrality.\n\nAssume $T_{\\mathrm{A}} = 10^{-3}$, $K_{w} = 10^{-14}$, and $K_{a} = 10^{-5}$ (all in consistent molar units), so that $p = \\ln K_{a}$. At these conditions, suppose a high-precision equilibrium solver returns the composition\n$$\n[ \\mathrm{H}^{+} ]^{\\ast} = 9.512509 \\times 10^{-5}, \\quad\n[ \\mathrm{A}^{-} ]^{\\ast} = 9.512562 \\times 10^{-5}, \\quad\n[ \\mathrm{HA} ]^{\\ast} = 9.0487438 \\times 10^{-4}, \\quad\n[ \\mathrm{OH}^{-} ]^{\\ast} = 1.051260 \\times 10^{-10}.\n$$\nStarting from the definition $\\mathbf{F}(\\mathbf{x}, p) = \\mathbf{0}$, use implicit differentiation with respect to $p$ to derive the linear system satisfied by $\\mathrm{d}\\mathbf{x}/\\mathrm{d}p$ at equilibrium. Then, by solving this system, compute the sensitivity of the hydrogen ion concentration with respect to $p$ at the given equilibrium point, i.e., compute $\\mathrm{d}[ \\mathrm{H}^{+} ] / \\mathrm{d}(\\ln K_{a})$ evaluated at the state above.\n\nExpress your final sensitivity value in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ and round your answer to four significant figures. The final answer must be a single number.",
            "solution": "The problem asks for the sensitivity of the hydrogen ion concentration with respect to the logarithm of the acid dissociation constant, $\\mathrm{d}[ \\mathrm{H}^{+} ] / \\mathrm{d}(\\ln K_{a})$, for a monoprotic weak acid system at a specified equilibrium point.\n\nLet the vector of concentrations be denoted by $\\mathbf{x} \\in \\mathbb{R}^{4}$, where $x_1 = [\\mathrm{H}^{+}]$, $x_2 = [\\mathrm{A}^{-}]$, $x_3 = [\\mathrm{HA}]$, and $x_4 = [\\mathrm{OH}^{-}]$.\nThe parameter of interest is $p = \\ln K_a$, which implies that the acid dissociation constant is $K_a = \\exp(p)$.\n\nThe system is at equilibrium when the concentrations satisfy a set of four governing equations. We can express these as a residual vector function $\\mathbf{F}(\\mathbf{x}, p) = \\mathbf{0}$, where $\\mathbf{F}: \\mathbb{R}^{4} \\times \\mathbb{R} \\to \\mathbb{R}^{4}$.\n\nThe four governing relations are:\n1.  Law of mass action for the acid dissociation $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$:\n    $$K_a = \\frac{[\\mathrm{H}^{+}][\\mathrm{A}^{-}]}{[\\mathrm{HA}]} \\implies [\\mathrm{H}^{+}][\\mathrm{A}^{-}] - K_a [\\mathrm{HA}] = 0$$\n    In terms of our vector $\\mathbf{x}$ and parameter $p$, this gives the first component of our residual function:\n    $$F_1(\\mathbf{x}, p) = x_1 x_2 - \\exp(p) x_3 = 0$$\n2.  Water autoionization, $\\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{OH}^{-}$:\n    $$K_w = [\\mathrm{H}^{+}][\\mathrm{OH}^{-}] \\implies [\\mathrm{H}^{+}][\\mathrm{OH}^{-}] - K_w = 0$$\n    This gives the second component, which is independent of $p$:\n    $$F_2(\\mathbf{x}, p) = x_1 x_4 - K_w = 0$$\n3.  Total mass balance for the acid species A, with total analytical concentration $T_A$:\n    $$T_A = [\\mathrm{HA}] + [\\mathrm{A}^{-}] \\implies [\\mathrm{A}^{-}] + [\\mathrm{HA}] - T_A = 0$$\n    This gives the third component, which is independent of $p$:\n    $$F_3(\\mathbf{x}, p) = x_2 + x_3 - T_A = 0$$\n4.  Electroneutrality (charge balance):\n    $$[\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}] \\implies [\\mathrm{H}^{+}] - [\\mathrm{A}^{-}] - [\\mathrm{OH}^{-}] = 0$$\n    This gives the fourth component, which is independent of $p$:\n    $$F_4(\\mathbf{x}, p) = x_1 - x_2 - x_4 = 0$$\n\nCombining these, the residual function is:\n$$\n\\mathbf{F}(\\mathbf{x}, p) = \\begin{pmatrix} x_1 x_2 - \\exp(p) x_3 \\\\ x_1 x_4 - K_w \\\\ x_2 + x_3 - T_A \\\\ x_1 - x_2 - x_4 \\end{pmatrix} = \\mathbf{0}\n$$\nThe equilibrium state $\\mathbf{x}$ is an implicit function of the parameter $p$. To find the sensitivity of the state with respect to the parameter, we differentiate the equilibrium condition $\\mathbf{F}(\\mathbf{x}(p), p) = \\mathbf{0}$ with respect to $p$ using the multivariable chain rule:\n$$ \\frac{\\mathrm{d}\\mathbf{F}}{\\mathrm{d}p} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} \\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}p} + \\frac{\\partial \\mathbf{F}}{\\partial p} = \\mathbf{0} $$\nThis can be written as a linear system for the sensitivity vector $\\mathrm{d}\\mathbf{x}/\\mathrm{d}p$:\n$$ \\mathbf{J} \\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}p} = -\\frac{\\partial \\mathbf{F}}{\\partial p} $$\nwhere $\\mathbf{J} = \\partial \\mathbf{F}/\\partial \\mathbf{x}$ is the Jacobian matrix of $\\mathbf{F}$ with respect to $\\mathbf{x}$.\n\nFirst, we compute the Jacobian matrix $\\mathbf{J}$:\n$$\n\\mathbf{J} = \\begin{pmatrix}\n\\frac{\\partial F_1}{\\partial x_1}  \\frac{\\partial F_1}{\\partial x_2}  \\frac{\\partial F_1}{\\partial x_3}  \\frac{\\partial F_1}{\\partial x_4} \\\\\n\\frac{\\partial F_2}{\\partial x_1}  \\frac{\\partial F_2}{\\partial x_2}  \\frac{\\partial F_2}{\\partial x_3}  \\frac{\\partial F_2}{\\partial x_4} \\\\\n\\frac{\\partial F_3}{\\partial x_1}  \\frac{\\partial F_3}{\\partial x_2}  \\frac{\\partial F_3}{\\partial x_3}  \\frac{\\partial F_3}{\\partial x_4} \\\\\n\\frac{\\partial F_4}{\\partial x_1}  \\frac{\\partial F_4}{\\partial x_2}  \\frac{\\partial F_4}{\\partial x_3}  \\frac{\\partial F_4}{\\partial x_4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nx_2  x_1  -\\exp(p)  0 \\\\\nx_4  0  0  x_1 \\\\\n0  1  1  0 \\\\\n1  -1  0  -1\n\\end{pmatrix}\n$$\nSince $K_a = \\exp(p)$, we have $\\mathbf{J} = \\begin{pmatrix} x_2  x_1  -K_a  0 \\\\ x_4  0  0  x_1 \\\\ 0  1  1  0 \\\\ 1  -1  0  -1 \\end{pmatrix}$.\n\nNext, we compute the partial derivative of $\\mathbf{F}$ with respect to $p$:\n$$\n\\frac{\\partial \\mathbf{F}}{\\partial p} = \\begin{pmatrix} -\\exp(p) x_3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -K_a x_3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nLet the sensitivity vector be $\\mathbf{s} = \\mathrm{d}\\mathbf{x}/\\mathrm{d}p = (s_1, s_2, s_3, s_4)^{\\mathsf{T}}$. The linear system $\\mathbf{J}\\mathbf{s} = -\\partial\\mathbf{F}/\\partial p$ is:\n$$\n\\begin{pmatrix}\nx_2  x_1  -K_a  0 \\\\\nx_4  0  0  x_1 \\\\\n0  1  1  0 \\\\\n1  -1  0  -1\n\\end{pmatrix}\n\\begin{pmatrix} s_1 \\\\ s_2 \\\\ s_3 \\\\ s_4 \\end{pmatrix}\n=\n\\begin{pmatrix} K_a x_3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nWe need to solve for $s_1 = \\mathrm{d}x_1/\\mathrm{d}p = \\mathrm{d}[ \\mathrm{H}^{+} ] / \\mathrm{d}(\\ln K_{a})$. We can solve this system algebraically.\nFrom the rows of the system:\n(Eq. 2) $x_4 s_1 + x_1 s_4 = 0 \\implies s_4 = -\\frac{x_4}{x_1}s_1$\n(Eq. 3) $s_2 + s_3 = 0 \\implies s_3 = -s_2$\n(Eq. 4) $s_1 - s_2 - s_4 = 0 \\implies s_2 = s_1 - s_4 = s_1 - (-\\frac{x_4}{x_1}s_1) = s_1 \\left(1 + \\frac{x_4}{x_1}\\right)$\nNow, substitute the expressions for $s_2$ and $s_3$ into the first equation:\n(Eq. 1) $x_2 s_1 + x_1 s_2 - K_a s_3 = K_a x_3$\n$$ x_2 s_1 + x_1 \\left[s_1 \\left(1 + \\frac{x_4}{x_1}\\right)\\right] - K_a \\left[-s_1 \\left(1 + \\frac{x_4}{x_1}\\right)\\right] = K_a x_3 $$\nFactor out $s_1$:\n$$ s_1 \\left[ x_2 + x_1\\left(1 + \\frac{x_4}{x_1}\\right) + K_a\\left(1 + \\frac{x_4}{x_1}\\right) \\right] = K_a x_3 $$\n$$ s_1 \\left[ x_2 + (x_1 + K_a)\\left(1 + \\frac{x_4}{x_1}\\right) \\right] = K_a x_3 $$\nSolving for $s_1$:\n$$ s_1 = \\frac{K_a x_3}{x_2 + (x_1 + K_a)\\left(1 + \\frac{x_4}{x_1}\\right)} $$\nThis expression for $s_1$ must be evaluated at the given equilibrium point $\\mathbf{x}^{\\ast}$. The provided values are:\n$x_1^{\\ast} = [ \\mathrm{H}^{+} ]^{\\ast} = 9.512509 \\times 10^{-5}$\n$x_2^{\\ast} = [ \\mathrm{A}^{-} ]^{\\ast} = 9.512562 \\times 10^{-5}$\n$x_3^{\\ast} = [ \\mathrm{HA} ]^{\\ast} = 9.0487438 \\times 10^{-4}$\n$x_4^{\\ast} = [ \\mathrm{OH}^{-} ]^{\\ast} = 1.051260 \\times 10^{-10}$\nAnd constants: $K_a = 10^{-5}$, $K_w = 10^{-14}$.\n\nWe compute the numerator and denominator separately.\nNumerator:\n$$ K_a x_3^{\\ast} = (10^{-5}) \\times (9.0487438 \\times 10^{-4}) = 9.0487438 \\times 10^{-9} $$\nDenominator:\nFirst, calculate intermediate terms:\n$$ x_1^{\\ast} + K_a = 9.512509 \\times 10^{-5} + 10^{-5} = 1.0512509 \\times 10^{-4} $$\n$$ \\frac{x_4^{\\ast}}{x_1^{\\ast}} = \\frac{1.051260 \\times 10^{-10}}{9.512509 \\times 10^{-5}} \\approx 1.1051326 \\times 10^{-6} $$\n$$ 1 + \\frac{x_4^{\\ast}}{x_1^{\\ast}} \\approx 1 + 1.1051326 \\times 10^{-6} = 1.0000011051326 $$\nNow, the second term in the denominator is:\n$$ (x_1^{\\ast} + K_a)\\left(1 + \\frac{x_4^{\\ast}}{x_1^{\\ast}}\\right) \\approx (1.0512509 \\times 10^{-4}) \\times (1.0000011051326) \\approx 1.051252055 \\times 10^{-4} $$\nThe full denominator is:\n$$ x_2^{\\ast} + (x_1^{\\ast} + K_a)\\left(1 + \\frac{x_4^{\\ast}}{x_1^{\\ast}}\\right) \\approx (9.512562 \\times 10^{-5}) + (1.051252055 \\times 10^{-4}) $$\n$$ \\approx 0.9512562 \\times 10^{-4} + 1.051252055 \\times 10^{-4} \\approx 2.002508255 \\times 10^{-4} $$\nFinally, we compute $s_1$:\n$$ s_1 = \\frac{9.0487438 \\times 10^{-9}}{2.002508255 \\times 10^{-4}} \\approx 4.5186903 \\times 10^{-5} $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ s_1 \\approx 4.519 \\times 10^{-5} $$\nThe units are mol/L, as concentration ($x_i$) is in mol/L and the parameter $p = \\ln K_a$ is dimensionless.",
            "answer": "$$\\boxed{4.519 \\times 10^{-5}}$$"
        }
    ]
}