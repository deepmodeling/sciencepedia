{
    "hands_on_practices": [
        {
            "introduction": "A central task in geochemistry is to predict how chemical equilibria respond to changes in temperature, a key variable in geological processes. This practice connects fundamental thermodynamic data—standard-state enthalpy, entropy, and heat capacities—to the equilibrium constant, $K$, by applying Kirchhoff's laws to a metamorphic decarbonation reaction. Mastering this analytical derivation is essential for modeling how mineral assemblages and fluid compositions evolve in Earth's diverse thermal regimes .",
            "id": "4080544",
            "problem": "A metamorphic decarbonation reaction of geochemical interest is the formation of wollastonite from calcite and quartz with the release of carbon dioxide:\n$$\\mathrm{CaCO_3\\,(calcite,\\,s)} + \\mathrm{SiO_2\\,(quartz,\\,s)} \\longrightarrow \\mathrm{CaSiO_3\\,(wollastonite,\\,s)} + \\mathrm{CO_2\\,(g)}.$$\nAssume the standard state for solids is unit activity and the standard state for the gas is an ideal gas at $1~\\mathrm{bar}$. Let the reference temperature be $T_0 = 298.15~\\mathrm{K}$. The standard reaction enthalpy and entropy at $T_0$ are\n$$\\Delta_r H^\\circ(T_0) = 1.08 \\times 10^5~\\mathrm{J\\,mol^{-1}}, \\qquad \\Delta_r S^\\circ(T_0) = 1.70 \\times 10^2~\\mathrm{J\\,mol^{-1}\\,K^{-1}}.$$\nEach species has a temperature-dependent isobaric heat capacity described by the Maier–Kelley form:\n$$c_{p,i}(T) = a_i + b_i\\,T + \\frac{c_i}{T^2},$$\nwith constants (in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ for $a_i$ and $b_i T$, and $\\mathrm{J\\,K\\,mol^{-1}}$ for $c_i$) given by\n$$\\begin{aligned}\n\\text{calcite: }  a_{\\mathrm{cal}} = 81.1,\\quad b_{\\mathrm{cal}} = 1.20 \\times 10^{-2},\\quad c_{\\mathrm{cal}} = -3.00 \\times 10^5,\\\\\n\\text{quartz: }  a_{\\mathrm{qtz}} = 41.5,\\quad b_{\\mathrm{qtz}} = 1.00 \\times 10^{-2},\\quad c_{\\mathrm{qtz}} = -1.50 \\times 10^5,\\\\\n\\text{wollastonite: }  a_{\\mathrm{wol}} = 91.0,\\quad b_{\\mathrm{wol}} = 1.00 \\times 10^{-2},\\quad c_{\\mathrm{wol}} = -4.00 \\times 10^5,\\\\\n\\text{carbon dioxide (ideal gas): }  a_{\\mathrm{CO_2}} = 28.0,\\quad b_{\\mathrm{CO_2}} = 1.50 \\times 10^{-2},\\quad c_{\\mathrm{CO_2}} = 1.00 \\times 10^5.\n\\end{aligned}$$\nThe universal gas constant $R$ should be left symbolic.\n\nStarting from fundamental thermodynamic definitions, derive the expression for the standard reaction Gibbs free energy $\\Delta_r G^\\circ(T)$ by integrating reaction heat capacities between $T_0$ and a general temperature $T$, and then use the equilibrium relation between Gibbs free energy and the equilibrium constant to obtain a closed-form expression for the equilibrium constant $K(T)$ of the reaction as a function of $T$ at $1~\\mathrm{bar}$. Express the final equilibrium constant in a single closed-form analytic expression in terms of $T$, $T_0$, and $R$. Do not round; no numerical approximation is required for the final expression.",
            "solution": "The problem is deemed valid as it is scientifically grounded in fundamental principles of chemical thermodynamics, well-posed with all necessary information provided, and stated in objective, formal language. It represents a standard exercise in computational geochemistry or physical chemistry.\n\nThe objective is to derive a closed-form expression for the equilibrium constant, $K(T)$, for the given reaction. The equilibrium constant is related to the standard Gibbs free energy of reaction, $\\Delta_r G^\\circ(T)$, by the fundamental thermodynamic relation:\n$$ \\Delta_r G^\\circ(T) = -R T \\ln K(T) $$\nwhere $R$ is the universal gas constant and $T$ is the absolute temperature. To find $K(T)$, we must first determine the expression for $\\Delta_r G^\\circ(T)$.\n\nThe standard Gibbs free energy of reaction is defined as:\n$$ \\Delta_r G^\\circ(T) = \\Delta_r H^\\circ(T) - T \\Delta_r S^\\circ(T) $$\nHere, $\\Delta_r H^\\circ(T)$ is the standard reaction enthalpy and $\\Delta_r S^\\circ(T)$ is the standard reaction entropy at temperature $T$. The temperature dependence of these quantities is determined by the standard reaction heat capacity, $\\Delta_r c_p^\\circ(T)$, through the following relations (Kirchhoff's laws):\n$$ \\Delta_r H^\\circ(T) = \\Delta_r H^\\circ(T_0) + \\int_{T_0}^{T} \\Delta_r c_p^\\circ(T') dT' $$\n$$ \\Delta_r S^\\circ(T) = \\Delta_r S^\\circ(T_0) + \\int_{T_0}^{T} \\frac{\\Delta_r c_p^\\circ(T')}{T'} dT' $$\nwhere $T_0 = 298.15~\\mathrm{K}$ is the reference temperature.\n\nThe derivation proceeds in the following steps:\n1.  Calculate the change in standard heat capacity for the reaction, $\\Delta_r c_p^\\circ(T)$.\n2.  Integrate $\\Delta_r c_p^\\circ(T)$ to find expressions for $\\Delta_r H^\\circ(T)$ and $\\Delta_r S^\\circ(T)$.\n3.  Combine these to find $\\Delta_r G^\\circ(T)$.\n4.  Use the relation between $\\Delta_r G^\\circ(T)$ and $K(T)$ to find the final expression for the equilibrium constant.\n\nStep 1: Calculate $\\Delta_r c_p^\\circ(T)$\nThe reaction is:\n$$ \\mathrm{CaCO_3\\,(s)} + \\mathrm{SiO_2\\,(s)} \\longrightarrow \\mathrm{CaSiO_3\\,(s)} + \\mathrm{CO_2\\,(g)} $$\nThe standard reaction heat capacity is the sum of the heat capacities of the products minus the sum for the reactants, weighted by their stoichiometric coefficients (which are all $1$ in this case):\n$$ \\Delta_r c_p^\\circ(T) = \\left(c_{p,\\mathrm{wol}}(T) + c_{p,\\mathrm{CO_2}}(T)\\right) - \\left(c_{p,\\mathrm{cal}}(T) + c_{p,\\mathrm{qtz}}(T)\\right) $$\nUsing the given Maier-Kelley form, $c_{p,i}(T) = a_i + b_i T + \\frac{c_i}{T^2}$, we can write $\\Delta_r c_p^\\circ(T)$ as:\n$$ \\Delta_r c_p^\\circ(T) = \\Delta a + \\Delta b T + \\frac{\\Delta c}{T^2} $$\nwhere:\n$$ \\Delta a = (a_{\\mathrm{wol}} + a_{\\mathrm{CO_2}}) - (a_{\\mathrm{cal}} + a_{\\mathrm{qtz}}) $$\n$$ \\Delta b = (b_{\\mathrm{wol}} + b_{\\mathrm{CO_2}}) - (b_{\\mathrm{cal}} + b_{\\mathrm{qtz}}) $$\n$$ \\Delta c = (c_{\\mathrm{wol}} + c_{\\mathrm{CO_2}}) - (c_{\\mathrm{cal}} + c_{\\mathrm{qtz}}) $$\nSubstituting the given numerical values:\n$$ \\Delta a = (91.0 + 28.0) - (81.1 + 41.5) = 119.0 - 122.6 = -3.6~\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n$$ \\Delta b = (1.00 \\times 10^{-2} + 1.50 \\times 10^{-2}) - (1.20 \\times 10^{-2} + 1.00 \\times 10^{-2}) = 2.50 \\times 10^{-2} - 2.20 \\times 10^{-2} = 3.0 \\times 10^{-3}~\\mathrm{J\\,mol^{-1}\\,K^{-2}} $$\n$$ \\Delta c = (-4.00 \\times 10^5 + 1.00 \\times 10^5) - (-3.00 \\times 10^5 - 1.50 \\times 10^5) = -3.00 \\times 10^5 - (-4.50 \\times 10^5) = 1.5 \\times 10^5~\\mathrm{J\\,K\\,mol^{-1}} $$\n\nStep 2  3: Derive $\\Delta_r G^\\circ(T)$\nInstead of calculating $\\Delta_r H^\\circ(T)$ and $\\Delta_r S^\\circ(T)$ separately and then combining them, it is more direct to calculate $\\ln K(T)$.\n$$ \\ln K(T) = -\\frac{\\Delta_r G^\\circ(T)}{RT} = -\\frac{\\Delta_r H^\\circ(T)}{RT} + \\frac{\\Delta_r S^\\circ(T)}{R} $$\nSubstituting the integral expressions for $\\Delta_r H^\\circ(T)$ and $\\Delta_r S^\\circ(T)$:\n$$ \\ln K(T) = -\\frac{1}{RT}\\left( \\Delta_r H^\\circ(T_0) + \\int_{T_0}^{T} \\Delta_r c_p^\\circ(T') dT' \\right) + \\frac{1}{R}\\left( \\Delta_r S^\\circ(T_0) + \\int_{T_0}^{T} \\frac{\\Delta_r c_p^\\circ(T')}{T'} dT' \\right) $$\nGrouping terms:\n$$ \\ln K(T) = \\left( -\\frac{\\Delta_r H^\\circ(T_0)}{RT} + \\frac{\\Delta_r S^\\circ(T_0)}{R} \\right) + \\frac{1}{R} \\int_{T_0}^{T} \\left( \\frac{\\Delta_r c_p^\\circ(T')}{T'} - \\frac{\\Delta_r c_p^\\circ(T')}{T} \\right) dT' $$\nLet's evaluate the integrals explicitly.\n$$ \\int_{T_0}^{T} \\Delta_r c_p^\\circ(T') dT' = \\int_{T_0}^{T} \\left( \\Delta a + \\Delta b T' + \\frac{\\Delta c}{T'^2} \\right) dT' = \\left[ \\Delta a T' + \\frac{\\Delta b}{2} T'^2 - \\frac{\\Delta c}{T'} \\right]_{T_0}^{T} = \\Delta a (T - T_0) + \\frac{\\Delta b}{2}(T^2 - T_0^2) - \\Delta c\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) $$\n$$ \\int_{T_0}^{T} \\frac{\\Delta_r c_p^\\circ(T')}{T'} dT' = \\int_{T_0}^{T} \\left( \\frac{\\Delta a}{T'} + \\Delta b + \\frac{\\Delta c}{T'^3} \\right) dT' = \\left[ \\Delta a \\ln T' + \\Delta b T' - \\frac{\\Delta c}{2T'^2} \\right]_{T_0}^{T} = \\Delta a \\ln\\left(\\frac{T}{T_0}\\right) + \\Delta b(T - T_0) - \\frac{\\Delta c}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_0^2}\\right) $$\nNow, substituting these back into the expression for $\\ln K(T)$:\n$$ \\ln K(T) = -\\frac{\\Delta_r H^\\circ(T_0)}{RT} - \\frac{1}{RT}\\left[\\Delta a (T - T_0) + \\frac{\\Delta b}{2}(T^2 - T_0^2) - \\Delta c\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)\\right] + \\frac{\\Delta_r S^\\circ(T_0)}{R} + \\frac{1}{R}\\left[\\Delta a \\ln\\left(\\frac{T}{T_0}\\right) + \\Delta b(T - T_0) - \\frac{\\Delta c}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_0^2}\\right)\\right] $$\nWe group the terms by the coefficients $\\Delta a$, $\\Delta b$, and $\\Delta c$:\nThe term with $\\Delta a$:\n$$ -\\frac{\\Delta a(T - T_0)}{RT} + \\frac{\\Delta a}{R}\\ln\\left(\\frac{T}{T_0}\\right) = \\frac{\\Delta a}{R}\\left(-\\frac{T-T_0}{T} + \\ln\\left(\\frac{T}{T_0}\\right)\\right) = \\frac{\\Delta a}{R}\\left(\\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1\\right) $$\nThe term with $\\Delta b$:\n$$ -\\frac{\\Delta b(T^2 - T_0^2)}{2RT} + \\frac{\\Delta b(T - T_0)}{R} = \\frac{\\Delta b(T-T_0)}{R}\\left(-\\frac{T+T_0}{2T} + 1\\right) = \\frac{\\Delta b(T-T_0)}{R}\\left(\\frac{-T-T_0+2T}{2T}\\right) = \\frac{\\Delta b(T-T_0)^2}{2RT} $$\nThe term with $\\Delta c$:\n$$ \\frac{\\Delta c}{RT}\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) - \\frac{\\Delta c}{2R}\\left(\\frac{1}{T^2} - \\frac{1}{T_0^2}\\right) = \\frac{\\Delta c}{R}\\left(\\frac{1}{T^2} - \\frac{1}{TT_0} - \\frac{1}{2T^2} + \\frac{1}{2T_0^2}\\right) = \\frac{\\Delta c}{R}\\left(\\frac{1}{2T^2} - \\frac{1}{TT_0} + \\frac{1}{2T_0^2}\\right) = \\frac{\\Delta c}{2R}\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 $$\nCombining all terms, the expression for $\\ln K(T)$ becomes:\n$$ \\ln K(T) = -\\frac{\\Delta_r H^\\circ(T_0)}{RT} + \\frac{\\Delta_r S^\\circ(T_0)}{R} + \\frac{\\Delta a}{R}\\left(\\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1\\right) + \\frac{\\Delta b(T-T_0)^2}{2RT} + \\frac{\\Delta c}{2R}\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 $$\n\nStep 4: Derive $K(T)$\nThe final step is to exponentiate the expression for $\\ln K(T)$ and substitute the given numerical constants.\n$$ K(T) = \\exp\\left( -\\frac{\\Delta_r H^\\circ(T_0)}{RT} + \\frac{\\Delta_r S^\\circ(T_0)}{R} + \\frac{\\Delta a}{R}\\left(\\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1\\right) + \\frac{\\Delta b(T-T_0)^2}{2RT} + \\frac{\\Delta c}{2R}\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 \\right) $$\nSubstituting the values $\\Delta_r H^\\circ(T_0) = 1.08 \\times 10^5~\\mathrm{J\\,mol^{-1}}$, $\\Delta_r S^\\circ(T_0) = 170~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $\\Delta a = -3.6$, $\\Delta b = 3.0 \\times 10^{-3}$, and $\\Delta c = 1.5 \\times 10^5$:\n$$ K(T) = \\exp\\Biggl( -\\frac{1.08 \\times 10^5}{RT} + \\frac{170}{R} + \\frac{-3.6}{R}\\left(\\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1\\right) + \\frac{3.0 \\times 10^{-3}}{2RT}(T-T_0)^2 + \\frac{1.5 \\times 10^5}{2R}\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 \\Biggr) $$\nThis expression can be rearranged by factoring out the $1/R$ term to present the final answer in a compact, single closed-form.\n$$ K(T) = \\exp\\Biggl( \\frac{1}{R} \\Biggl[ -\\frac{1.08 \\times 10^5}{T} + 170 - 3.6\\left( \\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1 \\right) + \\frac{1.5 \\times 10^{-3}}{T}(T-T_0)^2 + 7.5 \\times 10^4\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 \\Biggr] \\Biggr) $$\nThis is the final expression for the equilibrium constant as a function of $T$, $T_0$, and $R$.",
            "answer": "$$ \\boxed{\\exp\\Biggl( \\frac{1}{R} \\Biggl[ -\\frac{1.08 \\times 10^5}{T} + 170 - 3.6\\left( \\ln\\left(\\frac{T}{T_0}\\right) + \\frac{T_0}{T} - 1 \\right) + \\frac{1.5 \\times 10^{-3}}{T}(T-T_0)^2 + 7.5 \\times 10^4\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)^2 \\Biggr] \\Biggr)} $$"
        },
        {
            "introduction": "Beyond simple reactions, the principle of Gibbs free energy minimization governs the stability of mineral solutions and melts. This exercise delves into the relationship between the shape of the Gibbs free energy curve and phase stability, introducing the critical concept of spinodal decomposition . By determining the compositions where the free energy curvature, $\\frac{\\partial^2 G_m}{\\partial x^2}$, becomes negative, you will analytically predict the threshold at which a homogeneous solution becomes unstable to infinitesimal fluctuations, a fundamental process in the formation of exsolution textures in minerals.",
            "id": "4080529",
            "problem": "A binary geochemical solution of components $A$ and $B$ at constant temperature $T$ and pressure $P$ is modeled as a symmetric regular solution. The molar Gibbs free energy of the homogeneous phase is\n$$\nG_{m}(x,T) \\;=\\; x\\,G_{A}^{0}(T) \\;+\\; (1-x)\\,G_{B}^{0}(T) \\;+\\; R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\;+\\; W\\,x(1-x),\n$$\nwhere $x \\in (0,1)$ is the mole fraction of component $A$, $G_{A}^{0}(T)$ and $G_{B}^{0}(T)$ are the standard molar Gibbs energies of pure $A$ and $B$ at temperature $T$, $R$ is the universal gas constant, and $W0$ is a temperature-independent interaction parameter with units of energy per mole. Assume a macroscopically large, closed system at fixed $T$ and $P$ in which spatially homogeneous states are considered in the absence of gradient-energy penalties, so that stability against infinitesimal composition fluctuations is controlled by curvature of $G_{m}(x,T)$ with respect to $x$.\n\nUsing the fundamental principle that at fixed $T$ and $P$ the equilibrium state minimizes the Gibbs free energy and that local stability against small fluctuations requires a positive second variation of the Gibbs free energy, determine the spinodal compositions $x_{\\mathrm{sp}}^{-}(T)$ and $x_{\\mathrm{sp}}^{+}(T)$ at which the homogeneous solution first becomes unstable to infinitesimal composition fluctuations. Express your answer as a single closed-form analytic expression in terms of $T$, $R$, and $W$ for the two spinodal compositions written side-by-side in a single row. No numerical evaluation is required. State your result in terms of $T$, $R$, and $W$ only, and do not include units in your final expression. Assume $T$ is such that the spinodal exists.",
            "solution": "The problem requires the determination of the spinodal compositions, denoted as $x_{\\mathrm{sp}}^{-}(T)$ and $x_{\\mathrm{sp}}^{+}(T)$, for a symmetric regular binary solution at constant temperature $T$ and pressure $P$.\n\nThe fundamental principle for local stability of a homogeneous phase against infinitesimal composition fluctuations is that the Gibbs free energy must be a convex function of composition. Mathematically, this means the second derivative of the molar Gibbs free energy $G_m$ with respect to the mole fraction $x$ must be positive. The limit of this stability, which defines the spinodal curve, occurs where the curvature of the Gibbs free energy function is zero. Therefore, the spinodal compositions are the solutions to the equation:\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = 0\n$$\n\nThe molar Gibbs free energy for the symmetric regular solution is given as:\n$$\nG_{m}(x,T) = x\\,G_{A}^{0}(T) + (1-x)\\,G_{B}^{0}(T) + R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + W\\,x(1-x)\n$$\nwhere $x$ is the mole fraction of component $A$, $G_{A}^{0}(T)$ and $G_{B}^{0}(T)$ are the standard molar Gibbs energies of the pure components, $R$ is the universal gas constant, $T$ is the absolute temperature, and $W$ is a constant interaction parameter. For clarity in differentiation, we can write the last term as $W x - W x^2$.\n\nFirst, we compute the first derivative of $G_m$ with respect to $x$:\n$$\n\\frac{\\partial G_m}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( x\\,G_{A}^{0} + (1-x)\\,G_{B}^{0} + RT[x \\ln x + (1-x)\\ln(1-x)] + Wx - Wx^2 \\right)\n$$\nDifferentiating term-by-term yields:\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT \\left[ \\left(1 \\cdot \\ln x + x \\cdot \\frac{1}{x}\\right) + \\left(-1 \\cdot \\ln(1-x) + (1-x) \\cdot \\frac{-1}{1-x}\\right) \\right] + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT [(\\ln x + 1) - (\\ln(1-x) + 1)] + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT (\\ln x - \\ln(1-x)) + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT \\ln\\left(\\frac{x}{1-x}\\right) + W(1-2x)\n$$\n\nNext, we compute the second derivative of $G_m$ with respect to $x$:\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( G_{A}^{0} - G_{B}^{0} + RT \\ln\\left(\\frac{x}{1-x}\\right) + W(1-2x) \\right)\n$$\nThe terms $G_{A}^{0}$ and $G_{B}^{0}$ are constants with respect to $x$. Differentiating the remaining terms gives:\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\frac{\\partial}{\\partial x} \\left( \\ln x - \\ln(1-x) \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1}{x} - \\frac{-1}{1-x} \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1}{x} + \\frac{1}{1-x} \\right) - 2W\n$$\nCombining the terms in the parenthesis:\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1-x+x}{x(1-x)} \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = \\frac{RT}{x(1-x)} - 2W\n$$\nThe spinodal compositions are found by setting this expression to zero:\n$$\n\\frac{RT}{x(1-x)} - 2W = 0\n$$\n$$\n\\frac{RT}{x(1-x)} = 2W\n$$\n$$\nRT = 2W x(1-x)\n$$\nExpanding and rearranging this equation gives a quadratic equation in $x$:\n$$\nRT = 2Wx - 2Wx^2\n$$\n$$\n2Wx^2 - 2Wx + RT = 0\n$$\nWe solve for $x$ using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a = 2W$, $b = -2W$, and $c = RT$.\n$$\nx_{\\mathrm{sp}} = \\frac{-(-2W) \\pm \\sqrt{(-2W)^2 - 4(2W)(RT)}}{2(2W)}\n$$\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm \\sqrt{4W^2 - 8WRT}}{4W}\n$$\nWe can simplify the term under the square root by factoring out $4W^2$:\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm \\sqrt{4W^2 \\left(1 - \\frac{8WRT}{4W^2}\\right)}}{4W}\n$$\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm 2W \\sqrt{1 - \\frac{2RT}{W}}}{4W}\n$$\nDividing the numerator and denominator by $2W$ gives the final expressions for the two spinodal compositions:\n$$\nx_{\\mathrm{sp}} = \\frac{1}{2} \\pm \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$\nThese two compositions, $x_{\\mathrm{sp}}^{-}$ and $x_{\\mathrm{sp}}^{+}$, define the boundary of the spinodal region. As requested, they are expressed solely in terms of $T$, $R$, and $W$. The problem assumes that the temperature $T$ is such that the spinodal exists, which means the argument of the square root is non-negative, i.e., $1 - \\frac{2RT}{W} \\geq 0$, or $T \\leq \\frac{W}{2R}$.\n\nThe two spinodal compositions are:\n$$\nx_{\\mathrm{sp}}^{-} = \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$\n$$\nx_{\\mathrm{sp}}^{+} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}  \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This practice transitions from analytical theory to the computational core of geochemical modeling, where complex systems of reactions are solved numerically. You will implement the Newton-Raphson method, a powerful iterative algorithm, to find the equilibrium state of a system governed by mass-action principles . By deriving the Jacobian matrix and coding the solver, you will gain direct insight into how equilibrium speciation is calculated and appreciate the numerical strategies required to ensure robust convergence.",
            "id": "4080479",
            "problem": "Consider an isothermal and isobaric ideal aqueous system in computational geochemistry composed of two basis components with activities $a_{\\mathrm{A}}$ and $a_{\\mathrm{B}}$ and three complexes with activities $a_{\\mathrm{AB}}$, $a_{\\mathrm{A_2B}}$, and $a_{\\mathrm{AB_2}}$. Assume ideal mixing so that the chemical potential of any species $i$ is $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, with $R$ the universal gas constant and $T$ the temperature, and that standard-state reaction free energies determine equilibrium constants $K$ that relate complex activities to basis activities. Under Gibbs free energy minimization at fixed temperature and pressure, stationarity with respect to the formation of each complex implies mass-action relations linking activities of complexes to those of the basis components. Let the total activities (proportional to total molalities under ideality) of the basis components be $T_{\\mathrm{A}}$ and $T_{\\mathrm{B}}$, and suppose the following stoichiometry for the complexes: $\\mathrm{AB}$ has stoichiometry $\\nu_{\\mathrm{A}}=1$, $\\nu_{\\mathrm{B}}=1$; $\\mathrm{A_2B}$ has $\\nu_{\\mathrm{A}}=2$, $\\nu_{\\mathrm{B}}=1$; and $\\mathrm{AB_2}$ has $\\nu_{\\mathrm{A}}=1$, $\\nu_{\\mathrm{B}}=2$. With equilibrium constants $K_{\\mathrm{AB}}$, $K_{\\mathrm{A_2B}}$, $K_{\\mathrm{AB_2}}$ (dimensionless, defined at the given $T$ and $P$), and ideality, the complex activities satisfy $a_{\\mathrm{AB}} = K_{\\mathrm{AB}} a_{\\mathrm{A}} a_{\\mathrm{B}}$, $a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} a_{\\mathrm{A}}^2 a_{\\mathrm{B}}$, and $a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} a_{\\mathrm{A}} a_{\\mathrm{B}}^2$. The mass-balance equations then enforce conservation of the basis components:\n$$\nF_1(a_{\\mathrm{A}}, a_{\\mathrm{B}}) \\equiv a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 2 a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}} - T_{\\mathrm{A}} = 0,\n$$\n$$\nF_2(a_{\\mathrm{A}}, a_{\\mathrm{B}}) \\equiv a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 2 a_{\\mathrm{AB_2}} - T_{\\mathrm{B}} = 0.\n$$\nStarting from these fundamental definitions and constraints, set up a Newton–Raphson (NR) method (define acronym on first use) using logarithmic variables $u_{\\mathrm{A}} = \\ln a_{\\mathrm{A}}$ and $u_{\\mathrm{B}} = \\ln a_{\\mathrm{B}}$ to ensure positivity. Derive the corresponding Jacobian matrix entries from first principles, and implement an algorithm that, for given parameters, computes the equilibrium activities of all five species $[a_{\\mathrm{A}}, a_{\\mathrm{B}}, a_{\\mathrm{AB}}, a_{\\mathrm{A_2B}}, a_{\\mathrm{AB_2}}]$. Discuss the role of the Jacobian in convergence within your solution narrative.\n\nYour program must implement the NR iteration for the system above and produce results for the following test suite of parameter values, each specified as a tuple $(T_{\\mathrm{A}}, T_{\\mathrm{B}}, K_{\\mathrm{AB}}, K_{\\mathrm{A_2B}}, K_{\\mathrm{AB_2}})$:\n\n- Case $1$ (moderate complexation, balanced totals): $(T_{\\mathrm{A}}, T_{\\mathrm{B}}, K_{\\mathrm{AB}}, K_{\\mathrm{A_2B}}, K_{\\mathrm{AB_2}}) = (\\,1.0,\\,1.0,\\,10^3,\\,10^2,\\,5 \\cdot 10^1\\,)$.\n- Case $2$ (strongly favored $\\mathrm{A_2B}$ formation): $(\\,1.0,\\,0.5,\\,10^3,\\,10^{12},\\,10^1\\,)$.\n- Case $3$ (weak complexation and very small totals): $(\\,10^{-6},\\,10^{-6},\\,10^{-3},\\,10^{-6},\\,10^{-6}\\,)$.\n- Case $4$ (stoichiometric imbalance with strong $\\mathrm{AB_2}$ formation): $(\\,10^{-1},\\,10^{1},\\,10^2,\\,10^{-4},\\,10^8\\,)$.\n- Case $5$ (nearly singular, all complexes strongly favored): $(\\,1.0,\\,1.0,\\,10^{10},\\,10^{10},\\,10^{10}\\,)$.\n\nScientific realism constraints:\n- Treat all activities as dimensionless numbers consistent with ideal solution behavior.\n- Use absolute tolerances and safeguards to ensure numerical stability in stiff regimes.\n\nAngle units do not apply. No physical units are required because all quantities are dimensionless; report numerical outputs as floating-point numbers.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a comma-separated list of the five equilibrium activities in the order $[a_{\\mathrm{A}}, a_{\\mathrm{B}}, a_{\\mathrm{AB}}, a_{\\mathrm{A_2B}}, a_{\\mathrm{AB_2}}]$, enclosed in square brackets. For example, the overall output format is\n$$\n[\\,[x_1,x_2,x_3,x_4,x_5],\\,[y_1,y_2,y_3,y_4,y_5],\\,\\ldots\\,],\n$$\nwith no spaces anywhere in the string.\n\nThe expected outputs are lists of floating-point numbers. The NR iteration must terminate when a norm of the residual vector $[F_1, F_2]$ is below a small tolerance or a maximum number of iterations is reached, employing a line search or damping if needed to maintain convergence. The Jacobian matrix must be explicitly formed and used at each iteration.",
            "solution": "The problem requires the solution of a system of non-linear equations describing chemical equilibrium in an aqueous geochemical system. The solution is to be found using the Newton-Raphson (NR) iterative method. The problem is well-posed and scientifically grounded in the principles of mass-action and mass-balance, which arise from the minimization of Gibbs free energy at constant temperature and pressure.\n\nThe system consists of two basis components, A and B, and three complex species, AB, A$_2$B, and AB$_2$. The state of the system is defined by the activities of the five species: $a_{\\mathrm{A}}$, $a_{\\mathrm{B}}$, $a_{\\mathrm{AB}}$, $a_{\\mathrm{A_2B}}$, and $a_{\\mathrm{AB_2}}$. These activities are related by three mass-action laws derived from chemical equilibrium:\n$$a_{\\mathrm{AB}} = K_{\\mathrm{AB}} a_{\\mathrm{A}} a_{\\mathrm{B}}$$\n$$a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} a_{\\mathrm{A}}^2 a_{\\mathrm{B}}$$\n$$a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} a_{\\mathrm{A}} a_{\\mathrm{B}}^2$$\nwhere $K_{\\mathrm{AB}}$, $K_{\\mathrm{A_2B}}$, and $K_{\\mathrm{AB_2}}$ are the given dimensionless equilibrium constants.\n\nThe system is closed with respect to the basis components, with total activities $T_{\\mathrm{A}}$ and $T_{\\mathrm{B}}$. Conservation of these components is expressed by two mass-balance equations:\n$$F_1(a_{\\mathrm{A}}, a_{\\mathrm{B}}) = a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 2 a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}} - T_{\\mathrm{A}} = 0$$\n$$F_2(a_{\\mathrm{A}}, a_{\\mathrm{B}}) = a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 2 a_{\\mathrm{AB_2}} - T_{\\mathrm{B}} = 0$$\nThe coefficients in these sums ($\\nu_{\\mathrm{A},i}$ in $F_1$, $\\nu_{\\mathrm{B},i}$ in $F_2$) are the stoichiometric coefficients of the basis components A and B in each species $i$.\n\nThe core task is to solve this system of two non-linear equations for the two unknown basis activities, $a_{\\mathrm{A}}$ and $a_{\\mathrm{B}}$. To ensure that the activities remain positive throughout the iterative solution process, and to handle the wide dynamic range of activity values, we use a change of variables to logarithms:\n$$u_{\\mathrm{A}} = \\ln a_{\\mathrm{A}} \\implies a_{\\mathrm{A}} = e^{u_{\\mathrm{A}}}$$\n$$u_{\\mathrm{B}} = \\ln a_{\\mathrm{B}} \\implies a_{\\mathrm{B}} = e^{u_{\\mathrm{B}}}$$\nThe vector of unknown variables for the NR method is thus $\\mathbf{u} = [u_{\\mathrm{A}}, u_{\\mathrm{B}}]^T$.\n\nWe must rewrite the mass-balance equations in terms of $u_{\\mathrm{A}}$ and $u_{\\mathrm{B}}$. First, the complex activities become:\n$$a_{\\mathrm{AB}} = K_{\\mathrm{AB}} e^{u_{\\mathrm{A}}} e^{u_{\\mathrm{B}}} = K_{\\mathrm{AB}} e^{u_{\\mathrm{A}} + u_{\\mathrm{B}}}$$\n$$a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} (e^{u_{\\mathrm{A}}})^2 e^{u_{\\mathrm{B}}} = K_{\\mathrm{A_2B}} e^{2u_{\\mathrm{A}} + u_{\\mathrm{B}}}$$\n$$a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} e^{u_{\\mathrm{A}}} (e^{u_{\\mathrm{B}}})^2 = K_{\\mathrm{AB_2}} e^{u_{\\mathrm{A}} + 2u_{\\mathrm{B}}}$$\nSubstituting these into the mass-balance equations yields the residual vector function $\\mathbf{F}(\\mathbf{u}) = [F_1(\\mathbf{u}), F_2(\\mathbf{u})]^T$:\n$$F_1(\\mathbf{u}) = e^{u_{\\mathrm{A}}} + K_{\\mathrm{AB}}e^{u_{\\mathrm{A}}+u_{\\mathrm{B}}} + 2K_{\\mathrm{A_2B}}e^{2u_{\\mathrm{A}}+u_{\\mathrm{B}}} + K_{\\mathrm{AB_2}}e^{u_{\\mathrm{A}}+2u_{\\mathrm{B}}} - T_{\\mathrm{A}} = 0$$\n$$F_2(\\mathbf{u}) = e^{u_{\\mathrm{B}}} + K_{\\mathrm{AB}}e^{u_{\\mathrm{A}}+u_{\\mathrm{B}}} + K_{\\mathrm{A_2B}}e^{2u_{\\mathrm{A}}+u_{\\mathrm{B}}} + 2K_{\\mathrm{AB_2}}e^{u_{\\mathrm{A}}+2u_{\\mathrm{B}}} - T_{\\mathrm{B}} = 0$$\n\nThe Newton-Raphson method finds the root of $\\mathbf{F}(\\mathbf{u}) = \\mathbf{0}$ by iterating from an initial guess $\\mathbf{u}_0$. Each iteration $k$ updates the solution via $\\mathbf{u}_{k+1} = \\mathbf{u}_k + \\Delta\\mathbf{u}_k$, where the step $\\Delta\\mathbf{u}_k$ is found by solving the linear system:\n$$J(\\mathbf{u}_k) \\Delta\\mathbf{u}_k = -\\mathbf{F}(\\mathbf{u}_k)$$\nHere, $J$ is the Jacobian matrix of $\\mathbf{F}$ with respect to $\\mathbf{u}$, with entries $J_{ij} = \\frac{\\partial F_i}{\\partial u_j}$. We derive these entries from first principles.\n\nThe partial derivative of a species activity $a_k = K_k \\exp(\\sum_j \\nu_{jk} u_j)$ with respect to a log-activity $u_m$ is $\\frac{\\partial a_k}{\\partial u_m} = a_k \\cdot \\nu_{mk}$. Using this rule:\n$J_{11} = \\frac{\\partial F_1}{\\partial u_{\\mathrm{A}}} = \\frac{\\partial a_{\\mathrm{A}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{A}}} + 2\\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{A}}} = 1 \\cdot a_{\\mathrm{A}} + 1 \\cdot a_{\\mathrm{AB}} + 2(2 \\cdot a_{\\mathrm{A_2B}}) + 1 \\cdot a_{\\mathrm{AB_2}}$\n$$J_{11} = a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 4a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}}$$\n$J_{12} = \\frac{\\partial F_1}{\\partial u_{\\mathrm{B}}} = \\frac{\\partial a_{\\mathrm{A}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{B}}} + 2\\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{B}}} = 0 + 1 \\cdot a_{\\mathrm{AB}} + 2(1 \\cdot a_{\\mathrm{A_2B}}) + 1(2 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{12} = a_{\\mathrm{AB}} + 2a_{\\mathrm{A_2B}} + 2a_{\\mathrm{AB_2}}$$\n$J_{21} = \\frac{\\partial F_2}{\\partial u_{\\mathrm{A}}} = \\frac{\\partial a_{\\mathrm{B}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{A}}} + 2\\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{A}}} = 0 + 1 \\cdot a_{\\mathrm{AB}} + 1(2 \\cdot a_{\\mathrm{A_2B}}) + 2(1 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{21} = a_{\\mathrm{AB}} + 2a_{\\mathrm{A_2B}} + 2a_{\\mathrm{AB_2}}$$\n$J_{22} = \\frac{\\partial F_2}{\\partial u_{\\mathrm{B}}} = \\frac{\\partial a_{\\mathrm{B}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{B}}} + 2\\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{B}}} = 1 \\cdot a_{\\mathrm{B}} + 1 \\cdot a_{\\mathrm{AB}} + 1 \\cdot a_{\\mathrm{A2B}} + 2(2 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{22} = a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 4a_{\\mathrm{AB_2}}$$\nThe Jacobian is symmetric ($J_{12} = J_{21}$), a property stemming from the fact that the underlying equations derive from a scalar thermodynamic potential (Gibbs free energy).\n\nThe Jacobian matrix is central to the NR method's convergence properties. It provides a linear model of the system's behavior near the current iterate $\\mathbf{u}_k$. When the initial guess is close to the true solution and the Jacobian is well-conditioned (invertible and not close to singular), the method converges quadratically, which is extremely fast. However, if the Jacobian becomes singular or nearly singular (ill-conditioned), its inverse is undefined or numerically unstable, causing the calculated step $\\Delta\\mathbf{u}_k$ to be enormous and unreliable. This leads to divergence or erratic oscillations. Such ill-conditioning can occur in chemically extreme systems, for instance, when certain reactions go to near completion, locking the basis components into fixed stoichiometric ratios and creating linear dependencies in the mass-balance equations. Case 5, with very large equilibrium constants for all complexes, is designed to be nearly singular.\n\nTo ensure robust convergence even with poor initial guesses or in ill-conditioned regimes, a simple damping or line search strategy is implemented. The update step is modified to $\\mathbf{u}_{k+1} = \\mathbf{u}_k + \\alpha \\Delta\\mathbf{u}_k$, where the step-length $\\alpha \\in (0, 1]$ is reduced from its initial value of $1$ until the update leads to a decrease in the norm of the residual vector, $||\\mathbf{F}(\\mathbf{u}_{k+1})||  ||\\mathbf{F}(\\mathbf{u}_k)||$. This safeguard prevents the algorithm from taking excessively large, non-physical steps away from the solution.\n\nThe algorithm proceeds as follows:\n1.  Initialize $\\mathbf{u}_0 = [\\ln T_{\\mathrm{A}}, \\ln T_{\\mathrm{B}}]$.\n2.  For each iteration, calculate activities, the residual vector $\\mathbf{F}$, and the Jacobian matrix $J$.\n3.  Check if $||\\mathbf{F}||$ is below a specified tolerance. If so, the solution is found.\n4.  Solve the linear system $J \\Delta\\mathbf{u} = -\\mathbf{F}$ for the Newton step $\\Delta\\mathbf{u}$.\n5.  Perform a line search to find a suitable damping factor $\\alpha$ to ensure the residual norm decreases.\n6.  Update the solution vector: $\\mathbf{u} \\leftarrow \\mathbf{u} + \\alpha \\Delta\\mathbf{u}$.\n7.  Repeat until convergence or a maximum number of iterations is reached.\nUpon convergence to a final vector $\\mathbf{u}^* = [u_{\\mathrm{A}}^*, u_{\\mathrm{B}}^*]$, the equilibrium activities of all five species are computed and reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_geochem_system(T_A, T_B, K_AB, K_A2B, K_AB2):\n    \"\"\"\n    Solves the geochemical equilibrium system using the Newton-Raphson method\n    with logarithmic variables and a backtracking line search.\n\n    Args:\n        T_A (float): Total activity of component A.\n        T_B (float): Total activity of component B.\n        K_AB (float): Equilibrium constant for complex AB.\n        K_A2B (float): Equilibrium constant for complex A2B.\n        K_AB2 (float): Equilibrium constant for complex AB2.\n\n    Returns:\n        list: A list of the five equilibrium activities\n              [a_A, a_B, a_AB, a_A2B, a_AB2].\n    \"\"\"\n    # NR algorithm parameters\n    max_iter = 100\n    tolerance = 1e-12\n\n    # Initial guess for u = [ln(a_A), ln(a_B)]\n    # A small positive constant is added to avoid log(0) if totals are zero,\n    # though given test cases have positive totals.\n    u = np.array([np.log(T_A + 1e-20), np.log(T_B + 1e-20)], dtype=np.float64)\n\n    for _ in range(max_iter):\n        # 1. Calculate activities from the current u\n        a_A = np.exp(u[0])\n        a_B = np.exp(u[1])\n\n        # Calculate complex activities using mass-action laws\n        a_AB = K_AB * a_A * a_B\n        a_A2B = K_A2B * (a_A ** 2) * a_B\n        a_AB2 = K_AB2 * a_A * (a_B ** 2)\n\n        # 2. Calculate the residual vector F based on mass-balance\n        F1 = a_A + a_AB + 2 * a_A2B + a_AB2 - T_A\n        F2 = a_B + a_AB + a_A2B + 2 * a_AB2 - T_B\n        F = np.array([F1, F2])\n\n        # 3. Check for convergence by the norm of the residual\n        norm_F = np.linalg.norm(F)\n        if norm_F  tolerance:\n            break\n\n        # 4. Calculate the Jacobian matrix J\n        J11 = a_A + a_AB + 4 * a_A2B + a_AB2\n        J12 = a_AB + 2 * a_A2B + 2 * a_AB2  # J21 is identical\n        J22 = a_B + a_AB + a_A2B + 4 * a_AB2\n        J = np.array([[J11, J12], [J12, J22]])\n\n        # 5. Solve the linear system J * delta_u = -F for the step delta_u\n        try:\n            delta_u = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            # Jacobian is singular, indicating severe numerical issues.\n            # The line search might handle large steps, but convergence\n            # is unlikely. Terminate for this case.\n            # Using NaN to signal failure to converge.\n            return [np.nan] * 5\n\n        # 6. Damped update (Backtracking Line Search) to ensure global convergence\n        alpha = 1.0\n        while alpha > 1e-8:\n            u_new = u + alpha * delta_u\n            \n            # Recalculate F for the new proposed u\n            a_A_new = np.exp(u_new[0])\n            a_B_new = np.exp(u_new[1])\n            a_AB_new = K_AB * a_A_new * a_B_new\n            a_A2B_new = K_A2B * (a_A_new ** 2) * a_B_new\n            a_AB2_new = K_AB2 * a_A_new * (a_B_new ** 2)\n            \n            F1_new = a_A_new + a_AB_new + 2 * a_A2B_new + a_AB2_new - T_A\n            F2_new = a_B_new + a_AB_new + a_A2B_new + 2 * a_AB2_new - T_B\n\n            # If the new residual norm is smaller, accept the step\n            if np.linalg.norm(np.array([F1_new, F2_new]))  norm_F:\n                u = u_new\n                break\n            \n            alpha /= 2.0\n        \n        # If the line search fails to find a better step, terminate\n        if alpha = 1e-8:\n            break\n\n    # After loop (converged or max_iter/line search failed), compute final activities\n    final_a_A = np.exp(u[0])\n    final_a_B = np.exp(u[1])\n    final_a_AB = K_AB * final_a_A * final_a_B\n    final_a_A2B = K_A2B * (final_a_A ** 2) * final_a_B\n    final_a_AB2 = K_AB2 * final_a_A * (final_a_B ** 2)\n    \n    return [final_a_A, final_a_B, final_a_AB, final_a_A2B, final_a_AB2]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_A, T_B, K_AB, K_A2B, K_AB2)\n        (1.0, 1.0, 1.0e3, 1.0e2, 5.0e1),\n        (1.0, 0.5, 1.0e3, 1.0e12, 1.0e1),\n        (1.0e-6, 1.0e-6, 1.0e-3, 1.0e-6, 1.0e-6),\n        (1.0e-1, 10.0, 1.0e2, 1.0e-4, 1.0e8),\n        (1.0, 1.0, 1.0e10, 1.0e10, 1.0e10)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        T_A, T_B, K_AB, K_A2B, K_AB2 = case\n        result_list = solve_geochem_system(T_A, T_B, K_AB, K_A2B, K_AB2)\n        all_results.append(result_list)\n\n    # Format the final output string exactly as specified:\n    # e.g., [[r1_1,...,r1_5],[r2_1,...,r2_5],...] with no spaces.\n    inner_strings = [f\"[{','.join(map(str, sublist))}]\" for sublist in all_results]\n    final_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_string)\n\nsolve()\n```"
        }
    ]
}