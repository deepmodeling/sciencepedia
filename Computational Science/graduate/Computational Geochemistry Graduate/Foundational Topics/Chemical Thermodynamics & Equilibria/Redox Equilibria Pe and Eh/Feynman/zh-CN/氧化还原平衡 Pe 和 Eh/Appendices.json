{
    "hands_on_practices": [
        {
            "introduction": "确定体系氧化还原状态最直接的方法之一是测量其中一个主导氧化还原电对的物种浓度。本练习将指导您完成从实验数据计算 $Eh$ 的基本过程，包括使用戴维斯方程进行必要的活度校正。这个实践是连接经验数据和热力学电位的桥梁。",
            "id": "4098238",
            "problem": "在酸性硫酸盐介质中，水相氧化还原形态受守恒关系和电化学平衡控制。考虑一个在 $25\\,^\\circ\\text{C}$ 下的溶液，其离子强度 $I=0.10$（由一种惰性支持电解质维持）。该溶液含有以 $\\text{Fe}^{2+}$ 和 $\\text{Fe}^{3+}$ 形式存在的铁，以及以硫酸盐物种 $\\text{HSO}_4^-$ 和 $\\text{SO}_4^{2-}$ 形式存在的硫，并由氢离子 $\\text{H}^+$ 提供酸度。总质量摩尔浓度分别为 $m_{\\text{Fe,T}}=1.000\\times 10^{-3}$、$m_{\\text{S,T}}=1.000\\times 10^{-2}$ 和 $m_{\\text{H,T}}=1.000\\times 10^{-1}$。测得的铁氧化还原电对的质量摩尔浓度为 $m_{\\text{Fe}^{2+}}=6.000\\times 10^{-4}$ 和 $m_{\\text{Fe}^{3+}}=4.000\\times 10^{-4}$。假设在这些条件下铁不与硫酸盐形成配合物，并且在给定酸度下铁的水解可以忽略不计；硫仅以 $\\text{HSO}_4^-$ 和 $\\text{SO}_4^{2-}$ 的形式存在，其平衡受硫酸的二级电离控制，热力学平衡常数 $K_{a2}=1.02\\times 10^{-2}$，该常数定义在质量摩尔浓度标度上，以单位质量摩尔浓度为标准态。在 $25\\,^\\circ\\text{C}$ 时，氧化还原电对 $\\text{Fe}^{3+}/\\text{Fe}^{2+}$ 的标准电极电势 $E^\\circ=0.771\\,\\text{V}$（相对于标准氢电极）。所有离子的活度系数均使用 Davies 方程进行估算，其中 $25\\,^\\circ\\text{C}$ 时的 Debye–Hückel 常数 $A=0.509$。\n\n任务：\n1. 从物料守恒、电荷守恒和电子等价物守恒出发，写出总铁和总硫的质量平衡方程、溶液的电荷平衡方程，以及一个适用于 $\\text{Fe}^{3+}/\\text{Fe}^{2+}$ 半反应的、用活度和电子活度表示的电子平衡表达式。\n2. 利用所述的热力学框架和提供的数据，根据观测到的铁活度计算溶液的氧化还原电势 $Eh$。使用 Davies 方程在离子强度 $I=0.10$ 时求得 $\\text{Fe}^{2+}$ 和 $\\text{Fe}^{3+}$ 的活度系数，由质量摩尔浓度和活度系数构建活度，然后应用 $25\\,^\\circ\\text{C}$ 下的相应电化学平衡关系。将最终数值结果四舍五入至四位有效数字，并以伏特为单位表示 $Eh$。",
            "solution": "该问题经验证是自洽的、有科学依据且良定的。所有必要数据均已提供，所需任务可利用地球化学和电化学的标准原​​理完成。\n\n### 任务1：守恒与平衡方程\n\n该系统由一系列守恒和平衡关系描述。\n\n**质量平衡方程**\n\n总铁（$m_{\\text{Fe,T}}$）的守恒表示为所有含铁物种的质量摩尔浓度之和。鉴于铁仅以 $\\text{Fe}^{2+}$ 和 $\\text{Fe}^{3+}$ 的形式存在，铁的质量平衡方程为：\n$$m_{\\text{Fe,T}} = m_{\\text{Fe}^{2+}} + m_{\\text{Fe}^{3+}}$$\n使用所提供的数据，我们可以验证这一点：$1.000 \\times 10^{-3} = 6.000 \\times 10^{-4} + 4.000 \\times 10^{-4}$。\n\n同样，总硫（$m_{\\text{S,T}}$）的守恒是硫酸氢根（$\\text{HSO}_4^-$）和硫酸根（$\\text{SO}_4^{2-}$）的质量摩尔浓度之和：\n$$m_{\\text{S,T}} = m_{\\text{HSO}_4^{-}} + m_{\\text{SO}_4^{2-}}$$\n\n**电荷平衡方程**\n\n电中性原理要求总正电荷浓度等于总负电荷浓度。对电荷有贡献的主要物种是 $\\text{H}^+$、$\\text{Fe}^{2+}$、$\\text{Fe}^{3+}$、$\\text{HSO}_4^-$ 和 $\\text{SO}_4^{2-}$。此外，溶液中存在惰性支持电解质以维持离子强度，其贡献的离子必须包含在内才能实现完全的电荷平衡。设惰性电解质的电荷贡献总和用 $\\sum z_j m_j$ 表示，则电荷平衡方程为：\n$$m_{\\text{H}^+} + 2m_{\\text{Fe}^{2+}} + 3m_{\\text{Fe}^{3+}} = m_{\\text{HSO}_4^{-}} + 2m_{\\text{SO}_4^{2-}} - \\sum z_j m_j$$\n这可以重写为：\n$$\\sum z_i m_i = m_{\\text{H}^+} + 2m_{\\text{Fe}^{2+}} + 3m_{\\text{Fe}^{3+}} - m_{\\text{HSO}_4^{-}} - 2m_{\\text{SO}_4^{2-}} + \\sum z_j m_j = 0$$\n其中最后的求和项是针对来自支持电解质的所有离子。\n\n**电子平衡表达式**\n\n系统的氧化还原状态由 $\\text{Fe}^{3+}/\\text{Fe}^{2+}$ 半反应的平衡所决定：\n$$\\mathrm{Fe^{3+}} + e^- \\rightleftharpoons \\mathrm{Fe^{2+}}$$\n该反应的质量作用定律给出了平衡表达式。题目要求用活度（$a_i$）和电子活度（$a_{e^-}$）来表示这个表达式。平衡常数 $K_{\\mathrm{redox}}$ 由下式给出：\n$$K_{\\mathrm{redox}} = \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}} a_{e^-}}$$\n该方程式代表了在平衡状态下指定氧化还原电对的电子平衡。\n\n### 任务2：氧化还原电势（$Eh$）的计算\n\n氧化还原电势 $Eh$ 使用 Nernst 方程计算 $\\text{Fe}^{3+}/\\text{Fe}^{2+}$ 电对。离子 $i$ 的活度 $a_i$ 是其质量摩尔浓度 $m_i$ 与其活度系数 $\\gamma_i$ 的乘积：$a_i = \\gamma_i m_i$。\n\n**步骤1：计算活度系数**\n\n活度系数使用 Davies 方程进行估算：\n$$\\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$$\n给定值为 Debye–Hückel 常数 $A=0.509$ 和离子强度 $I=0.10$。\n首先，我们计算与离子强度相关的项：\n$$\\frac{\\sqrt{0.10}}{1+\\sqrt{0.10}} - 0.3(0.10) = \\frac{0.316228}{1+0.316228} - 0.03 = 0.24025 - 0.03 = 0.21025$$\n现在，我们计算 $\\text{Fe}^{2+}$（电荷 $z=2$）的活度系数：\n$$\\log_{10}(\\gamma_{\\mathrm{Fe^{2+}}}) = -0.509 \\times (2)^2 \\times (0.21025) = -0.509 \\times 4 \\times 0.21025 = -0.42807$$\n$$\\gamma_{\\mathrm{Fe^{2+}}} = 10^{-0.42807} = 0.37319$$\n接下来，计算 $\\text{Fe}^{3+}$（电荷 $z=3$）的活度系数：\n$$\\log_{10}(\\gamma_{\\mathrm{Fe^{3+}}}) = -0.509 \\times (3)^2 \\times (0.21025) = -0.509 \\times 9 \\times 0.21025 = -0.96316$$\n$$\\gamma_{\\mathrm{Fe^{3+}}} = 10^{-0.96316} = 0.10885$$\n\n**步骤2：计算活度**\n\n使用给定的质量摩尔浓度和计算出的活度系数：\n$$a_{\\mathrm{Fe^{2+}}} = \\gamma_{\\mathrm{Fe^{2+}}} \\times m_{\\mathrm{Fe^{2+}}} = 0.37319 \\times (6.000 \\times 10^{-4}) = 2.2391 \\times 10^{-4}$$\n$$a_{\\mathrm{Fe^{3+}}} = \\gamma_{\\mathrm{Fe^{3+}}} \\times m_{\\mathrm{Fe^{3+}}} = 0.10885 \\times (4.000 \\times 10^{-4}) = 4.3540 \\times 10^{-5}$$\n\n**步骤3：使用 Nernst 方程计算 $Eh$**\n\nNernst 方程将氧化还原电势 $Eh$ 与标准电极电势 $E^\\circ$ 以及氧化还原物种的活度联系起来。对于半反应 $\\mathrm{Fe^{3+}} + e^- \\rightleftharpoons \\mathrm{Fe^{2+}}$，转移的电子数 $n=1$：\n$$Eh = E^\\circ + \\frac{2.303RT}{nF} \\log_{10}\\left(\\frac{a_{\\mathrm{Fe^{3+}}}}{a_{\\mathrm{Fe^{2+}}}}\\right)$$\n在 $T=25\\,^\\circ\\text{C}$（$298.15\\,\\text{K}$）时，项 $\\frac{2.303RT}{F}$ 等于 $0.05916\\,\\text{V}$。给定的标准电势为 $E^\\circ=0.771\\,\\text{V}$。\n代入数值：\n$$Eh = 0.771 + \\frac{0.05916}{1} \\log_{10}\\left(\\frac{4.3540 \\times 10^{-5}}{2.2391 \\times 10^{-4}}\\right)$$\n$$Eh = 0.771 + 0.05916 \\log_{10}(0.19445)$$\n$$Eh = 0.771 + 0.05916 \\times (-0.71126)$$\n$$Eh = 0.771 - 0.042079$$\n$$Eh = 0.728921\\,\\mathrm{V}$$\n按要求四舍五入到四位有效数字，我们得到：\n$$Eh = 0.7289\\,\\mathrm{V}$$",
            "answer": "$$\\boxed{0.7289}$$"
        },
        {
            "introduction": "在计算地球化学模型中，我们通常需要设定氧化还原条件，而非直接测量。本练习旨在探讨两种常见的设定方法：直接固定 $pe$ 值，或通过指定一个主导电对（如 $\\mathrm{O_2}/\\mathrm{H_2O}$）的浓度来间接定义。通过比较这两种方法的结果，您将理解它们在何种假设下是等效的，以及内部平衡假设的重要性。",
            "id": "4098225",
            "problem": "您需要实现一个计算比较，在一个恒温水体系中比较两种氧化还原状态指定策略。目标是展示在何种情况下通过 $pe$ 固定电子活度等同于指定一个主导氧化还原电对的浓度，以及在何种情况下会出现差异。这项工作必须从热力学平衡的定义、能斯特方程、电子活度和氧化还原电位的定义出发，并推导出一个可复现的算法。\n\n使用的定义与常数：\n- 电子活度定义为 $pe \\equiv -\\log_{10}(a_{e^-})$，其中 $a_{e^-}$ 是电子的活度。\n- 氧化还原电位（相对于标准氢电极）$Eh$ 与 $pe$ 的关系为 $Eh = \\dfrac{2.303\\,R\\,T}{F}\\,pe$。其中 $R$ 是通用气体常数，$F$ 是法拉第常数，$T$ 是绝对温度。\n- 温度固定为 $T = 298.15\\,\\mathrm{K}$。\n- 使用 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。\n- 在本问题中，将水溶液中物种的活度视为浓度，即 $a_i \\approx [i]$（单位为 $\\mathrm{mol\\,L^{-1}}$），并将液态水的活度视为 $a_{\\mathrm{H_2O}} \\approx 1$。\n- 对于气相氧气，将其活度近似为其逸度，逸度等于分压 $p_{\\mathrm{O_2}}$（单位为 $\\mathrm{atm}$），参考标准态 $1\\,\\mathrm{atm}$，即 $a_{\\mathrm{O_2}} \\approx p_{\\mathrm{O_2}}$。\n- 考虑铁电对 $\\text{Fe}^{3+}/\\text{Fe}^{2+}$ 和氧电对 $\\text{O}_2/\\text{H}_2\\text{O}$，在 $T=298.15\\,\\mathrm{K}$ 时的标准还原电位分别为：$E^\\circ_{\\mathrm{Fe^{3+}/Fe^{2+}}} = 0.771\\,\\mathrm{V}$ 和 $E^\\circ_{\\mathrm{O_2}/\\mathrm{H_2O}} = 1.229\\,\\mathrm{V}$。\n\n推导起点：\n- 对于一个涉及 $n$ 个电子的氧化还原半反应，使用标准吉布斯自由能变与平衡常数之间的热力学关系式 $\\Delta G^\\circ = -n F E^\\circ$ 和 $K = \\exp\\!\\left(-\\dfrac{\\Delta G^\\circ}{R T}\\right)$，并结合平衡时活度的质量作用表达式以及 $pe$ 的定义。\n\n系统描述与任务：\n- 考虑一个仅含有 $\\text{Fe}^{3+}$ 和 $\\text{Fe}^{2+}$ 形式铁的水溶液（忽略水解、络合和沉淀），该溶液在指定的 $pH$ 值下被缓冲。\n- 方法 A（“固定 $pe$”）：施加一个固定的 $pe$ 值，并根据铁的氧化还原平衡计算平衡比率 $[\\text{Fe}^{2+}]/[\\text{Fe}^{3+}]$。根据此比率和给定的总铁浓度 $C_{\\text{Fe,tot}}$（单位为 $\\mathrm{mol\\,L^{-1}}$），在简化假设 $C_{\\text{Fe,tot}} = [\\text{Fe}^{2+}] + [\\text{Fe}^{3+}]$ 下，计算亚铁离子的分数 $f_{\\text{Fe}^{2+}} = \\dfrac{[\\text{Fe}^{2+}]}{C_{\\text{Fe,tot}}}$。\n- 方法 B（“指定氧化还原电对浓度”）：不直接固定 $pe$；而是指定 $p_{\\mathrm{O_2}}$ 和 $pH$，通过强制执行氧的氧化还原平衡来计算隐含的 $pe$ 值。使用这个 $pe$ 值来计算铁的形态分布，方法同方法 A。\n- 对于每个测试用例，计算绝对差值 $\\Delta f = \\left| f_{\\mathrm{Fe^{2+}}}^{(A)} - f_{\\mathrm{Fe^{2+}}}^{(B)} \\right|$，以展示两种指定策略之间的等效性（$\\Delta f$ 值小）或差异性（$\\Delta f$ 值大）。\n\n单位与数值约定：\n- 所有浓度单位必须为 $\\mathrm{mol\\,L^{-1}}$。\n- $p_{\\mathrm{O_2}}$ 单位必须为 $\\mathrm{atm}$。\n- $pH$ 是无单位的，根据定义 $a_{\\mathrm{H^+}} = 10^{-pH}$。\n- 如果计算或报告 $Eh$，其单位必须为 $\\mathrm{V}$。\n- 您的程序必须将最终结果输出为浮点数，不带任何附加文本。\n- 不得使用百分比；任何分数都必须表示为小数。\n\n测试套件：\n提供以下参数集的计算，这些参数集共同测试了一般情况、边界行为以及不一致的指定：\n1. $T = 298.15\\,\\mathrm{K}$, $pH = 7.0$, $p_{\\mathrm{O_2}} = 0.21\\,\\mathrm{atm}$, $C_{\\mathrm{Fe,tot}} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$，方法 A 使用的 $pe$ 值等于方法 B 在此情况下隐含的值。\n2. $T = 298.15\\,\\mathrm{K}$, $pH = 7.0$, $p_{\\mathrm{O_2}} = 1.0\\times 10^{-10}\\,\\mathrm{atm}$, $C_{\\mathrm{Fe,tot}} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$，方法 A 使用的 $pe$ 值等于方法 B 在此情况下隐含的值。\n3. $T = 298.15\\,\\mathrm{K}$, $pH = 3.0$, $p_{\\mathrm{O_2}} = 0.21\\,\\mathrm{atm}$, $C_{\\mathrm{Fe,tot}} = 1.0\\times 10^{-5}\\,\\mathrm{mol\\,L^{-1}}$，方法 A 使用的 $pe$ 值等于方法 B 在此情况下隐含的值。\n4. $T = 298.15\\,\\mathrm{K}$, $pH = 7.0$, $p_{\\mathrm{O_2}} = 1.0\\times 10^{-10}\\,\\mathrm{atm}$, $C_{\\mathrm{Fe,tot}} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$，方法 A 使用 $pe = 16.0$（故意与氧所隐含的值不一致）。\n5. $T = 298.15\\,\\mathrm{K}$, $pH = 7.0$, $p_{\\mathrm{O_2}} = 9.12\\times 10^{-4}\\,\\mathrm{atm}$, $C_{\\mathrm{Fe,tot}} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$，方法 A 使用的 $pe$ 值等于方法 B 在此情况下隐含的值（接近 $[\\text{Fe}^{2+}] \\approx [\\text{Fe}^{3+}]$ 的边界）。\n\n输出规格：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起（例如，“[result1,result2,result3,result4,result5]”）。每个元素是对应测试用例的绝对差值 $\\Delta f$，以十进制浮点数形式表示。\n\n您的实现必须是一个完整的、可运行的程序，该程序执行这些计算并按指定的格式和单位打印单行输出。不需要用户输入。",
            "solution": "此问题已经过验证，被认定为科学上有效、问题定义清晰且完整。它基于热力学和水文地球化学的基本原理。所有必需的常数、条件和定义均已提供，任务也已明确指定。\n\n这个问题的核心是比较水文地球化学模型中指定氧化还原条件的两种常用方法，并量化它们的一致性或差异性。第一种方法是直接设定一个全体系的电子活度 $pe$。第二种方法是通过指定一个主导氧化还原电对的浓度（或活度）来定义氧化还原状态，然后从中推断出等效的 $pe$。我们将首先从所提供的第一性原理出发，推导控制性的热力学方程。\n\n让我们从一般还原半反应的能斯特方程开始，该方程将氧化还原电位 $Eh$ 与标准电位 $E^\\circ$ 以及相关物种的活度联系起来：\n$$Eh = E^\\circ - \\frac{R T}{n F} \\ln Q$$\n其中 $R$ 是通用气体常数，$T$ 是绝对温度，$n$ 是转移的电子数，$F$ 是法拉第常数，$Q$ 是反应商。使用以10为底的对数，方程变为：\n$$Eh = E^\\circ - \\frac{2.303 R T}{n F} \\log_{10} Q$$\n问题将 $Eh$ 和电子活度 $pe$ 的关系定义为 $Eh = \\frac{2.303 R T}{F} pe$。我们定义常数项 $\\mathcal{V}_T = \\frac{2.303 RT}{F}$。在指定温度 $T = 298.15\\,\\mathrm{K}$ 下，并使用给定的常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$，此项计算结果为：\n$$\\mathcal{V}_T = \\frac{2.303 \\times 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 298.15\\,\\mathrm{K}}{96485.33212\\,\\mathrm{C\\,mol^{-1}}} \\approx 0.05916\\,\\mathrm{V}$$\n将 $pe$ 的定义代入能斯特方程得到：\n$$\\mathcal{V}_T \\cdot pe = E^\\circ - \\frac{\\mathcal{V}_T}{n} \\log_{10} Q$$\n两边同除以 $\\mathcal{V}_T$ 得到以 $pe$ 表示的能斯特方程：\n$$pe = \\frac{E^\\circ}{\\mathcal{V}_T} - \\frac{1}{n} \\log_{10} Q$$\n我们将电对的标准 $pe$ 定义为 $pe^\\circ$，即 $pe^\\circ \\equiv \\frac{E^\\circ}{\\mathcal{V}_T}$。方程简化为：\n$$pe = pe^\\circ - \\frac{1}{n} \\log_{10} Q$$\n这个基本关系将用于分析问题中的两个氧化还原电对。\n\n首先，我们分析氧电对，它决定了方法 B 中的氧化还原状态。还原半反应为：\n$$\\mathrm{O_2(g)} + 4\\mathrm{H^+(aq)} + 4\\mathrm{e^-} \\rightleftharpoons 2\\mathrm{H_2O(l)}$$\n对于此反应，转移的电子数 $n=4$。反应商 $Q$ 由下式给出：\n$$Q = \\frac{a_{\\mathrm{H_2O}}^2}{a_{\\mathrm{O_2}} a_{\\mathrm{H^+}}^4}$$\n使用问题中指定的近似值（$a_{\\mathrm{H_2O}} \\approx 1$、$a_{\\mathrm{O_2}} \\approx p_{\\mathrm{O_2}}$ 和 $a_{\\mathrm{H^+}} = 10^{-pH}$），$Q$ 变为：\n$$Q = \\frac{1^2}{p_{\\mathrm{O_2}} (10^{-pH})^4} = \\frac{1}{p_{\\mathrm{O_2}} 10^{-4pH}}$$\n取以10为底的对数：\n$$\\log_{10} Q = \\log_{10}(1) - \\log_{10}(p_{\\mathrm{O_2}}) - \\log_{10}(10^{-4pH}) = -\\log_{10}(p_{\\mathrm{O_2}}) + 4pH$$\n标准还原电位为 $E^\\circ_{\\mathrm{O_2/H_2O}} = 1.229\\,\\mathrm{V}$。此电对的标准 $pe^\\circ$ 为：\n$$pe^\\circ_{\\mathrm{O_2}} = \\frac{1.229\\,\\mathrm{V}}{\\mathcal{V}_T} \\approx \\frac{1.229}{0.05916} \\approx 20.774$$\n代入通用的 $pe$ 方程：\n$$pe = pe^\\circ_{\\mathrm{O_2}} - \\frac{1}{4} (-\\log_{10}(p_{\\mathrm{O_2}}) + 4pH) = pe^\\circ_{\\mathrm{O_2}} + \\frac{1}{4}\\log_{10}(p_{\\mathrm{O_2}}) - pH$$\n这是方法 B 中用于根据指定的 $p_{\\mathrm{O_2}}$ 和 $pH$ 计算体系 $pe$ 的方程。\n\n接下来，我们分析铁电对。一旦知道了 $pe$，就可以用它来计算形态分布。还原半反应为：\n$$\\mathrm{Fe^{3+}(aq)} + \\mathrm{e^-} \\rightleftharpoons \\mathrm{Fe^{2+}(aq)}$$\n这里，$n=1$。反应商为 $Q = \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\approx \\frac{[\\mathrm{Fe^{2+}}]}{[\\mathrm{Fe^{3+}}]}$。标准还原电位为 $E^\\circ_{\\mathrm{Fe^{3+}/Fe^{2+}}} = 0.771\\,\\mathrm{V}$。对应的标准 $pe^\\circ$ 是：\n$$pe^\\circ_{\\mathrm{Fe}} = \\frac{0.771\\,\\mathrm{V}}{\\mathcal{V}_T} \\approx \\frac{0.771}{0.05916} \\approx 13.032$$\n此电对的 $pe$ 方程为：\n$$pe = pe^\\circ_{\\mathrm{Fe}} - \\frac{1}{1} \\log_{10}\\left(\\frac{[\\mathrm{Fe^{2+}}]}{[\\mathrm{Fe^{3+}}]}\\right)$$\n重新整理以求出亚铁离子与三价铁离子的比值作为 $pe$ 的函数：\n$$\\log_{10}\\left(\\frac{[\\mathrm{Fe^{2+}}]}{[\\mathrm{Fe^{3+}}]}\\right) = pe^\\circ_{\\mathrm{Fe}} - pe$$\n设比值 $R_{\\mathrm{Fe}} = \\frac{[\\mathrm{Fe^{2+}}]}{[\\mathrm{Fe^{3+}}]}$。则 $R_{\\mathrm{Fe}} = 10^{(pe^\\circ_{\\mathrm{Fe}} - pe)}$。\n问题要求计算亚铁离子的分数，$f_{\\mathrm{Fe^{2+}}} = \\frac{[\\mathrm{Fe^{2+}}]}{C_{\\mathrm{Fe,tot}}}$。给定简化条件 $C_{\\mathrm{Fe,tot}} = [\\mathrm{Fe^{2+}}] + [\\mathrm{Fe^{3+}}]$，我们可以写出：\n$$C_{\\mathrm{Fe,tot}} = [\\mathrm{Fe^{2+}}] + \\frac{[\\mathrm{Fe^{2+}}]}{R_{\\mathrm{Fe}}} = [\\mathrm{Fe^{2+}}]\\left(1 + \\frac{1}{R_{\\mathrm{Fe}}}\\right) = [\\mathrm{Fe^{2+}}]\\left(\\frac{R_{\\mathrm{Fe}} + 1}{R_{\\mathrm{Fe}}}\\right)$$\n因此，分数 $f_{\\mathrm{Fe^{2+}}}$ 为：\n$$f_{\\mathrm{Fe^{2+}}} = \\frac{[\\mathrm{Fe^{2+}}]}{C_{\\mathrm{Fe,tot}}} = \\frac{R_{\\mathrm{Fe}}}{R_{\\mathrm{Fe}} + 1} = \\frac{10^{(pe^\\circ_{\\mathrm{Fe}} - pe)}}{10^{(pe^\\circ_{\\mathrm{Fe}} - pe)} + 1}$$\n\n对于每个测试用例，算法按以下步骤进行：\n1.  **方法 B 计算**：给定 $p_{\\mathrm{O_2}}$ 和 $pH$，使用推导出的氧电对公式计算隐含的 $pe_B$。然后，使用此 $pe_B$ 和推导出的铁电对公式计算亚铁离子的分数 $f_{\\mathrm{Fe^{2+}}}^{(B)}$。\n2.  **方法 A 计算**：使用测试用例指定的 $pe_A$。对于大多数情况，$pe_A = pe_B$。对于不一致的情况，$pe_A$ 有一个固定的不同值。使用此 $pe_A$ 计算亚铁离子的分数 $f_{\\mathrm{Fe^{2+}}}^{(A)}$。\n3.  **差异**：计算绝对差值 $\\Delta f = \\left| f_{\\mathrm{Fe^{2+}}}^{(A)} - f_{\\mathrm{Fe^{2+}}}^{(B)} \\right|$。\n\n对于 $pe_A$ 被设定为与从氧电对计算出的 $pe_B$ 值相等的情况，我们实际上是在假设铁体系与氧体系处于平衡状态。在这些场景中，$f_{\\mathrm{Fe^{2+}}}^{(A)}$ 和 $f_{\\mathrm{Fe^{2+}}}^{(B)}$ 是使用相同的 $pe$ 值计算的，因此它们的差值 $\\Delta f$ 应为零，仅受浮点精度限制。这证明了在全体系平衡的假设下，两种方法是等效的。\n\n对于 $pe_A$ 被设定为一个与氧电对所隐含的值不一致的情况，我们是在模拟一个非平衡场景。这可能代表一个系统，其氧化还原状态由外部电化学电位或由一个未考虑的、更快的氧化还原电对控制。在这种情况下，$\\Delta f$ 将不为零，从而量化了由不同氧化还原指定方法引起的差异。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares iron speciation based on two redox specification strategies.\n    \n    Approach A: Fixes pe directly.\n    Approach B: Infers pe from the O2/H2O couple at a given pO2 and pH.\n    \n    The function calculates the absolute difference in the fraction of ferrous iron\n    between the two approaches for a series of test cases.\n    \"\"\"\n    # Physical and chemical constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n    T = 298.15       # K\n    \n    # Standard reduction potentials at 298.15 K\n    E_STD_FE = 0.771  # V for Fe^3+/Fe^2+\n    E_STD_O2 = 1.229  # V for O2/H2O\n    \n    # Derived constant: (2.303 * R * T) / F\n    V_T = (2.303 * R * T) / F\n    \n    # Standard pe values\n    PE_STD_FE = E_STD_FE / V_T\n    PE_STD_O2 = E_STD_O2 / V_T\n    \n    # Test cases: (pH, pO2 (atm), C_Fe_tot (mol/L), pe_A_spec)\n    # pe_A_spec = None means pe_A is set to the value calculated for pe_B.\n    # pe_A_spec = float value means pe_A is fixed to that value.\n    test_cases = [\n        (7.0, 0.21, 1.0e-6, None),\n        (7.0, 1.0e-10, 1.0e-6, None),\n        (3.0, 0.21, 1.0e-5, None),\n        (7.0, 1.0e-10, 1.0e-6, 16.0),\n        (7.0, 9.12e-4, 1.0e-6, None),\n    ]\n\n    results = []\n\n    for pH, po2, c_fe_tot, pe_A_spec in test_cases:\n        # --- Approach B: pe implied by O2/H2O couple ---\n        # pe = pe_std_O2 + (1/4)log10(pO2) - pH\n        log10_po2 = np.log10(po2)\n        pe_B = PE_STD_O2 + 0.25 * log10_po2 - pH\n        \n        # Calculate ferrous fraction for Approach B\n        # R_Fe = 10^(pe_std_Fe - pe)\n        # f_Fe2+ = R_Fe / (1 + R_Fe)\n        ratio_Fe_B = 10**(PE_STD_FE - pe_B)\n        f_Fe2_B = ratio_Fe_B / (1.0 + ratio_Fe_B)\n\n        # --- Approach A: pe is fixed externally ---\n        if pe_A_spec is None:\n            # For equilibrium test cases, pe_A is same as pe_B\n            pe_A = pe_B\n        else:\n            # For the disequilibrium case, pe_A is specified.\n            pe_A = pe_A_spec\n            \n        # Calculate ferrous fraction for Approach A\n        ratio_Fe_A = 10**(PE_STD_FE - pe_A)\n        f_Fe2_A = ratio_Fe_A / (1.0 + ratio_Fe_A)\n        \n        # --- Comparison ---\n        # Calculate the absolute difference in ferrous fractions\n        delta_f = np.abs(f_Fe2_A - f_Fe2_B)\n        results.append(delta_f)\n\n    # Format and print the final output as a single line\n    # The map(str,...) is used to ensure standard float string representation\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "自然水体中不同氧化还原电对之间往往并未达到完全平衡，这是一个常见的实际问题。这项高级练习将指导您开发一种统计方法（加权最小二乘法），用于从多个可能不一致的氧化还原测量值中，找到一个能代表整个系统的“最佳拟合”$pe$ 或 $Eh$ 值，同时考虑到测量的不确定性。",
            "id": "4098224",
            "problem": "您的任务是构建一个完整的、可运行的程序，根据一组测量的氧化还原电对来估算最佳拟合的电子活度，该活度以10为底的负对数 $pe$ 表示。该程序必须为每个测试用例求解一个单一的 $pe$ 值，该值能够最小化由 $pe$ 隐含的电子电位与由各氧化还原电对隐含的电子电位之间的加权残差平方和，同时考虑到形式电位的不确定性。所需的推导和计算步骤必须基于以下基本依据：电子活度的定义及其与电子电位的关系，以及从化学势推导出的半反应平衡条件。\n\n使用以下背景、定义和要求：\n- 电子活度定义为 $pe = -\\log_{10}\\left(a_{e^-}\\right)$，其中 $a_{e^-}$ 是电子的活度。\n- 电子化学势 $\\mu_{e^-}$ 与电子电位 $Eh$ 的关系为 $\\mu_{e^-} = -F \\, Eh$，其中 $F$ 是法拉第常数。\n- 对于一个写为 $\\sum_j \\nu_{ij} A_j + n_i e^- \\rightleftharpoons \\sum_j \\nu'_{ij} B_j$ 的广义氧化还原半反应，从化学势和能斯特构建推导出的平衡条件，隐含了形式电位 $E_{0,i}'$、化学计量以及物种 $\\{A_j\\}$、$\\{B_j\\}$ 的活度之间的关系，从而为每个电对产生一个隐含的电子电位 $Eh_i$。\n- 在每个测试用例中，假定不确定性仅存在于形式电位 $E_{0,i}'$ 中，由标准差 $\\sigma_i$ 表示，并将物种活度视为没有不确定性的已知值。\n\n对于一个测试用例中的每个氧化还原电对 $i$：\n1. 化学计量由整数 $n_i$（电子）、反应物指数 $\\{\\nu_{ij}\\}$ 和产物指数 $\\{\\nu'_{ij}\\}$ 给出。\n2. 活度比（不包括电子的反应商）为 $Q_i = \\prod_j a_{B_j}^{\\nu'_{ij}} \\Big/ \\prod_j a_{A_j}^{\\nu_{ij}}$。\n3. 隐含的电子电位为 $Eh_i = E_{0,i}' - \\dfrac{R T}{n_i F} \\ln(Q_i)$，其中 $R$ 是气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。\n4. 由单个未知数 $pe$ 隐含的电子电位为 $Eh(pe) = \\dfrac{R T}{F} \\ln(10) \\, pe$。\n\n您必须为每个测试用例找到一个单一的 $pe$ 值，以最小化加权残差平方和 $\\sum_i w_i \\left(Eh(pe) - Eh_i\\right)^2$，其中权重 $w_i = 1/\\sigma_i^2$。同时报告每个测试用例的 $Eh^\\ast = Eh(pe^\\ast)$。$Eh$ 以伏特表示，$pe$ 为无量纲量。将报告的每个值四舍五入到六位小数。\n\n在所有计算中使用的常量：\n- $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$\n- $F = 96485.33212 \\ \\mathrm{C \\ mol^{-1}}$\n\n测试套件规范：\n每个测试用例由温度 $T$（开尔文）以及一个氧化还原电对列表指定，该列表包含它们的化学计量、物种活度、形式电位平均值和不确定性。物种活度是无量纲的，固体的活度为 $1$。\n\n测试用例1（理想情况，多个电对具有中等不确定性）：\n- $T = 298.15$\n- 电对：\n    1. $\\text{Fe}^{3+} + e^- \\rightleftharpoons \\text{Fe}^{2+}$:\n        - $n_1 = 1$\n        - 反应物：$\\text{Fe}^{3+}$，$\\nu_{1,\\mathrm{Fe}^{3+}} = 1$，$a_{\\mathrm{Fe}^{3+}} = 10^{-5}$\n        - 产物：$\\text{Fe}^{2+}$，$\\nu'_{1,\\mathrm{Fe}^{2+}} = 1$，$a_{\\mathrm{Fe}^{2+}} = 10^{-6}$\n        - $E_{0,1}' = 0.770$，$\\sigma_1 = 0.020$\n    2. $\\text{MnO}_4^- + 8 \\text{H}^+ + 5 e^- \\rightleftharpoons \\text{Mn}^{2+} + 4 \\text{H}_2\\text{O}$:\n        - $n_2 = 5$\n        - 反应物：$\\text{MnO}_4^-$，$\\nu_{2,\\mathrm{MnO}_4^-} = 1$，$a_{\\mathrm{MnO}_4^-} = 10^{-6}$；$\\text{H}^+$，$\\nu_{2,\\mathrm{H}^+} = 8$，$a_{\\mathrm{H}^+} = 10^{-5}$\n        - 产物：$\\text{Mn}^{2+}$，$\\nu'_{2,\\mathrm{Mn}^{2+}} = 1$，$a_{\\mathrm{Mn}^{2+}} = 10^{-7}$；$\\text{H}_2\\text{O}$，$\\nu'_{2,\\mathrm{H_2O}} = 4$，$a_{\\mathrm{H_2O}} = 1$\n        - $E_{0,2}' = 1.510$，$\\sigma_2 = 0.030$\n    3. $\\text{NO}_3^- + 2 \\text{H}^+ + e^- \\rightleftharpoons \\text{NO}_2^- + \\text{H}_2\\text{O}$:\n        - $n_3 = 1$\n        - 反应物：$\\text{NO}_3^-$，$\\nu_{3,\\mathrm{NO}_3^-} = 1$，$a_{\\mathrm{NO}_3^-} = 10^{-4}$；$\\text{H}^+$，$\\nu_{3,\\mathrm{H}^+} = 2$，$a_{\\mathrm{H}^+} = 10^{-7}$\n        - 产物：$\\text{NO}_2^-$，$\\nu'_{3,\\mathrm{NO}_2^-} = 1$，$a_{\\mathrm{NO}_2^-} = 10^{-6}$；$\\text{H}_2\\text{O}$，$\\nu'_{3,\\mathrm{H_2O}} = 1$，$a_{\\mathrm{H_2O}} = 1$\n        - $E_{0,3}' = 0.800$，$\\sigma_3 = 0.050$\n\n测试用例2（边缘情况：一个具有非常高不确定性的电对，其影响减小）：\n- $T = 298.15$\n- 电对：与测试用例1相同，但对于硝酸盐/亚硝酸盐电对，设置 $\\sigma_3 = 0.500$。\n\n测试用例3（温度敏感性和混合化学计量）：\n- $T = 323.15$\n- 电对：\n    1. $\\text{Fe}^{3+} + e^- \\rightleftharpoons \\text{Fe}^{2+}$:\n        - $n_1 = 1$\n        - 反应物：$\\text{Fe}^{3+}$，$\\nu_{1,\\mathrm{Fe}^{3+}} = 1$，$a_{\\mathrm{Fe}^{3+}} = 10^{-5}$\n        - 产物：$\\text{Fe}^{2+}$，$\\nu'_{1,\\mathrm{Fe}^{2+}} = 1$，$a_{\\mathrm{Fe}^{2+}} = 10^{-6}$\n        - $E_{0,1}' = 0.770$，$\\sigma_1 = 0.020$\n    2. $\\text{Cu}^{2+} + e^- \\rightleftharpoons \\text{Cu}^{+}$:\n        - $n_2 = 1$\n        - 反应物：$\\text{Cu}^{2+}$，$\\nu_{2,\\mathrm{Cu}^{2+}} = 1$，$a_{\\mathrm{Cu}^{2+}} = 10^{-6}$\n        - 产物：$\\text{Cu}^{+}$，$\\nu'_{2,\\mathrm{Cu}^{+}} = 1$，$a_{\\mathrm{Cu}^{+}} = 10^{-5}$\n        - $E_{0,2}' = 0.153$，$\\sigma_2 = 0.030$\n    3. $\\text{S}_4\\text{O}_6^{2-} + 2 e^- \\rightleftharpoons 2 \\text{S}_2\\text{O}_3^{2-}$:\n        - $n_3 = 2$\n        - 反应物：$\\text{S}_4\\text{O}_6^{2-}$，$\\nu_{3,\\mathrm{S}_4\\mathrm{O}_6^{2-}} = 1$，$a_{\\mathrm{S}_4\\mathrm{O}_6^{2-}} = 10^{-4}$\n        - 产物：$\\text{S}_2\\text{O}_3^{2-}$，$\\nu'_{3,\\mathrm{S}_2\\mathrm{O}_3^{2-}} = 2$，$a_{\\mathrm{S}_2\\mathrm{O}_3^{2-}} = 10^{-3}$\n        - $E_{0,3}' = 0.120$，$\\sigma_3 = 0.030$\n\n测试用例4（边界条件：单电对拟合）：\n- $T = 298.15$\n- 电对：\n    1. $\\text{Fe}^{3+} + e^- \\rightleftharpoons \\text{Fe}^{2+}$:\n        - $n_1 = 1$\n        - 反应物：$\\text{Fe}^{3+}$，$\\nu_{1,\\mathrm{Fe}^{3+}} = 1$，$a_{\\mathrm{Fe}^{3+}} = 10^{-5}$\n        - 产物：$\\text{Fe}^{2+}$，$\\nu'_{1,\\mathrm{Fe}^{2+}} = 1$，$a_{\\mathrm{Fe}^{2+}} = 10^{-6}$\n        - $E_{0,1}' = 0.770$，$\\sigma_1 = 0.020$\n\n程序输出规范：\n- 对于每个测试用例，计算最佳拟合的 $pe^\\ast$ 和相应的 $Eh^\\ast$（单位：伏特）。\n- 将 $pe^\\ast$ 和 $Eh^\\ast$ 的每个值四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例的结果本身就是一个按 $[pe^\\ast, Eh^\\ast]$ 顺序排列的双元素列表。例如：$[[pe_1,Eh_1],[pe_2,Eh_2],[pe_3,Eh_3],[pe_4,Eh_4]]$。",
            "solution": "所述问题在科学上是合理的，数学上是适定的，并为唯一解提供了所有必要信息。其定义和关系符合热力学和电化学的基本原理。因此，该问题被认为是有效的。我们继续进行求解推导。\n\n核心任务是找到以 $pe$ 表示的电子活度，该活度最能代表一个包含多个氧化还原电对的体系。这被构建为一个最小化问题。我们寻求使加权残差平方和 $S(pe)$ 最小的 $pe = pe^\\ast$ 值，该残差是体系整体 $pe$ 所隐含的电子电位与每个氧化还原电对所隐含的单个电子电位之间的差值。\n\n需要最小化的目标函数如下：\n$$S(pe) = \\sum_i w_i \\left(Eh(pe) - Eh_i\\right)^2$$\n其中求和是对给定测试用例中所有的 $i$ 个氧化还原电对进行的。\n\n该方程中的各项定义如下：\n1.  $Eh_i$：由单个氧化还原半反应 $i$ 隐含的电子电位（单位：伏特）。它使用能斯特方程计算：\n    $$Eh_i = E_{0,i}' - \\frac{R T}{n_i F} \\ln(Q_i)$$\n    这里，$E_{0,i}'$ 是形式电位，$R$ 是理想气体常数，$T$ 是绝对温度（开尔文），$n_i$ 是转移的电子数，$F$ 是法拉第常数，$Q_i$ 是半反应的反应商，定义为：\n    $$Q_i = \\frac{\\prod_j a_{B_j}^{\\nu'_{ij}}}{\\prod_j a_{A_j}^{\\nu_{ij}}}$$\n    其中 $\\{A_j\\}$ 是具有化学计量指数 $\\{\\nu_{ij}\\}$ 和活度 $\\{a_{A_j}\\}$ 的反应物，$\\{B_j\\}$ 是具有指数 $\\{\\nu'_{ij}\\}$ 和活度 $\\{a_{B_j}\\}$ 的产物。\n\n2.  $Eh(pe)$：对应于给定的全体系 $pe$ 值的电子电位（单位：伏特）。这种关系在地球化学中是基础性的，由下式给出：\n    $$Eh(pe) = \\frac{R T \\ln(10)}{F} pe$$\n    为简洁起见，我们可以定义一个依赖于温度的常数 $C_T = \\frac{RT \\ln(10)}{F}$。因此，$Eh(pe) = C_T \\cdot pe$。\n\n3.  $w_i$：分配给每个氧化还原电对 $i$ 的权重。问题指定不确定性仅存在于形式电位 $E_{0,i}'$ 中，由标准差 $\\sigma_i$ 给出。在加权最小二乘法中，最佳权重是测量值方差的倒数。由于 $Eh_i$ 线性依赖于 $E_{0,i}'$，因此 $Eh_i$ 的方差为 $\\sigma_i^2$。因此，合适的权重是：\n    $$w_i = \\frac{1}{\\sigma_i^2}$$\n\n根据这些定义，目标函数变为：\n$$S(pe) = \\sum_i \\frac{1}{\\sigma_i^2} \\left(C_T \\cdot pe - Eh_i\\right)^2$$\n\n为了找到使该函数最小化的值 $pe^\\ast$，我们对 $S(pe)$ 关于 $pe$ 求导并令其为零。由于 $S(pe)$ 是 $pe$ 的二次函数，其形状是一个开口向上的抛物线，确保了唯一的全局最小值。\n$$ \\frac{dS}{d(pe)} = \\frac{d}{d(pe)} \\sum_i \\frac{1}{\\sigma_i^2} \\left(C_T \\cdot pe - Eh_i\\right)^2 = 0 $$\n利用导数的线性和链式法则：\n$$ \\sum_i \\frac{1}{\\sigma_i^2} \\cdot 2 \\left(C_T \\cdot pe - Eh_i\\right) \\cdot \\frac{d}{d(pe)}(C_T \\cdot pe - Eh_i) = 0 $$\n$$ \\sum_i \\frac{2}{\\sigma_i^2} \\left(C_T \\cdot pe - Eh_i\\right) \\cdot C_T = 0 $$\n由于当 $T > 0$ 时，$2$ 和 $C_T$ 是非零常数，我们可以将它们约去：\n$$ \\sum_i \\frac{1}{\\sigma_i^2} \\left(C_T \\cdot pe - Eh_i\\right) = 0 $$\n令 $pe = pe^\\ast$ 为满足此条件的值，我们可以重排这个和式：\n$$ \\sum_i \\frac{1}{\\sigma_i^2} (C_T \\cdot pe^\\ast) - \\sum_i \\frac{1}{\\sigma_i^2} Eh_i = 0 $$\n$$ C_T \\cdot pe^\\ast \\sum_i \\frac{1}{\\sigma_i^2} = \\sum_i \\frac{1}{\\sigma_i^2} Eh_i $$\n项 $C_T \\cdot pe^\\ast$ 正是最佳拟合的体系电位 $Eh^\\ast$。求解 $Eh^\\ast$：\n$$ Eh^\\ast = \\frac{\\sum_i \\frac{1}{\\sigma_i^2} Eh_i}{\\sum_i \\frac{1}{\\sigma_i^2}} = \\frac{\\sum_i w_i Eh_i}{\\sum_i w_i} $$\n这表明，最佳电子电位 $Eh^\\ast$ 是从每个电对导出的单个电位 $Eh_i$ 的加权平均值，权重为其方差的倒数。\n\n最后，我们可以利用 $pe^\\ast$ 与 $Eh^\\ast$ 的关系求解 $pe^\\ast$：\n$$ pe^\\ast = \\frac{Eh^\\ast}{C_T} = \\frac{F}{R T \\ln(10)} Eh^\\ast $$\n代入 $Eh^\\ast$ 的表达式：\n$$ pe^\\ast = \\frac{F}{R T \\ln(10)} \\left( \\frac{\\sum_i w_i Eh_i}{\\sum_i w_i} \\right) $$\n\n每个测试用例的计算步骤如下：\n1.  确定物理常数 $R$ 和 $F$。\n2.  对于给定的温度 $T$，遍历 $N$ 个氧化还原电对中的每一个。\n3.  对于每个电对 $i$：\n    a. 计算反应商的对数 $\\ln(Q_i)$，以避免因极大或极小的活度值而可能引起的数值不稳定性。\n       $$\\ln(Q_i) = \\sum_j \\nu'_{ij} \\ln(a_{B_j}) - \\sum_j \\nu_{ij} \\ln(a_{A_j})$$\n    b. 计算隐含电位 $Eh_i = E_{0,i}' - \\frac{R T}{n_i F} \\ln(Q_i)$。\n    c. 计算权重 $w_i = 1/\\sigma_i^2$。\n4.  计算电位的加权总和 $\\sum_i w_i Eh_i$，以及权重的总和 $\\sum_i w_i$。\n5.  计算最佳拟合电位 $Eh^\\ast = (\\sum_i w_i Eh_i) / (\\sum_i w_i)$。\n6.  计算最佳拟合 $pe^\\ast = Eh^\\ast \\left/ \\left( \\frac{R T \\ln(10)}{F} \\right) \\right.$。\n7.  根据要求将 $pe^\\ast$ 和 $Eh^\\ast$ 两者都四舍五入到六位小数。\n该算法在下面的 Python 程序中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the best-fit pe and Eh for redox systems based on weighted least squares minimization.\n    \"\"\"\n\n    # Physical constants\n    R = 8.314462618  # Ideal gas constant in J mol^-1 K^-1\n    F = 96485.33212  # Faraday constant in C mol^-1\n\n    # Test suite specification\n    test_cases = [\n        {\n            \"T\": 298.15,\n            \"couples\": [\n                {\n                    \"n\": 1, \"E0_prime\": 0.770, \"sigma\": 0.020,\n                    \"reactants\": [(1, 1e-5)],  # Fe3+\n                    \"products\": [(1, 1e-6)],   # Fe2+\n                },\n                {\n                    \"n\": 5, \"E0_prime\": 1.510, \"sigma\": 0.030,\n                    \"reactants\": [(1, 1e-6), (8, 1e-5)],  # MnO4-, H+\n                    \"products\": [(1, 1e-7), (4, 1.0)],    # Mn2+, H2O\n                },\n                {\n                    \"n\": 1, \"E0_prime\": 0.800, \"sigma\": 0.050,\n                    \"reactants\": [(1, 1e-4), (2, 1e-7)],  # NO3-, H+\n                    \"products\": [(1, 1e-6), (1, 1.0)],    # NO2-, H2O\n                },\n            ],\n        },\n        {\n            \"T\": 298.15,\n            \"couples\": [\n                {\n                    \"n\": 1, \"E0_prime\": 0.770, \"sigma\": 0.020,\n                    \"reactants\": [(1, 1e-5)],\n                    \"products\": [(1, 1e-6)],\n                },\n                {\n                    \"n\": 5, \"E0_prime\": 1.510, \"sigma\": 0.030,\n                    \"reactants\": [(1, 1e-6), (8, 1e-5)],\n                    \"products\": [(1, 1e-7), (4, 1.0)],\n                },\n                {\n                    \"n\": 1, \"E0_prime\": 0.800, \"sigma\": 0.500, # Changed sigma\n                    \"reactants\": [(1, 1e-4), (2, 1e-7)],\n                    \"products\": [(1, 1e-6), (1, 1.0)],\n                },\n            ],\n        },\n        {\n            \"T\": 323.15,\n            \"couples\": [\n                {\n                    \"n\": 1, \"E0_prime\": 0.770, \"sigma\": 0.020,\n                    \"reactants\": [(1, 1e-5)], # Fe3+\n                    \"products\": [(1, 1e-6)],   # Fe2+\n                },\n                {\n                    \"n\": 1, \"E0_prime\": 0.153, \"sigma\": 0.030,\n                    \"reactants\": [(1, 1e-6)], # Cu2+\n                    \"products\": [(1, 1e-5)],   # Cu+\n                },\n                {\n                    \"n\": 2, \"E0_prime\": 0.120, \"sigma\": 0.030,\n                    \"reactants\": [(1, 1e-4)], # S4O6^2-\n                    \"products\": [(2, 1e-3)],   # S2O3^2-\n                },\n            ],\n        },\n        {\n            \"T\": 298.15,\n            \"couples\": [\n                {\n                    \"n\": 1, \"E0_prime\": 0.770, \"sigma\": 0.020,\n                    \"reactants\": [(1, 1e-5)],\n                    \"products\": [(1, 1e-6)],\n                },\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        couples = case[\"couples\"]\n\n        sum_w_Eh = 0.0\n        sum_w = 0.0\n\n        for couple in couples:\n            n = couple[\"n\"]\n            E0_prime = couple[\"E0_prime\"]\n            sigma = couple[\"sigma\"]\n            \n            # Calculate log of reaction quotient Q\n            log_Q = 0.0\n            for nu, activity in couple[\"products\"]:\n                log_Q += nu * np.log(activity)\n            for nu, activity in couple[\"reactants\"]:\n                log_Q -= nu * np.log(activity)\n\n            # Calculate implied potential Eh_i for the couple\n            Eh_i = E0_prime - (R * T) / (n * F) * log_Q\n\n            # Calculate weight w_i\n            w_i = 1.0 / (sigma**2)\n\n            # Accumulate weighted sums\n            sum_w_Eh += w_i * Eh_i\n            sum_w += w_i\n\n        # Calculate best-fit Eh* (weighted average of Eh_i)\n        Eh_star = sum_w_Eh / sum_w\n\n        # Calculate best-fit pe*\n        pe_conversion_factor = (R * T * np.log(10)) / F\n        pe_star = Eh_star / pe_conversion_factor\n        \n        # Round results and append\n        pe_star_rounded = round(pe_star, 6)\n        Eh_star_rounded = round(Eh_star, 6)\n        results.append([pe_star_rounded, Eh_star_rounded])\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}