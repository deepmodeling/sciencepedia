{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本节的第一个练习旨在培养一项基本技能：使用扩展的 Debye-Hückel 方程计算常见电解质的平均活度系数。通过这个手动计算，你将直观地理解离子强度、电荷和离子大小等因素如何共同影响溶液的非理想行为，这是理解更复杂地球化学模型的基础。",
            "id": "4067266",
            "problem": "在计算地球化学中，电解质水溶液的活度以质量摩尔浓度为标准态。在此标准态下，离子的化学势表示为 $\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i}$，其中活度 $a_{i} = \\gamma_{i} (m_i / m^{\\circ})$ (其中 $m^{\\circ}=1\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$)。$a_{i}$ 是无量纲的活度，$\\gamma_{i}$ 是相对于质量摩尔浓度标度上无限稀释参比态的活度系数，$m_{i}$ 是质量摩尔浓度。离子强度定义为 $I = \\frac{1}{2} \\sum_{j} m_{j} z_{j}^{2}$，其中 $z_{j}$ 是离子 $j$ 的电荷。对于像氯化钠这样的对称 $1{:}1$ 型电解质，平均活度系数为 $\\gamma_{\\pm} = (\\gamma_{+}\\,\\gamma_{-})^{1/2}$。\n\n从稀电解质溶液的 Debye–Hückel 理论框架出发，并考虑有限离子尺寸效应，使用扩展的 Debye–Hückel 公式计算在 $25\\,^{\\circ}\\mathrm{C}$ 的水中，当离子强度 $I = 0.100$ mol kg$^{-1}$ 时，氯化钠（NaCl）的平均活度系数 $\\gamma_{\\pm}$。使用以10为底的 Debye–Hückel 常数 $A = 0.5085$（适用于 $25\\,^{\\circ}\\mathrm{C}$ 时质量摩尔浓度标度的水溶液），离子尺寸系数 $B = 0.3281\\,\\text{\\AA}^{-1}$，以及离子尺寸参数 $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$ 和 $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$。取 $z_{\\mathrm{Na}^{+}} = +1$ 和 $z_{\\mathrm{Cl}^{-}} = -1$。\n\n将最终的平均活度系数四舍五入至四位有效数字。最终答案以纯数（无量纲）形式表示。",
            "solution": "该问题经过验证。所有给定条件逐字提取如下：\n- 离子的化学势：$\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i}$\n- 离子的活度：$a_{i} = \\gamma_{i} (m_i / m^{\\circ})$\n- $\\gamma_{i}$：活度系数\n- $m_{i}$：质量摩尔浓度\n- 离子强度：$I = \\frac{1}{2} \\sum_{j} m_{j} z_{j}^{2}$\n- $z_{j}$：离子 $j$ 的电荷\n- 对称的1:1型电解质的平均活度系数：$\\gamma_{\\pm} = (\\gamma_{+}\\,\\gamma_{-})^{1/2}$\n- 任务：计算氯化钠（NaCl）的 $\\gamma_{\\pm}$\n- 离子强度：$I = 0.100$ mol kg$^{-1}$\n- 温度：$T = 25\\,^{\\circ}\\mathrm{C}$\n- 公式体系：扩展的 Debye–Hückel\n- 以10为底的 Debye–Hückel 常数：$A = 0.5085$\n- 离子尺寸系数：$B = 0.3281\\,\\text{\\AA}^{-1}$\n- 钠离子的离子尺寸参数：$a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$\n- 氯离子的离子尺寸参数：$a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$\n- 钠离子的电荷：$z_{\\mathrm{Na}^{+}} = +1$\n- 氯离子的电荷：$z_{\\mathrm{Cl}^{-}} = -1$\n- 最终答案精度：四舍五入至四位有效数字。\n\n该问题具有科学依据、提法明确且客观。它基于标准的扩展 Debye–Hückel 理论，这是物理化学和地球化学中的一个基本概念。所有必要的常数和参数均已提供，其数值与指定温度下水溶液的既定文献值一致。问题没有矛盾、歧义和事实错误。因此，该问题被视为有效，并将提供解答。\n\n目标是使用扩展的 Debye–Hückel 公式，计算在指定离子强度下氯化钠水溶液的平均活度系数 $\\gamma_{\\pm}$。问题为 $\\mathrm{Na}^{+}$ 和 $\\mathrm{Cl}^{-}$ 提供了不同的离子尺寸参数，这需要首先计算它们各自的活度系数。\n\n对于离子强度为 $I$ 的溶液中单个离子 $i$ 的活度系数 $\\gamma_{i}$，其扩展的 Debye–Hückel 方程以10为底的对数形式给出如下：\n$$\n\\log_{10} \\gamma_{i} = - \\frac{A z_{i}^{2} \\sqrt{I}}{1 + B a_{i} \\sqrt{I}}\n$$\n其中 $A$ 和 $B$ 是取决于溶剂和温度的常数，$z_i$ 是离子的电荷数，$a_i$ 是有效水合离子尺寸参数，$I$ 是溶液的离子强度。\n\n对于 $1{:}1$ 型电解质氯化钠（$\\mathrm{NaCl}$），其组成离子是钠阳离子（$\\mathrm{Na}^{+}$）和氯阴离子（$\\mathrm{Cl}^{-}$）。它们各自的活度系数 $\\gamma_{\\mathrm{Na}^{+}}$ 和 $\\gamma_{\\mathrm{Cl}^{-}}$ 可用上述方程计算。\n对于钠离子（$i = \\mathrm{Na}^{+}$），我们有 $z_{\\mathrm{Na}^{+}}=+1$ 和 $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$。\n$$\n\\log_{10} \\gamma_{\\mathrm{Na}^{+}} = - \\frac{A (z_{\\mathrm{Na}^{+}})^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} = - \\frac{A (+1)^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}}\n$$\n对于氯离子（$i = \\mathrm{Cl}^{-}$），我们有 $z_{\\mathrm{Cl}^{-}}=-1$ 和 $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$。\n$$\n\\log_{10} \\gamma_{\\mathrm{Cl}^{-}} = - \\frac{A (z_{\\mathrm{Cl}^{-}})^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} = - \\frac{A (-1)^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}}\n$$\n由于 $(+1)^{2} = (-1)^{2} = 1$，两个表达式都简化了。我们将 $\\gamma_{\\mathrm{Na}^{+}}$ 记为 $\\gamma_{+}$，将 $\\gamma_{\\mathrm{Cl}^{-}}$ 记为 $\\gamma_{-}$。\n$$\n\\log_{10} \\gamma_{+} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}}\n$$\n$$\n\\log_{10} \\gamma_{-} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}}\n$$\n问题将对称 $1{:}1$ 型电解质的平均活度系数 $\\gamma_{\\pm}$ 定义为单个离子活度系数的几何平均值：\n$$\n\\gamma_{\\pm} = (\\gamma_{+} \\gamma_{-})^{1/2}\n$$\n对该表达式取以10为底的对数，得到：\n$$\n\\log_{10} \\gamma_{\\pm} = \\log_{10} \\left( (\\gamma_{+} \\gamma_{-})^{1/2} \\right) = \\frac{1}{2} (\\log_{10} \\gamma_{+} + \\log_{10} \\gamma_{-})\n$$\n将 $\\log_{10} \\gamma_{+}$ 和 $\\log_{10} \\gamma_{-}$ 的扩展 Debye–Hückel 表达式代入，得出：\n$$\n\\log_{10} \\gamma_{\\pm} = \\frac{1}{2} \\left[ \\left( - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} \\right) + \\left( - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} \\right) \\right]\n$$\n提取公因式 $-A\\sqrt{I}$，得到：\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{A \\sqrt{I}}{2} \\left( \\frac{1}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} + \\frac{1}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} \\right)\n$$\n现在，我们将给定的数值代入此方程：\n- $I = 0.100$ mol kg$^{-1}$，所以 $\\sqrt{I} = \\sqrt{0.100} \\approx 0.316228$\n- $A = 0.5085$\n- $B = 0.3281\\,\\text{\\AA}^{-1}$\n- $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$\n- $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$\n\n首先，我们计算无量纲的乘积 $B a_i \\sqrt{I}$：\n$$\nB a_{\\mathrm{Na}^{+}} \\sqrt{I} = (0.3281\\,\\text{\\AA}^{-1}) \\times (4.0\\,\\text{\\AA}) \\times \\sqrt{0.100} = 1.3124 \\times 0.316228 \\approx 0.41498\n$$\n$$\nB a_{\\mathrm{Cl}^{-}} \\sqrt{I} = (0.3281\\,\\text{\\AA}^{-1}) \\times (3.5\\,\\text{\\AA}) \\times \\sqrt{0.100} = 1.14835 \\times 0.316228 \\approx 0.36311\n$$\n现在，我们将这些值代入 $\\log_{10} \\gamma_{\\pm}$ 的表达式中：\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{0.5085 \\times \\sqrt{0.100}}{2} \\left( \\frac{1}{1 + 0.41498} + \\frac{1}{1 + 0.36311} \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{0.5085 \\times 0.316228}{2} \\left( \\frac{1}{1.41498} + \\frac{1}{1.36311} \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx - \\frac{0.16079}{2} \\left( 0.70672 + 0.73362 \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx -0.080395 \\times (1.44034)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx -0.11580\n$$\n为了求出平均活度系数 $\\gamma_{\\pm}$，我们计算反对数：\n$$\n\\gamma_{\\pm} = 10^{\\log_{10} \\gamma_{\\pm}} = 10^{-0.11580}\n$$\n$$\n\\gamma_{\\pm} \\approx 0.765934\n$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$\n\\gamma_{\\pm} \\approx 0.7659\n$$\n平均活度系数是一个无量纲量。",
            "answer": "$$\n\\boxed{0.7659}\n$$"
        },
        {
            "introduction": "在现代地球化学中，研究人员严重依赖计算工具来模拟复杂的自然系统。这个练习将引导你从单个手动计算过渡到构建一个多功能的算法。你的任务是实现几种标准的活度模型（理想模型、Davies 模型和扩展 Debye-Hückel 模型），从而为一个地球化学建模代码库创建一个基础模块。",
            "id": "4067265",
            "problem": "你的任务是设计并实现一个确定性算法，用于计算在固定温度下、质量摩尔浓度标准态下水溶液中离子物质的活度。该算法必须接受以下输入：质量摩尔浓度 $m_i$（单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$）、离子电荷 $z_i$（无量纲）、离子强度 $I$（单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$），以及从集合 $\\{\\text{Ideal}, \\text{Davies}, \\text{Extended Debye-Hückel}\\}$ 中选择的一个活度模型。输出必须是每种物质的活度 $a_i$（无量纲），该活度应与质量摩尔浓度标准态一致地计算得出，并根据提供的测试套件汇总成单一要求的格式。\n\n使用以下基本依据：\n- 在质量摩尔浓度标度下，物质 $i$ 的化学势为 $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$，其中 $R$ 是理想气体常数，$T$ 是温度，标准态是单位质量摩尔浓度的无限稀释溶液。\n- 在质量摩尔浓度标度下的活度为 $a_i = \\gamma_i \\, m_i / m^{\\circ}$，其中 $\\gamma_i$ 是活度系数（无量纲），且 $m^{\\circ} = 1\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n- 离子强度为 $I = \\dfrac{1}{2}\\sum_j m_j z_j^2$。\n\n在您的算法中实现以下活度模型：\n- Ideal 模型：假设所有物质的 $\\gamma_i = 1$。\n- Davies 模型：使用与 $25\\,^{\\circ}\\mathrm{C}$ 水溶液一致的标准常用对数（以 10 为底）公式，并采用适用于水的相应常数。不假设需要任何迭代。\n- Extended Debye-Hückel 模型：使用与 $25\\,^{\\circ}\\mathrm{C}$ 水溶液一致的标准常用对数公式，包括离子尺寸参数（单位为 $\\text{\\AA}$）。不假设模型之外存在任何高阶相互作用。\n\n采用适用于 $25\\,^{\\circ}\\mathrm{C}$ 水的常数：Debye-Hückel $A$ 常数（以 10 为底）$A_{\\phi} = 0.509$ 和 $B$ 常数（以 10 为底）$B = 0.328\\,\\text{\\AA}^{-1}$。对于 $z_i = 0$ 的中性溶质，设置 $\\gamma_i = 1$，且与 $I$ 无关。\n\n算法要求：\n- 算法必须验证 $I \\ge 0$；如果 $I = 0$，则必须根据无限稀释的要求，为所有物质返回 $\\gamma_i = 1$。\n- 如果活度模型为 Ideal，则为所有物质设置 $\\gamma_i = 1$。\n- 如果活度模型为 Davies 或 Extended Debye-Hückel，则使用上述指定的 $A_{\\phi}$ 和 $B$ 常数，通过模型的标准常用对数公式计算 $\\gamma_i$；对于 Extended Debye-Hückel 模型，必须提供每个离子的尺寸参数（单位为 $\\text{\\AA}$）。\n- 最终活度必须按 $a_i = \\gamma_i \\, m_i / m^{\\circ}$ 计算，并报告为无量纲浮点数。\n- 停止标准：在此公式中，所有三个活度模型都是非迭代的。然而，您的算法必须包含一个通用的收敛检查框架，以便在引入任何迭代优化时使用（例如，当提供的 $I$ 需要与更复杂的模型自洽地协调时）：当任何需要迭代计算的量的绝对变化小于 $\\varepsilon = 10^{-12}$ 或达到最大迭代次数 $N_{\\max} = 100$ 时终止。在本问题中，由于模型是非迭代的，此框架将在单次计算后立即触发终止。\n\n单位：\n- 输入的质量摩尔浓度 $m_i$ 单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n- 输入的离子强度 $I$ 单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n- Extended Debye-Hückel 模型的离子尺寸参数单位为 $\\text{\\AA}$。\n- 输出的活度 $a_i$ 为无量纲。\n\n测试套件：\n对于每个测试用例，提供元组 $(m, z, I, \\text{model}, a^{\\text{size}})$，其中 $m$ 和 $z$ 是等长列表，$I$ 是一个非负浮点数，$\\text{model} \\in \\{\\text{ideal}, \\text{davies}, \\text{edh}\\}$，并且 $a^{\\text{size}}$ 是一个离子尺寸参数列表（用于 Extended Debye-Hückel 模型）或在其他情况下为 $\\text{None}$。\n\n- 用例 1（正常路径，ideal 模型，稀二元电解质）：\n  - $m = [0.01, 0.01]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [1, -1]$,\n  - $I = 0.01$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{ideal}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- 用例 2（Davies 模型，中等离子强度，二价离子）：\n  - $m = [0.05, 0.05]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [2, -2]$,\n  - $I = 0.2$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{davies}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- 用例 3（Extended Debye-Hückel 模型，混合价态，指定离子尺寸）：\n  - $m = [0.1, 0.2]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [2, -1]$,\n  - $I = 0.3$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [9.0, 4.0]$ 单位 $\\text{\\AA}$。\n- 用例 4（边界情况，零离子强度，中性溶质）：\n  - $m = [0.001]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [0]$,\n  - $I = 0.0$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [3.0]$ 单位 $\\text{\\AA}$（因 z=0 而被忽略）。\n- 用例 5（Davies 模型边界有效性，接近上限范围）：\n  - $m = [0.5, 0.5]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [1, -1]$,\n  - $I = 0.5$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{davies}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- 用例 6（Extended Debye-Hückel 模型，高离子强度，超出 Davies 模型范围）：\n  - $m = [1.0, 1.0]$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $z = [1, -1]$,\n  - $I = 1.0$ 单位 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [4.0, 4.0]$ 单位 $\\text{\\AA}$。\n\n答案规格：\n- 对于每个测试用例，程序必须以浮点数列表的形式返回活度列表 $[a_1, a_2, \\dots]$。\n- 最终输出必须是单行，其中包含所有测试用例的汇总结果，格式为无空格、逗号分隔的列表的列表，并用方括号括起来，例如：$[ [a_{11},a_{12}], [a_{21},a_{22}], \\dots ]$，输出形式应与单行 Python 风格的列表字面量完全相同，但没有任何空格。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 `[result1,result2,result3]`）。在本问题中，每个 `result` 本身就是一个浮点数列表，并且打印的行中任何位置都不能有空格。",
            "solution": "问题陈述已经过仔细验证，并被确定为有效。它在科学上是合理的、内容自洽且提法恰当。任务是开发一个确定性算法，使用三种指定的热力学模型之一（Ideal 模型、Davies 模型或 Extended Debye-Hückel 模型）来计算水溶液中物质的活度。该问题提供了所有必要的方程式、常数和一个全面的测试套件。测试用例中提供的离子强度值与相应的质量摩尔浓度和电荷一致，证实了问题设置的内部一致性。\n\n解决方案首先定义了基本的热力学关系和每种活度模型的具体方程。随后，设计了一个计算算法来实现这些模型，处理指定的测试用例，并以所需格式生成输出。\n\n在质量摩尔浓度标度下，物质 $i$ 的活度 $a_i$ 定义为：\n$$\na_i = \\gamma_i \\frac{m_i}{m^{\\circ}}\n$$\n其中 $m_i$ 是该物质的质量摩尔浓度，$\\gamma_i$ 是其无量纲活度系数，$m^{\\circ}$ 是标准态质量摩尔浓度，等于 $1\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。由于输入的质量摩尔浓度是以数值形式提供的，计算简化为 $a_i = \\gamma_i m_i$。\n\n活度系数 $\\gamma_i$ 取决于溶液的离子强度 $I$ 和所选择的热力学模型。离子强度由下式给出：\n$$\nI = \\frac{1}{2} \\sum_{j} m_j z_j^2\n$$\n其中 $z_j$ 是物质 $j$ 的电荷。\n\n该算法必须实现三种计算 $\\gamma_i$ 的模型：\n\n1.  **Ideal 模型**：在这种简化情况下，所有离子间的相互作用都被忽略。每种物质的活度系数均为 1。\n    $$\n    \\gamma_i = 1\n    $$\n\n2.  **Davies 模型**：该模型为 Debye-Hückel 理论提供了一个经验性扩展。离子 $i$ 的活度系数的常用对数（以 10 为底）形式为：\n    $$\n    \\log_{10} \\gamma_i = -A_{\\phi} z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)\n    $$\n    其中 $A_{\\phi}$ 是用于渗透系数的 Debye-Hückel 常数。问题指定在 $25\\,^{\\circ}\\mathrm{C}$ 的水中 $A_{\\phi} = 0.509$。\n\n3.  **Extended Debye-Hückel (EDH) 模型**：该模型考虑了离子的有限尺寸。其常用对数形式为：\n    $$\n    \\log_{10} \\gamma_i = - \\frac{A_{\\phi} z_i^2 \\sqrt{I}}{1 + B a_i^{\\circ} \\sqrt{I}}\n    $$\n    此处，$a_i^{\\circ}$ 是离子 $i$ 的有效水合半径（离子尺寸参数，以 $\\text{\\AA}$ 为单位提供），$B$ 是另一个 Debye-Hückel 参数。问题指定在 $25\\,^{\\circ}\\mathrm{C}$ 的水中 $A_{\\phi} = 0.509$ 且 $B = 0.328\\,\\text{\\AA}^{-1}\\,\\left(\\mathrm{kg}/\\mathrm{mol}\\right)^{1/2}$。\n\n对于所有模型，规定了两个边界条件：\n-   如果离子是中性的（$z_i = 0$），其活度系数 $\\gamma_i = 1$。\n-   在无限稀释条件下（$I = 0$），所有活度系数均为 $\\gamma_i = 1$。\n\n算法结构如下：\n一个主函数遍历测试套件中提供的每个测试用例。对于每个用例，都会调用一个专门的计算函数。该函数首先解包输入：质量摩尔浓度列表（$m_i$）、电荷列表（$z_i$）、离子强度（$I$）、模型名称，以及（如果适用）离子尺寸参数列表（$a_i^{\\circ}$）。\n\n计算函数包含一个“迭代框架”，形式为一个 `for` 循环，最多运行 $N_{\\max} = 100$ 次迭代。然而，由于指定的模型是非迭代的（即 $\\gamma_i$ 可以直接从 $I$ 计算得出），该循环被设计为仅执行一次然后终止。尽管如此，包含此结构是为了满足问题的要求，即设计一个可以扩展到迭代方案的结构（例如，自洽离子强度计算）。\n\n在循环内部，算法遍历从 $1$ 到 $N_{\\text{species}}$ 的每种物质 $i$。对于每种物质，它根据所选模型和该物质的电荷 $z_i$ 计算 $\\gamma_i$：\n- 它首先检查特殊条件：如果 $z_i = 0$ 或 $I = 0$，则将 $\\gamma_i$ 设置为 $1.0$。\n- 否则，它使用一个条件块来选择与 \"ideal\"、\"davies\" 或 \"edh\" 模型相对应的 $\\log_{10} \\gamma_i$ 计算公式。\n- 然后通过求幂运算得到活度系数：$\\gamma_i = 10^{\\log_{10} \\gamma_i}$。\n\n在计算完测试用例中所有物质的活度系数列表后，循环终止。然后对每种物质计算最终活度 $a_i = \\gamma_i m_i$。当前测试用例得到的活度列表被存储起来。\n\n处理完所有测试用例后，收集到的结果列表（一个列表的列表）被格式化为单个字符串。根据严格的输出规范，该字符串被构造成一个不含空格的 Python 风格的列表字面量，例如 `[[a1,a2],[b1,b2,b3]]`。这是通过编程方式从其组件构建字符串以确保精确格式化来实现的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes a suite of test cases for calculating aqueous species activities.\n    \"\"\"\n\n    # Constants for water at 25 C as specified in the problem\n    A_PHI = 0.509  # Debye-Hückel A-constant (base-10)\n    B = 0.328      # Debye-Hückel B-constant (base-10, in Angstrom^-1)\n    \n    # Iteration scaffold parameters (non-functional for this problem's models)\n    N_MAX = 100\n    EPSILON = 1e-12\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        # Case 1: happy path, ideal, dilute binary electrolyte\n        {'m': [0.01, 0.01], 'z': [1, -1], 'I': 0.01, 'model': 'ideal', 'a_size': None},\n        # Case 2: Davies, moderate ionic strength, divalent ions\n        {'m': [0.05, 0.05], 'z': [2, -2], 'I': 0.2, 'model': 'davies', 'a_size': None},\n        # Case 3: Extended Debye-Hückel, mixed valence, specified ion sizes\n        {'m': [0.1, 0.2], 'z': [2, -1], 'I': 0.3, 'model': 'edh', 'a_size': [9.0, 4.0]},\n        # Case 4: edge case, zero ionic strength, neutral solute\n        {'m': [0.001], 'z': [0], 'I': 0.0, 'model': 'edh', 'a_size': [3.0]},\n        # Case 5: Davies boundary validity, near upper range\n        {'m': [0.5, 0.5], 'z': [1, -1], 'I': 0.5, 'model': 'davies', 'a_size': None},\n        # Case 6: Extended Debye-Hückel, high ionic strength beyond Davies range\n        {'m': [1.0, 1.0], 'z': [1, -1], 'I': 1.0, 'model': 'edh', 'a_size': [4.0, 4.0]},\n    ]\n\n    def calculate_activities(case):\n        \"\"\"\n        Calculates activities for a single test case.\n        \"\"\"\n        m_vals = case['m']\n        z_vals = case['z']\n        I_val = case['I']\n        model = case['model']\n        a_size_vals = case['a_size']\n\n        if I_val  0:\n            raise ValueError(\"Ionic strength cannot be negative.\")\n\n        num_species = len(m_vals)\n        gammas = np.ones(num_species)\n\n        # Iterative scaffold: will run only once for these non-iterative models.\n        for _ in range(N_MAX):\n            \n            # Since the state does not change, calculate gammas and break.\n            gammas_new = np.ones(num_species)\n            sqrt_I = np.sqrt(I_val)\n\n            for i in range(num_species):\n                z_i = z_vals[i]\n\n                # Handle special conditions: neutral species or infinite dilution\n                if z_i == 0 or I_val == 0:\n                    gammas_new[i] = 1.0\n                    continue\n\n                if model == 'ideal':\n                    gammas_new[i] = 1.0\n                \n                elif model == 'davies':\n                    log10_gamma = -A_PHI * (z_i**2) * ( (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I_val )\n                    gammas_new[i] = 10**log10_gamma\n                \n                elif model == 'edh':\n                    if a_size_vals is None:\n                        raise ValueError(\"Ion-size parameters must be provided for EDH model.\")\n                    a_i = a_size_vals[i]\n                    log10_gamma = - (A_PHI * (z_i**2) * sqrt_I) / (1.0 + B * a_i * sqrt_I)\n                    gammas_new[i] = 10**log10_gamma\n                \n                else:\n                    raise ValueError(f\"Unknown model: {model}\")\n            \n            # The scaffold's convergence check is trivially passed\n            # by breaking after the first and only pass.\n            gammas = gammas_new\n            break\n            # In a real iterative solver, you would check:\n            # if np.all(np.abs(gammas_new - gammas)  EPSILON):\n            #     gammas = gammas_new\n            #     break\n            # gammas = gammas_new\n\n        # Calculate activities: a_i = gamma_i * m_i / m_circ, with m_circ = 1\n        activities = gammas * np.array(m_vals)\n        return activities.tolist()\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_activities(case)\n        all_results.append(result)\n\n    # Format the final output string to be a list of lists with no spaces.\n    # e.g., [[val1,val2],[val3,val4]]\n    inner_strings = []\n    for res_list in all_results:\n        inner_strings.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个练习是一个综合性项目，它模拟了真实的研究工作流程。在这个练习中，你将开发一个混合模型（结合 Debye-Hückel 和特定离子相互作用理论），对照数据检验其局限性，并通过添加具有物理意义的校正项来系统地改进它。这个过程将训练你在模型验证和开发方面的批判性思维，这是计算科学家的核心能力之一。",
            "id": "4067293",
            "problem": "考虑二元电解质氯化钙 (CaCl$_2$) 在温度 $T = 298.15\\,\\mathrm{K}$ 的水溶液中，其平均活度系数 $\\gamma_{\\pm}$ 由化学势与活度之间的关系 $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$ 定义，其中溶质活度 $a_i = \\gamma_i m_i$ 采用质量摩尔浓度标度（质量摩尔浓度 $m_i$ 的单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$）。对于化学计量系数为 $\\nu_+$ 和 $\\nu_-$ 的电解质，其平均活度系数为 $ \\gamma_{\\pm} = \\left(\\gamma_+^{\\nu_+} \\gamma_-^{\\nu_-}\\right)^{1/(\\nu_+ + \\nu_-)}$。对于 CaCl$_2$，$\\nu_+ = 1$ 且 $\\nu_- = 2$，因此 $\\nu_+ + \\nu_- = 3$。离子强度为 $ I = \\frac{1}{2}\\sum_i m_i z_i^2 $，若将 CaCl$_2$ 视为完全解离为 $\\mathrm{Ca}^{2+}$ 和 $\\mathrm{Cl}^-$，则有 $m_{\\mathrm{Ca}^{2+}} = m$ 和 $m_{\\mathrm{Cl}^-} = 2m$，因此 $ I = 3m $。\n\n你需要构建并测试一个混合活度系数模型，该模型融合了与 Debye–Hückel 理论一致的长程静电作用贡献，以及与特定离子相互作用理论 (SIT) 一致的短程特定相互作用项，用于描述 CaCl$_2$ 的平均活度系数作为质量摩尔浓度 $m$（最高达 $6\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$）的函数。标准态是无限稀释参考态，其中当 $m \\to 0$ 时，$\\gamma_{\\pm} \\to 1$。\n\n你的任务是：\n- 根据上述基本定义和长程 Debye–Hückel 概念，推导出一个可计算的 CaCl$_2$ 平均活度系数表达式，该表达式包含一个符合 SIT 精神的单短程相互作用参数。\n- 给定合成但物理上合理的“实验”数据集 $\\gamma_{\\pm}(m)$，测试所选的 Debye–Hückel–SIT 混合模型是否能捕捉 $\\log_{10}\\gamma_{\\pm}$ 作为 $m$ 的函数在 $m \\in [0.1, 6.0]\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 范围内的曲率。此处，“捕捉到曲率”在操作上定义为：混合模型拟合（仅使用单个短程参数）与实验数据集之间的 $\\log_{10}\\gamma_{\\pm}$ 均方根误差 (RMSE) 小于或等于阈值 $T$。\n- 如果未能捕捉到曲率 (RMSE  $T$)，则提出一个与物理上合理的高阶短程相互作用一致的最小校正项，将其添加到混合模型中，并对相同数据集进行重新拟合。报告该校正项的拟合系数。\n- 所有建模和拟合都必须在无量纲的 $\\log_{10}\\gamma_{\\pm}$ 上进行。报告所有输出为无量纲量。不涉及角度，也不需要百分比。\n\n在你的推导和计算中，请使用以下物理上合理的常数和定义，不要引入新的常数：\n- 电荷：$z_+ = +2$， $z_- = -1$。\n- 离子强度：$I = 3m$。\n- 在 $25\\,^{\\circ}\\mathrm{C}$ 下，以 10 为底的公式的 Debye–Hückel 常数：$A = 0.509$ 和 $B = 0.328\\,\\mathrm{\\AA}^{-1}$。\n- 一个有效离子尺寸参数 $a_{\\mathrm{eff}}$（单位为 $\\mathrm{\\AA}$），每个测试用例将指定其值。\n\n合成的“实验”数据 $\\log_{10}\\gamma_{\\pm}(m)$ 是在质量摩尔浓度网格 $m \\in \\{0.1,\\,0.5,\\,1.0,\\,2.0,\\,3.5,\\,6.0\\}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 上构建的，其值是 Debye–Hückel 长程项与最高至 $m$ 二阶的短程项之和（这反映了高浓度下实际存在的向上或向下弯曲的曲率）。在问题陈述中未提供生成公式；你将使用下面的常数在内部复现数据以供测试。\n\n测试套件（每个用例指定 $a_{\\mathrm{eff}}$ [$\\mathrm{\\AA}$]、线性短程系数 $\\varepsilon_{\\mathrm{true}}$ [$\\mathrm{(mol\\,kg^{-1})^{-1}}$] 和二次短程系数 $\\kappa_{\\mathrm{true}}$ [$\\mathrm{(mol\\,kg^{-1})^{-2}}$]）：\n- 用例1（理想路径，曲率温和）：$a_{\\mathrm{eff}} = 4.0$，$\\varepsilon_{\\mathrm{true}} = 0.08$，$\\kappa_{\\mathrm{true}} = 0.005$。\n- 用例2（强曲率）：$a_{\\mathrm{eff}} = 3.5$，$\\varepsilon_{\\mathrm{true}} = 0.04$，$\\kappa_{\\mathrm{true}} = 0.012$。\n- 用例3（近线性行为）：$a_{\\mathrm{eff}} = 4.0$，$\\varepsilon_{\\mathrm{true}} = 0.06$，$\\kappa_{\\mathrm{true}} = 0.000$。\n- 用例4（高 $m$ 时向下弯曲）：$a_{\\mathrm{eff}} = 4.5$，$\\varepsilon_{\\mathrm{true}} = 0.10$，$\\kappa_{\\mathrm{true}} = -0.004$。\n\n判定阈值：\n- 对 $\\log_{10}\\gamma_{\\pm}$ 的 RMSE 使用 $T = 0.05$。\n\n模型拟合与判定协议：\n- 通过对 $\\log_{10}\\gamma_{\\pm}$ 作为 $m$ 的函数在整个网格上进行最小二乘法拟合，来拟合具有单个短程参数的混合模型。\n- 计算此拟合的 RMSE。\n- 如果 RMSE $\\leq T$，则声明“已捕捉到曲率”，且不添加校正项。\n- 如果 RMSE $ T$，则根据你的推导引入你认为合适的最小校正项，重新拟合，并报告该校正项的拟合系数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对于四个用例中的每一个，按顺序输出两个值：首先是一个布尔值，表示单参数混合模型是否捕捉到曲率（如果 RMSE $\\leq T$ 则为 True，否则为 False）；其次，如果未捕捉到曲率，则输出所提出的校正项的拟合系数，否则输出 $0.0$ 作为校正项。因此，最终输出将包含八个条目：$[\\text{case1\\_captured},\\text{case1\\_correction},\\text{case2\\_captured},\\text{case2\\_correction},\\text{case3\\_captured},\\text{case3\\_correction},\\text{case4\\_captured},\\text{case4\\_correction}]$。",
            "solution": "用户提供了一个有效的问题陈述。该问题在科学上基于物理化学原理，特别是电解质溶液理论，并且问题定义明确，具有清晰、客观的建模和评估程序。所有必要的数据和常数均已提供。我现在将开始解答。\n\n主要目标是构建并测试一个用于描述在温度 $T = 298.15\\,\\mathrm{K}$ 下氯化钙 ($\\mathrm{CaCl}_2$) 水溶液的平均活度系数 $\\gamma_{\\pm}$ 的混合模型。该模型将结合由 Debye–Hückel 理论描述的长程静电相互作用与受特定离子相互作用理论 (SIT) 启发的短程项。\n\n首先，我们推导模型的数学表达式。分析将在 $\\log_{10}\\gamma_{\\pm}$ 上进行。\n\n**1. 长程 Debye–Hückel 项的推导**\n\n扩展的 Debye–Hückel 理论为单个离子 $i$ 的活度系数（以 10 为底的对数）提供了一个表达式，该表达式是离子强度 $I$ 的函数：\n$$ \\log_{10} \\gamma_i = - \\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}} $$\n其中 $z_i$ 是离子的电荷数，$a_i$ 是其有效水合半径，而 $A$ 和 $B$ 是依赖于溶剂和温度的常数。对于水在 $T=298.15\\,\\mathrm{K}$ 的条件下，给定值为 $A = 0.509$ 和 $B = 0.328\\,\\mathrm{\\AA}^{-1}$。\n\n对于电解质 $C_{\\nu_+}A_{\\nu_-}$，其平均活度系数 $\\gamma_{\\pm}$ 由单个离子的活度系数 $\\gamma_+$ 和 $\\gamma_-$ 定义：\n$$ \\log_{10} \\gamma_{\\pm} = \\frac{1}{\\nu_+ + \\nu_-} (\\nu_+ \\log_{10} \\gamma_+ + \\nu_- \\log_{10} \\gamma_-) $$\n对于 $\\mathrm{CaCl}_2$，其解离过程为 $\\mathrm{CaCl}_2 \\rightarrow \\mathrm{Ca}^{2+} + 2\\mathrm{Cl}^-$。化学计量系数为 $\\nu_+ = 1$ 和 $\\nu_- = 2$，离子电荷为 $z_+ = +2$ 和 $z_- = -1$。\n将单离子表达式代入平均系数的方程中，并假设两种离子具有一个共同的有效离子尺寸参数 $a_{\\mathrm{eff}}$（$a_{\\mathrm{Ca}^{2+}} \\approx a_{\\mathrm{Cl}^{-}} \\approx a_{\\mathrm{eff}}$），我们得到：\n$$ \\log_{10} \\gamma_{\\pm} = \\frac{1}{\\nu_+ + \\nu_-} \\left( \\nu_+ \\left(- \\frac{A z_+^2 \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}}\\right) + \\nu_- \\left(- \\frac{A z_-^2 \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}}\\right) \\right) $$\n$$ \\log_{10} \\gamma_{\\pm} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}} \\left( \\frac{\\nu_+ z_+^2 + \\nu_- z_-^2}{\\nu_+ + \\nu_-} \\right) $$\n由于电中性条件 ($\\nu_+ z_+ + \\nu_- z_- = 0$)，括号中的项简化为电荷的绝对乘积 $|z_+ z_-|$。对于 $\\mathrm{CaCl}_2$，此值为 $|(+2)(-1)| = 2$。因此，Debye–Hückel 对平均活度系数的贡献为：\n$$ (\\log_{10} \\gamma_{\\pm})_{\\mathrm{DH}} = - \\frac{2A\\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}} $$\n对于质量摩尔浓度为 $m$ 的 $\\mathrm{CaCl}_2$ 溶液，其离子强度 $I$ 由 $I = \\frac{1}{2} \\sum_i m_i z_i^2 = \\frac{1}{2}(m \\cdot z_+^2 + 2m \\cdot z_-^2) = \\frac{1}{2}(m \\cdot (+2)^2 + 2m \\cdot (-1)^2) = \\frac{1}{2}(4m + 2m) = 3m$ 给出。\n将 $I = 3m$ 代入表达式，得到长程项的最终形式：\n$$ (\\log_{10} \\gamma_{\\pm})_{\\mathrm{DH}} = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} $$\n\n**2. 混合模型的构建**\n\n为了考虑短程、非静电相互作用，我们遵循 SIT 原理和过量吉布斯能的维里展开，用附加项来扩充 Debye–Hückel 项。\n\n**模型 1：单短程参数**\n最简单的扩展是增加一个与浓度成线性的项。在地球化学中，此项通常代表二元相互作用（例如 $\\mathrm{Ca}^{2+}$-$\\mathrm{Cl}^{-}$）。我们增加一个 $\\varepsilon m$ 项，其中 $\\varepsilon$ 是一个可调参数，代表短程力的净效应。这给出了我们的主要混合模型：\n$$ \\log_{10} \\gamma_{\\pm}(m) = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon m $$\n这是一个单参数模型，因为对于给定的测试用例（其中 $a_{\\mathrm{eff}}$ 是固定的），$\\varepsilon$ 是唯一需要拟合的系数。\n\n**模型 2：用于曲率的最小校正项**\n如果模型 1 未能捕捉到实验数据的曲率（即，拟合的均方根误差 (RMSE) 高于阈值 $T$），我们必须添加一个校正项。在质量摩尔浓度的维里展开中，下一个逻辑项是二次项 $\\kappa m^2$。此项可以解释高阶相互作用（例如，三元相互作用如 $\\mathrm{Ca}^{2+}$-$\\mathrm{Cl}^{-}$-$\\mathrm{Cl}^{-}$）或二元相互作用参数 $\\varepsilon$ 的浓度依赖性。修正后的双参数模型为：\n$$ \\log_{10} \\gamma_{\\pm}(m) = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon m + \\kappa m^2 $$\n在此模型中，$\\varepsilon$ 和 $\\kappa$ 将同时拟合。校正项的系数是 $\\kappa$。\n\n**3. 计算与拟合协议**\n\n任务是针对四个用例中的每一个，用这些模型测试合成的“实验”数据。协议如下：\n\n对于每个测试用例 `(a_eff, eps_true, kappa_true)`：\n1.  **生成合成数据**：对于网格 $\\{0.1, 0.5, 1.0, 2.0, 3.5, 6.0\\}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 中的每个质量摩尔浓度 $m$，使用双参数模型形式和提供的 `true` 系数生成实验数据 $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}}$：\n    $$ (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}} = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon_{\\mathrm{true}} m + \\kappa_{\\mathrm{true}} m^2 $$\n2.  **拟合单参数模型**：我们将模型 1 拟合到生成的数据。这是一个线性最小二乘问题。设 $y_i = (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}}$ 为在质量摩尔浓度 $m_i$ 时的值，并设 $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i}$ 为相应的 Debye–Hückel 项。我们寻求参数 $\\varepsilon$，使得方程的残差平方和最小：\n    $$ y_i - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i} = \\varepsilon m_i $$\n    这是活度系数短程部分对质量摩尔浓度的回归。在矩阵形式中，我们求解 $\\mathbf{y}' = \\mathbf{X}\\beta$ 来得到 $\\beta = [\\varepsilon]$，其中 $\\mathbf{y}'$ 是短程贡献的向量，$\\mathbf{X}$ 是质量摩尔浓度 $m_i$ 的列向量。\n3.  **评估拟合**：我们根据拟合的模型计算预测值 $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{pred},1}$，并计算均方根误差：\n    $$ \\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left( (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp},i} - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{pred},1,i} \\right)^2} $$\n4.  **判定**：我们将 RMSE 与阈值 $T=0.05$ 进行比较。\n    -   如果 $\\mathrm{RMSE} \\le T$，则认为曲率“已捕捉”。此用例的结果为 `(True, 0.0)`。\n    -   如果 $\\mathrm{RMSE}  T$，则认为曲率未被捕捉。我们进行下一步。\n5.  **拟合双参数模型**：我们将模型 2 拟合到相同的实验数据。这也是一个线性最小二乘问题，现在有两个参数：\n    $$ y_i - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i} = \\varepsilon m_i + \\kappa m_i^2 $$\n    我们求解 $\\mathbf{y}' = \\mathbf{X}\\beta$ 来得到 $\\beta = [\\varepsilon, \\kappa]^T$，其中设计矩阵 $\\mathbf{X}$ 现在有两列：一个质量摩尔浓度 $m_i$ 的向量和一个质量摩尔浓度平方 $m_i^2$ 的向量。$\\kappa$ 的拟合值就是校正项的系数。此用例的结果为 `(False, kappa_fit)`。\n\n对所有四个测试用例执行此完整过程，以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geochemistry problem by deriving and testing a \n    hybrid activity-coefficient model for CaCl2.\n    \"\"\"\n    # Define physical constants and problem parameters\n    A = 0.509  # Debye-Hückel constant for log10 form\n    B = 0.328  # Debye-Hückel constant for log10 form, in Angstrom^-1\n    RMSE_THRESHOLD = 0.05\n\n    # Define the molality grid for calculations\n    m_grid = np.array([0.1, 0.5, 1.0, 2.0, 3.5, 6.0])\n\n    # Define the test suite. Each tuple contains:\n    # (effective ion-size parameter a_eff [Angstrom], \n    #  true linear short-range coefficient eps_true [(mol/kg)^-1],\n    #  true quadratic short-range coefficient kappa_true [(mol/kg)^-2])\n    test_cases = [\n        (4.0, 0.08, 0.005),   # Case 1: Mild curvature\n        (3.5, 0.04, 0.012),   # Case 2: Strong curvature\n        (4.0, 0.06, 0.000),   # Case 3: Near-linear behavior\n        (4.5, 0.10, -0.004),  # Case 4: Downward curvature\n    ]\n\n    results = []\n\n    # Process each test case\n    for a_eff, eps_true, kappa_true in test_cases:\n        \n        # Step 1: Generate synthetic \"experimental\" data\n        # The generating function is the full 2-parameter model.\n        sqrt_I = np.sqrt(3 * m_grid)\n        dh_term = - (2 * A * sqrt_I) / (1 + B * a_eff * sqrt_I)\n        short_range_true = eps_true * m_grid + kappa_true * m_grid**2\n        y_exp = dh_term + short_range_true\n\n        # Step 2: Fit the 1-parameter hybrid model (DH + linear term)\n        # The model is: log10_gamma = DH_term + eps * m\n        # We perform a linear least squares fit for the parameter eps.\n        # This is equivalent to fitting: y_exp - DH_term = eps * m\n        y_prime = y_exp - dh_term\n        \n        # The design matrix M1 has one column: the molality values.\n        M1 = m_grid[:, np.newaxis]\n        \n        # Solve the linear system M1 * p1 = y_prime for p1 = [eps]\n        p1, _, _, _ = np.linalg.lstsq(M1, y_prime, rcond=None)\n        eps_fit_1 = p1[0]\n\n        # Step 3: Evaluate the 1-parameter fit\n        y_pred_1 = dh_term + eps_fit_1 * m_grid\n        rmse_1 = np.sqrt(np.mean((y_exp - y_pred_1)**2))\n\n        # Step 4: Decision based on RMSE and threshold\n        captured = rmse_1 = RMSE_THRESHOLD\n        \n        if captured:\n            # Curvature captured, no correction term needed.\n            correction_coeff = 0.0\n            results.extend([True, correction_coeff])\n        else:\n            # Curvature not captured, add a correction term and refit.\n            # The model is: log10_gamma = DH_term + eps * m + kappa * m^2\n            # We fit: y_exp - DH_term = eps * m + kappa * m^2\n            \n            # The design matrix M2 has two columns: m and m^2.\n            M2 = np.vstack([m_grid, m_grid**2]).T\n            \n            # Solve the linear system M2 * p2 = y_prime for p2 = [eps, kappa]\n            p2, _, _, _ = np.linalg.lstsq(M2, y_prime, rcond=None)\n            kappa_fit_2 = p2[1]\n            \n            correction_coeff = kappa_fit_2\n            results.extend([False, correction_coeff])\n            \n    # Format and print the final results in the required single-line format.\n    # The output format requires capitalized booleans (True/False) which str() provides.\n    # The list comprehension with map(str,...) achieves the desired formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}