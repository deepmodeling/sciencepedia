{
    "hands_on_practices": [
        {
            "introduction": "在地球化学中，区分基于活度的热力学平衡常数（$K^\\circ$）和基于浓度的条件平衡常数（$K_c$）至关重要。本练习  将指导您使用经典的 Debye-Hückel 理论来估算离子活度系数，这是一个理解电解质溶液非理想性行为的基石模型。通过这个计算，您将能亲手量化在给定离子强度下，非理想性（尤其是不对称价态离子的影响）对化学平衡的实际影响。",
            "id": "4078818",
            "problem": "一个在 $25^{\\circ}\\mathrm{C}$、总离子强度 $I = 0.10$（质量摩尔浓度标度）下的水地球化学体系含有钠和碳酸盐，它们通过以下反应形成一价络合物 $\\mathrm{NaCO_3^-}$\n$$\\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-}.$$\n在标准参考态（无限稀释，$1$ bar）下，以活度定义的热力学平衡常数为 $K^{\\circ} = 10^{1.50}$（无量纲）。使用 $25^{\\circ}\\mathrm{C}$ 下的 Debye–Hückel 活度系数理论，其中常数 $A = 0.509$ 和 $B = 0.328\\,\\text{\\AA}^{-1}$，有效离子尺寸参数 $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$、$a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$ 和 $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$，确定在 $I = 0.10$ 时，如果使用浓度（质量摩尔浓度）代替活度，可以推断出的条件平衡常数 $K_c$。从而量化化合价不对称性（二价 $\\mathrm{CO_3^{2-}}$ 相对于一价 $\\mathrm{Na^+}$ 和 $\\mathrm{NaCO_3^-}$）对表观平衡的影响。\n\n将最终的 $K_c$ 表示为无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它基于水地球化学的既定原理（Debye-Hückel 理论），具有科学依据，提法得当，提供了所有必要数据，并以客观、明确的语言表达。\n\n对于反应\n$$ \\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-} $$\n的热力学平衡常数 $K^{\\circ}$，是根据参与物种的活度 $a_i$ 定义的：\n$$ K^{\\circ} = \\frac{a_{\\mathrm{NaCO_3^-}}}{a_{\\mathrm{Na^+}} a_{\\mathrm{CO_3^{2-}}}} $$\n物种 $i$ 的活度 $a_i$ 与其质量摩尔浓度 $m_i$ 和活度系数 $\\gamma_i$ 通过表达式 $a_i = \\gamma_i m_i$ 相关。将此代入 $K^{\\circ}$ 的定义中可得：\n$$ K^{\\circ} = \\frac{\\gamma_{\\mathrm{NaCO_3^-}} m_{\\mathrm{NaCO_3^-}}}{(\\gamma_{\\mathrm{Na^+}} m_{\\mathrm{Na^+}}) (\\gamma_{\\mathrm{CO_3^{2-}}} m_{\\mathrm{CO_3^{2-}}})} $$\n条件平衡常数 $K_c$ 是使用质量摩尔浓度而非活度定义的：\n$$ K_c = \\frac{m_{\\mathrm{NaCO_3^-}}}{m_{\\mathrm{Na^+}} m_{\\mathrm{CO_3^{2-}}}} $$\n通过结合这些表达式，我们可以将 $K_c$ 与 $K^{\\circ}$ 联系起来：\n$$ K^{\\circ} = K_c \\cdot \\frac{\\gamma_{\\mathrm{NaCO_3^-}}}{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}} $$\n重新整理以求解 $K_c$ 可得：\n$$ K_c = K^{\\circ} \\cdot \\frac{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}}{\\gamma_{\\mathrm{NaCO_3^-}}} $$\n为了求出 $K_c$，我们必须首先计算在指定离子强度 $I = 0.10$ 下三种离子的活度系数。题目指定使用扩展的 Debye-Hückel 方程：\n$$ \\log_{10}(\\gamma_i) = -\\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}} $$\n其中 $z_i$ 是离子 $i$ 的电荷，$a_i$ 是其有效离子尺寸参数，$A$ 和 $B$ 是与温度相关的常数。给定的参数如下：\n- $A = 0.509$\n- $B = 0.328\\,\\text{\\AA}^{-1}$\n- $I = 0.10$ m，所以 $\\sqrt{I} = \\sqrt{0.10} \\approx 0.316228$\n- $K^{\\circ} = 10^{1.50}$，这意味着 $\\log_{10}(K^{\\circ}) = 1.50$\n\n离子特异性参数如下：\n- 对于 $\\mathrm{Na^+}$: $z_{\\mathrm{Na^+}} = +1$, $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$\n- 对于 $\\mathrm{CO_3^{2-}}$: $z_{\\mathrm{CO_3^{2-}}} = -2$, $a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$\n- 对于 $\\mathrm{NaCO_3^-}$: $z_{\\mathrm{NaCO_3^-}} = -1$, $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$\n\n我们现在计算每种物种的活度系数的对数。\n\n对于 $\\mathrm{Na^+}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{Na^+}}) = -\\frac{(0.509) (+1)^2 \\sqrt{0.10}}{1 + (0.328) (4.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.312 \\times 0.316228} = -\\frac{0.160960}{1.41484} \\approx -0.113766 $$\n\n对于 $\\mathrm{CO_3^{2-}}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) = -\\frac{(0.509) (-2)^2 \\sqrt{0.10}}{1 + (0.328) (4.5) \\sqrt{0.10}} = -\\frac{4 \\times 0.509 \\times 0.316228}{1 + 1.476 \\times 0.316228} = -\\frac{0.643841}{1.46672} \\approx -0.439008 $$\n\n对于 $\\mathrm{NaCO_3^-}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) = -\\frac{(0.509) (-1)^2 \\sqrt{0.10}}{1 + (0.328) (5.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.640 \\times 0.316228} = -\\frac{0.160960}{1.51861} \\approx -0.105992 $$\n\n为了求出 $K_c$，最准确的方法是使用对数进行计算：\n$$ \\log_{10}(K_c) = \\log_{10}(K^{\\circ}) + \\log_{10}(\\gamma_{\\mathrm{Na^+}}) + \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) - \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) $$\n代入数值：\n$$ \\log_{10}(K_c) \\approx 1.50 + (-0.113766) + (-0.439008) - (-0.105992) $$\n$$ \\log_{10}(K_c) \\approx 1.50 - 0.113766 - 0.439008 + 0.105992 $$\n$$ \\log_{10}(K_c) \\approx 1.053218 $$\n现在，我们计算 $K_c$：\n$$ K_c = 10^{\\log_{10}(K_c)} \\approx 10^{1.053218} \\approx 11.3023 $$\n题目要求答案四舍五入到四位有效数字。\n$$ K_c \\approx 11.30 $$\n$K_c$ 与 $K^{\\circ}$ 的显著差异（$11.30$ 对比 $10^{1.50} \\approx 31.62$）凸显了该体系中非理想行为的巨大影响，这主要是由碳酸根离子的高电荷（$z = -2$）驱动的，导致其活度系数远低于一价离子。",
            "answer": "$$\\boxed{11.30}$$"
        },
        {
            "introduction": "虽然 Debye-Hückel 理论为教学提供了清晰的范例，但现代地球化学模拟通常依赖于更精确的模型，如 Pitzer 方程。本练习  将推动您从手动计算迈向更通用的编程实现，这是计算地球化学家的核心技能。您的任务是编写一个程序，将不同反应类型（包括涉及溶剂水的反应）的条件平衡常数转换为热力学平衡常数，从而真实地反映自然水体系统的复杂性。",
            "id": "4078771",
            "problem": "您需要实现一个程序，该程序使用 Pitzer 计算的各离子物种的活度系数，将在固定离子强度下测得的条件平衡常数转换为热力学平衡常数。其基本原理是化学势的定义和质量作用定律。考虑一个写成化学计量总和形式的通用反应 $\\sum_i \\nu_i \\mathrm{A}_i = 0$，其中 $\\nu_i$ 是化学计量数，对于产物为正，对于反应物为负。物种 $i$ 的化学势为 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$，其中 $R$ 是普适气体常数，$T$ 是绝对温度，$a_i$ 是活度。在重量摩尔浓度标准态下，活度为 $a_i = m_i \\gamma_i$，其中 $m_i$ 是重量摩尔浓度，$\\gamma_i$ 是活度系数。对于水，其活度为 $a_{\\mathrm{w}}$。条件平衡常数 $K_{\\mathrm{cond}}$ 在操作上通过忽略活度系数来定义（如果水参与反应，则其活度 $a_{\\mathrm{w}} = 1$），因此 $K_{\\mathrm{cond}} = \\prod_i m_i^{\\nu_i}$。您的任务是将 $K_{\\mathrm{cond}}$ 转换为与质量作用定律一致的热力学平衡常数 $K^\\circ$。\n\n您的程序必须：\n- 针对每个测试用例，接受化学计量数 $\\nu_i$、条件平衡常数 $K_{\\mathrm{cond}}$、参与反应溶质的 Pitzer 计算活度系数 $\\gamma_i$，以及当水参与反应时，在给定离子强度下的水活度 $a_{\\mathrm{w}}$。在重量摩尔浓度标准态下，所有量均为无量纲。\n- 基于所提供的数据，计算与质量作用定义一致的热力学平衡常数 $K^\\circ$，不使用问题陈述中提供的任何快捷公式。\n- 将所有测试用例的最终结果以逗号分隔的 Python 风格列表形式（用方括号括起来）单行输出，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$。\n\n测试套件：\n实现您的程序以处理以下五个测试用例。对于每个案例，物种名称是字符串，给出了化学计量数，并提供了在温度 $T$ 等于 $25\\,^\\circ\\mathrm{C}$ 时指定离子强度 $I$ 下的 Pitzer 计算活度系数；活度是无量纲的。\n\n- 案例 A（1:1 型电解质中中性离子对的形成）：在离子强度 $I = \\,0.7$（重量摩尔浓度标度）下，反应 $\\mathrm{Na}^+ + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{NaCl}^0$。\n  - 化学计量：$\\nu_{\\mathrm{NaCl}^0} = +1$，$\\nu_{\\mathrm{Na}^+} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。\n  - 条件常数：$K_{\\mathrm{cond}} = \\,1.6$。\n  - Pitzer 计算的活度系数：$\\gamma_{\\mathrm{Na}^+} = \\,0.74$，$\\gamma_{\\mathrm{Cl}^-} = \\,0.74$，$\\gamma_{\\mathrm{NaCl}^0} = \\,1.00$。\n  - 水不参与反应。\n\n- 案例 B（带电络合物的形成）：在离子强度 $I = \\,1.0$（重量摩尔浓度标度）下，反应 $\\mathrm{Mg}^{2+} + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{MgCl}^+$。\n  - 化学计量：$\\nu_{\\mathrm{MgCl}^+} = +1$，$\\nu_{\\mathrm{Mg}^{2+}} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。\n  - 条件常数：$K_{\\mathrm{cond}} = \\,0.25$。\n  - Pitzer 计算的活度系数：$\\gamma_{\\mathrm{Mg}^{2+}} = \\,0.30$，$\\gamma_{\\mathrm{Cl}^-} = \\,0.70$，$\\gamma_{\\mathrm{MgCl}^+} = \\,0.50$。\n  - 水不参与反应。\n\n- 案例 C（质子化形成中性物种）：在离子强度 $I = \\,0.5$ 下，反应 $\\mathrm{H}^+ + \\mathrm{HCO}_3^- \\rightleftharpoons \\mathrm{H}_2\\mathrm{CO}_3^0$。\n  - 化学计量：$\\nu_{\\mathrm{H}_2\\mathrm{CO}_3^0} = +1$，$\\nu_{\\mathrm{H}^+} = -1$，$\\nu_{\\mathrm{HCO}_3^-} = -1$。\n  - 条件常数：$K_{\\mathrm{cond}} = \\,1.8 \\times 10^{-7}$。\n  - Pitzer 计算的活度系数：$\\gamma_{\\mathrm{H}^+} = \\,0.85$，$\\gamma_{\\mathrm{HCO}_3^-} = \\,0.75$，$\\gamma_{\\mathrm{H}_2\\mathrm{CO}_3^0} = \\,1.00$。\n  - 水不参与反应。\n\n- 案例 D（有明确水活度的水解）：在离子强度 $I = \\,0.7$ 下，反应 $\\mathrm{CO}_3^{2-} + \\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{HCO}_3^- + \\mathrm{OH}^-$。\n  - 化学计量：$\\nu_{\\mathrm{HCO}_3^-} = +1$，$\\nu_{\\mathrm{OH}^-} = +1$，$\\nu_{\\mathrm{CO}_3^{2-}} = -1$，$\\nu_{\\mathrm{H}_2\\mathrm{O}} = -1$。\n  - 条件常数：$K_{\\mathrm{cond}} = \\,3.5 \\times 10^{-4}$。\n  - Pitzer 计算的活度系数：$\\gamma_{\\mathrm{HCO}_3^-} = \\,0.65$，$\\gamma_{\\mathrm{OH}^-} = \\,0.65$，$\\gamma_{\\mathrm{CO}_3^{2-}} = \\,0.25$。\n  - 水活度：$a_{\\mathrm{w}} = \\,0.98$。\n\n- 案例 E（极稀的 1:1 型电解质极限）：在离子强度 $I \\approx \\,0.0$ 下，反应 $\\mathrm{K}^+ + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{KCl}^0$。\n  - 化学计量：$\\nu_{\\mathrm{KCl}^0} = +1$，$\\nu_{\\mathrm{K}^+} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。\n  - 条件常数：$K_{\\mathrm{cond}} = \\,0.30$。\n  - Pitzer 计算的活度系数：$\\gamma_{\\mathrm{K}^+} = \\,1.00$，$\\gamma_{\\mathrm{Cl}^-} = \\,1.00$，$\\gamma_{\\mathrm{KCl}^0} = \\,1.00$。\n  - 水不参与反应。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[k_1,k_2,k_3,k_4,k_5]$，其中每个 $k_j$ 是相应测试用例计算出的热力学平衡常数 $K^\\circ$（一个浮点数）。不应打印任何额外的文本。",
            "solution": "该问题陈述经验证具有科学根据、问题明确且客观。它基于化学热力学的既定原理。所提供的数据完整且一致，可以得出唯一且有意义的解。任务是使用提供的活度系数，将条件平衡常数 $K_{\\mathrm{cond}}$ 转换为其热力学对应值 $K^\\circ$。我们将从第一性原理推导所需的关系式。\n\n对于反应 $\\sum_i \\nu_i \\mathrm{A}_i = 0$，化学平衡的基本条件是反应吉布斯自由能 $\\Delta_r G$ 为零。这表示为参与物种的化学势 $\\mu_i$ 按其化学计量数 $\\nu_i$ 加权的总和：\n$$ \\Delta_r G = \\sum_i \\nu_i \\mu_i = 0 $$\n溶液中物种 $i$ 的化学势定义为相对于其标准态化学势 $\\mu_i^\\circ$ 的关系式 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$，其中 $R$ 是普适气体常数，$T$ 是绝对温度，$a_i$ 是物种 $i$ 的活度。将此代入平衡条件中得到：\n$$ \\sum_i \\nu_i (\\mu_i^\\circ + RT \\ln a_i) = 0 $$\n重新整理此表达式，将标准态项与活度项分开：\n$$ \\sum_i \\nu_i \\mu_i^\\circ = -RT \\sum_i \\nu_i \\ln a_i $$\n左侧的项是标准反应吉布斯自由能 $\\Delta_r G^\\circ$。右侧的项可以使用对数的性质简化为：$-RT \\ln (\\prod_i a_i^{\\nu_i})$。热力学平衡常数 $K^\\circ$ 由关系式 $\\Delta_r G^\\circ = -RT \\ln K^\\circ$ 定义。比较这些表达式，直接得出以活度表示的质量作用定律：\n$$ K^\\circ = \\prod_i a_i^{\\nu_i} $$\n这个方程是我们计算的基础。溶质物种 $i$ 的活度 $a_i$ 是其重量摩尔浓度 $m_i$ 与其重量摩尔活度系数 $\\gamma_i$ 的乘积，即 $a_i = m_i \\gamma_i$。对于溶剂水，其活度表示为 $a_{\\mathrm{w}}$。展开 $K^\\circ$ 的表达式得到：\n$$ K^\\circ = \\left( \\prod_{i \\in \\text{solutes}} (m_i \\gamma_i)^{\\nu_i} \\right) (a_{\\mathrm{w}})^{\\nu_{\\mathrm{w}}} $$\n请注意，如果水不参与反应，则 $\\nu_{\\mathrm{w}}$ 为零。我们可以将重量摩尔浓度项与活度系数项分开：\n$$ K^\\circ = \\left( \\prod_{i \\in \\text{solutes}} m_i^{\\nu_i} \\right) \\left( \\prod_{i \\in \\text{solutes}} \\gamma_i^{\\nu_i} \\right) (a_{\\mathrm{w}})^{\\nu_{\\mathrm{w}}} $$\n问题将条件平衡常数定义为 $K_{\\mathrm{cond}} = \\prod_i m_i^{\\nu_i}$，并阐明对于涉及水的反应，其活度被视为单位 1。这意味着 $K_{\\mathrm{cond}}$ 的乘积仅涵盖溶质物种，这是地球化学中定义表观或条件常数的标准惯例。因此，我们定义 $K_{\\mathrm{cond}} = \\prod_{i \\in \\text{solutes}} m_i^{\\nu_i}$。将此代入我们对 $K^\\circ$ 的表达式中，得到最终的转换公式：\n$$ K^\\circ = K_{\\mathrm{cond}} \\cdot \\left( \\prod_{i \\in \\text{solutes}} \\gamma_i^{\\nu_i} \\right) \\cdot (a_{\\mathrm{w}})^{\\nu_{\\mathrm{w}}} $$\n我们现在将此公式应用于每个测试用例。\n\n案例 A：反应 $\\mathrm{Na}^+ + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{NaCl}^0$。\n化学计量：$\\nu_{\\mathrm{NaCl}^0} = +1$，$\\nu_{\\mathrm{Na}^+} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。水不参与反应，因此 $\\nu_{\\mathrm{w}} = 0$。\n转换公式为 $K^\\circ = K_{\\mathrm{cond}} \\cdot (\\gamma_{\\mathrm{NaCl}^0})^{+1} (\\gamma_{\\mathrm{Na}^+})^{-1} (\\gamma_{\\mathrm{Cl}^-})^{-1} = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{NaCl}^0}}{\\gamma_{\\mathrm{Na}^+} \\gamma_{\\mathrm{Cl}^-}}$。\n已知 $K_{\\mathrm{cond}} = 1.6$，$\\gamma_{\\mathrm{Na}^+} = 0.74$，$\\gamma_{\\mathrm{Cl}^-} = 0.74$，以及 $\\gamma_{\\mathrm{NaCl}^0} = 1.00$。\n$$ K^\\circ = 1.6 \\cdot \\frac{1.00}{0.74 \\cdot 0.74} = \\frac{1.6}{0.5476} \\approx 2.92184 $$\n\n案例 B：反应 $\\mathrm{Mg}^{2+} + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{MgCl}^+$。\n化学计量：$\\nu_{\\mathrm{MgCl}^+} = +1$，$\\nu_{\\mathrm{Mg}^{2+}} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。水不参与反应（$\\nu_{\\mathrm{w}} = 0$）。\n转换公式为 $K^\\circ = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{MgCl}^+}}{\\gamma_{\\mathrm{Mg}^{2+}} \\gamma_{\\mathrm{Cl}^-}}$。\n已知 $K_{\\mathrm{cond}} = 0.25$，$\\gamma_{\\mathrm{Mg}^{2+}} = 0.30$，$\\gamma_{\\mathrm{Cl}^-} = 0.70$，以及 $\\gamma_{\\mathrm{MgCl}^+} = 0.50$。\n$$ K^\\circ = 0.25 \\cdot \\frac{0.50}{0.30 \\cdot 0.70} = \\frac{0.125}{0.21} \\approx 0.59524 $$\n\n案例 C：反应 $\\mathrm{H}^+ + \\mathrm{HCO}_3^- \\rightleftharpoons \\mathrm{H}_2\\mathrm{CO}_3^0$。\n化学计量：$\\nu_{\\mathrm{H}_2\\mathrm{CO}_3^0} = +1$，$\\nu_{\\mathrm{H}^+} = -1$，$\\nu_{\\mathrm{HCO}_3^-} = -1$。水不参与反应（$\\nu_{\\mathrm{w}} = 0$）。\n转换公式为 $K^\\circ = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{H}_2\\mathrm{CO}_3^0}}{\\gamma_{\\mathrm{H}^+} \\gamma_{\\mathrm{HCO}_3^-}}$。\n已知 $K_{\\mathrm{cond}} = 1.8 \\times 10^{-7}$，$\\gamma_{\\mathrm{H}^+} = 0.85$，$\\gamma_{\\mathrm{HCO}_3^-} = 0.75$，以及 $\\gamma_{\\mathrm{H}_2\\mathrm{CO}_3^0} = 1.00$。\n$$ K^\\circ = 1.8 \\times 10^{-7} \\cdot \\frac{1.00}{0.85 \\cdot 0.75} = \\frac{1.8 \\times 10^{-7}}{0.6375} \\approx 2.8235 \\times 10^{-7} $$\n\n案例 D：反应 $\\mathrm{CO}_3^{2-} + \\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{HCO}_3^- + \\mathrm{OH}^-$。\n化学计量：$\\nu_{\\mathrm{HCO}_3^-} = +1$，$\\nu_{\\mathrm{OH}^-} = +1$，$\\nu_{\\mathrm{CO}_3^{2-}} = -1$，$\\nu_{\\mathrm{H}_2\\mathrm{O}} = -1$。水是反应物。\n转换公式为 $K^\\circ = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{HCO}_3^-} \\gamma_{\\mathrm{OH}^-}}{\\gamma_{\\mathrm{CO}_3^{2-}}} \\cdot (a_{\\mathrm{w}})^{-1} = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{HCO}_3^-} \\gamma_{\\mathrm{OH}^-}}{\\gamma_{\\mathrm{CO}_3^{2-}} \\cdot a_{\\mathrm{w}}}$。\n已知 $K_{\\mathrm{cond}} = 3.5 \\times 10^{-4}$，$\\gamma_{\\mathrm{HCO}_3^-} = 0.65$，$\\gamma_{\\mathrm{OH}^-} = 0.65$，$\\gamma_{\\mathrm{CO}_3^{2-}} = 0.25$，以及 $a_{\\mathrm{w}} = 0.98$。\n$$ K^\\circ = 3.5 \\times 10^{-4} \\cdot \\frac{0.65 \\cdot 0.65}{0.25 \\cdot 0.98} = 3.5 \\times 10^{-4} \\cdot \\frac{0.4225}{0.245} \\approx 6.0357 \\times 10^{-4} $$\n\n案例 E：反应 $\\mathrm{K}^+ + \\mathrm{Cl}^- \\rightleftharpoons \\mathrm{KCl}^0$。\n这个案例代表无限稀释的极限（$I \\approx 0.0$）。在此极限下，所有活度系数都趋近于 1。\n化学计量：$\\nu_{\\mathrm{KCl}^0} = +1$，$\\nu_{\\mathrm{K}^+} = -1$，$\\nu_{\\mathrm{Cl}^-} = -1$。水不参与反应（$\\nu_{\\mathrm{w}} = 0$）。\n转换公式为 $K^\\circ = K_{\\mathrm{cond}} \\cdot \\frac{\\gamma_{\\mathrm{KCl}^0}}{\\gamma_{\\mathrm{K}^+} \\gamma_{\\mathrm{Cl}^-}}$。\n已知 $K_{\\mathrm{cond}} = 0.30$，$\\gamma_{\\mathrm{K}^+} = 1.00$，$\\gamma_{\\mathrm{Cl}^-} = 1.00$，以及 $\\gamma_{\\mathrm{KCl}^0} = 1.00$。\n$$ K^\\circ = 0.30 \\cdot \\frac{1.00}{1.00 \\cdot 1.00} = 0.30 $$\n正如预期的那样，在无限稀释的标准状态下，热力学常数等于条件常数，因为所有活度校正都变为 1。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the thermodynamic equilibrium constant K° from the conditional \n    equilibrium constant K_cond and activity coefficients/water activity.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"stoichiometry\": {\"NaCl^0\": 1, \"Na+\": -1, \"Cl-\": -1},\n            \"k_cond\": 1.6,\n            \"gammas\": {\"Na+\": 0.74, \"Cl-\": 0.74, \"NaCl^0\": 1.00},\n            \"a_w\": None\n        },\n        {\n            \"stoichiometry\": {\"MgCl+\": 1, \"Mg^2+\": -1, \"Cl-\": -1},\n            \"k_cond\": 0.25,\n            \"gammas\": {\"Mg^2+\": 0.30, \"Cl-\": 0.70, \"MgCl+\": 0.50},\n            \"a_w\": None\n        },\n        {\n            \"stoichiometry\": {\"H2CO3^0\": 1, \"H+\": -1, \"HCO3-\": -1},\n            \"k_cond\": 1.8e-7,\n            \"gammas\": {\"H+\": 0.85, \"HCO3-\": 0.75, \"H2CO3^0\": 1.00},\n            \"a_w\": None\n        },\n        {\n            \"stoichiometry\": {\"HCO3-\": 1, \"OH-\": 1, \"CO3^2-\": -1, \"H2O\": -1},\n            \"k_cond\": 3.5e-4,\n            \"gammas\": {\"HCO3-\": 0.65, \"OH-\": 0.65, \"CO3^2-\": 0.25},\n            \"a_w\": 0.98\n        },\n        {\n            \"stoichiometry\": {\"KCl^0\": 1, \"K+\": -1, \"Cl-\": -1},\n            \"k_cond\": 0.30,\n            \"gammas\": {\"K+\": 1.00, \"Cl-\": 1.00, \"KCl^0\": 1.00},\n            \"a_w\": None\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        k_cond = case[\"k_cond\"]\n        stoichiometry = case[\"stoichiometry\"]\n        gammas = case[\"gammas\"]\n        a_w = case[\"a_w\"]\n\n        # Calculate the product of activity coefficients of solutes,\n        # each raised to the power of its stoichiometric number.\n        # Product(gamma_i ^ nu_i) for i != H2O\n        gamma_product = 1.0\n        for species, nu in stoichiometry.items():\n            if species != \"H2O\":\n                gamma_product *= gammas[species] ** nu\n        \n        # Start with K° = K_cond * Product(gamma_i ^ nu_i)\n        k_circ = k_cond * gamma_product\n\n        # If water participates in the reaction, include its activity term.\n        if \"H2O\" in stoichiometry:\n            nu_h2o = stoichiometry[\"H2O\"]\n            if a_w is not None:\n                k_circ *= (a_w ** nu_h2o)\n\n        results.append(k_circ)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "化学平衡不仅受溶液化学组成的影响，也深刻地依赖于温度和压力等物理条件。本练习  是一项高级实践，旨在模拟平衡常数对压力的依赖性，这对于理解热液和深地地球化学过程至关重要。您需要从基本热力学关系出发，应用 Helgeson–Kirkham–Flowers (HKF) 状态方程来计算高压条件下的平衡常数 $K$，从而掌握如何将系统的物理状态变化整合到平衡计算中。",
            "id": "4078762",
            "problem": "您的任务是实现一个程序，通过引入由 Helgeson–Kirkham–Flowers (HKF) 状态方程描述的、与压力相关的偏摩尔体积，计算指定水热氧化还原反应在不同温度和压力下的平衡常数。请从基本热力学关系出发，而不是使用预设的简化公式，推导出非理想压力下平衡常数与反应吉布斯能之间的联系。请使用以下科学合理且自洽的场景和数据，并精确执行所有单位换算。\n\n给定反应和条件：\n- 水热氧化还原反应：$\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$。\n- 目标温度：$T = 673.15\\,\\mathrm{K}$ (对应 $400\\,^{\\circ}\\mathrm{C}$)。\n- 参考压力：$P_\\mathrm{ref} = 1\\,\\mathrm{bar}$。\n- 溶剂 HKF 参数：$\\omega = 2600\\,\\mathrm{bar}$。\n- 在 $T$ 和 $P_\\mathrm{ref}$ 下的标准反应吉布斯能：$\\Delta G_\\mathrm{rxn}(T,P_\\mathrm{ref}) = -2.20\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$。\n\n与压力相关的偏摩尔体积（无限稀释下的 HKF 型替代函数形式）：\n对于每种物质 $i$，在固定温度 $T$ 下，其偏摩尔体积作为压力的函数由下式给出：\n$$\n\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P},\n$$\n其中，$v_{0,i}$ 的单位是 $\\mathrm{cm^3\\,mol^{-1}}$，$m_i$ 的单位是 $\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_i$ 的单位是 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$。该替代函数通过一个反比项 $(\\omega + P)$ 和低阶可压缩性贡献，捕捉了 HKF 型行为所隐含的显著压力依赖性。\n\n物质参数（在 $T = 673.15\\,\\mathrm{K}$ 时）：\n- 对于 $\\mathrm{H_2(aq)}$：$v_{0,\\mathrm{H_2}} = 23.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{H_2}} = -1.0\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{H_2}} = 600.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n- 对于 $\\mathrm{O_2(aq)}$：$v_{0,\\mathrm{O_2}} = 30.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{O_2}} = -1.2\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{O_2}} = 500.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n- 对于 $\\mathrm{H_2O(l)}$：$v_{0,\\mathrm{H_2O}} = 26.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{H_2O}} = -0.8\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{H_2O}} = 400.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n\n用于反应吉布斯能求和的化学计量系数 $\\nu_i$：\n- $\\nu_{\\mathrm{H_2O}} = +1$，$\\nu_{\\mathrm{H_2}} = -1$，$\\nu_{\\mathrm{O_2}} = -\\tfrac{1}{2}$。\n\n在您的推导和实现中使用的基本原理：\n- 平衡条件将平衡常数与由标准化学势（无限稀释下的活度）构成的反应吉布斯能联系起来。\n- 在恒定温度下，物质 $i$ 的化学势对压力的偏导数等于其偏摩尔体积，即 $\\left(\\partial \\mu_i / \\partial P\\right)_T = \\bar{V}_i(T,P)$。\n- 反应吉布斯能的压力依赖性通过对按化学计量加权的各物质贡献进行积分得到。\n\n要求和单位：\n- 通过对与压力相关的反应偏摩尔体积从 $P_\\mathrm{ref}$ 到 $P$ 进行积分，实现 $\\Delta G_\\mathrm{rxn}(T,P)$ 在给定 $P$ 下的计算。请仔细转换单位：在压力积分中使用 $\\mathrm{bar}$ 作为压力单位，但使用 $1\\,\\mathrm{bar} = 10^{5}\\,\\mathrm{Pa}$ 和 $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$ 将积分得到的 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 项转换为 $\\mathrm{J\\,mol^{-1}}$。最终的平衡常数 $K$ 表示为一个无量纲浮点数。\n- 使用普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 温度 $T$ 固定在 $673.15\\,\\mathrm{K}$；不需要进行温度积分。\n\n测试组：\n计算以下压力（单位为 $\\mathrm{bar}$）下的平衡常数 $K(T,P)$：\n- 情况 1：$P = 500.0$（目标水热条件）。\n- 情况 2：$P = 1.0$（参考压力下的边界条件）。\n- 情况 3：$P = 3000.0$（远高于 $\\omega$ 标度的高压边缘情况）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\mathrm{result_1},\\mathrm{result_2},\\mathrm{result_3}\\right]$，其中每个条目是对应测试用例计算出的 $K(T,P)$，格式为标准的 Python 浮点数。不应打印任何其他文本。",
            "solution": "该问题是有效的，因为它在科学上基于基本热力学，提供了所有必要的数据，问题陈述明确且客观。我们将进行逐步推导和求解。\n\n问题的核心是确定化学反应在指定温度 $T$ 和压力 $P$ 下的平衡常数 $K$。平衡常数与标准反应吉布斯能 $\\Delta G^\\circ_\\mathrm{rxn}$ 之间的基本关系由下式给出：\n$$\n\\Delta G^\\circ_\\mathrm{rxn}(T, P) = - R T \\ln K(T, P)\n$$\n其中 $R$ 是普适气体常数。对于无限稀释的水溶液物质，反应吉布斯能 $\\Delta G_\\mathrm{rxn}$ 扮演标准态值的角色。因此，我们有：\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = - R T \\ln K(T, P)\n$$\n我们的主要任务是，在给定参考压力 $P_\\mathrm{ref}$ 下的 $\\Delta G_\\mathrm{rxn}$ 值的情况下，计算目标压力 $P$ 下的 $\\Delta G_\\mathrm{rxn}$。\n\n在恒定温度下，系统吉布斯能的压力依赖性由以下基本热力学关系描述：\n$$\n\\left( \\frac{\\partial G}{\\partial P} \\right)_T = V\n$$\n将此应用于单个物质 $i$ 的化学势 $\\mu_i$ 和偏摩尔体积 $\\bar{V}_i$：\n$$\n\\left( \\frac{\\partial \\mu_i}{\\partial P} \\right)_T = \\bar{V}_i(T, P)\n$$\n反应吉布斯能是产物的化学势之和减去反应物的化学势之和，并按其化学计量系数 $\\nu_i$ 加权：\n$$\n\\Delta G_\\mathrm{rxn} = \\sum_i \\nu_i \\mu_i\n$$\n在恒定温度下对压力求导，得到反应吉布斯能的压力依赖性：\n$$\n\\left( \\frac{\\partial \\Delta G_\\mathrm{rxn}}{\\partial P} \\right)_T = \\sum_i \\nu_i \\left( \\frac{\\partial \\mu_i}{\\partial P} \\right)_T = \\sum_i \\nu_i \\bar{V}_i(T, P) = \\Delta \\bar{V}_\\mathrm{rxn}(T, P)\n$$\n其中 $\\Delta \\bar{V}_\\mathrm{rxn}$ 是反应偏摩尔体积。\n\n为了求出在目标压力 $P$ 下的 $\\Delta G_\\mathrm{rxn}$，我们将此表达式从参考压力 $P_\\mathrm{ref}$ 积分到 $P$：\n$$\n\\int_{P_\\mathrm{ref}}^{P} d(\\Delta G_\\mathrm{rxn}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\n这给出了以下关系：\n$$\n\\Delta G_\\mathrm{rxn}(T, P) - \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) + \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\n积分项表示由于压力从 $P_\\mathrm{ref}$ 变化到 $P$ 而对吉布斯能的校正。\n\n首先，我们必须根据给定的各物质函数形式 $\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P}$，构建反应偏摩尔体积 $\\Delta \\bar{V}_\\mathrm{rxn}(T, P)$ 的表达式。\n$$\n\\Delta \\bar{V}_\\mathrm{rxn}(T, P) = \\sum_i \\nu_i \\bar{V}_i = \\sum_i \\nu_i \\left( v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P} \\right)\n$$\n我们定义反应参数 $\\Delta v_0$、$\\Delta m$ 和 $\\Delta k$ 如下：\n$$\n\\Delta v_0 = \\sum_i \\nu_i v_{0,i} \\quad ; \\quad \\Delta m = \\sum_i \\nu_i m_i \\quad ; \\quad \\Delta k = \\sum_i \\nu_i k_i\n$$\n反应为 $\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$，化学计量系数为 $\\nu_{\\mathrm{H_2O}} = +1$、$\\nu_{\\mathrm{H_2}} = -1$ 和 $\\nu_{\\mathrm{O_2}} = -1/2$。使用提供的参数：\n$$\n\\Delta v_0 = (1)(26.0) + (-1)(23.0) + (-0.5)(30.0) = 26.0 - 23.0 - 15.0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}\n$$\n$$\n\\Delta m = (1)(-0.8 \\times 10^{-3}) + (-1)(-1.0 \\times 10^{-3}) + (-0.5)(-1.2 \\times 10^{-3}) = (-0.8 + 1.0 + 0.6) \\times 10^{-3} = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}\n$$\n$$\n\\Delta k = (1)(400.0) + (-1)(600.0) + (-0.5)(500.0) = 400.0 - 600.0 - 250.0 = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n因此，反应偏摩尔体积为：\n$$\n\\Delta \\bar{V}_\\mathrm{rxn}(T, P) = \\Delta v_0 + \\Delta m (P - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P}\n$$\n\n接下来，我们计算压力积分项，记为 $\\Delta G_P$：\n$$\n\\Delta G_P = \\int_{P_\\mathrm{ref}}^{P} \\left( \\Delta v_0 + \\Delta m (P' - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P'} \\right) dP'\n$$\n对每一项进行解析积分：\n$$\n\\Delta G_P = \\left[ \\Delta v_0 P' \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\frac{\\Delta m}{2} (P' - P_\\mathrm{ref})^2 \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\Delta k \\ln(\\omega + P') \\right]_{P_\\mathrm{ref}}^{P}\n$$\n$$\n\\Delta G_P = \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right)\n$$\n该表达式给出的压力校正项单位为 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$。我们必须使用给定的转换因子将其转换为 $\\mathrm{J\\,mol^{-1}}$：$1\\,\\mathrm{bar} = 10^5\\,\\mathrm{Pa}$ 和 $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$。\n$$\n1\\,\\mathrm{cm^3\\,bar} = (10^{-6}\\,\\mathrm{m^3}) \\times (10^5\\,\\mathrm{Pa}) = 10^{-1}\\,\\mathrm{m^3\\,Pa} = 0.1\\,\\mathrm{J}\n$$\n因此，以焦耳每摩尔为单位的吉布斯能校正值为积分表达式值的 $0.1$ 倍。\n\n在压力 $P$ 下，反应吉布斯能的完整表达式为：\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) + 0.1 \\times \\left[ \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right) \\right]\n$$\n最后，我们可以计算平衡常数 $K(T, P)$：\n$$\nK(T, P) = \\exp \\left( - \\frac{\\Delta G_\\mathrm{rxn}(T, P)}{R T} \\right)\n$$\n我们拥有所有必要的常数和参数：\n- $T = 673.15\\,\\mathrm{K}$\n- $P_\\mathrm{ref} = 1.0\\,\\mathrm{bar}$\n- $\\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = -2.20 \\times 10^5\\,\\mathrm{J\\,mol^{-1}}$\n- $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $\\omega = 2600.0\\,\\mathrm{bar}$\n- $\\Delta v_0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}$\n- $\\Delta m = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$\n- $\\Delta k = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$\n\n现在我们将实现此逻辑，以计算三个指定压力下的平衡常数 $K$。对于每个压力 $P$，我们将计算压力校正项，将其加到 $\\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref})$ 上以获得 $\\Delta G_\\mathrm{rxn}(T, P)$，然后使用最终的吉布斯能求出 $K$。\n\n对于情况 1，其中 $P = 500.0\\,\\mathrm{bar}$：\n以 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 为单位的压力校正项为：\n$$\n\\Delta G_P = (-12.0)(500-1) + \\frac{0.8\\times 10^{-3}}{2}(500-1)^2 + (-450.0)\\ln\\left(\\frac{2600+500}{2600+1}\\right) \\approx -5967.38\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n以 $\\mathrm{J\\,mol^{-1}}$ 为单位，这是 $-596.74\\,\\mathrm{J\\,mol^{-1}}$。\n$$\n\\Delta G_\\mathrm{rxn}(T, 500\\,\\mathrm{bar}) = -220000 - 596.74 = -220596.74\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 500\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220596.74}{8.314462618 \\times 673.15}\\right)\n$$\n\n对于情况 2，其中 $P = 1.0\\,\\mathrm{bar}$：\n由于 $P = P_\\mathrm{ref}$，压力校正积分为零。\n$$\n\\Delta G_\\mathrm{rxn}(T, 1\\,\\mathrm{bar}) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = -220000\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 1\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220000}{8.314462618 \\times 673.15}\\right)\n$$\n\n对于情况 3，其中 $P = 3000.0\\,\\mathrm{bar}$：\n以 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 为单位的压力校正项为：\n$$\n\\Delta G_P = (-12.0)(3000-1) + \\frac{0.8\\times 10^{-3}}{2}(3000-1)^2 + (-450.0)\\ln\\left(\\frac{2600+3000}{2600+1}\\right) \\approx -32735.49\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n以 $\\mathrm{J\\,mol^{-1}}$ 为单位，这是 $-3273.55\\,\\mathrm{J\\,mol^{-1}}$。\n$$\n\\Delta G_\\mathrm{rxn}(T, 3000\\,\\mathrm{bar}) = -220000 - 3273.55 = -223273.55\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 3000\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-223273.55}{8.314462618 \\times 673.15}\\right)\n$$\n最终的代码将以全精度执行这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium constant for a hydrothermal reaction as a function of pressure,\n    based on the Helgeson–Kirkham–Flowers (HKF) equations of state for partial molar volumes.\n    \"\"\"\n    \n    # --- Givens and Constants ---\n    \n    # Thermodynamic conditions and constants\n    T = 673.15  # Temperature in Kelvin (400 C)\n    P_ref = 1.0  # Reference pressure in bar\n    G_rxn_ref = -2.20e5  # Standard reaction Gibbs energy at T and P_ref (J/mol)\n    R = 8.314462618  # Universal gas constant (J/mol/K)\n    \n    # Solvent HKF parameter\n    omega = 2600.0  # Solvent HKF parameter (bar)\n    \n    # Stoichiometric coefficients for H2(aq) + 0.5*O2(aq) - H2O(l)\n    nu = {\n        'H2O': 1.0,\n        'H2': -1.0,\n        'O2': -0.5\n    }\n    \n    # Species parameters for partial molar volume at T\n    # v0: cm^3/mol\n    # m: cm^3/mol/bar\n    # k: cm^3*bar/mol\n    species_params = {\n        'H2':  {'v0': 23.0, 'm': -1.0e-3, 'k': 600.0},\n        'O2':  {'v0': 30.0, 'm': -1.2e-3, 'k': 500.0},\n        'H2O': {'v0': 26.0, 'm': -0.8e-3, 'k': 400.0}\n    }\n\n    # --- Derivation Implementation ---\n\n    # 1. Calculate reaction parameters (Delta_v0, Delta_m, Delta_k)\n    # These are summations of species parameters weighted by stoichiometry.\n    delta_v0 = sum(nu[s] * species_params[s]['v0'] for s in species_params)\n    delta_m = sum(nu[s] * species_params[s]['m'] for s in species_params)\n    delta_k = sum(nu[s] * species_params[s]['k'] for s in species_params)\n\n    # 2. Define a function to calculate K at a given pressure P\n    def calculate_K(P_bar):\n        \"\"\"\n        Calculates the equilibrium constant K at a given pressure P.\n\n        Args:\n            P_bar (float): The target pressure in bar.\n\n        Returns:\n            float: The dimensionless equilibrium constant K.\n        \"\"\"\n        # The change in Gibbs energy due to pressure is the integral of\n        # Delta_V_rxn from P_ref to P.\n        # Delta G_P = integral(Delta_v0 + Delta_m*(P'-P_ref) + Delta_k/(omega+P')) dP'\n        \n        # Analytically integrated terms\n        p_diff = P_bar - P_ref\n        \n        term1 = delta_v0 * p_diff\n        term2 = 0.5 * delta_m * p_diff**2\n        \n        # Handle the logarithm term carefully to avoid log(1) issues if P=P_ref\n        if P_bar == P_ref:\n            term3 = 0.0\n        else:\n            term3 = delta_k * np.log((omega + P_bar) / (omega + P_ref))\n        \n        # Total pressure correction in cm^3*bar/mol\n        delta_G_P_units = term1 + term2 + term3\n        \n        # Convert pressure correction from cm^3*bar/mol to J/mol\n        # 1 cm^3*bar = (1e-6 m^3) * (1e5 Pa) = 0.1 J\n        delta_G_P_J_mol = delta_G_P_units * 0.1\n        \n        # Calculate final Gibbs energy at pressure P\n        G_rxn_final = G_rxn_ref + delta_G_P_J_mol\n        \n        # Calculate the equilibrium constant K\n        # K = exp(-Delta_G_rxn / (R*T))\n        RT = R * T\n        K = np.exp(-G_rxn_final / RT)\n        \n        return K\n\n    # --- Test Suite Execution ---\n    \n    # Define the test cases from the problem statement\n    test_cases_P = [\n        500.0,   # Case 1: Target hydrothermal condition\n        1.0,     # Case 2: Boundary condition at reference pressure\n        3000.0   # Case 3: High-pressure edge case\n    ]\n\n    results = []\n    for P in test_cases_P:\n        K_val = calculate_K(P)\n        results.append(K_val)\n\n    # --- Final Output ---\n    # The final print statement must be in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}