{
    "hands_on_practices": [
        {
            "introduction": "我们从一个材料科学中的实例开始，将化学势这一抽象概念具体化。本练习将演示如何利用可实验测量的活度，计算溶液中某组分（钢中的碳）相对于其标准态的化学势。这构成了连接热力学理论与实际测量的关键桥梁 。",
            "id": "1288847",
            "problem": "在用于硬化钢制部件的高温渗碳工艺中，将一个钢样品置于富碳气氛中，并保持在 1000 °C 的恒定温度下。达到平衡后，测得溶解在钢中的碳的热力学活度 ($a_C$) 为 0.5。碳活度的标准态定义为在相同温度和压力下的纯石墨。\n\n计算在此温度下，钢中碳的化学势相对于其标准态（纯石墨）下碳的化学势。使用普适气体常数 $R = 8.314 \\text{ J/(mol·K)}$。将最终答案以千焦每摩尔 (kJ/mol) 为单位表示，并四舍五入到三位有效数字。",
            "solution": "相中溶质的化学势相对于其标准态由以下活度表达式给出\n$$\\mu_{C} = \\mu_{C}^{\\circ} + RT \\ln a_{C}.$$\n因此，相对于标准态的差值为\n$$\\Delta \\mu_{C} \\equiv \\mu_{C} - \\mu_{C}^{\\circ} = RT \\ln a_{C}.$$\n\n已知 $a_{C} = 0.5$，温度 $T$ 为 $1000$ 摄氏度，将其转换为开尔文：\n$$T = 1000 + 273.15 = 1273.15 \\text{ K}.$$\n代入数值：\n$$\\Delta \\mu_{C} = \\left(8.314 \\text{ J mol}^{-1} \\text{ K}^{-1}\\right)\\left(1273.15 \\text{ K}\\right)\\ln(0.5).$$\n使用 $\\ln(0.5) = -\\ln 2$：\n$$\\Delta \\mu_{C} = \\left(8.314 \\times 1273.15\\right)\\left(-0.693147\\right) \\text{ J mol}^{-1}.$$\n计算 $RT$ 和乘积：\n$$RT = 10584.9691 \\text{ J mol}^{-1}, \\quad \\Delta \\mu_{C} \\approx -7336.94 \\text{ J mol}^{-1}.$$\n转换为千焦每摩尔并四舍五入到三位有效数字：\n$$\\Delta \\mu_{C} \\approx -7.33694 \\text{ kJ mol}^{-1} \\to -7.34 \\text{ kJ mol}^{-1}.$$",
            "answer": "$$\\boxed{-7.34}$$"
        },
        {
            "introduction": "真实的地球化学流体，尤其是在地下储层的高温高压条件下，其行为很少是理想的。本练习从简单的活度模型更进一步，要求使用逸度来计算真实气体（$\\text{CO}_2$）的化学势，而逸度则通过强大的 Peng-Robinson 状态方程来确定。掌握这项技能 ，对于精确模拟地质系统中的流体性质和反应至关重要。",
            "id": "4103841",
            "problem": "一个深部地热系统中的二氧化碳储层气体，其温度为 $T=500\\ \\mathrm{K}$，压力为 $P=150\\ \\mathrm{bar}$。将该气体视为单组分真实流体，并使用 Peng–Robinson 状态方程（EOS）来评估逸度系数 $\\phi(T,P)$ 和逸度 $f$。参考态为相同温度 $T$ 下，压力为 $P^{\\circ}=1\\ \\mathrm{bar}$ 的理想气体标准态。目标是计算 $\\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ})$，其中 $\\mu_{\\mathrm{CO}_2}$ 是储层条件下二氧化碳的化学势，而 $\\mu^{\\circ}_{\\mathrm{CO}_2}$ 是理想气体的标准态化学势。\n\n使用二氧化碳的以下纯组分性质：\n- 临界温度 $T_{c}=304.1282\\ \\mathrm{K}$，\n- 临界压力 $P_{c}=73.773\\ \\mathrm{bar}$，\n- 偏心因子 $\\omega=0.225$。\n\n在您的热力学建模中使用以下常数：\n- 能量单位的普适气体常数 $R=8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$，\n- 压力-体积单位的普适气体常数 $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$。\n\n假设在所述条件下为单相气体行为。以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位报告 $\\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ})$ 的最终值，并将您的答案四舍五入至四位有效数字。",
            "solution": "真实流体在状态 $(T, P)$ 与理想气体在标准态 $(T, P^{\\circ})$ 之间的化学势差由以下基本热力学关系给出：\n$$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\ln\\left(\\frac{f(T,P)}{f^{\\circ}(T,P^{\\circ})}\\right) $$\n其中 $f$ 是逸度。参考态是理想气体，其逸度等于压力，因此 $f^{\\circ}(T,P^{\\circ}) = P^{\\circ}$。真实气体的逸度通过逸度系数 $\\phi$ 与其压力相关联，即 $f(T,P) = \\phi(T,P) \\cdot P$。代入这些定义可得：\n$$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\ln\\left(\\frac{\\phi P}{P^{\\circ}}\\right) = RT \\ln(\\phi) + RT \\ln\\left(\\frac{P}{P^{\\circ}}\\right) $$\n因此，问题简化为使用 Peng–Robinson (PR) 状态方程计算逸度系数 $\\phi(T,P)$。\n\nPR 状态方程 (PR-EOS) 形式如下：\n$$ P = \\frac{RT}{V_m - b} - \\frac{a(T)}{V_m(V_m+b) + b(V_m-b)} $$\n其中 $V_m$ 是摩尔体积。组分特定参数 $a(T)$ 和 $b$ 由临界性质（$T_c$, $P_c$）和偏心因子（$\\omega$）确定。\n\n首先，我们计算与温度相关的参数 $a(T)$：\n$$ a(T) = a_c \\alpha(T) $$\n其中\n$$ a_c = 0.457235 \\frac{(RT_c)^2}{P_c} $$\n$$ \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right)\\right]^2 $$\n$$ \\kappa = 0.37464 + 1.54226\\omega - 0.26992\\omega^2 $$\n参数 $b$ 是一个常数：\n$$ b = 0.077796 \\frac{RT_c}{P_c} $$\n为进行这些计算，使用压力-体积单位的气体常数 $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$ 会很方便。\n\n已知数据：$T=500\\ \\mathrm{K}$， $P=150\\ \\mathrm{bar}$， $T_c=304.1282\\ \\mathrm{K}$， $P_c=73.773\\ \\mathrm{bar}$， $\\omega=0.225$。\n\n1.  **计算 $\\mathrm{CO}_2$ 的 PR 参数**：\n    对比温度为 $T_r = \\frac{T}{T_c} = \\frac{500}{304.1282} \\approx 1.64402$。\n    参数 $\\kappa$ 为：\n    $$ \\kappa = 0.37464 + 1.54226(0.225) - 0.26992(0.225)^2 \\approx 0.707975 $$\n    温度校正因子 $\\alpha(T)$ 为：\n    $$ \\alpha(T_r) = [1 + 0.707975(1 - \\sqrt{1.64402})]^2 \\approx [1 + 0.707975(1 - 1.282195)]^2 \\approx (0.80023)^2 \\approx 0.64037 $$\n    参数 $a_c$ 和 $b$ 为：\n    $$ a_c = 0.457235 \\frac{(0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 304.1282\\ \\mathrm{K})^2}{73.773\\ \\mathrm{bar}} \\approx 3.9647\\ \\mathrm{L^2\\ bar\\ mol^{-2}} $$\n    $$ b = 0.077796 \\frac{0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 304.1282\\ \\mathrm{K}}{73.773\\ \\mathrm{bar}} \\approx 0.026669\\ \\mathrm{L\\ mol^{-1}} $$\n    因此，与温度相关的参数 $a(T)$ 为：\n    $$ a(T) = a_c \\alpha(T_r) = 3.9647 \\times 0.64037 \\approx 2.5389\\ \\mathrm{L^2\\ bar\\ mol^{-2}} $$\n\n2.  **求解压缩因子 ($Z$)**：\n    PR 状态方程可以写成关于压缩因子 $Z = \\frac{PV_m}{RT}$ 的三次方程：\n    $$ Z^3 - (1-B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0 $$\n    其中 $A$ 和 $B$ 是无量纲参数：\n    $$ A = \\frac{a(T)P}{(RT)^2} \\quad \\text{and} \\quad B = \\frac{bP}{RT} $$\n    使用 $T=500\\ \\mathrm{K}$ 和 $P=150\\ \\mathrm{bar}$：\n    $$ RT = 0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 500\\ \\mathrm{K} = 41.57 \\ \\mathrm{L\\ bar\\ mol^{-1}} $$\n    $$ A = \\frac{2.5389 \\times 150}{(41.57)^2} \\approx 0.22039 $$\n    $$ B = \\frac{0.026669 \\times 150}{41.57} \\approx 0.09623 $$\n    将 $A$ 和 $B$ 代入三次方程：\n    $$ Z^3 - (1 - 0.09623)Z^2 + (0.22039 - 3(0.09623)^2 - 2(0.09623))Z - (0.22039 \\cdot 0.09623 - (0.09623)^2 - (0.09623)^3) = 0 $$\n    $$ Z^3 - 0.90377 Z^2 + 0.00015 Z - 0.011057 = 0 $$\n    求解此三次方程得到一个实根（这与高于其临界温度的单相流体情况一致），我们必须使用这个根。该根为：\n    $$ Z \\approx 0.91638 $$\n\n3.  **计算逸度系数 ($\\phi$)**：\n    对于 PR 状态方程，逸度系数的自然对数由下式给出：\n    $$ \\ln\\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln\\left[\\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B}\\right] $$\n    代入 $Z$、$A$ 和 $B$ 的值：\n    $$ Z - 1 = 0.91638 - 1 = -0.08362 $$\n    $$ \\ln(Z-B) = \\ln(0.91638 - 0.09623) = \\ln(0.82015) \\approx -0.19828 $$\n    $$ \\frac{A}{2\\sqrt{2}B} = \\frac{0.22039}{2\\sqrt{2} \\times 0.09623} \\approx 0.80971 $$\n    $$ \\ln\\left[\\frac{0.91638 + (1+\\sqrt{2})0.09623}{0.91638 + (1-\\sqrt{2})0.09623}\\right] = \\ln\\left[\\frac{0.91638 + 0.23233}{0.91638 - 0.03986}\\right] = \\ln\\left(\\frac{1.14871}{0.87652}\\right) \\approx \\ln(1.31053) \\approx 0.27042 $$\n    合并这些项：\n    $$ \\ln\\phi \\approx -0.08362 - (-0.19828) - (0.80971)(0.27042) $$\n    $$ \\ln\\phi \\approx 0.11466 - 0.21896 = -0.10430 $$\n\n4.  **计算化学势差**：\n    我们现在使用化学势差的公式。在这一步中，我们必须使用能量单位的气体常数 $R=8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n    $$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\left[\\ln\\left(\\frac{P}{P^{\\circ}}\\right) + \\ln(\\phi)\\right] $$\n    问题指定 $P=150\\ \\mathrm{bar}$ 和 $P^{\\circ}=1\\ \\mathrm{bar}$。\n    $$ \\mu - \\mu^{\\circ} = (8.31446\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})(500\\ \\mathrm{K}) \\left[\\ln\\left(\\frac{150}{1}\\right) + (-0.10430)\\right] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [\\ln(150) - 0.10430] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [5.010635 - 0.10430] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [4.906335] $$\n    $$ \\mu - \\mu^{\\circ} \\approx 20401.8\\ \\mathrm{J\\ mol^{-1}} $$\n    转换为 $\\mathrm{kJ\\ mol^{-1}}$：\n    $$ \\mu - \\mu^{\\circ} \\approx 20.4018\\ \\mathrm{kJ\\ mol^{-1}} $$\n    按要求四舍五入至四位有效数字：\n    $$ \\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ}) \\approx 20.40\\ \\mathrm{kJ\\ mol^{-1}} $$",
            "answer": "$$\\boxed{20.40}$$"
        },
        {
            "introduction": "地球化学系统几乎总是涉及流体混合物，而非纯物质。这个高级练习在单组分计算的基础上，将 Peng-Robinson 状态方程应用于气体混合物，并引入混合规则和二元相互作用参数，以解释不同物质间的分子间作用力。通过实施一个数值计算器 ，你不仅将学会在真实场景中计算化学势，还将学会验证在何种条件下，简化的理想气体模型是可接受的近似。",
            "id": "4103838",
            "problem": "您的任务是验证一个用于多组分气体混合物的数值化学势计算器，方法是在与地下二氧化碳封存相关的压力和温度范围内，比较理想气体和真实气体的结果。该验证必须从第一性原理出发，并实现为一个完整的、可运行的程序。\n\n混合物中组分 $i$ 的化学势，记为 $\\mu_i$，必须针对理想气体混合物情况以及由适用于地下条件的立方状态方程所描述的非理想混合物情况进行计算。验证标准基于每个测试案例中对理想性的偏离程度。\n\n从核心热力学定义和经过充分检验的模型出发（不使用或预设任何简化公式），推导并实现必要的表达式，以计算二氧化碳、甲烷和氮气气相混合物的真实气体化学势。您必须使用 Peng–Robinson 状态方程 (PR-EOS)，并获取混合物组分的逸度系数以量化非理想性。程序必须严格使用国际单位制 (SI)。\n\n物理常数和组分性质：\n- 通用气体常数：$R = 8.314462618 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 用于 PR-EOS 参数化的各物种的临界性质和偏心因子：\n  - 二氧化碳 ($\\mathrm{CO_2}$)：$T_c = 304.1282 \\,\\mathrm{K}$，$P_c = 73.773 \\,\\mathrm{bar}$，$\\omega = 0.22394$。\n  - 甲烷 ($\\mathrm{CH_4}$)：$T_c = 190.564 \\,\\mathrm{K}$，$P_c = 45.990 \\,\\mathrm{bar}$，$\\omega = 0.0115$。\n  - 氮气 ($\\mathrm{N_2}$)：$T_c = 126.192 \\,\\mathrm{K}$，$P_c = 33.980 \\,\\mathrm{bar}$，$\\omega = 0.0372$。\n- 用于混合物混合规则的二元相互作用参数 $k_{ij}$（对称，且 $k_{ii} = 0$）：\n  - $k_{\\mathrm{CO_2,CH_4}} = 0.12$，$k_{\\mathrm{CO_2,N_2}} = 0.10$，$k_{\\mathrm{CH_4,N_2}} = 0.00$。\n- 以 $\\mathrm{bar}$ 为单位的压力必须使用 $1 \\,\\mathrm{bar} = 10^5 \\,\\mathrm{Pa}$ 转换为 $\\mathrm{Pa}$。\n\n您的推导和程序必须满足以下要求：\n- 从化学势作为吉布斯自由能的偏导数的定义，以及在恒定温度和压力下的分压、逸度和逸度系数的概念出发。不要在问题陈述中写下任何现成的目标公式；相反，应在您的解决方案中从基本原理构建它们。\n- 实现一个基于 PR-EOS 的混合物模型，该模型适用于地下 $\\mathrm{CO_2}$ 封存条件，以计算气相的逸度系数。在气相中，为压缩因子选择一个物理上一致的根。\n- 在相同的参考标度上一致地计算每个组分的理想气体化学势和真实气体化学势，并以此确定对理想性的偏离程度。将组分 $i$ 的偏离表示为以 $\\mathrm{J/mol}$ 为单位的差值，并用此来判断理想气体近似是否足够。\n\n验证标准：\n- 对于每个测试案例，计算所有组分 $i \\in \\{\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2}\\}$ 的 $\\Delta \\mu_i = \\mu_i^{\\mathrm{real}} - \\mu_i^{\\mathrm{ideal}}$。将案例级误差度量定义为 $\\max_i \\left| \\Delta \\mu_i \\right|$。\n- 如果 $\\max_i \\left| \\Delta \\mu_i \\right| \\le 300 \\,\\mathrm{J/mol}$，则宣布理想气体近似对于该测试案例是足够的，否则为不足够。您的程序必须为每个测试案例返回一个布尔值。\n\n角度单位不适用。内部使用的所有物理量必须采用国际单位制。所有输出必须是无单位的布尔值。\n\n测试套件：\n- 案例 1：$P = 30 \\,\\mathrm{bar}$，$T = 350 \\,\\mathrm{K}$，组成向量 $\\boldsymbol{y} = [0.90, 0.05, 0.05]$ for $(\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2})$。\n- 案例 2：$P = 75 \\,\\mathrm{bar}$，$T = 304.2 \\,\\mathrm{K}$，$\\boldsymbol{y} = [0.95, 0.03, 0.02]$。\n- 案例 3：$P = 200 \\,\\mathrm{bar}$，$T = 450 \\,\\mathrm{K}$，$\\boldsymbol{y} = [0.80, 0.10, 0.10]$。\n- 案例 4：$P = 100 \\,\\mathrm{bar}$，$T = 310 \\,\\mathrm{K}$，$\\boldsymbol{y} = [0.70, 0.20, 0.10]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $\\left[ \\text{result}_1, \\text{result}_2, \\text{result}_3, \\text{result}_4 \\right]$，其中每个 $\\text{result}_k$ 是一个布尔值，表示理想气体近似对于第 $k$ 个测试案例是否足够。",
            "solution": "核心任务是计算气体混合物中各组分化学势与其在相同温度、压力和组成下的理想气体混合物中值的偏差。这个偏差 $\\Delta \\mu_i$ 是评估在指定条件下理想气体近似有效性的关键。\n\n我们从化学势 $\\mu_i$ 和逸度 $f_i$ 的基本定义开始。在恒定温度 $T$ 下，化学势的微分与逸度的微分相关：\n$$d\\mu_i = RT \\, d(\\ln f_i)$$\n其中 $R$ 是通用气体常数。将此式从一个参考态（用上标 $\\circ$ 表示）积分到目标状态，可得：\n$$\\mu_i(T, P, \\boldsymbol{y}) - \\mu_i^{\\circ}(T, P^{\\circ}) = RT \\ln \\left( \\frac{f_i(T, P, \\boldsymbol{y})}{f_i^{\\circ}(T, P^{\\circ})} \\right)$$\n一个方便的参考态是纯组分 $i$ 在系统温度 $T$ 和参考压力 $P^{\\circ}$（例如，$1$ bar）下的理想气体状态。在此状态下，逸度等于压力，因此 $f_i^{\\circ}(T, P^{\\circ}) = P^{\\circ}$。化学势的表达式变为：\n$$\\mu_i(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{f_i(T, P, \\boldsymbol{y})}{P^{\\circ}} \\right)$$\n\n对于理想气体混合物，组分 $i$ 的逸度等于其分压，$f_i^{\\mathrm{ideal}} = y_i P$，其中 $y_i$ 是组分 $i$ 的摩尔分数，$P$ 是总压力。因此，化学势为：\n$$\\mu_i^{\\mathrm{ideal}}(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{y_i P}{P^{\\circ}} \\right)$$\n\n对于真实气体混合物，非理想性由逸度系数 $\\phi_i$ 捕捉，其定义为实际逸度与理想气体逸度之比：\n$$\\phi_i(T, P, \\boldsymbol{y}) = \\frac{f_i(T, P, \\boldsymbol{y})}{y_i P}$$\n因此，逸度为 $f_i = \\phi_i y_i P$。真实气体的化学势为：\n$$\\mu_i^{\\mathrm{real}}(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{\\phi_i y_i P}{P^{\\circ}} \\right)$$\n\n理想性偏差 $\\Delta \\mu_i$ 是真实化学势与理想化学势之差：\n$$\\Delta \\mu_i = \\mu_i^{\\mathrm{real}} - \\mu_i^{\\mathrm{ideal}}$$\n$$\\Delta \\mu_i = \\left[ \\mu_i^{\\circ} + RT \\ln \\left( \\frac{\\phi_i y_i P}{P^{\\circ}} \\right) \\right] - \\left[ \\mu_i^{\\circ} + RT \\ln \\left( \\frac{y_i P}{P^{\\circ}} \\right) \\right]$$\n$$\\Delta \\mu_i = RT \\left[ \\ln(\\phi_i y_i P) - \\ln(y_i P) \\right] = RT \\ln \\left( \\frac{\\phi_i y_i P}{y_i P} \\right)$$\n$$\\Delta \\mu_i = RT \\ln \\phi_i$$\n这个简洁的结果表明，整个问题简化为计算每个组分的逸度系数 $\\phi_i$。为此，我们采用 Peng-Robinson 状态方程 (PR-EOS)。\n\nPR-EOS 方程为：\n$$P = \\frac{RT}{V_m - b_m} - \\frac{a_m(T)}{V_m(V_m + b_m) + b_m(V_m - b_m)}$$\n其中 $V_m$ 是混合物的摩尔体积，$a_m$ 和 $b_m$ 是混合物的 EOS 参数。对于纯组分 $i$，参数 $a_i$ 和 $b_i$ 由其临界性质（$T_{c,i}$、$P_{c,i}$）和偏心因子（$\\omega_i$）确定：\n$$a_i(T) = a_{c,i} \\alpha_i(T)$$\n$$a_{c,i} = 0.45724 \\frac{R^2 T_{c,i}^2}{P_{c,i}}$$\n$$b_i = 0.07780 \\frac{R T_{c,i}}{P_{c,i}}$$\n依赖于温度的项 $\\alpha_i(T)$ 为：\n$$\\alpha_i(T) = \\left[ 1 + m_i \\left(1 - \\sqrt{T_{r,i}}\\right) \\right]^2$$\n其中 $T_{r,i} = T/T_{c,i}$ 是对比温度，$m_i$ 是偏心因子的函数：\n$$m_i = 0.37464 + 1.54226 \\omega_i - 0.26992 \\omega_i^2$$\n\n对于多组分混合物，参数 $a_m$ 和 $b_m$ 使用 van der Waals 单流体混合规则计算：\n$$a_m = \\sum_{i} \\sum_{j} y_i y_j a_{ij}$$\n$$b_m = \\sum_{i} y_i b_i$$\n交叉项 $a_{ij}$ 包含一个二元相互作用参数 $k_{ij}$ 以提高准确性：\n$$a_{ij} = \\sqrt{a_i a_j} (1 - k_{ij})$$\n\nPR-EOS 可以写成关于压缩因子 $Z = PV_m/(RT)$ 的三次多项式：\n$$Z^3 - (1-B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0$$\n其中 $A = \\frac{a_m P}{(RT)^2}$ 和 $B = \\frac{b_m P}{RT}$ 是混合物的无量纲参数。求解该方程会得到一个或三个 $Z$ 的实根。对于单相气体，物理上正确的根是最大的正实根。\n\n混合物中组分 $k$ 的逸度系数可以从 EOS 推导出来。对于 PR-EOS，得到的表达式为：\n$$ \\ln \\phi_k = \\frac{b_k}{b_m}(Z-1) - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\left( \\frac{2 \\sum_i y_i a_{ik}}{a_m} - \\frac{b_k}{b_m} \\right) \\ln \\left( \\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B} \\right) $$\n一旦压缩因子 $Z$ 已知，此表达式允许直接计算 $\\ln \\phi_k$。\n\n为每个测试案例验证理想气体近似的计算步骤如下：\n1.  **初始化**：对于每个组分 $i \\in \\{\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2}\\}$，将其临界压力 $P_{c,i}$ 转换为国际单位制（$\\mathrm{Pa}$）。预先计算不依赖于温度的参数 $m_i$、$a_{c,i}$ 和 $b_i$。\n2.  **状态依赖参数计算**：对于给定的测试案例（$T$，$P$，$\\boldsymbol{y}$），将系统压力 $P$ 转换为 $\\mathrm{Pa}$。对于每个组分 $i$，计算其依赖于温度的参数 $a_i(T)$。\n3.  **混合物参数计算**：使用混合规则计算混合物参数 $a_m$ 和 $b_m$。\n4.  **压缩因子计算**：计算无量纲组 $A$ 和 $B$。求解三次 EOS 得到 $Z$，并选择对应于气相的最大正实根。\n5.  **逸度系数计算**：对于每个组分 $k$，使用导出的 $\\ln \\phi_k$ 表达式计算其逸度系数 $\\phi_k$。这需要计算中间和 $\\sum_i y_i a_{ik}$。\n6.  **化学势偏差**：对于每个组分 $k$，计算偏差 $\\Delta \\mu_k = RT \\ln \\phi_k$。\n7.  **验证**：确定案例级误差度量 $\\max_k |\\Delta \\mu_k|$。如果此值小于或等于 $300 \\, \\mathrm{J/mol}$，则认为理想气体近似是足够的 (True)；否则，它是不足够的 (False)。\n8.  **输出**：报告该测试案例的布尔结果。对所有案例重复此过程，并按规定格式化最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes real-gas chemical potentials for a CO2-CH4-N2 mixture using\n    the Peng-Robinson Equation of State to validate the ideal-gas assumption.\n    \"\"\"\n    # Universal gas constant in SI units (J/mol/K)\n    R = 8.314462618\n\n    # Species data: Tc (K), Pc (bar), omega (dimensionless)\n    # The order is: CO2, CH4, N2\n    species_data = {\n        'CO2': {'Tc': 304.1282, 'Pc': 73.773, 'omega': 0.22394},\n        'CH4': {'Tc': 190.564, 'Pc': 45.990, 'omega': 0.0115},\n        'N2':  {'Tc': 126.192, 'Pc': 33.980, 'omega': 0.0372}\n    }\n    species_order = ['CO2', 'CH4', 'N2']\n    num_species = len(species_order)\n\n    # Binary interaction parameters, k_ij (symmetric)\n    k_ij_matrix = np.array([\n        [0.0, 0.12, 0.10],  # CO2 with (CO2, CH4, N2)\n        [0.12, 0.0, 0.00],  # CH4 with (CO2, CH4, N2)\n        [0.10, 0.00, 0.0]   # N2  with (CO2, CH4, N2)\n    ])\n\n    test_cases = [\n        {'P_bar': 30, 'T_K': 350, 'y': np.array([0.90, 0.05, 0.05])},\n        {'P_bar': 75, 'T_K': 304.2, 'y': np.array([0.95, 0.03, 0.02])},\n        {'P_bar': 200, 'T_K': 450, 'y': np.array([0.80, 0.10, 0.10])},\n        {'P_bar': 100, 'T_K': 310, 'y': np.array([0.70, 0.20, 0.10])},\n    ]\n\n    # Pre-calculate temperature-independent pure component parameters\n    pure_params = []\n    for i in range(num_species):\n        name = species_order[i]\n        data = species_data[name]\n        Tc = data['Tc']\n        Pc_Pa = data['Pc'] * 1.0e5  # Convert bar to Pa\n        omega = data['omega']\n        \n        m_i = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n        a_c_i = 0.45724 * (R**2 * Tc**2) / Pc_Pa\n        b_i = 0.07780 * R * Tc / Pc_Pa\n        \n        pure_params.append({'m_i': m_i, 'a_c_i': a_c_i, 'b_i': b_i, 'Tc': Tc})\n\n    results = []\n    for case in test_cases:\n        P_Pa = case['P_bar'] * 1.0e5\n        T_K = case['T_K']\n        y = case['y']\n\n        # 1. Calculate T-dependent pure component parameters\n        a_i_T = np.zeros(num_species)\n        b_i = np.array([p['b_i'] for p in pure_params])\n        for i in range(num_species):\n            params = pure_params[i]\n            Tr = T_K / params['Tc']\n            alpha_i = (1 + params['m_i'] * (1 - np.sqrt(Tr)))**2\n            a_i_T[i] = params['a_c_i'] * alpha_i\n            \n        # 2. Calculate mixture parameters using mixing rules\n        b_m = np.sum(y * b_i)\n        \n        a_m = 0.0\n        for i in range(num_species):\n            for j in range(num_species):\n                a_ij = np.sqrt(a_i_T[i] * a_i_T[j]) * (1 - k_ij_matrix[i, j])\n                a_m += y[i] * y[j] * a_ij\n\n        # 3. Calculate dimensionless parameters A and B for the mixture\n        A = a_m * P_Pa / (R**2 * T_K**2)\n        B = b_m * P_Pa / (R * T_K)\n\n        # 4. Solve the cubic EOS for the compressibility factor Z\n        c2 = -(1 - B)\n        c1 = A - 3*B**2 - 2*B\n        c0 = -(A*B - B**2 - B**3)\n        poly_coeffs = [1, c2, c1, c0]\n        \n        roots = np.roots(poly_coeffs)\n        real_roots = roots[np.isreal(roots)].real\n        positive_real_roots = real_roots[real_roots  B] # Physical roots Z  B\n\n        # For the gas phase, select the largest real root\n        Z = np.max(positive_real_roots)\n\n        # 5. Calculate fugacity coefficients\n        delta_mu = np.zeros(num_species)\n        \n        # Pre-compute terms for fugacity coefficient calculation\n        term_Z_minus_1 = Z - 1\n        term_ln_Z_B = np.log(Z - B)\n        sqrt2 = np.sqrt(2)\n        log_ratio_arg = (Z + (1 + sqrt2) * B) / (Z + (1 - sqrt2) * B)\n        term_log_ratio = np.log(log_ratio_arg)\n        \n        sum_y_a_ik = np.zeros(num_species)\n        for k in range(num_species):\n            for i in range(num_species):\n                a_ik = np.sqrt(a_i_T[i] * a_i_T[k]) * (1 - k_ij_matrix[i, k])\n                sum_y_a_ik[k] += y[i] * a_ik\n        \n        for k in range(num_species):\n            term_b = b_i[k] / b_m\n            term_a = (2 * sum_y_a_ik[k]) / a_m\n            bracket_term = term_a - term_b\n            \n            ln_phi_k = term_b * term_Z_minus_1 - term_ln_Z_B - (A / (2 * sqrt2 * B)) * bracket_term * term_log_ratio\n            \n            # 6. Calculate chemical potential departure\n            delta_mu[k] = R * T_K * ln_phi_k\n\n        # 7. Apply validation criterion\n        max_abs_delta_mu = np.max(np.abs(delta_mu))\n        is_adequate = max_abs_delta_mu = 300.0\n        results.append(str(is_adequate).lower())\n\n    # Format the final output string\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}