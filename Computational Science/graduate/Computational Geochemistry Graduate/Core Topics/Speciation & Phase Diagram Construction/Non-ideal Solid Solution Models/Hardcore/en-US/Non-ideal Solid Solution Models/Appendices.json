{
    "hands_on_practices": [
        {
            "introduction": "Before applying complex models, it's crucial to understand their fundamental components. This exercise  delves into the mathematical heart of the asymmetric Margules model. By deriving the limiting partial molar excess properties, you will uncover the direct physical interpretation of the interaction parameters, connecting the abstract model to measurable thermodynamic quantities at infinite dilution.",
            "id": "4093023",
            "problem": "Consider a binary non-ideal crystalline solid solution of components $1$ and $2$ at constant pressure, relevant to computational geochemistry of cation substitutions in a lattice. The non-ideal behavior is described by the asymmetric two-parameter Margules model for the molar excess Gibbs energy, defined as\n$$\ng^{ex}(x_{1},T) \\equiv x_{1} x_{2} \\left[ W_{12}(T)\\, x_{2} + W_{21}(T)\\, x_{1} \\right],\n$$\nwhere $x_{1}$ and $x_{2}=1-x_{1}$ are mole fractions, $T$ is absolute temperature, and $W_{12}(T)$ and $W_{21}(T)$ are temperature-dependent Margules interaction parameters with the physical dimension of energy per mole. Assume each parameter is an affine (linear) function of temperature,\n$$\nW_{12}(T) = \\alpha_{12} + \\beta_{12}\\, T, \\qquad W_{21}(T) = \\alpha_{21} + \\beta_{21}\\, T,\n$$\nwith $\\alpha_{12}$, $\\beta_{12}$, $\\alpha_{21}$, and $\\beta_{21}$ constant with respect to $T$ and independent of composition and pressure over the range of interest.\n\nStarting from the definition of chemical potential as the partial molar Gibbs energy and the definition of excess properties, derive expressions for the limiting partial molar excess Gibbs energies $\\overline{G}_{1}^{ex}$ at $x_{1}\\to 0$ and $\\overline{G}_{2}^{ex}$ at $x_{2}\\to 0$, and then use fundamental thermodynamic identities to obtain the corresponding limiting partial molar excess enthalpies $\\overline{H}_{1}^{ex}$ at $x_{1}\\to 0$ and $\\overline{H}_{2}^{ex}$ at $x_{2}\\to 0$.\n\nExpress the final energies in Joules per mole. Provide the final answer as a single closed-form analytic expression in terms of $\\alpha_{12}$, $\\beta_{12}$, $\\alpha_{21}$, $\\beta_{21}$, and $T$. No numerical rounding is required. Your final expression must be ordered as $\\overline{G}_{1}^{ex}\\!(x_{1}\\!\\to\\!0)$, $\\overline{H}_{1}^{ex}\\!(x_{1}\\!\\to\\!0)$, $\\overline{G}_{2}^{ex}\\!(x_{2}\\!\\to\\!0)$, $\\overline{H}_{2}^{ex}\\!(x_{2}\\!\\to\\!0)$.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. It is a standard derivation in chemical thermodynamics, relevant to the modeling of non-ideal solid solutions in geochemistry. Therefore, the problem is valid and I will proceed with the solution.\n\nThe first step is to derive the general expressions for the partial molar excess Gibbs energies, $\\overline{G}_{1}^{ex}$ and $\\overline{G}_{2}^{ex}$, from the given molar excess Gibbs energy of the solution, $g^{ex}$. The partial molar property $\\overline{Y}_{i}$ for a component $i$ in a binary solution is related to the molar property $Y$ by the following relations:\n$$\n\\overline{Y}_{1} = Y + x_{2} \\frac{\\partial Y}{\\partial x_{1}} \\quad \\text{and} \\quad \\overline{Y}_{2} = Y - x_{1} \\frac{\\partial Y}{\\partial x_{1}}\n$$\nIn this problem, $Y=g^{ex}$, $\\overline{Y}_{1}=\\overline{G}_{1}^{ex}$, and $\\overline{Y}_{2}=\\overline{G}_{2}^{ex}$. The molar excess Gibbs energy is given by:\n$$\ng^{ex}(x_{1}, T) = x_{1} x_{2} \\left[ W_{12}(T)\\, x_{2} + W_{21}(T)\\, x_{1} \\right]\n$$\nTo facilitate differentiation, we substitute $x_{2} = 1 - x_{1}$:\n$$\ng^{ex}(x_{1}, T) = x_{1} (1-x_{1}) \\left[ W_{12}(T)\\, (1-x_{1}) + W_{21}(T)\\, x_{1} \\right]\n$$\nThis expression can be written as:\n$$\ng^{ex} = x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21}\n$$\nwhere the temperature dependence of $W_{ij}$ is temporarily suppressed for notational clarity. We now compute the partial derivative of $g^{ex}$ with respect to $x_1$:\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left[ x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21} \\right]\n$$\nUsing the product rule:\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = \\left( (1-x_{1})^{2} - 2x_{1}(1-x_{1}) \\right) W_{12} + \\left( 2x_{1}(1-x_{1}) - x_{1}^{2} \\right) W_{21}\n$$\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = (1-x_{1})(1-x_{1}-2x_{1}) W_{12} + x_{1}(2-2x_{1}-x_{1}) W_{21}\n$$\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = (1-x_{1})(1-3x_{1}) W_{12} + x_{1}(2-3x_{1}) W_{21}\n$$\nNow we can find the expression for $\\overline{G}_{1}^{ex}$:\n$$\n\\overline{G}_{1}^{ex} = g^{ex} + (1-x_{1})\\frac{\\partial g^{ex}}{\\partial x_{1}}\n$$\n$$\n\\overline{G}_{1}^{ex} = \\left[ x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21} \\right] + (1-x_{1}) \\left[ (1-x_{1})(1-3x_{1}) W_{12} + x_{1}(2-3x_{1}) W_{21} \\right]\n$$\nGrouping terms with $W_{12}$ and $W_{21}$:\n$$\n\\overline{G}_{1}^{ex} = \\left[ x_{1}(1-x_{1})^{2} + (1-x_{1})^{2}(1-3x_{1}) \\right] W_{12} + \\left[ x_{1}^{2}(1-x_{1}) + x_{1}(1-x_{1})(2-3x_{1}) \\right] W_{21}\n$$\nFactor out common terms:\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} \\left[ x_{1} + (1-3x_{1}) \\right] W_{12} + x_{1}(1-x_{1}) \\left[ x_{1} + (2-3x_{1}) \\right] W_{21}\n$$\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} (1-2x_{1}) W_{12} + x_{1}(1-x_{1}) (2-2x_{1}) W_{21}\n$$\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} (1-2x_{1}) W_{12} + 2x_{1}(1-x_{1})^{2} W_{21}\n$$\nFactoring out $(1-x_{1})^{2}$ gives the final standard form for the two-parameter Margules model:\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} \\left[ (1-2x_{1}) W_{12} + 2x_{1} W_{21} \\right]\n$$\nThis can be rewritten as:\n$$\n\\overline{G}_{1}^{ex} = x_{2}^{2} \\left[ W_{12} + 2x_{1} (W_{21} - W_{12}) \\right]\n$$\nBy symmetry, swapping the indices $1$ and $2$, we obtain the expression for $\\overline{G}_{2}^{ex}$:\n$$\n\\overline{G}_{2}^{ex} = x_{1}^{2} \\left[ W_{21} + 2x_{2} (W_{12} - W_{21}) \\right]\n$$\nNow, we evaluate the required limits. For the limiting partial molar excess Gibbs energy of component $1$, we take the limit as $x_{1} \\to 0$, which implies $x_{2} \\to 1$:\n$$\n\\lim_{x_{1} \\to 0} \\overline{G}_{1}^{ex} = \\lim_{x_{1} \\to 0, x_{2} \\to 1} \\left( x_{2}^{2} \\left[ W_{12} + 2x_{1} (W_{21} - W_{12}) \\right] \\right)\n$$\n$$\n\\overline{G}_{1}^{ex}(x_{1} \\to 0) = (1)^{2} \\left[ W_{12} + 2(0) (W_{21} - W_{12}) \\right] = W_{12}(T)\n$$\nFor the limiting partial molar excess Gibbs energy of component $2$, we take the limit as $x_{2} \\to 0$, which implies $x_{1} \\to 1$:\n$$\n\\lim_{x_{2} \\to 0} \\overline{G}_{2}^{ex} = \\lim_{x_{2} \\to 0, x_{1} \\to 1} \\left( x_{1}^{2} \\left[ W_{21} + 2x_{2} (W_{12} - W_{21}) \\right] \\right)\n$$\n$$\n\\overline{G}_{2}^{ex}(x_{2} \\to 0) = (1)^{2} \\left[ W_{21} + 2(0) (W_{12} - W_{21}) \\right] = W_{21}(T)\n$$\nSubstituting the given linear dependencies of the Margules parameters on temperature:\n$$\n\\overline{G}_{1}^{ex}(x_{1} \\to 0) = W_{12}(T) = \\alpha_{12} + \\beta_{12} T\n$$\n$$\n\\overline{G}_{2}^{ex}(x_{2} \\to 0) = W_{21}(T) = \\alpha_{21} + \\beta_{21} T\n$$\nNext, we derive the expressions for the limiting partial molar excess enthalpies, $\\overline{H}_{1}^{ex}(x_{1}\\to 0)$ and $\\overline{H}_{2}^{ex}(x_{2}\\to 0)$. We use the Gibbs-Helmholtz equation, which relates enthalpy to Gibbs energy:\n$$\n\\overline{H}_{i}^{ex} = -T^{2} \\left[ \\frac{\\partial (\\overline{G}_{i}^{ex}/T)}{\\partial T} \\right]_{P,x}\n$$\nWe can apply this relation directly to the limiting Gibbs energy expressions derived above.\nFor component $1$ at infinite dilution ($x_{1} \\to 0$):\n$$\n\\overline{H}_{1}^{ex}(x_{1} \\to 0) = -T^{2} \\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\overline{G}_{1}^{ex}(x_{1} \\to 0)}{T} \\right) \\right]_{P}\n$$\nSubstitute the expression for $\\overline{G}_{1}^{ex}(x_{1} \\to 0)$:\n$$\n\\frac{\\overline{G}_{1}^{ex}(x_{1} \\to 0)}{T} = \\frac{\\alpha_{12} + \\beta_{12} T}{T} = \\frac{\\alpha_{12}}{T} + \\beta_{12}\n$$\nDifferentiating with respect to $T$ at constant pressure:\n$$\n\\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\alpha_{12}}{T} + \\beta_{12} \\right) \\right]_{P} = -\\frac{\\alpha_{12}}{T^{2}}\n$$\nSubstituting this back into the Gibbs-Helmholtz equation:\n$$\n\\overline{H}_{1}^{ex}(x_{1} \\to 0) = -T^{2} \\left( -\\frac{\\alpha_{12}}{T^{2}} \\right) = \\alpha_{12}\n$$\nSimilarly, for component $2$ at infinite dilution ($x_{2} \\to 0$):\n$$\n\\overline{H}_{2}^{ex}(x_{2} \\to 0) = -T^{2} \\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\overline{G}_{2}^{ex}(x_{2} \\to 0)}{T} \\right) \\right]_{P}\n$$\nSubstitute the expression for $\\overline{G}_{2}^{ex}(x_{2} \\to 0)$:\n$$\n\\frac{\\overline{G}_{2}^{ex}(x_{2} \\to 0)}{T} = \\frac{\\alpha_{21} + \\beta_{21} T}{T} = \\frac{\\alpha_{21}}{T} + \\beta_{21}\n$$\nDifferentiating with respect to $T$ at constant pressure:\n$$\n\\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\alpha_{21}}{T} + \\beta_{21} \\right) \\right]_{P} = -\\frac{\\alpha_{21}}{T^{2}}\n$$\nSubstituting this back into the Gibbs-Helmholtz equation:\n$$\n\\overline{H}_{2}^{ex}(x_{2} \\to 0) = -T^{2} \\left( -\\frac{\\alpha_{21}}{T^{2}} \\right) = \\alpha_{21}\n$$\nThe four required quantities are thus:\n1. $\\overline{G}_{1}^{ex}(x_{1} \\to 0) = \\alpha_{12} + \\beta_{12} T$\n2. $\\overline{H}_{1}^{ex}(x_{1} \\to 0) = \\alpha_{12}$\n3. $\\overline{G}_{2}^{ex}(x_{2} \\to 0) = \\alpha_{21} + \\beta_{21} T$\n4. $\\overline{H}_{2}^{ex}(x_{2} \\to 0) = \\alpha_{21}$\n\nThese are provided as a row matrix in the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha_{12} + \\beta_{12} T  \\alpha_{12}  \\alpha_{21} + \\beta_{21} T  \\alpha_{21}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A model is only as good as its parameters, which must be constrained by experimental data. This practice  provides a direct link between theory and application by showing how to determine Margules interaction parameters from measured solvus data. You will translate the thermodynamic condition of phase equilibrium—the common-tangent construction—into a linear system to solve for the best-fit parameters, a foundational skill in quantitative modeling.",
            "id": "4093013",
            "problem": "Consider a binary non-ideal solid solution of components $1$ and $2$ described by Regular Solution Theory with an asymmetric two-parameter Margules excess Gibbs free energy model. Let $x$ denote the mole fraction of component $1$ (so that the mole fraction of component $2$ is $1-x$). The molar Gibbs free energy of mixing is defined as\n$$\ng_{\\mathrm{mix}}(x,T) \\equiv R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + g^{E}(x),\n$$\nwhere $R$ is the Universal Gas Constant (first defined here as $R$), $T$ is the absolute temperature in Kelvin, and $g^{E}(x)$ is the excess Gibbs free energy given by the asymmetric two-parameter Margules form\n$$\ng^{E}(x) \\equiv x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big],\n$$\nwith $W_{12}$ and $W_{21}$ interaction parameters (both in Joules per mole). At two equilibrium compositions $x_{\\alpha}$ and $x_{\\beta}$ on the solvus at temperature $T$, the common-tangent construction demands that the tangent to $g_{\\mathrm{mix}}(x,T)$ is the same line at $x_{\\alpha}$ and $x_{\\beta}$. This is equivalent to the pair of conditions\n$$\n\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T),\n\\quad\\text{and}\\quad\ng_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T).\n$$\nStarting from these thermodynamic definitions, formulate a least-squares inversion to estimate the parameters $W_{12}$ and $W_{21}$ from a set of measured solvus composition pairs $\\{(x_{\\alpha,i},x_{\\beta,i})\\}$ at temperatures $\\{T_i\\}$. Construct for each measured pair the two residuals implied by the common-tangent equalities and assemble a linear system in the unknowns $W_{12}$ and $W_{21}$. Solve for $W_{12}$ and $W_{21}$ by minimizing the sum of squared residuals across all pairs in a dataset.\n\nYour program must implement this inversion for each dataset in the following test suite. Use $R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$. All temperatures must be treated in Kelvin, and all outputs must be expressed in Joules per mole.\n\nTest suite (each dataset is a list of $(T,\\ x_{\\alpha},\\ x_{\\beta})$):\n\n- Dataset A (general multi-temperature case): $[(950,\\ 0.12,\\ 0.88),\\ (1050,\\ 0.18,\\ 0.82),\\ (1150,\\ 0.25,\\ 0.75)]$.\n- Dataset B (boundary case with minimal information): $[(1000,\\ 0.20,\\ 0.80)]$.\n- Dataset C (near-critical symmetric case): $[(1400,\\ 0.35,\\ 0.65),\\ (1500,\\ 0.40,\\ 0.60)]$.\n\nYour program should produce a single line of output containing the estimated values for $W_{12}$ and $W_{21}$ for each dataset, in the order A then B then C, rounded to the nearest integer and expressed in $\\mathrm{J\\,mol^{-1}}$. The exact format must be a comma-separated list enclosed in square brackets, with no spaces, for example, $[w_{12,A},w_{21,A},w_{12,B},w_{21,B},w_{12,C},w_{21,C}]$ where each $w_{\\cdot,\\cdot}$ is an integer.",
            "solution": "The problem requires the estimation of the asymmetric two-parameter Margules interaction parameters, $W_{12}$ and $W_{21}$, from experimental solvus data. The data consists of pairs of equilibrium compositions, $(x_{\\alpha,i}, x_{\\beta,i})$, at corresponding temperatures, $T_i$. The theoretical framework is the common-tangent construction applied to the Gibbs free energy of mixing, which leads to a set of linear equations in the unknowns $W_{12}$ and $W_{21}$. A linear least-squares method is employed to solve this overdetermined system.\n\nThe molar Gibbs free energy of mixing, $g_{\\mathrm{mix}}$, is given by\n$$\ng_{\\mathrm{mix}}(x,T) = RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big]\n$$\nwhere $x$ is the mole fraction of component $1$, $R$ is the Universal Gas Constant, and $T$ is the absolute temperature.\n\nThe two conditions for phase equilibrium at compositions $x_{\\alpha}$ and $x_{\\beta}$ are:\n1. Equality of the slopes of the tangent to $g_{\\mathrm{mix}}(x,T)$: $\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n2. Equality of the intercepts of the tangent lines: $g_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n\nWe will linearize these two conditions with respect to $W_{12}$ and $W_{21}$.\n\nFirst, we derive the first derivative of $g_{\\mathrm{mix}}(x,T)$ with respect to $x$:\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = \\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) + \\frac{d}{dx} \\left( g^E(x) \\right)\n$$\nThe derivative of the ideal mixing term is:\n$$\n\\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) = RT\\left(\\ln x + 1 - \\ln(1-x) - 1\\right) = RT \\ln\\left(\\frac{x}{1-x}\\right)\n$$\nThe excess energy term $g^E(x)$ can be written as $g^E(x) = W_{12}x(1-x)^2 + W_{21}x^2(1-x)$. Differentiating this gives:\n$$\n\\frac{d g^E}{dx} = W_{12}\\left((1-x)^2 - 2x(1-x)\\right) + W_{21}\\left(2x(1-x) - x^2\\right) = W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\nSo, the full derivative is:\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = RT \\ln\\left(\\frac{x}{1-x}\\right) + W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\n\nNow, we formulate the two linear equations for each data point $(T, x_{\\alpha}, x_{\\beta})$.\n\n**Equation 1: From the equality of derivatives**\nApplying the first equilibrium condition $\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$:\n$$\nRT \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right) + W_{12}(1-x_\\alpha)(1-3x_\\alpha) + W_{21}x_\\alpha(2-3x_\\alpha) = RT \\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) + W_{12}(1-x_\\beta)(1-3x_\\beta) + W_{21}x_\\beta(2-3x_\\beta)\n$$\nRearranging to group terms with $W_{12}$ and $W_{21}$:\n$$\nW_{12} \\underbrace{\\left[ (1-x_\\alpha)(1-3x_\\alpha) - (1-x_\\beta)(1-3x_\\beta) \\right]}_{A_1} + W_{21} \\underbrace{\\left[ x_\\alpha(2-3x_\\alpha) - x_\\beta(2-3x_\\beta) \\right]}_{B_1} = \\underbrace{RT\\left[\\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) - \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right)\\right]}_{C_1}\n$$\nThis gives our first linear equation for each data point: $A_1 W_{12} + B_1 W_{21} = C_1$.\n\n**Equation 2: From the equality of tangent intercepts**\nThe intercept term $g_{\\mathrm{mix}}(x) - x\\frac{d g_{\\mathrm{mix}}}{dx}$ is the chemical potential of component $2$, $\\mu_2(x)$.\n$$\n\\mu_2(x) = RT\\ln(1-x) + \\mu_2^E(x)\n$$\nwhere $\\mu_2^E(x) = g^E(x) - x\\frac{d g^E}{dx}$. Using our expressions for $g^E(x)$ and its derivative:\n$$\n\\mu_2^E(x) = \\left[W_{12}x(1-x)^2 + W_{21}x^2(1-x)\\right] - x\\left[W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\\right]\n$$\nAfter simplification, this becomes:\n$$\n\\mu_2^E(x) = W_{12}\\left(2x^2(1-x)\\right) + W_{21}\\left(x^2(2x-1)\\right)\n$$\nThe second equilibrium condition is $\\mu_2(x_\\alpha, T) = \\mu_2(x_\\beta, T)$:\n$$\nRT\\ln(1-x_\\alpha) + W_{12}(2x_\\alpha^2(1-x_\\alpha)) + W_{21}(x_\\alpha^2(2x_\\alpha-1)) = RT\\ln(1-x_\\beta) + W_{12}(2x_\\beta^2(1-x_\\beta)) + W_{21}(x_\\beta^2(2x_\\beta-1))\n$$\nRearranging to isolate $W_{12}$ and $W_{21}$:\n$$\nW_{12} \\underbrace{\\left[ 2x_\\alpha^2(1-x_\\alpha) - 2x_\\beta^2(1-x_\\beta) \\right]}_{A_2} + W_{21} \\underbrace{\\left[ x_\\alpha^2(2x_\\alpha-1) - x_\\beta^2(2x_\\beta-1) \\right]}_{B_2} = \\underbrace{RT\\left[\\ln(1-x_\\beta) - \\ln(1-x_\\alpha)\\right]}_{C_2}\n$$\nThis gives our second linear equation for each data point: $A_2 W_{12} + B_2 W_{21} = C_2$.\n\n**Least-Squares Formulation**\nFor a dataset with $N$ measurement points $\\{(T_i, x_{\\alpha,i}, x_{\\beta,i})\\}_{i=1}^N$, we obtain $2N$ linear equations for the two unknowns $W_{12}$ and $W_{21}$. This overdetermined system can be written in matrix form as $\\mathbf{M}\\mathbf{w} = \\mathbf{d}$, where $\\mathbf{w} = [W_{12}, W_{21}]^T$. The matrix $\\mathbf{M}$ and vector $\\mathbf{d}$ are assembled as:\n$$\n\\mathbf{M} = \\begin{pmatrix} A_{1,1}  B_{1,1} \\\\ A_{2,1}  B_{2,1} \\\\ A_{1,2}  B_{1,2} \\\\ A_{2,2}  B_{2,2} \\\\ \\vdots  \\vdots \\\\ A_{1,N}  B_{1,N} \\\\ A_{2,N}  B_{2,N} \\end{pmatrix}, \\quad\n\\mathbf{d} = \\begin{pmatrix} C_{1,1} \\\\ C_{2,1} \\\\ C_{1,2} \\\\ C_{2,2} \\\\ \\vdots \\\\ C_{1,N} \\\\ C_{2,N} \\end{pmatrix}\n$$\nThe goal is to find the vector $\\mathbf{w}$ that minimizes the sum of the squares of the residuals, $||\\mathbf{M}\\mathbf{w} - \\mathbf{d}||_2^2$. This is a standard linear least-squares problem, which can be solved numerically. The solution provides the best-fit estimates for $W_{12}$ and $W_{21}$.\n\nThe computational implementation will construct the matrix $\\mathbf{M}$ and vector $\\mathbf{d}$ from the provided datasets and use the `numpy.linalg.lstsq` function to find the optimal parameter values.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for Margules parameters for all test datasets.\n    \"\"\"\n    # Universal Gas Constant in J/(mol*K)\n    R = 8.314\n\n    # Test suite datasets\n    test_cases = {\n        \"A\": [(950, 0.12, 0.88), (1050, 0.18, 0.82), (1150, 0.25, 0.75)],\n        \"B\": [(1000, 0.20, 0.80)],\n        \"C\": [(1400, 0.35, 0.65), (1500, 0.40, 0.60)],\n    }\n\n    def calculate_w_params(dataset, R_const):\n        \"\"\"\n        Calculates W12 and W21 for a given dataset using least-squares inversion.\n\n        Args:\n            dataset (list): A list of tuples, where each tuple is (T, x_alpha, x_beta).\n            R_const (float): The Universal Gas Constant.\n\n        Returns:\n            tuple: A tuple containing the estimated (W12, W21).\n        \"\"\"\n        M_rows = []\n        d_vals = []\n\n        for T, xa, xb in dataset:\n            # First equilibrium condition: equality of derivatives\n            # A1*W12 + B1*W21 = C1\n            A1 = (1 - xa) * (1 - 3 * xa) - (1 - xb) * (1 - 3 * xb)\n            B1 = xa * (2 - 3 * xa) - xb * (2 - 3 * xb)\n            # Use a small epsilon to avoid log(0) if xa or xb are 0 or 1, although not needed for this problem's data\n            eps = 1e-12\n            C1 = R_const * T * (np.log(xb / (1 - xb + eps)) - np.log(xa / (1 - xa + eps)))\n\n            M_rows.append([A1, B1])\n            d_vals.append(C1)\n\n            # Second equilibrium condition: equality of tangent intercepts (chemical potential of comp 2)\n            # A2*W12 + B2*W21 = C2\n            A2 = 2 * xa**2 * (1 - xa) - 2 * xb**2 * (1 - xb)\n            B2 = xa**2 * (2 * xa - 1) - xb**2 * (2 * xb - 1)\n            C2 = R_const * T * (np.log(1 - xb + eps) - np.log(1 - xa + eps))\n            \n            M_rows.append([A2, B2])\n            d_vals.append(C2)\n\n        M = np.array(M_rows)\n        d = np.array(d_vals)\n\n        # Solve the system M*w = d using linear least-squares\n        # lstsq returns solution, residuals, rank, singular values\n        solution, _, _, _ = np.linalg.lstsq(M, d, rcond=None)\n        \n        W12, W21 = solution\n        return W12, W21\n\n    # Process all datasets and collect results\n    final_results = []\n    dataset_order = [\"A\", \"B\", \"C\"]\n\n    for key in dataset_order:\n        dataset = test_cases[key]\n        w12, w21 = calculate_w_params(dataset, R)\n        \n        # Round to the nearest integer as per problem specification\n        final_results.append(int(np.round(w12)))\n        final_results.append(int(np.round(w21)))\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With a calibrated model in hand, we can now tackle the forward problem: predicting the equilibrium state of a complex system. This exercise  applies the fundamental principle of Gibbs energy minimization to a two-phase assemblage, a common scenario in geochemistry. By using the method of Lagrange multipliers to enforce mass balance, you will calculate both the equilibrium composition of the non-ideal solid solution and the relative amounts of the coexisting phases, representing a cornerstone of computational thermodynamics.",
            "id": "4093005",
            "problem": "Consider a closed, isothermal, isobaric system containing two components, labeled as component $1$ and component $2$, and two phases: phase $s$ is a binary non-ideal solid solution of components $1$ and $2$, and phase $p$ is a pure phase of component $2$. The universal gas constant $R$ is the constant that scales thermal energy per mole per Kelvin. Work at fixed absolute temperature $T$, with fixed bulk molar amounts $N_{1}$ and $N_{2}$ of components $1$ and $2$, respectively. Let the molar Gibbs energy of pure endmember $1$ in phase $s$ be $G_{1}^{0}$, the molar Gibbs energy of pure endmember $2$ in phase $s$ be $G_{2}^{0}$, and the molar Gibbs energy of phase $p$ be $G_{p}^{0}$, all expressed in Joules per mole. The non-ideality of phase $s$ is described by an asymmetric two-suffix Margules regular solution model with parameters $W_{12}$ and $W_{21}$, each expressed in Joules per mole. Assume all quantities are thermodynamically consistent, and that phase $p$ contains only component $2$.\n\nLet $n_{s}$ and $n_{p}$ denote the total moles in phases $s$ and $p$, respectively, and let $x$ denote the mole fraction of component $1$ in phase $s$, so the mole fraction of component $2$ in phase $s$ is $1-x$. The total Gibbs energy of the system is the sum of each phase’s total Gibbs energy. Mass balance requires that the distribution of components among phases must conserve $N_{1}$ and $N_{2}$.\n\nStarting only from the following fundamental bases:\n- The definition of molar Gibbs energy of a mixture as the sum of an ideal mixing contribution and an excess contribution governed by a regular solution model,\n- The definition of chemical potentials as partial derivatives of total Gibbs energy with respect to component moles,\n- The method of Lagrange multipliers to enforce equality constraints in variational problems,\nderive the stationary conditions for minimizing total Gibbs energy of the assemblage subject to mass balance. In particular, formulate the Lagrangian with multipliers to enforce mass conservation of component $1$ and component $2$, and derive the necessary condition that determines the equilibrium composition $x$ of phase $s$ and the equilibrium phase amounts $n_{s}$ and $n_{p}$.\n\nThen implement a numerical algorithm that, given $(T, R, G_{1}^{0}, G_{2}^{0}, G_{p}^{0}, W_{12}, W_{21}, N_{1}, N_{2})$, solves for the equilibrium composition $x$ (mole fraction of component $1$ in phase $s$) and computes the minimized total Gibbs energy $G_{\\mathrm{tot}}$ of the assemblage. The algorithm should:\n- Use the stationarity conditions obtained via Lagrange multipliers,\n- Evaluate the molar Gibbs energy of phase $s$ as a function of $x$ by combining the ideal and excess parts, and\n- Use a robust one-dimensional bounded numerical method to solve for $x$ within the open interval $(0,1)$.\n\nFor this problem, all energies must be expressed in Joules, temperature in Kelvin, and amounts in moles. Angles do not appear. Report the equilibrium composition as a decimal fraction. The final output for each test case must be a list of two floating-point numbers $[x, G_{\\mathrm{tot}}]$, where $x$ is the equilibrium mole fraction of component $1$ in phase $s$ (dimensionless), and $G_{\\mathrm{tot}}$ is the minimized total Gibbs energy in Joules. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one list per test case, for example, $[[x_{1},G_{\\mathrm{tot},1}],[x_{2},G_{\\mathrm{tot},2}],\\dots]$.\n\nUse the following test suite, designed to probe typical behavior, ideal-limit behavior, strong asymmetry, and low-temperature sensitivity. Each tuple is $(T, R, G_{1}^{0}, G_{2}^{0}, G_{p}^{0}, W_{12}, W_{21}, N_{1}, N_{2})$:\n- Test $1$ (general non-ideal, happy path): $(T=$ $1000$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5400$, $G_{2}^{0}=$ $-5000$, $G_{p}^{0}=$ $-5200$, $W_{12}=$ $2000$, $W_{21}=$ $1000$, $N_{1}=$ $0.3$, $N_{2}=$ $0.7)$\n- Test $2$ (ideal-solution limit): $(T=$ $1000$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5400$, $G_{2}^{0}=$ $-5000$, $G_{p}^{0}=$ $-5200$, $W_{12}=$ $0$, $W_{21}=$ $0$, $N_{1}=$ $0.25$, $N_{2}=$ $0.75)$\n- Test $3$ (strong asymmetry, larger positive non-ideality): $(T=$ $800$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-4800$, $G_{2}^{0}=$ $-4700$, $G_{p}^{0}=$ $-4900$, $W_{12}=$ $6000$, $W_{21}=$ $3000$, $N_{1}=$ $0.45$, $N_{2}=$ $0.55)$\n- Test $4$ (low temperature, small $N_{1}$ sensitivity): $(T=$ $298$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5500$, $G_{2}^{0}=$ $-5400$, $G_{p}^{0}=$ $-5500$, $W_{12}=$ $500$, $W_{21}=$ $500$, $N_{1}=$ $0.0001$, $N_{2}=$ $1.0)$\n\nYour program must implement the above and produce a single line of output of the form $[[x_{1},G_{\\mathrm{tot},1}],[x_{2},G_{\\mathrm{tot},2}],[x_{3},G_{\\mathrm{tot},3}],[x_{4},G_{\\mathrm{tot},4}]]$, with each $x_{i}$ and $G_{\\mathrm{tot},i}$ evaluated for test $i$ in the specified units. No extraneous text should be printed.",
            "solution": "The problem requires the derivation of thermodynamic equilibrium conditions for a binary, two-phase system and the implementation of a numerical algorithm to find the equilibrium state. The system is closed and held at constant temperature $T$ and pressure $P$. Equilibrium is therefore determined by the minimum of the total Gibbs energy, $G_{\\mathrm{tot}}$, subject to mass balance constraints.\n\n### 1. Total Gibbs Energy of the Assemblage\n\nThe system consists of a binary solid solution, phase $s$, and a pure phase of component $2$, phase $p$. Let $n_s$ and $n_p$ be the total moles of phase $s$ and phase $p$, respectively. The total Gibbs energy of the system is the sum of the Gibbs energies of the individual phases:\n$$G_{\\mathrm{tot}} = G_s + G_p$$\nThe Gibbs energy of phase $p$, which is pure component $2$, is given by:\n$$G_p = n_p G_p^0$$\nwhere $G_p^0$ is the molar Gibbs energy of phase $p$.\n\nThe Gibbs energy of phase $s$, the solid solution, is $G_s = n_s G_s^{\\text{molar}}$, where $G_s^{\\text{molar}}$ is the molar Gibbs energy of the solution. Let $x$ be the mole fraction of component $1$ in phase $s$; the mole fraction of component $2$ is then $1-x$. The molar Gibbs energy of the solution is the sum of the energies of the pure endmembers (mechanical mixture), the ideal energy of mixing, and the excess energy of mixing:\n$$G_s^{\\text{molar}}(x) = \\underbrace{x G_1^0 + (1-x) G_2^0}_{\\text{Mechanical Mixture}} + \\underbrace{RT [x \\ln(x) + (1-x) \\ln(1-x)]}_{\\Delta G_{\\text{mix}}^{\\text{ideal}}} + \\underbrace{G^{\\text{excess}}(x)}_{\\text{Excess Energy}}$$\nHere, $G_1^0$ and $G_2^0$ are the molar Gibbs energies of the pure endmembers $1$ and $2$ in the structure of phase $s$, and $R$ is the universal gas constant. The non-ideality is described by an asymmetric two-suffix Margules model for the excess Gibbs energy:\n$$G^{\\text{excess}}(x) = x(1-x)[(1-x)W_{12} + xW_{21}]$$\nwhere $W_{12}$ and $W_{21}$ are the Margules interaction parameters.\n\nThus, the total Gibbs energy of the system is a function of the independent variables $n_s$, $n_p$, and $x$:\n$$G_{\\mathrm{tot}}(n_s, n_p, x) = n_s G_s^{\\text{molar}}(x) + n_p G_p^0$$\n\n### 2. Mass Balance Constraints and Lagrangian Formulation\n\nThe total moles of component $1$, $N_1$, and component $2$, $N_2$, in the system are fixed. This imposes two mass balance constraints. Let $n_{1,s}$ and $n_{2,s}$ be the moles of components $1$ and $2$ in phase $s$, and $n_{1,p}$ and $n_{2,p}$ be the moles in phase $p$.\nBy definition, $n_{1,s} = n_s x$ and $n_{2,s} = n_s(1-x)$. Since phase $p$ is pure component $2$, we have $n_{1,p} = 0$ and $n_{2,p} = n_p$. The constraints are:\n$$c_1: n_{1,s} - N_1 = n_s x - N_1 = 0$$\n$$c_2: n_{2,s} + n_{2,p} - N_2 = n_s(1-x) + n_p - N_2 = 0$$\n\nTo find the minimum of $G_{\\mathrm{tot}}$ subject to these constraints, we use the method of Lagrange multipliers. We define the Lagrangian, $\\mathcal{L}$, using the more fundamental variables $n_{1,s}$, $n_{2,s}$, and $n_p=n_{2,p}$:\n$$\\mathcal{L}(n_{1,s}, n_{2,s}, n_p, \\lambda_1, \\lambda_2) = G_{\\mathrm{tot}}(n_{1,s}, n_{2,s}, n_p) - \\lambda_1(n_{1,s} - N_1) - \\lambda_2(n_{2,s} + n_p - N_2)$$\nThe total Gibbs energy expressed in these variables is:\n$$G_{\\mathrm{tot}} = (n_{1,s} + n_{2,s})G_s^{\\text{molar}}\\left(\\frac{n_{1,s}}{n_{1,s} + n_{2,s}}\\right) + n_p G_p^0$$\nAt equilibrium, the partial derivatives of $\\mathcal{L}$ with respect to each variable must be zero. The partial derivatives of $G_{\\mathrm{tot}}$ are the chemical potentials:\n- $\\mu_{1,s} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_{1,s}}\\right)_{n_{2,s}, n_p}$\n- $\\mu_{2,s} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_{2,s}}\\right)_{n_{1,s}, n_p}$\n- $\\mu_{2,p} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_p}\\right)_{n_{1,s}, n_{2,s}} = G_p^0$\n\nThe stationary conditions are:\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{1,s}} = \\mu_{1,s} - \\lambda_1 = 0 \\implies \\mu_{1,s} = \\lambda_1$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{2,s}} = \\mu_{2,s} - \\lambda_2 = 0 \\implies \\mu_{2,s} = \\lambda_2$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_p} = \\mu_{2,p} - \\lambda_2 = 0 \\implies \\mu_{2,p} = \\lambda_2$$\nCombining these results yields the condition for heterogeneous equilibrium: the chemical potential of each component must be equal in all phases in which it is present. For component $2$, which is present in both phases, this means:\n$$\\mu_{2,s} = \\mu_{2,p}$$\n\n### 3. Derivation of the Equilibrium Condition\n\nThe chemical potential of component $2$ in the pure phase $p$ is simply its molar Gibbs energy, $\\mu_{2,p} = G_p^0$.\nFor the solid solution, phase $s$, the chemical potential of component $2$ is given by $\\mu_{2,s} = G_2^0 + RT\\ln(a_2)$, where $a_2$ is the activity of component $2$. The activity is the product of mole fraction and an activity coefficient, $a_2 = (1-x)\\gamma_2$. The activity coefficient is related to the partial molar excess Gibbs energy, $G_2^{\\text{excess}} = RT\\ln\\gamma_2$. For the specified asymmetric Margules model, this is:\n$$RT\\ln\\gamma_2 = G_2^{\\text{excess}} = x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\nTherefore, the chemical potential of component $2$ in phase $s$ is:\n$$\\mu_{2,s}(x) = G_2^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\nThe equilibrium condition $\\mu_{2,s} = \\mu_{2,p}$ becomes a single nonlinear equation for the unknown equilibrium composition $x$:\n$$G_2^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})] = G_p^0$$\nThis is the necessary stationary condition that determines $x$.\n\n### 4. Numerical Solution Algorithm\n\nThe problem reduces to finding the root of the following function for $x \\in (0,1)$:\n$$f(x) = G_2^0 - G_p^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\nA robust, bounded root-finding method, such as Brent's method, is suitable for solving $f(x)=0$.\n\nOnce the equilibrium composition $x_{eq}$ is determined, the phase amounts $n_s$ and $n_p$ are found from the mass balance constraints:\n$$n_s = \\frac{N_1}{x_{eq}}$$\n$$n_p = N_2 - n_s(1-x_{eq}) = N_2 - \\frac{N_1(1-x_{eq})}{x_{eq}}$$\nA physical solution requires $n_p \\ge 0$, which implies $x_{eq} \\ge N_1 / (N_1+N_2)$. The problem setup presumes a two-phase equilibrium exists, so we expect this condition to be met.\n\nFinally, the minimized total Gibbs energy $G_{\\mathrm{tot}}$ is calculated by substituting $x_{eq}$, $n_s$, and $n_p$ back into the total energy expression:\n$$G_{\\mathrm{tot}} = n_s G_s^{\\text{molar}}(x_{eq}) + n_p G_p^0$$\nwhere $G_s^{\\text{molar}}(x_{eq})$ is evaluated at the equilibrium composition. The algorithm implemented will perform these steps for each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Derives and solves for the thermodynamic equilibrium of a binary, two-phase system.\n    The system consists of a non-ideal solid solution (phase s) and a pure phase (phase p).\n    Equilibrium composition and total Gibbs energy are calculated for several test cases.\n    \"\"\"\n    \n    # Test cases: (T, R, G1_0, G2_0, Gp_0, W12, W21, N1, N2)\n    test_cases = [\n        # Test 1 (general non-ideal, happy path)\n        (1000, 8.314462618, -5400, -5000, -5200, 2000, 1000, 0.3, 0.7),\n        # Test 2 (ideal-solution limit)\n        (1000, 8.314462618, -5400, -5000, -5200, 0, 0, 0.25, 0.75),\n        # Test 3 (strong asymmetry, larger positive non-ideality)\n        (800, 8.314462618, -4800, -4700, -4900, 6000, 3000, 0.45, 0.55),\n        # Test 4 (low temperature, small N1 sensitivity)\n        (298, 8.314462618, -5500, -5400, -5500, 500, 500, 0.0001, 1.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T, R, G1_0, G2_0, Gp_0, W12, W21, N1, N2 = case\n\n        def equilibrium_condition_func(x):\n            \"\"\"\n            This function is f(x) = mu_2_s(x) - Gp_0, the root of which gives the\n            equilibrium composition x.\n            f(x) = G2_0 - Gp_0 + RT*ln(1-x) + x^2*[W21 + 2*(1-x)*(W12-W21)]\n            \"\"\"\n            if x = 0 or x >= 1:\n                return np.nan\n            \n            # RT*ln(a2) term for component 2 in solid solution s\n            # a2 = (1-x)*gamma2\n            # RT*ln(gamma2) = x^2*[W21 + 2*(1-x)*(W12-W21)]\n            \n            rt_log_term = R * T * np.log(1 - x)\n            \n            excess_term = x**2 * (W21 + 2 * (1 - x) * (W12 - W21))\n            \n            return G2_0 - Gp_0 + rt_log_term + excess_term\n\n        # Solve for the equilibrium mole fraction x in phase s using a robust\n        # bounded root-finding method (Brent's method).\n        # The search interval is set slightly inside (0, 1) to avoid log domain errors.\n        try:\n            # All test cases have G2_0 - Gp_0 > 0, so f(0) > 0.\n            # As x -> 1, f(x) -> -inf. A root is guaranteed in (0,1).\n            x_eq = optimize.brentq(equilibrium_condition_func, 1e-9, 1 - 1e-9, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This would happen if f(a) and f(b) have the same sign, which\n            # indicates no or an even number of roots.\n            # This case suggests the two-phase assemblage is not stable.\n            # The problem presumes such an equilibrium exists.\n            results.append([np.nan, np.nan])\n            continue\n        \n        # Once x_eq is found, calculate phase proportions and total Gibbs energy.\n        \n        # 1. Calculate molar Gibbs energy of phase s at equilibrium composition\n        def get_G_s_molar(x):\n            \"\"\"\n            Calculates molar Gibbs energy of the solid solution phase s.\n            G_s_molar = G_mech + G_ideal_mix + G_excess\n            \"\"\"\n            if x = 0 or x >= 1:\n                return np.nan\n\n            g_mechanical = x * G1_0 + (1 - x) * G2_0\n            g_ideal_mixing = R * T * (x * np.log(x) + (1 - x) * np.log(1 - x))\n            g_excess = x * (1 - x) * ((1 - x) * W12 + x * W21)\n            \n            return g_mechanical + g_ideal_mixing + g_excess\n\n        Gs_molar_eq = get_G_s_molar(x_eq)\n        \n        # 2. Calculate mole amounts of each phase from mass balance\n        # n_s*x_eq = N1\n        n_s = N1 / x_eq\n        # n_s*(1-x_eq) + n_p = N2\n        n_p = N2 - n_s * (1 - x_eq)\n        \n        # 3. Calculate total minimized Gibbs energy\n        # G_tot = n_s * G_s_molar + n_p * G_p_0\n        G_tot = n_s * Gs_molar_eq + n_p * Gp_0\n        \n        results.append([x_eq, G_tot])\n\n    # Format output as specified: [[x1,G_tot1],[x2,G_tot2],...]\n    # Using a list comprehension and string formatting to achieve the exact output string.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}