{
    "hands_on_practices": [
        {
            "introduction": "地球化学模拟中的计算网格往往是不均匀的，以适应复杂的地质结构。本练习旨在通过泰勒级数展开，从第一性原理出发，为非均匀网格推导一个二阶精度的中心差分格式，这是计算扩散通量等物理量的一项基本技能。通过将推导出的格式应用于一个已知函数，你将能够亲手计算离散梯度并评估其精度。",
            "id": "4079148",
            "problem": "在计算地球化学中，一维反应输运计算需要评估空间梯度，以根据 Fick 第一定律计算扩散通量，其中通量与物种浓度场的梯度成正比。考虑一个非均匀网格上的无量纲浓度场 $u(x) = \\exp(x)$，该网格有三个连续节点 $x_{i-1}$、$x_{i}$ 和 $x_{i+1}$，使得 $h_{i-1} = x_{i} - x_{i-1}$ 且 $h_{i} = x_{i+1} - x_{i}$。您的任务是，使用有限差分法 (FDM) 在此非均匀网格上，为 $u^{\\prime}(x_{i})$ 推导一个二阶精度的离散梯度近似。推导过程从 $x_{i}$ 点的泰勒级数展开开始，并施加必要的条件以重现 $u^{\\prime}(x_{i})$，同时消除低阶截断项。\n\n设网格间距和评估点分别为 $h_{i-1} = 0.08$、$h_{i} = 0.12$ 和 $x_{i} = 0.30$。使用您推导出的二阶精度非均匀中心差分公式，通过代入精确的节点值 $u_{i-1} = u(x_{i-1})$、$u_{i} = u(x_{i})$ 和 $u_{i+1} = u(x_{i+1})$，计算 $u^{\\prime}(x_{i})$ 的离散梯度近似值。然后计算精确导数 $u^{\\prime}(x_{i})$ 以及离散近似值与精确导数之间的绝对误差大小。\n\n将最终的绝对误差四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位。",
            "solution": "### 第一部分：二阶非均匀差分公式的推导\n\n目标是找到一阶导数 $u^{\\prime}(x_i)$ 的离散近似，其形式为：\n$$\nu^{\\prime}(x_i) \\approx c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1}\n$$\n其中 $u_j = u(x_j)$。系数 $c_{-1}$、$c_0$ 和 $c_1$ 通过强制实现二阶精度来确定。这是通过使用 $u(x_{i-1})$ 和 $u(x_{i+1})$ 在点 $x_i$ 附近的泰勒级数展开来实现的。网格间距为 $h_{i-1} = x_i - x_{i-1}$ 和 $h_i = x_{i+1} - x_i$。\n\n泰勒级数展开为：\n$$\nu_{i-1} = u(x_i - h_{i-1}) = u_i - h_{i-1} u_i^{\\prime} + \\frac{h_{i-1}^2}{2} u_i^{\\prime\\prime} - \\frac{h_{i-1}^3}{6} u_i^{\\prime\\prime\\prime} + \\mathcal{O}(h_{i-1}^4)\n$$\n$$\nu_{i+1} = u(x_i + h_i) = u_i + h_i u_i^{\\prime} + \\frac{h_i^2}{2} u_i^{\\prime\\prime} + \\frac{h_i^3}{6} u_i^{\\prime\\prime\\prime} + \\mathcal{O}(h_i^4)\n$$\n将这些展开式代入近似公式：\n$$\nc_{-1} \\left( u_i - h_{i-1} u_i^{\\prime} + \\frac{h_{i-1}^2}{2} u_i^{\\prime\\prime} + \\dots \\right) + c_0 u_i + c_1 \\left( u_i + h_i u_i^{\\prime} + \\frac{h_i^2}{2} u_i^{\\prime\\prime} + \\dots \\right)\n$$\n按 $u$ 在 $x_i$ 处的导数对各项进行分组：\n$$\n(c_{-1} + c_0 + c_1) u_i + (-c_{-1} h_{i-1} + c_1 h_i) u_i^{\\prime} + \\left(c_{-1} \\frac{h_{i-1}^2}{2} + c_1 \\frac{h_i^2}{2}\\right) u_i^{\\prime\\prime} + \\mathcal{O}(h^3)\n$$\n为了使该表达式近似 $u_i^{\\prime}$，我们强制执行以下条件：\n1.  $u_i$ 的系数必须为 $0$：$c_{-1} + c_0 + c_1 = 0$。\n2.  $u_i^{\\prime}$ 的系数必须为 $1$：$-c_{-1} h_{i-1} + c_1 h_i = 1$。\n3.  为了达到二阶精度，$u_i^{\\prime\\prime}$ 的系数必须为 $0$：$c_{-1} h_{i-1}^2 + c_1 h_i^2 = 0$。\n\n根据条件 3：\n$c_{-1} = -c_1 \\frac{h_i^2}{h_{i-1}^2}$。\n\n将此结果代入条件 2：\n$- \\left(-c_1 \\frac{h_i^2}{h_{i-1}^2}\\right) h_{i-1} + c_1 h_i = 1 \\implies c_1 \\frac{h_i^2}{h_{i-1}} + c_1 h_i = 1$\n$c_1 \\left( \\frac{h_i^2 + h_i h_{i-1}}{h_{i-1}} \\right) = 1 \\implies c_1 \\frac{h_i(h_i + h_{i-1})}{h_{i-1}} = 1$\n$$\nc_1 = \\frac{h_{i-1}}{h_i(h_i + h_{i-1})}\n$$\n现在，我们求 $c_{-1}$：\n$$\nc_{-1} = - \\left( \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} \\right) \\frac{h_i^2}{h_{i-1}^2} = -\\frac{h_i}{h_{i-1}(h_i + h_{i-1})}\n$$\n最后，根据条件 1，我们求 $c_0$：\n$c_0 = -c_{-1} - c_1 = \\frac{h_i}{h_{i-1}(h_i + h_{i-1})} - \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} = \\frac{h_i^2 - h_{i-1}^2}{h_i h_{i-1}(h_i + h_{i-1})}$\n$c_0 = \\frac{(h_i - h_{i-1})(h_i + h_{i-1})}{h_i h_{i-1}(h_i + h_{i-1})} = \\frac{h_i - h_{i-1}}{h_i h_{i-1}}$\n$$\nc_0 = \\frac{h_i - h_{i-1}}{h_i h_{i-1}}\n$$\n因此，非均匀网格上 $u^{\\prime}(x_i)$ 的二阶精度有限差分近似为：\n$$\nu^{\\prime}(x_i) \\approx \\left( -\\frac{h_i}{h_{i-1}(h_i + h_{i-1})} \\right) u_{i-1} + \\left( \\frac{h_i - h_{i-1}}{h_i h_{i-1}} \\right) u_i + \\left( \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} \\right) u_{i+1}\n$$\n\n### 第二部分：数值计算\n\n题目给出了以下数值：\n$h_{i-1} = 0.08$\n$h_i = 0.12$\n$x_i = 0.30$\n浓度场为 $u(x) = \\exp(x)$。\n\n首先，我们计算系数的数值：\n$h_i + h_{i-1} = 0.12 + 0.08 = 0.20$\n$h_i h_{i-1} = 0.12 \\times 0.08 = 0.0096$\n$c_{-1} = -\\frac{0.12}{0.08(0.20)} = -\\frac{0.12}{0.016} = -7.5$\n$c_0 = \\frac{0.12 - 0.08}{0.0096} = \\frac{0.04}{0.0096} = \\frac{400}{96} = \\frac{25}{6}$\n$c_1 = \\frac{0.08}{0.12(0.20)} = \\frac{0.08}{0.024} = \\frac{80}{24} = \\frac{10}{3}$\n\n接下来，我们确定网格点：\n$x_i = 0.30$\n$x_{i-1} = x_i - h_{i-1} = 0.30 - 0.08 = 0.22$\n$x_{i+1} = x_i + h_i = 0.30 + 0.12 = 0.42$\n\n我们在这些点上计算函数 $u(x)$ 的值：\n$u_{i-1} = u(0.22) = \\exp(0.22)$\n$u_i = u(0.30) = \\exp(0.30)$\n$u_{i+1} = u(0.42) = \\exp(0.42)$\n\n现在，我们计算离散梯度近似值，记为 $u'_{approx}$：\n$$\nu'_{approx} = c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1} = -7.5 \\exp(0.22) + \\frac{25}{6} \\exp(0.30) + \\frac{10}{3} \\exp(0.42)\n$$\n使用高精度值：\n$\\exp(0.22) \\approx 1.246076731$\n$\\exp(0.30) \\approx 1.349858808$\n$\\exp(0.42) \\approx 1.521961556$\n$u'_{approx} \\approx -7.5(1.246076731) + \\frac{25}{6}(1.349858808) + \\frac{10}{3}(1.521961556)$\n$u'_{approx} \\approx -9.345575483 + 5.624411700 + 5.073205187$\n$u'_{approx} \\approx 1.352041404$\n\n### 第三部分：精确导数与绝对误差\n\n$u(x) = \\exp(x)$ 的精确导数是 $u'(x) = \\exp(x)$。\n在 $x_i = 0.30$ 处，精确导数为：\n$$\nu'_{exact} = u'(0.30) = \\exp(0.30) \\approx 1.349858808\n$$\n绝对误差 $E$ 是近似值与精确值之差的绝对值：\n$$\nE = |u'_{approx} - u'_{exact}|\n$$\n$$\nE = |1.352041404 - 1.349858808| = 0.002182596\n$$\n题目要求将最终的绝对误差四舍五入到四位有效数字。\n$0.002182596$ 的前四位有效数字是 $2$、$1$、$8$、$2$。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$\nE \\approx 0.002183\n$$",
            "answer": "$$\\boxed{0.002183}$$"
        },
        {
            "introduction": "在处理地球化学系统的边界时，我们常常会遇到复杂的混合边界条件。这个练习模拟了在含水层角点处同时存在对流传质（Robin条件）和指定通量（Neumann条件）的真实情景。你需要为这个角点节点构建一个能够同时满足两种边界条件的离散格式，这对于准确模拟物质在不同物理边界间的交换至关重要。",
            "id": "4079159",
            "problem": "考虑一个二维矩形含水层区域，其中溶解物质的浓度场 $C(x,y)$ 处于稳态，并由菲克扩散控制。位于 $x=0$ 的左边界通过对流传质定律（罗宾条件）与外部储库进行溶质交换，而位于 $y=0$ 的底边界则具有指定的向上扩散通量（诺伊曼条件）。设扩散通量矢量由菲克第一定律给出，$\\mathbf{J}=-D \\nabla C$，其中 $D$ 是分子扩散系数，且边界定律指定为\n$$-D\\,\\partial_{x}C(0,y)=h\\big(C(0,y)-C_{L}\\big),\\qquad -D\\,\\partial_{y}C(x,0)=q_{b},$$\n其中 $D>0$, $h>0$，$C_{L}$ 是储库浓度，$q_{b}$ 是底部通量。在间距为 $\\Delta x=\\Delta y$ 的均匀笛卡尔网格上对该区域进行离散化，并用 $C_{i,j}=C(i\\,\\Delta x,\\,j\\,\\Delta y)$ 表示节点值。在角点 $(i,j)=(0,0)$ 处，你必须构建一个二阶精度的单边有限差分格式，该格式通过使用 $\\{C_{0,0},C_{1,0},C_{2,0}\\}$ 表示 $\\partial_{x}C(0,0)$ 和使用 $\\{C_{0,0},C_{0,1},C_{0,2}\\}$ 表示 $\\partial_{y}C(0,0)$，从而在不引入虚拟未知数的情况下同时强制施加两个边界条件。\n\n从第一性原理出发：从菲克第一定律和角点周围的泰勒级数展开开始，以证明你所使用的二阶单边公式的合理性。然后，根据罗宾和诺伊曼边界定律推导 $C_{0,0}$ 的两个线性表达式，并验证对于下面给出的数据，它们是一致的（即，在截断误差范围内，它们为 $C_{0,0}$ 得出相同的数值）。最后，计算 $C_{0,0}$。\n\n使用以下物理上合理的参数和相邻节点值：\n- $D=1.6\\times 10^{-9}$ m$^{2}$ s$^{-1}$, $h=2.5\\times 10^{-6}$ m s$^{-1}$, $C_{L}=1.000$ mol m$^{-3}$,\n- $\\Delta x=\\Delta y=0.100$ m,\n- $q_{b}=8.31027264\\times 10^{-11}$ mol m$^{-2}$ s$^{-1}$,\n- $C_{1,0}=0.980$ mol m$^{-3}$, $C_{2,0}=0.960$ mol m$^{-3}$, $C_{0,1}=0.990$ mol m$^{-3}$, $C_{0,2}=0.970$ mol m$^{-3}$.\n\n你的任务是：\n1. 从泰勒展开推导 $\\partial_{x}C(0,0)$ 和 $\\partial_{y}C(0,0)$ 的二阶单边公式。\n2. 在边界定律中使用这些公式，以获得用给定参数和相邻节点值表示的 $C_{0,0}$ 的两个代数表达式。\n3. 对两个表达式进行数值评估以验证其一致性，并报告角点浓度。\n\n以 mol m$^{-3}$ 为单位表示最终浓度，并将你的答案四舍五入到六位有效数字。",
            "solution": "该问题要求为一个受两个不同边界条件约束的角点推导数值方案，并随后计算该节点处的浓度 $C_{0,0}$。\n\n**1. 二阶单边有限差分公式的推导**\n\n我们寻求在点 $x_0$ 处一阶导数 $\\partial_x C$ 的一个二阶精度近似，使用 $x_0$、$x_1 = x_0+\\Delta x$ 和 $x_2 = x_0+2\\Delta x$ 处的值。我们从 $C(x_1)$ 和 $C(x_2)$ 在 $x_0$ 点的泰勒级数展开开始：\n$$C(x_1) = C(x_0) + \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{x_0} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{x_0} + O((\\Delta x)^3)$$\n$$C(x_2) = C(x_0) + (2\\Delta x) \\frac{\\partial C}{\\partial x}\\bigg|_{x_0} + \\frac{(2\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{x_0} + O((\\Delta x)^3)$$\n用离散记法，令 $C_i = C(x_0 + i\\Delta x)$：\n$$C_1 = C_0 + \\Delta x \\, C'_0 + \\frac{(\\Delta x)^2}{2} C''_0 + O((\\Delta x)^3)$$\n$$C_2 = C_0 + 2\\Delta x \\, C'_0 + 2(\\Delta x)^2 C''_0 + O((\\Delta x)^3)$$\n为了得到 $C'_0$ 的二阶精度公式，我们必须消去 $C''_0$ 项。我们将第一个方程乘以4，然后减去第二个方程：\n$$4C_1 - C_2 = (4C_0 - C_0) + (4\\Delta x - 2\\Delta x)C'_0 + (2(\\Delta x)^2 - 2(\\Delta x)^2)C''_0 + O((\\Delta x)^3)$$\n$$4C_1 - C_2 = 3C_0 + 2\\Delta x \\, C'_0 + O((\\Delta x)^3)$$\n求解 $C'_0$：\n$$2\\Delta x \\, C'_0 = -3C_0 + 4C_1 - C_2 + O((\\Delta x)^3)$$\n$$C'_0 = \\frac{-3C_0 + 4C_1 - C_2}{2\\Delta x} + O((\\Delta x)^2)$$\n截断误差为 $(\\Delta x)^2$ 阶，因此该公式是二阶精度的。将此应用于角点 $(0,0)$ 处的偏导数：\n$$\\partial_{x}C(0,0) \\approx \\frac{-3C_{0,0} + 4C_{1,0} - C_{2,0}}{2\\Delta x}$$\n对于 $y$ 方向，由于 $\\Delta y = \\Delta x$，通过类比可得：\n$$\\partial_{y}C(0,0) \\approx \\frac{-3C_{0,0} + 4C_{0,1} - C_{0,2}}{2\\Delta y}$$\n\n**2. $C_{0,0}$ 的代数表达式**\n\n我们现在将这些有限差分近似代入两个边界条件。\n\n**根据 $x=0$ 处的罗宾条件：**\n条件为 $-D\\,\\partial_{x}C(0,0)=h\\big(C(0,0)-C_{L}\\big)$。代入 $\\partial_{x}C(0,0)$ 的公式：\n$$-D \\left( \\frac{-3C_{0,0} + 4C_{1,0} - C_{2,0}}{2\\Delta x} \\right) = h(C_{0,0} - C_{L})$$\n我们求解 $C_{0,0}$。我们将此表达式称为 $C_{0,0}^{(\\text{Robin})}$。\n$$D(3C_{0,0} - 4C_{1,0} + C_{2,0}) = 2\\Delta x h(C_{0,0} - C_{L})$$\n$$3DC_{0,0} - 4DC_{1,0} + DC_{2,0} = 2\\Delta x h C_{0,0} - 2\\Delta x h C_{L}$$\n$$C_{0,0}(3D - 2\\Delta x h) = 4DC_{1,0} - DC_{2,0} - 2\\Delta x h C_{L}$$\n$$C_{0,0}^{(\\text{Robin})} = \\frac{4DC_{1,0} - DC_{2,0} - 2\\Delta x h C_{L}}{3D - 2\\Delta x h}$$\n\n**根据 $y=0$ 处的诺伊曼条件：**\n条件为 $-D\\,\\partial_{y}C(x,0)=q_{b}$，在角点处即为 $-D\\,\\partial_{y}C(0,0)=q_{b}$。代入 $\\partial_{y}C(0,0)$ 的公式：\n$$-D \\left( \\frac{-3C_{0,0} + 4C_{0,1} - C_{0,2}}{2\\Delta y} \\right) = q_b$$\n我们求解 $C_{0,0}$。我们将此表达式称为 $C_{0,0}^{(\\text{Neumann})}$。由于 $\\Delta y = \\Delta x$：\n$$D(3C_{0,0} - 4C_{0,1} + C_{0,2}) = 2\\Delta x q_b$$\n$$3DC_{0,0} = 4DC_{0,1} - DC_{0,2} + 2\\Delta x q_b$$\n$$C_{0,0}^{(\\text{Neumann})} = \\frac{4DC_{0,1} - DC_{0,2} + 2\\Delta x q_b}{3D}$$\n\n**3. 数值评估与一致性验证**\n\n我们现在将给定的数值代入 $C_{0,0}$ 的两个表达式中。\n参数为：\n$D=1.6\\times 10^{-9}$, $h=2.5\\times 10^{-6}$, $C_{L}=1.000$, $\\Delta x=0.100$, $q_{b}=8.31027264\\times 10^{-11}$, $C_{1,0}=0.980$, $C_{2,0}=0.960$, $C_{0,1}=0.990$, $C_{0,2}=0.970$.\n\n**$C_{0,0}^{(\\text{Robin})}$ 的计算：**\n分子：$N_R = D(4C_{1,0} - C_{2,0}) - 2\\Delta x h C_L$\n$N_R = (1.6 \\times 10^{-9})(4(0.980) - 0.960) - 2(0.100)(2.5 \\times 10^{-6})(1.000)$\n$N_R = (1.6 \\times 10^{-9})(2.960) - 5.0 \\times 10^{-7} = 4.736 \\times 10^{-9} - 5.0 \\times 10^{-7} = -4.95264 \\times 10^{-7}$\n分母：$D_R = 3D - 2\\Delta x h$\n$D_R = 3(1.6 \\times 10^{-9}) - 2(0.100)(2.5 \\times 10^{-6}) = 4.8 \\times 10^{-9} - 5.0 \\times 10^{-7} = -4.952 \\times 10^{-7}$\n$$C_{0,0}^{(\\text{Robin})} = \\frac{N_R}{D_R} = \\frac{-4.95264 \\times 10^{-7}}{-4.952 \\times 10^{-7}} \\approx 1.0001292407$$\n\n**$C_{0,0}^{(\\text{Neumann})}$ 的计算：**\n分子：$N_N = D(4C_{0,1} - C_{0,2}) + 2\\Delta x q_b$\n$N_N = (1.6 \\times 10^{-9})(4(0.990) - 0.970) + 2(0.100)(8.31027264 \\times 10^{-11})$\n$N_N = (1.6 \\times 10^{-9})(2.990) + 1.662054528 \\times 10^{-11}$\n$N_N = 4.784 \\times 10^{-9} + 0.01662054528 \\times 10^{-9} = 4.80062054528 \\times 10^{-9}$\n分母：$D_N = 3D$\n$D_N = 3(1.6 \\times 10^{-9}) = 4.8 \\times 10^{-9}$\n$$C_{0,0}^{(\\text{Neumann})} = \\frac{N_N}{D_N} = \\frac{4.80062054528 \\times 10^{-9}}{4.8 \\times 10^{-9}} \\approx 1.0001292803$$\n\n**一致性检查与最终值：**\n得到的两个值 $C_{0,0}^{(\\text{Robin})} \\approx 1.00012924$ 和 $C_{0,0}^{(\\text{Neumann})} \\approx 1.00012928$ 非常接近。它们的差值约为 $4 \\times 10^{-8}$。这证实了两个边界条件在离散化并使用所提供的数据进行评估时是一致的。微小的差异可归因于输入节点值的有限精度和数值方法的固有截断误差。\n\n问题要求将 $C_{0,0}$ 的单个值四舍五入到六位有效数字。\n对 $C_{0,0}^{(\\text{Robin})}$ 四舍五入：$1.0001292407 \\rightarrow 1.00013$\n对 $C_{0,0}^{(\\text{Neumann})}$ 四舍五入：$1.0001292803 \\rightarrow 1.00013$\n两个表达式在四舍五入到所需精度后得出相同的值。我们将此值作为最终答案报告。\n\n角点处的最终计算浓度：\n$$C_{0,0} = 1.00013 \\, \\text{mol m}^{-3}$$",
            "answer": "$$\n\\boxed{1.00013}\n$$"
        },
        {
            "introduction": "从计算的角度看，保证物理守恒定律是构建可靠输运模型的基石，尤其是在处理非均质介质时。本练习将指导你为一个包含两种不同材料的扩散问题编写一个有限差分程序。核心任务是设计一个能够确保在材料界面处通量连续的离散格式，这直接反映了没有内部源或汇时质量守恒的物理现实。",
            "id": "4079161",
            "problem": "考虑在一维情况下，两种材料在内部界面连接的稳态菲克扩散。设空间坐标为 $x \\in [0,L]$，总长度 $L$ 以米为单位。浓度场 $c(x)$ 以 $\\mathrm{mol}/\\mathrm{m}^3$ 为单位，扩散系数 $D(x)$ 以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位。无源项的控制守恒定律是源于菲克第一定律的稳态扩散方程。菲克第一定律指出，扩散通量 $J(x)$ 为 $J(x) = -D(x)\\,\\dfrac{dc}{dx}$，而稳态守恒要求 $\\dfrac{dJ}{dx} = 0$。综合起来，可得到微分方程 $\\dfrac{d}{dx}\\!\\left(D(x)\\,\\dfrac{dc}{dx}\\right) = 0$，其服从狄利克雷边界条件 $c(0)=c_L$ 和 $c(L)=c_R$，其中 $c_L$ 和 $c_R$ 是指定的浓度。材料属性 $D(x)$ 是分段常数，在域内位于 $x=x_I$ 的内部界面处有一个跳跃。\n\n您必须为此方程实现一个均匀网格、节点中心、二阶有限差分格式的离散化方法，该方法需遵循计算地球化学中基于通量的输运的基本守恒原理。该离散化必须直接根据上述核心定律设计：由菲克第一定律定义的通量和每个控制体积内的质量守恒，从而得到空间导数的一致性近似，保证每个内部面上的离散通量平衡。该方法必须确保离散通量在内部界面上是连续的，这反映了一个物理事实：在没有内部源项的情况下，稳态输运过程中，进入和离开任何内部点的通量是相同的。\n\n在所有测试中，内部界面都精确地放置在一个网格节点上。均匀网格使用 $N+1$ 个节点，索引为 $i=0,1,\\dots,N$，网格间距为 $\\Delta x = L/N$，节点位置为 $x_i = i\\,\\Delta x$。界面节点的索引是 $i=i_I$，其中 $1 \\le i_I \\le N-1$。分段常数扩散系数为：当 $x \\le x_I$ 时，$D(x)=D_\\text{left}$；当 $x \\ge x_I$ 时，$D(x)=D_\\text{right}$。离散系统必须将 $x=0$ 和 $x=L$ 处的狄利克雷边界条件作为 $c_0$ 和 $c_N$ 的规定值纳入。\n\n在求解线性系统得到离散浓度 $\\{c_i\\}_{i=0}^N$ 后，计算与界面节点相邻的左侧面和右侧面上的离散扩散通量。使用物理上一致的扩散系数面表示（从面上的守恒导出）以及每个面上相邻节点值之间的离散梯度。通过在界面节点 $i=i_I$ 处比较左侧面通量 $J_\\text{left}$ 和右侧面通量 $J_\\text{right}$ 来验证通量的连续性。报告一个布尔值结果，指示 $|J_\\text{left} - J_\\text{right}|$ 是否在指定的容差范围内。\n\n物理单位必须按如下方式一致处理：$L$ 的单位是 $\\mathrm{m}$，$D_\\text{left}$ 和 $D_\\text{right}$ 的单位是 $\\mathrm{m}^2/\\mathrm{s}$，$c_L$、$c_R$ 的单位是 $\\mathrm{mol}/\\mathrm{m}^3$。最终输出是布尔值，因此不需要单位注释。\n\n您的程序必须实现以上要求，并能在以下测试套件上运行。每个测试用例提供 $(L,N,i_I,D_\\text{left},D_\\text{right},c_L,c_R,\\varepsilon)$，其中 $\\varepsilon$ 是通量连续性的容差。对于每个用例，求解离散浓度，然后使用指定的 $\\varepsilon$ 检查界面节点处的通量连续性。程序必须生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$[result_1,result_2,\\dots]$）。\n\n使用以下测试套件：\n- 用例 $1$：$(L,N,i_I,D_\\text{left},D_\\text{right},c_L,c_R,\\varepsilon) = (1.0,100,45,1.0\\times 10^{-9},4.0\\times 10^{-9},1.2,0.2,1.0\\times 10^{-10})$。\n- 用例 $2$：$(2.0,200,100,2.0\\times 10^{-10},2.0\\times 10^{-10},0.0,1.0,1.0\\times 10^{-12})$。\n- 用例 $3$：$(1.0,20,1,1.0\\times 10^{-12},1.0\\times 10^{-9},0.5,0.0,1.0\\times 10^{-10})$。\n- 用例 $4$：$(1.0,200,150,1.0\\times 10^{-8},1.0\\times 10^{-12},1.0,0.0,1.0\\times 10^{-10})$。\n\n您的程序应生成单行输出，其中包含与测试套件顺序相同的、用方括号括起来的逗号分隔列表（例如，$[b_1,b_2,b_3,b_4]$），其中每个 $b_k$ 是一个布尔值，表示用例 $k$ 在界面节点处的通量连续性是否在容差范围内得到满足。",
            "solution": "该问题要求为具有分段常数扩散系数的一维稳态扩散方程实现一个二阶精度的有限差分方法。离散化必须从基本守恒原理推导得出，以确保跨材料界面的通量连续性。\n\n稳态扩散的控制方程源于菲克第一定律和质量守恒。菲克第一定律将扩散通量 $J(x)$ 定义为：\n$$ J(x) = -D(x)\\,\\dfrac{dc}{dx} $$\n其中 $c(x)$ 是浓度，$D(x)$ 是扩散系数。对于没有源或汇的稳态，通量必须是无散度的，在一维情况下即：\n$$ \\dfrac{dJ}{dx} = 0 $$\n结合这些，得到二阶常微分方程：\n$$ \\dfrac{d}{dx}\\!\\left(D(x)\\,\\dfrac{dc}{dx}\\right) = 0 $$\n域为 $x \\in [0,L]$，具有狄利克雷边界条件 $c(0)=c_L$ 和 $c(L)=c_R$。扩散系数 $D(x)$ 是分段常数：\n$$ D(x) = \\begin{cases} D_\\text{left}  \\text{for } x \\le x_I \\\\ D_\\text{right}  \\text{for } x \\ge x_I \\end{cases} $$\n其中 $x_I$ 是内部界面的位置。\n\n我们将使用一个以节点为中心的有限差分/体积方法。域 $[0,L]$ 被离散化为 $N$ 个长度为 $\\Delta x = L/N$ 的均匀区间，有 $N+1$ 个节点位于 $x_i = i\\,\\Delta x$ 处，其中 $i=0, 1, \\dots, N$。每个内部节点 $i$ 都与一个控制体积（CV）相关联，该控制体积从其相邻节点的中心点延伸，即 $\\text{CV}_i = [x_i - \\Delta x/2, x_i + \\Delta x/2] = [x_{i-1/2}, x_{i+1/2}]$。\n\n核心原理是每个控制体积上的质量守恒。将控制方程 $\\dfrac{dJ}{dx} = 0$ 在 $\\text{CV}_i$ 上积分：\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\dfrac{dJ}{dx} \\, dx = 0 $$\n应用微积分基本定理，我们得到一个通量平衡方程：\n$$ J(x_{i+1/2}) - J(x_{i-1/2}) = 0 $$\n这表明进入控制体积的通量必须等于流出它的通量。我们将面上的通量表示为 $J_{i+1/2}$ 和 $J_{i-1/2}$。\n\n我们使用中心差分来近似每个面上的梯度，从而得到通量。在节点 $i$ 和 $i+1$ 之间的面 $x_{i+1/2}$ 处的通量为：\n$$ J_{i+1/2} \\approx -D_{i+1/2} \\dfrac{c_{i+1} - c_i}{\\Delta x} $$\n其中 $D_{i+1/2}$ 是面上的有效扩散系数。问题指定界面精确位于一个节点 $x_{i_I}$ 上。这简化了面扩散系数的确定。\n\n对于任何不在界面上的面 $x_{i-1/2}$（即 $i \\ne i_I$ 且 $i-1 \\ne i_I$），在该面附近的扩散系数是恒定的。\n如果 $i \\le i_I$，面 $x_{i-1/2}$ 位于“左侧”材料中，因此 $D_{i-1/2} = D_\\text{left}$。\n如果 $i > i_I+1$，面 $x_{i-1/2}$ 位于“右侧”材料中，因此 $D_{i-1/2} = D_\\text{right}$。\n\n界面节点是 $i_I$。其控制体积为 $[x_{i_I-1/2}, x_{i_I+1/2}]$。\n左侧面 $x_{i_I-1/2}$ 完全在“左侧”材料区域内，因此 $D_{i_I-1/2} = D_\\text{left}$。\n右侧面 $x_{i_I+1/2}$ 完全在“右侧”材料区域内，因此 $D_{i_I+1/2} = D_\\text{right}$。\n\n基于此，我们可以为每个内部节点 $i=1, \\dots, N-1$ 建立离散方程。\n\n情况 1：节点 $i$ 在“左侧”材料中（$1 \\le i  i_I$）。\n控制体积的两个面都在“左侧”材料中，因此 $D_{i-1/2} = D_{i+1/2} = D_\\text{left}$。通量平衡为：\n$$ -D_\\text{left} \\dfrac{c_{i+1} - c_i}{\\Delta x} - \\left(-D_\\text{left} \\dfrac{c_i - c_{i-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -c_{i+1} + 2c_i - c_{i-1} = 0 $$\n\n情况 2：节点 $i$ 在界面上（$i = i_I$）。\n左侧面的扩散系数为 $D_{i_I-1/2} = D_\\text{left}$，右侧面的扩散系数为 $D_{i_I+1/2} = D_\\text{right}$。通量平衡为：\n$$ -D_\\text{right} \\dfrac{c_{i_I+1} - c_{i_I}}{\\Delta x} - \\left(-D_\\text{left} \\dfrac{c_{i_I} - c_{i_I-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -D_\\text{right} c_{i_I+1} + (D_\\text{left} + D_\\text{right}) c_{i_I} - D_\\text{left} c_{i_I-1} = 0 $$\n该方程明确地强制了界面节点处的通量连续性。\n\n情况 3：节点 $i$ 在“右侧”材料中（$i_I  i  N$）。\n两个面都在“右侧”材料中，因此 $D_{i-1/2} = D_{i+1/2} = D_\\text{right}$。平衡为：\n$$ -D_\\text{right} \\dfrac{c_{i+1} - c_i}{\\Delta x} - \\left(-D_\\text{right} \\dfrac{c_i - c_{i-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -c_{i+1} + 2c_i - c_{i-1} = 0 $$\n\n这 $N-1$ 个关于未知浓度 $c_1, \\dots, c_{N-1}$ 的线性方程组构成了一个三对角系统 $A\\mathbf{c}_{int} = \\mathbf{b}$。边界条件 $c_0 = c_L$ 和 $c_N = c_R$ 被并入右侧向量 $\\mathbf{b}$ 中。对于第一个方程（$i=1$），涉及 $c_0$ 的项被移到右侧；对于最后一个方程（$i=N-1$），涉及 $c_N$ 的项被移到右侧。\n求解得到的系统，可得内部浓度向量 $\\mathbf{c}_{int} = [c_1, \\dots, c_{N-1}]^T$。\n\n求解出浓度后，我们在界面节点 $i_I$ 处验证通量连续性。其控制体积左侧面上的通量为：\n$$ J_\\text{left} = J_{i_I-1/2} = -D_\\text{left} \\dfrac{c_{i_I} - c_{i_I-1}}{\\Delta x} $$\n其控制体积右侧面上的通量为：\n$$ J_\\text{right} = J_{i_I+1/2} = -D_\\text{right} \\dfrac{c_{i_I+1} - c_{i_I}}{\\Delta x} $$\n节点 $i_I$ 的离散化正是根据条件 $J_\\text{right} - J_\\text{left} = 0$ 构建的。因此，在求解系统后，计算出的 $c_{i_I-1}$、$c_{i_I}$ 和 $c_{i_I+1}$ 的值必须满足这个条件，其精度取决于线性代数求解器的数值精度。我们通过检查 $|J_\\text{left} - J_\\text{right}| \\le \\varepsilon$ 是否在给定的容差 $\\varepsilon$ 内来验证这一点。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state diffusion problem with a piecewise constant\n    diffusivity for a suite of test cases.\n    \"\"\"\n    # Test cases from the problem statement:\n    # Each tuple is (L, N, i_I, D_left, D_right, c_L, c_R, epsilon)\n    test_cases = [\n        (1.0, 100, 45, 1.0e-9, 4.0e-9, 1.2, 0.2, 1.0e-10),\n        (2.0, 200, 100, 2.0e-10, 2.0e-10, 0.0, 1.0, 1.0e-12),\n        (1.0, 20, 1, 1.0e-12, 1.0e-9, 0.5, 0.0, 1.0e-10),\n        (1.0, 200, 150, 1.0e-8, 1.0e-12, 1.0, 0.0, 1.0e-10)\n    ]\n\n    results = []\n    for case in test_cases:\n        L, N, i_I, D_left, D_right, c_L, c_R, epsilon = case\n\n        # Number of internal nodes\n        M = N - 1\n\n        # Check for trivial case of M=0\n        if M == 0:\n            if N == 1: # Only two nodes, 0 and 1\n                # The problem statement asserts 1 = i_I = N-1, so this path is not taken for valid inputs.\n                results.append(False)\n            else: # N=0, ill-defined grid.\n                results.append(False)\n            continue\n\n        # Set up the tridiagonal matrix A and RHS vector b for the system A*c_int = b\n        # where c_int = [c_1, c_2, ..., c_{N-1}]\n        \n        A = np.zeros((M, M))\n        b = np.zeros(M)\n        \n        # Build the matrix and RHS vector row by row\n        for i_row in range(M):\n            i_node = i_row + 1 # node index c_1, c_2, ...\n            \n            if i_node  i_I: # Left material\n                A[i_row, i_row] = 2.0\n                if i_node > 1:\n                    A[i_row, i_row - 1] = -1.0\n                if i_node  N - 1:\n                    A[i_row, i_row + 1] = -1.0\n            elif i_node == i_I: # Interface node\n                A[i_row, i_row] = D_left + D_right\n                if i_node > 1:\n                    A[i_row, i_row - 1] = -D_left\n                if i_node  N - 1:\n                    A[i_row, i_row + 1] = -D_right\n            else: # i_node > i_I, Right material\n                A[i_row, i_row] = 2.0\n                if i_node > 1:\n                    A[i_row, i_row - 1] = -1.0\n                if i_node  N - 1:\n                    A[i_row, i_row + 1] = -1.0\n\n        # Incorporate boundary conditions into RHS vector b\n        # For first row (i_node = 1)\n        if 1  i_I:\n            b[0] = c_L\n        elif 1 == i_I:\n            b[0] = D_left * c_L\n        \n        # For last row (i_node = N-1)\n        if M > 1: # check if there is a last row separate from the first\n            if N - 1 > i_I:\n                b[M-1] = c_R\n            elif N - 1 == i_I:\n                b[M-1] = D_right * c_R\n        \n        # Solve the linear system for internal concentrations\n        c_internal = np.linalg.solve(A, b)\n\n        # Reconstruct the full concentration vector including boundaries\n        c = np.concatenate(([c_L], c_internal, [c_R]))\n\n        # Calculate fluxes at the interface node's control volume faces\n        delta_x = L / N\n        \n        # Flux on the left face of CV_iI (between nodes i_I-1 and i_I)\n        c_iI_minus_1 = c[i_I - 1]\n        c_iI = c[i_I]\n        J_left = -D_left * (c_iI - c_iI_minus_1) / delta_x\n        \n        # Flux on the right face of CV_iI (between nodes i_I and i_I+1)\n        c_iI_plus_1 = c[i_I + 1]\n        J_right = -D_right * (c_iI_plus_1 - c_iI) / delta_x\n\n        # Check for flux continuity within the given tolerance\n        is_continuous = np.abs(J_left - J_right) = epsilon\n        results.append(is_continuous)\n\n    # Format and print the final output\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}