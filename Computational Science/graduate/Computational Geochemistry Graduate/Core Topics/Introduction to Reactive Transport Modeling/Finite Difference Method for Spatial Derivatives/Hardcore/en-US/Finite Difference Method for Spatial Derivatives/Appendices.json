{
    "hands_on_practices": [
        {
            "introduction": "Real-world geochemical simulations often employ nonuniform grids to efficiently resolve sharp concentration gradients or complex geometries. This exercise provides foundational practice in deriving a second-order accurate stencil for the first derivative on such a grid using Taylor series expansions . By applying the derived formula to a known function and comparing it to the exact result, you will gain a tangible understanding of truncation error and the accuracy of the finite difference method.",
            "id": "4079148",
            "problem": "A one-dimensional reactive-transport calculation in computational geochemistry requires evaluating a spatial gradient to compute the diffusive flux according to Fick’s first law, where the flux is proportional to the gradient of a species concentration field. Consider a dimensionless concentration field given by $u(x) = \\exp(x)$ on a nonuniform grid with three consecutive nodes $x_{i-1}$, $x_{i}$, and $x_{i+1}$ such that $h_{i-1} = x_{i} - x_{i-1}$ and $h_{i} = x_{i+1} - x_{i}$. You are tasked with deriving a second-order accurate discrete gradient approximation for $u^{\\prime}(x_{i})$ using the Finite Difference Method (FDM) on this nonuniform grid, starting from Taylor series expansions about $x_{i}$ and imposing the conditions necessary to reproduce $u^{\\prime}(x_{i})$ while canceling lower-order truncation terms.\n\nLet the grid spacings and evaluation point be $h_{i-1} = 0.08$, $h_{i} = 0.12$, and $x_{i} = 0.30$. Using your derived second-order accurate nonuniform central difference formula, compute the discrete gradient approximation to $u^{\\prime}(x_{i})$ by substituting the exact nodal values $u_{i-1} = u(x_{i-1})$, $u_{i} = u(x_{i})$, and $u_{i+1} = u(x_{i+1})$. Then compute the exact derivative $u^{\\prime}(x_{i})$ and the absolute error magnitude between the discrete approximation and the exact derivative.\n\nRound your final absolute error to four significant figures. Express the final answer as a pure number with no units.",
            "solution": "The user wants to find the absolute error between a second-order finite difference approximation of a derivative on a nonuniform grid and the exact derivative.\n\n### Part 1: Derivation of the Second-Order Nonuniform Difference Formula\n\nThe objective is to find a discrete approximation for the first derivative $u^{\\prime}(x_i)$ of the form:\n$$\nu^{\\prime}(x_i) \\approx c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1}\n$$\nwhere $u_j = u(x_j)$. The coefficients $c_{-1}$, $c_0$, and $c_1$ are determined by enforcing second-order accuracy. This is achieved by using Taylor series expansions for $u(x_{i-1})$ and $u(x_{i+1})$ around the point $x_i$. The grid spacings are $h_{i-1} = x_i - x_{i-1}$ and $h_i = x_{i+1} - x_i$.\n\nThe Taylor series expansions are:\n$$\nu_{i-1} = u(x_i - h_{i-1}) = u_i - h_{i-1} u_i^{\\prime} + \\frac{h_{i-1}^2}{2} u_i^{\\prime\\prime} - \\frac{h_{i-1}^3}{6} u_i^{\\prime\\prime\\prime} + \\mathcal{O}(h_{i-1}^4)\n$$\n$$\nu_{i+1} = u(x_i + h_i) = u_i + h_i u_i^{\\prime} + \\frac{h_i^2}{2} u_i^{\\prime\\prime} + \\frac{h_i^3}{6} u_i^{\\prime\\prime\\prime} + \\mathcal{O}(h_i^4)\n$$\nSubstituting these expansions into the approximation formula:\n$$\nc_{-1} \\left( u_i - h_{i-1} u_i^{\\prime} + \\frac{h_{i-1}^2}{2} u_i^{\\prime\\prime} + \\dots \\right) + c_0 u_i + c_1 \\left( u_i + h_i u_i^{\\prime} + \\frac{h_i^2}{2} u_i^{\\prime\\prime} + \\dots \\right)\n$$\nGrouping terms by the derivatives of $u$ at $x_i$:\n$$\n(c_{-1} + c_0 + c_1) u_i + (-c_{-1} h_{i-1} + c_1 h_i) u_i^{\\prime} + \\left(c_{-1} \\frac{h_{i-1}^2}{2} + c_1 \\frac{h_i^2}{2}\\right) u_i^{\\prime\\prime} + \\mathcal{O}(h^3)\n$$\nFor this expression to approximate $u_i^{\\prime}$, we enforce the following conditions:\n1.  The coefficient of $u_i$ must be $0$: $c_{-1} + c_0 + c_1 = 0$.\n2.  The coefficient of $u_i^{\\prime}$ must be $1$: $-c_{-1} h_{i-1} + c_1 h_i = 1$.\n3.  For second-order accuracy, the coefficient of $u_i^{\\prime\\prime}$ must be $0$: $c_{-1} h_{i-1}^2 + c_1 h_i^2 = 0$.\n\nFrom condition 3:\n$c_{-1} = -c_1 \\frac{h_i^2}{h_{i-1}^2}$.\n\nSubstitute this into condition 2:\n$- \\left(-c_1 \\frac{h_i^2}{h_{i-1}^2}\\right) h_{i-1} + c_1 h_i = 1 \\implies c_1 \\frac{h_i^2}{h_{i-1}} + c_1 h_i = 1$\n$c_1 \\left( \\frac{h_i^2 + h_i h_{i-1}}{h_{i-1}} \\right) = 1 \\implies c_1 \\frac{h_i(h_i + h_{i-1})}{h_{i-1}} = 1$\n$$\nc_1 = \\frac{h_{i-1}}{h_i(h_i + h_{i-1})}\n$$\nNow, we find $c_{-1}$:\n$$\nc_{-1} = - \\left( \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} \\right) \\frac{h_i^2}{h_{i-1}^2} = -\\frac{h_i}{h_{i-1}(h_i + h_{i-1})}\n$$\nFinally, from condition 1, we find $c_0$:\n$c_0 = -c_{-1} - c_1 = \\frac{h_i}{h_{i-1}(h_i + h_{i-1})} - \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} = \\frac{h_i^2 - h_{i-1}^2}{h_i h_{i-1}(h_i + h_{i-1})}$\n$c_0 = \\frac{(h_i - h_{i-1})(h_i + h_{i-1})}{h_i h_{i-1}(h_i + h_{i-1})} = \\frac{h_i - h_{i-1}}{h_i h_{i-1}}$\n$$\nc_0 = \\frac{h_i - h_{i-1}}{h_i h_{i-1}}\n$$\nThus, the second-order accurate finite difference approximation for $u^{\\prime}(x_i)$ on a nonuniform grid is:\n$$\nu^{\\prime}(x_i) \\approx \\left( -\\frac{h_i}{h_{i-1}(h_i + h_{i-1})} \\right) u_{i-1} + \\left( \\frac{h_i - h_{i-1}}{h_i h_{i-1}} \\right) u_i + \\left( \\frac{h_{i-1}}{h_i(h_i + h_{i-1})} \\right) u_{i+1}\n$$\n\n### Part 2: Numerical Calculation\n\nThe problem provides the following values:\n$h_{i-1} = 0.08$\n$h_i = 0.12$\n$x_i = 0.30$\nThe concentration field is $u(x) = \\exp(x)$.\n\nFirst, we calculate the numerical values of the coefficients:\n$h_i + h_{i-1} = 0.12 + 0.08 = 0.20$\n$h_i h_{i-1} = 0.12 \\times 0.08 = 0.0096$\n$c_{-1} = -\\frac{0.12}{0.08(0.20)} = -\\frac{0.12}{0.016} = -7.5$\n$c_0 = \\frac{0.12 - 0.08}{0.0096} = \\frac{0.04}{0.0096} = \\frac{400}{96} = \\frac{25}{6}$\n$c_1 = \\frac{0.08}{0.12(0.20)} = \\frac{0.08}{0.024} = \\frac{80}{24} = \\frac{10}{3}$\n\nNext, we identify the grid points:\n$x_i = 0.30$\n$x_{i-1} = x_i - h_{i-1} = 0.30 - 0.08 = 0.22$\n$x_{i+1} = x_i + h_i = 0.30 + 0.12 = 0.42$\n\nWe evaluate the function $u(x)$ at these points:\n$u_{i-1} = u(0.22) = \\exp(0.22)$\n$u_i = u(0.30) = \\exp(0.30)$\n$u_{i+1} = u(0.42) = \\exp(0.42)$\n\nNow, we compute the discrete gradient approximation, which we denote as $u'_{approx}$:\n$$\nu'_{approx} = c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1} = -7.5 \\exp(0.22) + \\frac{25}{6} \\exp(0.30) + \\frac{10}{3} \\exp(0.42)\n$$\nUsing high-precision values:\n$\\exp(0.22) \\approx 1.246076731$\n$\\exp(0.30) \\approx 1.349858808$\n$\\exp(0.42) \\approx 1.521961556$\n$u'_{approx} \\approx -7.5(1.246076731) + \\frac{25}{6}(1.349858808) + \\frac{10}{3}(1.521961556)$\n$u'_{approx} \\approx -9.345575483 + 5.624411700 + 5.073205187$\n$u'_{approx} \\approx 1.352041404$\n\n### Part 3: Exact Derivative and Absolute Error\n\nThe exact derivative of $u(x) = \\exp(x)$ is $u'(x) = \\exp(x)$.\nAt $x_i = 0.30$, the exact derivative is:\n$$\nu'_{exact} = u'(0.30) = \\exp(0.30) \\approx 1.349858808\n$$\nThe absolute error $E$ is the magnitude of the difference between the approximation and the exact value:\n$$\nE = |u'_{approx} - u'_{exact}|\n$$\n$$\nE = |1.352041404 - 1.349858808| = 0.002182596\n$$\nThe problem requires rounding the final absolute error to four significant figures.\nThe first four significant figures of $0.002182596$ are $2$, $1$, $8$, $2$. The fifth significant figure is $5$, so we round up the fourth digit.\n$$\nE \\approx 0.002183\n$$",
            "answer": "$$\\boxed{0.002183}$$"
        },
        {
            "introduction": "Building upon the skill of stencil derivation, this practice addresses a more complex and realistic challenge: discretizing mixed boundary conditions at a domain corner. This scenario , common when modeling systems like aquifers exchanging material with their surroundings, requires the careful construction and application of one-sided stencils. By ensuring the numerical scheme is consistent with two different physical laws (a Robin and a Neumann condition) at a single point, you will develop crucial skills for accurately representing domain boundaries in simulations.",
            "id": "4079159",
            "problem": "Consider a two-dimensional rectangular aquifer patch in steady state for a dissolved species with concentration field $C(x,y)$ governed by Fickian diffusion. The left boundary at $x=0$ exchanges solute with an external reservoir via a convective mass-transfer law (Robin condition), and the bottom boundary at $y=0$ carries a prescribed upward diffusive flux (Neumann condition). Let the diffusive flux vector be given by Fick’s First Law, $\\mathbf{J}=-D \\nabla C$, where $D$ is the molecular diffusion coefficient, and let the boundary laws be specified as\n$$-D\\,\\partial_{x}C(0,y)=h\\big(C(0,y)-C_{L}\\big),\\qquad -D\\,\\partial_{y}C(x,0)=q_{b},$$\nwith $D>0$, $h>0$, $C_{L}$ the reservoir concentration, and $q_{b}$ the basal flux. Discretize the domain on a uniform Cartesian grid with spacings $\\Delta x=\\Delta y$, and denote nodal values by $C_{i,j}=C(i\\,\\Delta x,\\,j\\,\\Delta y)$. At the corner node $(i,j)=(0,0)$, you must construct a second-order accurate one-sided finite difference stencil that enforces both boundary conditions simultaneously without introducing ghost unknowns, by expressing $\\partial_{x}C(0,0)$ using $\\{C_{0,0},C_{1,0},C_{2,0}\\}$ and $\\partial_{y}C(0,0)$ using $\\{C_{0,0},C_{0,1},C_{0,2}\\}$.\n\nWork from first principles: start with Fick’s First Law and Taylor series expansions about the corner to justify the second-order one-sided formulas you use. Then derive two linear expressions for $C_{0,0}$ implied by the Robin and Neumann boundary laws, and verify that, for the data given below, they are consistent (i.e., yield the same numerical value for $C_{0,0}$ within truncation error). Finally, compute $C_{0,0}$.\n\nUse the following physically plausible parameters and neighboring nodal values:\n- $D=1.6\\times 10^{-9}$ m$^{2}$ s$^{-1}$, $h=2.5\\times 10^{-6}$ m s$^{-1}$, $C_{L}=1.000$ mol m$^{-3}$,\n- $\\Delta x=\\Delta y=0.100$ m,\n- $q_{b}=8.31027264\\times 10^{-11}$ mol m$^{-2}$ s$^{-1}$,\n- $C_{1,0}=0.980$ mol m$^{-3}$, $C_{2,0}=0.960$ mol m$^{-3}$, $C_{0,1}=0.990$ mol m$^{-3}$, $C_{0,2}=0.970$ mol m$^{-3}$.\n\nYour tasks are:\n1. Derive the second-order one-sided formulas for $\\partial_{x}C(0,0)$ and $\\partial_{y}C(0,0)$ from Taylor expansions.\n2. Use these formulas in the boundary laws to obtain two algebraic expressions for $C_{0,0}$ in terms of the given parameters and neighboring nodal values.\n3. Evaluate both expressions numerically to verify they are consistent, and report the corner concentration.\n\nExpress the final concentration in mol m$^{-3}$ and round your answer to six significant figures.",
            "solution": "The user has provided a computational geochemistry problem that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Law**: Fickian diffusion for a species with concentration field $C(x,y)$.\n- **Flux Definition**: Diffusive flux vector $\\mathbf{J}=-D \\nabla C$, where $D$ is the molecular diffusion coefficient.\n- **Domain**: A two-dimensional rectangular aquifer patch.\n- **Grid**: Uniform Cartesian grid with spacings $\\Delta x = \\Delta y$. Nodal values are $C_{i,j}=C(i\\,\\Delta x,\\,j\\,\\Delta y)$.\n- **Boundary Conditions**:\n    1.  **Robin Condition at $x=0$**: $-D\\,\\partial_{x}C(0,y)=h\\big(C(0,y)-C_{L}\\big)$\n    2.  **Neumann Condition at $y=0$**: $-D\\,\\partial_{y}C(x,0)=q_{b}$\n- **Constants and Parameters**:\n    - $D = 1.6\\times 10^{-9}$ m$^{2}$ s$^{-1}$\n    - $h = 2.5\\times 10^{-6}$ m s$^{-1}$\n    - $C_{L} = 1.000$ mol m$^{-3}$\n    - $q_{b} = 8.31027264\\times 10^{-11}$ mol m$^{-2}$ s$^{-1}$\n    - $\\Delta x = \\Delta y = 0.100$ m\n- **Neighboring Nodal Values**:\n    - $C_{1,0} = 0.980$ mol m$^{-3}$\n    - $C_{2,0} = 0.960$ mol m$^{-3}$\n    - $C_{0,1} = 0.990$ mol m$^{-3}$\n    - $C_{0,2} = 0.970$ mol m$^{-3}$\n- **Task Requirements**:\n    1.  Derive second-order one-sided finite difference formulas for $\\partial_{x}C(0,0)$ and $\\partial_{y}C(0,0)$ using Taylor expansions and the nodes $\\{C_{0,0}, C_{1,0}, C_{2,0}\\}$ and $\\{C_{0,0}, C_{0,1}, C_{0,2}\\}$ respectively.\n    2.  Obtain two algebraic expressions for $C_{0,0}$ from the boundary conditions.\n    3.  Verify the consistency of the two expressions by numerical evaluation and compute the final value of $C_{0,0}$, rounded to six significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the specified criteria.\n- **Scientifically Grounded**: The problem is based on Fick's First Law of diffusion, a cornerstone of transport phenomena. The boundary conditions (Robin and Neumann) are standard in heat and mass transfer problems. The provided parameters are physically plausible for solute transport in an aqueous medium. The problem is free of pseudoscience.\n- **Well-Posed**: The problem is well-defined. It asks for the derivation and application of a standard numerical method (finite differences) to a physically meaningful boundary value problem. The task is to determine the concentration at a corner node where two boundary conditions intersect, which is a common challenge in numerical modeling. The problem provides sufficient data to arrive at a unique solution for $C_{0,0}$ under the specified discrete approximations.\n- **Objective**: The problem is stated in precise, objective language. The required tasks are clear and unambiguous.\n- **Completeness and Consistency**: The problem is self-contained. All necessary constants, nodal values, and boundary condition definitions are provided. There are no apparent contradictions in the problem statement. The high precision of $q_b$ suggests the problem is carefully constructed to ensure consistency between the two boundary conditions at the corner.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is scientifically sound, well-posed, objective, and self-contained. I will now proceed with the solution.\n\n### Solution\nThe problem requires the derivation of a numerical scheme for a corner node subject to two different boundary conditions, and the subsequent calculation of the concentration at that node, $C_{0,0}$.\n\n**1. Derivation of the Second-Order One-Sided Finite Difference Formula**\n\nWe seek a second-order accurate approximation for the first derivative $\\partial_x C$ at a point $x_0$, using values at $x_0$, $x_1 = x_0+\\Delta x$, and $x_2 = x_0+2\\Delta x$. We start with the Taylor series expansions of $C(x_1)$ and $C(x_2)$ around $x_0$:\n$$C(x_1) = C(x_0) + \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{x_0} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{x_0} + O((\\Delta x)^3)$$\n$$C(x_2) = C(x_0) + (2\\Delta x) \\frac{\\partial C}{\\partial x}\\bigg|_{x_0} + \\frac{(2\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{x_0} + O((\\Delta x)^3)$$\nIn discrete notation, with $C_i = C(x_0 + i\\Delta x)$:\n$$C_1 = C_0 + \\Delta x \\, C'_0 + \\frac{(\\Delta x)^2}{2} C''_0 + O((\\Delta x)^3)$$\n$$C_2 = C_0 + 2\\Delta x \\, C'_0 + 2(\\Delta x)^2 C''_0 + O((\\Delta x)^3)$$\nTo obtain a second-order accurate formula for $C'_0$, we must eliminate the $C''_0$ term. We multiply the first equation by $4$ and subtract the second equation:\n$$4C_1 - C_2 = (4C_0 - C_0) + (4\\Delta x - 2\\Delta x)C'_0 + (2(\\Delta x)^2 - 2(\\Delta x)^2)C''_0 + O((\\Delta x)^3)$$\n$$4C_1 - C_2 = 3C_0 + 2\\Delta x \\, C'_0 + O((\\Delta x)^3)$$\nSolving for $C'_0$:\n$$2\\Delta x \\, C'_0 = -3C_0 + 4C_1 - C_2 + O((\\Delta x)^3)$$\n$$C'_0 = \\frac{-3C_0 + 4C_1 - C_2}{2\\Delta x} + O((\\Delta x)^2)$$\nThe truncation error is of order $(\\Delta x)^2$, so this formula is second-order accurate. Applying this to the partial derivatives at the corner node $(0,0)$:\n$$\\partial_{x}C(0,0) \\approx \\frac{-3C_{0,0} + 4C_{1,0} - C_{2,0}}{2\\Delta x}$$\nBy analogy for the $y$-direction, since $\\Delta y = \\Delta x$:\n$$\\partial_{y}C(0,0) \\approx \\frac{-3C_{0,0} + 4C_{0,1} - C_{0,2}}{2\\Delta y}$$\n\n**2. Algebraic Expressions for $C_{0,0}$**\n\nWe now substitute these finite difference approximations into the two boundary conditions.\n\n**From the Robin Condition at $x=0$:**\nThe condition is $-D\\,\\partial_{x}C(0,0)=h\\big(C(0,0)-C_{L}\\big)$. Substituting the formula for $\\partial_{x}C(0,0)$:\n$$-D \\left( \\frac{-3C_{0,0} + 4C_{1,0} - C_{2,0}}{2\\Delta x} \\right) = h(C_{0,0} - C_{L})$$\nWe solve for $C_{0,0}$. Let's call this expression $C_{0,0}^{(\\text{Robin})}$.\n$$D(3C_{0,0} - 4C_{1,0} + C_{2,0}) = 2\\Delta x h(C_{0,0} - C_{L})$$\n$$3DC_{0,0} - 4DC_{1,0} + DC_{2,0} = 2\\Delta x h C_{0,0} - 2\\Delta x h C_{L}$$\n$$C_{0,0}(3D - 2\\Delta x h) = 4DC_{1,0} - DC_{2,0} - 2\\Delta x h C_{L}$$\n$$C_{0,0}^{(\\text{Robin})} = \\frac{4DC_{1,0} - DC_{2,0} - 2\\Delta x h C_{L}}{3D - 2\\Delta x h}$$\n\n**From the Neumann Condition at $y=0$:**\nThe condition is $-D\\,\\partial_{y}C(x,0)=q_{b}$, which at the corner is $-D\\,\\partial_{y}C(0,0)=q_{b}$. Substituting the formula for $\\partial_{y}C(0,0)$:\n$$-D \\left( \\frac{-3C_{0,0} + 4C_{0,1} - C_{0,2}}{2\\Delta y} \\right) = q_b$$\nWe solve for $C_{0,0}$. Let's call this expression $C_{0,0}^{(\\text{Neumann})}$. Since $\\Delta y = \\Delta x$:\n$$D(3C_{0,0} - 4C_{0,1} + C_{0,2}) = 2\\Delta x q_b$$\n$$3DC_{0,0} = 4DC_{0,1} - DC_{0,2} + 2\\Delta x q_b$$\n$$C_{0,0}^{(\\text{Neumann})} = \\frac{4DC_{0,1} - DC_{0,2} + 2\\Delta x q_b}{3D}$$\n\n**3. Numerical Evaluation and Consistency Verification**\n\nWe now substitute the given numerical values into both expressions for $C_{0,0}$.\nThe parameters are:\n$D=1.6\\times 10^{-9}$, $h=2.5\\times 10^{-6}$, $C_{L}=1.000$, $\\Delta x=0.100$, $q_{b}=8.31027264\\times 10^{-11}$, $C_{1,0}=0.980$, $C_{2,0}=0.960$, $C_{0,1}=0.990$, $C_{0,2}=0.970$.\n\n**Evaluation of $C_{0,0}^{(\\text{Robin})}$:**\nNumerator: $N_R = D(4C_{1,0} - C_{2,0}) - 2\\Delta x h C_L$\n$N_R = (1.6 \\times 10^{-9})(4(0.980) - 0.960) - 2(0.100)(2.5 \\times 10^{-6})(1.000)$\n$N_R = (1.6 \\times 10^{-9})(2.960) - 5.0 \\times 10^{-7} = 4.736 \\times 10^{-9} - 5.0 \\times 10^{-7} = -4.95264 \\times 10^{-7}$\nDenominator: $D_R = 3D - 2\\Delta x h$\n$D_R = 3(1.6 \\times 10^{-9}) - 2(0.100)(2.5 \\times 10^{-6}) = 4.8 \\times 10^{-9} - 5.0 \\times 10^{-7} = -4.952 \\times 10^{-7}$\n$$C_{0,0}^{(\\text{Robin})} = \\frac{N_R}{D_R} = \\frac{-4.95264 \\times 10^{-7}}{-4.952 \\times 10^{-7}} \\approx 1.0001292407$$\n\n**Evaluation of $C_{0,0}^{(\\text{Neumann})}$:**\nNumerator: $N_N = D(4C_{0,1} - C_{0,2}) + 2\\Delta x q_b$\n$N_N = (1.6 \\times 10^{-9})(4(0.990) - 0.970) + 2(0.100)(8.31027264 \\times 10^{-11})$\n$N_N = (1.6 \\times 10^{-9})(2.990) + 1.662054528 \\times 10^{-11}$\n$N_N = 4.784 \\times 10^{-9} + 0.01662054528 \\times 10^{-9} = 4.80062054528 \\times 10^{-9}$\nDenominator: $D_N = 3D$\n$D_N = 3(1.6 \\times 10^{-9}) = 4.8 \\times 10^{-9}$\n$$C_{0,0}^{(\\text{Neumann})} = \\frac{N_N}{D_N} = \\frac{4.80062054528 \\times 10^{-9}}{4.8 \\times 10^{-9}} \\approx 1.0001292803$$\n\n**Consistency Check and Final Value:**\nThe two values obtained, $C_{0,0}^{(\\text{Robin})} \\approx 1.00012924$ and $C_{0,0}^{(\\text{Neumann})} \\approx 1.00012928$, are extremely close. Their difference is approximately $4 \\times 10^{-8}$. This confirms that the two boundary conditions, when discretized and evaluated with the provided data, are consistent. The minor discrepancy is attributable to the finite precision of the input nodal values and the inherent truncation error of the numerical method.\n\nThe problem asks for a single value for $C_{0,0}$ rounded to six significant figures.\nRounding $C_{0,0}^{(\\text{Robin})}$: $1.0001292407 \\rightarrow 1.00013$\nRounding $C_{0,0}^{(\\text{Neumann})}$: $1.0001292803 \\rightarrow 1.00013$\nBoth expressions yield the same value when rounded to the required precision. We report this value as the final answer.\n\nFinal calculated concentration at the corner node:\n$$C_{0,0} = 1.00013 \\, \\text{mol m}^{-3}$$",
            "answer": "$$\\boxed{1.00013}$$"
        },
        {
            "introduction": "Our final practice moves from approximating derivatives at a point to solving a complete boundary-value problem for a system with heterogeneous material properties . You will implement a finite difference scheme for steady-state diffusion across a material interface, using a formulation based on control volumes that explicitly enforces the physical principle of flux continuity. This exercise demonstrates how to build robust numerical models that respect fundamental conservation laws, a cornerstone of reliable simulation in computational geochemistry and physics.",
            "id": "4079161",
            "problem": "Consider steady-state Fickian diffusion in one dimension with two materials joined at an internal interface. Let the spatial coordinate be $x \\in [0,L]$ with total length $L$ expressed in meters. The concentration field $c(x)$ is expressed in $\\mathrm{mol}/\\mathrm{m}^3$, and the diffusivity $D(x)$ is expressed in $\\mathrm{m}^2/\\mathrm{s}$. The governing conservation law without sources is the steady-state diffusion equation derived from Fick's first law, which states that the diffusive flux $J(x)$ is $J(x) = -D(x)\\,\\dfrac{dc}{dx}$, and the steady-state conservation requires $\\dfrac{dJ}{dx} = 0$. Together, these imply the differential equation $\\dfrac{d}{dx}\\!\\left(D(x)\\,\\dfrac{dc}{dx}\\right) = 0$ subject to Dirichlet boundary conditions $c(0)=c_L$ and $c(L)=c_R$, where $c_L$ and $c_R$ are specified concentrations. The material property $D(x)$ is piecewise constant with a single jump at an internal interface located at $x=x_I$ inside the domain.\n\nYou must implement a uniform-grid, node-centered, second-order finite difference discretization for this equation that respects fundamental conservation principles for flux-based transport in computational geochemistry. The discretization must be designed directly from the core laws above: flux defined by Fick's first law and conservation of mass in each control volume, leading to a consistent approximation of spatial derivatives that guarantees the discrete balance of fluxes across each internal face. The approach must ensure that the discrete flux is continuous across the internal interface, reflecting the physical fact that steady-state transport in the absence of internal sources yields the same flux entering and leaving any internal point.\n\nThe internal interface is placed exactly at a grid node for all tests. The uniform grid uses $N+1$ nodes, indexed by $i=0,1,\\dots,N$, with grid spacing $\\Delta x = L/N$ and node positions $x_i = i\\,\\Delta x$. The interface node index is $i=i_I$, where $1 \\le i_I \\le N-1$. The piecewise constant diffusivity is $D(x)=D_\\text{left}$ for $x \\le x_I$ and $D(x)=D_\\text{right}$ for $x \\ge x_I$. The discrete system must incorporate the Dirichlet boundary conditions at $x=0$ and $x=L$ as prescribed values for $c_0$ and $c_N$.\n\nAfter solving the linear system for the discrete concentrations $\\{c_i\\}_{i=0}^N$, compute the discrete diffusive flux on the left face adjacent to the interface node and on the right face adjacent to the interface node. Use a physically consistent face representation of the diffusivity (derived from conservation at faces) and the discrete gradient between the neighboring node values across each face. Verify the continuity of flux at the interface by comparing the left-face flux $J_\\text{left}$ and the right-face flux $J_\\text{right}$ at the interface node $i=i_I$. Report a boolean result indicating whether $|J_\\text{left} - J_\\text{right}|$ is within a specified tolerance.\n\nPhysical units must be treated consistently as follows: $L$ in $\\mathrm{m}$, $D_\\text{left}$ and $D_\\text{right}$ in $\\mathrm{m}^2/\\mathrm{s}$, and $c_L$, $c_R$ in $\\mathrm{mol}/\\mathrm{m}^3$. Final outputs are booleans and therefore do not require unit annotation.\n\nYour program must implement the above and run on the following test suite. Each test case provides $(L,N,i_I,D_\\text{left},D_\\text{right},c_L,c_R,\\varepsilon)$, where $\\varepsilon$ is a flux-continuity tolerance. For each case, solve for the discrete concentration and then check flux continuity at the interface node using the specified $\\varepsilon$. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$).\n\nUse the following test suite:\n- Case $1$: $(L,N,i_I,D_\\text{left},D_\\text{right},c_L,c_R,\\varepsilon) = (1.0,100,45,1.0\\times 10^{-9},4.0\\times 10^{-9},1.2,0.2,1.0\\times 10^{-10})$.\n- Case $2$: $(2.0,200,100,2.0\\times 10^{-10},2.0\\times 10^{-10},0.0,1.0,1.0\\times 10^{-12})$.\n- Case $3$: $(1.0,20,1,1.0\\times 10^{-12},1.0\\times 10^{-9},0.5,0.0,1.0\\times 10^{-10})$.\n- Case $4$: $(1.0,200,150,1.0\\times 10^{-8},1.0\\times 10^{-12},1.0,0.0,1.0\\times 10^{-10})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite (e.g., $[b_1,b_2,b_3,b_4]$), where each $b_k$ is a boolean indicating whether flux continuity at the interface node is satisfied within tolerance for case $k$.",
            "solution": "The problem requires the implementation of a second-order accurate finite difference method for the one-dimensional steady-state diffusion equation with a piecewise constant diffusion coefficient. The discretization must be derived from fundamental conservation principles to ensure flux continuity across the material interface.\n\nThe governing equation for steady-state diffusion is derived from Fick's first law and the conservation of mass. Fick's first law defines the diffusive flux $J(x)$ as:\n$$ J(x) = -D(x)\\,\\dfrac{dc}{dx} $$\nwhere $c(x)$ is the concentration and $D(x)$ is the diffusivity. For a steady state with no sources or sinks, the flux must be divergence-free, which in one dimension means:\n$$ \\dfrac{dJ}{dx} = 0 $$\nCombining these gives the second-order ordinary differential equation:\n$$ \\dfrac{d}{dx}\\!\\left(D(x)\\,\\dfrac{dc}{dx}\\right) = 0 $$\nThe domain is $x \\in [0,L]$, with Dirichlet boundary conditions $c(0)=c_L$ and $c(L)=c_R$. The diffusivity $D(x)$ is piecewise constant:\n$$ D(x) = \\begin{cases} D_\\text{left} & \\text{for } x \\le x_I \\\\ D_\\text{right} & \\text{for } x \\ge x_I \\end{cases} $$\nwhere $x_I$ is the location of the internal interface.\n\nWe will use a node-centered finite difference/volume method. The domain $[0,L]$ is discretized into $N$ uniform intervals of length $\\Delta x = L/N$, with $N+1$ nodes located at $x_i = i\\,\\Delta x$ for $i=0, 1, \\dots, N$. Each internal node $i$ is associated with a control volume (CV) that extends from the midpoint between its neighbors, i.e., $\\text{CV}_i = [x_i - \\Delta x/2, x_i + \\Delta x/2] = [x_{i-1/2}, x_{i+1/2}]$.\n\nThe core principle is mass conservation over each control volume. Integrating the governing equation $\\dfrac{dJ}{dx} = 0$ over $\\text{CV}_i$:\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\dfrac{dJ}{dx} \\, dx = 0 $$\nApplying the fundamental theorem of calculus, we get a flux balance equation:\n$$ J(x_{i+1/2}) - J(x_{i-1/2}) = 0 $$\nThis states that the flux entering the control volume must equal the flux exiting it. We denote the fluxes at the faces as $J_{i+1/2}$ and $J_{i-1/2}$.\n\nWe approximate the flux at each face using a centered difference for the gradient. The flux at face $x_{i+1/2}$ between nodes $i$ and $i+1$ is:\n$$ J_{i+1/2} \\approx -D_{i+1/2} \\dfrac{c_{i+1} - c_i}{\\Delta x} $$\nwhere $D_{i+1/2}$ is the effective diffusivity at the face. The problem specifies that the interface is located exactly at a node $x_{i_I}$. This simplifies the determination of face diffusivities.\n\nFor any face $x_{i-1/2}$ not at the interface (i.e., $i \\ne i_I$ and $i-1 \\ne i_I$), the diffusivity is constant in the vicinity of the face.\nIf $i \\le i_I$, the face $x_{i-1/2}$ is in the 'left' material, so $D_{i-1/2} = D_\\text{left}$.\nIf $i > i_I+1$, the face $x_{i-1/2}$ is in the 'right' material, so $D_{i-1/2} = D_\\text{right}$.\n\nThe interface node is $i_I$. Its control volume is $[x_{i_I-1/2}, x_{i_I+1/2}]$.\nThe left face, $x_{i_I-1/2}$, is entirely within the 'left' material region, so $D_{i_I-1/2} = D_\\text{left}$.\nThe right face, $x_{i_I+1/2}$, is entirely within the 'right' material region, so $D_{i_I+1/2} = D_\\text{right}$.\n\nBased on this, we can formulate the discrete equations for each internal node $i=1, \\dots, N-1$.\n\nCase 1: Node $i$ is in the 'left' material ($1 \\le i < i_I$).\nBoth faces of the control volume are in the 'left' material, so $D_{i-1/2} = D_{i+1/2} = D_\\text{left}$. The flux balance is:\n$$ -D_\\text{left} \\dfrac{c_{i+1} - c_i}{\\Delta x} - \\left(-D_\\text{left} \\dfrac{c_i - c_{i-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -D_\\text{left}c_{i+1} + 2D_\\text{left}c_i - D_\\text{left}c_{i-1} = 0 $$\n\nCase 2: Node $i$ is at the interface ($i = i_I$).\nThe left face has $D_{i_I-1/2} = D_\\text{left}$ and the right face has $D_{i_I+1/2} = D_\\text{right}$. The flux balance is:\n$$ -D_\\text{right} \\dfrac{c_{i_I+1} - c_{i_I}}{\\Delta x} - \\left(-D_\\text{left} \\dfrac{c_{i_I} - c_{i_I-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -D_\\text{right} c_{i_I+1} + (D_\\text{left} + D_\\text{right}) c_{i_I} - D_\\text{left} c_{i_I-1} = 0 $$\nThis equation transparently enforces flux continuity at the interface node.\n\nCase 3: Node $i$ is in the 'right' material ($i_I < i < N$).\nBoth faces are in the 'right' material, so $D_{i-1/2} = D_{i+1/2} = D_\\text{right}$. The balance is:\n$$ -D_\\text{right} \\dfrac{c_{i+1} - c_i}{\\Delta x} - \\left(-D_\\text{right} \\dfrac{c_i - c_{i-1}}{\\Delta x}\\right) = 0 $$\n$$ \\implies -D_\\text{right}c_{i+1} + 2D_\\text{right}c_i - D_\\text{right}c_{i-1} = 0 $$\n\nThese $N-1$ linear equations for the unknown concentrations $c_1, \\dots, c_{N-1}$ form a tridiagonal system $A\\mathbf{c}_{int} = \\mathbf{b}$. The boundary conditions $c_0 = c_L$ and $c_N = c_R$ are incorporated into the right-hand side vector $\\mathbf{b}$. For the first equation ($i=1$), the term involving $c_0$ is moved to the right side, and for the last equation ($i=N-1$), the term involving $c_N$ is moved.\nThe resulting system is solved for the vector of internal concentrations $\\mathbf{c}_{int} = [c_1, \\dots, c_{N-1}]^T$.\n\nAfter solving for the concentrations, we verify flux continuity at the interface node $i_I$. The flux on the left face of its control volume is:\n$$ J_\\text{left} = J_{i_I-1/2} = -D_\\text{left} \\dfrac{c_{i_I} - c_{i_I-1}}{\\Delta x} $$\nThe flux on the right face of its control volume is:\n$$ J_\\text{right} = J_{i_I+1/2} = -D_\\text{right} \\dfrac{c_{i_I+1} - c_{i_I}}{\\Delta x} $$\nThe discretization for node $i_I$ was constructed precisely from the condition $J_\\text{right} - J_\\text{left} = 0$. Therefore, after solving the system, the computed values of $c_{i_I-1}$, $c_{i_I}$, and $c_{i_I+1}$ must satisfy this condition up to the numerical precision of the linear algebra solver. We verify this by checking if $|J_\\text{left} - J_\\text{right}| < \\varepsilon$ for a given tolerance $\\varepsilon$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state diffusion problem with a piecewise constant\n    diffusivity for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        (1.0, 100, 45, 1.0e-9, 4.0e-9, 1.2, 0.2, 1.0e-10),\n        (2.0, 200, 100, 2.0e-10, 2.0e-10, 0.0, 1.0, 1.0e-12),\n        (1.0, 20, 1, 1.0e-12, 1.0e-9, 0.5, 0.0, 1.0e-10),\n        (1.0, 200, 150, 1.0e-8, 1.0e-12, 1.0, 0.0, 1.0e-10)\n    ]\n\n    results = []\n    for case in test_cases:\n        L, N, i_I, D_left, D_right, c_L, c_R, epsilon = case\n        \n        M = N - 1 # Number of internal nodes\n        if M = 0:\n            results.append(False)\n            continue\n        \n        # Set up the tridiagonal matrix A and RHS vector b\n        A = np.zeros((M, M))\n        b = np.zeros(M)\n        \n        # Build matrix A and vector b using consistently scaled equations\n        # Loop over internal nodes to build matrix rows\n        for i in range(1, N): # i is the 1-based node index\n            row_idx = i - 1\n            \n            # For the control volume around node i, determine the diffusivity\n            # on its left and right faces.\n            D_face_left = D_left if i = i_I else D_right\n            D_face_right = D_left if i  i_I else D_right\n            \n            # The discrete equation is:\n            # -D_face_left * c_{i-1} + (D_face_left + D_face_right) * c_i - D_face_right * c_{i+1} = 0\n            \n            # Main diagonal coefficient for c_i\n            A[row_idx, row_idx] = D_face_left + D_face_right\n            \n            # Lower diagonal coefficient for c_{i-1}\n            if i == 1:\n                # c_0 is a boundary condition, move to RHS\n                b[row_idx] += D_face_left * c_L\n            else:\n                A[row_idx, row_idx - 1] = -D_face_left\n                \n            # Upper diagonal coefficient for c_{i+1}\n            if i == N - 1:\n                # c_N is a boundary condition, move to RHS\n                b[row_idx] += D_face_right * c_R\n            else:\n                A[row_idx, row_idx + 1] = -D_face_right\n\n        # Solve the linear system for internal concentrations\n        c_internal = np.linalg.solve(A, b)\n        \n        # Reconstruct the full concentration vector including boundaries\n        c = np.concatenate(([c_L], c_internal, [c_R]))\n        \n        # Calculate fluxes at the interface node's control volume faces\n        delta_x = L / N\n        \n        # Flux on the left face of CV_iI (between nodes i_I-1 and i_I)\n        J_left = -D_left * (c[i_I] - c[i_I - 1]) / delta_x\n        \n        # Flux on the right face of CV_iI (between nodes i_I and i_I+1)\n        J_right = -D_right * (c[i_I + 1] - c[i_I]) / delta_x\n\n        # Check for flux continuity within the given tolerance\n        is_continuous = np.abs(J_left - J_right)  epsilon\n        results.append(is_continuous)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}