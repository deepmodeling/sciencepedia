{
    "hands_on_practices": [
        {
            "introduction": "平流和弥散是控制溶质在多孔介质中迁移的两个基本过程。理解哪个过程占主导地位对于预测污染物羽流的扩展、评估地球化学反应的范围至关重要。本练习将引导您通过对平流-弥散方程进行无量纲化，推导出标志性的佩克莱数（Péclet number, $Pe$），并计算一个假设含水层中的 $Pe$ 值，从而对输运机制进行分类 ()。",
            "id": "4096509",
            "problem": "一个长度尺度为 $L$ 的饱和、均质一维含水层，在稳定流条件下输运一种保守、非反应性溶质。质量守恒控制方程与菲克（Fickian）流体动力学弥散相结合，得到了对流-弥散方程（ADE）：该方程描述了由平均线性孔隙水流速驱动的对流通量与由纵向弥散系数参数化的弥散通量之间的平衡。从这一基本原理出发，首先对ADE进行严格的无量纲化，以确定衡量对流与弥散相对重要性的无量纲比率。然后，对于下述含水层，计算该比率的值，并根据其大小将输运状态划分为对流主导或弥散主导。\n\n含水层和溶质输运特性：\n- 水力传导系数 $K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 水力梯度 $i = 1.0 \\times 10^{-2}$。\n- 有效孔隙度 $\\phi = 0.25$。\n- 代表性纵向长度尺度 $L = 5.00 \\times 10^{2}\\,\\mathrm{m}$。\n- 纵向弥散度 $\\alpha_{L} = 8.0\\,\\mathrm{m}$。\n- 在水中的分子扩散系数 $D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n\n假设特性为常数，且一维输运方向与水力梯度方向一致。使用达西定律建立达西通量与水力传导系数和梯度之间的关系，并使用达西通量与平均线性孔隙水流速之间的标准关系。将纵向流体动力学弥散系数建模为机械弥散与分子扩散之和，即 $D = D_{m} + \\alpha_{L}\\,u$，其中 $u$ 是平均线性流速。\n\n将从无量纲化中得到的无量纲比率作为此含水层的单个数值进行报告。该比率为无量纲；最终答案不带单位，并四舍五入至四位有效数字。使用您计算的值来划分输运状态，但请注意，最终答案仅要求提供该无量纲数。",
            "solution": "经评估，该问题陈述具有科学依据、提法适定、客观且完整。它是输运水文地质学中的一个标准问题，没有任何使其无效的缺陷。因此，我们可以进行完整解答。\n\n该问题要求从一维对流-弥散方程（ADE）中推导出一个无量纲数，并为指定的含水层系统计算其值。\n\n首先，我们建立控制方程。对于一维域中浓度为 $C$ 的保守溶质，其质量守恒由连续性方程表示：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0\n$$\n其中 $t$ 是时间，$x$ 是空间坐标，$J$ 是总溶质通量。总通量由对流分量 $J_{\\text{adv}}$ 和弥散分量 $J_{\\text{disp}}$ 组成。\n\n对流通量是由流体平均流动引起的输运所致：\n$$\nJ_{\\text{adv}} = u C\n$$\n其中 $u$ 是平均线性孔隙水流速。\n\n弥散通量（包括机械弥散和分子扩散）由菲克第一定律建模：\n$$\nJ_{\\text{disp}} = -D \\frac{\\partial C}{\\partial x}\n$$\n其中 $D$ 是流体动力学弥散系数。\n\n组合这些分量，总通量为 $J = u C - D \\frac{\\partial C}{\\partial x}$。将此代入连续性方程，得到：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( u C - D \\frac{\\partial C}{\\partial x} \\right) = 0\n$$\n对于稳定流（$u$ 为常数）和均质含水层（$D$ 为常数），该方程简化为对流-弥散方程（ADE）：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^2 C}{\\partial x^2}\n$$\n为了确定控制输运状态的无量纲比率，我们对此方程进行无量纲化。我们引入以下无量纲变量，其中带撇号的量是无量纲的：\n-   无量纲位置：$x' = \\frac{x}{L}$\n-   无量纲浓度：$C' = \\frac{C}{C_0}$\n-   无量纲时间：$t' = \\frac{t}{t_c}$\n\n这里，$L$ 是特征长度尺度，$C_0$ 是特征浓度，$t_c$ 是特征时间尺度。使用链式法则，我们变换偏导数：\n$$\n\\frac{\\partial}{\\partial x} = \\frac{1}{L} \\frac{\\partial}{\\partial x'}, \\quad \\frac{\\partial^2}{\\partial x^2} = \\frac{1}{L^2} \\frac{\\partial^2}{\\partial {x'}^2}, \\quad \\frac{\\partial}{\\partial t} = \\frac{1}{t_c} \\frac{\\partial}{\\partial t'}\n$$\n将这些代入ADE：\n$$\n\\frac{C_0}{t_c} \\frac{\\partial C'}{\\partial t'} = -u \\frac{C_0}{L} \\frac{\\partial C'}{\\partial x'} + D \\frac{C_0}{L^2} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n为简化起见，我们将整个方程除以 $\\frac{C_0 u}{L}$：\n$$\n\\left(\\frac{L}{u t_c}\\right) \\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\left(\\frac{D}{u L}\\right) \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n对于特征时间尺度 $t_c$，一个自然的选择是水体质点行进特征长度 $L$ 所需的时间，即对流时间尺度 $t_c = \\frac{L}{u}$。这一选择使得时间导数项的系数等于1。无量纲ADE于是变为：\n$$\n\\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\frac{1}{Pe} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n其中 $Pe$ 是贝克莱数（Péclet number），定义为：\n$$\nPe = \\frac{u L}{D}\n$$\n贝克莱数是衡量对流与弥散相对重要性的无量纲比率。大的 $Pe$ ($Pe \\gg 1$) 表示对流主导的输运，而小的 $Pe$ ($Pe \\ll 1$) 表示弥散主导的输运。\n\n接下来，我们根据给定的含水层特性计算该比率的值。\n给定值为：\n-   水力传导系数：$K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   水力梯度：$i = 1.0 \\times 10^{-2}$\n-   有效孔隙度：$\\phi = 0.25$\n-   代表性长度尺度：$L = 5.00 \\times 10^{2}\\,\\mathrm{m}$\n-   纵向弥散度：$\\alpha_{L} = 8.0\\,\\mathrm{m}$\n-   分子扩散系数：$D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n\n步骤1：计算平均线性孔隙水流速 $u$。\n首先，我们使用达西定律计算达西通量 $q$：\n$$\nq = K i = (1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n平均线性孔隙水流速 $u$ 是达西通量除以有效孔隙度 $\\phi$：\n$$\nu = \\frac{q}{\\phi} = \\frac{1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.25} = 4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\n步骤2：计算纵向流体动力学弥散系数 $D$。\n问题指定弥散系数的模型为机械弥散与分子扩散之和：\n$$\nD = \\alpha_{L} u + D_{m}\n$$\n代入数值：\n$$\nD = (8.0\\,\\mathrm{m})(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) + (1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1})\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 0.00015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} = 3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\n注意，机械弥散项比分子扩散项大几个数量级，这在对流性地下水系统中很常见。\n\n步骤3：计算贝克莱数 $Pe$。\n使用推导出的贝克莱数公式：\n$$\nPe = \\frac{u L}{D}\n$$\n代入 $u$、$L$ 和 $D$ 的值：\n$$\nPe = \\frac{(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(5.00 \\times 10^{2}\\,\\mathrm{m})}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe \\approx 62.49707\n$$\n问题要求最终答案四舍五入至四位有效数字。\n$$\nPe \\approx 62.50\n$$\n由于 $Pe \\approx 62.50 \\gg 1$，该含水层中的溶质输运状态为强对流主导。",
            "answer": "$$\\boxed{62.50}$$"
        },
        {
            "introduction": "将描述物理过程的偏微分方程转化为计算机可以求解的代数方程组，这一过程称为离散化，是计算地球化学的核心。然而，离散化会引入截断误差，这些误差有时会以“数值扩散”或“人工粘性”的形式显著改变模拟结果。本练习通过泰勒级数展开推导修正方程，揭示一个简单的一阶迎风格式如何为纯平流问题引入一个非物理的、与网格相关的扩散项，从而让您深刻理解数值方法的内在行为 ()。",
            "id": "3318156",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\neq 0$ 为常数，该方程表示均匀速度场对守恒标量的被动输运。在间距为 $h  0$ 的均匀空间网格上，通过在网格点 $x_{i}$ 处用向前差分算子替换空间导数，即用 $\\left(u(x_{i}+h,t) - u(x_{i},t)\\right)/h$ 来近似 $u_{x}(x_{i},t)$，构建半离散的线方法近似。仅以关于 $x_{i}$ 的 $u(x_{i}+h,t)$ 的泰勒定理以及平流定律本身为基本出发点，推导精确解所满足的修正偏微分方程，直至并包含 $h^{2}$ 阶的项。\n\n然后将修正方程重写为规范的平流-扩散-色散形式\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\nu_{\\mathrm{mod}}\\,u_{xx} \\;+\\; \\kappa_{\\mathrm{mod}}\\,u_{xxx} \\;+\\; \\mathcal{O}(h^{3}) \\quad \\text{于 } x_{i},\n$$\n并仅用 $a$ 和 $h$ 识别出有效的人工黏性系数 $\\nu_{\\mathrm{mod}}$。\n\n请以 $\\nu_{\\mathrm{mod}}$ 的封闭形式符号表达式给出最终答案。无需进行数值计算。如果使用任何中间常数或符号，它们必须在最终表达式中被消去，只剩下 $a$ 和 $h$。",
            "solution": "该问题要求推导一维线性平流方程的半离散近似的修正偏微分方程，并随后确定人工黏性系数。\n\n给定的偏微分方程（PDE）是线性平流方程：\n$$\nu_t + a u_x = 0\n$$\n其中 $u_t = \\frac{\\partial u}{\\partial t}$ 且 $u_x = \\frac{\\partial u}{\\partial x}$。平流速度 $a$ 是一个非零常数，$a \\neq 0$。\n\n问题指定了在间距为 $h  0$ 的均匀网格上的半离散线方法近似。在网格点 $x_i$ 处的空间导数 $u_x$ 使用一阶向前差分算子进行近似：\n$$\nu_x(x_i, t) \\approx \\frac{u(x_i+h, t) - u(x_i, t)}{h}\n$$\n将此近似代入原始偏微分方程，得到节点值 $u_i(t) \\equiv u(x_i, t)$ 的半离散方程组：\n$$\n\\frac{d u_i}{dt} + a \\left( \\frac{u_{i+1} - u_i}{h} \\right) = 0\n$$\n修正方程是指，当原始偏微分方程的精确解 $u(x, t)$ 代入数值格式时，该解所精确满足的偏微分方程。我们考虑数值格式施加于一个足够光滑的函数 $u$ 上的方程。这可以通过将离散值 $u_i(t)$ 和 $u_{i+1}(t)$ 替换为它们对应的连续函数值 $u(x_i, t)$ 和 $u(x_i+h, t)$ 来找到。因此，修正方程是将以下方程解释为一个微分方程：\n$$\n\\frac{\\partial u}{\\partial t}(x_i, t) + a \\left( \\frac{u(x_i+h, t) - u(x_i, t)}{h} \\right) = 0\n$$\n为了将其转换为一个可识别的偏微分方程，我们使用泰勒定理将 $u(x_i+h, t)$ 项在点 $x_i$ 附近展开。为清晰起见，我们将 $u(x_i,t)$ 记为 $u$，其在 $x_i$ 的空间导数记为 $u_x$, $u_{xx}$ 等。空间上的泰勒级数展开为：\n$$\nu(x_i+h, t) = u(x_i, t) + h \\frac{\\partial u}{\\partial x}(x_i, t) + \\frac{h^2}{2!} \\frac{\\partial^2 u}{\\partial x^2}(x_i, t) + \\frac{h^3}{3!} \\frac{\\partial^3 u}{\\partial x^3}(x_i, t) + \\mathcal{O}(h^4)\n$$\n将此展开式代入差分项中，得到：\n$$\n\\frac{u(x_i+h, t) - u(x_i, t)}{h} = \\frac{1}{h} \\left[ \\left( u + h u_x + \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} + \\mathcal{O}(h^4) \\right) - u \\right]\n$$\n简化括号内的表达式：\n$$\n\\frac{u(x_i+h, t) - u(x_i, t)}{h} = \\frac{1}{h} \\left[ h u_x + \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} + \\mathcal{O}(h^4) \\right]\n$$\n除以 $h$ 得到由向前差分表示的微分算子：\n$$\n\\frac{u(x_i+h, t) - u(x_i, t)}{h} = u_x + \\frac{h}{2} u_{xx} + \\frac{h^2}{6} u_{xxx} + \\mathcal{O}(h^3)\n$$\n现在我们将此结果代回假定精确解满足的半离散方程中：\n$$\nu_t + a \\left( u_x + \\frac{h}{2} u_{xx} + \\frac{h^2}{6} u_{xxx} + \\mathcal{O}(h^3) \\right) = 0\n$$\n将常数 $a$ 分配进去，得到修正后的偏微分方程：\n$$\nu_t + a u_x + \\frac{ah}{2} u_{xx} + \\frac{ah^2}{6} u_{xxx} + \\mathcal{O}(h^3) = 0\n$$\n问题要求将此方程写成规范的平流-扩散-色散形式：\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\nu_{\\mathrm{mod}}\\,u_{xx} \\;+\\; \\kappa_{\\mathrm{mod}}\\,u_{xxx} \\;+\\; \\mathcal{O}(h^{3})\n$$\n为了得到这种形式，我们将推导出的修正方程中的高阶导数项移到等号右侧：\n$$\nu_t + a u_x = - \\frac{ah}{2} u_{xx} - \\frac{ah^2}{6} u_{xxx} + \\mathcal{O}(h^3)\n$$\n问题指定推导应使用“平流定律本身”。这一步涉及到认识到左侧的 $u_t + a u_x$ 是来自原始平流定律的算子。右侧的项代表了空间离散化的主阶截断误差，它修正了原始偏微分方程的行为。这些项已经纯粹用空间导数表示，因此不需要进一步代换来获得所需的规范形式。\n\n通过将我们推导出的方程中的项与规范形式进行比较，我们可以确定人工扩散（或黏性）和色散的系数。\n比较 $u_{xx}$ 项：\n$$\n\\nu_{\\mathrm{mod}}\\,u_{xx} = - \\frac{ah}{2} u_{xx}\n$$\n这直接给出了有效人工黏性系数的表达式：\n$$\n\\nu_{\\mathrm{mod}} = - \\frac{ah}{2}\n$$\n为完整起见，我们也可以通过比较 $u_{xxx}$ 项来确定人工色散系数：\n$$\n\\kappa_{\\mathrm{mod}}\\,u_{xxx} = - \\frac{ah^2}{6} u_{xxx} \\quad \\implies \\quad \\kappa_{\\mathrm{mod}} = - \\frac{ah^2}{6}\n$$\n问题只要求给出 $\\nu_{\\mathrm{mod}}$ 的表达式。该项是 $\\mathcal{O}(h)$ 阶的，负责数值扩散（如果 $\\nu_{\\mathrm{mod}}  0$）或反扩散（如果 $\\nu_{\\mathrm{mod}}  0$）。由于向前差分格式是一阶精确的，主导误差项就是这个二阶导数的扩散/反扩散项。",
            "answer": "$$\n\\boxed{-\\frac{ah}{2}}\n$$"
        },
        {
            "introduction": "在开发了用于求解反应输运模型的数值代码后，我们如何确信它正在正确地求解我们意图求解的方程？代码验证是确保计算模型可靠性的关键步骤。本练习将向您介绍制造解方法（Method of Manufactured Solutions, MMS），这是一种强大而严谨的技术，用于验证代码是否以预期的收敛速率逼近方程的精确解。您将亲手为一个平流-弥散-反应（ADR）方程构建一个制造解，实现一个有限差分求解器，并分析其收敛速度以定量地评估代码的正确性 ()。",
            "id": "4079440",
            "problem": "考虑一个饱和地球化学柱中的一维溶质运移，该过程由平流-扩散-反应（Advection–Diffusion–Reaction, ADR）偏微分方程（Partial Differential Equation, PDE）建模。设 $u(x,t)$ 表示水相浓度，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，其中空间坐标 $x \\in [0,L]$，单位为 $\\mathrm{m}$，时间 $t \\in [0,T]$，单位为 $\\mathrm{s}$。ADR 偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t),\n$$\n其中 $a$ 是平流速度，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$；$D$ 是扩散（水动力弥散）系数，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$；$k$ 是一级反应速率常数，单位为 $\\mathrm{s}^{-1}$；$s(x,t)$ 是一个源项，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，代表外部输入。\n\n使用人造解法（method of manufactured solutions），定义精确浓度场为\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\big(2\\pi x/L\\big)\\,\\mathrm{e}^{-t} \\;+\\; \\tfrac{1}{2}\\,x\\,(L-x),\n$$\n其中区域长度 $L = 1$ $\\mathrm{m}$，最终时间 $T = 0.1$ $\\mathrm{s}$。施加与人造解匹配的狄利克雷边界条件（Dirichlet boundary conditions），使得对于所有 $t \\in [0,T]$，有 $u(0,t) = u_{\\mathrm{m}}(0,t)$ 和 $u(L,t) = u_{\\mathrm{m}}(L,t)$；并施加初始条件 $u(x,0) = u_{\\mathrm{m}}(x,0)$，对于所有 $x \\in [0,L]$。从上述 ADR 定义出发，推导源项 $s(x,t)$，使得对于任意常数 $a$、$D$ 和 $k$，$u_{\\mathrm{m}}(x,t)$ 成为连续 ADR 偏微分方程的一个精确解。\n\n通过具有 $N$ 个内部点（因此包括边界在内共有 $N+2$ 个节点）的均匀网格来离散化空间域，网格间距为 $h = L/(N+1)$。对一阶导数 $\\partial u/\\partial x$ 使用迎风有限差分法，对二阶导数 $\\partial^2 u/\\partial x^2$ 使用二阶中心差分法，对 $\\partial u/\\partial t$ 使用前向欧拉时间积分器。具体来说，对于给定的 $a$ 的符号，使用相应的迎风单边差分法。令时间步长 $\\Delta t$ 满足显式稳定性条件，取\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right),\n$$\n约定分母为零的项在求最小值时被视为 $+\\infty$。使用在当前时间层计算的人造源项 $s(x,t)$，通过前向欧拉法从 $t=0$ 积分到 $t=T$，并在每个时间步强制施加来自 $u_{\\mathrm{m}}(x,t)$ 的狄利克雷边界值。到达 $t=T$ 后，计算相对离散 $L^2$ 误差\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}},\n$$\n该误差是无量纲的。使用网格加密 $N \\in \\{40, 80, 160\\}$，估计观测收敛率\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)},\n$$\n其中 $h_j = L/(N_j+1)$ 且 $N_2=80$，$N_3=160$。\n\n测试套件：\n- 集合 $\\mathrm{A}$（扩散主导）：$a = 0.05$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-3}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{B}$（平流主导，正速度）：$a = 1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{C}$（平流主导，负速度）：$a = -1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{D}$（反应主导）：$a = 0.01$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 5.0$ $\\mathrm{s}^{-1}$。\n\n您的程序必须：\n- 从 ADR 偏微分方程和 $u_{\\mathrm{m}}(x,t)$ 推导并实现人造源项 $s(x,t)$。\n- 对每个参数集 $\\mathrm{A}$、$\\mathrm{B}$、$\\mathrm{C}$ 和 $\\mathrm{D}$，计算 $N \\in \\{40,80,160\\}$ 时的相对离散 $L^2$ 误差 $E_{h}$，然后使用上述公式计算 $p$。\n- 生成一行输出，其中包含四个集合的观测收敛率，按 $\\mathrm{A}$、$\\mathrm{B}$、$\\mathrm{C}$、$\\mathrm{D}$ 的顺序，以逗号分隔列表的形式封装在方括号中，每个浮点数四舍五入到三位小数，例如 $[p_A,p_B,p_C,p_D]$。\n\n所有输出都是无量纲的，必须以浮点数形式报告。不涉及角度。不涉及百分比。",
            "solution": "用户提供的问题是一个结构良好（well-posed）的计算科学练习，具体是使用人造解法（method of manufactured solutions）对偏微分方程（PDE）进行数值求解以验证代码。该问题具有科学依据，内容自洽，所有参数和方法都已明确定义。将通过首先推导必要的源项，然后基于指定的有限差分格式开发一个数值模型，最后使用该模型计算几种物理场景下的经验收敛率来解决此问题。\n\n### 1. 人造源项的推导\n\n该问题由平流-扩散-反应（ADR）方程控制：\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t)\n$$\n必须选择源项 $s(x,t)$，以使人造解 $u_{\\mathrm{m}}(x,t)$ 成为此 PDE 的精确解。我们可以通过重新整理 ADR 方程并代入 $u_{\\mathrm{m}}(x,t)$ 来找到 $s(x,t)$：\n$$\ns(x,t) = \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} + a\\,\\frac{\\partial u_{\\mathrm{m}}}{\\partial x} - D\\,\\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} + k\\,u_{\\mathrm{m}}\n$$\n给定的人造解为：\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} \\;+\\; \\frac{1}{2}\\,x\\,(L-x)\n$$\n为了找到 $s(x,t)$，我们首先计算 $u_{\\mathrm{m}}(x,t)$ 的必要偏导数：\n\\begin{itemize}\n    \\item 时间导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} = -\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\n    $$\n    \\item 一阶空间导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial x} = \\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\n    $$\n    \\item 二阶空间导数：\n    $$\n    \\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} = -\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\n    $$\n\\end{itemize}\n将这些表达式代入 $s(x,t)$ 的方程中：\n$$\ns(x,t) = \\left[-\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\\right] + a\\left[\\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\\right] - D\\left[-\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\\right] + k\\left[\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{1}{2}\\,x\\,(L-x)\\right]\n$$\n按其对 $x$ 和 $t$ 的函数依赖性对各项进行分组：\n$$\ns(x,t) = \\left(k - 1 + D\\left(\\frac{2\\pi}{L}\\right)^2\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + \\left(\\frac{2\\pi a}{L}\\right)\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + a\\left(\\frac{L}{2} - x\\right) + D + \\frac{k}{2}x(L-x)\n$$\n这是将在数值模型中实现的源项的解析表达式。\n\n### 2. 数值离散化\n\nPDE 在均匀空间网格 $x_i = i h$ 上进行离散化，其中 $i \\in \\{0, 1, \\dots, N+1\\}$，$h = L/(N+1)$ 是网格间距。时间被离散化为 $t_n = n \\Delta t$。我们将 $u(x_i, t_n)$ 的数值近似表示为 $u_i^n$。\n\n指定的数值格式为：\n\\begin{itemize}\n    \\item **时间导数**：前向欧拉法，$\\frac{\\partial u}{\\partial t} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$。\n    \\item **扩散项**：二阶中心差分，$\\frac{\\partial^2 u}{\\partial x^2} \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}$。\n    \\item **平流项**：一阶迎风差分。其形式取决于速度 $a$ 的符号：\n    \\begin{itemize}\n        \\item 如果 $a \\ge 0$（向右流动），使用后向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_i^n - u_{i-1}^n}{h}$。\n        \\item 如果 $a  0$（向左流动），使用前向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+1}^n - u_i^n}{h}$。\n    \\end{itemize}\n\\end{itemize}\n\n将 PDE 重新整理为 $\\frac{\\partial u}{\\partial t} = \\dots$ 的形式，并代入离散近似，得到更新规则 $u_i^{n+1} = u_i^n + \\Delta t (\\dots)$。\n\n对于 $a \\ge 0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_i^n - u_{i-1}^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n对于 $a  0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_{i+1}^n - u_i^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n这些方程应用于所有内部网格点 $i \\in \\{1, 2, \\dots, N\\}$。边界值由狄利克雷条件固定：$u_0^{n+1} = u_{\\mathrm{m}}(0, t_{n+1}) = 0$ 和 $u_{N+1}^{n+1} = u_{\\mathrm{m}}(L, t_{n+1}) = 0$。\n\n### 3. 时间步长和收敛性分析\n\n时间步长 $\\Delta t$ 的选择要满足前向欧拉格式的显式稳定性条件：\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)\n$$\n因子 $0.4$ 是一个安全系数，确保平流和扩散的 Courant–Friedrichs–Lewy (CFL) 条件以及反应项的稳定性条件都得到满足。\n\n模拟从初始条件 $u_i^0 = u_{\\mathrm{m}}(x_i, 0)$ 开始，进行到最终时间 $T$。数值解 $u_i(T)$ 的精度通过相对离散 $L^2$ 误差来量化：\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}\n$$\n观测到的收敛阶数 $p$ 通过计算两种不同网格分辨率 $h_2$（$N_2=80$）和 $h_3$（$N_3=160$）的误差来估计：\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)}\n$$\n该数值格式对时间积分（前向欧拉）和平流（迎风法）采用一阶方法，对扩散采用二阶方法。总体精度受限于阶数最低的项，因此理论收敛率预期为 $p \\approx 1$。\n\n### 4. 实现\n\n算法使用 Python 的 `numpy` 库实现，以进行高效的矢量化操作。定义一个函数，用于对给定的参数集 $(a, D, k)$ 和网格大小 $N$ 运行模拟。该函数初始化网格和解向量，计算稳定的时间步长，并在一个时间循环中迭代更新解。在循环内部，源项在当前时间进行评估，并根据 $a$ 的符号选择合适的迎风格式。达到最终时间 $T$ 后，该函数计算并返回相对 $L^2$ 误差。脚本的主体部分遍历四个测试套件，为 $N=80$ 和 $N=160$ 调用模拟函数，计算每个套件的收敛率 $p$，并按指定格式打印结果。",
            "answer": "[1.026,1.003,1.003,1.023]"
        }
    ]
}