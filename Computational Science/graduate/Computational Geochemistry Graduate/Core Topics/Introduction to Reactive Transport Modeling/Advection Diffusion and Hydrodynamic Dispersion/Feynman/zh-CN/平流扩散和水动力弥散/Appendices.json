{
    "hands_on_practices": [
        {
            "introduction": "在任何溶质运移问题中，平流和弥散都是相互竞争的关键过程。为了建立有效的模型，我们首先需要判断哪个过程占据主导地位。本练习  将带你通过一个实际的含水层场景，从基本的水文地质参数出发，推导并计算一个关键的无量纲参数——佩克莱数（Péclet number, $Pe$），并用它来判断主要的溶质运移机制。",
            "id": "4096509",
            "problem": "一个长度尺度为 $L$ 的饱和、均质、一维含水层，在稳定流条件下输运一种保守性、非反应性的溶质。质量守恒的控制方程与菲克型水动力弥散相结合，得到了对流-弥散方程 (ADE)：该方程描述了由平均线性孔隙水流速驱动的对流通量与由纵向弥散系数参数化的弥散通量之间的平衡。从这个基本方程出发，首先对ADE进行严格的无量纲化，以确定衡量对流与弥散相对重要性的无量纲比率。然后，对于下述含水层，评估该比率，并利用其量级将输运状态分类为对流主导或弥散主导。\n\n含水层及溶质输运性质：\n- 水力传导系数 $K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 水力梯度 $i = 1.0 \\times 10^{-2}$。\n- 有效孔隙度 $\\phi = 0.25$。\n- 代表性纵向长度尺度 $L = 5.00 \\times 10^{2}\\,\\mathrm{m}$。\n- 纵向弥散度 $\\alpha_{L} = 8.0\\,\\mathrm{m}$。\n- 水中分子扩散系数 $D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n\n假设性质恒定，且一维输运方向与水力梯度方向一致。使用达西定律建立达西通量与水力传导系数和梯度之间的关系，并使用达西通量与平均线性孔隙水流速之间的标准关系。将纵向水动力弥散系数建模为机械弥散与分子扩散之和，即 $D = D_{m} + \\alpha_{L}\\,u$，其中 $u$ 是平均线性流速。\n\n报告您通过无量纲化得到的该含水层的无量纲比率，以单一数值表示。该比率为无量纲量；最终答案不带单位，并四舍五入至四位有效数字。使用您计算出的值对输运状态进行分类，但请注意，最终答案只需要无量纲数。",
            "solution": "经评估，该问题陈述具有科学依据、提法恰当、客观且完整。这是输运水文地质学中的一个标准问题，没有任何使其无效的缺陷。因此，我们可以进行完整求解。\n\n该问题要求从一维对流-弥散方程（ADE）推导出一个无量纲数，并为指定的含水层系统计算其值。\n\n首先，我们建立控制方程。对于浓度为 $C$ 的保守性溶质，其在一维域中的质量守恒由连续性方程表示：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0\n$$\n其中 $t$ 是时间，$x$ 是空间坐标，$J$ 是总溶质通量。总通量由对流通量 $J_{\\text{adv}}$ 和弥散通量 $J_{\\text{disp}}$ 组成。\n\n对流通量是由流体的平均流动引起的输运：\n$$\nJ_{\\text{adv}} = u C\n$$\n其中 $u$ 是平均线性孔隙水流速。\n\n弥散通量，包括机械弥散和分子扩散，由菲克第一定律建模：\n$$\nJ_{\\text{disp}} = -D \\frac{\\partial C}{\\partial x}\n$$\n其中 $D$ 是水动力弥散系数。\n\n结合这些分量，总通量为 $J = u C - D \\frac{\\partial C}{\\partial x}$。将其代入连续性方程得到：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( u C - D \\frac{\\partial C}{\\partial x} \\right) = 0\n$$\n对于稳定流（$u$ 是常数）和均质含水层（$D$ 是常数），该方程简化为对流-弥散方程（ADE）：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^2 C}{\\partial x^2}\n$$\n为了确定控制输运状态的无量纲比率，我们对该方程进行无量纲化。我们引入以下无量纲变量，其中带撇号的量是无量纲的：\n-   无量纲位置：$x' = \\frac{x}{L}$\n-   无量纲浓度：$C' = \\frac{C}{C_0}$\n-   无量纲时间：$t' = \\frac{t}{t_c}$\n\n这里，$L$ 是特征长度尺度，$C_0$ 是特征浓度，$t_c$ 是特征时间尺度。使用链式法则，我们变换偏导数：\n$$\n\\frac{\\partial}{\\partial x} = \\frac{1}{L} \\frac{\\partial}{\\partial x'}, \\quad \\frac{\\partial^2}{\\partial x^2} = \\frac{1}{L^2} \\frac{\\partial^2}{\\partial {x'}^2}, \\quad \\frac{\\partial}{\\partial t} = \\frac{1}{t_c} \\frac{\\partial}{\\partial t'}\n$$\n将这些代入ADE中：\n$$\n\\frac{C_0}{t_c} \\frac{\\partial C'}{\\partial t'} = -u \\frac{C_0}{L} \\frac{\\partial C'}{\\partial x'} + D \\frac{C_0}{L^2} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n为简化起见，我们将整个方程除以 $\\frac{C_0 u}{L}$：\n$$\n\\left(\\frac{L}{u t_c}\\right) \\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\left(\\frac{D}{u L}\\right) \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n特征时间尺度 $t_c$ 的一个自然选择是水质点行进特征长度 $L$ 所需的时间，即对流时间尺度 $t_c = \\frac{L}{u}$。这个选择使得时间导数项的系数等于 $1$。无量纲ADE于是变为：\n$$\n\\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\frac{1}{Pe} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\n其中 $Pe$ 是佩克莱数，定义为：\n$$\nPe = \\frac{u L}{D}\n$$\n佩克莱数是衡量对流与弥散相对重要性的无量纲比率。大的 $Pe$ 值（$Pe \\gg 1$）表示对流主导的输运，而小的 $Pe$ 值（$Pe \\ll 1$）表示弥散主导的输运。\n\n接下来，我们根据给定的含水层性质计算这个比率。\n给定的值为：\n-   水力传导系数：$K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   水力梯度：$i = 1.0 \\times 10^{-2}$\n-   有效孔隙度：$\\phi = 0.25$\n-   代表性长度尺度：$L = 5.00 \\times 10^{2}\\,\\mathrm{m}$\n-   纵向弥散度：$\\alpha_{L} = 8.0\\,\\mathrm{m}$\n-   分子扩散系数：$D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n\n步骤1：计算平均线性孔隙水流速 $u$。\n首先，我们使用达西定律计算达西通量 $q$：\n$$\nq = K i = (1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n平均线性孔隙水流速 $u$ 是达西通量除以有效孔隙度 $\\phi$：\n$$\nu = \\frac{q}{\\phi} = \\frac{1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.25} = 4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\n步骤2：计算纵向水动力弥散系数 $D$。\n问题指定弥散系数的模型为机械弥散与分子扩散之和：\n$$\nD = \\alpha_{L} u + D_{m}\n$$\n代入数值：\n$$\nD = (8.0\\,\\mathrm{m})(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) + (1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1})\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 0.00015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} = 3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\n请注意，机械弥散项比分子扩散项大几个数量级，这在对流型地下水系统中很常见。\n\n步骤3：计算佩克莱数 $Pe$。\n使用推导出的佩克莱数公式：\n$$\nPe = \\frac{u L}{D}\n$$\n代入 $u$、$L$ 和 $D$ 的值：\n$$\nPe = \\frac{(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(5.00 \\times 10^{2}\\,\\mathrm{m})}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe \\approx 62.49707\n$$\n问题要求最终答案四舍五入至四位有效数字。\n$$\nPe \\approx 62.50\n$$\n由于 $Pe \\approx 62.50 \\gg 1$，该含水层中的溶质输运状态为强对流主导。",
            "answer": "$$\\boxed{62.50}$$"
        },
        {
            "introduction": "偏微分方程本身不足以描述一个完整的物理系统，我们还必须定义其边界条件，即模型如何与外部环境相互作用。选择正确的边界条件是确保模拟结果物理真实性的关键一步，也是数值建模中最容易出错的环节之一。本练习  旨在通过一个思想实验，帮助你深入理解如何为常见的物理情景（如溶质入流、出流和表面反应）匹配正确的数学边界条件类型（狄利克雷、诺伊曼或罗宾）。",
            "id": "4094148",
            "problem": "考虑一个浓度为 $C(x,t)$ 的溶解水相物质，在一个边界为 $\\partial \\Omega$、占据区域 $\\Omega \\subset \\mathbb{R}^d$ 的饱和多孔介质中，经历平流、扩散-弥散和均相反应。令 $\\phi$ 表示孔隙度，$\\mathbf{u}(x)$ 表示 Darcy 速度场，$\\mathbf{D}(x)$ 表示（对称正定的）水动力弥散张量，$r(C)$ 表示体积反应速率（单位时间单位体积的溶质质量），$\\mathbf{n}$ 表示 $\\partial \\Omega$ 上的外单位法向量。溶质质量的局部守恒由以下偏微分方程（PDE）表示\n$$\n\\phi \\,\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\left(\\mathbf{u}\\, C - \\mathbf{D}\\,\\nabla C \\right) = -\\, r(C) \\quad \\text{in } \\Omega \\times (0,T] .\n$$\n在边界 $\\partial \\Omega$ 上，物理上相关的通量是总质量通量的法向分量，\n$$\n\\mathbf{J}\\cdot \\mathbf{n} = \\left(\\mathbf{u}\\, C - \\mathbf{D}\\,\\nabla C\\right)\\cdot \\mathbf{n},\n$$\n它包含一个平流贡献 $\\mathbf{u}\\cdot \\mathbf{n} \\, C$ 和一个扩散-弥散贡献 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$。$\\partial \\Omega$ 的一部分可能与已知浓度的外部储库接触，另一部分可能代表一个通过界面动力学消耗溶质的反应性固体表面。对于流体进入区域的边界段（流入），$\\mathbf{u}\\cdot \\mathbf{n}  0$；对于流体离开区域的边界段（流出），$\\mathbf{u}\\cdot \\mathbf{n} > 0$。\n\n请区分在 $\\partial \\Omega$ 上施加于 $C$ 的 Dirichlet、Neumann 和 Robin 边界条件的数学意义，并选择一个选项，该选项能正确指明哪种类型的边界条件在物理上适用于流入边界、流出边界以及与外部相存在一级界面传质的反应边界。该选择必须基于上述基本质量平衡以及将 $\\mathbf{J}\\cdot \\mathbf{n}$ 分解为平流部分和扩散-弥散部分来证明其合理性。特别地，您的选择应反映以下物理机制：在流入处，进入的流体将其浓度施加于区域上；在流出处，流出的流体不应受到人为约束，并应防止向区域内的扩散；在反应表面，界面吸收应能表示为与外部参考浓度的偏差成正比的线性传质定律。假设流出处的 Péclet 数（Pe）足够大，以至于流出段上的扩散-弥散贡献与平流相比可以忽略不计。\n\n哪个选项是正确的？\n\nA. Dirichlet 条件指定 $\\partial \\Omega$ 上的 $C$；Neumann 条件指定 $\\partial \\Omega$ 上的法向扩散-弥散通量 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n}$；Robin 条件指定 $C$ 与法向扩散-弥散通量之间的线性关系，形式为 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = \\kappa \\left(C - C_b\\right)$，其中 $\\kappa > 0$ 且 $C_b$ 为已知。在流入处（$\\mathbf{u}\\cdot \\mathbf{n}  0$）使用 Dirichlet 条件以施加进入的浓度，在流出处（$\\mathbf{u}\\cdot \\mathbf{n}>0$）使用齐次 Neumann 条件 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = 0$ 以允许对流输运将溶质带出而无扩散回流，在反应表面使用 Robin 条件以表示与外部相的一级界面传质。\n\nB. Dirichlet 条件指定 $\\partial \\Omega$ 上的 $C$；Neumann 条件指定总法向通量 $\\mathbf{J}\\cdot \\mathbf{n}$；Robin 条件对输运没有物理意义。在流入处使用 Neumann 条件以规定进入的总通量，在流出处使用 Dirichlet 条件以防止数值振荡，并且不在反应表面使用 Robin 条件。\n\nC. Dirichlet、Neumann 和 Robin 条件都直接指定 $C$，区别仅在于值是否被平均。在流入和流出处都使用 Dirichlet 条件以控制浓度，在反应表面使用 Neumann 条件因为反应会改变 $C$。\n\nD. Dirichlet 条件指定 $C$；Neumann 条件指定 $\\partial C/\\partial n$；Robin 条件指定 $\\alpha C + \\beta \\,\\partial C/\\partial n = \\gamma$，其中 $\\alpha$, $\\beta$, $\\gamma$ 为常数。在流入处使用 Neumann 条件，通过强制 $\\partial C/\\partial n = 0$ 来防止边界层，在流出处使用 Dirichlet 条件以在遥远的下游设置 $C=0$，并且仅在 $\\mathbf{u}\\cdot \\mathbf{n} = 0$ 时使用 Robin 条件。\n\nE. Dirichlet 条件指定 $\\partial \\Omega$ 上的 $C$；Neumann 条件指定 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n}$；Robin 条件指定 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = \\kappa C$。每当 $\\mathbf{u}\\cdot \\mathbf{n} \\neq 0$ 时，在流入和流出处都使用 Robin 条件，以便通过 $\\kappa$ 正确地包含平流，并且仅在 $\\mathbf{u}\\cdot \\mathbf{n} = 0$（无流边界）时使用 Dirichlet 条件。",
            "solution": "该问题要求分析 Dirichlet、Neumann 和 Robin 边界条件，以及它们对于由平流-弥散-反应（ADR）方程控制的物质在流入、流出和反应边界上的物理适用性。\n\n控制性偏微分方程为：\n$$ \\phi \\,\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\left(\\mathbf{u}\\, C - \\mathbf{D}\\,\\nabla C \\right) = -\\, r(C) $$\n总通量矢量为 $\\mathbf{J} = \\mathbf{u}\\, C - \\mathbf{D}\\,\\nabla C$。穿过边界 $\\partial \\Omega$ 的总通量的法向分量为 $\\mathbf{J}\\cdot \\mathbf{n}$。\n\n首先，让我们在这个二阶偏微分方程的背景下精确定义这三种类型的边界条件。\n\n1.  **Dirichlet 边界条件（第一类）：** 该条件直接规定边界 $\\partial\\Omega_D \\subseteq \\partial\\Omega$ 的一部分上的浓度值 $C$。\n    $$ C(\\mathbf{x}, t) = C_{spec}(\\mathbf{x}, t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega_D $$\n    其中 $C_{spec}$ 是一个指定的函数。\n\n2.  **Neumann 边界条件（第二类）：** 该条件规定边界 $\\partial\\Omega_N \\subseteq \\partial\\Omega$ 的一部分上的扩散-弥散通量的法向分量 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$ 的值。扩散-弥散通量与偏微分方程中的最高阶空间导数相关联。\n    $$ -\\mathbf{D}\\nabla C(\\mathbf{x}, t) \\cdot \\mathbf{n} = g(\\mathbf{x}, t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega_N $$\n    其中 $g$ 是一个指定的通量。齐次 Neumann 条件将此通量设为零，$g=0$。请注意，指定总通量 $\\mathbf{J}\\cdot\\mathbf{n}$ 将导致一个 Robin 型条件，如下所示。\n\n3.  **Robin 边界条件（第三类或混合型）：** 该条件规定边界 $\\partial\\Omega_R \\subseteq \\partial\\Omega$ 的一部分上的浓度 $C$ 与法向扩散-弥散通量 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$ 之间的线性关系。\n    $$ a C(\\mathbf{x}, t) + b \\left(-\\mathbf{D}\\nabla C(\\mathbf{x}, t) \\cdot \\mathbf{n}\\right) = h(\\mathbf{x}, t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega_R $$\n    其中 $a$、$b$ 和 $h$ 是指定的函数或常数。\n\n现在，我们来分析这些条件在给定情景下的物理适宜性。\n\n**流入边界（$\\mathbf{u}\\cdot \\mathbf{n}  0$）**：\n问题陈述“在流入处，进入的流体将其浓度施加于区域上”。如果一个已知浓度（比如 $C_{in}$）的流体进入区域，表示这种情况最直接、物理上最合理的方式是将边界处的浓度设定为此已知值。这就是 **Dirichlet** 边界条件的定义：$C = C_{in}$。在化学工程中，此条件也称为 Danckwerts 型条件。指定总通量 $\\mathbf{J}\\cdot\\mathbf{n}$ 是有问题的，因为它既涉及 $C$ 又涉及 $\\nabla C$，在平流主导的情况下，它不能唯一地确定流入流体的状态。\n\n**流出边界（$\\mathbf{u}\\cdot \\mathbf{n} > 0$）**：\n问题陈述“流出的流体不应受到人为约束，并应防止向区域内的扩散”。它还提供了一个关键假设，即 Péclet 数（$Pe$）足够大，意味着在出口处平流主导弥散。离开区域的总通量是 $\\mathbf{J}\\cdot\\mathbf{n} = (\\mathbf{u}\\cdot\\mathbf{n}) C - (\\mathbf{D}\\nabla C \\cdot \\mathbf{n})$。高 $Pe$ 数的假设意味着扩散-弥散通量的贡献与平流通量相比可以忽略不计：$|(\\mathbf{u}\\cdot\\mathbf{n}) C| \\gg |-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}|$。实现这种“自由流出”条件最常见的方法是，将扩散-弥散通量设为零，这样可以防止非物理的、从虚拟的下游环境反向扩散回区域内的现象。\n$$ -\\mathbf{D}\\nabla C \\cdot \\mathbf{n} = 0 $$\n这是一个 **齐次 Neumann** 条件。它允许溶质自由地通过平流被带出（$\\mathbf{J}\\cdot\\mathbf{n} \\approx (\\mathbf{u}\\cdot\\mathbf{n}) C$），而边界上的 $C$ 值由区域内的输运过程决定，而不是被人为施加。在流出处使用 Dirichlet 条件会过度约束问题，并引入一个非物理的边界层，从而可能破坏上游的解。\n\n**反应边界**：\n问题描述了由“与外部参考浓度的偏差成正比的线性传质定律”控制的“与外部相的一级界面传质”。设传质系数为 $\\kappa$（单位为长度/时间），外部参考浓度为 $C_b$。表面反应消耗的溶质通量由定律 $\\kappa(C - C_b)$ 给出。根据边界界面处的质量守恒，这个反应通量必须等于从主体流体供应到表面的溶质通量。假设表面本身对流体流动是不可渗透的（即，在反应性固体表面处 $\\mathbf{u}\\cdot\\mathbf{n}=0$），则到达表面的通量纯粹是扩散-弥散性的，即 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$。令这两个通量相等，得到：\n$$ -\\mathbf{D}\\nabla C \\cdot \\mathbf{n} = \\kappa(C - C_b) $$\n这个方程指定了边界上浓度 $C$ 与其扩散-弥散通量之间的线性关系。这就是 **Robin** 边界条件的定义。\n\n**结论总结**：\n-   **定义**：标准定义如下：Dirichlet（指定 $C$），Neumann（指定 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$），以及 Robin（指定 $C$ 和 $-\\mathbf{D}\\nabla C \\cdot \\mathbf{n}$ 的线性组合）。\n-   **流入**：Dirichlet 条件（$C = C_{in}$）。\n-   **流出（高 Pe）**：齐次 Neumann 条件（$-\\mathbf{D}\\nabla C \\cdot \\mathbf{n} = 0$）。\n-   **反应表面（一级）**：Robin 条件（$-\\mathbf{D}\\nabla C \\cdot \\mathbf{n} = \\kappa(C - C_b)$）。\n\n现在我们根据此分析评估给出的选项。\n\n**A.** “Dirichlet 条件指定 $\\partial \\Omega$ 上的 $C$；Neumann 条件指定 $\\partial \\Omega$ 上的法向扩散-弥散通量 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n}$；Robin 条件指定 $C$ 与法向扩散-弥散通量之间的线性关系，形式为 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = \\kappa \\left(C - C_b\\right)$，其中 $\\kappa > 0$ 且 $C_b$ 为已知。在流入处（$\\mathbf{u}\\cdot \\mathbf{n}  0$）使用 Dirichlet 条件以施加进入的浓度，在流出处（$\\mathbf{u}\\cdot \\mathbf{n}>0$）使用齐次 Neumann 条件 $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = 0$ 以允许对流输运将溶质带出而无扩散回流，在反应表面使用 Robin 条件以表示与外部相的一级界面传质。”\n该选项在物理问题的背景下正确定义了所有三种边界条件类型，并基于上述物理原则将它们正确地分配给了流入、流出（高 Pe）和反应表面情景。\n**结论：正确。**\n\n**B.** “Dirichlet 条件指定 $\\partial \\Omega$ 上的 $C$；Neumann 条件指定总法向通量 $\\mathbf{J}\\cdot \\mathbf{n}$；Robin 条件对输运没有物理意义。在流入处使用 Neumann 条件以规定进入的总通量，在流出处使用 Dirichlet 条件以防止数值振荡，并且不在反应表面使用 Robin 条件。”\n该选项在多个方面都是错误的。Neumann 条件的定义通常是针对扩散通量，而不是总通量。Robin 条件是传质的物理上有意义的表示。在流入处使用总通量（Neumann）条件是有问题的，而在流出处使用 Dirichlet 条件在物理上是错误的，是误差的来源，而不是解决振荡的稳健方案。\n**结论：错误。**\n\n**C.** “Dirichlet、Neumann 和 Robin 条件都直接指定 $C$，区别仅在于值是否被平均。在流入和流出处都使用 Dirichlet 条件以控制浓度，在反应表面使用 Neumann 条件因为反应会改变 $C$。”\n这种说法从根本上误解了 Neumann 和 Robin 条件的数学定义，这些定义涉及导数（通量），而不仅仅是 $C$ 的值。将其应用于流出（Dirichlet）也是不正确的。\n**结论：错误。**\n\n**D.** “Dirichlet 条件指定 $C$；Neumann 条件指定 $\\partial C/\\partial n$；Robin 条件指定 $\\alpha C + \\beta \\,\\partial C/\\partial n = \\gamma$ with constants $\\alpha$, $\\beta$, $\\gamma$。在流入处使用 Neumann 条件，通过强制 $\\partial C/\\partial n = 0$ 来防止边界层，在流出处使用 Dirichlet 条件以在遥远的下游设置 $C=0$，并且仅在 $\\mathbf{u}\\cdot \\mathbf{n} = 0$ 时使用 Robin 条件。”\n定义被简化了（假设 $\\mathbf{D}$ 是各向同性的），但应用方面有严重缺陷。在流入处使用零通量 Neumann 条件在物理上是错误的。在流出处使用 Dirichlet 条件在物理上是错误的。将 Robin 条件限制在无流边界是武断且错误的。\n**结论：错误。**\n\n**E.** “Dirichlet specifies $C$ on $\\partial \\Omega$; Neumann specifies $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n}$; Robin specifies $-\\mathbf{D}\\nabla C\\cdot \\mathbf{n} = \\kappa C$. Use Robin at both inflow and outflow whenever $\\mathbf{u}\\cdot \\mathbf{n} \\neq 0$ so that advection is correctly included via $\\kappa$, and Dirichlet only when $\\mathbf{u}\\cdot \\mathbf{n} = 0$ (no-flow boundaries).”\n该选项包含一个深层次的概念错误，它暗示 Robin 条件是借由系数 $\\kappa$ 来“包含平流”的一种方式。平流是控制性偏微分方程算子 $\\nabla \\cdot (\\mathbf{u}C)$ 的一部分。边界条件处理的是*在边界上*的通量和值，它们不能替代偏微分方程中的项。所提议的对流入、流出和无流边界的应用都是不正确的。\n**结论：错误。**\n\n因此，选项 A 是唯一一个正确定义了边界条件，并根据反应输运模拟的既定物理和数学原则来应用它们的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "编写了求解复杂偏微分方程的代码后，我们如何能确信其计算结果是正确的？“制造解方法”（Method of Manufactured Solutions, MMS）是进行此类代码验证的黄金标准。本综合性实践  将引导你完成整个验证流程：首先为一个已知的精确解（即“制造解”）推导其对应的源项，然后实现一个求解完整平流-弥散-反应方程的有限差分模型，并最终通过数值实验来检验代码的收敛阶，从而验证其准确性。",
            "id": "4079440",
            "problem": "考虑在一个饱和地球化学柱中的一维溶质运移，该过程由对流-扩散-反应 (ADR) 偏微分方程 (PDE) 建模。令 $u(x,t)$ 表示水相浓度，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，其中空间坐标 $x \\in [0,L]$ 的单位为 $\\mathrm{m}$，时间 $t \\in [0,T]$ 的单位为 $\\mathrm{s}$。ADR 偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t)\n$$\n其中 $a$ 是对流速度，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$；$D$ 是扩散（水动力弥散）系数，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$；$k$ 是一级反应速率常数，单位为 $\\mathrm{s}^{-1}$；$s(x,t)$ 是一个源项，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，表示外部输入。\n\n使用构造解法，定义精确浓度场\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\big(2\\pi x/L\\big)\\,\\mathrm{e}^{-t} \\;+\\; \\tfrac{1}{2}\\,x\\,(L-x)\n$$\n其域长度 $L = 1$ $\\mathrm{m}$，最终时间 $T = 0.1$ $\\mathrm{s}$。施加与构造解相匹配的狄利克雷边界条件，使得对于所有 $t \\in [0,T]$，有 $u(0,t) = u_{\\mathrm{m}}(0,t)$ 和 $u(L,t) = u_{\\mathrm{m}}(L,t)$；并施加初始条件 $u(x,0) = u_{\\mathrm{m}}(x,0)$，对于所有 $x \\in [0,L]$。从上述 ADR 定义出发，推导源项 $s(x,t)$，使得 $u_{\\mathrm{m}}(x,t)$ 成为对于任意常数 $a$、$D$ 和 $k$ 的连续 ADR 偏微分方程的精确解。\n\n通过具有 $N$ 个内部点（因此包括边界在内共有 $N+2$ 个节点）的均匀网格离散化空间域，间距为 $h = L/(N+1)$。对一阶导数 $\\partial u/\\partial x$ 使用迎风有限差分，对二阶导数 $\\partial^2 u/\\partial x^2$ 使用二阶中心差分，对 $\\partial u/\\partial t$ 使用前向欧拉时间积分器。具体来说，对于给定的 $a$ 的符号，使用相应的迎风单边差分。令时间步长 $\\Delta t$ 满足显式稳定性条件，取\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)\n$$\n约定分母为零的项在最小值计算中视为 $+\\infty$。使用在当前时间层级计算的构造源项 $s(x,t)$，从 $t=0$ 到 $t=T$ 进行前向欧拉积分，并在每个时间步强制施加来自 $u_{\\mathrm{m}}(x,t)$ 的狄利克雷边界值。达到 $t=T$ 后，计算相对离散 $L^2$ 误差\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}\n$$\n该误差是无量纲的。使用网格细化 $N \\in \\{40, 80, 160\\}$，估算观测收敛率\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)}\n$$\n其中 $h_j = L/(N_j+1)$ 且 $N_2=80$，$N_3=160$。\n\n测试套件：\n- 集合 $\\mathrm{A}$ (扩散主导)：$a = 0.05$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-3}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{B}$ (对流主导，正速度)：$a = 1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{C}$ (对流主导，负速度)：$a = -1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- 集合 $\\mathrm{D}$ (反应主导)：$a = 0.01$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 5.0$ $\\mathrm{s}^{-1}$。\n\n您的程序必须：\n- 根据 ADR 偏微分方程和 $u_{\\mathrm{m}}(x,t)$ 推导并实现构造源项 $s(x,t)$。\n- 对于每个参数集合 $\\mathrm{A}$、$\\mathrm{B}$、$\\mathrm{C}$ 和 $\\mathrm{D}$，计算 $N \\in \\{40,80,160\\}$ 时的相对离散 $L^2$ 误差 $E_{h}$，然后使用上述公式计算 $p$。\n- 生成单行输出，其中包含四个集合的观测收敛率，形式为方括号内以逗号分隔的列表，顺序为 $\\mathrm{A}$、$\\mathrm{B}$、$\\mathrm{C}$、$\\mathrm{D}$，每个浮点数四舍五入到三位小数，例如 $[p_A,p_B,p_C,p_D]$。\n\n所有输出均为无量纲，且必须以浮点数形式报告。不涉及角度。不涉及百分比。",
            "solution": "用户提供的问题是计算科学领域一个适定的练习，具体是使用构造解法进行代码验证，以数值求解偏微分方程（PDE）。该问题具有科学依据、自洽，并且所有参数和方法都已明确定义。将通过首先推导必要的源项，然后基于指定的有限差分格式开发数值模型，最后使用该模型计算几种物理情景下的经验收敛率来解决此问题。\n\n### 1. 构造源项的推导\n\n问题由对流-扩散-反应（ADR）方程控制：\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t)\n$$\n必须选择源项 $s(x,t)$，以使构造解 $u_{\\mathrm{m}}(x,t)$ 成为此 PDE 的一个精确解。我们可以通过重新排列 ADR 方程并代入 $u_{\\mathrm{m}}(x,t)$ 来找到 $s(x,t)$：\n$$\ns(x,t) = \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} + a\\,\\frac{\\partial u_{\\mathrm{m}}}{\\partial x} - D\\,\\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} + k\\,u_{\\mathrm{m}}\n$$\n构造解给出为：\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} \\;+\\; \\frac{1}{2}\\,x\\,(L-x)\n$$\n为求得 $s(x,t)$，我们首先计算 $u_{\\mathrm{m}}(x,t)$ 所需的偏导数：\n\\begin{itemize}\n    \\item 时间导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} = -\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\n    $$\n    \\item 一阶空间导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial x} = \\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\n    $$\n    \\item 二阶空间导数：\n    $$\n    \\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} = -\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\n    $$\n\\end{itemize}\n将这些表达式代入 $s(x,t)$ 的方程：\n$$\ns(x,t) = \\left[-\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\\right] + a\\left[\\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\\right] - D\\left[-\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\\right] + k\\left[\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{1}{2}\\,x\\,(L-x)\\right]\n$$\n按其对 $x$ 和 $t$ 的函数依赖性对各项进行分组：\n$$\ns(x,t) = \\left(k - 1 + D\\left(\\frac{2\\pi}{L}\\right)^2\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + \\left(\\frac{2\\pi a}{L}\\right)\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + a\\left(\\frac{L}{2} - x\\right) + D + \\frac{k}{2}x(L-x)\n$$\n这是将在数值模型中实现的源项的解析表达式。\n\n### 2. 数值离散化\n\nPDE 在均匀空间网格 $x_i = i h$（其中 $i \\in \\{0, 1, \\dots, N+1\\}$，$h = L/(N+1)$ 是网格间距）上进行离散化。时间被离散化为 $t_n = n \\Delta t$。我们将 $u(x_i, t_n)$ 的数值近似表示为 $u_i^n$。\n\n指定的数值格式为：\n\\begin{itemize}\n    \\item **时间导数**：前向欧拉法，$\\frac{\\partial u}{\\partial t} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$。\n    \\item **扩散项**：二阶中心差分，$\\frac{\\partial^2 u}{\\partial x^2} \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}$。\n    \\item **对流项**：一阶迎风差分。其形式取决于速度 $a$ 的符号：\n    \\begin{itemize}\n        \\item 如果 $a \\ge 0$（向右流动），使用后向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_i^n - u_{i-1}^n}{h}$。\n        \\item 如果 $a  0$（向左流动），使用前向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+1}^n - u_i^n}{h}$。\n    \\end{itemize}\n\\end{itemize}\n\n将 PDE 重新排列为 $\\frac{\\partial u}{\\partial t} = \\dots$ 并代入离散近似，得到更新规则 $u_i^{n+1} = u_i^n + \\Delta t (\\dots)$。\n\n对于 $a \\ge 0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_i^n - u_{i-1}^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n对于 $a  0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_{i+1}^n - u_i^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n这些方程应用于所有内部网格点 $i \\in \\{1, 2, \\dots, N\\}$。边界值由狄利克雷条件固定：$u_0^{n+1} = u_{\\mathrm{m}}(0, t_{n+1}) = 0$ 和 $u_{N+1}^{n+1} = u_{\\mathrm{m}}(L, t_{n+1}) = 0$。\n\n### 3. 时间步长和收敛性分析\n\n时间步长 $\\Delta t$ 的选择是为了满足前向欧拉格式的显式稳定性条件：\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)\n$$\n因子 $0.4$ 是一个安全系数，确保对流和扩散的 Courant–Friedrichs–Lewy (CFL) 条件以及反应项的稳定性条件都得到满足。\n\n模拟从初始条件 $u_i^0 = u_{\\mathrm{m}}(x_i, 0)$ 开始，进行到最终时间 $T$。数值解 $u_i(T)$ 的精度由相对离散 $L^2$ 误差量化：\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}\n$$\n观测到的收敛阶数 $p$ 通过计算两种不同网格分辨率 $h_2$（$N_2=80$）和 $h_3$（$N_3=160$）的误差来估计：\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)}\n$$\n该数值格式对时间积分（前向欧拉）和对流（迎风法）采用一阶方法，对扩散采用二阶方法。总体精度受限于最低阶项，因此理论收敛率预期为 $p \\approx 1$。\n\n### 4. 实现\n\n算法使用 Python 中的 `numpy` 库实现，以进行高效的向量化操作。定义一个函数，用于为给定的一组参数 $(a, D, k)$ 和网格大小 $N$ 运行模拟。该函数初始化网格和解向量，计算稳定的时间步长，并在一个时间循环中迭代更新解。在循环内部，源项在当前时间进行评估，并根据 $a$ 的符号选择适当的迎风格式。达到最终时间 $T$ 后，该函数计算并返回相对 $L^2$ 误差。脚本的主体部分遍历四个测试套件，为 $N=80$ 和 $N=160$ 调用模拟函数，为每个套件计算收敛率 $p$，并按指定格式打印结果。",
            "answer": "$$\\boxed{[1.006, 1.018, 1.018, 1.002]}$$"
        }
    ]
}