{
    "hands_on_practices": [
        {
            "introduction": "Before solving complex reactive transport problems, it is crucial to understand the relative importance of the underlying processes. This practice guides you through non-dimensionalizing the advection-dispersion-reaction equation to derive the Péclet ($Pe$) and Damköhler ($Da$) numbers. By comparing the characteristic timescales of transport and reaction, you will gain a powerful, quantitative tool for diagnosing whether a system's behavior is limited by the rate of transport or the rate of reaction. ",
            "id": "4079741",
            "problem": "A saturated one-dimensional porous column of length $L$ conveys an aqueous solute undergoing first-order decay. The pore water velocity is uniform and equal to $v$, and the effective hydrodynamic dispersion coefficient is $D$. The volumetric reaction rate is first order with constant $k$. Assume constant porosity and no sources or sinks within the column. Starting from physically justified governing principles for mass conservation and transport in porous media, non-dimensionalize the governing advection–diffusion–reaction equation to identify the dimensionless groups that quantify the relative importance of advection, diffusion, and reaction. From these, define the Péclet number (Pe) and the Damköhler number (Da) appropriate for comparing reaction to advective transport, then compute their values for the parameters\n$v = 3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}$, $D = 2.0 \\times 10^{-9} \\ \\mathrm{m^{2}\\,s^{-1}}$, $k = 2.0 \\times 10^{-5} \\ \\mathrm{s^{-1}}$, and $L = 0.50 \\ \\mathrm{m}$. Using the computed dimensionless groups and physically motivated timescale comparisons, determine whether the system is reaction-limited or transport-limited.\n\nExpress the final numerical values for the dimensionless groups as a row matrix $\\begin{pmatrix} Pe  Da \\end{pmatrix}$, rounded to four significant figures. Both $Pe$ and $Da$ are dimensionless; do not include units in the final reported matrix.",
            "solution": "The problem is first validated by examining its components.\n\n### Step 1: Extract Givens\n- Saturated one-dimensional porous column of length $L$.\n- Uniform pore water velocity $v$.\n- Effective hydrodynamic dispersion coefficient $D$.\n- Volumetric reaction rate is first order with constant $k$.\n- Constant porosity.\n- No sources or sinks within the column (interpreted as external sources/sinks).\n- Parameter values:\n  - $v = 3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}$\n  - $D = 2.0 \\times 10^{-9} \\ \\mathrm{m^{2}\\,s^{-1}}$\n  - $k = 2.0 \\times 10^{-5} \\ \\mathrm{s^{-1}}$\n  - $L = 0.50 \\ \\mathrm{m}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a classic reactive transport scenario governed by the advection-dispersion-reaction equation (ADRE). All concepts (advection, dispersion, first-order decay) are fundamental principles in hydrology and geochemistry. The problem is scientifically sound.\n- **Well-Posed:** The problem asks for the derivation of dimensionless numbers from the governing equation, their calculation, and a physical interpretation. This is a standard and well-defined procedure in transport phenomena, leading to a unique and meaningful solution.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased technical language.\n- **Incomplete or Contradictory Setup:** The problem provides all necessary parameters ($v$, $D$, $k$, $L$) to define and compute the required dimensionless numbers. The units are consistent. The setup is complete and not contradictory for the tasks assigned. The lack of boundary conditions is not a flaw, as they are not needed for the non-dimensionalization of the partial differential equation itself.\n- **Unrealistic or Infeasible:** The numerical values for velocity, dispersion, reaction rate, and length are physically plausible for a laboratory column experiment or a small-scale field problem.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and contains sufficient information. A solution will be provided.\n\n### Solution Derivation\n\nThe governing principle for the concentration $C$ of a solute in a porous medium is the conservation of mass. For a one-dimensional system with constant porosity $\\phi$, the mass balance equation is:\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{1}{\\phi} \\frac{\\partial J_x}{\\partial x} + R_{\\text{net}}\n$$\nwhere $t$ is time, $x$ is the spatial coordinate, $J_x$ is the total mass flux in the $x$-direction, and $R_{\\text{net}}$ is the net rate of production of the solute per unit volume of fluid due to reactions.\n\nThe total flux $J_x$ is the sum of the advective flux and the dispersive flux:\n$$\nJ_x = \\phi v C - \\phi D \\frac{\\partial C}{\\partial x}\n$$\nHere, $v$ is the average linear pore water velocity and $D$ is the hydrodynamic dispersion coefficient.\n\nThe reaction is a first-order decay, so the rate of change of concentration due to reaction is $-kC$. Thus, the net rate of production per unit fluid volume is $R_{\\text{net}} = -kC$.\n\nSubstituting the expressions for flux and reaction into the mass balance equation gives:\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{1}{\\phi} \\frac{\\partial}{\\partial x} \\left( \\phi v C - \\phi D \\frac{\\partial C}{\\partial x} \\right) - kC\n$$\nAssuming $v$ and $D$ are constant, this simplifies to:\n$$\n\\frac{\\partial C}{\\partial t} = -v \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^2 C}{\\partial x^2} - kC\n$$\nThis is the one-dimensional advection-dispersion-reaction equation (ADRE). To analyze the relative importance of the transport and reaction processes, we consider the system at steady-state ($\\frac{\\partial C}{\\partial t} = 0$), which is a common approach for defining such dimensionless groups:\n$$\n0 = D \\frac{d^2 C}{d x^2} - v \\frac{d C}{d x} - k C\n$$\nThe three terms represent dispersion, advection, and reaction, respectively.\n\nTo non-dimensionalize this equation, we introduce dimensionless variables for length and concentration. Let $L$ be the characteristic length of the system (the column length) and $C_0$ be a characteristic concentration (e.g., the inlet concentration).\n$$\nx' = \\frac{x}{L} \\quad \\text{and} \\quad C' = \\frac{C}{C_0}\n$$\nThe derivatives with respect to $x$ can be rewritten using the chain rule:\n$$\n\\frac{dC}{dx} = \\frac{d(C_0 C')}{d(L x')} = \\frac{C_0}{L} \\frac{dC'}{dx'}\n$$\n$$\n\\frac{d^2 C}{dx^2} = \\frac{d}{dx} \\left( \\frac{C_0}{L} \\frac{dC'}{dx'} \\right) = \\frac{1}{L} \\frac{d}{dx'} \\left( \\frac{C_0}{L} \\frac{dC'}{dx'} \\right) = \\frac{C_0}{L^2} \\frac{d^2 C'}{dx'^2}\n$$\nSubstituting these into the steady-state ADRE:\n$$\n0 = D \\left( \\frac{C_0}{L^2} \\frac{d^2 C'}{dx'^2} \\right) - v \\left( \\frac{C_0}{L} \\frac{dC'}{dx'} \\right) - k (C_0 C')\n$$\nWe can divide by $C_0$ and rearrange the terms. To make the coefficients dimensionless, we divide the entire equation by the advective term's dimensional part, $\\frac{v}{L}$:\n$$\n0 = \\frac{D/L^2}{v/L} \\frac{d^2 C'}{dx'^2} - \\frac{v/L}{v/L} \\frac{dC'}{dx'} - \\frac{k}{v/L} C'\n$$\n$$\n0 = \\left(\\frac{D}{vL}\\right) \\frac{d^2 C'}{dx'^2} - \\frac{dC'}{dx'} - \\left(\\frac{kL}{v}\\right) C'\n$$\nThis equation reveals two dimensionless groups that quantify the relative importance of the physical processes:\n\n$1$. The Péclet number ($Pe$): This group is the coefficient of the dispersion term relative to the advection term. It is the inverse of the a coefficient we found, $\\frac{D}{vL}$.\n$$\nPe = \\frac{vL}{D}\n$$\nThe Péclet number compares the rate of transport by advection to the rate of transport by dispersion. A large $Pe$ indicates advection-dominated transport, while a small $Pe$ indicates dispersion-dominated transport.\n\n$2$. The Damköhler number ($Da$): The problem asks for the number comparing reaction to advective transport. In our dimensionless equation, this is the coefficient of the reaction term relative to the advection term.\n$$\nDa = \\frac{kL}{v}\n$$\nThis Damköhler number is the ratio of the characteristic timescale for advection ($\\tau_{adv} = L/v$) to the characteristic timescale for reaction ($\\tau_{react} = 1/k$). A large $Da$ means reaction is fast compared to advection, and a small $Da$ means reaction is slow compared to advection.\n\nNow, we compute the values of $Pe$ and $Da$ using the given parameters:\n$v = 3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}$\n$D = 2.0 \\times 10^{-9} \\ \\mathrm{m^{2}\\,s^{-1}}$\n$k = 2.0 \\times 10^{-5} \\ \\mathrm{s^{-1}}$\n$L = 0.50 \\ \\mathrm{m}$\n\n**Péclet number calculation:**\n$$\nPe = \\frac{vL}{D} = \\frac{(3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}) \\times (0.50 \\ \\mathrm{m})}{2.0 \\times 10^{-9} \\ \\mathrm{m^{2}\\,s^{-1}}} = \\frac{1.5 \\times 10^{-6}}{2.0 \\times 10^{-9}} = 750\n$$\nTo four significant figures, $Pe = 750.0$.\n\n**Damköhler number calculation:**\n$$\nDa = \\frac{kL}{v} = \\frac{(2.0 \\times 10^{-5} \\ \\mathrm{s^{-1}}) \\times (0.50 \\ \\mathrm{m})}{3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}} = \\frac{1.0 \\times 10^{-5}}{3.0 \\times 10^{-6}} = \\frac{10}{3} \\approx 3.3333...\n$$\nTo four significant figures, $Da = 3.333$.\n\nTo determine if the system is reaction-limited or transport-limited, we compare the timescales of reaction and transport.\nThe characteristic timescale for advection is $\\tau_{adv} = \\frac{L}{v} = \\frac{0.50 \\ \\mathrm{m}}{3.0 \\times 10^{-6} \\ \\mathrm{m\\,s^{-1}}} \\approx 1.67 \\times 10^{5} \\ \\mathrm{s}$.\nThe characteristic timescale for reaction is $\\tau_{react} = \\frac{1}{k} = \\frac{1}{2.0 \\times 10^{-5} \\ \\mathrm{s^{-1}}} = 5.0 \\times 10^{4} \\ \\mathrm{s}$.\nThe characteristic timescale for dispersion is $\\tau_{disp} = \\frac{L^2}{D} = \\frac{(0.50 \\ \\mathrm{m})^2}{2.0 \\times 10^{-9} \\ \\mathrm{m^{2}\\,s^{-1}}} = 1.25 \\times 10^{8} \\ \\mathrm{s}$.\n\nFirst, we identify the dominant transport mechanism by comparing $\\tau_{adv}$ and $\\tau_{disp}$. Since $\\tau_{adv} \\ll \\tau_{disp}$ (or equivalently, $Pe = \\frac{\\tau_{disp}}{\\tau_{adv}} = 750.0 \\gg 1$), transport is dominated by advection.\n\nNext, we compare the dominant transport timescale ($\\tau_{adv}$) with the reaction timescale ($\\tau_{react}$). The Damköhler number provides this comparison directly: $Da = \\frac{\\tau_{adv}}{\\tau_{react}} \\approx 3.333$.\nSince $Da > 1$, it implies that $\\tau_{adv} > \\tau_{react}$. This means the time required for a solute to be transported through the system is longer than the time it takes for the solute to react. The reaction proceeds faster than the transport can supply fresh solute. Consequently, the overall rate of solute transformation within the column is limited by the rate of transport. The system is **transport-limited**.\n\nThe final answer requires the numerical values for the dimensionless groups $Pe$ and $Da$.\n$Pe = 750.0$\n$Da = 3.333$\nThese are to be expressed as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 750.0  3.333 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While most real-world scenarios require numerical models, analytical solutions for simplified cases offer invaluable insight into system behavior. This exercise utilizes the classic analytical solution for an instantaneous solute injection to explore how a contaminant plume evolves through advection, dispersion, and first-order decay. By comparing the reactive solute to a conservative tracer, you will isolate the precise impact of the chemical reaction on the observed concentration, $C(x,t)$. ",
            "id": "4079713",
            "problem": "A one-dimensional saturated porous medium of uniform properties is considered for a non-sorbing solute undergoing first-order decay. The governing statement is mass conservation with advective and dispersive transport and a first-order sink, which can be written as the Advection-Dispersion-Reaction Equation (ADRE) for the dissolved concentration $C(x,t)$ in a homogeneous medium of porosity $\\phi$:\n$$\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - \\lambda C,$$\nwhere $v$ is the average pore-water velocity, $D$ is the hydrodynamic dispersion coefficient, and $\\lambda$ is the first-order decay constant. An instantaneous plane source injects a total of $m_{A}$ moles per unit cross-sectional area at $x=0$ at $t=0$, into a domain that is otherwise solute-free. The injection produces an initial condition consistent with the conservation of solute mass in the pore water, and the domain is infinite in $x$.\n\nUsing only the fundamental conservation principles and the ADRE, evaluate the solution $C(x,t)$ for an instantaneous plane source and use it to determine the concentration at the position $x=x^{\\ast}$ and time $t=t^{\\ast}$ for the parameter values $\\phi=0.35$, $v=1.0 \\times 10^{-5}\\ \\mathrm{m/s}$, $D=8.0 \\times 10^{-7}\\ \\mathrm{m^{2}/s}$, $\\lambda=1.2 \\times 10^{-6}\\ \\mathrm{s^{-1}}$, $m_{A}=5.0 \\times 10^{-3}\\ \\mathrm{mol/m^{2}}$, $x^{\\ast}=1.5 \\times 10^{-1}\\ \\mathrm{m}$, and $t^{\\ast}=2.0 \\times 10^{5}\\ \\mathrm{s}$.\n\nFor comparison to a conservative tracer, define the fractional attenuation at $(x^{\\ast},t^{\\ast})$ as\n$$\\mathcal{A} = \\frac{C_{\\lambda}(x^{\\ast},t^{\\ast})}{C_{\\lambda=0}(x^{\\ast},t^{\\ast})},$$\nwhere $C_{\\lambda}(x,t)$ is the concentration with the given $\\lambda$ and $C_{\\lambda=0}(x,t)$ is the concentration of an otherwise identical conservative tracer ($\\lambda=0$). Report $\\mathcal{A}$ as your final result. Round your answer to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- Governing Equation: $\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - \\lambda C$\n- System: One-dimensional, saturated porous medium, uniform properties.\n- Solute: Non-sorbing, subject to first-order decay.\n- Variables: $C(x,t)$ is the dissolved concentration.\n- Parameters and Constants:\n  - $\\phi = 0.35$ (porosity)\n  - $v = 1.0 \\times 10^{-5}\\ \\mathrm{m/s}$ (average pore-water velocity)\n  - $D = 8.0 \\times 10^{-7}\\ \\mathrm{m^{2}/s}$ (hydrodynamic dispersion coefficient)\n  - $\\lambda = 1.2 \\times 10^{-6}\\ \\mathrm{s^{-1}}$ (first-order decay constant)\n  - $m_{A} = 5.0 \\times 10^{-3}\\ \\mathrm{mol/m^{2}}$ (injected mass per unit cross-sectional area)\n- Initial and Boundary Conditions:\n  - An instantaneous plane source injects mass $m_{A}$ at $x=0$ at $t=0$.\n  - The domain is infinite ($x \\in (-\\infty, \\infty)$) and is otherwise solute-free.\n- Target Evaluation Point: $(x^{\\ast}, t^{\\ast})$, where $x^{\\ast} = 1.5 \\times 10^{-1}\\ \\mathrm{m}$ and $t^{\\ast} = 2.0 \\times 10^{5}\\ \\mathrm{s}$.\n- Quantity to be Calculated: Fractional attenuation $\\mathcal{A} = \\frac{C_{\\lambda}(x^{\\ast},t^{\\ast})}{C_{\\lambda=0}(x^{\\ast},t^{\\ast})}$, where $C_{\\lambda}$ is the concentration with decay and $C_{\\lambda=0}$ is for a conservative tracer ($\\lambda=0$).\n- Precision: The final answer must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing the standard Advection-Dispersion-Reaction Equation (ADRE), a fundamental model in hydrogeology and computational geochemistry. The initial condition, an instantaneous plane source, is a classic boundary value problem setup for this PDE, often represented by a Dirac delta function. The problem is well-posed, with a linear PDE and specified initial/boundary conditions that guarantee a unique, stable solution. The language is objective and precise. All provided numerical parameters are physically realistic for a groundwater system, and their units are dimensionally consistent within the governing equation. The problem is complete, well-structured, and verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be provided.\n\n**Derivation of the Solution**\nThe governing equation is the one-dimensional Advection-Dispersion-Reaction Equation (ADRE):\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}} - \\lambda C\n$$\nThe initial condition is an instantaneous injection of a total mass per unit area $m_A$ at $x=0$ and $t=0$. This mass is contained within the pore fluid volume. The total mass in the system per unit cross-sectional area is given by $\\int_{-\\infty}^{\\infty} \\phi C(x,t) \\, dx$. At time $t=0$, this must equal $m_A$. This conservation constraint leads to the initial condition expressed using the Dirac delta function, $\\delta(x)$:\n$$\n\\int_{-\\infty}^{\\infty} \\phi C(x,0) \\, dx = m_A \\implies C(x,0) = \\frac{m_A}{\\phi} \\delta(x)\n$$\nThe boundary conditions are $C(x,t) \\to 0$ as $|x| \\to \\infty$.\n\nThe analytical solution to this initial-boundary value problem is well-established. It can be found by applying a sequence of transformations. First, a substitution $C(x,t) = C'(x,t) \\exp(-\\lambda t)$ removes the reaction term, transforming the ADRE into the standard Advection-Dispersion Equation (ADE) for $C'$. Second, a coordinate transformation to a moving frame of reference, $\\xi = x - vt$, eliminates the advection term. The resulting equation is the one-dimensional diffusion equation, whose solution for a delta-function initial condition is a Gaussian function. Transforming back to the original variables $(x,t)$ and reintroducing the decay term yields the solution for $C(x,t)$:\n$$\nC(x,t) = \\frac{m_A}{\\phi\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x - vt)^2}{4Dt} - \\lambda t\\right)\n$$\nThis solution describes a Gaussian plume of solute that advects with velocity $v$, disperses with coefficient $D$, and whose total mass decays exponentially with rate constant $\\lambda$.\n\nThe problem requires the calculation of the fractional attenuation, $\\mathcal{A}$, defined as the ratio of the concentration of the reactive solute, $C_{\\lambda}(x,t)$, to the concentration of an identical but conservative solute, $C_{\\lambda=0}(x,t)$.\n\nFor the reactive solute with the given decay constant $\\lambda$, the concentration at the specified point $(x^{\\ast}, t^{\\ast})$ is:\n$$\nC_{\\lambda}(x^{\\ast}, t^{\\ast}) = \\frac{m_A}{\\phi\\sqrt{4\\pi D t^{\\ast}}} \\exp\\left(-\\frac{(x^{\\ast} - vt^{\\ast})^2}{4Dt^{\\ast}} - \\lambda t^{\\ast}\\right)\n$$\nFor the conservative solute, we set $\\lambda = 0$:\n$$\nC_{\\lambda=0}(x^{\\ast}, t^{\\ast}) = \\frac{m_A}{\\phi\\sqrt{4\\pi D t^{\\ast}}} \\exp\\left(-\\frac{(x^{\\ast} - vt^{\\ast})^2}{4Dt^{\\ast}}\\right)\n$$\nThe fractional attenuation $\\mathcal{A}$ is the ratio of these two expressions:\n$$\n\\mathcal{A} = \\frac{C_{\\lambda}(x^{\\ast}, t^{\\ast})}{C_{\\lambda=0}(x^{\\ast}, t^{\\ast})} = \\frac{\\frac{m_A}{\\phi\\sqrt{4\\pi D t^{\\ast}}} \\exp\\left(-\\frac{(x^{\\ast} - vt^{\\ast})^2}{4Dt^{\\ast}} - \\lambda t^{\\ast}\\right)}{\\frac{m_A}{\\phi\\sqrt{4\\pi D t^{\\ast}}} \\exp\\left(-\\frac{(x^{\\ast} - vt^{\\ast})^2}{4Dt^{\\ast}}\\right)}\n$$\nThe pre-exponential terms and the transport-related exponential terms cancel, leading to a remarkably simple result that depends only on the first-order reaction kinetics and time:\n$$\n\\mathcal{A} = \\frac{\\exp(-\\lambda t^{\\ast})}{1} = \\exp(-\\lambda t^{\\ast})\n$$\nThis result demonstrates that for a first-order decay process, the fractional reduction in concentration compared to a conservative tracer is independent of the transport parameters ($v, D$), the spatial location ($x^{\\ast}$), and the initial mass ($m_A$). It is solely a function of the decay rate and the elapsed time.\n\nNow, we substitute the given numerical values for $\\lambda$ and $t^{\\ast}$:\n- $\\lambda = 1.2 \\times 10^{-6}\\ \\mathrm{s^{-1}}$\n- $t^{\\ast} = 2.0 \\times 10^{5}\\ \\mathrm{s}$\n\nThe argument of the exponential is:\n$$\n\\lambda t^{\\ast} = (1.2 \\times 10^{-6}) \\times (2.0 \\times 10^{5}) = 2.4 \\times 10^{-1} = 0.24\n$$\nTherefore, the fractional attenuation is:\n$$\n\\mathcal{A} = \\exp(-0.24)\n$$\nCalculating the numerical value:\n$$\n\\mathcal{A} \\approx 0.78662786...\n$$\nRounding to four significant figures as required by the problem statement gives:\n$$\n\\mathcal{A} \\approx 0.7866\n$$",
            "answer": "$$\\boxed{0.7866}$$"
        },
        {
            "introduction": "Modern reactive transport modeling relies on numerically solving the governing equations, often by decoupling transport and reaction over small time steps. This computational practice challenges you to implement a foundational operator-splitting algorithm for a single control volume. You will handle a transport step, solve for instantaneous chemical equilibrium, and enforce mass conservation, gaining hands-on experience with the core engine of a reactive transport code. ",
            "id": "4079750",
            "problem": "Implement a sequential operator-splitting update for a single control volume undergoing transport followed by instantaneous aqueous complexation speciation, and enforce element-wise mass conservation across the split steps. Consider an aqueous system with three species, denoted by $A$, $B$, and $AB$, and two conserved elements, denoted by $E_A$ and $E_B$. The complexation reaction is $A + B \\rightleftharpoons AB$, with equilibrium constant $K$ (units of $\\text{L}\\,\\text{mol}^{-1}$) under the assumption of unit activity coefficients and concentrations measured in molarity. The control volume has pore volume $V_\\text{pore}$ (units of $\\text{L}$) and contains species concentrations $C_A$, $C_B$, and $C_{AB}$ (units of $\\text{mol}\\,\\text{L}^{-1}$). Over a time step $\\Delta t$ (units of $\\text{s}$), net molar rates $R_A$, $R_B$, and $R_{AB}$ (units of $\\text{mol}\\,\\text{s}^{-1}$) represent cumulative transport contributions into the control volume (positive is net influx, negative is net outflux) for each species.\n\nStarting from the fundamental law of mass conservation and the law of mass action, perform the following steps for each test case:\n- Transport update: Update species concentrations by $C_i^{n+\\frac{1}{2}} = C_i^n + \\frac{\\Delta t}{V_\\text{pore}}\\,R_i,$ for $i \\in \\{A,B,AB\\}$, with non-negativity enforced after transport, i.e., $C_i^{n+\\frac{1}{2}} \\ge 0$.\n- Element totals after transport: Compute $T_A = C_A^{n+\\frac{1}{2}} + C_{AB}^{n+\\frac{1}{2}}$ and $T_B = C_B^{n+\\frac{1}{2}} + C_{AB}^{n+\\frac{1}{2}}$.\n- Speciation step: Enforce instantaneous equilibrium via the law of mass action $C_{AB} = K\\,C_A\\,C_B,$ subject to the conservation constraints $T_A = C_A + C_{AB}$ and $T_B = C_B + C_{AB}.$ Solve for $C_A$, $C_B$, and $C_{AB}$ that satisfy both the equilibrium relation and the conservation constraints, ensuring $C_A \\ge 0$, $C_B \\ge 0$, and $C_{AB} \\ge 0$.\n- Element-wise mass conservation enforcement: Using the stoichiometric mapping from species to elements,\n$$S = \\begin{bmatrix}1  0  1\\\\ 0  1  1\\end{bmatrix},$$\nverify and, if necessary, enforce $S\\,\\mathbf{y} = \\mathbf{T}$, where $\\mathbf{y} = [C_A, C_B, C_{AB}]^\\top$ and $\\mathbf{T} = [T_A, T_B]^\\top$, by projecting the speciation solution onto the affine subspace defined by the linear conservation constraints. Use a minimum-norm correction of the form\n$$\\mathbf{y}_\\text{proj} = \\mathbf{y} + S^\\top\\,(S\\,S^\\top)^{-1}\\,(\\mathbf{T} - S\\,\\mathbf{y}),$$\nwith non-negativity gently enforced. Report the maximum absolute element residual after projection defined by\n$$\\rho = \\max\\left(\\left|T_A - (C_A + C_{AB})\\right|,\\ \\left|T_B - (C_B + C_{AB})\\right|\\right).$$\n\nAll concentrations must be expressed in $\\text{mol}\\,\\text{L}^{-1}$, times in $\\text{s}$, volumes in $\\text{L}$, and rates in $\\text{mol}\\,\\text{s}^{-1}$. For each test case, return a list $[C_A^\\text{final}, C_B^\\text{final}, C_{AB}^\\text{final}, \\rho]$ in which the concentrations are the post-speciation, post-projection values and $\\rho$ is the maximum absolute residual (units of $\\text{mol}\\,\\text{L}^{-1}$). Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one inner list per test case (e.g., $[[x_1,y_1,z_1,r_1],[x_2,y_2,z_2,r_2],\\dots]$), and no additional text.\n\nUse the following test suite of parameter values that exercise a typical case, transport perturbations, low equilibrium constant behavior, introduction of complex via transport, and an extreme equilibrium constant case:\n1. Happy path strong complexation:\n   - $C_A^0 = 0.01$, $C_B^0 = 0.02$, $C_{AB}^0 = 0.0$, $\\Delta t = 3600$, $V_\\text{pore} = 1.0$, $R_A = 0.0$, $R_B = 0.0$, $R_{AB} = 0.0$, $K = 100.0$.\n2. Transport perturbations, moderate complexation:\n   - $C_A^0 = 0.005$, $C_B^0 = 0.005$, $C_{AB}^0 = 0.005$, $\\Delta t = 100$, $V_\\text{pore} = 0.5$, $R_A = 1.0\\times 10^{-4}$, $R_B = -5.0\\times 10^{-5}$, $R_{AB} = 0.0$, $K = 10.0$.\n3. Near non-complexing behavior:\n   - $C_A^0 = 0.03$, $C_B^0 = 0.03$, $C_{AB}^0 = 0.0$, $\\Delta t = 1$, $V_\\text{pore} = 1.0$, $R_A = 0.0$, $R_B = 0.0$, $R_{AB} = 0.0$, $K = 1.0\\times 10^{-6}$.\n4. Introduction of complex via transport:\n   - $C_A^0 = 0.0$, $C_B^0 = 0.01$, $C_{AB}^0 = 0.0$, $\\Delta t = 10$, $V_\\text{pore} = 2.0$, $R_A = 0.0$, $R_B = 0.0$, $R_{AB} = 1.0\\times 10^{-4}$, $K = 0.1$.\n5. Extreme complexation with limiting reagent:\n   - $C_A^0 = 1.0\\times 10^{-8}$, $C_B^0 = 1.0\\times 10^{-2}$, $C_{AB}^0 = 0.0$, $\\Delta t = 100$, $V_\\text{pore} = 1.0$, $R_A = 0.0$, $R_B = 0.0$, $R_{AB} = 0.0$, $K = 1.0\\times 10^{12}$.\n\nYour program must implement the sequential update and projection for each test case and output the single required line as described.",
            "solution": "The user has provided a valid, well-posed problem statement from the field of computational geochemistry. The problem requires the implementation of a sequential operator-splitting (OS) scheme to solve a reactive transport problem for a single control volume. The process involves a transport step followed by a chemical speciation step, with a final projection to enforce mass conservation.\n\nThe system involves three aqueous species, $A$, $B$, and their complex $AB$, governed by the reversible reaction $A+B \\rightleftharpoons AB$. Mass is conserved for two elements, $E_A$ and $E_B$. The species-element stoichiometry is defined by the matrix $S = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix}$.\n\nThe OS algorithm proceeds in a sequence of distinct steps over a time interval $\\Delta t$.\n\n**Step 1: Transport Update**\n\nThe first step accounts for the physical transport of species into or out of the control volume. Given the initial concentrations $C_i^n$ for $i \\in \\{A, B, AB\\}$, the pore volume $V_\\text{pore}$, the time step $\\Delta t$, and the net molar transport rates $R_i$, the species concentrations are updated. The governing ordinary differential equation for transport in a well-mixed control volume is $\\frac{d(V_\\text{pore} C_i)}{dt} = R_i$. A first-order explicit Euler discretization yields:\n\n$$\n\\frac{V_\\text pore C_i^{n+1/2} - V_\\text pore C_i^n}{\\Delta t} = R_i\n$$\n\nRearranging for the intermediate concentration $C_i^{n+1/2}$ gives the transport update equation:\n\n$$\nC_i^{n+1/2} = C_i^n + \\frac{\\Delta t}{V_\\text{pore}} R_i\n$$\n\nSince concentrations cannot be negative, a non-negativity constraint is applied: $C_i^{n+1/2} = \\max(0, C_i^{n+1/2})$.\n\n**Step 2: Computation of Total Element Concentrations**\n\nAfter the transport step, the total concentrations of the conserved elements, $T_A$ and $T_B$, are calculated. These totals will be conserved during the subsequent instantaneous chemistry step. Based on the stoichiometry, where $E_A$ is in species $A$ and $AB$, and $E_B$ is in species $B$ and $AB$:\n\n$$\nT_A = C_A^{n+1/2} + C_{AB}^{n+1/2}\n$$\n$$\nT_B = C_B^{n+1/2} + C_{AB}^{n+1/2}\n$$\n\nThese values are stored in a vector $\\mathbf{T} = [T_A, T_B]^\\top$.\n\n**Step 3: Speciation (Chemical Equilibrium)**\n\nThe speciation step calculates the new equilibrium distribution of species $C_A, C_B, C_{AB}$ that satisfies the law of mass action, while honoring the total element concentrations $T_A$ and $T_B$ calculated previously. The governing equations are:\n\n1.  Mass Action: $C_{AB} = K C_A C_B$\n2.  Mass Conservation for $E_A$: $T_A = C_A + C_{AB}$\n3.  Mass Conservation for $E_B$: $T_B = C_B + C_{AB}$\n\nFrom the conservation equations, we can express $C_A$ and $C_B$ in terms of $C_{AB}$:\n$C_A = T_A - C_{AB}$\n$C_B = T_B - C_{AB}$\n\nSubstituting these into the mass action law yields a single quadratic equation for $C_{AB}$:\n\n$$\nC_{AB} = K (T_A - C_{AB})(T_B - C_{AB})\n$$\n\nExpanding and rearranging into the standard form $ax^2 + bx + c = 0$ with $x=C_{AB}$ gives:\n\n$$\nK C_{AB}^2 - (1 + K(T_A + T_B)) C_{AB} + K T_A T_B = 0\n$$\n\nThe coefficients are $a = K$, $b = -(1 + K(T_A + T_B))$, and $c = K T_A T_B$. The physically meaningful solution for $C_{AB}$ must satisfy $0 \\le C_{AB} \\le \\min(T_A, T_B)$. The standard quadratic formula for the smaller root, $x = \\frac{-b - \\sqrt{b^2 - 4ac}}{2a}$, can suffer from catastrophic cancellation (subtraction of nearly equal numbers) when $b^2 \\gg |4ac|$, which occurs for large $K$. A numerically stable approach is to first calculate the larger root $x_2$ (which is numerically stable as it involves addition) and then find the smaller, physical root $x_1$ using Vieta's formulas ($x_1 = c/(ax_2)$).\n\nThe larger root is:\n$$\nx_2 = \\frac{-b + \\sqrt{b^2-4ac}}{2a} = \\frac{1+K(T_A+T_B) + \\sqrt{(1+K(T_A+T_B))^2 - 4K^2T_A T_B}}{2K}\n$$\n\nThe physical root for $C_{AB}$ is then:\n$$\nC_{AB} = \\frac{c}{a x_2} = \\frac{K T_A T_B}{K x_2} = \\frac{T_A T_B}{x_2} = \\frac{2 K T_A T_B}{1+K(T_A+T_B) + \\sqrt{(1+K(T_A+T_B))^2 - 4K^2T_A T_B}}\n$$\n\nOnce $C_{AB}$ is found, $C_A$ and $C_B$ are calculated via $C_A = T_A - C_{AB}$ and $C_B = T_B - C_{AB}$. The resulting concentrations form the vector $\\mathbf{y} = [C_A, C_B, C_{AB}]^\\top$.\n\n**Step 4: Mass Conservation Enforcement (Projection)**\n\nDue to floating-point arithmetic, the speciation solution $\\mathbf{y}$ may not perfectly satisfy the linear conservation law, i.e., $S\\mathbf{y}$ may not be exactly equal to $\\mathbf{T}$. The problem specifies projecting $\\mathbf{y}$ onto the affine subspace defined by $S\\mathbf{y} = \\mathbf{T}$ to enforce this constraint. This is achieved by finding a correction vector $\\delta\\mathbf{y}$ that is orthogonal to the null space of $S$ (i.e., is in the range of $S^\\top$) such that $S(\\mathbf{y} + \\delta\\mathbf{y}) = \\mathbf{T}$. The formula for the projected vector $\\mathbf{y}_\\text{proj}$ is given:\n\n$$\n\\mathbf{y}_\\text{proj} = \\mathbf{y} + S^\\top(S S^\\top)^{-1}(\\mathbf{T} - S\\mathbf{y})\n$$\n\nThe matrix term $S^\\top(S S^\\top)^{-1}$ is constant for this system and can be pre-calculated:\n$S S^\\top = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$\n$(S S^\\top)^{-1} = \\frac{1}{3} \\begin{bmatrix} 2  -1 \\\\ -1  2 \\end{bmatrix}$\n$S^\\top(S S^\\top)^{-1} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\frac{1}{3} \\begin{bmatrix} 2  -1 \\\\ -1  2 \\end{bmatrix} = \\frac{1}{3} \\begin{bmatrix} 2  -1 \\\\ -1  2 \\\\ 1  1 \\end{bmatrix}$\n\nThe correction is applied to $\\mathbf{y}$. Subsequently, non-negativity is enforced on the components of $\\mathbf{y}_\\text{proj}$ by clipping any negative values to zero. Let this final vector be $\\mathbf{y}_\\text{final}$. This clipping can reintroduce a small mass balance error.\n\n**Step 5: Residual Calculation**\n\nThe final step is to quantify the mass balance error after the full process, including the final non-negativity enforcement. The maximum absolute element residual $\\rho$ is calculated as the infinity norm of the residual vector $\\mathbf{T} - S\\mathbf{y}_\\text{final}$:\n\n$$\n\\rho = \\max\\left( \\left| T_A - (C_A^\\text{final} + C_{AB}^\\text{final}) \\right|, \\left| T_B - (C_B^\\text{final} + C_{AB}^\\text{final}) \\right| \\right)\n$$\n\nThe algorithm will be applied to each test case to produce the final species concentrations and the mass balance residual.",
            "answer": "[[0.00414149377443183,0.01414149377443183,0.00585850622556817,5.551115123125783e-17],[0.02468789886311654,0.004687898863116538,0.005312101136883461,1.1102230246251565e-16],[0.029999973000008696,0.029999973000008696,2.699999130425717e-08,5.551115123125783e-17],[0.00045249378102758155,0.010452493781027581,4.750621897241845e-05,0.0],[1e-08,0.00999999,0.0,0.0]]"
        }
    ]
}