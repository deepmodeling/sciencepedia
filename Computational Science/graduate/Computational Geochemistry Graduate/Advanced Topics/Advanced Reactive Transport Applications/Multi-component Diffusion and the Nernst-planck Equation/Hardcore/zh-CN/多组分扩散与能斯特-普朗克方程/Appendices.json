{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的离子输运模型之前，理解静电相互作用的特征长度尺度至关重要。本练习将引导您从能斯特-普朗克方程和泊松方程出发，在平衡条件下推导出德拜长度 $\\lambda_D$。这个过程不仅揭示了静电屏蔽的基本物理原理，还提供了一个量化指标，用以判断在何种尺度上电中性近似这一强大的简化假设是有效的。",
            "id": "4091554",
            "problem": "一个厚度为 $L$ 的一维 (1D) 地球化学扩散池中，含有一种处于均匀温度 $T$ 和均匀介电常数 $\\epsilon$ 下的盐水溶液。该盐水是氯化钠 ($\\text{NaCl}$) 和氯化钙 ($\\text{CaCl}_2$) 的理想、完全解离的混合物，其体浓度分别为 $0.70$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 和 $0.10$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。介质的介电常数 $\\epsilon=5.93\\times 10^{-10}$ $\\mathrm{F}\\,\\mathrm{m}^{-1}$，温度 $T=333$ $\\mathrm{K}$。扩散池的厚度为 $L=100$ $\\mu\\mathrm{m}$。假设系统是等温、均匀的，并且处于平衡状态，没有净通量，并且静电势的变化足够小，可以进行线性化处理。使用下面给出的基本关系式：\n\n- 对于电解质中电荷数为 $z_i$、扩散系数为 $D_i$ 的物种 $i$，在静电势 $\\phi$ 作用下的 Nernst–Planck (NP) 方程为 $\\mathbf{J}_i=-D_i\\nabla c_i-\\dfrac{z_i D_i F}{R T}c_i\\nabla\\phi$。\n- 在介电常数为 $\\epsilon$ 的介质中，静电势的 Poisson 方程为 $\\nabla\\cdot\\left(\\epsilon\\nabla\\phi\\right)=-\\rho$，其中 $\\rho=F\\sum_i z_i c_i$ 是体电荷密度。\n- 离子强度为 $I=\\dfrac{1}{2}\\sum_i z_i^2 c_i$，其中摩尔浓度 $c_i$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n任务：\n\n1. 从 NP 方程和 Poisson 方程出发，施加所有物种 $i$ 的平衡条件 $\\mathbf{J}_i=\\mathbf{0}$，并对得到的浓度-电势关系围绕体相状态进行线性化。推导线性化的 Poisson–Boltzmann 关系式，并获得仅用 $\\epsilon$、$R$、$T$、$F$ 和离子强度 $I$ 表示的 Debye 屏蔽长度 $\\lambda_D$。\n2. 根据给定盐水的成分计算其离子强度 $I$。使用单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 的浓度 $c_i$。\n3. 使用你推导的表达式，计算在给定条件下的 Debye 屏蔽长度 $\\lambda_D$。以纳米为单位表示 $\\lambda_D$，并将答案四舍五入到四位有效数字。\n4. 通过比较 $\\lambda_D$ 和 $L$，定量评估电中性近似对于该一维扩散池是否有效。定义指示符 $\\chi$，如果 $\\lambda_D/L\\leq 10^{-2}$，则 $\\chi=1$，否则 $\\chi=0$。报告数对 $\\left(\\lambda_D\\ \\text{（纳米）},\\ \\chi\\right)$。\n\n使用 $R=8.314$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和 $F=96485$ $\\mathrm{C}\\,\\mathrm{mol}^{-1}$。对于数值报告，以 $\\mathrm{nm}$ 为单位表示 $\\lambda_D$，并四舍五入到四位有效数字。",
            "solution": "该问题经验证是自洽的、有科学依据且良定的。所有必要的数据、方程和常数均已提供。各项任务逻辑结构清晰，可根据物理化学和静电学的既定原理解答。我们将继续进行解答。\n\n该问题要求一个分为四个部分的解答，涉及 Debye 长度的推导、针对特定盐水的计算，以及对电中性假设的评估。\n\n**第 1 部分：线性化的 Poisson–Boltzmann 方程和 Debye 长度的推导**\n\n我们从离子物种 $i$ 的通量 $\\mathbf{J}_i$ 的 Nernst–Planck 方程开始：\n$$\n\\mathbf{J}_i = -D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi\n$$\n此处，$D_i$ 是扩散系数，$c_i$ 是摩尔浓度，$z_i$ 是电荷数，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\phi$ 是静电势。\n\n在平衡状态下，没有净通量，因此对于所有物种 $i$，$\\mathbf{J}_i = \\mathbf{0}$。Nernst–Planck 方程简化为：\n$$\n-D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\n假设扩散系数 $D_i$ 不为零，我们可以两边同除以 $-D_i$：\n$$\n\\nabla c_i + \\frac{z_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\n重新整理该方程可得：\n$$\n\\frac{\\nabla c_i}{c_i} = -\\frac{z_i F}{R T} \\nabla \\phi\n$$\n认识到左边是 $c_i$ 的自然对数的梯度，即 $\\nabla(\\ln c_i)$。将此表达式从体溶液中的参考状态（此处电势 $\\phi$ 定义为 $0$，浓度为 $c_{i,\\infty}$）积分到电势为 $\\phi$、浓度为 $c_i$ 的点，得到离子浓度的 Boltzmann 分布：\n$$\n\\int_{c_{i,\\infty}}^{c_i} d(\\ln c'_i) = -\\int_0^\\phi \\frac{z_i F}{R T} d\\phi' \\implies \\ln\\left(\\frac{c_i}{c_{i,\\infty}}\\right) = -\\frac{z_i F \\phi}{R T}\n$$\n$$\nc_i(\\mathbf{r}) = c_{i,\\infty} \\exp\\left(-\\frac{z_i F \\phi(\\mathbf{r})}{R T}\\right)\n$$\n问题陈述中提到，电势变化足够小，可以进行线性化。这意味着指数函数的自变量很小，即 $|\\frac{z_i F \\phi}{R T}| \\ll 1$。因此，我们可以使用一阶泰勒级数展开 $\\exp(x) \\approx 1 + x$：\n$$\nc_i \\approx c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right)\n$$\n现在，我们将这个线性化的浓度代入体电荷密度表达式 $\\rho = F \\sum_i z_i c_i$ 中：\n$$\n\\rho \\approx F \\sum_i z_i \\left[ c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right) \\right] = F \\sum_i z_i c_{i,\\infty} - F \\sum_i \\frac{z_i^2 F c_{i,\\infty} \\phi}{R T}\n$$\n第一项 $F \\sum_i z_i c_{i,\\infty}$ 代表体溶液中的净电荷密度，根据电中性原理，该值必须为零。因此，$\\sum_i z_i c_{i,\\infty} = 0$。$\\rho$ 的表达式简化为：\n$$\n\\rho \\approx - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\n接下来，我们使用均匀介电常数为 $\\epsilon$ 的均匀介质的 Poisson 方程，即 $\\nabla^2\\phi = -\\rho/\\epsilon$：\n$$\n\\nabla^2\\phi = -\\frac{1}{\\epsilon} \\left[ - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi \\right] = \\left(\\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\n这就是线性化的 Poisson–Boltzmann 方程。它可以写成 $\\nabla^2\\phi = \\kappa^2\\phi$ 的形式，其中 $\\kappa$ 是 Debye 长度的倒数，$\\kappa = \\lambda_D^{-1}$。通过比较，我们发现：\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\n$$\n离子强度 $I$ 定义为 $I = \\frac{1}{2}\\sum_i z_i^2 c_i$。在体相中，这便是 $I = \\frac{1}{2}\\sum_i z_i^2 c_{i,\\infty}$，这意味着 $\\sum_i z_i^2 c_{i,\\infty} = 2I$。将此代入我们关于 $\\lambda_D^{-2}$ 的表达式中：\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} (2I) = \\frac{2 F^2 I}{\\epsilon R T}\n$$\n解出 Debye 屏蔽长度 $\\lambda_D$，我们得到所需的表达式：\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}}\n$$\n\n**第 2 部分：离子强度的计算**\n\n盐水包含氯化钠 ($\\text{NaCl}$) 和氯化钙 ($\\text{CaCl}_2$)。存在的离子有 $\\text{Na}^+$、$\\text{Ca}^{2+}$ 和 $\\text{Cl}^-$。\n电荷数分别为 $z_{\\text{Na}^+} = +1$，$z_{\\text{Ca}^{2+}} = +2$ 和 $z_{\\text{Cl}^-} = -1$。\n体浓度以 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 为单位给出：\n- $c_{\\text{NaCl}, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\text{Na}^+, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $c_{\\text{CaCl}_2, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\text{Ca}^{2+}, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n总的氯离子浓度是两种盐中氯离子浓度之和：\n$c_{\\text{Cl}^-, \\infty} = c_{\\text{Cl}^- \\text{ from NaCl}} + c_{\\text{Cl}^- \\text{ from CaCl}_2} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} + 2 \\times 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 0.90 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n\n离子强度 $I$ 的公式要求浓度使用国际单位制单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。转换关系为 $1 \\, \\mathrm{L} = 10^{-3} \\, \\mathrm{m}^3$，因此 $1 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- $c_{\\text{Na}^+, \\infty} = 0.70 \\times 1000 = 700 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\text{Ca}^{2+}, \\infty} = 0.10 \\times 1000 = 100 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\text{Cl}^-, \\infty} = 0.90 \\times 1000 = 900 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\n现在我们可以计算离子强度 $I$：\n$$\nI = \\frac{1}{2} \\sum_i z_i^2 c_{i,\\infty} = \\frac{1}{2} \\left(z_{\\text{Na}^+}^2 c_{\\text{Na}^+, \\infty} + z_{\\text{Ca}^{2+}}^2 c_{\\text{Ca}^{2+}, \\infty} + z_{\\text{Cl}^-}^2 c_{\\text{Cl}^-, \\infty}\\right)\n$$\n$$\nI = \\frac{1}{2} \\left[ (1)^2(700) + (2)^2(100) + (-1)^2(900) \\right] \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n$$\nI = \\frac{1}{2} (700 + 400 + 900) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = \\frac{1}{2} (2000) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**第 3 部分：Debye 屏蔽长度的计算**\n\n我们使用推导出的 $\\lambda_D$ 公式以及给定的国际单位制数值：\n- $\\epsilon = 5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}$\n- $R = 8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 333 \\, \\mathrm{K}$\n- $F = 96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $I = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}} = \\sqrt{\\frac{(5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}) (8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) (333 \\, \\mathrm{K})}{2 (96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1})^2 (1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3})}}\n$$\n$$\n\\lambda_D = \\sqrt{\\frac{1.64257146 \\times 10^{-6}}{1.861864505 \\times 10^{13}}} \\, \\mathrm{m} = \\sqrt{8.82218 \\times 10^{-20}} \\, \\mathrm{m} \\approx 2.970215 \\times 10^{-10} \\, \\mathrm{m}\n$$\n结果需要以纳米 ($\\mathrm{nm}$) 表示，其中 $1 \\, \\mathrm{nm} = 10^{-9} \\, \\mathrm{m}$：\n$$\n\\lambda_D = (2.970215 \\times 10^{-10} \\, \\mathrm{m}) \\times \\left(\\frac{1 \\, \\mathrm{nm}}{10^{-9} \\, \\mathrm{m}}\\right) = 0.2970215 \\, \\mathrm{nm}\n$$\n四舍五入到四位有效数字，我们得到 $\\lambda_D = 0.2970 \\, \\mathrm{nm}$。\n\n**第 4 部分：电中性近似的评估**\n\n通过将 Debye 长度 $\\lambda_D$ 与系统的特征长度 $L$ 进行比较，来评估电中性近似的有效性。如果显著的电荷分离仅发生在远小于系统尺寸的边界层中，即 $\\lambda_D \\ll L$，则该近似有效。\n问题通过指示符 $\\chi$ 提供了一个定量标准：如果 $\\lambda_D/L \\le 10^{-2}$，则 $\\chi=1$，否则 $\\chi=0$。\n\n我们有：\n- $\\lambda_D = 2.970 \\times 10^{-10} \\, \\mathrm{m}$\n- $L = 100 \\, \\mu\\mathrm{m} = 100 \\times 10^{-6} \\, \\mathrm{m} = 1 \\times 10^{-4} \\, \\mathrm{m}$\n\n该比值为：\n$$\n\\frac{\\lambda_D}{L} = \\frac{2.970 \\times 10^{-10} \\, \\mathrm{m}}{1 \\times 10^{-4} \\, \\mathrm{m}} = 2.970 \\times 10^{-6}\n$$\n我们将此比值与阈值 $10^{-2}$ 进行比较：\n$$\n2.970 \\times 10^{-6} \\le 10^{-2}\n$$\n这个不等式显然成立。因此，$\\chi=1$ 的条件得到满足。\n对于该系统，电中性近似非常有效，因为电荷不平衡的长度尺度 ($\\approx 0.3 \\, \\mathrm{nm}$) 比系统厚度 ($100,000 \\, \\mathrm{nm}$) 小了几个数量级。\n\n最终结果是数对 $(\\lambda_D \\text{（纳米）}, \\chi)$。\n- $\\lambda_D = 0.2970$\n- $\\chi = 1$\n报告的数对是 $(0.2970, 1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2970  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在电解质溶液中，由于静电耦合，离子的扩散并非相互独立。本练习旨在探索如何对简单二元盐的耦合输运过程进行建模，并引出“双极扩散系数”这一重要概念。通过该练习，您将理解单个离子的性质如何组合起来，形成描述整个盐体系输运的有效性质，这是多组分扩散中的一个经典范例。",
            "id": "4091521",
            "problem": "一个地球化学孔隙水柱含有一种稀二元电解质，其阳离子化合价为 $z_{+} = +2$，阴离子化合价为 $z_{-} = -1$，代表一种 $2{:}1$ 型电解质（例如，氯化钙）。考虑在没有流体平流和外部电场驱动情况下的一维等温扩散。假设理想溶液行为（活度系数等于1）、局部电中性，并且扩散电迁移由 Nernst–Planck 通量定律以及离子迁移率和扩散系数之间的 Einstein 关系式来描述。在水中，阳离子的分子扩散系数（国际单位制，SI）为 $D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$，阴离子的分子扩散系数为 $D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$。盐的化学计量系数为 $\\nu_{+} = 1$ 和 $\\nu_{-} = 2$，盐的电中性意味着 $z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$。\n\n严格地从适用于此情景的基本输运平衡方程（即每种离子的 Nernst–Planck 通量定律、迁移率与扩散率之间的 Einstein 关系式、局部电中性以及零电流条件）出发，推导 $2{:}1$ 型电解质的有效双极（盐）扩散系数 $D_{\\mathrm{amb}}$，用 $D_{+}$、$D_{-}$、$z_{+}$、$z_{-}$、$\\nu_{+}$ 和 $\\nu_{-}$ 表示。然后，使用相同的推导框架，求出具有相同 $D_{+}$ 和 $D_{-}$ 的 $1{:}1$ 型电解质（即 $z_{+} = +1$, $z_{-} = -1$, $\\nu_{+} = \\nu_{-} = 1$）的双极扩散系数。\n\n报告无量纲比值\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}}$$\n作为你的最终结果。\n将你报告的 $R$ 值四舍五入至四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "该问题是有效的。这是一个计算地球化学和物理化学领域中的良态问题，基于已确立的科学原理。所有必要信息均已提供，且条件内部一致。我们将开始推导。\n\n在无平流情况下，控制二元电解质一维等温扩散的基本原理是：每种离子的 Nernst-Planck 通量定律、净电流为零的条件以及局部电中性约束。\n\n离子种类 $i$ 的通量 $J_i$ 的 Nernst-Planck 方程由下式给出：\n$$J_i = -D_i \\frac{dC_i}{dx} - \\frac{z_i F}{RT} D_i C_i \\frac{d\\phi}{dx}$$\n其中 $D_i$ 是分子扩散系数，$C_i$ 是摩尔浓度，$z_i$ 是化合价，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$\\phi$ 是电势。项 $\\frac{d\\phi}{dx}$ 代表由阳离子和阴离子的扩散速率差异产生的内电场。\n\n对于二元电解质，我们有两个通量方程，一个用于阳离子 ($+$)，一个用于阴离子 ($-$):\n$$J_{+} = -D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}$$\n$$J_{-} = -D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}$$\n\n在没有外部电路的情况下，净电流必须为零：\n$$I = F \\sum_{i} z_i J_i = F(z_{+}J_{+} + z_{-}J_{-}) = 0$$\n这可以简化为 $z_{+}J_{+} + z_{-}J_{-} = 0$。\n\n每种离子浓度 $C_+$ 和 $C_-$ 通过化学计量系数 $\\nu_+$ 和 $\\nu_-$ 与盐的摩尔浓度 $C$ 相关：\n$$C_{+} = \\nu_{+} C \\quad \\text{和} \\quad C_{-} = \\nu_{-} C$$\n因此，空间梯度之间的关系为：\n$$\\frac{dC_{+}}{dx} = \\nu_{+} \\frac{dC}{dx} \\quad \\text{和} \\quad \\frac{dC_{-}}{dx} = \\nu_{-} \\frac{dC}{dx}$$\n整体溶液的局部电中性表示为 $\\sum_i z_i C_i = 0$，即 $z_{+}C_{+} + z_{-}C_{-} = 0$。使用盐浓度，这变为 $C(z_{+}\\nu_{+} + z_{-}\\nu_{-}) = 0$。由于 $C \\neq 0$，我们得到盐本身的电中性条件：$z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$。\n\n现在我们可以将 Nernst-Planck 通量方程代入零电流条件中：\n$$z_{+}\\left(-D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}\\right) + z_{-}\\left(-D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}\\right) = 0$$\n使用浓度梯度和离子浓度与盐浓度 $C$ 的关系式：\n$$-z_{+}D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+}^2 F}{RT} D_{+}\\nu_{+}C\\frac{d\\phi}{dx} - z_{-}D_{-}\\nu_{-}\\frac{dC}{dx} - \\frac{z_{-}^2 F}{RT} D_{-}\\nu_{-}C\\frac{d\\phi}{dx} = 0$$\n我们可以重排这个方程来解出感生电场梯度 $\\frac{d\\phi}{dx}$：\n$$-\\left(z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}\\right)\\frac{dC}{dx} = \\frac{F C}{RT}\\left(z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}\\right)\\frac{d\\phi}{dx}$$\n$$\\frac{d\\phi}{dx} = -\\frac{RT}{F C} \\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}} \\frac{dC}{dx}$$\n\n盐通量 $J_{\\text{salt}}$ 与单个离子通量通过 $J_{+} = \\nu_{+} J_{\\text{salt}}$ 和 $J_{-} = \\nu_{-} J_{\\text{salt}}$ 相关。盐的总体输运遵循 Fick 第一定律，其有效双极扩散系数为 $D_{\\mathrm{amb}}$：\n$$J_{\\text{salt}} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$$\n我们可以通过将 $\\frac{d\\phi}{dx}$ 的表达式代回其中一种离子（例如阳离子）的通量方程来确定 $D_{\\mathrm{amb}}$。使用 $z_+\\nu_+ = -z_-\\nu_-$ 的电中性条件来简化 $\\frac{d\\phi}{dx}$ 的表达式：\n$z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-} = z_{+}D_{+}\\nu_{+} + z_{-}D_{-}(-\\frac{z_+\\nu_+}{z_-}) = z_{+}\\nu_{+}(D_{+}-D_{-})$\n$z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-} = z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}(-\\frac{z_+\\nu_+}{z_-}) = z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})$\n代入这些，得到：\n$$\\frac{d\\phi}{dx} = -\\frac{RT}{F C} \\frac{z_{+}\\nu_{+}(D_{+}-D_{-})}{z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})} \\frac{dC}{dx} = -\\frac{RT}{F C} \\frac{D_{+}-D_{-}}{z_{+}D_{+} - z_{-}D_{-}} \\frac{dC}{dx}$$\n现在将这个简化形式代回 $J_+$ 的方程中：\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+} F}{RT} D_{+}\\nu_{+}C \\left(-\\frac{RT}{F C} \\frac{D_{+}-D_{-}}{z_{+}D_{+} - z_{-}D_{-}} \\frac{dC}{dx}\\right)$$\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} - z_{+}D_{+}\\nu_{+} \\frac{D_{+}-D_{-}}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} \\frac{(z_{+}D_{+} - z_{-}D_{-}) - z_{+}(D_{+}-D_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} \\frac{z_{+}D_{+} - z_{-}D_{-} - z_{+}D_{+} + z_{+}D_{-}}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} \\frac{-z_{-}D_{-} + z_{+}D_{-}}{z_{+}D_{+} - z_{-}D_{-}}\\right) = -\\frac{dC}{dx} \\left(\\frac{\\nu_{+}D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\n根据 $J_{\\text{salt}} = J_{+}/\\nu_{+}$，我们有：\n$$J_{\\text{salt}} = -\\frac{dC}{dx} \\left(\\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\n与 $J_{\\text{salt}} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$ 比较，我们推导出双极扩散系数，即 Nernst-Hartley 方程：\n$$D_{\\mathrm{amb}} = \\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}$$\n这个表达式正确地表明 $D_{\\mathrm{amb}}$ 取决于 $D_{+}$、$D_{-}$、$z_{+}$ 和 $z_{-}$。化学计量系数 $\\nu_{+}$ 和 $\\nu_{-}$ 没有在最终形式中显式出现，因为它们的影响已通过电中性条件被包含在内。\n\n现在，我们将这个通用公式应用于两种情况。\n\n情况1：$2{:}1$ 型电解质\n给定：$z_{+} = +2$, $z_{-} = -1$。\n$$D_{\\mathrm{amb}}^{(2{:}1)} = \\frac{D_{+}D_{-}((2) - (-1))}{(2)D_{+} - (-1)D_{-}} = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}$$\n\n情况2：$1{:}1$ 型电解质\n给定：$z_{+} = +1$, $z_{-} = -1$。\n$$D_{\\mathrm{amb}}^{(1{:}1)} = \\frac{D_{+}D_{-}((1) - (-1))}{(1)D_{+} - (-1)D_{-}} = \\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}$$\n\n问题要求的是无量纲比值 $R$：\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}} = \\frac{\\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}}{\\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}}$$\n$$R = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}} \\cdot \\frac{D_{+} + D_{-}}{2 D_{+}D_{-}} = \\frac{3(D_{+} + D_{-})}{2(2 D_{+} + D_{-})}$$\n\n现在，我们代入给定的扩散系数值：\n$D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$\n$D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$\n单位是一致的，在比值中它们会相消。\n$$R = \\frac{3(7.9 \\times 10^{-10} + 2.03 \\times 10^{-9})}{2(2(7.9 \\times 10^{-10}) + 2.03 \\times 10^{-9})}$$\n为简化计算，我们将 $D_{-}$ 写成 $20.3 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$。\n$$R = \\frac{3(7.9 \\times 10^{-10} + 20.3 \\times 10^{-10})}{2(2(7.9 \\times 10^{-10}) + 20.3 \\times 10^{-10})}$$\n因子 $10^{-10}$ 被消去：\n$$R = \\frac{3(7.9 + 20.3)}{2(2 \\times 7.9 + 20.3)} = \\frac{3(28.2)}{2(15.8 + 20.3)} = \\frac{84.6}{2(36.1)} = \\frac{84.6}{72.2}$$\n$$R \\approx 1.17174515235...$$\n按要求四舍五入到四位有效数字：\n$$R \\approx 1.172$$",
            "answer": "$$\\boxed{1.172}$$"
        },
        {
            "introduction": "本练习是一项综合性实践，它将理论与实际计算紧密结合，是前面概念的应用顶石。这项挑战性的任务要求您为一个复杂的多物种地球化学系统建立数值模型。您需要将能斯特-普朗克方程应用于多个相互作用的物种，同时强制执行关键的化学约束（如水的电离平衡和电中性），以最终计算出总碱度的输运通量。",
            "id": "4091565",
            "problem": "您的任务是实现一个单一、完整的程序，用于在计算地球化学的一组预定义测试案例中，计算一维孔隙水柱中总碱度的扩散-迁移通量。您的实现必须从基本原理出发，明确地强制执行电荷平衡和水质量平衡，并使用离子输运的标准公式。下文指定的物理和数值必须完全按照给定的方式使用。\n\n物理情景考虑一个长度为 $L$ 的一维区域，该区域存在一个外部施加的均匀电场 $E$（单位为国际单位制 (SI) 的伏特/米），以及左右边界之间多种离子种类的浓度梯度。您必须将输运视为纯粹的扩散和迁移输运（无平流）。目标量是总碱度的通量，其操作性定义为物种通量的线性泛函。\n\n基本和核心定义：\n- 物种 $i$ 的质量守恒定律确立了其一维通量 $J_i$ 取决于梯度和驱动力。\n- Fick 第一定律给出了扩散贡献 $-D_i \\,\\partial C_i/\\partial x$，其中 $D_i$ 是有效扩散系数，$C_i$ 是浓度。\n- 电迁移贡献源于电荷在电场中的运动。对于电荷数为 $z_i$ 的离子 $i$，Nernst-Einstein 关系将迁移率与扩散联系起来，使得迁移通量可以用法拉第常数 $F$、气体常数 $R$ 和温度 $T$ 来表示。\n- 综合这些，物种 $i$ 的一维通量的 Nernst–Planck 方程 (NPE) 表示为：\n$$\nJ_i = -D_i \\frac{\\partial C_i}{\\partial x} + z_i D_i \\frac{F}{RT} C_i E\n$$\n其中 $E$ 是电场（在 $+x$ 方向为正）。对于长度为 $L$ 的有限区间上的数值计算，使用有限差分近似 $\\partial C_i/\\partial x$，并使用左右边界值的算术平均值近似 $C_i$。\n\n电荷和水质量平衡的强制执行：\n- 在每个边界，强制执行水的自电离平衡：$[\\text{H}^+][\\text{OH}^-] = K_w$，其中 $K_w$ 以 SI 单位指定。\n- 在每个边界，强制执行电中性：$\\sum_i z_i \\, C_i = 0$，其中总和包括所有存在的离子种类。为了在保持非水物种浓度固定的同时强制执行水平衡和电中性，将 $[\\text{OH}^-] = K_w/[\\text{H}^+]$ 代入电中性方程，求解 $[\\text{H}^+]$ 作为所得二次方程的正根：\n$$\n[\\text{H}^+]^2 + S [\\text{H}^+] - K_w = 0\n$$\n其中 $S$ 是不包括 $[\\text{H}^+]$ 和 $[\\text{OH}^-]$ 的固定电荷总和，由 $S = \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i \\, C_i$ 给出。然后设置 $[\\text{OH}^-] = K_w/[\\text{H}^+]$。\n\n总碱度和目标通量的定义：\n- 考虑物种集合 $\\{\\text{H}^+, \\text{OH}^-, \\text{Na}^+, \\text{Cl}^-, \\text{HCO}_3^-, \\text{CO}_3^{2-}\\}$，其电荷数 $z_i$ 如下文指定。\n- 此处的总碱度 $A_T$ 定义为线性组合\n$$\nA_T = [\\text{HCO}_3^-] + 2[\\text{CO}_3^{2-}] + [\\text{OH}^-] - [\\text{H}^+]\n$$\n总碱度的通量为\n$$\nJ_{A_T} = J_{\\text{HCO}_3^-} + 2J_{\\text{CO}_3^{2-}} + J_{\\text{OH}^-} - J_{\\text{H}^+}\n$$\n所有通量都必须以 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示。\n\n常量和参数（请精确使用这些值）：\n- 气体常数 $R = 8.314462618\\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n- 法拉第常数 $F = 96485.33212\\;\\text{C}\\,\\text{mol}^{-1}$。\n- 温度 $T = 298.15\\;\\text{K}$。\n- 水柱长度 $L = 0.01\\;\\text{m}$。\n- 水的自电离常数（SI单位） $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$。\n\n物种属性（请精确使用这些值）：\n- $\\text{H}^+$: $z_{\\text{H}^+} = +1$, $D_{\\text{H}^+} = 9.31\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $\\text{OH}^-$: $z_{\\text{OH}^-} = -1$, $D_{\\text{OH}^-} = 5.27\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $\\text{Na}^+$: $z_{\\text{Na}^+} = +1$, $D_{\\text{Na}^+} = 1.33\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $\\text{Cl}^-$: $z_{\\text{Cl}^-} = -1$, $D_{\\text{Cl}^-} = 2.03\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $\\text{HCO}_3^-$: $z_{\\text{HCO}_3^-} = -1$, $D_{\\text{HCO}_3^-} = 1.18\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $\\text{CO}_3^{2-}$: $z_{\\text{CO}_3^{2-}} = -2$, $D_{\\text{CO}_3^{2-}} = 9.2\\times 10^{-10}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n\n浓度和场的单位：\n- 所有边界浓度必须以 $\\text{mol}\\,\\text{m}^{-3}$ 为单位处理。\n- 电场值 $E$ 的单位为 $\\text{V}\\,\\text{m}^{-1}$。\n\n数值近似规则：\n- 对迁移项使用算术平均浓度 $C_i^{\\text{avg}} = \\left(C_i^{\\text{left}} + C_i^{\\text{right}}\\right)/2$。\n- 对扩散项使用有限差分 $\\partial C_i/\\partial x \\approx \\left(C_i^{\\text{right}} - C_i^{\\text{left}}\\right)/L$。\n\n测试套件和输入：\n对于下面的每个测试案例，指定了左边界和右边界的浓度。初始的 $[\\text{H}^+]$ 和 $[\\text{OH}^-]$ 值可能不满足电中性；您的程序必须在计算通量之前，在两个边界上强制执行电中性和水平衡。所有浓度单位均为 $\\text{mol}\\,\\text{m}^{-3}$。\n\n- 测试案例 1（中等碱度梯度，非零电场）：\n    - 电场 $E = 50$。\n    - 左边界：$[\\text{Na}^+] = 2.90099$, $[\\text{Cl}^-] = 0.5$, $[\\text{HCO}_3^-] = 2.0$, $[\\text{CO}_3^{2-}] = 0.2$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-3}$。\n    - 右边界：$[\\text{Na}^+] = 2.6$, $[\\text{Cl}^-] = 0.5$, $[\\text{HCO}_3^-] = 1.8$, $[\\text{CO}_3^{2-}] = 0.15$, 初始 $[\\text{H}^+] = 1.2589\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 7.9433\\times 10^{-4}$。\n\n- 测试案例 2（纯扩散，反向梯度）：\n    - 电场 $E = 0$。\n    - 左边界：$[\\text{Na}^+] = 2.6$, $[\\text{Cl}^-] = 0.5$, $[\\text{HCO}_3^-] = 1.8$, $[\\text{CO}_3^{2-}] = 0.15$, 初始 $[\\text{H}^+] = 1.2589\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 7.9433\\times 10^{-4}$。\n    - 右边界：$[\\text{Na}^+] = 2.90099$, $[\\text{Cl}^-] = 0.5$, $[\\text{HCO}_3^-] = 2.0$, $[\\text{CO}_3^{2-}] = 0.2$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-3}$。\n\n- 测试案例 3（均匀组分，仅迁移输运）：\n    - 电场 $E = -100$。\n    - 左边界：$[\\text{Na}^+] = 0.6$, $[\\text{Cl}^-] = 0.6$, $[\\text{HCO}_3^-] = 0.1$, $[\\text{CO}_3^{2-}] = 0.01$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-3}$。\n    - 右边界：$[\\text{Na}^+] = 0.6$, $[\\text{Cl}^-] = 0.6$, $[\\text{HCO}_3^-] = 0.1$, $[\\text{CO}_3^{2-}] = 0.01$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-5}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-3}$。\n\n- 测试案例 4（低碳酸盐，强电场，相反的 NaCl 梯度）：\n    - 电场 $E = 200$。\n    - 左边界：$[\\text{Na}^+] = 0.2$, $[\\text{Cl}^-] = 0.25$, $[\\text{HCO}_3^-] = 0.02$, $[\\text{CO}_3^{2-}] = 0.002$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-4}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-4}$。\n    - 右边界：$[\\text{Na}^+] = 0.25$, $[\\text{Cl}^-] = 0.2$, $[\\text{HCO}_3^-] = 0.02$, $[\\text{CO}_3^{2-}] = 0.0015$, 初始 $[\\text{H}^+] = 1.0\\times 10^{-4}$, 初始 $[\\text{OH}^-] = 1.0\\times 10^{-4}$。\n\n程序要求：\n- 按照所述，在每个边界强制执行电中性和水平衡，同时保持非水物种浓度不变。\n- 使用 Nernst–Planck 方程以及有限差分和算术平均近似法计算每个物种的通量 $J_i$。\n- 对于每个测试案例，按照指定的物种通量的线性组合计算总碱度通量 $J_{A_T}$。\n- 将每个 $J_{A_T}$ 以 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示为浮点数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表（例如，`[result_1,result_2,result_3,result_4]`），其中每个 $result_k$ 是为测试案例 $k$ 计算出的 $J_{A_T}$，单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。",
            "solution": "该问题要求计算在一维孔隙水柱中，受浓度梯度和外部施加电场影响下的总碱度通量。解决方案需要一个基于离子输运、化学平衡和电荷平衡原理的多步骤过程。该问题是适定的、科学上合理的，并为唯一解提供了所有必要信息。\n\n控制每种离子 $i$ 输运的基本方程是 Nernst-Planck 方程 (NPE)，它将总通量 $J_i$ 描述为由浓度梯度驱动的扩散分量和由电场驱动的迁移分量之和：\n$$\nJ_i = -D_i \\frac{\\partial C_i}{\\partial x} + z_i D_i \\frac{F}{RT} C_i E\n$$\n此处，$D_i$ 是有效扩散系数，$C_i$ 是浓度，$z_i$ 是电荷数，$x$ 是空间坐标，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度，$E$ 是均匀电场的大小。\n\n计算过程分为三个主要阶段：\n$1$. 边界条件的强制执行，\n$2$. 各物种通量的计算，\n$3$. 总碱度通量的计算。\n\n**$1$. 边界条件的强制执行**\n物种 $\\text{Na}^+$、$\\text{Cl}^-$、$\\text{HCO}_3^-$ 和 $\\text{CO}_3^{2-}$ 的边界浓度是给定的。然而，必须在每个边界（左边界 $x=0$ 和右边界 $x=L$）重新计算 $\\text{H}^+$ 和 $\\text{OH}^-$ 的浓度，以同时满足两个基本约束：水的自电离平衡和电中性。\n\n水的自电离平衡由下式给出：\n$$\n[\\text{H}^+][\\text{OH}^-] = K_w\n$$\n其中 $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$。\n\n电中性条件要求净电荷密度为零：\n$$\n\\sum_i z_i \\, C_i = 0\n$$\n总和涵盖所有六个物种：$\\{\\text{H}^+, \\text{OH}^-, \\text{Na}^+, \\text{Cl}^-, \\text{HCO}_3^-, \\text{CO}_3^{2-}\\}$。\n我们可以分离出 $\\text{H}^+$ 和 $\\text{OH}^-$ 的贡献：\n$$\n(z_{\\text{H}^+}[\\text{H}^+] + z_{\\text{OH}^-}[\\text{OH}^-]) + \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i \\, C_i = 0\n$$\n令 $S = \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i \\, C_i$ 为固定浓度物种的电荷总和。将 $z_{\\text{H}^+} = +1$，$z_{\\text{OH}^-} = -1$ 和 $[\\text{OH}^-] = K_w/[\\text{H}^+]$ 代入电中性方程，得到：\n$$\n[\\text{H}^+] - \\frac{K_w}{[\\text{H}^+]} + S = 0\n$$\n两边乘以 $[\\text{H}^+]$，得到所需的关于 $[\\text{H}^+]$ 的二次方程：\n$$\n[\\text{H}^+]^2 + S [\\text{H}^+] - K_w = 0\n$$\n使用二次公式求解此方程以得到 $[\\text{H}^+]$。由于浓度必须是正实数，我们取正根：\n$$\n[\\text{H}^+] = \\frac{-S + \\sqrt{S^2 + 4K_w}}{2}\n$$\n一旦求得给定边界的校正后 $[\\text{H}^+]$，相应的 $[\\text{OH}^-]$ 就由水平衡决定：$[\\text{OH}^-] = K_w/[\\text{H}^+]$。此过程独立应用于每个测试案例的左、右边界浓度集，从而为所有六个物种生成一套自洽的边界条件。\n\n**$2$. 各物种通量的计算**\n有了每个物种 $i$ 的平衡边界浓度 $C_i^{\\text{left}}$ 和 $C_i^{\\text{right}}$，就可以使用 Nernst-Planck 方程的离散形式计算跨越长度为 $L$ 的区域的通量 $J_i$。问题指定对浓度梯度使用一阶有限差分，对迁移项中的浓度使用算术平均值：\n$$\n\\frac{\\partial C_i}{\\partial x} \\approx \\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L} \n\\quad \\text{和} \\quad\nC_i \\approx \\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\n$$\n将这些近似值代入 NPE，得到每个物种通量的计算公式：\n$$\nJ_i = -D_i \\left(\\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L}\\right) + z_i D_i \\frac{F}{RT} \\left(\\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\\right) E\n$$\n使用每个物种的特定属性（$D_i, z_i$）和系统参数（$L, T, E, F, R$）对所有六个物种执行此计算。\n\n**$3$. 总碱度通量的计算**\n总碱度 $A_T$ 是一个通过物种浓度的线性组合定义的操作性定义的量。问题将其定义为：\n$$\nA_T = [\\text{HCO}_3^-] + 2[\\text{CO}_3^{2-}] + [\\text{OH}^-] - [\\text{H}^+]\n$$\n相应地，总碱度的通量 $J_{A_T}$ 定义为各个物种通量的相同线性组合：\n$$\nJ_{A_T} = J_{\\text{HCO}_3^-} + 2J_{\\text{CO}_3^{2-}} + J_{\\text{OH}^-} - J_{\\text{H}^+}\n$$\n如上一步所述计算出相关物种的各个通量 $J_i$ 后，根据该公式将它们组合起来，以得出每个测试案例的最终目标量。所有计算均保持 SI 单位，最终得到的通量 $J_{A_T}$ 单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diffusive-migrative flux of total alkalinity in a one-dimensional\n    porewater column for a set of predefined test cases.\n    \"\"\"\n\n    # --- Constants and Parameters ---\n    R = 8.314462618  # Gas constant (J/mol/K)\n    F = 96485.33212  # Faraday constant (C/mol)\n    T = 298.15        # Temperature (K)\n    L = 0.01          # Column length (m)\n    KW = 1.0e-8       # Water autoionization constant (mol^2/m^6)\n\n    # Pre-calculate the F/(RT) term for efficiency\n    F_RT = F / (R * T)\n\n    # --- Species Properties ---\n    # Structure: {name: {'z': charge_number, 'D': diffusion_coeff_m2_s-1}}\n    SPECIES_PROPS = {\n        'H+':       {'z':  1, 'D': 9.31e-9},\n        'OH-':      {'z': -1, 'D': 5.27e-9},\n        'Na+':      {'z':  1, 'D': 1.33e-9},\n        'Cl-':      {'z': -1, 'D': 2.03e-9},\n        'HCO3-':    {'z': -1, 'D': 1.18e-9},\n        'CO3--':    {'z': -2, 'D': 9.20e-10}\n    }\n    \n    # List of species excluding H+ and OH- for S calculation\n    FIXED_SPECIES = ['Na+', 'Cl-', 'HCO3-', 'CO3--']\n\n    def enforce_neutrality(concentrations):\n        \"\"\"\n        Adjusts H+ and OH- concentrations to enforce electroneutrality and\n        water equilibrium.\n\n        Args:\n            concentrations (dict): A dictionary of species concentrations {species_name: value}.\n\n        Returns:\n            dict: An updated dictionary with equilibrated H+ and OH- concentrations.\n        \"\"\"\n        # Calculate S, the fixed charge sum\n        S = sum(\n            SPECIES_PROPS[sp]['z'] * concentrations[sp] for sp in FIXED_SPECIES\n        )\n\n        # Solve the quadratic equation for [H+]: [H+]^2 + S*[H+] - Kw = 0\n        # Using the positive root of the quadratic formula: (-b + sqrt(b^2 - 4ac)) / 2a\n        c_h_plus = (-S + np.sqrt(S**2 + 4 * KW)) / 2.0\n\n        # Calculate [OH-] from water equilibrium\n        c_oh_minus = KW / c_h_plus\n\n        equilibrated_concs = concentrations.copy()\n        equilibrated_concs['H+'] = c_h_plus\n        equilibrated_concs['OH-'] = c_oh_minus\n        \n        return equilibrated_concs\n\n    def calculate_flux(species_name, c_left, c_right, E):\n        \"\"\"\n        Calculates the flux of a single species using the Nernst-Planck equation.\n\n        Args:\n            species_name (str): The name of the species.\n            c_left (float): Concentration at the left boundary (mol/m^3).\n            c_right (float): Concentration at the right boundary (mol/m^3).\n            E (float): Electric field (V/m).\n\n        Returns:\n            float: The calculated flux in mol/m^2/s.\n        \"\"\"\n        props = SPECIES_PROPS[species_name]\n        z = props['z']\n        D = props['D']\n\n        # Diffusive flux component\n        flux_diff = -D * (c_right - c_left) / L\n\n        # Migrative flux component\n        c_avg = (c_left + c_right) / 2.0\n        flux_mig = z * D * F_RT * c_avg * E\n\n        return flux_diff + flux_mig\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"E\": 50.0,\n            \"left\":  {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3--': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3--': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4}\n        },\n        {\n            \"E\": 0.0,\n            \"left\":  {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3--': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4},\n            \"right\": {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3--': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": -100.0,\n            \"left\":  {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3--': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3--': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": 200.0,\n            \"left\":  {'Na+': 0.2,  'Cl-': 0.25, 'HCO3-': 0.02, 'CO3--': 0.002,  'H+': 1.0e-4, 'OH-': 1.0e-4},\n            \"right\": {'Na+': 0.25, 'Cl-': 0.2,  'HCO3-': 0.02, 'CO3--': 0.0015, 'H+': 1.0e-4, 'OH-': 1.0e-4}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E_field = case[\"E\"]\n\n        # Enforce electroneutrality at both boundaries\n        c_left_equilibrated = enforce_neutrality(case[\"left\"])\n        c_right_equilibrated = enforce_neutrality(case[\"right\"])\n\n        # Calculate individual species fluxes\n        fluxes = {}\n        for species in SPECIES_PROPS:\n            fluxes[species] = calculate_flux(\n                species,\n                c_left_equilibrated[species],\n                c_right_equilibrated[species],\n                E_field\n            )\n\n        # Calculate total alkalinity flux: J_AT = J(HCO3-) + 2*J(CO3--) + J(OH-) - J(H+)\n        j_at = (\n            fluxes['HCO3-'] + \n            2 * fluxes['CO3--'] + \n            fluxes['OH-'] - \n            fluxes['H+']\n        )\n        results.append(j_at)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}