{
    "hands_on_practices": [
        {
            "introduction": "本练习将宏观的达西定律（地下水流模拟的基石）建立在孔隙尺度的基本流体力学原理之上。通过进行这一推导和计算，您将巩固对复杂微观物理过程如何被升尺度（upscaled）为THC系统中“H”（水力）部分的可操作宏观方程的理解。",
            "id": "4075032",
            "problem": "在与热-水-化学（THC）耦合模拟相关的条件下，单相不可压缩含水流体在均质、各向同性的多孔岩石中水平流动。温度和化学成分在空间上是均匀的，因此流体的动力粘度和密度是恒定的，渗透率也是恒定且各向同性的。流动是稳态、层流，并且对于这种水平构型，重力被忽略。\n\n从适用于低雷诺数下多孔介质流动的基本原理出发——即不可压缩流体的质量守恒和孔隙尺度上蠕动流的线性动量平衡——使用体积平均法，得到体积比流量矢量与驱动力之间的本构线性关系。然后将此关系应用于给定均匀压力梯度的特定情况。\n\n设压力梯度是均匀的，大小为 $100\\,\\mathrm{Pa\\,m^{-1}}$，方向沿 $+x$ 轴。多孔介质的固有渗透率为 $k = 1.0\\times 10^{-13}\\,\\mathrm{m^{2}}$，流体的动力粘度为 $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s}$，由于流动是水平的，重力体力项为零，$\\mathbf{g}=\\mathbf{0}$。考虑一个面积为 $A=0.10\\,\\mathrm{m^{2}}$、垂直于 $x$ 轴的横截面。\n\n使用您推导出的本构关系，计算体积比流量的 $x$ 分量 $u_{x}$，以及通过该横截面的体积流量 $Q$。将 $u_{x}$ 以 $\\mathrm{m\\,s^{-1}}$ 为单位表示，将 $Q$ 以 $\\mathrm{m^{3}\\,s^{-1}}$ 为单位表示。将您的最终答案表示为一个包含两个元素的行向量 $\\big[u_{x},\\,Q\\big]$，不带单位，并四舍五入到三位有效数字。",
            "solution": "用户希望我解决一个多孔介质中的流体流动问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   **步骤1：提取已知条件：** 我将逐字列出所有提供的信息和约束。\n    *   **步骤2：验证：** 我将根据以下标准检查问题：科学性、适定性、客观性。\n        *   **科学性：** 该问题基于多孔介质流体力学的基本原理（守恒定律、斯托克斯流）和用于推导达西定律的标准升尺度技术——体积平均法。其背景是THC模拟，这是计算地球化学中的一个合法领域。设定（不可压缩、单相、稳态、层流）是标准的简化。给定的压力梯度、渗透率和粘度值在物理上是合理的。\n        *   **适定性：** 问题要求进行推导，然后进行计算。推导部分是标准的教科书练习。计算部分提供了计算未知量所需的所有参数。目标明确：求出比流量和总流量。存在唯一解。\n        *   **客观性：** 语言技术性强且精确。没有主观陈述。\n    *   **步骤3：结论：** 问题看起来是有效的。\n\n2.  **解决问题（如果有效）：**\n    *   **第一部分：本构关系的推导。**\n        *   **出发原理：**\n            1.  **质量守恒（不可压缩流体）：** 在孔隙尺度上，流体速度 $\\mathbf{v}$ 满足 $\\nabla \\cdot \\mathbf{v} = 0$。\n            2.  **动量守恒（蠕动流/斯托克斯流）：** 在孔隙尺度上，对于低雷诺数，动量平衡是斯托克斯方程：$\\nabla p - \\mu \\nabla^2 \\mathbf{v} + \\rho \\mathbf{g} = \\mathbf{0}$。问题说明忽略重力，因此 $\\mathbf{g} = \\mathbf{0}$，方程简化为 $\\nabla p = \\mu \\nabla^2 \\mathbf{v}$。这里，$p$ 是局部孔隙尺度压力，$\\mathbf{v}$ 是局部孔隙尺度速度。\n\n        *   **体积平均：**\n            *   定义一个代表性单元体积（REV），$V_{REV}$，它足够大以包含许多孔隙，但与整个系统尺寸相比又足够小。\n            *   一个量 $\\psi$ 的体积平均定义为 $\\langle \\psi \\rangle = \\frac{1}{V_{REV}} \\int_{V_{REV}} \\psi \\, dV$。\n            *   仅在流体相（体积 $V_f$）中定义的量 $\\psi_f$ 的本征（相）平均为 $\\langle \\psi_f \\rangle^f = \\frac{1}{V_f} \\int_{V_f} \\psi_f \\, dV$。孔隙度为 $\\phi = V_f / V_{REV}$。表观（达西）平均与此相关，关系为 $\\langle \\psi_f \\rangle = \\phi \\langle \\psi_f \\rangle^f$。\n            *   将体积平均算子应用于斯托克斯方程：\n                $$ \\frac{1}{V_{REV}} \\int_{V_f} (\\nabla p - \\mu \\nabla^2 \\mathbf{v}) \\, dV = \\mathbf{0} $$\n                $$ \\langle \\nabla p \\rangle - \\mu \\langle \\nabla^2 \\mathbf{v} \\rangle = \\mathbf{0} $$\n            *   使用空间平均定理：\n                $$ \\langle \\nabla \\psi \\rangle = \\nabla \\langle \\psi \\rangle + \\frac{1}{V_{REV}} \\int_{A_{fs}} \\psi \\mathbf{n} \\, dA $$\n                其中 $A_{fs}$ 是 REV 内的流固界面面积，$\\mathbf{n}$ 是从流体指向固体的单位法向量。\n            *   将此应用于压力项：\n                $$ \\langle \\nabla p \\rangle = \\nabla \\langle p \\rangle + \\frac{1}{V_{REV}} \\int_{A_{fs}} p \\mathbf{n} \\, dA $$\n            *   将此应用于粘性项（稍微复杂一些）：\n                $$ \\langle \\nabla^2 \\mathbf{v} \\rangle = \\langle \\nabla \\cdot (\\nabla \\mathbf{v}) \\rangle = \\nabla \\cdot \\langle \\nabla \\mathbf{v} \\rangle + \\frac{1}{V_{REV}} \\int_{A_{fs}} (\\nabla \\mathbf{v}) \\cdot \\mathbf{n} \\, dA $$\n            *   标准推导表明，斯托克斯方程的体积平均导致：\n                $$ \\nabla \\langle p \\rangle^f = - \\frac{\\mu \\phi}{k} \\langle \\mathbf{v} \\rangle^f + \\text{其他项} $$\n                一个更直接的方法是认识到流固界面上的粘性阻力是抵抗流动的因素。平均粘性应力与平均速度相关。\n            *   形式体积平均过程的结果是，在平均压力梯度和平均速度之间出现了一种关系。平均压力梯度充当驱动力。阻力由孔壁上的粘性力提供。对于慢速流动，所得到的关系是线性的。\n            *   表观速度或体积比流量 $\\mathbf{u}$ 定义为体积平均的流体速度：\n                $$ \\mathbf{u} = \\langle \\mathbf{v} \\rangle = \\frac{1}{V_{REV}} \\int_{V_f} \\mathbf{v} \\, dV $$\n                注意，有些定义使用 $\\mathbf{u} = \\phi \\langle \\mathbf{v} \\rangle^f$。这是比流量的标准定义。\n            *   对斯托克斯方程 $\\mu \\nabla^2 \\mathbf{v} = \\nabla p$（忽略重力）进行体积平均，形式上得到：\n                $$ \\mathbf{u} = -\\frac{\\mathbf{k}}{\\mu} \\cdot (\\nabla \\langle p \\rangle) $$\n                其中 $\\mathbf{k}$ 是渗透率张量，$\\langle p \\rangle$ 是宏观（平均）压力。项 $\\nabla \\langle p \\rangle$ 是宏观压力梯度。\n            *   问题指定介质是 **各向同性** 的，因此渗透率张量 $\\mathbf{k}$ 是单位张量的标量倍数：$\\mathbf{k} = k \\mathbf{I}$，其中 $k$ 是固有渗透率。\n            *   本构关系变为：\n                $$ \\mathbf{u} = -\\frac{k}{\\mu} \\nabla P $$\n                其中 $P = \\langle p \\rangle$ 是宏观压力。这就是 **达西定律**。问题要求找出流量矢量与驱动力之间的关系。驱动力是负压力梯度 $-\\nabla P$。因此，体积比流量 $\\mathbf{u}$ 与驱动力 $-\\nabla P$ 成线性比例关系，比例常数为 $k/\\mu$。\n\n    *   **第二部分：具体化与计算。**\n        *   **计算的已知条件：**\n            *   压力梯度是均匀的，大小为 $100\\,\\mathrm{Pa\\,m^{-1}}$，方向沿 $+x$ 轴。\n            *   这意味着 $\\nabla P = (100, 0, 0) \\, \\mathrm{Pa\\,m^{-1}}$。\n            *   所以，$\\frac{\\partial P}{\\partial x} = 100 \\, \\mathrm{Pa\\,m^{-1}}$，其他分量为零。\n            *   固有渗透率：$k = 1.0 \\times 10^{-13}\\,\\mathrm{m^{2}}$。\n            *   动力粘度：$\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$。\n            *   重力体力为零。\n            *   垂直于流动的横截面积：$A = 0.10\\,\\mathrm{m^{2}}$。\n\n        *   **计算体积比流量矢量 $\\mathbf{u}$。**\n            *   使用推导的关系：$\\mathbf{u} = -\\frac{k}{\\mu} \\nabla P$。\n            *   $\\mathbf{u} = -\\frac{1.0 \\times 10^{-13}\\,\\mathrm{m^{2}}}{1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}} (100, 0, 0) \\, \\mathrm{Pa\\,m^{-1}}$。\n            *   $\\mathbf{u} = -(1.0 \\times 10^{-10} \\, \\frac{\\mathrm{m^2}}{\\mathrm{Pa \\cdot s}}) (100, 0, 0) \\, \\frac{\\mathrm{Pa}}{\\mathrm{m}}$。\n            *   我们来检查单位：$\\frac{\\mathrm{m^2}}{\\mathrm{Pa \\cdot s}} \\times \\frac{\\mathrm{Pa}}{\\mathrm{m}} = \\frac{\\mathrm{m}}{\\mathrm{s}}$。这对于速度是正确的。\n            *   $\\mathbf{u} = (-1.0 \\times 10^{-10} \\times 100, 0, 0) \\, \\mathrm{m\\,s^{-1}}$。\n            *   $\\mathbf{u} = (-1.0 \\times 10^{-8}, 0, 0) \\, \\mathrm{m\\,s^{-1}}$。\n            *   问题要求 $x$ 分量，$u_x$。\n            *   $u_x = -1.0 \\times 10^{-8} \\, \\mathrm{m\\,s^{-1}}$。\n\n        *   **等等，让我重读一下压力梯度的方向。**\n            *   “压力梯度是均匀的，大小为 $100\\,\\mathrm{Pa\\,m^{-1}}$，方向沿 $+x$ 轴。”\n            *   这意味着矢量 $\\nabla P$ 是 $(100, 0, 0)~\\mathrm{Pa/m}$。\n            *   流动从高压处流向低压处。在 $+x$ 方向上的正压力梯度意味着压力随 $x$ *增加*。因此，流动方向应为 $-x$ 方向。我的计算证实了这一点：$u_x$ 是负的。\n            *   问题要求的是 $u_x$。所以值是 $-1.0 \\times 10^{-8}$。\n\n        *   **等等，“驱动力”是 $-\\nabla P$ 还是 $\\nabla P$？**\n            *   按照惯例，流体流动的驱动力是压力梯度的负值，即 $-\\nabla P$，因为流动是沿着压力“下坡”的。达西定律通常写成 $\\mathbf{u} = \\mathbf{K} \\cdot (-\\nabla P)$，其中 $\\mathbf{K} = \\mathbf{k}/\\mu$ 是水力传导系数张量。\n            *   “体积比流量矢量与驱动力之间的本构线性关系”这一措辞有点模糊。我们坚持形式推导。斯托克斯方程是 $\\nabla p = \\mu \\nabla^2 \\mathbf{v}$。平均后得到 $\\nabla \\langle p \\rangle \\approx -\\frac{\\mu}{k} \\mathbf{u}$。所以 $\\mathbf{u} = - \\frac{k}{\\mu} \\nabla P$。这是标准形式。\n            *   驱动力是势的梯度。对于流体流动，势是压力（或更一般地说是水头）。力的方向是势的负梯度方向。所以驱动力确实是 $-\\nabla P$。\n            *   $\\mathbf{u} = \\frac{k}{\\mu} (-\\nabla P)$。这显示了比流量 $\\mathbf{u}$ 与驱动力 $-\\nabla P$ 之间的线性关系。比例常数是水力传导系数 $K=k/\\mu$。\n            *   我的计算与此一致。\n            *   $u_x = -1.0 \\times 10^{-8} \\, \\mathrm{m\\,s^{-1}}$。\n\n        *   **计算体积流量 $Q$。**\n            *   通过垂直于流动的横截面积 $A$ 的体积流量 $Q$ 由比流量的法向分量在该面积上的积分给出。\n            *   由于流动是均匀的（压力梯度均匀，介质均质），比流量 $\\mathbf{u}$ 在整个横截面上是恒定的。\n            *   $Q = \\int_A \\mathbf{u} \\cdot d\\mathbf{A}$。\n            *   面积垂直于 $x$ 轴。其面积矢量为 $\\mathbf{A} = A \\mathbf{i}$，其中 $\\mathbf{i}$ 是 $+x$ 方向的单位矢量。\n            *   $Q = \\mathbf{u} \\cdot \\mathbf{A} = (u_x \\mathbf{i}) \\cdot (A \\mathbf{i}) = u_x A$。\n            *   等等，这正确吗？流量通常是一个表示单位时间内总体积的正量。如果我使用 $u_x = -1.0 \\times 10^{-8}$，那么 $Q$ 将是负的。\n            *   $Q = (-1.0 \\times 10^{-8} \\, \\mathrm{m\\,s^{-1}}) \\times (0.10 \\, \\mathrm{m^2}) = -1.0 \\times 10^{-9} \\, \\mathrm{m^3\\,s^{-1}}$。\n            *   我们来检查流量的定义。体积流率 $Q$ 是单位时间内通过的流体体积。它通常定义为 $Q = \\int_S \\mathbf{v} \\cdot d\\mathbf{S}$。符号取决于 $d\\mathbf{S}$ 的方向。如果 $d\\mathbf{S}$ 指向正 $x$ 方向，而流动在负 $x$ 方向，点积将为负，从而产生负通量。\n            *   问题没有指定 $Q$ 的方向。“计算...通过该横截面的体积流量 $Q$”。这通常意味着大小。然而，物理学家或工程师可能会保留符号以指示跨越指定表面的传输方向。考虑到上下文（STEM教授角色），精确表达符号很重要。\n            *   让我们重读一下：“考虑一个面积为 $A=0.10\\,\\mathrm{m^{2}}$、垂直于 $x$ 轴的横截面。” 这对于面积矢量的方向有点模糊。可以取为 $\\mathbf{A} = (0.10, 0, 0)\\,\\mathrm{m^2}$ 或 $\\mathbf{A} = (-0.10, 0, 0)\\,\\mathrm{m^2}$。按照惯例，对于由 $x=\\text{const}$ 定义的表面，法向量取在 $+x$ 方向。让我们假设这个惯例。那么我的计算 $Q = u_x A$ 是正确的。\n            *   $Q = -1.0 \\times 10^{-9} \\, \\mathrm{m^3\\,s^{-1}}$。负号表示在法线指向 $+x$ 方向的表面上，体积的净流动方向为 $-x$ 方向。这在物理上是一致的。\n            *   问题是否可能暗示比流量的大小？“计算体积比流量的 $x$ 分量 $u_x$”。这明确要求分量，它可以是负的。“以及通过该横截面的体积流量 $Q$”。这更模糊。如果问题想要流率的大小，它可能会说“流速”或“流量的大小”。“体积流量”可以是一个有符号的量（通量）。我将坚持使用有符号的量。\n\n        *   **最终数值和四舍五入。**\n            *   $u_x = -1.0 \\times 10^{-8} \\, \\mathrm{m\\,s^{-1}}$。这已经是两位有效数字。输入最多有3位有效数字（$k=1.0\\times 10^{-13}$有两位，$\\mu=1.0\\times 10^{-3}$有两位，$A=0.10$有两位）。我们再检查一下已知条件。“大小为 $100\\,\\mathrm{Pa\\,m^{-1}}$”（一位有效数字？），“$k = 1.0\\times 10^{-13}\\,\\mathrm{m^{2}}$”（两位有效数字），“$\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s}$”（两位有效数字），“$A=0.10\\,\\mathrm{m^{2}}$”（两位有效数字）。有效数字的规则是乘法/除法的结果应具有与有效数字最少的数一样多的有效数字。这里，“100 Pa/m”可以解释为有1、2或3位有效数字。如果它正好是100，那就是3位。如果它是一个实验值，那就是模糊的。通常，像“100”这样的数字在问题中意味着是精确的或具有与其他数字相同的精度。我们看一下说明：“四舍五入到三位有效数字”。这覆盖了模糊性。我必须提供3位有效数字的答案。\n\n            *   我们假设输入是精确的或至少有3位有效数字，重新计算。\n            *   $k = 1.00 \\times 10^{-13}\\,\\mathrm{m^{2}}$\n            *   $\\mu = 1.00 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$\n            *   $\\nabla P = (100, 0, 0) \\, \\mathrm{Pa\\,m^{-1}}$\n            *   $A = 0.100\\,\\mathrm{m^{2}}$\n            *   那么 $u_x = - \\frac{1.00 \\times 10^{-13}}{1.00 \\times 10^{-3}} \\times 100 = - (1.00 \\times 10^{-10}) \\times 100 = -1.00 \\times 10^{-8}$。\n            *   并且 $Q = u_x \\times A = (-1.00 \\times 10^{-8}) \\times 0.100 = -1.00 \\times 10^{-9}$。\n\n            *   最终答案格式：`一个包含两个元素的行向量 [ux, Q]，不带单位，四舍五入到三位有效数字。`\n            *   $u_x = -1.00 \\times 10^{-8}$\n            *   $Q = -1.00 \\times 10^{-9}$\n            *   该向量将是 $[-1.00 \\times 10^{-8}, -1.00 \\times 10^{-9}]$。\n\n    *   **解答文本的结构：**\n        1.  从问题验证部分开始。陈述已知条件。声明结论为“有效”并解释原因（科学性、适定性等）。\n        2.  开始推导部分。陈述基本原理：不可压缩流体的质量守恒（$\\nabla \\cdot \\mathbf{v} = 0$）和蠕动流的动量守恒（斯托克斯方程，$\\nabla p = \\mu \\nabla^2 \\mathbf{v}$）。\n        3.  解释体积平均的概念和体积比流量矢量 $\\mathbf{u}$ 的定义。\n        4.  陈述将体积平均应用于各向同性多孔介质的斯托克斯方程的结果，即得到达西定律：$\\mathbf{u} = -\\frac{k}{\\mu}\\nabla P$。解释这就是所要求的线性本构关系。\n        5.  进入计算部分。代入 $k$、$\\mu$ 和 $\\nabla P$ 的给定值。\n        6.  计算矢量 $\\mathbf{u}$ 并提取其 $x$ 分量 $u_x$。\n        7.  定义体积流量 $Q = u_x A$。\n        8.  使用计算出的 $u_x$ 和给定的 $A$ 计算 $Q$。\n        9.  陈述 $u_x$ 和 $Q$ 的数值结果。\n        10. 按要求将结果四舍五入到三位有效数字。\n        11. 将最终数字格式化为行矩阵，用于 `final_answer` 标签。\n\n这似乎是完整和正确的。我现在将按照所有格式规则编写最终输出。我将非常小心地处理每一个数字和符号的LaTeX格式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1.00 \\times 10^{-8} & -1.00 \\times 10^{-9}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "THC建模的一个关键挑战是捕捉不同过程之间的反馈。本练习聚焦于一个关键的C-H（化学-水力）耦合：矿物沉淀和溶解如何改变岩石的孔隙度。通过推导并应用孔隙度演化方程，您将直接洞察化学反应如何重塑流体流动的物理环境。",
            "id": "4075004",
            "problem": "一个碳酸盐储层岩石的代表性单元体（REV）在热-水-化学（THC）耦合条件下被建模。该REV的总体积是恒定的，岩石基质主要由单一矿物相——方解石组成。设孔隙度定义为 $\\phi = V_{\\text{pore}}/V_{\\text{bulk}}$，其中 $V_{\\text{bulk}}$ 不随时间变化。考虑通过沉淀和溶解改变单位总体积内固体质量的矿物反应。要求您从固体的质量守恒和孔隙度的几何定义出发，推导出一个孔隙度演化 $\\frac{d\\phi}{dt}$ 的通用表达式。该表达式应以每种矿物 $m$ 的摩尔质量 $M_m$、化学计量系数 $\\nu_m$、体积摩尔反应速率 $r_m$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，沉淀为正，溶解为负）以及一个代表性的固体密度 $\\rho_s$（单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$）来表示，并假设岩石基质可以很好地用一个单一的有效固体密度来近似。\n\n然后，将您的表达式应用于一个方解石沉淀情景。在该情景中，热-化学状态产生了一个经温度校正的表面反应系数 $k(T)$ 和一个过饱和比 $\\Omega$。对于方解石，采用以下数据：\n- 过饱和比：$\\Omega = 1.3$（无量纲）。\n- 经温度校正的表面反应系数：$k(T) = 1.0 \\times 10^{-7}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 反应表面积密度：$a_s = 1.0 \\times 10^{5}\\ \\mathrm{m}^{2}\\,\\mathrm{m}^{-3}$。\n- 方解石摩尔质量：$M_{\\mathrm{cal}} = 1.0009 \\times 10^{-1}\\ \\mathrm{kg}\\,\\mathrm{mol}^{-1}$。\n- 代表性固体密度：$\\rho_s = 2.710 \\times 10^{3}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n- 方解石作为固体产物的化学计量系数：$\\nu_{\\mathrm{cal}} = 1$。\n\n假设一个与水力和化学状态一致的线性近平衡沉淀速率定律，\n$$\nr_{\\mathrm{cal}} \\;=\\; a_s\\,k(T)\\,\\bigl(\\Omega - 1\\bigr),\n$$\n其中 $r_{\\mathrm{cal}}$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，在过饱和状态下为正值。\n\n在所述假设下推导孔隙度演化方程，并计算上述方解石情景的瞬时孔隙度变化率 $\\frac{d\\phi}{dt}$。您的最终数值答案请以 $\\mathrm{s}^{-1}$ 为单位，并四舍五入到三位有效数字。",
            "solution": "用户要求推导在热-水-化学（THC）耦合条件下的孔隙度演化方程，并将其应用于一个特定的方解石沉淀情景。\n\n**第一部分：通用孔隙度演化方程的推导**\n\n一个代表性单元体（REV）的孔隙度 $\\phi$ 定义为孔隙体积 $V_{\\text{pore}}$ 与总体积 $V_{\\text{bulk}}$ 之比：\n$$\n\\phi = \\frac{V_{\\text{pore}}}{V_{\\text{bulk}}}\n$$\n总体积由孔隙体积和固体基质体积 $V_{\\text{solid}}$ 组成：\n$$\nV_{\\text{bulk}} = V_{\\text{pore}} + V_{\\text{solid}}\n$$\n问题陈述 $V_{\\text{bulk}}$ 不随时间变化。因此，将此关系对时间 $t$ 求导，得到：\n$$\n\\frac{d V_{\\text{bulk}}}{dt} = \\frac{d V_{\\text{pore}}}{dt} + \\frac{d V_{\\text{solid}}}{dt} = 0\n$$\n这意味着孔隙体积和固体体积变化率之间存在一个关键关系：\n$$\n\\frac{d V_{\\text{pore}}}{dt} = - \\frac{d V_{\\text{solid}}}{dt}\n$$\n固体基质体积的增加必然伴随着孔隙体积的等量减少。\n\n接下来，我们将孔隙度的定义对时间求导。由于 $V_{\\text{bulk}}$ 是恒定的，我们有：\n$$\n\\frac{d\\phi}{dt} = \\frac{d}{dt}\\left(\\frac{V_{\\text{pore}}}{V_{\\text{bulk}}}\\right) = \\frac{1}{V_{\\text{bulk}}} \\frac{d V_{\\text{pore}}}{dt}\n$$\n代入 $\\frac{d V_{\\text{pore}}}{dt}$ 的表达式：\n$$\n\\frac{d\\phi}{dt} = - \\frac{1}{V_{\\text{bulk}}} \\frac{d V_{\\text{solid}}}{dt}\n$$\n这个方程将孔隙度的宏观演化与由化学反应引起的固体基质体积的微观变化联系起来。\n\n总固体体积的变化是所有组成矿物相（用 $m$ 索引）体积变化的总和：\n$$\n\\frac{d V_{\\text{solid}}}{dt} = \\sum_m \\frac{d V_m}{dt}\n$$\n其中 $V_m$ 是矿物 $m$ 的体积。体积 $V_m$ 与其摩尔量 $N_m$（单位为 $\\mathrm{mol}$）和摩尔体积 $\\bar{V}_m$（单位为 $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}$）相关，关系为 $V_m = N_m \\bar{V}_m$。假设在此过程中摩尔体积是恒定的，体积变化率为：\n$$\n\\frac{d V_m}{dt} = \\bar{V}_m \\frac{d N_m}{dt}\n$$\n摩尔体积 $\\bar{V}_m$ 是矿物摩尔质量 $M_m$ 与其密度 $\\rho_{s,m}$ 的比值。问题允许用一个单一的代表性固体密度 $\\rho_s$ 来近似所有矿物的密度，因此 $\\bar{V}_m \\approx \\frac{M_m}{\\rho_s}$。\n\n体积摩尔反应速率 $r_m$ 的单位是 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，表示单位总体积内涉及矿物 $m$ 的反应速率。单位总体积内矿物 $m$ 的摩尔生成速率由乘积 $\\nu_m r_m$ 给出，其中 $\\nu_m$ 是反应中矿物 $m$ 的化学计量系数（产物为正，反应物为负）。因此，整个REV内矿物 $m$ 的总摩尔变化率为：\n$$\n\\frac{d N_m}{dt} = (\\nu_m r_m) V_{\\text{bulk}}\n$$\n将此代入矿物 $m$ 的体积变化率表达式中：\n$$\n\\frac{d V_m}{dt} = \\left(\\frac{M_m}{\\rho_s}\\right) (\\nu_m r_m V_{\\text{bulk}})\n$$\n对所有矿物相求和，得到总固体体积变化率：\n$$\n\\frac{d V_{\\text{solid}}}{dt} = \\sum_m \\frac{d V_m}{dt} = \\sum_m \\left( \\frac{M_m}{\\rho_s} \\nu_m r_m V_{\\text{bulk}} \\right) = \\frac{V_{\\text{bulk}}}{\\rho_s} \\sum_m M_m \\nu_m r_m\n$$\n最后，我们将 $\\frac{d V_{\\text{solid}}}{dt}$ 的这个表达式代回到孔隙度变化率的方程中：\n$$\n\\frac{d\\phi}{dt} = - \\frac{1}{V_{\\text{bulk}}} \\left( \\frac{V_{\\text{bulk}}}{\\rho_s} \\sum_m M_m \\nu_m r_m \\right)\n$$\n这简化为孔隙度演化的通用控制方程：\n$$\n\\frac{d\\phi}{dt} = - \\frac{1}{\\rho_s} \\sum_m M_m \\nu_m r_m\n$$\n\n**第二部分：应用于方解石沉淀**\n\n问题提供了一个涉及单一矿物方解石（$\\mathrm{CaCO}_3$）沉淀的特定情景。对于单一矿物系统，求和简化为单项：\n$$\n\\frac{d\\phi}{dt} = - \\frac{M_{\\mathrm{cal}}}{\\rho_s} \\nu_{\\mathrm{cal}} r_{\\mathrm{cal}}\n$$\n我们已知方解石沉淀的速率定律：\n$$\nr_{\\mathrm{cal}} = a_s k(T) (\\Omega - 1)\n$$\n所提供的数据是：\n-   过饱和比：$\\Omega = 1.3$\n-   经温度校正的表面反应系数：$k(T) = 1.0 \\times 10^{-7}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n-   反应表面积密度：$a_s = 1.0 \\times 10^{5}\\ \\mathrm{m}^{2}\\,\\mathrm{m}^{-3}$\n-   方解石摩尔质量：$M_{\\mathrm{cal}} = 1.0009 \\times 10^{-1}\\ \\mathrm{kg}\\,\\mathrm{mol}^{-1}$\n-   代表性固体密度：$\\rho_s = 2.710 \\times 10^{3}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n-   化学计量系数：$\\nu_{\\mathrm{cal}} = 1$\n\n首先，我们计算体积摩尔反应速率 $r_{\\mathrm{cal}}$：\n$$\nr_{\\mathrm{cal}} = (1.0 \\times 10^{5}\\ \\mathrm{m}^{2}\\,\\mathrm{m}^{-3}) \\times (1.0 \\times 10^{-7}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) \\times (1.3 - 1.0)\n$$\n$$\nr_{\\mathrm{cal}} = (1.0 \\times 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (0.3)\n$$\n$$\nr_{\\mathrm{cal}} = 3.0 \\times 10^{-3}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}\n$$\n由于 $\\Omega > 1$，速率 $r_{\\mathrm{cal}}$ 为正，正确地表示了沉淀过程。\n\n现在，我们将这个速率和其他给定值代入孔隙度演化方程：\n$$\n\\frac{d\\phi}{dt} = - \\frac{1.0009 \\times 10^{-1}\\ \\mathrm{kg}\\,\\mathrm{mol}^{-1}}{2.710 \\times 10^{3}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}} \\times (1) \\times (3.0 \\times 10^{-3}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1})\n$$\n计算过程如下：\n$$\n\\frac{d\\phi}{dt} = - \\left( \\frac{1.0009}{2.710} \\times 10^{-1-3} \\ \\mathrm{m}^{3}\\,\\mathrm{mol}^{-1} \\right) \\times (3.0 \\times 10^{-3}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1})\n$$\n$$\n\\frac{d\\phi}{dt} = - (0.369335... \\times 10^{-4}\\ \\mathrm{m}^{3}\\,\\mathrm{mol}^{-1}) \\times (3.0 \\times 10^{-3}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1})\n$$\n$$\n\\frac{d\\phi}{dt} = - (1.108007... \\times 10^{-4-3}) \\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{d\\phi}{dt} = -1.108007... \\times 10^{-7}\\ \\mathrm{s}^{-1}\n$$\n根据要求，将结果四舍五入到三位有效数字：\n$$\n\\frac{d\\phi}{dt} \\approx -1.11 \\times 10^{-7}\\ \\mathrm{s}^{-1}\n$$\n负号表示孔隙度正在减小，这与矿物沉淀填充孔隙空间的情况一致。",
            "answer": "$$\n\\boxed{-1.11 \\times 10^{-7}}\n$$"
        },
        {
            "introduction": "同时求解完全耦合的THC方程在计算上可能成本高昂。本练习介绍算子分裂法，这是一种强大的数值策略，用于顺序求解输运和反应过程。通过实现一个简单的分裂方案并分析其误差，您将获得现代THC模拟器中使用的核心技术的实践经验，并理解其内在的权衡。",
            "id": "4075011",
            "problem": "考虑在一个耦合的热-水-化学 (THC) 系统中，单个主要水相物质的浓度场在短时间间隔内根据质量守恒和线性化反应演化。从基本的质量平衡和输运定律出发，假设孔隙度为常数，流体性质是时间滞后的，那么经过空间离散化后，浓度动力学由一个关于网格平均浓度 $C \\in \\mathbb{R}^N$ 的线性常微分方程组控制：\n$$\n\\frac{\\partial}{\\partial t} C(t) = \\mathcal{T}(C(t)) + \\mathcal{R}(C(t)),\n$$\n其中 $\\mathcal{T}$ 表示离散输运算子（由水力和热力场驱动的对流-扩散），$\\mathcal{R}$ 表示线性化反应算子（关于前一时间步进行线性化的、与温度相关的水相反应）。在线性化下，这些成为矩阵算子 $T \\in \\mathbb{R}^{N \\times N}$ 和 $R \\in \\mathbb{R}^{N \\times N}$，得到：\n$$\n\\frac{\\partial}{\\partial t} C(t) = \\left(T + R\\right) C(t),\n$$\n初始条件为 $C(0) = C_0 \\in \\mathbb{R}^N$。对于线性系统，根据线性系统的叠加原理，单个时间步长 $\\Delta t$ 内的精确演化由矩阵指数解给出。\n\n实现最简单的两步算子分裂 (Lie/Godunov) 格式。该格式通过依次演化输运子问题（时间为 $\\Delta t$）和反应子问题（时间为 $\\Delta t$），并使用子问题的精确流来推进解。然后计算一个时间步长 $\\Delta t$ 后的分裂误差的欧几里得范数，该误差定义为分裂解与精确解在时间 $\\Delta t$ 的差的欧几里得范数。由于计算地球化学中的标准无量纲化，所有量都是无量纲的；因此，所有数值答案都应以无单位浮点数的形式报告。\n\n你的程序必须：\n- 对于每个测试用例，计算完整线性系统在时间 $\\Delta t$ 的精确解，以及通过顺序应用精确子问题流得到的两步分裂近似解，然后返回它们之间差的欧几里得范数。\n- 使用欧几里得范数（$\\ell^2$ 范数）计算误差，即对于向量 $v \\in \\mathbb{R}^N$，$\\|v\\|_2 = \\left(\\sum_{i=1}^N v_i^2\\right)^{1/2}$。\n- 生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3]$，无空格。将每个结果表示为浮点数（无四舍五入要求；可接受默认的浮点字符串表示）。\n\n测试套件参数：\n- 情况 A（常规的不可交换输运和反应）：\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -0.3 & 0.05 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.04 & 0.0 & -0.1 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ 0.2 \\end{bmatrix}$,\n  - $\\Delta t = 0.1$.\n- 情况 B（可交换算子；对角输运和反应）：\n  - $N = 3$,\n  - $T = \\operatorname{diag}(-1.0,-2.0,-3.0)$,\n  - $R = \\operatorname{diag}(-0.1,-0.1,-0.1)$,\n  - $C_0 = \\begin{bmatrix} 1.0 \\\\ 1.0 \\\\ 1.0 \\end{bmatrix}$,\n  - $\\Delta t = 0.3$.\n- 情况 C（相对于输运的刚性反应）：\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -10.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.5 & -1.0 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 2.0 \\\\ 0.1 \\\\ 1.0 \\end{bmatrix}$,\n  - $\\Delta t = 0.05$.\n- 情况 D（用于探测误差阶的小时间步长）：\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -0.3 & 0.05 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.04 & 0.0 & -0.1 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 0.3 \\\\ 0.7 \\\\ 0.9 \\end{bmatrix}$,\n  - $\\Delta t = 1.0 \\times 10^{-4}$.\n\n对于每种情况，时间 $\\Delta t$ 的精确解是完整线性系统演化时间 $\\Delta t$ 的结果。两步分裂近似是在时间 $\\Delta t$ 上应用精确的输运子流，然后是在时间 $\\Delta t$ 上应用精确的反应子流。计算其差的欧几里得范数作为误差。你的程序应生成单行输出，其中包含四个误差值，格式为用方括号括起来的逗号分隔列表，无空格，顺序为 $[\\text{情况 A},\\text{情况 B},\\text{情况 C},\\text{情况 D}]$。",
            "solution": "该问题被评估为有效，因为它在科学上基于反应-输运系统的数值分析原理，对于每个测试用例都是适定的，具有完整且一致的给定条件，并以客观、正式的语言表述。该任务是计算科学中的一个标准练习，具体涉及用于线性常微分方程组的算子分裂方法。因此，我们可以继续进行求解。\n\n该问题要求计算用于模拟耦合热-水-化学 (THC) 过程的线性常微分方程组 (ODEs) 的一阶 Lie-Godunov 算子分裂格式的误差。浓度向量 $C(t) \\in \\mathbb{R}^N$ 的控制方程由下式给出：\n$$\n\\frac{dC}{dt} = (T + R) C(t)\n$$\n初始条件为 $C(0) = C_0$。矩阵 $T \\in \\mathbb{R}^{N \\times N}$ 和 $R \\in \\mathbb{R}^{N \\times N}$ 分别代表离散输运和线性化反应算子。\n\n首先，我们定义这个线性常系数常微分方程组的精确解。在长度为 $\\Delta t$ 的时间间隔内的解，由系统矩阵 $A = T+R$ 的矩阵指数作用于初始状态给出。\n$$\nC_{exact}(\\Delta t) = e^{(T+R)\\Delta t} C_0\n$$\n这提供了用于比较近似数值解的基准。\n\n接下来，我们使用指定的算子分裂格式来构建近似解。Lie-Godunov 分裂法通过顺序应用各个子问题的流来近似组合算子 $T+R$ 下的演化。问题指定了一个两步序列：首先，演化输运子问题，其次，演化反应子问题，每个子问题都演化完整的时间步长 $\\Delta t$。\n\n输运子问题是 $\\frac{dC}{dt} = T C$。从 $C_0$ 开始，在 $\\Delta t$ 时间内的精确解是 $C_{intermediate} = e^{T \\Delta t} C_0$。\n反应子问题是 $\\frac{dC}{dt} = R C$。从 $C_{intermediate}$ 开始，在 $\\Delta t$ 时间内的精确解是 $C_{final} = e^{R \\Delta t} C_{intermediate}$。\n\n结合这些步骤，得到时间 $\\Delta t$ 的算子分裂解：\n$$\nC_{split}(\\Delta t) = e^{R \\Delta t} (e^{T \\Delta t} C_0) = (e^{R \\Delta t} e^{T \\Delta t}) C_0\n$$\n一个时间步长后，分裂格式的误差是分裂解与精确解之间差的欧几里得范数。误差向量是\n$$\nv_{err} = C_{split}(\\Delta t) - C_{exact}(\\Delta t) = \\left( e^{R \\Delta t} e^{T \\Delta t} - e^{(T+R)\\Delta t} \\right) C_0\n$$\n要计算的量是该向量的欧几里得范数（或 $\\ell^2$-范数）：\n$$\n\\text{Error} = \\| v_{err} \\|_2 = \\sqrt{\\sum_{i=1}^{N} (v_{err,i})^2}\n$$\n这种分裂误差的根本来源是矩阵指数的不可交换性。通常，对于矩阵 $X$ 和 $Y$，$e^X e^Y \\neq e^{X+Y}$。等式成立的充分必要条件是矩阵可交换，即 $XY = YX$。在我们的情境中，$X = R\\Delta t$ 且 $Y = T\\Delta t$，Lie 分裂格式是精确的，当且仅当算子 $T$ 和 $R$ 可交换 ($TR = RT$)。对于不可交换的算子，Baker-Campbell-Hausdorff (BCH) 公式表明，局部误差与算子的交换子 $[T, R] = TR - RT$ 成正比。具体来说，$e^{R \\Delta t} e^{T \\Delta t} = e^{(T+R)\\Delta t + \\frac{(\\Delta t)^2}{2}[R,T] + \\mathcal{O}((\\Delta t)^3)}$。这表明该格式的局部误差为 $\\mathcal{O}((\\Delta t)^2)$ 阶，这使得 Lie 分裂法成为一阶精确方法。\n\n每个测试用例的算法如下：\n1. 定义矩阵 $T$ 和 $R$、初始向量 $C_0$ 以及时间步长 $\\Delta t$。\n2. 计算组合算子矩阵 $A = T + R$。\n3. 计算精确解的矩阵指数：$M_{exact} = e^{A \\Delta t}$。\n4. 计算精确解向量：$C_{exact} = M_{exact} C_0$。\n5. 计算分裂子问题的矩阵指数：$M_T = e^{T \\Delta t}$ 和 $M_R = e^{R \\Delta t}$。\n6. 计算分裂解向量：$C_{split} = M_R (M_T C_0)$。\n7. 计算差向量 $v_{err} = C_{split} - C_{exact}$。\n8. 计算差向量的欧几里得范数 $\\| v_{err} \\|_2$。\n\n将此过程应用于四个测试用例中的每一个。情况 B 是一个特例，其中 $T$ 和 $R$ 都是对角矩阵。由于所有对角矩阵都可交换，我们预期 $[T, R]=0$，因此分裂误差应为零（在机器精度范围内）。情况 D 使用一个非常小的 $\\Delta t$，可以用来验证单步误差符合预期的 $\\mathcal{O}((\\Delta t)^2)$ 行为。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the operator-splitting error for four test cases of a linearized\n    reaction-transport system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: general noncommuting transport and reaction\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-0.3, 0.05, 0.0],\n                [0.0, -0.2, 0.0],\n                [0.04, 0.0, -0.1]\n            ]),\n            \"C0\": np.array([1.0, 0.5, 0.2]),\n            \"dt\": 0.1\n        },\n        # Case B: commuting operators; diagonal transport and reaction\n        {\n            \"T\": np.diag([-1.0, -2.0, -3.0]),\n            \"R\": np.diag([-0.1, -0.1, -0.1]),\n            \"C0\": np.array([1.0, 1.0, 1.0]),\n            \"dt\": 0.3\n        },\n        # Case C: stiff reaction relative to transport\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-10.0, 0.0, 0.0],\n                [0.0, -5.0, 0.0],\n                [0.0, 0.5, -1.0]\n            ]),\n            \"C0\": np.array([2.0, 0.1, 1.0]),\n            \"dt\": 0.05\n        },\n        # Case D: small time step to probe error order\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-0.3, 0.05, 0.0],\n                [0.0, -0.2, 0.0],\n                [0.04, 0.0, -0.1]\n            ]),\n            \"C0\": np.array([0.3, 0.7, 0.9]),\n            \"dt\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        R = case[\"R\"]\n        C0 = case[\"C0\"]\n        dt = case[\"dt\"]\n\n        # Full operator matrix\n        A = T + R\n\n        # --- Exact Solution ---\n        # C_exact(dt) = exp((T+R)*dt) * C0\n        exp_A_dt = expm(A * dt)\n        C_exact = exp_A_dt @ C0\n\n        # --- Operator-Split Solution (Lie-Godunov) ---\n        # First, transport step: C_intermediate = exp(T*dt) * C0\n        # Second, reaction step: C_split = exp(R*dt) * C_intermediate\n        exp_T_dt = expm(T * dt)\n        exp_R_dt = expm(R * dt)\n        \n        # C_split(dt) = exp(R*dt) * exp(T*dt) * C0\n        C_split = exp_R_dt @ (exp_T_dt @ C0)\n\n        # --- Error Calculation ---\n        # Error is the Euclidean norm of the difference vector\n        error_vector = C_split - C_exact\n        error_norm = np.linalg.norm(error_vector, ord=2)\n        results.append(error_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}