{
    "hands_on_practices": [
        {
            "introduction": "这是一个基础性练习，旨在推导层状介质中平行于分层的输运过程的有效扩散系数。我们将探索的核心原理是，在一个特定的简化假设（快速的横向混合）下，体积平均法如何导出一个简单的算术平均值。这个案例是理解有效属性如何与微观尺度非均质性结构相关联的基石。",
            "id": "4105929",
            "problem": "考虑一个代表计算地球化学中沉积构造的二维层状多孔介质。该介质占据一个具有纵向坐标 $x$ 和横向坐标 $y$ 的区域。$y$ 方向的横截面由厚度均为 $\\ell_m$ 的交替薄层周期性重复构成，一个薄层中的局部自分子扩散系数为 $D_1$，相邻薄层中的为 $D_2$，从而形成一个周期为 $2\\ell_m$ 的结构。一种浓度为 $c(x,y,t)$ 的溶解、非平流的地球化学物质在整个介质中进行扩散，并发生速率常数为 $k$ 的均匀一级反应。\n\n在微观尺度上，输运遵循物质守恒方程和 Fick 定律：\n$$\n\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c, \\quad \\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c,\n$$\n其中 $D(y)$ 在 $y$ 方向上是分段常数，在每个厚度为 $\\ell_m$ 的层之间于 $D_1$ 和 $D_2$ 之间交替变化。\n\n假设满足以下横向混合条件：在单个薄层厚度 $\\ell_m$ 上的横向扩散相对于宏观纵向演化的特征时间足够快，以至于在所关注的时间尺度上，$c(x,y,t)$ 在每个 $x$ 处沿 $y$ 方向变得均匀，即在升尺度描述中 $\\partial c/\\partial y \\approx 0$。因此，在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 都与 $y$ 无关。\n\n将代表性单元体积 (REV) 定义为分层结构的一个完整周期单元，其在 $y$ 方向上的宽度为 $2\\ell_m$，在 $z$ 方向上的厚度为单位厚度，并令 $\\langle \\cdot \\rangle$ 表示在该 REV 上沿 $y$ 方向的平均。沿 $x$ 方向的升尺度一维模型通过本构关系表示为横截面平均浓度 $\\langle c \\rangle(x,t)$ 和有效扩散系数 $D^{\\ast}$ 的函数：\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x},\n$$\n其中 $J(x,t)$ 是微观通量 $j_x(x,y,t)$ 的纵向分量沿 $y$ 方向的平均值。\n\n从上述基本定律和横向混合假设出发，推导沿 $x$ 方向纵向输运的有效扩散系数 $D^{\\ast}$（用 $D_1$、$D_2$ 和 $\\ell_m$ 表示），并计算 $D^{\\ast}$。将最终答案表示为闭式解析表达式。无需四舍五入。最终方框内的答案不需要单位，但 $D_1$ 和 $D_2$ 是分子扩散系数，其单位为（长度的平方/时间）。",
            "solution": "用户希望在横向混合假设下，推导层状多孔介质的有效纵向扩散系数 $D^{\\ast}$。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **几何结构：** 一个具有纵向坐标 $x$ 和横向坐标 $y$ 的二维区域。介质由厚度均为 $\\ell_m$ 的交替薄层周期性重复构成。$y$ 方向的周期为 $2\\ell_m$。\n*   **物理性质：** 局部自分子扩散系数 $D(y)$ 是分段常数，在相邻层之间于 $D_1$ 和 $D_2$ 之间交替变化。\n*   **输运过程：** 一种浓度为 $c(x,y,t)$ 的溶解、非平流物质进行扩散，并发生速率常数为 $k$ 的均匀一级反应。\n*   **微观尺度方程：**\n    *   守恒方程：$\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c$\n    *   微观通量 (Fick 定律)：$\\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c$\n*   **升尺度假设（横向混合）：**\n    *   横向扩散足够快，以至于在所关注的时间尺度上，$c(x,y,t)$ 在每个 $x$ 处沿 $y$ 方向是均匀的，这意味着在升尺度描述中 $\\partial c/\\partial y \\approx 0$。\n    *   一个直接的推论是，在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 与 $y$ 无关。\n*   **升尺度模型定义：**\n    *   **平均算子：** $\\langle \\cdot \\rangle$ 表示在宽度为 $2\\ell_m$ 的一个周期单元上沿 $y$ 方向的平均。\n    *   **平均浓度：** $\\langle c \\rangle(x,t)$\n    *   **平均通量：** $J(x,t) = \\langle j_x(x,y,t) \\rangle$，其中 $j_x$ 是微观通量 $\\mathbf{j}$ 的纵向分量。\n    *   **有效本构关系：** $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$，该式定义了有效扩散系数 $D^{\\ast}$。\n*   **目标：** 推导用 $D_1$ 和 $D_2$ 表示的 $D^{\\ast}$ 表达式。\n\n**1.2. 验证分析**\n\n*   **科学依据：** 该问题基于 Fick 扩散和反应动力学的成熟原理。使用体积平均法推导非均质介质的有效参数是输运现象、水文地质学和计算地球化学中的一种标准且严谨的技术。该问题在科学上是合理的。\n*   **适定性：** 该问题提供了一个清晰的微观尺度模型、一个具体的升尺度假设和一个明确的目标。“横向混合”假设将问题简化为一个易于处理的、适定的状态，代表了输运理论中一个有效且重要的极限情况（类似于横向平衡远快于纵向输运的极限）。\n*   **客观性：** 该问题以精确、客观和定量的术语陈述，没有歧义或主观内容。\n*   **一致性和完整性：** 该问题是自洽的。所提供的关键假设——$\\partial c/\\partial x$ 与 $y$ 无关——足以进行推导。速率常数为 $k$ 的反应项的存在不会造成矛盾或不完整，因为有效扩散系数 $D^{\\ast}$ 是介质的一种本构性质，它将通量与浓度梯度联系起来，而这与反应源/汇项无关。推导过程将表明 $k$ 不影响 $D^{\\ast}$。参数 $\\ell_m$ 是问题描述的一部分，并将在推导中使用，尽管它可能会在最终结果中被消去。\n\n**1.3. 结论**\n\n该问题是**有效的**。这是一个关于输运参数升尺度的适定、科学合理的问题，适合进行严谨的推导。\n\n### 步骤 2：有效扩散系数的推导\n\n目标是求出有效扩散系数 $D^{\\ast}$，它由平均纵向通量 $J(x,t)$ 的升尺度本构关系定义：\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\n平均通量 $J(x,t)$ 是微观纵向通量 $j_x(x,y,t)$ 在代表性单元体积 (REV) 上的空间平均。REV 是一个宽度为 $2\\ell_m$ 的周期单元。\n$$\nJ(x,t) = \\langle j_x(x,y,t) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} j_x(x,y,t) \\, dy\n$$\n微观纵向通量 $j_x$ 由 Fick 定律给出：\n$$\nj_x(x,y,t) = -D(y) \\frac{\\partial c}{\\partial x}\n$$\n将此代入平均通量的表达式中，得到：\n$$\nJ(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\left( -D(y) \\frac{\\partial c}{\\partial x} \\right) \\, dy = \\left\\langle -D(y) \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\n问题陈述了横向混合假设的一个关键推论：“在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 都与 $y$ 无关。”这使我们可以将项 $\\frac{\\partial c}{\\partial x}$ 视为相对于积分变量 $y$ 的常数。因此，可以将其从积分中提出：\n$$\nJ(x,t) = -\\frac{\\partial c}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy \\right) = -\\frac{\\partial c}{\\partial x} \\langle D(y) \\rangle\n$$\n接下来，我们必须将微观梯度 $\\frac{\\partial c}{\\partial x}$ 与平均浓度的梯度 $\\frac{\\partial \\langle c \\rangle}{\\partial x}$ 联系起来。平均浓度定义为：\n$$\n\\langle c \\rangle(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy\n$$\n对 $x$ 求导并应用莱布尼茨积分法则（因为积分限相对于 $x$ 是常数）：\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy \\right) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\frac{\\partial c}{\\partial x}(x,y,t) \\, dy = \\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\n再次利用 $\\frac{\\partial c}{\\partial x}$ 与 $y$ 无关这一事实，它在 $y$ 上的平均值就是其本身：\n$$\n\\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle = \\frac{\\partial c}{\\partial x}\n$$\n因此，我们建立了等式：\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial c}{\\partial x}\n$$\n将此结果代入我们关于平均通量 $J(x,t)$ 的表达式中：\n$$\nJ(x,t) = -\\frac{\\partial \\langle c \\rangle}{\\partial x} \\langle D(y) \\rangle\n$$\n通过将这个推导出的 $J(x,t)$ 表达式与有效扩散系数的定义 $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$ 进行比较，我们可以直接确定 $D^{\\ast}$：\n$$\n-D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x} = -\\langle D(y) \\rangle \\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\n这得出的结论是，有效扩散系数是微观扩散系数在 REV 上的算术平均值。\n$$\nD^{\\ast} = \\langle D(y) \\rangle\n$$\n最后一步是计算这个平均值。介质由厚度均为 $\\ell_m$ 的交替层组成。在一个宽度为 $2\\ell_m$ 的周期内，有一个厚度为 $\\ell_m$、扩散系数为 $D_1$ 的层，以及一个相邻的厚度为 $\\ell_m$、扩散系数为 $D_2$ 的层。\n$$\nD(y) =\n\\begin{cases}\nD_1  \\text{for } 0 \\le y  \\ell_m \\\\\nD_2  \\text{for } \\ell_m \\le y  2\\ell_m\n\\end{cases}\n$$\n该平均值计算如下：\n$$\nD^{\\ast} = \\langle D(y) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy = \\frac{1}{2\\ell_m} \\left( \\int_{0}^{\\ell_m} D_1 \\, dy + \\int_{\\ell_m}^{2\\ell_m} D_2 \\, dy \\right)\n$$\n计算积分：\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 [y]_{0}^{\\ell_m} + D_2 [y]_{\\ell_m}^{2\\ell_m} \\right) = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 (2\\ell_m - \\ell_m) \\right)\n$$\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 \\ell_m \\right) = \\frac{\\ell_m (D_1 + D_2)}{2\\ell_m}\n$$\n简化表达式，我们得到最终结果：\n$$\nD^{\\ast} = \\frac{D_1 + D_2}{2}\n$$\n这个结果，即扩散系数的算术平均值，是平行于层状介质分层方向的有效输运的经典结果。正如预期的那样，反应速率 $k$ 没有出现在结果中。层厚 $\\ell_m$ 因为各层厚度相等而被消去。",
            "answer": "$$\n\\boxed{\\frac{D_1 + D_2}{2}}\n$$"
        },
        {
            "introduction": "在简单的层状系统之上，本练习将探讨自然介质中一种更常见的场景：优先流。您将设计一个计算模型，用以量化快速流动的通道如何绕过周围基质中的反应性矿物。此练习演示了如何结合平流、扩散和统计几何学的原理，来创建一个评估输运限制反应的实用诊断工具。",
            "id": "4105884",
            "problem": "考虑一个多孔介质，其中包含嵌入在静止或缓慢移动基质中的平流优先流通道。一种水溶质以恒定速度 $v$ 沿长度为 $L$ 的直通道段输运，其在水相中的分子扩散系数为 $D$。反应性矿物表面分布在基质中，与通道中最近的活性流线的距离为 $d \\ge 0$。假设距离 $d$ 的分布为速率为 $\\lambda$ (单位为 $\\mathrm{m}^{-1}$) 的指数分布，因此距离的概率密度为 $p(d) = \\lambda e^{-\\lambda d}$，$d \\ge 0$。基质中反应性矿物的几何表面积（在准平衡混合条件下可及的面积）为 $A_{\\mathrm{geo}}$ (单位为 $\\mathrm{m}^2$）。内在表面反应速率常数为 $k_s$ (单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）。通道的横截面积为 $S$ (单位为 $\\mathrm{m}^2$），产生的平流体积流量为 $Q = v S$ (单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$）。\n\n从基本定律和定义出发，设计一种诊断性升尺度计算方法，以量化优先流绕流如何减少有效反应表面积 $A_{\\mathrm{eff}}$，以及在高佩克莱数条件下这种减少如何抑制反应。您的计算必须基于以下原则：\n- 佩克莱数 (Pe) 定义为 $Pe = \\dfrac{v L}{D}$。\n- 流体元在通道段内的停留时间 $t_{\\mathrm{res}}$ (单位为 $\\mathrm{s}$) 由平流运动学得到。\n- 在停留时间内，进入基质的一维扩散均方根穿透距离是根据菲克扩散推导出的 $D$ 和 $t_{\\mathrm{res}}$ 的函数。\n- 在通过过程中可及的反应表面分数是距离 $d$ 小于或等于扩散穿透距离的概率。\n- 有效反应表面积 $A_{\\mathrm{eff}}$ 是可及表面积分数乘以 $A_{\\mathrm{geo}}$。\n- 使用 $k_s$、$A_{\\mathrm{eff}}$ 和 $Q$，构建一个用于诊断可及性限制反应能力的无量纲指标，该指标是最大表面反应去除速率与平流溶质供应速率之比。\n\n实现一个程序，对下面定义的每个测试用例，计算：\n1. 反应表面的可及分数，$f_{\\mathrm{acc}}$ (无量纲)，以及\n2. 可及性限制的丹科勒度量，$\\mathrm{Da}_{\\mathrm{acc}}$ (无量纲)，定义为通道段上总表面反应能力与平流供应能力之比。\n\n所有参数使用以下单位：$L$ 单位为 $\\mathrm{m}$，$v$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D$ 单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\lambda$ 单位为 $\\mathrm{m}^{-1}$，$k_s$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$A_{\\mathrm{geo}}$ 单位为 $\\mathrm{m}^2$，$S$ 单位为 $\\mathrm{m}^2$。以小数（浮点数）形式表示输出。不涉及角度单位。\n\n测试套件（每个用例是一个元组 $(L, v, D, \\lambda, k_s, A_{\\mathrm{geo}}, S)$）：\n- 用例1（一般高 $Pe$ 值，中等可及性）：$(0.1, 0.5, 1.0\\times 10^{-9}, 5000.0, 1.0\\times 10^{-5}, 12.0, 2.0\\times 10^{-4})$\n- 用例2（长停留时间，较高可及分数）：$(0.1, 1.0\\times 10^{-3}, 1.0\\times 10^{-9}, 3000.0, 5.0\\times 10^{-6}, 8.0, 1.0\\times 10^{-4})$\n- 用例3（极高 $Pe$ 值，极小穿透距离）：$(0.05, 2.0, 1.0\\times 10^{-9}, 10000.0, 1.0\\times 10^{-5}, 15.0, 3.0\\times 10^{-4})$\n- 用例4（低速，接近完全可及）：$(0.1, 1.0\\times 10^{-4}, 1.0\\times 10^{-9}, 2000.0, 1.0\\times 10^{-5}, 5.0, 1.0\\times 10^{-4})$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例的结果是一个双元素列表 $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$。例如，结构必须像 $[[f_1, \\mathrm{Da}_1],[f_2, \\mathrm{Da}_2],[f_3, \\mathrm{Da}_3],[f_4, \\mathrm{Da}_4]]$。",
            "solution": "目标是建立一个有原则的诊断方法，用于捕捉优先流条件下受可及性限制的反应。出发点是区分沿通道的平流和向相邻基质的扩散。优先流导致流线绕过位于基质中距离为 $d$ 的部分反应表面。在高佩克莱数下，平流作用主导扩散作用，减少了溶质扩散到基质中的可用时间，从而降低了单次通过过程中可及的反应表面分数。\n\n我们从基本定义和定律开始：\n\n1. 佩克莱数（无量纲）定义为\n$$ Pe = \\frac{v L}{D}, $$\n其中 $v$ 是平流速度，$L$ 是沿通道的特征长度，$D$ 是分子扩散系数。大的 $Pe$ 值表示平流主导的输运。\n\n2. 流体穿过通道段的停留时间 $t_{\\mathrm{res}}$ 直接从平流运动学获得：\n$$ t_{\\mathrm{res}} = \\frac{L}{v}. $$\n\n3. 一维菲克扩散产生一个均值为零、方差为 $2 D t$ 的高斯位移分布。在有限时间内溶质能穿透到基质多远的常规度量是均方根位移\n$$ \\ell = \\sqrt{2 D t_{\\mathrm{res}}} = \\sqrt{2 D \\frac{L}{v}} = L \\sqrt{\\frac{2}{Pe}}. $$\n这个 $\\ell$ 作为单次通过可及性的保守诊断穿透距离：在 $t_{\\mathrm{res}}$ 期间，距离 $d \\le \\ell$ 的反应表面可以被接触到，而那些 $d > \\ell$ 的则被有效绕过。\n\n4. 距离 $d$ 的分布被指定为速率为 $\\lambda$ 的指数分布，即\n$$ p(d) = \\lambda e^{-\\lambda d}, \\quad d \\ge 0. $$\n可及分数是 $d \\le \\ell$ 的概率，通过以下方式计算\n$$ f_{\\mathrm{acc}} = \\int_0^{\\ell} p(d)\\, \\mathrm{d}d = \\int_0^{\\ell} \\lambda e^{-\\lambda d} \\, \\mathrm{d}d = 1 - e^{-\\lambda \\ell}. $$\n该分数严格位于区间 $[0,1]$ 内，并随 $\\ell$ 的减小而减小。特别地，当 $Pe \\to \\infty$ 时，$\\ell \\to 0$ 且 $f_{\\mathrm{acc}} \\to 0$（小 $\\ell$ 的渐近行为为 $f_{\\mathrm{acc}} \\sim \\lambda \\ell$），反映了强烈的绕流效应。当 $Pe$ 减小（或 $v$ 减小）时，$\\ell$ 增大，$f_{\\mathrm{acc}}$ 接近 1，表明接近完全可及。\n\n5. 那么有效反应表面积为\n$$ A_{\\mathrm{eff}} = f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}. $$\n\n6. 为了诊断相对于平流供应的可及性限制反应能力，考虑一个类似于丹科勒数的容量比，该比值由最大表面反应去除速率和通过通道的平流溶质供应速率构成。体积流量为 $Q = v S$。表面反应可以去除溶质的最大速率（假设在可及表面有足够的浓度）与 $k_s A_{\\mathrm{eff}}$ 成正比。一个无量纲的诊断指标是\n$$ \\mathrm{Da}_{\\mathrm{acc}} = \\frac{k_s A_{\\mathrm{eff}}}{Q} = \\frac{k_s \\, f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}}{v S}. $$\n当 $\\mathrm{Da}_{\\mathrm{acc}} \\ll 1$ 时，反应能力与平流供应相比很小，表明在一次通过中反应受到强烈的可及性限制。当 $\\mathrm{Da}_{\\mathrm{acc}} \\gg 1$ 时，可及表面反应能力可以显著影响通过通道平流输运的溶质。\n\n为每个测试用例计算输出的算法步骤：\n- 计算 $t_{\\mathrm{res}} = L/v$。\n- 计算 $\\ell = \\sqrt{2 D t_{\\mathrm{res}}}$。\n- 计算 $f_{\\mathrm{acc}} = 1 - e^{-\\lambda \\ell}$。\n- 计算 $A_{\\mathrm{eff}} = f_{\\mathrm{acc}} A_{\\mathrm{geo}}$。\n- 计算 $Q = v S$。\n- 计算 $\\mathrm{Da}_{\\mathrm{acc}} = (k_s A_{\\mathrm{eff}})/Q$。\n\n该序列遵循第一性原理：停留时间来自运动学，扩散长度来自菲克扩散，可及分数来自给定的微观结构距离分布，容量比来自反应动力学和流动。它直接量化了优先流绕流（大 $Pe$ 值）如何通过缩小的 $\\ell$ 来减少 $A_{\\mathrm{eff}}$，并相应地降低 $\\mathrm{Da}_{\\mathrm{acc}}$。\n\n将此方法应用于问题陈述中指定的四个测试用例，会为每个用例生成一个双元素结果列表 $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$，程序将以要求的单行格式输出这些结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S):\n    \"\"\"\n    Compute the accessible fraction of reactive surface and the accessibility-limited Damköhler metric.\n\n    Parameters:\n        L (float): Channel length [m]\n        v (float): Advective velocity [m/s]\n        D (float): Molecular diffusivity [m^2/s]\n        lam (float): Exponential rate for distance distribution [1/m]\n        k_s (float): Intrinsic surface reaction rate constant [m/s]\n        A_geo (float): Geometric reactive surface area [m^2]\n        S (float): Channel cross-sectional area [m^2]\n\n    Returns:\n        (f_acc, Da_acc): Tuple of floats, accessible fraction and Damköhler metric (dimensionless).\n    \"\"\"\n    # Residence time from kinematics: t_res = L / v\n    t_res = L / v\n\n    # Diffusive root-mean-square penetration distance: ell = sqrt(2 D t_res)\n    ell = np.sqrt(2.0 * D * t_res)\n\n    # Accessible fraction for exponential distance distribution: f_acc = 1 - exp(-lam * ell)\n    f_acc = 1.0 - np.exp(-lam * ell)\n\n    # Effective surface area\n    A_eff = f_acc * A_geo\n\n    # Volumetric flow rate\n    Q = v * S\n\n    # Accessibility-limited Damköhler metric\n    Da_acc = (k_s * A_eff) / Q\n\n    return float(f_acc), float(Da_acc)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (L, v, D, lambda, k_s, A_geo, S)\n    test_cases = [\n        (0.1, 0.5, 1.0e-9, 5000.0, 1.0e-5, 12.0, 2.0e-4),\n        (0.1, 1.0e-3, 1.0e-9, 3000.0, 5.0e-6, 8.0, 1.0e-4),\n        (0.05, 2.0, 1.0e-9, 10000.0, 1.0e-5, 15.0, 3.0e-4),\n        (0.1, 1.0e-4, 1.0e-9, 2000.0, 1.0e-5, 5.0, 1.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, v, D, lam, k_s, A_geo, S = case\n        f_acc, Da_acc = compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S)\n        results.append([f_acc, Da_acc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这项高级练习深入探讨了反应输运升尺度研究中的一个核心挑战：闭合问题。当反应物最初因非均质流动而被隔离时，它们的有效反应速率并不能简单地用其平均浓度的乘积来表示。本问题使用一个双区域模型来推导有效速率系数的偏差，揭示了混合与反应速率之间的相互作用（由丹科勒数$Da$表征）如何控制宏观系统的行为。",
            "id": "4105938",
            "problem": "考虑一个统计均匀的多孔介质，其中未解析的小尺度速度非均质性造成了两个体积分数相等的相互连通的子区域。假设物种 $A$ 和 $B$ 发生不可逆双分子反应 $A + B \\rightarrow C$，其微观速率系数为 $k$。在代表性单元体积 (REV) 尺度上，使用双区域交换模型来捕捉水动力弥散与化学反应之间的耦合：每个物种以一阶区域间混合速率 $\\lambda$ 在两个区域之间进行交换。假设在时间 $t=0$ 时，物种 $A$ 仅占据区域 $1$，浓度为 $c_{A0}=C_0$；物种 $B$ 仅占据区域 2，浓度为 $c_{B0}=C_0$，而其他区域的初始浓度为零。\n\n每单位体积的升尺度平均反应速率定义为 $R_{\\text{mean}}(t) = \\overline{k\\,c_A c_B}$，其中上划线表示对两个区域的平均。有效升尺度反应速率系数 $k_{\\text{eff}}(t)$ 由闭合项 $R_{\\text{mean}}(t) = k_{\\text{eff}}(t)\\,\\overline{c_A}(t)\\,\\overline{c_B}(t)$ 定义。Damköhler 数（反应与混合比率的无量纲度量）定义为 $Da = \\dfrac{k\\,C_0}{\\lambda}$。\n\n从质量守恒和一阶区域间混合的定义出发，且不使用任何预先推导的升尺度公式，推导有效速率系数的偏差 $\\Delta k \\equiv k_{\\text{eff}} - k$ 的主阶解析表达式。该偏差需在平均反应速率 $R_{\\text{mean}}(t)$ 达到其最大值时的无量纲时间 $\\tau_* = \\lambda t_*$ 处进行评估。假设 $Da = O(1)$，并从第一性原理出发，证明所用任何近似的合理性。将最终答案表示为 $Da$ 和 $k$ 的闭式解析函数。无需进行数值计算。最终答案必须是单一的解析表达式。最终答案无需单位。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法得当。\n\n### 步骤 1：提取已知条件\n- **系统**：一个统计均匀的多孔介质，包含两个相互连通的子区域（区域 1 和区域 2），二者体积分数相等（各占 1/2）。\n- **反应**：一个不可逆双分子反应 $A + B \\rightarrow C$。\n- **微观速率系数**：$k$。\n- **模型**：一个双区域交换模型，具有一阶区域间混合速率 $\\lambda$。\n- **初始条件 (t=0)**：\n    - 物种 $A$：$c_{A,1}(0) = C_0$, $c_{A,2}(0) = 0$。\n    - 物种 $B$：$c_{B,1}(0) = 0$, $c_{B,2}(0) = C_0$。\n- **定义**：\n    - 平均反应速率：$R_{\\text{mean}}(t) = \\overline{k\\,c_A c_B} = \\frac{1}{2}k(c_{A,1}c_{B,1} + c_{A,2}c_{B,2})$。\n    - 有效速率系数：$R_{\\text{mean}}(t) = k_{\\text{eff}}(t)\\,\\overline{c_A}(t)\\,\\overline{c_B}(t)$，其中 $\\overline{c_i}(t) = \\frac{1}{2}(c_{i,1}(t) + c_{i,2}(t))$。\n    - Damköhler 数：$Da = \\frac{k\\,C_0}{\\lambda}$。\n- **目标**：推导偏差 $\\Delta k \\equiv k_{\\text{eff}}(t) - k$ 的主阶解析表达式。\n- **评估时间**：偏差需在无量纲时间 $\\tau_* = \\lambda t_*$ 处进行评估，其中 $t_*$ 是平均反应速率 $R_{\\text{mean}}(t)$ 达到其最大值的时间。\n- **假设**：$Da = O(1)$。任何近似都必须进行合理解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在多孔介质中反应输运理论中有充分的依据，特别地，它处理了在存在亚尺度非均质性和不完全混合的情况下，对表观反应速率进行升尺度的既定概念。双区域模型是用于此目的的标准概念工具。\n- **适定性**：该问题明确了一个具有清晰初始条件和定义的常微分方程组，从而可得到唯一解。目标陈述明确。\n- **客观性**：问题以精确、客观和定量的方式陈述。\n- **完整性和一致性**：所有必需的参数（$k$、$\\lambda$、$C_0$）、初始条件和定义均已提供。不存在矛盾之处。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将从第一性原理出发推导解答。\n\n### 解答推导\n\n物种 $A$ 和 $B$ 在区域 1 和 2 中的质量守恒由以下耦合常微分方程组 (ODEs) 描述：\n$$ \\frac{d c_{A,1}}{dt} = -k c_{A,1} c_{B,1} + \\lambda (c_{A,2} - c_{A,1}) $$\n$$ \\frac{d c_{A,2}}{dt} = -k c_{A,2} c_{B,2} + \\lambda (c_{A,1} - c_{A,2}) $$\n$$ \\frac{d c_{B,1}}{dt} = -k c_{A,1} c_{B,1} + \\lambda (c_{B,2} - c_{B,1}) $$\n$$ \\frac{d c_{B,2}}{dt} = -k c_{A,2} c_{B,2} + \\lambda (c_{B,1} - c_{B,2}) $$\n初始条件为 $c_{A,1}(0) = C_0$, $c_{A,2}(0) = 0$, $c_{B,1}(0) = 0$, $c_{B,2}(0) = C_0$。\n\n由于控制方程和初始条件的对称性，可以证明对于所有 $t \\ge 0$，$c_{A,1}(t) = c_{B,2}(t)$ 且 $c_{A,2}(t) = c_{B,1}(t)$。我们定义 $c_1(t) \\equiv c_{A,1}(t) = c_{B,2}(t)$ 和 $c_2(t) \\equiv c_{A,2}(t) = c_{B,1}(t)$。四个常微分方程组简化为两个：\n$$ \\frac{dc_1}{dt} = -k c_1 c_2 + \\lambda(c_2 - c_1) $$\n$$ \\frac{dc_2}{dt} = -k c_1 c_2 + \\lambda(c_1 - c_2) $$\n初始条件为 $c_1(0) = C_0$ 和 $c_2(0) = 0$。\n\n平均浓度是相同的：$\\overline{c_A}(t) = \\overline{c_B}(t) = \\frac{1}{2}(c_1(t) + c_2(t))$。平均反应速率为 $R_{\\text{mean}}(t) = \\frac{1}{2}k(c_{A,1}c_{B,1} + c_{A,2}c_{B,2}) = \\frac{1}{2}k(c_1 c_2 + c_2 c_1) = k c_1 c_2$。\n根据有效速率系数的定义，有 $k c_1 c_2 = k_{\\text{eff}} \\left( \\frac{c_1+c_2}{2} \\right)^2$。\n解出 $k_{\\text{eff}}$ 得 $k_{\\text{eff}}(t) = k \\frac{4c_1 c_2}{(c_1+c_2)^2}$。\n偏差 $\\Delta k$ 则为：\n$$ \\Delta k(t) = k_{\\text{eff}}(t) - k = k \\left( \\frac{4c_1 c_2}{(c_1+c_2)^2} - 1 \\right) = -k \\frac{(c_1-c_2)^2}{(c_1+c_2)^2} $$\n\n为分析该系统，我们引入和变量与差变量，$S(t) = c_1(t)+c_2(t)$ 和 $D(t) = c_1(t)-c_2(t)$。$S$ 和 $D$ 的常微分方程为：\n$$ \\frac{dS}{dt} = \\frac{dc_1}{dt} + \\frac{dc_2}{dt} = -2k c_1 c_2 = - \\frac{k}{2}(S^2 - D^2) $$\n$$ \\frac{dD}{dt} = \\frac{dc_1}{dt} - \\frac{dc_2}{dt} = -2\\lambda(c_1-c_2) = -2\\lambda D $$\n初始条件为 $S(0) = C_0$ 和 $D(0) = C_0$。\n$D(t)$ 的方程很容易解出：$D(t) = C_0 \\exp(-2\\lambda t)$。\n偏差可以写成 $\\Delta k(t) = -k \\frac{D(t)^2}{S(t)^2}$。\n\n我们使用 $\\tau = \\lambda t$、$\\hat{c}(\\tau) = c(t)/C_0$ 和 $Da = kC_0/\\lambda$ 对系统进行无量纲化。\n无量纲差值为 $\\hat{D}(\\tau) = D(t)/C_0 = \\exp(-2\\tau)$。\n无量纲和值 $\\hat{S}(\\tau) = S(t)/C_0$ 服从黎卡提方程：\n$$ \\frac{d\\hat{S}}{d\\tau} = -\\frac{Da}{2}(\\hat{S}^2 - \\hat{D}^2) = -\\frac{Da}{2}(\\hat{S}^2 - \\exp(-4\\tau)) $$\n其中 $\\hat{S}(0)=1$。偏差为 $\\Delta k(\\tau) = -k \\frac{\\hat{D}(\\tau)^2}{\\hat{S}(\\tau)^2} = -k \\frac{\\exp(-4\\tau)}{\\hat{S}(\\tau)^2}$。\n\n我们必须在平均反应速率最大时的时间 $\\tau_*$ 处评估 $\\Delta k$。\n$R_{\\text{mean}}(\\tau) = k c_1 c_2 = k C_0^2 \\hat{c}_1 \\hat{c}_2 = \\frac{k C_0^2}{4}(\\hat{S}^2 - \\hat{D}^2) = \\frac{k C_0^2}{4}(\\hat{S}(\\tau)^2 - \\exp(-4\\tau))$。\n为了找到最大值，我们将其对 $\\tau$ 的导数设为零：\n$$ \\frac{dR_{\\text{mean}}}{d\\tau} = \\frac{k C_0^2}{4} \\left( 2\\hat{S}\\frac{d\\hat{S}}{d\\tau} + 4\\exp(-4\\tau) \\right) = 0 $$\n代入 $d\\hat{S}/d\\tau$ 的表达式：\n$$ 2\\hat{S}\\left(-\\frac{Da}{2}(\\hat{S}^2 - \\exp(-4\\tau))\\right) + 4\\exp(-4\\tau) = 0 $$\n在 $\\tau = \\tau_*$ 时，这给出：\n$$ -Da\\,\\hat{S}(\\tau_*)(\\hat{S}(\\tau_*)^2 - \\exp(-4\\tau_*)) + 4\\exp(-4\\tau_*) = 0 $$\n$$ Da\\,\\hat{S}(\\tau_*)^3 = (Da\\,\\hat{S}(\\tau_*) + 4)\\exp(-4\\tau_*) $$\n从这个条件，我们可以表示出 $\\exp(-4\\tau_*)$：\n$$ \\exp(-4\\tau_*) = \\frac{Da\\,\\hat{S}(\\tau_*)^3}{Da\\,\\hat{S}(\\tau_*) + 4} $$\n现在，将此代入 $\\tau=\\tau_*$ 时的偏差表达式中：\n$$ \\Delta k(\\tau_*) = -k \\frac{\\exp(-4\\tau_*)}{\\hat{S}(\\tau_*)^2} = -k \\frac{1}{\\hat{S}(\\tau_*)^2} \\left( \\frac{Da\\,\\hat{S}(\\tau_*)^3}{Da\\,\\hat{S}(\\tau_*) + 4} \\right) $$\n$$ \\Delta k(\\tau_*) = -k \\frac{Da\\,\\hat{S}(\\tau_*)}{Da\\,\\hat{S}(\\tau_*) + 4} $$\n该表达式仍然依赖于未知值 $\\hat{S}(\\tau_*)$，这需要解黎卡提方程。为了获得所要求的主阶解析表达式，需要进行近似。\n\n问题陈述 $Da = O(1)$，这排除了在 $Da$ 中进行渐近展开的可能性。最具物理意义的近似是考虑系统在反应速率最大时的状态。这个最大值出现在混合过程（将反应物聚集在一起）和反应过程（消耗反应物）之间的最佳平衡点。在这个特定时间 $\\tau_*$，我们假定总反应物的整体消耗尚不显著。\n这通过主阶近似 $\\hat{S}(\\tau_*) \\approx 1$ 来形式化。\n该近似假设在速率达到峰值的瞬间，反应物的总无量纲浓度 $\\hat{S} = (c_A+c_B)_{avg}/C_0$ 仍然接近其初始值 1。其合理性在于，将峰值速率时间视为初始混合限制阶段的特征，此时尚未发生显著的全局反应物消耗。通过在极限情况下检查所得表达式，可以增强此近似的有效性：对于慢反应（$Da \\to 0$），偏差正确地趋于零（良好混合极限）；对于快反应（$Da \\to \\infty$），偏差正确地趋近于 $-k$（完全分离，混合限制极限）。一个能在这些物理极限之间正确插值的表达式，是当 $Da = O(1)$ 时所需主阶结果的有力候选。\n\n将近似 $\\hat{S}(\\tau_*) \\approx 1$ 应用于推导出的偏差表达式，我们得到：\n$$ \\Delta k(\\tau_*) \\approx -k \\frac{Da \\cdot (1)}{Da \\cdot (1) + 4} $$\n$$ \\Delta k(\\tau_*) \\approx -k \\frac{Da}{Da + 4} $$\n这就是在平均反应速率最大时评估的、作为 $Da$ 和 $k$ 的函数的、有效速率系数偏差所要求的主阶解析表达式。",
            "answer": "$$\\boxed{-k \\frac{Da}{Da + 4}}$$"
        }
    ]
}