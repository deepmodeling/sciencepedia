{
    "hands_on_practices": [
        {
            "introduction": "第一个练习为尺度放大的数学原理提供了一个基础入门。通过考虑一个理想化的分层介质，我们将解析推导平行于层理方向传输的有效扩散系数。该练习阐释了体积平均法的原理，并揭示了在快速横向混合的关键假设下，简单的算术平均值是如何作为有效参数出现的。",
            "id": "4105929",
            "problem": "在计算地球化学中，考虑一个代表沉积地层的二维分层多孔介质。该介质占据一个具有纵向坐标 $x$ 和横向坐标 $y$ 的区域。$y$ 方向的横截面由交替层的周期性重复构成，每层厚度相等，为 $\\ell_m$。一个薄层中的局部自分子扩散系数为 $D_1$，相邻薄层中的为 $D_2$，从而形成一个周期为 $2\\ell_m$ 的结构。一种浓度为 $c(x,y,t)$ 的溶解、非平流的地球化学物质在整个介质中进行扩散，并发生速率常数为 $k$ 的均匀一级反应。\n\n在微观尺度上，输运遵循物质守恒方程和菲克定律：\n$$\n\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c, \\quad \\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c,\n$$\n其中，$D(y)$ 在 $y$ 方向上是分段常数，在每个厚度为 $\\ell_m$ 的层之间于 $D_1$ 和 $D_2$ 之间交替变化。\n\n假设满足以下横向混合条件：在单个薄层厚度 $\\ell_m$ 上的横向扩散相对于宏观纵向演化的特征时间足够快，以至于在所关注的时间尺度上，$c(x,y,t)$ 在每个 $x$ 处沿 $y$ 方向变得均匀，即在升尺度描述中 $\\partial c/\\partial y \\approx 0$。因此，在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 与 $y$ 无关。\n\n将代表性单元体积 (REV) 定义为一个完整的分层周期单元，其在 $y$ 方向的宽度为 $2\\ell_m$，在 $z$ 方向的厚度为单位厚度，并令 $\\langle \\cdot \\rangle$ 表示在该 REV 上的 $y$ 方向平均。沿 $x$ 方向的升尺度一维模型通过本构关系，用横截面平均浓度 $\\langle c \\rangle(x,t)$ 和有效扩散系数 $D^{\\ast}$ 来表示：\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x},\n$$\n其中 $J(x,t)$ 是微观通量 $j_x(x,y,t)$ 纵向分量的 $y$ 方向平均值。\n\n从上述基本定律和横向混合假设出发，推导沿 $x$ 方向纵向输运的有效扩散系数 $D^{\\ast}$（用 $D_1$、$D_2$ 和 $\\ell_m$ 表示），并计算 $D^{\\ast}$。将最终答案表示为闭式解析表达式。无需四舍五入。最终方框内的答案不需要单位，但 $D_1$ 和 $D_2$ 是分子扩散系数，其单位为（长度的平方/时间）。",
            "solution": "用户希望在横向混合假设下，推导分层多孔介质的有效纵向扩散系数 $D^{\\ast}$。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **几何结构：** 一个具有纵向坐标 $x$ 和横向坐标 $y$ 的二维区域。介质由等厚度 $\\ell_m$ 的交替层的周期性重复构成。在 $y$ 方向的周期为 $2\\ell_m$。\n*   **物理性质：** 局部分子扩散系数 $D(y)$ 是分段常数，在相邻层之间于 $D_1$ 和 $D_2$ 之间交替。\n*   **输运过程：** 一种浓度为 $c(x,y,t)$ 的溶解、非平流物质进行扩散，并发生速率常数为 $k$ 的均匀一级反应。\n*   **微观尺度方程：**\n    *   守恒方程: $\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c$\n    *   微观通量 (菲克定律): $\\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c$\n*   **升尺度假设 (横向混合)：**\n    *   横向扩散足够快，以至于在所关注的时间尺度上，$c(x,y,t)$ 在每个 $x$ 处沿 $y$ 方向是均匀的，这意味着在升尺度描述中 $\\partial c/\\partial y \\approx 0$。\n    *   一个直接的推论是，在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 与 $y$ 无关。\n*   **升尺度模型定义：**\n    *   **平均算子：** $\\langle \\cdot \\rangle$ 表示在宽度为 $2\\ell_m$ 的一个周期单元上的 $y$ 方向平均。\n    *   **平均浓度：** $\\langle c \\rangle(x,t)$\n    *   **平均通量：** $J(x,t) = \\langle j_x(x,y,t) \\rangle$，其中 $j_x$ 是微观通量 $\\mathbf{j}$ 的纵向分量。\n    *   **有效本构关系：** $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$，此式定义了有效扩散系数 $D^{\\ast}$。\n*   **目标：** 推导用 $D_1$ 和 $D_2$ 表示的 $D^{\\ast}$ 表达式。\n\n**1.2. 验证分析**\n\n*   **科学依据：** 该问题基于菲克扩散和反应动力学的成熟原理。对于非均质介质，使用体积平均法推导有效参数是输运现象、水文地质学和计算地球化学中的一种标准且严谨的技术。该问题在科学上是合理的。\n*   **适定性：** 该问题提供了一个清晰的微观尺度模型、一个特定的升尺度假设和一个明确定义的目标。“横向混合”假设将问题简化为一个易于处理的、适定的状态，代表了输运理论中一个有效且重要的极限情况（类似于横向平衡远快于纵向输运的极限）。\n*   **客观性：** 问题的陈述精确、客观且定量，没有歧义或主观内容。\n*   **一致性与完整性：** 问题是自洽的。所提供的关键假设——$\\partial c/\\partial x$ 与 $y$ 无关——足以进行推导。速率常数为 $k$ 的反应项的存在不会造成矛盾或不完整，因为有效扩散系数 $D^{\\ast}$ 是将通量与浓度梯度关联起来的介质本构属性，它与反应源/汇项无关。推导过程将表明 $k$ 不影响 $D^{\\ast}$。参数 $\\ell_m$ 是问题描述的一部分，并将在推导中使用，尽管它可能会在最终结果中被消掉。\n\n**1.3. 结论**\n\n该问题是 **有效的**。这是一个关于输运参数升尺度的适定、科学合理的问题，适合进行严谨的推导。\n\n### 步骤 2：有效扩散系数的推导\n\n目标是求出有效扩散系数 $D^{\\ast}$，它由平均纵向通量 $J(x,t)$ 的升尺度本构关系定义：\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\n平均通量 $J(x,t)$ 是微观纵向通量 $j_x(x,y,t)$ 在代表性单元体积 (REV) 上的空间平均。REV 是一个宽度为 $2\\ell_m$ 的周期单元。\n$$\nJ(x,t) = \\langle j_x(x,y,t) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} j_x(x,y,t) \\, dy\n$$\n微观纵向通量 $j_x$ 由菲克定律给出：\n$$\nj_x(x,y,t) = -D(y) \\frac{\\partial c}{\\partial x}\n$$\n将此代入平均通量的表达式中，得到：\n$$\nJ(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\left( -D(y) \\frac{\\partial c}{\\partial x} \\right) \\, dy = \\left\\langle -D(y) \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\n问题陈述了横向混合假设的一个关键推论：“在任何固定的 $x$ 处，纵向梯度 $\\partial c/\\partial x$ 与 $y$ 无关。” 这使我们可以将项 $\\frac{\\partial c}{\\partial x}$ 视为相对于积分变量 $y$ 的常数。因此，可以将其从积分中提出：\n$$\nJ(x,t) = -\\frac{\\partial c}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy \\right) = -\\frac{\\partial c}{\\partial x} \\langle D(y) \\rangle\n$$\n接下来，我们必须将微观梯度 $\\frac{\\partial c}{\\partial x}$ 与平均浓度的梯度 $\\frac{\\partial \\langle c \\rangle}{\\partial x}$ 联系起来。平均浓度的定义为：\n$$\n\\langle c \\rangle(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy\n$$\n对 $x$ 求导，并应用莱布尼茨积分法则（因为积分限相对于 $x$ 是常数）：\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy \\right) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\frac{\\partial c}{\\partial x}(x,y,t) \\, dy = \\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\n再次利用 $\\frac{\\partial c}{\\partial x}$ 与 $y$ 无关这一事实，它在 $y$ 上的平均值就是其自身：\n$$\n\\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle = \\frac{\\partial c}{\\partial x}\n$$\n因此，我们建立了以下等式：\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial c}{\\partial x}\n$$\n将此结果代入我们的平均通量 $J(x,t)$ 表达式中：\n$$\nJ(x,t) = -\\frac{\\partial \\langle c \\rangle}{\\partial x} \\langle D(y) \\rangle\n$$\n通过将这个推导出的 $J(x,t)$ 表达式与有效扩散系数的定义 $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$ 进行比较，我们可以直接确定 $D^{\\ast}$：\n$$\n-D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x} = -\\langle D(y) \\rangle \\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\n这得出的结论是，有效扩散系数是微观扩散系数在 REV 上的算术平均值。\n$$\nD^{\\ast} = \\langle D(y) \\rangle\n$$\n最后一步是计算这个平均值。介质由等厚度 $\\ell_m$ 的交替层组成。在一个宽度为 $2\\ell_m$ 的周期内，有一个厚度为 $\\ell_m$、扩散系数为 $D_1$ 的层，以及一个厚度为 $\\ell_m$、扩散系数为 $D_2$ 的相邻层。\n$$\nD(y) =\n\\begin{cases}\nD_1  \\text{for } 0 \\le y  \\ell_m \\\\\nD_2  \\text{for } \\ell_m \\le y  2\\ell_m\n\\end{cases}\n$$\n平均值计算如下：\n$$\nD^{\\ast} = \\langle D(y) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy = \\frac{1}{2\\ell_m} \\left( \\int_{0}^{\\ell_m} D_1 \\, dy + \\int_{\\ell_m}^{2\\ell_m} D_2 \\, dy \\right)\n$$\n计算积分：\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 [y]_{0}^{\\ell_m} + D_2 [y]_{\\ell_m}^{2\\ell_m} \\right) = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 (2\\ell_m - \\ell_m) \\right)\n$$\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 \\ell_m \\right) = \\frac{\\ell_m (D_1 + D_2)}{2\\ell_m}\n$$\n简化表达式，我们得到最终结果：\n$$\nD^{\\ast} = \\frac{D_1 + D_2}{2}\n$$\n这个结果，即扩散系数的算术平均值，是分层介质中平行于分层方向的有效输运的经典结果。正如预期的那样，反应速率 $k$ 没有出现在结果中。层厚 $\\ell_m$ 因为各层厚度相等而被消掉了。",
            "answer": "$$\n\\boxed{\\frac{D_1 + D_2}{2}}\n$$"
        },
        {
            "introduction": "现实世界的多孔介质通常具有优势流路径，导致流体绕过大部分反应性岩石基质。这个计算练习旨在挑战您开发一个模型来量化这种传输限制。通过关联平流和扩散的特征时间尺度，您将计算出“有效”的反应表面积，从而深入理解为何现场尺度的反应速率可能远低于实验室测量值。",
            "id": "4105884",
            "problem": "考虑一个多孔介质，其中包含嵌入在停滞或缓慢移动基质中的平流优先流通道。一种水溶质沿着长度为 $L$ 的直通道段以恒定速度 $v$ 输运，其在水相中的分子扩散系数为 $D$。反应性矿物表面分布在基质中，与通道中最近的活动流线相距 $d \\ge 0$。假设距离 $d$ 的分布是速率为 $\\lambda$（单位为 $\\mathrm{m}^{-1}$）的指数分布，因此对于 $d \\ge 0$，距离的概率密度为 $p(d) = \\lambda e^{-\\lambda d}$。基质中反应性矿物的几何表面积（在准平衡混合条件下可及的面积）为 $A_{\\mathrm{geo}}$（单位为 $\\mathrm{m}^2$）。内在表面反应速率常数为 $k_s$（单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）。通道的横截面积为 $S$（单位为 $\\mathrm{m}^2$），产生的平流体积流量为 $Q = v S$（单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$）。\n\n从基本定律和定义出发，设计一个诊断性升尺度计算，以量化优先流旁路如何减少有效反应表面积 $A_{\\mathrm{eff}}$，以及在高佩克莱特数条件下这种减少如何抑制反应。您的计算必须基于以下原则：\n- 佩克莱特数（Pe）定义为 $Pe = \\dfrac{v L}{D}$。\n- 流体单元在通道段中的停留时间 $t_{\\mathrm{res}}$（单位为 $\\mathrm{s}$）由平流运动学获得。\n- 在停留时间内，进入基质的一维扩散均方根穿透距离是根据菲克扩散推导出的关于 $D$ 和 $t_{\\mathrm{res}}$ 的函数。\n- 在单次通过过程中可及的反应表面分数是距离 $d$ 小于或等于扩散穿透距离的概率。\n- 有效反应表面积 $A_{\\mathrm{eff}}$ 是可及表面积分数乘以 $A_{\\mathrm{geo}}$。\n- 使用 $k_s$、$A_{\\mathrm{eff}}$ 和 $Q$，构建一个用于可及性限制反应能力的无量纲诊断指标，该指标为最大表面反应去除速率与平流溶质供应速率之比。\n\n实现一个程序，对下面定义的每个测试用例，计算：\n1. 反应表面的可及分数，$f_{\\mathrm{acc}}$（无量纲），以及\n2. 可及性限制的丹姆科勒度量，$\\mathrm{Da}_{\\mathrm{acc}}$（无量纲），定义为通道段上总表面反应能力与平流供应能力之比。\n\n所有参数使用以下单位：$L$ 单位为 $\\mathrm{m}$，$v$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D$ 单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\lambda$ 单位为 $\\mathrm{m}^{-1}$，$k_s$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$A_{\\mathrm{geo}}$ 单位为 $\\mathrm{m}^2$，$S$ 单位为 $\\mathrm{m}^2$。将输出表示为小数（浮点数）。不涉及角度单位。\n\n测试套件（每个用例是一个元组 $(L, v, D, \\lambda, k_s, A_{\\mathrm{geo}}, S)$）：\n- 用例1（一般高 $Pe$ 值，中等可及性）：$(0.1, 0.5, 1.0\\times 10^{-9}, 5000.0, 1.0\\times 10^{-5}, 12.0, 2.0\\times 10^{-4})$\n- 用例2（长停留时间，较高可及分数）：$(0.1, 1.0\\times 10^{-3}, 1.0\\times 10^{-9}, 3000.0, 5.0\\times 10^{-6}, 8.0, 1.0\\times 10^{-4})$\n- 用例3（极高 $Pe$ 值，非常小的穿透距离）：$(0.05, 2.0, 1.0\\times 10^{-9}, 10000.0, 1.0\\times 10^{-5}, 15.0, 3.0\\times 10^{-4})$\n- 用例4（低速，接近完全可及）：$(0.1, 1.0\\times 10^{-4}, 1.0\\times 10^{-9}, 2000.0, 1.0\\times 10^{-5}, 5.0, 1.0\\times 10^{-4})$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$。例如，结构必须类似于 $[[f_1, \\mathrm{Da}_1],[f_2, \\mathrm{Da}_2],[f_3, \\mathrm{Da}_3],[f_4, \\mathrm{Da}_4]]$。",
            "solution": "目标是建立一个有原则的诊断方法，以捕捉优先流条件下受可及性限制的反应。出发点是区分沿通道的平流和向相邻基质的扩散。优先流导致流线绕过位于基质中距离为 $d$ 的部分反应表面。在高佩克莱特数下，平流主导扩散，减少了溶质扩散到基质中的可用时间，从而降低了单次通过过程中可及的反应表面分数。\n\n我们从基本定义和定律开始：\n\n1. 佩克莱特数（无量纲）定义为\n$$ Pe = \\frac{v L}{D}, $$\n其中 $v$ 是平流速度，$L$ 是沿通道的特征长度，$D$ 是分子扩散系数。大的 $Pe$ 值表示平流主导的输运。\n\n2. 流体穿过通道段的停留时间 $t_{\\mathrm{res}}$ 直接从平流运动学获得：\n$$ t_{\\mathrm{res}} = \\frac{L}{v}. $$\n\n3. 一维菲克扩散产生一个均值为零、方差为 $2 D t$ 的高斯位移分布。衡量溶质在有限时间内能穿透到基质中多远的一个标准度量是均方根位移\n$$ \\ell = \\sqrt{2 D t_{\\mathrm{res}}} = \\sqrt{2 D \\frac{L}{v}} = L \\sqrt{\\frac{2}{Pe}}. $$\n这个 $\\ell$ 作为单次通过中可及性的一个保守诊断性穿透距离：在 $t_{\\mathrm{res}}$ 期间，距离 $d \\le \\ell$ 的反应表面可以被接触到，而距离 $d  \\ell$ 的则被有效旁路。\n\n4. 距离 $d$ 的分布被指定为速率为 $\\lambda$ 的指数分布，即\n$$ p(d) = \\lambda e^{-\\lambda d}, \\quad d \\ge 0. $$\n可及分数是 $d \\le \\ell$ 的概率，通过以下方式计算\n$$ f_{\\mathrm{acc}} = \\int_0^{\\ell} p(d)\\, \\mathrm{d}d = \\int_0^{\\ell} \\lambda e^{-\\lambda d} \\, \\mathrm{d}d = 1 - e^{-\\lambda \\ell}. $$\n该分数严格位于区间 $[0,1]$ 内，并随 $\\ell$ 的减小而减小。特别是，当 $Pe \\to \\infty$ 时，$\\ell \\to 0$ 且 $f_{\\mathrm{acc}} \\to 0$（对于小 $\\ell$ 的渐近行为是 $f_{\\mathrm{acc}} \\sim \\lambda \\ell$），反映了强烈的旁路效应。随着 $Pe$ 减小（或 $v$ 减小），$\\ell$ 增大，$f_{\\mathrm{acc}}$ 接近 1，表明接近完全可及。\n\n5. 那么，有效反应表面积为\n$$ A_{\\mathrm{eff}} = f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}. $$\n\n6. 为了诊断相对于平流供应的可及性限制反应能力，可以考虑一个类似于丹姆科勒数的容量比，该比值由最大表面反应去除速率和通过通道的平流溶质供应速率构成。体积流量为 $Q = v S$。表面反应能够去除溶质的最大速率（假设在可及表面有足够的浓度）与 $k_s A_{\\mathrm{eff}}$ 成正比。一个无量纲的诊断指标是\n$$ \\mathrm{Da}_{\\mathrm{acc}} = \\frac{k_s A_{\\mathrm{eff}}}{Q} = \\frac{k_s \\, f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}}{v S}. $$\n当 $\\mathrm{Da}_{\\mathrm{acc}} \\ll 1$ 时，反应能力与平流供应相比很小，表明在单次通过中反应受到强烈的可及性限制。当 $\\mathrm{Da}_{\\mathrm{acc}} \\gg 1$ 时，可及的表面反应能力可以显著影响通过通道平流输运的溶质。\n\n为每个测试用例计算输出的算法步骤：\n- 计算 $t_{\\mathrm{res}} = L/v$。\n- 计算 $\\ell = \\sqrt{2 D t_{\\mathrm{res}}}$。\n- 计算 $f_{\\mathrm{acc}} = 1 - e^{-\\lambda \\ell}$。\n- 计算 $A_{\\mathrm{eff}} = f_{\\mathrm{acc}} A_{\\mathrm{geo}}$。\n- 计算 $Q = v S$。\n- 计算 $\\mathrm{Da}_{\\mathrm{acc}} = (k_s A_{\\mathrm{eff}})/Q$。\n\n该序列遵循第一性原理：停留时间来自运动学，扩散长度来自菲克扩散，可及分数来自给定的微观结构距离分布，容量比来自反应动力学和流动。它直接量化了优先流旁路（大 $Pe$ 值）如何通过缩小的 $\\ell$ 来减少 $A_{\\mathrm{eff}}$，并相应地降低 $\\mathrm{Da}_{\\mathrm{acc}}$。\n\n将此应用于问题陈述中指定的四个测试用例，会为每个用例生成一个双元素结果列表 $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$，程序会以所需的单行格式输出这些结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S):\n    \"\"\"\n    Compute the accessible fraction of reactive surface and the accessibility-limited Damköhler metric.\n\n    Parameters:\n        L (float): Channel length [m]\n        v (float): Advective velocity [m/s]\n        D (float): Molecular diffusivity [m^2/s]\n        lam (float): Exponential rate for distance distribution [1/m]\n        k_s (float): Intrinsic surface reaction rate constant [m/s]\n        A_geo (float): Geometric reactive surface area [m^2]\n        S (float): Channel cross-sectional area [m^2]\n\n    Returns:\n        (f_acc, Da_acc): Tuple of floats, accessible fraction and Damköhler metric (dimensionless).\n    \"\"\"\n    # Residence time from kinematics: t_res = L / v\n    t_res = L / v\n\n    # Diffusive root-mean-square penetration distance: ell = sqrt(2 D t_res)\n    ell = np.sqrt(2.0 * D * t_res)\n\n    # Accessible fraction for exponential distance distribution: f_acc = 1 - exp(-lam * ell)\n    f_acc = 1.0 - np.exp(-lam * ell)\n\n    # Effective surface area\n    A_eff = f_acc * A_geo\n\n    # Volumetric flow rate\n    Q = v * S\n\n    # Accessibility-limited Damköhler metric\n    Da_acc = (k_s * A_eff) / Q\n\n    return float(f_acc), float(Da_acc)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (L, v, D, lambda, k_s, A_geo, S)\n    test_cases = [\n        (0.1, 0.5, 1.0e-9, 5000.0, 1.0e-5, 12.0, 2.0e-4),\n        (0.1, 1.0e-3, 1.0e-9, 3000.0, 5.0e-6, 8.0, 1.0e-4),\n        (0.05, 2.0, 1.0e-9, 10000.0, 1.0e-5, 15.0, 3.0e-4),\n        (0.1, 1.0e-4, 1.0e-9, 2000.0, 1.0e-5, 5.0, 1.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, v, D, lam, k_s, A_geo, S = case\n        f_acc, Da_acc = compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S)\n        results.append([f_acc, Da_acc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这项高级练习将指导您构建一个更全面的尺度放大模型，该模型整合了反应输运与地球力学。您将实现一个计算，该计算考虑了机械应变如何改变孔隙度，进而影响有效扩散率和可用反应表面积。此实践突出了许多地球化学问题的多物理场性质，以及捕捉过程之间反馈回路的重要性。",
            "id": "4075546",
            "problem": "给定一个正在经历小体积应变的反应性多孔岩石的代表性单元体积 (REV)，其中溶解的溶质从孔隙流体扩散到反应性矿物表面，并根据线性表面动力学进行反应。目标是计算一个升尺度后的体积反应速率，该速率通过在 REV 上对孔隙尺度通量和表面反应项进行适当加权平均来包含输运限制，同时通过影响有效输运和表面积的孔隙度变化来考虑地质力学耦合。\n\n使用的基本物理基础：\n- 菲克第一扩散定律：对于稳态下稀溶质的一维扩散，扩散摩尔通量密度由 $j = -D_{\\mathrm{e}} \\, \\frac{dc}{dx}$ 给出，其中 $D_{\\mathrm{e}}$ 是有效扩散系数，$c$ 是溶质浓度。\n- 线性表面反应动力学：单位反应表面积的表面反应速率为 $r = k_{\\mathrm{s}} \\, c_{\\mathrm{s}}$，其中 $k_{\\mathrm{s}}$ 是一级速率常数，$c_{\\mathrm{s}}$ 是反应表面的浓度。\n- 孔隙尺度的稳态质量平衡：到达反应表面的扩散通量等于该表面的表面反应速率。\n- 孔隙度的小应变多孔弹性耦合：假设固体基质有效不可压缩且 Biot 系数为 1；那么对于小体积应变 $\\epsilon_{\\mathrm{v}}$，孔隙度更新为 $\\phi = \\phi_{0} + (1 - \\phi_{0}) \\, \\epsilon_{\\mathrm{v}}$。为符合物理现实，通过在必要时将 $\\phi$ 裁剪到小区间 $(\\varepsilon, 1-\\varepsilon)$（其中 $\\varepsilon = 10^{-6}$）来确保其严格保持在 $0$ 和 $1$ 之间。\n- 有效扩散系数通过 Bruggeman 型关系随孔隙度变化：$D_{\\mathrm{e}} = D_{\\mathrm{m}} \\, \\phi^{\\beta}$，其中 $D_{\\mathrm{m}}$ 是分子扩散系数，$\\beta$ 是一个常数指数。\n- 比反应表面积随孔隙度变化：单位总体积的总体比反应表面积为 $a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} \\, (\\phi/\\phi_{0})^{\\eta}$，其中 $a_{\\mathrm{s0}}$ 是参考孔隙度 $\\phi_{0}$ 时的比反应表面积，$\\eta$ 是一个给定的常数。REV 内的总反应表面积则为 $S_{\\mathrm{tot}} = a_{\\mathrm{s}}(\\phi) \\, V_{\\mathrm{REV}}$。\n\n孔隙尺度模型和升尺度：\n- 考虑由 $i = 1,\\dots,N$ 索引的 $N$ 个孔隙类别集合。对于每个类别 $i$，一个厚度为 $l_{i}$ 的准一维薄膜将主体浓度 $c_{\\mathrm{b}}$（假设在孔口处均匀）与局部浓度为 $c_{\\mathrm{s},i}$ 的反应表面分离开。在稳态下，到达表面的通量等于表面的反应速率。每个类别 $i$ 被分配一个面积权重因子 $w_{i}$，使得 $\\sum_{i=1}^{N} w_{i} = 1$，并且类别 $i$ 的反应表面积为 $S_{i} = w_{i} \\, S_{\\mathrm{tot}}$。\n- 升尺度后的体积反应速率定义为\n$$\nR_{\\mathrm{up}} \\equiv \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_{i} \\, S_{i},\n$$\n其中 $j_{i}$ 是到达类别 $i$ 的稳态扩散通量密度。\n\n要求的推导和算法设计（不要在问题陈述中提供捷径公式）：从所述基本定律出发，通过在厚度为 $l_{i}$ 的薄膜上应用菲克定律以及在 $x = l_{i}$ 处扩散通量与表面反应速率相等，来推导每个孔隙类别的稳态通量 $j_{i}$。使用多孔弹性孔隙度更新来计算 $\\phi$，然后从 Bruggeman 型关系计算 $D_{\\mathrm{e}}$，并从给定的缩放定律计算 $a_{\\mathrm{s}}(\\phi)$。使用面积加权来聚合孔隙尺度通量并获得 $R_{\\mathrm{up}}$。\n\n科学真实性要求：\n- 所有变量定义如下，括号内为所需单位：\n  - $D_{\\mathrm{m}}$ (m$^{2}$/s)，$\\phi_{0}$ (无量纲)，$\\epsilon_{\\mathrm{v}}$ (无量纲)，$\\beta$ (无量纲)，$a_{\\mathrm{s0}}$ (m$^{2}$/m$^{3}$)，$\\eta$ (无量纲)，$V_{\\mathrm{REV}}$ (m$^{3}$)，$c_{\\mathrm{b}}$ (mol/m$^{3}$)。\n  - 对每个 $i$：$l_{i}$ (m)，$k_{\\mathrm{s},i}$ (m/s)，$w_{i}$ (无量纲且 $\\sum w_{i} = 1$)。\n- 最终的升尺度速率 $R_{\\mathrm{up}}$ 必须以 mol/(m$^{3}$ s) 为单位报告。\n\n测试套件：\n实现一个程序，为以下三个参数集中的每一个计算 $R_{\\mathrm{up}}$，并按要求格式输出三个结果。对于所有三个案例共有的常数，使用：\n- $D_{\\mathrm{m}} = 1 \\times 10^{-9}$ m$^{2}$/s，\n- $\\phi_{0} = 0.2$，\n- $\\beta = 1.5$，\n- $a_{\\mathrm{s0}} = 1 \\times 10^{5}$ m$^{2}$/m$^{3}$，\n- $\\eta = 0.2$，\n- $V_{\\mathrm{REV}} = 1 \\times 10^{-6}$ m$^{3}$，\n- $c_{\\mathrm{b}} = 1.0$ mol/m$^{3}$。\n\n现在为以下三种情况计算 $R_{\\mathrm{up}}$：\n1) 理想情况，混合控制：\n- $\\epsilon_{\\mathrm{v}} = +0.05$，\n- $N = 3$，\n- $l = [1 \\times 10^{-4}, \\; 5 \\times 10^{-5}, \\; 2 \\times 10^{-4}]$ m，\n- $k_{\\mathrm{s}} = [1 \\times 10^{-5}, \\; 5 \\times 10^{-6}, \\; 2 \\times 10^{-5}]$ m/s，\n- $w = [0.5, \\; 0.3, \\; 0.2]$。\n\n2) 趋向输运限制（压缩降低扩散系数）：\n- $\\epsilon_{\\mathrm{v}} = -0.03$，\n- $N = 2$，\n- $l = [5 \\times 10^{-4}, \\; 2 \\times 10^{-4}]$ m，\n- $k_{\\mathrm{s}} = [1 \\times 10^{-3}, \\; 2 \\times 10^{-3}]$ m/s，\n- $w = [0.6, \\; 0.4]$。\n\n3) 趋向反应限制（动力学非常缓慢）：\n- $\\epsilon_{\\mathrm{v}} = +0.02$，\n- $N = 4$，\n- $l = [1 \\times 10^{-3}, \\; 8 \\times 10^{-4}, \\; 6 \\times 10^{-4}, \\; 1 \\times 10^{-4}]$ m，\n- $k_{\\mathrm{s}} = [1 \\times 10^{-7}, \\; 5 \\times 10^{-8}, \\; 2 \\times 10^{-7}, \\; 1 \\times 10^{-7}]$ m/s，\n- $w = [0.25, \\; 0.25, \\; 0.25, \\; 0.25]$。\n\n角度单位不适用。百分比必须表示为小数。以 mol/(m$^{3}$ s) 为单位报告每个 $R_{\\mathrm{up}}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个结果，形式为方括号内由逗号分隔的浮点数列表，采用科学记数法，保留八位有效数字，例如：\"[1.23456789e-03,2.34567891e+00,3.45678912e-05]\"。结果的单位必须是 mol/(m$^{3}$ s)。",
            "solution": "此问题被认为是有效的，因为它科学地基于反应输运和多孔弹性力学的既定原理，具有完整且一致的数据和定义，是适定的，并且提供的参数和条件在物理上是现实的。\n\n目标是计算反应性多孔介质的升尺度后体积反应速率 $R_{\\mathrm{up}}$。这需要在一个代表性单元体积 (REV) 上整合孔隙尺度的输运和反应现象，同时考虑体积应变 $\\epsilon_{\\mathrm{v}}$ 对孔隙度 $\\phi$ 以及因此对输运性质和反应表面积的地质力学影响。\n\n求解过程分以下几个步骤推导：\n1.  推导单个孔隙类别的稳态溶质通量。\n2.  通过汇总所有孔隙类别的贡献来构建升尺度后的反应速率公式。\n3.  阐明完整的计算算法，包括地质力学耦合。\n\n**步骤 1：孔隙尺度稳态通量**\n\n我们考虑一个由索引 $i$ 标记的单一孔隙类别，其特征是厚度为 $l_i$ 的静态薄膜。溶质从主体孔隙流体（其中浓度为 $c_{\\mathrm{b}}$）穿过此薄膜扩散到反应性矿物表面（其中浓度为 $c_{\\mathrm{s},i}$）。\n\n根据菲克第一定律，一维稳态扩散通量密度 $j_i$ 在薄膜上是恒定的，由以下公式给出：\n$$\nj_i = -D_{\\mathrm{e}} \\frac{dc}{dx}\n$$\n其中 $D_{\\mathrm{e}}$ 是多孔介质中的有效扩散系数。浓度剖面在薄膜上是线性的，因此梯度可以近似为 $\\frac{\\Delta c}{\\Delta x} = \\frac{c_{\\mathrm{s},i} - c_{\\mathrm{b}}}{l_i}$。因此，朝向表面的通量为：\n$$\nj_i = -D_{\\mathrm{e}} \\frac{c_{\\mathrm{s},i} - c_{\\mathrm{b}}}{l_i} = \\frac{D_{\\mathrm{e}}}{l_i} (c_{\\mathrm{b}} - c_{\\mathrm{s},i})\n$$\n\n在矿物表面（$x=l_i$），单位反应表面积的表面反应消耗速率由线性动力学定律给出：\n$$\nr_i = k_{\\mathrm{s},i} c_{\\mathrm{s},i}\n$$\n其中 $k_{\\mathrm{s},i}$ 是类别 $i$ 的一级表面反应速率常数。\n\n在稳态下，到达表面的溶质通量必须等于其被消耗的速率。这建立了表面的质量平衡条件：\n$$\nj_i = r_i\n$$\n结合通量和反应速率的表达式，我们得到一个关于两个未知数 $j_i$ 和 $c_{\\mathrm{s},i}$ 的方程组：\n$$\n\\begin{cases}\nj_i = \\frac{D_{\\mathrm{e}}}{l_i} (c_{\\mathrm{b}} - c_{\\mathrm{s},i}) \\\\\nj_i = k_{\\mathrm{s},i} c_{\\mathrm{s},i}\n\\end{cases}\n$$\n从第二个方程，我们用通量表示表面浓度：$c_{\\mathrm{s},i} = j_i / k_{\\mathrm{s},i}$。将此代入第一个方程，消去 $c_{\\mathrm{s},i}$：\n$$\nj_i = \\frac{D_{\\mathrm{e}}}{l_i} \\left(c_{\\mathrm{b}} - \\frac{j_i}{k_{\\mathrm{s},i}}\\right)\n$$\n求解 $j_i$：\n$$\nj_i = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i} - \\frac{D_{\\mathrm{e}} j_i}{l_i k_{\\mathrm{s},i}}\n$$\n$$\nj_i \\left(1 + \\frac{D_{\\mathrm{e}}}{l_i k_{\\mathrm{s},i}}\\right) = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i}\n$$\n$$\nj_i \\left(\\frac{l_i k_{\\mathrm{s},i} + D_{\\mathrm{e}}}{l_i k_{\\mathrm{s},i}}\\right) = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i}\n$$\n$$\nj_i = \\frac{D_{\\mathrm{e}} k_{\\mathrm{s},i} c_{\\mathrm{b}}}{l_i k_{\\mathrm{s},i} + D_{\\mathrm{e}}}\n$$\n通过将分子和分母同除以 $D_{\\mathrm{e}} k_{\\mathrm{s},i}$，该表达式可以优雅地重写为：\n$$\nj_i = \\frac{c_{\\mathrm{b}}}{\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}}}\n$$\n此形式表明，整个过程由两个串联的阻力控制：输运阻力 $R_{\\mathrm{transport}, i} = l_i/D_{\\mathrm{e}}$ 和反应阻力 $R_{\\mathrm{reaction}, i} = 1/k_{\\mathrm{s},i}$。\n\n**步骤 2：升尺度至 REV 尺度**\n\n升尺度后的体积反应速率 $R_{\\mathrm{up}}$ 定义为 REV 内的总摩尔反应速率，通过 REV 的体积 $V_{\\mathrm{REV}}$ 进行归一化：\n$$\nR_{\\mathrm{up}} \\equiv \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} (\\text{类别 } i \\text{ 的总速率})\n$$\n类别 $i$ 的总速率是通量密度 $j_i$ 与该类别的总表面积 $S_i$ 的乘积。因此，\n$$\nR_{\\mathrm{up}} = \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_i S_i\n$$\n面积 $S_i$ 由 REV 中总反应表面积 $S_{\\mathrm{tot}}$ 的一个分数 $w_i$ 给出：$S_i = w_i S_{\\mathrm{tot}}$。总面积 $S_{\\mathrm{tot}}$ 通过总体比反应表面积 $a_{\\mathrm{s}}(\\phi)$ 与 $S_{\\mathrm{tot}} = a_{\\mathrm{s}}(\\phi) V_{\\mathrm{REV}}$ 相关。代入这些关系：\n$$\nR_{\\mathrm{up}} = \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_i (w_i S_{\\mathrm{tot}}) = \\frac{S_{\\mathrm{tot}}}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} w_i j_i = \\frac{a_{\\mathrm{s}}(\\phi) V_{\\mathrm{REV}}}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} w_i j_i\n$$\n这简化为：\n$$\nR_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i j_i\n$$\n代入推导出的 $j_i$ 表达式，升尺度速率的最终公式为：\n$$\nR_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i \\left( \\frac{c_{\\mathrm{b}}}{\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}}} \\right)\n$$\n这表明 $R_{\\mathrm{up}}$ 是孔隙尺度通量的加权平均值，权重为其各自的表面积分数，并按总体比反应表面积进行缩放。\n\n**步骤 3：地质力学耦合与计算算法**\n\n模型的参数 $D_{\\mathrm{e}}$ 和 $a_{\\mathrm{s}}(\\phi)$ 取决于孔隙度 $\\phi$，而孔隙度又受体积应变 $\\epsilon_{\\mathrm{v}}$ 的影响。\n\n1.  **孔隙度更新**：孔隙度 $\\phi$ 根据其参考值 $\\phi_0$ 和体积应变 $\\epsilon_{\\mathrm{v}}$，使用小应变多孔弹性关系进行更新：\n    $$\n    \\phi = \\phi_{0} + (1 - \\phi_{0}) \\epsilon_{\\mathrm{v}}\n    $$\n    为符合物理现实，计算出的 $\\phi$ 被裁剪到区间 $(\\varepsilon, 1-\\varepsilon)$，其中 $\\varepsilon = 10^{-6}$。\n\n2.  **有效扩散系数**：有效扩散系数 $D_{\\mathrm{e}}$ 根据更新后的孔隙度 $\\phi$，使用 Bruggeman 型关系计算：\n    $$\n    D_{\\mathrm{e}} = D_{\\mathrm{m}} \\phi^{\\beta}\n    $$\n    其中 $D_{\\mathrm{m}}$ 是分子扩散系数，$\\beta$ 是胶结指数。\n\n3.  **比表面积**：总体比反应表面积 $a_{\\mathrm{s}}(\\phi)$ 也根据新的孔隙度进行更新：\n    $$\n    a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} \\left(\\frac{\\phi}{\\phi_{0}}\\right)^{\\eta}\n    $$\n    其中 $a_{\\mathrm{s0}}$ 是在 $\\phi_0$ 时的参考比表面积，$\\eta$ 是一个缩放指数。\n\n**完整算法：**\n对于每个给定的参数集，计算过程如下：\n1.  计算更新后的孔隙度 $\\phi = \\phi_{0} + (1 - \\phi_{0}) \\epsilon_{\\mathrm{v}}$，并将其裁剪到 $(\\varepsilon, 1-\\varepsilon)$。\n2.  使用更新后的 $\\phi$，计算 $D_{\\mathrm{e}} = D_{\\mathrm{m}} \\phi^{\\beta}$。\n3.  使用更新后的 $\\phi$，计算 $a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} (\\phi/\\phi_{0})^{\\eta}$。\n4.  对于每个孔隙类别 $i=1, \\dots, N$：\n    a. 计算通量 $j_i = c_{\\mathrm{b}} / (\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}})$。\n5.  计算最终的升尺度后体积速率 $R_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i j_i$。\n6.  以 mol/(m$^3$ s) 为单位，并按指定精度报告结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the upscaled volumetric reaction rate for three test cases\n    based on a coupled reactive transport and geomechanics model.\n    \"\"\"\n\n    # Common physical constants and parameters\n    D_m = 1.0e-9      # Molecular diffusion coefficient (m^2/s)\n    phi_0 = 0.2       # Reference porosity (dimensionless)\n    beta = 1.5        # Bruggeman exponent (dimensionless)\n    a_s0 = 1.0e5      # Reference specific reactive surface area (m^2/m^3)\n    eta = 0.2         # Surface area scaling exponent (dimensionless)\n    c_b = 1.0         # Bulk solute concentration (mol/m^3)\n    porosity_clip = 1.0e-6 # Clipping epsilon for porosity\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"eps_v\": 0.05,\n            \"l\": np.array([1.0e-4, 5.0e-5, 2.0e-4]),\n            \"ks\": np.array([1.0e-5, 5.0e-6, 2.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2])\n        },\n        {\n            \"eps_v\": -0.03,\n            \"l\": np.array([5.0e-4, 2.0e-4]),\n            \"ks\": np.array([1.0e-3, 2.0e-3]),\n            \"w\": np.array([0.6, 0.4])\n        },\n        {\n            \"eps_v\": 0.02,\n            \"l\": np.array([1.0e-3, 8.0e-4, 6.0e-4, 1.0e-4]),\n            \"ks\": np.array([1.0e-7, 5.0e-8, 2.0e-7, 1.0e-7]),\n            \"w\": np.array([0.25, 0.25, 0.25, 0.25])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_v = case[\"eps_v\"]\n        l_i_vec = case[\"l\"]\n        ks_i_vec = case[\"ks\"]\n        w_i_vec = case[\"w\"]\n\n        # Step 1: Update porosity based on volumetric strain\n        phi = phi_0 + (1.0 - phi_0) * eps_v\n        \n        # Clip porosity to ensure it remains within physical bounds\n        phi = np.clip(phi, porosity_clip, 1.0 - porosity_clip)\n\n        # Step 2: Calculate porosity-dependent effective diffusivity\n        D_e = D_m * (phi ** beta)\n\n        # Step 3: Calculate porosity-dependent specific reactive surface area\n        a_s = a_s0 * ((phi / phi_0) ** eta)\n\n        # Step 4: Calculate pore-scale flux for each class\n        # j_i = c_b / (l_i / D_e + 1 / k_s_i)\n        transport_resistance = l_i_vec / D_e\n        reaction_resistance = 1.0 / ks_i_vec\n        j_i_vec = c_b / (transport_resistance + reaction_resistance)\n\n        # Step 5: Compute the upscaled volumetric reaction rate\n        # R_up = a_s * sum(w_i * j_i)\n        # Using dot product for summation: w_1*j_1 + w_2*j_2 + ...\n        R_up = a_s * np.dot(w_i_vec, j_i_vec)\n        \n        results.append(R_up)\n\n    # Format the output as a comma-separated list of floats in scientific\n    # notation with eight significant digits, enclosed in square brackets.\n    # The format specifier \"{:.7e}\" produces 8 significant digits.\n    formatted_results = [f\"{res:.7e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}