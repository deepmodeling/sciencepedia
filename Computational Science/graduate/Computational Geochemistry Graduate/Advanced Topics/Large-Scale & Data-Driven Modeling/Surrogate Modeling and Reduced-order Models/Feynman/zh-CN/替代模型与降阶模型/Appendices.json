{
    "hands_on_practices": [
        {
            "introduction": "在构建任何计算模型之前，深入理解其背后的物理原理至关重要。本实践通过对一个典型的反应输运方程进行无量纲化，来揭示控制系统行为的关键无量纲数。理解这些参数如何影响解的平滑度和系统的刚性，将帮助我们预见在构建代理模型或降阶模型时可能遇到的挑战，从而做出更明智的建模决策 ()。",
            "id": "4102078",
            "problem": "一个长度为 $L$ 的一维饱和多孔介质柱，在稳定流条件下，输运并反应一种溶解物质，其浓度为 $c(x,t)$。控制其输运过程的机制源于质量守恒、线性平流、Fickian 弥散和一级反应。设 Darcy 速度为 $q$，孔隙度为 $\\phi$，因此间隙（孔隙）速度为 $u = q/\\phi$。有效的水动力弥散系数为 $D$（假设为常数），均相一级反应速率常数为 $k$（假设为常数）。在 $x \\in [0,L]$ 和 $t \\geq 0$ 上，关于 $c(x,t)$ 的有量纲控制方程由质量守恒和线性通量定律导出，其入口边界条件为 Dirichlet 条件 $c(0,t) = C_{\\mathrm{in}}$，出口边界条件为在 $x=L$ 处的对流边界条件。假设初始时柱中不含溶质，$c(x,0)=0$。\n\n从这些物理陈述出发，不使用任何预先推导的无量纲公式，利用特征长度 $L$、入口浓度 $C_{\\mathrm{in}}$ 以及与平流输运（由 $u$ 所蕴含）相符的时间尺度，对控制方程进行无量纲化。以闭合形式确定由此无量纲化过程中产生的 Peclet 数 $\\mathrm{Pe}$ 和 Damkohler 数 $\\mathrm{Da}$。\n\n然后，使用得到的无量纲模型，从第一性原理出发，讨论 $\\mathrm{Pe}$ 和 $\\mathrm{Da}$ 的大小如何影响 (i) 代理模型试图学习的参数到解映射的光滑性，以及 (ii) 降阶模型（ROMs）的稳定性，例如通过本征正交分解（POD）和 Galerkin 投影构建的模型。您的讨论应将 $\\mathrm{Pe}$ 和 $\\mathrm{Da}$ 的物理解释与解中的预期特征（例如，锋面、边界层、刚性、非正规性）以及时间积分中的定性稳定性约束联系起来。\n\n请以行矩阵的形式给出最终答案，其中包含用 $u$、$L$、$D$ 和 $k$ 表示的 $\\mathrm{Pe}$ 和 $\\mathrm{Da}$ 的解析表达式。不需要进行数值计算。由于最终答案是无量纲的，因此不需要指定单位。",
            "solution": "合适的出发点是饱和多孔介质中溶解物质的局部质量守恒，它平衡了累积、平流、弥散和反应。在孔隙度 $\\phi$、Darcy 速度 $q$、间隙速度 $u = q/\\phi$、弥散系数 $D$ 和一级反应速率 $k$ 均为常数的情况下，水相浓度 $c(x,t)$ 的有量纲守恒方程为\n$$\n\\phi \\frac{\\partial c}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(q\\,c - \\phi D \\frac{\\partial c}{\\partial x}\\right) \\;=\\; -\\phi k\\,c.\n$$\n假设 $\\phi$ 为常数，并两边同除以 $\\phi$，得到\n$$\n\\frac{\\partial c}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u\\,c - D \\frac{\\partial c}{\\partial x}\\right) \\;=\\; -k\\,c,\n$$\n其中 $u \\equiv q/\\phi$ 是孔隙速度。在 $u$ 和 $D$ 为常数且忽略系数的空间变异性的情况下，展开空间导数项，得到线性平流-弥散-反应方程\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} \\;=\\; D \\frac{\\partial^{2} c}{\\partial x^{2}} \\;-\\; k\\,c.\n$$\n边界条件为 $c(0,t) = C_{\\mathrm{in}}$ 和在 $x=L$ 处的对流（或零弥散通量）出口条件，初始条件为 $c(x,0) = 0$。\n\n为了进行无量纲化，我们引入长度、时间和浓度的特征尺度。取柱长 $L$ 为特征长度，入口浓度 $C_{\\mathrm{in}}$ 为浓度尺度。一个具有物理意义的平流时间尺度是基于孔隙速度 $u$ 的停留时间，即 $T = L/u$。定义无量纲变量\n$$\nx \\;=\\; L\\,\\xi,\\qquad t \\;=\\; T\\,\\tau \\;=\\; \\frac{L}{u}\\,\\tau,\\qquad c(x,t) \\;=\\; C_{\\mathrm{in}}\\,\\hat{c}(\\xi,\\tau).\n$$\n在此变量替换下计算导数：\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; C_{\\mathrm{in}} \\frac{\\partial \\hat{c}}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial t} \\;=\\; C_{\\mathrm{in}} \\frac{\\partial \\hat{c}}{\\partial \\tau} \\frac{u}{L},\\qquad\n\\frac{\\partial c}{\\partial x} \\;=\\; C_{\\mathrm{in}} \\frac{\\partial \\hat{c}}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial x} \\;=\\; C_{\\mathrm{in}} \\frac{1}{L} \\frac{\\partial \\hat{c}}{\\partial \\xi},\n$$\n以及\n$$\n\\frac{\\partial^{2} c}{\\partial x^{2}} \\;=\\; C_{\\mathrm{in}} \\frac{1}{L^{2}} \\frac{\\partial^{2} \\hat{c}}{\\partial \\xi^{2}}.\n$$\n将这些代入有量纲方程中：\n$$\nC_{\\mathrm{in}} \\frac{u}{L} \\frac{\\partial \\hat{c}}{\\partial \\tau} \\;+\\; u\\, C_{\\mathrm{in}} \\frac{1}{L} \\frac{\\partial \\hat{c}}{\\partial \\xi}\n\\;=\\;\nD\\, C_{\\mathrm{in}} \\frac{1}{L^{2}} \\frac{\\partial^{2} \\hat{c}}{\\partial \\xi^{2}} \\;-\\; k\\, C_{\\mathrm{in}} \\hat{c}.\n$$\n两边同除以 $C_{\\mathrm{in}}$，再同乘以 $L/u$，得到无量纲形式\n$$\n\\frac{\\partial \\hat{c}}{\\partial \\tau} \\;+\\; \\frac{\\partial \\hat{c}}{\\partial \\xi}\n\\;=\\;\n\\left(\\frac{D}{u L}\\right) \\frac{\\partial^{2} \\hat{c}}{\\partial \\xi^{2}} \\;-\\; \\left(\\frac{k L}{u}\\right) \\hat{c}.\n$$\n通过定义以下标准无量纲数组来确定它们\n$$\n\\mathrm{Pe} \\;\\equiv\\; \\frac{u L}{D},\\qquad \\mathrm{Da} \\;\\equiv\\; \\frac{k L}{u}.\n$$\n于是，无量纲控制方程为\n$$\n\\frac{\\partial \\hat{c}}{\\partial \\tau} \\;+\\; \\frac{\\partial \\hat{c}}{\\partial \\xi}\n\\;=\\;\n\\frac{1}{\\mathrm{Pe}} \\frac{\\partial^{2} \\hat{c}}{\\partial \\xi^{2}} \\;-\\; \\mathrm{Da}\\, \\hat{c}.\n$$\n入口边界条件变为 $\\hat{c}(0,\\tau) = 1$，初始条件为 $\\hat{c}(\\xi,0) = 0$，出口对流边界条件在无量纲形式下保持一致。\n\n$\\mathrm{Pe}$ 和 $\\mathrm{Da}$ 对代理模型光滑性和降阶模型（ROM）稳定性的影响可以从无量纲算子结构中评估。无量纲空间算子为\n$$\n\\mathcal{L} \\hat{c} \\;=\\; - \\frac{\\partial \\hat{c}}{\\partial \\xi} \\;+\\; \\frac{1}{\\mathrm{Pe}} \\frac{\\partial^{2} \\hat{c}}{\\partial \\xi^{2}} \\;-\\; \\mathrm{Da}\\, \\hat{c},\n$$\n演化方程为 $\\partial \\hat{c}/\\partial \\tau = \\mathcal{L}\\hat{c}$。当 $\\mathrm{Pe}$ 很大时，弥散项 $\\frac{1}{\\mathrm{Pe}} \\partial^{2}_{\\xi} \\hat{c}$ 相对于平流较弱。这会产生尖锐的平流锋和薄边界层，使得参数到解的映射对于 $u$、$D$ 和 $k$ 等输入不那么光滑。诸如 Gaussian 过程回归器或神经网络之类的代理模型依赖于光滑性来进行泛化；高 $\\mathrm{Pe}$ 会降低可微性并增加局部曲率，需要在锋面附近采集更密集的训练样本才能解析解流形。相反，当 $\\mathrm{Pe}$ 很小时，弥散占主导地位，锋面被抹平，解随参数的变化更为光滑，从而简化了代理模型的学习过程。\n\nDamkohler 数 $\\mathrm{Da}$ 比较的是反应与平流的相对速率。大的 $\\mathrm{Da}$ 意味着在一个平流时间尺度内反应很强，这会引入刚性衰减项，并在 $\\hat{c}$ 被强制为 1 的入口附近产生由反应引起的边界层。刚性表现为 $\\partial \\hat{c}/\\partial \\tau = \\mathcal{L}\\hat{c}$ 中时间尺度的巨大差异：与反应项 $-\\mathrm{Da}\\,\\hat{c}$ 相关的特征值使谱向左移动约 $-\\mathrm{Da}$，增加了负特征值的绝对值，并产生快速的瞬态过程。这降低了参数到解映射关于 $k$ 的光滑性，并可能对那些假设输出缓慢变化的代理模型构成挑战。\n\n对于通过本征正交分解（POD）和 Galerkin 投影构建的降阶模型，其稳定性由降阶算子的谱和非正规性决定。弥散项贡献了负定的对称分量，这些分量是起稳定作用的，且与 $1/\\mathrm{Pe}$ 成正比。平流项在连续形式下是斜伴随的，但在离散化后会变得非正规，即使在渐近稳定时也可能表现出瞬态增长；较高的 $\\mathrm{Pe}$ 会增强非正规效应，因为耗散较弱，这使得降阶模型对投影误差和模态截断更为敏感。反应项增加了一个大小为 $\\mathrm{Da}$ 的对角负分量，该分量是渐近稳定的，但增加了系统的刚性。对于降阶模型的显式时间积分，无量纲时间步长 $\\Delta \\tau$ 的定性稳定性约束反映了平流、弥散和反应中最强的限制，例如\n$$\n\\Delta \\tau \\;\\lesssim\\; \\min\\left\\{\\, \\Delta \\xi,\\; \\frac{\\mathrm{Pe}\\,\\Delta\\xi^2}{2},\\; \\frac{1}{\\mathrm{Da}} \\,\\right\\},\n$$\n其中 $\\Delta \\xi$ 是降阶模型模态的一个特征无量纲空间分辨率；大的 $\\mathrm{Pe}$ 和大的 $\\mathrm{Da}$ 会使这些界限变得更紧。因此，增加 $\\mathrm{Pe}$ 倾向于降低代理模型的光滑性和降阶模型对截断的鲁棒性，而增加 $\\mathrm{Da}$ 则会增加刚性，需要采用隐式积分或稳定化的降阶模型格式。\n\n因此，所要求的无量纲数组为\n$$\n\\mathrm{Pe} \\;=\\; \\frac{u L}{D},\\qquad \\mathrm{Da} \\;=\\; \\frac{k L}{u}.\n$$\n以最终行矩阵的形式提供它们符合要求。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{u L}{D}  \\frac{k L}{u}\\end{pmatrix}}$$"
        },
        {
            "introduction": "降阶模型（ROM）的核心优势在于其计算效率，但这通常以牺牲一定精度为代价。本实践聚焦于ROM构建中的一个关键决策：如何选择模型的阶数 $r$。我们将演示一种严谨的“面向目标”的方法，它根据用户指定的关键输出量（Quantity of Interest, QoI）的误差容限来确定最小的 $r$，从而在满足精度要求的同时实现计算成本的最大化节省 ()。",
            "id": "4101999",
            "problem": "一个用于三维多孔柱中碳酸盐水化学的反应输运模型被离散为 $n$ 个空间自由度，从而得到一个由对流-扩散-反应控制的维度为 $n$ 的全阶模型 (FOM)。浓度场 $C(\\boldsymbol{x},t)$ 根据质量守恒和线性输运演化，其反应动力学由一个遵循 Arrhenius 型速率定律的空间分布源项描述。通过对一个由离散浓度向量 $\\boldsymbol{c}(t) \\in \\mathbb{R}^n$ 的 $m$ 个状态快照构成的快照矩阵 $X \\in \\mathbb{R}^{n \\times m}$ 进行奇异值分解 (SVD)，利用本征正交分解 (POD) 构建了一个降阶模型 (ROM)。关注的输出量是最终时刻 $t_f$ 在柱出口处的出流碱度，其被建模为一个线性泛函 $y = \\boldsymbol{w}^\\top \\boldsymbol{c}(t_f)$，其中 $\\boldsymbol{w} \\in \\mathbb{R}^n$ 代表了在出口平面上的求积权重。\n\n假设以下已校准且物理上一致的信息是可用的：\n- 离散化规模为 $n = 200{,}000$，快照 SVD 产生有序奇异值 $\\sigma_1 = 9.0$, $\\sigma_2 = 3.0$, $\\sigma_3 = 1.0$, $\\sigma_4 = 0.35$, $\\sigma_5 = 0.12$, $\\sigma_6 = 0.04$, $\\sigma_7 = 0.015$, $\\sigma_8 = 0.006$，后续值可忽略不计。\n- 测量向量的欧几里得范数为 $\\lVert \\boldsymbol{w} \\rVert_2 = 0.5$。\n- 对关注输出量的期望容差为 $\\varepsilon_y = 0.1$。\n- FOM 每个时间步的在线计算成本服从 $C_{\\text{FOM}} = \\alpha n$ 关系，其中 $\\alpha = 50$。ROM 采用 Galerkin 投影和通过离散经验插值法 (DEIM) 实现的超降阶，其每个时间步的在线成本为 $C_{\\text{ROM}} = \\beta r^2 + \\gamma q$，其中 $r$ 是保留的 POD 模态数，$q = 25$ 是 DEIM 采样点数，$\\beta = 300$，$\\gamma = 500$。\n\n从第一性原理和经过充分检验的事实出发：\n- SVD 在 Frobenius 范数下秩-$r$ 近似的最优性，\n- 由欧几里得范数导出的输出量的线性泛函稳定性界，\n- ROM 时间步进中代数运算的维度缩放规律，\n\n评估 $r$ 的选择如何影响 $y$ 的近似误差和计算成本，并找出一个使用 $\\sigma_i$ 的衰减和容差 $\\varepsilon_y$ 来选择 $r$ 的合理准则。哪个选项正确地陈述了这样一个准则，将其应用于给定数据以选择 $r$，并一致地描述了所得的计算成本和误差？\n\nA. 选择 $r$ 为满足 $\\lVert \\boldsymbol{w} \\rVert_2 \\sqrt{\\sum_{i=r+1}^{8} \\sigma_i^2} \\le \\varepsilon_y$ 的最小整数。根据所提供的数据，这得到 $r = 4$。在所述的成本模型下，当 $r = 4$ 时，ROM 的每步成本比 FOM 成本低了几个数量级，并且输出误差界低于 $\\varepsilon_y$。\n\nB. 通过要求捕获的能量分数 $\\sum_{i=1}^{r} \\sigma_i^2 \\big/ \\sum_{i=1}^{8} \\sigma_i^2 \\ge 0.998$ 来选择 $r$；这得到 $r=3$。因为捕获了 99.8% 的能量，所以保证输出误差低于 $\\varepsilon_y$，且 ROM 成本最小。\n\nC. 选择 $r$ 为满足 $\\sum_{i=r+1}^{8} \\sigma_i \\le \\varepsilon_y / \\lVert \\boldsymbol{w} \\rVert_2$ 的最小整数；这得到 $r=5$。这个关于奇异值的线性尾部准则确保了输出误差低于容差。ROM 成本将随 $r$ 近似线性下降。\n\nD. 选择 $r = 4$，因为成本随 $r$ 线性下降，输出误差随 $\\sum_{i=r+1}^{8} \\sigma_i$ 线性下降。对于给定的数据，这个选择在成本和误差之间达到了最佳平衡；没有必要使用基于范数的界，因为奇异值已经表明了充分性。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n\n- **系统**：用于三维多孔柱中碳酸盐水化学的反应输运模型。\n- **控制物理**：对流-扩散-反应，具有 Arrhenius 型速率定律。\n- **模型离散化**：全阶模型 (FOM) 的维度为 $n = 200{,}000$。状态向量为 $\\boldsymbol{c}(t) \\in \\mathbb{R}^n$。\n- **模型降阶**：通过对快照矩阵 $X \\in \\mathbb{R}^{n \\times m}$ 进行本征正交分解 (POD) 构建降阶模型 (ROM)。\n- **SVD 数据**：$X$ 的 SVD 得到的有序奇异值为 $\\sigma_1 = 9.0$, $\\sigma_2 = 3.0$, $\\sigma_3 = 1.0$, $\\sigma_4 = 0.35$, $\\sigma_5 = 0.12$, $\\sigma_6 = 0.04$, $\\sigma_7 = 0.015$, $\\sigma_8 = 0.006$。所有后续奇异值均可忽略不计。\n- **关注的输出量**：一个线性泛函 $y = \\boldsymbol{w}^\\top \\boldsymbol{c}(t_f)$，其中 $\\boldsymbol{w} \\in \\mathbb{R}^n$ 是一个测量向量。\n- **输出数据**：测量向量的欧几里得范数为 $\\lVert \\boldsymbol{w} \\rVert_2 = 0.5$。对输出量的期望容差为 $\\varepsilon_y = 0.1$。\n- **计算成本模型**：\n  - FOM 每时间步成本：$C_{\\text{FOM}} = \\alpha n$，其中 $\\alpha = 50$。\n  - ROM 每时间步成本：$C_{\\text{ROM}} = \\beta r^2 + \\gamma q$，其中 $r$ 是 ROM 维度（POD 模态数），$q = 25$ 是 DEIM 点数，$\\beta = 300$，$\\gamma = 500$。\n- **指导原则**：\n  1. SVD 在 Frobenius 范数下秩-$r$ 近似的最优性。\n  2. 由欧几里得范数导出的输出量的线性泛函稳定性界。\n  3. ROM 时间步进中代数运算的维度缩放规律。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据指定标准对问题陈述进行严格评估。\n\n- **科学依据**：该问题在计算科学与工程领域有坚实的基础，特别是在偏微分方程的模型降阶领域。所描述的方法（POD、Galerkin 投影、DEIM）和物理背景（反应输运）都是标准且科学合理的。\n- **适定性**：该问题是适定的。它提供了足够的数值数据和明确的目标：找出一个选择 ROM 维度 $r$ 的正确准则，并验证其应用。预期可以根据既定理论得到一个唯一的、可确定的答案。\n- **客观性**：该问题以精确、客观和技术性的语言表述，没有主观性或歧义。\n- **完整性与一致性**：该问题提供了所有必要的参数（$n$、$\\sigma_i$、$\\lVert \\boldsymbol{w} \\rVert_2$、$\\varepsilon_y$、成本系数），并且不包含内部矛盾。\n- **现实性**：对于一个中等复杂度的离散化 PDE 系统，这些参数是现实的。奇异值的快速衰减对于输运现象（如扩散）占主导的系统是典型的。成本模型代表了 FOM 中稠密矩阵运算和基于投影的 ROM 后验阶段的标准复杂度缩放。\n\n### 步骤 3：结论与行动\n\n问题陈述有效。它科学合理、适定，并为严谨分析提供了一套完整且一致的数据。继续进行解题推导。\n\n## 解题推导\n\n主要任务是找到一个选择 ROM 维度 $r$ 的准则，该准则能严格保证关注输出量 $y$ 的误差在指定的容差 $\\varepsilon_y$ 之内。\n\n关注的输出量是状态向量的线性泛函，$y = \\boldsymbol{w}^\\top \\boldsymbol{c}(t_f)$。由于使用 ROM 近似 $\\boldsymbol{c}_r(t_f)$ 而非 FOM 解 $\\boldsymbol{c}(t_f)$ 导致的输出误差为：\n$$ \\Delta y = y - y_r = \\boldsymbol{w}^\\top \\boldsymbol{c}(t_f) - \\boldsymbol{w}^\\top \\boldsymbol{c}_r(t_f) = \\boldsymbol{w}^\\top (\\boldsymbol{c}(t_f) - \\boldsymbol{c}_r(t_f)) $$\n令 $\\boldsymbol{e}_{\\boldsymbol{c}}(t_f) = \\boldsymbol{c}(t_f) - \\boldsymbol{c}_r(t_f)$ 为最终时刻状态向量的误差。则输出误差为 $\\Delta y = \\boldsymbol{w}^\\top \\boldsymbol{e}_{\\boldsymbol{c}}(t_f)$。\n\n使用“线性泛函稳定性界”的原理（即柯西-施瓦茨不等式），我们可以界定输出的绝对误差：\n$$ |\\Delta y| = |\\boldsymbol{w}^\\top \\boldsymbol{e}_{\\boldsymbol{c}}(t_f)| \\le \\lVert \\boldsymbol{w} \\rVert_2 \\lVert \\boldsymbol{e}_{\\boldsymbol{c}}(t_f) \\rVert_2 $$\n为了确保 $|\\Delta y| \\le \\varepsilon_y$，我们需要一个关于状态误差范数 $\\lVert \\boldsymbol{e}_{\\boldsymbol{c}}(t_f) \\rVert_2$ 的界。\n\nPOD 方法构建了一个正交归一基 $\\{\\boldsymbol{\\phi}_i\\}_{i=1}^r$（快照矩阵 $X$ 的前 $r$ 个左奇异向量），该基在 Frobenius 范数下最小化给定快照的投影误差，因此是最优的。所有 $m$ 个快照投影到这个 $r$ 维基上的平方投影误差之和由截断奇异值的平方和给出：\n$$ \\sum_{j=1}^{m} \\lVert \\boldsymbol{c}(t_j) - \\sum_{i=1}^{r} (\\boldsymbol{\\phi}_i^\\top \\boldsymbol{c}(t_j)) \\boldsymbol{\\phi}_i \\rVert_2^2 = \\sum_{i=r+1}^{\\min(n,m)} \\sigma_i^2 $$\n基于 Galerkin 的 ROM 的一个标准*先验*误差界使用此投影误差作为真实解误差 $\\lVert \\boldsymbol{e}_{\\boldsymbol{c}}(t_f) \\rVert_2$ 的代理。这假设了降阶动力学系统中的误差传播是有界的。一个常见、严格（尽管有时较松）的界是解误差的范数平方以被忽略的奇异值的平方和为界：\n$$ \\lVert \\boldsymbol{e}_{\\boldsymbol{c}}(t_f) \\rVert_2^2 \\le \\sum_{i=r+1}^{\\min(n,m)} \\sigma_i^2 $$\n结合这些界，我们得到输出的误差估计：\n$$ |\\Delta y| \\le \\lVert \\boldsymbol{w} \\rVert_2 \\sqrt{\\sum_{i=r+1}^{\\min(n,m)} \\sigma_i^2} $$\n为了满足容差要求，我们必须选择最小的整数 $r$ 使得：\n$$ \\lVert \\boldsymbol{w} \\rVert_2 \\sqrt{\\sum_{i=r+1}^{\\min(n,m)} \\sigma_i^2} \\le \\varepsilon_y $$\n问题陈述指出 $\\sigma_8$ 之后的奇异值可以忽略不计，因此我们求和到 $i=8$。\n\n### 逐项分析\n\n**A. 选择 $r$ 为满足 $\\lVert \\boldsymbol{w} \\rVert_2 \\sqrt{\\sum_{i=r+1}^{8} \\sigma_i^2} \\le \\varepsilon_y$ 的最小整数。根据所提供的数据，这得到 $r = 4$。在所述的成本模型下，当 $r = 4$ 时，ROM 的每步成本比 FOM 成本低了几个数量级，并且输出误差界低于 $\\varepsilon_y$。**\n\n- **准则**：准则 $\\lVert \\boldsymbol{w} \\rVert_2 \\sqrt{\\sum_{i=r+1}^{8} \\sigma_i^2} \\le \\varepsilon_y$ 与从第一性原理推导出的准则相同。它正确地将输出误差稳定性界与 SVD 最优性属性结合起来。这是一个标准的目标导向误差估计器。\n- **$r$ 的计算**：我们应用给定的数据：$\\lVert \\boldsymbol{w} \\rVert_2 = 0.5$ 和 $\\varepsilon_y = 0.1$。不等式变为：\n  $$ 0.5 \\sqrt{\\sum_{i=r+1}^{8} \\sigma_i^2} \\le 0.1 \\implies \\sqrt{\\sum_{i=r+1}^{8} \\sigma_i^2} \\le \\frac{0.1}{0.5} = 0.2 \\implies \\sum_{i=r+1}^{8} \\sigma_i^2 \\le 0.04 $$\n  我们计算截断奇异值的平方和：\n  - 对于 $r=3$：$\\sum_{i=4}^{8} \\sigma_i^2 = 0.35^2 + 0.12^2 + 0.04^2 + 0.015^2 + 0.006^2 = 0.1225 + 0.0144 + 0.0016 + 0.000225 + 0.000036 = 0.138761$。这大于 $0.04$。\n  - 对于 $r=4$：$\\sum_{i=5}^{8} \\sigma_i^2 = 0.12^2 + 0.04^2 + 0.015^2 + 0.006^2 = 0.0144 + 0.0016 + 0.000225 + 0.000036 = 0.016261$。这小于或等于 $0.04$。\n  最小整数确实是 $r=4$。\n- **成本与误差描述**：\n  - $r=4$ 时的 ROM 成本：$C_{\\text{ROM}} = \\beta r^2 + \\gamma q = 300(4^2) + 500(25) = 300(16) + 12500 = 4800 + 12500 = 17300$。\n  - FOM 成本：$C_{\\text{FOM}} = \\alpha n = 50(200{,}000) = 10{,}000{,}000$。\n  - 比率 $C_{\\text{FOM}}/C_{\\text{ROM}} = 10{,}000{,}000 / 17300 \\approx 578$。这个加速超过两个数量级（$10^2=100$），所以该陈述是正确的。\n  - 根据选择 $r$ 的准则的构造，输出误差界本身就低于 $\\varepsilon_y$。\n- **结论**：**正确**。\n\n**B. 通过要求捕获的能量分数 $\\sum_{i=1}^{r} \\sigma_i^2 \\big/ \\sum_{i=1}^{8} \\sigma_i^2 \\ge 0.998$ 来选择 $r$；这得到 $r=3$。因为捕获了 99.8% 的能量，所以保证输出误差低于 $\\varepsilon_y$，且 ROM 成本最小。**\n\n- **准则**：这是一种基于能量的启发式方法。它不是目标导向的，因为它没有使用关于输出泛函（$\\boldsymbol{w}$）或误差容差（$\\varepsilon_y$）的信息。\n- **逻辑缺陷**：主要缺陷在于断言“因为捕获了 99.8% 的能量，所以保证输出误差低于 $\\varepsilon_y$。”这是一个不合逻辑的推论。高捕获能量确保了平均状态近似是好的，但它不能为特定的输出泛函提供保证。如果输出向量 $\\boldsymbol{w}$ 在被忽略的模态（例如 $\\boldsymbol{\\phi}_4$）上有显著的投影，尽管能量捕获率很高，输出误差仍然可能很大。如选项 A 的计算所示，$r=3$ 不满足严格的误差界。\n- **结论**：**错误**。\n\n**C. 选择 $r$ 为满足 $\\sum_{i=r+1}^{8} \\sigma_i \\le \\varepsilon_y / \\lVert \\boldsymbol{w} \\rVert_2$ 的最小整数；这得到 $r=5$。这个关于奇异值的线性尾部准则确保了输出误差低于容差。ROM 成本将随 $r$ 近似线性下降。**\n\n- **准则**：准则 $\\sum_{i=r+1}^{8} \\sigma_i \\le \\varepsilon_y / \\lVert \\boldsymbol{w} \\rVert_2$ 不是从所述原理推导出的标准、严格的误差界。正确的界涉及平方和的平方根（$\\ell_2$ 范数），而不是奇异值的和（与核范数相关的奇异值向量的 $\\ell_1$ 范数）。\n- **$r$ 的计算**：我们用给定的公式来核对计算。我们需要 $\\sum_{i=r+1}^{8} \\sigma_i \\le 0.1 / 0.5 = 0.2$。\n  - 对于 $r=4$：$\\sum_{i=5}^{8} \\sigma_i = 0.12 + 0.04 + 0.015 + 0.006 = 0.181 \\le 0.2$。\n  - 满足此条件的最小整数是 $r=4$，而不是选项中声称的 $r=5$。选项中给出的计算是错误的。\n- **成本描述**：成本为 $C_{\\text{ROM}} = \\beta r^2 + \\gamma q$。这个成本随 $r$ 二次*增加*，而不是线性下降。该陈述是错误的。\n- **结论**：**错误**。\n\n**D. 选择 $r = 4$，因为成本随 $r$ 线性下降，输出误差随 $\\sum_{i=r+1}^{8} \\sigma_i$ 线性下降。对于给定的数据，这个选择在成本和误差之间达到了最佳平衡；没有必要使用基于范数的界，因为奇异值已经表明了充分性。**\n\n- **成本与误差缩放规律**：该选项关于缩放规律有两个不正确的陈述。首先，成本 $C_{\\text{ROM}} = \\beta r^2 + \\gamma q$ 随 $r$ 二次增加，而不是线性下降。其次，输出误差界随 $\\sqrt{\\sum \\sigma_i^2}$ 缩放，而不是随 $\\sum \\sigma_i$ 线性缩放。\n- **理由**：“没有必要使用基于范数的界”这一说法直接与问题中要求使用“线性泛函稳定性界”并找出“合理准则”的要求相矛盾。该选项为了直觉而放弃了严谨的方法。\n- **结论**：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "代理模型的价值体现在其对未见数据的预测能力，即泛化能力。本实践将引导你完成一项至关重要的任务：如何正确地评估和验证你所构建模型的性能。我们将探讨在处理具有分组或依赖结构的数据时，“数据泄漏”的风险，并设计一个统计上可靠的交叉验证方案，以获得对模型真实泛化性能的无偏估计 ()。",
            "id": "4102024",
            "problem": "一个反应性溶质在恒定入流浓度 $c_0$ 和体积流量 $q$ 的条件下，流过一个长度为 $L$ 的多孔柱。其水相反应由一级速率常数 $k$ 和流体动力学弥散系数 $D$ 控制。高保真模拟器求解一维平流-弥散-反应偏微分方程\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = -u \\frac{\\partial c(x,t)}{\\partial x} + D \\frac{\\partial^2 c(x,t)}{\\partial x^2} - k\\,c(x,t),\n$$\n其中达西速度 $u = q/(\\phi A)$，孔隙度为 $\\phi$，横截面积为 $A$。穿透时间 $t_b$ 定义为在 $x=L$ 处的出流浓度满足 $c(L,t)/c_0 = \\alpha$（其中 $0  \\alpha  1$ 为固定阈值）的第一个时间点 $t$。它取决于佩克莱特数 $Pe = uL/D$ 和丹柯勒数 $Da = kL/u$。\n\n训练一个降阶代理模型，用于根据特征 $(u, D, k, \\phi, T, c_0)$ 和分类岩相来预测 $t_b$。数据集包含多个模拟复本，这些复本是通过在每个岩相内改变微观结构实现而生成的；每个复本都属于一个微观结构组标识符，该标识符编码了一个共享的孔隙尺度几何模型。共享相同微观结构标识符的复本表现出相关的弥散和反应路径，从而导致这些复本的 $t_b$ 值之间存在统计相关性。该代理模型将被用于在 $(u,D,k,\\phi,T,c_0)$ 的可比范围内，泛化到未见的微观结构组和岩相。\n\n您的任务是设计一个用于模型选择和超参数调整的 $k$-折交叉验证方案，该方案能在平方和绝对误差损失下，产生对泛化性能的无偏估计，并指明如何跨折计算性能指标：均方根误差 (RMSE)、平均绝对误差 (MAE) 和决定系数 ($R^2$)。设计必须防止数据泄露，并尊重数据的物理和统计结构。请考虑以下选项：\n\nA. 执行随机 $k$-折交叉验证，通过混洗所有单个复本，而不考虑微观结构组或岩相。在交叉验证之前，使用在整个数据集上计算的均值和方差对特征进行一次标准化。通过最小化各折RMSE的平均值来选择超参数。报告跨折平均的RMSE和MAE，并通过平均各折的 $R^2$ 值来计算 $R^2$。\n\nB. 使用分组 $k$-折交叉验证，其中折是在微观结构组标识符的层面上构建的，并进行分层以大致平衡各折中的岩相。在每个外部训练集划分中，为进行超参数调整执行嵌套的分组 $k'$-折交叉验证，以最小化RMSE，当RMSE差异在容差范围内时，使用MAE作为次要标准。仅使用在每折的训练部分计算出的统计数据来标准化特征。完成所有外部折后，在所有外部折的测试预测值和观测值的汇集集合上计算RMSE和MAE，并通过以下公式在汇集的外部测试预测值上计算 $R^2$：\n$$\nR^2 = 1 - \\frac{\\sum_{i=1}^{M} \\left(\\hat{t}_i - t_i\\right)^2}{\\sum_{i=1}^{M} \\left(t_i - \\bar{t}\\right)^2},\n$$\n其中 $M$ 是所有外部折的测试观测总数，$\\bar{t}$ 是它们的平均值。\n\nC. 通过将 $t_b$ 分箱到分位数中来构建分层 $k$-折交叉验证，确保每折具有相似的分位数分布，同时忽略微观结构组和岩相。对目标应用对数变换，并训练代理模型来预测 $\\log t_b$。通过最小化在对数变换尺度上计算的RMSE来选择超参数。通过平均各折的值报告对数尺度上的RMSE、MAE和 $R^2$。\n\nD. 使用空间块 $k$-折交叉验证，通过根据分配给一维柱的合成空间坐标来划分运行，然后通过最大化每折测试数据上的外部折 $R^2$ 来选择超参数。使用每折的训练统计数据来标准化特征。报告跨折平均的RMSE、MAE和 $R^2$。\n\nE. 在岩相层面使用留一岩相交叉验证。在每个外部训练集划分中，通过最小化加权RMSE来调整超参数，其中每个误差项的权重为 $1/t_b$。使用每折的训练统计数据来标准化特征。通过平均各折的系数报告 $R^2$，并通过汇集外部折来报告MAE。\n\n哪个选项为这个代理建模任务提供了科学上和统计上站得住脚的交叉验证设计和指标计算方法？\n\n答案选项：\nA. 随机 $k$ 折，全局标准化，平均各折的指标（包括 $R^2$）。\nB. 分组嵌套 $k$ 折，仅在训练集上标准化，对外部折汇集计算 RMSE/MAE/$R^2$，按岩相分层。\nC. 仅按对数尺度上的目标分位数分层，平均各折的对数指标。\nD. 空间块 $k$ 折，在测试折上调整超参数，平均各折的指标。\nE. 留一岩相法，使用 $1/t_b$ 逆权重，平均各折的 $R^2$，汇集计算 MAE。",
            "solution": "用户要求我为一种旨在预测多孔介质中溶质穿透时间的代理模型设计一个交叉验证方案。任务的核心是从一组选项中选择一个在科学和统计上最站得住脚的程序，确保该设计能产生对泛化性能的无偏估计，同时尊重特定的数据结构。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程：** 给出了一维平流-弥散-反应 (ADR) 偏微分方程：\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = -u \\frac{\\partial c(x,t)}{\\partial x} + D \\frac{\\partial^2 c(x,t)}{\\partial x^2} - k\\,c(x,t)\n$$\n- **参数：** 达西速度 $u = q/(\\phi A)$，弥散系数 $D$，一级反应速率常数 $k$，孔隙度 $\\phi$，长度 $L$，横截面积 $A$。\n- **目标变量：** 穿透时间 $t_b$，定义为出流浓度满足 $c(L,t)/c_0 = \\alpha$（其中 $0  \\alpha  1$ 为固定阈值）的第一个时间点 $t$。\n- **模型输入 (特征)：** $(u, D, k, \\phi, T, c_0)$ 和分类岩相。\n- **数据结构：** 数据集由模拟复本组成。\n    - 复本按`microstructure group identifier`（微观结构组标识符）分组。\n    - 共享一个`microstructure group identifier`的复本源自一个共享的孔隙尺度几何模型。\n    - 这种共享来源导致了统计相关性：同一微观结构组内的复本具有相关的弥散和反应路径，因此其 $t_b$ 值也相关。\n- **泛化目标：** 代理模型必须能泛化到未见的微观结构组和未见的岩相。\n- **任务要求：**\n    1. 设计一个用于模型选择和超参数调整的 $k$-折交叉验证 (CV) 方案。\n    2. 该方案必须能在平方和绝对误差损失下，产生对泛化性能的无偏估计。\n    3. 指明均方根误差 (RMSE)、平均绝对误差 (MAE) 和决定系数 ($R^2$) 的计算方法。\n    4. 设计必须防止数据泄露，并尊重数据的物理和统计结构。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于计算地球化学和输运现象领域。ADR方程是反应输运的基础模型。将微观结构（孔隙尺度几何）与宏观可观测量（$D$、$k$、$t_b$）联系起来的数据生成过程，是多孔介质研究中的标准范式。该设置在科学上是合理的。\n- **良定性：** 任务——为特定的数据结构和泛化目标设计一个CV方案——在应用统计学和机器学习中是一个定义明确的问题。\n- **客观性：** 问题使用精确、技术性的语言描述，没有主观性。\n- **完整性和一致性：** 问题提供了关于数据结构的关键信息：存在组（`microstructure group identifier`）以及这些组内样本的统计相关性。它还清楚地说明了泛化目标。这些信息对于确定正确的CV策略是必要且充分的。\n\n**步骤3：结论与行动**\n问题陈述是有效的。这是一个定义明确、有科学依据的问题，需要在物理模型的背景下仔细考虑统计学原理。我现在将进行解决方案推导和选项分析。\n\n### 解决方案推导\n\n主要挑战是设计一个交叉验证程序，该程序能为模型在新的、未见过的数据上的性能提供一个无偏估计。问题明确指出了数据中必须正确处理的两个关键结构性方面：\n1.  **分组数据：** 复本不是独立的；共享一个`microstructure group identifier`的复本是相关的。标准的随机 $k$-折交叉验证假设样本是独立同分布的 (IID)。在此处应用它会将相关的样本同时放入一个折的训练集和测试集中。这构成了数据泄露，因为模型将在与训练中见过的数据非常相似的数据上进行测试（即来自同一微观结构的其他复本），从而导致性能估计被人为夸大且有偏。正确的方法是确保来自单个组的所有复本都保持在同一个折中（要么全部在训练集中，要么全部在测试集中）。这可以通过使用**分组 $k$-折交叉验证**来实现，其中组就是`microstructure group identifiers`。\n2.  **层次结构与泛化：** 模型必须泛化到未见的`microstructure groups`和`lithofacies`。使用分组 $k$-折（以微观结构为组）直接评估了泛化到未见微观结构组的能力。为了确保性能估计不因测试集中岩相的特定分布而产生偏差，应构建折以使其能够代表整体的岩相分布。这通过对`lithofacies`类别进行**分层**来实现。这种组合被称为**分层分组 $k$-折交叉验证**。\n\n一个严谨的验证方案的进一步考虑：\n- **超参数调整：** 为避免偏差，必须仅使用主（外部）CV循环中每个折内可用的训练数据来调整超参数。这应通过**嵌套交叉验证**来正确完成，即在每个外部折的训练集上执行一个内部CV循环来选择最佳超参数。这个内部循环也必须尊重数据结构（即，它也应该是分组CV）。\n- **特征缩放：** 预处理步骤，如特征标准化，是建模流程的一部分。为防止数据泄露，用于缩放的参数（例如，均值和标准差）必须*仅*从每个折的训练数据中学习，然后应用于该折的训练集和测试集。\n- **指标计算：** 虽然可以为每个折计算性能指标然后取平均，但对于像 $R^2$ 这样的指标，这可能会有问题。一个更稳健的方法是**汇集**所有测试折的样本外预测值和相应的真实值，然后在这个汇集的数据上计算一组单一的指标 (RMSE, MAE, $R^2$)。汇集的 $R^2$ 的公式是 $R^2 = 1 - \\frac{\\sum_{i=1}^{M} (\\hat{t}_i - t_i)^2}{\\sum_{i=1}^{M} (t_i - \\bar{t})^2}$，其中求和遍历所有折中的全部 $M$ 个测试样本，$\\bar{t}$ 是所有真实测试值的平均值。\n\n基于这些原则，理想的验证方案涉及在嵌套结构中使用分层分组 $k$-折CV进行超参数调整，特征缩放严格在每折的训练数据上执行，最终指标在汇集的折外预测上计算。\n\n### 逐项分析选项\n\n**A. 执行随机 $k$-折交叉验证...**\n此选项提出了随机 $k$-折CV，它忽略了分组数据结构。这将把来自同一微观结构组的依赖复本分割到训练集和测试集中，导致数据泄露并产生过于乐观、有偏的性能估计。它还建议使用整个数据集进行特征标准化，这是另一种形式的数据泄露。最后，它建议平均各折的 $R^2$ 值，这在统计上不如在汇集结果上计算稳健。\n**结论：不正确。**\n\n**B. 使用分组 $k$-折交叉验证，其中折是在微观结构组标识符的层面上构建的，并进行分层以大致平衡各折中的岩相...**\n此选项正确地认识到需要使用`microstructure group identifiers`作为组进行**分组 $k$-折CV**，这防止了数据泄露的主要来源。它正确地建议通过**岩相分层**以确保代表性的折。它规定使用**嵌套交叉验证**进行超参数调整，这是避免与调整相关的偏差的正确方法。它正确地指出，**特征标准化**必须仅使用来自训练部分的统计数据。最后，它主张在所有测试预测的**汇集集合**上计算指标，包括正确的汇集 $R^2$ 公式。整个过程在统计上是合理的，并直接解决了问题的所有要求。\n**结论：正确。**\n\n**C. 通过将 $t_b$ 分箱到分位数中来构建分层 $k$-折交叉验证...**\n此选项建议基于目标变量 $t_b$ 进行分层。虽然这在某些情况下是一种有用的技术，可以确保折在输出方面是平衡的，但它完全忽略了基于`microstructure group identifiers`的关键分组结构。与选项A一样，它将导致数据泄露和有偏的评估。将目标进行对数变换并在对数尺度上报告指标的决定虽然合理，但并未修复CV设计中的根本缺陷。\n**结论：不正确。**\n\n**D. 使用空间块 $k$-折交叉验证...**\n此选项错误地应用了空间块CV的概念。此问题中的数据依赖性源于共享的组成员关系（`microstructure group identifier`），而不是模拟运行之间的空间或时间邻近性。此外，它犯了一个严重错误，即建议通过最大化**外部折测试数据**上的性能来选择超参数。测试集必须被保留，仅用于最终评估，而不能用于模型选择或调整过程的任何部分。这是一种严重的数据泄露形式，使整个性能估计无效。\n**结论：不正确。**\n\n**E. 在岩相层面使用留一岩相交叉验证...**\n此选项提出了留一法交叉验证，其中组是`lithofacies`。这是一个有效的策略，专门用于测试对未见岩相的泛化能力。它隐含地处理了较低级别的微观结构分组。然而，问题要求一个更通用的 $k$-折方案，以估计对未见微观结构*和*岩相的泛化性能。B中的方法（分层分组CV）为从未见过的、来自已见岩相分布的微观结构提供了更稳定和通用的性能估计。此外，选项E不如B完整：它没有为超参数调整指定嵌套循环，其混合指标计算（平均 $R^2$，汇集MAE）的建议也不如B中完全汇集的方法连贯。其为调整损失函数提出的逆 $t_b$ 加权与指定的评估标准（未加权的平方和绝对误差）不匹配。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}