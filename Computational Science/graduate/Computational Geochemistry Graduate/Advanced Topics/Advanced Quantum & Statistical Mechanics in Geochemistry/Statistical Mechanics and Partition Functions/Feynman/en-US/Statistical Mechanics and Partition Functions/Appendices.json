{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a foundational exercise, connecting the microscopic arrangement of point defects in a crystal lattice to a macroscopic thermodynamic quantity: configurational entropy. By deriving the free energy associated with creating vacancies, you will gain hands-on experience with the Boltzmann entropy formula, $S = k_{B} \\ln \\Omega$, and the powerful use of combinatorial methods and Stirling's approximation to count microstates and link them to thermodynamics .",
            "id": "4100029",
            "problem": "Consider a mineral lattice used in computational geochemistry simulations, with a fixed number of $M$ distinguishable lattice sites and $n$ point vacancies that can occupy any subset of those sites. Assume vacancies are indistinguishable, lattice sites are distinguishable, and there are no interactions between vacancies beyond site exclusion (at most one vacancy per site). The system is maintained at absolute temperature $T$ and the configurational contribution to the Helmholtz free energy is the only term considered.\n\nStarting from the Boltzmann definition of entropy, $S = k_{B} \\ln \\Omega$, where $k_{B}$ is the Boltzmann constant and $\\Omega$ is the number of microstates, perform the following:\n\n1. Construct the combinatorial count $\\Omega(M,n)$ of microstates corresponding to distributing $n$ indistinguishable vacancies among $M$ distinguishable sites.\n2. Using the Helmholtz free energy $F = U - T S$ and holding $M$ and $T$ fixed, derive the configurational contribution to the incremental vacancy formation free energy per added vacancy, defined as the derivative of the configurational free energy with respect to $n$. Clearly state any asymptotic approximations you use and justify them.\n3. Provide a closed-form analytical expression for this configurational contribution in terms of $M$, $n$, $k_{B}$, and $T$.\n\nExpress your final answer as a single closed-form analytic expression. Do not numerically evaluate it. No rounding is needed. If this were to be evaluated numerically, energy should be expressed in Joules.",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- System consists of a mineral lattice with $M$ distinguishable sites and $n$ point vacancies.\n- Vacancies are indistinguishable.\n- Lattice sites are distinguishable.\n- Interaction model: No interactions between vacancies beyond site exclusion (at most one vacancy per site).\n- Thermodynamic conditions: The system is at a fixed absolute temperature $T$. The number of lattice sites $M$ is fixed.\n- Entropy definition: The Boltzmann definition of entropy, $S = k_{B} \\ln \\Omega$, is to be used, where $k_{B}$ is the Boltzmann constant and $\\Omega$ is the number of microstates.\n- Free energy definition: Helmholtz free energy, $F = U - T S$.\n- Objective 1: Construct the combinatorial count of microstates, $\\Omega(M,n)$.\n- Objective 2: Derive the configurational contribution to the incremental vacancy formation free energy per added vacancy, defined as the derivative of the configurational free energy with respect to $n$, $\\frac{\\partial F_{conf}}{\\partial n}$.\n- Objective 3: Provide a closed-form analytical expression for this quantity in terms of $M$, $n$, $k_{B}$, and $T$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in statistical mechanics applied to solid-state physics or geochemistry, specifically modeling point defects in a crystal lattice.\n\n- **Scientifically Grounded:** The problem is based on fundamental principles of statistical mechanics, including the Boltzmann definition of entropy and the concept of Helmholtz free energy. The model of non-interacting point defects on a lattice is a widely used and scientifically sound approximation (the Bragg-Williams approximation).\n- **Well-Posed:** The problem provides a clear and complete description of the physical system and the quantities to be derived. The objectives are sequential and lead to a unique, meaningful analytical solution.\n- **Objective:** The language is formal, precise, and free of any subjective or opinion-based statements.\n\nThe phrase \"configurational contribution to the Helmholtz free energy is the only term considered\" implies that we focus on the component of free energy arising from the arrangement of vacancies, which is $F_{conf} = -T S_{conf}$, where $S_{conf}$ is the configurational entropy. The problem then asks for the \"configurational contribution to the incremental vacancy formation free energy\", which is a standard way of asking for the derivative of this specific term, $\\frac{\\partial}{\\partial n}(-TS_{conf})$, isolating it from the non-configurational energy of vacancy formation (which would be a constant, $\\epsilon_v$, in this model). The problem is self-contained under this standard interpretation. The mention of \"asymptotic approximations\" correctly anticipates the use of Stirling's approximation for differentiating factorial functions, which is appropriate for a system with a large number of sites and vacancies.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\n**1. Construct the Combinatorial Count $\\Omega(M,n)$**\n\nThe problem asks for the number of ways to distribute $n$ indistinguishable vacancies among $M$ distinguishable lattice sites, with the constraint that each site can hold at most one vacancy. This is a classic combinatorial problem of choosing $n$ objects from a set of $M$ distinct objects, where the order of selection does not matter. The number of such microstates, $\\Omega(M,n)$, is given by the binomial coefficient \"M choose n\".\n\n$$\n\\Omega(M,n) = \\binom{M}{n} = \\frac{M!}{n!(M-n)!}\n$$\n\n**2. Derive the Configurational Contribution to Incremental Free Energy**\n\nThe configurational entropy, $S$, is given by the Boltzmann formula:\n$$\nS(n) = k_{B} \\ln \\Omega(M,n) = k_{B} \\ln \\left( \\frac{M!}{n!(M-n)!} \\right)\n$$\nUsing the property of logarithms, this can be written as:\n$$\nS(n) = k_{B} \\left[ \\ln(M!) - \\ln(n!) - \\ln((M-n)!) \\right]\n$$\nThe problem specifies that only the configurational contribution to the Helmholtz free energy is to be considered. This contribution is $F_{conf} = -T S(n)$. We are asked to find the incremental free energy per added vacancy, which is the derivative of $F_{conf}$ with respect to $n$, holding $M$ and $T$ constant.\n$$\n\\frac{\\partial F_{conf}}{\\partial n} = \\frac{\\partial}{\\partial n} [-T S(n)] = -T \\frac{\\partial S(n)}{\\partial n}\n$$\nTo differentiate the entropy expression with respect to $n$, we must treat $n$ as a continuous variable. Since $n$, $M$, and $(M-n)$ are expected to be very large numbers in a macroscopic crystal, we can use Stirling's approximation for the natural logarithm of a factorial: $\\ln(x!) \\approx x \\ln x - x$ for large $x$. This is the asymptotic approximation mentioned in the problem statement.\n\nApplying Stirling's approximation to the terms in the entropy expression:\n$$\n\\ln(n!) \\approx n \\ln n - n\n$$\n$$\n\\ln((M-n)!) \\approx (M-n) \\ln(M-n) - (M-n)\n$$\nSubstituting these into the expression for $S(n)$:\n$$\nS(n) \\approx k_{B} \\left[ \\ln(M!) - (n \\ln n - n) - ((M-n) \\ln(M-n) - (M-n)) \\right]\n$$\n$$\nS(n) \\approx k_{B} \\left[ \\ln(M!) - n \\ln n + n - (M-n) \\ln(M-n) + M - n \\right]\n$$\nSimplifying the expression:\n$$\nS(n) \\approx k_{B} \\left[ \\ln(M!) + M - n \\ln n - (M-n) \\ln(M-n) \\right]\n$$\nNow, we differentiate $S(n)$ with respect to $n$. The terms $\\ln(M!)$ and $M$ are constants with respect to $n$.\n$$\n\\frac{\\partial S(n)}{\\partial n} \\approx \\frac{\\partial}{\\partial n} \\left[ k_{B} \\left( - n \\ln n - (M-n) \\ln(M-n) \\right) \\right]\n$$\nWe use the product rule for differentiation, $\\frac{d}{dx}(uv) = u'v + uv'$.\nFor the first term, $-n \\ln n$:\n$$\n\\frac{\\partial}{\\partial n}(-n \\ln n) = -\\left( \\frac{\\partial(n)}{\\partial n} \\ln n + n \\frac{\\partial(\\ln n)}{\\partial n} \\right) = - \\left( 1 \\cdot \\ln n + n \\cdot \\frac{1}{n} \\right) = -(\\ln n + 1)\n$$\nFor the second term, $-(M-n) \\ln(M-n)$:\n$$\n\\frac{\\partial}{\\partial n} (-(M-n) \\ln(M-n)) = -\\left( \\frac{\\partial(M-n)}{\\partial n} \\ln(M-n) + (M-n) \\frac{\\partial(\\ln(M-n))}{\\partial n} \\right)\n$$\n$$\n= -\\left( (-1) \\ln(M-n) + (M-n) \\frac{1}{M-n}(-1) \\right) = -\\left( -\\ln(M-n) - 1 \\right) = \\ln(M-n) + 1\n$$\nCombining these results:\n$$\n\\frac{\\partial S(n)}{\\partial n} \\approx k_{B} [ -(\\ln n + 1) + (\\ln(M-n) + 1) ] = k_{B} [ -\\ln n - 1 + \\ln(M-n) + 1 ]\n$$\n$$\n\\frac{\\partial S(n)}{\\partial n} = k_{B} [ \\ln(M-n) - \\ln n ] = k_{B} \\ln\\left(\\frac{M-n}{n}\\right)\n$$\n\n**3. Final Closed-Form Analytical Expression**\n\nThe configurational contribution to the incremental vacancy formation free energy per added vacancy is $-T \\frac{\\partial S(n)}{\\partial n}$.\n$$\n\\frac{\\partial F_{conf}}{\\partial n} = -T \\left[ k_{B} \\ln\\left(\\frac{M-n}{n}\\right) \\right] = -k_{B}T \\ln\\left(\\frac{M-n}{n}\\right)\n$$\nThis expression can be equivalently written by inverting the argument of the logarithm:\n$$\n\\frac{\\partial F_{conf}}{\\partial n} = k_{B}T \\ln\\left(\\left(\\frac{M-n}{n}\\right)^{-1}\\right) = k_{B}T \\ln\\left(\\frac{n}{M-n}\\right)\n$$\nThis is the final closed-form analytical expression for the requested quantity.",
            "answer": "$$\n\\boxed{k_{B} T \\ln\\left(\\frac{n}{M-n}\\right)}\n$$"
        },
        {
            "introduction": "Moving from discrete lattices to continuous fluids, this exercise demonstrates how to compute virial coefficients, which quantify a real fluid's deviation from ideal gas behavior. You will implement a Monte Carlo integration scheme—a cornerstone of computational statistical mechanics—to evaluate the high-dimensional integrals that link microscopic interaction potentials to the macroscopic equation of state . This practice provides a direct look at how we numerically bridge the gap between molecular forces and measurable fluid properties.",
            "id": "4100040",
            "problem": "You will design and implement a computational method, based on Monte Carlo (MC) sampling, to estimate the second and third virial coefficients $B_2$ and $B_3$ of a simplified geochemical fluid model from simulated pair and triplet correlation functions and to quantify the associated statistical uncertainties. The objective is to derive $B_2$ and $B_3$ starting from first principles of statistical mechanics and to compute them via high-dimensional integrals using MC integration. All quantities must be expressed in the International System of Units (SI). The final program must produce the requested outputs for a defined test suite without any external input.\n\nThe fluid is composed of identical spherical particles that interact via a pairwise-additive potential $u(r)$ that models a hydrated hard-sphere with a screened interaction tail:\n$$\nu(r) =\n\\begin{cases}\n\\infty, & r  \\sigma, \\\\\n\\epsilon \\,\\dfrac{\\sigma}{r}\\, e^{-\\kappa (r - \\sigma)},  r \\ge \\sigma,\n\\end{cases}\n$$\nwhere $\\sigma$ is the hard-sphere diameter in meters, $\\epsilon$ is the interaction energy scale in joules, and $\\kappa$ is the inverse screening length in inverse meters. Let $k_{\\mathrm{B}}$ denote the Boltzmann constant, and $\\beta = 1/(k_{\\mathrm{B}} T)$ the inverse thermal energy at absolute temperature $T$ in kelvins.\n\nAssume the simulated pair correlation function $g(r)$ and triplet correlation function $g^{(3)}(r_{12}, r_{13}, r_{23})$ are given by the low-density forms appropriate for this model:\n$$\ng(r) = \n\\begin{cases}\n0,  r  \\sigma, \\\\\n\\exp\\!\\left(-\\beta\\, u(r)\\right),  r \\ge \\sigma,\n\\end{cases}\n\\quad\\text{and}\\quad\ng^{(3)}(r_{12}, r_{13}, r_{23}) = g(r_{12})\\, g(r_{13})\\, g(r_{23}),\n$$\nwhich is the Kirkwood superposition approximation suited to low-density conditions and pairwise-additive interactions.\n\nStarting from the canonical ensemble and the virial expansion for the pressure of a classical fluid with pairwise-additive interactions, derive expressions for the second and third virial coefficients $B_2$ and $B_3$ that depend on the Mayer $f$-function and, by explicit logical steps, connect those expressions to the given $g(r)$ and $g^{(3)}(r_{12}, r_{13}, r_{23})$. Then, construct MC estimators for the multidimensional integrals that define $B_2$ and $B_3$, including formulas for the standard error (uncertainty) of each estimator. Your estimators must be based on uniform sampling in configuration space inside a sphere of radius $R_{\\mathrm{cut}}$ centered on a reference particle, using independent samples of positions for the other particles. Justify the truncation to a finite $R_{\\mathrm{cut}}$ and explicitly state how the estimator scales with the sampled volume. Assume that, for the chosen parameters, the integrands are effectively negligible beyond $R_{\\mathrm{cut}}$.\n\nImplementation requirements:\n- Use uniform-in-volume sampling inside a ball of radius $R_{\\mathrm{cut}}$ for single-particle positions relative to a fixed reference particle for $B_2$, and independent uniform-in-volume sampling inside the same ball for two particles relative to the same reference for $B_3$.\n- Use the generated samples to evaluate the required integrands expressed in terms of $g(r)$ and $g^{(3)}$ and compute $B_2$ and $B_3$ along with their standard errors.\n- Express $B_2$ in cubic meters and $B_3$ in square cubic meters (i.e., $(\\mathrm{m}^3)^2 = \\mathrm{m}^6$). Report uncertainties in the same units as their corresponding coefficients.\n- Use $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$.\n\nTest suite:\nFor each test case $i$, the parameters are $(\\sigma_i, \\epsilon_i, \\kappa_i, T_i, R_{\\mathrm{cut},i}, N_{2,i}, N_{3,i}, \\text{seed}_i)$. You must evaluate $B_2$ and $B_3$ and their uncertainties using $N_{2,i}$ samples for the $B_2$ estimator and $N_{3,i}$ samples for the $B_3$ estimator, with random number generator seeded by $\\text{seed}_i$ for reproducibility. Use the following four cases:\n1. $(\\sigma,\\epsilon,\\kappa,T,R_{\\mathrm{cut}},N_2,N_3,\\text{seed}) = (3.0\\times 10^{-10},\\ 0.0,\\ 1.0\\times 10^{10},\\ 298.0,\\ 6.0\\times 10^{-9},\\ 200000,\\ 60000,\\ 42)$\n2. $(\\sigma,\\epsilon,\\kappa,T,R_{\\mathrm{cut}},N_2,N_3,\\text{seed}) = (3.0\\times 10^{-10},\\ 4.0\\times 10^{-21},\\ 8.0\\times 10^{9},\\ 298.0,\\ 3.0\\times 10^{-9},\\ 150000,\\ 60000,\\ 123)$\n3. $(\\sigma,\\epsilon,\\kappa,T,R_{\\mathrm{cut}},N_2,N_3,\\text{seed}) = (3.0\\times 10^{-10},\\ 1.0\\times 10^{-20},\\ 2.0\\times 10^{9},\\ 250.0,\\ 6.0\\times 10^{-9},\\ 150000,\\ 60000,\\ 777)$\n4. $(\\sigma,\\epsilon,\\kappa,T,R_{\\mathrm{cut}},N_2,N_3,\\text{seed}) = (3.0\\times 10^{-10},\\ 4.0\\times 10^{-21},\\ 8.0\\times 10^{9},\\ 1000.0,\\ 3.0\\times 10^{-9},\\ 150000,\\ 60000,\\ 999)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a list of four floats $[B_2,B_{2,\\mathrm{se}},B_3,B_{3,\\mathrm{se}}]$ for the corresponding test case, in the same order as above. For example, the printed line should be of the form:\n$$\n[ [B_2^{(1)}, B_{2,\\mathrm{se}}^{(1)}, B_3^{(1)}, B_{3,\\mathrm{se}}^{(1)}], [B_2^{(2)}, B_{2,\\mathrm{se}}^{(2)}, B_3^{(2)}, B_{3,\\mathrm{se}}^{(2)}], [B_2^{(3)}, B_{2,\\mathrm{se}}^{(3)}, B_3^{(3)}, B_{3,\\mathrm{se}}^{(3)}], [B_2^{(4)}, B_{2,\\mathrm{se}}^{(4)}, B_3^{(4)}, B_{3,\\mathrm{se}}^{(4)}] ]\n$$\nAll numbers must be in SI units as specified and printed as Python floats.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique and verifiable solution. The underlying principles are standard tenets of classical statistical mechanics, and the parameters provided are physically realistic. Thus, the problem is deemed valid.\n\nThe solution proceeds by first deriving the expressions for the second and third virial coefficients, $B_2$ and $B_3$, from the principles of statistical mechanics. Subsequently, we construct Monte Carlo (MC) estimators for these coefficients and their statistical uncertainties.\n\n### Theoretical Framework\n\nThe equation of state for a classical fluid can be expressed as a power series in the number density $\\rho = N/V$, known as the virial expansion:\n$$\n\\frac{P}{k_{\\mathrm{B}} T} = \\rho + B_2(T) \\rho^2 + B_3(T) \\rho^3 + \\mathcal{O}(\\rho^4)\n$$\nwhere $P$ is the pressure, $T$ is the absolute temperature, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $B_n(T)$ are the temperature-dependent virial coefficients. For a system with pairwise-additive interactions, these coefficients can be expressed as integrals over the Mayer $f$-function, defined as $f(r) = e^{-\\beta u(r)} - 1$, where $u(r)$ is the pair potential and $\\beta = 1/(k_{\\mathrm{B}} T)$.\n\nThe problem provides the low-density form of the pair correlation function, $g(r)$, as:\n$$\ng(r) = e^{-\\beta u(r)}\n$$\nThis allows a direct relation between the Mayer function and the pair correlation function:\n$$\nf(r) = g(r) - 1\n$$\n\n**Second Virial Coefficient ($B_2$)**\n\nThe second virial coefficient $B_2$ is given by the cluster integral involving two particles:\n$$\nB_2 = -\\frac{1}{2} \\int_{\\mathbb{R}^3} f(r) \\, d\\mathbf{r}\n$$\nwhere the integral is over the relative position vector $\\mathbf{r}$ of two particles. Substituting $f(r) = g(r) - 1$, we obtain:\n$$\nB_2 = -\\frac{1}{2} \\int_{\\mathbb{R}^3} [g(r) - 1] \\, d\\mathbf{r}\n$$\nIn spherical coordinates, this becomes $B_2 = -2\\pi \\int_0^\\infty [g(r) - 1] r^2 \\, dr$.\n\n**Third Virial Coefficient ($B_3$)**\n\nFor a pairwise-additive potential, the third virial coefficient $B_3$ is defined by the irreducible cluster integral involving three particles forming a triangle:\n$$\nB_3 = -\\frac{1}{3} \\int_{\\mathbb{R}^3} \\int_{\\mathbb{R}^3} f(r_{12}) f(r_{13}) f(r_{23}) \\, d\\mathbf{r}_2 \\, d\\mathbf{r}_3\n$$\nwhere particle $1$ is fixed at the origin, and $\\mathbf{r}_2$ and $\\mathbf{r}_3$ are the position vectors of the other two particles, with $r_{12} = |\\mathbf{r}_2|$, $r_{13} = |\\mathbf{r}_3|$, and $r_{23} = |\\mathbf{r}_3 - \\mathbf{r}_2|$. Using the relation $f(r) = g(r) - 1$, the integrand for $B_3$ is:\n$$\n[g(r_{12}) - 1][g(r_{13}) - 1][g(r_{23}) - 1]\n$$\nThe problem states that the triplet correlation function follows the Kirkwood superposition approximation, $g^{(3)}(r_{12}, r_{13}, r_{23}) = g(r_{12}) g(r_{13}) g(r_{23})$. This approximation is consistent with the pairwise-additive nature of the underlying potential at low densities, which is the implicit assumption for the standard $B_3$ expression in terms of Mayer functions.\n\n### Monte Carlo Estimation\n\nThe integrals for $B_2$ and $B_3$ are high-dimensional and can be efficiently evaluated using Monte Carlo integration. We truncate the integration domain from all of space to a sphere of radius $R_{\\mathrm{cut}}$, assuming that the integrand $g(r) - 1$ is negligible for $r  R_{\\mathrm{cut}}$. This is justified by the exponential decay of the interaction potential $u(r)$, which causes $g(r)$ to approach $1$ rapidly. The volume of this spherical domain is $V_{\\mathrm{cut}} = \\frac{4}{3}\\pi R_{\\mathrm{cut}}^3$.\n\nThe general principle of MC integration for an integral $I = \\int_\\Omega h(\\mathbf{x}) d\\mathbf{x}$ is to estimate it as $\\hat{I} = V_\\Omega \\langle h(\\mathbf{x}) \\rangle_N = \\frac{V_\\Omega}{N} \\sum_{i=1}^N h(\\mathbf{x}_i)$, where $\\mathbf{x}_i$ are $N$ points sampled uniformly from the volume $V_\\Omega$.\n\n**Estimator for $B_2$**\n\nApplying this principle to $B_2$, we sample $N_2$ independent positions $\\mathbf{r}_i$ uniformly from the sphere of volume $V_{\\mathrm{cut}}$. The estimator for $B_2$ is:\n$$\n\\hat{B}_2 = -\\frac{1}{2} V_{\\mathrm{cut}} \\left\\langle g(r) - 1 \\right\\rangle_{N_2} = -\\frac{V_{\\mathrm{cut}}}{2N_2} \\sum_{i=1}^{N_2} [g(r_i) - 1]\n$$\nwhere $r_i = |\\mathbf{r}_i|$.\n\n**Estimator for $B_3$**\n\nFor $B_3$, we are estimating a $6$-dimensional integral. We sample $N_3$ pairs of independent positions, $(\\mathbf{r}_{A,i}, \\mathbf{r}_{B,i})$, where each vector is drawn uniformly from the sphere of volume $V_{\\mathrm{cut}}$. The integration volume is $V_{\\mathrm{cut}}^2$. The estimator for $B_3$ is:\n$$\n\\hat{B}_3 = -\\frac{1}{3} V_{\\mathrm{cut}}^2 \\left\\langle [g(r_A) - 1][g(r_B) - 1][g(r_{AB}) - 1] \\right\\rangle_{N_3}\n$$\n$$\n\\hat{B}_3 = -\\frac{V_{\\mathrm{cut}}^2}{3N_3} \\sum_{i=1}^{N_3} [g(r_{A,i}) - 1][g(r_{B,i}) - 1][g(r_{AB,i}) - 1]\n$$\nwhere $r_{A,i} = |\\mathbf{r}_{A,i}|$, $r_{B,i} = |\\mathbf{r}_{B,i}|$, and $r_{AB,i} = |\\mathbf{r}_{A,i} - \\mathbf{r}_{B,i}|$.\n\n**Uncertainty Quantification**\n\nThe statistical uncertainty of the MC estimate is the standard error of the mean. For an estimator $\\hat{X} = \\frac{1}{N}\\sum_{i=1}^N x_i$, the standard error is $X_{se} = s_x / \\sqrt{N}$, where $s_x$ is the sample standard deviation of the values $\\{x_i\\}$, calculated with $N-1$ degrees of freedom.\nLet $y_i = -\\frac{1}{2} V_{\\mathrm{cut}} [g(r_i) - 1]$. Then $\\hat{B}_2 = \\langle y_i \\rangle_{N_2}$ and the uncertainty is:\n$$\nB_{2, \\mathrm{se}} = \\frac{\\mathrm{StdDev}(\\{y_i\\})}{\\sqrt{N_2}} = \\sqrt{\\frac{1}{N_2(N_2-1)} \\sum_{i=1}^{N_2} (y_i - \\hat{B}_2)^2}\n$$\nSimilarly, let $z_i = -\\frac{1}{3} V_{\\mathrm{cut}}^2 [g(r_{A,i})-1][g(r_{B,i})-1][g(r_{AB,i})-1]$. Then $\\hat{B}_3 = \\langle z_i \\rangle_{N_3}$ and the uncertainty is:\n$$\nB_{3, \\mathrm{se}} = \\frac{\\mathrm{StdDev}(\\{z_i\\})}{\\sqrt{N_3}} = \\sqrt{\\frac{1}{N_3(N_3-1)} \\sum_{i=1}^{N_3} (z_i - \\hat{B}_3)^2}\n$$\n\n### Algorithmic Design\n\nThe core of the algorithm is a function to generate random points uniformly within a sphere of radius $R_{\\mathrm{cut}}$. This is achieved by first sampling a radius $r$ from the distribution with probability density $p(r) \\propto r^2$ for $r \\in [0, R_{\\mathrm{cut}}]$, which is done by setting $r = R_{\\mathrm{cut}} \\cdot U^{1/3}$ where $U$ is a uniform random number in $[0,1)$. Then, a direction is chosen uniformly from the surface of a unit sphere by generating a $3$D vector of standard normal deviates and normalizing it. The final sample point is the product of the sampled radius and the normalized direction vector.\n\nFor each test case, the algorithm initializes a pseudorandom number generator with the specified seed for reproducibility. It then proceeds to compute $\\hat{B}_2$ and $B_{2, se}$ using $N_2$ samples, and $\\hat{B}_3$ and $B_{3, se}$ using $N_3$ samples, according to the estimators described above. The results are collected and formatted into the required output string. The first test case ($\\epsilon=0.0$) corresponds to a hard-sphere fluid, for which the exact value of $B_2$ is $\\frac{2}{3}\\pi\\sigma^3$, providing a robust check on the correctness of the implementation for the $B_2$ calculation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the second and third virial coefficients (B2, B3) and their\n    statistical uncertainties for a simplified geochemical fluid model using\n    Monte Carlo integration based on statistical mechanics principles.\n    \"\"\"\n\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        # (sigma, epsilon, kappa, T, R_cut, N2, N3, seed)\n        (3.0e-10, 0.0, 1.0e10, 298.0, 6.0e-9, 200000, 60000, 42),\n        (3.0e-10, 4.0e-21, 8.0e9, 298.0, 3.0e-9, 150000, 60000, 123),\n        (3.0e-10, 1.0e-20, 2.0e9, 250.0, 6.0e-9, 150000, 60000, 777),\n        (3.0e-10, 4.0e-21, 8.0e9, 1000.0, 3.0e-9, 150000, 60000, 999),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        sigma, epsilon, kappa, T, R_cut, N2, N3, seed = case\n        \n        rng = np.random.default_rng(seed)\n        beta = 1.0 / (k_B * T)\n        V_cut = (4.0 / 3.0) * np.pi * R_cut**3\n\n        def u_potential(r, sigma, epsilon, kappa):\n            \"\"\"Calculates the pair potential u(r) for r = sigma.\"\"\"\n            if epsilon == 0:\n                return 0.0\n            return epsilon * (sigma / r) * np.exp(-kappa * (r - sigma))\n\n        def g_correlation(r, beta, sigma, epsilon, kappa):\n            \"\"\"Calculates the pair correlation function g(r).\"\"\"\n            if r  sigma:\n                return 0.0\n            potential = u_potential(r, sigma, epsilon, kappa)\n            return np.exp(-beta * potential)\n\n        def sample_sphere(R, rng):\n            \"\"\"Generates a random 3D vector uniformly from a sphere of radius R.\"\"\"\n            # Generate a random direction on a unit sphere\n            vec = rng.normal(size=3)\n            # Avoid division by zero, though highly unlikely\n            norm = np.linalg.norm(vec)\n            if norm == 0:\n                return np.array([0.0, 0.0, 0.0]) # Or handle as error\n            vec /= norm\n            \n            # Generate a random radius with p(r) ~ r^2\n            radius = R * (rng.random() ** (1.0 / 3.0))\n            \n            return radius * vec\n\n        # --- B2 Calculation ---\n        y_values = np.zeros(N2)\n        for i in range(N2):\n            r_vec = sample_sphere(R_cut, rng)\n            r = np.linalg.norm(r_vec)\n            integrand_val = g_correlation(r, beta, sigma, epsilon, kappa) - 1.0\n            y_values[i] = -0.5 * V_cut * integrand_val\n\n        B2 = np.mean(y_values)\n        if N2  1:\n            B2_se = np.std(y_values, ddof=1) / np.sqrt(N2)\n        else:\n            B2_se = 0.0\n\n        # --- B3 Calculation ---\n        z_values = np.zeros(N3)\n        for i in range(N3):\n            r_A_vec = sample_sphere(R_cut, rng)\n            r_B_vec = sample_sphere(R_cut, rng)\n\n            r_A = np.linalg.norm(r_A_vec)\n            r_B = np.linalg.norm(r_B_vec)\n            r_AB = np.linalg.norm(r_A_vec - r_B_vec)\n\n            f_A = g_correlation(r_A, beta, sigma, epsilon, kappa) - 1.0\n            f_B = g_correlation(r_B, beta, sigma, epsilon, kappa) - 1.0\n            f_AB = g_correlation(r_AB, beta, sigma, epsilon, kappa) - 1.0\n\n            integrand_val = f_A * f_B * f_AB\n            z_values[i] = -(1.0 / 3.0) * (V_cut**2) * integrand_val\n        \n        B3 = np.mean(z_values)\n        if N3  1:\n            B3_se = np.std(z_values, ddof=1) / np.sqrt(N3)\n        else:\n            B3_se = 0.0\n\n        results.append([B2, B2_se, B3, B3_se])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Our final practice transitions from static equilibrium properties to the dynamics of molecular motion. Here, you will calculate a fundamental transport property, the self-diffusion coefficient, by integrating the velocity autocorrelation function (VACF) based on the Green-Kubo relations . This task involves not only understanding the connection between microscopic fluctuations and macroscopic transport but also applying the critical finite-size corrections necessary for interpreting results from molecular simulations.",
            "id": "4100012",
            "problem": "You are given a computational geochemistry task framed in the language of equilibrium statistical mechanics, focusing on the self-diffusion of sodium ions in water. The goal is to estimate the self-diffusion coefficient of sodium cation ($\\mathrm{Na}^+$) in liquid water from the Velocity Autocorrelation Function (VACF) that is consistent with a canonical ensemble and then analyze hydrodynamic finite-size corrections to the diffusion coefficient for cubic periodic boundary conditions.\n\nStarting from the canonical ensemble with the partition function, you must derive the appropriate relation connecting the self-diffusion coefficient to an equilibrium time correlation function. You must formalize and implement a numerical procedure to estimate the self-diffusion coefficient from a synthetic Molecular Dynamics (MD) VACF that respects isotropy and equipartition of energy. Then, you must apply the hydrodynamic finite-size correction for cubic periodic boundary conditions.\n\nUse the following fundamental base:\n- The canonical partition function $Z$ and the corresponding equilibrium average as the probability measure for time correlation functions.\n- The equipartition theorem for translational degrees of freedom, which implies $\\langle v^2 \\rangle = 3 k_{\\mathrm{B}} T / m$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $m$ is the particle mass.\n- The linear response formalism that connects transport coefficients to equilibrium time correlation functions.\n- Hydrodynamic theory of periodic images in a cubic simulation box, which yields a finite-size correction to the measured diffusion coefficient in the presence of periodic boundary conditions.\n\nConstruct a synthetic, isotropic dot-product VACF $C(t)$ consistent with equilibrium for $\\mathrm{Na}^+$ as follows: let $C(t)$ be a weighted sum of decaying exponentials scaled by the equilibrium mean-square speed. Specifically, for each case, define weights $\\{w_i\\}$ that sum to $1$ and decay times $\\{\\tau_i\\}$, and use the representation $C(t) \\equiv \\langle \\mathbf{v}(0)\\cdot \\mathbf{v}(t)\\rangle$ modeled so that it satisfies $C(0)=\\langle v^2 \\rangle$. Integrate the VACF numerically over time to obtain the measured self-diffusion coefficient in the finite simulation box of length $L$. Then, apply a hydrodynamic finite-size correction appropriate for cubic periodic boundary conditions parameterized by a dimensionless constant. The final corrected value should be reported.\n\nPhysical constants to use:\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\, \\mathrm{J/K}$.\n- Avogadro number $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\, \\mathrm{mol^{-1}}$.\n- Hydrodynamic lattice-sum constant for a cubic periodic box $\\xi = 2.837297$.\n\nThe particle mass $m$ must be computed from the molar mass $M$ via $m = M / N_{\\mathrm{A}}$. The VACF must be constructed to be physically plausible and consistent with equipartition. Use numerical integration over time with a uniform time step to approximate the time integral needed to estimate the diffusion coefficient from the VACF. Assume isotropy in three dimensions when connecting the dot-product VACF to the scalar diffusion coefficient.\n\nUnits and output:\n- Express every diffusion coefficient in $\\mathrm{m^2/s}$.\n- Use the time step $dt$ in $\\mathrm{s}$.\n- The angle unit is not applicable to this task.\n- No percentages are involved in this task.\n\nTest suite:\nFor all test cases, construct the VACF on a uniform time grid from $t=0$ to $t=t_{\\max}$ with step $dt$. Use $t_{\\max} = 1.0 \\times 10^{-11}\\, \\mathrm{s}$ and $dt = 5.0 \\times 10^{-16}\\, \\mathrm{s}$. All VACFs are sums of exponentials consistent with $C(0)=\\langle v^2 \\rangle$ and weights summing to $1$.\n\nProvide three test cases with the following parameters:\n1. Happy path case (moderate box and realistic water viscosity):\n   - Temperature $T = 298\\, \\mathrm{K}$.\n   - Molar mass of $\\mathrm{Na}^+$ $M = 22.989769 \\times 10^{-3}\\, \\mathrm{kg/mol}$.\n   - Box length $L = 3.0 \\times 10^{-9}\\, \\mathrm{m}$.\n   - Dynamic viscosity of water $\\eta = 8.90 \\times 10^{-4}\\, \\mathrm{Pa \\cdot s}$.\n   - VACF model: single exponential with weights $\\{1.0\\}$ and decay times $\\{\\tau_1\\}$ where $\\tau_1 = 1.2 \\times 10^{-14}\\, \\mathrm{s}$.\n\n2. Mixed relaxation case (larger box, two-time-scale relaxation):\n   - Temperature $T = 298\\, \\mathrm{K}$.\n   - Molar mass of $\\mathrm{Na}^+$ $M = 22.989769 \\times 10^{-3}\\, \\mathrm{kg/mol}$.\n   - Box length $L = 6.0 \\times 10^{-9}\\, \\mathrm{m}$.\n   - Dynamic viscosity of water $\\eta = 8.90 \\times 10^{-4}\\, \\mathrm{Pa \\cdot s}$.\n   - VACF model: bi-exponential with weights $\\{0.7, 0.3\\}$ and decay times $\\{\\tau_1, \\tau_2\\}$ where $\\tau_1 = 1.0 \\times 10^{-14}\\, \\mathrm{s}$ and $\\tau_2 = 6.0 \\times 10^{-14}\\, \\mathrm{s}$.\n\n3. Higher temperature and lower viscosity case (smaller box, faster dynamics):\n   - Temperature $T = 350\\, \\mathrm{K}$.\n   - Molar mass of $\\mathrm{Na}^+$ $M = 22.989769 \\times 10^{-3}\\, \\mathrm{kg/mol}$.\n   - Box length $L = 4.0 \\times 10^{-9}\\, \\mathrm{m}$.\n   - Dynamic viscosity of water $\\eta = 4.00 \\times 10^{-4}\\, \\mathrm{Pa \\cdot s}$.\n   - VACF model: single exponential with weights $\\{1.0\\}$ and decay times $\\{\\tau_1\\}$ where $\\tau_1 = 0.8 \\times 10^{-14}\\, \\mathrm{s}$.\n\nYour program must:\n- Construct $C(t)$ using the given parameters and the equilibrium mean-square speed $\\langle v^2 \\rangle = 3 k_{\\mathrm{B}} T / m$.\n- Numerically integrate $C(t)$ over $t \\in [0,t_{\\max}]$ with step $dt$ to obtain the finite-box estimate of the self-diffusion coefficient (denote this as $D(L)$).\n- Apply the finite-size correction for a cubic periodic box to obtain the infinite-system limit $D(\\infty)$, using hydrodynamic theory and the constant $\\xi$ provided.\n- Produce the final output as a single line containing the results for all test cases as a comma-separated list enclosed in square brackets. Each element must be a two-element list $[D(L), D(\\infty)]$ with both entries in $\\mathrm{m^2/s}$, for the three test cases in the same order they were specified. For example, the final output format must be like $[[D_1(L),D_1(\\infty)],[D_2(L),D_2(\\infty)],[D_3(L),D_3(\\infty)]]$.\n\nScientifically realistic constraints:\n- Ensure that the synthetic VACF is nonnegative at $t=0$ and monotonically decaying in each exponential component.\n- The weights must sum to $1$ and all decay times must be positive.\n- The final corrected diffusion coefficient $D(\\infty)$ must be greater than or equal to the uncorrected $D(L)$ for the given cubic periodic boundary conditions.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[result_case1_DL,result_case1_Dinf],[result_case2_DL,result_case2_Dinf],[result_case3_DL,result_case3_Dinf]]\").",
            "solution": "We connect the computation to equilibrium statistical mechanics and partition functions. Consider a single $\\mathrm{Na}^+$ ion in liquid water at equilibrium in the canonical ensemble at temperature $T$. The canonical partition function $Z$ defines the equilibrium measure for microstates. Time correlation functions, such as the Velocity Autocorrelation Function (VACF), are computed as equilibrium averages over the ensemble and are central in linear response theory.\n\nThe VACF is defined as $C(t) \\equiv \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle$, with the average taken over the canonical ensemble at equilibrium. For an isotropic system, we have $C(0) = \\langle v^2 \\rangle = \\langle v_x^2 + v_y^2 + v_z^2 \\rangle = 3 \\langle v_x^2 \\rangle$. From the equipartition theorem applied to translational motion in three dimensions, the mean-square speed is $\\langle v^2 \\rangle = 3 k_{\\mathrm{B}} T / m$, where $m$ is the mass of the ion.\n\nThe Green-Kubo relation arising from linear response theory connects the self-diffusion coefficient $D$ to the integral of the equilibrium VACF. Specifically, for isotropic three-dimensional systems, the scalar diffusion coefficient can be written in terms of the dot-product VACF as\n$$\nD = \\frac{1}{3} \\int_{0}^{\\infty} \\langle \\mathbf{v}(0)\\cdot \\mathbf{v}(t) \\rangle \\, dt = \\int_{0}^{\\infty} \\langle v_x(0) v_x(t) \\rangle \\, dt .\n$$\nThis relation stems from the fluctuation-dissipation theorem in the canonical ensemble, in which transport coefficients are equilibrium time integrals of appropriate correlation functions derived from the partition function $Z$.\n\nTo compute $D$ numerically, we construct a synthetic, physically plausible VACF $C(t)$ that respects isotropy and equipartition. We model the dot-product VACF as a weighted sum of exponentials scaled by $\\langle v^2 \\rangle$:\n$$\nC(t) = \\langle v^2 \\rangle \\sum_{i} w_i e^{-t/\\tau_i},\n$$\nwith $w_i \\ge 0$, $\\sum_i w_i = 1$, and $\\tau_i  0$. This construction ensures $C(0) = \\langle v^2 \\rangle$ and yields a nonnegative, monotonically decaying form for each component. Under this model, the analytic integral is\n$$\n\\int_{0}^{\\infty} C(t)\\, dt = \\langle v^2 \\rangle \\sum_i w_i \\tau_i,\n$$\nand hence\n$$\nD = \\frac{1}{3} \\langle v^2 \\rangle \\sum_i w_i \\tau_i = \\frac{k_{\\mathrm{B}} T}{m} \\sum_i w_i \\tau_i .\n$$\nIn the program, we perform the numerical integration by the trapezoidal rule on a uniform grid $(t_0, t_1, \\ldots, t_N)$ with step $dt$, approximating\n$$\n\\int_{0}^{t_{\\max}} C(t)\\, dt \\approx \\sum_{n=0}^{N-1} \\frac{C(t_n) + C(t_{n+1})}{2} \\, dt ,\n$$\nwith $t_{\\max}$ chosen large enough so that contributions beyond $t_{\\max}$ are negligible for the exponential decays considered. We then compute the finite-box estimate $D(L)$ as\n$$\nD(L) = \\frac{1}{3} \\int_{0}^{t_{\\max}} C(t)\\, dt .\n$$\n\nMolecular Dynamics (MD) simulations of diffusion in a finite, cubic periodic box suffer from hydrodynamic finite-size effects due to the periodic images. Hydrodynamic theory for a cubic box with periodic boundary conditions (PBC) and Ewald-like summation leads to the leading-order finite-size correction (Yeh-Hummer) for the diffusion coefficient:\n$$\nD(L) = D(\\infty) - \\frac{\\xi k_{\\mathrm{B}} T}{6 \\pi \\eta L},\n$$\nwhere $\\eta$ is the dynamic viscosity, $L$ is the box length, and $\\xi$ is a dimensionless constant for the cubic lattice sum, $\\xi = 2.837297$. Inverting, the infinite-system diffusion coefficient is\n$$\nD(\\infty) = D(L) + \\frac{\\xi k_{\\mathrm{B}} T}{6 \\pi \\eta L} .\n$$\nThis expression captures the leading-order hydrodynamic coupling of a diffusing particle to its periodic images.\n\nAlgorithmic steps implemented in the program:\n1. For each test case, read $(T, M, L, \\eta, \\{w_i\\}, \\{\\tau_i\\}, t_{\\max}, dt)$.\n2. Compute the single-particle mass $m = M / N_{\\mathrm{A}}$, with $N_{\\mathrm{A}}$ the Avogadro number.\n3. Compute the mean-square speed $\\langle v^2 \\rangle = 3 k_{\\mathrm{B}} T / m$.\n4. Build a time grid from $0$ to $t_{\\max}$ with step $dt$, and construct $C(t)$ via $C(t) = \\langle v^2 \\rangle \\sum_i w_i e^{-t/\\tau_i}$.\n5. Numerically integrate $C(t)$ via the trapezoidal rule to estimate $\\int_0^{t_{\\max}} C(t)\\, dt$.\n6. Compute the finite-box diffusion coefficient $D(L) = \\frac{1}{3} \\int_0^{t_{\\max}} C(t)\\, dt$.\n7. Apply the finite-size correction to obtain $D(\\infty) = D(L) + \\frac{\\xi k_{\\mathrm{B}} T}{6 \\pi \\eta L}$.\n8. Store the pair $[D(L), D(\\infty)]$ for each test case.\n9. Print the list of pairs in the required single-line format.\n\nScientific realism checks:\n- The VACF is nonnegative at $t=0$ and decays exponentially, matching typical short-time VACF behavior in liquids.\n- All decay times are positive, and weights sum to unity.\n- The finite-size correction increases the diffusion coefficient (as $D(L)$ underestimates $D(\\infty)$ for cubic PBC), ensuring $D(\\infty) \\ge D(L)$.\n\nThe outputs for the three specified test cases will be floats in $\\mathrm{m^2/s}$, each pair representing the uncorrected finite-box diffusion coefficient and its hydrodynamically corrected infinite-system value.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_diffusion_from_vacf(T, M_molar, L, eta, weights, taus, dt, t_max):\n    \"\"\"\n    Compute finite-box diffusion coefficient D(L) from a synthetic VACF and apply\n    hydrodynamic finite-size correction to obtain D(infinity).\n\n    Parameters\n    ----------\n    T : float\n        Temperature in K.\n    M_molar : float\n        Molar mass in kg/mol.\n    L : float\n        Cubic box length in m.\n    eta : float\n        Dynamic viscosity in Pa*s.\n    weights : list of float\n        Weights for exponential components, must sum to 1.\n    taus : list of float\n        Decay times in s, same length as weights.\n    dt : float\n        Time step in s.\n    t_max : float\n        Maximum time in s for integration.\n\n    Returns\n    -------\n    DL : float\n        Finite-box diffusion coefficient in m^2/s.\n    Dinf : float\n        Hydrodynamically corrected infinite-system diffusion coefficient in m^2/s.\n    \"\"\"\n    # Physical constants\n    kB = 1.380649e-23        # J/K\n    NA = 6.02214076e23       # mol^-1\n    xi = 2.837297            # dimensionless lattice-sum constant for cubic PBC\n\n    # Mass of single ion\n    m = M_molar / NA  # kg\n\n    # Mean-square speed from equipartition: v^2 = 3 k_B T / m\n    v2 = 3.0 * kB * T / m  # m^2/s^2\n\n    # Time grid\n    # Ensure inclusion of t_max endpoint for accurate trapezoidal integration\n    N = int(np.floor(t_max / dt))\n    t = np.linspace(0.0, N * dt, N + 1)\n\n    # Construct VACF: C(t) = v^2 * sum_i w_i * exp(-t / tau_i)\n    weights = np.array(weights, dtype=float)\n    taus = np.array(taus, dtype=float)\n\n    # Safety checks to ensure physical plausibility\n    if np.any(taus = 0.0):\n        raise ValueError(\"All decay times must be positive.\")\n    if not np.isclose(np.sum(weights), 1.0, rtol=1e-12, atol=1e-12):\n        raise ValueError(\"Weights must sum to 1.\")\n\n    # Compute the weighted sum of exponentials\n    # Broadcast t over taus to build components efficiently\n    exp_components = np.exp(-t[:, None] / taus[None, :])  # shape (len(t), n_components)\n    C_t = v2 * np.dot(exp_components, weights)  # shape (len(t),)\n\n    # Numerical integration via trapezoidal rule: integral_0^{t_max} C(t) dt\n    integral_C = np.trapz(C_t, t)  # units: m^2/s^2 * s = m^2/s\n\n    # Finite-box diffusion coefficient D(L) = (1/3) * integral C(t) dt\n    DL = (1.0 / 3.0) * integral_C  # m^2/s\n\n    # Hydrodynamic finite-size correction for cubic PBC:\n    # D(infinity) = D(L) + xi * kB * T / (6 * pi * eta * L)\n    correction = xi * kB * T / (6.0 * np.pi * eta * L)\n    Dinf = DL + correction\n\n    return DL, Dinf\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Common integration parameters\n    dt = 5.0e-16      # s\n    t_max = 1.0e-11   # s\n\n    test_cases = [\n        # Case 1: T=298 K, single exponential tau=1.2e-14 s, L=3 nm, eta=0.00089 Pa*s\n        {\n            \"T\": 298.0,\n            \"M_molar\": 22.989769e-3,  # kg/mol\n            \"L\": 3.0e-9,              # m\n            \"eta\": 8.90e-4,           # Pa*s\n            \"weights\": [1.0],\n            \"taus\": [1.2e-14],\n        },\n        # Case 2: T=298 K, bi-exponential tau1=1.0e-14 s, tau2=6.0e-14 s, L=6 nm, eta=0.00089 Pa*s\n        {\n            \"T\": 298.0,\n            \"M_molar\": 22.989769e-3,\n            \"L\": 6.0e-9,\n            \"eta\": 8.90e-4,\n            \"weights\": [0.7, 0.3],\n            \"taus\": [1.0e-14, 6.0e-14],\n        },\n        # Case 3: T=350 K, single exponential tau=0.8e-14 s, L=4 nm, eta=0.00040 Pa*s\n        {\n            \"T\": 350.0,\n            \"M_molar\": 22.989769e-3,\n            \"L\": 4.0e-9,\n            \"eta\": 4.00e-4,\n            \"weights\": [1.0],\n            \"taus\": [0.8e-14],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        DL, Dinf = compute_diffusion_from_vacf(\n            T=case[\"T\"],\n            M_molar=case[\"M_molar\"],\n            L=case[\"L\"],\n            eta=case[\"eta\"],\n            weights=case[\"weights\"],\n            taus=case[\"taus\"],\n            dt=dt,\n            t_max=t_max\n        )\n        results.append([DL, Dinf])\n\n    # Final print statement in the exact required format.\n    # Print a single line containing the list of [D(L), D(infinity)] pairs.\n    print(f\"[{','.join('[' + ','.join(map(str, pair)) + ']' for pair in results)}]\")\n\nsolve()\n```"
        }
    ]
}