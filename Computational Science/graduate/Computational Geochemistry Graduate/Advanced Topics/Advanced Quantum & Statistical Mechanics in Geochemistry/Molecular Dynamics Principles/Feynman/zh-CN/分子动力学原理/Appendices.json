{
    "hands_on_practices": [
        {
            "introduction": "在分子动力学（MD）模拟中，为了计算效率，通常会对原子间的相互作用势进行截断。然而，这种截断会引入系统性误差。本练习将通过统计力学的基本原理，推导如何计算这些因截断而产生的长程校正项，特别是对能量和压力的校正，这对于从模拟中获得准确的热力学性质至关重要 。",
            "id": "4090598",
            "problem": "考虑一个均匀、各向同性的单原子矿物熔体的分子动力学 (MD) 模拟，其中原子间相互作用由 Lennard-Jones (LJ) 对势 $u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$ 建模。为降低计算成本，相互作用在球形截断半径 $r_{c}$ 处被截断，没有进行平移或锥化处理，因此分离距离 $r > r_{c}$ 的原子对被忽略。假设在截断半径之外，径向分布函数 $g(r)$ 近似为 1，并且该系统可以很好地用对加性相互作用来描述。数密度为 $\\rho$（单位体积内的粒子数）。\n\n从具有对相互作用的均匀流体的每个粒子势能和压力的统计力学定义出发，推导因截断而产生的缺失的长程（尾部）校正的闭合形式解析表达式：\n- 每个粒子势能的尾部校正，$\\frac{U_{\\mathrm{tail}}}{N}$，以及\n- 压力的尾部校正，$P_{\\mathrm{tail}}$。\n\n在 $r \\ge r_{c}$ 时 $g(r) = 1$ 的假设下，将这两个校正表示为 $\\rho$、$\\varepsilon$、$\\sigma$ 和 $r_{c}$ 的函数。以闭合形式的二元行向量 $\\left[ \\frac{U_{\\mathrm{tail}}}{N}, \\, P_{\\mathrm{tail}} \\right]$ 给出最终答案。无需进行数值计算。",
            "solution": "所述问题是有效的，其科学依据是统计力学和计算化学的原理，问题提出得很好，目标明确，数据充分，表述客观。因此，我们可以进行推导。\n\n目标是求出因忽略截断半径 $r_c$ 以外的相互作用而产生的每个粒子势能和压力的长程（尾部）校正。在径向分布函数 $g(r) = 1$ 这一简化假设下，这些校正对应于势能和维里在 $[r_c, \\infty)$ 范围内的贡献。\n\n首先，我们推导每个粒子势能的尾部校正 $\\frac{U_{\\mathrm{tail}}}{N}$。对于体积为 $V$、包含 $N$ 个粒子且具有对势 $u(r)$ 的系统，总势能 $U$ 由下式给出：\n$$ \\frac{U}{N} = \\frac{1}{2} \\rho \\int_0^\\infty u(r) g(r) 4 \\pi r^2 dr $$\n其中 $\\rho = N/V$ 是数密度。尾部校正是该能量积分中粒子分离距离 $r > r_c$ 的部分：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = \\frac{1}{2} \\rho \\int_{r_c}^\\infty u(r) g(r) 4 \\pi r^2 dr = 2 \\pi \\rho \\int_{r_c}^\\infty u(r) g(r) r^2 dr $$\n给定 Lennard-Jones (LJ) 势：\n$$ u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] $$\n并且我们假设对于 $r \\ge r_c$，$g(r) = 1$。将这些代入能量校正的积分中：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 2 \\pi \\rho \\int_{r_c}^\\infty \\left( 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] \\right) (1) r^2 dr $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^6}{r^6} \\right) r^2 dr $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) dr $$\n现在我们可以逐项进行积分：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left[ \\sigma^{12} \\left( \\frac{r^{-9}}{-9} \\right) - \\sigma^6 \\left( \\frac{r^{-3}}{-3} \\right) \\right]_{r_c}^\\infty $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left[ \\left( \\lim_{r \\to \\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) \\right] $$\n由于当 $r \\to \\infty$ 时各项趋于 $0$，第一部分消失：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left[ 0 - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) \\right] $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9 r_c^9} - \\frac{\\sigma^6}{3 r_c^3} \\right) $$\n这就是每个粒子势能尾部校正的闭合形式表达式。\n\n接下来，我们推导压力的尾部校正 $P_{\\mathrm{tail}}$。压力 $P$ 由维里状态方程给出：\n$$ P = \\rho k_B T - \\frac{2 \\pi \\rho^2}{3} \\int_0^\\infty r \\frac{du(r)}{dr} g(r) r^2 dr $$\n压力的尾部校正是压力中相互作用部分在 $r > r_c$ 时的贡献：\n$$ P_{\\mathrm{tail}} = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\frac{du(r)}{dr} g(r) dr $$\n首先，我们需要 LJ 势的导数：\n$$ \\frac{du(r)}{dr} = \\frac{d}{dr} \\left( 4 \\varepsilon \\left[ \\sigma^{12}r^{-12} - \\sigma^6 r^{-6} \\right] \\right) $$\n$$ \\frac{du(r)}{dr} = 4 \\varepsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^6(-6)r^{-7} \\right] = 4 \\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) $$\n将这个导数和 $g(r) = 1$ 代入压力校正的积分中：\n$$ P_{\\mathrm{tail}} = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\left( 4 \\varepsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right] \\right) dr $$\n$$ P_{\\mathrm{tail}} = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( -12 \\sigma^{12} r^{-10} + 6 \\sigma^6 r^{-4} \\right) dr $$\n我们对这个表达式进行积分：\n$$ P_{\\mathrm{tail}} = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left[ -12 \\sigma^{12} \\left( \\frac{r^{-9}}{-9} \\right) + 6 \\sigma^6 \\left( \\frac{r^{-3}}{-3} \\right) \\right]_{r_c}^\\infty $$\n$$ P_{\\mathrm{tail}} = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left[ \\frac{4\\sigma^{12}}{3r^9} - \\frac{2\\sigma^6}{r^3} \\right]_{r_c}^\\infty $$\n在积分上下限处求值：\n$$ P_{\\mathrm{tail}} = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left[ \\left( \\lim_{r \\to \\infty} \\left( \\frac{4\\sigma^{12}}{3r^9} - \\frac{2\\sigma^6}{r^3} \\right) \\right) - \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) \\right] $$\n同样，当 $r \\to \\infty$ 时的极限为 $0$：\n$$ P_{\\mathrm{tail}} = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left[ 0 - \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) \\right] $$\n$$ P_{\\mathrm{tail}} = \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) = \\frac{32 \\pi \\rho^2 \\varepsilon \\sigma^{12}}{9 r_c^9} - \\frac{16 \\pi \\rho^2 \\varepsilon \\sigma^6}{3 r_c^3} $$\n这是压力尾部校正的闭合形式表达式。\n\n最终答案是二元行向量 $\\left[ \\frac{U_{\\mathrm{tail}}}{N}, \\, P_{\\mathrm{tail}} \\right]$。\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9 r_c^9} - \\frac{\\sigma^6}{3 r_c^3} \\right) $$\n$$ P_{\\mathrm{tail}} = 16 \\pi \\rho^2 \\varepsilon \\left( \\frac{2\\sigma^{12}}{9 r_c^9} - \\frac{\\sigma^6}{3 r_c^3} \\right) $$",
            "answer": "$$\n\\boxed{\\left[ 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9 r_c^9} - \\frac{\\sigma^6}{3 r_c^3} \\right), \\, \\frac{32 \\pi \\rho^2 \\varepsilon \\sigma^{12}}{9 r_c^9} - \\frac{16 \\pi \\rho^2 \\varepsilon \\sigma^6}{3 r_c^3} \\right]}\n$$"
        },
        {
            "introduction": "许多地球化学体系，如矿物和晶体，具有非正交的晶胞结构。在对此类体系进行模拟时，正确处理周期性边界条件（PBC）下的原子间距离计算是一个核心挑战。本练习将介绍度量张量的概念，这是一种严谨处理非正交坐标系下矢量长度和距离的数学工具，是准确模拟晶体材料不可或缺的技能 。",
            "id": "4090584",
            "problem": "一个关于三斜晶系硅酸盐骨架中离子输运的分子动力学 (MD) 模拟使用了周期性边界条件 (PBC)。晶胞由笛卡尔坐标系下的晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$、$\\mathbf{c}$ 定义 (单位为 $\\mathrm{\\AA}$):\n$$\n\\mathbf{a} = (5.23,\\,0.00,\\,0.00),\\quad\n\\mathbf{b} = (0.77,\\,5.00,\\,0.00),\\quad\n\\mathbf{c} = (0.56,\\,0.91,\\,6.12).\n$$\n两个原子具有相对于 $\\mathbf{a},\\mathbf{b},\\mathbf{c}$ 的分数坐标：\n$$\n\\mathbf{s}_1 = (0.12,\\,0.85,\\,0.40),\\quad \\mathbf{s}_2 = (0.92,\\,0.10,\\,0.65).\n$$\n从欧几里得点积的定义以及周期性边界条件所蕴含的平移不变性出发，构建用于编码该三斜晶胞中分数坐标矢量长度的度规张量。使用该度规张量，构建在任意晶格平移 $\\mathbf{n}\\in\\mathbb{Z}^3$ 下两个原子间距离的平方表达式，并确定能得到最近邻镜像矢量的平移 $\\mathbf{n}$。计算此最近邻镜像矢量的模长，并以 $\\mathrm{\\AA}$ 为单位表示。将最终答案四舍五入至四位有效数字。",
            "solution": "用户提供的问题已经过分析，被认为是有效的。该问题具有科学依据、是良定的、客观的，并包含足够的信息以获得唯一解。\n\n笛卡尔坐标系中的位置矢量 $\\mathbf{r}$ 可以用分数坐标 $\\mathbf{s} = (s_a, s_b, s_c)^T$ 和晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$、$\\mathbf{c}$ 表示为：\n$$\n\\mathbf{r} = s_a \\mathbf{a} + s_b \\mathbf{b} + s_c \\mathbf{c}\n$$\n该线性变换可以写成矩阵形式 $\\mathbf{r} = H \\mathbf{s}$，其中 $H$ 是一个 $3 \\times 3$ 的矩阵，其列是晶格矢量：$H = [\\mathbf{a} \\, \\mathbf{b} \\, \\mathbf{c}]$。\n\n矢量 $\\mathbf{r}$ 的欧几里得长度的平方由点积 $\\mathbf{r} \\cdot \\mathbf{r} = \\mathbf{r}^T \\mathbf{r}$ 给出。代入用分数坐标表示的表达式：\n$$\n|\\mathbf{r}|^2 = (H\\mathbf{s})^T (H\\mathbf{s}) = \\mathbf{s}^T (H^T H) \\mathbf{s}\n$$\n问题要求构建度规张量，即矩阵 $G = H^T H$。该张量的元素 $G_{ij}$ 是基矢量的点积。对于基矢 $\\{\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3\\} = \\{\\mathbf{a}, \\mathbf{b}, \\mathbf{c}\\}$，度规张量为：\n$$\nG = \\begin{pmatrix} \\mathbf{a} \\cdot \\mathbf{a} & \\mathbf{a} \\cdot \\mathbf{b} & \\mathbf{a} \\cdot \\mathbf{c} \\\\ \\mathbf{b} \\cdot \\mathbf{a} & \\mathbf{b} \\cdot \\mathbf{b} & \\mathbf{b} \\cdot \\mathbf{c} \\\\ \\mathbf{c} \\cdot \\mathbf{a} & \\mathbf{c} \\cdot \\mathbf{b} & \\mathbf{c} \\cdot \\mathbf{c} \\end{pmatrix}\n$$\n使用给定的笛卡尔坐标系下的晶格矢量 (单位为 $\\mathrm{\\AA}$):\n$\\mathbf{a} = (5.23, 0.00, 0.00)$\n$\\mathbf{b} = (0.77, 5.00, 0.00)$\n$\\mathbf{c} = (0.56, 0.91, 6.12)$\n\n我们计算点积：\n$\\mathbf{a} \\cdot \\mathbf{a} = (5.23)^2 = 27.3529$\n$\\mathbf{b} \\cdot \\mathbf{b} = (0.77)^2 + (5.00)^2 = 0.5929 + 25.00 = 25.5929$\n$\\mathbf{c} \\cdot \\mathbf{c} = (0.56)^2 + (0.91)^2 + (6.12)^2 = 0.3136 + 0.8281 + 37.4544 = 38.5961$\n$\\mathbf{a} \\cdot \\mathbf{b} = (5.23)(0.77) = 4.0271$\n$\\mathbf{a} \\cdot \\mathbf{c} = (5.23)(0.56) = 2.9288$\n$\\mathbf{b} \\cdot \\mathbf{c} = (0.77)(0.56) + (5.00)(0.91) = 0.4312 + 4.55 = 4.9812$\n\n由于点积是对称的 ($\\mathbf{u} \\cdot \\mathbf{v} = \\mathbf{v} \\cdot \\mathbf{u}$)，我们得到度规张量 $G$ (单位为 $\\mathrm{\\AA}^2$):\n$$\nG = \\begin{pmatrix} 27.3529 & 4.0271 & 2.9288 \\\\ 4.0271 & 25.5929 & 4.9812 \\\\ 2.9288 & 4.9812 & 38.5961 \\end{pmatrix}\n$$\n接下来，我们考虑两个具有分数坐标 $\\mathbf{s}_1 = (0.12, 0.85, 0.40)^T$ 和 $\\mathbf{s}_2 = (0.92, 0.10, 0.65)^T$ 的原子。它们在分数坐标系下的分离矢量是：\n$$\n\\Delta\\mathbf{s} = \\mathbf{s}_2 - \\mathbf{s}_1 = (0.92-0.12, 0.10-0.85, 0.65-0.40)^T = (0.80, -0.75, 0.25)^T\n$$\n在周期性边界条件 (PBC) 下，必须考虑一个原子与另一个原子的周期性镜像之间的距离。从原子1到由整数晶格矢量 $\\mathbf{n} = (n_a, n_b, n_c)^T \\in \\mathbb{Z}^3$ 平移的原子2的镜像的矢量，在分数坐标中表示为 $\\Delta\\mathbf{s} - \\mathbf{n}$。题目对 $\\mathbf{n}$ 使用此符号约定。距离的平方 $d^2$ 是这个整数矢量 $\\mathbf{n}$ 的函数：\n$$\nd^2(\\mathbf{n}) = (\\Delta\\mathbf{s} - \\mathbf{n})^T G (\\Delta\\mathbf{s} - \\mathbf{n})\n$$\n最近邻镜像矢量是使该距离平方最小化的矢量。对于非病态倾斜的晶胞，一种标准且计算高效的方法（最小镜像约定）是选择整数矢量 $\\mathbf{n}$，使得所得矢量 $\\Delta\\mathbf{s}_{\\text{near}} = \\Delta\\mathbf{s} - \\mathbf{n}$ 的所有分量都在区间 $[-0.5, 0.5)$ 内。这可以通过将 $\\Delta\\mathbf{s}$ 的每个分量四舍五入到最近的整数来实现。\n$$\nn_i = \\text{round}((\\Delta\\mathbf{s})_i)\n$$\n将此方法应用于我们的 $\\Delta\\mathbf{s}$：\n$n_a = \\text{round}(0.80) = 1$\n$n_b = \\text{round}(-0.75) = -1$\n$n_c = \\text{round}(0.25) = 0$\n所以，平移矢量为 $\\mathbf{n} = (1, -1, 0)^T$。\n\n由此得到的以分数坐标表示的最近邻镜像矢量是：\n$$\n\\Delta\\mathbf{s}_{\\text{near}} = \\Delta\\mathbf{s} - \\mathbf{n} = (0.80-1, -0.75-(-1), 0.25-0)^T = (-0.20, 0.25, 0.25)^T\n$$\n令 $\\mathbf{s}' = \\Delta\\mathbf{s}_{\\text{near}}$。该矢量的模长平方为 $d^2 = \\mathbf{s}'^T G \\mathbf{s}'$。\n$$\nd^2 = \\sum_{i,j=1}^{3} G_{ij} s'_i s'_j = G_{11}(s'_a)^2 + G_{22}(s'_b)^2 + G_{33}(s'_c)^2 + 2G_{12}s'_a s'_b + 2G_{13}s'_a s'_c + 2G_{23}s'_b s'_c\n$$\n代入 $G$ 和 $\\mathbf{s}' = (-0.20, 0.25, 0.25)^T$ 的值：\n$d^2 = 27.3529(-0.20)^2 + 25.5929(0.25)^2 + 38.5961(0.25)^2 + 2(4.0271)(-0.20)(0.25) + 2(2.9288)(-0.20)(0.25) + 2(4.9812)(0.25)(0.25)$\n$d^2 = 27.3529(0.04) + 25.5929(0.0625) + 38.5961(0.0625) + 2(4.0271)(-0.05) + 2(2.9288)(-0.05) + 2(4.9812)(0.0625)$\n$d^2 = 1.094116 + 1.59955625 + 2.41225625 - 0.40271 - 0.29288 + 0.62265$\n$d^2 = 5.0329885 \\text{ }\\mathrm{\\AA}^2$\n\n最近邻镜像矢量的模长是该值的平方根：\n$$\nd = \\sqrt{5.0329885} \\approx 2.24343229 \\text{ }\\mathrm{\\AA}\n$$\n将最终结果四舍五入到四位有效数字，得到 $2.243$。",
            "answer": "$$\n\\boxed{2.243}\n$$"
        },
        {
            "introduction": "在微正则系综（NVE）模拟中，理论上总能量应该守恒，但实践中我们常会观察到能量的微小波动。本练习旨在揭示这一现象背后的深刻原因，即“影子哈密顿量”的概念。通过推导，你将理解辛积分算法（如速度Verlet算法）实际上精确地守恒一个与原始哈密顿量略有不同的修改后哈密顿量，从而解释了能量波动的来源及其与时间步长的关系 。",
            "id": "4090567",
            "problem": "在计算地球化学中，数量-体积-能量（NVE）系综中的微正则动力学通常使用辛的可时间反演积分器进行演化，以确保守恒量的长期稳定性。考虑一个一维简约坐标 $q$，它描述了含水硅酸盐环境中氧氢键的伸缩运动，该运动由莫尔斯势 $V(q) = D_{e}\\left(1 - \\exp\\left(- a \\left(q - q_{0}\\right)\\right)\\right)^{2}$ 建模，其参数为 $D_{e} > 0$、$a > 0$ 以及平衡位置 $q_{0}$。其共轭动量为 $p$，简约质量为 $m$。哈密顿量是可分离的，形式为 $H(q,p) = T(p) + V(q)$，其中 $T(p) = \\frac{p^{2}}{2 m}$。\n\n一条 NVE 分子动力学轨迹使用速度 Verlet 算法进行演化，该算法是一种对称的 Strang 分裂，将精确的哈密顿流分解为动能和势能子步骤。对于足够小的时间步长 $\\Delta t$，存在一个修正（影子）哈密顿量 $\\tilde{H}(q,p)$，它被该辛积分器精确守恒，并且在取决于 $\\Delta t$ 的截断误差范围内近似于 $H(q,p)$。\n\n仅从哈密顿力学、刘维尔算符和泊松括号的基本定义出发，不使用任何预先给出的简化公式，完成以下任务：\n\n1. 推导与速度 Verlet 使用的对称动能-势能-动能分裂相关的哈密顿量的领头非零修正项，从而得到影子哈密顿量 $\\tilde{H}(q,p)$，保留到 $\\Delta t^{2}$ 阶项。\n\n2. 将您的通用结果应用于莫尔斯势 $V(q) = D_{e}\\left(1 - \\exp\\left(- a \\left(q - q_{0}\\right)\\right)\\right)^{2}$，并以闭合形式表示 $\\tilde{H}(q,p)$，明确地收集包含 $q$、$p$、$m$、$D_{e}$、$a$、$q_{0}$ 和 $\\Delta t$ 的项。\n\n3. 使用您得到的 $\\tilde{H}(q,p)$ 表达式来解释在 NVE 模拟中观测到的裸哈密顿量 $H(q,p)$ 的涨落是如何产生的，以及其幅度如何随 $\\Delta t$ 和势的局域曲率而变化。提供一个简洁的物理解释；不需要进行数值计算。\n\n您的最终答案必须是 $\\tilde{H}(q,p)$ 的一个精确到 $\\Delta t^{2}$ 阶的单个闭合形式解析表达式。不要代入数值，也不要在最终答案框中包含单位。",
            "solution": "该问题具有科学依据，提法适定、客观，并包含了进行严格解析推导所需的所有信息。它涉及高等计算统计力学中的一个标准课题，特别是几何积分器理论。因此，该问题是有效的。\n\n按照题目要求，解答分为三个部分。\n\n### 1. K-P-K 分裂的影子哈密顿量的推导\n\n在哈密顿量 $H(q,p)$ 的作用下，任何相空间函数 $f(q,p)$ 的时间演化都遵循哈密顿方程。这种演化可以用泊松括号 $\\{A, B\\} = \\frac{\\partial A}{\\partial q}\\frac{\\partial B}{\\partial p} - \\frac{\\partial A}{\\partial p}\\frac{\\partial B}{\\partial q}$ 简洁地表示。$f$ 的运动方程为 $\\frac{df}{dt} = \\{f, H\\}$。这可以写成算符方程 $\\frac{df}{dt} = L_{H} f$，其中 $L_{H} = \\{\\cdot, H\\}$ 是与 $H$ 相关的刘维尔算符。系统在经过时间 $\\Delta t$ 后的状态的形式解由传播子的作用给出，即 $\\mathbf{z}(\\Delta t) = \\exp(\\Delta t L_{H}) \\mathbf{z}(0)$，其中 $\\mathbf{z}=(q,p)$。\n\n哈密顿量是可分离的，$H(q,p) = T(p) + V(q)$。相应地，刘维尔算符也分裂为两部分，$L_{H} = L_{T} + L_{V}$，其中 $L_{T} = \\{\\cdot, T(p)\\}$ 且 $L_{V} = \\{\\cdot, V(q)\\}$。由于 $T$ 和 $V$ 依赖于不同的正则变量，所以 $L_T$ 和 $L_V$ 不对易，即 $[L_T, L_V] \\neq 0$。因此，精确传播子 $\\exp(\\Delta t (L_T + L_V))$ 不等于 $\\exp(\\Delta t L_T)\\exp(\\Delta t L_V)$。\n\n像速度 Verlet 算法这样的辛积分器通过一系列可解析求解的子步骤来近似精确传播子。问题指定了一种对称的动能-势能-动能 (K-P-K) 分裂，其对应的近似传播子为：\n$$\n\\mathcal{U}_{\\text{split}}(\\Delta t) = \\exp\\left(\\frac{\\Delta t}{2} L_T\\right) \\exp\\left(\\Delta t L_V\\right) \\exp\\left(\\frac{\\Delta t}{2} L_T\\right)\n$$\n根据几何积分器理论的一个已知结果，这种对称组合本身就是一个修正哈密顿量 $\\tilde{H}$ 的精确传播子，该哈密顿量与原始的 $H$ 相近。我们可以写出 $\\mathcal{U}_{\\text{split}}(\\Delta t) = \\exp(\\Delta t L_{\\tilde{H}})$。为了找到 $\\tilde{H}$，我们使用对称的 Baker-Campbell-Hausdorff (BCH) 公式。对于算符 $A$ 和 $B$，对称分裂的公式为：\n$$\n\\exp\\left(\\frac{t}{2}A\\right) \\exp(tB) \\exp\\left(\\frac{t}{2}A\\right) = \\exp\\left(t(A+B) + \\frac{t^3}{12}[B,[B,A]] - \\frac{t^3}{24}[A,[B,A]] + O(t^5)\\right)\n$$\n我们令 $A = L_T$，$B = L_V$，$t = \\Delta t$。积分器指数中的算符是 $\\Delta t L_{\\tilde{H}}$。比较各项，我们得到：\n$$\nL_{\\tilde{H}} = L_T + L_V + \\frac{\\Delta t^2}{12}[L_V,[L_V,L_T]] - \\frac{\\Delta t^2}{24}[L_T,[L_V,L_T]] + O(\\Delta t^4)\n$$\n算符 $L_H = L_T+L_V$，所以修正的刘维尔算符是 $L_{\\tilde{H}} = L_H + \\delta L$，其中的修正项为 $\\delta L = \\frac{\\Delta t^2}{12}[L_V,[L_V,L_T]] - \\frac{\\Delta t^2}{24}[L_T,[L_V,L_T]]$。\n\n为了找到哈密顿量对应的修正项 $\\delta H$，我们使用一个恒等式：对于刘维尔算符 $L_A = \\{\\cdot, A\\}$ 和 $L_B = \\{\\cdot, B\\}$，它们的对易子由 $[L_A, L_B] = L_{\\{A,B\\}} = \\{\\cdot, \\{A,B\\}\\}$ 给出。应用这个恒等式，我们可以写出 $\\delta L = L_{\\delta H}$，其中：\n$$\n\\delta H = \\frac{\\Delta t^2}{12}\\{V, \\{V,T\\}\\} - \\frac{\\Delta t^2}{24}\\{T, \\{V,T\\}\\}\n$$\n现在，我们计算嵌套的泊松括号。首先，计算内层括号：\n$$\n\\{V,T\\} = \\frac{\\partial V}{\\partial q}\\frac{\\partial T}{\\partial p} - \\frac{\\partial V}{\\partial p}\\frac{\\partial T}{\\partial q} = V'(q) \\cdot \\frac{p}{m} - 0 \\cdot 0 = \\frac{p V'(q)}{m}\n$$\n接着，计算第一个外层括号：\n$$\n\\{V, \\{V,T\\}\\} = \\left\\{V, \\frac{p V'(q)}{m}\\right\\} = \\frac{\\partial V}{\\partial q}\\frac{\\partial}{\\partial p}\\left(\\frac{p V'(q)}{m}\\right) - \\frac{\\partial V}{\\partial p}\\frac{\\partial}{\\partial q}\\left(\\frac{p V'(q)}{m}\\right) = V'(q) \\cdot \\frac{V'(q)}{m} - 0 = \\frac{(V'(q))^2}{m}\n$$\n最后，计算第二个外层括号：\n$$\n\\{T, \\{V,T\\}\\} = \\left\\{T, \\frac{p V'(q)}{m}\\right\\} = \\frac{\\partial T}{\\partial q}\\frac{\\partial}{\\partial p}\\left(\\frac{p V'(q)}{m}\\right) - \\frac{\\partial T}{\\partial p}\\frac{\\partial}{\\partial q}\\left(\\frac{p V'(q)}{m}\\right) = 0 - \\frac{p}{m} \\cdot \\frac{p V''(q)}{m} = -\\frac{p^2 V''(q)}{m^2}\n$$\n将这些表达式代回 $\\delta H$：\n$$\n\\delta H = \\frac{\\Delta t^2}{12} \\left(\\frac{(V'(q))^2}{m}\\right) - \\frac{\\Delta t^2}{24} \\left(-\\frac{p^2 V''(q)}{m^2}\\right) = \\frac{\\Delta t^2 (V'(q))^2}{12m} + \\frac{\\Delta t^2 p^2 V''(q)}{24m^2}\n$$\n精确到 $\\Delta t^2$ 阶的影子哈密顿量为 $\\tilde{H}(q,p) = H(q,p) + \\delta H(q,p)$。\n\n### 2. 应用于莫尔斯势\n\n给定莫尔斯势 $V(q) = D_{e}\\left(1 - \\exp\\left(- a \\left(q - q_{0}\\right)\\right)\\right)^{2}$。我们需要计算它的一阶和二阶导数。令 $u(q) = \\exp\\left(- a \\left(q - q_{0}\\right)\\right)$。则 $V(q) = D_e(1-u)^2$。\n\n一阶导数为：\n$$\nV'(q) = \\frac{dV}{dq} = D_e \\cdot 2(1-u) \\cdot (-u) \\cdot (-a) = 2 a D_e (u - u^2)\n$$\n将 $u(q)$ 代回：\n$$\nV'(q) = 2 a D_e \\left(\\exp\\left(-a(q-q_0)\\right) - \\exp\\left(-2a(q-q_0)\\right)\\right)\n$$\n二阶导数为：\n$$\nV''(q) = \\frac{dV'}{dq} = 2 a D_e \\frac{d}{dq}(u - u^2) = 2 a D_e (u' - 2uu') = 2 a D_e u'(1-2u)\n$$\n由于 $u' = -a u$，我们有：\n$$\nV''(q) = 2 a D_e (-a u)(1-2u) = 2 a^2 D_e (2u^2 - u)\n$$\n将 $u(q)$ 代回：\n$$\nV''(q) = 2 a^2 D_e \\left(2\\exp\\left(-2a(q-q_0)\\right) - \\exp\\left(-a(q-q_0)\\right)\\right)\n$$\n现在我们将 $V'(q)$ 和 $V''(q)$ 代入 $\\delta H$ 的表达式中。\n\n第一个修正项是：\n$$\n\\frac{\\Delta t^2 (V'(q))^2}{12m} = \\frac{\\Delta t^2}{12m} \\left(2 a D_e (u - u^2)\\right)^2 = \\frac{4 a^2 D_e^2 \\Delta t^2}{12m} (u-u^2)^2 = \\frac{a^2 D_e^2 \\Delta t^2}{3m} (u^2 - 2u^3 + u^4)\n$$\n第二个修正项是：\n$$\n\\frac{\\Delta t^2 p^2 V''(q)}{24m^2} = \\frac{\\Delta t^2 p^2}{24m^2} \\left(2 a^2 D_e (2u^2 - u)\\right) = \\frac{2 a^2 D_e \\Delta t^2 p^2}{24m^2} (2u^2 - u) = \\frac{a^2 D_e \\Delta t^2 p^2}{12m^2} (2u^2 - u)\n$$\n完整的影子哈密顿量 $\\tilde{H}(q,p) = T(p) + V(q) + \\delta H(q,p)$ 是：\n$$\n\\tilde{H}(q,p) = \\frac{p^2}{2m} + D_e(1-u)^2 + \\frac{a^2 D_e^2 \\Delta t^2}{3m} (u^2 - 2u^3 + u^4) + \\frac{a^2 D_e \\Delta t^2 p^2}{12m^2} (2u^2 - u)\n$$\n代入 $u(q) = \\exp\\left(- a \\left(q - q_{0}\\right)\\right)$ 即可得到 $\\tilde{H}(q,p)$ 的最终表达式。\n\n### 3. 物理解释\n\n该数值积分方案精确守恒的是影子哈密顿量 $\\tilde{H}(q,p)$，而不是原始（或“裸”）哈密顿量 $H(q,p)$。因此，沿着由积分器生成的轨迹 $(q(t), p(t))$，$\\tilde{H}(q(t),p(t))$ 是一个运动常数。\n我们可以将裸哈密顿量表示为 $H = \\tilde{H} - \\delta H$。由于 $\\tilde{H}$ 是常数，因此在模拟过程中观测到的 $H$ 的任何涨落都完全是由修正项 $\\delta H(q,p)$ 的相空间依赖性引起的：\n$$\nH(t) = \\text{constant} - \\delta H(q(t), p(t))\n$$\n因此，$H$ 的涨落等于相对于某个常数偏移的 $-\\delta H$。这些能量涨落的幅度由 $\\delta H$ 的幅度决定。\n\n从 $\\delta H$ 的通用表达式：\n$$\n\\delta H = \\frac{\\Delta t^2}{12m} (V'(q))^2 + \\frac{\\Delta t^2 p^2 V''(q)}{24m^2}\n$$\n我们可以得出以下几个结论：\n\n1.  **随时间步长的标度关系**：能量涨落的幅度随 $\\Delta t^2$ 变化。这是二阶对称积分器的特征。将时间步长减小 10 倍，能量涨落的幅度将减小 100 倍，从而使裸哈密顿量的守恒性更好（但非完美）。\n\n2.  **对力的依赖性**：第一项与 $(V'(q))^2 = F(q)^2$ 成正比，其中 $F(q)$ 是力。这意味着在势能面上力最强（即势最陡峭）的区域，能量涨落最大。\n\n3.  **对曲率和动能的依赖性**：第二项与 $p^2 V''(q)$ 成正比。$V''(q)$ 是势的局域曲率。该项表明，当具有高动能（与 $p^2$ 成正比）的粒子穿过高势能曲率区域时，涨落也很大。高曲率意味着力 $F(q) = -V'(q)$ 随位置变化迅速。积分器在子步骤内将力近似为常数，对于在势的高度弯曲区域中快速运动的粒子，这种近似不太准确，从而导致更大的误差，表现为 $H$ 的涨落。\n\n在 O-H 键伸缩的背景下，这意味着当键被高度压缩（排斥墙非常陡峭，导致大的 $V'$ 和 $V''$）或高度拉伸时，能量涨落将最为显著，特别是对于具有大动能的振动。",
            "answer": "$$\n\\boxed{\\tilde{H}(q,p) = \\frac{p^{2}}{2 m} + D_{e}\\left(1 - \\exp\\left(- a \\left(q - q_{0}\\right)\\right)\\right)^{2} + \\frac{a^{2} D_{e}^{2} \\Delta t^{2}}{3 m}\\left(\\exp\\left(-2 a \\left(q - q_{0}\\right)\\right) - 2\\exp\\left(-3 a \\left(q - q_{0}\\right)\\right) + \\exp\\left(-4 a \\left(q - q_{0}\\right)\\right)\\right) + \\frac{a^{2} D_{e} \\Delta t^{2} p^{2}}{12 m^{2}}\\left(2\\exp\\left(-2 a \\left(q - q_{0}\\right)\\right) - \\exp\\left(-a \\left(q - q_{0}\\right)\\right)\\right)}\n$$"
        }
    ]
}