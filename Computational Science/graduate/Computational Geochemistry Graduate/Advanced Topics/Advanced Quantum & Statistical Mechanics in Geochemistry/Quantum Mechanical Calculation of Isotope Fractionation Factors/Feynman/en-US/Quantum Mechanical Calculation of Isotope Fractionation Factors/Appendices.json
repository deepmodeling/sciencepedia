{
    "hands_on_practices": [
        {
            "introduction": "This exercise will ground your understanding of isotope fractionation in fundamental quantum statistical mechanics. You will derive the direct relationship between the reduced partition function ratio, $\\beta$, and the zero-point energy (ZPE) difference between isotopologues, which dominates at low temperatures. By applying this principle to hypothetical spectroscopic data from a Density Functional Theory (DFT) calculation, you will solidify the connection between first-principles theory and a quantitative prediction of isotopic partitioning.",
            "id": "4097200",
            "problem": "In computational geochemistry, isotope fractionation factors are computed from quantum mechanical vibrational partition functions within the harmonic approximation. Consider a local magnesium–oxygen coordination environment in a hydrated carbonate surface cluster, for which a Density Functional Theory (DFT) calculation provides the following harmonic vibrational wavenumbers (in $\\text{cm}^{-1}$) for the isotopologues with magnesium mass $m(\\mathrm{^{24}Mg})$ and $m(\\mathrm{^{26}Mg})$:\n- Light isotopologue ($\\mathrm{^{24}Mg}$): $\\tilde{\\nu}_{1} = 1005$, $\\tilde{\\nu}_{2} = 695$, $\\tilde{\\nu}_{3} = 405$.\n- Heavy isotopologue ($\\mathrm{^{26}Mg}$): $\\tilde{\\nu}_{1}' = 990$, $\\tilde{\\nu}_{2}' = 685$, $\\tilde{\\nu}_{3}' = 400$.\n\nAssume the vibrational degrees of freedom are separable and each mode is an independent quantum harmonic oscillator. Start from the fundamental expression for the vibrational partition function of a single harmonic oscillator and the definition of the reduced partition function ratio (RPFR) for vibrations, and derive the low-temperature relation between the zero-point energy difference and the logarithm of the vibrational RPFR.\n\nThen, using that relation, compute the zero-point energy difference\n$$\n\\Delta \\mathrm{ZPE} = \\frac{1}{2}\\sum_{j=1}^{3} h\\left(\\nu_{j} - \\nu_{j}'\\right),\n$$\nwhere $\\nu_{j} = c\\,\\tilde{\\nu}_{j}$ and $\\nu_{j}' = c\\,\\tilde{\\nu}_{j}'$, and evaluate the low-temperature limit of $\\ln \\beta_{\\mathrm{vib}}$ at temperature $T = 50\\,\\mathrm{K}$.\n\nTake the speed of light $c = 2.99792458\\times 10^{10}\\,\\text{cm s}^{-1}$, Planck’s constant $h = 6.62607015\\times 10^{-34}\\,\\text{J s}$, and the Boltzmann constant $k_{B} = 1.380649\\times 10^{-23}\\,\\text{J K}^{-1}$.\n\nRound your final numerical result for $\\ln \\beta_{\\mathrm{vib}}$ to four significant figures. Express the final answer as a pure number (dimensionless). Do not report $\\Delta \\mathrm{ZPE}$; only report the numerical value of $\\ln \\beta_{\\mathrm{vib}}$.",
            "solution": "The problem requires the derivation of the low-temperature relationship between the zero-point energy difference ($\\Delta \\mathrm{ZPE}$) and the logarithm of the vibrational reduced partition function ratio ($\\ln \\beta_{\\mathrm{vib}}$), followed by a numerical calculation of $\\ln \\beta_{\\mathrm{vib}}$ at a specified temperature using provided spectroscopic data.\n\nThe derivation begins with the fundamental principles of statistical mechanics for a quantum harmonic oscillator (QHO), which is the model for each vibrational mode. The energy levels of a QHO with vibrational frequency $\\nu$ are given by\n$$\nE_n = \\left(n + \\frac{1}{2}\\right)h\\nu, \\quad n = 0, 1, 2, \\dots\n$$\nwhere $h$ is Planck's constant and $n$ is the vibrational quantum number.\n\nThe canonical partition function for a single vibrational mode, $q_{\\mathrm{vib}}$, is the sum over all states:\n$$\nq_{\\mathrm{vib}} = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{E_n}{k_B T}\\right) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{(n + 1/2)h\\nu}{k_B T}\\right)\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. This expression can be factored:\n$$\nq_{\\mathrm{vib}} = \\exp\\left(-\\frac{h\\nu}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right]^n\n$$\nThe summation is a geometric series $\\sum_{n=0}^{\\infty} x^n = \\frac{1}{1-x}$ with $x = \\exp(-h\\nu/k_B T)$. Since $h\\nu > 0$ and $T>0$, we have $0 < x < 1$. The sum converges, yielding:\n$$\nq_{\\mathrm{vib}} = \\frac{\\exp\\left(-\\frac{h\\nu}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)}\n$$\nThis expression is the partition function for one vibrational degree of freedom, measured with respect to the dissociated atoms. Note that the term $\\exp(-h\\nu/2k_B T)$ accounts for the zero-point energy (ZPE) of the oscillator, $E_0 = \\frac{1}{2}h\\nu$.\n\nThe problem states that the vibrational degrees of freedom are separable. Therefore, the total vibrational partition function for a molecule with $N$ vibrational modes is the product of the individual mode partition functions:\n$$\nQ_{\\mathrm{vib}} = \\prod_{j=1}^{N} q_{\\mathrm{vib},j}\n$$\nIn this problem, we have $N=3$ modes for both the light ($\\mathrm{^{24}Mg}$) and heavy ($\\mathrm{^{26}Mg}$) isotopologues. Let the frequencies of the light isotopologue be $\\nu_j$ and those of the heavy isotopologue be $\\nu_j'$. The corresponding total vibrational partition functions are $Q_{\\mathrm{vib}}$ and $Q'_{\\mathrm{vib}}$, respectively.\n\nThe vibrational reduced partition function ratio, $\\beta_{\\mathrm{vib}}$, is defined as the ratio of the total vibrational partition functions of the heavy and light species:\n$$\n\\beta_{\\mathrm{vib}} = \\frac{Q'_{\\mathrm{vib}}}{Q_{\\mathrm{vib}}} = \\frac{\\prod_{j=1}^{3} q'_{\\mathrm{vib},j}}{\\prod_{j=1}^{3} q_{\\mathrm{vib},j}}\n$$\nWe are interested in the natural logarithm of this quantity:\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\ln\\left(\\frac{\\prod_{j=1}^{3} q'_{\\mathrm{vib},j}}{\\prod_{j=1}^{3} q_{\\mathrm{vib},j}}\\right) = \\sum_{j=1}^{3} \\ln\\left(\\frac{q'_{\\mathrm{vib},j}}{q_{\\mathrm{vib},j}}\\right)\n$$\nSubstituting the expression for $q_{\\mathrm{vib}}$:\n$$\n\\ln\\left(\\frac{q'_j}{q_j}\\right) = \\ln\\left( \\frac{\\exp(-h\\nu_j' / 2k_B T) / (1 - \\exp(-h\\nu_j' / k_B T))}{\\exp(-h\\nu_j / 2k_B T) / (1 - \\exp(-h\\nu_j / k_B T))} \\right)\n$$\nUsing the properties of logarithms, this separates into:\n$$\n\\ln\\left(\\frac{q'_j}{q_j}\\right) = \\left(-\\frac{h\\nu_j'}{2k_B T}\\right) - \\ln(1 - \\exp(-h\\nu_j' / k_B T)) - \\left[\\left(-\\frac{h\\nu_j}{2k_B T}\\right) - \\ln(1 - \\exp(-h\\nu_j / k_B T))\\right]\n$$\n$$\n\\ln\\left(\\frac{q'_j}{q_j}\\right) = \\frac{h(\\nu_j - \\nu_j')}{2k_B T} + \\ln\\left(\\frac{1 - \\exp(-h\\nu_j / k_B T)}{1 - \\exp(-h\\nu_j' / k_B T)}\\right)\n$$\nSumming over all modes $j=1, 2, 3$:\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\sum_{j=1}^{3} \\left[ \\frac{h(\\nu_j - \\nu_j')}{2k_B T} + \\ln\\left(\\frac{1 - \\exp(-h\\nu_j / k_B T)}{1 - \\exp(-h\\nu_j' / k_B T)}\\right) \\right]\n$$\nNow, we derive the low-temperature relation. In the limit $T \\to 0$, the arguments of the exponential functions $h\\nu/k_B T$ tend to infinity. Consequently, $\\exp(-h\\nu/k_B T) \\to 0$ for any non-zero frequency $\\nu$. This applies to both $\\nu_j$ and $\\nu_j'$. The logarithmic term therefore approaches:\n$$\n\\lim_{T\\to 0} \\ln\\left(\\frac{1 - \\exp(-h\\nu_j / k_B T)}{1 - \\exp(-h\\nu_j' / k_B T)}\\right) = \\ln\\left(\\frac{1 - 0}{1 - 0}\\right) = \\ln(1) = 0\n$$\nThus, in the low-temperature limit, the expression for $\\ln \\beta_{\\mathrm{vib}}$ simplifies to:\n$$\n\\ln \\beta_{\\mathrm{vib}} \\approx \\sum_{j=1}^{3} \\frac{h(\\nu_j - \\nu_j')}{2k_B T} = \\frac{1}{k_B T} \\sum_{j=1}^{3} \\frac{1}{2}h(\\nu_j - \\nu_j')\n$$\nThe term in the summation is the difference in zero-point energies between the light and heavy isotopologues, $\\Delta \\mathrm{ZPE} = \\mathrm{ZPE}_{\\mathrm{light}} - \\mathrm{ZPE}_{\\mathrm{heavy}}$:\n$$\n\\Delta \\mathrm{ZPE} = \\sum_{j=1}^{3} \\frac{1}{2}h\\nu_j - \\sum_{j=1}^{3} \\frac{1}{2}h\\nu_j' = \\frac{1}{2}\\sum_{j=1}^{3} h(\\nu_j - \\nu_j')\n$$\nThis gives the desired low-temperature relation:\n$$\n\\ln \\beta_{\\mathrm{vib}} \\approx \\frac{\\Delta \\mathrm{ZPE}}{k_B T}\n$$\nThis completes the derivation part of the problem.\n\nNext, we proceed with the numerical calculation at $T=50\\,\\mathrm{K}$. First, we must ascertain if $T=50\\,\\mathrm{K}$ constitutes a low temperature for the given system. We check the magnitude of $u = hc\\tilde{\\nu}/k_B T$. The lowest wavenumber provided is $\\tilde{\\nu} = 400\\,\\text{cm}^{-1}$.\nThe constant factor is $\\frac{hc}{k_B} = \\frac{(6.62607015\\times 10^{-34}\\,\\text{J s})(2.99792458\\times 10^{10}\\,\\text{cm s}^{-1})}{1.380649\\times 10^{-23}\\,\\text{J K}^{-1}} \\approx 1.43877688\\,\\text{K cm}$.\nFor the lowest wavenumber at $T=50\\,\\mathrm{K}$:\n$$\nu_{\\mathrm{min}} = \\frac{hc\\tilde{\\nu}_{\\mathrm{min}}}{k_B T} \\approx \\frac{(1.4388\\,\\text{K cm})(400\\,\\text{cm}^{-1})}{50\\,\\mathrm{K}} \\approx 11.5\n$$\nSince $u \\gg 1$ for all modes, the term $\\exp(-u)$ is very small (e.g., $\\exp(-11.5) \\approx 10^{-5}$), and the low-temperature approximation is highly accurate.\n\nWe are asked to compute $\\ln \\beta_{\\mathrm{vib}}$ using the derived low-temperature formula.\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\frac{1}{ k_B T} \\left( \\frac{1}{2}\\sum_{j=1}^{3} h(\\nu_{j} - \\nu_{j}') \\right) = \\frac{hc}{2k_B T} \\sum_{j=1}^{3} (\\tilde{\\nu}_{j} - \\tilde{\\nu}_{j}')\n$$\nThe sum of the wavenumber differences is:\n$$\n\\sum_{j=1}^{3} (\\tilde{\\nu}_{j} - \\tilde{\\nu}_{j}') = (\\tilde{\\nu}_{1} - \\tilde{\\nu}_{1}') + (\\tilde{\\nu}_{2} - \\tilde{\\nu}_{2}') + (\\tilde{\\nu}_{3} - \\tilde{\\nu}_{3}')\n$$\n$$\n\\sum_{j=1}^{3} (\\tilde{\\nu}_{j} - \\tilde{\\nu}_{j}') = (1005 - 990)\\,\\text{cm}^{-1} + (695 - 685)\\,\\text{cm}^{-1} + (405 - 400)\\,\\text{cm}^{-1}\n$$\n$$\n\\sum_{j=1}^{3} (\\tilde{\\nu}_{j} - \\tilde{\\nu}_{j}') = 15\\,\\text{cm}^{-1} + 10\\,\\text{cm}^{-1} + 5\\,\\text{cm}^{-1} = 30\\,\\text{cm}^{-1}\n$$\nNow, substitute this value into the expression for $\\ln \\beta_{\\mathrm{vib}}$:\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\frac{hc}{2k_B T} \\times (30\\,\\text{cm}^{-1}) = \\frac{hc}{k_B T} \\times (15\\,\\text{cm}^{-1})\n$$\nUsing the provided constants:\n$h = 6.62607015\\times 10^{-34}\\,\\text{J s}$\n$c = 2.99792458\\times 10^{10}\\,\\text{cm s}^{-1}$\n$k_{B} = 1.380649\\times 10^{-23}\\,\\text{J K}^{-1}$\n$T = 50\\,\\mathrm{K}$\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\frac{(6.62607015\\times 10^{-34}\\,\\text{J s})(2.99792458\\times 10^{10}\\,\\text{cm s}^{-1})}{(1.380649\\times 10^{-23}\\,\\text{J K}^{-1})(50\\,\\mathrm{K})} \\times 15\n$$\n$$\n\\ln \\beta_{\\mathrm{vib}} = \\frac{1.98644586 \\times 10^{-23}\\,\\text{J cm}}{6.903245 \\times 10^{-22}\\,\\mathrm{J}} \\times 15\n$$\n$$\n\\ln \\beta_{\\mathrm{vib}} = (0.0287755375...) \\times 15\n$$\n$$\n\\ln \\beta_{\\mathrm{vib}} = 0.431633063...\n$$\nRounding the final result to four significant figures, we get $0.4316$.",
            "answer": "$$\\boxed{0.4316}$$"
        },
        {
            "introduction": "Real-world computational models for isotope fractionation are complex, often involving several independent approximations. This practice shifts the focus from simple calculation to critical evaluation, a key skill for any computational scientist. Using a hypothetical case study of oxygen isotope fractionation, you will learn to use error propagation to dissect a computational result and identify which part of the model—vibrational, rotational, or solvation effects—contributes most to the overall uncertainty, guiding future model improvements.",
            "id": "4097183",
            "problem": "Consider equilibrium oxygen isotope fractionation between aqueous bicarbonate $\\text{HCO}_3^-$ and liquid water $\\text{H}_2\\text{O}$ at temperature $T=298\\,\\mathrm{K}$. In a quantum mechanical calculation using Density Functional Theory (DFT), the equilibrium fractionation factor for ${}^{18}\\mathrm{O}$ relative to ${}^{16}\\mathrm{O}$, denoted $\\alpha$, is evaluated via molecular partition functions and a continuum solvation model. The measured value at these conditions is $\\alpha_{\\mathrm{meas}}=1.025$. The computed value is obtained by summing three physically motivated contributions to the natural logarithm of the fractionation factor,\n$\\ln\\alpha=\\ln\\alpha_{\\mathrm{vib}}+\\ln\\alpha_{\\mathrm{rot}}+\\ln\\alpha_{\\mathrm{solv}}$, where the subscripts refer to vibrational, rotational, and solvation terms, respectively. The computed contributions are $\\ln\\alpha_{\\mathrm{vib}}=0.0200$, $\\ln\\alpha_{\\mathrm{rot}}=0.0010$, and $\\ln\\alpha_{\\mathrm{solv}}=0.0020$. To analyze the discrepancy between computation and measurement, you are given independent one-standard-deviation uncertainties for these contributions: $\\sigma_{\\mathrm{vib}}=1.5\\times 10^{-3}$, $\\sigma_{\\mathrm{rot}}=3.0\\times 10^{-4}$, and $\\sigma_{\\mathrm{solv}}=1.0\\times 10^{-3}$, each defined as the uncertainty in its respective contribution to $\\ln\\alpha$ arising from model imperfections (e.g., harmonic frequency scaling, rigid-rotor approximation, and continuum solvation).\n\nStarting from the statistical mechanical definition of equilibrium isotope fractionation in terms of molecular partition functions, and using physically justified decomposition into vibrational, rotational, and solvation terms, derive an expression for the variance of the discrepancy in $\\ln\\alpha$ under the assumption of independent Gaussian error sources. Then, compute the normalized variance-based weights $w_i=\\sigma_i^2/\\sum_j \\sigma_j^2$ that quantify the relative expected contribution of each source ($i\\in\\{\\mathrm{vib},\\mathrm{rot},\\mathrm{solv}\\}$) to the observed discrepancy. Report the weights as a row vector $(w_{\\mathrm{vib}},\\,w_{\\mathrm{rot}},\\,w_{\\mathrm{solv}})$ and round your answer to four significant figures. No units are required in the final answer.",
            "solution": "The problem will first be validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   System: Equilibrium oxygen isotope ($^{18}\\mathrm{O}$ vs. $^{16}\\mathrm{O}$) fractionation between aqueous bicarbonate ($\\text{HCO}_3^-$) and liquid water ($\\text{H}_2\\text{O}$).\n-   Temperature: $T=298\\,\\mathrm{K}$.\n-   Measured fractionation factor: $\\alpha_{\\mathrm{meas}}=1.025$.\n-   Computed model for the natural logarithm of the fractionation factor: $\\ln\\alpha=\\ln\\alpha_{\\mathrm{vib}}+\\ln\\alpha_{\\mathrm{rot}}+\\ln\\alpha_{\\mathrm{solv}}$.\n-   Computed contributions: $\\ln\\alpha_{\\mathrm{vib}}=0.0200$, $\\ln\\alpha_{\\mathrm{rot}}=0.0010$, $\\ln\\alpha_{\\mathrm{solv}}=0.0020$.\n-   One-standard-deviation uncertainties in the computed contributions to $\\ln\\alpha$:\n    -   $\\sigma_{\\mathrm{vib}}=1.5\\times 10^{-3}$\n    -   $\\sigma_{\\mathrm{rot}}=3.0\\times 10^{-4}$\n    -   $\\sigma_{\\mathrm{solv}}=1.0\\times 10^{-3}$\n-   Assumption: The error sources for the contributions are independent.\n-   Task 1: Derive an expression for the variance of the discrepancy in $\\ln\\alpha$ under the assumption of independent Gaussian error sources.\n-   Task 2: Compute the normalized variance-based weights $w_i=\\sigma_i^2/\\sum_j \\sigma_j^2$ for $i\\in\\{\\mathrm{vib},\\mathrm{rot},\\mathrm{solv}\\}$.\n-   Task 3: Report the weights as a row vector $(w_{\\mathrm{vib}},\\,w_{\\mathrm{rot}},\\,w_{\\mathrm{solv}})$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on the well-established Bigeleisen-Mayer theory of isotope effects, which connects equilibrium isotope fractionation factors to molecular partition functions. The decomposition of thermodynamic quantities (like the free energy change corresponding to $\\ln\\alpha$) into vibrational, rotational, and solvation components is a standard and physically justified technique in computational chemistry. The use of Density Functional Theory (DFT) and continuum solvation models are state-of-the-art methods in the field. The numerical values provided are of a realistic magnitude for oxygen isotope fractionation at ambient temperatures.\n-   **Well-Posed:** The problem is clearly defined. It provides all necessary data and assumptions (independent errors) to perform the requested derivation and calculation. The objective is unambiguous: derive a formula and compute a specific set of numerical weights.\n-   **Objective:** The language is technical and precise, with no subjective or opinion-based content.\n-   **Incomplete or Contradictory Setup:** The problem is self-contained. All values required for the calculation are given. The assumptions are explicitly stated. There are no internal contradictions. The sum of the computed components, $\\ln\\alpha_{\\mathrm{comp}} = 0.0200 + 0.0010 + 0.0020 = 0.0230$, can be compared to the natural logarithm of the measured value, $\\ln(\\alpha_{\\mathrm{meas}}) = \\ln(1.025) \\approx 0.02469$. The discrepancy is physically plausible given the stated uncertainties.\n-   **Other Flaws:** The problem does not exhibit any other flaws like being non-formalizable, trivial, or unverifiable.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation and Calculation\n\nThe equilibrium isotope fractionation factor, $\\alpha$, is related to the standard Gibbs free energy change, $\\Delta G^{\\circ}$, of the isotope exchange reaction by the expression $\\Delta G^{\\circ} = -RT\\ln\\alpha$, where $R$ is the gas constant and $T$ is the absolute temperature. Therefore, $\\ln\\alpha$ is directly proportional to the free energy change and can be decomposed in the same manner as free energy.\n\nThe problem states that the computationally determined value of $\\ln\\alpha$, which we denote as $\\ln\\alpha_{\\mathrm{comp}}$, is the sum of three distinct physical contributions:\n$$\n\\ln\\alpha_{\\mathrm{comp}} = \\ln\\alpha_{\\mathrm{vib}} + \\ln\\alpha_{\\mathrm{rot}} + \\ln\\alpha_{\\mathrm{solv}}\n$$\nEach of these contributions, $\\ln\\alpha_i$ (where $i \\in \\{\\mathrm{vib}, \\mathrm{rot}, \\mathrm{solv}\\}$), is a random variable due to imperfections in the computational model. The uncertainty in each term is given by its standard deviation, $\\sigma_i$.\n\nThe task is to derive the variance of the total computed value, $\\mathrm{Var}(\\ln\\alpha_{\\mathrm{comp}})$, which we denote as $\\sigma^2_{\\ln\\alpha}$. This variance represents the uncertainty of the computational prediction and provides a statistical metric against which the discrepancy with the measured value, $\\alpha_{\\mathrm{meas}}$, can be assessed.\n\nFor a function $f(X_1, X_2, \\dots, X_n)$ of several variables $X_i$ with variances $\\sigma_i^2$, the general formula for propagation of variance is:\n$$\n\\sigma_f^2 \\approx \\sum_{i=1}^{n} \\left( \\frac{\\partial f}{\\partial X_i} \\right)^2 \\sigma_i^2 + 2 \\sum_{i<j}^{n} \\left( \\frac{\\partial f}{\\partial X_i} \\right) \\left( \\frac{\\partial f}{\\partial X_j} \\right) \\mathrm{Cov}(X_i, X_j)\n$$\nIn our case, the function is a simple sum: $\\ln\\alpha_{\\mathrm{comp}} = \\ln\\alpha_{\\mathrm{vib}} + \\ln\\alpha_{\\mathrm{rot}} + \\ln\\alpha_{\\mathrm{solv}}$. The problem explicitly states that the error sources are independent, which implies that the covariance terms are zero, i.e., $\\mathrm{Cov}(\\ln\\alpha_i, \\ln\\alpha_j) = 0$ for $i \\neq j$.\n\nThe partial derivatives of $\\ln\\alpha_{\\mathrm{comp}}$ with respect to each contribution are all unity:\n$$\n\\frac{\\partial (\\ln\\alpha_{\\mathrm{comp}})}{\\partial (\\ln\\alpha_{\\mathrm{vib}})} = 1, \\quad \\frac{\\partial (\\ln\\alpha_{\\mathrm{comp}})}{\\partial (\\ln\\alpha_{\\mathrm{rot}})} = 1, \\quad \\frac{\\partial (\\ln\\alpha_{\\mathrm{comp}})}{\\partial (\\ln\\alpha_{\\mathrm{solv}})} = 1\n$$\nSubstituting these into the variance propagation formula, we obtain the expression for the total variance:\n$$\n\\sigma^2_{\\ln\\alpha} = (1)^2 \\sigma_{\\mathrm{vib}}^2 + (1)^2 \\sigma_{\\mathrm{rot}}^2 + (1)^2 \\sigma_{\\mathrm{solv}}^2\n$$\nThus, the variance of the computed $\\ln\\alpha$ is simply the sum of the variances of its independent components:\n$$\n\\sigma^2_{\\ln\\alpha} = \\sigma_{\\mathrm{vib}}^2 + \\sigma_{\\mathrm{rot}}^2 + \\sigma_{\\mathrm{solv}}^2\n$$\nThis completes the derivation.\n\nNext, we compute the normalized variance-based weights, $w_i$, which represent the fractional contribution of each source of error to the total variance. The definition is given as $w_i = \\sigma_i^2 / \\sum_j \\sigma_j^2$. Using our derived expression for the total variance, this becomes:\n$$\nw_i = \\frac{\\sigma_i^2}{\\sigma_{\\mathrm{vib}}^2 + \\sigma_{\\mathrm{rot}}^2 + \\sigma_{\\mathrm{solv}}^2}\n$$\nWe are given the following standard deviations:\n-   $\\sigma_{\\mathrm{vib}} = 1.5 \\times 10^{-3}$\n-   $\\sigma_{\\mathrm{rot}} = 3.0 \\times 10^{-4}$\n-   $\\sigma_{\\mathrm{solv}} = 1.0 \\times 10^{-3}$\n\nFirst, we calculate the variance for each component:\n-   $\\sigma_{\\mathrm{vib}}^2 = (1.5 \\times 10^{-3})^2 = 2.25 \\times 10^{-6}$\n-   $\\sigma_{\\mathrm{rot}}^2 = (3.0 \\times 10^{-4})^2 = 9.0 \\times 10^{-8} = 0.09 \\times 10^{-6}$\n-   $\\sigma_{\\mathrm{solv}}^2 = (1.0 \\times 10^{-3})^2 = 1.0 \\times 10^{-6}$\n\nNext, we compute the total variance, $\\sum_j \\sigma_j^2$:\n$$\n\\sum_j \\sigma_j^2 = (2.25 \\times 10^{-6}) + (0.09 \\times 10^{-6}) + (1.0 \\times 10^{-6}) = 3.34 \\times 10^{-6}\n$$\nNow we can compute the weights $w_i$:\n-   $w_{\\mathrm{vib}} = \\frac{\\sigma_{\\mathrm{vib}}^2}{\\sum_j \\sigma_j^2} = \\frac{2.25 \\times 10^{-6}}{3.34 \\times 10^{-6}} = \\frac{2.25}{3.34} \\approx 0.67365269...$\n-   $w_{\\mathrm{rot}} = \\frac{\\sigma_{\\mathrm{rot}}^2}{\\sum_j \\sigma_j^2} = \\frac{0.09 \\times 10^{-6}}{3.34 \\times 10^{-6}} = \\frac{0.09}{3.34} \\approx 0.02694610...$\n-   $w_{\\mathrm{solv}} = \\frac{\\sigma_{\\mathrm{solv}}^2}{\\sum_j \\sigma_j^2} = \\frac{1.0 \\times 10^{-6}}{3.34 \\times 10^{-6}} = \\frac{1.0}{3.34} \\approx 0.29940119...$\n\nRounding these values to four significant figures as required:\n-   $w_{\\mathrm{vib}} \\approx 0.6737$\n-   $w_{\\mathrm{rot}} \\approx 0.02695$\n-   $w_{\\mathrm{solv}} \\approx 0.2994$\n\nThe final result is the row vector $(w_{\\mathrm{vib}}, w_{\\mathrm{rot}}, w_{\\mathrm{solv}})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6737 & 0.02695 & 0.2994\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from theoretical equations to reliable scientific code requires careful attention to numerical stability. This advanced exercise challenges you to implement the Bigeleisen-Mayer equation for calculating $\\ln \\beta$ in a way that is robust across extreme temperature ranges. You will confront and solve common numerical pitfalls like subtractive cancellation and floating-point underflow, developing essential skills for writing research-grade computational tools.",
            "id": "4097161",
            "problem": "Construct a program that, for a set of vibrational mode pairs of a light and a heavy isotopologue, computes the natural logarithm of the reduced partition function ratio (denoted $\\ln \\beta$) using only the harmonic approximation, and does so in a numerically stable manner across very low and very high temperatures. The scientific base you must start from is the quantum harmonic oscillator and the canonical partition function definition. Your implementation must avoid subtractive cancellation and floating-point underflow by reformulating the calculation of logarithms of small differences. All physical constants must be treated consistently in the International System of Units (SI), and vibrational frequencies must be specified as wavenumbers in inverse centimeters.\n\nFundamental base and data model:\n- Consider a set of vibrational normal modes for a light isotopologue with wavenumbers $\\{\\tilde{\\nu}_i\\}$ and the corresponding modes for a heavy isotopologue $\\{\\tilde{\\nu}_i'\\}$, all expressed in $\\text{cm}^{-1}$. Assume the harmonic oscillator model and separability of vibrational modes.\n- For each vibrational mode, define the dimensionless parameter $u_i = \\dfrac{h c (100\\,\\mathrm{cm/m}) \\tilde{\\nu}_i}{k_\\mathrm{B} T}$ and $u_i' = \\dfrac{h c (100\\,\\mathrm{cm/m}) \\tilde{\\nu}_i'}{k_\\mathrm{B} T}$, where $h$ is Planck's constant, $c$ is the speed of light in vacuum, $k_\\mathrm{B}$ is Boltzmann's constant, and $T$ is temperature in kelvin.\n- Starting from the quantum harmonic oscillator partition function and the standard definition of the reduced partition function ratio in the Bigeleisen–Mayer framework, it follows that $\\ln \\beta$ for a single substituted site under the harmonic approximation is expressible as a sum of per-mode contributions that depend on $u_i$ and $u_i'$.\n\nComputational objective:\n- Implement a numerically stable algorithm to compute $\\ln \\beta$ for a given temperature $T$ and matched lists of vibrational wavenumbers $\\{\\tilde{\\nu}_i\\}$ and $\\{\\tilde{\\nu}_i'\\}$ using mathematically equivalent transformations to avoid subtractive cancellation and underflow. In particular, the computation must remain stable when $u_i$ or $u_i'$ are very small (high $T$ and/or low $\\tilde{\\nu}$) and when they are very large (low $T$ and/or high $\\tilde{\\nu}$).\n- The program must not accept any input at runtime. It must contain the following fixed test suite of five cases and compute one numerical result (a single floating-point value) for each case:\n  1. Case A (happy path): $T = 300\\,\\mathrm{K}$, light modes $[500, 700, 1100, 1400, 3000]\\, \\text{cm}^{-1}$, heavy modes $[493, 690, 1085, 1378, 2950]\\, \\text{cm}^{-1}$.\n  2. Case B (very low temperature): $T = 10\\,\\mathrm{K}$, light modes $[500, 700, 1100, 1400, 3000]\\, \\text{cm}^{-1}$, heavy modes $[493, 690, 1085, 1378, 2950]\\, \\text{cm}^{-1}$.\n  3. Case C (very high temperature): $T = 3000\\,\\mathrm{K}$, light modes $[500, 700, 1100, 1400, 3000]\\, \\text{cm}^{-1}$, heavy modes $[493, 690, 1085, 1378, 2950]\\, \\text{cm}^{-1}$.\n  4. Case D (small $u$ edge case with very low frequencies): $T = 5000\\,\\mathrm{K}$, light modes $[1, 2, 3, 4, 5]\\, \\text{cm}^{-1}$, heavy modes $[0.99, 1.98, 2.97, 3.96, 4.95]\\, \\text{cm}^{-1}$.\n  5. Case E (large $u$ edge case with very high frequencies): $T = 5\\,\\mathrm{K}$, light modes $[2800, 3400, 3650]\\, \\text{cm}^{-1}$, heavy modes $[2760, 3350, 3600]\\, \\text{cm}^{-1}$.\n- All temperatures $T$ must be treated in kelvin. All wavenumbers must be treated in inverse centimeters. The final results $\\ln \\beta$ are dimensionless and must be returned as floating-point numbers.\n\nNumerical stability requirements:\n- Your implementation must reformulate expressions such that evaluations of $\\ln(1 - e^{-u})$ do not suffer catastrophic loss of significance when $u$ is small, and that exponentials for very large $u$ do not cause underflow. You may use elementary transformations that are mathematically equivalent, and special functions that compute differences or sums with improved accuracy.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the five cases listed above. For example, the output must look like $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is the computed $\\ln \\beta$ for case $i$ as a floating-point number in decimal form. No additional text should be printed.",
            "solution": "We begin with the canonical partition function for a one-dimensional quantum harmonic oscillator. For a mode with angular frequency $\\omega$, the partition function is\n$$\nq_\\mathrm{vib}(\\omega, T) = \\frac{e^{-\\hbar \\omega/(2 k_\\mathrm{B} T)}}{1 - e^{-\\hbar \\omega/(k_\\mathrm{B} T)}}.\n$$\nTo work with spectroscopic wavenumbers $\\tilde{\\nu}$ in $\\text{cm}^{-1}$, we note that $\\hbar \\omega = h c \\tilde{\\nu}$ when $\\tilde{\\nu}$ is used as a wavenumber, with $c$ in $\\text{cm s}^{-1}$. Using SI units systematically, with $c$ in $\\text{m s}^{-1}$ and $\\tilde{\\nu}$ in $\\text{cm}^{-1}$, we write\n$$\nu = \\frac{h c (100\\,\\mathrm{cm/m}) \\tilde{\\nu}}{k_\\mathrm{B} T}.\n$$\n\nFor a molecule with separable normal modes in the harmonic approximation, the vibrational contribution to the reduced partition function ratio (commonly denoted by $\\beta$) for an isotopic substitution is given by the Bigeleisen–Mayer framework as a product of per-mode ratios. Taking natural logarithms yields an additive form. For matched modes between a light isotopologue and a heavy isotopologue, with corresponding dimensionless parameters $u_i$ and $u_i'$, we have\n$$\n\\ln \\beta = \\sum_i \\left[ \\ln\\left(\\frac{u_i'}{u_i}\\right) + \\ln\\left(\\frac{1 - e^{-u_i}}{1 - e^{-u_i'}}\\right) + \\frac{1}{2}\\left(u_i - u_i'\\right) \\right].\n$$\nThis expression follows from combining the frequency scaling factor and the vibrational partition functions in the harmonic approximation.\n\nNumerical stability analysis:\n- For very small $u$ (corresponding to high temperature or very low wavenumber), the quantity $e^{-u}$ is close to $1$, so the difference $1 - e^{-u}$ is small. Directly evaluating $1 - e^{-u}$ can lose significant digits due to subtractive cancellation because $e^{-u} \\approx 1 - u + u^2/2 - \\dots$ and the leading $1$ cancels. Taking a logarithm afterwards amplifies relative errors. A stable reformulation is to use the identity\n$$\n\\ln\\!\\left(1 - e^{-u}\\right) = \\ln\\!\\left(-\\mathrm{expm1}(-u)\\right),\n$$\nwhere $\\mathrm{expm1}(x)$ computes $e^{x} - 1$ with high relative accuracy even for small $x$. Since for $u > 0$ we have $\\mathrm{expm1}(-u) < 0$, the argument of the outer logarithm is positive and well-defined. When $u$ is extremely small, $\\mathrm{expm1}(-u) \\approx -u + \\mathcal{O}(u^2)$ is computed accurately without catastrophic cancellation, so $\\ln(1 - e^{-u})$ is accurately obtained as $\\ln(u + \\mathcal{O}(u^2))$.\n- For very large $u$ (corresponding to low temperature or very high wavenumber), the exponential $e^{-u}$ underflows to zero in floating-point arithmetic. In that limit, $1 - e^{-u} \\to 1$ and $\\ln(1 - e^{-u}) \\to 0$. To maintain stability without overflow/underflow, one can evaluate either $\\ln(1 - e^{-u})$ via $\\ln1p(-e^{-u})$ or via $\\ln(-\\mathrm{expm1}(-u))$. When $u$ is so large that $e^{-u}$ underflows to $0$, $\\ln1p(-0) = 0$ and $\\mathrm{expm1}(-u) \\approx -1$, giving $\\ln(1) = 0$. Both alternatives are stable.\n\nAlgorithmic design:\n1. For each test case temperature $T$ and wavenumber lists $\\{\\tilde{\\nu}_i\\}$ and $\\{\\tilde{\\nu}_i'\\}$ (in $\\text{cm}^{-1}$), compute $u_i$ and $u_i'$ via\n   $$\n   u_i = \\frac{h c (100)\\,\\tilde{\\nu}_i}{k_\\mathrm{B} T}, \\quad u_i' = \\frac{h c (100)\\,\\tilde{\\nu}_i'}{k_\\mathrm{B} T}.\n   $$\n   Here $h$ is Planck's constant in $\\text{J s}$, $c$ is the speed of light in $\\text{m s}^{-1}$, and $k_\\mathrm{B}$ is Boltzmann's constant in $\\text{J K}^{-1}$.\n2. Compute the per-mode terms and sum them:\n   $$\n   \\ln \\beta = \\sum_i \\left[ \\ln(u_i') - \\ln(u_i) + \\ln(1 - e^{-u_i}) - \\ln(1 - e^{-u_i'}) + \\frac{1}{2} (u_i - u_i') \\right].\n   $$\n   Each $\\ln(1 - e^{-u})$ is to be computed stably using\n   $$\n   \\ln(1 - e^{-u}) = \\ln\\!\\big(-\\mathrm{expm1}(-u)\\big),\n   $$\n   with a safe fallback to $\\ln1p(-e^{-u})$ when $u$ is moderate or large. This blend ensures stability for both the small-$u$ and large-$u$ regimes.\n3. Aggregate the results for the specified five test cases in the requested order.\n\nJustification:\n- The expression for $\\ln \\beta$ derives from the harmonic oscillator partition function and the Bigeleisen–Mayer reduced partition function ratio. The numerical reformulation only changes the computational pathway of $\\ln(1 - e^{-u})$ and does not alter the mathematics.\n- The use of $\\mathrm{expm1}$ and $\\ln1p$ (natural logarithm of $1 + x$) functions is a standard approach in numerical analysis to avoid precision loss when adding or subtracting nearly equal numbers.\n\nTest suite and expected output:\n- The program must hard-code the five cases listed in the problem statement. For each case, it computes $\\ln \\beta$ as a floating-point number (dimensionless). The program outputs a single line:\n  $$\n  [x_1,x_2,x_3,x_4,x_5]\n  $$\n  where $x_1$ through $x_5$ are the computed values for cases A through E, respectively. The values are printed using the default decimal string conversion of floating-point numbers, which suffices to verify correctness.\n\nThe implementation provided in the final answer follows this design, using $h = 6.62607015\\times 10^{-34}\\,\\text{J s}$, $c = 299792458\\,\\text{m s}^{-1}$, and $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\text{J K}^{-1}$, and applies the stable evaluation of $\\ln(1 - e^{-u})$ to ensure robustness at both extremes of $T$ and $\\tilde{\\nu}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants in SI units\nH = 6.62607015e-34       # Planck constant, J*s\nC = 299792458.0          # speed of light, m/s\nKB = 1.380649e-23        # Boltzmann constant, J/K\nCM_TO_M = 1e-2           # centimeters to meters\n\ndef u_from_wavenumber_cm1(nu_cm1, T):\n    \"\"\"\n    Compute dimensionless u = h c (100) * nu / (k_B T),\n    where nu is a wavenumber in cm^-1 and T in K.\n    \"\"\"\n    # h*c*(100 cm/m) = H * C * (100)\n    factor = (H * C * 100.0) / (KB * T)\n    return factor * np.asarray(nu_cm1, dtype=np.float64)\n\ndef stable_log_one_minus_exp_neg(u):\n    \"\"\"\n    Compute log(1 - exp(-u)) stably for u >= 0.\n\n    Strategy:\n    - For small u, use log(-expm1(-u)), because expm1(-u) ~ -u + u^2/2 ... is accurate.\n    - For moderate/large u, log1p(-exp(-u)) is fine and avoids underflow.\n    Use a threshold to choose; both branches are correct and stable in their regimes.\n    \"\"\"\n    u = np.asarray(u, dtype=np.float64)\n    # Threshold where exp(-u) is not too close to 1; choose ~1e-2 as a safe small-u cutoff\n    small = u < 1e-2\n    out = np.empty_like(u)\n    # Small u branch\n    out[small] = np.log(-np.expm1(-u[small]))\n    # Large u branch\n    # For very large u, np.exp(-u) will be 0, so log1p(-0) = 0\n    exp_neg = np.exp(-u[~small])\n    out[~small] = np.log1p(-exp_neg)\n    return out\n\ndef ln_beta(T, nu_light_cm1, nu_heavy_cm1):\n    \"\"\"\n    Compute ln(beta) for matched lists of vibrational wavenumbers (cm^-1)\n    at temperature T (K), using a numerically stable formulation.\n    \"\"\"\n    nu_light = np.asarray(nu_light_cm1, dtype=np.float64)\n    nu_heavy = np.asarray(nu_heavy_cm1, dtype=np.float64)\n    if nu_light.shape != nu_heavy.shape:\n        raise ValueError(\"Light and heavy mode arrays must have the same shape.\")\n    if np.any(nu_light <= 0.0) or np.any(nu_heavy <= 0.0):\n        raise ValueError(\"All vibrational wavenumbers must be positive.\")\n\n    u_light = u_from_wavenumber_cm1(nu_light, T)\n    u_heavy = u_from_wavenumber_cm1(nu_heavy, T)\n\n    # Compute the stable components\n    term_log_u_ratio = np.log(u_heavy) - np.log(u_light)\n    term_log_1_minus = stable_log_one_minus_exp_neg(u_light) - stable_log_one_minus_exp_neg(u_heavy)\n    term_half_diff = 0.5 * (u_light - u_heavy)\n\n    total = np.sum(term_log_u_ratio + term_log_1_minus + term_half_diff)\n    return float(total)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T_K, light_modes_cm1, heavy_modes_cm1)\n    test_cases = [\n        (300.0,  [500.0, 700.0, 1100.0, 1400.0, 3000.0],\n                 [493.0, 690.0, 1085.0, 1378.0, 2950.0]),\n        (10.0,   [500.0, 700.0, 1100.0, 1400.0, 3000.0],\n                 [493.0, 690.0, 1085.0, 1378.0, 2950.0]),\n        (3000.0, [500.0, 700.0, 1100.0, 1400.0, 3000.0],\n                 [493.0, 690.0, 1085.0, 1378.0, 2950.0]),\n        (5000.0, [1.0, 2.0, 3.0, 4.0, 5.0],\n                 [0.99, 1.98, 2.97, 3.96, 4.95]),\n        (5.0,    [2800.0, 3400.0, 3650.0],\n                 [2760.0, 3350.0, 3600.0]),\n    ]\n\n    results = []\n    for T, nu_light, nu_heavy in test_cases:\n        result = ln_beta(T, nu_light, nu_heavy)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}