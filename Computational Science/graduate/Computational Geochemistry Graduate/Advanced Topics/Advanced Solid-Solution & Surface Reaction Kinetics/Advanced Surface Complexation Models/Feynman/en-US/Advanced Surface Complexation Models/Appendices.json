{
    "hands_on_practices": [
        {
            "introduction": "Surface complexation models are built upon the fundamental principles of chemical equilibrium. This first exercise strips away the electrostatic complexity to focus on the core chemical reaction: the protonation and deprotonation of a surface hydroxyl group. By calculating the fraction of protonated sites as a function of pH and the site's intrinsic acidity constant, you will build a foundational understanding of how surface charge originates and responds to changes in the chemical environment .",
            "id": "4068095",
            "problem": "A Charge Distribution Multi-Site Complexation (CD-MUSIC) model describes proton adsorption on oxide surface functional groups via intrinsic equilibria defined at the crystal’s zero-charge plane, with electrostatic corrections applied separately. Consider a ferric hydroxyl surface site written as $\\mathrm{>FeOH}$ interacting with aqueous protons. The system is isothermal and dilute so that activities of aqueous species can be approximated by concentrations, and the zero-plane electrostatic potential is taken as zero (no electrostatic correction). The aqueous proton activity is defined by $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$, and the intrinsic equilibrium constant $K^{0}$ for a reaction is related to its intrinsic acidity constant by $pK^{0} = -\\log_{10} K^{0}$. \n\nYou are given an intrinsic acidity constant $pK^{0} = 7.5$ associated with the deprotonation of the protonated surface species. \n\n- Write the two acid–base reactions that interconvert $\\mathrm{>FeOH}$ and $\\mathrm{>FeOH_{2}^{+}}$ (one as a protonation and the other as a deprotonation).\n- Starting from the law of mass action and a site mass balance, derive from first principles an expression for the fraction of protonated sites, defined as $\\theta_{\\mathrm{H}} = \\frac{[\\mathrm{>FeOH_{2}^{+}}]}{[\\mathrm{>FeOH_{2}^{+}}] + [\\mathrm{>FeOH}] }$, in terms of $\\mathrm{pH}$ and $pK^{0}$ under the stated assumptions, and then evaluate this fraction at $\\mathrm{pH} = 6$ for $pK^{0} = 7.5$.\n\nExpress the final fraction as a unitless decimal number rounded to four significant figures.",
            "solution": "The problem requires writing the relevant acid-base surface reactions, deriving an expression for the fraction of protonated sites, and then calculating this fraction for the given conditions.\n\nFirst, we write the two acid-base reactions that interconvert the surface species $\\mathrm{>FeOH}$ and its protonated form $\\mathrm{>FeOH_2^+}$. The protonation reaction involves the uptake of a proton by the neutral site, and the deprotonation reaction is the reverse process.\n\nProtonation reaction:\n$$ \\mathrm{>FeOH} + \\mathrm{H}^{+} \\rightleftharpoons \\mathrm{>FeOH_2^+} $$\n\nDeprotonation reaction:\n$$ \\mathrm{>FeOH_2^+} \\rightleftharpoons \\mathrm{>FeOH} + \\mathrm{H}^{+} $$\n\nThe problem provides an intrinsic acidity constant, $pK^{0} = 7.5$, associated with the deprotonation of the protonated species. This value corresponds to the second reaction written above.\n\nNext, we derive the expression for the fraction of protonated sites, $\\theta_{\\mathrm{H}}$. We begin with the law of mass action for the deprotonation reaction. The intrinsic equilibrium constant, $K^{0}$, is defined as:\n$$ K^{0} = \\frac{[\\mathrm{>FeOH}] a_{\\mathrm{H}^{+}}}{[\\mathrm{>FeOH_2^+}]} $$\nwhere $[\\mathrm{>FeOH}]$ and $[\\mathrm{>FeOH_2^+}]$ are the concentrations of the surface species, and $a_{\\mathrm{H}^{+}}$ is the activity of aqueous protons. The problem states that the zero-plane electrostatic potential is zero, so no electrostatic correction term ($\\exp(-\\frac{F\\psi_0}{RT})$) is needed.\n\nWe are given the relationships between $K^{0}$ and $pK^{0}$, and between $a_{\\mathrm{H}^{+}}$ and $\\mathrm{pH}$:\n$$ pK^{0} = -\\log_{10}(K^{0}) \\implies K^{0} = 10^{-pK^{0}} $$\n$$ \\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}}) \\implies a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}} $$\n\nSubstituting these into the mass action expression yields:\n$$ 10^{-pK^{0}} = \\frac{[\\mathrm{>FeOH}] \\cdot 10^{-\\mathrm{pH}}}{[\\mathrm{>FeOH_2^+}]} $$\n\nWe can rearrange this equation to find the ratio of the concentrations of the deprotonated sites to the protonated sites:\n$$ \\frac{[\\mathrm{>FeOH}]}{[\\mathrm{>FeOH_2^+}]} = \\frac{10^{-pK^{0}}}{10^{-\\mathrm{pH}}} = 10^{\\mathrm{pH} - pK^{0}} $$\n\nThe fraction of protonated sites, $\\theta_{\\mathrm{H}}$, is defined by the site mass balance:\n$$ \\theta_{\\mathrm{H}} = \\frac{[\\mathrm{>FeOH_2^+}]}{[\\mathrm{>FeOH_2^+}] + [\\mathrm{>FeOH}]} $$\n\nTo express $\\theta_{\\mathrm{H}}$ in terms of $\\mathrm{pH}$ and $pK^{0}$, we can divide the numerator and the denominator by $[\\mathrm{>FeOH_2^+}]$:\n$$ \\theta_{\\mathrm{H}} = \\frac{\\frac{[\\mathrm{>FeOH_2^+}]}{[\\mathrm{>FeOH_2^+}]}}{\\frac{[\\mathrm{>FeOH_2^+}]}{[\\mathrm{>FeOH_2^+}]} + \\frac{[\\mathrm{>FeOH}]}{[\\mathrm{>FeOH_2^+}]}} = \\frac{1}{1 + \\frac{[\\mathrm{>FeOH}]}{[\\mathrm{>FeOH_2^+}]}} $$\n\nNow, we substitute the ratio we derived from the law of mass action:\n$$ \\theta_{\\mathrm{H}} = \\frac{1}{1 + 10^{\\mathrm{pH} - pK^{0}}} $$\nThis is the desired expression for the fraction of protonated sites from first principles.\n\nFinally, we evaluate this fraction for the given values: $\\mathrm{pH} = 6$ and $pK^{0} = 7.5$.\n$$ \\theta_{\\mathrm{H}} = \\frac{1}{1 + 10^{6 - 7.5}} = \\frac{1}{1 + 10^{-1.5}} $$\n\nWe calculate the numerical value:\n$$ 10^{-1.5} \\approx 0.0316227766 $$\n$$ \\theta_{\\mathrm{H}} = \\frac{1}{1 + 0.0316227766} = \\frac{1}{1.0316227766} \\approx 0.9693465... $$\n\nRounding the result to four significant figures as requested gives:\n$$ \\theta_{\\mathrm{H}} \\approx 0.9693 $$",
            "answer": "$$\\boxed{0.9693}$$"
        },
        {
            "introduction": "A key innovation of the Charge Distribution-Multi Site Complexation (CD-MUSIC) model is its physically realistic treatment of charge at the mineral-water interface. Instead of assigning integer charges to planes, the model distributes the charge of an adsorbing ion based on bond-valence principles. This practice provides a direct, hands-on calculation of how an ion's charge is partitioned between the surface and the ion itself, which is a critical concept for correctly formulating the electrostatic part of the model .",
            "id": "4068113",
            "problem": "Consider a hematite surface bearing ferric hydroxyl groups denoted as $\\mathrm{>FeOH}$ that are deprotonated at high pH to $\\mathrm{>FeO^{-}}$. A divalent lead ion, $\\mathrm{Pb}^{2+}$, forms a bidentate inner-sphere complex by binding to two such surface oxygens, each originating from a singly coordinated $\\mathrm{>FeO^{-}}$ group. In the Charge Distribution – Multiple Site Complexation (CD-MUSIC) model, the charge of an adsorbing ion is distributed over its bonds according to the bond-valence concept: the bond valence $s$ (in valence units) of each metal–oxygen bond contributes a portion of the metal’s formal valence $Z_{\\mathrm{M}}$ to the atom it bonds, and the sum of all bond valences around the metal equals $Z_{\\mathrm{M}}$. Assume the two inner-sphere $\\mathrm{Pb}$–$\\mathrm{O}$ bonds to the surface each have a bond valence of $s_{\\mathrm{Pb-O}} = 0.8$ (valence units), and the remaining coordination of $\\mathrm{Pb}^{2+}$ is satisfied by hydration in the electrolyte (ignore any direct mineral-plane contribution from these solution ligands). The formal valence of lead is $Z_{\\mathrm{Pb}} = 2$. Prior to adsorption, each $\\mathrm{>FeO^{-}}$ carries a formal charge of $-1$ localized at the surface oxygen.\n\nUsing these premises and the CD-MUSIC charge distribution principle, assign the fractional charge contribution of $\\mathrm{Pb}^{2+}$ to each of the two surface oxygens and to the $\\mathrm{Pb}$ center (interpreted as residing on the electrolyte side), and compute the net charge added to the Stern layer (the $1$-plane of the electrical double layer) by formation of this bidentate complex. Express the final net charge in units of the elementary charge $e$ as a single real number. Do not include units in your final numeric answer.",
            "solution": "The problem asks for the net charge added to the Stern layer upon the formation of an inner-sphere bidentate lead complex on a hematite-like surface, according to the Charge Distribution – Multiple Site Complexation (CD-MUSIC) model.\n\nFirst, we establish the initial state. The surface consists of deprotonated ferric hydroxyl groups, $\\mathrm{>FeO^{-}}$, each carrying a formal charge of $-1$ elementary charge unit, $e$. This charge is located at the surface oxygen, which defines the $0$-plane in the electrical double layer (EDL) model. The adsorbing species is a divalent lead ion, $\\mathrm{Pb}^{2+}$, with a formal valence of $Z_{\\mathrm{Pb}} = +2$.\n\nThe lead ion forms a bidentate complex by binding to two $\\mathrm{>FeO^{-}}$ sites. The reaction can be written as:\n$$\n2(\\mathrm{>FeO^{-}}) + \\mathrm{Pb}^{2+} \\rightarrow (\\mathrm{>FeO})_2\\mathrm{Pb}\n$$\nThe CD-MUSIC model distributes the charge of the central metal ion, $\\mathrm{Pb}^{2+}$, among its bonds based on the bond-valence concept. The total valence of the lead ion, $Z_{\\mathrm{Pb}} = +2$, must be conserved, meaning the sum of the valences of all bonds originating from the $\\mathrm{Pb}$ ion must equal $+2$.\n\nThe problem states that the $\\mathrm{Pb}^{2+}$ ion forms two inner-sphere bonds with two surface oxygens. Each of these $\\mathrm{Pb}$–$\\mathrm{O}$ bonds has a bond valence, $s_{\\mathrm{Pb-O}}$, of $0.8$ valence units (v.u.). In the CD-MUSIC framework, this bond valence represents the amount of positive charge (in units of $e$) that the cation ($\\mathrm{Pb}^{2+}$) contributes to the anion it is bonded to (the surface oxygen).\n\nTherefore, the total charge contributed by the $\\mathrm{Pb}^{2+}$ ion to the two surface oxygens in the $0$-plane is the sum of the bond valences of the two inner-sphere bonds:\n$$\n\\Delta q_{0\\text{-plane}} = 2 \\times s_{\\mathrm{Pb-O}} = 2 \\times 0.8 = 1.6\n$$\nThis value, $+1.6e$, is the portion of the lead ion's charge that is effectively transferred to the $0$-plane.\n\nThe remaining charge of the lead ion is assigned to the lead atom itself. The sum of all bond valences must equal the ion's formal valence. The problem specifies that the remaining coordination of $\\mathrm{Pb}^{2+}$ is satisfied by hydration, meaning any other bonds are to water molecules in the electrolyte and not to the mineral surface. The charge assigned to the lead ion's location is therefore its original charge minus the charge distributed to the surface bonds. This residual charge, $q_{\\mathrm{res}}$, is:\n$$\nq_{\\mathrm{res}} = Z_{\\mathrm{Pb}} - (2 \\times s_{\\mathrm{Pb-O}})\n$$\nSubstituting the given values:\n$$\nq_{\\mathrm{res}} = 2 - (2 \\times 0.8) = 2 - 1.6 = 0.4\n$$\nThis residual charge of $+0.4e$ is located at the nucleus of the adsorbing ion. For an inner-sphere complex, the plane containing the nuclei of the adsorbed ions is the Stern layer, also referred to as the $1$-plane or $\\beta$-plane.\n\nThe problem asks for the net charge added to the Stern layer. Before adsorption, the $\\mathrm{Pb}^{2+}$ ion is in the bulk solution, and the Stern layer is considered to have a charge of $0$ relative to this specific adsorption event. Upon formation of the inner-sphere complex, the lead ion's center, carrying its residual charge, becomes physically located in the Stern layer.\n\nThus, the net charge added to the Stern layer ($1$-plane) is precisely this residual charge, $q_{\\mathrm{res}}$.\n$$\n\\text{Net charge added to Stern layer} = q_{\\mathrm{res}} = +0.4e\n$$\nTo verify this, we can check the overall charge balance of the complex.\nThe initial charge of the two surface sites in the $0$-plane is $2 \\times (-1) = -2$.\nAfter complexation, the charge in the $0$-plane is the initial charge plus the charge transferred from the lead ion:\n$$\nq_{0\\text{-plane, final}} = -2 + (2 \\times s_{\\mathrm{Pb-O}}) = -2 + 1.6 = -0.4\n$$\nThe charge in the $1$-plane is the residual charge on the lead atom:\n$$\nq_{1\\text{-plane, final}} = q_{\\mathrm{res}} = +0.4\n$$\nThe total charge of the surface complex distributed across the EDL planes is the sum of charges in the $0$-plane and $1$-plane:\n$$\nq_{\\text{total}} = q_{0\\text{-plane, final}} + q_{1\\text{-plane, final}} = -0.4 + 0.4 = 0\n$$\nThis matches the formal charge of the neutral product $(\\mathrm{>FeO})_2\\mathrm{Pb}$, confirming the consistency of the charge distribution. The net charge added to the Stern layer is $0.4$, expressed in units of the elementary charge $e$.",
            "answer": "$$\n\\boxed{0.4}\n$$"
        },
        {
            "introduction": "Practical application of advanced surface complexation models involves integrating multiple coupled processes into a single, self-consistent framework. This computational exercise challenges you to build a numerical solver that combines mass action, mass balance, and electrostatic relationships to predict adsorption behavior. By implementing a model that iteratively solves for the surface potential and speciation, you will gain firsthand experience with the computational engine that powers modern geochemical modeling software and see how different binding hypotheses affect predictions .",
            "id": "4068160",
            "problem": "Consider a goethite surface described by the Charge Distribution–Multi-Site Complexation (CD-MUSIC) framework (first mention spelled out) under fixed hydrogen ion activity and total surface site density. Model the surface as a single functional group $\\equiv \\mathrm{SOH}$ that undergoes protonation and deprotonation, and that forms either monodentate or bidentate inner-sphere complexes with aqueous arsenate. The aqueous arsenate speciation is governed by triprotic acid equilibrium in the bulk solution. Assume a single-plane constant capacitance approximation to connect the accumulated $0$-plane charge and electrostatic potential.\n\nFundamental base:\n- Law of mass action for chemical equilibria with activities.\n- Electroneutrality in the interfacial region enforced via the capacitor relation between $0$-plane charge and potential.\n- Triprotic acid dissociation equilibria for arsenic acid in water at temperature $T$.\n\nDefinitions and parameters:\n- Let $N_\\mathrm{s}$ denote the total surface site density per unit volume in $\\mathrm{mol\\ L^{-1}}$.\n- Let $A_\\mathrm{s}$ denote the specific surface area per unit volume in $\\mathrm{m^2\\ L^{-1}}$.\n- Let $C_\\mathrm{cap}$ denote the constant capacitance in $\\mathrm{F\\ m^{-2}}$.\n- Let $T$ denote the absolute temperature in $\\mathrm{K}$.\n- Let $C_\\mathrm{As}$ denote the total arsenate concentration in $\\mathrm{mol\\ L^{-1}}$, and let $\\mathrm{pH}$ be fixed, with $[\\mathrm{H}^+] = 10^{-\\mathrm{pH}}$ in $\\mathrm{mol\\ L^{-1}}$.\n- Let $F$ be Faraday’s constant in $\\mathrm{C\\ mol^{-1}}$ and $R$ the gas constant in $\\mathrm{J\\ mol^{-1}\\ K^{-1}}$.\n- Intrinsic equilibrium constants (activities-based) for surface acid-base reactions:\n  - Protonation: $\\equiv \\mathrm{SOH} + \\mathrm{H}^+ \\rightleftharpoons \\equiv \\mathrm{SOH}_2^+$ with $K_\\mathrm{a,int}$.\n  - Deprotonation: $\\equiv \\mathrm{SOH} \\rightleftharpoons \\equiv \\mathrm{SO}^- + \\mathrm{H}^+$ with $K_\\mathrm{b,int}$.\n- Intrinsic adsorption equilibrium constants:\n  - Monodentate complex (one site per arsenate): $\\equiv \\mathrm{SOH} + \\mathrm{HAsO_4^{2-}} + \\mathrm{H}^+ \\rightleftharpoons \\equiv \\mathrm{S{-}AsO_4H}^-$ with $K_{\\mathrm{M,int}}$.\n  - Bidentate complex (two sites per arsenate): $2\\equiv \\mathrm{SOH} + \\mathrm{HAsO_4^{2-}} + 2\\mathrm{H}^+ \\rightleftharpoons (\\equiv \\mathrm{S})_2\\mathrm{-AsO_4H}^0$ with $K_{\\mathrm{B,int}}$.\n- Single-plane constant capacitance approximation:\n  - Define the dimensionless potential $\\varphi = \\dfrac{F \\psi_0}{R T}$, where $\\psi_0$ is the $0$-plane potential.\n  - The $0$-plane charge density $\\sigma_0$ in $\\mathrm{C\\ m^{-2}}$ satisfies $\\sigma_0 = C_\\mathrm{cap}\\, \\psi_0$.\n  - The $0$-plane structural charge (in units of elementary charge per adsorbed complex) is assigned as $+1$ for $\\equiv \\mathrm{SOH}_2^+$, $0$ for $\\equiv \\mathrm{SOH}$, $-1$ for $\\equiv \\mathrm{SO}^-$, $-1$ for $\\equiv \\mathrm{S{-}AsO_4H}^-$, and $0$ for $(\\equiv \\mathrm{S})_2\\mathrm{-AsO_4H}^0$.\n  - The conversion from per-volume amounts to charge density uses $\\sigma_0 = \\dfrac{F}{A_\\mathrm{s}}\\left(\\Gamma_{\\mathrm{SOH_2^+}} - \\Gamma_{\\mathrm{SO^-}} - \\Gamma_{\\mathrm{S{-}AsO_4H^-}}\\right)$, where $\\Gamma_i$ are concentrations in $\\mathrm{mol\\ L^{-1}}$.\n\nElectrostatic correction to conditional equilibrium constants (Boltzmann factor):\n- For a reaction consuming or producing ions at the $0$-plane, the conditional equilibrium constant is $K_\\mathrm{cond} = K_\\mathrm{int}\\, \\exp\\!\\left(-\\sum_j z_j \\varphi \\right)$, where $z_j$ are the charges of the solution ions entering the $0$-plane stoichiometry. For the defined reactions, this yields:\n  - Protonation: $K_{\\mathrm{a,cond}} = K_{\\mathrm{a,int}} \\exp(-\\varphi)$.\n  - Deprotonation: $K_{\\mathrm{b,cond}} = K_{\\mathrm{b,int}} \\exp(+\\varphi)$.\n  - Monodentate adsorption: $K_{\\mathrm{M,cond}} = K_{\\mathrm{M,int}} \\exp(+\\varphi)$.\n  - Bidentate adsorption: $K_{\\mathrm{B,cond}} = K_{\\mathrm{B,int}}$.\n\nAqueous arsenate speciation:\n- Arsenic acid dissociation constants at temperature $T$ are $K_1$, $K_2$, $K_3$ for $\\mathrm{H_3AsO_4} \\rightleftharpoons \\mathrm{H_2AsO_4^-} + \\mathrm{H}^+$, $\\mathrm{H_2AsO_4^-} \\rightleftharpoons \\mathrm{HAsO_4^{2-}} + \\mathrm{H}^+$, and $\\mathrm{HAsO_4^{2-}} \\rightleftharpoons \\mathrm{AsO_4^{3-}} + \\mathrm{H}^+$, respectively. For a given $[\\mathrm{H}^+] = h$, the fraction of total dissolved arsenate present as $\\mathrm{HAsO_4^{2-}}$ is $f_2 = \\dfrac{K_1 K_2 h}{h^3 + K_1 h^2 + K_1 K_2 h + K_1 K_2 K_3}$.\n\nSurface mass-action relations and balances at fixed $\\varphi$:\n- Let $\\Gamma_{\\mathrm{SOH}}$ denote the concentration of uncomplexed $\\equiv \\mathrm{SOH}$ sites, and define $\\Gamma_{\\mathrm{SOH_2^+}} = K_{\\mathrm{a,cond}}\\, [\\mathrm{H}^+]\\, \\Gamma_{\\mathrm{SOH}}$, $\\Gamma_{\\mathrm{SO^-}} = \\dfrac{K_{\\mathrm{b,cond}}}{[\\mathrm{H}^+]}\\, \\Gamma_{\\mathrm{SOH}}$.\n- Monodentate case:\n  - Let $\\Gamma_{\\mathrm{M}} = K_{\\mathrm{M,cond}}\\, [\\mathrm{H}^+]\\, [\\mathrm{HAsO_4^{2-}}]\\, \\Gamma_{\\mathrm{SOH}}$ denote the monodentate complex concentration.\n  - Site balance: $N_\\mathrm{s} = \\Gamma_{\\mathrm{SOH}} + \\Gamma_{\\mathrm{SOH_2^+}} + \\Gamma_{\\mathrm{SO^-}} + \\Gamma_{\\mathrm{M}}$.\n  - Arsenate mass balance and speciation: $[\\mathrm{HAsO_4^{2-}}] = f_2 \\left(C_\\mathrm{As} - \\Gamma_{\\mathrm{M}}\\right)$, which simplifies to $[\\mathrm{HAsO_4^{2-}}] = \\dfrac{f_2 C_\\mathrm{As}}{1 + f_2 K_{\\mathrm{M,cond}} [\\mathrm{H}^+]\\, \\Gamma_{\\mathrm{SOH}}}$.\n- Bidentate case:\n  - Let $\\Gamma_{\\mathrm{B}} = K_{\\mathrm{B,cond}}\\, [\\mathrm{H}^+]^2\\, [\\mathrm{HAsO_4^{2-}}]\\, \\Gamma_{\\mathrm{SOH}}^2$ denote the bidentate complex concentration.\n  - Site balance: $N_\\mathrm{s} = \\Gamma_{\\mathrm{SOH}} + \\Gamma_{\\mathrm{SOH_2^+}} + \\Gamma_{\\mathrm{SO^-}} + 2\\, \\Gamma_{\\mathrm{B}}$.\n  - Arsenate mass balance and speciation: $[\\mathrm{HAsO_4^{2-}}] = f_2 \\left(C_\\mathrm{As} - \\Gamma_{\\mathrm{B}}\\right)$, which simplifies to $[\\mathrm{HAsO_4^{2-}}] = \\dfrac{f_2 C_\\mathrm{As}}{1 + f_2 K_{\\mathrm{B,cond}} [\\mathrm{H}^+]^2\\, \\Gamma_{\\mathrm{SOH}}^2}$.\n\nElectrostatic self-consistency:\n- The dimensionless potential must satisfy $\\varphi = \\dfrac{F}{R T} \\dfrac{\\sigma_0}{C_\\mathrm{cap}}$ with $\\sigma_0 = \\dfrac{F}{A_\\mathrm{s}} \\left(\\Gamma_{\\mathrm{SOH_2^+}} - \\Gamma_{\\mathrm{SO^-}} - \\Gamma_{\\mathrm{M}}\\right)$ in the monodentate case and $\\sigma_0 = \\dfrac{F}{A_\\mathrm{s}} \\left(\\Gamma_{\\mathrm{SOH_2^+}} - \\Gamma_{\\mathrm{SO^-}}\\right)$ in the bidentate case. This requires an iterative solution because $\\varphi$ appears on both sides via the conditional equilibrium constants.\n\nObjective:\n- For each specified parameter set, compute the change in predicted adsorption capacity $\\Delta \\Gamma = \\Gamma_{\\mathrm{B}} - \\Gamma_{\\mathrm{M}}$ in $\\mathrm{mol\\ L^{-1}}$ when switching from monodentate to bidentate arsenate adsorption at fixed $N_\\mathrm{s}$ and $\\mathrm{pH}$.\n\nNumerical constants to use:\n- $F = 96485.33212\\ \\mathrm{C\\ mol^{-1}}$, $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$.\n- Surface acid-base intrinsic constants: $K_{\\mathrm{a,int}} = 10^{7.0}$, $K_{\\mathrm{b,int}} = 10^{-8.0}$.\n- Adsorption intrinsic constants: $K_{\\mathrm{M,int}} = 10^{9.0}$, $K_{\\mathrm{B,int}} = 10^{16.0}$.\n- Arsenic acid dissociation constants: $K_1 = 10^{-2.25}$, $K_2 = 10^{-6.98}$, $K_3 = 10^{-11.50}$.\n\nAlgorithmic task:\n- Implement an iterative solver for each adsorption mode (monodentate or bidentate):\n  1. Initialize $\\varphi$.\n  2. At fixed $\\varphi$, solve the site balance nonlinearity for $\\Gamma_{\\mathrm{SOH}}$ using a robust scalar root-finding method, employing the closed-form expressions for $[\\mathrm{HAsO_4^{2-}}]$ given above.\n  3. Update $\\Gamma_{\\mathrm{SOH_2^+}}$, $\\Gamma_{\\mathrm{SO^-}}$, $\\Gamma_{\\mathrm{M}}$ or $\\Gamma_{\\mathrm{B}}$, compute $\\sigma_0$, and update $\\varphi$ via the capacitance relation. Iterate to convergence.\n  4. Return $\\Gamma_{\\mathrm{M}}$ or $\\Gamma_{\\mathrm{B}}$ as the adsorption capacity in $\\mathrm{mol\\ L^{-1}}$.\n- Compute $\\Delta \\Gamma$ for each test case as $\\Gamma_{\\mathrm{B}} - \\Gamma_{\\mathrm{M}}$.\n\nPhysical units:\n- Express $\\Delta \\Gamma$ in $\\mathrm{mol\\ L^{-1}}$ as decimal floats.\n\nTest suite:\n- Use the following four parameter sets, covering typical, saturation, dilute, and high-pH edge conditions:\n  1. $\\mathrm{pH} = 7.5$, $N_\\mathrm{s} = 3.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $C_\\mathrm{As} = 1.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $A_\\mathrm{s} = 100.0\\ \\mathrm{m^2\\ L^{-1}}$, $C_\\mathrm{cap} = 1.0\\ \\mathrm{F\\ m^{-2}}$, $T = 298.15\\ \\mathrm{K}$.\n  2. $\\mathrm{pH} = 7.0$, $N_\\mathrm{s} = 1.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $C_\\mathrm{As} = 5.0\\times 10^{-3}\\ \\mathrm{mol\\ L^{-1}}$, $A_\\mathrm{s} = 200.0\\ \\mathrm{m^2\\ L^{-1}}$, $C_\\mathrm{cap} = 1.5\\ \\mathrm{F\\ m^{-2}}$, $T = 298.15\\ \\mathrm{K}$.\n  3. $\\mathrm{pH} = 6.0$, $N_\\mathrm{s} = 2.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $C_\\mathrm{As} = 1.0\\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$, $A_\\mathrm{s} = 50.0\\ \\mathrm{m^2\\ L^{-1}}$, $C_\\mathrm{cap} = 0.8\\ \\mathrm{F\\ m^{-2}}$, $T = 298.15\\ \\mathrm{K}$.\n  4. $\\mathrm{pH} = 9.0$, $N_\\mathrm{s} = 3.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $C_\\mathrm{As} = 1.0\\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$, $A_\\mathrm{s} = 150.0\\ \\mathrm{m^2\\ L^{-1}}$, $C_\\mathrm{cap} = 1.0\\ \\mathrm{F\\ m^{-2}}$, $T = 298.15\\ \\mathrm{K}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4]$), where each entry is $\\Delta \\Gamma$ for the corresponding test case in $\\mathrm{mol\\ L^{-1}}$, represented as a decimal float.",
            "solution": "The problem requires finding the equilibrium state of a mineral-water interface for two different arsenate adsorption hypotheses (monodentate vs. bidentate complexation) and comparing the resulting amount of adsorbed arsenate. The equilibrium state is described by the concentrations of various surface species (e.g., $\\equiv\\mathrm{SOH}$, $\\equiv\\mathrm{SOH}_2^+$, adsorbed arsenate) and the electrostatic potential at the surface, $\\psi_0$. These quantities are coupled through the law of mass action, mass balance equations, and an electrostatic model. The solution requires finding a set of values that simultaneously satisfy all these constraints. This is a self-consistency problem.\n\nThe algorithmic approach is a nested iterative solver.\n1. For each of the four test cases, the equilibrium amount of adsorbed arsenate is calculated independently for the monodentate ($\\Gamma_\\mathrm{M}$) and bidentate ($\\Gamma_\\mathrm{B}$) models.\n2. The difference, $\\Delta\\Gamma = \\Gamma_\\mathrm{B} - \\Gamma_\\mathrm{M}$, is then computed.\n3. The final output is a list of these $\\Delta\\Gamma$ values.\n\nThe calculation for a single model is an iterative procedure to find the self-consistent dimensionless surface potential, $\\varphi = F\\psi_0 / (RT)$.\n\nThe procedure is as follows:\n1.  **Outer Loop (Solving for $\\varphi$)**: An initial guess is made for $\\varphi$ (e.g., $\\varphi = 0$). The loop then proceeds by repeatedly updating $\\varphi$ until it converges.\n    a.  **Calculate Conditional Constants**: For the current value of $\\varphi$, the intrinsic equilibrium constants ($K_\\mathrm{int}$) are corrected for electrostatic effects to yield conditional constants ($K_\\mathrm{cond}$), using the Boltzmann factor, e.g., $K_{\\mathrm{a,cond}} = K_{\\mathrm{a,int}} \\exp(-\\varphi)$.\n    b.  **Inner Step (Solving for Surface Speciation)**: With fixed conditional constants, the concentrations of all surface species must be determined. This is achieved by solving the site balance equation, which is a single non-linear equation for the concentration of free, neutral sites, $\\Gamma_{\\mathrm{SOH}}$.\n\n        For the **monodentate model**, the site balance equation is:\n        $$ N_\\mathrm{s} = \\Gamma_{\\mathrm{SOH}} + \\Gamma_{\\mathrm{SOH_2^+}} + \\Gamma_{\\mathrm{SO^-}} + \\Gamma_\\mathrm{M} $$\n        Substituting the mass-action expressions for each species yields a non-linear equation in $\\Gamma_{\\mathrm{SOH}}$. A similar, but different, equation is derived for the **bidentate model**, noting that each bidentate complex consumes two sites ($2\\Gamma_\\mathrm{B}$):\n        $$ N_\\mathrm{s} = \\Gamma_{\\mathrm{SOH}} + \\Gamma_{\\mathrm{SOH_2^+}} + \\Gamma_{\\mathrm{SO^-}} + 2\\Gamma_\\mathrm{B} $$\n        This single-variable non-linear equation is solved numerically using a robust root-finding algorithm within the physically meaningful interval $(0, N_\\mathrm{s}]$.\n\n    c.  **Update Surface Charge and Potential**: Once the equilibrium value of $\\Gamma_{\\mathrm{SOH}}$ is found, the concentrations of all other surface species are calculated. The total surface charge density, $\\sigma_0$, is then computed based on the assigned structural charges:\n        - Monodentate: $\\sigma_0 = \\frac{F}{A_\\mathrm{s}}\\left(\\Gamma_{\\mathrm{SOH_2^+}} - \\Gamma_{\\mathrm{SO^-}} - \\Gamma_\\mathrm{M}\\right)$\n        - Bidentate: $\\sigma_0 = \\frac{F}{A_\\mathrm{s}}\\left(\\Gamma_{\\mathrm{SOH_2^+}} - \\Gamma_{\\mathrm{SO^-}}\\right)$\n        A new value for the potential, $\\psi_{0,\\mathrm{new}} = \\sigma_0 / C_\\mathrm{cap}$, is calculated, giving a new dimensionless potential, $\\varphi_\\mathrm{new} = F \\psi_{0,\\mathrm{new}} / (RT)$.\n\n    d.  **Convergence Check**: The new $\\varphi_\\mathrm{new}$ is compared to the value from the previous iteration, $\\varphi_\\mathrm{old}$. If the difference is smaller than a predefined tolerance, the outer loop terminates. Otherwise, a new value for $\\varphi$ is set for the next iteration using a mixing scheme to ensure stable convergence: $\\varphi_\\mathrm{next} = \\alpha \\varphi_\\mathrm{new} + (1-\\alpha) \\varphi_\\mathrm{old}$.\n\n2.  **Final Calculation**: After the outer loop converges, the final calculated value of $\\Gamma_\\mathrm{M}$ or $\\Gamma_\\mathrm{B}$ is returned as the adsorption capacity for that model.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the CD-MUSIC model for the given test cases.\n    \"\"\"\n    # Numerical constants\n    F = 96485.33212  # C mol^-1\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Intrinsic equilibrium constants\n    K_a_int = 10**7.0\n    K_b_int = 10**-8.0\n    K_M_int = 10**9.0\n    K_B_int = 10**16.0\n\n    # Arsenic acid dissociation constants\n    K1 = 10**-2.25\n    K2 = 10**-6.98\n    K3 = 10**-11.50\n\n    # Test suite parameters\n    test_cases = [\n        # (pH, N_s, C_As, A_s, C_cap, T)\n        (7.5, 3.0e-4, 1.0e-4, 100.0, 1.0, 298.15),\n        (7.0, 1.0e-4, 5.0e-3, 200.0, 1.5, 298.15),\n        (6.0, 2.0e-4, 1.0e-7, 50.0, 0.8, 298.15),\n        (9.0, 3.0e-4, 1.0e-4, 150.0, 1.0, 298.15),\n    ]\n\n    def solve_for_mode(params, mode):\n        \"\"\"\n        Solves the CD-MUSIC model for a single adsorption mode (monodentate or bidentate).\n        This function contains the self-consistent iteration for the surface potential phi.\n        \"\"\"\n        pH, N_s, C_As, A_s, C_cap, T = params\n        h = 10**(-pH)\n\n        # Calculate the fraction of HAsO4^2-\n        f2_num = K1 * K2 * h\n        f2_den = h**3 + K1 * h**2 + K1 * K2 * h + K1 * K2 * K3\n        f2 = f2_num / f2_den\n\n        phi = 0.0  # Initial guess for dimensionless potential\n        alpha = 0.25  # Mixing parameter for stable convergence\n        max_iter = 200\n        tolerance = 1e-9\n\n        for _ in range(max_iter):\n            phi_old = phi\n\n            # Calculate conditional equilibrium constants\n            K_a_cond = K_a_int * np.exp(-phi)\n            K_b_cond = K_b_int * np.exp(phi)\n\n            gamma_soh_sol = 0.0\n            adsorbed_amount = 0.0\n            \n            if mode == 'monodentate':\n                K_M_cond = K_M_int * np.exp(phi)\n\n                # Root function for the site balance equation\n                def root_func_M(gamma_soh):\n                    if gamma_soh = 0: return -N_s\n                    # Protonation/deprotonation terms\n                    gamma_soh2_plus = K_a_cond * h * gamma_soh\n                    gamma_so_minus = (K_b_cond / h) * gamma_soh\n                    # Adsorption term\n                    adsorption_denom_term = f2 * K_M_cond * h * gamma_soh\n                    gamma_m = (adsorption_denom_term * C_As) / (1.0 + adsorption_denom_term)\n                    return gamma_soh + gamma_soh2_plus + gamma_so_minus + gamma_m - N_s\n\n                # Solve for Gamma_SOH using a robust root-finder\n                gamma_soh_sol = brentq(root_func_M, 1e-20, N_s)\n\n                # Recalculate all species concentrations with the converged Gamma_SOH\n                gamma_soh2_plus = K_a_cond * h * gamma_soh_sol\n                gamma_so_minus = (K_b_cond / h) * gamma_soh_sol\n                adsorption_denom_term = f2 * K_M_cond * h * gamma_soh_sol\n                gamma_m_sol = (adsorption_denom_term * C_As) / (1.0 + adsorption_denom_term)\n                adsorbed_amount = gamma_m_sol\n\n                # Update potential\n                sigma0 = (F / A_s) * (gamma_soh2_plus - gamma_so_minus - gamma_m_sol)\n                psi0_new = sigma0 / C_cap\n                phi_new = (F * psi0_new) / (R * T)\n\n            elif mode == 'bidentate':\n                K_B_cond = K_B_int  # Electrostatic term is exp(0) = 1\n\n                # Root function for the site balance equation\n                def root_func_B(gamma_soh):\n                    if gamma_soh = 0: return -N_s\n                    # Protonation/deprotonation terms\n                    gamma_soh2_plus = K_a_cond * h * gamma_soh\n                    gamma_so_minus = (K_b_cond / h) * gamma_soh\n                    # Adsorption term\n                    adsorption_denom_term = f2 * K_B_cond * (h**2) * (gamma_soh**2)\n                    gamma_b = (adsorption_denom_term * C_As) / (1.0 + adsorption_denom_term)\n                    return gamma_soh + gamma_soh2_plus + gamma_so_minus + 2.0 * gamma_b - N_s\n                \n                # Solve for Gamma_SOH\n                gamma_soh_sol = brentq(root_func_B, 1e-20, N_s)\n\n                # Recalculate species\n                gamma_soh2_plus = K_a_cond * h * gamma_soh_sol\n                gamma_so_minus = (K_b_cond / h) * gamma_soh_sol\n                adsorption_denom_term = f2 * K_B_cond * (h**2) * (gamma_soh_sol**2)\n                gamma_b_sol = (adsorption_denom_term * C_As) / (1.0 + adsorption_denom_term)\n                adsorbed_amount = gamma_b_sol\n\n                # Update potential\n                sigma0 = (F / A_s) * (gamma_soh2_plus - gamma_so_minus)\n                psi0_new = sigma0 / C_cap\n                phi_new = (F * psi0_new) / (R * T)\n            \n            # Mix potential for next iteration and check convergence\n            phi = alpha * phi_new + (1.0 - alpha) * phi_old\n            if abs(phi - phi_old)  tolerance:\n                break\n        \n        return adsorbed_amount\n\n    results = []\n    for params in test_cases:\n        gamma_M = solve_for_mode(params, 'monodentate')\n        gamma_B = solve_for_mode(params, 'bidentate')\n        delta_gamma = gamma_B - gamma_M\n        results.append(f\"{delta_gamma:.8g}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}