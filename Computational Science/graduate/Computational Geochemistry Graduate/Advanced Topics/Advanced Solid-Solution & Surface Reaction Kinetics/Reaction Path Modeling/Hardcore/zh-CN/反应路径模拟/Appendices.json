{
    "hands_on_practices": [
        {
            "introduction": "反应路径模拟的核心在于预测系统将经历的化学反应序列。本练习将带领我们深入理解主导这一序列的热力学原理，通过构建一个氧化还原阶梯来确定能量上最有利的反应。这使我们能够预测随着电子受体的消耗系统将如何演化，这是模拟生物地球化学过程的一个基础技能。",
            "id": "4097802",
            "problem": "一个体积为 $1.000\\ \\mathrm{L}$、温度为 $25^{\\circ}\\ \\mathrm{C}$ 且 $\\mathrm{pH}=7.00$ 恒定的封闭等温水相体系，初始时混合均匀并经过缓冲，使得 $a_{\\mathrm{H}^{+}}=10^{-7}$ 且所有溶解物种的活度系数近似为1。考虑由 $\\mathrm{CH_{2}O}$ 代表的通用有机碳的不可逆氧化，该过程沿着热力学控制的反应路径进行，在任何时刻，具有最高有效还原电位（在当前活度下）的电子受体被利用，直至耗尽。该体系初始包含以下总量的物质（除非另有说明，均为溶解的水相物种）：溶解的分子氧 $\\mathrm{O_{2}(aq)}$，$n_{\\mathrm{O_{2}}}=2.80\\times 10^{-4}\\ \\mathrm{mol}$；硝酸根 $\\mathrm{NO_{3}^{-}}$，$n_{\\mathrm{NO_{3}^{-}}}=1.56\\times 10^{-3}\\ \\mathrm{mol}$；以及硫酸根 $\\mathrm{SO_{4}^{2-}}$，$n_{\\mathrm{SO_{4}^{2-}}}=1.00\\times 10^{-2}\\ \\mathrm{mol}$。假设氮气 $\\mathrm{N_{2}}$ 的逸度 $f_{\\mathrm{N_{2}}}=1.00$，还原的硫产物为硫氢根离子 $\\mathrm{HS^{-}}$，其初始活度可忽略不计。水的活度为 $a_{\\mathrm{H_{2}O}}=1$。\n\n从基本的氧化还原半反应定义和能斯特方程出发，构建在 $\\mathrm{pH}=7.00$ 和所述条件下，三个电子接受对 $\\mathrm{O_{2}/H_{2}O}$、$\\mathrm{NO_{3}^{-}/N_{2}}$ 和 $\\mathrm{SO_{4}^{2-}/HS^{-}}$ 的热力学氧化还原梯，并确定它们在热力学控制下氧化 $\\mathrm{CH_{2}O}$ 过程中被利用的顺序。然后，利用平衡半反应推导出的电子等效化学计量关系，确定当硫酸盐还原首次成为主导电子接受步骤时（即，在所有先前的、更高电位的受体都已耗尽但硫酸盐还未发生可测量消耗的瞬间），被氧化的 $\\mathrm{CH_{2}O}$ 的累积量（以毫摩尔为单位）。最终答案以毫摩尔表示，并四舍五入至三位有效数字。",
            "solution": "这个问题需要分两部分来解答。首先，我们必须在指定条件下为给定的电子受体构建热力学氧化还原梯，以确定它们的利用顺序。其次，我们必须计算直到硫酸盐还原开始时被氧化的有机物（以 $\\mathrm{CH_{2}O}$ 表示）的总量。这对应于所有比硫酸盐/硫氢根离子对具有更高还原电位的电子受体的完全消耗。\n\n该分析是在一个封闭的等温水相体系中进行的，温度 $T = 25^{\\circ}\\ \\mathrm{C}$ ($298.15\\ \\mathrm{K}$)，$\\mathrm{pH}$ 固定为 $7.00$，这意味着氢离子活度为 $a_{\\mathrm{H}^{+}} = 10^{-7}$。体系体积为 $V = 1.000\\ \\mathrm{L}$。活度系数假定为1，因此溶解物种 $i$ 的活度 $a_i$ 等于其摩尔浓度 $M_i$。鉴于体积为 $1.000\\ \\mathrm{L}$，活度的数值等于摩尔数。\n\n电子受体的初始活度为：\n$a_{\\mathrm{O_{2}}} = M_{\\mathrm{O_{2}}} = \\frac{2.80\\times 10^{-4}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 2.80\\times 10^{-4}$\n$a_{\\mathrm{NO_{3}^{-}}} = M_{\\mathrm{NO_{3}^{-}}} = \\frac{1.56\\times 10^{-3}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.56\\times 10^{-3}$\n$a_{\\mathrm{SO_{4}^{2-}}} = M_{\\mathrm{SO_{4}^{2-}}} = \\frac{1.00\\times 10^{-2}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.00\\times 10^{-2}$\n其他指定的活度为 $a_{\\mathrm{H_{2}O}} = 1$ 和氮气逸度 $f_{\\mathrm{N_{2}}} = 1.00$。\n\n第一部分：热力学氧化还原梯\n\n电子受体利用的顺序由每个氧化还原对在当前条件下的有效还原电位 $E_h$ 决定。具有最高 $E_h$ 的电对与有机物氧化耦合时能提供最多的能量，因此将首先被利用。我们使用能斯特方程计算 $E_h$：\n$$E_{h} = E^{0} - \\frac{RT}{nF} \\ln Q = E^{0} - \\frac{2.303RT}{nF} \\log_{10} Q$$\n其中 $E^0$ 是标准还原电位，$R$ 是理想气体常数 ($8.314\\ \\mathrm{J}\\cdot\\mathrm{mol}^{-1}\\cdot\\mathrm{K}^{-1}$)，$T$ 是绝对温度 ($298.15\\ \\mathrm{K}$)，$n$ 是半反应中转移的电子数，$F$ 是法拉第常数 ($96485\\ \\mathrm{C}\\cdot\\mathrm{mol}^{-1}$)，$Q$ 是反应商。在 $25^{\\circ}\\ \\mathrm{C}$ 时，$\\frac{2.303RT}{F}$ 项约为 $0.05916\\ \\mathrm{V}$。\n\n我们现在为三个电子接受对分别计算 $E_h$。\n\n1.  氧/水对 ($\\mathrm{O_{2}/H_{2}O}$):\n    还原半反应及其标准电位为：\n    $$\\mathrm{O_{2}}(aq) + 4\\mathrm{H}^{+} + 4e^{-} \\rightarrow 2\\mathrm{H_{2}O}$$\n    其中 $E^0 = +1.229\\ \\mathrm{V}$。转移的电子数为 $n=4$。\n    反应商为 $Q = \\frac{(a_{\\mathrm{H_2O}})^2}{(a_{\\mathrm{O_2}})(a_{\\mathrm{H^+}})^4}$。\n    使用给定的活度：\n    $Q = \\frac{1^2}{(2.80 \\times 10^{-4})(10^{-7})^4} = \\frac{1}{2.80 \\times 10^{-32}} \\approx 3.571 \\times 10^{31}$。\n    还原电位为：\n    $E_{h, \\mathrm{O_2}} = 1.229\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{4} \\log_{10}(3.571 \\times 10^{31})$\n    $E_{h, \\mathrm{O_2}} = 1.229 - 0.01479 \\times (31.553) = 1.229 - 0.467 = +0.762\\ \\mathrm{V}$。\n\n2.  硝酸根/氮气对 ($\\mathrm{NO_{3}^{-}/N_{2}}$):\n    还原半反应及其标准电位为：\n    $$2\\mathrm{NO_{3}^{-}} + 12\\mathrm{H}^{+} + 10e^{-} \\rightarrow \\mathrm{N_{2}}(g) + 6\\mathrm{H_{2}O}$$\n    其中 $E^0 = +1.246\\ \\mathrm{V}$。转移的电子数为 $n=10$。\n    反应商为 $Q = \\frac{f_{\\mathrm{N_2}}(a_{\\mathrm{H_2O}})^6}{(a_{\\mathrm{NO_3^-}})^2(a_{\\mathrm{H^+}})^{12}}$。\n    使用给定的活度/逸度：\n    $Q = \\frac{1.00 \\times 1^6}{(1.56 \\times 10^{-3})^2 (10^{-7})^{12}} = \\frac{1}{(2.4336 \\times 10^{-6})(10^{-84})} = \\frac{1}{2.4336 \\times 10^{-90}} \\approx 4.109 \\times 10^{89}$。\n    还原电位为：\n    $E_{h, \\mathrm{NO_3^-}} = 1.246\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{10} \\log_{10}(4.109 \\times 10^{89})$\n    $E_{h, \\mathrm{NO_3^-}} = 1.246 - 0.005916 \\times (89.614) = 1.246 - 0.530 = +0.716\\ \\mathrm{V}$。\n\n3.  硫酸根/硫氢根离子对 ($\\mathrm{SO_{4}^{2-}/HS^{-}}$):\n    还原半反应及其标准电位为：\n    $$\\mathrm{SO_{4}^{2-}} + 9\\mathrm{H}^{+} + 8e^{-} \\rightarrow \\mathrm{HS^{-}} + 4\\mathrm{H_{2}O}$$\n    其中 $E^0 = +0.303\\ \\mathrm{V}$。转移的电子数为 $n=8$。\n    题目说明还原产物 $\\mathrm{HS^{-}}$ 的初始活度可忽略不计。为了计算一个有限的电位，必须假定一个非零活度。我们将采用地球化学模型中的一个常用约定，假设一个阈值活度 $a_{\\mathrm{HS^{-}}} = 10^{-6}$，此时该过程被认为是活跃的。\n    反应商为 $Q = \\frac{a_{\\mathrm{HS^-}}(a_{\\mathrm{H_2O}})^4}{a_{\\mathrm{SO_4^{2-}}}(a_{\\mathrm{H^+}})^9}$。\n    使用给定的活度和我们的假设：\n    $Q = \\frac{10^{-6} \\times 1^4}{(1.00 \\times 10^{-2})(10^{-7})^9} = \\frac{10^{-6}}{10^{-2} \\times 10^{-63}} = \\frac{10^{-6}}{10^{-65}} = 10^{59}$。\n    还原电位为：\n    $E_{h, \\mathrm{SO_4^{2-}}} = 0.303\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{8} \\log_{10}(10^{59})$\n    $E_{h, \\mathrm{SO_4^{2-}}} = 0.303 - 0.007395 \\times 59 = 0.303 - 0.436 = -0.133\\ \\mathrm{V}$。\n\n比较计算出的电位：\n$E_{h, \\mathrm{O_2}} = +0.762\\ \\mathrm{V}$\n$E_{h, \\mathrm{NO_3^-}} = +0.716\\ \\mathrm{V}$\n$E_{h, \\mathrm{SO_4^{2-}}} = -0.133\\ \\mathrm{V}$\n\n由于 $E_{h, \\mathrm{O_2}}  E_{h, \\mathrm{NO_3^-}}  E_{h, \\mathrm{SO_4^{2-}}}$，在氧化 $\\mathrm{CH_2O}$ 过程中，电子受体利用的热力学顺序是：\n1.  好氧呼吸（$\\mathrm{O_2}$ 消耗）\n2.  反硝化作用（$\\mathrm{NO_3^-}$ 消耗）\n3.  硫酸盐还原（$\\mathrm{SO_4^{2-}}$ 消耗）\n\n第二部分：计算被氧化的 $\\mathrm{CH_2O}$\n\n我们需要计算当硫酸盐还原首次成为主导过程时被氧化的 $\\mathrm{CH_{2}O}$ 的总量。这发生在所有更高电位的受体 $\\mathrm{O_2}$ 和 $\\mathrm{NO_3^-}$ 被完全消耗时。我们可以通过平衡 $\\mathrm{CH_{2}O}$ 氧化释放的总电子数与 $\\mathrm{O_2}$ 和 $\\mathrm{NO_3^-}$ 接受的总电子数来解决这个问题。\n\n首先，$\\mathrm{CH_{2}O}$（其中碳的氧化态为0）氧化为碳的氧化态为+4的产物（例如 $\\mathrm{CO_{2}}$ 或 $\\mathrm{HCO_3^-}$）的氧化半反应释放4个电子：\n$$\\mathrm{CH_{2}O} + \\mathrm{H_{2}O} \\rightarrow \\mathrm{CO_{2}} + 4\\mathrm{H}^{+} + 4e^{-}$$\n因此，1摩尔 $\\mathrm{CH_{2}O}$ 的氧化释放4摩尔电子。\n\n接下来，我们计算可用的 $\\mathrm{O_2}$ 和 $\\mathrm{NO_3^-}$ 的总电子接受能力。\n\n-   $\\mathrm{O_2}$ 接受的电子：\n    半反应 $\\mathrm{O_{2}} + 4\\mathrm{H}^{+} + 4e^{-} \\rightarrow 2\\mathrm{H_{2}O}$ 表明，1摩尔 $\\mathrm{O_2}$ 接受4摩尔电子。\n    来自 $\\mathrm{O_2}$ 的总电子数：\n    $n_{e^-, \\mathrm{O_2}} = n_{\\mathrm{O_{2}}} \\times 4 = (2.80 \\times 10^{-4}\\ \\mathrm{mol}) \\times 4 = 1.12 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\n-   $\\mathrm{NO_3^-}$ 接受的电子：\n    反硝化为 $\\mathrm{N_2}$ 的半反应是 $2\\mathrm{NO_{3}^{-}} + 12\\mathrm{H}^{+} + 10e^{-} \\rightarrow \\mathrm{N_{2}} + 6\\mathrm{H_{2}O}$。这表明2摩尔 $\\mathrm{NO_3^-}$ 接受10摩尔电子，或者说1摩尔 $\\mathrm{NO_3^-}$ 接受5摩尔电子。\n    来自 $\\mathrm{NO_3^-}$ 的总电子数：\n    $n_{e^-, \\mathrm{NO_3^-}} = n_{\\mathrm{NO_{3}^{-}}} \\times 5 = (1.56 \\times 10^{-3}\\ \\mathrm{mol}) \\times 5 = 7.80 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\n在硫酸盐还原开始前接受的总电子摩尔数是上述两者的总和：\n$n_{e^-, \\text{total}} = n_{e^-, \\mathrm{O_2}} + n_{e^-, \\mathrm{NO_3^-}} = 1.12 \\times 10^{-3} + 7.80 \\times 10^{-3} = 8.92 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\n这个总数必须等于 $\\mathrm{CH_{2}O}$ 氧化释放的电子摩尔数。\n$n_{e^-, \\text{total}} = n_{\\mathrm{CH_2O}} \\times 4$.\n因此，被氧化的 $\\mathrm{CH_{2}O}$ 的总摩尔数为：\n$n_{\\mathrm{CH_2O}} = \\frac{n_{e^-, \\text{total}}}{4} = \\frac{8.92 \\times 10^{-3}\\ \\mathrm{mol}}{4} = 2.23 \\times 10^{-3}\\ \\mathrm{mol}$.\n\n问题要求答案以毫摩尔为单位，并四舍五入到三位有效数字。\n$1\\ \\mathrm{mmol} = 10^{-3}\\ \\mathrm{mol}$.\n$n_{\\mathrm{CH_2O}} = 2.23\\ \\mathrm{mmol}$.\n这个值已经表示为三位有效数字。",
            "answer": "$$\\boxed{2.23}$$"
        },
        {
            "introduction": "虽然热力学预测了反应发生的*可能性*，但准确的计算依赖于溶解物质的活度，而活度的确定充满了不确定性。本练习旨在探索一个关键问题：活度系数的误差如何传递到我们的预测中，例如矿物的饱和状态。通过解析地推导饱和度指数（$SI$）的敏感性，您将揭示一个既简单又深刻的普适关系——反应化学计量直接决定了模型对活度误差的敏感度。",
            "id": "4097862",
            "problem": "在计算地球化学的反应路径模拟步骤中，您希望量化活度系数的不确定性如何传播到用于计算饱和状态的矿物反应的饱和指数（SI）中。考虑用以下水溶液主物种表示的白云石溶解反应：\n$$\n\\mathrm{CaMg(CO_{3})_{2}(s)} + 2\\,\\mathrm{H^{+}} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{Mg^{2+}} + 2\\,\\mathrm{HCO_{3}^{-}} .\n$$\n按照惯例，该反应的饱和指数（SI）根据基本质量作用和活度框架定义为\n$$\n\\mathrm{SI} \\equiv \\log_{10}\\!\\left(\\frac{\\mathrm{IAP}}{K}\\right),\n$$\n其中 $K$ 是在所研究温度下该反应的热力学平衡常数，而离子活度积（IAP）为各水溶液物种活度的化学计量系数次幂的乘积，规定反应物的系数为负，生成物的系数为正。对于任何水溶液物种 $i$，其活度定义为 $a_{i} = \\gamma_{i}\\,m_{i}$，其中 $m_{i}$ 是质量摩尔浓度，$\\gamma_{i}$ 是活度系数。\n\n仅从这些定义和化学热力学基本定律出发，通过对上述反应中参与的溶解物种求 $\\mathrm{SI}$ 关于 $\\ln \\gamma_{i}$ 的导数，来推导 $\\mathrm{SI}$ 对活度系数中无穷小乘法误差的灵敏度。然后，计算并报告向量\n$$\n\\left(\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{Ca^{2+}}}},\\;\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{Mg^{2+}}}},\\;\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{HCO_{3}^{-}}}},\\;\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{H^{+}}}}\\right)\n$$\n的精确解析表达式，并按所示顺序列出各项。在求这些偏导数时，将 $K$ 和所有质量摩尔浓度 $m_{i}$ 视为相对于 $\\ln \\gamma_{i}$ 的常数。最终答案请以无数值近似且无单位的方式表示。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是合理的。它有科学依据、适定、客观且自洽，是地球化学灵敏度分析中的一个标准问题。\n\n目标是计算饱和指数 $\\mathrm{SI}$ 对反应中涉及的每个水溶液物种 $i$ 的活度系数的自然对数 $\\ln \\gamma_{i}$ 的偏导数向量。\n\n白云石的溶解反应如下：\n$$\n\\mathrm{CaMg(CO_{3})_{2}(s)} + 2\\,\\mathrm{H^{+}} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{Mg^{2+}} + 2\\,\\mathrm{HCO_{3}^{-}}\n$$\n从这个反应中，我们可以确定每个水溶液物种的化学计量系数 $\\nu_i$。按照惯例，生成物的系数为正，反应物的系数为负。\n我们关心的物种是 $\\mathrm{Ca^{2+}}$、$\\mathrm{Mg^{2+}}$、$\\mathrm{HCO_{3}^{-}}$ 和 $\\mathrm{H^{+}}$。它们各自的化学计量系数是：\n$$\n\\nu_{\\mathrm{Ca^{2+}}} = +1 \\\\\n\\nu_{\\mathrm{Mg^{2+}}} = +1 \\\\\n\\nu_{\\mathrm{HCO_{3}^{-}}} = +2 \\\\\n\\nu_{\\mathrm{H^{+}}} = -2\n$$\n按照惯例，在稀溶液中，纯固体 $\\mathrm{CaMg(CO_{3})_{2}(s)}$ 的活度取为1，且不出现在离子活度积（IAP）的表达式中。\n\n饱和指数 $\\mathrm{SI}$ 定义为：\n$$\n\\mathrm{SI} \\equiv \\log_{10}\\!\\left(\\frac{\\mathrm{IAP}}{K}\\right)\n$$\n其中 $K$ 是平衡常数。为了便于求导，我们使用换底公式 $\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}$ 将以10为底的对数转换为自然对数：\n$$\n\\mathrm{SI} = \\frac{1}{\\ln(10)} \\left( \\ln(\\mathrm{IAP}) - \\ln(K) \\right)\n$$\n离子活度积（IAP）定义为各水溶液物种活度的化学计量系数次幂的乘积：\n$$\n\\mathrm{IAP} = \\prod_{i} a_{i}^{\\nu_i} = \\frac{a_{\\mathrm{Ca^{2+}}}^{\\nu_{\\mathrm{Ca^{2+}}}} a_{\\mathrm{Mg^{2+}}}^{\\nu_{\\mathrm{Mg^{2+}}}} a_{\\mathrm{HCO_{3}^{-}}}^{\\nu_{\\mathrm{HCO_{3}^{-}}}}}{a_{\\mathrm{H^{+}}}^{-\\nu_{\\mathrm{H^{+}}}}} = \\frac{a_{\\mathrm{Ca^{2+}}}^{1} a_{\\mathrm{Mg^{2+}}}^{1} a_{\\mathrm{HCO_{3}^{-}}}^{2}}{a_{\\mathrm{H^{+}}}^{2}}\n$$\nIAP的自然对数是：\n$$\n\\ln(\\mathrm{IAP}) = \\ln\\left( \\prod_{i} a_{i}^{\\nu_i} \\right) = \\sum_{i} \\nu_i \\ln(a_i)\n$$\n代入白云石反应的化学计量系数：\n$$\n\\ln(\\mathrm{IAP}) = (1)\\ln(a_{\\mathrm{Ca^{2+}}}) + (1)\\ln(a_{\\mathrm{Mg^{2+}}}) + (2)\\ln(a_{\\mathrm{HCO_{3}^{-}}}) + (-2)\\ln(a_{\\mathrm{H^{+}}})\n$$\n每个物种的活度 $a_i$ 由 $a_i = \\gamma_i m_i$ 给出，其中 $\\gamma_i$ 是活度系数，$m_i$ 是质量摩尔浓度。取自然对数得到 $\\ln(a_i) = \\ln(\\gamma_i) + \\ln(m_i)$。将此代入 $\\ln(\\mathrm{IAP})$ 的表达式中：\n$$\n\\ln(\\mathrm{IAP}) = \\sum_{i} \\nu_i (\\ln(\\gamma_i) + \\ln(m_i))\n$$\n现在，我们可以写出 $\\mathrm{SI}$ 的完整表达式：\n$$\n\\mathrm{SI} = \\frac{1}{\\ln(10)} \\left( \\left[ \\sum_{i} \\nu_i (\\ln(\\gamma_i) + \\ln(m_i)) \\right] - \\ln(K) \\right)\n$$\n题目要求我们求出 $\\mathrm{SI}$ 对特定物种 $j$ 的 $\\ln(\\gamma_j)$ 的偏导数，并将所有质量摩尔浓度 $m_i$ 和平衡常数 $K$ 视为常数。\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{j}} = \\frac{\\partial}{\\partial \\ln \\gamma_{j}} \\left[ \\frac{1}{\\ln(10)} \\left( \\left[ \\sum_{i} \\nu_i (\\ln(\\gamma_i) + \\ln(m_i)) \\right] - \\ln(K) \\right) \\right]\n$$\n涉及 $m_i$ 和 $K$ 的常数项的导数为零。求导算子可以移到求和符号内部：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{j}} = \\frac{1}{\\ln(10)} \\sum_{i} \\nu_i \\frac{\\partial \\ln(\\gamma_i)}{\\partial \\ln \\gamma_{j}}\n$$\n偏导数 $\\frac{\\partial \\ln(\\gamma_i)}{\\partial \\ln \\gamma_{j}}$ 等于克罗内克δ (Kronecker delta) $\\delta_{ij}$，当 $i=j$ 时为1，当 $i \\neq j$ 时为0。这是因为在求导过程中，活度系数的对数 $\\ln(\\gamma_i)$ 被视为独立变量。因此，求和式简化为只有 $i=j$ 的一项：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{j}} = \\frac{1}{\\ln(10)} \\sum_{i} \\nu_i \\delta_{ij} = \\frac{\\nu_j}{\\ln(10)}\n$$\n这个一般性结果表明，$\\mathrm{SI}$ 对物种 $j$ 活度系数的乘法变化的灵敏度，等于其化学计量系数除以10的自然对数。\n\n现在我们将此结果应用于指定的四个物种：\n1. 对于 $\\mathrm{Ca^{2+}}$，$j=\\mathrm{Ca^{2+}}$ 且 $\\nu_{\\mathrm{Ca^{2+}}} = 1$：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{Ca^{2+}}}} = \\frac{1}{\\ln(10)}\n$$\n2. 对于 $\\mathrm{Mg^{2+}}$，$j=\\mathrm{Mg^{2+}}$ 且 $\\nu_{\\mathrm{Mg^{2+}}} = 1$：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{Mg^{2+}}}} = \\frac{1}{\\ln(10)}\n$$\n3. 对于 $\\mathrm{HCO_{3}^{-}}$，$j=\\mathrm{HCO_{3}^{-}}$ 且 $\\nu_{\\mathrm{HCO_{3}^{-}}} = 2$：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{HCO_{3}^{-}}}} = \\frac{2}{\\ln(10)}\n$$\n4. 对于 $\\mathrm{H^{+}}$，$j=\\mathrm{H^{+}}$ 且 $\\nu_{\\mathrm{H^{+}}} = -2$：\n$$\n\\frac{\\partial\\,\\mathrm{SI}}{\\partial \\ln \\gamma_{\\mathrm{H^{+}}}} = \\frac{-2}{\\ln(10)}\n$$\n按指定顺序列出这些结果，即可构成所求的向量：\n$$\n\\left(\\frac{1}{\\ln(10)},\\; \\frac{1}{\\ln(10)},\\; \\frac{2}{\\ln(10)},\\; -\\frac{2}{\\ln(10)}\\right)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\ln(10)}  \\frac{1}{\\ln(10)}  \\frac{2}{\\ln(10)}  -\\frac{2}{\\ln(10)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "超越平衡的范畴，一个完整的反应路径模型必须考虑动力学，即反应发生的速率。这个高级练习将引导您完成为矿物溶解建立动力学模型的完整工作流程，这是现代计算地球化学的一项核心任务。您将构建一个多机理速率定律，生成模拟的“实验”数据，并使用非线性回归来校准模型参数，从而掌握连接理论速率定律与实际数据分析的关键技术。",
            "id": "4097811",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，该程序在计算地球化学的反应路径模拟框架内，为长石溶解构建并标定一个多机理速率定律。您的程序必须以科学上严谨的方式执行以下任务，从有效的基础定义和定律出发，并以指定的格式产生单行输出。\n\n您必须使用的基本依据如下：\n- 溶解过程通过并行的基元路径进行，其各自的速率是可加的。在并行机理下，宏观速率是各机理特定速率的总和，因为每个路径都独立地对总通量做出贡献。\n- 氢离子的活度由其活度的负常用对数定义：$\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$，其中 $a_{\\mathrm{H}^+}$ 是无量纲的。\n- 在温度为 $25\\,^\\circ\\mathrm{C}$ 时，水的自偶电离平衡由平衡常数 $K_w$ 描述，以活度计算时 $K_w = 10^{-14}$，满足 $a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-} = K_w$。\n- 单位几何面积的总溶解速率将以 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 计算，而基于活度的指数是无量纲的。根据定义，活度是无单位的。\n\n使用这些基础，为长石溶解构建一个速率定律，该定律包含两个并行机理，依赖于水合氢离子和氢氧根离子活度的酸催化和碱催化。您的推导应得出一个依赖于 $a_{\\mathrm{H}^+}$ 和 $a_{\\mathrm{OH}^-}$ 的模型，每个活度都带有特定机理的指数，并具有特定机理的速率常数。然后，您必须从合成数据中拟合这些指数和速率常数。\n\n数据生成协议：\n- 您将通过为指数和速率常数指定“真实”参数值、从 $\\mathrm{pH}$ 和 $K_w$ 计算活度，并评估速率定律来生成合成溶解速率数据。然后，您将通过乘性高斯噪声扰动这些速率，以模拟实验不确定性。具体来说，对于每个真实速率为 $r_{\\text{true}}$ 的数据点，根据 $r_{\\text{obs}} = r_{\\text{true}} \\left( 1 + \\epsilon \\right)$ 生成一个观测速率 $r_{\\text{obs}}$，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma)$，标准差 $\\sigma$ 按每个测试用例指定。如果 $r_{\\text{obs}} \\le 0$，则将其替换为一个小的正数下限（例如 $10^{-30}$）以保持物理真实性。\n\n参数估计协议：\n- 通过使用非线性最小二乘法 (NLLS) 最小化整个数据集中观测速率与模型预测速率之间的残差平方和，来拟合特定机理的指数和速率常数。对速率常数使用非负性约束，并为指数设置合理的边界（例如，在 $0$ 和 $3$ 之间以反映典型的催化级数）。提供正且具有物理意义的初始猜测值。\n- 报告整个数据集中残差的均方根 (RMS)，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n活度计算：\n- 对于每个具有指定 $\\mathrm{pH}$ 的数据点，计算 $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$ 和 $a_{\\mathrm{OH}^-} = \\dfrac{K_w}{a_{\\mathrm{H}^+}}$，其中 $K_w = 10^{-14}$，所有量均为无量纲。\n\n测试套件：\n您必须实现三个不同的测试用例，它们改变真实参数和噪声水平，以确保覆盖酸主导、碱主导和混合区域。使用固定的随机种子以确保跨运行的可复现性。\n\n- 测试用例 1（混合贡献）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 1.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{H}^+} = 0.50$， $k_{\\mathrm{OH}^-} = 5.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{OH}^-} = 0.70$。\n  - 噪声标准差：$\\sigma = 0.05$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{2, 3, 4, 5, 6, 7, 8, 9, 10, 12\\}$。\n\n- 测试用例 2（酸主导）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 3.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{H}^+} = 0.90$， $k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{OH}^-} = 1.20$。\n  - 噪声标准差：$\\sigma = 0.02$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{1, 2, 3, 4, 6, 7, 8, 9\\}$。\n\n- 测试用例 3（碱主导）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{H}^+} = 0.60$， $k_{\\mathrm{OH}^-} = 2.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{OH}^-} = 0.80$。\n  - 噪声标准差：$\\sigma = 0.05$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{7, 8, 9, 10, 11, 12, 13\\}$。\n\n实现要求：\n- 使用 $K_w = 10^{-14}$ 且温度固定在 $25\\,^\\circ\\mathrm{C}$。\n- 在开始时用 $42$ 对随机数生成器进行一次播种。\n- 对于 NLLS，选择初始猜测值 $k_{\\mathrm{H}^+} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{H}^+} = 0.50$， $k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$， $n_{\\mathrm{OH}^-} = 0.50$，边界为 $k_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-} \\in [10^{-20}, 10^{-6}]$ 和 $n_{\\mathrm{H}^+}, n_{\\mathrm{OH}^-} \\in [0, 3]$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按以下顺序输出拟合的指数和速率常数以及 RMS 残差：\n  - $n_{\\mathrm{H}^+}$, $n_{\\mathrm{OH}^-}$, $k_{\\mathrm{H}^+}$, $k_{\\mathrm{OH}^-}$, $\\mathrm{RMS}$。\n- 将三个测试用例的输出按顺序连接成一个扁平列表。将所有值以小数点后保留六位的科学记数法浮点数形式打印。例如：$\\left[\\text{case1\\_}n_{\\mathrm{H}^+},\\text{case1\\_}n_{\\mathrm{OH}^-},\\text{case1\\_}k_{\\mathrm{H}^+},\\text{case1\\_}k_{\\mathrm{OH}^-},\\text{case1\\_}\\mathrm{RMS},\\text{case2\\_}\\ldots,\\text{case3\\_}\\ldots\\right]$。\n\n单位和报告：\n- 所有速率和速率常数均以 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 表示。\n- 指数是无量纲的。\n- 活度是无量纲的。\n\n您的程序必须完全自包含，不接受用户输入，并严格遵守指定的输出格式。环境是 Python $3.12$ 及指定的库。程序打印的最后一行必须只包含方括号列表，不得有任何附加文本。",
            "solution": "问题陈述是有效的。它在科学上基于化学动力学和计算地球化学的原理，问题设定良好，目标明确，数据充分，并以精确、客观的语言表述。因此，我们将着手提供一个完整的解决方案。\n\n核心任务是构建并标定一个长石溶解的多机理速率定律。这涉及三个主要阶段：(1) 基于地球化学原理定义数学模型，(2) 根据指定的统计模型生成合成实验数据，以及 (3) 执行非线性最小二乘 (NLLS) 回归，以从合成数据中估计模型参数。\n\n**1. 模型构建**\n\n总溶解速率 $R$ 被建模为独立、并行反应路径速率的总和。问题指定了两个这样的路径：一个由酸（水合氢离子，$\\mathrm{H}^+$）催化，另一个由碱（氢氧根离子，$\\mathrm{OH}^-$）催化。因此，总速率 $R$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）由下式给出：\n$$\nR = R_{\\text{acid}} + R_{\\text{base}}\n$$\n每个路径的速率由对催化物种活度的幂律依赖关系描述。这是从过渡态理论推导出的常见公式。酸催化机理的速率 $R_{\\text{acid}}$ 和碱催化机理的速率 $R_{\\text{base}}$ 分别由以下公式给出：\n$$\nR_{\\text{acid}} = k_{\\mathrm{H}^+} a_{\\mathrm{H}^+}^{n_{\\mathrm{H}^+}}\n$$\n$$\nR_{\\text{base}} = k_{\\mathrm{OH}^-} a_{\\mathrm{OH}^-}^{n_{\\mathrm{OH}^-}}\n$$\n在这里，$k_{\\mathrm{H}^+}$ 和 $k_{\\mathrm{OH}^-}$ 是特定机理的速率常数（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），$a_{\\mathrm{H}^+}$ 和 $a_{\\mathrm{OH}^-}$ 是水合氢离子和氢氧根离子的无量纲活度，而 $n_{\\mathrm{H}^+}$ 和 $n_{\\mathrm{OH}^-}$ 是每个路径的无量纲反应级数（指数）。\n\n完整的速率定律是这两个贡献的总和：\n$$\nR = k_{\\mathrm{H}^+} a_{\\mathrm{H}^+}^{n_{\\mathrm{H}^+}} + k_{\\mathrm{OH}^-} a_{\\mathrm{OH}^-}^{n_{\\mathrm{OH}^-}}\n$$\n离子物种的活度与溶液的 $\\mathrm{pH}$ 有关。根据定义，$\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$，可得：\n$$\na_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}\n$$\n氢氧根的活度通过水的自偶电离平衡常数 $K_w = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$ 与水合氢离子的活度相关。在指定的 $25\\,^\\circ\\mathrm{C}$ 温度下，$K_w = 10^{-14}$。因此：\n$$\na_{\\mathrm{OH}^-} = \\frac{K_w}{a_{\\mathrm{H}^+}} = \\frac{10^{-14}}{10^{-\\mathrm{pH}}} = 10^{\\mathrm{pH}-14}\n$$\n将这些活度表达式代入速率定律，得到最终模型，该模型是 $\\mathrm{pH}$ 和待拟合的四个参数（$\\vec{p} = [k_{\\mathrm{H}^+}, n_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-}, n_{\\mathrm{OH}^-}]$）的函数：\n$$\nR(\\mathrm{pH}; \\vec{p}) = k_{\\mathrm{H}^+} (10^{-\\mathrm{pH}})^{n_{\\mathrm{H}^+}} + k_{\\mathrm{OH}^-} (10^{\\mathrm{pH}-14})^{n_{\\mathrm{OH}^-}}\n$$\n该函数构成了数据生成和参数估计的基础。\n\n**2. 数据合成**\n\n为了模拟实验数据，我们首先使用上述模型和一组给定的真实参数（$k_{\\mathrm{H}^+\\text{,true}}$，$n_{\\mathrm{H}^+\\text{,true}}$ 等），在不同的 $\\mathrm{pH}_i$ 值下计算一组“真实”溶解速率（$r_{\\text{true},i}$）。然后通过乘性高斯噪声扰动这些真实速率来模拟实验不确定性。每个观测速率 $r_{\\text{obs},i}$ 根据以下公式从每个真实速率生成：\n$$\nr_{\\text{obs},i} = r_{\\text{true},i} (1 + \\epsilon_i)\n$$\n其中 $\\epsilon_i$ 是从均值为 $0$、标准差为 $\\sigma$ 的正态分布中抽取的随机变量，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma)$。标准差 $\\sigma$ 代表相对噪声水平。为保持物理真实性，任何得到的非正速率（$r_{\\text{obs},i} \\le 0$）都将被替换为一个小的正数下限值，即 $10^{-30}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。固定的随机种子 $42$ 确保了生成数据集的可复现性。\n\n**3. 参数估计与性能评估**\n\n反问题是从合成的“观测”数据 $( \\mathrm{pH}_i, r_{\\text{obs},i} )$ 中估计四个模型参数 $\\vec{p} = [k_{\\mathrm{H}^+}, n_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-}, n_{\\mathrm{OH}^-}]$。我们使用非线性最小二乘法 (NLLS)。这涉及找到参数向量 $\\vec{p}_{\\text{fit}}$，以最小化观测速率与模型预测速率之间的残差平方和 (SSR)：\n$$\n\\mathrm{SSR}(\\vec{p}) = \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}) \\right)^2\n$$\n其中 $N$ 是数据点的数量。此最小化过程使用 `scipy.optimize.least_squares` 函数进行数值计算，该函数非常适合此任务。优化过程受到参数物理意义边界的约束：速率常数必须为正（$k_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-} \\in [10^{-20}, 10^{-6}]$），反应级数通常是小的正数（$n_{\\mathrm{H}^+}, n_{\\mathrm{OH}^-} \\in [0, 3]$）。为引导算法，提供了一组参数的初始猜测值。\n\n拟合优度通过残差的均方根 (RMS) 来量化，其单位与速率相同，并提供了模型预测平均误差的度量：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{\\mathrm{SSR}(\\vec{p}_{\\text{fit}})}{N}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}_{\\text{fit}}) \\right)^2}\n$$\n此过程对问题陈述中定义的三个测试用例中的每一个重复进行，并报告最终拟合的参数和 RMS 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Formulates and calibrates a multi-mechanism rate law for feldspar dissolution.\n    Generates synthetic data, fits parameters using NLLS, and reports the results.\n    \"\"\"\n    np.random.seed(42)  # Seed for reproducibility\n    K_w = 1e-14\n    \n    # Define the three test cases as specified in the problem statement\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (mixed contributions)\",\n            \"true_params\": {\"k_H\": 1.0e-10, \"n_H\": 0.50, \"k_OH\": 5.0e-11, \"n_OH\": 0.70},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([2, 3, 4, 5, 6, 7, 8, 9, 10, 12]),\n        },\n        {\n            \"name\": \"Test Case 2 (acid-dominated)\",\n            \"true_params\": {\"k_H\": 3.0e-10, \"n_H\": 0.90, \"k_OH\": 1.0e-12, \"n_OH\": 1.20},\n            \"sigma\": 0.02,\n            \"ph_grid\": np.array([1, 2, 3, 4, 6, 7, 8, 9]),\n        },\n        {\n            \"name\": \"Test Case 3 (base-dominated)\",\n            \"true_params\": {\"k_H\": 1.0e-12, \"n_H\": 0.60, \"k_OH\": 2.0e-10, \"n_OH\": 0.80},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([7, 8, 9, 10, 11, 12, 13]),\n        },\n    ]\n\n    # Parameter order for optimization: [k_H, n_H, k_OH, n_OH]\n    initial_guesses = np.array([1.0e-11, 0.50, 1.0e-11, 0.50])\n    bounds = (\n        [1e-20, 0, 1e-20, 0],       # Lower bounds\n        [1e-6, 3, 1e-6, 3]          # Upper bounds\n    )\n    \n    # Store all results in a flat list\n    all_results = []\n\n    def rate_model(params, ph_values):\n        \"\"\"\n        Calculates dissolution rate based on the two-mechanism model.\n        params: [k_H, n_H, k_OH, n_OH]\n        \"\"\"\n        k_H, n_H, k_OH, n_OH = params\n        a_H = 10.0**(-ph_values)\n        a_OH = K_w / a_H\n        rate = k_H * (a_H**n_H) + k_OH * (a_OH**n_OH)\n        return rate\n\n    for case in test_cases:\n        true_params_vec = np.array([\n            case[\"true_params\"][\"k_H\"],\n            case[\"true_params\"][\"n_H\"],\n            case[\"true_params\"][\"k_OH\"],\n            case[\"true_params\"][\"n_OH\"],\n        ])\n        \n        # 1. Generate synthetic data\n        true_rates = rate_model(true_params_vec, case[\"ph_grid\"])\n        noise = np.random.normal(0, case[\"sigma\"], size=len(case[\"ph_grid\"]))\n        observed_rates = true_rates * (1 + noise)\n        \n        # Apply floor value for non-positive rates\n        observed_rates[observed_rates = 0] = 1e-30\n        \n        # 2. Define the residual function for least_squares\n        def residuals(params, ph_values, obs_rates):\n            return rate_model(params, ph_values) - obs_rates\n\n        # 3. Perform Non-Linear Least Squares fitting\n        result = least_squares(\n            residuals,\n            initial_guesses,\n            bounds=bounds,\n            args=(case[\"ph_grid\"], observed_rates)\n        )\n        \n        fitted_params = result.x\n        \n        # 4. Calculate RMS of the residuals\n        final_residuals = residuals(fitted_params, case[\"ph_grid\"], observed_rates)\n        rms = np.sqrt(np.mean(final_residuals**2))\n        \n        # 5. Extract fitted parameters\n        k_H_fit, n_H_fit, k_OH_fit, n_OH_fit = fitted_params\n        \n        # Append results in the specified order: nH+, nOH-, kH+, kOH-, RMS\n        case_results = [n_H_fit, n_OH_fit, k_H_fit, k_OH_fit, rms]\n        all_results.extend(case_results)\n\n    # 6. Format and print the final output\n    formatted_results = [f\"{val:.6e}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}