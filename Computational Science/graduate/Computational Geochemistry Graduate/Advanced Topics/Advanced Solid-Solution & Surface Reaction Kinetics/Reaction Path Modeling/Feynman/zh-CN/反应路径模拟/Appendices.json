{
    "hands_on_practices": [
        {
            "introduction": "在构建反应路径模型时，首要任务是确定在给定条件下哪些化学反应将优先发生。对于由氧化还原反应驱动的体系，这一顺序由热力学决定：体系会优先利用能释放最多能量的电子受体。本练习将通过构建一个“氧化还原梯”来实践这一核心概念，你需要运用能斯特方程（Nernst equation）计算不同氧化还原电对在特定地球化学条件下的电位（$E_h$），从而预测有机碳氧化过程中电子受体的消耗顺序。",
            "id": "4097802",
            "problem": "一个体积为 $1.000\\ \\mathrm{L}$、温度为 $25^{\\circ}\\ \\mathrm{C}$、pH值固定在 $7.00$ 的封闭等温水相体系，初始时混合均匀并被缓冲，使得 $a_{\\text{H}^{+}}=10^{-7}$，且所有溶解物质的活度系数近似为1。考虑由 $\\text{CH}_2\\text{O}$ 代表的通用有机碳的不可逆氧化，该过程沿着热力学控制的反应路径进行。在此路径上，任何时刻都优先利用具有最高有效还原电位（在当前活度条件下）的电子受体，直至其被耗尽。该体系初始包含以下总量的物质（除非另有说明，均为溶解的水相物质）：溶解的分子氧 $\\text{O}_2\\text{(aq)}$，$n_{\\text{O}_2}=2.80\\times 10^{-4}\\ \\mathrm{mol}$；硝酸根 $\\text{NO}_3^{-}$，$n_{\\text{NO}_3^{-}}=1.56\\times 10^{-3}\\ \\mathrm{mol}$；以及硫酸根 $\\text{SO}_4^{2-}$，$n_{\\text{SO}_4^{2-}}=1.00\\times 10^{-2}\\ \\mathrm{mol}$。假设氮气 $\\text{N}_2$ 的逸度为 $f_{\\text{N}_2}=1.00$，还原态的硫产物为硫氢根 $\\text{HS}^{-}$，其初始活度可忽略不计。水的活度为 $a_{\\text{H}_2\\text{O}}=1$。\n\n从基本的氧化还原半反应定义和能斯特方程出发，构建在所述条件下、$\\mathrm{pH}=7.00$ 时，三个电子受体电对 $\\text{O}_2/\\text{H}_2\\text{O}$、$\\text{NO}_3^{-}/\\text{N}_2$ 和 $\\text{SO}_4^{2-}/\\text{HS}^{-}$ 的热力学氧化还原梯，并确定在热力学控制下氧化 $\\text{CH}_2\\text{O}$ 的过程中它们被利用的顺序。然后，利用从配平的半反应推导出的电子等价化学计量关系，确定当硫酸盐还原首次成为反应路径上的主导电子接受步骤时（即，在所有先前的高电位受体被耗尽之后，但在硫酸盐有任何可测量的消耗之前），将被氧化的 $\\text{CH}_2\\text{O}$ 的累积量（以毫摩尔为单位）。请以毫摩尔为单位表示您的最终答案，并保留三位有效数字。",
            "solution": "该问题需要一个包含两部分的解答。首先，我们必须在指定条件下为给定的电子受体构建热力学氧化还原梯，以确定它们的利用顺序。其次，我们必须计算直到硫酸盐还原开始时被氧化的有机物（以 $\\text{CH}_2\\text{O}$ 表示）的总量。这对应于所有比硫酸根/硫氢根电对具有更高还原电位的电子受体被完全消耗。\n\n分析是针对一个在温度 $T = 25^{\\circ}\\ \\mathrm{C}$ ($298.15\\ \\mathrm{K}$)、pH值固定为 $7.00$ 的封闭等温水相体系进行的，这意味着氢离子的活度为 $a_{\\text{H}^{+}} = 10^{-7}$。体系的体积为 $V = 1.000\\ \\mathrm{L}$。假设活度系数为1，因此溶解物质 $i$ 的活度 $a_i$ 等于其摩尔浓度 $M_i$。鉴于体积为 $1.000\\ \\mathrm{L}$，活度在数值上等于物质的量（摩尔数）。\n\n电子受体的初始活度为：\n$a_{\\text{O}_2} = M_{\\text{O}_2} = \\frac{2.80\\times 10^{-4}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 2.80\\times 10^{-4}$\n$a_{\\text{NO}_3^-} = M_{\\text{NO}_3^-} = \\frac{1.56\\times 10^{-3}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.56\\times 10^{-3}$\n$a_{\\text{SO}_4^{2-}} = M_{\\text{SO}_4^{2-}} = \\frac{1.00\\times 10^{-2}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.00\\times 10^{-2}$\n其他指定的活度为 $a_{\\text{H}_2\\text{O}} = 1$ 和氮气的逸度 $f_{\\text{N}_2} = 1.00$。\n\n第一部分：热力学氧化还原梯\n\n电子受体的利用顺序由每个氧化还原电对在当前条件下的有效还原电位 $E_h$ 决定。具有最高 $E_h$ 的电对与有机物氧化耦合时能提供最多的能量，因此将被首先利用。我们使用能斯特方程计算 $E_h$：\n$$E_{h} = E^{0} - \\frac{RT}{nF} \\ln Q = E^{0} - \\frac{2.303RT}{nF} \\log_{10} Q$$\n其中 $E^0$ 是标准还原电位，$R$ 是理想气体常数 ($8.314\\ \\mathrm{J}\\cdot\\mathrm{mol}^{-1}\\cdot\\mathrm{K}^{-1}$)，$T$ 是绝对温度 ($298.15\\ \\mathrm{K}$)，$n$ 是半反应中转移的电子数，$F$ 是法拉第常数 ($96485\\ \\mathrm{C}\\cdot\\mathrm{mol}^{-1}$)，$Q$ 是反应商。在 $25^{\\circ}\\ \\mathrm{C}$ 时，$\\frac{2.303RT}{F}$ 项约等于 $0.05916\\ \\mathrm{V}$。\n\n现在我们为三个电子受体电对分别计算 $E_h$。\n\n1.  氧/水电对 ($\\text{O}_2/\\text{H}_2\\text{O}$)：\n    还原半反应及其标准电位为：\n    $$\\text{O}_2\\text{(aq)} + 4\\text{H}^{+} + 4e^{-} \\rightarrow 2\\text{H}_2\\text{O}$$\n    其中 $E^0 = +1.229\\ \\mathrm{V}$。转移的电子数为 $n=4$。\n    反应商为 $Q = \\frac{(a_{\\text{H}_2\\text{O}})^2}{(a_{\\text{O}_2})(a_{\\text{H}^+})^4}$。\n    使用给定的活度：\n    $Q = \\frac{1^2}{(2.80 \\times 10^{-4})(10^{-7})^4} = \\frac{1}{2.80 \\times 10^{-32}} \\approx 3.571 \\times 10^{31}$。\n    还原电位是：\n    $E_{h, \\text{O}_2} = 1.229\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{4} \\log_{10}(3.571 \\times 10^{31})$\n    $E_{h, \\text{O}_2} = 1.229 - 0.01479 \\times (31.553) = 1.229 - 0.467 = +0.762\\ \\mathrm{V}$。\n\n2.  硝酸根/氮气电对 ($\\text{NO}_3^{-}/\\text{N}_2$)：\n    还原半反应及其标准电位为：\n    $$2\\text{NO}_3^{-} + 12\\text{H}^{+} + 10e^{-} \\rightarrow \\text{N}_2(g) + 6\\text{H}_2\\text{O}$$\n    其中 $E^0 = +1.246\\ \\mathrm{V}$。转移的电子数为 $n=10$。\n    反应商为 $Q = \\frac{f_{\\text{N}_2}(a_{\\text{H}_2\\text{O}})^6}{(a_{\\text{NO}_3^-})^2(a_{\\text{H}^+})^{12}}$。\n    使用给定的活度/逸度：\n    $Q = \\frac{1.00 \\times 1^6}{(1.56 \\times 10^{-3})^2 (10^{-7})^{12}} = \\frac{1}{(2.4336 \\times 10^{-6})(10^{-84})} = \\frac{1}{2.4336 \\times 10^{-90}} \\approx 4.109 \\times 10^{89}$。\n    还原电位是：\n    $E_{h, \\text{NO}_3^-} = 1.246\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{10} \\log_{10}(4.109 \\times 10^{89})$\n    $E_{h, \\text{NO}_3^-} = 1.246 - 0.005916 \\times (89.614) = 1.246 - 0.530 = +0.716\\ \\mathrm{V}$。\n\n3.  硫酸根/硫氢根电对 ($\\text{SO}_4^{2-}/\\text{HS}^-$)：\n    还原半反应及其标准电位为：\n    $$\\text{SO}_4^{2-} + 9\\text{H}^{+} + 8e^{-} \\rightarrow \\text{HS}^{-} + 4\\text{H}_2\\text{O}$$\n    其中 $E^0 = +0.303\\ \\mathrm{V}$。转移的电子数为 $n=8$。\n    问题说明还原产物 $\\text{HS}^-$ 的初始活度可忽略不计。为了计算出一个有限的电位，必须假设一个非零的活度。我们将采用地球化学模型中的一个普遍惯例，假设一个阈值活度 $a_{\\text{HS}^-} = 10^{-6}$ 来表示该过程开始活跃。\n    反应商为 $Q = \\frac{a_{\\text{HS}^-}(a_{\\text{H}_2\\text{O}})^4}{a_{\\text{SO}_4^{2-}}(a_{\\text{H}^+})^9}$。\n    使用给定的活度和我们的假设：\n    $Q = \\frac{10^{-6} \\times 1^4}{(1.00 \\times 10^{-2})(10^{-7})^9} = \\frac{10^{-6}}{10^{-2} \\times 10^{-63}} = \\frac{10^{-6}}{10^{-65}} = 10^{59}$。\n    还原电位是：\n    $E_{h, \\text{SO}_4^{2-}} = 0.303\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{8} \\log_{10}(10^{59})$\n    $E_{h, \\text{SO}_4^{2-}} = 0.303 - 0.007395 \\times 59 = 0.303 - 0.436 = -0.133\\ \\mathrm{V}$。\n\n比较计算出的电位：\n$E_{h, \\text{O}_2} = +0.762\\ \\mathrm{V}$\n$E_{h, \\text{NO}_3^-} = +0.716\\ \\mathrm{V}$\n$E_{h, \\text{SO}_4^{2-}} = -0.133\\ \\mathrm{V}$\n\n由于 $E_{h, \\text{O}_2} > E_{h, \\text{NO}_3^-} > E_{h, \\text{SO}_4^{2-}}$，在氧化 $\\text{CH}_2\\text{O}$ 过程中，电子受体利用的热力学顺序是：\n1.  好氧呼吸（$\\text{O}_2$ 消耗）\n2.  反硝化作用（$\\text{NO}_3^-$ 消耗）\n3.  硫酸盐还原（$\\text{SO}_4^{2-}$ 消耗）\n\n第二部分：计算被氧化的 $\\text{CH}_2\\text{O}$ 量\n\n我们需要计算当硫酸盐还原首次成为主导过程时，被氧化的 $\\text{CH}_2\\text{O}$ 的总量。这发生在所有更高电位的受体，即 $\\text{O}_2$ 和 $\\text{NO}_3^-$，被完全消耗时。我们可以通过平衡 $\\text{CH}_2\\text{O}$ 氧化释放的总电子数与 $\\text{O}_2$ 和 $\\text{NO}_3^-$ 接受的总电子数来解决这个问题。\n\n首先，$\\text{CH}_2\\text{O}$（其中碳的氧化态为0）氧化为碳的氧化态为+4的产物（例如 $\\text{CO}_2$ 或 $\\text{HCO}_3^-$）的氧化半反应会释放4个电子：\n$$\\text{CH}_2\\text{O} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + 4\\text{H}^{+} + 4e^{-}$$\n因此，1摩尔 $\\text{CH}_2\\text{O}$ 的氧化会释放4摩尔电子。\n\n接下来，我们计算可用的 $\\text{O}_2$ 和 $\\text{NO}_3^-$ 的总电子接受能力。\n\n-   $\\text{O}_2$ 接受的电子：\n    半反应 $\\text{O}_2 + 4\\text{H}^{+} + 4e^{-} \\rightarrow 2\\text{H}_2\\text{O}$ 表明1摩尔 $\\text{O}_2$ 接受4摩尔电子。\n    来自 $\\text{O}_2$ 的总电子数：\n    $n_{e^-, \\text{O}_2} = n_{\\text{O}_2} \\times 4 = (2.80 \\times 10^{-4}\\ \\mathrm{mol}) \\times 4 = 1.12 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$。\n\n-   $\\text{NO}_3^-$ 接受的电子：\n    反硝化生成 $\\text{N}_2$ 的半反应是 $2\\text{NO}_3^{-} + 12\\text{H}^{+} + 10e^{-} \\rightarrow \\text{N}_2 + 6\\text{H}_2\\text{O}$。这表明2摩尔 $\\text{NO}_3^-$ 接受10摩尔电子，或者说1摩尔 $\\text{NO}_3^-$ 接受5摩尔电子。\n    来自 $\\text{NO}_3^-$ 的总电子数：\n    $n_{e^-, \\text{NO}_3^-} = n_{\\text{NO}_3^{-}} \\times 5 = (1.56 \\times 10^{-3}\\ \\mathrm{mol}) \\times 5 = 7.80 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$。\n\n在硫酸盐还原开始前接受的总电子摩尔数是上述两者的总和：\n$n_{e^-, \\text{total}} = n_{e^-, \\text{O}_2} + n_{e^-, \\text{NO}_3^-} = 1.12 \\times 10^{-3} + 7.80 \\times 10^{-3} = 8.92 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$。\n\n这个总数必须等于 $\\text{CH}_2\\text{O}$ 氧化所释放的电子摩尔数。\n$n_{e^-, \\text{total}} = n_{\\text{CH}_2\\text{O}} \\times 4$。\n因此，被氧化的 $\\text{CH}_2\\text{O}$ 的总摩尔数为：\n$n_{\\text{CH}_2\\text{O}} = \\frac{n_{e^-, \\text{total}}}{4} = \\frac{8.92 \\times 10^{-3}\\ \\mathrm{mol}}{4} = 2.23 \\times 10^{-3}\\ \\mathrm{mol}$。\n\n题目要求答案以毫摩尔为单位，并保留三位有效数字。\n$1\\ \\mathrm{mmol} = 10^{-3}\\ \\mathrm{mol}$。\n$n_{\\text{CH}_2\\text{O}} = 2.23\\ \\mathrm{mmol}$。\n这个值已经是三位有效数字。",
            "answer": "$$\\boxed{2.23}$$"
        },
        {
            "introduction": "确定了反应的热力学顺序后，下一步是模拟反应进行的速率。在矿物-流体相互作用中，反应速率通常与矿物的“反应表面积”（$A_{\\text{react}}$）成正比，而这个表面积本身会随着反应的进行而改变。本练习旨在探讨如何对反应表面积的演化进行建模，你将推导并比较几种不同的模型假设（例如，表面积与矿物质量成比例），并分析这些假设如何深刻影响对矿物溶解速率和总量的预测。",
            "id": "4097825",
            "problem": "考虑一个封闭的、恒温的间歇式反应器，其中含有一个无沉淀的单一溶解矿物相。设 $m(t)$ 表示时间 $t$（单位为 $\\mathrm{s}$）时的矿物质量（单位为 $\\mathrm{kg}$），$A_{\\text{react}}(t)$ 表示可用于溶解的反应表面积（单位为 $\\mathrm{m^2}$）。假设质量损失速率对反应表面积具有一级依赖关系，其速率定律为 $\\,\\dfrac{dm}{dt} = -k\\,A_{\\text{react}}(t)\\,$，其中 $k$ 是一个常数，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。设初始条件为 $m(0) = m_0$（单位为 $\\mathrm{kg}$），$A_{\\text{react}}(0) = A_0$（单位为 $\\mathrm{m^2}$），矿物密度为 $\\rho$（单位为 $\\mathrm{kg\\,m^{-3}}$）。反应器体积中含有足量的溶剂，以至于没有传输限制，且速率常数 $k$ 保持不随时间变化。\n\n定义并比较反应路径上 $A_{\\text{react}}(t)$ 的三种模型：\n- 体积定标模型：$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{V(t)}{V_0}\\right)$，其中 $V(t) = \\dfrac{m(t)}{\\rho}$ 且 $V_0 = \\dfrac{m_0}{\\rho}$。\n- 质量定标模型：$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$。\n- 分形指数模型：$A_{\\text{react}}(t;p) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)^{p}$，其中常数指数 $p$ 满足 $0 \\le p \\le 1$。\n\n仅从给定的速率定律、质量守恒和上述定义出发，推导每种模型下 $m(t)$ 的时间演化，并获得在有限时长 $T$（单位为 $\\mathrm{s}$）内的积分速率 $R_{\\text{int}}(T) = \\int_{0}^{T} k\\,A_{\\text{react}}(t)\\,dt$。将 $R_{\\text{int}}(T)$ 以 $\\mathrm{kg}$ 为单位表示。通过要求对所有 $t$ 都有 $m(t) \\ge 0$ 来强制物理真实性，并且如果完全溶解在 $T$ 之前发生，则 $R_{\\text{int}}(T)$ 必须等于 $m_0$。\n\n你的任务是实现一个程序，为以下五个测试用例计算 $R_{\\text{int}}(T)$。使用给定的指定参数，所有量均采用所示单位。最终的数值输出必须四舍五入到六位小数，并以 $\\mathrm{kg}$ 为单位表示。\n\n测试套件：\n1. 体积定标模型，参数为 $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$。\n2. 质量定标模型，参数为 $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$。\n3. 分形指数模型，参数为 $p = 0.8$，$m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$。\n4. 分形指数模型，参数为 $p = 0.8$，$m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 130000000$。\n5. 分形指数模型，参数为 $p = 0.0$，$m_0 = 0.1$, $\\rho = 2650$, $A_0 = 0.01$, $k = 0.000002$, $T = 10000000$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4,result5]”）。每个“result”必须是对应测试用例的积分速率 $R_{\\text{int}}(T)$（单位为 $\\mathrm{kg}$），四舍五入到六位小数。",
            "solution": "用户提供的问题陈述已经过验证，被确定为自洽、有科学依据且定义明确。解的推导过程如下。\n\n### 1. 反应表面积模型分析\n\n问题定义了反应表面积 $A_{\\text{react}}(t)$ 的三种模型。这些模型将表面积与剩余矿物质量 $m(t)$ 联系起来。\n\n首先，我们分析**体积定标模型**。其定义为：\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{V(t)}{V_0}\\right)$$\n其中 $V(t) = m(t)/\\rho$ 是时间 $t$ 时的矿物体积，$V_0 = m_0/\\rho$ 是初始体积。代入这些定义可得：\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)/\\rho}{m_0/\\rho}\\right) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$$\n这个表达式与为**质量定标模型**提供的定义相同：\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$$\n因此，体积定标模型和质量定标模型是同一物理假设的等效表示。\n\n第三个模型，**分形指数模型**，推广了这种关系：\n$$A_{\\text{react}}(t;p) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)^{p}$$\n其中 $p$ 是一个常数指数，范围在 $0 \\le p \\le 1$。\n显然，体积定标模型和质量定标模型是分形指数模型在 $p=1$ 时的特例。$p=0$ 的情况对应于恒定的反应表面积 $A_{\\text{react}}(t) = A_0$。$p=2/3$ 的情况将对应于具有简单、非分形几何形状（例如球体或立方体）的矿物在收缩时保持其形状的溶解过程。\n\n### 2. 矿物质量 $m(t)$ 时间演化的推导\n\n出发点是质量损失的基本速率定律：\n$$\\dfrac{dm}{dt} = -k\\,A_{\\text{react}}(t)$$\n代入 $A_{\\text{react}}(t)$ 的通用分形指数模型：\n$$\\dfrac{dm}{dt} = -k A_0 \\left(\\dfrac{m}{m_0}\\right)^{p} = -\\left(\\dfrac{kA_0}{m_0^p}\\right) m^p$$\n这是一个可分离的常微分方程。我们可以通过积分来求解 $m(t)$，并满足初始条件 $m(0) = m_0$。解取决于 $p$ 的值。\n\n**情况 I：$p=1$（体积定标模型和质量定标模型）**\n对于 $p=1$，微分方程变为：\n$$\\dfrac{dm}{dt} = -\\left(\\dfrac{kA_0}{m_0}\\right) m$$\n对这个一阶线性常微分方程积分：\n$$\\int_{m_0}^{m(t)} \\dfrac{1}{m'} dm' = \\int_{0}^{t} -\\left(\\dfrac{kA_0}{m_0}\\right) dt'$$\n$$[\\ln(m')]_{m_0}^{m(t)} = -\\left(\\dfrac{kA_0 t}{m_0}\\right) t$$\n$$\\ln\\left(\\dfrac{m(t)}{m_0}\\right) = -\\left(\\dfrac{kA_0 t}{m_0}\\right)$$\n对两边取指数，得到 $m(t)$ 的解：\n$$m(t) = m_0 \\exp\\left(-\\dfrac{kA_0 t}{m_0}\\right)$$\n在此模型中，质量呈指数衰减，并且仅在 $t \\to \\infty$ 时趋近于 $0$。完全溶解不会在有限时间内发生。\n\n**情况 II：$p \\ne 1$（分形指数模型，其中 $0 \\le p  1$）**\n对于 $p \\ne 1$，我们分离变量：\n$$m^{-p} dm = -\\left(\\dfrac{kA_0}{m_0^p}\\right) dt$$\n从 $t=0$ 到 $t$ 积分：\n$$\\int_{m_0}^{m(t)} m'^{-p} dm' = \\int_{0}^{t} -\\left(\\dfrac{kA_0}{m_0^p}\\right) dt'$$\n$$\\left[ \\dfrac{m'^{1-p}}{1-p} \\right]_{m_0}^{m(t)} = -\\left(\\dfrac{kA_0}{m_0^p}\\right) t$$\n$$\\dfrac{m(t)^{1-p} - m_0^{1-p}}{1-p} = -\\dfrac{kA_0 t}{m_0^p}$$\n$$m(t)^{1-p} = m_0^{1-p} - (1-p)\\dfrac{kA_0 t}{m_0^p}$$\n由于 $0 \\le p  1$，指数 $(1-p)$ 为正。因此，我们可以解出 $m(t)$：\n$$m(t) = \\left[ m_0^{1-p} - (1-p)k A_0 m_0^{-p} t \\right]^{\\frac{1}{1-p}}$$\n只要方括号中的项为非负，该解在物理上就是有效的。完全溶解发生在有限时间 $t_{\\text{diss}}$，此时 $m(t_{\\text{diss}}) = 0$。\n$$0 = m_0^{1-p} - (1-p)k A_0 m_0^{-p} t_{\\text{diss}}$$\n$$t_{\\text{diss}} = \\dfrac{m_0^{1-p} m_0^p}{(1-p)k A_0} = \\dfrac{m_0}{(1-p)k A_0}$$\n通过代入 $t_{\\text{diss}}$ 可以获得 $m(t)$ 更简洁的形式：\n$$m(t)^{1-p} = m_0^{1-p} \\left(1 - \\dfrac{(1-p)k A_0 m_0^{-p} t}{m_0^{1-p}}\\right) = m_0^{1-p} \\left(1 - \\dfrac{t}{t_{\\text{diss}}}\\right)$$\n$$m(t) = m_0 \\left( 1 - \\dfrac{t}{t_{\\text{diss}}} \\right)^{\\frac{1}{1-p}}$$\n此形式对 $t \\le t_{\\text{diss}}$ 有效。对于 $t > t_{\\text{diss}}$，质量保持为零，即 $m(t)=0$。\n\n### 3. 积分速率 $R_{\\text{int}}(T)$ 的计算\n\n问题将积分速率定义为 $R_{\\text{int}}(T) = \\int_{0}^{T} k\\,A_{\\text{react}}(t)\\,dt$。我们可以使用原始速率定律 $k\\,A_{\\text{react}}(t) = -dm/dt$ 来简化此积分：\n$$R_{\\text{int}}(T) = \\int_{0}^{T} \\left(-\\dfrac{dm}{dt}\\right) dt = -\\int_{m(0)}^{m(T)} dm = -[m(T) - m(0)] = m_0 - m(T)$$\n这表明 $R_{\\text{int}}(T)$ 就是在时间区间 $[0, T]$ 内溶解的矿物总质量。\n\n我们必须考虑物理约束 $m(t) \\ge 0$。\n如果溶解在 $t_{\\text{diss}}  T$ 时完成，则时间 $T$ 时的质量为 $m(T)=0$。\n因此，$R_{\\text{int}}(T) = m_0 - 0 = m_0$，与问题陈述一致。\n一般来说，最终质量为 $m(T) = \\max(0, m_{\\text{calc}}(T))$，其中 $m_{\\text{calc}}(T)$ 是从推导的解析解中获得的值。因此，积分速率为：\n$$R_{\\text{int}}(T) = m_0 - \\max(0, m_{\\text{calc}}(T))$$\n\n### 4. 在测试用例中的应用\n\n我们应用这些公式来计算每个测试用例的 $R_{\\text{int}}(T)$。\n\n**测试用例 1 和 2 ($p=1$)：**\n- 参数：$m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 10^7$。\n- 模型为一级衰减，无有限溶解时间。\n- 我们使用 $m(t) = m_0 \\exp\\left(-\\dfrac{kA_0 t}{m_0}\\right)$ 计算 $m(T)$。\n- 指数的参数为 $\\dfrac{k A_0 T}{m_0} = \\dfrac{(10^{-6})(0.02)(10^7)}{0.5} = \\dfrac{0.2}{0.5} = 0.4$。\n- $m(T) = 0.5 \\exp(-0.4)$。\n- $R_{\\text{int}}(T) = m_0 - m(T) = 0.5 - 0.5 \\exp(-0.4) = 0.5(1 - \\exp(-0.4)) \\approx 0.164840\\ \\mathrm{kg}$。\n- 由于体积定标模型和质量定标模型已被证明是等效的，因此测试用例 1 和 2 的结果将是相同的。\n\n**测试用例 3 ($p=0.8$)：**\n- 参数：$m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 10^7$, $p=0.8$。\n- 首先，计算完全溶解所需的时间：\n  $t_{\\text{diss}} = \\dfrac{m_0}{(1-p)k A_0} = \\dfrac{0.5}{(1-0.8)(10^{-6})(0.02)} = \\dfrac{0.5}{0.2 \\times 2 \\times 10^{-8}} = 1.25 \\times 10^8\\ \\mathrm{s}$。\n- 由于 $T = 10^7  t_{\\text{diss}}$，矿物尚未完全溶解。\n- 我们使用 $m(t) = m_0 \\left( 1 - \\dfrac{t}{t_{\\text{diss}}} \\right)^{\\frac{1}{1-p}}$ 计算 $m(T)$。\n- 指数为 $\\frac{1}{1-p} = \\frac{1}{1-0.8} = \\frac{1}{0.2} = 5$。\n- $m(T) = 0.5 \\left( 1 - \\dfrac{10^7}{1.25 \\times 10^8} \\right)^5 = 0.5 \\left( 1 - 0.08 \\right)^5 = 0.5(0.92)^5$。\n- $R_{\\text{int}}(T) = m_0 - m(T) = 0.5 - 0.5(0.92)^5 = 0.5(1 - (0.92)^5) \\approx 0.170460\\ \\mathrm{kg}$。\n\n**测试用例 4 ($p=0.8$)：**\n- 参数：$m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 1.3 \\times 10^8$, $p=0.8$。\n- 溶解时间与情况 3 相同：$t_{\\text{diss}} = 1.25 \\times 10^8\\ \\mathrm{s}$。\n- 在此，$T = 1.3 \\times 10^8 > t_{\\text{diss}}$。矿物在时间 $T$ 之前已完全溶解。\n- 因此，$m(T)=0$。\n- $R_{\\text{int}}(T) = m_0 - 0 = m_0 = 0.5\\ \\mathrm{kg}$。\n\n**测试用例 5 ($p=0.0$)：**\n- 参数：$m_0 = 0.1$, $A_0 = 0.01$, $k = 2 \\times 10^{-6}$, $T = 10^7$, $p=0.0$。\n- 这对应于恒定的反应面积，因此是恒定的溶解速率（零级动力学）。\n- 完全溶解所需的时间是：\n  $t_{\\text{diss}} = \\dfrac{m_0}{(1-p)k A_0} = \\dfrac{0.1}{(1-0.0)(2 \\times 10^{-6})(0.01)} = \\dfrac{0.1}{2 \\times 10^{-8}} = 5 \\times 10^6\\ \\mathrm{s}$。\n- 由于 $T = 10^7 > t_{\\text{diss}}$，矿物已完全溶解。\n- 因此，$m(T)=0$。\n- $R_{\\text{int}}(T) = m_0 - 0 = m_0 = 0.1\\ \\mathrm{kg}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the integrated reaction rate R_int(T) for a series of\n    mineral dissolution scenarios in a batch reactor.\n    \"\"\"\n\n    # Test suite:\n    # Each tuple contains:\n    # (model_name, m0, A0, k, T, p)\n    # where the unused rho parameter is omitted.\n    test_cases = [\n        (\"volume-scaling\", 0.5, 0.02, 0.000001, 10000000, None),\n        (\"mass-scaling\", 0.5, 0.02, 0.000001, 10000000, None),\n        (\"fractal-exponent\", 0.5, 0.02, 0.000001, 10000000, 0.8),\n        (\"fractal-exponent\", 0.5, 0.02, 0.000001, 130000000, 0.8),\n        (\"fractal-exponent\", 0.1, 0.01, 0.000002, 10000000, 0.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        model_name, m0, A0, k, T, p_val = case\n        \n        # Determine the exponent p based on the model type\n        if model_name in [\"volume-scaling\", \"mass-scaling\"]:\n            p = 1.0\n        else: # fractal-exponent\n            p = p_val\n            \n        r_int = calculate_integrated_rate(m0, A0, k, T, p)\n        results.append(f\"{r_int:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_integrated_rate(m0, A0, k, T, p):\n    \"\"\"\n    Calculates the integrated rate R_int(T) based on the model exponent p.\n    \n    R_int(T) = m0 - m(T)\n\n    Args:\n        m0 (float): Initial mass in kg.\n        A0 (float): Initial reactive surface area in m^2.\n        k (float): Rate constant in kg m^-2 s^-1.\n        T (float): Total time duration in s.\n        p (float): Fractal exponent.\n\n    Returns:\n        float: Integrated rate R_int(T) in kg.\n    \"\"\"\n    if p == 1.0:\n        # For p=1, dissolution is first-order and never completes in finite time.\n        # m(t) = m0 * exp(-k*A0*t/m0)\n        # R_int(T) = m0 - m(T) = m0 * (1 - exp(-k*A0*T/m0))\n        exponent = -k * A0 * T / m0\n        m_T = m0 * np.exp(exponent)\n        r_int = m0 - m_T\n        return r_int\n    elif 0 = p  1:\n        # For 0 = p  1, dissolution can complete in finite time.\n        # Calculate time to complete dissolution, t_diss.\n        # Handle potential division by zero if k or A0 are zero.\n        if (1 - p) * k * A0 == 0:\n            # No dissolution or ill-defined case, mass doesn't change.\n            return 0.0\n            \n        t_diss = m0 / ((1 - p) * k * A0)\n        \n        if T >= t_diss:\n            # Mineral has completely dissolved by time T.\n            # m(T) = 0, so R_int(T) = m0.\n            return m0\n        else:\n            # Mineral has not completely dissolved.\n            # m(t) = m0 * (1 - t/t_diss)^(1/(1-p))\n            # R_int(T) = m0 - m(T)\n            m_T = m0 * (1 - T / t_diss)**(1 / (1 - p))\n            r_int = m0 - m_T\n            return r_int\n    else:\n        # Invalid value of p\n        raise ValueError(\"The exponent p must be in the range [0, 1].\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们用于描述反应路径的动力学模型，例如前面练习中探讨的那些模型，包含必须通过实验数据确定的经验参数（如速率常数和反应级数）。这个综合性练习将引导你完成一个在计算地球化学中至关重要的完整工作流程：首先，你将构建一个描述长石溶解的多机理速率模型；然后，通过添加模拟噪声生成一组“合成实验数据”；最后，利用非线性最小二乘法对模型参数进行拟合与校准。这项实践将理论模型构建与实际数据分析紧密结合，是反应路径建模中的一项核心技能。",
            "id": "4097811",
            "problem": "要求您设计并实现一个完整的、可运行的程序，在计算地球化学的反应路径模拟框架内，建立并校准一个长石溶解的多机制速率定律。您的程序必须以符合科学原理的方式，从有效的基础定义和定律出发，执行以下任务，并按指定格式生成单行输出。\n\n您必须使用的基本依据如下：\n- 溶解通过平行的基元路径进行，其各自的速率是可加的。在平行机制下，宏观速率是各特定机制速率的总和，因为每条路径都独立地对总通量做出贡献。\n- 氢离子的活度定义为活度的负常用对数：$\\mathrm{pH} = -\\log_{10} a_{\\text{H}^+}$，其中 $a_{\\text{H}^+}$ 是无量纲的。\n- 在温度 $25\\,^\\circ\\mathrm{C}$ 时，水的自递质子平衡由平衡常数 $K_w$ 描述，以活度表示时 $K_w = 10^{-14}$，满足 $a_{\\text{H}^+} a_{\\text{OH}^-} = K_w$。\n- 单位几何面积上的总溶解速率以 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 计算，而基于活度的指数是无量纲的。根据定义，活度是无单位的。\n\n基于这些依据，建立一个长石溶解的速率定律，该定律包含两个平行机制，分别依赖于水合氢离子和氢氧根离子活度的酸催化和碱催化。您的推导应得出一个模型，该模型依赖于 $a_{\\text{H}^+}$ 和 $a_{\\text{OH}^-}$，每个都带有特定机制的指数，并具有特定机制的速率常数。然后，您必须从合成数据中拟合这些指数和速率常数。\n\n数据生成协议：\n- 您将通过为指数和速率常数指定“真实”参数值、从 $\\mathrm{pH}$ 和 $K_w$ 计算活度并评估速率定律来生成合成溶解速率数据。然后，您将通过乘性高斯噪声扰动速率以模拟实验不确定性。具体来说，对于每个真实速率为 $r_{\\text{true}}$ 的数据点，根据 $r_{\\text{obs}} = r_{\\text{true}} \\left( 1 + \\epsilon \\right)$ 生成一个观测速率 $r_{\\text{obs}}$，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma)$，标准差 $\\sigma$ 按每个测试案例指定。如果 $r_{\\text{obs}} \\le 0$，则用一个小的正数下限（如 $10^{-30}$）替换它，以保持物理真实性。\n\n参数估计协议：\n- 通过使用非线性最小二乘法 (NLLS) 最小化整个数据集中观测速率与模型预测速率之间的残差平方和，来拟合特定机制的指数和速率常数。对速率常数使用非负约束，并为指数设置合理的界限（例如，在 $0$ 和 $3$ 之间，以反映典型的催化级数）。提供正值且具有物理意义的初始猜测值。\n- 报告整个数据集中残差的均方根 (RMS)，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n活度计算：\n- 对于每个具有指定 $\\mathrm{pH}$ 的数据点，计算 $a_{\\text{H}^+} = 10^{-\\mathrm{pH}}$ 和 $a_{\\text{OH}^-} = \\dfrac{K_w}{a_{\\text{H}^+}}$，其中 $K_w = 10^{-14}$，所有量均为无量纲。\n\n测试套件：\n您必须实现三个不同的测试案例，通过改变真实参数和噪声水平来确保覆盖酸主导、碱主导和混合机制。使用固定的随机种子以确保不同运行之间的可复现性。\n\n- 测试案例 1（混合贡献）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 1.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{H}^+} = 0.50$，$k_{\\mathrm{OH}^-} = 5.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{OH}^-} = 0.70$。\n  - 噪声标准差：$\\sigma = 0.05$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{2, 3, 4, 5, 6, 7, 8, 9, 10, 12\\}$。\n\n- 测试案例 2（酸主导）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 3.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{H}^+} = 0.90$，$k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{OH}^-} = 1.20$。\n  - 噪声标准差：$\\sigma = 0.02$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{1, 2, 3, 4, 6, 7, 8, 9\\}$。\n\n- 测试案例 3（碱主导）：\n  - 真实参数：$k_{\\mathrm{H}^+} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{H}^+} = 0.60$，$k_{\\mathrm{OH}^-} = 2.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{OH}^-} = 0.80$。\n  - 噪声标准差：$\\sigma = 0.05$（相对值，无量纲）。\n  - $\\mathrm{pH}$ 网格：$\\{7, 8, 9, 10, 11, 12, 13\\}$。\n\n实现要求：\n- 使用 $K_w = 10^{-14}$ 且温度固定在 $25\\,^\\circ\\mathrm{C}$。\n- 在开始时用 $42$ 作为随机数生成器的种子，且只设置一次。\n- 对于 NLLS，选择初始猜测值 $k_{\\mathrm{H}^+} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{H}^+} = 0.50$，$k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$n_{\\mathrm{OH}^-} = 0.50$，界限为 $k_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-} \\in [10^{-20}, 10^{-6}]$ 和 $n_{\\mathrm{H}^+}, n_{\\mathrm{OH}^-} \\in [0, 3]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果。对于每个测试案例，按以下顺序输出拟合的指数和速率常数以及 RMS 残差：\n  - $n_{\\mathrm{H}^+}$，$n_{\\mathrm{OH}^-}$，$k_{\\mathrm{H}^+}$，$k_{\\mathrm{OH}^-}$，$\\mathrm{RMS}$。\n- 将三个测试案例的输出按顺序连接成一个扁平列表。所有值均以科学记数法表示的浮点数打印，小数点后保留六位数字。例如：$\\left[\\text{case1\\_}n_{\\mathrm{H}^+},\\text{case1\\_}n_{\\mathrm{OH}^-},\\text{case1\\_}k_{\\mathrm{H}^+},\\text{case1\\_}k_{\\mathrm{OH}^-},\\text{case1\\_}\\mathrm{RMS},\\text{case2\\_}\\ldots,\\text{case3\\_}\\ldots\\right]$。\n\n单位和报告：\n- 所有速率和速率常数均以 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 表示。\n- 指数是无量纲的。\n- 活度是无量纲的。\n\n您的程序必须是完全自包含的，不接受用户输入，并严格遵守指定的输出格式。环境为 Python $3.12$ 及指定的库。程序打印的最后一行必须只包含方括号列表，不得有任何附加文本。",
            "solution": "问题陈述是有效的。它在科学上基于化学动力学和计算地球化学的原理，问题定义良好（良态），目标明确，数据充分，并以精确、客观的语言表述。因此，我们将提供一个完整的解决方案。\n\n核心任务是建立并校准长石溶解的多机制速率定律。这涉及三个主要阶段：(1) 基于地球化学原理定义数学模型，(2) 根据指定的统计模型生成合成实验数据，以及 (3) 执行非线性最小二乘法 (NLLS) 回归，从合成数据中估计模型参数。\n\n**1. 模型建立**\n\n总溶解速率 $R$ 被建模为独立、平行的反应路径速率之和。问题指定了两种这样的路径：一种由酸（水合氢离子，$\\text{H}^+$）催化，另一种由碱（氢氧根离子，$\\text{OH}^-$）催化。因此，总速率 $R$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）由以下公式给出：\n$$\nR = R_{\\text{acid}} + R_{\\text{base}}\n$$\n每条路径的速率由对催化物质活度的幂律依赖关系描述。这是源自过渡态理论的常见公式。酸催化机制的速率 $R_{\\text{acid}}$ 和碱催化机制的速率 $R_{\\text{base}}$ 分别由以下公式给出：\n$$\nR_{\\text{acid}} = k_{\\text{H}^+} a_{\\text{H}^+}^{n_{\\text{H}^+}}\n$$\n$$\nR_{\\text{base}} = k_{\\text{OH}^-} a_{\\text{OH}^-}^{n_{\\text{OH}^-}}\n$$\n此处，$k_{\\text{H}^+}$ 和 $k_{\\text{OH}^-}$ 是特定机制的速率常数（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），$a_{\\text{H}^+}$ 和 $a_{\\text{OH}^-}$ 是水合氢离子和氢氧根离子的无量纲活度，$n_{\\text{H}^+}$ 和 $n_{\\text{OH}^-}$ 是每条路径的无量纲反应级数（指数）。\n\n完整的速率定律是这两个贡献的总和：\n$$\nR = k_{\\text{H}^+} a_{\\text{H}^+}^{n_{\\text{H}^+}} + k_{\\text{OH}^-} a_{\\text{OH}^-}^{n_{\\text{OH}^-}}\n$$\n离子物质的活度与溶液的 $\\mathrm{pH}$ 相关。根据定义，$\\mathrm{pH} = -\\log_{10} a_{\\text{H}^+}$，可得：\n$$\na_{\\text{H}^+} = 10^{-\\mathrm{pH}}\n$$\n氢氧根离子的活度通过水的自递质子平衡常数 $K_w = a_{\\text{H}^+} a_{\\text{OH}^-}$ 与水合氢离子的活度相关。在指定温度 $25\\,^\\circ\\mathrm{C}$ 下，$K_w = 10^{-14}$。因此：\n$$\na_{\\text{OH}^-} = \\frac{K_w}{a_{\\text{H}^+}} = \\frac{10^{-14}}{10^{-\\mathrm{pH}}} = 10^{\\mathrm{pH}-14}\n$$\n将这些活度表达式代入速率定律，得到最终模型，该模型是 $\\mathrm{pH}$ 和四个待拟合参数（$\\vec{p} = [k_{\\text{H}^+}, n_{\\text{H}^+}, k_{\\text{OH}^-}, n_{\\text{OH}^-}]$）的函数：\n$$\nR(\\mathrm{pH}; \\vec{p}) = k_{\\text{H}^+} (10^{-\\mathrm{pH}})^{n_{\\text{H}^+}} + k_{\\text{OH}^-} (10^{\\mathrm{pH}-14})^{n_{\\text{OH}^-}}\n$$\n此函数构成了数据生成和参数估计的基础。\n\n**2. 数据合成**\n\n为了模拟实验数据，我们首先使用上述模型和一组给定的真实参数（$k_{\\text{H}^+\\text{,true}}$, $n_{\\text{H}^+\\text{,true}}$ 等）在不同的 $\\mathrm{pH}_i$ 值下计算一组“真实”溶解速率（$r_{\\text{true},i}$）。然后通过乘性高斯噪声扰动这些真实速率来模拟实验不确定性。每个观测速率 $r_{\\text{obs},i}$ 由每个真实速率根据以下公式生成：\n$$\nr_{\\text{obs},i} = r_{\\text{true},i} (1 + \\epsilon_i)\n$$\n其中 $\\epsilon_i$ 是从均值为 $0$、标准差为 $\\sigma$ 的正态分布中抽取的随机变量，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma)$。标准差 $\\sigma$ 代表相对噪声水平。为了保持物理真实性，任何得到的非正速率（$r_{\\text{obs},i} \\le 0$）都将被替换为一个小的正数下限值 $10^{-30}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。使用固定的随机种子 $42$ 可确保生成数据集的可复现性。\n\n**3. 参数估计与性能评估**\n\n反问题是从合成的“观测”数据 $( \\mathrm{pH}_i, r_{\\text{obs},i} )$ 中估计四个模型参数 $\\vec{p} = [k_{\\text{H}^+}, n_{\\text{H}^+}, k_{\\text{OH}^-}, n_{\\text{OH}^-}]$。我们使用非线性最小二乘法 (NLLS)。这涉及找到参数向量 $\\vec{p}_{\\text{fit}}$，以最小化观测速率与模型预测速率之间的残差平方和 (SSR)：\n$$\n\\mathrm{SSR}(\\vec{p}) = \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}) \\right)^2\n$$\n其中 $N$ 是数据点的数量。此最小化过程使用 `scipy.optimize.least_squares` 函数进行数值计算，该函数非常适合此任务。优化过程受到参数的物理意义界限的约束：速率常数必须为正（$k_{\\text{H}^+}, k_{\\text{OH}^-} \\in [10^{-20}, 10^{-6}]$），反应级数通常是小的正数（$n_{\\text{H}^+}, n_{\\text{OH}^-} \\in [0, 3]$）。为指导算法，需要提供参数的初始猜测值。\n\n拟合优度通过残差的均方根 (RMS) 来量化，其单位与速率相同，并提供了模型预测平均误差的度量：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{\\mathrm{SSR}(\\vec{p}_{\\text{fit}})}{N}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}_{\\text{fit}}) \\right)^2}\n$$\n对问题陈述中定义的三个测试案例中的每一个都重复此过程，并报告所得的拟合参数和 RMS 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Formulates and calibrates a multi-mechanism rate law for feldspar dissolution.\n    Generates synthetic data, fits parameters using NLLS, and reports the results.\n    \"\"\"\n    np.random.seed(42)  # Seed for reproducibility\n    K_w = 1e-14\n    \n    # Define the three test cases as specified in the problem statement\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (mixed contributions)\",\n            \"true_params\": {\"k_H\": 1.0e-10, \"n_H\": 0.50, \"k_OH\": 5.0e-11, \"n_OH\": 0.70},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([2, 3, 4, 5, 6, 7, 8, 9, 10, 12]),\n        },\n        {\n            \"name\": \"Test Case 2 (acid-dominated)\",\n            \"true_params\": {\"k_H\": 3.0e-10, \"n_H\": 0.90, \"k_OH\": 1.0e-12, \"n_OH\": 1.20},\n            \"sigma\": 0.02,\n            \"ph_grid\": np.array([1, 2, 3, 4, 6, 7, 8, 9]),\n        },\n        {\n            \"name\": \"Test Case 3 (base-dominated)\",\n            \"true_params\": {\"k_H\": 1.0e-12, \"n_H\": 0.60, \"k_OH\": 2.0e-10, \"n_OH\": 0.80},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([7, 8, 9, 10, 11, 12, 13]),\n        },\n    ]\n\n    # Parameter order for optimization: [k_H, n_H, k_OH, n_OH]\n    initial_guesses = np.array([1.0e-11, 0.50, 1.0e-11, 0.50])\n    bounds = (\n        [1e-20, 0, 1e-20, 0],       # Lower bounds\n        [1e-6, 3, 1e-6, 3]          # Upper bounds\n    )\n    \n    # Store all results in a flat list\n    all_results = []\n\n    def rate_model(params, ph_values):\n        \"\"\"\n        Calculates dissolution rate based on the two-mechanism model.\n        params: [k_H, n_H, k_OH, n_OH]\n        \"\"\"\n        k_H, n_H, k_OH, n_OH = params\n        a_H = 10.0**(-ph_values)\n        a_OH = K_w / a_H\n        rate = k_H * (a_H**n_H) + k_OH * (a_OH**n_OH)\n        return rate\n\n    for case in test_cases:\n        true_params_vec = np.array([\n            case[\"true_params\"][\"k_H\"],\n            case[\"true_params\"][\"n_H\"],\n            case[\"true_params\"][\"k_OH\"],\n            case[\"true_params\"][\"n_OH\"],\n        ])\n        \n        # 1. Generate synthetic data\n        true_rates = rate_model(true_params_vec, case[\"ph_grid\"])\n        noise = np.random.normal(0, case[\"sigma\"], size=len(case[\"ph_grid\"]))\n        observed_rates = true_rates * (1 + noise)\n        \n        # Apply floor value for non-positive rates\n        observed_rates[observed_rates = 0] = 1e-30\n        \n        # 2. Define the residual function for least_squares\n        def residuals(params, ph_values, obs_rates):\n            return rate_model(params, ph_values) - obs_rates\n\n        # 3. Perform Non-Linear Least Squares fitting\n        result = least_squares(\n            residuals,\n            initial_guesses,\n            bounds=bounds,\n            args=(case[\"ph_grid\"], observed_rates)\n        )\n        \n        fitted_params = result.x\n        \n        # 4. Calculate RMS of the residuals\n        final_residuals = residuals(fitted_params, case[\"ph_grid\"], observed_rates)\n        rms = np.sqrt(np.mean(final_residuals**2))\n        \n        # 5. Extract fitted parameters\n        k_H_fit, n_H_fit, k_OH_fit, n_OH_fit = fitted_params\n        \n        # Append results in the specified order: nH+, nOH-, kH+, kOH-, RMS\n        case_results = [n_H_fit, n_OH_fit, k_H_fit, k_OH_fit, rms]\n        all_results.extend(case_results)\n\n    # 6. Format and print the final output\n    formatted_results = [f\"{val:.6e}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}