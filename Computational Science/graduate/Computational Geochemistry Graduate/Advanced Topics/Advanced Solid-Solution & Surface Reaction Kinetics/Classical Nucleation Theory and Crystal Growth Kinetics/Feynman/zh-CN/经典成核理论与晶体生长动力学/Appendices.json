{
    "hands_on_practices": [
        {
            "introduction": "在构建任何成核动力学模型之前，我们必须首先深入理解控制整个过程的核心——成核能垒（$\\Delta G^*$）。本练习将引导你从经典成核理论（CNT）的第一性原理出发，推导关键参数，如临界半径（$r^*$）和成核能垒（$\\Delta G^*$）。通过进行灵敏度分析，你将揭示为何准确测量界面能（$\\gamma$）对于预测成核速率至关重要，这是所有地球化学建模工作的基础。",
            "id": "4072944",
            "problem": "在经典成核理论（CNT）的框架下，考虑从过饱和水溶液中成核形成新的矿物相。对于一个球形核，其可逆形成功是半径的函数，由表面贡献和体积贡献之和给出，\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v},\n$$\n其中 $\\gamma > 0$ 是单位面积的各向同性固-溶界面自由能，而 $\\Delta G_{v}  0$ 是与向稳定相转变相关的单位体积吉布斯自由能变（在过饱和条件下为负值）。假设除 $\\gamma$ 外的所有其他参数均为已知且固定。\n\n从上述基本表达式出发，通过适当的极值条件推导出临界半径 $r^{*}$ 和成核势垒 $\\Delta G^{*}$。然后，使用对数导数来量化 $r^{*}$ 和 $\\Delta G^{*}$ 对 $\\gamma$ 不确定性的敏感性，对于一个量 $y$ 相对于 $x$ 的对数导数定义为 $\\partial \\ln y / \\partial \\ln x$，并保持其他变量不变。假设线性化有效，使用这些敏感性系数将 $\\gamma$ 的一个小的分数不确定度 $\\delta\\gamma/\\gamma = 0.10$ 传递到 $r^{*}$ 和 $\\Delta G^{*}$。\n\n以无量纲小数形式报告数对 $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$，四舍五入到四位有效数字，并以行矩阵的形式呈现您的最终答案。",
            "solution": "该问题要求我们在经典成核理论（CNT）的框架内，分析临界成核半径 $r^{*}$ 和成核势垒 $\\Delta G^{*}$ 对界面自由能 $\\gamma$ 的敏感性。\n\n首先，我们必须推导 $r^{*}$ 和 $\\Delta G^{*}$ 的表达式。球形核的可逆形成功 $\\Delta G(r)$ 如下所示：\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v}\n$$\n参数包括半径 $r$、界面自由能 $\\gamma  0$ 以及单位体积的体相吉布斯自由能变 $\\Delta G_{v}  0$。临界半径 $r^{*}$ 对应于该函数的最大值，该最大值代表了成核能垒的峰值。为了找到这个极值，我们将 $\\Delta G(r)$ 对 $r$ 求导，并令其导数为零：\n$$\n\\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v} \\right) = 0\n$$\n$$\n8\\pi r\\gamma + 4\\pi r^{2}\\Delta G_{v} = 0\n$$\n对于非平凡的核（$r \\neq 0$），我们可以除以 $4\\pi r$：\n$$\n2\\gamma + r\\Delta G_{v} = 0\n$$\n求解 $r$ 得到临界半径 $r^{*}$：\n$$\nr^{*} = -\\frac{2\\gamma}{\\Delta G_{v}}\n$$\n由于 $\\gamma  0$ 且 $\\Delta G_{v}  0$，所以 $r^{*}$ 为正值，这符合物理半径的要求。为确认这是一个最大值，我们可以检验二阶导数：\n$$\n\\frac{d^{2}(\\Delta G(r))}{dr^{2}} = \\frac{d}{dr}(8\\pi r\\gamma + 4\\pi r^{2}\\Delta G_{v}) = 8\\pi\\gamma + 8\\pi r\\Delta G_{v}\n$$\n在 $r=r^{*}$ 处求值：\n$$\n\\left. \\frac{d^{2}(\\Delta G(r))}{dr^{2}} \\right|_{r=r^{*}} = 8\\pi\\gamma + 8\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right) \\Delta G_{v} = 8\\pi\\gamma - 16\\pi\\gamma = -8\\pi\\gamma\n$$\n由于 $\\gamma  0$，二阶导数为负，这证实了 $r^{*}$ 对应于一个局部最大值，即成核势垒。\n\n此势垒的高度 $\\Delta G^{*}$，可通过将 $r=r^{*}$ 代回 $\\Delta G(r)$ 的表达式中求得：\n$$\n\\Delta G^{*} = \\Delta G(r^{*}) = 4\\pi (r^{*})^{2}\\gamma + \\frac{4}{3}\\pi (r^{*})^{3}\\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right)^{2}\\gamma + \\frac{4}{3}\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right)^{3} \\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(\\frac{4\\gamma^{2}}{(\\Delta G_{v})^{2}}\\right)\\gamma + \\frac{4}{3}\\pi \\left(-\\frac{8\\gamma^{3}}{(\\Delta G_{v})^{3}}\\right) \\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}} - \\frac{32\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\left(1 - \\frac{2}{3}\\right) \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}} = \\frac{1}{3} \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}\n$$\n\n接下来，我们使用对数导数来量化 $r^{*}$ 和 $\\Delta G^{*}$ 对 $\\gamma$ 的敏感性。一个量 $y$ 相对于 $x$ 的对数导数定义为 $\\frac{\\partial \\ln y}{\\partial \\ln x}$。该系数直接将 $y$ 的分数变化与 $x$ 的分数变化联系起来。\n\n对于临界半径 $r^{*}$：\n敏感性系数为 $S_{\\gamma}^{r^{*}} = \\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}$。\n我们有 $r^{*} = -\\frac{2\\gamma}{\\Delta G_{v}}$。对两边取自然对数：\n$$\n\\ln(r^{*}) = \\ln\\left(-\\frac{2}{\\Delta G_{v}}\\right) + \\ln(\\gamma)\n$$\n对 $\\ln(\\gamma)$ 求导，并保持所有其他参数不变：\n$$\n\\frac{\\partial \\ln(r^{*})}{\\partial \\ln(\\gamma)} = 0 + 1 = 1\n$$\n因此，$r^{*}$ 对 $\\gamma$ 的敏感性为 $1$。\n\n对于成核势垒 $\\Delta G^{*}$：\n敏感性系数为 $S_{\\gamma}^{\\Delta G^{*}} = \\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}$。\n我们有 $\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}$。取自然对数：\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta G_{v})^{2}}\\right) + \\ln(\\gamma^{3})\n$$\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta G_{v})^{2}}\\right) + 3\\ln(\\gamma)\n$$\n对 $\\ln(\\gamma)$ 求导：\n$$\n\\frac{\\partial \\ln(\\Delta G^{*})}{\\partial \\ln(\\gamma)} = 0 + 3 = 3\n$$\n因此，$\\Delta G^{*}$ 对 $\\gamma$ 的敏感性为 $3$。\n\n最后，我们传递给定的 $\\gamma$ 的分数不确定度，以找到 $r^{*}$ 和 $\\Delta G^{*}$ 中相应的分数不确定度。对于小的分数变化，线性化是有效的，我们可以使用以下近似：\n$$\n\\frac{\\delta y}{y} \\approx \\left(\\frac{\\partial \\ln y}{\\partial \\ln x}\\right) \\frac{\\delta x}{x}\n$$\n给定 $\\frac{\\delta\\gamma}{\\gamma} = 0.10$。\n\n$r^{*}$ 的分数不确定度为：\n$$\n\\frac{\\delta r^{*}}{r^{*}} \\approx \\left(\\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (1)(0.10) = 0.10\n$$\n这意味着 $\\gamma$ 中 $10\\%$ 的不确定度会导致 $r^{*}$ 中 $10\\%$ 的不确定度。\n\n$\\Delta G^{*}$ 的分数不确定度为：\n$$\n\\frac{\\delta \\Delta G^{*}}{\\Delta G^{*}} \\approx \\left(\\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (3)(0.10) = 0.30\n$$\n这意味着 $\\gamma$ 中 $10\\%$ 的不确定度会导致 $\\Delta G^{*}$ 中 $30\\%$ 的不确定度，这突显了成核势垒对界面能的高度敏感性。\n\n问题要求以四位有效数字的十进制小数形式给出数对 $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$。\n$$\n\\frac{\\delta r^{*}}{r^{*}} = 0.1000\n$$\n$$\n\\frac{\\delta \\Delta G^{*}}{r^{*}} = 0.3000\n$$\n该数对以行矩阵形式表示。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  0.3000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "成核只是晶体生命周期的开始，界面能不仅决定了晶体的诞生，也主导着其后续的生长行为。本练习将前一问题的概念延伸至生长动力学，重点探讨Gibbs-Thomson效应，即晶体表面的曲率如何改变局部平衡条件。通过这个实践，你将理解几何形状如何影响热力学，例如在纳米孔隙等受限空间内，凹面可以产生局部过饱和，从而在宏观饱和的溶液中驱动晶体生长。",
            "id": "4072993",
            "problem": "一种微溶矿物相正在纳米多孔二氧化硅基质内的电解质水溶液中沉淀。考虑一个凹的晶体-流体界面，该界面可局部近似为半径为 $R$ 的球面的一部分，当表面朝向溶液凸起时，$R$ 计为正，当表面朝向溶液凹陷时，$R$ 计为负。该矿物通过从溶液中并入分子体积为 $\\Omega$ 的生长单元而生长。假设矿物-流体界面的比表面自由能 $\\gamma$ 是各向同性的。环境溶液的温度为 $T$，且相对于该矿物的平面界面恰好饱和，因此其远场活度 $a_{\\mathrm{bulk}}$ 等于平面平衡活度 $a_{\\mathrm{eq}}(0)$。\n\n从相平衡时化学势相等的条件出发，结合理想稀溶液中化学势的定义 $ \\mu_{\\mathrm{solute}} = \\mu^{\\circ} + k_{B} T \\ln a$（其中 $k_{B}$ 是玻尔兹曼常数，$a$ 是活度），以及固相化学势因压力引起的移动的毛细关系 $d\\mu_{\\mathrm{solid}} = \\Omega \\, dP$ 和曲面界面的拉普拉斯压力（平均曲率 $\\kappa = \\frac{1}{R_{1}} + \\frac{1}{R_{2}}$），推导曲面界面处的局部平衡活度 $a_{\\mathrm{eq}}(\\kappa)$ 的表达式，然后求出凹面处的局部过饱和度\n$$\nS \\equiv \\frac{a_{\\mathrm{bulk}}}{a_{\\mathrm{eq}}(\\kappa)} - 1\n$$\n\n对于主曲率半径为 $R_{1} = R_{2} = -R$ 的重入凹面，使用以下物理上一致的参数：\n- $R = 20 \\,\\mathrm{nm}$，\n- $\\gamma = 0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2}$，\n- $\\Omega = 4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}$，\n- $T = 298 \\,\\mathrm{K}$，\n- $k_{B} = 1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}$。\n\n将 $S$ 的最终数值表示为小数，并四舍五入到三位有效数字。由于 $S$ 是无量纲的，最终答案中不需要单位。",
            "solution": "问题要求推导凹的矿物-流体界面处的局部过饱和度 $S$，并进行数值计算。推导从相平衡的基本条件开始：两相中物种的化学势相等。\n\n在曲面界面的局部平衡状态下，固相中矿物的化学势 $\\mu_{\\mathrm{solid}}(\\kappa)$ 必须等于相邻溶液中溶质的化学势 $\\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(\\kappa))$，其中 $a_{\\mathrm{eq}}(\\kappa)$ 是平均曲率为 $\\kappa$ 的界面处的局部平衡活度。\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) = \\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(\\kappa))\n$$\n问题提供了一个理想稀溶液中溶质化学势的模型：\n$$\n\\mu_{\\mathrm{solute}}(a) = \\mu^{\\circ} + k_{B} T \\ln a\n$$\n其中 $\\mu^{\\circ}$ 是标准化学势，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，$a$ 是溶质的活度。\n\n固相的化学势取决于压力 $P$。固相化学势的变化由毛细关系给出：\n$$\nd\\mu_{\\mathrm{solid}} = \\Omega \\, dP\n$$\n其中 $\\Omega$ 是生长单元的分子体积。根据杨-拉普拉斯方程，跨越曲面界面的压力差为 $\\Delta P = P_{\\mathrm{solid}} - P_{\\mathrm{fluid}} = \\gamma \\kappa$，其中 $\\gamma$ 是比表面自由能，$\\kappa$ 是平均曲率。曲面界面处固体的化学势 $\\mu_{\\mathrm{solid}}(\\kappa)$ 可以通过将毛细关系从流体压力（对应于平面界面，$\\kappa=0$）积分到曲面界面处的固体压力，来与其在平面界面处的值 $\\mu_{\\mathrm{solid}}(0)$ 联系起来。假设 $\\Omega$ 与压力无关，我们有：\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) - \\mu_{\\mathrm{solid}}(0) = \\int_{P_{\\mathrm{fluid}}}^{P_{\\mathrm{solid}}} \\Omega \\, dP = \\Omega (P_{\\mathrm{solid}} - P_{\\mathrm{fluid}}) = \\Omega \\gamma \\kappa\n$$\n因此，曲面界面处固体的化学势为：\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) = \\mu_{\\mathrm{solid}}(0) + \\Omega \\gamma \\kappa\n$$\n现在，我们将化学势的表达式代入局部平衡条件中：\n$$\n\\mu_{\\mathrm{solid}}(0) + \\Omega \\gamma \\kappa = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(\\kappa)\n$$\n对于平面界面（$\\kappa=0$），系统也处于平衡状态，平衡活度记为 $a_{\\mathrm{eq}}(0)$。平面界面的平衡条件是：\n$$\n\\mu_{\\mathrm{solid}}(0) = \\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(0)) = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(0)\n$$\n将 $\\mu_{\\mathrm{solid}}(0)$ 的这个表达式代入曲面界面的方程中，得到：\n$$\n(\\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(0)) + \\Omega \\gamma \\kappa = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(\\kappa)\n$$\n通过消去 $\\mu^{\\circ}$ 并重新整理对数项来简化：\n$$\nk_{B} T (\\ln a_{\\mathrm{eq}}(\\kappa) - \\ln a_{\\mathrm{eq}}(0)) = \\Omega \\gamma \\kappa\n$$\n$$\nk_{B} T \\ln\\left(\\frac{a_{\\mathrm{eq}}(\\kappa)}{a_{\\mathrm{eq}}(0)}\\right) = \\Omega \\gamma \\kappa\n$$\n求解局部平衡活度 $a_{\\mathrm{eq}}(\\kappa)$ 得到吉布斯-汤姆逊方程：\n$$\na_{\\mathrm{eq}}(\\kappa) = a_{\\mathrm{eq}}(0) \\exp\\left(\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right)\n$$\n这就是所求的曲面界面处局部平衡活度的表达式。接下来，我们推导局部过饱和度 $S$，其定义为：\n$$\nS \\equiv \\frac{a_{\\mathrm{bulk}}}{a_{\\mathrm{eq}}(\\kappa)} - 1\n$$\n问题指出，环境体相溶液相对于平面界面是恰好饱和的，这意味着 $a_{\\mathrm{bulk}} = a_{\\mathrm{eq}}(0)$。将此条件和推导出的 $a_{\\mathrm{eq}}(\\kappa)$ 表达式代入 $S$ 的定义中：\n$$\nS = \\frac{a_{\\mathrm{eq}}(0)}{a_{\\mathrm{eq}}(0) \\exp\\left(\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right)} - 1 = \\exp\\left(-\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right) - 1\n$$\n对于主曲率半径为 $R_{1} = R_{2} = -R$ 的重入凹面这一特定情况，平均曲率 $\\kappa$ 为：\n$$\n\\kappa = \\frac{1}{R_{1}} + \\frac{1}{R_{2}} = \\frac{1}{-R} + \\frac{1}{-R} = -\\frac{2}{R}\n$$\n将这个特定的曲率代入 $S$ 的表达式中：\n$$\nS = \\exp\\left(-\\frac{\\Omega \\gamma}{k_{B} T} \\left(-\\frac{2}{R}\\right)\\right) - 1 = \\exp\\left(\\frac{2 \\Omega \\gamma}{k_{B} T R}\\right) - 1\n$$\n现在，我们代入给定的数值：\n$R = 20 \\,\\mathrm{nm} = 20 \\times 10^{-9} \\,\\mathrm{m}$\n$\\gamma = 0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n$\\Omega = 4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}$\n$T = 298 \\,\\mathrm{K}$\n$k_{B} = 1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n\n首先，我们计算无量纲的指数：\n$$\n\\frac{2 \\Omega \\gamma}{k_{B} T R} = \\frac{2 \\times (4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}) \\times (0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2})}{(1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}) \\times (298 \\,\\mathrm{K}) \\times (20 \\times 10^{-9} \\,\\mathrm{m})}\n$$\n$$\n\\frac{2 \\Omega \\gamma}{k_{B} T R} = \\frac{1.6 \\times 10^{-29} \\,\\mathrm{J} \\cdot \\mathrm{m}}{8.228608 \\times 10^{-29} \\,\\mathrm{J} \\cdot \\mathrm{m}} \\approx 0.1944458\n$$\n现在，我们计算 $S$：\n$$\nS = \\exp(0.1944458) - 1 \\approx 1.214643 - 1 = 0.214643\n$$\n将结果四舍五入到三位有效数字，得到：\n$$\nS \\approx 0.215\n$$\n$S$ 的正值表明，相对于凹面界面，溶液是过饱和的，这有利于晶体向孔隙空间内生长，即使该溶液相对于平坦表面仅为饱和状态。",
            "answer": "$$\\boxed{0.215}$$"
        },
        {
            "introduction": "现在，我们将理论知识与计算实践相结合，以模拟动态地球化学过程。真实的系统，如冷却的岩浆或蒸发的水体，其过饱和度是随时间变化的，这就要求我们建立一个能够反映这些变化的动力学模型。这个综合性练习要求你将成核能垒和动力学前置因子整合成一个依赖于时间的成核速率方程 $J(t)$，并编写程序来计算和积分该速率，最终预测在不断变化的条件下形成的晶体总数——这是计算地球化学领域的一项核心技能。",
            "id": "4072988",
            "problem": "一种在水环境中进行均相结晶的溶液，其驱动力是随时间变化的过饱和度 $S(t)$。该过饱和度在斜坡持续时间 $\\tau$ 内从初始过饱和度 $S_i$ 线性增加（一个斜坡）到最终过饱和度 $S_f$，此后保持恒定。具体来说，对于以秒为单位的时间 $t$，过饱和度定义为\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},   0 \\le t \\le \\tau, \\\\\nS_f,   t  \\tau.\n\\end{cases}\n$$\n假设溶液中球形核的均相成核与生长遵循经典成核理论 (CNT) 的框架，该理论通过表面能和体积自由能之间的竞争来模拟形成一个包含 $n$ 个生长单元的团簇所需的可逆功。从计算地球化学的角度出发，基于以下基本原理：\n- 形成一个包含 $n$ 个生长单元的团簇所需的可逆自由能是表面能项和由过饱和度驱动的体相自由能项之和。设分子（或生长单元）的体积为 $v_m$（单位 $\\mathrm{m}^3$），界面能为 $\\gamma$（单位 $\\mathrm{J}\\,\\mathrm{m}^{-2}$），在绝对温度 $T$（单位 K）下，热能为 $k_B T$，其中玻尔兹曼常数 $k_B$ 的单位为 $\\mathrm{J}\\,\\mathrm{K}^{-1}$。过饱和度通过化学势差 $\\Delta \\mu(t)$ 发挥作用，其中对于 $S(t)  1$，有 $\\Delta \\mu(t) = k_B T \\ln S(t)$。\n- 对于球形团簇，表面能前因子根据几何关系随 $n$ 的幂次变化，而体积自由能随 $n$ 线性变化。利用这些几何和热力学事实，从第一性原理推导出临界团簇尺寸 $n^\\*(t)$、临界半径 $r^\\*(t)$、成核势垒 $\\Delta G^\\*(t)$ 和泽尔多维奇因子 $Z(t)$。\n- 对于扩散系数为 $D$（单位 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）、单体数密度为 $c_m$（单位 $\\mathrm{m}^{-3}$）的单体的扩散限制附着过程，到达临界团簇的单体速率可以与到半径为 $r^\\*(t)$ 的汇的球形扩散通量相关联。利用这一物理图像来构建在跨越势垒坐标处的适当附着频率。\n- 稳态 CNT 成核速率 $J(t)$（单位 $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）结合了跨越势垒的概率和一个动力学前因子。实现 $J(t)$，使其在 $S(t) \\le 1$（未饱和或饱和条件）时为零，并在 $S(t)  1$ 时遵循适当的热激活形式。\n- 在时间 $t$ 内，单位体积内预期的累积核数 $N(t)$（单位 $\\mathrm{m}^{-3}$）是 $J(t')$ 从 $t'=0$ 到 $t'=t$ 的积分。\n\n您的任务是：\n1. 基于此基础推导 $J(t)$ 和 $N(t)$，确保所有步骤都有物理解释且量纲一致。\n2. 实现一个程序，为下面的每个测试用例计算：\n   - 瞬时成核速率 $J(t_{\\text{end}})$，单位为 $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n   - 通过对 $J(t)$ 从 $t=0$ 到 $t=t_{\\text{end}}$ 积分得到的累积核数 $N(t_{\\text{end}})$，单位为 $\\mathrm{m}^{-3}$。\n3. 使用以下以国际单位制 (SI) 表示的参数集测试套件。在所有情况下，设置潜在胚胎位置的数密度 $n_s = c_m$，等于单体数密度：\n   - A例（通用斜坡，斜坡后评估）：$\\gamma = 0.2\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$， $v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$， $c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$， $T = 298\\,\\mathrm{K}$， $S_i = 1.01$，$S_f = 1.5$, $\\tau = 100\\,\\mathrm{s}$, $t_{\\text{end}} = 200\\,\\mathrm{s}$。\n   - B例（近饱和边界，在斜坡结束时评估）：$\\gamma = 0.2\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$，$v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 298\\,\\mathrm{K}$，$S_i = 0.99$，$S_f = 1.02$, $\\tau = 50\\,\\mathrm{s}$, $t_{\\text{end}} = 50\\,\\mathrm{s}$。\n   - C例（高过饱和度，快速斜坡）：$\\gamma = 0.05\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$，$v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 2.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$c_m = 5.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 298\\,\\mathrm{K}$，$S_i = 1.1$，$S_f = 3.0$, $\\tau = 10\\,\\mathrm{s}$, $t_{\\text{end}} = 10\\,\\mathrm{s}$。\n   - D例（中等过饱和度，高温，长时斜坡后积分）：$\\gamma = 0.1\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$，$v_m = 8.0 \\times 10^{-29}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$c_m = 2.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 323\\,\\mathrm{K}$，$S_i = 1.02$，$S_f = 2.0$, $\\tau = 200\\,\\mathrm{s}$, $t_{\\text{end}} = 500\\,\\mathrm{s}$。\n\n本问题不涉及角度单位。不使用百分比；过饱和度直接定义为无量纲比率。所有输出必须按规定以国际单位制表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，浮点数按以下顺序排列：\n$$\n[\\; J_A(t_{\\text{end}}),\\; N_A(t_{\\text{end}}),\\; J_B(t_{\\text{end}}),\\; N_B(t_{\\text{end}}),\\; J_C(t_{\\text{end}}),\\; N_C(t_{\\text{end}}),\\; J_D(t_{\\text{end}}),\\; N_D(t_{\\text{end}}) \\;].\n$$",
            "solution": "该问题具有科学依据，是适定的，并包含了获得唯一解所需的所有信息。这是经典成核理论 (CNT) 在时变过饱和度情景下的直接应用，是计算材料科学和地球化学中的一个标准问题。所提供的参数在物理上是现实的。因此，该问题是有效的。\n\n求解过程需要按照问题陈述中概述的那样，从第一性原理推导随时变的成核速率 $J(t)$ 和累积核数 $N(t)$ 的表达式。这涉及到结合球形团簇均相成核的热力学和动力学方面。\n\n首先，我们将过饱和度 $S(t)$ 定义为时间 $t$ 的函数。对于 $t \\in [0, \\tau]$，过饱和度从初始值 $S_i$ 线性增加到最终值 $S_f$。对于 $t  \\tau$，它保持在 $S_f$ 恒定。\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},   0 \\le t \\le \\tau \\\\\nS_f,   t  \\tau\n\\end{cases}\n$$\n成核的热力学驱动力是过饱和溶液和固相之间的化学势变化 $\\Delta \\mu(t)$，由 $\\Delta \\mu(t) = k_B T \\ln S(t)$ 给出，其中 $k_B$ 是玻尔兹曼常数，T 是绝对温度。只有在过饱和溶液中（即 $S(t)  1$ 从而 $\\Delta \\mu(t)  0$）才可能发生自发成核。\n\n**1. 成核的吉布斯自由能和临界性质**\n\n根据 CNT，形成一个由 $n$ 个体积为 $v_m$ 的单体组成的球形团簇的自由能变化 $\\Delta G(n,t)$，是创建新表面的能量成本和形成体相的能量增益之和：\n$$\n\\Delta G(n,t) = \\Delta G_{\\text{surface}} + \\Delta G_{\\text{volume}}\n$$\n表面项是 $A \\gamma$，其中 $\\gamma$ 是界面能，A 是球形团簇的表面积。团簇的体积是 $V=nv_m$。半径 $r$ 由 $V = \\frac{4}{3}\\pi r^3$ 给出，所以 $r = (\\frac{3nv_m}{4\\pi})^{1/3}$。面积是 $A = 4\\pi r^2 = 4\\pi (\\frac{3nv_m}{4\\pi})^{2/3} = (36\\pi v_m^2)^{1/3} n^{2/3}$。\n体积项是 $-n \\Delta \\mu(t)$。因此，形成自由能为：\n$$\n\\Delta G(n,t) = \\gamma (36\\pi v_m^2)^{1/3} n^{2/3} - n \\Delta \\mu(t)\n$$\n函数 $\\Delta G(n,t)$ 在临界团簇尺寸 $n^*(t)$ 处有一个最大值，这个最大值代表成核势垒。我们通过将关于 $n$ 的导数设为零来找到这个最大值：\n$$\n\\frac{\\partial \\Delta G}{\\partial n} = \\frac{2}{3} \\gamma (36\\pi v_m^2)^{1/3} n^{-1/3} - \\Delta \\mu(t) = 0\n$$\n解出 $n$ 得到临界尺寸 $n^*(t)$：\n$$\nn^*(t) = \\left( \\frac{2 \\gamma (36\\pi v_m^2)^{1/3}}{3 \\Delta \\mu(t)} \\right)^3 = \\frac{32 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^3}\n$$\n另一种方法是使用临界半径 $r^*(t)$，这通常更直接。作为半径函数的自由能变化是 $\\Delta G(r,t) = 4\\pi r^2 \\gamma - \\frac{4\\pi r^3}{3 v_m} \\Delta \\mu(t)$。令 $\\frac{\\partial \\Delta G}{\\partial r} = 0$ 得到临界半径：\n$$\n8\\pi r \\gamma - \\frac{4\\pi r^2}{v_m} \\Delta \\mu(t) = 0 \\implies r^*(t) = \\frac{2 \\gamma v_m}{\\Delta \\mu(t)}\n$$\n临界核尺寸 $n^*(t)$ 可以通过 $r^*(t)$ 由 $n^*(t) = \\frac{4/3 \\pi (r^*(t))^3}{v_m}$ 得到，这与前面的表达式一致。\n\n成核势垒的高度 $\\Delta G^*(t)$ 是 $\\Delta G(n^*,t)$ 或 $\\Delta G(r^*,t)$：\n$$\n\\Delta G^*(t) = \\frac{1}{2} n^*(t) \\Delta \\mu(t) = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^2} = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (k_B T \\ln S(t))^2}\n$$\n\n**2. 动力学因子和成核速率**\n\n稳态成核速率 $J(t)$ 由通用的 CNT 表达式给出：\n$$\nJ(t) = n_s Z(t) f^+(n^*,t) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\n这里，$n_s$ 是潜在成核位点的数密度，问题指定其等于单体数密度 $c_m$。$Z(t)$ 是泽尔多维奇因子，$f^+(n^*,t)$ 是单体附着到临界核的频率。\n\n泽尔多维奇因子 $Z(t)$ 表示在势垒顶部的团簇中能够继续生长的部分。它与 $\\Delta G(n)$ 曲线在 $n=n^*$ 处的曲率有关：\n$$\nZ(t) = \\sqrt{-\\frac{1}{2\\pi k_B T} \\left. \\frac{\\partial^2 \\Delta G}{\\partial n^2} \\right|_{n=n^*}} = \\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\n$$\n对于扩散限制过程，附着频率 $f^+(n^*,t)$ 是单体到达临界核表面的速率。对于半径为 $r^*(t)$ 的球形汇，这由斯莫卢霍夫斯基速率给出：\n$$\nf^+(n^*,t) = 4\\pi D c_m r^*(t)\n$$\n其中 $D$ 是单体扩散系数，$c_m$ 是单体数密度。\n\n结合这些表达式，对于 $S(t)1$ 的时变成核速率 $J(t)$ 的最终公式为：\n$$\nJ(t) = c_m \\left(\\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\\right) \\left(4\\pi D c_m r^*(t)\\right) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\n对于 $S(t) \\le 1$，驱动力 $\\Delta \\mu(t) \\le 0$，成核势垒是无限大或不明确的。物理上，不会发生自发成核，因此 $J(t)=0$。\n\n**3. 累积核数**\n\n到时间 $t_{\\text{end}}$ 为止，单位体积内形成的总核数，记为 $N(t_{\\text{end}})$，是成核速率的时间积分：\n$$\nN(t_{\\text{end}}) = \\int_0^{t_{\\text{end}}} J(t') dt'\n$$\n这个积分必须进行数值计算，因为 $J(t')$ 通过其对 $S(t')$ 的依赖性，是一个复杂的时间非线性函数。我们可以使用数值积分方法，例如 `scipy.integrate.quad` 提供的方法。\n\n**4. 数值实现**\n\n每个测试用例的计算过程如下：\n1. 定义一个函数 `J_rate(t, params)`，用于计算在给定时间 $t$ 和该案例的一组物理参数下的成核速率 $J$。该函数首先计算 $S(t)$，然后检查是否 $S(t)1$。如果是，它使用推导出的公式计算 $\\Delta \\mu(t), r^*(t), n^*(t), \\Delta G^*(t), Z(t), f^+(n^*,t)$，并最终计算出 $J(t)$。如果 $S(t)\\le 1$，则返回 $0$。\n2. 通过调用 `J_rate(t_end, params)` 计算最终时间的瞬时成核速率 $J(t_{\\text{end}})$。\n3. 通过从 $t'=0$ 到 $t'=t_{\\text{end}}$ 对 `J_rate(t', params)` 进行数值积分来计算累积核数 $N(t_{\\text{end}})$。为优化计算，如果 $t_{\\text{end}}  \\tau$，积分可以在 $t=\\tau$ 处拆分。从 $\\tau$ 到 $t_{\\text{end}}$ 的积分是直接的，因为在此区间内 $J(t')$ 是恒定的。\n$$\nN(t_{\\text{end}}) = \\int_0^{\\min(t_{\\text{end}}, \\tau)} J(t') dt' + \\begin{cases} J(t_{\\text{end}}) \\cdot (t_{\\text{end}} - \\tau)   \\text{如果 } t_{\\text{end}}  \\tau \\\\ 0   \\text{如果 } t_{\\text{end}} \\le \\tau \\end{cases}\n$$\n第一项使用数值积分计算。第二项是针对恒定速率阶段的解析加法。\n将此过程应用于每个测试用例，以生成所需的输出值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Classical Nucleation Theory problem for several test cases.\n    \"\"\"\n    # SI units are used throughout.\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        # Case A\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 1.01, 'Sf': 1.5, 'tau': 100.0, 't_end': 200.0},\n        # Case B\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 0.99, 'Sf': 1.02, 'tau': 50.0, 't_end': 50.0},\n        # Case C\n        {'gamma': 0.05, 'vm': 1.0e-28, 'D': 2.0e-9, 'cm': 5.0e+26, 'T': 298.0,\n         'Si': 1.1, 'Sf': 3.0, 'tau': 10.0, 't_end': 10.0},\n        # Case D\n        {'gamma': 0.1, 'vm': 8.0e-29, 'D': 1.0e-9, 'cm': 2.0e+26, 'T': 323.0,\n         'Si': 1.02, 'Sf': 2.0, 'tau': 200.0, 't_end': 500.0},\n    ]\n\n    all_results = []\n\n    def j_rate_integrand(t, gamma, vm, D, cm, T, Si, Sf, tau):\n        \"\"\"\n        Calculates the instantaneous nucleation rate J(t) based on CNT.\n        All parameters are passed as arguments for use with scipy.integrate.quad.\n        \"\"\"\n        # 1. Calculate supersaturation S(t)\n        if t = tau:\n            # Avoid division by zero if tau is 0, though problem constraints make it positive.\n            if tau  0:\n                S = Si + (Sf - Si) * (t / tau)\n            else:\n                S = Sf\n        else:\n            S = Sf\n\n        # 2. Nucleation only occurs for S  1\n        if S = 1.0:\n            return 0.0\n\n        # 3. Calculate thermodynamic and kinetic quantities\n        thermal_energy = k_B * T\n        delta_mu = thermal_energy * np.log(S)\n\n        # Nucleation barrier\n        delta_G_star = (16.0 * np.pi * gamma**3 * vm**2) / (3.0 * delta_mu**2)\n\n        # exponent can be large and negative, leading to underflow to 0, which is correct.\n        if (-delta_G_star / thermal_energy)  -700: # np.exp limit\n            return 0.0\n\n        # Critical radius\n        r_star = (2.0 * gamma * vm) / delta_mu\n\n        # Critical cluster size\n        n_star = (4.0/3.0) * np.pi * r_star**3 / vm\n        if n_star = 0: # Should not happen if S1\n            return 0.0\n        \n        # Zeldovich factor\n        Z = np.sqrt(delta_G_star / (3.0 * np.pi * thermal_energy * n_star**2))\n\n        # Monomer attachment frequency\n        f_plus = 4.0 * np.pi * D * r_star * cm\n        \n        # Number density of nucleation sites is given as c_m\n        ns = cm\n\n        # Steady-state nucleation rate J(t)\n        Jt = ns * Z * f_plus * np.exp(-delta_G_star / thermal_energy)\n\n        return Jt\n\n    for case in test_cases:\n        params = (case['gamma'], case['vm'], case['D'], case['cm'], case['T'],\n                  case['Si'], case['Sf'], case['tau'])\n        \n        t_end = case['t_end']\n        tau = case['tau']\n\n        # Calculate instantaneous nucleation rate at t_end\n        J_tend = j_rate_integrand(t_end, *params)\n        all_results.append(J_tend)\n\n        # Calculate cumulative nuclei number N(t_end)\n        # Part 1: Integral over the ramp phase [0, min(t_end, tau)]\n        integral_end = min(t_end, tau)\n        N_integral_part = 0.0\n        if integral_end  0:\n            # Use quad for numerical integration\n            N_integral_part, _ = integrate.quad(\n                j_rate_integrand, 0, integral_end, args=params\n            )\n\n        # Part 2: Contribution from the constant supersaturation phase, if applicable\n        N_const_part = 0.0\n        if t_end  tau:\n            # J_tend is the rate J(S_f) since t_end  tau\n            N_const_part = J_tend * (t_end - tau)\n            \n        N_tend = N_integral_part + N_const_part\n        all_results.append(N_tend)\n\n    # Format the final output string as required\n    print(f\"[{','.join(f'{r:.6e}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}