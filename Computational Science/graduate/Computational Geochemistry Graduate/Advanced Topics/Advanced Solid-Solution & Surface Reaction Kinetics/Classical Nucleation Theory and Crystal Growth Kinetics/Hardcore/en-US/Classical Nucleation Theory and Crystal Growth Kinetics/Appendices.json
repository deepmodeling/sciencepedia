{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds you in the cornerstone of Classical Nucleation Theory (CNT). You will derive the expressions for the critical nucleus radius, $r^*$, and the nucleation energy barrier, $\\Delta G^*$, from first principles. This practice goes a step further by introducing sensitivity analysis, a vital tool for any modeler, to investigate how the high uncertainty in interfacial free energy, $\\gamma$, dramatically impacts nucleation predictions .",
            "id": "4072944",
            "problem": "Consider nucleation of a new mineral phase from a supersaturated aqueous solution in the framework of Classical Nucleation Theory (CNT). For a spherical nucleus, the reversible work of formation as a function of radius is given by the sum of surface and volume contributions,\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v},\n$$\nwhere $\\gamma > 0$ is the isotropic solidâ€“solution interfacial free energy per unit area and $\\Delta G_{v}  0$ is the Gibbs free energy change per unit volume associated with transformation to the stable phase (negative under supersaturated conditions). Assume all parameters other than $\\gamma$ are known and fixed.\n\nStarting from the above fundamental expression, derive the critical radius $r^{*}$ and the nucleation barrier $\\Delta G^{*}$ by the appropriate extremum condition. Then, quantify the sensitivity of $r^{*}$ and $\\Delta G^{*}$ to uncertainty in $\\gamma$ using logarithmic derivatives, defined for a quantity $y$ with respect to $x$ as $\\partial \\ln y / \\partial \\ln x$ with other variables held constant. Use these sensitivity coefficients to propagate a small fractional uncertainty $\\delta\\gamma/\\gamma = 0.10$ from $\\gamma$ to $r^{*}$ and $\\Delta G^{*}$, assuming linearization is valid.\n\nReport the pair $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$ as dimensionless decimal fractions, rounded to four significant figures, and present your final answer as a row matrix.",
            "solution": "The problem asks us to analyze the sensitivity of the critical nucleation radius, $r^{*}$, and the nucleation barrier, $\\Delta G^{*}$, to the interfacial free energy, $\\gamma$, within the framework of Classical Nucleation Theory (CNT).\n\nFirst, we must derive the expressions for $r^{*}$ and $\\Delta G^{*}$. The reversible work of formation for a spherical nucleus, $\\Delta G(r)$, is given as:\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v}\n$$\nThe parameters are the radius $r$, the interfacial free energy $\\gamma > 0$, and the bulk Gibbs free energy change per unit volume $\\Delta G_{v}  0$. The critical radius, $r^{*}$, corresponds to the maximum of this function, which represents the peak of the energy barrier to nucleation. To find this extremum, we differentiate $\\Delta G(r)$ with respect to $r$ and set the derivative to zero:\n$$\n\\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^{2}\\gamma + \\frac{4}{3}\\pi r^{3}\\Delta G_{v} \\right) = 0\n$$\n$$\n8\\pi r\\gamma + 4\\pi r^{2}\\Delta G_{v} = 0\n$$\nFor a non-trivial nucleus ($r \\neq 0$), we can divide by $4\\pi r$:\n$$\n2\\gamma + r\\Delta G_{v} = 0\n$$\nSolving for $r$ gives the critical radius, $r^{*}$:\n$$\nr^{*} = -\\frac{2\\gamma}{\\Delta G_{v}}\n$$\nSince $\\gamma > 0$ and $\\Delta G_{v}  0$, $r^{*}$ is positive, as required for a physical radius. To confirm this is a maximum, we can examine the second derivative:\n$$\n\\frac{d^{2}(\\Delta G(r))}{dr^{2}} = \\frac{d}{dr}(8\\pi r\\gamma + 4\\pi r^{2}\\Delta G_{v}) = 8\\pi\\gamma + 8\\pi r\\Delta G_{v}\n$$\nEvaluating at $r=r^{*}$:\n$$\n\\left. \\frac{d^{2}(\\Delta G(r))}{dr^{2}} \\right|_{r=r^{*}} = 8\\pi\\gamma + 8\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right) \\Delta G_{v} = 8\\pi\\gamma - 16\\pi\\gamma = -8\\pi\\gamma\n$$\nSince $\\gamma > 0$, the second derivative is negative, confirming that $r^{*}$ corresponds to a local maximum, which is the nucleation barrier.\n\nThe height of this barrier, $\\Delta G^{*}$, is found by substituting $r=r^{*}$ back into the expression for $\\Delta G(r)$:\n$$\n\\Delta G^{*} = \\Delta G(r^{*}) = 4\\pi (r^{*})^{2}\\gamma + \\frac{4}{3}\\pi (r^{*})^{3}\\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right)^{2}\\gamma + \\frac{4}{3}\\pi \\left(-\\frac{2\\gamma}{\\Delta G_{v}}\\right)^{3} \\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(\\frac{4\\gamma^{2}}{(\\Delta G_{v})^{2}}\\right)\\gamma + \\frac{4}{3}\\pi \\left(-\\frac{8\\gamma^{3}}{(\\Delta G_{v})^{3}}\\right) \\Delta G_{v}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}} - \\frac{32\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\left(1 - \\frac{2}{3}\\right) \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}} = \\frac{1}{3} \\frac{16\\pi\\gamma^{3}}{(\\Delta G_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}\n$$\n\nNext, we quantify the sensitivity of $r^{*}$ and $\\Delta G^{*}$ to $\\gamma$ using logarithmic derivatives. The logarithmic derivative of a quantity $y$ with respect to $x$ is defined as $\\frac{\\partial \\ln y}{\\partial \\ln x}$. This coefficient directly relates the fractional change in $y$ to the fractional change in $x$.\n\nFor the critical radius $r^{*}$:\nThe sensitivity coefficient is $S_{\\gamma}^{r^{*}} = \\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}$.\nWe have $r^{*} = -\\frac{2\\gamma}{\\Delta G_{v}}$. Taking the natural logarithm of both sides:\n$$\n\\ln(r^{*}) = \\ln\\left(-\\frac{2}{\\Delta G_{v}}\\right) + \\ln(\\gamma)\n$$\nDifferentiating with respect to $\\ln(\\gamma)$, holding all other parameters constant:\n$$\n\\frac{\\partial \\ln(r^{*})}{\\partial \\ln(\\gamma)} = 0 + 1 = 1\n$$\nSo, the sensitivity of $r^{*}$ with respect to $\\gamma$ is $1$.\n\nFor the nucleation barrier $\\Delta G^{*}$:\nThe sensitivity coefficient is $S_{\\gamma}^{\\Delta G^{*}} = \\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}$.\nWe have $\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta G_{v})^{2}}$. Taking the natural logarithm:\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta G_{v})^{2}}\\right) + \\ln(\\gamma^{3})\n$$\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta G_{v})^{2}}\\right) + 3\\ln(\\gamma)\n$$\nDifferentiating with respect to $\\ln(\\gamma)$:\n$$\n\\frac{\\partial \\ln(\\Delta G^{*})}{\\partial \\ln(\\gamma)} = 0 + 3 = 3\n$$\nSo, the sensitivity of $\\Delta G^{*}$ with respect to $\\gamma$ is $3$.\n\nFinally, we propagate the given fractional uncertainty in $\\gamma$ to find the corresponding fractional uncertainties in $r^{*}$ and $\\Delta G^{*}$. For a small fractional change, linearization is valid, and we can use the approximation:\n$$\n\\frac{\\delta y}{y} \\approx \\left(\\frac{\\partial \\ln y}{\\partial \\ln x}\\right) \\frac{\\delta x}{x}\n$$\nWe are given $\\frac{\\delta\\gamma}{\\gamma} = 0.10$.\n\nThe fractional uncertainty in $r^{*}$ is:\n$$\n\\frac{\\delta r^{*}}{r^{*}} \\approx \\left(\\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (1)(0.10) = 0.10\n$$\nThis means a $10\\%$ uncertainty in $\\gamma$ leads to a $10\\%$ uncertainty in $r^{*}$.\n\nThe fractional uncertainty in $\\Delta G^{*}$ is:\n$$\n\\frac{\\delta \\Delta G^{*}}{\\Delta G^{*}} \\approx \\left(\\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (3)(0.10) = 0.30\n$$\nThis means a $10\\%$ uncertainty in $\\gamma$ leads to a $30\\%$ uncertainty in $\\Delta G^{*}$, highlighting the high sensitivity of the nucleation barrier to the interfacial energy.\n\nThe problem asks for the pair $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$ as decimal fractions rounded to four significant figures.\n$$\n\\frac{\\delta r^{*}}{r^{*}} = 0.1000\n$$\n$$\n\\frac{\\delta \\Delta G^{*}}{\\Delta G^{*}} = 0.3000\n$$\nThis pair is presented as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  0.3000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from the birth of a nucleus to the kinetics of its growth, this problem explores the profound impact of interfacial curvature. You will derive the Gibbs-Thomson relation, which quantifies how the equilibrium state of a mineral is altered at a curved surface. This principle is fundamental to understanding phenomena from Ostwald ripening to mineral precipitation in the confined geometries of porous rock, as you will see by calculating the local supersaturation, $S$, at a concave interface .",
            "id": "4072993",
            "problem": "A sparingly soluble mineral phase is precipitating from an aqueous electrolyte within a nanoporous silica host. Consider a concave crystal-fluid interface that can be locally approximated as part of a sphere of radius $R$ measured positive when the surface is convex toward the solution and negative when concave toward the solution. The mineral grows by incorporation of a growth unit of molecular volume $\\Omega$ from the solution. Assume isotropic specific surface free energy $\\gamma$ for the mineral-fluid interface. The ambient solution is at temperature $T$ and is exactly saturated with respect to a planar interface of this mineral, so its far-field activity $a_{\\mathrm{bulk}}$ equals the planar equilibrium activity $a_{\\mathrm{eq}}(0)$.\n\nStarting from the equality of chemical potentials at phase equilibrium, the definition of chemical potential in an ideal dilute solution $\\mu_{\\mathrm{solute}} = \\mu^{\\circ} + k_{B} T \\ln a$, where $k_{B}$ is the Boltzmann constant and $a$ is the activity, and the capillarity relation for the pressure-induced shift of the solid-phase chemical potential $d\\mu_{\\mathrm{solid}} = \\Omega \\, dP$ combined with the Laplace pressure for a curved interface with mean curvature $\\kappa = \\frac{1}{R_{1}} + \\frac{1}{R_{2}}$, derive an expression for the local equilibrium activity $a_{\\mathrm{eq}}(\\kappa)$ at the curved interface and then obtain the local supersaturation\n$$\nS \\equiv \\frac{a_{\\mathrm{bulk}}}{a_{\\mathrm{eq}}(\\kappa)} - 1\n$$\nat the concave surface.\n\nUse the following physically consistent parameters for a re-entrant concave surface with principal radii $R_{1} = R_{2} = -R$:\n- $R = 20 \\,\\mathrm{nm}$,\n- $\\gamma = 0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2}$,\n- $\\Omega = 4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}$,\n- $T = 298 \\,\\mathrm{K}$,\n- $k_{B} = 1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n\nExpress the final numerical value of $S$ as a decimal and round your answer to three significant figures. No units are required for $S$ in the final answer, as $S$ is dimensionless.",
            "solution": "The problem requires the derivation of the local supersaturation, $S$, at a concave mineral-fluid interface and its subsequent numerical calculation. The derivation begins from the fundamental condition of phase equilibrium: the equality of chemical potentials of the species in the two phases.\n\nAt local equilibrium at the curved interface, the chemical potential of the mineral in the solid phase, $\\mu_{\\mathrm{solid}}(\\kappa)$, must be equal to the chemical potential of the solute in the adjacent solution, $\\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(\\kappa))$, where $a_{\\mathrm{eq}}(\\kappa)$ is the local equilibrium activity at the interface with mean curvature $\\kappa$.\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) = \\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(\\kappa))\n$$\nThe problem provides a model for the chemical potential of the solute in an ideal dilute solution:\n$$\n\\mu_{\\mathrm{solute}}(a) = \\mu^{\\circ} + k_{B} T \\ln a\n$$\nwhere $\\mu^{\\circ}$ is the standard chemical potential, $k_{B}$ is the Boltzmann constant, $T$ is the absolute temperature, and $a$ is the activity of the solute.\n\nThe chemical potential of the solid phase depends on the pressure, $P$. The change in the solid's chemical potential is given by the capillarity relation:\n$$\nd\\mu_{\\mathrm{solid}} = \\Omega \\, dP\n$$\nwhere $\\Omega$ is the molecular volume of the growth unit. According to the Young-Laplace equation, the pressure difference across a curved interface is $\\Delta P = P_{\\mathrm{solid}} - P_{\\mathrm{fluid}} = \\gamma \\kappa$, where $\\gamma$ is the specific surface free energy and $\\kappa$ is the mean curvature. The chemical potential of the solid at a curved interface, $\\mu_{\\mathrm{solid}}(\\kappa)$, can be related to its value at a planar interface, $\\mu_{\\mathrm{solid}}(0)$, by integrating the capillarity relation from the fluid pressure (corresponding to a planar interface, $\\kappa=0$) to the solid pressure at the curved interface. Assuming $\\Omega$ is independent of pressure, we have:\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) - \\mu_{\\mathrm{solid}}(0) = \\int_{P_{\\mathrm{fluid}}}^{P_{\\mathrm{solid}}} \\Omega \\, dP = \\Omega (P_{\\mathrm{solid}} - P_{\\mathrm{fluid}}) = \\Omega \\gamma \\kappa\n$$\nThus, the chemical potential of the solid at the curved interface is:\n$$\n\\mu_{\\mathrm{solid}}(\\kappa) = \\mu_{\\mathrm{solid}}(0) + \\Omega \\gamma \\kappa\n$$\nNow, we substitute the expressions for the chemical potentials back into the local equilibrium condition:\n$$\n\\mu_{\\mathrm{solid}}(0) + \\Omega \\gamma \\kappa = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(\\kappa)\n$$\nFor a planar interface ($\\kappa=0$), the system is also at equilibrium, with the equilibrium activity denoted as $a_{\\mathrm{eq}}(0)$. The equilibrium condition at a planar interface is:\n$$\n\\mu_{\\mathrm{solid}}(0) = \\mu_{\\mathrm{solute}}(a_{\\mathrm{eq}}(0)) = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(0)\n$$\nSubstituting this expression for $\\mu_{\\mathrm{solid}}(0)$ into the equation for the curved interface yields:\n$$\n(\\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(0)) + \\Omega \\gamma \\kappa = \\mu^{\\circ} + k_{B} T \\ln a_{\\mathrm{eq}}(\\kappa)\n$$\nSimplifying by canceling $\\mu^{\\circ}$ and rearranging the logarithmic terms:\n$$\nk_{B} T (\\ln a_{\\mathrm{eq}}(\\kappa) - \\ln a_{\\mathrm{eq}}(0)) = \\Omega \\gamma \\kappa\n$$\n$$\nk_{B} T \\ln\\left(\\frac{a_{\\mathrm{eq}}(\\kappa)}{a_{\\mathrm{eq}}(0)}\\right) = \\Omega \\gamma \\kappa\n$$\nSolving for the local equilibrium activity $a_{\\mathrm{eq}}(\\kappa)$ gives the Gibbs-Thomson equation:\n$$\na_{\\mathrm{eq}}(\\kappa) = a_{\\mathrm{eq}}(0) \\exp\\left(\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right)\n$$\nThis is the required expression for the local equilibrium activity at the curved interface. Next, we derive the local supersaturation, $S$, defined as:\n$$\nS \\equiv \\frac{a_{\\mathrm{bulk}}}{a_{\\mathrm{eq}}(\\kappa)} - 1\n$$\nThe problem states that the ambient bulk solution is exactly saturated with respect to a planar interface, which means $a_{\\mathrm{bulk}} = a_{\\mathrm{eq}}(0)$. Substituting this condition and the derived expression for $a_{\\mathrm{eq}}(\\kappa)$ into the definition of $S$:\n$$\nS = \\frac{a_{\\mathrm{eq}}(0)}{a_{\\mathrm{eq}}(0) \\exp\\left(\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right)} - 1 = \\exp\\left(-\\frac{\\Omega \\gamma \\kappa}{k_{B} T}\\right) - 1\n$$\nFor the specific case of a re-entrant concave surface with principal radii of curvature $R_{1} = R_{2} = -R$, the mean curvature $\\kappa$ is:\n$$\n\\kappa = \\frac{1}{R_{1}} + \\frac{1}{R_{2}} = \\frac{1}{-R} + \\frac{1}{-R} = -\\frac{2}{R}\n$$\nSubstituting this specific curvature into the expression for $S$:\n$$\nS = \\exp\\left(-\\frac{\\Omega \\gamma}{k_{B} T} \\left(-\\frac{2}{R}\\right)\\right) - 1 = \\exp\\left(\\frac{2 \\Omega \\gamma}{k_{B} T R}\\right) - 1\n$$\nNow, we substitute the given numerical values:\n$R = 20 \\,\\mathrm{nm} = 20 \\times 10^{-9} \\,\\mathrm{m}$\n$\\gamma = 0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n$\\Omega = 4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}$\n$T = 298 \\,\\mathrm{K}$\n$k_{B} = 1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n\nFirst, we calculate the dimensionless exponent:\n$$\n\\frac{2 \\Omega \\gamma}{k_{B} T R} = \\frac{2 \\times (4.0 \\times 10^{-29} \\,\\mathrm{m}^{3}) \\times (0.20 \\,\\mathrm{J}\\,\\mathrm{m}^{-2})}{(1.380\\,649 \\times 10^{-23} \\,\\mathrm{J}\\,\\mathrm{K}^{-1}) \\times (298 \\,\\mathrm{K}) \\times (20 \\times 10^{-9} \\,\\mathrm{m})}\n$$\n$$\n\\frac{2 \\Omega \\gamma}{k_{B} T R} = \\frac{1.6 \\times 10^{-29} \\,\\mathrm{J} \\cdot \\mathrm{m}}{8.228608 \\times 10^{-29} \\,\\mathrm{J} \\cdot \\mathrm{m}} \\approx 0.1944458\n$$\nNow, we calculate $S$:\n$$\nS = \\exp(0.1944458) - 1 \\approx 1.214643 - 1 = 0.214643\n$$\nRounding the result to three significant figures gives:\n$$\nS \\approx 0.215\n$$\nThe positive value of $S$ indicates that the solution is supersaturated with respect to the concave interface, favoring crystal growth into the pore space even though the solution is only saturated with respect to a flat surface.",
            "answer": "$$\\boxed{0.215}$$"
        },
        {
            "introduction": "This final hands-on practice challenges you to transition from static theory to dynamic simulation, a core skill in computational geochemistry. You will construct a complete model for the time-dependent nucleation rate, $J(t)$, under changing environmental conditions. By implementing and numerically integrating the full CNT rate equation, you will predict the total number of nuclei formed over time, providing a tangible link between fundamental theory and observable crystallization outcomes .",
            "id": "4072988",
            "problem": "A solution undergoing homogeneous crystallization in an aqueous environment is driven by a time-dependent supersaturation $S(t)$ that increases linearly (a ramp) from an initial supersaturation $S_i$ to a final supersaturation $S_f$ over a ramp duration $\\tau$, then remains constant thereafter. Specifically, for time $t$ in seconds, define the supersaturation as\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},  0 \\le t \\le \\tau, \\\\\nS_f,  t  \\tau.\n\\end{cases}\n$$\nAssume homogeneous nucleation and growth of spherical nuclei in solution under the framework of Classical Nucleation Theory (CNT), which models the reversible work to form a cluster of $n$ growth units via a competition between surface energy and volume free energy. From a computational geochemistry perspective, start from the following fundamental base:\n- The reversible free energy to form a cluster of $n$ growth units is the sum of a surface energy term and a bulk free energy term driven by supersaturation. Let the molecule (or growth unit) volume be $v_m$ in $\\mathrm{m}^3$, the interfacial energy be $\\gamma$ in $\\mathrm{J}\\,\\mathrm{m}^{-2}$, and the thermal energy be $k_B T$ with Boltzmann constant $k_B$ in $\\mathrm{J}\\,\\mathrm{K}^{-1}$ at absolute temperature $T$ in $\\mathrm{K}$. The supersaturation enters via the chemical potential difference $\\Delta \\mu(t)$, with $\\Delta \\mu(t) = k_B T \\ln S(t)$ for $S(t)  1$.\n- For spherical clusters, the surface energy prefactor scales with geometry as a power of $n$, and the volume free energy scales linearly with $n$. Use these geometric and thermodynamic facts to derive the critical cluster size $n^\\*(t)$, the critical radius $r^\\*(t)$, the nucleation barrier $\\Delta G^\\*(t)$, and the Zeldovich factor $Z(t)$ from first principles.\n- For diffusion-limited attachment of monomers with diffusion coefficient $D$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ and monomer number density $c_m$ in $\\mathrm{m}^{-3}$, the monomer arrival rate at the critical cluster can be related to the spherical diffusive flux to a sink of radius $r^\\*(t)$. Use this physical picture to construct the appropriate attachment frequency at the barrier crossing coordinate.\n- The steady-state CNT nucleation rate $J(t)$ in $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ combines the barrier-crossing probability and a kinetic prefactor. Implement $J(t)$ such that it vanishes for $S(t) \\le 1$ (undersaturated or saturated conditions) and follows the appropriate thermally activated form for $S(t)  1$.\n- The expected cumulative number of nuclei per unit volume $N(t)$ in $\\mathrm{m}^{-3}$ over time $t$ is the integral of $J(t')$ from $t'=0$ to $t'=t$.\n\nYour task is to:\n1. Derive $J(t)$ and $N(t)$ from this base, ensuring all steps are physically justified and dimensionally consistent.\n2. Implement a program that, for each test case below, computes:\n   - The instantaneous nucleation rate $J(t_{\\text{end}})$ in $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n   - The cumulative nuclei number $N(t_{\\text{end}})$ in $\\mathrm{m}^{-3}$ obtained by integrating $J(t)$ from $t=0$ to $t=t_{\\text{end}}$.\n3. Use the following test suite of parameter sets, expressed in International System of Units (SI). In all cases, set $n_s = c_m$ as the number density of potential embryo positions equal to the monomer number density:\n   - Case A (general ramp, post-ramp evaluation): $\\gamma = 0.2\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$, $v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$, $T = 298\\,\\mathrm{K}$, $S_i = 1.01$, $S_f = 1.5$, $\\tau = 100\\,\\mathrm{s}$, $t_{\\text{end}} = 200\\,\\mathrm{s}$.\n   - Case B (near-saturation boundary, evaluate at end of ramp): $\\gamma = 0.2\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$, $v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$, $T = 298\\,\\mathrm{K}$, $S_i = 0.99$, $S_f = 1.02$, $\\tau = 50\\,\\mathrm{s}$, $t_{\\text{end}} = 50\\,\\mathrm{s}$.\n   - Case C (high supersaturation, fast ramp): $\\gamma = 0.05\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$, $v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$, $D = 2.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $c_m = 5.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$, $T = 298\\,\\mathrm{K}$, $S_i = 1.1$, $S_f = 3.0$, $\\tau = 10\\,\\mathrm{s}$, $t_{\\text{end}} = 10\\,\\mathrm{s}$.\n   - Case D (moderate supersaturation, elevated temperature, long post-ramp integration): $\\gamma = 0.1\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$, $v_m = 8.0 \\times 10^{-29}\\,\\mathrm{m}^3$, $D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $c_m = 2.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$, $T = 323\\,\\mathrm{K}$, $S_i = 1.02$, $S_f = 2.0$, $\\tau = 200\\,\\mathrm{s}$, $t_{\\text{end}} = 500\\,\\mathrm{s}$.\n\nAngle units are not involved in this problem. Percentages are not to be used; supersaturation is defined directly as a unitless ratio. All outputs must be expressed in SI units as specified.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order of floats:\n$$\n[\\; J_A(t_{\\text{end}}),\\; N_A(t_{\\text{end}}),\\; J_B(t_{\\text{end}}),\\; N_B(t_{\\text{end}}),\\; J_C(t_{\\text{end}}),\\; N_C(t_{\\text{end}}),\\; J_D(t_{\\text{end}}),\\; N_D(t_{\\text{end}}) \\;].\n$$",
            "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a direct application of Classical Nucleation Theory (CNT) to a time-dependent supersaturation scenario, which is a standard problem in computational materials science and geochemistry. The provided parameters are physically realistic. Therefore, the problem is valid.\n\nThe solution requires deriving the expressions for the time-dependent nucleation rate, $J(t)$, and the cumulative number of nuclei, $N(t)$, from first principles as outlined in the problem statement. This involves combining thermodynamic and kinetic aspects of homogeneous nucleation for spherical clusters.\n\nFirst, we define the supersaturation $S(t)$ as a function of time $t$. For $t \\in [0, \\tau]$, the supersaturation increases linearly from an initial value $S_i$ to a final value $S_f$. For $t > \\tau$, it remains constant at $S_f$.\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},  0 \\le t \\le \\tau \\\\\nS_f,  t > \\tau\n\\end{cases}\n$$\nThe thermodynamic driving force for nucleation is the change in chemical potential $\\Delta \\mu(t)$ between the supersaturated solution and the solid phase, given by $\\Delta \\mu(t) = k_B T \\ln S(t)$, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. Nucleation is only possible for a supersaturated solution, where $S(t) > 1$ and thus $\\Delta \\mu(t) > 0$.\n\n**1. Gibbs Free Energy of Nucleation and Critical Properties**\n\nAccording to CNT, the free energy change $\\Delta G(n,t)$ to form a spherical cluster of $n$ monomers of volume $v_m$ is the sum of the energy cost to create a new surface and the energy gain from forming a bulk phase:\n$$\n\\Delta G(n,t) = \\Delta G_{\\text{surface}} + \\Delta G_{\\text{volume}}\n$$\nThe surface term is $A \\gamma$, where $\\gamma$ is the interfacial energy and $A$ is the surface area of the spherical cluster. The volume of the cluster is $V=nv_m$. The radius $r$ is given by $V = \\frac{4}{3}\\pi r^3$, so $r = (\\frac{3nv_m}{4\\pi})^{1/3}$. The area is $A = 4\\pi r^2 = 4\\pi (\\frac{3nv_m}{4\\pi})^{2/3} = (36\\pi v_m^2)^{1/3} n^{2/3}$.\nThe volume term is $-n \\Delta \\mu(t)$. Thus, the free energy of formation is:\n$$\n\\Delta G(n,t) = \\gamma (36\\pi v_m^2)^{1/3} n^{2/3} - n \\Delta \\mu(t)\n$$\nThe function $\\Delta G(n,t)$ has a maximum at the critical cluster size, $n^*(t)$, which represents the nucleation barrier. We find this maximum by setting the derivative with respect to $n$ to zero:\n$$\n\\frac{\\partial \\Delta G}{\\partial n} = \\frac{2}{3} \\gamma (36\\pi v_m^2)^{1/3} n^{-1/3} - \\Delta \\mu(t) = 0\n$$\nSolving for $n$ gives the critical size $n^*(t)$:\n$$\nn^*(t) = \\left( \\frac{2 \\gamma (36\\pi v_m^2)^{1/3}}{3 \\Delta \\mu(t)} \\right)^3 = \\frac{32 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^3}\n$$\nAlternatively, working with the critical radius $r^*(t)$ is often more direct. The free energy change as a function of radius is $\\Delta G(r,t) = 4\\pi r^2 \\gamma - \\frac{4\\pi r^3}{3 v_m} \\Delta \\mu(t)$. Setting $\\frac{\\partial \\Delta G}{\\partial r} = 0$ yields the critical radius:\n$$\n8\\pi r \\gamma - \\frac{4\\pi r^2}{v_m} \\Delta \\mu(t) = 0 \\implies r^*(t) = \\frac{2 \\gamma v_m}{\\Delta \\mu(t)}\n$$\nThe critical nucleus size $n^*(t)$ can be found from $r^*(t)$ via $n^*(t) = \\frac{4/3 \\pi (r^*(t))^3}{v_m}$, which recovers the previous expression.\n\nThe height of the nucleation barrier, $\\Delta G^*(t)$, is $\\Delta G(n^*,t)$ or $\\Delta G(r^*,t)$:\n$$\n\\Delta G^*(t) = \\frac{1}{2} n^*(t) \\Delta \\mu(t) = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^2} = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (k_B T \\ln S(t))^2}\n$$\n\n**2. Kinetic Factors and Nucleation Rate**\n\nThe steady-state nucleation rate, $J(t)$, is given by the general CNT expression:\n$$\nJ(t) = n_s Z(t) f^+(n^*,t) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\nHere, $n_s$ is the number density of potential nucleation sites, which the problem specifies to be equal to the monomer number density, $c_m$. $Z(t)$ is the Zeldovich factor, and $f^+(n^*,t)$ is the attachment frequency of monomers to the critical nucleus.\n\nThe Zeldovich factor, $Z(t)$, accounts for the fraction of clusters at the top of the barrier that proceed to grow. It is related to the curvature of the $\\Delta G(n)$ curve at $n=n^*$:\n$$\nZ(t) = \\sqrt{-\\frac{1}{2\\pi k_B T} \\left. \\frac{\\partial^2 \\Delta G}{\\partial n^2} \\right|_{n=n^*}} = \\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\n$$\nThe attachment frequency, $f^+(n^*,t)$, for a diffusion-limited process is the rate of monomer arrival at the surface of the critical nucleus. For a spherical sink of radius $r^*(t)$, this is given by the Smoluchowski rate:\n$$\nf^+(n^*,t) = 4\\pi D c_m r^*(t)\n$$\nwhere $D$ is the monomer diffusion coefficient and $c_m$ is the monomer number density.\n\nCombining these expressions, the final formula for the time-dependent nucleation rate $J(t)$ for $S(t)>1$ is:\n$$\nJ(t) = c_m \\left(\\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\\right) \\left(4\\pi D c_m r^*(t)\\right) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\nFor $S(t) \\le 1$, the driving force $\\Delta \\mu(t) \\le 0$, and the nucleation barrier is infinite or ill-defined. Physically, no spontaneous nucleation occurs, so $J(t)=0$.\n\n**3. Cumulative Number of Nuclei**\n\nThe total number of nuclei formed per unit volume up to a time $t_{\\text{end}}$, denoted $N(t_{\\text{end}})$, is the time integral of the nucleation rate:\n$$\nN(t_{\\text{end}}) = \\int_0^{t_{\\text{end}}} J(t') dt'\n$$\nThis integral must be computed numerically, as $J(t')$ is a complex non-linear function of time through its dependence on $S(t')$. We can use a numerical quadrature method, such as that provided by `scipy.integrate.quad`.\n\n**4. Numerical Implementation**\n\nThe computational procedure for each test case is as follows:\n1. Define a function `J_rate(t, params)` that calculates the nucleation rate $J$ for a given time $t$ and the set of physical parameters for the case. This function first computes $S(t)$, then checks if $S(t)>1$. If so, it calculates $\\Delta \\mu(t), r^*(t), n^*(t), \\Delta G^*(t), Z(t), f^+(n^*,t)$, and finally $J(t)$ using the derived formulas. If $S(t)\\le 1$, it returns $0$.\n2. Calculate the instantaneous nucleation rate at the final time, $J(t_{\\text{end}})$, by calling `J_rate(t_end, params)`.\n3. Calculate the cumulative number of nuclei, $N(t_{\\text{end}})$, by numerically integrating `J_rate(t', params)` from $t'=0$ to $t'=t_{\\text{end}}$. To optimize, the integration can be split at $t=\\tau$ if $t_{\\text{end}} > \\tau$. The integral from $\\tau$ to $t_{\\text{end}}$ is straightforward as $J(t')$ is constant in this interval.\n$$\nN(t_{\\text{end}}) = \\int_0^{\\min(t_{\\text{end}}, \\tau)} J(t') dt' + \\begin{cases} J(t_{\\text{end}}) \\cdot (t_{\\text{end}} - \\tau)  \\text{if } t_{\\text{end}}  \\tau \\\\ 0  \\text{if } t_{\\text{end}} \\le \\tau \\end{cases}\n$$\nThe first term is computed using numerical quadrature. The second term is an analytical addition for the constant-rate phase.\nThis procedure is applied to each test case to generate the required output values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Classical Nucleation Theory problem for several test cases.\n    \"\"\"\n    # SI units are used throughout.\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        # Case A\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 1.01, 'Sf': 1.5, 'tau': 100.0, 't_end': 200.0},\n        # Case B\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 0.99, 'Sf': 1.02, 'tau': 50.0, 't_end': 50.0},\n        # Case C\n        {'gamma': 0.05, 'vm': 1.0e-28, 'D': 2.0e-9, 'cm': 5.0e+26, 'T': 298.0,\n         'Si': 1.1, 'Sf': 3.0, 'tau': 10.0, 't_end': 10.0},\n        # Case D\n        {'gamma': 0.1, 'vm': 8.0e-29, 'D': 1.0e-9, 'cm': 2.0e+26, 'T': 323.0,\n         'Si': 1.02, 'Sf': 2.0, 'tau': 200.0, 't_end': 500.0},\n    ]\n\n    all_results = []\n\n    def j_rate_integrand(t, gamma, vm, D, cm, T, Si, Sf, tau):\n        \"\"\"\n        Calculates the instantaneous nucleation rate J(t) based on CNT.\n        All parameters are passed as arguments for use with scipy.integrate.quad.\n        \"\"\"\n        # 1. Calculate supersaturation S(t)\n        if t = tau:\n            # Avoid division by zero if tau is 0, though problem constraints make it positive.\n            if tau  0:\n                S = Si + (Sf - Si) * (t / tau)\n            else:\n                S = Sf\n        else:\n            S = Sf\n\n        # 2. Nucleation only occurs for S  1\n        if S = 1.0:\n            return 0.0\n\n        # 3. Calculate thermodynamic and kinetic quantities\n        thermal_energy = k_B * T\n        delta_mu = thermal_energy * np.log(S)\n\n        # Nucleation barrier\n        delta_G_star = (16.0 * np.pi * gamma**3 * vm**2) / (3.0 * delta_mu**2)\n\n        # exponent can be large and negative, leading to underflow to 0, which is correct.\n        if (-delta_G_star / thermal_energy)  -700: # np.exp limit\n            return 0.0\n\n        # Critical radius\n        r_star = (2.0 * gamma * vm) / delta_mu\n\n        # Critical cluster size\n        n_star = (4.0/3.0) * np.pi * r_star**3 / vm\n        if n_star = 0: # Should not happen if S1\n            return 0.0\n        \n        # Zeldovich factor\n        Z = np.sqrt(delta_G_star / (3.0 * np.pi * thermal_energy * n_star**2))\n\n        # Monomer attachment frequency\n        f_plus = 4.0 * np.pi * D * r_star * cm\n        \n        # Number density of nucleation sites is given as c_m\n        ns = cm\n\n        # Steady-state nucleation rate J(t)\n        Jt = ns * Z * f_plus * np.exp(-delta_G_star / thermal_energy)\n\n        return Jt\n\n    for case in test_cases:\n        params = (case['gamma'], case['vm'], case['D'], case['cm'], case['T'],\n                  case['Si'], case['Sf'], case['tau'])\n        \n        t_end = case['t_end']\n        tau = case['tau']\n\n        # Calculate instantaneous nucleation rate at t_end\n        J_tend = j_rate_integrand(t_end, *params)\n        all_results.append(J_tend)\n\n        # Calculate cumulative nuclei number N(t_end)\n        # Part 1: Integral over the ramp phase [0, min(t_end, tau)]\n        integral_end = min(t_end, tau)\n        N_integral_part = 0.0\n        if integral_end  0:\n            # Use quad for numerical integration\n            N_integral_part, _ = integrate.quad(\n                j_rate_integrand, 0, integral_end, args=params\n            )\n\n        # Part 2: Contribution from the constant supersaturation phase, if applicable\n        N_const_part = 0.0\n        if t_end  tau:\n            # J_tend is the rate J(S_f) since t_end  tau\n            N_const_part = J_tend * (t_end - tau)\n            \n        N_tend = N_integral_part + N_const_part\n        all_results.append(N_tend)\n\n    # Format the final output string as required\n    print(f\"[{','.join(f'{r:.6e}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}