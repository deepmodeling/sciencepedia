{
    "hands_on_practices": [
        {
            "introduction": "任何固溶体模型的核心都在于其构型熵，它量化了原子混合所带来的无序度。本练习将深入探讨多亚晶格固溶体（如石榴石）中理想混合构型熵的计算，这是基于统计力学基本原理的直接应用。通过这个实践，你将掌握计算混合熵及其对组分偏导数的方法，这对于建立化学势和相平衡条件至关重要。",
            "id": "4067672",
            "problem": "考虑一个理想的多位点亚晶格石榴石固溶体，其在复合能量形式（Compound Energy Formalism, CEF）框架下的通式为 $\\mathrm{X}_3\\mathrm{Y}_2\\mathrm{Z}_3\\mathrm{O}_{12}$。$\\mathrm{X}$ 亚晶格容纳二价阳离子，$\\mathrm{Y}$ 亚晶格容纳三价阳离子，$\\mathrm{Z}$ 亚晶格容纳四价阳离子。假设在 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 亚晶格上发生理想的构型混合，而在 $\\mathrm{Z}$ 亚晶格上为纯端元占据。每个化学式单元的亚晶格多重度为 $a^{\\mathrm{X}} = 3$，$a^{\\mathrm{Y}} = 2$ 和 $a^{\\mathrm{Z}} = 3$。\n\n某一特定的石榴石固溶体状态由以下位点分数指定：\n- 在 $\\mathrm{X}$ 亚晶格上：$y_{\\mathrm{Mg}}^{\\mathrm{X}} = 0.55$，$y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} = 0.30$，$y_{\\mathrm{Ca}}^{\\mathrm{X}} = 0.15$；\n- 在 $\\mathrm{Y}$ 亚晶格上：$y_{\\mathrm{Al}}^{\\mathrm{Y}} = 0.80$，$y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} = 0.20$；\n- 在 $\\mathrm{Z}$ 亚晶格上：$y_{\\mathrm{Si}}^{\\mathrm{Z}} = 1.00$。\n\n从构型熵作为 Boltzmann 关系的统计力学定义以及经过充分检验的多位点占据组合计数法出发，推导该多位点固溶体每摩尔化学式单元的理想构型混合熵 $S_{\\mathrm{mix}}$。然后，计算在给定位点分数状态下，$\\mathrm{X}$ 和 $\\mathrm{Y}$ 亚晶格上每个独立物种的偏导数 $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$。将 $\\mathrm{Z}$ 亚晶格视为化学计量的，并将其从导数集合中排除。\n\n使用摩尔气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。将 $S_{\\mathrm{mix}}$ 和所有 $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$ 的值以 $\\mathrm{J\\,K^{-1}\\,mol^{-1}}$ 为单位表示。将每个报告值四舍五入至四位有效数字。\n\n按以下顺序报告您的最终结果：\n$$\\left(S_{\\mathrm{mix}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}}\\right).$$",
            "solution": "该问题具有科学依据，提法明确，并包含足够的信息以获得唯一解。这是多组分固溶体热力学中的一个标准练习，特别是将复合能量形式（CEF）应用于理想混合模型。所有给定的参数和条件对于石榴石矿物都是一致且物理上现实的。\n\n对于多位点固溶体，理想构型混合熵 $S_{\\mathrm{mix}}$ 源自 Boltzmann 关系 $S = k_B \\ln W$，其中 $k_B$ 是 Boltzmann 常数，$W$ 是微观构型总数。对于一摩尔化学式单元，摩尔熵为 $S = R \\ln W_{\\text{molar}}$，其中 $R$ 是摩尔气体常数。\n\n在多位点晶体中，总构型数 $W$ 是每个独立亚晶格 $\\alpha$ 上构型数的乘积，$W = \\prod_{\\alpha} W_{\\alpha}$。因此，构型熵在各亚晶格上是可加的：$S_{\\mathrm{mix}} = \\sum_{\\alpha} S_{\\mathrm{mix}}^{\\alpha}$。\n\n对于给定的亚晶格 $\\alpha$，其每个化学式单元的位点多重度为 $a^{\\alpha}$，且有多种物种 $i$ 以位点分数 $y_i^{\\alpha}$ 占据这些位点，则将 $N_A a^{\\alpha} y_i^{\\alpha}$ 个物种 $i$ 的原子排布在 $N_A a^{\\alpha}$ 个总位点（对于一摩尔）上的方式数由多项式系数给出。对于大的 $N$，使用 Stirling 近似 $\\ln(N!)$，亚晶格 $\\alpha$ 的摩尔构型熵由下式给出：\n$$S_{\\mathrm{mix}}^{\\alpha} = -R a^{\\alpha} \\sum_{i} y_i^{\\alpha} \\ln y_i^{\\alpha}$$\n整个晶体的总理想构型混合熵是在所有发生混合的亚晶格上的总和：\n$$S_{\\mathrm{mix}} = -R \\sum_{\\alpha} a^{\\alpha} \\sum_{i} y_i^{\\alpha} \\ln y_i^{\\alpha}$$\n\n该问题描述了一种石榴石 $\\mathrm{X}_3\\mathrm{Y}_2\\mathrm{Z}_3\\mathrm{O}_{12}$，它具有三个阳离子亚晶格 $\\mathrm{X}$、$\\mathrm{Y}$ 和 $\\mathrm{Z}$，其每个化学式单元的多重度分别为 $a^{\\mathrm{X}}=3$、$a^{\\mathrm{Y}}=2$ 和 $a^{\\mathrm{Z}}=3$。\n\n问题指出，混合发生在 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 亚晶格上，而 $\\mathrm{Z}$ 亚晶格是纯占据（$y_{\\mathrm{Si}}^{\\mathrm{Z}} = 1.00$）。因此，$\\mathrm{Z}$ 亚晶格对混合熵的贡献为零，因为 $S_{\\mathrm{mix}}^{\\mathrm{Z}} = -R a^{\\mathrm{Z}} (1 \\ln 1) = 0$。\n\n因此，总混合熵为：\n$$S_{\\mathrm{mix}} = S_{\\mathrm{mix}}^{\\mathrm{X}} + S_{\\mathrm{mix}}^{\\mathrm{Y}} = -R \\left( a^{\\mathrm{X}} \\sum_{i \\in \\mathrm{X}} y_i^{\\mathrm{X}} \\ln y_i^{\\mathrm{X}} + a^{\\mathrm{Y}} \\sum_{j \\in \\mathrm{Y}} y_j^{\\mathrm{Y}} \\ln y_j^{\\mathrm{Y}} \\right)$$\n\n代入给定的位点分数和多重度：\n- $\\mathrm{X}$ 亚晶格：$y_{\\mathrm{Mg}}^{\\mathrm{X}} = 0.55$, $y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} = 0.30$, $y_{\\mathrm{Ca}}^{\\mathrm{X}} = 0.15$。\n- $\\mathrm{Y}$ 亚晶格：$y_{\\mathrm{Al}}^{\\mathrm{Y}} = 0.80$, $y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} = 0.20$。\n$$S_{\\mathrm{mix}} = -R \\left[ 3 \\left( y_{\\mathrm{Mg}}^{\\mathrm{X}} \\ln y_{\\mathrm{Mg}}^{\\mathrm{X}} + y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} \\ln y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} + y_{\\mathrm{Ca}}^{\\mathrm{X}} \\ln y_{\\mathrm{Ca}}^{\\mathrm{X}} \\right) + 2 \\left( y_{\\mathrm{Al}}^{\\mathrm{Y}} \\ln y_{\\mathrm{Al}}^{\\mathrm{Y}} + y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} \\ln y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} \\right) \\right]$$\n$$S_{\\mathrm{mix}} = -R \\left[ 3 \\left( 0.55 \\ln(0.55) + 0.30 \\ln(0.30) + 0.15 \\ln(0.15) \\right) + 2 \\left( 0.80 \\ln(0.80) + 0.20 \\ln(0.20) \\right) \\right]$$\n数值计算各项：\n$$S_{\\mathrm{mix}}^{\\mathrm{X}} \\text{ 项} = 3 \\left( 0.55 \\times (-0.597837) + 0.30 \\times (-1.203973) + 0.15 \\times (-1.897120) \\right)$$\n$$= 3 \\left( -0.328810 - 0.361192 - 0.284568 \\right) = 3(-0.974570) = -2.92371$$\n$$S_{\\mathrm{mix}}^{\\mathrm{Y}} \\text{ 项} = 2 \\left( 0.80 \\times (-0.223144) + 0.20 \\times (-1.609438) \\right)$$\n$$= 2 \\left( -0.178515 - 0.321888 \\right) = 2(-0.500403) = -1.000806$$\n$$S_{\\mathrm{mix}} = -R \\left( -2.92371 - 1.000806 \\right) = -R \\left( -3.924516 \\right)$$\n使用 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$：\n$$S_{\\mathrm{mix}} = 8.314462618 \\times 3.924516 = 32.6288... \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$$\n四舍五入至四位有效数字，$S_{\\mathrm{mix}} = 32.63 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$。\n\n接下来，我们必须计算偏导数 $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$。每个亚晶格上的位点分数都受到约束条件 $\\sum_i y_i^\\alpha = 1$ 的限制。严格的偏导数计算需要选择一个位点分数作为因变量，这将导致结果依赖于这一任意选择。然而，问题要求计算输出格式中列出的每个物种的导数，这超出了独立变量的数量。这暗示了题目要求的是形式上的偏导数，即在数学上将所有 $y_i^\\alpha$ 视为独立的。这是基于CEF的计算中的一个标准量，与化学势的构建有关。\n\n我们计算 $S_{\\mathrm{mix}}$ 相对于位点分数 $y_k^\\beta$ 的形式导数：\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = \\frac{\\partial}{\\partial y_k^{\\beta}} \\left( -R a^{\\beta} \\sum_{i \\in \\beta} y_i^{\\beta} \\ln y_i^{\\beta} \\right)$$\n由于求导时保持所有其他位点分数（包括同一亚晶格上的其他分数）不变，因此只有 $i=k$ 的项不为零：\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = -R a^{\\beta} \\frac{\\partial}{\\partial y_k^{\\beta}} \\left( y_k^{\\beta} \\ln y_k^{\\beta} \\right) = -R a^{\\beta} \\left( 1 \\cdot \\ln y_k^{\\beta} + y_k^{\\beta} \\cdot \\frac{1}{y_k^{\\beta}} \\right)$$\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = -R a^{\\beta} (1 + \\ln y_k^{\\beta})$$\n我们将此公式应用于 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 亚晶格上的每个物种。\n\n对于 $\\mathrm{X}$ 亚晶格（$a^{\\mathrm{X}} = 3$）：\n- 对于 $\\mathrm{Mg}$：$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}} = -3R(1+\\ln(0.55)) = -3(8.31446...) (1 - 0.597837) = -10.0315... \\approx -10.03 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- 对于 $\\mathrm{Fe^{2+}}$：$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}} = -3R(1+\\ln(0.30)) = -3(8.31446...) (1 - 1.203973) = 5.0877... \\approx 5.088 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- 对于 $\\mathrm{Ca}$：$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}} = -3R(1+\\ln(0.15)) = -3(8.31446...) (1 - 1.897120) = 22.3770... \\approx 22.38 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n\n对于 $\\mathrm{Y}$ 亚晶格（$a^{\\mathrm{Y}} = 2$）：\n- 对于 $\\mathrm{Al}$：$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}} = -2R(1+\\ln(0.80)) = -2(8.31446...) (1 - 0.223144) = -12.9182... \\approx -12.92 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- 对于 $\\mathrm{Fe^{3+}}$：$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}} = -2R(1+\\ln(0.20)) = -2(8.31446...) (1 - 1.609438) = 10.1342... \\approx 10.13 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n\n最终结果，四舍五入至四位有效数字并按要求顺序排列，如下：\n- $S_{\\mathrm{mix}} = 32.63 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}} = -10.03 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}} = 5.088 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}} = 22.38 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}} = -12.92 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}} = 10.13 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$",
            "answer": "$$\\boxed{\\begin{pmatrix} 32.63  -10.03  5.088  22.38  -12.92  10.13 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实矿物并非理想混合，原子间的相互作用能显著影响其热力学性质。本练习将引入过剩吉布斯自由能的概念，并使用化合物能量模型（CEF）来处理具有温度依赖性相互作用参数的非理想固溶体。掌握这个练习有助于你理解如何量化和解释偏离理想行为的能量贡献，这是构建精确地球化学模型的关键一步。",
            "id": "4067695",
            "problem": "考虑一个由化合物能量形式（CEF）描述的、具有两个晶体亚晶格的多组分固溶体。亚晶格指数用上标表示，位点数（每个化学式单位中各亚晶格的位点数量）为 $r^{(1)}$ 和 $r^{(2)}$。假设每个亚晶格上的混合是随机的，并且相互作用采用 Bragg–Williams 平均场处理。在此模型中，摩尔吉布斯自由能分解为一个理想构型项和一个由各亚晶格上不同占位原子之间的能量相互作用引起的过剩项。对于给定亚晶格上的二元混合，其过剩项被认为与不同占位的概率以及一个与温度相关的相互作用参数成正比。\n\n给定一个双亚晶格固溶体，其位点数为 $r^{(1)}=2$ 和 $r^{(2)}=1$。亚晶格 1 包含组元 $\\mathrm{M}_1$ 和 $\\mathrm{M}_2$，其位点分数为 $y_{\\mathrm{M}_1}^{(1)}=0.65$ 和 $y_{\\mathrm{M}_2}^{(1)}=0.35$。亚晶格 2 包含组元 $\\mathrm{X}_1$ 和 $\\mathrm{X}_2$，其位点分数为 $y_{\\mathrm{X}_1}^{(2)}=0.25$ 和 $y_{\\mathrm{X}_2}^{(2)}=0.75$。假设唯一的非理想相互作用是每个亚晶格上的一阶二元相互作用，没有跨亚晶格相互作用参数，也没有更高阶的 Redlich–Kister 项。每个亚晶格上二元相互作用的温度依赖关系具有以下形式\n$$\nL^{(s)}(T)\\;=\\;a_s\\;+\\;b_s\\,T\\;+\\; \\frac{c_s}{T},\n$$\n系数如下：\n- 对于亚晶格 1：$a_1=1500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$b_1=-2\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$c_1=30000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$。\n- 对于亚晶格 2：$a_2=-500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$b_2=1.5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$c_2=10000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$。\n\n从 CEF 关于过剩吉布斯自由能的定义出发，即相互作用能按位点数和随机混合下不同占位的概率加权并对所有亚晶格求和，推导出在指定位点分数状态下摩尔过剩吉布斯自由能 $G^{\\mathrm{ex}}(T)$ 的闭式表达式。将 $T$ 视为以开尔文为单位的绝对温度。将您得到的 $G^{\\mathrm{ex}}(T)$ 的最终表达式以焦耳/摩尔化学式单位（Joules per mole of formula unit）表示。无需进行数值四舍五入。\n\n然后，基于基本热力学定义 $H=G-T(\\partial G/\\partial T)_P$ 和 $S=-(\\partial G/\\partial T)_P$，从过剩焓、过剩熵和与温度相关的有序化贡献的角度，解释相互作用参数 $L^{(s)}(T)$ 中系数 $a_s$、$b_s$ 和 $c_s$ 的物理意义。您最终报告的答案必须是 $G^{\\mathrm{ex}}(T)$ 的单一闭式表达式。",
            "solution": "问题陈述具有科学依据、提法恰当、客观且内部一致，提供了推导所要求表达式所需的所有信息。它基于化合物能量形式（CEF），这是计算热力学和材料科学中一个标准且成熟的模型。因此，我们可以开始求解。\n\n该问题要求推导一个双亚晶格固溶体的摩尔过剩吉布斯自由能 $G^{\\mathrm{ex}}(T)$，并对相互作用参数表达式中的系数进行物理解释。\n\n在 CEF 中，固溶体的摩尔吉布斯自由能分解为几个部分，包括一个理想构型项和一个过剩项。摩尔过剩吉布斯自由能 $G^{\\mathrm{ex}}$ 量化了对理想混合行为的偏离，并源于组元之间的能量相互作用。对于一个仅考虑每个亚晶格内部二元相互作用的模型，过剩吉布斯自由能由每个亚晶格的贡献之和给出，并按其位点数加权。\n\n在一个具有多个亚晶格（用 $s$ 索引）的系统中，$G^{\\mathrm{ex}}$ 的通用表达式为：\n$$\nG^{\\mathrm{ex}} = \\sum_{s} r^{(s)} \\left( \\sum_{i} \\sum_{ji} y_i^{(s)} y_j^{(s)} L_{i,j}^{(s)} \\right)\n$$\n其中 $r^{(s)}$ 是亚晶格 $s$ 的位点数，$y_i^{(s)}$ 和 $y_j^{(s)}$ 是组元 $i$ 和 $j$ 在亚晶格 $s$ 上的位点分数，$L_{i,j}^{(s)}$ 是该亚晶格上组元 $i$ 和 $j$ 之间的二元相互作用参数。在随机混合（Bragg-Williams 近似）的假设下，乘积 $y_i^{(s)} y_j^{(s)}$ 代表了在亚晶格内形成一个 $i-j$ 对的概率。问题陈述指出，只存在一阶二元相互作用。\n\n在这个特定情况下，我们有两个亚晶格，$s=1$ 和 $s=2$。\n\n对于亚晶格 1，其组元为 $\\mathrm{M}_1$ 和 $\\mathrm{M}_2$。它对过剩吉布斯自由能的贡献 $G^{\\mathrm{ex}(1)}$ 为：\n$$\nG^{\\mathrm{ex}(1)} = r^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} L^{(1)}(T)\n$$\n给定值为 $r^{(1)}=2$，$y_{\\mathrm{M}_1}^{(1)}=0.65$ 和 $y_{\\mathrm{M}_2}^{(1)}=0.35$。\n相互作用参数为 $L^{(1)}(T) = a_1 + b_1 T + \\frac{c_1}{T}$。\n\n对于亚晶格 2，其组元为 $\\mathrm{X}_1$ 和 $\\mathrm{X}_2$。它对过剩吉布斯自由能的贡献 $G^{\\mathrm{ex}(2)}$ 为：\n$$\nG^{\\mathrm{ex}(2)} = r^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} L^{(2)}(T)\n$$\n给定值为 $r^{(2)}=1$，$y_{\\mathrm{X}_1}^{(2)}=0.25$ 和 $y_{\\mathrm{X}_2}^{(2)}=0.75$。\n相互作用参数为 $L^{(2)}(T) = a_2 + b_2 T + \\frac{c_2}{T}$。\n\n总摩尔过剩吉布斯自由能是这两部分贡献之和：\n$$\nG^{\\mathrm{ex}}(T) = G^{\\mathrm{ex}(1)} + G^{\\mathrm{ex}(2)} = r^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} L^{(1)}(T) + r^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} L^{(2)}(T)\n$$\n首先，我们计算每一项的组分前置因子。\n对于亚晶格 1：\n$$\nr^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} = (2)(0.65)(0.35) = 2 \\times 0.2275 = 0.455\n$$\n对于亚晶格 2：\n$$\nr^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} = (1)(0.25)(0.75) = 0.1875\n$$\n现在，将这些前置因子和 $L^{(s)}(T)$ 的表达式代入 $G^{\\mathrm{ex}}(T)$ 的方程中：\n$$\nG^{\\mathrm{ex}}(T) = 0.455 \\left( a_1 + b_1 T + \\frac{c_1}{T} \\right) + 0.1875 \\left( a_2 + b_2 T + \\frac{c_2}{T} \\right)\n$$\n代入给定的 $a_s$、$b_s$ 和 $c_s$ 的数值系数：\n$a_1=1500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$b_1=-2\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$c_1=30000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$。\n$a_2=-500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$b_2=1.5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$c_2=10000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$。\n$$\nG^{\\mathrm{ex}}(T) = 0.455 \\left( 1500 - 2T + \\frac{30000}{T} \\right) + 0.1875 \\left( -500 + 1.5T + \\frac{10000}{T} \\right)\n$$\n我们将前置因子分配进去：\n$$\nG^{\\mathrm{ex}}(T) = (0.455 \\times 1500) - (0.455 \\times 2)T + \\frac{0.455 \\times 30000}{T} + (0.1875 \\times -500) + (0.1875 \\times 1.5)T + \\frac{0.1875 \\times 10000}{T}\n$$\n$$\nG^{\\mathrm{ex}}(T) = 682.5 - 0.91T + \\frac{13650}{T} - 93.75 + 0.28125T + \\frac{1875}{T}\n$$\n最后，我们合并具有相同温度 $T$ 依赖关系的项：\n常数项：$682.5 - 93.75 = 588.75$\n$T$ 的一次项：$(-0.91 + 0.28125)T = -0.62875T$\n与 $T^{-1}$ 成正比的项：$\\frac{13650 + 1875}{T} = \\frac{15525}{T}$\n合并这些结果，得到摩尔过剩吉布斯自由能的最终闭式表达式：\n$$\nG^{\\mathrm{ex}}(T) = 588.75 - 0.62875T + \\frac{15525}{T}\n$$\n该表达式的单位是焦耳/摩尔化学式单位（$\\mathrm{J}\\,\\mathrm{mol}^{-1}$）。\n\n接下来，我们讨论系数 $a_s$、$b_s$ 和 $c_s$ 的物理意义。我们使用焓 $H$ 和熵 $S$ 的基本热力学关系：\n$$\nS = -\\left(\\frac{\\partial G}{\\partial T}\\right)_P \\quad \\text{和} \\quad H = G + TS = G - T\\left(\\frac{\\partial G}{\\partial T}\\right)_P\n$$\n这些关系同样适用于过剩性质 $G^{\\mathrm{ex}}$、$H^{\\mathrm{ex}}$ 和 $S^{\\mathrm{ex}}$。让我们分析单个二元相互作用对 $G^{\\mathrm{ex}}$ 的贡献，记为 $G^{\\mathrm{ex}}_{\\text{term}} = K \\cdot L(T)$，其中 $K$ 是一个与温度无关的组分因子，且 $L(T) = a + bT + c/T$。\n\n对过剩熵的贡献为：\n$$\nS^{\\mathrm{ex}}_{\\text{term}} = -\\left(\\frac{\\partial G^{\\mathrm{ex}}_{\\text{term}}}{\\partial T}\\right)_P = -K \\frac{d}{dT}\\left(a + bT + \\frac{c}{T}\\right) = -K\\left(b - \\frac{c}{T^2}\\right) = -Kb + \\frac{Kc}{T^2}\n$$\n对过剩焓的贡献为：\n$$\nH^{\\mathrm{ex}}_{\\text{term}} = G^{\\mathrm{ex}}_{\\text{term}} + T S^{\\mathrm{ex}}_{\\text{term}} = K\\left(a + bT + \\frac{c}{T}\\right) + T\\left(-Kb + \\frac{Kc}{T^2}\\right) = Ka + KbT + \\frac{Kc}{T} - KbT + \\frac{Kc}{T} = Ka + \\frac{2Kc}{T}\n$$\n基于这些推导，我们可以解释 $L^{(s)}(T) = a_s + b_s T + c_s/T$ 中每个系数的物理意义：\n1.  **系数 $a_s$**：该系数对过剩焓 $H^{\\mathrm{ex}}$ 的贡献为 $K_s a_s$ 项，而对过剩熵 $S^{\\mathrm{ex}}$ 没有贡献。因此，$a_s$ 代表了相互作用焓中与温度无关的部分。它是正规溶体相互作用参数，反映了异类（$i-j$）原子对与同类（$i-i$, $j-j$）原子对之间的对相互作用能差异。正的 $a_s$ 表示混合在能量上不利（有相分离趋势），而负的 $a_s$ 表示混合在能量上有利。\n\n2.  **系数 $b_s$**：该系数对过剩熵 $S^{\\mathrm{ex}}$ 的贡献为 $-K_s b_s$ 项，而对过剩焓 $H^{\\mathrm{ex}}$ 没有贡献。因此，$-b_s$ 代表了对混合过剩熵的一个非构型的、与温度无关的贡献。这可能源于混合时振动熵（声子谱）、电子熵或磁熵的变化。正的 $b_s$ 会导致对 $S^{\\mathrm{ex}}$ 的负贡献，这可能意味着在固溶体形成时晶格发生了硬化。\n\n3.  **系数 $c_s$**：该系数对过剩焓（$H^{\\mathrm{ex}} \\propto 2c_s/T$）和过剩熵（$S^{\\mathrm{ex}} \\propto c_s/T^2$）都有贡献。这种特定的温度依赖性是有序化现象初始阶段的特征。尽管 Bragg-Williams 模型假设随机混合，因此没有明确考虑短程有序（SRO），但吉布斯自由能表达式中的 $c_s/T$ 项是近似这种有序化所带来的能量后果的一种经验方法。正的 $c_s$ 会在低温下降低吉布斯自由能，表明存在有序化的热力学驱动力。这种有序化导致更负的焓（因为形成了更多能量上有利的键）和更负的熵（因为原子排列变得更不随机），这两者都随着温度的降低而变得更加显著。因此，$c_s$ 被解释为反映短程有序趋势的参数。",
            "answer": "$$\n\\boxed{588.75 - 0.62875 T + \\frac{15525}{T}}\n$$"
        },
        {
            "introduction": "高级固溶体模型的最终目标是预测在给定条件下的相稳定性和相平衡。本综合性编程练习要求你构建一个完整的吉布斯自由能模型，并通过计算其能量-成分曲线的凸包来确定非混相区（miscibility gap）。这项实践将理论与计算相结合，让你亲手实现从热力学第一性原理到预测材料相图的核心过程。",
            "id": "4067734",
            "problem": "实现一个程序，对于具有两个亚晶格的二元多亚晶格固溶体，计算其作为体相组分的函数的约束最小吉布斯能的下凸包，并通过识别能量函数为非凸的组分区间来检测相分离。计算必须基于吉布斯能和理想混合构型熵的基本定义，不使用任何快捷公式。\n\n考虑一个具有两个亚晶格（标记为 $A$ 和 $B$）的固溶体，其位点重复度分别为 $n_A$ 和 $n_B$。设 $x_A \\in [0,1]$ 和 $x_B \\in [0,1]$ 分别表示组分1在亚晶格 $A$ 和 $B$ 上的位点分数。体相组分 $x \\in [0,1]$ 受位点分数平均法则的约束\n$$\nx = \\frac{n_A x_A + n_B x_B}{n_A + n_B}.\n$$\n每化学式单位的吉布斯能 $G$ 被建模为理想混合贡献、线性端元参考能、亚晶格规则溶体型相互作用能和跨亚晶格耦合的总和：\n$$\nG(x_A,x_B;T) = n_A \\left[E_{1,A} x_A + E_{2,A} (1-x_A) + R T \\left(x_A \\ln x_A + (1-x_A)\\ln(1-x_A)\\right) + W_A x_A (1-x_A)\\right]\n\\\\\n+ n_B \\left[E_{1,B} x_B + E_{2,B} (1-x_B) + R T \\left(x_B \\ln x_B + (1-x_B)\\ln(1-x_B)\\right) + W_B x_B (1-x_B)\\right]\n\\\\\n+ W_{AB} (x_A - x_B)^2,\n$$\n其中 $T$ 是温度，单位为 $\\mathrm{K}$，$R$ 是摩尔气体常数，单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$E_{1,A}$、$E_{2,A}$、$E_{1,B}$、$E_{2,B}$ 是线性参考能，单位为 $\\mathrm{J\\,mol^{-1}}$，$W_A$ 和 $W_B$ 是亚晶格相互作用参数，单位为 $\\mathrm{J\\,mol^{-1}}$，$W_{AB}$ 是跨亚晶格耦合，单位为 $\\mathrm{J\\,mol^{-1}}$。理想混合熵项使用每位点构型熵的常规定义，并按亚晶格重复度进行缩放。\n\n对于每个体相组分 $x \\in [0,1]$，物理相关的能量是约束最小值\n$$\nG_{\\min}(x;T) = \\min_{x_A,x_B \\in [0,1]}\\left\\{G(x_A,x_B;T)\\ \\big|\\ n_A x_A + n_B x_B = (n_A+n_B) x\\right\\}.\n$$\n根据在固定 $T$、$P$ 和组分下的最小吉布斯能原理，平衡构型是在约束条件下使吉布斯能最小化的构型。相分离由 $G_{\\min}(x;T)$ 相对于 $x$ 的非凸性指示：如果图像 $\\{(x,G_{\\min}(x;T))\\}$ 的下凸包（即凸包）在某个区间上严格低于 $G_{\\min}(x;T)$，系统会通过分解成位于连接线两端的两相混合物来降低其能量。任务是在一个 $x$ 值的网格上数值计算下凸包，并报告与非凸区间相对应的连接线端点。\n\n从基本原理出发：\n- 混合物的吉布斯能定义以及每位点理想构型熵 $R T \\left(x \\ln x + (1-x)\\ln(1-x)\\right)$，\n- 在线性组分约束下对能量进行变分最小化，\n- 通过 $G(x)$ 相对于组分的凸性来解释稳定性，\n\n推导一个算法，该算法：\n- 使用数值约束最小化方法，为一组 $x$ 值计算 $G_{\\min}(x;T)$，\n- 构建离散点集 $(x_i, G_{\\min}(x_i;T))$ 的下凸包，\n- 检测凸包严格优于 $G_{\\min}$ 的相分离区间，并以 $[0,1]$ 内的浮点数列表形式返回相应的连接线端点。\n\n物理单位：温度 $T$ 必须以 $\\mathrm{K}$ 为单位处理，能量以 $\\mathrm{J\\,mol^{-1}}$ 为单位，组分 $x$、$x_A$、$x_B$ 是无量纲的位点分数。输出列表必须包含 $[0,1]$ 内的无量纲组分值。\n\n测试套件和参数规范：\n您的程序必须评估以下四个参数集（每个定义一个测试用例）。在所有情况下，使用 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和一个在 $[0,1]$ 上包含 $N_x = 401$ 个点的均匀组分网格。\n\n- 测试用例 1（对称，强相互作用；预期存在一个不混溶间隙）：\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 40000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 40000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n- 测试用例 2（对称，弱相互作用；预期不存在不混溶间隙）：\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 2000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 2000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n- 测试用例 3（不对称参考能，强相互作用；预期存在一个不对称的不混溶间隙）：\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 30000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 30000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 5000\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n- 测试用例 4（跨亚晶格耦合和不相等的重复度；预期存在一个受耦合影响的不混溶间隙）：\n  $T = 800\\,\\mathrm{K}$, $n_A = 2$, $n_B = 1$, $W_A = 20000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 20000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = -20000\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$。\n\n对于每个测试用例，程序必须为每个不同的不混溶间隙区间返回一个连接线端点的浮点数列表，按升序排列。如果存在一个跨越组分 $x_{\\ell}$ 到 $x_{r}$ 的不混溶间隙，则返回列表 $[x_{\\ell}, x_{r}]$。如果存在多个不相交的不混溶间隙，则按升序连接端点，例如 $[x_{\\ell,1}, x_{r,1}, x_{\\ell,2}, x_{r,2}]$。如果不存在不混溶间隙，则返回空列表 $[]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含四个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，每个元素是对应一个测试用例的列表。例如，一个有效的输出可以是 $[[x_{\\ell,1}, x_{r,1}],[],[x_{\\ell,3}, x_{r,3}],[x_{\\ell,4}, x_{r,4}]]$，所有数值均以标准十进制浮点数打印。不应打印任何额外文本。",
            "solution": "该问题要求实现一个算法，用于确定二元多亚晶格固溶体中的相稳定性。这是通过计算作为体相组分函数的约束最小吉布斯能，构建其下凸包，并识别与不混溶间隙对应的组分区间来实现的。该解决方案源于基本的热力学原理。\n\n系统的状态由组分1在两个亚晶格上的位点分数 $x_A \\in [0,1]$ 和 $x_B \\in [0,1]$ 描述。这些内部自由度通过位点重复度加权平均与宏观体相组分 $x \\in [0,1]$ 相关联：\n$$\nx = \\frac{n_A x_A + n_B x_B}{n_A + n_B}\n$$\n每化学式单位的吉布斯能 $G(x_A, x_B; T)$ 由每个亚晶格的贡献及其相互作用的总和给出：\n$$\nG(x_A,x_B;T) = n_A \\left[G_{ref,A}(x_A) + G_{mix,A}^{id}(x_A, T) + G_{ex,A}(x_A)\\right]\n\\\\\n+ n_B \\left[G_{ref,B}(x_B) + G_{mix,B}^{id}(x_B, T) + G_{ex,B}(x_B)\\right]\n\\\\\n+ G_{ex,AB}(x_A, x_B)\n$$\n其中各项为：\n- 参考能：$G_{ref,A}(x_A) = E_{1,A} x_A + E_{2,A} (1-x_A)$ 以及亚晶格 $B$ 的类似项。\n- 理想混合构型熵：$G_{mix,A}^{id}(x_A, T) = R T \\left(x_A \\ln x_A + (1-x_A)\\ln(1-x_A)\\right)$，以及 $B$ 的类似项。此项必须处理 $x \\to 0$ 和 $x \\to 1$ 的极限情况，其中 $x \\ln x \\to 0$。\n- 亚晶格过剩能（规则溶体模型）：$G_{ex,A}(x_A) = W_A x_A (1-x_A)$，以及 $B$ 的类似项。\n- 跨亚晶格过剩能：$G_{ex,AB}(x_A, x_B) = W_{AB} (x_A - x_B)^2$。\n\n根据热力学第二定律，在恒定温度 $T$、压力 $P$ 和体相组分 $x$ 下，系统将采取使吉布斯能最小化的内部构型 $(x_A, x_B)$。这定义了平衡吉布斯能函数 $G_{\\min}(x;T)$：\n$$\nG_{\\min}(x;T) = \\min_{x_A,x_B \\in [0,1]}\\left\\{G(x_A,x_B;T)\\ \\big|\\ n_A x_A + n_B x_B = (n_A+n_B) x\\right\\}\n$$\n该算法分三个主要步骤进行：\n\n**步骤 1：计算约束最小能量 $G_{\\min}(x;T)$**\n\n为了在 $N_x$ 个点 $x_i \\in [0,1]$ 的网格上计算 $G_{\\min}(x;T)$，我们为每个 $x_i$ 求解指定的约束优化问题。线性约束使我们能够降低问题的维度。假设 $n_B  0$，我们可以将 $x_B$ 表示为 $x_A$ 和固定体相组分 $x$ 的函数：\n$$\nx_B(x_A; x) = \\frac{(n_A+n_B)x - n_A x_A}{n_B}\n$$\n优化问题现在转化为关于 $x_A$ 的一维最小化问题。位点分数必须在区间 $[0,1]$ 内的物理要求对 $x_A$ 施加了界限。除了 $0 \\le x_A \\le 1$ 外，还必须满足 $0 \\le x_B \\le 1$。这导致了 $x_A$ 的以下界限：\n$$\n0 \\le \\frac{(n_A+n_B)x - n_A x_A}{n_B} \\le 1\n$$\n$$\n0 \\le (n_A+n_B)x - n_A x_A \\implies n_A x_A \\le (n_A+n_B)x \\implies x_A \\le \\frac{(n_A+n_B)x}{n_A}\n$$\n$$\n(n_A+n_B)x - n_A x_A \\le n_B \\implies (n_A+n_B)x - n_B \\le n_A x_A \\implies x_A \\ge \\frac{(n_A+n_B)x - n_B}{n_A}\n$$\n将这些与原始界限 $x_A \\in [0,1]$ 结合， $x_A$ 的搜索空间是区间 $[x_{A, \\text{min}}, x_{A, \\text{max}}]$，其中：\n$$\nx_{A, \\text{min}} = \\max\\left(0, \\frac{(n_A+n_B)x - n_B}{n_A}\\right)\n$$\n$$\nx_{A, \\text{max}} = \\min\\left(1, \\frac{(n_A+n_B)x}{n_A}\\right)\n$$\n对于网格中的每个 $x_i$，我们求解有界一维最小化问题：\n$$\nG_{\\min}(x_i;T) = \\min_{x_A \\in [x_{A, \\text{min}}, x_{A, \\text{max}}]} G(x_A, x_B(x_A; x_i); T)\n$$\n此最小化过程使用标准的有界标量优化算法（例如 `scipy.optimize.minimize_scalar` 中提供的算法）进行数值求解。\n\n**步骤 2：构建下凸包**\n\n单相固溶体的稳定性由 $G_{\\min}(x;T)$ 的凸性决定。如果该函数在某个组分范围内是非凸的，系统可以通过脱溶成两个相来达到更低的能量状态，这两相的组分由公切线构造法给出。这等效于找到 $G_{\\min}(x;T)$ 图像的下凸包（或凸包）。\n\n我们从步骤 1 得到一个离散点集 $(x_i, G_{\\min}(x_i;T))$。由于这些点自然按 $x_i$ 坐标排序，一个寻找下凸包的高效算法是 Andrew 单调链算法。该算法过程如下：\n1. 初始化一个空列表 `lower_hull`，用于存储凸包的顶点。\n2. 遍历排序后的点 $P_i = (x_i, G_{\\min}(x_i;T))$。\n3. 对于每个点 $P_i$，考虑已添加到 `lower_hull` 的最后两个点，比如 $P_{k-1}$ 和 $P_k$。使用向量 $\\vec{P_{k-1}P_k}$ 和 $\\vec{P_{k-1}P_i}$ 的叉积进行凸性测试。对于下凸包，新点 $P_i$ 必须与前两点形成“左转”或是共线的。如果它形成“右转”（即叉积 $\\le 0$），则从 `lower_hull` 中移除最后一个点 $P_k$。重复此过程，直到满足凸性条件。\n4. 将当前点 $P_i$ 添加到 `lower_hull`。\n\n结果是一个顶点列表，这些顶点定义了计算出的能量点的分段线性下凸包。\n\n**步骤 3：识别不混溶间隙**\n\n当凸包严格位于原始能量曲线 $G_{\\min}(x;T)$ 下方时，就会出现不混溶间隙。这个间隙的端点是能量曲线与凸包相切的点。在我们的离散表示中，这些切点是凸包的顶点。\n\n一个不混溶间隙由下凸包上连接两个顶点（例如 $P_j=(x_j, G_j)$ 和 $P_k=(x_k, G_k)$）的线段来识别，这两个顶点在原始点网格中不相邻（即 $P_k$ 的原始索引比 $P_j$ 的原始索引大 1 以上）。这样的线段代表连接两个共存相的连接线。这些相的组分是连接线的端点 $x_j$ 和 $x_k$。\n\n该算法通过遍历计算出的 `lower_hull` 的连续顶点来系统地检测这些间隙。如果两个连续凸包顶点的原始索引不连续，则它们的 $x$ 坐标被记录为不混溶间隙的端点。最终输出是每个测试用例的这些端点组分的列表。如果在凸包上没有找到这样的非相邻顶点，则不存在不混溶间隙，并返回一个空列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nfrom scipy.special import xlogy\n\ndef solve():\n    \"\"\"\n    Computes the lower convex envelope of the constrained minimum Gibbs energy \n    for a binary multisublattice solid solution and identifies miscibility gaps.\n    \"\"\"\n    R = 8.314462618  # Molar gas constant in J mol^-1 K^-1\n    N_x = 401        # Number of points in the composition grid\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 40000.0, 'WB': 40000.0, 'WAB': 0.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 2000.0, 'WB': 2000.0, 'WAB': 0.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 30000.0, 'WB': 30000.0, 'WAB': 0.0,\n         'E1A': 5000.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 2.0, 'nB': 1.0, 'WA': 20000.0, 'WB': 20000.0, 'WAB': -20000.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0}\n    ]\n\n    all_results = []\n\n    def entropy_term(y, T):\n        \"\"\"Calculates the ideal configurational entropy contribution RT(y*ln(y) + (1-y)*ln(1-y)).\"\"\"\n        if not (0.0 = y = 1.0): return np.inf\n        return R * T * (xlogy(y, y) + xlogy(1.0 - y, 1.0 - y))\n\n    def gibbs_energy(xA, xB, p):\n        \"\"\"Calculates the total Gibbs energy for given site fractions.\"\"\"\n        g_A = p['nA'] * (p['E1A'] * xA + p['E2A'] * (1 - xA) + \\\n                         entropy_term(xA, p['T']) + p['WA'] * xA * (1 - xA))\n        g_B = p['nB'] * (p['E1B'] * xB + p['E2B'] * (1 - xB) + \\\n                         entropy_term(xB, p['T']) + p['WB'] * xB * (1 - xB))\n        g_AB = p['WAB'] * (xA - xB)**2\n        return g_A + g_B + g_AB\n\n    for params in test_cases:\n        x_grid = np.linspace(0.0, 1.0, N_x)\n        G_min_values = np.zeros(N_x)\n\n        # Step 1: Compute G_min(x) for each x in the grid\n        for i, x in enumerate(x_grid):\n            def objective(xA, current_x, p):\n                \"\"\"1D objective function for minimization w.r.t. xA.\"\"\"\n                xB = ((p['nA'] + p['nB']) * current_x - p['nA'] * xA) / p['nB']\n                if not (0.0 = xB = 1.0): return np.inf\n                return gibbs_energy(xA, xB, p)\n            \n            # Determine bounds for the optimization variable xA\n            xA_min_bound = max(0.0, ((params['nA'] + params['nB']) * x - params['nB']) / params['nA'])\n            xA_max_bound = min(1.0, ((params['nA'] + params['nB']) * x) / params['nA'])\n\n            # Ensure bounds are valid to avoid optimizer errors\n            if xA_min_bound > xA_max_bound:\n                xA_min_bound = xA_max_bound\n\n            res = minimize_scalar(\n                objective,\n                args=(x, params),\n                bounds=(xA_min_bound, xA_max_bound),\n                method='bounded'\n            )\n            G_min_values[i] = res.fun\n\n        # Step 2: Compute lower convex hull using Andrew's monotone chain algorithm\n        points = list(zip(x_grid, G_min_values, range(N_x)))\n\n        def cross_product(p1, p2, p3):\n            \"\"\"Calculates the cross product (z-component) of vectors p1->p2 and p1->p3.\"\"\"\n            return (p2[0] - p1[0]) * (p3[1] - p1[1]) - (p2[1] - p1[1]) * (p3[0] - p1[0])\n\n        lower_hull = []\n        for p in points:\n            while len(lower_hull) >= 2 and cross_product(lower_hull[-2], lower_hull[-1], p) = 0:\n                lower_hull.pop()\n            lower_hull.append(p)\n\n        # Step 3: Identify miscibility gaps from the convex hull\n        tie_lines = []\n        for i in range(len(lower_hull) - 1):\n            p_start, p_end = lower_hull[i], lower_hull[i+1]\n            idx_start, idx_end = p_start[2], p_end[2]\n            \n            if idx_end > idx_start + 1:\n                tie_lines.extend([p_start[0], p_end[0]])\n        \n        all_results.append(tie_lines)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(str(res) for res in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}