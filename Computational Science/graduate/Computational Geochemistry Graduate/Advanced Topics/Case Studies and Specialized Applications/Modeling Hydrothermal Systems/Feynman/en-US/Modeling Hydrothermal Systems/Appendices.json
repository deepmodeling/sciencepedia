{
    "hands_on_practices": [
        {
            "introduction": "Before any complex simulation, we must ensure our chemical model is fundamentally sound by respecting the law of mass conservation. This practice introduces the powerful matrix formalism used in computational geochemistry to represent reaction networks and verify that every reaction is elementally balanced . Mastering this linear algebra approach is the first step toward building and validating robust models of complex hydrothermal systems.",
            "id": "4086909",
            "problem": "Consider a hydrothermal fluid–rock system where reactions among aqueous and mineral species occur under isothermal and isobaric conditions. From first principles, conservation of atoms requires that every reaction step conserves the count of each chemical element. In matrix terms, this requirement can be expressed by mapping species-level stoichiometries to element-level balances. Your task is to implement a program that assembles species–reaction stoichiometric matrices and species–element composition matrices for given networks, then verifies elemental mass conservation across all reactions in each network by computing the element-level net changes implied by the reaction stoichiometries. Use integer stoichiometric coefficients representing moles, with negative values for reactants and positive values for products.\n\nFundamental base:\n- Conservation of mass at the atomic level: atoms of each element are neither created nor destroyed during reactions, so for every element, the total number of atoms on the product side equals the total number of atoms on the reactant side.\n- Stoichiometry: a reaction is characterized by integers that scale species, and those integers scale the elemental counts of each species.\n- Linear mapping: aggregating species stoichiometries to element counts is a linear operation.\n\nSpecies set and elemental composition:\nLet the ordered element set be $\\{\\mathrm{H}, \\mathrm{O}, \\mathrm{Na}, \\mathrm{Cl}, \\mathrm{C}, \\mathrm{Ca}, \\mathrm{Si}, \\mathrm{Fe}\\}$ and the ordered species set be\n$\\{\\mathrm{H_2O}, \\mathrm{H^+}, \\mathrm{OH^-}, \\mathrm{Na^+}, \\mathrm{Cl^-}, \\mathrm{NaCl(aq)}, \\mathrm{CO_2(aq)}, \\mathrm{HCO_3^-}, \\mathrm{CO_3^{2-}}, \\mathrm{Ca^{2+}}, \\mathrm{CaCO_3(s)}, \\mathrm{SiO_2(aq)}, \\mathrm{Quartz(s)}, \\mathrm{Fe^{2+}}, \\mathrm{Fe^{3+}}, \\mathrm{e^-}\\}$.\nThe elemental composition vector for each species lists the count of each element in the order given above:\n- $\\mathrm{H_2O}$: $(2,1,0,0,0,0,0,0)$\n- $\\mathrm{H^+}$: $(1,0,0,0,0,0,0,0)$\n- $\\mathrm{OH^-}$: $(1,1,0,0,0,0,0,0)$\n- $\\mathrm{Na^+}$: $(0,0,1,0,0,0,0,0)$\n- $\\mathrm{Cl^-}$: $(0,0,0,1,0,0,0,0)$\n- $\\mathrm{NaCl(aq)}$: $(0,0,1,1,0,0,0,0)$\n- $\\mathrm{CO_2(aq)}$: $(0,2,0,0,1,0,0,0)$\n- $\\mathrm{HCO_3^-}$: $(1,3,0,0,1,0,0,0)$\n- $\\mathrm{CO_3^{2-}}$: $(0,3,0,0,1,0,0,0)$\n- $\\mathrm{Ca^{2+}}$: $(0,0,0,0,0,1,0,0)$\n- $\\mathrm{CaCO_3(s)}$: $(0,3,0,0,1,1,0,0)$\n- $\\mathrm{SiO_2(aq)}$: $(0,2,0,0,0,0,1,0)$\n- $\\mathrm{Quartz(s)}$: $(0,2,0,0,0,0,1,0)$\n- $\\mathrm{Fe^{2+}}$: $(0,0,0,0,0,0,0,1)$\n- $\\mathrm{Fe^{3+}}$: $(0,0,0,0,0,0,0,1)$\n- $\\mathrm{e^-}$: $(0,0,0,0,0,0,0,0)$\n\nSign convention for reaction stoichiometry:\n- For each reaction, assign a stoichiometric coefficient to each species: negative for reactants, positive for products, zero if absent.\n\nVerification target:\n- For each network, compute the element-level net changes implied by the reaction stoichiometries and return whether all element-level net changes are identically zero for every reaction in that network. Report results as booleans.\n\nTest suite:\nImplement the following networks as lists of reactions (each reaction is defined by its nonzero stoichiometric coefficients). Use the species order above when assembling matrices.\n\n- Network A (balanced hydrothermal reactions; expected to satisfy mass conservation):\n  - $\\mathrm{R_1}$: $\\mathrm{H_2O} \\rightarrow \\mathrm{H^+} + \\mathrm{OH^-}$ with coefficients $\\mathrm{H_2O}:-1$, $\\mathrm{H^+}:+1$, $\\mathrm{OH^-}:+1$.\n  - $\\mathrm{R_2}$: $\\mathrm{NaCl(aq)} \\rightarrow \\mathrm{Na^+} + \\mathrm{Cl^-}$ with coefficients $\\mathrm{NaCl(aq)}:-1$, $\\mathrm{Na^+}:+1$, $\\mathrm{Cl^-}:+1$.\n  - $\\mathrm{R_3}$: $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightarrow \\mathrm{HCO_3^-} + \\mathrm{H^+}$ with coefficients $\\mathrm{CO_2(aq)}:-1$, $\\mathrm{H_2O}:-1$, $\\mathrm{HCO_3^-}:+1$, $\\mathrm{H^+}:+1$.\n  - $\\mathrm{R_4}$: $\\mathrm{HCO_3^-} \\rightarrow \\mathrm{CO_3^{2-}} + \\mathrm{H^+}$ with coefficients $\\mathrm{HCO_3^-}:-1$, $\\mathrm{CO_3^{2-}}:+1$, $\\mathrm{H^+}:+1$.\n  - $\\mathrm{R_5}$: $\\mathrm{Ca^{2+}} + \\mathrm{HCO_3^-} + \\mathrm{OH^-} \\rightarrow \\mathrm{CaCO_3(s)} + \\mathrm{H_2O}$ with coefficients $\\mathrm{Ca^{2+}}:-1$, $\\mathrm{HCO_3^-}:-1$, $\\mathrm{OH^-}:-1$, $\\mathrm{CaCO_3(s)}:+1$, $\\mathrm{H_2O}:+1$.\n  - $\\mathrm{R_6}$: $\\mathrm{Quartz(s)} \\rightarrow \\mathrm{SiO_2(aq)}$ with coefficients $\\mathrm{Quartz(s)}:-1$, $\\mathrm{SiO_2(aq)}:+1$.\n\n- Network B (intentionally unbalanced due to a stoichiometric omission; expected to violate mass conservation):\n  - $\\mathrm{R_1}$: same as Network A.\n  - $\\mathrm{R_2}$: same as Network A.\n  - $\\mathrm{R_3'}$: $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightarrow \\mathrm{HCO_3^-}$ with coefficients $\\mathrm{CO_2(aq)}:-1$, $\\mathrm{H_2O}:-1$, $\\mathrm{HCO_3^-}:+1$.\n  - $\\mathrm{R_4}$: same as Network A.\n  - $\\mathrm{R_5}$: same as Network A.\n  - $\\mathrm{R_6}$: same as Network A.\n\n- Network C (balanced network including a redox step with an electron, which carries no elemental mass):\n  - All reactions from Network A.\n  - $\\mathrm{R_7}$: $\\mathrm{Fe^{2+}} \\rightarrow \\mathrm{Fe^{3+}} + \\mathrm{e^-}$ with coefficients $\\mathrm{Fe^{2+}}:-1$, $\\mathrm{Fe^{3+}}:+1$, $\\mathrm{e^-}:+1$.\n\nComputational requirements:\n- Assemble a species–element composition matrix $E$ of size $m \\times n$, where $m$ is the number of elements and $n$ is the number of species, using the compositions above.\n- For each network, assemble a species–reaction stoichiometric matrix $S$ of size $n \\times r$, where $r$ is the number of reactions, using the sign convention described.\n- Map reaction stoichiometry to elemental net changes by applying the composition mapping and determine if each reaction conserves all elements exactly.\n- For each network, return a boolean indicating whether all reactions conserve all elements.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the three networks as a comma-separated list enclosed in square brackets (e.g., $\\texttt{[resultA,resultB,resultC]}$). Since the results are booleans, output them as $\\texttt{True}$ or $\\texttt{False}$ with no additional text. No physical units are required because the output is boolean.",
            "solution": "The fundamental principle underpinning this problem is the law of conservation of mass, which, in the context of chemical reactions, states that the total mass of the reactants must equal the total mass of the products. At an atomic level, this translates to the conservation of the number of atoms of each element across a reaction. The problem requires us to verify this principle for several reaction networks using the tools of linear algebra.\n\nThe problem can be formalized as follows. Let the number of distinct chemical elements be $m$ and the number of distinct chemical species be $n$. For the given problem, $m=8$ and $n=16$.\n\nFirst, we define the species–element composition matrix, denoted as $E$. This is an $m \\times n$ matrix where the entry $E_{ij}$ represents the number of atoms of element $i$ in one mole of species $j$. The columns of $E$ are the elemental composition vectors for each species. The provided data for the $n=16$ species and $m=8$ elements allows for the direct construction of this matrix. The elements are ordered as $\\{\\mathrm{H}, \\mathrm{O}, \\mathrm{Na}, \\mathrm{Cl}, \\mathrm{C}, \\mathrm{Ca}, \\mathrm{Si}, \\mathrm{Fe}\\}$ and the species are ordered as $\\{\\mathrm{H_2O}, \\mathrm{H^+}, \\dots, \\mathrm{e^-}\\}$.\n\nNext, we represent a chemical reaction as a column vector $\\mathbf{s}$ of length $n$. The entries of this vector, $s_j$, are the stoichiometric coefficients of species $j$ in the reaction. By convention, $s_j < 0$ for reactants, $s_j > 0$ for products, and $s_j = 0$ if the species does not participate in the reaction.\n\nTo check for elemental conservation in a single reaction represented by vector $\\mathbf{s}$, we can compute the net change in the number of atoms for each element. This is achieved by multiplying the composition matrix $E$ by the stoichiometry vector $\\mathbf{s}$. The result is an $m \\times 1$ column vector, $\\mathbf{\\Delta}$, representing the net change for each element:\n$$\n\\mathbf{\\Delta} = E \\mathbf{s}\n$$\nThe $i$-th entry of $\\mathbf{\\Delta}$ is given by $\\Delta_i = \\sum_{j=1}^{n} E_{ij} s_j$. This sum calculates the total count of element $i$ across all products (where $s_j > 0$) and subtracts the total count of element $i$ from all reactants (where $s_j < 0$). For a reaction to be elementally balanced, the net change for every element must be zero. Therefore, the reaction conserves mass if and only if:\n$$\nE \\mathbf{s} = \\mathbf{0}\n$$\nwhere $\\mathbf{0}$ is the zero vector of size $m$.\n\nThe problem extends this concept to a network of $r$ reactions. We can assemble a species–reaction stoichiometric matrix, $S$, of size $n \\times r$, where each of the $r$ columns is the stoichiometry vector for one of the reactions in the network.\n\nThe verification of mass conservation for the entire network is then performed by a single matrix multiplication:\n$$\n\\mathbf{\\Delta}_{net} = E S\n$$\nThe resulting matrix, $\\mathbf{\\Delta}_{net}$, has dimensions $m \\times r$. Each column of $\\mathbf{\\Delta}_{net}$ corresponds to a reaction, and each row corresponds to an element. The entry $(\\mathbf{\\Delta}_{net})_{ik}$ is the net change of element $i$ in reaction $k$. A reaction network satisfies elemental mass conservation if and only if every reaction in it is balanced. This means that every entry in the $\\mathbf{\\Delta}_{net}$ matrix must be zero.\n$$\n\\mathbf{\\Delta}_{net} = \\mathbf{0}_{m \\times r}\n$$\nwhere $\\mathbf{0}_{m \\times r}$ is the $m \\times r$ zero matrix.\n\nThe computational procedure is as follows:\n1.  Construct the $m \\times n$ ($8 \\times 16$) species–element composition matrix $E$ from the given elemental formulas.\n2.  For each of the three networks (A, B, and C), construct the corresponding $n \\times r$ ($16 \\times r$) species–reaction stoichiometric matrix $S_A$, $S_B$, and $S_C$. The number of reactions $r$ is $6$ for networks A and B, and $7$ for network C.\n3.  For each network, compute the net element change matrix, e.g., $\\mathbf{\\Delta}_A = E S_A$.\n4.  For each resulting $\\mathbf{\\Delta}$ matrix, verify if all its elements are zero. If they are, all reactions in the network are balanced, and the result for that network is `True`. Otherwise, at least one reaction is unbalanced, and the result is `False`.\n\nLet's briefly analyze the test cases based on this framework.\n-   **Network A**: Contains a set of standard, balanced geochemical reactions. The product $E S_A$ is expected to be a zero matrix, yielding a result of `True`. For example, in reaction $\\mathrm{R_1}$ ($\\mathrm{H_2O} \\rightarrow \\mathrm{H^+} + \\mathrm{OH^-}$), the stoichiometry vector has $-1$ for $\\mathrm{H_2O}$, $+1$ for $\\mathrm{H^+}$, and $+1$ for $\\mathrm{OH^-}$. The elemental balance for hydrogen is $(2 \\times -1) + (1 \\times +1) + (1 \\times +1) = 0$. For oxygen, it is $(1 \\times -1) + (0 \\times +1) + (1 \\times +1) = 0$. All elements are conserved. Similar checks confirm the balance of all other reactions in Network A.\n-   **Network B**: This network is identical to A, except for reaction $\\mathrm{R_3'}$, which is $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightarrow \\mathrm{HCO_3^-}$. This reaction is intentionally unbalanced, as it omits the product $\\mathrm{H^+}$. The reactants have $2$ hydrogen atoms, while the product has only $1$. This imbalance will result in a non-zero entry in the corresponding column of the $\\mathbf{\\Delta}_B = E S_B$ matrix, specifically in the row corresponding to hydrogen. Thus, the result for Network B is expected to be `False`.\n-   **Network C**: This network includes all balanced reactions from Network A plus a redox reaction, $\\mathrm{R_7}: \\mathrm{Fe^{2+}} \\rightarrow \\mathrm{Fe^{3+}} + \\mathrm{e^-}$. The electron species, $\\mathrm{e^-}$, correctly has no elemental composition, i.e., its composition vector is all zeros. The reaction balances the element $\\mathrm{Fe}$ (one atom on each side). Therefore, this reaction conserves elemental mass. Since all reactions in Network C are balanced, the product $E S_C$ is expected to be a zero matrix, yielding a result of `True`. Charge balance is a separate constraint not considered by this problem.\n\nThe implementation will translate these matrix operations into code using the `numpy` library.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates elemental mass conservation for given geochemical reaction networks.\n    \"\"\"\n    \n    # Ordered list of elements and species to define matrix dimensions and order.\n    elements = ['H', 'O', 'Na', 'Cl', 'C', 'Ca', 'Si', 'Fe']\n    species = [\n        'H2O', 'H+', 'OH-', 'Na+', 'Cl-', 'NaCl(aq)', 'CO2(aq)', 'HCO3-', \n        'CO3^2-', 'Ca^2+', 'CaCO3(s)', 'SiO2(aq)', 'Quartz(s)', 'Fe^2+', \n        'Fe^3+', 'e-'\n    ]\n    \n    m = len(elements) # Number of elements\n    n = len(species)  # Number of species\n\n    # Create mapping from name to index for easier and more readable matrix assembly.\n    element_map = {name: i for i, name in enumerate(elements)}\n    species_map = {name: j for j, name in enumerate(species)}\n\n    # Assemble the m x n species–element composition matrix E.\n    # Each column represents the elemental composition of a species.\n    E = np.zeros((m, n), dtype=int)\n    \n    # Format: species_name: [H, O, Na, Cl, C, Ca, Si, Fe] counts\n    compositions = {\n        'H2O':      [2, 1, 0, 0, 0, 0, 0, 0],\n        'H+':       [1, 0, 0, 0, 0, 0, 0, 0],\n        'OH-':      [1, 1, 0, 0, 0, 0, 0, 0],\n        'Na+':      [0, 0, 1, 0, 0, 0, 0, 0],\n        'Cl-':      [0, 0, 0, 1, 0, 0, 0, 0],\n        'NaCl(aq)': [0, 0, 1, 1, 0, 0, 0, 0],\n        'CO2(aq)':  [0, 2, 0, 0, 1, 0, 0, 0],\n        'HCO3-':    [1, 3, 0, 0, 1, 0, 0, 0],\n        'CO3^2-':   [0, 3, 0, 0, 1, 0, 0, 0],\n        'Ca^2+':    [0, 0, 0, 0, 0, 1, 0, 0],\n        'CaCO3(s)': [0, 3, 0, 0, 1, 1, 0, 0],\n        'SiO2(aq)': [0, 2, 0, 0, 0, 0, 1, 0],\n        'Quartz(s)':[0, 2, 0, 0, 0, 0, 1, 0],\n        'Fe^2+':    [0, 0, 0, 0, 0, 0, 0, 1],\n        'Fe^3+':    [0, 0, 0, 0, 0, 0, 0, 1],\n        'e-':       [0, 0, 0, 0, 0, 0, 0, 0]\n    }\n    \n    for sp_name, comp_vector in compositions.items():\n        j = species_map[sp_name]\n        E[:, j] = comp_vector\n\n    # Define the reaction networks. Each network is a list of reactions.\n    # Each reaction is a dictionary of {species_name: stoichiometric_coefficient}.\n    \n    # Network A: Balanced hydrothermal reactions\n    network_A_reactions = [\n        {'H2O': -1, 'H+': 1, 'OH-': 1},\n        {'NaCl(aq)': -1, 'Na+': 1, 'Cl-': 1},\n        {'CO2(aq)': -1, 'H2O': -1, 'HCO3-': 1, 'H+': 1},\n        {'HCO3-': -1, 'CO3^2-': 1, 'H+': 1},\n        {'Ca^2+': -1, 'HCO3-': -1, 'OH-': -1, 'CaCO3(s)': 1, 'H2O': 1},\n        {'Quartz(s)': -1, 'SiO2(aq)': 1}\n    ]\n\n    # Network B: Intentionally unbalanced reaction\n    network_B_reactions = [\n        {'H2O': -1, 'H+': 1, 'OH-': 1},\n        {'NaCl(aq)': -1, 'Na+': 1, 'Cl-': 1},\n        {'CO2(aq)': -1, 'H2O': -1, 'HCO3-': 1}, # R3' is unbalanced\n        {'HCO3-': -1, 'CO3^2-': 1, 'H+': 1},\n        {'Ca^2+': -1, 'HCO3-': -1, 'OH-': -1, 'CaCO3(s)': 1, 'H2O': 1},\n        {'Quartz(s)': -1, 'SiO2(aq)': 1}\n    ]\n\n    # Network C: Balanced network including a redox step\n    network_C_reactions = network_A_reactions + [\n        {'Fe^2+': -1, 'Fe^3+': 1, 'e-': 1}\n    ]\n    \n    test_cases = [network_A_reactions, network_B_reactions, network_C_reactions]\n    results = []\n\n    for reactions in test_cases:\n        r = len(reactions) # Number of reactions in the network\n        \n        # Assemble the n x r species-reaction stoichiometric matrix S.\n        # Each column is a reaction's stoichiometry vector.\n        S = np.zeros((n, r), dtype=int)\n        for k, reaction in enumerate(reactions):\n            for sp_name, coeff in reaction.items():\n                j = species_map[sp_name]\n                S[j, k] = coeff\n        \n        # Compute the m x r element-level net change matrix, Delta = E * S.\n        delta = E @ S\n        \n        # A network is balanced if and only if the delta matrix is all zeros.\n        is_balanced = np.all(delta == 0)\n        results.append(is_balanced)\n\n    # Format and print the final output as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Many hydrothermal systems exist as two-phase mixtures of liquid water and vapor, and quantifying the proportions of these phases is a critical task. This exercise guides you through the derivation and application of the lever rule, a fundamental thermodynamic tool for determining phase fractions based on bulk specific enthalpy . This practice is essential for understanding fluid properties and energy transport in geothermal reservoirs and mid-ocean ridge vent systems.",
            "id": "4086927",
            "problem": "A hydrothermal fluid parcel composed of pure water is held at constant temperature $T=250\\,^{\\circ}\\mathrm{C}$ and pressure $p=40\\,\\mathrm{bar}$, conditions that place the system at liquid–vapor coexistence. Assume local thermodynamic equilibrium between the coexisting phases, mechanical equilibrium, and negligible heat capacity changes within each phase over the small mass exchanges considered. The foundational base you must use is: conservation of mass, extensivity of enthalpy, and the definition of specific enthalpy as energy per unit mass. Specifically, rely only on the facts that (i) total mass $m$ is the sum of phase masses $m_\\ell$ and $m_v$, (ii) total enthalpy $H$ is the sum of phase enthalpies $H_\\ell$ and $H_v$, and (iii) the specific enthalpy of the mixture $h$ is the mass-weighted average of phase-specific enthalpies at equilibrium. For saturated water at the stated conditions, use constant phase-specific enthalpies $h_\\ell=1085.73\\,\\mathrm{kJ\\,kg^{-1}}$ for the liquid and $h_v=2803.20\\,\\mathrm{kJ\\,kg^{-1}}$ for the vapor.\n\nYour tasks are:\n- Derive, from the stated base, the lever rule giving liquid and vapor mass fractions as functions of the bulk specific enthalpy $h$ and the phase-specific enthalpies $h_\\ell$ and $h_v$ at the same $T$ and $p$.\n- Implement the derived rule to compute the ordered pair of mass fractions $\\left[x_\\ell,x_v\\right]$, where $x_\\ell=m_\\ell/m$ and $x_v=m_v/m$, for a set of bulk specific enthalpies $h$ (expressed in $\\mathrm{kJ\\,kg^{-1}}$). Enforce physical bounds so that if $h<h_\\ell$ the mixture is single-phase liquid with $\\left[x_\\ell,x_v\\right]=\\left[1,0\\right]$, and if $h>h_v$ the mixture is single-phase vapor with $\\left[x_\\ell,x_v\\right]=\\left[0,1\\right]$; when $h$ equals either bound, the corresponding pure-phase fractions apply exactly.\n\nUse the following test suite of bulk specific enthalpies $h$ in $\\mathrm{kJ\\,kg^{-1}}$:\n- Case 1: $h=1085.73$ (exactly saturated liquid).\n- Case 2: $h=\\dfrac{h_\\ell+h_v}{2}$ (midpoint mixture).\n- Case 3: $h=2803.20$ (exactly saturated vapor).\n- Case 4: $h=1000.00$ (below the two-phase interval).\n- Case 5: $h=2900.00$ (above the two-phase interval).\n- Case 6: $h=1085.731$ (slightly above saturated liquid).\n\nAll numerical outputs must be dimensionless mass fractions, expressed as decimal floats rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list holding $\\left[x_\\ell,x_v\\right]$ for the corresponding test case in the order listed above, enclosed in square brackets; for example, an output of the form $\\left[\\left[x_{\\ell,1},x_{v,1}\\right],\\left[x_{\\ell,2},x_{v,2}\\right],\\ldots\\right]$ must be printed as a single Python list literal string like $[[x_{\\ell,1},x_{v,1}],[x_{\\ell,2},x_{v,2}],\\ldots]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in fundamental principles of thermodynamics, specifically the conservation of mass and the extensivity of enthalpy for a two-phase system at equilibrium. The problem is well-posed, providing all necessary data and constraints to derive a unique, stable solution. The language is objective and the parameters provided ($T=250\\,^{\\circ}\\mathrm{C}$, $p=40\\,\\mathrm{bar}$, $h_\\ell=1085.73\\,\\mathrm{kJ\\,kg^{-1}}$, $h_v=2803.20\\,\\mathrm{kJ\\,kg^{-1}}$ for water) are physically realistic for liquid-vapor coexistence. The task involves a standard derivation of the lever rule and its direct application, which is a foundational and non-trivial exercise in chemical thermodynamics and geochemistry.\n\nThe derivation of the lever rule for mass fractions proceeds from the foundational principles stated in the problem. Let $m$ be the total mass of the fluid parcel, $m_\\ell$ be the mass of the liquid phase, and $m_v$ be the mass of the vapor phase. The corresponding mass fractions are defined as $x_\\ell = m_\\ell / m$ and $x_v = m_v / m$.\n\n1.  **Conservation of Mass**: The total mass is the sum of the masses of the individual phases.\n    $$m = m_\\ell + m_v$$\n    Dividing the entire equation by the total mass $m$ yields the relationship between the mass fractions:\n    $$\\frac{m}{m} = \\frac{m_\\ell}{m} + \\frac{m_v}{m}$$\n    $$1 = x_\\ell + x_v$$\n    This provides our first governing equation.\n\n2.  **Extensivity of Enthalpy**: The total enthalpy $H$ of the mixture is the sum of the enthalpies of the constituent phases, $H_\\ell$ and $H_v$.\n    $$H = H_\\ell + H_v$$\n    The specific enthalpy of a system is its total enthalpy per unit mass. For the bulk mixture, the specific enthalpy is $h = H/m$. For the individual phases at equilibrium, the specific enthalpies are $h_\\ell = H_\\ell/m_\\ell$ and $h_v = H_v/m_v$. These relations can be rearranged to express phase enthalpies as $H_\\ell = m_\\ell h_\\ell$ and $H_v = m_v h_v$.\n\n3.  **Derivation**: We combine these principles. We start with the definition of the bulk specific enthalpy and substitute the expressions from the preceding steps.\n    $$h = \\frac{H}{m}$$\n    Substituting the expression for total enthalpy $H$:\n    $$h = \\frac{H_\\ell + H_v}{m}$$\n    Substituting the expressions for phase enthalpies $H_\\ell$ and $H_v$:\n    $$h = \\frac{m_\\ell h_\\ell + m_v h_v}{m}$$\n    Separating the terms gives the definition of the mixture's specific enthalpy as a mass-weighted average of the phase-specific enthalpies, as stated in the problem:\n    $$h = \\left(\\frac{m_\\ell}{m}\\right) h_\\ell + \\left(\\frac{m_v}{m}\\right) h_v$$\n    $$h = x_\\ell h_\\ell + x_v h_v$$\n    This provides our second governing equation.\n\nWe now have a system of two linear equations with two unknown mass fractions, $x_\\ell$ and $x_v$:\n    $$x_\\ell + x_v = 1$$\n    $$x_\\ell h_\\ell + x_v h_v = h$$\nTo solve for the vapor fraction $x_v$, we first express $x_\\ell$ in terms of $x_v$ using the first equation: $x_\\ell = 1 - x_v$. Substituting this into the second equation:\n    $$(1 - x_v) h_\\ell + x_v h_v = h$$\n    $$h_\\ell - x_v h_\\ell + x_v h_v = h$$\n    Rearranging to isolate terms with $x_v$:\n    $$x_v (h_v - h_\\ell) = h - h_\\ell$$\n    Solving for $x_v$ yields the lever rule for the vapor mass fraction:\n    $$x_v = \\frac{h - h_\\ell}{h_v - h_\\ell}$$\nTo find the liquid fraction $x_\\ell$, we substitute this result back into the mass balance equation $x_\\ell = 1 - x_v$:\n    $$x_\\ell = 1 - \\frac{h - h_\\ell}{h_v - h_\\ell}$$\n    $$x_\\ell = \\frac{(h_v - h_\\ell) - (h - h_\\ell)}{h_v - h_\\ell}$$\n    $$x_\\ell = \\frac{h_v - h_\\ell - h + h_\\ell}{h_v - h_\\ell}$$\n    This simplifies to the lever rule for the liquid mass fraction:\n    $$x_\\ell = \\frac{h_v - h}{h_v - h_\\ell}$$\nThese equations are valid for any bulk specific enthalpy $h$ within the two-phase region, i.e., for $h_\\ell \\le h \\le h_v$.\n\nThe physical boundaries defined in the problem must be enforced:\n-   If the bulk specific enthalpy $h$ is less than that of the saturated liquid ($h < h_\\ell$), the system is a single-phase subcooled liquid. Thus, $x_\\ell=1$ and $x_v=0$.\n-   If the bulk specific enthalpy $h$ is greater than that of the saturated vapor ($h > h_v$), the system is a single-phase superheated vapor. Thus, $x_\\ell=0$ and $x_v=1$.\n-   If $h$ is exactly at a boundary ($h=h_\\ell$ or $h=h_v$), the system is a pure saturated phase, and the derived formulas correctly yield $[1, 0]$ and $[0, 1]$, respectively.\n\nThe implementation will therefore check if $h$ is outside the range $[h_\\ell, h_v]$ and apply the single-phase conditions, otherwise it will apply the derived lever rule formulas.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies the lever rule to calculate liquid and vapor mass\n    fractions for a two-phase water system at specified test conditions.\n    \"\"\"\n\n    # Define the constant phase-specific enthalpies from the problem.\n    # h_l: specific enthalpy of saturated liquid [kJ/kg]\n    # h_v: specific enthalpy of saturated vapor [kJ/kg]\n    h_l = 1085.73\n    h_v = 2803.20\n\n    def calculate_mass_fractions(h, h_l_const, h_v_const):\n        \"\"\"\n        Calculates the liquid and vapor mass fractions [x_l, x_v] for a\n        given bulk specific enthalpy h.\n\n        Args:\n            h (float): Bulk specific enthalpy of the mixture [kJ/kg].\n            h_l_const (float): Specific enthalpy of the saturated liquid phase.\n            h_v_const (float): Specific enthalpy of the saturated vapor phase.\n\n        Returns:\n            list[float]: A list containing the liquid and vapor mass fractions,\n                         [x_l, x_v], rounded to six decimal places.\n        \"\"\"\n        # Condition 1: Subcooled liquid region (or saturated liquid)\n        # If h is at or below the liquid enthalpy, it is 100% liquid.\n        if h <= h_l_const:\n            x_l = 1.0\n            x_v = 0.0\n        # Condition 2: Superheated vapor region (or saturated vapor)\n        # If h is at or above the vapor enthalpy, it is 100% vapor.\n        elif h >= h_v_const:\n            x_l = 0.0\n            x_v = 1.0\n        # Condition 3: Two-phase (liquid-vapor mixture) region\n        # Apply the derived lever rule.\n        else:\n            # Vapor mass fraction\n            x_v = (h - h_l_const) / (h_v_const - h_l_const)\n            # Liquid mass fraction from mass balance (x_l = 1 - x_v)\n            x_l = 1.0 - x_v\n\n        # Return fractions rounded to six decimal places as required.\n        return [round(x_l, 6), round(x_v, 6)]\n\n    # Define the test cases for bulk specific enthalpy h [kJ/kg].\n    test_cases = [\n        1085.73,           # Case 1: Exactly saturated liquid\n        (h_l + h_v) / 2.0, # Case 2: Midpoint mixture\n        2803.20,           # Case 3: Exactly saturated vapor\n        1000.00,           # Case 4: Subcooled liquid\n        2900.00,           # Case 5: Superheated vapor\n        1085.731,          # Case 6: Slightly into the two-phase region\n    ]\n\n    results = []\n    for h_case in test_cases:\n        fractions = calculate_mass_fractions(h_case, h_l, h_v)\n        results.append(fractions)\n\n    # The final print statement must produce only the specified single-line format.\n    # The str() representation of a list is '[item1, item2]', which matches\n    # the required format for the inner lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In the high-salinity brines common to many hydrothermal environments, interactions between ions cause significant deviations from ideal thermodynamic behavior. This practice moves beyond ideal assumptions by implementing the Pitzer model to calculate mean activity coefficients, demonstrating their profound impact on the calculated $\\mathrm{pH}$ of a fluid . Accurately modeling these non-ideal effects is crucial for predicting mineral solubility and reaction pathways in realistic geochemical systems.",
            "id": "4086915",
            "problem": "You are to model the non-ideality of a sodium chloride ($\\mathrm{NaCl}$) brine and quantify its impact on the calculated acidity (expressed as $-\\log_{10}$ of hydrogen ion activity) of water due to the water autoionization equilibrium. Work within the computational geochemistry context of hydrothermal systems using a physically consistent framework. Your task is to implement a program that, for a given set of molalities of $\\mathrm{NaCl}$, computes the mean activity coefficient $\\gamma_{\\pm}$ of $\\mathrm{NaCl}$ and then computes the corresponding change in calculated $\\mathrm{pH}$ of water when the brine is present as a background electrolyte.\n\nFundamental base to use:\n- Definition of activity: $a_i = m_i \\,\\gamma_i$, where $a_i$ is the activity, $m_i$ is the molality, and $\\gamma_i$ is the activity coefficient of species $i$.\n- Ionic strength in molal units: $I = \\frac{1}{2}\\sum_i m_i z_i^2$. For a binary $1$:$1$ electrolyte $\\mathrm{NaCl}$ with $z_{\\mathrm{Na}^{+}}=+1$ and $z_{\\mathrm{Cl}^{-}}=-1$, at total $\\mathrm{NaCl}$ molality $m$, electroneutrality implies $m_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}} = m$, so $I = m$.\n- Water autoprotolysis equilibrium constant (activity-based): $K_w = a_{\\mathrm{H}^{+}}\\,a_{\\mathrm{OH}^{-}}$. At $25\\,^{\\circ}\\mathrm{C}$, use $K_w = 1.0\\times 10^{-14}$ (dimensionless on the molality activity scale). In a solution containing only $\\mathrm{H^+}$ and $\\mathrm{OH^-}$, electroneutrality gives $m_{\\mathrm{H}^{+}} = m_{\\mathrm{OH}^{-}}$. With a background $1$:$1$ electrolyte like $\\mathrm{NaCl}$, electroneutrality still implies $m_{\\mathrm{H}^{+}} = m_{\\mathrm{OH}^{-}}$ when no other acid or base is present. Combining, $m_{\\mathrm{H}^{+}}^2\\,\\gamma_{\\mathrm{H}^{+}}\\,\\gamma_{\\mathrm{OH}^{-}} = K_w$, so $a_{\\mathrm{H}^{+}} = m_{\\mathrm{H}^{+}}\\gamma_{\\mathrm{H}^{+}} = \\sqrt{K_w\\,\\gamma_{\\mathrm{H}^{+}}/\\gamma_{\\mathrm{OH}^{-}}}$ and $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^{+}})$.\n- Debye–Hückel theory for the long-range electrostatic term, and the Pitzer model for short-range interactions in electrolytes. For a symmetric $1$:$1$ electrolyte $\\mathrm{NaCl}$ with molality $m$ and ionic strength $I=m$, use the standard one-parameter Pitzer formulation for the mean activity coefficient in natural logarithm form:\n  $$\\ln \\gamma_{\\pm} = -\\ln(10)\\,A_{\\gamma}\\,\\frac{\\sqrt{I}}{1 + b\\,\\sqrt{I}} \\;+\\; m\\left(2\\beta^{(0)} + 2\\beta^{(1)}\\,g(\\alpha \\sqrt{I})\\right)\\;+\\; m^2\\,C_{\\phi},$$\n  where $A_{\\gamma}$ is the Debye–Hückel constant for the activity coefficient in base-$10$ logarithm units at $25\\,^{\\circ}\\mathrm{C}$, $b$ is the Pitzer model parameter for the long-range term in molality scale, $\\alpha$ is the argument coefficient in the Pitzer $g$-function, $\\beta^{(0)}$, $\\beta^{(1)}$, and $C_{\\phi}$ are the $\\mathrm{NaCl}$ Pitzer interaction parameters, and $g(x)$ is defined as\n  $$g(x) = \\begin{cases}\n  \\frac{2}{x^2}\\left[1 - (1+x)\\,e^{-x}\\right], & x > 0,\\\\\n  1, & x=0\\ \\text{(by limit as $x\\to 0$)}.\n  \\end{cases}$$\n  This expression combines the long-range Debye–Hückel term and short-range Pitzer interaction terms, appropriate for $1$:$1$ electrolytes.\n- For $\\mathrm{H^+}$ and $\\mathrm{OH^-}}$ in a $\\mathrm{NaCl}$ background electrolyte, use the extended Debye–Hückel equation in base-$10$ logarithm form to approximate single-ion activity coefficients:\n  $$\\log_{10}\\gamma_i = -A_{\\gamma}\\,z_i^2\\,\\frac{\\sqrt{I}}{1 + B\\,a_i\\,\\sqrt{I}},$$\n  where $z_i$ is the ionic charge, $a_i$ is an effective ion-size parameter in ångströms, $A_{\\gamma}$ is the same Debye–Hückel constant at $25\\,^{\\circ}\\mathrm{C}$, and $B$ is the Debye–Hückel slope constant for the molality scale. This introduces a physically motivated difference between $\\gamma_{\\mathrm{H}^{+}}$ and $\\gamma_{\\mathrm{OH}^{-}}$ through distinct $a_i$ values.\n\nParameter values to use at $25\\,^{\\circ}\\mathrm{C}$:\n- Debye–Hückel constants: $A_{\\gamma} = 0.509$ (base-$10$ logarithm units), $B = 1.6\\,\\mathrm{kg^{1/2}\\,mol^{-1/2}\\,Å^{-1}}$.\n- Pitzer long-range parameter: $b = 1.2$ (molality scale).\n- Pitzer $g$-function argument coefficient: $\\alpha = 2.0$.\n- $\\mathrm{NaCl}$ Pitzer interaction parameters at $25\\,^{\\circ}\\mathrm{C}$: $\\beta^{(0)} = 0.0765$, $\\beta^{(1)} = 0.2664$, $C_{\\phi} = 0.00127$.\n- Ion-size parameters for extended Debye–Hückel: $a_{\\mathrm{H}^{+}} = 9.0\\,\\mathrm{Å}$, $a_{\\mathrm{OH}^{-}} = 3.5\\,\\mathrm{Å}$.\n- Water autoprotolysis constant: $K_w = 1.0\\times 10^{-14}$ (dimensionless activity product on the molality scale at $25\\,^{\\circ}\\mathrm{C}$).\n\nAlgorithmic objectives:\n1. For each specified $\\mathrm{NaCl}$ molality $m$, compute $I=m$, evaluate $\\ln \\gamma_{\\pm}$ via the Pitzer expression above, and return $\\gamma_{\\pm} = \\exp(\\ln \\gamma_{\\pm})$.\n2. Compute $\\gamma_{\\mathrm{H}^{+}}$ and $\\gamma_{\\mathrm{OH}^{-}}$ via the extended Debye–Hückel equation at ionic strength $I$ with $z_{\\mathrm{H}^{+}}=+1$ and $z_{\\mathrm{OH}^{-}}=-1$ and the given $a_i$ values, then compute the non-ideal $\\mathrm{pH}$ as $\\mathrm{pH} = -\\log_{10}\\left(\\sqrt{K_w\\,\\gamma_{\\mathrm{H}^{+}}/\\gamma_{\\mathrm{OH}^{-}}}\\right)$.\n3. Compute the ideal reference $\\mathrm{pH}$ at $25\\,^{\\circ}\\mathrm{C}$ as $\\mathrm{pH}_{\\mathrm{ideal}} = -\\frac{1}{2}\\log_{10}K_w = 7.0$, and the change in $\\mathrm{pH}$ due to nonideality as $\\Delta \\mathrm{pH} = \\mathrm{pH} - \\mathrm{pH}_{\\mathrm{ideal}}$.\n\nRequired units and output:\n- Molality must be in $\\mathrm{mol\\,kg^{-1}}$ (molality scale).\n- All computed activity coefficients are dimensionless.\n- The acidity must be reported as $\\mathrm{pH}$, which is unitless by definition.\n- The final program output must be a single line containing a list of results for all test cases. For each test case, return a list of three floats in the order $[\\gamma_{\\pm}, \\mathrm{pH}, \\Delta \\mathrm{pH}]$. Aggregate all test cases into a single list and print it in the exact string form of a Python list of lists, for example: \"[[gamma1,pH1,delta1],[gamma2,pH2,delta2],...]\".\n\nTest suite:\n- Case A (boundary): $m = 0.0\\,\\mathrm{mol\\,kg^{-1}}$.\n- Case B (hydrothermal-strength brine): $m = 2.0\\,\\mathrm{mol\\,kg^{-1}}$.\n- Case C (near-upper-strength brine for model validity): $m = 5.0\\,\\mathrm{mol\\,kg^{-1}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of three floats corresponding to the above order, for all three test cases in the specified order.",
            "solution": "The user has provided a problem statement that successfully passes all validation criteria. It is scientifically grounded in the principles of physical chemistry and geochemistry, specifically using the Pitzer and extended Debye-Hückel models to account for non-ideal behavior in concentrated electrolyte solutions. The problem is well-posed, with all necessary equations, constants, and parameters provided, ensuring a unique and stable solution can be computed. The language is objective, and the task is a relevant and non-trivial exercise in computational geochemistry. Therefore, I will now present a complete and reasoned solution.\n\nThe objective is to quantify the effect of a background sodium chloride ($\\mathrm{NaCl}$) electrolyte on the pH of water. In an ideal solution, the activities of dissolved species are equal to their molalities, and pure water at $25\\,^{\\circ}\\mathrm{C}$ has a pH of exactly $7.0$. However, in real solutions, electrostatic interactions between ions cause their effective concentrations, or activities, to deviate from their molalities. This deviation is captured by the activity coefficient, $\\gamma$. This solution will implement established thermodynamic models to calculate these effects.\n\nThe algorithmic solution is structured into three main computational steps, following the principles outlined in the problem statement.\n\n### Step 1: Mean Activity Coefficient of $\\mathrm{NaCl}$ ($\\gamma_{\\pm}$)\n\nFirst, we calculate the mean activity coefficient of the background electrolyte, $\\mathrm{NaCl}$, using the Pitzer model. This model is highly effective for concentrated solutions and combines a long-range electrostatic term, rooted in Debye-Hückel theory, with short-range, ion-specific interaction terms.\n\nFor a $1$:$1$ electrolyte like $\\mathrm{NaCl}$ at molality $m$, the ionic strength $I$ is equal to $m$. The Pitzer equation for the natural logarithm of the mean activity coefficient, $\\ln \\gamma_{\\pm}$, is given as:\n$$\n\\ln \\gamma_{\\pm} = -\\ln(10)\\,A_{\\gamma}\\,\\frac{\\sqrt{I}}{1 + b\\,\\sqrt{I}} \\;+\\; m\\left(2\\beta^{(0)} + 2\\beta^{(1)}\\,g(\\alpha \\sqrt{I})\\right)\\;+\\; m^2\\,C_{\\phi}\n$$\nThe first term is the modified Debye-Hückel term, accounting for long-range interactions. The constant $A_{\\gamma}$ is the Debye-Hückel slope for base-$10$ logarithms, so we multiply by $\\ln(10)$ to convert it for use in the natural logarithm expression. The parameters $b$, $\\beta^{(0)}$, $\\beta^{(1)}$, and $C_{\\phi}$ are empirically determined for $\\mathrm{NaCl}$ at $25\\,^{\\circ}\\mathrm{C}$.\n\nThe second and third terms account for short-range binary ($m$) and ternary ($m^2$) interactions, respectively. The function $g(x)$ is a specific integral function used in the Pitzer formalism:\n$$\ng(x) = \\frac{2}{x^2}\\left[1 - (1+x)\\,e^{-x}\\right]\n$$\nIn the limiting case where the molality $m \\to 0$, the ionic strength $I \\to 0$, causing all terms in the $\\ln \\gamma_{\\pm}$ expression to approach zero. Consequently, $\\ln \\gamma_{\\pm} \\to 0$ and $\\gamma_{\\pm} \\to 1$, which correctly represents the behavior of an infinitely dilute (ideal) solution.\n\nThe algorithm will implement a function to compute $g(x)$, being careful to handle the limiting case $g(0)=1$. Another function will take the molality $m$ as input, calculate $I=m$, and evaluate the Pitzer expression to find $\\ln \\gamma_{\\pm}$, finally returning $\\gamma_{\\pm} = \\exp(\\ln \\gamma_{\\pm})$.\n\n### Step 2: Single-Ion Activity Coefficients and pH Calculation\n\nNext, we determine the pH of the brine. The pH is defined by the activity of the hydrogen ion, $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$. The activities of $\\mathrm{H^+}$ and $\\mathrm{OH^-}$ are governed by the water autoionization equilibrium:\n$$\nK_w = a_{\\mathrm{H}^{+}}\\,a_{\\mathrm{OH}^{-}} = (m_{\\mathrm{H}^{+}}\\gamma_{\\mathrm{H}^{+}})(m_{\\mathrm{OH}^{-}}\\gamma_{\\mathrm{OH}^{-}})\n$$\nIn a neutral solution containing only water and a salt like $\\mathrm{NaCl}$, the condition of charge neutrality requires that the molality of hydrogen ions equals that of hydroxide ions, $m_{\\mathrm{H}^{+}} = m_{\\mathrm{OH}^{-}}$. Substituting this into the equilibrium expression gives:\n$$\nK_w = m_{\\mathrm{H}^{+}}^2\\,\\gamma_{\\mathrm{H}^{+}}\\,\\gamma_{\\mathrm{OH}^{-}}\n$$\nSolving for the activity of $\\mathrm{H}^{+}$:\n$$\na_{\\mathrm{H}^{+}} = m_{\\mathrm{H}^{+}}\\gamma_{\\mathrm{H}^{+}} = \\sqrt{K_w \\frac{\\gamma_{\\mathrm{H}^{+}}}{\\gamma_{\\mathrm{OH}^{-}}}}\n$$\nTo find $a_{\\mathrm{H}^{+}}$, we must first calculate the single-ion activity coefficients, $\\gamma_{\\mathrm{H}^{+}}$ and $\\gamma_{\\mathrm{OH}^{-}}$. Since these ions are present in trace amounts, their interactions are dominated by the background $\\mathrm{NaCl}$ electrolyte. We can approximate their activity coefficients using the extended Debye-Hückel equation:\n$$\n\\log_{10}\\gamma_i = -A_{\\gamma}\\,z_i^2\\,\\frac{\\sqrt{I}}{1 + B\\,a_i\\,\\sqrt{I}}\n$$\nHere, $z_i$ is the charge of the ion ($+1$ for $\\mathrm{H}^{+}$, $-1$ for $\\mathrm{OH}^{-}$), $a_i$ is the effective hydrated ion-size parameter, and $B$ is a constant. The differing ion-size parameters for $\\mathrm{H}^{+}$ ($a_{\\mathrm{H}^{+}} = 9.0\\,\\mathrm{Å}$) and $\\mathrm{OH}^{-}$ ($a_{\\mathrm{OH}^{-}} = 3.5\\,\\mathrm{Å}$) are the crucial factors that cause their activity coefficients to differ, thus shifting the pH from neutral. For both ions, $z_i^2 = 1$.\n\nThe algorithm will implement a function that computes $\\gamma_i = 10^{\\log_{10}\\gamma_i}$ using this formula, taking ionic strength $I$, charge $z_i$, and size $a_i$ as inputs.\n\n### Step 3: Change in pH ($\\Delta \\mathrm{pH}$)\n\nFinally, we compute the non-ideal pH and its deviation from the ideal pH of $7.0$. Taking the negative base-$10$ logarithm of the expression for $a_{\\mathrm{H}^{+}}$ yields the pH:\n$$\n\\mathrm{pH} = -\\log_{10}\\left(\\sqrt{K_w \\frac{\\gamma_{\\mathrm{H}^{+}}}{\\gamma_{\\mathrm{OH}^{-}}}}\\right) = -\\frac{1}{2}\\left(\\log_{10}K_w + \\log_{10}\\gamma_{\\mathrm{H}^{+}} - \\log_{10}\\gamma_{\\mathrm{OH}^{-}}\\right)\n$$\nRecognizing that the ideal pH is $\\mathrm{pH}_{\\mathrm{ideal}} = -\\frac{1}{2}\\log_{10}K_w = 7.0$ (for $K_w = 1.0 \\times 10^{-14}$), we can write:\n$$\n\\mathrm{pH} = \\mathrm{pH}_{\\mathrm{ideal}} - \\frac{1}{2}\\left(\\log_{10}\\gamma_{\\mathrm{H}^{+}} - \\log_{10}\\gamma_{\\mathrm{OH}^{-}}\\right)\n$$\nThe change in pH, $\\Delta \\mathrm{pH} = \\mathrm{pH} - \\mathrm{pH}_{\\mathrm{ideal}}$, is therefore:\n$$\n\\Delta \\mathrm{pH} = -\\frac{1}{2}\\left(\\log_{10}\\gamma_{\\mathrm{H}^{+}} - \\log_{10}\\gamma_{\\mathrm{OH}^{-}}\\right)\n$$\nThis elegant result shows that the pH shift is directly proportional to the difference in the logarithms of the activity coefficients of $\\mathrm{H}^{+}$ and $\\mathrm{OH}^{-}$. The algorithm will compute pH and $\\Delta \\mathrm{pH}$ using these expressions for each given molality of $\\mathrm{NaCl}$.\n\nThe implementation will process each test case ($m=0.0$, $m=2.0$, and $m=5.0\\,\\mathrm{mol\\,kg^{-1}}$), calculating the triplet $[\\gamma_{\\pm}, \\mathrm{pH}, \\Delta \\mathrm{pH}]$ and aggregating the results into a single list of lists for the final output, as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes NaCl activity coefficient and pH effects in brines using Pitzer and Debye-Hückel models.\n    \"\"\"\n\n    # --- Define constants and parameters at 25°C ---\n    # Debye-Hückel constants\n    A_gamma = 0.509  # Base-10 logarithm units, dimensionless\n    B = 1.6          # kg^(1/2) mol^(-1/2) Å^(-1)\n\n    # Pitzer model parameters for NaCl\n    b = 1.2          # kg^(1/2) mol^(-1/2)\n    alpha = 2.0      # kg^(1/2) mol^(-1/2)\n    beta_0 = 0.0765  # kg mol^(-1)\n    beta_1 = 0.2664  # kg mol^(-1)\n    C_phi = 0.00127  # kg^2 mol^(-2)\n\n    # Ion-size parameters for extended Debye-Hückel\n    a_H_plus = 9.0   # Å\n    a_OH_minus = 3.5 # Å\n    \n    # Water autoprotolysis constant\n    K_w = 1.0e-14\n    \n    # Ideal pH reference\n    pH_ideal = 7.0\n\n    # --- Test Cases ---\n    test_cases = [\n        0.0,  # Case A: Boundary condition (pure water)\n        2.0,  # Case B: Hydrothermal-strength brine\n        5.0,  # Case C: Near-upper-strength brine\n    ]\n\n    # --- Helper function for Pitzer g(x) ---\n    def g_func(x):\n        \"\"\"\n        Pitzer model g(x) function.\n        g(x) = (2/x^2) * [1 - (1+x)*exp(-x)]\n        \"\"\"\n        if x == 0:\n            return 1.0\n        return (2 / x**2) * (1 - (1 + x) * np.exp(-x))\n\n    # --- Main Calculation Loop ---\n    results = []\n    for m in test_cases:\n        # Molality (m) and Ionic Strength (I) for 1:1 electrolyte are equal\n        I = m\n        \n        # --- 1. Calculate NaCl mean activity coefficient (gamma_pm) via Pitzer model ---\n        if I == 0:\n            gamma_pm = 1.0\n        else:\n            sqrt_I = np.sqrt(I)\n            \n            # Debye-Hückel term (long-range)\n            dh_term = -np.log(10) * A_gamma * (sqrt_I / (1 + b * sqrt_I))\n            \n            # Pitzer interaction terms (short-range)\n            g_val = g_func(alpha * sqrt_I)\n            pitzer_term_B = m * (2 * beta_0 + 2 * beta_1 * g_val)\n            pitzer_term_C = m**2 * C_phi\n            \n            ln_gamma_pm = dh_term + pitzer_term_B + pitzer_term_C\n            gamma_pm = np.exp(ln_gamma_pm)\n\n        # --- 2. Calculate single-ion activity coefficients and pH ---\n        if I == 0:\n            log10_gamma_H = 0.0\n            log10_gamma_OH = 0.0\n        else:\n            sqrt_I = np.sqrt(I)\n            # H+ ion\n            log10_gamma_H = -A_gamma * (1**2) * (sqrt_I / (1 + B * a_H_plus * sqrt_I))\n            # OH- ion\n            log10_gamma_OH = -A_gamma * ((-1)**2) * (sqrt_I / (1 + B * a_OH_minus * sqrt_I))\n\n        # --- 3. Compute non-ideal pH and the change in pH (Delta_pH) ---\n        # pH = pH_ideal - 0.5 * (log10_gamma_H - log10_gamma_OH)\n        delta_pH = -0.5 * (log10_gamma_H - log10_gamma_OH)\n        pH = pH_ideal + delta_pH\n        \n        results.append([gamma_pm, pH, delta_pH])\n\n    # --- Format and print the final output ---\n    # The output format is a string representation of a Python list of lists.\n    # e.g., \"[[g1,p1,d1],[g2,p2,d2]]\"\n    str_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}