{
    "hands_on_practices": [
        {
            "introduction": "准确的状态方程 (Equation of State, EOS) 是模拟超临界流体的基石，因为在高温高压下，流体的密度和摩尔体积等性质会显著偏离理想气体行为。这些性质是后续反应和输运模型的关键输入参数。本练习将指导你为彭-罗宾逊 (Peng-Robinson) 状态方程实现一个牛顿-拉弗森 (Newton-Raphson) 求解器，这是处理高压流体的计算地球化学家所需掌握的一项核心技能 。",
            "id": "4089472",
            "problem": "您正在使用立方状态方程模拟纯组分超临界二氧化碳流体与岩石的相互作用，并且必须根据给定的压力和温度计算摩尔体积。从基本的热力学建模原理出发，使用立方状态方程来关联压力、温度和摩尔体积，并构建一个基于牛顿-拉夫逊（Newton–Raphson）方法的求根算法来求解摩尔体积。推导残差函数及其关于摩尔体积的导数所需的所有数学表达式，并在一个完整的、可运行的程序中实现它们。\n\n基本定义和定律：\n- 立方状态方程为真实流体提供了压力、温度和摩尔体积之间的函数关系，它源于统计力学并根据实验数据进行校准。请使用带有经过充分检验的常数的 Peng–Robinson 状态方程。\n- 对于纯流体，Peng–Robinson 状态方程表示为\n$$\nP = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2},\n$$\n其中 $P$ 是压力，$T$ 是温度，$v$ 是摩尔体积，$R$ 是普适气体常数，$a$ 和 $b$ 是物质参数，而 $\\alpha(T)$ 是一个依赖于温度的校正因子，用以确保与蒸气压曲线一致。\n- 物质参数为\n$$\na = 0.45724 \\frac{R^2 T_c^2}{P_c}, \\quad b = 0.07780 \\frac{R T_c}{P_c},\n$$\n其中 $T_c$ 和 $P_c$ 分别是流体的临界温度和临界压力。温度校正为\n$$\n\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2, \\quad \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right)\\right]^2,\n$$\n其中 $\\omega$ 是偏心因子。\n\n您的任务是：\n1. 定义残差函数\n$$\nf(v) = P_{\\mathrm{PR}}(v; T, a, b, \\alpha) - P_{\\mathrm{target}},\n$$\n并为其导数 $f'(v) = \\frac{d f}{d v}$ 推导一个显式解析表达式。\n2. 概述并实现一个 Newton–Raphson 过程\n$$\nv_{k+1} = v_k - \\frac{f(v_k)}{f'(v_k)},\n$$\n该过程需要包含防止非物理迭代值（例如，$v \\le b$）的保障措施，以及基于残差和步长的合理收敛准则。使用基于理想气体定律并经过调整以确保严格大于 $b$ 的、有物理动机的初始猜测值。\n3. 实现该过程，为二氧化碳在以下 $(T, P)$ 条件测试套件中计算摩尔体积 $v$ (单位为 $\\mathrm{m^3/mol}$)。使用 $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$, $T_c = 304.1282 \\ \\mathrm{K}$, $P_c = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$ 和 $\\omega = 0.22394$。\n   - 案例 A（理想路径，超临界）：$T = 323 \\ \\mathrm{K}$，$P = 1.0 \\times 10^7 \\ \\mathrm{Pa}$。\n   - 案例 B（边界，近临界）：$T = 304.1282 \\ \\mathrm{K}$，$P = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$。\n   - 案例 C（边缘，高压）：$T = 400 \\ \\mathrm{K}$，$P = 3.0 \\times 10^7 \\ \\mathrm{Pa}$。\n   - 案例 D（类气体，压力适中，高于理想气体状态）：$T = 350 \\ \\mathrm{K}$，$P = 1.0 \\times 10^6 \\ \\mathrm{Pa}$。\n   - 案例 E（边缘，极高压和高温）：$T = 650 \\ \\mathrm{K}$，$P = 1.0 \\times 10^8 \\ \\mathrm{Pa}$。\n4. 以 $\\mathrm{m^3/mol}$ 为单位表示每个案例的最终摩尔体积。您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，“[resultA,resultB,resultC,resultD,resultE]”）。每个结果必须是表示摩尔体积（单位为 $\\mathrm{m^3/mol}$）的浮点数。\n\n科学真实性要求：\n- 保证所有量都使用一致的国际单位制（SI单位）处理：压力单位为 $\\mathrm{Pa}$，温度单位为 $\\mathrm{K}$，摩尔体积单位为 $\\mathrm{m^3/mol}$，气体常数单位为 $\\mathrm{J/(mol \\cdot K)}$。\n- 确保 Newton–Raphson 迭代值不会越过 $v = b$ 处的物理奇点，也不会产生负体积。\n- 应选择合理的收敛容差，以便在给定案例中，假设存在超临界条件下典型的平滑单根行为，摩尔体积至少能达到十位有效数字的精度。\n\n算法约束：\n- 不要使用预封装的求根器。使用您自己推导的导数表达式来实现 Newton–Raphson 方法。\n- 实现必须是自包含的，并且不需要任何输入。",
            "solution": "从给定的压力和温度确定超临界流体的摩尔体积，是计算地球化学和化学工程中的一项基本任务。这是一个基于既定热力学原理的适定问题。使用 Peng–Robinson 立方状态方程和 Newton–Raphson 数值方法求解是标准且稳健的方法。该问题为获得唯一且有意义的解提供了所有必要的数据和定义。它在科学上是合理的、客观的和完整的。因此，该问题被认为是有效的。\n\n问题的核心是找到满足给定目标压力 $P_{\\mathrm{target}}$ 和温度 $T$ 下的 Peng–Robinson 状态方程的摩尔体积 $v$。该方程为：\n$$\nP_{\\mathrm{PR}}(v; T) = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2}\n$$\n我们必须对 $v$ 求解方程 $P_{\\mathrm{PR}}(v; T) = P_{\\mathrm{target}}$。这是一个关于残差函数 $f(v)$ 的求根问题：\n$$\nf(v) = P_{\\mathrm{PR}}(v; T) - P_{\\mathrm{target}} = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2} - P_{\\mathrm{target}} = 0\n$$\n\nNewton–Raphson 方法是用于寻找可微函数根的迭代过程。迭代定义如下：\n$$\nv_{k+1} = v_k - \\frac{f(v_k)}{f'(v_k)}\n$$\n其中 $v_k$ 是在第 $k$ 次迭代时对根的估计值，$f'(v_k)$ 是残差函数关于体积的导数在 $v_k$ 处的值。关键的第一步是推导该导数的解析表达式。\n\n残差函数为：\n$$\nf(v) = R T (v - b)^{-1} - a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} - P_{\\mathrm{target}}\n$$\n我们对 $v$ 求 $f(v)$ 的导数，并将 $T$、$R$、$a$、$b$、$\\alpha(T)$ 和 $P_{\\mathrm{target}}$ 视为常数。使用幂法则和链式法则进行微分：\n$$\nf'(v) = \\frac{d f}{d v} = \\frac{d}{d v} \\left( R T (v - b)^{-1} \\right) - \\frac{d}{d v} \\left( a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} \\right) - \\frac{d}{d v} \\left( P_{\\mathrm{target}} \\right)\n$$\n第一项的导数是：\n$$\n\\frac{d}{d v} \\left( R T (v - b)^{-1} \\right) = R T \\cdot (-1) \\cdot (v - b)^{-2} \\cdot \\frac{d}{d v}(v-b) = - \\frac{R T}{(v - b)^2}\n$$\n第二项的导数是：\n$$\n- \\frac{d}{d v} \\left( a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} \\right) = - a \\alpha(T) \\cdot (-1) \\cdot (v^2 + 2 b v - b^2)^{-2} \\cdot \\frac{d}{d v}(v^2 + 2 b v - b^2)\n$$\n分母中多项式的导数是 $\\frac{d}{d v}(v^2 + 2 b v - b^2) = 2v + 2b = 2(v+b)$。将其代回得到：\n$$\n+ \\frac{a \\alpha(T) \\cdot 2(v+b)}{(v^2 + 2 b v - b^2)^2}\n$$\n常数 $P_{\\mathrm{target}}$ 的导数为 $0$。合并各项，导数 $f'(v)$ 的完整解析表达式为：\n$$\nf'(v) = - \\frac{R T}{(v - b)^2} + \\frac{2 a \\alpha(T) (v + b)}{(v^2 + 2 b v - b^2)^2}\n$$\n\n算法流程如下：\n1.  **计算 CO₂ 的物质参数**：使用提供的临界温度 $T_c = 304.1282 \\ \\mathrm{K}$、临界压力 $P_c = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$、偏心因子 $\\omega = 0.22394$ 以及普适气体常数 $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$，我们计算物质特定的 Peng–Robinson 参数 $a$ 和 $b$，以及用于温度校正因子 $\\alpha(T)$ 的参数 $\\kappa$。\n    $$\n    a = 0.45724 \\frac{R^2 T_c^2}{P_c}\n    $$\n    $$\n    b = 0.07780 \\frac{R T_c}{P_c}\n    $$\n    $$\n    \\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2\n    $$\n2.  **对于每个 $(T, P)$ 案例**：\n    a.  计算与温度相关的项 $\\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{T/T_c}\\right)\\right]^2$。\n    b.  **初始猜测**：一个物理上合理的初始猜测值 $v_0$ 是由理想气体定律预测的摩尔体积，$v_0 = RT/P_{\\mathrm{target}}$。这个猜测值在低压下非常出色，在较高压力下也仍然合理。\n    c.  **Newton–Raphson 迭代**：\n        i.  用 $v_k = v_0$ 初始化迭代。\n        ii. 循环直至收敛：\n            1.  使用推导出的表达式计算残差 $f(v_k)$ 及其导数 $f'(v_k)$。\n            2.  计算更新步长 $\\Delta v = -f(v_k) / f'(v_k)$。\n            3.  计算新的估计值 $v_{k+1} = v_k + \\Delta v$。\n            4.  **保障措施**：摩尔体积 $v$ 必须大于排除体积参数 $b$。如果某次迭代产生 $v_{k+1} \\le b$，则说明步长过大。在这种情况下，通过一个阻尼因子（例如，反复将 $\\Delta v$ 减半）来减小步长，直到新的估计值 $v_{k+1} = v_k + \\Delta v$ 变为物理上有效的值（即 $v_{k+1} > b$）。\n            5.  **收敛性检查**：当体积的相对变化小于指定的容差 $\\epsilon$ 时，认为迭代收敛。我们要求收敛到至少 10 位有效数字，因此容差设为 $|\\Delta v / v_{k+1}|  10^{-12}$ 是合适的。\n            6.  更新 $v_k \\leftarrow v_{k+1}$ 并继续循环。\n        iii. 设置最大迭代次数（例如 50 次）以防止在不收敛的情况下出现无限循环。\n3.  **输出**：收集每个 $(T, P)$ 案例收敛后的摩尔体积 $v$，并按指定格式进行格式化。所有计算均使用国际单位制（SI units）进行。\n\n该过程系统地将物理模型（Peng–Robinson EOS）与稳健的数值方法（阻尼 Newton–Raphson）相结合，以在各种条件下求解摩尔体积，同时遵守问题的所有科学和算法约束。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molar volume of CO2 at given T, P conditions\n    using the Peng-Robinson equation of state and the Newton-Raphson method.\n    \"\"\"\n\n    # Define physical constants and fluid properties for Carbon Dioxide (CO2)\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n    TC = 304.1282      # Critical temperature in K\n    PC = 7.3773e6      # Critical pressure in Pa\n    OMEGA = 0.22394    # Acentric factor (dimensionless)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (323.0, 1.0e7),      # Case A: Supercritical\n        (304.1282, 7.3773e6),# Case B: Near-critical\n        (400.0, 3.0e7),      # Case C: High pressure\n        (350.0, 1.0e6),      # Case D: Gas-like\n        (650.0, 1.0e8),      # Case E: Very high P, T\n    ]\n\n    def solve_molar_volume(T, P_target, R_const, Tc_const, Pc_const, omega_const):\n        \"\"\"\n        Solves for molar volume v for a single (T, P) pair.\n        \n        Args:\n            T (float): Temperature in K.\n            P_target (float): Target pressure in Pa.\n            R_const (float): Universal gas constant.\n            Tc_const (float): Critical temperature.\n            Pc_const (float): Critical pressure.\n            omega_const (float): Acentric factor.\n\n        Returns:\n            float: Molar volume in m^3/mol, or np.nan if not converged.\n        \"\"\"\n        # 1. Calculate Peng-Robinson EOS parameters\n        a = 0.45724 * (R_const**2 * Tc_const**2) / Pc_const\n        b = 0.07780 * (R_const * Tc_const) / Pc_const\n        kappa = 0.37464 + 1.54226 * omega_const - 0.26992 * omega_const**2\n        alpha = (1 + kappa * (1 - np.sqrt(T / Tc_const)))**2\n        \n        a_alpha = a * alpha\n\n        # 2. Define residual function f(v) and its derivative f'(v)\n        def f(v):\n            \"\"\"Residual function f(v) = P_PR(v) - P_target.\"\"\"\n            # Denominator of the attractive term\n            den_attractive = v**2 + 2 * b * v - b**2\n            if den_attractive == 0: return np.inf\n            \n            P_pr = (R_const * T / (v - b)) - (a_alpha / den_attractive)\n            return P_pr - P_target\n\n        def f_prime(v):\n            \"\"\"Derivative of the residual function, df/dv.\"\"\"\n            v_minus_b_sq = (v - b)**2\n            if v_minus_b_sq == 0: return -np.inf\n\n            term1_prime = -R_const * T / v_minus_b_sq\n            \n            den_attractive = v**2 + 2 * b * v - b**2\n            if den_attractive == 0: return -np.inf\n            \n            num_attractive_prime = 2 * a_alpha * (v + b)\n            den_attractive_sq = den_attractive**2\n            if den_attractive_sq == 0: return -np.inf\n            \n            term2_prime = num_attractive_prime / den_attractive_sq\n            return term1_prime + term2_prime\n\n        # 3. Newton-Raphson iteration\n        # Initial guess from the ideal gas law\n        v_k = R_const * T / P_target\n\n        # Iteration parameters\n        max_iter = 50\n        tolerance = 1e-12\n\n        for _ in range(max_iter):\n            f_val = f(v_k)\n            fp_val = f_prime(v_k)\n\n            # Avoid division by zero if derivative is flat\n            if abs(fp_val)  1e-20:\n                break\n\n            delta_v = -f_val / fp_val\n            v_k_plus_1 = v_k + delta_v\n            \n            # Safeguard: ensure volume is physical (v > b).\n            # Apply damping (step halving) if the step overshoots.\n            damping_iter = 0\n            while v_k_plus_1 = b:\n                delta_v /= 2.0\n                v_k_plus_1 = v_k + delta_v\n                damping_iter += 1\n                if damping_iter > 50: # Failsafe\n                    return np.nan \n\n            # Check for convergence based on relative step size\n            if abs(v_k_plus_1 - v_k) / abs(v_k_plus_1)  tolerance:\n                return v_k_plus_1\n\n            v_k = v_k_plus_1\n        \n        return np.nan # Return NaN if convergence is not reached\n\n    results = []\n    for T, P in test_cases:\n        molar_volume = solve_molar_volume(T, P, R, TC, PC, OMEGA)\n        results.append(molar_volume)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "流体-岩石相互作用的核心在于化学反应速率与流体输运速率之间的竞争。本练习将向你介绍一个强大的无量纲数——丹柯勒数 (Damköhler number, $Da$)，它量化了这种竞争关系，帮助我们判断一个过程是由反应控制还是由输运控制 。你将通过对一个矿物溶解场景进行量纲分析，推导并计算丹柯勒数，这是解释和设计实验室实验及现场尺度模拟的关键一步。",
            "id": "4089480",
            "problem": "在高温高压条件下，硅酸盐盖层中的一条均一孔隙裂缝被与超临界二氧化碳 (scCO$_2$) 平衡的含水流体冲刷。在裂缝内部，一种反应性矿物的溶解在局部可以很好地由一个关于反应驱动力的准一级反应速率定律来描述，其有效速率常数 $k$ 在所关注的时间窗口内，在空间和时间上是均匀的。流体以恒定的间隙流速 $U$ 沿着长度为 $L$ 的裂缝流动，且与平流相比，分子扩散和弥散可以忽略不计。密度和孔隙度可视为常数。代表性反应标量 $C(x,t)$ 的浓度场沿流动方向遵循一维平流-反应动力学。\n\n从溶解的反应标量的质量守恒和给定的动力学假设出发，建立稳态的一维平流-反应平衡方程，使用特征长度 $L$ 和特征速度 $U$ 对该方程进行无量纲化，并识别出那个用于比较化学反应特征时间与流体穿过裂缝长度的平流特征时间的单一无量纲数群。\n\n针对以下代表高温条件下含 scCO$_2$ 盐水的条件，计算该无量纲数群的值：温度 $T = 333$ K，压力 $P = 12$ MPa（这些热力学条件仅为提供背景信息；它们不直接参与计算），$k = 2.5 \\times 10^{-4}$ s$^{-1}$，$U = 3.0 \\times 10^{-4}$ m s$^{-1}$，以及 $L = 0.75$ m。\n\n根据该无量纲数群的量级，判断在这些条件下溶解过程主要是由反应控制还是由输运控制，并从无量纲化的平衡方程出发论证你的评估。\n\n报告该无量纲数群的最终数值，保留三位有效数字。报告的数值不需要单位。",
            "solution": "该问题要求推导和分析一个用于描述裂缝中矿物溶解的一维稳态平流-反应模型。最终目标是计算一个表征该系统的无量纲数，并用它来确定速率控制机制。\n\n第一步是根据溶解的反应标量（其浓度表示为 $C(x,t)$）的质量守恒原理建立控制方程。一维守恒方程为：\n$$ \\frac{\\partial C}{\\partial t} + \\frac{\\partial J}{\\partial x} = R $$\n其中 $t$ 是时间，$x$ 是沿裂缝的空间坐标，$J$ 是标量的通量，$R$ 是每单位流体体积的净生成速率（源/汇项）。\n\n问题陈述中提到，与平流相比，分子扩散和弥散可以忽略不计。因此，通量 $J$ 纯粹是平流性的：\n$$ J = U C $$\n其中 $U$ 是恒定的间隙流体速度。\n\n该反应是反应性矿物的溶解，此过程将标量添加到流体中。其速率由一个关于反应驱动力的准一级定律描述。溶解的驱动力是平衡浓度 $C_{eq}$ 与局部浓度 $C$ 之间的差值。因此，源项 $R$ 与该驱动力成正比：\n$$ R = k(C_{eq} - C) $$\n此处，$k$ 是有效速率常数，单位为时间的倒数 (s$^{-1}$)。这个公式与溶解过程是一致的：如果流体未饱和 ($C  C_{eq}$)，则 $R > 0$，浓度趋于增加。\n\n将 $J$ 和 $R$ 的表达式代入守恒方程，并注意到 $U$ 是常数，我们得到一维平流-反应方程：\n$$ \\frac{\\partial C}{\\partial t} + U \\frac{\\partial C}{\\partial x} = k(C_{eq} - C) $$\n问题要求的是稳态平衡，当浓度场不再随时间变化时（即 $\\frac{\\partial C}{\\partial t} = 0$）达到稳态。控制方程简化为一个常微分方程 (ODE)：\n$$ U \\frac{dC}{dx} = k(C_{eq} - C) $$\n接下来，我们对此方程进行无量纲化。问题指定了特征长度 $L$（裂缝长度）和特征速度 $U$。我们定义一个无量纲位置变量 $x'$：\n$$ x' = \\frac{x}{L} $$\n为了定义无量纲浓度，我们将浓度变化相对于总的可能变化进行归一化。设裂缝入口 ($x=0$) 处的浓度为 $C_{in}$。浓度 $C$ 将在 $C_{in}$ 和 $C_{eq}$ 之间变化。我们定义一个无量纲浓度 $\\theta$：\n$$ \\theta = \\frac{C - C_{in}}{C_{eq} - C_{in}} $$\n根据这些定义，我们求得代换所需的导数和项：\n$$ C = C_{in} + \\theta (C_{eq} - C_{in}) \\implies \\frac{dC}{dx} = (C_{eq} - C_{in}) \\frac{d\\theta}{dx} $$\n使用链式法则，$\\frac{d\\theta}{dx} = \\frac{d\\theta}{dx'} \\frac{dx'}{dx} = \\frac{1}{L} \\frac{d\\theta}{dx'}$。因此：\n$$ \\frac{dC}{dx} = \\frac{C_{eq} - C_{in}}{L} \\frac{d\\theta}{dx'} $$\n反应项也可以用 $\\theta$ 表示：\n$$ k(C_{eq} - C) = k(C_{eq} - (C_{in} + \\theta (C_{eq} - C_{in}))) = k(1 - \\theta)(C_{eq} - C_{in}) $$\n将这些表达式代入稳态常微分方程：\n$$ U \\left( \\frac{C_{eq} - C_{in}}{L} \\frac{d\\theta}{dx'} \\right) = k(1 - \\theta)(C_{eq} - C_{in}) $$\n假设驱动力不为零 ($C_{eq} \\neq C_{in}$)，我们可以将方程两边同除以 $(C_{eq} - C_{in})$：\n$$ \\frac{U}{L} \\frac{d\\theta}{dx'} = k(1 - \\theta) $$\n重新整理该方程以组合参数，得到最终的无量纲形式：\n$$ \\frac{d\\theta}{dx'} = \\left( \\frac{kL}{U} \\right) (1 - \\theta) $$\n出现的单一无量纲数群是 $\\frac{kL}{U}$。这个数群是丹科勒数（Damköhler number），通常表示为 $Da$。它比较了平流的特征时间（$ \\tau_{adv} = L/U $）与反应的特征时间（$ \\tau_{react} = 1/k $）：\n$$ Da = \\frac{kL}{U} = \\frac{L/U}{1/k} = \\frac{\\tau_{adv}}{\\tau_{react}} $$\n这正是那个“比较化学反应特征时间与流体穿过裂缝长度的平流特征时间”的数群。\n\n现在，我们使用所提供的值来计算这个无量纲数群：\n- $k = 2.5 \\times 10^{-4}$ s$^{-1}$\n- $U = 3.0 \\times 10^{-4}$ m s$^{-1}$\n- $L = 0.75$ m\n\n$$ Da = \\frac{(2.5 \\times 10^{-4} \\text{ s}^{-1}) (0.75 \\text{ m})}{3.0 \\times 10^{-4} \\text{ m s}^{-1}} = \\frac{2.5 \\times 0.75}{3.0} = \\frac{1.875}{3.0} = 0.625 $$\n该无量纲数群的值为 $0.625$。\n\n最后，我们根据丹科勒数的量级来评估控制机制。\n- 如果 $Da \\gg 1$，则 $\\tau_{adv} \\gg \\tau_{react}$。反应比输运快得多。系统会迅速达到化学平衡（$C \\to C_{eq}$，或 $\\theta \\to 1$）。总的溶解速率将受限于平流将未饱和流体输送到裂缝中的速率。这是**输运控制**机制。\n- 如果 $Da \\ll 1$，则 $\\tau_{adv} \\ll \\tau_{react}$。输运比反应快得多。流体在裂缝中停留的时间太短，反应无法显著地向平衡状态进行。总的溶解速率受限于缓慢的化学动力学。这是**反应控制**机制。\n\n我们计算出的值为 $Da = 0.625$。由于 $Da  1$，平流的特征时间 ($L/U$) 短于反应的特征时间 ($1/k$)。这表明化学动力学是较慢的、限制速率的过程。因此，溶解过程主要是**反应控制**的。\n\n这一结论可以由无量纲平衡方程 $\\frac{d\\theta}{dx'} = Da(1-\\theta)$ 来证明。当 $Da = 0.625$ 时，无量纲浓度梯度 $\\frac{d\\theta}{dx'}$ 的量级小于1（在入口附近，此处 $1-\\theta \\approx 1$）。这意味着浓度沿裂缝逐渐增加，而不是呈现输运限制系统所特有的陡峭前沿。在裂缝长度 $L$ 范围内的反应程度受速率常数 $k$ 的限制，而非流体速度 $U$。\n\n最终要求的值是无量纲数群，保留三位有效数字。计算值 $0.625$ 已经具有三位有效数字。",
            "answer": "$$\\boxed{0.625}$$"
        },
        {
            "introduction": "为了深入理解流体-岩石相互作用的机理，我们必须对矿物-水界面上发生的微观过程进行建模。表面络合模型是实现这一目标的先进方法，它将水溶液化学、表面反应以及电双层的形成耦合在一起 。这项具有挑战性的练习要求你构建并求解一个完整的双层表面络合模型，从而深入洞察在超临界流体环境下，矿物表面电荷和电位是如何响应化学条件变化的。",
            "id": "4089409",
            "problem": "考虑一个带有两性官能团的均匀矿物表面，该表面与接触超临界二氧化碳的水溶液发生相互作用。使用双层表面络合框架对该系统进行建模，该框架包括一个致密内层（$0$-平面）和一个扩散层（$d$-平面）。水溶液是在高温高压下的二氧化碳-水混合物，使得二氧化碳处于超临界状态。假设存在单一类型的两性位点，表示为$\\mathrm{S{-}OH}$，它可以质子化形成$\\mathrm{S{-}OH_2^+}$和去质子化形成$\\mathrm{S{-}O^-}$。在静电双电层之外没有特定离子吸附，并且活度系数取为1。致密层由$0$-平面和$d$-平面之间的一个电容表示。\n\n仅从适用于计算地球化学和电化学的基本原理出发：\n- 化学平衡和活度的质量作用定律，\n- 用于水中溶解二氧化碳的亨利定律（含逸度），\n- 碳酸的酸解离平衡和水的自质子离解，\n- 本体水溶液的电中性，\n- 致密层的电容关系，\n- 使用离子强度描述对称电解质扩散层的泊松-玻尔兹曼方程，\n\n建立计算以下未知量所需的数学体系：\n- 本体水溶液氢离子浓度 $[ \\mathrm{H^+} ]$ 和本体pH值，\n- 对应于$\\mathrm{S{-}OH_2^+}$、$\\mathrm{S{-}OH}$和$\\mathrm{S{-}O^-}$的表面位点分数$\\theta_{+}$、$\\theta_{0}$和$\\theta_{-}$，\n- $0$-平面的静电势$\\psi_0$和$d$-平面的静电势$\\psi_d$。\n\n定义表面位点平衡、使用平面活度的$0$-平面质量作用关系、致密层电荷-电势关系以及扩散层电荷-电势关系。该解必须强制$0$-平面和扩散层之间的电荷中性。\n\n使用以下物理上一致的参数化和常数：\n- 温度$T$，单位为开尔文，\n- 总压很大，二氧化碳逸度为$f_{\\mathrm{CO_2}} = \\varphi \\, p_{\\mathrm{CO_2}}$，其中$\\varphi$是逸度系数（无量纲），$p_{\\mathrm{CO_2}}$是二氧化碳分压，单位为巴（bar），\n- 用于本体溶解二氧化碳浓度的亨利定律：$[\\mathrm{CO_2^*}] = k_H \\, f_{\\mathrm{CO_2}}$，其中$k_H$是亨利常数，单位为$\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$，$\\mathrm{CO_2^*}$包括$\\mathrm{CO_2(aq)}$和$\\mathrm{H_2CO_3}$，\n- 碳酸解离常数$K_{a1}$和$K_{a2}$，以及水的自质子离解常数$K_w$，均以摩尔浓度标准态表示，\n- 针对$\\mathrm{S{-}OH} + \\mathrm{H^+} \\rightleftharpoons \\mathrm{S{-}OH_2^+}$的内在表面平衡常数（无量纲）$K_1$和针对$\\mathrm{S{-}OH} \\rightleftharpoons \\mathrm{S{-}O^-} + \\mathrm{H^+}$的内在表面平衡常数$K_2$，\n- 单位面积总位点密度$\\Gamma_T$，单位为$\\mathrm{mol\\,m^{-2}}$，\n- 内层电容$C_1$，单位为$\\mathrm{F\\,m^{-2}}$，\n- 水的相对介电常数$\\varepsilon_r$（无量纲）。绝对介电常数为$\\varepsilon = \\varepsilon_r \\varepsilon_0$，其中$\\varepsilon_0$是真空介电常数。\n\n计算中使用的常数：\n- 普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n- 法拉第常数 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$，\n- 真空介电常数 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$。\n\n本体碳酸盐体系应根据以下公式计算：\n- 亨利定律用于计算$[\\mathrm{CO_2^*}]$，\n- 酸解离关系$[\\mathrm{HCO_3^-}] = K_{a1} [\\mathrm{CO_2^*}] / [\\mathrm{H^+}]$和$[\\mathrm{CO_3^{2-}}] = K_{a2} [\\mathrm{HCO_3^-}] / [\\mathrm{H^+}]$，\n- 水的自质子离解$[\\mathrm{OH^-}] = K_w / [\\mathrm{H^+}]$，\n- 本体电中性$[\\mathrm{H^+}] = [\\mathrm{HCO_3^-}] + 2 [\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]$。\n\n本体离子强度$I$应计算为$I = \\tfrac{1}{2} \\sum_i z_i^2 c_i$，单位为$\\mathrm{mol\\,L^{-1}}$，其中总和涵盖$\\mathrm{H^+}$、$\\mathrm{OH^-}$、$\\mathrm{HCO_3^-}$和$\\mathrm{CO_3^{2-}}$。对于以$I$表示的扩散层电荷-电势关系，使用对称电解质近似。\n\n您的程序必须实现一个稳健的数值算法，以解决下面指定的每个测试用例的耦合系统。通过使用所述常数和关系，确保科学真实性，不要引入捷径或预先指定的目标公式。所有电势以伏特表示，所有浓度以$\\mathrm{mol\\,L^{-1}}$表示。将pH计算为$\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$。最终的数值输出必须是四舍五入到六位小数的浮点数。\n\n测试套件：\n- 案例A（一般超临界相互作用）：$T = 323\\,\\mathrm{K}$， $p_{\\mathrm{CO_2}} = 100\\,\\mathrm{bar}$， $\\varphi = 0.7$， $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$， $K_{a1} = 1.0 \\times 10^{-6}$， $K_{a2} = 1.0 \\times 10^{-10}$， $K_w = 5.0 \\times 10^{-14}$， $K_1 = 1.0 \\times 10^{-4}$， $K_2 = 1.0 \\times 10^{-8}$， $\\Gamma_T = 5.0 \\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}}$， $C_1 = 1.1\\,\\mathrm{F\\,m^{-2}}$， $\\varepsilon_r = 70.0$。\n- 案例B（较低的二氧化碳负载）：$T = 323\\,\\mathrm{K}$， $p_{\\mathrm{CO_2}} = 5\\,\\mathrm{bar}$， $\\varphi = 0.9$， $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$， $K_{a1} = 1.0 \\times 10^{-6}$， $K_{a2} = 1.0 \\times 10^{-10}$， $K_w = 5.0 \\times 10^{-14}$， $K_1 = 1.0 \\times 10^{-4}$， $K_2 = 1.0 \\times 10^{-8}$， $\\Gamma_T = 5.0 \\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}}$， $C_1 = 1.1\\,\\mathrm{F\\,m^{-2}}$， $\\varepsilon_r = 70.0$。\n- 案例C（边界：极低的位点密度，高电容）：$T = 323\\,\\mathrm{K}$， $p_{\\mathrm{CO_2}} = 100\\,\\mathrm{bar}$， $\\varphi = 0.7$， $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$， $K_{a1} = 1.0 \\times 10^{-6}$， $K_{a2} = 1.0 \\times 10^{-10}$， $K_w = 5.0 \\times 10^{-14}$， $K_1 = 1.0 \\times 10^{-4}$， $K_2 = 1.0 \\times 10^{-8}$， $\\Gamma_T = 1.0 \\times 10^{-7}\\,\\mathrm{mol\\,m^{-2}}$， $C_1 = 5.0\\,\\mathrm{F\\,m^{-2}}$， $\\varepsilon_r = 70.0$。\n\n您的程序所需的最终输出：\n- 对于每个案例，生成列表$[ \\mathrm{pH}, \\theta_{+}, \\theta_{-}, \\psi_0, \\psi_d ]$，其中$\\mathrm{pH}$无单位，$\\theta_{+}$和$\\theta_{-}$是无单位分数，$\\psi_0$和$\\psi_d$以伏特为单位。每个浮点数必须四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例一个条目。例如，三个案例的有效输出形式为[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],[z_1,z_2,z_3,z_4,z_5]]，输出中任何地方都不能有空格。",
            "solution": "该问题要求建立并数值求解一个耦合方程组，该方程组描述了超临界二氧化碳条件下矿物-水界面的地球化学相互作用。该模型包含本体水溶液平衡、两性位点上的表面络合以及静电双电层。解决方案的制定首先从基本原理出发建立控制方程，然后设计数值算法来求解这些方程。\n\n### 第1部分：本体水溶液化学\n\n本体水溶液与超临界$\\mathrm{CO_2}$相处于平衡状态。该溶液的组成为表面模型提供了远场边界条件。\n\n1.  **溶解的二氧化碳**：根据亨利定律，溶解的 aqueous $\\mathrm{CO_2}$ （表示为$\\mathrm{CO_2^*}$，包括$\\mathrm{CO_2(aq)}$和$\\mathrm{H_2CO_3}$）的浓度由$\\mathrm{CO_2}$的逸度$f_{\\mathrm{CO_2}}$决定。逸度由$f_{\\mathrm{CO_2}} = \\varphi \\, p_{\\mathrm{CO_2}}$给出。\n    $$[\\mathrm{CO_2^*}] = k_H \\, f_{\\mathrm{CO_2}} = k_H \\, \\varphi \\, p_{\\mathrm{CO_2}}$$\n    对于给定的温度$T$和分压$p_{\\mathrm{CO_2}}$，此浓度是恒定的。\n\n2.  **水溶液平衡**：溶解的$\\mathrm{CO_2^*}$建立了一系列碳酸盐体系特有的平衡。令$h_{bulk} = [\\mathrm{H^+}]$为本体氢离子浓度。碳酸氢根、碳酸根和氢氧根离子的浓度由它们各自解离反应的质量作用定律给出（假设活度系数为1）：\n    $$[\\mathrm{HCO_3^-}] = \\frac{K_{a1} [\\mathrm{CO_2^*}]}{h_{bulk}}$$\n    $$[\\mathrm{CO_3^{2-}}] = \\frac{K_{a2} [\\mathrm{HCO_3^-}]}{h_{bulk}} = \\frac{K_{a1} K_{a2} [\\mathrm{CO_2^*}]}{h_{bulk}^2}$$\n    $$[\\mathrm{OH^-}] = \\frac{K_w}{h_{bulk}}$$\n\n3.  **本体电中性**：本体溶液必须是电中性的。正电荷的总和必须等于负电荷的总和。\n    $$[\\mathrm{H^+}] = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]$$\n    将平衡表达式代入电荷平衡方程，得到一个关于未知数$h_{bulk}$的单一方程：\n    $$h_{bulk} = \\frac{K_{a1} [\\mathrm{CO_2^*}]}{h_{bulk}} + 2 \\frac{K_{a1} K_{a2} [\\mathrm{CO_2^*}]}{h_{bulk}^2} + \\frac{K_w}{h_{bulk}}$$\n    两边乘以$h_{bulk}^2$并重新整理，得到一个关于$h_{bulk}$的三次多项式：\n    $$h_{bulk}^3 - (K_{a1} [\\mathrm{CO_2^*}] + K_w) h_{bulk} - 2 K_{a1} K_{a2} [\\mathrm{CO_2^*}] = 0$$\n    该方程可以通过数值方法求解，以找到$h_{bulk}$的唯一正实根。\n\n4.  **离子强度**：一旦$h_{bulk}$已知，所有其他本体物种的浓度都可以计算出来。然后，静电模型所需的本体溶液离子强度$I$计算如下：\n    $$I = \\frac{1}{2} \\sum_i c_i z_i^2 = \\frac{1}{2} ([\\mathrm{H^+}] (1)^2 + [\\mathrm{OH^-}] (-1)^2 + [\\mathrm{HCO_3^-}] (-1)^2 + [\\mathrm{CO_3^{2-}}] (-2)^2)$$\n    $$I = \\frac{1}{2} (h_{bulk} + [\\mathrm{OH^-}] + [\\mathrm{HCO_3^-}] + 4[\\mathrm{CO_3^{2-}}])$$\n    注意，离子强度$I$的单位是$\\mathrm{mol\\,L^{-1}}$。为了与其他国际单位制常数一起使用，必须通过乘以$1000\\,\\mathrm{L\\,m^{-3}}$将其转换为$\\mathrm{mol\\,m^{-3}}$。\n\n### 第2部分：表面络合与静电模型\n\n矿物表面含有与氢离子反应的两性位点$\\mathrm{S{-}OH}$。此过程与表面静电势的形成相耦合。\n\n1.  **表面反应**：表面位点根据以下平衡进行质子化和去质子化，其内在常数为$K_1$和$K_2$：\n    $$\\mathrm{S{-}OH} + \\mathrm{H^+} \\xrightleftharpoons{K_1} \\mathrm{S{-}OH_2^+}$$\n    $$\\mathrm{S{-}OH} \\xrightleftharpoons{K_2} \\mathrm{S{-}O^-} + \\mathrm{H^+}$$\n    问题指定这些常数是无量纲的。这意味着在质量作用表达式中，$\\mathrm{H^+}$的活度是相对于$1\\,\\mathrm{mol\\,L^{-1}}$的标准态而言的。\n\n2.  **表面质量作用与静电学**：表面离子的活度通过玻尔兹曼分布与其本体活度相关联。对于在$0$-平面（电势为$\\psi_0$）的$\\mathrm{H^+}$：\n    $$\\{\\mathrm{H^+}\\}_0 = [\\mathrm{H^+}]_{bulk} \\exp\\left(\\frac{-e \\psi_0}{k_B T}\\right) = h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)$$\n    其中$F$是法拉第常数，$R$是普适气体常数，$T$是绝对温度。表面反应的质量作用定律，其中表面物种活度由其位点分数（$\\theta_{+}$、$\\theta_{0}$、$\\theta_{-}$）给出，变为：\n    $$K_1 = \\frac{\\theta_{+}}{\\theta_{0} \\{\\mathrm{H^+}\\}_0} \\implies \\theta_{+} = K_1 \\theta_{0} h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)$$\n    $$K_2 = \\frac{\\theta_{-} \\{\\mathrm{H^+}\\}_0}{\\theta_{0}} \\implies \\theta_{-} = K_2 \\frac{\\theta_{0}}{h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)}$$\n\n3.  **位点平衡与位点分数**：位点分数的总和必须为1：\n    $$\\theta_{+} + \\theta_{0} + \\theta_{-} = 1$$\n    代入$\\theta_{+}$和$\\theta_{-}$的表达式，我们可以将分数求解为$\\psi_0$的函数：\n    $$\\theta_{0} \\left( K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}} + 1 + \\frac{K_2}{h_{bulk} e^{\\frac{-F \\psi_0}{R T}}} \\right) = 1$$\n    令分母为$D = 1 + K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}} + K_2 / (h_{bulk} e^{\\frac{-F \\psi_0}{R T}})$。\n    那么位点分数为：\n    $$\\theta_{0}(\\psi_0) = \\frac{1}{D} \\quad, \\quad \\theta_{+}(\\psi_0) = \\frac{K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}}}{D} \\quad, \\quad \\theta_{-}(\\psi_0) = \\frac{K_2 / (h_{bulk} e^{\\frac{-F \\psi_0}{R T}})}{D}$$\n\n4.  **表面电荷密度($\\sigma_0$)**：$0$-平面的净电荷密度是由于带电的表面物种造成的。总位点密度为$\\Gamma_T$（$\\mathrm{mol\\,m^{-2}}$）：\n    $$\\sigma_0(\\psi_0) = F (\\Gamma_T \\theta_{+} - \\Gamma_T \\theta_{-}) = F \\Gamma_T (\\theta_{+}(\\psi_0) - \\theta_{-}(\\psi_0))$$\n\n### 第3部分：耦合方程组\n\n通过将表面电荷与静电势通过双层模型联系起来，系统得以封闭。\n\n1.  **致密层**：$0$-平面（电势$\\psi_0$）和$d$-平面（电势$\\psi_d$）之间的区域被建模为电容为$C_1$的电容器：\n    $$\\sigma_0 = C_1 (\\psi_0 - \\psi_d)$$\n\n2.  **扩散层**：扩散层中的电荷密度$\\sigma_d$平衡了电势$\\psi_d$。根据提示，我们使用对称1:1电解质的Grahame方程，但使用实际溶液计算出的离子强度$I$：\n    $$\\sigma_d = -\\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left(\\frac{F \\psi_d}{2 R T}\\right)$$\n    其中$\\varepsilon_0$是真空介电常数，$\\varepsilon_r$是水的相对介电常数，因子$1000$将$I$从$\\mathrm{mol\\,L^{-1}}$转换为$\\mathrm{mol\\,m^{-3}}$。\n\n3.  **整体电荷中性**：整个界面是中性的，所以表面电荷必须由扩散层电荷来平衡：\n    $$\\sigma_0 + \\sigma_d = 0 \\implies \\sigma_0 = -\\sigma_d$$\n\n4.  **最终残差方程**：我们有一个包含两个未知数$\\psi_0$和$\\psi_d$的两个方程的系统：\n    (i) $\\sigma_0(\\psi_0) = C_1 (\\psi_0 - \\psi_d)$\n    (ii) $\\sigma_0(\\psi_0) = \\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left(\\frac{F \\psi_d}{2 R T}\\right)$\n    我们可以从(i)中表达$\\psi_d$为$\\psi_d = \\psi_0 - \\sigma_0(\\psi_0)/C_1$，并将其代入(ii)。这产生了一个关于$\\psi_0$的单一、高度非线性的残差方程：\n    $$F_{resid}(\\psi_0) = \\sigma_0(\\psi_0) - \\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left( \\frac{F}{2 R T} \\left( \\psi_0 - \\frac{\\sigma_0(\\psi_0)}{C_1} \\right) \\right) = 0$$\n\n### 第4部分：数值求解算法\n\n对于每个测试案例，使用两步数值程序来解决问题。\n\n1.  **求解本体化学**：首先，求解关于$h_{bulk}$的三次多项式。利用给定案例的已知参数（$k_H, \\varphi, p_{\\mathrm{CO_2}}, K_{a1}, K_{a2}, K_w$），计算出$[\\mathrm{CO_2^*}]$的值。确定三次方程的系数，并找到其唯一的正实根，从而得到$h_{bulk}$。由此，计算出本体$\\mathrm{pH}$、所有其他离子的浓度以及离子强度$I$。\n\n2.  **求解表面性质**：在本体性质固定的情况下，使用求根算法（例如，Brent法）对残差方程$F_{resid}(\\psi_0) = 0$进行数值求解，以求得$\\psi_0$。\n\n3.  **计算最终输出**：一旦找到$\\psi_0$的自洽值，就可以直接计算其他所需的量：\n    - 计算表面电荷$\\sigma_0(\\psi_0)$。\n    - 从$\\psi_d = \\psi_0 - \\sigma_0/C_1$中求得电势$\\psi_d$。\n    - 使用其推导出的表达式计算位点分数$\\theta_{+}(\\psi_0)$和$\\theta_{-}(\\psi_0)$。\n    - 计算本体$\\mathrm{pH}$为$\\mathrm{pH} = -\\log_{10}(h_{bulk})$。\n\n每个案例的最终输出是向量$[\\mathrm{pH}, \\theta_{+}, \\theta_{-}, \\psi_0, \\psi_d]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the coupled geochemical and electrostatic system for mineral-fluid interactions.\n    \"\"\"\n    \n    # Define fundamental constants\n    R = 8.314462618  # J/mol/K\n    F = 96485.33212  # C/mol\n    EPSILON_0 = 8.8541878128e-12  # F/m\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case A: General supercritical interaction\n        {'T': 323.0, 'p_co2': 100.0, 'phi': 0.7, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 5.0e-6, 'C1': 1.1, 'epsilon_r': 70.0},\n        # Case B: Lower carbon dioxide loading\n        {'T': 323.0, 'p_co2': 5.0, 'phi': 0.9, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 5.0e-6, 'C1': 1.1, 'epsilon_r': 70.0},\n        # Case C: Boundary: very low site density, high capacitance\n        {'T': 323.0, 'p_co2': 100.0, 'phi': 0.7, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 1.0e-7, 'C1': 5.0, 'epsilon_r': 70.0}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # --- Step 1: Solve for Bulk Aqueous Chemistry ---\n        f_co2 = case['phi'] * case['p_co2']\n        conc_co2_star = case['k_H'] * f_co2\n\n        # Solve h^3 - a*h - b = 0 for h = [H+]\n        a = case['K_a1'] * conc_co2_star + case['K_w']\n        b = 2 * case['K_a1'] * case['K_a2'] * conc_co2_star\n        poly_coeffs = [1, 0, -a, -b]\n        roots = np.roots(poly_coeffs)\n        \n        # Find the single positive real root for h_bulk\n        h_bulk = 0.0\n        for r in roots:\n            if np.isreal(r) and r > 0:\n                h_bulk = np.real(r)\n                break\n        \n        # Calculate bulk properties\n        pH = -np.log10(h_bulk)\n        conc_oh = case['K_w'] / h_bulk\n        conc_hco3 = case['K_a1'] * conc_co2_star / h_bulk\n        conc_co3 = case['K_a2'] * conc_hco3 / h_bulk\n        \n        # Ionic strength I in mol/L\n        I = 0.5 * (h_bulk + conc_oh + conc_hco3 + 4 * conc_co3)\n\n        # --- Step 2: Solve the Coupled Surface-Electrostatic System ---\n        RT = R * case['T']\n        F_RT = F / RT\n        \n        # Pre-calculate Grahame equation constant\n        epsilon = case['epsilon_r'] * EPSILON_0\n        grahame_const = np.sqrt(8 * epsilon * RT * (1000 * I)) # 1000 to convert I to mol/m^3\n\n        def calc_sigma0(psi_0):\n            # Calculate surface charge density as a function of psi_0\n            exp_term = np.exp(-F_RT * psi_0)\n            h_bulk_exp = h_bulk * exp_term\n            \n            denominator = 1.0 + case['K1'] * h_bulk_exp + case['K2'] / h_bulk_exp\n            \n            theta_plus = (case['K1'] * h_bulk_exp) / denominator\n            theta_minus = (case['K2'] / h_bulk_exp) / denominator\n            \n            sigma_0 = F * case['Gamma_T'] * (theta_plus - theta_minus)\n            return sigma_0, theta_plus, theta_minus\n\n        def residual(psi_0):\n            # Residual function F(psi_0) = 0\n            sigma_0, _, _ = calc_sigma0(psi_0)\n            psi_d = psi_0 - sigma_0 / case['C1']\n            \n            # Grahame equation for diffuse layer charge (sigma_d = -sigma_0)\n            sigma_d_calc = -grahame_const * np.sinh(F * psi_d / (2 * RT))\n            \n            return sigma_0 + sigma_d_calc\n\n        # Solve for psi_0 using a robust root-finder\n        sol = root_scalar(residual, bracket=[-0.5, 0.5], method='brentq')\n        psi_0 = sol.root\n\n        # --- Step 3: Calculate Final Outputs ---\n        sigma_0, theta_plus, theta_minus = calc_sigma0(psi_0)\n        psi_d = psi_0 - sigma_0 / case['C1']\n\n        # Format results for output string\n        case_result = [\n            f\"{pH:.6f}\",\n            f\"{theta_plus:.6f}\",\n            f\"{theta_minus:.6f}\",\n            f\"{psi_0:.6f}\",\n            f\"{psi_d:.6f}\"\n        ]\n        results.append(f\"[{','.join(case_result)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}