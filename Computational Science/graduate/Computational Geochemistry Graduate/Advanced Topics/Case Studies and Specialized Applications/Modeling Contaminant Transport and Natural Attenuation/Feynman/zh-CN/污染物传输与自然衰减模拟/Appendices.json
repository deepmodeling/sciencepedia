{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的计算模型之前，首先必须对控制污染物迁移的关键物理和地球化学过程有深刻的理解。本练习将引导你从基本原理出发，推导一个描述溶质在多孔介质中迁移的核心概念——阻滞作用。通过亲手推导溶质穿透时间，你将具体地看到吸附等地球化学相互作用如何显著减缓污染物的迁移速度，从而为更复杂的数值模拟打下坚实的理论基础。",
            "id": "4086141",
            "problem": "一个性质均一的一维饱和含水层，在位置 $x=0$ 和时间 $t=0$ 时接收到溶解溶质的瞬时阶跃输入。该含水层是均质且各向同性的，其水力传导系数为 $K$，水力梯度为 $i$，孔隙度为 $n$，容重为 $\\rho_b$。溶质经历线性、瞬时平衡吸附，其特征由分配系数 $K_d$ 描述。在所考虑的运移距离内，弥散和一级衰减可忽略不计。使用一种不发生吸附的保守示踪剂作为参考。监测点位于源下游距离 $L$ 处。\n\n仅从达西定律和体现在对流-弥散-反应方程 (ADRE) 中的液相和吸附相质量守恒出发，推导在所述假设下溶质前缘的运动传播速度，并用它计算延迟溶质在 $x=L$ 处的穿透时间（相对于保守示踪剂表示）。然后使用以下数据对穿透时间进行数值计算：\n- 水力传导系数 $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$，\n- 水力梯度 $i = 1.0 \\times 10^{-2}$，\n- 孔隙度 $n = 0.30$，\n- 容重 $\\rho_b = 1600 \\,\\text{kg/m}^{3}$，\n- 分配系数 $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$，\n- 下游距离 $L = 100 \\,\\text{m}$。\n\n将最终穿透时间以天为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "该问题要求推导延迟溶质的穿透时间并进行数值计算。推导必须从基本原理开始：达西定律和质量守恒。\n\n### 步骤1：问题验证\n\n首先，根据指定标准对问题陈述进行验证。\n\n**提取的已知条件：**\n- 系统：一维饱和含水层，均质，各向同性。\n- 输入：在 $x=0$, $t=0$ 处溶解溶质的瞬时阶跃输入。\n- 水力性质：水力传导系数 $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$，水力梯度 $i = 1.0 \\times 10^{-2}$，孔隙度 $n = 0.30$。\n- 含水层固体性质：容重 $\\rho_b = 1600 \\,\\text{kg/m}^{3}$。\n- 溶质性质：经历线性、瞬时平衡吸附，其特征由分配系数 $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$ 描述。\n- 假设：弥散和一级衰减可忽略不计。\n- 参考：使用保守示踪剂（无吸附，$K_d=0$）。\n- 监测点：下游距离 $L = 100 \\,\\text{m}$。\n- 任务：\n  1. 推导溶质前缘的运动传播速度。\n  2. 用它计算延迟溶质在 $x=L$ 处的穿透时间，相对于保守示踪剂表示。\n  3. 以天为单位对穿透时间进行数值计算，并四舍五入至四位有效数字。\n\n**使用提取的已知条件进行验证：**\n- **科学依据：** 该问题基于对流-弥散-反应方程 (ADRE)、达西定律和线性吸附概念，这些是污染物水文地质学和计算地球化学中的基本且普遍接受的原理。所做的假设（一维输运、忽略弥散/衰减、平衡吸附）是为了获得解析解而进行的标准简化。\n- **适定性：** 该问题提供了所有必要的参数和一组清晰的初始/边界条件（阶跃输入）。它要求一个特定的、可计算的量（穿透时间）。存在唯一且有意义的解。\n- **客观性：** 问题陈述使用了精确、定量且无偏见的语言。所有术语均为该学科内的标准术语。\n\n**结论：** 该问题是有效的。它是一个标准的、适定的问题，可以使用已建立的科学原理来解决。\n\n### 步骤2：推导与求解\n\n求解过程首先推导给定条件下溶质输运的控制偏微分方程，然后求解溶质速度和穿透时间。\n\n**控制方程的推导**\n一维多孔介质中溶质的质量守恒原理指出，控制体积内总溶质质量的时间变化率由穿过其边界的溶质净通量以及任何内部源或汇来平衡。对于含水层的单位体积，这表示为：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial J}{\\partial x} - \\text{Reactions}\n$$\n其中：\n- $C$ 是溶质的液相浓度 [质量/流体体积]。\n- $S$ 是溶质的吸附浓度 [溶质质量/固体质量]。\n- $n$ 是孔隙度 [无量纲]。\n- $\\rho_b$ 是多孔介质的容重 [固体质量/含水层体积]。\n- $J$ 是总溶质通量 [质量/面积/时间]。\n- 项 $nC + \\rho_b S$ 表示单位含水层体积中的总溶质质量。\n\n问题陈述一级衰减可忽略不计，因此反应项为零。总通量 $J$ 是对流通量和弥散通量之和。对流通量为 $J_{adv} = qC$，其中 $q$ 是达西通量。根据假设，弥散通量可忽略不计。因此，总通量为 $J = qC$。\n\n质量守恒方程简化为：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial (qC)}{\\partial x}\n$$\n问题指定了线性、瞬时平衡吸附，由关系式 $S = K_d C$ 描述，其中 $K_d$ 是分配系数。将此代入守恒方程：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b K_d C) = -\\frac{\\partial (qC)}{\\partial x}\n$$\n由于对于均质含水层，$n$、$\\rho_b$ 和 $K_d$ 是常数，我们可以将它们从时间导数中提取出来。含水层也是均一的，意味着水力性质是恒定的，因此达西通量 $q$ 相对于位置 $x$ 也是恒定的。\n$$\n(n + \\rho_b K_d) \\frac{\\partial C}{\\partial t} = -q \\frac{\\partial C}{\\partial x}\n$$\n为了将此方程表示为ADRE的标准形式，我们除以孔隙度 $n$：\n$$\n\\left(1 + \\frac{\\rho_b K_d}{n}\\right) \\frac{\\partial C}{\\partial t} = -\\frac{q}{n} \\frac{\\partial C}{\\partial x}\n$$\n我们定义两个关键参数。首先，**延迟因子** $R$：\n$$\nR = 1 + \\frac{\\rho_b K_d}{n}\n$$\n其次，**平均线性地下水流速** $v$，即达西通量 $q$ 除以孔隙度 $n$。根据达西定律，$q = Ki$，其中 $K$ 是水力传导系数，$i$ 是水力梯度。\n$$\nv = \\frac{q}{n} = \\frac{Ki}{n}\n$$\n将这些定义代回方程中，得到：\n$$\nR \\frac{\\partial C}{\\partial t} = -v \\frac{\\partial C}{\\partial x}\n$$\n重新整理得到延迟溶质的一维对流方程的最终形式：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{v}{R} \\frac{\\partial C}{\\partial x} = 0\n$$\n这是一个一阶线性双曲型偏微分方程。它描述了浓度剖面 $C(x,t)$ 以特征速度的传播。\n\n**运动传播速度和穿透时间**\n从上面推导的对流方程中，**溶质前缘的运动传播速度**（记为 $v_c$）是空间导数项的系数：\n$$\nv_c = \\frac{v}{R}\n$$\n这是溶质前缘移动的速度。在距离源 $L$ 处的穿透时间 $t_c$ 是距离除以该速度：\n$$\nt_c = \\frac{L}{v_c} = \\frac{L}{v/R} = \\frac{LR}{v}\n$$\n对于保守示踪剂，吸附为零（$K_d=0$），所以其延迟因子 $R_{tracer} = 1 + \\frac{\\rho_b \\cdot 0}{n} = 1$。示踪剂的速度为 $v_{tracer} = v/R_{tracer} = v$，其穿透时间为 $t_{tracer} = L/v$。\n\n因此，延迟溶质相对于保守示踪剂的穿透时间为：\n$$\nt_c = R \\cdot t_{tracer}\n$$\n延迟溶质的移动速度比保守地下水流（和保守示踪剂）慢 $R$ 倍，其穿透发生时间也晚 $R$ 倍。\n\n为了计算数值，我们可以通过代入 $R$ 和 $v$ 的公式来使用 $t_c$ 的完整表达式：\n$$\nt_c = \\frac{L \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki/n} = \\frac{Ln \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki} = \\frac{L(n + \\rho_b K_d)}{Ki}\n$$\n\n**数值计算**\n给定以下数值：\n- $L = 100 \\,\\text{m}$\n- $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$\n- $i = 1.0 \\times 10^{-2}$\n- $n = 0.30$\n- $\\rho_b = 1600 \\,\\text{kg/m}^{3}$\n- $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$\n\n首先，我们计算分子项 $L(n + \\rho_b K_d)$：\n$$\n\\text{分子} = 100 \\,\\text{m} \\times \\left(0.30 + (1600 \\,\\text{kg/m}^{3} \\times 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg})\\right)\n$$\n$$\n\\text{分子} = 100 \\,\\text{m} \\times (0.30 + 0.32) = 100 \\,\\text{m} \\times 0.62 = 62 \\,\\text{m}\n$$\n接下来，我们计算分母项 $Ki$：\n$$\n\\text{分母} = (1.0 \\times 10^{-4} \\,\\text{m/s}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6} \\,\\text{m/s}\n$$\n现在，我们计算以秒为单位的穿透时间 $t_c$：\n$$\nt_c = \\frac{62 \\,\\text{m}}{1.0 \\times 10^{-6} \\,\\text{m/s}} = 62 \\times 10^{6} \\,\\text{s} = 6.2 \\times 10^{7} \\,\\text{s}\n$$\n最后，我们将时间从秒转换为天。一天中的秒数为 $24 \\times 60 \\times 60 = 86400 \\,\\text{s}$。\n$$\nt_c (\\text{天}) = \\frac{6.2 \\times 10^{7} \\,\\text{s}}{86400 \\,\\text{s/day}} \\approx 717.59259... \\,\\text{天}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nt_c \\approx 717.6 \\,\\text{天}\n$$",
            "answer": "$$\n\\boxed{717.6}\n$$"
        },
        {
            "introduction": "虽然解析解为我们提供了精确的洞见，但它们通常只适用于高度简化的理想情景。本练习将带你进入计算地球化学的核心任务：构建一个数值模型来求解更普适情况下的运移方程。你将通过实施有限差分法，并将你的数值结果与已知的解析解进行比较，来批判性地评估模型的准确性，并探索白克列数（Peclet number, $\\mathrm{Pe}$）等无量纲参数如何影响模型的表现和误差。",
            "id": "4086213",
            "problem": "考虑在具有均匀流动的饱和、均质多孔介质中的一维污染物输运。从局部质量平衡和菲克色散本构关系出发，推导出一级衰减保守示踪剂的平流-色散-反应方程。你需要比较一个解析稳态解与一个数值稳态解，并计算在不同佩克莱特数（Peclet number (Pe)）区间下的无量纲 $L^2$ 误差范数。你的程序必须仅使用以下信息来实现下列要求。\n\n基本原理与模型设定：\n- 从包含平流和菲克水动力弥散，以及一级衰减的局部质量守恒方程开始：一维瞬态平流-色散-反应方程为\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} \\;=\\; D \\frac{\\partial^2 C}{\\partial x^2} \\;-\\; \\lambda\\, C,\n$$\n其中 $C$ 是水相浓度，$v$ 是孔隙水流速，$D$ 是纵向弥散系数，$\\lambda$ 是一级衰减常数。\n- 考虑稳态，因此 $\\partial C/\\partial t = 0$，得到常微分方程\n$$\nD \\frac{d^2 C}{dx^2} \\;-\\; v \\frac{d C}{dx} \\;-\\; \\lambda\\, C \\;=\\; 0.\n$$\n- 边界条件模拟入口处的连续源和半无限出口：在入口处施加狄利克雷（Dirichlet）条件 $C(0)=C_0$，并在 $x=L$ 处施加一个与 $x \\to \\infty$ 时有界解一致的辐射（罗宾型）出口条件。有界解析解的形式为 $C(x)=C_0 \\exp(r_- x)$，其中\n$$\nr_- \\;=\\; \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D} \\;\\le\\; 0.\n$$\n相应的精确辐射边界条件是\n$$\n\\left.\\frac{dC}{dx}\\right|_{x=L} \\;=\\; r_-\\, C(L).\n$$\n\n解析参考解：\n- 稳态解析浓度剖面为\n$$\nC_{\\text{exact}}(x) \\;=\\; C_0 \\, \\exp\\!\\big(r_- x\\big),\n$$\n其中 $r_-$ 的定义如上。\n\n需实现的数值格式：\n- 在均匀网格 $x_i = i\\,\\Delta x$（$i=0,1,\\dots,N$，$\\Delta x = L/N$）上对稳态常微分方程进行离散化。\n- 对弥散项使用二阶中心差分，对平流项使用适用于正 $v$ 值的一阶迎风差分：\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} \\;-\\; v \\frac{C_i - C_{i-1}}{\\Delta x} \\;-\\; \\lambda C_i \\;=\\; 0,\\quad i=1,\\dots,N-1.\n$$\n- 在 $i=0$ 处强制执行 $C_0 = C(0)$，并在 $i=N$ 处使用一阶单边导数强制执行辐射边界条件，\n$$\n\\frac{C_N - C_{N-1}}{\\Delta x} \\;=\\; r_-\\, C_N.\n$$\n\n误差度量定义：\n- 定义无量纲相对 $L^2$ 误差范数为\n$$\n\\varepsilon \\;=\\; \\frac{\\left( \\sum_{i=0}^{N} \\left(C_i - C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} \\left(C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}.\n$$\n\n佩克莱特数变化：\n- 定义域尺度佩克莱特数为 $\\mathrm{Pe}_L = v L / D$。对于每个测试案例，通过 $D = v L / \\mathrm{Pe}_L$ 计算 $D$ 以获得指定的佩克莱特数区间。\n\n物理单位与常数：\n- 使用 $L$（米），$v$（米/天），$D$（平方米/天），以及 $\\lambda$（1/天）。设置入口浓度 $C_0 = 1$（一致的任意单位）；所有输出均为无量纲。\n\n测试套件：\n- 你的程序必须评估以下四个案例，每个案例由 $(L, v, \\mathrm{Pe}_L, \\lambda, N)$ 指定：\n    - 案例 1：$L=100$, $v=1$, $\\mathrm{Pe}_L=0.1$, $\\lambda=0$, $N=200$。\n    - 案例 2：$L=100$, $v=1$, $\\mathrm{Pe}_L=1$, $\\lambda=0$, $N=200$。\n    - 案例 3：$L=100$, $v=1$, $\\mathrm{Pe}_L=10$, $\\lambda=0.01$, $N=200$。\n    - 案例 4：$L=100$, $v=1$, $\\mathrm{Pe}_L=100$, $\\lambda=0.01$, $N=200$。\n\n你的程序必须做什么：\n- 对每个测试案例，根据指定的 $\\mathrm{Pe}_L$ 计算 $D$，构建并求解由上述离散化定义的线性系统，评估解析解，并计算定义的无量纲相对 $L^2$ 误差 $\\varepsilon$。\n- 为每个测试案例报告一个浮点数，对应其 $\\varepsilon$ 值。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，按上述四个测试案例的顺序排列结果，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_k$ 是案例 $k$ 的无量纲相对 $L^2$ 误差。",
            "solution": "该问题要求对一维稳态平流-色散-反应方程（ADRE）的解析解和数值解进行比较。我们将针对四个在不同佩克莱特数区间下的测试案例，计算无量纲相对 $L^2$ 误差范数。该过程包括从指定的有限差分格式中推导出线性代数方程组，求解该系统以获得数值浓度剖面，计算相应的解析剖面，最后计算误差范数。\n\n### 1. 问题阐述\n\n一维污染物在稳态下（$\\partial C/\\partial t = 0$）的输运控制方程为一个二阶常微分方程（ODE）：\n$$\nD \\frac{d^2 C}{dx^2} - v \\frac{d C}{dx} - \\lambda C = 0\n$$\n其中 $C(x)$ 是浓度，$v$ 是孔隙水流速，$D$ 是弥散系数，$\\lambda$ 是一级衰减速率常数。定义域为 $x \\in [0, L]$。\n\n边界条件为：\n1. 入口处的狄利克雷条件：$C(0) = C_0$。\n2. 出口处的辐射（罗宾型）条件：$\\left.\\frac{dC}{dx}\\right|_{x=L} = r_- C(L)$。\n\n满足这些条件的半无限域的解析解为：\n$$\nC_{\\text{exact}}(x) = C_0 \\exp(r_- x)\n$$\n其中速率常数 $r_-$ 是特征方程 $D r^2 - v r - \\lambda = 0$ 的负根：\n$$\nr_- = \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D}\n$$\n由于 $v, \\lambda, D$ 均为非负值，平方根下的项大于或等于 $v^2$，确保 $r_- \\le 0$。\n\n### 2. 数值离散化与线性系统\n\n将域 $[0, L]$ 离散化为一个包含 $N$ 个分段的均匀网格，得到 $N+1$ 个节点 $x_i = i \\Delta x$（$i=0, 1, \\dots, N$），其中 $\\Delta x = L/N$。这些节点上的浓度记为 $C_i \\approx C(x_i)$。\n\n问题为内部节点（$i=1, \\dots, N-1$）指定了一个有限差分格式：弥散项采用二阶中心差分，平流项采用一阶迎风差分（针对 $v > 0$）。\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} - v \\frac{C_i - C_{i-1}}{\\Delta x} - \\lambda C_i = 0\n$$\n对平流项选择迎风格式能确保数值格式的稳定性，特别是在平流主导的问题中（即高网格佩克莱特数 $\\mathrm{Pe}_c = v \\Delta x / D$），但它会引入一阶截断误差，这是数值弥散的一个来源。\n\n重新整理方程，按节点索引（$C_{i-1}, C_i, C_{i+1}$）分组：\n$$\n\\left(\\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}\\right) C_{i-1} + \\left(-\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda\\right) C_i + \\left(\\frac{D}{\\Delta x^2}\\right) C_{i+1} = 0\n$$\n这个方程在未知浓度 $C_i$ 上是线性的。我们可以将 $i=1, \\dots, N-1$ 的这组方程写成矩阵形式。令未知数向量为 $\\mathbf{C}_{\\text{unk}} = [C_1, C_2, \\dots, C_N]^T$。\n\n边界条件按如下方式并入：\n- **入口 ($i=0$)：** $C_0$ 是一个已知值。对于 $i=1$ 处的方程，涉及 $C_0$ 的项被移到右侧。\n- **出口 ($i=N$)：** 辐射边界条件使用一阶单边差分进行离散化：\n    $$\n    \\frac{C_N - C_{N-1}}{\\Delta x} = r_- C_N\n    $$\n    整理后得到一个涉及 $C_{N-1}$ 和 $C_N$ 的线性方程：\n    $$\n    -C_{N-1} + (1 - r_- \\Delta x) C_N = 0\n    $$\n\n我们构建一个 $N \\times N$ 的线性系统 $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$。\n令内部节点的系数为：\n- 次对角线：$A_{\\text{sub}} = \\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}$\n- 主对角线：$A_{\\text{main}} = -\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda$\n- 超对角线：$A_{\\text{sup}} = \\frac{D}{\\Delta x^2}$\n\n系统构建如下（对未知数 $C_1, \\dots, C_N$ 和方程使用 1-基索引）：\n- **方程 1 (针对 $C_1$)：** 根据在 $i=1$ 处的模板，我们有 $A_{\\text{sub}}C_0 + A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = 0$。由于 $C_0$ 已知，这变为 $A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = -A_{\\text{sub}}C_0$。\n- **方程 $i=2, \\dots, N-1$ (针对 $C_2, \\dots, C_{N-1}$):** 这些是 $A_{\\text{sub}}C_{i-1} + A_{\\text{main}}C_i + A_{\\text{sup}}C_{i+1} = 0$。这在矩阵 $M$ 的相应行中形成了一个三对角结构。\n- **方程 $N$ (针对 $C_N$)：** 根据出口边界条件，我们有 $-C_{N-1} + (1 - r_- \\Delta x)C_N = 0$。\n\n得到的矩阵 $M$ 近似为三对角矩阵，该系统可以使用标准的线性求解器高效求解。\n\n### 3. 误差计算\n\n一旦获得数值解向量 $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$，我们将其与在网格点上评估的解析解 $\\mathbf{C}_{\\text{exact}} = [C_{\\text{exact}}(x_0), \\dots, C_{\\text{exact}}(x_N)]^T$ 进行比较。\n\n无量纲相对 $L^2$ 误差范数 $\\varepsilon$ 定义为：\n$$\n\\varepsilon = \\frac{\\left( \\sum_{i=0}^{N} (C_i - C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} (C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}\n$$\n项 $\\Delta x$ 同时出现在分子和分母中，因此可以消去，将计算简化为误差向量和精确解向量的欧几里得范数之比：\n$$\n\\varepsilon = \\frac{\\|\\mathbf{C}_{\\text{num}} - \\mathbf{C}_{\\text{exact}}\\|_2}{\\|\\mathbf{C}_{\\text{exact}}\\|_2}\n$$\n\n### 4. 实现策略\n\n对于由 $(L, v, \\mathrm{Pe}_L, \\lambda, N)$ 指定的每个测试案例：\n1. 计算派生的物理和数值参数：$D = v L / \\mathrm{Pe}_L$ 和 $\\Delta x = L/N$。\n2. 计算解析常数 $r_-$。\n3. 在所有 $N+1$ 个网格点上评估解析解 $C_{\\text{exact}}(x_i)$。\n4. 构建线性系统的 $N \\times N$ 矩阵 $M$ 和 $N \\times 1$ 右侧向量 $\\mathbf{d}$。\n5. 求解 $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$ 以找到数值浓度 $C_1, \\dots, C_N$。\n6. 组装完整的数值解向量 $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$。\n7. 使用上述公式计算误差范数 $\\varepsilon$。所有四个案例的结果将被收集并打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the contaminant transport problem for all test cases.\n    \"\"\"\n    \n    # Test suite: (L, v, Pe_L, lambda, N)\n    test_cases = [\n        (100.0, 1.0, 0.1, 0.0, 200),\n        (100.0, 1.0, 1.0, 0.0, 200),\n        (100.0, 1.0, 10.0, 0.01, 200),\n        (100.0, 1.0, 100.0, 0.01, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error_for_case(*case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\ndef calculate_error_for_case(L, v, Pe_L, lam, N):\n    \"\"\"\n    Calculates the dimensionless relative L2 error for a single test case.\n\n    Args:\n        L (float): Domain length [m].\n        v (float): Pore-water velocity [m/day].\n        Pe_L (float): Domain-scale Peclet number.\n        lam (float): First-order decay constant [1/day].\n        N (int): Number of grid segments.\n\n    Returns:\n        float: The dimensionless relative L2 error.\n    \"\"\"\n    # --- 1. Calculate derived parameters ---\n    C0 = 1.0\n    dx = L / N\n    D = v * L / Pe_L\n    \n    # Check for non-physical conditions, though not expected from problem statement\n    if D == 0:\n        raise ValueError(\"Dispersion coefficient D must be positive.\")\n\n    # Calculate the exponent r_minus for the analytical solution\n    # The term under the square root is always non-negative for this problem\n    r_minus_sqrt_term = np.sqrt(v**2 + 4 * lam * D)\n    r_minus = (v - r_minus_sqrt_term) / (2 * D)\n\n    # --- 2. Evaluate Analytical Solution ---\n    x = np.linspace(0, L, N + 1)  # Grid with N+1 points\n    C_exact = C0 * np.exp(r_minus * x)\n\n    # --- 3. Set up and Solve the Numerical System ---\n    # The system is M * C_unk = d, for unknowns C_1, ..., C_N\n    M = np.zeros((N, N))\n    d = np.zeros(N)\n\n    # Coefficients for the interior node finite difference equation\n    A_sup = D / dx**2\n    A_sub = D / dx**2 + v / dx\n    A_main = -2 * D / dx**2 - v / dx - lam\n\n    # Assemble the matrix M and vector d\n    # The unknown vector is C_unk = [C_1, C_2, ..., C_N]\n    # Matrix indices are 0 to N-1 for unknowns 1 to N\n    \n    # Equation for node i=1 (matrix row 0)\n    # A_sub*C_0 + A_main*C_1 + A_sup*C_2 = 0\n    M[0, 0] = A_main\n    M[0, 1] = A_sup\n    d[0] = -A_sub * C0\n\n    # Equations for interior nodes i=2 to N-1 (matrix rows 1 to N-2)\n    for i in range(1, N - 1):\n        # row i is for node i+1\n        M[i, i - 1] = A_sub\n        M[i, i] = A_main\n        M[i, i + 1] = A_sup\n\n    # Equation for node i=N (outlet BC, matrix row N-1)\n    # (C_N - C_{N-1}) / dx = r_minus * C_N  => -C_{N-1} + (1 - r_minus*dx)*C_N = 0\n    M[N - 1, N - 2] = -1.0\n    M[N - 1, N - 1] = 1.0 - r_minus * dx\n\n    # Solve the linear system\n    C_unk = np.linalg.solve(M, d)\n\n    # Construct the full numerical solution vector [C_0, C_1, ..., C_N]\n    C_num = np.concatenate(([C0], C_unk))\n\n    # --- 4. Compute the Error Norm ---\n    # The dx term in the sum cancels out, so we can compute the norm directly.\n    numerator = np.linalg.norm(C_num - C_exact)\n    denominator = np.linalg.norm(C_exact)\n\n    if denominator == 0:\n        # This case would only occur if C_exact is uniformly zero, which doesn't happen here.\n        return 0.0 if numerator == 0 else np.inf\n\n    error = numerator / denominator\n    return error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "任何预测模型的可靠性都取决于其输入参数的准确性，而这些参数在实际应用中往往充满不确定性。本练习将带领你从模型构建进阶到模型分析，这是一项在环境风险评估和场地修复设计中至关重要的技能。通过实施局部敏感性分析，你将学会量化不同物理参数（如地下水流速 $v$、弥散系数 $D$ 和分配系数 $K_d$）对模拟结果的影响程度，从而识别出对模型预测起决定性作用的关键因素。",
            "id": "4086179",
            "problem": "您的任务是为在饱和多孔介质中具有自然衰减特性的一维污染物迁移模型实现局部灵敏度分析。其控制物理基于溶解物质的质量平衡，该物质经历平流、水动力弥散、线性平衡吸附和一级衰减。数学模型是带线性阻滞的平流-弥散-反应方程，在一维空间中表示为\n$$\nR \\,\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,R\\,C,\n$$\n其中 $C(x,t)$ 是溶解浓度，$R$ 是由吸附引起的阻滞因子，$v$ 是平均线性地下水流速，$D$ 是水动力弥散系数，$\\lambda$ 是一级衰减常数。线性平衡吸附由阻滞因子表示\n$$\nR = 1 + \\frac{\\rho_b K_d}{n},\n$$\n其中 $\\rho_b$ 是容重，$K_d$ 是线性分配系数，$n$ 是孔隙度。\n\n初始条件和边界条件如下：\n- 初始条件：$$C(x,0) = 0 \\quad \\text{for} \\quad 0 \\le x \\le L.$$\n- $x=0$ 处的左边界（源）：$$C(0,t) = C_{\\mathrm{in}}(t), \\quad \\text{where } C_{\\mathrm{in}}(t) = \\begin{cases} C_0,  0 \\le t \\le t_s, \\\\ 0,  t > t_s, \\end{cases}$$ 其中 $C_0$ 是恒定的源浓度，$t_s$ 是源关闭时间。\n- $x=L$ 处的右边界：零梯度（诺伊曼）条件 $$\\frac{\\partial C}{\\partial x}(L,t) = 0.$$\n\n您的程序必须：\n1. 使用全隐式、时间上一阶精确的格式，对流项使用迎风格式，弥散项使用中心差分格式来离散化控制方程。明确地，通过除以阻滞因子来写出\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{v}{R}\\,\\frac{\\partial C}{\\partial x} = \\frac{D}{R}\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,C,\n$$\n然后在 $t^{n+1}$ 时刻进行时间离散化，并构建一个三对角线性系统，强制执行左侧狄利克雷边界和右侧诺伊曼边界。该格式对于 $v > 0$ 必须是无条件稳定且单调的。\n2. 对于指定的观测位置 $x_w$ 和最终时间 $t_f$，以及一组给定的参数 $\\{v,D,\\lambda,K_d\\}$ 和固定的 $\\{n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N\\}$（其中 $N$ 是空间节点数），计算预测的羽流浓度 $C(x_w,t_f)$，单位为 $\\mathrm{mg/L}$。\n3. 通过估算偏导数来进行局部灵敏度分析\n$$\n\\frac{\\partial C(x_w,t_f)}{\\partial p_i}\n$$\n对每个参数 $p_i \\in \\{v,D,\\lambda,K_d\\}$，使用对称双边有限差分近似\n$$\n\\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i - \\delta_i)}{2\\,\\delta_i},\n$$\n其中扰动 $\\delta_i$ 必须满足 $\\delta_i = \\max(\\epsilon\\,|p_i|, \\delta_{i,\\min})$，其中相对步长 $0  \\epsilon \\ll 1$，$\\delta_{i,\\min}$ 是特定于参数的最小步长，以避免当 $p_i$ 非常小或为零时出现零步长问题。确保所有扰动后的参数保持物理上有意义（例如，非负）。\n4. 根据其局部灵敏度的大小对参数进行排序，即，按 $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$ 的降序对 $p_i$ 的索引进行排序。使用索引映射 $p_0 \\equiv v$，$p_1 \\equiv D$，$p_2 \\equiv \\lambda$，$p_3 \\equiv K_d$。\n\n所有内部计算和最终计算出的浓度以 $\\mathrm{mg/L}$ 表示，距离以 $\\mathrm{m}$ 表示，时间以 $\\mathrm{s}$ 表示，速度以 $\\mathrm{m/s}$ 表示，弥散系数以 $\\mathrm{m^2/s}$ 表示，衰减率以 $\\mathrm{s^{-1}}$ 表示，容重以 $\\mathrm{kg/m^3}$ 表示，孔隙度为无量纲，分配系数以 $\\mathrm{m^3/kg}$ 表示。角度不出现。最终输出是参数索引的排序，无单位。\n\n测试套件。实现并评估以下三个测试案例，每个案例由一组参数元组定义，顺序为 $(v,D,\\lambda,K_d,n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N)$：\n- 案例 A（典型条件）：$(1.0\\times 10^{-5},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n- 案例 B（低弥散，更快流速）：$(1.5\\times 10^{-5},\\,1.0\\times 10^{-8},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n- 案例 C（可忽略的衰减，更高吸附）：$(8.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,0.0,\\,7.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n\n局部灵敏度设置：对所有参数使用相对扰动 $\\epsilon = 0.01$，最小扰动为 $(\\delta_{v,\\min},\\delta_{D,\\min},\\delta_{\\lambda,\\min},\\delta_{K_d,\\min}) = (1.0\\times 10^{-8},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-6})$。\n\n您的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起来，其中每个元素是对应测试案例的排序后参数索引的列表，例如，$$\\texttt{[[i_1,i_2,i_3,i_4],[j_1,j_2,j_3,j_4],[k_1,k_2,k_3,k_4]]}$$ 其中 $i_1$ 是案例 A 中影响最大的参数索引，依此类推。最终输出必须是整数列表。",
            "solution": "用户提供了一个计算地球化学领域的计算密集型问题，要求实现一个污染物迁移的数值模型，并随后进行局部灵敏度分析。\n\n### 步骤1：提取给定信息\n\n- **控制方程**：带线性阻滞的一维平流-弥散-反应方程如下：\n  $$\n  R \\,\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,R\\,C\n  $$\n  其中 $C(x,t)$ 是溶解浓度，$R$ 是阻滞因子，$v$ 是平均线性地下水流速，$D$ 是水动力弥散系数，$\\lambda$ 是一级衰减常数。\n\n- **阻滞因子**：\n  $$\n  R = 1 + \\frac{\\rho_b K_d}{n}\n  $$\n  其中 $\\rho_b$ 是容重，$K_d$ 是线性分配系数，$n$ 是孔隙度。\n\n- **初始和边界条件**：\n  - 初始条件：$C(x,0) = 0$，对于 $0 \\le x \\le L$。\n  - 左边界（$x=0$）：一个由狄利克雷条件指定的脉冲源，$C(0,t) = C_{\\mathrm{in}}(t)$，其中当 $0 \\le t \\le t_s$ 时 $C_{\\mathrm{in}}(t) = C_0$，当 $t  t_s$ 时 $C_{\\mathrm{in}}(t) = 0$。\n  - 右边界（$x=L$）：一个零梯度诺伊曼条件，$\\frac{\\partial C}{\\partial x}(L,t) = 0$。\n\n- **数值格式**：要求采用全隐式、时间上一阶精确的格式。空间离散化对对流项使用一阶迎风格式，对弥散项使用二阶中心差分格式。\n\n- **灵敏度分析**：对于每个参数 $p_i \\in \\{v,D,\\lambda,K_d\\}$ 的偏导数 $\\frac{\\partial C(x_w,t_f)}{\\partial p_i}$，将使用对称双边有限差分近似进行估算：\n  $$\n  \\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i - \\delta_i)}{2\\,\\delta_i}\n  $$\n  扰动 $\\delta_i$ 定义为 $\\delta_i = \\max(\\epsilon\\,|p_i|, \\delta_{i,\\min})$，其中 $\\epsilon = 0.01$。最小扰动给定为 $(\\delta_{v,\\min},\\delta_{D,\\min},\\delta_{\\lambda,\\min},\\delta_{K_d,\\min}) = (1.0\\times 10^{-8},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-6})$。\n\n- **参数排序**：参数将按照其局部灵敏度 $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$ 的大小降序排列。参数索引映射为 $p_0 \\equiv v$，$p_1 \\equiv D$，$p_2 \\equiv \\lambda$，$p_3 \\equiv K_d$。\n\n- **测试案例**：提供了三组特定的参数用于评估。\n  - 案例 A：$(v,D,\\lambda,K_d,n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N) = (1.0\\times 10^{-5},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n  - 案例 B：$(1.5\\times 10^{-5},\\,1.0\\times 10^{-8},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n  - 案例 C：$(8.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,0.0,\\,7.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$。\n\n- **单位和输出格式**：所有单位都已指定。最终输出必须是一个单行字符串，表示一个包含排序后整数索引列表的列表。\n\n### 步骤2：使用提取的给定信息进行验证\n\n- **科学基础**：该问题在科学上是合理的。控制方程是标准的平流-弥散-反应方程（ADRE），这是污染物迁移建模的基石。阻滞因子的公式是线性平衡吸附的正确表示。\n- **适定性**：该问题是适定的。带有给定初始和边界条件（脉冲型源和零通量出口）的ADRE是一个标准的初边值问题，它有一个唯一解。所要求的数值格式是一种已知的稳定方法（全隐式）。灵敏度分析的方法是一种标准的数值技术。\n- **客观性**：问题不含主观性。所有参数、变量和常量都有明确定义及其各自的单位。任务以数学和算法的精确性进行了规定。\n- **完整性与一致性**：问题陈述是自洽的。它提供了所有必需的物理参数（$v, D, \\lambda, K_d, n, \\rho_b$）、区域规格（$L$）、边界条件参数（$C_0, t_s$）、数值离散化参数（$N, \\Delta t, t_f$）和观测细节（$x_w, t_f$）。单位是一致的。没有矛盾。\n- **可行性**：提供的参数值对于典型的地下水污染情景是物理上现实的。计算任务虽然密集，但实现和执行是可行的。\n- **其他缺陷**：该问题并非微不足道、非形式化或不可验证。这是一个在计算科学领域中定义明确的标准问题。\n\n### 步骤3：结论与行动\n\n问题是**有效的**。将构建一个解决方案。\n\n### 解决方案\n\n解决方案分两个阶段进行。首先，我们为控制偏微分方程（PDE）开发一个数值求解器。其次，我们使用这个求解器进行局部灵敏度分析。\n\n**1. 控制方程的数值模型**\n\n首先通过除以阻滞因子 $R$ 来重写控制PDE：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{D}{R}\\frac{\\partial^2 C}{\\partial x^2} - \\frac{v}{R}\\frac{\\partial C}{\\partial x} - \\lambda C\n$$\n我们定义有效（阻滞后）弥散系数和速度为 $D' = D/R$ 和 $v' = v/R$。方程变为：\n$$\n\\frac{\\partial C}{\\partial t} = D'\\frac{\\partial^2 C}{\\partial x^2} - v'\\frac{\\partial C}{\\partial x} - \\lambda C\n$$\n我们在一个空间步长为 $\\Delta x = L/(N-1)$、时间步长为 $\\Delta t$ 的均匀网格上离散化这个方程。令 $C_i^j$ 表示浓度 $C(x_i, t_j)$ 的数值近似，其中 $x_i = i\\Delta x$ 且 $t_j = j\\Delta t$。\n\n全隐式时间步进格式在未来的时间层 $j+1$ 评估所有空间导数：\n$$\n\\frac{C_i^{j+1} - C_i^j}{\\Delta t} = D' \\left(\\frac{\\partial^2 C}{\\partial x^2}\\right)_i^{j+1} - v' \\left(\\frac{\\partial C}{\\partial x}\\right)_i^{j+1} - \\lambda C_i^{j+1}\n$$\n空间导数按规定进行近似：对流项使用一阶迎风格式（假设 $v'  0$），弥散项使用二阶中心差分格式。\n$$\n\\left(\\frac{\\partial C}{\\partial x}\\right)_i^{j+1} \\approx \\frac{C_i^{j+1} - C_{i-1}^{j+1}}{\\Delta x}\n$$\n$$\n\\left(\\frac{\\partial^2 C}{\\partial x^2}\\right)_i^{j+1} \\approx \\frac{C_{i+1}^{j+1} - 2C_i^{j+1} + C_{i-1}^{j+1}}{(\\Delta x)^2}\n$$\n将这些近似代入时间离散化的方程中，并重新整理各项，将未知数（在时间层 $j+1$）分组到左侧，得到每个内部节点 $i=1, \\dots, N-2$ 的线性方程：\n$$\n\\left(-\\frac{v'}{\\Delta x} - \\frac{D'}{(\\Delta x)^2}\\right)C_{i-1}^{j+1} + \\left(\\frac{1}{\\Delta t} + \\frac{v'}{\\Delta x} + \\frac{2D'}{(\\Delta x)^2} + \\lambda\\right)C_i^{j+1} + \\left(-\\frac{D'}{(\\Delta x)^2}\\right)C_{i+1}^{j+1} = \\frac{C_i^j}{\\Delta t}\n$$\n这形成了一个三对角线性方程组 $\\mathbf{A}\\mathbf{C}^{j+1} = \\mathbf{d}$，其中 $\\mathbf{C}^{j+1}$ 是新时间步长的未知浓度向量。\n\n**边界条件：**\n- **左边界（$i=0$）：** 狄利克雷条件 $C_0^{j+1} = C_{\\mathrm{in}}(t_{j+1})$ 被直接强制执行。对于系统的第一个方程（在 $i=1$ 处），涉及 $C_0^{j+1}$ 的项是已知的，并移到右侧。\n- **右边界（$i=N-1$）：** 诺伊曼条件 $\\frac{\\partial C}{\\partial x}(L, t) = 0$ 使用一个涉及“虚拟”节点 $C_N^{j+1}$ 的二阶中心差分来近似：$\\frac{C_N^{j+1}-C_{N-2}^{j+1}}{2\\Delta x} = 0$，这意味着 $C_N^{j+1} = C_{N-2}^{j+1}$。将此代入节点 $i=N-1$ 处的离散化PDE中，会修改线性系统的最后一个方程。\n\n由此产生的 $(N-1) \\times (N-1)$ 三对角系统在每个时间步求解，以将解从 $t_j$ 推进到 $t_{j+1}$。该系统是严格对角占优的，确保了可以使用像Thomas算法（在 `scipy.linalg.solve_banded` 中实现）这样的算法高效地获得稳定解。从初始条件 $C(x,0) = 0$ 开始，解在时间上向前推进，直到达到最终时间 $t_f$。\n\n**2. 局部灵敏度分析**\n\n分析的核心是一个函数 `solve_pde`，它接受整套模型参数并返回浓度 $C(x_w, t_f)$。为了计算关于参数 $p_i \\in \\{v, D, \\lambda, K_d\\}$ 的灵敏度，我们使用双边有限差分公式。这需要额外两次调用 `solve_pde` 函数，分别使用扰动后的参数值 $p_i + \\delta_i$ 和 $p_i - \\delta_i$。\n\n当扰动后的参数值变得物理上无意义（例如，为负）时，会出现特殊情况。问题陈述要求扰动保持物理意义。如果 $p_i - \\delta_i  0$，则不能使用对称差分公式。这种情况在案例C中对参数 $\\lambda$ 出现，因为 $\\lambda=0$。在这种情况下，我们回退到一阶向前有限差分：\n$$\n\\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i)}{\\delta_i}\n$$\n这需要一次使用扰动参数集的调用和一次使用基础参数集的调用。\n\n对于每个测试案例，对所有四个感兴趣的参数（$v$, $D$, $\\lambda$, $K_d$）重复此过程。然后使用计算出的灵敏度的绝对值 $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$ 对参数进行排序，从影响最大（灵敏度最高）到影响最小。最终输出是参数索引（$v$为0，$D$为1，$\\lambda$为2，$K_d$为3）的有序列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_pde(v, D, lambda_rate, Kd, n, rhob, L, xw, dt, tf, C0, ts, N):\n    \"\"\"\n    Solves the 1D advection-dispersion-reaction equation using a fully implicit finite-difference scheme.\n\n    Returns:\n        Concentration at observation well xw and final time tf.\n    \"\"\"\n    # 1. Spatial and temporal discretization parameters\n    dx = L / (N - 1.0)\n    n_steps = int(round(tf / dt))\n    xw_idx = int(round(xw / dx))\n\n    # 2. Derived physical parameters\n    if n == 0: return -1.0 # Avoid division by zero\n    retardation_factor = 1.0 + rhob * Kd / n\n    if retardation_factor == 0: return -1.0 # Unphysical\n    \n    eff_velocity = v / retardation_factor\n    eff_dispersion = D / retardation_factor\n\n    # 3. Initialize concentration field\n    C = np.zeros(N)\n\n    # 4. Assemble the tridiagonal matrix for the linear system A*C = d\n    # The matrix is time-invariant for this problem.\n    # We solve for the N-1 internal nodes (1 to N-1).\n    sub_diag_val = -(eff_velocity / dx + eff_dispersion / (dx**2))\n    main_diag_val = 1.0 / dt + eff_velocity / dx + 2.0 * eff_dispersion / (dx**2) + lambda_rate\n    sup_diag_val = -eff_dispersion / (dx**2)\n\n    # Scipy's solve_banded uses a special format for the banded matrix\n    ab = np.zeros((3, N - 1))\n    ab[0, 1:] = sup_diag_val       # Super-diagonal\n    ab[1, :] = main_diag_val       # Main-diagonal\n    ab[2, :-1] = sub_diag_val      # Sub-diagonal\n\n    # Modify the last row for the zero-gradient Neumann boundary condition\n    # a_{N-1}' * C_{N-2} + b_{N-1} * C_{N-1} = d_{N-1}\n    # where a_{N-1}' = -(v'/dx + 2D'/dx^2)\n    ab[2, N - 2] = -(eff_velocity / dx + 2.0 * eff_dispersion / (dx**2))\n\n    # 5. Time-stepping loop\n    for step in range(n_steps):\n        t_current = (step + 1) * dt\n        C_in = C0 if t_current = ts else 0.0\n\n        # Construct the right-hand side (RHS) vector\n        d = C[1:] / dt\n        \n        # Modify RHS for the Dirichlet boundary at x=0\n        # The term a_1*C_0 is moved to the RHS.\n        # d[0]' = d[0] - a_1 * C_0 where a_1 is sub_diag_val.\n        d[0] -= sub_diag_val * C_in\n\n        # Solve the tridiagonal system for internal nodes\n        C_internal = solve_banded((1, 1), ab, d)\n\n        # Update the full concentration vector\n        C[0] = C_in\n        C[1:] = C_internal\n\n    return C[xw_idx]\n\ndef run_sensitivity_analysis(case):\n    \"\"\"\n    Performs local sensitivity analysis for a given test case.\n    \"\"\"\n    v, D, lambda_rate, Kd, n, rhob, L, xw, dt, tf, C0, ts, N = case\n    params_to_analyze = [v, D, lambda_rate, Kd]\n    param_names = ['v', 'D', 'lambda', 'Kd']\n    \n    epsilon = 0.01\n    delta_mins = {\n        'v': 1.0e-8,\n        'D': 1.0e-10,\n        'lambda': 1.0e-10,\n        'Kd': 1.0e-6\n    }\n    \n    sensitivities = []\n\n    for i, p_val in enumerate(params_to_analyze):\n        p_name = param_names[i]\n        \n        delta = max(epsilon * abs(p_val), delta_mins[p_name])\n        \n        # Create argument list for the solver\n        args = list(case)\n\n        # Check if symmetric difference leads to negative parameters\n        if p_val - delta  0:\n            # Use forward difference for physical plausibility\n            args_plus = list(args)\n            args_plus[i] = p_val + delta\n            C_plus = solve_pde(*args_plus)\n            \n            C_base = solve_pde(*args)\n            \n            sensitivity = (C_plus - C_base) / delta\n        else:\n            # Use central difference\n            args_plus = list(args)\n            args_plus[i] = p_val + delta\n            C_plus = solve_pde(*args_plus)\n            \n            args_minus = list(args)\n            args_minus[i] = p_val - delta\n            C_minus = solve_pde(*args_minus)\n            \n            sensitivity = (C_plus - C_minus) / (2.0 * delta)\n            \n        sensitivities.append(sensitivity)\n\n    # Rank parameters by sensitivity magnitude\n    # np.argsort returns indices that would sort the array.\n    # We use a negative sign for descending order.\n    # The result is a list of indices [0, 1, 2, 3] sorted by sensitivity.\n    ranked_indices = np.argsort(-np.abs(sensitivities)).tolist()\n    return ranked_indices\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Test cases: (v, D, lambda, Kd, n, rhob, L, xw, dt, tf, C0, ts, N)\n    test_cases = [\n        (1.0e-5, 1.0e-6, 1.0e-7, 5.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201),\n        (1.5e-5, 1.0e-8, 1.0e-7, 5.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201),\n        (8.0e-6, 5.0e-7, 0.0,    7.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201)\n    ]\n\n    results = []\n    for case in test_cases:\n        ranked_indices = run_sensitivity_analysis(case)\n        results.append(ranked_indices)\n\n    # Format the output string to match the problem specification (no spaces)\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}