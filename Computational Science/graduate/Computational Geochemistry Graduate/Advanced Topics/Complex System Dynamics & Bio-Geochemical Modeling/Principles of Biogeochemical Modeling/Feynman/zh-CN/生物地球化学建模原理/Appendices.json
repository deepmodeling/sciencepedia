{
    "hands_on_practices": [
        {
            "introduction": "在构建生物地球化学模型时，准确描述化学反应的驱动力至关重要。在真实的含盐水溶液中，离子间的相互作用使得浓度并非化学反应性的良好指标。本练习将通过计算方解石的饱和指数，阐明在评估矿物-水平衡时，使用活度代替浓度的重要性，并揭示理想与非理想假设下的显著差异 。",
            "id": "4096464",
            "problem": "一个温度为 $25\\,^{\\circ}\\mathrm{C}$、压力为 $1\\,\\mathrm{bar}$ 的封闭水溶液体系，含有一种背景电解质氯化钠，其质量摩尔浓度为 $0.5\\,\\mathrm{mol\\ kg^{-1}}$，同时还含有溶解的钙和碳酸根，测得的自由离子质量摩尔浓度为 $m_{\\mathrm{Ca^{2+}}}=1.0\\times 10^{-3}\\,\\mathrm{mol\\ kg^{-1}}$ 和 $m_{\\mathrm{CO_{3}^{2-}}}=1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}}$。假设氯化钠完全解离，并且与背景电解质相比，钙和碳酸根对离子强度的贡献可以忽略不计。考虑方解石溶解反应 $\\mathrm{CaCO_{3}(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_{3}^{2-}}$，其平衡常数 $K$ 在质量摩尔浓度标度上定义为 $K = a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{CO_{3}^{2-}}}$，其中 $a_{i}$ 表示活度。在 $25\\,^{\\circ}\\mathrm{C}$ 时，取 $\\log_{10}K=-8.48$。饱和指数 (SI) 定义为 $\\mathrm{SI}=\\log_{10}(\\mathrm{IAP}/K)$，其中该反应的离子活度积 (IAP) 为 $\\mathrm{IAP}=a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{CO_{3}^{2-}}}$。在理想假设下，活度等于质量摩尔浓度 ($\\gamma_{i}=1$)。对于非理想行为，使用 $25\\,^{\\circ}\\mathrm{C}$ 下的 Davies 方程（参数 $A=0.509$）来估算离子强度 $I=0.5\\,\\mathrm{mol\\ kg^{-1}}$ 时的活度系数 $\\gamma_{i}$；取 $z_{\\mathrm{Ca^{2+}}}=+2$ 和 $z_{\\mathrm{CO_{3}^{2-}}}=-2$。整个计算过程使用以 10 为底的对数。\n\n计算理想情况下的 $\\mathrm{SI}$ 和非理想情况下的 $\\mathrm{SI}$，然后报告其变化量 $\\Delta \\mathrm{SI}=\\mathrm{SI}_{\\text{nonideal}}-\\mathrm{SI}_{\\text{ideal}}$。将最终报告的 $\\Delta \\mathrm{SI}$ 四舍五入到三位有效数字。最终答案以无量纲数（无单位）的形式表示。",
            "solution": "题目要求计算方解石溶解从理想溶液模型过渡到非理想溶液模型时，饱和指数的变化量 $\\Delta \\mathrm{SI}$。该变化量定义为 $\\Delta \\mathrm{SI}=\\mathrm{SI}_{\\text{nonideal}}-\\mathrm{SI}_{\\text{ideal}}$。\n\n方解石溶解的反应如下：\n$$ \\mathrm{CaCO_{3}(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_{3}^{2-}} $$\n饱和指数 $\\mathrm{SI}$ 由离子活度积 $\\mathrm{IAP}$ 和平衡常数 $K$ 定义：\n$$ \\mathrm{SI} = \\log_{10}\\left(\\frac{\\mathrm{IAP}}{K}\\right) = \\log_{10}(\\mathrm{IAP}) - \\log_{10}(K) $$\n该反应的 IAP 为 $\\mathrm{IAP}=a_{\\mathrm{Ca^{2+}}}a_{\\mathrm{CO_{3}^{2-}}}$，其中 $a_i$ 表示物种 $i$ 的活度。活度通过关系式 $a_i = \\gamma_i m_i$ 与质量摩尔浓度 $m_i$ 和活度系数 $\\gamma_i$ 相关。因此，IAP 可以表示为：\n$$ \\mathrm{IAP} = (\\gamma_{\\mathrm{Ca^{2+}}} m_{\\mathrm{Ca^{2+}}}) (\\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{CO_{3}^{2-}}}) $$\n\n在理想情况下，活度系数假定为 1，即 $\\gamma_i=1$。因此，IAP 是质量摩尔浓度的乘积：\n$$ \\mathrm{IAP}_{\\text{ideal}} = m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}} $$\n理想情况下的饱和指数为：\n$$ \\mathrm{SI}_{\\text{ideal}} = \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n\n在非理想情况下，活度系数根据溶液的离子强度计算。IAP 为：\n$$ \\mathrm{IAP}_{\\text{nonideal}} = \\gamma_{\\mathrm{Ca^{2+}}} \\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}} $$\n非理想情况下的饱和指数为：\n$$ \\mathrm{SI}_{\\text{nonideal}} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}} \\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n使用对数的性质，该表达式可以展开为：\n$$ \\mathrm{SI}_{\\text{nonideal}} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) + \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n\n我们现在可以构建变化量 $\\Delta \\mathrm{SI}$ 的表达式：\n$$ \\Delta \\mathrm{SI} = \\mathrm{SI}_{\\text{nonideal}} - \\mathrm{SI}_{\\text{ideal}} $$\n$$ \\Delta \\mathrm{SI} = \\left( \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) + \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) \\right) - \\left( \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) \\right) $$\n涉及质量摩尔浓度和平衡常数的项相互抵消，得到 $\\Delta \\mathrm{SI}$ 的简化表达式：\n$$ \\Delta \\mathrm{SI} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) $$\n\n活度系数将使用 Davies 方程进行估算。单个离子 $i$ 的 Davies 方程的标准形式为：\n$$ \\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n题目提供了必要的参数：\n- 常数 $A = 0.509$。\n- 离子强度 $I = 0.5\\,\\mathrm{mol\\ kg^{-1}}$。\n- 钙离子的电荷 $z_{\\mathrm{Ca^{2+}}} = +2$。\n- 碳酸根离子的电荷 $z_{\\mathrm{CO_{3}^{2-}}} = -2$。\n\n首先，我们计算括号内的项，该项对两种离子是相同的：\n$$ \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I = \\frac{\\sqrt{0.5}}{1+\\sqrt{0.5}} - 0.3(0.5) $$\n分数项可以通过注意到 $\\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$ 来简化：\n$$ \\frac{\\frac{1}{\\sqrt{2}}}{1+\\frac{1}{\\sqrt{2}}} = \\frac{1}{\\sqrt{2}+1} = \\frac{\\sqrt{2}-1}{(\\sqrt{2}+1)(\\sqrt{2}-1)} = \\sqrt{2}-1 $$\n所以，括号内的表达式变为：\n$$ (\\sqrt{2}-1) - 0.15 $$\n\n现在，将此代入 $\\Delta \\mathrm{SI}$ 的表达式中：\n$$ \\Delta \\mathrm{SI} = \\left[ -A z_{\\mathrm{Ca^{2+}}}^2 \\left( (\\sqrt{2}-1) - 0.15 \\right) \\right] + \\left[ -A z_{\\mathrm{CO_{3}^{2-}}}^2 \\left( (\\sqrt{2}-1) - 0.15 \\right) \\right] $$\n$$ \\Delta \\mathrm{SI} = -A (z_{\\mathrm{Ca^{2+}}}^2 + z_{\\mathrm{CO_{3}^{2-}}}^2) \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n我们代入电荷和常数 $A$ 的数值：\n$z_{\\mathrm{Ca^{2+}}}^2 = (+2)^2 = 4$。\n$z_{\\mathrm{CO_{3}^{2-}}}^2 = (-2)^2 = 4$。\n$$ \\Delta \\mathrm{SI} = -0.509 (4 + 4) \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n$$ \\Delta \\mathrm{SI} = -0.509 \\times 8 \\times \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n$$ \\Delta \\mathrm{SI} = -4.072 \\times \\left( \\sqrt{2}-1.15 \\right) $$\n使用 $\\sqrt{2} \\approx 1.41421356$ 的值：\n$$ \\Delta \\mathrm{SI} = -4.072 \\times (1.41421356 - 1.15) $$\n$$ \\Delta \\mathrm{SI} = -4.072 \\times 0.26421356 $$\n$$ \\Delta \\mathrm{SI} \\approx -1.075876 $$\n\n题目要求将结果四舍五入到三位有效数字。\n$$ \\Delta \\mathrm{SI} \\approx -1.08 $$",
            "answer": "$$\\boxed{-1.08}$$"
        },
        {
            "introduction": "在确定了系统的化学状态之后，下一步是量化反应进行的速率。温度是控制大多数地球化学系统中反应速率的关键变量。本练习将应用化学动力学的基石——阿伦尼乌斯方程，来计算温度变化对矿物溶解速率的影响，这是预测地质时间尺度上地球化学过程动态变化的基本技能 。",
            "id": "4096470",
            "problem": "一个计算地球化学模型中的反应输运模块使用与热激活势垒穿越一致的温度依赖性动力学来预测矿物溶解通量。考虑一个水体系中硅酸盐矿物的远非平衡溶解过程，其中内在表面反应速率常数通过一个由表观活化能 $E_{a}$ 表征的热激活过程而依赖于温度。在此区域内，观测到的溶解速率与依赖于温度的速率常数成正比，并且其温度敏感性可以用源于过渡态（TS）理论和分子能量的麦克斯韦-玻尔兹曼分布的经典阿伦尼乌斯形式来表示。\n\n从能够克服能量势垒 $E_{a}$ 的分子碰撞分数控制速率常数的温度依赖性这一前提出发，推导当温度从初始绝对温度 $T_{1}$ 升高到更高的绝对温度 $T_{2}$ 时，溶解速率变化的因子 $F$ 的解析表达式。假设任何指前因子在所考虑的区间内都与温度无关。然后，对于 $E_{a}=60\\,\\text{kJ/mol}$，$T_{1}=15^{\\circ}\\text{C}$ 和 $T_{2}=25^{\\circ}\\text{C}$，计算 $F$ 的值。使用摩尔气体常数 $R=8.314462618\\,\\text{J mol}^{-1}\\text{K}^{-1}$，并在计算前将温度转换为开尔文。\n\n将最终答案表示为一个无单位的因子。将最终答案四舍五入至三位有效数字。",
            "solution": "内在表面反应速率常数 $k$ 的温度依赖性由阿伦尼乌斯方程描述，这是过渡态理论的一个假设：\n$$k = A \\exp\\left(-\\frac{E_a}{RT}\\right)$$\n其中 $A$ 是指前因子（频率因子），$E_a$ 是表观活化能，$R$ 是摩尔气体常数，$T$ 是以开尔文为单位的绝对温度。\n\n问题陈述指出，观测到的溶解速率 $r$ 与该速率常数成正比。因此，我们可以将在初始温度 $T_1$ 和最终温度 $T_2$ 下的速率写为：\n$$r_1 = c \\cdot k_1 = c \\cdot A \\exp\\left(-\\frac{E_a}{RT_1}\\right)$$\n$$r_2 = c \\cdot k_2 = c \\cdot A \\exp\\left(-\\frac{E_a}{RT_2}\\right)$$\n这里，$c$ 是一个比例常数，它依赖于诸如反应表面积和溶液组成等因素，这些因素假定在温度从 $T_1$ 变为 $T_2$ 时保持不变。\n\n溶解速率变化的因子 $F$ 是 $T_2$ 时的速率与 $T_1$ 时的速率之比：\n$$F = \\frac{r_2}{r_1}$$\n代入 $r_1$ 和 $r_2$ 的表达式：\n$$F = \\frac{c \\cdot A \\exp\\left(-\\frac{E_a}{RT_2}\\right)}{c \\cdot A \\exp\\left(-\\frac{E_a}{RT_1}\\right)}$$\n常数 $c$ 和 $A$ 被约去，因为假定 $A$ 与温度无关。剩下：\n$$F = \\frac{\\exp\\left(-\\frac{E_a}{RT_2}\\right)}{\\exp\\left(-\\frac{E_a}{RT_1}\\right)}$$\n使用指数性质 $\\frac{\\exp(x)}{\\exp(y)} = \\exp(x-y)$，我们得到：\n$$F = \\exp\\left(-\\frac{E_a}{RT_2} - \\left(-\\frac{E_a}{RT_1}\\right)\\right) = \\exp\\left(\\frac{E_a}{RT_1} - \\frac{E_a}{RT_2}\\right)$$\n提出公因式 $\\frac{E_a}{R}$ 得到因子 $F$ 的最终解析表达式：\n$$F = \\exp\\left[\\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right]$$\n该表达式也可以写成：\n$$F = \\exp\\left[\\frac{E_a}{R}\\left(\\frac{T_2 - T_1}{T_1 T_2}\\right)\\right]$$\n\n接下来，我们使用所提供的值计算此表达式。首先，我们必须确保所有量都采用一致的国际单位制（SI）单位。\n给定的活化能为 $E_a = 60\\,\\text{kJ/mol}$。我们将其转换为焦耳/摩尔：\n$$E_a = 60\\,\\text{kJ/mol} \\times 1000\\,\\text{J/kJ} = 60000\\,\\text{J/mol}$$\n摩尔气体常数为 $R = 8.314462618\\,\\text{J mol}^{-1}\\text{K}^{-1}$。\n\n必须使用关系式 $T(\\text{K}) = T(^{\\circ}\\text{C}) + 273.15$ 将温度从摄氏度转换为开尔文：\n$$T_1 = 15 + 273.15 = 288.15\\,\\text{K}$$\n$$T_2 = 25 + 273.15 = 298.15\\,\\text{K}$$\n\n现在，我们将这些值代入导出的 $F$ 的表达式中：\n$$F = \\exp\\left[\\frac{60000\\,\\text{J/mol}}{8.314462618\\,\\text{J mol}^{-1}\\text{K}^{-1}}\\left(\\frac{1}{288.15\\,\\text{K}} - \\frac{1}{298.15\\,\\text{K}}\\right)\\right]$$\n首先，我们计算指数内的各项：\n项 $\\frac{E_a}{R}$ 为：\n$$\\frac{E_a}{R} = \\frac{60000}{8.314462618} \\approx 7216.5504\\,\\text{K}$$\n括号中的项为：\n$$\\frac{1}{T_1} - \\frac{1}{T_2} = \\frac{1}{288.15\\,\\text{K}} - \\frac{1}{298.15\\,\\text{K}} = \\frac{298.15 - 288.15}{288.15 \\times 298.15}\\,\\text{K}^{-1} = \\frac{10}{85934.3225}\\,\\text{K}^{-1} \\approx 0.000116368\\,\\text{K}^{-1}$$\n指数的值是这两项的乘积：\n$$\\text{Exponent} \\approx 7216.5504\\,\\text{K} \\times 0.000116368\\,\\text{K}^{-1} \\approx 0.839810$$\n最后，我们计算 $F$：\n$$F = \\exp(0.839810) \\approx 2.31594$$\n问题要求将最终答案四舍五入至三位有效数字。\n$$F \\approx 2.32$$\n因此，温度从 $15\\,^{\\circ}\\text{C}$ 升高 $10\\,^{\\circ}\\text{C}$ 到 $25\\,^{\\circ}\\text{C}$，导致溶解速率增加了约 $2.32$ 倍。",
            "answer": "$$\\boxed{2.32}$$"
        },
        {
            "introduction": "生物地球化学模型的核心是模拟化学物质在空间和时间上的迁移与反应。本练习通过平流方程这一物理输运的最简形式，探讨了数值求解的稳定性问题，即著名的 Courant–Friedrichs–Lewy (CFL) 条件。通过这个动手实践，您将理解为何掌握数值方法与理解地球化学原理本身同等重要，是构建稳定可靠模型的基石 。",
            "id": "4096494",
            "problem": "您正在模拟恒定平流条件下溶解示踪剂浓度场的一维守恒输运，这是计算地球化学中使用的反应输运求解器的一个常见组成部分。考虑从局部质量守恒和平流通量定义中导出的线性平流方程：$\\partial C/\\partial t + u \\, \\partial C/\\partial x = 0$，其中 $C$ 是浓度场，$u$ 是一个恒定速度。您将通过检查 Courant–Friedrichs–Lewy (CFL) 条件来评估一个显式一阶迎风有限差分时间推进格式的稳定性，并通过直接模拟该格式来观察当条件被违反时的后果。\n\n从守恒定律及其通量形式出发，对空间域进行均匀离散，并应用前向欧拉时间步进，结合与 $u$ 符号一致的一阶迎风空间离散和周期性边界条件。这定义了在均匀网格上从 $C^{n}$ 到 $C^{n+1}$ 的显式单步映射。定义 Courant 数 $c = |u| \\Delta t / \\Delta x$，并回想一下，显式迎风平流格式的 CFL 稳定性条件要求 $c \\le 1$。\n\n您的任务是：\n- 在具有周期性边界条件的均匀网格上，实现上述显式迎风格式。使用正弦初始条件 $C(x,0) = \\sin(2\\pi x / L)$，以使傅里叶模态分析在离散模拟中可以直接观察到。这里 $L$ 是域长度。\n- 从您实现的离散更新算子出发，使用 von Neumann 分析，推导离散傅里叶符号，并计算网格上所有可分辨离散波数的最大谱放大因子 $\\rho_{\\max}$。这个 $\\rho_{\\max}$ 必须通过在您模拟中使用的相同网格上，对离散波数 $\\theta_k = 2\\pi k / N$（其中 $k = 0, 1, \\ldots, N-1$）计算放大因子来求得。\n- 对于每个测试用例，计算：\n  1) 一个布尔值，指示 CFL 条件是否满足，即 $c \\le 1$ 是否成立。\n  2) 最大谱放大因子 $\\rho_{\\max}$，以浮点数形式表示。\n  3) 经过 $n_{\\text{steps}}$ 个时间步后，离散 $\\ell^2$ 范数与初始范数的比率 $R = \\|C^{n_{\\text{steps}}}\\|_2 / \\|C^0\\|_2$，以浮点数形式表示。\n\n使用的基本原理：质量守恒导出 $\\partial C/\\partial t + u \\, \\partial C/\\partial x = 0$，显式前向欧拉时间积分，以及与流向一致的一阶迎风差分。不要假设任何预先推导的稳定性公式；相反，应对您的离散格式进行 von Neumann 分析以获得放大因子，然后在可分辨模态上数值计算 $\\rho_{\\max}$。模拟必须使用周期性边界条件，并且除了迎风离散固有的扩散外，不得添加任何人为扩散。\n\n测试套件中使用的物理单位：\n- 速度 $u$ 单位为 $\\text{m}\\,\\text{s}^{-1}$。\n- 空间网格间距 $\\Delta x$ 单位为 $\\text{m}$。\n- 时间步长 $\\Delta t$ 单位为 $\\text{s}$。\n\n对于模拟和分析，使用：\n- 网格点数 $N = 256$（无量纲）。\n- 域长度 $L = N \\, \\Delta x$（单位为 $\\text{m}$）。\n- 时间步数 $n_{\\text{steps}} = 40$（无量纲）。\n- 正弦初始条件 $C(x,0) = \\sin(2\\pi x/L)$（无量纲振幅）。\n\n参数集 $(u, \\Delta x, \\Delta t)$ 的测试套件：\n- A 例 (理想情况，CFL 条件轻松满足): $(0.20, 0.010, 0.030)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- B 例 (边界情况，CFL 条件恰好为 1): $(1.00, 0.010, 0.010)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- C 例 (违规情况，CFL 条件大于 1): $(0.75, 1.00, 2.00)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- D 例 (负速度，CFL 条件满足): $(-0.16, 0.010, 0.050)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n\n对于每个案例，计算 CFL 布尔值、在 $N$ 点网格的离散波数上评估的最大谱放大因子 $\\rho_{\\max}$，以及 $n_{\\text{steps}}$ 时间步后的范数比率 $R$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含四个项目的列表，每个测试用例一个项目，其中每个项目本身是包含三个值的列表：$[\\text{CFL\\_ok}, \\rho_{\\max}, R]$。\n- 布尔值应为原生布尔值。浮点数 $\\rho_{\\max}$ 和 $R$ 应四舍五入到六位小数。\n- 因此，最后一行必须如下所示：\n  $[[\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}]]$\n- 不应打印任何其他文本。",
            "solution": "该问题要求对一维线性平流方程的一阶显式迎风有限差分格式进行分析。该分析既包括使用 von Neumann 方法进行的理论稳定性评估，也包括直接数值模拟以观察该格式的行为。我们将通过首先推导离散更新方程，然后分析其稳定性以找到最大谱放大因子，最后实现数值模拟来计算每个测试用例所需的指标来解决该问题。\n\n守恒平流的控制偏微分方程 (PDE) 如下：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0\n$$\n其中 $C(x,t)$ 是示踪剂在位置 $x$ 和时间 $t$ 的浓度，$u$ 是恒定的平流速度。\n\n为了数值求解该方程，我们将空间域离散化为一个包含 $N$ 个点的均匀网格 $x_j = j \\Delta x$（其中 $j = 0, 1, \\dots, N-1$），并将时间域离散为离散步长 $t^n = n \\Delta t$。该网格上的浓度表示为 $C_j^n \\approx C(x_j, t^n)$。\n\n我们对时间导数应用前向欧拉方法：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} \\approx -\\left.u \\frac{\\partial C}{\\partial x}\\right|_j^n\n$$\n空间导数 $\\partial C / \\partial x$ 使用一阶迎风格式进行近似。有限差分模板的选择取决于速度 $u$ 的符号，以确保从流动的“迎风”方向获取信息。\n\n情况 1: $u > 0$\n流动方向是从左到右。迎风方向指向较小的 $j$。我们使用一阶后向差分：\n$$\n\\left.\\frac{\\partial C}{\\partial x}\\right|_j^n \\approx \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n$$\n将其代入时间离散方程，得到更新规则：\n$$\nC_j^{n+1} = C_j^n - u \\frac{\\Delta t}{\\Delta x} (C_j^n - C_{j-1}^n)\n$$\n定义 Courant 数 $c = |u| \\Delta t / \\Delta x$，由于 $u>0$，该值为正，我们得到：\n$$\nC_j^{n+1} = C_j^n - c(C_j^n - C_{j-1}^n) = (1-c)C_j^n + c C_{j-1}^n\n$$\n\n情况 2: $u  < 0$\n流动方向是从右到左。迎风方向指向较大的 $j$。我们使用一阶前向差分：\n$$\n\\left.\\frac{\\partial C}{\\partial x}\\right|_j^n \\approx \\frac{C_{j+1}^n - C_j^n}{\\Delta x}\n$$\n更新规则变为：\n$$\nC_j^{n+1} = C_j^n - u \\frac{\\Delta t}{\\Delta x} (C_{j+1}^n - C_j^n)\n$$\n在这种情况下，$u$ 是负数。Courant 数 $c = |u| \\Delta t / \\Delta x = -u \\Delta t / \\Delta x$ 是正数。更新规则是：\n$$\nC_j^{n+1} = C_j^n + c(C_{j+1}^n - C_j^n)\n$$\n\n为了进行 von Neumann 稳定性分析，我们考虑形式为 $C_j^n = \\hat{C}^n(k) e^{i k x_j} = \\hat{C}^n e^{i j \\theta}$ 的单个傅里叶模态解，其中 $\\theta = k \\Delta x$ 是无量纲波数。放大因子定义为 $g(\\theta) = \\hat{C}^{n+1} / \\hat{C}^n$。\n\n对于 $u > 0$:\n$$\n\\hat{C}^{n+1} e^{i j \\theta} = (1-c)\\hat{C}^n e^{i j \\theta} + c \\hat{C}^n e^{i (j-1) \\theta}\n$$\n两边同除以 $\\hat{C}^n e^{i j \\theta}$ 得到：\n$$\ng(\\theta) = (1-c) + c e^{-i \\theta} = 1 - c(1 - e^{-i\\theta})\n$$\n\n对于 $u  < 0$:\n$$\n\\hat{C}^{n+1} e^{i j \\theta} = C_j^n + c(C_{j+1}^n - C_j^n) \\implies \\hat{C}^{n+1}e^{ij\\theta} = \\hat{C}^n e^{ij\\theta} + c(\\hat{C}^n e^{i(j+1)\\theta} - \\hat{C}^n e^{ij\\theta})\n$$\n两边同除以 $\\hat{C}^n e^{i j \\theta}$:\n$$\ng(\\theta) = 1 + c(e^{i\\theta} - 1)\n$$\n格式的稳定性要求放大因子的模 $\\rho(\\theta) = |g(\\theta)|$ 对所有 $\\theta$ 都小于或等于 1。我们来计算 $|g(\\theta)|^2$：\n在两种情况下，都有 $|g(\\theta)|^2 = 1 - 2c(1-c)(1-\\cos\\theta)$，其中 $c = |u|\\Delta t/\\Delta x$。为了保证稳定性，我们需要 $|g(\\theta)|^2 \\le 1$，这意味着 $2c(1-c)(1-\\cos\\theta) \\ge 0$。由于 $1-\\cos\\theta \\ge 0$，这简化为著名的 Courant–Friedrichs–Lewy (CFL) 条件：$c(1-c) \\ge 0$。根据定义 $c \\ge 0$，因此条件为 $1-c \\ge 0$，即 $c \\le 1$。\n\n问题要求计算网格上所有可分辨离散波数的最大谱放大因子 $\\rho_{\\max}$。离散波数为 $\\theta_k = 2\\pi k / N$，其中 $k = 0, 1, \\dots, N-1$。我们对每个 $k$ 计算 $\\rho(\\theta_k) = |g(\\theta_k)|$ 并找到最大值。$|g(\\theta)|^2$ 的最大值出现在 $1-\\cos\\theta$ 最大化时，即在 $\\theta=\\pi$ 处，此时 $\\cos\\theta = -1$。\n$$\n\\rho_{\\max}^2 = |g(\\pi)|^2 = 1 - 4c(1-c) = (1-2c)^2\n$$\n因此，$\\rho_{\\max} = |1-2c|$。我们将通过对所有离散的 $\\theta_k$ 计算 $|g(\\theta_k)|$ 并找到最大值来数值计算它。\n\n模拟将按以下步骤进行：\n1.  对于每个测试用例 $(u, \\Delta x, \\Delta t)$，计算 Courant 数 $c = |u|\\Delta t / \\Delta x$ 并检查 CFL 条件 $c \\le 1$。\n2.  建立空间网格 $x_j = j \\Delta x$，其中 $j=0, \\ldots, N-1$ 且 $N=256$。域长度为 $L = N \\Delta x$。\n3.  使用给定的正弦剖面初始化浓度场 $C^0$：$C_j^0 = \\sin(2\\pi x_j / L) = \\sin(2\\pi j / N)$。\n4.  计算初始离散 $\\ell^2$ 范数，$\\|C^0\\|_2 = \\left(\\sum_{j=0}^{N-1} (C_j^0)^2\\right)^{1/2}$。\n5.  迭代 $n_{\\text{steps}} = 40$ 个时间步。在每一步中，使用适当的迎风格式从 $C^n$ 计算 $C^{n+1}$，通过使用浓度数组的循环移位来处理周期性边界条件。\n    - 若 $u>0$：$C^{n+1}_j = C^n_j - c(C^n_j - C^n_{j-1})$。\n    - 若 $u<0$：$C^{n+1}_j = C^n_j + c(C^n_{j+1} - C^n_j)$。\n6.  经过 $n_{\\text{steps}}$ 步后，计算最终范数 $\\|C^{n_{\\text{steps}}}\\|_2$。\n7.  计算比率 $R = \\|C^{n_{\\text{steps}}}\\|_2 / \\|C^0\\|_2$。\n8.  每个用例的最终结果将是一个三元组：CFL 条件的布尔值、最大谱放大因子 $\\rho_{\\max}$ 和范数比率 $R$。",
            "answer": "[[True, 0.99925, 0.970529], [True, 1.0, 1.0], [False, 2.0, 3192323671.187835], [True, 0.99951, 0.980482]]"
        }
    ]
}