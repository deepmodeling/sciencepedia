{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a direct and tangible application of the Fluctuation-Dissipation Theorem. By working with the model of a nanomechanical resonator , you will calculate the power spectral density of its thermal position fluctuations. This practice solidifies the fundamental connection between a system's dissipative characteristics, represented by its mechanical susceptibility, and the nature of its spontaneous thermal noise.",
            "id": "125694",
            "problem": "A nanomechanical resonator is coupled to a thermal bath at temperature $T$. The dynamics of the resonator are well-described by a generalized Langevin equation, which in the frequency domain, leads to a frequency-dependent mechanical susceptibility $\\chi(\\omega)$. The position response $x(\\omega)$ to an external driving force $F(\\omega)$ is given by $x(\\omega) = \\chi(\\omega)F(\\omega)$.\n\nThe susceptibility of the resonator is given by:\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega\\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\nwhere $k$ is the spring constant, $m$ is the effective mass, and $\\tilde{\\gamma}(\\omega)$ is the complex, frequency-dependent damping coefficient. The damping is modeled by the Debye formula:\n$$\n\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d}\n$$\nwith $\\gamma_0$ being the zero-frequency damping constant and $\\tau_d$ a characteristic memory time of the bath.\n\nAccording to the fluctuation-dissipation theorem, the symmetrized power spectral density (PSD) of the thermomechanical position fluctuations, $S_x(\\omega)$, is related to the imaginary part of the mechanical susceptibility, $\\text{Im}[\\chi(\\omega)]$, by the following relation:\n$$\nS_x(\\omega) = 2\\hbar \\, \\text{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\nwhere $\\hbar$ is the reduced Planck constant and $k_B$ is the Boltzmann constant.\n\nIn the high-temperature (classical) limit, where $k_B T$ is much larger than the energy of the relevant vibrational quanta $\\hbar\\omega$, calculate the PSD of the thermomechanical position fluctuations at zero frequency, $S_x(0) = \\lim_{\\omega\\to 0} S_x(\\omega)$.\n\nExpress your final answer in terms of $k$, $\\gamma_0$, $T$, and the fundamental constant $k_B$.",
            "solution": "The symmetrized power spectral density (PSD) of the thermomechanical position fluctuations is given by:\n\n$$\nS_x(\\omega) = 2\\hbar  \\operatorname{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\n\nwhere $\\chi(\\omega)$ is the mechanical susceptibility. We are interested in the zero-frequency limit $S_x(0) = \\lim_{\\omega \\to 0} S_x(\\omega)$. In the high-temperature limit, $k_B T \\gg \\hbar\\omega$, the coth function can be approximated as:\n\n$$\n\\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right) \\approx \\frac{2k_B T}{\\hbar\\omega}\n$$\n\nSubstituting this into the expression for $S_x(\\omega)$ gives the classical PSD:\n$$\nS_x(\\omega) \\approx 2\\hbar \\cdot \\operatorname{Im}[\\chi(\\omega)] \\cdot \\frac{2k_B T}{\\hbar\\omega} = \\frac{4k_B T}{\\omega}\\operatorname{Im}[\\chi(\\omega)]\n$$\n\nTo find $S_x(0)$, we need to evaluate the limit of $\\frac{\\operatorname{Im}[\\chi(\\omega)]}{\\omega}$ as $\\omega \\to 0$. The susceptibility is given by:\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega \\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\n\nAs $\\omega \\to 0$, we have:\n- $m\\omega^2 \\to 0$\n- $\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d} \\to \\gamma_0$\n\nThus, for small $\\omega$, the denominator of $\\chi(\\omega)$ approaches $k - i\\omega\\gamma_0$. The susceptibility can be approximated as:\n$$\n\\chi(\\omega) \\approx \\frac{1}{k - i\\omega\\gamma_0} = \\frac{k + i\\omega\\gamma_0}{k^2 + (\\omega\\gamma_0)^2}\n$$\n\nThe imaginary part is:\n$$\n\\operatorname{Im}[\\chi(\\omega)] \\approx \\frac{\\omega\\gamma_0}{k^2 + (\\omega\\gamma_0)^2}\n$$\n\nFor $\\omega \\to 0$, the $(\\omega\\gamma_0)^2$ term in the denominator is negligible compared to $k^2$. Therefore, the leading-order behavior is:\n$$\n\\operatorname{Im}[\\chi(\\omega)] \\approx \\frac{\\omega\\gamma_0}{k^2}\n$$\n\nNow we can compute the limit required for $S_x(0)$:\n$$\n\\lim_{\\omega \\to 0} \\frac{\\operatorname{Im}[\\chi(\\omega)]}{\\omega} = \\lim_{\\omega \\to 0} \\frac{\\omega\\gamma_0/k^2}{\\omega} = \\frac{\\gamma_0}{k^2}\n$$\n\nFinally, we calculate $S_x(0)$:\n$$\nS_x(0) = 4k_B T \\left( \\lim_{\\omega \\to 0} \\frac{\\operatorname{Im}[\\chi(\\omega)]}{\\omega} \\right) = \\frac{4k_B T \\gamma_0}{k^2}\n$$\n\nThe result is independent of $m$ and $\\tau_d$ as they do not affect the zero-frequency, low-dissipation limit.",
            "answer": "$$\n\\boxed{\\dfrac{4 k_{B} T \\gamma_{0}}{k^{2}}}\n$$"
        },
        {
            "introduction": "Moving from analysis to design, this problem challenges you to develop a discrete-time numerical integrator for a Brownian particle. The core task is to determine the correct statistical properties of the random force used in the simulation . This hands-on derivation shows how the FDT is not merely a descriptive statement about equilibrium systems but a crucial prescriptive principle for constructing computational models that are thermodynamically consistent.",
            "id": "4107063",
            "problem": "Consider a one-dimensional massive tracer of mass $m$ immersed in a complex fluid at thermodynamic temperature $T$. The tracer’s momentum $p$ evolves under linear Stokes drag with coefficient $\\gamma$ (units of inverse time), along with thermal fluctuations from the fluid. You are tasked with designing a discrete-time integrator for the momentum over a time step $\\Delta t$ that respects the equilibrium Maxwell–Boltzmann distribution at temperature $T$.\n\nAssume the time-discrete update for $p$ over one step is of the autoregressive form\n$$\np_{n+1} = a\\, p_n + \\eta_n,\n$$\nwhere $a$ is a deterministic coefficient determined only by the linear drag, and $\\eta_n$ is a zero-mean Gaussian random variable that models the net thermal impulse from the fluid over the interval $\\Delta t$. Assume that $\\eta_n$ are independent and identically distributed (i.i.d.) across steps and independent of $p_n$.\n\nStarting only from Newton’s second law, linear drag, and the requirement of equilibrium with the Maxwell–Boltzmann distribution, proceed as follows:\n- Determine $a$ from the exact solution of the linear deterministic dynamics for $p$ under drag alone over a time step $\\Delta t$.\n- Impose that the stationary distribution of $p_n$ under the above Markov update is Maxwell–Boltzmann at temperature $T$, which implies $\\langle p_n^2 \\rangle = m k_B T$, where $k_B$ is the Boltzmann constant. From this, derive the required variance of the thermal impulse, $\\mathrm{Var}(\\eta_n)$, as a closed-form expression in terms of $m$, $k_B$, $T$, $\\gamma$, and $\\Delta t$.\n- Finally, relate your discrete-time result to the continuum fluctuation-dissipation amplitude by obtaining the small time step asymptotic, and explain how it reduces to an expression proportional to $2 \\gamma k_B T \\Delta t$.\n\nProvide your final answer as a single analytic expression for $\\mathrm{Var}(\\eta_n)$ in terms of $m$, $k_B$, $T$, $\\gamma$, and $\\Delta t$. No numerical evaluation is required, and no rounding is needed. Do not include units in the final answer.",
            "solution": "The problem asks for the derivation of the variance of the thermal impulse, $\\mathrm{Var}(\\eta_n)$, for a discrete-time integrator of a particle's momentum. The integrator must preserve the equilibrium Maxwell-Boltzmann distribution. We will follow the specified steps.\n\nFirst, we determine the deterministic coefficient $a$ in the update rule $p_{n+1} = a\\, p_n + \\eta_n$. This coefficient is derived from the dynamics under linear drag alone. The problem states that the evolution of momentum under drag is described by an equation with a linear drag coefficient $\\gamma$ (units of inverse time). Newton's second law for the momentum $p$ under this drag is:\n$$\n\\frac{dp(t)}{dt} = -\\gamma p(t)\n$$\nThis is a first-order linear ordinary differential equation. We solve it over a time interval of duration $\\Delta t$, from an initial time $t_n$ where the momentum is $p(t_n) = p_n$, to a final time $t_{n+1} = t_n + \\Delta t$. The solution is found by separation of variables:\n$$\n\\int_{p_n}^{p(t_{n+1})} \\frac{dp}{p} = \\int_{t_n}^{t_{n+1}} -\\gamma dt\n$$\n$$\n\\ln\\left(\\frac{p(t_{n+1})}{p_n}\\right) = -\\gamma (t_{n+1} - t_n) = -\\gamma \\Delta t\n$$\nExponentiating both sides yields the exact solution for the deterministic evolution of momentum:\n$$\np(t_{n+1}) = p_n \\exp(-\\gamma \\Delta t)\n$$\nBy comparing this result to the deterministic part of the discrete update rule, $p_{n+1} = a p_n$, we identify the coefficient $a$:\n$$\na = \\exp(-\\gamma \\Delta t)\n$$\n\nNext, we impose the condition that the stationary distribution of the momentum under the full stochastic update rule is the Maxwell-Boltzmann distribution. The update rule is:\n$$\np_{n+1} = a p_n + \\eta_n\n$$\nWe compute the second moment of the momentum at step $n+1$:\n$$\n\\langle p_{n+1}^2 \\rangle = \\langle (a p_n + \\eta_n)^2 \\rangle = \\langle a^2 p_n^2 + 2a p_n \\eta_n + \\eta_n^2 \\rangle\n$$\nUsing the linearity of the expectation operator, we have:\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + 2a \\langle p_n \\eta_n \\rangle + \\langle \\eta_n^2 \\rangle\n$$\nThe problem states that the thermal impulse $\\eta_n$ is independent of the momentum $p_n$. Therefore, the covariance term is $\\langle p_n \\eta_n \\rangle = \\langle p_n \\rangle \\langle \\eta_n \\rangle$. The problem also specifies that $\\eta_n$ is a zero-mean random variable, so $\\langle \\eta_n \\rangle = 0$. Consequently, $\\langle p_n \\eta_n \\rangle = 0$. The equation simplifies to:\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + \\langle \\eta_n^2 \\rangle\n$$\nAt thermodynamic equilibrium, the system is in a stationary state, which means the statistical properties of the momentum are constant over time. Thus, the mean squared momentum is time-invariant: $\\langle p_{n+1}^2 \\rangle = \\langle p_n^2 \\rangle \\equiv \\langle p^2 \\rangle_{eq}$. Substituting this into the equation gives:\n$$\n\\langle p^2 \\rangle_{eq} = a^2 \\langle p^2 \\rangle_{eq} + \\langle \\eta_n^2 \\rangle\n$$\nWe can now solve for $\\langle \\eta_n^2 \\rangle$:\n$$\n\\langle \\eta_n^2 \\rangle = (1 - a^2) \\langle p^2 \\rangle_{eq}\n$$\nThe variance of $\\eta_n$ is defined as $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle - (\\langle \\eta_n \\rangle)^2$. Since $\\langle \\eta_n \\rangle = 0$, the variance is simply $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle$.\nThe problem requires that the stationary distribution is Maxwell-Boltzmann, which for a one-dimensional particle of mass $m$ at temperature $T$ implies that the mean squared momentum is $\\langle p^2 \\rangle_{eq} = m k_B T$, a result of the equipartition theorem. Substituting this and the expression for $a$ into our equation for the variance, we obtain:\n$$\n\\mathrm{Var}(\\eta_n) = (1 - (\\exp(-\\gamma \\Delta t))^2) (m k_B T) = m k_B T (1 - \\exp(-2 \\gamma \\Delta t))\n$$\nThis is the required closed-form expression for the variance of the thermal impulse.\n\nFinally, we analyze the small time step limit ($\\Delta t \\to 0$) to relate this result to the continuous-time fluctuation-dissipation theorem. We use the Taylor series expansion of the exponential function for small arguments, $\\exp(x) \\approx 1 + x$ for $x \\ll 1$. Let $x = -2 \\gamma \\Delta t$.\n$$\n\\exp(-2 \\gamma \\Delta t) \\approx 1 - 2 \\gamma \\Delta t\n$$\nSubstituting this into our expression for the variance:\n$$\n\\mathrm{Var}(\\eta_n) \\approx m k_B T (1 - (1 - 2 \\gamma \\Delta t)) = m k_B T (2 \\gamma \\Delta t) = 2 m \\gamma k_B T \\Delta t\n$$\nIn the continuous formulation of the Langevin equation, $\\frac{dp}{dt} = -\\gamma p + F_{fluct}(t)$, the random force $F_{fluct}(t)$ is a white noise term whose strength is determined by the fluctuation-dissipation theorem: $\\langle F_{fluct}(t) F_{fluct}(t') \\rangle = 2 \\zeta k_B T \\delta(t-t')$, where $\\zeta$ is the friction coefficient. From the equation of motion, we identify $\\gamma = \\zeta/m$. The discrete thermal impulse $\\eta_n$ corresponds to the integral of the random force over the time step, $\\eta_n = \\int_{t_n}^{t_{n+1}} F_{fluct}(t') dt'$. Its variance is $\\mathrm{Var}(\\eta_n) = \\int_{t_n}^{t_{n+1}} \\int_{t_n}^{t_{n+1}} \\langle F_{fluct}(t') F_{fluct}(t'') \\rangle dt' dt'' = 2 \\zeta k_B T \\Delta t = 2 (m\\gamma) k_B T \\Delta t$. Our asymptotic result matches this continuum limit, confirming the consistency of our derived variance.",
            "answer": "$$\n\\boxed{m k_B T (1 - \\exp(-2 \\gamma \\Delta t))}\n$$"
        },
        {
            "introduction": "This final practice simulates the powerful technique of passive microrheology, where material properties are inferred by observing thermal fluctuations. You will take a simulated power spectrum of a probe's motion and work backwards: first, using the FDT to find the material's dissipative response, and then invoking the Kramers-Kronig relations to reconstruct the full dynamic response function . This exercise demonstrates how the FDT, combined with causality, allows us to turn noise into a rich source of information about a complex fluid's mechanics.",
            "id": "4107081",
            "problem": "You are given the one-dimensional displacement power spectral density $S_{xx}(\\omega)$ of a micron-scale probe immersed in a linear viscoelastic fluid at thermal equilibrium, measured over a uniformly spaced angular frequency grid $\\omega \\in [\\omega_{\\min},\\omega_{\\max}]$. The probe is held in a linear harmonic trap with stiffness $k$ and experiences hydrodynamic drag characterized by a complex frequency-dependent friction $\\zeta^{*}(\\omega)$. The probe position $x(t)$ responds linearly to an externally applied force $f(t)$ with a causal response function (susceptibility) $\\chi_{xx}(t)$, whose Fourier transform $\\chi_{xx}(\\omega)$ is analytic in the upper half-plane, real-time causal, and obeys the standard thermodynamic equilibrium properties. \n\nStarting from the principles of linear response, thermal equilibrium, causality, and analyticity, use the spectral Fluctuation-Dissipation Theorem (FDT) and the Kramers-Kronig relations to:\n\n1. Compute the dissipative component $\\operatorname{Im}\\chi_{xx}(\\omega)$ directly from the measured $S_{xx}(\\omega)$ and the known temperature $T$ on the provided grid. Treat all angular frequencies in radians per second.\n2. Reconstruct the reactive component $\\operatorname{Re}\\chi_{xx}(\\omega)$ from $\\operatorname{Im}\\chi_{xx}(\\omega)$ using the appropriate Kramers-Kronig integral implied by causality.\n3. Validate the reconstruction by comparing $\\operatorname{Re}\\chi_{xx}(\\omega)$ against a known ground-truth model of $\\chi_{xx}(\\omega)$ for each test case. For each test case, report a single scalar metric equal to the relative root-mean-square error over the positive-frequency grid:\n$$\n\\varepsilon = \\frac{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_i)-\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}.\n$$\nAll inputs and outputs must adhere to the following units:\n- Angular frequency $\\omega$ in radians per second.\n- Temperature $T$ in Kelvin.\n- Boltzmann constant $k_{\\mathrm{B}}$ in Joules per Kelvin.\n- Trap stiffness $k$ in Newtons per meter.\n- Fluid viscosity $\\eta$ in Pascal seconds.\n- Fluid shear modulus $G_0$ in Pascals.\n- Probe radius $a$ in meters.\n- Displacement power spectral density $S_{xx}$ in square meters times seconds.\n\nAssume the probe’s mechanical susceptibility to force has the generic trap form consistent with linear Stokesian hydrodynamics in a viscoelastic medium,\n$$\n\\chi_{xx}(\\omega)=\\frac{1}{k - i\\,\\omega\\,\\zeta^{*}(\\omega)},\n$$\nwhere the complex friction $\\zeta^{*}(\\omega)$ is related to the fluid’s complex viscosity $\\eta^{*}(\\omega)$ by $\\zeta^{*}(\\omega)=6\\pi a\\,\\eta^{*}(\\omega)$, and the complex viscosity is related to the complex shear modulus $G^{*}(\\omega)$ through $\\eta^{*}(\\omega)=G^{*}(\\omega)/(i\\omega)$.\n\nYour program must implement the following:\n- Use the spectral Fluctuation-Dissipation Theorem (FDT) to extract $\\operatorname{Im}\\chi_{xx}(\\omega)$ from $S_{xx}(\\omega)$.\n- Use a numerically stable Kramers-Kronig principal-value approximation on a uniform grid to reconstruct $\\operatorname{Re}\\chi_{xx}(\\omega)$ from $\\operatorname{Im}\\chi_{xx}(\\omega)$.\n\nTest suite:\nFor all cases, use a uniformly spaced angular frequency grid with $N=513$ points on $[0,\\omega_{\\max}]$ with $\\omega_{\\max}=2500$ radians per second (include $\\omega=0$). Use Boltzmann constant $k_{\\mathrm{B}}=1.380649\\times 10^{-23}$ Joules per Kelvin. For each case, generate the ground-truth $\\chi_{xx}(\\omega)$ from the specified fluid model, then synthesize $S_{xx}(\\omega)$ from the ground truth according to the spectral FDT, and proceed with the reconstruction and error computation. The three cases are:\n\n- Case 1 (happy path, Newtonian fluid):\n  - Probe radius $a=1.0\\times 10^{-6}$ meters.\n  - Trap stiffness $k=1.0\\times 10^{-6}$ Newtons per meter.\n  - Dynamic viscosity $\\eta=1.0\\times 10^{-3}$ Pascal seconds.\n  - Temperature $T=298$ Kelvin.\n\n- Case 2 (viscoelastic Maxwell fluid):\n  - Probe radius $a=0.5\\times 10^{-6}$ meters.\n  - Trap stiffness $k=8.0\\times 10^{-7}$ Newtons per meter.\n  - Maxwell shear modulus $G_0=5.0$ Pascals.\n  - Maxwell relaxation time $\\tau=5.0\\times 10^{-2}$ seconds.\n  - Temperature $T=310$ Kelvin.\n  - For the Maxwell model, use $G^{*}(\\omega)=G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$.\n\n- Case 3 (edge case with very soft trap and slow relaxation):\n  - Probe radius $a=1.5\\times 10^{-6}$ meters.\n  - Trap stiffness $k=1.0\\times 10^{-8}$ Newtons per meter.\n  - Maxwell shear modulus $G_0=20.0$ Pascals.\n  - Maxwell relaxation time $\\tau=1.0$ second.\n  - Temperature $T=300$ Kelvin.\n  - Use the same Maxwell $G^{*}(\\omega)$ form as in Case 2.\n\nNumerical requirements and handling:\n- Treat the $\\omega=0$ point carefully to avoid division by zero when applying spectral FDT; you should define $\\operatorname{Im}\\chi_{xx}(0)=0$ and exclude the $\\omega=0$ point from any division by $\\omega$.\n- Use a principal-value discretization consistent with causality for the Kramers-Kronig reconstruction on the uniform grid over positive $\\omega$.\n- Ensure numerical stability by excluding the singular term in the principal-value sum when the denominator vanishes.\n\nFinal output:\nYour program should produce a single line of output containing the three relative root-mean-square errors for Cases 1, 2, and 3, respectively, as a comma-separated list enclosed in square brackets, with each number rounded to six decimal places, for example, \"[0.012345,0.067890,0.000111]\".",
            "solution": "The problem requires the reconstruction of the full complex susceptibility $\\chi_{xx}(\\omega)$ of a trapped probe in a fluid from its thermal position fluctuations, quantified by the power spectral density $S_{xx}(\\omega)$. This task hinges on two fundamental principles of statistical physics: the Fluctuation-Dissipation Theorem (FDT) and the causality principle, which manifests through the Kramers-Kronig (KK) relations. The solution involves three main stages: (1) calculating the ground-truth model and synthesizing the \"measured\" fluctuation spectrum, (2) applying the FDT and KK relations to reconstruct the real part of the susceptibility from the synthetic spectrum, and (3) quantifying the accuracy of the reconstruction.\n\n### Step 1: Fluctuation-Dissipation Theorem and Susceptibility\n\nThe Fluctuation-Dissipation Theorem establishes a direct relationship between the thermal fluctuations of a system at equilibrium and its dissipative response to an external perturbation. For a one-dimensional system like the probe's position $x$, the theorem relates the power spectral density of position fluctuations, $S_{xx}(\\omega)$, to the imaginary (dissipative) part of the mechanical susceptibility, $\\operatorname{Im}\\chi_{xx}(\\omega)$. The spectral form of the theorem for a classical system at temperature $T$ is:\n$$\nS_{xx}(\\omega) = \\frac{2 k_{\\mathrm{B}} T}{\\omega} \\operatorname{Im}\\chi_{xx}(\\omega)\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\omega$ is the angular frequency. This equation forms the basis for the first part of the task. Given $S_{xx}(\\omega)$ and $T$, we can compute the dissipative component of the susceptibility:\n$$\n\\operatorname{Im}\\chi_{xx}(\\omega) = \\frac{\\omega S_{xx}(\\omega)}{2 k_{\\mathrm{B}} T}\n$$\nAt $\\omega = 0$, a static force produces no dissipation, so $\\operatorname{Im}\\chi_{xx}(0) = 0$. This is consistent with the formula, as the $\\omega$ term in the numerator ensures the result is zero at zero frequency. For $\\omega > 0$, this provides a direct algebraic way to find $\\operatorname{Im}\\chi_{xx}(\\omega)$ from the fluctuation spectrum.\n\n### Step 2: Causality and the Kramers-Kronig Relations\n\nThe principle of causality dictates that a system's response cannot precede the force that causes it. This physical constraint imposes a mathematical structure on the complex susceptibility $\\chi_{xx}(\\omega)$. Specifically, $\\chi_{xx}(\\omega)$ must be an analytic function in the upper half of the complex frequency plane. A consequence of this analyticity is that the real and imaginary parts of $\\chi_{xx}(\\omega)$ are not independent but are related to each other through a pair of integral transforms known as the Kramers-Kronig relations.\n\nTo reconstruct the real (reactive) part of the susceptibility, $\\operatorname{Re}\\chi_{xx}(\\omega)$, from its imaginary part, we use the following KK relation:\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value of the integral. Since the physical response function $x(t)$ is real-valued, its Fourier transform $\\chi_{xx}(\\omega)$ has the symmetry property $\\chi_{xx}(-\\omega) = \\chi_{xx}^*(\\omega)$, which means $\\operatorname{Im}\\chi_{xx}(\\omega)$ is an odd function of $\\omega$. Using this property, the integral can be simplified to run only over positive frequencies:\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega'^2 - \\omega^2} d\\omega'\n$$\nThis is the integral that must be implemented numerically.\n\n### Step 3: Numerical Implementation\n\nThe problem provides data on a finite, uniform grid $\\omega_i \\in [0, \\omega_{\\max}]$ with spacing $\\Delta\\omega$. The KK integral is approximated by a sum. The principal value is handled by omitting the singular term where the denominator is zero.\n$$\n\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_k) \\approx \\frac{2 \\Delta\\omega}{\\pi} \\sum_{j, j \\neq k} \\frac{\\omega_j \\operatorname{Im}\\chi_{xx}(\\omega_j)}{\\omega_j^2 - \\omega_k^2}\n$$\nwhere $\\omega_k$ is the frequency at which we reconstruct the real part and the sum runs over the grid points $\\omega_j$. The integral truncation at $\\omega_{\\max}$ is an inherent approximation in this procedure.\n\n### Step 4: Ground-Truth Models and Data Synthesis\n\nTo validate the reconstruction, we first need a ground truth. The problem provides the physical model for the susceptibility:\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - i\\omega\\zeta^*(\\omega)}\n$$\nThe complex friction $\\zeta^*(\\omega)$ is modeled via the fluid's complex shear modulus $G^*(\\omega)$:\n$$\n\\zeta^*(\\omega) = 6\\pi a \\eta^*(\\omega) \\quad \\text{and} \\quad \\eta^*(\\omega) = \\frac{G^*(\\omega)}{i\\omega}\n$$\nSubstituting these yields a direct relation between $\\chi_{xx}(\\omega)$ and $G^*(\\omega)$:\n$$\n\\chi_{xx}^{\\text{true}}(\\omega) = \\frac{1}{k - 6\\pi a G^*(\\omega)}\n$$\nThe specific models for $G^*(\\omega)$ are:\n1.  **Newtonian Fluid**: $G^*(\\omega) = i\\omega\\eta$. The viscosity $\\eta$ is constant.\n2.  **Maxwell Fluid**: $G^*(\\omega) = G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$. This model has a frequency-dependent viscosity, exhibiting both elastic ($G_0$) and viscous ($\\tau$) character.\n\nFor each test case, we compute the ground-truth $\\chi_{xx}^{\\text{true}}(\\omega)$ over the specified frequency grid. From this, we extract $\\operatorname{Im}\\chi_{xx}^{\\text{true}}(\\omega)$ and synthesize the input power spectrum $S_{xx}(\\omega)$ using the FDT. Care must be taken at $\\omega=0$, where the FDT expression is an indeterminate $0/0$ form. The correct value is found by taking the limit:\n$$\nS_{xx}(0) = 2 k_{\\mathrm{B}} T \\lim_{\\omega \\to 0} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega)}{\\omega}\n$$\nFor a Newtonian fluid with friction $\\zeta=6\\pi a\\eta$, this limit gives $S_{xx}(0) = 2k_BT\\zeta/k^2$. For the Maxwell model, the zero-shear friction is $\\zeta_0 = 6\\pi a G_0 \\tau$, yielding $S_{xx}(0) = 2k_BT\\zeta_0/k^2$.\n\n### Step 5: Error Calculation\n\nAfter reconstructing $\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega)$ using the KK integral, its accuracy is assessed against the ground-truth $\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega)$ using the provided relative root-mean-square error metric $\\varepsilon$, computed over the positive-frequency points of the grid.\n\nThe complete procedure—synthesis, reconstruction, and validation—is implemented for each of the three test cases specified. The resulting reconstruction error $\\varepsilon$ for each case is then reported.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing susceptibility from fluctuation spectra\n    for three distinct physical cases.\n    \"\"\"\n\n    def get_error(case_params: dict, omega: np.ndarray, N: int, kB: float) - float:\n        \"\"\"\n        Calculates the reconstruction error for a single test case.\n\n        This function performs the following steps:\n        1. Generates the ground-truth complex susceptibility from the given physical model.\n        2. Synthesizes the \"measured\" power spectral density (PSD) using the Fluctuation-Dissipation Theorem (FDT).\n        3. Extracts the imaginary part of susceptibility from the synthetic PSD.\n        4. Reconstructs the real part of susceptibility using a numerical Kramers-Kronig transform.\n        5. Computes the relative root-mean-square error between the reconstructed and true real parts.\n        \"\"\"\n        # Unpack parameters\n        model_type = case_params['type']\n        T = case_params['T']\n        k = case_params['k']\n        a = case_params['a']\n        \n        # --- 1. Ground Truth Generation ---\n        omega_c = omega.astype(np.complex128)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            # G*(omega) = i*omega*eta\n            G_star = 1j * omega_c * eta\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            # G*(omega) = G0 * (i*omega*tau) / (1 + i*omega*tau)\n            G_star = G0 * (1j * omega_c * tau) / (1 + 1j * omega_c * tau)\n\n        # chi_xx = 1 / (k - 6*pi*a*G*)\n        chi_xx_true = 1.0 / (k - 6.0 * np.pi * a * G_star)\n        Re_chi_true = chi_xx_true.real\n        Im_chi_true = chi_xx_true.imag\n\n        # --- 2. Synthesize Power Spectral Density S_xx(omega) ---\n        S_xx = np.zeros_like(omega)\n        \n        # For omega  0, use FDT directly\n        # S_xx = (2 * kB * T / omega) * Im[chi_xx]\n        # Use errstate to avoid warning for omega[0]=0, which is handled separately\n        with np.errstate(divide='ignore', invalid='ignore'):\n            S_xx[1:] = (2 * kB * T / omega[1:]) * Im_chi_true[1:]\n        \n        # For omega = 0, calculate the limit S_xx(0) = 2*kB*T * lim(Im[chi]/omega)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            zeta_0 = 6 * np.pi * a * eta\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            zeta_0 = 6 * np.pi * a * G0 * tau\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n\n        # --- 3. Extract Im[chi] from S_xx ---\n        # Im[chi] = (omega * S_xx) / (2 * kB * T)\n        Im_chi_from_S = (omega * S_xx) / (2 * kB * T)\n        # Im_chi_from_S[0] is guaranteed to be 0 since omega[0] is 0.\n\n        # --- 4. Reconstruct Re[chi] using Kramers-Kronig Integral ---\n        Re_chi_recon = np.zeros_like(omega)\n        delta_omega = omega[1] - omega[0]\n        \n        # The term to be summed in the KK integral\n        kk_term = omega * Im_chi_from_S\n\n        # Discretized principal value integral:\n        # Re[chi](w_k) = (2*dw/pi) * SUM_{j!=k} [w_j * Im[chi](w_j)] / [w_j^2 - w_k^2]\n        for k in range(N):\n            omega_k_sq = omega[k]**2\n            \n            # Create a copy to avoid modifying the original array\n            integrand_denom = omega**2 - omega_k_sq\n            \n            # Find indices where denominator is non-zero to perform division safely\n            valid_indices = (integrand_denom != 0)\n            \n            # Prepare integrand array, initialized to zero\n            integrand = np.zeros_like(omega)\n            \n            # Calculate integrand only for non-singular points\n            integrand[valid_indices] = kk_term[valid_indices] / integrand_denom[valid_indices]\n\n            # The sum automatically omits the k-th term as it's set to 0\n            integral_sum = np.sum(integrand)\n            \n            Re_chi_recon[k] = (2.0 * delta_omega / np.pi) * integral_sum\n\n        # --- 5. Calculate Error Metric ---\n        # Sums are over the positive-frequency grid (i.e., excluding omega=0)\n        recon_pos = Re_chi_recon[1:]\n        true_pos = Re_chi_true[1:]\n        \n        numerator_sq_sum = np.sum((recon_pos - true_pos)**2)\n        denominator_sq_sum = np.sum(true_pos**2)\n\n        if denominator_sq_sum == 0:\n            return 0.0 if numerator_sq_sum == 0 else np.inf\n            \n        error = np.sqrt(numerator_sq_sum / denominator_sq_sum)\n        \n        return error\n\n    # General parameters\n    kB = 1.380649e-23  # Joules per Kelvin\n    N = 513\n    omega_max = 2500.0  # radians per second\n    omega = np.linspace(0, omega_max, N)\n\n    # Test cases from problem statement\n    test_cases = [\n        {\n            'type': 'newtonian',\n            'a': 1.0e-6, 'k': 1.0e-6, 'eta': 1.0e-3, 'T': 298.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 0.5e-6, 'k': 8.0e-7, 'G0': 5.0, 'tau': 5.0e-2, 'T': 310.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 1.5e-6, 'k': 1.0e-8, 'G0': 20.0, 'tau': 1.0, 'T': 300.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        error = get_error(params, omega, N, kB)\n        results.append(error)\n\n    # Format the output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}