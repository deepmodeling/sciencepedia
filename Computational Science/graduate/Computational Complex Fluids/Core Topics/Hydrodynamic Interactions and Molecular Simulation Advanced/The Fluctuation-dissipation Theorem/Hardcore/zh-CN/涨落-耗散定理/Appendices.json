{
    "hands_on_practices": [
        {
            "introduction": "涨落-耗散定理（FDT）提供了一种从系统的响应特性预测其热噪声的强大方法。这个练习  提供了将 FDT 的数学形式直接应用于一个具有重要实验意义的系统——纳米机械谐振器的实践。通过此练习，您将学习如何将系统的机械磁化率（包括复杂的阻尼）与其在经典高温极限下可观测的热位置涨落联系起来，从而巩固使用该定理所需的核心计算技能。",
            "id": "125694",
            "problem": "一个纳米机械谐振器与一个温度为 $T$ 的热浴耦合。谐振器的动力学可以很好地用广义朗之万方程来描述，在频域中，该方程导出一个与频率相关的机械易感性 $\\chi(\\omega)$。位置响应 $x(\\omega)$ 与外部驱动力 $F(\\omega)$ 之间的关系由 $x(\\omega) = \\chi(\\omega)F(\\omega)$ 给出。\n\n谐振器的易感性由下式给出：\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega\\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\n其中 $k$ 是弹簧常数，$m$ 是有效质量，$\\tilde{\\gamma}(\\omega)$ 是复的、与频率相关的阻尼系数。阻尼由德拜公式建模：\n$$\n\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d}\n$$\n其中 $\\gamma_0$ 是零频阻尼常数，$\\tau_d$ 是热浴的特征记忆时间。\n\n根据涨落耗散定理，热机械位置涨落的对称化功率谱密度（PSD）$S_x(\\omega)$ 与机械易感性的虚部 $\\text{Im}[\\chi(\\omega)]$ 通过以下关系式相关联：\n$$\nS_x(\\omega) = 2\\hbar \\, \\text{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\n其中 $\\hbar$ 是约化普朗克常数，$k_B$ 是玻尔兹曼常数。\n\n在高温（经典）极限下，即 $k_B T$ 远大于相关振动量子能量 $\\hbar\\omega$ 的情况下，计算热机械位置涨落在零频时的功率谱密度 $S_x(0) = \\lim_{\\omega\\to 0} S_x(\\omega)$。\n\n用 $k$、$\\gamma_0$、$T$ 以及基本常数 $k_B$ 来表示你的最终答案。",
            "solution": "热机械位置涨落的对称化功率谱密度（PSD）由下式给出：\n\n$$\nS_x(\\omega) = 2\\hbar  \\operatorname{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\n\n其中 $\\chi(\\omega)$ 是机械易感性。零频极限为 $S_x(0) = \\lim_{\\omega \\to 0} S_x(\\omega)$。在高温极限 $k_B T \\gg \\hbar\\omega$ 下，coth 函数近似为：\n\n$$\n\\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right) \\approx \\frac{2k_B T}{\\hbar\\omega}\n$$\n\n易感性为：\n\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega \\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\n\n其中阻尼系数为：\n\n$$\n\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d} = \\gamma_0 \\frac{1}{1 + (\\omega\\tau_d)^2} + i \\gamma_0 \\frac{\\omega\\tau_d}{1 + (\\omega\\tau_d)^2}\n$$\n\n$\\chi(\\omega)$ 的分母是：\n\n$$\nD(\\omega) = k - m\\omega^2 - i\\omega \\left( \\gamma_0 \\frac{1 + i\\omega\\tau_d}{1 + (\\omega\\tau_d)^2} \\right) = k - m\\omega^2 + \\gamma_0 \\frac{\\omega^2\\tau_d}{1 + (\\omega\\tau_d)^2} - i \\gamma_0 \\frac{\\omega}{1 + (\\omega\\tau_d)^2}\n$$\n\n因此，$D(\\omega) = A(\\omega) - i B(\\omega)$，其中：\n\n$$\nA(\\omega) = k - m\\omega^2 + \\gamma_0 \\frac{\\omega^2\\tau_d}{1 + (\\omega\\tau_d)^2}, \\quad B(\\omega) = \\gamma_0 \\frac{\\omega}{1 + (\\omega\\tau_d)^2}\n$$\n\n$\\chi(\\omega)$ 的虚部是：\n\n$$\n\\operatorname{Im}[\\chi(\\omega)] = \\frac{B(\\omega)}{A(\\omega)^2 + B(\\omega)^2}\n$$\n\n当 $\\omega \\to 0$ 时，主导项为：\n\n$$\nA(\\omega) \\to k, \\quad B(\\omega) \\to \\gamma_0 \\omega\n$$\n\n因为高阶项消失了。因此：\n\n$$\n\\operatorname{Im}[\\chi(\\omega)] \\approx \\frac{\\gamma_0 \\omega}{k^2}\n$$\n\n代入 $S_x(\\omega)$：\n\n$$\nS_x(\\omega) \\approx 2\\hbar \\cdot \\frac{\\gamma_0 \\omega}{k^2} \\cdot \\frac{2k_B T}{\\hbar\\omega} = \\frac{4 \\gamma_0 k_B T}{k^2}\n$$\n\n取 $\\omega \\to 0$ 的极限：\n\n$$\nS_x(0) = \\lim_{\\omega \\to 0} S_x(\\omega) = \\frac{4 \\gamma_0 k_B T}{k^2}\n$$\n\n由于是零频极限，结果与 $m$ 和 $\\tau_d$ 无关。",
            "answer": "$$\n\\boxed{\\dfrac{4 k_{B} T \\gamma_{0}}{k^{2}}}\n$$"
        },
        {
            "introduction": "除了分析物理系统，FDT 也是设计物理上正确的计算机模拟的基石。在朗之万动力学模拟中，耗散力必须与精确校准的随机力相平衡，以维持目标温度。这项实践  要求您为一个离散时间朗之万积分器推导其随机噪声项应具备的正确统计特性，从而确保模拟能够正确地重现麦克斯韦-玻尔兹曼分布。这直接展示了 FDT 不仅是描述性的，更是规定性的，它构成了介观模拟算法构建中的一个基本约束。",
            "id": "4107063",
            "problem": "考虑一个质量为 $m$ 的一维大示踪粒子，浸没在热力学温度为 $T$ 的复杂流体中。示踪粒子的动量 $p$ 在系数为 $\\gamma$（单位为时间倒数）的线性斯托克斯阻力以及流体热涨落的作用下演化。您的任务是设计一个在时间步长 $\\Delta t$ 内对动量进行积分的离散时间积分器，该积分器需满足温度 $T$ 下的平衡麦克斯韦-玻尔兹曼分布。\n\n假设在一个步长内对 $p$ 的时间离散更新具有自回归形式\n$$\np_{n+1} = a\\, p_n + \\eta_n,\n$$\n其中 $a$ 是一个仅由线性阻力决定的确定性系数，而 $\\eta_n$ 是一个零均值高斯随机变量，用于模拟在时间间隔 $\\Delta t$ 内来自流体的净热冲量。假设 $\\eta_n$ 在各个步长之间是独立同分布（i.i.d.）的，并且独立于 $p_n$。\n\n仅从牛顿第二定律、线性阻力以及与麦克斯韦-玻尔兹曼分布达到平衡的要求出发，按以下步骤进行：\n- 通过求解在时间步长 $\\Delta t$ 内仅受阻力作用下 $p$ 的线性确定性动力学的精确解来确定 $a$。\n- 施加条件，使得在上述马尔可夫更新下 $p_n$ 的稳态分布是温度为 $T$ 的麦克斯韦-玻尔兹曼分布，这意味着 $\\langle p_n^2 \\rangle = m k_B T$，其中 $k_B$ 是玻尔兹曼常数。由此，推导出热冲量所需方差 $\\mathrm{Var}(\\eta_n)$ 的一个闭合形式表达式，用 $m$、$k_B$、$T$、$\\gamma$ 和 $\\Delta t$ 表示。\n- 最后，通过获得小时间步长的渐近行为，将您的离散时间结果与连续统的涨落-耗散幅度联系起来，并解释它如何简化为一个与 $2 \\gamma k_B T \\Delta t$ 成正比的表达式。\n\n以一个单一的解析表达式给出 $\\mathrm{Var}(\\eta_n)$ 的最终答案，用 $m$、$k_B$、$T$、$\\gamma$ 和 $\\Delta t$ 表示。不需要进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "我们推导粒子动量离散时间积分器中热冲量的方差 $\\mathrm{Var}(\\eta_n)$，该积分器必须保持平衡的麦克斯韦-玻尔兹曼分布。我们将遵循指定的步骤。\n\n首先，我们确定更新规则 $p_{n+1} = a\\, p_n + \\eta_n$ 中的确定性系数 $a$。该系数由仅在线性阻力作用下的动力学导出。问题陈述了一个线性斯托克斯阻力，其系数 $\\gamma$ 的单位是时间倒数。这意味着阻力与动量成正比，$F_{drag} = -\\gamma p$。在此阻力作用下，动量 $p$ 的牛顿第二定律为：\n$$\n\\frac{dp(t)}{dt} = -\\gamma p(t)\n$$\n这是一个一阶线性常微分方程。我们在一个时长为 $\\Delta t$ 的时间区间内求解它，从初始时间 $t_n$（此时动量为 $p(t_n) = p_n$）到最终时间 $t_{n+1} = t_n + \\Delta t$。解可以通过分离变量法找到：\n$$\n\\int_{p_n}^{p(t_{n+1})} \\frac{dp}{p} = \\int_{t_n}^{t_{n+1}} -\\gamma dt\n$$\n$$\n\\ln\\left(\\frac{p(t_{n+1})}{p_n}\\right) = -\\gamma (t_{n+1} - t_n) = -\\gamma \\Delta t\n$$\n对两边取指数，得到动量确定性演化的精确解：\n$$\np(t_{n+1}) = p_n \\exp(-\\gamma \\Delta t)\n$$\n将此结果与离散更新规则的确定性部分 $p_{n+1} = a p_n$ 进行比较，我们确定系数 $a$：\n$$\na = \\exp(-\\gamma \\Delta t)\n$$\n\n接下来，我们施加条件，使得在完整的随机更新规则下，动量的稳态分布是麦克斯韦-玻尔兹曼分布。更新规则是：\n$$\np_{n+1} = a p_n + \\eta_n\n$$\n我们计算第 $n+1$ 步的动量二阶矩：\n$$\n\\langle p_{n+1}^2 \\rangle = \\langle (a p_n + \\eta_n)^2 \\rangle = \\langle a^2 p_n^2 + 2a p_n \\eta_n + \\eta_n^2 \\rangle\n$$\n利用期望算符的线性性质，我们得到：\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + 2a \\langle p_n \\eta_n \\rangle + \\langle \\eta_n^2 \\rangle\n$$\n问题陈述热冲量 $\\eta_n$ 独立于动量 $p_n$。因此，协方差项为 $\\langle p_n \\eta_n \\rangle = \\langle p_n \\rangle \\langle \\eta_n \\rangle$。问题还指定 $\\eta_n$ 是一个零均值随机变量，所以 $\\langle \\eta_n \\rangle = 0$。因此，$\\langle p_n \\eta_n \\rangle = 0$。方程简化为：\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + \\langle \\eta_n^2 \\rangle\n$$\n在热力学平衡状态下，系统处于稳态，这意味着动量的统计特性不随时间变化。因此，均方动量是时不变的：$\\langle p_{n+1}^2 \\rangle = \\langle p_n^2 \\rangle \\equiv \\langle p^2 \\rangle_{eq}$。将此代入方程得到：\n$$\n\\langle p^2 \\rangle_{eq} = a^2 \\langle p^2 \\rangle_{eq} + \\langle \\eta_n^2 \\rangle\n$$\n我们现在可以解出 $\\langle \\eta_n^2 \\rangle$：\n$$\n\\langle \\eta_n^2 \\rangle = (1 - a^2) \\langle p^2 \\rangle_{eq}\n$$\n$\\eta_n$ 的方差定义为 $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle - (\\langle \\eta_n \\rangle)^2$。由于 $\\langle \\eta_n \\rangle = 0$，方差就是 $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle$。\n问题要求稳态分布是麦克斯韦-玻尔兹曼分布，对于质量为 $m$、温度为 $T$ 的一维粒子，这意味着均方动量为 $\\langle p^2 \\rangle_{eq} = m k_B T$，这是能量均分定理的一个结果。将此结果以及 $a$ 的表达式代入我们的方差方程，得到：\n$$\n\\mathrm{Var}(\\eta_n) = (1 - (\\exp(-\\gamma \\Delta t))^2) (m k_B T) = m k_B T (1 - \\exp(-2 \\gamma \\Delta t))\n$$\n这就是所需的热冲量方差的闭合形式表达式。\n\n最后，我们分析小时间步长极限（$\\Delta t \\to 0$），将此结果与连续时间涨落-耗散定理联系起来。我们对小宗量使用指数函数的泰勒级数展开，$\\exp(x) \\approx 1 + x$（对于 $x \\ll 1$）。令 $x = -2 \\gamma \\Delta t$。\n$$\n\\exp(-2 \\gamma \\Delta t) \\approx 1 - 2 \\gamma \\Delta t\n$$\n将此代入我们的方差表达式：\n$$\n\\mathrm{Var}(\\eta_n) \\approx m k_B T (1 - (1 - 2 \\gamma \\Delta t)) = m k_B T (2 \\gamma \\Delta t) = 2 m \\gamma k_B T \\Delta t\n$$\n在朗之万方程的连续形式 $\\frac{dp}{dt} = -\\gamma p + F_{fluct}(t)$ 中，随机力 $F_{fluct}(t)$ 是一个白噪声项，其强度由涨落-耗散定理决定：$\\langle F_{fluct}(t) F_{fluct}(t') \\rangle = 2 \\zeta k_B T \\delta(t-t')$，其中 $\\zeta$ 是摩擦系数。从运动方程中，我们确定 $\\gamma = \\zeta/m$。离散的热冲量 $\\eta_n$ 对应于随机力在一个时间步长内的积分，$\\eta_n = \\int_{t_n}^{t_{n+1}} F_{fluct}(t') dt'$。其方差为 $\\mathrm{Var}(\\eta_n) = \\int_{t_n}^{t_{n+1}} \\int_{t_n}^{t_{n+1}} \\langle F_{fluct}(t') F_{fluct}(t'') \\rangle dt' dt'' = 2 \\zeta k_B T \\Delta t = 2 (m\\gamma) k_B T \\Delta t$。我们的渐近结果与这个连续统极限相匹配，证实了我们推导的方差的一致性。",
            "answer": "$$\n\\boxed{m k_B T (1 - \\exp(-2 \\gamma \\Delta t))}\n$$"
        },
        {
            "introduction": "FDT 在被动微流变学等实验技术中发挥着极其重要的作用，这些技术通过观察嵌入探针的热运动来推断复杂流体的性质。这个过程实际上是“反演”FDT，即从涨落谱中确定材料的响应函数。这个高级计算练习  将引导您完成这一过程，利用 FDT 从功率谱中提取响应函数的耗散部分，然后运用与因果律相关的克拉默斯-克朗尼希关系来重构完整的复数响应函数。这项任务揭示了涨落、耗散和因果律之间的深刻联系，并让您掌握现代软物质研究中实用的数据分析工作流程。",
            "id": "4107081",
            "problem": "给定一个浸入线性粘弹性流体中、处于热平衡状态的微米级探针的一维位移功率谱密度 $S_{xx}(\\omega)$，该数据是在均匀间隔的角频率网格 $\\omega \\in [\\omega_{\\min},\\omega_{\\max}]$ 上测量的。该探针被一个刚度为 $k$ 的线性谐波势阱捕获，并受到由复频率相关摩擦系数 $\\zeta^{*}(\\omega)$ 表征的流体动力学阻力。探针位置 $x(t)$ 对外部施加的力 $f(t)$ 呈线性响应，其因果响应函数（感受态）为 $\\chi_{xx}(t)$，其傅里叶变换 $\\chi_{xx}(\\omega)$ 在上半复平面解析，满足实时因果性，并遵循标准的热力学平衡性质。\n\n从线性响应、热平衡、因果性和解析性原理出发，使用谱涨落-耗散定理（FDT）和 Kramers-Kronig 关系来：\n\n1. 在给定的网格上，直接从测量的 $S_{xx}(\\omega)$ 和已知温度 $T$ 计算耗散分量 $\\operatorname{Im}\\chi_{xx}(\\omega)$。所有角频率单位均为弧度/秒。\n2. 使用因果性所蕴含的适当的 Kramers-Kronig 积分，从 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 重建储能分量 $\\operatorname{Re}\\chi_{xx}(\\omega)$。\n3. 通过将 $\\operatorname{Re}\\chi_{xx}(\\omega)$ 与每个测试案例的已知基准模型 $\\chi_{xx}(\\omega)$ 进行比较，来验证重建结果。对于每个测试案例，报告一个单一的标量度量，即正频率网格上的相对均方根误差：\n$$\n\\varepsilon = \\frac{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_i)-\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}.\n$$\n所有输入和输出必须遵守以下单位：\n- 角频率 $\\omega$：弧度/秒。\n- 温度 $T$：开尔文。\n- 玻尔兹曼常数 $k_{\\mathrm{B}}$：焦耳/开尔文。\n- 势阱刚度 $k$：牛顿/米。\n- 流体粘度 $\\eta$：帕斯卡·秒。\n- 流体剪切模量 $G_0$：帕斯卡。\n- 探针半径 $a$：米。\n- 位移功率谱密度 $S_{xx}$：平方米·秒。\n\n假设探针的力学响应函数具有与粘弹性介质中线性斯托克斯流体动力学一致的通用势阱形式，\n$$\n\\chi_{xx}(\\omega)=\\frac{1}{k - i\\,\\omega\\,\\zeta^{*}(\\omega)},\n$$\n其中复摩擦系数 $\\zeta^{*}(\\omega)$ 通过 $\\zeta^{*}(\\omega)=6\\pi a\\,\\eta^{*}(\\omega)$ 与流体的复粘度 $\\eta^{*}(\\omega)$ 相关，而复粘度又通过 $\\eta^{*}(\\omega)=G^{*}(\\omega)/(i\\omega)$ 与复剪切模量 $G^{*}(\\omega)$ 相关。\n\n你的程序必须实现以下功能：\n- 使用谱涨落-耗散定理（FDT）从 $S_{xx}(\\omega)$ 中提取 $\\operatorname{Im}\\chi_{xx}(\\omega)$。\n- 在均匀网格上使用数值稳定的 Kramers-Kronig 主值近似，从 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 重建 $\\operatorname{Re}\\chi_{xx}(\\omega)$。\n\n测试套件：\n对于所有情况，使用一个在 $[0,\\omega_{\\max}]$ 上包含 $N=513$ 个点的均匀间隔角频率网格，其中 $\\omega_{\\max}=2500$ 弧度/秒（包括 $\\omega=0$）。使用玻尔兹曼常数 $k_{\\mathrm{B}}=1.380649\\times 10^{-23}$ 焦耳/开尔文。对于每个案例，根据指定的流体模型生成基准 $\\chi_{xx}(\\omega)$，然后根据谱 FDT 从基准合成 $S_{xx}(\\omega)$，接着进行重建和误差计算。这三种情况是：\n\n- 案例1（理想情况，牛顿流体）：\n  - 探针半径 $a=1.0\\times 10^{-6}$ 米。\n  - 势阱刚度 $k=1.0\\times 10^{-6}$ 牛顿/米。\n  - 动力粘度 $\\eta=1.0\\times 10^{-3}$ 帕斯卡·秒。\n  - 温度 $T=298$ 开尔文。\n\n- 案例2（粘弹性 Maxwell 流体）：\n  - 探针半径 $a=0.5\\times 10^{-6}$ 米。\n  - 势阱刚度 $k=8.0\\times 10^{-7}$ 牛顿/米。\n  - Maxwell 剪切模量 $G_0=5.0$ 帕斯卡。\n  - Maxwell 弛豫时间 $\\tau=5.0\\times 10^{-2}$ 秒。\n  - 温度 $T=310$ 开尔文。\n  - 对于 Maxwell 模型，使用 $G^{*}(\\omega)=G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$。\n\n- 案例3（具有非常软的势阱和慢弛豫的边缘情况）：\n  - 探针半径 $a=1.5\\times 10^{-6}$ 米。\n  - 势阱刚度 $k=1.0\\times 10^{-8}$ 牛顿/米。\n  - Maxwell 剪切模量 $G_0=20.0$ 帕斯卡。\n  - Maxwell 弛豫时间 $\\tau=1.0$ 秒。\n  - 温度 $T=300$ 开尔文。\n  - 使用与案例2中相同的 Maxwell $G^{*}(\\omega)$ 形式。\n\n数值要求与处理：\n- 仔细处理 $\\omega=0$ 点以避免在应用谱 FDT 时出现除以零的错误；你应该定义 $\\operatorname{Im}\\chi_{xx}(0)=0$ 并从任何除以 $\\omega$ 的计算中排除 $\\omega=0$ 点。\n- 在正 $\\omega$ 的均匀网格上，使用与因果性一致的主值离散化来进行 Kramers-Kronig 重建。\n- 当分母为零时，在主值求和中排除奇异项，以确保数值稳定性。\n\n最终输出：\n你的程序应生成一行输出，其中包含案例1、2和3的三个相对均方根误差，格式为一个用方括号括起来的逗号分隔列表，每个数字四舍五入到六位小数，例如，\"[0.012345,0.067890,0.000111]\"。",
            "solution": "该问题要求从一个被捕获在流体中的探针的热位置涨落（由功率谱密度 $S_{xx}(\\omega)$ 量化）来重建其完整的复响应函数 $\\chi_{xx}(\\omega)$。这项任务取决于统计物理学的两个基本原理：涨落-耗散定理（FDT）和因果性原理，后者通过 Kramers-Kronig（KK）关系体现出来。解决方案包括三个主要阶段：（1）计算基准模型并合成“测量”的涨落谱，（2）应用FDT和KK关系从合成谱中重建响应函数的实部，以及（3）量化重建的准确性。\n\n### 步骤1：涨落-耗散定理与响应函数\n\n涨落-耗散定理建立了平衡态下系统的热涨落与其对外部扰动的耗散响应之间的直接关系。对于像探针位置 $x$ 这样的一维系统，该定理将位置涨落的功率谱密度 $S_{xx}(\\omega)$ 与力学响应函数的虚部（耗散部分）$\\operatorname{Im}\\chi_{xx}(\\omega)$ 联系起来。对于温度为 $T$ 的经典系统，该定理的谱形式为：\n$$\nS_{xx}(\\omega) = \\frac{2 k_{\\mathrm{B}} T}{\\omega} \\operatorname{Im}\\chi_{xx}(\\omega)\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\omega$ 是角频率。该方程构成了任务第一部分的基础。给定 $S_{xx}(\\omega)$ 和 $T$，我们可以计算响应函数的耗散分量：\n$$\n\\operatorname{Im}\\chi_{xx}(\\omega) = \\frac{\\omega S_{xx}(\\omega)}{2 k_{\\mathrm{B}} T}\n$$\n在 $\\omega = 0$ 时，静态力不产生耗散，因此 $\\operatorname{Im}\\chi_{xx}(0) = 0$。这与公式一致，因为分子中的 $\\omega$ 项确保了在零频率下结果为零。对于 $\\omega  0$，这提供了一种从涨落谱直接代数计算 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 的方法。\n\n### 步骤2：因果性与 Kramers-Kronig 关系\n\n因果性原理规定，系统的响应不能先于引起它的力。这一物理约束对复响应函数 $\\chi_{xx}(\\omega)$ 施加了一种数学结构。具体来说，$\\chi_{xx}(\\omega)$ 必须是在复频率平面的上半平面中的解析函数。这种解析性的一个结果是，$\\chi_{xx}(\\omega)$ 的实部和虚部不是独立的，而是通过一对称为 Kramers-Kronig 关系的积分变换相互关联。\n\n为了从虚部重建响应函数的实部（储能分量）$\\operatorname{Re}\\chi_{xx}(\\omega)$，我们使用以下 KK 关系：\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n其中 $\\mathcal{P}$ 表示积分的柯西主值。由于物理响应函数 $x(t)$ 是实值的，其傅里叶变换 $\\chi_{xx}(\\omega)$ 具有对称性 $\\chi_{xx}(-\\omega) = \\chi_{xx}^*(\\omega)$，这意味着 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 是 $\\omega$ 的奇函数。利用这一性质，积分可以简化为只在正频率上进行：\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega'^2 - \\omega^2} d\\omega'\n$$\n这就是必须进行数值实现的积分。\n\n### 步骤3：数值实现\n\n问题在有限的、均匀的网格 $\\omega_i \\in [0, \\omega_{\\max}]$ 上提供数据，步长为 $\\Delta\\omega$。KK 积分通过求和来近似。主值通过省略分母为零的奇异项来处理。\n$$\n\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_k) \\approx \\frac{2 \\Delta\\omega}{\\pi} \\sum_{j, j \\neq k} \\frac{\\omega_j \\operatorname{Im}\\chi_{xx}(\\omega_j)}{\\omega_j^2 - \\omega_k^2}\n$$\n其中 $\\omega_k$ 是我们重建实部的频率，求和遍及网格点 $\\omega_j$。在 $\\omega_{\\max}$ 处截断积分是此过程中的一个固有近似。\n\n### 步骤4：基准模型和数据合成\n\n为了验证重建，我们首先需要一个基准。问题提供了响应函数的物理模型：\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - i\\omega\\zeta^*(\\omega)}\n$$\n复摩擦系数 $\\zeta^*(\\omega)$ 通过流体的复剪切模量 $G^*(\\omega)$ 进行建模：\n$$\n\\zeta^*(\\omega) = 6\\pi a \\eta^*(\\omega) \\quad \\text{与} \\quad \\eta^*(\\omega) = \\frac{G^*(\\omega)}{i\\omega}\n$$\n代入这些可以得到 $\\chi_{xx}(\\omega)$ 和 $G^*(\\omega)$ 之间的直接关系：\n$$\n\\chi_{xx}^{\\text{true}}(\\omega) = \\frac{1}{k - 6\\pi a G^*(\\omega)}\n$$\n$G^*(\\omega)$ 的具体模型是：\n1.  **牛顿流体**：$G^*(\\omega) = i\\omega\\eta$。粘度 $\\eta$ 是常数。\n2.  **Maxwell 流体**：$G^*(\\omega) = G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$。该模型具有频率相关的粘度，表现出弹性（$G_0$）和粘性（$\\tau$）特性。\n\n对于每个测试案例，我们在指定的频率网格上计算基准 $\\chi_{xx}^{\\text{true}}(\\omega)$。由此，我们提取 $\\operatorname{Im}\\chi_{xx}^{\\text{true}}(\\omega)$ 并使用 FDT 合成输入功率谱 $S_{xx}(\\omega)$。在 $\\omega=0$ 处必须小心，因为 FDT 表达式是 $0/0$ 的不定形式。正确的值通过取极限得到：\n$$\nS_{xx}(0) = 2 k_{\\mathrm{B}} T \\lim_{\\omega \\to 0} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega)}{\\omega}\n$$\n对于牛顿流体，其摩擦系数为 $\\zeta=6\\pi a\\eta$，此极限给出 $S_{xx}(0) = 2k_BT\\zeta/k^2$。对于 Maxwell 模型，零剪切摩擦系数为 $\\zeta_0 = 6\\pi a G_0 \\tau$，得到 $S_{xx}(0) = 2k_BT\\zeta_0/k^2$。\n\n### 步骤5：误差计算\n\n在使用 KK 积分重建 $\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega)$ 之后，使用给定的相对均方根误差度量 $\\varepsilon$ 对其与基准 $\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega)$ 的准确性进行评估，该误差是在网格的正频率点上计算的。\n\n对于指定的三个测试案例中的每一个，都执行了完整的程序——合成、重建和验证。然后报告每个案例的重建误差 $\\varepsilon$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing susceptibility from fluctuation spectra\n    for three distinct physical cases.\n    \"\"\"\n\n    def get_error(case_params: dict, omega: np.ndarray, N: int, kB: float) - float:\n        \"\"\"\n        Calculates the reconstruction error for a single test case.\n\n        This function performs the following steps:\n        1. Generates the ground-truth complex susceptibility from the given physical model.\n        2. Synthesizes the \"measured\" power spectral density (PSD) using the Fluctuation-Dissipation Theorem (FDT).\n        3. Extracts the imaginary part of susceptibility from the synthetic PSD.\n        4. Reconstructs the real part of susceptibility using a numerical Kramers-Kronig transform.\n        5. Computes the relative root-mean-square error between the reconstructed and true real parts.\n        \"\"\"\n        # Unpack parameters\n        model_type = case_params['type']\n        T = case_params['T']\n        k = case_params['k']\n        a = case_params['a']\n        \n        # --- 1. Ground Truth Generation ---\n        omega_c = omega.astype(np.complex128)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            # G*(omega) = i*omega*eta\n            G_star = 1j * omega_c * eta\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            # G*(omega) = G0 * (i*omega*tau) / (1 + i*omega*tau)\n            G_star = G0 * (1j * omega_c * tau) / (1 + 1j * omega_c * tau)\n\n        # chi_xx = 1 / (k - 6*pi*a*G*)\n        chi_xx_true = 1.0 / (k - 6.0 * np.pi * a * G_star)\n        Re_chi_true = chi_xx_true.real\n        Im_chi_true = chi_xx_true.imag\n\n        # --- 2. Synthesize Power Spectral Density S_xx(omega) ---\n        S_xx = np.zeros_like(omega)\n        \n        # For omega  0, use FDT directly\n        # S_xx = (2 * kB * T / omega) * Im[chi_xx]\n        # Use errstate to avoid warning for omega[0]=0, which is handled separately\n        with np.errstate(divide='ignore', invalid='ignore'):\n            S_xx[1:] = (2 * kB * T / omega[1:]) * Im_chi_true[1:]\n        \n        # For omega = 0, calculate the limit S_xx(0) = 2*kB*T * lim(Im[chi]/omega)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            zeta_0 = 6 * np.pi * a * eta\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            zeta_0 = 6 * np.pi * a * G0 * tau\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n\n        # --- 3. Extract Im[chi] from S_xx ---\n        # Im[chi] = (omega * S_xx) / (2 * kB * T)\n        Im_chi_from_S = (omega * S_xx) / (2 * kB * T)\n        # Im_chi_from_S[0] is guaranteed to be 0 since omega[0] is 0.\n\n        # --- 4. Reconstruct Re[chi] using Kramers-Kronig Integral ---\n        Re_chi_recon = np.zeros_like(omega)\n        delta_omega = omega[1] - omega[0]\n        \n        # The term to be summed in the KK integral\n        kk_term = omega * Im_chi_from_S\n\n        # Discretized principal value integral:\n        # Re[chi](w_k) = (2*dw/pi) * SUM_{j!=k} [w_j * Im[chi](w_j)] / [w_j^2 - w_k^2]\n        for k in range(N):\n            omega_k_sq = omega[k]**2\n            \n            # Create a copy to avoid modifying the original array\n            integrand_denom = omega**2 - omega_k_sq\n            \n            # Find indices where denominator is non-zero to perform division safely\n            valid_indices = (integrand_denom != 0)\n            \n            # Prepare integrand array, initialized to zero\n            integrand = np.zeros_like(omega)\n            \n            # Calculate integrand only for non-singular points\n            integrand[valid_indices] = kk_term[valid_indices] / integrand_denom[valid_indices]\n\n            # The sum automatically omits the k-th term as it's set to 0\n            integral_sum = np.sum(integrand)\n            \n            Re_chi_recon[k] = (2.0 * delta_omega / np.pi) * integral_sum\n\n        # --- 5. Calculate Error Metric ---\n        # Sums are over the positive-frequency grid (i.e., excluding omega=0)\n        recon_pos = Re_chi_recon[1:]\n        true_pos = Re_chi_true[1:]\n        \n        numerator_sq_sum = np.sum((recon_pos - true_pos)**2)\n        denominator_sq_sum = np.sum(true_pos**2)\n\n        if denominator_sq_sum == 0:\n            return 0.0 if numerator_sq_sum == 0 else np.inf\n            \n        error = np.sqrt(numerator_sq_sum / denominator_sq_sum)\n        \n        return error\n\n    # General parameters\n    kB = 1.380649e-23  # Joules per Kelvin\n    N = 513\n    omega_max = 2500.0  # radians per second\n    omega = np.linspace(0, omega_max, N)\n\n    # Test cases from problem statement\n    test_cases = [\n        {\n            'type': 'newtonian',\n            'a': 1.0e-6, 'k': 1.0e-6, 'eta': 1.0e-3, 'T': 298.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 0.5e-6, 'k': 8.0e-7, 'G0': 5.0, 'tau': 5.0e-2, 'T': 310.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 1.5e-6, 'k': 1.0e-8, 'G0': 20.0, 'tau': 1.0, 'T': 300.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        error = get_error(params, omega, N, kB)\n        results.append(error)\n\n    # Format the output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}