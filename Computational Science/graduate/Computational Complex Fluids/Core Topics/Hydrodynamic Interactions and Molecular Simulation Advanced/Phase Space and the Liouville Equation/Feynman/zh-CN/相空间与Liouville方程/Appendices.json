{
    "hands_on_practices": [
        {
            "introduction": "我们知道，对于哈密顿系统，刘维尔定理保证了相空间体积的守恒。然而，在复杂流体的实际模型中，耗散力（如摩擦力）是不可避免的，这使得系统本质上变为非哈密顿系统。本练习将引导你直接计算一个包含构型依赖的阻力的非哈密顿系统的相空间可压缩性，从而揭示耗散如何导致相空间体积的收缩，这是理解非平衡定态的关键一步。",
            "id": "4098586",
            "problem": "考虑一个由$d$维空间中的$N$个独立聚合物哑铃组成的粗粒化复杂流体模型。每个哑铃由其连接矢量位置 $\\mathbf{r}_i \\in \\mathbb{R}^d$ 和共轭动量 $\\mathbf{p}_i \\in \\mathbb{R}^d$ 描述，其中 $i = 1, \\dots, N$。溶剂施加一个稳恒、均匀、不可压缩的线性流 $\\mathbf{u}(\\mathbf{x}) = \\boldsymbol{\\kappa} \\cdot \\mathbf{x}$，其中 $\\boldsymbol{\\kappa}$ 是一个满足 $\\mathrm{tr}(\\boldsymbol{\\kappa}) = 0$ 的恒定速度梯度张量。每个哑铃受到谐振子弹簧力 $-k \\mathbf{r}_i$ 和一个破坏哈密顿结构的、依赖于构型的斯托克斯阻力，其摩擦系数为\n$$\n\\gamma(|\\mathbf{r}_i|) = \\gamma_0 \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right),\n$$\n其中 $\\gamma_0 > 0$ 和 $\\alpha \\ge 0$ 是常数， $|\\mathbf{r}_i|$ 表示欧几里得范数。\n\n假设确定性运动方程为\n$$\n\\dot{\\mathbf{r}}_i = \\frac{\\mathbf{p}_i}{m} + \\boldsymbol{\\kappa} \\cdot \\mathbf{r}_i, \\qquad\n\\dot{\\mathbf{p}}_i = -k \\mathbf{r}_i - \\gamma(|\\mathbf{r}_i|) \\mathbf{p}_i,\n$$\n其中 $m>0$ 是珠子质量，$k>0$ 是弹簧常数。令 $\\rho(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}, t)$ 为 $2dN$ 维状态向量的相空间概率密度。\n\n从相空间中的概率守恒和牛顿第二定律出发，推导适用于此确定性流的相空间连续性方程（刘维尔方程），并求得相空间可压缩性\n$$\n\\Lambda(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}) \\equiv \\sum_{i=1}^{N} \\left( \\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} : \\mathbf{I}_d + \\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} : \\mathbf{I}_d \\right),\n$$\n其中 $:$ 表示弗罗贝尼乌斯（双）缩并，$\\mathbf{I}_d$ 是 $d \\times d$ 单位张量。对于给定的动力学，显式地计算 $\\Lambda$，并根据你的推导解释为什么刘维尔定理（哈密顿流的可压缩性为零）由于非哈密顿阻力的存在而对这种复杂流体不成立。\n\n将你的最终结果以无量纲可压缩性\n$$\n\\hat{\\Lambda} \\equiv \\frac{\\Lambda}{\\gamma_0},\n$$\n的形式报告，用 $N$、$d$、$\\alpha$ 和 $|\\mathbf{r}_i|$ 表示。无需进行数值舍入。由于所求量是无量纲的，最终答案无需注明单位。你的加框最终答案必须是 $\\hat{\\Lambda}$ 的一个单一闭式解析表达式。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提出了一个来自复杂流体非平衡统计力学领域的标准模型，并要求进行严格的数学推导。我们现在可以开始求解。\n\n该问题要求推导相空间连续性方程，并显式计算一个由 $N$ 个独立聚合物哑铃组成的系统的相空间可压缩性 $\\Lambda$。系统的状态由一个 $2dN$ 维相空间中的一个点描述，其坐标为 $(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\})$，其中 $i = 1, \\dots, N$。相空间概率密度 $\\rho(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}, t)$ 的时间演化由广义连续性方程支配，该方程表达了概率守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla_{\\Gamma} \\cdot (\\rho \\dot{\\Gamma}) = 0\n$$\n其中 $\\Gamma = (\\mathbf{r}_1, \\dots, \\mathbf{r}_N, \\mathbf{p}_1, \\dots, \\mathbf{p}_N)$ 是相空间中的状态向量，$\\dot{\\Gamma}$ 是相空间速度，$\\nabla_{\\Gamma}$ 是相空间中的梯度算子。展开散度项，我们得到：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\dot{\\Gamma} \\cdot \\nabla_{\\Gamma} \\rho + \\rho (\\nabla_{\\Gamma} \\cdot \\dot{\\Gamma}) = 0\n$$\n前两项表示 $\\rho$ 沿着一条相空间轨迹的全时间导数 $\\frac{d\\rho}{dt}$。因此，方程变为：\n$$\n\\frac{d\\rho}{dt} = - \\rho (\\nabla_{\\Gamma} \\cdot \\dot{\\Gamma})\n$$\n项 $\\nabla_{\\Gamma} \\cdot \\dot{\\Gamma}$ 是相空间可压缩性，它衡量了当一个无穷小相空间体积元被流平流时其体积的变化率。在我们的记法中，这正是量 $\\Lambda$：\n$$\n\\Lambda \\equiv \\nabla_{\\Gamma} \\cdot \\dot{\\Gamma} = \\sum_{i=1}^{N} \\left( \\nabla_{\\mathbf{r}_i} \\cdot \\dot{\\mathbf{r}}_i + \\nabla_{\\mathbf{p}_i} \\cdot \\dot{\\mathbf{p}}_i \\right)\n$$\n问题给出了使用张量表示法的等价定义：\n$$\n\\Lambda(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}) \\equiv \\sum_{i=1}^{N} \\left( \\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} : \\mathbf{I}_d + \\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} : \\mathbf{I}_d \\right)\n$$\n其中 $\\frac{\\partial \\mathbf{v}}{\\partial \\mathbf{u}}$ 是分量为 $(\\frac{\\partial v_k}{\\partial u_l})$ 的雅可比张量，且 $\\mathbf{A}:\\mathbf{B} = \\mathrm{tr}(\\mathbf{A}^T \\mathbf{B})$。对于 $\\mathbf{B} = \\mathbf{I}_d$，这变为 $\\mathbf{A}:\\mathbf{I}_d = \\mathrm{tr}(\\mathbf{A})$，这证实了该定义等价于散度之和。\n\n运动方程由下式给出：\n$$\n\\dot{\\mathbf{r}}_i = \\frac{\\mathbf{p}_i}{m} + \\boldsymbol{\\kappa} \\cdot \\mathbf{r}_i\n$$\n$$\n\\dot{\\mathbf{p}}_i = -k \\mathbf{r}_i - \\gamma(|\\mathbf{r}_i|) \\mathbf{p}_i\n$$\n由于哑铃是独立的，我们可以计算单个哑铃 $i$ 的贡献，然后对所有 $N$ 个哑铃求和。\n\n首先，我们计算位置空间贡献 $\\nabla_{\\mathbf{r}_i} \\cdot \\dot{\\mathbf{r}}_i = \\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} : \\mathbf{I}_d$。\n雅可比张量 $\\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i}$ 的分量为：\n$$\n\\left( \\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} \\right)_{jk} = \\frac{\\partial (\\dot{r}_i)_j}{\\partial (r_i)_k} = \\frac{\\partial}{\\partial (r_i)_k} \\left( \\frac{(p_i)_j}{m} + \\sum_{l=1}^d \\kappa_{jl} (r_i)_l \\right)\n$$\n第一项 $\\frac{(p_i)_j}{m}$ 与 $\\mathbf{r}_i$ 无关。第二项的导数为：\n$$\n\\sum_{l=1}^d \\kappa_{jl} \\frac{\\partial (r_i)_l}{\\partial (r_i)_k} = \\sum_{l=1}^d \\kappa_{jl} \\delta_{lk} = \\kappa_{jk}\n$$\n所以，雅可比张量为 $\\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} = \\boldsymbol{\\kappa}$。\n对 $\\Lambda$ 的贡献是该张量的迹：\n$$\n\\frac{\\partial \\dot{\\mathbf{r}}_i}{\\partial \\mathbf{r}_i} : \\mathbf{I}_d = \\mathrm{tr}(\\boldsymbol{\\kappa})\n$$\n问题陈述溶剂流是不可压缩的，这意味着 $\\nabla \\cdot \\mathbf{u} = 0$。由于 $\\mathbf{u}(\\mathbf{x}) = \\boldsymbol{\\kappa} \\cdot \\mathbf{x}$，我们有 $\\nabla \\cdot \\mathbf{u} = \\mathrm{tr}(\\boldsymbol{\\kappa})$，所以 $\\mathrm{tr}(\\boldsymbol{\\kappa})=0$。因此，位置空间贡献为零。\n\n接下来，我们计算动量空间贡献 $\\nabla_{\\mathbf{p}_i} \\cdot \\dot{\\mathbf{p}}_i = \\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} : \\mathbf{I}_d$。\n雅可比张量 $\\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i}$ 的分量为：\n$$\n\\left( \\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} \\right)_{jk} = \\frac{\\partial (\\dot{p}_i)_j}{\\partial (p_i)_k} = \\frac{\\partial}{\\partial (p_i)_k} \\left( -k (r_i)_j - \\gamma(|\\mathbf{r}_i|) (p_i)_j \\right)\n$$\n第一项 $-k(r_i)_j$ 与 $\\mathbf{p}_i$ 无关。摩擦系数 $\\gamma(|\\mathbf{r}_i|)$ 也与 $\\mathbf{p}_i$ 无关。因此：\n$$\n\\frac{\\partial}{\\partial (p_i)_k} \\left( -\\gamma(|\\mathbf{r}_i|) (p_i)_j \\right) = -\\gamma(|\\mathbf{r}_i|) \\frac{\\partial (p_i)_j}{\\partial (p_i)_k} = -\\gamma(|\\mathbf{r}_i|) \\delta_{jk}\n$$\n所以，雅可比张量为 $\\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} = -\\gamma(|\\mathbf{r}_i|) \\mathbf{I}_d$。\n对 $\\Lambda$ 的贡献是该张量的迹：\n$$\n\\frac{\\partial \\dot{\\mathbf{p}}_i}{\\partial \\mathbf{p}_i} : \\mathbf{I}_d = \\mathrm{tr}(-\\gamma(|\\mathbf{r}_i|) \\mathbf{I}_d) = -\\gamma(|\\mathbf{r}_i|) \\mathrm{tr}(\\mathbf{I}_d) = -d \\cdot \\gamma(|\\mathbf{r}_i|)\n$$\n\n总可压缩性 $\\Lambda$ 是对所有 $N$ 个独立哑铃的这些贡献之和：\n$$\n\\Lambda = \\sum_{i=1}^{N} \\left( \\mathrm{tr}(\\boldsymbol{\\kappa}) - d \\cdot \\gamma(|\\mathbf{r}_i|) \\right) = \\sum_{i=1}^{N} \\left( 0 - d \\cdot \\gamma(|\\mathbf{r}_i|) \\right) = -d \\sum_{i=1}^{N} \\gamma(|\\mathbf{r}_i|)\n$$\n代入给定的摩擦系数表达式 $\\gamma(|\\mathbf{r}_i|) = \\gamma_0 \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right)$：\n$$\n\\Lambda = -d \\sum_{i=1}^{N} \\left[ \\gamma_0 \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right) \\right] = -d \\gamma_0 \\sum_{i=1}^{N} \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right)\n$$\n这个 $\\Lambda$ 的结果是系统构型 $\\{\\mathbf{r}_i\\}$ 的函数。\n\n刘维尔定理指出，对于任何其动力学由哈密顿量 $H$ 支配的系统，相空间可压缩性恒等于零，即 $\\Lambda=0$。如果一个系统的运动方程可以写成 $\\dot{q}_k = \\frac{\\partial H}{\\partial p_k}$ 和 $\\dot{p}_k = -\\frac{\\partial H}{\\partial q_k}$ 的形式，则该系统是哈密顿系统。对于这样的系统，相空间可压缩性为 $\\Lambda = \\sum_k \\left( \\frac{\\partial \\dot{q}_k}{\\partial q_k} + \\frac{\\partial \\dot{p}_k}{\\partial p_k} \\right) = \\sum_k \\left( \\frac{\\partial^2 H}{\\partial q_k \\partial p_k} - \\frac{\\partial^2 H}{\\partial p_k \\partial q_k} \\right) = 0$。\n在当前问题中，动力学不是纯粹哈密顿的。运动方程包含一个耗散阻力 $- \\gamma(|\\mathbf{r}_i|) \\mathbf{p}_i$，它不能从一个标量势（哈密顿量）导出。我们的计算表明，这个非哈密顿项是可压缩性不为零的唯一原因。具体来说，此项关于动量的散度 $\\nabla_{\\mathbf{p}_i} \\cdot (-\\gamma \\mathbf{p}_i) = -d\\gamma$ 使得 $\\Lambda$ 不为零。这表明相空间体积不守恒；它以由耗散决定的速率收缩。这是由确定性方程描述的耗散系统的一个普遍特征。\n\n最后，问题要求的是无量纲可压缩性 $\\hat{\\Lambda} \\equiv \\frac{\\Lambda}{\\gamma_0}$：\n$$\n\\hat{\\Lambda} = \\frac{1}{\\gamma_0} \\left( -d \\gamma_0 \\sum_{i=1}^{N} \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right) \\right)\n$$\n$$\n\\hat{\\Lambda} = -d \\sum_{i=1}^{N} \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right)\n$$\n这是最终的表达式，用指定的变量表示。它通过哑铃连接矢量集合 $\\{\\mathbf{r}_i\\}$ 依赖于系统的微观状态。",
            "answer": "$$\n\\boxed{-d \\sum_{i=1}^{N} \\left( 1 + \\alpha |\\mathbf{r}_i|^2 \\right)}\n$$"
        },
        {
            "introduction": "在分子模拟中，一个核心挑战是如何在保持确定性动力学的同时，模拟与大热浴接触的小系统（即正则系综）。Nose-Hoover 恒温器通过扩展相空间巧妙地解决了这个问题。本练习将通过计算从“扩展”变量到“物理”变量的坐标变换的雅可比行列式，让你亲身体验正则系综的正确统计特性是如何从这个精巧的哈密顿式构造中恢复出来的。",
            "id": "4098576",
            "problem": "考虑一个粗粒化复杂流体，其模型为在 $d$ 维空间中的 $N$ 个相同的球形珠子。设其位置为 $\\{ \\boldsymbol{q}_i \\}_{i=1}^{N}$，其中 $\\boldsymbol{q}_i \\in \\mathbb{R}^d$，共轭动量为 $\\{ \\boldsymbol{p}_i \\}_{i=1}^{N}$，其中 $\\boldsymbol{p}_i \\in \\mathbb{R}^d$。使用 Nosé 型恒温器引入一个扩展相空间：一个标量恒温器坐标 $s > 0$ 及其共轭动量 $p_s \\in \\mathbb{R}$。用 $D = N d$ 表示动量分量的总数。扩展哈密顿量为\n$$\nH_{\\text{ext}}(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s) = \\sum_{i=1}^{N} \\frac{|\\boldsymbol{p}_i|^2}{2 m s^2} + U(\\boldsymbol{q}) + \\frac{p_s^2}{2 Q} + g k_B T \\ln s,\n$$\n其中 $m$ 是珠子质量，$Q$ 是恒温器惯量，$U(\\boldsymbol{q})$ 是复杂流体的构型势能，$k_B$ 是玻尔兹曼常数，$T$ 是目标温度，$g$ 是一个无量纲参数。\n\n定义从扩展变量 $(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s)$到物理变量 $(\\boldsymbol{q}, \\boldsymbol{P}, s, p_s)$的变换，保持位置 $\\boldsymbol{q}$、恒温器变量 $s$ 和 $p_s$ 不变，并根据以下方式重新标度动量\n$$\n\\boldsymbol{P}_i = \\frac{\\boldsymbol{p}_i}{s}, \\quad i = 1, \\dots, N.\n$$\n仅使用相空间映射的基本定义、链式法则以及哈密顿动力学的刘维尔定理，计算雅可比行列式\n$$\nJ(s) = \\det \\left( \\frac{\\partial(\\boldsymbol{q}, \\boldsymbol{P}, s, p_s)}{\\partial(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s)} \\right)\n$$\n以 $s$ 和 $D$ 的函数形式给出其闭合形式。\n\n然后，从计算出的 $J(s)$ 以及扩展相空间中的不变测度在扩展哈密顿流下保持不变的要求出发，讨论此变换对物理变量 $(\\boldsymbol{q}, \\boldsymbol{P})$ 中不变测度的影响。特别地，指出参数 $g$ 在恢复 $(\\boldsymbol{q}, \\boldsymbol{P})$ 的正则不变测度中所起的作用。\n\n你的最终答案必须是 $J(s)$ 的解析表达式，不带单位。无需四舍五入。",
            "solution": "该问题要求计算一个相空间变换的雅可比行列式，并讨论其在 Nosé 恒温器模型中对不变测度的影响。\n\n**第 1 部分：雅可比行列式的计算**\n\n该变换是从扩展相空间变量 $(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s)$ 到物理变量 $(\\boldsymbol{q}, \\boldsymbol{P}, s, p_s)$。坐标集由 $\\boldsymbol{q} = \\{ \\boldsymbol{q}_i \\}_{i=1}^{N}$、$\\boldsymbol{p} = \\{ \\boldsymbol{p}_i \\}_{i=1}^{N}$ 和 $\\boldsymbol{P} = \\{ \\boldsymbol{P}_i \\}_{i=1}^{N}$ 给出，其中 $\\boldsymbol{q}_i, \\boldsymbol{p}_i, \\boldsymbol{P}_i \\in \\mathbb{R}^d$。动量分量的总数为 $D = N d$。相空间的总维度为 $2Nd + 2 = 2D + 2$。\n\n该变换定义如下：\n1.  $\\boldsymbol{q}_i' = \\boldsymbol{q}_i$，$i=1, \\dots, N$。（位置矢量不变）。\n2.  $\\boldsymbol{P}_i = \\frac{\\boldsymbol{p}_i}{s}$，$i=1, \\dots, N$。（动量矢量被重新标度）。\n3.  $s' = s$。（恒温器坐标不变）。\n4.  $p_s' = p_s$。（恒温器动量不变）。\n\n我们需要计算雅可比行列式 $J(s) = \\det \\left( \\frac{\\partial(\\boldsymbol{q}, \\boldsymbol{P}, s, p_s)}{\\partial(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s)} \\right)$。雅可比矩阵，记为 $\\boldsymbol{M}$，由新变量相对于旧变量的偏导数块组成。\n设旧坐标的有序集合为 $X = (\\boldsymbol{q}_1, \\dots, \\boldsymbol{q}_N, \\boldsymbol{p}_1, \\dots, \\boldsymbol{p}_N, s, p_s)$，新坐标为 $Y = (\\boldsymbol{q}_1, \\dots, \\boldsymbol{q}_N, \\boldsymbol{P}_1, \\dots, \\boldsymbol{P}_N, s, p_s)$。雅可比矩阵为：\n$$\n\\boldsymbol{M} = \\frac{\\partial Y}{\\partial X} = \\begin{pmatrix}\n\\frac{\\partial \\boldsymbol{q}}{\\partial \\boldsymbol{q}}  \\frac{\\partial \\boldsymbol{q}}{\\partial \\boldsymbol{p}}  \\frac{\\partial \\boldsymbol{q}}{\\partial s}  \\frac{\\partial \\boldsymbol{q}}{\\partial p_s} \\\\\n\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{q}}  \\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}  \\frac{\\partial \\boldsymbol{P}}{\\partial s}  \\frac{\\partial \\boldsymbol{P}}{\\partial p_s} \\\\\n\\frac{\\partial s}{\\partial \\boldsymbol{q}}  \\frac{\\partial s}{\\partial \\boldsymbol{p}}  \\frac{\\partial s}{\\partial s}  \\frac{\\partial s}{\\partial p_s} \\\\\n\\frac{\\partial p_s}{\\partial \\boldsymbol{q}}  \\frac{\\partial p_s}{\\partial \\boldsymbol{p}}  \\frac{\\partial p_s}{\\partial s}  \\frac{\\partial p_s}{\\partial p_s}\n\\end{pmatrix}\n$$\n我们来计算每个块：\n- $\\frac{\\partial \\boldsymbol{q}}{\\partial \\boldsymbol{q}}$: 由于 $\\boldsymbol{q}'_i = \\boldsymbol{q}_i$，这是一个 $D \\times D$ 的单位矩阵 $\\boldsymbol{I}_D$。\n- $\\frac{\\partial \\boldsymbol{q}}{\\partial \\boldsymbol{p}} = \\boldsymbol{0}$，$\\frac{\\partial \\boldsymbol{q}}{\\partial s} = \\boldsymbol{0}$，$\\frac{\\partial \\boldsymbol{q}}{\\partial p_s} = \\boldsymbol{0}$，因为 $\\boldsymbol{q}'$ 不依赖于 $\\boldsymbol{p}$、$s$ 或 $p_s$。\n- $\\frac{\\partial s}{\\partial \\boldsymbol{q}} = \\boldsymbol{0}$，$\\frac{\\partial s}{\\partial \\boldsymbol{p}} = \\boldsymbol{0}$，$\\frac{\\partial s}{\\partial p_s} = 0$，因为 $s'$ 只依赖于 $s$。\n- $\\frac{\\partial s}{\\partial s} = 1$。\n- $\\frac{\\partial p_s}{\\partial \\boldsymbol{q}} = \\boldsymbol{0}$，$\\frac{\\partial p_s}{\\partial \\boldsymbol{p}} = \\boldsymbol{0}$，$\\frac{\\partial p_s}{\\partial s} = 0$，因为 $p_s'$ 只依赖于 $p_s$。\n- $\\frac{\\partial p_s}{\\partial p_s} = 1$。\n- $\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{q}} = \\boldsymbol{0}$ 和 $\\frac{\\partial \\boldsymbol{P}}{\\partial p_s} = \\boldsymbol{0}$，因为 $\\boldsymbol{P}$ 只依赖于 $\\boldsymbol{p}$ 和 $s$。\n\n雅可比矩阵简化为一个块对角（或更准确地说，块三角）结构：\n$$\n\\boldsymbol{M} = \\begin{pmatrix}\n\\boldsymbol{I}_D  \\boldsymbol{0}  \\boldsymbol{0}  \\boldsymbol{0} \\\\\n\\boldsymbol{0}  \\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}  \\frac{\\partial \\boldsymbol{P}}{\\partial s}  \\boldsymbol{0} \\\\\n\\boldsymbol{0}  \\boldsymbol{0}  1  0 \\\\\n\\boldsymbol{0}  \\boldsymbol{0}  0  1\n\\end{pmatrix}\n$$\n块三角矩阵的行列式是其对角块行列式的乘积。\n$$\nJ(s) = \\det(\\boldsymbol{M}) = \\det(\\boldsymbol{I}_D) \\cdot \\det\\left(\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}\\right) \\cdot \\det(1) \\cdot \\det(1) = \\det\\left(\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}\\right)\n$$\n现在，我们计算块 $\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}$ 的行列式。这是一个 $D \\times D$ 矩阵。变换为 $\\boldsymbol{P}_i = \\boldsymbol{p}_i/s$。我们来考虑其分量。设 $\\boldsymbol{P}_i = (P_{i,1}, \\dots, P_{i,d})$ 和 $\\boldsymbol{p}_k = (p_{k,1}, \\dots, p_{k,d})$。偏导数为：\n$$\n\\frac{\\partial P_{i,j}}{\\partial p_{k,l}} = \\frac{\\partial}{\\partial p_{k,l}} \\left( \\frac{p_{i,j}}{s} \\right) = \\frac{1}{s} \\delta_{ik} \\delta_{jl}\n$$\n其中 $\\delta$ 是克罗内克 δ。这表明矩阵 $\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}$ 是一个对角矩阵。其所有对角元都等于 $1/s$，所有非对角元都为零。\n$$\n\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}} = \\frac{1}{s} \\boldsymbol{I}_D\n$$\n这个 $D \\times D$ 对角矩阵的行列式是其对角元的乘积：\n$$\n\\det\\left(\\frac{\\partial \\boldsymbol{P}}{\\partial \\boldsymbol{p}}\\right) = \\left(\\frac{1}{s}\\right)^D = s^{-D}\n$$\n因此，雅可比行列式为 $J(s) = s^{-D}$。\n\n**第 2 部分：对不变测度的影响及 $g$ 的作用**\n\n扩展相空间 $(\\boldsymbol{q}, \\boldsymbol{p}, s, p_s)$ 中的动力学由哈密顿量 $H_{\\text{ext}}$ 控制。根据刘维尔定理，相空间体积元 $d\\Gamma_{\\text{ext}} = d\\boldsymbol{q} \\, d\\boldsymbol{p} \\, ds \\, dp_s$ 沿着轨迹是守恒的。对于总能量为 $E$ 的扩展系统的微正则系综，不变概率测度正比于 $\\delta(H_{\\text{ext}} - E) \\, d\\Gamma_{\\text{ext}}$。\n\n为了理解物理子系统 $(\\boldsymbol{q}, \\boldsymbol{P})$ 的统计特性，我们必须将此测度变换到物理变量下。体积元根据规则 $d\\boldsymbol{q} \\, d\\boldsymbol{p} \\, ds \\, dp_s = |J(s)|^{-1} \\, d\\boldsymbol{q} \\, d\\boldsymbol{P} \\, ds \\, dp_s$ 进行变换。由于 $J(s) = s^{-D}$ 且 $s > 0$，我们有：\n$$\nd\\Gamma_{\\text{ext}} = s^D \\, d\\boldsymbol{q} \\, d\\boldsymbol{P} \\, ds \\, dp_s\n$$\n扩展哈密顿量也可以用新变量表示。当 $\\boldsymbol{p}_i = s \\boldsymbol{P}_i$ 时，动能项变为：\n$$\n\\sum_{i=1}^{N} \\frac{|\\boldsymbol{p}_i|^2}{2 m s^2} = \\sum_{i=1}^{N} \\frac{|s \\boldsymbol{P}_i|^2}{2 m s^2} = \\sum_{i=1}^{N} \\frac{s^2 |\\boldsymbol{P}_i|^2}{2 m s^2} = \\sum_{i=1}^{N} \\frac{|\\boldsymbol{P}_i|^2}{2 m} = K(\\boldsymbol{P})\n$$\n这是物理系统的标准动能。令 $H_0(\\boldsymbol{q}, \\boldsymbol{P}) = K(\\boldsymbol{P}) + U(\\boldsymbol{q})$ 为物理哈密顿量。扩展哈密顿量为：\n$$\nH_{\\text{ext}} = H_0(\\boldsymbol{q}, \\boldsymbol{P}) + \\frac{p_s^2}{2 Q} + g k_B T \\ln s\n$$\n找到物理系统处于状态 $(\\boldsymbol{q}, \\boldsymbol{P})$ 的概率，是通过对完整的微正则分布关于恒温器变量 $s$ 和 $p_s$ 进行边缘化得到的：\n$$\nP(\\boldsymbol{q}, \\boldsymbol{P}) \\propto \\int_0^\\infty ds \\int_{-\\infty}^\\infty dp_s \\, s^D \\, \\delta\\left(H_0(\\boldsymbol{q}, \\boldsymbol{P}) + \\frac{p_s^2}{2 Q} + g k_B T \\ln s - E\\right)\n$$\n我们来计算这个积分。令 $E' = E - H_0(\\boldsymbol{q}, \\boldsymbol{P})$。积分为：\n$$\nI(H_0) = \\int_0^\\infty ds \\, s^D \\int_{-\\infty}^\\infty dp_s \\, \\delta\\left(\\frac{p_s^2}{2Q} + g k_B T \\ln s - E'\\right)\n$$\n首先对 $p_s$ 进行积分，我们令 $C(s) = E' - g k_B T \\ln s$。积分 $\\int \\delta(\\frac{p_s^2}{2Q} - C(s)) dp_s$ 仅在 $C(s) > 0$ 时非零。其值为 $\\sqrt{2Q/C(s)}$。\n$$\nI(H_0) \\propto \\int_0^{\\exp(E'/(g k_B T))} ds \\, \\frac{s^D}{\\sqrt{E' - g k_B T \\ln s}}\n$$\n我们进行变量替换：$v = E' - g k_B T \\ln s$。则 $s = \\exp((E' - v) / (g k_B T))$ 且 $ds = s \\cdot (-dv / (g k_B T)) = -\\exp((E'-v)/(g k_B T)) \\frac{dv}{g k_B T}$。$v$ 的积分限为从 $0$ 到 $\\infty$。\n$$\nI(H_0) \\propto \\int_\\infty^0 dv \\, \\frac{\\exp\\left(D \\frac{E' - v}{g k_B T}\\right)}{\\sqrt{v}} \\left(-\\exp\\left(\\frac{E'-v}{g k_B T}\\right) \\frac{1}{g k_B T}\\right)\n$$\n$$\nI(H_0) \\propto \\frac{1}{g k_B T} \\int_0^\\infty dv \\, v^{-1/2} \\exp\\left((D+1)\\frac{E' - v}{g k_B T}\\right)\n$$\n$$\nI(H_0) \\propto \\exp\\left(\\frac{(D+1)E'}{g k_B T}\\right) \\int_0^\\infty dv \\, v^{-1/2} \\exp\\left(-\\frac{(D+1)v}{g k B T}\\right)\n$$\n该积分是一个不依赖于 $H_0$ 的常数。它是一个经过适当缩放的 Gamma 函数 $\\Gamma(1/2)$。因此，物理系统的概率分布由指数前因子决定。代回 $E' = E - H_0$：\n$$\nP(\\boldsymbol{q}, \\boldsymbol{P}) \\propto I(H_0) \\propto \\exp\\left(\\frac{(D+1)(E-H_0)}{g k_B T}\\right) \\propto \\exp\\left(-\\frac{D+1}{g} \\frac{H_0}{k_B T}\\right)\n$$\nNosé 恒温器的目标是为目标温度为 $T$ 的物理系统生成一个正则系综。正则系综的概率分布为 $P_{\\text{canon}}(\\boldsymbol{q}, \\boldsymbol{P}) \\propto \\exp(-H_0 / (k_B T))$。\n为使生成的分布与期望的正则分布相匹配，指数必须相等：\n$$\n-\\frac{D+1}{g} \\frac{H_0}{k_B T} = - \\frac{H_0}{k_B T} \\quad \\implies \\quad \\frac{D+1}{g} = 1\n$$\n这给出了参数 $g$ 所需的值：\n$$\ng = D + 1 = Nd + 1\n$$\n因此，$g$ 的作用是确保为物理系统恢复正确的统计权重。它必须被选择为等于物理系统的动能自由度数（$D=Nd$）加上一（来自恒温器自身的动能项 $p_s^2/2Q$），以使扩展相空间上的微正则平均等价于物理相空间上的正则平均。由动量变换产生的雅可比因子 $s^D$ 被从恒温器势能中出现的项 $\\exp(-g k_B T \\ln s / (k_B T_?)) = s^{-g}$ 的一部分精确抵消，在正确选择 $g$ 的情况下，从而产生正则分布。",
            "answer": "$$\\boxed{s^{-D}}$$"
        },
        {
            "introduction": "相空间和刘维尔方程的威力在于它们能够连接微观动力学与宏观可观测量。过渡态理论 (Transition State Theory, TST) 正是利用相空间中的概率流来计算化学反应速率，从而完美体现了这一连接。在本练习中，你将运用平衡态统计力学和相空间通量的概念，推导出一个活化过程的速率常数，这是理解复杂流体中结构重排和化学反应动力学的基础。",
            "id": "4098574",
            "problem": "考虑一个复杂流体中激活的微观结构重排的粗粒化哈密顿量描述，该过程由单个集体反应坐标 $x$（其共轭动量为 $p_x$，有效质量为 $m$）解析，并与 $N_b$ 个独立的谐波浴坐标 $y_i$（其共轭动量为 $p_i$，质量为 $m_i$，其中 $i=1,\\dots,N_b$）耦合。该系统与绝对温度为 $T$ 的热库接触，并通过相空间中的正则系综平衡密度来描述。相空间中的分界面取为超平面 $x=0$，反应物盆 $A$ 定义为 $x<0$，产物盆 $B$ 定义为 $x>0$。在反应物极小值 $x \\approx x_A < 0$ 附近和鞍点（势垒顶点）$x=0$ 附近，势能可以很好地用以下二次型近似：\n- 在盆 $A$ 中： $U(x,\\{y_i\\}) \\approx U_A + \\frac{1}{2}\\kappa_A (x-x_A)^2 + \\sum_{i=1}^{N_b} \\frac{1}{2}\\kappa_i^{A} y_i^2$，\n- 在鞍点处： $U(x,\\{y_i\\}) \\approx U^{\\ddagger} - \\frac{1}{2}\\kappa^{\\ddagger} x^2 + \\sum_{i=1}^{N_b} \\frac{1}{2}\\kappa_i^{\\ddagger} y_i^2$，\n其中 $U_A$ 是极小值处的势能，$U^{\\ddagger}$ 是鞍点处的势能，$\\kappa_A>0$ 是在盆 $A$ 中沿 $x$ 方向的曲率，$\\kappa^{\\ddagger}>0$ 是在鞍点处沿 $x$ 方向的不稳定曲率的大小（因此在鞍点处沿 $x$ 方向的曲率为 $-\\kappa^{\\ddagger}$），而 $\\kappa_i^{A}>0$、$\\kappa_i^{\\ddagger}>0$ 分别是盆 $A$ 中和鞍点处浴坐标的稳定横向曲率。假设哈密顿量是可分离的，\n$$\nH(\\Gamma) \\equiv \\frac{p_x^2}{2m} + U(x,\\{y_i\\}) + \\sum_{i=1}^{N_b} \\frac{p_i^2}{2m_i},\n$$\n并令 $\\beta \\equiv 1/(k_B T)$，其中 $k_B$ 是玻尔兹曼常数。\n\n使用关于稳态正则密度的Liouville方程和相空间中概率流的定义，从 $A$ 到 $B$ 穿过分界面 $x=0$ 的净概率通量 $\\mathcal{J}_{A\\to B}$ 可以写成一个涉及速度 $\\dot{x}$ 的相空间积分。将反应速率常数 $k$ 定义为此通量与系统处于盆 $A$ 中的平衡概率 $P_A$ 的比值。\n\n在所述的谐波近似和正则分布下，推导 $k$ 的一个闭合解析表达式，该表达式用 $\\beta$、势垒高度 $\\Delta U \\equiv U^{\\ddagger}-U_A$、曲率 $\\kappa_A$、$\\kappa_i^{A}$、$\\kappa_i^{\\ddagger}$ 和质量 $m$ 来表示。将您的最终答案表示为单个解析表达式。不需要进行数值计算或四舍五入。",
            "solution": "该问题要求推导复杂流体中微观结构重排的速率常数 $k$。该系统由一个反应坐标 $x$ 和一组 $N_b$ 个独立的浴坐标 $\\{y_i\\}$ 描述。速率常数定义为从反应物盆 $A$ ($x<0$) 到产物盆 $B$ ($x>0$) 的净概率通量 $\\mathcal{J}_{A\\to B}$ 与系统处于盆 $A$ 中的平衡概率 $P_A$ 的比值。\n$$k = \\frac{\\mathcal{J}_{A\\to B}}{P_A}$$\n分析将在经典过渡态理论 (TST) 的框架内进行，使用所提供的势能谐波近似。系统在温度 $T$ 下处于正则平衡，因此相空间概率密度为 $\\rho(\\Gamma) = Z^{-1} \\exp(-\\beta H(\\Gamma))$，其中 $\\Gamma$ 代表所有相空间坐标，$Z$ 是总配分函数，$\\beta = 1/(k_B T)$。\n\n首先，我们构造穿过分界面 $x=0$ 的概率通量 $\\mathcal{J}_{A\\to B}$。该通量是概率密度流 $\\rho \\dot{x}$ 在分界面上对朝向盆 $B$ 运动的粒子（即速度 $\\dot{x} = p_x/m > 0$）的积分。\n$$ \\mathcal{J}_{A\\to B} = \\int d^{N_b}y \\, d^{N_b}p \\, \\int_{-\\infty}^\\infty dp_x \\, \\int_{-\\infty}^\\infty dx \\, \\left(\\frac{p_x}{m}\\right) \\Theta(p_x) \\delta(x) \\rho(\\Gamma) $$\n其中 $\\Theta(p_x)$ 是亥维赛阶跃函数，确保 $p_x > 0$，而 $\\delta(x)$ 将积分局域化到分界面上。代入正则密度 $\\rho(\\Gamma)$，我们得到：\n$$ \\mathcal{J}_{A\\to B} = \\frac{1}{Z} \\int d^{N_b}y \\, d^{N_b}p \\int_0^\\infty dp_x \\, \\left(\\frac{p_x}{m}\\right) \\exp(-\\beta H(x=0, p_x, \\{y_i\\}, \\{p_i\\})) $$\n使用给定的可分离哈密顿量和鞍点（$x=0$）处的势能近似：\n$$ H(x=0, \\dots) = \\frac{p_x^2}{2m} + U^{\\ddagger} + \\sum_{i=1}^{N_b} \\frac{1}{2}\\kappa_i^{\\ddagger} y_i^2 + \\sum_{i=1}^{N_b} \\frac{p_i^2}{2m_i} $$\n通量的积分可以分解为独立积分的乘积。让我们考虑量 $Z \\mathcal{J}_{A\\to B}$：\n$$ Z \\mathcal{J}_{A\\to B} = \\left[ \\int_0^\\infty dp_x \\frac{p_x}{m} \\exp\\left(-\\frac{\\beta p_x^2}{2m}\\right) \\right] \\times \\exp(-\\beta U^{\\ddagger}) \\times \\left[ \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dy_i \\exp\\left(-\\frac{\\beta \\kappa_i^{\\ddagger}}{2} y_i^2\\right) \\right] \\times \\left[ \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dp_i \\exp\\left(-\\frac{\\beta p_i^2}{2m_i}\\right) \\right] $$\n让我们计算这些积分。关于 $p_x$ 的积分是：\n$$ \\int_0^\\infty \\frac{p_x}{m} \\exp\\left(-\\frac{\\beta p_x^2}{2m}\\right) dp_x = \\left[-\\frac{1}{\\beta} \\exp\\left(-\\frac{\\beta p_x^2}{2m}\\right)\\right]_0^\\infty = \\frac{1}{\\beta} $$\n剩余的积分构成了过渡态的配分函数，该配分函数局限于分界面且排除了反应坐标自由度。我们称之为 $Z^{\\ddagger}$：\n$$ Z^{\\ddagger} = \\exp(-\\beta U^{\\ddagger}) \\left( \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dy_i \\exp\\left(-\\frac{\\beta \\kappa_i^{\\ddagger}}{2} y_i^2\\right) \\right) \\left( \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dp_i \\exp\\left(-\\frac{\\beta p_i^2}{2m_i}\\right) \\right) $$\n高斯积分的计算结果为：\n$$ \\int_{-\\infty}^\\infty \\exp(-ax^2)dx = \\sqrt{\\frac{\\pi}{a}} $$\n因此，$\\int_{-\\infty}^\\infty dy_i \\dots = \\sqrt{\\frac{2\\pi}{\\beta \\kappa_i^{\\ddagger}}}$ 并且 $\\int_{-\\infty}^\\infty dp_i \\dots = \\sqrt{\\frac{2\\pi m_i}{\\beta}}$。\n因此，通量由下式给出：\n$$ Z \\mathcal{J}_{A\\to B} = \\frac{1}{\\beta} Z^{\\ddagger} $$\n\n接下来，我们计算处于盆 $A$ 中的平衡概率 $P_A$。在 TST 中，这近似为 $P_A = Z_A / Z$，其中 $Z_A$ 是反应物态的配分函数，通过在整个相空间上使用近似反应物势阱的谐波势进行积分来计算。\n$$ Z_A = \\int d\\Gamma \\exp(-\\beta H_A(\\Gamma)) $$\n所用的哈密顿量为：\n$$ H_A(\\Gamma) \\approx \\frac{p_x^2}{2m} + U_A + \\frac{1}{2}\\kappa_A (x-x_A)^2 + \\sum_{i=1}^{N_b} \\left( \\frac{1}{2}\\kappa_i^{A} y_i^2 + \\frac{p_i^2}{2m_i} \\right) $$\n那么配分函数 $Z_A$ 是：\n$$ Z_A = \\exp(-\\beta U_A) \\left[ \\int_{-\\infty}^\\infty dx \\exp\\left(-\\frac{\\beta\\kappa_A}{2}(x-x_A)^2\\right) \\right] \\left[ \\int_{-\\infty}^\\infty dp_x \\exp\\left(-\\frac{\\beta p_x^2}{2m}\\right) \\right] \\times \\prod_{i=1}^{N_b} \\left[ \\int_{-\\infty}^\\infty dy_i \\dots \\right] \\left[ \\int_{-\\infty}^\\infty dp_i \\dots \\right] $$\n与反应坐标 $(x, p_x)$ 相关的积分是：\n$$ \\int_{-\\infty}^\\infty dx \\exp\\left(-\\frac{\\beta\\kappa_A}{2}x^2\\right) = \\sqrt{\\frac{2\\pi}{\\beta\\kappa_A}} $$\n$$ \\int_{-\\infty}^\\infty dp_x \\exp\\left(-\\frac{\\beta p_x^2}{2m}\\right) = \\sqrt{\\frac{2\\pi m}{\\beta}} $$\n剩余的积分定义了状态 $A$ 中浴模的配分函数，我们称之为 $Z_{A, \\text{bath}}$：\n$$ Z_{A, \\text{bath}} = \\exp(-\\beta U_A) \\left( \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dy_i \\exp\\left(-\\frac{\\beta \\kappa_i^{A}}{2} y_i^2\\right) \\right) \\left( \\prod_{i=1}^{N_b} \\int_{-\\infty}^\\infty dp_i \\exp\\left(-\\frac{\\beta p_i^2}{2m_i}\\right) \\right) $$\n所以，$Z_A$ 可以写为：\n$$ Z_A = \\sqrt{\\frac{2\\pi}{\\beta\\kappa_A}} \\sqrt{\\frac{2\\pi m}{\\beta}} Z_{A, \\text{bath}} = \\frac{2\\pi}{\\beta} \\sqrt{\\frac{m}{\\kappa_A}} Z_{A, \\text{bath}} $$\n\n现在我们可以计算速率常数 $k$：\n$$ k = \\frac{\\mathcal{J}_{A\\to B}}{P_A} = \\frac{Z \\mathcal{J}_{A\\to B}}{Z_A} = \\frac{(1/\\beta) Z^{\\ddagger}}{\\left( \\frac{2\\pi}{\\beta} \\sqrt{\\frac{m}{\\kappa_A}} \\right) Z_{A, \\text{bath}}} $$\n$$ k = \\frac{1}{2\\pi} \\sqrt{\\frac{\\kappa_A}{m}} \\frac{Z^{\\ddagger}}{Z_{A, \\text{bath}}} $$\n项 $\\frac{1}{2\\pi} \\sqrt{\\frac{\\kappa_A}{m}}$ 是反应物势阱中反应坐标的谐振频率。\n\n最后，我们计算配分函数之比 $Z^{\\ddagger}/Z_{A, \\text{bath}}$。\n$$ \\frac{Z^{\\ddagger}}{Z_{A, \\text{bath}}} = \\frac{\\exp(-\\beta U^{\\ddagger}) \\prod_{i=1}^{N_b} \\left(\\sqrt{\\frac{2\\pi}{\\beta \\kappa_i^{\\ddagger}}} \\sqrt{\\frac{2\\pi m_i}{\\beta}}\\right)}{\\exp(-\\beta U_A) \\prod_{i=1}^{N_b} \\left(\\sqrt{\\frac{2\\pi}{\\beta \\kappa_i^{A}}} \\sqrt{\\frac{2\\pi m_i}{\\beta}}\\right)} $$\n许多项都消掉了，包括浴质量 $m_i$ 和因子 $2\\pi/\\beta$：\n$$ \\frac{Z^{\\ddagger}}{Z_{A, \\text{bath}}} = \\exp(-\\beta(U^{\\ddagger} - U_A)) \\frac{\\prod_{i=1}^{N_b} \\sqrt{1/\\kappa_i^{\\ddagger}}}{\\prod_{i=1}^{N_b} \\sqrt{1/\\kappa_i^{A}}} = \\exp(-\\beta \\Delta U) \\prod_{i=1}^{N_b} \\sqrt{\\frac{\\kappa_i^A}{\\kappa_i^\\ddagger}} $$\n其中 $\\Delta U = U^{\\ddagger}-U_A$ 是势能垒高度。\n\n将此比值代回到 $k$ 的表达式中，得到最终结果：\n$$ k = \\frac{1}{2\\pi} \\sqrt{\\frac{\\kappa_A}{m}} \\exp(-\\beta \\Delta U) \\prod_{i=1}^{N_b} \\sqrt{\\frac{\\kappa_i^A}{\\kappa_i^\\ddagger}} $$\n这就是多维谐波过渡态理论速率常数。",
            "answer": "$$\\boxed{\\frac{1}{2\\pi} \\sqrt{\\frac{\\kappa_A}{m}} \\left( \\prod_{i=1}^{N_b} \\sqrt{\\frac{\\kappa_i^{A}}{\\kappa_i^{\\ddagger}}} \\right) \\exp(-\\beta \\Delta U)}$$"
        }
    ]
}