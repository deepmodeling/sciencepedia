{
    "hands_on_practices": [
        {
            "introduction": "The fundamental promise of the Volume of Fluid (VOF) method is its ability to ensure mass (or volume) conservation. This exercise strips the method down to its core, focusing on the pure advection of the volume fraction field $\\alpha$. By deriving the discrete update equation from the integral conservation law and applying a simple upwind scheme, you will see firsthand how the finite volume formulation naturally and exactly conserves the total volume of the tracked fluid, a critical property for the physical realism of any multiphase simulation .",
            "id": "4111784",
            "problem": "Consider a one-dimensional, periodic domain of length $L=1$ m with uniform cross-sectional area $A=1$ m$^{2}$, discretized into $N=4$ control volumes (cells) of equal width $\\Delta x = L/N$. A passive interface is tracked using the Volume of Fluid (VOF) method, where the cell-averaged volume fraction $\\alpha_{i}$ satisfies a pure advection conservation law. The prescribed velocity field is constant, $u(x,t) = U = 0.75$ m/s, for all $x$ and all $t$, and is divergence-free. At time $t^{n}$, the initial volume fraction field is piecewise constant per cell, with $\\alpha_{1}^{n} = 1$, $\\alpha_{2}^{n} = 1$, $\\alpha_{3}^{n} = 0$, and $\\alpha_{4}^{n} = 0$, and periodic indexing applies (so that $\\alpha_{0}^{n} \\equiv \\alpha_{4}^{n}$ and $\\alpha_{5}^{n} \\equiv \\alpha_{1}^{n}$). Over one time step $\\Delta t = 0.1$ s, compute the update of the volume fraction in cell $i=1$ by evaluating the face-integrated advective fluxes with piecewise constant reconstruction and upstream selection at faces (i.e., the advected $\\alpha$ at a face equals the cell value on the upstream side because $u>0$). Starting from the integral form of the conservation law and invoking the divergence theorem, derive the discrete balance that yields the updated $\\alpha_{1}^{n+1}$, and demonstrate that the discrete total $\\sum_{i=1}^{N} \\alpha_{i}$ is conserved exactly under the periodic boundary conditions and the stated flux evaluation. Report the final updated volume fraction $\\alpha_{1}^{n+1}$ as a dimensionless number (no units). No rounding is required; provide the exact value.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Domain length: $L=1$ m\n- Cross-sectional area: $A=1$ m$^{2}$\n- Number of control volumes (cells): $N=4$\n- Cell width: $\\Delta x = L/N$\n- Fluid property: Passive interface tracked by Volume of Fluid (VOF) method\n- VOF variable: Cell-averaged volume fraction $\\alpha_{i}$\n- Governing equation: Pure advection conservation law\n- Velocity field: $u(x,t) = U = 0.75$ m/s (constant)\n- Divergence of velocity field: $\\nabla \\cdot \\mathbf{u} = 0$\n- Initial conditions at time $t^{n}$: $\\alpha_{1}^{n} = 1$, $\\alpha_{2}^{n} = 1$, $\\alpha_{3}^{n} = 0$, $\\alpha_{4}^{n} = 0$\n- Boundary conditions: Periodic, with $\\alpha_{0}^{n} \\equiv \\alpha_{4}^{n}$ and $\\alpha_{5}^{n} \\equiv \\alpha_{1}^{n}$\n- Time step: $\\Delta t = 0.1$ s\n- Numerical method: Piecewise constant reconstruction and upstream selection for advective fluxes\n- Task 1: Derive the discrete balance for $\\alpha_{1}^{n+1}$ starting from the integral conservation law.\n- Task 2: Demonstrate that the total discrete volume fraction $\\sum_{i=1}^{N} \\alpha_{i}$ is conserved.\n- Task 3: Compute the value of $\\alpha_{1}^{n+1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a well-defined exercise in computational fluid dynamics, specifically focused on the numerical solution of a one-dimensional linear advection equation using the finite volume method.\n- **Scientifically Grounded:** The problem is based on the fundamental principle of mass conservation, expressed as an advection equation, which is a cornerstone of fluid dynamics. The VOF method and the first-order upwind scheme (piecewise constant reconstruction with upstream selection) are standard and widely used numerical techniques.\n- **Well-Posed:** All necessary parameters ($L$, $N$, $A$, $U$, $\\Delta t$), initial conditions, boundary conditions, and the numerical scheme are explicitly provided. The setup allows for a unique, stable solution. The Courant number $C = U \\Delta t / \\Delta x = 0.3$ is less than $1$, satisfying the stability condition for this explicit scheme.\n- **Objective:** The language is precise and quantitative, with no subjective or ambiguous statements.\n\nThe problem contains no scientific fallacies, contradictions, or missing information. It represents a standard, formalizable problem in numerical methods for partial differential equations.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\nThe volume fraction $\\alpha$ for an incompressible flow (as implied by the divergence-free velocity field, $\\nabla \\cdot \\mathbf{u} = 0$) is governed by the pure advection conservation law:\n$$ \\frac{\\partial \\alpha}{\\partial t} + \\nabla \\cdot (\\mathbf{u} \\alpha) = 0 $$\nIn one dimension, with constant velocity $U$, this simplifies to:\n$$ \\frac{\\partial \\alpha}{\\partial t} + U \\frac{\\partial \\alpha}{\\partial x} = 0 $$\nTo derive the discrete balance as requested, we start from the integral form of the conservation law over a control volume $V_i = A \\Delta x$ (from face $i-1/2$ at $x_{i-1/2}$ to face $i+1/2$ at $x_{i+1/2}$) and over a time interval from $t^n$ to $t^{n+1}$.\n$$ \\int_{t^n}^{t^{n+1}} \\int_{V_i} \\left( \\frac{\\partial \\alpha}{\\partial t} + \\frac{\\partial (U\\alpha)}{\\partial x} \\right) dV dt = 0 $$\nwhere $dV = A dx$. Since $A$ is constant, we can write:\n$$ \\int_{t^n}^{t^{n+1}} \\int_{x_{i-1/2}}^{x_{i+1/2}} A \\left( \\frac{\\partial \\alpha}{\\partial t} + \\frac{\\partial (U\\alpha)}{\\partial x} \\right) dx dt = 0 $$\nApplying the divergence theorem (or the fundamental theorem of calculus in 1D) to the spatial integral of the advective term and swapping the order of integration for the time derivative term:\n$$ A \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\int_{t^n}^{t^{n+1}} \\frac{\\partial \\alpha}{\\partial t} dt \\right) dx + A \\int_{t^n}^{t^{n+1}} \\left[ (U\\alpha)_{x_{i+1/2}} - (U\\alpha)_{x_{i-1/2}} \\right] dt = 0 $$\nThe cell-averaged volume fraction is defined as $\\alpha_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\alpha(x,t) dx$. The first term becomes:\n$$ A \\int_{x_{i-1/2}}^{x_{i+1/2}} [\\alpha(x, t^{n+1}) - \\alpha(x, t^n)] dx = A \\Delta x (\\alpha_i^{n+1} - \\alpha_i^n) $$\nWe use an explicit Euler time integration for the flux term, evaluating the fluxes at time $t^n$:\n$$ A \\int_{t^n}^{t^{n+1}} \\left[ (U\\alpha)_{i+1/2} - (U\\alpha)_{i-1/2} \\right] dt \\approx A \\Delta t \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] $$\nCombining these terms yields the discrete balance equation:\n$$ A \\Delta x (\\alpha_i^{n+1} - \\alpha_i^n) + A \\Delta t \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] = 0 $$\nDividing by the constant volume $V_i = A \\Delta x$:\n$$ \\frac{\\alpha_i^{n+1} - \\alpha_i^n}{\\Delta t} + \\frac{(U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n}{\\Delta x} = 0 $$\nThis can be rearranged to solve for $\\alpha_i^{n+1}$:\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] $$\nThe problem specifies \"piecewise constant reconstruction and upstream selection\". Since the velocity $U = 0.75$ m/s is positive, the \"upstream\" direction is always from the cell with a smaller index. Therefore, the value of $\\alpha$ at any face is taken from the cell to its left:\n- At face $i-1/2$: $\\alpha_{i-1/2}^n = \\alpha_{i-1}^n$\n- At face $i+1/2$: $\\alpha_{i+1/2}^n = \\alpha_{i}^n$\nSubstituting these into the flux terms:\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ U\\alpha_{i}^n - U\\alpha_{i-1}^n \\right] $$\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) $$\nThis is the discrete update equation (first-order upwind scheme), derived as requested.\n\nNext, we demonstrate that the total discrete volume fraction is conserved. We sum the update equation over all cells, from $i=1$ to $N=4$:\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\left[ \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) \\right] $$\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\sum_{i=1}^{N} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) $$\nThe second sum on the right-hand side is a telescoping series:\n$$ \\sum_{i=1}^{N} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) = (\\alpha_1^n - \\alpha_0^n) + (\\alpha_2^n - \\alpha_1^n) + \\dots + (\\alpha_N^n - \\alpha_{N-1}^n) = \\alpha_N^n - \\alpha_0^n $$\nApplying the periodic boundary condition $\\alpha_0^n \\equiv \\alpha_N^n$:\n$$ \\alpha_N^n - \\alpha_0^n = \\alpha_N^n - \\alpha_N^n = 0 $$\nThus, the sum of flux differences is zero. The conservation equation becomes:\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} (0) = \\sum_{i=1}^{N} \\alpha_i^n $$\nThis demonstrates that the total amount of $\\alpha$ is conserved exactly for periodic boundary conditions.\n\nFinally, we compute the value of $\\alpha_{1}^{n+1}$. First, we calculate the required parameters:\n- Cell width: $\\Delta x = \\frac{L}{N} = \\frac{1 \\text{ m}}{4} = 0.25$ m\n- The dimensionless Courant number: $C = \\frac{U \\Delta t}{\\Delta x} = \\frac{(0.75 \\text{ m/s})(0.1 \\text{ s})}{0.25 \\text{ m}} = \\frac{0.075}{0.25} = 0.3$\n\nThe update equation for cell $i=1$ is:\n$$ \\alpha_{1}^{n+1} = \\alpha_{1}^n - C (\\alpha_{1}^n - \\alpha_{0}^n) $$\nUsing the periodic boundary condition, $\\alpha_{0}^n = \\alpha_{4}^n$. Substituting the given initial values:\n- $\\alpha_{1}^n = 1$\n- $\\alpha_{0}^n = \\alpha_{4}^n = 0$\n- $C = 0.3$\nWe can now calculate $\\alpha_{1}^{n+1}$:\n$$ \\alpha_{1}^{n+1} = 1 - 0.3 \\times (1 - 0) $$\n$$ \\alpha_{1}^{n+1} = 1 - 0.3 $$\n$$ \\alpha_{1}^{n+1} = 0.7 $$",
            "answer": "$$\\boxed{0.7}$$"
        },
        {
            "introduction": "After mastering the advection of the interface, the next step is to incorporate the dominant physics acting upon it: surface tension. This practice bridges the gap between the physical Young-Laplace law and its numerical implementation via the widely used Continuum Surface Force (CSF) method. By designing a numerical experiment to compute the pressure jump across a static droplet, you will gain practical experience in estimating curvature from a VOF field and verifying that the numerical model correctly reproduces fundamental interfacial physics .",
            "id": "4111830",
            "problem": "Consider a static circular droplet modeled in two spatial dimensions, with the fluid–gas interface represented by the Volume of Fluid (VOF) method (Volume of Fluid (VOF)). The governing interfacial physics is the balance of normal stress across a curved interface induced by surface tension. Starting from the standard jump condition derived from conservation of linear momentum at a fluid interface and the definition of curvature, derive the expected uniform pressure jump for a static circular droplet of radius $R$ in two dimensions and then design a numerical experiment to verify it within a specified tolerance using a VOF-consistent curvature estimate.\n\nThe derivation must begin from the following fundamental base:\n- The Young–Laplace relation for the pressure jump across an interface states that the jump in normal stress equals the surface tension coefficient multiplied by the total curvature. In two spatial dimensions, this yields $\\Delta p = \\sigma \\kappa$, where $\\sigma$ is the surface tension coefficient and $\\kappa$ is the scalar curvature of the interface.\n- For a circle in two dimensions, the scalar curvature is $\\kappa = \\frac{1}{R}$, where $R$ is the radius of the droplet.\n\nThe numerical experiment must be designed as follows:\n- Construct a square domain of side length $L_x = L_y$ discretized with a uniform Cartesian grid of $N_x \\times N_y$ cells. Place a circular droplet of radius $R$ at the center of the domain. Treat the VOF indicator function $C(x,y)$ as the characteristic function of the droplet phase, approximated on the grid. Compute a smoothed VOF field $C_s$ by applying a localized smoothing operator to $C$ to emulate practical VOF curvature computations.\n- Using a Continuum Surface Force (CSF) approach (Continuum Surface Force (CSF)), estimate the curvature by $\\kappa \\approx -\\nabla \\cdot \\left( \\frac{\\nabla C_s}{\\lVert \\nabla C_s \\rVert} \\right)$ computed via consistent central finite differences on the uniform grid. Restrict evaluation of $\\kappa$ to interface cells identified by a threshold on $C_s$, specifically those with $C_s \\in (c_{\\min}, c_{\\max})$ for prescribed bounds $c_{\\min}$ and $c_{\\max}$.\n- Form the numerical pressure jump $\\Delta p_i = \\sigma \\kappa_i$ for each interface cell $i$. The expected analytic pressure jump is $\\Delta p_{\\text{exact}} = \\frac{\\sigma}{R}$ in two dimensions. Compute the maximum absolute error $E_{\\max} = \\max_i \\lvert \\Delta p_i - \\Delta p_{\\text{exact}} \\rvert$ over interface cells and compare it against a given tolerance $\\tau$.\n- Your program must return a boolean indicating whether $E_{\\max} \\le \\tau$ for each test case. All pressures must be expressed in Pascals (SI units), and all distances in meters. Curvatures must be in $\\text{m}^{-1}$, so their product with $\\sigma$ yields Pascals.\n\nImplement the above for the following test suite that covers general cases and edge conditions:\n- Case $1$ (happy path): $R = 0.25$ $\\text{m}$, $\\sigma = 0.072$ $\\text{N}/\\text{m}$, $N_x = N_y = 256$, $L_x = L_y = 1.0$ $\\text{m}$, tolerance $\\tau = 0.10$ $\\text{Pa}$, smoothing standard deviation $\\varsigma = 1.0$ (in grid-cell units), interface bounds $(c_{\\min}, c_{\\max}) = (0.1, 0.9)$.\n- Case $2$ (small droplet near resolution limit): $R = 0.02$ $\\text{m}$, $\\sigma = 0.072$ $\\text{N}/\\text{m}$, $N_x = N_y = 256$, $L_x = L_y = 1.0$ $\\text{m}$, tolerance $\\tau = 1.00$ $\\text{Pa}$, $\\varsigma = 1.0$, $(c_{\\min}, c_{\\max}) = (0.1, 0.9)$.\n- Case $3$ (coarser grid): $R = 0.25$ $\\text{m}$, $\\sigma = 0.072$ $\\text{N}/\\text{m}$, $N_x = N_y = 64$, $L_x = L_y = 1.0$ $\\text{m}$, tolerance $\\tau = 0.20$ $\\text{Pa}$, $\\varsigma = 1.0$, $(c_{\\min}, c_{\\max}) = (0.1, 0.9)$.\n- Case $4$ (larger droplet): $R = 0.40$ $\\text{m}$, $\\sigma = 0.072$ $\\text{N}/\\text{m}$, $N_x = N_y = 128$, $L_x = L_y = 1.0$ $\\text{m}$, tolerance $\\tau = 0.10$ $\\text{Pa}$, $\\varsigma = 1.0$, $(c_{\\min}, c_{\\max}) = (0.1, 0.9)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_k$ is a boolean ($\\text{True}$ or $\\text{False}$) indicating whether the numerical experiment for case $k$ verifies the expected pressure jump within the specified tolerance. No other output is permitted.",
            "solution": "The problem requires the derivation of the pressure jump across a static, two-dimensional circular interface and the design and implementation of a numerical experiment to verify this result using a Volume of Fluid (VOF) based methodology.\n\n### Theoretical Derivation\n\nThe analysis begins with the fundamental principle of momentum conservation at a fluid-fluid interface. For a static fluid, the forces acting on the interface must be in equilibrium. This equilibrium is expressed by the Young-Laplace equation, which relates the pressure difference across the interface to the surface tension and the interface curvature.\n\nThe problem provides the specific form of the Young-Laplace relation for a two-dimensional interface:\n$$\n\\Delta p = \\sigma \\kappa\n$$\nHere, $\\Delta p = p_{\\text{in}} - p_{\\text{out}}$ is the pressure jump across the interface (pressure inside the droplet minus pressure outside), $\\sigma$ is the surface tension coefficient (a material property with units of force per unit length, e.g., $\\text{N}/\\text{m}$), and $\\kappa$ is the local curvature of the interface (with units of inverse length, e.g., $\\text{m}^{-1}$).\n\nFor a circle of radius $R$ in a two-dimensional plane, the curvature $\\kappa$ is constant at all points on its circumference and is given by the reciprocal of the radius:\n$$\n\\kappa = \\frac{1}{R}\n$$\nSubstituting this geometric definition of curvature for a circle into the Young-Laplace equation yields the expected constant pressure jump for a static, 2D circular droplet:\n$$\n\\Delta p_{\\text{exact}} = \\sigma \\left( \\frac{1}{R} \\right) = \\frac{\\sigma}{R}\n$$\nThis equation provides the analytical benchmark against which the numerical results will be compared. It establishes that for a static circular droplet, the pressure inside is uniformly higher than the pressure outside by an amount inversely proportional to its radius.\n\n### Numerical Verification Procedure\n\nThe numerical experiment aims to replicate the physical scenario on a discrete computational grid and calculate the pressure jump using methods common in multiphase flow simulations. The procedure is as follows:\n\n1.  **Domain and Grid Discretization**: A square computational domain of physical size $L_x \\times L_y$ is defined. This domain is discretized into a uniform Cartesian grid of $N_x \\times N_y$ computational cells. The grid spacing in each direction is therefore $\\Delta x = L_x / N_x$ and $\\Delta y = L_y / N_y$. Cell centers are located at coordinates $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ for $i=0, \\dots, N_x-1$ and $j=0, \\dots, N_y-1$ (with an appropriate offset for cell-centered schemes).\n\n2.  **VOF Field Initialization**: The interface is represented implicitly using a VOF indicator function, $C$. For a two-phase system, $C$ is defined as the fraction of a computational cell's volume occupied by one of the phases (e.g., the liquid droplet). For this problem, we initialize $C$ as a sharp characteristic function based on the geometry of the droplet. A circular droplet of radius $R$ centered at $(x_c, y_c)$ is placed on the grid. The value of $C$ at each cell center $(x_i, y_j)$ is set to $1$ if the cell is inside the droplet and $0$ if it is outside:\n    $$\n    C_{i,j} = \\begin{cases} 1  \\text{if } \\sqrt{(x_i - x_c)^2 + (y_j - y_c)^2} \\le R \\\\ 0  \\text{otherwise} \\end{cases}\n    $$\n\n3.  **VOF Field Smoothing**: The Continuum Surface Force (CSF) method requires a smooth field from which to compute derivatives. The sharp VOF field $C$ is convolved with a smoothing kernel, typically a Gaussian, to produce a smoothed field $C_s$. This process mimics the smearing of the interface over a few grid cells, which is a common feature of many VOF advection schemes. The extent of smoothing is controlled by the standard deviation of the kernel, $\\varsigma$, specified in units of grid cells.\n\n4.  **Curvature Estimation**: The curvature $\\kappa$ is estimated from the smoothed VOF field $C_s$. The interface normal vector, $\\mathbf{n}$, is first calculated as the normalized gradient of $C_s$:\n    $$\n    \\mathbf{n} = \\frac{\\nabla C_s}{\\lVert \\nabla C_s \\rVert}\n    $$\n    The curvature is then computed as the negative divergence of this normal vector field:\n    $$\n    \\kappa \\approx -\\nabla \\cdot \\mathbf{n}\n    $$\n    Both the gradient ($\\nabla$) and divergence ($\\nabla \\cdot$) operations are performed numerically using second-order central finite difference schemes on the discrete grid. For a cell $(i,j)$, the gradient components are approximated as:\n    $$\n    (\\nabla C_s)_x_ {i,j} \\approx \\frac{(C_s)_{i+1,j} - (C_s)_{i-1,j}}{2 \\Delta x}, \\quad (\\nabla C_s)_y_ {i,j} \\approx \\frac{(C_s)_{i,j+1} - (C_s)_{i,j-1}}{2 \\Delta y}\n    $$\n    A similar central difference scheme is used to compute the divergence of $\\mathbf{n}$. A small regularization parameter is added to the denominator $\\lVert \\nabla C_s \\rVert$ to prevent division by zero in regions where $C_s$ is constant.\n\n5.  **Error Analysis**: The numerical pressure jump, $\\Delta p_i$, is calculated at each grid cell $i$ using the estimated curvature: $\\Delta p_i = \\sigma \\kappa_i$. To perform a meaningful comparison, this calculation is restricted to the \"interfacial region,\" which is defined as the set of cells where the smoothed VOF field $C_s$ lies within a specified range $(c_{\\min}, c_{\\max})$. For each cell $i$ in this region, the absolute error is computed as $| \\Delta p_i - \\Delta p_{\\text{exact}} |$. The maximum of these errors over all interface cells is the primary metric for verification:\n    $$\n    E_{\\max} = \\max_{i \\in \\text{interface}} \\lvert \\Delta p_i - \\Delta p_{\\text{exact}} \\rvert\n    $$\n\n6.  **Verification**: The numerical scheme is considered to have passed the verification test for a given set of parameters if the maximum error $E_{\\max}$ does not exceed the prescribed tolerance $\\tau$:\n    $$\n    E_{\\max} \\le \\tau\n    $$\nThe implementation will apply this procedure to each of the four specified test cases, yielding a boolean result for each one.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import ndimage\n\ndef solve():\n    \"\"\"\n    Main function to run the VOF curvature verification experiment for all test cases.\n    \"\"\"\n    # (R, sigma, Nx, Ny, Lx, Ly, tau, varsigma, c_min, c_max)\n    test_cases = [\n        # Case 1 (happy path)\n        (0.25, 0.072, 256, 256, 1.0, 1.0, 0.10, 1.0, 0.1, 0.9),\n        # Case 2 (small droplet near resolution limit)\n        (0.02, 0.072, 256, 256, 1.0, 1.0, 1.00, 1.0, 0.1, 0.9),\n        # Case 3 (coarser grid)\n        (0.25, 0.072, 64, 64, 1.0, 1.0, 0.20, 1.0, 0.1, 0.9),\n        # Case 4 (larger droplet)\n        (0.40, 0.072, 128, 128, 1.0, 1.0, 0.10, 1.0, 0.1, 0.9),\n    ]\n\n    results = []\n    for R, sigma, Nx, Ny, Lx, Ly, tau, varsigma, c_min, c_max in test_cases:\n        # Calculate grid spacing\n        dx = Lx / Nx\n        dy = Ly / Ny\n\n        # Create coordinate grid\n        x_coords = np.linspace(dx / 2, Lx - dx / 2, Nx)\n        y_coords = np.linspace(dy / 2, Ly - dy / 2, Ny)\n        x, y = np.meshgrid(x_coords, y_coords)\n\n        # Center of the domain\n        cx, cy = Lx / 2.0, Ly / 2.0\n\n        # 1. Construct the sharp VOF indicator function C\n        C = np.zeros((Ny, Nx))\n        radius_sq = (x - cx)**2 + (y - cy)**2\n        C[radius_sq = R**2] = 1.0\n\n        # 2. Compute the smoothed VOF field Cs\n        # varsigma is given in grid-cell units, which is the expected format for ndimage.gaussian_filter\n        Cs = ndimage.gaussian_filter(C, sigma=varsigma)\n\n        # 3. Estimate curvature using the CSF method\n        \n        # Calculate gradient of Cs\n        # np.gradient returns [d/dy, d/dx] for a 2D array indexed by (y, x)\n        grad_y, grad_x = np.gradient(Cs, dy, dx)\n\n        # Calculate magnitude of the gradient\n        # Add a small epsilon to avoid division by zero\n        grad_mag = np.sqrt(grad_x**2 + grad_y**2)\n        epsilon = 1e-12\n\n        # Calculate the normal vector field n = grad(Cs) / |grad(Cs)|\n        nx = grad_x / (grad_mag + epsilon)\n        ny = grad_y / (grad_mag + epsilon)\n\n        # Calculate the divergence of the normal vector field\n        # div(n) = d(nx)/dx + d(ny)/dy\n        grad_ny_y, _ = np.gradient(ny, dy, dx)\n        _, grad_nx_x = np.gradient(nx, dy, dx)\n        div_n = grad_nx_x + grad_ny_y\n\n        # Curvature is the negative of the divergence\n        kappa = -div_n\n\n        # 4. Form the numerical pressure jump and compute error\n        \n        # Identify interface cells\n        interface_mask = (Cs  c_min)  (Cs  c_max)\n\n        # If no interface cells are found (e.g., in an extreme case), treat as failure.\n        if not np.any(interface_mask):\n            # This indicates an error, likely the droplet is too small or too large\n            # for the interface mask criteria to be met.\n            # An infinite error will always fail the tolerance check unless tau is also inf.\n            E_max = np.inf\n        else:\n            # Calculate numerical pressure jump only at interface cells\n            delta_p_numerical = sigma * kappa[interface_mask]\n            \n            # Calculate the exact analytic pressure jump\n            delta_p_exact = sigma / R\n            \n            # Compute the maximum absolute error\n            E_max = np.max(np.abs(delta_p_numerical - delta_p_exact))\n\n        # 5. Compare against tolerance\n        result = E_max = tau\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A successful VOF simulation is not only physically accurate but also numerically stable. This final practice addresses the crucial challenge of determining a stable time step for an explicit solver, a task that requires balancing constraints from multiple physical phenomena. You will derive and compare the time-step limits imposed by advection (the CFL condition), viscous diffusion, and the propagation of gravity-capillary waves, learning to identify which mechanism becomes the rate-limiting factor under different grid resolutions. This exercise synthesizes the concepts of advection and surface tension into a practical framework for designing robust simulations .",
            "id": "4111814",
            "problem": "A two-phase interface is tracked with the Volume of Fluid (VOF) method, where the volume fraction field $\\alpha(\\mathbf{x},t)$ satisfies the kinematic transport equation $\\,\\partial \\alpha/\\partial t + \\mathbf{u}\\cdot\\nabla \\alpha = 0\\,$, and the incompressible momentum equation for each phase is the Navier–Stokes equation with a Continuum Surface Force (CSF) for capillarity. The phases are a liquid and a gas, with densities $\\rho_{\\ell}$ and $\\rho_{g}$, dynamic viscosities $\\mu_{\\ell}$ and $\\mu_{g}$, and surface tension coefficient $\\sigma$. Gravity acts with acceleration $g$. The numerical scheme uses explicit forward-Euler time integration for all terms, first-order upwind advection for $\\alpha$, and a balanced CSF discretization for surface tension. The mesh is uniform and isotropic in three spatial dimensions, with cubic cells of edge length $\\Delta x$.\n\nYou are given the following material properties and numerical parameters:\n- Liquid density $\\rho_{\\ell} = 1100$ (SI units), gas density $\\rho_{g} = 1.2$ (SI units), liquid viscosity $\\mu_{\\ell} = 3.5\\times 10^{-3}$ (SI units), gas viscosity $\\mu_{g} = 1.8\\times 10^{-5}$ (SI units), surface tension $\\sigma = 0.055$ (SI units), gravity $g = 9.81$ (SI units).\n- Maximum resolved speed $\\|\\mathbf{u}\\|_{\\infty} = U_{\\max} = 0.3$ (SI units).\n- Two target grids: Regime A has $\\Delta x_{A} = 1.0\\times 10^{-4}$ (SI units); Regime B has $\\Delta x_{B} = 1.0\\times 10^{-5}$ (SI units).\n- Stability policy for explicit advection: the Courant–Friedrichs–Lewy (CFL) number (defined as $C = U_{\\max}\\Delta t/\\Delta x$) must satisfy $C \\leq C_{a}$ with $C_{a}=0.5$.\n- Temporal resolution policy for waves: resolve the fastest gravity–capillary wave (at the grid’s Nyquist wavenumber) with at least $m=4$ time steps per period.\n\nStarting from first principles, derive the stability constraints that bound the explicit time step $\\Delta t$ due to:\n1. Interface advection.\n2. Viscous diffusion of momentum.\n3. Gravity–capillary waves at a two-fluid interface, using the deep-interface dispersion relation and the highest resolvable spatial frequency on the grid.\n\nUse the fundamental bases:\n- The incompressible Navier–Stokes equations with CSF for capillarity.\n- The VOF transport equation for $\\alpha$.\n- The CFL condition for explicit advection.\n- Von Neumann stability analysis for explicit diffusion.\n- The gravity–capillary wave dispersion relation for two superposed deep fluids.\n\nCompute, for each regime (A and B), the maximum stable explicit time step $\\Delta t_{\\max}$ as the minimum of all derived constraints. Identify, for each regime, which physical mechanism is rate-limiting. Express your final numerical values of $\\Delta t_{\\max}$ in microseconds and round to three significant figures.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. All necessary data are provided, and the premises are consistent with established principles of computational fluid dynamics for multiphase flows. We may therefore proceed with the solution.\n\nThe maximum stable time step, $\\Delta t_{\\max}$, for the explicit numerical scheme must satisfy all stability constraints simultaneously. We will derive the constraints arising from interface advection, viscous diffusion, and gravity-capillary wave propagation. The effective maximum time step is the minimum of these individual constraints:\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{adv}, \\Delta t_{visc}, \\Delta t_{cap})\n$$\n\nWe are given the following parameters:\nLiquid density $\\rho_{\\ell} = 1100\\,\\mathrm{kg/m^3}$\nGas density $\\rho_{g} = 1.2\\,\\mathrm{kg/m^3}$\nLiquid viscosity $\\mu_{\\ell} = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\nGas viscosity $\\mu_{g} = 1.8\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\nSurface tension coefficient $\\sigma = 0.055\\,\\mathrm{N/m}$\nGravitational acceleration $g = 9.81\\,\\mathrm{m/s^2}$\nMaximum velocity $U_{\\max} = 0.3\\,\\mathrm{m/s}$\nAdvection CFL limit $C_{a} = 0.5$\nWave resolution factor $m = 4$\n\nRegime A cell size $\\Delta x_{A} = 1.0\\times 10^{-4}\\,\\mathrm{m}$\nRegime B cell size $\\Delta x_{B} = 1.0\\times 10^{-5}\\,\\mathrm{m}$\n\n**1. Advection Constraint ($\\Delta t_{adv}$)**\nThe advection of the volume fraction field $\\alpha$ is governed by the transport equation $\\partial \\alpha/\\partial t + \\mathbf{u}\\cdot\\nabla \\alpha = 0$. For an explicit first-order upwind scheme, the Courant–Friedrichs–Lewy (CFL) condition dictates the maximum time step to ensure stability. The problem defines the CFL number as $C = U_{\\max}\\Delta t/\\Delta x$ and requires $C \\le C_{a}$. This gives the advection time step constraint:\n$$\n\\Delta t_{adv} \\le \\frac{C_{a} \\Delta x}{U_{\\max}}\n$$\nSubstituting the given values $C_a = 0.5$ and $U_{\\max} = 0.3$, we have:\n$$\n\\Delta t_{adv} \\le \\frac{0.5 \\Delta x}{0.3} = \\frac{5}{3} \\Delta x\n$$\n\n**2. Viscous Diffusion Constraint ($\\Delta t_{visc}$)**\nThe momentum transport (Navier–Stokes) equation includes a viscous diffusion term, which for a fluid with kinematic viscosity $\\nu$ is of the form $\\nu \\nabla^2 \\mathbf{u}$. For an explicit forward-Euler discretization of this term on a $3$D Cartesian grid, the von Neumann stability analysis yields the constraint:\n$$\n\\Delta t_{visc} \\le \\frac{(\\Delta x)^2}{2d\\nu} = \\frac{(\\Delta x)^2}{6\\nu}\n$$\nwhere $d=3$ is the number of spatial dimensions. In a two-phase system, this condition must hold for both fluids. The most restrictive case corresponds to the larger kinematic viscosity, $\\nu_{\\max} = \\max(\\nu_{\\ell}, \\nu_{g})$, where $\\nu = \\mu/\\rho$.\nLet's compute the kinematic viscosities:\n$$\n\\nu_{\\ell} = \\frac{\\mu_{\\ell}}{\\rho_{\\ell}} = \\frac{3.5\\times 10^{-3}}{1100} \\approx 3.1818 \\times 10^{-6}\\,\\mathrm{m^2/s}\n$$\n$$\n\\nu_{g} = \\frac{\\mu_{g}}{\\rho_{g}} = \\frac{1.8\\times 10^{-5}}{1.2} = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}\n$$\nThe kinematic viscosity of the gas is larger, so $\\nu_{\\max} = \\nu_{g} = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$. The viscous time step constraint is therefore:\n$$\n\\Delta t_{visc} \\le \\frac{(\\Delta x)^2}{6\\nu_{g}} = \\frac{(\\Delta x)^2}{6 \\times (1.5 \\times 10^{-5})} = \\frac{(\\Delta x)^2}{9 \\times 10^{-5}}\n$$\n\n**3. Gravity–Capillary Wave Constraint ($\\Delta t_{cap}$)**\nThe explicit treatment of the surface tension force can lead to a numerical instability related to the propagation of capillary waves. The problem requires us to base the time step on resolving the fastest interface wave. The dispersion relation for gravity–capillary waves at the interface of two deep fluids is:\n$$\n\\omega^2(k) = \\frac{(\\rho_{\\ell} - \\rho_{g}) g k + \\sigma k^3}{\\rho_{\\ell} + \\rho_{g}}\n$$\nwhere $\\omega$ is the angular frequency and $k$ is the wavenumber. The fastest waves correspond to the highest frequency, which occurs at the highest resolvable wavenumber on the grid. This is the Nyquist wavenumber, $k_{\\max} = \\pi/\\Delta x$.\nThe maximum angular frequency is:\n$$\n\\omega_{\\max} = \\sqrt{\\frac{(\\rho_{\\ell} - \\rho_{g}) g k_{\\max} + \\sigma k_{\\max}^3}{\\rho_{\\ell} + \\rho_{g}}} = \\sqrt{\\frac{(\\rho_{\\ell} - \\rho_{g}) g (\\pi/\\Delta x) + \\sigma (\\pi/\\Delta x)^3}{\\rho_{\\ell} + \\rho_{g}}}\n$$\nThe period of this fastest wave is $T_{\\min} = 2\\pi/\\omega_{\\max}$. The policy is to resolve this period with at least $m=4$ time steps, so $\\Delta t \\le T_{\\min}/m$.\n$$\n\\Delta t_{cap} \\le \\frac{T_{\\min}}{m} = \\frac{2\\pi}{m \\omega_{\\max}} = \\frac{2\\pi}{m} \\sqrt{\\frac{\\rho_{\\ell} + \\rho_{g}}{(\\rho_{\\ell} - \\rho_{g}) g (\\pi/\\Delta x) + \\sigma (\\pi/\\Delta x)^3}}\n$$\nWe use the values $\\rho_{\\ell} + \\rho_{g} = 1101.2$ and $\\rho_{\\ell} - \\rho_{g} = 1098.8$.\n\nWe now compute these constraints for each regime.\n\n**Regime A: $\\Delta x_{A} = 1.0\\times 10^{-4}\\,\\mathrm{m}$**\n\n*   **Advection:**\n    $$\n    \\Delta t_{adv, A} \\le \\frac{5}{3} (1.0 \\times 10^{-4}) \\approx 1.667 \\times 10^{-4}\\,\\mathrm{s}\n    $$\n*   **Viscosity:**\n    $$\n    \\Delta t_{visc, A} \\le \\frac{(1.0 \\times 10^{-4})^2}{9 \\times 10^{-5}} = \\frac{1.0 \\times 10^{-8}}{9 \\times 10^{-5}} \\approx 1.111 \\times 10^{-4}\\,\\mathrm{s}\n    $$\n*   **Capillarity:**\n    $k_{\\max, A} = \\pi / (1.0\\times 10^{-4}) = \\pi \\times 10^4\\,\\mathrm{rad/m}$.\n    The terms in the numerator of $\\omega_{\\max, A}^2$ are:\n    Gravity term: $(1098.8)(9.81)(\\pi \\times 10^4) \\approx 3.383 \\times 10^8$\n    Capillary term: $(0.055)(\\pi \\times 10^4)^3 \\approx 1.705 \\times 10^{12}$\n    The capillary term dominates significantly.\n    $$\n    \\omega_{\\max, A}^2 \\approx \\frac{1.705 \\times 10^{12}}{1101.2} \\approx 1.548 \\times 10^9\\,\\mathrm{rad^2/s^2}\n    $$\n    $$\n    \\omega_{\\max, A} \\approx \\sqrt{1.548 \\times 10^9} \\approx 39350\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Delta t_{cap, A} \\le \\frac{2\\pi}{4 \\times 39350} \\approx 3.991 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n*   **Maximum Time Step for Regime A:**\n    $$\n    \\Delta t_{\\max, A} = \\min(1.667 \\times 10^{-4}, 1.111 \\times 10^{-4}, 3.991 \\times 10^{-5}) = 3.991 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n    Converting to microseconds and rounding to three significant figures, $\\Delta t_{\\max, A} \\approx 39.9\\,\\mathrm{\\mu s}$.\n    For Regime A, the rate-limiting mechanism is the propagation of short-wavelength **capillary waves**.\n\n**Regime B: $\\Delta x_{B} = 1.0\\times 10^{-5}\\,\\mathrm{m}$**\n\n*   **Advection:**\n    $$\n    \\Delta t_{adv, B} \\le \\frac{5}{3} (1.0 \\times 10^{-5}) \\approx 1.667 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n*   **Viscosity:**\n    $$\n    \\Delta t_{visc, B} \\le \\frac{(1.0 \\times 10^{-5})^2}{9 \\times 10^{-5}} = \\frac{1.0 \\times 10^{-10}}{9 \\times 10^{-5}} \\approx 1.111 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n*   **Capillarity:**\n    $k_{\\max, B} = \\pi / (1.0\\times 10^{-5}) = \\pi \\times 10^5\\,\\mathrm{rad/m}$.\n    The capillary term scales with $k^3$ while the viscous time step scales with $(\\Delta x)^2 \\propto k^{-2}$ and the capillary time step scales with $k^{-3/2}$. As the grid is refined (k increases), the viscous constraint becomes more severe relative to the capillary constraint.\n    $$\n    \\omega_{\\max, B}^2 \\approx \\frac{(0.055)(\\pi \\times 10^5)^3}{1101.2} \\approx 1.548 \\times 10^{12}\\,\\mathrm{rad^2/s^2}\n    $$\n    $$\n    \\omega_{\\max, B} \\approx \\sqrt{1.548 \\times 10^{12}} \\approx 1.244 \\times 10^6\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Delta t_{cap, B} \\le \\frac{2\\pi}{4 \\times (1.244 \\times 10^6)} \\approx 1.262 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n*   **Maximum Time Step for Regime B:**\n    $$\n    \\Delta t_{\\max, B} = \\min(1.667 \\times 10^{-5}, 1.111 \\times 10^{-6}, 1.262 \\times 10^{-6}) = 1.111 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n    Converting to microseconds and rounding to three significant figures, $\\Delta t_{\\max, B} \\approx 1.11\\,\\mathrm{\\mu s}$.\n    For Regime B, the rate-limiting mechanism is **viscous diffusion**. The viscous constraint, scaling with $(\\Delta x)^2$, has become more restrictive than the capillary constraint, which scales with $(\\Delta x)^{3/2}$.\n\nThe final answers for the maximum stable time step in microseconds for Regime A and Regime B, respectively, are $39.9$ and $1.11$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 39.9  1.11 \\end{pmatrix}}\n$$"
        }
    ]
}