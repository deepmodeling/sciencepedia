{
    "hands_on_practices": [
        {
            "introduction": "Before implementing a complex model like the Cahn-Hilliard–Navier–Stokes system, it is essential to understand the underlying physical regimes. This practice guides you through the process of nondimensionalization, a powerful analytical technique that distills the governing equations into a form that reveals the key dimensionless groups controlling the system's behavior. By identifying parameters like the Reynolds number ($Re$) and Capillary number ($Ca$), you will gain insight into the fundamental balance of forces that drive multiphase flow phenomena. ",
            "id": "4099031",
            "problem": "Consider the isothermal diffuse-interface formulation (commonly called Model H) for a binary incompressible fluid mixture, consisting of the incompressible Navier–Stokes momentum balance coupled to the Cahn–Hilliard equation for the conserved order parameter. Let $x \\in \\mathbb{R}^d$, $t \\ge 0$, velocity field $u(x,t)$, pressure $p(x,t)$, and order parameter $\\phi(x,t)$ with bulk phases near $\\phi \\approx \\pm 1$. The governing dimensional equations are\n$$\n\\nabla \\cdot u = 0,\n$$\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu,\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu,\n$$\nwith chemical potential given by the variational derivative of the Ginzburg–Landau free energy density\n$$\nf(\\phi, \\nabla \\phi) = \\frac{\\beta}{4}\\left(\\phi^2 - 1\\right)^2 + \\frac{\\kappa}{2} |\\nabla \\phi|^2,\n$$\nso that\n$$\n\\mu = \\frac{\\partial f}{\\partial \\phi} - \\nabla \\cdot \\frac{\\partial f}{\\partial (\\nabla \\phi)} = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi.\n$$\nHere $\\rho$ is density, $\\eta$ is dynamic viscosity, $M$ is mobility, $\\beta$ and $\\kappa$ are bulk and gradient free-energy coefficients. The diffuse-interface thickness scale is $\\ell = \\sqrt{\\kappa/\\beta}$ and the equilibrium surface tension for this double-well potential is $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$ with $c_{\\sigma} = \\frac{2\\sqrt{2}}{3}$.\n\nNon-dimensionalize this system by choosing characteristic length $L$, velocity $U$, time $L/U$, pressure scale $\\eta U/L$, and scale the chemical potential by $\\beta$ and the order parameter by unity. Write down the non-dimensional equations and, by identifying coefficients, determine the Reynolds number $Re$, the Capillary number $Ca$, the phase-field Péclet number $Pe_{\\phi}$, and the Cahn number $Cn = \\ell/L$. Briefly explain the physical balance each number quantifies and the asymptotic regimes $Re \\ll 1$, $Ca \\ll 1$ versus $Ca \\gg 1$, $Pe_{\\phi} \\ll 1$ versus $Pe_{\\phi} \\gg 1$, and $Cn \\ll 1$.\n\nExpress your final answer as a single row matrix containing the four dimensionless groups in the order $\\left(Re, Ca, Pe_{\\phi}, Cn\\right)$, each given explicitly in terms of the dimensional parameters $\\rho$, $\\eta$, $U$, $L$, $M$, $\\beta$, and $\\kappa$ (and the constant $c_{\\sigma}$). No numerical approximation is required, and no units should be included in the final answer.",
            "solution": "The problem statement is first validated. The given equations constitute the well-known \"Model H\" for simulating binary incompressible fluids. The parameters and scaling choices are standard in the field of computational fluid dynamics. The problem is scientifically grounded, well-posed, objective, and contains no contradictions or missing information. We may therefore proceed with the solution.\n\nThe task is to non-dimensionalize the provided system of partial differential equations and identify the resulting dimensionless numbers. We are given the following scaling relations for position $x$, time $t$, velocity $u$, pressure $p$, and chemical potential $\\mu$. The order parameter $\\phi$ is already dimensionless.\n\nLet the dimensionless variables be denoted with a prime:\n$x = L x'$\n$t = \\frac{L}{U} t'$\n$u = U u'$\n$p = \\frac{\\eta U}{L} p'$\n$\\mu = \\beta \\mu'$\n$\\phi = \\phi'$\n\nFrom these, we derive the transformations for the differential operators:\n$\\nabla = \\frac{1}{L} \\nabla'$\n$\\nabla^2 = \\frac{1}{L^2} \\nabla'^2$\n$\\partial_t = \\frac{U}{L} \\partial_{t'}$\n\nWe now substitute these into each of the governing equations.\n\n**1. Incompressibility Condition**\nThe continuity equation is:\n$$\n\\nabla \\cdot u = 0\n$$\nSubstituting the scaled variables:\n$$\n\\left(\\frac{1}{L} \\nabla'\\right) \\cdot (U u') = 0\n$$\n$$\n\\frac{U}{L} (\\nabla' \\cdot u') = 0 \\implies \\nabla' \\cdot u' = 0\n$$\nThe incompressibility condition retains its form in dimensionless variables.\n\n**2. Chemical Potential**\nThe expression for the chemical potential is:\n$$\n\\mu = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi\n$$\nSubstituting the scaled variables:\n$$\n\\beta \\mu' = \\beta \\left((\\phi')^3 - \\phi' \\right) - \\kappa \\left(\\frac{1}{L^2} \\nabla'^2\\right) \\phi'\n$$\nDividing the entire equation by $\\beta$:\n$$\n\\mu' = (\\phi')^3 - \\phi' - \\frac{\\kappa}{\\beta L^2} \\nabla'^2 \\phi'\n$$\nThe dimensionless coefficient is identified as the square of the Cahn number, $Cn = \\ell/L = \\sqrt{\\kappa/\\beta} / L$. Thus, $Cn^2 = \\frac{\\kappa}{\\beta L^2}$. The dimensionless chemical potential is:\n$$\n\\mu' = (\\phi')^3 - \\phi' - Cn^2 \\nabla'^2 \\phi'\n$$\nThis defines the Cahn number as $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$.\n\n**3. Cahn–Hilliard Equation**\nThe transport equation for the order parameter is:\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu\n$$\nSubstituting the scaled variables:\n$$\n\\left(\\frac{U}{L} \\partial_{t'}\\right) \\phi' + (U u') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) \\phi' = M \\left(\\frac{1}{L^2} \\nabla'^2\\right) (\\beta \\mu')\n$$\nFactoring out common terms:\n$$\n\\frac{U}{L} \\left( \\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' \\right) = \\frac{M\\beta}{L^2} \\nabla'^2 \\mu'\n$$\nMultiplying by $L/U$ to make the left-hand side dimensionless:\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{M\\beta}{LU} \\nabla'^2 \\mu'\n$$\nThe dimensionless group is the inverse of the phase-field Péclet number, $Pe_{\\phi}$. The Péclet number compares the rate of advective transport to the rate of diffusive transport. Here, $Pe_{\\phi} = \\frac{UL}{M\\beta}$. The equation becomes:\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{1}{Pe_{\\phi}} \\nabla'^2 \\mu'\n$$\n\n**4. Navier–Stokes Equation**\nThe momentum balance equation is:\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu\n$$\nSubstituting the scaled variables into each term:\n$$\n\\rho \\left( \\left(\\frac{U}{L}\\partial_{t'}\\right) (Uu') + (Uu') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) (Uu') \\right) = - \\left(\\frac{1}{L} \\nabla'\\right) \\left(\\frac{\\eta U}{L} p'\\right) + \\eta \\left(\\frac{1}{L^2} \\nabla'^2\\right) (Uu') - \\phi' \\left(\\frac{1}{L} \\nabla'\\right) (\\beta \\mu')\n$$\nSimplifying the coefficients for each term:\n$$\n\\frac{\\rho U^2}{L} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\frac{\\eta U}{L^2} \\nabla' p' + \\frac{\\eta U}{L^2} \\nabla'^2 u' - \\frac{\\beta}{L} \\phi' \\nabla' \\mu'\n$$\nTo create dimensionless groups, we divide the entire equation by a characteristic force scale. Using the viscous force scale, represented by the coefficient of the viscous term, $\\frac{\\eta U}{L^2}$:\n$$\n\\frac{\\rho U^2/L}{\\eta U/L^2} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta/L}{\\eta U/L^2} \\phi' \\nabla' \\mu'\n$$\nSimplifying the coefficients gives:\n$$\n\\frac{\\rho U L}{\\eta} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta L}{\\eta U} \\phi' \\nabla' \\mu'\n$$\nThe coefficient of the inertial term is the Reynolds number, $Re = \\frac{\\rho U L}{\\eta}$.\n\nThe coefficient of the chemical potential forcing term, $\\frac{\\beta L}{\\eta U}$, is related to the Capillary number, $Ca$. The standard definition of the Capillary number is the ratio of viscous forces to surface tension forces, $Ca = \\frac{\\eta U}{\\sigma}$. Using the provided expression for surface tension, $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$:\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}\n$$\nWe can verify the relationship between the coefficient $\\frac{\\beta L}{\\eta U}$ and the standard dimensionless numbers $Ca$ and $Cn$. We have $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$, so $\\sqrt{\\kappa} = Cn L \\sqrt{\\beta}$. Substituting this into the expression for $Ca$:\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} (Cn L \\sqrt{\\beta}) \\sqrt{\\beta}} = \\frac{\\eta U}{c_{\\sigma} Cn L \\beta}\n$$\nRearranging for the coefficient in the momentum equation gives:\n$$\n\\frac{\\beta L}{\\eta U} = \\frac{1}{c_{\\sigma} Cn Ca}\n$$\nThus, the non-dimensional momentum equation is:\n$$\nRe \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{1}{c_{\\sigma} Cn Ca} \\phi' \\nabla' \\mu'\n$$\n\n**Summary of Non-dimensional System**\nDropping the primes for notational clarity, the dimensionless system is:\n$$\n\\nabla \\cdot u = 0\n$$\n$$\nRe \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\nabla^2 u - \\frac{1}{c_{\\sigma} Cn Ca} \\phi \\nabla \\mu\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = \\frac{1}{Pe_{\\phi}} \\nabla^2 \\mu\n$$\n$$\n\\mu = \\phi^3 - \\phi - Cn^2 \\nabla^2 \\phi\n$$\n\n**Physical Interpretation of Dimensionless Numbers**\n\n*   **Reynolds number, $Re = \\frac{\\rho U L}{\\eta}$**: This number quantifies the ratio of inertial forces to viscous forces.\n    *   $Re \\ll 1$: This is the creeping flow (or Stokes flow) regime, where viscous forces dominate. The flow is smooth, orderly, and lacks turbulence.\n    *   $Re \\gg 1$: Inertial forces dominate, leading to complex, chaotic, and potentially turbulent flow patterns.\n\n*   **Capillary number, $Ca = \\frac{\\eta U}{\\sigma} = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$**: This number quantifies the ratio of viscous forces, which act to deform fluid interfaces, to surface tension forces, which act to restore them.\n    *   $Ca \\ll 1$: Surface tension is dominant. Fluid droplets or interfaces strongly resist deformation and tend to minimize their surface area (e.g., remaining spherical).\n    *   $Ca \\gg 1$: Viscous forces are dominant, capable of significantly deforming, stretching, and even breaking up interfaces, as seen in emulsification.\n\n*   **Péclet number, $Pe_{\\phi} = \\frac{UL}{M\\beta}$**: This number quantifies the ratio of the rate of advective transport of the order parameter $\\phi$ by the flow field to its rate of diffusive transport driven by gradients in the chemical potential.\n    *   $Pe_{\\phi} \\ll 1$: Diffusion is the dominant transport mechanism for $\\phi$. Concentration fields tend to homogenize quickly.\n    *   $Pe_{\\phi} \\gg 1$: Advection is dominant. The order parameter field is effectively \"frozen\" and carried along with the fluid flow.\n\n*   **Cahn number, $Cn = \\frac{\\ell}{L} = \\frac{\\sqrt{\\kappa/\\beta}}{L}$**: This number quantifies the ratio of the characteristic thickness of the diffuse interface, $\\ell = \\sqrt{\\kappa/\\beta}$, to the macroscopic characteristic length of the system, $L$.\n    *   $Cn \\ll 1$: This is the sharp-interface limit. The interface between the two fluid components is orders of magnitude thinner than the overall system size. In this limit, the diffuse-interface model converges to a classical sharp-interface model where surface tension is a true singularity at the interface.\n\n**Final Expressions for Dimensionless Groups**\nBased on the derivation, the expressions for the four dimensionless groups in terms of the given dimensional parameters are:\n- Reynolds number: $Re = \\frac{\\rho U L}{\\eta}$\n- Capillary number: $Ca = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$\n- Péclet number: $Pe_{\\phi} = \\frac{UL}{M\\beta}$\n- Cahn number: $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$\n\nThese are collected into a single row matrix as the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\rho U L}{\\eta} & \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}} & \\frac{U L}{M \\beta} & \\frac{\\sqrt{\\frac{\\kappa}{\\beta}}}{L} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A central challenge in simulating incompressible multiphase flows is the numerical enforcement of the divergence-free velocity constraint, which is tightly coupled to the pressure field. This exercise delves into the heart of a widely used solution, the pressure-correction projection method, by guiding you through the derivation of the discrete pressure Poisson equation on a staggered grid. Understanding this derivation is fundamental to building a stable and accurate incompressible flow solver for phase-field models. ",
            "id": "4099087",
            "problem": "Consider the incompressible Cahn–Hilliard–Navier–Stokes (CH–NS) system for a binary fluid mixture in two spatial dimensions with constant density $\\,\\rho\\,$ and dynamic viscosity $\\,\\eta\\,$ on a periodic square domain. The hydrodynamics is governed by the incompressible Navier–Stokes equations\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) \\;=\\; -\\nabla p \\;+\\; \\eta \\nabla^{2}\\boldsymbol{u} \\;-\\; \\phi \\,\\nabla \\mu,\\qquad \\nabla\\cdot\\boldsymbol{u}=0,\n$$\nwhere $\\boldsymbol{u}$ is the velocity, $p$ is the pressure, $\\phi$ is the phase field, and $\\mu$ is the chemical potential (given by a thermodynamically consistent Cahn–Hilliard model). Assume that the capillary (Korteweg) force is $-\\phi \\nabla \\mu$ and exploit the decomposition $-\\phi \\nabla \\mu \\,=\\, -\\nabla(\\phi \\mu) \\,+\\, \\mu \\nabla \\phi$.\n\nAdopt a rotational incremental pressure-correction projection method on a uniform Marker-And-Cell (MAC) staggered grid of spacing $\\,h\\,$ with periodic boundary conditions. Scalar unknowns $\\,p\\,$, $\\,\\phi\\,$, and $\\,\\mu\\,$ are stored at cell centers $\\,\\{(i,j)\\}\\,$, and velocity components are stored on cell faces: the horizontal component at locations $\\,\\{(i+\\tfrac{1}{2},j)\\}\\,$ and the vertical component at $\\,\\{(i,j+\\tfrac{1}{2})\\}\\,$. Let $\\,\\Delta t\\,$ be the time step, and suppose $\\,\\phi^{n+1/2}\\,$ and $\\,\\mu^{n+1/2}\\,$ are known at time level $\\,n+\\tfrac{1}{2}\\,$ after a stable Cahn–Hilliard update. Define the intermediate velocity $\\,\\boldsymbol{u}^{\\star}\\,$ by advancing the momentum equation over $[t^{n},t^{n+1}]$ with all non-pressure terms treated semi-implicitly and the gradient part $-\\nabla(\\phi \\mu)$ of the capillary force withheld from this step:\n$$\n\\rho \\frac{\\boldsymbol{u}^{\\star} - \\boldsymbol{u}^{n}}{\\Delta t} \\;+\\; \\text{(consistent discretization of } \\rho\\,\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} \\text{)} \\;-\\; \\eta \\nabla^{2}\\boldsymbol{u}^{\\star}\n\\;=\\; -\\nabla p^{n} \\;+\\; \\mu^{n+1/2}\\,\\nabla \\phi^{n+1/2}.\n$$\nThen perform the projection\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big),\n$$\nwhich enforces $\\,\\nabla\\cdot\\boldsymbol{u}^{n+1}=0\\,$. Use second-order central differences for all spatial derivatives. Let $\\,D\\cdot\\,\\boldsymbol{v}\\,$ denote the standard MAC divergence that maps face-centered velocities to cell centers, and let $\\,L\\,$ denote the standard five-point Laplacian on cell centers. The discrete projection step yields a pressure Poisson equation at cell centers of the form\n$$\nL\\,p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,D\\cdot \\boldsymbol{u}^{\\star} \\;+\\; L\\,p^{n} \\;-\\; L\\!\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right).\n$$\n\nUsing the above setting and operators, derive the cell-centered discrete pressure Poisson equation and explicitly assemble its right-hand-side entry at a generic interior cell center $\\, (i,j)\\,$. Use the uniform grid spacing $\\,h\\,$ and denote by $\\,u^{\\star}_{i+1/2,j}\\,$ and $\\,v^{\\star}_{i,j+1/2}\\,$ the components of the intermediate velocity on faces adjacent to cell $\\, (i,j)\\,$. Your derivation must start from the continuous equations and the projection methodology, justify the capillary-force splitting in the pressure update, and clearly construct the discrete operators on the MAC grid.\n\nAnswer specification:\n- Your final answer must be the single, closed-form algebraic expression for the assembled right-hand-side at cell $\\, (i,j)\\,$, expressed solely in terms of $\\,\\rho\\,$, $\\,\\Delta t\\,$, $\\,h\\,$, the neighboring face-centered components of $\\,\\boldsymbol{u}^{\\star}\\,$, and the neighboring cell-centered values of $\\,p^{n}\\,$ and $\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)$.\n- Do not include any equation signs or inequalities in your final answer.\n- No numerical evaluation is required.",
            "solution": "The objective is to derive the discrete pressure Poisson equation (PPE) for the given Cahn–Hilliard–Navier–Stokes system and to explicitly assemble the expression for its right-hand side (RHS) at a generic cell center $(i,j)$ on a MAC grid.\n\nFirst, we establish the continuous-in-space form of the PPE. The numerical scheme is an incremental pressure-correction projection method. The two key steps are the calculation of an intermediate velocity $\\boldsymbol{u}^{\\star}$ and the projection of this velocity onto the space of divergence-free fields to obtain the final velocity $\\boldsymbol{u}^{n+1}$.\n\nThe projection step is given as:\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\n$$\nThis step must enforce the incompressibility constraint at the new time level, $t^{n+1}$:\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} = 0\n$$\nTo derive the PPE, we take the divergence of the projection equation:\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star} \\;-\\; \\nabla\\cdot\\left(\\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\\right)\n$$\nSubstituting the incompressibility constraint $\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$ and rearranging terms, we obtain a Poisson equation for the effective pressure correction term:\n$$\n\\frac{\\Delta t}{\\rho}\\,\\nabla^{2}\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big) \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\nwhere $\\nabla^{2} \\equiv \\nabla \\cdot \\nabla$ is the Laplacian operator. Assuming the Laplacian is a linear operator, we can expand the left side:\n$$\n\\nabla^{2}p^{n+1} - \\nabla^{2}p^{n} + \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right) \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\nIsolating the term involving the new pressure $p^{n+1}$ yields the continuous form of the PPE for $p^{n+1}$:\n$$\n\\nabla^{2}p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star} \\;+\\; \\nabla^{2}p^{n} \\;-\\; \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)\n$$\nThis equation matches the symbolic form provided in the problem statement, where the continuous operators $\\nabla^2$ and $\\nabla\\cdot$ correspond to the discrete operators $L$ and $D\\cdot$, respectively.\n\nThe problem requires a justification for the splitting of the capillary force $-\\phi\\nabla\\mu$. Using the vector calculus identity $\\nabla(\\phi\\mu) = \\phi\\nabla\\mu + \\mu\\nabla\\phi$, the capillary force can be decomposed as $-\\phi\\nabla\\mu = \\mu\\nabla\\phi - \\nabla(\\phi\\mu)$. The time-stepping scheme leverages this decomposition:\n1. The term $\\mu\\nabla\\phi$ is treated explicitly in the intermediate velocity step. The equation for $\\boldsymbol{u}^{\\star}$ includes the term $\\mu^{n+1/2}\\nabla\\phi^{n+1/2}$, which is an explicit forcing term computed from values known at time $t^{n+1/2}$.\n2. The term $-\\nabla(\\phi\\mu)$ is a conservative force, as it can be expressed as the gradient of a scalar potential. In this scheme, it is combined with the pressure gradient term and handled implicitly within the projection step. The projection step involves the gradient of $p^{n+1} - p^n + \\phi^{n+1/2}\\mu^{n+1/2}$, effectively treating $\\phi^{n+1/2}\\mu^{n+1/2}$ as part of the pressure potential that enforces incompressibility. This ensures that the velocity correction is a pure gradient field, which does not alter the vorticity of the flow (a property of rotational schemes), and robustly enforces the $\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$ constraint.\n\nNow, we discretize the PPE on the uniform MAC grid with spacing $h$. Scalar quantities like $p$, $\\phi$, and $\\mu$ are defined at cell centers $(i,j)$. The discrete operators are based on second-order central differences.\n\nThe discrete divergence of the intermediate velocity $\\boldsymbol{u}^{\\star} = (u^{\\star}, v^{\\star})$ at cell center $(i,j)$ is:\n$$\n(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} \\;+\\; \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\n$$\nThe five-point stencil for the Laplacian operator $L$ applied to any cell-centered scalar field $\\psi$ at $(i,j)$ is:\n$$\n(L\\,\\psi)_{i,j} \\;=\\; \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{h^2} \\;+\\; \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{h^2}\n$$\nThe discrete PPE is written as $L\\,p^{n+1}_{i,j} = (\\text{RHS})_{i,j}$. The problem asks for the explicit assembly of the right-hand-side, which is given by:\n$$\n(\\text{RHS})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;+\\; (L\\,p^n)_{i,j} \\;-\\; (L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j}\n$$\nWe assemble each term on the RHS using the discrete operator definitions:\nThe first term is the divergence of the intermediate velocity:\n$$\n\\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t} \\left(\\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} + \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\\right) \\;=\\; \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2})\n$$\nThe second term is the Laplacian of the old pressure $p^n$:\n$$\n(L\\,p^n)_{i,j} \\;=\\; \\frac{p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}}{h^2}\n$$\nThe third term is the negative Laplacian of the product $\\phi^{n+1/2}\\mu^{n+1/2}$:\n$$\n-(L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j} \\;=\\; -\\frac{(\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j}}{h^2}\n$$\nCombining these three expressions gives the complete algebraic form for the RHS at cell $(i,j)$.\n$$\n(\\text{RHS})_{i,j} = \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})\n$$\nThis is the final expression required.",
            "answer": "$$\n\\boxed{\\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})}\n$$"
        },
        {
            "introduction": "Numerical simulations of multiphase flows can produce non-physical artifacts, a notorious example being 'spurious currents' that arise from a discrete imbalance of forces at the fluid interface. This hands-on problem tackles this critical issue by having you derive a scaling law that predicts the magnitude of these currents as a function of numerical parameters. This analysis provides a practical framework for validating your code and developing a grid refinement strategy to ensure simulation fidelity. ",
            "id": "4099053",
            "problem": "A static, circular droplet of characteristic radius $R$ is modeled by a phase-field diffuse-interface approach in the incompressible Navier–Stokes–Cahn–Hilliard (NSCH) framework, where the Cahn number (Cn) is defined as $Cn = W/R$ with $W$ the diffuse-interface thickness. In the continuous limit, a stationary equilibrium solution has zero velocity. However, on a discrete grid, small violations of discrete force balance induce non-zero flow known as spurious currents. Your task is to quantify the magnitude of these spurious currents as a function of the Cahn number $Cn$ and grid resolution, and to propose a refinement rule that ensures these currents are below a prescribed tolerance.\n\nYou must proceed from fundamental balances and core definitions only. The fundamental base you must use is:\n- The steady, low-Reynolds-number limit of the incompressible Navier–Stokes equations: the viscous–capillary balance for a static droplet, with viscous stress scale $\\mu U/\\ell^{2}$ and capillary force density scale $\\sigma \\kappa \\delta_{s}$, where $\\mu$ is the dynamic viscosity, $U$ is a characteristic velocity, $\\ell$ is a characteristic viscous length, $\\sigma$ is the surface tension, $\\kappa$ is the curvature, and $\\delta_{s}$ is an interfacial localization factor with scale $1/W$.\n- The Cahn number $Cn = W/R$ and the definition of the spurious capillary number $Ca_{s} = \\mu U_{s} / \\sigma$, where $U_{s}$ is the characteristic spurious velocity magnitude to be estimated.\n- The assumption of a second-order accurate spatial discretization for gradients, divergences, and curvature-like operators, implying that the leading relative discretization error in the interfacial force density scales as a power of the ratio $\\Delta x/W$, where $\\Delta x$ is the grid spacing.\n\nFrom these principles, derive a dimensionless scaling prediction for $Ca_{s}$ as a function of $Cn$ and the grid resolution characterized by the integer $N_{r}$, the number of grid points per droplet radius, so that $\\Delta x = R/N_{r}$. Your derivation must be explicit about which physical length scale $\\ell$ dominates the viscous dissipation opposing the interfacial forcing error. You must show how the prediction depends on $Cn$ and $N_{r}$, and you must adopt a single, order-one proportionality constant $K$ and a leading exponent consistent with second-order accuracy. For numerical evaluation in this problem, take $K = 1$ without units. All quantities are dimensionless in the final expressions for $Ca_{s}$.\n\nBased on your derived scaling, propose a purely algorithmic refinement rule that, for a given triple $(Cn, N_{r}, \\varepsilon)$ with tolerance $\\varepsilon$ on the spurious capillary number $Ca_{s}$, returns an integer recommendation $N_{r}^{\\mathrm{rec}}$ that is sufficient to guarantee $Ca_{s} \\le \\varepsilon$ using monotone refinement in $N_{r}$. The rule must be stated as a closed-form mapping from $(Cn, N_{r}, \\varepsilon)$ to $N_{r}^{\\mathrm{rec}}$ using only algebraic operations on real numbers and the ceiling function; no iterative search is permitted.\n\nImplement a complete, runnable program that:\n- Uses your derived scaling with $K = 1$ to compute $Ca_{s}$ and the refinement recommendation $N_{r}^{\\mathrm{rec}}$ for each test case.\n- For each test case, outputs a two-element list $[Ca_{s}, N_{r}^{\\mathrm{rec}}]$ where $Ca_{s}$ is a floating-point number and $N_{r}^{\\mathrm{rec}}$ is an integer.\n- Aggregates the results for all test cases into a single line printed as a comma-separated list enclosed in square brackets, where each element is itself a two-element list with no spaces, e.g., $[[a,b],[c,d]]$.\n\nUse the following test suite of parameter triples $(Cn, N_{r}, \\varepsilon)$:\n- Test $1$: $(Cn, N_{r}, \\varepsilon) = (0.02, 64, 0.001)$.\n- Test $2$: $(Cn, N_{r}, \\varepsilon) = (0.05, 512, 0.0005)$.\n- Test $3$: $(Cn, N_{r}, \\varepsilon) = (0.1, 16, 0.01)$.\n- Test $4$: $(Cn, N_{r}, \\varepsilon) = (0.005, 128, 0.002)$.\n- Test $5$: $(Cn, N_{r}, \\varepsilon) = (0.02, 224, 0.001)$.\n\nAll requested outputs are dimensionless; no physical units are required. The final program output must be a single line containing the results as a comma-separated list enclosed in square brackets. Each element must be a two-element list $[Ca_{s}, N_{r}^{\\mathrm{rec}}]$ with no spaces, in the same order as the test suite.",
            "solution": "The problem requires the derivation of a scaling law for the spurious capillary number, $Ca_{s}$, in a diffuse-interface simulation of a static droplet, and a corresponding grid refinement rule. The derivation must proceed from the fundamental principles provided.\n\nThe physical origin of spurious currents is a force imbalance at the discrete level. In the steady, low-Reynolds-number limit, the spurious flow is established by a balance between the viscous forces and the residual, unbalanced part of the capillary force stemming from discretization error. We can express this balance of force densities as:\n$$ \\mathcal{F}_{visc} \\sim \\delta \\mathcal{F}_{cap} $$\nwhere $\\mathcal{F}_{visc}$ is the viscous force density and $\\delta \\mathcal{F}_{cap}$ is the error in the capillary force density.\n\nFirst, we establish the scaling for the capillary force density error, $\\delta \\mathcal{F}_{cap}$. The problem states that the scale of the capillary force density is $\\sigma \\kappa \\delta_{s}$. For a circular droplet of radius $R$, the curvature $\\kappa$ has a characteristic scale of $1/R$. The interfacial localization factor, $\\delta_{s}$, which confines the force to the interface, has a scale of $1/W$, where $W$ is the interface thickness. Thus, the scale of the true capillary force density is:\n$$ \\mathcal{F}_{cap} \\sim \\sigma \\kappa \\delta_{s} \\sim \\sigma \\frac{1}{R} \\frac{1}{W} $$\nThe problem posits a second-order accurate spatial discretization, where the leading relative discretization error in the interfacial force density scales as the square of the ratio of the grid spacing, $\\Delta x$, to the characteristic length scale of the field being discretized. Here, the phase field varies over the interface thickness $W$, so the relative error is proportional to $(\\Delta x/W)^2$. The absolute error in the force density is then:\n$$ \\delta \\mathcal{F}_{cap} \\sim \\mathcal{F}_{cap} \\left(\\frac{\\Delta x}{W}\\right)^2 \\sim \\left(\\frac{\\sigma}{RW}\\right) \\left(\\frac{\\Delta x}{W}\\right)^2 = \\frac{\\sigma \\Delta x^2}{R W^3} $$\nNext, we establish the scaling for the balancing viscous force density, $\\mathcal{F}_{visc}$. The viscous term in the steady, low-Reynolds-number Navier-Stokes equations is $\\mu \\nabla^2 \\mathbf{u}$. Its characteristic scale is $\\mu U_{s} / \\ell^2$, where $U_s$ is the characteristic spurious velocity and $\\ell$ is the characteristic length scale of viscous dissipation. The spurious force imbalance is localized within the diffuse interface of thickness $W$. This force drives a flow, and the resulting velocity field has its strongest gradients, and thus dominant viscous dissipation, across this same region. Therefore, the appropriate viscous length scale is the interface thickness, $\\ell = W$. This gives the viscous force density scale as:\n$$ \\mathcal{F}_{visc} \\sim \\frac{\\mu U_{s}}{W^2} $$\nNow, we equate the scales of the viscous force and the capillary force error:\n$$ \\frac{\\mu U_{s}}{W^2} \\sim \\frac{\\sigma \\Delta x^2}{R W^3} $$\nWe solve for the characteristic spurious velocity, $U_{s}$:\n$$ U_{s} \\sim \\frac{\\sigma}{\\mu} \\frac{\\Delta x^2 W^2}{R W^3} = \\frac{\\sigma}{\\mu} \\frac{\\Delta x^2}{R W} $$\nThe problem asks for the scaling of the spurious capillary number, defined as $Ca_{s} = \\mu U_{s} / \\sigma$. Substituting the expression for $U_{s}$:\n$$ Ca_{s} = \\frac{\\mu}{\\sigma} U_{s} \\sim \\frac{\\mu}{\\sigma} \\left(\\frac{\\sigma}{\\mu} \\frac{\\Delta x^2}{R W}\\right) = \\frac{\\Delta x^2}{R W} $$\nTo express this result in terms of the given dimensionless parameters, the Cahn number $Cn = W/R$ and the grid resolution $N_{r} = R/\\Delta x$, we substitute $W = R \\cdot Cn$ and $\\Delta x = R/N_{r}$:\n$$ Ca_{s} \\sim \\frac{(R/N_{r})^2}{R (R \\cdot Cn)} = \\frac{R^2/N_{r}^2}{R^2 \\cdot Cn} = \\frac{1}{Cn \\cdot N_{r}^2} $$\nIntroducing the order-one proportionality constant $K$ and setting it to $K=1$ as specified, we obtain the final scaling prediction:\n$$ Ca_{s} = \\frac{1}{Cn \\cdot N_{r}^2} $$\nNext, we derive the algorithmic refinement rule. The goal is to determine a recommended grid resolution, $N_{r}^{\\mathrm{rec}}$, for a given triplet $(Cn, N_{r}, \\varepsilon)$, that is sufficient to ensure the spurious capillary number is below a tolerance $\\varepsilon$. We require $Ca_{s} \\le \\varepsilon$. Using our derived scaling:\n$$ \\frac{1}{Cn \\cdot (N_{r}^{\\mathrm{rec}})^2} \\le \\varepsilon $$\nSolving for $N_{r}^{\\mathrm{rec}}$:\n$$ (N_{r}^{\\mathrm{rec}})^2 \\ge \\frac{1}{Cn \\cdot \\varepsilon} $$\n$$ N_{r}^{\\mathrm{rec}} \\ge \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} $$\nSince the number of grid points $N_{r}$ must be an integer, the minimum required resolution, let's call it $N_{r, \\text{min}}$, is the smallest integer satisfying this condition, which is obtained using the ceiling function:\n$$ N_{r, \\text{min}} = \\left\\lceil \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} \\right\\rceil $$\nThe problem asks for a rule for \"monotone refinement\". In numerical practice, this means that if a grid refinement is necessary, the new resolution must be greater than or equal to the current resolution. If the current grid is already sufficient, no refinement is needed. This logic can be captured by recommending a new resolution that is the maximum of the current resolution $N_r$ and the minimum required resolution $N_{r, \\text{min}}$. This ensures the recommendation is always sufficient and never decreases the resolution. Thus, the closed-form mapping is:\n$$ N_{r}^{\\mathrm{rec}} = \\max\\left( N_{r}, \\left\\lceil \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} \\right\\rceil \\right) $$\nThis rule provides a sufficient resolution based on the inputs $(Cn, N_{r}, \\varepsilon)$ as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spurious capillary number and a recommended grid refinement\n    based on a derived scaling law for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Cn, N_r, epsilon)\n    test_cases = [\n        (0.02, 64, 0.001),\n        (0.05, 512, 0.0005),\n        (0.1, 16, 0.01),\n        (0.005, 128, 0.002),\n        (0.02, 224, 0.001),\n    ]\n\n    results = []\n    for case in test_cases:\n        Cn, Nr, eps = case\n\n        # Derived scaling for the spurious capillary number: Ca_s = 1 / (Cn * N_r^2)\n        # The proportionality constant K is taken as 1.\n        Ca_s = 1.0 / (Cn * Nr**2)\n\n        # Derived refinement rule for the recommended grid resolution N_r^rec.\n        # N_r^rec must be an integer sufficient to ensure Ca_s <= epsilon.\n        # The minimum required resolution is ceil(sqrt(1 / (Cn * eps))).\n        # The rule for \"monotone refinement\" suggests the recommendation\n        # should not be less than the current resolution.\n        \n        # Calculate the minimum required resolution to meet the tolerance\n        Nr_min_required = np.ceil(np.sqrt(1.0 / (Cn * eps)))\n        \n        # The recommended resolution is the maximum of the current and the required one.\n        # The result must be an integer.\n        Nr_rec = int(np.max([Nr, Nr_min_required]))\n\n        results.append([Ca_s, Nr_rec])\n\n    # Final print statement in the exact required format.\n    # The string representation of the list is modified to remove all spaces.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}