{
    "hands_on_practices": [
        {
            "introduction": "在着手进行任何物理系统的数值模拟之前，理解不同物理效应的相对重要性是至关重要的一步。无量纲化是实现这一目标的主要工具，它能将复杂的方程组提炼为一组关键的无量纲数。本练习  将引导你完成对耦合的Cahn-Hilliard-Navier-Stokes系统的无量纲化过程，揭示控制多相流动力学的基本参数，例如雷诺数 $Re$ 和毛细数 $Ca$。",
            "id": "4099031",
            "problem": "考虑一个二元不可压缩流体混合物的等温扩散界面公式（通常称为H模型），该模型由不可压缩Navier–Stokes动量平衡方程与守恒序参量的Cahn–Hilliard方程耦合而成。设 $x \\in \\mathbb{R}^d$，$t \\ge 0$，速度场为 $u(x,t)$，压力为 $p(x,t)$，序参量为 $\\phi(x,t)$，其体相在 $\\phi \\approx \\pm 1$ 附近。控制量纲方程为\n$$\n\\nabla \\cdot u = 0,\n$$\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu,\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu,\n$$\n其中化学势由Ginzburg–Landau自由能密度的变分导数给出\n$$\nf(\\phi, \\nabla \\phi) = \\frac{\\beta}{4}\\left(\\phi^2 - 1\\right)^2 + \\frac{\\kappa}{2} |\\nabla \\phi|^2,\n$$\n因此\n$$\n\\mu = \\frac{\\partial f}{\\partial \\phi} - \\nabla \\cdot \\frac{\\partial f}{\\partial (\\nabla \\phi)} = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi.\n$$\n此处，$\\rho$ 是密度，$\\eta$ 是动力粘度，$M$ 是迁移率，$\\beta$ 和 $\\kappa$ 是体相和梯度自由能系数。扩散界面厚度标度为 $\\ell = \\sqrt{\\kappa/\\beta}$，对于此双势阱，平衡表面张力为 $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$，其中 $c_{\\sigma} = \\frac{2\\sqrt{2}}{3}$。\n\n通过选择特征长度 $L$、速度 $U$、时间 $L/U$、压力标度 $\\eta U/L$，并将化学势按 $\\beta$、序参量按1进行标度，来对此系统进行无量纲化。写出无量纲方程，并通过识别系数，确定雷诺数 $Re$、毛细数 $Ca$、相场佩克莱数 $Pe_{\\phi}$ 和Cahn数 $Cn = \\ell/L$。简要解释每个数所量化的物理平衡，以及 $Re \\ll 1$、$Ca \\ll 1$ 与 $Ca \\gg 1$、$Pe_{\\phi} \\ll 1$ 与 $Pe_{\\phi} \\gg 1$ 和 $Cn \\ll 1$ 这些渐近状态。\n\n将你的最终答案表示为一个单行矩阵，其中包含按 $\\left(Re, Ca, Pe_{\\phi}, Cn\\right)$ 顺序排列的四个无量纲群，每个群都用量纲参数 $\\rho$、$\\eta$、$U$、$L$、$M$、$\\beta$ 和 $\\kappa$（以及常数 $c_{\\sigma}$）明确表示。不需要数值近似，最终答案中不应包含任何单位。",
            "solution": "首先验证问题陈述。给定的方程构成了用于模拟二元不可压缩流体的著名“H模型”。参数和标度选择在计算流体动力学领域是标准的。该问题具有科学依据、是适定的、客观的，并且不包含矛盾或缺失信息。因此，我们可以着手求解。\n\n任务是对所提供的偏微分方程系统进行无量纲化，并识别出得到的无量纲数。我们给出了位置 $x$、时间 $t$、速度 $u$、压力 $p$ 和化学势 $\\mu$ 的以下标度关系。序参量 $\\phi$ 已经是无量纲的。\n\n令无量纲变量用撇号(')表示：\n$x = L x'$\n$t = \\frac{L}{U} t'$\n$u = U u'$\n$p = \\frac{\\eta U}{L} p'$\n$\\mu = \\beta \\mu'$\n$\\phi = \\phi'$\n\n由此，我们推导出微分算子的变换：\n$\\nabla = \\frac{1}{L} \\nabla'$\n$\\nabla^2 = \\frac{1}{L^2} \\nabla'^2$\n$\\partial_t = \\frac{U}{L} \\partial_{t'}$\n\n现在我们将这些代入每个控制方程中。\n\n**1. 不可压缩性条件**\n连续性方程为：\n$$\n\\nabla \\cdot u = 0\n$$\n代入标度化变量：\n$$\n\\left(\\frac{1}{L} \\nabla'\\right) \\cdot (U u') = 0\n$$\n$$\n\\frac{U}{L} (\\nabla' \\cdot u') = 0 \\implies \\nabla' \\cdot u' = 0\n$$\n不可压缩性条件在无量纲变量下保持其形式。\n\n**2. 化学势**\n化学势的表达式为：\n$$\n\\mu = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi\n$$\n代入标度化变量：\n$$\n\\beta \\mu' = \\beta \\left((\\phi')^3 - \\phi' \\right) - \\kappa \\left(\\frac{1}{L^2} \\nabla'^2\\right) \\phi'\n$$\n整个方程除以 $\\beta$：\n$$\n\\mu' = (\\phi')^3 - \\phi' - \\frac{\\kappa}{\\beta L^2} \\nabla'^2 \\phi'\n$$\n无量纲系数被识别为Cahn数 $Cn = \\ell/L = \\sqrt{\\kappa/\\beta} / L$ 的平方。因此，$Cn^2 = \\frac{\\kappa}{\\beta L^2}$。无量纲化学势为：\n$$\n\\mu' = (\\phi')^3 - \\phi' - Cn^2 \\nabla'^2 \\phi'\n$$\n这定义了Cahn数为 $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$。\n\n**3. Cahn–Hilliard方程**\n序参量的输运方程为：\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu\n$$\n代入标度化变量：\n$$\n\\left(\\frac{U}{L} \\partial_{t'}\\right) \\phi' + (U u') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) \\phi' = M \\left(\\frac{1}{L^2} \\nabla'^2\\right) (\\beta \\mu')\n$$\n提出公因子：\n$$\n\\frac{U}{L} \\left( \\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' \\right) = \\frac{M\\beta}{L^2} \\nabla'^2 \\mu'\n$$\n乘以 $L/U$ 使左侧无量纲化：\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{M\\beta}{LU} \\nabla'^2 \\mu'\n$$\n该无量纲群是相场佩克莱数 $Pe_{\\phi}$ 的倒数。佩克莱数比较对流输运速率与扩散输运速率。这里，$Pe_{\\phi} = \\frac{UL}{M\\beta}$。方程变为：\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{1}{Pe_{\\phi}} \\nabla'^2 \\mu'\n$$\n\n**4. Navier–Stokes方程**\n动量平衡方程为：\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu\n$$\n将标度化变量代入每一项：\n$$\n\\rho \\left( \\left(\\frac{U}{L}\\partial_{t'}\\right) (Uu') + (Uu') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) (Uu') \\right) = - \\left(\\frac{1}{L} \\nabla'\\right) \\left(\\frac{\\eta U}{L} p'\\right) + \\eta \\left(\\frac{1}{L^2} \\nabla'^2\\right) (Uu') - \\phi' \\left(\\frac{1}{L} \\nabla'\\right) (\\beta \\mu')\n$$\n简化每一项的系数：\n$$\n\\frac{\\rho U^2}{L} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\frac{\\eta U}{L^2} \\nabla' p' + \\frac{\\eta U}{L^2} \\nabla'^2 u' - \\frac{\\beta}{L} \\phi' \\nabla' \\mu'\n$$\n为创建无量纲群，我们将整个方程除以一个特征力标度。使用粘性力标度，由粘性项的系数 $\\frac{\\eta U}{L^2}$ 表示：\n$$\n\\frac{\\rho U^2/L}{\\eta U/L^2} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta/L}{\\eta U/L^2} \\phi' \\nabla' \\mu'\n$$\n简化系数可得：\n$$\n\\frac{\\rho U L}{\\eta} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta L}{\\eta U} \\phi' \\nabla' \\mu'\n$$\n惯性项的系数是雷诺数 $Re = \\frac{\\rho U L}{\\eta}$。\n\n化学势强迫项的系数 $\\frac{\\beta L}{\\eta U}$ 与毛细数 $Ca$ 相关。毛细数的标准定义是粘性力与表面张力之比，$Ca = \\frac{\\eta U}{\\sigma}$。使用给定的表面张力表达式 $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$：\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}\n$$\n我们可以验证系数 $\\frac{\\beta L}{\\eta U}$ 与标准无量纲数 $Ca$ 和 $Cn$ 之间的关系。我们有 $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$，所以 $\\sqrt{\\kappa} = Cn L \\sqrt{\\beta}$。将此代入 $Ca$ 的表达式中：\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} (Cn L \\sqrt{\\beta}) \\sqrt{\\beta}} = \\frac{\\eta U}{c_{\\sigma} Cn L \\beta}\n$$\n重新整理动量方程中的系数可得：\n$$\n\\frac{\\beta L}{\\eta U} = \\frac{1}{c_{\\sigma} Cn Ca}\n$$\n因此，无量纲动量方程为：\n$$\nRe \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{1}{c_{\\sigma} Cn Ca} \\phi' \\nabla' \\mu'\n$$\n\n**无量纲系统总结**\n为使符号清晰，省略撇号，无量纲系统为：\n$$\n\\nabla \\cdot u = 0\n$$\n$$\nRe \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\nabla^2 u - \\frac{1}{c_{\\sigma} Cn Ca} \\phi \\nabla \\mu\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = \\frac{1}{Pe_{\\phi}} \\nabla^2 \\mu\n$$\n$$\n\\mu = \\phi^3 - \\phi - Cn^2 \\nabla^2 \\phi\n$$\n\n**无量纲数的物理解释**\n\n*   **雷诺数, $Re = \\frac{\\rho U L}{\\eta}$**：该数量化了惯性力与粘性力之比。\n    *   $Re \\ll 1$：这是蠕流（或斯托克斯流）状态，此时粘性力占主导地位。流动平滑、有序且无湍流。\n    *   $Re \\gg 1$：惯性力占主导地位，导致复杂、混沌且可能出现湍流的流动模式。\n\n*   **毛细数, $Ca = \\frac{\\eta U}{\\sigma} = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$**：该数量化了使流体界面变形的粘性力与恢复界面的表面张力之比。\n    *   $Ca \\ll 1$：表面张力占主导地位。流体液滴或界面强烈抵抗变形，并倾向于最小化其表面积（例如，保持球形）。\n    *   $Ca \\gg 1$：粘性力占主导地位，能够显著地使界面变形、拉伸甚至破碎，如乳化现象中所见。\n\n*   **佩克莱数, $Pe_{\\phi} = \\frac{UL}{M\\beta}$**：该数量化了序参量 $\\phi$ 由流场引起的对流输运速率与其由化学势梯度驱动的扩散输运速率之比。\n    *   $Pe_{\\phi} \\ll 1$：扩散是 $\\phi$ 的主要输运机制。浓度场倾向于快速均匀化。\n    *   $Pe_{\\phi} \\gg 1$：对流占主导地位。序参量场实际上被“冻结”并随流体流动。\n\n*   **Cahn数, $Cn = \\frac{\\ell}{L} = \\frac{\\sqrt{\\kappa/\\beta}}{L}$**：该数量化了扩散界面的特征厚度 $\\ell = \\sqrt{\\kappa/\\beta}$ 与系统的宏观特征长度 $L$ 之比。\n    *   $Cn \\ll 1$：这是尖锐界面极限。两种流体组分之间的界面比整个系统尺寸薄几个数量级。在此极限下，扩散界面模型收敛于经典的尖锐界面模型，其中表面张力在界面处是一个真正的奇异点。\n\n**无量纲群的最终表达式**\n基于推导，四个无量纲群用给定的量纲参数表示的表达式为：\n- 雷诺数: $Re = \\frac{\\rho U L}{\\eta}$\n- 毛细数: $Ca = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$\n- 佩克莱数: $Pe_{\\phi} = \\frac{UL}{M\\beta}$\n- Cahn数: $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$\n\n这些被收集到一个单行矩阵中作为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\rho U L}{\\eta} & \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}} & \\frac{U L}{M \\beta} & \\frac{\\sqrt{\\frac{\\kappa}{\\beta}}}{L} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从连续方程过渡到数值实现，求解不可压缩Navier-Stokes方程需要一种特殊方法来处理速度与压力之间的耦合。压力修正法是一种标准且功能强大的技术，本练习  的重点是在交错网格上，专门针对相场模型推导该方法的核心——离散的压力泊松方程。理解这一推导对于构建一个稳健的多相流求解器至关重要。",
            "id": "4099087",
            "problem": "考虑一个在周期性方形区域上的二维二元流体混合物，其不可压缩Cahn–Hilliard–Navier–Stokes (CH–NS)系统具有恒定密度$\\,\\rho\\,$和动力粘度$\\,\\eta\\,$。流体动力学由不可压缩Navier–Stokes方程控制\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) \\;=\\; -\\nabla p \\;+\\; \\eta \\nabla^{2}\\boldsymbol{u} \\;-\\; \\phi \\,\\nabla \\mu,\\qquad \\nabla\\cdot\\boldsymbol{u}=0,\n$$\n其中$\\boldsymbol{u}$是速度，$p$是压力，$\\phi$是相场，$\\mu$是化学势（由一个热力学一致的Cahn–Hilliard模型给出）。假设毛细（Korteweg）力为$-\\phi \\nabla \\mu$，并利用分解式$-\\phi \\nabla \\mu \\,=\\, -\\nabla(\\phi \\mu) \\,+\\, \\mu \\nabla \\phi$。\n\n在具有周期性边界条件的均匀Marker-And-Cell (MAC)交错网格上采用旋转增量压力修正投影法，网格间距为$\\,h\\,$。标量未知数$\\,p\\,$, $\\,\\phi\\,$和$\\,\\mu\\,$存储在网格中心$\\,\\{(i,j)\\}\\,$，速度分量存储在网格面上：水平分量位于$\\,\\{(i+\\tfrac{1}{2},j)\\}\\,$，垂直分量位于$\\,\\{(i,j+\\tfrac{1}{2})\\}\\,$。设$\\,\\Delta t\\,$为时间步长，并假设在稳定的Cahn–Hilliard更新后，在时间层$\\,n+\\tfrac{1}{2}\\,$上已知$\\,\\phi^{n+1/2}\\,$和$\\,\\mu^{n+1/2}\\,$。通过在$[t^{n},t^{n+1}]$上推进动量方程来定义中间速度$\\,\\boldsymbol{u}^{\\star}\\,$，其中所有非压力项均作半隐式处理，并且毛细力的梯度部分$-\\nabla(\\phi \\mu)$不在此步骤中计算：\n$$\n\\rho \\frac{\\boldsymbol{u}^{\\star} - \\boldsymbol{u}^{n}}{\\Delta t} \\;+\\; \\text{(consistent discretization of } \\rho\\,\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} \\text{)} \\;-\\; \\eta \\nabla^{2}\\boldsymbol{u}^{\\star}\n\\;=\\; -\\nabla p^{n} \\;+\\; \\mu^{n+1/2}\\,\\nabla \\phi^{n+1/2}.\n$$\n然后执行投影\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big),\n$$\n这将强制$\\,\\nabla\\cdot\\boldsymbol{u}^{n+1}=0\\,$。对所有空间导数使用二阶中心差分。令$\\,D\\cdot\\,\\boldsymbol{v}\\,$表示将面心速度映射到网格中心的标准MAC散度，令$\\,L\\,$表示网格中心上的标准五点拉普拉斯算子。离散投影步骤产生一个网格中心上的压力泊松方程，其形式为\n$$\nL\\,p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,D\\cdot \\boldsymbol{u}^{\\star} \\;+\\; L\\,p^{n} \\;-\\; L\\!\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right).\n$$\n\n使用上述设置和算子，推导网格中心的离散压力泊松方程，并显式地构建其在通用内部网格中心$\\, (i,j)\\,$处的右端项。使用均匀网格间距$\\,h\\,$，并用$\\,u^{\\star}_{i+1/2,j}\\,$和$\\,v^{\\star}_{i,j+1/2}\\,$表示与网格$\\, (i,j)\\,$相邻面上的中间速度分量。你的推导必须从连续方程和投影方法开始，论证压力更新中毛细力分裂的合理性，并清晰地构建MAC网格上的离散算子。\n\n答案规格：\n- 你的最终答案必须是网格$\\, (i,j)\\,$处组装好的右端项的单一闭式代数表达式，仅用$\\,\\rho\\,$, $\\,\\Delta t\\,$, $\\,h\\,$, $\\,\\boldsymbol{u}^{\\star}\\,$的相邻面心分量，以及$\\,p^{n}\\,$和$\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)$的相邻网格中心值来表示。\n- 你的最终答案中不得包含任何等号或不等号。\n- 无需进行数值计算。",
            "solution": "目标是为给定的Cahn–Hilliard–Navier–Stokes系统推导离散压力泊松方程(PPE)，并在MAC网格上的一个通用网格中心$(i,j)$处显式地组装其右端项(RHS)的表达式。\n\n首先，我们建立空间连续形式的PPE。该数值格式是一种增量压力修正投影法。两个关键步骤是计算中间速度$\\boldsymbol{u}^{\\star}$，以及将该速度投影到无散场空间以获得最终速度$\\boldsymbol{u}^{n+1}$。\n\n投影步骤由下式给出：\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\n$$\n此步骤必须强制执行新时间层$t^{n+1}$处的不可压缩性约束：\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} = 0\n$$\n为推导PPE，我们对投影方程取散度：\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star} \\;-\\; \\nabla\\cdot\\left(\\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\\right)\n$$\n代入不可压缩性约束$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$并整理各项，我们得到一个关于有效压力修正项的泊松方程：\n$$\n\\frac{\\Delta t}{\\rho}\\,\\nabla^{2}\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big) \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\n其中$\\nabla^{2} \\equiv \\nabla \\cdot \\nabla$是拉普拉斯算子。假设拉普拉斯算子是线性算子，我们可以展开左侧：\n$$\n\\nabla^{2}p^{n+1} - \\nabla^{2}p^{n} + \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right) \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\n分离出包含新压力$p^{n+1}$的项，得到$p^{n+1}$的PPE的连续形式：\n$$\n\\nabla^{2}p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star} \\;+\\; \\nabla^{2}p^{n} \\;-\\; \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)\n$$\n该方程与问题描述中提供的符号形式相匹配，其中连续算子$\\nabla^2$和$\\nabla\\cdot$分别对应于离散算子$L$和$D\\cdot$。\n\n问题要求对毛细力$-\\phi\\nabla\\mu$的分裂作出合理解释。使用矢量微积分恒等式$\\nabla(\\phi\\mu) = \\phi\\nabla\\mu + \\mu\\nabla\\phi$，毛细力可以分解为$-\\phi\\nabla\\mu = \\mu\\nabla\\phi - \\nabla(\\phi\\mu)$。时间步进格式利用了这种分解：\n1. 在中间速度步骤中，项$\\mu\\nabla\\phi$被显式处理。$\\boldsymbol{u}^{\\star}$的方程包含了项$\\mu^{n+1/2}\\nabla\\phi^{n+1/2}$，这是一个由时间$t^{n+1/2}$的已知值计算出的显式强迫项。\n2. 项$-\\nabla(\\phi\\mu)$是一个保守力，因为它可以表示为一个标量势的梯度。在此格式中，它与压力梯度项结合，并在投影步骤中被隐式处理。投影步骤涉及$p^{n+1} - p^n + \\phi^{n+1/2}\\mu^{n+1/2}$的梯度，实际上是将$\\phi^{n+1/2}\\mu^{n+1/2}$视为强制不可压缩性的压力势的一部分。这确保了速度修正是纯梯度场，不会改变流场的涡量（旋转格式的一个特性），并稳健地强制执行$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$约束。\n\n现在，我们在间距为$h$的均匀MAC网格上离散化PPE。像$p$, $\\phi$, 和$\\mu$这样的标量定义在网格中心$(i,j)$。离散算子基于二阶中心差分。\n\n在网格中心$(i,j)$处，中间速度$\\boldsymbol{u}^{\\star} = (u^{\\star}, v^{\\star})$的离散散度为：\n$$\n(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} \\;+\\; \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\n$$\n应用于$(i,j)$处任意网格中心标量场$\\psi$的拉普拉斯算子$L$的五点模板为：\n$$\n(L\\,\\psi)_{i,j} \\;=\\; \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{h^2} \\;+\\; \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{h^2}\n$$\n离散PPE写作$L\\,p^{n+1}_{i,j} = (\\text{RHS})_{i,j}$。问题要求显式地组装右端项，其由下式给出：\n$$\n(\\text{RHS})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;+\\; (L\\,p^n)_{i,j} \\;-\\; (L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j}\n$$\n我们使用离散算子定义来组装RHS上的每一项：\n第一项是中间速度的散度：\n$$\n\\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t} \\left(\\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} + \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\\right) \\;=\\; \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2})\n$$\n第二项是旧压力$p^n$的拉普拉斯：\n$$\n(L\\,p^n)_{i,j} \\;=\\; \\frac{p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}}{h^2}\n$$\n第三项是乘积$\\phi^{n+1/2}\\mu^{n+1/2}$的负拉普拉斯：\n$$\n-(L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j} \\;=\\; -\\frac{(\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j}}{h^2}\n$$\n将这三个表达式组合起来，就得到了网格$(i,j)$处RHS的完整代数形式。\n$$\n(\\text{RHS})_{i,j} = \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})\n$$\n这就是所要求的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})}\n$$"
        },
        {
            "introduction": "从核心算法转向一个常见的数值赝像，即使算法在形式上是正确的，离散实现也可能引入非物理行为，例如在流体界面处产生“伪电流”。理解和控制这些数值赝像是获得精确模拟结果的关键。本练习  通过一项实践性分析，推导这些伪电流的标度率，并据此制定减小其影响的网格加密策略。",
            "id": "4099053",
            "problem": "一个特征半径为 $R$ 的静态圆形液滴，在不可压缩 Navier–Stokes–Cahn–Hilliard (NSCH) 框架下，通过相场扩散界面方法进行建模。其中 Cahn 数 (Cn) 定义为 $Cn = W/R$，而 $W$ 是扩散界面厚度。在连续极限下，一个稳态平衡解的速度为零。然而，在离散网格上，离散力平衡的微小破坏会诱导出非零的流动，这被称为伪电流。你的任务是量化这些伪电流的大小，将其表示为 Cahn 数 $Cn$ 和网格分辨率的函数，并提出一个加密规则，以确保这些电流低于规定的容差。\n\n你必须仅从基本平衡和核心定义出发。你必须使用的基本依据是：\n- 不可压缩 Navier–Stokes 方程的稳态、低雷诺数极限：静态液滴的粘性-毛细平衡，其中粘性应力尺度为 $\\eta U/\\ell^{2}$，毛细力密度尺度为 $\\sigma \\kappa \\delta_{s}$，这里 $\\eta$ 是动力粘度，$U$ 是特征速度，$\\ell$ 是特征粘性长度，$\\sigma$ 是表面张力，$\\kappa$ 是曲率，$\\delta_{s}$ 是一个界面局部化因子，其尺度为 $1/W$。\n- Cahn 数 $Cn = W/R$ 以及伪毛细数 $Ca_{s} = \\eta U_{s} / \\sigma$ 的定义，其中 $U_{s}$ 是待估算的特征伪速度大小。\n- 假设梯度、散度和类曲率算子采用二阶精度的空间离散，这意味着界面力密度中的主导相对离散误差与比值 $\\Delta x/W$ 的幂成比例，其中 $\\Delta x$ 是网格间距。\n\n基于这些原理，推导 $Ca_{s}$ 作为 $Cn$ 和网格分辨率的函数的无量纲标度预测。网格分辨率由整数 $N_{r}$ 表征，即每个液滴半径内的网格点数，因此有 $\\Delta x = R/N_{r}$。你的推导必须明确指出哪个物理长度尺度 $\\ell$ 在抵抗界面驱动力误差的粘性耗散中占主导地位。你必须展示预测结果如何依赖于 $Cn$ 和 $N_{r}$，并且必须采用一个量级为一的比例常数 $K$ 和一个与二阶精度一致的主导指数。在本问题中，为了进行数值评估，取 $K=1$ 且无单位。在 $Ca_{s}$ 的最终表达式中，所有量均为无量纲。\n\n基于你推导出的标度关系，提出一个纯算法的加密规则。对于一个给定的、包含伪毛细数 $Ca_{s}$ 容差 $\\varepsilon$ 的三元组 $(Cn, N_{r}, \\varepsilon)$，该规则返回一个整数建议值 $N_{r}^{\\mathrm{rec}}$，该值足以通过对 $N_{r}$ 进行单调加密来保证 $Ca_{s} \\le \\varepsilon$。该规则必须表述为一个从 $(Cn, N_{r}, \\varepsilon)$ 到 $N_{r}^{\\mathrm{rec}}$ 的闭式映射，仅使用实数上的代数运算和上取整函数；不允许进行迭代搜索。\n\n实现一个完整、可运行的程序，该程序：\n- 使用你推导的标度关系（其中 $K = 1$）为每个测试用例计算 $Ca_{s}$ 和加密建议值 $N_{r}^{\\mathrm{rec}}$。\n- 为每个测试用例输出一个双元素列表 $[Ca_{s}, N_{r}^{\\mathrm{rec}}]$，其中 $Ca_{s}$ 是一个浮点数，$N_{r}^{\\mathrm{rec}}$ 是一个整数。\n- 将所有测试用例的结果聚合到单行中，以方括号括起来的逗号分隔列表形式打印，其中每个元素本身是一个不含空格的双元素列表，例如 $[[a,b],[c,d]]$。\n\n使用以下参数三元组 $(Cn, N_{r}, \\varepsilon)$ 的测试套件：\n- 测试 1：$(Cn, N_{r}, \\varepsilon) = (0.02, 64, 0.001)$。\n- 测试 2：$(Cn, N_{r}, \\varepsilon) = (0.05, 512, 0.0005)$。\n- 测试 3：$(Cn, N_{r}, \\varepsilon) = (0.1, 16, 0.01)$。\n- 测试 4：$(Cn, N_{r}, \\varepsilon) = (0.005, 128, 0.002)$。\n- 测试 5：$(Cn, N_{r}, \\varepsilon) = (0.02, 224, 0.001)$。\n\n所有要求的输出都是无量纲的；不需要物理单位。最终的程序输出必须是单行，包含一个方括号括起来的逗号分隔列表形式的结果。每个元素必须是与测试套件顺序相同的、不含空格的双元素列表 $[Ca_{s}, N_{r}^{\\mathrm{rec}}]$。",
            "solution": "该问题要求在静态液滴的扩散界面模拟中，推导伪毛细数 $Ca_{s}$ 的标度律以及相应的网格加密规则。推导过程必须从所提供的基本原理出发。\n\n伪电流的物理来源是离散层面上的力不平衡。在稳态、低雷诺数极限下，伪流是由粘性力与源于离散误差的毛细力残余不平衡部分之间的平衡所建立的。我们可以将这个力密度的平衡表示为：\n$$ \\mathcal{F}_{visc} \\sim \\delta \\mathcal{F}_{cap} $$\n其中 $\\mathcal{F}_{visc}$ 是粘性力密度，而 $\\delta \\mathcal{F}_{cap}$ 是毛细力密度的误差。\n\n首先，我们建立毛细力密度误差 $\\delta \\mathcal{F}_{cap}$ 的标度关系。问题陈述，毛细力密度的尺度为 $\\sigma \\kappa \\delta_{s}$。对于半径为 $R$ 的圆形液滴，曲率 $\\kappa$ 的特征尺度为 $1/R$。将力限制在界面上的界面局部化因子 $\\delta_{s}$ 的尺度为 $1/W$，其中 $W$ 是界面厚度。因此，真实毛细力密度的尺度为：\n$$ \\mathcal{F}_{cap} \\sim \\sigma \\kappa \\delta_{s} \\sim \\sigma \\frac{1}{R} \\frac{1}{W} $$\n问题假定采用二阶精度的空间离散，其中界面力密度中的主导相对离散误差与网格间距 $\\Delta x$ 和被离散场的特征长度尺度的比值的平方成比例。这里，相场在界面厚度 $W$ 上变化，因此相对误差正比于 $(\\Delta x/W)^2$。于是，力密度的绝对误差为：\n$$ \\delta \\mathcal{F}_{cap} \\sim \\mathcal{F}_{cap} \\left(\\frac{\\Delta x}{W}\\right)^2 \\sim \\left(\\frac{\\sigma}{RW}\\right) \\left(\\frac{\\Delta x}{W}\\right)^2 = \\frac{\\sigma \\Delta x^2}{R W^3} $$\n\n接下来，我们建立与之平衡的粘性力密度 $\\mathcal{F}_{visc}$ 的标度关系。在稳态、低雷诺数 Navier-Stokes 方程中，粘性项为 $\\eta \\nabla^2 \\mathbf{u}$。其特征尺度为 $\\eta U_{s} / \\ell^2$，其中 $U_s$ 是特征伪速度，$\\ell$ 是粘性耗散的特征长度尺度。伪力不平衡被局部化在厚度为 $W$ 的扩散界面内。这个力驱动流动，产生的速度场在这个相同区域内具有最强的梯度，因此也具有主导的粘性耗散。所以，合适的粘性长度尺度是界面厚度，即 $\\ell = W$。这给出了粘性力密度的尺度为：\n$$ \\mathcal{F}_{visc} \\sim \\frac{\\eta U_{s}}{W^2} $$\n\n现在，我们令粘性力和毛细力误差的尺度相等：\n$$ \\frac{\\eta U_{s}}{W^2} \\sim \\frac{\\sigma \\Delta x^2}{R W^3} $$\n我们求解特征伪速度 $U_{s}$：\n$$ U_{s} \\sim \\frac{\\sigma}{\\eta} \\frac{\\Delta x^2 W^2}{R W^3} = \\frac{\\sigma}{\\eta} \\frac{\\Delta x^2}{R W} $$\n问题要求得到伪毛细数 $Ca_{s} = \\eta U_{s} / \\sigma$ 的标度关系。代入 $U_{s}$ 的表达式：\n$$ Ca_{s} = \\frac{\\eta}{\\sigma} U_{s} \\sim \\frac{\\eta}{\\sigma} \\left(\\frac{\\sigma}{\\eta} \\frac{\\Delta x^2}{R W}\\right) = \\frac{\\Delta x^2}{R W} $$\n\n为了用给定的无量纲参数，即 Cahn 数 $Cn = W/R$ 和网格分辨率 $N_{r} = R/\\Delta x$ 来表示此结果，我们代入 $W = R \\cdot Cn$ 和 $\\Delta x = R/N_{r}$：\n$$ Ca_{s} \\sim \\frac{(R/N_{r})^2}{R (R \\cdot Cn)} = \\frac{R^2/N_{r}^2}{R^2 \\cdot Cn} = \\frac{1}{Cn \\cdot N_{r}^2} $$\n引入量级为一的比例常数 $K$，并按要求设其为 $K=1$，我们得到最终的标度预测：\n$$ Ca_{s} = \\frac{1}{Cn \\cdot N_{r}^2} $$\n\n接下来，我们推导算法加密规则。目标是对于一个给定的三元组 $(Cn, N_{r}, \\varepsilon)$，确定一个推荐的网格分辨率 $N_{r}^{\\mathrm{rec}}$，该分辨率足以确保伪毛细数低于容差 $\\varepsilon$。我们要求 $Ca_{s} \\le \\varepsilon$。使用我们推导的标度关系：\n$$ \\frac{1}{Cn \\cdot (N_{r}^{\\mathrm{rec}})^2} \\le \\varepsilon $$\n求解 $N_{r}^{\\mathrm{rec}}$：\n$$ (N_{r}^{\\mathrm{rec}})^2 \\ge \\frac{1}{Cn \\cdot \\varepsilon} $$\n$$ N_{r}^{\\mathrm{rec}} \\ge \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} $$\n由于网格点数 $N_{r}$ 必须是整数，所需的最小分辨率（我们称之为 $N_{r, \\text{min}}$）是满足此条件的最小整数，这可以通过使用上取整函数得到：\n$$ N_{r, \\text{min}} = \\left\\lceil \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} \\right\\rceil $$\n问题要求一个“单调加密”规则。在数值实践中，这意味着如果需要进行网格加密，则新的分辨率必须大于或等于当前分辨率。如果当前网格已经足够，则不需要加密。这个逻辑可以通过推荐一个新分辨率来实现，该分辨率是当前分辨率 $N_r$ 和最小所需分辨率 $N_{r, \\text{min}}$ 的最大值。这确保了推荐值总是足够的，并且永远不会降低分辨率。因此，闭式映射为：\n$$ N_{r}^{\\mathrm{rec}} = \\max\\left( N_{r}, \\left\\lceil \\sqrt{\\frac{1}{Cn \\cdot \\varepsilon}} \\right\\rceil \\right) $$\n该规则根据输入 $(Cn, N_{r}, \\varepsilon)$ 提供了一个足够的分辨率，符合要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spurious capillary number and a recommended grid refinement\n    based on a derived scaling law for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Cn, N_r, epsilon)\n    test_cases = [\n        (0.02, 64, 0.001),\n        (0.05, 512, 0.0005),\n        (0.1, 16, 0.01),\n        (0.005, 128, 0.002),\n        (0.02, 224, 0.001),\n    ]\n\n    results = []\n    for case in test_cases:\n        Cn, Nr, eps = case\n\n        # Derived scaling for the spurious capillary number: Ca_s = 1 / (Cn * N_r^2)\n        # The proportionality constant K is taken as 1.\n        Ca_s = 1.0 / (Cn * Nr**2)\n\n        # Derived refinement rule for the recommended grid resolution N_r^rec.\n        # N_r^rec must be an integer sufficient to ensure Ca_s = epsilon.\n        # The minimum required resolution is ceil(sqrt(1 / (Cn * eps))).\n        # The rule for \"monotone refinement\" suggests the recommendation\n        # should not be less than the current resolution.\n        \n        # Calculate the minimum required resolution to meet the tolerance\n        Nr_min_required = np.ceil(np.sqrt(1.0 / (Cn * eps)))\n        \n        # The recommended resolution is the maximum of the current and the required one.\n        # The result must be an integer.\n        Nr_rec = int(np.max([Nr, Nr_min_required]))\n\n        results.append([Ca_s, Nr_rec])\n\n    # Final print statement in the exact required format.\n    # The string representation of the list is modified to remove all spaces.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}