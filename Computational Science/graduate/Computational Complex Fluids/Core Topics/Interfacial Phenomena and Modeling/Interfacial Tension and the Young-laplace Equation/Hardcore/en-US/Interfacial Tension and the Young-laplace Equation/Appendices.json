{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation, we begin by deriving the Young-Laplace equation for the two most fundamental geometries: a sphere and an infinite cylinder. This exercise connects the abstract concept of an interfacial stress jump to the concrete geometric property of curvature. By working through these canonical examples, you will develop a first-principles understanding of how surface tension generates pressure differences across curved interfaces, a cornerstone of multiphase fluid dynamics. ",
            "id": "4091221",
            "problem": "Consider two immiscible, quiescent, incompressible fluids with a smooth, sharp interface endowed with constant, isotropic interfacial tension $\\gamma$. Neglect gravity and any surfactant effects, and assume the stress in each bulk fluid is purely hydrostatic. Let $\\boldsymbol{n}$ denote the unit normal to the interface pointing from the inner fluid (the droplet or the cylindrical thread) into the outer fluid. Define the generalized curvature of the interface as the surface divergence of the normal, $\\kappa \\equiv \\nabla_{s} \\cdot \\boldsymbol{n}$, which equals the sum of the principal curvatures. \n\nTwo geometries are considered:\n- A spherical droplet of radius $R$.\n- An infinitely long circular cylindrical liquid thread of radius $a$.\n\nStarting from the momentum balance at a fluid-fluid interface and the geometric definition of principal curvatures from differential geometry of surfaces, derive $\\kappa$ for each geometry and then deduce the corresponding pressure jump $\\Delta p \\equiv p_{\\text{inside}} - p_{\\text{outside}}$ across the interface for each case. Finally, compute the ratio $\\Delta p_{\\text{sphere}} / \\Delta p_{\\text{cylinder}}$.\n\nExpress your final answer as a single row matrix containing, in order, $\\kappa_{\\text{sphere}}$, $\\kappa_{\\text{cylinder}}$, and the ratio $\\Delta p_{\\text{sphere}} / \\Delta p_{\\text{cylinder}}$. No numerical evaluation is required; provide a closed-form symbolic expression.",
            "solution": "The momentum balance at a static, sharp fluid-fluid interface relates the pressure jump across the interface, $\\Delta p$, to the interfacial tension, $\\gamma$, and the total (or mean) curvature, $\\kappa$. This is the Young-Laplace equation:\n$$ \\Delta p = \\gamma \\kappa $$\nThe total curvature $\\kappa$ is the sum of the two principal curvatures of the surface, $\\kappa = \\kappa_1 + \\kappa_2$. Our task is to find the curvature for each specified geometry and then use the Young-Laplace equation to find the pressure jump.\n\n**1. Spherical Droplet**\n\nFor a sphere of radius $R$, the surface is uniformly curved. At any point on the surface, any normal plane intersects the sphere to form a great circle of radius $R$. The curvature of this circle is $1/R$. The two principal curvatures are therefore equal:\n$$\n\\kappa_1 = \\frac{1}{R}, \\quad \\kappa_2 = \\frac{1}{R}\n$$\nThe total curvature for the sphere is their sum:\n$$\n\\kappa_{\\text{sphere}} = \\kappa_1 + \\kappa_2 = \\frac{1}{R} + \\frac{1}{R} = \\frac{2}{R}\n$$\nApplying the Young-Laplace equation, the pressure jump is:\n$$\n\\Delta p_{\\text{sphere}} = \\gamma \\kappa_{\\text{sphere}} = \\frac{2\\gamma}{R}\n$$\n\n**2. Cylindrical Liquid Thread**\n\nFor an infinitely long cylinder of radius $a$, we consider the two principal directions at any point on its surface.\n- The first principal direction is along the circumference of a circular cross-section. This is a circle of radius $a$, so the corresponding curvature is:\n$$ \\kappa_1 = \\frac{1}{a} $$\n- The second principal direction is along the axis of the cylinder. This is a straight line, which has an infinite radius of curvature, so its curvature is zero:\n$$ \\kappa_2 = \\frac{1}{\\infty} = 0 $$\nThe total curvature for the cylinder is the sum of these two:\n$$\n\\kappa_{\\text{cylinder}} = \\kappa_1 + \\kappa_2 = \\frac{1}{a} + 0 = \\frac{1}{a}\n$$\nThe corresponding pressure jump is:\n$$\n\\Delta p_{\\text{cylinder}} = \\gamma \\kappa_{\\text{cylinder}} = \\frac{\\gamma}{a}\n$$\n\n**3. Ratio of Pressure Jumps**\n\nFinally, we compute the ratio of the two pressure jumps:\n$$\n\\frac{\\Delta p_{\\text{sphere}}}{\\Delta p_{\\text{cylinder}}} = \\frac{2\\gamma / R}{\\gamma / a} = \\frac{2/R}{1/a} = \\frac{2a}{R}\n$$\n\n**Summary**\n\nThe required quantities are:\n- $\\kappa_{\\text{sphere}} = \\frac{2}{R}$\n- $\\kappa_{\\text{cylinder}} = \\frac{1}{a}$\n- Ratio $\\frac{\\Delta p_{\\text{sphere}}}{\\Delta p_{\\text{cylinder}}} = \\frac{2a}{R}$\n\nThese are collected into the final matrix form.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{R}  \\frac{1}{a}  \\frac{2a}{R} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from unbounded fluids to realistic confined systems, we now explore how interfaces interact with solid boundaries. This practice focuses on translating the physical concept of a static contact angle into a precise mathematical boundary condition for the interface shape, a critical step in formulating computational models of wetting and capillarity. Mastering this translation is essential for accurately simulating phenomena such as capillary rise and droplet spreading in microfluidic and porous media applications. ",
            "id": "4091245",
            "problem": "A static axisymmetric meniscus of a Newtonian liquid of density $\\rho$ spans a circular cylindrical capillary of inner radius $a$, whose axis is aligned with the vertical $z$-direction. Let the liquid-gas interface be represented in Monge gauge as $z=h(r)$, where $r$ is the radial coordinate from the axis. The liquid partially wets the solid, with a prescribed static contact angle $\\theta$ (measured through the liquid) at the three-phase contact line on the capillary wall at $r=a$. The interface is at mechanical equilibrium so that the pressure jump across the interface is balanced by surface tension times the interface mean curvature, and the interface meets the wall at the prescribed angle. In a computational formulation, the wall condition must be implemented as a boundary condition on $h$ at $r=a$. Assume a small-slope regime in the bulk of the meniscus and a gentle axial variation relative to the tube radius so that the interface curvature is dominated by the azimuthal bending near the wall.\n\nStarting from (i) the static force balance across the interface expressed by the Young–Laplace relation (pressure jump equals surface tension times mean curvature), (ii) the geometric definition of the contact angle as the angle between the interface and the solid wall measured through the liquid, and (iii) the definition of mean curvature of a graph $z=h(r)$ in axisymmetry, determine which of the following pairs correctly encode the wall boundary condition and the leading-order curvature at the wall that enters the Young–Laplace balance near $r=a$ under the stated assumptions.\n\nA. Wall boundary condition: $h_r(a)=\\tan\\theta$. Wall curvature: $\\kappa(a)\\approx \\dfrac{\\sin\\theta}{a}$.\n\nB. Wall boundary condition: $h_r(a)=\\cot\\theta$. Wall curvature: $\\kappa(a)\\approx \\dfrac{\\cos\\theta}{a}$.\n\nC. Wall boundary condition: $h_r(a)=-\\cot\\theta$. Wall curvature: $\\kappa(a)\\approx -\\dfrac{\\cos\\theta}{a}$.\n\nD. Wall boundary condition: $h_r(a)=-\\tan\\theta$. Wall curvature: $\\kappa(a)\\approx \\dfrac{2\\cos\\theta}{a}$.\n\nE. Wall boundary condition: $h_r(a)=\\cot\\theta$. Wall curvature: $\\kappa(a)\\approx \\dfrac{\\cot\\theta}{a}$.\n\nSelect the single correct option that is consistent with the geometric contact-angle condition at a vertical wall and with the dominance of azimuthal curvature near $r=a$ for a gently varying, small-slope interface. Justify your choice from first principles in your derivation, making clear how the wall boundary condition encodes $\\theta$ and how the curvature estimate at the wall follows.",
            "solution": "The solution requires deriving the mathematical expression for the contact angle boundary condition and the approximate curvature at the wall.\n\n**1. Wall Boundary Condition Derivation**\n\nThe contact angle $\\theta$ is defined geometrically at the contact line ($r=a$). It is the angle between the tangent to the interface and the solid wall, measured through the liquid.\n\n- The interface is described by the curve $z=h(r)$. The slope of the tangent to this curve is given by its derivative, $h_r(r) \\equiv \\frac{dh}{dr}$. At the wall, this slope is $h_r(a)$.\n- The solid wall is vertical (parallel to the z-axis).\n- Let $\\phi$ be the angle that the interface tangent makes with the horizontal ($r$-axis). Then $\\tan\\phi = h_r(a)$.\n- From geometry, the contact angle $\\theta$ at a vertical wall is related to $\\phi$ by $\\theta + \\phi = \\pi/2$ (or $90^\\circ$). This can be seen by drawing a right triangle with the vertical wall, the horizontal line, and the interface tangent.\n- Therefore, $\\phi = \\pi/2 - \\theta$.\n- Substituting this into the slope relation:\n$$ h_r(a) = \\tan(\\phi) = \\tan(\\pi/2 - \\theta) = \\cot\\theta $$\nThis gives us the wall boundary condition for the slope of the interface.\n\n**2. Leading-Order Curvature at the Wall**\n\nThe total (or mean) curvature $\\kappa$ for an axisymmetric surface $z=h(r)$ is the sum of the meridional curvature ($\\kappa_1$) and the azimuthal curvature ($\\kappa_2$):\n$$ \\kappa(r) = \\kappa_1(r) + \\kappa_2(r) = \\frac{h_{rr}}{(1+h_r^2)^{3/2}} + \\frac{h_r}{r(1+h_r^2)^{1/2}} $$\nThe problem states that we should assume the curvature is dominated by the azimuthal component near the wall ($r=a$). Thus, we can approximate:\n$$ \\kappa(a) \\approx \\kappa_2(a) = \\frac{h_r(a)}{a(1+h_r(a)^2)^{1/2}} $$\nNow we can use our result from the boundary condition derivation. We know $h_r(a) = \\cot\\theta$. We also know the trigonometric identity $1 + \\cot^2\\theta = \\csc^2\\theta$. Substituting this:\n$$ \\kappa(a) \\approx \\frac{\\cot\\theta}{a(1+\\cot^2\\theta)^{1/2}} = \\frac{\\cot\\theta}{a(\\csc^2\\theta)^{1/2}} = \\frac{\\cot\\theta}{a \\csc\\theta} $$\nSince $\\cot\\theta = \\cos\\theta/\\sin\\theta$ and $\\csc\\theta = 1/\\sin\\theta$, this simplifies to:\n$$ \\kappa(a) \\approx \\frac{\\cos\\theta/\\sin\\theta}{a(1/\\sin\\theta)} = \\frac{\\cos\\theta}{a} $$\nThis is the leading-order curvature at the wall under the stated assumption.\n\n**Conclusion**\n\nThe derived pair of expressions is:\n- Wall boundary condition: $h_r(a) = \\cot\\theta$\n- Wall curvature: $\\kappa(a) \\approx \\dfrac{\\cos\\theta}{a}$\n\nThis matches option B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "A key task in computational science is the verification and validation of numerical codes. This practice simulates this process by asking you to analyze hypothetical data from a phase-field simulation of a static droplet. By performing a linear regression on pressure jump versus curvature, you will not only confirm the simulation's adherence to the Young-Laplace law but also extract a quantitative measurement of the interfacial tension, $\\gamma$. This exercise builds essential skills in data analysis, error quantification, and assessing the convergence of numerical results. ",
            "id": "4091232",
            "problem": "Consider a diffuse-interface model of a spherical droplet in a quiescent fluid, such as one generated by the Cahn-Hilliard (CH) Partial Differential Equation (PDE) coupled to a momentum equation with Korteweg stress. In the absence of flow and body forces, the mechanical equilibrium imposes a balance between the internal pressure of the droplet and the external pressure of the ambient fluid mediated by interfacial tension. For a spherical interface, the mean curvature depends on the reciprocal of the radius. From first principles, the pressure jump across the interface must scale linearly with the appropriate geometric curvature measure. This linear relationship can be used to infer the interfacial tension by regressing the measured pressure jump against the curvature for a range of radii, and then assessing convergence as the computational grid is refined.\n\nYour task is to implement a program that, given measured pressure jumps at several droplet radii from three numerical experiments at different grid spacings, performs an unweighted least-squares linear regression of the pressure jump against the reciprocal radius, deduces the interfacial tension from the proportionality factor implied by spherical geometry, and quantifies the quality of the fit. Specifically, for each test case:\n- Construct the predictor vector $x$ as $x_i = 1/R_i$ in $\\mathrm{m}^{-1}$ for the provided radii $R_i$.\n- Let the response vector $y$ be the measured pressure jumps $\\Delta p_i$ in $\\mathrm{Pa}$.\n- Fit the linear model $y = m x + b$ and deduce the interfacial tension $\\gamma$ from $m$ using the relationship between pressure jump and mean curvature for a spherical interface.\n- Compute the root-mean-square relative deviation $\\varepsilon_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\left(\\frac{y_i - \\hat{y}_i}{y_i}\\right)^2}$, where $\\hat{y}_i$ are the fitted values.\n- Report, for each test case, the inferred $\\gamma$ in $\\mathrm{N}/\\mathrm{m}$ and $\\varepsilon_{\\mathrm{rms}}$ as dimensionless floats.\n\nUse the following three test cases to assess convergence with grid refinement. The nominal true interfacial tension used to generate these measurements is approximately that of a water-air interface at room temperature.\n\nTest case $1$ (coarse grid):\n- Grid spacing $h$: $2.5\\times 10^{-6}\\,\\mathrm{m}$.\n- Radii $R$ (in $\\mathrm{m}$): $[2.0\\times 10^{-5},\\,3.0\\times 10^{-5},\\,5.0\\times 10^{-5},\\,8.0\\times 10^{-5}]$.\n- Measured pressure jumps $\\Delta p$ (in $\\mathrm{Pa}$): $[7401.6,\\,4886.4,\\,2914.56,\\,1816.2]$.\n\nTest case $2$ (medium grid):\n- Grid spacing $h$: $1.25\\times 10^{-6}\\,\\mathrm{m}$.\n- Radii $R$ (in $\\mathrm{m}$): $[2.0\\times 10^{-5},\\,3.0\\times 10^{-5},\\,5.0\\times 10^{-5},\\,8.0\\times 10^{-5}]$.\n- Measured pressure jumps $\\Delta p$ (in $\\mathrm{Pa}$): $[7286.4,\\,4838.4,\\,2894.4,\\,1805.4]$.\n\nTest case $3$ (fine grid):\n- Grid spacing $h$: $6.25\\times 10^{-7}\\,\\mathrm{m}$.\n- Radii $R$ (in $\\mathrm{m}$): $[2.0\\times 10^{-5},\\,3.0\\times 10^{-5},\\,5.0\\times 10^{-5},\\,8.0\\times 10^{-5}]$.\n- Measured pressure jumps $\\Delta p$ (in $\\mathrm{Pa}$): $[7243.2,\\,4819.2,\\,2885.76,\\,1801.8]$.\n\nPhysical units and numerical requirements:\n- Radii must be treated in $\\mathrm{m}$, pressure in $\\mathrm{Pa}$, and interfacial tension in $\\mathrm{N}/\\mathrm{m}$.\n- The final reported interfacial tensions must be expressed in $\\mathrm{N}/\\mathrm{m}$ as floats, and the deviations as dimensionless floats.\n- Round each reported float to $6$ significant figures.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list enclosed in square brackets, ordered as $[\\gamma_1,\\varepsilon_{\\mathrm{rms},1},\\gamma_2,\\varepsilon_{\\mathrm{rms},2},\\gamma_3,\\varepsilon_{\\mathrm{rms},3}]$, where each $\\gamma_i$ is in $\\mathrm{N}/\\mathrm{m}$ and each $\\varepsilon_{\\mathrm{rms},i}$ is dimensionless, all rounded to $6$ significant figures.",
            "solution": "This problem requires analyzing simulated data for a spherical droplet to verify the Young-Laplace law and extract the interfacial tension, $\\gamma$. The solution involves performing a linear regression on the provided data for three different grid resolutions.\n\n**1. Theoretical Background**\n\nThe Young-Laplace equation relates the pressure jump, $\\Delta p$, across a curved interface to the interfacial tension, $\\gamma$, and the mean curvature, $\\kappa$:\n$$\n\\Delta p = \\gamma \\kappa\n$$\nFor a spherical droplet of radius $R$, the two principal radii of curvature are both equal to $R$. The mean curvature is therefore:\n$$\n\\kappa = \\frac{1}{R} + \\frac{1}{R} = \\frac{2}{R}\n$$\nSubstituting this into the Young-Laplace equation gives the specific relationship for this problem:\n$$\n\\Delta p = \\gamma \\left(\\frac{2}{R}\\right) = (2\\gamma) \\frac{1}{R}\n$$\nThis equation shows a linear relationship between the pressure jump, $\\Delta p$, and the reciprocal of the radius, $1/R$.\n\n**2. Linear Regression Analysis**\n\nWe are asked to fit the data to the linear model $y = mx + b$, where:\n- The response variable is $y = \\Delta p$.\n- The predictor variable is $x = 1/R$.\n\nBy comparing the empirical model $y = mx + b$ to the theoretical equation $\\Delta p = (2\\gamma)x$, we can identify the regression slope $m$ with the term $2\\gamma$. Therefore, the interfacial tension can be calculated from the slope of the fitted line:\n$$\n\\gamma = \\frac{m}{2}\n$$\nThe intercept, $b$, should ideally be zero. A non-zero intercept in the regression can indicate systematic errors in the numerical simulation.\n\n**3. Error Quantification**\n\nAfter obtaining the slope $m$ and intercept $b$ from the regression, we calculate the fitted pressure values, $\\hat{y}_i = m x_i + b$, for each data point. The quality of the fit is assessed using the root-mean-square relative deviation, $\\varepsilon_{\\mathrm{rms}}$, defined as:\n$$\n\\varepsilon_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\left(\\frac{y_i - \\hat{y}_i}{y_i}\\right)^2}\n$$\nThis metric gives an average measure of the fractional error between the measured data and the linear model.\n\n**4. Implementation**\n\nThe provided Python code in the answer block implements this procedure for each of the three test cases.\n1.  It defines the radii and pressure data for each case.\n2.  For each case, it calculates the predictor variable `x = 1/R`.\n3.  It uses `numpy.polyfit(x, y, 1)` to perform the unweighted least-squares linear regression, which returns the slope `m` and intercept `b`.\n4.  It calculates the interfacial tension `gamma = m / 2`.\n5.  It computes the fitted values `y_hat` and then calculates `eps_rms` using the specified formula.\n6.  Finally, it rounds the results for `gamma` and `eps_rms` to six significant figures and prints them in the required comma-separated format.\n\nThe results from the three test cases (coarse, medium, and fine grids) allow for an assessment of convergence. As the grid spacing `h` decreases, we expect the calculated $\\gamma$ to approach a constant value and the error $\\varepsilon_{\\mathrm{rms}}$ to decrease, indicating that the simulation is more accurately capturing the underlying physics.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem of inferring interfacial tension from pressure jump\n    and radius data using linear regression for three test cases corresponding\n    to different grid resolutions.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Coarse grid\n        {\n            \"radii\": np.array([2.0e-5, 3.0e-5, 5.0e-5, 8.0e-5]),\n            \"pressures\": np.array([7401.6, 4886.4, 2914.56, 1816.2]),\n        },\n        # Case 2: Medium grid\n        {\n            \"radii\": np.array([2.0e-5, 3.0e-5, 5.0e-5, 8.0e-5]),\n            \"pressures\": np.array([7286.4, 4838.4, 2894.4, 1805.4]),\n        },\n        # Case 3: Fine grid\n        {\n            \"radii\": np.array([2.0e-5, 3.0e-5, 5.0e-5, 8.0e-5]),\n            \"pressures\": np.array([7243.2, 4819.2, 2885.76, 1801.8]),\n        },\n    ]\n\n    results = []\n\n    def round_to_sf(value, sig_figs):\n        \"\"\"\n        Rounds a floating-point number to a specified number of significant figures.\n        \"\"\"\n        if value == 0:\n            return 0.0\n        # Calculate the number of decimal places needed for rounding\n        # based on the magnitude of the number.\n        log_val = math.log10(abs(value))\n        decimal_places = sig_figs - 1 - int(math.floor(log_val))\n        return round(value, decimal_places)\n\n    for case in test_cases:\n        # Extract radii (R) and pressure jumps (delta_p) for the current case.\n        # The radii are given in meters (m) and pressures in Pascals (Pa).\n        R = case[\"radii\"]\n        delta_p = case[\"pressures\"]\n\n        # The Young-Laplace equation for a spherical interface is delta_p = 2*gamma/R.\n        # This can be rewritten as delta_p = (2*gamma) * (1/R).\n        # We fit a linear model y = m*x + b, where y = delta_p and x = 1/R.\n        \n        # Construct the predictor vector x = 1/R and response vector y = delta_p.\n        x = 1.0 / R\n        y = delta_p\n\n        # Perform unweighted least-squares linear regression to find the slope (m)\n        # and intercept (b). numpy.polyfit with degree 1 achieves this.\n        # The coefficients are returned in descending order of power, so m is the first element.\n        m, b = np.polyfit(x, y, 1)\n\n        # From the linear relationship, the slope m corresponds to 2*gamma.\n        # We can therefore deduce the interfacial tension gamma.\n        gamma = m / 2.0  # units: (Pa * m) = (N/m^2 * m) = N/m\n\n        # Calculate the fitted pressure values (y_hat) using the regression model.\n        y_hat = m * x + b\n\n        # Compute the root-mean-square relative deviation to quantify the quality of the fit.\n        # The formula is epsilon_rms = sqrt( (1/N) * sum( ((y_i - y_hat_i) / y_i)^2 ) )\n        relative_deviations = (y - y_hat) / y\n        eps_rms = np.sqrt(np.mean(relative_deviations**2))\n\n        # Round the final results to 6 significant figures as required.\n        gamma_rounded = round_to_sf(gamma, 6)\n        eps_rms_rounded = round_to_sf(eps_rms, 6)\n        \n        results.extend([gamma_rounded, eps_rms_rounded])\n\n    # Format the final output as a single comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}