{
    "hands_on_practices": [
        {
            "introduction": "对复杂相分离动力学的理解通常始于最简单的情形：一个静态的一维界面。本练习将引导您完成平衡界面轮廓的推导，这是相场理论中的一个经典结果。通过应用变分法，您将发现体自由能和梯度能量惩罚之间的相互作用如何产生著名的双曲正切函数轮廓。",
            "id": "4105764",
            "problem": "考虑一个二元流体混合物中的一维扩散界面模型，其守恒标量序参量为 $c(x)$，平衡剖面使粗粒化自由能泛函最小化\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^{2} + f(c) \\right) \\, dx,\n$$\n其中 $\\kappa0$，且具有对称双阱体自由能密度\n$$\nf(c) \\;=\\; \\frac{\\lambda}{4}\\,\\big(c^{2}-1\\big)^{2}, \\quad \\lambda0.\n$$\n假设一个以 $x=0$ 为中心的单调平面界面连接着两个体相，边界条件为 $c(-\\infty)=-1$，$c(+\\infty)=+1$，$c'( \\pm \\infty)=0$，并以 $c(0)=0$ 来固定平移不变性。从 $\\mathcal{F}[c]$ 的驻定作用量原理及相应的一维欧拉-拉格朗日方程出发，求解满足这些边界条件的唯一异宿剖面 $c(x)$，并用 $\\kappa$ 和 $\\lambda$ 以闭合形式表示。通过直接代入稳态欧拉-拉格朗日方程并检查无穷远处的边界条件，验证您的解是正确的。\n\n您的最终答案必须是 $c(x)$ 关于 $\\kappa$、$\\lambda$ 和 $x$ 的单个闭合形式解析表达式（无单位）。",
            "solution": "该问题要求解由自由能泛函描述的一维二元流体混合物的平衡剖面 $c(x)$：\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^{2} + f(c) \\right) \\, dx,\n$$\n其中参数 $\\kappa0$，$\\lambda0$，体自由能密度由下式给出：\n$$\nf(c) \\;=\\; \\frac{\\lambda}{4}\\,\\big(c^{2}-1\\big)^{2}.\n$$\n该剖面必须满足边界条件 $c(-\\infty)=-1$，$c(+\\infty)=+1$，$c'(\\pm\\infty)=0$ 以及对称性条件 $c(0)=0$。\n\n首先，对问题陈述进行验证。\n已知条件：\n1.  自由能泛函：$\\mathcal{F}[c] = \\int_{-\\infty}^{\\infty} \\mathcal{L}(c, c') dx$，拉格朗日密度为 $\\mathcal{L}(c, c') = \\frac{\\kappa}{2} (c')^2 + f(c)$。\n2.  梯度能量系数：$\\kappa  0$。\n3.  体自由能密度：$f(c) = \\frac{\\lambda}{4}(c^2 - 1)^2$，其中 $\\lambda  0$。\n4.  边界条件：$c(-\\infty) = -1$，$c(+\\infty) = +1$，$c'(\\pm\\infty) = 0$。\n5.  对称性条件：$c(0) = 0$。\n\n验证：\n该问题具有科学依据，描述了公认的用于稳态界面的 Cahn-Hilliard 理论。该泛函是标准的 Ginzburg-Landau 自由能，双阱势是相分离模型的典型形式。该问题是适定的，因为寻找平衡剖面是变分法中的一个经典问题。边界条件与势能 $f(c)$ 的最小值一致，该最小值出现在 $c=\\pm 1$ 处。该问题是客观、完整、一致且无歧义的。该问题有效。\n\n平衡剖面 $c(x)$ 使泛函 $\\mathcal{F}[c]$ 取极值。根据变分法，这样的剖面必须满足欧拉-拉格朗日方程。拉格朗日密度为 $\\mathcal{L}(c, c') = \\frac{\\kappa}{2} (c')^2 + f(c)$，其中 $c' = dc/dx$。欧拉-拉格朗日方程为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial c'}\\right) = 0.\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c} = \\frac{df}{dc} = f'(c)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c'} = \\kappa c'\n$$\n将这些代入欧拉-拉格朗日方程，得到：\n$$\nf'(c) - \\frac{d}{dx}(\\kappa c') = 0 \\quad \\implies \\quad \\kappa \\frac{d^2c}{dx^2} = f'(c).\n$$\n接下来，我们计算体自由能密度 $f(c)$ 的导数：\n$$\nf(c) = \\frac{\\lambda}{4}(c^4 - 2c^2 + 1)\n$$\n$$\nf'(c) = \\frac{df}{dc} = \\frac{\\lambda}{4}(4c^3 - 4c) = \\lambda(c^3 - c).\n$$\n因此，平衡剖面的微分方程为：\n$$\n\\kappa \\frac{d^2c}{dx^2} = \\lambda(c^3 - c).\n$$\n这是一个二阶非线性常微分方程。我们可以通过将两边同乘以 $c' = dc/dx$ 并对 $x$ 积分来找到一阶积分：\n$$\n\\kappa c'' c' = \\lambda(c^3 - c)c'\n$$\n$$\n\\int \\kappa \\frac{dc'}{dx} c' \\, dx = \\int \\lambda(c^3 - c)\\frac{dc}{dx} \\, dx\n$$\n$$\n\\int \\kappa c' \\, dc' = \\int \\lambda(c^3 - c) \\, dc\n$$\n$$\n\\frac{\\kappa}{2} (c')^2 = \\lambda \\left(\\frac{c^4}{4} - \\frac{c^2}{2}\\right) + C_{1},\n$$\n其中 $C_1$ 是一个积分常数。我们利用 $x \\to \\pm \\infty$ 时的边界条件（其中 $c \\to \\pm 1$ 且 $c' \\to 0$）来确定 $C_1$。使用 $c=1$ 和 $c'=0$：\n$$\n\\frac{\\kappa}{2} (0)^2 = \\lambda \\left(\\frac{1^4}{4} - \\frac{1^2}{2}\\right) + C_1 \\quad \\implies \\quad 0 = -\\frac{\\lambda}{4} + C_1 \\quad \\implies \\quad C_1 = \\frac{\\lambda}{4}.\n$$\n将 $C_1$ 代回，我们得到一阶积分：\n$$\n\\frac{\\kappa}{2} (c')^2 = \\lambda \\left(\\frac{c^4}{4} - \\frac{c^2}{2}\\right) + \\frac{\\lambda}{4} = \\frac{\\lambda}{4}(c^4 - 2c^2 + 1) = \\frac{\\lambda}{4}(c^2 - 1)^2.\n$$\n化简后得到：\n$$\n(c')^2 = \\frac{\\lambda}{2\\kappa}(c^2 - 1)^2.\n$$\n对两边取平方根：\n$$\n\\frac{dc}{dx} = \\pm \\sqrt{\\frac{\\lambda}{2\\kappa}} (c^2 - 1).\n$$\n问题指定了一个从 $c(-\\infty)=-1$ 连接到 $c(+\\infty)=+1$ 的单调递增剖面。这意味着 $dc/dx  0$。在界面区域 $-1  c  1$ 内，$(c^2 - 1)$ 项为负。为了使 $dc/dx$ 为正，我们必须选择负号：\n$$\n\\frac{dc}{dx} = - \\sqrt{\\frac{\\lambda}{2\\kappa}} (c^2 - 1) = \\sqrt{\\frac{\\lambda}{2\\kappa}} (1 - c^2).\n$$\n这是一个一阶可分离变量微分方程。我们分离变量并积分：\n$$\n\\frac{dc}{1 - c^2} = \\sqrt{\\frac{\\lambda}{2\\kappa}} \\, dx\n$$\n$$\n\\int \\frac{dc}{1 - c^2} = \\int \\sqrt{\\frac{\\lambda}{2\\kappa}} \\, dx.\n$$\n左边的积分是标准形式，$\\int \\frac{du}{1-u^2} = \\arctanh(u)$。因此：\n$$\n\\arctanh(c) = \\sqrt{\\frac{\\lambda}{2\\kappa}} x + C_2,\n$$\n其中 $C_2$ 是第二个积分常数。我们使用对称性条件 $c(0)=0$ 来求出 $C_2$：\n$$\n\\arctanh(0) = \\sqrt{\\frac{\\lambda}{2\\kappa}}(0) + C_2 \\quad \\implies \\quad 0 = C_2.\n$$\n当 $C_2=0$ 时，我们得到隐式解 $\\arctanh(c) = \\sqrt{\\frac{\\lambda}{2\\kappa}} x$。求解 $c(x)$ 得到显式闭合形式解：\n$$\nc(x) = \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right).\n$$\n最后，我们验证这个解。\n1.  检查边界条件：\n    - $c(0) = \\tanh(0) = 0$。（正确）\n    - $\\lim_{x\\to\\infty} c(x) = \\lim_{x\\to\\infty} \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right) = 1$。（正确）\n    - $\\lim_{x\\to-\\infty} c(x) = \\lim_{x\\to-\\infty} \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right) = -1$。（正确）\n    - 导数为 $c'(x) = \\sqrt{\\frac{\\lambda}{2\\kappa}} \\text{sech}^2\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)$。当 $x \\to \\pm \\infty$ 时，双曲正割函数的自变量趋于 $\\pm\\infty$，且 $\\text{sech}^2(u) \\to 0$。因此，$c'(\\pm\\infty) = 0$。（正确）\n2.  检查欧拉-拉格朗日方程：$\\kappa c'' = \\lambda(c^3-c)$。\n    令 $a = \\sqrt{\\frac{\\lambda}{2\\kappa}}$，则 $c = \\tanh(ax)$。\n    - $c' = a\\,\\text{sech}^2(ax)$。\n    - $c'' = a \\frac{d}{dx}(\\text{sech}^2(ax)) = a \\left(2\\,\\text{sech}(ax)\\right) \\left(-\\text{sech}(ax)\\tanh(ax)\\right) (a) = -2a^2\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 左边（LHS）：$\\kappa c'' = \\kappa \\left(-2a^2\\,\\text{sech}^2(ax)\\tanh(ax)\\right)$。代入 $a^2 = \\frac{\\lambda}{2\\kappa}：$\n      LHS $= \\kappa \\left(-2 \\frac{\\lambda}{2\\kappa}\\,\\text{sech}^2(ax)\\tanh(ax)\\right) = -\\lambda\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 右边（RHS）：$\\lambda(c^3 - c) = \\lambda(\\tanh^3(ax) - \\tanh(ax)) = \\lambda\\tanh(ax)(\\tanh^2(ax)-1)$。\n    - 使用恒等式 $\\tanh^2(u) - 1 = -\\text{sech}^2(u)：$\n      RHS $= \\lambda\\tanh(ax)(-\\text{sech}^2(ax)) = -\\lambda\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 因为 LHS = RHS，所以解是正确的。\n\n满足给定条件的唯一异宿剖面是 $c(x) = \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)$。",
            "answer": "$$\n\\boxed{\\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)}\n$$"
        },
        {
            "introduction": "一旦知道了界面的结构，我们就可以量化其能量成本，即界面张力。这个宏观性质是微观模型参数的直接结果。本练习要求您推导界面张力的一般表达式，并将其应用于标准的双阱势，从而巩固您对模型的自由能泛函如何与物理可测量量相关联的理解。",
            "id": "4105736",
            "problem": "考虑一个由自由能泛函导出的 Cahn-Hilliard 方程 (CH) 或 Allen-Cahn 方程 (AC) 模拟的二元流体中的一维平面平衡界面。设标量组分场为 $c(x)$，并假设已进行无量纲化，使得所有量均为无量纲量，且均匀自由能密度的体相最小值取值为零。总自由能为\n$$\n\\mathcal{F}[c]=\\int_{\\mathbb{R}}\\left(f_{0}(c)+\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^{2}\\right)\\,dx,\n$$\n其中 $f_{0}(c)$ 是一个光滑的体相自由能密度，在 $c=c_{-}$ 和 $c=c_{+}$ 处有两个相等的最小值，$\\kappa0$ 是一个常数梯度能量系数。单位面积的界面张力定义为\n$$\n\\sigma=\\int_{-\\infty}^{\\infty}\\kappa\\left(\\frac{dc}{dx}\\right)^{2}\\,dx,\n$$\n对于连接 $c(-\\infty)=c_{-}$ 和 $c(+\\infty)=c_{+}$ 的稳态界面剖面。\n\n从第一性原理出发，即在给定边界条件下 $\\mathcal{F}[c]$ 的变分平稳性，推导出一个用 $\\kappa$ 和 $f_{0}(c)$ 表示一维平衡界面 $\\sigma$ 的通用关系式。然后，对于四次对称双阱体相自由能密度\n$$\nf_{0}(c)=\\frac{A}{4}\\left(c^{2}-1\\right)^{2},\\quad A0,\n$$\n其最小值在 $c_{-}=-1$ 和 $c_{+}=+1$ 处，精确计算 $\\sigma$。以 $A$ 和 $\\kappa$ 的单个闭式解析表达式形式给出你的最终答案。不需要进行数值计算。",
            "solution": "该问题要求推导界面张力 $\\sigma$ 的一个通用关系式，并针对给定的自由能密度进行具体计算。出发点是平衡界面剖面所对应的自由能泛函的平稳性。\n\n该一维系统的总自由能由以下泛函给出\n$$\n\\mathcal{F}[c]=\\int_{-\\infty}^{\\infty}\\left(f_{0}(c)+\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^{2}\\right)\\,dx\n$$\n一个平衡（或稳态）的界面剖面 $c(x)$ 是使该泛函取极值的剖面。这是变分法中的一个经典问题。被积函数 $L(c, c') = f_0(c) + \\frac{\\kappa}{2}(c')^2$（其中 $c' \\equiv \\frac{dc}{dx}$）可视为拉格朗日密度。剖面 $c(x)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial c} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial c'}\\right) = 0\n$$\n计算偏导数：\n$$\n\\frac{\\partial L}{\\partial c} = \\frac{df_0}{dc}\n$$\n$$\n\\frac{\\partial L}{\\partial c'} = \\kappa c' = \\kappa \\frac{dc}{dx}\n$$\n将这些代入欧拉-拉格朗日方程，得到稳态剖面的控制方程：\n$$\n\\frac{df_0}{dc} - \\kappa \\frac{d^2c}{dx^2} = 0 \\quad \\implies \\quad \\kappa \\frac{d^2c}{dx^2} = \\frac{df_0}{dc}\n$$\n这个二阶常微分方程描述了平衡界面。它代表了在指定边界条件下，Allen-Cahn（非守恒序参量）和 Cahn-Hilliard（守恒序参量）动力学的稳态解（$\\mu = \\frac{\\delta\\mathcal{F}}{\\delta c} = 0$），因为平衡要求化学势在空间上是均匀的，并且必须为零以匹配体相。\n\n为了找到 $\\sigma$ 的关系式，我们可以求此方程的首次积分。由于拉格朗日量 $L(c, c')$ 不显含自变量 $x$，由贝尔特拉米恒等式给出的量是守恒的：\n$$\nc' \\frac{\\partial L}{\\partial c'} - L = \\text{常数}\n$$\n代入 $L$ 及其导数的表达式：\n$$\n\\left(\\frac{dc}{dx}\\right)\\left(\\kappa \\frac{dc}{dx}\\right) - \\left(f_0(c) + \\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2\\right) = \\text{常数}\n$$\n$$\n\\kappa\\left(\\frac{dc}{dx}\\right)^2 - f_0(c) - \\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 = \\text{常数}\n$$\n$$\n\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 - f_0(c) = \\text{常数}\n$$\n常数的值由 $x \\to \\pm\\infty$ 处的边界条件确定。我们已知当 $x \\to \\pm\\infty$ 时，$c \\to c_{\\pm}$。在这些体相区域，剖面是平坦的，因此 $\\frac{dc}{dx} \\to 0$。我们还已知体相自由能密度在其最小值处为零，$f_0(c_{\\pm}) = 0$。应用这些条件：\n$$\n\\frac{\\kappa}{2}(0)^2 - f_0(c_{\\pm}) = 0 - 0 = 0\n$$\n因此，常数为零，我们得到了一个对整个平衡剖面都成立的关键关系式：\n$$\n\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 = f_0(c)\n$$\n这个方程是稳态解的能量均分定理的陈述：在每一点 $x$ 处，梯度能量密度等于体相自由能密度。\n\n现在，我们可以找到界面张力 $\\sigma$ 的通用表达式。其定义为：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa\\left(\\frac{dc}{dx}\\right)^2 dx\n$$\n使用我们刚刚推导的关系式 $\\kappa\\left(\\frac{dc}{dx}\\right)^2 = 2f_0(c)$，我们可以写出 $\\sigma = \\int_{-\\infty}^{\\infty} 2f_0(c(x))dx$。然而，通过将积分变量从 $x$ 变为 $c$，可以得到一个更便于计算的形式。根据我们的首次积分，假设 $c$ 从 $c_{-}$ 增加到 $c_{+}$，我们有 $\\frac{dc}{dx} = \\sqrt{\\frac{2f_0(c)}{\\kappa}}$。我们可以写出：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa \\left(\\frac{dc}{dx}\\right) \\left(\\frac{dc}{dx} dx\\right) = \\int_{c(-\\infty)}^{c(+\\infty)} \\kappa \\left(\\frac{dc}{dx}\\right) dc\n$$\n将 $\\frac{dc}{dx} = \\sqrt{\\frac{2f_0(c)}{\\kappa}}$ 代入此积分：\n$$\n\\sigma = \\int_{c_{-}}^{c_{+}} \\kappa \\sqrt{\\frac{2f_0(c)}{\\kappa}} dc = \\int_{c_{-}}^{c_{+}} \\sqrt{2\\kappa f_0(c)} dc\n$$\n这就是所要求的用 $\\kappa$ 和 $f_0(c)$ 表示的界面张力 $\\sigma$ 的通用关系式。\n\n接下来，我们将这个通用关系式应用于四次双阱势的具体情况：\n$$\nf_{0}(c)=\\frac{A}{4}\\left(c^{2}-1\\right)^{2}, \\quad A0\n$$\n其最小值在 $c_{-} = -1$ 和 $c_{+} = +1$。\n将这种形式的 $f_0(c)$ 代入 $\\sigma$ 的表达式：\n$$\n\\sigma = \\int_{-1}^{1} \\sqrt{2\\kappa \\left(\\frac{A}{4}(c^2-1)^2\\right)} dc\n$$\n$$\n\\sigma = \\int_{-1}^{1} \\sqrt{\\frac{A\\kappa}{2}(c^2-1)^2} dc = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{1} \\sqrt{(c^2-1)^2} dc\n$$\n项 $\\sqrt{(c^2-1)^2}$ 等于绝对值 $|c^2-1|$。对于积分范围 $c \\in [-1, 1]$，表达式 $c^2-1$ 是非正的。因此， $|c^2-1| = -(c^2-1) = 1-c^2$。积分变为：\n$$\n\\sigma = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{1} (1-c^2) dc\n$$\n我们现在计算这个基本积分：\n$$\n\\int_{-1}^{1} (1-c^2) dc = \\left[c - \\frac{c^3}{3}\\right]_{-1}^{1} = \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right)\n$$\n$$\n= \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回 $\\sigma$ 的表达式：\n$$\n\\sigma = \\sqrt{\\frac{A\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{4}{3\\sqrt{2}} \\sqrt{A\\kappa} = \\frac{4\\sqrt{2}}{3 \\cdot 2} \\sqrt{A\\kappa} = \\frac{2\\sqrt{2}}{3} \\sqrt{A\\kappa}\n$$\n这个表达式可以重写为：\n$$\n\\sigma = \\frac{2}{3}\\sqrt{2A\\kappa}\n$$\n这就是界面张力的最终闭式解析表达式。",
            "answer": "$$ \\boxed{\\frac{2}{3}\\sqrt{2A\\kappa}} $$"
        },
        {
            "introduction": "解析解仅限于简单情况；真实的模拟依赖于能够忠实再现底层物理的稳健数值格式。本练习将带您进入计算实践的核心，要求您为 Cahn-Hilliard 方程构建一个数值通量。您的目标是设计一个既能保证质量守恒又能保证自由能耗散的格式，这是任何相场模拟的稳定性和物理准确性所必需的两个基本性质。",
            "id": "4105720",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域，该区域被一个包含 $N$ 个单元、间距为 $h = L/N$ 的均匀网格离散化。设 $\\{\\phi_i(t)\\}_{i=0}^{N-1}$ 表示单元平均的序参量，其演化遵循 Cahn–Hilliard 方程，该方程在每个节点上表示为守恒型平衡律，\n$$\n\\frac{d \\phi_i}{d t} \\;=\\; -\\,\\frac{J_{i+1/2} \\;-\\; J_{i-1/2}}{h},\n$$\n其中 $J_{i+1/2}$ 是单元 $i$ 和 $i+1$ 之间的单值界面通量，且由于周期性，下标对 $N$ 取模。自由能离散化为\n$$\n\\mathcal{F}_h(\\phi) \\;=\\; \\sum_{i=0}^{N-1} h \\left[ f(\\phi_i) \\;+\\; \\frac{\\kappa}{2}\\left(\\frac{\\phi_{i+1}-\\phi_i}{h}\\right)^{2} \\right],\n$$\n其中 $f(\\cdot)$ 是一个光滑的体自由能密度，$\\kappa0$ 是梯度能量系数。通过与 $\\mathcal{F}_h$ 一致的离散变分导数，在单元中心定义离散化学势，\n$$\n\\mu_i \\;=\\; f'(\\phi_i) \\;-\\; \\kappa\\,\\Delta_h \\phi_i,\n\\qquad\n\\Delta_h \\phi_i \\;=\\; \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^{2}}.\n$$\n设 $M(\\phi)$ 表示一个正的迁移率，并通过算术平均定义一个对称的界面迁移率\n$$\nM_{i+1/2} \\;=\\; \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2}.\n$$\n构建一个二阶精确、中心化的有限体积界面通量 $J_{i+1/2}$，该通量用 $\\{\\phi_{i-1},\\phi_i,\\phi_{i+1},\\phi_{i+2}\\}$, $h$, $\\kappa$, $f'(\\cdot)$ 和 $M(\\cdot)$ 显式表示，使得以下两个性质同时成立：\n- 与离散散度定理（分部求和恒等式）一致的离散质量守恒：在周期性边界条件下，节点源的全局总和为零，即，\n$$\n\\sum_{i=0}^{N-1} \\left(J_{i+1/2} - J_{i-1/2}\\right) \\;=\\; 0,\n$$\n因此 $\\sum_{i=0}^{N-1} h\\,\\phi_i(t)$ 不随时间变化。\n- 与 $L^2$ 梯度流结构相容的离散自由能耗散：对于上述 $\\mu_i$，半离散动力学系统满足\n$$\n\\frac{d\\mathcal{F}_h}{dt} \\;\\le\\; 0\n$$\n对所有状态成立，只要 $M(\\phi)0$。\n\n请以单个闭式解析表达式的形式提供您最终的界面通量公式 $J_{i+1/2}$。不需要任何数值。您的答案必须是单个表达式；请勿在答案框中包含推导过程。",
            "solution": "该问题是有效的，因为它代表了偏微分方程数值分析中的一个适定且标准的任务，具体而言，就是为 Cahn-Hilliard 方程构建一个能量稳定、守恒且二阶精确的有限体积格式。所有给出的定义和约束在科学上是合理的，在数学上是一致的。\n\n目标是找到满足指定性质的界面通量 $J_{i+1/2}$ 的表达式。\n\n首先，我们处理质量守恒性质。演化方程以守恒型有限体积形式给出：\n$$\n\\frac{d \\phi_i}{d t} = -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h}\n$$\n总质量（或序参量的总和）为 $m(t) = \\sum_{i=0}^{N-1} h\\,\\phi_i(t)$。其时间导数为：\n$$\n\\frac{dm}{dt} = \\sum_{i=0}^{N-1} h \\frac{d\\phi_i}{dt} = \\sum_{i=0}^{N-1} h \\left( -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h} \\right) = -\\sum_{i=0}^{N-1} (J_{i+1/2} - J_{i-1/2})\n$$\n这是一个伸缩求和。由于周期性边界条件（其中下标对 $N$ 取模，因此 $J_{-1/2} \\equiv J_{N-1/2}$ 且 $J_{N+1/2} \\equiv J_{1/2}$），该和为零：\n$$\n-\\sum_{i=0}^{N-1} (J_{i+1/2} - J_{i-1/2}) = -(J_{1/2}-J_{-1/2}) - (J_{3/2}-J_{1/2}) - \\dots - (J_{N-1/2}-J_{N-3/2}) - (J_{1/2}-J_{N-1/2}) = 0\n$$\n因此，$\\frac{dm}{dt}=0$，对于任何单值通量 $J_{i+1/2}$，总质量都是守恒的。这个性质是周期性区域上有限体积结构所固有的，并没有对 $J_{i+1/2}$ 的形式施加进一步的约束。\n\n其次，我们处理自由能耗散性质，$\\frac{d\\mathcal{F}_h}{dt} \\le 0$。我们使用链式法则计算离散自由能 $\\mathcal{F}_h$ 的时间导数：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = \\sum_{i=0}^{N-1} \\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i} \\frac{d\\phi_i}{dt}\n$$\n问题将离散化学势 $\\mu_i$ 定义为变分导数 $\\mu_i = \\frac{1}{h} \\frac{\\delta \\mathcal{F}_h}{\\delta \\phi_i}$。问题陈述中提供的 $\\mu_i$ 定义与 $\\mu_i = \\frac{1}{h} \\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i}$ 是一致的。因此，$\\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i} = h \\mu_i$。将此式及 $\\phi_i$ 的演化方程代入可得：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = \\sum_{i=0}^{N-1} (h \\mu_i) \\left( -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h} \\right) = - \\sum_{i=0}^{N-1} \\mu_i (J_{i+1/2} - J_{i-1/2})\n$$\n我们对周期序列应用分部求和恒等式 $\\sum_{i=0}^{N-1} a_i (b_{i+1/2} - b_{i-1/2}) = - \\sum_{i=0}^{N-1} (a_{i+1} - a_i) b_{i+1/2}$。令 $a_i = \\mu_i$ 和 $b_{i+1/2} = J_{i+1/2}$，我们得到：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = - \\left( - \\sum_{i=0}^{N-1} (\\mu_{i+1} - \\mu_i) J_{i+1/2} \\right) = \\sum_{i=0}^{N-1} (\\mu_{i+1} - \\mu_i) J_{i+1/2}\n$$\n为保证对任何状态都有 $\\frac{d\\mathcal{F}_h}{dt} \\le 0$，我们可以要求和中的每一项都是非正的。这可以通过设计一个与化学势差 $(\\mu_{i+1} - \\mu_i)$ 的负值直接相关的通量 $J_{i+1/2}$ 来实现。让我们提出一个形式如下的通量：\n$$\nJ_{i+1/2} = - \\Gamma_{i+1/2} (\\mu_{i+1} - \\mu_i)\n$$\n其中 $\\Gamma_{i+1/2}$ 是一个正常数。采用这种选择，能量耗散率变为：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = - \\sum_{i=0}^{N-1} \\Gamma_{i+1/2} (\\mu_{i+1} - \\mu_i)^2\n$$\n由于 $\\Gamma_{i+1/2}  0$ 且 $(\\mu_{i+1} - \\mu_i)^2 \\ge 0$，条件 $\\frac{d\\mathcal{F}_h}{dt} \\le 0$ 得以满足。\n\n连续的 Cahn-Hilliard 通量是 $J = - M(\\phi) \\nabla \\mu$。在界面 $i+1/2$ 处，该通量的一个二阶精确、中心离散化是 $J_{i+1/2} = - M_{i+1/2} (\\nabla_h \\mu)_{i+1/2}$，其中 $M_{i+1/2}$ 是界面上的迁移率，而 $(\\nabla_h \\mu)_{i+1/2}$ 是梯度 $\\frac{\\partial \\mu}{\\partial x}$ 的一个中心近似。我们使用给定的迁移率算术平均值 $M_{i+1/2} = \\frac{M(\\phi_i) + M(\\phi_{i+1})}{2}$，以及梯度的标准中心差分 $(\\nabla_h \\mu)_{i+1/2} = \\frac{\\mu_{i+1} - \\mu_i}{h}$。这给出的通量为：\n$$\nJ_{i+1/2} = - M_{i+1/2} \\frac{\\mu_{i+1} - \\mu_i}{h}\n$$\n这个形式对应于我们之前的结构，其中 $\\Gamma_{i+1/2} = \\frac{M_{i+1/2}}{h}$。由于 $M(\\phi)0$，我们有 $M_{i+1/2}0$，并且因为 $h0$，$\\Gamma_{i+1/2}0$ 得到保证。所有算子都是中心化的，确保了二阶空间精度。\n\n最后，我们通过代入 $\\mu_i$ 的定义来构建 $J_{i+1/2}$ 的显式表达式。首先，我们计算差值 $\\mu_{i+1} - \\mu_i$：\n$$\n\\mu_{i+1} = f'(\\phi_{i+1}) - \\kappa\\,\\frac{\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i}}{h^{2}}\n$$\n$$\n\\mu_{i} = f'(\\phi_i) - \\kappa\\,\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^{2}}\n$$\n$$\n\\mu_{i+1} - \\mu_i = \\left( f'(\\phi_{i+1}) - f'(\\phi_i) \\right) - \\frac{\\kappa}{h^2} \\left[ (\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i}) - (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) \\right]\n$$\n简化方括号中的项：\n$$\n\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i} - \\phi_{i+1} + 2\\phi_i - \\phi_{i-1} = \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1}\n$$\n所以，化学势差为：\n$$\n\\mu_{i+1} - \\mu_i = f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^2} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right)\n$$\n将此式代入 $J_{i+1/2}$ 的表达式中：\n$$\nJ_{i+1/2} = - \\frac{M_{i+1/2}}{h} (\\mu_{i+1} - \\mu_i) = - \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2h} \\left[ f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^2} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right) \\right]\n$$\n该表达式代表了通量的最终形式，它依赖于模板 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ 并满足所有要求的性质。",
            "answer": "$$\n\\boxed{- \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2h} \\left( f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^{2}} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right) \\right)}\n$$"
        }
    ]
}