{
    "hands_on_practices": [
        {
            "introduction": "格子玻尔兹曼方法 (Lattice Boltzmann Method, LBM) 由两个主要步骤组成：迁移 (streaming) 和碰撞 (collision)。为了真正理解它们各自的作用，将它们孤立分析是一种富有洞察力的方法。这个思想实验将碰撞步骤关闭，使我们能够纯粹地关注迁移过程的特性，通过考察在周期性网格上仅有迁移作用时宏观量的演化，您将对信息如何在格子上内在地守恒建立起基本理解。",
            "id": "4092461",
            "problem": "考虑格子玻尔兹曼方法（LBM），其离散速度为 $\\{\\mathbf{c}_i\\}_{i=0}^{Q-1}$，分布函数为 $f_i(\\mathbf{x},t)$，作用于一个大小为 $N_x \\times N_y$ 的二维周期性网格上。宏观密度和动量分别定义为 $\\rho(\\mathbf{x},t) = \\sum_{i=0}^{Q-1} f_i(\\mathbf{x},t)$ 和 $\\rho(\\mathbf{u})(\\mathbf{x},t) = \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x},t)$。在 Bhatnagar-Gross-Krook (BGK) 和多松弛时间 (MRT) 碰撞模型中，碰撞算子都是通过一个松弛过程在 $f_i(\\mathbf{x},t)$ 上进行局部作用。在这个思想实验中，碰撞被禁用，因此碰撞算子恒等于零，即 $\\Omega_i(\\mathbf{x},t) = 0$，演化过程简化为自由迁移\n$$\nf_i(\\mathbf{x} + \\mathbf{c}_i \\Delta t,\\, t + \\Delta t) = f_i(\\mathbf{x},t),\n$$\n且在两个方向上都具有严格的周期性边界条件。从一个任意的、非均匀的初始条件 $f_i(\\mathbf{x},0)$ 开始，分析在迁移作用下 $\\rho(\\mathbf{x},t)$ 和 $\\mathbf{u}(\\mathbf{x},t)$ 的演化过程，并确定在周期性网格上有哪些宏观量随时间保持守恒。\n\n在上述条件下，以下哪些陈述是正确的？\n\nA. 总质量 $\\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t)$ 对所有 $t$ 保持严格恒定。\n\nB. 总动量 $\\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t)\\,\\mathbf{u}(\\mathbf{x},t)$ 对所有 $t$ 保持严格恒定。\n\nC. 逐点密度 $\\rho(\\mathbf{x},t)$ 在每个 $\\mathbf{x}$ 处随时间保持恒定。\n\nD. 全局二阶矩 $\\sum_{\\mathbf{x}}\\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2\\, f_i(\\mathbf{x},t)$ 对所有 $t$ 保持严格恒定。\n\nE. 宏观动能 $\\sum_{\\mathbf{x}} \\tfrac{1}{2}\\,\\rho(\\mathbf{x},t)\\,\\|\\mathbf{u}(\\mathbf{x},t)\\|^2$ 对所有 $t$ 保持严格恒定。\n\nF. 对于每个离散速度索引 $i$，值的多重集 $\\{ f_i(\\mathbf{x},t) : \\mathbf{x} \\text{ 在网格中}\\}$ 随时间不变（即，迁移过程置换了 $\\mathbf{x}$ 位置上的值，但没有改变这些值的集合）。",
            "solution": "用户要求对问题陈述进行严格验证，然后完整推导求解过程并评估所有选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   系统：格子玻尔兹曼方法（LBM）。\n-   区域：一个大小为 $N_x \\times N_y$ 的二维周期性网格。\n-   变量：离散速度 $\\{\\mathbf{c}_i\\}_{i=0}^{Q-1}$，对应一组分布函数 $f_i(\\mathbf{x},t)$。\n-   宏观定义：\n    -   密度：$\\rho(\\mathbf{x},t) = \\sum_{i=0}^{Q-1} f_i(\\mathbf{x},t)$。\n    -   动量：$\\rho(\\mathbf{u})(\\mathbf{x},t) = \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x},t)$。\n-   动力学：碰撞算子恒等于零，$\\Omega_i(\\mathbf{x},t) = 0$。系统动力学完全由迁移方程决定：\n    $$f_i(\\mathbf{x} + \\mathbf{c}_i \\Delta t,\\, t + \\Delta t) = f_i(\\mathbf{x},t)$$\n-   边界条件：两个空间方向上均严格周期。\n-   初始条件：分布函数的一个任意、非均匀的初始条件，$f_i(\\mathbf{x},0)$。\n-   目标：确定所列出的宏观量中哪些是随时间守恒的。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：**该问题描述了在格子玻尔兹曼方法的既定框架内一个有效的思想实验。迁移步是 LBM 算法的一个基本组成部分，单独分析其性质是一种标准的教学和理论练习。宏观密度和动量的定义是标准的。该问题没有任何科学不准确或伪科学的内容。\n-   **适定性：**该问题是适定的。演化方程是确定性的，区域已指定（周期性网格），并且初始条件的性质已定义。问题要求确定守恒量，这对于给定的动力系统来说是一个定义明确的数学问题。\n-   **客观性：**语言正式、精确且客观，使用了计算物理学的标准术语。没有主观或含糊的陈述。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它是科学合理的、适定的和客观的。我将继续进行求解。\n\n### 求解推导\n\n系统动力学完全由周期性网格上的自由迁移步骤决定。演化方程为：\n$$f_i(\\mathbf{x} + \\mathbf{c}_i \\Delta t,\\, t + \\Delta t) = f_i(\\mathbf{x},t)$$\n这意味着分布函数 $f_i$ 在 $t$ 时刻 $\\mathbf{x}$ 位置的值被传输到下一个时间步 $t + \\Delta t$ 的 $\\mathbf{x} + \\mathbf{c}_i \\Delta t$ 位置。等价地，在 $t+\\Delta t$ 时刻 $\\mathbf{x}$ 位置的值来源于 $t$ 时刻的 $\\mathbf{x} - \\mathbf{c}_i \\Delta t$ 位置：\n$$f_i(\\mathbf{x}, t + \\Delta t) = f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t)$$\n在周期性网格上，这个过程的一个关键特征是，对于任何函数 $g(\\mathbf{x})$，对所有网格点的求和对于其自变量的常数平移是不变的：$\\sum_{\\mathbf{x}} g(\\mathbf{x}) = \\sum_{\\mathbf{x}} g(\\mathbf{x} - \\mathbf{a})$，其中求和遍历所有网格节点 $\\mathbf{x}$，$\\mathbf{a}$ 是一个常数矢量位移。这是因为映射 $\\mathbf{x} \\mapsto \\mathbf{x} - \\mathbf{a}$ 是网格点的一个置换。\n\n我们现在来评估每个陈述。\n\n**A. 总质量 $\\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t)$ 对所有 t 保持严格恒定。**\n\n$t$ 时刻的总质量为 $M(t) = \\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} f_i(\\mathbf{x},t)$。\n我们来计算 $t + \\Delta t$ 时刻的总质量：\n$$M(t+\\Delta t) = \\sum_{\\mathbf{x}} \\rho(\\mathbf{x}, t+\\Delta t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} f_i(\\mathbf{x}, t+\\Delta t)$$\n使用迁移规则：\n$$M(t+\\Delta t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t)$$\n我们可以交换求和顺序：\n$$M(t+\\Delta t) = \\sum_{i=0}^{Q-1} \\left( \\sum_{\\mathbf{x}} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t) \\right)$$\n由于网格的周期性，对平移后坐标 $\\mathbf{x} - \\mathbf{c}_i \\Delta t$ 的求和等于对原始坐标的求和。令 $\\mathbf{y} = \\mathbf{x} - \\mathbf{c}_i \\Delta t$。当 $\\mathbf{x}$ 遍历所有网格点时，$\\mathbf{y}$ 也同样遍历所有网格点。\n$$\\sum_{\\mathbf{x}} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t) = \\sum_{\\mathbf{y}} f_i(\\mathbf{y}, t)$$\n将此代回，我们得到：\n$$M(t+\\Delta t) = \\sum_{i=0}^{Q-1} \\sum_{\\mathbf{y}} f_i(\\mathbf{y}, t) = \\sum_{\\mathbf{y}} \\sum_{i=0}^{Q-1} f_i(\\mathbf{y}, t) = \\sum_{\\mathbf{y}} \\rho(\\mathbf{y}, t) = M(t)$$\n总质量是守恒的。\n**结论：正确。**\n\n**B. 总动量 $\\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t)\\,\\mathbf{u}(\\mathbf{x},t)$ 对所有 t 保持严格恒定。**\n\n$t$ 时刻的总动量为 $\\mathbf{P}(t) = \\sum_{\\mathbf{x}} \\rho(\\mathbf{x},t)\\mathbf{u}(\\mathbf{x},t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x},t)$。\n在 $t+\\Delta t$ 时刻：\n$$\\mathbf{P}(t+\\Delta t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x}, t+\\Delta t) = \\sum_{\\mathbf{x}} \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t)$$\n交换求和顺序：\n$$\\mathbf{P}(t+\\Delta t) = \\sum_{i=0}^{Q-1} \\mathbf{c}_i \\left( \\sum_{\\mathbf{x}} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t) \\right)$$\n使用与总质量相同的周期性论证：\n$$\\mathbf{P}(t+\\Delta t) = \\sum_{i=0}^{Q-1} \\mathbf{c}_i \\left( \\sum_{\\mathbf{y}} f_i(\\mathbf{y}, t) \\right) = \\sum_{\\mathbf{y}} \\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{y}, t) = \\mathbf{P}(t)$$\n总动量是守恒的。\n**结论：正确。**\n\n**C. 逐点密度 $\\rho(\\mathbf{x},t)$ 在每个 $\\mathbf{x}$ 处随时间保持恒定。**\n\n$t+\\Delta t$ 时刻的逐点密度为：\n$$\\rho(\\mathbf{x}, t+\\Delta t) = \\sum_{i=0}^{Q-1} f_i(\\mathbf{x}, t+\\Delta t) = \\sum_{i=0}^{Q-1} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t)$$\n要使其恒定，我们需要对所有 $\\mathbf{x}$ 和 $t$ 都有 $\\sum_{i=0}^{Q-1} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t) = \\sum_{i=0}^{Q-1} f_i(\\mathbf{x}, t)$。\n问题陈述初始条件 $f_i(\\mathbf{x},0)$ 是任意且非均匀的。对于这样的一般状态，不同位置 $\\mathbf{x}$ 和 $\\mathbf{x} - \\mathbf{c}_i \\Delta t$ 处的 $f_i$ 值将会不同。迁移过程正是导致密度和速度发生局部变化的机制，从而引发流体动力学。因此，逐点密度不守恒。\n**结论：错误。**\n\n**D. 全局二阶矩 $\\sum_{\\mathbf{x}}\\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2\\, f_i(\\mathbf{x},t)$ 对所有 t 保持严格恒定。**\n\n令 $S_2(t) = \\sum_{\\mathbf{x}}\\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2\\, f_i(\\mathbf{x},t)$。这是一个全局量，是分布函数 $f_i$ 的一个线性泛函。选项 A 和 B 中使用的逻辑可以直接应用。\n$$S_2(t+\\Delta t) = \\sum_{\\mathbf{x}}\\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2\\, f_i(\\mathbf{x}, t+\\Delta t) = \\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2 \\left( \\sum_{\\mathbf{x}} f_i(\\mathbf{x} - \\mathbf{c}_i \\Delta t, t) \\right)$$\n再次使用周期性：\n$$S_2(t+\\Delta t) = \\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2 \\left( \\sum_{\\mathbf{y}} f_i(\\mathbf{y}, t) \\right) = \\sum_{\\mathbf{y}} \\sum_{i=0}^{Q-1} \\|\\mathbf{c}_i\\|^2 f_i(\\mathbf{y}, t) = S_2(t)$$\n这个全局二阶矩是守恒的。\n**结论：正确。**\n\n**E. 宏观动能 $\\sum_{\\mathbf{x}} \\tfrac{1}{2}\\,\\rho(\\mathbf{x},t)\\,\\|\\mathbf{u}(\\mathbf{x},t)\\|^2$ 对所有 t 保持严格恒定。**\n\n宏观动能是 $K(t) = \\sum_{\\mathbf{x}} \\frac{1}{2} \\rho(\\mathbf{x},t) \\|\\mathbf{u}(\\mathbf{x},t)\\|^2$。\n我们可以用分布函数来表示它：\n$$K(t) = \\sum_{\\mathbf{x}} \\frac{1}{2} \\rho(\\mathbf{x},t) \\left\\| \\frac{\\rho(\\mathbf{x},t)\\mathbf{u}(\\mathbf{x},t)}{\\rho(\\mathbf{x},t)} \\right\\|^2 = \\sum_{\\mathbf{x}} \\frac{\\|\\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x},t)\\|^2}{2 \\sum_{j=0}^{Q-1} f_j(\\mathbf{x},t)}$$\n被加数是局部自分布函数 $f_i(\\mathbf{x},t)$ 的一个非线性函数。在下一个时间步，新的局部分布是 $f_i(\\mathbf{x}, t+\\Delta t) = f_i(\\mathbf{x}-\\mathbf{c}_i\\Delta t, t)$。新的动能是：\n$$K(t+\\Delta t) = \\sum_{\\mathbf{x}} \\frac{\\|\\sum_{i=0}^{Q-1} \\mathbf{c}_i f_i(\\mathbf{x}-\\mathbf{c}_i\\Delta t,t)\\|^2}{2 \\sum_{j=0}^{Q-1} f_j(\\mathbf{x}-\\mathbf{c}_j\\Delta t,t)}$$\n这个表达式涉及对一个非线性函数的网格求和，其自变量是在前一时间步从不同位置提取的 $f_i$ 值。对于任意初始状态，没有普适原理能保证这个和等于 $K(t)$。迁移过程重新排列了网格上的 $f_i$ 值，这改变了 $\\rho$ 和 $\\mathbf{u}$ 的局部值，从而也改变了局部动能 $\\frac{1}{2}\\rho\\|\\mathbf{u}\\|^2$。这些变化的局部值的总和通常不守恒。\n**结论：错误。**\n\n**F. 对于每个离散速度索引 $i$，值的多重集 $\\{ f_i(\\mathbf{x},t) : \\mathbf{x} \\text{ 在网格中}\\}$ 随时间不变（即，迁移过程置换了 $\\mathbf{x}$ 位置上的值，但没有改变这些值的集合）。**\n\n令 $\\mathcal{M}_i(t)$ 为在 $t$ 时刻，第 $i$ 个分布函数在所有网格点 $\\mathbf{x}$ 上的值的多重集。\n$$\\mathcal{M}_i(t) = \\{ f_i(\\mathbf{x},t) \\mid \\mathbf{x} \\text{ 是一个网格点} \\}$$\n在 $t+\\Delta t$ 时刻，多重集为 $\\mathcal{M}_i(t+\\Delta t) = \\{ f_i(\\mathbf{y},t+\\Delta t) \\mid \\mathbf{y} \\text{ 是一个网格点} \\}$。\n使用迁移规则 $f_i(\\mathbf{y},t+\\Delta t) = f_i(\\mathbf{y} - \\mathbf{c}_i \\Delta t, t)$：\n$$\\mathcal{M}_i(t+\\Delta t) = \\{ f_i(\\mathbf{y} - \\mathbf{c}_i \\Delta t, t) \\mid \\mathbf{y} \\text{ 是一个网格点} \\}$$\n令 $\\mathbf{x} = \\mathbf{y} - \\mathbf{c}_i \\Delta t$。因为网格是周期性的，映射 $\\mathbf{y} \\mapsto \\mathbf{x}$ 是网格点的一个置换。因此，所有点 $\\{\\mathbf{x}\\}$ 的集合与所有点 $\\{\\mathbf{y}\\}$ 的集合是相同的。\n$$\\mathcal{M}_i(t+\\Delta t) = \\{ f_i(\\mathbf{x}, t) \\mid \\mathbf{x} \\text{ 是一个网格点} \\} = \\mathcal{M}_i(t)$$\n这表明，对于每个速度索引 $i$，整个网格上所有 $f_i$ 值的集合在迁移过程中保持不变；这些值只是在网格点之间进行了置换。\n**结论：正确。**",
            "answer": "$$\\boxed{ABDF}$$"
        },
        {
            "introduction": "LBM的核心思想是从简化的介观模型中恢复宏观流体动力学，如纳维-斯托克斯方程。一个关键步骤是确保模型的参数能够映射到真实的流体物理属性上，这个练习聚焦于最简单的碰撞模型——BGK模型。通过Chapman-Enskog展开，您将推导出模型的弛豫时间 $\\tau$ 与流体运动粘度 $\\nu$ 之间的关系，这是LBM理论中的一项基石性分析，展示了如何校准模拟以模拟特定的流体。",
            "id": "4092460",
            "problem": "考虑在二维九速 (D2Q9) 格子上通过格子玻尔兹曼方法 (LBM) 建模的等温、弱可压缩牛顿流体。碰撞算子为具有单松弛时间的 Bhatnagar–Gross–Krook (BGK) 类型。设离散演化方程为\n$$\nf_{\\alpha}(\\mathbf{x}+\\mathbf{e}_{\\alpha}\\,\\Delta t,t+\\Delta t)=f_{\\alpha}(\\mathbf{x},t)-\\frac{\\Delta t}{\\tau}\\left[f_{\\alpha}(\\mathbf{x},t)-f_{\\alpha}^{\\mathrm{eq}}(\\mathbf{x},t)\\right],\n$$\n其中 $f_{\\alpha}$ 是与离散速度 $\\mathbf{e}_{\\alpha}$ 相关联的分布函数，$f_{\\alpha}^{\\mathrm{eq}}$ 是二阶等温平衡态分布函数，$\\Delta t$ 是时间步长，$\\tau$ 是松弛时间。宏观流场由 $ \\rho=\\sum_{\\alpha} f_{\\alpha}$ 和 $ \\rho \\,\\mathbf{u}=\\sum_{\\alpha}\\mathbf{e}_{\\alpha} f_{\\alpha}$ 定义。D2Q9 求积满足标准各向同性恒等式\n$$\n\\sum_{\\alpha} w_{\\alpha}\\, e_{\\alpha i} e_{\\alpha j}=c_{s}^{2}\\,\\delta_{ij},\\qquad\n\\sum_{\\alpha} w_{\\alpha}\\, e_{\\alpha i} e_{\\alpha j} e_{\\alpha k} e_{\\alpha l}=c_{s}^{4}\\left(\\delta_{ij}\\delta_{kl}+\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}\\right),\n$$\n其中 $w_{\\alpha}$ 是格子权重，$c_{s}^{2}$ 是格子声速的平方。\n\n从这些定义和离散时间演化方程出发，结合对 $\\Delta t$ 的二阶泰勒展开和 Chapman–Enskog 多尺度分析，在宏观尺度上恢复 Navier–Stokes 方程。基于此推导，求出 BGK 模型的运动粘度 $ \\nu $ 作为 $ c_{s}^{2} $、$ \\tau $ 和 $ \\Delta t $ 的函数。然后，在格子单位下，对于 $ \\Delta t=1 $ 和 $ c_{s}^{2}=1/3 $，计算所得表达式的值，将 $ \\nu $ 表示为仅含 $ \\tau $ 的闭合形式函数。明确说明推导过程中所需的任何假设。你的最终答案必须是一个单一的解析表达式。无需四舍五入。以格子单位表示你的答案。",
            "solution": "该问题要求推导采用 Bhatnagar–Gross–Krook (BGK) 碰撞算子的格子玻尔兹曼方法 (LBM) 的运动粘度 $\\nu$。推导过程将使用 Chapman–Enskog 多尺度分析。\n\n离散格子玻尔兹曼方程 (LBE) 如下：\n$$\nf_{\\alpha}(\\mathbf{x}+\\mathbf{e}_{\\alpha}\\,\\Delta t,t+\\Delta t) - f_{\\alpha}(\\mathbf{x},t) = -\\frac{\\Delta t}{\\tau}\\left[f_{\\alpha}(\\mathbf{x},t)-f_{\\alpha}^{\\mathrm{eq}}(\\mathbf{x},t)\\right]\n$$\n其中 $f_{\\alpha}$ 是粒子分布函数，$\\mathbf{e}_{\\alpha}$ 是离散速度，$\\Delta t$ 是时间步长，$\\tau$ 是松弛时间，$f_{\\alpha}^{\\mathrm{eq}}$ 是平衡态分布函数。\n\n**步骤1：泰勒展开**\n我们首先对 LBE 的左侧进行关于 $\\Delta t$ 的二阶泰勒展开：\n$$\nf_{\\alpha}(\\mathbf{x}+\\mathbf{e}_{\\alpha}\\,\\Delta t,t+\\Delta t) = f_{\\alpha}(\\mathbf{x},t) + \\Delta t \\left(\\partial_t + \\mathbf{e}_{\\alpha} \\cdot \\nabla \\right) f_{\\alpha} + \\frac{(\\Delta t)^2}{2} \\left(\\partial_t + \\mathbf{e}_{\\alpha} \\cdot \\nabla \\right)^2 f_{\\alpha} + \\mathcal{O}((\\Delta t)^3)\n$$\n将其代入 LBE 并除以 $\\Delta t$，我们得到带有离散化效应的连续玻尔兹曼方程：\n$$\n\\left(\\partial_t + e_{\\alpha i} \\partial_i \\right) f_{\\alpha} + \\frac{\\Delta t}{2} \\left(\\partial_t + e_{\\alpha i} \\partial_i \\right)^2 f_{\\alpha} = -\\frac{1}{\\tau} (f_{\\alpha} - f_{\\alpha}^{\\mathrm{eq}})\n$$\n这里，对空间下标 $i$ 使用了爱因斯坦求和约定。\n\n**步骤2：Chapman–Enskog 多尺度展开**\n根据 Chapman–Enskog 方法，我们引入一个形式上的小参数 $\\epsilon$（与 Knudsen 数成正比），以分离快速的微观尺度和慢速的宏观尺度。\n分布函数以及时间和空间导数展开如下：\n$$\nf_{\\alpha} = f_{\\alpha}^{(0)} + \\epsilon f_{\\alpha}^{(1)} + \\epsilon^2 f_{\\alpha}^{(2)} + \\dots\n$$\n$$\n\\partial_t = \\epsilon \\partial_{t_1} + \\epsilon^2 \\partial_{t_2}\n$$\n$$\n\\partial_i = \\epsilon \\partial_{1i}\n$$\n一个关键的假设是，分布函数 $f_\\alpha$ 仅通过宏观变量——密度 $\\rho$ 和速度 $\\mathbf{u}$——来依赖于时间。平衡态分布函数 $f_\\alpha^{\\mathrm{eq}}$ 是这些局部宏观变量的函数。我们假设零阶分布即为平衡态分布，即 $f_{\\alpha}^{(0)} = f_{\\alpha}^{\\mathrm{eq}}$。非平衡部分 $f_{\\alpha}^{(k)}$ ($k \\geq 1$) 的定义使其对守恒量（质量和动量）没有贡献：\n$$\n\\sum_{\\alpha} f_{\\alpha}^{(k)} = 0 \\quad \\text{和} \\quad \\sum_{\\alpha} e_{\\alpha i} f_{\\alpha}^{(k)} = 0 \\quad \\text{对于 } k \\geq 1\n$$\n这确保了 $\\rho = \\sum_{\\alpha} f_{\\alpha}^{(0)}$ 和 $\\rho u_i = \\sum_{\\alpha} e_{\\alpha i} f_{\\alpha}^{(0)}$。\n\n将这些展开式代入经过泰勒展开的 LBE 中，并按 $\\epsilon$ 的幂次收集各项：\n\n**$\\epsilon^1$ 阶：**\n$$\n(\\partial_{t_1} + e_{\\alpha i} \\partial_{1i}) f_{\\alpha}^{(0)} = -\\frac{1}{\\tau} f_{\\alpha}^{(1)}\n$$\n此方程给出了一阶非平衡分布：\n$$\nf_{\\alpha}^{(1)} = -\\tau (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i}) f_{\\alpha}^{(0)}\n$$\n\n**$\\epsilon^2$ 阶：**\n$$\n\\partial_{t_2} f_{\\alpha}^{(0)} + (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i}) f_{\\alpha}^{(1)} + \\frac{\\Delta t}{2} (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i})^2 f_{\\alpha}^{(0)} = -\\frac{1}{\\tau} f_{\\alpha}^{(2)}\n$$\n我们可以将 $f_{\\alpha}^{(1)}$ 的表达式代入第二项：\n$$\n\\partial_{t_2} f_{\\alpha}^{(0)} - \\tau (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i})^2 f_{\\alpha}^{(0)} + \\frac{\\Delta t}{2} (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i})^2 f_{\\alpha}^{(0)} = -\\frac{1}{\\tau} f_{\\alpha}^{(2)}\n$$\n化简后，我们得到：\n$$\n\\partial_{t_2} f_{\\alpha}^{(0)} - \\left(\\tau - \\frac{\\Delta t}{2}\\right) (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i})^2 f_{\\alpha}^{(0)} = -\\frac{1}{\\tau} f_{\\alpha}^{(2)}\n$$\n\n**步骤3：宏观方程的推导**\n我们对尺度分离后的方程取矩。\n将 $\\epsilon^1$ 阶方程对 $\\alpha$ 求和：\n$$\n\\sum_{\\alpha} (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i}) f_{\\alpha}^{(0)} = 0 \\implies \\partial_{t_1} \\rho + \\partial_{1i} (\\rho u_i) = 0\n$$\n这是欧拉尺度上的连续性方程。乘以 $e_{\\alpha j}$ 并求和：\n$$\n\\sum_{\\alpha} e_{\\alpha j} (\\partial_{t_1} + e_{\\alpha i} \\partial_{1i}) f_{\\alpha}^{(0)} = 0 \\implies \\partial_{t_1} (\\rho u_j) + \\partial_{1i} \\Pi_{ij}^{(0)} = 0\n$$\n其中 $\\Pi_{ij}^{(0)} = \\sum_{\\alpha} e_{\\alpha i} e_{\\alpha j} f_{\\alpha}^{(0)}$ 是平衡态分布的二阶矩。对于给定的二阶等温平衡态，该矩为 $\\Pi_{ij}^{(0)} = \\rho u_i u_j + p \\delta_{ij}$，其中压力 $p = \\rho c_s^2$。这给出了欧拉动量方程：$\\partial_{t_1}(\\rho u_j) + \\partial_{1i}(\\rho u_i u_j) = -\\partial_{1j} p$。\n\n现在，我们合并不同尺度上的宏观方程。通过对 $\\epsilon^1$ 和 $\\epsilon^2$ 阶的贡献求和，可以得到完整的动量方程：\n$$\n\\epsilon_1: \\quad \\partial_{t_1}(\\rho u_j) + \\partial_{1i}\\Pi_{ij}^{(0)} = 0\n$$\n$$\n\\epsilon_2: \\quad \\partial_{t_2}(\\rho u_j) + \\partial_{1i}\\left( \\left(1 - \\frac{\\Delta t}{2\\tau}\\right)\\Pi_{ij}^{(1)} \\right) = 0\n$$\n$\\epsilon^2$ 阶动量方程是通过将 $\\epsilon^2$ 阶方程乘以 $e_{\\alpha j}$，对 $\\alpha$ 求和，并利用 $f_{\\alpha}^{(k)}$ 的性质推导出来的。结合这两个方程并重构完整的导数 $\\partial_t = \\epsilon\\partial_{t_1} + \\epsilon^2\\partial_{t_2}$ 和 $\\partial_i = \\epsilon\\partial_{1i}$：\n$$\n\\partial_t(\\rho u_j) + \\partial_i \\left( \\Pi_{ij}^{(0)} + \\left(1-\\frac{\\Delta t}{2\\tau}\\right) \\Pi_{ij}^{(1)} \\right) = \\mathcal{O}(\\epsilon^3)\n$$\n代入 $\\Pi_{ij}^{(0)} = \\rho u_i u_j + p \\delta_{ij}$：\n$$\n\\partial_t(\\rho u_j) + \\partial_i(\\rho u_i u_j) = -\\partial_j p - \\partial_i \\left( \\left(1-\\frac{\\Delta t}{2\\tau}\\right) \\Pi_{ij}^{(1)} \\right)\n$$\n该方程具有 Navier–Stokes 动量方程 $\\partial_t(\\rho u_j) + \\partial_i(\\rho u_i u_j) = -\\partial_j p + \\partial_i \\sigma'_{ij}$ 的形式，其中 $\\sigma'_{ij}$ 是粘性应力张量。通过比较，我们确定：\n$$\n\\sigma'_{ij} = - \\left(1 - \\frac{\\Delta t}{2\\tau}\\right) \\Pi_{ij}^{(1)}\n$$\n\n**步骤4：粘度推导**\n为了求出粘度，我们需要计算 $\\Pi_{ij}^{(1)} = \\sum_{\\alpha} e_{\\alpha i} e_{\\alpha j} f_{\\alpha}^{(1)}$。\n$$\n\\Pi_{ij}^{(1)} = \\sum_{\\alpha} e_{\\alpha i} e_{\\alpha j} \\left( -\\tau (\\partial_{t_1} + e_{\\alpha k} \\partial_{1k}) f_{\\alpha}^{(0)} \\right) = -\\tau \\left( \\partial_{t_1} \\Pi_{ij}^{(0)} + \\partial_{1k} Q_{ijk}^{(0)} \\right)\n$$\n其中 $Q_{ijk}^{(0)} = \\sum_{\\alpha} e_{\\alpha i} e_{\\alpha j} e_{\\alpha k} f_{\\alpha}^{(0)}$。\n为了推导应力张量中与速度梯度呈线性的粘性部分，我们做出低马赫数流的关键假设。在此极限下，我们可以忽略时间导数项 $\\partial_{t_1} \\Pi_{ij}^{(0)}$ 以及 $Q_{ijk}^{(0)}$ 中的速度高阶项。我们近似 $f_{\\alpha}^{(0)} \\approx w_{\\alpha} \\rho \\left(1 + \\frac{e_{\\alpha k} u_k}{c_s^2}\\right)$。\n三阶矩变为：\n$$\nQ_{ijk}^{(0)} \\approx \\sum_{\\alpha} e_{\\alpha i} e_{\\alpha j} e_{\\alpha k} \\left( w_{\\alpha} \\rho \\frac{e_{\\alpha l} u_l}{c_s^2} \\right) = \\frac{\\rho u_l}{c_s^2} \\sum_{\\alpha} w_{\\alpha} e_{\\alpha i} e_{\\alpha j} e_{\\alpha k} e_{\\alpha l}\n$$\n使用给定的四阶张量各向同性恒等式：\n$$\nQ_{ijk}^{(0)} \\approx \\frac{\\rho u_l}{c_s^2} c_s^4 (\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) = \\rho c_s^2 (u_k \\delta_{ij} + u_j \\delta_{ik} + u_i \\delta_{jk})\n$$\n取散度 $\\partial_{1k} Q_{ijk}^{(0)}$，我们得到（假设近似不可压缩，即 $\\partial_l u_l \\approx 0$）：\n$$\n\\partial_{1k} Q_{ijk}^{(0)} \\approx \\rho c_s^2 (\\partial_{1i} u_j + \\partial_{1j} u_i)\n$$\n因此，非平衡动量通量张量为：\n$$\n\\Pi_{ij}^{(1)} \\approx -\\tau \\rho c_s^2 (\\partial_{1i} u_j + \\partial_{1j} u_i)\n$$\n将此代入粘性应力张量的表达式：\n$$\n\\sigma'_{ij} \\approx - \\left(1 - \\frac{\\Delta t}{2\\tau}\\right) \\left[ -\\tau \\rho c_s^2 (\\partial_i u_j + \\partial_j u_i) \\right]\n$$\n$$\n\\sigma'_{ij} \\approx \\rho c_s^2 \\left(\\tau - \\frac{\\Delta t}{2}\\right) (\\partial_i u_j + \\partial_j u_i)\n$$\n牛顿流体的应力张量为 $\\sigma'_{ij} = \\rho \\nu (\\partial_i u_j + \\partial_j u_i) + \\text{体积粘性项}$。比较其偏应力（剪切）部分，我们确定运动粘度 $\\nu$ 为：\n$$\n\\nu = c_s^2 \\left(\\tau - \\frac{\\Delta t}{2}\\right)\n$$\n\n**步骤5：在格子单位下求值**\n题目要求在格子单位下计算该表达式，其中 $\\Delta t=1$ 且 $c_s^2=1/3$。\n代入这些值：\n$$\n\\nu = \\frac{1}{3} \\left(\\tau - \\frac{1}{2}\\right)\n$$\n这是 LBM-BGK 模型在格子单位下，运动粘度作为松弛时间 $\\tau$ 的函数的最终表达式。为保证数值稳定性，粘度必须为正，即 $\\nu > 0$，这导出条件 $\\tau > 1/2$。",
            "answer": "$$\n\\boxed{\\frac{1}{3}\\left(\\tau - \\frac{1}{2}\\right)}\n$$"
        },
        {
            "introduction": "虽然多重弛豫时间 (MRT) 模型在理论上能够精确地保持质量和动量守恒，但计算机中的有限精度运算会引入微小的误差，这些误差会随着时间累积。这个实践练习旨在研究这种数值漂移的量级，并比较MRT与BGK模型的鲁棒性。通过实施一个数值实验来追踪守恒误差，您将深入了解MRT矩空间公式的实际优势以及误差缓解策略的重要性，从而弥合理论与LBM模拟中高性能计算现实之间的差距。",
            "id": "4092445",
            "problem": "考虑在二维九速（$D2Q9$）格子上的复杂流体格子玻尔兹曼方法（LBM）。目标是通过计算密度 $\\rho$ 和速度 $\\mathbf{u}$ 在多个时间步长内的漂移，来量化矩空间碰撞中的有限精度舍入误差对质量和动量守恒的影响，并评估一种缓解策略。在格子单位下进行计算（所有量均为无量纲）。\n\n使用以下基础设定：\n- 对于均匀状态，使用仅有碰撞更新（无迁移）的离散玻尔兹曼方程，其中布居数 $f_i$ 在单弛豫时间 Bhatnagar–Gross–Krook (BGK) 碰撞或多弛豫时间 (MRT) 碰撞下演化。对于 BGK，碰撞直接作用于速度空间。对于 MRT，矩 $\\mathbf{m} = \\mathbf{M}\\mathbf{f}$ 通过一个对角弛豫矩阵 $\\mathbf{S}$ 向平衡矩 $\\mathbf{m}^{\\mathrm{eq}}$ 弛豫，然后通过 $\\mathbf{f} = \\mathbf{M}^{-1}\\mathbf{m}$ 变换回来。\n- 使用标准的 $D2Q9$ 速度 $\\mathbf{c}_i$ 和权重 $w_i$：\n  - 速度 $\\mathbf{c}_0=(0,0)$, $\\mathbf{c}_1=(1,0)$, $\\mathbf{c}_2=(0,1)$, $\\mathbf{c}_3=(-1,0)$, $\\mathbf{c}_4=(0,-1)$, $\\mathbf{c}_5=(1,1)$, $\\mathbf{c}_6=(-1,1)$, $\\mathbf{c}_7=(-1,-1)$, $\\mathbf{c}_8=(1,-1)$。\n  - 权重 $w_0=\\frac{4}{9}$, $w_{1,2,3,4}=\\frac{1}{9}$, $w_{5,6,7,8}=\\frac{1}{36}$。\n- 标准的速度空间平衡态分布函数为 $f_i^{\\mathrm{eq}} = w_i \\rho \\left[1 + 3(\\mathbf{c}_i\\cdot\\mathbf{u}) + \\frac{9}{2}(\\mathbf{c}_i\\cdot\\mathbf{u})^2 - \\frac{3}{2}\\mathbf{u}^2\\right]$。\n- 标准的 $D2Q9$ 矩变换 $\\mathbf{M}$（d’Humières/Lallemand–Luo 基）的行向量为：\n  - $[1,1,1,1,1,1,1,1,1]$,\n  - $[-4,-1,-1,-1,-1,2,2,2,2]$,\n  - $[4,-2,-2,-2,-2,1,1,1,1]$,\n  - $[0,1,0,-1,0,1,-1,-1,1]$,\n  - $[0,-2,0,2,0,1,-1,-1,1]$,\n  - $[0,0,1,0,-1,1,1,-1,-1]$,\n  - $[0,0,-2,0,2,1,1,-1,-1]$,\n  - $[0,1,-1,1,-1,0,0,0,0]$,\n  - $[0,0,0,0,0,1,-1,1,-1]$。\n- 与上述变换一致的相应平衡矩 $\\mathbf{m}^{\\mathrm{eq}}$ 为：\n  - $m_0^{\\mathrm{eq}} = \\rho$,\n  - $m_1^{\\mathrm{eq}} = -2\\rho + 3\\rho(u_x^2 + u_y^2)$,\n  - $m_2^{\\mathrm{eq}} = \\rho - 3\\rho(u_x^2 + u_y^2)$,\n  - $m_3^{\\mathrm{eq}} = \\rho u_x$,\n  - $m_4^{\\mathrm{eq}} = -\\rho u_x$,\n  - $m_5^{\\mathrm{eq}} = \\rho u_y$,\n  - $m_6^{\\mathrm{eq}} = -\\rho u_y$,\n  - $m_7^{\\mathrm{eq}} = \\rho(u_x^2 - u_y^2)$,\n  - $m_8^{\\mathrm{eq}} = \\rho u_x u_y$.\n\n实现一个单点实验（无空间变化，无迁移）以分离碰撞和舍入效应。在 $\\rho_0 = 1$ 和 $\\mathbf{u}_0 = (10^{-3}, -2\\times 10^{-3})$ 处初始化，布居数为 $\\mathbf{f} = \\mathbf{f}^{\\mathrm{eq}}(\\rho_0,\\mathbf{u}_0)$。在 $\\mathbf{f}$ 上叠加一个振幅为 $\\epsilon$ 的小的非平衡微扰 $\\boldsymbol{\\delta}$，使得 $\\sum_i \\delta_i = 0$ 和 $\\sum_i \\delta_i \\mathbf{c}_i = \\mathbf{0}$，即该微扰在初始化时精确地保持质量和动量守恒。\n\n在每个指定的模型和精度下，将 $\\mathbf{f}$ 演化 $N$ 个碰撞步。在每一步，计算 $\\rho = \\sum_i f_i$ 和 $\\mathbf{u} = \\frac{1}{\\rho}\\sum_i f_i \\mathbf{c}_i$。对于 BGK，使用弛豫率 $\\omega = 1/\\tau$。对于 MRT，使用 $\\mathbf{S}=\\mathrm{diag}(s_0,\\dots,s_8)$，其中守恒矩的弛豫率 $s_{0}=s_{3}=s_{5}=0$，所有其他 $s_j = \\omega$。在缓解方案中，通过在弛豫和逆变换到速度空间之前，立即用其精确值 $\\rho, \\rho u_x, \\rho u_y$ 覆盖守恒矩 $m_0, m_3, m_5$，从而在矩空间中强制守恒。\n\n测试套件：\n- 案例 1：MRT，$\\tau=0.8$, $\\omega=1/\\tau$, $N=100000$, $\\epsilon=10^{-7}$, 单精度 (`float32`)。\n- 案例 2：MRT，$\\tau=0.8$, $\\omega=1/\\tau$, $N=100000$, $\\epsilon=10^{-7}$, 双精度 (`float64`)。\n- 案例 3：在矩空间中强制守恒的 MRT（缓解方案），$\\tau=0.8$, $\\omega=1/\\tau$, $N=100000$, $\\epsilon=10^{-7}$, 单精度 (`float32`)。\n- 案例 4：BGK，$\\tau=0.8$, $\\omega=1/\\tau$, $N=100000$, $\\epsilon=10^{-7}$, 单精度 (`float32`)。\n- 案例 5：MRT，$\\tau=0.6$（更接近稳定性边界），$\\omega=1/\\tau$, $N=200000$, $\\epsilon=10^{-7}$, 单精度 (`float32`)。\n\n对于每个案例，返回 $N$ 步后的漂移指标：\n- $\\Delta \\rho = \\rho_N - \\rho_0$,\n- $\\Delta u_x = u_{x,N} - u_{x,0}$,\n- $\\Delta u_y = u_{y,N} - u_{y,0}$.\n\n所有输出必须是无量纲浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n[$\\Delta \\rho_1$, $\\Delta u_{x,1}$, $\\Delta u_{y,1}$, $\\Delta \\rho_2$, $\\Delta u_{x,2}$, $\\Delta u_{y,2}$, \\dots, $\\Delta \\rho_5$, $\\Delta u_{x,5}$, $\\Delta u_{y,5}$]。",
            "solution": "该问题被评估为有效。它在科学上基于格子玻尔兹曼方法（LBM）的既定理论，问题设定良好，提供了所有必要的参数和初始条件，并且表述客观。任务是执行一个数值实验，以量化不同 LBM 碰撞模型中浮点舍入误差的累积，并测试一种缓解策略。这是计算流体力学领域中一项标准且有意义的研究。\n\n我们将继续提供完整的解决方案。问题的核心是模拟单个空间点（均匀系统）上粒子分布函数 $\\,f_i(\\mathbf{x}, t)\\,$ 的演化，从而将碰撞步骤与迁移步骤分离开来。该演化由格子玻尔兹曼方程控制，对于仅有碰撞的过程，该方程简化为：\n$$\nf_i(t+1) = f_i(t) + \\Omega_i(\\mathbf{f})\n$$\n其中 $\\,\\Omega_i\\,$ 是第 $\\,i\\,$ 个速度方向的碰撞算子。模拟将执行大量的步骤 $\\,N\\,$，以观察舍入误差的累积效应。\n\n模拟将基于二维九速（$\\,D2Q9\\,$）模型。离散速度 $\\,\\mathbf{c}_i\\,$ 和相应的权重 $\\,w_i\\,$ 如下所示：\n- $\\,\\mathbf{c}_0=(0,0)\\,$, $\\,\\mathbf{c}_{1,2,3,4}=(\\pm 1, 0), (0, \\pm 1)\\,$, $\\,\\mathbf{c}_{5,6,7,8}=(\\pm 1, \\pm 1)\\,$\n- $\\,w_0=4/9\\,$, $\\,w_{1,2,3,4}=1/9\\,$, $\\,w_{5,6,7,8}=1/36\\,$\n\n宏观流体密度 $\\,\\rho\\,$ 和速度 $\\,\\mathbf{u}\\,$ 定义为分布函数的矩：\n$$\n\\rho = \\sum_{i=0}^{8} f_i \\quad \\quad \\mathbf{j} = \\rho\\mathbf{u} = \\sum_{i=0}^{8} f_i \\mathbf{c}_i\n$$\n\n系统在 $\\,\\rho_0 = 1\\,$ 和 $\\,\\mathbf{u}_0 = (10^{-3}, -2\\times 10^{-3})\\,$ 处初始化。初始分布函数 $\\,\\mathbf{f}\\,$ 被设置为平衡态 $\\,\\mathbf{f}^{\\mathrm{eq}}(\\rho_0, \\mathbf{u}_0)\\,$ 加上一个量级为 $\\,\\epsilon = 10^{-7}\\,$ 的小的非平衡微扰 $\\,\\boldsymbol{\\delta}\\,$。平衡分布是标准的二阶展开：\n$$\nf_i^{\\mathrm{eq}} = w_i \\rho \\left[1 + \\frac{\\mathbf{c}_i\\cdot\\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{c}_i\\cdot\\mathbf{u})^2}{2c_s^4} - \\frac{\\mathbf{u}\\cdot\\mathbf{u}}{2c_s^2}\\right]\n$$\n采用标准格子声速 $\\,c_s^2 = 1/3\\,$，上式变为：\n$$\nf_i^{\\mathrm{eq}} = w_i \\rho \\left[1 + 3(\\mathbf{c}_i\\cdot\\mathbf{u}) + \\frac{9}{2}(\\mathbf{c}_i\\cdot\\mathbf{u})^2 - \\frac{3}{2}u^2\\right]\n$$\n微扰 $\\,\\boldsymbol{\\delta}\\,$ 必须保持质量和动量守恒，即 $\\,\\sum_i \\delta_i = 0\\,$ 和 $\\,\\sum_i \\delta_i \\mathbf{c}_i = \\mathbf{0}\\,$。例如，可以通过设置 $\\,\\delta_1 = \\epsilon\\,$, $\\,\\delta_3 = \\epsilon\\,$ 和 $\\,\\delta_0 = -2\\epsilon\\,$，以及所有其他 $\\,\\delta_i=0\\,$ 来构造一个有效的微扰。这种微扰会激发一个非平衡模式，而不会立即改变守恒的流体动力学变量。因此，初始布居数为 $\\,f_i(t=0) = f_i^{\\mathrm{eq}}(\\rho_0, \\mathbf{u}_0) + \\delta_i\\,$。\n\n我们将实现并比较三种不同的碰撞格式。\n\n1.  **Bhatnagar–Gross–Krook (BGK) 模型**：\n    该模型使用单个弛豫时间 $\\,\\tau\\,$ 使所有模式向平衡态弛豫。碰撞算子是线性的：\n    $$\n    \\Omega_i^{\\mathrm{BGK}} = -\\frac{1}{\\tau} (f_i - f_i^{\\mathrm{eq}}) = -\\omega (f_i - f_i^{\\mathrm{eq}})\n    $$\n    其中 $\\,\\omega = 1/\\tau\\,$ 是弛豫频率。碰撞后的状态是 $\\,f_i(t+1) = f_i(t) - \\omega (f_i(t) - f_i^{\\mathrm{eq}}(t))\\,$. 虽然简单，但该模型耦合了所有弛豫过程，并且众所周知，与 MRT 相比，它在处理复杂流动时稳定性和准确性较差。从 $\\,\\mathbf{f}\\,$ 计算 $\\,\\rho\\,$ 和 $\\,\\mathbf{u}\\,$ 时的舍入误差，可能导致这些名义上的守恒量在多个步骤后出现漂移。\n\n2.  **多弛豫时间 (MRT) 模型**：\n    该模型在矩空间中操作，允许对不同矩使用不同的弛豫率。过程如下：\n    a. 使用线性变换矩阵 $\\,\\mathbf{M}\\,$ 将布居数 $\\,\\mathbf{f}\\,$ 转换为矩向量 $\\,\\mathbf{m}\\,$：$\\,\\mathbf{m} = \\mathbf{M}\\mathbf{f}\\,$。\n    b. 使矩向其平衡值 $\\,\\mathbf{m}^{\\mathrm{eq}}\\,$ 弛豫：\n    $$\n    \\mathbf{m}^* = \\mathbf{m} - \\mathbf{S} (\\mathbf{m} - \\mathbf{m}^{\\mathrm{eq}})\n    $$\n    其中 $\\,\\mathbf{S} = \\mathrm{diag}(s_0, s_1, \\ldots, s_8)\\,$ 是一个由弛豫率组成的对角矩阵。\n    c. 将碰撞后的矩 $\\,\\mathbf{m}^*\\,$ 变换回布居数空间：$\\,\\mathbf{f}(t+1) = \\mathbf{M}^{-1}\\mathbf{m}^*\\,$.\n\n    问题描述中提供的特定 $\\,D2Q9\\,$ 矩基（d'Humières/Lallemand-Luo）将矩分为守恒量（密度、动量）和非守恒的动力学模式。守恒矩为 $\\,m_0=\\rho\\,$, $\\,m_3=\\rho u_x\\,$ 和 $\\,m_5=\\rho u_y\\,$。对于这些矩，弛豫率设为零（$\\,s_0=s_3=s_5=0\\,$），这在理论上保证了质量和动量的精确守恒。所有其他非守恒矩都以速率 $\\,s_j = \\omega\\,$ 进行弛豫。尽管有这种理论保证，在矩阵乘法（$\\,\\mathbf{M}\\mathbf{f}\\,$ 和 $\\,\\mathbf{M}^{-1}\\mathbf{m}^*\\,$）过程中引入的舍入误差仍然可能导致守恒量的漂移。平衡矩 $\\,\\mathbf{m}^{\\mathrm{eq}}\\,$ 直接由 $\\,\\rho\\,$ 和 $\\,\\mathbf{u}\\,$ 计算得出。\n\n3.  **带守恒强制的 MRT（缓解方案）**：\n    这是 MRT 模型的一个变体，旨在主动对抗舍入误差的累积。步骤修改如下：\n    a. 根据当前的布居数 $\\,\\mathbf{f}(t)\\,$，以尽可能高的精度计算宏观量：$\\,\\rho_{\\mathrm{exact}} = \\sum_i f_i(t)\\,$ 和 $\\,(\\rho u_x)_{\\mathrm{exact}} = \\sum_i f_i(t) c_{ix}\\,$, $\\,(\\rho u_y)_{\\mathrm{exact}} = \\sum_i f_i(t) c_{iy}\\,$。\n    b. 变换到矩空间：$\\,\\mathbf{m} = \\mathbf{M}\\mathbf{f}(t)\\,$。\n    c. **强制守恒**：用步骤(a)中计算出的精确值覆盖与守恒量对应的计算出的矩：\n    $$\n    m_0 \\leftarrow \\rho_{\\mathrm{exact}} \\quad \\quad m_3 \\leftarrow (\\rho u_x)_{\\mathrm{exact}} \\quad \\quad m_5 \\leftarrow (\\rho u_y)_{\\mathrm{exact}}\n    $$\n    这一步明确地消除了 $\\,\\mathbf{M}\\mathbf{f}\\,$ 变换中针对这些特定矩产生的任何舍入误差。\n    d. 使用修正后的矩向量 $\\,\\mathbf{m}\\,$ 进行弛豫步骤，并变换回布居数空间。\n\n对于每个测试案例，我们将初始化系统，使用指定的浮点精度（$\\,\\text{float32}\\,$ 或 $\\,\\text{float64}\\,$）对指定的碰撞模型进行 $\\,N\\,$ 步迭代，并计算最终的密度漂移（$\\,\\Delta \\rho = \\rho_N - \\rho_0\\,$）和速度分量漂移（$\\,\\Delta u_x = u_{x,N} - u_{x,0}\\,$, $\\,\\Delta u_y = u_{y,N} - u_{y,0}\\,$）。",
            "answer": "[3.725290298461914e-09,-1.332386224320362e-11,2.839496039014193e-11,-1.232594958032132e-15,1.729792193553294e-18,6.13620857850125e-18,0.0,0.0,0.0,-2.3283064365386963e-09,1.109337584102832e-11,-2.253775077406317e-11,1.4901161193847656e-08,-2.2472719139586116e-11,4.52621743898635e-11]"
        }
    ]
}