{
    "hands_on_practices": [
        {
            "introduction": "To master objective time derivatives, it's essential to apply their definitions to canonical flow fields. This practice  focuses on steady simple shear flow, a cornerstone in rheology that combines both material stretching and rotation. By computing the upper- and lower-convected derivatives for a general symmetric tensor, you will gain firsthand experience with the mathematical machinery and develop an intuition for how flow kinematics couple with and alter tensor components.",
            "id": "4097761",
            "problem": "Consider a three-dimensional incompressible continuum undergoing a steady simple shear flow with velocity field $\\boldsymbol{v}(\\boldsymbol{x}) = (\\gamma y, 0, 0)$, where $\\gamma$ is a constant shear rate. The spatial velocity gradient tensor is $\\boldsymbol{L} = \\nabla \\boldsymbol{v} = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$. Let $\\boldsymbol{A}(t)$ be a general symmetric, spatially homogeneous (no spatial gradients) second-order tensor field carried with the material, with Cartesian components $\\boldsymbol{A}(t) = \\begin{pmatrix} a_{11}(t) & a_{12}(t) & a_{13}(t) \\\\ a_{12}(t) & a_{22}(t) & a_{23}(t) \\\\ a_{13}(t) & a_{23}(t) & a_{33}(t) \\end{pmatrix}$.\n\nStarting from the definition of the material time derivative for tensor fields, the kinematics of material line elements, and the requirement of frame-indifference (objectivity) under superposed rigid-body motions, derive the forms of the upper-convected and lower-convected objective time derivatives of $\\boldsymbol{A}(t)$ for this flow. Then, evaluate these derivatives component-wise in terms of $\\dot{a}_{ij}(t)$, $a_{ij}(t)$, and $\\gamma$. Explicitly compute $\\stackrel{\\nabla}{\\boldsymbol{A}}$ and $\\stackrel{\\triangle}{\\boldsymbol{A}}$ and identify which components are directly affected by the shear rate $\\gamma$ through coupling with specific components of $\\boldsymbol{A}$.\n\nProvide your final answer as a pair of analytical $3 \\times 3$ matrix expressions for $\\stackrel{\\nabla}{\\boldsymbol{A}}$ and $\\stackrel{\\triangle}{\\boldsymbol{A}}$, respectively, placed side-by-side as a single row matrix. No units are required. No rounding is required.",
            "solution": "The problem requires the derivation and evaluation of the upper-convected and lower-convected time derivatives of a symmetric, spatially homogeneous second-order tensor field $\\boldsymbol{A}(t)$ in a steady simple shear flow. The solution is constructed from fundamental principles of continuum mechanics.\n\nFirst, we establish the definitions of the objective time derivatives. An objective time derivative is a rate of change of a tensor field that is independent of any superposed rigid-body motion of the observer's reference frame. The material time derivative, $D/Dt$, is not objective by itself.\n\nThe material time derivative of a tensor field $\\boldsymbol{A}(\\boldsymbol{x}, t)$ is defined as:\n$$ \\frac{D\\boldsymbol{A}}{Dt} = \\frac{\\partial \\boldsymbol{A}}{\\partial t} + (\\boldsymbol{v} \\cdot \\nabla)\\boldsymbol{A} $$\nIn this problem, the tensor field $\\boldsymbol{A}(t)$ is given as spatially homogeneous, meaning it does not depend on the spatial coordinates $\\boldsymbol{x}$. Therefore, its spatial gradient is zero: $\\nabla \\boldsymbol{A} = \\boldsymbol{0}$. The material derivative simplifies to the partial time derivative:\n$$ \\frac{D\\boldsymbol{A}}{Dt} = \\frac{\\partial \\boldsymbol{A}}{\\partial t} = \\dot{\\boldsymbol{A}}(t) $$\nThe components of $\\dot{\\boldsymbol{A}}(t)$ are simply the time derivatives of the components of $\\boldsymbol{A}(t)$, i.e., $\\dot{a}_{ij}(t)$.\n\nThe upper- and lower-convected derivatives can be derived by considering how geometric quantities associated with the continuum deform. The upper-convected derivative arises from considering a contravariant tensor, which transforms like the product of two material line elements. The lower-convected derivative is associated with a covariant tensor, which transforms like the product of two material surface normals.\n\nLet $d\\boldsymbol{x}$ be a material line element vector connecting two neighboring particles. Its evolution in time is governed by the velocity gradient $\\boldsymbol{L}$:\n$$ \\frac{d}{dt}(d\\boldsymbol{x}) = \\boldsymbol{L} \\cdot d\\boldsymbol{x} $$\nLet $d\\boldsymbol{a}$ be a material surface element vector. Its evolution is governed by:\n$$ \\frac{d}{dt}(d\\boldsymbol{a}) = -\\boldsymbol{L}^T \\cdot d\\boldsymbol{a} $$\nThe upper-convected derivative of a tensor $\\boldsymbol{A}$, denoted $\\stackrel{\\nabla}{\\boldsymbol{A}}$, is defined such that the scalar quantity $d\\boldsymbol{a} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{a}$ is constant in time if $\\stackrel{\\nabla}{\\boldsymbol{A}} = \\boldsymbol{0}$. By applying the product rule:\n$$ \\frac{d}{dt}(d\\boldsymbol{a} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{a}) = \\frac{d(d\\boldsymbol{a})}{dt} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{a} + d\\boldsymbol{a} \\cdot \\frac{d\\boldsymbol{A}}{dt} \\cdot d\\boldsymbol{a} + d\\boldsymbol{a} \\cdot \\boldsymbol{A} \\cdot \\frac{d(d\\boldsymbol{a})}{dt} = 0 $$\nSubstituting the evolution equations for $d\\boldsymbol{a}$ and $d\\boldsymbol{A}/dt = \\dot{\\boldsymbol{A}}$:\n$$ (-\\boldsymbol{L}^T \\cdot d\\boldsymbol{a}) \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{a} + d\\boldsymbol{a} \\cdot \\dot{\\boldsymbol{A}} \\cdot d\\boldsymbol{a} + d\\boldsymbol{a} \\cdot \\boldsymbol{A} \\cdot (-\\boldsymbol{L}^T \\cdot d\\boldsymbol{a}) = 0 $$\nUsing the property $(\\boldsymbol{M} \\cdot \\boldsymbol{u}) \\cdot \\boldsymbol{v}=\\boldsymbol{u} \\cdot (\\boldsymbol{M}^T \\cdot \\boldsymbol{v})$, the first term becomes $d\\boldsymbol{a} \\cdot (-\\boldsymbol{L} \\cdot \\boldsymbol{A}) \\cdot d\\boldsymbol{a}$ and the third term becomes $d\\boldsymbol{a} \\cdot (-\\boldsymbol{A} \\cdot \\boldsymbol{L}^T) \\cdot d\\boldsymbol{a}$. Factoring out $d\\boldsymbol{a}$:\n$$ d\\boldsymbol{a} \\cdot (\\dot{\\boldsymbol{A}} - \\boldsymbol{L} \\cdot \\boldsymbol{A} - \\boldsymbol{A} \\cdot \\boldsymbol{L}^T) \\cdot d\\boldsymbol{a} = 0 $$\nSince this must hold for any arbitrary surface element $d\\boldsymbol{a}$, the expression in the parenthesis must be the zero tensor. This defines the upper-convected derivative:\n$$ \\stackrel{\\nabla}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} - \\boldsymbol{L} \\cdot \\boldsymbol{A} - \\boldsymbol{A} \\cdot \\boldsymbol{L}^T $$\nSimilarly, the lower-convected derivative of a tensor $\\boldsymbol{A}$, denoted $\\stackrel{\\triangle}{\\boldsymbol{A}}$, is defined such that the scalar quantity $d\\boldsymbol{x} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{x}$ is constant if $\\stackrel{\\triangle}{\\boldsymbol{A}} = \\boldsymbol{0}$.\n$$ \\frac{d}{dt}(d\\boldsymbol{x} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{x}) = \\frac{d(d\\boldsymbol{x})}{dt} \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{x} + d\\boldsymbol{x} \\cdot \\frac{d\\boldsymbol{A}}{dt} \\cdot d\\boldsymbol{x} + d\\boldsymbol{x} \\cdot \\boldsymbol{A} \\cdot \\frac{d(d\\boldsymbol{x})}{dt} = 0 $$\n$$ (\\boldsymbol{L} \\cdot d\\boldsymbol{x}) \\cdot \\boldsymbol{A} \\cdot d\\boldsymbol{x} + d\\boldsymbol{x} \\cdot \\dot{\\boldsymbol{A}} \\cdot d\\boldsymbol{x} + d\\boldsymbol{x} \\cdot \\boldsymbol{A} \\cdot (\\boldsymbol{L} \\cdot d\\boldsymbol{x}) = 0 $$\n$$ d\\boldsymbol{x} \\cdot (\\boldsymbol{L}^T \\cdot \\boldsymbol{A} + \\dot{\\boldsymbol{A}} + \\boldsymbol{A} \\cdot \\boldsymbol{L}) \\cdot d\\boldsymbol{x} = 0 $$\nThis must hold for any arbitrary line element $d\\boldsymbol{x}$, which defines the lower-convected derivative:\n$$ \\stackrel{\\triangle}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} + \\boldsymbol{L}^T \\cdot \\boldsymbol{A} + \\boldsymbol{A} \\cdot \\boldsymbol{L} $$\nNow we evaluate these expressions for the given simple shear flow. The velocity field is $\\boldsymbol{v} = (\\gamma y, 0, 0)$, where $\\gamma$ is the constant shear rate.\nThe velocity gradient tensor $\\boldsymbol{L}$ and its transpose $\\boldsymbol{L}^T$ are:\n$$ \\boldsymbol{L} = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad \\boldsymbol{L}^T = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe tensor $\\boldsymbol{A}(t)$ and its time derivative $\\dot{\\boldsymbol{A}}(t)$ are symmetric:\n$$ \\boldsymbol{A} = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix}, \\quad \\dot{\\boldsymbol{A}} = \\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} & \\dot{a}_{13} \\\\ \\dot{a}_{12} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix} $$\nwhere the argument $(t)$ is omitted for brevity.\n\nEvaluation of the upper-convected derivative $\\stackrel{\\nabla}{\\boldsymbol{A}}$:\nWe first compute the products $\\boldsymbol{L} \\cdot \\boldsymbol{A}$ and $\\boldsymbol{A} \\cdot \\boldsymbol{L}^T$.\n$$ \\boldsymbol{L} \\cdot \\boldsymbol{A} = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12} & \\gamma a_{22} & \\gamma a_{23} \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n$$ \\boldsymbol{A} \\cdot \\boldsymbol{L}^T = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12} & 0 & 0 \\\\ \\gamma a_{22} & 0 & 0 \\\\ \\gamma a_{23} & 0 & 0 \\end{pmatrix} $$\nSumming these two terms:\n$$ \\boldsymbol{L} \\cdot \\boldsymbol{A} + \\boldsymbol{A} \\cdot \\boldsymbol{L}^T = \\begin{pmatrix} 2\\gamma a_{12} & \\gamma a_{22} & \\gamma a_{23} \\\\ \\gamma a_{22} & 0 & 0 \\\\ \\gamma a_{23} & 0 & 0 \\end{pmatrix} $$\nFinally, we subtract this from $\\dot{\\boldsymbol{A}}$:\n$$ \\stackrel{\\nabla}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} - (\\boldsymbol{L} \\cdot \\boldsymbol{A} + \\boldsymbol{A} \\cdot \\boldsymbol{L}^T) = \\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12} & \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix} $$\n\nEvaluation of the lower-convected derivative $\\stackrel{\\triangle}{\\boldsymbol{A}}$:\nWe compute the products $\\boldsymbol{L}^T \\cdot \\boldsymbol{A}$ and $\\boldsymbol{A} \\cdot \\boldsymbol{L}$.\n$$ \\boldsymbol{L}^T \\cdot \\boldsymbol{A} = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma a_{11} & \\gamma a_{12} & \\gamma a_{13} \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n$$ \\boldsymbol{A} \\cdot \\boldsymbol{L} = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\gamma a_{11} & 0 \\\\ 0 & \\gamma a_{12} & 0 \\\\ 0 & \\gamma a_{13} & 0 \\end{pmatrix} $$\nSumming these two terms:\n$$ \\boldsymbol{L}^T \\cdot \\boldsymbol{A} + \\boldsymbol{A} \\cdot \\boldsymbol{L} = \\begin{pmatrix} 0 & \\gamma a_{11} & 0 \\\\ \\gamma a_{11} & 2\\gamma a_{12} & \\gamma a_{13} \\\\ 0 & \\gamma a_{13} & 0 \\end{pmatrix} $$\nFinally, we add this to $\\dot{\\boldsymbol{A}}$:\n$$ \\stackrel{\\triangle}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} + (\\boldsymbol{L}^T \\cdot \\boldsymbol{A} + \\boldsymbol{A} \\cdot \\boldsymbol{L}) = \\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{22} + 2\\gamma a_{12} & \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13} & \\dot{a}_{23} + \\gamma a_{13} & \\dot{a}_{33} \\end{pmatrix} $$\n\nFor the upper-convected derivative $\\stackrel{\\nabla}{\\boldsymbol{A}}$, the shear rate $\\gamma$ directly affects the components $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{11}$, $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{12}$ (and its symmetric counterpart $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{21}$), and $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{13}$ (and $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{31}$). Specifically, the shear flow couples the shear component $a_{12}$ to the normal component $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{11}$, the normal component $a_{22}$ to the shear component $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{12}$, and the component $a_{23}$ to the shear component $(\\stackrel{\\nabla}{\\boldsymbol{A}})_{13}$.\n\nFor the lower-convected derivative $\\stackrel{\\triangle}{\\boldsymbol{A}}$, the shear rate $\\gamma$ directly affects the components $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{12}$ (and $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{21}$), $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{22}$, and $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{23}$ (and $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{32}$). Specifically, the flow couples the normal component $a_{11}$ to the shear component $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{12}$, the shear component $a_{12}$ to the normal component $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{22}$, and the component $a_{13}$ to the shear component $(\\stackrel{\\triangle}{\\boldsymbol{A}})_{23}$.\n\nThe final expressions for the two objective derivatives are the matrices derived above.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12} & \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix}\n&\n\\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{22} + 2\\gamma a_{12} & \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13} & \\dot{a}_{23} + \\gamma a_{13} & \\dot{a}_{33} \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from direct calculation to deeper physical insight, this exercise explores the meaning of objective derivatives when applied to a fundamental geometric object: the identity tensor, $\\boldsymbol{I}$. The identity tensor acts as the metric tensor of our Euclidean space, measuring distances and angles. This practice  asks you to show that the lower-convected derivative of $\\boldsymbol{I}$ is precisely twice the rate-of-deformation tensor, $2\\boldsymbol{D}$, thereby forging a direct link between the abstract concept of an objective rate and the physical measure of material deformation.",
            "id": "4097756",
            "problem": "Consider a continuum fluid in three spatial dimensions with a smooth velocity field $\\boldsymbol{v}(\\boldsymbol{x},t)$. Let the velocity gradient be the second-order tensor $\\boldsymbol{L}(\\boldsymbol{x},t)$ with components $L_{ij} = \\partial v_{i}/\\partial x_{j}$, and define the symmetric rate-of-deformation tensor $\\boldsymbol{D} = (\\boldsymbol{L} + \\boldsymbol{L}^{T})/2$. Denote by $\\boldsymbol{I}$ the second-order identity tensor. The principle of material frame indifference (objectivity) requires that any physically meaningful time derivative of a tensor field must transform appropriately under a superposed rigid body motion, represented by a time-dependent proper orthogonal tensor $\\boldsymbol{Q}(t)$.\n\nStarting from the fundamental kinematics of the flow map and the requirement of objectivity under superposed rigid motions, derive the objective lower-convected time derivative of the identity tensor, denoted $\\stackrel{\\triangle}{\\boldsymbol{I}}$, in terms of $\\boldsymbol{L}$ and/or $\\boldsymbol{D}$. Use only the definitions of $\\boldsymbol{L}$, $\\boldsymbol{D}$, the identity $\\boldsymbol{I}$, and the material time derivative, together with the transformation law for second-order tensors under rigid rotations. Your derivation should explicitly ensure that the resulting derivative removes spurious contributions from rigid-body rotation and translation and is consistent with the kinematics of the flow.\n\nFinally, provide the closed-form analytic expression for $\\stackrel{\\triangle}{\\boldsymbol{I}}$ as your answer. In your solution, explain how the trace of the resulting expression relates to compressibility and local volume change, but express the final answer only as the analytic expression for $\\stackrel{\\triangle}{\\boldsymbol{I}}$. No numerical values are required, and no rounding is needed.",
            "solution": "The problem requires the derivation of the lower-convected time derivative of the second-order identity tensor, $\\boldsymbol{I}$, denoted as $\\stackrel{\\triangle}{\\boldsymbol{I}}$. The derivation must be based on the fundamental principles of continuum kinematics and the requirement of objectivity. The final expression should be given in terms of the velocity gradient tensor $\\boldsymbol{L}$ and/or the rate-of-deformation tensor $\\boldsymbol{D}$.\n\nThe concept of an objective time derivative arises from the need to distinguish the intrinsic rate of change of a tensor property of a material element from the apparent rate of change caused by the element's rigid-body rotation. The lower-convected derivative is the objective time derivative naturally associated with covariant tensors, which transform \"against\" the deformation.\n\nWe begin by establishing the general form of the lower-convected derivative from kinematics. Consider the deformation gradient $\\boldsymbol{F}$, which maps vectors from the reference configuration to the current (spatial) configuration. Its material time derivative is given by the kinematic relation:\n$$\n\\frac{D\\boldsymbol{F}}{Dt} = \\boldsymbol{L}\\boldsymbol{F}\n$$\nwhere $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$ is the spatial velocity gradient.\n\nA quintessential covariant tensor in the spatial description is the inverse of the left Cauchy-Green deformation tensor, which we denote by $\\boldsymbol{b}$. The left Cauchy-Green tensor itself is $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^T$, and is a contravariant tensor. Its inverse is $\\boldsymbol{b} = \\boldsymbol{B}^{-1} = (\\boldsymbol{F}^{-1})^T\\boldsymbol{F}^{-1}$. The lower-convected derivative is precisely the objective time derivative that, when applied to $\\boldsymbol{b}$, yields the zero tensor, signifying that $\\boldsymbol{b}$ is constant when viewed in a frame that convects and deforms with the material.\n\nLet us find the material time derivative of $\\boldsymbol{B}$:\n$$\n\\frac{D\\boldsymbol{B}}{Dt} = \\frac{D}{Dt}(\\boldsymbol{F}\\boldsymbol{F}^T) = \\frac{D\\boldsymbol{F}}{Dt}\\boldsymbol{F}^T + \\boldsymbol{F}\\left(\\frac{D\\boldsymbol{F}}{Dt}\\right)^T\n$$\nSubstituting $\\frac{D\\boldsymbol{F}}{Dt} = \\boldsymbol{L}\\boldsymbol{F}$, we get:\n$$\n\\frac{D\\boldsymbol{B}}{Dt} = (\\boldsymbol{L}\\boldsymbol{F})\\boldsymbol{F}^T + \\boldsymbol{F}(\\boldsymbol{L}\\boldsymbol{F})^T = \\boldsymbol{L}(\\boldsymbol{F}\\boldsymbol{F}^T) + \\boldsymbol{F}\\boldsymbol{F}^T\\boldsymbol{L}^T = \\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^T\n$$\nNow, we find the material time derivative of its inverse, $\\boldsymbol{b} = \\boldsymbol{B}^{-1}$, by differentiating the identity $\\boldsymbol{B}\\boldsymbol{b} = \\boldsymbol{I}$:\n$$\n\\frac{D}{Dt}(\\boldsymbol{B}\\boldsymbol{b}) = \\frac{D\\boldsymbol{I}}{Dt}\n$$\nThe identity tensor $\\boldsymbol{I}$ is a constant tensor field in a fixed Cartesian frame, meaning its value is the same at all points in space and for all time. Therefore, its partial derivatives with respect to space and time are zero, and its material derivative is also zero: $\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}$.\nApplying the product rule:\n$$\n\\frac{D\\boldsymbol{B}}{Dt}\\boldsymbol{b} + \\boldsymbol{B}\\frac{D\\boldsymbol{b}}{Dt} = \\boldsymbol{0}\n$$\nSolving for $\\frac{D\\boldsymbol{b}}{Dt}$:\n$$\n\\frac{D\\boldsymbol{b}}{Dt} = -\\boldsymbol{B}^{-1}\\frac{D\\boldsymbol{B}}{Dt}\\boldsymbol{b} = -\\boldsymbol{b}\\left(\\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^T\\right)\\boldsymbol{b}\n$$\nDistributing $\\boldsymbol{b}$ and using $\\boldsymbol{B}\\boldsymbol{b}=\\boldsymbol{I}$:\n$$\n\\frac{D\\boldsymbol{b}}{Dt} = -\\boldsymbol{b}\\boldsymbol{L}(\\boldsymbol{B}\\boldsymbol{b}) - (\\boldsymbol{b}\\boldsymbol{B})\\boldsymbol{L}^T\\boldsymbol{b} = -\\boldsymbol{b}\\boldsymbol{L} - \\boldsymbol{L}^T\\boldsymbol{b}\n$$\nRearranging this equation gives:\n$$\n\\frac{D\\boldsymbol{b}}{Dt} + \\boldsymbol{L}^T\\boldsymbol{b} + \\boldsymbol{b}\\boldsymbol{L} = \\boldsymbol{0}\n$$\nThis result reveals the structure of the lower-convected derivative. For a general second-order covariant tensor field $\\boldsymbol{T}$, its lower-convected derivative, which we denote by $\\stackrel{\\triangle}{\\boldsymbol{T}}$, is defined as:\n$$\n\\stackrel{\\triangle}{\\boldsymbol{T}} = \\frac{D\\boldsymbol{T}}{Dt} + \\boldsymbol{L}^T\\boldsymbol{T} + \\boldsymbol{T}\\boldsymbol{L}\n$$\nThis form ensures that the derivative is objective, i.e., it transforms correctly under a change of observer.\n\nWe are asked to find the lower-convected derivative of the identity tensor, $\\stackrel{\\triangle}{\\boldsymbol{I}}$. The identity tensor $\\boldsymbol{I}$ can be interpreted as the metric tensor of the Euclidean space. As a metric, it is a covariant tensor. We can therefore apply the formula derived above.\nAs established earlier, the material derivative of the identity tensor in a fixed reference frame is zero:\n$$\n\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}\n$$\nSubstituting $\\boldsymbol{T} = \\boldsymbol{I}$ and $\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}$ into the definition of the lower-convected derivative:\n$$\n\\stackrel{\\triangle}{\\boldsymbol{I}} = \\boldsymbol{0} + \\boldsymbol{L}^T\\boldsymbol{I} + \\boldsymbol{I}\\boldsymbol{L}\n$$\nUsing the property of the identity tensor ($\\boldsymbol{A}\\boldsymbol{I} = \\boldsymbol{I}\\boldsymbol{A} = \\boldsymbol{A}$ for any tensor $\\boldsymbol{A}$):\n$$\n\\stackrel{\\triangle}{\\boldsymbol{I}} = \\boldsymbol{L}^T + \\boldsymbol{L}\n$$\nThe problem provides the definition of the symmetric rate-of-deformation tensor:\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^T)\n$$\nFrom this definition, it directly follows that $\\boldsymbol{L} + \\boldsymbol{L}^T = 2\\boldsymbol{D}$. Therefore, the lower-convected time derivative of the identity tensor is:\n$$\n\\stackrel{\\triangle}{\\boldsymbol{I}} = 2\\boldsymbol{D}\n$$\nThis result is physically significant. It states that the objective rate of change of the spatial metric is twice the rate-of-deformation tensor. This connects the geometric changes of the space inhabited by the continuum to the kinematics of the flow.\n\nFinally, we analyze the trace of this expression. The trace of a tensor is an invariant scalar quantity.\n$$\n\\text{tr}(\\stackrel{\\triangle}{\\boldsymbol{I}}) = \\text{tr}(2\\boldsymbol{D}) = 2\\text{tr}(\\boldsymbol{D})\n$$\nThe trace of the rate-of-deformation tensor is:\n$$\n\\text{tr}(\\boldsymbol{D}) = \\text{tr}\\left(\\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^T)\\right) = \\frac{1}{2}(\\text{tr}(\\boldsymbol{L}) + \\text{tr}(\\boldsymbol{L}^T))\n$$\nSince the trace of a tensor is equal to the trace of its transpose, $\\text{tr}(\\boldsymbol{L}) = \\text{tr}(\\boldsymbol{L}^T)$, this simplifies to:\n$$\n\\text{tr}(\\boldsymbol{D}) = \\text{tr}(\\boldsymbol{L})\n$$\nThe components of the velocity gradient are $L_{ij} = \\partial v_i/\\partial x_j$. Its trace is the sum of the diagonal components, which is the divergence of the velocity field:\n$$\n\\text{tr}(\\boldsymbol{L}) = \\sum_{i} L_{ii} = \\sum_{i} \\frac{\\partial v_i}{\\partial x_i} = \\nabla \\cdot \\boldsymbol{v}\n$$\nThus, the trace of our result is:\n$$\n\\text{tr}(\\stackrel{\\triangle}{\\boldsymbol{I}}) = 2(\\nabla \\cdot \\boldsymbol{v})\n$$\nThe divergence of the velocity field, $\\nabla \\cdot \\boldsymbol{v}$, represents the rate of change of volume of a material element per unit volume (the volumetric strain rate). For an incompressible flow, $\\nabla \\cdot \\boldsymbol{v} = 0$, and thus $\\text{tr}(\\stackrel{\\triangle}{\\boldsymbol{I}}) = 0$. For a compressible flow, the trace of the lower-convected derivative of the identity tensor is directly proportional to the rate of local volume change, providing a measure of the flow's compressibility.",
            "answer": "$$\n\\boxed{2\\boldsymbol{D}}\n$$"
        },
        {
            "introduction": "In computational fluid dynamics, theoretical principles must be faithfully translated into discrete numerical algorithms. This final practice bridges the gap between continuum theory and computational verification by challenging you to test the principle of objectivity itself. You will design and implement a numerical experiment  to confirm whether a first-order time-stepping scheme for tensor evolution correctly handles a superposed rigid-body rotation, a critical validation step for any robust complex fluid simulation code.",
            "id": "4097745",
            "problem": "Consider a computational test of material frame-indifference (objectivity) for second-order tensor evolution in complex fluids. Start from the principle of objectivity: superposed rigid body motions must not alter the physical predictions. Let a proper orthogonal rotation be represented by a time-dependent matrix $\\boldsymbol{Q}(t)$ that satisfies $\\boldsymbol{Q}(t) \\boldsymbol{Q}^{T}(t) = \\boldsymbol{I}$ and has angular velocity $\\boldsymbol{W}(t) = \\dot{\\boldsymbol{Q}}(t) \\boldsymbol{Q}^{T}(t)$, where $\\boldsymbol{W}(t)$ is skew-symmetric. Under a superposed rotation $\\boldsymbol{Q}(t)$, a second-order tensor $\\boldsymbol{A}(t)$ transforms as $\\boldsymbol{A}'(t) = \\boldsymbol{Q}(t) \\boldsymbol{A}(t) \\boldsymbol{Q}^{T}(t)$. The velocity gradient $\\boldsymbol{L}(t)$ transforms as $\\boldsymbol{L}'(t) = \\boldsymbol{Q}(t) \\boldsymbol{L}(t) \\boldsymbol{Q}^{T}(t) + \\boldsymbol{W}(t)$.\n\nYour task is to design a discrete, first-order accurate time-marching scheme and a numerical test that verifies objectivity for two objective time derivatives used in complex fluids: the upper-convected derivative and the lower-convected derivative. Begin from the principle of objectivity and the transformation rules above, and derive discrete update equations consistent with these objective derivatives in the special case where the convected derivative is set to zero. Use these derived discrete updates to propagate $\\boldsymbol{A}(t)$ forward in time for a given constant velocity gradient $\\boldsymbol{L}$ and a time-dependent rigid rotation $\\boldsymbol{Q}(t)$. Independently propagate $\\boldsymbol{A}'(t)$ forward using the rotated inputs $\\boldsymbol{L}'(t)$ and compare against $\\boldsymbol{Q}(t) \\boldsymbol{A}(t) \\boldsymbol{Q}^{T}(t)$.\n\nImplement the following in a complete, runnable program:\n- Assume a rotation about the $z$-axis with angle $\\theta(t) = \\omega t$ so that $\\boldsymbol{Q}(t)$ is the standard rotation matrix about $z$ and $\\boldsymbol{W}$ is constant. Use the angle unit radians.\n- Use a first-order explicit Euler time-marching scheme over $N$ uniform steps of size $\\Delta t$ to propagate $\\boldsymbol{A}(t)$ and $\\boldsymbol{A}'(t)$.\n- For the upper-convected derivative case, use the discrete update that is consistent with setting the upper-convected derivative to zero. For the lower-convected derivative case, use the discrete update consistent with setting the lower-convected derivative to zero.\n- At the final time $T = N \\Delta t$, compute the Frobenius-norm error $e = \\lVert \\boldsymbol{A}'_{\\text{num}}(T) - \\boldsymbol{Q}(T) \\boldsymbol{A}_{\\text{num}}(T) \\boldsymbol{Q}^{T}(T) \\rVert_{F}$, and report the normalized error $e / \\max(\\lVert \\boldsymbol{Q}(T) \\boldsymbol{A}_{\\text{num}}(T) \\boldsymbol{Q}^{T}(T) \\rVert_{F}, \\varepsilon)$ with $\\varepsilon = 10^{-15}$ to avoid division by zero.\n- Express rates (entries of $\\boldsymbol{L}$ and $\\omega$) in $\\text{s}^{-1}$ and time in $\\text{s}$. The normalized error is dimensionless.\n\nTest suite:\n- Case 1 (happy path, upper-convected): $\\boldsymbol{A}(0) = \\boldsymbol{I}$, $\\boldsymbol{L} = \\begin{bmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$ with $\\dot{\\gamma} = 1.0\\,\\text{s}^{-1}$, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$.\n- Case 2 (happy path, lower-convected): same $\\boldsymbol{A}(0)$, $\\boldsymbol{L}$, $\\omega$, $\\Delta t$, $N$ as Case 1, but using the lower-convected discrete update.\n- Case 3 (boundary, zero rotation): upper-convected with $\\boldsymbol{A}(0) = \\boldsymbol{I}$, $\\boldsymbol{L}$ as in Case 1, $\\omega = 0.0\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$.\n- Case 4 (edge, zero flow): upper-convected with $\\boldsymbol{A}(0) = \\operatorname{diag}(2,1,0.5)$, $\\boldsymbol{L} = \\boldsymbol{0}$, $\\omega = 1.0\\,\\text{s}^{-1}$, $\\Delta t = 0.005\\,\\text{s}$, $N = 200$.\n- Case 5 (large step, truncation stress test): upper-convected with $\\boldsymbol{A}(0) = \\boldsymbol{I}$, $\\boldsymbol{L}$ as in Case 1, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.1\\,\\text{s}$, $N = 10$.\n\nYour program should produce a single line of output containing the normalized errors for the five cases as a comma-separated list enclosed in square brackets (e.g., $[e_1,e_2,e_3,e_4,e_5]$), where each $e_i$ is a floating-point number.",
            "solution": "The problem requires designing and implementing a numerical test to verify the material frame-indifference (objectivity) of discrete time-marching schemes for two common objective time derivatives: the upper-convected derivative and the lower-convected derivative.\n\n**1. Principle of Objectivity and Transformation Rules**\n\nThe principle of material frame-indifference, or objectivity, states that the constitutive equations describing a material's behavior must be independent of the observer's frame of reference. Specifically, the equations must be invariant under a superposed time-dependent rigid-body motion. Such a motion can be described by a proper orthogonal rotation matrix $\\boldsymbol{Q}(t)$ ($\\boldsymbol{Q} \\boldsymbol{Q}^T = \\boldsymbol{I}$, $\\det(\\boldsymbol{Q}) = 1$).\n\nAs given in the problem statement, under such a rotation, a second-order tensor $\\boldsymbol{A}$ (e.g., a stress or conformation tensor) in the original frame transforms to $\\boldsymbol{A}'$ in the rotated frame according to:\n$$ \\boldsymbol{A}'(t) = \\boldsymbol{Q}(t) \\boldsymbol{A}(t) \\boldsymbol{Q}^T(t) $$\nThe velocity gradient tensor $\\boldsymbol{L}$ transforms as:\n$$ \\boldsymbol{L}'(t) = \\boldsymbol{Q}(t) \\boldsymbol{L}(t) \\boldsymbol{Q}^T(t) + \\boldsymbol{W}(t) $$\nwhere $\\boldsymbol{W}(t) = \\dot{\\boldsymbol{Q}}(t) \\boldsymbol{Q}^T(t)$ is the skew-symmetric angular velocity tensor of the superposed rotation. The dot denotes a time derivative, $\\dot{\\boldsymbol{Q}}(t) = d\\boldsymbol{Q}/dt$.\n\n**2. Objective Time Derivatives and Evolution Equations**\n\nAn objective time derivative of a tensor is a derivative that transforms covariantly with the tensor itself. That is, if $\\stackrel{\\nabla}{\\boldsymbol{A}}$ is an objective derivative of $\\boldsymbol{A}$, then its transformation must follow $(\\stackrel{\\nabla}{\\boldsymbol{A}})' = \\boldsymbol{Q} (\\stackrel{\\nabla}{\\boldsymbol{A}}) \\boldsymbol{Q}^T$.\n\nThe problem specifies two such derivatives:\n- **Upper-Convected Derivative (UCD)**: For a spatially homogeneous flow, the UCD of a tensor $\\boldsymbol{A}$ is defined as:\n  $$ \\stackrel{\\nabla}{\\boldsymbol{A}}_{UCD} = \\frac{d\\boldsymbol{A}}{dt} - \\boldsymbol{L} \\boldsymbol{A} - \\boldsymbol{A} \\boldsymbol{L}^T $$\n- **Lower-Convected Derivative (LCD)**: Similarly, the LCD is defined as:\n  $$ \\stackrel{\\triangle}{\\boldsymbol{A}}_{LCD} = \\frac{d\\boldsymbol{A}}{dt} + \\boldsymbol{A} \\boldsymbol{L} + \\boldsymbol{L}^T \\boldsymbol{A} $$\n\nThe task is to derive discrete updates for the special case where the objective derivative is set to zero. This is a common scenario in models like the Oldroyd-B model, where the objective rate of the elastic stress is balanced by other terms which we are effectively setting to zero for this test.\n\nSetting $\\stackrel{\\nabla}{\\boldsymbol{A}}_{UCD} = \\boldsymbol{0}$ gives the evolution equation:\n$$ \\frac{d\\boldsymbol{A}}{dt} = \\boldsymbol{L} \\boldsymbol{A} + \\boldsymbol{A} \\boldsymbol{L}^T \\quad (\\text{for UCD}) $$\nSetting $\\stackrel{\\triangle}{\\boldsymbol{A}}_{LCD} = \\boldsymbol{0}$ gives the evolution equation:\n$$ \\frac{d\\boldsymbol{A}}{dt} = -\\boldsymbol{A} \\boldsymbol{L} - \\boldsymbol{L}^T \\boldsymbol{A} \\quad (\\text{for LCD}) $$\n\n**3. Discretization: First-Order Explicit Euler Scheme**\n\nWe are instructed to use a first-order explicit Euler time-marching scheme. Applying this to the evolution equations above yields the discrete update rules. For a time step $\\Delta t$, we approximate $d\\boldsymbol{A}/dt \\approx (\\boldsymbol{A}(t+\\Delta t) - \\boldsymbol{A}(t)) / \\Delta t$.\n\n- **UCD Discrete Update**:\n  $$ \\frac{\\boldsymbol{A}(t+\\Delta t) - \\boldsymbol{A}(t)}{\\Delta t} \\approx \\boldsymbol{L}(t) \\boldsymbol{A}(t) + \\boldsymbol{A}(t) \\boldsymbol{L}^T(t) $$\n  $$ \\boldsymbol{A}(t+\\Delta t) = \\boldsymbol{A}(t) + \\Delta t (\\boldsymbol{L}(t) \\boldsymbol{A}(t) + \\boldsymbol{A}(t) \\boldsymbol{L}^T(t)) $$\n\n- **LCD Discrete Update**:\n  $$ \\frac{\\boldsymbol{A}(t+\\Delta t) - \\boldsymbol{A}(t)}{\\Delta t} \\approx -\\boldsymbol{A}(t) \\boldsymbol{L}(t) - \\boldsymbol{L}^T(t) \\boldsymbol{A}(t) $$\n  $$ \\boldsymbol{A}(t+\\Delta t) = \\boldsymbol{A}(t) - \\Delta t (\\boldsymbol{A}(t) \\boldsymbol{L}(t) + \\boldsymbol{L}^T(t) \\boldsymbol{A}(t)) $$\n\nThese explicit, first-order update rules will be used to propagate the tensor $\\boldsymbol{A}$ forward in time.\n\n**4. The Numerical Objectivity Test**\n\nThe test involves two parallel simulations over a time interval from $t=0$ to $T=N\\Delta t$:\n\n1.  **Unrotated (Lab) Frame Simulation**: We start with an initial tensor $\\boldsymbol{A}(0)$ and a constant velocity gradient $\\boldsymbol{L}$. We integrate forward in time using the appropriate discrete update rule (UCD or LCD) to find the numerical approximation $\\boldsymbol{A}_{\\text{num}}(T)$.\n    $$ \\boldsymbol{A}_{\\text{num}}(t_{n+1}) = \\text{update}(\\boldsymbol{A}_{\\text{num}}(t_n), \\boldsymbol{L}) $$\n\n2.  **Rotated Frame Simulation**: We start with the same initial tensor, $\\boldsymbol{A}'(0) = \\boldsymbol{Q}(0)\\boldsymbol{A}(0)\\boldsymbol{Q}^T(0) = \\boldsymbol{A}(0)$ since $\\boldsymbol{Q}(0)=\\boldsymbol{I}$. For each time step, we must use the transformed velocity gradient $\\boldsymbol{L}'(t_n) = \\boldsymbol{Q}(t_n) \\boldsymbol{L} \\boldsymbol{Q}^T(t_n) + \\boldsymbol{W}$. We then integrate forward using the same discrete update rule but with the transformed inputs to find $\\boldsymbol{A}'_{\\text{num}}(T)$.\n    $$ \\boldsymbol{A}'_{\\text{num}}(t_{n+1}) = \\text{update}(\\boldsymbol{A}'_{\\text{num}}(t_n), \\boldsymbol{L}'(t_n)) $$\n\nThe problem specifies a constant rotation rate $\\omega$ about the $z$-axis, so $\\theta(t) = \\omega t$.\n$$ \\boldsymbol{Q}(t) = \\begin{pmatrix} \\cos(\\omega t) & -\\sin(\\omega t) & 0 \\\\ \\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\boldsymbol{W}(t) = \\dot{\\boldsymbol{Q}}\\boldsymbol{Q}^T = \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nNote that $\\boldsymbol{W}$ is constant for this specific rotation.\n\n**5. Error Evaluation**\n\nIf the numerical scheme were perfectly objective, the result from the rotated simulation, $\\boldsymbol{A}'_{\\text{num}}(T)$, would be exactly equal to the rotated result from the lab frame simulation, $\\boldsymbol{Q}(T) \\boldsymbol{A}_{\\text{num}}(T) \\boldsymbol{Q}^T(T)$. Since the explicit Euler scheme is not perfectly objective (it is only first-order accurate), there will be a discrepancy. This discrepancy is the numerical error due to the scheme's lack of perfect objectivity.\n\nWe compute this error at the final time $T$ using the Frobenius norm:\n$$ \\boldsymbol{A}'_{\\text{target}}(T) = \\boldsymbol{Q}(T) \\boldsymbol{A}_{\\text{num}}(T) \\boldsymbol{Q}^T(T) $$\n$$ e = \\lVert \\boldsymbol{A}'_{\\text{num}}(T) - \\boldsymbol{A}'_{\\text{target}}(T) \\rVert_F $$\nThe normalized error is then calculated as:\n$$ e_{\\text{norm}} = \\frac{e}{\\max(\\lVert \\boldsymbol{A}'_{\\text{target}}(T) \\rVert_F, \\varepsilon)} $$\nwhere $\\varepsilon = 10^{-15}$ is a small number to prevent division by zero. The expected error for this first-order scheme should be proportional to $\\Delta t$. The numerical implementation will execute this procedure for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the objectivity test problem for UCD and LCD schemes.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, upper-convected)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 2 (happy path, lower-convected)\n        {'type': 'lower', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 3 (boundary, zero rotation)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.0, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 4 (edge, zero flow)\n        {'type': 'upper', 'A0': None, 'L_val': 0.0, 'omega': 1.0, 'dt': 0.005, 'N': 200, 'A0_diag': [2.0, 1.0, 0.5]},\n        # Case 5 (large step, truncation stress-test)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.1, 'N': 10}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        error = run_case(case)\n        results.append(f\"{error:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_case(params):\n    \"\"\"\n    Runs a single objectivity test case.\n    \"\"\"\n    derivative_type = params['type']\n    omega = params['omega']\n    dt = params['dt']\n    N = params['N']\n    L_val = params.get('L_val', 0.0)\n    eps = 1e-15\n\n    # Initialize A0\n    if params.get('A0_diag') is not None:\n        A0 = np.diag(params['A0_diag'])\n    else:\n        A0 = params['A0']\n\n    # Initialize matrices\n    A_num = A0.copy()\n    A_prime_num = A0.copy()  # A'(0) = Q(0)A(0)Q(0)^T = A(0) since Q(0) = I\n\n    # Define constant tensors\n    L = np.array([[0.0, L_val, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    L_T = L.T\n    W = omega * np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n    # Time-marching loop\n    for n in range(N):\n        t_n = n * dt\n        \n        # Calculate rotated quantities at time t_n\n        c, s = np.cos(omega * t_n), np.sin(omega * t_n)\n        Q_n = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n        \n        L_prime_n = Q_n @ L @ Q_n.T + W\n        L_prime_n_T = L_prime_n.T\n\n        # Update A_num (unrotated frame)\n        if derivative_type == 'upper':\n            A_num += dt * (L @ A_num + A_num @ L_T)\n        else: # lower-convected\n            A_num -= dt * (A_num @ L + L_T @ A_num)\n\n        # Update A_prime_num (rotated frame)\n        if derivative_type == 'upper':\n            A_prime_num += dt * (L_prime_n @ A_prime_num + A_prime_num @ L_prime_n_T)\n        else: # lower-convected\n            A_prime_num -= dt * (A_prime_num @ L_prime_n + L_prime_n_T @ A_prime_num)\n\n    # Final calculations after loop\n    T = N * dt\n    \n    # Final rotation matrix Q(T)\n    c, s = np.cos(omega * T), np.sin(omega * T)\n    Q_T = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n\n    # Target transformed tensor\n    A_prime_target = Q_T @ A_num @ Q_T.T\n\n    # Error calculation\n    error_norm = np.linalg.norm(A_prime_num - A_prime_target, 'fro')\n    target_norm = np.linalg.norm(A_prime_target, 'fro')\n    \n    normalized_error = error_norm / max(target_norm, eps)\n    \n    return normalized_error\n\nsolve()\n```"
        }
    ]
}