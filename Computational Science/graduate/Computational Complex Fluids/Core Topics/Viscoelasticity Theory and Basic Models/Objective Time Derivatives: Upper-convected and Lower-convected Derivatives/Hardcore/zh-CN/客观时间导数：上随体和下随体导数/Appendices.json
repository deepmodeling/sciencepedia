{
    "hands_on_practices": [
        {
            "introduction": "简单剪切流是研究复杂流体流变响应的基础模型。本练习将通过一个经典的剪切流场，让您亲手实践上随体和下随体导数的定义，并直观地看到张量分量是如何被剪切作用所影响的。掌握这项基本计算技能，对于分析和理解流变本构模型至关重要。",
            "id": "4097761",
            "problem": "考虑一个三维不可压缩连续体，其经历稳态简单剪切流，速度场为 $v(x) = (\\gamma y, 0, 0)$，其中 $\\gamma$ 是一个恒定的剪切速率。空间速度梯度张量为 $L = \\nabla v = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$。设 $A(t)$ 是一个随物质运动的、普遍的对称、空间均匀（无空间梯度）的二阶张量场，其笛卡尔分量为 $A(t) = \\begin{pmatrix} a_{11}(t)  a_{12}(t)  a_{13}(t) \\\\ a_{12}(t)  a_{22}(t)  a_{23}(t) \\\\ a_{13}(t)  a_{23}(t)  a_{33}(t) \\end{pmatrix}$。\n\n从张量场的物质时间导数定义、物质线元的运动学以及在叠加刚体运动下的标架无关性（客观性）要求出发，推导在此流动中 $A(t)$ 的上随体和下随体客观时间导数的形式。然后，用 $\\dot{a}_{ij}(t)$、$a_{ij}(t)$ 和 $\\gamma$ 来逐分量计算这些导数。显式计算 $\\overset{\\nabla}{A}$ 和 $\\underset{\\nabla}{A}$，并指明哪些分量通过与 $A$ 的特定分量耦合而直接受到剪切速率 $\\gamma$ 的影响。\n\n将您的最终答案以一对分别为 $\\overset{\\nabla}{A}$ 和 $\\underset{\\nabla}{A}$ 的解析 $3 \\times 3$ 矩阵表达式的形式提供，并排排列成一个单行矩阵。不需要单位。不需要四舍五入。",
            "solution": "该问题要求在一个稳态简单剪切流中，推导并计算一个对称、空间均匀的二阶张量场 $A(t)$ 的上随体和下随体时间导数。\n\n首先，我们阐述客观时间导数的定义以及它们与物质几何元素（线元和面元）的联系。对于空间均匀的张量场 $A(t)$，其物质导数 $DA/Dt$ 就是时间偏导数 $\\partial A / \\partial t = \\dot{A}(t)$。\n\n一个物质**线元**矢量 $dx$ 连接两个相邻的物质点，其随时间的演化由速度梯度 $L$ 控制：\n$$ \\frac{D}{dt}(dx) = L \\cdot dx $$\n一个物质**面元**矢量 $da$ 其演化由下式控制（基于Nanson公式）：\n$$ \\frac{D}{dt}(da) = -L^T \\cdot da $$\n\n**下随体导数** ($\\underset{\\nabla}{A}$) 与**协变张量**的变换特性相关。如果一个二阶协变张量 `A` 只是随流体被动输运，那么它与任意两个线元 `dx` 构成的标量 $dx \\cdot A \\cdot dx$ 将保持不变。下随体导数即为衡量偏离此行为的量。因此，我们定义下随体导数为零的条件是：\n$$ \\frac{D}{dt}(dx \\cdot A \\cdot dx) = 0 $$\n应用乘法法则：\n$$ \\left(\\frac{D(dx)}{dt}\\right) \\cdot A \\cdot dx + dx \\cdot \\dot{A} \\cdot dx + dx \\cdot A \\cdot \\left(\\frac{D(dx)}{dt}\\right) = 0 $$\n$$ (L \\cdot dx) \\cdot A \\cdot dx + dx \\cdot \\dot{A} \\cdot dx + dx \\cdot A \\cdot (L \\cdot dx) = 0 $$\n利用张量运算性质 $(M \\cdot u) \\cdot v = u \\cdot (M^T \\cdot v)$：\n$$ dx \\cdot (L^T \\cdot A) \\cdot dx + dx \\cdot \\dot{A} \\cdot dx + dx \\cdot (A \\cdot L) \\cdot dx = 0 $$\n$$ dx \\cdot (\\dot{A} + L^T A + A L) \\cdot dx = 0 $$\n由于该式必须对任意线元 $dx$ 成立，因此括号中的表达式定义了下随体导数：\n$$ \\underset{\\nabla}{A} = \\dot{A} + L^T \\cdot A + A \\cdot L $$\n\n**上随体导数** ($\\overset{\\nabla}{A}$) 与**逆变张量**的变换特性相关。如果一个二阶逆变张量 $A$ 只是随流体被动输运，那么它与任意两个面元 $da$ 构成的标量 $da \\cdot A \\cdot da$ 将保持不变。上随体导数为零的条件是：\n$$ \\frac{D}{dt}(da \\cdot A \\cdot da) = 0 $$\n同样应用乘法法则：\n$$ \\left(\\frac{D(da)}{dt}\\right) \\cdot A \\cdot da + da \\cdot \\dot{A} \\cdot da + da \\cdot A \\cdot \\left(\\frac{D(da)}{dt}\\right) = 0 $$\n$$ (-L^T \\cdot da) \\cdot A \\cdot da + da \\cdot \\dot{A} \\cdot da + da \\cdot A \\cdot (-L^T \\cdot da) = 0 $$\n$$ da \\cdot (-L \\cdot A) \\cdot da + da \\cdot \\dot{A} \\cdot da + da \\cdot (-A \\cdot L^T) \\cdot da = 0 $$\n$$ da \\cdot (\\dot{A} - L A - A L^T) \\cdot da = 0 $$\n由于该式必须对任意面元 $da$ 成立，因此括号中的表达式定义了上随体导数：\n$$ \\overset{\\nabla}{A} = \\dot{A} - L \\cdot A - A \\cdot L^T $$\n\n现在我们针对给定的简单剪切流计算这些表达式。速度场为 $v = (\\gamma y, 0, 0)$，其中 $\\gamma$ 是恒定的剪切速率。\n速度梯度张量 $L$ 及其转置 $L^T$ 为：\n$$ L = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad L^T = \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n张量 $A(t)$ 及其时间导数 $\\dot{A}(t)$ 是对称的：\n$$ A = \\begin{pmatrix} a_{11}  a_{12}  a_{13} \\\\ a_{12}  a_{22}  a_{23} \\\\ a_{13}  a_{23}  a_{33} \\end{pmatrix}, \\quad \\dot{A} = \\begin{pmatrix} \\dot{a}_{11}  \\dot{a}_{12}  \\dot{a}_{13} \\\\ \\dot{a}_{12}  \\dot{a}_{22}  \\dot{a}_{23} \\\\ \\dot{a}_{13}  \\dot{a}_{23}  \\dot{a}_{33} \\end{pmatrix} $$\n为简洁起见，省略了参数 $(t)$。\n\n计算上随体导数 $\\overset{\\nabla}{A}$：\n我们首先计算乘积 $L \\cdot A$ 和 $A \\cdot L^T$。\n$$ L \\cdot A = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} a_{11}  a_{12}  a_{13} \\\\ a_{12}  a_{22}  a_{23} \\\\ a_{13}  a_{23}  a_{33} \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12}  \\gamma a_{22}  \\gamma a_{23} \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ A \\cdot L^T = \\begin{pmatrix} a_{11}  a_{12}  a_{13} \\\\ a_{12}  a_{22}  a_{23} \\\\ a_{13}  a_{23}  a_{33} \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12}  0  0 \\\\ \\gamma a_{22}  0  0 \\\\ \\gamma a_{23}  0  0 \\end{pmatrix} $$\n将这两项相加：\n$$ L \\cdot A + A \\cdot L^T = \\begin{pmatrix} 2\\gamma a_{12}  \\gamma a_{22}  \\gamma a_{23} \\\\ \\gamma a_{22}  0  0 \\\\ \\gamma a_{23}  0  0 \\end{pmatrix} $$\n最后，我们从 $\\dot{A}$ 中减去此项：\n$$ \\overset{\\nabla}{A} = \\dot{A} - (L \\cdot A + A \\cdot L^T) = \\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12}  \\dot{a}_{12} - \\gamma a_{22}  \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22}  \\dot{a}_{22}  \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23}  \\dot{a}_{23}  \\dot{a}_{33} \\end{pmatrix} $$\n\n计算下随体导数 $\\underset{\\nabla}{A}$：\n我们计算乘积 $L^T \\cdot A$ 和 $A \\cdot L$。\n$$ L^T \\cdot A = \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} a_{11}  a_{12}  a_{13} \\\\ a_{12}  a_{22}  a_{23} \\\\ a_{13}  a_{23}  a_{33} \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ \\gamma a_{11}  \\gamma a_{12}  \\gamma a_{13} \\\\ 0  0  0 \\end{pmatrix} $$\n$$ A \\cdot L = \\begin{pmatrix} a_{11}  a_{12}  a_{13} \\\\ a_{12}  a_{22}  a_{23} \\\\ a_{13}  a_{23}  a_{33} \\end{pmatrix} \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\gamma a_{11}  0 \\\\ 0  \\gamma a_{12}  0 \\\\ 0  \\gamma a_{13}  0 \\end{pmatrix} $$\n将这两项相加：\n$$ L^T \\cdot A + A \\cdot L = \\begin{pmatrix} 0  \\gamma a_{11}  0 \\\\ \\gamma a_{11}  2\\gamma a_{12}  \\gamma a_{13} \\\\ 0  \\gamma a_{13}  0 \\end{pmatrix} $$\n最后，我们将此项加到 $\\dot{A}$ 上：\n$$ \\underset{\\nabla}{A} = \\dot{A} + (L^T \\cdot A + A \\cdot L) = \\begin{pmatrix} \\dot{a}_{11}  \\dot{a}_{12} + \\gamma a_{11}  \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11}  \\dot{a}_{22} + 2\\gamma a_{12}  \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13}  \\dot{a}_{23} + \\gamma a_{13}  \\dot{a}_{33} \\end{pmatrix} $$\n\n对于上随体导数 $\\overset{\\nabla}{A}$，剪切速率 $\\gamma$ 直接影响分量 $(\\overset{\\nabla}{A})_{11}$、$(\\overset{\\nabla}{A})_{12}$（及其对称分量 $(\\overset{\\nabla}{A})_{21}$）和 $(\\overset{\\nabla}{A})_{13}$（及 $(\\overset{\\nabla}{A})_{31}$）。具体来说，剪切流将剪切分量 $a_{12}$ 耦合到法向分量 $(\\overset{\\nabla}{A})_{11}$，将法向分量 $a_{22}$ 耦合到剪切分量 $(\\overset{\\nabla}{A})_{12}$，并将分量 $a_{23}$ 耦合到剪切分量 $(\\overset{\\nabla}{A})_{13}$。\n\n对于下随体导数 $\\underset{\\nabla}{A}$，剪切速率 $\\gamma$ 直接影响分量 $(\\underset{\\nabla}{A})_{12}$（及其对称分量 $(\\underset{\\nabla}{A})_{21}$）、$(\\underset{\\nabla}{A})_{22}$ 和 $(\\underset{\\nabla}{A})_{23}$（及 $(\\underset{\\nabla}{A})_{32}$）。具体来说，流动将法向分量 $a_{11}$ 耦合到剪切分量 $(\\underset{\\nabla}{A})_{12}$，将剪切分量 $a_{12}$ 耦合到法向分量 $(\\underset{\\nabla}{A})_{22}$，并将分量 $a_{13}$ 耦合到剪切分量 $(\\underset{\\nabla}{A})_{23}$。\n\n这两个客观导数的最终表达式即为上面推导出的矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12}  \\dot{a}_{12} - \\gamma a_{22}  \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22}  \\dot{a}_{22}  \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23}  \\dot{a}_{23}  \\dot{a}_{33} \\end{pmatrix}\n\n\\begin{pmatrix} \\dot{a}_{11}  \\dot{a}_{12} + \\gamma a_{11}  \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11}  \\dot{a}_{22} + 2\\gamma a_{12}  \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13}  \\dot{a}_{23} + \\gamma a_{13}  \\dot{a}_{33} \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了在具体流场中进行计算，理解这些客观导数的基本性质也同样重要。本练习将引导您探索单位张量 $\\boldsymbol{I}$ 的下随体导数，这个推导将揭示一个深刻的联系：这个抽象的数学工具与描述流体局部变形速率的物理量——形变率张量 $\\boldsymbol{D}$——直接相关。这一结果为我们理解随体导数的物理意义提供了关键的视角。",
            "id": "4097756",
            "problem": "考虑一个三维空间中的连续流体，其速度场 $\\boldsymbol{v}(\\boldsymbol{x},t)$ 是光滑的。令速度梯度为二阶张量 $\\boldsymbol{L}(\\boldsymbol{x},t)$，其分量为 $L_{ij} = \\partial v_{i}/\\partial x_{j}$，并定义对称形变率张量 $\\boldsymbol{D} = (\\boldsymbol{L} + \\boldsymbol{L}^{T})/2$。用 $\\boldsymbol{I}$ 表示二阶单位张量。物质坐标系无关性（客观性）原理要求，张量场的任何具有物理意义的时间导数，在叠加一个由随时间变化的正交张量 $\\boldsymbol{Q}(t)$ 表示的刚体运动下，必须进行恰当的变换。\n\n从流动映射的基本运动学和叠加刚体运动下的客观性要求出发，推导单位张量的客观下随体时间导数（记为 $\\boldsymbol{I}_{\\nabla}$），并用 $\\boldsymbol{L}$ 和/或 $\\boldsymbol{D}$ 表示。推导中只能使用 $\\boldsymbol{L}$、$\\boldsymbol{D}$、单位张量 $\\boldsymbol{I}$ 和物质时间导数的定义，以及二阶张量在刚性旋转下的变换定律。你的推导应明确确保所得的导数消除了刚体旋转和平移带来的虚假影响，并与流动的运动学相一致。\n\n最后，给出 $\\boldsymbol{I}_{\\nabla}$ 的闭式解析表达式作为你的答案。在你的解答中，解释所得表达式的迹如何与可压缩性和局部体积变化相关联，但最终答案仅需写出 $\\boldsymbol{I}_{\\nabla}$ 的解析表达式。不需要任何数值，也无需进行舍入。",
            "solution": "问题要求推导二阶单位张量 $\\boldsymbol{I}$ 的下随体时间导数，记为 $\\boldsymbol{I}_{\\nabla}$。推导必须基于连续介质运动学的基本原理和客观性要求。最终表达式应以速度梯度张量 $\\boldsymbol{L}$ 和/或形变率张量 $\\boldsymbol{D}$ 表示。\n\n客观时间导数的概念源于需要区分物质元的张量属性的内在变化率与由该物质元的刚体旋转引起的表观变化率。下随体导数是与协变张量自然关联的客观时间导数，协变张量“逆”着变形进行变换。\n\n我们首先从运动学角度建立下随体导数的一般形式。考虑变形梯度 $\\boldsymbol{F}$，它将向量从参考构型映射到当前（空间）构型。其物质时间导数由以下运动学关系给出：\n$$\n\\frac{D\\boldsymbol{F}}{Dt} = \\boldsymbol{L}\\boldsymbol{F}\n$$\n其中 $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$ 是空间速度梯度。\n\n在空间描述中，一个典型的协变张量是左柯西-格林形变张量的逆，我们记为 $\\boldsymbol{b}$。左柯西-格林张量本身是 $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^T$，是一个逆变张量。它的逆是 $\\boldsymbol{b} = \\boldsymbol{B}^{-1} = (\\boldsymbol{F}^{-1})^T\\boldsymbol{F}^{-1}$。下随体导数正是这样一种客观时间导数，当它作用于 $\\boldsymbol{b}$ 时，得到零张量，这表明在一个随材料一起随动和变形的坐标系中观察时，$\\boldsymbol{b}$ 是恒定的。\n\n让我们求 $\\boldsymbol{B}$ 的物质时间导数：\n$$\n\\frac{D\\boldsymbol{B}}{Dt} = \\frac{D}{Dt}(\\boldsymbol{F}\\boldsymbol{F}^T) = \\frac{D\\boldsymbol{F}}{Dt}\\boldsymbol{F}^T + \\boldsymbol{F}\\left(\\frac{D\\boldsymbol{F}}{Dt}\\right)^T\n$$\n代入 $\\frac{D\\boldsymbol{F}}{Dt} = \\boldsymbol{L}\\boldsymbol{F}$，我们得到：\n$$\n\\frac{D\\boldsymbol{B}}{Dt} = (\\boldsymbol{L}\\boldsymbol{F})\\boldsymbol{F}^T + \\boldsymbol{F}(\\boldsymbol{L}\\boldsymbol{F})^T = \\boldsymbol{L}(\\boldsymbol{F}\\boldsymbol{F}^T) + \\boldsymbol{F}\\boldsymbol{F}^T\\boldsymbol{L}^T = \\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^T\n$$\n现在，我们通过对恒等式 $\\boldsymbol{B}\\boldsymbol{b} = \\boldsymbol{I}$ 求导来求其逆 $\\boldsymbol{b} = \\boldsymbol{B}^{-1}$ 的物质时间导数：\n$$\n\\frac{D}{Dt}(\\boldsymbol{B}\\boldsymbol{b}) = \\frac{D\\boldsymbol{I}}{Dt}\n$$\n在固定的笛卡尔坐标系中，单位张量 $\\boldsymbol{I}$ 是一个常张量场，意味着它在空间中所有点和所有时刻的值都相同。因此，它对空间和时间的偏导数都为零，其物质导数也为零：$\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}$。\n应用乘法法则：\n$$\n\\frac{D\\boldsymbol{B}}{Dt}\\boldsymbol{b} + \\boldsymbol{B}\\frac{D\\boldsymbol{b}}{Dt} = \\boldsymbol{0}\n$$\n解出 $\\frac{D\\boldsymbol{b}}{Dt}$：\n$$\n\\frac{D\\boldsymbol{b}}{Dt} = -\\boldsymbol{B}^{-1}\\frac{D\\boldsymbol{B}}{Dt}\\boldsymbol{b} = -\\boldsymbol{b}\\left(\\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^T\\right)\\boldsymbol{b}\n$$\n将 $\\boldsymbol{b}$ 分配进去并使用 $\\boldsymbol{B}\\boldsymbol{b}=\\boldsymbol{I}$：\n$$\n\\frac{D\\boldsymbol{b}}{Dt} = -\\boldsymbol{b}\\boldsymbol{L}(\\boldsymbol{B}\\boldsymbol{b}) - (\\boldsymbol{b}\\boldsymbol{B})\\boldsymbol{L}^T\\boldsymbol{b} = -\\boldsymbol{b}\\boldsymbol{L} - \\boldsymbol{L}^T\\boldsymbol{b}\n$$\n重新整理此方程得到：\n$$\n\\frac{D\\boldsymbol{b}}{Dt} + \\boldsymbol{L}^T\\boldsymbol{b} + \\boldsymbol{b}\\boldsymbol{L} = \\boldsymbol{0}\n$$\n这个结果揭示了下随体导数的结构。对于一个一般的二阶协变张量场 $\\boldsymbol{T}$，其下随体导数（我们记为 $\\boldsymbol{T}_{\\nabla}$）定义为：\n$$\n\\boldsymbol{T}_{\\nabla} = \\frac{D\\boldsymbol{T}}{Dt} + \\boldsymbol{L}^T\\boldsymbol{T} + \\boldsymbol{T}\\boldsymbol{L}\n$$\n这种形式确保了该导数是客观的，即在观察者改变时它能正确地变换。\n\n题目要求我们求单位张量 $\\boldsymbol{I}$ 的下随体导数。单位张量 $\\boldsymbol{I}$ 可以被解释为欧几里得空间的度量张量。作为度量，它是一个协变张量。因此，我们可以应用上面推导出的公式。\n如前所述，单位张量在固定参考系中的物质导数为零：\n$$\n\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}\n$$\n将 $\\boldsymbol{T} = \\boldsymbol{I}$ 和 $\\frac{D\\boldsymbol{I}}{Dt} = \\boldsymbol{0}$ 代入下随体导数的定义中：\n$$\n\\boldsymbol{I}_{\\nabla} = \\boldsymbol{0} + \\boldsymbol{L}^T\\boldsymbol{I} + \\boldsymbol{I}\\boldsymbol{L}\n$$\n使用单位张量的性质（对于任意张量 $\\boldsymbol{A}$ 都有 $\\boldsymbol{A}\\boldsymbol{I} = \\boldsymbol{I}\\boldsymbol{A} = \\boldsymbol{A}$）：\n$$\n\\boldsymbol{I}_{\\nabla} = \\boldsymbol{L}^T + \\boldsymbol{L}\n$$\n问题给出了对称形变率张量的定义：\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^T)\n$$\n根据这个定义，直接可以得出 $\\boldsymbol{L} + \\boldsymbol{L}^T = 2\\boldsymbol{D}$。因此，单位张量的下随体时间导数为：\n$$\n\\boldsymbol{I}_{\\nabla} = 2\\boldsymbol{D}\n$$\n这个结果具有重要的物理意义。它表明空间度量的客观变化率是形变率张量的两倍。这把连续介质所处空间的几何变化与流动的运动学联系了起来。\n\n最后，我们分析这个表达式的迹。张量的迹是一个不变标量。\n$$\n\\text{tr}(\\boldsymbol{I}_{\\nabla}) = \\text{tr}(2\\boldsymbol{D}) = 2\\text{tr}(\\boldsymbol{D})\n$$\n形变率张量的迹为：\n$$\n\\text{tr}(\\boldsymbol{D}) = \\text{tr}\\left(\\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^T)\\right) = \\frac{1}{2}(\\text{tr}(\\boldsymbol{L}) + \\text{tr}(\\boldsymbol{L}^T))\n$$\n因为一个张量的迹等于其转置的迹，即 $\\text{tr}(\\boldsymbol{L}) = \\text{tr}(\\boldsymbol{L}^T)$，所以上式简化为：\n$$\n\\text{tr}(\\boldsymbol{D}) = \\text{tr}(\\boldsymbol{L})\n$$\n速度梯度的分量是 $L_{ij} = \\partial v_i/\\partial x_j$。它的迹是对角分量之和，也就是速度场的散度：\n$$\n\\text{tr}(\\boldsymbol{L}) = \\sum_{i} L_{ii} = \\sum_{i} \\frac{\\partial v_i}{\\partial x_i} = \\nabla \\cdot \\boldsymbol{v}\n$$\n因此，我们结果的迹为：\n$$\n\\text{tr}(\\boldsymbol{I}_{\\nabla}) = 2(\\nabla \\cdot \\boldsymbol{v})\n$$\n速度场的散度 $\\nabla \\cdot \\boldsymbol{v}$ 代表了单位体积物质元的体积变化率（即体积应变率）。对于不可压缩流，$\\nabla \\cdot \\boldsymbol{v} = 0$，因此 $\\text{tr}(\\boldsymbol{I}_{\\nabla}) = 0$。对于可压缩流，单位张量的下随体导数的迹与局部体积变化率成正比，从而提供了对流动可压缩性的度量。",
            "answer": "$$\n\\boxed{2\\boldsymbol{D}}\n$$"
        },
        {
            "introduction": "在计算流体力学领域，理论的正确性必须转化为稳健的数值算法。这个编程练习旨在设计一个数值测试，以验证所构建的时间推进格式是否真正遵循了物质标架无关性原理。通过这个实践，您将学会如何验证和确认复杂流体仿真代码的可靠性，这是从理论走向计算实践的关键一步。",
            "id": "4097745",
            "problem": "考虑一个针对复杂流体中二阶张量演化的物质标架无关性（客观性）的计算测试。从客观性原理出发：叠加的刚体运动不能改变物理预测。设一个真正交旋转由一个随时间变化的矩阵 $Q(t)$ 表示，该矩阵满足 $Q(t) Q^{T}(t) = I$，其角速度为 $W(t) = \\dot{Q}(t) Q^{T}(t)$，其中 $W(t)$ 是反对称的。在叠加旋转 $Q(t)$ 下，一个二阶张量 $A(t)$ 变换为 $A'(t) = Q(t) A(t) Q^{T}(t)$。速度梯度 $L(t)$ 变换为 $L'(t) = Q(t) L(t) Q^{T}(t) + W(t)$。\n\n您的任务是设计一个离散、一阶精度的时间步进格式和一个数值测试，以验证复杂流体中使用的两种客观时间导数——上随体导数和下随体导数的客观性。从客观性原理和上述变换规则出发，推导在客观导数设为零的特殊情况下，与这些客观导数一致的离散更新方程。对于给定的恒定速度梯度 $L$ 和随时间变化的刚性旋转 $Q(t)$，使用这些推导出的离散更新来将 $A(t)$ 在时间上向前推进。独立地使用旋转后的输入 $L'(t)$ 向前推进 $A'(t)$，并将其结果与 $Q(t) A(t) Q^{T}(t)$ 进行比较。\n\n在完整的、可运行的程序中实现以下内容：\n- 假设绕 $z$ 轴旋转，角度为 $\\theta(t) = \\omega t$，因此 $Q(t)$ 是标准的绕 $z$ 轴的旋转矩阵，且 $W$ 为常数。角度单位使用弧度。\n- 使用一阶显式欧拉时间步进格式，通过 $N$ 个大小为 $\\Delta t$ 的均匀步长来推进 $A(t)$ 和 $A'(t)$。\n- 对于上随体导数情况，使用与将上随体导数设为零相一致的离散更新。对于下随体导数情况，使用与将下随体导数设为零相一致的离散更新。\n- 在最终时间 $T = N \\Delta t$ 时，计算弗罗贝尼乌斯范数误差 $e = \\lVert A'_{\\text{num}}(T) - Q(T) A_{\\text{num}}(T) Q^{T}(T) \\rVert_{F}$，并报告归一化误差 $e / \\max(\\lVert Q(T) A_{\\text{num}}(T) Q^{T}(T) \\rVert_{F}, \\varepsilon)$，其中 $\\varepsilon = 10^{-15}$ 用于避免除以零。\n- 以 $\\text{s}^{-1}$ 为单位表示速率（$L$ 和 $\\omega$ 的条目），以 $\\text{s}$ 为单位表示时间。归一化误差是无量纲的。\n\n测试套件：\n- 用例 1 (正常路径，上随体): $A(0) = I$, $L = \\begin{bmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ 其中 $\\dot{\\gamma} = 1.0\\,\\text{s}^{-1}$, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$。\n- 用例 2 (正常路径，下随体): 与用例 1 相同的 $A(0)$, $L$, $\\omega$, $\\Delta t$, $N$，但使用下随体离散更新。\n- 用例 3 (边界情况，零旋转): 上随体，其中 $A(0) = I$, $L$ 如用例 1 所示, $\\omega = 0.0\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$。\n- 用例 4 (边缘情况，零流动): 上随体，其中 $A(0) = \\operatorname{diag}(2,1,0.5)$, $L = 0$, $\\omega = 1.0\\,\\text{s}^{-1}$, $\\Delta t = 0.005\\,\\text{s}$, $N = 200$。\n- 用例 5 (大步长，截断误差压力测试): 上随体，其中 $A(0) = I$, $L$ 如用例 1 所示, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.1\\,\\text{s}$, $N = 10$。\n\n您的程序应生成单行输出，其中包含五个测试用例的归一化误差，格式为逗号分隔的列表，并用方括号括起来 (例如 $[e_1,e_2,e_3,e_4,e_5]$)，其中每个 $e_i$ 是一个浮点数。",
            "solution": "该问题要求设计并实现一个数值测试，以验证两种常见客观时间导数——上随体导数和下随体导数——的离散时间步进格式的物质标架无关性（客观性）。\n\n**1. 客观性原理与变换规则**\n\n物质标架无关性原理，或称客观性原理，指出描述材料行为的本构方程必须独立于观察者的参考系。具体来说，这些方程必须在叠加的随时间变化的刚体运动下保持不变。这种运动可以用一个真正交旋转矩阵 $Q(t)$ ($Q Q^T = I$, $\\det(Q) = 1$) 来描述。\n\n如问题陈述中所给出的，在此类旋转下，原始标架中的二阶张量 $A$（例如应力或构象张量）在旋转标架中变换为 $A'$，遵循以下规则：\n$$ A'(t) = Q(t) A(t) Q^T(t) $$\n速度梯度张量 $L$ 变换为：\n$$ L'(t) = Q(t) L(t) Q^T(t) + W(t) $$\n其中 $W(t) = \\dot{Q}(t) Q^T(t)$ 是叠加旋转的反对称角速度张量。点号表示时间导数，$\\dot{Q}(t) = dQ/dt$。\n\n**2. 客观时间导数与演化方程**\n\n张量的一个客观时间导数是一种与张量本身协变变换的导数。也就是说，如果 $\\overset{\\triangledown}{A}$ 是 $A$ 的一个客观导数，那么它的变换必须遵循 $(\\overset{\\triangledown}{A})' = Q (\\overset{\\triangledown}{A}) Q^T$。\n\n问题指定了两种此类导数：\n- **上随体导数 (UCD)**：对于空间均匀流动，张量 $A$ 的上随体导数定义为：\n  $$ \\overset{\\triangledown}{A}_{UCD} = \\frac{dA}{dt} - L A - A L^T $$\n- **下随体导数 (LCD)**：类似地，下随体导数定义为：\n  $$ \\overset{\\triangledown}{A}_{LCD} = \\frac{dA}{dt} + A L + L^T A $$\n\n任务是推导在客观导数设为零的特殊情况下的离散更新。这在像 Oldroyd-B 这样的模型中是一种常见情况，其中弹性应力的客观速率被其他项平衡，而在这个测试中我们有效地将这些项设为零。\n\n设置 $\\overset{\\triangledown}{A}_{UCD} = 0$ 得到演化方程：\n$$ \\frac{dA}{dt} = L A + A L^T \\quad (\\text{对于 UCD}) $$\n设置 $\\overset{\\triangledown}{A}_{LCD} = 0$ 得到演化方程：\n$$ \\frac{dA}{dt} = -A L - L^T A \\quad (\\text{对于 LCD}) $$\n\n**3. 离散化：一阶显式欧拉格式**\n\n根据指示，我们使用一阶显式欧拉时间步进格式。将此格式应用于上述演化方程，得到离散更新规则。对于时间步长 $\\Delta t$，我们近似 $dA/dt \\approx (A(t+\\Delta t) - A(t)) / \\Delta t$。\n\n- **UCD 离散更新**：\n  $$ \\frac{A(t+\\Delta t) - A(t)}{\\Delta t} \\approx L(t) A(t) + A(t) L^T(t) $$\n  $$ A(t+\\Delta t) = A(t) + \\Delta t (L(t) A(t) + A(t) L^T(t)) $$\n\n- **LCD 离散更新**：\n  $$ \\frac{A(t+\\Delta t) - A(t)}{\\Delta t} \\approx -A(t) L(t) - L^T(t) A(t) $$\n  $$ A(t+\\Delta t) = A(t) - \\Delta t (A(t) L(t) + L^T(t) A(t)) $$\n\n这些显式的一阶更新规则将用于将张量 $A$ 在时间上向前推进。\n\n**4. 数值客观性测试**\n\n该测试涉及在从 $t=0$ 到 $T=N\\Delta t$ 的时间间隔内进行两个并行模拟：\n\n1.  **非旋转（实验室）标架模拟**：我们从初始张量 $A(0)$ 和恒定速度梯度 $L$ 开始。我们使用适当的离散更新规则（UCD 或 LCD）在时间上向前积分，以找到数值近似解 $A_{\\text{num}}(T)$。\n    $$ A_{\\text{num}}(t_{n+1}) = \\text{update}(A_{\\text{num}}(t_n), L) $$\n\n2.  **旋转标架模拟**：我们从相同的初始张量开始，$A'(0) = Q(0)A(0)Q^T(0) = A(0)$，因为 $Q(0)=I$。对于每个时间步，我们必须使用变换后的速度梯度 $L'(t_n) = Q(t_n) L Q^T(t_n) + W$。然后我们使用相同的离散更新规则，但使用变换后的输入进行前向积分，以找到 $A'_{\\text{num}}(T)$。\n    $$ A'_{\\text{num}}(t_{n+1}) = \\text{update}(A'_{\\text{num}}(t_n), L'(t_n)) $$\n\n问题指定了绕 $z$ 轴的恒定旋转速率 $\\omega$，因此 $\\theta(t) = \\omega t$。\n$$ Q(t) = \\begin{pmatrix} \\cos(\\omega t)  -\\sin(\\omega t)  0 \\\\ \\sin(\\omega t)  \\cos(\\omega t)  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad W(t) = \\dot{Q}Q^T = \\begin{pmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n注意，对于这个特定的旋转，$W$ 是一个常数。\n\n**5. 误差评估**\n\n如果数值格式是完全客观的，那么旋转模拟的结果 $A'_{\\text{num}}(T)$ 将完全等于实验室标架模拟结果的旋转，$Q(T) A_{\\text{num}}(T) Q^T(T)$。由于显式欧拉格式并非完全客观（它只有一阶精度），因此会存在差异。这种差异是由于该格式缺乏完全客观性而产生的数值误差。\n\n我们在最终时间 $T$ 使用弗罗贝尼乌斯范数计算此误差：\n$$ A'_{\\text{target}}(T) = Q(T) A_{\\text{num}}(T) Q^T(T) $$\n$$ e = \\lVert A'_{\\text{num}}(T) - A'_{\\text{target}}(T) \\rVert_F $$\n然后，归一化误差计算如下：\n$$ e_{\\text{norm}} = \\frac{e}{\\max(\\lVert A'_{\\text{target}}(T) \\rVert_F, \\varepsilon)} $$\n其中 $\\varepsilon = 10^{-15}$ 是一个小数，用于防止除以零。对于这种一阶格式，预期误差应与 $\\Delta t$ 成正比。数值实现将对每个测试用例执行此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the objectivity test problem for UCD and LCD schemes.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, upper-convected)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 2 (happy path, lower-convected)\n        {'type': 'lower', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 3 (boundary, zero rotation)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.0, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 4 (edge, zero flow)\n        {'type': 'upper', 'A0': None, 'L_val': 0.0, 'omega': 1.0, 'dt': 0.005, 'N': 200, 'A0_diag': [2.0, 1.0, 0.5]},\n        # Case 5 (large step, truncation stress-test)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.1, 'N': 10}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        error = run_case(case)\n        results.append(f\"{error:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_case(params):\n    \"\"\"\n    Runs a single objectivity test case.\n    \"\"\"\n    derivative_type = params['type']\n    omega = params['omega']\n    dt = params['dt']\n    N = params['N']\n    L_val = params.get('L_val', 0.0)\n    eps = 1e-15\n\n    # Initialize A0\n    if params.get('A0_diag') is not None:\n        A0 = np.diag(params['A0_diag'])\n    else:\n        A0 = params['A0']\n\n    # Initialize matrices\n    A_num = A0.copy()\n    A_prime_num = A0.copy()  # A'(0) = Q(0)A(0)Q(0)^T = A(0) since Q(0) = I\n\n    # Define constant tensors\n    L = np.array([[0.0, L_val, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    L_T = L.T\n    W = omega * np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n    # Time-marching loop\n    for n in range(N):\n        t_n = n * dt\n        \n        # Calculate rotated quantities at time t_n\n        c, s = np.cos(omega * t_n), np.sin(omega * t_n)\n        Q_n = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n        \n        L_prime_n = Q_n @ L @ Q_n.T + W\n        L_prime_n_T = L_prime_n.T\n\n        # Update A_num (unrotated frame)\n        if derivative_type == 'upper':\n            A_num += dt * (L @ A_num + A_num @ L_T)\n        else: # lower-convected\n            A_num -= dt * (A_num @ L + L_T @ A_num)\n\n        # Update A_prime_num (rotated frame)\n        if derivative_type == 'upper':\n            A_prime_num += dt * (L_prime_n @ A_prime_num + A_prime_num @ L_prime_n_T)\n        else: # lower-convected\n            A_prime_num -= dt * (A_prime_num @ L_prime_n + L_prime_n_T @ A_prime_num)\n\n    # Final calculations after loop\n    T = N * dt\n    \n    # Final rotation matrix Q(T)\n    c, s = np.cos(omega * T), np.sin(omega * T)\n    Q_T = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n\n    # Target transformed tensor\n    A_prime_target = Q_T @ A_num @ Q_T.T\n\n    # Error calculation\n    error_norm = np.linalg.norm(A_prime_num - A_prime_target, 'fro')\n    target_norm = np.linalg.norm(A_prime_target, 'fro')\n    \n    normalized_error = error_norm / max(target_norm, eps)\n    \n    return normalized_error\n\nsolve()\n```"
        }
    ]
}