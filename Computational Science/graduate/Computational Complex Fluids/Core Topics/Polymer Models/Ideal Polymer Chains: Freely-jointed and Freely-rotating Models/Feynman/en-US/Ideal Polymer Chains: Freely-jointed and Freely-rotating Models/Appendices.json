{
    "hands_on_practices": [
        {
            "introduction": "Understanding the macroscopic size of a polymer chain begins with a rigorous statistical treatment of its microscopic constituents. This fundamental practice guides you through deriving the mean-squared end-to-end distance, $\\langle R^2 \\rangle$, and the mean-squared radius of gyration, $\\langle R_g^2 \\rangle$, for the classic freely-jointed chain model. Mastering this derivation  is essential, as it establishes the direct connection between the statistical independence of bond vectors and the overall dimensions of the polymer coil.",
            "id": "4090276",
            "problem": "Consider a two-dimensional (2D) ideal polymer modeled as a Freely-Jointed Chain (FJC), meaning the polymer consists of $N$ statistically independent bond vectors of fixed length $b$, each with uniformly distributed orientation on the unit circle. Let the bead positions be $\\{\\mathbf{r}_k\\}_{k=0}^{N}$ with $\\mathbf{r}_0=\\mathbf{0}$ and $\\mathbf{r}_k=\\sum_{i=1}^{k}\\mathbf{t}_i$, where $\\mathbf{t}_i$ are the bond vectors. Define the end-to-end vector $\\mathbf{R}=\\mathbf{r}_N-\\mathbf{r}_0=\\sum_{i=1}^{N}\\mathbf{t}_i$. The squared radius of gyration is defined by\n$$\nR_g^2=\\frac{1}{N+1}\\sum_{k=0}^{N}\\left|\\mathbf{r}_k-\\mathbf{r}_{\\mathrm{cm}}\\right|^2, \\quad \\text{with} \\quad \\mathbf{r}_{\\mathrm{cm}}=\\frac{1}{N+1}\\sum_{k=0}^{N}\\mathbf{r}_k.\n$$\nStarting from these definitions and the statistical independence and isotropy of the bond vectors in the FJC model, derive closed-form expressions for the ensemble averages $\\langle R^2\\rangle$ and $\\langle R_g^2\\rangle$ in terms of $N$ and $b$, without assuming any shortcut relations. Then evaluate these expressions for $N=200$ and $b=1\\,\\mathrm{nm}$. Express your final numerical values in $\\mathrm{nm}^2$. Provide the results as exact rational numbers; do not round.",
            "solution": "The problem is valid. It is a standard, well-posed problem in statistical polymer physics, grounded in established scientific principles. All definitions and parameters are provided and are self-consistent.\n\nThe problem requires the derivation of the ensemble averages for the squared end-to-end distance, $\\langle R^2 \\rangle$, and the squared radius of gyration, $\\langle R_g^2 \\rangle$, for a $2$D Freely-Jointed Chain (FJC), followed by their numerical evaluation.\n\nFirst, we establish the statistical properties of the bond vectors, $\\mathbf{t}_i$, for an FJC. The bonds have a fixed length $b$, so $|\\mathbf{t}_i| = b$ for all $i \\in \\{1,...,N\\}$. They are statistically independent and isotropically oriented. This implies two key properties for their ensemble averages:\n1.  The average of any single bond vector is zero due to isotropic orientation: $\\langle \\mathbf{t}_i \\rangle = \\mathbf{0}$.\n2.  The average of the dot product of two bond vectors depends on whether they are the same vector.\n    - If $i=j$: $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_i \\rangle = \\langle |\\mathbf{t}_i|^2 \\rangle = \\langle b^2 \\rangle = b^2$.\n    - If $i \\neq j$: The vectors are statistically independent, so the average of their product is the product of their averages: $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\langle \\mathbf{t}_i \\rangle \\cdot \\langle \\mathbf{t}_j \\rangle = \\mathbf{0} \\cdot \\mathbf{0} = 0$.\nThese can be compactly written using the Kronecker delta, $\\delta_{ij}$, as $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$.\n\n**1. Derivation of the Mean-Squared End-to-End Distance, $\\langle R^2 \\rangle$**\n\nThe end-to-end vector, $\\mathbf{R}$, is defined as the sum of all bond vectors:\n$$\n\\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{t}_i\n$$\nThe squared end-to-end distance is $R^2 = \\mathbf{R} \\cdot \\mathbf{R}$. Substituting the definition of $\\mathbf{R}$:\n$$\nR^2 = \\left(\\sum_{i=1}^{N} \\mathbf{t}_i\\right) \\cdot \\left(\\sum_{j=1}^{N} \\mathbf{t}_j\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{t}_i \\cdot \\mathbf{t}_j\n$$\nTo find the ensemble average $\\langle R^2 \\rangle$, we take the average of this expression. Due to the linearity of the expectation operator, we can move the average inside the summations:\n$$\n\\langle R^2 \\rangle = \\left\\langle \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{t}_i \\cdot \\mathbf{t}_j \\right\\rangle = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle\n$$\nUsing the statistical property $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$:\n$$\n\\langle R^2 \\rangle = \\sum_{i=1}^{N} \\sum_{j=1}^{N} b^2 \\delta_{ij}\n$$\nThe Kronecker delta $\\delta_{ij}$ is only non-zero (equal to $1$) when $i=j$. The double summation thus reduces to a single summation over the diagonal terms:\n$$\n\\langle R^2 \\rangle = \\sum_{i=1}^{N} b^2 = N b^2\n$$\n\n**2. Derivation of the Mean-Squared Radius of Gyration, $\\langle R_g^2 \\rangle$**\n\nThe squared radius of gyration is defined as:\n$$\nR_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} |\\mathbf{r}_k - \\mathbf{r}_{\\mathrm{cm}}|^2\n$$\nwhere $\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{j=0}^{N} \\mathbf{r}_j$. We start by expanding the square and simplifying the expression:\n$$\nR_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} (\\mathbf{r}_k \\cdot \\mathbf{r}_k - 2\\mathbf{r}_k \\cdot \\mathbf{r}_{\\mathrm{cm}} + \\mathbf{r}_{\\mathrm{cm}} \\cdot \\mathbf{r}_{\\mathrm{cm}}) = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - 2\\mathbf{r}_{\\mathrm{cm}} \\cdot \\sum_{k=0}^{N} \\mathbf{r}_k + \\sum_{k=0}^{N} \\mathbf{r}_{\\mathrm{cm}}^2 \\right)\n$$\nUsing the definition of $\\mathbf{r}_{\\mathrm{cm}}$, we have $\\sum_{k=0}^{N} \\mathbf{r}_k = (N+1)\\mathbf{r}_{\\mathrm{cm}}$. The last sum is over $N+1$ identical terms, so $\\sum_{k=0}^{N} \\mathbf{r}_{\\mathrm{cm}}^2 = (N+1)\\mathbf{r}_{\\mathrm{cm}}^2$. Substituting these in:\n$$\nR_g^2 = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - 2\\mathbf{r}_{\\mathrm{cm}} \\cdot (N+1)\\mathbf{r}_{\\mathrm{cm}} + (N+1)\\mathbf{r}_{\\mathrm{cm}}^2 \\right) = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - (N+1)\\mathbf{r}_{\\mathrm{cm}}^2 \\right)\n$$\nThis gives the convenient form $R_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} \\mathbf{r}_k^2 - \\mathbf{r}_{\\mathrm{cm}}^2$. Taking the ensemble average, we get:\n$$\n\\langle R_g^2 \\rangle = \\frac{1}{N+1} \\sum_{k=0}^{N} \\langle \\mathbf{r}_k^2 \\rangle - \\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle\n$$\nWe compute the two terms separately.\n\nFirst term: $\\langle \\mathbf{r}_k^2 \\rangle$. The position vector $\\mathbf{r}_k = \\sum_{i=1}^{k} \\mathbf{t}_i$ (with $\\mathbf{r}_0 = \\mathbf{0}$).\n$$\n\\langle \\mathbf{r}_k^2 \\rangle = \\left\\langle \\left( \\sum_{i=1}^{k} \\mathbf{t}_i \\right) \\cdot \\left( \\sum_{j=1}^{k} \\mathbf{t}_j \\right) \\right\\rangle = \\sum_{i=1}^{k} \\sum_{j=1}^{k} \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\sum_{i=1}^{k} \\sum_{j=1}^{k} b^2 \\delta_{ij} = \\sum_{i=1}^{k} b^2 = k b^2\n$$\nNow we compute the sum over $k$:\n$$\n\\frac{1}{N+1} \\sum_{k=0}^{N} \\langle \\mathbf{r}_k^2 \\rangle = \\frac{1}{N+1} \\sum_{k=0}^{N} k b^2 = \\frac{b^2}{N+1} \\left( \\sum_{k=1}^{N} k \\right) = \\frac{b^2}{N+1} \\frac{N(N+1)}{2} = \\frac{N b^2}{2}\n$$\n\nSecond term: $\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle$. First, we express $\\mathbf{r}_{\\mathrm{cm}}$ in terms of the bond vectors $\\mathbf{t}_i$:\n$$\n\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{k=0}^{N} \\mathbf{r}_k = \\frac{1}{N+1} \\sum_{k=0}^{N} \\sum_{i=1}^{k} \\mathbf{t}_i\n$$\nWe change the order of summation. A vector $\\mathbf{t}_i$ appears in the sums for $\\mathbf{r}_k$ where $k \\ge i$. Thus, for a fixed $i$, the sum over $k$ runs from $i$ to $N$:\n$$\n\\sum_{k=0}^{N} \\sum_{i=1}^{k} \\mathbf{t}_i = \\sum_{i=1}^{N} \\sum_{k=i}^{N} \\mathbf{t}_i = \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i\n$$\nSo, $\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i$. Now we compute its mean square:\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\left\\langle \\left( \\frac{1}{N+1} \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i \\right) \\cdot \\left( \\frac{1}{N+1} \\sum_{j=1}^{N} (N-j+1) \\mathbf{t}_j \\right) \\right\\rangle\n$$\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{1}{(N+1)^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} (N-i+1)(N-j+1) \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle\n$$\nUsing $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$:\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{b^2}{(N+1)^2} \\sum_{i=1}^{N} (N-i+1)^2\n$$\nLet's evaluate the sum. Let $m = N-i+1$. As $i$ goes from $1$ to $N$, $m$ goes from $N$ to $1$.\n$$\n\\sum_{i=1}^{N} (N-i+1)^2 = \\sum_{m=1}^{N} m^2 = \\frac{N(N+1)(2N+1)}{6}\n$$\nSubstituting this back:\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{b^2}{(N+1)^2} \\frac{N(N+1)(2N+1)}{6} = \\frac{N(2N+1)}{6(N+1)} b^2\n$$\nFinally, we combine the two terms to get $\\langle R_g^2 \\rangle$:\n$$\n\\langle R_g^2 \\rangle = \\frac{N b^2}{2} - \\frac{N(2N+1)}{6(N+1)} b^2 = N b^2 \\left( \\frac{1}{2} - \\frac{2N+1}{6(N+1)} \\right)\n$$\n$$\n\\langle R_g^2 \\rangle = N b^2 \\left( \\frac{3(N+1) - (2N+1)}{6(N+1)} \\right) = N b^2 \\left( \\frac{3N+3-2N-1}{6(N+1)} \\right) = N b^2 \\left( \\frac{N+2}{6(N+1)} \\right)\n$$\nSo, the final expression is:\n$$\n\\langle R_g^2 \\rangle = \\frac{N(N+2)}{6(N+1)} b^2\n$$\n\n**3. Numerical Evaluation**\n\nWe are given $N=200$ and $b=1\\,\\mathrm{nm}$. We evaluate the derived expressions, with the final values having units of $\\mathrm{nm}^2$.\n\nFor the mean-squared end-to-end distance:\n$$\n\\langle R^2 \\rangle = N b^2 = 200 \\times (1)^2 = 200\n$$\n\nFor the mean-squared radius of gyration:\n$$\n\\langle R_g^2 \\rangle = \\frac{N(N+2)}{6(N+1)} b^2 = \\frac{200(200+2)}{6(200+1)} (1)^2 = \\frac{200 \\times 202}{6 \\times 201}\n$$\nWe simplify this rational number:\n$$\n\\langle R_g^2 \\rangle = \\frac{40400}{1206} = \\frac{20200}{603}\n$$\nTo check if the fraction can be simplified further, we find the prime factorization of the denominator: $603 = 3 \\times 201 = 3 \\times 3 \\times 67 = 3^2 \\times 67$. The numerator is $20200 = 202 \\times 100 = 2 \\times 101 \\times 10^2$. Since $20200$ is not divisible by $3$ (sum of digits is $4$) or by the prime $67$, the fraction is in its simplest form.\n\nThe final numerical values are $\\langle R^2 \\rangle = 200\\,\\mathrm{nm}^2$ and $\\langle R_g^2 \\rangle = \\frac{20200}{603}\\,\\mathrm{nm}^2$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 200  \\frac{20200}{603} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the freely-jointed chain model successfully predicts the average size of an unperturbed polymer, its real power is revealed when we study its response to external forces, a phenomenon known as entropic elasticity. This exercise  challenges you to analyze the limits of the simple Gaussian approximation, which describes small extensions, and to identify the conditions under which it breaks down near full chain extension. You will explore the non-Gaussian regime where finite extensibility becomes dominant, a crucial concept for understanding single-molecule experiments.",
            "id": "4090277",
            "problem": "Consider an ideal freely-jointed polymer chain composed of $N$ independent bonds of fixed length $b$, with uniform orientation distribution on the unit sphere. Let the end-to-end vector be $\\mathbf{R}=\\sum_{i=1}^{N}\\mathbf{r}_{i}$ and the end-to-end distance be $R=\\|\\mathbf{R}\\|$. The geometric constraint imposes a maximum end-to-end distance $R_{\\max}=Nb$. In the limit of large $N$, the Central Limit Theorem (CLT) implies that typical fluctuations of $\\mathbf{R}$ are approximately Gaussian, with zero mean and characteristic scale set by the variance of the sum of bond vectors. However, near full extension the Gaussian approximation can break down due to the hard boundary $R\\le Nb$ and the dominance of aligned configurations.\n\nDefine the dimensionless slack parameter $\\epsilon=1-R/(Nb)$, which measures proximity to full extension. Starting from first principles for the freely-jointed chain, assess the conditions under which the Gaussian approximation for the end-to-end distribution ceases to be reliable as $R\\to Nb$, and the implications for the entropic elasticity under an applied force. Specifically, use the CLT scaling for typical fluctuations and the single-bond orientational partition function under a uniaxial force to reason about the scaling of the breakdown criterion and the asymptotic form of the forceâ€“extension relation as $\\epsilon\\to 0^{+}$.\n\nWhich option correctly characterizes the breakdown near full extension and the role of $\\epsilon$?\n\nA. The Gaussian approximation is valid when the gap to full extension $\\Delta = Nb - R$ dominates typical Gaussian fluctuations, i.e., when $\\Delta \\gg b\\sqrt{N}$, which is equivalent to $\\epsilon \\gg N^{-1/2}$. Conversely, as $\\epsilon \\lesssim N^{-1/2}$, the boundary $R \\le Nb$ induces non-Gaussian behavior. In the fixed-force ensemble, the single-bond partition function implies $\\langle R \\rangle / (Nb) = L(\\beta f b)$, where $L$ is the Langevin function, and for $\\epsilon \\to 0^{+}$ one finds $f \\sim k_B T / (b \\epsilon)$, demonstrating a divergence inconsistent with Gaussian Hookean elasticity.\n\nB. The Gaussian approximation remains accurate until the deficit from full extension is of order the bond length, $\\Delta \\lesssim b$, i.e., $\\epsilon \\lesssim N^{-1}$, and the entropic force saturates at a finite value $f \\approx 3k_B T / b$ near full extension.\n\nC. The breakdown of the Gaussian approximation occurs only when $\\epsilon \\gtrsim 1$, which corresponds to small extensions, and in that regime the force scales linearly with $\\epsilon$.\n\nD. The correct dimensionless parameter controlling the breakdown is $\\delta = R/(b\\sqrt{N})$, not $\\epsilon$, with Gaussian failure when $\\delta \\lesssim 1$; near full extension the entropic force scales as $f \\sim k_B T \\delta$.\n\nE. For a freely-rotating chain with fixed bond angle, the maximum end-to-end distance is reduced below $N b$, so the appropriate parameter is $\\epsilon = 1 - R/(Nb\\cos\\theta)$; in this case the Gaussian approximation fails only when $\\epsilon \\lesssim N^{-2}$, and the force near full extension remains finite.",
            "solution": "The problem statement will first be validated for scientific soundness, self-consistency, and clarity before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Model:** Ideal freely-jointed polymer chain (FJC).\n- **Number of Bonds:** $N$.\n- **Bond Length:** A fixed length $b$.\n- **Bond Orientation:** Uniform distribution on the unit sphere (implying $\\langle \\mathbf{r}_i \\rangle = \\mathbf{0}$ and $\\langle \\mathbf{r}_i \\cdot \\mathbf{r}_j \\rangle = b^2 \\delta_{ij}$).\n- **End-to-End Vector:** $\\mathbf{R}=\\sum_{i=1}^{N}\\mathbf{r}_{i}$.\n- **End-to-End Distance:** $R=\\lVert \\mathbf{R}\\rVert$.\n- **Maximum Extension:** $R_{\\max}=N b$.\n- **Limit:** Large $N$.\n- **Approximation:** Central Limit Theorem (CLT) implies an approximately Gaussian distribution for $\\mathbf{R}$ for typical extensions.\n- **Definition:** Slack parameter $\\epsilon=1-R/(N b)$.\n- **Task:** Assess the conditions for the breakdown of the Gaussian approximation as $R\\to N b$ ($\\epsilon \\to 0^{+}$) and determine the asymptotic form of the force-extension relation in this limit.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the freely-jointed chain model, a canonical and fundamental model in statistical polymer physics. The concepts of the central limit theorem leading to a Gaussian chain approximation, entropic elasticity, and the breakdown of this approximation near full extension are all standard, well-established principles. The framework is entirely sound.\n2.  **Well-Posed:** The problem is well-posed. It asks for a quantitative scaling criterion for the breakdown of a specific approximation and the resulting asymptotic behavior of a physical quantity (force). This has a unique and derivable answer from the first principles of statistical mechanics as applied to the FJC model.\n3.  **Objective:** The problem is stated in precise, objective, and quantitative terms. All parameters are clearly defined.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a standard, well-posed problem in polymer physics. I will now proceed to derive the solution.\n\n### Derivation from First Principles\n\n**1. The Gaussian Approximation and its Characteristic Scale**\nFor a freely-jointed chain, the bond vectors $\\mathbf{r}_i$ are independent random variables with mean $\\langle \\mathbf{r}_i \\rangle = \\mathbf{0}$ and mean-square length $\\langle r_i^2 \\rangle = b^2$. The mean-square end-to-end distance is:\n$$ \\langle R^2 \\rangle = \\langle \\left( \\sum_{i=1}^{N} \\mathbf{r}_i \\right) \\cdot \\left( \\sum_{j=1}^{N} \\mathbf{r}_j \\right) \\rangle = \\sum_{i,j=1}^{N} \\langle \\mathbf{r}_i \\cdot \\mathbf{r}_j \\rangle $$\nDue to the independence of bond orientations, $\\langle \\mathbf{r}_i \\cdot \\mathbf{r}_j \\rangle = \\delta_{ij} \\langle r_i^2 \\rangle = \\delta_{ij} b^2$. Thus,\n$$ \\langle R^2 \\rangle = \\sum_{i=1}^{N} b^2 = N b^2 $$\nThe root-mean-square (RMS) end-to-end distance, which characterizes the typical size of the polymer coil and its fluctuations, is $R_0 = \\sqrt{\\langle R^2 \\rangle} = b \\sqrt{N}$.\n\nFor large $N$, the Central Limit Theorem states that the probability distribution of the sum $\\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{r}_i$ approaches a Gaussian distribution:\n$$ P(\\mathbf{R})d^3\\mathbf{R} = \\left(\\frac{3}{2 \\pi N b^2}\\right)^{3/2} \\exp\\left(-\\frac{3R^2}{2Nb^2}\\right) d^3\\mathbf{R} $$\nThis Gaussian model underlies Hookean elasticity in polymers.\n\n**2. Breakdown of the Gaussian Approximation**\nThe Gaussian distribution has support for all $R \\in [0, \\infty)$, whereas the physical chain is constrained by $R \\le R_{\\max} = Nb$. This approximation is only valid when the chain is far from this physical boundary. The approximation breaks down when the extension $R$ becomes so large that the finite extensibility of the chain can no longer be ignored.\n\nA rigorous criterion for the breakdown can be established by comparing the \"slack\" or \"gap\" to full extension with the characteristic scale of fluctuations.\n- The gap to full extension is $\\Delta = R_{\\max} - R = N b - R$.\n- The characteristic scale of fluctuations of the chain is its RMS size, $R_0 = b\\sqrt{N}$.\n\nThe Gaussian approximation is reliable as long as the chain is far from the boundary, meaning the gap is much larger than the typical fluctuation size:\n$$ \\Delta \\gg b\\sqrt{N} $$\nConversely, the approximation breaks down when the gap becomes comparable to or smaller than the fluctuation scale:\n$$ \\Delta \\lesssim b\\sqrt{N} $$\nWe can express this condition using the dimensionless slack parameter $\\epsilon = 1 - R/(Nb) = (Nb - R)/(Nb) = \\Delta/(Nb)$. Substituting $\\Delta = N b \\epsilon$ into the breakdown condition:\n$$ N b \\epsilon \\lesssim b\\sqrt{N} \\implies \\epsilon \\lesssim \\frac{b\\sqrt{N}}{N b} = \\frac{1}{\\sqrt{N}} = N^{-1/2} $$\nTherefore, the Gaussian approximation fails when $\\epsilon \\lesssim N^{-1/2}$.\n\n**3. Force-Extension Relation in the Non-Gaussian Regime**\nTo find the exact force-extension behavior, we analyze the chain in the constant-force (isothermal-isobaric-like) ensemble. Under an external force $f$ aligned with the z-axis, the energy of a single bond is $U_i = -\\mathbf{f} \\cdot \\mathbf{r}_i = -f b \\cos\\theta_i$. The partition function for a single bond orientation is:\n$$ z_1 = \\int e^{-\\beta U_i} d\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta e^{\\beta f b \\cos\\theta} d\\theta = 4\\pi \\frac{\\sinh(\\beta f b)}{\\beta f b} $$\nwhere $\\beta = 1/(k_B T)$. The average extension of one bond along the force is $\\langle r_z \\rangle = \\frac{1}{\\beta} \\frac{\\partial \\ln z_1}{\\partial f}$.\n$$ \\langle r_z \\rangle = b \\left( \\coth(\\beta f b) - \\frac{1}{\\beta f b} \\right) = b \\, L(\\beta f b) $$\nwhere $L(x) = \\coth(x) - 1/x$ is the Langevin function.\nFor $N$ independent bonds, the total mean extension is $\\langle R \\rangle = N \\langle r_z \\rangle = N b L(\\beta f b)$. We identify the observable extension $R$ with its average value $\\langle R \\rangle$.\nThe force-extension relation is thus given by:\n$$ \\frac{R}{Nb} = L(\\beta f b) $$\nUsing the slack parameter, $\\epsilon=1-R/(Nb)$, we have:\n$$ 1 - \\epsilon = L(\\beta f b) $$\nWe are interested in the limit of full extension, where $R \\to Nb$, which means $\\epsilon \\to 0^{+}$. This requires the argument of the Langevin function to be large, i.e., $\\alpha \\equiv \\beta f b \\to \\infty$.\nThe asymptotic expansion of the Langevin function for large $\\alpha$ is $L(\\alpha) \\approx 1 - 1/\\alpha$.\nSubstituting this into the force-extension relation:\n$$ 1 - \\epsilon \\approx 1 - \\frac{1}{\\alpha} \\implies \\epsilon \\approx \\frac{1}{\\alpha} = \\frac{1}{\\beta f b} = \\frac{k_B T}{f b} $$\nSolving for the force $f$ gives the asymptotic behavior near full extension:\n$$ f \\approx \\frac{k_B T}{b \\epsilon} $$\nThis demonstrates that the force diverges as $\\epsilon \\to 0^{+}$, a characteristic of non-Gaussian elasticity due to finite extensibility. This is in stark contrast to the Gaussian (Hookean) model, where $f = \\frac{3k_B T}{Nb^2}R$, which predicts a finite force $f_{R=Nb} = \\frac{3k_B T}{b}$.\n\n### Option-by-Option Analysis\n\n**A. The Gaussian approximation is valid when the gap to full extension $\\Delta = Nb - R$ dominates typical Gaussian fluctuations, i.e., when $\\Delta \\gg b\\sqrt{N}$, which is equivalent to $\\epsilon \\gg N^{-1/2}$. Conversely, as $\\epsilon \\lesssim N^{-1/2}$, the boundary $R \\le Nb$ induces non-Gaussian behavior. In the fixed-force ensemble, the single-bond partition function implies $\\langle R \\rangle / (Nb) = L(\\beta f b)$, where $L$ is the Langevin function, and for $\\epsilon \\to 0^{+}$ one finds $f \\sim k_B T / (b \\epsilon)$, demonstrating a divergence inconsistent with Gaussian Hookean elasticity.**\nThis option correctly identifies the breakdown criterion by comparing the gap $\\Delta$ to the fluctuation scale $b\\sqrt{N}$. The translation to the slack parameter $\\epsilon \\lesssim N^{-1/2}$ is correct. It correctly states the exact force-extension relation involving the Langevin function $L(\\beta f b)$. Finally, it correctly derives the asymptotic force law $f \\sim k_B T / (b\\epsilon)$ in the limit $\\epsilon \\to 0^{+}$ and notes its inconsistency with the Gaussian model. All parts of this statement are consistent with the derivation from first principles.\n**Verdict: Correct.**\n\n**B. The Gaussian approximation remains accurate until the deficit from full extension is of order the bond length, $\\Delta \\lesssim b$, i.e., $\\epsilon \\lesssim N^{-1}$, and the entropic force saturates at a finite value $f \\approx 3k_B T / b$ near full extension.**\nThis option incorrectly identifies the relevant length scale for breakdown. The breakdown is governed by the collective fluctuation scale $b\\sqrt{N}$, not the individual bond length $b$. This leads to the incorrect scaling $\\epsilon\\lesssim N^{-1}$. It also incorrectly claims the force saturates; the force actually diverges. The value $f\\approx 3k_B T / b$ is the (incorrect) prediction of the Gaussian model at maximum extension, not the correct asymptotic behavior.\n**Verdict: Incorrect.**\n\n**C. The breakdown of the Gaussian approximation occurs only when $\\epsilon \\gtrsim 1$, which corresponds to small extensions, and in that regime the force scales linearly with $\\epsilon$.**\nThis option misinterprets the regimes. The Gaussian approximation is valid for small extensions ($R \\ll Nb$), which corresponds to $\\epsilon \\approx 1$. Breakdown occurs for large extensions, i.e., $\\epsilon \\to 0$. The statement that breakdown occurs for $\\epsilon \\gtrsim 1$ is physically impossible as $\\epsilon \\le 1$. The force in the Gaussian regime scales linearly with $R$, not $\\epsilon$.\n**Verdict: Incorrect.**\n\n**D. The correct dimensionless parameter controlling the breakdown is $\\delta = R/(b\\sqrt{N})$, not $\\epsilon$, with Gaussian failure when $\\delta \\lesssim 1$; near full extension the entropic force scales as $f \\sim k_B T \\delta$.**\nThe parameter $\\delta = R / (b\\sqrt{N})$ measures the extension relative to the random coil size. The Gaussian regime corresponds to $\\delta \\sim O(1)$. Failure of the Gaussian model occurs for large extensions, $R \\to Nb$, where $\\delta \\to \\sqrt{N} \\gg 1$. The statement that failure occurs for $\\delta \\lesssim 1$ is incorrect. Furthermore, the force near full extension diverges as $1/\\epsilon$, not as $\\delta$ (which would approach a large but finite value $\\sqrt{N}$).\n**Verdict: Incorrect.**\n\n**E. For a freely-rotating chain with fixed bond angle, the maximum end-to-end distance is reduced below $N b$, so the appropriate parameter is $\\epsilon = 1 - R/(Nb\\cos\\theta)$; in this case the Gaussian approximation fails only when $\\epsilon \\lesssim N^{-2}$, and the force near full extension remains finite.**\nThis option introduces an irrelevant model (freely-rotating chain), which was not specified in the problem statement. The expression for the maximum extension is not generally correct. The scaling for breakdown, $\\epsilon\\lesssim N^{-2}$, is incorrect; for any flexible chain, the generic scaling argument leads to a power of $N^{-1/2}$. Most critically, it makes the physically false claim that the force remains finite at full extension. For any model with a finite contour length, an infinite force is required to achieve full extension.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating theoretical models into predictive tools is a core skill in computational physics. Building on the concept of non-Gaussian elasticity, this practice  involves developing a robust numerical procedure to invert the Langevin force-extension relationship. By implementing a stable root-finding algorithm, you will be able to determine the tension on a polymer chain from its observed extension, a task central to interpreting data from atomic force microscopy and optical tweezer experiments.",
            "id": "4090284",
            "problem": "You are studying the ideal freely-jointed chain model for polymer elasticity in the context of computational complex fluids. Consider an ideal polymer consisting of $N$ independent segments of fixed length $b$ at absolute temperature $T$, subject to a constant force $f$ applied along the $z$-axis. The system is modeled in the canonical ensemble with inverse thermal energy $\\beta = 1/(k_{\\mathrm{B}} T)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. The equilibrium average end-to-end projection along the pulling axis, denoted $\\langle z \\rangle$, is related to $f$ through a dimensionless equation involving a monotone function of the reduced force $x = \\beta f b$. Your task is to construct a robust numerical procedure to invert this relationship and estimate $f$ from observed $\\langle z \\rangle$ and known parameters $N$, $b$, and $T$.\n\nRequirements:\n- Start from fundamental statistical mechanics definitions for the canonical ensemble and the orientation distribution of a segment under a uniform external field, and use well-tested results for the ideal freely-jointed chain, including the definition of the Langevin function $\\mathcal{L}(x)$, where $x = \\beta f b$ and\n  $$\\mathcal{L}(x) = \\coth(x) - \\frac{1}{x}.$$\n- Use the reduced extension defined by\n  $$\\rho = \\frac{\\langle z \\rangle}{N b},$$\n  and solve for the unique $x \\ge 0$ satisfying\n  $$\\mathcal{L}(x) = \\rho,$$\n  for $0 \\le \\rho  1$.\n- Numerically invert the Langevin function using a bracketing root-finding method with a provable bracket for the root. Your numerical procedure must:\n  - Handle the small-$x$ regime using a series expansion of $\\mathcal{L}(x)$ to avoid loss of significance when $x$ is near $0$.\n  - Use stable evaluation of hyperbolic functions for large $x$.\n  - Guarantee convergence for all inputs with $0 \\le \\rho  1$.\n- Compute the force using\n  $$f = \\frac{x}{\\beta b} = \\frac{k_{\\mathrm{B}} T}{b} x,$$\n  and report $f$ in Newtons, without unit labels in the output.\n\nConstants and units:\n- Use the International System of Units (SI). Take the Boltzmann constant as $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$.\n- All lengths must be in meters, force in Newtons, and temperature in Kelvin. Angles are dimensionless in the definition of hyperbolic functions; do not convert them.\n\nTest suite:\nImplement your program to evaluate the following five test cases. Each test case is a tuple $(N, b, T, \\langle z \\rangle)$:\n- Case $1$: $(N, b, T, \\langle z \\rangle) = \\left(100,\\ 1.0\\times 10^{-9}\\ \\mathrm{m},\\ 300\\ \\mathrm{K},\\ 10.0\\times 10^{-9}\\ \\mathrm{m}\\right)$.\n- Case $2$: $(N, b, T, \\langle z \\rangle) = \\left(200,\\ 0.5\\times 10^{-9}\\ \\mathrm{m},\\ 300\\ \\mathrm{K},\\ 0.0\\times 10^{0}\\ \\mathrm{m}\\right)$.\n- Case $3$: $(N, b, T, \\langle z \\rangle) = \\left(50,\\ 1.5\\times 10^{-9}\\ \\mathrm{m},\\ 310\\ \\mathrm{K},\\ 0.75\\times 10^{-9}\\ \\mathrm{m}\\right)$.\n- Case $4$: $(N, b, T, \\langle z \\rangle) = \\left(1000,\\ 0.7\\times 10^{-9}\\ \\mathrm{m},\\ 298\\ \\mathrm{K},\\ 6.65\\times 10^{-7}\\ \\mathrm{m}\\right)$.\n- Case $5$: $(N, b, T, \\langle z \\rangle) = \\left(120,\\ 1.2\\times 10^{-9}\\ \\mathrm{m},\\ 350\\ \\mathrm{K},\\ 72.0\\times 10^{-9}\\ \\mathrm{m}\\right)$.\n\nOutput specification:\n- For each test case, compute the estimated force $f$ in Newtons as a floating-point number.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each number in scientific notation with exactly six significant digits, for example\n  $$[\\text{f1},\\text{f2},\\text{f3},\\text{f4},\\text{f5}]$$\n  where each $\\text{f}i$ is a decimal number in Newtons and no unit strings are included in the output.",
            "solution": "The problem requires the determination of the tensile force $f$ applied to an ideal freely-jointed polymer chain, given its average end-to-end projection $\\langle z \\rangle$. The chain consists of $N$ segments, each of length $b$, at a constant absolute temperature $T$. This task involves numerically inverting the force-extension relationship derived from statistical mechanics.\n\nFirst, we establish the theoretical foundation. In the canonical ensemble, the probability of a single polymer segment having a specific orientation, described by the solid angle $d\\Omega$, is proportional to its Boltzmann factor, $e^{-\\beta E}$, where $\\beta = 1/(k_{\\mathrm{B}} T)$ is the inverse thermal energy and $E$ is the potential energy of the segment in the external force field. The force $f$ is applied along the $z$-axis, so the energy of a segment oriented at an angle $\\theta$ to this axis is $E = -f b \\cos\\theta$.\n\nThe canonical partition function $Z_1$ for a single segment is obtained by integrating the Boltzmann factor over all possible orientations:\n$$Z_1 = \\int e^{-\\beta E} d\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\sin\\theta \\, e^{\\beta f b \\cos\\theta}$$\nLet $x = \\beta f b$ be the dimensionless reduced force. The integral becomes:\n$$Z_1 = 2\\pi \\int_0^\\pi \\sin\\theta \\, e^{x \\cos\\theta} d\\theta$$\nUsing the substitution $u = \\cos\\theta$, $du = -\\sin\\theta d\\theta$:\n$$Z_1 = 2\\pi \\int_{-1}^1 e^{xu} du = 2\\pi \\left[ \\frac{e^{xu}}{x} \\right]_{-1}^1 = 2\\pi \\frac{e^x - e^{-x}}{x} = 4\\pi \\frac{\\sinh(x)}{x}$$\nThe average projection of a single segment along the force axis, $\\langle z_1 \\rangle$, is given by the thermodynamic relation:\n$$\\langle z_1 \\rangle = \\frac{1}{\\beta} \\frac{\\partial \\ln Z_1}{\\partial f} = k_{\\mathrm{B}} T \\frac{\\partial}{\\partial f} \\ln\\left(4\\pi \\frac{\\sinh(\\beta f b)}{\\beta f b}\\right)$$\nSince $\\frac{\\partial}{\\partial f} = \\beta b \\frac{\\partial}{\\partial x}$, we have:\n$$\\langle z_1 \\rangle = k_{\\mathrm{B}} T (\\beta b) \\frac{\\partial}{\\partial x} (\\ln(\\sinh(x)) - \\ln(x)) = b \\left(\\frac{\\cosh(x)}{\\sinh(x)} - \\frac{1}{x}\\right) = b \\left(\\coth(x) - \\frac{1}{x}\\right)$$\nThe term in the parenthesis is the Langevin function, $\\mathcal{L}(x)$. Thus, $\\langle z_1 \\rangle = b \\mathcal{L}(x)$.\n\nFor an ideal freely-jointed chain, the $N$ segments are independent. The total average end-to-end projection is the sum of the individual average projections:\n$$\\langle z \\rangle = \\sum_{i=1}^N \\langle z_i \\rangle = N \\langle z_1 \\rangle = N b \\mathcal{L}(x)$$\nThe problem defines the reduced extension as $\\rho = \\frac{\\langle z \\rangle}{N b}$. Substituting this into the equation above yields the core relationship to be solved:\n$$\\rho = \\mathcal{L}(x)$$\nOur objective is to find the value of $x \\ge 0$ that satisfies this equation for a given $\\rho \\in [0, 1)$, and from $x$ compute the force $f = x / (\\beta b) = \\frac{k_{\\mathrm{B}} T}{b} x$.\n\nThe Langevin function $\\mathcal{L}(x)$ has the following properties:\n1.  $\\lim_{x\\to 0^+} \\mathcal{L}(x) = 0$.\n2.  $\\lim_{x\\to \\infty} \\mathcal{L}(x) = 1$.\n3.  The derivative, $\\mathcal{L}'(x) = \\frac{1}{x^2} - \\text{csch}^2(x)$, is strictly positive for $x  0$.\nThese properties ensure that $\\mathcal{L}(x)$ is a strictly monotonic increasing function from $0$ to $1$ on the domain $x \\in [0, \\infty)$. Consequently, for any given value of $\\rho \\in [0, 1)$, there exists a unique non-negative solution $x = \\mathcal{L}^{-1}(\\rho)$.\n\nThe numerical procedure to find $x$ must be robust. We define a function $g(x) = \\mathcal{L}(x) - \\rho$ and seek its root. A bracketing root-finding method, such as Brent's method, is ideal as it guarantees convergence if a valid bracket $[a, b]$ (where $g(a)$ and $g(b)$ have opposite signs) is found.\n\nThe algorithm proceeds as follows:\n1.  For each test case $(N, b, T, \\langle z \\rangle)$, calculate the reduced extension $\\rho = \\frac{\\langle z \\rangle}{N b}$. The problem constraints ensure $0 \\le \\rho  1$.\n2.  If $\\rho=0$, the solution is trivially $x=0$, which implies $f=0$.\n3.  If $\\rho  0$, we find a root for $g(x) = \\mathcal{L}(x) - \\rho = 0$.\n    a.  **Find a bracket $[a, b]$**: We need $a$ and $b$ such that $g(a)g(b)  0$. We can choose $a=0$, for which $g(0) = \\mathcal{L}(0) - \\rho = -\\rho  0$. To find an upper bound $b$ such that $g(b)  0$, we start with an initial guess (e.g., $b=1$) and iteratively double it ($b \\leftarrow 2b$) until the condition $\\mathcal{L}(b)  \\rho$ is met. This search is guaranteed to terminate because $\\lim_{x\\to\\infty}\\mathcal{L}(x)=1$.\n    b.  **Solve for $x$**: With the guaranteed bracket $[a, b]$, a standard numerical solver like `scipy.optimize.brentq` is used to find the unique root $x$ with high precision.\n\nA critical aspect is the numerical implementation of $\\mathcal{L}(x)$ itself.\n-   **Small-$x$ regime**: For small $x$, $\\coth(x) \\approx 1/x$, leading to catastrophic cancellation in $\\coth(x) - 1/x$. To avoid this, we use the Taylor series expansion of $\\mathcal{L}(x)$ for $|x|$ below a certain threshold (e.g., $10^{-5}$):\n    $$\\mathcal{L}(x) = \\frac{x}{3} - \\frac{x^3}{45} + \\frac{2x^5}{945} - \\dots$$\n-   **Large-$x$ regime**: For large $x$, $e^x$ can cause overflow. The function $\\coth(x) = \\frac{e^x + e^{-x}}{e^x - e^{-x}}$ can be rewritten as $\\frac{1 + e^{-2x}}{1 - e^{-2x}}$, which is numerically stable. Alternatively, using `1.0 / numpy.tanh(x)` is also stable, as `tanh(x)` approaches $1$ without overflow for large $x$.\n\n4.  Finally, after obtaining the dimensionless root $x$, the force $f$ is computed in SI units (Newtons) using the formula:\n    $$f = \\frac{k_{\\mathrm{B}} T}{b} x$$\nwhere $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$.\n\nThis methodology provides a complete, robust, and scientifically grounded procedure for solving the stated problem. The implementation will follow these steps for each of the provided test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the force on a freely-jointed chain given its extension.\n    \"\"\"\n\n    # Use the specified value for the Boltzmann constant.\n    KB = 1.380649e-23  # J/K\n\n    def langevin_function(x):\n        \"\"\"\n        Computes the Langevin function L(x) = coth(x) - 1/x.\n\n        This implementation is designed to be numerically stable across the\n        full range of x = 0.\n        \"\"\"\n        # Handle the trivial case x=0.\n        if x == 0.0:\n            return 0.0\n\n        # For small x, use the Taylor series expansion to avoid catastrophic\n        # cancellation between coth(x) and 1/x.\n        if abs(x)  1e-5:\n            x2 = x * x\n            # Series: x/3 - x^3/45 + 2x^5/945 - ...\n            return x / 3.0 - x * x2 / 45.0 + 2.0 * x * x2 * x2 / 945.0\n        \n        # For larger x, the standard definition is used.\n        # numpy.tanh is numerically stable for a wide range of inputs.\n        # 1/tanh(x) is a stable way to compute coth(x).\n        return 1.0 / np.tanh(x) - 1.0 / x\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, b, T, z)\n        (100, 1.0e-9, 300, 10.0e-9),\n        (200, 0.5e-9, 300, 0.0),\n        (50, 1.5e-9, 310, 0.75e-9),\n        (1000, 0.7e-9, 298, 6.65e-7),\n        (120, 1.2e-9, 350, 72.0e-9),\n    ]\n\n    results = []\n    for N, b, T, z_avg in test_cases:\n        # Calculate the maximum contour length of the polymer.\n        L_max = N * b\n\n        # Calculate the reduced extension rho.\n        # If L_max is zero, rho is zero.\n        rho = z_avg / L_max if L_max  0 else 0.0\n\n        # Based on the properties of the Langevin function L(x),\n        # L(x) = rho implies x = 0 if and only if rho = 0.\n        if rho == 0.0:\n            x = 0.0\n        else:\n            # We need to find the root of the function g(x) = L(x) - rho.\n            func_to_solve = lambda val: langevin_function(val) - rho\n\n            # Establish a provable bracket [a, b] for the root-finding algorithm.\n            # The lower bound 'a' can be 0, as g(0) = L(0) - rho = -rho  0.\n            a = 0.0\n\n            # The upper bound 'b' must satisfy g(b)  0, i.e., L(b)  rho.\n            # We start with b=1.0 and double it until L(b) surpasses rho.\n            # This is guaranteed to terminate because L(x) - 1 as x - infinity.\n            b = 1.0\n            # Safety break for very large rho where L(b) can be numerically indistinguishable from 1.0\n            max_iter_bracket = 30\n            iter_count = 0\n            while langevin_function(b) = rho and iter_count  max_iter_bracket:\n                b *= 2.0\n                iter_count += 1\n            if iter_count = max_iter_bracket: # Fallback for rho very close to 1\n                 b = 2.0 / (1.0 - rho)\n\n            # Use Brent's method, a robust bracketing root-finder.\n            x = brentq(func_to_solve, a, b, xtol=1e-15, rtol=1e-15)\n\n        # Calculate the force in Newtons using the determined value of x.\n        force = (KB * T / b) * x\n        \n        # Format the result to scientific notation with 6 significant digits.\n        # The format '{:.5e}' gives 1 digit before and 5 after the decimal point.\n        results.append(f\"{force:.5e}\")\n\n    # Print the final results in the specified single-line format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}