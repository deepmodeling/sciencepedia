## 引言
在[计算流体动力学](@entry_id:142614)（CFD）领域，精确模拟不可压缩流动是众多科学与工程应用的基础。然而，这类流动在数学和数值上存在一个核心挑战：压力与速度场的耦合问题。与[可压缩流](@entry_id:747589)不同，[不可压缩流](@entry_id:140301)的控制方程组中没有为压力提供一个独立的[演化方程](@entry_id:268137)，压力更像一个瞬时作用的约束实施者，确保流体运动满足质量守恒。这使得直接求解变得异常困难，催生了一系列精巧的数值算法。本文旨在深入剖析解决这一难题的两种基石级算法：SIMPLE（半隐式压力耦合方程方法）与PISO（[算子分裂](@entry_id:634210)压力[隐式方法](@entry_id:138537)）。通过本文的学习，读者将全面掌握从基本原理到前沿应用的完整知识体系。在“原理与机制”一章中，我们将揭示[压力-速度耦合](@entry_id:155962)的本质，并详细拆解SIMPLE和[PISO算法](@entry_id:155035)的每一个步骤。随后，“应用与跨学科联系”一章将展示这些算法如何扩展至[湍流](@entry_id:151300)、传热、[多相流](@entry_id:146480)乃至燃烧等复杂物理场景。最后，“动手实践”部分提供了具体的计算练习，以加深理论理解。现在，让我们从[压力-速度耦合](@entry_id:155962)的根本挑战开始，深入探索其背后的原理与机制。

## 原理与机制

在不可压缩流动的[计算模拟](@entry_id:146373)中，核心挑战之一在于如何处理压力与速度场之间的耦合关系。与[可压缩流](@entry_id:747589)动不同，[不可压缩流](@entry_id:140301)动的控制方程组中没有一个直接给出压力的独立方程。本章将深入探讨[压力-速度耦合](@entry_id:155962)的根本问题，并系统地阐述两种经典求解算法——SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）和 PISO（Pressure-Implicit with Splitting of Operators）的原理、机制及其在计算实践中的关键考量。

### [不可压缩流](@entry_id:140301)动的核心挑战：[压力-速度耦合](@entry_id:155962)

对于一个密度恒定的不可压缩流体，其[质量守恒](@entry_id:204015)方程简化为一个对速度场 $\mathbf{u}$ 的运动学约束：

$$
\nabla \cdot \mathbf{u} = 0
$$

这个方程被称为散度自由（divergence-free）约束或连续性方程。它表明，在任何时刻，流入任一微元体的净质量通量必须为零。然而，此方程并不像可压缩流中的[质量守恒](@entry_id:204015)方程那样，提供一个关于某个[热力学状态变量](@entry_id:151686)（如密度）的预估方程。方程组中唯一的[演化方程](@entry_id:268137)是[动量守恒](@entry_id:149964)方程：

$$
\rho \frac{D \mathbf{u}}{D t} = -\nabla p + \nabla \cdot \boldsymbol{\tau} + \rho \mathbf{f}
$$

其中 $\rho$ 是密度，$p$ 是压力，$\boldsymbol{\tau}$ 是[偏应力张量](@entry_id:267642)，$\mathbf{f}$ 是单位质量体积力。方程中同时出现了两个未知量：速度 $\mathbf{u}$ 和压力 $p$。我们有速度的动量方程，却没有压力的独立方程。那么，压力是如何确定的呢？

在不可压缩流动的数学框架中，压力 $p$ 扮演着一个**[拉格朗日乘子](@entry_id:142696)**的角色，其物理意义在于，它的[梯度场](@entry_id:264143) $\nabla p$ 会在流场中瞬时地自我调整，以确保速度场始终满足散度自由约束 $\nabla \cdot \mathbf{u} = 0$ 。这种[作用机制](@entry_id:914043)与[可压缩流](@entry_id:747589)形成了鲜明对比。在[可压缩流](@entry_id:747589)中，压力是一个[热力学状态变量](@entry_id:151686)，通过[状态方程](@entry_id:274378)（如[理想气体定律](@entry_id:146757) $p = \rho R T$）与密度和温度直接关联。因此，可压缩流中的压力绝对值具有明确的[热力学](@entry_id:172368)意义，不能任意改变。但在[不可压缩流](@entry_id:140301)中，由于压力仅通过其梯度影响流动，其绝对值在没有指定绝对[压力边界条件](@entry_id:753712)的情况下是任意的，可以相差一个任意常数 。

为了从数学上揭示压力的角色，我们可以对动量方程两边取散度。考虑到 $\nabla \cdot (\frac{\partial \mathbf{u}}{\partial t}) = \frac{\partial}{\partial t}(\nabla \cdot \mathbf{u})$，并且由于连续性约束在所有时间都成立，该项为零。于是，我们得到一个关于压力的**泊松方程**：

$$
\nabla^2 p = \nabla \cdot (\nabla \cdot \boldsymbol{\tau} + \rho \mathbf{f} - \rho (\mathbf{u} \cdot \nabla)\mathbf{u})
$$

这是一个椭圆型[偏微分](@entry_id:194612)方程。椭圆型方程的解在一个点的值取决于整个求解域的边界和内部源项，这意味着压力的影响是全局性和瞬时性的（以无限快的速度传播），这恰恰印证了它作为全局约束实施者的角色 。[数值算法](@entry_id:752770)如 SIMPLE 和 PISO 的核心任务，就是有效地求解这个耦合系统。

### 离散化与数值挑战

在采用[有限体积法](@entry_id:141374)（Finite Volume Method, FVM）进行离散化时，动量方程在每个控制体（或称网格单元）$P$ 上积分，经过线性和时间离散化处理后，通常可以写成如下的代数形式：

$$
a_P \mathbf{u}_P = \sum_{N \in \mathcal{N}(P)} a_N \mathbf{u}_N + \mathbf{H}_P - V_P (\nabla p)_P
$$

这里，$\mathbf{u}_P$ 是单元 $P$ 中心的速度，$\mathbf{u}_N$ 是相邻单元的速度。系数 $a_P$ 和 $a_N$ 的定义至关重要 ：
*   **对[角系数](@entry_id:149598) $a_P$**：汇集了所有对 $\mathbf{u}_P$ 的隐式贡献，主要包括非[稳态](@entry_id:139253)项（如 $\frac{\rho V_P}{\Delta t}$）、从控制体流出的对流项（如通过上风格式处理的 $\sum_f \max(\dot{m}_f, 0)$）以及扩散项（来自于对[偏应力张量](@entry_id:267642)散度 $\nabla \cdot \boldsymbol{\tau}$ 的离散）。
*   **邻居系数 $a_N$**：代表了相邻单元 $N$ 对单元 $P$ 的影响，主要包括流入的对流项（如 $\max(-\dot{m}_f, 0)$）和扩散项。对于[非牛顿流体](@entry_id:154737)，这些系数中还隐式包含了与剪切率相关的粘度 $\eta(|\mathbf{D}|)$。
*   **源项 $\mathbf{H}_P$**：集合了所有显式项，如上一时间步的贡献、体积力 $\rho \mathbf{g}$，以及高阶格式或[非线性](@entry_id:637147)项的延迟修正部分。压力梯度项则被特意分开处理。

这个离散动量方程明确地将单元速度 $\mathbf{u}_P$ 与其自身的压力梯度 $(\nabla p)_P$ 以及邻近单元的速度 $\mathbf{u}_N$ 联系起来。然而，一个严重的数值挑战随之而来，特别是在**同位网格（collocated grid）**上，即压力和速度分量都存储在网格单元中心。

#### [棋盘格压力](@entry_id:164851)问题

如果在[同位网格](@entry_id:1122659)上采用简单的中心差分格式来计算压力梯度和速度插值，会导致压力和速度场的**[解耦](@entry_id:160890)（decoupling）**。具体来说，考虑一个一维[同位网格](@entry_id:1122659)，单元 $i$ 的压力梯度若用中心差分表示为 $(\frac{\partial p}{\partial x})_i = \frac{p_{i+1} - p_{i-1}}{2\Delta x}$，而网格面上的速度由相邻单元中心速度[线性插值](@entry_id:137092)得到，即 $u_{i+1/2} = \frac{u_i + u_{i+1}}{2}$。

在这种格式下，一个高频振荡的、非物理的“**棋盘格**”（checkerboard）压[力场](@entry_id:147325)，如 $p_i = p^\star + (-1)^i \varepsilon$，在其作用下的离散压力梯度在每个单元中心都近似为零 。这将导致[动量方程](@entry_id:197225)无法“感知”到这个压[力场](@entry_id:147325)，从而计算出错误的速度场（例如，静止流场 $u=0$）。同时，这个错误的速度场代入连续性方程后，离散散度也恰好为零。因此，这样一个包含虚假压力振荡的解能够同时满足离散的动量和连续性方程，使得算法无法收敛到物理真实解 。

历史上，**交错网格（staggered grid）**通过将速度分量存储在单元表面，而压力存储在单元中心，从根本上解决了这个问题，因为它天然地将面上的速度与相邻单元的压力差紧密耦合。

#### Rhie-Chow 插值：同位网格的“解药”

为了在同位网格上克服棋盘格问题，Rhie和Chow提出了一种特殊的动量插值方法 。其核心思想不是直接插值速度，而是插值离散[动量方程](@entry_id:197225)本身来构造面心速度。

首先，将单元 $P$ 的离散动量方程改写为：
$$
\mathbf{u}_P = \frac{\mathbf{H}_P}{a_P} - \frac{1}{a_P} (\nabla p)_P \equiv \tilde{\mathbf{u}}_P - \frac{1}{a_P} (\nabla p)_P
$$
其中 $\tilde{\mathbf{u}}_P = \mathbf{H}_P / a_P$ 被称为“伪速度”。[Rhie-Chow插值](@entry_id:154759)在计算面 $f$（连接单元 $P$ 和 $N$）上的速度 $\mathbf{u}_f^{\text{RC}}$ 时，分别插值伪速度和压力梯度项：

$$
\mathbf{u}_f^{\text{RC}} = \overline{\tilde{\mathbf{u}}}_f - \overline{\left(\frac{1}{a}\right)}_f (\nabla p)_f
$$

其中，$\overline{(\cdot)}_f$ 表示在面 $f$ 上的线性插值。关键在于，面上的压力梯度 $(\nabla p)_f$ 被显式地用相邻单元的压力差表示，如 $(\nabla p)_f \approx \frac{p_N - p_P}{\delta_{PN}}\mathbf{n}_f$，而面上的系数则通过插值得到 $\overline{\left(\frac{1}{a}\right)}_f$。这样构造出的面速度 $\mathbf{u}_f^{\text{RC}}$ 包含了一个与相邻单元压力差成正比的耗散项，这个项能够有效地抑制高频压力振荡，从而重新建立了压力与速度在面通量计算中的紧密耦合 。所有现代的基于[同位网格](@entry_id:1122659)的压力-速度耦合算法，包括SIMPLE和PISO，都依赖于[Rhie-Chow插值](@entry_id:154759)或其变体。

### SIMPLE算法：一种稳健的迭代方法

SIMPLE算法是一种迭代过程，尤其适用于求解[稳态](@entry_id:139253)问题。其通过“预测-校正”的循环来逐步满足动量和连续性方程。一个完整的SIMPLE迭代循环包括以下步骤 ：

1.  **动量预测步**：使用上一迭代步得到的压[力场](@entry_id:147325) $p^*$（或一个初始猜测值）来求解离散[动量方程](@entry_id:197225)，得到一个中间速度场 $\mathbf{u}^*$。这个速度场满足[动量守恒](@entry_id:149964)（基于旧的压[力场](@entry_id:147325)），但通常不满足连续性方程，即 $\nabla \cdot \mathbf{u}^* \neq 0$。

2.  **压力校正步**：此步的目的是计算一个压力校正量 $p'$，使得校正后的速度场 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$ 满足[连续性方程](@entry_id:195013) $\nabla \cdot \mathbf{u} = 0$。为此，需要建立速度校正量 $\mathbf{u}'$ 和压力校正量 $p'$ 之间的关系。通过对动量方程进行简化近似，可以得到一个关键关系：$\mathbf{u}' \approx - \frac{V_P}{a_P} \nabla p'$。将此关系代入校正后的连续性方程 $\nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0$，便可导出一个关于 $p'$ 的泊松型方程：
    $$
    \nabla \cdot \left( \frac{V_P}{a_P} \nabla p' \right) = \nabla \cdot \mathbf{u}^*
    $$
    该方程的源项是预测速度场的散度，即质量不平衡量。求解该方程，即可得到压力校正场 $p'$。

3.  **速度与压力校正步**：使用计算出的 $p'$ 来校正压力和速度（以及面通量）：
    $$
    p = p^* + \alpha_p p'
    $$
    $$
    \mathbf{u} = \mathbf{u}^* + \mathbf{u}'
    $$
    其中 $\alpha_p$ 是压力的**欠[松弛因子](@entry_id:1130825)**（under-relaxation factor）。

#### [欠松弛](@entry_id:756302)的必要性

由于在推导压力校正方程时，我们对速度校正量与压力校正量的关系式进行了近似（忽略了邻居速度校正的影响），因此求得的 $p'$ 并非精确值。若将完整的校正量直接加到原有场上，迭代过程很可能会发生振荡甚至发散。因此，必须引入[欠松弛](@entry_id:756302)，即只采用一部分校正量，以保证[迭代过程的稳定性](@entry_id:174376)。速度场通常也需要进行欠松弛。欠[松弛因子](@entry_id:1130825) $\alpha$ 的取值范围为 $(0, 1)$。一个简单的局部更新模型可以直观地展示欠松弛的效果：如果一次校正能够完全消除质量误差，那么施加一个[松弛因子](@entry_id:1130825)为 $\gamma$ 的校正后，新的质量误差将是旧误差的 $(1-\gamma)$ 倍 。

### [PISO算法](@entry_id:155035)：面向瞬态问题的改进

[PISO算法](@entry_id:155035)是SIMPLE算法的扩展，主要为提高瞬态问题计算的效率和精度而设计 。它与SIMPLE的主要区别在于，PISO在一个时间步内执行多次压力校正，以更精确地满足动量和连续性方程。

[PISO算法](@entry_id:155035)在一个时间步内的流程如下 ：

1.  **动量预测步**：与SIMPLE类似，使用上一时间步的压[力场](@entry_id:147325) $p^n$ 求解[动量方程](@entry_id:197225)，得到预测速度场 $\mathbf{u}^*$。

2.  **第一次校正**：求解一次压力校正方程，得到 $p'$，并校正压力和速度。这一步与SIMPLE的一次迭代非常相似。

3.  **第二次（及后续）校正**：这是[PISO算法](@entry_id:155035)的关键。第一次校正后的速度场虽然近似满足了连续性，但由于SIMPLE近似，它与新的压[力场](@entry_id:147325)并不完全匹配动量方程。PISO通过进行额外的校正来弥补这一偏差。它会利用更新后的速度场重新计算通量，并以此作为新的源项，再次求解压力校正方程。在这些额外的校正循环中，[动量方程](@entry_id:197225)的[系数矩阵](@entry_id:151473)（尤其是昂贵的对角系数 $a_P$）被**复用**，因此计算成本远低于重新求解一次[动量方程](@entry_id:197225)。在某些高级变体中，甚至会在校正循环之间更新动量方程的非对角项，以更好地处理[非线性](@entry_id:637147)效应 。

由于PISO在一个时间步内通过多次校正更严格地执行了压力-速度耦合，它通常**不需要或仅需要非常小的欠[松弛因子](@entry_id:1130825)**。这使得它能够准确地捕捉流场的瞬态变化，并允许使用比SIMPLE更大的时间步长（即更高的库朗数），从而在瞬态模拟中表现出更高的效率和精度。

### 一个基本约束：压力基准

无论是SIMPLE还是[PISO算法](@entry_id:155035)，在求解压力（或压力校正）方程时都会遇到一个根本性问题：解的非唯一性 。

如前所述，在全速度边界（Dirichlet）的封闭域问题中，压力仅通过其梯度影响流动，因此其绝对值可以任意浮动。这在离散的代数系统中表现为，压力校正方程的系数矩阵是**奇异的**。该[矩阵的零空间](@entry_id:152429)由一个常数向量构成（即所有元素均为1的向量）。

根据[Fredholm择一](@entry_id:138045)性原理，这样的奇异线性系统有解的**[相容性条件](@entry_id:637057)**是：其右端项（即所有控制体的质量不平衡量之和）必须为零。这在物理上对应于全局质量守恒，即[流入区](@entry_id:269854)域的总质量必须等于流出的总质量。

由于矩阵是奇异的，如果 $p'$ 是一个解，那么 $p' + C$（其中 $C$ 是任意常数）也是一个解。为了得到唯一的数值解，必须**指定一个压力基准**（fixing the pressure gauge）。常见的做法有：
*   在某个参考网格单元中将压力（或压力校正值）钉扎为零。
*   强制要求整个场的压力（或压力校正值）平均值为零。

需要强调的是，选择哪种压力基准只会影响压[力场](@entry_id:147325)的绝对值，而不会改变压力梯度。因此，最终计算得到的、具有物理意义的速度场是**唯一且与压力基准的选择无关的** 。

### 总结：SIMPLE 与 PISO 的对比

总而言之，SIMPLE 和 PISO 是解决[压力-速度耦合](@entry_id:155962)问题的两种强大算法，它们基于共同的“预测-校正”思想，但各有侧重 。

| 特性 | SIMPLE 算法 | PISO 算法 |
| :--- | :--- | :--- |
| **算法结构** | 迭代式。每个外循环包含一次动量预测和一次压力校正。 | 非迭代式（在一个时间步内）。包含一次动量预测和多次（$\ge 2$）压力校正。 |
| **欠松弛** | **必需**。为保证迭代收敛，对压力和速度通常需要显著的[欠松弛](@entry_id:756302)。 | **通常不需要**或仅需少量松弛。多次校正提高了稳定性。 |
| **计算成本** | 每迭代步成本较低（一次动量解、一次压力解）。 | 每时间步成本较高（一次动量解、多次压力解）。 |
| **适用场景** | **[稳态](@entry_id:139253)问题**的行业标准。其鲁棒性和相对简单的结构使其成为首选。 | **瞬态问题**的理想选择。允许使用更大的时间步，能更精确地捕捉物理过程。 |

在实际的[计算流体动力学](@entry_id:142614)（CFD）应用中，选择SIMPLE还是PISO，取决于所研究问题的物理特性。对于最终只关心稳定流动状态的工程问题，SIMPLE是高效可靠的工具。而对于需要精确解析流动随时间演化的科学研究或工程分析，PISO则提供了更高的保真度和计算效率。