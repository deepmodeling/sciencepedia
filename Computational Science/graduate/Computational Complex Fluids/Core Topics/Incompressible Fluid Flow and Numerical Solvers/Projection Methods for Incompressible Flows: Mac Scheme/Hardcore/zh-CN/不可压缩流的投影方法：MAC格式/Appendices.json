{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，网格的选择是一项至关重要的决定，它直接影响着模拟的稳定性和准确性。本练习旨在探讨一个被称为“压力-速度解耦”的经典问题，该问题常常困扰着使用同位网格（collocated grid）的格式。通过分析一个病态的“棋盘”压力场，您将直接比较同位网格和交错的MAC网格如何计算压力梯度，从而揭示MAC格式内在的鲁棒性。",
            "id": "4100591",
            "problem": "考虑一个通过投影法推进的不可压缩流，其中压力梯度在速度更新中强制执行无散度约束。压力仅通过其离散梯度出现。在同位网格有限差分格式中，压力 $p$ 和速度 $\\boldsymbol{u}$ 存储在网格中心；而在标记-单元法 (Marker-and-Cell, MAC) 格式中，压力 $p$ 存储在网格中心，速度分量存储在网格面上。\n\n在一个二维、方形、周期性域上进行计算，该域使用间距为 $h$ 的均匀笛卡尔网格进行离散，网格中心使用整数索引 $(i,j)$ 表示。假设变量是无量纲的，因此 $p$ 是无量纲的。定义以下离散算子：\n\n1. 在同位网格格式中，网格中心 $(i,j)$ 处压力梯度的离散 $x$ 分量由中心差分近似：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\mathrm{coll}} \\equiv \\frac{p_{i+1,j} - p_{i-1,j}}{2h}\n$$\n\n2. 在 MAC 格式中，与位于垂直面 $(i+\\tfrac{1}{2},j)$ 上的 u 速度同位的压力梯度 $x$ 分量由单边差分近似：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\mathrm{MAC}} \\equiv \\frac{p_{i+1,j} - p_{i,j}}{h}\n$$\n\n考虑在具有周期性边界条件的网格上的棋盘格压力模式：\n$$\np_{i,j} = (-1)^{i+j}, \\quad \\text{对所有整数 } i,j。\n$$\n使用上述算子，计算并比较此模式产生的离散压力梯度。然后，具体确定在网格单元 $(0,0)$ 和 $(1,0)$ 之间的面，即在 $(i+\\tfrac{1}{2},j) = (\\tfrac{1}{2},0)$ 处的 MAC 离散压力梯度 $x$ 分量。\n\n将最终答案表示为仅含 $h$ 的单个闭式解析表达式。无需四舍五入。如果出现任何中间物理单位，假设已进行无量纲化，以使最终表达式无单位。",
            "solution": "问题陈述是有效的，因为它在计算流体动力学领域具有科学依据，特别涉及不可压缩流的有限差分格式的数值分析。这是一个适定问题，提供了所有必要的定义和条件，从而可以得到唯一且可验证的解。该问题是客观的，并使用了标准的、无歧义的术语。\n\n题目要求我们使用两种不同的有限差分近似方法——一种用于同位网格，另一种用于标记-单元法 (MAC) 交错网格——来计算并比较由特定压力场产生的离散压力梯度。最后，我们必须计算 MAC 格式的一个特定值。\n\n设均匀笛卡尔网格的间距为 $h$。压力场由棋盘格模式给出：\n$$\np_{i,j} = (-1)^{i+j}\n$$\n对所有整数索引 $i$ 和 $j$ 成立。\n\n首先，我们分析同位网格格式的离散压力梯度。网格中心 $(i,j)$ 处梯度 $x$ 分量的算子定义为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\mathrm{coll}} \\equiv \\frac{p_{i+1,j} - p_{i-1,j}}{2h}\n$$\n为计算此式，我们代入给定的压力场。相邻网格中心 $(i+1,j)$ 和 $(i-1,j)$ 处的压力为：\n$$\np_{i+1,j} = (-1)^{(i+1)+j} = (-1)^{i+j+1} = -(-1)^{i+j}\n$$\n$$\np_{i-1,j} = (-1)^{(i-1)+j} = (-1)^{i+j-1} = (-1)^{-1} (-1)^{i+j} = -(-1)^{i+j}\n$$\n将这些表达式代入同位网格梯度算子：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\mathrm{coll}} = \\frac{-(-1)^{i+j} - \\left(-(-1)^{i+j}\\right)}{2h} = \\frac{-(-1)^{i+j} + (-1)^{i+j}}{2h} = \\frac{0}{2h} = 0\n$$\n这个结果对任何网格单元 $(i,j)$ 都成立。这揭示了同位网格上中心差分算子的一个致命弱点：它对最高频率（棋盘格）模式不敏感。一个非零的压力场产生了零压力梯度，这意味着离散投影步将无法校正产生这种压力的速度场。这是在投影法中使用交错网格的主要动机。\n\n接下来，我们分析 MAC 格式的离散压力梯度。梯度 $x$ 分量的算子位于垂直网格面 $(i+\\frac{1}{2},j)$ 上，定义为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\mathrm{MAC}} \\equiv \\frac{p_{i+1,j} - p_{i,j}}{h}\n$$\n我们将棋盘格压力场代入此算子。我们已经有 $p_{i+1,j} = -(-1)^{i+j}$ 并且我们知道 $p_{i,j} = (-1)^{i+j}$。\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\mathrm{MAC}} = \\frac{-(-1)^{i+j} - (-1)^{i+j}}{h} = \\frac{-2(-1)^{i+j}}{h}\n$$\n与同位网格格式不同，MAC 格式对于棋盘格压力场会产生非零的压力梯度。梯度的大小是恒定的，为 $\\left| \\frac{-2}{h} \\right| = \\frac{2}{h}$，但其符号根据 $i+j$ 的奇偶性交替变化。这表明 MAC 网格布置及其相关的有限差分算子可以正确地“看到”并响应高频压力模式，这在稳定性和准确性方面是一个显著优势。\n\n最后，题目要求我们确定在面 $(i+\\frac{1}{2},j) = (\\frac{1}{2},0)$ 处 MAC 离散压力梯度 $x$ 分量的具体值。这个位置对应于网格单元 $(0,0)$ 和 $(1,0)$ 之间的面。因此，我们必须对 $i=0$ 和 $j=0$ 的情况计算通用表达式。\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\frac{1}{2},0}^{\\mathrm{MAC}} = \\frac{-2(-1)^{0+0}}{h} = \\frac{-2(-1)^{0}}{h} = \\frac{-2(1)}{h} = -\\frac{2}{h}\n$$\n这就是所要求的具体值。",
            "answer": "$$\n\\boxed{-\\frac{2}{h}}\n$$"
        },
        {
            "introduction": "选择了交错网格之后，下一步便是精确地离散Navier-Stokes方程中的微分算子。拉普拉斯算子在粘性项和压力泊松方程中都处于核心地位，它在MAC网格上的构建需要精心设计以保持二阶精度。本练习将指导您使用泰勒级数展开，从第一性原理推导面心拉普拉斯算子的五点模板，这是发展有限差分法的一项基本技能。",
            "id": "4100667",
            "problem": "考虑在一个二维矩形域上的Marker-and-Cell (MAC)网格上离散的不可压缩Navier-Stokes方程，其均匀网格间距为$\\Delta x$和$\\Delta y$。水平速度分量$u$存储在垂直单元面的中心，位置为$(x_{i+1/2}, y_{j}) = \\left((i+\\tfrac{1}{2})\\Delta x, j \\Delta y\\right)$。作用于$(i+\\tfrac{1}{2}, j)$处$u$的面心拉普拉斯算子由在该面心位置求值的连续算子$\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$定义，并需使用与面心布置相一致的二阶中心差分进行近似。\n\n从二阶导数的定义和关于点$(x_{i+1/2}, y_{j})$的泰勒展开出发，推导近似$(i+\\tfrac{1}{2}, j)$处$\\nabla^{2} u$的五点离散格式及其系数，使用相邻的面心值$u_{i+3/2, j}$、$u_{i+1/2, j}$、$u_{i-1/2, j}$、$u_{i+1/2, j+1}$和$u_{i+1/2, j-1}$。将离散算子表示为以下形式\n$$\n\\left(\\nabla^{2} u\\right)_{i+1/2, j} \\approx a_{0}\\,u_{i+1/2, j} + a_{\\mathrm{E}}\\,u_{i+3/2, j} + a_{\\mathrm{W}}\\,u_{i-1/2, j} + a_{\\mathrm{N}}\\,u_{i+1/2, j+1} + a_{\\mathrm{S}}\\,u_{i+1/2, j-1},\n$$\n并用$\\Delta x$和$\\Delta y$表示系数$a_{0}$、$a_{\\mathrm{E}}$、$a_{\\mathrm{W}}$、$a_{\\mathrm{N}}$和$a_{\\mathrm{S}}$。\n\n答案格式：将系数的有序行向量$[a_{0}, a_{\\mathrm{E}}, a_{\\mathrm{W}}, a_{\\mathrm{N}}, a_{\\mathrm{S}}]$作为单个$1\\times 5$的行矩阵返回。最终答案必须是精确的符号表达式。最终答案中不要包含单位。",
            "solution": "用户希望在一个交错的Marker-and-Cell (MAC)网格上找到拉普拉斯算子$\\nabla^{2} u$的五点格式。水平速度分量$u$位于垂直单元面的中心，索引为$(i+\\frac{1}{2}, j)$。任务是使用二阶中心差分推导离散近似。\n\n二维拉普拉斯算子定义为：\n$$\n\\nabla^{2} u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}\n$$\n我们需要在点$(x_{i+1/2}, y_{j})$处找到该算子的离散近似。我们将使用中心差分分别近似每个二阶导数项，然后将它们相加。该近似必须使用指定的相邻面心速度值：$u_{i+3/2, j}$、$u_{i-1/2, j}$、$u_{i+1/2, j+1}$和$u_{i+1/2, j-1}$。\n\n首先，我们来近似在$(x_{i+1/2}, y_{j})$处的项$\\frac{\\partial^{2} u}{\\partial x^{2}}$。我们对x方向上的相邻点$u_{i+3/2, j} = u(x_{i+1/2}+\\Delta x, y_j)$和$u_{i-1/2, j} = u(x_{i+1/2}-\\Delta x, y_j)$，围绕中心点$(x_{i+1/2}, y_j)$进行泰勒级数展开。令$u_{i+1/2,j}$表示$u(x_{i+1/2}, y_j)$。\n\n向前泰勒展开为：\n$$\nu_{i+3/2, j} = u_{i+1/2, j} + \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i+1/2, j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i+1/2, j} + \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i+1/2, j} + O((\\Delta x)^{4})\n$$\n向后泰勒展开为：\n$$\nu_{i-1/2, j} = u_{i+1/2, j} - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_{i+1/2, j} + \\frac{(\\Delta x)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i+1/2, j} - \\frac{(\\Delta x)^{3}}{3!} \\left(\\frac{\\partial^{3} u}{\\partial x^{3}}\\right)_{i+1/2, j} + O((\\Delta x)^{4})\n$$\n将这两个展开式相加，奇数阶导数项相互抵消：\n$$\nu_{i+3/2, j} + u_{i-1/2, j} = 2 u_{i+1/2, j} + (\\Delta x)^{2} \\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i+1/2, j} + O((\\Delta x)^{4})\n$$\n现在，我们可以求解二阶导数$\\frac{\\partial^{2} u}{\\partial x^{2}}$：\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x^{2}}\\right)_{i+1/2, j} = \\frac{u_{i-1/2, j} - 2 u_{i+1/2, j} + u_{i+3/2, j}}{(\\Delta x)^{2}} + O((\\Delta x)^{2})\n$$\n这是关于$x$的二阶偏导数的二阶中心差分近似。\n\n接下来，我们在同一点$(x_{i+1/2}, y_{j})$处近似项$\\frac{\\partial^{2} u}{\\partial y^{2}}$。y方向上的相邻点是$u_{i+1/2, j+1} = u(x_{i+1/2}, y_j+\\Delta y)$和$u_{i+1/2, j-1} = u(x_{i+1/2}, y_j-\\Delta y)$。我们在y变量上进行泰勒级数展开：\n$$\nu_{i+1/2, j+1} = u_{i+1/2, j} + \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i+1/2, j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i+1/2, j} + O((\\Delta y)^{3})\n$$\n$$\nu_{i+1/2, j-1} = u_{i+1/2, j} - \\Delta y \\left(\\frac{\\partial u}{\\partial y}\\right)_{i+1/2, j} + \\frac{(\\Delta y)^{2}}{2!} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i+1/2, j} - O((\\Delta y)^{3})\n$$\n将这两个展开式相加得到：\n$$\nu_{i+1/2, j+1} + u_{i+1/2, j-1} = 2 u_{i+1/2, j} + (\\Delta y)^{2} \\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i+1/2, j} + O((\\Delta y)^{4})\n$$\n求解二阶导数$\\frac{\\partial^{2} u}{\\partial y^{2}}$：\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial y^{2}}\\right)_{i+1/2, j} = \\frac{u_{i+1/2, j-1} - 2 u_{i+1/2, j} + u_{i+1/2, j+1}}{(\\Delta y)^{2}} + O((\\Delta y)^{2})\n$$\n这是关于$y$的二阶偏导数的二阶中心差分近似。\n\n现在，我们结合这两个近似来形成离散拉普拉斯算子：\n$$\n\\left(\\nabla^{2} u\\right)_{i+1/2, j} \\approx \\frac{u_{i-1/2, j} - 2 u_{i+1/2, j} + u_{i+3/2, j}}{(\\Delta x)^{2}} + \\frac{u_{i+1/2, j-1} - 2 u_{i+1/2, j} + u_{i+1/2, j+1}}{(\\Delta y)^{2}}\n$$\n为了匹配所需的形式，我们按其对应的速度分量对各项进行分组：\n$$\n\\left(\\nabla^{2} u\\right)_{i+1/2, j} \\approx \\left(-\\frac{2}{(\\Delta x)^{2}} - \\frac{2}{(\\Delta y)^{2}}\\right) u_{i+1/2, j} + \\frac{1}{(\\Delta x)^{2}} u_{i+3/2, j} + \\frac{1}{(\\Delta x)^{2}} u_{i-1/2, j} + \\frac{1}{(\\Delta y)^{2}} u_{i+1/2, j+1} + \\frac{1}{(\\Delta y)^{2}} u_{i+1/2, j-1}\n$$\n将此表达式与问题陈述中要求的形式进行比较：\n$$\n\\left(\\nabla^{2} u\\right)_{i+1/2, j} \\approx a_{0}\\,u_{i+1/2, j} + a_{\\mathrm{E}}\\,u_{i+3/2, j} + a_{\\mathrm{W}}\\,u_{i-1/2, j} + a_{\\mathrm{N}}\\,u_{i+1/2, j+1} + a_{\\mathrm{S}}\\,u_{i+1/2, j-1}\n$$\n我们可以确定系数：\n- 中心节点$u_{i+1/2, j}$的系数是$a_{0} = -\\frac{2}{(\\Delta x)^{2}} - \\frac{2}{(\\Delta y)^{2}} = -2\\left(\\frac{1}{(\\Delta x)^{2}} + \\frac{1}{(\\Delta y)^{2}}\\right)$。\n- 东侧节点$u_{i+3/2, j}$的系数是$a_{\\mathrm{E}} = \\frac{1}{(\\Delta x)^{2}}$。\n- 西侧节点$u_{i-1/2, j}$的系数是$a_{\\mathrm{W}} = \\frac{1}{(\\Delta x)^{2}}$。\n- 北侧节点$u_{i+1/2, j+1}$的系数是$a_{\\mathrm{N}} = \\frac{1}{(\\Delta y)^{2}}$。\n- 南侧节点$u_{i+1/2, j-1}$的系数是$a_{\\mathrm{S}} = \\frac{1}{(\\Delta y)^{2}}$。\n\n因此，系数的有序向量$[a_{0}, a_{\\mathrm{E}}, a_{\\mathrm{W}}, a_{\\mathrm{N}}, a_{\\mathrm{S}}]$为：\n$$\n\\left[ -2\\left(\\frac{1}{(\\Delta x)^{2}} + \\frac{1}{(\\Delta y)^{2}}\\right), \\frac{1}{(\\Delta x)^{2}}, \\frac{1}{(\\Delta x)^{2}}, \\frac{1}{(\\Delta y)^{2}}, \\frac{1}{(\\Delta y)^{2}} \\right]\n$$\n这表示在交错网格上针对$u$-速度分量的拉普拉斯算子的五点格式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2\\left(\\frac{1}{(\\Delta x)^{2}} + \\frac{1}{(\\Delta y)^{2}}\\right) & \\frac{1}{(\\Delta x)^{2}} & \\frac{1}{(\\Delta x)^{2}} & \\frac{1}{(\\Delta y)^{2}} & \\frac{1}{(\\Delta y)^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "投影法的核心步骤是求解一个大型的压力线性系统，该系统由离散的压力泊松方程所描述。该系统矩阵（即离散拉普拉斯算子）的性质决定了压力解的存在性和唯一性。本练习将深入探讨该算子的数学结构，通过使用离散的“分部积分”方法来分析其零空间，从而解释为何在不可压缩流中，压力只能被确定至一个任意的附加常数。",
            "id": "4100635",
            "problem": "考虑一个单连通矩形域 $\\Omega = [0,L_x] \\times [0,L_y]$ 上的不可压缩牛顿流体，其受纳维-斯托克斯方程控制，具有未知速度场 $\\boldsymbol{u}(x,y,t)$ 和压力场 $p(x,y,t)$。在一阶速度-压力投影法中，首先通过显式动量更新计算一个中间面心速度 $\\boldsymbol{u}^{\\ast}$，然后通过减去一个离散压力梯度，将速度投影到一个无散场上。在均匀的标记-单元法 (Marker-and-Cell, MAC) 网格上，设 $x$ 方向有 $N_x$ 个单元，$y$ 方向有 $N_y$ 个单元。压力 $p_{i,j}$ 存储在单元中心，而速度 $u_{i+1/2,j}$ 和 $v_{i,j+1/2}$ 分别存储在垂直面和水平面上。设离散梯度 $G$ 将单元中心的压力映射到面心的梯度，离散散度 $D$ 将面心的通量映射到单元中心的散度，均在均匀网格上使用标准的二阶有限差分。假设压力满足齐次诺伊曼边界条件，因此 $p$ 的法向导数在 $\\partial \\Omega$ 上为零，这通过在每个固壁边界处使用 $p$ 的镜像虚单元值来离散地实施。\n\n投影步骤强制执行离散不可压缩性约束 $D \\boldsymbol{u}^{n+1} = 0$，得到形如 $L p^{n+1} = \\frac{\\rho}{\\Delta t} D \\boldsymbol{u}^{\\ast}$ 的离散压力泊松方程，其中 $L := D G$ 作用于单元中心的压力。关注在所述的齐次诺伊曼边界条件下，压力的齐次算子方程 $L p = 0$。\n\n从基本运动学不可压缩性条件 $\\nabla \\cdot \\boldsymbol{u} = 0$、投影更新的定义 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\frac{\\Delta t}{\\rho} G p^{n+1}$，以及在 MAC 网格上由有限差分定义的离散散度 $D$ 和梯度 $G$ 出发，推导在齐次诺伊曼边界条件下离散算子 $L = D G$ 的结构。使用离散分部积分论证来刻画其零空间，并解释这如何与压力仅能确定到一个相加常数相关。计算所描述的连通矩形域的离散零空间维数 $\\dim \\ker(L)$。\n\n最终答案以单个整数形式给出，不带单位。无需四舍五入。",
            "solution": "问题要求计算在均匀标记-单元法 (MAC) 网格上，对于一个单连通矩形域，在压力满足齐次诺伊曼边界条件的约束下，离散压力泊松算子 $L = DG$ 的零空间的维数。\n\n设均匀网格的单元尺寸为 $\\Delta x$ 和 $\\Delta y$。压力 $p_{i,j}$ 位于单元 $(i,j)$ 的中心，其中 $i=1, \\dots, N_x$ 且 $j=1, \\dots, N_y$。速度分量 $u$ 位于位置为 $(i+1/2, j)$ 的垂直面上，分量 $v$ 位于位置为 $(i, j+1/2)$ 的水平面上。\n\n首先，我们定义离散梯度算子 $G$ 和离散散度算子 $D$。算子 $G$ 将单元中心的压力场 $p$ 映射到面心的向量场。使用二阶中心差分，其分量为：\n$$\n(Gp)_{i+1/2, j} = \\frac{p_{i+1, j} - p_{i, j}}{\\Delta x}\n$$\n$$\n(Gp)_{i, j+1/2} = \\frac{p_{i, j+1} - p_{i, j}}{\\Delta y}\n$$\n算子 $D$ 将面心的速度场 $\\boldsymbol{u} = (u,v)$ 映射到单元中心的标量场。其定义为：\n$$\n(D\\boldsymbol{u})_{i,j} = \\frac{u_{i+1/2, j} - u_{i-1/2, j}}{\\Delta x} + \\frac{v_{i, j+1/2} - v_{i, j-1/2}}{\\Delta y}\n$$\n算子 $L$ 是 $D G$ 的复合。我们将 $D$ 应用于 $G$ 作用于 $p$ 的结果：\n$$\n(Lp)_{i,j} = (D(Gp))_{i,j} = \\frac{(Gp)_{i+1/2, j} - (Gp)_{i-1/2, j}}{\\Delta x} + \\frac{(Gp)_{i, j+1/2} - (Gp)_{i, j-1/2}}{\\Delta y}\n$$\n代入 $G$ 的表达式：\n$$\n(Lp)_{i,j} = \\frac{1}{\\Delta x} \\left( \\frac{p_{i+1, j} - p_{i, j}}{\\Delta x} - \\frac{p_{i, j} - p_{i-1, j}}{\\Delta x} \\right) + \\frac{1}{\\Delta y} \\left( \\frac{p_{i, j+1} - p_{i, j}}{\\Delta y} - \\frac{p_{i, j} - p_{i, j-1}}{\\Delta y} \\right)\n$$\n这简化为离散拉普拉斯算子的标准5点模板：\n$$\n(Lp)_{i,j} = \\frac{p_{i+1, j} - 2p_{i, j} + p_{i-1, j}}{(\\Delta x)^2} + \\frac{p_{i, j+1} - 2p_{i, j} + p_{i, j-1}}{(\\Delta y)^2}\n$$\n压力的齐次诺伊曼边界条件 $\\frac{\\partial p}{\\partial n} = 0$ 通过将边界上的法向梯度分量设为零来离散地实施。例如，在左边界（$i=1/2$ 处的面），条件是 $(Gp)_{1/2,j} = (p_{1,j}-p_{0,j})/\\Delta x = 0$，这意味着 $p_{0,j} = p_{1,j}$。这里，$p_{0,j}$ 代表域外“虚单元”中的压力。这种镜像方法应用于所有四个边界。\n\n为了刻画 $L$ 的零空间（核），记作 $\\ker(L)$，我们寻找所有满足 $Lp=0$ 的压力场 $p$。问题要求使用离散分部积分论证。这涉及到通过内积来关联算子 $D$ 和 $G$。\n\n我们为单元中心的标量场 $p$ 和 $q$ 定义一个离散内积，作为对所有计算单元的求和：\n$$\n\\langle p, q \\rangle_c = \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} p_{i,j} q_{i,j}\n$$\n并为面心的向量场 $\\boldsymbol{u}$ 和 $\\boldsymbol{w}$ 定义一个内积，作为对所有面的求和：\n$$\n\\langle \\boldsymbol{u}, \\boldsymbol{w} \\rangle_f = \\sum_{j=1}^{N_y} \\sum_{i=0}^{N_x} u_{i+1/2,j} w_{x,i+1/2,j} + \\sum_{i=1}^{N_x} \\sum_{j=0}^{N_y} v_{i,j+1/2} w_{y,i,j+1/2}\n$$\n我们来考察内积 $\\langle q, D\\boldsymbol{u} \\rangle_c$：\n$$\n\\langle q, D\\boldsymbol{u} \\rangle_c = \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} q_{i,j} \\left( \\frac{u_{i+1/2, j} - u_{i-1/2, j}}{\\Delta x} + \\frac{v_{i, j+1/2} - v_{i, j-1/2}}{\\Delta y} \\right)\n$$\n对 $u$ 项使用分部求和法（对 $v$ 项类似），并假设边界 $\\partial\\Omega$ 上的法向速度为零（即 $u_{1/2,j}=u_{N_x+1/2,j}=0$ 和 $v_{i,1/2}=v_{i,N_y+1/2}=0$），求和中的边界项消失。和变为：\n$$\n\\langle q, D\\boldsymbol{u} \\rangle_c = - \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\left( \\frac{q_{i,j} - q_{i-1,j}}{\\Delta x} u_{i-1/2,j} + \\frac{q_{i,j} - q_{i,j-1}}{\\Delta y} v_{i,j-1/2} \\right)\n$$\n这可以用梯度算子 $G$ 重写为：\n$$\n\\langle q, D\\boldsymbol{u} \\rangle_c = - \\langle Gq, \\boldsymbol{u} \\rangle_f\n$$\n这表明，在这些内积的意义下，$G$ 是 $D$ 的负伴随算子，即 $G = -D^T$。压力的齐次诺伊曼条件恰好是自然边界条件，它源于要求此伴随关系成立，而无需对边界上的测试函数 $q$ 施加限制性条件。\n\n现在，我们可以分析 $L=DG$ 的零空间。如果 $Lp=0$，则向量 $p$ 位于 $L$ 的零空间中。考虑内积 $\\langle p, Lp \\rangle_c$：\n$$\n\\langle p, Lp \\rangle_c = \\langle p, DGp \\rangle_c\n$$\n使用我们推导的伴随性质，令 $\\boldsymbol{u} = Gp$：\n$$\n\\langle p, DGp \\rangle_c = - \\langle Gp, Gp \\rangle_f = - \\left\\| Gp \\right\\|_f^2\n$$\n条件 $Lp=0$ 意味着 $\\langle p, Lp \\rangle_c$ 也必须为零。因此，\n$$\n- \\left\\| Gp \\right\\|_f^2 = 0 \\implies \\left\\| Gp \\right\\|_f^2 = 0\n$$\n由于范数的平方是实数的平方和，范数为零当且仅当向量本身是零向量。因此，$Lp=0$ 等价于 $Gp=0$。\n$Gp=0$ 意味着离散梯度的每个分量都为零：\n$$\n\\frac{p_{i+1, j} - p_{i, j}}{\\Delta x} = 0 \\quad \\text{对于所有定义了此式的 } i,j\n$$\n$$\n\\frac{p_{i, j+1} - p_{i, j}}{\\Delta y} = 0 \\quad \\text{对于所有定义了此式的 } i,j\n$$\n这些方程意味着 $p_{i+1, j} = p_{i, j}$ 和 $p_{i, j+1} = p_{i, j}$。任何两个相邻单元中的压力值相等。由于问题指定了一个单连通矩形域，单元网格是连通的。通过对相邻单元反复应用此等式，我们可以证明整个域中所有单元的压力必须相同。\n$$\np_{i,j} = C \\quad \\text{对于所有 } i=1,\\dots,N_x, \\text{ 和 } j=1,\\dots,N_y\n$$\n其中 $C$ 是一个常数。因此，$L$ 的零空间是所有常数压力场的集合。任何这样的场都可以写成 $C \\cdot \\boldsymbol{1}$，其中 $\\boldsymbol{1}$ 是一个大小为 $N_x \\times N_y$ 且所有分量都等于 $1$ 的向量。\n所有这些向量的集合构成了所有可能压力场空间的一个一维子空间。这个空间由单个基向量 $\\boldsymbol{1}$ 张成。\n\n向量空间的维数是其基中向量的数量。因此，$L$ 的零空间的维数是 $1$。\n\n这个事实解释了为何在封闭域内的不可压缩流模拟中，压力只能确定到一个相加常数的数学原因。泊松方程 $Lp=f$ 是奇异的。仅当右侧项 $f$ 与 $\\ker(L^T)$ 正交时，解才存在。由于 $L$ 是对称的，这意味着 $f$ 必须与 $\\ker(L)$（即常数向量空间）正交。这个相容性条件在物理上是满足的，因为它对应于全局质量守恒。解的非唯一性（$p$ 和 $p+C$ 都是解）需要一个额外的约束来固定压力水平，例如在某一点设置压力或固定其平均值。\n\n离散零空间的维数 $\\dim \\ker(L)$ 是 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}