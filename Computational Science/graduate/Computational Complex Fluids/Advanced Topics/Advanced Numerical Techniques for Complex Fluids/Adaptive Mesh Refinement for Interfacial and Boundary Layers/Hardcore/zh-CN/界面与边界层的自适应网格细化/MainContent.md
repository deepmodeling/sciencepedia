## 引言
在[计算复杂流体](@entry_id:1122778)的广阔领域中，许多关键物理现象，如相[界面动力学](@entry_id:1126605)和边界层内的剧烈梯度，都发生在远小于系统宏观尺寸的微小尺度上。若使用均匀网格来精确捕捉这些现象，将导致无法承受的计算成本，这构成了模拟复杂流体系统的一大挑战。自适应网格加密（Adaptive Mesh Refinement, [AMR](@entry_id:204220)）技术应运而生，它通过动态地将计算资源集中在解变化最剧烈的区域，为高效、高保真地模拟多尺度问题提供了强大的解决方案。

本文旨在全面解析[AMR](@entry_id:204220)技术。在“原理与机制”一章中，我们将深入探讨其背后的物理动机、驱动加密的[误差指标](@entry_id:173250)以及核心算法结构。随后，在“应用与交叉学科联系”一章，我们将展示[AMR](@entry_id:204220)如何在[多相流](@entry_id:146480)、[湍流](@entry_id:151300)和电化学等前沿领域中发挥关键作用。最后，通过“动手实践”部分，读者将有机会将理论知识应用于具体计算任务，从而巩固对[AMR](@entry_id:204220)的理解。

## 原理与机制

在[计算复杂流体](@entry_id:1122778)领域，自适应网格加密（Adaptive Mesh Refinement, AMR）是一种关键技术，它能够将计算资源动态地集中在解的最关键区域，例如[相界面](@entry_id:172947)和边界层。本章旨在深入探讨驱动AMR应用的物理原理和其运行的核心数值机制。我们将从“为何”需要[AMR](@entry_id:204220)出发，阐明其物理动机；然后转向“如何”实现，讨论[界面捕捉](@entry_id:750724)方法和驱动加密的[误差指标](@entry_id:173250)；接着剖析[AMR](@entry_id:204220)的“内容”，即其核心算法结构；最后，我们将探讨在实际应用中遇到的挑战，如时间步长的管理。

### 为何需要自适应：[界面流](@entry_id:1126603)动的多尺度物理

复杂流体系统，尤其是多相流，其固有特性是多尺度性。从宏观的流动形态到微观的[界面动力学](@entry_id:1126605)，物理现象横跨了数个数量级的长度和时间尺度。[AMR](@entry_id:204220)的根本动机正是为了高效地跨越这些尺度。

#### 物理层的尺度分离

在[界面流](@entry_id:1126603)和边界层问题中，解的剧烈变化通常被限制在几何上很薄的区域内。这些区域的厚度由不同物理效应之间的竞争决定，可以通过[无量纲数](@entry_id:260863)进行量化。考虑一个特征长度为 $L$、特征速度为 $U$ 的系统，我们可以定义以下关键的[无量纲数](@entry_id:260863)，它们揭示了不同物理层的特征厚度 ：

- **雷诺数 ($Re = \rho U L / \mu$)**：惯性力与粘性力的比值。在壁面附近，[动量输运](@entry_id:139628)的对流和扩散达到平衡，形成一个粘性边界层，其厚度 $\delta_v$ 在层流状态下与雷诺数成标度关系：
  $$ \delta_v \sim L Re^{-1/2} $$

- **[佩克莱数](@entry_id:141791) ($Pe = U L / D$)**：[对流传质](@entry_id:154702)与扩散[传质](@entry_id:151908)的比值。对于溶解在流体中的稀溶质，在界面或壁面附近会形成[浓度边界层](@entry_id:151238)，其厚度 $\delta_d$ 标度为：
  $$ \delta_d \sim L Pe^{-1/2} $$

- **[邦德数](@entry_id:150841) ($Bo = \Delta\rho g L^2 / \sigma$)**：重力与表面张力的比值。在[静止流体](@entry_id:187621)中，表面张力与重力之间的平衡决定了弯液面的特征弯曲长度，即[毛细长度](@entry_id:276524) $\ell_c$：
  $$ \ell_c \sim \sqrt{\frac{\sigma}{\Delta\rho g}} = L Bo^{-1/2} $$

- **[毛细数](@entry_id:148787) ($Ca = \mu U / \sigma$)**：[粘性力](@entry_id:263294)与表面张力的比值。当[界面运动](@entry_id:1126592)时，[粘性力](@entry_id:263294)会将流体“拖拽”形成一层薄膜，在粘性-毛细主导的状态下（例如Landau-Levich-Derjaguin问题），其动态润滑膜厚度 $h_{\text{dyn}}$ 标度为：
  $$ h_{\text{dyn}} \sim L Ca^{2/3} $$

- **德博拉数 ($De = \lambda U / L$)**：对于[粘弹性流体](@entry_id:198948)，材料的松弛时间 $\lambda$ 与流动特征时间的比值。它决定了弹性应力沿[流线](@entry_id:266815)方向的松弛长度 $\ell_{\text{el}}$：
  $$ \ell_{\text{el}} \sim U \lambda = L De $$

这些[标度律](@entry_id:266186)清晰地表明，在高雷诺数、高[佩克莱数](@entry_id:141791)或低[毛细数](@entry_id:148787)流动中，边界层和界面层可能变得极薄，远小于宏观特征尺度 $L$。若要用均匀网格完全解析这些薄层，所需的计算成本将是天文数字。[AMR](@entry_id:204220)通过仅在需要的地方（即这些薄层内部）使用精细网格，从而在保证精度的前提下，将计算成本控制在可接受的范围内。

#### 界面上的[应力不连续性](@entry_id:172858)

除了薄层的存在，界面本身也是剧烈物理作用的场所。在经典的[尖锐界面模型](@entry_id:1131546)中，界面被视为一个无厚度的表面 $\Gamma$。[动量守恒](@entry_id:149964)定律要求跨过界面的力必须平衡。这导致了应力在界面上的[跳跃条件](@entry_id:750965) 。

考虑作用在界面上的总[应力张量](@entry_id:148973) $\boldsymbol{\sigma}$，其法向牵[引力](@entry_id:189550)为 $\boldsymbol{\sigma} \cdot \mathbf{n}$，其中 $\mathbf{n}$ 是从流体1指向流体2的[单位法向量](@entry_id:178851)。总的牵[引力](@entry_id:189550)[跳跃条件](@entry_id:750965)由表面张力 $\sigma$ 和它的梯度（马兰戈尼效应）平衡：
$$ [\![\boldsymbol{\sigma} \cdot \mathbf{n}]\!] \equiv (\boldsymbol{\sigma} \cdot \mathbf{n})_2 - (\boldsymbol{\sigma} \cdot \mathbf{n})_1 = \sigma \kappa \mathbf{n} + \nabla_s \sigma $$
其中，$\kappa = \nabla_s \cdot \mathbf{n}$ 是界面的[平均曲率](@entry_id:162147)，$\nabla_s$ 是[表面梯度](@entry_id:261146)算子。

这个矢量方程可以分解为法向和切向两个分量：
- **法向应力平衡 ([Young-Laplace方程](@entry_id:138854))**：
  $$ [\![\mathbf{n} \cdot \boldsymbol{\sigma} \cdot \mathbf{n}]\!] = \sigma \kappa $$
  这表明，跨界面的[法向应力](@entry_id:260622)（主要是压力）跳跃由[毛细压力](@entry_id:155511) $\sigma \kappa$ 平衡。为了精确计算这个驱动流动的力，必须精确解析界面的曲率 $\kappa$。
- **切向应[力平衡](@entry_id:267186) (马兰戈尼效应)**：
  $$ [\![\mathbf{t} \cdot \boldsymbol{\sigma} \cdot \mathbf{n}]\!] = \mathbf{t} \cdot \nabla_s \sigma $$
  其中 $\mathbf{t}$ 是任意切向[单位向量](@entry_id:165907)。这表明，跨界面的切向应力（剪切应力）跳跃由[表面张力梯度](@entry_id:156138)驱动。这会在界面附近产生强烈的[剪切流](@entry_id:266817)。

这些条件意味着，[精确模拟](@entry_id:749142)多相流的关键在于准确捕捉界面的几何形状（以计算曲率 $\kappa$）和界面上的物理化学性质（以计算表面张力梯度 $\nabla_s \sigma$）。这些量都是[高阶导数](@entry_id:140882)，对网格分辨率极其敏感，进一步凸显了在界面区域进行局部加密的必要性。

### 如何驱动自适应：[界面捕捉](@entry_id:750724)与误差指示

既然已经明确了对界面和边界层进行局部加密的物理动机，接下来的问题是：在数值计算中，我们如何表示这些需要加密的区域，并设计出能够自动识别它们的机制？

#### [界面捕捉](@entry_id:750724)方法概述

在欧拉网格方法中，主要有三类主流的[界面捕捉](@entry_id:750724)技术，它们在质量守恒性和曲率计算精度上各有千秋，这些特性直接影响了它们与AMR的协同效果 。

- **[流体体积法](@entry_id:756561) (Volume-of-Fluid, VOF)**：该方法通过求解一个[守恒形式](@entry_id:1122899)的[输运方程](@entry_id:174281)来追踪每个网格单元中某一相的[体积分数](@entry_id:756566) $F$。由于其方程形式 $\partial_t F + \nabla \cdot (\mathbf{u} F) = 0$ 的内在守恒性，[VOF方法](@entry_id:1133902)能够精确地保持各相的质量（或体积）。然而，[体积分数](@entry_id:756566)场 $F$ 是一个[不连续函数](@entry_id:143848)（在理想情况下只取0或1），这使得从中精确计算[法向量](@entry_id:264185)和曲率变得非常困难，通常需要复杂的几何重构算法（如PLIC），其精度和鲁棒性都高度依赖于网格分辨率。

- **[水平集](@entry_id:751248)法 (Level Set)**：该方法通过一个连续的[符号距离函数](@entry_id:754834) $\phi$ 来表示界面，界面被定义为 $\phi=0$ 的等值面。$\phi$ 的演化由一个非守恒的[Hamilton-Jacobi方程](@entry_id:145701) $\partial_t \phi + \mathbf{u} \cdot \nabla \phi = 0$ 控制。由于 $\phi$ 的光滑性，其法向量 $\mathbf{n} = \nabla\phi / |\nabla\phi|$ 和曲率 $\kappa = \nabla \cdot \mathbf{n}$ 可以通过直接[微分](@entry_id:158422)得到，且精度很高。然而，标准的[水平集方法](@entry_id:913252)不保证质量守恒，数值误差和周期性的“重新初始化”步骤（用于维持 $\phi$ 的距离函数性质）都会导致质量的漂移。

- **[相场法](@entry_id:191689) (Phase-Field)**：该方法将界面处理为一个具有有限厚度的光滑过渡区，由一个序参数 $c$（通常在两相中取值如 $\pm 1$）描述。其演化由一个对流[Cahn-Hilliard方程](@entry_id:144963)控制。在[无通量边界条件](@entry_id:168487)下，[Cahn-Hilliard方程](@entry_id:144963)本身是质量守恒的。与水平集法类似，序参数场 $c$ 也是光滑的，允许通过[微分](@entry_id:158422)计算曲率。然而，这些计算的精度取决于网格是否能充分解析由参数 $\epsilon$ 控制的界面厚度。

#### [相场模型](@entry_id:1129578)与网格解析度的耦合

[相场法](@entry_id:191689)因其[热力学一致性](@entry_id:138886)和能够自然处理[拓扑变化](@entry_id:136654)的优点，在[复杂流体模拟](@entry_id:1122730)中被广泛使用。一个典型的变密度二元流体模型由耦合的[Navier-Stokes](@entry_id:276387)和[Cahn-Hilliard方程](@entry_id:144963)组构成 ：
- **拟不可压[连续性方程](@entry_id:195013)**: $\nabla \cdot \mathbf{u} = -\frac{1}{\rho(c)}\frac{d\rho}{dc} \nabla \cdot (M\nabla \mu)$
- **动量方程**: $\partial_t(\rho\mathbf{u}) + \nabla \cdot (\rho\mathbf{u}\otimes \mathbf{u}) = -\nabla p + \nabla \cdot (2\eta(c)\mathbf{D}(\mathbf{u})) - c\nabla \mu + \rho\mathbf{f}$
- **[Cahn-Hilliard方程](@entry_id:144963)**: $\partial_t c + \mathbf{u}\cdot \nabla c = \nabla \cdot (M\nabla \mu)$
- **化学势**: $\mu = \frac{\delta F}{\delta c} = \frac{\partial \psi}{\partial c} - \epsilon^2 \Delta c$

在这个模型中，参数 $\epsilon$ 控制了物理上的界面厚度，它与宏观尺度 $L$ 的比值定义了**Cahn数** $Cn = \epsilon / L$ 。这是一个核心的[无量纲参数](@entry_id:169335)。为了使数值解能够正确反映由Cahn-Hilliard物理决定的界面结构，而不是被数值误差所主导，一个关键的网格选择准则必须被满足：局部网格尺寸 $h$ 必须远小于界面厚度 $\epsilon$。
$$ h \lesssim \frac{\epsilon}{N} $$
其中 $N$ 是希望在界面厚度内部署的网格单元数（通常 $N$ 取4到10之间的值）。如果 $h > \epsilon$，对流离散格式引入的[数值耗散](@entry_id:168584)（其特征长度为 $\mathcal{O}(h)$）将会人为地将界面展宽，从而掩盖真实的物理。因此，必须使用AMR在界面处将网格加密到满足上述条件，否则就必须增大 $\epsilon$（即人为加厚界面），以适应现有的网格分辨率。

#### 驱动加密的[误差指标](@entry_id:173250)

[AMR](@entry_id:204220)算法需要一个“传感器”来判断哪些区域需要加密或粗化。这个传感器就是**[误差指标](@entry_id:173250)**（error indicator）。常见的[误差指标](@entry_id:173250)可分为三类 ：

- **基于梯度的指标**：这是最直观和常用的一类。通过监测解变量的梯度来定位高变化区域。例如，一个组合指标可以是：
  $$ E_g(\boldsymbol{x}) = \alpha |\nabla c(\boldsymbol{x})| + \beta ||\nabla \mathbf{u}(\boldsymbol{x})||_F $$
  其中，相场梯度 $|\nabla c|$ 能够有效地识别界面位置，而[速度梯度张量](@entry_id:270928)的[Frobenius范数](@entry_id:143384) $||\nabla \mathbf{u}||_F$ 则能捕捉壁面附近的粘性边界层和界面附近的剪切层。

- **基于曲率的指标**：为了确保毛细力的精确计算，直接监测界面曲率的大小也是一种有效的策略。
  $$ E_k(\boldsymbol{x}) = \left| \nabla\cdot \mathbf{n}_c(\boldsymbol{x}) \right| = \left| \nabla\cdot \left( \frac{\nabla c}{|\nabla c|} \right) \right| $$
  这个指标会驱动网格在液滴、细丝等高曲率区域进行加密。

- **基于残差的指标**：这类指标更为严谨，它直接衡量了当前数值解在多大程度上“不满足”控制方程。通过将数值解代入[偏微分](@entry_id:194612)方程的强形式，计算出的非零结果即为**残差** $R$。例如，对[动量方程](@entry_id:197225)和Cahn-Hilliard方程，残差指标可以构造为：
  $$ E_r(\boldsymbol{x}) = ||R_{\text{momentum}}|| + \gamma |R_{\text{Cahn-Hilliard}}| + \delta |R_{\text{incompressibility}}| $$
  残差大的地方通常对应于局部截断误差大的地方，因此是理想的加密区域。

对于更高级的有限元方法，还可以采用**[各向异性网格自适应](@entry_id:746451)**。其核心思想是构建一个**[网格度量](@entry_id:751908)张量** $M(\mathbf{x})$，它由解的Hessian矩阵 $H(u)$ 导出。理想的网格单元在由 $M(\mathbf{x})$ 定义的黎曼空间中是各向同性的单位尺寸单元。这在物理空间中转化为各向异性的单元，其尺寸 $h_i$ 沿着Hessian矩阵的每个特征方向 $\mathbf{v}_i$（对应特征值为 $\lambda_i$）进行调整，标度关系为 $h_i \propto |\lambda_i|^{-1/2}$ 。在界面或边界层处，法向曲率（最大的 $|\lambda_i|$）很大，而切向曲率很小。因此，这种方法会生成在法向极薄、在切向被拉长的单元，从而以最少的单元数量最高效地解析这些各向异性特征。

### AMR的核心算法机制

在确定了需要加密的区域后，AMR框架通过一套核心算法来执行网格的修改和管理。不同的[AMR](@entry_id:204220)架构在实现这些机制时具有不同的特点。

#### AMR架构：块结构与树结构

目前主流的AMR实现可以分为两大类 ：

- **块结构AMR (Block-structured AMR)**：这种策略（以Berger-Colella-Oliger算法为代表）将需要加密的单元组织成规则的矩形（二维）或长方体（三维）**补丁**（patch）。每个补丁本身是一个具有统一网格间距的规则网格。数据在每个补丁内部是连续存储的，这极大地提高了缓存[命中率](@entry_id:903214)和[向量化](@entry_id:193244)计算的效率，尤其适合有限差分和[有限体积法](@entry_id:141374)中的模板操作。其加密的基本单元是“块”而不是单个单元。

- **基于树的[AMR](@entry_id:204220) (Tree-based [AMR](@entry_id:204220))**：这种策略使用[四叉树](@entry_id:753916)（二维）或[八叉树](@entry_id:144811)（三维）[数据结构](@entry_id:262134)。加密操作是递归地将单个“父”单元分裂成 $2^d$ 个“子”单元（$d$ 是空间维度）。其加密的基本单元是单个单元。这种精细的粒度使得网格能够非常灵活地贴合复杂和动态变化的界面，只需分裂或合并界面前沿的单元，而无需对整个区域进行重新聚类。

#### 守恒性的挑战与[通量修正](@entry_id:1125150)

[AMR](@entry_id:204220)的一个核心挑战是在粗细网格界面上维持[离散守恒](@entry_id:1123819)律。在一个标准的有限体积方法中，单元内[守恒量](@entry_id:161475)的变化由通过其边界的通量净和决定。在粗细网格边界处，一个粗单元的面会对应多个细单元的面。由于粗细网格上的通量是使用不同分辨率的数据在不同时间步长上计算的，粗单元面上的通量与对应的细单元面上的通量之和通常不相等。
$$ \mathcal{F}_{\text{coarse}} \neq \sum_{\text{fine faces}} \mathcal{F}_{\text{fine}} $$
这种通量不匹配会在粗细边界上引入人为的源或汇，从而破坏全局守恒性。

为了解决这个问题，块结构[AMR](@entry_id:204220)采用了一种称为**[通量修正](@entry_id:1125150)**（refluxing）的机制 。其工作原理如下：
1.  **设置通量寄存器**：在每个粗细网格界面上关联一个“通量寄存器”[数据结构](@entry_id:262134)。
2.  **累积通量**：在一个粗时间步内，首先将粗网格计算出的通过界面的总通量**存入**寄存器。然后，在细网格的每个子步中，将细网格计算出的通过相应界面的总通量从寄存器中**减去**。
3.  **计算失配**：在粗时间步和所有细时间子步都完成后，寄存器中剩下的值就是该界面上的净通量失配。
4.  **施加修正**：将这个通量失配值（或其负值，取决于约定）重新加回到界面旁的粗网格单元中。这等效于将通量失配作为源项作用于粗单元，从而精确地修正因分辨率不同而造成的[守恒量](@entry_id:161475)损失或增益。

从数学上讲，通量失配 $\mathcal{M}$ 和施加到粗单元平均值上的修正项 $\mathcal{R}$ 可以精确推导。对于一个二维垂直界面，一个粗时间步 $\Delta t_c$ 和 $r_t$ 个细[时间子步](@entry_id:755594)，以及沿界面 $r$ 个细分段，它们的形式为 ：
- **通量密度失配**:
  $$ \mathcal{M} = \left( \frac{1}{r r_t} \sum_{m=1}^{r_t} \sum_{k=1}^{r} \widehat{F}^{f,(m)}_{k} \right) - \widehat{F}^{c} $$
- **施加到粗单元的修正项**:
  $$ \mathcal{R} = \frac{\Delta t_c}{\Delta x_c} \left[ \widehat{F}^{c} - \left( \frac{1}{r r_t} \sum_{m=1}^{r_t} \sum_{k=1}^{r} \widehat{F}^{f,(m)}_{k} \right) \right] $$
其中 $\widehat{F}^c$ 和 $\widehat{F}^f$ 分别是粗细网格上的数值通量密度。这一过程确保了跨越整个分层网格的[离散守恒](@entry_id:1123819)律得以严格满足。

#### 网格间数据传递：限制与延拓

除了[通量修正](@entry_id:1125150)，[AMR](@entry_id:204220)还需要一套精确的算子在不同层级的网格之间传递数据 。

- **限制 (Restriction)**：将数据从细网格传递到粗网格。一个**守恒的[限制算子](@entry_id:754316)**必须保证粗单元上的[守恒量](@entry_id:161475)等于其覆盖的所有细单元上[守恒量](@entry_id:161475)之和。对于单元平均的标量 $\phi$，这意味着体积加权平均：
  $$ \phi_c = \frac{1}{|C_c|} \sum_{i=1}^N |C_{f,i}| \phi_{f,i} $$
  对于出现在通量中的矢量（如速度）或张量（如应力），守恒[限制算子](@entry_id:754316)必须保证粗网格面上的[通量积分](@entry_id:138365)等于对应的细网格面上[通量积分](@entry_id:138365)之和。这对于维持诸如不可压性（$\nabla \cdot \mathbf{u} = 0$）等约束至关重要。

- **延拓 (Prolongation)**：将数据从粗网格传递到细网格，通常用于为细网格提供边界条件（“[鬼点](@entry_id:177889)”）。为了不降低整体精度，[延拓算子](@entry_id:749192)必须是**高阶的**（例如，使用分片[多项式插值](@entry_id:145762)而非简单的常数复制），并且同样需要是**守恒的**和**约束保持的**。例如，对速度场进行延拓时，必须确保插值后的细网格速度场仍然满足离散的不可压条件。对于像VOF中的体积分数这样的有界量，[延拓算子](@entry_id:749192)还必须保证插值结果保持在物理范围（如 $[0, 1]$）内，以避免产生非物理的过冲或下冲。

设计优良的限制和[延拓算子](@entry_id:749192)，是减少[AMR](@entry_id:204220)层级间虚假质量和动量传递，抑制寄生流等数值噪声的关键。

### 实践中的挑战：时间步长管理

在AMR模拟中，一个重大的实践挑战是如何管理时间步长。显式时间积分格式的稳定性受到Courant-Friedrichs-Lewy (CFL)条件的严格限制。

#### [局部稳定性](@entry_id:751408)约束

对于包含对流、扩散和毛细效应的流动，[稳定时间步长](@entry_id:755325) $\Delta t$ 受到三个主要物理过程的限制 ：

- **对流约束**: 时间步长必须小于流体质点穿越一个网格单元所需的时间。
  $$ \Delta t_{\text{conv}} \le C_c \frac{h}{|u|} $$
- **粘性约束**: 来[自扩散](@entry_id:754665)项的稳定性要求，时间步长与网格尺寸的平方成正比。
  $$ \Delta t_{\text{visc}} \le C_v \frac{h^2}{\nu} $$
  其中 $\nu = \mu/\rho$ 是[运动粘度](@entry_id:275614)。
- **毛细约束**: 来自表面张力项，它会产生[毛细波](@entry_id:159434)。对于[显式格式](@entry_id:1124773)，其稳定性通常由网格上可解析的最短波的传播速度决定，导致一个独特的[标度关系](@entry_id:273705)：
  $$ \Delta t_{\text{cap}} \le C_\sigma \sqrt{\frac{\rho h^3}{\sigma}} $$

在AMR中，网格尺寸 $h$ 是随空间变化的。由于粘性和毛细约束对 $h$ 的高度敏感性（分别是 $h^2$ 和 $h^{3/2}$），最精细的网格层级（$h$ 最小）通常会给出最严格的[时间步长限制](@entry_id:756010)。

#### 全局时间步与[子循环](@entry_id:755594)

如果整个多层级网格系统采用单一的全局时间步长 $\Delta t$，那么这个 $\Delta t$ 必须小于**所有层级上所有单元中**最严格的稳定性极限。这通常意味着全局时间步由最精细网格上的最快物理过程决定，这对于计算成本较低的粗网格层级来说是极其低效的。

为了克服这一瓶颈，[AMR](@entry_id:204220)的标准实践是采用**时间子循环**（time sub-cycling）。其思想是，让不同层级的网格以各自的局部稳定时间步长演进。在一个典型的双层级实现中，细网格层级（$\ell=1$）在粗网格层级（$\ell=0$）演进一个时间步 $\Delta t_0$ 的同时，会演进 $r_t$ 个大小为 $\Delta t_1 = \Delta t_0 / r_t$ 的子步。

选择合适的 $\Delta t_0$ 和 $\Delta t_1$ 必须同时满足所有稳定性要求。令 $\Delta t_{0,\text{stable}}$ 和 $\Delta t_{1,\text{stable}}$ 分别为粗、细层级各自的[稳定时间](@entry_id:273984)步上限。则一个鲁棒的[子循环](@entry_id:755594)策略是 ：
1.  确定细网格的时间步：$\Delta t_1 = \Delta t_{1,\text{stable}}$。
2.  确定粗网格的时间步，它既要满足自身的稳定性，又要与细网格同步。因此，$\Delta t_0$ 必须小于 $\Delta t_{0,\text{stable}}$，并且等于 $r_t$ 个细网格步长。综合起来，粗网格步长由以下条件决定：
    $$ \Delta t_0 = \min(\Delta t_{0,\text{stable}}, r_t \cdot \Delta t_{1,\text{stable}}) $$
3.  最终的细网格步长被设为 $\Delta t_1 = \Delta t_0 / r_t$，以确保粗细网格的时间步是精确的整数倍关系。

这种[子循环](@entry_id:755594)策略使得每个层级都能以接近其最优效率的时间步长进行计算，从而极大地提高了[AMR](@entry_id:204220)模拟的整体性能，使其成为处理[复杂流体](@entry_id:198415)中多尺度物理现象的强大而实用的工具。