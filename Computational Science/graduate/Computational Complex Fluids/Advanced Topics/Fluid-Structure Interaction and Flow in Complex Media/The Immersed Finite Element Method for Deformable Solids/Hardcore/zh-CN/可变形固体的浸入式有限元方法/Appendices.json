{
    "hands_on_practices": [
        {
            "introduction": "为了精确模拟可变形固体的行为，我们首先需要一个描述其内部受力状态的本构模型。本练习将引导你从一个基本的超弹性材料应变能密度函数出发，推导出第一皮奥拉-基尔霍夫应力张量 。通过这个过程，你将掌握如何利用虚功原理处理不可压缩性约束，并理解作为拉格朗日乘子的固体压力 $p_s$ 的物理意义，这是建立任何固体有限元模型的基础。",
            "id": "4108493",
            "problem": "考虑一个均质、不可压缩的新胡克固体，其占据一个参考构型。该固体的变形梯度为 $\\mathbf{F}$，雅可比行列式为 $J=\\det \\mathbf{F}$，右柯西-格林张量为 $\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。该材料由等容应变能密度 $W_{\\mathrm{iso}}(\\mathbf{F})=\\frac{\\mu_{s}}{2}\\left(\\operatorname{tr}\\,\\mathbf{C}-3\\right)$ 建模，其中 $\\mu_{s}0$ 是剪切模量。在用于流固耦合的浸入式有限元法 (IFEM) 中，通过引入一个称为固体压力的拉格朗日乘子场 $p_{s}$ 来对固体施加不可压缩约束 $J=1$。\n\n从超弹性固体的虚功原理和第一皮奥拉-基尔霍夫应力作为 $\\mathbf{F}$ 的功共轭的定义出发，并通过一个拉格朗日乘子将能量增加一个与 $J-1$ 成正比的约束项来处理不可压缩性，推导第一皮奥拉-基尔霍夫应力张量 $\\mathbf{P}(\\mathbf{F},p_{s})$ 关于 $\\mu_{s}$、$\\mathbf{F}$ 和 $p_{s}$ 的显式闭合形式表达式。在推导过程中，解释 $p_{s}$ 的作用，并论证为何所选的符号约定使得 $p_{s}$ 在当前构型中充当静水压力。\n\n将最终答案表示为关于 $\\mu_{s}$、$\\mathbf{F}$ 和 $p_{s}$ 的单个解析张量表达式。不需要进行数值计算。最终表达式中不要包含单位。",
            "solution": "该问题要求推导均质、不可压缩新胡克固体的第一皮奥拉-基尔霍夫应力张量 $\\mathbf{P}$。推导从超弹性材料的虚功原理开始，其中不可压缩性通过拉格朗日乘子 $p_s$ 来施加。\n\n对于具有体积约束的超弹性材料，总应变能密度函数采用混合法来构建。总能量密度 $W$ 通过一个施加不可压缩约束 $J = \\det(\\mathbf{F}) = 1$ 的项进行增广。应变能密度的等容（保体积）部分由 $W_{\\mathrm{iso}}(\\mathbf{F}) = \\frac{\\mu_{s}}{2}\\left(\\operatorname{tr}\\,\\mathbf{C}-3\\right)$ 给出，其中 $\\mu_s  0$ 是剪切模量，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 是右柯西-格林张量。\n\n约束条件为 $J-1=0$。在混合列式中，该约束通过拉格朗日乘子场 $p_s$ 被纳入势能泛函。我们将总应变能密度 $W$ 定义为：\n$$\nW(\\mathbf{F}, p_s) = W_{\\mathrm{iso}}(\\mathbf{F}) - p_s(J-1)\n$$\n拉格朗日乘子项选择负号是一种约定。稍后将证明，这种选择使得 $p_s$ 可以被直接解释为热力学压力（$p_s$ 的正值对应于压缩应力状态）。\n\n第一皮奥拉-基尔霍夫应力张量 $\\mathbf{P}$ 是变形梯度 $\\mathbf{F}$ 的功共轭。此关系表示为应变能密度对 $\\mathbf{F}$ 的导数：\n$$\n\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}} = \\frac{\\partial}{\\partial \\mathbf{F}} \\left[ W_{\\mathrm{iso}}(\\mathbf{F}) - p_s(J-1) \\right]\n$$\n我们可以分别计算每一项的导数。\n\n首先，我们计算等容部分 $W_{\\mathrm{iso}}$ 的导数。\n$$\nW_{\\mathrm{iso}}(\\mathbf{F}) = \\frac{\\mu_{s}}{2}\\left(\\operatorname{tr}(\\mathbf{C})-3\\right) = \\frac{\\mu_{s}}{2}\\left(\\operatorname{tr}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F})-3\\right) = \\frac{\\mu_{s}}{2}\\left( (\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}) : \\mathbf{I} - 3 \\right)\n$$\n其中 $\\mathbf{I}$ 是二阶单位张量。使用标准张量微积分恒等式 $\\frac{\\partial}{\\partial \\mathbf{A}}\\left(\\operatorname{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{A})\\right) = 2\\mathbf{A}$，我们得到：\n$$\n\\frac{\\partial W_{\\mathrm{iso}}}{\\partial \\mathbf{F}} = \\frac{\\mu_s}{2} \\frac{\\partial}{\\partial \\mathbf{F}} \\left( \\operatorname{tr}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}) \\right) = \\frac{\\mu_s}{2} (2\\mathbf{F}) = \\mu_s \\mathbf{F}\n$$\n\n接下来，我们计算约束项的导数。在这种混合列式中，$p_s$ 是一个独立的场，因此在对 $\\mathbf{F}$ 求导时我们将其视为常数。\n$$\n\\frac{\\partial}{\\partial \\mathbf{F}} \\left[ -p_s(J-1) \\right] = -p_s \\frac{\\partial J}{\\partial \\mathbf{F}}\n$$\n张量 $\\mathbf{F}$ 的行列式对 $\\mathbf{F}$ 的导数由雅可比公式给出：\n$$\n\\frac{\\partial J}{\\partial \\mathbf{F}} = J (\\mathbf{F}^{-1})^{\\mathsf{T}} = J \\mathbf{F}^{-\\mathsf{T}}\n$$\n因此，约束项的贡献为 $-p_s J \\mathbf{F}^{-\\mathsf{T}}$。\n\n结合这两个部分，第一皮奥拉-基尔霍夫应力张量的表达式为：\n$$\n\\mathbf{P} = \\mu_s \\mathbf{F} - p_s J \\mathbf{F}^{-\\mathsf{T}}\n$$\n拉格朗日乘子 $p_s$ 的存在是为了施加不可压缩约束 $J=1$。在不可压缩固体模型的背景下，此约束是满足的。将 $J=1$ 代入 $\\mathbf{P}$ 的表达式，得到不可压缩材料中应力的最终形式：\n$$\n\\mathbf{P} = \\mu_s \\mathbf{F} - p_s \\mathbf{F}^{-\\mathsf{T}}\n$$\n\n现在，我们来解释 $p_s$ 的作用并论证所选的符号约定。$p_s$ 的作用是作为拉格朗日乘子，施加不可压缩性的运动学约束；物理上，它代表了固体内部为保持体积恒定而因变形产生的静水压力。为了清楚地看到这一点，我们将第一皮奥拉-基尔霍夫应力 $\\mathbf{P}$（作用于参考构型）转换到柯西应力 $\\boldsymbol{\\sigma}$（作用于当前的变形构型）。该关系通过前推操作给出：\n$$\n\\boldsymbol{\\sigma} = J^{-1} \\mathbf{P} \\mathbf{F}^{\\mathsf{T}}\n$$\n由于 $J=1$，这简化为 $\\boldsymbol{\\sigma} = \\mathbf{P} \\mathbf{F}^{\\mathsf{T}}$。代入我们的 $\\mathbf{P}$ 表达式：\n$$\n\\boldsymbol{\\sigma} = \\left( \\mu_s \\mathbf{F} - p_s \\mathbf{F}^{-\\mathsf{T}} \\right) \\mathbf{F}^{\\mathsf{T}} = \\mu_s \\mathbf{F} \\mathbf{F}^{\\mathsf{T}} - p_s \\mathbf{F}^{-\\mathsf{T}} \\mathbf{F}^{\\mathsf{T}}\n$$\n我们识别出左柯西-格林张量 $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$。对于第二项，我们使用恒等式 $(\\mathbf{A}^{-1})^{\\mathsf{T}} = (\\mathbf{A}^{\\mathsf{T}})^{-1}$，这得到 $\\mathbf{F}^{-\\mathsf{T}} \\mathbf{F}^{\\mathsf{T}} = (\\mathbf{F}^{\\mathsf{T}})^{-1} \\mathbf{F}^{\\mathsf{T}} = \\mathbf{I}$。\n因此，柯西应力为：\n$$\n\\boldsymbol{\\sigma} = \\mu_s \\mathbf{B} - p_s \\mathbf{I}\n$$\n此表达式表明，柯西应力由一个与剪切变形相关的偏量部分 $\\mu_s \\mathbf{B}$ 和一个球形（静水）部分 $-p_s \\mathbf{I}$ 组成。在力学中，按照约定，压应力为负，而压力是与压缩相关的正标量。对应于静水压力 $p$ 的应力状态是 $-p\\mathbf{I}$。通过将 $-p\\mathbf{I}$ 与我们推导出的项 $-p_s \\mathbf{I}$ 进行比较，我们发现 $p_s$ 与力学压力 $p$ 是相同的。因此，我们在增广能量函数 $W = W_{\\mathrm{iso}} - p_s(J-1)$ 中最初选择负号是合理的，因为它使得拉格朗日乘子 $p_s$ 直接代表了物理上的静水压力。\n\n因此，对于不可压缩材料，第一皮奥拉-基尔霍夫应力张量 $\\mathbf{P}(\\mathbf{F},p_{s})$ 关于 $\\mu_{s}$、$\\mathbf{F}$ 和 $p_{s}$ 的最终闭合形式表达式为 $\\mathbf{P} = \\mu_s \\mathbf{F} - p_s \\mathbf{F}^{-\\mathsf{T}}$。",
            "answer": "$$\n\\boxed{\\mu_{s} \\mathbf{F} - p_{s} \\mathbf{F}^{-\\mathsf{T}}}\n$$"
        },
        {
            "introduction": "将连续介质力学中的应力概念转化为可计算的离散力是有限元方法的核心。本练习是一个具体的编程实践，你将学习如何将前一阶段得到的应力张量（例如，来自新胡克模型）应用于一个简单的有限元单元（线性三角形），并计算出作用于网格节点上的弹性力 。这项技能是将连续体模型付诸于计算机模拟的关键一步，让你能够亲手实现驱动固体变形的计算引擎。",
            "id": "4108443",
            "problem": "考虑一个在参考构型中通过线性三角形有限元离散的二维可变形固体，该固体遵循浸入式方法嵌入在流体中。浸入式有限元法计算固体积分点处的弹性力密度，并组装节点力，这些节点力随后被施加到流体上。您的任务是使用第一皮奥拉-基尔霍夫应力张量和参考构型中形函数的梯度，推导并实现固体积分点处弹性力密度的计算，并组装节点内力向量。\n\n从超弹性固体的参考构型中的虚功原理和第一皮奥拉-基尔霍夫应力的定义开始。设参考域由 $\\Omega_0 \\subset \\mathbb{R}^2$ 表示，位形映射为 $\\boldsymbol{x}(\\boldsymbol{X})$，变形梯度为 $\\boldsymbol{F} = \\nabla_{\\boldsymbol{X}} \\boldsymbol{x}$。对于一个变分 $\\delta \\boldsymbol{u}$，内虚功由以下经过充分检验的公式给出\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0,\n$$\n其中 $\\boldsymbol{P}$ 是第一皮奥拉-基尔霍夫应力张量。使用有限元形函数 $N_a(\\boldsymbol{X})$ 将虚位移表示为 $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_a \\delta \\boldsymbol{d}_a N_a(\\boldsymbol{X})$，其中 $\\delta \\boldsymbol{d}_a$ 是节点变分。这导出一个满足以下条件的节点内力向量 $\\{\\boldsymbol{F}_a\\}$：\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a, \\quad \\text{with} \\quad \\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0.\n$$\n将与节点 $a$ 相关的固体积分点 $\\boldsymbol{X}_q$ 处的弹性力密度贡献定义为向量\n$$\n\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P}(\\boldsymbol{X}_q) \\, \\nabla_{\\boldsymbol{X}} N_a(\\boldsymbol{X}_q),\n$$\n其单位为 $\\mathrm{N}/\\mathrm{m}^3$（单位参考体积的力）。使用权重为 $w_q$（对于二维参考域，在平面外单位厚度的假设下，单位为 $\\mathrm{m}^2$）的数值积分，节点力被组装为\n$$\n\\boldsymbol{F}_a \\approx \\sum_q w_q \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q),\n$$\n其单位为 $\\mathrm{N}$。\n\n对于线性三角形单元，形函数梯度 $\\nabla_{\\boldsymbol{X}} N_a$ 在整个单元上是常数，并且可以直接从参考节点坐标计算。线性三角形的变形梯度在单元内是常数，可以计算为：\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a,\n$$\n其中 $\\boldsymbol{x}_a$ 是节点的当前坐标，$\\otimes$ 表示张量（外）积。\n\n对于本构模型，考虑一个可压缩新胡克超弹性固体，其应变能密度为\n$$\n\\Psi(\\boldsymbol{F}) = \\frac{\\mu}{2} \\left( \\boldsymbol{F} : \\boldsymbol{F} - 2 \\right) - \\mu \\ln J + \\frac{\\lambda}{2} (\\ln J)^2,\n$$\n其中 $J = \\det \\boldsymbol{F}$，拉梅参数 $\\mu = \\frac{E}{2(1+\\nu)}$ 和 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 用杨氏模量 $E$ 和泊松比 $\\nu$ 表示。相应的第一皮奥拉-基尔霍夫应力为\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}.\n$$\n\n实现一个程序，对每个指定的测试用例，计算：\n1. 对于 $a=1,2,3$ 的形函数梯度 $\\nabla_{\\boldsymbol{X}} N_a$。\n2. 使用线性三角形公式计算形心积分点处的变形梯度 $\\boldsymbol{F}$。\n3. 使用可压缩新胡克定律计算第一皮奥拉-基尔霍夫应力 $\\boldsymbol{P}$。\n4. 在形心处的弹性力密度向量 $\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$。\n5. 使用权重为 $w = A$（单元面积）的单点形心积分，计算节点力 $\\boldsymbol{F}_a = w \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q)$，假设平面外单位厚度。\n\n以牛顿（N）为单位表示最终的节点力。角度单位不适用。输出必须为浮点数。\n\n测试套件：\n- 用例 1（一般变形，中等可压缩性）：参考三角形节点 $\\boldsymbol{X}_1=(0,0)$，$\\boldsymbol{X}_2=(1,0)$，$\\boldsymbol{X}_3=(0,1)$，当前节点 $\\boldsymbol{x}_1=(0.00,0.00)$，$\\boldsymbol{x}_2=(1.05,0.02)$，$\\boldsymbol{x}_3=(-0.01,1.10)$，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$，$\\nu=0.35$。\n- 用例 2（均匀膨胀）：参考三角形与用例 1 相同，当前节点由均匀缩放 $\\boldsymbol{x}_a = \\alpha \\boldsymbol{X}_a$ 给出，其中 $\\alpha = 1.02$，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$，$\\nu=0.35$。\n- 用例 3（近不可压缩材料）：几何形状和当前节点与用例 1 相同，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$，$\\nu=0.49$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身也必须是一个用方括号括起来的逗号分隔列表，其中包含节点 1、2、3 的节点力分量，顺序为 $[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]$，单位为牛顿，每个浮点数格式化为六位小数。例如，输出必须如下所示：\n$$\n[\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]\\,].\n$$",
            "solution": "问题陈述经过严格验证并确认有效。其科学基础在于连续介质力学和有限元法的原理，问题是适定的、客观的，并为获得唯一解提供了完整且一致的信息集。任务是在指定的变形和材料属性下，计算一个二维线性三角形单元的节点弹性力。\n\n问题的核心在于有限元背景下虚功原理的应用。内虚功 $\\delta W_{\\text{int}}$ 等同于节点力 $\\boldsymbol{F}_a$ 在虚节点位移 $\\delta \\boldsymbol{d}_a$ 下所做的功：\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a\n$$\n问题使用第一皮奥拉-基尔霍夫应力张量 $\\boldsymbol{P}$ 提供了内虚功的连续介质力学表达式：\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0\n$$\n其中 $\\Omega_0$ 是参考域。通过将虚位移的有限元近似 $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_b N_b(\\boldsymbol{X}) \\delta \\boldsymbol{d}_b$ 代入积分，我们得到节点 $a$ 处的节点力表达式：\n$$\n\\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0\n$$\n对于一个在平面外单位厚度 $t=1$ 的一般假设下分析的二维问题，参考体积元 $\\mathrm{d}\\Omega_0$ 变为 $t \\cdot \\mathrm{d}A_0 = \\mathrm{d}A_0$，其中 $\\mathrm{d}A_0$ 是参考面积元。积分在单元面积 $A_e$ 上进行。对于线性三角形单元，量 $\\boldsymbol{P}$ 和 $\\nabla_{\\boldsymbol{X}} N_a$ 在单元内是常数。因此，在形心处的单点积分是精确的：\n$$\n\\boldsymbol{F}_a = \\left( \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\right) \\int_{A_e} \\mathrm{d}A_0 = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\n其中 $A_e$ 是参考构型中单元的面积。问题将力密度定义为 $\\boldsymbol{g}_a = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$，积分权重定义为 $w = A_e$，这与此公式一致。\n\n解决方案通过对每个测试用例执行五个指定的计算步骤来进行。\n\n**步骤 1：形函数梯度**\n对于在参考构型中具有顶点 $\\boldsymbol{X}_1, \\boldsymbol{X}_2, \\boldsymbol{X}_3$ 的二维线性三角形单元，重心形函数 $N_a(\\boldsymbol{X})$ 的梯度是由以下公式给出的常向量：\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\frac{1}{2A_e} \\begin{pmatrix} Y_2 - Y_3 \\\\ X_3 - X_2 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\frac{1}{2A_e} \\begin{pmatrix} Y_3 - Y_1 \\\\ X_1 - X_3 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\frac{1}{2A_e} \\begin{pmatrix} Y_1 - Y_2 \\\\ X_2 - X_1 \\end{pmatrix}\n$$\n其中 $A_e$ 是参考三角形的面积：\n$$\nA_e = \\frac{1}{2} \\det \\begin{pmatrix} X_2 - X_1  Y_2 - Y_1 \\\\ X_3 - X_1  Y_3 - Y_1 \\end{pmatrix} = \\frac{1}{2} |(X_2-X_1)(Y_3-Y_1) - (X_3-X_1)(Y_2-Y_1)|\n$$\n对于所有测试用例中给定的特定参考三角形，其顶点为 $\\boldsymbol{X}_1 = (0,0)$、$\\boldsymbol{X}_2 = (1,0)$ 和 $\\boldsymbol{X}_3 = (0,1)$，面积为 $A_e = 0.5$。梯度为：\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n**步骤 2：变形梯度**\n变形梯度 $\\boldsymbol{F}$ 对于线性单元是常数，由以下公式给出：\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a\n$$\n其中 $\\boldsymbol{x}_a$ 是当前节点坐标。对于特定的参考三角形几何形状，该和简化为：\n$$\n\\boldsymbol{F} = \\boldsymbol{x}_1 \\otimes \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + \\boldsymbol{x}_2 \\otimes \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\boldsymbol{x}_3 \\otimes \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} x_{2x} - x_{1x}  x_{3x} - x_{1x} \\\\ x_{2y} - x_{1y}  x_{3y} - x_{1y} \\end{pmatrix}\n$$\n将为每个测试用例中指定的当前节点坐标 $\\{\\boldsymbol{x}_a\\}$ 计算该矩阵。\n\n**步骤 3：第一皮奥拉-基尔霍夫应力**\n可压缩新胡克材料的本构律为：\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}\n$$\n首先，从杨氏模量 $E$ 和泊松比 $\\nu$ 计算拉梅参数 $\\mu$ 和 $\\lambda$：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\quad \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}\n$$\n接下来，从步骤 2 中获得的变形梯度 $\\boldsymbol{F}$ 计算运动学量 $J = \\det \\boldsymbol{F}$ 和逆转置 $\\boldsymbol{F}^{-T}$。然后将这些值代入本构方程以求得应力张量 $\\boldsymbol{P}$。\n\n**步骤 4：弹性力密度**\n每个节点 $a$ 的弹性力密度贡献通过矩阵-向量乘积计算：\n$$\n\\boldsymbol{g}_a = \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a\n$$\n对每个节点 $a \\in \\{1,2,3\\}$ 执行此计算，产生三个力密度向量 $\\boldsymbol{g}_1, \\boldsymbol{g}_2, \\boldsymbol{g}_3$。\n\n**步骤 5：节点力**\n每个节点 $a$ 的最终节点力使用单点积分进行组装，这简化为标量乘法：\n$$\n\\boldsymbol{F}_a = A_e \\cdot \\boldsymbol{g}_a = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\n对于给定的参考单元，$A_e = 0.5$，力的计算方式为 $\\boldsymbol{F}_a = 0.5 \\cdot \\boldsymbol{g}_a$。内力的一个基本属性是它们必须处于平衡状态，即它们在单元上的总和为零：$\\sum_{a=1}^3 \\boldsymbol{F}_a = \\boldsymbol{0}$。由于 $\\sum_a \\nabla_{\\boldsymbol{X}} N_a = \\boldsymbol{0}$，该属性可作为实现的一个有价值的验证。$\\boldsymbol{F}_1, \\boldsymbol{F}_2, \\boldsymbol{F}_3$ 的最终分量构成每个用例的输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal elastic forces for a 2D linear triangular finite element\n    using a compressible Neo-Hookean model.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": 1.02 * np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.49,\n        },\n    ]\n\n    results_all_cases = []\n\n    for case in test_cases:\n        X_nodes = case[\"X_nodes\"]\n        x_nodes = case[\"x_nodes\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n\n        X1, X2, X3 = X_nodes[0, :], X_nodes[1, :], X_nodes[2, :]\n        x1, x2, x3 = x_nodes[0, :], x_nodes[1, :], x_nodes[2, :]\n\n        # Step 1: Calculate reference area and shape function gradients\n        # Area of the reference triangle\n        A_e = 0.5 * np.linalg.det(\n            np.array([[X2[0] - X1[0], X2[1] - X1[1]], [X3[0] - X1[0], X3[1] - X1[1]]])\n        )\n\n        # Gradients of shape functions\n        grad_N1 = (0.5 / A_e) * np.array([X2[1] - X3[1], X3[0] - X2[0]])\n        grad_N2 = (0.5 / A_e) * np.array([X3[1] - X1[1], X1[0] - X3[0]])\n        grad_N3 = (0.5 / A_e) * np.array([X1[1] - X2[1], X2[0] - X1[0]])\n        \n        grads_N = [grad_N1, grad_N2, grad_N3]\n\n        # Step 2: Calculate the deformation gradient F\n        F = np.zeros((2, 2))\n        for i in range(3):\n            F += np.outer(x_nodes[i], grads_N[i])\n        \n        # Step 3: Calculate the first Piola-Kirchhoff stress P\n        # Lamé parameters\n        mu = E / (2 * (1 + nu))\n        lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n        # Kinematic quantities\n        J = np.linalg.det(F)\n        if J == 0:\n            raise ValueError(\"Element inverted: J = 0\")\n        \n        F_inv_T = np.linalg.inv(F).T\n\n        # First Piola-Kirchhoff stress tensor\n        P = mu * (F - F_inv_T) + lmbda * np.log(J) * F_inv_T\n\n        # Steps 4  5: Calculate force densities and nodal forces\n        nodal_forces = []\n        for i in range(3):\n            # Elastic force density g_a = P * grad_N_a\n            g_a = P @ grads_N[i]\n            # Nodal force F_a = A_e * g_a\n            F_a = A_e * g_a\n            nodal_forces.extend(F_a)\n\n        results_all_cases.append(nodal_forces)\n\n    # Format output string\n    formatted_cases = []\n    for forces in results_all_cases:\n        case_str = \",\".join([f\"{f:.6f}\" for f in forces])\n        formatted_cases.append(f\"[{case_str}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "浸入式方法的核心挑战在于处理拉格朗日固体网格与欧拉流体网格之间的信息传递。这种耦合通常通过一个光滑的核函数（或插值函数）来实现。本练习聚焦于这一关键机制，要求你分析一个特定的四点核函数，并验证其是否满足单位分解和一阶矩条件 。理解并验证这些数学性质至关重要，因为它们直接关系到耦合方案的精度和守恒性，是保证整个流固耦合模拟稳定可靠的基石。",
            "id": "4108474",
            "problem": "在用于处理可变形固体与复杂流体相互作用的浸入式有限元法 (IFEM) 中，拉格朗日固体网格和欧拉流体网格之间的耦合通常通过一个可分离的、正则化的 delta 核函数来实现。考虑一个间距为 $h$ 的均匀笛卡尔欧拉网格，并设一个拉格朗日点位于 $(x,y,z)$，其归一化坐标为 $(x/h,y/h,z/h)=(1.3,2.7,3.1)$。用于在拉格朗日点上采样欧拉场的插值权重由一维四点核函数 $\\phi(r)$ 构建，对于 $r \\geq 0$，其定义如下：\n$$\n\\phi(r)=\n\\begin{cases}\n\\frac{1}{8}\\left(3-2r+\\sqrt{1+4r-4r^{2}}\\right),  0\\leq r\\leq 1, \\\\[6pt]\n\\frac{1}{8}\\left(5-2r-\\sqrt{-7+12r-4r^{2}}\\right),  1 r\\leq 2, \\\\[6pt]\n0,  r> 2.\n\\end{cases}\n$$\n三维插值权重是可分离的乘积\n$$\nw_{i,j,k}=\\phi\\!\\left(|i-x/h|\\right)\\,\\phi\\!\\left(|j-y/h|\\right)\\,\\phi\\!\\left(|k-z/h|\\right),\n$$\n其中 $(i,j,k)\\in\\mathbb{Z}^{3}$ 是每个坐标方向上的欧拉网格索引。对于给定的 $(x/h,y/h,z/h)$，确定每个方向上贡献权重的四个索引，计算相应的一维权重 $\\{w^{x}_{i}\\}$、$\\{w^{y}_{j}\\}$ 和 $\\{w^{z}_{k}\\}$，并用它们以乘积形式指定非零的三维权重 $w_{i,j,k}$。然后，验证单位分解和一阶矩条件：\n$$\n\\sum_{i,j,k} w_{i,j,k}=1,\\quad\n\\sum_{i,j,k} i\\,w_{i,j,k}=\\frac{x}{h},\\quad\n\\sum_{i,j,k} j\\,w_{i,j,k}=\\frac{y}{h},\\quad\n\\sum_{i,j,k} k\\,w_{i,j,k}=\\frac{z}{h}.\n$$\n报告单位分解总和 $S$ 与三个一阶矩 $M_{x}$、$M_{y}$、$M_{z}$ 组成的最终元组 $\\left(S,M_{x},M_{y},M_{z}\\right)$。以无量纲形式表示最终元组。无需四舍五入。",
            "solution": "用户希望通过以下步骤解决问题：\n1.  **问题验证：** 首先对问题的科学性、完整性和客观性进行验证。\n    -   **已知条件：** 问题给出了一个拉格朗日点的归一化坐标 $(x/h, y/h, z/h) = (1.3, 2.7, 3.1)$，一个特定的四点核函数 $\\phi(r)$，可分离的三维权重 $w_{i,j,k}$ 的定义，以及需要验证的单位分解和一阶矩条件。\n    -   **验证：** 该问题具有科学依据，描述了计算力学（浸入式有限元法）中的一种标准插值方案。核函数 $\\phi(r)$ 是一个定义良好、连续、具有紧支集的逐段函数，是此类应用的典型特征。该问题是适定的、客观的，并包含获得唯一解所需的所有信息。\n    -   **结论：** 问题有效。\n\n2.  **解题策略：** 问题的核心是计算每个坐标方向上的一维 (1D) 权重，然后利用三维权重的可分离性来验证所需的性质。\n    -   单位分解 $(S)$ 和一阶矩 $(M_x, M_y, M_z)$ 的三维求和可以分解为一维求和的乘积。\n    -   对于每个坐标，我们根据 $\\phi(r)$ 的紧支集确定有贡献的整数网格索引。\n    -   然后我们计算每个方向的一维权重，并验证一维的单位分解和一阶矩性质。\n    -   最后，我们根据一维结果组合出三维结果。\n\n### 步骤 1：初步设置\n设拉格朗日点的归一化坐标为 $x' = x/h = 1.3$，$y' = y/h = 2.7$ 和 $z' = z/h = 3.1$。三维插值权重由一维核函数的可分离乘积给出：\n$$\nw_{i,j,k} = \\phi\\left(|i - x'|\\right) \\, \\phi\\left(|j - y'|\\right) \\, \\phi\\left(|k - z'|\\right)\n$$\n我们定义每个方向上的一维权重如下：\n$$\nw^{x}_{i} = \\phi(|i-x'|), \\quad w^{y}_{j} = \\phi(|j-y'|), \\quad w^{z}_{k} = \\phi(|k-z'|)\n$$\n核函数 $\\phi(r)$ 仅在 $0 \\le r  2$ 时非零。因此，权重 $w^x_i$、$w^y_j$ 和 $w^z_k$ 仅在网格索引 $i, j, k$ 分别满足 $|i-x'|  2$、$|j-y'|  2$ 和 $|k-z'|  2$ 时非零。\n\n### 步骤 2：一维权重和性质的计算\n\n**对于 x 方向 ($x' = 1.3$)：**\n有贡献的索引 $i$ 必须满足 $|i - 1.3|  2$，这意味着 $-0.7  i  3.3$。整数索引为 $i \\in \\{0, 1, 2, 3\\}$。\n核函数的自变量为：\n-   $i=0$：$r = |0 - 1.3| = 1.3$。这在区间 $(1, 2]$ 内。\n-   $i=1$：$r = |1 - 1.3| = 0.3$。这在区间 $[0, 1]$ 内。\n-   $i=2$：$r = |2 - 1.3| = 0.7$。这在区间 $[0, 1]$ 内。\n-   $i=3$：$r = |3 - 1.3| = 1.7$。这在区间 $(1, 2]$ 内。\n\n我们使用给定的 $\\phi(r)$ 定义计算权重：\n-   $w^{x}_{0} = \\phi(1.3) = \\frac{1}{8}\\left(5 - 2(1.3) - \\sqrt{-7 + 12(1.3) - 4(1.3)^2}\\right) = \\frac{1}{8}\\left(2.4 - \\sqrt{1.84}\\right) = \\frac{12 - \\sqrt{46}}{40}$。\n-   $w^{x}_{1} = \\phi(0.3) = \\frac{1}{8}\\left(3 - 2(0.3) + \\sqrt{1 + 4(0.3) - 4(0.3)^2}\\right) = \\frac{1}{8}\\left(2.4 + \\sqrt{1.84}\\right) = \\frac{12 + \\sqrt{46}}{40}$。\n-   $w^{x}_{2} = \\phi(0.7) = \\frac{1}{8}\\left(3 - 2(0.7) + \\sqrt{1 + 4(0.7) - 4(0.7)^2}\\right) = \\frac{1}{8}\\left(1.6 + \\sqrt{1.84}\\right) = \\frac{8 + \\sqrt{46}}{40}$。\n-   $w^{x}_{3} = \\phi(1.7) = \\frac{1}{8}\\left(5 - 2(1.7) - \\sqrt{-7 + 12(1.7) - 4(1.7)^2}\\right) = \\frac{1}{8}\\left(1.6 - \\sqrt{1.84}\\right) = \\frac{8 - \\sqrt{46}}{40}$。\n\nx 方向的一维单位分解为：\n$$\n\\sum_{i} w^{x}_{i} = \\frac{(12 - \\sqrt{46}) + (12 + \\sqrt{46}) + (8 + \\sqrt{46}) + (8 - \\sqrt{46})}{40} = \\frac{12+12+8+8}{40} = \\frac{40}{40} = 1\n$$\nx 方向的一维一阶矩为：\n$$\n\\sum_{i} i \\, w^{x}_{i} = \\frac{0(12 - \\sqrt{46}) + 1(12 + \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(8 - \\sqrt{46})}{40} = \\frac{12+\\sqrt{46} + 16+2\\sqrt{46} + 24-3\\sqrt{46}}{40} = \\frac{52}{40} = \\frac{13}{10} = 1.3\n$$\n这与 $x'$ 相符。\n\n**对于 y 方向 ($y' = 2.7$)：**\n有贡献的索引 $j$ 必须满足 $|j - 2.7|  2$，这意味着 $0.7  j  4.7$。整数索引为 $j \\in \\{1, 2, 3, 4\\}$。\n自变量为 $r \\in \\{|1-2.7|, |2-2.7|, |3-2.7|, |4-2.7|\\} = \\{1.7, 0.7, 0.3, 1.3\\}$。这组自变量与 x 方向的相同。\n-   $w^{y}_{1} = \\phi(1.7) = \\frac{8 - \\sqrt{46}}{40}$。\n-   $w^{y}_{2} = \\phi(0.7) = \\frac{8 + \\sqrt{46}}{40}$。\n-   $w^{y}_{3} = \\phi(0.3) = \\frac{12 + \\sqrt{46}}{40}$。\n-   $w^{y}_{4} = \\phi(1.3) = \\frac{12 - \\sqrt{46}}{40}$。\n\n一维单位分解为 $\\sum_{j} w^{y}_{j} = 1$。一维一阶矩为：\n$$\n\\sum_{j} j \\, w^{y}_{j} = \\frac{1(8 - \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(12 + \\sqrt{46}) + 4(12 - \\sqrt{46})}{40} = \\frac{8- \\sqrt{46} + 16+2\\sqrt{46} + 36+3\\sqrt{46} + 48-4\\sqrt{46}}{40} = \\frac{108}{40} = \\frac{27}{10} = 2.7\n$$\n这与 $y'$ 相符。\n\n**对于 z 方向 ($z' = 3.1$)：**\n有贡献的索引 $k$ 必须满足 $|k - 3.1|  2$，这意味着 $1.1  k  5.1$。整数索引为 $k \\in \\{2, 3, 4, 5\\}$。\n自变量为 $r \\in \\{|2-3.1|, |3-3.1|, |4-3.1|, |5-3.1|\\} = \\{1.1, 0.1, 0.9, 1.9\\}$。\n-   $w^{z}_{2} = \\phi(1.1) = \\frac{1}{8}\\left(5-2.2-\\sqrt{-7+13.2-4(1.21)}\\right) = \\frac{1}{8}\\left(2.8-\\sqrt{1.36}\\right) = \\frac{14-\\sqrt{34}}{40}$。\n-   $w^{z}_{3} = \\phi(0.1) = \\frac{1}{8}\\left(3-0.2+\\sqrt{1+0.4-4(0.01)}\\right) = \\frac{1}{8}\\left(2.8+\\sqrt{1.36}\\right) = \\frac{14+\\sqrt{34}}{40}$。\n-   $w^{z}_{4} = \\phi(0.9) = \\frac{1}{8}\\left(3-1.8+\\sqrt{1+3.6-4(0.81)}\\right) = \\frac{1}{8}\\left(1.2+\\sqrt{1.36}\\right) = \\frac{6+\\sqrt{34}}{40}$。\n-   $w^{z}_{5} = \\phi(1.9) = \\frac{1}{8}\\left(5-3.8-\\sqrt{-7+22.8-4(3.61)}\\right) = \\frac{1}{8}\\left(1.2-\\sqrt{1.36}\\right) = \\frac{6-\\sqrt{34}}{40}$。\n\n一维单位分解为 $\\sum_{k} w^{z}_{k} = 1$。一维一阶矩为：\n$$\n\\sum_{k} k \\, w^{z}_{k} = \\frac{2(14-\\sqrt{34}) + 3(14+\\sqrt{34}) + 4(6+\\sqrt{34}) + 5(6-\\sqrt{34})}{40} = \\frac{28-2\\sqrt{34} + 42+3\\sqrt{34} + 24+4\\sqrt{34} + 30-5\\sqrt{34}}{40} = \\frac{124}{40} = \\frac{31}{10} = 3.1\n$$\n这与 $z'$ 相符。\n\n### 步骤 3：三维条件的验证\n问题要求报告元组 $(S, M_x, M_y, M_z)$，其中这些量是三维求和的结果。由于权重的可分离性，我们可以分解求和：\n$$\nS = \\sum_{i,j,k} w_{i,j,k} = \\sum_{i,j,k} w^{x}_{i} w^{y}_{j} w^{z}_{k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{x} = \\sum_{i,j,k} i \\, w_{i,j,k} = \\left(\\sum_{i} i \\, w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{y} = \\sum_{i,j,k} j \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} j \\, w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{z} = \\sum_{i,j,k} k \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} k \\, w^{z}_{k}\\right)\n$$\n代入一维结果：\n-   $S = (1) \\cdot (1) \\cdot (1) = 1$。\n-   $M_{x} = (1.3) \\cdot (1) \\cdot (1) = 1.3$。\n-   $M_{y} = (1) \\cdot (2.7) \\cdot (1) = 2.7$。\n-   $M_{z} = (1) \\cdot (1) \\cdot (3.1) = 3.1$。\n\n单位分解和一阶矩条件均得到满足。最终的元组是 $(S, M_x, M_y, M_z)$。",
            "answer": "$$\n\\boxed{\\left(1, 1.3, 2.7, 3.1\\right)}\n$$"
        }
    ]
}