{
    "hands_on_practices": [
        {
            "introduction": "The first step in any multiscale simulation is to perform a diagnosis of the physical problem to identify the relevant scales and dominant phenomena. This is achieved by evaluating key dimensionless numbers that compare the magnitudes of different physical effects. This exercise provides fundamental practice in calculating the Reynolds number ($Re$), Knudsen number ($Kn$), and Deborah number ($De$), which characterize the nature of fluid flow, gas rarefaction, and material relaxation, respectively . Mastering this analysis is crucial for making an informed decision about the appropriate modeling strategy, determining whether a simple continuum description is sufficient or if more advanced kinetic or hybrid methods are necessary.",
            "id": "4096422",
            "problem": "A dilute polyatomic gas with non-negligible internal mode relaxation flows through a nanochannel of characteristic length $L$. The gas exhibits translational diffusion with kinematic viscosity $\\nu$, has a molecular mean free path $\\lambda$ relevant for kinetic boundary layer effects, and an internal relaxation time $\\lambda_r$ associated with rotational-vibrational energy exchange. The flow has a characteristic speed $U$ set by a pressure gradient. Consider the following parameter values: $U = 0.5\\,\\mathrm{m/s}$, $L = 5.0 \\times 10^{-7}\\,\\mathrm{m}$, $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $\\lambda = 6.5 \\times 10^{-8}\\,\\mathrm{m}$, $\\lambda_r = 1.0 \\times 10^{-6}\\,\\mathrm{s}$.\n\nUsing fundamental definitions, derive and compute the Reynolds number $Re$ as the ratio of inertial to viscous effects; the Knudsen number $Kn$ as the ratio of molecular mean free path to characteristic length; and the Deborah number $De$ as the ratio of the material relaxation time to the observation time scale. For the observation time scale, use the advective time associated with traveling a distance $L$ at speed $U$.\n\nThen, classify the appropriate modeling regime and encode it as a single integer $c$ using the following scheme:\n- Base regime by $Kn$: continuum no-slip if $Kn < 10^{-3}$ ($c = 0$); continuum slip-flow if $10^{-3} \\leq Kn < 10^{-1}$ ($c = 1$); transitional if $10^{-1} \\leq Kn < 10$ ($c = 2$); free-molecular if $Kn \\geq 10$ ($c = 3$).\n- Add modifiers: if $Re < 0.1$ (creeping flow), add $100$; if $Re \\geq 2000$ (turbulent), add $200$; if $De \\geq 0.3$ (significant internal relaxation/viscoelastic effects), add $10$.\n\nCompute $Re$, $Kn$, $De$, and $c$. Round $Re$, $Kn$, and $De$ to three significant figures. All quantities are dimensionless, and the final answer must be provided as a single row matrix containing $Re$, $Kn$, $De$, and $c$.",
            "solution": "The problem requires the calculation of three fundamental dimensionless numbers—the Reynolds number ($Re$), the Knudsen number ($Kn$), and the Deborah number ($De$)—for a gas flow in a nanochannel, and the subsequent classification of the flow regime. The provided parameters are the characteristic speed $U = 0.5\\,\\mathrm{m/s}$, characteristic length $L = 5.0 \\times 10^{-7}\\,\\mathrm{m}$, kinematic viscosity $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$, molecular mean free path $\\lambda = 6.5 \\times 10^{-8}\\,\\mathrm{m}$, and internal relaxation time $\\lambda_r = 1.0 \\times 10^{-6}\\,\\mathrm{s}$.\n\nFirst, we compute the Reynolds number, $Re$, which is defined as the ratio of inertial forces to viscous forces. The formula for the Reynolds number is given by:\n$$Re = \\frac{UL}{\\nu}$$\nSubstituting the given values:\n$$Re = \\frac{(0.5) \\times (5.0 \\times 10^{-7})}{1.5 \\times 10^{-5}} = \\frac{2.5 \\times 10^{-7}}{1.5 \\times 10^{-5}} = \\frac{2.5}{1.5} \\times 10^{-2} \\approx 0.01666...$$\nRounding to three significant figures, we get $Re = 0.0167$.\n\nSecond, we compute the Knudsen number, $Kn$, defined as the ratio of the molecular mean free path to the characteristic length of the system. This number is crucial for determining the degree of rarefaction of the gas and whether a continuum or a kinetic description is appropriate. The formula is:\n$$Kn = \\frac{\\lambda}{L}$$\nSubstituting the given values:\n$$Kn = \\frac{6.5 \\times 10^{-8}}{5.0 \\times 10^{-7}} = \\frac{6.5}{5.0} \\times 10^{-1} = 1.3 \\times 10^{-1} = 0.13$$\nTo three significant figures, this is $Kn = 0.130$.\n\nThird, we compute the Deborah number, $De$. This number compares the intrinsic relaxation time of the material to the characteristic time scale of the flow process. It is defined as:\n$$De = \\frac{\\lambda_r}{t_{obs}}$$\nThe problem specifies that the observation time, $t_{obs}$, is the advective time scale, which is the time taken for a fluid particle to travel the characteristic length $L$ at the characteristic speed $U$.\n$$t_{obs} = \\frac{L}{U}$$\nSubstituting the values for $L$ and $U$:\n$$t_{obs} = \\frac{5.0 \\times 10^{-7}}{0.5} = 1.0 \\times 10^{-6}\\,\\mathrm{s}$$\nNow we can compute the Deborah number:\n$$De = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-6}} = 1.0$$\nTo three significant figures, this is $De = 1.00$.\n\nFinally, we determine the classification code, $c$, based on the computed values of $Re$, $Kn$, and $De$. The scheme is as follows:\nThe base value for $c$ is determined by the Knudsen number, $Kn = 0.130$. The ranges are:\n- $Kn < 10^{-3}$: $c = 0$\n- $10^{-3} \\leq Kn < 10^{-1}$: $c = 1$\n- $10^{-1} \\leq Kn < 10$: $c = 2$\n- $Kn \\geq 10$: $c = 3$\nSince $0.1 \\leq 0.130 < 10$, the flow is in the transitional regime. The base value for $c$ is $2$.\n\nNext, we add modifiers based on $Re$ and $De$.\nThe modifier for the Reynolds number, $Re = 0.0167$, is based on the conditions:\n- If $Re < 0.1$, add $100$.\n- If $Re \\geq 2000$, add $200$.\nSince $0.0167 < 0.1$, the flow is a creeping flow. We must add $100$ to $c$.\n$c = 2 + 100 = 102$.\n\nThe modifier for the Deborah number, $De = 1.00$, is based on the condition:\n- If $De \\geq 0.3$, add $10$.\nSince $1.00 \\geq 0.3$, there are significant internal relaxation effects. We must add $10$ to $c$.\n$c = 102 + 10 = 112$.\n\nTherefore, the final classification code is $c = 112$. This indicates a creeping flow ($Re < 0.1$) in the transitional regime ($10^{-1} \\leq Kn < 10$) with significant non-equilibrium effects from internal energy modes ($De \\geq 0.3$). This combination necessitates a hybrid atomistic-continuum or advanced kinetic theory modeling approach.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.0167 & 0.130 & 1.00 & 112 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A core challenge in creating robust hybrid simulations is ensuring seamless and physically consistent communication between models at different scales. This practice demonstrates a fundamental \"bottom-up\" parameterization workflow, where a property required by a coarse-grained model is systematically derived from a more fundamental, fine-grained simulation. You will use the Green-Kubo relations from statistical mechanics to calculate a fluid's viscosity from microscopic stress fluctuations in a Molecular Dynamics (MD) context, and then use this value to set the corresponding relaxation parameter in a mesoscopic Lattice Boltzmann Method (LBM) solver . This skill of parameter matching is a cornerstone of building predictive multiscale models that are grounded in first-principles physics.",
            "id": "4096426",
            "problem": "A hybrid atomistic–continuum simulation is constructed for a dense, shear-thinning complex fluid. In the near-wall region, a Molecular Dynamics (MD) simulation provides the material response, while in the outer domain an isothermal Lattice Boltzmann Method (LBM) with a single-relaxation Bhatnagar–Gross–Krook (BGK) collision operator advances the flow. The continuum solver must be parameterized to reproduce the MD viscosity at the same thermodynamic state.\n\nThe MD subsystem is equilibrated at temperature $T = 300\\,\\mathrm{K}$ and volume $V = (100\\,\\mathrm{nm})^{3}$. The fluid density is $\\rho = 1.200 \\times 10^{3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$. The off-diagonal microscopic stress autocorrelation function along the flow-gradient plane is well-described by a single-exponential model\n$$\nS(t) \\equiv \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle = S_{0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{c}}\\right),\n$$\nwith $S_{0} = 1.03548675 \\times 10^{10}\\,\\mathrm{Pa}^{2}$ and correlation time $\\tau_{c} = 1.0 \\times 10^{-10}\\,\\mathrm{s}$, where $P_{xy}$ is the Irving–Kirkwood microscopic stress tensor component and $\\langle \\cdot \\rangle$ denotes an equilibrium ensemble average. Using the Green–Kubo relation for a Newtonian fluid, the dynamic viscosity is\n$$\n\\eta = \\frac{V}{k_{B} T}\\int_{0}^{\\infty} S(t)\\,\\mathrm{d}t,\n$$\nwhere $k_B$ is Boltzmann’s constant.\n\nIn the LBM continuum subsystem, a standard athermal isothermal discrete velocity set (e.g., $D3Q19$) is used; the lattice characteristic speed is $c = \\Delta x / \\Delta t$, and the lattice speed of sound satisfies $c_{s}^{2} = c^{2}/3$. The spatial and temporal lattice spacings are $\\Delta x = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ and $\\Delta t = 1.0 \\times 10^{-9}\\,\\mathrm{s}$, respectively.\n\nStarting from first principles:\n- Use linear response theory to obtain the MD viscosity $\\eta$ from the given $S(t)$ via the Green–Kubo relation.\n- Starting from the Boltzmann equation with the BGK collision term and performing a Chapman–Enskog multiscale expansion to recover the Navier–Stokes limit for an isothermal fluid, derive the relation between the macroscopic kinematic viscosity and the LBM relaxation time. Express the kinematic viscosity as a function of $\\tau$, $c_{s}$, and $\\Delta t$.\n- Combine the MD-computed dynamic viscosity and the LBM constitutive relation to determine the LBM relaxation time $\\tau$ that matches the MD viscosity under the given lattice parameters.\n\nCompute the numerical value of the relaxation time and express the final result in lattice time units. Round your answer to four significant figures. The final answer must be a single real number with no units inside the box.",
            "solution": "The solution is structured in three parts as requested: first, the calculation of the dynamic viscosity from the Molecular Dynamics (MD) data using the Green-Kubo relation; second, the derivation of the kinematic viscosity expression for the Lattice Boltzmann Method (LBM) via Chapman-Enskog analysis; and third, the combination of these results to determine the LBM relaxation time $\\tau$.\n\n**Part 1: Calculation of Dynamic Viscosity from MD Data**\n\nThe dynamic viscosity $\\eta$ is given by the Green-Kubo relation, which connects a macroscopic transport coefficient to the time integral of an equilibrium time correlation function of the corresponding microscopic flux. For the shear viscosity component associated with the $xy$-plane, the relation is:\n$$\n\\eta = \\frac{V}{k_{B} T}\\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle\\,\\mathrm{d}t\n$$\nwhere $V$ is the system volume, $T$ is the absolute temperature, $k_B$ is the Boltzmann constant, and $P_{xy}$ is the microscopic stress tensor component. The term $\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle$ is the stress autocorrelation function, provided in the problem as $S(t)$.\n\nThe problem gives the model for the stress autocorrelation function as:\n$$\nS(t) = S_{0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{c}}\\right)\n$$\nwith $S_{0} = 1.03548675 \\times 10^{10}\\,\\mathrm{Pa}^{2}$ and $\\tau_{c} = 1.0 \\times 10^{-10}\\,\\mathrm{s}$.\n\nWe first evaluate the integral of $S(t)$:\n$$\n\\int_{0}^{\\infty} S(t)\\,\\mathrm{d}t = \\int_{0}^{\\infty} S_{0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{c}}\\right)\\,\\mathrm{d}t = S_{0} \\left[ -\\tau_{c}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{c}}\\right) \\right]_{0}^{\\infty} = S_{0} \\left( 0 - (-\\tau_{c}) \\right) = S_{0} \\tau_{c}\n$$\nSubstituting this result into the Green-Kubo formula for $\\eta$:\n$$\n\\eta = \\frac{V}{k_{B} T} (S_{0} \\tau_{c})\n$$\nNow, we substitute the numerical values provided:\n- $V = (100\\,\\mathrm{nm})^{3} = (100 \\times 10^{-9}\\,\\mathrm{m})^{3} = (10^{-7}\\,\\mathrm{m})^{3} = 10^{-21}\\,\\mathrm{m}^{3}$\n- $T = 300\\,\\mathrm{K}$\n- $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$ (CODATA 2018 value)\n- $S_{0} = 1.03548675 \\times 10^{10}\\,\\mathrm{Pa}^{2}$\n- $\\tau_{c} = 1.0 \\times 10^{-10}\\,\\mathrm{s}$\n\nFirst, we calculate the thermal energy $k_{B} T$:\n$$\nk_{B} T = (1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}) \\times (300\\,\\mathrm{K}) = 4.141947 \\times 10^{-21}\\,\\mathrm{J}\n$$\nNext, we calculate the product $S_{0} \\tau_{c}$:\n$$\nS_{0} \\tau_{c} = (1.03548675 \\times 10^{10}\\,\\mathrm{Pa}^{2}) \\times (1.0 \\times 10^{-10}\\,\\mathrm{s}) = 1.03548675\\,\\mathrm{Pa}^{2}\\,\\mathrm{s}\n$$\nNow, we can compute the dynamic viscosity $\\eta$:\n$$\n\\eta = \\frac{10^{-21}\\,\\mathrm{m}^{3}}{4.141947 \\times 10^{-21}\\,\\mathrm{J}} \\times (1.03548675\\,\\mathrm{Pa}^{2}\\,\\mathrm{s}) = 0.250000...\\,\\mathrm{Pa \\cdot s}\n$$\nThe provided value of $S_0$ is precisely chosen to yield a round number. The dynamic viscosity from the MD simulation is $\\eta = 0.25\\,\\mathrm{Pa \\cdot s}$.\n\n**Part 2: Derivation of LBM Kinematic Viscosity**\n\nWe start from the isothermal Lattice Boltzmann equation with the Bhatnagar-Gross-Krook (BGK) collision operator:\n$$\nf_{i}(\\mathbf{x} + \\mathbf{c}_{i}\\Delta t, t + \\Delta t) - f_{i}(\\mathbf{x}, t) = -\\frac{1}{\\tau} \\left( f_{i}(\\mathbf{x}, t) - f_{i}^{\\mathrm{eq}}(\\mathbf{x},t) \\right)\n$$\nHere, $f_{i}(\\mathbf{x}, t)$ is the discrete distribution function for particles with velocity $\\mathbf{c}_{i}$, $\\Delta t$ is the time step, and $\\tau$ is the dimensionless relaxation time in lattice units. $f_{i}^{\\mathrm{eq}}$ is the equilibrium distribution function.\n\nTo recover the macroscopic fluid dynamics, we perform a Chapman-Enskog multiscale expansion. First, the left-hand side of the LBE is Taylor-expanded in $\\Delta t$:\n$$\n\\left( \\partial_{t} + \\mathbf{c}_{i} \\cdot \\nabla \\right) f_{i} + \\frac{\\Delta t}{2} \\left( \\partial_{t} + \\mathbf{c}_{i} \\cdot \\nabla \\right)^{2} f_{i} + \\mathcal{O}(\\Delta t^{2}) = -\\frac{1}{\\tau \\Delta t} \\left( f_{i} - f_{i}^{\\mathrm{eq}} \\right)\n$$\nWe introduce multiple scales for time and space derivatives: $\\partial_{t} = \\epsilon\\partial_{t_{1}} + \\epsilon^{2}\\partial_{t_{2}}$, $\\nabla = \\epsilon\\nabla_{1}$, and expand the distribution function $f_{i}$ in powers of a small parameter $\\epsilon$ (the Knudsen number): $f_{i} = f_{i}^{(0)} + \\epsilon f_{i}^{(1)} + \\epsilon^{2} f_{i}^{(2)} + \\dots$.\n\nSubstituting these expansions into the Taylor-expanded LBE and collecting terms by powers of $\\epsilon$:\n- At order $\\epsilon^{0}$: $f_{i}^{(0)} = f_{i}^{\\mathrm{eq}}$.\n- At order $\\epsilon^{1}$: $\\left(\\partial_{t_{1}} + \\mathbf{c}_{i} \\cdot \\nabla_{1}\\right) f_{i}^{(0)} = -\\frac{1}{\\tau\\Delta t} f_{i}^{(1)}$.\n- At order $\\epsilon^{2}$: $\\partial_{t_{2}}f_{i}^{(0)} + \\left(1-\\frac{1}{2\\tau}\\right)\\left(\\partial_{t_{1}} + \\mathbf{c}_{i} \\cdot \\nabla_{1}\\right) f_{i}^{(1)} = -\\frac{1}{\\tau\\Delta t} f_{i}^{(2)}$.\n\nMacroscopic variables (density $\\rho$ and momentum $\\rho\\mathbf{u}$) are moments of the distribution function: $\\rho=\\sum_{i}f_{i}$ and $\\rho\\mathbf{u}=\\sum_{i}f_{i}\\mathbf{c}_{i}$. The equilibrium distribution is constructed to satisfy these relations, i.e., $\\rho=\\sum_{i}f_{i}^{\\mathrm{eq}}$ and $\\rho\\mathbf{u}=\\sum_{i}f_{i}^{\\mathrm{eq}}\\mathbf{c}_{i}$, which implies $\\sum_{i}f_{i}^{(k)}=0$ and $\\sum_{i}f_{i}^{(k)}\\mathbf{c}_{i}=0$ for $k \\ge 1$.\n\nTaking moments of the $\\epsilon^{1}$ and $\\epsilon^{2}$ equations leads to the macroscopic equations. The momentum equation is recovered by combining the momentum moments at different scales. The momentum flux tensor is $\\mathbf{\\Pi} = \\sum_{i}f_{i}\\mathbf{c}_{i}\\mathbf{c}_{i}$. Its non-equilibrium part $\\mathbf{\\Pi}^{\\mathrm{neq}}$ contributes to viscosity.\n$$\n\\mathbf{\\Pi} = \\sum_{i} f_{i} \\mathbf{c}_{i}\\mathbf{c}_{i} = \\mathbf{\\Pi}^{\\mathrm{eq}} + \\mathbf{\\Pi}^{\\mathrm{neq}}\n$$\nAfter a detailed derivation, the viscous stress tensor $\\sigma_{v} = - \\mathbf{\\Pi}^{\\mathrm{neq}}$ can be shown to be:\n$$\n\\sigma_{v} = \\rho c_{s}^{2} \\Delta t \\left(\\tau - \\frac{1}{2}\\right) \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^{T} \\right]\n$$\nThis assumes an incompressible flow limit. Comparing this with the stress tensor from the Navier-Stokes equations, $\\sigma_{v} = \\eta \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^{T} \\right]$, we identify the dynamic viscosity $\\eta$ as:\n$$\n\\eta = \\rho c_{s}^{2} \\Delta t \\left(\\tau - \\frac{1}{2}\\right)\n$$\nThe corresponding kinematic viscosity $\\nu = \\eta/\\rho$ is:\n$$\n\\nu = c_{s}^{2} \\Delta t \\left(\\tau - \\frac{1}{2}\\right)\n$$\nThis is the required relationship between the kinematic viscosity $\\nu$ and the LBM parameters $\\tau$, $c_{s}$, and $\\Delta t$. For the simulation to be stable, the viscosity must be positive, which imposes the condition $\\tau > 1/2$.\n\n**Part 3: Calculation of the LBM Relaxation Time $\\tau$**\n\nThe problem requires matching the macroscopic viscosity of the LBM continuum solver to the viscosity computed from the atomistic MD simulation. Therefore, we set $\\eta_{\\mathrm{LBM}} = \\eta_{\\mathrm{MD}}$.\n$$\n\\rho c_{s}^{2} \\Delta t \\left(\\tau - \\frac{1}{2}\\right) = \\eta_{\\mathrm{MD}}\n$$\nWe can now solve for the dimensionless relaxation time $\\tau$:\n$$\n\\tau - \\frac{1}{2} = \\frac{\\eta_{\\mathrm{MD}}}{\\rho c_{s}^{2} \\Delta t} \\implies \\tau = \\frac{1}{2} + \\frac{\\eta_{\\mathrm{MD}}}{\\rho c_{s}^{2} \\Delta t}\n$$\nWe have the following values:\n- $\\eta_{\\mathrm{MD}} = 0.25\\,\\mathrm{Pa \\cdot s}$ (from Part 1)\n- $\\rho = 1.200 \\times 10^{3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\Delta x = 1.0 \\times 10^{-6}\\,\\mathrm{m}$\n- $\\Delta t = 1.0 \\times 10^{-9}\\,\\mathrm{s}$\n\nFirst, we calculate the square of the lattice speed of sound, $c_{s}^{2}$:\n$$\nc_{s}^{2} = \\frac{c^{2}}{3} = \\frac{1}{3}\\left(\\frac{\\Delta x}{\\Delta t}\\right)^{2} = \\frac{1}{3}\\left(\\frac{1.0 \\times 10^{-6}\\,\\mathrm{m}}{1.0 \\times 10^{-9}\\,\\mathrm{s}}\\right)^{2} = \\frac{1}{3}(1000\\,\\mathrm{m/s})^{2} = \\frac{10^{6}}{3}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\nNow, we compute the denominator term $\\rho c_{s}^{2} \\Delta t$:\n$$\n\\rho c_{s}^{2} \\Delta t = (1.200 \\times 10^{3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}) \\left(\\frac{10^{6}}{3}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\\right) (1.0 \\times 10^{-9}\\,\\mathrm{s})\n$$\n$$\n\\rho c_{s}^{2} \\Delta t = (0.400 \\times 10^{3}) (10^{6}) (10^{-9}) \\,\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1} = 0.400 \\times 10^{3+6-9} \\,\\mathrm{Pa \\cdot s} = 0.400\\,\\mathrm{Pa \\cdot s}\n$$\nFinally, we substitute this into the expression for $\\tau$:\n$$\n\\tau = \\frac{1}{2} + \\frac{0.25\\,\\mathrm{Pa \\cdot s}}{0.400\\,\\mathrm{Pa \\cdot s}} = 0.5 + 0.625 = 1.125\n$$\nThe problem asks for the result to be rounded to four significant figures. The value $1.125$ is already in this form. The final result for the dimensionless relaxation time is $1.125$. This value is greater than $0.5$, confirming that the corresponding LBM simulation would be numerically stable.",
            "answer": "$$\\boxed{1.125}$$"
        },
        {
            "introduction": "Having learned to diagnose a multiscale problem and bridge models through parameterization, the final step is to construct and run a fully coupled simulation. This capstone exercise guides you through the implementation of a complete Heterogeneous Multiscale Method (HMM), a classic and powerful \"on-the-fly\" coupling paradigm. You will build a system where a macroscopic solver for the continuum momentum equation is dynamically coupled to a microscopic stochastic solver for polymer dumbbell configurations . This hands-on implementation will solidify your understanding of the entire multiscale workflow, including the critical steps of restriction (passing macroscopic field information down to the micro-model) and reconstruction (averaging microscopic results to inform the macro-model), and expose you to the crucial issue of the numerical stability of the coupled scheme.",
            "id": "4096395",
            "problem": "You are asked to implement a Heterogeneous Multiscale Method (HMM) coupling a local atomistic micro-solver to a continuum solver for a viscoelastic complex fluid in one spatial dimension. The micro-solver evolves the configurational probability density $\\psi(\\mathbf{Q},t)$ indirectly by simulating the stochastic evolution of bead-spring dumbbell configurations, and provides the polymeric shear stress component $\\tau_{p,xy}$ to the continuum solver. You must design the algorithm from fundamental principles and demonstrate numerical stability by varying the macroscopic time step. All variables are dimensionless.\n\nThe fundamental base to use is as follows.\n\n1. Continuum momentum balance in one-dimensional, incompressible, planar shear with periodic boundary conditions:\n$$\n\\rho \\,\\partial_t u(y,t) \\;=\\; \\partial_y \\tau_{\\text{total}}(y,t),\n$$\nwhere $u(y,t)$ is the streamwise velocity, $\\rho$ is the density, and $\\tau_{\\text{total}}(y,t)=\\tau_s(y,t)+\\tau_p(y,t)$ is the total shear stress. The Newtonian solvent stress is $\\tau_s(y,t)=\\eta_s\\,\\partial_y u(y,t)$, where $\\eta_s$ is the solvent viscosity. The polymeric shear stress $\\tau_p(y,t)$ is provided by the micro-solver.\n\n2. Bead-spring dumbbell model for the polymer configuration vector $\\mathbf{Q}(t)=(Q_x(t),Q_y(t))$ under a local velocity gradient tensor $\\boldsymbol{\\kappa}(y,t)$, modeled by a Langevin stochastic differential equation (SDE) in dimensionless form:\n$$\n\\mathrm{d}\\mathbf{Q} \\;=\\; \\boldsymbol{\\kappa}(y,t)\\,\\mathbf{Q}\\,\\mathrm{d}t \\;-\\; \\mathbf{Q}\\,\\mathrm{d}t \\;+\\; \\sqrt{2}\\,\\mathrm{d}\\mathbf{W}(t),\n$$\nwith $\\mathbf{W}(t)$ a two-dimensional Wiener process, and $\\boldsymbol{\\kappa}$ the gradient of the velocity, $\\kappa_{ij}=\\partial_j v_i$. For planar shear $v_x=u(y,t)$ and $v_y=0$, so $\\boldsymbol{\\kappa}$ has only one nonzero component, $\\kappa_{xy}=\\partial_y u(y,t)\\equiv\\dot{\\gamma}(y,t)$, yielding:\n$$\n\\mathrm{d}Q_x \\;=\\; \\dot{\\gamma}(y,t)\\,Q_y\\,\\mathrm{d}t \\;-\\; Q_x\\,\\mathrm{d}t \\;+\\; \\sqrt{2}\\,\\mathrm{d}W_x(t),\\qquad\n\\mathrm{d}Q_y \\;=\\; -\\,Q_y\\,\\mathrm{d}t \\;+\\; \\sqrt{2}\\,\\mathrm{d}W_y(t).\n$$\n\n3. Kramers expression for the polymeric shear stress in dimensionless units with modulus $G=1$:\n$$\n\\tau_{p,xy}(y,t) \\;=\\; \\big\\langle Q_x Q_y \\big\\rangle,\n$$\nwhere the average is over the ensemble of micro-configurations at the spatial location $y$.\n\nYour task is to implement an HMM algorithm in which, at each macroscopic time step of size $\\Delta t$, the micro-solver runs for a short microscopic time window of size $\\Delta t$ (with smaller micro time steps) to update the local ensemble of $\\mathbf{Q}$ at each spatial grid point, computes $\\tau_{p,xy}$, and then advances $u(y,t)$ in time using an explicit scheme for the continuum momentum equation. Use a periodic domain $y\\in[0,2\\pi]$ discretized by $N$ uniformly spaced grid points, periodic finite differences for spatial derivatives, and Euler–Maruyama for the SDE.\n\nYou must design a stability diagnostic grounded in the energy of the macroscopic field. Define the discrete energy\n$$\nE(t) \\;=\\; \\frac{1}{N} \\sum_{j=0}^{N-1} u(y_j,t)^2,\n$$\nand declare a run \"stable\" if throughout the simulation the solution remains finite and the final energy satisfies $E(T_{\\text{final}})\\leq \\alpha\\,E(0)$ for a prescribed factor $\\alpha$. Also declare \"unstable\" if any $u$ becomes not-a-number or exceeds a large bounded threshold during the integration.\n\nImplement the following test suite of parameter sets to assess stability across macroscopic time step sizes. In all cases, use the same microscopic ensemble size and micro-stepping strategy. The problem is fully dimensionless.\n\n- Domain length $L=2\\pi$, number of grid points $N=32$, density $\\rho=1$, solvent viscosity $\\eta_s=0.5$, polymer modulus $G=1$, microscopic ensemble size $M=200$ dumbbells per grid point, micro sub-steps per macro step $R=5$, and number of macro steps $K=50$. Initial condition $u(y,0)=\\sin(y)$, initial polymer configurations drawn independently from a standard normal distribution for each component.\n\n- Define the explicit diffusion stability threshold for the viscous term as\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{h^2}{2\\nu}, \\qquad h=\\frac{L}{N},\\quad \\nu=\\frac{\\eta_s}{\\rho}.\n$$\nUse three macroscopic time steps:\n    1. Case A (happy path): $\\Delta t = 0.2\\,\\Delta t_{\\max}$.\n    2. Case B (near-boundary): $\\Delta t = 0.99\\,\\Delta t_{\\max}$.\n    3. Case C (edge unstable): $\\Delta t = 1.10\\,\\Delta t_{\\max}$.\n\nFor the stability diagnostic, use $\\alpha=1.5$ as the energy growth factor threshold and a maximum absolute velocity threshold of $10^3$. Your program must simulate each case, determine a boolean stability outcome for each, and aggregate the three boolean results into a single line of output in the format:\n\"[resultA,resultB,resultC]\"\nwhere each result is a boolean.\n\nAll computations are to be carried out in dimensionless units, and angles are in radians. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example \"[True,False,True]\".",
            "solution": "The problem presents a valid and well-posed challenge in computational complex fluids, specifically in the domain of multiscale modeling. It asks for the implementation and stability analysis of a Heterogeneous Multiscale Method (HMM) for a one-dimensional viscoelastic fluid. The problem is scientifically grounded, employing the standard continuum momentum equation coupled with a classical microscopic bead-spring dumbbell model via the Kramers expression for stress. All required parameters, initial conditions, boundary conditions, and numerical schemes are explicitly defined, making the problem self-contained and unambiguous. The stability diagnostic is objectively defined with clear numerical criteria. Therefore, we proceed with a complete solution.\n\nThe core principle of the Heterogeneous Multiscale Method is to bridge disparate time and length scales by coupling a macroscopic (continuum) solver with a microscopic (atomistic or stochastic) solver. The macro-solver evolves the coarse-grained fields, but lacks a closed-form constitutive relation for certain quantities (here, the polymer stress). The micro-solver, simulated on small domains centered at macroscopic grid points, provides the missing constitutive information by explicitly resolving the fine-scale physics. The HMM algorithm orchestrates the information exchange between these two solvers.\n\n**1. Macroscopic Model: Continuum Momentum Balance**\n\nThe macroscopic behavior of the fluid is governed by the one-dimensional momentum balance equation for planar shear flow:\n$$\n\\rho \\,\\frac{\\partial u(y,t)}{\\partial t} \\;=\\; \\frac{\\partial \\tau_{\\text{total}}(y,t)}{\\partial y}\n$$\nwhere $\\rho$ is the fluid density and $u(y,t)$ is the streamwise velocity. The total shear stress $\\tau_{\\text{total}}$ is decomposed into a Newtonian solvent contribution $\\tau_s$ and a polymeric contribution $\\tau_p$:\n$$\n\\tau_{\\text{total}}(y,t) = \\tau_s(y,t) + \\tau_p(y,t) = \\eta_s\\,\\frac{\\partial u(y,t)}{\\partial y} + \\tau_p(y,t)\n$$\nHere, $\\eta_s$ is the solvent viscosity. Substituting this into the momentum equation yields:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\eta_s}{\\rho} \\frac{\\partial^2 u}{\\partial y^2} + \\frac{1}{\\rho}\\frac{\\partial \\tau_p}{\\partial y}\n$$\nLetting $\\nu = \\eta_s/\\rho$ be the kinematic viscosity, we have the final form for the macroscopic evolution:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial y^2} + \\frac{1}{\\rho}\\frac{\\partial \\tau_p}{\\partial y}\n$$\nThis partial differential equation is defined on a periodic domain $y \\in [0, L]$. We discretize this domain into $N$ grid points $y_j = j h$ for $j=0, \\dots, N-1$, where $h=L/N$ is the grid spacing. Time is discretized in steps of $\\Delta t$, $t_k = k \\Delta t$. Let $u_j^k \\approx u(y_j, t_k)$. We use second-order central finite differences for the spatial derivatives, respecting the periodic boundary conditions:\n$$\n\\left.\\frac{\\partial^2 u}{\\partial y^2}\\right|_{y_j} \\approx \\frac{u_{j+1}^k - 2u_j^k + u_{j-1}^k}{h^2}\n$$\n$$\n\\left.\\frac{\\partial \\tau_p}{\\partial y}\\right|_{y_j} \\approx \\frac{\\tau_{p,j+1} - \\tau_{p,j-1}}{2h}\n$$\n\n**2. Microscopic Model: Bead-Spring Dumbbell Dynamics**\n\nThe polymeric stress $\\tau_p(y,t)$ is determined by the configuration of polymer molecules at location $y$. We model these polymers as bead-spring dumbbells, whose configuration vector $\\mathbf{Q}=(Q_x, Q_y)$ evolves according to a Langevin stochastic differential equation (SDE):\n$$\n\\mathrm{d}\\mathbf{Q} \\;=\\; \\left[ \\boldsymbol{\\kappa}(y,t)\\,\\mathbf{Q} - \\mathbf{Q} \\right]\\mathrm{d}t \\;+\\; \\sqrt{2}\\,\\mathrm{d}\\mathbf{W}(t)\n$$\nThe first term represents the advection of the dumbbell by the local velocity gradient tensor $\\boldsymbol{\\kappa}$, the second term is a linear (Hookean) spring restoring force, and the third term models thermal fluctuations via a Wiener process $\\mathbf{W}(t)$. For the specified planar shear flow, the only non-zero component of $\\boldsymbol{\\kappa}$ is the shear rate $\\kappa_{xy} = \\dot{\\gamma}(y,t) = \\partial u / \\partial y$. The SDEs for the components are:\n$$\n\\mathrm{d}Q_x = (\\dot{\\gamma} Q_y - Q_x)\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_x(t)\n$$\n$$\n\\mathrm{d}Q_y = -Q_y\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_y(t)\n$$\nWe solve these SDEs numerically using the Euler–Maruyama scheme. For a small time step $\\delta t$, the update rule for a single dumbbell is:\n$$\nQ_x^{new} = Q_x + (\\dot{\\gamma} Q_y - Q_x)\\,\\delta t + \\sqrt{2\\delta t}\\,Z_x\n$$\n$$\nQ_y^{new} = Q_y - Q_y\\,\\delta t + \\sqrt{2\\delta t}\\,Z_y\n$$\nwhere $Z_x$ and $Z_y$ are independent random variables drawn from a standard normal distribution $\\mathcal{N}(0,1)$.\n\n**3. HMM Coupling Algorithm**\n\nThe HMM procedure couples the macro and micro solvers. Based on the problem description (\"micro-solver runs...to update Q...computes $\\tau_{p,xy}$, and then advances u\"), we implement the following explicit time-stepping scheme to advance the state from time $t_k$ to $t_{k+1} = t_k + \\Delta t$:\n\n*   **Step 1: Restriction (Macro-to-Micro)**. At each macro grid point $y_j$, the local shear rate $\\dot{\\gamma}_j^k$ is computed from the macroscopic velocity field $u^k$ at time $t_k$:\n    $$\n    \\dot{\\gamma}_j^k = \\frac{u_{j+1}^k - u_{j-1}^k}{2h}\n    $$\n*   **Step 2: Micro-Solver Evolution**. The ensemble of $M$ dumbbells at each grid point $y_j$ is evolved for a time duration of $\\Delta t$. This is done by performing $R$ micro-steps of size $\\delta t = \\Delta t/R$. The shear rate $\\dot{\\gamma}_j^k$ is held constant throughout this micro-evolution window. This updates the ensemble from $\\mathbf{Q}_j^k$ to $\\mathbf{Q}_j^{k+1}$.\n*   **Step 3: Reconstruction (Micro-to-Macro)**. The polymeric stress $\\tau_{p,j}^{k+1}$ at each grid point is computed from the newly evolved dumbbell configurations $\\mathbf{Q}_j^{k+1}$ using the Kramers expression, which involves an ensemble average:\n    $$\n    \\tau_{p,j}^{k+1} = \\langle Q_x Q_y \\rangle_j = \\frac{1}{M} \\sum_{m=1}^{M} Q_{x,j,m}^{k+1} Q_{y,j,m}^{k+1}\n    $$\n*   **Step 4: Macro-Solver Evolution**. The macroscopic velocity field is advanced from $u^k$ to $u^{k+1}$ using a forward Euler step. The viscous term is evaluated using $u^k$, while the polymer stress term uses the just-computed $\\tau_p^{k+1}$. This constitutes an explicit, though mixed-time-level, update rule:\n    $$\n    u_j^{k+1} = u_j^k + \\Delta t \\left( \\nu \\frac{u_{j+1}^k - 2u_j^k + u_{j-1}^k}{h^2} + \\frac{1}{\\rho} \\frac{\\tau_{p, j+1}^{k+1} - \\tau_{p, j-1}^{k+1}}{2h} \\right)\n    $$\n\nThis four-step cycle is repeated for $K$ macroscopic time steps.\n\n**4. Stability Diagnostic**\n\nNumerical stability is assessed based on the evolution of the discrete total kinetic energy of the macroscopic field, defined as:\n$$\nE(t_k) = \\frac{1}{N} \\sum_{j=0}^{N-1} (u_j^k)^2\n$$\nA simulation run is declared \"unstable\" if at any point the velocity $u_j^k$ becomes not-a-number (NaN) or its magnitude exceeds a threshold of $10^3$. If the simulation completes, it is declared \"stable\" only if the final energy $E(t_K)$ does not grow excessively, i.e., $E(t_K) \\le \\alpha E(t_0)$, with the given growth factor $\\alpha = 1.5$. Otherwise, it is unstable. The test cases investigate stability as the macroscopic time step $\\Delta t$ is varied relative to the explicit diffusion stability limit, $\\Delta t_{\\max} = h^2/(2\\nu)$. This allows us to probe the stability boundary of the coupled numerical scheme.",
            "answer": "$$\\boxed{[\\text{True},\\text{True},\\text{False}]}$$"
        }
    ]
}