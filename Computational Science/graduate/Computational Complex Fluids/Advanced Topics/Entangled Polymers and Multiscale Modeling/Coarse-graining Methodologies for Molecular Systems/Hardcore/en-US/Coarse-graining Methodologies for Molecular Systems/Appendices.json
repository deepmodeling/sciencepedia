{
    "hands_on_practices": [
        {
            "introduction": "To build robust coarse-grained models, we must first understand how the dynamics of simplified variables emerge from the underlying complex, all-atom system. This practice guides you through a foundational derivation, starting from a classical Hamiltonian that couples a coarse-grained coordinate to a bath of harmonic oscillators . By formally eliminating the bath degrees of freedom, you will derive the Generalized Langevin Equation (GLE) and see precisely how memory effects and random forces arise, providing a concrete example of the Mori-Zwanzig formalism at work.",
            "id": "4081629",
            "problem": "Consider a coarse-grained (CG) coordinate $X(t)$ of mass $M$ evolving under a smooth potential $U(X)$ and coupled linearly to a harmonic bath that models unresolved molecular degrees of freedom. The bath consists of independent oscillators with coordinates $q_j$, masses $m_j$, frequencies $\\omega_j$, and couplings $c_j$. The total Hamiltonian is\n$$\nH = \\frac{P^{2}}{2M} + U(X) + \\sum_{j} \\left[ \\frac{p_j^{2}}{2 m_j} + \\frac{1}{2} m_j \\omega_j^{2} \\left( q_j - \\frac{c_j}{m_j \\omega_j^{2}} X \\right)^{2} \\right],\n$$\nwhich includes the standard counter-term that preserves the bare potential $U(X)$ upon eliminating the bath. Assume the bath is initially at canonical equilibrium at temperature $T$, sampled independently of the initial CG coordinate and momentum, with Boltzmann constant $k_B$.\n\nStarting from Hamiltonian dynamics and the fundamental definitions of equilibrium averages, eliminate the bath degrees of freedom to obtain the Generalized Langevin Equation (GLE) for $X(t)$ of the form\n$$\nM \\ddot{X}(t) + U'(X(t)) + \\int_{0}^{t} K(t-s)\\, \\dot{X}(s)\\, ds = R(t),\n$$\nwhere $K(t)$ is the memory kernel and $R(t)$ is the random force determined by the bath initial conditions. Then, model the bath in the continuum limit via a spectral density $J(\\omega)$ defined by\n$$\nJ(\\omega) \\equiv \\frac{\\pi}{2} \\sum_{j} \\frac{c_j^{2}}{m_j \\omega_j} \\, \\delta(\\omega - \\omega_j),\n$$\nand take the Drude–Lorentz form\n$$\nJ(\\omega) = \\gamma M \\, \\omega \\, \\frac{\\omega_c^{2}}{\\omega^{2} + \\omega_c^{2}},\n$$\nwith friction scale $\\gamma  0$ and cutoff frequency $\\omega_c  0$. Compute the resulting memory kernel $K(t)$ in closed analytic form. Using the canonical equilibria of the harmonic bath, verify the analytic Fluctuation–Dissipation Theorem (FDT), namely that the random force autocorrelation satisfies\n$$\n\\langle R(t) R(0) \\rangle = k_B T \\, K(t).\n$$\n\nAnswer specification:\n- Report the dimensionless memory kernel $\\tilde{K}(t) \\equiv K(t)/(M \\gamma \\omega_c)$ as your final answer.\n- No numerical evaluation is required; provide the exact analytic expression.",
            "solution": "The problem requires the derivation of the Generalized Langevin Equation (GLE) for a coarse-grained (CG) coordinate $X(t)$ coupled to a harmonic bath, the calculation of the memory kernel $K(t)$ for a specific spectral density, and the verification of the Fluctuation-Dissipation Theorem (FDT).\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Hamiltonian**:\n    $$H = \\frac{P^{2}}{2M} + U(X) + \\sum_{j} \\left[ \\frac{p_j^{2}}{2 m_j} + \\frac{1}{2} m_j \\omega_j^{2} \\left( q_j - \\frac{c_j}{m_j \\omega_j^{2}} X \\right)^{2} \\right]$$\n-   **CG particle mass**: $M$\n-   **CG potential**: $U(X)$\n-   **Bath oscillator properties**: coordinates $q_j$, momenta $p_j$, masses $m_j$, frequencies $\\omega_j$, coupling constants $c_j$.\n-   **Initial condition**: The bath is in canonical equilibrium at temperature $T$, sampled independently of the initial CG state. Boltzmann constant is $k_B$.\n-   **Target equation (GLE)**:\n    $$M \\ddot{X}(t) + U'(X(t)) + \\int_{0}^{t} K(t-s)\\, \\dot{X}(s)\\, ds = R(t)$$\n-   **Spectral density definition**:\n    $$J(\\omega) \\equiv \\frac{\\pi}{2} \\sum_{j} \\frac{c_j^{2}}{m_j \\omega_j} \\, \\delta(\\omega - \\omega_j)$$\n-   **Specified spectral density (Drude–Lorentz)**:\n    $$J(\\omega) = \\gamma M \\, \\omega \\, \\frac{\\omega_c^{2}}{\\omega^{2} + \\omega_c^{2}}$$\n    with friction scale $\\gamma  0$ and cutoff frequency $\\omega_c  0$.\n-   **Fluctuation-Dissipation Theorem (FDT) to verify**:\n    $$\\langle R(t) R(0) \\rangle = k_B T \\, K(t)$$\n-   **Required output**: The dimensionless memory kernel $\\tilde{K}(t) \\equiv K(t)/(M \\gamma \\omega_c)$.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem describes the Caldeira-Leggett model (in its classical limit), a fundamental and widely used model in physics and chemistry for studying open quantum systems and dissipative dynamics. The derivation of the GLE from this Hamiltonian is a standard procedure in non-equilibrium statistical mechanics. The Drude-Lorentz spectral density is a physically motivated and common choice. The FDT is a cornerstone theorem. The problem is scientifically sound.\n-   **Well-Posed**: The problem is clearly defined with all necessary information to derive a unique analytical solution.\n-   **Objective**: The language is precise, mathematical, and free of any subjective or opinion-based statements.\n-   **Topic Relevance**: The problem directly addresses coarse-graining (eliminating bath degrees of freedom), the resulting memory effects, and their connection to fluctuations, which is central to the topic of *coarse-graining methodologies for molecular systems* within *computational complex fluids*.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. I will proceed with the solution.\n\n### Step 2: Derivation of the GLE\n\nWe start by deriving the equations of motion from the given Hamiltonian using Hamilton's equations.\nThe equation of motion for the CG coordinate $X$ is:\n$M\\ddot{X} = -\\frac{\\partial H}{\\partial X} = -U'(X) - \\frac{\\partial}{\\partial X} \\sum_{j} \\frac{1}{2} m_j \\omega_j^{2} \\left( q_j - \\frac{c_j}{m_j \\omega_j^{2}} X \\right)^{2}$\n$M\\ddot{X} = -U'(X) - \\sum_{j} m_j \\omega_j^{2} \\left( q_j - \\frac{c_j}{m_j \\omega_j^{2}} X \\right) \\left(-\\frac{c_j}{m_j \\omega_j^{2}}\\right)$\n$$M\\ddot{X}(t) = -U'(X(t)) + \\sum_{j} c_j \\left( q_j(t) - \\frac{c_j}{m_j \\omega_j^{2}} X(t) \\right) \\quad (*)$$\nThe equation of motion for each bath oscillator coordinate $q_j$ is:\n$m_j\\ddot{q}_j = -\\frac{\\partial H}{\\partial q_j} = -m_j \\omega_j^{2} \\left( q_j - \\frac{c_j}{m_j \\omega_j^{2}} X \\right)$\n$$\\ddot{q}_j(t) + \\omega_j^{2} q_j(t) = \\frac{c_j}{m_j} X(t)$$\nThis is the equation for a forced harmonic oscillator. Its general solution is the sum of the homogeneous solution and a particular solution obtained via the Green's function method:\n$$q_j(t) = q_j(0) \\cos(\\omega_j t) + \\frac{\\dot{q}_j(0)}{\\omega_j} \\sin(\\omega_j t) + \\int_{0}^{t} \\frac{\\sin(\\omega_j (t-s))}{\\omega_j} \\frac{c_j}{m_j} X(s) ds$$\nwhere $\\dot{q}_j(0) = p_j(0)/m_j$.\n\nWe substitute this solution for $q_j(t)$ back into the equation of motion for $X(t)$, equation $(*)$.\n$M\\ddot{X} + U'(X) = \\sum_{j} c_j q_j(t) - \\sum_{j} \\frac{c_j^2}{m_j \\omega_j^2} X(t)$\nSubstituting the expression for $q_j(t)$:\n$M\\ddot{X} + U'(X) + \\left(\\sum_{j} \\frac{c_j^2}{m_j \\omega_j^2}\\right) X(t) = \\sum_{j} c_j \\left[ q_j(0)\\cos(\\omega_j t) + \\frac{p_j(0)}{m_j\\omega_j}\\sin(\\omega_j t) + \\frac{c_j}{m_j\\omega_j} \\int_{0}^{t} \\sin(\\omega_j(t-s)) X(s) ds \\right]$\nWe focus on the integral term. We perform integration by parts:\n$\\int_{0}^{t} \\sin(\\omega_j(t-s)) X(s) ds = \\left[ X(s) \\frac{\\cos(\\omega_j(t-s))}{\\omega_j} \\right]_0^t - \\int_{0}^{t} \\frac{\\cos(\\omega_j(t-s))}{\\omega_j} \\dot{X}(s) ds$\n$= \\frac{X(t)}{\\omega_j} - \\frac{X(0)\\cos(\\omega_j t)}{\\omega_j} - \\frac{1}{\\omega_j} \\int_{0}^{t} \\cos(\\omega_j(t-s)) \\dot{X}(s) ds$\nSubstituting this back into the equation for $X$:\n$\\sum_{j} \\frac{c_j^2}{m_j} \\int_{0}^{t} \\frac{\\sin(\\omega_j(t-s))}{\\omega_j} X(s) ds = \\sum_{j} \\frac{c_j^2}{m_j\\omega_j^2} \\left[ X(t) - X(0)\\cos(\\omega_j t) - \\int_{0}^{t} \\cos(\\omega_j(t-s)) \\dot{X}(s) ds \\right]$\n$= \\left(\\sum_j \\frac{c_j^2}{m_j \\omega_j^2}\\right) X(t) - X(0) \\sum_j \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j t) - \\int_0^t \\left(\\sum_j \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j(t-s))\\right) \\dot{X}(s) ds$\nThe full equation for $X$ becomes:\n$M\\ddot{X} + U'(X) + \\left(\\sum_{j} \\frac{c_j^2}{m_j \\omega_j^2}\\right) X(t) = \\sum_{j} c_j \\left[ q_j(0)\\cos(\\omega_j t) + \\frac{p_j(0)}{m_j\\omega_j}\\sin(\\omega_j t) \\right] + \\left(\\sum_j \\frac{c_j^2}{m_j \\omega_j^2}\\right) X(t) - X(0) \\sum_j \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j t) - \\int_0^t \\left(\\sum_j \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j(t-s))\\right) \\dot{X}(s) ds$\nThe term $\\left(\\sum_{j} \\frac{c_j^2}{m_j \\omega_j^2}\\right) X(t)$ cancels on both sides, which highlights the role of the counter-term in the Hamiltonian. Rearranging the remaining terms to match the GLE form:\n$$M\\ddot{X}(t) + U'(X(t)) + \\int_0^t K(t-s) \\dot{X}(s) ds = R(t)$$\nwhere we identify the memory kernel $K(t)$ and the random force $R(t)$ as:\n$$K(t) = \\sum_{j} \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j t)$$\n$$R(t) = \\sum_{j} \\left[ c_j \\left(q_j(0) - \\frac{c_j X(0)}{m_j\\omega_j^2}\\right) \\cos(\\omega_j t) + \\frac{c_j p_j(0)}{m_j \\omega_j} \\sin(\\omega_j t) \\right]$$\n\n### Step 3: Calculation of the Memory Kernel\n\nWe now convert the sum for $K(t)$ into an integral using the spectral density $J(\\omega)$. The relationship is derived as follows:\n$\\frac{2}{\\pi} \\int_0^\\infty \\frac{J(\\omega)}{\\omega} \\cos(\\omega t) d\\omega = \\frac{2}{\\pi} \\int_0^\\infty \\left( \\frac{\\pi}{2} \\sum_j \\frac{c_j^2}{m_j \\omega_j} \\delta(\\omega-\\omega_j) \\right) \\frac{\\cos(\\omega t)}{\\omega} d\\omega$\n$= \\sum_j \\frac{c_j^2}{m_j \\omega_j} \\int_0^\\infty \\frac{\\cos(\\omega t)}{\\omega} \\delta(\\omega-\\omega_j) d\\omega = \\sum_j \\frac{c_j^2}{m_j \\omega_j} \\frac{\\cos(\\omega_j t)}{\\omega_j} = K(t)$.\nSo, we have the general formula:\n$$K(t) = \\frac{2}{\\pi} \\int_0^\\infty \\frac{J(\\omega)}{\\omega} \\cos(\\omega t) d\\omega$$\nUsing the given Drude-Lorentz spectral density $J(\\omega) = \\gamma M \\omega \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2}$:\n$K(t) = \\frac{2}{\\pi} \\int_0^\\infty \\frac{1}{\\omega} \\left( \\gamma M \\omega \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2} \\right) \\cos(\\omega t) d\\omega = \\frac{2 \\gamma M \\omega_c^2}{\\pi} \\int_0^\\infty \\frac{\\cos(\\omega t)}{\\omega^2 + \\omega_c^2} d\\omega$.\nThis is a standard integral. For $t \\ge 0$, it can be evaluated using complex analysis. Considering the integral $\\frac{1}{2} \\int_{-\\infty}^\\infty \\frac{e^{i\\omega t}}{\\omega^2 + \\omega_c^2} d\\omega$ and closing the contour in the upper half-plane (for $t > 0$), we encircle the simple pole at $\\omega = i\\omega_c$.\n$\\int_0^\\infty \\frac{\\cos(\\omega t)}{\\omega^2 + \\omega_c^2} d\\omega = \\frac{1}{2} \\text{Re} \\left[ \\oint \\frac{e^{i\\omega t}}{\\omega^2 + \\omega_c^2} d\\omega \\right] = \\frac{1}{2} \\text{Re} \\left[ 2\\pi i \\, \\text{Res}_{\\omega=i\\omega_c} \\frac{e^{i\\omega t}}{(\\omega - i\\omega_c)(\\omega + i\\omega_c)} \\right]$\n$= \\frac{1}{2} \\text{Re} \\left[ 2\\pi i \\, \\frac{e^{i(i\\omega_c)t}}{2i\\omega_c} \\right] = \\frac{1}{2} \\text{Re} \\left[ \\frac{\\pi}{\\omega_c} e^{-\\omega_c t} \\right] = \\frac{\\pi}{2\\omega_c} e^{-\\omega_c t}$.\nSubstituting this result back into the expression for $K(t)$:\n$$K(t) = \\frac{2 \\gamma M \\omega_c^2}{\\pi} \\left( \\frac{\\pi}{2\\omega_c} e^{-\\omega_c t} \\right) = M \\gamma \\omega_c e^{-\\omega_c t}$$\n\n### Step 4: Verification of the Fluctuation-Dissipation Theorem\n\nThe FDT states $\\langle R(t) R(0) \\rangle = k_B T K(t)$. We compute the correlation function of the random force.\n$R(0) = \\sum_k c_k \\left(q_k(0) - \\frac{c_k X(0)}{m_k\\omega_k^2}\\right)$. Let's introduce the shifted coordinates $q'_j(0) = q_j(0) - \\frac{c_j X(0)}{m_j\\omega_j^2}$. Then\n$R(t) = \\sum_j \\left( c_j q'_j(0)\\cos(\\omega_j t) + \\frac{c_j p_j(0)}{m_j \\omega_j} \\sin(\\omega_j t) \\right)$\n$R(0) = \\sum_k c_k q'_k(0)$.\nThe correlation function is $\\langle R(t) R(0) \\rangle = \\left\\langle \\left( \\sum_j c_j q'_j(0)\\cos(\\omega_j t) + \\frac{c_j p_j(0)}{m_j \\omega_j} \\sin(\\omega_j t) \\right) \\left( \\sum_k c_k q'_k(0) \\right) \\right\\rangle$.\nThe bath is in canonical equilibrium, described by the bath part of the Hamiltonian, which in terms of $q'_j$ and $p_j$ is $H_{\\text{bath}} = \\sum_j \\left( \\frac{p_j^2}{2m_j} + \\frac{1}{2}m_j\\omega_j^2 (q'_j)^2 \\right)$.\nThe equilibrium averages are:\n$\\langle q'_j(0) \\rangle = 0$, $\\langle p_j(0) \\rangle = 0$.\n$\\langle q'_j(0) p_k(0) \\rangle = 0$ for all $j, k$.\n$\\langle q'_j(0) q'_k(0) \\rangle = \\delta_{jk} \\langle (q'_j)^2 \\rangle$.\nFrom the equipartition theorem, $\\frac{1}{2} m_j \\omega_j^2 \\langle (q'_j)^2 \\rangle = \\frac{1}{2} k_B T$, which gives $\\langle (q'_j)^2 \\rangle = \\frac{k_B T}{m_j \\omega_j^2}$.\nUsing these properties, the correlation function becomes:\n$\\langle R(t) R(0) \\rangle = \\sum_{j,k} c_j c_k \\cos(\\omega_j t) \\langle q'_j(0) q'_k(0) \\rangle = \\sum_j c_j^2 \\cos(\\omega_j t) \\langle (q'_j)^2 \\rangle$\n$\\langle R(t) R(0) \\rangle = \\sum_j c_j^2 \\cos(\\omega_j t) \\frac{k_B T}{m_j \\omega_j^2} = k_B T \\left( \\sum_j \\frac{c_j^2}{m_j \\omega_j^2} \\cos(\\omega_j t) \\right)$\nThe term in the parenthesis is precisely our expression for the memory kernel $K(t)$.\nThus, we have verified the Fluctuation-Dissipation Theorem:\n$$\\langle R(t) R(0) \\rangle = k_B T K(t)$$\n\n### Step 5: Final Answer Formulation\n\nThe problem asks for the dimensionless memory kernel $\\tilde{K}(t) \\equiv K(t)/(M \\gamma \\omega_c)$.\nUsing our result $K(t) = M \\gamma \\omega_c e^{-\\omega_c t}$, we find:\n$$\\tilde{K}(t) = \\frac{M \\gamma \\omega_c e^{-\\omega_c t}}{M \\gamma \\omega_c} = e^{-\\omega_c t}$$",
            "answer": "$$\\boxed{\\exp(-\\omega_c t)}$$"
        },
        {
            "introduction": "While the Generalized Langevin Equation provides a rigorous theoretical framework, practical coarse-grained methods often use simplified, computationally efficient models for friction and noise. This exercise explores Dissipative Particle Dynamics (DPD), a popular method that implements pairwise dissipative and random forces consistent with the fluctuation-dissipation theorem . You will use a mean-field approach to derive a direct relationship between the microscopic DPD force parameters and the macroscopic self-diffusion coefficient, a critical skill for parameterizing coarse-grained models to reproduce target dynamics.",
            "id": "4081632",
            "problem": "You are given a single-bead coarse-grained model based on Dissipative Particle Dynamics (DPD), where the bead interacts with a homogeneous bath via pairwise dissipative and random forces. Using linear response theory and the fluctuation-dissipation principle, derive a mean-field expression for the long-time self-diffusion coefficient $D$ of a DPD bead as a function of the pairwise dissipative coefficient $\\gamma$ and the dissipative weight function $w_D(r)$, assuming an isotropic and homogeneous bath with constant number density $\\rho$ and negligible hydrodynamic correlations. Start from the foundations appropriate to computational complex fluids and coarse-graining methodologies for molecular systems:\n\n- Newton’s Second Law and the definition of velocity as $v = dx/dt$.\n- The Langevin paradigm and linear response of a tagged particle in a thermal bath.\n- The Fluctuation-Dissipation Theorem (FDT) that ensures balance between dissipative and stochastic forces at temperature $T$.\n\nAssume the following well-tested DPD model elements:\n- The pairwise dissipative force between beads $i$ and $j$ has the form $F_{D,ij} = -\\gamma \\, w_D^2(r_{ij}) \\, \\left( ( \\mathbf{v}_i - \\mathbf{v}_j ) \\cdot \\hat{\\mathbf{r}}_{ij} \\right) \\hat{\\mathbf{r}}_{ij}$, where $\\hat{\\mathbf{r}}_{ij}$ is the unit vector from bead $j$ to bead $i$, and $r_{ij}$ is the separation.\n- The random force has zero mean and a variance consistent with the Fluctuation-Dissipation Theorem at temperature $T$.\n\nUnder the mean-field, isotropic, and dilute-bath approximations with a radial distribution function $g(r) = 1$, derive a closed-form expression for the effective friction $\\zeta_{\\text{eff}}$ experienced by the tagged bead in terms of $\\gamma$, $\\rho$, and $w_D(r)$, and use the Einstein relation $D = k_B T / \\zeta_{\\text{eff}}$ to obtain $D$. Here $k_B$ is the Boltzmann constant.\n\nFor computational tractability and scientific realism, take the dissipative weight function to be\n$$\nw_D(r) = \n\\begin{cases}\n(1 - r/r_c)^s,  0 \\le r \\le r_c, \\\\\n0,  r  r_c,\n\\end{cases}\n$$\nwith exponent $s \\ge 0$, and cutoff radius $r_c  0$. Work in the International System of Units (SI) with $k_B = 1.380649 \\times 10^{-23} \\,\\text{J/K}$, temperature $T$ in $\\text{K}$, number density $\\rho$ in $\\text{m}^{-3}$, cutoff radius $r_c$ in $\\text{m}$, dissipative coefficient $\\gamma$ in $\\text{kg/s}$, and diffusion coefficient $D$ in $\\text{m}^2/\\text{s}$. Express all computed diffusion coefficients $D$ in $\\text{m}^2/\\text{s}$. When comparing $D$ to atomistic targets, express the comparison as a relative error defined as $(D - D_{\\text{atom}})/D_{\\text{atom}}$, which is a dimensionless decimal (no percentage sign).\n\nTest Suite:\nCompute $D$ using your derived expression and compare to atomistic target values $D_{\\text{atom}}$ for the following parameter sets. For each case, output the relative error $(D - D_{\\text{atom}})/D_{\\text{atom}}$.\n\n- Case $1$ (happy path): $T = 300$, $\\rho = 1.0 \\times 10^{27}$, $\\gamma = 1.0 \\times 10^{-11}$, $r_c = 1.0 \\times 10^{-9}$, $s = 1$, $D_{\\text{atom}} = 2.5 \\times 10^{-9}$.\n- Case $2$ (boundary weight shape $s=0$): $T = 300$, $\\rho = 1.0 \\times 10^{27}$, $\\gamma = 1.0 \\times 10^{-11}$, $r_c = 1.0 \\times 10^{-9}$, $s = 0$, $D_{\\text{atom}} = 3.0 \\times 10^{-10}$.\n- Case $3$ (edge small cutoff): $T = 300$, $\\rho = 1.0 \\times 10^{27}$, $\\gamma = 1.0 \\times 10^{-11}$, $r_c = 5.0 \\times 10^{-10}$, $s = 1$, $D_{\\text{atom}} = 2.0 \\times 10^{-8}$.\n- Case $4$ (dense bath and softer kernel): $T = 300$, $\\rho = 5.0 \\times 10^{27}$, $\\gamma = 5.0 \\times 10^{-12}$, $r_c = 1.0 \\times 10^{-9}$, $s = 2$, $D_{\\text{atom}} = 4.0 \\times 10^{-9}$.\n\nRequired Final Output Format:\nYour program should produce a single line of output containing the relative errors for all four test cases, rounded to six significant figures, as a comma-separated list enclosed in square brackets, for example, [$e_1,e_2,e_3,e_4$], where each $e_i$ is $(D - D_{\\text{atom}})/D_{\\text{atom}}$ for case $i$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard derivation in the statistical mechanics of soft matter, specifically concerning the parameterization of Dissipative Particle Dynamics (DPD), a coarse-graining method. All required assumptions, physical laws, and mathematical forms are provided, rendering the problem self-contained and solvable. Therefore, the problem is deemed valid.\n\nThe objective is to derive a mean-field expression for the self-diffusion coefficient $D$ of a DPD bead. The derivation proceeds by first calculating the effective friction coefficient $\\zeta_{\\text{eff}}$ experienced by a single bead moving through a static, homogeneous bath of other beads, and then applying the Einstein relation.\n\nStep 1: Total Dissipative Force on a Tagged Bead\nLet us consider a tagged bead, indexed as $i$, moving with velocity $\\mathbf{v}_i$ through a bath of other beads. The total dissipative force $\\mathbf{F}_{D,i}$ exerted on bead $i$ by all other beads $j$ is the sum of pairwise forces:\n$$\n\\mathbf{F}_{D,i} = \\sum_{j \\neq i} \\mathbf{F}_{D,ij}\n$$\nThe problem specifies the form of the pairwise dissipative force:\n$$\n\\mathbf{F}_{D,ij} = -\\gamma \\, w_D^2(r_{ij}) \\, \\left( (\\mathbf{v}_i - \\mathbf{v}_j) \\cdot \\hat{\\mathbf{r}}_{ij} \\right) \\hat{\\mathbf{r}}_{ij}\n$$\nwhere $\\gamma$ is the dissipative coefficient, $w_D(r_{ij})$ is a distance-dependent weight function, $\\mathbf{v}_j$ is the velocity of bead $j$, $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|$ is the separation distance, and $\\hat{\\mathbf{r}}_{ij} = (\\mathbf{r}_i - \\mathbf{r}_j) / r_{ij}$ is the unit vector.\n\nStep 2: Mean-Field Approximation\nTo find the effective friction, we calculate the average dissipative force on bead $i$ as it moves with a constant velocity $\\mathbf{v}_i$. This averaging, denoted by $\\langle \\dots \\rangle$, is performed over the statistical ensemble of bath particle positions and velocities.\n$$\n\\langle \\mathbf{F}_{D,i} \\rangle = -\\gamma \\left\\langle \\sum_{j \\neq i} w_D^2(r_{ij}) \\, \\left( (\\mathbf{v}_i - \\mathbf{v}_j) \\cdot \\hat{\\mathbf{r}}_{ij} \\right) \\hat{\\mathbf{r}}_{ij} \\right\\rangle\n$$\nThe problem assumes a homogeneous bath with no net flow, so the average velocity of any bath particle is zero, $\\langle \\mathbf{v}_j \\rangle = \\mathbf{0}$. The mean-field approximation neglects correlations, allowing us to decouple the averages:\n$$\n\\langle \\mathbf{F}_{D,i} \\rangle \\approx -\\gamma \\sum_{j \\neq i} \\left\\langle w_D^2(r_{ij}) \\, \\left( (\\mathbf{v}_i - \\langle \\mathbf{v}_j \\rangle) \\cdot \\hat{\\mathbf{r}}_{ij} \\right) \\hat{\\mathbf{r}}_{ij} \\right\\rangle = -\\gamma \\sum_{j \\neq i} \\left\\langle w_D^2(r_{ij}) \\, (\\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}_{ij}) \\hat{\\mathbf{r}}_{ij} \\right\\rangle\n$$\nWe replace the sum over discrete particles with an integral over a continuous medium of constant number density $\\rho$. The problem specifies using a radial distribution function $g(r)=1$. The position vector $\\mathbf{r}$ now represents the coordinate of a bath particle relative to the tagged bead $i$.\n$$\n\\langle \\mathbf{F}_{D,i} \\rangle = -\\gamma \\rho \\int_{\\mathbb{R}^3} w_D^2(r) \\, (\\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}) \\hat{\\mathbf{r}} \\, d^3\\mathbf{r}\n$$\nThis average force is the effective drag or friction force, which, according to the Langevin model, is proportional to the velocity: $\\langle \\mathbf{F}_{D,i} \\rangle = -\\zeta_{\\text{eff}} \\mathbf{v}_i$. Thus, we can identify the effective friction coefficient $\\zeta_{\\text{eff}}$.\n\nStep 3: Evaluating the Friction Integral\nLet's analyze the integral term $\\mathbf{I} = \\int_{\\mathbb{R}^3} w_D^2(r) \\, (\\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}) \\hat{\\mathbf{r}} \\, d^3\\mathbf{r}$. This can be written using tensor notation. The $k$-th component of the vector $\\mathbf{I}$ is:\n$$\nI_k = \\sum_{l=1}^3 v_{i,l} \\int_{\\mathbb{R}^3} w_D^2(r) \\hat{r}_k \\hat{r}_l \\, d^3\\mathbf{r}\n$$\nThe integral is a second-rank tensor $M_{kl} = \\int w_D^2(r) \\hat{r}_k \\hat{r}_l \\, d^3\\mathbf{r}$. Since the weight function $w_D(r)$ is isotropic (depends only on the magnitude $r$), the integral is also isotropic. By symmetry, the off-diagonal elements ($k \\neq l$) are zero. The diagonal elements are all equal: $M_{11} = M_{22} = M_{33}$. Let's compute one, say $M_{33}$, in spherical coordinates ($d^3\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$, $\\hat{r}_3 = \\cos\\theta$):\n$$\nM_{33} = \\int_0^\\infty dr \\, r^2 w_D^2(r) \\int_0^\\pi d\\theta \\, \\sin\\theta \\cos^2\\theta \\int_0^{2\\pi} d\\phi\n$$\nThe integrals over the angles are standard: $\\int_0^{2\\pi} d\\phi = 2\\pi$ and $\\int_0^\\pi \\sin\\theta \\cos^2\\theta \\, d\\theta = 2/3$.\nThe tensor $M_{kl}$ is thus $M_{kl} = \\delta_{kl} \\frac{4\\pi}{3} \\int_0^\\infty w_D^2(r) r^2 \\, dr$. Substituting this back, we find that the vector $\\mathbf{I}$ is parallel to $\\mathbf{v}_i$:\n$$\n\\mathbf{I} = \\left( \\frac{4\\pi}{3} \\int_0^\\infty w_D^2(r) r^2 \\, dr \\right) \\mathbf{v}_i\n$$\nFrom this, we identify the effective friction coefficient:\n$$\n\\zeta_{\\text{eff}} = \\frac{4\\pi \\gamma \\rho}{3} \\int_0^\\infty w_D^2(r) r^2 \\, dr\n$$\n\nStep 4: Integration with the Specific Weight Function\nThe problem provides the weight function $w_D(r) = (1 - r/r_c)^s$ for $0 \\le r \\le r_c$ and $w_D(r)=0$ for $r > r_c$. We need to evaluate the integral:\n$$\n\\mathcal{J} = \\int_0^{r_c} \\left[ (1-r/r_c)^s \\right]^2 r^2 \\, dr = \\int_0^{r_c} (1-r/r_c)^{2s} r^2 \\, dr\n$$\nWe perform a change of variables, letting $u = r/r_c$, which gives $r = u r_c$ and $dr = r_c du$.\n$$\n\\mathcal{J} = \\int_0^1 (1-u)^{2s} (u r_c)^2 (r_c du) = r_c^3 \\int_0^1 u^2 (1-u)^{2s} \\, du\n$$\nThis integral is the Euler Beta function, $B(x,y) = \\int_0^1 t^{x-1}(1-t)^{y-1} dt = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$. Here, $x-1=2 \\implies x=3$ and $y-1=2s \\implies y=2s+1$.\n$$\n\\int_0^1 u^2 (1-u)^{2s} \\, du = B(3, 2s+1) = \\frac{\\Gamma(3)\\Gamma(2s+1)}{\\Gamma(3+2s+1)} = \\frac{2! \\, \\Gamma(2s+1)}{\\Gamma(2s+4)}\n$$\nUsing the property $\\Gamma(z+1)=z\\Gamma(z)$, we expand $\\Gamma(2s+4) = (2s+3)(2s+2)(2s+1)\\Gamma(2s+1)$.\n$$\nB(3, 2s+1) = \\frac{2}{(2s+1)(2s+2)(2s+3)}\n$$\nSo, the integral is $\\mathcal{J} = \\frac{2 r_c^3}{(2s+1)(2s+2)(2s+3)}$.\n\nStep 5: Final Expression for the Diffusion Coefficient\nSubstituting the result of the integral $\\mathcal{J}$ into the expression for $\\zeta_{\\text{eff}}$:\n$$\n\\zeta_{\\text{eff}} = \\frac{4\\pi \\gamma \\rho}{3} \\left( \\frac{2 r_c^3}{(2s+1)(2s+2)(2s+3)} \\right) = \\frac{8\\pi \\gamma \\rho r_c^3}{3(2s+1)(2s+2)(2s+3)}\n$$\nFinally, we use the Einstein relation, $D = k_B T / \\zeta_{\\text{eff}}$, where $k_B$ is the Boltzmann constant and $T$ is the temperature, to obtain the self-diffusion coefficient:\n$$\nD = \\frac{k_B T}{\\zeta_{\\text{eff}}} = \\frac{k_B T (3(2s+1)(2s+2)(2s+3))}{8\\pi \\gamma \\rho r_c^3} = \\frac{3 k_B T (2s+1)(2s+2)(2s+3)}{8\\pi \\gamma \\rho r_c^3}\n$$\nThis is the required closed-form expression. This expression is now implemented to compute $D$ for the given test cases and calculate the relative error $(D - D_{\\text{atom}})/D_{\\text{atom}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a mean-field expression for the DPD self-diffusion coefficient.\n    \"\"\"\n    \n    # Constants\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Test cases: (T, rho, gamma, r_c, s, D_atom)\n    test_cases = [\n        # Case 1 (happy path)\n        (300.0, 1.0e27, 1.0e-11, 1.0e-9, 1.0, 2.5e-9),\n        # Case 2 (boundary weight shape s=0)\n        (300.0, 1.0e27, 1.0e-11, 1.0e-9, 0.0, 3.0e-10),\n        # Case 3 (edge small cutoff)\n        (300.0, 1.0e27, 1.0e-11, 5.0e-10, 1.0, 2.0e-8),\n        # Case 4 (dense bath and softer kernel)\n        (300.0, 5.0e27, 5.0e-12, 1.0e-9, 2.0, 4.0e-9),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T, rho, gamma, r_c, s, D_atom = case\n        \n        # Derived formula for D\n        # D = (3 * k_B * T * (2*s+1) * (2*s+2) * (2*s+3)) / (8 * pi * gamma * rho * r_c**3)\n        \n        numerator = 3 * k_B * T * (2 * s + 1) * (2 * s + 2) * (2 * s + 3)\n        denominator = 8 * np.pi * gamma * rho * (r_c**3)\n        \n        D_calculated = numerator / denominator\n        \n        # Calculate the relative error\n        relative_error = (D_calculated - D_atom) / D_atom\n        \n        # Format to six significant figures and append to results\n        formatted_error = \"{:.6g}\".format(relative_error)\n        results.append(formatted_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Coarse-graining methods that focus solely on matching structure, such as Iterative Boltzmann Inversion (IBI), often fail to reproduce other important macroscopic properties like pressure. This exercise introduces a practical strategy to address this shortcoming by augmenting the potential with a simple, tunable long-range tail . Starting from the virial theorem, you will derive the analytical contribution of this correction to the system's pressure, illustrating a powerful technique for creating more accurate and transferable coarse-grained models.",
            "id": "4081636",
            "problem": "Consider an isotropic, homogeneous, single-component coarse-grained fluid at number density $\\rho$ and temperature $T$, where interactions are represented by a pairwise central coarse-grained potential $u(r)$ truncated and shifted to zero at a cutoff distance $r_{c}$. You use Iterative Boltzmann Inversion (IBI) to match the target radial distribution function $g_{\\mathrm{target}}(r)$, but you also wish to correct a residual pressure mismatch by adding a long-range tail controlled by a scalar parameter. To avoid altering structure in the region that primarily determines $g(r)$, you introduce a smooth pressure-correction tail that acts only in a window $[r_{t}, r_{c}]$ with $0  r_{t}  r_{c}$, defined as\n$$\nu_{\\mathrm{tail}}(r) =\n\\begin{cases}\n-\\lambda \\left(1 - \\frac{r}{r_{c}}\\right),  r_{t} \\leq r \\leq r_{c}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\lambda$ is a small, tunable energy-scale parameter. The total potential entering IBI becomes $u(r) = u_{0}(r) + u_{\\mathrm{tail}}(r)$, where $u_{0}(r)$ is the pre-existing coarse-grained potential.\n\nStarting from the mechanical definition of pressure for a fluid with pairwise central forces and using the virial theorem, derive an analytic expression for the change in virial pressure $\\Delta P(\\lambda)$ induced solely by the addition of $u_{\\mathrm{tail}}(r)$. Explicitly state any approximations you use. In particular, assume that the structural region $r  r_{t}$ remains unchanged and that in the window $[r_{t}, r_{c}]$ the pair structure is close to ideal so that $g(r) \\approx 1$.\n\nYour final answer must be a single closed-form analytic expression for $\\Delta P(\\lambda)$ in terms of $\\rho$, $r_{t}$, $r_{c}$, and $\\lambda$. Express the final pressure change in Joules per cubic meter if numerical values are substituted. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in statistical mechanics, well-posed, objective, and contains sufficient information for a unique solution. The approximations requested are standard in the context of coarse-grained modeling.\n\nThe pressure $P$ of a homogeneous, isotropic fluid composed of particles interacting via a pairwise central potential $u(r)$ can be expressed using the virial theorem as the sum of an ideal gas term and an excess term arising from intermolecular forces:\n$$\nP = \\rho k_{B} T + P_{\\mathrm{virial}}\n$$\nwhere $\\rho$ is the number density, $k_{B}$ is the Boltzmann constant, and $T$ is the absolute temperature. The virial or excess pressure, $P_{\\mathrm{virial}}$, is given by the integral over the pair-virial function:\n$$\nP_{\\mathrm{virial}} = -\\frac{1}{6} \\int_V \\rho^{(2)}(\\mathbf{r}_1, \\mathbf{r}_2) \\, \\mathbf{r}_{12} \\cdot \\nabla_1 u(|\\mathbf{r}_{12}|) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nFor a homogeneous and isotropic system, the two-body density $\\rho^{(2)}(\\mathbf{r}_1, \\mathbf{r}_2)$ can be written as $\\rho^2 g(|\\mathbf{r}_{12}|)$, where $g(r)$ is the radial distribution function and $r = |\\mathbf{r}_{12}|$. The expression for the virial pressure simplifies to:\n$$\nP_{\\mathrm{virial}} = -\\frac{2\\pi\\rho^2}{3} \\int_{0}^{\\infty} r^3 \\frac{du(r)}{dr} g(r) dr\n$$\nThe problem specifies that the potential is truncated at a cutoff distance $r_{c}$, so the integral's upper limit is $r_{c}$. The total potential is given as the sum of a base potential $u_{0}(r)$ and a pressure-correction tail potential $u_{\\mathrm{tail}}(r)$, i.e., $u(r) = u_{0}(r) + u_{\\mathrm{tail}}(r)$.\n\nThe problem asks for the change in virial pressure, $\\Delta P(\\lambda)$, induced solely by the addition of $u_{\\mathrm{tail}}(r)$. This quantity is the contribution to the total virial pressure that arises directly from the tail potential term. It is calculated by substituting $u_{\\mathrm{tail}}(r)$ into the virial pressure formula:\n$$\n\\Delta P(\\lambda) = -\\frac{2\\pi\\rho^2}{3} \\int_{0}^{r_{c}} r^3 \\frac{du_{\\mathrm{tail}}(r)}{dr} g(r) dr\n$$\nHere, $g(r)$ is the radial distribution function of the system with the total potential $u(r)$.\n\nThe tail potential $u_{\\mathrm{tail}}(r)$ is defined as:\n$$\nu_{\\mathrm{tail}}(r) =\n\\begin{cases}\n-\\lambda \\left(1 - \\frac{r}{r_{c}}\\right),  r_{t} \\leq r \\leq r_{c}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nwhere $0  r_{t}  r_{c}$. The derivative of $u_{\\mathrm{tail}}(r)$ with respect to $r$ is:\n$$\n\\frac{du_{\\mathrm{tail}}(r)}{dr} = \\frac{d}{dr} \\left(-\\lambda + \\frac{\\lambda r}{r_c}\\right) = \\frac{\\lambda}{r_c}\n$$\nfor $r \\in [r_{t}, r_{c}]$. Outside this interval, the derivative is $0$. Therefore, the integral for $\\Delta P(\\lambda)$ only needs to be evaluated over the interval $[r_{t}, r_{c}]$:\n$$\n\\Delta P(\\lambda) = -\\frac{2\\pi\\rho^2}{3} \\int_{r_{t}}^{r_{c}} r^3 \\left(\\frac{\\lambda}{r_c}\\right) g(r) dr\n$$\nThe problem provides a key approximation: in the window $[r_{t}, r_{c}]$, the pair structure is close to ideal, which allows us to set $g(r) \\approx 1$. Applying this approximation simplifies the integral:\n$$\n\\Delta P(\\lambda) \\approx -\\frac{2\\pi\\rho^2}{3} \\int_{r_{t}}^{r_{c}} r^3 \\left(\\frac{\\lambda}{r_c}\\right) (1) dr\n$$\nWe can pull the constants, including the parameter $\\lambda$, out of the integral:\n$$\n\\Delta P(\\lambda) = -\\frac{2\\pi\\rho^2\\lambda}{3r_c} \\int_{r_{t}}^{r_{c}} r^3 dr\n$$\nNow, we evaluate the definite integral of $r^3$:\n$$\n\\int_{r_{t}}^{r_{c}} r^3 dr = \\left[ \\frac{r^4}{4} \\right]_{r_{t}}^{r_{c}} = \\frac{r_c^4}{4} - \\frac{r_t^4}{4} = \\frac{1}{4}(r_c^4 - r_t^4)\n$$\nSubstituting this result back into the expression for $\\Delta P(\\lambda)$:\n$$\n\\Delta P(\\lambda) = -\\frac{2\\pi\\rho^2\\lambda}{3r_c} \\left( \\frac{r_c^4 - r_t^4}{4} \\right)\n$$\nSimplifying the numerical factors gives the final analytical expression for the change in virial pressure due to the tail potential:\n$$\n\\Delta P(\\lambda) = -\\frac{2\\pi\\rho^2\\lambda(r_c^4 - r_t^4)}{12r_c} = -\\frac{\\pi\\rho^2\\lambda}{6r_c} (r_c^4 - r_t^4)\n$$\nThis expression depends only on the specified parameters $\\rho$, $r_{t}$, $r_{c}$, and $\\lambda$. The problem states that if numerical values are substituted, the pressure change should be in Joules per cubic meter. A check of the units confirms this: with $\\rho$ in $m^{-3}$, $\\lambda$ in $J$, and $r_t, r_c$ in $m$, the units of $\\Delta P(\\lambda)$ are $\\frac{(m^{-3})^2 J}{m} (m^4) = J \\cdot m^{-3}$. Since $1 \\, J = 1 \\, N \\cdot m$, this is equivalent to $N \\cdot m^{-2}$, or Pascals ($Pa$), the standard SI unit of pressure.",
            "answer": "$$\n\\boxed{-\\frac{\\pi \\rho^{2} \\lambda}{6 r_{c}} (r_{c}^{4} - r_{t}^{4})}\n$$"
        }
    ]
}