## 引言
在计算科学领域，模拟分子系统的行为是理解从[蛋白质折叠](@entry_id:136349)到新材料设计的关键。然而，许多重要的物理和化学过程发生的时间和空间尺度，远远超出了传统全原子模拟的计算能力。为了弥合这一鸿沟，[粗粒化](@entry_id:141933)（Coarse-graining）方法应运而生，它通过系统性地简化系统表示、减少自由度，极大地扩展了[分子模拟](@entry_id:1128112)的疆界。这种方法使我们能够以可接受的计算成本，研究以往难以企及的复杂大尺度现象。

本文旨在为分子系统的[粗粒化方法](@entry_id:1122585)提供一个系统而深入的介绍。文章的核心问题是：我们如何在牺牲原子细节的同时，构建出既能保持计算效率，又能忠实再现系统关键物理化学性质的简化模型？我们将探讨这一问题背后的理论基础、主流方法以及实际应用中的挑战与策略。

为了构建一个全面的知识体系，本文将分为三个核心章节。在接下来的“原理与机制”一章中，我们将深入探讨[粗粒化](@entry_id:141933)背后的统计力学基础，从数学定义到[平均力势](@entry_id:137947)的概念，并系统比较各类构建有效势的策略。随后，“应用与跨学科连接”一章将通过生物物理、材料科学等领域的丰富实例，展示这些理论在解决实际科学问题中的强大威力。最后，“动手实践”部分将提供一系列精心设计的问题，引导读者将理论知识转化为解决实际计算问题的能力。通过这一结构，读者将不仅学会[粗粒化方法](@entry_id:1122585)的“如何做”，更能深刻理解其“为什么”。

## 原理与机制

在上一章引言的基础上，本章将深入探讨分子系统[粗粒化方法](@entry_id:1122585)背后的核心科学原理与关键机制。我们将从[粗粒化](@entry_id:141933)的数学定义出发，系统地介绍各类主流的[粗粒化](@entry_id:141933)策略，并严谨地分析这些方法的内在联系、优势与固有的局限性。本章的目标是为读者构建一个坚实的理论框架，使其不仅能够理解如何执行[粗粒化](@entry_id:141933)，更能洞悉其为何有效以及在何种情况下可能失效。

### [粗粒化](@entry_id:141933)：从微观到介观的映射

[粗粒化](@entry_id:141933)的本质是一个[降维](@entry_id:142982)过程，它通过一个数学上的**映射**（mapping）将高维的、包含所有原子细节的微观（或称细粒度，fine-grained, FG）坐标空间，投影到一个低维的、仅描述关键自由度的介观（或称粗粒度，coarse-grained, CG）坐标空间。

#### 映射算符与坐标

形式上，这个过程由一个**映射算符** $\mathcal{M}$ 定义。对于一个包含 $N$ 个原子的系统，其微观构型由一个 $3N$ 维的[坐标向量](@entry_id:153319) $\mathbf{r} \in \mathbb{R}^{3N}$ 描述。映射算符 $\mathcal{M}$ 将此向量转换为一个包含 $n$ 个[粗粒化](@entry_id:141933)珠子（beads）的 $3n$ 维[坐标向量](@entry_id:153319) $\mathbf{R} \in \mathbb{R}^{3n}$（其中 $n  N$）：
$$
\mathbf{R} = \mathcal{M}(\mathbf{r})
$$

映射算符的选择是[粗粒化](@entry_id:141933)建模的第一步，也是至关重要的一步。最常见的映射方式是线性的，例如将一组原子定义为一个[粗粒化](@entry_id:141933)珠子，并将其位置确定为这组原子的[质心](@entry_id:138352)。假设一个珠子 $I$ 对应于原子集合 $G_I$，其位置 $\mathbf{R}_I$ 可以定义为：
$$
\mathbf{R}_I = \frac{1}{M_I} \sum_{i \in G_I} m_i \mathbf{r}_i
$$
其中 $m_i$ 是原子 $i$ 的质量，$\mathbf{r}_i$ 是其位置，而 $M_I = \sum_{i \in G_I} m_i$ 是该珠子的总质量。这种[质心](@entry_id:138352)映射是一种[线性映射](@entry_id:185132)，可以表示为矩阵形式 $\mathbf{R} = \mathbf{W}\mathbf{r}$。

从数学角度看，一个“良好”的映射算符应具备某些理想性质。例如，**满射性**（surjectivity）保证了CG坐标空间中的任何一个构型 $\mathbf{R}$ 都是可达的，即总能找到至少一个微观构型 $\mathbf{r}$ 与之对应。对于[线性映射](@entry_id:185132) $\mathbf{R} = \mathbf{W}\mathbf{r}$，满射性的充分必要条件是映射矩阵 $\mathbf{W}$ 的秩等于CG空间的维度，即 $\operatorname{rank}(\mathbf{W})=3n$。此外，映射算符的**[可微性](@entry_id:140863)**（differentiability）对于后续推导CG动力学至关重要，因为它保证了速度和力等物理量可以在两个尺度之间平滑地转换。[质心](@entry_id:138352)映射就是一种处处可微的[线性映射](@entry_id:185132) 。当然，也存在[非线性](@entry_id:637147)或分段定义的映射，但它们可能会在特定构型上引入[奇异点](@entry_id:199525)或不连续性，给理论分析和实际应用带来挑战。

#### [粗粒化](@entry_id:141933)分布与平均力势

一旦定义了映射，我们便可以探讨它如何改变系统的[统计系综](@entry_id:149738)。在[正则系综](@entry_id:142391)中，微观系统处于[平衡态](@entry_id:270364)的[概率密度函数](@entry_id:140610)（PDF）由玻尔兹曼分布给出：
$$
p_{\text{FG}}(\mathbf{r}) = Z_{\text{FG}}^{-1} \exp(-\beta U_{\text{FG}}(\mathbf{r}))
$$
其中 $U_{\text{FG}}(\mathbf{r})$ 是微观势能，$\beta = 1/(k_{\mathrm{B}} T)$ 是逆温度，$Z_{\text{FG}}$ 是[归一化常数](@entry_id:752675)，即[配分函数](@entry_id:140048)。

CG坐标的[平衡概率](@entry_id:187870)分布 $p_{\text{CG}}(\mathbf{R})$ 并非对微观概率的简单平均，而是通过对所有能够映射到同一CG构型 $\mathbf{R}$ 的微观构型进行积分（或称[边缘化](@entry_id:264637)）得到的。这在数学上被称为[前推测度](@entry_id:201640)（pushforward measure），其形式化表达如下 ：
$$
p_{\text{CG}}(\mathbf{R}) = \int d\mathbf{r}\, p_{\text{FG}}(\mathbf{r}) \,\delta(\mathbf{R} - \mathcal{M}(\mathbf{r}))
$$
这里的 $\delta$ 函数起到了一个约束作用，它将积分限制在满足 $\mathcal{M}(\mathbf{r}) = \mathbf{R}$ 的所有微观构型 $\mathbf{r}$ 构成的子空间上。

这个CG概率分布 $p_{\text{CG}}(\mathbf{R})$ 是[粗粒化](@entry_id:141933)理论的基石。根据统计力学的基本原理，任何一个[平衡概率](@entry_id:187870)分布都可以通过一个有效的[势能函数](@entry_id:200753)以玻尔兹曼形式表示。由此，我们定义了**[平均力势](@entry_id:137947)**（Potential of Mean Force, PMF）：
$$
U_{\text{PMF}}(\mathbf{R}) = -k_{\mathrm{B}} T \ln p_{\text{CG}}(\mathbf{R}) + C
$$
其中 $C$ 是一个任意的常数。$U_{\text{PMF}}(\mathbf{R})$ 是一个理想的、精确的CG[势能函数](@entry_id:200753)。如果一个CG模型使用了 $U_{\text{PMF}}(\mathbf{R})$ 作为其势能，那么它在[平衡态](@entry_id:270364)下将完美地重现正确的CG坐标分布 $p_{\text{CG}}(\mathbf{R})$。然而，PMF通常是一个复杂的多体函数，它隐含了所有被积掉的自由度的平均效应，直接计算或使用它几乎是不可能的。因此，所有实用的[粗粒化方法](@entry_id:1122585)，其核心目标都可以被看作是寻找一个更简单的、可计算的**[有效势](@entry_id:1124192)** $U_{\text{CG}}(\mathbf{R})$ 来近似 $U_{\text{PMF}}(\mathbf{R})$。

### [有效势](@entry_id:1124192)的构建策略

寻找[有效势](@entry_id:1124192) $U_{\text{CG}}$ 的过程是[粗粒化方法](@entry_id:1122585)论的核心。根据其优化目标和所需输入信息的不同，这些方法大致可以分为三类：基于结构、基于力和基于信息论的方法。

#### [基于结构的粗粒化](@entry_id:188183)方法

这类方法旨在调整CG势的参数，使得CG模拟能够重现源于FG模拟的某些关键结构特征。最典型的目标是**[径向分布函数](@entry_id:1129297)**（radial distribution function, RDF），$g(r)$，它描述了粒子间距的概率分布。

**[迭代玻尔兹曼反演](@entry_id:164710)**（Iterative Boltzmann Inversion, IBI）是该领域的经典方法。它通常用于推导各向同性的[成对势](@entry_id:1135706) $u(r)$。IBI的核心思想是一个简单的迭代修正方案。在第 $n$ 步迭代中，使用当前的势 $u_n(r)$ 进行CG模拟，得到径向分布函数 $g_n(r)$。然后，将此势与目标RDF $g_{\text{target}}(r)$ 进行比较，并按以下规则更新势能 ：
$$
u_{n+1}(r) = u_n(r) + \alpha k_{\mathrm{B}} T \ln \left(\frac{g_n(r)}{g_{\text{target}}(r)}\right)
$$
其中 $\alpha$ 是一个取值在 $(0, 1]$ 之间的阻尼因子，用于稳定迭代过程。这个更新规则的直觉非常清晰：如果在某个距离 $r$ 上，$g_n(r) > g_{\text{target}}(r)$（即粒子过于聚集），那么 $\ln(g_n/g_{\text{target}}) > 0$，势能 $u_{n+1}(r)$ 将会增加，从而增强该距离处的排斥力，反之亦然。

当迭代收敛时，我们达到一个不动点，此时 $u_{n+1}(r) \approx u_n(r)$。从更新公式可知，这必然意味着 $g_n(r) \approx g_{\text{target}}(r)$。在理想的低密度极限下，粒子间的相关性很弱，PMF可以近似为成对势，$w(r) \approx u(r)$。由于 $g(r) = \exp(-\beta w(r))$，这导出了一个简单的关系 $u(r) = -k_{\mathrm{B}} T \ln g(r)$，这被称为**[玻尔兹曼反演](@entry_id:746907)**。IBI通常就使用这个关系式作为初始猜测。IBI的优点在于其概念简单、实现容易，并且只需要结构信息（$g(r)$）作为输入。

#### 基于力的[粗粒化方法](@entry_id:1122585)

与关注结构的方法不同，**[力匹配](@entry_id:1125205)**（Force Matching, FM）方法旨在使CG模型的[力场](@entry_id:147325)尽可能地逼近“真实”的CG力。这里的“真实”CG力是通过映射算符从底层的[原子间力](@entry_id:1126573)得到的。对于一个CG珠子 $I$，其参考力 $\mathbf{F}_{I}^{\text{ref}}$ 是构成该珠子的所有原子受到的力的总和：$\mathbf{F}_{I}^{\text{ref}} = \sum_{i \in G_I} \mathbf{f}_i^{\text{FG}}$。

FM方法的目标是最小化模型力与参考力之间的差异。通常，我们将CG势能 $U_{\text{CG}}$ [参数化](@entry_id:265163)为一组基函数的线性组合，例如 $U_{\text{CG}}(\mathbf{R}; \mathbf{a}) = \sum_{k=1}^{K} a_{k}\psi_{k}(\mathbf{R})$，其中 $\mathbf{a}$ 是待定系数。对应的模型力为 $\mathbf{F}_{\text{CG}}(\mathbf{R}; \mathbf{a}) = -\nabla_{\mathbf{R}} U_{\text{CG}}$。然后，通过最小化一个最小二乘[目标函数](@entry_id:267263)来求解最优参数 $\widehat{\mathbf{a}}$ ：
$$
\mathcal{J}(\mathbf{a}) = \sum_{t=1}^{T} \left\| \mathbf{F}_{\text{CG}}(\mathbf{R}_{t}; \mathbf{a}) - \mathbb{E}[\mathbf{F} \mid \mathbf{R}_{t}] \right\|^{2}
$$
其中，求和遍历从FG模拟中提取的 $T$ 个构象快照，$\mathbb{E}[\mathbf{F} \mid \mathbf{R}_{t}]$ 是在给定CG构型 $\mathbf{R}_t$ 的条件下，微观力的[条件期望](@entry_id:159140)，即平均CG力。在实践中，这个[条件期望](@entry_id:159140)通常被瞬时映射力 $\mathbf{F}^{\text{ref}}(\mathbf{R}_t)$ 所近似。如果势能是线性[参数化](@entry_id:265163)的，那么这个问题就简化为一个标准的[线性回归](@entry_id:142318)问题，其解具有解析形式：
$$
\widehat{\mathbf{a}} = - \left( \sum_{t=1}^{T} \mathbf{G}(\mathbf{R}_{t})^{\top} \mathbf{G}(\mathbf{R}_{t}) \right)^{-1} \left( \sum_{t=1}^{T} \mathbf{G}(\mathbf{R}_{t})^{\top} \mathbb{E}[\mathbf{F} \mid \mathbf{R}_{t}] \right)
$$
其中 $\mathbf{G}(\mathbf{R})$ 是由基函数梯度构成的矩阵。

[力匹配方法](@entry_id:1125215)的主要优势在于它是一种非迭代的、系统性的方法，并且能够自然地处理包括键、角、[二面角](@entry_id:185221)在内的任意[多体势](@entry_id:1135703)能形式。由于力是PMF的梯度，匹配力在理论上比匹配结构（如$g(r)$）更能捕捉[势能面](@entry_id:143655)的细节，因此通过FM得到的势能通常具有更好的**[传递性](@entry_id:141148)**（transferability），即在不同温度或密度下仍然表现良好 。其主要代价是需要获取并存储底层的原子级别力信息，这对计算资源的要求更高。

#### 基于信息论的[粗粒化方法](@entry_id:1122585)

这类方法将CG问题置于一个更严谨的统计推断框架中。其核心思想是，寻找一个[参数化](@entry_id:265163)的CG模型概率分布 $P_\theta(\mathbf{R})$，使其与真实的（但未知的）CG分布 $P_{\text{map}}(\mathbf{R})$ “最接近”。这种“接近”程度通常用**[相对熵](@entry_id:263920)**（relative entropy）或称**Kullback-Leibler (KL) 散度**来衡量。

[相对熵最小化](@entry_id:754220)方法的目标是求解以下优化问题 ：
$$
\min_{\theta} D_{\text{KL}}(P_{\text{map}} \| P_\theta) = \min_{\theta} \int P_{\text{map}}(\mathbf{R}) \ln\frac{P_{\text{map}}(\mathbf{R})}{P_\theta(\mathbf{R})} d\mathbf{R}
$$
可以证明，最小化此[KL散度](@entry_id:140001)等价于最大化从 $P_{\text{map}}$ 中抽样的数据在模型 $P_\theta$ 下的[似然函数](@entry_id:921601)。对于一个玻尔兹曼形式的CG模型 $P_\theta(\mathbf{R}) \propto \exp(-\beta U_\theta(\mathbf{R}))$，这个优化目标可以被展开为：
$$
\min_{\theta} \left( \beta \langle U_\theta(\mathbf{R}) \rangle_{P_{\text{map}}} + \ln Z_\theta \right)
$$
其中 $\langle \cdot \rangle_{P_{\text{map}}}$ 表示在真实CG分布下的系综平均，$Z_\theta$ 是CG模型的[配分函数](@entry_id:140048)。

该方法的一个极其优美的结果是，当CG势能被线性[参数化](@entry_id:265163)为 $U_\theta(\mathbf{R})=\sum_{i}\theta_i \phi_i(\mathbf{R})$ 时，最小化[相对熵](@entry_id:263920)的充分必要条件是**[矩匹配](@entry_id:144382)**（moment-matching）：
$$
\langle \phi_i(\mathbf{R}) \rangle_{P_{\text{map}}} = \langle \phi_i(\mathbf{R}) \rangle_{P_\theta} \quad \text{for all } i
$$
这意味着，最优的CG模型必须能够重现所有基函数 $\phi_i$ 的系综平均值。这个结论建立了一座桥梁：像IBI这样的结构匹[配方法](@entry_id:265480)，如果其目标（如$g(r)$）可以表示为某个（或某些）基函数的平均值，那么它就可以被看作是[相对熵最小化](@entry_id:754220)方法的一个特例。这为结构匹[配方法](@entry_id:265480)提供了坚实的理论基础。

### [粗粒化](@entry_id:141933)模型的局限性与挑战

尽管[粗粒化方法](@entry_id:1122585)取得了巨大成功，但它们并非万能。理解其内在的局限性对于正确应用和解读CG模拟至关重要。

#### 成对势的表征性问题

一个核心的挑战是**表征性问题**（representability problem）：一个简单的、通常是成对可加的CG势，能在多大程度上代表一个具有复杂[多体相互作用](@entry_id:751663)的底层系统？答案是：能力有限。

一个著名的例子是，仅仅匹配[径向分布函数](@entry_id:1129297) $g(r)$ 并不足以唯一确定系统的所有性质。根据[Henderson唯一性定理](@entry_id:1126015)，在给定温度和密度下，对于一个成对相互作用的系统，其$g(r)$确实唯一地决定了其成对势$u(r)$ 。但是，如果底层系统包含显著的非成对（如[三体](@entry_id:265960)）相互作用或[各向异性相互作用](@entry_id:161673)，那么就可能存在多个不同的微观模型（例如，一个纯成对势模型，另一个是成对+三体势模型），它们在某个特定的状态点（温度、密度）能够产生完全相同的$g(r)$。

然而，这些在二体结构上“简并”的模型，在更高阶的结构（如三体关联函数 $g^{(3)}$）或[热力学性质](@entry_id:146047)上却可能表现出显著差异。例如，压力、能量或化学势等[热力学](@entry_id:172368)量并不是$g(r)$的唯一函数。一个仅能重现$g(r)$的CG模型，其计算出的压力可能与真实系统的压力大相径庭。这个问题可以通过一个思想实验来说明：在[液态理论](@entry_id:182111)中，系统的压缩性可以通过两条路径计算——一条是通过$g(r)$的积分（结构路径），另一条是通过[直接关联函数](@entry_id:158301)$c(r)$的积分（压缩路径）。对于一个精确的理论，两条路径应给出相同的结果。然而，对于一个近似的CG模型（例如，通过IBI得到，并使用像HNC这样的近似闭合关系），这两条路径的计算结果往往不一致，其差值反映了模型内在的[热力学](@entry_id:172368)不[自洽性](@entry_id:160889) 。

#### [传递性](@entry_id:141148)的挑战与多目标匹配

另一个重大挑战是**[传递性](@entry_id:141148)**（transferability），即在一个状态点（如特定的温度$T_1$和密度$\rho_1$）[参数化](@entry_id:265163)的CG势，在另一个状态点（$T_2, \rho_2$）是否依然有效。通常，通过简单结构匹配（如IBI）得到的势是“状态依赖”的，其[传递性](@entry_id:141148)较差。这是因为有效势 $U_{\text{CG}}$ 实际上是在替身（proxy）被平均掉的自由度，而这些自由度的统计行为会随状态点而改变。

为了构建更具物理意义和更好[传递性](@entry_id:141148)的模型，必须在[参数化](@entry_id:265163)过程中引入更多的约束。仅仅匹配$g(r)$是远远不够的。一个现代的、更可靠的[粗粒化](@entry_id:141933)策略是**多目标匹配**，即同时优化模型以重现一系列来自底层FG模拟的、[相互独立](@entry_id:273670)的目标 。这些目标可以包括：
1.  **高阶结构关联**：例如，键角分布函数或三体关联函数 $g^{(3)}$，以捕捉局部几何特征。
2.  **[热力学性质](@entry_id:146047)**：例如，将压力、能量或等温[压缩系数](@entry_id:272630)作为显式优化目标，以保证热力学一致性。
3.  **各向异性结构**：对于非球形分子，除了中心-中心$g(r)$外，还需匹配取向关联函数，例如$g(r, \cos\theta)$，它描述了粒子在不同间距下的相对取向分布。

通过将这些更丰富的信息融入CG势的构建过程中，我们迫使模型不仅模仿结构，还要遵循更深层次的物理规律，从而显著提升其预测能力和在不同环境下的可靠性。

### [粗粒化](@entry_id:141933)动力学：时间尺度的分离

到目前为止，我们的讨论主要集中在如何重现[平衡态](@entry_id:270364)的静态结构性质。然而，[粗粒化](@entry_id:141933)也旨在加速动力学模拟，这就引出了一个新问题：CG变量的时间演化应该遵循什么样的[运动方程](@entry_id:264286)？

#### 广义朗之万方程

简单地将CG势用于[牛顿运动方程](@entry_id:165068)是错误的。根据Mori-[Zwanzig投影](@entry_id:158200)算符理论，当我们将系统的自由度分为“慢”的CG变量（$\mathbf{R}$）和“快”的被积掉的变量时，慢变量的精确[动力学方程](@entry_id:751029)并非一个简单的[二阶微分方程](@entry_id:269365)。相反，它是一个**[广义朗之万方程](@entry_id:158854)**（Generalized Langevin Equation, GLE） ：
$$
m\ddot{\mathbf{R}}(t) = -\nabla_{\mathbf{R}} U_{\text{PMF}}(\mathbf{R}(t)) - \int_{0}^{t} K(t-s)\,\dot{\mathbf{R}}(s)\,ds + \mathbf{F}_{R}(t)
$$
与牛顿方程相比，GLE多了两项：
- **记忆核（Memory Kernel）$K(t)$**：这是一个时间依赖的摩擦项。它表明CG珠子感受到的摩擦力不仅取决于其当前速度，还取决于其过去所有时刻的速度历史。这种“记忆”效应是被积掉的快自由度对慢变量产生持续影响的直接后果。
- **随机力（Random Force）$\mathbf{F}_{R}(t)$**：这是一个有色的、非马尔可夫的随机噪声项，代表了快自由度对慢变量的随机“踢动”。

这个方程的有效性，以及任何CG模拟的合理性，都建立在一个基本假设之上：**时间尺度分离**。即，存在一个清晰的界限，将被积掉的自由度的特征[弛豫时间](@entry_id:191572) $\tau_{\text{f}}$（例如，由记忆核的衰减时间决定）与我们关心的CG变量的特征[弛豫时间](@entry_id:191572) $\tau_{\text{s}}$ 分开。只有当 $\tau_{\text{s}} \gg \tau_{\text{f}}$，即慢变量确实“很慢”，快变量确实“很快”时，[粗粒化](@entry_id:141933)的概念才具有物理意义。这个时间尺度分离的程度可以通过一个无量纲参数 $\epsilon = \tau_{\text{f}} / \tau_{\text{s}}$ 来量化。一个小的 $\epsilon$ 值是CG模型成功的先决条件 。在许多情况下，如果[时间尺度分离](@entry_id:149780)足够好（$\epsilon \ll 1$），GLE可以被近似为一个标准的（马尔可夫）朗之万方程，其中的摩擦项变为与速度成正比的常数摩擦，随机力也变为[白噪声](@entry_id:145248)。

#### 涨落-耗散定理

在GLE或其[马尔可夫近似](@entry_id:1127636)中，摩擦项和随机力项并非[相互独立](@entry_id:273670)。它们必须满足一个深刻的物理关系，即**第二类[涨落-耗散定理](@entry_id:1125114)**（Fluctuation-Dissipation Theorem, FDT）。该定理确保了耗散（通过摩擦）和涨落（通过随机力）之间的平衡，从而使得系统在长时间演化后能够维持在正确的温度下，并采样正确的[平衡态](@entry_id:270364)（玻尔兹曼）分布。

对于GLE，FDT表现为记忆核与随机力[自相关函数](@entry_id:138327)之间的关系：$\langle \mathbf{F}_{R}(t) \cdot \mathbf{F}_{R}(0) \rangle = d k_{\mathrm{B}} T K(t)$（其中$d$为维度）。在更简单的马尔可夫[朗之万动力学](@entry_id:142305)模型中，这个定理简化为一个更广为人知的形式。考虑一个CG粒子在势场 $U_{\text{CG}}$ 中的运动，其动力学由以下[朗之万方程](@entry_id:144277)描述 ：
$$
\dot{\mathbf{P}}(t) = -\nabla U_{\text{CG}}(\mathbf{R}(t)) - \frac{\gamma}{M} \mathbf{P}(t) + \boldsymbol{\eta}(t)
$$
其中 $\gamma$ 是[摩擦系数](@entry_id:150354)，$\boldsymbol{\eta}(t)$ 是[高斯白噪声](@entry_id:749762)，其协方差为 $\langle \eta_i(t) \eta_j(t') \rangle = 2 D \delta_{ij} \delta(t-t')$，$D$为噪声强度。为了使该系统能够正确地采样正则系综分布 $\rho_{\text{eq}} \propto \exp(-\beta H_{\text{CG}})$，噪[声强](@entry_id:1120700)度 $D$ 和[摩擦系数](@entry_id:150354) $\gamma$ 必须满足以下关系：
$$
D = \gamma k_{\mathrm{B}} T
$$
因此，噪声的协方差必须为：
$$
\langle \eta_i(t) \eta_j(t') \rangle = 2 \gamma k_{\mathrm{B}} T \delta_{ij} \delta(t-t')
$$
这个关系是构建任何保持正确统计系综的CG动力学模拟时必须遵守的基本原则。它确保了能量在CG自由度和被模型隐式包含的“[热浴](@entry_id:137040)”（即被积掉的快自由度）之间正确地流动，从而维持了系统的[热平衡](@entry_id:157986)。