{
    "hands_on_practices": [
        {
            "introduction": "为了真正理解稳定格式的运作方式，我们必须分析其基本的数学特性。本练习将引导您对一个简单平流方程的SUPG方法进行色散分析。通过推导相位和振幅误差，您将定量地理解SUPG如何在引入必要的数值阻尼的同时，也带来了不希望出现的相位失真，这是稳定化平流主导问题的核心权衡。",
            "id": "4103393",
            "problem": "考虑一个长度为 $L$ 的一维周期性域，其具有均匀的网格间距 $h$ 和均匀的稳态速度 $U>0$。为了在粘弹性本构输运方程中分离稳定化效应，我们使用标量线性平流方程 $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$ 来模拟聚合物构象张量单个标量分量 $\\phi$ 在该周期性域上的平流。在均匀网格上，使用一致质量矩阵，通过连续分片线性有限元对 $\\phi$进行离散化。通过流线迎风/Petrov-Galerkin (SUPG) 方法对半离散格式进行稳定化，其中测试函数沿流线被扰动为 $w \\mapsto w + \\tau \\, U \\, \\partial_{x} w$，稳定化参数 $\\tau$ 在整个域上为常数。假设场表示为 $\\phi_{h}(x,t) = \\sum_{j} a_{j}(t) N_{j}(x)$，节点间距均匀，并考虑单个傅里叶模态 $a_{j}(t) = A \\exp(i j \\theta - i \\omega t)$，其中无量纲波数 $\\theta = k h \\in [0,\\pi]$。从这个半离散 SUPG 格式出发，进行傅里叶或 von Neumann 分析以推导出色散关系 $\\omega(\\theta;\\tau)$，然后定义并以闭合形式表示：\n\n- 无量纲相速度误差，$E_{\\text{phase}}(\\theta,\\tau)$，定义为数值相速度与精确相速度的相对偏差，$E_{\\text{phase}}(\\theta,\\tau) = \\frac{c_{\\text{num}}(\\theta,\\tau) - U}{U}$，其中 $c_{\\text{num}}(\\theta,\\tau) = \\omega_{r}(\\theta,\\tau)/k$。\n- 无量纲振幅误差，$E_{\\text{amp}}(\\theta,\\tau)$，定义为由 $U/h$ 归一化的阻尼率，$E_{\\text{amp}}(\\theta,\\tau) = - \\frac{\\omega_{i}(\\theta,\\tau) \\, h}{U}$。\n\n其中 $\\omega_{r}$ 和 $\\omega_{i}$ 分别表示复频率 $\\omega(\\theta;\\tau)$ 的实部和虚部。\n\n您必须从带有 SUPG 稳定化的连续弱形式开始，推导半离散代数系统及其傅里叶符号，这些符号分别对应于一致质量矩阵、伽辽金平流矩阵、梯度加权的 SUPG 质量耦合矩阵以及 SUPG 引起的流线扩散矩阵。然后推导出 $E_{\\text{phase}}(\\theta,\\tau)$ 和 $E_{\\text{amp}}(\\theta,\\tau)$ 作为 $\\theta$、$\\tau$、$U$ 和 $h$ 的函数的精确闭合形式表达式。将您的最终答案表示为具有两个条目的单行矩阵 $\\left[E_{\\text{phase}}(\\theta,\\tau), E_{\\text{amp}}(\\theta,\\tau)\\right]$。不需要进行数值计算；请以符号形式提供表达式。",
            "solution": "### 解答推导\n\n此推导首先建立控制方程的SUPG弱形式，然后使用线性有限元在空间上进行离散化，以获得一个半离散的常微分方程组。对该系统进行傅里叶分析，得到色散关系，并由此计算出相位和振幅误差。\n\n**1. SUPG 弱形式**\n\n线性平流方程为 $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$。标准的伽辽金弱形式涉及乘以一个测试函数 $w$ 并在域 $\\Omega$ 上积分。SUPG方法将测试函数修改为 $w' = w + \\tau \\, U \\, \\partial_{x} w$。因此，SUPG弱形式为：求 $\\phi_h \\in V_h$，使得对于所有 $w_h \\in V_h$：\n$$\n\\int_{\\Omega} (\\partial_t \\phi_h + U \\partial_x \\phi_h) (w_h + \\tau U \\partial_x w_h) \\, dx = 0\n$$\n其中 $V_h$ 是网格上连续分片线性函数的空间。展开此表达式得到四项：\n$$\n\\underbrace{\\int_{\\Omega} w_h \\partial_t \\phi_h \\, dx}_{\\text{质量项}} + \\underbrace{\\int_{\\Omega} w_h U \\partial_x \\phi_h \\, dx}_{\\text{平流项}} + \\underbrace{\\int_{\\Omega} \\tau U \\partial_x w_h \\partial_t \\phi_h \\, dx}_{\\text{SUPG 质量项}} + \\underbrace{\\int_{\\Omega} \\tau U^2 \\partial_x w_h \\partial_x \\phi_h \\, dx}_{\\text{SUPG 扩散项}} = 0\n$$\n\n**2. 半离散系统与傅里叶符号**\n\n我们代入有限元展开式 $\\phi_h(x,t) = \\sum_j a_j(t) N_j(x)$，并对每个节点 $i$ 选择测试函数 $w_h = N_i(x)$。这会产生一个关于节点系数 $\\mathbf{a}(t)$ 的常微分方程组：\n$$\n(\\mathbf{M} + \\mathbf{M}_{\\text{SUPG}})\\frac{d\\mathbf{a}}{dt} + (\\mathbf{K} + \\mathbf{K}_{\\text{SUPG}})\\mathbf{a} = \\mathbf{0}\n$$\n这些矩阵由其分量定义：\n- 一致质量矩阵：$\\mathbf{M}_{ij} = \\int N_i N_j \\, dx$\n- 伽辽金平流矩阵：$\\mathbf{K}_{ij} = \\int U N_i (\\partial_x N_j) \\, dx$\n- SUPG 质量耦合矩阵：$(\\mathbf{M}_{\\text{SUPG}})_{ij} = \\int \\tau U (\\partial_x N_i) N_j \\, dx$\n- SUPG 扩散矩阵：$(\\mathbf{K}_{\\text{SUPG}})_{ij} = \\int \\tau U^2 (\\partial_x N_i)(\\partial_x N_j) \\, dx$\n\n对于间距为 $h$ 的一维均匀线性单元，一个通用行的非零模板项为：\n- $\\mathbf{M}$: 对于节点 $[j-1, j, j+1]$ 为 $h[\\frac{1}{6}, \\frac{4}{6}, \\frac{1}{6}]$\n- $\\mathbf{K}$: 对于节点 $[j-1, j, j+1]$ 为 $U[-\\frac{1}{2}, 0, \\frac{1}{2}]$\n- $\\mathbf{M}_{\\text{SUPG}}$: 对于节点 $[j-1, j, j+1]$ 为 $\\tau U[\\frac{1}{2}, 0, -\\frac{1}{2}]$\n- $\\mathbf{K}_{\\text{SUPG}}$: 对于节点 $[j-1, j, j+1]$ 为 $\\frac{\\tau U^2}{h}[-1, 2, -1]$\n\n应用傅里叶假设 $a_j(t) = A \\exp(i j \\theta - i \\omega t)$，将矩阵-向量运算转换为乘以其对应的傅里叶符号（放大因子）。对于一个具有模板 $[c_{-1}, c_0, c_1]$ 的矩阵 $\\mathbf{C}$，其符号 $\\hat{C}(\\theta)$ 为 $\\hat{C}(\\theta) = c_{-1}e^{-i\\theta} + c_0 + c_1e^{i\\theta}$。\n- $\\hat{M}(\\theta) = h(\\frac{1}{6}e^{-i\\theta} + \\frac{4}{6} + \\frac{1}{6}e^{i\\theta}) = \\frac{h}{3}(2 + \\cos\\theta)$\n- $\\hat{K}(\\theta) = U(-\\frac{1}{2}e^{-i\\theta} + 0 + \\frac{1}{2}e^{i\\theta}) = i U \\sin\\theta$\n- $\\hat{M}_{\\text{SUPG}}(\\theta) = \\tau U(\\frac{1}{2}e^{-i\\theta} + 0 - \\frac{1}{2}e^{i\\theta}) = -i \\tau U \\sin\\theta$\n- $\\hat{K}_{\\text{SUPG}}(\\theta) = \\frac{\\tau U^2}{h}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{2\\tau U^2}{h}(1 - \\cos\\theta)$\n\n半离散系统变为一个关于 $\\omega$ 的代数方程：\n$$\n(-i\\omega)[\\hat{M}(\\theta) + \\hat{M}_{\\text{SUPG}}(\\theta)] + [\\hat{K}(\\theta) + \\hat{K}_{\\text{SUPG}}(\\theta)] = 0\n$$\n因此，色散关系为：\n$$\n\\omega(\\theta;\\tau) = -i \\frac{\\hat{K}(\\theta) + \\hat{K}_{\\text{SUPG}}(\\theta)}{\\hat{M}(\\theta) + \\hat{M}_{\\text{SUPG}}(\\theta)} = -i \\frac{iU\\sin\\theta + \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n$$\n\\omega(\\theta;\\tau) = \\frac{U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n\n**3. 相位和振幅误差的推导**\n\n为了求出相位和振幅误差，我们必须将 $\\omega$ 分解为其实部 $\\omega_r$ 和虚部 $\\omega_i$。我们将分子和分母同乘以分母的复共轭：\n令 $N = U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)$ 且 $D = \\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta$。\n$$\n\\omega = \\frac{N\\bar{D}}{|D|^2} = \\frac{(U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)) (\\frac{h}{3}(2+\\cos\\theta) + i\\tau U \\sin\\theta)}{(\\frac{h}{3}(2+\\cos\\theta))^2 + (\\tau U \\sin\\theta)^2}\n$$\n实部和虚部分别为：\n$$\n\\omega_r = \\text{Re}(\\omega) = \\frac{U\\sin\\theta \\cdot \\frac{h}{3}(2+\\cos\\theta) + \\frac{2\\tau^2 U^3}{h}(1-\\cos\\theta)\\sin\\theta}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n$$\n\\omega_i = \\text{Im}(\\omega) = \\frac{U\\sin\\theta \\cdot \\tau U \\sin\\theta - \\frac{2\\tau U^2}{h}(1-\\cos\\theta) \\cdot \\frac{h}{3}(2+\\cos\\theta)}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n简化 $\\omega_i$ 的分子：\n$N_{\\omega_i} = \\tau U^2 \\sin^2\\theta - \\frac{2\\tau U^2}{3}(1-\\cos\\theta)(2+\\cos\\theta) = \\tau U^2 [ (1-\\cos^2\\theta) - \\frac{2}{3}(2-\\cos\\theta-\\cos^2\\theta) ] = \\tau U^2 [ -\\frac{1}{3} + \\frac{2}{3}\\cos\\theta - \\frac{1}{3}\\cos^2\\theta ] = -\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2$。\n所以，\n$$\n\\omega_i = \\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n\n**无量纲相速度误差：**\n数值相速度为 $c_{\\text{num}} = \\omega_r/k = \\omega_r h/\\theta$。\n$E_{\\text{phase}} = \\frac{c_{\\text{num}}-U}{U} = \\frac{\\omega_r h}{U\\theta} - 1$。\n$$\n\\frac{\\omega_r h}{U\\theta} = \\frac{h}{\\theta |D|^2} \\left[ \\frac{U h}{3}(2+\\cos\\theta)\\sin\\theta + \\frac{2\\tau^2 U^3}{h}(1-\\cos\\theta)\\sin\\theta \\right] / U\n$$\n为简化表达式，我们可以将主分式的分子和分母同乘以 9：\n$$\n\\frac{\\omega_r h}{U\\theta} = \\frac{\\frac{h}{\\theta} \\left[ 3h(2+\\cos\\theta)\\sin\\theta + \\frac{18\\tau^2 U^2}{h}(1-\\cos\\theta)\\sin\\theta \\right]}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} = \\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n$$\n则相位误差为：\n$$\nE_{\\text{phase}}(\\theta,\\tau) = \\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1\n$$\n\n**无量纲振幅误差：**\n$E_{\\text{amp}} = -\\frac{\\omega_i h}{U}$。\n$$\nE_{\\text{amp}}(\\theta,\\tau) = -\\frac{h}{U}\\left(\\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\\right) = \\frac{\\frac{\\tau U h}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n同样，将分子和分母同乘以 9，得到最终的闭合形式表达式：\n$$\nE_{\\text{amp}}(\\theta,\\tau) = \\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n$$\n这些表达式提供了无量纲相位和振幅误差，它们是无量纲波数 $\\theta$ 和稳定化参数 $\\tau$ 以及物理和离散化参数 $U$ 和 $h$ 的函数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1,\n&\n\\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论分析提供了深刻的洞见，但实际应用则要求我们选择具体的稳定参数。本练习旨在解决一个关键问题：如何为SUPG和DEVSS选择能够在稳定性与准确性之间取得平衡的参数。您将通过实现一套定量标准来评估不同的参数组合，模拟在真实世界中调整模拟参数以获得可靠解，同时避免过度数值扩散的任务。",
            "id": "4103439",
            "problem": "考虑一个长度为 $L$ 的一维周期性域，其均匀网格尺寸为 $h = L/N$，其中 $N$ 是单元数量。聚合物附加应力的一个标量分量，记为 $s(x)$，在稳态下通过以下线性化对流-扩散-反应方程进行建模\n$$\nu \\frac{d s}{d x} - \\kappa \\frac{d^2 s}{d x^2} + \\beta s = f(x),\n$$\n其中 $u$ 是恒定平均速度，$\\kappa$ 是应力的物理扩散系数，$\\beta = 1/\\lambda$ 是弛豫率（$\\lambda$ 是弛豫时间）。假设一个形式为 $f(x) = \\sin(k x)$ 的周期性强迫项，其中 $k$ 为波数，并对应力 $s(x)$ 施加周期性边界条件。\n\n用于连续线性有限元的经典 Galerkin 弱形式通过两种在粘弹性流中广泛使用的稳定化机制进行增强：\n- 流线迎风/Petrov-Galerkin (SUPG)，由参数 $\\tau_m$ 表征，它增加了一个沿流线方向的相容项。\n- 离散弹性粘性应力分裂 (DEVSS)，在此由无量纲参数 $\\tau_c$ 表征，在一维中建模为梯度上的相容最小二乘项，用以抑制与应变率投影相关的伪振荡。\n\n在均匀网格上，使用与 $e^{i k x}$ 成正比的试探/检验函数进行傅里叶模态分析，两种稳定化项都充当流线方向上的有效扩散贡献。具体而言，SUPG 贡献了与 $u^2 \\tau_m$ 成正比的量，而受 DEVSS 启发的梯度稳定化则贡献了与 $\\tau_c \\kappa$ 成正比的量。最终的有效扩散系数为\n$$\n\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa.\n$$\n\n对于正弦强迫项 $f(x) = \\sin(k x)$，精确物理算子（扩散系数为 $\\kappa$）的稳态响应振幅和相位由傅里叶符号确定\n$$\nL_{\\text{phys}}(k) = \\beta + \\kappa k^2 + i u k,\n$$\n而对于稳定化算子，它们由下式给出\n$$\nL_{\\text{num}}(k) = \\beta + \\kappa_{\\text{eff}} k^2 + i u k.\n$$\n响应振幅相对于强迫项振幅为 $A(k) = 1/|L(k)|$，对于精确算子，相移为 $\\phi(k) = -\\arg(L(k)) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$，对于稳定化算子，相移为 $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$。\n\n为量化给定网格下阻尼与精度之间的平衡，定义以下量：\n- 基于有效扩散的网格佩克莱特数，\n$$\nPe_{\\text{eff}} = \\frac{u h}{2 \\kappa_{\\text{eff}}},\n$$\n它衡量了在网格尺度上对流与扩散的相对强度。\n- 在可解波数 $k_r$ 处的振幅比偏差，\n$$\n\\Delta_A = \\left|\\frac{A_{\\text{num}}(k_r)}{A_{\\text{phys}}(k_r)} - 1\\right|,\n$$\n其中 $A_{\\text{phys}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa k^2)^2 + (u k)^2}}$ 且 $A_{\\text{num}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa_{\\text{eff}} k^2)^2 + (u k)^2}}$。\n- 在同一可解波数处的相位误差，\n$$\n\\Delta_\\phi = \\left|\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)\\right|,\n$$\n其中 $\\phi_{\\text{phys}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$ 且 $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$。\n\n对于给定的网格，一对稳定化参数 $(\\tau_m, \\tau_c)$ 被认为在阻尼和精度之间达到平衡，当且仅当以下三个标准同时满足：\n1. 网格佩克莱特数满足 $Pe_{\\text{eff}} \\in [Pe_{\\min}, Pe_{\\max}]$，其中 $Pe_{\\min} = 0.5$，$Pe_{\\max} = 2.5$ (无量纲)。\n2. 在 $k_r$ 处的振幅比偏差满足 $\\Delta_A \\leq \\delta_A$，其中 $\\delta_A = 0.15$ (无量纲)。\n3. 在 $k_r$ 处的相位误差满足 $\\Delta_\\phi \\leq \\delta_\\phi$，其中 $\\delta_\\phi = 0.2$ 弧度。\n\n使用以下固定的物理和数值参数：\n- 域长度 $L = 1.0$ 米，单元数量 $N = 50$，因此 $h = L/N$ (单位：米)。\n- 平均速度 $u = 1.0$ 米/秒。\n- 物理扩散系数 $\\kappa = 10^{-3}$ 平方米/秒。\n- 弛豫时间 $\\lambda = 0.5$ 秒，因此 $\\beta = 1/\\lambda = 2.0$ /秒。\n- 可解波数 $k_r = 2\\pi \\cdot 2$ 弧度/米。\n\n所有角度量必须以弧度计算，所有物理量必须使用其指定的单位。\n\n待评估的参数对 $(\\tau_m, \\tau_c)$ 测试集：\n- 情况 1: $(0.0, 0.0)$，其中 $\\tau_m$ 的单位是秒，$\\tau_c$ 是无量纲的。\n- 情况 2: $(0.01, 0.1)$。\n- 情况 3: $(0.02, 0.0)$。\n- 情况 4: $(0.005, 0.5)$。\n- 情况 5: $(0.05, 2.0)$。\n- 情况 6: $(0.01, 1.0)$。\n- 情况 7: $(0.001, 0.0)$。\n- 情况 8: $(0.002, 3.0)$。\n\n您的程序必须为每个测试情况评估这三个标准，并输出一个布尔值，指示给定的 $(\\tau_m, \\tau_c)$ 对是否在阻尼和精度之间达到了平衡。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，例如，\"[True,False,True]\"。",
            "solution": "问题陈述已经过仔细验证，被认为是具有科学依据、适定且客观的。它为线性化的一维对流-扩散-反应方程提供了一个标准的数值稳定化方案（SUPG 和 DEVSS）分析，该方程可作为模拟粘弹性流中聚合物应力行为的模型。所有参数、定义和标准都已提供，为获得唯一解构成了完整且一致的基础。该问题是可形式化的，并与计算复杂流体领域直接相关。因此，我将继续提供完整解法。\n\n目标是确定对于一组给定的稳定化参数对 $(\\tau_m, \\tau_c)$，它们是否在数值阻尼和物理精度之间提供了令人满意的平衡。这种平衡由三个同时应用于特定空间波数的标准来定义。\n\n首先，我们确定问题的固定物理和数值常数。\n域长度为 $L = 1.0$ 米，单元数量为 $N = 50$，这定义了均匀网格尺寸 $h = L/N = 1.0/50 = 0.02$ 米。\n物理参数为平均速度 $u = 1.0$ 米/秒，物理扩散系数 $\\kappa = 10^{-3}$ 平方米/秒，弛豫时间 $\\lambda = 0.5$ 秒。弛豫率推导为 $\\beta = 1/\\lambda = 1/0.5 = 2.0$ s⁻¹。\n分析在可解波数 $k_r = 2\\pi \\cdot 2 = 4\\pi$ 弧度/米处进行。\n\n平衡参数集的标准是：\n1. 有效网格佩克莱特数 $Pe_{\\text{eff}} = \\frac{u h}{2 \\kappa_{\\text{eff}}}$ 必须位于区间 $[Pe_{\\min}, Pe_{\\max}]$ 内，其中 $Pe_{\\min} = 0.5$，$Pe_{\\max} = 2.5$。\n2. 振幅比偏差 $\\Delta_A = \\left|\\frac{A_{\\text{num}}(k_r)}{A_{\\text{phys}}(k_r)} - 1\\right|$ 不得超过 $\\delta_A = 0.15$。\n3. 相位误差 $\\Delta_\\phi = |\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)|$ 不得超过 $\\delta_\\phi = 0.2$ 弧度。\n\n有效扩散系数 $\\kappa_{\\text{eff}}$ 是稳定化参数 $(\\tau_m, \\tau_c)$ 的函数，由 $\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa$ 给出。\n\n让我们首先计算与物理（精确）算子相关的量，这些量在所有测试情况中都保持不变。\n波数的平方为 $k_r^2 = (4\\pi)^2 = 16\\pi^2$ rad²/m²。\n物理系统的响应由振幅函数 $A_{\\text{phys}}$ 的分母和相位函数 $\\phi_{\\text{phys}}$ 中反正切函数的自变量决定。\n物理傅里叶符号分母的实部为 $D_{R, \\text{phys}} = \\beta + \\kappa k_r^2 = 2.0 + 10^{-3} \\cdot 16\\pi^2$。\n虚部为 $D_{I, \\text{phys}} = u k_r = 1.0 \\cdot 4\\pi = 4\\pi$。\n傅里叶符号的模的平方为 $|L_{\\text{phys}}(k_r)|^2 = (\\beta + \\kappa k_r^2)^2 + (u k_r)^2$。\n物理相位为 $\\phi_{\\text{phys}}(k_r) = -\\arctan\\left(\\frac{u k_r}{\\beta + \\kappa k_r^2}\\right)$。\n\n我们现在评估每对参数 $(\\tau_m, \\tau_c)$ 的测试情况。\n\n**情况 1: $(\\tau_m, \\tau_c) = (0.0, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = \\kappa + 1^2 \\cdot 0.0 + 0.0 \\cdot \\kappa = \\kappa = 10^{-3}$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 10^{-3}} = 10.0$。\n    该值不在 $[0.5, 2.5]$ 范围内。第一个标准未满足。\n    **结果：False。**\n\n**情况 2: $(\\tau_m, \\tau_c) = (0.01, 0.1)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.01 + 0.1 \\cdot 10^{-3} = 0.001 + 0.01 + 0.0001 = 0.0111$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0111} \\approx 0.9009$。该值在 $[0.5, 2.5]$ 范围内。标准 1 满足。\n3.  $|L_{\\text{num}}(k_r)|^2 = (\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2$。比率 $A_{\\text{num}}/A_{\\text{phys}} = |L_{\\text{phys}}|/|L_{\\text{num}}|$。\n    $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.0111 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0278$。\n    该值小于 $\\delta_A = 0.15$。标准 2 满足。\n4.  $\\phi_{\\text{phys}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 10^{-3} \\cdot 16\\pi^2}\\right) \\approx -1.4013$ 弧度。\n    $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.0111 \\cdot 16\\pi^2}\\right) \\approx -1.2809$ 弧度。\n    $\\Delta_\\phi = |\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)| \\approx |-1.2809 - (-1.4013)| \\approx 0.1204$ 弧度。\n    该值小于 $\\delta_\\phi = 0.2$。标准 3 满足。\n    所有三个标准均满足。**结果：True。**\n\n**情况 3: $(\\tau_m, \\tau_c) = (0.02, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.02 + 0.0 \\cdot 10^{-3} = 0.021$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.021} \\approx 0.4762$。\n    该值不在 $[0.5, 2.5]$ 范围内。第一个标准未满足。\n    **结果：False。**\n\n**情况 4: $(\\tau_m, \\tau_c) = (0.005, 0.5)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.005 + 0.5 \\cdot 10^{-3} = 0.001 + 0.005 + 0.0005 = 0.0065$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0065} \\approx 1.5385$。该值在 $[0.5, 2.5]$ 范围内。标准 1 满足。\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.0065 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0136$。\n    该值小于 $\\delta_A = 0.15$。标准 2 满足。\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.0065 \\cdot 16\\pi^2}\\right) \\approx -1.3341$ 弧度。\n    $\\Delta_\\phi = |-1.3341 - (-1.4013)| \\approx 0.0672$ 弧度。\n    该值小于 $\\delta_\\phi = 0.2$。标准 3 满足。\n    所有三个标准均满足。**结果：True。**\n\n**情况 5: $(\\tau_m, \\tau_c) = (0.05, 2.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.05 + 2.0 \\cdot 10^{-3} = 0.001 + 0.05 + 0.002 = 0.053$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.053} \\approx 0.1887$。\n    该值不在 $[0.5, 2.5]$ 范围内。第一个标准未满足。\n    **结果：False。**\n\n**情况 6: $(\\tau_m, \\tau_c) = (0.01, 1.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.01 + 1.0 \\cdot 10^{-3} = 0.001 + 0.01 + 0.001 = 0.012$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.012} \\approx 0.8333$。该值在 $[0.5, 2.5]$ 范围内。标准 1 满足。\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.012 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0309$。\n    该值小于 $\\delta_A = 0.15$。标准 2 满足。\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.012 \\cdot 16\\pi^2}\\right) \\approx -1.2707$ 弧度。\n    $\\Delta_\\phi = |-1.2707 - (-1.4013)| \\approx 0.1306$ 弧度。\n    该值小于 $\\delta_\\phi = 0.2$。标准 3 满足。\n    所有三个标准均满足。**结果：True。**\n\n**情况 7: $(\\tau_m, \\tau_c) = (0.001, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.001 + 0.0 \\cdot 10^{-3} = 0.002$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.002} = 5.0$。\n    该值不在 $[0.5, 2.5]$ 范围内。第一个标准未满足。\n    **结果：False。**\n\n**情况 8: $(\\tau_m, \\tau_c) = (0.002, 3.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.002 + 3.0 \\cdot 10^{-3} = 0.001 + 0.002 + 0.003 = 0.006$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.006} \\approx 1.6667$。该值在 $[0.5, 2.5]$ 范围内。标准 1 满足。\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.006 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0122$。\n    该值小于 $\\delta_A = 0.15$。标准 2 满足。\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.006 \\cdot 16\\pi^2}\\right) \\approx -1.3395$ 弧度。\n    $\\Delta_\\phi = |-1.3395 - (-1.4013)| \\approx 0.0618$ 弧度。\n    该值小于 $\\delta_\\phi = 0.2$。标准 3 满足。\n    所有三个标准均满足。**结果：True。**\n\n结果总结：\n- 情况 1: False\n- 情况 2: True\n- 情况 3: False\n- 情况 4: True\n- 情况 5: False\n- 情况 6: True\n- 情况 7: False\n- 情况 8: True\n最终的布尔值序列是 [False, True, False, True, False, True, False, True]。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates stabilization parameter pairs against three criteria for balancing\n    damping and accuracy in a model viscoelastic flow problem.\n    \"\"\"\n    # Define fixed physical and numerical parameters\n    L = 1.0  # Domain length (m)\n    N = 50   # Number of elements\n    u = 1.0  # Mean velocity (m/s)\n    kappa = 1e-3  # Physical diffusivity (m^2/s)\n    lambda_relax = 0.5  # Relaxation time (s)\n    k_r = 2 * np.pi * 2  # Resolved wavenumber (rad/m)\n\n    # Define criteria thresholds\n    Pe_min = 0.5\n    Pe_max = 2.5\n    delta_A_max = 0.15\n    delta_phi_max = 0.2  # radians\n\n    # Derived constants\n    h = L / N  # Mesh size (m)\n    beta = 1.0 / lambda_relax  # Relaxation rate (1/s)\n\n    # Test suite of parameter pairs (tau_m, tau_c)\n    test_cases = [\n        (0.0, 0.0),    # Case 1\n        (0.01, 0.1),   # Case 2\n        (0.02, 0.0),   # Case 3\n        (0.005, 0.5),  # Case 4\n        (0.05, 2.0),   # Case 5\n        (0.01, 1.0),   # Case 6\n        (0.001, 0.0),  # Case 7\n        (0.002, 3.0),  # Case 8\n    ]\n\n    results = []\n\n    # Pre-calculate physical system quantities (constant for all cases)\n    k_r_sq = k_r**2\n    u_k_r = u * k_r\n    \n    # Denominator parts for physical operator\n    denom_real_phys = beta + kappa * k_r_sq\n    denom_imag_phys = u_k_r\n    L_mag_sq_phys = denom_real_phys**2 + denom_imag_phys**2\n    phi_phys = -np.arctan2(denom_imag_phys, denom_real_phys)\n\n    for tau_m, tau_c in test_cases:\n        # Step 1: Calculate effective diffusion and check Péclet number criterion\n        kappa_eff = kappa + u**2 * tau_m + tau_c * kappa\n        Pe_eff = (u * h) / (2 * kappa_eff)\n        \n        crit1_passed = (Pe_min = Pe_eff = Pe_max)\n\n        # Step 2: Calculate amplitude ratio deviation\n        denom_real_num = beta + kappa_eff * k_r_sq\n        denom_imag_num = u_k_r\n        L_mag_sq_num = denom_real_num**2 + denom_imag_num**2\n        \n        # A_num / A_phys = |L_phys| / |L_num| = sqrt(L_mag_sq_phys / L_mag_sq_num)\n        amp_ratio = np.sqrt(L_mag_sq_phys / L_mag_sq_num)\n        delta_A = np.abs(amp_ratio - 1)\n        \n        crit2_passed = (delta_A = delta_A_max)\n\n        # Step 3: Calculate phase error\n        phi_num = -np.arctan2(denom_imag_num, denom_real_num)\n        delta_phi = np.abs(phi_num - phi_phys)\n        \n        crit3_passed = (delta_phi = delta_phi_max)\n\n        # A pair is balanced if and only if all three criteria are met\n        is_balanced = crit1_passed and crit2_passed and crit3_passed\n        results.append(is_balanced)\n\n    # Format the final output as a comma-separated list of booleans\n    # The map(str, ...) is required to convert boolean True/False to string \"True\"/\"False\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "稳定化方法通常被简单地理解为“抑制振荡”，但其效果更为精妙。本练习将展示一种类DEVSS稳定格式如何像一个全局滤波器一样重新分布数值误差。通过比较从含噪声数据中计算出的“朴素”梯度与稳定化后的梯度，您将观察到尖锐的局部误差是如何被平滑并分散到整个计算域的，从而更清晰地理解DEVSS类应力稳定化方法背后的机制。",
            "id": "4103431",
            "problem": "考虑在坐标为 $y \\in [0,1]$ 的一维通道中，一种无量纲的粘弹性流体平面剪切流。真实速度场为 $u_{\\text{true}}(y) = S\\,y$，其中 $S$ 是无量纲剪切率。速度梯度 $\\nabla \\mathbf{u} = \\partial u / \\partial y = S$ 是一个常数。在离散计算中，观测到的节点速度 $u_{\\text{obs}}(y_j)$ 可能包含误差，这些误差会导致计算出的速度梯度 $\\nabla \\mathbf{u}$ 出现局部误差。在计算复杂流体中，通常使用稳定化方法，如离散弹性粘性应力分裂（Discrete Elastic Viscous Stress Splitting, DEVSS）和流线迎风 Petrov-Galerkin（Streamline Upwind Petrov-Galerkin, SUPG），来缓解此类问题。在本问题中，您将实现一种类似 DEVSS 的稳定化方法，该方法引入一个辅助梯度场和一个一致性罚项，然后比较有无稳定化时误差的局部化情况。\n\n从以下基本原理出发：\n- 速度梯度定义为 $\\nabla \\mathbf{u} = \\partial u / \\partial y$。\n- 在间距为 $h = 1/(N-1)$ 的均匀网格上，梯度的有限差分近似在边界处使用单边差分，在内部使用中心差分。\n- 带有光滑度罚项的最小二乘投影可以表示为最小化以下形式的二次泛函\n$$\nJ(G) = \\sum_{j=0}^{N-1} w_j \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2,\n$$\n其中 $G_j$ 是节点 $j$ 处梯度的稳定化近似， $D_j$ 是节点 $j$ 处 $\\partial u/\\partial y$ 的有限差分估计， $w_j$ 是正权重，$\\alpha \\ge 0$ 是稳定化强度。通过将 $J$ 对 $G$ 的导数设为零，可以得到最小化子 $G$ 的正规方程。\n\n您的任务是：\n1. 在 $y \\in [0,1]$ 中构建一个包含 $N$ 个节点的均匀网格，其中 $y_j = j h$，$j = 0,1,\\dots,N-1$，$h = 1/(N-1)$。\n2. 定义真实速度 $u_{\\text{true}}(y_j) = S\\,y_j$ 和观测速度\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right),\n$$\n其中 $A$ 控制边界层状振荡的振幅，$\\beta$ 控制其在 $y=0$ 和 $y=1$ 附近的局部化程度。\n3. 使用有限差分从 $u_{\\text{obs}}$ 计算朴素离散梯度 $D_j$：$D_0 = (u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0))/h$， $D_{N-1} = (u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2}))/h$，以及对于 $j = 1,\\dots,N-2$， $D_j = (u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1}))/(2h)$。\n4. 通过求解 $J(G)$ 最小化子（其中对所有 $j$，$w_j = 1$）的正规方程，构建类似 DEVSS 的稳定化梯度 $G$。证明得到的线性系统可以写为\n$$\n\\left(I + \\alpha Q\\right) G = D,\n$$\n其中 $I$ 是单位矩阵，$Q$ 是由离散梯度罚项产生的对称半正定矩阵，其元素为\n$$\nQ_{jj} = \\begin{cases}\n1,  j = 0,\\\\\n2,  1 \\le j \\le N-2,\\\\\n1,  j = N-1,\n\\end{cases}\n\\quad\nQ_{j,j+1} = Q_{j+1,j} = -1 \\text{ for } 0 \\le j \\le N-2,\n$$\n并由 $1/h^2$ 缩放。\n5. 定义逐点梯度误差 $e_{\\text{naive}}(y_j) = D_j - S$ 和 $e_{\\text{stab}}(y_j) = G_j - S$。通过以下分数来量化误差的边界局部化\n$$\nR(e) = \\frac{\\sum_{j: y_j  \\delta \\text{ or } y_j > 1-\\delta} \\left|e(y_j)\\right|}{\\sum_{j=0}^{N-1} \\left|e(y_j)\\right|},\n$$\n约定如果分母为零，则 $R(e) = 0$。这里，$\\delta \\in (0,1/2)$ 定义了边界层的宽度。\n6. 对每个测试用例，计算由于稳定化引起的边界误差局部化的变化，$\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$。\n\n所有量均为无量纲。您的程序必须实现上述步骤，并为以下测试套件生成结果：\n- 测试用例 1：$N = 101$, $S = 1$, $A = 0.1$, $\\beta = 8$, $\\alpha = 0.01$, $\\delta = 0.1$。\n- 测试用例 2：$N = 101$, $S = 1$, $A = 0$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$。\n- 测试用例 3：$N = 21$, $S = 1$, $A = 0.2$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$。\n- 测试用例 4：$N = 101$, $S = 1$, $A = 0.5$, $\\beta = 12$, $\\alpha = 0.1$, $\\delta = 0.1$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果。每个条目必须是对应测试用例的浮点数 $\\Delta R$，四舍五入到六位小数，并按照上面列出的测试用例顺序排列（例如，$[\\Delta R_1,\\Delta R_2,\\Delta R_3,\\Delta R_4]$）。输出必须严格遵守此格式且只有一行。\n\n在您的解答中，解释为什么稳定化会改变 $\\nabla \\mathbf{u}$ 中误差的局部化，以及与朴素有限差分梯度相比，类似 DEVSS 的罚项如何重新分布和衰减边界附近的误差。您的解释必须基于上述基本原理，避免使用捷径或超出已定义范围的预先陈述的结论。不要引用任何外部文件或数据；所有计算都必须在程序内部完成。",
            "solution": "用户提供的问题已经过严格验证。所有给定条件都已提取并检查其科学合理性、自洽性和适定性。该问题是偏微分方程数值方法的标准练习，特别关注计算流体动力学中的稳定化技术。基于有限差分和 Tikhonov 型正则化泛函的数学公式是完善的。对于给定的参数，待求解的线性系统是非奇异的，保证了唯一解。该问题被认为是有效的，下面提供了完整的解答。\n\n这个问题的核心是分析一种类似于 DEVSS 方法中使用的正则化技术，如何改变数值计算的速度梯度的误差特性。在粘弹性流模拟中，应力对速度梯度高度敏感，因此稳定化的目标是减轻可能由噪声输入数据或数值不稳定性引起的伪振荡，这是一个关键问题。\n\n我们从一个一维域 $y \\in [0, 1]$ 开始，该域由 $N$ 个均匀间隔的节点 $y_j = j h$（其中 $j = 0, 1, \\dots, N-1$）离散化，网格间距为 $h = 1/(N-1)$。真实速度场是线性剪切流，$u_{\\text{true}}(y) = S y$，其速度梯度为常数，$\\nabla \\mathbf{u} = \\partial u / \\partial y = S$。\n\n然而，计算过程始于一个“观测”速度场 $u_{\\text{obs}}(y_j)$，其中包含边界层状的振荡误差：\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right)\n$$\n附加项引入了高频振荡，这些振荡在边界 $y=0$ 和 $y=1$ 附近最为显著，并向内部衰减，由参数 $\\beta$ 控制。\n\n第一步是使用有限差分公式在 $u_{\\text{obs}}$ 值的网格上计算一个“朴素”速度梯度，记为向量 $D$。由于微分算子的局部性，这些算子已知会放大高频噪声。在边界使用单边差分，在内部使用中心差分，我们计算：\n$$\n\\begin{align*}\nD_0 = \\frac{u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0)}{h} \\\\\nD_j = \\frac{u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1})}{2h}, \\quad \\text{for } j = 1, \\dots, N-2 \\\\\nD_{N-1} = \\frac{u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2})}{h}\n\\end{align*}\n$$\n这个朴素梯度的误差是 $e_{\\text{naive}, j} = D_j - S$。由于 $u_{\\text{obs}}$ 中误差的振荡特性，特别是在边界附近，将导致 $D$ 中出现大的、局部化的误差。\n\n为了减轻这些局部误差，引入了类似 DEVSS 的稳定化方法。我们寻求一个新的、“稳定化的”梯度场 $G$，它既接近朴素梯度 $D$，又比它更光滑。这被表述为一个变分问题：找到使二次泛函 $J(G)$ 最小化的向量 $G$：\n$$\nJ(G) = \\sum_{j=0}^{N-1} \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2\n$$\n这里，第一项强制对原始梯度数据 $D$ 的保真度。第二项是一个正则化罚项，惩罚解 $G$ 中的粗糙度。项 $(G_{j+1} - G_j)/h$ 是 $G$ 导数的有限差分近似，所以这个罚项是 $\\int (\\partial G/\\partial y)^2 dy$ 的近似。最小化此项可以促使梯度场 $G$ 更光滑。参数 $\\alpha \\geq 0$ 控制了这种平滑的强度。\n\n为了找到最小化子 $G$，我们对 $J(G)$ 关于每个分量 $G_k$ 求导，并令其为零，即 $\\partial J / \\partial G_k = 0$ 对所有 $k = 0, 1, \\dots, N-1$ 成立。\n对于内部节点 $k \\in \\{1, \\dots, N-2\\}$：\n$$\n\\frac{\\partial J}{\\partial G_k} = 2(G_k - D_k) + \\frac{\\alpha}{h^2} \\left[ -2(G_{k+1}-G_k) + 2(G_k - G_{k-1}) \\right] = 0 \\\\\n\\implies (G_k - D_k) + \\frac{\\alpha}{h^2} (-G_{k-1} + 2G_k - G_{k+1}) = 0\n$$\n对于边界节点 $k=0$：\n$$\n\\frac{\\partial J}{\\partial G_0} = 2(G_0 - D_0) + \\frac{\\alpha}{h^2} \\left[ -2(G_1 - G_0) \\right] = 0 \\implies (G_0 - D_0) + \\frac{\\alpha}{h^2} (G_0 - G_1) = 0\n$$\n对于边界节点 $k=N-1$：\n$$\n\\frac{\\partial J}{\\partial G_{N-1}} = 2(G_{N-1} - D_{N-1}) + \\frac{\\alpha}{h^2} \\left[ 2(G_{N-1} - G_{N-2}) \\right] = 0 \\implies (G_{N-1} - D_{N-1}) + \\frac{\\alpha}{h^2} (G_{N-1} - G_{N-2}) = 0\n$$\n将这 $N$ 个线性方程组装成矩阵形式，得到系统：\n$$\n\\left(I + \\frac{\\alpha}{h^2} K\\right) G = D\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵，$G$ 和 $D$ 是大小为 $N$ 的列向量，$K$ 是 $N \\times N$ 的对称矩阵：\n$$\nK = \\begin{pmatrix}\n1   -1               \\\\\n-1   2   -1          \\\\\n    \\ddots  \\ddots  \\ddots    \\\\\n        -1    2    -1 \\\\\n             -1    1\n\\end{pmatrix}\n$$\n这个矩阵 $K$ 是一维负二阶导数算子 $-\\partial^2/\\partial y^2$ 在诺伊曼（零通量）边界条件下的离散表示。问题中定义的矩阵 $Q = K/h^2$ 直接导出了指定的线性系统 $(I + \\alpha Q) G = D$。\n\n稳定化梯度通过求解这个系统得到 $G$：$G = (I + \\alpha Q)^{-1} D$。矩阵算子 $(I + \\alpha Q)^{-1}$ 充当一个全局低通滤波器。矩阵 $Q$ 对于高振荡性特征向量（高频模式）具有大的特征值。因此，逆矩阵 $(I + \\alpha Q)^{-1}$ 对于这些相同的模式具有小的特征值，这意味着它会抑制输入向量 $D$ 中存在的高频分量。\n\n这种稳定化的效果是误差的重新分布。朴素梯度误差 $e_{\\text{naive}}$ 是尖锐且局部化的，因为有限差分算子是局部的。而稳定化过程由于矩阵求逆是全局性的，它将这些大的、局部化的误差平滑掉，将较小的误差幅度分布到整个域中。因此，稳定化梯度中的误差 $e_{\\text{stab}} = G - S$ 将不那么集中在边界处。\n\n我们使用比率 $R(e)$ 来量化误差局部化的这种变化，该比率测量了宽度为 $\\delta$ 的边界层内包含的总绝对误差的分数。该比率的减小表明误差已经“去局部化”或从边界扩散到内部。因此，待计算的量 $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$，对于有振荡误差的情况（$A \\neq 0$）预计为负值，这表明稳定化成功地减少了边界附近误差的集中。对于没有引入误差的情况（$A=0$），所有 $j$ 都有 $D_j=S$，导致 $e_{\\text{naive}}=\\mathbf{0}$ 和 $R(e_{\\text{naive}})=0$。方程 $(I+\\alpha Q)G = S \\cdot \\mathbf{1}$ 的解是 $G=S \\cdot \\mathbf{1}$，因为常数向量在 $Q$ 的零空间中。因此，$e_{\\text{stab}}=\\mathbf{0}$，$R(e_{\\text{stab}})=0$，且 $\\Delta R = 0$。这为实现的正确性提供了关键的检验。\n\n数值步骤如下：\n1. 对每个测试用例，设置网格并计算 $u_{\\text{obs}}$。\n2. 使用指定的有限差分模板计算朴素梯度向量 $D$。\n3. 构建矩阵 $Q$ 并求解线性系统 $(I + \\alpha Q) G = D$ 以找到稳定化梯度 $G$。\n4. 计算误差向量 $e_{\\text{naive}} = D - S$ 和 $e_{\\text{stab}} = G - S$。\n5. 计算局部化比率 $R(e_{\\text{naive}})$ 和 $R(e_{\\text{stab}})$。\n6. 计算局部化的变化 $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main solver function to compute the change in error localization\n    for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, S, A, beta, alpha, delta)\n        (101, 1.0, 0.1, 8.0, 0.01, 0.1),\n        (101, 1.0, 0.0, 8.0, 0.05, 0.1),\n        (21, 1.0, 0.2, 8.0, 0.05, 0.1),\n        (101, 1.0, 0.5, 12.0, 0.1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, S, A, beta, alpha, delta = case\n        \n        # 1. Construct the grid\n        h = 1.0 / (N - 1)\n        y = np.linspace(0.0, 1.0, N)\n        \n        # 2. Define true and observed velocities\n        u_true = S * y\n        noise = A * (np.sin(2 * np.pi * y) * np.exp(-beta * y) + \n                     np.sin(2 * np.pi * (1 - y)) * np.exp(-beta * (1 - y)))\n        u_obs = u_true + noise\n        \n        # 3. Compute the naive discrete gradient D\n        D = np.zeros(N)\n        D[0] = (u_obs[1] - u_obs[0]) / h\n        D[N-1] = (u_obs[N-1] - u_obs[N-2]) / h\n        D[1:N-1] = (u_obs[2:] - u_obs[0:-2]) / (2 * h)\n        \n        # 4. Formulate and solve for the stabilized gradient G\n        # Construct the matrix K (unscaled Q)\n        diag_main = np.full(N, 2.0)\n        diag_main[0] = 1.0\n        diag_main[-1] = 1.0\n        diag_off = np.full(N - 1, -1.0)\n        K = np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1)\n        \n        # Scale K by 1/h^2 to get Q\n        Q = K / (h**2)\n        \n        # Construct the system matrix M = (I + alpha*Q)\n        M = np.eye(N) + alpha * Q\n        \n        # Solve MG = D for G\n        G = np.linalg.solve(M, D)\n        \n        # 5. Define pointwise errors and quantify boundary localization\n        e_naive = D - S\n        e_stab = G - S\n        \n        def calculate_R(e, y_grid, delta_val):\n            \"\"\"\n            Computes the error localization ratio R(e).\n            \"\"\"\n            total_abs_error = np.sum(np.abs(e))\n            if total_abs_error == 0.0:\n                return 0.0\n            \n            boundary_mask = (y_grid  delta_val) | (y_grid > 1 - delta_val)\n            boundary_abs_error = np.sum(np.abs(e[boundary_mask]))\n            \n            return boundary_abs_error / total_abs_error\n\n        R_naive = calculate_R(e_naive, y, delta)\n        R_stab = calculate_R(e_stab, y, delta)\n\n        # 6. Compute the change in boundary error localization\n        delta_R = R_stab - R_naive\n        results.append(delta_R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}