{
    "hands_on_practices": [
        {
            "introduction": "在将稳定化方法应用于复杂粘弹性流动模拟之前，我们必须首先理解其在最简单的模型问题上的核心效应。本练习通过对标量线性平流方程进行傅里叶分析，旨在揭示流线迎风/Petrov-Galerkin (SUPG) 方法如何引入数值耗散与色散。通过推导相位和振幅误差的精确表达式，您将亲手量化稳定化参数 $\\tau$ 对不同尺度波的传播速度和衰减率的影响 。",
            "id": "4103393",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域，其网格间距均匀为 $h$，速度为均匀稳态速度 $U>0$。为了在粘弹性本构输运方程中分离出稳定化效应，我们使用标量线性平流方程 $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$ 在该周期性区域上对聚合物构象张量的单个标量分量的平流进行建模。在均匀网格上，使用连续分段线性有限元和一致质量矩阵对 $\\phi$ 进行离散化。通过流线迎风/Petrov-Galerkin (SUPG) 方法对半离散格式进行稳定化处理，其中测试函数沿流线进行扰动，形式为 $w \\mapsto w + \\tau \\, U \\, \\partial_{x} w$，稳定化参数 $\\tau$ 在整个区域上为常数。假设场表示为 $\\phi_{h}(x,t) = \\sum_{j} a_{j}(t) N_{j}(x)$，节点间距均匀，并考虑单个傅里叶模式 $a_{j}(t) = A \\exp(i j \\theta - i \\omega t)$，其中无量纲波数为 $\\theta = k h \\in [0,\\pi]$。从这个半离散 SUPG 格式出发，进行傅里叶或 von Neumann 分析，推导出色散关系 $\\omega(\\theta;\\tau)$，然后定义并用闭合形式表示：\n\n- 无量纲相速度误差 $E_{\\text{phase}}(\\theta,\\tau)$，定义为数值相速度与精确相速度的相对偏差，$E_{\\text{phase}}(\\theta,\\tau) = \\frac{c_{\\text{num}}(\\theta,\\tau) - U}{U}$，其中 $c_{\\text{num}}(\\theta,\\tau) = \\omega_{r}(\\theta,\\tau)/k$，以及\n- 无量纲振幅误差 $E_{\\text{amp}}(\\theta,\\tau)$，定义为经 $U/h$ 归一化的阻尼率，$E_{\\text{amp}}(\\theta,\\tau) = - \\frac{\\omega_{i}(\\theta,\\tau) \\, h}{U}$，\n\n其中 $\\omega_{r}$ 和 $\\omega_{i}$ 分别表示复频率 $\\omega(\\theta;\\tau)$ 的实部和虚部。\n\n您必须从带有 SUPG 稳定化的连续弱形式出发，推导半离散代数系统及其傅里叶符号，这些符号分别对应于一致质量矩阵、Galerkin 平流矩阵、梯度加权的 SUPG 质量耦合矩阵以及 SUPG 引入的流线扩散矩阵。然后，推导出 $E_{\\text{phase}}(\\theta,\\tau)$ 和 $E_{\\text{amp}}(\\theta,\\tau)$ 作为 $\\theta$、$\\tau$、$U$ 和 $h$ 的函数的精确闭合形式表达式。将您的最终答案表示为一个包含两个条目的单行矩阵 $\\left[E_{\\text{phase}}(\\theta,\\tau), E_{\\text{amp}}(\\theta,\\tau)\\right]$。不需要进行数值计算；请以符号形式提供表达式。",
            "solution": "### 步骤 1：建立SUPG弱形式与半离散系统\n对于线性平流方程 $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$，其SUPG弱形式为：求 $\\phi_h \\in V_h$，使得对于所有检验函数 $w_h \\in V_h$：\n$$\n\\int_{\\Omega} (\\partial_t \\phi_h + U \\partial_x \\phi_h) (w_h + \\tau U \\partial_x w_h) \\, dx = 0\n$$\n其中 $V_h$ 是连续分段线性函数的空间。代入有限元展开式 $\\phi_h(x,t) = \\sum_j a_j(t) N_j(x)$ 和检验函数 $w_h = N_i(x)$，得到关于节点系数向量 $\\mathbf{a}(t)$ 的常微分方程组：\n$$\n(\\mathbf{M} + \\mathbf{M}_{\\text{SUPG}})\\frac{d\\mathbf{a}}{dt} + (\\mathbf{K} + \\mathbf{K}_{\\text{SUPG}})\\mathbf{a} = 0\n$$\n其中，$\\mathbf{M}$ 是一致质量矩阵，$\\mathbf{K}$ 是Galerkin平流矩阵，$\\mathbf{M}_{\\text{SUPG}}$ 和 $\\mathbf{K}_{\\text{SUPG}}$ 是SUPG引入的稳定化矩阵。\n\n### 步骤 2：傅里叶分析\n我们应用傅里叶模式 $a_j(t) = A \\exp(i j \\theta - i \\omega t)$，将矩阵-向量运算转换为乘以其对应的傅里叶符号（放大因子）$\\hat{\\mathbf{C}}(\\theta)$。对于均匀一维线性元，各矩阵的符号为：\n- $\\hat{M}(\\theta) = \\frac{h}{3}(2 + \\cos\\theta)$\n- $\\hat{K}(\\theta) = i U \\sin\\theta$\n- $\\hat{M}_{\\text{SUPG}}(\\theta) = \\tau U(-\\frac{1}{2}e^{i\\theta} + \\frac{1}{2}e^{-i\\theta}) = -i \\tau U \\sin\\theta$\n- $\\hat{K}_{\\text{SUPG}}(\\theta) = \\frac{\\tau U^2}{h}(2 - e^{i\\theta} - e^{-i\\theta}) = \\frac{2\\tau U^2}{h}(1 - \\cos\\theta)$\n\n代入半离散系统得到关于复频率 $\\omega$ 的代数方程：\n$$\n(-i\\omega)[\\hat{M}(\\theta) + \\hat{M}_{\\text{SUPG}}(\\theta)] + [\\hat{K}(\\theta) + \\hat{K}_{\\text{SUPG}}(\\theta)] = 0\n$$\n解出 $\\omega$，得到色散关系：\n$$\n\\omega(\\theta;\\tau) = -i \\frac{\\hat{K}(\\theta) + \\hat{K}_{\\text{SUPG}}(\\theta)}{\\hat{M}(\\theta) + \\hat{M}_{\\text{SUPG}}(\\theta)} = -i \\frac{iU\\sin\\theta + \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n整理后为：\n$$\n\\omega(\\theta;\\tau) = \\frac{U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n\n### 步骤 3：推导相位与振幅误差\n为了求出相位和振幅误差，我们将 $\\omega$ 分离成实部 $\\omega_r$ 和虚部 $\\omega_i$。令分子为 $N = N_r + i N_i$ 和分母为 $D = D_r + i D_i$，则 $\\omega = \\frac{N\\bar{D}}{|D|^2}$。\n- $N_r = U\\sin\\theta$, $N_i = -\\frac{2\\tau U^2}{h}(1-\\cos\\theta)$\n- $D_r = \\frac{h}{3}(2+\\cos\\theta)$, $D_i = -\\tau U \\sin\\theta$\n- $|D|^2 = D_r^2 + D_i^2 = \\left(\\frac{h}{3}(2+\\cos\\theta)\\right)^2 + (\\tau U \\sin\\theta)^2$\n\n复频率的实部和虚部分别为：\n$$\n\\omega_r = \\frac{N_r D_r - N_i D_i}{|D|^2} = \\frac{U\\sin\\theta \\cdot \\frac{h}{3}(2+\\cos\\theta) - \\left(-\\frac{2\\tau U^2}{h}(1-\\cos\\theta)\\right) \\cdot (-\\tau U \\sin\\theta)}{|D|^2} = \\frac{\\frac{Uh}{3}\\sin\\theta(2+\\cos\\theta) - \\frac{2\\tau^2 U^3}{h}\\sin\\theta(1-\\cos\\theta)}{|D|^2}\n$$\n$$\n\\omega_i = \\frac{N_i D_r + N_r D_i}{|D|^2} = \\frac{-\\frac{2\\tau U^2}{h}(1-\\cos\\theta) \\cdot \\frac{h}{3}(2+\\cos\\theta) + U\\sin\\theta \\cdot (-\\tau U \\sin\\theta)}{|D|^2} = \\frac{-\\frac{2\\tau U^2}{3}(1-\\cos\\theta)(2+\\cos\\theta) - \\tau U^2 \\sin^2\\theta}{|D|^2}\n$$\n简化 $\\omega_i$ 的分子，可以得到 $-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2$。因此：\n$$\n\\omega_i = \\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{\\left(\\frac{h}{3}(2+\\cos\\theta)\\right)^2 + (\\tau U \\sin\\theta)^2}\n$$\n\n**无量纲相速度误差 $E_{\\text{phase}}$:**\n$E_{\\text{phase}} = \\frac{c_{\\text{num}}-U}{U} = \\frac{\\omega_r h}{U\\theta} - 1$\n$$\n\\frac{\\omega_r h}{U\\theta} = \\frac{h}{U\\theta} \\frac{\\frac{Uh}{3}\\sin\\theta(2+\\cos\\theta) + \\frac{2\\tau^2 U^3}{h}\\sin\\theta(1-\\cos\\theta)}{(\\frac{h}{3}(2+\\cos\\theta))^2 + (\\tau^2 U^2 \\sin^2\\theta)}\n$$\n将分子分母同乘以 $9$ 以简化表达式：\n$$\nE_{\\text{phase}}(\\theta,\\tau) = \\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1\n$$\n*注意：原始推导中 $\\omega_r$ 的符号有误，导致最终表达式中的符号也随之错误。正确推导 $N \\bar{D}$ 的实部为 $U \\sin\\theta \\frac{h}{3}(2+\\cos\\theta) + \\frac{2\\tau^2U^3}{h}(1-\\cos\\theta)\\sin\\theta$。因此上面的表达式是正确的。*\n\n**无量纲振幅误差 $E_{\\text{amp}}$:**\n$E_{\\text{amp}} = -\\frac{\\omega_i h}{U}$\n$$\nE_{\\text{amp}}(\\theta,\\tau) = -\\frac{h}{U}\\left(\\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{\\left(\\frac{h}{3}(2+\\cos\\theta)\\right)^2 + (\\tau U \\sin\\theta)^2}\\right) = \\frac{\\frac{\\tau U h}{3}(1-\\cos\\theta)^2}{\\left(\\frac{h}{3}(2+\\cos\\theta)\\right)^2 + (\\tau U \\sin\\theta)^2}\n$$\n将分子分母同乘以 $9$ 得到最终的闭合形式表达式：\n$$\nE_{\\text{amp}}(\\theta,\\tau) = \\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1,\n&\n\\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论分析揭示了稳定化会引入数值误差，但在实践中，我们必须找到一个平衡点，既能抑制非物理振荡，又不至于过度耗散掉真实的解特征。本练习模拟了一个实际的参数选择过程，您需要评估一系列 SUPG 和 DEVSS 稳定化参数组合 。通过计算有效的佩克莱数 (Péclet number)、振幅和相位误差，您将确定哪些参数能在给定网格上实现阻尼与精度的最佳权衡。",
            "id": "4103439",
            "problem": "考虑一个长度为 $L$ 的一维周期性域，其均匀网格尺寸为 $h = L/N$，其中 $N$ 是单元的数量。聚合物附加应力的一个标量分量，记为 $s(x)$，其稳态由以下线性化对流-扩散-反应方程建模\n$$\nu \\frac{d s}{d x} - \\kappa \\frac{d^2 s}{d x^2} + \\beta s = f(x),\n$$\n其中 $u$ 是恒定平均速度，$\\kappa$ 是应力的物理扩散系数，$\\beta = 1/\\lambda$ 是弛豫速率（$\\lambda$ 是弛豫时间）。假设周期性强迫项的形式为 $f(x) = \\sin(k x)$（波数为 $k$），且 $s(x)$ 满足周期性边界条件。\n\n连续线性有限元的经典 Galerkin 弱形式增加了两种在粘弹性流中广泛使用的稳定化机制：\n- 流线迎风/Petrov-Galerkin (SUPG)，由参数 $\\tau_m$ 表征，该方法增加了一个沿流线方向的一致性项。\n- 离散弹性粘性应力分裂 (DEVSS)，在此由无量纲参数 $\\tau_c$ 表征，建模为一维梯度上的一致性最小二乘项，用以抑制与应变率投影相关的伪振荡。\n\n在均匀网格上，使用与 $e^{i k x}$ 成正比的试探/检验函数进行傅里叶模态分析，两种稳定化项都充当了流线方向上的有效扩散贡献。具体而言，SUPG 贡献的量与 $u^2 \\tau_m$ 成正比，而受 DEVSS 启发的梯度稳定化贡献的量与 $\\tau_c \\kappa$ 成正比。最终的有效扩散系数为\n$$\n\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa.\n$$\n\n对于正弦强迫项 $f(x) = \\sin(k x)$，精确物理算子（扩散系数为 $\\kappa$）的稳态响应振幅和相位由傅里叶符号决定\n$$\nL_{\\text{phys}}(k) = \\beta + \\kappa k^2 + i u k,\n$$\n而稳定化算子的振幅和相位则由下式给出\n$$\nL_{\\text{num}}(k) = \\beta + \\kappa_{\\text{eff}} k^2 + i u k.\n$$\n响应振幅相对于强迫项振幅为 $A(k) = 1/|L(k)|$，精确算子的相移为 $\\phi(k) = -\\arg(L(k)) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$，稳定化算子的相移为 $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$。\n\n为量化给定网格下阻尼与精度之间的平衡，定义：\n- 基于有效扩散的网格 Péclet 数，\n$$\nPe_{\\text{eff}} = \\frac{u h}{2 \\kappa_{\\text{eff}}},\n$$\n该数值衡量了网格尺度上对流与扩散的相对强度。\n- 在可分辨波数 $k_r$ 处的振幅比偏差，\n$$\n\\Delta_A = \\left|\\frac{A_{\\text{num}}(k_r)}{A_{\\text{phys}}(k_r)} - 1\\right|,\n$$\n其中 $A_{\\text{phys}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa k^2)^2 + (u k)^2}}$ 且 $A_{\\text{num}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa_{\\text{eff}} k^2)^2 + (u k)^2}}$。\n- 在同一可分辨波数处的相位误差，\n$$\n\\Delta_\\phi = \\left|\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)\\right|,\n$$\n其中 $\\phi_{\\text{phys}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$ 且 $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$。\n\n当且仅当以下三个标准同时满足时，一个稳定化参数对 $(\\tau_m, \\tau_c)$ 被认为在给定网格上平衡了阻尼与精度：\n1. 网格 Péclet 数满足 $Pe_{\\text{eff}} \\in [Pe_{\\min}, Pe_{\\max}]$，其中 $Pe_{\\min} = 0.5$ 且 $Pe_{\\max} = 2.5$（无量纲）。\n2. 在 $k_r$ 处的振幅比偏差满足 $\\Delta_A \\leq \\delta_A$，其中 $\\delta_A = 0.15$（无量纲）。\n3. 在 $k_r$ 处的相位误差满足 $\\Delta_\\phi \\leq \\delta_\\phi$，其中 $\\delta_\\phi = 0.2$ 弧度。\n\n使用以下固定的物理和数值参数：\n- 域长度 $L = 1.0$ 米，单元数量 $N = 50$，因此 $h = L/N$（单位：米）。\n- 平均速度 $u = 1.0$ 米/秒。\n- 物理扩散系数 $\\kappa = 10^{-3}$ 平方米/秒。\n- 弛豫时间 $\\lambda = 0.5$ 秒，因此 $\\beta = 1/\\lambda = 2.0$ /秒。\n- 可分辨波数 $k_r = 2\\pi \\cdot 2$ 弧度/米。\n\n所有角度量必须以弧度计算，所有物理量必须使用其给定单位。\n\n待评估的参数对 $(\\tau_m, \\tau_c)$ 测试集：\n- 情况 1：$(0.0, 0.0)$，其中 $\\tau_m$ 单位为秒，$\\tau_c$ 为无量纲。\n- 情况 2：$(0.01, 0.1)$。\n- 情况 3：$(0.02, 0.0)$。\n- 情况 4：$(0.005, 0.5)$。\n- 情况 5：$(0.05, 2.0)$。\n- 情况 6：$(0.01, 1.0)$。\n- 情况 7：$(0.001, 0.0)$。\n- 情况 8：$(0.002, 3.0)$。\n\n你的程序必须为每个测试用例评估这三个标准，并输出一个布尔值，以指示给定的 $(\\tau_m, \\tau_c)$ 对是否平衡了阻尼和精度。最终输出必须是单行文本，包含一个用方括号括起来的逗号分隔列表，例如：“[True,False,True]”。",
            "solution": "该问题要求评估八组稳定化参数 $(\\tau_m, \\tau_c)$，以确定它们是否在给定物理和数值参数下，为一维对流-扩散-反应方程的模拟提供了阻尼与精度的良好平衡。平衡由三个标准共同定义：有效佩克莱数在指定范围内，振幅误差低于阈值，相位误差低于阈值。\n\n首先，我们整理固定的物理和数值常数：\n- 域长 $L = 1.0$ m，单元数 $N = 50$，因此网格尺寸 $h = L/N = 0.02$ m。\n- 速度 $u = 1.0$ m/s。\n- 物理扩散系数 $\\kappa = 10^{-3}$ m²/s。\n- 弛豫速率 $\\beta = 1/\\lambda = 1/0.5 = 2.0$ s⁻¹。\n- 分析波数 $k_r = 4\\pi$ rad/m。\n\n平衡标准阈值：\n1.  有效佩克莱数 $Pe_{\\text{eff}} \\in [0.5, 2.5]$。\n2.  振幅偏差 $\\Delta_A \\le 0.15$。\n3.  相位误差 $\\Delta_\\phi \\le 0.2$ rad。\n\n有效扩散系数 $\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa$ 是关键的中间量。\n\n我们先计算所有情况通用的物理量：\n- 波数平方 $k_r^2 = (4\\pi)^2 = 16\\pi^2$ rad²/m²。\n- 物理系统的傅里叶符号 $L_{\\text{phys}}(k_r)$ 的模的平方：\n  $|L_{\\text{phys}}(k_r)|^2 = (\\beta + \\kappa k_r^2)^2 + (u k_r)^2 = (2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2 \\approx 2.1578^2 + 12.566^2 \\approx 4.656 + 157.91 \\approx 162.566$。\n- 物理相移：\n  $\\phi_{\\text{phys}}(k_r) = -\\arctan\\left(\\frac{u k_r}{\\beta + \\kappa k_r^2}\\right) = -\\arctan\\left(\\frac{4\\pi}{2.1578}\\right) \\approx -1.4013$ rad。\n\n现在，我们逐一评估每个参数对 $(\\tau_m, \\tau_c)$：\n\n**情况 1: $(\\tau_m, \\tau_c) = (0.0, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3}$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 10^{-3}} = 10.0$。该值不在 $[0.5, 2.5]$ 内。\n    **结果：False。**\n\n**情况 2: $(\\tau_m, \\tau_c) = (0.01, 0.1)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.01 + 0.1 \\cdot 10^{-3} = 0.0111$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0111} \\approx 0.9009$。满足 $Pe_{\\text{eff}}$ 标准。\n3.  $|L_{\\text{num}}|^2 = (2.0 + 0.0111 \\cdot 16\\pi^2)^2 + (4\\pi)^2 \\approx 173.88$。$\\Delta_A = |\\sqrt{162.566 / 173.88} - 1| \\approx |0.967 - 1| \\approx 0.033  0.15$。满足 $\\Delta_A$ 标准。\n4.  $\\phi_{\\text{num}} = -\\arctan(\\frac{4\\pi}{2.0 + 0.0111 \\cdot 16\\pi^2}) \\approx -1.2809$ rad。$\\Delta_\\phi = |-1.2809 - (-1.4013)| \\approx 0.1204  0.2$。满足 $\\Delta_\\phi$ 标准。\n    所有标准均满足。**结果：True。**\n\n**情况 3: $(\\tau_m, \\tau_c) = (0.02, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.02 = 0.021$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.021} \\approx 0.4762$。该值不在 $[0.5, 2.5]$ 内。\n    **结果：False。**\n\n**情况 4: $(\\tau_m, \\tau_c) = (0.005, 0.5)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.005 + 0.5 \\cdot 10^{-3} = 0.0065$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0065} \\approx 1.5385$。满足 $Pe_{\\text{eff}}$ 标准。\n3.  $|L_{\\text{num}}|^2 = (2.0 + 0.0065 \\cdot 16\\pi^2)^2 + (4\\pi)^2 \\approx 167.06$。$\\Delta_A = |\\sqrt{162.566 / 167.06} - 1| \\approx |0.986 - 1| \\approx 0.014  0.15$。满足 $\\Delta_A$ 标准。\n4.  $\\phi_{\\text{num}} = -\\arctan(\\frac{4\\pi}{2.0 + 0.0065 \\cdot 16\\pi^2}) \\approx -1.3341$ rad。$\\Delta_\\phi = |-1.3341 - (-1.4013)| \\approx 0.0672  0.2$。满足 $\\Delta_\\phi$ 标准。\n    所有标准均满足。**结果：True。**\n\n**情况 5: $(\\tau_m, \\tau_c) = (0.05, 2.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.05 + 2.0 \\cdot 10^{-3} = 0.053$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.053} \\approx 0.1887$。该值不在 $[0.5, 2.5]$ 内。\n    **结果：False。**\n\n**情况 6: $(\\tau_m, \\tau_c) = (0.01, 1.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.01 + 1.0 \\cdot 10^{-3} = 0.012$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.012} \\approx 0.8333$。满足 $Pe_{\\text{eff}}$ 标准。\n3.  $|L_{\\text{num}}|^2 = (2.0 + 0.012 \\cdot 16\\pi^2)^2 + (4\\pi)^2 \\approx 174.98$。$\\Delta_A = |\\sqrt{162.566 / 174.98} - 1| \\approx |0.964 - 1| \\approx 0.036  0.15$。满足 $\\Delta_A$ 标准。\n4.  $\\phi_{\\text{num}} = -\\arctan(\\frac{4\\pi}{2.0 + 0.012 \\cdot 16\\pi^2}) \\approx -1.2707$ rad。$\\Delta_\\phi = |-1.2707 - (-1.4013)| \\approx 0.1306  0.2$。满足 $\\Delta_\\phi$ 标准。\n    所有标准均满足。**结果：True。**\n\n**情况 7: $(\\tau_m, \\tau_c) = (0.001, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.001 = 0.002$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.002} = 5.0$。该值不在 $[0.5, 2.5]$ 内。\n    **结果：False。**\n\n**情况 8: $(\\tau_m, \\tau_c) = (0.002, 3.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 0.002 + 3.0 \\cdot 10^{-3} = 0.006$ m²/s。\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.006} \\approx 1.6667$。满足 $Pe_{\\text{eff}}$ 标准。\n3.  $|L_{\\text{num}}|^2 = (2.0 + 0.006 \\cdot 16\\pi^2)^2 + (4\\pi)^2 \\approx 166.49$。$\\Delta_A = |\\sqrt{162.566 / 166.49} - 1| \\approx |0.988 - 1| \\approx 0.012  0.15$。满足 $\\Delta_A$ 标准。\n4.  $\\phi_{\\text{num}} = -\\arctan(\\frac{4\\pi}{2.0 + 0.006 \\cdot 16\\pi^2}) \\approx -1.3395$ rad。$\\Delta_\\phi = |-1.3395 - (-1.4013)| \\approx 0.0618  0.2$。满足 $\\Delta_\\phi$ 标准。\n    所有标准均满足。**结果：True。**\n\n最终结果序列为：[False, True, False, True, False, True, False, True]。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates stabilization parameter pairs against three criteria for balancing\n    damping and accuracy in a model viscoelastic flow problem.\n    \"\"\"\n    # Define fixed physical and numerical parameters\n    L = 1.0  # Domain length (m)\n    N = 50   # Number of elements\n    u = 1.0  # Mean velocity (m/s)\n    kappa = 1e-3  # Physical diffusivity (m^2/s)\n    lambda_relax = 0.5  # Relaxation time (s)\n    k_r = 2 * np.pi * 2  # Resolved wavenumber (rad/m)\n\n    # Define criteria thresholds\n    Pe_min = 0.5\n    Pe_max = 2.5\n    delta_A_max = 0.15\n    delta_phi_max = 0.2  # radians\n\n    # Derived constants\n    h = L / N  # Mesh size (m)\n    beta = 1.0 / lambda_relax  # Relaxation rate (1/s)\n\n    # Test suite of parameter pairs (tau_m, tau_c)\n    test_cases = [\n        (0.0, 0.0),    # Case 1\n        (0.01, 0.1),   # Case 2\n        (0.02, 0.0),   # Case 3\n        (0.005, 0.5),  # Case 4\n        (0.05, 2.0),   # Case 5\n        (0.01, 1.0),   # Case 6\n        (0.001, 0.0),  # Case 7\n        (0.002, 3.0),  # Case 8\n    ]\n\n    results = []\n\n    # Pre-calculate physical system quantities (constant for all cases)\n    k_r_sq = k_r**2\n    u_k_r = u * k_r\n    \n    # Denominator parts for physical operator\n    denom_real_phys = beta + kappa * k_r_sq\n    denom_imag_phys = u_k_r\n    L_mag_sq_phys = denom_real_phys**2 + denom_imag_phys**2\n    phi_phys = -np.arctan2(denom_imag_phys, denom_real_phys)\n\n    for tau_m, tau_c in test_cases:\n        # Step 1: Calculate effective diffusion and check Péclet number criterion\n        kappa_eff = kappa + u**2 * tau_m + tau_c * kappa\n        Pe_eff = (u * h) / (2 * kappa_eff)\n        \n        crit1_passed = (Pe_min = Pe_eff) and (Pe_eff = Pe_max)\n\n        # Step 2: Calculate amplitude ratio deviation\n        denom_real_num = beta + kappa_eff * k_r_sq\n        denom_imag_num = u_k_r\n        L_mag_sq_num = denom_real_num**2 + denom_imag_num**2\n        \n        # A_num / A_phys = |L_phys| / |L_num| = sqrt(L_mag_sq_phys / L_mag_sq_num)\n        amp_ratio = np.sqrt(L_mag_sq_phys / L_mag_sq_num)\n        delta_A = np.abs(amp_ratio - 1)\n        \n        crit2_passed = (delta_A = delta_A_max)\n\n        # Step 3: Calculate phase error\n        phi_num = -np.arctan2(denom_imag_num, denom_real_num)\n        delta_phi = np.abs(phi_num - phi_phys)\n        \n        crit3_passed = (delta_phi = delta_phi_max)\n\n        # A pair is balanced if and only if all three criteria are met\n        is_balanced = crit1_passed and crit2_passed and crit3_passed\n        results.append(is_balanced)\n\n    # Format the final output as a comma-separated list of booleans\n    # The map(str, ...) is required to convert boolean True/False to string \"True\"/\"False\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在粘弹性流动计算中，精确计算速度梯度 ($\\nabla \\mathbf{u}$) 至关重要，因为聚合物应力对此高度敏感。本练习将演示一个类似离散弹性粘性应力分裂 (DEVSS) 的稳定化方法如何改善速度梯度的计算 。您将比较朴素有限差分梯度和稳定化后梯度的误差分布，从而直观地理解稳定化如何通过全局平滑作用，将边界附近集中的剧烈误差重新分布到整个区域，获得更物理的梯度场。",
            "id": "4103431",
            "problem": "考虑一个无量纲平面剪切流，流体为粘弹性流体，在一维通道（坐标 $y \\in [0,1]$）中流动。真实速度场为 $u_{\\text{true}}(y) = S\\,y$，其中 $S$ 是无量纲剪切速率。速度梯度为常数 $\\nabla \\mathbf{u} = \\partial u / \\partial y = S$。在离散计算中，观测到的节点速度 $u_{\\text{obs}}(y_j)$ 可能包含误差，这会导致计算出的速度梯度 $\\nabla \\mathbf{u}$ 中出现局部化误差。在计算复杂流体中，通常使用诸如离散弹性粘性应力分裂 (Discrete Elastic Viscous Stress Splitting, DEVSS) 和流线迎风 Petrov-Galerkin (Streamline Upwind Petrov-Galerkin, SUPG) 等稳定化方法来缓解此类问题。在本问题中，您将实现一种类似 DEVSS 的稳定化方法，该方法引入一个辅助梯度场和一个一致性惩罚项，然后比较使用和不使用稳定化时误差的局部化情况。\n\n从以下基本前提开始：\n- 速度梯度定义为 $\\nabla \\mathbf{u} = \\partial u / \\partial y$。\n- 在间距为 $h = 1/(N-1)$ 的均匀网格上，梯度的有限差分近似在边界处使用单边差分，在内部使用中心差分。\n- 带有光滑度惩罚项的最小二乘投影可以表示为最小化以下形式的二次泛函\n$$\nJ(G) = \\sum_{j=0}^{N-1} w_j \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2,\n$$\n其中 $G_j$ 是节点 $j$ 处梯度的稳定化近似， $D_j$ 是节点 $j$ 处 $\\partial u/\\partial y$ 的有限差分估计，$w_j$ 是正权重，$\\alpha \\ge 0$ 是稳定化强度。通过将 $J$ 对 $G$ 的导数设为零，可以获得最小化子 $G$ 的正规方程。\n\n您的任务是：\n1. 在 $y \\in [0,1]$ 中构建一个包含 $N$ 个节点的均匀网格，其中 $y_j = j h$，$j = 0,1,\\dots,N-1$，$h = 1/(N-1)$。\n2. 定义真实速度 $u_{\\text{true}}(y_j) = S\\,y_j$ 和观测速度\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right),\n$$\n其中 $A$ 控制类边界层振荡的振幅，$\\beta$ 控制其在 $y=0$ 和 $y=1$ 附近的局部化程度。\n3. 使用有限差分从 $u_{\\text{obs}}$ 计算朴素离散梯度 $D_j$：$D_0 = (u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0))/h$， $D_{N-1} = (u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2}))/h$，以及 $D_j = (u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1}))/(2h)$ 对于 $j = 1,\\dots,N-2$。\n4. 通过求解 $J(G)$ 在所有 $j$ 的 $w_j=1$ 条件下的最小化子的正规方程，来构建类似DEVSS的稳定化梯度 $G$。证明所得到的线性系统可以写为\n$$\n\\left(I + \\alpha Q\\right) G = D,\n$$\n其中 $I$ 是单位矩阵，$Q$ 是由离散梯度惩罚项产生的对称半正定矩阵，其元素为\n$$\nQ_{jj} = \\begin{cases}\n1,  j = 0,\\\\\n2,  1 \\le j \\le N-2,\\\\\n1,  j = N-1,\n\\end{cases}\n\\quad\nQ_{j,j+1} = Q_{j+1,j} = -1 \\text{ for } 0 \\le j \\le N-2,\n$$\n并按 $1/h^2$ 进行缩放。\n5. 定义逐点梯度误差 $e_{\\text{naive}}(y_j) = D_j - S$ 和 $e_{\\text{stab}}(y_j) = G_j - S$。通过分数\n$$\nR(e) = \\frac{\\sum_{j: y_j \\le \\delta \\text{ or } y_j \\ge 1-\\delta} \\left|e(y_j)\\right|}{\\sum_{j=0}^{N-1} \\left|e(y_j)\\right|},\n$$\n来量化误差的边界局部化，约定如果分母为零，则 $R(e) = 0$。这里，$\\delta \\in (0,1/2)$ 定义了边界层的宽度。\n6. 对于每个测试用例，计算由稳定化引起的边界误差局部化的变化量 $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$。\n\n所有量均为无量纲。您的程序必须实现上述步骤，并为以下测试套件生成结果：\n- 测试用例 1：$N = 101$, $S = 1$, $A = 0.1$, $\\beta = 8$, $\\alpha = 0.01$, $\\delta = 0.1$。\n- 测试用例 2：$N = 101$, $S = 1$, $A = 0$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$。\n- 测试用例 3：$N = 21$, $S = 1$, $A = 0.2$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$。\n- 测试用例 4：$N = 101$, $S = 1$, $A = 0.5$, $\\beta = 12$, $\\alpha = 0.1$, $\\delta = 0.1$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个条目必须是对应测试用例的浮点数 $\\Delta R$，四舍五入到六位小数，并按上面列出的测试用例顺序排列（例如，$[\\Delta R_1,\\Delta R_2,\\Delta R_3,\\Delta R_4]$）。输出必须严格遵守此格式，且只有一行。\n\n在您的解决方案中，解释为什么稳定化会改变 $\\nabla \\mathbf{u}$ 中误差的局部化，以及与朴素有限差分梯度相比，类似 DEVSS 的惩罚项如何重新分布和衰减边界附近的误差。您的解释必须基于上述基本前提，并避免使用超出这些定义的捷径或预设结论。不要引用任何外部文件或数据；所有计算都必须在程序内完成。",
            "solution": "该问题的核心是分析一种类似于DEVSS方法中使用的正则化技术，如何改变数值计算的速度梯度的误差特性。稳定化的目的是减轻可能由含噪声的输入数据或数值不稳定性引起的伪振荡，这在粘弹性流动的模拟中是一个关键问题，因为在这些流动中，应力对速度梯度高度敏感。\n\n我们从一个一维域 $y \\in [0, 1]$ 开始，该域被 $N$ 个均匀间隔的节点 $y_j = j h$（$j = 0, 1, \\dots, N-1$）离散化，网格间距为 $h = 1/(N-1)$。真实速度场是线性剪切流 $u_{\\text{true}}(y) = S y$，其速度梯度为常数 $\\nabla \\mathbf{u} = \\partial u / \\partial y = S$。\n\n然而，计算过程从一个“观测”速度场 $u_{\\text{obs}}(y_j)$ 开始，该速度场包含类边界层振荡误差：\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right)\n$$\n附加项引入了高频振荡，这些振荡在边界 $y=0$ 和 $y=1$ 附近最为显著，并向内部衰减，由参数 $\\beta$ 控制。\n\n第一步是使用有限差分公式，在 $u_{\\text{obs}}$ 值的网格上计算一个“朴素”速度梯度，用向量 $D$ 表示。由于微分的局部性质，这些算子会放大高频噪声。在边界使用单边差分，在内部使用中心差分，我们计算：\n$$\n\\begin{align*}\nD_0 = \\frac{u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0)}{h} \\\\\nD_j = \\frac{u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1})}{2h}, \\quad \\text{for } j = 1, \\dots, N-2 \\\\\nD_{N-1} = \\frac{u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2})}{h}\n\\end{align*}\n$$\n这个朴素梯度的误差是 $e_{\\text{naive}, j} = D_j - S$。$u_{\\text{obs}}$ 中误差的振荡特性，特别是在边界附近，将导致 $D$ 中出现大的局部化误差。\n\n为了减轻这些局部化误差，引入了一种类似 DEVSS 的稳定化方法。我们寻求一个新的、“稳定化”的梯度场 $G$，它既接近朴素梯度 $D$，又比它更光滑。这被表述为一个变分问题：找到最小化二次泛函 $J(G)$ 的向量 $G$：\n$$\nJ(G) = \\sum_{j=0}^{N-1} \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2\n$$\n这里，第一项强制要求与原始梯度数据 $D$ 的保真度。第二项是一个正则化惩罚项，用于惩罚解 $G$ 的粗糙度。项 $(G_{j+1} - G_j)/h$ 是 $G$ 导数的有限差分近似，因此该惩罚项是 $\\int (\\partial G/\\partial y)^2 dy$ 的一个近似。最小化此项会促使梯度场 $G$ 更光滑。参数 $\\alpha \\geq 0$ 控制了这种平滑的强度。\n\n为了找到最小化子 $G$，我们将 $J(G)$ 对每个分量 $G_k$ 求导并令其为零，即 $\\partial J / \\partial G_k = 0$，其中 $k = 0, 1, \\dots, N-1$。对于内部节点 $k \\in \\{1, \\dots, N-2\\}$：\n$$\n\\frac{\\partial J}{\\partial G_k} = 2(G_k - D_k) + \\frac{\\alpha}{h^2} \\left[ -2(G_{k+1}-G_k) + 2(G_k - G_{k-1}) \\right] = 0 \\\\\n\\implies (G_k - D_k) + \\frac{\\alpha}{h^2} (-G_{k-1} + 2G_k - G_{k+1}) = 0\n$$\n对于边界节点 $k=0$ 和 $k=N-1$，推导类似，最终将这 $N$ 个线性方程组装成矩阵形式，得到系统：\n$$\n\\left(I + \\frac{\\alpha}{h^2} K\\right) G = D\n$$\n其中 $I$ 是单位矩阵，$K$ 是对应于离散拉普拉斯算子的 $N \\times N$ 对称矩阵。问题中定义的矩阵 $Q = K/h^2$ 直接导出了指定的线性系统 $(I + \\alpha Q) G = D$。\n\n通过求解该系统得到 $G = (I + \\alpha Q)^{-1} D$，从而找到稳定化梯度。矩阵算子 $(I + \\alpha Q)^{-1}$ 充当一个全局低通滤波器。它会抑制输入向量 $D$ 中存在的高频分量。这种稳定化的效果是误差的重新分布。朴素梯度误差 $e_{\\text{naive}}$ 是尖锐且局部化的，而稳定化过程由于矩阵求逆而具有全局性，它将这些大的、局部化的误差平滑掉，将较小的误差幅度分布到整个域中。因此，稳定化梯度中的误差 $e_{\\text{stab}} = G - S$ 将不那么集中在边界处。\n\n我们使用比率 $R(e)$ 来量化误差局部化的这种变化，该比率衡量宽度为 $\\delta$ 的边界层内所包含的总绝对误差的比例。对于存在振荡误差的情况（$A \\neq 0$），$\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$ 预计为负值，表明稳定化成功地减少了边界附近的误差集中。对于没有引入误差的情况（$A=0$），$D_j=S$，导致 $e_{\\text{naive}}=\\mathbf{0}$ 和 $R(e_{\\text{naive}})=0$。由于常数向量位于 $Q$ 的零空间中，$(I+\\alpha Q)G = S \\cdot \\mathbf{1}$ 的解是 $G=S \\cdot \\mathbf{1}$。因此，$e_{\\text{stab}}=\\mathbf{0}$，$R(e_{\\text{stab}})=0$，且 $\\Delta R = 0$。\n\n数值计算过程如下：\n1. 对每个测试用例，建立网格并计算 $u_{\\text{obs}}$。\n2. 使用指定的有限差分模板计算朴素梯度向量 $D$。\n3. 构建矩阵 $Q$ 并求解线性系统 $(I + \\alpha Q) G = D$ 以找到稳定化梯度 $G$。\n4. 计算误差向量 $e_{\\text{naive}} = D - S$ 和 $e_{\\text{stab}} = G - S$。\n5. 计算局部化比率 $R(e_{\\text{naive}})$ 和 $R(e_{\\text{stab}})$。\n6. 计算局部化的变化量 $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute the change in error localization\n    for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, S, A, beta, alpha, delta)\n        (101, 1.0, 0.1, 8.0, 0.01, 0.1),\n        (101, 1.0, 0.0, 8.0, 0.05, 0.1),\n        (21, 1.0, 0.2, 8.0, 0.05, 0.1),\n        (101, 1.0, 0.5, 12.0, 0.1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, S, A, beta, alpha, delta = case\n        \n        # 1. Construct the grid\n        h = 1.0 / (N - 1)\n        y = np.linspace(0.0, 1.0, N)\n        \n        # 2. Define true and observed velocities\n        u_true = S * y\n        noise = A * (np.sin(2 * np.pi * y) * np.exp(-beta * y) + \n                     np.sin(2 * np.pi * (1 - y)) * np.exp(-beta * (1 - y)))\n        u_obs = u_true + noise\n        \n        # 3. Compute the naive discrete gradient D\n        D = np.zeros(N)\n        D[0] = (u_obs[1] - u_obs[0]) / h\n        D[N-1] = (u_obs[N-1] - u_obs[N-2]) / h\n        D[1:N-1] = (u_obs[2:] - u_obs[0:-2]) / (2 * h)\n        \n        # 4. Formulate and solve for the stabilized gradient G\n        # Construct the matrix K (unscaled Q)\n        diag_main = np.full(N, 2.0)\n        diag_main[0] = 1.0\n        diag_main[-1] = 1.0\n        diag_off = np.full(N - 1, -1.0)\n        K = np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1)\n        \n        # Scale K by 1/h^2 to get Q\n        Q = K / (h**2)\n        \n        # Construct the system matrix M = (I + alpha*Q)\n        M = np.eye(N) + alpha * Q\n        \n        # Solve MG = D for G\n        G = np.linalg.solve(M, D)\n        \n        # 5. Define pointwise errors and quantify boundary localization\n        e_naive = D - S\n        e_stab = G - S\n        \n        def calculate_R(e, y_grid, delta_val):\n            \"\"\"\n            Computes the error localization ratio R(e).\n            \"\"\"\n            total_abs_error = np.sum(np.abs(e))\n            if total_abs_error == 0.0:\n                return 0.0\n            \n            boundary_mask = (y_grid = delta_val) | (y_grid >= 1 - delta_val)\n            boundary_abs_error = np.sum(np.abs(e[boundary_mask]))\n            \n            return boundary_abs_error / total_abs_error\n\n        R_naive = calculate_R(e_naive, y, delta)\n        R_stab = calculate_R(e_stab, y, delta)\n\n        # 6. Compute the change in boundary error localization\n        delta_R = R_stab - R_naive\n        results.append(delta_R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}