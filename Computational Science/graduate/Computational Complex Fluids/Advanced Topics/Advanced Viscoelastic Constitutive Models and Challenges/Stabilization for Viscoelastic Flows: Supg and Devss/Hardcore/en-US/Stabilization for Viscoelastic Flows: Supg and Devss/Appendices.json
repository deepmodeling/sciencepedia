{
    "hands_on_practices": [
        {
            "introduction": "The Streamline Upwind/Petrov-Galerkin (SUPG) method is a cornerstone for stabilizing the advection-dominated equations central to viscoelastic flow modeling. To truly understand its impact, we must go beyond qualitative descriptions and quantify its effects. This practice delves into the mathematical core of SUPG through a Fourier analysis of a model advection problem . By deriving the exact expressions for numerical phase and amplitude errors, you will gain a fundamental understanding of how SUPG introduces both necessary damping and unavoidable inaccuracies, providing the analytical basis for choosing the stabilization parameter $\\tau$.",
            "id": "4103393",
            "problem": "Consider a one-dimensional periodic domain of length $L$ with uniform mesh spacing $h$ and a uniform steady velocity $U>0$. To isolate stabilization effects in a viscoelastic constitutive transport equation, model the advection of a single scalar component of a polymer conformation tensor by the scalar linear advection equation $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$ on the periodic domain. Discretize $\\phi$ with continuous, piecewise linear finite elements on the uniform mesh, using the consistent mass matrix. Stabilize the semi-discrete formulation via the Streamline Upwind/Petrov-Galerkin (SUPG) method, where the test function is perturbed along streamlines as $w \\mapsto w + \\tau \\, U \\, \\partial_{x} w$, with stabilization parameter $\\tau$ constant over the domain. Assume the field is represented as $\\phi_{h}(x,t) = \\sum_{j} a_{j}(t) N_{j}(x)$ with uniform nodal spacing and consider a single Fourier mode $a_{j}(t) = A \\exp(i j \\theta - i \\omega t)$, with dimensionless wavenumber $\\theta = k h \\in [0,\\pi]$. Starting from this semi-discrete SUPG formulation, perform a Fourier or von Neumann analysis to derive the dispersion relation $\\omega(\\theta;\\tau)$, and then define and express in closed form:\n\n- the dimensionless phase speed error, $E_{\\text{phase}}(\\theta,\\tau)$, as the fractional deviation of the numerical phase speed from the exact phase speed, $E_{\\text{phase}}(\\theta,\\tau) = \\frac{c_{\\text{num}}(\\theta,\\tau) - U}{U}$ with $c_{\\text{num}}(\\theta,\\tau) = \\omega_{r}(\\theta,\\tau)/k$, and\n- the dimensionless amplitude error, $E_{\\text{amp}}(\\theta,\\tau)$, as the damping rate normalized by $U/h$, $E_{\\text{amp}}(\\theta,\\tau) = - \\frac{\\omega_{i}(\\theta,\\tau) \\, h}{U}$,\n\nwhere $\\omega_{r}$ and $\\omega_{i}$ denote the real and imaginary parts of the complex frequency $\\omega(\\theta;\\tau)$, respectively.\n\nYou must begin from the continuous weak form with SUPG stabilization and derive the semi-discrete algebraic system and its Fourier symbols for the consistent mass, the Galerkin advection, the gradient-weighted SUPG mass coupling, and the SUPG-induced streamline diffusion matrices. Then derive the exact closed-form expressions for $E_{\\text{phase}}(\\theta,\\tau)$ and $E_{\\text{amp}}(\\theta,\\tau)$ as functions of $\\theta$, $\\tau$, $U$, and $h$. Express your final answer as a single row matrix with two entries $\\left[E_{\\text{phase}}(\\theta,\\tau), E_{\\text{amp}}(\\theta,\\tau)\\right]$. No numerical evaluation is required; provide the expressions symbolically.",
            "solution": "### Derivation of the Solution\nThe derivation proceeds by first establishing the SUPG weak form of the governing equation, then discretizing it in space using linear finite elements to obtain a semi-discrete system of ordinary differential equations. A Fourier analysis of this system yields the dispersion relation, from which the phase and amplitude errors are calculated.\n\n**1. SUPG Weak Formulation**\nThe linear advection equation is $\\partial_{t} \\phi + U \\, \\partial_{x} \\phi = 0$. The standard Galerkin weak form involves multiplying by a test function $w$ and integrating over the domain $\\Omega$. The SUPG method modifies the test function to $w' = w + \\tau \\, U \\, \\partial_{x} w$. The SUPG weak form is: Find $\\phi_h \\in V_h$ such that for all $w_h \\in V_h$:\n$$\n\\int_{\\Omega} (\\partial_t \\phi_h) (w_h + \\tau U \\partial_x w_h) \\, dx + \\int_{\\Omega} (U \\partial_x \\phi_h) (w_h + \\tau U \\partial_x w_h) \\, dx = 0\n$$\nwhere $V_h$ is the space of continuous piecewise linear functions on the mesh. Expanding this expression gives four terms:\n$$\n\\underbrace{\\int_{\\Omega} w_h \\partial_t \\phi_h \\, dx}_{\\text{Mass}} + \\underbrace{\\int_{\\Omega} w_h U \\partial_x \\phi_h \\, dx}_{\\text{Advection}} + \\underbrace{\\int_{\\Omega} \\tau U \\partial_x w_h \\partial_t \\phi_h \\, dx}_{\\text{SUPG Mass}} + \\underbrace{\\int_{\\Omega} \\tau U^2 \\partial_x w_h \\partial_x \\phi_h \\, dx}_{\\text{SUPG Diffusion}} = 0\n$$\n\n**2. Semi-Discrete System and Fourier Symbols**\nWe substitute the finite element expansion $\\phi_h(x,t) = \\sum_j a_j(t) N_j(x)$ and choose the test function $w_h = N_i(x)$ for each node $i$. This yields a system of ODEs for the nodal coefficients $\\mathbf{a}(t)$:\n$$\n(\\mathbf{M} + \\mathbf{M}_{\\text{SUPG}})\\frac{d\\mathbf{a}}{dt} + (\\mathbf{K} + \\mathbf{K}_{\\text{SUPG}})\\mathbf{a} = 0\n$$\nThe matrices are defined by their components:\n- Consistent Mass Matrix: $\\mathbf{M}_{ij} = \\int N_j N_i \\, dx$\n- Galerkin Advection Matrix: $\\mathbf{K}_{ij} = \\int U N_i (\\partial_x N_j) \\, dx$\n- SUPG Mass Coupling Matrix: $(\\mathbf{M}_{\\text{SUPG}})_{ij} = \\int \\tau U (\\partial_x N_i) N_j \\, dx$\n- SUPG Diffusion Matrix: $(\\mathbf{K}_{\\text{SUPG}})_{ij} = \\int \\tau U^2 (\\partial_x N_i)(\\partial_x N_j) \\, dx$\n\nFor uniform 1D linear elements with spacing $h$, the non-zero stencil entries for a generic row are:\n- $\\mathbf{M}$: $h[\\frac{1}{6}, \\frac{4}{6}, \\frac{1}{6}]$ for nodes $[j-1, j, j+1]$\n- $\\mathbf{K}$: $U[-\\frac{1}{2}, 0, \\frac{1}{2}]$ for nodes $[j-1, j, j+1]$\n- $\\mathbf{M}_{\\text{SUPG}}$: $\\tau U[\\frac{1}{2}, 0, -\\frac{1}{2}]$ for nodes $[j-1, j, j+1]$\n- $\\mathbf{K}_{\\text{SUPG}}$: $\\frac{\\tau U^2}{h}[-1, 2, -1]$ for nodes $[j-1, j, j+1]$\n\nApplying the Fourier ansatz $a_j(t) = A \\exp(i j \\theta - i \\omega t)$ transforms the matrix-vector operations into multiplication by their corresponding Fourier symbols (amplification factors). The symbol $\\hat{C}(\\theta)$ for a matrix $\\mathbf{C}$ with stencil $[c_{-1}, c_0, c_1]$ is $\\hat{C}(\\theta) = c_{-1}e^{-i\\theta} + c_0 + c_1e^{i\\theta}$.\n- $\\hat{M}(\\theta) = h(\\frac{1}{6}e^{-i\\theta} + \\frac{4}{6} + \\frac{1}{6}e^{i\\theta}) = \\frac{h}{3}(2 + \\cos\\theta)$\n- $\\hat{K}(\\theta) = U(-\\frac{1}{2}e^{-i\\theta} + 0 + \\frac{1}{2}e^{i\\theta}) = i U \\sin\\theta$\n- $\\hat{M}_{\\text{SUPG}}(\\theta) = \\tau U(\\frac{1}{2}e^{-i\\theta} + 0 - \\frac{1}{2}e^{i\\theta}) = -i \\tau U \\sin\\theta$\n- $\\hat{K}_{\\text{SUPG}}(\\theta) = \\frac{\\tau U^2}{h}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{2\\tau U^2}{h}(1 - \\cos\\theta)$\n\nThe semi-discrete system becomes an algebraic equation for $\\omega$:\n$$\n(-i\\omega)[\\hat{M}(\\theta) + \\hat{M}_{\\text{SUPG}}(\\theta)] + [\\hat{K}(\\theta) + \\hat{K}_{\\text{SUPG}}(\\theta)] = 0\n$$\nThus, the dispersion relation is:\n$$\n\\omega(\\theta;\\tau) = -i \\frac{\\hat{K}_{\\text{tot}}(\\theta)}{\\hat{M}_{\\text{tot}}(\\theta)} = -i \\frac{iU\\sin\\theta + \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n$$\n\\omega(\\theta;\\tau) = \\frac{U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta}\n$$\n\n**3. Derivation of Phase and Amplitude Errors**\nTo find the phase and amplitude errors, we must separate $\\omega$ into its real part $\\omega_r$ and imaginary part $\\omega_i$. We multiply the numerator and denominator by the complex conjugate of the denominator:\nLet $N = U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)$ and $D = \\frac{h}{3}(2+\\cos\\theta) - i\\tau U \\sin\\theta$.\n$$\n\\omega = \\frac{N\\bar{D}}{|D|^2} = \\frac{(U\\sin\\theta - i \\frac{2\\tau U^2}{h}(1-\\cos\\theta)) (\\frac{h}{3}(2+\\cos\\theta) + i\\tau U \\sin\\theta)}{(\\frac{h}{3}(2+\\cos\\theta))^2 + (\\tau U \\sin\\theta)^2}\n$$\nThe real and imaginary parts are:\n$$\n\\omega_r = \\text{Re}(\\omega) = \\frac{U\\sin\\theta \\cdot \\frac{h}{3}(2+\\cos\\theta) + \\frac{2\\tau U^2}{h}(1-\\cos\\theta) \\cdot \\tau U \\sin\\theta}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n$$\n\\omega_i = \\text{Im}(\\omega) = \\frac{-\\frac{2\\tau U^2}{h}(1-\\cos\\theta) \\cdot \\frac{h}{3}(2+\\cos\\theta) + U\\sin\\theta \\cdot \\tau U \\sin\\theta}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\nSimplifying the numerator of $\\omega_i$:\n$N_{\\omega_i} = -\\frac{2\\tau U^2}{3}(1-\\cos\\theta)(2+\\cos\\theta) + \\tau U^2 \\sin^2\\theta = \\tau U^2 [-\\frac{2}{3}(2-\\cos\\theta-\\cos^2\\theta) + (1-\\cos^2\\theta)] = \\tau U^2 [-\\frac{1}{3} + \\frac{2}{3}\\cos\\theta - \\frac{1}{3}\\cos^2\\theta] = -\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2$.\nSo,\n$$\n\\omega_i = \\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\n\n**Dimensionless Phase Speed Error:**\nThe numerical phase speed is $c_{\\text{num}} = \\omega_r/k = \\omega_r h/\\theta$.\n$E_{\\text{phase}} = \\frac{c_{\\text{num}}-U}{U} = \\frac{\\omega_r h}{U\\theta} - 1$.\n$$\n\\frac{\\omega_r h}{U\\theta} = \\frac{h}{U\\theta} \\frac{\\frac{Uh}{3}(2+\\cos\\theta)\\sin\\theta + \\frac{2\\tau^2 U^3}{h}(1-\\cos\\theta)\\sin\\theta}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\nTo simplify the expression, we can multiply the numerator and denominator of the main fraction by $9$:\n$$\n\\frac{\\omega_r h}{U\\theta} = \\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n$$\nThe phase error is then:\n$$\nE_{\\text{phase}}(\\theta,\\tau) = \\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1\n$$\n\n**Dimensionless Amplitude Error:**\n$E_{\\text{amp}} = -\\frac{\\omega_i h}{U}$.\n$$\nE_{\\text{amp}}(\\theta,\\tau) = -\\frac{h}{U}\\left(\\frac{-\\frac{\\tau U^2}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\\right) = \\frac{\\frac{\\tau U h}{3}(1-\\cos\\theta)^2}{(\\frac{h}{3}(2+\\cos\\theta))^2 + \\tau^2 U^2 \\sin^2\\theta}\n$$\nAgain, multiplying the numerator and denominator by $9$ yields the final closed-form expression:\n$$\nE_{\\text{amp}}(\\theta,\\tau) = \\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n$$\nThese expressions provide the dimensionless phase and amplitude errors as functions of the dimensionless wavenumber $\\theta$ and the stabilization parameter $\\tau$, along with physical and discretization parameters $U$ and $h$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\frac{3h^2\\sin\\theta}{\\theta}(2+\\cos\\theta) + \\frac{18\\tau^2 U^2\\sin\\theta}{\\theta}(1-\\cos\\theta)}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta} - 1\n&\n\\frac{3\\tau U h (1-\\cos\\theta)^2}{h^2(2+\\cos\\theta)^2 + 9\\tau^2 U^2 \\sin^2\\theta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While SUPG primarily targets the hyperbolic constitutive equation, instabilities also arise from the coupling between stress and velocity fields. A key idea in methods like Discrete Elastic Viscous Stress Splitting (DEVSS) is to enforce smoothness on critical fields like the velocity gradient, $\\nabla \\boldsymbol{u}$. This exercise provides a hands-on demonstration of how such a stabilization scheme works in practice . You will implement a DEVSS-like smoothing operation on a noisy velocity gradient and quantitatively analyze how it redistributes sharp, localized errors, a crucial step for obtaining stable stress fields.",
            "id": "4103431",
            "problem": "Consider a nondimensional planar shear flow of a viscoelastic fluid in a one-dimensional channel with coordinate $y \\in [0,1]$. The true velocity field is $u_{\\text{true}}(y) = S\\,y$, where $S$ is the nondimensional shear rate. The velocity gradient is $\\nabla \\mathbf{u} = \\partial u / \\partial y = S$, a constant. In discrete computations, the observed nodal velocity $u_{\\text{obs}}(y_j)$ may contain errors that can lead to localized errors in the computed velocity gradient $\\nabla \\mathbf{u}$. Stabilization methods such as Discrete Elastic Viscous Stress Splitting (DEVSS) and Streamline Upwind Petrov-Galerkin (SUPG) are commonly used in computational complex fluids to mitigate such issues. In this problem, you will implement a DEVSS-like stabilization that introduces an auxiliary gradient field and a consistency penalty, and then compare error localization with and without stabilization.\n\nStart from the following fundamental base:\n- The velocity gradient is defined by $\\nabla \\mathbf{u} = \\partial u / \\partial y$.\n- A finite difference approximation of the gradient on a uniform grid with spacing $h = 1/(N-1)$ uses one-sided differences at the boundaries and central differences in the interior.\n- A least-squares projection with a smoothness penalty can be posed as minimizing a quadratic functional of the form\n$$\nJ(G) = \\sum_{j=0}^{N-1} w_j \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2,\n$$\nwhere $G_j$ is the stabilized approximation to the gradient at node $j$, $D_j$ is the finite difference estimate of $\\partial u/\\partial y$ at node $j$, $w_j$ are positive weights, and $\\alpha \\ge 0$ is the stabilization strength. The normal equations for the minimizer $G$ are obtained by setting the derivative of $J$ with respect to $G$ equal to zero.\n\nYour task is to:\n1. Construct a uniform grid of $N$ nodes in $y \\in [0,1]$, with $y_j = j h$ for $j = 0,1,\\dots,N-1$ and $h = 1/(N-1)$.\n2. Define the true velocity $u_{\\text{true}}(y_j) = S\\,y_j$ and the observed velocity\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right),\n$$\nwhere $A$ controls the amplitude of boundary-layer-like oscillations and $\\beta$ controls their localization near $y=0$ and $y=1$.\n3. Compute the naive discrete gradient $D_j$ from $u_{\\text{obs}}$ using finite differences: $D_0 = (u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0))/h$, $D_{N-1} = (u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2}))/h$, and $D_j = (u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1}))/(2h)$ for $j = 1,\\dots,N-2$.\n4. Formulate the DEVSS-like stabilized gradient $G$ by solving the normal equations for the minimizer of $J(G)$ with $w_j = 1$ for all $j$. Show that the resulting linear system can be written as\n$$\n\\left(I + \\alpha Q\\right) G = D,\n$$\nwhere $I$ is the identity matrix and $Q$ is the symmetric positive semidefinite matrix arising from the discrete gradient penalty, with entries\n$Q_{jj} = \\begin{cases} 1, & j = 0,\\\\ 2, & 1 \\le j \\le N-2,\\\\ 1, & j = N-1, \\end{cases}$, and $Q_{j,j+1} = Q_{j+1,j} = -1 \\text{ for } 0 \\le j \\le N-2$,\nand scaled by $1/h^2$.\n5. Define the pointwise gradient errors $e_{\\text{naive}}(y_j) = D_j - S$ and $e_{\\text{stab}}(y_j) = G_j - S$. Quantify boundary localization of the error by the fraction\n$$\nR(e) = \\frac{\\sum_{j: y_j < \\delta \\text{ or } y_j > 1-\\delta} \\left|e(y_j)\\right|}{\\sum_{j=0}^{N-1} \\left|e(y_j)\\right|},\n$$\nwith the convention that $R(e) = 0$ if the denominator is zero. Here, $\\delta \\in (0,1/2)$ defines the width of the boundary layers.\n6. For each test case, compute the change in boundary error localization due to stabilization, $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$.\n\nAll quantities are nondimensional. Your program must implement the above steps and produce the results for the following test suite:\n- Test case $1$: $N = 101$, $S = 1$, $A = 0.1$, $\\beta = 8$, $\\alpha = 0.01$, $\\delta = 0.1$.\n- Test case $2$: $N = 101$, $S = 1$, $A = 0$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$.\n- Test case $3$: $N = 21$, $S = 1$, $A = 0.2$, $\\beta = 8$, $\\alpha = 0.05$, $\\delta = 0.1$.\n- Test case $4$: $N = 101$, $S = 1$, $A = 0.5$, $\\beta = 12$, $\\alpha = 0.1$, $\\delta = 0.1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry must be the float $\\Delta R$ for the corresponding test case, rounded to six decimal places, in the order of the test cases listed above (e.g., $[\\Delta R_1,\\Delta R_2,\\Delta R_3,\\Delta R_4]$). The output must be exactly one line with this format.\n\nExplain, in your solution, why the stabilization alters the localization of errors in $\\nabla \\mathbf{u}$ and how the DEVSS-like penalty redistributes and attenuates errors near boundaries compared to the naive finite difference gradient. Your explanation must be grounded in the above fundamental base and avoid shortcuts or pre-stated results beyond those definitions. Do not refer to any external files or data; everything must be computed within the program.",
            "solution": "The core of this problem is to analyze how a regularization technique, analogous to those used in DEVSS methods, alters the error characteristics of a numerically computed velocity gradient. The stabilization aims to mitigate spurious oscillations that can arise from noisy input data or numerical instabilities, which is a critical concern in simulations of viscoelastic flows where stresses are highly sensitive to velocity gradients.\n\nWe begin with a one-dimensional domain $y \\in [0, 1]$ discretized by $N$ uniformly spaced nodes $y_j = j h$ for $j = 0, 1, \\dots, N-1$, where the grid spacing is $h = 1/(N-1)$. The true velocity field is a linear shear flow, $u_{\\text{true}}(y) = S y$, for which the velocity gradient is a constant, $\\nabla \\mathbf{u} = \\partial u / \\partial y = S$.\n\nHowever, the computational process starts from an \"observed\" velocity field, $u_{\\text{obs}}(y_j)$, which includes boundary-layer-like oscillatory errors:\n$$\nu_{\\text{obs}}(y_j) = u_{\\text{true}}(y_j) + A\\left(\\sin(2\\pi y_j)\\,\\mathrm{e}^{-\\beta y_j} + \\sin\\left(2\\pi (1-y_j)\\right)\\,\\mathrm{e}^{-\\beta(1-y_j)}\\right)\n$$\nThe added term introduces high-frequency oscillations that are most prominent near the boundaries $y=0$ and $y=1$, decaying into the interior, controlled by the parameter $\\beta$.\n\nThe first step is to compute a \"naive\" velocity gradient, denoted by the vector $D$, using finite difference formulas on the grid of $u_{\\text{obs}}$ values. Due to the local nature of differentiation, these operators are known to amplify high-frequency noise. Using one-sided differences at the boundaries and a central difference in the interior, we compute:\n$$\n\\begin{align*}\nD_0 &= \\frac{u_{\\text{obs}}(y_1) - u_{\\text{obs}}(y_0)}{h} \\\\\nD_j &= \\frac{u_{\\text{obs}}(y_{j+1}) - u_{\\text{obs}}(y_{j-1})}{2h}, \\quad \\text{for } j = 1, \\dots, N-2 \\\\\nD_{N-1} &= \\frac{u_{\\text{obs}}(y_{N-1}) - u_{\\text{obs}}(y_{N-2})}{h}\n\\end{align*}\n$$\nThe error in this naive gradient is $e_{\\text{naive}, j} = D_j - S$. The oscillatory nature of the error in $u_{\\text{obs}}$, especially near the boundaries, will result in large, localized errors in $D$.\n\nTo mitigate these localized errors, a DEVSS-like stabilization is introduced. We seek a new, \"stabilized\" gradient field $G$ that is both close to the naive gradient $D$ and smoother than it. This is formulated as a variational problem: find the vector $G$ that minimizes the quadratic functional $J(G)$:\n$$\nJ(G) = \\sum_{j=0}^{N-1} \\left(G_j - D_j\\right)^2 + \\alpha \\sum_{j=0}^{N-2} \\left(\\frac{G_{j+1} - G_j}{h}\\right)^2\n$$\nHere, the first term enforces fidelity to the original gradient data $D$. The second term is a regularization penalty that penalizes roughness in the solution $G$. The term $(G_{j+1} - G_j)/h$ is a finite difference approximation of the derivative of $G$, so this penalty term is an approximation of $\\int (\\partial G/\\partial y)^2 dy$. Minimizing this term promotes a smoother gradient field $G$. The parameter $\\alpha \\geq 0$ controls the strength of this smoothing.\n\nTo find the minimizer $G$, we take the derivative of $J(G)$ with respect to each component $G_k$ and set it to zero, $\\partial J / \\partial G_k = 0$ for $k = 0, 1, \\dots, N-1$.\nFor an interior node $k \\in \\{1, \\dots, N-2\\}$:\n$$\n\\frac{\\partial J}{\\partial G_k} = 2(G_k - D_k) + \\frac{\\alpha}{h^2} \\left[ -2(G_{k+1}-G_k) + 2(G_k - G_{k-1}) \\right] = 0 \\\\\n$$\n$$\n\\implies (G_k - D_k) + \\frac{\\alpha}{h^2} (-G_{k-1} + 2G_k - G_{k+1}) = 0\n$$\nFor the boundary node $k=0$:\n$$\n\\frac{\\partial J}{\\partial G_0} = 2(G_0 - D_0) + \\frac{\\alpha}{h^2} \\left[ -2(G_1 - G_0) \\right] = 0 \\implies (G_0 - D_0) + \\frac{\\alpha}{h^2} (G_0 - G_1) = 0\n$$\nFor the boundary node $k=N-1$:\n$$\n\\frac{\\partial J}{\\partial G_{N-1}} = 2(G_{N-1} - D_{N-1}) + \\frac{\\alpha}{h^2} \\left[ 2(G_{N-1} - G_{N-2}) \\right] = 0 \\implies (G_{N-1} - D_{N-1}) + \\frac{\\alpha}{h^2} (G_{N-1} - G_{N-2}) = 0\n$$\nAssembling these $N$ linear equations into matrix form yields the system:\n$$\n\\left(I + \\frac{\\alpha}{h^2} K\\right) G = D\n$$\nwhere $I$ is the $N \\times N$ identity matrix, $G$ and $D$ are column vectors of size $N$, and $K$ is the $N \\times N$ symmetric matrix:\n$$\nK = \\begin{pmatrix}\n1 & -1 & & & \\\\\n-1 & 2 & -1 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & -1 & 2 & -1 \\\\\n& & & -1 & 1\n\\end{pmatrix}\n$$\nThis matrix $K$ is a discrete representation of the one-dimensional negative second-derivative operator, $-\\partial^2/\\partial y^2$, with Neumann (zero-flux) boundary conditions. The problem defines the matrix $Q = K/h^2$, which leads directly to the specified linear system $(I + \\alpha Q) G = D$.\n\nThe stabilized gradient is found by solving this system for $G$: $G = (I + \\alpha Q)^{-1} D$. The matrix operator $(I + \\alpha Q)^{-1}$ acts as a global low-pass filter. The matrix $Q$ has large eigenvalues for highly oscillatory eigenvectors (high-frequency modes). The inverse $(I + \\alpha Q)^{-1}$ therefore has small eigenvalues for these same modes, meaning it damps high-frequency components present in the input vector $D$.\n\nThe effect of this stabilization is a redistribution of error. The naive gradient error $e_{\\text{naive}}$ is spiky and localized because the finite difference operators are local. The stabilization process, being global due to the matrix inversion, takes these large, localized errors and smooths them out, distributing a smaller error magnitude across the entire domain. The error in the stabilized gradient, $e_{\\text{stab}} = G - S$, will thus be less concentrated at the boundaries.\n\nWe quantify this change in error localization using the ratio $R(e)$, which measures the fraction of the total absolute error contained within boundary layers of width $\\delta$. A decrease in this ratio indicates that the error has been \"delocalized\" or spread from the boundaries into the interior. The quantity to be computed, $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$, is therefore expected to be negative for cases with oscillatory error ($A \\neq 0$), signifying that stabilization successfully reduces the concentration of error near the boundaries. For the case where no error is introduced ($A=0$), $D_j=S$ for all $j$, leading to $e_{\\text{naive}}=\\mathbf{0}$ and $R(e_{\\text{naive}})=0$. The solution to $(I+\\alpha Q)G = S \\cdot \\mathbf{1}$ is $G=S \\cdot \\mathbf{1}$ because the constant vector is in the nullspace of $Q$. Thus, $e_{\\text{stab}}=\\mathbf{0}$, $R(e_{\\text{stab}})=0$, and $\\Delta R = 0$. This provides a crucial check for the correctness of the implementation.\n\nThe numerical procedure is as follows:\n1. For each test case, set up the grid and compute $u_{\\text{obs}}$.\n2. Compute the naive gradient vector $D$ using the specified finite difference stencils.\n3. Construct the matrix $Q$ and solve the linear system $(I + \\alpha Q) G = D$ to find the stabilized gradient $G$.\n4. Compute the error vectors $e_{\\text{naive}} = D - S$ and $e_{\\text{stab}} = G - S$.\n5. Calculate the localization ratios $R(e_{\\text{naive}})$ and $R(e_{\\text{stab}})$.\n6. Compute the change in localization $\\Delta R = R(e_{\\text{stab}}) - R(e_{\\text{naive}})$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main solver function to compute the change in error localization\n    for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, S, A, beta, alpha, delta)\n        (101, 1.0, 0.1, 8.0, 0.01, 0.1),\n        (101, 1.0, 0.0, 8.0, 0.05, 0.1),\n        (21, 1.0, 0.2, 8.0, 0.05, 0.1),\n        (101, 1.0, 0.5, 12.0, 0.1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, S, A, beta, alpha, delta = case\n        \n        # 1. Construct the grid\n        h = 1.0 / (N - 1)\n        y = np.linspace(0.0, 1.0, N)\n        \n        # 2. Define true and observed velocities\n        u_true = S * y\n        noise = A * (np.sin(2 * np.pi * y) * np.exp(-beta * y) + \n                     np.sin(2 * np.pi * (1 - y)) * np.exp(-beta * (1 - y)))\n        u_obs = u_true + noise\n        \n        # 3. Compute the naive discrete gradient D\n        D = np.zeros(N)\n        D[0] = (u_obs[1] - u_obs[0]) / h\n        D[N-1] = (u_obs[N-1] - u_obs[N-2]) / h\n        D[1:N-1] = (u_obs[2:] - u_obs[0:-2]) / (2 * h)\n        \n        # 4. Formulate and solve for the stabilized gradient G\n        # Construct the matrix K (unscaled Q)\n        diag_main = np.full(N, 2.0)\n        diag_main[0] = 1.0\n        diag_main[-1] = 1.0\n        diag_off = np.full(N - 1, -1.0)\n        K = np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1)\n        \n        # Scale K by 1/h^2 to get Q\n        Q = K / (h**2)\n        \n        # Construct the system matrix M = (I + alpha*Q)\n        M = np.eye(N) + alpha * Q\n        \n        # Solve MG = D for G\n        G = np.linalg.solve(M, D)\n        \n        # 5. Define pointwise errors and quantify boundary localization\n        e_naive = D - S\n        e_stab = G - S\n        \n        def calculate_R(e, y_grid, delta_val):\n            \"\"\"\n            Computes the error localization ratio R(e).\n            \"\"\"\n            total_abs_error = np.sum(np.abs(e))\n            if total_abs_error == 0.0:\n                return 0.0\n            \n            boundary_mask = (y_grid  delta_val) | (y_grid > 1 - delta_val)\n            boundary_abs_error = np.sum(np.abs(e[boundary_mask]))\n            \n            return boundary_abs_error / total_abs_error\n\n        R_naive = calculate_R(e_naive, y, delta)\n        R_stab = calculate_R(e_stab, y, delta)\n\n        # 6. Compute the change in boundary error localization\n        delta_R = R_stab - R_naive\n        results.append(delta_R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having analyzed the mathematical mechanism of SUPG and visualized the smoothing effect of DEVSS-like methods, we now address the practical challenge of selecting the right amount of stabilization. This culminating practice simulates the real-world engineering task of tuning stabilization parameters . You will test various combinations of parameters against criteria measuring both numerical stability (via the Péclet number) and physical accuracy (via amplitude and phase errors), learning to navigate the critical trade-off between damping spurious oscillations and preserving the physical solution.",
            "id": "4103439",
            "problem": "Consider a one-dimensional periodic domain of length $L$ with uniform mesh size $h = L/N$, where $N$ is the number of elements. A single scalar component of the polymeric extra stress, denoted by $s(x)$, is modeled in steady state by the linearized advection-diffusion-reaction equation\n$$\nu \\frac{d s}{d x} - \\kappa \\frac{d^2 s}{d x^2} + \\beta s = f(x),\n$$\nwhere $u$ is the constant mean velocity, $\\kappa$ is the physical diffusivity of the stress, and $\\beta = 1/\\lambda$ is the relaxation rate (with $\\lambda$ the relaxation time). Assume a periodic forcing of the form $f(x) = \\sin(k x)$ for wavenumber $k$, and periodic boundary conditions on $s(x)$.\n\nThe classical Galerkin weak form for continuous linear finite elements is augmented with two stabilization mechanisms that are widely used for viscoelastic flows:\n- Streamline Upwind/Petrov-Galerkin (SUPG), characterized by a parameter $\\tau_m$, which adds a consistent term aligned with the streamline direction.\n- Discrete Elastic Viscous Stress Splitting (DEVSS), characterized here by a dimensionless parameter $\\tau_c$, modeled as a consistent least-squares term on the gradient in one dimension to suppress spurious oscillations associated with the rate-of-strain projection.\n\nUnder a Fourier mode analysis with trial/test functions proportional to $e^{i k x}$ on a uniform mesh, both stabilization terms act as effective diffusion contributions in the streamline direction. Specifically, SUPG contributes an amount proportional to $u^2 \\tau_m$, while the DEVSS-inspired gradient stabilization contributes an amount proportional to $\\tau_c \\kappa$. The resulting effective diffusion coefficient is\n$$\n\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa.\n$$\n\nFor a sinusoidal forcing $f(x) = \\sin(k x)$, the steady-state response amplitude and phase for the exact physical operator (with diffusion $\\kappa$) are determined by the Fourier symbol\n$$\nL_{\\text{phys}}(k) = \\beta + \\kappa k^2 + i u k,\n$$\nwhile for the stabilized operator they are given by\n$$\nL_{\\text{num}}(k) = \\beta + \\kappa_{\\text{eff}} k^2 + i u k.\n$$\nThe amplitude of the response relative to the forcing amplitude is $A(k) = 1/|L(k)|$, and the phase shift is $\\phi(k) = -\\arg(L(k)) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$ for the exact operator and $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$ for the stabilized operator.\n\nTo quantify the balance between damping and accuracy for a given mesh, define:\n- The mesh Péclet number based on the effective diffusion,\n$$\nPe_{\\text{eff}} = \\frac{u h}{2 \\kappa_{\\text{eff}}},\n$$\nwhich measures the relative strength of advection to diffusion at the mesh scale.\n- The amplitude ratio deviation at a resolved wavenumber $k_r$,\n$$\n\\Delta_A = \\left|\\frac{A_{\\text{num}}(k_r)}{A_{\\text{phys}}(k_r)} - 1\\right|,\n$$\nwhere $A_{\\text{phys}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa k^2)^2 + (u k)^2}}$ and $A_{\\text{num}}(k) = \\frac{1}{\\sqrt{(\\beta + \\kappa_{\\text{eff}} k^2)^2 + (u k)^2}}$.\n- The phase error at the same resolved wavenumber,\n$$\n\\Delta_\\phi = \\left|\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)\\right|,\n$$\nwith $\\phi_{\\text{phys}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa k^2}\\right)$ and $\\phi_{\\text{num}}(k) = -\\arctan\\!\\left(\\frac{u k}{\\beta + \\kappa_{\\text{eff}} k^2}\\right)$.\n\nA stabilized parameter pair $(\\tau_m, \\tau_c)$ is deemed to balance damping and accuracy for the given mesh if and only if the following three criteria are simultaneously satisfied:\n1. The mesh Péclet number satisfies $Pe_{\\text{eff}} \\in [Pe_{\\min}, Pe_{\\max}]$ with $Pe_{\\min} = 0.5$ and $Pe_{\\max} = 2.5$ (dimensionless).\n2. The amplitude ratio deviation at $k_r$ satisfies $\\Delta_A \\leq \\delta_A$ with $\\delta_A = 0.15$ (dimensionless).\n3. The phase error at $k_r$ satisfies $\\Delta_\\phi \\leq \\delta_\\phi$ with $\\delta_\\phi = 0.2$ radians.\n\nUse the following fixed physical and numerical parameters:\n- Domain length $L = 1.0$ meters, number of elements $N = 50$, so $h = L/N$ in meters.\n- Mean velocity $u = 1.0$ meters per second.\n- Physical diffusivity $\\kappa = 10^{-3}$ square meters per second.\n- Relaxation time $\\lambda = 0.5$ seconds, so $\\beta = 1/\\lambda = 2.0$ per second.\n- Resolved wavenumber $k_r = 2\\pi \\cdot 2$ radians per meter.\n\nAll angle quantities must be computed in radians, and all physical quantities must be used in their stated units.\n\nTest suite of parameter pairs $(\\tau_m, \\tau_c)$ to be evaluated:\n- Case 1: $(0.0, 0.0)$ where $\\tau_m$ is in seconds and $\\tau_c$ is dimensionless.\n- Case 2: $(0.01, 0.1)$.\n- Case 3: $(0.02, 0.0)$.\n- Case 4: $(0.005, 0.5)$.\n- Case 5: $(0.05, 2.0)$.\n- Case 6: $(0.01, 1.0)$.\n- Case 7: $(0.001, 0.0)$.\n- Case 8: $(0.002, 3.0)$.\n\nYour program must evaluate the three criteria for each test case and output a boolean indicating whether the given $(\\tau_m, \\tau_c)$ pair balances damping and accuracy. The final output must be a single line containing the results as a comma-separated list enclosed in square brackets, for example, \"[True,False,True]\".",
            "solution": "The objective is to determine for a set of given stabilization parameter pairs, $(\\tau_m, \\tau_c)$, whether they provide a satisfactory balance between numerical damping and physical accuracy. This balance is defined by three simultaneous criteria applied at a specific spatial wavenumber.\n\nFirst, we establish the fixed physical and numerical constants for the problem.\nThe domain length is $L = 1.0$ m, and the number of elements is $N = 50$, which defines a uniform mesh size of $h = L/N = 1.0/50 = 0.02$ m.\nThe physical parameters are the mean velocity $u = 1.0$ m/s, the physical diffusivity $\\kappa = 10^{-3}$ m²/s, and the relaxation time $\\lambda = 0.5$ s. The relaxation rate is derived as $\\beta = 1/\\lambda = 1/0.5 = 2.0$ s⁻¹.\nThe analysis is performed at a resolved wavenumber $k_r = 2\\pi \\cdot 2 = 4\\pi$ rad/m.\n\nThe criteria for a balanced parameter set are:\n1.  The effective mesh Péclet number $Pe_{\\text{eff}} = \\frac{u h}{2 \\kappa_{\\text{eff}}}$ must lie in the interval $[Pe_{\\min}, Pe_{\\max}]$, where $Pe_{\\min} = 0.5$ and $Pe_{\\max} = 2.5$.\n2.  The amplitude ratio deviation $\\Delta_A = \\left|\\frac{A_{\\text{num}}(k_r)}{A_{\\text{phys}}(k_r)} - 1\\right|$ must not exceed $\\delta_A = 0.15$.\n3.  The phase error $\\Delta_\\phi = |\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)|$ must not exceed $\\delta_\\phi = 0.2$ radians.\n\nThe effective diffusion coefficient, $\\kappa_{\\text{eff}}$, is a function of the stabilization parameters $(\\tau_m, \\tau_c)$ and is given by $\\kappa_{\\text{eff}} = \\kappa + u^2 \\tau_m + \\tau_c \\kappa$.\n\nLet us first compute the quantities related to the physical (exact) operator, which remain constant across all test cases.\nThe square of the wavenumber is $k_r^2 = (4\\pi)^2 = 16\\pi^2$ rad²/m².\nThe response of the physical system is governed by the denominator of the amplitude function, $A_{\\text{phys}}$, and the argument of the arctangent in the phase function, $\\phi_{\\text{phys}}$.\nThe real part of the physical Fourier symbol denominator is $D_{R, \\text{phys}} = \\beta + \\kappa k_r^2 = 2.0 + 10^{-3} \\cdot 16\\pi^2$.\nThe imaginary part is $D_{I, \\text{phys}} = u k_r = 1.0 \\cdot 4\\pi = 4\\pi$.\nThe squared magnitude of the Fourier symbol is $|L_{\\text{phys}}(k_r)|^2 = (\\beta + \\kappa k_r^2)^2 + (u k_r)^2$.\nThe physical phase is $\\phi_{\\text{phys}}(k_r) = -\\arctan\\left(\\frac{u k_r}{\\beta + \\kappa k_r^2}\\right)$.\n\nWe now evaluate each test case for the pair $(\\tau_m, \\tau_c)$.\n\n**Case 1: $(\\tau_m, \\tau_c) = (0.0, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = \\kappa + 1^2 \\cdot 0.0 + 0.0 \\cdot \\kappa = \\kappa = 10^{-3}$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 10^{-3}} = 10.0$.\n    This value is not in the range $[0.5, 2.5]$. The first criterion is not met.\n    **Result: False.**\n\n**Case 2: $(\\tau_m, \\tau_c) = (0.01, 0.1)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.01 + 0.1 \\cdot 10^{-3} = 0.001 + 0.01 + 0.0001 = 0.0111$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0111} \\approx 0.9009$. This is in $[0.5, 2.5]$. Criterion 1 is satisfied.\n3.  $|L_{\\text{num}}(k_r)|^2 = (\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2$. The ratio $A_{\\text{num}}/A_{\\text{phys}} = |L_{\\text{phys}}|/|L_{\\text{num}}|$.\n    $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.0111 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0278$.\n    This is less than $\\delta_A = 0.15$. Criterion 2 is satisfied.\n4.  $\\phi_{\\text{phys}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 10^{-3} \\cdot 16\\pi^2}\\right) \\approx -1.4013$ rad.\n    $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.0111 \\cdot 16\\pi^2}\\right) \\approx -1.2809$ rad.\n    $\\Delta_\\phi = |\\phi_{\\text{num}}(k_r) - \\phi_{\\text{phys}}(k_r)| \\approx |-1.2809 - (-1.4013)| \\approx 0.1204$ rad.\n    This is less than $\\delta_\\phi = 0.2$. Criterion 3 is satisfied.\n    All three criteria are met. **Result: True.**\n\n**Case 3: $(\\tau_m, \\tau_c) = (0.02, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.02 + 0.0 \\cdot 10^{-3} = 0.021$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.021} \\approx 0.4762$.\n    This value is not in the range $[0.5, 2.5]$. The first criterion is not met.\n    **Result: False.**\n\n**Case 4: $(\\tau_m, \\tau_c) = (0.005, 0.5)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.005 + 0.5 \\cdot 10^{-3} = 0.001 + 0.005 + 0.0005 = 0.0065$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.0065} \\approx 1.5385$. This is in $[0.5, 2.5]$. Criterion 1 is satisfied.\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.0065 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0136$.\n    This is less than $\\delta_A = 0.15$. Criterion 2 is satisfied.\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.0065 \\cdot 16\\pi^2}\\right) \\approx -1.3341$ rad.\n    $\\Delta_\\phi = |-1.3341 - (-1.4013)| \\approx 0.0672$ rad.\n    This is less than $\\delta_\\phi = 0.2$. Criterion 3 is satisfied.\n    All three criteria are met. **Result: True.**\n\n**Case 5: $(\\tau_m, \\tau_c) = (0.05, 2.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.05 + 2.0 \\cdot 10^{-3} = 0.001 + 0.05 + 0.002 = 0.053$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.053} \\approx 0.1887$.\n    This value is not in the range $[0.5, 2.5]$. The first criterion is not met.\n    **Result: False.**\n\n**Case 6: $(\\tau_m, \\tau_c) = (0.01, 1.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.01 + 1.0 \\cdot 10^{-3} = 0.001 + 0.01 + 0.001 = 0.012$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.012} \\approx 0.8333$. This is in $[0.5, 2.5]$. Criterion 1 is satisfied.\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.012 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0309$.\n    This is less than $\\delta_A = 0.15$. Criterion 2 is satisfied.\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.012 \\cdot 16\\pi^2}\\right) \\approx -1.2707$ rad.\n    $\\Delta_\\phi = |-1.2707 - (-1.4013)| \\approx 0.1306$ rad.\n    This is less than $\\delta_\\phi = 0.2$. Criterion 3 is satisfied.\n    All three criteria are met. **Result: True.**\n\n**Case 7: $(\\tau_m, \\tau_c) = (0.001, 0.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.001 + 0.0 \\cdot 10^{-3} = 0.002$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.002} = 5.0$.\n    This value is not in the range $[0.5, 2.5]$. The first criterion is not met.\n    **Result: False.**\n\n**Case 8: $(\\tau_m, \\tau_c) = (0.002, 3.0)$**\n1.  $\\kappa_{\\text{eff}} = 10^{-3} + 1^2 \\cdot 0.002 + 3.0 \\cdot 10^{-3} = 0.001 + 0.002 + 0.003 = 0.006$ m²/s.\n2.  $Pe_{\\text{eff}} = \\frac{1.0 \\cdot 0.02}{2 \\cdot 0.006} \\approx 1.6667$. This is in $[0.5, 2.5]$. Criterion 1 is satisfied.\n3.  $\\Delta_A = \\left| \\sqrt{\\frac{(\\beta + \\kappa k_r^2)^2 + (u k_r)^2}{(\\beta + \\kappa_{\\text{eff}} k_r^2)^2 + (u k_r)^2}} - 1 \\right| \\approx \\left| \\sqrt{\\frac{(2.0 + 10^{-3} \\cdot 16\\pi^2)^2 + (4\\pi)^2}{(2.0 + 0.006 \\cdot 16\\pi^2)^2 + (4\\pi)^2}} - 1 \\right| \\approx 0.0122$.\n    This is less than $\\delta_A = 0.15$. Criterion 2 is satisfied.\n4.  $\\phi_{\\text{num}}(k_r) = -\\arctan\\left(\\frac{4\\pi}{2.0 + 0.006 \\cdot 16\\pi^2}\\right) \\approx -1.3395$ rad.\n    $\\Delta_\\phi = |-1.3395 - (-1.4013)| \\approx 0.0618$ rad.\n    This is less than $\\delta_\\phi = 0.2$. Criterion 3 is satisfied.\n    All three criteria are met. **Result: True.**\n\nSummary of results:\n- Case 1: False\n- Case 2: True\n- Case 3: False\n- Case 4: True\n- Case 5: False\n- Case 6: True\n- Case 7: False\n- Case 8: True\nThe final sequence of boolean values is [False, True, False, True, False, True, False, True].",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates stabilization parameter pairs against three criteria for balancing\n    damping and accuracy in a model viscoelastic flow problem.\n    \"\"\"\n    # Define fixed physical and numerical parameters\n    L = 1.0  # Domain length (m)\n    N = 50   # Number of elements\n    u = 1.0  # Mean velocity (m/s)\n    kappa = 1e-3  # Physical diffusivity (m^2/s)\n    lambda_relax = 0.5  # Relaxation time (s)\n    k_r = 2 * np.pi * 2  # Resolved wavenumber (rad/m)\n\n    # Define criteria thresholds\n    Pe_min = 0.5\n    Pe_max = 2.5\n    delta_A_max = 0.15\n    delta_phi_max = 0.2  # radians\n\n    # Derived constants\n    h = L / N  # Mesh size (m)\n    beta = 1.0 / lambda_relax  # Relaxation rate (1/s)\n\n    # Test suite of parameter pairs (tau_m, tau_c)\n    test_cases = [\n        (0.0, 0.0),    # Case 1\n        (0.01, 0.1),   # Case 2\n        (0.02, 0.0),   # Case 3\n        (0.005, 0.5),  # Case 4\n        (0.05, 2.0),   # Case 5\n        (0.01, 1.0),   # Case 6\n        (0.001, 0.0),  # Case 7\n        (0.002, 3.0),  # Case 8\n    ]\n\n    results = []\n\n    # Pre-calculate physical system quantities (constant for all cases)\n    k_r_sq = k_r**2\n    u_k_r = u * k_r\n    \n    # Denominator parts for physical operator\n    denom_real_phys = beta + kappa * k_r_sq\n    denom_imag_phys = u_k_r\n    L_mag_sq_phys = denom_real_phys**2 + denom_imag_phys**2\n    phi_phys = -np.arctan2(denom_imag_phys, denom_real_phys)\n\n    for tau_m, tau_c in test_cases:\n        # Step 1: Calculate effective diffusion and check Péclet number criterion\n        kappa_eff = kappa + u**2 * tau_m + tau_c * kappa\n        Pe_eff = (u * h) / (2 * kappa_eff)\n        \n        crit1_passed = (Pe_min = Pe_eff = Pe_max)\n\n        # If the first criterion fails, the case is invalid, but for completeness\n        # we calculate all values. The final boolean logic will handle it.\n        \n        # Step 2: Calculate amplitude ratio deviation\n        denom_real_num = beta + kappa_eff * k_r_sq\n        denom_imag_num = u_k_r\n        L_mag_sq_num = denom_real_num**2 + denom_imag_num**2\n        \n        # A_num / A_phys = |L_phys| / |L_num| = sqrt(L_mag_sq_phys / L_mag_sq_num)\n        amp_ratio = np.sqrt(L_mag_sq_phys / L_mag_sq_num)\n        delta_A = np.abs(amp_ratio - 1)\n        \n        crit2_passed = (delta_A = delta_A_max)\n\n        # Step 3: Calculate phase error\n        phi_num = -np.arctan2(denom_imag_num, denom_real_num)\n        delta_phi = np.abs(phi_num - phi_phys)\n        \n        crit3_passed = (delta_phi = delta_phi_max)\n\n        # A pair is balanced if and only if all three criteria are met\n        is_balanced = crit1_passed and crit2_passed and crit3_passed\n        results.append(is_balanced)\n\n    # Format the final output as a comma-separated list of booleans\n    # The map(str, ...) is required to convert boolean True/False to string \"True\"/\"False\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}