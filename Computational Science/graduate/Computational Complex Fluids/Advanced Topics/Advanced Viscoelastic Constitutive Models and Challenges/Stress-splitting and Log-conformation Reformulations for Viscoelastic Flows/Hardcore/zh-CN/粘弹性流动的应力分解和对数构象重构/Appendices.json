{
    "hands_on_practices": [
        {
            "introduction": "对数构象法的基石是计算构象张量的矩阵对数，该张量必须是对称正定的（SPD）。本练习将通过谱定理让您亲手实践这一核心数学运算。通过为一个通用的 $2 \\times 2$ SPD张量推导矩阵对数的显式形式，并验证矩阵指数是其逆运算，您将巩固对这一先进数值技术中所用关键工具的理解 。",
            "id": "4104865",
            "problem": "在计算复杂流体中，对数构象重构法引入了构象张量的对数，以提高粘弹性流体计算中的数值鲁棒性。设 $\\boldsymbol{C} \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定（SPD）构象张量，其特征值为 $\\lambda_{1}  0$ 和 $\\lambda_{2}  0$，标准正交特征向量构成一个角度为 $\\theta$（弧度）的旋转。定义对数构象变量 $\\boldsymbol{\\Psi}$ 为 $\\boldsymbol{C}$ 的主矩阵对数，即 $\\boldsymbol{\\Psi} = \\log \\boldsymbol{C}$，并考虑主矩阵指数 $\\exp \\boldsymbol{\\Psi}$。\n\n仅从实对称矩阵的谱定理和通过泛函演算（即在标准正交特征基中将标量函数应用于谱）定义的矩阵函数出发，完成以下任务：\n\n1. 当 $\\boldsymbol{A}$ 是一个 $2 \\times 2$ SPD 张量，其特征值为 $\\lambda_{1}$ 和 $\\lambda_{2}$，特征向量构成一个角度为 $\\theta$ 的旋转时，推导 $\\log \\boldsymbol{A}$ 和 $\\exp \\boldsymbol{\\Psi}$ 的显式表达式。用 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\theta$ 表示你的结果。\n\n2. 针对 $\\lambda_{1} = 3$、$\\lambda_{2} = \\tfrac{1}{2}$ 和 $\\theta = \\tfrac{\\pi}{6}$（弧度）的具体情况。显式计算此情况下的 $\\log \\boldsymbol{C}$ 和 $\\exp \\boldsymbol{\\Psi}$，并通过计算差值的弗罗贝尼乌斯范数来验证其一致性：\n$$\n\\left\\| \\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{C} \\right\\|_{F}.\n$$\n\n提供 $\\left\\| \\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{C} \\right\\|_{F}$ 的最终值作为你的答案。答案需为精确值（不要四舍五入）。",
            "solution": "问题陈述经确认为具有科学依据、适定、客观且完整。这是一个应用于连续介质力学的标准线性代数问题，具体涉及粘弹性流体的对数构象重构法。所有需要的数据和定义均已提供。我们可以开始求解。\n\n该问题要求基于谱定理和通过泛函演算定义的矩阵函数概念进行推导和计算。\n\n设 $\\boldsymbol{A}$ 是一个 $2 \\times 2$ 的实对称正定（SPD）矩阵。谱定理指出，$\\boldsymbol{A}$ 可以被一个正交矩阵对角化：\n$$\n\\boldsymbol{A} = \\boldsymbol{Q} \\boldsymbol{\\Lambda} \\boldsymbol{Q}^\\top\n$$\n其中 $\\boldsymbol{\\Lambda}$ 是特征值的对角矩阵，$\\boldsymbol{Q}$ 的列是相应的标准正交特征向量。由于 $\\boldsymbol{A}$ 是 SPD 矩阵，其特征值 $\\lambda_1, \\lambda_2$ 是实数且为正。特征向量矩阵 $\\boldsymbol{Q}$ 是正交的，即 $\\boldsymbol{Q}^\\top\\boldsymbol{Q} = \\boldsymbol{Q}\\boldsymbol{Q}^\\top = \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位矩阵。\n\n问题指出标准正交特征向量构成一个角度为 $\\theta$ 的旋转。因此，$\\boldsymbol{Q}$ 是旋转矩阵 $\\boldsymbol{R}(\\theta)$：\n$$\n\\boldsymbol{Q} = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n特征值矩阵为：\n$$\n\\boldsymbol{\\Lambda} = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix}\n$$\n矩阵函数 $f(\\boldsymbol{A})$ 通过将标量函数 $f$ 应用于特征值来定义：\n$$\nf(\\boldsymbol{A}) = \\boldsymbol{Q} f(\\boldsymbol{\\Lambda}) \\boldsymbol{Q}^\\top = \\boldsymbol{Q} \\begin{pmatrix} f(\\lambda_1)  0 \\\\ 0  f(\\lambda_2) \\end{pmatrix} \\boldsymbol{Q}^\\top\n$$\n\n**1. 一般推导**\n\n首先，我们推导 $\\log \\boldsymbol{A}$ 的显式表达式。我们设 $f(x) = \\ln(x)$。\n$$\n\\log \\boldsymbol{A} = \\boldsymbol{Q} (\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^\\top = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} \\ln(\\lambda_1)  0 \\\\ 0  \\ln(\\lambda_2) \\end{pmatrix} \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix} \\ln(\\lambda_1)\\cos\\theta  -\\ln(\\lambda_2)\\sin\\theta \\\\ \\ln(\\lambda_1)\\sin\\theta  \\ln(\\lambda_2)\\cos\\theta \\end{pmatrix} \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix} \\ln(\\lambda_1)\\cos^2\\theta + \\ln(\\lambda_2)\\sin^2\\theta  (\\ln(\\lambda_1)-\\ln(\\lambda_2))\\sin\\theta\\cos\\theta \\\\ (\\ln(\\lambda_1)-\\ln(\\lambda_2))\\sin\\theta\\cos\\theta  \\ln(\\lambda_1)\\sin^2\\theta + \\ln(\\lambda_2)\\cos^2\\theta \\end{pmatrix}\n$$\n使用三角恒等式 $\\cos^2\\theta = \\frac{1}{2}(1+\\cos(2\\theta))$、$\\sin^2\\theta = \\frac{1}{2}(1-\\cos(2\\theta))$ 和 $\\sin\\theta\\cos\\theta = \\frac{1}{2}\\sin(2\\theta)$，我们可以将其写得更紧凑：\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix}\n\\frac{\\ln(\\lambda_1)+\\ln(\\lambda_2)}{2} + \\frac{\\ln(\\lambda_1)-\\ln(\\lambda_2)}{2}\\cos(2\\theta)  \\frac{\\ln(\\lambda_1)-\\ln(\\lambda_2)}{2}\\sin(2\\theta) \\\\\n\\frac{\\ln(\\lambda_1)-\\ln(\\lambda_2)}{2}\\sin(2\\theta)  \\frac{\\ln(\\lambda_1)+\\ln(\\lambda_2)}{2} - \\frac{\\ln(\\lambda_1)-\\ln(\\lambda_2)}{2}\\cos(2\\theta)\n\\end{pmatrix}\n$$\n使用对数性质 $\\ln(a)+\\ln(b) = \\ln(ab)$ 和 $\\ln(a)-\\ln(b) = \\ln(a/b)$，我们得到：\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix}\n\\frac{1}{2}\\ln(\\lambda_1\\lambda_2) + \\frac{1}{2}\\ln(\\lambda_1/\\lambda_2)\\cos(2\\theta)  \\frac{1}{2}\\ln(\\lambda_1/\\lambda_2)\\sin(2\\theta) \\\\\n\\frac{1}{2}\\ln(\\lambda_1/\\lambda_2)\\sin(2\\theta)  \\frac{1}{2}\\ln(\\lambda_1\\lambda_2) - \\frac{1}{2}\\ln(\\lambda_1/\\lambda_2)\\cos(2\\theta)\n\\end{pmatrix}\n$$\n接下来，我们推导 $\\exp \\boldsymbol{\\Psi}$ 的显式表达式，其中 $\\boldsymbol{\\Psi} = \\log \\boldsymbol{A}$。我们将矩阵指数函数 $g(x)=\\exp(x)$ 应用于 $\\boldsymbol{\\Psi}$。\n$\\boldsymbol{\\Psi}$ 的谱分解为 $\\boldsymbol{\\Psi} = \\boldsymbol{Q} (\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^\\top$。$\\boldsymbol{\\Psi}$ 的特征值是 $\\ln(\\lambda_1)$ 和 $\\ln(\\lambda_2)$。\n$$\n\\exp \\boldsymbol{\\Psi} = \\exp(\\log \\boldsymbol{A}) = \\boldsymbol{Q} \\exp(\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^\\top\n$$\n对数特征值对角矩阵的指数是：\n$$\n\\exp(\\log \\boldsymbol{\\Lambda}) = \\begin{pmatrix} \\exp(\\ln \\lambda_1)  0 \\\\ 0  \\exp(\\ln \\lambda_2) \\end{pmatrix} = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix} = \\boldsymbol{\\Lambda}\n$$\n将此代回，我们发现：\n$$\n\\exp \\boldsymbol{\\Psi} = \\boldsymbol{Q} \\boldsymbol{\\Lambda} \\boldsymbol{Q}^\\top = \\boldsymbol{A}\n$$\n因此，$\\exp \\boldsymbol{\\Psi}$ 的表达式就是 $\\boldsymbol{A}$ 本身的表达式，用 $\\lambda_1, \\lambda_2, \\theta$ 表示。这可以通过在最初推导的 $\\log \\boldsymbol{A}$ 的形式中将 $\\ln(\\lambda_i)$ 替换为 $\\lambda_i$ 来获得：\n$$\n\\exp \\boldsymbol{\\Psi} = \\begin{pmatrix} \\lambda_1\\cos^2\\theta + \\lambda_2\\sin^2\\theta  (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta \\\\ (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta  \\lambda_1\\sin^2\\theta + \\lambda_2\\cos^2\\theta \\end{pmatrix}\n$$\n\n**2. 具体案例计算与验证**\n\n给定 $\\lambda_1 = 3$，$\\lambda_2 = \\frac{1}{2}$ 和 $\\theta = \\frac{\\pi}{6}$。\n首先，我们计算所需的三角函数值：\n$\\cos(\\frac{\\pi}{6}) = \\frac{\\sqrt{3}}{2}$ 和 $\\sin(\\frac{\\pi}{6}) = \\frac{1}{2}$。\n$\\cos^2(\\frac{\\pi}{6}) = \\frac{3}{4}$ 和 $\\sin^2(\\frac{\\pi}{6}) = \\frac{1}{4}$。\n\n现在，我们计算这些值对应的显式矩阵 $\\boldsymbol{C}$。\n$$\nC_{11} = \\lambda_1\\cos^2\\theta + \\lambda_2\\sin^2\\theta = 3\\left(\\frac{3}{4}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{9}{4} + \\frac{1}{8} = \\frac{18+1}{8} = \\frac{19}{8}\n$$\n$$\nC_{22} = \\lambda_1\\sin^2\\theta + \\lambda_2\\cos^2\\theta = 3\\left(\\frac{1}{4}\\right) + \\frac{1}{2}\\left(\\frac{3}{4}\\right) = \\frac{3}{4} + \\frac{3}{8} = \\frac{6+3}{8} = \\frac{9}{8}\n$$\n$$\nC_{12} = C_{21} = (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta = \\left(3-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right) = \\left(\\frac{5}{2}\\right)\\frac{\\sqrt{3}}{4} = \\frac{5\\sqrt{3}}{8}\n$$\n所以，矩阵 $\\boldsymbol{C}$ 是：\n$$\n\\boldsymbol{C} = \\frac{1}{8}\\begin{pmatrix} 19  5\\sqrt{3} \\\\ 5\\sqrt{3}  9 \\end{pmatrix}\n$$\n接下来，我们计算 $\\boldsymbol{\\Psi} = \\log \\boldsymbol{C}$。$\\boldsymbol{\\Psi}$ 的特征值是 $\\ln(\\lambda_1) = \\ln(3)$ 和 $\\ln(\\lambda_2) = \\ln(\\frac{1}{2}) = -\\ln(2)$。\n$$\n\\Psi_{11} = \\ln(3)\\cos^2\\theta + \\ln(1/2)\\sin^2\\theta = \\ln(3)\\left(\\frac{3}{4}\\right) - \\ln(2)\\left(\\frac{1}{4}\\right) = \\frac{3\\ln(3) - \\ln(2)}{4} = \\frac{\\ln(27) - \\ln(2)}{4} = \\frac{\\ln(27/2)}{4}\n$$\n$$\n\\Psi_{22} = \\ln(3)\\sin^2\\theta + \\ln(1/2)\\cos^2\\theta = \\ln(3)\\left(\\frac{1}{4}\\right) - \\ln(2)\\left(\\frac{3}{4}\\right) = \\frac{\\ln(3) - 3\\ln(2)}{4} = \\frac{\\ln(3) - \\ln(8)}{4} = \\frac{\\ln(3/8)}{4}\n$$\n$$\n\\Psi_{12} = \\Psi_{21} = (\\ln(3)-\\ln(1/2))\\sin\\theta\\cos\\theta = (\\ln(3)-(-\\ln(2)))\\frac{\\sqrt{3}}{4} = \\frac{(\\ln(3)+\\ln(2))\\sqrt{3}}{4} = \\frac{\\sqrt{3}\\ln(6)}{4}\n$$\n所以，矩阵 $\\boldsymbol{\\Psi}$ 是：\n$$\n\\boldsymbol{\\Psi} = \\frac{1}{4}\\begin{pmatrix} \\ln(27/2)  \\sqrt{3}\\ln(6) \\\\ \\sqrt{3}\\ln(6)  \\ln(3/8) \\end{pmatrix}\n$$\n根据一般推导，$\\exp(\\boldsymbol{\\Psi}) = \\exp(\\log \\boldsymbol{C}) = \\boldsymbol{C}$。因此，矩阵 $\\exp \\boldsymbol{\\Psi}$ 与我们计算出的矩阵 $\\boldsymbol{C}$ 完全相同。\n$$\n\\exp \\boldsymbol{\\Psi} = \\boldsymbol{C} = \\frac{1}{8}\\begin{pmatrix} 19  5\\sqrt{3} \\\\ 5\\sqrt{3}  9 \\end{pmatrix}\n$$\n最后，我们计算差值 $\\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{C}$ 的弗罗贝尼乌斯范数。\n$$\n\\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{C} = \\boldsymbol{C} - \\boldsymbol{C} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} = \\boldsymbol{0}\n$$\n矩阵 $\\boldsymbol{X}$ 的弗罗贝尼乌斯范数为 $\\|\\boldsymbol{X}\\|_F = \\sqrt{\\sum_{i,j} |X_{ij}|^2}$。对于零矩阵，范数为：\n$$\n\\left\\| \\boldsymbol{0} \\right\\|_{F} = \\sqrt{0^2 + 0^2 + 0^2 + 0^2} = 0\n$$\n因此，一致性检验得出的值为 $0$，这与矩阵对数和指数函数的性质相符。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "为了高效求解控制粘弹性流动的复杂非线性方程组，像牛顿法这样的隐式数值格式是不可或缺的。实施此类求解器的关键步骤是对控制方程进行线性化，这需要计算所涉及的矩阵函数的Fréchet导数。本练习将指导您推导矩阵指数和矩阵对数的Fréchet导数，阐明它们在构建牛顿迭代所需的雅可比矩阵过程中的关键作用 。",
            "id": "4104782",
            "problem": "考虑 Oldroyd-B 型粘弹性流的应力分裂策略，其中总的额外应力被分解为牛顿溶剂贡献和源自构象张量的聚合物贡献。在对数构象公式中，构象张量表示为对称对数应变的矩阵指数，而牛顿类型求解器的线性化需要矩阵函数的 Fréchet 导数。从矩阵函数的 Fréchet 导数的定义和实对称矩阵的谱定理出发，推导对称矩阵上矩阵指数和矩阵对数的 Fréchet 导数的表达式。解释在离散化偏微分方程 (PDE) 系统的牛顿迭代中，这些导数在构建雅可比矩阵时如何用于对数构象公式中的聚合物应力的线性化。\n\n使用以下上下文作为推导的基础。令 $C \\in \\mathbb{R}^{n \\times n}$ 为一个对称正定（SPD）构象张量，令 $S = \\log(C)$ 表示其矩阵对数。在经典的 Oldroyd-B 模型中，聚合物额外应力可以写成 $\\tau_{p} = \\frac{\\eta_{p}}{\\lambda} \\left(C - I\\right)$，其中聚合物粘度 $\\eta_{p}  0$ 且松弛时间 $\\lambda  0$。而在对数构象重构法中，使用 $C = \\exp(S)$，相应的应力为 $\\tau_{p} = \\frac{\\eta_{p}}{\\lambda} \\left(\\exp(S) - I\\right)$。对离散残差中关于 $S$ 的牛顿线性化，需要 Fréchet 导数 $L_{\\exp}(S)[H]$ 在方向 $H$ 上的作用，而应用于运动学项的链式法则需要 $L_{\\log}(C)[H]$。\n\n从矩阵函数 $f$ 在实对称矩阵 $A$ 上沿方向 $H$ 的 Fréchet 导数 $L_{f}(A)[H]$ 的定义，以及谱定理（即 $A = Q \\Lambda Q^\\top$，其中 $Q$ 是正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_{i})$ 是对角矩阵）出发，推导 $L_{\\exp}(A)[H]$ 和 $L_{\\log}(A)[H]$ 的表达式，用 $A$ 的特征值和 $H$ 在 $A$ 的特征基下的分量来表示。你的推导必须从这些基础出发，不应引用任何预先给出的目标公式。\n\n最后，应用你的表达式计算标量\n$$\n\\Gamma = \\left\\langle R, L_{\\exp}(S)[H] \\right\\rangle_{F} + \\left\\langle Q, L_{\\log}(C)[H] \\right\\rangle_{F},\n$$\n其中 $\\langle \\cdot, \\cdot \\rangle_{F}$ 表示 Frobenius 内积。假设在二维设置下 $n = 2$，有 $C = \\mathrm{diag}(c_{1}, c_{2})$，$c_{1}  0$，$c_{2}  0$，$c_{1} \\neq c_{2}$，因此 $S = \\log(C) = \\mathrm{diag}\\left(\\ln(c_{1}), \\ln(c_{2})\\right)$。令 $H = \\begin{pmatrix} h_{11}  h_{12} \\\\ h_{12}  h_{22} \\end{pmatrix}$，$R = \\begin{pmatrix} r_{11}  r_{12} \\\\ r_{12}  r_{22} \\end{pmatrix}$，以及 $Q = \\begin{pmatrix} q_{11}  q_{12} \\\\ q_{12}  q_{22} \\end{pmatrix}$，均为对称矩阵。将最终的 $\\Gamma$ 表示为关于 $c_{1}$、$c_{2}$、$h_{11}$、$h_{12}$、$h_{22}$、$r_{11}$、$r_{12}$、$r_{22}$、$q_{11}$、$q_{12}$ 和 $q_{22}$ 的单个封闭形式解析表达式。无需进行数值计算。答案是无量纲的；不要包含物理单位。将你的最终答案作为一个单一的解析表达式提供。",
            "solution": "此问题被认为是有效的，因为它在科学上基于计算流体动力学和矩阵分析，问题设定良好、客观且内部一致。\n\n问题要求推导矩阵指数和对数的 Fréchet 导数，解释其用途，并进行具体计算。我们将分步进行。\n\n**第一部分：矩阵函数 Fréchet 导数的推导**\n\n矩阵函数 $f: \\mathbb{R}^{n \\times n} \\to \\mathbb{R}^{n \\times n}$ 在点 $A$ 处沿方向 $H$ 的 Fréchet 导数是一个线性映射 $L_f(A)[\\cdot]$，使得\n$$\nf(A+E) = f(A) + L_f(A)[E] + o(\\|E\\|)\n$$\n对于一个小的扰动 $E$ 成立。为了推导，我们考虑 Gateaux 导数，对于连续 Fréchet 可微的函数，它等价于 Fréchet 导数：\n$$\nL_f(A)[H] = \\lim_{\\epsilon \\to 0} \\frac{f(A + \\epsilon H) - f(A)}{\\epsilon} = \\left. \\frac{d}{dt} f(A+tH) \\right|_{t=0}\n$$\n我们考虑一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$。根据谱定理，$A$ 可以被对角化为 $A = Q \\Lambda Q^\\top$，其中 $Q$ 是一个正交矩阵（$Q Q^\\top = Q^\\top Q = I$），其列是 $A$ 的特征向量，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_n)$ 是相应实特征值构成的对角矩阵。矩阵函数 $f(A)$ 则定义为 $f(A) = Q f(\\Lambda) Q^\\top$，其中 $f(\\Lambda) = \\mathrm{diag}(f(\\lambda_1), \\dots, f(\\lambda_n))$。为简化推导，我们假设特征值 $\\lambda_i$ 是互不相同的，尽管最终公式通过取极限也适用于有重复特征值的情况。\n\n令 $A(t) = A + tH$。由于 $A$ 和 $H$ 是对称的，$A(t)$ 也是对称的。我们可以将其谱分解写为 $A(t) = Q(t) \\Lambda(t) Q(t)^\\top$。在 $t=0$ 时，我们有 $A(0)=A$，$Q(0)=Q$ 和 $\\Lambda(0)=\\Lambda$。我们希望求导的函数是 $f(A(t)) = Q(t) f(\\Lambda(t)) Q(t)^\\top$。使用关于 $t$ 的乘积法则进行微分：\n$$\n\\left. \\frac{d}{dt} f(A(t)) \\right|_{t=0} = \\dot{Q}(0) f(\\Lambda) Q^\\top + Q \\dot{f(\\Lambda)}(0) Q^\\top + Q f(\\Lambda) \\dot{Q}(0)^\\top\n$$\n其中点号表示对 $t$ 的微分。\n为了继续，我们需要来自标准矩阵微扰理论的特征值和特征向量的导数。令 $\\tilde{H} = Q^\\top H Q$ 为矩阵 $H$ 在 $A$ 的特征基下的表示。一阶微扰为：\n1. 特征值的导数：$\\dot{\\lambda}_i(0) = (Q^\\top \\dot{A}(0) Q)_{ii} = (Q^\\top H Q)_{ii} = \\tilde{H}_{ii}$。\n   这给出了 $f(\\Lambda(t))$ 的导数：$\\dot{f(\\Lambda)}(0) = \\mathrm{diag}(f'(\\lambda_i) \\dot{\\lambda}_i(0)) = \\mathrm{diag}(f'(\\lambda_i) \\tilde{H}_{ii})$。\n2. 特征向量的导数：矩阵 $\\dot{Q}(0)$ 与一个反对称矩阵有关。令 $\\tilde{S} = Q^\\top \\dot{Q}(0)$。由正交条件 $Q(t)^\\top Q(t)=I$ 微分得到 $\\dot{Q}^\\top Q + Q^\\top\\dot{Q} = 0$，因此 $\\tilde{S}^\\top = -\\tilde{S}$。根据微扰理论，对于 $i \\neq j$，$\\tilde{S}$ 的分量由下式给出：\n   $$\n   \\tilde{S}_{ij} = \\frac{(Q^\\top H Q)_{ij}}{\\lambda_j - \\lambda_i} = \\frac{\\tilde{H}_{ij}}{\\lambda_j - \\lambda_i}\n   $$\n   由于 $\\tilde{S}$ 是反对称的，$\\tilde{S}_{ii}=0$。\n\n现在，将这些代入 $L_f(A)[H]$ 的表达式中：\n$L_f(A)[H] = (Q \\tilde{S}) f(\\Lambda) Q^\\top + Q \\, \\mathrm{diag}(f'(\\lambda_i)\\tilde{H}_{ii}) \\, Q^\\top + Q f(\\Lambda) (Q \\tilde{S})^\\top$\n$L_f(A)[H] = Q \\left( \\tilde{S} f(\\Lambda) + \\mathrm{diag}(f'(\\lambda_i)\\tilde{H}_{ii}) + f(\\Lambda) \\tilde{S}^\\top \\right) Q^\\top$\n令 $\\tilde{L} = Q^\\top L_f(A)[H] Q$。由于 $\\tilde{S}^\\top = -\\tilde{S}$，我们有 $\\tilde{L} = \\tilde{S} f(\\Lambda) - f(\\Lambda) \\tilde{S} + \\mathrm{diag}(f'(\\lambda_i)\\tilde{H}_{ii})$。让我们求 $\\tilde{L}$ 的分量。\n\n对于对角线元素（$i=j$）：\n$\\tilde{L}_{ii} = (\\tilde{S}f(\\Lambda))_{ii} - (f(\\Lambda)\\tilde{S})_{ii} + f'(\\lambda_i)\\tilde{H}_{ii}$。\n$(\\tilde{S}f(\\Lambda))_{ii} = \\sum_k \\tilde{S}_{ik} f(\\Lambda)_{ki} = \\tilde{S}_{ii} f(\\lambda_i) = 0$。\n$(f(\\Lambda)\\tilde{S})_{ii} = \\sum_k f(\\Lambda)_{ik} \\tilde{S}_{ki} = f(\\lambda_i) \\tilde{S}_{ii} = 0$。\n因此，$\\tilde{L}_{ii} = f'(\\lambda_i) \\tilde{H}_{ii}$。\n\n对于非对角线元素（$i \\neq j$）：\n$\\tilde{L}_{ij} = (\\tilde{S}f(\\Lambda))_{ij} - (f(\\Lambda)\\tilde{S})_{ij} = \\sum_k \\tilde{S}_{ik} f(\\Lambda)_{kj} - \\sum_k f(\\Lambda)_{ik} \\tilde{S}_{kj}$。\n由于 $f(\\Lambda)$ 是对角矩阵，所以 $f(\\Lambda)_{kj} = f(\\lambda_j) \\delta_{kj}$ 且 $f(\\Lambda)_{ik} = f(\\lambda_i) \\delta_{ik}$。\n$\\tilde{L}_{ij} = \\tilde{S}_{ij} f(\\lambda_j) - f(\\lambda_i) \\tilde{S}_{ij} = (f(\\lambda_j) - f(\\lambda_i)) \\tilde{S}_{ij}$。\n代入 $\\tilde{S}_{ij} = \\frac{\\tilde{H}_{ij}}{\\lambda_j - \\lambda_i}$：\n$\\tilde{L}_{ij} = (f(\\lambda_j) - f(\\lambda_i)) \\frac{\\tilde{H}_{ij}}{\\lambda_j - \\lambda_i} = \\frac{f(\\lambda_i) - f(\\lambda_j)}{\\lambda_i - \\lambda_j} \\tilde{H}_{ij}$。\n\n项 $\\frac{f(\\lambda_i) - f(\\lambda_j)}{\\lambda_i - \\lambda_j}$ 是 $f$ 的一阶差商，记为 $f[\\lambda_i, \\lambda_j]$。如果 $\\lambda_i = \\lambda_j$，则定义为 $f'(\\lambda_i)$。\n所以，Fréchet 导数 $L_f(A)[H]$ 是通过将 $H$ 变换到 $A$ 的特征基，将其元素乘以 $A$ 特征值的差商，然后变换回原基底得到的矩阵：\n$$\nL_f(A)[H] = Q \\tilde{L} Q^\\top \\quad \\text{其中} \\quad \\tilde{L}_{ij} = f[\\lambda_i, \\lambda_j] \\tilde{H}_{ij} \\quad \\text{且} \\quad \\tilde{H} = Q^\\top H Q.\n$$\n\n**对矩阵指数和对数的特化**\n\n1.  **矩阵指数**：$f(x) = \\exp(x)$，所以 $f'(x) = \\exp(x)$。\n    差商为 $f[\\lambda_i, \\lambda_j] = \\frac{\\exp(\\lambda_i) - \\exp(\\lambda_j)}{\\lambda_i - \\lambda_j}$（对于 $\\lambda_i \\neq \\lambda_j$），以及 $f[\\lambda_i, \\lambda_i] = \\exp(\\lambda_i)$。\n    对于具有特征值 $s_i$ 和特征向量矩阵 $Q_S$ 的对称矩阵 $S$，令 $\\tilde{H} = Q_S^\\top H Q_S$。\n    Fréchet 导数 $L_{\\exp}(S)[H]$ 由 $Q_S \\tilde{L}_{\\exp} Q_S^\\top$ 给出，其中\n    $$\n    (\\tilde{L}_{\\exp})_{ij} =\n    \\begin{cases}\n    \\exp(s_i) \\tilde{H}_{ii}  i=j \\\\\n    \\frac{\\exp(s_i) - \\exp(s_j)}{s_i - s_j} \\tilde{H}_{ij}  i \\neq j\n    \\end{cases}\n    $$\n2.  **矩阵对数**：$f(x) = \\ln(x)$，所以 $f'(x) = 1/x$。这对所有特征值 $c_i$ 均为正的对称正定矩阵 $C$ 有定义。\n    差商为 $f[c_i, c_j] = \\frac{\\ln(c_i) - \\ln(c_j)}{c_i - c_j}$（对于 $c_i \\neq c_j$），以及 $f[c_i, c_i] = 1/c_i$。\n    对于具有特征值 $c_i$ 和特征向量矩阵 $Q_C$ 的对称正定矩阵 $C$，令 $\\tilde{H} = Q_C^\\top H Q_C$。\n    Fréchet 导数 $L_{\\log}(C)[H]$ 由 $Q_C \\tilde{L}_{\\log} Q_C^\\top$ 给出，其中\n    $$\n    (\\tilde{L}_{\\log})_{ij} =\n    \\begin{cases}\n    \\frac{1}{c_i} \\tilde{H}_{ii}  i=j \\\\\n    \\frac{\\ln(c_i) - \\ln(c_j)}{c_i - c_j} \\tilde{H}_{ij}  i \\neq j\n    \\end{cases}\n    $$\n\n**第二部分：在牛顿求解器线性化中的作用**\n\n在粘弹性流体的计算流体动力学中，控制方程构成一个耦合的非线性偏微分方程(PDE)组。对于对数构象方法，未知量通常是速度场 $\\mathbf{u}$、压力 $p$ 和构象张量的矩阵对数 $S = \\log(C)$。一个代表性的系统可以写成残差形式 $\\mathcal{R}(\\mathbf{U}) = 0$，其中 $\\mathbf{U} = (\\mathbf{u}, p, S)$ 是空间离散化后所有未知量的向量。\n\n通常使用 Newton-Raphson 方法来求解这个非线性系统。从一个估计值 $\\mathbf{U}_k$ 开始，通过求解线性系统来找到修正量 $\\delta \\mathbf{U}$：\n$$\nJ(\\mathbf{U}_k)[\\delta \\mathbf{U}] = - \\mathcal{R}(\\mathbf{U}_k)\n$$\n其中 $J(\\mathbf{U}_k)[\\cdot]$ 是在 $\\mathbf{U}_k$ 处计算的残差 $\\mathcal{R}$ 的雅可比矩阵（Fréchet 导数）。新的估计值是 $\\mathbf{U}_{k+1} = \\mathbf{U}_k + \\delta \\mathbf{U}$。\n\n残差 $\\mathcal{R}$ 包含涉及 $S$ 的矩阵函数的项。例如：\n-   聚合物应力通常由 $\\tau_p = \\frac{\\eta_p}{\\lambda}(\\exp(S) - I)$ 给出。它对动量方程残差的贡献必须关于 $S$ 的变化 $\\delta S$ 进行线性化。该线性化为 $\\frac{\\eta_p}{\\lambda} L_{\\exp}(S)[\\delta S]$。此项定义了雅可比矩阵中的一个块，该块将动量方程与对数构象演化方程耦合起来。\n-   $S$ 的演化方程是从 $C$ 的演化方程推导出来的，例如，上随体 Maxwell 模型 $\\overset{\\nabla}{C} = \\frac{1}{\\lambda}(I-C)$。使用链式法则，会出现诸如 $\\partial_t S = L_{\\log}(C)[\\partial_t C] = L_{\\log}(\\exp(S))[\\partial_t (\\exp(S))]$ 的项。更直接地，可以将链式法则应用于以 $S$ 表示的 $\\overset{\\nabla}{C}$ 表达式，这需要 $L_{\\exp}$ 及其逆 $L_{\\log}$。\n\n因此，Fréchet 导数 $L_{\\exp}$ 和 $L_{\\log}$ 是计算雅可比矩阵元素所需的精确数学工具，从而能够应用牛顿法求解对数构象粘弹性流体模型的强耦合非线性方程。\n\n**第三部分：$\\Gamma$ 的具体计算**\n\n我们需要计算 $\\Gamma = \\left\\langle R, L_{\\exp}(S)[H] \\right\\rangle_{F} + \\left\\langle Q, L_{\\log}(C)[H] \\right\\rangle_{F}$。\n给定的矩阵是：\n$C = \\mathrm{diag}(c_{1}, c_{2})$，所以其特征值为 $c_1, c_2$，特征向量矩阵为 $Q_C = I$。\n$S = \\log(C) = \\mathrm{diag}(\\ln(c_{1}), \\ln(c_2))$，所以其特征值为 $s_1 = \\ln(c_1), s_2 = \\ln(c_2)$，特征向量矩阵为 $Q_S = I$。\n扰动是 $H = \\begin{pmatrix} h_{11}  h_{12} \\\\ h_{12}  h_{22} \\end{pmatrix}$。\n\n由于特征向量矩阵都是单位矩阵，我们在这两种情况下都有 $\\tilde{H} = I^\\top H I = H$。Fréchet 导数直接由通用公式计算，无需变换。\n\n对于 $L_{\\exp}(S)[H]$：\n$S$ 的特征值为 $s_1 = \\ln(c_1)$ 和 $s_2 = \\ln(c_2)$。\n对角线元素：\n$(L_{\\exp})_{11} = \\exp(s_1) H_{11} = c_1 h_{11}$\n$(L_{\\exp})_{22} = \\exp(s_2) H_{22} = c_2 h_{22}$\n非对角线元素：\n$(L_{\\exp})_{12} = \\frac{\\exp(s_1) - \\exp(s_2)}{s_1 - s_2} H_{12} = \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} h_{12}$\n所以，$L_{\\exp}(S)[H] = \\begin{pmatrix} c_1 h_{11}  \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} h_{12} \\\\ \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} h_{12}  c_2 h_{22} \\end{pmatrix}$。\n\n对于 $L_{\\log}(C)[H]$：\n$C$ 的特征值为 $c_1$ 和 $c_2$。\n对角线元素：\n$(L_{\\log})_{11} = \\frac{1}{c_1} H_{11} = \\frac{h_{11}}{c_1}$\n$(L_{\\log})_{22} = \\frac{1}{c_2} H_{22} = \\frac{h_{22}}{c_2}$\n非对角线元素：\n$(L_{\\log})_{12} = \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2} H_{12}$\n所以，$L_{\\log}(C)[H] = \\begin{pmatrix} \\frac{h_{11}}{c_1}  \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2} h_{12} \\\\ \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2} h_{12}  \\frac{h_{22}}{c_2} \\end{pmatrix}$。\n\n现在我们计算 Frobenius 内积。对于对称矩阵 $A, B$，$\\langle A, B \\rangle_F = \\sum_{i,j} A_{ij} B_{ij} = A_{11}B_{11} + A_{22}B_{22} + 2 A_{12}B_{12}$。\n给定的矩阵为 $R = \\begin{pmatrix} r_{11}  r_{12} \\\\ r_{12}  r_{22} \\end{pmatrix}$ 和 $Q = \\begin{pmatrix} q_{11}  q_{12} \\\\ q_{12}  q_{22} \\end{pmatrix}$。\n\n$\\left\\langle R, L_{\\exp}(S)[H] \\right\\rangle_{F} = r_{11}(c_1 h_{11}) + r_{22}(c_2 h_{22}) + 2 r_{12} \\left( \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} h_{12} \\right)$\n$\\left\\langle Q, L_{\\log}(C)[H] \\right\\rangle_{F} = q_{11}\\left(\\frac{h_{11}}{c_1}\\right) + q_{22}\\left(\\frac{h_{22}}{c_2}\\right) + 2 q_{12} \\left( \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2} h_{12} \\right)$\n\n将这两项相加得到 $\\Gamma$：\n$\\Gamma = c_1 r_{11} h_{11} + c_2 r_{22} h_{22} + 2 \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} r_{12} h_{12} + \\frac{q_{11} h_{11}}{c_1} + \\frac{q_{22} h_{22}}{c_2} + 2 \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2} q_{12} h_{12}$。\n\n按 $H$ 的分量对各项进行分组：\n$\\Gamma = h_{11}\\left(c_1 r_{11} + \\frac{q_{11}}{c_1}\\right) + h_{22}\\left(c_2 r_{22} + \\frac{q_{22}}{c_2}\\right) + 2h_{12}\\left(r_{12} \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} + q_{12} \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2}\\right)$。\n\n这是 $\\Gamma$ 的最终封闭形式表达式。",
            "answer": "$$\\boxed{h_{11}\\left(c_1 r_{11} + \\frac{q_{11}}{c_1}\\right) + h_{22}\\left(c_2 r_{22} + \\frac{q_{22}}{c_2}\\right) + 2 h_{12}\\left(r_{12} \\frac{c_1 - c_2}{\\ln(c_1) - \\ln(c_2)} + q_{12} \\frac{\\ln(c_1) - \\ln(c_2)}{c_1 - c_2}\\right)}$$"
        },
        {
            "introduction": "任何科学计算代码开发的关键步骤都是验证：确保代码能正确求解其背后的数学模型。这个综合性的计算练习将要求您对照一个已知的解析解，来验证一个针对Oldroyd-B模型的对数构象求解器的正确性。通过在周期性剪切流中数值再现应力分布并量化误差，您将获得代码验证方面的实践经验，这是计算科学中的一项基本技能 。",
            "id": "4104799",
            "problem": "要求您通过再现空间周期性简单剪切流中的解析聚合物附加应力，并量化构象张量对数和聚合物附加应力的误差范数，来验证一种粘弹性本构模型的对数构象实现。该验证必须在纯运动学设定下进行，以避免对流，从而使得稳态解析解在每一点上都与具有局部变化剪切率的均匀简单剪切解相同。在二维空间中进行，并使用无量纲化的 Oldroyd-B 模型，其中聚合物模量为单位值，因此聚合物附加应力是构象张量的偏张量部分。\n\n基本基础和设定：\n- 考虑一个不可压缩流，其速度场为 $\\boldsymbol{u}(y) = \\left(U \\sin\\left(2 \\pi n y\\right), 0\\right)$，其中 $U$ 是一个恒定的振幅，$n$ 是一个正整数，表示在单位区间 $y \\in [0,1]$ 上的周期数。速度梯度为 $\\nabla \\boldsymbol{u}(y) = \\begin{pmatrix} 0  \\dot{\\gamma}(y) \\\\ 0  0 \\end{pmatrix}$，其局部剪切率为 $\\dot{\\gamma}(y) = \\dfrac{\\partial u_x}{\\partial y} = 2 \\pi n U \\cos\\left(2 \\pi n y\\right)$。\n- 令 $\\boldsymbol{A}(y)$ 表示对称正定构象张量，$\\boldsymbol{\\Psi}(y) = \\log \\boldsymbol{A}(y)$ 表示其矩阵对数（对数构象）。对于 Oldroyd-B 模型，在恒定剪切率的均匀简单剪切流中的稳态关系由上随体导数控制。在当前设定下，假设 $x$ 方向不变，因此物质导数降为零，这在每个 $y$ 点上产生局部的稳态代数平衡：\n$$ \\nabla \\boldsymbol{u}(y)\\, \\boldsymbol{A}(y) + \\boldsymbol{A}(y)\\, \\nabla \\boldsymbol{u}(y)^\\top = \\dfrac{1}{\\lambda}\\left(\\boldsymbol{A}(y) - \\boldsymbol{I}\\right), $$\n其中 $\\lambda$ 是松弛时间，$\\boldsymbol{I}$ 是单位张量。\n- 定义局部 Weissenberg 数为 $Wi(y) = \\lambda \\dot{\\gamma}(y)$。根据此平衡，每个 $y$ 点上简单剪切的解析稳态构象张量为对称张量\n$$ \\boldsymbol{A}(y) = \\begin{pmatrix} 1 + 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  1 \\end{pmatrix}. $$\n- 当聚合物模量为单位值时，无量纲的聚合物附加应力为 $\\boldsymbol{\\tau}_p(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$。\n\n您的任务：\n1) 使用上述基本平衡和定义，推导给定周期性剪切流下 $\\boldsymbol{A}(y)$、$\\boldsymbol{\\Psi}(y)$ 和 $\\boldsymbol{\\tau}_p(y)$ 的解析形式。\n2) 实现一个程序，该程序：\n   - 在 $y \\in [0,1]$ 上构建一个包含 $N$ 个点的均匀网格，其中 $N = 1001$。\n   - 对于下面测试套件中列出的每个测试用例参数集 $(\\lambda, U, n)$，在网格上计算解析的 $\\boldsymbol{A}(y)$。\n   - 通过对 $\\boldsymbol{A}(y)$ 进行谱分解来形成解析参考对数构象 $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y)$，即 $\\boldsymbol{A}(y) = \\boldsymbol{Q}(y) \\,\\mathrm{diag}(\\alpha_1(y), \\alpha_2(y))\\, \\boldsymbol{Q}(y)^\\top$，其中 $\\alpha_i(y) > 0$，且 $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y) = \\boldsymbol{Q}(y)\\, \\mathrm{diag}(\\log \\alpha_1(y), \\log \\alpha_2(y))\\, \\boldsymbol{Q}(y)^\\top$。\n   - 使用通用矩阵对数函数实现对数构象算子 $\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y)$，并使用通用矩阵指数函数重构 $\\boldsymbol{A}_{\\mathrm{impl}}(y) = \\exp\\left(\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y)\\right)$。然后定义 $\\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y) = \\boldsymbol{A}_{\\mathrm{impl}}(y) - \\boldsymbol{I}$。\n   - 通过计算网格上的以下误差范数来量化差异：\n     - 对数构象误差 $E_{\\Psi}(y) = \\boldsymbol{\\Psi}_{\\mathrm{impl}}(y) - \\boldsymbol{\\Psi}_{\\mathrm{ref}}(y)$ 的 $L^2$ 范数定义为\n       $$ \\|E_{\\Psi}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\Psi}(y_j)\\|_F^2 \\right)^{1/2}, $$\n       其中 $\\| \\cdot \\|_F$ 是 Frobenius 范数。\n     - 对数构象误差的 $L^{\\infty}$ 范数，\n       $$ \\|E_{\\Psi}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\Psi}(y_j)\\|_F. $$\n     - 聚合物应力误差 $E_{\\tau}(y) = \\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y) - \\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y)$ 的 $L^2$ 范数，其中 $\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$，类似地定义为\n       $$ \\|E_{\\tau}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\tau}(y_j)\\|_F^2 \\right)^{1/2}. $$\n     - 聚合物应力误差的 $L^{\\infty}$ 范数，\n       $$ \\|E_{\\tau}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\tau}(y_j)\\|_F. $$\n3) 为每个测试用例报告元组 $\\left[\\|E_{\\Psi}\\|_{L^2}, \\|E_{\\Psi}\\|_{L^{\\infty}}, \\|E_{\\tau}\\|_{L^2}, \\|E_{\\tau}\\|_{L^{\\infty}}\\right]$。\n\n测试套件：\n- 用例 $1$：$(\\lambda, U, n) = (0.1, 0.2, 1)$。\n- 用例 $2$：$(\\lambda, U, n) = (1.0, 0.5, 1)$。\n- 用例 $3$：$(\\lambda, U, n) = (2.0, 1.0, 1)$。\n- 用例 $4$ （边界情况，零剪切）：$(\\lambda, U, n) = (1.0, 0.0, 3)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的子列表，每个子列表对应于上述顺序的一个测试用例，并包含四个浮点值 $\\left[\\|E_{\\Psi}\\|_{L^2}, \\|E_{\\Psi}\\|_{L^{\\infty}}, \\|E_{\\tau}\\|_{L^2}, \\|E_{\\tau}\\|_{L^{\\infty}}\\right]$。将整个输出包含在方括号内。例如：$[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]]$。每个浮点值应四舍五入到 $12$ 位有效数字。由于所有量都是无量纲的，因此不需要物理单位。",
            "solution": "该问题要求验证 Oldroyd-B 粘弹性流体模型的对数构象实现。这是通过将数值计算的量与它们在空间周期性简单剪切流中的已知解析解进行比较来实现的。该验证在不存在对流的运动学设定下进行，从而可以与均匀简单剪切解进行逐点比较。\n\n### 1. 解析公式\n\n首先，我们建立所涉及物理量的解析形式。\n\n该流是二维的，其速度场由 $\\boldsymbol{u}(y) = (U \\sin(2 \\pi n y), 0)$ 给出，定义在区间 $y \\in [0,1]$ 上。这里，$U$ 是一个恒定的速度振幅，$n$ 是一个正整数，表示空间周期数。该流是一个具有空间变化剪切率的简单剪切流。速度梯度张量 $\\nabla \\boldsymbol{u}(y)$ 仅在其 $u_x$ 相对于 $y$ 的梯度上非零：\n$$\n\\nabla \\boldsymbol{u}(y) = \\begin{pmatrix} 0  \\dfrac{\\partial u_x}{\\partial y} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}(y) \\\\ 0  0 \\end{pmatrix}\n$$\n其中局部剪切率 $\\dot{\\gamma}(y)$ 是\n$$\n\\dot{\\gamma}(y) = 2 \\pi n U \\cos(2 \\pi n y).\n$$\n粘弹性效应的局部强度由 Weissenberg 数表征，其定义为聚合物松弛时间 $\\lambda$ 和局部剪切率的乘积：\n$$\nWi(y) = \\lambda \\dot{\\gamma}(y) = 2 \\pi n U \\lambda \\cos(2 \\pi n y).\n$$\n问题指出，稳态构象张量 $\\boldsymbol{A}(y)$ 由上随体 Maxwell 模型（Oldroyd-B 模型的基础）在没有物质输运的情况下导出的代数平衡方程控制：\n$$\n\\nabla \\boldsymbol{u}(y)\\, \\boldsymbol{A}(y) + \\boldsymbol{A}(y)\\, \\nabla \\boldsymbol{u}(y)^\\top = \\dfrac{1}{\\lambda}\\left(\\boldsymbol{A}(y) - \\boldsymbol{I}\\right).\n$$\n求解这个关于对称张量 $\\boldsymbol{A}(y)$ 分量的代数方程组，得到问题陈述中提供的解析解：\n$$\n\\boldsymbol{A}(y) = \\begin{pmatrix} 1 + 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  1 \\end{pmatrix}.\n$$\n对于所有实数值的 $Wi(y)$，该张量都是对称正定的，因为其行列式为 $\\det(\\boldsymbol{A}(y)) = (1 + 2 Wi(y)^2)(1) - Wi(y)^2 = 1 + Wi(y)^2  0$，其迹为 $\\mathrm{Tr}(\\boldsymbol{A}(y)) = 1 + 2 Wi(y)^2 + 1 = 2 + 2 Wi(y)^2  0$。\n\n鉴于无量纲聚合物模量为单位值，聚合物附加应力张量 $\\boldsymbol{\\tau}_p(y)$ 是构象张量的偏张量部分。然而，问题将其简单定义为 $\\boldsymbol{\\tau}_p(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$。在主要关注总应力的情境中，这是一种常见的简化。因此，参考聚合物应力为：\n$$\n\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y) = \\boldsymbol{A}(y) - \\boldsymbol{I} = \\begin{pmatrix} 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  0 \\end{pmatrix}.\n$$\n最后一个要推导的解析量是对数构象张量 $\\boldsymbol{\\Psi}(y) = \\log\\boldsymbol{A}(y)$。一个可对角化矩阵 $\\boldsymbol{A} = \\boldsymbol{Q} \\Lambda \\boldsymbol{Q}^\\top$（其中 $\\Lambda$ 是特征值的对角矩阵，$\\boldsymbol{Q}$ 是相应特征向量的矩阵）的矩阵对数由 $\\log\\boldsymbol{A} = \\boldsymbol{Q} (\\log\\Lambda) \\boldsymbol{Q}^\\top$ 给出。$\\boldsymbol{A}(y)$ 的特征值 $\\alpha_{1,2}$ 是特征方程 $\\det(\\boldsymbol{A} - \\alpha\\boldsymbol{I}) = 0$ 的根，即：\n$$\n\\alpha_{1,2}(y) = (1+Wi(y)^2) \\pm |Wi(y)|\\sqrt{1+Wi(y)^2}.\n$$\n使用矩阵函数的 Sylvester 公式，一个 $2 \\times 2$ 矩阵 $\\boldsymbol{M}$ 的对数可以表示为：\n$$\n\\log \\boldsymbol{M} = C_1 (\\boldsymbol{M} - C_2 \\boldsymbol{I}) + C_3 \\boldsymbol{I}\n$$\n其中 $C_1, C_2, C_3$ 是依赖于矩阵的标量。将此应用于 $\\boldsymbol{A}(y)$，我们找到 $\\boldsymbol{\\Psi}(y)$ 的解析表达式：\n$$\n\\boldsymbol{\\Psi}(y) = \\frac{\\mathrm{arsinh}(|Wi(y)|)}{|Wi(y)|\\sqrt{1+Wi(y)^2}} \\left( \\boldsymbol{A}(y) - (1+Wi(y)^2)\\boldsymbol{I} \\right) + \\frac{1}{2}\\log(1+Wi(y)^2)\\boldsymbol{I}.\n$$\n该表达式在数值上表现良好，当 $Wi(y) \\to 0$ 时趋向于零矩阵 $\\boldsymbol{0}$，这与 $\\log\\boldsymbol{I} = \\boldsymbol{0}$ 一致。这个推导出的形式提供了理论基础，但根据问题规范，参考计算将使用直接的数值谱分解。\n\n### 2. 数值验证和误差量化\n\n验证过程涉及比较矩阵对数和指数的两种计算方法的结果，并量化其差异。在区间 $[0,1]$ 上定义一个包含 $N=1001$ 个点 $\\{y_j\\}$ 的均匀网格。对于每个网格点和每个测试用例 $(\\lambda, U, n)$：\n\n1.  **解析张量**：计算局部 Weissenberg 数 $Wi(y_j)$。这用于构建解析构象张量 $\\boldsymbol{A}(y_j)$ 和参考聚合物附加应力 $\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y_j)$。\n\n2.  **参考对数构象（$\\boldsymbol{\\Psi}_{\\mathrm{ref}}$）**：参考对数构象 $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j)$ 是通过对 $\\boldsymbol{A}(y_j)$ 进行数值谱分解获得的。具体来说，我们计算其特征值 $\\alpha_1, \\alpha_2$ 和特征向量矩阵 $\\boldsymbol{Q}$。然后，$\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j) = \\boldsymbol{Q} \\, \\mathrm{diag}(\\log\\alpha_1, \\log\\alpha_2) \\, \\boldsymbol{Q}^\\top$。\n\n3.  **实现的对数构象和重构**：\n    - “实现”的对数构象 $\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j)$ 是通过将通用矩阵对数函数（例如 `scipy.linalg.logm`）直接应用于 $\\boldsymbol{A}(y_j)$ 来计算的。\n    - 然后使用矩阵指数函数（例如 `scipy.linalg.expm`）重构构象张量：$\\boldsymbol{A}_{\\mathrm{impl}}(y_j) = \\exp(\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j))$。\n    - 相应的实现应力是 $\\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y_j) = \\boldsymbol{A}_{\\mathrm{impl}}(y_j) - \\boldsymbol{I}$。\n\n4.  **误差计算**：此过程的目的是量化往返操作 $\\exp(\\log(\\boldsymbol{A}))$ 和直接计算 $\\log(\\boldsymbol{A})$ 中固有的数值误差。\n    - 对数构象误差为 $E_{\\Psi}(y_j) = \\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j) - \\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j)$。\n    - 应力误差为 $E_{\\tau}(y_j) = \\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y_j) - \\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y_j)$。\n\n5.  **范数**：使用网格上 $L^2$ 和 $L^{\\infty}$ 范数的离散近似来量化差异。\n    - 误差场（例如 $E_{\\Psi}$）的 $L^2$ 范数是其在网格上 Frobenius 范数 $\\| \\cdot \\|_F$ 的均方根：\n      $$ \\|E_{\\Psi}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\Psi}(y_j)\\|_F^2 \\right)^{1/2} $$\n    - $L^{\\infty}$ 范数是在网格上找到的最大 Frobenius 范数：\n      $$ \\|E_{\\Psi}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\Psi}(y_j)\\|_F $$\n    同样的定义也适用于应力误差 $E_{\\tau}$。\n\n该实现将为每个测试用例执行这些计算，并报告四个由此产生的误差范数。此过程严格测试了数值矩阵函数的准确性和稳定性，这是验证计算流体动力学软件的关键步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes error norms for a log-conformation implementation in a \n    viscoelastic flow problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.1, 0.2, 1),  # Case 1: (lambda, U, n)\n        (1.0, 0.5, 1),  # Case 2\n        (2.0, 1.0, 1),  # Case 3\n        (1.0, 0.0, 3),  # Case 4 (edge case)\n    ]\n\n    N = 1001\n    y_grid = np.linspace(0.0, 1.0, N)\n    \n    all_results = []\n\n    for case in test_cases:\n        lam, U, n = case\n\n        # 1. Compute analytical quantities over the grid\n        \n        # Local shear rate and Weissenberg number\n        dot_gamma = 2.0 * np.pi * n * U * np.cos(2.0 * np.pi * n * y_grid)\n        Wi = lam * dot_gamma\n\n        # Analytical conformation tensor A(y) (N, 2, 2)\n        A = np.zeros((N, 2, 2))\n        A[:, 0, 0] = 1.0 + 2.0 * Wi**2\n        A[:, 0, 1] = Wi\n        A[:, 1, 0] = Wi\n        A[:, 1, 1] = 1.0\n\n        # Reference polymeric extra stress tau_p_ref(y)\n        tau_p_ref = A - np.identity(2)\n\n        # 2. Compute reference log-conformation Psi_ref(y) via spectral decomposition\n        eigvals, eigvecs = np.linalg.eigh(A)\n\n        # Ensure eigenvalues are positive before taking log\n        # For SPD matrices, eigh guarantees real eigenvalues, which should be positive here.\n        log_eigvals = np.log(eigvals)\n        \n        # Reconstruct log(Lambda) as a stack of diagonal matrices\n        log_Lambda = np.zeros((N, 2, 2))\n        log_Lambda[:, 0, 0] = log_eigvals[:, 0]\n        log_Lambda[:, 1, 1] = log_eigvals[:, 1]\n        \n        # Psi_ref = Q * log(Lambda) * Q^T\n        Psi_ref = eigvecs @ log_Lambda @ np.transpose(eigvecs, (0, 2, 1))\n\n        # 3. Compute implementation-based quantities\n        # Scipy linalg functions do not operate on stacks of matrices, so we must loop.\n        Psi_impl = np.array([linalg.logm(A[j]) for j in range(N)])\n        \n        # Handle potential small imaginary parts from numerical error in logm\n        if np.iscomplexobj(Psi_impl):\n            Psi_impl = Psi_impl.real\n            \n        A_impl = np.array([linalg.expm(Psi_impl[j]) for j in range(N)])\n        tau_p_impl = A_impl - np.identity(2)\n\n        # 4. Compute error fields\n        E_Psi = Psi_impl - Psi_ref\n        E_tau = tau_p_impl - tau_p_ref\n        \n        # 5. Compute error norms\n        # Frobenius norm ||M||_F = sqrt(sum(M_ij^2))\n        # We compute ||E(y_j)||_F for each point j\n        \n        E_Psi_F = np.linalg.norm(E_Psi, ord='fro', axis=(1, 2))\n        E_tau_F = np.linalg.norm(E_tau, ord='fro', axis=(1, 2))\n\n        # L2 norm: sqrt( mean( ||E(y_j)||_F^2 ) )\n        L2_E_Psi = np.sqrt(np.mean(E_Psi_F**2))\n        L2_E_tau = np.sqrt(np.mean(E_tau_F**2))\n\n        # Linf norm: max( ||E(y_j)||_F )\n        Linf_E_Psi = np.max(E_Psi_F)\n        Linf_E_tau = np.max(E_tau_F)\n\n        # Append results for this test case\n        case_results = [L2_E_Psi, Linf_E_Psi, L2_E_tau, Linf_E_tau]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Format each float to 12 significant digits using the 'g' specifier.\n    result_str = ','.join(\n        '[' + ','.join(format(val, '.12g') for val in res) + ']'\n        for res in all_results\n    )\n    print(f\"[[{result_str}]]\")\n\nsolve()\n```"
        }
    ]
}