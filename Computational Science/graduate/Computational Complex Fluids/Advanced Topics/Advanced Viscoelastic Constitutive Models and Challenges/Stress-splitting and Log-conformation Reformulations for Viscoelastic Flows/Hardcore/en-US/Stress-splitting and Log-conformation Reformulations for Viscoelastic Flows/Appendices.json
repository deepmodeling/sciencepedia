{
    "hands_on_practices": [
        {
            "introduction": "Before we can appreciate the solution, we must first understand the problem. In computational viscoelasticity, the \"High Weissenberg Number Problem\" is the primary challenge that necessitates advanced numerical techniques. This exercise uses the powerful tool of dimensional analysis to derive the Weissenberg number from the governing equations, revealing its physical meaning as a ratio of time scales. Understanding this key parameter is the first step toward grasping why reformulations like log-conformation are crucial for simulating strongly elastic flows. ",
            "id": "4104850",
            "problem": "Consider an incompressible, pressure-driven planar channel flow of an Oldroyd-B viscoelastic fluid of half-width $L$ with mean velocity scale $U$. In the stress-splitting approach, the total extra stress is decomposed into a Newtonian solvent contribution and a polymeric extra stress, so that $\\boldsymbol{\\sigma}_{\\text{extra}} = 2 \\eta_{s} \\boldsymbol{D} + \\boldsymbol{\\tau}_{p}$, where $\\eta_{s}$ is the solvent viscosity and $\\boldsymbol{D} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$ is the rate-of-deformation tensor, with $\\boldsymbol{u}$ the velocity field. The polymer microstructure is described by the symmetric, positive-definite conformation tensor $\\boldsymbol{A}$, and the Oldroyd-B constitutive dynamics are given by the upper-convected Maxwell form\n$$\n\\frac{\\partial \\boldsymbol{A}}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla \\boldsymbol{A} - ((\\nabla \\boldsymbol{u}) \\boldsymbol{A} + \\boldsymbol{A} (\\nabla \\boldsymbol{u})^{\\top}) = -\\frac{1}{\\lambda}\\left(\\boldsymbol{A} - \\boldsymbol{I}\\right),\n$$\nwhere $\\lambda$ is the polymer relaxation time and $\\boldsymbol{I}$ is the identity tensor. In the logarithm of the conformation tensor reformulation (log-conformation), one defines $\\boldsymbol{\\Psi} = \\log \\boldsymbol{A}$ to improve numerical stability while preserving positive-definiteness; however, the characteristic time scale remains governed by $\\lambda$.\n\nUsing dimensional analysis and nondimensionalization based on the geometric length scale $L$, velocity scale $U$, and time scale $L/U$, derive the single dimensionless group that quantifies the ratio of elastic relaxation time to the advective time in the conformation dynamics. Your derivation should start from the given conformation tensor evolution equation, introduce appropriately scaled dimensionless variables, and identify the coefficient that multiplies the relaxation term in the nondimensional form. Name this dimensionless group and explain its physical meaning in the context of stress-splitting and log-conformation for the described channel flow.\n\nExpress your final answer solely as a closed-form analytic expression for this dimensionless group in terms of $\\lambda$, $U$, and $L$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, well-posed, and objective. It presents a standard task in fluid mechanics—nondimensionalization of a governing equation—based on well-established principles of computational rheology. All necessary information is provided, and the problem is free of contradictions or ambiguities.\n\nThe objective is to derive the dimensionless group that represents the ratio of the elastic relaxation time to the advective time for an Oldroyd-B fluid in a channel flow. The derivation begins with the provided evolution equation for the conformation tensor, $\\boldsymbol{A}$.\n\nThe governing equation for the conformation tensor $\\boldsymbol{A}$ is given as:\n$$\n\\frac{\\partial \\boldsymbol{A}}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla \\boldsymbol{A} - ((\\nabla \\boldsymbol{u}) \\boldsymbol{A} + \\boldsymbol{A} (\\nabla \\boldsymbol{u})^{\\top}) = -\\frac{1}{\\lambda}\\left(\\boldsymbol{A} - \\boldsymbol{I}\\right)\n$$\nwhere $t$ is time, $\\boldsymbol{u}$ is the velocity field, $\\nabla$ is the gradient operator, $\\lambda$ is the polymer relaxation time, and $\\boldsymbol{I}$ is the identity tensor.\n\nTo nondimensionalize this equation, we introduce dimensionless variables, denoted by a superscript $*$. The problem specifies the characteristic scales: length scale $L$, velocity scale $U$, and time scale $L/U$. The dimensionless variables are defined as:\n$$\n\\boldsymbol{x}^* = \\frac{\\boldsymbol{x}}{L}, \\quad t^* = \\frac{t}{L/U} = \\frac{tU}{L}, \\quad \\boldsymbol{u}^* = \\frac{\\boldsymbol{u}}{U}\n$$\nThe conformation tensor $\\boldsymbol{A}$ represents the second moment of the distribution of polymer end-to-end vectors, normalized by the equilibrium value. As such, it is already a dimensionless quantity, so $\\boldsymbol{A}^* = \\boldsymbol{A}$. The identity tensor $\\boldsymbol{I}$ is also dimensionless.\n\nNext, we express the differential operators in terms of the dimensionless variables using the chain rule:\nThe time derivative becomes:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial t^*}{\\partial t} \\frac{\\partial}{\\partial t^*} = \\frac{U}{L} \\frac{\\partial}{\\partial t^*}\n$$\nThe gradient operator becomes:\n$$\n\\nabla = \\frac{\\partial}{\\partial \\boldsymbol{x}} = \\frac{\\partial \\boldsymbol{x}^*}{\\partial \\boldsymbol{x}} \\frac{\\partial}{\\partial \\boldsymbol{x}^*} = \\frac{1}{L} \\nabla^*\n$$\nSubstituting these expressions into the governing equation yields:\n$$\n\\frac{U}{L} \\frac{\\partial \\boldsymbol{A}}{\\partial t^*} + (U\\boldsymbol{u}^*) \\cdot \\left(\\frac{1}{L}\\nabla^*\\right) \\boldsymbol{A} - \\left(\\left(\\frac{1}{L}\\nabla^*\\right)(U\\boldsymbol{u}^*)\\right) \\boldsymbol{A} - \\boldsymbol{A} \\left(\\left(\\frac{1}{L}\\nabla^*\\right)(U\\boldsymbol{u}^*)\\right)^{\\top} = -\\frac{1}{\\lambda}(\\boldsymbol{A} - \\boldsymbol{I})\n$$\nWe can factor out the dimensional scales from the terms on the left-hand side:\n$$\n\\frac{U}{L} \\left[ \\frac{\\partial \\boldsymbol{A}}{\\partial t^*} + \\boldsymbol{u}^* \\cdot \\nabla^* \\boldsymbol{A} - (\\nabla^* \\boldsymbol{u}^*) \\boldsymbol{A} - \\boldsymbol{A} (\\nabla^* \\boldsymbol{u}^*)^{\\top} \\right] = -\\frac{1}{\\lambda}(\\boldsymbol{A} - \\boldsymbol{I})\n$$\nTo make the entire equation dimensionless, we multiply all terms by $\\frac{L}{U}$. This choice makes the coefficient of the time derivative term unity, consistent with the specified time scale of $L/U$.\n$$\n\\frac{\\partial \\boldsymbol{A}}{\\partial t^*} + \\boldsymbol{u}^* \\cdot \\nabla^* \\boldsymbol{A} - (\\nabla^* \\boldsymbol{u}^*) \\boldsymbol{A} - \\boldsymbol{A} (\\nabla^* \\boldsymbol{u}^*)^{\\top} = -\\frac{L}{\\lambda U}(\\boldsymbol{A} - \\boldsymbol{I})\n$$\nThe problem asks for the dimensionless group that quantifies the ratio of the elastic relaxation time to the advective time.\nThe characteristic time for elastic relaxation of the polymer microstructure is $\\lambda$.\nThe characteristic time for advection of a fluid particle over the length scale $L$ is $\\tau_{\\text{adv}} = \\frac{L}{U}$.\n\nThe ratio of these two time scales defines the desired dimensionless group:\n$$\n\\text{Dimensionless Group} = \\frac{\\text{Elastic relaxation time}}{\\text{Advective time}} = \\frac{\\lambda}{\\tau_{\\text{adv}}} = \\frac{\\lambda}{L/U} = \\frac{\\lambda U}{L}\n$$\nThis dimensionless group is the Weissenberg number, conventionally denoted as $Wi$.\n$$\nWi = \\frac{\\lambda U}{L}\n$$\nBy comparing this definition with the nondimensionalized equation, we can see that the coefficient multiplying the relaxation term on the right-hand side is the reciprocal of the Weissenberg number:\n$$\n\\frac{\\partial \\boldsymbol{A}^*}{\\partial t^*} + \\mathcal{L}_{\\boldsymbol{u}^*} \\boldsymbol{A}^* = -\\frac{1}{Wi}(\\boldsymbol{A}^* - \\boldsymbol{I})\n$$\nwhere $\\mathcal{L}_{\\boldsymbol{u}^*} \\boldsymbol{A}^*$ represents the upper-convected derivative terms in dimensionless form. Thus, the derived dimensionless group $Wi$ is consistent with the nondimensionalization process, appearing as the inverse of the coefficient of the relaxation term.\n\nThe physical meaning of the Weissenberg number is a measure of the degree of elastic effects in the flow. If $Wi \\ll 1$, the advective timescale is large compared to the polymer relaxation time, meaning the polymers can relax to their equilibrium state. Elastic effects are weak, and the fluid behaves more like a Newtonian fluid. If $Wi \\gg 1$, the flow deforms the polymers much faster than they can relax, leading to large elastic stresses and pronounced non-Newtonian behavior. The context of stress-splitting and log-conformation is particularly relevant for high-$Wi$ flows ($Wi \\gg 1$), where standard numerical methods fail. The log-conformation reformulation is an advanced technique designed to maintain numerical stability in these elasticity-dominated regimes, making the Weissenberg number the key parameter indicating the computational difficulty of the problem.\n\nThe final answer is the analytical expression for this dimensionless group.",
            "answer": "$$\n\\boxed{\\frac{\\lambda U}{L}}\n$$"
        },
        {
            "introduction": "The log-conformation reformulation is built upon a fundamental mathematical transformation: taking the logarithm of the symmetric positive-definite (SPD) conformation tensor, $\\boldsymbol{A}$. This exercise provides a direct, hands-on opportunity to master this core operation by computing the matrix logarithm, $\\boldsymbol{\\Psi} = \\log\\boldsymbol{A}$, and its inverse, the matrix exponential, for a simple 2D tensor. By working through the calculation via spectral decomposition, you will build essential intuition for how the method operates at a fundamental level. ",
            "id": "4104865",
            "problem": "In computational complex fluids, the log-conformation reformulation introduces the logarithm of the conformation tensor to improve numerical robustness in viscoelastic flow computations. Let $\\boldsymbol{A} \\in \\mathbb{R}^{2 \\times 2}$ be a symmetric positive definite (SPD) conformation tensor, with eigenvalues $\\lambda_{1}  0$ and $\\lambda_{2}  0$ and orthonormal eigenvectors forming a rotation by an angle $\\theta$ (in radians). Define the log-conformation variable $\\boldsymbol{\\Psi}$ as the principal matrix logarithm of $\\boldsymbol{A}$, namely $\\boldsymbol{\\Psi} = \\log \\boldsymbol{A}$, and consider the principal matrix exponential $\\exp \\boldsymbol{\\Psi}$.\n\nStarting only from the spectral theorem for real symmetric matrices and the definition of a matrix function via functional calculus (apply a scalar function to the spectrum in an orthonormal eigenbasis), perform the following tasks:\n\n1. Derive explicit expressions for $\\log \\boldsymbol{A}$ and $\\exp \\boldsymbol{\\Psi}$ when $\\boldsymbol{A}$ is a $2 \\times 2$ SPD tensor with eigenvalues $\\lambda_{1}$ and $\\lambda_{2}$ and eigenvectors forming a rotation by $\\theta$. Express your results in terms of $\\lambda_{1}$, $\\lambda_{2}$, and $\\theta$.\n\n2. Specialize to the concrete case with $\\lambda_{1} = 3$, $\\lambda_{2} = \\tfrac{1}{2}$, and $\\theta = \\tfrac{\\pi}{6}$ (radians). Compute $\\log \\boldsymbol{A}$ and $\\exp \\boldsymbol{\\Psi}$ explicitly for this case, and verify their consistency by evaluating the Frobenius norm of the difference:\n$$\n\\left\\| \\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{A} \\right\\|_{F}.\n$$\n\nProvide the final value of $\\left\\| \\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{A} \\right\\|_{F}$ as your answer. Express your answer exactly (no rounding).",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It is a standard problem in linear algebra applied to continuum mechanics, specifically the log-conformation formulation for viscoelastic fluids. All required data and definitions are provided. We may proceed with a solution.\n\nThe problem asks for derivations and calculations based on the spectral theorem and the concept of matrix functions via functional calculus.\n\nLet $\\boldsymbol{A}$ be a $2 \\times 2$ real symmetric positive definite (SPD) matrix. The spectral theorem states that $\\boldsymbol{A}$ can be diagonalized by an orthogonal matrix:\n$$\n\\boldsymbol{A} = \\boldsymbol{Q} \\boldsymbol{\\Lambda} \\boldsymbol{Q}^T\n$$\nwhere $\\boldsymbol{\\Lambda}$ is the diagonal matrix of eigenvalues and the columns of $\\boldsymbol{Q}$ are the corresponding orthonormal eigenvectors. Since $\\boldsymbol{A}$ is SPD, its eigenvalues $\\lambda_1, \\lambda_2$ are real and positive. The matrix of eigenvectors $\\boldsymbol{Q}$ is orthogonal, meaning $\\boldsymbol{Q}^T\\boldsymbol{Q} = \\boldsymbol{Q}\\boldsymbol{Q}^T = \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity matrix.\n\nThe problem states that the orthonormal eigenvectors form a rotation by an angle $\\theta$. Thus, $\\boldsymbol{Q}$ is the rotation matrix $\\boldsymbol{R}(\\theta)$:\n$$\n\\boldsymbol{Q} = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\nThe eigenvalue matrix is:\n$$\n\\boldsymbol{\\Lambda} = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix}\n$$\nA matrix function $f(\\boldsymbol{A})$ is defined by applying the scalar function $f$ to the eigenvalues:\n$$\nf(\\boldsymbol{A}) = \\boldsymbol{Q} f(\\boldsymbol{\\Lambda}) \\boldsymbol{Q}^T = \\boldsymbol{Q} \\begin{pmatrix} f(\\lambda_1)  0 \\\\ 0  f(\\lambda_2) \\end{pmatrix} \\boldsymbol{Q}^T\n$$\n\n**1. General Derivations**\n\nFirst, we derive the explicit expression for $\\log \\boldsymbol{A}$. We set $f(x) = \\log(x)$.\n$$\n\\log \\boldsymbol{A} = \\boldsymbol{Q} (\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^T = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} \\log(\\lambda_1)  0 \\\\ 0  \\log(\\lambda_2) \\end{pmatrix} \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix} \\log(\\lambda_1)\\cos\\theta  -\\log(\\lambda_2)\\sin\\theta \\\\ \\log(\\lambda_1)\\sin\\theta  \\log(\\lambda_2)\\cos\\theta \\end{pmatrix} \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix} \\log(\\lambda_1)\\cos^2\\theta + \\log(\\lambda_2)\\sin^2\\theta  (\\log(\\lambda_1)-\\log(\\lambda_2))\\sin\\theta\\cos\\theta \\\\ (\\log(\\lambda_1)-\\log(\\lambda_2))\\sin\\theta\\cos\\theta  \\log(\\lambda_1)\\sin^2\\theta + \\log(\\lambda_2)\\cos^2\\theta \\end{pmatrix}\n$$\nUsing the trigonometric identities $\\cos^2\\theta = \\frac{1}{2}(1+\\cos(2\\theta))$, $\\sin^2\\theta = \\frac{1}{2}(1-\\cos(2\\theta))$, and $\\sin\\theta\\cos\\theta = \\frac{1}{2}\\sin(2\\theta)$, we can write this more compactly:\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix}\n\\frac{\\log(\\lambda_1)+\\log(\\lambda_2)}{2} + \\frac{\\log(\\lambda_1)-\\log(\\lambda_2)}{2}\\cos(2\\theta)  \\frac{\\log(\\lambda_1)-\\log(\\lambda_2)}{2}\\sin(2\\theta) \\\\\n\\frac{\\log(\\lambda_1)-\\log(\\lambda_2)}{2}\\sin(2\\theta)  \\frac{\\log(\\lambda_1)+\\log(\\lambda_2)}{2} - \\frac{\\log(\\lambda_1)-\\log(\\lambda_2)}{2}\\cos(2\\theta)\n\\end{pmatrix}\n$$\nUsing properties of logarithms, $\\log(a)+\\log(b) = \\log(ab)$ and $\\log(a)-\\log(b) = \\log(a/b)$, we get:\n$$\n\\log \\boldsymbol{A} = \\begin{pmatrix}\n\\frac{1}{2}\\log(\\lambda_1\\lambda_2) + \\frac{1}{2}\\log(\\lambda_1/\\lambda_2)\\cos(2\\theta)  \\frac{1}{2}\\log(\\lambda_1/\\lambda_2)\\sin(2\\theta) \\\\\n\\frac{1}{2}\\log(\\lambda_1/\\lambda_2)\\sin(2\\theta)  \\frac{1}{2}\\log(\\lambda_1\\lambda_2) - \\frac{1}{2}\\log(\\lambda_1/\\lambda_2)\\cos(2\\theta)\n\\end{pmatrix}\n$$\nNext, we derive the explicit expression for $\\exp \\boldsymbol{\\Psi}$, where $\\boldsymbol{\\Psi} = \\log \\boldsymbol{A}$. We apply the matrix exponential function, $g(x)=\\exp(x)$, to $\\boldsymbol{\\Psi}$.\nThe spectral decomposition of $\\boldsymbol{\\Psi}$ is $\\boldsymbol{\\Psi} = \\boldsymbol{Q} (\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^T$. The eigenvalues of $\\boldsymbol{\\Psi}$ are $\\log(\\lambda_1)$ and $\\log(\\lambda_2)$.\n$$\n\\exp \\boldsymbol{\\Psi} = \\exp(\\log \\boldsymbol{A}) = \\boldsymbol{Q} \\exp(\\log \\boldsymbol{\\Lambda}) \\boldsymbol{Q}^T\n$$\nThe exponential of the diagonal matrix of log-eigenvalues is:\n$$\n\\exp(\\log \\boldsymbol{\\Lambda}) = \\begin{pmatrix} \\exp(\\log \\lambda_1)  0 \\\\ 0  \\exp(\\log \\lambda_2) \\end{pmatrix} = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix} = \\boldsymbol{\\Lambda}\n$$\nSubstituting this back, we find:\n$$\n\\exp \\boldsymbol{\\Psi} = \\boldsymbol{Q} \\boldsymbol{\\Lambda} \\boldsymbol{Q}^T = \\boldsymbol{A}\n$$\nThus, the expression for $\\exp \\boldsymbol{\\Psi}$ is simply the expression for $\\boldsymbol{A}$ itself, in terms of $\\lambda_1, \\lambda_2, \\theta$. This is obtained by replacing $\\log(\\lambda_i)$ with $\\lambda_i$ in the initial derived form for $\\log \\boldsymbol{A}$:\n$$\n\\exp \\boldsymbol{\\Psi} = \\begin{pmatrix} \\lambda_1\\cos^2\\theta + \\lambda_2\\sin^2\\theta  (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta \\\\ (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta  \\lambda_1\\sin^2\\theta + \\lambda_2\\cos^2\\theta \\end{pmatrix}\n$$\n\n**2. Specific Case Computation and Verification**\n\nWe are given $\\lambda_1 = 3$, $\\lambda_2 = \\frac{1}{2}$, and $\\theta = \\frac{\\pi}{6}$.\nFirst, we compute the necessary trigonometric values:\n$\\cos(\\frac{\\pi}{6}) = \\frac{\\sqrt{3}}{2}$ and $\\sin(\\frac{\\pi}{6}) = \\frac{1}{2}$.\n$\\cos^2(\\frac{\\pi}{6}) = \\frac{3}{4}$ and $\\sin^2(\\frac{\\pi}{6}) = \\frac{1}{4}$.\n\nNow, we compute the explicit matrix $\\boldsymbol{A}$ for these values.\n$$\nA_{11} = \\lambda_1\\cos^2\\theta + \\lambda_2\\sin^2\\theta = 3\\left(\\frac{3}{4}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{9}{4} + \\frac{1}{8} = \\frac{18+1}{8} = \\frac{19}{8}\n$$\n$$\nA_{22} = \\lambda_1\\sin^2\\theta + \\lambda_2\\cos^2\\theta = 3\\left(\\frac{1}{4}\\right) + \\frac{1}{2}\\left(\\frac{3}{4}\\right) = \\frac{3}{4} + \\frac{3}{8} = \\frac{6+3}{8} = \\frac{9}{8}\n$$\n$$\nA_{12} = A_{21} = (\\lambda_1-\\lambda_2)\\sin\\theta\\cos\\theta = \\left(3-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right) = \\left(\\frac{5}{2}\\right)\\frac{\\sqrt{3}}{4} = \\frac{5\\sqrt{3}}{8}\n$$\nSo, the matrix $\\boldsymbol{A}$ is:\n$$\n\\boldsymbol{A} = \\frac{1}{8}\\begin{pmatrix} 19  5\\sqrt{3} \\\\ 5\\sqrt{3}  9 \\end{pmatrix}\n$$\nNext, we compute $\\boldsymbol{\\Psi} = \\log \\boldsymbol{A}$. The eigenvalues of $\\boldsymbol{\\Psi}$ are $\\log(\\lambda_1) = \\log(3)$ and $\\log(\\lambda_2) = \\log(\\frac{1}{2}) = -\\log(2)$.\n$$\n\\Psi_{11} = \\log(3)\\cos^2\\theta + \\log(1/2)\\sin^2\\theta = \\log(3)\\left(\\frac{3}{4}\\right) - \\log(2)\\left(\\frac{1}{4}\\right) = \\frac{3\\log(3) - \\log(2)}{4} = \\frac{\\log(27) - \\log(2)}{4} = \\frac{\\log(27/2)}{4}\n$$\n$$\n\\Psi_{22} = \\log(3)\\sin^2\\theta + \\log(1/2)\\cos^2\\theta = \\log(3)\\left(\\frac{1}{4}\\right) - \\log(2)\\left(\\frac{3}{4}\\right) = \\frac{\\log(3) - 3\\log(2)}{4} = \\frac{\\log(3) - \\log(8)}{4} = \\frac{\\log(3/8)}{4}\n$$\n$$\n\\Psi_{12} = \\Psi_{21} = (\\log(3)-\\log(1/2))\\sin\\theta\\cos\\theta = (\\log(3)-(-\\log(2)))\\frac{\\sqrt{3}}{4} = \\frac{(\\log(3)+\\log(2))\\sqrt{3}}{4} = \\frac{\\sqrt{3}\\log(6)}{4}\n$$\nSo, the matrix $\\boldsymbol{\\Psi}$ is:\n$$\n\\boldsymbol{\\Psi} = \\frac{1}{4}\\begin{pmatrix} \\log(27/2)  \\sqrt{3}\\log(6) \\\\ \\sqrt{3}\\log(6)  \\log(3/8) \\end{pmatrix}\n$$\nAs derived generally, $\\exp(\\boldsymbol{\\Psi}) = \\exp(\\log \\boldsymbol{A}) = \\boldsymbol{A}$. Therefore, the matrix $\\exp \\boldsymbol{\\Psi}$ is identical to the matrix $\\boldsymbol{A}$ we calculated.\n$$\n\\exp \\boldsymbol{\\Psi} = \\boldsymbol{A} = \\frac{1}{8}\\begin{pmatrix} 19  5\\sqrt{3} \\\\ 5\\sqrt{3}  9 \\end{pmatrix}\n$$\nFinally, we compute the Frobenius norm of the difference $\\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{A}$.\n$$\n\\exp(\\boldsymbol{\\Psi}) - \\boldsymbol{A} = \\boldsymbol{A} - \\boldsymbol{A} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} = \\boldsymbol{0}\n$$\nThe Frobenius norm of a matrix $\\boldsymbol{X}$ is $\\|\\boldsymbol{X}\\|_F = \\sqrt{\\sum_{i,j} |X_{ij}|^2}$. For the zero matrix, this is:\n$$\n\\left\\| \\boldsymbol{0} \\right\\|_{F} = \\sqrt{0^2 + 0^2 + 0^2 + 0^2} = 0\n$$\nThus, the consistency check yields a value of $0$, as expected from the properties of the matrix logarithm and exponential functions.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "A theoretical understanding of a numerical method is incomplete without the ability to verify its practical implementation. This exercise bridges the gap between theory and code by guiding you through a standard verification test for a log-conformation model. You will compare the output of a numerical implementation against a known analytical solution, a critical practice for ensuring your code is correct and building confidence in your simulation results. ",
            "id": "4104799",
            "problem": "You are asked to verify a log-conformation implementation for a viscoelastic constitutive model by reproducing the analytical polymeric extra stress in a spatially periodic simple shear flow and quantifying error norms for the logarithm of the conformation tensor and the polymeric extra stress. The verification must be carried out in a purely kinematic setting that avoids advection so that the steady-state analytical solution is pointwise identical to the homogeneous simple shear solution with a locally varying shear rate. Work in two spatial dimensions and use a nondimensionalized Oldroyd–B model with unit polymer modulus so that the polymeric extra stress is the deviatoric part of the conformation tensor.\n\nFundamental base and setting:\n- Consider an incompressible flow with velocity field $\\boldsymbol{u}(y) = \\left(U \\sin\\left(2 \\pi n y\\right), 0\\right)$, where $U$ is a constant amplitude and $n$ is a positive integer counting periods over the unit interval $y \\in [0,1]$. The velocity gradient is $\\nabla \\boldsymbol{u}(y) = \\begin{pmatrix} 0  \\dot{\\gamma}(y) \\\\ 0  0 \\end{pmatrix}$ with local shear rate $\\dot{\\gamma}(y) = \\dfrac{\\partial u_x}{\\partial y} = 2 \\pi n U \\cos\\left(2 \\pi n y\\right)$.\n- Let $\\boldsymbol{A}(y)$ denote the symmetric positive definite conformation tensor, and let $\\boldsymbol{\\Psi}(y) = \\log \\boldsymbol{A}(y)$ denote its matrix logarithm (the log-conformation). For the Oldroyd–B model, the steady-state relation in a homogeneous simple shear with constant shear rate is governed by the upper-convected derivative. In the present setting, assume $x$-invariance so that the material derivative reduces to zero, which yields the local steady algebraic balance at each $y$:\n$$ \\nabla \\boldsymbol{u}(y)\\, \\boldsymbol{A}(y) + \\boldsymbol{A}(y)\\, \\nabla \\boldsymbol{u}(y)^{\\mathsf{T}} = \\dfrac{1}{\\lambda}\\left(\\boldsymbol{A}(y) - \\boldsymbol{I}\\right), $$\nwhere $\\lambda$ is the relaxation time and $\\boldsymbol{I}$ is the identity tensor.\n- Define the local Weissenberg number as $Wi(y) = \\lambda \\dot{\\gamma}(y)$. From this balance, the analytical steady-state conformation tensor for simple shear at each $y$ is the symmetric tensor\n$$ \\boldsymbol{A}(y) = \\begin{pmatrix} 1 + 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  1 \\end{pmatrix}. $$\n- With unit polymer modulus, the nondimensional polymeric extra stress is $\\boldsymbol{\\tau}_p(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$.\n\nYour tasks:\n1) Using the fundamental balance and definitions above, derive the analytical form of $\\boldsymbol{A}(y)$, $\\boldsymbol{\\Psi}(y)$, and $\\boldsymbol{\\tau}_p(y)$ for the given periodic shear flow.\n2) Implement a program that:\n   - Constructs a uniform grid of $N$ points in $y \\in [0,1]$ with $N = 1001$.\n   - For each test case parameter set $(\\lambda, U, n)$ listed in the Test Suite below, computes the analytical $\\boldsymbol{A}(y)$ over the grid.\n   - Forms the analytical reference log-conformation $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y)$ by spectral decomposition of $\\boldsymbol{A}(y)$, i.e., $\\boldsymbol{A}(y) = \\boldsymbol{Q}(y) \\,\\mathrm{diag}(\\alpha_1(y), \\alpha_2(y))\\, \\boldsymbol{Q}(y)^{\\mathsf{T}}$ with $\\alpha_i(y)  0$, and $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y) = \\boldsymbol{Q}(y)\\, \\mathrm{diag}(\\log \\alpha_1(y), \\log \\alpha_2(y))\\, \\boldsymbol{Q}(y)^{\\mathsf{T}}$.\n   - Implements a log-conformation operator $\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y)$ using a general-purpose matrix logarithm and reconstructs $\\boldsymbol{A}_{\\mathrm{impl}}(y) = \\exp\\left(\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y)\\right)$ using a general-purpose matrix exponential. Then defines $\\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y) = \\boldsymbol{A}_{\\mathrm{impl}}(y) - \\boldsymbol{I}$.\n   - Quantifies discrepancies by computing the following error norms over the grid:\n     - The $L^2$ norm of the log-conformation error $E_{\\Psi}(y) = \\boldsymbol{\\Psi}_{\\mathrm{impl}}(y) - \\boldsymbol{\\Psi}_{\\mathrm{ref}}(y)$ defined as\n       $$ \\|E_{\\Psi}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\Psi}(y_j)\\|_F^2 \\right)^{1/2}, $$\n       where $\\| \\cdot \\|_F$ is the Frobenius norm.\n     - The $L^{\\infty}$ norm of the log-conformation error,\n       $$ \\|E_{\\Psi}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\Psi}(y_j)\\|_F. $$\n     - The $L^2$ norm of the polymeric stress error $E_{\\tau}(y) = \\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y) - \\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y)$, with $\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$, defined analogously by\n       $$ \\|E_{\\tau}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\tau}(y_j)\\|_F^2 \\right)^{1/2}. $$\n     - The $L^{\\infty}$ norm of the polymeric stress error,\n       $$ \\|E_{\\tau}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\tau}(y_j)\\|_F. $$\n3) Report for each test case the tuple $\\left[\\|E_{\\Psi}\\|_{L^2}, \\|E_{\\Psi}\\|_{L^{\\infty}}, \\|E_{\\tau}\\|_{L^2}, \\|E_{\\tau}\\|_{L^{\\infty}}\\right]$.\n\nTest Suite:\n- Case $1$: $(\\lambda, U, n) = (0.1, 0.2, 1)$.\n- Case $2$: $(\\lambda, U, n) = (1.0, 0.5, 1)$.\n- Case $3$: $(\\lambda, U, n) = (2.0, 1.0, 1)$.\n- Case $4$ (edge case, zero shear): $(\\lambda, U, n) = (1.0, 0.0, 3)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of sublists, each sublist corresponding to a test case in the order above and containing the four floating-point values $\\left[\\|E_{\\Psi}\\|_{L^2}, \\|E_{\\Psi}\\|_{L^{\\infty}}, \\|E_{\\tau}\\|_{L^2}, \\|E_{\\tau}\\|_{L^{\\infty}}\\right]$. Enclose the entire output in square brackets. For example: $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]]$. Each floating-point value should be rounded to $12$ significant digits. No physical units are required because all quantities are nondimensional.",
            "solution": "The problem requires the verification of a log-conformation implementation for the Oldroyd-B viscoelastic fluid model. This is achieved by comparing numerically computed quantities against their known analytical solutions in a spatially periodic simple shear flow. The verification is conducted in a kinematic setting where advection is absent, allowing for a pointwise comparison with the homogeneous simple shear solution.\n\n### 1. Analytical Formulation\n\nFirst, we establish the analytical forms for the physical quantities involved.\n\nThe flow is two-dimensional with a velocity field given by $\\boldsymbol{u}(y) = (U \\sin(2 \\pi n y), 0)$, defined over the domain $y \\in [0,1]$. Here, $U$ is a constant velocity amplitude, and $n$ is a positive integer representing the number of spatial periods. The flow is a simple shear flow with a spatially varying shear rate. The velocity gradient tensor $\\nabla \\boldsymbol{u}(y)$ is non-zero only in its $u_x$ gradient with respect to $y$:\n$$\n\\nabla \\boldsymbol{u}(y) = \\begin{pmatrix} 0  \\dfrac{\\partial u_x}{\\partial y} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}(y) \\\\ 0  0 \\end{pmatrix}\n$$\nwhere the local shear rate $\\dot{\\gamma}(y)$ is\n$$\n\\dot{\\gamma}(y) = 2 \\pi n U \\cos(2 \\pi n y).\n$$\nThe local intensity of the viscoelastic effects is characterized by the Weissenberg number, defined as the product of the polymer relaxation time $\\lambda$ and the local shear rate:\n$$\nWi(y) = \\lambda \\dot{\\gamma}(y) = 2 \\pi n U \\lambda \\cos(2 \\pi n y).\n$$\nThe problem states that the steady-state conformation tensor $\\boldsymbol{A}(y)$ is governed by the algebraic balance equation derived from the upper-convected Maxwell model (which is the basis for the Oldroyd-B model) in the absence of material transport:\n$$\n\\nabla \\boldsymbol{u}(y)\\, \\boldsymbol{A}(y) + \\boldsymbol{A}(y)\\, \\nabla \\boldsymbol{u}(y)^{\\mathsf{T}} = \\dfrac{1}{\\lambda}\\left(\\boldsymbol{A}(y) - \\boldsymbol{I}\\right).\n$$\nSolving this system of algebraic equations for the components of the symmetric tensor $\\boldsymbol{A}(y)$ yields the analytical solution provided in the problem statement:\n$$\n\\boldsymbol{A}(y) = \\begin{pmatrix} 1 + 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  1 \\end{pmatrix}.\n$$\nThis tensor is symmetric and positive definite for all real values of $Wi(y)$, as its determinant is $\\det(\\boldsymbol{A}(y)) = (1 + 2 Wi(y)^2)(1) - Wi(y)^2 = 1 + Wi(y)^2  0$ and its trace is $\\mathrm{Tr}(\\boldsymbol{A}(y)) = 1 + 2 Wi(y)^2 + 1 = 2 + 2 Wi(y)^2  0$.\n\nGiven that the nondimensional polymer modulus is unity, the polymeric extra stress tensor $\\boldsymbol{\\tau}_p(y)$ is the deviatoric part of the conformation tensor. However, the problem defines it simply as $\\boldsymbol{\\tau}_p(y) = \\boldsymbol{A}(y) - \\boldsymbol{I}$. This is a common simplification in contexts where the total stress is of primary interest. Thus, the reference polymeric stress is:\n$$\n\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y) = \\boldsymbol{A}(y) - \\boldsymbol{I} = \\begin{pmatrix} 2\\, Wi(y)^2  Wi(y) \\\\ Wi(y)  0 \\end{pmatrix}.\n$$\nThe final analytical quantity to derive is the log-conformation tensor $\\boldsymbol{\\Psi}(y) = \\log\\boldsymbol{A}(y)$. The matrix logarithm of a diagonalizable matrix $\\boldsymbol{A} = \\boldsymbol{Q} \\Lambda \\boldsymbol{Q}^{\\mathsf{T}}$ (where $\\Lambda$ is the diagonal matrix of eigenvalues and $\\boldsymbol{Q}$ is the matrix of corresponding eigenvectors) is given by $\\log\\boldsymbol{A} = \\boldsymbol{Q} (\\log\\Lambda) \\boldsymbol{Q}^{\\mathsf{T}}$. The eigenvalues $\\alpha_{1,2}$ of $\\boldsymbol{A}(y)$ are the roots of the characteristic equation $\\det(\\boldsymbol{A} - \\alpha\\boldsymbol{I}) = 0$, which are:\n$$\n\\alpha_{1,2}(y) = (1+Wi(y)^2) \\pm |Wi(y)|\\sqrt{1+Wi(y)^2}.\n$$\nUsing Sylvester's formula for matrix functions, the logarithm of a $2 \\times 2$ matrix $\\boldsymbol{M}$ can be expressed as:\n$$\n\\log \\boldsymbol{M} = C_1 (\\boldsymbol{M} - C_2 \\boldsymbol{I}) + C_3 \\boldsymbol{I}\n$$\nfor matrix-dependent scalars $C_1, C_2, C_3$. Applying this to $\\boldsymbol{A}(y)$, we find the analytical expression for $\\boldsymbol{\\Psi}(y)$:\n$$\n\\boldsymbol{\\Psi}(y) = \\frac{\\mathrm{arsinh}(|Wi(y)|)}{|Wi(y)|\\sqrt{1+Wi(y)^2}} \\left( \\boldsymbol{A}(y) - (1+Wi(y)^2)\\boldsymbol{I} \\right) + \\frac{1}{2}\\log(1+Wi(y)^2)\\boldsymbol{I}.\n$$\nThis expression is numerically well-behaved and tends to the zero matrix $\\boldsymbol{0}$ as $Wi(y) \\to 0$, consistent with $\\log\\boldsymbol{I} = \\boldsymbol{0}$. This derived form provides a theoretical basis, but the reference calculation will use direct numerical spectral decomposition as per the problem specification.\n\n### 2. Numerical Verification and Error Quantification\n\nThe verification procedure involves comparing results from two computational approaches for the matrix logarithm and exponential, and quantifying the discrepancy. A uniform grid of $N=1001$ points $\\{y_j\\}$ is defined on the interval $[0,1]$. For each grid point and each test case $(\\lambda, U, n)$:\n\n1.  **Analytical Tensors**: The local Weissenberg number $Wi(y_j)$ is computed. This is used to construct the analytical conformation tensor $\\boldsymbol{A}(y_j)$ and the reference polymeric extra stress $\\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y_j)$.\n\n2.  **Reference Log-Conformation ($\\boldsymbol{\\Psi}_{\\mathrm{ref}}$)**: The reference log-conformation $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j)$ is obtained by numerically performing a spectral decomposition of $\\boldsymbol{A}(y_j)$. Specifically, we compute its eigenvalues $\\alpha_1, \\alpha_2$ and eigenvector matrix $\\boldsymbol{Q}$. Then, $\\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j) = \\boldsymbol{Q} \\, \\mathrm{diag}(\\log\\alpha_1, \\log\\alpha_2) \\, \\boldsymbol{Q}^{\\mathsf{T}}$.\n\n3.  **Implementation Log-Conformation and Reconstruction**:\n    - The \"implementation\" log-conformation $\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j)$ is computed by applying a general-purpose matrix logarithm function (e.g., `scipy.linalg.logm`) directly to $\\boldsymbol{A}(y_j)$.\n    - The conformation tensor is then reconstructed using the matrix exponential function (e.g., `scipy.linalg.expm`): $\\boldsymbol{A}_{\\mathrm{impl}}(y_j) = \\exp(\\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j))$.\n    - The corresponding implementation stress is $\\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y_j) = \\boldsymbol{A}_{\\mathrm{impl}}(y_j) - \\boldsymbol{I}$.\n\n4.  **Error Calculation**: The purpose of this procedure is to quantify the numerical errors inherent in the round-trip operation $\\exp(\\log(\\boldsymbol{A}))$ and the direct computation of $\\log(\\boldsymbol{A})$.\n    - The log-conformation error is $E_{\\Psi}(y_j) = \\boldsymbol{\\Psi}_{\\mathrm{impl}}(y_j) - \\boldsymbol{\\Psi}_{\\mathrm{ref}}(y_j)$.\n    - The stress error is $E_{\\tau}(y_j) = \\boldsymbol{\\tau}_{p,\\mathrm{impl}}(y_j) - \\boldsymbol{\\tau}_{p,\\mathrm{ref}}(y_j)$.\n\n5.  **Norms**: The discrepancies are quantified using discrete approximations of the $L^2$ and $L^{\\infty}$ norms over the grid.\n    - The $L^2$ norm of the error field, e.g., $E_{\\Psi}$, is the root mean square of its Frobenius norm $\\| \\cdot \\|_F$ over the grid:\n      $$ \\|E_{\\Psi}\\|_{L^2} = \\left( \\dfrac{1}{N} \\sum_{j=1}^{N} \\|E_{\\Psi}(y_j)\\|_F^2 \\right)^{1/2} $$\n    - The $L^{\\infty}$ norm is the maximum Frobenius norm found on the grid:\n      $$ \\|E_{\\Psi}\\|_{L^{\\infty}} = \\max_{1 \\le j \\le N} \\|E_{\\Psi}(y_j)\\|_F $$\n    The same definitions apply to the stress error $E_{\\tau}$.\n\nThe implementation will perform these calculations for each test case and report the four resulting error norms. This procedure stringently tests the accuracy and stability of the numerical matrix functions, which is a critical step in validating software for computational fluid dynamics.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes error norms for a log-conformation implementation in a \n    viscoelastic flow problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.1, 0.2, 1),  # Case 1: (lambda, U, n)\n        (1.0, 0.5, 1),  # Case 2\n        (2.0, 1.0, 1),  # Case 3\n        (1.0, 0.0, 3),  # Case 4 (edge case)\n    ]\n\n    N = 1001\n    y_grid = np.linspace(0.0, 1.0, N)\n    \n    all_results = []\n\n    for case in test_cases:\n        lam, U, n = case\n\n        # 1. Compute analytical quantities over the grid\n        \n        # Local shear rate and Weissenberg number\n        dot_gamma = 2.0 * np.pi * n * U * np.cos(2.0 * np.pi * n * y_grid)\n        Wi = lam * dot_gamma\n\n        # Analytical conformation tensor A(y) (N, 2, 2)\n        A = np.zeros((N, 2, 2))\n        A[:, 0, 0] = 1.0 + 2.0 * Wi**2\n        A[:, 0, 1] = Wi\n        A[:, 1, 0] = Wi\n        A[:, 1, 1] = 1.0\n\n        # Reference polymeric extra stress tau_p_ref(y)\n        tau_p_ref = A - np.identity(2)\n\n        # 2. Compute reference log-conformation Psi_ref(y) via spectral decomposition\n        eigvals, eigvecs = np.linalg.eigh(A)\n\n        # Ensure eigenvalues are positive before taking log\n        # For SPD matrices, eigh guarantees real eigenvalues, which should be positive here.\n        log_eigvals = np.log(eigvals)\n        \n        # Reconstruct log(Lambda) as a stack of diagonal matrices\n        log_Lambda = np.zeros((N, 2, 2))\n        log_Lambda[:, 0, 0] = log_eigvals[:, 0]\n        log_Lambda[:, 1, 1] = log_eigvals[:, 1]\n        \n        # Psi_ref = Q * log(Lambda) * Q^T\n        Psi_ref = eigvecs @ log_Lambda @ np.transpose(eigvecs, (0, 2, 1))\n\n        # 3. Compute implementation-based quantities\n        # Scipy linalg functions do not operate on stacks of matrices, so we must loop.\n        Psi_impl = np.array([linalg.logm(A[j]) for j in range(N)])\n        \n        # Handle potential small imaginary parts from numerical error in logm\n        if np.iscomplexobj(Psi_impl):\n            Psi_impl = Psi_impl.real\n            \n        A_impl = np.array([linalg.expm(Psi_impl[j]) for j in range(N)])\n        tau_p_impl = A_impl - np.identity(2)\n\n        # 4. Compute error fields\n        E_Psi = Psi_impl - Psi_ref\n        E_tau = tau_p_impl - tau_p_ref\n        \n        # 5. Compute error norms\n        # Frobenius norm ||M||_F = sqrt(sum(M_ij^2))\n        # We compute ||E(y_j)||_F for each point j\n        \n        E_Psi_F = np.linalg.norm(E_Psi, ord='fro', axis=(1, 2))\n        E_tau_F = np.linalg.norm(E_tau, ord='fro', axis=(1, 2))\n\n        # L2 norm: sqrt( mean( ||E(y_j)||_F^2 ) )\n        L2_E_Psi = np.sqrt(np.mean(E_Psi_F**2))\n        L2_E_tau = np.sqrt(np.mean(E_tau_F**2))\n\n        # Linf norm: max( ||E(y_j)||_F )\n        Linf_E_Psi = np.max(E_Psi_F)\n        Linf_E_tau = np.max(E_tau_F)\n\n        # Append results for this test case\n        case_results = [L2_E_Psi, Linf_E_Psi, L2_E_tau, Linf_E_tau]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Format each float to 12 significant digits using the 'g' specifier.\n    result_str = ','.join(\n        '[' + ','.join(format(val, '.12g') for val in res) + ']'\n        for res in all_results\n    )\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}