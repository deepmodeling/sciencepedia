{
    "hands_on_practices": [
        {
            "introduction": "The High Weissenberg Number Problem begins, naturally, with the Weissenberg number, $Wi$. This first exercise  has you construct this fundamental dimensionless group from first principles. By comparing a fluid's intrinsic relaxation time to the timescale of deformation, you will gain a physical intuition for how to quantify elasticity and identify flows where the HWNP is likely to manifest.",
            "id": "4107561",
            "problem": "An incompressible viscoelastic fluid with a single relaxation time parameter is subjected to a steady simple shear flow. The imposed shear rate is constant and denoted by $\\dot{\\gamma}$, and the fluid’s relaxation time is $\\lambda=0.5\\,\\mathrm{s}$. Starting from the definition of relaxation time as the characteristic decay time of stress and the observation that a simple shear at rate $\\dot{\\gamma}$ imposes a deformation with characteristic timescale $1/\\dot{\\gamma}$, use dimensional reasoning to construct the dimensionless group that quantifies the relative importance of elastic memory to the timescale of the imposed deformation. Identify this group with the Weissenberg number ($Wi$) and evaluate it for $\\dot{\\gamma}=10\\,\\mathrm{s}^{-1}$. Then, using the conceptual relationship between the Weissenberg number ($Wi$) and the Deborah number ($De$) in steady flows, discuss whether the computed value is likely to fall within the regime where the High Weissenberg Number Problem (HWNP) can manifest in numerical simulations of Oldroyd-type constitutive models. Express your final numerical value for the Weissenberg number as a dimensionless number with no units. No rounding is required.",
            "solution": "The task is to construct, from first principles, the appropriate dimensionless measure that captures the competition between the fluid’s elastic memory and the timescale of the imposed deformation in a simple shear flow. The fluid possesses a relaxation time $\\lambda$, which by definition is the characteristic time over which stresses relax due to the microstructural elasticity of the fluid (for example, polymer coil stretch and recoil). The imposed flow is a steady simple shear with constant shear rate $\\dot{\\gamma}$, which sets a characteristic kinematic timescale for deformation.\n\nFor simple shear at rate $\\dot{\\gamma}$, the characteristic timescale of deformation is the inverse of the shear rate. Specifically,\n$$\nt_{\\text{flow}} = \\frac{1}{\\dot{\\gamma}}.\n$$\nThis follows from dimensional analysis, since $\\dot{\\gamma}$ has dimensions of $\\mathrm{s}^{-1}$, and the natural time associated with a rate is the reciprocal of that rate.\n\nThe dimensionless group that compares the material’s memory time to the flow timescale is constructed as the ratio of the relaxation time to the deformation timescale:\n$$\n\\frac{\\lambda}{t_{\\text{flow}}}.\n$$\nSubstituting $t_{\\text{flow}} = 1/\\dot{\\gamma}$ gives\n$$\n\\frac{\\lambda}{t_{\\text{flow}}} = \\lambda \\dot{\\gamma}.\n$$\nThis dimensionless quantity is identified as the Weissenberg number, written as\n$$\nWi = \\lambda \\dot{\\gamma}.\n$$\n\nGiven the numerical values $\\lambda=0.5\\,\\mathrm{s}$ and $\\dot{\\gamma}=10\\,\\mathrm{s}^{-1}$, we compute\n$$\nWi = \\lambda \\dot{\\gamma} = (0.5\\,\\mathrm{s})(10\\,\\mathrm{s}^{-1}) = 5.\n$$\n\nTo contextualize this with the Deborah number ($De$), recall that in steady flows the Deborah number, defined as the ratio of the relaxation time to an imposed or observational timescale $T$, becomes\n$$\nDe = \\frac{\\lambda}{T}.\n$$\nIf one chooses $T$ to be the deformation timescale $t_{\\text{flow}}=1/\\dot{\\gamma}$ appropriate to steady simple shear, then\n$$\nDe = \\frac{\\lambda}{1/\\dot{\\gamma}} = \\lambda \\dot{\\gamma} = Wi.\n$$\nThus, in steady simple shear, $De$ and $Wi$ are equal.\n\nRegarding the High Weissenberg Number Problem (HWNP), which refers to numerical instabilities and loss of convergence arising in computational rheology at large elastic effects (often manifesting in Oldroyd-type models such as the Upper-Convected Maxwell model and the Oldroyd-B model), the onset of difficulties is commonly reported when $Wi$ exceeds an order-one threshold, with practical breakdowns frequently occurring for $Wi$ in the range of $\\mathcal{O}(1)$ to $\\mathcal{O}(10)$ depending on geometry, boundary conditions, and numerical method. With $Wi=5$, the flow is clearly in a regime where elastic effects are significant ($Wi1$), and it is plausible that standard formulations without stabilization (for example, without log-conformation transformations or appropriate high-resolution schemes) may encounter HWNP-related issues. Therefore, while $Wi=5$ may not be “extremely high,” it lies within a range that is often challenging for naive numerical schemes and warrants stabilized algorithms and careful mesh/temporal resolution.\n\nThe requested final numeric value is the Weissenberg number:\n$$\nWi = 5.\n$$",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "Now that we can quantify elasticity using the Weissenberg number, this practice explores the analytical origin of the HWNP. By solving the Oldroyd-B model equations for a simple shear flow, you will derive the exact relationship between stress and $Wi$. This exercise  is critical as it reveals the unbounded growth of elastic stresses, the fundamental physical mechanism that numerical methods struggle to capture.",
            "id": "4107507",
            "problem": "A dilute polymer solution is modeled by the Oldroyd-B constitutive equation in its kinetic-theory form. The polymeric extra-stress tensor is related to the conformation tensor by $\\boldsymbol{\\tau}_{p} = G \\left( \\boldsymbol{A} - \\boldsymbol{I} \\right)$, where $G$ is the polymer elastic modulus and $\\boldsymbol{I}$ is the identity tensor. The conformation tensor $\\boldsymbol{A}$ obeys the upper-convected evolution equation $\\overset{\\triangledown}{\\boldsymbol{A}} = - \\frac{1}{\\lambda} \\left( \\boldsymbol{A} - \\boldsymbol{I} \\right)$, where $\\lambda$ is the polymer relaxation time and $\\overset{\\triangledown}{(\\cdot)}$ denotes the upper-convected derivative. Consider a homogeneous, steady simple shear flow with velocity field $\\boldsymbol{v} = \\left( \\dot{\\gamma} y, 0, 0 \\right)$, where $\\dot{\\gamma}$ is the constant shear rate. Using only these base definitions and fundamental tensor calculus, derive the analytic expression for the steady-state polymer shear stress component $\\tau_{p,12}$ and, in terms of the Weissenberg number $\\mathrm{Wi} = \\lambda \\dot{\\gamma}$, argue how $\\tau_{p,12}$ scales with $\\mathrm{Wi}$ in this flow. Provide your final result as a closed-form analytic expression for $\\tau_{p,12}$ in terms of $G$ and $\\mathrm{Wi}$. No numerical evaluation is required. State your answer as an expression without units.",
            "solution": "The problem requires the derivation of the steady-state polymer shear stress $\\tau_{p,12}$. This begins with solving the evolution equation for the conformation tensor $\\boldsymbol{A}$ under the specified flow conditions.\n\nThe upper-convected derivative of a tensor $\\boldsymbol{A}$ is defined as $\\overset{\\triangledown}{\\boldsymbol{A}} = \\frac{D\\boldsymbol{A}}{Dt} - \\boldsymbol{L}\\boldsymbol{A} - \\boldsymbol{A}\\boldsymbol{L}^{T}$, where $\\frac{D\\boldsymbol{A}}{Dt}$ is the material derivative and $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$ is the velocity gradient tensor. For a steady ($\\frac{\\partial}{\\partial t} = 0$) and homogeneous ($\\nabla \\boldsymbol{A} = \\boldsymbol{0}$) flow, the material derivative $\\frac{D\\boldsymbol{A}}{Dt}$ vanishes. The evolution equation simplifies to:\n$$\n- \\boldsymbol{L}\\boldsymbol{A} - \\boldsymbol{A}\\boldsymbol{L}^{T} = - \\frac{1}{\\lambda} \\left( \\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\nRearranging gives the algebraic equation for the steady-state conformation tensor:\n$$\n\\boldsymbol{A} - \\boldsymbol{I} = \\lambda \\left( \\boldsymbol{L}\\boldsymbol{A} + \\boldsymbol{A}\\boldsymbol{L}^{T} \\right)\n$$\nFor the simple shear flow $\\boldsymbol{v} = \\left( \\dot{\\gamma} y, 0, 0 \\right)$, the velocity gradient tensor $\\boldsymbol{L}$ and its transpose $\\boldsymbol{L}^{T}$ are:\n$$\n\\boldsymbol{L} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad \\boldsymbol{L}^{T} = \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nWe write the algebraic equation in component form, using the Weissenberg number $\\mathrm{Wi} = \\lambda \\dot{\\gamma}$. The tensor $\\boldsymbol{A}$ is symmetric ($A_{ij} = A_{ji}$).\n\\begin{align*}\nA_{11} - 1 = \\lambda (2 L_{12} A_{12}) = \\lambda(2\\dot{\\gamma}A_{12}) = 2\\mathrm{Wi}A_{12} \\\\\nA_{12}     = \\lambda (L_{12} A_{22}) = \\lambda(\\dot{\\gamma}A_{22}) = \\mathrm{Wi}A_{22} \\\\\nA_{22} - 1 = 0 \\implies A_{22} = 1\n\\end{align*}\nOther components like $A_{33}$, $A_{13}$, and $A_{23}$ can be shown to be $1$, $0$, and $0$, respectively. Substituting $A_{22}=1$ into the equation for $A_{12}$ yields:\n$$\nA_{12} = \\mathrm{Wi} \\cdot 1 = \\mathrm{Wi}\n$$\nThe polymer extra-stress tensor is given by $\\boldsymbol{\\tau}_{p} = G \\left( \\boldsymbol{A} - \\boldsymbol{I} \\right)$. We are interested in the shear component $\\tau_{p,12}$:\n$$\n\\tau_{p,12} = G (A_{12} - I_{12}) = G (A_{12} - 0) = G A_{12}\n$$\nSubstituting our result for $A_{12}$, we arrive at the final expression for the polymer shear stress:\n$$\n\\tau_{p,12} = G \\, \\mathrm{Wi}\n$$\nThis result shows that in steady simple shear, the polymer shear stress predicted by the Oldroyd-B model grows linearly and without bound with the Weissenberg number.",
            "answer": "$$\n\\boxed{G \\, \\mathrm{Wi}}\n$$"
        },
        {
            "introduction": "The unbounded stress growth explored analytically has direct and severe consequences for numerical simulations. This hands-on coding problem  addresses a primary numerical failure mode: the violation of the Symmetric Positive Definite (SPD) constraint on the conformation tensor. You will implement a routine to detect this unphysical state and apply a correction, a fundamental technique for stabilizing viscoelastic flow solvers at high $Wi$.",
            "id": "4107555",
            "problem": "Consider the evolution of the polymer conformation tensor $\\mathbf{A}$ in a homogeneous flow field, governed by the upper-convected derivative form of the Oldroyd-B model without advection. The Weissenberg number quantifies elasticity as $\\mathrm{We} = \\lambda U / L$, where $\\lambda$ is a relaxation time, $U$ is a characteristic velocity, and $L$ is a characteristic length. In nondimensional and spatially homogeneous conditions, the conformation tensor $\\mathbf{A}$ obeys the continuous-time evolution equation\n$$\n\\frac{\\mathrm{d}\\mathbf{A}}{\\mathrm{d}t} - \\mathbf{L}\\mathbf{A} - \\mathbf{A}\\mathbf{L}^{\\top} = -\\frac{1}{\\mathrm{We}}\\left(\\mathbf{A} - \\mathbf{I}\\right),\n$$\nwhere $\\mathbf{L}$ is the nondimensional velocity gradient tensor and $\\mathbf{I}$ is the identity tensor. The physically admissible conformation tensor must be Symmetric Positive Definite (SPD), meaning $\\mathbf{A} = \\mathbf{A}^{\\top}$ and all eigenvalues of $\\mathbf{A}$ are strictly positive.\n\nA first-order explicit Euler time discretization for a single step of size $\\Delta t$ gives the discrete update\n$$\n\\mathbf{A}^{n+1} = \\mathbf{A}^{n} + \\Delta t \\left( \\mathbf{L}\\mathbf{A}^{n} + \\mathbf{A}^{n}\\mathbf{L}^{\\top} - \\frac{1}{\\mathrm{We}}\\left(\\mathbf{A}^{n} - \\mathbf{I}\\right) \\right).\n$$\nThis naive discretization can violate the SPD condition when $\\mathrm{We}$ is large and/or $\\Delta t$ is large, producing unphysical states.\n\nYour task is to implement the following, starting from the above discrete update and the mathematical definition of Symmetric Positive Definite matrices:\n\n- Construct a test to verify the SPD condition at each time step by checking:\n  1. Symmetry within a tolerance $\\tau$ via the matrix norm of the skew-symmetric part.\n  2. Positivity of eigenvalues via the minimum eigenvalue exceeding a threshold $\\delta$.\n- When the SPD condition is violated, apply a correction strategy that produces the nearest SPD matrix (in the Frobenius norm sense) by:\n  1. Symmetrizing the tensor by $\\mathbf{B} = \\frac{1}{2}\\left(\\mathbf{A} + \\mathbf{A}^{\\top}\\right)$.\n  2. Computing the spectral decomposition $\\mathbf{B} = \\mathbf{Q}\\boldsymbol{\\Lambda}\\mathbf{Q}^{\\top}$ with $\\mathbf{Q}$ orthogonal and $\\boldsymbol{\\Lambda}$ diagonal.\n  3. Clipping eigenvalues below $\\delta$ by replacing $\\lambda_i$ with $\\max(\\lambda_i, \\delta)$.\n  4. Reconstructing $\\mathbf{A}_{\\mathrm{corr}} = \\mathbf{Q}\\boldsymbol{\\Lambda}_{\\mathrm{clipped}}\\mathbf{Q}^{\\top}$.\n\nImplement a program that:\n- Initializes $\\mathbf{A}^{0} = \\mathbf{I}$.\n- For each test case, iterates the explicit update for $N$ steps, applies the SPD test at each step, corrects when necessary, and records:\n  1. The total number of corrections applied over the $N$ steps as an integer.\n  2. The minimum over steps of the pre-correction minimum eigenvalue (a float).\n  3. The minimum over steps of the post-correction minimum eigenvalue (a float).\n\nAll quantities are nondimensional; no physical units are required. Angles are not used. All reported numeric outputs must be standard floating-point values.\n\nUse the following test suite (each test case supplies $\\mathbf{L}$ as a $3 \\times 3$ matrix, $\\mathrm{We}$ as a positive scalar, $\\Delta t$ as a positive scalar, $N$ as a positive integer number of steps, and SPD tolerances $\\tau$ and $\\delta$ as positive scalars):\n\n- Test case $ 1 $ (happy path, moderate elasticity and small time step):\n  - $\\mathbf{L} = \\mathrm{diag}(1.0, -0.5, -0.5)$.\n  - $\\mathrm{We} = 1.0$.\n  - $\\Delta t = 0.01$.\n  - $N = 20$.\n  - $\\tau = 10^{-12}$.\n  - $\\delta = 10^{-10}$.\n- Test case $ 2 $ (boundary case, larger elasticity and moderate time step):\n  - $\\mathbf{L} = \\begin{bmatrix} 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\\\ -1.0  0.0  0.0 \\end{bmatrix}$.\n  - $\\mathrm{We} = 10.0$.\n  - $\\Delta t = 0.05$.\n  - $N = 20$.\n  - $\\tau = 10^{-12}$.\n  - $\\delta = 10^{-10}$.\n- Test case $ 3 $ (edge case, severe elasticity and large time step):\n  - $\\mathbf{L} = \\mathrm{diag}(2.0, -1.0, -1.0)$.\n  - $\\mathrm{We} = 50.0$.\n  - $\\Delta t = 0.2$.\n  - $N = 10$.\n  - $\\tau = 10^{-12}$.\n  - $\\delta = 10^{-10}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a three-element list $[n_{\\mathrm{corr}}, m_{\\mathrm{pre}}, m_{\\mathrm{post}}]$ with:\n- $n_{\\mathrm{corr}}$: total number of corrections applied over $N$ steps (an integer),\n- $m_{\\mathrm{pre}}$: minimum pre-correction eigenvalue over steps (a float),\n- $m_{\\mathrm{post}}$: minimum post-correction eigenvalue over steps (a float).\n\nFor example, the output format must look like $[[n_1,m_1^{\\mathrm{pre}},m_1^{\\mathrm{post}}],[n_2,m_2^{\\mathrm{pre}},m_2^{\\mathrm{post}}],[n_3,m_3^{\\mathrm{pre}},m_3^{\\mathrm{post}}]]$ with no additional text.",
            "solution": "The objective is to simulate the time evolution of a polymer conformation tensor, $\\mathbf{A}$, using a first-order explicit Euler method for the Oldroyd-B model. This numerical scheme is known to be unstable at high Weissenberg numbers ($\\mathrm{We}$) or for large time steps ($\\Delta t$), potentially violating the physical constraint that $\\mathbf{A}$ must be a Symmetric Positive Definite (SPD) matrix. The task involves implementing a numerical algorithm that iterates the solution in time, checks for violation of the SPD property at each step, and applies a specific correction procedure when a violation occurs. The algorithm's performance will be quantified by tracking the number of corrections and the minimum eigenvalues observed before and after the correction procedure.\n\nThe evolution of the conformation tensor $\\mathbf{A}$ in a spatially homogeneous flow is governed by:\n$$\n\\frac{\\mathrm{d}\\mathbf{A}}{\\mathrm{d}t} = \\mathbf{L}\\mathbf{A} + \\mathbf{A}\\mathbf{L}^{\\top} - \\frac{1}{\\mathrm{We}}\\left(\\mathbf{A} - \\mathbf{I}\\right)\n$$\nwhere $\\mathbf{L}$ is the velocity gradient tensor, $\\mathrm{We}$ is the Weissenberg number, and $\\mathbf{I}$ is the identity tensor.\n\nThe algorithm to be implemented is as follows:\n\n1.  **Initialization**: For each test case, we start with the polymer at equilibrium, so the conformation tensor is initialized to the identity matrix, $\\mathbf{A}^0 = \\mathbf{I}$. We also initialize a counter for corrections, $n_{\\mathrm{corr}}$, to $0$, and variables to track the minimum pre-correction and post-correction eigenvalues, $m_{\\mathrm{pre}}$ and $m_{\\mathrm{post}}$, to positive infinity.\n\n2.  **Time Iteration**: We iterate for a total of $N$ time steps, from $n=0$ to $N-1$. In each step $n$, we perform the following sub-steps:\n\n    a. **Explicit Euler Update**: We compute a tentative conformation tensor for the next time step, $\\mathbf{A}_{\\mathrm{tent}}^{n+1}$, using the first-order explicit Euler discretization:\n    $$\n    \\mathbf{A}_{\\mathrm{tent}}^{n+1} = \\mathbf{A}^{n} + \\Delta t \\left( \\mathbf{L}\\mathbf{A}^{n} + \\mathbf{A}^{n}\\mathbf{L}^{\\top} - \\frac{1}{\\mathrm{We}}\\left(\\mathbf{A}^{n} - \\mathbf{I}\\right) \\right)\n    $$\n    \n    b. **SPD Condition Test**: We check if $\\mathbf{A}_{\\mathrm{tent}}^{n+1}$ satisfies the SPD condition. A matrix is SPD if it is symmetric and all its eigenvalues are positive. The test has two parts:\n        i. **Symmetry Check**: Analytically, if $\\mathbf{A}^n$ is symmetric, then $\\mathbf{A}_{\\mathrm{tent}}^{n+1}$ is also symmetric. However, floating-point arithmetic can introduce small asymmetries. We check this by computing the Frobenius norm of the skew-symmetric part of the tensor, $\\|\\frac{1}{2}(\\mathbf{A}_{\\mathrm{tent}}^{n+1} - (\\mathbf{A}_{\\mathrm{tent}}^{n+1})^{\\top})\\|_F$. If this norm is greater than or equal to a given tolerance $\\tau$, the symmetry condition is considered violated.\n        ii. **Positive Definiteness Check**: We compute the eigenvalues of the symmetric part of $\\mathbf{A}_{\\mathrm{tent}}^{n+1}$. Let the minimum of these eigenvalues be $\\lambda_{\\min}^{\\mathrm{pre}}$. This value is recorded to update the overall minimum pre-correction eigenvalue, $m_{\\mathrm{pre}} = \\min(m_{\\mathrm{pre}}, \\lambda_{\\min}^{\\mathrm{pre}})$. If $\\lambda_{\\min}^{\\mathrm{pre}}$ is less than or equal to a given threshold $\\delta$, the positive definiteness condition is violated.\n\n    c. **Correction Procedure**: If either part of the SPD test fails, we apply a correction to find the nearest SPD matrix to $\\mathbf{A}_{\\mathrm{tent}}^{n+1}$ in the Frobenius norm sense.\n        i. Increment the correction counter, $n_{\\mathrm{corr}}$.\n        ii. Symmetrize the tensor: $\\mathbf{B} = \\frac{1}{2}(\\mathbf{A}_{\\mathrm{tent}}^{n+1} + (\\mathbf{A}_{\\mathrm{tent}}^{n+1})^{\\top})$.\n        iii. Compute the spectral decomposition of $\\mathbf{B}$ to obtain its eigenvalues $\\lambda_i$ and corresponding eigenvectors, which form the columns of an orthogonal matrix $\\mathbf{Q}$. This is expressed as $\\mathbf{B} = \\mathbf{Q}\\boldsymbol{\\Lambda}\\mathbf{Q}^{\\top}$, where $\\boldsymbol{\\Lambda}$ is the diagonal matrix of eigenvalues.\n        iv. Clip any eigenvalues below the threshold $\\delta$. A new diagonal matrix, $\\boldsymbol{\\Lambda}_{\\mathrm{clipped}}$, is formed with diagonal entries $\\lambda'_i = \\max(\\lambda_i, \\delta)$.\n        v. Reconstruct the corrected tensor: $\\mathbf{A}^{n+1} = \\mathbf{Q}\\boldsymbol{\\Lambda}_{\\mathrm{clipped}}\\mathbf{Q}^{\\top}$.\n        \n    d. **State Update**: If the SPD test passed, the state for the next step is simply the tentative one: $\\mathbf{A}^{n+1} = \\mathbf{A}_{\\mathrm{tent}}^{n+1}$. If the test failed, $\\mathbf{A}^{n+1}$ is the corrected tensor from the previous step.\n\n    e. **Post-Correction Analysis**: We find the minimum eigenvalue of the final tensor for the current step, $\\mathbf{A}^{n+1}$, denoted $\\lambda_{\\min}^{\\mathrm{post}}$. By construction, if a correction was applied, $\\lambda_{\\min}^{\\mathrm{post}}$ will be at least $\\delta$. This value is used to update the overall minimum post-correction eigenvalue for the simulation, $m_{\\mathrm{post}} = \\min(m_{\\mathrm{post}}, \\lambda_{\\min}^{\\mathrm{post}})$.\n\n3.  **Result Aggregation**: After $N$ steps, the final values of $n_{\\mathrm{corr}}$, $m_{\\mathrm{pre}}$, and $m_{\\mathrm{post}}$ are reported for the given test case. This entire process is repeated for all provided test cases.\n\nThis procedure rigorously enforces the physical constraints of the model while using a simple, but potentially unstable, time-stepping scheme, thereby demonstrating a practical approach to handling the High Weissenberg Number Problem in numerical simulations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Oldroyd-B conformation tensor evolution problem for a set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": np.diag([1.0, -0.5, -0.5]),\n            \"We\": 1.0,\n            \"dt\": 0.01,\n            \"N\": 20,\n            \"tau\": 1e-12,\n            \"delta\": 1e-10,\n        },\n        {\n            \"L\": np.array([[0.0, 1.0, 0.0], [0.0, 0.0, 1.0], [-1.0, 0.0, 0.0]]),\n            \"We\": 10.0,\n            \"dt\": 0.05,\n            \"N\": 20,\n            \"tau\": 1e-12,\n            \"delta\": 1e-10,\n        },\n        {\n            \"L\": np.diag([2.0, -1.0, -1.0]),\n            \"We\": 50.0,\n            \"dt\": 0.2,\n            \"N\": 10,\n            \"tau\": 1e-12,\n            \"delta\": 1e-10,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L = case[\"L\"]\n        We = case[\"We\"]\n        dt = case[\"dt\"]\n        N = case[\"N\"]\n        tau = case[\"tau\"]\n        delta = case[\"delta\"]\n\n        # Initialize conformation tensor and tracking variables\n        A = np.identity(3)\n        n_corr = 0\n        m_pre = float('inf')\n        m_post = float('inf')\n        I = np.identity(3)\n\n        for _ in range(N):\n            # 1. Explicit Euler update to get tentative A_n+1\n            rhs = L @ A + A @ L.T - (1.0 / We) * (A - I)\n            A_tent = A + dt * rhs\n\n            # 2. SPD condition test\n            # a. Symmetry check\n            skew_part = 0.5 * (A_tent - A_tent.T)\n            skew_norm = np.linalg.norm(skew_part, 'fro')\n            \n            # b. Positive definiteness check. Use symmetric part for eigenvalue calculation.\n            # Using eigvalsh is robust for numerically symmetric matrices.\n            A_symm = 0.5 * (A_tent + A_tent.T)\n            try:\n                eigvals_pre = np.linalg.eigvalsh(A_symm)\n                min_eig_pre = eigvals_pre.min()\n            except np.linalg.LinAlgError:\n                min_eig_pre = -float('inf')\n\n            m_pre = min(m_pre, min_eig_pre)\n\n            is_spd = (skew_norm  tau) and (min_eig_pre > delta)\n\n            # 3. Correction procedure if needed\n            if not is_spd:\n                n_corr += 1\n                \n                # Symmetrization is already done (A_symm).\n                # Spectral decomposition\n                try:\n                    eigvals, eigvecs = np.linalg.eigh(A_symm)\n                except np.linalg.LinAlgError:\n                    # If decomposition fails, default to a safe state\n                    A = I\n                    continue\n\n                # Clip eigenvalues\n                eigvals_clipped = np.maximum(eigvals, delta)\n                \n                # Reconstruct\n                A_new = eigvecs @ np.diag(eigvals_clipped) @ eigvecs.T\n            else:\n                A_new = A_tent\n\n            # Update state for next iteration\n            A = A_new\n            \n            # 4. Post-correction analysis\n            # Final A for this step is symmetric by construction\n            try:\n                min_eig_post = np.linalg.eigvalsh(A).min()\n            except np.linalg.LinAlgError:\n                min_eig_post = -float('inf')\n\n            m_post = min(m_post, min_eig_post)\n\n        results.append([n_corr, m_pre, m_post])\n        \n    # Format the final output string as per requirements\n    inner_strings = []\n    for res in results:\n        # Format: [int, float, float]\n        inner_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    final_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_string)\n\nsolve()\n```"
        }
    ]
}