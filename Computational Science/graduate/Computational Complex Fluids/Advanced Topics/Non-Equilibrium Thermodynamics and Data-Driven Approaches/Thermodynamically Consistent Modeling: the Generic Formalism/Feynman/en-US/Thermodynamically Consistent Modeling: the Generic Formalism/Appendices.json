{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any non-equilibrium theory is its ability to correctly reproduce equilibrium thermodynamics as a special case. This first exercise provides a fundamental check on the consistency of the GENERIC framework by connecting its dynamical structure to the variational principles of equilibrium. By first identifying an equilibrium state through the minimization of a Helmholtz free energy functional, you will then verify that this state is indeed a stationary solution of the GENERIC evolution equation, illustrating how the degeneracy conditions guarantee compatibility between dynamics and thermodynamics.",
            "id": "4109694",
            "problem": "Consider a scalar order parameter field $\\psi(\\mathbf{x})$ representing a coarse-grained composition fluctuation of a binary complex fluid on a periodic domain $\\Omega \\subset \\mathbb{R}^{d}$ with sufficiently smooth fields. Work at fixed absolute temperature $T>0$. Let the energy functional $E[\\psi]$ and the entropy functional $S[\\psi]$ be given by\n$$\nE[\\psi] \\equiv \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x}, \\qquad\nS[\\psi] \\equiv \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x},\n$$\nwhere $a>0$, $\\kappa>0$, $b>0$, $c>0$, and $s_{0}$ is a constant (which does not affect the minimization). The Helmholtz free energy functional is $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$.\n\nStart from first principles of the calculus of variations with periodic boundary conditions on $\\Omega$ and the thermodynamic structure of the General Equation for Non-Equilibrium Reversible-Irreversible Coupling (GENERIC). In GENERIC, the evolution of the coarse-grained state variable $\\psi$ is of the form\n$$\n\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi},\n$$\nwhere $L(\\psi)$ is an antisymmetric operator (generating reversible dynamics) and $M(\\psi)$ is a symmetric positive semidefinite operator (generating dissipative dynamics), with degeneracy conditions $L(\\psi)\\,\\frac{\\delta S}{\\delta \\psi} = 0$ and $M(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} = 0$.\n\nTasks:\n- Derive the Euler–Lagrange equation associated with minimizing $F[\\psi]$ over periodic $\\psi$, and use it together with the given sign conditions on $a$, $\\kappa$, $b$, and $c$ to determine the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ that minimizes $F[\\psi]$.\n- Using only the GENERIC structure stated above and the degeneracy conditions, verify that the $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ you found is a stationary solution of the GENERIC evolution equation at the fixed temperature $T$.\n\nExpress the final answer for the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ as a single closed-form analytic expression in terms of the parameters $a$, $b$, $c$, $\\kappa$, and $T$. No numerical evaluation or rounding is required. The final answer must be a single analytical expression.",
            "solution": "The solution consists of two parts. First, we determine the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ by minimizing the Helmholtz free energy functional $F[\\psi]$. Second, we verify that this equilibrium field is a stationary solution to the given GENERIC evolution equation.\n\n**Part 1: Minimization of the Helmholtz Free Energy**\n\nThe Helmholtz free energy functional is $F[\\psi] = E[\\psi] - T\\,S[\\psi]$. Substituting the given expressions:\n$$\nF[\\psi] = \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x} - T \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x}\n$$\nCombining terms, the integrand (the free energy density) is:\n$$\n\\mathcal{F}(\\psi, \\nabla\\psi) = \\left(\\frac{a + Tb}{2}\\right)\\psi^{2} + \\frac{Tc}{4}\\,\\psi^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} - T s_{0}\n$$\nTo find the global minimum of $F[\\psi]$, we examine the structure of the functional. Since all parameters ($a, b, c, \\kappa, T$) are positive:\n1. The gradient term $\\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2}$ is non-negative and is minimized (value 0) when $\\psi$ is spatially uniform, i.e., $\\psi(\\mathbf{x}) = \\psi_0$.\n2. For a uniform field, the potential term $V(\\psi_{0}) = \\left(\\frac{a + Tb}{2}\\right)\\psi_{0}^{2} + \\frac{Tc}{4}\\,\\psi_{0}^{4}$ is a globally convex function of $\\psi_0$ because the coefficients of both the $\\psi_0^2$ and $\\psi_0^4$ terms are positive. This function has a unique global minimum at $\\psi_0 = 0$.\n\nSince the spatially uniform field $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$ minimizes both the potential and gradient parts of the free energy integrand simultaneously, it is the global minimizer of $F[\\psi]$.\n\n**Part 2: Verification as a Stationary Solution in GENERIC**\n\nAn equilibrium state $\\psi_{\\mathrm{eq}}$ that minimizes the Helmholtz free energy must satisfy $\\frac{\\delta F}{\\delta \\psi}|_{\\psi_{\\mathrm{eq}}} = 0$. This implies:\n$$\n\\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} - T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = 0 \\implies \\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\n$$\nNow, we evaluate the GENERIC equation $\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi}$ at $\\psi_{\\mathrm{eq}}$:\n- The reversible term becomes $L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi} = L(\\psi_{\\mathrm{eq}})\\,(T \\frac{\\delta S}{\\delta \\psi}) = T(L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi})$. By the first degeneracy condition ($L\\,\\frac{\\delta S}{\\delta \\psi} = 0$), this term is zero.\n- The irreversible term is $M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}$. From the second degeneracy condition ($M\\,\\frac{\\delta E}{\\delta \\psi} = 0$), we have $M(\\psi_{\\mathrm{eq}})\\,(T \\frac{\\delta S}{\\delta \\psi}) = T(M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}) = 0$. Since $T>0$, this implies the irreversible term itself is zero.\n\nSince both the reversible and irreversible contributions to the dynamics vanish at $\\psi_{\\mathrm{eq}}$, we have $\\dot{\\psi}|_{\\psi=\\psi_{\\mathrm{eq}}} = 0$. This verifies that the equilibrium state $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$ is a stationary solution of the GENERIC equation.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "While equilibrium is a crucial reference point, much of physics happens in systems slightly perturbed from it. This practice delves into the realm of linear non-equilibrium thermodynamics, showing how the GENERIC structure naturally gives rise to Onsager's celebrated reciprocity relations. You will linearize the dissipative dynamics around an equilibrium point to derive the linear response matrix and confirm that the inherent symmetry of the GENERIC friction matrix $M$ directly implies the symmetry of the macroscopic transport coefficients.",
            "id": "4109648",
            "problem": "Consider a spatially homogeneous, isothermal coarse-grained description of a complex fluid within the General Equation for Non-Equilibrium Reversible-Irreversible Coupling (GENERIC) formalism. The slow variables are collected in the two-component state $x = (x_1, x_2)$, and their dynamics is assumed to be purely dissipative because the coarse-grained energy is independent of $x$, so the reversible part vanishes and the degeneracy conditions are trivially satisfied. The GENERIC dissipative evolution reads\n$$\n\\dot{x} = M(x)\\,\\nabla S(x),\n$$\nwhere $S(x)$ is the entropy and $M(x)$ is the symmetric, positive semi-definite friction matrix that enforces the Second Law. Assume the entropy has a strict maximum at equilibrium $x_{\\mathrm{eq}} = (0,0)$ and near equilibrium it is represented as a local quadratic form\n$$\nS(x) = S_{\\mathrm{eq}} - \\frac{1}{2}\\left(\\frac{x_1^2}{\\theta_1} + \\frac{x_2^2}{\\theta_2}\\right),\n$$\nwith $\\theta_1 > 0$ and $\\theta_2 > 0$, so that\n$$\n\\nabla S(x) = \\left(-\\frac{x_1}{\\theta_1},\\,-\\frac{x_2}{\\theta_2}\\right).\n$$\nSuppose the friction matrix has the form\n$$\nM(x) =\n\\begin{pmatrix}\n\\alpha + a\\,x_2^2 & b + c\\,x_1 x_2 \\\\\nb + c\\,x_1 x_2 & \\delta + d\\,x_1^2\n\\end{pmatrix},\n$$\nwith constants $\\alpha > 0$, $\\delta > 0$, $a \\ge 0$, $d \\ge 0$, and $b, c \\in \\mathbb{R}$ chosen such that $M(x)$ is symmetric and positive semi-definite in a neighborhood of $x_{\\mathrm{eq}}$ (e.g., $\\alpha \\delta - b^2 > 0$ at $x_{\\mathrm{eq}}$). Define the generalized thermodynamic force as $X(x) \\equiv \\nabla S(x)$ and the dissipative flux as $J(x) \\equiv \\dot{x}_{\\mathrm{diss}}(x)$, so that $J(x) = M(x) X(x)$.\n\nCompute the linear response matrix $\\mathcal{L}$ that relates $J$ to $X$ by $J = \\mathcal{L} X$ for small perturbations around equilibrium, i.e., evaluate $\\mathcal{L}$ at $x_{\\mathrm{eq}}$. Then, by explicit calculation, confirm the reciprocity relations (Onsager symmetry) for the linear response, namely that the off-diagonal elements of $\\mathcal{L}$ are equal. Express your final answer as a single matrix in symbolic form. No numerical approximation is required, and no units are needed.",
            "solution": "The GENERIC dissipative dynamics in the isothermal, purely dissipative setting is given by\n$$\n\\dot{x} = M(x)\\,\\nabla S(x).\n$$\nNear the entropy maximum at equilibrium $x_{\\mathrm{eq}} = (0,0)$, the entropy has the quadratic form\n$$\nS(x) = S_{\\mathrm{eq}} - \\frac{1}{2}\\left(\\frac{x_1^2}{\\theta_1} + \\frac{x_2^2}{\\theta_2}\\right),\n$$\nand thus its gradient (the generalized thermodynamic force) is\n$$\nX(x) \\equiv \\nabla S(x) = \\left(-\\frac{x_1}{\\theta_1},\\, -\\frac{x_2}{\\theta_2}\\right).\n$$\nThe dissipative flux is defined by\n$$\nJ(x) \\equiv \\dot{x}_{\\mathrm{diss}}(x) = M(x)\\,X(x).\n$$\nThe linear response matrix $\\mathcal{L}$ is the Jacobian that maps small forces to fluxes at equilibrium. Because the relation between $J$ and $X$ is linear in $X$ with coefficient $M(x)$, the linear response matrix is simply $M(x)$ evaluated at equilibrium:\n$$\n\\mathcal{L} = M(x_{\\mathrm{eq}}).\n$$\nWe therefore compute $M(x_{\\mathrm{eq}})$ by substituting $x_1 = 0$ and $x_2 = 0$ into $M(x)$:\n$$\nM(0,0) =\n\\begin{pmatrix}\n\\alpha + a\\,(0)^2 & b + c\\,(0)(0) \\\\\nb + c\\,(0)(0) & \\delta + d\\,(0)^2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha & b \\\\\nb & \\delta\n\\end{pmatrix}.\n$$\nThus, the linear response reads\n$$\nJ = \\mathcal{L}\\,X, \\quad \\text{with} \\quad \\mathcal{L} =\n\\begin{pmatrix}\n\\alpha & b \\\\\nb & \\delta\n\\end{pmatrix}.\n$$\nTo confirm reciprocity, i.e., Onsager symmetry, we compute the off-diagonal elements explicitly. The $(1,2)$ element of $\\mathcal{L}$ is\n$$\n\\mathcal{L}_{12} = b,\n$$\nand the $(2,1)$ element is\n$$\n\\mathcal{L}_{21} = b.\n$$\nTherefore,\n$$\n\\mathcal{L}_{12} - \\mathcal{L}_{21} = b - b = 0,\n$$\nwhich shows that the linear response matrix is symmetric, as required by reciprocity in the absence of microscopic time-reversal symmetry breaking. Since the construction of $M(x)$ in the GENERIC formalism imposes symmetry and positive semi-definiteness, the explicit evaluation around equilibrium yields a symmetric $\\mathcal{L}$, consistent with the reciprocity relations.\n\nTherefore, the linear response matrix is\n$$\n\\mathcal{L} =\n\\begin{pmatrix}\n\\alpha & b \\\\\nb & \\delta\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\alpha & b \\\\ b & \\delta\\end{pmatrix}}$$"
        },
        {
            "introduction": "Translating a continuous theory into a reliable computational model requires careful attention to its underlying mathematical structure. This final practice moves from pen-and-paper theory to the fundamentals of numerical implementation, focusing on how to build discrete operators that preserve the core geometric properties of the GENERIC formalism. You will construct matrix representations for the reversible and irreversible parts of the dynamics, ensuring they maintain the required antisymmetry and symmetric positive-semidefiniteness, respectively, which is the foundation of structure-preserving numerical methods.",
            "id": "4109668",
            "problem": "You are to design and implement a spatial discretization for a one-dimensional periodic complex fluid model within the General Equation for the Non-Equilibrium Reversible-Irreversible Coupling (GENERIC) formalism. The GENERIC structure evolves a state vector $\\mathbf{z}$ by\n$$\n\\dot{\\mathbf{z}} = \\mathbf{L}(\\mathbf{z}) \\nabla_{\\mathbf{z}} E(\\mathbf{z}) + \\mathbf{M}(\\mathbf{z}) \\nabla_{\\mathbf{z}} S(\\mathbf{z}),\n$$\nwhere $\\mathbf{L}$ is antisymmetric, $\\mathbf{M}$ is symmetric positive semidefinite, and the degeneracy conditions $\\mathbf{L}\\,\\nabla_{\\mathbf{z}} S = \\mathbf{0}$ and $\\mathbf{M}\\,\\nabla_{\\mathbf{z}} E = \\mathbf{0}$ hold. In this task, consider a single scalar field $\\phi(x,t)$ on a periodic domain of length $L_{\\text{dom}}$, with constant transport parameters: an advection speed $u$ and a mobility $\\kappa \\ge 0$. Your goal is to construct discrete operators $\\mathbf{L}_h$ and $\\mathbf{M}_h$ on a uniform grid of $N$ points that embody the reversible and irreversible couplings consistent with GENERIC, by enforcing the following properties:\n\n- Antisymmetry: $\\mathbf{L}_h^\\top = -\\mathbf{L}_h$.\n- Symmetry and positive semidefiniteness: $\\mathbf{M}_h^\\top = \\mathbf{M}_h$ and $\\mathbf{v}^\\top \\mathbf{M}_h \\mathbf{v} \\ge 0$ for all vectors $\\mathbf{v}$.\n\nStart from the following fundamental base and constraints:\n- Use the discrete analog of the periodic integration-by-parts identity (discrete summation-by-parts) on a uniform grid with spacing $h = L_{\\text{dom}}/N$ to guide the construction of consistent first and second derivative operators.\n- The reversible (Hamiltonian-like) advection part must be represented by a discrete first-derivative operator that is skew-adjoint under the standard Euclidean inner product so that the associated matrix is antisymmetric.\n- The irreversible (dissipative) diffusion part must be represented by a discrete second-derivative operator that is self-adjoint and negative semidefinite; multiplying by a nonnegative mobility yields a symmetric positive semidefinite metric operator.\n\nDesign the discretization in purely mathematical terms:\n- Choose a periodic, uniform grid with $N$ points and spacing $h$, and construct:\n  - A matrix $\\mathbf{D}_1$ that approximates the first derivative in space and satisfies $\\mathbf{D}_1^\\top = -\\mathbf{D}_1$.\n  - A matrix $\\mathbf{D}_2$ that approximates the second derivative in space and satisfies $\\mathbf{D}_2^\\top = \\mathbf{D}_2$ and has nonpositive eigenvalues.\n- Define $\\mathbf{L}_h$ by scaling the first-derivative operator by the advection speed $u$, and define $\\mathbf{M}_h$ by scaling the negative of the second-derivative operator by the mobility $\\kappa$:\n  $$\n  \\mathbf{L}_h = u\\,\\mathbf{D}_1,\\qquad \\mathbf{M}_h = \\kappa\\,\\left(-\\mathbf{D}_2\\right).\n  $$\n- Verify numerically, for each test case, that:\n  $$\n  \\|\\mathbf{L}_h + \\mathbf{L}_h^\\top\\|_F \\le \\varepsilon \\max\\{1,\\|\\mathbf{L}_h\\|_F\\},\\qquad\n  \\|\\mathbf{M}_h - \\mathbf{M}_h^\\top\\|_F \\le \\varepsilon \\max\\{1,\\|\\mathbf{M}_h\\|_F\\},\n  $$\n  and that the minimum eigenvalue of the symmetrized metric $\\frac{1}{2}(\\mathbf{M}_h+\\mathbf{M}_h^\\top)$ is greater than or equal to $-\\varepsilon$ for a tolerance $\\varepsilon$.\n\nImplementation requirements:\n- Use a one-dimensional periodic grid of $N$ points on a domain of length $L_{\\text{dom}} = 1$ with spacing $h = 1/N$.\n- Construct $\\mathbf{D}_1$ and $\\mathbf{D}_2$ so that they satisfy the structural properties above for any $N \\ge 3$. The constructions must be consistent with discrete summation-by-parts on the periodic grid.\n- Set the antisymmetric GENERIC operator $\\mathbf{L}_h$ and the symmetric positive semidefinite GENERIC operator $\\mathbf{M}_h$ according to the given $u$ and $\\kappa$.\n- For each test case, return a boolean indicating whether all three checks pass: antisymmetry of $\\mathbf{L}_h$, symmetry of $\\mathbf{M}_h$, and positive semidefiniteness of $\\mathbf{M}_h$.\n\nTest suite:\n- Use tolerance $\\varepsilon = 10^{-12}$.\n- Domain length $L_{\\text{dom}} = 1$.\n- The test cases are the tuples $(N, u, \\kappa)$:\n  - Case A: $(N, u, \\kappa) = (3, 1.7, 0.0)$.\n  - Case B: $(N, u, \\kappa) = (4, 0.0, 1.0)$.\n  - Case C: $(N, u, \\kappa) = (7, -2.0, 0.5)$.\n  - Case D: $(N, u, \\kappa) = (16, 3.3, 10^{-3})$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases A, B, C, D. Each entry must be a boolean indicating whether the three required properties hold for that case, for example: \"[True,False,True,True]\".",
            "solution": "The problem statement is valid. It presents a well-posed, scientifically grounded task within the field of computational thermodynamics of complex fluids. The objective is to design and implement a structure-preserving spatial discretization for a one-dimensional system described by the General Equation for a Non-Equilibrium Reversible-Irreversible Coupling (GENERIC). This requires the construction of discrete operators that maintain the fundamental geometric properties of the continuous model—namely, the antisymmetry of the reversible operator $\\mathbf{L}_h$ and the symmetric positive semidefiniteness of the irreversible operator $\\mathbf{M}_h$.\n\nThe design of these discrete operators, denoted $\\mathbf{L}_h$ and $\\mathbf{M}_h$, is based on the principle of discrete summation-by-parts on a periodic, uniform grid. This principle serves as the discrete analogue of integration-by-parts and ensures that the resulting numerical scheme respects the underlying conservation and dissipation laws of the continuous theory. We consider a scalar field $\\phi(x,t)$ discretized on a grid of $N$ points $\\{x_i = i h\\}_{i=0}^{N-1}$ with uniform spacing $h = L_{\\text{dom}}/N$. The field is represented by a vector $\\boldsymbol{\\phi} \\in \\mathbb{R}^N$ where $(\\boldsymbol{\\phi})_i = \\phi(x_i)$.\n\nFirst, we construct the discrete first-derivative operator, $\\mathbf{D}_1$, which forms the basis for the reversible part. The continuous first-derivative operator, $\\partial_x$, is skew-adjoint on a periodic domain with respect to the $L^2$ inner product. Consequently, its discrete counterpart, $\\mathbf{D}_1$, must be an antisymmetric matrix, i.e., $\\mathbf{D}_1^\\top = -\\mathbf{D}_1$. A standard second-order central difference scheme satisfies this requirement under periodic boundary conditions. The action of this operator on the discrete field $\\boldsymbol{\\phi}$ at grid point $i$ is given by:\n$$\n(\\mathbf{D}_1 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - \\phi_{i-1 \\pmod N}}{2h}\n$$\nThe resulting $N \\times N$ matrix $\\mathbf{D}_1$ is a circulant matrix with a main diagonal of zeros and off-diagonals with values $1/(2h)$ and $-1/(2h)$, correctly encoding the periodic connectivity. Its antisymmetry is evident from its structure. The reversible GENERIC operator $\\mathbf{L}_h$ is then defined as:\n$$\n\\mathbf{L}_h = u\\,\\mathbf{D}_1\n$$\nwhere $u$ is the advection speed. Since $u$ is a scalar, the antisymmetry of $\\mathbf{D}_1$ is directly inherited by $\\mathbf{L}_h$:\n$$\n\\mathbf{L}_h^\\top = (u\\,\\mathbf{D}_1)^\\top = u\\,\\mathbf{D}_1^\\top = u(-\\mathbf{D}_1) = -\\mathbf{L}_h\n$$\n\nNext, we construct the discrete second-derivative operator, $\\mathbf{D}_2$, which forms the basis for the irreversible part. The continuous negative Laplacian, $-\\partial_x^2$, is a symmetric, positive-semidefinite operator on a periodic domain, which is a required property for a dissipative operator. We thus seek a discrete operator $\\mathbf{D}_2$ that is symmetric and negative-semidefinite. The standard second-order central difference approximation for the second derivative is:\n$$\n(\\mathbf{D}_2 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - 2\\phi_i + \\phi_{i-1 \\pmod N}}{h^2}\n$$\nThis defines the matrix $\\mathbf{D}_2$ as the periodic discrete Laplacian, which is a symmetric, circulant, Toeplitz matrix. To verify its spectral properties, we can analytically determine its eigenvalues. The eigenvalues of this specific circulant matrix are known to be:\n$$\n\\lambda_j(\\mathbf{D}_2) = \\frac{1}{h^2} \\left( e^{i 2\\pi j/N} - 2 + e^{-i 2\\pi j/N} \\right) = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi j}{N}\\right) - 1 \\right) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\nfor $j = 0, 1, \\dots, N-1$. Since $\\sin^2(\\cdot) \\ge 0$, it is clear that all eigenvalues $\\lambda_j(\\mathbf{D}_2)$ are non-positive, confirming that $\\mathbf{D}_2$ is a negative-semidefinite matrix.\n\nThe irreversible GENERIC operator $\\mathbf{M}_h$ is defined by scaling the negative of $\\mathbf{D}_2$ by the non-negative mobility $\\kappa \\ge 0$:\n$$\n\\mathbf{M}_h = \\kappa(-\\mathbf{D}_2)\n$$\nThe symmetry of $\\mathbf{D}_2$ ensures that $\\mathbf{M}_h$ is also symmetric: $\\mathbf{M}_h^\\top = \\kappa(-\\mathbf{D}_2)^\\top = \\kappa(-\\mathbf{D}_2) = \\mathbf{M}_h$. The eigenvalues of $\\mathbf{M}_h$ are $\\lambda_j(\\mathbf{M}_h) = -\\kappa \\lambda_j(\\mathbf{D}_2) = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)$. Since $\\kappa \\ge 0$ and $h^2 > 0$, all eigenvalues of $\\mathbf{M}_h$ are non-negative. This confirms that $\\mathbf{M}_h$ is symmetric and positive-semidefinite.\n\nThis construction guarantees, by its analytical design, that the resulting discrete operators $\\mathbf{L}_h$ and $\\mathbf{M}_h$ satisfy the structural requirements of the GENERIC formalism. The provided implementation numerically constructs these matrices and verifies that these properties hold true up to a specified floating-point tolerance $\\varepsilon = 10^{-12}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_and_verify(N, u, kappa, L_dom, eps):\n    \"\"\"\n    Constructs and verifies the GENERIC operators for a 1D periodic system.\n\n    Args:\n        N (int): Number of grid points.\n        u (float): Advection speed.\n        kappa (float): Mobility.\n        L_dom (float): Length of the periodic domain.\n        eps (float): Tolerance for numerical verification.\n\n    Returns:\n        bool: True if all properties are satisfied, False otherwise.\n    \"\"\"\n    if N  3:\n        # The central difference stencils are not well-defined for N  3.\n        return False\n        \n    # 1. Construct discrete operators D1 and D2\n    h = L_dom / N\n    \n    # Use np.roll for an elegant construction on a periodic grid.\n    # E is the forward shift operator: (E @ f)_i = f_{i+1}\n    E = np.roll(np.identity(N), -1, axis=1)\n    # E_inv is the backward shift operator: (E_inv @ f)_i = f_{i-1}\n    E_inv = np.roll(np.identity(N), 1, axis=1)\n    \n    # Second-order central difference for the first derivative\n    # D1 ~ (f(x+h) - f(x-h)) / 2h\n    D1 = (E - E_inv) / (2.0 * h)\n    \n    # Second-order central difference for the second derivative\n    # D2 ~ (f(x+h) - 2f(x) + f(x-h)) / h^2\n    D2 = (E - 2.0 * np.identity(N) + E_inv) / (h**2)\n    \n    # 2. Define GENERIC operators L_h and M_h\n    L_h = u * D1\n    M_h = kappa * (-D2)\n    \n    # 3. Verify the required properties\n    \n    # Check 1: Antisymmetry of L_h\n    # ||L_h + L_h^T||_F = eps * max(1, ||L_h||_F)\n    norm_L = np.linalg.norm(L_h, 'fro')\n    err_L = np.linalg.norm(L_h + L_h.T, 'fro')\n    check_L = err_L = eps * max(1.0, norm_L)\n    \n    # Check 2: Symmetry of M_h\n    # ||M_h - M_h^T||_F = eps * max(1, ||M_h||_F)\n    norm_M = np.linalg.norm(M_h, 'fro')\n    err_M = np.linalg.norm(M_h - M_h.T, 'fro')\n    check_M_sym = err_M = eps * max(1.0, norm_M)\n    \n    # Check 3: Positive Semidefiniteness of M_h\n    # min_eigenvalue(0.5*(M_h + M_h^T)) >= -eps\n    # The symmetrization step ensures the matrix is Hermitian for the eigenvalue solver,\n    # robustly handling any minor floating-point asymmetries.\n    M_h_symmetrized = 0.5 * (M_h + M_h.T)\n    \n    # Handle the trivial case of a zero matrix separately for robustness.\n    if np.allclose(M_h_symmetrized, 0, atol=eps):\n        min_eig = 0.0\n    else:\n        # Use np.linalg.eigvalsh for real symmetric (Hermitian) matrices.\n        # It is faster and more numerically stable than np.linalg.eigvals.\n        eigenvalues = np.linalg.eigvalsh(M_h_symmetrized)\n        min_eig = np.min(eigenvalues)\n        \n    check_M_psd = min_eig >= -eps\n    \n    return check_L and check_M_sym and check_M_psd\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, u, kappa)\n        (3, 1.7, 0.0),    # Case A\n        (4, 0.0, 1.0),    # Case B\n        (7, -2.0, 0.5),   # Case C\n        (16, 3.3, 1e-3),  # Case D (10^{-3} = 0.001)\n    ]\n    \n    # Parameters defined in the problem\n    L_dom = 1.0\n    eps = 1e-12\n    \n    results = []\n    for case in test_cases:\n        N, u, kappa = case\n        is_valid = construct_and_verify(N, u, kappa, L_dom, eps)\n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solution\nsolve()\n\n```"
        }
    ]
}