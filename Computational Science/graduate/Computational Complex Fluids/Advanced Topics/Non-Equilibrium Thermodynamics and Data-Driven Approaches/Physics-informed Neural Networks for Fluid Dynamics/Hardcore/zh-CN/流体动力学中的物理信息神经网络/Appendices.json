{
    "hands_on_practices": [
        {
            "introduction": "在为流体动力学构建物理启发神经网络（PINN）时，一个基本但至关重要的决策是选择合适的激活函数。对于包含二阶导数（如Navier-Stokes方程中的粘性项 $\\mu \\nabla^2 \\mathbf{u}$）的偏微分方程，网络近似本身必须至少是二次可微的。此练习探讨了为什么常用的ReLU激活函数在这种情况下会失效，并引导您确定更合适的光滑激活函数，以确保物理残差的准确计算。",
            "id": "4099921",
            "problem": "一个带有参数 $\\theta$ 的物理信息神经网络 (PINN) 被训练来近似域 $\\Omega \\subset \\mathbb{R}^2$ 中不可压缩牛顿流体的速度场 $\\mathbf{u}_\\theta(\\mathbf{x},t)$ 和压力 $p_\\theta(\\mathbf{x},t)$。控制方程是不可压缩的纳维–斯托克斯方程，它表述了动量守恒和质量守恒：$$\\rho\\left(\\partial_t \\mathbf{u} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u}\\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,$$ 其中 $\\rho$ 是密度，$\\mu$ 是动力粘度，$\\mathbf{f}$ 是彻体力。在 PINN 的损失函数中，粘性项的残差需要通过自动微分 (AD) 逐点计算 $\\nabla^2 \\mathbf{u}_\\theta$。该网络在所有隐藏层使用整流线性单元 (ReLU) 激活函数。在训练过程中，观察到通过 AD 计算的 $\\mathbf{u}_\\theta$ 的二阶导数在几乎所有配置点上都数值上为零，并且在明显的“扭结”集附近不稳定，这导致粘性残差被误导性地减小，并造成收敛性差。\n\n从可微性的第一性原理和经典导数的定义出发，分析为什么对于粘性项所需的逐点拉普拉斯残差，ReLU 网络的 AD 计算二阶导数可能是病态的，并确定一个替代的激活函数，以确保涉及 $\\nabla^2 \\mathbf{u}_\\theta$ 的残差在 PINN 所寻求的强逐点意义上是数学上有意义的。\n\n选择最准确地解释此现象并提出有效补救措施的选项：\n\nA. 在现代框架中，AD 将 ReLU 激活函数的二阶导数计算为包含扭结位置奇异测度的分布，因此 $\\nabla^2 \\mathbf{u}_\\theta$ 几乎处处都能被精确捕捉；因此，保留 ReLU 不会损害粘性残差的评估。\n\nB. 因为 ReLU 网络产生分段线性输出，所以 ReLU 激活的任何复合函数都是处处二次可微的，因此粘性项 $\\mu \\nabla^2 \\mathbf{u}_\\theta$ 恒等于零，这在不损害精度的情况下加速了训练。\n\nC. ReLU 函数 $r(x)=\\max(0,x)$ 的经典二阶导数在 $x\\neq 0$ 时为 $0$，在 $x=0$ 时未定义，并且 ReLU 的复合函数产生分段线性输出，在预激活值穿过 $0$ 的集合上存在扭结。标准 PINN 实现中的 AD 几乎处处返回 $0$ 并忽略奇异点，使得逐点 $\\nabla^2 \\mathbf{u}_\\theta$ 对于粘性残差是病态的。一个补救措施是用一个二次连续可微的激活函数替换 ReLU，例如 $\\tanh(x)$ 或 $\\mathrm{softplus}_\\beta(x)=\\beta^{-1}\\ln\\!\\big(1+e^{\\beta x}\\big)$，它们是 $C^\\infty$ 的，并能确保二阶导数是良定义的。\n\nD. 可以保留 ReLU，转而通过在配置点网格上使用有限差分格式来计算 $\\nabla^2 \\mathbf{u}_\\theta$；这会产生精确的二阶导数，并为 PINN 训练维持端到端的 AD。\n\nE. 切换到 leaky ReLU $r_\\alpha(x)=\\max(\\alpha x,x)$（其中 $\\alpha\\in(0,1)$）可以解决问题，因为该函数处处可微且具有非零曲率；因此，粘性残差所需的逐点二阶导数是良定义的。",
            "solution": "首先验证问题陈述，以确保其科学上合理、良态且客观。\n\n### 步骤 1：提取已知条件\n- **模型：** 带有参数 $\\theta$ 的物理信息神经网络 (PINN)。\n- **近似量：** 速度场 $\\mathbf{u}_\\theta(\\mathbf{x},t)$ 和压力 $p_\\theta(\\mathbf{x},t)$。\n- **物理系统：** 域 $\\Omega \\subset \\mathbb{R}^2$ 中的不可压缩牛顿流体。\n- **控制方程 (不可压缩纳维–斯托克斯方程)：**\n  - 动量：$\\rho\\left(\\partial_t \\mathbf{u} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u}\\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{f}$\n  - 质量守恒：$\\nabla \\cdot \\mathbf{u} = 0$\n- **参数：** $\\rho$ (密度)，$\\mu$ (动力粘度)，$\\mathbf{f}$ (彻体力)。\n- **PINN 实现细节：** 涉及 $\\nabla^2 \\mathbf{u}_\\theta$ 的粘性项残差通过自动微分 (AD) 逐点评估。\n- **网络架构：** 所有隐藏层均使用整流线性单元 (ReLU) 激活函数。\n- **观察到的现象：** 在训练期间，AD 计算的 $\\mathbf{u}_\\theta$ 的二阶导数在几乎所有配置点上都数值上为零。它们在“扭结”集附近不稳定。\n- **后果：** 粘性残差被误导性地减小，导致收敛性差。\n- **问题：** 分析为什么对于逐点拉普拉斯残差，ReLU 网络的 AD 计算二阶导数是病态的，并确定一个合适的替代激活函数，以确保残差在强逐点意义上是数学上有意义的。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述根据既定标准进行评估。\n\n- **科学依据：** 该问题牢固地植根于计算流体力学和科学机器学习领域。纳维-斯托克斯方程是流体力学的基础。物理信息神经网络 (PINN) 是一种用于求解微分方程的成熟且经过充分研究的方法。问题的核心，即关于神经网络架构的可微性及其对计算偏微分方程残差的影响，是为二阶偏微分方程实现 PINN 的一个关键且非平凡的方面。所描述的现象是真实存在的，并且是从业者经常遇到的。该问题在科学上是合理的。\n- **良态性：** 问题提供了清晰的背景、具体的技术设置（用于纳维-斯托克斯方程的带 ReLU 的 PINN）、精确的观察（二阶导数消失），并要求基于数学第一性原理给出因果解释和有效补救措施。问题明确无歧义，并允许一个特定的、可推导的答案。\n- **客观性：** 语言技术性强、精确，没有主观或含糊的术语。所有概念——ReLU、AD、拉普拉斯算子、PINN——都具有严格的数学或计算定义。\n\n该问题没有表现出任何科学上不合理、自相矛盾或模棱两可的缺陷。它提出了 PINN 应用中一个标准但重要的技术挑战。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。现在开始解答过程。\n\n### 基于原理的推导与选项分析\n\n问题的核心在于神经网络输出函数 $\\mathbf{u}_\\theta(\\mathbf{x}, t)$ 的可微性，而这又由其激活函数的性质决定。纳维–斯托克斯方程中的粘性项 $\\mu \\nabla^2 \\mathbf{u}$ 需要计算速度场的二阶空间导数。在 PINN 中，这是通过对网络输出 $\\mathbf{u}_\\theta$ 应用自动微分 (AD) 来完成的。\n\n让我们分析一下整流线性单元 (ReLU) 激活函数，其定义为 $r(x) = \\max(0, x)$。\n1.  **函数本身：** $r(x)$ 处处连续。当 $x > 0$ 和 $x  0$ 时，它是线性的。点 $x=0$ 是一个“扭结”。\n2.  **一阶导数：** $r(x)$ 的经典导数是亥维赛阶跃函数：\n    $$ r'(x) = \\frac{d}{dx} \\max(0, x) = \\begin{cases} 0  \\text{if } x  0 \\\\ 1  \\text{if } x > 0 \\end{cases} $$\n    在 $x=0$ 处导数未定义。一个由仿射变换和 ReLU 激活函数组成的神经网络 $\\mathbf{u}_\\theta(\\mathbf{x}, t)$ 是一个连续的分段线性函数。因此，它的一阶偏导数（例如 $\\partial_{x_i} u_{\\theta,j}$）是分段常数函数，在“扭结”处有跳跃不连续点。\n3.  **二阶导数：** $r(x)$ 的经典二阶导数是：\n    $$ r''(x) = \\frac{d^2}{dx^2} \\max(0, x) = 0 \\quad \\text{for all } x \\neq 0 $$\n    在 $x=0$ 处，经典二阶导数未定义。在分布理论中，二阶导数是狄拉克 $\\delta$ 分布，$r''(x) = \\delta(x)$。然而，深度学习库（如 TensorFlow 或 PyTorch）中使用的标准 AD 框架旨在计算计算图中基本函数复合的经典导数。它们不对分布进行操作。当 AD 计算二阶导数时，它对分段常数的一阶导数进行微分，结果几乎处处为 $0$。在不连续点（对于预激活函数，$x=0$），导数未定义，AD 通常会传播一个 $0$ 或 `NaN`，而不是奇异点的符号表示。\n\n因此，对于一个用 ReLU 激活函数构建的网络 $\\mathbf{u}_\\theta$，AD 计算的拉普拉斯算子 $\\nabla^2 \\mathbf{u}_\\theta = \\sum_i \\partial^2_{x_i x_i} \\mathbf{u}_\\theta$ 在任何不恰好位于测度为零的扭结集上的配置点处都将为零。这使得 PINN 损失函数中的粘性残差项 $\\mu \\nabla^2 \\mathbf{u}_\\theta$ 消失，但这并非因为物理定律得到满足，而是网络结构的数学假象。因此，网络不会因为粘性项中的误差而受到惩罚，从而无法学习到正确的解，尤其是在粘性显著的流动中。\n\n为了解决这个问题，激活函数必须足够光滑，以具有良定义的、非零的、连续的二阶导数。一个激活函数 $\\phi(x)$ 必须至少属于 $C^2$ 类（二次连续可微），才能使 $\\nabla^2 \\mathbf{u}_\\theta$ 良定义且连续。更好的选择是使用一个无限可微 ($C^\\infty$) 的激活函数，这是一个稳健的选择。\n- **候选 1：双曲正切函数 $\\tanh(x)$：** 该函数是 $C^\\infty$ 的。其二阶导数为 $d^2/dx^2 \\tanh(x) = -2\\tanh(x)\\text{sech}^2(x)$，该导数是连续且非零的。\n- **候选 2：Softplus 函数 $\\mathrm{softplus}_\\beta(x) = \\beta^{-1}\\ln(1+e^{\\beta x})$：** 该函数也是 $C^\\infty$ 的。它是 ReLU 的一个平滑近似。它的一阶导数是 sigmoid 函数，其二阶导数是连续且非零的，这使得网络能够表示非零的拉普拉斯算子。\n\n因此，问题被正确诊断为 ReLU 不存在经典二阶导数，而解决方案是将其替换为 $C^2$ 或更平滑的激活函数，如 $\\tanh(x)$ 或 $\\mathrm{softplus}(x)$。\n\n### 选项评估\n\n**A. 在现代框架中，AD 将 ReLU 激活函数的二阶导数计算为包含扭结位置奇异测度的分布，因此 $\\nabla^2 \\mathbf{u}_\\theta$ 几乎处处都能被精确捕捉；因此，保留 ReLU 不会损害粘性残差的评估。**\n该陈述从根本上是错误的。像 TensorFlow 和 PyTorch 这样的框架中的标准 AD 包不计算分布导数。它们通过链式法则计算经典导数。它们不表示或处理像狄拉克 $\\delta$ 函数这样的奇异测度。AD 计算的二阶导数几乎处处为 $0$，这正是粘性残差评估受损的原因。\n**结论：不正确。**\n\n**B. 因为 ReLU 网络产生分段线性输出，所以 ReLU 激活的任何复合函数都是处处二次可微的，因此粘性项 $\\mu \\nabla^2 \\mathbf{u}_\\theta$ 恒等于零，这在不损害精度的情况下加速了训练。**\n该陈述在多个方面都是不正确的。一个分段线性函数甚至不是处处一次可微的，更不用说二次可微了。粘性项被人为地置为零是问题的*根源*，它通过阻止网络学习正确的扩散物理过程而严重*损害*了精度。\n**结论：不正确。**\n\n**C. ReLU 函数 $r(x)=\\max(0,x)$ 的经典二阶导数在 $x\\neq 0$ 时为 $0$，在 $x=0$ 时未定义，并且 ReLU 的复合函数产生分段线性输出，在预激活值穿过 $0$ 的集合上存在扭结。标准 PINN 实现中的 AD 几乎处处返回 $0$ 并忽略奇异点，使得逐点 $\\nabla^2 \\mathbf{u}_\\theta$ 对于粘性残差是病态的。一个补救措施是用一个二次连续可微的激活函数替换 ReLU，例如 $\\tanh(x)$ 或 $\\mathrm{softplus}_\\beta(x)=\\beta^{-1}\\ln\\!\\big(1+e^{\\beta x}\\big)$，它们是 $C^\\infty$ 的，并能确保二阶导数是良定义的。**\n这个选项准确地描述了数学情况。它正确地指出 ReLU 的经典二阶导数几乎处处为 $0$，解释了为什么在使用 AD 时这会导致一个病态或为零的粘性残差，并提出了标准且正确的补救措施，即使用 $C^2$ 或更平滑的激活函数，如 $\\tanh(x)$ 或 $\\mathrm{softplus}(x)$（它们是 $C^\\infty$ 的）。该陈述的每一部分都与第一性原理分析一致。\n**结论：正确。**\n\n**D. 可以保留 ReLU，转而通过在配置点网格上使用有限差分格式来计算 $\\nabla^2 \\mathbf{u}_\\theta$；这会产生精确的二阶导数，并为 PINN 训练维持端到端的 AD。**\n这个选项提出的方法既不是最优的，其描述也是错误的。使用有限差分 (FD) 会引入截断误差，偏离了 AD 的“精确导数”原则。对于一个不光滑（分段线性）的函数，二阶导数的 FD 近似是出了名的不可靠。此外，在损失计算中引入 FD 算子会打破从损失到网络参数 $\\theta$ 的纯粹基于 AD 的微分链，因此它并没有在 PINN 残差的典型意义上“维持端到端的 AD”。这种方法没有解决根本问题，即网络函数本身不够光滑，无法在强意义上表示二阶偏微分方程的解。\n**结论：不正确。**\n\n**E. 切换到 leaky ReLU $r_\\alpha(x)=\\max(\\alpha x,x)$（其中 $\\alpha\\in(0,1)$）可以解决问题，因为该函数处处可微且具有非零曲率；因此，粘性残差所需的逐点二阶导数是良定义的。**\n该陈述在数学上是错误的。Leaky ReLU 函数 $r_\\alpha(x)$ 仍然是分段线性的，并且在 $x=0$ 处有一个扭结。它在 $x=0$ 处不可微。它的二阶导数在所有 $x \\neq 0$ 处也为 $0$，并在 $x=0$ 处未定义。因此，在计算粘性项的二阶导数方面，它与标准 ReLU 函数存在完全相同的问题。它不能解决这个问题。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "在设计PINN时，一个强大的策略是通过巧妙的结构设计（即“ansatz”）来让网络输出自动满足某些物理约束。这种方法可以将一个有约束的优化问题转化为一个无约束的问题，从而简化训练过程。本练习将以二维不可压缩流中的流函数（streamfunction）为例，展示如何通过构造来精确满足连续性方程（质量守恒），并分析这种方法对压力场求解的影响。",
            "id": "4099876",
            "problem": "考虑一个连通域 $\\Omega \\subset \\mathbb{R}^2$ 中的二维不可压缩牛顿流体，其速度场 $\\boldsymbol{u}(x,y,t)$ 和压力场 $p(x,y,t)$ 未知，并受到体力 $\\boldsymbol{f}(x,y,t)$ 的作用。在物理信息神经网络（PINN）中，我们提出通过流函数拟设 $\\psi(x,y,t)$ 来表示速度，即\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix} \\partial_y \\psi \\\\ -\\partial_x \\psi \\end{pmatrix}.\n$$\n不可压缩牛顿流体的控制方程是不可压缩性约束和动量平衡，\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0,\n$$\n$$\n\\rho\\left(\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}\\right) = -\\nabla p + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f},\n$$\n其中 $\\rho$ 是恒定密度，$\\mu$ 是动力粘度。没有提供显式的压力边界条件；速度边界条件施加在 $\\partial\\Omega$ 上。\n\n从第一性原理和核心定义出发，论述流函数拟设对连续性残差以及在PINN框架下（该框架在配置点上强制执行动量平衡）压力场可辨识性的影响。具体来说，从上述控制定律开始：\n\n- 确定当 $\\boldsymbol{u}$ 如上由 $\\psi$ 构造时，连续性残差是否恒为零。\n- 通过对动量平衡方程应用适当的算子并利用不可压缩性，推导确定压力（用 $\\psi$ 和 $\\boldsymbol{f}$ 表示）的条件，并说明在没有压力数据的情况下，仅通过强制动量平衡， $p$ 的哪些方面是或不是唯一可辨识的。\n- 讨论边界条件和规范选择如何影响 $p$ 的恢复，以及非平凡的零空间是否会导致超出加性常数的模糊性。\n\n根据此分析，选择最正确的陈述：\n\nA. 在二维不可压缩流中，定义 $\\boldsymbol{u}=(\\partial_y \\psi,-\\partial_x \\psi)$ 保证了 $\\nabla\\cdot\\boldsymbol{u}=0$ 恒成立，因此在物理信息神经网络（PINN）中，对于任何 $\\psi$，连续性残差都恒为零；压力随后通过强制执行动量方程来恢复，这些方程在给定 $\\boldsymbol{f}$ 和边界牵引力的情况下唯一地确定了 $\\nabla p$（相差一个规范常数）。\n\nB. 使用流函数拟设会自动消除连续性和动量残差，因此压力无法被辨识，并且在训练中必须设置为零。\n\nC. 流函数拟设强制 $\\nabla\\times \\boldsymbol{u}=0$，这消除了涡度，从而不再需要压力；学习到的压力变得任意且不可观测。\n\nD. 使用流函数拟设时，动量方程的散度产生了一个关于压力的泊松方程，其源项仅通过速度梯度和 $\\boldsymbol{f}$ 依赖于 $\\psi$；然而，在仅强制动量平衡的PINN中，压力在没有任何边界或规范条件的情况下被唯一确定。\n\nE. 使用流函数拟设时，压力仅能被确定至相差一个加性常数，并且在没有牵引力或压力边界条件的情况下，PINN可能会学到一个与真实压力相差一个空间调和函数的压力，因为调和函数的梯度为零。",
            "solution": "用户希望我扮演一位严谨的STEM教授。我的任务是验证问题陈述的有效性，如果有效，则从第一性原理推导解决方案并评估给出的选项。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **物理系统**：一个连通域 $\\Omega \\subset \\mathbb{R}^2$ 中的二维不可压缩牛顿流体。\n- **场变量**：速度 $\\boldsymbol{u}(x,y,t)$ 和压力 $p(x,y,t)$。\n- **参数**：恒定密度 $\\rho$，恒定动力粘度 $\\mu$。\n- **外力**：体力 $\\boldsymbol{f}(x,y,t)$。\n- **PINN拟设**：速度由流函数 $\\psi(x,y,t)$ 导出，即 $\\boldsymbol{u} = \\begin{pmatrix} \\partial_y \\psi \\\\ -\\partial_x \\psi \\end{pmatrix}$。\n- **控制方程**：\n    1.  不可压缩性：$\\nabla \\cdot \\boldsymbol{u} = 0$。\n    2.  动量平衡（纳维-斯托克斯方程）：$\\rho\\left(\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}\\right) = -\\nabla p + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f}$。\n- **边界条件**：在 $\\partial\\Omega$ 上指定了速度边界条件。没有提供显式的压力边界条件。\n\n**步骤2：使用已知条件进行验证**\n- **科学基础**：该问题在根本上是合理的。它使用了标准的不可压缩流纳维-斯托克斯方程和经典的流函数公式，这在二维空间中是一种数学上严谨的方法。物理信息神经网络（PINN）的背景是计算科学与工程领域一个当前有效的研究方向。\n- **适定性**：该问题是适定的。它要求分析一个特定的建模选择（流函数拟设）对控制方程以及在一个数值框架内压力场可辨识性的数学影响。这是一个清晰且可回答的问题。\n- **客观性**：语言精确、技术性强，没有主观内容。所有术语都是流体动力学和计算数学中的标准术语。\n- **完整性与一致性**：该问题提供了进行所要求分析所需的所有必要信息。关于缺少压力边界条件的明确说明是问题设置的关键部分，而非疏漏。问题中没有矛盾之处。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它具有科学依据、适定、客观且自洽。我现在将继续进行推导和求解。\n\n### 推导与分析\n\n该问题要求在PINN框架内分析用于求解二维不可压缩纳维-斯托克斯方程的流函数拟设。\n\n**1. 对连续性残差的影响**\n速度场 $\\boldsymbol{u}$ 通过流函数 $\\psi(x,y,t)$ 定义如下：\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix} \\partial_y \\psi \\\\ -\\partial_x \\psi \\end{pmatrix}\n$$\n不可压缩性条件，即连续性方程，为 $\\nabla \\cdot \\boldsymbol{u} = 0$。让我们计算所提出的速度场的散度：\n$$\n\\nabla \\cdot \\boldsymbol{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial \\psi}{\\partial y}\\right) + \\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial \\psi}{\\partial x}\\right) = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x}\n$$\n假设代表 $\\psi$ 的神经网络足够光滑（至少是 $C^2$），根据施瓦茨定理或克莱罗定理，混合偏导数相等，即 $\\frac{\\partial^2 \\psi}{\\partial x \\partial y} = \\frac{\\partial^2 \\psi}{\\partial y \\partial x}$。因此：\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0\n$$\n对于任何足够光滑的函数 $\\psi$，这个条件都恒成立。在PINN的背景下，连续性方程通常作为损失函数中的一个残差项被强制执行，而这种拟设从结构上强制了该约束。连续性残差恒为零，不需要包含在PINN的损失函数中。\n\n**2. 压力场的确定**\n当速度场由 $\\psi$ 确定后，剩下的需要满足的控制方程是动量平衡方程。我们可以重新排列它以分离出压力梯度：\n$$\n\\nabla p = -\\rho\\left(\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}\\right) + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f}\n$$\n我们将右侧这个完全由 $\\psi$ 和 $\\boldsymbol{f}$ 决定的矢量场表示为 $\\boldsymbol{G}(\\psi, \\boldsymbol{f})$：\n$$\n\\nabla p = \\boldsymbol{G}(\\psi, \\boldsymbol{f})\n$$\n一个“强制执行动量平衡”的PINN旨在找到 $\\psi$ 和 $p$ 的神经网络，使得该矢量方程在一组配置点上得到满足。这意味着为 $p$ 训练的网络使其梯度与场 $\\boldsymbol{G}$ 相匹配。\n\n这个方程只确定了压力的梯度 $\\nabla p$。根据线积分的基本定理，这只能将 $p$ 确定到相差一个空间上的常数。然而，这个常数可以是时间的函数 $p_0(t)$，因为 $\\nabla p_0(t) = 0$。因此，仅强制动量方程只能将压力确定到相差一个函数 $p(x,y,t) \\rightarrow p(x,y,t) + p_0(t)$。\n\n为了得到关于 $p$ 本身的方程，我们可以对 $\\nabla p$ 的表达式取散度：\n$$\n\\nabla \\cdot (\\nabla p) = \\nabla^2 p = \\nabla \\cdot \\boldsymbol{G}\n$$\n这是一个关于压力的泊松方程。源项 $\\nabla \\cdot \\boldsymbol{G}$ 是：\n$$\n\\nabla \\cdot \\boldsymbol{G} = \\nabla \\cdot \\left( -\\rho\\left(\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}\\right) + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f} \\right)\n$$\n利用 $\\nabla \\cdot \\boldsymbol{u} = 0$ 这一事实，我们有 $\\nabla \\cdot (\\partial_t \\boldsymbol{u}) = \\partial_t (\\nabla \\cdot \\boldsymbol{u}) = 0$ 和 $\\nabla \\cdot (\\mu \\nabla^2 \\boldsymbol{u}) = \\mu \\nabla^2 (\\nabla \\cdot \\boldsymbol{u}) = 0$。方程简化为：\n$$\n\\nabla^2 p = \\nabla \\cdot \\boldsymbol{f} - \\rho \\nabla \\cdot ((\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u})\n$$\n源项依赖于速度场（通过从 $\\psi$ 导出的 $\\boldsymbol{u}$ 及其梯度）和体力 $\\boldsymbol{f}$。\n\n**3. 唯一性、边界条件和规范选择**\n泊松方程 $\\nabla^2 p = S$ 的解只有在提供适当的边界条件时才是唯一的。\n- 如果给定狄利克雷条件（在 $\\partial\\Omega$ 上的 $p$ 值），解是唯一的。\n- 如果给定诺伊曼条件（在 $\\partial\\Omega$ 上的法向导数 $\\partial_n p$ 的值），解是唯一的，但可以相差一个加性常数。\n\n问题陈述中没有提供显式的压力边界条件。然而，一个诺伊曼条件隐含在动量方程本身之中。计算动量方程垂直于边界 $\\partial\\Omega$ 的分量可得：\n$$\n\\frac{\\partial p}{\\partial n} = \\boldsymbol{n} \\cdot \\nabla p = \\boldsymbol{n} \\cdot \\left( -\\rho\\left(\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}\\right) + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f} \\right)\n$$\n其中 $\\boldsymbol{n}$ 是向外的单位法向量。由于在 $\\partial\\Omega$ 上为 $\\boldsymbol{u}$ 指定了速度边界条件，一旦 $\\psi$ 被确定，右侧原则上是已知的。一个在整个域上强制动量残差的PINN实际上是在用这个自然的诺伊曼边界条件求解泊松方程。因此，压力场 $p$ 只能被确定到相差一个加性常数（该常数可以是时间的函数 $p_0(t)$）。为了固定这个常数，必须施加一个额外的条件，例如在域内某一点指定 $p$ 的值（一种规范选择），或在边界某处提供一个压力或边界牵引力条件（$\\boldsymbol{t} = \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = [-p\\boldsymbol{I} + \\mu(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)] \\cdot \\boldsymbol{n}$）。\n\n超出加性常数的非平凡零空间（例如，一个调和函数）是不可能的。如果一个非恒定的调和函数 $h$ 被加到压力上，即 $p' = p + h$，那么 $\\nabla p' = \\nabla p + \\nabla h$。由于 $\\nabla h \\neq 0$，这会改变动量方程的残差，一个正确训练的PINN会惩罚这种偏差。\n\n### 逐项分析\n\n**A. 在二维不可压缩流中，定义 $\\boldsymbol{u}=(\\partial_y \\psi,-\\partial_x \\psi)$ 保证了 $\\nabla\\cdot\\boldsymbol{u}=0$ 恒成立，因此在物理信息神经网络（PINN）中，对于任何 $\\psi$，连续性残差都恒为零；压力随后通过强制执行动量方程来恢复，这些方程在给定 $\\boldsymbol{f}$ 和边界牵引力的情况下唯一地确定了 $\\nabla p$（相差一个规范常数）。**\n- 关于流函数拟设和零连续性残差的第一部分是完全正确的。\n- 第二部分指出动量方程确定了 $\\nabla p$。这是正确的，因为 $\\nabla p = \\boldsymbol{G}(\\psi, \\boldsymbol{f})$。\n- ‘唯一地确定了 $\\nabla p$ （在相差一个规范常数的情况下）’这种表述很别扭。一旦 $\\psi$ 和 $\\boldsymbol{f}$ 已知，$\\nabla p$ 就被唯一确定了。是 $p$ 被确定到相差一个规范常数。然而，如果将其理解为‘唯一地确定了 $\\nabla p$，从而将 $p$ 确定到相差一个规范常数’，那么这个陈述就是正确的。\n- 最后的子句‘在给定 $\\boldsymbol{f}$ 和边界牵引力的情况下’正确地指出了需要额外的信息，如边界牵引力，来固定规范并唯一地确定 $p$。尽管措辞有些复杂，但在问题的背景下，所有组成部分的论断在物理上和数学上都是正确的。\n**结论：正确**\n\n**B. 使用流函数拟设会自动消除连续性和动量残差，因此压力无法被辨识，并且在训练中必须设置为零。**\n- 声称流函数拟设消除了动量残差是错误的。动量残差正是PINN为了学习正确的 $\\psi$ 和 $p$ 所必须最小化的东西。\n- 声称压力无法被辨识是错误的；它的梯度由动量方程确定。\n**结论：不正确**\n\n**C. 流函数拟设强制 $\\nabla\\times \\boldsymbol{u}=0$，这消除了涡度，从而不再需要压力；学习到的压力变得任意且不可观测。**\n- 流函数拟设强制的是 $\\nabla \\cdot \\boldsymbol{u} = 0$（不可压缩性），而不是 $\\nabla \\times \\boldsymbol{u} = 0$（无旋性）。涡度 $\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{u}$ 通常不为零，并由 $\\boldsymbol{\\omega} = (0, 0, -\\nabla^2 \\psi)$ 给出。这个陈述将流函数与速度势混淆了。\n- 即使在无旋流中，压力对于动量平衡也是至关重要的。\n**结论：不正确**\n\n**D. 使用流函数拟设时，动量方程的散度产生了一个关于压力的泊松方程，其源项仅通过速度梯度和 $\\boldsymbol{f}$ 依赖于 $\\psi$；然而，在仅强制动量平衡的PINN中，压力在没有任何边界或规范条件的情况下被唯一确定。**\n- 描述压力泊松方程的第一部分是正确的。\n- 声称在没有任何边界或规范条件的情况下压力被唯一确定的第二部分是错误的。如前所示，强制动量平衡只能将压力确定到相差一个加性常数 $p_0(t)$。\n**结论：不正确**\n\n**E. 使用流函数拟设时，压力仅能被确定至相差一个加性常数，并且在没有牵引力或压力边界条件的情况下，PINN可能会学到一个与真实压力相差一个空间调和函数的压力，因为调和函数的梯度为零。**\n- 声称压力被确定到相差一个加性常数是正确的。\n- 声称模糊性可能是一个空间调和函数是错误的。强制执行动量方程 $\\nabla p = \\boldsymbol{G}$ 会因添加一个非恒定的调和函数 $h(x,y)$ 而被违反，因为这会向残差中添加一个非零项 $\\nabla h$。\n- ‘因为调和函数的梯度为零’这一理由在事实上是错误的。如果 $\\nabla^2 h = 0$，则函数 $h$ 是调和的。只有常数函数的梯度为零。例如，$h(x,y)=x$ 是调和的，但其梯度是 $(1,0)$。\n**结论：不正确**\n\n### 结论\n\n选项A是唯一一个尽管措辞有些别扭，但其内容完全由与问题相关的、正确的物理和数学事实组成的陈述。所有其他选项都包含根本性错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "定义了网络架构和需要最小化的物理残差后，最后一步是在损失函数中为它们分配合理的权重。如果不同物理残差（如动量和连续性）的量级差异巨大，训练过程可能会变得不稳定，或者模型可能只会学习满足其中一个约束。本练习将指导您如何运用量纲分析，从物理第一性原理出发，为不同损失项推导出一个合理的相对缩放比例，从而平衡训练动态。",
            "id": "4099871",
            "problem": "考虑一个二维、不可压缩的牛顿流体，其密度为$\\rho$，动力粘度为$\\mu$，在一个有界空间域$\\Omega \\subset \\mathbb{R}^{2}$上随时间区间$[0,T]$演化。主要的场是速度$\\mathbf{u}(\\mathbf{x},t)$和压力$p(\\mathbf{x},t)$。控制方程是不可压缩的纳维-斯托克斯方程，\n$$\n\\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) = -\\nabla p + \\mu \\nabla^{2}\\mathbf{u} + \\mathbf{f}, \\qquad \\nabla\\cdot\\mathbf{u} = 0,\n$$\n其中$\\mathbf{f}$是已知的体积力密度。一个物理信息神经网络（PINN）被训练来近似$(\\mathbf{u},p)$，其方法是最小化一个物理损失函数，该损失函数由两部分贡献组成：动量残差惩罚项和质量守恒（散度）惩罚项。将逐点动量残差$\\mathbf{r}_{m}(\\mathbf{x},t)$和连续性残差$r_{c}(\\mathbf{x},t)$定义为\n$$\n\\mathbf{r}_{m} := \\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) + \\nabla p - \\mu \\nabla^{2}\\mathbf{u} - \\mathbf{f}, \\qquad r_{c} := \\nabla\\cdot\\mathbf{u}.\n$$\n物理损失函数的形式为\n$$\n\\mathcal{L}_{\\text{phys}} = \\lambda_{m}\\,\\mathbb{E}\\!\\left[\\,\\|\\mathbf{r}_{m}\\|^{2}\\,\\right] + \\lambda_{c}\\,\\mathbb{E}\\!\\left[\\,|r_{c}|^{2}\\,\\right],\n$$\n其中$\\mathbb{E}[\\cdot]$表示在$\\Omega\\times[0,T]$中的配置点上的平均值，$\\lambda_{m}>0$和$\\lambda_{c}>0$是权重。因此，散度惩罚项被构造为$r_{c}$在训练分布上的$L^{2}$-范数的平方。\n\n为避免在训练过程中过度抑制速度动力学，需要寻求一个散度惩罚项相对于动量残差的缩放比例，以在特征量级的层面上平衡二者的贡献。设$U$和$L$分别为流场的特征速度和特征长度尺度。仅使用上述基本方程和标准量纲分析，推导相对缩放比例\n$$\ns_{\\mathrm{rel}} \\equiv \\frac{\\lambda_{c}}{\\lambda_{m}}\n$$\n的闭式表达式，该比例使得两个残差平方项的特征量级相等，这些量级是在具有特征尺度$U$和$L$的场上评估的。使用国际单位制（SI），将$s_{\\mathrm{rel}}$的最终答案用$\\rho$和$U$表示。仅提供最终表达式；不要代入数值。",
            "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它基于流体动力学、量纲分析和物理信息机器学习这一当代研究领域的既定原理。要求是使用标准物理推理来推导一个缩放因子，这是一个有效且可形式化的任务。未发现任何缺陷。\n\n目标是确定相对缩放因子$s_{\\mathrm{rel}} \\equiv \\frac{\\lambda_{c}}{\\lambda_{m}}$，使得物理损失函数中的两个加权惩罚项$\\lambda_{m}\\,\\mathbb{E}\\!\\left[\\,\\|\\mathbf{r}_{m}\\|^{2}\\,\\right]$和$\\lambda_{c}\\,\\mathbb{E}\\!\\left[\\,|r_{c}|^{2}\\,\\right]$具有相同的特征量级。这个条件可以表示为：\n$$\n\\lambda_{m} [\\|\\mathbf{r}_{m}\\|^{2}] \\sim \\lambda_{c} [|r_{c}|^{2}]\n$$\n其中$[\\cdot]$表示一个量的特征量级。因此，问题在于基于流场的特征尺度，找到能够平衡动量残差和连续性残差贡献的缩放比例。\n\n重新整理这个等价关系，我们得到所需比例的表达式：\n$$\ns_{\\mathrm{rel}} = \\frac{\\lambda_{c}}{\\lambda_{m}} \\sim \\frac{[\\|\\mathbf{r}_{m}\\|^{2}]}{[|r_{c}|^{2}]} = \\frac{[\\mathbf{r}_{m}]^{2}}{[r_{c}]^{2}}\n$$\n为了评估这个比例，我们必须使用给定的特征速度尺度$U$和特征长度尺度$L$对逐点残差$\\mathbf{r}_{m}$和$r_{c}$进行量纲分析。\n\n首先，我们分析连续性残差$r_{c}$。它被定义为速度场的散度：\n$$\nr_{c} := \\nabla\\cdot\\mathbf{u}\n$$\n梯度算子$\\nabla$涉及空间导数，所以其特征尺度是特征长度尺度的倒数，即$[ \\nabla ] \\sim L^{-1}$。速度场$\\mathbf{u}$的特征量级为$U$。因此，连续性残差的特征量级是：\n$$\n[r_{c}] \\sim [ \\nabla ] \\cdot [\\mathbf{u}] \\sim \\frac{1}{L} \\cdot U = \\frac{U}{L}\n$$\n\n接下来，我们分析动量残差$\\mathbf{r}_{m}$，其定义为：\n$$\n\\mathbf{r}_{m} := \\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) + \\nabla p - \\mu \\nabla^{2}\\mathbf{u} - \\mathbf{f}\n$$\n$\\mathbf{r}_{m}$的量级由动量方程中各项的量级决定。在一个适定的物理问题中，所有项都必须具有相同的物理单位（单位体积力）。残差的特征量级由主导的物理效应决定。对于许多流体流动，特别是在中等到高雷诺数下，惯性项是主导项，或被用作参考尺度。让我们分析惯性项：局部加速度项$\\rho \\frac{\\partial \\mathbf{u}}{\\partial t}$和对流（平流）加速度项$\\rho(\\mathbf{u}\\cdot\\nabla \\mathbf{u})$。\n\n特征时间尺度$t_{char}$可以与长度和速度尺度相关联。平流时间尺度，即流体质点以特征速度$U$行进特征距离$L$所需的时间，为$t_{char} \\sim L/U$。\n\n使用这个关系，局部加速度项的量级为：\n$$\n\\left[\\rho \\frac{\\partial \\mathbf{u}}{\\partial t}\\right] \\sim \\frac{[\\rho][\\mathbf{u}]}{[t]} \\sim \\frac{\\rho U}{L/U} = \\rho \\frac{U^{2}}{L}\n$$\n对流加速度项的量级为：\n$$\n[\\rho(\\mathbf{u}\\cdot\\nabla \\mathbf{u})] \\sim [\\rho][\\mathbf{u}][\\nabla][\\mathbf{u}] \\sim \\rho \\cdot U \\cdot \\frac{1}{L} \\cdot U = \\rho \\frac{U^{2}}{L}\n$$\n两个惯性项具有相同的特征量级$\\rho U^{2}/L$。这个量级代表了单位体积的惯性力。压力梯度项$[\\nabla p]$和粘性项$[\\mu \\nabla^2 \\mathbf{u}]$预期会以平衡惯性项的方式进行缩放。具体来说，动压的尺度为$p \\sim \\rho U^2$，导致$[\\nabla p] \\sim \\rho U^2/L$。因此，将整个动量残差的特征量级设置为与惯性项的量级相同是合适的：\n$$\n[\\mathbf{r}_{m}] \\sim \\rho \\frac{U^{2}}{L}\n$$\n\n现在我们可以将$[r_{c}]$和$[\\mathbf{r}_{m}]$的特征量级代入$s_{\\mathrm{rel}}$的表达式中：\n$$\ns_{\\mathrm{rel}} \\sim \\frac{[\\mathbf{r}_{m}]^{2}}{[r_{c}]^{2}} \\sim \\frac{\\left(\\rho \\frac{U^{2}}{L}\\right)^{2}}{\\left(\\frac{U}{L}\\right)^{2}}\n$$\n化简此表达式可得：\n$$\ns_{\\mathrm{rel}} \\sim \\frac{\\rho^{2} \\frac{U^{4}}{L^{2}}}{\\frac{U^{2}}{L^{2}}} = \\rho^{2} U^{2}\n$$\n推导出的缩放因子$s_{\\mathrm{rel}}$仅用流体密度$\\rho$和特征速度$U$表示，符合要求。量纲检查证实了其一致性。$\\lambda_c/\\lambda_m$的单位必须是$\\|\\mathbf{r}_m\\|^2 / |r_c|^2$的单位。在国际单位制（SI）中，其单位为$(\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-2})^2 / (\\text{s}^{-1})^2 = \\text{kg}^2 \\cdot \\text{m}^{-4} \\cdot \\text{s}^{-2}$。$\\rho^2 U^2$的单位是$(\\text{kg} \\cdot \\text{m}^{-3})^2 \\cdot (\\text{m} \\cdot \\text{s}^{-1})^2 = (\\text{kg}^2 \\cdot \\text{m}^{-6}) \\cdot (\\text{m}^2 \\cdot \\text{s}^{-2}) = \\text{kg}^2 \\cdot \\text{m}^{-4} \\cdot \\text{s}^{-2}$。单位匹配，证实了推导的正确性。",
            "answer": "$$\\boxed{\\rho^{2} U^{2}}$$"
        }
    ]
}