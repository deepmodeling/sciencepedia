{
    "hands_on_practices": [
        {
            "introduction": "要想理解液滴的电致流体动力学行为，我们首先必须确定电场如何因液滴的存在而发生扭曲。这项基础练习将引导您从第一性原理出发，解析推导出一个球形“漏电介质”液滴内外的电势分布。掌握这个经典的边值问题至关重要，因为由此得到的电势分布是计算电应力并预测液滴后续行为的起点。",
            "id": "4085427",
            "problem": "一个半径为 $a$、电导率为 $\\sigma_{i}$、介电常数为 $\\epsilon_{i}$ 的球形液滴，悬浮于一种电导率为 $\\sigma_{o}$、介电常数为 $\\epsilon_{o}$ 的不相溶液体中。在无穷远处，沿 z 轴方向施加一个大小为 $E_{0}$ 的均匀、稳定直流电场。假设系统处于电准静态体系，两相体相内均无自由电荷，界面电荷对流可忽略不计，且系统处于稳态。在每个均匀相内部，电场 $\\boldsymbol{E}$ 是无旋的，电势 $\\phi$ 是调和的。\n\n使用漏电介质模型和第一性原理，完成以下任务：\n- 从电准静态极限下的麦克斯韦方程组和欧姆定律出发，论证各相中电势的控制方程以及在 $r=a$ 处电势和电场的界面跳跃条件，包括表面电荷密度 $q_{s}$ 与法向电位移之间的关系。\n- 求解液滴内外的轴对称电势，使其满足远场条件 $\\phi \\to -E_{0} r \\cos\\theta$（当 $r \\to \\infty$ 时）。求解时，在 $r=a$ 处施加以下条件：电势连续性 $\\llbracket \\phi \\rrbracket=0$、切向电场连续性 $\\llbracket \\mathbf{t}\\cdot \\mathbf{E} \\rrbracket=0$、高斯定律跳跃 $\\llbracket \\epsilon E_{n} \\rrbracket=q_{s}$，以及在对流可忽略和稳态下的电荷守恒，这意味着法向欧姆电流连续 $\\llbracket \\sigma E_{n} \\rrbracket=0$。\n\n在球坐标系中，将外部电势定义为 $\\phi_{o}(r,\\theta)=-E_{0} r \\cos\\theta + \\left(B/r^{2}\\right)\\cos\\theta$，内部电势定义为 $\\phi_{i}(r,\\theta)=-A r \\cos\\theta$，其中 $A$ 和 $B$ 是待定常数。通过关系式 $B=a^{3} E_{0}\\,K$ 引入无量纲极化因子 $K$。\n\n最终答案要求为仅含 $\\sigma_{i}$ 和 $\\sigma_{o}$ 的单个闭式解析表达式。不要代入数值。答案是无量纲的，最终表达式中无需单位。",
            "solution": "所述问题具有科学依据、提法适定、客观且完整。它描述了均匀直流电场中液滴的经典“漏电介质”模型，这是电流体动力学中的一个基本问题。所有必要的物理参数、控制方程和边界条件都已给出，并且在指定的电准静态和稳态假设下，它们与麦克斯韦方程组一致。因此，该问题是有效的，并且可以推导出解。\n\n首先，我们按要求从第一性原理出发，论证控制方程和边界条件。分析在电准静态（EQS）极限下进行，此时磁场效应可以忽略不计。\n\n在 EQS 体系中，由于系统处于稳态（$\\frac{\\partial}{\\partial t} = 0$），法拉第电磁感应定律 $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ 简化为 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。电场 $\\mathbf{E}$ 的这种无旋性质使其可以表示为标量电势 $\\phi$ 的梯度，即 $\\mathbf{E} = -\\nabla \\phi$。\n\n高斯电场定律为 $\\nabla \\cdot \\mathbf{D} = \\rho_{\\text{free}}$，其中 $\\mathbf{D}$ 是电位移场，$\\rho_{\\text{free}}$ 是自由电荷体密度。对于线性、均匀、各向同性的介电介质，$\\mathbf{D} = \\epsilon \\mathbf{E}$，其中 $\\epsilon$ 是介电常数。问题陈述，两相体相内均无自由电荷，因此 $\\rho_{\\text{free}} = 0$。这导致 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。由于在每个相内 $\\epsilon$ 是常数，该式简化为 $\\nabla \\cdot \\mathbf{E} = 0$。代入 $\\mathbf{E} = -\\nabla \\phi$ 可得 $\\nabla \\cdot (-\\nabla \\phi) = 0$，即电势的拉普拉斯方程：\n$$ \\nabla^2 \\phi = 0 $$\n这证实了电势 $\\phi$ 在液滴（i 相）和周围介质（o 相）内部都是一个调和函数。\n\n电荷守恒由连续性方程 $\\frac{\\partial \\rho_{\\text{free}}}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0$ 控制，其中 $\\mathbf{J}$ 是自由电流密度。在稳态下，$\\frac{\\partial \\rho_{\\text{free}}}{\\partial t} = 0$，因此连续性方程简化为 $\\nabla \\cdot \\mathbf{J} = 0$。在每个欧姆介质内部，电流由欧姆定律给出，即 $\\mathbf{J} = \\sigma \\mathbf{E}$，其中 $\\sigma$ 是电导率。因此，$\\nabla \\cdot (\\sigma \\mathbf{E}) = 0$。对于均匀相，这等价于 $\\sigma (\\nabla \\cdot \\mathbf{E}) = 0$，这与从高斯定律导出的条件 $\\nabla \\cdot \\mathbf{E} = 0$（对于 $\\sigma \\neq 0$）是一致的。\n\n在两种液体之间的界面（$r=a$）处，我们必须应用从控制方程的积分形式导出的跳跃条件：\n1.  电势的连续性：沿一条穿过界面的路径对 $\\mathbf{E} = -\\nabla \\phi$ 进行积分表明，电势 $\\phi$ 必须是连续的，即 $\\llbracket \\phi \\rrbracket \\equiv \\phi_o - \\phi_i = 0$，以避免出现无穷大的切向电场。这直接意味着电场切向分量的连续性，即 $\\llbracket \\mathbf{t} \\cdot \\mathbf{E} \\rrbracket = 0$。\n2.  界面处的高斯定律：将高斯定律的积分形式 $\\oint \\mathbf{D} \\cdot d\\mathbf{S} = Q_{\\text{free, enc}}$ 应用于一个跨界面的薄扁圆柱体，可得出 $\\mathbf{D}$ 法向分量的跳跃条件。这给出 $\\hat{\\mathbf{n}} \\cdot (\\mathbf{D}_o - \\mathbf{D}_i) = q_s$，其中 $q_s$ 是表面自由电荷密度，$\\hat{\\mathbf{n}}$ 是从区域 i 指向区域 o 的法向量。当 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{r}}$ 且 $\\mathbf{D}=\\epsilon\\mathbf{E}$ 时，该式变为 $\\epsilon_o E_{on} - \\epsilon_i E_{in} = q_s$，或 $\\llbracket \\epsilon E_n \\rrbracket = q_s$。\n3.  界面处的电荷守恒：将电荷守恒的积分形式应用于该扁圆柱体，假设系统处于稳态（$\\frac{\\partial q_s}{\\partial t}=0$）且界面电荷对流可忽略不计，则要求总电流的法向分量是连续的。此处，电流是纯欧姆性的，因此 $\\hat{\\mathbf{n}} \\cdot (\\mathbf{J}_o - \\mathbf{J}_i) = 0$。代入欧姆定律，得到 $\\sigma_o E_{on} - \\sigma_i E_{in} = 0$，或 $\\llbracket \\sigma E_n \\rrbracket = 0$。\n\n现在我们使用给定的形式来求解电势：\n外部电势：$\\phi_{o}(r,\\theta)=-E_{0} r \\cos\\theta + \\frac{B}{r^{2}}\\cos\\theta$\n内部电势：$\\phi_{i}(r,\\theta)=-A r \\cos\\theta$\n\n电场分量可通过 $\\mathbf{E} = -\\nabla\\phi = -(\\frac{\\partial\\phi}{\\partial r}\\hat{\\mathbf{r}} + \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\hat{\\boldsymbol{\\theta}})$ 求得。\n径向（法向）电场分量 $E_n = \\mathbf{E} \\cdot \\hat{\\mathbf{r}} = -\\frac{\\partial\\phi}{\\partial r}$ 为：\n$$ E_{on}(r,\\theta) = E_{0}\\cos\\theta + \\frac{2B}{r^{3}}\\cos\\theta $$\n$$ E_{in}(r,\\theta) = A\\cos\\theta $$\n\n我们在界面 $r=a$ 处应用两个主要边界条件来确定常数 $A$ 和 $B$。\n\n首先，电势连续性，$\\phi_o(a, \\theta) = \\phi_i(a, \\theta)$:\n$$ -E_{0} a \\cos\\theta + \\frac{B}{a^{2}}\\cos\\theta = -A a \\cos\\theta $$\n假设此式对所有 $\\theta$ 成立，我们可以除以 $\\cos\\theta$（对于 $\\theta \\neq \\pi/2$）：\n$$ -E_{0} a + \\frac{B}{a^{2}} = -A a $$\n$$ A = E_{0} - \\frac{B}{a^{3}} \\quad (1)$$\n\n其次，欧姆电流法向分量的连续性，$\\sigma_o E_{on}(a, \\theta) = \\sigma_i E_{in}(a, \\theta)$:\n$$ \\sigma_{o} \\left( E_{0}\\cos\\theta + \\frac{2B}{a^{3}}\\cos\\theta \\right) = \\sigma_{i} (A\\cos\\theta) $$\n同样，我们除以 $\\cos\\theta$：\n$$ \\sigma_{o} \\left( E_{0} + \\frac{2B}{a^{3}} \\right) = \\sigma_{i} A \\quad (2)$$\n\n现在我们得到了一个关于 $A$ 和 $B$ 的二元线性方程组。将方程 (1) 代入方程 (2)：\n$$ \\sigma_{o} \\left( E_{0} + \\frac{2B}{a^{3}} \\right) = \\sigma_{i} \\left( E_{0} - \\frac{B}{a^{3}} \\right) $$\n展开并重新整理各项以求解 $B$：\n$$ \\sigma_{o} E_{0} + \\frac{2\\sigma_{o}B}{a^{3}} = \\sigma_{i} E_{0} - \\frac{\\sigma_{i}B}{a^{3}} $$\n$$ \\frac{2\\sigma_{o}B}{a^{3}} + \\frac{\\sigma_{i}B}{a^{3}} = \\sigma_{i} E_{0} - \\sigma_{o} E_{0} $$\n$$ \\frac{B}{a^{3}} (2\\sigma_{o} + \\sigma_{i}) = E_{0} (\\sigma_{i} - \\sigma_{o}) $$\n$$ B = a^{3} E_{0} \\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}} $$\n\n问题通过关系式 $B=a^{3} E_{0}\\,K$ 定义了无量纲极化因子 $K$。通过与我们推导出的 $B$ 的表达式直接比较，我们可以确定 $K$ 的表达式：\n$$ K = \\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}} $$\n该表达式仅取决于电导率 $\\sigma_{i}$ 和 $\\sigma_{o}$，这与问题陈述的要求一致。介电常数 $\\epsilon_{i}$ 和 $\\epsilon_{o}$ 决定了在界面上累积的自由电荷量 $q_s$，但不影响稳态电势分布，后者完全由电导率决定。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}}}\n$$"
        },
        {
            "introduction": "“漏电介质”模型的一个关键特征是自由电荷在流体-流体界面上的积聚。本练习旨在探究其根本的物理机制：即两种材料在电荷弛豫时间（$\\tau = \\epsilon/\\sigma$）上的不匹配。通过计算和比较常见液体的这一关键时间尺度，您将建立起对界面电荷为何以及如何积聚的物理直觉，而这正是直流电场中大多数电致流体动力学现象的直接原因。",
            "id": "4085382",
            "problem": "考虑两种不相溶的、牛顿型的、弱导电介电液体（水和硅油），它们由一个平面界面隔开，并置于一个垂直于该界面的空间均匀直流（DC）电场中。在泰勒-梅尔彻（Taylor–Melcher）漏电介质模型下，仅使用基本静电学和电荷守恒原理，推导均匀相中空间均匀的体自由电荷密度衰减的特征时间尺度。然后，使用水和硅油的典型材料特性，计算水中电荷弛豫时间与硅油中电荷弛豫时间的无量纲比值，并利用该比值评估哪个相充电更快及其对界面电荷积累的影响。\n\n使用以下典型值：\n- 真空介电常数：$\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$。\n- 水：介电常数 $\\epsilon_{w} = 80\\,\\epsilon_{0}$，电导率 $\\sigma_{w} = 1.0 \\times 10^{-3}\\ \\mathrm{S/m}$。\n- 硅油：介电常数 $\\epsilon_{o} = 2.5\\,\\epsilon_{0}$，电导率 $\\sigma_{o} = 1.0 \\times 10^{-11}\\ \\mathrm{S/m}$。\n\n将最终答案表示为无量纲比值 $R = \\tau_{w}/\\tau_{o}$，其中 $\\tau_{w}$ 和 $\\tau_{o}$ 分别是水和硅油的电荷弛豫时间。将您的答案四舍五入至三位有效数字，并以无量纲数的形式报告。此外，根据漏电介质模型，评论哪个相充电更快以及这对界面电荷积累有何影响（您的定性评论不属于最终数值答案的一部分）。",
            "solution": "该问题被验证为具有科学依据、提法明确、客观且完整。所有推导特征电荷弛豫时间和计算所需比值的必要物理原理和材料常数均已提供。该问题是电流体动力学中的一个标准练习，具体涉及泰勒-梅尔彻（Taylor-Melcher）漏电介质模型。\n\n推导体自由电荷密度衰减的特征时间尺度，始于导电介质电磁学的三个基本方程。首先，电场高斯定律将电场 $\\mathbf{E}$ 的散度与自由电荷密度 $\\rho_f$ 联系起来。对于介电常数 $\\epsilon$ 恒定的均匀介质，该定律为：\n$$ \\nabla \\cdot \\mathbf{E} = \\frac{\\rho_f}{\\epsilon} $$\n\n其次，电荷守恒原理由连续性方程表示，该方程将电荷密度随时间的变化率与自由电流密度 $\\mathbf{J}$ 的散度联系起来：\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0 $$\n\n第三，对于弱导电介质（欧姆导体），电流密度与电场成正比，如欧姆定律所述：\n$$ \\mathbf{J} = \\sigma \\mathbf{E} $$\n其中 $\\sigma$ 是介质的电导率。\n\n为了找到电荷密度随时间的演变，我们组合这些方程。我们将欧姆定律代入连续性方程：\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\nabla \\cdot (\\sigma \\mathbf{E}) = 0 $$\n对于指定的均匀相，电导率 $\\sigma$ 在空间上是均匀的。因此，可以将其从散度算子中提出：\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\sigma (\\nabla \\cdot \\mathbf{E}) = 0 $$\n接下来，我们将高斯定律 $\\nabla \\cdot \\mathbf{E} = \\rho_f / \\epsilon$ 代入此表达式：\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\sigma \\left( \\frac{\\rho_f}{\\epsilon} \\right) = 0 $$\n问题陈述我们正在考虑一个“空间均匀的体自由电荷密度”。这意味着 $\\rho_f$ 仅是时间 $t$ 的函数，即 $\\rho_f(t)$，因此偏导数变为常导数：\n$$ \\frac{d\\rho_f}{dt} = -\\frac{\\sigma}{\\epsilon} \\rho_f $$\n这是一个一阶线性齐次常微分方程。其解是一个指数衰减函数。如果 $t=0$ 时的初始电荷密度为 $\\rho_{f,0}$，则解为：\n$$ \\rho_f(t) = \\rho_{f,0} \\exp\\left(-\\frac{\\sigma}{\\epsilon} t\\right) $$\n该解描述了任何初始非平衡体电荷密度随时间耗散的过程。此衰减的特征时间尺度，称为电荷弛豫时间 $\\tau$，是电荷密度衰减到其初始值的 $1/e$ 所需的时间。通过将该解与标准形式 $\\rho_f(t) = \\rho_{f,0} \\exp(-t/\\tau)$ 进行比较，我们可以确定电荷弛豫时间为：\n$$ \\tau = \\frac{\\epsilon}{\\sigma} $$\n此表达式代表均匀漏电介质的体相恢复到电中性状态所需的特征时间尺度。\n\n利用这个推导出的表达式，我们现在可以计算水（下标 $w$）和硅油（下标 $o$）的无量纲比值 $R = \\tau_{w}/\\tau_{o}$。各自的电荷弛豫时间为：\n$$ \\tau_{w} = \\frac{\\epsilon_{w}}{\\sigma_{w}} $$\n$$ \\tau_{o} = \\frac{\\epsilon_{o}}{\\sigma_{o}} $$\n因此，比值 $R$ 为：\n$$ R = \\frac{\\tau_{w}}{\\tau_{o}} = \\frac{\\epsilon_{w}/\\sigma_{w}}{\\epsilon_{o}/\\sigma_{o}} = \\left(\\frac{\\epsilon_{w}}{\\epsilon_{o}}\\right) \\left(\\frac{\\sigma_{o}}{\\sigma_{w}}\\right) $$\n我们已知材料特性：\n$\\epsilon_{w} = 80\\,\\epsilon_{0}$\n$\\sigma_{w} = 1.0 \\times 10^{-3}\\ \\mathrm{S/m}$\n$\\epsilon_{o} = 2.5\\,\\epsilon_{0}$\n$\\sigma_{o} = 1.0 \\times 10^{-11}\\ \\mathrm{S/m}$\n\n让我们分别计算介电常数和电导率的比值。介电常数的比值为：\n$$ \\frac{\\epsilon_{w}}{\\epsilon_{o}} = \\frac{80\\,\\epsilon_{0}}{2.5\\,\\epsilon_{0}} = \\frac{80}{2.5} = 32 $$\n电导率的比值为：\n$$ \\frac{\\sigma_{o}}{\\sigma_{w}} = \\frac{1.0 \\times 10^{-11}\\ \\mathrm{S/m}}{1.0 \\times 10^{-3}\\ \\mathrm{S/m}} = 1.0 \\times 10^{-8} $$\n现在，我们将这两个比值相乘以求得 $R$：\n$$ R = (32) \\times (1.0 \\times 10^{-8}) = 3.2 \\times 10^{-7} $$\n按要求四舍五入至三位有效数字，结果为 $3.20 \\times 10^{-7}$。\n\n最后，我们评估这一结果的意义。比值 $R = \\tau_w / \\tau_o$ 极小（$R \\ll 1$），这意味着水中的电荷弛豫时间比硅油中的电荷弛豫时间短了许多个数量级（$\\tau_w \\ll \\tau_o$）。电荷弛豫时间是材料响应电场以及自由电荷重新分布的特征时间。较小的 $\\tau$ 意味着更快的响应。因此，水“充电”（或者更准确地说，耗散体电荷）的速度远快于硅油。\n\n在泰勒-梅尔彻（Taylor-Melcher）漏电介质模型的背景下，两种不相溶液体界面处自由电荷积累的条件是它们的电荷弛豫时间不同，即 $\\tau_w \\neq \\tau_o$。由于 $\\tau_w$ 和 $\\tau_o$ 相差约 $3 \\times 10^6$ 倍，因此在水-油界面处会积累大量电荷。导电性更强的液体（水）将电荷输送到界面的速度，远快于导电性较弱的液体（油）将其输送走的速度。这种不平衡导致界面上自由表面电荷密度的净积累，这是直流电场下液滴变形和破裂等电流体动力学界面现象的核心机制。",
            "answer": "$$\\boxed{3.20 \\times 10^{-7}}$$"
        },
        {
            "introduction": "解析模型为计算代码的验证提供了重要的基准。这项动手计算练习要求您实现一个理想介质液滴的静电学模型，并验证著名的泰勒小变形定律。您将通过数值方法计算界面上的麦克斯韦应力，并确认所产生的变形参数$D$与电毛细数$Ca_E$呈线性关系，同时通过收敛性研究来确保数值方案的准确性。",
            "id": "4085442",
            "problem": "一个半径为 $a$ 的球形液滴浸没在表面张力为 $\\gamma$ 的无界、静止的粘性流体中。沿 $z$ 轴施加一个大小为 $E_0$ 的轴对称、稳定、均匀的电场。液滴和外部是线性电介质，其介电常数分别为 $\\epsilon_{\\mathrm{in}}$ 和 $\\epsilon_{\\mathrm{out}}$，并且体相内没有自由电荷。考虑漏电介质模型在电导可忽略极限下的小变形情况，此时静电学由拉普拉斯方程控制，边界条件为界面上电势连续、切向电场连续以及法向电位移连续。电毛细数定义为 $Ca_E = \\epsilon_{\\mathrm{out}} E_0^2 a / \\gamma$。\n\nTaylor 小变形定律断言，对于足够小的 $Ca_E$，液滴的稳态变形参数 $D$ 满足 $D \\propto Ca_E$。变形参数定义为 $D = (L - B)/(L + B)$，其中 $L$ 和 $B$ 分别是沿电场方向和垂直于电场方向的半轴。在小变形极限下，界面可以表示为 $r(\\theta) = a \\left( 1 + \\alpha P_2(\\cos\\theta) \\right)$，其中 $\\theta$ 是从电场方向测量的极角，$\\alpha$ 是一个小振幅，$P_2(\\cdot)$ 是二阶勒让德多项式。对应于 $l=2$ 模态的线性化毛细曳力与跨界面的麦克斯韦法向应力跳变相平衡。将球形界面上的麦克斯韦法向曳力跳变表示为 $\\Delta T_n(\\theta)$，并将其勒让德 $l=2$ 系数表示为 $T_2$，该系数由 $\\Delta T_n(\\theta)$ 在勒让德多项式中的级数展开定义。线性化的法向应力平衡得出了 $\\alpha$ 和 $T_2$ 之间的关系，并且变形参数 $D$ 与 $\\alpha$ 相关。\n\n您的任务是设计一个验证基准，该基准能够数值再现 Taylor 小变形标度关系 $D \\propto Ca_E$，并报告计算出的勒让德模态系数 $T_2$ 的网格/加密收敛性研究。该基准必须按以下方式从第一性原理构建：\n\n1. 使用拉普拉斯方程的基本解，求解均匀电场中电介质球的轴对称静电问题，并采用适用于电介质的边界条件：球形界面上电势连续、切向电场连续以及法向电位移连续。设介电常数比为 $S = \\epsilon_{\\mathrm{in}} / \\epsilon_{\\mathrm{out}}$。\n\n2. 使用界面上得到的电场，计算麦克斯韦法向应力跳变\n$$\n\\Delta T_n(\\theta) = \\epsilon_{\\mathrm{out}} \\left( E_{\\mathrm{out},n}^2(\\theta) - \\tfrac{1}{2} \\lvert \\mathbf{E}_{\\mathrm{out}}(\\theta) \\rvert^2 \\right) - \\epsilon_{\\mathrm{in}} \\left( E_{\\mathrm{in},n}^2(\\theta) - \\tfrac{1}{2} \\lvert \\mathbf{E}_{\\mathrm{in}}(\\theta) \\rvert^2 \\right).\n$$\n所有角度必须以弧度处理。\n\n3. 利用勒让德多项式的正交性，将 $\\Delta T_n(\\theta)$ 投影到 $P_2(\\cos\\theta)$ 上以获得其 $l=2$ 勒让德系数 $T_2$。该系数定义为\n$$\nT_2 = \\frac{5}{2} \\int_{-1}^{1} \\Delta T_n(\\theta(\\mu)) \\, P_2(\\mu) \\, d\\mu, \\quad \\mu = \\cos\\theta,\n$$\n使用复合梯形法则，在一个包含 $N$ 个节点的 $\\mu \\in [-1,1]$ 均匀网格上进行数值计算。请注意 $P_2(\\mu) = \\tfrac{1}{2}(3\\mu^2 - 1)$。\n\n4. 使用 $l=2$ 模态的线性化法向应力平衡，通过毛细恢复曳力将振幅 $\\alpha$ 与 $T_2$ 关联起来。在小变形极限下，球谐模态 $l$ 经历的毛细曳力与 $(l-1)(l+2)$ 成正比，因此对于 $l=2$，推导出 $\\alpha$ 和 $T_2$ 之间的关系。然后将 $D$ 与 $\\alpha$ 联系起来，并证明 $D$ 与 $Ca_E$ 成正比，其斜率由材料比率 $S$ 决定。\n\n5. 按如下方式定义测试套件和输出。使用以下物理参数\n- $\\epsilon_{\\mathrm{out}} = 2.5 \\times 10^{-11}\\,\\mathrm{F/m}$，\n- $a = 50 \\times 10^{-6}\\,\\mathrm{m}$，\n- $\\gamma = 0.03\\,\\mathrm{N/m}$，\n- 对于一般情况，$S = 3$，\n并将电场强度大小表示为 $E_0$，并相应计算 $Ca_E$。对于收敛性研究，使用复合梯形法则，其中 $N$ 取集合 $\\{16, 32, 64, 128, 256, 512\\}$ 中的每个值，并使用 $N_{\\mathrm{ref}} = 4096$ 的高分辨率参考值。\n\n6. 您的程序必须产生以下输出：\n- 首先，通过使用 $N_{\\mathrm{ref}}$ 计算三种不同场强 $E_0 \\in \\{5.0 \\times 10^5\\,\\mathrm{V/m}, 8.0 \\times 10^5\\,\\mathrm{V/m}, 1.2 \\times 10^6\\,\\mathrm{V/m}\\}$ 下的比率 $D/Ca_E$ 来验证 $D \\propto Ca_E$。这些比率是无量纲的浮点数，应直接报告。\n- 其次，随着 $N$ 的加密，计算通过梯形法则近似 $T_2$ 的观测收敛阶。对于序列 $\\{16, 32, 64, 128, 256, 512\\}$ 中的每一连续对 $(N_i, N_{i+1})$，计算每个 $N$ 下 $D$ 相对于 $N_{\\mathrm{ref}}$ 结果的绝对误差，然后使用以下公式估计收敛阶 $p$\n$$\np \\approx \\frac{\\log\\left( \\mathrm{err}(N_i) / \\mathrm{err}(N_{i+1}) \\right)}{\\log\\left( N_{i+1} / N_i \\right)}.\n$$\n报告这五个浮点估计值的列表。\n- 第三，在 $E_0 = 8.0 \\times 10^5\\,\\mathrm{V/m}$ 和 $N_{\\mathrm{ref}}$ 条件下，测试 $S = 1$（介电常数相等）的边界情况，此时对称性意味着没有四极法向曳力，因此 $D \\approx 0$。报告一个布尔值，指示 $\\lvert D \\rvert$ 是否小于 $10^{-12}$。\n\n所有报告的浮点数都应纯粹通过数值方法计算，不使用封闭形式的捷径。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，格式必须为`[[r1,r2,r3],[p1,p2,p3,p4,p5],b]`。不应打印任何其他文本，并且程序不得要求任何用户输入。所有角度以弧度表示；所有电场以 $\\mathrm{V/m}$ 表示；$\\epsilon$ 以 $\\mathrm{F/m}$ 表示；$\\gamma$ 以 $\\mathrm{N/m}$ 表示；$a$ 以 $\\mathrm{m}$ 表示。除布尔值外，所有输出都是无量纲的。",
            "solution": "用户提供的问题已经过严格验证，并被确定为计算电水动力学领域中一个有效、适定且具有科学依据的问题。它没有矛盾、歧义和事实错误。问题陈述为推导和数值验证均匀电场中电介质液滴的 Taylor 小变形定律提供了清晰且合乎逻辑的路径。因此，我们可以进行完整的解答。\n\n解决方案是按照问题陈述中概述的步骤构建的。所有数学表达式都按要求使用 LaTeX 渲染。\n\n### 第 1 步：轴对称静电问题\n\n物理系统由一个半径为 $a$、介电常数为 $\\epsilon_{\\mathrm{in}}$ 的电介质球组成，该球浸没在介电常数为 $\\epsilon_{\\mathrm{out}}$ 的无界电介质介质中。施加一个均匀电场 $\\mathbf{E} = E_0 \\hat{\\mathbf{z}}$。电势 $\\Phi$ 必须在内部和外部区域都满足拉普拉斯方程 $\\nabla^2 \\Phi = 0$，并服从界面 $r=a$ 和无穷远处的边界条件。\n\n在球坐标系 $(r, \\theta, \\phi)$ 中，当 $z$ 轴与电场对齐时，问题是轴对称的，电势与 $\\phi$ 无关。拉普拉斯方程的通解是一系列勒让德多项式 $P_l(\\cos\\theta)$。\n\n液滴外部的电势（$r \\geq a$），$\\Phi_{\\mathrm{out}}$，在 $r \\to \\infty$ 时必须趋近于均匀电场的电势 $-E_0 z = -E_0 r \\cos\\theta$。液滴内部的电势（$r \\leq a$），$\\Phi_{\\mathrm{in}}$，在原点 $r=0$ 处必须是有限的。这导致了以下电势形式：\n$$ \\Phi_{\\mathrm{out}}(r, \\theta) = -E_0 r P_1(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_l r^{-l-1} P_l(\\cos\\theta) $$\n$$ \\Phi_{\\mathrm{in}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l r^l P_l(\\cos\\theta) $$\n\n系数 $A_l$ 和 $B_l$ 由 $r=a$ 处的边界条件确定：\n1.  电势连续性：$\\Phi_{\\mathrm{in}}(a, \\theta) = \\Phi_{\\mathrm{out}}(a, \\theta)$。\n2.  电位移场 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 法向分量的连续性：$\\epsilon_{\\mathrm{in}} \\frac{\\partial \\Phi_{\\mathrm{in}}}{\\partial r}\\Big|_{r=a} = \\epsilon_{\\mathrm{out}} \\frac{\\partial \\Phi_{\\mathrm{out}}}{\\partial r}\\Big|_{r=a}$。\n\n通过匹配每个 $P_l(\\cos\\theta)$ 的系数，我们发现对于 $l \\neq 1$，$A_l=B_l=0$。对于 $l=1$，并定义介电常数比 $S = \\epsilon_{\\mathrm{in}} / \\epsilon_{\\mathrm{out}}$，我们求解 $A_1$ 和 $B_1$ 得到电势：\n$$ \\Phi_{\\mathrm{out}}(r, \\theta) = -E_0 r \\cos\\theta + E_0 a^3 \\frac{S-1}{S+2} \\frac{\\cos\\theta}{r^2} $$\n$$ \\Phi_{\\mathrm{in}}(r, \\theta) = -E_0 \\frac{3}{S+2} r \\cos\\theta $$\n\n然后计算电场 $\\mathbf{E} = -\\nabla\\Phi = -\\left(\\frac{\\partial\\Phi}{\\partial r}\\hat{\\mathbf{r}} + \\frac{1}{r}\\frac{\\partial\\Phi}{\\partial\\theta}\\hat{\\boldsymbol{\\theta}}\\right)$。在界面 $r=a$ 处，电场的法向（$E_n = E_r$）和切向（$E_t = E_\\theta$）分量为：\n液滴外部：\n$$ E_{\\mathrm{out},n}(\\theta) = E_{\\mathrm{out},r}(a,\\theta) = \\frac{3S}{S+2} E_0 \\cos\\theta $$\n$$ E_{\\mathrm{out},t}(\\theta) = E_{\\mathrm{out},\\theta}(a,\\theta) = -\\frac{3}{S+2} E_0 \\sin\\theta $$\n液滴内部：\n$$ E_{\\mathrm{in},n}(\\theta) = E_{\\mathrm{in},r}(a,\\theta) = \\frac{3}{S+2} E_0 \\cos\\theta $$\n$$ E_{\\mathrm{in},t}(\\theta) = E_{\\mathrm{in},\\theta}(a,\\theta) = -\\frac{3}{S+2} E_0 \\sin\\theta $$\n这些电场正确地满足边界条件 $E_{\\mathrm{in},t} = E_{\\mathrm{out},t}$ 和 $\\epsilon_{\\mathrm{in}} E_{\\mathrm{in},n} = \\epsilon_{\\mathrm{out}} E_{\\mathrm{out},n}$。\n\n### 第 2 步：麦克斯韦法向应力跳变\n\n跨界面的麦克斯韦应力张量法向分量的跳变 $\\Delta T_n$ 由下式给出：\n$$ \\Delta T_n(\\theta) = \\left[ \\epsilon \\left( E_n^2 - \\frac{1}{2} |\\mathbf{E}|^2 \\right) \\right]_{\\mathrm{out}} - \\left[ \\epsilon \\left( E_n^2 - \\frac{1}{2} |\\mathbf{E}|^2 \\right) \\right]_{\\mathrm{in}} $$\n使用 $|\\mathbf{E}|^2 = E_n^2 + E_t^2$，上式简化为：\n$$ \\Delta T_n(\\theta) = \\frac{1}{2} \\left[ (\\epsilon_{\\mathrm{out}} E_{\\mathrm{out},n}^2 - \\epsilon_{\\mathrm{in}} E_{\\mathrm{in},n}^2) - (\\epsilon_{\\mathrm{out}} E_{\\mathrm{out},t}^2 - \\epsilon_{\\mathrm{in}} E_{\\mathrm{in},t}^2) \\right] $$\n代入边界条件，第一项消失，第二项简化。代入 $r=a$ 处的电场分量可得：\n$$ \\Delta T_n(\\theta) = \\frac{9 \\epsilon_{\\mathrm{out}} E_0^2}{2 (S+2)^2} (S-1) \\left( (S-1) \\cos^2\\theta + 1 \\right) $$\n这就是要在数值积分中使用的表达式。\n\n### 第 3 步：获得 $T_2$ 的数值投影\n\n在 $\\Delta T_n(\\theta(\\mu))$ 的展开式中，二阶勒让德多项式 $P_2(\\mu) = \\frac{1}{2}(3\\mu^2 - 1)$（其中 $\\mu=\\cos\\theta$）的系数 $T_2$ 通过投影求得：\n$$ T_2 = \\frac{5}{2} \\int_{-1}^{1} \\Delta T_n(\\mu) \\, P_2(\\mu) \\, d\\mu $$\n此积分将使用复合梯形法则在 $\\mu \\in [-1, 1]$ 上的一个包含 $N$ 个点的均匀网格上进行数值计算。被积函数为 $f(\\mu) = \\Delta T_n(\\mu) P_2(\\mu)$。梯形法则将积分近似为 $\\int_{-1}^1 f(\\mu)d\\mu \\approx h \\left(\\frac{f(-1)+f(1)}{2} + \\sum_{i=1}^{N-2} f(\\mu_i) \\right)$，其中网格点为 $\\mu_i = -1 + i h$，步长为 $h = 2/(N-1)$。\n\n### 第 4 步：液滴变形\n\n在小变形极限下，液滴的变形由电应力和恢复性毛细应力之间的平衡决定。对于形状为 $r(\\theta) = a(1 + \\alpha P_2(\\cos\\theta))$ 的液滴，毛细压力 $P_c$ 会产生一个恢复性法向应力。对于 $l=2$ 模态，该应力等于 $\\frac{\\gamma}{a}(l-1)(l+2)\\alpha P_2(\\cos\\theta) = \\frac{4\\gamma}{a}\\alpha P_2(\\cos\\theta)$。该应力与麦克斯韦应力的 $l=2$ 分量 $T_2 P_2(\\cos\\theta)$ 相平衡。因此，我们有平衡方程：\n$$ T_2 = \\frac{4\\gamma}{a} \\alpha \\implies \\alpha = \\frac{a T_2}{4\\gamma} $$\n变形参数 $D = (L-B)/(L+B)$ 与振幅 $\\alpha$ 相关。半轴分别为 $L = r(\\theta=0) = a(1+\\alpha P_2(1)) = a(1+\\alpha)$ 和 $B = r(\\theta=\\pi/2) = a(1+\\alpha P_2(0)) = a(1-\\alpha/2)$。\n对于小 $\\alpha$：\n$$ D = \\frac{a(1+\\alpha) - a(1-\\alpha/2)}{a(1+\\alpha) + a(1-\\alpha/2)} = \\frac{3\\alpha/2}{2+\\alpha/2} \\approx \\frac{3}{4}\\alpha $$\n结合这些结果，我们找到变形与电应力之间的关系：\n$$ D = \\frac{3}{4} \\alpha = \\frac{3}{4} \\left( \\frac{a T_2}{4\\gamma} \\right) = \\frac{3aT_2}{16\\gamma} $$\n代入前面推导的 $T_2$ 的解析表达式，可以证明预期的标度关系：\n$$ D = \\frac{3a}{16\\gamma} \\left( \\frac{3 \\epsilon_{\\mathrm{out}} E_0^2 (S-1)^2}{(S+2)^2} \\right) = \\frac{9}{16} \\frac{(S-1)^2}{(S+2)^2} \\left( \\frac{\\epsilon_{\\mathrm{out}} E_0^2 a}{\\gamma} \\right) = \\left( \\frac{9}{16} \\frac{(S-1)^2}{(S+2)^2} \\right) Ca_E $$\n这证实了 $D \\propto Ca_E$。\n\n### 第 5 步：数值基准实现\n\n最终答案中的 Python 代码实现了此框架，以执行所需的数值任务。\n1.  定义了一个函数 `compute_D`，通过数值计算 $T_2$ 并应用推导出的关系，来计算给定一组物理和数值参数（$E_0$、$S$、$N$ 等）下的变形参数 $D$。\n2.  为验证标度关系 $D \\propto Ca_E$，在高分辨率（$N=N_{\\mathrm{ref}}$）下计算三种不同场强 $E_0$ 的比率 $D/Ca_E$。我们期望这个比率是恒定的。\n3.  通过计算一系列网格尺寸 $N$ 下的 $D$ 来进行网格加密研究。相对于高分辨率参考解的误差被用来计算观测到的收敛阶，对于梯形法则，预期收敛阶为 $p=2$。\n4.  测试了 $S=1$（介电常数相同）的边界情况。在这种情况下，$\\Delta T_n=0$，这意味着 $T_2=0$，因此 $D=0$。代码验证了数值计算出的 $|D|$ 低于一个小的容差。\n\n最终的程序结构直接反映了此计划。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the electrohydrodynamics problem as specified.\n    - Computes the Taylor deformation parameter D for a dielectric droplet.\n    - Verifies the scaling D is proportional to Ca_E.\n    - Performs a convergence study for the numerical integration.\n    - Tests the edge case of equal permittivities.\n    \"\"\"\n\n    # --- Physical Parameters ---\n    epsilon_out = 2.5e-11  # F/m\n    a = 50e-6             # m\n    gamma = 0.03          # N/m\n\n    # --- Test Case Parameters ---\n    S_general = 3.0\n    S_edge = 1.0\n    E0_fields = [5.0e5, 8.0e5, 1.2e6]  # V/m\n    E0_conv_study = 8.0e5               # V/m\n    E0_edge_case = 8.0e5                # V/m\n    N_values = [16, 32, 64, 128, 256, 512]\n    N_ref = 4096\n\n    def compute_D(E0, S, N, epsilon_out, a, gamma):\n        \"\"\"\n        Computes the droplet deformation parameter D numerically.\n        \"\"\"\n        # Set up the uniform grid in mu = cos(theta)\n        mu = np.linspace(-1.0, 1.0, N)\n\n        # Calculate the Maxwell normal stress jump Delta_T_n(mu)\n        # Delta_T_n(mu) = (9 * eps_out * E0^2 * (S-1)) / (2 * (S+2)^2) * ((S-1)*mu^2 + 1)\n        # This is computed numerically as requested, without analytical shortcuts in the main logic.\n        const_term = (9.0 * epsilon_out * E0**2) / (2.0 * (S + 2.0)**2)\n        delta_Tn_vals = const_term * (S - 1.0) * ((S - 1.0) * mu**2 + 1.0)\n\n        # Second Legendre polynomial P2(mu)\n        P2_vals = 0.5 * (3.0 * mu**2 - 1.0)\n\n        # Integrand for the T2 projection\n        integrand = delta_Tn_vals * P2_vals\n\n        # Numerically integrate using the composite trapezoidal rule\n        integral_val = np.trapz(integrand, x=mu)\n\n        # Compute the Legendre coefficient T2\n        T2 = (5.0 / 2.0) * integral_val\n\n        # Relate T2 to the deformation amplitude alpha\n        # T2 = (4 * gamma / a) * alpha\n        alpha = (a * T2) / (4.0 * gamma)\n\n        # Relate alpha to the deformation parameter D for small deformations\n        # D approx (3/4) * alpha\n        D = (3.0 / 4.0) * alpha\n        \n        return D\n\n    # 1. Verify D is proportional to Ca_E\n    ratios = []\n    for E0 in E0_fields:\n        D_val = compute_D(E0, S_general, N_ref, epsilon_out, a, gamma)\n        Ca_E = (epsilon_out * E0**2 * a) / gamma\n        # Avoid division by zero if Ca_E is zero\n        if Ca_E > 0:\n            ratios.append(D_val / Ca_E)\n        else:\n            ratios.append(0.0)\n\n    # 2. Compute convergence orders\n    D_ref = compute_D(E0_conv_study, S_general, N_ref, epsilon_out, a, gamma)\n    \n    errors = []\n    for N in N_values:\n        D_N = compute_D(E0_conv_study, S_general, N, epsilon_out, a, gamma)\n        errors.append(abs(D_N - D_ref))\n\n    orders = []\n    for i in range(len(N_values) - 1):\n        # p = log(err_i / err_{i+1}) / log(N_i+1 / N_i)\n        # Since N doubles at each step, log(N_i+1 / N_i) = log(2)\n        if errors[i] > 0 and errors[i+1] > 0:\n            order = np.log(errors[i] / errors[i+1]) / np.log(2.0)\n            orders.append(order)\n        else:\n            # If error is zero, convergence is perfect. Append a placeholder.\n            orders.append(np.inf) # This case shouldn't be hit with float precision issues\n\n    # 3. Test the edge case S=1\n    D_edge = compute_D(E0_edge_case, S_edge, N_ref, epsilon_out, a, gamma)\n    is_zero = abs(D_edge)  1e-12\n\n    # Final print statement in the exact required format\n    ratios_str = '[' + ','.join(map(str, ratios)) + ']'\n    orders_str = '[' + ','.join(map(str, orders)) + ']'\n    boolean_str = str(is_zero).lower()\n    \n    print(f\"[{ratios_str},{orders_str},{boolean_str}]\")\n\nsolve()\n```"
        }
    ]
}