{
    "hands_on_practices": [
        {
            "introduction": "The power of the leaky dielectric model lies in its recognition that real-world fluids are neither perfect insulators nor perfect conductors. This practice delves into the fundamental timescale governing charge dynamics, the charge relaxation time $\\tau = \\epsilon / \\sigma$. By deriving this key parameter from first principles and applying it to a common liquid-liquid system, you will gain crucial physical intuition for why and how free charge accumulates at an interface, which is the very engine that drives many electrohydrodynamic flows .",
            "id": "4085382",
            "problem": "Consider two immiscible, Newtonian, weakly conducting dielectric liquids (water and silicone oil) separated by a planar interface and subjected to a spatially uniform Direct Current (DC) electric field normal to the interface. Under the Taylor–Melcher leaky dielectric model, use only fundamental electrostatics and charge conservation to derive the characteristic timescale over which a spatially uniform bulk free-charge density in a homogeneous phase decays. Then, using typical material properties for water and silicone oil, compute the dimensionless ratio of the charge relaxation time in water to that in silicone oil, and use this ratio to assess which phase will charge faster and the implications for interfacial charge accumulation.\n\nUse the following typical values:\n- Vacuum permittivity: $\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$.\n- Water: permittivity $\\epsilon_{w} = 80\\,\\epsilon_{0}$, conductivity $\\sigma_{w} = 1.0 \\times 10^{-3}\\ \\mathrm{S/m}$.\n- Silicone oil: permittivity $\\epsilon_{o} = 2.5\\,\\epsilon_{0}$, conductivity $\\sigma_{o} = 1.0 \\times 10^{-11}\\ \\mathrm{S/m}$.\n\nExpress the final answer as the dimensionless ratio $R = \\tau_{w}/\\tau_{o}$, where $\\tau_{w}$ and $\\tau_{o}$ are the charge relaxation times of water and silicone oil, respectively. Round your answer to three significant figures and report it as a dimensionless number. Additionally, comment on which phase charges faster and how this affects interfacial charge accumulation according to the leaky dielectric model (your qualitative comments will not be part of the final numeric answer).",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary physical principles and material constants are provided to derive the characteristic charge relaxation time and compute the required ratio. The problem is a standard exercise in electrohydrodynamics, specifically concerning the Taylor-Melcher leaky dielectric model.\n\nThe derivation of the characteristic timescale for the decay of a bulk free-charge density begins with three fundamental equations of electromagnetism for a conducting dielectric medium. First, Gauss's law for electricity relates the divergence of the electric field $\\mathbf{E}$ to the free-charge density $\\rho_f$. For a homogeneous medium with constant permittivity $\\epsilon$, this is:\n$$ \\nabla \\cdot \\mathbf{E} = \\frac{\\rho_f}{\\epsilon} $$\n\nSecond, the principle of charge conservation is expressed by the continuity equation, which relates the time rate of change of charge density to the divergence of the free current density $\\mathbf{J}$:\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0 $$\n\nThird, for a weakly conducting medium (an ohmic conductor), the current density is proportional to the electric field, as described by Ohm's law:\n$$ \\mathbf{J} = \\sigma \\mathbf{E} $$\nwhere $\\sigma$ is the electrical conductivity of the medium.\n\nTo find the time evolution of the charge density, we combine these equations. We substitute Ohm's law into the continuity equation:\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\nabla \\cdot (\\sigma \\mathbf{E}) = 0 $$\nFor a homogeneous phase as specified, the conductivity $\\sigma$ is spatially uniform. Therefore, it can be taken outside the divergence operator:\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\sigma (\\nabla \\cdot \\mathbf{E}) = 0 $$\nNext, we substitute Gauss's law, $\\nabla \\cdot \\mathbf{E} = \\rho_f / \\epsilon$, into this expression:\n$$ \\frac{\\partial \\rho_f}{\\partial t} + \\sigma \\left( \\frac{\\rho_f}{\\epsilon} \\right) = 0 $$\nThe problem states we are considering a \"spatially uniform bulk free-charge density.\" This implies that $\\rho_f$ is a function of time $t$ only, $\\rho_f(t)$, so the partial derivative becomes an ordinary derivative:\n$$ \\frac{d\\rho_f}{dt} = -\\frac{\\sigma}{\\epsilon} \\rho_f $$\nThis is a first-order linear homogeneous ordinary differential equation. The solution is an exponential decay function. If the initial charge density at time $t=0$ is $\\rho_{f,0}$, the solution is:\n$$ \\rho_f(t) = \\rho_{f,0} \\exp\\left(-\\frac{\\sigma}{\\epsilon} t\\right) $$\nThis solution describes the process by which any initial non-equilibrium bulk charge density dissipates over time. The characteristic timescale of this decay, known as the charge relaxation time $\\tau$, is the time it takes for the charge density to decay to $1/e$ of its initial value. By comparing the solution to the standard form $\\rho_f(t) = \\rho_{f,0} \\exp(-t/\\tau)$, we can identify the charge relaxation time as:\n$$ \\tau = \\frac{\\epsilon}{\\sigma} $$\nThis expression represents the characteristic timescale over which a homogeneous leaky dielectric medium returns to an electroneutral state in its bulk.\n\nWith this derived expression, we can now compute the dimensionless ratio $R = \\tau_{w}/\\tau_{o}$ for water (subscript $w$) and silicone oil (subscript $o$). The respective charge relaxation times are:\n$$ \\tau_{w} = \\frac{\\epsilon_{w}}{\\sigma_{w}} $$\n$$ \\tau_{o} = \\frac{\\epsilon_{o}}{\\sigma_{o}} $$\nThe ratio $R$ is therefore:\n$$ R = \\frac{\\tau_{w}}{\\tau_{o}} = \\frac{\\epsilon_{w}/\\sigma_{w}}{\\epsilon_{o}/\\sigma_{o}} = \\left(\\frac{\\epsilon_{w}}{\\epsilon_{o}}\\right) \\left(\\frac{\\sigma_{o}}{\\sigma_{w}}\\right) $$\nWe are given the material properties:\n$\\epsilon_{w} = 80\\,\\epsilon_{0}$\n$\\sigma_{w} = 1.0 \\times 10^{-3}\\ \\mathrm{S/m}$\n$\\epsilon_{o} = 2.5\\,\\epsilon_{0}$\n$\\sigma_{o} = 1.0 \\times 10^{-11}\\ \\mathrm{S/m}$\n\nLet's compute the ratios of permittivity and conductivity separately. The ratio of permittivities is:\n$$ \\frac{\\epsilon_{w}}{\\epsilon_{o}} = \\frac{80\\,\\epsilon_{0}}{2.5\\,\\epsilon_{0}} = \\frac{80}{2.5} = 32 $$\nThe ratio of conductivities is:\n$$ \\frac{\\sigma_{o}}{\\sigma_{w}} = \\frac{1.0 \\times 10^{-11}\\ \\mathrm{S/m}}{1.0 \\times 10^{-3}\\ \\mathrm{S/m}} = 1.0 \\times 10^{-8} $$\nNow, we multiply these two ratios to find $R$:\n$$ R = (32) \\times (1.0 \\times 10^{-8}) = 3.2 \\times 10^{-7} $$\nRounding to three significant figures as requested, the result is $3.20 \\times 10^{-7}$.\n\nFinally, we assess the implications of this result. The ratio $R = \\tau_w / \\tau_o$ is extremely small ($R \\ll 1$), which means that the charge relaxation time in water is many orders of magnitude shorter than in silicone oil ($\\tau_w \\ll \\tau_o$). The charge relaxation time is the characteristic time for the material to respond to an electric field and for free charges to redistribute. A smaller $\\tau$ signifies a faster response. Therefore, water \"charges\" (or more accurately, dissipates bulk charge) much faster than silicone oil.\n\nIn the context of the Taylor-Melcher leaky dielectric model, the condition for the accumulation of free charge at the interface between the two immiscible liquids is that their charge relaxation times are different, i.e., $\\tau_w \\neq \\tau_o$. Since $\\tau_w$ and $\\tau_o$ differ by a factor of approximately $3 \\times 10^6$, significant charge will accumulate at the water-oil interface. The more conductive liquid (water) transports charge to the interface much more rapidly than the less conductive liquid (oil) can transport it away. This imbalance causes a net buildup of free surface charge density at the interface, which is the central mechanism for electrohydrodynamic interfacial phenomena like drop deformation and breakup under DC fields.",
            "answer": "$$\\boxed{3.20 \\times 10^{-7}}$$"
        },
        {
            "introduction": "With the concept of charge relaxation in hand, we now turn to solving for the electric field in a canonical electrohydrodynamics system: a single liquid drop suspended in another fluid. This exercise guides you through applying the leaky dielectric boundary conditions—specifically the continuity of potential and normal current—to solve for the electric potential both inside and outside the drop. Mastering this fundamental problem provides the analytical foundation needed to calculate the electric stresses responsible for drop deformation and motion .",
            "id": "4085427",
            "problem": "A spherical liquid drop of radius $a$ with electrical conductivity $\\sigma_{i}$ and permittivity $\\epsilon_{i}$ is suspended in an immiscible liquid of electrical conductivity $\\sigma_{o}$ and permittivity $\\epsilon_{o}$. A uniform, steady, direct current electric field of magnitude $E_{0}$ is imposed at infinity along the $z$-axis. Assume the electroquasistatic regime with no free charge in the bulk of either phase, negligible interfacial charge convection, and steady state. Within each homogeneous phase, the electric field $\\boldsymbol{E}$ is irrotational and the electric potential $\\phi$ is harmonic.\n\nUsing the leaky dielectric model and first principles, do the following:\n- Start from Maxwell’s equations in the electroquasistatic limit and Ohm’s law to justify the governing equations for the electric potential in each phase and the interfacial jump conditions at $r=a$ for the potential and the electric field, including the relation between surface charge density $q_{s}$ and the normal electric displacement.\n- Solve for the axisymmetric electric potentials inside and outside the drop, consistent with the far-field condition $\\phi \\to -E_{0} r \\cos\\theta$ as $r \\to \\infty$, by enforcing at $r=a$: potential continuity $[\\![\\phi]\\!]=0$, tangential electric field continuity $[\\![\\boldsymbol{t}\\cdot \\boldsymbol{E}]\\!]=0$, Gauss’s law jump $[\\![\\epsilon E_{n}]\\!]=q_{s}$, and charge conservation with negligible convection and steady state, which implies normal Ohmic current continuity $[\\![\\sigma E_{n}]\\!]=0$.\n\nDefine the exterior potential in spherical coordinates as $\\phi_{o}(r,\\theta)=-E_{0} r \\cos\\theta + \\left(B/r^{2}\\right)\\cos\\theta$ and the interior potential as $\\phi_{i}(r,\\theta)=-A r \\cos\\theta$, where $A$ and $B$ are constants to be determined. Introduce the dimensionless polarization factor $K$ by the relation $B=a^{3} E_{0}\\,K$.\n\nProvide the final answer as a single closed-form analytic expression for $K$ in terms of $\\sigma_{i}$ and $\\sigma_{o}$ only. Do not substitute numerical values. The answer is dimensionless; no units are required in your final expression.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. It describes the canonical \"leaky dielectric\" model for a droplet in a uniform DC electric field, a fundamental problem in electrohydrodynamics. All necessary physical parameters, governing equations, and boundary conditions are provided, and they are consistent with Maxwell's equations under the specified electroquasistatic and steady-state assumptions. Therefore, the problem is valid and a solution can be derived.\n\nFirst, we justify the governing equations and boundary conditions from first principles as requested. The analysis is performed in the electroquasistatic (EQS) limit, where the magnetic field effects are negligible.\n\nIn the EQS regime, Faraday's law of induction, $\\nabla \\times \\boldsymbol{E} = -\\frac{\\partial \\boldsymbol{B}}{\\partial t}$, simplifies to $\\nabla \\times \\boldsymbol{E} = \\boldsymbol{0}$ because the system is in a steady state ($\\frac{\\partial}{\\partial t} = 0$). This irrotational nature of the electric field $\\boldsymbol{E}$ allows it to be expressed as the gradient of a scalar electric potential $\\phi$, i.e., $\\boldsymbol{E} = -\\nabla \\phi$.\n\nGauss's law for electricity is $\\nabla \\cdot \\boldsymbol{D} = \\rho_{\\text{free}}$, where $\\boldsymbol{D}$ is the electric displacement field and $\\rho_{\\text{free}}$ is the volume density of free charge. For a linear, homogeneous, and isotropic dielectric medium, $\\boldsymbol{D} = \\epsilon \\boldsymbol{E}$, where $\\epsilon$ is the permittivity. The problem states that there is no free charge in the bulk of either phase, so $\\rho_{\\text{free}} = 0$. This leads to $\\nabla \\cdot (\\epsilon \\boldsymbol{E}) = 0$. Since $\\epsilon$ is constant within each phase, this simplifies to $\\nabla \\cdot \\boldsymbol{E} = 0$. Substituting $\\boldsymbol{E} = -\\nabla \\phi$ yields $\\nabla \\cdot (-\\nabla \\phi) = 0$, which gives Laplace's equation for the potential:\n$$ \\nabla^2 \\phi = 0 $$\nThis confirms that the potential $\\phi$ is a harmonic function within both the drop (phase $i$) and the surrounding medium (phase $o$).\n\nThe conservation of charge is governed by the continuity equation $\\frac{\\partial \\rho_{\\text{free}}}{\\partial t} + \\nabla \\cdot \\boldsymbol{J} = 0$, where $\\boldsymbol{J}$ is the free current density. In a steady state, $\\frac{\\partial \\rho_{\\text{free}}}{\\partial t} = 0$, so the continuity equation reduces to $\\nabla \\cdot \\boldsymbol{J} = 0$. Within each ohmic medium, the current is given by Ohm's law, $\\boldsymbol{J} = \\sigma \\boldsymbol{E}$, where $\\sigma$ is the electrical conductivity. Thus, $\\nabla \\cdot (\\sigma \\boldsymbol{E}) = 0$. For a homogeneous phase, this is equivalent to $\\sigma (\\nabla \\cdot \\boldsymbol{E}) = 0$, which is consistent with the condition $\\nabla \\cdot \\boldsymbol{E} = 0$ derived from Gauss's law for $\\sigma \\neq 0$.\n\nAt the interface between the two liquids ($r=a$), we must apply jump conditions derived from the integral forms of the governing equations:\n1.  Continuity of potential: Integrating $\\boldsymbol{E} = -\\nabla \\phi$ along a path that crosses the interface shows that the potential $\\phi$ must be continuous, $[\\![\\phi]\\!] \\equiv \\phi_o - \\phi_i = 0$, to avoid an infinite tangential electric field. This directly implies the continuity of the tangential component of the electric field, $[\\![\\boldsymbol{t} \\cdot \\boldsymbol{E}]\\!] = 0$.\n2.  Gauss's law at the interface: Applying the integral form of Gauss's law, $\\oint \\boldsymbol{D} \\cdot d\\boldsymbol{S} = Q_{\\text{free, enc}}$, to a thin pillbox straddling the interface yields the jump condition for the normal component of $\\boldsymbol{D}$. This gives $\\hat{\\boldsymbol{n}} \\cdot (\\boldsymbol{D}_o - \\boldsymbol{D}_i) = q_s$, where $q_s$ is the surface free charge density and $\\hat{\\boldsymbol{n}}$ is the normal vector pointing from region $i$ to region $o$. With $\\hat{\\boldsymbol{n}}=\\hat{\\boldsymbol{r}}$ and $\\boldsymbol{D}=\\epsilon\\boldsymbol{E}$, this becomes $\\epsilon_o E_{on} - \\epsilon_i E_{in} = q_s$, or $[\\![\\epsilon E_n]\\!] = q_s$.\n3.  Charge conservation at the interface: Applying the integral form of charge conservation to the pillbox, assuming steady state ($\\frac{\\partial q_s}{\\partial t}=0$) and negligible interfacial charge convection, requires the normal component of the total current to be continuous. Here, the current is purely ohmic, so $\\hat{\\boldsymbol{n}} \\cdot (\\boldsymbol{J}_o - \\boldsymbol{J}_i) = 0$. Substituting Ohm's law, this gives $\\sigma_o E_{on} - \\sigma_i E_{in} = 0$, or $[\\![\\sigma E_n]\\!] = 0$.\n\nNow we solve for the potentials using the provided forms:\nExterior potential: $\\phi_{o}(r,\\theta)=-E_{0} r \\cos\\theta + \\frac{B}{r^{2}}\\cos\\theta$\nInterior potential: $\\phi_{i}(r,\\theta)=-A r \\cos\\theta$\n\nThe electric field components are found using $\\boldsymbol{E} = -\\nabla\\phi = -(\\frac{\\partial\\phi}{\\partial r}\\hat{\\boldsymbol{r}} + \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\hat{\\boldsymbol{\\theta}})$.\nThe radial (normal) electric field components, $E_n = \\boldsymbol{E} \\cdot \\hat{\\boldsymbol{r}} = -\\frac{\\partial\\phi}{\\partial r}$, are:\n$$ E_{on}(r,\\theta) = E_{0}\\cos\\theta + \\frac{2B}{r^{3}}\\cos\\theta $$\n$$ E_{in}(r,\\theta) = A\\cos\\theta $$\n\nWe apply the two primary boundary conditions at the interface $r=a$ to determine the constants $A$ and $B$.\n\nFirst, continuity of potential, $\\phi_o(a, \\theta) = \\phi_i(a, \\theta)$:\n$$ -E_{0} a \\cos\\theta + \\frac{B}{a^{2}}\\cos\\theta = -A a \\cos\\theta $$\nAssuming this holds for all $\\theta$, we can divide by $\\cos\\theta$ (for $\\theta \\neq \\pi/2$):\n$$ -E_{0} a + \\frac{B}{a^{2}} = -A a $$\n$$ A = E_{0} - \\frac{B}{a^{3}} \\quad (1)$$\n\nSecond, continuity of the normal component of the ohmic current, $\\sigma_o E_{on}(a, \\theta) = \\sigma_i E_{in}(a, \\theta)$:\n$$ \\sigma_{o} \\left( E_{0}\\cos\\theta + \\frac{2B}{a^{3}}\\cos\\theta \\right) = \\sigma_{i} (A\\cos\\theta) $$\nAgain, we divide by $\\cos\\theta$:\n$$ \\sigma_{o} \\left( E_{0} + \\frac{2B}{a^{3}} \\right) = \\sigma_{i} A \\quad (2)$$\n\nNow we have a system of two linear equations for $A$ and $B$. Substitute equation (1) into equation (2):\n$$ \\sigma_{o} \\left( E_{0} + \\frac{2B}{a^{3}} \\right) = \\sigma_{i} \\left( E_{0} - \\frac{B}{a^{3}} \\right) $$\nExpand and rearrange the terms to solve for $B$:\n$$ \\sigma_{o} E_{0} + \\frac{2\\sigma_{o}B}{a^{3}} = \\sigma_{i} E_{0} - \\frac{\\sigma_{i}B}{a^{3}} $$\n$$ \\frac{2\\sigma_{o}B}{a^{3}} + \\frac{\\sigma_{i}B}{a^{3}} = \\sigma_{i} E_{0} - \\sigma_{o} E_{0} $$\n$$ \\frac{B}{a^{3}} (2\\sigma_{o} + \\sigma_{i}) = E_{0} (\\sigma_{i} - \\sigma_{o}) $$\n$$ B = a^{3} E_{0} \\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}} $$\n\nThe problem defines the dimensionless polarization factor $K$ by the relation $B=a^{3} E_{0}\\,K$. By direct comparison with our derived expression for $B$, we can identify the expression for $K$:\n$$ K = \\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}} $$\nThis expression depends only on the conductivities $\\sigma_{i}$ and $\\sigma_{o}$, as required by the problem statement. The permittivities $\\epsilon_{i}$ and $\\epsilon_{o}$ govern the amount of free charge $q_s$ accumulated at the interface but do not influence the steady-state potential distribution, which is solely determined by the conductivities.",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{i} - \\sigma_{o}}{\\sigma_{i} + 2\\sigma_{o}}}\n$$"
        },
        {
            "introduction": "Analytical solutions provide deep insight but are often limited to simple geometries and steady states. To tackle dynamic and complex problems, we must turn to computational methods, and this practice challenges you to develop a robust numerical scheme for transporting the interfacial charge density predicted by the leaky dielectric model. By deriving and implementing a conservative finite-volume method from first principles, you will gain hands-on experience in building numerical tools that respect the fundamental physical law of charge conservation, a critical skill for any advanced EHD simulation .",
            "id": "4085375",
            "problem": "You are tasked with developing and validating a conservative finite-volume scheme for interfacial charge transport on triangulated surfaces, in the context of the leaky dielectric model in electrohydrodynamics. The objective is to derive from first principles a discrete scheme that transports a scalar surface charge density and to prove that the scheme conserves total charge on closed triangulated surfaces under pure advection. Then, implement the scheme in a program that verifies discrete conservation numerically on specified test cases. The final program must produce a single line of output aggregating the results of all test cases as a comma-separated list enclosed in square brackets.\n\nThe foundational starting point is the conservation of electric charge on a moving interface, restricted here to the transport portion without source terms. Let the scalar surface charge density be denoted by $q(\\boldsymbol{x},t)$ on an interface $\\mathcal{S}(t)$ with surface-tangential velocity $\\boldsymbol{u}_t(\\boldsymbol{x},t)$. The transport law is\n$$\n\\frac{\\partial q}{\\partial t} + \\nabla_s \\cdot \\left(q \\boldsymbol{u}_t\\right) = 0,\n$$\nwhere $\\nabla_s$ denotes the surface divergence operator and $\\boldsymbol{u}_t$ is everywhere tangential to $\\mathcal{S}(t)$. The transport law is a consequence of the local conservation of electric charge and the Reynolds transport theorem for evolving manifolds. For a fixed triangulated approximation of the interface at a given time, denote the set of triangular faces by $\\{\\mathcal{T}_i\\}$, with areas $A_i$, and the set of edges by $\\{e\\}$, each of length $L_e$ and with a chosen unit edge tangent $\\boldsymbol{t}_e$. For each edge $e$ shared by two neighboring faces $\\mathcal{T}_i$ and $\\mathcal{T}_j$, define a single global oriented unit co-normal vector $\\boldsymbol{m}_e$ tangent to the local surface and normal to the edge, such that $\\boldsymbol{m}_e$ points outward from a designated \"plus\" face and inward to the \"minus\" face. Let the average unit normal across the two faces be $\\boldsymbol{n}_{e} = \\frac{\\boldsymbol{n}_i + \\boldsymbol{n}_j}{\\|\\boldsymbol{n}_i + \\boldsymbol{n}_j\\|}$, where $\\boldsymbol{n}_i$ and $\\boldsymbol{n}_j$ are the outward unit normals of $\\mathcal{T}_i$ and $\\mathcal{T}_j$, respectively, and set $\\boldsymbol{m}_e$ proportional to $\\boldsymbol{n}_e \\times \\boldsymbol{t}_e$ with the sign chosen so that $\\boldsymbol{m}_e$ is outward for the plus face. For boundary edges that belong to a single face, impose a zero-flux boundary condition, which is physically consistent with a perfectly insulating boundary.\n\nDefine piecewise-constant $q_i(t)$ on each face $\\mathcal{T}_i$, and a time step $\\Delta t$. The conservative finite-volume update for pure advection that you must implement is\n$$\nq_i^{n+1} = q_i^n - \\frac{\\Delta t}{A_i} \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n,\n$$\nwhere $\\mathcal{F}_{i,e}^n$ is the flux leaving face $\\mathcal{T}_i$ across edge $e$ at time level $n$. To ensure strict conservation, compute the flux once per interior edge $e$ using a single oriented co-normal $\\boldsymbol{m}_e$, and distribute it antisymmetrically to the two adjacent faces. Let the edge midpoint be $\\boldsymbol{x}_e$, and the surface-tangential edge velocity be obtained by projecting a given ambient velocity $\\boldsymbol{w}(\\boldsymbol{x})$ to the tangent plane spanned by $\\boldsymbol{t}_e$ and $\\boldsymbol{m}_e$,\n$$\n\\boldsymbol{u}_e = \\boldsymbol{w}(\\boldsymbol{x}_e) - \\left(\\boldsymbol{w}(\\boldsymbol{x}_e) \\cdot \\boldsymbol{n}_e\\right) \\boldsymbol{n}_e.\n$$\nDefine the signed edge transport speed $s_e = \\boldsymbol{u}_e \\cdot \\boldsymbol{m}_e$. Use an upwind choice for the edge state:\n$$\n\\hat{q}_e^n =\n\\begin{cases}\nq_{+}^n,  s_e \\ge 0,\\\\\nq_{-}^n,  s_e  0,\n\\end{cases}\n$$\nwhere $q_{+}^n$ and $q_{-}^n$ are the plus-face and minus-face values at time level $n$. The oriented edge flux is then\n$$\nF_e^n = L_e \\, s_e \\, \\hat{q}_e^n,\n$$\nand the conservation distribution rule is\n$$\n\\mathcal{F}_{+,e}^n = F_e^n, \\qquad \\mathcal{F}_{-,e}^n = -F_e^n,\n$$\nwith the understanding that boundary edges contribute $F_e^n = 0$.\n\nYour program must:\n- Construct a triangulated surface and its geometric quantities from given vertices and face lists.\n- Orient all face normals outward with respect to the origin by adjusting vertex order as needed.\n- Build a unique global set of edges with consistent geometric orientation $\\boldsymbol{t}_e$, and for interior edges define the plus and minus faces so that $\\boldsymbol{m}_e$ points outward from the plus face.\n- Advance the piecewise-constant $q_i$ in time using the conservative edge-flux scheme described above.\n- Compute the total charge defined as $\\mathcal{Q}(t) = \\sum_i A_i q_i(t)$ at initial and final times, and report the absolute difference $|\\mathcal{Q}(t_{\\mathrm{final}}) - \\mathcal{Q}(t_{\\mathrm{initial}})|$.\n\nAmbient velocity choices are given by rigid-body rotation $\\boldsymbol{w}(\\boldsymbol{x}) = \\boldsymbol{\\omega} \\times \\boldsymbol{x}$ with constant angular velocity vector $\\boldsymbol{\\omega}$, and the projection rule above ensures the edge velocity is tangential. Angles are to be interpreted in radians. No physical units are required for the output since the test is a dimensionless conservation check.\n\nTest Suite:\n- Case $1$ (closed surface, rotating flow): A regular tetrahedron approximating a closed surface, with vertices\n$$\n\\boldsymbol{v}_0 = \\frac{1}{\\sqrt{3}}(1,1,1),\\quad\n\\boldsymbol{v}_1 = \\frac{1}{\\sqrt{3}}(1,-1,-1),\\quad\n\\boldsymbol{v}_2 = \\frac{1}{\\sqrt{3}}(-1,1,-1),\\quad\n\\boldsymbol{v}_3 = \\frac{1}{\\sqrt{3}}(-1,-1,1),\n$$\nand faces $\\left[0,1,2\\right], \\left[0,3,1\\right], \\left[0,2,3\\right], \\left[1,3,2\\right]$ (adjust vertex order to ensure outward normals). Initial face charges\n$$\nq^0 = \\left[0.2,\\,-0.1,\\,0.3,\\,0.0\\right],\n$$\nangular velocity $\\boldsymbol{\\omega} = (0,0,1)$, time step $\\Delta t = 0.05$, and number of steps $N = 20$. Output the absolute difference in total charge.\n- Case $2$ (open surface with zero-flux boundary): Remove the face $\\left[1,3,2\\right]$ to create an open triangulated patch with boundary edges subject to zero-flux. Use the same vertices and initial charges restricted to the remaining three faces,\n$$\nq^0 = \\left[0.5,\\,-0.3,\\,0.1\\right],\n$$\nangular velocity $\\boldsymbol{\\omega} = (0,0,1)$, time step $\\Delta t = 0.1$, and number of steps $N = 30$. Output the absolute difference in total charge.\n- Case $3$ (stationary flow): Closed tetrahedron as in Case $1$, with initial charges\n$$\nq^0 = \\left[1.0,\\,-0.5,\\,0.25,\\,0.25\\right],\n$$\n$\\boldsymbol{\\omega} = (0,0,0)$, time step $\\Delta t = 0.2$, and number of steps $N = 10$. Output the absolute difference in total charge.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$). Each result must be a floating-point number equal to $|\\mathcal{Q}(t_{\\mathrm{final}}) - \\mathcal{Q}(t_{\\mathrm{initial}})|$ for the corresponding case.",
            "solution": "The theoretical and numerical framework for solving the problem is presented below. The core task is to derive and implement a conservative finite-volume scheme for the surface advection of a scalar charge density $q$.\n\n### Theoretical Foundation and Scheme Derivation\n\nThe governing physical law is the conservation of surface charge density $q(\\boldsymbol{x},t)$ on a moving surface $\\mathcal{S}(t)$ with a surface-tangential velocity field $\\boldsymbol{u}_t(\\boldsymbol{x},t)$. In the absence of source or diffusion terms, this is expressed by the advection equation:\n$$\n\\frac{\\partial q}{\\partial t} + \\nabla_s \\cdot (q \\boldsymbol{u}_t) = 0\n$$\nwhere $\\nabla_s \\cdot$ is the surface divergence operator.\n\nTo discretize this equation, we employ a finite-volume method. The surface $\\mathcal{S}$ is approximated by a fixed triangulated mesh composed of a set of triangular faces $\\{\\mathcal{T}_i\\}$. On each face $\\mathcal{T}_i$, the charge density is approximated as a piecewise-constant value $q_i(t)$.\n\nWe integrate the conservation law over a single triangular face $\\mathcal{T}_i$ with area $A_i$:\n$$\n\\int_{\\mathcal{T}_i} \\frac{\\partial q}{\\partial t} \\, dA + \\int_{\\mathcal{T}_i} \\nabla_s \\cdot (q \\boldsymbol{u}_t) \\, dA = 0\n$$\nFor a constant $q_i$ on face $\\mathcal{T}_i$, the first term becomes $A_i \\frac{d q_i}{d t}$. Applying the surface divergence theorem to the second term transforms the area integral into a line integral over the boundary $\\partial \\mathcal{T}_i$ of the triangle:\n$$\nA_i \\frac{d q_i}{d t} + \\oint_{\\partial \\mathcal{T}_i} (q \\boldsymbol{u}_t) \\cdot \\boldsymbol{\\nu} \\, dL = 0\n$$\nHere, $\\boldsymbol{\\nu}$ is the outward-pointing unit conormal vector, which is tangent to the surface and normal to the boundary edge. The boundary $\\partial \\mathcal{T}_i$ consists of three edges. The line integral can be written as a sum over these edges, denoted by $e \\in \\partial \\mathcal{T}_i$:\n$$\nA_i \\frac{d q_i}{d t} + \\sum_{e \\in \\partial \\mathcal{T}_i} \\int_e (q \\boldsymbol{u}_t) \\cdot \\boldsymbol{\\nu} \\, dL = 0\n$$\nThe integral over each edge is approximated by evaluating the integrand at the edge midpoint $\\boldsymbol{x}_e$ and multiplying by the edge length $L_e$. This gives the semi-discrete form:\n$$\nA_i \\frac{d q_i}{d t} = -\\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}(t)\n$$\nwhere $\\mathcal{F}_{i,e}(t) \\approx L_e (\\hat{q}_e \\boldsymbol{u}_e) \\cdot \\boldsymbol{\\nu}_e$ is the numerical flux of charge leaving face $\\mathcal{T}_i$ across edge $e$. Here, $\\hat{q}_e$ is an approximation of the charge density at the edge, and $\\boldsymbol{u}_e$ is the velocity at the edge. The vector $\\boldsymbol{\\nu}_e$ is the outward conormal for face $\\mathcal{T}_i$ at edge $e$.\n\nApplying a forward Euler scheme for time integration with a time step $\\Delta t$, we obtain the fully discrete update formula:\n$$\nA_i \\frac{q_i^{n+1} - q_i^n}{\\Delta t} = -\\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n\n$$\nRearranging gives the explicit update scheme as specified in the problem:\n$$\nq_i^{n+1} = q_i^n - \\frac{\\Delta t}{A_i} \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n\n$$\n\n### Conservative Flux Formulation and Proof of Conservation\n\nA crucial property of the scheme is that it must conserve the total charge $\\mathcal{Q} = \\sum_i A_i q_i$ on the discrete surface. This is guaranteed if the numerical fluxes are defined conservatively. For any interior edge $e$ shared by two faces, say $\\mathcal{T}_i$ and $\\mathcal{T}_j$, the flux leaving $\\mathcal{T}_i$ must be equal in magnitude and opposite in sign to the flux leaving $\\mathcal{T}_j$ through the same edge. That is, $\\mathcal{F}_{i,e} = -\\mathcal{F}_{j,e}$.\n\nThis is achieved by defining a single, globally oriented flux $F_e^n$ for each interior edge. We associate each interior edge with a \"plus\" face and a \"minus\" face. A unique surface conormal vector $\\boldsymbol{m}_e$ is defined for the edge, oriented to point from the plus face towards the minus face. The flux contributions to the adjacent faces are then distributed antisymmetrically:\n$$\n\\mathcal{F}_{+,e}^n = F_e^n, \\qquad \\mathcal{F}_{-,e}^n = -F_e^n\n$$\nFor boundary edges (on an open surface), a zero-flux condition is imposed, $\\mathcal{F}_{i,e}^n = 0$, which is physically consistent with an insulating boundary.\n\nThe oriented flux $F_e^n$ is defined as $F_e^n = L_e s_e \\hat{q}_e^n$, where $s_e = \\boldsymbol{u}_e \\cdot \\boldsymbol{m}_e$ is the transport speed normal to the edge. The edge velocity $\\boldsymbol{u}_e$ is the projection of an ambient velocity $\\boldsymbol{w}(\\boldsymbol{x}_e)$ onto the local tangent plane. The edge charge density $\\hat{q}_e^n$ is determined using an upwind scheme, which selects the charge from the face \"upstream\" of the flow across the edge:\n$$\n\\hat{q}_e^n =\n\\begin{cases}\nq_{+}^n,  \\text{if } s_e \\ge 0 \\text{ (flow is from + to - face)}\\\\\nq_{-}^n,  \\text{if } s_e  0 \\text{ (flow is from - to + face)}\n\\end{cases}\n$$\nThis completes the definition of the numerical scheme.\n\nLet's prove that this scheme conserves total charge. The total charge at time step $n$ is $\\mathcal{Q}^n = \\sum_i A_i q_i^n$. The change in total charge in one time step is:\n$$\n\\mathcal{Q}^{n+1} - \\mathcal{Q}^n = \\sum_i A_i (q_i^{n+1} - q_i^n)\n$$\nSubstituting the update formula:\n$$\n\\mathcal{Q}^{n+1} - \\mathcal{Q}^n = \\sum_i A_i \\left( - \\frac{\\Delta t}{A_i} \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n \\right) = -\\Delta t \\sum_i \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n\n$$\nThe double summation iterates over all pairs of faces and their corresponding edges. We can reorder the summation to iterate over all unique edges first:\n$$\n\\sum_i \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n = \\sum_{e \\in \\text{all edges}} \\sum_{i \\text{ s.t. } e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n\n$$\nConsider an arbitrary edge $e$:\n1.  If $e$ is an interior edge, it is shared by exactly two faces, the plus-face and the minus-face. Its total contribution to the sum is $\\mathcal{F}_{+,e}^n + \\mathcal{F}_{-,e}^n = F_e^n + (-F_e^n) = 0$.\n2.  If $e$ is a boundary edge, it belongs to only one face. According to the zero-flux boundary condition, its flux contribution is $0$.\n\nSince the contribution from every edge in the sum is zero, the entire sum is zero:\n$$\n\\sum_i \\sum_{e \\in \\partial \\mathcal{T}_i} \\mathcal{F}_{i,e}^n = 0\n$$\nTherefore, $\\mathcal{Q}^{n+1} - \\mathcal{Q}^n = 0$, which implies $\\mathcal{Q}^{n+1} = \\mathcal{Q}^n$. By induction, the total charge $\\mathcal{Q}$ is conserved for all time steps. This holds for both closed surfaces and open surfaces with zero-flux boundaries. The numerical implementation will verify this property up to machine floating-point precision.\n\n### Algorithmic Implementation Strategy\n\nThe program logic follows these main steps:\n1.  **Geometric Pre-computation**:\n    -   Read vertices and face connectivity.\n    -   For each face, calculate its normal vector. Ensure all normals point \"outward\" from the origin by checking the sign of $\\boldsymbol{n} \\cdot \\boldsymbol{v}$ (where $\\boldsymbol{v}$ is any vertex of the face) and reordering vertices if necessary. Calculate the face area $A_i = \\frac{1}{2} \\|\\boldsymbol{n}_i\\|$.\n    -   Build a unique set of edges. For each edge, identify the one or two faces it belongs to.\n2.  **Edge Data Calculation**:\n    -   For each interior edge, compute its length $L_e$, midpoint $\\boldsymbol{x}_e$, and a consistent unit tangent $\\boldsymbol{t}_e$.\n    -   Compute the average normal $\\boldsymbol{n}_e$ and the oriented conormal $\\boldsymbol{m}_e \\propto \\boldsymbol{n}_e \\times \\boldsymbol{t}_e$.\n    -   Establish the \"plus\" and \"minus\" face convention for each interior edge based on the direction of $\\boldsymbol{m}_e$ relative to the face interiors.\n3.  **Time Integration**:\n    -   Initialize face charges $q_i^0$ and calculate the initial total charge $\\mathcal{Q}_{\\mathrm{initial}} = \\sum_i A_i q_i^0$.\n    -   Loop for the specified number of time steps $N$:\n        -   Initialize an array for total flux per face to zeros.\n        -   Loop over all interior edges:\n            -   Calculate the ambient velocity $\\boldsymbol{w}(\\boldsymbol{x}_e) = \\boldsymbol{\\omega} \\times \\boldsymbol{x}_e$.\n            -   Project it to get the surface-tangential velocity $\\boldsymbol{u}_e$.\n            -   Compute the signed speed $s_e = \\boldsymbol{u}_e \\cdot \\boldsymbol{m}_e$.\n            -   Determine the upwind charge $\\hat{q}_e^n$.\n            -   Calculate the oriented edge flux $F_e^n = L_e s_e \\hat{q}_e^n$.\n            -   Add $F_e^n$ to the flux sum for the plus-face and subtract $F_e^n$ from the flux sum for the minus-face.\n        -   Update all face charges $q_i$ simultaneously using the accumulated fluxes and the time step $\\Delta t$.\n4.  **Result Calculation**:\n    -   After the final step, compute the final total charge $\\mathcal{Q}_{\\mathrm{final}} = \\sum_i A_i q_i^N$.\n    -   The result for the test case is the absolute difference $|\\mathcal{Q}_{\\mathrm{final}} - \\mathcal{Q}_{\\mathrm{initial}}|$.\nThis structured approach ensures a correct and verifiable implementation of the conservative scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(vertices, faces, initial_q, omega, dt, N):\n    \"\"\"\n    Runs a single simulation case for the surface charge transport problem.\n    \"\"\"\n    verts = np.array(vertices, dtype=np.float64)\n    faces_orig = np.array(faces, dtype=np.int64)\n    q = np.array(initial_q, dtype=np.float64)\n    omega = np.array(omega, dtype=np.float64)\n    num_faces = len(faces_orig)\n\n    # --- 1. Geometric Pre-computation ---\n    face_normals = np.zeros((num_faces, 3), dtype=np.float64)\n    face_areas = np.zeros(num_faces, dtype=np.float64)\n    \n    # Orient faces and compute normals, areas\n    oriented_faces = np.copy(faces_orig)\n    for i in range(num_faces):\n        v0, v1, v2 = verts[faces_orig[i]]\n        normal = np.cross(v1 - v0, v2 - v0)\n        # Orient normals to point away from the origin\n        if np.dot(normal, v0)  0:\n            normal = -normal\n            oriented_faces[i] = faces_orig[i, [0, 2, 1]] # Reverse winding order\n        \n        norm_val = np.linalg.norm(normal)\n        if norm_val > 1e-15:\n            face_normals[i] = normal / norm_val\n        face_areas[i] = 0.5 * norm_val\n\n    # Build unique edge data structure\n    edge_map = {}\n    for i in range(num_faces):\n        face_v_indices = oriented_faces[i]\n        for j in range(3):\n            v_idx1 = face_v_indices[j]\n            v_idx2 = face_v_indices[(j + 1) % 3]\n            edge_key = tuple(sorted((v_idx1, v_idx2)))\n            if edge_key not in edge_map:\n                edge_map[edge_key] = {'faces': [], 'verts': (v_idx1, v_idx2)}\n            edge_map[edge_key]['faces'].append(i)\n\n    # --- 2. Process edges ---\n    interior_edges = []\n    for edge_key, data in edge_map.items():\n        if len(data['faces']) == 2: # Interior edge\n            v_idx1_orig, v_idx2_orig = data['verts']\n            v1, v2 = verts[v_idx1_orig], verts[v_idx2_orig]\n            \n            f_idx1, f_idx2 = data['faces']\n            n1, n2 = face_normals[f_idx1], face_normals[f_idx2]\n            \n            edge_midpoint = (v1 + v2) / 2.0\n            edge_vector = v2 - v1\n            edge_length = np.linalg.norm(edge_vector)\n            t_e = edge_vector / edge_length\n            \n            n_e = n1 + n2\n            n_e_norm = np.linalg.norm(n_e)\n            if n_e_norm > 1e-15:\n              n_e /= n_e_norm\n            \n            # Define a consistent m_e and determine plus/minus faces\n            m_e = np.cross(n_e, t_e)\n            \n            # Find vector from midpoint to a point \"inside\" face 1\n            face1_verts = oriented_faces[f_idx1]\n            other_v_idx = list(set(face1_verts) - set((v_idx1_orig, v_idx2_orig)))[0]\n            d1 = verts[other_v_idx] - edge_midpoint\n\n            if np.dot(m_e, d1) > 0: # m_e points \"into\" face 1, so face 1 is minus\n                f_plus_idx, f_minus_idx = f_idx2, f_idx1\n            else: # m_e points \"out of\" face 1, so face 1 is plus\n                f_plus_idx, f_minus_idx = f_idx1, f_idx2\n                \n            interior_edges.append({\n                'L_e': edge_length,\n                'x_e': edge_midpoint,\n                'm_e': m_e,\n                'n_e': n_e,\n                'plus_face': f_plus_idx,\n                'minus_face': f_minus_idx\n            })\n\n    # --- 3. Time Integration ---\n    q_initial_total = np.sum(q * face_areas)\n\n    # Use a copy of q for the time loop to avoid overwriting initial_q\n    q_current = np.copy(q)\n\n    for n in range(N):\n        face_flux_sum = np.zeros(num_faces, dtype=np.float64)\n        \n        for edge in interior_edges:\n            # Ambient velocity at edge midpoint\n            w_e = np.cross(omega, edge['x_e'])\n            \n            # Surface-tangential velocity\n            u_e = w_e - np.dot(w_e, edge['n_e']) * edge['n_e']\n            \n            # Signed speed\n            s_e = np.dot(u_e, edge['m_e'])\n            \n            # Upwind scheme\n            q_plus = q_current[edge['plus_face']]\n            q_minus = q_current[edge['minus_face']]\n            q_hat = q_plus if s_e >= 0 else q_minus\n            \n            # Oriented flux\n            F_e = edge['L_e'] * s_e * q_hat\n            \n            # Accumulate fluxes\n            face_flux_sum[edge['plus_face']] += F_e\n            face_flux_sum[edge['minus_face']] -= F_e\n            \n        # Update charge densities for all faces, handling division by zero for zero-area faces\n        valid_areas = face_areas > 1e-15\n        q_current[valid_areas] -= (dt / face_areas[valid_areas]) * face_flux_sum[valid_areas]\n        \n    # --- 4. Result Calculation ---\n    q_final_total = np.sum(q_current * face_areas)\n    \n    return np.abs(q_final_total - q_initial_total)\n\n\ndef solve():\n    # Test cases from the problem statement.\n    v_norm = 1.0 / np.sqrt(3)\n    tetra_vertices = [\n        (v_norm * 1, v_norm * 1, v_norm * 1),\n        (v_norm * 1, v_norm * -1, v_norm * -1),\n        (v_norm * -1, v_norm * 1, v_norm * -1),\n        (v_norm * -1, v_norm * -1, v_norm * 1),\n    ]\n\n    test_cases = [\n        { # Case 1: Closed tetrahedron, rotating flow\n            'vertices': tetra_vertices,\n            'faces': [[0, 1, 2], [0, 3, 1], [0, 2, 3], [1, 3, 2]],\n            'initial_q': [0.2, -0.1, 0.3, 0.0],\n            'omega': [0, 0, 1],\n            'dt': 0.05,\n            'N': 20,\n        },\n        { # Case 2: Open patch, rotating flow\n            'vertices': tetra_vertices,\n            'faces': [[0, 1, 2], [0, 3, 1], [0, 2, 3]],\n            'initial_q': [0.5, -0.3, 0.1],\n            'omega': [0, 0, 1],\n            'dt': 0.1,\n            'N': 30,\n        },\n        { # Case 3: Closed tetrahedron, stationary flow\n            'vertices': tetra_vertices,\n            'faces': [[0, 1, 2], [0, 3, 1], [0, 2, 3], [1, 3, 2]],\n            'initial_q': [1.0, -0.5, 0.25, 0.25],\n            'omega': [0, 0, 0],\n            'dt': 0.2,\n            'N': 10,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(\n            case['vertices'],\n            case['faces'],\n            case['initial_q'],\n            case['omega'],\n            case['dt'],\n            case['N']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}