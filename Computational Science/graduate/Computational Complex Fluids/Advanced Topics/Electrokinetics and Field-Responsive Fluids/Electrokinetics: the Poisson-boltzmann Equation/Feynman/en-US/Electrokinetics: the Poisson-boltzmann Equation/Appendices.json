{
    "hands_on_practices": [
        {
            "introduction": "Understanding electrostatics in electrolytes begins with grasping the concept of screening, where mobile ions arrange themselves to dampen electric fields. This fundamental practice guides you through the derivation of the Debye length, $\\lambda_D$, the characteristic length scale of this screening effect, starting from the Poisson-Boltzmann equation in the low-potential limit . By deriving and then calculating $\\lambda_D$ for a common scenario, you will build an intuition for how properties like salt concentration and temperature dictate the extent of electrostatic interactions in solution.",
            "id": "4086115",
            "problem": "Consider a dilute, symmetric $1{:}1$ electrolyte in water at thermal equilibrium. Starting from the electrostatic Poisson equation $\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\rho_{e}$ together with the ideal dilute-solution Boltzmann distribution for ion number densities $n_{i}(\\mathbf{r}) = n_{i}^{\\infty} \\exp\\!\\left[- z_{i} e \\psi(\\mathbf{r})/\\left(k_{B} T\\right)\\right]$, and enforcing bulk electroneutrality $\\sum_{i} z_{i} e n_{i}^{\\infty} = 0$, derive the linearized screening relation that defines the electrostatic screening length (Debye length) in the small-potential limit. Use this derivation to explain how the Debye length scales with the bulk salt concentration and with temperature for a symmetric monovalent electrolyte in a uniform dielectric solvent.\n\nThen, for an aqueous $1{:}1$ electrolyte at temperature $T = 298\\,\\text{K}$ and bulk molar concentration $c^{\\infty} = 10\\,\\text{mM}$ (so the bulk number density is $n^{\\infty} = N_{A} c^{\\infty}$), compute the Debye length $\\lambda_{D}$ assuming a uniform permittivity $\\varepsilon = 78\\,\\varepsilon_{0}$. Use the following constants:\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$,\n- elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$,\n- vacuum permittivity $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\text{F/m}$,\n- Avogadro constant $N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$.\n\nRound your final numerical answer for $\\lambda_{D}$ to three significant figures and express it in nanometers. Your final answer must be a single number.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in physical chemistry and computational complex fluids concerning the derivation and application of the Debye-Hückel theory. All necessary equations, conditions, and constants are provided.\n\nThe derivation of the linearized screening relation begins with the Poisson equation for the electrostatic potential $\\psi(\\mathbf{r})$ and the charge density $\\rho_e(\\mathbf{r})$:\n$$\n\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\rho_{e}\n$$\nwhere $\\varepsilon$ is the permittivity of the medium. The charge density is contributed by the mobile ions in the electrolyte, given by the sum over all ion species $i$:\n$$\n\\rho_{e}(\\mathbf{r}) = \\sum_{i} z_{i} e n_{i}(\\mathbf{r})\n$$\nHere, $z_i$ is the valence, $e$ is the elementary charge, and $n_i(\\mathbf{r})$ is the local number density of ion species $i$.\n\nAt thermal equilibrium, the ion number densities are described by the Boltzmann distribution, which relates the local density $n_i(\\mathbf{r})$ to the bulk density $n_i^\\infty$ far from any charged surfaces (where $\\psi \\to 0$):\n$$\nn_{i}(\\mathbf{r}) = n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi(\\mathbf{r})}{k_{B} T}\\right)\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nSubstituting the expressions for $\\rho_e$ and $n_i$ into the Poisson equation yields the Poisson-Boltzmann (PB) equation:\n$$\n\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\sum_{i} z_{i} e n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi(\\mathbf{r})}{k_{B} T}\\right)\n$$\nThe problem considers a symmetric $1{:}1$ electrolyte. This implies there are two ion species: a cation with valence $z_{+} = +1$ and an anion with valence $z_{-} = -1$. The bulk electroneutrality condition $\\sum_{i} z_{i} e n_{i}^{\\infty} = 0$ requires that $(+1) e n_{+}^{\\infty} + (-1) e n_{-}^{\\infty} = 0$, which leads to $n_{+}^{\\infty} = n_{-}^{\\infty}$. We denote this common bulk number density as $n^{\\infty}$.\n\nThe sum in the PB equation becomes:\n$$\n\\sum_{i} z_{i} e n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi}{k_{B} T}\\right) = (+1) e n^{\\infty} \\exp\\left(-\\frac{e \\psi}{k_{B} T}\\right) + (-1) e n^{\\infty} \\exp\\left(-\\frac{(-1)e \\psi}{k_{B} T}\\right)\n$$\n$$\n= e n^{\\infty} \\left[ \\exp\\left(-\\frac{e \\psi}{k_{B} T}\\right) - \\exp\\left(\\frac{e \\psi}{k_{B} T}\\right) \\right]\n$$\nUsing the definition of the hyperbolic sine function, $\\sinh(x) = \\frac{1}{2}(\\exp(x) - \\exp(-x))$, the expression simplifies to:\n$$\n= -2 e n^{\\infty} \\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right)\n$$\nAssuming a uniform dielectric solvent, the permittivity $\\varepsilon$ is a constant, and the PB equation becomes:\n$$\n\\varepsilon \\nabla^2 \\psi = 2 e n^{\\infty} \\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right)\n$$\nThe problem asks for the linearized screening relation, which is valid in the small-potential limit, $|e \\psi / (k_B T)| \\ll 1$. In this limit, we can use the first-order Taylor expansion for the hyperbolic sine function: $\\sinh(x) \\approx x$.\n$$\n\\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right) \\approx \\frac{e \\psi}{k_{B} T}\n$$\nSubstituting this approximation into the PB equation yields the linearized Poisson-Boltzmann equation, also known as the Debye-Hückel equation:\n$$\n\\varepsilon \\nabla^2 \\psi = 2 e n^{\\infty} \\left(\\frac{e \\psi}{k_{B} T}\\right) = \\left(\\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\\right) \\psi\n$$\nRearranging this gives the screening relation:\n$$\n\\nabla^2 \\psi = \\left(\\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\\right) \\psi\n$$\nThis is a Helmholtz-type equation of the form $\\nabla^2 \\psi = \\kappa^2 \\psi$. The parameter $\\kappa$ is the inverse of the electrostatic screening length, or Debye length, $\\lambda_D$. Thus, $\\lambda_D = 1/\\kappa$, and we can identify $\\kappa^2$:\n$$\n\\kappa^2 = \\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\n$$\nThe Debye length is therefore given by:\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\varepsilon k_{B} T}{2 n^{\\infty} e^2}}\n$$\nFrom this expression, we can determine the scaling behavior. Since the bulk ion number density $n^{\\infty}$ is directly proportional to the bulk molar salt concentration $c^{\\infty}$ (specifically, $n^{\\infty} = N_A c^{\\infty}$), the Debye length scales as $\\lambda_D \\propto (c^{\\infty})^{-1/2}$. It is also directly proportional to the square root of the absolute temperature, $\\lambda_D \\propto T^{1/2}$. Thus, increasing salt concentration reduces the screening length, while increasing temperature increases it.\n\nNow, we compute the numerical value of $\\lambda_D$ for the given parameters.\nThe parameters are:\n- Temperature: $T = 298\\,\\text{K}$\n- Bulk molar concentration: $c^{\\infty} = 10\\,\\text{mM} = 10 \\times 10^{-3}\\,\\text{mol/L}$. We must convert this to SI units (mol/m³):\n$c^{\\infty} = 10 \\times 10^{-3} \\frac{\\text{mol}}{1\\,\\text{L}} \\times \\frac{1\\,\\text{L}}{10^{-3}\\,\\text{m}^3} = 10\\,\\text{mol/m}^3$.\n- Avogadro constant: $N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$\n- Bulk ion number density: $n^{\\infty} = N_{A} c^{\\infty} = (6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}) \\times (10\\,\\text{mol/m}^3) = 6.02214076 \\times 10^{24}\\,\\text{m}^{-3}$.\n- Permittivity: $\\varepsilon = 78\\,\\varepsilon_{0} = 78 \\times (8.8541878128 \\times 10^{-12}\\,\\text{F/m}) \\approx 6.90626649 \\times 10^{-10}\\,\\text{F/m}$.\n- Boltzmann constant: $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$.\n- Elementary charge: $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$.\n\nWe substitute these values into the formula for $\\lambda_D$:\n$$\n\\lambda_{D} = \\sqrt{\\frac{(6.90626649 \\times 10^{-10}\\,\\text{F/m}) \\times (1.380649 \\times 10^{-23}\\,\\text{J/K}) \\times (298\\,\\text{K})}{2 \\times (6.02214076 \\times 10^{24}\\,\\text{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\text{C})^2}}\n$$\nLet's compute the numerator and denominator separately.\nNumerator: $\\varepsilon k_{B} T \\approx (6.90626649 \\times 10^{-10}) \\times (1.380649 \\times 10^{-23}) \\times 298 \\approx 2.84155 \\times 10^{-30}\\,\\text{J} \\cdot \\text{F/m}$.\nDenominator: $2 n^{\\infty} e^2 \\approx 2 \\times (6.02214076 \\times 10^{24}) \\times (1.602176634 \\times 10^{-19})^2 \\approx 3.09173 \\times 10^{-13}\\,\\text{C}^2/\\text{m}^3$.\nThe units can be reconciled: $1\\,\\text{F} = 1\\,\\text{C}^2/\\text{J}$. So the numerator is in units of $\\text{C}^2/\\text{m}$. The ratio is $(\\text{C}^2/\\text{m}) / (\\text{C}^2/\\text{m}^3) = \\text{m}^2$.\n\n$$\n\\lambda_{D}^2 = \\frac{2.84155 \\times 10^{-30}\\,\\text{m}^2 \\cdot \\text{J} \\cdot \\text{F/m} / \\text{J}}{3.09173 \\times 10^{-13}\\,\\text{C}^2/\\text{m}^3} = \\frac{2.84155 \\times 10^{-30}}{3.09173 \\times 10^{-13}}\\,\\text{m}^2 \\approx 9.1908 \\times 10^{-18}\\,\\text{m}^2\n$$\n$$\n\\lambda_{D} = \\sqrt{9.1908 \\times 10^{-18}\\,\\text{m}^2} \\approx 3.0316 \\times 10^{-9}\\,\\text{m}\n$$\nThe problem asks for the answer in nanometers ($1\\,\\text{nm} = 10^{-9}\\,\\text{m}$) and rounded to three significant figures.\n$$\n\\lambda_D \\approx 3.0316\\,\\text{nm}\n$$\nRounding to three significant figures gives $\\lambda_D = 3.03\\,\\text{nm}$.",
            "answer": "$$\\boxed{3.03}$$"
        },
        {
            "introduction": "With the concept of the Debye length established, we can now model the structure of the electric double layer—the interface between a charged surface and an electrolyte. This exercise tasks you with solving the linearized Poisson-Boltzmann equation for a planar charged wall to find the classic exponentially decaying potential profile, $\\psi(x) \\propto \\exp(-\\kappa x)$ . More importantly, by applying Gauss's law at the boundary, you will derive the fundamental relationship between the surface charge density $\\sigma$ and the resulting surface potential $\\psi_0$, directly linking a macroscopic property to the microscopic double-layer structure.",
            "id": "4086108",
            "problem": "Consider an infinite, uniformly charged, planar wall located at $x=0$ bearing a fixed free surface charge density $+\\sigma$ (with outward unit normal along $+x$), in contact with a symmetric $z=\\pm 1$ electrolyte of bulk number density $n_{\\infty}$ occupying $x0$. The solvent is a continuum dielectric of permittivity $\\epsilon$ at absolute temperature $T$. Assume local electrochemical equilibrium for the ions and the low-potential regime $|e\\,\\psi(x)| \\ll k_{B}T$, where $\\psi(x)$ is the electrostatic potential, $e$ is the elementary charge, and $k_{B}$ is the Boltzmann constant.\n\nStarting only from the Poisson equation $\\nabla^{2}\\psi=-\\rho_{e}/\\epsilon$ and the Boltzmann distribution for the ionic number densities in electrochemical equilibrium, derive the linearized governing equation for $\\psi(x)$ in $x0$ under the stated low-potential assumption. Impose the physically motivated far-field condition $\\psi(x)\\to 0$ as $x\\to \\infty$ and solve the resulting linear ordinary differential equation for $\\psi(x)$ that decays away from the wall. Then, using the macroscopic Maxwell boundary condition for the normal electric field at the interface, namely that the discontinuity of the normal electric displacement equals the free surface charge, and assuming the wall is an ideally polarizable conductor so that the normal field inside the solid is zero, relate the amplitude of the decaying solution $\\psi(x)$ at $x=0^{+}$ to the given parameters.\n\nDefine the inverse screening length $\\kappa$ that naturally emerges in the linearization, but express your final result for the interfacial amplitude $\\psi_{0}\\equiv \\psi(0^{+})$ strictly in terms of $\\sigma$, $\\epsilon$, and $\\kappa$. Your final answer must be a single closed-form analytic expression. No numerical evaluation is required and no units should be included in the final boxed answer.",
            "solution": "The problem asks for the derivation of the electrostatic potential profile $\\psi(x)$ in an electrolyte near a charged planar wall within the Debye-Hückel approximation, and to find the potential at the wall, $\\psi_0$, in terms of the surface charge density $\\sigma$, the dielectric permittivity $\\epsilon$, and the inverse Debye screening length $\\kappa$.\n\nThe starting point is the Poisson equation, which relates the electrostatic potential $\\psi$ to the local volume charge density of mobile ions, $\\rho_e$. For a system that varies only in the $x$-direction, the Poisson equation is:\n$$\n\\frac{d^2\\psi(x)}{dx^2} = -\\frac{\\rho_e(x)}{\\epsilon}\n$$\nThe problem is defined for the domain $x0$.\n\nThe electrolyte is symmetric and monovalent, with ionic charges being $+e$ for cations and $-e$ for anions (corresponding to $z=\\pm 1$). The local volume charge density $\\rho_e(x)$ is the sum of the charge contributions from these ions:\n$$\n\\rho_e(x) = (+e)n_+(x) + (-e)n_-(x) = e(n_+(x) - n_-(x))\n$$\nwhere $n_+(x)$ and $n_-(x)$ are the local number densities of cations and anions, respectively.\n\nUnder the assumption of local electrochemical equilibrium at an absolute temperature $T$, the ionic number densities are described by the Boltzmann distribution. This relates the local density $n_i(x)$ of an ionic species $i$ with charge $q_i$ to its bulk number density $n_{i,\\infty}$ (far from the wall where $\\psi(x) \\to 0$):\n$$\nn_i(x) = n_{i,\\infty} \\exp\\left(-\\frac{q_i \\psi(x)}{k_B T}\\right)\n$$\nwhere $k_B$ is the Boltzmann constant. For the symmetric electrolyte given, $n_{+,\\infty} = n_{-,\\infty} = n_{\\infty}$. The charges are $q_+ = +e$ and $q_- = -e$. The number densities are thus:\n$$\nn_+(x) = n_{\\infty} \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_{\\infty} \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting these expressions into the formula for the charge density $\\rho_e(x)$ gives:\n$$\n\\rho_e(x) = e n_{\\infty} \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\nThis expression can be simplified using the definition of the hyperbolic sine function, $\\sinh(u) = \\frac{\\exp(u) - \\exp(-u)}{2}$:\n$$\n\\rho_e(x) = -2 e n_{\\infty} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting this into the Poisson equation yields the full, non-linear Poisson-Boltzmann equation for this system:\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\frac{2 e n_{\\infty}}{\\epsilon} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nThe problem specifies the low-potential regime, where $|e\\psi(x)| \\ll k_B T$. In this limit, the argument of the hyperbolic sine function is small, and we can use the first-order Taylor expansion, $\\sinh(u) \\approx u$ for $|u| \\ll 1$. Applying this linearization:\n$$\n\\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\approx \\frac{e\\psi(x)}{k_B T}\n$$\nThe Poisson-Boltzmann equation simplifies to the linear Debye-Hückel equation:\n$$\n\\frac{d^2\\psi(x)}{dx^2} \\approx \\frac{2 e n_{\\infty}}{\\epsilon} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2n_{\\infty}e^2}{\\epsilon k_B T}\\right) \\psi(x)\n$$\nThe group of constants on the right-hand side has units of inverse length squared. We define the inverse screening length $\\kappa$ (also known as the Debye parameter) as its square root:\n$$\n\\kappa^2 \\equiv \\frac{2n_{\\infty}e^2}{\\epsilon k_B T}\n$$\nThe linearized governing equation for the potential $\\psi(x)$ is therefore:\n$$\n\\frac{d^2\\psi(x)}{dx^2} - \\kappa^2 \\psi(x) = 0\n$$\nThis is a second-order linear homogeneous ordinary differential equation with constant coefficients. The general solution is of the form:\n$$\n\\psi(x) = A \\exp(\\kappa x) + B \\exp(-\\kappa x)\n$$\nwhere $A$ and $B$ are integration constants determined by the boundary conditions.\n\nThe first boundary condition is the far-field condition: $\\psi(x) \\to 0$ as $x \\to \\infty$. The term $A \\exp(\\kappa x)$ diverges as $x \\to \\infty$ (since $\\kappa0$). To satisfy the boundary condition, the constant $A$ must be zero. This leaves the physically meaningful decaying solution:\n$$\n\\psi(x) = B \\exp(-\\kappa x)\n$$\nThe constant $B$ is the value of the potential at the boundary $x=0$. We define the interfacial amplitude (surface potential) as $\\psi_0 \\equiv \\psi(0^{+})$. Thus, $B = \\psi_0$, and the solution is:\n$$\n\\psi(x) = \\psi_0 \\exp(-\\kappa x)\n$$\nThe second boundary condition relates the electric field at the surface to the fixed surface charge density $\\sigma$. According to Gauss's law for a dielectric interface, the discontinuity in the normal component of the electric displacement field equals the free surface charge density. For the planar surface at $x=0$ with normal along $+x$:\n$$\nD_x(x=0^+) - D_x(x=0^-) = \\sigma\n$$\nThe electric displacement is $D_x = \\epsilon E_x$, and the electric field is $E_x = -d\\psi/dx$. So, $D_x = -\\epsilon (d\\psi/dx)$. The boundary condition becomes:\n$$\n\\left(-\\epsilon \\frac{d\\psi}{dx}\\right)_{x=0^+} - \\left(-\\epsilon_{\\text{wall}} \\frac{d\\psi}{dx}\\right)_{x=0^-} = \\sigma\n$$\nThe problem states that the wall is an ideally polarizable conductor, so the electric field inside the solid ($x0$) is zero. This means $(d\\psi/dx)_{x=0^-} = 0$. The boundary condition simplifies to:\n$$\n-\\epsilon \\frac{d\\psi}{dx}\\bigg|_{x=0^+} = \\sigma\n$$\nWe now compute the derivative of our solution $\\psi(x) = \\psi_0 \\exp(-\\kappa x)$:\n$$\n\\frac{d\\psi}{dx} = -\\kappa \\psi_0 \\exp(-\\kappa x)\n$$\nEvaluating this at $x=0^+$:\n$$\n\\frac{d\\psi}{dx}\\bigg|_{x=0^+} = -\\kappa \\psi_0\n$$\nSubstituting this result into the boundary condition equation:\n$$\n-\\epsilon (-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon \\kappa \\psi_0 = \\sigma\n$$\nFinally, we solve for the interfacial amplitude $\\psi_0$. The problem requires the final answer to be expressed strictly in terms of $\\sigma$, $\\epsilon$, and $\\kappa$. Rearranging the last equation gives the desired result:\n$$\n\\psi_0 = \\frac{\\sigma}{\\epsilon \\kappa}\n$$\nThis expression relates the potential at the charged surface to the surface charge density, the permittivity of the solvent, and the screening properties of the electrolyte, as captured by the Debye length $1/\\kappa$.",
            "answer": "$$\n\\boxed{\\frac{\\sigma}{\\epsilon \\kappa}}\n$$"
        },
        {
            "introduction": "Analytical solutions provide deep insight but are often limited to idealized scenarios, such as the low-potential limit. This advanced practice bridges the gap between theory and realistic simulation by guiding you through the construction of a numerical solver for the full, nonlinear Poisson-Boltzmann equation . By implementing a finite-difference scheme with Newton's method and validating your code against both the Debye-Hückel and Gouy-Chapman analytical solutions, you will gain critical hands-on experience in computational physics and a clear understanding of the validity range of common theoretical approximations.",
            "id": "4086086",
            "problem": "Consider a one-dimensional planar electrolyte in contact with a uniformly charged wall, with spatial coordinate $x \\in [0,L]$ measured along the normal to the wall located at $x=0$. The medium has constant permittivity $\\varepsilon$, temperature $T$, and contains a symmetric valence electrolyte with valence $z$ and bulk number density $n_{\\infty}$. The electric potential is $\\psi(x)$ and the mobile ion number densities are $n_{+}(x)$ and $n_{-}(x)$. The fundamental electrostatic balance is given by the Poisson equation\n$$\n\\frac{d}{dx}\\left(\\varepsilon \\frac{d \\psi}{dx}\\right) = -\\rho_{e}(x),\n$$\nwhere $\\rho_{e}(x)$ is the free charge density. Under the Boltzmann distribution for mobile ions in thermal equilibrium,\n$$\nn_{\\pm}(x) = n_{\\infty} \\exp\\left(\\mp \\frac{z e \\psi(x)}{k_{B} T}\\right),\n$$\nwith $e$ the elementary charge and $k_{B}$ the Boltzmann constant, the free charge density is\n$$\n\\rho_{e}(x) = z e \\left(n_{+}(x) - n_{-}(x)\\right) = -2 z e n_{\\infty} \\sinh\\left(\\frac{z e \\psi(x)}{k_{B} T}\\right).\n$$\nIntroduce the dimensionless potential $\\phi(x) = \\frac{z e \\psi(x)}{k_{B} T}$ and the inverse Debye length $\\kappa$ defined by\n$$\n\\kappa^{2} = \\frac{2 z^{2} e^{2} n_{\\infty}}{\\varepsilon k_{B} T}.\n$$\nAssuming uniform $\\varepsilon$ and planar symmetry, the Poisson-Boltzmann equation becomes the nonlinear boundary value problem\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\sinh\\left(\\phi(x)\\right), \\quad x \\in (0,L),\n$$\nwith boundary conditions\n$$\n\\phi(0) = \\phi_{w}, \\quad \\phi(L) = 0,\n$$\nwhere $\\phi_{w}$ is the prescribed dimensionless wall potential. For sufficiently small $|\\phi|$, the Debye-Hückel (DH) linearization is\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\phi(x),\n$$\nwhich yields the analytical solution\n$$\n\\phi_{\\mathrm{DH}}(x) = \\phi_{w} \\exp(-\\kappa x).\n$$\nFor arbitrary $\\phi_{w}$ in a semi-infinite domain subject to $\\phi(x) \\to 0$ as $x \\to \\infty$, the Gouy-Chapman (GC) analytical solution for a symmetric electrolyte is\n$$\n\\phi_{\\mathrm{GC}}(x) = 2 \\ln\\left(\\frac{1 + \\gamma \\exp(-\\kappa x)}{1 - \\gamma \\exp(-\\kappa x)}\\right), \\quad \\gamma = \\tanh\\left(\\frac{\\phi_{w}}{4}\\right).\n$$\nIn this problem, you must construct a numerical solver for the nonlinear Poisson-Boltzmann equation using a second-order centered finite difference discretization and a Newton iteration for the nonlinear system. The discrete approximation on a uniform grid with $N$ nodes and spacing $h = L/(N-1)$ should use the interior stencil\n$$\n\\frac{\\phi_{i-1} - 2 \\phi_{i} + \\phi_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi_{i}) = 0, \\quad i = 1,2,\\dots,N-2,\n$$\nwith Dirichlet boundary conditions $\\phi_{0} = \\phi_{w}$ and $\\phi_{N-1} = 0$. The Newton linearization at iterate $\\phi^{(k)}$ leads to the tridiagonal Jacobian system for the update $\\delta$,\n$$\n\\left[\\frac{1}{h^{2}} \\delta_{i-1} + \\left(-\\frac{2}{h^{2}} - \\kappa^{2} \\cosh(\\phi^{(k)}_{i})\\right) \\delta_{i} + \\frac{1}{h^{2}} \\delta_{i+1}\\right] = -\\left[\\frac{\\phi^{(k)}_{i-1} - 2 \\phi^{(k)}_{i} + \\phi^{(k)}_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi^{(k)}_{i})\\right],\n$$\nfor $i = 1,2,\\dots,N-2$, with boundary values entering the residual at $i=1$ and $i=N-2$. Initialize the Newton iteration with the Debye-Hückel analytical profile $\\phi^{(0)}(x) = \\phi_{w} \\exp(-\\kappa x)$ and iterate until the infinity norm of the residual is below a user-defined tolerance.\n\nValidation is required by comparing the numerical solution against the Debye-Hückel analytical solution in the small-potential regime and against the Gouy-Chapman analytical solution in the nonlinear regime. Quantify the discrepancy using the following error norms over all grid nodes:\n- The root-mean-square absolute error,\n$$\nE_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(\\phi_{i}^{\\mathrm{num}} - \\phi_{i}^{\\mathrm{ana}}\\right)^{2}},\n$$\n- The maximum absolute error,\n$$\nE_{\\infty} = \\max_{0 \\le i \\le N-1} \\left| \\phi_{i}^{\\mathrm{num}} - \\phi_{i}^{\\mathrm{ana}} \\right|.\n$$\n\nYour program must implement this numerical solver and produce the error norms for the following test suite of parameters, which probe different regimes:\n- Case $\\mathrm{A}$ (Debye-Hückel validation): $\\kappa = 3.0$, $\\phi_{w} = 0.05$, $L = 4.0$, $N = 400$. Compare to $\\phi_{\\mathrm{DH}}(x)$.\n- Case $\\mathrm{B}$ (Gouy-Chapman, moderate nonlinearity): $\\kappa = 1.0$, $\\phi_{w} = 1.0$, $L = 8.0$, $N = 800$. Compare to $\\phi_{\\mathrm{GC}}(x)$.\n- Case $\\mathrm{C}$ (Gouy-Chapman, strong nonlinearity): $\\kappa = 2.0$, $\\phi_{w} = 3.0$, $L = 8.0$, $N = 800$. Compare to $\\phi_{\\mathrm{GC}}(x)$.\n\nAll quantities are dimensionless; do not include physical units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\left[E_{\\mathrm{RMS}}^{\\mathrm{A}}, E_{\\infty}^{\\mathrm{A}}, E_{\\mathrm{RMS}}^{\\mathrm{B}}, E_{\\infty}^{\\mathrm{B}}, E_{\\mathrm{RMS}}^{\\mathrm{C}}, E_{\\infty}^{\\mathrm{C}}\\right],\n$$\nwith each value represented as a decimal in scientific notation. No other text should be printed.",
            "solution": "The user-provided problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the established theory of electrostatics in electrolytes, mathematically well-posed as a nonlinear boundary value problem, and its formulation is objective and complete. The problem requires the numerical solution of the one-dimensional, nonlinear Poisson-Boltzmann (PB) equation and validation against appropriate analytical limits.\n\nThe governing equation is the dimensionless Poisson-Boltzmann equation for the electric potential $\\phi(x)$ in a planar geometry:\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\sinh\\left(\\phi(x)\\right), \\quad x \\in (0,L),\n$$\nwith Dirichlet boundary conditions specifying the potential at the wall, $\\phi(0) = \\phi_{w}$, and in the bulk, $\\phi(L) = 0$.\n\nA numerical solution is constructed using a second-order accurate centered finite difference method on a uniform grid. The domain $[0,L]$ is discretized into $N$ grid points $x_{i} = i h$ for $i = 0, 1, \\dots, N-1$, with a grid spacing of $h = L/(N-1)$. The potential at these points is denoted $\\phi_{i} \\approx \\phi(x_{i})$. The second derivative operator is approximated as:\n$$\n\\left.\\frac{d^{2} \\phi}{dx^{2}}\\right|_{x=x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_{i} + \\phi_{i+1}}{h^{2}}.\n$$\nApplying this discretization to the PB equation for the $N-2$ interior points ($i = 1, 2, \\dots, N-2$) results in a system of nonlinear algebraic equations:\n$$\nF_{i}(\\mathbf{\\Phi}) = \\frac{\\phi_{i-1} - 2\\phi_{i} + \\phi_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi_{i}) = 0,\n$$\nwhere $\\mathbf{\\Phi} = [\\phi_{1}, \\phi_{2}, \\dots, \\phi_{N-2}]^T$ is the vector of unknown potentials at the interior nodes. The boundary values $\\phi_{0} = \\phi_{w}$ and $\\phi_{N-1} = 0$ are constants that are incorporated into the first ($i=1$) and last ($i=N-2$) equations.\n\nThis nonlinear system, denoted compactly as $\\mathbf{F}(\\mathbf{\\Phi}) = \\mathbf{0}$, is solved using the iterative Newton-Raphson method. Starting from an initial guess $\\mathbf{\\Phi}^{(k)}$ at iteration $k$, the method finds an improved guess $\\mathbf{\\Phi}^{(k+1)}$ by solving a linear system for the update vector $\\delta^{(k)} = \\mathbf{\\Phi}^{(k+1)} - \\mathbf{\\Phi}^{(k)}$:\n$$\n\\mathbf{J}(\\mathbf{\\Phi}^{(k)}) \\delta^{(k)} = -\\mathbf{F}(\\mathbf{\\Phi}^{(k)}).\n$$\nHere, $\\mathbf{J}$ is the $(N-2) \\times (N-2)$ Jacobian matrix, whose elements are given by $J_{ij} = \\frac{\\partial F_i}{\\partial \\phi_j}$, where the indices $i$ and $j$ run from $1$ to $N-2$. The specific non-zero elements are:\n$$\n\\frac{\\partial F_{i}}{\\partial \\phi_{j}} =\n\\begin{cases}\n1/h^{2}  j = i-1 \\\\\n-2/h^{2} - \\kappa^{2} \\cosh(\\phi_{i})  j = i \\\\\n1/h^{2}  j = i+1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe resulting Jacobian is a symmetric tridiagonal matrix. This structure is computationally advantageous, as the linear system can be solved efficiently in $\\mathcal{O}(N)$ time using specialized algorithms, such as the one implemented in `scipy.linalg.solve_banded`.\n\nThe algorithm proceeds as follows:\n1.  **Initialization**: The iterative process is initialized with the analytical solution to the linearized Debye-Hückel equation, $\\phi_{i}^{(0)} = \\phi_{w} \\exp(-\\kappa x_{i})$ for all $i=0, \\dots, N-1$.\n2.  **Iteration**: At each step $k$, the residual vector $\\mathbf{F}(\\mathbf{\\Phi}^{(k)})$ and the Jacobian matrix $\\mathbf{J}(\\mathbf{\\Phi}^{(k)})$ are assembled for the interior nodes.\n3.  **Convergence Check**: The infinity norm of the residual, $||\\mathbf{F}||_{\\infty} = \\max_{i} |F_{i}|$, is calculated. If this norm falls below a prescribed tolerance (e.g., $\\epsilon=10^{-10}$), the solution is considered converged, and the iteration stops.\n4.  **Update**: If not converged, the linear system $\\mathbf{J} \\delta^{(k)} = -\\mathbf{F}$ is solved for the update $\\delta^{(k)}$, and the solution is updated via $\\mathbf{\\Phi}^{(k+1)} = \\mathbf{\\Phi}^{(k)} + \\delta^{(k)}$.\n\nAfter convergence, the numerical solution $\\phi_{i}^{\\mathrm{num}}$ is compared against analytical solutions. For the small-potential regime (Case A), the Debye-Hückel solution, $\\phi_{\\mathrm{DH}}(x) = \\phi_{w} \\exp(-\\kappa x)$, is the appropriate benchmark. For moderate to high potentials (Cases B and C), the more accurate Gouy-Chapman solution is used: $\\phi_{\\mathrm{GC}}(x) = 2 \\ln\\left(\\frac{1 + \\gamma \\exp(-\\kappa x)}{1 - \\gamma \\exp(-\\kappa x)}\\right)$, with $\\gamma = \\tanh(\\phi_{w}/4)$. These analytical forms are strictly valid for a semi-infinite domain ($L \\to \\infty$), but the chosen domain lengths $L$ are sufficiently large compared to the Debye length $1/\\kappa$ (i.e., $\\kappa L \\gg 1$) that the comparison remains meaningful and serves as a valid verification of the numerical implementation. The discrepancy is quantified via the root-mean-square error, $E_{\\mathrm{RMS}}$, and the maximum absolute error, $E_{\\infty}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_pb_newton(kappa, phi_w, L, N, tol=1e-10, max_iter=50):\n    \"\"\"\n    Solves the 1D nonlinear Poisson-Boltzmann equation using a finite difference\n    discretization and Newton's method.\n\n    Args:\n        kappa (float): Inverse Debye length.\n        phi_w (float): Dimensionless wall potential.\n        L (float): Domain length.\n        N (int): Number of grid points.\n        tol (float): Convergence tolerance for the infinity norm of the residual.\n        max_iter (int): Maximum number of Newton iterations.\n\n    Returns:\n        tuple: A tuple containing the grid points (x) and the numerical\n               solution for the potential (phi).\n    \"\"\"\n    x = np.linspace(0, L, N)\n    h = L / (N - 1)\n\n    # Initial guess using the Debye-Huckel analytical solution\n    phi = phi_w * np.exp(-kappa * x)\n    # Enforce boundary conditions on the initial guess\n    phi[0] = phi_w\n    phi[-1] = 0.0\n\n    num_interior = N - 2\n    \n    for k in range(max_iter):\n        # We only solve for the N-2 interior points\n        phi_interior = phi[1:-1]\n        \n        # Assemble the residual vector F(phi) for interior nodes\n        # F_i = (phi_{i-1} - 2*phi_i + phi_{i+1})/h^2 - k^2*sinh(phi_i)\n        residual = (phi[:-2] - 2 * phi[1:-1] + phi[2:]) / h**2 - kappa**2 * np.sinh(phi_interior)\n\n        # Check for convergence based on the infinity norm of the residual\n        if np.linalg.norm(residual, np.inf)  tol:\n            break\n            \n        # Assemble the tridiagonal Jacobian matrix J for the N-2 interior points\n        # Main diagonal: -2/h^2 - k^2*cosh(phi_i)\n        # Off-diagonals: 1/h^2\n        main_diag = -2.0 / h**2 - kappa**2 * np.cosh(phi_interior)\n        off_diag_val = 1.0 / h**2\n        \n        # Scipy's solve_banded requires the matrix in a special banded format (ab).\n        # For a tridiagonal matrix (l=1, u=1), ab is a (3, N-2) array.\n        ab = np.zeros((3, num_interior))\n        ab[0, 1:] = off_diag_val  # Upper diagonal\n        ab[1, :] = main_diag      # Main diagonal\n        ab[2, :-1] = off_diag_val # Lower diagonal\n\n        # Solve the linear system J * delta = -F for the update vector delta\n        delta = solve_banded((1, 1), ab, -residual, check_finite=False)\n        \n        # Update the solution for interior points\n        phi[1:-1] += delta\n        \n    return x, phi\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (kappa, phi_w, L, N, analytical_solution_type)\n        (3.0, 0.05, 4.0, 400, 'DH'),\n        (1.0, 1.0, 8.0, 800, 'GC'),\n        (2.0, 3.0, 8.0, 800, 'GC'),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, phi_w, L, N_float, ana_type = case\n        N = int(N_float)\n        \n        # --- Get Numerical Solution ---\n        x, phi_num = solve_pb_newton(kappa, phi_w, L, N)\n        \n        # --- Get Analytical Solution ---\n        if ana_type == 'DH':\n            # Debye-Hückel (linearized) solution\n            phi_ana = phi_w * np.exp(-kappa * x)\n        elif ana_type == 'GC':\n            # Gouy-Chapman (nonlinear) solution\n            gamma = np.tanh(phi_w / 4.0)\n            exp_term = np.exp(-kappa * x)\n            # The denominator 1 - gamma*exp(-kappa*x) is always positive for phi_w > 0.\n            phi_ana = 2.0 * np.log((1.0 + gamma * exp_term) / (1.0 - gamma * exp_term))\n        else:\n            # This case should not be reached with the given problem.\n            raise ValueError(\"Unknown analytical solution type specified.\")\n            \n        # --- Calculate Error Norms ---\n        # The comparison is over all N grid nodes.\n        diff = phi_num - phi_ana\n        \n        # Root-Mean-Square Absolute Error (E_RMS)\n        e_rms = np.sqrt(np.mean(diff**2))\n        \n        # Maximum Absolute Error (E_inf)\n        e_inf = np.max(np.abs(diff))\n        \n        results.append(f\"{e_rms:.6e}\")\n        results.append(f\"{e_inf:.6e}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}