{
    "hands_on_practices": [
        {
            "introduction": "德拜长度是理解电解质中静电相互作用的基石。本练习将指导您从泊松-玻尔兹曼方程的线性化入手，推导出这个关键的长度尺度，它源于静电力（由泊松方程描述）和离子热运动（由玻尔兹曼分布描述）之间的平衡。掌握这一推导过程不仅能巩固对静电屏蔽物理图像的理解，还提供了估算离子溶液中相互作用范围的实用公式 ()。",
            "id": "4086115",
            "problem": "考虑一个处于热平衡状态下的、稀的、对称的 $1{:}1$ 型水溶液电解质。从静电泊松方程 $\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\rho_{e}$、理想稀溶液中离子数密度的玻尔兹曼分布 $n_{i}(\\mathbf{r}) = n_{i}^{\\infty} \\exp\\!\\left[- z_{i} e \\psi(\\mathbf{r})/\\left(k_{B} T\\right)\\right]$ 出发，并施加宏观电中性条件 $\\sum_{i} z_{i} e n_{i}^{\\infty} = 0$，推导在小电势极限下定义静电屏蔽长度（德拜长度）的线性化筛选关系。利用此推导解释，对于均匀介电溶剂中的对称单价电解质，德拜长度如何随宏观盐浓度和温度而变化。\n\n然后，对于温度 $T = 298\\,\\text{K}$、宏观摩尔浓度 $c^{\\infty} = 10\\,\\text{mM}$（因此宏观数密度为 $n^{\\infty} = N_{A} c^{\\infty}$）的水溶液 $1{:}1$ 型电解质，假设其介电常数是均匀的 $\\varepsilon = 78\\,\\varepsilon_{0}$，计算德拜长度 $\\lambda_{D}$。使用以下常数：\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$，\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$，\n- 真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\text{F/m}$，\n- 阿伏伽德罗常数 $N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$。\n\n将您的 $\\lambda_{D}$ 最终数值答案四舍五入至三位有效数字，并以纳米为单位表示。您的最终答案必须是一个数字。",
            "solution": "该问题陈述经核实具有科学依据、问题明确且客观。这是一个关于德拜-休克尔理论的推导和应用的物理化学和计算复杂流体领域的标准问题。所有必要的方程、条件和常数均已提供。\n\n线性化筛选关系的推导始于静电势 $\\psi(\\mathbf{r})$ 和电荷密度 $\\rho_e(\\mathbf{r})$ 的泊松方程：\n$$\n\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\rho_{e}\n$$\n其中 $\\varepsilon$ 是介质的介电常数。电荷密度由电解质中的移动离子贡献，由所有离子种类 $i$ 的总和给出：\n$$\n\\rho_{e}(\\mathbf{r}) = \\sum_{i} z_{i} e n_{i}(\\mathbf{r})\n$$\n这里，$z_i$ 是化合价，$e$ 是基本电荷，$n_i(\\mathbf{r})$ 是离子种类 $i$ 的局部数密度。\n\n在热平衡状态下，离子数密度由玻尔兹曼分布描述，该分布将局部密度 $n_i(\\mathbf{r})$ 与远离任何带电表面（此处 $\\psi \\to 0$）的宏观密度 $n_i^\\infty$ 联系起来：\n$$\nn_{i}(\\mathbf{r}) = n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi(\\mathbf{r})}{k_{B} T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n将 $\\rho_e$ 和 $n_i$ 的表达式代入泊松方程，得到泊松-玻尔兹曼（PB）方程：\n$$\n\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = -\\sum_{i} z_{i} e n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi(\\mathbf{r})}{k_{B} T}\\right)\n$$\n该问题考虑的是对称的 $1{:}1$ 型电解质。这意味着存在两种离子：化合价为 $z_{+} = +1$ 的阳离子和化合价为 $z_{-} = -1$ 的阴离子。宏观电中性条件 $\\sum_{i} z_{i} e n_{i}^{\\infty} = 0$ 要求 $(+1) e n_{+}^{\\infty} + (-1) e n_{-}^{\\infty} = 0$，这导致 $n_{+}^{\\infty} = n_{-}^{\\infty}$。我们将这个共同的宏观数密度表示为 $n^{\\infty}$。\n\nPB方程中的求和项变为：\n$$\n\\sum_{i} z_{i} e n_{i}^{\\infty} \\exp\\left(-\\frac{z_{i} e \\psi}{k_{B} T}\\right) = (+1) e n^{\\infty} \\exp\\left(-\\frac{e \\psi}{k_{B} T}\\right) + (-1) e n^{\\infty} \\exp\\left(-\\frac{(-1)e \\psi}{k_{B} T}\\right)\n$$\n$$\n= e n^{\\infty} \\left[ \\exp\\left(-\\frac{e \\psi}{k_{B} T}\\right) - \\exp\\left(\\frac{e \\psi}{k_{B} T}\\right) \\right]\n$$\n使用双曲正弦函数的定义 $\\sinh(x) = \\frac{1}{2}(\\exp(x) - \\exp(-x))$，该表达式可简化为：\n$$\n= -2 e n^{\\infty} \\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right)\n$$\n假设溶剂的介电常数是均匀的，则介电常数 $\\varepsilon$ 是一个常数，PB方程变为：\n$$\n\\varepsilon \\nabla^2 \\psi = 2 e n^{\\infty} \\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right)\n$$\n问题要求得到线性化筛选关系，该关系在小电势极限 $|e \\psi / (k_B T)| \\ll 1$ 下有效。在此极限下，我们可以使用双曲正弦函数的一阶泰勒展开：$\\sinh(x) \\approx x$。\n$$\n\\sinh\\left(\\frac{e \\psi}{k_{B} T}\\right) \\approx \\frac{e \\psi}{k_{B} T}\n$$\n将此近似代入PB方程，得到线性化的泊松-玻尔兹曼方程，也称为德拜-休克尔方程：\n$$\n\\varepsilon \\nabla^2 \\psi = 2 e n^{\\infty} \\left(\\frac{e \\psi}{k_{B} T}\\right) = \\left(\\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\\right) \\psi\n$$\n整理后得到筛选关系：\n$$\n\\nabla^2 \\psi = \\left(\\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\\right) \\psi\n$$\n这是一个亥姆霍兹型方程，形式为 $\\nabla^2 \\psi = \\kappa^2 \\psi$。参数 $\\kappa$ 是静电屏蔽长度或德拜长度 $\\lambda_D$ 的倒数。因此，$\\lambda_D = 1/\\kappa$，我们可以确定 $\\kappa^2$：\n$$\n\\kappa^2 = \\frac{2 n^{\\infty} e^2}{\\varepsilon k_{B} T}\n$$\n因此，德拜长度由以下公式给出：\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\varepsilon k_{B} T}{2 n^{\\infty} e^2}}\n$$\n从这个表达式中，我们可以确定其标度行为。由于宏观离子数密度 $n^{\\infty}$ 与宏观摩尔盐浓度 $c^{\\infty}$ 成正比（具体来说，$n^{\\infty} = N_A c^{\\infty}$），德拜长度的变化规律为 $\\lambda_D \\propto (c^{\\infty})^{-1/2}$。它也与绝对温度的平方根成正比，即 $\\lambda_D \\propto T^{1/2}$。因此，增加盐浓度会减小屏蔽长度，而增加温度会增大屏蔽长度。\n\n现在，我们根据给定的参数计算 $\\lambda_D$ 的数值。\n参数如下：\n- 温度：$T = 298\\,\\text{K}$\n- 宏观摩尔浓度：$c^{\\infty} = 10\\,\\text{mM} = 10 \\times 10^{-3}\\,\\text{mol/L}$。我们必须将其转换为国际单位制（mol/m³）：$c^{\\infty} = 10 \\times 10^{-3} \\frac{\\text{mol}}{1\\,\\text{L}} \\times \\frac{1\\,\\text{L}}{10^{-3}\\,\\text{m}^3} = 10\\,\\text{mol/m}^3$。\n- 阿伏伽德罗常数：$N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$\n- 宏观离子数密度：$n^{\\infty} = N_{A} c^{\\infty} = (6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}) \\times (10\\,\\text{mol/m}^3) = 6.02214076 \\times 10^{24}\\,\\text{m}^{-3}$。\n- 介电常数：$\\varepsilon = 78\\,\\varepsilon_{0} = 78 \\times (8.8541878128 \\times 10^{-12}\\,\\text{F/m}) \\approx 6.90626649 \\times 10^{-10}\\,\\text{F/m}$。\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$。\n- 基本电荷：$e = 1.602176634 \\times 10^{-19}\\,\\text{C}$。\n\n我们将这些值代入 $\\lambda_D$ 的公式中：\n$$\n\\lambda_{D} = \\sqrt{\\frac{(6.90626649 \\times 10^{-10}\\,\\text{F/m}) \\times (1.380649 \\times 10^{-23}\\,\\text{J/K}) \\times (298\\,\\text{K})}{2 \\times (6.02214076 \\times 10^{24}\\,\\text{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\text{C})^2}}\n$$\n我们分别计算分子和分母。\n分子：$\\varepsilon k_{B} T \\approx (6.90626649 \\times 10^{-10}) \\times (1.380649 \\times 10^{-23}) \\times 298 \\approx 2.84155 \\times 10^{-30}\\,\\text{J} \\cdot \\text{F/m}$。\n分母：$2 n^{\\infty} e^2 \\approx 2 \\times (6.02214076 \\times 10^{24}) \\times (1.602176634 \\times 10^{-19})^2 \\approx 3.09173 \\times 10^{-13}\\,\\text{C}^2/\\text{m}^3$。\n单位可以统一：$1\\,\\text{F} = 1\\,\\text{C}^2/\\text{J}$。所以分子的单位是 $\\text{C}^2/\\text{m}$。比值的单位是 $(\\text{C}^2/\\text{m}) / (\\text{C}^2/\\text{m}^3) = \\text{m}^2$。\n\n$$\n\\lambda_{D}^2 = \\frac{2.84155 \\times 10^{-30}\\,\\text{m}^2 \\cdot \\text{J} \\cdot \\text{F/m} / \\text{J}}{3.09173 \\times 10^{-13}\\,\\text{C}^2/\\text{m}^3} = \\frac{2.84155 \\times 10^{-30}}{3.09173 \\times 10^{-13}}\\,\\text{m}^2 \\approx 9.1908 \\times 10^{-18}\\,\\text{m}^2\n$$\n$$\n\\lambda_{D} = \\sqrt{9.1908 \\times 10^{-18}\\,\\text{m}^2} \\approx 3.0316 \\times 10^{-9}\\,\\text{m}\n$$\n题目要求答案以纳米（$1\\,\\text{nm} = 10^{-9}\\,\\text{m}$）为单位，并四舍五入到三位有效数字。\n$$\n\\lambda_D \\approx 3.0316\\,\\text{nm}\n$$\n四舍五入到三位有效数字，得到 $\\lambda_D = 3.03\\,\\text{nm}$。",
            "answer": "$$\\boxed{3.03}$$"
        },
        {
            "introduction": "在掌握了屏蔽的概念之后，我们现在将其应用于一个典型问题：带电表面附近形成的双电层（EDL）。本练习涉及在平面几何中求解线性化的泊松-玻尔兹曼（德拜-休克尔）方程，其解揭示了电势随远离表面距离呈指数衰减的规律。通过在界面处应用高斯定律，该练习展示了如何将宏观属性（表面电荷密度 $\\sigma$）与微观电势分布联系起来，从而得出低电势极限下表面电势与电荷之间的基本关系 ()。",
            "id": "4086108",
            "problem": "考虑一个位于 $x=0$ 处的无限大、均匀带电的平面墙，其带有固定的自由表面电荷密度 $+\\sigma$（外法线单位向量沿 $+x$ 方向），并与占据 $x>0$ 区域、体数密度为 $n_{\\infty}$ 的对称 $z=\\pm 1$ 电解质接触。溶剂是绝对温度为 $T$、介电常数为 $\\epsilon$ 的连续介电质。假设离子处于局部电化学平衡状态，并且满足低电势条件 $|e\\,\\psi(x)| \\ll k_{B}T$，其中 $\\psi(x)$ 是静电势，$e$ 是元电荷，$k_{B}$ 是玻尔兹曼常数。\n\n仅从泊松方程 $\\nabla^{2}\\psi=-\\rho_{e}/\\epsilon$ 和电化学平衡中离子数密度的玻尔兹曼分布出发，在所述的低电势假设下，推导在 $x>0$ 区域内 $\\psi(x)$ 的线性化控制方程。施加符合物理直观的远场条件 $\\psi(x)\\to 0$（当 $x\\to \\infty$ 时），并求解所得的线性常微分方程，得到从墙边向外衰减的 $\\psi(x)$ 解。然后，利用界面处法向电场的宏观麦克斯韦边界条件，即法向电位移的不连续性等于自由表面电荷，并假设墙是理想极化导体以致固体内部的法向场为零，将衰减解 $\\psi(x)$ 在 $x=0^{+}$ 处的振幅与给定参数联系起来。\n\n定义在线性化过程中自然出现的逆屏蔽长度 $\\kappa$，但最终结果中的界面振幅 $\\psi_{0}\\equiv \\psi(0^{+})$ 必须严格用 $\\sigma$、$\\epsilon$ 和 $\\kappa$ 表示。你的最终答案必须是单一的闭式解析表达式。不需要进行数值计算，最终方框内的答案不应包含任何单位。",
            "solution": "问题要求在德拜-休克尔近似下，推导带电平面墙附近电解质中的静电势分布 $\\psi(x)$，并根据表面电電荷密度 $\\sigma$、介电常数 $\\epsilon$ 和逆德拜屏蔽长度 $\\kappa$ 求出墙上的电势 $\\psi_0$。\n\n出发点是泊松方程，它将静电势 $\\psi$ 与可移动离子的局部体电荷密度 $\\rho_e$ 联系起来。对于一个仅在 $x$ 方向上变化的系统，泊松方程为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = -\\frac{\\rho_e(x)}{\\epsilon}\n$$\n问题定义在 $x>0$ 的区域内。\n\n电解质是对称且单价的，阳离子的电荷为 $+e$，阴离子的电荷为 $-e$（对应于 $z=\\pm 1$）。局部体电荷密度 $\\rho_e(x)$ 是这些离子电荷贡献的总和：\n$$\n\\rho_e(x) = (+e)n_+(x) + (-e)n_-(x) = e(n_+(x) - n_-(x))\n$$\n其中 $n_+(x)$ 和 $n_-(x)$ 分别是阳离子和阴离子的局部数密度。\n\n在绝对温度为 $T$ 时局部电化学平衡的假设下，离子数密度由玻尔兹曼分布描述。该分布将带有电荷 $q_i$ 的离子种类 $i$ 的局部密度 $n_i(x)$ 与其体数密度 $n_{i,\\infty}$（远离墙体，此时 $\\psi(x) \\to 0$）联系起来：\n$$\nn_i(x) = n_{i,\\infty} \\exp\\left(-\\frac{q_i \\psi(x)}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数。对于给定的对称电解质，$n_{+,\\infty} = n_{-,\\infty} = n_{\\infty}$。电荷分别为 $q_+ = +e$ 和 $q_- = -e$。因此，数密度为：\n$$\nn_+(x) = n_{\\infty} \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_{\\infty} \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将这些表达式代入电荷密度 $\\rho_e(x)$ 的公式中，得到：\n$$\n\\rho_e(x) = e n_{\\infty} \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\n这个表达式可以使用双曲正弦函数的定义 $\\sinh(u) = \\frac{\\exp(u) - \\exp(-u)}{2}$ 来简化：\n$$\n\\rho_e(x) = -2 e n_{\\infty} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将此代入泊松方程，得到该系统的完整的、非线性的泊松-玻尔兹曼方程：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\frac{2 e n_{\\infty}}{\\epsilon} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n问题指定了低电势区域，其中 $|e\\psi(x)| \\ll k_B T$。在此极限下，双曲正弦函数的自变量很小，我们可以使用一阶泰勒展开 $\\sinh(u) \\approx u$（对于 $|u| \\ll 1$）。应用此线性化：\n$$\n\\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\approx \\frac{e\\psi(x)}{k_B T}\n$$\n泊松-玻尔兹曼方程简化为线性的德拜-休克尔方程：\n$$\n\\frac{d^2\\psi(x)}{dx^2} \\approx \\frac{2 e n_{\\infty}}{\\epsilon} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2n_{\\infty}e^2}{\\epsilon k_B T}\\right) \\psi(x)\n$$\n等式右侧的常数项组合的单位是逆长度的平方。我们将其平方根定义为逆屏蔽长度 $\\kappa$（也称为德拜参数）：\n$$\n\\kappa^2 \\equiv \\frac{2n_{\\infty}e^2}{\\epsilon k_B T}\n$$\n因此，电势 $\\psi(x)$ 的线性化控制方程为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} - \\kappa^2 \\psi(x) = 0\n$$\n这是一个二阶线性齐次常系数常微分方程。其通解形式为：\n$$\n\\psi(x) = A \\exp(\\kappa x) + B \\exp(-\\kappa x)\n$$\n其中 $A$ 和 $B$ 是由边界条件决定的积分常数。\n\n第一个边界条件是远场条件：当 $x \\to \\infty$ 时，$\\psi(x) \\to 0$。项 $A \\exp(\\kappa x)$ 在 $x \\to \\infty$ 时发散（因为 $\\kappa>0$）。为满足该边界条件，常数 $A$ 必须为零。这样就得到了具有物理意义的衰减解：\n$$\n\\psi(x) = B \\exp(-\\kappa x)\n$$\n常数 $B$ 是边界 $x=0$ 处的电势值。我们定义界面振幅（表面电势）为 $\\psi_0 \\equiv \\psi(0^{+})$。因此，$B = \\psi_0$，解为：\n$$\n\\psi(x) = \\psi_0 \\exp(-\\kappa x)\n$$\n第二个边界条件将表面电场与固定的表面电荷密度 $\\sigma$ 联系起来。根据介质界面的高斯定律，电位移场的法向分量的不连续性等于自由表面电荷密度。对于位于 $x=0$ 处且法线沿 $+x$ 方向的平面：\n$$\nD_x(x=0^+) - D_x(x=0^-) = \\sigma\n$$\n电位移为 $D_x = \\epsilon E_x$，电场为 $E_x = -d\\psi/dx$。所以，$D_x = -\\epsilon (d\\psi/dx)$。边界条件变为：\n$$\n\\left(-\\epsilon \\frac{d\\psi}{dx}\\right)_{x=0^+} - \\left(-\\epsilon_{\\text{wall}} \\frac{d\\psi}{dx}\\right)_{x=0^-} = \\sigma\n$$\n问题指出，墙体是理想极化导体，因此固体内部（$x<0$）的电场为零。这意味着 $(d\\psi/dx)_{x=0^-} = 0$。边界条件简化为：\n$$\n-\\epsilon \\frac{d\\psi}{dx}\\bigg|_{x=0^+} = \\sigma\n$$\n现在我们计算解 $\\psi(x) = \\psi_0 \\exp(-\\kappa x)$ 的导数：\n$$\n\\frac{d\\psi}{dx} = -\\kappa \\psi_0 \\exp(-\\kappa x)\n$$\n在 $x=0^+$ 处求值：\n$$\n\\frac{d\\psi}{dx}\\bigg|_{x=0^+} = -\\kappa \\psi_0\n$$\n将此结果代入边界条件方程：\n$$\n-\\epsilon (-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon \\kappa \\psi_0 = \\sigma\n$$\n最后，我们求解界面振幅 $\\psi_0$。问题要求最终答案严格用 $\\sigma$、$\\epsilon$ 和 $\\kappa$ 表示。整理上一个方程即可得到所需结果：\n$$\n\\psi_0 = \\frac{\\sigma}{\\epsilon \\kappa}\n$$\n该表达式将带电表面的电势与表面电荷密度、溶剂的介电常数以及由德拜长度 $1/\\kappa$ 所表征的电解质的屏蔽性质联系起来。",
            "answer": "$$\n\\boxed{\\frac{\\sigma}{\\epsilon \\kappa}}\n$$"
        },
        {
            "introduction": "尽管解析解对于建立物理直觉至关重要，但它们通常仅限于简化的情形（例如低电势）。为了处理具有高表面电势或复杂几何形状的实际场景，我们必须借助数值方法。本练习要求您使用有限差分法和牛顿-拉弗森迭代法，实现一个完整的非线性泊松-玻尔兹曼方程的数值求解器。这项计算实践提供了从零开始构建稳健求解器的亲身体验，并通过与德拜-休克尔和古伊-查普曼解析解的对比验证，巩固了理论概念，从而架起了理论与计算实践之间的桥梁 ()。",
            "id": "4086086",
            "problem": "考虑一个一维平面电解质，它与一个均匀带电的壁面接触，空间坐标 $x \\in [0,L]$ 沿着位于 $x=0$ 处壁面的法线方向测量。该介质具有恒定的介电常数 $\\varepsilon$ 和温度 $T$，并含有一种对称价态电解质，其化合价为 $z$，体数密度为 $n_{\\infty}$。电势为 $\\psi(x)$，移动离子的数密度为 $n_{+}(x)$ 和 $n_{-}(x)$。基本的静电平衡由Poisson方程给出\n$$\n\\frac{d}{dx}\\left(\\varepsilon \\frac{d \\psi}{dx}\\right) = -\\rho_{e}(x),\n$$\n其中 $\\rho_{e}(x)$ 是自由电荷密度。在热平衡状态下，移动离子遵循Boltzmann分布，\n$$\nn_{\\pm}(x) = n_{\\infty} \\exp\\left(\\mp \\frac{z e \\psi(x)}{k_{B} T}\\right),\n$$\n其中 $e$ 是元电荷，$k_{B}$ 是Boltzmann常数，自由电荷密度为\n$$\n\\rho_{e}(x) = z e \\left(n_{+}(x) - n_{-}(x)\\right) = -2 z e n_{\\infty} \\sinh\\left(\\frac{z e \\psi(x)}{k_{B} T}\\right).\n$$\n引入无量纲电势 $\\phi(x) = \\frac{z e \\psi(x)}{k_{B} T}$ 和由下式定义的Debye长度的倒数 $\\kappa$\n$$\n\\kappa^{2} = \\frac{2 z^{2} e^{2} n_{\\infty}}{\\varepsilon k_{B} T}.\n$$\n假设 $\\varepsilon$ 均匀且为平面几何，Poisson-Boltzmann方程就成为一个非线性边值问题\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\sinh\\left(\\phi(x)\\right), \\quad x \\in (0,L),\n$$\n其边界条件为\n$$\n\\phi(0) = \\phi_{w}, \\quad \\phi(L) = 0,\n$$\n其中 $\\phi_{w}$ 是给定的无量纲壁面电势。对于足够小的 $|\\phi|$，其Debye-Hückel (DH) 线性化形式为\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\phi(x),\n$$\n其解析解为\n$$\n\\phi_{\\mathrm{DH}}(x) = \\phi_{w} \\exp(-\\kappa x).\n$$\n对于半无限域中满足当 $x \\to \\infty$ 时 $\\phi(x) \\to 0$ 的任意 $\\phi_{w}$，对称电解质的Gouy-Chapman (GC) 解析解为\n$$\n\\phi_{\\mathrm{GC}}(x) = 2 \\ln\\left(\\frac{1 + \\gamma \\exp(-\\kappa x)}{1 - \\gamma \\exp(-\\kappa x)}\\right), \\quad \\gamma = \\tanh\\left(\\frac{\\phi_{w}}{4}\\right).\n$$\n在本问题中，您必须使用二阶中心有限差分格式和求解非线性系统的Newton迭代法，为非线性Poisson-Boltzmann方程构建一个数值求解器。在具有 $N$ 个节点和间距 $h = L/(N-1)$ 的均匀网格上的离散近似应使用以下内部模板\n$$\n\\frac{\\phi_{i-1} - 2 \\phi_{i} + \\phi_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi_{i}) = 0, \\quad i = 1,2,\\dots,N-2,\n$$\n并采用Dirichlet边界条件 $\\phi_{0} = \\phi_{w}$ 和 $\\phi_{N-1} = 0$。在迭代值 $\\phi^{(k)}$ 处的Newton线性化导出了一个用于求解更新量 $\\delta$ 的三对角雅可比系统，\n$$\n\\left[\\frac{1}{h^{2}} \\delta_{i-1} + \\left(-\\frac{2}{h^{2}} - \\kappa^{2} \\cosh(\\phi^{(k)}_{i})\\right) \\delta_{i} + \\frac{1}{h^{2}} \\delta_{i+1}\\right] = -\\left[\\frac{\\phi^{(k)}_{i-1} - 2 \\phi^{(k)}_{i} + \\phi^{(k)}_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi^{(k)}_{i})\\right],\n$$\n对于 $i = 1,2,\\dots,N-2$，边界值进入 $i=1$ 和 $i=N-2$ 处的残差项。使用Debye-Hückel解析形式 $\\phi^{(0)}(x) = \\phi_{w} \\exp(-\\kappa x)$ 初始化Newton迭代，并持续迭代直到残差的无穷范数低于用户定义的容差。\n\n需要通过将数值解与小电势范围内的Debye-Hückel解析解以及非线性范围内的Gouy-Chapman解析解进行比较来进行验证。使用以下在所有网格节点上计算的误差范数来量化差异：\n- 均方根绝对误差，\n$$\nE_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(\\phi_{i}^{\\mathrm{num}} - \\phi_{i}^{\\mathrm{ana}}\\right)^{2}},\n$$\n- 最大绝对误差，\n$$\nE_{\\infty} = \\max_{0 \\le i \\le N-1} \\left| \\phi_{i}^{\\mathrm{num}} - \\phi_{i}^{\\mathrm{ana}} \\right|.\n$$\n\n您的程序必须实现该数值求解器，并为以下探究不同范围的参数测试套件生成误差范数：\n- 情况 $\\mathrm{A}$ (Debye-Hückel 验证): $\\kappa = 3.0$, $\\phi_{w} = 0.05$, $L = 4.0$, $N = 400$。与 $\\phi_{\\mathrm{DH}}(x)$ 比较。\n- 情况 $\\mathrm{B}$ (Gouy-Chapman, 中等非线性): $\\kappa = 1.0$, $\\phi_{w} = 1.0$, $L = 8.0$, $N = 800$。与 $\\phi_{\\mathrm{GC}}(x)$ 比较。\n- 情况 $\\mathrm{C}$ (Gouy-Chapman, 强非线性): $\\kappa = 2.0$, $\\phi_{w} = 3.0$, $L = 8.0$, $N = 800$。与 $\\phi_{\\mathrm{GC}}(x)$ 比较。\n\n所有量均为无量纲；不包含物理单位。您的程序应生成单行输出，其中包含一个由方括号括起来、以逗号分隔的结果列表，顺序如下\n$$\n\\left[E_{\\mathrm{RMS}}^{\\mathrm{A}}, E_{\\infty}^{\\mathrm{A}}, E_{\\mathrm{RMS}}^{\\mathrm{B}}, E_{\\infty}^{\\mathrm{B}}, E_{\\mathrm{RMS}}^{\\mathrm{C}}, E_{\\infty}^{\\mathrm{C}}\\right],\n$$\n每个值都应表示为科学记数法的小数。不应打印任何其他文本。",
            "solution": "用户提供的问题陈述已经过严格评估，并被确定为有效。它有坚实的科学基础，植根于已建立的电解质静电学理论；在数学上，它作为一个非线性边值问题是适定的；其表述是客观和完整的。该问题要求对一维非线性Poisson-Boltzmann (PB) 方程进行数值求解，并对照适当的解析极限进行验证。\n\n控制方程是平面几何中电势 $\\phi(x)$ 的无量纲Poisson-Boltzmann方程：\n$$\n\\frac{d^{2} \\phi}{dx^{2}} = \\kappa^{2} \\sinh\\left(\\phi(x)\\right), \\quad x \\in (0,L),\n$$\n其Dirichlet边界条件指定了壁面电势 $\\phi(0) = \\phi_{w}$ 和体相电势 $\\phi(L) = 0$。\n\n数值解是使用均匀网格上的二阶精度中心有限差分法构建的。区域 $[0,L]$ 被离散化为 $N$ 个网格点 $x_{i} = i h$（$i = 0, 1, \\dots, N-1$），网格间距为 $h = L/(N-1)$。这些点上的电势记为 $\\phi_{i} \\approx \\phi(x_{i})$。二阶导数算子近似为：\n$$\n\\left.\\frac{d^{2} \\phi}{dx^{2}}\\right|_{x=x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_{i} + \\phi_{i+1}}{h^{2}}.\n$$\n将此离散化应用于 $N-2$ 个内部点（$i = 1, 2, \\dots, N-2$）的PB方程，得到一个非线性代数方程组：\n$$\nF_{i}(\\mathbf{\\Phi}) = \\frac{\\phi_{i-1} - 2\\phi_{i} + \\phi_{i+1}}{h^{2}} - \\kappa^{2} \\sinh(\\phi_{i}) = 0,\n$$\n其中 $\\mathbf{\\Phi} = [\\phi_{1}, \\phi_{2}, \\dots, \\phi_{N-2}]^T$ 是内部节点上未知电势的向量。边界值 $\\phi_{0} = \\phi_{w}$ 和 $\\phi_{N-1} = 0$ 是常数，被并入第一个（$i=1$）和最后一个（$i=N-2$）方程中。\n\n这个非线性系统（紧凑地表示为 $\\mathbf{F}(\\mathbf{\\Phi}) = \\mathbf{0}$）使用迭代的Newton-Raphson方法求解。从第 $k$ 次迭代的初始猜测 $\\mathbf{\\Phi}^{(k)}$ 开始，该方法通过求解一个线性系统来找到改进的猜测 $\\mathbf{\\Phi}^{(k+1)}$，该线性系统用于计算更新向量 $\\delta^{(k)} = \\mathbf{\\Phi}^{(k+1)} - \\mathbf{\\Phi}^{(k)}$：\n$$\n\\mathbf{J}(\\mathbf{\\Phi}^{(k)}) \\delta^{(k)} = -\\mathbf{F}(\\mathbf{\\Phi}^{(k)}).\n$$\n这里，$\\mathbf{J}$ 是 $(N-2) \\times (N-2)$ 的雅可比矩阵，其元素由 $J_{ij} = \\frac{\\partial F_i}{\\partial \\phi_j}$ 给出，其中指标 $i$ 和 $j$ 的范围是从 $1$ 到 $N-2$。具体的非零元素为：\n$$\n\\frac{\\partial F_{i}}{\\partial \\phi_{j}} =\n\\begin{cases}\n1/h^{2} & \\text{if } j = i-1 \\\\\n-2/h^{2} - \\kappa^{2} \\cosh(\\phi_{i}) & \\text{if } j = i \\\\\n1/h^{2} & \\text{if } j = i+1 \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n得到的雅可比矩阵是一个对称三对角矩阵。这种结构在计算上具有优势，因为可以使用专门的算法（例如 `scipy.linalg.solve_banded` 中实现的算法）在 $\\mathcal{O}(N)$ 时间内高效地求解该线性系统。\n\n算法流程如下：\n1.  **初始化**：使用线性化的Debye-Hückel方程的解析解来初始化迭代过程，即对所有 $i=0, \\dots, N-1$，$\\phi_{i}^{(0)} = \\phi_{w} \\exp(-\\kappa x_{i})$。\n2.  **迭代**：在每一步 $k$ 中，为内部节点组装残差向量 $\\mathbf{F}(\\mathbf{\\Phi}^{(k)})$ 和雅可比矩阵 $\\mathbf{J}(\\mathbf{\\Phi}^{(k)})$。\n3.  **收敛性检查**：计算残差的无穷范数 $||\\mathbf{F}||_{\\infty} = \\max_{i} |F_{i}|$。如果该范数低于预设的容差（例如 $\\epsilon=10^{-10}$），则认为解已收敛，迭代停止。\n4.  **更新**：如果未收敛，则求解线性系统 $\\mathbf{J} \\delta^{(k)} = -\\mathbf{F}$ 以获得更新量 $\\delta^{(k)}$，并通过 $\\mathbf{\\Phi}^{(k+1)} = \\mathbf{\\Phi}^{(k)} + \\delta^{(k)}$ 更新解。\n\n收敛后，将数值解 $\\phi_{i}^{\\mathrm{num}}$ 与解析解进行比较。对于小电势范围（情况 A），Debye-Hückel解 $\\phi_{\\mathrm{DH}}(x) = \\phi_{w} \\exp(-\\kappa x)$ 是合适的基准。对于中等到高电势（情况 B 和 C），使用更准确的Gouy-Chapman解：$\\phi_{\\mathrm{GC}}(x) = 2 \\ln\\left(\\frac{1 + \\gamma \\exp(-\\kappa x)}{1 - \\gamma \\exp(-\\kappa x)}\\right)$，其中 $\\gamma = \\tanh(\\phi_{w}/4)$。这些解析形式严格适用于半无限域（$L \\to \\infty$），但所选的区域长度 $L$ 相对于Debye长度 $1/\\kappa$ 足够大（即 $\\kappa L \\gg 1$），因此比较仍然有意义，并可作为对数值实现的有效验证。差异通过均方根误差 $E_{\\mathrm{RMS}}$ 和最大绝对误差 $E_{\\infty}$ 进行量化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_pb_newton(kappa, phi_w, L, N, tol=1e-10, max_iter=50):\n    \"\"\"\n    Solves the 1D nonlinear Poisson-Boltzmann equation using a finite difference\n    discretization and Newton's method.\n\n    Args:\n        kappa (float): Inverse Debye length.\n        phi_w (float): Dimensionless wall potential.\n        L (float): Domain length.\n        N (int): Number of grid points.\n        tol (float): Convergence tolerance for the infinity norm of the residual.\n        max_iter (int): Maximum number of Newton iterations.\n\n    Returns:\n        tuple: A tuple containing the grid points (x) and the numerical\n               solution for the potential (phi).\n    \"\"\"\n    x = np.linspace(0, L, N)\n    h = L / (N - 1)\n\n    # Initial guess using the Debye-Huckel analytical solution\n    phi = phi_w * np.exp(-kappa * x)\n    # Enforce boundary conditions on the initial guess\n    phi[0] = phi_w\n    phi[-1] = 0.0\n\n    num_interior = N - 2\n    \n    for k in range(max_iter):\n        # We only solve for the N-2 interior points\n        phi_interior = phi[1:-1]\n        \n        # Assemble the residual vector F(phi) for interior nodes\n        # F_i = (phi_{i-1} - 2*phi_i + phi_{i+1})/h^2 - k^2*sinh(phi_i)\n        residual = (phi[:-2] - 2 * phi[1:-1] + phi[2:]) / h**2 - kappa**2 * np.sinh(phi_interior)\n\n        # Check for convergence based on the infinity norm of the residual\n        if np.linalg.norm(residual, np.inf)  tol:\n            break\n            \n        # Assemble the tridiagonal Jacobian matrix J for the N-2 interior points\n        # Main diagonal: -2/h^2 - k^2*cosh(phi_i)\n        # Off-diagonals: 1/h^2\n        main_diag = -2.0 / h**2 - kappa**2 * np.cosh(phi_interior)\n        off_diag_val = 1.0 / h**2\n        \n        # Scipy's solve_banded requires the matrix in a special banded format (ab).\n        # For a tridiagonal matrix (l=1, u=1), ab is a (3, N-2) array.\n        ab = np.zeros((3, num_interior))\n        ab[0, 1:] = off_diag_val  # Upper diagonal\n        ab[1, :] = main_diag      # Main diagonal\n        ab[2, :-1] = off_diag_val # Lower diagonal\n\n        # Solve the linear system J * delta = -F for the update vector delta\n        delta = solve_banded((1, 1), ab, -residual, check_finite=False)\n        \n        # Update the solution for interior points\n        phi[1:-1] += delta\n        \n    return x, phi\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (kappa, phi_w, L, N, analytical_solution_type)\n        (3.0, 0.05, 4.0, 400, 'DH'),\n        (1.0, 1.0, 8.0, 800, 'GC'),\n        (2.0, 3.0, 8.0, 800, 'GC'),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, phi_w, L, N_float, ana_type = case\n        N = int(N_float)\n        \n        # --- Get Numerical Solution ---\n        x, phi_num = solve_pb_newton(kappa, phi_w, L, N)\n        \n        # --- Get Analytical Solution ---\n        if ana_type == 'DH':\n            # Debye-Hückel (linearized) solution\n            phi_ana = phi_w * np.exp(-kappa * x)\n        elif ana_type == 'GC':\n            # Gouy-Chapman (nonlinear) solution\n            gamma = np.tanh(phi_w / 4.0)\n            exp_term = np.exp(-kappa * x)\n            # The denominator 1 - gamma*exp(-kappa*x) is always positive for phi_w > 0.\n            phi_ana = 2.0 * np.log((1.0 + gamma * exp_term) / (1.0 - gamma * exp_term))\n        else:\n            # This case should not be reached with the given problem.\n            raise ValueError(\"Unknown analytical solution type specified.\")\n            \n        # --- Calculate Error Norms ---\n        # The comparison is over all N grid nodes.\n        diff = phi_num - phi_ana\n        \n        # Root-Mean-Square Absolute Error (E_RMS)\n        e_rms = np.sqrt(np.mean(diff**2))\n        \n        # Maximum Absolute Error (E_inf)\n        e_inf = np.max(np.abs(diff))\n        \n        results.append(f\"{e_rms:.6e}\")\n        results.append(f\"{e_inf:.6e}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}