{
    "hands_on_practices": [
        {
            "introduction": "The Poisson equation is the cornerstone of electrostatics, linking the spatial distribution of charge to the electric potential. This foundational practice will guide you through deriving and solving this equation for a prescribed charge density in a simple one-dimensional system. By working through this analytical problem , you will strengthen your understanding of how potential fields arise from charge and master the mathematical techniques for solving second-order boundary value problems, a critical skill in computational physics.",
            "id": "4085804",
            "problem": "Consider the electrokinetic transport of an electrolyte in a planar one-dimensional domain $x \\in [0, L]$, where $L > 0$. In the Poisson-Nernst-Planck (PNP) framework, the electrostatic potential $\\phi(x)$ is coupled to the charge density $\\rho_{e}(x)$ through Gauss’s law for electrostatics and the constitutive relations for the electric field and electric displacement. Assume the dielectric permittivity is constant and equal to $\\epsilon > 0$. The total charge density is prescribed as $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$, where $\\rho_{0}$ is a constant. The electric potential satisfies homogeneous Dirichlet boundary conditions $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\nStarting from the foundational laws for electrostatics, namely Gauss’s law $\\nabla \\cdot \\mathbf{D} = \\rho_{e}$, the constitutive relation $\\mathbf{D} = \\epsilon \\mathbf{E}$, and the definition of the electric field $\\mathbf{E} = -\\nabla \\phi$, derive the governing differential equation in one dimension for $\\phi(x)$ with constant $\\epsilon$, and solve it exactly for the given $\\rho_{e}(x)$ and boundary conditions. Provide the final closed-form analytic expression for $\\phi(x)$ in terms of $x$, $L$, $\\epsilon$, and $\\rho_{0}$. No numerical approximation is required.",
            "solution": "The problem requires the derivation and solution of the one-dimensional Poisson equation for the electrostatic potential $\\phi(x)$ in a domain $x \\in [0, L]$, given a specific charge density distribution $\\rho_{e}(x)$ and homogeneous Dirichlet boundary conditions. We begin by validating the problem statement.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Domain: $x \\in [0, L]$, where $L > 0$.\n- Foundational Laws:\n    1. Gauss's Law: $\\nabla \\cdot \\mathbf{D} = \\rho_{e}$.\n    2. Constitutive Relation: $\\mathbf{D} = \\epsilon \\mathbf{E}$.\n    3. Electric Field Definition: $\\mathbf{E} = -\\nabla \\phi$.\n- Parameters:\n    - Dielectric permittivity $\\epsilon > 0$ is a constant.\n    - Charge density amplitude $\\rho_{0}$ is a constant.\n- Prescribed Charge Density: $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$.\n- Boundary Conditions: $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on the fundamental principles of electrostatics which lead to the Poisson equation. The problem is well-posed as it describes a second-order linear ordinary differential equation with two boundary conditions (a Dirichlet boundary value problem), which guarantees a unique solution. The setup is self-contained, with all necessary functions, parameters, and conditions provided. The physical model is a standard idealization used in the study of electrokinetic phenomena. There are no contradictions, ambiguities, or factual unsoundness.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation and Solution**\n\nFirst, we derive the one-dimensional Poisson equation from the given foundational laws.\nWe start with Gauss's law for the electric displacement field $\\mathbf{D}$:\n$$ \\nabla \\cdot \\mathbf{D} = \\rho_{e} $$\nSubstitute the constitutive relation $\\mathbf{D} = \\epsilon \\mathbf{E}$:\n$$ \\nabla \\cdot (\\epsilon \\mathbf{E}) = \\rho_{e} $$\nSince the dielectric permittivity $\\epsilon$ is a constant, it can be factored out of the divergence operator:\n$$ \\epsilon (\\nabla \\cdot \\mathbf{E}) = \\rho_{e} $$\nNext, we substitute the definition of the electric field $\\mathbf{E}$ in terms of the electrostatic potential $\\phi$, $\\mathbf{E} = -\\nabla \\phi$:\n$$ \\epsilon (\\nabla \\cdot (-\\nabla \\phi)) = \\rho_{e} $$\n$$ -\\epsilon (\\nabla \\cdot \\nabla \\phi) = \\rho_{e} $$\nThe operator $\\nabla \\cdot \\nabla$ is the Laplacian operator, denoted as $\\nabla^2$. Thus, we obtain the general Poisson equation:\n$$ -\\epsilon \\nabla^2 \\phi = \\rho_{e} $$\nFor a one-dimensional planar system, the Laplacian simplifies to the second derivative with respect to the spatial coordinate $x$, i.e., $\\nabla^2 = \\frac{d^2}{dx^2}$. The equation becomes:\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{e}(x) $$\nNow, we substitute the given expression for the charge density $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$:\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\nRearranging the equation to solve for $\\frac{d^2\\phi}{dx^2}$, we get the ordinary differential equation to be solved:\n$$ \\frac{d^2\\phi}{dx^2} = -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\nWe solve this second-order ODE by integrating twice with respect to $x$. Integrating once yields the derivative of the potential, $\\frac{d\\phi}{dx}$:\n$$ \\frac{d\\phi}{dx} = \\int -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx $$\n$$ \\frac{d\\phi}{dx} = -\\frac{\\rho_{0}}{\\epsilon} \\int \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx = -\\frac{\\rho_{0}}{\\epsilon} \\left(-\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 $$\n$$ \\frac{d\\phi}{dx} = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 $$\nwhere $C_1$ is the first constant of integration.\nIntegrating a second time gives the general solution for the potential $\\phi(x)$:\n$$ \\phi(x) = \\int \\left(\\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1\\right) dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\int \\cos\\!\\left(\\frac{\\pi x}{L}\\right) dx + \\int C_1 dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\left(\\frac{L}{\\pi} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 x + C_2 $$\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x + C_2 $$\nwhere $C_2$ is the second constant of integration.\n\nNow, we apply the boundary conditions to determine the constants $C_1$ and $C_2$.\nThe first boundary condition is $\\phi(0) = 0$:\n$$ \\phi(0) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi \\cdot 0}{L}\\right) + C_1(0) + C_2 = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(0) + 0 + C_2 = 0 $$\nSince $\\sin(0) = 0$, this simplifies to:\n$$ 0 + C_2 = 0 \\implies C_2 = 0 $$\nThe solution now has the form:\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x $$\nThe second boundary condition is $\\phi(L) = 0$:\n$$ \\phi(L) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi L}{L}\\right) + C_1 L = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(\\pi) + C_1 L = 0 $$\nSince $\\sin(\\pi) = 0$, this simplifies to:\n$$ 0 + C_1 L = 0 $$\nGiven that the domain length $L > 0$, we must have:\n$$ C_1 = 0 $$\nBoth integration constants are zero. Substituting $C_1 = 0$ and $C_2 = 0$ into the general solution yields the final, unique solution for the electrostatic potential:\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\nThis expression represents the closed-form analytic expression for $\\phi(x)$ in terms of the given parameters.",
            "answer": "$$\\boxed{\\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "While the Poisson equation governs the electrostatics, the Nernst-Planck equation describes the dynamics of ion transport. This exercise isolates the transport phenomena by considering a single ionic species under a constant electric field, where diffusion and electromigration compete. By deriving the steady-state concentration profile , you will gain direct insight into how the balance between diffusive and drift fluxes determines the spatial distribution of ions in a non-equilibrium system.",
            "id": "4085781",
            "problem": "Consider a single ionic species $i$ of valence $z_i$ in a one-dimensional domain $0 \\le x \\le L$ within the framework of the Poisson-Nernst-Planck (PNP) equations, where PNP stands for Poisson-Nernst-Planck. Assume the following scientifically standard conditions for dilute solutions:\n- The electric field $E$ is uniform and constant, with $E = -\\partial_x \\phi$, where $\\phi(x)$ is the electric potential.\n- The diffusion coefficient $D_i$ and the electrophoretic mobility $\\mu_i$ are spatially constant.\n- Convection and homogeneous reactions are negligible.\n- The system is in a steady state so that the total flux $J_i$ is independent of $x$.\n\nStarting from mass conservation and the constitutive form of the Nernst-Planck flux (derived from Fick’s law and drift under an electric force), derive the steady-state concentration profile $c_i(x)$ in terms of $J_i$, $D_i$, $\\mu_i$, $z_i$, $e$, $E$, and the boundary condition $c_i(0) = c_0$. The final expression must be a single closed-form analytic expression for $c_i(x)$. No numerical approximation is required and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of the steady-state concentration profile $c_i(x)$ for a single ionic species in a one-dimensional domain under a constant electric field. The derivation begins with the principles of mass conservation and the Nernst-Planck equation for ionic flux.\n\nFirst, we state the equation for mass conservation of species $i$. In a one-dimensional system at steady state ($\\frac{\\partial c_i}{\\partial t} = 0$), with no chemical reactions, the divergence of the flux $J_i$ is zero. This is expressed as:\n$$\n\\frac{dJ_i}{dx} = 0\n$$\nThis equation implies that the total flux $J_i$ is constant throughout the domain, a condition which is explicitly given in the problem statement.\n\nNext, we write the constitutive equation for the flux, which is the Nernst-Planck equation. The total flux $J_i$ is the sum of the diffusive flux (governed by Fick's first law) and the drift flux (due to the electric field).\nThe diffusive flux, $J_{i,\\text{diff}}$, is given by:\n$$\nJ_{i,\\text{diff}} = -D_i \\frac{dc_i}{dx}\n$$\nwhere $D_i$ is the diffusion coefficient and $\\frac{dc_i}{dx}$ is the concentration gradient.\n\nThe drift flux, $J_{i,\\text{drift}}$, is caused by the migration of ions under the influence of an electric field $E$. The electric force on an ion is $F_e = q_i E$, where $q_i = z_i e$ is the charge of the ion ($z_i$ is the valence and $e$ is the elementary charge). The drift velocity $v_{\\text{drift}}$ is related to this force by the mobility $\\mu_i$ as $v_{\\text{drift}} = \\mu_i F_e = \\mu_i z_i e E$. The drift flux is the product of the concentration and the drift velocity:\n$$\nJ_{i,\\text{drift}} = c_i(x) v_{\\text{drift}} = c_i(x) \\mu_i z_i e E\n$$\nThe total Nernst-Planck flux $J_i$ is the sum of these two contributions:\n$$\nJ_i = J_{i,\\text{diff}} + J_{i,\\text{drift}} = -D_i \\frac{dc_i}{dx} + \\mu_i z_i e E c_i(x)\n$$\nSince $J_i$, $D_i$, $\\mu_i$, $z_i$, $e$, and $E$ are all constants, this is a first-order linear ordinary differential equation for the concentration profile $c_i(x)$. We rearrange the equation to solve for $c_i(x)$:\n$$\nD_i \\frac{dc_i}{dx} - \\mu_i z_i e E c_i(x) = -J_i\n$$\nDividing by $D_i$ places it in the standard form $\\frac{dy}{dx} + P(x) y = Q(x)$:\n$$\n\\frac{dc_i}{dx} - \\left(\\frac{\\mu_i z_i e E}{D_i}\\right) c_i(x) = -\\frac{J_i}{D_i}\n$$\nThis linear ODE can be solved using the method of integrating factors. The integrating factor $I(x)$ is given by:\n$$\nI(x) = \\exp\\left(\\int -\\frac{\\mu_i z_i e E}{D_i} \\,dx\\right) = \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)\n$$\nMultiplying the ODE by $I(x)$:\n$$\n\\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)\\frac{dc_i}{dx} - \\frac{\\mu_i z_i e E}{D_i}\\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)c_i(x) = -\\frac{J_i}{D_i}\\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)\n$$\nThe left side is the derivative of the product $c_i(x) I(x)$:\n$$\n\\frac{d}{dx}\\left[c_i(x) \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)\\right] = -\\frac{J_i}{D_i}\\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right)\n$$\nWe integrate both sides with respect to $x$. This requires the condition that $\\mu_i z_i e E \\neq 0$.\n$$\nc_i(x) \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) = \\int -\\frac{J_i}{D_i}\\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) dx\n$$\n$$\nc_i(x) \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) = -\\frac{J_i}{D_i} \\left(\\frac{-D_i}{\\mu_i z_i e E}\\right) \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) + C\n$$\nwhere $C$ is the constant of integration. Simplifying this expression gives:\n$$\nc_i(x) \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) = \\frac{J_i}{\\mu_i z_i e E} \\exp\\left(-\\frac{\\mu_i z_i e E}{D_i} x\\right) + C\n$$\nSolving for $c_i(x)$ by multiplying by $\\exp\\left(\\frac{\\mu_i z_i e E}{D_i} x\\right)$:\n$$\nc_i(x) = \\frac{J_i}{\\mu_i z_i e E} + C \\exp\\left(\\frac{\\mu_i z_i e E}{D_i} x\\right)\n$$\nTo find the constant $C$, we apply the boundary condition provided: $c_i(0) = c_0$.\n$$\nc_i(0) = c_0 = \\frac{J_i}{\\mu_i z_i e E} + C \\exp(0) = \\frac{J_i}{\\mu_i z_i e E} + C\n$$\nSolving for $C$:\n$$\nC = c_0 - \\frac{J_i}{\\mu_i z_i e E}\n$$\nSubstituting this expression for $C$ back into the general solution for $c_i(x)$ yields the final expression for the steady-state concentration profile:\n$$\nc_i(x) = \\frac{J_i}{\\mu_i z_i e E} + \\left(c_0 - \\frac{J_i}{\\mu_i z_i e E}\\right) \\exp\\left(\\frac{\\mu_i z_i e E}{D_i} x\\right)\n$$\nThis is the closed-form analytical expression for $c_i(x)$ in terms of the given parameters.",
            "answer": "$$\n\\boxed{\\frac{J_i}{\\mu_i z_i e E} + \\left(c_0 - \\frac{J_i}{\\mu_i z_i e E}\\right) \\exp\\left(\\frac{\\mu_i z_i e E}{D_i} x\\right)}\n$$"
        },
        {
            "introduction": "The full power of the Poisson-Nernst-Planck framework is in coupling electrostatics and ion transport. In the important case of thermodynamic equilibrium, this coupling gives rise to the Poisson-Boltzmann (PB) equation, which describes the structure of the electric double layer. This capstone practice  challenges you to compare the full, nonlinear PB model with its widely used linearization, the Debye-Hückel approximation, using a combination of analytical derivation and numerical computation to map the approximation's domain of validity.",
            "id": "4085840",
            "problem": "Consider a one-dimensional planar electric double layer in a symmetric monovalent electrolyte near a uniformly charged, flat, nonconducting wall at position $x=0$, with the electrolyte occupying $x \\ge 0$. The electric potential is denoted by $\\psi(x)$, and the wall potential boundary condition is $\\psi(0)=\\phi_0$, while electroneutral bulk is approached as $x \\to \\infty$ with $\\psi(\\infty)=0$. The electrolyte has bulk molar concentration $c_0$ (in $\\mathrm{mol}/\\mathrm{m}^3$), and the temperature is $T$ (in $\\mathrm{K}$). Assume the solvent is water with constant relative permittivity $\\varepsilon_r=78.5$ (dimensionless), and use the vacuum permittivity $\\varepsilon_0$ (in $\\mathrm{F}/\\mathrm{m}$), elementary charge $e$ (in $\\mathrm{C}$), Boltzmann constant $k_B$ (in $\\mathrm{J}/\\mathrm{K}$), and Avogadro constant $N_A$ (in $\\mathrm{mol}^{-1}$) as standard physical constants.\n\nStarting from first principles appropriate for electrokinetic transport in complex fluids:\n- The electrostatic Poisson equation $-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$, where $\\varepsilon=\\varepsilon_r \\varepsilon_0$ is the permittivity and $\\rho$ is the free charge density.\n- The Boltzmann distribution for ion number densities at equilibrium $n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$ for cations and anions, with $n_0=N_A c_0$.\n- The definition of the Debye length for a symmetric monovalent electrolyte, derived from linear response about electroneutral bulk.\n\nYour tasks:\n1. Derive, from these bases without invoking any shortcut formulas, the one-dimensional planar full Poisson–Boltzmann equation for $\\psi(x)$ and its linearized Debye–Hückel approximation in terms of the dimensionless potential $u(x)=\\frac{e \\psi(x)}{k_B T}$, the inverse Debye length $\\kappa$, and appropriate boundary conditions. Obtain explicit expressions for $\\psi_{\\mathrm{PB}}(x)$ and $\\psi_{\\mathrm{DH}}(x)$ consistent with the stated boundary conditions.\n2. Define a quantitative error metric $\\mathcal{E}(c_0,\\phi_0,T)$ comparing the Debye–Hückel approximation to the full Poisson–Boltzmann solution over a semi-infinite domain truncated to $L=10 \\lambda_D$, where $\\lambda_D$ is the Debye length. Use the normalized root-mean-square error over $[0,L]$:\n$$\n\\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}.\n$$\nCompute $\\mathcal{E}$ numerically by approximating the integrals using a uniform grid with at least $10^4$ points on $[0,L]$.\n3. Determine, for each given parameter triple $(c_0,\\phi_0,T)$ below, whether the Debye–Hückel approximation yields less than $5\\%$ error compared to the full Poisson–Boltzmann solution, using the criterion $\\mathcal{E}  0.05$ expressed as the decimal threshold $0.05$. Use strict International System of Units (SI) for inputs: $c_0$ in $\\mathrm{mol}/\\mathrm{m}^3$, $\\phi_0$ in $\\mathrm{V}$, and $T$ in $\\mathrm{K}$.\n\nTest suite (each item is a triple $(c_0,\\phi_0,T)$):\n- $(1.0, 0.010, 298)$\n- $(100.0, 0.050, 298)$\n- $(10.0, 0.200, 298)$\n- $(1.0, 0.100, 310)$\n- $(500.0, 0.100, 273)$\n\nYour program must:\n- Implement the derived formulas and compute $\\mathcal{E}$ for each test case using the stated constants.\n- Produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets, in the order of the test suite (e.g., $[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_5]$), where each boolean is $\\mathrm{True}$ if $\\mathcal{E}  0.05$ and $\\mathrm{False}$ otherwise.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n1.  **System:** A one-dimensional planar electric double layer in a symmetric monovalent electrolyte adjacent to a flat, nonconducting wall at $x=0$. The electrolyte is in the region $x \\ge 0$.\n2.  **Variables:** Electric potential $\\psi(x)$, cation/anion number densities $n_\\pm(x)$.\n3.  **Boundary Conditions:**\n    - Wall potential: $\\psi(0) = \\phi_0$.\n    - Bulk electroneutrality: $\\psi(x) \\to 0$ as $x \\to \\infty$.\n4.  **Parameters:**\n    - Bulk molar concentration of electrolyte: $c_0$ (in $\\mathrm{mol}/\\mathrm{m}^3$).\n    - Temperature: $T$ (in $\\mathrm{K}$).\n    - Relative permittivity of the solvent (water): $\\varepsilon_r=78.5$.\n5.  **Fundamental Principles  Definitions:**\n    - Poisson's equation for electrostatics: $-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$, with $\\varepsilon=\\varepsilon_r \\varepsilon_0$.\n    - Boltzmann distribution for ion densities: $n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$, where $n_0 = N_A c_0$.\n    - Definition of Debye length is to be derived from linear response theory.\n6.  **Task 1:** Derive the 1D planar Poisson–Boltzmann (PB) equation and its linearized Debye–Hückel (DH) approximation, and find their analytical solutions $\\psi_{\\mathrm{PB}}(x)$ and $\\psi_{\\mathrm{DH}}(x)$.\n7.  **Task 2:** Define an error metric $\\mathcal{E}$ as the normalized root-mean-square error comparing the DH and PB solutions over the domain $[0,L]$, where $L=10\\lambda_D$.\n    $$\n    \\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}\n    $$\n    Numerical integration is required on a uniform grid with at least $10^4$ points.\n8.  **Task 3:** For a given test suite of $(c_0, \\phi_0, T)$, determine if $\\mathcal{E}  0.05$.\n9.  **Constants:** The problem refers to standard physical constants: vacuum permittivity $\\varepsilon_0$, elementary charge $e$, Boltzmann constant $k_B$, and Avogadro constant $N_A$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria:\n\n-   **Scientifically Grounded:** The problem is firmly rooted in the established theory of electrostatics and statistical mechanics as applied to electrolytes, specifically the Poisson-Boltzmann theory. This is a canonical problem in physical chemistry and computational complex fluids. It is free of any pseudoscience or controversial claims.\n-   **Well-Posed:** The problem is well-posed. The governing equations, geometry, and boundary conditions are specified, allowing for the derivation of unique and stable solutions. The numerical task is clearly defined with a specific error metric and computational requirements.\n-   **Objective:** The problem is stated in precise, objective, and quantitative terms. All parameters are defined, and the tasks are unambiguous.\n-   **Self-Contained and Consistent:** The problem provides all necessary information to proceed with the derivation and calculation. There are no internal contradictions. The request to derive the equations from the given principles (Poisson's equation, Boltzmann distribution) is consistent and ensures a foundational approach.\n-   **No other flaws:** The problem is not trivial, metaphorical, or outside the scope of scientific verification. It represents a standard analysis of the limits of the Debye-Hückel approximation.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivations and Computational Strategy\n\nThe solution proceeds by first deriving the required analytical expressions for the electric potential and then outlining the numerical procedure to compute the error metric.\n\n**1. Derivation of the Poisson-Boltzmann and Debye-Hückel Equations and Solutions (Task 1)**\n\nThe analysis begins with the one-dimensional form of the Poisson equation for the electric potential $\\psi(x)$, assuming constant permittivity $\\varepsilon = \\varepsilon_r \\varepsilon_0$:\n$$\n-\\varepsilon \\frac{d^2\\psi}{dx^2} = \\rho(x)\n$$\nwhere $\\rho(x)$ is the local free charge density. For a symmetric monovalent ($z=1$) electrolyte, the charge density is given by the difference in cation and anion concentrations, multiplied by the elementary charge $e$:\n$$\n\\rho(x) = e n_+(x) - e n_-(x)\n$$\nThe ion number densities $n_\\pm(x)$ are assumed to follow a Boltzmann distribution, relating their local concentration to the local potential energy $q\\psi(x) = \\pm e\\psi(x)$ relative to the bulk where $\\psi=0$:\n$$\nn_\\pm(x) = n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)\n$$\nHere, $n_0 = N_A c_0$ is the bulk number density of cations (or anions). Substituting the Boltzmann distributions into the expression for $\\rho(x)$:\n$$\n\\rho(x) = e n_0 \\left(e^{-e\\psi(x)/(k_B T)} - e^{+e\\psi(x)/(k_B T)}\\right) = -2 e n_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting this into the Poisson equation gives the full **Poisson-Boltzmann (PB) equation**:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2 e n_0}{\\varepsilon} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nTo simplify, we introduce a dimensionless potential $u(x) = \\frac{e\\psi(x)}{k_B T}$. The PB equation becomes:\n$$\n\\frac{d^2u}{dx^2} = \\left(\\frac{2 e^2 n_0}{\\varepsilon k_B T}\\right) \\sinh(u)\n$$\nThe term in the parenthesis has units of inverse length squared and is defined as the square of the **inverse Debye length**, $\\kappa^2$:\n$$\n\\kappa^2 = \\frac{2 e^2 N_A c_0}{\\varepsilon_r \\varepsilon_0 k_B T}\n$$\nThe Debye length is $\\lambda_D = 1/\\kappa$. Thus, the dimensionless PB equation is:\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 \\sinh(u)\n$$\n\nThe **Debye-Hückel (DH) approximation** is obtained by linearizing the PB equation under the assumption of a small potential, i.e., $|\\psi| \\ll k_B T/e$, which implies $|u| \\ll 1$. In this limit, $\\sinh(u) \\approx u$. The linearized equation is:\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 u \\quad \\text{or} \\quad \\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi\n$$\nThis is the DH equation. Its general solution is $\\psi(x) = A e^{\\kappa x} + B e^{-\\kappa x}$. Applying the boundary conditions:\n-   $\\psi(\\infty) = 0 \\implies A=0$.\n-   $\\psi(0) = \\phi_0 \\implies B=\\phi_0$.\nThe solution to the DH equation is therefore:\n$$\n\\psi_{\\mathrm{DH}}(x) = \\phi_0 e^{-\\kappa x}\n$$\n\nTo solve the full nonlinear PB equation, we multiply by $2 \\frac{du}{dx}$ and integrate:\n$$\n2\\frac{du}{dx}\\frac{d^2u}{dx^2} = 2\\kappa^2 \\sinh(u)\\frac{du}{dx} \\implies \\frac{d}{dx}\\left(\\left(\\frac{du}{dx}\\right)^2\\right) = 2\\kappa^2 \\frac{d}{dx}(\\cosh(u))\n$$\nIntegrating with respect to $x$ yields $\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 \\cosh(u) + C_1$. The constant of integration $C_1$ is found from the bulk boundary condition: at $x \\to \\infty$, both $\\psi \\to 0$ (so $u \\to 0$) and the electric field $E_x = -d\\psi/dx \\to 0$ (so $du/dx \\to 0$).\n$$\n0 = 2\\kappa^2 \\cosh(0) + C_1 \\implies C_1 = -2\\kappa^2\n$$\nSubstituting $C_1$ and using the identity $\\cosh(u) - 1 = 2 \\sinh^2(u/2)$:\n$$\n\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 (\\cosh(u) - 1) = 4\\kappa^2 \\sinh^2(u/2)\n$$\nTaking the square root, we get $\\frac{du}{dx} = \\pm 2\\kappa \\sinh(u/2)$. We must choose the sign that ensures the potential decays from the wall to the bulk. If $\\phi_0>0$, then $u(x)>0$ and we need $du/dx0$, so we take the negative sign. If $\\phi_00$, then $u(x)0$ and $\\sinh(u/2)0$; we need $du/dx>0$, so we must also take the negative sign. The correct choice is always:\n$$\n\\frac{du}{dx} = -2\\kappa \\sinh(u/2)\n$$\nThis is a separable differential equation.\n$$\n\\frac{du}{\\sinh(u/2)} = -2\\kappa \\, dx\n$$\nIntegrating from the wall ($x=0$, $u=u_0$) to a position $x$:\n$$\n\\int_{u_0}^{u(x)} \\frac{dz}{\\sinh(z/2)} = -2\\kappa \\int_0^x d\\xi' = -2\\kappa x\n$$\nThe integral on the left is $2 \\ln(\\tanh(z/4))$.\n$$\n\\left[2\\ln\\left(\\tanh\\left(\\frac{z}{4}\\right)\\right)\\right]_{u_0}^{u(x)} = 2\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -2\\kappa x\n$$\nSolving for $u(x)$:\n$$\n\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -\\kappa x \\implies \\tanh\\left(\\frac{u(x)}{4}\\right) = \\tanh\\left(\\frac{u_0}{4}\\right)e^{-\\kappa x}\n$$\nwhere $u_0 = u(0) = e\\phi_0/(k_B T)$. The final solution for $\\psi_{\\mathrm{PB}}(x)$ is:\n$$\n\\psi_{\\mathrm{PB}}(x) = \\frac{k_B T}{e} u(x) = \\frac{4 k_B T}{e} \\mathrm{arctanh}\\left(\\tanh\\left(\\frac{e\\phi_0}{4 k_B T}\\right)e^{-\\kappa x}\\right)\n$$\n\n**2. Error Metric and Numerical Computation (Tasks 2  3)**\n\nThe problem defines a normalized root-mean-square error $\\mathcal{E}$ to quantify the deviation of the DH solution from the PB solution:\n$$\n\\mathcal{E} = \\frac{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}\n$$\nThe integration is performed over the domain $[0,L]$, where $L=10\\lambda_D = 10/\\kappa$. This domain covers the vast majority of the potential decay, as the characteristic length scale is $\\lambda_D$.\n\nTo compute $\\mathcal{E}$ for each parameter set $(c_0, \\phi_0, T)$, the following procedure is implemented:\n1.  Use standard SI values for the physical constants: $e=1.602176634 \\times 10^{-19} \\ \\mathrm{C}$, $k_B=1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$, $N_A=6.02214076 \\times 10^{23} \\ \\mathrm{mol}^{-1}$, $\\varepsilon_0=8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$. The relative permittivity of water is given as $\\varepsilon_r=78.5$.\n2.  Calculate the inverse Debye length $\\kappa$ for the given $c_0$ and $T$.\n3.  Set up a uniform spatial grid $x_i$ from $0$ to $L=10/\\kappa$ with at least $10^4$ points. We will use $10001$ points.\n4.  Evaluate $\\psi_{\\mathrm{DH}}(x_i)$ and $\\psi_{\\mathrm{PB}}(x_i)$ at each grid point using the derived formulas.\n5.  Compute the integrands for the numerator, $(\\psi_{\\mathrm{DH}}(x_i)-\\psi_{\\mathrm{PB}}(x_i))^2$, and the denominator, $(\\psi_{\\mathrm{PB}}(x_i))^2$.\n6.  Numerically approximate the two integrals using the composite trapezoidal rule.\n7.  Calculate $\\mathcal{E}$ and determine if it is less than the threshold $0.05$. This yields a boolean result for each test case.\n\nThe validity of the DH approximation is primarily governed by the magnitude of the dimensionless surface potential $u_0 = e\\phi_0/(k_B T)$. The approximation is expected to be accurate for $|u_0| \\ll 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ... # Scipy is not needed\n\ndef solve():\n    \"\"\"\n    Solves the Poisson-Boltzmann problem to compare Debye-Hückel and full solutions.\n    \"\"\"\n\n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23            # Boltzmann constant in J/K\n    NA = 6.02214076e23           # Avogadro constant in mol^-1\n    EPS_0 = 8.854187817e-12      # Vacuum permittivity in F/m\n    EPS_R = 78.5                 # Relative permittivity of water\n\n    # Test cases: (c0 in mol/m^3, phi0 in V, T in K)\n    test_cases = [\n        (1.0, 0.010, 298),\n        (100.0, 0.050, 298),\n        (10.0, 0.200, 298),\n        (1.0, 0.100, 310),\n        (500.0, 0.100, 273),\n    ]\n\n    results = []\n    \n    # Numerical integration parameters\n    num_points = 10001  # Use 10001 points for 10^4 points (10000 intervals)\n\n    for c0, phi0, T in test_cases:\n        # Calculate derived parameters for the current case\n        epsilon = EPS_R * EPS_0\n        \n        # Calculate inverse Debye length (kappa)\n        kappa_sq = (2 * E_CHARGE**2 * NA * c0) / (epsilon * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        \n        # Set integration limit L = 10 * debye_length\n        lambda_d = 1.0 / kappa\n        L = 10.0 * lambda_d\n        \n        # Dimensionless surface potential\n        thermal_voltage = KB * T / E_CHARGE\n        u0 = phi0 / thermal_voltage\n        \n        # Set up the spatial grid for integration\n        x_grid = np.linspace(0, L, num_points)\n        \n        # --- Calculate potentials on the grid ---\n        \n        # 1. Debye-Huckel (DH) solution\n        psi_dh = phi0 * np.exp(-kappa * x_grid)\n        \n        # 2. Full Poisson-Boltzmann (PB) solution\n        # Handle the phi0 = 0 case, although not in test suite.\n        if phi0 == 0.0:\n            psi_pb = np.zeros_like(x_grid)\n        else:\n            tanh_arg = u0 / 4.0\n            tanh_val = np.tanh(tanh_arg)\n            arctanh_arg = tanh_val * np.exp(-kappa * x_grid)\n            psi_pb = 4.0 * thermal_voltage * np.arctanh(arctanh_arg)\n\n        # --- Calculate the error metric E ---\n        \n        # Integrand for the numerator of E^2\n        integrand_num = (psi_dh - psi_pb)**2\n        \n        # Integrand for the denominator of E^2\n        integrand_den = psi_pb**2\n        \n        # Numerically compute integrals using the trapezoidal rule\n        integral_num = np.trapz(integrand_num, x=x_grid)\n        integral_den = np.trapz(integrand_den, x=x_grid)\n        \n        # Calculate the error E\n        if integral_den == 0:\n            # This occurs if phi0=0. In this case, psi_pb is zero everywhere.\n            # If psi_dh is also zero (which it is for phi0=0), the error is 0.\n            # Otherwise, if psi_dh is not zero, the relative error is infinite.\n            # For phi0=0, error is taken as 0.\n            error = 0.0\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        # Compare error to the threshold 0.05\n        results.append(error  0.05)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}