{
    "hands_on_practices": [
        {
            "introduction": "The harmonic spring is the archetypal model for a covalent bond in molecular simulations. This first exercise guides you through a fundamental analysis connecting the mechanical properties of a simple dimer to the numerical stability of its simulation. By deriving the natural vibrational frequency from first principles, you will discover why this value is critical for setting the maximum allowable timestep in a velocity-Verlet integrator, a cornerstone of molecular dynamics simulations.",
            "id": "4080010",
            "problem": "Consider a coarse-grained dimer model in computational complex fluids consisting of a pair of beads of masses $m_1$ and $m_2$ connected by a harmonic spring of stiffness $k$ and equilibrium bond length $r_0$. Neglect all nonbonded interactions, damping, and external forces. The bonded potential energy is given by $U(r) = \\frac{1}{2} k \\left(r - r_0\\right)^2$, where $r$ is the instantaneous separation between the two beads. The dimer is to be integrated in time using the velocity-Verlet algorithm within Molecular Dynamics (MD). \n\nStarting strictly from Newton's second law and the given potential $U(r)$, carry out the following derivations:\n- Derive the equation of motion for the relative coordinate between the beads and obtain the natural frequency of the internal (relative) mode.\n- Formulate the discrete update for the relative coordinate under the velocity-Verlet integrator and perform a linear stability analysis of the resulting recurrence to determine a stability criterion on the timestep $\\Delta t$ in terms of the natural frequency. \n\nProvide, as your final result, a single closed-form symbolic expression for the maximum stable timestep $\\Delta t_{\\max}$ in terms of $m_1$, $m_2$, and $k$. No numerical evaluation is required. Your final answer must be a single analytical expression only, with no accompanying text, and must not include units.",
            "solution": "We begin by applying Newton's second law to the two beads. Let the positions of the beads with masses $m_1$ and $m_2$ be $\\mathbf{r}_1(t)$ and $\\mathbf{r}_2(t)$, respectively. The bonded potential energy is given as $U(r) = \\frac{1}{2} k (r - r_0)^2$, where $r = |\\mathbf{r}_1 - \\mathbf{r}_2|$ is the separation distance. The force on bead $1$ from bead $2$ is $\\mathbf{F}_{12}$, and the force on bead $2$ from bead $1$ is $\\mathbf{F}_{21}$. These forces are derived from the potential energy:\n$\\mathbf{F}_{12} = -\\nabla_1 U(r)$. Since $r$ depends on $\\mathbf{r}_1 - \\mathbf{r}_2$, we have $\\nabla_1 r = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{|\\mathbf{r}_1 - \\mathbf{r}_2|} = \\frac{\\mathbf{r}}{r}$.\nThe force magnitude is $F(r) = -\\frac{dU}{dr} = -k(r - r_0)$.\nThus, the force vector on bead $1$ is $\\mathbf{F}_{12} = F(r) \\frac{\\mathbf{r}}{r} = -k(r-r_0)\\frac{\\mathbf{r}}{r}$. By Newton's third law, $\\mathbf{F}_{21} = -\\mathbf{F}_{12}$.\n\nThe equations of motion for the two beads are:\n$$ m_1 \\ddot{\\mathbf{r}}_1 = \\mathbf{F}_{12} $$\n$$ m_2 \\ddot{\\mathbf{r}}_2 = \\mathbf{F}_{21} = -\\mathbf{F}_{12} $$\n\nTo find the equation of motion for the relative coordinate $\\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2$, we compute its second time derivative:\n$$ \\ddot{\\mathbf{r}} = \\ddot{\\mathbf{r}}_1 - \\ddot{\\mathbf{r}}_2 = \\frac{\\mathbf{F}_{12}}{m_1} - \\frac{-\\mathbf{F}_{12}}{m_2} = \\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\mathbf{F}_{12} $$\nWe define the reduced mass $\\mu$ as $\\frac{1}{\\mu} = \\frac{1}{m_1} + \\frac{1}{m_2}$, which gives $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$.\nSubstituting $\\mu$ and the expression for $\\mathbf{F}_{12}$, the equation of motion for the relative coordinate becomes:\n$$ \\mu \\ddot{\\mathbf{r}} = \\mathbf{F}_{12} = -k(r - r_0)\\frac{\\mathbf{r}}{r} $$\nThis equation describes the internal dynamics of the dimer. For the internal vibrational mode, we are interested in the dynamics of the separation distance $r$. Taking the dot product of the equation with $\\frac{\\mathbf{r}}{r}$ and considering only oscillations along the bond axis, the dynamics of the scalar separation $r$ can be described by:\n$$ \\mu \\ddot{r} = -k(r - r_0) $$\nLet $x(t) = r(t) - r_0$ be the displacement from the equilibrium bond length. Then $\\ddot{x} = \\ddot{r}$. Substituting this into the equation gives:\n$$ \\mu \\ddot{x} = -kx $$\n$$ \\ddot{x} + \\frac{k}{\\mu} x = 0 $$\nThis is the equation for a simple harmonic oscillator. The natural angular frequency $\\omega_0$ of this internal mode is given by:\n$$ \\omega_0^2 = \\frac{k}{\\mu} \\implies \\omega_0 = \\sqrt{\\frac{k}{\\mu}} = \\sqrt{k\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)} $$\nThis completes the first part of the derivation.\n\nNext, we perform a stability analysis of the velocity-Verlet integrator for this harmonic oscillator. Let $x_n = x(n\\Delta t)$ and $v_n = v(n\\Delta t)$ be the displacement and velocity at time step $n$. The acceleration is $a(x) = -\\frac{k}{\\mu}x = -\\omega_0^2 x$, so $a_n = a(x_n) = -\\omega_0^2 x_n$.\nThe velocity-Verlet algorithm consists of the following updates:\n$1$. $x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n \\Delta t^2 = x_n + v_n \\Delta t - \\frac{1}{2}\\omega_0^2 x_n \\Delta t^2$\n$2$. $a_{n+1} = -\\omega_0^2 x_{n+1}$\n$3$. $v_{n+1} = v_n + \\frac{1}{2} (a_n + a_{n+1}) \\Delta t = v_n - \\frac{1}{2} \\omega_0^2 (x_n + x_{n+1}) \\Delta t$\n\nTo analyze stability, we write these updates in a matrix form, $\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\mathbf{T} \\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix}$, where $\\mathbf{T}$ is the transfer matrix.\nFrom step $1$:\n$$ x_{n+1} = \\left(1 - \\frac{1}{2}\\omega_0^2 \\Delta t^2\\right) x_n + (\\Delta t) v_n $$\nSubstitute this expression for $x_{n+1}$ into step $3$:\n$$ v_{n+1} = v_n - \\frac{1}{2} \\omega_0^2 \\left(x_n + \\left[x_n + v_n \\Delta t - \\frac{1}{2}\\omega_0^2 x_n \\Delta t^2\\right]\\right) \\Delta t $$\n$$ v_{n+1} = v_n - \\frac{1}{2} \\omega_0^2 \\left(2x_n + v_n \\Delta t - \\frac{1}{2}\\omega_0^2 x_n \\Delta t^2\\right) \\Delta t $$\n$$ v_{n+1} = v_n - \\omega_0^2 x_n \\Delta t - \\frac{1}{2}\\omega_0^2 v_n \\Delta t^2 + \\frac{1}{4}\\omega_0^4 x_n \\Delta t^3 $$\n$$ v_{n+1} = \\left(-\\omega_0^2 \\Delta t + \\frac{1}{4}\\omega_0^4 \\Delta t^3\\right) x_n + \\left(1 - \\frac{1}{2}\\omega_0^2 \\Delta t^2\\right) v_n $$\nThe transfer matrix $\\mathbf{T}$ is:\n$$ \\mathbf{T} = \\begin{pmatrix} 1 - \\frac{1}{2} \\omega_0^2 \\Delta t^2 & \\Delta t \\\\ -\\omega_0^2 \\Delta t \\left(1 - \\frac{1}{4} \\omega_0^2 \\Delta t^2\\right) & 1 - \\frac{1}{2} \\omega_0^2 \\Delta t^2 \\end{pmatrix} $$\nThe integration scheme is stable if the eigenvalues $\\lambda$ of $\\mathbf{T}$ have magnitudes $|\\lambda| \\le 1$. The eigenvalues are the roots of the characteristic equation $\\det(\\mathbf{T} - \\lambda\\mathbf{I}) = 0$.\nThe equation is $\\lambda^2 - \\text{Tr}(\\mathbf{T})\\lambda + \\det(\\mathbf{T}) = 0$.\nThe trace is $\\text{Tr}(\\mathbf{T}) = 2\\left(1 - \\frac{1}{2} \\omega_0^2 \\Delta t^2\\right) = 2 - \\omega_0^2 \\Delta t^2$.\nThe determinant is:\n$$ \\det(\\mathbf{T}) = \\left(1 - \\frac{1}{2}\\omega_0^2\\Delta t^2\\right)^2 + \\omega_0^2\\Delta t^2\\left(1 - \\frac{1}{4}\\omega_0^2\\Delta t^2\\right) $$\n$$ \\det(\\mathbf{T}) = \\left(1 - \\omega_0^2\\Delta t^2 + \\frac{1}{4}\\omega_0^4\\Delta t^4\\right) + \\left(\\omega_0^2\\Delta t^2 - \\frac{1}{4}\\omega_0^4\\Delta t^4\\right) = 1 $$\nThe fact that $\\det(\\mathbf{T}) = 1$ indicates that the integrator is symplectic.\nThe characteristic equation is $\\lambda^2 - (2 - \\omega_0^2 \\Delta t^2)\\lambda + 1 = 0$.\nThe solutions are $\\lambda = \\frac{(2 - \\omega_0^2 \\Delta t^2) \\pm \\sqrt{(2 - \\omega_0^2 \\Delta t^2)^2 - 4}}{2}$.\nFor stability, the eigenvalues must be complex conjugates of magnitude $1$ (oscillatory, stable) or real with magnitude at most $1$. This occurs when the discriminant of the quadratic equation is non-positive:\n$$ (2 - \\omega_0^2 \\Delta t^2)^2 - 4 \\le 0 $$\n$$ (2 - \\omega_0^2 \\Delta t^2)^2 \\le 4 $$\nTaking the square root of both sides gives:\n$$ |2 - \\omega_0^2 \\Delta t^2| \\le 2 $$\nThis is equivalent to the two inequalities:\n$1$. $2 - \\omega_0^2 \\Delta t^2 \\le 2 \\implies -\\omega_0^2 \\Delta t^2 \\le 0 \\implies \\omega_0^2 \\Delta t^2 \\ge 0$, which is always true.\n$2$. $2 - \\omega_0^2 \\Delta t^2 \\ge -2 \\implies 4 \\ge \\omega_0^2 \\Delta t^2$.\nThe stability criterion is therefore $\\omega_0^2 \\Delta t^2 \\le 4$, or, since $\\omega_0$ and $\\Delta t$ are positive, $\\omega_0 \\Delta t \\le 2$.\nThe maximum stable timestep $\\Delta t_{\\max}$ is the value that satisfies the equality:\n$$ \\Delta t_{\\max} = \\frac{2}{\\omega_0} $$\nFinally, we substitute the expression for $\\omega_0$ in terms of the given parameters $m_1$, $m_2$, and $k$:\n$$ \\Delta t_{\\max} = \\frac{2}{\\sqrt{\\frac{k}{\\mu}}} = 2\\sqrt{\\frac{\\mu}{k}} = 2\\sqrt{\\frac{m_1 m_2 / (m_1 + m_2)}{k}} $$\n$$ \\Delta t_{\\max} = 2\\sqrt{\\frac{m_1 m_2}{k(m_1 + m_2)}} $$\nThis is the final symbolic expression for the maximum stable timestep.",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_1 m_2}{k(m_1 + m_2)}}}\n$$"
        },
        {
            "introduction": "While the harmonic model is instructive, real polymer bonds are not infinitely stretchable. This exercise introduces the more realistic FENE potential, which captures the finite extensibility of chemical bonds. Your task is to analyze the stability of this non-linear system, a challenge that requires you to identify the regions of maximum potential curvature to set a safe integration timestep. This practice is essential for developing robust simulation protocols for complex polymer models.",
            "id": "4079943",
            "problem": "Consider a coarse-grained polymer bead-spring model in computational complex fluids, where two beads of mass $m$ are connected by a bond with a finitely extensible nonlinear elastic (FENE) potential and a weak harmonic regularization. The bonded potential is\n$$\nU(r) \\;=\\; U_{\\mathrm{FENE}}(r) \\;+\\; \\frac{k_{h}}{2}\\,\\big(r - r_{0}\\big)^{2},\n$$\nwith\n$$\nU_{\\mathrm{FENE}}(r) \\;=\\; -\\frac{k\\,R_{0}^{2}}{2}\\,\\ln\\!\\left(1 - \\frac{r^{2}}{R_{0}^{2}}\\right),\n$$\nwhere $r$ is the bond length, $k>0$ is the FENE stiffness, $R_{0}>0$ is the maximum extensible length, $k_{h}\\ge 0$ is the harmonic regularization stiffness, and $r_{0}>0$ is a target length for the regularization. Let $r^{\\ast}$ denote the equilibrium bond length defined implicitly by the force balance condition $\\left.\\frac{dU}{dr}\\right|_{r=r^{\\ast}}=0$, assuming $0<r^{\\ast}<R_{0}$. Let $R_{\\max}=R_{0}$ denote the FENE divergence point.\n\nStarting from Newtonâ€™s second law and a linearization of the radial dynamics about a reference bond length, derive a conservative upper bound on the velocity-Verlet time step $\\Delta t$ that guarantees linear stability when the local dynamics is governed by the stiffest accessible curvature of the bonded potential. Specifically:\n\n- Use the definition of curvature $\\kappa(r)\\equiv \\left.\\frac{d^{2}U}{dr^{2}}\\right|_{r}$ to identify the local harmonic frequency $\\omega(r)=\\sqrt{\\kappa(r)/m}$ governing small radial oscillations at $r$.\n- Derive the linear stability condition for velocity-Verlet applied to a single-degree-of-freedom harmonic oscillator $m\\,\\ddot{x}+\\kappa\\,x=0$ and express the corresponding bound on $\\Delta t$ in terms of $\\omega$.\n- Estimate the highest curvature in two regions: (i) near the equilibrium $r^{\\ast}$, using $\\kappa(r^{\\ast})$, and (ii) near the extensibility limit $R_{\\max}$ by evaluating $\\kappa(r)$ at $r=R_{0}\\,(1-\\eta)$ with a small dimensionless safety offset $0<\\eta\\ll 1$ to avoid the divergence at $R_{\\max}$.\n- Combine these to produce a conservative $\\Delta t$ bound that is valid if the bond samples both neighborhoods during integration.\n\nExpress your final answer as a single closed-form analytic expression for the conservative upper bound $\\Delta t_{\\max}$ in terms of $m$, $k$, $R_{0}$, $k_{h}$, $r^{\\ast}$, and $\\eta$. No numerical substitution is required. Report $\\Delta t$ in seconds. Do not round; provide an exact expression.",
            "solution": "The problem requires the derivation of a conservative upper bound for the velocity-Verlet integration time step, $\\Delta t$, for a system of two beads of mass $m$ connected by a composite FENE-harmonic bond. The bound must guarantee linear stability by considering the stiffest accessible curvature of the interaction potential.\n\nThe total potential energy $U(r)$ is given by the sum of a FENE potential $U_{\\mathrm{FENE}}(r)$ and a harmonic potential $U_{h}(r)$:\n$$\nU(r) = -\\frac{k R_{0}^{2}}{2} \\ln\\left(1 - \\frac{r^{2}}{R_{0}^{2}}\\right) + \\frac{k_{h}}{2} (r - r_{0})^{2}\n$$\nwhere $r$ is the bond length, $k$ is the FENE stiffness, $R_{0}$ is the maximum bond extension, $k_{h}$ is the harmonic stiffness, and $r_{0}$ is the harmonic equilibrium length.\n\nThe derivation proceeds in four steps:\n1.  Derive the linear stability condition for the velocity-Verlet algorithm for a harmonic oscillator.\n2.  Calculate the curvature $\\kappa(r)$ of the potential $U(r)$.\n3.  Estimate the maximum curvature $\\kappa_{\\max}$ by evaluating $\\kappa(r)$ at the points specified.\n4.  Combine these results to find the upper bound on $\\Delta t$.\n\nStep 1: Velocity-Verlet Stability\nThe problem asks to model the local dynamics as a single-degree-of-freedom harmonic oscillator with equation of motion $m\\ddot{x} + \\kappa x = 0$, where $\\kappa$ is the local curvature of the potential. This can be written as $\\ddot{x} + \\omega^{2}x = 0$, with the angular frequency $\\omega = \\sqrt{\\kappa/m}$ as defined in the problem.\n\nThe velocity-Verlet algorithm for this system is:\n$$\n\\begin{align*}\nx(t + \\Delta t) &= x(t) + v(t)\\Delta t + \\frac{1}{2}a(t)(\\Delta t)^{2} \\\\\nv(t + \\Delta t) &= v(t) + \\frac{1}{2}[a(t) + a(t+\\Delta t)]\\Delta t\n\\end{align*}\n$$\nwhere the acceleration is $a(t) = -\\omega^{2}x(t)$. The update can be written in matrix form as $\\mathbf{z}(t+\\Delta t) = \\mathbf{A} \\mathbf{z}(t)$, where $\\mathbf{z}(t) = \\begin{pmatrix} x(t) \\\\ v(t) \\end{pmatrix}$ and $\\mathbf{A}$ is the amplification matrix. A standard derivation shows that the eigenvalues of $\\mathbf{A}$ are $\\lambda = \\left(1 - \\frac{\\omega^{2}(\\Delta t)^{2}}{2}\\right) \\pm i \\omega \\Delta t \\sqrt{1 - \\frac{\\omega^{2}(\\Delta t)^{2}}{4}}$. For the algorithm to be stable, the eigenvalues must not have a magnitude greater than $1$. This is satisfied as long as the eigenvalues are complex or on the unit circle, which requires the term under the square root to be non-negative:\n$$\n1 - \\frac{\\omega^{2}(\\Delta t)^{2}}{4} \\ge 0\n$$\nThis leads to the linear stability condition:\n$$\n\\omega \\Delta t \\le 2 \\quad \\implies \\quad \\Delta t \\le \\frac{2}{\\omega}\n$$\n\nStep 2: Curvature of the Potential\nTo find the frequency $\\omega(r) = \\sqrt{\\kappa(r)/m}$, we must compute the curvature $\\kappa(r) = \\frac{d^{2}U}{dr^{2}}$.\nFirst, we compute the first derivative $\\frac{dU}{dr}$:\n$$\n\\frac{dU}{dr} = \\frac{d}{dr}\\left[-\\frac{k R_{0}^{2}}{2} \\ln\\left(1 - \\frac{r^{2}}{R_{0}^{2}}\\right)\\right] + \\frac{d}{dr}\\left[\\frac{k_{h}}{2} (r - r_{0})^{2}\\right]\n$$\n$$\n\\frac{dU}{dr} = -\\frac{k R_{0}^{2}}{2} \\left(\\frac{1}{1 - r^{2}/R_{0}^{2}}\\right) \\left(-\\frac{2r}{R_{0}^{2}}\\right) + k_{h}(r-r_{0}) = \\frac{kr}{1 - r^{2}/R_{0}^{2}} + k_{h}(r-r_{0})\n$$\nNext, we differentiate again to find the curvature $\\kappa(r)$:\n$$\n\\kappa(r) = \\frac{d^{2}U}{dr^{2}} = \\frac{d}{dr}\\left(\\frac{kr}{1 - r^{2}/R_{0}^{2}}\\right) + \\frac{d}{dr}\\left(k_{h}(r-r_{0})\\right)\n$$\nUsing the quotient rule for the FENE term:\n$$\n\\frac{d}{dr}\\left(\\frac{kr}{1 - r^{2}/R_{0}^{2}}\\right) = k \\frac{(1)(1 - r^{2}/R_{0}^{2}) - (r)(-2r/R_{0}^{2})}{(1 - r^{2}/R_{0}^{2})^{2}} = k \\frac{1 + r^{2}/R_{0}^{2}}{(1 - r^{2}/R_{0}^{2})^{2}}\n$$\nThe derivative of the harmonic term is simply $k_{h}$. Thus, the total curvature is:\n$$\n\\kappa(r) = \\frac{k\\left(1 + \\frac{r^{2}}{R_{0}^{2}}\\right)}{\\left(1 - \\frac{r^{2}}{R_{0}^{2}}\\right)^{2}} + k_{h}\n$$\n\nStep 3: Maximum Curvature Estimation\nA conservative time step must be stable for the highest frequency $\\omega_{\\max}$ the system can experience, which corresponds to the maximum curvature $\\kappa_{\\max}$.\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}} = 2\\sqrt{\\frac{m}{\\kappa_{\\max}}}\n$$\nThe problem specifies estimating $\\kappa_{\\max}$ by evaluating the curvature in two critical regions.\n\n(i) Near the equilibrium bond length $r = r^{\\ast}$:\nThe curvature is given by evaluating $\\kappa(r)$ at $r=r^{\\ast}$:\n$$\n\\kappa(r^{\\ast}) = \\frac{k\\left(1 + \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)}{\\left(1 - \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)^{2}} + k_{h}\n$$\n\n(ii) Near the maximum extensibility limit $R_{\\max} = R_{0}$:\nThe curvature is evaluated at $r = R_{0}(1-\\eta)$ for a small safety offset $\\eta > 0$. Let's substitute this into the expression for $\\kappa(r)$.\n$$\n\\frac{r^{2}}{R_{0}^{2}} = \\frac{(R_{0}(1-\\eta))^{2}}{R_{0}^{2}} = (1-\\eta)^{2} = 1 - 2\\eta + \\eta^{2}\n$$\nThe numerator term becomes $1 + \\frac{r^{2}}{R_{0}^{2}} = 1 + (1-2\\eta+\\eta^2) = 2 - 2\\eta + \\eta^{2}$.\nThe denominator involves $1 - \\frac{r^{2}}{R_{0}^{2}} = 1 - (1-2\\eta+\\eta^2) = 2\\eta - \\eta^{2} = \\eta(2-\\eta)$.\nSo the curvature at this point, denoted $\\kappa_{\\eta}$, is:\n$$\n\\kappa_{\\eta} \\equiv \\kappa(R_{0}(1-\\eta)) = \\frac{k(2 - 2\\eta + \\eta^{2})}{(\\eta(2-\\eta))^{2}} + k_{h} = \\frac{k(2 - 2\\eta + \\eta^{2})}{\\eta^{2}(2-\\eta)^{2}} + k_{h}\n$$\n\nA conservative bound must account for the stiffest possible mode. Therefore, we must take the maximum of these two values as our estimate for $\\kappa_{\\max}$:\n$$\n\\kappa_{\\max} = \\max\\left\\{\\kappa(r^{\\ast}), \\kappa_{\\eta}\\right\\}\n$$\n$$\n\\kappa_{\\max} = \\max\\left\\{\\frac{k\\left(1 + \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)}{\\left(1 - \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)^{2}} + k_{h}, \\frac{k\\left(2 - 2\\eta + \\eta^{2}\\right)}{\\eta^{2}\\left(2-\\eta\\right)^{2}} + k_{h}\\right\\}\n$$\n\nStep 4: Final Time Step Bound\nSubstituting this expression for $\\kappa_{\\max}$ into the stability condition gives the final conservative upper bound on the time step, $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = 2\\sqrt{\\frac{m}{\\kappa_{\\max}}}\n$$\nThis results in the final analytical expression.",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m}{\\max\\left\\{\\frac{k\\left(1 + \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)}{\\left(1 - \\left(\\frac{r^{\\ast}}{R_{0}}\\right)^{2}\\right)^{2}} + k_{h}, \\frac{k\\left(2 - 2\\eta + \\eta^{2}\\right)}{\\eta^{2}\\left(2-\\eta\\right)^{2}} + k_{h}\\right\\}}}}\n$$"
        },
        {
            "introduction": "Beyond bond stretching, the conformation of complex molecules is dictated by bending angles. This practice shifts our focus from dynamics to equilibrium statistical mechanics, exploring how thermal energy is distributed in these angular degrees of freedom. You will use the principles of the canonical ensemble to connect the microscopic bending stiffness to the magnitude of thermal fluctuations, and in doing so, verify the celebrated equipartition theorem for a crucial component of molecular structure.",
            "id": "4080033",
            "problem": "Consider a single bending angle in a coarse-grained polymer segment embedded in a complex fluid, defined by three consecutive beads with positions $\\mathbf{r}_{i-1}$, $\\mathbf{r}_{i}$, and $\\mathbf{r}_{i+1}$. The angle $\\theta$ subtends the two bonds $(\\mathbf{r}_{i-1}, \\mathbf{r}_{i})$ and $(\\mathbf{r}_{i}, \\mathbf{r}_{i+1})$. Assume the bonds themselves are enforced by Finite Extensible Nonlinear Elastic (FENE) springs that are sufficiently stiff such that bond-length fluctuations can be neglected for the purpose of analyzing the angular fluctuations. In the small-angle regime around a preferred angle $\\theta_0$, the bending potential is harmonic, given by $U_{\\text{bend}}(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_0)^2$, where $k_{\\theta} > 0$ is the bending stiffness.\n\nThe system is in contact with a thermal bath at absolute temperature $T$, and the bending angle is sampled from the canonical ensemble. The probability density for $\\theta$ is proportional to the Boltzmann weight $\\exp\\!\\left[-\\beta U_{\\text{bend}}(\\theta)\\right]$, with $\\beta = 1/(k_B T)$, and includes the usual geometric measure factor for three-dimensional angles. Assume $\\theta_0 \\in (0, \\pi)$, and that fluctuations are sufficiently small so that the harmonic approximation is valid.\n\nUsing first principles of statistical mechanics and appropriate small-angle approximations justified by the stiffness $k_{\\theta}$, derive an analytic expression for the temperature dependence of the thermal average $\\langle (\\theta - \\theta_0)^2 \\rangle$ in the harmonic small-angle regime. Then use your result to assess the validity of the equipartition theorem for the bending contribution to the mean potential energy in this regime. Your final expression must be valid to leading order in the dimensionless small parameter $k_B T / k_{\\theta}$.\n\nExpress the angle $\\theta$ in radians. Provide the final answer for $\\langle (\\theta - \\theta_0)^2 \\rangle$ as a single closed-form analytic expression in terms of $k_B$, $T$, and $k_{\\theta}$, and do not include units in the final boxed answer. No numerical evaluation is required.",
            "solution": "The primary task is to derive the thermal average of the squared angular deviation, $\\langle (\\theta - \\theta_0)^2 \\rangle$, for a bending potential in a coarse-grained polymer model. The system is in the canonical ensemble at temperature $T$.\n\nThe probability density function, $P(\\theta)$, for the angle $\\theta$ is proportional to the product of the Boltzmann weight and the geometric measure factor for an angle in $3$-dimensional space. The measure factor arises from integrating the solid angle element $d\\Omega = \\sin(\\theta) d\\theta d\\phi$ over the azimuthal angle $\\phi$, which yields a factor of $2\\pi \\sin(\\theta)$. Thus, the probability density for $\\theta$ is given by:\n$$ P(\\theta) = \\frac{1}{Z} \\sin(\\theta) \\exp[-\\beta U_{\\text{bend}}(\\theta)] $$\nwhere $\\beta = 1/(k_B T)$, $U_{\\text{bend}}(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_0)^2$, and $Z$ is the partition function, which acts as a normalization constant:\n$$ Z = \\int_0^\\pi \\sin(\\theta) \\exp\\left[-\\frac{\\beta k_{\\theta}}{2} (\\theta - \\theta_0)^2\\right] d\\theta $$\nThe thermal average $\\langle (\\theta - \\theta_0)^2 \\rangle$ is calculated as the second moment of the deviation $(\\theta - \\theta_0)$ with respect to this probability distribution:\n$$ \\langle (\\theta - \\theta_0)^2 \\rangle = \\int_0^\\pi (\\theta - \\theta_0)^2 P(\\theta) d\\theta = \\frac{\\int_0^\\pi (\\theta - \\theta_0)^2 \\sin(\\theta) \\exp\\left[-\\frac{\\beta k_{\\theta}}{2} (\\theta - \\theta_0)^2\\right] d\\theta}{\\int_0^\\pi \\sin(\\theta) \\exp\\left[-\\frac{\\beta k_{\\theta}}{2} (\\theta - \\theta_0)^2\\right] d\\theta} $$\nThe problem states that fluctuations are small, which corresponds to the harmonic potential being stiff, i.e., $k_{\\theta}$ is large, or the temperature $T$ is low. In this regime, the dimensionless parameter $k_B T / k_{\\theta}$ is small. This implies that the Gaussian term, $\\exp\\left[-\\frac{\\beta k_{\\theta}}{2} (\\theta - \\theta_0)^2\\right]$, is sharply peaked around $\\theta = \\theta_0$. This sharpness allows for several well-justified approximations.\n\nLet's introduce a new variable for the fluctuation, $x = \\theta - \\theta_0$. Then $d\\theta = dx$. The integration limits for $x$ run from $-\\theta_0$ to $\\pi - \\theta_0$. The expression for the average becomes:\n$$ \\langle x^2 \\rangle = \\frac{\\int_{-\\theta_0}^{\\pi - \\theta_0} x^2 \\sin(\\theta_0 + x) \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx}{\\int_{-\\theta_0}^{\\pi - \\theta_0} \\sin(\\theta_0 + x) \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx} $$\nBecause the Gaussian function $\\exp(-\\frac{\\beta k_{\\theta}}{2} x^2)$ decays very rapidly as $x$ moves away from $0$, the main contribution to both integrals comes from a very narrow region around $x=0$. In this region, the term $\\sin(\\theta_0 + x)$ is slowly varying compared to the exponential term. We can therefore approximate it by its value at the peak, $x=0$:\n$$ \\sin(\\theta_0 + x) \\approx \\sin(\\theta_0) $$\nThis approximation is valid to leading order. The problem states $\\theta_0 \\in (0, \\pi)$, which ensures $\\sin(\\theta_0) > 0$, so we are not approximating by zero. With this approximation, the $\\sin(\\theta_0)$ term is a constant and cancels from the numerator and denominator:\n$$ \\langle x^2 \\rangle \\approx \\frac{\\int_{-\\theta_0}^{\\pi - \\theta_0} x^2 \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx}{\\int_{-\\theta_0}^{\\pi - \\theta_0} \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx} $$\nFurthermore, because the integrand is negligible far from $x=0$, extending the finite integration limits $[-\\theta_0, \\pi - \\theta_0]$ to $(-\\infty, \\infty)$ introduces only a very small error, which is higher order in the small parameter $k_B T / k_{\\theta}$. This is justified because both $\\theta_0$ and $\\pi-\\theta_0$ are much larger than the standard deviation of the angle, which scales as $\\sqrt{k_B T / k_\\theta}$.\n$$ \\langle x^2 \\rangle \\approx \\frac{\\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{\\theta}}{2} x^2\\right) dx} $$\nLet $\\alpha = \\frac{\\beta k_{\\theta}}{2}$. The integrals are standard Gaussian integrals. The denominator is:\n$$ I_0 = \\int_{-\\infty}^{\\infty} \\exp(-\\alpha x^2) dx = \\sqrt{\\frac{\\pi}{\\alpha}} $$\nThe numerator can be found by differentiating $I_0$ with respect to $\\alpha$:\n$$ I_2 = \\int_{-\\infty}^{\\infty} x^2 \\exp(-\\alpha x^2) dx = -\\frac{d}{d\\alpha} \\int_{-\\infty}^{\\infty} \\exp(-\\alpha x^2) dx = -\\frac{d}{d\\alpha} \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = -\\sqrt{\\pi} \\left(-\\frac{1}{2}\\alpha^{-3/2}\\right) = \\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} $$\nThe ratio is:\n$$ \\langle x^2 \\rangle = \\frac{I_2}{I_0} = \\frac{\\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}}}{\\sqrt{\\frac{\\pi}{\\alpha}}} = \\frac{1}{2\\alpha} $$\nSubstituting back $\\alpha = \\frac{\\beta k_{\\theta}}{2}$:\n$$ \\langle (\\theta - \\theta_0)^2 \\rangle = \\frac{1}{2 \\left(\\frac{\\beta k_{\\theta}}{2}\\right)} = \\frac{1}{\\beta k_{\\theta}} $$\nFinally, substituting $\\beta = 1/(k_B T)$:\n$$ \\langle (\\theta - \\theta_0)^2 \\rangle = \\frac{k_B T}{k_{\\theta}} $$\nThis is the desired analytic expression for the temperature dependence of $\\langle (\\theta - \\theta_0)^2 \\rangle$ to leading order in $k_B T / k_{\\theta}$.\n\nThe second part of the task is to assess the validity of the equipartition theorem. The theorem states that, for a classical system in thermal equilibrium, every degree of freedom that appears quadratically in the total energy has a mean energy of $\\frac{1}{2} k_B T$.\nThe bending potential energy is $U_{\\text{bend}}(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_0)^2$. This is a quadratic function of the coordinate $(\\theta - \\theta_0)$.\nThe mean potential energy contribution from bending is:\n$$ \\langle U_{\\text{bend}} \\rangle = \\left\\langle \\frac{1}{2} k_{\\theta} (\\theta - \\theta_0)^2 \\right\\rangle = \\frac{1}{2} k_{\\theta} \\langle (\\theta - \\theta_0)^2 \\rangle $$\nSubstituting the result we derived for $\\langle (\\theta - \\theta_0)^2 \\rangle$:\n$$ \\langle U_{\\text{bend}} \\rangle = \\frac{1}{2} k_{\\theta} \\left( \\frac{k_B T}{k_{\\theta}} \\right) = \\frac{1}{2} k_B T $$\nThis result is precisely what the equipartition theorem predicts for a single quadratic degree of freedom. Therefore, our derivation confirms that the equipartition theorem is valid for the bending energy contribution in the harmonic, small-fluctuation regime. The approximations made (approximating $\\sin(\\theta)$ as constant and extending integration limits) are the same approximations under which the equipartition theorem is expected to hold for such a coordinate.",
            "answer": "$$\\boxed{\\frac{k_B T}{k_{\\theta}}}$$"
        }
    ]
}