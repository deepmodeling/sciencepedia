{
    "hands_on_practices": [
        {
            "introduction": "分子动力学模拟的核心在于数值积分算法，它决定了我们能否准确地预测粒子轨迹。这个练习将探讨积分时间步长 $\\Delta t$ 的选择对模拟稳定性的根本性影响。通过一个思想实验，我们将揭示当时间步长与系统中的高频振动发生共振时所产生的灾难性后果，从而强调遵守数值稳定性判据的重要性。",
            "id": "2417133",
            "problem": "在一场溶剂化生物分子的分子动力学 (MD) 模拟中，考虑一个特定的、不受约束的共价键。该键进行高频伸缩振动，并且可以很好地用一个一维谐振子来近似，其角频率为 $\\omega_b$，周期为 $T_b = 2\\pi/\\omega_b$。该系统使用速度Verlet算法和固定的时间步长 $\\Delta t$ 进行积分，且没有施加恒温器。假设对于一个选定的整数 $m \\ge 1$，时间步长满足 $\\Delta t = m\\,T_b$。以下哪项描述了您最可能观察到的关于此键和整个模拟的数值伪影？\n\nA. 严重的数值不稳定性，其特征是快速的非物理能量增长（能量漂移或爆炸），因为时间步长违反了对频率为 $\\omega_b$ 的谐振子进行积分的稳定性条件；任何表观的键的频闪“冻结”效应在不稳定性占主导地位之前都无法实现。\n\nB. 该键的动力学行为精确，能量守恒得到改善，因为精确采样一个或多个完整振动周期通过每一步返回到相同的相位来消除相位误差。\n\nC. 高频键的数值阻尼，其作用类似于隐式约束，通过对完整周期进行平均来提高稳定性并降低有效温度。\n\nD. 键振动纯粹发生时间混叠，表现为较低的表观频率（当 $m=1$ 时包括恒定信号），而总能量保持守恒且轨迹保持稳定。\n\nE. 由时间步长选择引起的任何能量漂移都可以通过施加弱耦合恒温器来完全校正，从而为所有自由度恢复统计上正确的动力学，且没有偏差。",
            "solution": "用户要求对问题陈述进行严格验证，然后进行严谨的解题推导并对所有选项进行评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 模拟类型：溶剂化生物分子的分子动力学 (MD) 模拟。\n- 系统特征：一个特定的、不受约束的共价键。\n- 物理模型：该键被近似为一个一维谐振子。\n- 振子参数：角频率 $\\omega_b$，周期 $T_b = 2\\pi/\\omega_b$。\n- 积分算法：速度Verlet算法。\n- 时间步长：固定的 $\\Delta t$。\n- 恒温器：没有施加恒温器。\n- 核心条件：时间步长设置为 $\\Delta t = m\\,T_b$，其中 $m$ 是一个整数且 $m \\ge 1$。\n- 问题：确定对于该键和整个模拟，最可能出现的数值伪影是什么。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于计算物理和计算化学的原理之中。谐振子是共价键的标准模型，速度Verlet算法是MD的经典积分器，而时间步长、振荡频率和数值稳定性之间的关系是该领域的一个基本概念。\n- **良构性：** 问题陈述是良构的。它提供了所有必要的信息（模型、积分器以及关于时间步长的特定条件），以便分析数值行为并得出唯一且有意义的结论。\n- **客观性：** 问题以精确、客观和技术性的语言陈述，没有任何主观性或歧义。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、良构的且客观的。它不包含任何矛盾、信息缺失或逻辑缺陷。该情景虽然是一个极端的例子，但其设计目的就是为了测试MD中数值积分的一个核心原理。\n**结论：该问题是有效的。**\n现在开始解题过程。\n\n### 解题推导\n\n模拟该键的一维谐振子的运动方程是：\n$$ \\frac{d^2x}{dt^2} = -\\omega_b^2 x $$\n其中 $x$ 是与平衡键长之间的位移。\n\n速度Verlet算法是一种辛积分器，用于在时间上传播系统。其对位置 $x(t)$ 和速度 $v(t)$ 的更新步骤如下：\n1. 更新位置：$x(t + \\Delta t) = x(t) + v(t)\\Delta t + \\frac{1}{2} a(t) (\\Delta t)^2$\n2. 计算未来加速度：$a(t + \\Delta t) = -\\omega_b^2 x(t + \\Delta t)$\n3. 更新速度：$v(t + \\Delta t) = v(t) + \\frac{1}{2} [a(t) + a(t + \\Delta t)] \\Delta t$\n\n为了分析此算法的稳定性，我们可以将更新过程写成作用于状态向量 $(x, v)$ 上的线性变换（传播矩阵）。系统经过多步后的行为由该矩阵的特征值决定。当且仅当特征值的模长不超过1时，算法是稳定的。对于应用于谐振子的速度Verlet算法，此条件导致对角频率和时间步长乘积的严格稳定性判据：\n$$ \\omega_b \\Delta t  2 $$\n\n如果满足此条件，数值轨迹的总能量会在真实的守恒能量周围呈现有界振荡。如果违反此条件，数值轨迹将偏离真实解，系统会变得不稳定。\n\n在给定的问题中，时间步长为 $\\Delta t = m\\,T_b$。由于周期为 $T_b = 2\\pi/\\omega_b$，我们可以将其代入 $\\Delta t$ 的表达式中：\n$$ \\Delta t = m \\frac{2\\pi}{\\omega_b} $$\n现在，我们评估稳定性参数 $\\omega_b \\Delta t$：\n$$ \\omega_b \\Delta t = \\omega_b \\left( m \\frac{2\\pi}{\\omega_b} \\right) = 2\\pi m $$\n问题陈述中说明 $m$ 是一个整数且 $m \\ge 1$。因此，稳定性参数的可能值为 $2\\pi, 4\\pi, 6\\pi, \\dots$。\n由于 $\\pi \\approx 3.14159$，最小可能值为 $2\\pi \\approx 6.28$。\n\n我们必须将此值与稳定性判据进行比较：\n$$ 2\\pi m \\ge 2\\pi \\approx 6.28 > 2 $$\n时间步长的选择 $\\Delta t = m\\,T_b$ 严重违反了速度Verlet算法的稳定性条件。当 $\\omega_b \\Delta t > 2$ 时，传播矩阵的特征值变为实数，并且其中一个的模长大于1。这导致位置和速度的数值解呈指数增长。因此，势能 $(\\frac{1}{2} k x^2)$ 和动能 $(\\frac{1}{2} \\mu v^2)$ 将无界增长，导致总能量的灾难性“爆炸”。这就是数值不稳定性的定义。\n\n频闪“冻结”（即在周期的倍数处采样应显示一个静态系统）的想法是基于*精确*解析解的行为。然而，数值积分器不会重现精确解，尤其是在时间步长很大时。在这个不稳定区域，数值误差在每一步都会被指数级放大，完全主导了任何可能的物理行为。系统将在任何频闪效应可被观察到之前就崩溃了。\n\n### 逐项分析选项\n\n**A. 严重的数值不稳定性，其特征是快速的非物理能量增长（能量漂移或爆炸），因为时间步长违反了对频率为 $\\omega_b$ 的谐振子进行积分的稳定性条件；任何表观的键的频闪“冻结”效应在不稳定性占主导地位之前都无法实现。**\n此选项准确地描述了违反稳定性判据 $\\omega_b \\Delta t  2$ 的后果。时间步长 $\\Delta t = m T_b$ 导致 $\\omega_b \\Delta t = 2\\pi m \\gg 2$，使积分过程远处于不稳定区域。这会导致指数级的能量增长（爆炸）。该陈述还正确地推断出，这种数值伪影是如此严重，以至于它阻止了任何理想化的频闪效应的观察。\n**结论：正确。**\n\n**B. 该键的动力学行为精确，能量守恒得到改善，因为精确采样一个或多个完整振动周期通过每一步返回到相同的相位来消除相位误差。**\n这个陈述有根本性的错误。它描述的是解析解的性质，而不是数值解的性质。速度Verlet算法，像任何数值积分器一样，都存在固有误差。对于如此大的时间步长，误差不会抵消，反而会指数级累积，导致不稳定性。动力学是不准确的，能量守恒被灾难性地违反了。\n**结论：错误。**\n\n**C. 高频键的数值阻尼，其作用类似于隐式约束，通过对完整周期进行平均来提高稳定性并降低有效温度。**\n这与实际发生的情况相反。分析表明是指数级放大，而不是阻尼。不稳定性导致动能和势能的爆炸性增加，这将对应于一个荒谬的、无限上升的温度，而不是降低。某些数值方法（例如，后向欧拉法）可能表现出阻尼，但速度Verlet算法在这种情况下表现为发散。\n**结论：错误。**\n\n**D. 键振动纯粹发生时间混叠，表现为较低的表观频率（当 $m=1$ 时包括恒定信号），而总能量保持守恒且轨迹保持稳定。**\n虽然条件 $\\Delta t = m T_b$ 是时间混叠（表观频率变为零）的经典设置，但此选项错误地声称能量保持守恒且轨迹是稳定的。正如稳定性分析所证明的，轨迹是剧烈不稳定的，能量也不守恒。不稳定性是首要且最具破坏性的伪影。\n**结论：错误。**\n\n**E. 由时间步长选择引起的任何能量漂移都可以通过施加弱耦合恒温器来完全校正，从而为所有自由度恢复统计上正确的动力学，且没有偏差。**\n在这种情况下，能量的增加不是“漂移”，而是“爆炸”。恒温器旨在通过对速度进行微小调整来处理与目标温度的微小偏差。它完全无法抵消指数级的能量爆炸，在这种情况下，能量可能在单个时间步内增加几个数量级。试图这样做将需要如此巨大、非物理的干预，以至于会破坏整个系统的动力学，引入极端偏差，而不是恢复正确性。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使模拟没有因为数值不稳定性而崩溃，它也可能受到更细微误差的困扰，这些误差会随着时间的推移累积，从而破坏结果的物理真实性。在微正则系综（NVE）中，总能量守恒是衡量模拟质量的关键标准，任何系统性的能量漂移都标志着问题的存在。这个练习将引导你诊断能量不守恒的多种常见原因，培养你识别和解决分子动力学模拟中实际问题的关键能力。",
            "id": "2417125",
            "problem": "您正在使用包含Lennard-Jones (LJ) 和库仑相互作用的对加性力场，对一个全原子蛋白质在显式水中进行长时间的微正则系综 (NVE) 分子动力学 (MD) 模拟。积分器是速度Verlet算法，时间步长为 $\\Delta t = 2\\,\\mathrm{fs}$，并且通过约束求解器对连接到氢的共价键施加了刚性约束。非键相互作用采用实空间截断，并使用球形截断和Verlet邻居列表。您仔细地禁用了任何恒温器或恒压器。在 $100\\,\\mathrm{ns}$ 后，报告的总能量 $E_{\\text{tot}}(t) = K(t) + U(t)$ 显示出缓慢但系统的向上漂移，速率约为 $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$。\n\n根据第一性原理，我们知道对于遵循牛顿第二定律 $m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$ 的经典质点，在一个不随时间变化的势 $U$ 和完全保守力的作用下，连续时间动力学会精确地守恒总能量 $E_{\\text{tot}} = K + U$。在离散化的MD中，数值误差、对力的非保守近似或约束的不精确性都可能引入长期的能量漂移。\n\n在所述条件下，以下哪些是 $E_{\\text{tot}}$ 系统性向上漂移的合理解释，以及哪些实用的诊断方法能最直接地识别其来源？选择所有适用项。\n\nA. 积分时间步长 $\\Delta t$ 对于约束了氢键之后剩余的最快运动来说过大，因此离散化误差会注入能量。诊断方法：使用减小的 $\\Delta t$（例如，减至 $\\Delta t = 1\\,\\mathrm{fs}$）重新运行短时间的模拟片段，并比较漂移率；如果较小的 $\\Delta t$ 导致漂移显著减小，则表明存在时间积分误差。\n\nB. 邻居列表的缓冲区域太小和/或在使用硬实空间截断时邻居列表更新得太不频繁，导致粒子对进入截断区域时产生不连续的力，从而对系统做虚功。诊断方法：增加邻居列表的“皮层”（skin）厚度和更新频率，并检查 $U(t)$ 的时间序列中是否有关联邻居列表重建的微小跳跃；跳跃和漂移的减少意味着截断/列表伪影是问题所在。\n\nC. 质心 (COM) 在周期性边界中的平移累积导致内部模式的“加热”，从而提高了 $E_{\\text{tot}}$。诊断方法：周期性地移除质心速度以消除 $E_{\\text{tot}}$ 的漂移。\n\nD. 约束求解器的容差太宽松或迭代次数太少，导致每一步的约束都未完全满足，从而允许求解器对系统做净正功。诊断方法：将约束容差收紧几个数量级和/或增加最大迭代次数，并监测最大约束违反量和能量漂移；两者都减小表明漂移是由约束引起的。\n\nE. 有限精度算术（例如，单精度）使舍入误差的累积产生偏差，导致长期的能量增加。诊断方法：在双精度下完全相同地重新运行模拟并比较漂移；漂移的显著减少表明问题与精度有关。",
            "solution": "首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 模拟系综：微正则 (NVE)，粒子数 ($N$)、体积 ($V$) 和总能量 ($E$) 恒定。\n- 系统：全原子蛋白质在显式水中。\n- 力场：对加性，包含Lennard-Jones (LJ) 和库仑相互作用。势能 $U$ 不随时间变化。\n- 积分器：速度Verlet。\n- 时间步长：$\\Delta t = 2\\,\\mathrm{fs}$。\n- 约束：所有与氢原子相连的共价键都是刚性的，由约束求解器强制执行。\n- 非键方案：实空间截断，使用球形截断和Verlet邻居列表。\n- 恒温器/恒压器：禁用。\n- 模拟时长：$100\\,\\mathrm{ns}$。\n- 观察现象：总能量 $E_{\\text{tot}}(t) = K(t) + U(t)$ 表现出约 $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$ 的系统性向上漂移。\n- 理论背景：对于从不随时变势 $U$ 导出的保守力， $m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$，总能量 $E_{\\text{tot}}$ 在连续时间内是精确的运动守恒量。离散时间MD中的数值伪影可能导致能量漂移。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了一个分子生物物理学中标准的计算实验。\n- **科学依据**：该场景是一个典型的全原子分子动力学模拟。NVE系综、速度Verlet积分器、氢键约束算法（如SHAKE、LINCS）以及带邻居列表的截断非键相互作用都是标准方法。观察到的能量漂移是此类模拟中一个众所周知且至关重要的数值伪影。所描述的漂移率对于给定参数的模拟是现实的。该问题牢固地植根于应用于分子模拟的经典力学和数值分析原理。\n- **问题定义明确**：问题陈述清晰。它在一组定义的模拟条件下提供了一个具体的观察结果（能量向上漂移），并要求从给定列表中评估可能的物理和数值原因。根据该领域的既定知识，存在一组明确的正确答案。\n- **客观性**：问题使用计算化学和物理领域通用的精确技术语言进行陈述。它不含主观或模糊的术语。\n\n### 步骤 3：结论与行动\n问题陈述有效。它在科学上是合理的，定义明确且客观。将基于分子动力学的第一性原理分析每个选项来推导解决方案。\n\n### 解决方案推导与选项分析\n\n在NVE模拟中，系统的总能量应守恒。系统性漂移，而不是有界波动，表明理论上保守的动力学的数值实现存在缺陷。此缺陷源于破坏了积分算法的时间反演对称性和辛性，或引入了非保守力的近似。我们将评估每个选项作为这种能量不守恒的潜在来源。\n\n**A. 积分时间步长 $\\Delta t$ 对于约束了氢键之后剩余的最快运动来说过大，因此离散化误差会注入能量。诊断方法：使用减小的 $\\Delta t$（例如，减至 $\\Delta t = 1\\,\\mathrm{fs}$）重新运行短时间的模拟片段，并比较漂移率；如果较小的 $\\Delta t$ 导致漂移显著减小，则表明存在时间积分误差。**\n\n速度Verlet算法是二阶数值积分器。每一步的局部误差为 $\\mathcal{O}(\\Delta t^3)$ 阶，在固定时间间隔 $T$ 内轨迹的全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。虽然该算法对于保守力是辛的，并且应该表现出有界的能量波动，但如果时间步长过大，无法解析系统最快的特征运动，就会导致共振伪影。这些共振可能导致能量系统性地转移到高频模式中，这种现象通常被称为数值加热。即使在约束了最快的自由度（氢键振动）之后，蛋白质中的其他运动，如键角振动，其周期也可能在 $10-20\\,\\mathrm{fs}$ 的数量级。$\\Delta t = 2\\,\\mathrm{fs}$ 的时间步长是比较激进的，对于稳定积分这些模式可能过大，从而导致离散化误差的累积和总能量的长期向上漂移。所提出的诊断方法是一个标准程序；如果漂移是由于 $\\Delta t$ 的大小引起的，其幅度应随着时间步长的减小而显著减小，通常与 $\\Delta t$ 的某个幂成比例。\n\n结论：**正确**。\n\n**B. 邻居列表的缓冲区域太小和/或在使用硬实空间截断时邻居列表更新得太不频繁，导致粒子对进入截断区域时产生不连续的力，从而对系统做虚功。诊断方法：增加邻居列表的“皮层”（skin）厚度和更新频率，并检查 $U(t)$ 的时间序列中是否有关联邻居列表重建的微小跳跃；跳跃和漂移的减少意味着截断/列表伪影是问题所在。**\n\n在截断半径 $r_c$ 处对势能进行简单截断会使势能函数不可微，相应的力 $\\mathbf{F} = -\\nabla U$ 在 $r = r_c$ 处不连续。不连续的力是非保守的，在此类力下对粒子运动进行积分不满足能量守恒。Verlet邻居列表用于提高效率，其中相互作用仅对半径 $r_{list}  r_c$ 内的粒子对进行计算。该列表在多个时间步内保持不变。如果更新频率太低或“皮层”（skin）厚度 ($r_{list} - r_c$) 太小，一对粒子可能会在邻居列表更新之间穿过截断边界 $r_c$。在穿过后，下一次力计算时，这对粒子上的力会突然出现或消失，产生一个冲量。这会导致势能的不连续和虚功的产生。这些事件很少能平均为零，通常会导致动能的净增加，使系统升温。所提出的诊断方法通过使邻居列表管理更加保守（更厚的皮层，更频繁的更新）来直接检验这一假设，这应该能平滑有效力并减少能量漂移。\n\n结论：**正确**。\n\n**C. 质心 (COM) 在周期性边界中的平移累积导致内部模式的“加热”，从而提高了 $E_{\\text{tot}}$。诊断方法：周期性地移除质心速度以消除 $E_{\\text{tot}}$ 的漂移。**\n\n在没有外力的模拟中，系统的总动量，也就是其质心速度，应该是守恒的。然而，在有限精度算术中对力求和可能导致一个微小的净力，使质心速度从零开始漂移。总动能 $K$ 是质心动能 $K_{\\text{COM}} = \\frac{1}{2} M_{\\text{tot}} \\mathbf{V}_{\\text{COM}}^2$ 和内动能 $K_{\\text{internal}}$ 的和。$\\mathbf{V}_{\\text{COM}}$ 的增加直接增加了 $K_{\\text{COM}}$，从而增加了 $E_{\\text{tot}} = U + K_{\\text{internal}} + K_{\\text{COM}}$。因此，质心速度漂移是*报告的总能量*上升的一个合理解释。然而，该选项的解释“导致内部模式的‘加热’”在物理上是不正确的。质心运动在一阶近似下与内自由度是解耦的。$K_{\\text{COM}}$ 的增加不会将能量转移到内部模式；事实上，一个在长时间NVE模拟中被称为“飞行的冰块”效应的已知伪影，涉及能量*从*内部模式*转移到*质心运动，导致分子内部冷却。该物理机制的描述是有缺陷的。其诊断方法，即移除质心速度，对于解决由质心运动引起的 $E_{\\text{tot}}$ 漂移是正确的，但它解决的是 $K_{COM}$ 的上升，而不是一个虚构的内部模式加热。由于物理推理不正确，此选项不是一个如其所述的有效解释。\n\n结论：**不正确**。\n\n**D. 约束求解器的容差太宽松或迭代次数太少，导致每一步的约束都未完全满足，从而允许求解器对系统做净正功。诊断方法：将约束容差收紧几个数量级和/或增加最大迭代次数，并监测最大约束违反量和能量漂移；两者都减小表明漂移是由约束引起的。**\n\n像SHAKE及其速度层面的对应算法RATTLE（与速度Verlet一起使用）这样的约束算法是迭代的。如果收敛容差太宽松或最大迭代次数不足，约束在每个时间步结束时将不会被完美满足。施加约束修正的过程可以对系统做功。虽然对于一个完全收敛的求解器，这个功的平均值应为零，但不精确的解可能会引入系统性偏差。满足约束的误差意味着约束力并不完全垂直于粒子速度，导致在许多步长上产生净正功或负功。这是一个众所周知的系统性能量漂移来源。所提出的诊断方法是验证这一点的标准且正确的方法：提高约束求解器的精度应能减少误差和相关的能量漂移。\n\n结论：**正确**。\n\n**E. 有限精度算术（例如，单精度）使舍入误差的累积产生偏差，导致长期的能量增加。诊断方法：在双精度下完全相同地重新运行模拟并比较漂移；漂移的显著减少表明问题与精度有关。**\n\n分子动力学模拟在每个时间步都涉及大量的浮点运算。虽然双精度算术（64位）是科学计算的标准，并且通常足以使舍入误差保持随机且不累积，但单精度（32位）算术可能会有问题。较低的精度可能导致显著的准确性损失，尤其是在对许多小数（力）求和或对大数（在动能计算中）求差时。这些舍入误差可能不是随机的，并且可以引入系统性偏差，实际上充当了一个随时间对系统做功的微小非物理力，导致能量漂移。向上漂移是一个非常可能的结果。其诊断方法是决定性的：如果使用双精度算术运行相同的模拟显著减少或消除了能量漂移，那么有限精度效应就是一个主要原因。\n\n结论：**正确**。",
            "answer": "$$\\boxed{ABDE}$$"
        },
        {
            "introduction": "在诊断出模拟中的问题后，下一步便是采取措施进行修正。一个常见的数值赝象是整个系统的质心会产生非物理性的漂移，这违反了动量守恒定律。本练习将指导你从第一性原理出发，推导并应用一种标准校正方法来消除这种漂移，确保模拟的长期稳定性和物理正确性。",
            "id": "4096096",
            "problem": "在一个具有周期性边界条件 (PBC) 的立方体区域内，对一种复杂流体进行分子动力学 (MD) 模拟。在一个速度-Verlet时间步之后，微小的数值误差或恒温器的人为效应可能会引起质心 (COM) 的均匀漂移，导致总动量不为零。为了在保持内部动力学的同时防止模拟单元发生伪平移，您必须在每个时间步结束时，通过对每个粒子施加相同的速度修正来移除质心运动，从而使总动量变为零，且不改变任何粒子对之间的相对速度。\n\n从牛顿定律、动量的定义以及周期性边界条件下的平移不变性要求出发，推导在给定时间步后，为使总动量恰好为零而施加于所有粒子的均匀速度修正的表达式。解释为什么这个修正不改变粒子间的任何相对运动。然后，对于从该流体中提取的一个特定的三粒子子系统，计算粒子 $2$ 的修正后速度。\n\n该子系统包含三个粒子，其质量分别为 $m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$，$m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$ 和 $m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$。在时间步之后，它们的速度分别为\n$$\n\\mathbf{v}_1=\\left(150,\\,-200,\\,50\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_2=\\left(300,\\,100,\\,-100\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_3=\\left(-250,\\,50,\\,200\\right)\\,\\mathrm{m/s}.\n$$\n假设没有外力作用于该系统，并且周期性边界条件仅通过环绕效应影响位置，而不影响瞬时速度。使用您推导的表达式，计算移除质心运动后粒子 $2$ 的修正后速度 $\\mathbf{v}_2'$。请以 $\\mathrm{m/s}$ 为单位表示您的最终数值答案。如果需要四舍五入，请保留四位有效数字；否则，请提供精确值。",
            "solution": "该问题要求推导在分子动力学模拟中用于使粒子系统总动量为零的均匀速度修正，解释为何此修正能保持相对运动不变，并将此修正应用于一个特定的三粒子子系统。\n\n**第一部分：速度修正的推导**\n\n设系统由 $N$ 个粒子组成，在给定的时间步后，第 $i$ 个粒子的质量为 $m_i$，速度为 $\\mathbf{v}_i$。系统的总动量 $\\mathbf{P}_{\\text{total}}$ 是各个粒子动量的矢量和：\n$$\n\\mathbf{P}_{\\text{total}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\sum_{i=1}^{N} m_i \\mathbf{v}_i\n$$\n问题指出，由于数值人为效应，$\\mathbf{P}_{\\text{total}}$ 可能不为零。为了修正这一点，我们对每个粒子施加一个均匀的速度修正 $\\Delta\\mathbf{v}$。第 $i$ 个粒子修正后的新速度 $\\mathbf{v}_i'$ 由下式给出：\n$$\n\\mathbf{v}_i' = \\mathbf{v}_i + \\Delta\\mathbf{v}\n$$\n目标是选择合适的 $\\Delta\\mathbf{v}$，使得新的总动量 $\\mathbf{P}_{\\text{total}}'$ 变为零。\n$$\n\\mathbf{P}_{\\text{total}}' = \\sum_{i=1}^{N} m_i \\mathbf{v}_i' = \\mathbf{0}\n$$\n将 $\\mathbf{v}_i'$ 的表达式代入此方程：\n$$\n\\sum_{i=1}^{N} m_i (\\mathbf{v}_i + \\Delta\\mathbf{v}) = \\mathbf{0}\n$$\n我们可以分配质量 $m_i$ 并将求和项分开：\n$$\n\\sum_{i=1}^{N} m_i \\mathbf{v}_i + \\sum_{i=1}^{N} m_i \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n第一项是原始的总动量 $\\mathbf{P}_{\\text{total}}$。在第二项中，$\\Delta\\mathbf{v}$ 是一个常数矢量，可以从求和中提出来：\n$$\n\\mathbf{P}_{\\text{total}} + \\left(\\sum_{i=1}^{N} m_i\\right) \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n设 $M_{\\text{total}} = \\sum_{i=1}^{N} m_i$ 为系统的总质量。方程变为：\n$$\n\\mathbf{P}_{\\text{total}} + M_{\\text{total}} \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n求解速度修正 $\\Delta\\mathbf{v}$：\n$$\nM_{\\text{total}} \\Delta\\mathbf{v} = -\\mathbf{P}_{\\text{total}}\n$$\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}\n$$\n系统的质心 (COM) 速度定义为 $\\mathbf{v}_{\\text{COM}} = \\frac{\\sum m_i \\mathbf{v}_i}{\\sum m_i} = \\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}$。因此，所需的速度修正量是质心速度的负值：\n$$\n\\Delta\\mathbf{v} = -\\mathbf{v}_{\\text{COM}}\n$$\n这个修正有效地将粒子速度转换到一个质心静止的参考系中，从而使总动量为零。周期性边界条件下的平移不变性前提意味着系统的物理性质应独立于整个系统的均匀平移速度，而这个过程正是移除了这种速度。\n\n**第二部分：相对运动的不变性**\n\n任意两个粒子（比如粒子 $i$ 和粒子 $j$）之间的相对速度定义为 $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$。施加修正后，新的相对速度 $\\mathbf{v}_{ij}'$ 为：\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i' - \\mathbf{v}_j'\n$$\n代入修正后速度的表达式：\n$$\n\\mathbf{v}_{ij}' = (\\mathbf{v}_i + \\Delta\\mathbf{v}) - (\\mathbf{v}_j + \\Delta\\mathbf{v})\n$$\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i + \\Delta\\mathbf{v} - \\mathbf{v}_j - \\Delta\\mathbf{v}\n$$\n均匀修正项 $\\Delta\\mathbf{v}$ 被抵消了：\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i - \\mathbf{v}_j = \\mathbf{v}_{ij}\n$$\n因此，任何粒子对之间的相对速度都不受此均匀速度修正的影响。由于系统中的内力（例如，来自对势的力）取决于粒子的相对位置和相对速度，因此流体的内部动力学、粒子间碰撞和结构演化均不受影响。该修正仅移除了整个系统作为一个刚体的非物理性的均匀平移。\n\n**第三部分：数值计算**\n\n我们将推导出的表达式应用于给定的三粒子子系统。质量和速度如下：\n$m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$，$m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$，$m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$。\n$\\mathbf{v}_1=\\begin{pmatrix} 150  -200  50 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_2=\\begin{pmatrix} 300  100  -100 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_3=\\begin{pmatrix} -250  50  200 \\end{pmatrix}\\,\\mathrm{m/s}$\n\n首先，我们计算总质量 $M_{\\text{total}}$：\n$$\nM_{\\text{total}} = m_1 + m_2 + m_3 = (3.0 + 6.0 + 9.0) \\times 10^{-26}\\,\\mathrm{kg} = 18.0 \\times 10^{-26}\\,\\mathrm{kg}\n$$\n接下来，我们计算总动量 $\\mathbf{P}_{\\text{total}} = m_1\\mathbf{v}_1 + m_2\\mathbf{v}_2 + m_3\\mathbf{v}_3$。我们来计算动量的每个分量，用下标 $x, y, z$ 表示。\n$$\nP_{\\text{total},x} = m_1 v_{1,x} + m_2 v_{2,x} + m_3 v_{3,x} \\\\\n= (3.0 \\times 10^{-26})(150) + (6.0 \\times 10^{-26})(300) + (9.0 \\times 10^{-26})(-250) \\\\\n= (450 + 1800 - 2250) \\times 10^{-26} = 0\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},y} = m_1 v_{1,y} + m_2 v_{2,y} + m_3 v_{3,y} \\\\\n= (3.0 \\times 10^{-26})(-200) + (6.0 \\times 10^{-26})(100) + (9.0 \\times 10^{-26})(50) \\\\\n= (-600 + 600 + 450) \\times 10^{-26} = 450 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},z} = m_1 v_{1,z} + m_2 v_{2,z} + m_3 v_{3,z} \\\\\n= (3.0 \\times 10^{-26})(50) + (6.0 \\times 10^{-26})(-100) + (9.0 \\times 10^{-26})(200) \\\\\n= (150 - 600 + 1800) \\times 10^{-26} = 1350 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\n所以，总动量矢量为 $\\mathbf{P}_{\\text{total}} = \\begin{pmatrix} 0  450  1350 \\end{pmatrix} \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}$。\n\n现在，我们计算速度修正 $\\Delta\\mathbf{v}$：\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}} = -\\frac{\\begin{pmatrix} 0  450  1350 \\end{pmatrix} \\times 10^{-26}}{18.0 \\times 10^{-26}}\n$$\n因子 $10^{-26}$ 消掉了。\n$$\n\\Delta\\mathbf{v} = -\\frac{1}{18.0} \\begin{pmatrix} 0  450  1350 \\end{pmatrix} = -\\begin{pmatrix} \\frac{0}{18.0}  \\frac{450}{18.0}  \\frac{1350}{18.0} \\end{pmatrix}\n$$\n$$\n\\Delta\\mathbf{v} = -\\begin{pmatrix} 0  25  75 \\end{pmatrix} = \\begin{pmatrix} 0  -25  -75 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\n最后，我们计算粒子 $2$ 的修正后速度 $\\mathbf{v}_2'$：\n$$\n\\mathbf{v}_2' = \\mathbf{v}_2 + \\Delta\\mathbf{v}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300  100  -100 \\end{pmatrix} + \\begin{pmatrix} 0  -25  -75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300+0  100-25  -100-75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300  75  -175 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\n所有计算都得到了精确的整数值，因此无需四舍五入。粒子 $2$ 的修正后速度为 $\\begin{pmatrix} 300  75  -175 \\end{pmatrix}\\,\\mathrm{m/s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n300  75  -175\n\\end{pmatrix}\n}\n$$"
        }
    ]
}