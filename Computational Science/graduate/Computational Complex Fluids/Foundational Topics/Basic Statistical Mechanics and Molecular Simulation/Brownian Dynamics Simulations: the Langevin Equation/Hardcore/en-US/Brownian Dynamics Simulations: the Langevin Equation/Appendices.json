{
    "hands_on_practices": [
        {
            "introduction": "To simulate Brownian dynamics, we must translate the continuous Langevin equation into a discrete set of rules a computer can follow. This exercise introduces the Euler-Maruyama method, the most fundamental algorithm for integrating stochastic differential equations, by having you derive its update rule . Understanding this scheme is the first step toward building your own BD simulations and appreciating the critical distinction between strong (pathwise) and weak (statistical) accuracy.",
            "id": "4080292",
            "problem": "Consider Brownian dynamics (BD) for a colloidal particle immersed in a complex fluid under the overdamped assumption, modeled by the stochastic differential equation in the Itô sense,\n$$\n\\mathrm{d}\\mathbf{r}(t) = \\mu\\,\\mathbf{F}(\\mathbf{r}(t))\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(t),\n$$\nwhere $\\mathbf{r}(t)$ is the position, $\\mu$ is a constant mobility, $\\mathbf{F}(\\mathbf{r})$ is the deterministic force, $D$ is the diffusion coefficient related to the mobility by the Einstein relation $D = k_B T\\,\\mu$, and $\\mathbf{W}(t)$ is a Wiener process with independent Cartesian components. Let a uniform time step $\\Delta t  0$ be given, and define $\\Delta \\mathbf{W}_n = \\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)$ with $t_n = n\\,\\Delta t$; each component of $\\Delta \\mathbf{W}_n$ is distributed as $\\mathcal{N}(0,\\Delta t)$ and can be written as $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$, where the components of $\\boldsymbol{\\eta}_n$ are independent and identically distributed standard normal random variables $\\mathcal{N}(0,1)$.\n\nWhich option correctly gives the single-step Euler-Maruyama (EM) update for this overdamped Langevin equation and also correctly specifies the strong and weak orders of convergence of that scheme under standard smoothness and Lipschitz conditions on $\\mathbf{F}$?\n\nA. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.\n\nB. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\boldsymbol{\\eta}_n$; strong order $1$, weak order $1$.\n\nC. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_{n+1})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.\n\nD. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.\n\nE. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1$, weak order $1$.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a derivation of the solution and evaluation of the provided options.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- The governing equation is the overdamped Langevin equation in the Itô sense:\n$$\n\\mathrm{d}\\mathbf{r}(t) = \\mu\\,\\mathbf{F}(\\mathbf{r}(t))\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(t)\n$$\n- $\\mathbf{r}(t)$: particle position vector.\n- $\\mu$: a constant mobility.\n- $\\mathbf{F}(\\mathbf{r})$: a deterministic force.\n- $D$: a diffusion coefficient.\n- $\\mathbf{W}(t)$: a Wiener process with independent Cartesian components.\n- The Einstein relation holds: $D = k_B T\\,\\mu$.\n- The time step is uniform, $\\Delta t > 0$.\n- The time discretization is $t_n = n\\,\\Delta t$.\n- The Wiener process increment is $\\Delta \\mathbf{W}_n = \\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)$.\n- Each component of $\\Delta \\mathbf{W}_n$ is a normal random variable $\\mathcal{N}(0,\\Delta t)$.\n- The increment can be expressed as $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$, where the components of $\\boldsymbol{\\eta}_n$ are independent and identically distributed standard normal random variables, $\\mathcal{N}(0,1)$.\n- The question asks for the correct Euler-Maruyama (EM) update rule and its strong and weak orders of convergence.\n- The problem assumes \"standard smoothness and Lipschitz conditions on $\\mathbf{F}$\" for the convergence analysis.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem presents the standard overdamped Langevin equation, a fundamental model in statistical mechanics for describing the Brownian motion of particles. All definitions, including the properties of the Wiener process and the Einstein relation, are scientifically correct and standard in the field of computational physics and chemistry.\n- **Well-Posed**: The problem is well-posed. It asks for a specific, standard numerical integration scheme (Euler-Maruyama) for a given stochastic differential equation (SDE) and for its known convergence properties. This is a non-ambiguous question with a unique correct answer within the established theory of numerical SDEs.\n- **Objective**: The problem is stated in precise, objective mathematical language.\n- **Consistency and Completeness**: The problem is self-contained. It provides the SDE, the definitions of all terms, the properties of the stochastic process, and the context (numerical integration). The mention of \"standard smoothness and Lipschitz conditions\" is the correct and necessary context for discussing convergence orders.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and complete. I will proceed with the derivation of the solution.\n\n**Solution Derivation**\n\nThe problem asks for the Euler-Maruyama (EM) discretization of the given SDE and the corresponding orders of convergence.\n\n**1. Derivation of the Euler-Maruyama Scheme**\n\nThe overdamped Langevin equation is an Itô SDE of the general form:\n$$\n\\mathrm{d}\\mathbf{X}(t) = \\mathbf{a}(\\mathbf{X}(t), t)\\,\\mathrm{d}t + \\mathbf{b}(\\mathbf{X}(t), t)\\,\\mathrm{d}\\mathbf{W}(t)\n$$\nIn our specific case, $\\mathbf{X}(t) = \\mathbf{r}(t)$, the drift coefficient is $\\mathbf{a}(\\mathbf{r}) = \\mu\\,\\mathbf{F}(\\mathbf{r})$, and the diffusion coefficient is a constant matrix $\\mathbf{b} = \\sqrt{2D}\\,\\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix.\n\nThe integral form of the SDE over a time interval $[t_n, t_{n+1}]$ is:\n$$\n\\mathbf{r}(t_{n+1}) - \\mathbf{r}(t_n) = \\int_{t_n}^{t_{n+1}} \\mu\\,\\mathbf{F}(\\mathbf{r}(s))\\,\\mathrm{d}s + \\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(s)\n$$\nThe Euler-Maruyama method approximates the solution $\\mathbf{r}(t_{n+1})$, denoted by $\\mathbf{r}_{n+1}$, by approximating the integrals.\n- The deterministic (Riemann) integral is approximated by evaluating the integrand at the start of the interval, $t_n$:\n$$\n\\int_{t_n}^{t_{n+1}} \\mu\\,\\mathbf{F}(\\mathbf{r}(s))\\,\\mathrm{d}s \\approx \\mu\\,\\mathbf{F}(\\mathbf{r}(t_n))\\,(t_{n+1} - t_n) = \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t\n$$\n- The stochastic (Itô) integral has an exact value:\n$$\n\\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(s) = \\sqrt{2D}\\,(\\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)) = \\sqrt{2D}\\,\\Delta \\mathbf{W}_n\n$$\nCombining these approximations gives the EM update rule:\n$$\n\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta \\mathbf{W}_n\n$$\nUsing the given relation $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$, we can rewrite the stochastic term:\n$$\n\\sqrt{2D}\\,\\Delta \\mathbf{W}_n = \\sqrt{2D}\\,\\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n = \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\nThus, the final form of the Euler-Maruyama update rule is:\n$$\n\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\n\n**2. Orders of Convergence**\n\nFor an SDE numerical scheme, there are two primary concepts of convergence:\n- **Strong Convergence**: This measures the error in pathwise approximation. A scheme has a strong order of convergence $p$ if the mean absolute error at a fixed time $T$ is bounded by $C\\,(\\Delta t)^p$, i.e., $E[|\\mathbf{r}(T) - \\mathbf{r}_N|] \\le C\\,(\\Delta t)^p$, where $N = T/\\Delta t$. For the Euler-Maruyama scheme, under standard Lipschitz and linear growth conditions on the drift and diffusion coefficients, the strong order of convergence is $p=1/2$.\n- **Weak Convergence**: This measures the error in approximating expectations of functions of the solution. A scheme has a weak order of convergence $q$ if the error in the expectation is bounded by $C\\,(\\Delta t)^q$, i.e., $|E[g(\\mathbf{r}(T))] - E[g(\\mathbf{r}_N)]| \\le C\\,(\\Delta t)^q$, for a class of sufficiently smooth test functions $g$. For the Euler-Maruyama scheme, under additional smoothness conditions on the coefficients and the test function, the weak order of convergence is $q=1$.\n\nTherefore, the EM scheme for the given SDE has a strong order of $1/2$ and a weak order of $1$.\n\n**Option-by-Option Analysis**\n\n- **A. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.**\n  - The update rule matches our derived expression for the Euler-Maruyama scheme.\n  - The stated strong order ($1/2$) and weak order ($1$) are the correct, standard values for the EM scheme.\n  - **Verdict**: Correct.\n\n- **B. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\boldsymbol{\\eta}_n$; strong order $1$, weak order $1$.**\n  - The update rule is incorrect. The stochastic term $\\sqrt{2D}\\,\\boldsymbol{\\eta}_n$ lacks the factor $\\sqrt{\\Delta t}$. The correct term is $\\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$. This also makes the equation dimensionally inconsistent.\n  - The stated strong order of $1$ is incorrect for the EM scheme.\n  - **Verdict**: Incorrect.\n\n- **C. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_{n+1})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.**\n  - The update rule is incorrect. It represents an *implicit* scheme, as $\\mathbf{r}_{n+1}$ appears on both sides of the equation (in the argument of $\\mathbf{F}$). The standard Euler-Maruyama scheme is an *explicit* (or forward) scheme where the right-hand side depends only on $\\mathbf{r}_n$.\n  - **Verdict**: Incorrect.\n\n- **D. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$; strong order $1/2$, weak order $1$.**\n  - The update rule is incorrect. The stochastic term is $\\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$. The time step should appear as $\\sqrt{\\Delta t}$, not $\\Delta t$. The correct scaling is $\\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$. This term is also dimensionally inconsistent.\n  - **Verdict**: Incorrect.\n\n- **E. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$; strong order $1$, weak order $1$.**\n  - The update rule is correct, as established in the analysis of option A.\n  - However, the stated strong order of $1$ is incorrect. The strong order of the EM scheme is $1/2$.\n  - **Verdict**: Incorrect.\n\nBased on the analysis, only option A provides both the correct form of the Euler-Maruyama update rule and the correct strong and weak orders of convergence.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A numerical simulation is only useful if it is stable. This exercise explores the concept of mean-square stability, a critical consideration when choosing the time step $\\Delta t$ for a Brownian dynamics simulation . By analyzing the simple but important case of a particle in a harmonic potential, you will derive the maximum time step that prevents the simulation from producing unphysical, divergent trajectories, connecting abstract numerical theory to a vital practical constraint.",
            "id": "4080331",
            "problem": "Consider a one-dimensional overdamped Brownian dynamics (BD) model for a colloidal particle in a harmonic potential with stiffness $k$ at temperature $T$. The overdamped Langevin equation is\n$$\n\\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t),\n$$\nwhere $\\gamma$ is the friction coefficient, $k_{B}$ is the Boltzmann constant, and $\\eta(t)$ is Gaussian white noise with zero mean and unit delta correlation. Let $x(t)$ be discretized by the Euler–Maruyama (EM) time-stepping method with step size $\\Delta t$. Using a linear mean-square stability analysis starting from the given stochastic differential equation and the definition of Euler–Maruyama discretization, derive a necessary and sufficient condition on $\\Delta t$ that guarantees the second moment $\\mathbb{E}[x_{n}^{2}]$ of the numerical solution remains bounded as $n \\to \\infty$. Then, for a colloid with friction coefficient $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$ in a trap of stiffness $k = 0.05\\,\\mathrm{N\\,m^{-1}}$, estimate the maximum stable time step $\\Delta t_{\\max}$ for Euler–Maruyama based on this stability condition.\n\nExpress your final numerical answer for $\\Delta t_{\\max}$ in seconds and round your answer to $3$ significant figures.",
            "solution": "The user wants to solve the problem. I need to validate it first.\n\n### Step 1: Extract Givens\n-   **System**: A one-dimensional overdamped Brownian dynamics (BD) model.\n-   **Potential**: Harmonic potential with stiffness $k$, $U(x) = \\frac{1}{2}kx^2$.\n-   **Temperature**: $T$.\n-   **Governing Equation**: The overdamped Langevin equation is given as\n    $$\n    \\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t)\n    $$\n-   **Parameters**:\n    -   $\\gamma$ is the friction coefficient.\n    -   $k_B$ is the Boltzmann constant.\n    -   $\\eta(t)$ is Gaussian white noise with zero mean ($\\langle\\eta(t)\\rangle = 0$) and delta correlation ($\\langle\\eta(t)\\eta(t')\\rangle = \\delta(t-t')$).\n-   **Numerical Method**: Euler–Maruyama (EM) method with time step $\\Delta t$.\n-   **Task 1**: Derive a necessary and sufficient condition on $\\Delta t$ that guarantees the second moment $\\mathbb{E}[x_{n}^{2}]$ of the numerical solution remains bounded as $n \\to \\infty$. This is a linear mean-square stability analysis.\n-   **Task 2**: For a colloid with $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$ and $k = 0.05\\,\\mathrm{N\\,m^{-1}}$, estimate the maximum stable time step $\\Delta t_{\\max}$.\n-   **Rounding**: The final numerical answer for $\\Delta t_{\\max}$ should be rounded to $3$ significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard physical system (a colloidal particle in a harmonic trap) with the appropriate stochastic differential equation (SDE). The task involves a standard numerical stability analysis (mean-square stability for the Euler-Maruyama method), which is a well-defined mathematical procedure. All parameters are clearly defined, and the given numerical values are physically reasonable. There are no contradictions, ambiguities, or violations of scientific principles.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\nThe provided overdamped Langevin equation is:\n$$\n\\gamma \\frac{dx}{dt} = -kx + \\sqrt{2\\gamma k_B T} \\eta(t)\n$$\nwhere $\\eta(t)$ represents Gaussian white noise. This equation can be rewritten in the standard form of an Itô stochastic differential equation (SDE):\n$$\ndx(t) = -\\frac{k}{\\gamma} x(t) dt + \\sqrt{\\frac{2k_B T}{\\gamma}} dW(t)\n$$\nHere, $dW(t) = \\eta(t) dt$ represents the increment of a Wiener process $W(t)$, which has the properties $\\mathbb{E}[dW(t)] = 0$ and $(dW(t))^2 = dt$. For a discrete time step $\\Delta t$, the Wiener increment $\\Delta W_n = W(t_{n+1}) - W(t_n)$ is a Gaussian random variable with mean $\\mathbb{E}[\\Delta W_n] = 0$ and variance $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$.\n\nThe Euler-Maruyama (EM) discretization of this SDE gives a rule for updating the particle's position from time step $n$ to $n+1$:\n$$\nx_{n+1} = x_n + \\left(-\\frac{k}{\\gamma} x_n\\right) \\Delta t + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\nwhere $x_n = x(n\\Delta t)$. Rearranging the terms, we get:\n$$\nx_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\nWe are interested in the stability of the second moment, $\\mathbb{E}[x_n^2]$. Let us compute the expectation of the square of $x_{n+1}$:\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left( \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n \\right)^2 \\right]\n$$\nExpanding the square gives:\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 x_n^2 + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n + \\left(\\frac{2k_B T}{\\gamma}\\right) (\\Delta W_n)^2 \\right]\n$$\nUsing the linearity of the expectation operator:\n$$\n\\mathbb{E}[x_{n+1}^2] = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 \\mathbb{E}[x_n^2] + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) \\sqrt{\\frac{2k_B T}{\\gamma}} \\mathbb{E}[x_n \\Delta W_n] + \\frac{2k_B T}{\\gamma} \\mathbb{E}[(\\Delta W_n)^2]\n$$\nThe state of the system $x_n$ at time $n\\Delta t$ depends on the history of the random force up to that time. The Wiener increment $\\Delta W_n$ is for the interval $[n\\Delta t, (n+1)\\Delta t]$ and is statistically independent of $x_n$. Therefore, the expectation of the cross-term separates:\n$$\n\\mathbb{E}[x_n \\Delta W_n] = \\mathbb{E}[x_n] \\mathbb{E}[\\Delta W_n]\n$$\nSince $\\mathbb{E}[\\Delta W_n] = 0$, the cross-term vanishes: $\\mathbb{E}[x_n \\Delta W_n] = 0$.\nAlso, we have $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$. Substituting these results back, we obtain a recurrence relation for the second moment, which we denote as $y_n = \\mathbb{E}[x_n^2]$:\n$$\ny_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 y_n + \\frac{2k_B T \\Delta t}{\\gamma}\n$$\nThis is a linear recurrence relation of the form $y_{n+1} = A y_n + B$, with the amplification factor $A = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2$ and the constant term $B = \\frac{2k_B T \\Delta t}{\\gamma}$. For the sequence $\\{y_n\\}$ to remain bounded as $n \\to \\infty$ for any initial condition, the magnitude of the amplification factor must be strictly less than $1$:\n$$\n|A|  1\n$$\nSince $A$ is a square, it is always non-negative ($A \\ge 0$), so the condition simplifies to $A  1$:\n$$\n\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2  1\n$$\nTaking the square root of both sides gives:\n$$\n\\left|1 - \\frac{k\\Delta t}{\\gamma}\\right|  1\n$$\nThis absolute value inequality is equivalent to the compound inequality:\n$$\n-1  1 - \\frac{k\\Delta t}{\\gamma}  1\n$$\nWe solve the two inequalities separately.\n$1$. $1 - \\frac{k\\Delta t}{\\gamma}  1 \\implies -\\frac{k\\Delta t}{\\gamma}  0$. Since $k$, $\\gamma$, and $\\Delta t$ are all intrinsically positive physical quantities, this part of the inequality is always satisfied.\n$2$. $-1  1 - \\frac{k\\Delta t}{\\gamma} \\implies \\frac{k\\Delta t}{\\gamma}  2$.\n\nCombining both parts, the necessary and sufficient condition for the second moment to remain bounded is:\n$$\n\\frac{k\\Delta t}{\\gamma}  2\n$$\nThis can be expressed as a condition on the time step $\\Delta t$:\n$$\n\\Delta t  \\frac{2\\gamma}{k}\n$$\nThis is the derived stability condition. The maximum stable time step, $\\Delta t_{\\max}$, is the supremum of this interval:\n$$\n\\Delta t_{\\max} = \\frac{2\\gamma}{k}\n$$\nNow, we substitute the given numerical values: $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$ and $k = 0.05\\,\\mathrm{N\\,m^{-1}}$. The units of $k$ are equivalent to $\\mathrm{kg\\,s^{-2}}$.\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}})}{0.05\\,\\mathrm{kg\\,s^{-2}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.884 \\times 10^{-9}}{0.05}\\,\\mathrm{s} = \\frac{1.884 \\times 10^{-9}}{5 \\times 10^{-2}}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = 0.3768 \\times 10^{-7}\\,\\mathrm{s} = 3.768 \\times 10^{-8}\\,\\mathrm{s}\n$$\nThe problem requires rounding the answer to $3$ significant figures.\n$$\n\\Delta t_{\\max} \\approx 3.77 \\times 10^{-8}\\,\\mathrm{s}\n$$",
            "answer": "$$\\boxed{3.77 \\times 10^{-8}}$$"
        },
        {
            "introduction": "To be predictive, a simulation must be parameterized with values that reflect the real world. This capstone practice guides you through the process of calibrating the diffusion coefficient, a central parameter in the Langevin equation, by combining information from two independent sources: experimental particle tracking data and physical measurements . By implementing a protocol that uses statistical estimation and inverse-variance weighting, you will learn how to produce a robust parameter estimate and quantify its uncertainty, a crucial skill for connecting simulation with experiment.",
            "id": "4080280",
            "problem": "Consider the overdamped motion of mesoscopic particles in a quiescent fluid modeled by the stochastic dynamics known as Brownian dynamics (BD). The BD description is grounded in the Langevin equation where the frictional drag balances random thermal forces and any deterministic forces, and in the overdamped limit the velocity relaxes instantaneously so that observed configurational increments are directly driven by thermal fluctuations. Experimental single-particle tracking provides discrete-time observations of positions in one, two, or three spatial dimensions at uniform sampling intervals. A computational BD simulation must choose a diffusion coefficient so that the simulated mean-squared displacement matches the experimental one, while accounting for uncertainty in both experimental estimators and physical parameters. Your task is to derive, from fundamental laws and definitions relevant to computational complex fluids, a principled estimation and uncertainty-propagation protocol that:\n\n1. Uses the discrete-time increments to construct a statistically optimal estimator of the translational diffusion coefficient compatible with the BD model for free diffusion in $d$ dimensions at sampling interval $\\Delta t$.\n2. Provides a physically grounded independent estimate of the diffusion coefficient from the Einstein relation, using uncertain temperature, viscosity, and particle size measurements, and propagates their uncertainties to the diffusion coefficient.\n3. Combines the two independent sources of information into a single calibrated diffusion coefficient to be used in BD simulations, together with a $95$ percent coverage interval that quantifies the uncertainty in the calibration.\n\nThe derivation must start from first principles and well-tested facts, without assuming the target formulas. The final program must implement your protocol and produce numerical outputs for the specified test suite, with all diffusion-coefficient results expressed in $\\mathrm{m}^2/\\mathrm{s}$. No angles are involved. The program should generate its own random samples for uncertainty propagation with a fixed seed and should not require any input from the user.\n\nAssume the following test suite. Each test case provides the spatial dimension $d$, the number of increments $N$ (equal to the number of time steps), the sampling interval $\\Delta t$ in seconds, and the observed sum of squared increments $S$ in $\\mathrm{m}^2$ over all components and time steps. Additionally, each case specifies the physical parameters for a spherical particle: temperature $T$ in kelvin, dynamic viscosity $\\eta$ in pascal-seconds, and radius $a$ in meters, each with a Gaussian measurement uncertainty characterized by a mean and a standard deviation. The Boltzmann constant is $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}/\\mathrm{K}$. Truncate any Gaussian samples of $T$, $\\eta$, and $a$ at a small positive threshold to ensure physical positivity (e.g., $10^{-12}$ for $\\eta$ and $a$, and $1$ for $T$).\n\nTest cases:\n\n- Case A (general, two-dimensional, long trajectory):\n  - $d = 2$\n  - $N = 1000$\n  - $\\Delta t = 0.01\\ \\mathrm{s}$\n  - $S = 1.65 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ mean $= 298\\ \\mathrm{K}$, $T$ standard deviation $= 1.0\\ \\mathrm{K}$\n  - $\\eta$ mean $= 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$, $\\eta$ standard deviation $= 5.0 \\times 10^{-5}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ mean $= 5.0 \\times 10^{-7}\\ \\mathrm{m}$, $a$ standard deviation $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\n- Case B (three-dimensional, moderate trajectory):\n  - $d = 3$\n  - $N = 300$\n  - $\\Delta t = 0.05\\ \\mathrm{s}$\n  - $S = 8.7 \\times 10^{-12}\\ \\mathrm{m}^2$\n  - $T$ mean $= 310\\ \\mathrm{K}$, $T$ standard deviation $= 2.0\\ \\mathrm{K}$\n  - $\\eta$ mean $= 2.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$, $\\eta$ standard deviation $= 1.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ mean $= 1.2 \\times 10^{-6}\\ \\mathrm{m}$, $a$ standard deviation $= 1.0 \\times 10^{-7}\\ \\mathrm{m}$\n\n- Case C (two-dimensional, short trajectory, high physical-parameter uncertainty):\n  - $d = 2$\n  - $N = 20$\n  - $\\Delta t = 0.1\\ \\mathrm{s}$\n  - $S = 1.4 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ mean $= 295\\ \\mathrm{K}$, $T$ standard deviation $= 3.0\\ \\mathrm{K}$\n  - $\\eta$ mean $= 8.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$, $\\eta$ standard deviation $= 2.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ mean $= 3.0 \\times 10^{-7}\\ \\mathrm{m}$, $a$ standard deviation $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\nImplement the following, based on your derivation:\n\n- From the increment data $(d, N, \\Delta t, S)$, construct an estimator of the diffusion coefficient and an associated uncertainty measure that quantifies the estimator’s variance for finite $N$.\n- From $(T, \\eta, a)$ with their stated uncertainties, generate a Monte Carlo sample of size at least $100{,}000$ of physically plausible triples and compute the corresponding diffusion coefficients using the Einstein relation for spherical particles. Propagate uncertainty by computing the sample mean and standard deviation of the diffusion coefficients.\n- Under the assumption that the two estimates are statistically independent and approximately Gaussian, combine them into a single calibrated diffusion coefficient with a $95$ percent coverage interval expressed as $[\\text{lower}, \\text{upper}]$ in $\\mathrm{m}^2/\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is a list of three floats $[\\widehat{D}_{\\mathrm{BD}}, \\text{lower}, \\text{upper}]$ in $\\mathrm{m}^2/\\mathrm{s$}. For example: [[valueA1,valueA2,valueA3],[valueB1,valueB2,valueB3],[valueC1,valueC2,valueC3]].",
            "solution": "The problem requires the derivation and implementation of a protocol to determine a calibrated diffusion coefficient for Brownian dynamics (BD) simulations. This involves combining an estimate from experimental trajectory data with an independent estimate derived from physical parameters, while properly accounting for and propagating uncertainties. The derivation proceeds in three stages.\n\n### 1. Estimation of the Diffusion Coefficient from Trajectory Data\n\nThe motion of a particle undergoing free Brownian motion in the overdamped limit is described by the Langevin equation. In the absence of external deterministic forces, it simplifies to $\\zeta \\frac{d\\mathbf{r}}{dt} = \\mathbf{F}_{\\text{rand}}(t)$, where $\\mathbf{r}(t)$ is the particle's position vector in $d$ dimensions, $\\zeta$ is the friction coefficient, and $\\mathbf{F}_{\\text{rand}}(t)$ is a Gaussian white noise term representing random thermal forces from the surrounding fluid. The random force has zero mean, $\\langle \\mathbf{F}_{\\text{rand}}(t) \\rangle = \\mathbf{0}$, and its components are uncorrelated in time and space, with a magnitude set by the fluctuation-dissipation theorem: $\\langle F_{\\text{rand},i}(t) F_{\\text{rand},j}(t') \\rangle = 2k_{\\mathrm{B}}T\\zeta \\delta_{ij} \\delta(t-t')$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $\\delta_{ij}$ and $\\delta(t-t')$ are the Kronecker and Dirac deltas, respectively.\n\nA first-order numerical integration (Euler-Maruyama scheme) over a small, discrete time step $\\Delta t$ gives the position increment:\n$$ \\Delta \\mathbf{r}_k = \\mathbf{r}((k+1)\\Delta t) - \\mathbf{r}(k\\Delta t) = \\frac{1}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\mathbf{F}_{\\text{rand}}(t') dt' $$\nFor each spatial component $i \\in \\{1, \\dots, d\\}$, the increment $\\Delta r_{k,i}$ is a Gaussian random variable. Its mean is $\\langle \\Delta r_{k,i} \\rangle = 0$. Its variance is:\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = \\frac{1}{\\zeta^2} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\langle F_{\\text{rand},i}(t') F_{\\text{rand},i}(t'') \\rangle dt' dt'' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} dt' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\Delta t $$\nUsing the definition of the translational diffusion coefficient, $D = k_{\\mathrm{B}}T / \\zeta$, the variance simplifies to:\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = 2D\\Delta t $$\nGiven $N$ independent time steps, we observe $dN$ independent scalar increments, $\\Delta r_{k,i}$, each drawn from a normal distribution $\\mathcal{N}(0, 2D\\Delta t)$. The probability density for a single increment is $p(\\Delta r_{k,i} | D) = (4\\pi D \\Delta t)^{-1/2} \\exp\\left(-\\frac{(\\Delta r_{k,i})^2}{4D\\Delta t}\\right)$. The likelihood function for the entire set of observations is the product of these densities. The log-likelihood, $\\ln L(D)$, is:\n$$ \\ln L(D) = \\sum_{k=1}^N \\sum_{i=1}^d \\ln p(\\Delta r_{k,i} | D) = -\\frac{dN}{2} \\ln(4\\pi D \\Delta t) - \\frac{1}{4D\\Delta t} \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2 $$\nLet $S = \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2$ be the sum of squared increments, which is provided as input.\n$$ \\ln L(D) = -\\frac{dN}{2}\\ln(D) - \\frac{S}{4D\\Delta t} + \\text{const.} $$\nTo find the maximum likelihood estimator (MLE) for $D$, we differentiate with respect to $D$ and set the result to zero:\n$$ \\frac{\\partial \\ln L}{\\partial D} = -\\frac{dN}{2D} + \\frac{S}{4D^2\\Delta t} = 0 \\implies \\widehat{D}_{\\text{BD}} = \\frac{S}{2dN\\Delta t} $$\nThis is our estimator for $D$ from the trajectory data. To find its uncertainty, we compute its variance. The quantity $S/(2D\\Delta t)$ follows a chi-squared distribution with $dN$ degrees of freedom, $S/(2D\\Delta t) \\sim \\chi^2_{dN}$. The mean of a $\\chi^2_{k}$ distribution is $k$ and its variance is $2k$.\nThe expectation of our estimator is $E[\\widehat{D}_{\\text{BD}}] = E\\left[\\frac{S}{2dN\\Delta t}\\right] = \\frac{2D\\Delta t}{2dN\\Delta t} E[\\chi^2_{dN}] = \\frac{D}{dN} (dN) = D$, so the estimator is unbiased.\nThe variance of the estimator is:\n$$ \\text{Var}(\\widehat{D}_{\\text{BD}}) = \\text{Var}\\left(\\frac{S}{2dN\\Delta t}\\right) = \\left(\\frac{2D\\Delta t}{2dN\\Delta t}\\right)^2 \\text{Var}(\\chi^2_{dN}) = \\left(\\frac{D}{dN}\\right)^2 (2dN) = \\frac{2D^2}{dN} $$\nSince the true $D$ is unknown, we approximate the variance by substituting our estimate $\\widehat{D}_{\\text{BD}}$ for $D$. The uncertainty measure for this estimate is thus its standard deviation, which we estimate as:\n$$ \\sigma_{\\text{BD}}^2 = \\text{Var}(\\widehat{D}_{\\text{BD}}) \\approx \\frac{2\\widehat{D}_{\\text{BD}}^2}{dN} $$\n\n### 2. Estimation of the Diffusion Coefficient from Physical Parameters\n\nAn independent estimate of $D$ is obtained from the Einstein relation, which for a spherical particle of radius $a$ in a fluid with dynamic viscosity $\\eta$ at temperature $T$ is:\n$$ D = \\frac{k_{\\mathrm{B}} T}{6\\pi \\eta a} $$\nThe parameters $T$, $\\eta$, and $a$ are given as measurements with Gaussian uncertainties: $T \\sim \\mathcal{N}(\\mu_T, \\sigma_T^2)$, $\\eta \\sim \\mathcal{N}(\\mu_\\eta, \\sigma_\\eta^2)$, and $a \\sim \\mathcal{N}(\\mu_a, \\sigma_a^2)$. To propagate these uncertainties to $D$, we use a Monte Carlo method as specified.\nA large number, $M$, of sample values $(T_j, \\eta_j, a_j)$ are drawn from their respective distributions. To ensure physical validity, any non-positive samples are truncated at a small positive threshold. For each sample triplet, a value of the diffusion coefficient $D_j$ is calculated:\n$$ D_j = \\frac{k_{\\mathrm{B}} T_j}{6\\pi \\eta_j a_j} $$\nThe set $\\{D_j\\}_{j=1}^M$ forms a sample from the probability distribution of $D$ implied by the uncertainties in the physical parameters. The estimate for $D$ from this method, $\\widehat{D}_{\\text{phys}}$, is the sample mean:\n$$ \\widehat{D}_{\\text{phys}} = \\frac{1}{M}\\sum_{j=1}^M D_j $$\nThe associated variance, $\\sigma_{\\text{phys}}^2$, is the sample variance of the $D_j$ values, which quantifies the uncertainty in $D$ due to the input parameter uncertainties:\n$$ \\sigma_{\\text{phys}}^2 = \\frac{1}{M-1}\\sum_{j=1}^M (D_j - \\widehat{D}_{\\text{phys}})^2 $$\n\n### 3. Combination of Independent Estimates\n\nWe now have two independent estimates for $D$: $\\widehat{D}_{\\text{BD}}$ with variance $\\sigma_{\\text{BD}}^2$ and $\\widehat{D}_{\\text{phys}}$ with variance $\\sigma_{\\text{phys}}^2$. Assuming both estimators are approximately Gaussian, the optimal combined estimate that minimizes variance is the inverse-variance weighted average. Let the weights be $w_1 = 1/\\sigma_{\\text{BD}}^2$ and $w_2 = 1/\\sigma_{\\text{phys}}^2$.\nThe calibrated diffusion coefficient, $\\widehat{D}_{\\text{calib}}$, is:\n$$ \\widehat{D}_{\\text{calib}} = \\frac{w_1 \\widehat{D}_{\\text{BD}} + w_2 \\widehat{D}_{\\text{phys}}}{w_1 + w_2} = \\frac{\\widehat{D}_{\\text{BD}}/\\sigma_{\\text{BD}}^2 + \\widehat{D}_{\\text{phys}}/\\sigma_{\\text{phys}}^2}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} $$\nThe variance of this combined estimator, $\\sigma_{\\text{calib}}^2$, is given by:\n$$ \\sigma_{\\text{calib}}^2 = \\frac{1}{w_1 + w_2} = \\frac{1}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} = \\frac{\\sigma_{\\text{BD}}^2 \\sigma_{\\text{phys}}^2}{\\sigma_{\\text{BD}}^2 + \\sigma_{\\text{phys}}^2} $$\nThis combined estimate $\\widehat{D}_{\\text{calib}}$ is the most principled value to use in BD simulations as it incorporates all available information. The uncertainty in this value is quantified by a $95\\%$ coverage interval. Assuming the combined estimator is also Gaussian, the interval is $[\\text{lower}, \\text{upper}]$, where:\n$$ \\text{lower} = \\widehat{D}_{\\text{calib}} - z \\cdot \\sigma_{\\text{calib}} \\quad \\text{and} \\quad \\text{upper} = \\widehat{D}_{\\text{calib}} + z \\cdot \\sigma_{\\text{calib}} $$\nHere, $\\sigma_{\\text{calib}} = \\sqrt{\\sigma_{\\text{calib}}^2}$, and $z$ is the critical value from the standard normal distribution for $95\\%$ coverage, which corresponds to the $0.975$ quantile. This value is $z \\approx 1.95996$.\nThe final output for each test case will be the list $[\\widehat{D}_{\\text{calib}}, \\text{lower}, \\text{upper}]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Derives and implements a protocol to calculate a calibrated diffusion coefficient\n    by combining estimates from Brownian trajectory data and physical parameters.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'d': 2, 'N': 1000, 'dt': 0.01, 'S': 1.65e-11,\n         'T_mean': 298.0, 'T_std': 1.0,\n         'eta_mean': 1.0e-3, 'eta_std': 5.0e-5,\n         'a_mean': 5.0e-7, 'a_std': 5.0e-8},\n        # Case B\n        {'d': 3, 'N': 300, 'dt': 0.05, 'S': 8.7e-12,\n         'T_mean': 310.0, 'T_std': 2.0,\n         'eta_mean': 2.0e-3, 'eta_std': 1.0e-4,\n         'a_mean': 1.2e-6, 'a_std': 1.0e-7},\n        # Case C\n        {'d': 2, 'N': 20, 'dt': 0.1, 'S': 1.4e-11,\n         'T_mean': 295.0, 'T_std': 3.0,\n         'eta_mean': 8.0e-4, 'eta_std': 2.0e-4,\n         'a_mean': 3.0e-7, 'a_std': 5.0e-8},\n    ]\n\n    # Set up Monte Carlo simulation parameters\n    MC_SAMPLES = 200000\n    # Set a fixed seed for reproducibility. The problem requires this.\n    np.random.seed(42)\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        d, N, dt, S = case['d'], case['N'], case['dt'], case['S']\n        T_mean, T_std = case['T_mean'], case['T_std']\n        eta_mean, eta_std = case['eta_mean'], case['eta_std']\n        a_mean, a_std = case['a_mean'], case['a_std']\n\n        # --- Step 1: Estimate D from trajectory data (BD model) ---\n        d_BD = S / (2 * d * N * dt)\n        var_d_BD = (2 * d_BD**2) / (d * N)\n\n        # --- Step 2: Estimate D from physical parameters (Einstein relation) ---\n        # Generate random samples for T, eta, a\n        T_samples = np.random.normal(T_mean, T_std, MC_SAMPLES)\n        eta_samples = np.random.normal(eta_mean, eta_std, MC_SAMPLES)\n        a_samples = np.random.normal(a_mean, a_std, MC_SAMPLES)\n\n        # Truncate samples to ensure positivity\n        T_samples = np.maximum(1.0, T_samples)\n        eta_samples = np.maximum(1.0e-12, eta_samples)\n        a_samples = np.maximum(1.0e-12, a_samples)\n\n        # Calculate D for each sample set\n        D_phys_samples = (K_B * T_samples) / (6 * np.pi * eta_samples * a_samples)\n\n        # Compute mean and variance from the Monte Carlo samples\n        d_phys = np.mean(D_phys_samples)\n        var_d_phys = np.var(D_phys_samples, ddof=1) # Use ddof=1 for sample variance\n\n        # --- Step 3: Combine the two estimates ---\n        # Use inverse-variance weighting\n        w_BD = 1 / var_d_BD\n        w_phys = 1 / var_d_phys\n\n        # Combined (calibrated) estimate for D\n        d_calib = (d_BD * w_BD + d_phys * w_phys) / (w_BD + w_phys)\n        \n        # Variance of the combined estimate\n        var_d_calib = 1 / (w_BD + w_phys)\n        std_d_calib = np.sqrt(var_d_calib)\n\n        # Calculate the 95% coverage interval\n        z_95 = norm.ppf(0.975) # z-score for 95% confidence\n        lower_bound = d_calib - z_95 * std_d_calib\n        upper_bound = d_calib + z_95 * std_d_calib\n\n        results.append([d_calib, lower_bound, upper_bound])\n    \n    # Format the final output string exactly as required\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}