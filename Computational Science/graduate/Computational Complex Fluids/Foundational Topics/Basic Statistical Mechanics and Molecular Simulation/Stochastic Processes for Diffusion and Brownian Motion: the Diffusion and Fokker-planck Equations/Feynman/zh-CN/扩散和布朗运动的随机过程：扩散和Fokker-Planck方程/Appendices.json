{
    "hands_on_practices": [
        {
            "introduction": "宏观的扩散方程源于微观随机事件的集体行为。这个练习将引导你从一个简单的晶格随机行走模型（主方程）出发，推导出扩散方程。然后，它会将这个“自下而上”的模型与由斯托克斯-爱因斯坦关系给出的“自上而下”的唯象描述联系起来，为检验模拟模型与物理现实之间的一致性提供了一个关键方法。",
            "id": "4103925",
            "problem": "一个流体动力学半径为 $R$ 的稀疏球形溶质在牛顿流体溶剂中进行布朗运动，该溶剂位于一个微流控通道内。该通道非常狭窄，以至于在介观尺度上，沿通道轴向的输运可被有效视为一维运动。一个计算格子蒙特卡洛（MC）模型被用来表示溶质的轴向运动，该运动被描述为在一个格距为 $a$、固定时间步长为 $\\tau$ 的格子上进行的对称最近邻跳跃。溶剂处于温度为 $T$ 的热平衡状态，其动力粘度为 $\\eta$。假设雷诺数很低，在扩散时间尺度上惯性可以忽略不计，并且沿通道方向没有外力作用。使用国际单位制（SI）进行计算。\n\n仅使用适用于复杂流体中随机扩散的第一性原理出发点——即对称随机游走的离散时间主方程和包含涨落-耗散的惯性朗之万方程——完成以下任务：\n\n1. 从对称最近邻跳跃过程中格点占据概率的主方程出发，取连续极限得到轴向概率密度 $p(x,t)$ 的Fokker–Planck型扩散方程，并根据格子参数 $a$ 和 $\\tau$ 确定有效扩散系数 $D_{\\mathrm{MC}}$。\n\n2. 从球形布朗粒子的惯性朗之万方程出发，应用涨落-耗散关系和过阻尼极限，得到以玻尔兹曼常数 $k_{B}$、绝对温度 $T$、溶剂粘度 $\\eta$ 和溶质半径 $R$ 表示的Stokes–Einstein目标扩散系数 $D_{\\mathrm{SE}}$。\n\n3. 使用参数值 $a = 1.0 \\times 10^{-8} \\ \\mathrm{m}$、$\\tau = 1.2 \\times 10^{-6} \\ \\mathrm{s}$、$T = 298 \\ \\mathrm{K}$、$\\eta = 1.0 \\times 10^{-3} \\ \\mathrm{Pa} \\cdot \\mathrm{s}$、$R = 5.0 \\times 10^{-9} \\ \\mathrm{m}$ 以及 $k_{B} = 1.380\\,649 \\times 10^{-23} \\ \\mathrm{J} \\cdot \\mathrm{K}^{-1}$，计算这两个扩散系数。\n\n报告定义为比率 $D_{\\mathrm{MC}}/D_{\\mathrm{SE}}$ 的单个无量纲一致性度量。将最终比率表示为一个无量纲数，并四舍五入到四位有效数字。中间结果无需四舍五入，但在计算比率之前，请确保所有量均在国际单位制（SI）下进行计算。",
            "solution": "目标是从第一性原理推导出两个扩散系数的表达式，然后计算它们的比值。我们按照问题所给出的部分，分三步进行。\n\n步骤1：对称格子主方程的连续极限及 $D_{\\mathrm{MC}}$ 的确定。\n\n我们将沿通道的轴向运动建模为一个一维对称最近邻随机游走，其格距为 $a$，离散时间步长为 $\\tau$。设 $p_{i}(t)$ 表示在时间 $t$ 时粒子位于格点 $i$ 的概率。对于一个对称的最近邻过程，其主方程为\n$$\np_{i}(t+\\tau) = \\frac{1}{2} p_{i-1}(t) + \\frac{1}{2} p_{i+1}(t).\n$$\n引入连续概率密度 $p(x,t)$，其中 $x = i a$，并将方程右侧在 $x$ 附近进行泰勒级数展开：\n$$\np(x \\pm a, t) = p(x,t) \\pm a \\frac{\\partial p}{\\partial x}(x,t) + \\frac{a^{2}}{2} \\frac{\\partial^{2} p}{\\partial x^{2}}(x,t) + \\mathcal{O}(a^{3}).\n$$\n类似地，对左侧进行时间上的展开：\n$$\np(x,t+\\tau) = p(x,t) + \\tau \\frac{\\partial p}{\\partial t}(x,t) + \\mathcal{O}(\\tau^{2}).\n$$\n将展开式代入主方程，并保留至 $a$ 的二阶项和 $\\tau$ 的一阶项，可得\n$$\np(x,t) + \\tau \\frac{\\partial p}{\\partial t}(x,t) = \\frac{1}{2} \\left[ p(x-a,t) + p(x+a,t) \\right] = \\frac{1}{2} \\left[ 2 p(x,t) + a^{2} \\frac{\\partial^{2} p}{\\partial x^{2}}(x,t) \\right] + \\mathcal{O}(a^{4}).\n$$\n消去两边的 $p(x,t)$ 并忽略高阶项，得到\n$$\n\\tau \\frac{\\partial p}{\\partial t}(x,t) = \\frac{a^{2}}{2} \\frac{\\partial^{2} p}{\\partial x^{2}}(x,t).\n$$\n两边同除以 $\\tau$，我们得到扩散方程\n$$\n\\frac{\\partial p}{\\partial t}(x,t) = D_{\\mathrm{MC}} \\frac{\\partial^{2} p}{\\partial x^{2}}(x,t),\n$$\n其中有效扩散系数确定为\n$$\nD_{\\mathrm{MC}} = \\frac{a^{2}}{2 \\tau}.\n$$\n\n步骤2：从朗之万方程和涨落-耗散关系推导Stokes–Einstein扩散系数。\n\n考虑一个质量为 $m$ 的球形粒子在牛顿流体中运动的惯性朗之万方程：\n$$\nm \\frac{d v}{d t} = - \\zeta v + \\xi(t),\n$$\n其中 $v$ 是粒子速度，$\\zeta$ 是流体动力学阻力系数，$\\xi(t)$ 是一个零均值高斯随机力，其自相关由涨落-耗散关系指定\n$$\n\\langle \\xi(t) \\xi(t') \\rangle = 2 \\zeta k_{B} T \\, \\delta(t - t').\n$$\n在与液体中布朗运动相关的过阻尼区，速度在 $m / \\zeta$ 的时间尺度上弛豫，对于时间 $t \\gg m / \\zeta$，均方位移随时间线性增长，其扩散系数由爱因斯坦关系给出\n$$\nD_{\\mathrm{SE}} = \\frac{k_{B} T}{\\zeta}.\n$$\n对于一个半径为 $R$ 的球体，在低雷诺数下于粘度为 $\\eta$ 的牛顿流体中运动，其斯托克斯阻力为\n$$\n\\zeta = 6 \\pi \\eta R.\n$$\n因此，\n$$\nD_{\\mathrm{SE}} = \\frac{k_{B} T}{6 \\pi \\eta R}.\n$$\n\n步骤3：数值计算及比值 $D_{\\mathrm{MC}} / D_{\\mathrm{SE}}$。\n\n现在我们代入给定的参数值，并在整个计算过程中使用国际单位制（SI）。\n\n计算蒙特卡洛扩散系数：\n$$\nD_{\\mathrm{MC}} = \\frac{a^{2}}{2 \\tau} = \\frac{\\left(1.0 \\times 10^{-8} \\ \\mathrm{m}\\right)^{2}}{2 \\left(1.2 \\times 10^{-6} \\ \\mathrm{s}\\right)} = \\frac{1.0 \\times 10^{-16} \\ \\mathrm{m}^{2}}{2.4 \\times 10^{-6} \\ \\mathrm{s}} = 4.166666\\ldots \\times 10^{-11} \\ \\mathrm{m}^{2} \\cdot \\mathrm{s}^{-1}.\n$$\n\n计算Stokes–Einstein扩散系数：\n$$\nD_{\\mathrm{SE}} = \\frac{k_{B} T}{6 \\pi \\eta R} = \\frac{\\left(1.380\\,649 \\times 10^{-23} \\ \\mathrm{J} \\cdot \\mathrm{K}^{-1}\\right)\\left(298 \\ \\mathrm{K}\\right)}{6 \\pi \\left(1.0 \\times 10^{-3} \\ \\mathrm{Pa} \\cdot \\mathrm{s}\\right)\\left(5.0 \\times 10^{-9} \\ \\mathrm{m}\\right)}.\n$$\n计算分子：\n$$\nk_{B} T = 1.380\\,649 \\times 10^{-23} \\times 298 \\ \\mathrm{J} = 4.11433402 \\times 10^{-21} \\ \\mathrm{J}.\n$$\n计算分母：\n$$\n6 \\pi \\eta R = 6 \\pi \\times 1.0 \\times 10^{-3} \\ \\mathrm{Pa} \\cdot \\mathrm{s} \\times 5.0 \\times 10^{-9} \\ \\mathrm{m} = 9.42477796 \\times 10^{-11} \\ \\mathrm{Pa} \\cdot \\mathrm{s} \\cdot \\mathrm{m}.\n$$\n由于 $1 \\ \\mathrm{J} = 1 \\ \\mathrm{kg} \\cdot \\mathrm{m}^{2} \\cdot \\mathrm{s}^{-2}$ 且 $1 \\ \\mathrm{Pa} \\cdot \\mathrm{s} \\cdot \\mathrm{m} = 1 \\ \\mathrm{kg} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{s}^{-1}$，该比值的单位为 $\\mathrm{m}^{2} \\cdot \\mathrm{s}^{-1}$，与预期相符。数值上，\n$$\nD_{\\mathrm{SE}} = \\frac{4.11433402 \\times 10^{-21}}{9.42477796 \\times 10^{-11}} \\ \\mathrm{m}^{2} \\cdot \\mathrm{s}^{-1} \\approx 4.36544476 \\times 10^{-11} \\ \\mathrm{m}^{2} \\cdot \\mathrm{s}^{-1}.\n$$\n\n得到无量纲的一致性比率：\n$$\n\\frac{D_{\\mathrm{MC}}}{D_{\\mathrm{SE}}} = \\frac{4.16666667 \\times 10^{-11}}{4.36544476 \\times 10^{-11}} \\approx 0.95446\\ldots.\n$$\n四舍五入到四位有效数字，该比值为\n$$\n0.9545.\n$$\n\n这个接近1的值表明，对于所选的物理参数，格子MC模型的参数化与连续介质的Stokes–Einstein预测是一致的。",
            "answer": "$$\\boxed{0.9545}$$"
        },
        {
            "introduction": "在建立了基本的扩散方程之后，我们转向一个更普适的、包含漂移项的福克-普朗克方程，它可以模拟粒子在势场中的运动。这个练习将介绍一种强大的解析技术：通过寻找方程的本征函数（埃尔米特多项式）和本征值来求解。这种谱分解方法是分析线性随机系统及其如何弛豫到平衡态的基石。",
            "id": "4103912",
            "problem": "嵌入在粘弹性复杂流体中的单个布朗探针可以被粗粒化为一个在由微观结构弹性产生的等效谐波环境中的粒子。在平衡态附近，沿笛卡尔坐标 $x$ 的过阻尼动力学由具有线性漂移和恒定扩散率的福克-普朗克方程 (FPE) 建模，\n$$\n\\frac{\\partial}{\\partial t} P(x,t) \\;=\\; \\gamma\\,\\frac{\\partial}{\\partial x}\\!\\left(x\\,P(x,t)\\right) \\;+\\; D\\,\\frac{\\partial^{2}}{\\partial x^{2}} P(x,t),\n$$\n其中 $P(x,t)$ 是概率密度，$D>0$ 是扩散系数，$\\gamma>0$ 设定了由等效谐波环境产生的线性弛豫率。假设系统存在一个唯一的稳态分布 $P_{\\mathrm{eq}}(x)$，该分布是可归一化的，并且是关于 $x$ 的偶函数。在时间 $t=0$ 时，探针被制备成一个高斯分布，其方差与 $P_{\\mathrm{eq}}(x)$ 相同，但均值 $x_{0}$ 非零，从而偏离平衡态：\n$$\nP(x,0) \\;=\\; \\frac{1}{\\sqrt{2\\pi\\,\\sigma^{2}}}\\,\\exp\\!\\left(-\\frac{\\left(x-x_{0}\\right)^{2}}{2\\,\\sigma^{2}}\\right),\n$$\n其中 $\\sigma>0$ 是稳态标准差，将从 FPE 和 $P_{\\mathrm{eq}}(x)$ 的归一化条件中确定。\n\n从给定的 FPE 出发，基于第一性原理，完成以下任务：\n- 确定稳态分布 $P_{\\mathrm{eq}}(x)$ 和稳态方差参数 $\\sigma^{2}$。\n- 引入无量纲坐标 $y=x/\\sigma$ 和比率场 $g(y,t)=P(x,t)/P_{\\mathrm{eq}}(x)$。证明 $g(y,t)$ 的时间演化由一个线性算符控制，该算符以概率论中的埃尔米特多项式 $H_{n}(y)$ 为本征函数，其定义如下：\n$$\nH_{n}(y)\\;=\\;(-1)^{n}\\,\\exp\\!\\left(\\frac{y^{2}}{2}\\right)\\,\\frac{d^{n}}{dy^{n}}\\,\\exp\\!\\left(-\\frac{y^{2}}{2}\\right),\n$$\n- 计算初始条件 $g(y,0)$ 的埃尔米特展开系数，并通过谱分解重构 $t>0$ 时的 $g(y,t)$。\n- 从 $g(y,t)$ 出发，重构 $t>0$ 时的 $P(x,t)$，以 $D$、$\\gamma$、$x$、$x_{0}$ 和 $t$ 的形式给出一个单一的闭式解析表达式。\n\n你的最终答案必须是你得到的 $P(x,t)$ 的闭式表达式。无需四舍五入。以无单位的解析形式表示最终答案。",
            "solution": "求解过程按照问题陈述的指示分四个阶段进行。\n\n**1. 稳态分布与方差**\n\n稳态分布 $P_{\\mathrm{eq}}(x)$ 是 FPE 的不随时间变化的解，通过令 $\\frac{\\partial P}{\\partial t} = 0$ 求得。FPE 变为一个常微分方程：\n$$\n0 \\;=\\; \\gamma\\,\\frac{d}{dx}\\!\\left(x\\,P_{\\mathrm{eq}}(x)\\right) \\;+\\; D\\,\\frac{d^{2}}{dx^{2}} P_{\\mathrm{eq}}(x)\n$$\n该方程表示总概率流 $J(x) = -\\gamma x P_{\\mathrm{eq}}(x) - D \\frac{d}{dx}P_{\\mathrm{eq}}(x)$ 是一个常数。对于一个可归一化的分布，当 $x \\to \\pm\\infty$ 时，$P_{\\mathrm{eq}}(x)$ 及其导数均趋于零，因此该常数必须为零。所以，我们求解：\n$$\nD\\,\\frac{dP_{\\mathrm{eq}}}{dx} \\;=\\; -\\gamma\\,x\\,P_{\\mathrm{eq}}(x)\n$$\n这是一个一阶线性可分离微分方程：\n$$\n\\frac{dP_{\\mathrm{eq}}}{P_{\\mathrm{eq}}} \\;=\\; -\\frac{\\gamma}{D}\\,x\\,dx\n$$\n对两边积分得到：\n$$\n\\ln(P_{\\mathrm{eq}}(x)) \\;=\\; -\\frac{\\gamma}{2D}\\,x^{2} \\;+\\; C'\n$$\n其中 $C'$ 是积分常数。取指数得到未归一化的解：\n$$\nP_{\\mathrm{eq}}(x) \\;=\\; A\\,\\exp\\!\\left(-\\frac{\\gamma\\,x^{2}}{2D}\\right)\n$$\n其中 $A = \\exp(C')$ 是归一化常数。问题陈述指出稳态分布是一个高斯分布，其通用形式为 $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp(-\\frac{x^2}{2\\sigma^2})$。通过将我们解的指数与此标准形式进行比较，我们确定稳态方差 $\\sigma^2$：\n$$\n\\frac{1}{2\\sigma^2} \\;=\\; \\frac{\\gamma}{2D} \\quad\\implies\\quad \\sigma^2 \\;=\\; \\frac{D}{\\gamma}\n$$\n归一化常数 $A$ 由条件 $\\int_{-\\infty}^{\\infty} P_{\\mathrm{eq}}(x)\\,dx = 1$ 确定。使用标准高斯积分 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$，其中 $a = \\frac{\\gamma}{2D}$：\n$$\nA \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{\\gamma\\,x^{2}}{2D}\\right)\\,dx \\;=\\; A\\,\\sqrt{\\frac{2\\pi D}{\\gamma}} \\;=\\; 1 \\quad\\implies\\quad A \\;=\\; \\sqrt{\\frac{\\gamma}{2\\pi D}} \\;=\\; \\frac{1}{\\sqrt{2\\pi \\sigma^2}}\n$$\n因此，稳态分布为：\n$$\nP_{\\mathrm{eq}}(x) \\;=\\; \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\,\\sigma^{2}}\\right), \\quad \\text{其中} \\quad \\sigma^2 = \\frac{D}{\\gamma}\n$$\n\n**2. 变换后关于 $g(y,t)$ 的方程**\n\n我们定义无量纲坐标 $y = x/\\sigma$ 和比率场 $g(y,t) = P(x,t)/P_{\\mathrm{eq}}(x)$。现在我们将 FPE 从坐标 $(x,t)$ 变换到 $(y,t)$，并从场 $P$ 变换到场 $g$。根据链式法则，导数的变换关系为：$\\frac{\\partial}{\\partial x} = \\frac{1}{\\sigma}\\frac{\\partial}{\\partial y}$ 和 $\\frac{\\partial^2}{\\partial x^2} = \\frac{1}{\\sigma^2}\\frac{\\partial^2}{\\partial y^2}$。\n\nFPE 为 $\\frac{\\partial P}{\\partial t} = \\gamma\\frac{\\partial}{\\partial x}(xP) + D\\frac{\\partial^2}{\\partial x^2}P$。\n代入 $P(x,t) = g(y,t)P_{\\mathrm{eq}}(x)$：\n$$\n\\frac{\\partial}{\\partial t} (g P_{\\mathrm{eq}}) \\;=\\; P_{\\mathrm{eq}}\\frac{\\partial g}{\\partial t} \\;=\\; \\gamma\\frac{\\partial}{\\partial x}(x g P_{\\mathrm{eq}}) + D\\frac{\\partial^2}{\\partial x^2}(g P_{\\mathrm{eq}})\n$$\n我们来分析等号右边的项。\n$\\frac{\\partial}{\\partial x}(x g P_{\\mathrm{eq}}) = g P_{\\mathrm{eq}} + x \\frac{\\partial g}{\\partial x} P_{\\mathrm{eq}} + x g \\frac{\\partial P_{\\mathrm{eq}}}{\\partial x}$。由于 $\\frac{\\partial P_{\\mathrm{eq}}}{\\partial x} = -\\frac{x}{\\sigma^2}P_{\\mathrm{eq}}$，该项变为 $(g + x\\frac{\\partial g}{\\partial x} - \\frac{x^2}{\\sigma^2}g)P_{\\mathrm{eq}}$。\n$\\frac{\\partial^2}{\\partial x^2}(g P_{\\mathrm{eq}}) = \\frac{\\partial}{\\partial x}(\\frac{\\partial g}{\\partial x} P_{\\mathrm{eq}} + g \\frac{\\partial P_{\\mathrm{eq}}}{\\partial x}) = \\frac{\\partial}{\\partial x}[(\\frac{\\partial g}{\\partial x} - \\frac{x}{\\sigma^2}g)P_{\\mathrm{eq}}] = (\\frac{\\partial^2 g}{\\partial x^2} - \\frac{1}{\\sigma^2}g - \\frac{x}{\\sigma^2}\\frac{\\partial g}{\\partial x})P_{\\mathrm{eq}} + (\\frac{\\partial g}{\\partial x} - \\frac{x}{\\sigma^2}g)(-\\frac{x}{\\sigma^2}P_{\\mathrm{eq}}) = (\\frac{\\partial^2 g}{\\partial x^2} - \\frac{2x}{\\sigma^2}\\frac{\\partial g}{\\partial x} + (\\frac{x^2}{\\sigma^4}-\\frac{1}{\\sigma^2})g)P_{\\mathrm{eq}}$。\n\n将整个方程除以 $P_{\\mathrm{eq}}$：\n$$\n\\frac{\\partial g}{\\partial t} = \\gamma\\left(g + x\\frac{\\partial g}{\\partial x} - \\frac{x^2}{\\sigma^2}g\\right) + D\\left(\\frac{\\partial^2 g}{\\partial x^2} - \\frac{2x}{\\sigma^2}\\frac{\\partial g}{\\partial x} + \\left(\\frac{x^2}{\\sigma^4}-\\frac{1}{\\sigma^2}\\right)g\\right)\n$$\n按 $g$ 的导数合并同类项：\n$$\n\\frac{\\partial g}{\\partial t} = D\\frac{\\partial^2 g}{\\partial x^2} + (\\gamma x - \\frac{2Dx}{\\sigma^2})\\frac{\\partial g}{\\partial x} + (\\gamma - \\frac{\\gamma x^2}{\\sigma^2} + \\frac{Dx^2}{\\sigma^4} - \\frac{D}{\\sigma^2})g\n$$\n代入 $D = \\gamma\\sigma^2$：\n$$\n\\frac{\\partial g}{\\partial t} = \\gamma\\sigma^2\\frac{\\partial^2 g}{\\partial x^2} + (\\gamma x - \\frac{2\\gamma\\sigma^2 x}{\\sigma^2})\\frac{\\partial g}{\\partial x} + (\\gamma - \\frac{\\gamma x^2}{\\sigma^2} + \\frac{\\gamma\\sigma^2 x^2}{\\sigma^4} - \\frac{\\gamma\\sigma^2}{\\sigma^2})g\n$$\n$$\n\\frac{\\partial g}{\\partial t} = \\gamma\\sigma^2\\frac{\\partial^2 g}{\\partial x^2} - \\gamma x\\frac{\\partial g}{\\partial x} + (\\gamma - \\frac{\\gamma x^2}{\\sigma^2} + \\frac{\\gamma x^2}{\\sigma^2} - \\gamma)g = \\gamma\\sigma^2\\frac{\\partial^2 g}{\\partial x^2} - \\gamma x\\frac{\\partial g}{\\partial x}\n$$\n现在，变换变量为 $y = x/\\sigma$：\n$$\n\\frac{\\partial g}{\\partial t} = \\gamma\\sigma^2\\left(\\frac{1}{\\sigma^2}\\frac{\\partial^2 g}{\\partial y^2}\\right) - \\gamma(y\\sigma)\\left(\\frac{1}{\\sigma}\\frac{\\partial g}{\\partial y}\\right) = \\gamma\\left(\\frac{\\partial^2 g}{\\partial y^2} - y\\frac{\\partial g}{\\partial y}\\right)\n$$\n该方程具有形式 $\\frac{\\partial g}{\\partial t} = \\mathcal{L}_g g$，其中 $\\mathcal{L}_g = \\gamma(\\frac{\\partial^2}{\\partial y^2} - y\\frac{\\partial}{\\partial y})$。概率论中的埃尔米特多项式 $H_n(y)$ 满足微分方程 $H_n''(y) - y H_n'(y) + n H_n(y) = 0$。因此，算符 $\\frac{\\partial^2}{\\partial y^2} - y\\frac{\\partial}{\\partial y}$ 作用于 $H_n(y)$ 的结果是：\n$$\n\\left(\\frac{\\partial^2}{\\partial y^2} - y\\frac{\\partial}{\\partial y}\\right)H_n(y) = -n H_n(y)\n$$\n因此，$H_n(y)$ 是算符 $\\mathcal{L}_g$ 的本征函数，其本征值为 $\\lambda_n = -n\\gamma$。\n$$\n\\mathcal{L}_g H_n(y) = -n\\gamma H_n(y)\n$$\n\n**3. 埃尔米特展开与谱解**\n\n我们将 $g(y,t)$ 在本征函数基 $H_n(y)$ 上展开：$g(y,t) = \\sum_{n=0}^\\infty c_n(t) H_n(y)$。\n初始条件 $g(y,0)$ 由 $P(x,0)$ 和 $P_{\\mathrm{eq}}(x)$ 求得：\n$$\ng(x,0) = \\frac{P(x,0)}{P_{\\mathrm{eq}}(x)} = \\frac{\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp(-\\frac{(x-x_0)^2}{2\\sigma^2})}{\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp(-\\frac{x^2}{2\\sigma^2})} = \\exp\\left(\\frac{-x^2+2xx_0-x_0^2+x^2}{2\\sigma^2}\\right) = \\exp\\left(\\frac{xx_0}{\\sigma^2} - \\frac{x_0^2}{2\\sigma^2}\\right)\n$$\n用 $y=x/\\sigma$ 和无量纲初始位移 $y_0 = x_0/\\sigma$ 表示：\n$$\ng(y,0) = \\exp\\left(y y_0 - \\frac{y_0^2}{2}\\right)\n$$\n这正是概率论中埃尔米特多项式的生成函数：$\\exp(sy-s^2/2) = \\sum_{n=0}^{\\infty} \\frac{s^n}{n!}H_n(y)$。通过令 $s = y_0$，我们可以直接读出 $g(y,0)$ 的展开系数：\n$$\ng(y,0) = \\sum_{n=0}^{\\infty} \\frac{y_0^n}{n!}H_n(y) \\quad\\implies\\quad c_n(0) = \\frac{y_0^n}{n!}\n$$\n将 $g(y,t)$ 的级数展开式代入其演化方程得到：\n$$\n\\sum_{n=0}^\\infty \\frac{dc_n}{dt} H_n(y) = \\sum_{n=0}^\\infty c_n(t) \\mathcal{L}_g H_n(y) = \\sum_{n=0}^\\infty c_n(t) (-n\\gamma) H_n(y)\n$$\n根据正交性，系数必须满足 $\\frac{dc_n}{dt} = -n\\gamma c_n(t)$。解为 $c_n(t) = c_n(0)e^{-n\\gamma t}$。\n$$\nc_n(t) = \\frac{y_0^n}{n!} e^{-n\\gamma t} = \\frac{(y_0 e^{-\\gamma t})^n}{n!}\n$$\n我们通过对含时系数求和来重构 $g(y,t)$：\n$$\ng(y,t) = \\sum_{n=0}^{\\infty} \\frac{(y_0 e^{-\\gamma t})^n}{n!} H_n(y)\n$$\n再次利用生成函数的形式，设 $s(t) = y_0 e^{-\\gamma t}$，我们得到闭式表达式：\n$$\ng(y,t) = \\exp\\left(y (y_0 e^{-\\gamma t}) - \\frac{1}{2}(y_0 e^{-\\gamma t})^2\\right)\n$$\n\n**4. $P(x,t)$ 的重构**\n\n最后，我们重构完整的概率密度 $P(x,t) = g(y,t) P_{\\mathrm{eq}}(x)$。\n$$\nP(x,t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{y^2}{2}\\right) \\exp\\left(y y_0 e^{-\\gamma t} - \\frac{1}{2}y_0^2 e^{-2\\gamma t}\\right)\n$$\n合并指数部分：\n$$\n\\text{指数} = -\\frac{y^2}{2} + y y_0 e^{-\\gamma t} - \\frac{1}{2}y_0^2 e^{-2\\gamma t} = -\\frac{1}{2}\\left( y^2 - 2y(y_0 e^{-\\gamma t}) + (y_0 e^{-\\gamma t})^2 \\right)\n$$\n这是一个完全平方：\n$$\n\\text{指数} = -\\frac{1}{2}\\left( y - y_0 e^{-\\gamma t} \\right)^2\n$$\n将此代回 $P(x,t)$ 的表达式中：\n$$\nP(x,t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(y - y_0 e^{-\\gamma t})^2}{2}\\right)\n$$\n现在，我们换回原始变量 $x$、$x_0$、$D$ 和 $\\gamma$。使用 $y=x/\\sigma$、$y_0 = x_0/\\sigma$ 和 $\\sigma^2=D/\\gamma$：\n$$\ny - y_0 e^{-\\gamma t} = \\frac{x}{\\sigma} - \\frac{x_0}{\\sigma}e^{-\\gamma t} = \\frac{1}{\\sigma}(x - x_0 e^{-\\gamma t})\n$$\n指数的宗量变为：\n$$\n-\\frac{1}{2\\sigma^2} (x - x_0 e^{-\\gamma t})^2 = -\\frac{(x - x_0 e^{-\\gamma t})^2}{2(D/\\gamma)} = -\\frac{\\gamma}{2D}(x - x_0 e^{-\\gamma t})^2\n$$\n因此，完整的概率密度为：\n$$\nP(x,t) = \\frac{1}{\\sqrt{2\\pi(D/\\gamma)}} \\exp\\left(-\\frac{(x - x_0 \\exp(-\\gamma t))^2}{2(D/\\gamma)}\\right)\n$$\n这代表一个高斯分布，其均值 $\\mu(t) = x_0 \\exp(-\\gamma t)$ 随时间变化，而方差 $\\sigma^2 = D/\\gamma$ 保持不变。根据初始条件，均值位置指数衰减到平衡位置 $x=0$，而方差保持其稳态值不变。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2\\pi \\frac{D}{\\gamma}}} \\exp\\left( - \\frac{\\left(x - x_{0} \\exp(-\\gamma t)\\right)^{2}}{2 \\frac{D}{\\gamma}} \\right)}\n$$"
        },
        {
            "introduction": "现实世界中的扩散过程常常发生在有限的空间内。这个练习旨在解决如何将物理边界条件整合到我们的模型中。你将使用巧妙的“镜像法”来构建一个粒子在反射壁附近扩散的解（即格林函数），并使其满足零通量边界条件。这个练习展示了一种解决扩散问题中边值问题的实用且直观的技巧。",
            "id": "4103934",
            "problem": "考虑一个在静止的复杂流体中的布朗示踪粒子，其运动可被有效地视为沿着坐标轴 $x \\geq 0$ 的一维运动，并在 $x=0$ 处存在一个完全反射的平面边界。该示踪粒子位置的概率密度 $p(x,t)$ 由扩散方程决定，即无漂移项的福克-普朗克方程（FPE），具体为 $\\partial_{t} p(x,t) = D \\,\\partial_{x}^{2} p(x,t)$，其中 $x > 0$ 且 $t > 0$，而 $D$ 是常数扩散系数。反射边界条件要求在 $x=0$ 处的法向概率通量为零，这等效于诺伊曼条件（Neumann condition） $\\partial_{x} p(0,t) = 0$ 对所有 $t > 0$ 成立。令 $G(x,t \\mid x_{0})$ 表示在半直线 $x \\geq 0$ 上带有反射边界的格林函数（Green’s function，或基本解），它满足在 $x > 0, t > 0$ 时的扩散方程、在 $x=0$ 处的诺伊曼边界条件，以及对于位于 $x_{0} > 0$ 的源的初始条件 $G(x,0^{+} \\mid x_{0}) = \\delta(x - x_{0})$。请仅使用扩散的基本原理和镜像法（method of images）构建 $G(x,t \\mid x_{0})$，并明确验证诺伊曼边界条件 $\\partial_{x} G(0,t \\mid x_{0}) = 0$ 对所有 $t>0$ 都成立。请以包含 $x$、$x_{0}$、$t$ 和 $D$ 的单一闭合形式解析表达式给出最终的格林函数。",
            "solution": "镜像法通过扩展定义域并引入虚构的“镜像”源，使得通过叠加可以满足所需的边界条件，从而解决边值问题。\n\n首先，我们回顾在一维无限域（$-\\infty  x  \\infty$）上，对于初始条件 $G(x,0 \\mid x_0) = \\delta(x-x_0)$ 的扩散方程 $\\partial_{t} G = D \\partial_{x}^{2} G$ 的基本解（或格林函数）。该解是一个随时间扩展的高斯分布：\n$$\nG_{\\infty}(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right)\n$$\n该解表示在 $t=0$ 时刻从 $x_0$ 出发的粒子，在 $t$ 时刻于位置 $x$ 被找到的概率密度。\n\n我们的问题是在半直线 $x \\geq 0$ 上，并在 $x=0$ 处有一个反射边界。反射边界条件是诺伊曼条件 $\\partial_{x} G(0,t \\mid x_{0}) = 0$，表示穿过边界的概率通量为零。为了构建半直线上的解 $G(x,t \\mid x_{0})$，我们使用叠加原理。我们将原始源置于 $x_0  0$，并在非物理区域 $x0$ 的 $-x_0$ 位置放置一个“镜像”源。对于诺伊曼（零斜率）条件，镜像源必须与原始源具有相同的符号。这是因为两个关于 $x=0$ 对称的相同高斯分布的叠加将在 $x=0$ 处具有水平切线。\n\n因此，半直线上的格林函数被提议为位于 $x_0$ 的源的基本解与位于 $-x_0$ 的镜像源的基本解之和：\n$$\nG(x,t \\mid x_{0}) = G_{\\infty}(x,t \\mid x_{0}) + G_{\\infty}(x,t \\mid -x_{0})\n$$\n代入 $G_{\\infty}$ 的显式形式：\n$$\nG(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) + \\frac{1}{\\sqrt{4 \\pi D t}} \\exp\\left( -\\frac{(x - (-x_{0}))^{2}}{4Dt} \\right)\n$$\n化简后得到：\n$$\nG(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) + \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right) \\right]\n$$\n这是我们候选的格林函数，对 $x \\geq 0$ 有效。根据构造，它满足扩散方程（作为两个解的和）和初始条件（当 $t \\to 0^{+}$ 时，第一项变为 $\\delta(x-x_0)$，第二项变为 $\\delta(x+x_0)$，后者在定义域 $x \\ge 0$ 之外）。\n\n最后的要求是明确验证该解满足诺伊曼边界条件 $\\partial_{x} G(0,t \\mid x_{0}) = 0$。我们计算 $G(x,t \\mid x_{0})$ 的空间导数：\n$$\n\\partial_{x} G(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\frac{\\partial}{\\partial x} \\left[ \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) + \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right) \\right]\n$$\n使用链式法则，我们得到：\n$$\n\\frac{\\partial}{\\partial x} \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) = \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) \\cdot \\left( -\\frac{2(x - x_{0})}{4Dt} \\right) = -\\frac{x - x_{0}}{2Dt} \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right)\n$$\n对第二项进行类似计算：\n$$\n\\frac{\\partial}{\\partial x} \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right) = \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right) \\cdot \\left( -\\frac{2(x + x_{0})}{4Dt} \\right) = -\\frac{x + x_{0}}{2Dt} \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right)\n$$\n合并这些结果：\n$$\n\\partial_{x} G(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\left[ -\\frac{x-x_0}{2Dt} \\exp\\left( -\\frac{(x - x_{0})^{2}}{4Dt} \\right) - \\frac{x+x_0}{2Dt} \\exp\\left( -\\frac{(x + x_{0})^{2}}{4Dt} \\right) \\right]\n$$\n现在，我们在边界 $x=0$ 处对任意时间 $t0$ 计算此表达式的值：\n$$\n\\partial_{x} G(0,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\left[ -\\frac{-x_0}{2Dt} \\exp\\left( -\\frac{(-x_{0})^{2}}{4Dt} \\right) - \\frac{x_0}{2Dt} \\exp\\left( -\\frac{(x_{0})^{2}}{4Dt} \\right) \\right]\n$$\n$$\n\\partial_{x} G(0,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\left[ \\frac{x_0}{2Dt} \\exp\\left( -\\frac{x_{0}^{2}}{4Dt} \\right) - \\frac{x_0}{2Dt} \\exp\\left( -\\frac{x_{0}^{2}}{4Dt} \\right) \\right]\n$$\n$$\n\\partial_{x} G(0,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} [0] = 0\n$$\n验证成功。诺伊曼边界条件对所有 $t  0$ 均成立。所构建的格林函数是正确的。\n\n格林函数的最终闭合形式解析表达式为：\n$$\nG(x,t \\mid x_{0}) = \\frac{1}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x - x_{0})^{2}}{4Dt}\\right) + \\exp\\left(-\\frac{(x + x_{0})^{2}}{4Dt}\\right) \\right]\n$$",
            "answer": "$$\n\\boxed{\n\\frac{1}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x - x_{0})^{2}}{4Dt}\\right) + \\exp\\left(-\\frac{(x + x_{0})^{2}}{4Dt}\\right) \\right]\n}\n$$"
        }
    ]
}