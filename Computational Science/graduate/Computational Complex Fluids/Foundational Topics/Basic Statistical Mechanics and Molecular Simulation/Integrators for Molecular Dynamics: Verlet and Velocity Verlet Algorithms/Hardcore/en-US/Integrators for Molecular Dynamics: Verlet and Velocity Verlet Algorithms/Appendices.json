{
    "hands_on_practices": [
        {
            "introduction": "Before deploying a numerical integrator in a simulation, we must understand its fundamental properties, especially its stability. This first practice uses the harmonic oscillator—a cornerstone model for vibrations in molecules and materials—to rigorously analyze the position Verlet algorithm. By deriving the discrete update map and analyzing its eigenvalues, you will determine the maximum stable time step, a critical skill for setting up any reliable molecular dynamics simulation.",
            "id": "4090835",
            "problem": "In the context of Molecular Dynamics (MD) simulations of linearized modes in computational complex fluids, consider a single normal mode modeled as a one-dimensional harmonic oscillator governed by Newton’s second law, with equation of motion given by $\\ddot{x}(t)=-\\omega^{2}x(t)$, where $\\omega0$ is the mode frequency. You discretize time as $t_{n}=n\\,\\Delta t$, with constant time step $\\Delta t0$, and you use the position Verlet algorithm to integrate the dynamics.\n\nStarting only from the differential equation $\\ddot{x}(t)=-\\omega^{2}x(t)$ and standard central-difference consistent approximations, do the following:\n\n1. Derive the explicit two-step recurrence for $x_{n+1}$ in terms of $x_{n}$ and $x_{n-1}$ that is consistent with the position Verlet algorithm.\n2. Introduce the state vector $\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}$ and derive the $2\\times 2$ amplification matrix $\\mathbf{A}$ such that $\\mathbf{y}_{n+1}=\\mathbf{A}\\,\\mathbf{y}_{n}$, expressing $\\mathbf{A}$ solely in terms of the nondimensional parameter $q=\\Delta t\\,\\omega$.\n3. Using first principles of linear stability for linear constant-coefficient recurrences, determine the condition on $q$ under which the position Verlet method is linearly stable for this harmonic oscillator. Then, extract the single maximal nondimensional step size $q_{\\max}$ such that stability holds for all $0\\leq q\\leq q_{\\max}$.\n\nProvide as your final answer only the single number $q_{\\max}$, without units. No rounding is required; provide the exact value.",
            "solution": "We begin from Newton’s second law for a one-dimensional harmonic oscillator,\n$$\n\\ddot{x}(t)=-\\omega^{2}x(t),\n$$\nwith $\\omega0$ and constant time step $\\Delta t0$. The position Verlet algorithm can be obtained by using the central difference for the second derivative, which is a standard, symmetric, second-order accurate approximation. Specifically, expand $x(t)$ in a Taylor series about $t_{n}$:\n$$\nx(t_{n}\\pm \\Delta t)=x_{n}\\pm \\Delta t\\,\\dot{x}_{n}+\\frac{\\Delta t^{2}}{2}\\,\\ddot{x}_{n}\\pm \\frac{\\Delta t^{3}}{6}\\,\\dddot{x}_{n}+\\frac{\\Delta t^{4}}{24}\\,x^{(4)}_{n}+\\cdots,\n$$\nwhere $x_{n}=x(t_{n})$, $\\dot{x}_{n}=\\dot{x}(t_{n})$, and so on. Adding the expansions at $t_{n}+\\Delta t$ and $t_{n}-\\Delta t$ eliminates the odd derivatives and yields the central-difference identity\n$$\nx_{n+1}-2x_{n}+x_{n-1}=\\Delta t^{2}\\,\\ddot{x}_{n}+\\mathcal{O}(\\Delta t^{4}).\n$$\nSubstituting the equation of motion $\\ddot{x}_{n}=-\\omega^{2}x_{n}$ into this identity gives the standard position Verlet two-step recurrence\n$$\nx_{n+1}=2x_{n}-x_{n-1}-\\omega^{2}\\Delta t^{2}\\,x_{n}.\n$$\nIntroduce the nondimensional parameter $q=\\Delta t\\,\\omega$. Then the update can be written as\n$$\nx_{n+1}=(2-q^{2})\\,x_{n}-x_{n-1}.\n$$\nDefine the state vector\n$$\n\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\nThen\n$$\n\\mathbf{y}_{n+1}=\\begin{pmatrix}x_{n+1}\\\\ x_{n}\\end{pmatrix}=\\begin{pmatrix}(2-q^{2})\\,x_{n}-x_{n-1}\\\\ x_{n}\\end{pmatrix}=\\underbrace{\\begin{pmatrix}2-q^{2}  -1\\\\ 1  0\\end{pmatrix}}_{\\mathbf{A}(q)}\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\nThus, the amplification matrix is\n$$\n\\mathbf{A}(q)=\\begin{pmatrix}2-q^{2}  -1\\\\ 1  0\\end{pmatrix}.\n$$\nTo analyze linear stability, we consider the eigenvalues of $\\mathbf{A}(q)$. The characteristic polynomial is\n$$\n\\chi(\\lambda)=\\det\\!\\left(\\mathbf{A}-\\lambda\\mathbf{I}\\right)=\\det\\!\\begin{pmatrix}2-q^{2}-\\lambda  -1\\\\ 1  -\\lambda\\end{pmatrix}=(-\\lambda)(2-q^{2}-\\lambda)+1.\n$$\nExpanding,\n$$\n\\chi(\\lambda)=\\lambda^{2}-(2-q^{2})\\,\\lambda+1.\n$$\nThe eigenvalues $\\lambda_{\\pm}$ solve\n$$\n\\lambda^{2}-(2-q^{2})\\,\\lambda+1=0.\n$$\nThe determinant of $\\mathbf{A}$ is\n$$\n\\det\\mathbf{A}=1,\n$$\nwhich is a hallmark of symplecticity for this linear system. Linear stability of the recurrence (bounded solutions for all $n$) requires that both eigenvalues lie on or within the unit circle in the complex plane. For a real $2\\times 2$ matrix with determinant equal to $1$, the eigenvalues either lie on the unit circle as a complex-conjugate pair or are a reciprocal pair of real numbers. The unit-circle case occurs when the discriminant is negative and the trace satisfies the condition that the average of the eigenvalues is within $\\pm 1$ on the real axis.\n\nMore directly, since $\\lambda_{+}\\lambda_{-}=1$, both eigenvalues have modulus $1$ if and only if the trace satisfies\n$$\n\\left|\\frac{\\operatorname{tr}\\mathbf{A}}{2}\\right|\\leq 1.\n$$\nHere,\n$$\n\\operatorname{tr}\\mathbf{A}=2-q^{2}.\n$$\nThus the stability condition is\n$$\n\\left|\\frac{2-q^{2}}{2}\\right|\\leq 1.\n$$\nThis inequality simplifies to\n$$\n-1\\leq \\frac{2-q^{2}}{2}\\leq 1\\quad\\Longleftrightarrow\\quad -2\\leq 2-q^{2}\\leq 2\\quad\\Longleftrightarrow\\quad 0\\leq q^{2}\\leq 4.\n$$\nSince $q\\geq 0$ by definition, the stability interval is\n$$\n0\\leq q\\leq 2.\n$$\nTherefore, the maximal nondimensional time step that ensures linear stability is\n$$\nq_{\\max}=2.\n$$\nBecause this value is exact, no rounding is needed.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While the leapfrog and velocity Verlet algorithms are often presented as distinct methods, they share a deep underlying connection. This exercise challenges you to explore this relationship by applying both schemes to the same harmonic oscillator model from our previous practice . You will demonstrate their algebraic equivalence for linear systems, showing they possess identical stability properties and numerical frequency errors, a key insight that unifies our understanding of second-order symplectic integrators.",
            "id": "4090815",
            "problem": "Consider a one-dimensional harmonic oscillator governed by Newton’s second law, with position $x(t)$ satisfying $m\\,\\ddot{x}(t)=-kx(t)$, where $m0$, $k0$, and $\\omega=\\sqrt{k/m}$. Let $\\Delta t0$ be a fixed time step and define the nondimensional step size $h=\\omega\\,\\Delta t$. Two symplectic second-order integrators widely used in Molecular Dynamics (MD) for complex fluids are the leapfrog scheme and the velocity Verlet scheme. Apply both schemes to the oscillator, where:\n- The leapfrog scheme uses the staggered updates\n$$\nv_{n+\\frac{1}{2}}=v_{n-\\frac{1}{2}}-\\omega^{2}x_{n}\\,\\Delta t,\\quad\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t.\n$$\n- The velocity Verlet scheme uses the updates\n$$\nv_{n+\\frac{1}{2}}=v_{n}-\\frac{1}{2}\\,\\omega^{2}x_{n}\\,\\Delta t,\\quad\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t,\\quad\nv_{n+1}=v_{n+\\frac{1}{2}}-\\frac{1}{2}\\,\\omega^{2}x_{n+1}\\,\\Delta t.\n$$\nStarting only from these definitions and the oscillator equation $\\,\\ddot{x}=-\\omega^{2}x\\,$, carry out the following steps:\n- Derive, for each scheme, a closed linear homogeneous recurrence solely for $x_{n}$ of the form $x_{n+1}=a(h)\\,x_{n}-x_{n-1}$ with some scalar function $a(h)$.\n- From this recurrence, determine the linear stability condition in terms of $h$, defined as the set of $h$ for which all solutions remain bounded as $n\\to\\infty$.\n- Define the numerical angular frequency $\\omega_{\\text{num}}$ by setting $x_{n}=A\\cos(n\\,\\omega_{\\text{num}}\\Delta t+\\phi)$ when the method is linearly stable, and obtain the small-$h$ expansion of the frequency ratio\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega}=1+\\alpha\\,h^{2}+\\mathcal{O}(h^{4}).\n$$\nShow that the stability condition and the coefficient $\\alpha$ are identical for leapfrog and velocity Verlet.\n\nReport your final answer as a row vector $\\bigl[h_{\\max}\\ \\ \\alpha\\bigr]$, where $h_{\\max}$ is the maximum admissible nondimensional step size for linear stability and $\\alpha$ is the common coefficient in the frequency expansion. No rounding is required, and no units are to be reported.",
            "solution": "The problem requires an analysis of two numerical integration schemes, leapfrog and velocity Verlet, applied to a one-dimensional harmonic oscillator, whose equation of motion is $\\ddot{x}(t) = -\\omega^2 x(t)$, where $\\omega = \\sqrt{k/m}$. For each scheme, we must first derive a linear recurrence relation for the position variable $x_n$, then determine the linear stability condition, and finally find the leading-order error term in the numerical frequency.\n\nPart 1: Derivation of the recurrence relation for $x_n$.\n\nFor the leapfrog scheme, the updates are given by:\n$$\nv_{n+\\frac{1}{2}} = v_{n-\\frac{1}{2}} - \\omega^{2}x_{n}\\,\\Delta t \\quad (1)\n$$\n$$\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t \\quad (2)\n$$\nFrom equation $(2)$, we can express the half-step velocity $v_{n+\\frac{1}{2}}$ in terms of positions:\n$$\nv_{n+\\frac{1}{2}} = \\frac{x_{n+1} - x_n}{\\Delta t}\n$$\nTo find an expression for $v_{n-\\frac{1}{2}}$, we can shift the index $n$ in equation $(2)$ to $n-1$:\n$$\nx_{n} = x_{n-1} + v_{n-\\frac{1}{2}}\\,\\Delta t\n$$\nwhich gives:\n$$\nv_{n-\\frac{1}{2}} = \\frac{x_n - x_{n-1}}{\\Delta t}\n$$\nSubstituting these two expressions for the velocities into equation $(1)$:\n$$\n\\frac{x_{n+1} - x_n}{\\Delta t} = \\frac{x_n - x_{n-1}}{\\Delta t} - \\omega^2 x_n \\Delta t\n$$\nMultiplying the entire equation by $\\Delta t$ yields:\n$$\nx_{n+1} - x_n = x_n - x_{n-1} - \\omega^2 (\\Delta t)^2 x_n\n$$\nRearranging the terms to isolate $x_{n+1}$, we obtain the desired recurrence relation:\n$$\nx_{n+1} = 2x_n - x_{n-1} - (\\omega \\Delta t)^2 x_n\n$$\nUsing the definition of the nondimensional step size, $h = \\omega \\Delta t$, this becomes:\n$$\nx_{n+1} = (2 - h^2)x_n - x_{n-1}\n$$\nThis is of the form $x_{n+1} = a(h)x_n - x_{n-1}$ with $a(h) = 2 - h^2$.\n\nFor the velocity Verlet scheme, the updates are:\n$$\nv_{n+\\frac{1}{2}} = v_{n} - \\frac{1}{2}\\,\\omega^{2}x_{n}\\,\\Delta t \\quad (3)\n$$\n$$\nx_{n+1} = x_{n} + v_{n+\\frac{1}{2}}\\,\\Delta t \\quad (4)\n$$\n$$\nv_{n+1} = v_{n+\\frac{1}{2}} - \\frac{1}{2}\\,\\omega^{2}x_{n+1}\\,\\Delta t \\quad (5)\n$$\nOur goal is to find a recurrence relation involving only the position variables $x_n$. First, we can express $v_n$ and $v_{n-1}$ in terms of positions. From equation $(4)$, we have $v_{n+\\frac{1}{2}} = (x_{n+1}-x_n)/\\Delta t$. Substituting this into $(3)$:\n$$\n\\frac{x_{n+1}-x_n}{\\Delta t} = v_n - \\frac{1}{2}\\omega^2 x_n \\Delta t \\implies v_n = \\frac{x_{n+1}-x_n}{\\Delta t} + \\frac{1}{2}\\omega^2 x_n \\Delta t\n$$\nNow we need a second relationship involving velocities. By combining equations $(3)$ and $(5)$, we can write an update rule for the full-step velocity $v_n$:\n$$\nv_{n+1} = \\left(v_n - \\frac{1}{2}\\omega^2 x_n \\Delta t\\right) - \\frac{1}{2}\\omega^2 x_{n+1} \\Delta t = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})\n$$\nShifting the index $n$ to $n-1$ gives a relation for $v_n$ in terms of $v_{n-1}$:\n$$\nv_n = v_{n-1} - \\frac{1}{2}\\omega^2 \\Delta t (x_{n-1} + x_n)\n$$\nNow, we can substitute the expression for $v_n$ and $v_{n-1}$ (by shifting the index on our first velocity expression) into this equation:\n$$\n\\frac{x_{n+1}-x_n}{\\Delta t} + \\frac{1}{2}\\omega^2 x_n \\Delta t = \\left( \\frac{x_n-x_{n-1}}{\\Delta t} + \\frac{1}{2}\\omega^2 x_{n-1} \\Delta t \\right) - \\frac{1}{2}\\omega^2 \\Delta t (x_{n-1} + x_n)\n$$\nMultiplying by $\\Delta t$ and using $h = \\omega \\Delta t$:\n$$\n(x_{n+1}-x_n) + \\frac{h^2}{2} x_n = (x_n-x_{n-1}) + \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} (x_{n-1} + x_n)\n$$\nSimplifying the right-hand side:\n$$\nx_{n+1}-x_n + \\frac{h^2}{2} x_n = x_n-x_{n-1} + \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} x_n\n$$\n$$\nx_{n+1}-x_n + \\frac{h^2}{2} x_n = x_n-x_{n-1} - \\frac{h^2}{2} x_n\n$$\nRearranging to solve for $x_{n+1}$:\n$$\nx_{n+1} = 2x_n - x_{n-1} - h^2 x_n = (2 - h^2)x_n - x_{n-1}\n$$\nThis is identical to the recurrence relation found for the leapfrog scheme. Thus, for velocity Verlet, we also have $a(h) = 2 - h^2$.\n\nPart 2: Linear stability analysis.\nSince both schemes lead to the same recurrence relation $x_{n+1} - (2-h^2)x_n + x_{n-1} = 0$, their stability properties are identical. To analyze the stability, we consider the characteristic equation associated with this linear recurrence. Assuming a solution of the form $x_n = \\lambda^n$, we get:\n$$\n\\lambda^2 - (2-h^2)\\lambda + 1 = 0\n$$\nThe roots of this quadratic equation are:\n$$\n\\lambda_{\\pm} = \\frac{(2-h^2) \\pm \\sqrt{(2-h^2)^2 - 4}}{2} = \\frac{(2-h^2) \\pm \\sqrt{h^4 - 4h^2}}{2} = \\frac{(2-h^2) \\pm h\\sqrt{h^2 - 4}}{2}\n$$\nFor the solution $x_n$ to remain bounded as $n \\to \\infty$, the modulus of the roots must satisfy $|\\lambda| \\le 1$. If there are two distinct roots, and since their product $\\lambda_+\\lambda_-$ is $1$, one root would have a modulus greater than $1$ if they were real, leading to exponential growth. This corresponds to the discriminant being positive. Bounded solutions are only possible if the roots are complex conjugates of modulus $1$.\nThis condition requires the discriminant to be negative:\n$$\nh^2(h^2-4)  0\n$$\nSince $h = \\omega \\Delta t  0$, $h^2  0$. The condition simplifies to:\n$$\nh^2 - 4  0 \\implies h^2  4 \\implies h  2\n$$\n(since $h0$). At the boundary $h=2$, the discriminant is zero, giving a double root $\\lambda=-1$, which leads to a linearly growing, hence unstable, solution of the form $x_n=(c_1+c_2 n)(-1)^n$.\nThus, the condition for linear stability for both schemes is $0  h  2$. The maximum admissible step size is $h_{\\max} = 2$.\n\nPart 3: Numerical frequency error.\nIn the stable regime ($0  h  2$), the solution is oscillatory. We substitute the ansatz $x_n = A \\cos(n \\omega_{\\text{num}} \\Delta t + \\phi)$ into the recurrence relation. Let $\\psi = \\omega_{\\text{num}} \\Delta t$. We have:\n$$\nx_{n+1} + x_{n-1} = A\\cos((n+1)\\psi+\\phi) + A\\cos((n-1)\\psi+\\phi)\n$$\nUsing the identity $\\cos(A+B) + \\cos(A-B) = 2\\cos A \\cos B$, with $A=n\\psi+\\phi$ and $B=\\psi$:\n$$\nx_{n+1} + x_{n-1} = 2A\\cos(n\\psi+\\phi)\\cos\\psi = 2x_n\\cos\\psi\n$$\nThe recurrence relation can be written as $x_{n+1}+x_{n-1} = (2-h^2)x_n$. Comparing these two expressions, we find:\n$$\n2\\cos\\psi = 2 - h^2 \\implies \\cos\\psi = 1 - \\frac{h^2}{2}\n$$\nThis gives a relationship between the numerical frequency phase step $\\psi = \\omega_{\\text{num}}\\Delta t$ and the nondimensional time step $h = \\omega \\Delta t$. We are interested in the ratio $\\omega_{\\text{num}}/\\omega = \\psi/h$ for small $h$.\nFor small $\\psi$, we expand $\\cos\\psi$ in a Taylor series:\n$$\n\\cos\\psi = 1 - \\frac{\\psi^2}{2!} + \\frac{\\psi^4}{4!} - \\mathcal{O}(\\psi^6)\n$$\nEquating this with our result:\n$$\n1 - \\frac{\\psi^2}{2} + \\frac{\\psi^4}{24} - \\dots = 1 - \\frac{h^2}{2}\n$$\n$$\n\\frac{\\psi^2}{2} - \\frac{\\psi^4}{24} + \\dots = \\frac{h^2}{2} \\implies \\psi^2 \\left(1 - \\frac{\\psi^2}{12} + \\dots\\right) = h^2\n$$\nFor small $h$, $\\psi$ is also small, and $\\psi \\approx h$. We can write $\\psi$ as a power series in $h$: $\\psi = c_1 h + c_3 h^3 + \\dots$. The leading term is $c_1=1$. So, $\\psi = h + c_3 h^3 + \\mathcal{O}(h^5)$.\nSubstituting this into the equation:\n$$\n(h + c_3 h^3 + \\dots)^2 \\left(1 - \\frac{(h + \\dots)^2}{12} + \\dots\\right) = h^2\n$$\n$$\n(h^2 + 2c_3 h^4 + \\dots)\\left(1 - \\frac{h^2}{12} + \\dots\\right) = h^2\n$$\n$$\nh^2 - \\frac{h^4}{12} + 2c_3 h^4 + \\dots = h^2\n$$\nComparing coefficients of $h^4$:\n$$\n2c_3 - \\frac{1}{12} = 0 \\implies c_3 = \\frac{1}{24}\n$$\nSo, $\\psi = h + \\frac{1}{24}h^3 + \\mathcal{O}(h^5)$.\nThe frequency ratio is:\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega} = \\frac{\\psi}{h} = \\frac{h + \\frac{1}{24}h^3 + \\mathcal{O}(h^5)}{h} = 1 + \\frac{1}{24}h^2 + \\mathcal{O}(h^4)\n$$\nThis is of the form $1 + \\alpha h^2 + \\mathcal{O}(h^4)$, with the coefficient $\\alpha = \\frac{1}{24}$. This result is also identical for both schemes.\n\nIn conclusion, both the leapfrog and velocity Verlet schemes are algebraically equivalent for the linear harmonic oscillator, leading to the same stability limit $h_{\\max}=2$ and the same frequency error coefficient $\\alpha = 1/24$. The final answer is the row vector $[h_{\\max} \\ \\ \\alpha]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  \\frac{1}{24}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Achieving high accuracy in long-time simulations often requires moving beyond standard second-order methods. This advanced practice introduces the concept of composed integrators, where a higher-order scheme is constructed from carefully chosen substeps of a simpler algorithm. You will analyze the stability of a fourth-order composed integrator and compare its performance against a second-order scheme at the same computational cost , revealing important trade-offs between accuracy, stability, and efficiency.",
            "id": "4090831",
            "problem": "Consider a single-degree-of-freedom harmonic oscillator representative of a coarse-grained bead in a computational complex fluid, governed by Newton’s second law $m \\,\\ddot{x}(t) = -k \\,x(t)$, with angular frequency $\\omega = \\sqrt{k/m}$. You will integrate this system using two explicit, symplectic Molecular Dynamics (MD) schemes and assess their stability and energy behavior.\n\nScheme A is the second-order velocity Verlet algorithm. Scheme B is a fourth-order composed Verlet integrator constructed by symmetric composition (“triple jump”) of three velocity Verlet substeps with fractional macro-step sizes $a_{1} H$, $a_{2} H$, $a_{3} H$, where $H$ denotes the macro-step size and the coefficients are\n$$\na_{1} \\;=\\; a_{3} \\;=\\; \\frac{1}{2 - 2^{1/3}}, \\qquad a_{2} \\;=\\; -\\,\\frac{2^{1/3}}{2 - 2^{1/3}}.\n$$\nAssume that one force evaluation is required per velocity Verlet substep. Define “effective cost” over a fixed physical time interval as the total number of force evaluations needed to advance that interval.\n\nFor Scheme A at the same effective cost as one macro-step of Scheme B, use three velocity Verlet substeps of size $H/3$ to advance the same physical time $H$.\n\nStarting from the oscillator dynamics and the discrete update induced by velocity Verlet, derive the linear stability condition for each substep applied to the harmonic oscillator. Then, using the fact that a composed step is stable only if every constituent substep is stable, determine the maximum stable macro-step size $H$ for Scheme B and for Scheme A at equal cost. Finally, report the ratio $R$ of these maximum stable macro-step sizes (Scheme A at equal cost divided by Scheme B).\n\nProvide your final $R$ as a single exact closed-form expression. No numerical rounding is required. For completeness in your derivation, briefly justify the bounded, oscillatory energy behavior of both schemes for the harmonic oscillator and identify the leading-order dependence of the energy oscillation amplitude on the step size for each scheme under the equal-cost setup, but do not include these qualitative energy assessments in your final numerical answer.",
            "solution": "The problem statement is evaluated as scientifically sound, well-posed, objective, and self-contained. It is a standard problem in the field of numerical analysis for molecular dynamics and contains no discernible flaws. Therefore, a full solution is provided.\n\nThe problem asks for an analysis of two numerical integration schemes for a single-degree-of-freedom harmonic oscillator, described by the equation of motion $m \\ddot{x}(t) = -k x(t)$. The angular frequency is $\\omega = \\sqrt{k/m}$. The state of the system at any time $t$ can be described by a vector $\\mathbf{z}(t) = (x(t), \\dot{x}(t))^T$.\n\nFirst, we derive the linear stability condition for the velocity Verlet algorithm, which is a second-order symplectic integrator. The algorithm for a time step of size $h$ proceeds in two stages:\n1.  Update position: $x(t+h) = x(t) + \\dot{x}(t)h + \\frac{1}{2}\\ddot{x}(t)h^2$.\n2.  Update velocity: $\\dot{x}(t+h) = \\dot{x}(t) + \\frac{1}{2}(\\ddot{x}(t) + \\ddot{x}(t+h))h$.\n\nFor the harmonic oscillator, the acceleration is $\\ddot{x}(t) = - \\omega^2 x(t)$. Let a state at step $n$ be $\\mathbf{z}_n = (x_n, \\dot{x}_n)^T$. The update equations become:\n$x_{n+1} = x_n + h \\dot{x}_n + \\frac{1}{2}(-\\omega^2 x_n)h^2 = (1 - \\frac{\\omega^2 h^2}{2})x_n + h \\dot{x}_n$.\n\nUsing the new position $x_{n+1}$, the new acceleration is $\\ddot{x}_{n+1} = -\\omega^2 x_{n+1}$. The velocity update is:\n$\\dot{x}_{n+1} = \\dot{x}_n + \\frac{h}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) = \\dot{x}_n - \\frac{\\omega^2 h}{2}x_n - \\frac{\\omega^2 h}{2} \\left[ (1 - \\frac{\\omega^2 h^2}{2})x_n + h \\dot{x}_n \\right]$\n$\\dot{x}_{n+1} = \\left( -\\frac{\\omega^2 h}{2} - \\frac{\\omega^2 h}{2}(1 - \\frac{\\omega^2 h^2}{2}) \\right)x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n$\n$\\dot{x}_{n+1} = \\left( -\\omega^2 h + \\frac{\\omega^4 h^3}{4} \\right)x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n = -\\omega^2 h(1 - \\frac{\\omega^2 h^2}{4})x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n$.\n\nThis linear map can be written as $\\mathbf{z}_{n+1} = M(h)\\mathbf{z}_n$, where $M(h)$ is the transfer matrix for a single step of size $h$:\n$$\nM(h) = \\begin{pmatrix}\n1 - \\frac{\\omega^2 h^2}{2}  h \\\\\n-\\omega^2 h(1 - \\frac{\\omega^2 h^2}{4})  1 - \\frac{\\omega^2 h^2}{2}\n\\end{pmatrix}\n$$\nThe integrator is stable if the eigenvalues of $M(h)$ have a modulus less than or equal to $1$. The eigenvalues $\\lambda$ are found from the characteristic equation $\\lambda^2 - \\text{Tr}(M)\\lambda + \\det(M) = 0$.\nThe trace is $\\text{Tr}(M) = 2 - \\omega^2 h^2$.\nThe determinant is $\\det(M) = (1 - \\frac{\\omega^2 h^2}{2})^2 + \\omega^2 h^2(1 - \\frac{\\omega^2 h^2}{4}) = 1 - \\omega^2 h^2 + \\frac{\\omega^4 h^4}{4} + \\omega^2 h^2 - \\frac{\\omega^4 h^4}{4} = 1$.\nThe fact that $\\det(M)=1$ is characteristic of symplectic integrators applied to linear Hamiltonian systems.\n\nThe eigenvalues are the roots of $\\lambda^2 - (2 - \\omega^2 h^2)\\lambda + 1 = 0$. For stable, oscillatory (non-divergent) solutions, the eigenvalues must be a complex conjugate pair on the unit circle. This requires the discriminant of the quadratic equation to be non-positive:\n$(\\text{Tr}(M))^2 - 4\\det(M) \\le 0$\n$(2 - \\omega^2 h^2)^2 - 4 \\le 0 \\implies |2 - \\omega^2 h^2| \\le 2$.\nThis leads to the inequality $-2 \\le 2 - \\omega^2 h^2 \\le 2$.\nThe right side, $2 - \\omega^2 h^2 \\le 2$, implies $-\\omega^2 h^2 \\le 0$, which is always true.\nThe left side, $-2 \\le 2 - \\omega^2 h^2$, implies $\\omega^2 h^2 \\le 4$.\nSince $\\omega  0$ and the step size $h$ must be positive, the stability condition for a single velocity Verlet step of size $h$ is $\\omega h \\le 2$. For negative step sizes, as in Scheme B, the condition applies to the magnitude of the step, i.e., $\\omega |h| \\le 2$.\n\nNow we analyze the two schemes.\n\nScheme A (at equal cost):\nThis scheme advances the system over a macro-step size $H$ using three identical velocity Verlet substeps, each of size $h_A = H/3$. For the overall scheme to be stable, each substep must be stable. The condition is:\n$\\omega h_A \\le 2 \\implies \\omega (H/3) \\le 2 \\implies \\omega H \\le 6$.\nThe maximum stable macro-step size for Scheme A is thus given by $\\omega H_{\\text{max, A}} = 6$.\n\nScheme B:\nThis scheme is a symmetric composition of three velocity Verlet substeps with sizes $h_1 = a_1 H$, $h_2 = a_2 H$, and $h_3 = a_3 H$. The given coefficients are:\n$a_1 = a_3 = \\frac{1}{2 - 2^{1/3}}$\n$a_2 = -\\frac{2^{1/3}}{2 - 2^{1/3}}$\nSince $1  2^{1/3}  2$, the denominator $2 - 2^{1/3}$ is positive. Therefore, $a_1$ and $a_3$ are positive, while $a_2$ is negative.\nFor the composed step to be stable, every constituent substep must be stable. We apply the stability condition to the magnitude of each substep size:\n$1$. $\\omega|h_1| = \\omega a_1 H \\le 2 \\implies \\omega H \\le \\frac{2}{a_1}$\n$2$. $\\omega|h_2| = \\omega |a_2| H \\le 2 \\implies \\omega H \\le \\frac{2}{|a_2|}$\n$3$. $\\omega|h_3| = \\omega a_3 H \\le 2 \\implies \\omega H \\le \\frac{2}{a_3}$\n\nTo satisfy all three conditions simultaneously, $\\omega H$ must be less than or equal to the minimum of the three bounds. We compare the magnitudes of the coefficients:\n$|a_1| = |a_3| = \\frac{1}{2 - 2^{1/3}}$\n$|a_2| = \\frac{2^{1/3}}{2 - 2^{1/3}}$\nSince $2^{1/3}  1$, it is clear that $|a_2|  |a_1|$. The most restrictive condition is therefore the one involving $|a_2|$, because this corresponds to the substep with the largest magnitude.\nThe stability limit for Scheme B is set by this substep:\n$\\omega H_{\\text{max, B}} = \\frac{2}{|a_2|} = \\frac{2}{\\frac{2^{1/3}}{2 - 2^{1/3}}} = \\frac{2(2 - 2^{1/3})}{2^{1/3}}$.\n\nFinally, we compute the ratio $R$ of the maximum stable macro-step sizes:\n$R = \\frac{H_{\\text{max, A}}}{H_{\\text{max, B}}} = \\frac{\\omega H_{\\text{max, A}}}{\\omega H_{\\text{max, B}}} = \\frac{6}{\\frac{2(2 - 2^{1/3})}{2^{1/3}}}$.\n$R = \\frac{6 \\cdot 2^{1/3}}{2(2 - 2^{1/3})} = \\frac{3 \\cdot 2^{1/3}}{2 - 2^{1/3}}$.\n\nFor completeness, we address the energy behavior. Both schemes are compositions of the velocity Verlet algorithm, which is symplectic. For Hamiltonian systems, symplectic integrators do not conserve the energy $E$ exactly, but they do conserve a nearby \"shadow Hamiltonian\" $H_{shadow}$. This implies that the true energy $E$ does not exhibit secular drift but undergoes bounded oscillations.\nScheme A consists of three applications of a second-order integrator, and the overall macro-step remains second-order accurate. The shadow Hamiltonian is $H_{shadow,A} = E + \\mathcal{O}(H^2)$. Consequently, the amplitude of energy oscillations scales as $\\mathcal{O}(H^2)$.\nScheme B is a well-known fourth-order integrator constructed by symmetric composition. Its shadow Hamiltonian is $H_{shadow,B} = E + \\mathcal{O}(H^4)$, and the amplitude of its energy oscillations scales as $\\mathcal{O}(H^4)$. For small $H$, Scheme B provides significantly better energy conservation at the same computational cost.",
            "answer": "$$\n\\boxed{\\frac{3 \\cdot 2^{1/3}}{2 - 2^{1/3}}}\n$$"
        }
    ]
}