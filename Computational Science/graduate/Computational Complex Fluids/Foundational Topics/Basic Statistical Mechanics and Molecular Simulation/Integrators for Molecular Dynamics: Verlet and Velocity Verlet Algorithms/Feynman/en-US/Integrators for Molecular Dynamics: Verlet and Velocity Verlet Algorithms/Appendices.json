{
    "hands_on_practices": [
        {
            "introduction": "The first step in assessing any numerical integrator is to understand its accuracy over a single step. This exercise  guides you through a fundamental analysis of the position Verlet scheme's Local Truncation Error (LTE) using Taylor series expansions. By quantifying this error, you will see precisely why the method is classified as 'second-order' and appreciate the source of its numerical imperfections.",
            "id": "4090824",
            "problem": "Consider a single particle of mass $m$ moving in one spatial dimension under a smooth potential $U(x)$ representative of mesoscale interactions in a computational complex fluid. Its dynamics follow Newton's second law, $m\\,\\ddot{x}(t) = -\\frac{dU}{dx}\\big(x(t)\\big)$, with $x(t)$ a four-times continuously differentiable function of time $t$. In Molecular Dynamics (MD), a widely used second-order integrator for such systems is the position Verlet scheme, which updates the position via\n$$\nx_{n+1} \\;=\\; 2\\,x_{n} \\;-\\; x_{n-1} \\;+\\; a\\big(x_{n}\\big)\\,\\Delta t^{2},\n$$\nwhere $x_{n}$ denotes $x(t_{n})$, $t_{n+1} = t_{n} + \\Delta t$, and the acceleration $a\\big(x_{n}\\big) = \\ddot{x}(t_{n}) = -\\frac{1}{m}\\frac{dU}{dx}\\big(x_{n}\\big)$.\n\nDefine the Local Truncation Error (LTE) for the position update at time $t_{n}$ as the difference between the discrete update $x_{n+1}$ produced by the above scheme when $x_{n-1}$ and $x_{n}$ are exact, and the exact trajectory’s Taylor series about $t_{n}$ truncated at third order in $\\Delta t$. Using only Newton’s law, smoothness of $U(x)$, and Taylor expansions in time about $t_{n}$, derive the leading-order analytic expression for this LTE. Express your final answer as a closed-form expression in terms of $x^{(4)}(t_{n})$ and $\\Delta t$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "To find the Local Truncation Error (LTE) as defined, we compare the position Verlet update formula with the Taylor series of the exact trajectory truncated at third order.\n\nThe problem defines the LTE at time $t_n$ as:\n$$\n\\text{LTE} = x_{n+1}^{(\\text{Verlet})} - x_{n+1}^{(\\text{Taylor, 3rd order})}\n$$\nThe first term is the result of the position Verlet algorithm, assuming $x_n$ and $x_{n-1}$ are on the exact trajectory:\n$$\nx_{n+1}^{(\\text{Verlet})} = 2x_n - x_{n-1} + a(x_n)\\Delta t^2\n$$\nTo analyze this, we express $x_{n-1} = x(t_n - \\Delta t)$ as a Taylor series expansion around $t_n$:\n$$\nx_{n-1} = x_n - \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 - \\frac{1}{6}\\dddot{x}_n\\Delta t^3 + \\frac{1}{24}x_n^{(4)}\\Delta t^4 + O(\\Delta t^5)\n$$\nSubstituting this into the Verlet formula and using $a(x_n) = \\ddot{x}_n$:\n$$\n\\begin{align*}\nx_{n+1}^{(\\text{Verlet})} &= 2x_n - \\left(x_n - \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 - \\frac{1}{6}\\dddot{x}_n\\Delta t^3 + \\frac{1}{24}x_n^{(4)}\\Delta t^4 + \\dots\\right) + \\ddot{x}_n\\Delta t^2 \\\\\n&= x_n + \\dot{x}_n\\Delta t + \\left(-\\frac{1}{2}+1\\right)\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3 - \\frac{1}{24}x_n^{(4)}\\Delta t^4 + \\dots \\\\\n&= x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3 - \\frac{1}{24}x_n^{(4)}\\Delta t^4 + O(\\Delta t^5)\n\\end{align*}\n$$\nThe second term in the LTE definition is the exact trajectory's Taylor series about $t_n$ truncated at third order:\n$$\nx_{n+1}^{(\\text{Taylor, 3rd order})} = x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3\n$$\nFinally, we compute the difference:\n$$\n\\begin{align*}\n\\text{LTE} &= \\left(x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3 - \\frac{1}{24}x_n^{(4)}\\Delta t^4 + \\dots\\right) - \\left(x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3\\right) \\\\\n&= - \\frac{1}{24}x_n^{(4)}\\Delta t^4 + O(\\Delta t^5)\n\\end{align*}\n$$\nThe leading-order analytic expression for this LTE is therefore $-\\frac{1}{24}x^{(4)}(t_{n})\\Delta t^{4}$.",
            "answer": "$$\n\\boxed{-\\frac{1}{24}x^{(4)}(t_{n})\\Delta t^{4}}\n$$"
        },
        {
            "introduction": "While local accuracy is important, the long-term stability of an integrator determines whether a simulation can run for a meaningful duration. This practice  explores the stability of the position Verlet algorithm by modeling a system's dynamics as a harmonic oscillator. You will derive the algorithm's amplification matrix and use it to find the maximum stable time step, a critical parameter in any molecular dynamics simulation.",
            "id": "4090835",
            "problem": "In the context of Molecular Dynamics (MD) simulations of linearized modes in computational complex fluids, consider a single normal mode modeled as a one-dimensional harmonic oscillator governed by Newton’s second law, with equation of motion given by $\\ddot{x}(t)=-\\omega^{2}x(t)$, where $\\omega>0$ is the mode frequency. You discretize time as $t_{n}=n\\,\\Delta t$, with constant time step $\\Delta t>0$, and you use the position Verlet algorithm to integrate the dynamics.\n\nStarting only from the differential equation $\\ddot{x}(t)=-\\omega^{2}x(t)$ and standard central-difference consistent approximations, do the following:\n\n1. Derive the explicit two-step recurrence for $x_{n+1}$ in terms of $x_{n}$ and $x_{n-1}$ that is consistent with the position Verlet algorithm.\n2. Introduce the state vector $\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}$ and derive the $2\\times 2$ amplification matrix $\\mathbf{A}$ such that $\\mathbf{y}_{n+1}=\\mathbf{A}\\,\\mathbf{y}_{n}$, expressing $\\mathbf{A}$ solely in terms of the nondimensional parameter $q=\\Delta t\\,\\omega$.\n3. Using first principles of linear stability for linear constant-coefficient recurrences, determine the condition on $q$ under which the position Verlet method is linearly stable for this harmonic oscillator. Then, extract the single maximal nondimensional step size $q_{\\max}$ such that stability holds for all $0\\leq q\\leq q_{\\max}$.\n\nProvide as your final answer only the single number $q_{\\max}$, without units. No rounding is required; provide the exact value.",
            "solution": "We begin from Newton’s second law for a one-dimensional harmonic oscillator,\n$$\n\\ddot{x}(t)=-\\omega^{2}x(t),\n$$\nwith $\\omega>0$ and constant time step $\\Delta t>0$. The position Verlet algorithm can be obtained by using the central difference for the second derivative, which is a standard, symmetric, second-order accurate approximation. Specifically, expand $x(t)$ in a Taylor series about $t_{n}$:\n$$\nx(t_{n}\\pm \\Delta t)=x_{n}\\pm \\Delta t\\,\\dot{x}_{n}+\\frac{\\Delta t^{2}}{2}\\,\\ddot{x}_{n}\\pm \\frac{\\Delta t^{3}}{6}\\,\\dddot{x}_{n}+\\frac{\\Delta t^{4}}{24}\\,x^{(4)}_{n}+\\cdots,\n$$\nwhere $x_{n}=x(t_{n})$, $\\dot{x}_{n}=\\dot{x}(t_{n})$, and so on. Adding the expansions at $t_{n}+\\Delta t$ and $t_{n}-\\Delta t$ eliminates the odd derivatives and yields the central-difference identity\n$$\nx_{n+1}-2x_{n}+x_{n-1}=\\Delta t^{2}\\,\\ddot{x}_{n}+\\mathcal{O}(\\Delta t^{4}).\n$$\nSubstituting the equation of motion $\\ddot{x}_{n}=-\\omega^{2}x_{n}$ into this identity gives the standard position Verlet two-step recurrence\n$$\nx_{n+1}=2x_{n}-x_{n-1}-\\omega^{2}\\Delta t^{2}\\,x_{n}.\n$$\nIntroduce the nondimensional parameter $q=\\Delta t\\,\\omega$. Then the update can be written as\n$$\nx_{n+1}=(2-q^{2})\\,x_{n}-x_{n-1}.\n$$\nDefine the state vector\n$$\n\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\nThen\n$$\n\\mathbf{y}_{n+1}=\\begin{pmatrix}x_{n+1}\\\\ x_{n}\\end{pmatrix}=\\begin{pmatrix}(2-q^{2})\\,x_{n}-x_{n-1}\\\\ x_{n}\\end{pmatrix}=\\underbrace{\\begin{pmatrix}2-q^{2} & -1\\\\ 1 & 0\\end{pmatrix}}_{\\mathbf{A}(q)}\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\nThus, the amplification matrix is\n$$\n\\mathbf{A}(q)=\\begin{pmatrix}2-q^{2} & -1\\\\ 1 & 0\\end{pmatrix}.\n$$\nTo analyze linear stability, we consider the eigenvalues of $\\mathbf{A}(q)$. The characteristic polynomial is\n$$\n\\chi(\\lambda)=\\det(\\mathbf{A}-\\lambda\\mathbf{I})=\\det\\begin{pmatrix}2-q^{2}-\\lambda & -1\\\\ 1 & -\\lambda\\end{pmatrix}=(-\\lambda)(2-q^{2}-\\lambda)+1.\n$$\nExpanding,\n$$\n\\chi(\\lambda)=\\lambda^{2}-(2-q^{2})\\,\\lambda+1.\n$$\nThe eigenvalues $\\lambda_{\\pm}$ solve\n$$\n\\lambda^{2}-(2-q^{2})\\,\\lambda+1=0.\n$$\nThe determinant of $\\mathbf{A}$ is\n$$\n\\det\\mathbf{A}=1,\n$$\nwhich is a hallmark of symplecticity for this linear system. Linear stability of the recurrence (bounded solutions for all $n$) requires that both eigenvalues lie on or within the unit circle in the complex plane. For a real $2\\times 2$ matrix with determinant equal to $1$, the eigenvalues either lie on the unit circle as a complex-conjugate pair or are a reciprocal pair of real numbers. The unit-circle case corresponds to stable oscillations.\n\nMore directly, since $\\lambda_{+}\\lambda_{-}=1$, both eigenvalues have modulus $1$ if and only if the trace satisfies\n$$\n\\left|\\frac{\\operatorname{tr}\\mathbf{A}}{2}\\right|\\leq 1.\n$$\nHere,\n$$\n\\operatorname{tr}\\mathbf{A}=2-q^{2}.\n$$\nThus the stability condition is\n$$\n\\left|\\frac{2-q^{2}}{2}\\right|\\leq 1.\n$$\nThis inequality simplifies to\n$$\n-1\\leq \\frac{2-q^{2}}{2}\\leq 1\\quad\\Longleftrightarrow\\quad -2\\leq 2-q^{2}\\leq 2\\quad\\Longleftrightarrow\\quad 0\\leq q^{2}\\leq 4.\n$$\nSince $q\\geq 0$ by definition, the stability interval is\n$$\n0\\leq q\\leq 2.\n$$\nTherefore, the maximal nondimensional time step that ensures linear stability is\n$$\nq_{\\max}=2.\n$$\nBecause this value is exact, no rounding is needed.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "A stable numerical integration does not guarantee physical accuracy; the discretization of time introduces artifacts that can alter a system's properties. This exercise  delves into the concept of numerical dispersion by analyzing how the velocity Verlet algorithm affects the oscillation frequency of a harmonic mode. Understanding this relationship between the numerical and physical frequency is essential for correctly interpreting the results of molecular simulations.",
            "id": "4090847",
            "problem": "Consider a one-dimensional harmonic oscillator used as a local model for a coarse-grained bead in a complex fluid, with mass $m$, position $x(t)$, and potential $U(x) = \\frac{1}{2} m \\omega^{2} x^{2}$, where $\\omega$ is the physical angular frequency. The motion obeys Newton’s Second Law $m \\ddot{x}(t) = - \\frac{dU}{dx} = - m \\omega^{2} x(t)$, i.e., $\\ddot{x}(t) + \\omega^{2} x(t) = 0$. In Molecular Dynamics (MD), the velocity Verlet algorithm with time step $\\Delta t$ updates position and velocity through\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n} + \\frac{\\Delta t^{2}}{2} \\, a_{n}, \\qquad v_{n+1} = v_{n} + \\frac{\\Delta t}{2} \\left(a_{n} + a_{n+1}\\right),$$\nwhere $a_{n} = \\ddot{x}(t_{n})$ and $t_{n} = n \\Delta t$. For the harmonic oscillator, $a_{n} = - \\omega^{2} x_{n}$.\n\nStarting from these principles and definitions, and assuming a discrete-time oscillatory solution $x_{n}$ that is nontrivial and bounded as $n \\to \\infty$, derive the dispersion relation linking the numerical angular frequency $\\tilde{\\omega}$ of the discrete-time oscillation to $\\omega$ and $\\Delta t$, and then compute an explicit analytic expression for $\\tilde{\\omega}$ in terms of $\\omega$ and $\\Delta t$. Assume $0 < \\omega \\Delta t < 2$ so that the discrete dynamics are stable and oscillatory. Express the final $\\tilde{\\omega}$ in radians per unit time. Your final answer must be a single closed-form analytic expression for $\\tilde{\\omega}$.",
            "solution": "To find the numerical frequency $\\tilde{\\omega}$, we first derive a single recurrence relation for the positions $x_n$ by eliminating the velocities $v_n$ from the Velocity Verlet update rules.\n\nThe update rules for the harmonic oscillator are:\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n} + \\frac{\\Delta t^{2}}{2} a_{n} \\quad (1)$$\n$$v_{n+1} = v_{n} + \\frac{\\Delta t}{2} (a_{n} + a_{n+1}) \\quad (2)$$\nwith $a_n = -\\omega^2 x_n$.\n\nFrom (1), we can express the velocity $v_n$ in terms of positions at steps $n$ and $n+1$:\n$$ v_n = \\frac{x_{n+1} - x_n}{\\Delta t} - \\frac{\\Delta t}{2}a_n = \\frac{x_{n+1} - x_n}{\\Delta t} + \\frac{\\omega^2\\Delta t}{2} x_n \\quad (3) $$\nWe can get an expression for $v_{n-1}$ by shifting the index in (3):\n$$ v_{n-1} = \\frac{x_{n} - x_{n-1}}{\\Delta t} + \\frac{\\omega^2\\Delta t}{2} x_{n-1} \\quad (4) $$\nWe can also shift the velocity update rule (2) back one step:\n$$ v_n = v_{n-1} + \\frac{\\Delta t}{2}(a_{n-1} + a_n) \\quad (5) $$\nNow, substitute the expressions for $v_n$ (from eq. 3) and $v_{n-1}$ (from eq. 4) into the velocity update relation (eq. 5):\n$$ \\left( \\frac{x_{n+1} - x_n}{\\Delta t} + \\frac{\\omega^2 \\Delta t}{2} x_n \\right) = \\left( \\frac{x_{n} - x_{n-1}}{\\Delta t} + \\frac{\\omega^2 \\Delta t}{2} x_{n-1} \\right) + \\frac{\\Delta t}{2}(-\\omega^2 x_{n-1} - \\omega^2 x_n) $$\nTo simplify, we multiply the entire equation by $\\Delta t$:\n$$ (x_{n+1} - x_n) + \\frac{(\\omega \\Delta t)^2}{2} x_n = (x_{n} - x_{n-1}) + \\frac{(\\omega \\Delta t)^2}{2} x_{n-1} - \\frac{(\\omega \\Delta t)^2}{2} (x_{n-1} + x_n) $$\n$$ x_{n+1} - x_n + \\frac{(\\omega \\Delta t)^2}{2} x_n = x_{n} - x_{n-1} - \\frac{(\\omega \\Delta t)^2}{2} x_n $$\nWe rearrange the terms to group by $x_{n+1}$, $x_n$, and $x_{n-1}$:\n$$ x_{n+1} + \\left(-1 - 1 + \\frac{(\\omega \\Delta t)^2}{2} + \\frac{(\\omega \\Delta t)^2}{2}\\right)x_n + x_{n-1} = 0 $$\nThis simplifies to the three-term linear recurrence relation for the positions:\n$$ x_{n+1} - \\left(2 - (\\omega \\Delta t)^2\\right) x_n + x_{n-1} = 0 $$\nTo find the numerical frequency, we substitute the oscillatory ansatz $x_n = C e^{i n \\tilde{\\omega} \\Delta t}$:\n$$ e^{i\\tilde{\\omega}\\Delta t} - \\left(2 - (\\omega \\Delta t)^2\\right) + e^{-i\\tilde{\\omega}\\Delta t} = 0 $$\nUsing Euler's identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we get the dispersion relation:\n$$ 2\\cos(\\tilde{\\omega}\\Delta t) = 2 - (\\omega \\Delta t)^2 \\implies \\cos(\\tilde{\\omega}\\Delta t) = 1 - \\frac{(\\omega \\Delta t)^2}{2} $$\nWe solve for $\\tilde{\\omega}$ using the identity $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$:\n$$ 1 - 2\\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) = 1 - \\frac{(\\omega \\Delta t)^2}{2} \\implies \\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) = \\frac{\\omega \\Delta t}{2} $$\nThus, the numerical frequency is:\n$$ \\tilde{\\omega} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\nThis is the explicit expression for the numerical angular frequency. The stability condition $0 < \\omega \\Delta t < 2$ ensures the argument of $\\arcsin$ is in $(0, 1)$, yielding a real frequency.",
            "answer": "$$\\boxed{\\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega \\Delta t}{2}\\right)}$$"
        }
    ]
}