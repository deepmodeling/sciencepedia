{
    "hands_on_practices": [
        {
            "introduction": "分子动力学模拟的基石是数值积分算法的稳定性。本练习通过分析位置Verlet算法在简谐振子（一个代表了许多物理系统局部行为的经典模型）上的表现，来探讨这一核心概念。通过推导其放大矩阵并确定稳定性区域，你将掌握确定任何MD模拟中最大允许时间步长 $\\Delta t$ 的关键技术，以确保模拟结果的物理真实性。",
            "id": "4090835",
            "problem": "在计算复杂流体中线性化模式的分子动力学（MD）模拟的背景下，考虑一个单一的简正模，该模式被建模为由牛顿第二定律支配的一维谐振子，其运动方程为 $\\ddot{x}(t)=-\\omega^{2}x(t)$，其中 $\\omega>0$ 是模式频率。您将时间离散化为 $t_{n}=n\\,\\Delta t$，其中时间步长 $\\Delta t>0$ 为常数，并使用位置Verlet算法来积分动力学。\n\n仅从微分方程 $\\ddot{x}(t)=-\\omega^{2}x(t)$ 和标准的中心差分相容近似出发，完成以下任务：\n\n1. 推导与位置Verlet算法一致的、用 $x_{n}$ 和 $x_{n-1}$ 表示 $x_{n+1}$ 的显式两步递推关系。\n2. 引入状态向量 $\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}$ 并推导 $2\\times 2$ 的放大矩阵 $\\mathbf{A}$，使得 $\\mathbf{y}_{n+1}=\\mathbf{A}\\,\\mathbf{y}_{n}$，其中 $\\mathbf{A}$ 仅用无量纲参数 $q=\\Delta t\\,\\omega$ 表示。\n3. 使用线性常系数递推关系的线性稳定性第一性原理，确定在该谐振子上位置Verlet方法是线性稳定的关于 $q$ 的条件。然后，提取单个最大无量纲步长 $q_{\\max}$，使得对于所有 $0\\leq q\\leq q_{\\max}$，稳定性都成立。\n\n您的最终答案仅提供单个数字 $q_{\\max}$，不带单位。无需四舍五入；请提供精确值。",
            "solution": "我们从一维谐振子的牛顿第二定律开始，\n$$\n\\ddot{x}(t)=-\\omega^{2}x(t),\n$$\n其中 $\\omega>0$ 且时间步长 $\\Delta t>0$ 为常数。位置Verlet算法可以通过对二阶导数使用中心差分得到，这是一种标准的、对称的、二阶精确的近似方法。具体来说，我们将 $x(t)$ 在 $t_{n}$ 附近进行泰勒级数展开：\n$$\nx(t_{n}\\pm \\Delta t)=x_{n}\\pm \\Delta t\\,\\dot{x}_{n}+\\frac{\\Delta t^{2}}{2}\\,\\ddot{x}_{n}\\pm \\frac{\\Delta t^{3}}{6}\\,\\dddot{x}_{n}+\\frac{\\Delta t^{4}}{24}\\,x^{(4)}_{n}+\\cdots,\n$$\n其中 $x_{n}=x(t_{n})$，$\\dot{x}_{n}=\\dot{x}(t_{n})$，以此类推。将 $t_{n}+\\Delta t$ 和 $t_{n}-\\Delta t$ 处的展开式相加，可以消去奇数阶导数，得到中心差分恒等式\n$$\nx_{n+1}-2x_{n}+x_{n-1}=\\Delta t^{2}\\,\\ddot{x}_{n}+\\mathcal{O}(\\Delta t^{4}).\n$$\n将运动方程 $\\ddot{x}_{n}=-\\omega^{2}x_{n}$ 代入此恒等式，得到标准的位置Verlet两步递推关系\n$$\nx_{n+1}=2x_{n}-x_{n-1}-\\omega^{2}\\Delta t^{2}\\,x_{n}.\n$$\n引入无量纲参数 $q=\\Delta t\\,\\omega$。则更新可以写为\n$$\nx_{n+1}=(2-q^{2})\\,x_{n}-x_{n-1}.\n$$\n定义状态向量\n$$\n\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\n则\n$$\n\\mathbf{y}_{n+1}=\\begin{pmatrix}x_{n+1}\\\\ x_{n}\\end{pmatrix}=\\begin{pmatrix}(2-q^{2})\\,x_{n}-x_{n-1}\\\\ x_{n}\\end{pmatrix}=\\underbrace{\\begin{pmatrix}2-q^{2}  -1\\\\ 1  0\\end{pmatrix}}_{\\mathbf{A}(q)}\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\n因此，放大矩阵为\n$$\n\\mathbf{A}(q)=\\begin{pmatrix}2-q^{2}  -1\\\\ 1  0\\end{pmatrix}.\n$$\n为了分析线性稳定性，我们考虑 $\\mathbf{A}(q)$ 的特征值。其特征多项式为\n$$\n\\chi(\\lambda)=\\det\\!\\left(\\mathbf{A}-\\lambda\\mathbf{I}\\right)=\\det\\!\\begin{pmatrix}2-q^{2}-\\lambda  -1\\\\ 1  -\\lambda\\end{pmatrix}=(-\\lambda)(2-q^{2}-\\lambda)+1.\n$$\n展开得，\n$$\n\\chi(\\lambda)=\\lambda^{2}-(2-q^{2})\\,\\lambda+1.\n$$\n特征值 $\\lambda_{\\pm}$ 是以下方程的解\n$$\n\\lambda^{2}-(2-q^{2})\\,\\lambda+1=0.\n$$\n$\\mathbf{A}$ 的行列式是\n$$\n\\det\\mathbf{A}=1,\n$$\n这对于此线性系统而言是辛性的一个标志。递推关系的线性稳定性（对所有 $n$ 解有界）要求两个特征值都位于复平面的单位圆上或其内部。由于 $\\lambda_{+}\\lambda_{-}=1$，两个特征值的模都为 $1$ 的充分必要条件是迹满足\n$$\n\\left|\\frac{\\operatorname{tr}\\mathbf{A}}{2}\\right|\\leq 1.\n$$\n在这里，\n$$\n\\operatorname{tr}\\mathbf{A}=2-q^{2}.\n$$\n因此稳定性条件是\n$$\n\\left|\\frac{2-q^{2}}{2}\\right|\\leq 1.\n$$\n这个不等式可简化为\n$$\n-1\\leq \\frac{2-q^{2}}{2}\\leq 1\\quad\\Longleftrightarrow\\quad -2\\leq 2-q^{2}\\leq 2\\quad\\Longleftrightarrow\\quad 0\\leq q^{2}\\leq 4.\n$$\n由于根据定义 $q\\geq 0$，稳定性区间为\n$$\n0\\leq q\\leq 2.\n$$\n因此，确保线性稳定性的最大无量纲时间步长是\n$$\nq_{\\max}=2.\n$$\n因为这个值是精确的，所以不需要四舍五入。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在确保了积分算法的稳定性之后，我们自然会关心其精度。本练习通过推导位置Verlet格式的局部截断误差（LTE），让你深入理解数值解在单步积分中与真实解的偏离程度。掌握LTE的分析方法对于评估模拟的准确性以及理解时间步长如何影响结果的保真度至关重要。",
            "id": "4090824",
            "problem": "考虑一个质量为 $m$ 的单个粒子，在一个光滑势 $U(x)$ 下进行一维空间运动，该势代表了计算复杂流体中的介观相互作用。其动力学遵循牛顿第二定律 $m\\,\\ddot{x}(t) = -\\frac{dU}{dx}\\big(x(t)\\big)$，其中 $x(t)$ 是关于时间 $t$ 的四阶连续可微函数。在分子动力学（MD）中，一个广泛用于此类系统的二阶积分器是位置Verlet格式，它通过以下方式更新位置：\n$$\nx_{n+1} \\;=\\; 2\\,x_{n} \\;-\\; x_{n-1} \\;+\\; a\\big(x_{n}\\big)\\,\\Delta t^{2},\n$$\n其中 $x_n$ 表示 $x(t_n)$，$t_{n+1} = t_n + \\Delta t$，加速度 $a\\big(x_{n}\\big) = \\ddot{x}(t_{n}) = -\\frac{1}{m}\\frac{dU}{dx}\\big(x_{n}\\big)$。\n\n将在时间 $t_n$ 的位置更新的局部截断误差（LTE）定义为：当 $x_{n-1}$ 和 $x_n$ 精确时，由上述格式产生的离散更新值 $x_{n+1}$，与精确轨迹在 $t_n$ 点的泰勒级数展开并截断至 $\\Delta t$ 三阶项之间的差值。仅使用牛顿定律、$U(x)$ 的光滑性以及在 $t_n$ 点附近关于时间的泰勒展开，推导该局部截断误差的主阶解析表达式。请将最终答案表示为包含 $x^{(4)}(t_{n})$ 和 $\\Delta t$ 的封闭形式表达式。无需进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "局部截断误差 (LTE) 定义为数值更新值 $x_{n+1}$ 与在 $t_n$ 处展开并截断至三阶的精确泰勒级数 $x_{n+1}^{\\text{Taylor, 3rd}}$ 之间的差值。我们假设在计算更新时，$x_n$ 和 $x_{n-1}$ 是精确的，即它们位于真实轨迹上。\n\n1.  **展开Verlet更新表达式**\n    位置Verlet格式为 $x_{n+1} = 2x_n - x_{n-1} + a(x_n)\\Delta t^2$。根据运动方程，$a(x_n) = \\ddot{x}_n$。为了分析误差，我们将 $x_{n-1} = x(t_n - \\Delta t)$ 在 $t_n$ 点进行泰勒展开：\n    $$x_{n-1} = x_n - \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 - \\frac{1}{6}\\dddot{x}_n\\Delta t^3 + \\frac{1}{24}x^{(4)}_n\\Delta t^4 + O(\\Delta t^5)$$\n    将此展开代入Verlet公式：\n    $x_{n+1} = 2x_n - \\left(x_n - \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 - \\frac{1}{6}\\dddot{x}_n\\Delta t^3 + \\frac{1}{24}x^{(4)}_n\\Delta t^4 + \\dots\\right) + \\ddot{x}_n\\Delta t^2$\n    化简可得：\n    $$x_{n+1} = x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3 - \\frac{1}{24}x^{(4)}_n\\Delta t^4 + O(\\Delta t^5)$$\n\n2.  **写出截断的泰勒级数**\n    根据问题的定义，精确轨迹在 $t_{n+1}$ 的三阶截断泰勒级数为：\n    $$x_{n+1}^{\\text{Taylor, 3rd}} = x_n + \\dot{x}_n\\Delta t + \\frac{1}{2}\\ddot{x}_n\\Delta t^2 + \\frac{1}{6}\\dddot{x}_n\\Delta t^3$$\n\n3.  **计算LTE**\n    LTE定义为两者的差：\n    LTE = $x_{n+1} - x_{n+1}^{\\text{Taylor, 3rd}}$\n    LTE = $\\left(x_n + \\dot{x}_n\\Delta t + \\dots + \\frac{1}{6}\\dddot{x}_n\\Delta t^3 - \\frac{1}{24}x^{(4)}_n\\Delta t^4 + \\dots\\right) - \\left(x_n + \\dot{x}_n\\Delta t + \\dots + \\frac{1}{6}\\dddot{x}_n\\Delta t^3\\right)$\n    相减后，低阶项全部抵消，得到：\n    $$\\text{LTE} = -\\frac{1}{24}x^{(4)}(t_{n})\\Delta t^{4} + O(\\Delta t^5)$$\n    因此，主阶局部截断误差为 $-\\frac{1}{24}x^{(4)}(t_{n})\\Delta t^{4}$。",
            "answer": "$$\n\\boxed{-\\frac{1}{24}x^{(4)}(t_{n})\\Delta t^{4}}\n$$"
        },
        {
            "introduction": "虽然标准的二阶Verlet算法稳健可靠，但复杂的模拟任务往往需要更高的精度。本练习将向你介绍一种强大的技术——通过对称组合多个基本Verlet步骤来构建高阶积分器。通过分析一个四阶组合积分器，并将其稳定性与相同计算成本下的二阶方法进行比较，你将学会如何在精度和效率之间做出明智的权衡，这是设计高级MD模拟方案的一项核心技能。",
            "id": "4090831",
            "problem": "考虑一个单自由度谐振子，它代表计算复杂流体中的一个粗粒化珠子，其运动由牛顿第二定律 $m \\,\\ddot{x}(t) = -k \\,x(t)$ 决定，角频率为 $\\omega = \\sqrt{k/m}$。您将使用两种显式辛分子动力学（MD）方案来积分该系统，并评估它们的稳定性和能量行为。\n\n方案 A 是二阶速度 Verlet 算法。方案 B 是一个四阶组合 Verlet 积分器，通过对三个具有分数宏观步长 $a_{1} H$、$a_{2} H$、$a_{3} H$ 的速度 Verlet 子步骤进行对称组合（“三重跳跃”）构建而成，其中 $H$ 表示宏观步长，系数为\n$$\na_{1} \\;=\\; a_{3} \\;=\\; \\frac{1}{2 - 2^{1/3}}, \\qquad a_{2} \\;=\\; -\\,\\frac{2^{1/3}}{2 - 2^{1/3}}.\n$$\n假设每个速度 Verlet 子步骤需要进行一次力评估。将固定物理时间间隔内的“有效成本”定义为推进该时间间隔所需的总力评估次数。\n\n对于方案 A，在与方案 B 的一个宏观步骤相同的有效成本下，使用三个大小为 $H/3$ 的速度 Verlet 子步骤来推进相同的物理时间 $H$。\n\n从谐振子动力学和速度 Verlet 引起的离散更新出发，推导应用于谐振子的每个子步骤的线性稳定性条件。然后，利用组合步骤仅当其所有构成子步骤都稳定时才稳定的事实，确定方案 B 和等成本方案 A 的最大稳定宏观步长 $H$。最后，报告这些最大稳定宏观步长之比 $R$（等成本方案 A 除以方案 B）。\n\n以单一精确的封闭形式表达式给出您的最终 $R$。无需进行数值舍入。为了使您的推导完整，请简要论证两种方案对谐振子有界振荡的能量行为，并确定在等成本设置下，每种方案的能量振荡幅度对步长的主阶依赖关系，但不要将这些定性能量评估包含在您的最终数值答案中。",
            "solution": "该问题陈述经评估在科学上是合理的、适定的、客观且自洽的。它是分子动力学数值分析领域的标准问题，没有明显缺陷。因此，提供完整解答。\n\n问题要求分析用于单自由度谐振子的两种数值积分方案，其运动方程为 $m \\ddot{x}(t) = -k x(t)$。角频率为 $\\omega = \\sqrt{k/m}$。系统在任意时刻 $t$ 的状态可以用向量 $\\mathbf{z}(t) = (x(t), \\dot{x}(t))^T$ 来描述。\n\n首先，我们推导速度 Verlet 算法的线性稳定性条件，该算法是一种二阶辛积分器。对于大小为 $h$ 的时间步，该算法分两个阶段进行：\n1.  更新位置：$x(t+h) = x(t) + \\dot{x}(t)h + \\frac{1}{2}\\ddot{x}(t)h^2$。\n2.  更新速度：$\\dot{x}(t+h) = \\dot{x}(t) + \\frac{1}{2}(\\ddot{x}(t) + \\ddot{x}(t+h))h$。\n\n对于谐振子，加速度为 $\\ddot{x}(t) = - \\omega^2 x(t)$。设第 $n$ 步的状态为 $\\mathbf{z}_n = (x_n, \\dot{x}_n)^T$。更新方程变为：\n$x_{n+1} = x_n + h \\dot{x}_n + \\frac{1}{2}(-\\omega^2 x_n)h^2 = (1 - \\frac{\\omega^2 h^2}{2})x_n + h \\dot{x}_n$。\n\n使用新位置 $x_{n+1}$，新加速度为 $\\ddot{x}_{n+1} = -\\omega^2 x_{n+1}$。速度更新为：\n$\\dot{x}_{n+1} = \\dot{x}_n + \\frac{h}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) = \\dot{x}_n - \\frac{\\omega^2 h}{2}x_n - \\frac{\\omega^2 h}{2} \\left[ (1 - \\frac{\\omega^2 h^2}{2})x_n + h \\dot{x}_n \\right]$\n$\\dot{x}_{n+1} = \\left( -\\frac{\\omega^2 h}{2} - \\frac{\\omega^2 h}{2}(1 - \\frac{\\omega^2 h^2}{2}) \\right)x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n$\n$\\dot{x}_{n+1} = \\left( -\\omega^2 h + \\frac{\\omega^4 h^3}{4} \\right)x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n = -\\omega^2 h(1 - \\frac{\\omega^2 h^2}{4})x_n + (1 - \\frac{\\omega^2 h^2}{2})\\dot{x}_n$。\n\n这个线性映射可以写成 $\\mathbf{z}_{n+1} = M(h)\\mathbf{z}_n$，其中 $M(h)$ 是大小为 $h$ 的单步传递矩阵：\n$$\nM(h) = \\begin{pmatrix}\n1 - \\frac{\\omega^2 h^2}{2} & h \\\\\n-\\omega^2 h(1 - \\frac{\\omega^2 h^2}{4}) & 1 - \\frac{\\omega^2 h^2}{2}\n\\end{pmatrix}\n$$\n如果 $M(h)$ 的特征值的模小于或等于 1，则积分器是稳定的。特征值 $\\lambda$ 可从特征方程 $\\lambda^2 - \\text{Tr}(M)\\lambda + \\det(M) = 0$ 中求得。\n迹为 $\\text{Tr}(M) = 2 - \\omega^2 h^2$。\n行列式为 $\\det(M) = (1 - \\frac{\\omega^2 h^2}{2})^2 + \\omega^2 h^2(1 - \\frac{\\omega^2 h^2}{4}) = 1 - \\omega^2 h^2 + \\frac{\\omega^4 h^4}{4} + \\omega^2 h^2 - \\frac{\\omega^4 h^4}{4} = 1$。\n$\\det(M)=1$ 这一事实是辛积分器应用于线性哈密顿系统的特征。\n\n特征值是 $\\lambda^2 - (2 - \\omega^2 h^2)\\lambda + 1 = 0$ 的根。对于稳定、振荡（非发散）的解，特征值必须是单位圆上的一对共轭复数。这要求二次方程的判别式为非正：\n$(\\text{Tr}(M))^2 - 4\\det(M) \\le 0$\n$(2 - \\omega^2 h^2)^2 - 4 \\le 0 \\implies |2 - \\omega^2 h^2| \\le 2$。\n这导致不等式 $-2 \\le 2 - \\omega^2 h^2 \\le 2$。\n右侧，$2 - \\omega^2 h^2 \\le 2$，意味着 $-\\omega^2 h^2 \\le 0$，这总是成立的。\n左侧，$-2 \\le 2 - \\omega^2 h^2$，意味着 $\\omega^2 h^2 \\le 4$。\n由于 $\\omega > 0$ 且步长 $h$ 必须为正，因此大小为 $h$ 的单次速度 Verlet 步骤的稳定性条件是 $\\omega h \\le 2$。对于负步长，如方案 B 中所示，该条件适用于步长的绝对值，即 $\\omega |h| \\le 2$。\n\n现在我们分析这两种方案。\n\n方案 A（等成本）：\n该方案使用三个大小均为 $h_A = H/3$ 的相同速度 Verlet 子步骤，在一个宏观步长 $H$ 内推进系统。为使整个方案稳定，每个子步骤都必须稳定。条件是：\n$\\omega h_A \\le 2 \\implies \\omega (H/3) \\le 2 \\implies \\omega H \\le 6$。\n因此，方案 A 的最大稳定宏观步长由 $\\omega H_{\\text{max, A}} = 6$ 给出。\n\n方案 B：\n该方案是三个速度 Verlet 子步骤的对称组合，步长分别为 $h_1 = a_1 H$、$h_2 = a_2 H$ 和 $h_3 = a_3 H$。给定的系数是：\n$a_1 = a_3 = \\frac{1}{2 - 2^{1/3}}$\n$a_2 = -\\frac{2^{1/3}}{2 - 2^{1/3}}$\n由于 $1  2^{1/3}  2$，分母 $2 - 2^{1/3}$ 是正的。因此，$a_1$ 和 $a_3$ 是正的，而 $a_2$ 是负的。\n为使组合步骤稳定，每个构成子步骤都必须稳定。我们将稳定性条件应用于每个子步骤大小的绝对值：\n1. $\\omega|h_1| = \\omega a_1 H \\le 2 \\implies \\omega H \\le \\frac{2}{a_1}$\n2. $\\omega|h_2| = \\omega |a_2| H \\le 2 \\implies \\omega H \\le \\frac{2}{|a_2|}$\n3. $\\omega|h_3| = \\omega a_3 H \\le 2 \\implies \\omega H \\le \\frac{2}{a_3}$\n\n为了同时满足所有三个条件，$\\omega H$ 必须小于或等于这三个界限中的最小值。我们比较系数的绝对值：\n$|a_1| = |a_3| = \\frac{1}{2 - 2^{1/3}}$\n$|a_2| = \\frac{2^{1/3}}{2 - 2^{1/3}}$\n由于 $2^{1/3}  1$，很明显 $|a_2|  |a_1|$。因此，最严格的条件是涉及 $|a_2|$ 的那个，因为它对应于绝对值最大的子步骤。\n方案 B 的稳定性极限由该子步骤设定：\n$\\omega H_{\\text{max, B}} = \\frac{2}{|a_2|} = \\frac{2}{\\frac{2^{1/3}}{2 - 2^{1/3}}} = \\frac{2(2 - 2^{1/3})}{2^{1/3}}$。\n\n最后，我们计算最大稳定宏观步长之比 $R$：\n$R = \\frac{H_{\\text{max, A}}}{H_{\\text{max, B}}} = \\frac{\\omega H_{\\text{max, A}}}{\\omega H_{\\text{max, B}}} = \\frac{6}{\\frac{2(2 - 2^{1/3})}{2^{1/3}}}$。\n$R = \\frac{6 \\cdot 2^{1/3}}{2(2 - 2^{1/3})} = \\frac{3 \\cdot 2^{1/3}}{2 - 2^{1/3}}$。\n\n为完整起见，我们讨论能量行为。两种方案都是速度 Verlet 算法的组合，而速度 Verlet 算法是辛的。对于哈密顿系统，辛积分器不完全守恒能量 $E$，但它们确实守恒一个附近的“影子哈密顿量” $H_{shadow}$。这意味着真实能量 $E$ 不会表现出长期漂移，而是进行有界振荡。\n方案 A 包括三次应用一个二阶积分器，整个宏观步骤仍然是二阶精确的。影子哈密顿量为 $H_{shadow,A} = E + \\mathcal{O}(H^2)$。因此，能量振荡的幅度按 $\\mathcal{O}(H^2)$ 比例变化。\n方案 B 是一个著名的通过对称组合构造的四阶积分器。其影子哈密顿量为 $H_{shadow,B} = E + \\mathcal{O}(H^4)$，其能量振荡的幅度按 $\\mathcal{O}(H^4)$ 比例变化。对于小的 $H$，方案 B 在相同的计算成本下提供了显著更优的能量守恒性。",
            "answer": "$$\n\\boxed{\\frac{3 \\cdot 2^{1/3}}{2 - 2^{1/3}}}\n$$"
        }
    ]
}