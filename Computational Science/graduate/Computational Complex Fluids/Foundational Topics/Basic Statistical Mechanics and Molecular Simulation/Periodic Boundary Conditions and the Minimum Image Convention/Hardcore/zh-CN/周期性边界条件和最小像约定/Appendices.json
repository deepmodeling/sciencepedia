{
    "hands_on_practices": [
        {
            "introduction": "应用最小镜像约定始于掌握最简单几何形状下的基本计算。第一个练习聚焦于正交（orthorhombic）模拟盒子，其正交的晶格矢量使得我们可以直接对每个分量独立地应用“包裹”原则，从而找到两个粒子间的最短距离 。完成这个练习将为处理更复杂的场景打下坚实的基础。",
            "id": "3830822",
            "problem": "考虑一个具有周期性边界条件（PBC）的三维正交模拟晶胞，这意味着该晶胞在所有方向上被概念性地复制，因此任何点 $\\mathbf{r}$ 在物理上都等同于 $\\mathbf{r} + n_{x} L_{x} \\hat{\\mathbf{x}} + n_{y} L_{y} \\hat{\\mathbf{y}} + n_{z} L_{z} \\hat{\\mathbf{z}}$，其中 $n_{x}$、$n_{y}$ 和 $n_{z}$ 为任意整数。最小镜像约定（MIC）规定，在评估短程对相互作用时，两个粒子间的相关位移是所有周期性镜像中欧几里得范数最小的矢量。设晶胞边长为 $L_{x} = 3.6\\,\\mathrm{nm}$、$L_{y} = 4.2\\,\\mathrm{nm}$ 和 $L_{z} = 5.0\\,\\mathrm{nm}$。两个粒子位于主晶胞内的笛卡尔坐标位置 $\\mathbf{r}_{1} = (0.5\\,\\mathrm{nm},\\, 3.9\\,\\mathrm{nm},\\, 4.8\\,\\mathrm{nm})$ 和 $\\mathbf{r}_{2} = (3.4\\,\\mathrm{nm},\\, 0.6\\,\\mathrm{nm},\\, 0.4\\,\\mathrm{nm})$。假设对势在截断半径 $r_{c} = 1.30\\,\\mathrm{nm}$ 处被截断，因此当且仅当两个粒子的最小镜像距离小于或等于 $r_{c}$ 时，它们之间才发生相互作用。\n\n仅从 PBC、欧几里得范数和 MIC 作为最短周期位移选择的定义出发，推导最小镜像位移矢量 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 及其大小 $r_{\\mathrm{MIC}}$，并确定相互作用指示符 $I$。如果 $r_{\\mathrm{MIC}} \\le r_{c}$，则定义 $I = 1$，否则 $I = 0$。将 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的所有分量和 $r_{\\mathrm{MIC}}$ 四舍五入到五位有效数字。以纳米为单位表示位移分量和距离。将最终答案以单行矩阵的形式给出，其中依次包含 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的三个分量、标量距离 $r_{\\mathrm{MIC}}$ 和指示符 $I$。",
            "solution": "该问题要求计算在具有周期性边界条件（PBC）的三维正交模拟晶胞中，两个粒子的最小镜像位移矢量、其大小以及相互作用指示符。\n\n首先，从问题陈述中提取给定的参数：\n模拟晶胞边长为 $L_{x} = 3.6\\,\\mathrm{nm}$、$L_{y} = 4.2\\,\\mathrm{nm}$ 和 $L_{z} = 5.0\\,\\mathrm{nm}$。\n两个粒子的位置为 $\\mathbf{r}_{1} = (0.5,\\, 3.9,\\, 4.8)\\,\\mathrm{nm}$ 和 $\\mathbf{r}_{2} = (3.4,\\, 0.6,\\, 0.4)\\,\\mathrm{nm}$。\n相互作用截断半径为 $r_{c} = 1.30\\,\\mathrm{nm}$。\n如果最小镜像距离 $r_{\\mathrm{MIC}} \\le r_{c}$，则相互作用指示符为 $I=1$，否则为 $I=0$。\n\n从粒子1到粒子2在主晶胞中的位移矢量计算为 $\\Delta \\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$。\n设 $\\mathbf{r}_{1}$ 的分量为 $(x_1, y_1, z_1)$，$\\mathbf{r}_{2}$ 的分量为 $(x_2, y_2, z_2)$。\n位移矢量 $\\Delta \\mathbf{r} = (\\Delta x, \\Delta y, \\Delta z)$ 的分量为：\n$$\n\\Delta x = x_{2} - x_{1} = 3.4\\,\\mathrm{nm} - 0.5\\,\\mathrm{nm} = 2.9\\,\\mathrm{nm}\n$$\n$$\n\\Delta y = y_{2} - y_{1} = 0.6\\,\\mathrm{nm} - 3.9\\,\\mathrm{nm} = -3.3\\,\\mathrm{nm}\n$$\n$$\n\\Delta z = z_{2} - z_{1} = 0.4\\,\\mathrm{nm} - 4.8\\,\\mathrm{nm} = -4.4\\,\\mathrm{nm}\n$$\n因此，初始位移矢量为 $\\Delta \\mathbf{r} = (2.9,\\, -3.3,\\, -4.4)\\,\\mathrm{nm}$。\n\n由于 PBC，粒子2在位置 $\\mathbf{r}_{2, \\mathbf{n}} = \\mathbf{r}_{2} + n_{x} L_{x} \\hat{\\mathbf{x}} + n_{y} L_{y} \\hat{\\mathbf{y}} + n_{z} L_{z} \\hat{\\mathbf{z}}$ 处有无穷多个周期性镜像，其中 $n_x, n_y, n_z$ 为任意整数。从粒子1到这些镜像中任意一个的位移矢量为 $\\Delta \\mathbf{r}_{\\mathbf{n}} = \\mathbf{r}_{2, \\mathbf{n}} - \\mathbf{r}_{1} = \\Delta \\mathbf{r} + (n_x L_x, n_y L_y, n_z L_z)$。最小镜像约定（MIC）要求我们找到具有最小欧几里得范数的矢量 $\\Delta \\mathbf{r}_{\\mathbf{n}}$。范数的平方为 $\\|\\Delta \\mathbf{r}_{\\mathbf{n}}\\|^2 = (\\Delta x + n_x L_x)^2 + (\\Delta y + n_y L_y)^2 + (\\Delta z + n_z L_z)^2$。由于各项是独立的，我们可以分别最小化每个分量的贡献。\n\n对于每个分量 $\\alpha \\in \\{x, y, z\\}$，最小镜像位移分量 $\\Delta \\alpha_{\\mathrm{MIC}}$ 必须满足条件 $|\\Delta \\alpha_{\\mathrm{MIC}}| \\le \\frac{L_{\\alpha}}{2}$。这可以通过加或减晶胞长度 $L_{\\alpha}$ 所需的次数，将分量带入范围 $[-\\frac{L_{\\alpha}}{2}, \\frac{L_{\\alpha}}{2}]$ 来实现。对于分量 $\\Delta \\alpha$，一个常见的实现方法是：\n- 如果 $\\Delta \\alpha  \\frac{L_{\\alpha}}{2}$，则 $\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha - L_{\\alpha}$。\n- 如果 $\\Delta \\alpha  -\\frac{L_{\\alpha}}{2}$，则 $\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha + L_{\\alpha}$。\n- 否则，$\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha$。\n\n让我们将此应用于 $\\Delta \\mathbf{r}$ 的每个分量。\n\n对于 $x$ 分量：\n半盒长度为 $\\frac{L_{x}}{2} = \\frac{3.6}{2} = 1.8\\,\\mathrm{nm}$。\n位移分量为 $\\Delta x = 2.9\\,\\mathrm{nm}$。\n由于 $\\Delta x = 2.9\\,\\mathrm{nm}  1.8\\,\\mathrm{nm}$，我们减去 $L_x$。\n$$\n\\Delta x_{\\mathrm{MIC}} = \\Delta x - L_{x} = 2.9 - 3.6 = -0.7\\,\\mathrm{nm}\n$$\n\n对于 $y$ 分量：\n半盒长度为 $\\frac{L_{y}}{2} = \\frac{4.2}{2} = 2.1\\,\\mathrm{nm}$。\n位移分量为 $\\Delta y = -3.3\\,\\mathrm{nm}$。\n由于 $\\Delta y = -3.3\\,\\mathrm{nm}  -2.1\\,\\mathrm{nm}$，我们加上 $L_y$。\n$$\n\\Delta y_{\\mathrm{MIC}} = \\Delta y + L_{y} = -3.3 + 4.2 = 0.9\\,\\mathrm{nm}\n$$\n\n对于 $z$ 分量：\n半盒长度为 $\\frac{L_{z}}{2} = \\frac{5.0}{2} = 2.5\\,\\mathrm{nm}$。\n位移分量为 $\\Delta z = -4.4\\,\\mathrm{nm}$。\n由于 $\\Delta z = -4.4\\,\\mathrm{nm}  -2.5\\,\\mathrm{nm}$，我们加上 $L_z$。\n$$\n\\Delta z_{\\mathrm{MIC}} = \\Delta z + L_{z} = -4.4 + 5.0 = 0.6\\,\\mathrm{nm}\n$$\n\n因此，最小镜像位移矢量为 $\\Delta \\mathbf{r}_{\\mathrm{MIC}} = (-0.7,\\, 0.9,\\, 0.6)\\,\\mathrm{nm}$。将这些分量四舍五入到五位有效数字，得到 $\\Delta x_{\\mathrm{MIC}} = -0.70000\\,\\mathrm{nm}$、$\\Delta y_{\\mathrm{MIC}} = 0.90000\\,\\mathrm{nm}$ 和 $\\Delta z_{\\mathrm{MIC}} = 0.60000\\,\\mathrm{nm}$。\n\n接下来，我们计算该矢量的大小，即最小镜像距离 $r_{\\mathrm{MIC}}$。\n$$\nr_{\\mathrm{MIC}} = \\|\\Delta \\mathbf{r}_{\\mathrm{MIC}}\\| = \\sqrt{(\\Delta x_{\\mathrm{MIC}})^2 + (\\Delta y_{\\mathrm{MIC}})^2 + (\\Delta z_{\\mathrm{MIC}})^2}\n$$\n$$\nr_{\\mathrm{MIC}} = \\sqrt{(-0.7)^2 + (0.9)^2 + (0.6)^2} = \\sqrt{0.49 + 0.81 + 0.36} = \\sqrt{1.66}\\,\\mathrm{nm}\n$$\n数值上，$r_{\\mathrm{MIC}} \\approx 1.28840987... \\,\\mathrm{nm}$。\n四舍五入到五位有效数字，我们得到 $r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$。\n\n最后，我们通过将 $r_{\\mathrm{MIC}}$ 与截断半径 $r_{c} = 1.30\\,\\mathrm{nm}$ 进行比较来确定相互作用指示符 $I$。\n相互作用的条件是 $r_{\\mathrm{MIC}} \\le r_{c}$。\n我们有 $r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$ 和 $r_{c} = 1.30\\,\\mathrm{nm}$。由于 $1.2884 \\le 1.30$，该条件满足。\n因此，相互作用指示符为 $I = 1$。\n\n所要求的结果是 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的分量、其大小 $r_{\\mathrm{MIC}}$ 和指示符 $I$。\n$\\Delta x_{\\mathrm{MIC}} = -0.70000\\,\\mathrm{nm}$\n$\\Delta y_{\\mathrm{MIC}} = 0.90000\\,\\mathrm{nm}$\n$\\Delta z_{\\mathrm{MIC}} = 0.60000\\,\\mathrm{nm}$\n$r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$\n$I = 1$\n这些结果将以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.70000  0.90000  0.60000  1.2884  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然对于正交盒子而言，简单的笛卡尔坐标分量包裹法直观有效，但这种方法在倾斜的三斜（triclinic）体系中会完全失效。本问题提供了一个具体的反例来阐明这一常见陷阱，并引导我们转向基于分数坐标的更通用、更稳健的方法 。理解这一区别对于开发能够处理任意晶胞几何形状的可靠模拟工具至关重要。",
            "id": "2793940",
            "problem": "考虑一个由三斜布拉菲晶格定义的三维周期性模拟晶胞，其晶胞矩阵为 $\\mathbf{H}$，该矩阵的列是笛卡尔坐标系中的晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$。设\n$$\n\\mathbf{a}=\\begin{pmatrix}10 \\\\ 0 \\\\ 0\\end{pmatrix},\\quad\n\\mathbf{b}=\\begin{pmatrix}9.8 \\\\ 1.0 \\\\ 0\\end{pmatrix},\\quad\n\\mathbf{c}=\\begin{pmatrix}9.8 \\\\ 0.2 \\\\ 1.0\\end{pmatrix}\\ \\text{(所有分量单位为 \\AA)}.\n$$\n两个粒子的分数坐标（也称为简约坐标）$\\mathbf{s}_{1}=\\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $\\mathbf{s}_{2}=\\begin{pmatrix}0.02 \\\\ 0.6 \\\\ 0\\end{pmatrix}$ 是相对于 $\\mathbf{H}$ 的，因此它们的笛卡尔坐标位置为 $\\mathbf{r}_{i}=\\mathbf{H}\\,\\mathbf{s}_{i}$。在周期性边界条件下，分离矢量 $\\mathbf{r}=\\mathbf{r}_{2}-\\mathbf{r}_{1}$ 的最小镜像从第一性原理定义为\n$$\n\\mathbf{r}_{\\mathrm{mic}}=\\operatorname*{arg\\,min}_{\\mathbf{n}\\in\\mathbb{Z}^{3}}\\left\\|\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}\\right\\|_{2},\n$$\n即，集合 $\\{\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}:\\mathbf{n}\\in\\mathbb{Z}^{3}\\}$ 中具有最小欧几里得长度的唯一成员。\n\n在倾斜晶胞中，一种常用但错误的启发式方法是在笛卡尔坐标系中进行“卷绕”，即使用从 $\\mathbf{H}$ 的上三角形式中获得的对角线长度 $L_{x},L_{y},L_{z}$（即 $L_{x}=a_{x}$，$L_{y}=b_{y}$，$L_{z}=c_{z}$）进行分量逐一舍入。在此晶胞中，$L_{x}=10$，$L_{y}=1$，$L_{z}=1$（单位为 \\AA）。这种朴素的笛卡尔卷绕将笛卡尔矢量 $\\mathbf{r}=(r_{x},r_{y},r_{z})^{\\top}$ 映射为\n$$\n\\mathbf{r}_{\\mathrm{naive}}=\\begin{pmatrix}\nr_{x}-L_{x}\\,\\mathrm{nint}\\!\\left(\\frac{r_{x}}{L_{x}}\\right)\\\\[4pt]\nr_{y}-L_{y}\\,\\mathrm{nint}\\!\\left(\\frac{r_{y}}{L_{y}}\\right)\\\\[4pt]\nr_{z}-L_{z}\\,\\mathrm{nint}\\!\\left(\\frac{r_{z}}{L_{z}}\\right)\n\\end{pmatrix},\n$$\n其中 $\\mathrm{nint}(\\cdot)$ 表示四舍五入到最近的整数。\n\n仅从上述定义出发，完成以下操作：\n\n1) 通过将 $\\mathbf{r}$ 表示为分数坐标 $\\mathbf{s}=\\mathbf{H}^{-1}\\mathbf{r}$，将 $\\mathbf{s}$ 通过分量逐一减去最近整数以简化到中心晶胞得到 $\\mathbf{s}'=\\mathbf{s}-\\mathrm{nint}(\\mathbf{s})$，然后通过 $\\mathbf{r}_{\\mathrm{mic}}=\\mathbf{H}\\,\\mathbf{s}'$ 映射回笛卡尔坐标，推导出正确的倾斜晶胞最小镜像映射。\n\n2) 对于给定的 $\\mathbf{H}$ 和 $\\mathbf{s}_{1},\\mathbf{s}_{2}$，计算具体的笛卡尔矢量 $\\mathbf{r}$、$\\mathbf{r}_{\\mathrm{mic}}$ 及其欧几里得长度。\n\n3) 使用上述规则以及 $L_{x}=10$，$L_{y}=1$，$L_{z}=1$ 计算朴素的笛卡尔卷绕矢量 $\\mathbf{r}_{\\mathrm{naive}}$ 及其欧几里得长度。\n\n4) 解释为什么当 $\\mathbf{H}$ 是倾斜的时，$\\mathbf{r}_{\\mathrm{naive}}$ 不保证对于任何 $\\mathbf{n}\\in\\mathbb{Z}^{3}$ 都等于 $\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}$，并对此示例进行明确验证，证明在 $\\mathbf{n}\\in\\mathbb{Z}^{3}$ 上的真正最小值是由步骤 1) 中规定的选择所达到的。\n\n5) 定义距离误差 $\\delta=\\|\\mathbf{r}_{\\mathrm{naive}}\\|_{2}-\\|\\mathbf{r}_{\\mathrm{mic}}\\|_{2}$。计算此情况下的 $\\delta$。\n\n以 \\AA\\ 为单位表示 $\\delta$ 的最终答案，并将答案四舍五入至四位有效数字。",
            "solution": "所提出的问题具有科学依据，表述清晰且客观。它涉及理论化学和凝聚态物理中计算方法的一个基本且不平凡的方面，即对于一般三斜模拟晶胞的最小镜像约定的正确实现。唯一解所需的所有数据和定义都已提供，并且没有内部矛盾或逻辑缺陷。因此，该问题是有效的，我将着手解决它。\n\n解答按照问题陈述要求的五个部分进行组织。\n\n1) 推导正确的倾斜晶胞最小镜像映射。\n最小镜像约定旨在找到连接两个粒子的最短矢量，同时考虑它们所有的周期性镜像。粒子 2 和粒子 1 之间的分离矢量是 $\\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$。此分离矢量的所有周期性镜像集合由 $\\{\\mathbf{r} - \\mathbf{H}\\mathbf{n} : \\mathbf{n} \\in \\mathbb{Z}^3\\}$ 给出，其中 $\\mathbf{H}$ 是晶胞矩阵，$\\mathbf{n}$ 是一个由三个整数组成的矢量。最小镜像矢量 $\\mathbf{r}_{\\mathrm{mic}}$ 是该集合中具有最小欧几里得范数的唯一矢量。\n\n正确的过程避免在笛卡尔坐标系中直接操作，因为除非晶胞是正交的，否则笛卡尔坐标系不适应晶格的周期性。相反，必须在分数坐标空间中工作，那里的周期性很简单。\n\n令 $\\mathbf{s} = \\mathbf{H}^{-1}\\mathbf{r}$ 为以分数坐标表示的分离矢量。$\\mathbf{s}$ 的分量，记为 $s_i$，表示沿晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 的位移。\n在这个分数坐标空间中，原点的周期性镜像位于所有整数坐标 $\\mathbf{n} \\in \\mathbb{Z}^3$ 处。为了找到最接近原点的 $\\mathbf{s}$ 的镜像，我们只需为 $\\mathbf{s}$ 的每个分量找到最近的整数。这个操作由最近整数函数 $\\mathrm{nint}(\\cdot)$ 表示。\n令 $\\mathbf{n}_{\\mathrm{mic}} = \\mathrm{nint}(\\mathbf{s})$，其中函数是逐分量应用的。这个整数矢量 $\\mathbf{n}_{\\mathrm{mic}}$ 定义了将 $\\mathbf{s}$ 带入中心模拟晶胞所需的平移，中心模拟晶胞通常配置为分数坐标晶格的维格纳-赛兹原胞，即 $[ -0.5, 0.5 )^3$。\n简约后的分数矢量是 $\\mathbf{s}' = \\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}}$。根据构造，$\\mathbf{s}'$ 的每个分量 $s'_i$ 都位于区间 $[-0.5, 0.5)$ 内。\n\n最后，这个简约后的分数矢量 $\\mathbf{s}'$ 被映射回笛卡尔坐标，以获得最小镜像矢量：\n$$\n\\mathbf{r}_{\\mathrm{mic}} = \\mathbf{H}\\mathbf{s}' = \\mathbf{H}(\\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}}) = \\mathbf{H}(\\mathbf{H}^{-1}\\mathbf{r} - \\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r})) = \\mathbf{r} - \\mathbf{H}\\,\\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r}).\n$$\n这是三斜晶胞的正确通用映射。使距离最小化的整数矢量是 $\\mathbf{n} = \\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r})$。\n\n2) 计算 $\\mathbf{r}$、$\\mathbf{r}_{\\mathrm{mic}}$ 及其长度。\n给定的是由列矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 组成的晶胞矩阵 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\begin{pmatrix} 10  9.8  9.8 \\\\ 0  1.0  0.2 \\\\ 0  0  1.0 \\end{pmatrix}\n$$\n以及分数坐标 $\\mathbf{s}_{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 和 $\\mathbf{s}_{2} = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。\n\n笛卡尔坐标中的初始分离矢量是 $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$。由于 $\\mathbf{s}_1$ 是原点，$\\mathbf{r}_1 = \\mathbf{H}\\mathbf{s}_1 = \\mathbf{0}$，因此 $\\mathbf{r} = \\mathbf{r}_2$。\n$$\n\\mathbf{r} = \\mathbf{H}\\mathbf{s}_2 = \\begin{pmatrix} 10  9.8  9.8 \\\\ 0  1.0  0.2 \\\\ 0  0  1.0 \\end{pmatrix} \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix} = 0.02\\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix} + 0.6\\begin{pmatrix} 9.8 \\\\ 1.0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 5.88 \\\\ 0.6 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 6.08 \\\\ 0.6 \\\\ 0 \\end{pmatrix}.\n$$\n$\\mathbf{r}$ 的欧几里得长度平方为 $\\|\\mathbf{r}\\|_2^2 = 6.08^2 + 0.6^2 + 0^2 = 36.9664 + 0.36 = 37.3264$。\n长度为 $\\|\\mathbf{r}\\|_2 = \\sqrt{37.3264} \\approx 6.1095\\ \\text{\\AA}$。\n\n为了计算 $\\mathbf{r}_{\\mathrm{mic}}$，我们遵循第 1 部分的步骤。分数分离矢量是 $\\mathbf{s} = \\mathbf{s}_2 - \\mathbf{s}_1 = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。\n我们找到最近的整数矢量：$\\mathbf{n}_{\\mathrm{mic}} = \\mathrm{nint}(\\mathbf{s}) = \\begin{pmatrix} \\mathrm{nint}(0.02) \\\\ \\mathrm{nint}(0.6) \\\\ \\mathrm{nint}(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n简约后的分数矢量是 $\\mathbf{s}' = \\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。\n最后，我们将 $\\mathbf{s}'$ 映射回笛卡尔坐标：\n$$\n\\mathbf{r}_{\\mathrm{mic}} = \\mathbf{H}\\mathbf{s}' = \\begin{pmatrix} 10  9.8  9.8 \\\\ 0  1.0  0.2 \\\\ 0  0  1.0 \\end{pmatrix} \\begin{pmatrix} 0.02 \\\\ -0.4 \\\\ 0 \\end{pmatrix} = 0.02\\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix} - 0.4\\begin{pmatrix} 9.8 \\\\ 1.0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 3.92 \\\\ 0.4 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3.72 \\\\ -0.4 \\\\ 0 \\end{pmatrix}.\n$$\n欧几里得长度平方为 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2^2 = (-3.72)^2 + (-0.4)^2 + 0^2 = 13.8384 + 0.16 = 13.9984$。\n长度为 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2 = \\sqrt{13.9984} \\approx 3.7414\\ \\text{\\AA}$。\n\n3) 计算朴素的笛卡尔卷绕矢量 $\\mathbf{r}_{\\mathrm{naive}}$ 及其长度。\n朴素方法使用上三角晶胞矩阵的对角元素，$L_x=10$，$L_y=1$，$L_z=1$。它逐分量地卷绕笛卡尔矢量 $\\mathbf{r} = \\begin{pmatrix} 6.08 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。\n$$\nr_{\\mathrm{naive}, x} = r_x - L_x\\,\\mathrm{nint}\\!\\left(\\frac{r_x}{L_x}\\right) = 6.08 - 10\\,\\mathrm{nint}\\!\\left(\\frac{6.08}{10}\\right) = 6.08 - 10\\,\\mathrm{nint}(0.608) = 6.08 - 10(1) = -3.92.\n$$\n$$\nr_{\\mathrm{naive}, y} = r_y - L_y\\,\\mathrm{nint}\\!\\left(\\frac{r_y}{L_y}\\right) = 0.6 - 1\\,\\mathrm{nint}\\!\\left(\\frac{0.6}{1}\\right) = 0.6 - 1\\,\\mathrm{nint}(0.6) = 0.6 - 1(1) = -0.4.\n$$\n$$\nr_{\\mathrm{naive}, z} = r_z - L_z\\,\\mathrm{nint}\\!\\left(\\frac{r_z}{L_z}\\right) = 0 - 1\\,\\mathrm{nint}\\!\\left(\\frac{0}{1}\\right) = 0 - 1(0) = 0.\n$$\n因此，$\\mathbf{r}_{\\mathrm{naive}} = \\begin{pmatrix} -3.92 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。\n欧几里得长度平方为 $\\|\\mathbf{r}_{\\mathrm{naive}}\\|_2^2 = (-3.92)^2 + (-0.4)^2 + 0^2 = 15.3664 + 0.16 = 15.5264$。\n长度为 $\\|\\mathbf{r}_{\\mathrm{naive}}\\|_2 = \\sqrt{15.5264} \\approx 3.9404\\ \\text{\\AA}$。\n\n4) 解释朴素方法的缺陷并进行验证。\n朴素笛卡尔卷绕的根本缺陷在于，从 $\\mathbf{r}$ 中减去的矢量通常不是 $\\mathbf{H}\\mathbf{n}$ 形式的晶格矢量（其中 $\\mathbf{n} \\in \\mathbb{Z}^3$）。一个矢量 $\\mathbf{v}$ 只有在对于某个整数矢量 $\\mathbf{n}$ 满足 $\\mathbf{v} = \\mathbf{r} - \\mathbf{H}\\mathbf{n}$ 时，才是 $\\mathbf{r}$ 的一个有效周期性镜像。\n在朴素方法中，减去的矢量是 $\\mathbf{v}_{\\mathrm{sub}} = \\begin{pmatrix} L_x\\,\\mathrm{nint}(r_x/L_x) \\\\ L_y\\,\\mathrm{nint}(r_y/L_y) \\\\ L_z\\,\\mathrm{nint}(r_z/L_z) \\end{pmatrix}$。对于本例，这是 $\\mathbf{v}_{\\mathrm{sub}} = \\begin{pmatrix} 10(1) \\\\ 1(1) \\\\ 1(0) \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n为了使 $\\mathbf{v}_{\\mathrm{sub}}$ 成为一个有效的晶格矢量，必须存在一个整数矢量 $\\mathbf{n}$ 使得 $\\mathbf{H}\\mathbf{n} = \\mathbf{v}_{\\mathrm{sub}}$。求解 $\\mathbf{n}$ 得到 $\\mathbf{n} = \\mathbf{H}^{-1}\\mathbf{v}_{\\mathrm{sub}}$。矩阵 $\\mathbf{H}$ 是上三角矩阵，所以其逆矩阵也是上三角矩阵：\n$$\n\\mathbf{H}^{-1} = \\begin{pmatrix} 1/10  -9.8/10  (-9.8 \\cdot 0.2 + 9.8 \\cdot 1)/10 \\\\ 0  1  -0.2/1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0.1  -0.98  0.784 \\\\ 0  1  -0.2 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n让我们计算 $\\mathbf{n}$：\n$$\n\\mathbf{n} = \\begin{pmatrix} 0.1  -0.98  0.784 \\\\ 0  1  -0.2 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.1(10) - 0.98(1) \\\\ 1(1) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 0.98 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n由于这个 $\\mathbf{n}$ 不是一个整数矢量，矢量 $\\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 不是一个晶格矢量，因此 $\\mathbf{r}_{\\mathrm{naive}}$ 不是 $\\mathbf{r}$ 的一个有效周期性镜像。这种笛卡尔卷绕过程产生了一个在集合 $\\{\\mathbf{r} - \\mathbf{H}\\mathbf{n}\\}$ 之外的矢量。\n\n为了验证第 1 部分的方法确实能得到真正的最小值，我们检查整数矢量 $\\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。相应的距离平方是 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2^2 = 13.9984$。我们必须检查其他整数矢量 $\\mathbf{n}$ 是否会产生更小的距离。\n\\begin{itemize}\n    \\item 对于 $\\mathbf{n} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$：$\\|\\mathbf{r} - \\mathbf{H}\\mathbf{n}\\|^2 = \\|\\mathbf{r}\\|^2 = 37.3264$。\n    \\item 对于 $\\mathbf{n} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$：$\\mathbf{H}\\mathbf{n} = \\mathbf{a} = \\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix}$。镜像是 $\\mathbf{r} - \\mathbf{a} = \\begin{pmatrix} -3.92 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。长度平方是 $(-3.92)^2 + 0.6^2 = 15.3664 + 0.36 = 15.7264$。\n    \\item 对于 $\\mathbf{n} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$：$\\mathbf{H}\\mathbf{n} = \\mathbf{b}-\\mathbf{a} = \\begin{pmatrix} -0.2 \\\\ 1.0 \\\\ 0 \\end{pmatrix}$。镜像是 $\\mathbf{r} - (\\mathbf{b}-\\mathbf{a}) = \\begin{pmatrix} 6.28 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。长度平方是 $6.28^2 + (-0.4)^2 = 39.4384 + 0.16 = 39.5984$。\n\\end{itemize}\n所有相邻的整数矢量 $\\mathbf{n}$ 都导致比 $\\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 更大的距离平方。这证实了简约分数坐标的程序在这种情况下得到了正确的最小镜像。\n\n5) 计算距离误差 $\\delta$。\n计算出的距离误差定义为 $\\delta = \\|\\mathbf{r}_{\\mathrm{naive}}\\|_2 - \\|\\mathbf{r}_{\\mathrm{mic}}\\|_2$。\n使用之前计算的值：\n$$\n\\delta = \\sqrt{15.5264} - \\sqrt{13.9984}\n$$\n$$\n\\delta \\approx 3.9403553 - 3.7414436 = 0.1989117\n$$\n四舍五入到四位有效数字，距离误差为 $\\delta \\approx 0.1989\\ \\text{\\AA}$。这个误差表明，朴素的笛卡尔卷绕不仅产生了一个物理上不正确的镜像矢量，而且还高估了粒子间的最小距离。",
            "answer": "$$\n\\boxed{0.1989}\n$$"
        },
        {
            "introduction": "最小镜像约定的最终效用在于其在更大型的模拟分析算法中的应用。最后一个练习要求你将正确的最小镜像约定计算融入一个基于图的搜索算法中，以识别一个完整的、其原子散布在周期性边界上的分子或团簇 。这个练习模拟了分析模拟轨迹时一项常见且必要的任务，从而将一个几何概念与实际数据分析联系起来。",
            "id": "2460022",
            "problem": "给定一个由满秩晶格矩阵 $\\mathbf{L} \\in \\mathbb{R}^{3 \\times 3}$ 描述的三维周期性模拟晶胞，该矩阵的列是晶胞矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 的笛卡尔分量，因此任何笛卡尔位置矢量 $\\mathbf{r}$ 都通过 $\\mathbf{r} = \\mathbf{L}\\mathbf{s}$ 对应一个分数坐标矢量 $\\mathbf{s}$，其中 $\\mathbf{s} \\in [0,1)^3$。原胞内提供了一组原子位置 $\\{\\mathbf{r}_i\\}_{i=0}^{N-1}$（以笛卡尔坐标表示），给定了一个以埃（Å）为单位的原子间连接阈值 $r_{\\text{cut}}  0$，并指定了一个种子原子索引 $s \\in \\{0,\\dots,N-1\\}$（从零开始的索引）。当且仅当两个原子 $i$ 和 $j$ 在周期性体系中的最小镜像分离距离 $d_{ij}$ 满足 $d_{ij} \\le r_{\\text{cut}}$ 时，它们被认为是相邻的（由一条无向边连接）。从原子 $i$ 到原子 $j$ 的最小镜像位移 $\\Delta \\mathbf{r}_{ij}$ 定义如下：计算分数坐标 $\\mathbf{s}_i = \\mathbf{L}^{-1}\\mathbf{r}_i$ 和 $\\mathbf{s}_j = \\mathbf{L}^{-1}\\mathbf{r}_j$，形成 $\\Delta \\mathbf{s}_{ij} = \\mathbf{s}_j - \\mathbf{s}_i$，然后通过加上一个整数矢量得到 $\\widehat{\\Delta \\mathbf{s}}_{ij}$，使其每个分量都位于半开区间 $[-\\tfrac{1}{2}, \\tfrac{1}{2})$ 内，最后设置 $\\Delta \\mathbf{r}_{ij} = \\mathbf{L}\\widehat{\\Delta \\mathbf{s}}_{ij}$。最小镜像距离为 $d_{ij} = \\|\\Delta \\mathbf{r}_{ij}\\|_2$。在顶点 $\\{0,\\dots,N-1\\}$ 上定义一个图，只要 $d_{ij} \\le r_{\\text{cut}}$，就存在边 $\\{i,j\\}$。您的任务是确定属于包含种子原子索引 $s$ 的连通分量的所有原子索引的集合，并按升序将这些索引报告为排序列表。\n\n所有长度（$\\mathbf{L}$ 的条目、$\\mathbf{r}_i$ 的分量以及 $r_{\\text{cut}}$）均以埃（Å）为单位指定。索引是无单位的整数，必须使用从零开始的索引进行报告。边的条件必须解释为 $d_{ij} \\le r_{\\text{cut}}$。\n\n测试套件。对于每个测试用例 $t \\in \\{1,2,3\\}$，给定 $\\mathbf{L}^{(t)}$、笛卡尔位置列表 $\\{\\mathbf{r}^{(t)}_i\\}$、标量 $r^{(t)}_{\\text{cut}}$ 和种子 $s^{(t)}$：\n\n- 测试用例 1（带有一条跨面包裹链的立方晶胞）：\n  - $\\mathbf{L}^{(1)} = \\begin{bmatrix} 10.0  0.0  0.0 \\\\ 0.0  10.0  0.0 \\\\ 0.0  0.0  10.0 \\end{bmatrix}$。\n  - 位置 $\\{\\mathbf{r}^{(1)}_i\\}_{i=0}^{5}$：\n    - $i = 0$: $(9.5,\\, 5.0,\\, 5.0)$，\n    - $i = 1$: $(0.5,\\, 5.0,\\, 5.0)$，\n    - $i = 2$: $(1.5,\\, 5.0,\\, 5.0)$，\n    - $i = 3$: $(8.0,\\, 5.0,\\, 5.0)$，\n    - $i = 4$: $(3.0,\\, 3.0,\\, 3.0)$，\n    - $i = 5$: $(3.9,\\, 3.0,\\, 3.0)$。\n  - $r^{(1)}_{\\text{cut}} = 1.2$。\n  - $s^{(1)} = 0$。\n\n- 测试用例 2（带有一个跨边界簇的三斜晶胞）：\n  - $\\mathbf{L}^{(2)} = \\begin{bmatrix} 8.0  2.0  1.0 \\\\ 0.0  7.0  1.5 \\\\ 0.0  0.0  6.5 \\end{bmatrix}$，其中列为 $\\mathbf{a} = (8.0,\\,0.0,\\,0.0)$，$\\mathbf{b} = (2.0,\\,7.0,\\,0.0)$，$\\mathbf{c} = (1.0,\\,1.5,\\,6.5)$。\n  - 位置 $\\{\\mathbf{r}^{(2)}_i\\}_{i=0}^{3}$：\n    - $i = 0$: $(10.45,\\, 8.075,\\, 6.175)$，\n    - $i = 1$: $(3.03,\\, 8.145,\\, 6.175)$，\n    - $i = 2$: $(1.33,\\, 1.635,\\, 6.175)$，\n    - $i = 3$: $(4.4,\\, 3.4,\\, 2.6)$。\n  - $r^{(2)}_{\\text{cut}} = 1.0$。\n  - $s^{(2)} = 0$。\n\n- 测试用例 3（距离恰好在阈值上的正交晶胞）：\n  - $\\mathbf{L}^{(3)} = \\begin{bmatrix} 8.0  0.0  0.0 \\\\ 0.0  8.0  0.0 \\\\ 0.0  0.0  8.0 \\end{bmatrix}$。\n  - 位置 $\\{\\mathbf{r}^{(3)}_i\\}_{i=0}^{3}$：\n    - $i = 0$: $(7.5,\\, 4.0,\\, 4.0)$，\n    - $i = 1$: $(0.5,\\, 4.0,\\, 4.0)$，\n    - $i = 2$: $(1.5,\\, 4.0,\\, 4.0)$，\n    - $i = 3$: $(4.0,\\, 4.0,\\, 4.0)$。\n  - $r^{(3)}_{\\text{cut}} = 1.0$。\n  - $s^{(3)} = 0$。\n\n所需程序行为：\n- 对于每个测试用例，根据上面定义的周期性边界条件下的最小镜像约定和邻接规则 $d_{ij} \\le r_{\\text{cut}}$，确定包含种子原子的连通分量中所有原子的索引排序列表。\n- 您的程序应生成单行输出，其中包含结果，形式为无空格、用方括号括起来的逗号分隔列表的列表。例如，如果三个结果是列表 $\\ell^{(1)}$、$\\ell^{(2)}$ 和 $\\ell^{(3)}$，则所需的输出格式为 $[\\ell^{(1)},\\ell^{(2)},\\ell^{(3)}]$，其中每个列表呈现为 $[i_0,i_1,\\dots]$，使用从零开始的索引且无空白字符。",
            "solution": "所提出的问题是计算几何和图论领域中一个定义明确的练习，对分子模拟领域至关重要。它要求在周期性边界条件（PBC）下，识别一个原子簇（表示为图中的一个连通分量）。该问题具有科学依据，内部一致，并包含唯一解所需的所有信息。因此，该问题是有效的，我们将继续进行严谨的分析和算法求解。\n\n问题的核心在于正确应用最小镜像约定（MIC）来确定通用三斜晶胞中原子间的邻接关系，然后使用图遍历算法找到包含指定种子原子的连通分量。\n\n让我们剖析一下这个过程。\n\n1.  **体系表示**：模拟晶胞是一个由三个晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 定义的平行六面体，这三个矢量构成了晶格矩阵 $\\mathbf{L} = [\\mathbf{a} \\ \\mathbf{b} \\ \\mathbf{c}]$ 的列。晶胞内的任何笛卡尔位置矢量 $\\mathbf{r}$ 都可以通过线性变换 $\\mathbf{r} = \\mathbf{L}\\mathbf{s}$ 唯一地映射到一个分数坐标矢量 $\\mathbf{s} \\in [0, 1)^3$。逆变换为 $\\mathbf{s} = \\mathbf{L}^{-1}\\mathbf{r}$。由于规定 $\\mathbf{L}$ 是满秩的，因此保证了 $\\mathbf{L}^{-1}$ 的存在。\n\n2.  **最小镜像约定 (MIC)**：要计算位于笛卡尔坐标 $\\mathbf{r}_i$ 和 $\\mathbf{r}_j$ 的两个原子 $i$ 和 $j$ 之间的距离，我们必须考虑体系的周期性。这个距离不仅仅是 $\\|\\mathbf{r}_j - \\mathbf{r}_i\\|_2$，而是原子 $j$ 和原子 $i$ 的所有周期性镜像之间的最小距离。原子 $i$ 的所有镜像集合由 $\\{\\mathbf{r}_i + \\mathbf{L}\\mathbf{n} \\,|\\, \\mathbf{n} \\in \\mathbb{Z}^3\\}$ 给出。因此，距离的平方为 $d_{ij}^2 = \\min_{\\mathbf{n} \\in \\mathbb{Z}^3} \\|\\mathbf{r}_j - (\\mathbf{r}_i + \\mathbf{L}\\mathbf{n})\\|_2^2$。\n\n    问题提供了一种直接且计算高效的算法来找到这个最小镜像位移矢量。该过程避免了对整数矢量 $\\mathbf{n}$ 的显式搜索。\n    \n    a. 首先，我们将问题转换到分数坐标空间，在这里处理周期性更为简单。笛卡尔坐标中的位移矢量是 $\\Delta\\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i$。在分数坐标中，这变为 $\\Delta\\mathbf{s}_{ij} = \\mathbf{s}_j - \\mathbf{s}_i = \\mathbf{L}^{-1}(\\mathbf{r}_j - \\mathbf{r}_i)$。由于 $\\mathbf{s}_i, \\mathbf{s}_j \\in [0,1)^3$，$\\Delta\\mathbf{s}_{ij}$ 的每个分量都位于 $(-1, 1)$ 内。\n\n    b. 下一步是在分数空间中应用 MIC。这意味着找到一个整数矢量 $\\mathbf{n}$，使得包裹后的位移 $\\widehat{\\Delta\\mathbf{s}}_{ij} = \\Delta\\mathbf{s}_{ij} - \\mathbf{n}$ 的每个分量都在区间 $[-\\frac{1}{2}, \\frac{1}{2})$ 内。该矢量对应于最接近原子 $i$ 的原子 $j$ 的镜像。对于矢量 $\\mathbf{v}$ 的每个分量 $v_k$，将其映射到 $[-\\frac{1}{2}, \\frac{1}{2})$ 的包裹操作可以实现为 $v_k - \\lfloor v_k + \\frac{1}{2} \\rfloor$。在浮点运算的计算环境中，必须小心处理边界情况。一个稳健的实现是 `(v + 0.5) % 1.0 - 0.5`，其中 `%` 表示能正确处理负数的模运算，例如 Python 的 `%` 运算符或 `numpy.mod`。\n\n    c. 一旦找到包裹后的分数位移 $\\widehat{\\Delta\\mathbf{s}}_{ij}$，我们将其转换回笛卡尔坐标，以获得最小镜像位移矢量：$\\Delta\\mathbf{r}_{ij}^{\\text{min}} = \\mathbf{L} \\widehat{\\Delta\\mathbf{s}}_{ij}$。\n\n    d. 最小镜像距离 $d_{ij}$ 是该矢量的欧几里得范数：$d_{ij} = \\|\\Delta\\mathbf{r}_{ij}^{\\text{min}}\\|_2$。\n\n3.  **图的构建**：一个无向图 $G = (V, E)$被隐式定义。顶点集 $V$ 是原子索引集 $\\{0, 1, \\dots, N-1\\}$。当且仅当最小镜像距离 $d_{ij}$ 小于或等于给定的截断半径，即 $d_{ij} \\le r_{\\text{cut}}$ 时，边 $(i, j)$ 存在于 $E$ 中。由于距离度量的性质，$d_{ij} = d_{ji}$，所以图确实是无向的。\n\n4.  **连通分量搜索**：最后的任务是找到包含给定种子原子索引 $s$ 的连通分量中的所有顶点。这是一个标准的图遍历问题。我们可以采用广度优先搜索（BFS）或深度优先搜索（DFS）算法，从种子顶点 $s$ 开始。\n\n    算法如下：\n    a. 构建图 $G$ 的邻接表表示。对于每对原子 $(i, j)$（其中 $i  j$），计算 $d_{ij}$。如果 $d_{ij} \\le r_{\\text{cut}}$，则将 $j$ 添加到 $i$ 的邻接表中，并将 $i$ 添加到 $j$ 的邻接表中。\n    b. 用种子原子 $s$ 初始化一个用于 BFS 的队列，并用一个也包含 $s$ 的集合 `visited`。\n    c. 当队列不为空时，从队列中取出一个顶点 $u$。对于 $u$ 在邻接表中的每个邻居 $v$，如果 $v$ 尚未被访问，则将其添加到 `visited` 集合中并入队。\n    d. 当队列为空时，过程终止。`visited` 集合现在包含了 $s$ 的连通分量中的所有原子索引。\n\n5.  **最终结果的形成**：将得到的索引集合转换为列表，并按要求升序排序。对每个测试用例重复此过程。\n\n实现将使用 `numpy` 库进行高效的线性代数运算，例如矩阵求逆、矩阵向量乘积和向量范数。",
            "answer": "[[0,1,2],[0,1,2],[0,1,2]]"
        }
    ]
}