{
    "hands_on_practices": [
        {
            "introduction": "At the heart of the Finite Volume Method is the computation of fluxes across the faces of control volumes. This exercise provides direct practice in assembling a combined advective-diffusive flux, which represents the primary transport mechanisms in many fluid dynamics and heat transfer problems. By working through this fundamental calculation , you will translate continuous physical laws into the discrete numerical formulas used in practice, applying standard approximations for upwinded advection and a two-point gradient for diffusion.",
            "id": "4087700",
            "problem": "Consider a passive scalar field $\\phi$ representing a micellar mass fraction (dimensionless) transported in a steady, incompressible complex fluid with constant density $\\rho$. Two adjacent finite volumes share a planar face $f$ of area $A_f$ with outward unit normal $\\boldsymbol{n}_f$ taken with respect to the left cell $L$. The face area vector is $\\boldsymbol{S}_f = A_f \\boldsymbol{n}_f$. The left and right cell centroids are at positions $\\boldsymbol{x}_L$ and $\\boldsymbol{x}_R$, and the face-centered velocity is $\\boldsymbol{u}_f$. The material diffusivity is $D$ (Fickian diffusion), so that the diffusive transport coefficient in the conservative form $\\nabla \\cdot (\\Gamma \\nabla \\phi)$ is $\\Gamma = \\rho D$.\n\nYou are given:\n- $\\rho = 1050\\,\\mathrm{kg\\,m^{-3}}$,\n- $\\boldsymbol{u}_f = (0.6,\\,0.2,\\,0.1)\\,\\mathrm{m\\,s^{-1}}$,\n- $A_f = 0.010\\,\\mathrm{m^2}$,\n- $\\boldsymbol{n}_f = \\frac{1}{\\sqrt{11}}(3,\\,1,\\,1)$,\n- $\\boldsymbol{x}_L = (0.010,\\,0.020,\\,0.000)\\,\\mathrm{m}$,\n- $\\boldsymbol{x}_R = (0.022,\\,0.025,\\,0.003)\\,\\mathrm{m}$,\n- $\\phi_L = 0.24$, $\\phi_R = 0.18$,\n- $D = 2.0 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$.\n\nStarting from the integral conservation law for $\\phi$ over the left control volume and the constitutive statement for diffusive flux (Fick’s law), derive the facewise advective-diffusive flux leaving cell $L$ through face $f$ as the sum of an advective contribution and a diffusive contribution. Adopt the following modeling and discretization assumptions that are standard in the Finite Volume Method (FVM):\n- The advective face value $\\phi_f$ is obtained by first-order upwinding based on the sign of the mass flow rate across the face.\n- The face-normal diffusive flux uses a two-point approximation based on linear variation of $\\phi$ between $\\boldsymbol{x}_L$ and $\\boldsymbol{x}_R$ and the projection of the centroid-to-centroid vector onto the face normal.\n- Neglect any non-orthogonal correction beyond this projection.\n\nDefine the left-cell residual contribution from face $f$ as the net outward flux leaving cell $L$ through face $f$. Compute this single numerical value. Round your final numerical answer to four significant figures and express it in $\\mathrm{kg\\,s^{-1}}$.",
            "solution": "The steady-state integral conservation law for a passive scalar $\\phi$ over a control volume $V$ is given by:\n$$ \\oint_{\\partial V} (\\rho \\phi \\boldsymbol{u} - \\Gamma \\nabla\\phi) \\cdot d\\boldsymbol{S} = 0 $$\nThe term inside the integral is the total flux vector, $\\boldsymbol{F} = \\rho \\phi \\boldsymbol{u} - \\Gamma \\nabla\\phi$. The problem asks for the \"residual contribution\" from face $f$ for the left cell $L$, which is defined as the net outward flux leaving cell $L$ through face $f$. This quantity, which we denote $F_f$, is the surface integral of the flux vector over the face area $A_f$. Using standard finite volume approximations, this integral is approximated as:\n$$ F_f \\approx \\boldsymbol{F}_f \\cdot \\boldsymbol{S}_f = (\\rho \\phi \\boldsymbol{u})_f \\cdot \\boldsymbol{S}_f - (\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f $$\nwhere $\\boldsymbol{S}_f = A_f \\boldsymbol{n}_f$ is the face area vector, and the subscript $f$ denotes values evaluated at the face center. We can separate this into an advective contribution, $F_{f, \\text{adv}}$, and a diffusive contribution, $F_{f, \\text{diff}}$. Note that the diffusive flux vector is $\\boldsymbol{j}_d = -\\Gamma \\nabla\\phi$, so the diffusive contribution to the outward flux is $(-\\Gamma\\nabla\\phi)_f \\cdot \\boldsymbol{S}_f$.\n$$ F_f = F_{f, \\text{adv}} + F_{f, \\text{diff}} $$\nwhere\n$$ F_{f, \\text{adv}} = (\\rho \\boldsymbol{u})_f \\cdot \\boldsymbol{S}_f \\phi_f $$\n$$ F_{f, \\text{diff}} = -(\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f $$\n\nFirst, we compute the advective flux, $F_{f, \\text{adv}}$. This requires the mass flow rate through the face, $\\dot{m}_f$, and the face value of the scalar, $\\phi_f$.\nThe mass flow rate is $\\dot{m}_f = \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f = \\rho A_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f)$.\nLet's compute the dot product $\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f$:\n$$ \\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f = (0.6, 0.2, 0.1) \\cdot \\frac{1}{\\sqrt{11}}(3, 1, 1) = \\frac{1}{\\sqrt{11}}(0.6 \\times 3 + 0.2 \\times 1 + 0.1 \\times 1) = \\frac{1}{\\sqrt{11}}(1.8 + 0.2 + 0.1) = \\frac{2.1}{\\sqrt{11}} \\,\\mathrm{m\\,s^{-1}} $$\nNow, we calculate $\\dot{m}_f$:\n$$ \\dot{m}_f = \\rho A_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f) = (1050\\,\\mathrm{kg\\,m^{-3}}) \\times (0.010\\,\\mathrm{m^2}) \\times \\left(\\frac{2.1}{\\sqrt{11}}\\,\\mathrm{m\\,s^{-1}}\\right) = \\frac{10.5 \\times 2.1}{\\sqrt{11}} = \\frac{22.05}{\\sqrt{11}}\\,\\mathrm{kg\\,s^{-1}} $$\nSince $\\dot{m}_f  0$, the mass flow is directed out of cell $L$. The first-order upwind scheme dictates that the advected scalar value at the face, $\\phi_f$, is taken from the upstream cell, which is cell $L$.\n$$ \\phi_f = \\phi_L = 0.24 $$\nThe advective flux is then:\n$$ F_{f, \\text{adv}} = \\dot{m}_f \\phi_f = \\left(\\frac{22.05}{\\sqrt{11}}\\right) \\times 0.24 = \\frac{5.292}{\\sqrt{11}}\\,\\mathrm{kg\\,s^{-1}} $$\n\nNext, we compute the diffusive flux, $F_{f, \\text{diff}} = -(\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f = -\\Gamma A_f ((\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f)$. The problem specifies approximating the face-normal gradient $(\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f$ using a two-point stencil and the projection of the vector connecting cell centroids onto the face normal.\nThe vector connecting the cell centroids is $\\boldsymbol{d}_{LR} = \\boldsymbol{x}_R - \\boldsymbol{x}_L$:\n$$ \\boldsymbol{d}_{LR} = (0.022 - 0.010, 0.025 - 0.020, 0.003 - 0.000) = (0.012, 0.005, 0.003)\\,\\mathrm{m} $$\nThe effective distance for the gradient approximation is the projection of $\\boldsymbol{d}_{LR}$ onto $\\boldsymbol{n}_f$, which we denote $d_n$:\n$$ d_n = \\boldsymbol{d}_{LR} \\cdot \\boldsymbol{n}_f = (0.012, 0.005, 0.003) \\cdot \\frac{1}{\\sqrt{11}}(3, 1, 1) = \\frac{1}{\\sqrt{11}}(0.012 \\times 3 + 0.005 \\times 1 + 0.003 \\times 1) = \\frac{0.036 + 0.005 + 0.003}{\\sqrt{11}} = \\frac{0.044}{\\sqrt{11}}\\,\\mathrm{m} $$\nThe face-normal gradient is approximated as:\n$$ (\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{\\phi_R - \\phi_L}{d_n} = \\frac{0.18 - 0.24}{0.044/\\sqrt{11}} = \\frac{-0.06\\sqrt{11}}{0.044}\\,\\mathrm{m^{-1}} $$\nThe diffusive transport coefficient is $\\Gamma = \\rho D$:\n$$ \\Gamma = (1050\\,\\mathrm{kg\\,m^{-3}}) \\times (2.0 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}) = 2100 \\times 10^{-9} = 2.1 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}} $$\nThe diffusive flux is now computed:\n$$ F_{f, \\text{diff}} = -\\Gamma A_f \\left(\\frac{\\phi_R - \\phi_L}{d_n}\\right) = -(2.1 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}) \\times (0.010\\,\\mathrm{m^2}) \\times \\left(\\frac{-0.06\\sqrt{11}}{0.044}\\,\\mathrm{m^{-1}}\\right) $$\n$$ F_{f, \\text{diff}} = (2.1 \\times 10^{-8}) \\times \\frac{0.06\\sqrt{11}}{0.044}\\,\\mathrm{kg\\,s^{-1}} = \\frac{0.126\\sqrt{11}}{0.044} \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\n\nThe total net outward flux from cell $L$ through face $f$ is the sum of the advective and diffusive fluxes:\n$$ F_f = F_{f, \\text{adv}} + F_{f, \\text{diff}} = \\frac{5.292}{\\sqrt{11}} + \\frac{0.126\\sqrt{11}}{0.044} \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\nNow, we evaluate this expression numerically:\n$$ \\sqrt{11} \\approx 3.31662479 $$\n$$ F_{f, \\text{adv}} \\approx \\frac{5.292}{3.31662479} \\approx 1.59554709\\,\\mathrm{kg\\,s^{-1}} $$\n$$ F_{f, \\text{diff}} \\approx \\frac{0.126 \\times 3.31662479}{0.044} \\times 10^{-8} \\approx \\frac{0.4178947}{0.044} \\times 10^{-8} \\approx 9.497607 \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\n$$ F_f \\approx 1.59554709 + 0.00000009497607 = 1.595547185\\,\\mathrm{kg\\,s^{-1}} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ F_f \\approx 1.596\\,\\mathrm{kg\\,s^{-1}} $$",
            "answer": "$$ \\boxed{1.596} $$"
        },
        {
            "introduction": "A numerical scheme for the domain's interior is incomplete without a robust method for handling its boundaries. This practice introduces the \"ghost cell\" technique, an elegant and widely-used approach for implementing boundary conditions in a way that preserves the structure of the interior discretization stencil. This exercise  guides you to derive the ghost cell value from first principles of linear reconstruction, demonstrating how a fixed-value (Dirichlet) condition is enforced with second-order accuracy.",
            "id": "3230527",
            "problem": "You are to implement, explain, and test a \"ghost cell\" method for enforcing a Dirichlet boundary condition in the Finite Volume Method (FVM). Consider a one-dimensional, uniform grid with cell centers at positions $x_i = (i + \\tfrac{1}{2}) \\Delta x$ for integer $i \\ge 0$, where $\\Delta x$ is the uniform cell size. The physical boundary is at $x = 0$, the first interior cell is $i = 0$ centered at $x = \\tfrac{1}{2} \\Delta x$, and a ghost cell at $i = -1$ is centered at $x = -\\tfrac{1}{2} \\Delta x$. A constant Dirichlet boundary condition specifies the field value at the boundary face as $Q(0) = Q_{\\mathrm{bnd}}$. All quantities are dimensionless.\n\nStarting from the following fundamental bases and definitions:\n- The Finite Volume Method (FVM) enforces conservation by balancing face fluxes across control volumes, with fluxes evaluated at faces from reconstructed quantities.\n- A Dirichlet boundary condition specifies the value of the field at the boundary face, i.e., $Q(0) = Q_{\\mathrm{bnd}}$.\n- A second-order scheme on a uniform grid uses linear reconstruction in space near the boundary, and second-order central differences for gradients.\n\nYour tasks:\n1. Derive, from first principles, the selection rule for the ghost cell value $Q_{-1}$ such that a second-order face reconstruction at $x = 0$ enforces $Q(0) = Q_{\\mathrm{bnd}}$ without bias. The derivation must start from the definitions above and be based on linear reconstruction between the first interior cell ($i=0$) and the ghost cell ($i=-1$) and the requirement that the reconstructed face value equals $Q_{\\mathrm{bnd}}$.\n2. Implement a program that, for each test case, computes:\n   - The ghost cell value $Q_{-1}$ that enforces the Dirichlet boundary in a second-order scheme on the uniform grid.\n   - The reconstructed face value using a centered, second-order linear interpolation $Q_f = \\tfrac{1}{2} \\left( Q_{-1} + Q_0 \\right)$ at $x=0$.\n   - The diffusive flux at the boundary face $F = -\\kappa \\left( \\frac{\\partial Q}{\\partial x} \\right)_f$ using the second-order central difference between the cell centers adjacent to the face, i.e., $\\left( \\frac{\\partial Q}{\\partial x} \\right)_f \\approx \\frac{Q_0 - Q_{-1}}{\\Delta x}$, where $\\kappa$ is a given diffusion coefficient.\n   - A boolean check indicating whether $Q_f$ equals $Q_{\\mathrm{bnd}}$ within a tolerance of $10^{-12}$, i.e., $\\left| Q_f - Q_{\\mathrm{bnd}} \\right| \\le 10^{-12}$.\n\nUse the following test suite of parameter sets $(\\Delta x, \\kappa, Q_0, Q_{\\mathrm{bnd}})$:\n- Test $1$: $(\\Delta x = 1.0, \\kappa = 1.0, Q_0 = 0.3, Q_{\\mathrm{bnd}} = 1.0)$.\n- Test $2$: $(\\Delta x = 0.1, \\kappa = 2.0, Q_0 = 0.9, Q_{\\mathrm{bnd}} = 0.9)$.\n- Test $3$: $(\\Delta x = 0.5, \\kappa = 0.5, Q_0 = -0.7, Q_{\\mathrm{bnd}} = 0.2)$.\n- Test $4$: $(\\Delta x = 2.0, \\kappa = 3.0, Q_0 = 1.5, Q_{\\mathrm{bnd}} = -0.5)$.\n- Test $5$: $(\\Delta x = 0.25, \\kappa = 0.05, Q_0 = 2.0, Q_{\\mathrm{bnd}} = 2.5)$.\n\nYour program should produce a single line of output containing a list of lists, one inner list per test case, in the exact order given above. Each inner list must contain $[Q_{-1}, Q_f, F, \\text{check}]$, where $Q_{-1}$, $Q_f$, and $F$ are floats, and $\\text{check}$ is a boolean. The output must be formatted as a single comma-separated list enclosed in square brackets, with no spaces. For example: $[[q_{-1}^{(1)}, q_f^{(1)}, f^{(1)}, \\mathrm{True}],[q_{-1}^{(2)}, q_f^{(2)}, f^{(2)}, \\mathrm{False}],\\ldots]$.",
            "solution": "The primary objective is to determine the value of a \"ghost cell\" $Q_{-1}$ that correctly enforces a Dirichlet boundary condition $Q(0) = Q_{\\mathrm{bnd}}$ at a boundary face located at $x=0$. This is a standard technique in FVM used to handle boundary fluxes in a way that is consistent with the interior discretization scheme.\n\nThe derivation and subsequent calculations will be based on the principles provided:\n1.  The grid is one-dimensional and uniform, with cell size $\\Delta x$. The first interior cell, indexed $i=0$, is centered at $x_0 = (0 + \\frac{1}{2})\\Delta x = \\frac{1}{2}\\Delta x$. The ghost cell, indexed $i=-1$, is its reflection across the boundary, centered at $x_{-1} = (-1 + \\frac{1}{2})\\Delta x = -\\frac{1}{2}\\Delta x$. The physical boundary is located at the face between these two cells, at $x=0$.\n\n2.  A second-order accurate scheme implies that the cell-centered value $Q_i$ is a second-order approximation to the point value at the cell center, $Q(x_i)$. Furthermore, spatial reconstruction of the field variable $Q(x)$ is locally linear.\n\n3.  The Dirichlet boundary condition specifies the value of the field at the boundary face: $Q(0) = Q_{\\mathrm{bnd}}$.\n\n### Derivation of the Ghost Cell Value $Q_{-1}$\n\nThe core idea is to define the ghost cell value $Q_{-1}$ such that a linear reconstruction of the field $Q(x)$ between the centers of cell $i=0$ and cell $i=-1$ results in the value $Q_{\\mathrm{bnd}}$ at the boundary face $x=0$.\n\nAssuming the field $Q(x)$ is linear in the vicinity of the boundary, we can write its profile using the values at the two adjacent cell centers, $x_{-1} = -\\frac{1}{2}\\Delta x$ and $x_0 = \\frac{1}{2}\\Delta x$:\n$$\nQ(x) = Q_{-1} + \\frac{Q_0 - Q_{-1}}{x_0 - x_{-1}} (x - x_{-1})\n$$\nSubstituting the positions of the cell centers:\n$$\nx_0 - x_{-1} = \\frac{\\Delta x}{2} - \\left(-\\frac{\\Delta x}{2}\\right) = \\Delta x\n$$\nThe linear profile becomes:\n$$\nQ(x) = Q_{-1} + \\frac{Q_0 - Q_{-1}}{\\Delta x} \\left(x + \\frac{\\Delta x}{2}\\right)\n$$\nWe need to evaluate this reconstructed profile at the boundary face, which is located at $x=0$:\n$$\nQ(0) = Q_{-1} + \\frac{Q_0 - Q_{-1}}{\\Delta x} \\left(0 + \\frac{\\Delta x}{2}\\right)\n$$\n$$\nQ(0) = Q_{-1} + \\frac{1}{2} (Q_0 - Q_{-1})\n$$\n$$\nQ(0) = Q_{-1} - \\frac{1}{2}Q_{-1} + \\frac{1}{2}Q_0\n$$\n$$\nQ(0) = \\frac{1}{2} Q_{-1} + \\frac{1}{2} Q_0 = \\frac{Q_{-1} + Q_0}{2}\n$$\nThis result confirms that for a uniform grid, second-order linear reconstruction at the face midway between two cell centers is simply the arithmetic average of the cell-center values. This corresponds to the formula for the reconstructed face value $Q_f$ provided in the problem statement.\n\nTo enforce the Dirichlet boundary condition, we set this reconstructed face value equal to the specified boundary value $Q_{\\mathrm{bnd}}$:\n$$\n\\frac{Q_{-1} + Q_0}{2} = Q_{\\mathrm{bnd}}\n$$\nSolving for the ghost cell value $Q_{-1}$ yields the selection rule:\n$$\nQ_{-1} + Q_0 = 2 Q_{\\mathrm{bnd}}\n$$\n$$\nQ_{-1} = 2 Q_{\\mathrm{bnd}} - Q_0\n$$\nThis is the fundamental relationship that defines the ghost cell value required to enforce the Dirichlet condition $Q(0) = Q_{\\mathrm{bnd}}$ with second-order accuracy.\n\n### Computational Procedure\n\nFor each test case defined by the parameter set $(\\Delta x, \\kappa, Q_0, Q_{\\mathrm{bnd}})$, we must compute four quantities.\n\n1.  **Ghost Cell Value, $Q_{-1}$**: This is computed using the derived formula:\n    $$\n    Q_{-1} = 2 Q_{\\mathrm{bnd}} - Q_0\n    $$\n\n2.  **Reconstructed Face Value, $Q_f$**: This is computed using the centered, second-order linear interpolation formula provided, which we also derived as the result of linear reconstruction:\n    $$\n    Q_f = \\frac{1}{2} (Q_{-1} + Q_0)\n    $$\n    Substituting our expression for $Q_{-1}$ into this formula confirms its correctness:\n    $$\n    Q_f = \\frac{1}{2} ((2 Q_{\\mathrm{bnd}} - Q_0) + Q_0) = \\frac{1}{2} (2 Q_{\\mathrm{bnd}}) = Q_{\\mathrm{bnd}}\n    $$\n\n3.  **Diffusive Flux, $F$**: The flux at the face $x=0$ is calculated using the provided second-order central difference formula for the gradient:\n    $$\n    F = -\\kappa \\left( \\frac{\\partial Q}{\\partial x} \\right)_f \\approx -\\kappa \\frac{Q_0 - Q_{-1}}{\\Delta x}\n    $$\n    Again, we can substitute our expression for $Q_{-1}$:\n    $$\n    F = -\\kappa \\frac{Q_0 - (2 Q_{\\mathrm{bnd}} - Q_0)}{\\Delta x} = -\\kappa \\frac{2Q_0 - 2Q_{\\mathrm{bnd}}}{\\Delta x} = -2\\kappa \\frac{Q_0 - Q_{\\mathrm{bnd}}}{\\Delta x}\n    $$\n\n4.  **Boolean Check, `check`**: This verifies that the implementation correctly enforces the boundary condition within a machine precision tolerance. We test if:\n    $$\n    | Q_f - Q_{\\mathrm{bnd}} | \\le 10^{-12}\n    $$\n    Based on the analytic substitution above, this condition should always evaluate to true.\n\nThis procedure will be applied to each of the five test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ghost cell values and boundary fluxes for a Dirichlet condition\n    in a 1D Finite Volume Method setup.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_x, kappa, Q_0, Q_bnd)\n    test_cases = [\n        (1.0, 1.0, 0.3, 1.0),\n        (0.1, 2.0, 0.9, 0.9),\n        (0.5, 0.5, -0.7, 0.2),\n        (2.0, 3.0, 1.5, -0.5),\n        (0.25, 0.05, 2.0, 2.5),\n    ]\n\n    results = []\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        delta_x, kappa, Q_0, Q_bnd = case\n\n        # 1. Compute the ghost cell value Q_{-1}\n        # Based on the derivation: Q_{-1} = 2 * Q_bnd - Q_0\n        Q_m1 = 2.0 * Q_bnd - Q_0\n\n        # 2. Compute the reconstructed face value Q_f\n        # Based on the formula: Q_f = 0.5 * (Q_{-1} + Q_0)\n        Q_f = 0.5 * (Q_m1 + Q_0)\n\n        # 3. Compute the diffusive flux F at the boundary\n        # Based on the formula: F = -kappa * (Q_0 - Q_{-1}) / delta_x\n        flux = -kappa * (Q_0 - Q_m1) / delta_x\n\n        # 4. Perform the boolean check\n        # Check if |Q_f - Q_bnd| = tolerance\n        check = abs(Q_f - Q_bnd) = TOLERANCE\n        \n        # Store the results for this case\n        results.append([Q_m1, Q_f, flux, check])\n\n    # Final print statement in the exact required format:\n    # A string representation of a list of lists, with no spaces.\n    # Example: [[q1,qf1,f1,True],[q2,qf2,f2,False]]\n    inner_list_strs = [str(sublist).replace(' ', '') for sublist in results]\n    output_str = f\"[{','.join(inner_list_strs)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical methods are approximations that inevitably introduce errors not present in the original physical equations. This final practice focuses on visualizing and quantifying one of the most common artifacts of first-order schemes: numerical diffusion. By simulating the advection of a sharp profile with a first-order upwind scheme , you will observe how the method artificially \"smears\" discontinuities and learn to measure this effect, gaining critical insight into the trade-offs between a scheme's simplicity and its accuracy.",
            "id": "2394306",
            "problem": "Consider the linear advection equation in one spatial dimension,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\non a periodic domain of length $L$, that is $x \\in [0,L)$ with periodic boundary conditions. The advection speed $a$ is a positive constant. Starting from the integral conservation law and the definition of finite volume averages on a uniform grid, derive a first-order, explicit, conservative finite volume method that is consistent with the physics of information propagation for $a0$.\n\nYou will investigate numerical diffusion by simulating the advection of a block step function and quantifying the smearing of the interface over time. Use a uniform mesh of $N$ cells with spatial step $\\Delta x = L/N$ and cell centers $x_i = (i+\\tfrac{1}{2})\\Delta x$, for $i=0,1,\\dots,N-1$. Let the initial condition be the block\n$$\nu(x,0) = \\begin{cases}\n1,  x \\in [x_L, x_R),\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nwith $x_L = 0.2\\,L$ and $x_R = 0.7\\,L$. Evolve the solution using a first-order finite volume scheme with an explicit time step $\\Delta t$ chosen to satisfy a prescribed Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$. Use the same constant $\\nu$ for all time steps of a given simulation. Let the simulation run for a prescribed final time $T$; use an integer number of time steps $n = \\text{round}(T/\\Delta t)$ so that the simulated time is $t_n = n\\,\\Delta t$.\n\nDefine the \"smearing width\" of a descending interface at time $t_n$ as the minimal spatial distance (measured along the periodic domain) from the point where the cell-centered profile crosses the level $\\theta_{\\text{hi}} = 0.9$ downward to the subsequent point where it crosses the level $\\theta_{\\text{lo}} = 0.1$ downward. Compute these crossing points using linear interpolation of the cell-centered values between neighboring cell centers. In the presence of multiple descending interfaces (due to periodicity), compute the smearing width around each descending interface and report the minimal width. Express the width in the same dimensionless length units as $L$.\n\nImplement the simulation and the width measurement in a single program. For each test case below, output the measured smearing width at time $t_n$, rounded to $8$ decimal places.\n\nUse the following test suite, with parameters $(N,\\ \\nu,\\ T,\\ a,\\ L)$:\n- Case $1$: $(200,\\ 0.5,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $2$: $(200,\\ 0.9,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $3$: $(200,\\ 0.2,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $4$: $(50,\\ 0.5,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $5$: $(200,\\ 1.0,\\ 0.2,\\ 1.0,\\ 1.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For example, it should look like\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\nwhere each $\\text{result}_k$ is the smearing width for case $k$ rounded to $8$ decimal places. No other output is permitted.",
            "solution": "We start from the integral conservation form of the advection equation,\n$$\n\\partial_t u(x,t) + \\partial_x f(u) = 0,\\quad f(u) = a u,\\quad a0.\n$$\nLet $\\mathcal{C}_i = [x_{i-\\tfrac{1}{2}}, x_{i+\\tfrac{1}{2}}]$ be a control volume of uniform width $\\Delta x = x_{i+\\tfrac{1}{2}} - x_{i-\\tfrac{1}{2}}$, with cell center $x_i = (i+\\tfrac{1}{2})\\Delta x$ and periodic indexing. Define the cell average\n$$\n\\bar{u}_i(t) = \\frac{1}{\\Delta x}\\int_{\\mathcal{C}_i} u(x,t)\\,dx.\n$$\nIntegrating the conservation law over $\\mathcal{C}_i$ gives\n$$\n\\frac{d}{dt}\\left( \\int_{\\mathcal{C}_i} u(x,t)\\,dx \\right) + \\left[ f(u(x_{i+\\tfrac{1}{2}},t)) - f(u(x_{i-\\tfrac{1}{2}},t)) \\right] = 0,\n$$\nor equivalently,\n$$\n\\frac{d\\bar{u}_i}{dt} = -\\frac{1}{\\Delta x}\\left( f_{i+\\tfrac{1}{2}} - f_{i-\\tfrac{1}{2}} \\right),\n$$\nwhere $f_{i\\pm \\tfrac{1}{2}}$ are the fluxes through the cell faces. A first-order explicit time discretization with time step $\\Delta t$ yields\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{\\Delta x}\\left( \\hat{f}_{i+\\tfrac{1}{2}}^n - \\hat{f}_{i-\\tfrac{1}{2}}^n \\right),\n$$\nwith a numerical flux $\\hat{f}_{i+\\tfrac{1}{2}}^n$ consistent with the physics. For linear advection with $a0$, information propagates from left to right, and the exact Riemann solution at each interface depends only on the left state. The Godunov upwind numerical flux is therefore\n$$\n\\hat{f}_{i+\\tfrac{1}{2}}^n = a\\,\\bar{u}_i^n\\quad\\text{for }a0.\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$, the update simplifies to the first-order upwind scheme\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\nu\\left(\\bar{u}_i^n - \\bar{u}_{i-1}^n\\right),\\quad a0,\n$$\nwith periodic indexing on $i$.\n\nTo relate this discrete method to a continuous process and expose numerical diffusion, we perform a modified equation analysis. Denote $\\bar{u}_i^n \\approx u(x_i,t^n)$ with $t^n = n\\Delta t$. A Taylor expansion in time gives\n$$\n\\bar{u}_i^{n+1} - \\bar{u}_i^n = \\Delta t\\,u_t(x_i,t^n) + \\mathcal{O}(\\Delta t^2).\n$$\nA Taylor expansion in space for the backward difference yields\n$$\n\\bar{u}_i^n - \\bar{u}_{i-1}^n = \\Delta x\\,u_x(x_i,t^n) - \\frac{\\Delta x^2}{2}u_{xx}(x_i,t^n) + \\frac{\\Delta x^3}{6}u_{xxx}(x_i,t^n) + \\mathcal{O}(\\Delta x^4).\n$$\nSubstituting into the scheme gives\n$$\n\\Delta t\\,u_t = -\\nu\\left[ \\Delta x\\,u_x - \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\cdots \\right] + \\mathcal{O}(\\Delta t^2).\n$$\nDividing by $\\Delta t$ and recalling $\\nu = a\\Delta t/\\Delta x$,\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}(1 - \\nu)\\,u_{xx} - \\frac{a\\,\\Delta x^2}{6}\\left(1 - 3\\nu + 2\\nu^2\\right)u_{xxx} + \\cdots.\n$$\nThe leading correction is a diffusion term with an effective (artificial) diffusion coefficient\n$$\nD_{\\text{num}} = \\frac{a\\,\\Delta x}{2}(1 - \\nu).\n$$\nThus for $0\\nu1$, the first-order upwind method introduces numerical diffusion that smears discontinuities over a width that grows like $\\sqrt{D_{\\text{num}}\\,t}$, whereas for $\\nu=1$ the leading diffusive term vanishes and the method reduces to a pure shift operator on the grid.\n\nTo quantify smearing for a step, we define the $10$–$90$ thickness. Consider a descending interface where $u$ drops from values near $1$ to values near $0$. Let $\\theta_{\\text{hi}} = 0.9$ and $\\theta_{\\text{lo}} = 0.1$. On the piecewise-constant cell-centered profile $\\{\\bar{u}_i^n\\}$, we determine the approximate positions where $u=\\theta$ by linear interpolation between neighboring cell centers. Specifically, for a pair of neighboring indices $(i,i+1)$ on a descending front with $\\bar{u}_i^n \\ge \\theta  \\bar{u}_{i+1}^n$,\n$$\nx(\\theta) \\approx x_i + \\Delta x \\frac{\\bar{u}_i^n - \\theta}{\\bar{u}_i^n - \\bar{u}_{i+1}^n}.\n$$\nWe collect all downward $\\theta_{\\text{hi}}$ crossings and all downward $\\theta_{\\text{lo}}$ crossings across the domain (with periodic wrap), and for each $\\theta_{\\text{hi}}$ crossing we determine the distance along the periodic coordinate to the subsequent $\\theta_{\\text{lo}}$ crossing. The minimal such distance, denoted $w_{10\\text{–}90}$, is the measured smearing width. This width is reported in the same length units as $L$.\n\nAlgorithmic design:\n- Spatial discretization: uniform cells, periodic boundary conditions, first-order upwind flux $\\hat{f}_{i+\\tfrac{1}{2}}^n = a\\,\\bar{u}_i^n$ for $a0$.\n- Time stepping: forward Euler with fixed $\\Delta t$ satisfying a prescribed $\\nu = a\\,\\Delta t/\\Delta x$; advance for $n=\\text{round}(T/\\Delta t)$ steps.\n- Initialization: block $u(x,0)=1$ on $[0.2L, 0.7L)$ and $0$ elsewhere on $[0,L)$, sampled at cell centers.\n- Width measurement: compute $w_{10\\text{–}90}$ using linear interpolation of cell-centered values and minimal downstream distance between $\\theta_{\\text{hi}}$ and $\\theta_{\\text{lo}}$ crossings along descending interfaces; use periodic unwrapping to handle interfaces near $x=0$.\n\nQualitative expectations based on $D_{\\text{num}}$: for fixed $a$, $L$, and $T$, finer grids (smaller $\\Delta x$) reduce $D_{\\text{num}}$ and thus reduce smearing; larger $\\nu$ (closer to $1$) also reduces $D_{\\text{num}}$, yielding narrower interfaces; at $\\nu=1$, the leading diffusive term vanishes and the interface is limited essentially to a grid-scale thickness. The program implements the scheme and measurement precisely and outputs, for each specified test case $(N,\\nu,T,a,L)$, the smearing width $w_{10\\text{–}90}(t_n)$ rounded to $8$ decimal places, aggregated as a single list on one line as required.",
            "answer": "```python\nimport numpy as np\n\ndef upwind_fvm_step(u, nu):\n    \"\"\"\n    First-order upwind finite volume update for a  0:\n    u_i^{n+1} = u_i^n - nu * (u_i^n - u_{i-1}^n), with periodic indexing.\n    \"\"\"\n    return u - nu * (u - np.roll(u, 1))\n\ndef initialize_block(N, L, xL_frac=0.2, xR_frac=0.7):\n    \"\"\"\n    Initialize u(x,0) = 1 on [x_L, x_R) and 0 elsewhere on [0,L), sampled at cell centers.\n    x_L = xL_frac * L, x_R = xR_frac * L.\n    \"\"\"\n    dx = L / N\n    x = (np.arange(N) + 0.5) * dx\n    xL = xL_frac * L\n    xR = xR_frac * L\n    u0 = np.where((x = xL)  (x  xR), 1.0, 0.0)\n    return x, u0\n\ndef interpolate_crossing_pos(x_i, x_ip1, u_i, u_ip1, theta, L):\n    \"\"\"\n    Linear interpolation between (x_i, u_i) and (x_ip1, u_ip1) to find x where u=theta.\n    The positions x_i and x_ip1 are assumed to be neighbors on a uniform periodic grid.\n    Returns position wrapped into [0, L).\n    \"\"\"\n    # Handle periodic wrap for positions if necessary (assume uniform spacing)\n    # For uniform grid, x_ip1 - x_i = dx and we do not need special position handling for periodicity;\n    # after computing the position, wrap into [0, L).\n    denom = (u_i - u_ip1)\n    if denom == 0.0:\n        return None\n    frac = (u_i - theta) / denom\n    # x along the straight line between centers\n    xi = x_i + (x_ip1 - x_i) * frac\n    # Wrap into [0, L)\n    xi_wrapped = xi % L\n    return xi_wrapped\n\ndef measure_smearing_width(u, x, L, theta_hi=0.9, theta_lo=0.1):\n    \"\"\"\n    Measure the 10-90 smearing width on descending interfaces using linear interpolation\n    between neighboring cell centers. Returns the minimal width among all descending interfaces.\n    \"\"\"\n    N = len(u)\n    dx = L / N\n    # Build arrays of theta_hi and theta_lo crossing positions for descending fronts\n    hi_positions = []\n    lo_positions = []\n    for i in range(N):\n        ip1 = (i + 1) % N\n        u_i = u[i]\n        u_ip1 = u[ip1]\n        # Descending segment if u_i  u_ip1 (strict to avoid degenerate flat segments)\n        if u_i  u_ip1:\n            # theta_hi crossing: u_i = theta_hi  u_ip1\n            if (u_i = theta_hi) and (u_ip1  theta_hi):\n                xi = interpolate_crossing_pos(x[i], x[ip1], u_i, u_ip1, theta_hi, L)\n                if xi is not None:\n                    hi_positions.append(xi)\n            # theta_lo crossing: u_i = theta_lo  u_ip1\n            if (u_i = theta_lo) and (u_ip1  theta_lo):\n                xl = interpolate_crossing_pos(x[i], x[ip1], u_i, u_ip1, theta_lo, L)\n                if xl is not None:\n                    lo_positions.append(xl)\n\n    # Sort positions\n    hi_positions = np.sort(np.array(hi_positions, dtype=float)) if len(hi_positions)  0 else np.array([], dtype=float)\n    lo_positions = np.sort(np.array(lo_positions, dtype=float)) if len(lo_positions)  0 else np.array([], dtype=float)\n\n    if hi_positions.size == 0 or lo_positions.size == 0:\n        # No descending interfaces detected; width undefined. Return 0.0 as fallback.\n        return 0.0\n\n    # For each hi crossing, find the next downstream lo crossing (with periodicity)\n    widths = []\n    for h in hi_positions:\n        # Compute downstream distances to all lo positions with periodic wrap\n        dists = []\n        for l in lo_positions:\n            d = l - h\n            if d  0:\n                d += L\n            dists.append(d)\n        if len(dists)  0:\n            widths.append(min(dists))\n    if len(widths) == 0:\n        return 0.0\n    return float(min(widths))\n\ndef simulate_and_measure(N, nu, T, a, L):\n    \"\"\"\n    Run the first-order upwind FVM for linear advection with given parameters and\n    measure the 10-90 smearing width at time ~ T.\n    \"\"\"\n    dx = L / N\n    dt = nu * dx / a\n    # Number of steps to approximate T with fixed dt\n    nsteps = int(np.round(T / dt))\n    # Initialize\n    x, u = initialize_block(N, L, xL_frac=0.2, xR_frac=0.7)\n    # Time-stepping\n    for _ in range(nsteps):\n        u = upwind_fvm_step(u, nu)\n    # Measure width\n    width = measure_smearing_width(u, x, L, theta_hi=0.9, theta_lo=0.1)\n    return width\n\ndef solve():\n    # Define the test cases: (N, nu, T, a, L)\n    test_cases = [\n        (200, 0.5, 0.2, 1.0, 1.0),  # Case 1\n        (200, 0.9, 0.2, 1.0, 1.0),  # Case 2\n        (200, 0.2, 0.2, 1.0, 1.0),  # Case 3\n        (50,  0.5, 0.2, 1.0, 1.0),  # Case 4\n        (200, 1.0, 0.2, 1.0, 1.0),  # Case 5\n    ]\n\n    results = []\n    for N, nu, T, a, L in test_cases:\n        width = simulate_and_measure(N, nu, T, a, L)\n        # Round to 8 decimal places as required\n        results.append(width)\n\n    # Final print statement in the exact required format with rounding\n    print(\"[\" + \",\".join(f\"{w:.8f}\" for w in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}