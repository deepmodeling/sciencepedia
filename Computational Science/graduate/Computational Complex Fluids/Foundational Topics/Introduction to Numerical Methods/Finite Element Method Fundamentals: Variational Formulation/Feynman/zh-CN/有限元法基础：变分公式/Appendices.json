{
    "hands_on_practices": [
        {
            "introduction": "将连续的偏微分方程转化为离散的代数系统是有限元方法的核心。这个过程始于在单个参考单元上计算基本矩阵。通过为最简单的线性($P1$)拉格朗日基函数手动推导局部质量矩阵和刚度矩阵，我们可以深入理解变分形式如何将微分算子（如拉普拉斯算子）和函数乘积转化为具体的数值数组。",
            "id": "4087582",
            "problem": "在计算复杂流体的背景下，考虑一个标量输运量，其半离散有限元近似来自于标准的伽辽金变分形式。离散算子涉及由双线性形式 $m(u,v)=\\int_{K}uv\\,\\mathrm{d}x$ 和 $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,\\mathrm{d}x$ 分别定义的局部质量矩阵和刚度矩阵。设 $K$ 为平面上顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的参考三角形，并设 $\\{\\phi_{i}\\}_{i=1}^{3}$ 是与这些顶点相关的标准线性拉格朗日节点基（有时称为 $P1$），在笛卡尔坐标系中用 $x$ 和 $y$ 表示为 $\\phi_{1}(x,y)=1-x-y$，$\\phi_{2}(x,y)=x$ 和 $\\phi_{3}(x,y)=y$。从双线性形式的定义出发，计算参考单元 $K$ 上的局部质量矩阵项 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,\\mathrm{d}x$ 和局部刚度矩阵项 $A_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,\\mathrm{d}x$ (对于 $i,j\\in\\{1,2,3\\}$)。你必须直接从上述基本定义推导出这些量，而不能使用预先记忆的单元级公式。将你的最终答案表示为一个单一的复合解析表达式，其中包含并排分组在单个行矩阵中的两个矩阵。使用精确的有理数；无需四舍五-入。不需要物理单位。",
            "solution": "出发点是计算复杂流体中扩散型算子的伽辽金变分形式，其中离散质量矩阵和刚度矩阵分别由双线性形式 $m(u,v)=\\int_{K}u\\,v\\,\\mathrm{d}x$ 和 $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,\\mathrm{d}x$ 定义。在参考三角形 $K=\\{(x,y)\\in\\mathbb{R}^{2}:\\,x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$ 上，其顶点为 $(0,0)$、$(1,0)$、$(0,1)$，面积为 $|K|=\\frac{1}{2}$。线性拉格朗日基函数为 $\\phi_{1}(x,y)=1-x-y$，$\\phi_{2}(x,y)=x$ 和 $\\phi_{3}(x,y)=y$，它们的梯度是常向量：\n$$\n\\nabla\\phi_{1}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix},\\quad\n\\nabla\\phi_{2}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad\n\\nabla\\phi_{3}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n我们首先计算刚度矩阵的各项。由于梯度在 $K$ 上是常数，每一项都是常数点积乘以 $K$ 的面积：\n$$\nA_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,\\mathrm{d}x = \\left(\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\right)|K|.\n$$\n点积为\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{1}=(-1)(-1)+(-1)(-1)=2,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{2}=1,\\quad\n\\nabla\\phi_{3}\\cdot\\nabla\\phi_{3}=1,\n$$\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{2}=(-1)(1)+(-1)(0)=-1,\\quad\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{3}=(-1)(0)+(-1)(1)=-1,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{3}=(1)(0)+(0)(1)=0.\n$$\n乘以 $|K|=\\frac{1}{2}$ 得到\n$$\nA_{11}=2\\cdot\\frac{1}{2}=1,\\quad A_{22}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\\quad A_{33}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\n$$\n$$\nA_{12}=A_{21}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{13}=A_{31}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{23}=A_{32}=0\\cdot\\frac{1}{2}=0.\n$$\n因此，\n$$\nA=\\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}.\n$$\n接下来我们计算质量矩阵的各项 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,\\mathrm{d}x$。我们将积分域参数化为 $0\\le x\\le 1$，$0\\le y\\le 1-x$，因此\n$$\n\\int_{K} f(x,y)\\,\\mathrm{d}x=\\int_{x=0}^{1}\\int_{y=0}^{1-x} f(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x.\n$$\n我们计算一组有代表性的积分，并在适当的地方利用对称性。\n\n对于对角线项：\n1. $M_{22}=\\int_{K}x^{2}\\,\\mathrm{d}x=\\int_{0}^{1}\\int_{0}^{1-x} x^{2}\\,\\mathrm{d}y\\,\\mathrm{d}x=\\int_{0}^{1} x^{2}(1-x)\\,\\mathrm{d}x=\\int_{0}^{1}(x^{2}-x^{3})\\,\\mathrm{d}x=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12}.$\n2. $M_{33}=\\int_{K}y^{2}\\,\\mathrm{d}x$ 根据对称性等于 $M_{22}$，因此 $M_{33}=\\frac{1}{12}.$\n3. $M_{11}=\\int_{K}(1-x-y)^{2}\\,\\mathrm{d}x=\\int_{0}^{1}\\int_{0}^{1-x}(1-x-y)^{2}\\,\\mathrm{d}y\\,\\mathrm{d}x$. 为计算内层关于 $y$ 的积分，我们进行变量代换，令 $u = 1-x-y$，则 $\\mathrm{d}u = -\\mathrm{d}y$。当 $y=0$ 时，$u=1-x$；当 $y=1-x$ 时，$u=0$。因此，内层积分变为：\n$$\n\\int_{y=0}^{1-x} (1-x-y)^2 \\,\\mathrm{d}y = \\int_{u=1-x}^{0} u^2 (-\\mathrm{d}u) = \\int_{0}^{1-x} u^2 \\,\\mathrm{d}u = \\left[\\frac{u^3}{3}\\right]_{0}^{1-x} = \\frac{(1-x)^3}{3}.\n$$\n将此结果代回外层积分：\n$$\nM_{11} = \\int_{0}^{1} \\frac{(1-x)^3}{3} \\,\\mathrm{d}x = \\frac{1}{3} \\left[-\\frac{(1-x)^4}{4}\\right]_{0}^{1} = \\frac{1}{3} \\left(0 - \\left(-\\frac{1^4}{4}\\right)\\right) = \\frac{1}{12}.\n$$\n对于非对角线项：\n4. $M_{23}=\\int_{K}xy\\,\\mathrm{d}x=\\int_{0}^{1}\\int_{0}^{1-x} x y\\,\\mathrm{d}y\\,\\mathrm{d}x=\\int_{0}^{1} x\\cdot \\frac{(1-x)^{2}}{2}\\,\\mathrm{d}x=\\frac{1}{2}\\int_{0}^{1}\\left(x - 2x^{2} + x^{3}\\right)\\,\\mathrm{d}x=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.$\n5. $M_{12}=\\int_{K}x(1-x-y)\\,\\mathrm{d}x=\\int_{0}^{1}\\int_{0}^{1-x}(x - x^{2} - xy)\\,\\mathrm{d}y\\,\\mathrm{d}x=\\int_{0}^{1}\\left(x(1-x) - x^{2}(1-x) - x\\frac{(1-x)^{2}}{2}\\right)\\mathrm{d}x.$\n逐项计算：\n$$\n\\int_{0}^{1}x(1-x)\\,\\mathrm{d}x=\\int_{0}^{1}(x - x^{2})\\,\\mathrm{d}x=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6},\n$$\n$$\n\\int_{0}^{1}x^{2}(1-x)\\,\\mathrm{d}x=\\int_{0}^{1}(x^{2}-x^{3})\\,\\mathrm{d}x=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12},\n$$\n$$\n\\int_{0}^{1}x\\frac{(1-x)^{2}}{2}\\,\\mathrm{d}x=\\frac{1}{2}\\int_{0}^{1}(x - 2x^{2} + x^{3})\\,\\mathrm{d}x=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.\n$$\n因此 $M_{12}=\\frac{1}{6}-\\frac{1}{12}-\\frac{1}{24}=\\frac{4-2-1}{24}=\\frac{1}{24}.$\n6. 根据对称性，$M_{13}=\\frac{1}{24}$。\n\n综合这些结果，\n$$\nM=\\begin{pmatrix}\n\\frac{1}{12}  \\frac{1}{24}  \\frac{1}{24} \\\\\n\\frac{1}{24}  \\frac{1}{12}  \\frac{1}{24} \\\\\n\\frac{1}{24}  \\frac{1}{24}  \\frac{1}{12}\n\\end{pmatrix}=\\frac{1}{24}\\begin{pmatrix}\n2  1  1 \\\\\n1  2  1 \\\\\n1  1  2\n\\end{pmatrix}.\n$$\n将 $M$ 和 $A$ 作为外部行矩阵的项，即可得到将两个矩阵并排分组在单个行矩阵中的最终复合解析表达式。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{24}\\begin{pmatrix}2  1  1 \\\\ 1  2  1 \\\\ 1  1  2\\end{pmatrix}  \\begin{pmatrix}1  -\\frac{1}{2}  -\\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{2}  0 \\\\ -\\frac{1}{2}  0  \\frac{1}{2}\\end{pmatrix}\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然在简单情况下可以对单元矩阵进行解析积分，但在处理高阶单元或复杂几何形状时，这种方法很快变得不切实际。因此，数值求积（或称高斯积分）在有限元实践中至关重要。这个练习旨在阐明如何确定一个合适的求积法则，它不仅要有效率，还必须足够精确，以确保刚度矩阵的计算不会成为整个数值方法的精度瓶颈。",
            "id": "4087531",
            "problem": "考虑一个代表不可压缩复杂流体中粘性耗散项的稳态扩散模型：在一个多边形域中求解 $u$ 使得 $-\\nabla \\cdot (\\mu \\nabla u) = f$，其中 $\\mu$ 是一个正的粘度参数。在有限元法 (FEM) 中，使用协调三角网格上的二次拉格朗日多项式 ($P2$) 基函数，单个三角形 $K$ 上的单元刚度矩阵的元素为 $A_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x$，其中 $\\{\\varphi_{i}\\}$ 是 $K$ 上的局部 $P2$ 基函数。假设在每个单元 $K$ 上，从参考三角形 $\\hat{K}$ 到该单元的映射是仿射的，即 $F(\\hat{x}) = B \\hat{x} + b$，其中雅可比矩阵 $B$ 为常数，并且 $\\mu$ 在每个单元上是常数（即分片常数）。\n\n从弱形式和仿射映射下梯度的变换法则出发，确定每个局部刚度矩阵元素 $A_{ij}$ 中被积函数的总多项式次数，将其表示为三角形上拉格朗日基的多项式次数 $k$ 的函数。然后，将情况特殊化为 $k=2$，并推导出一个三角形求积法则为在每个单元 $K$ 上精确积分所有这些元素所需的最小精确次数 $q$。最后，在对称高斯型三角形求积法则中，选择一个尺寸最小且能对所有次数不超过 $q$ 的多项式达到精确积分的法则，并报告所需的最小求积点数 $N$。\n\n最终答案请提供单个整数 $N$。无需四舍五入。",
            "solution": "本任务是确定在有限元法 (FEM) 的背景下，为精确计算单元刚度矩阵的元素所需的最小求积点数 $N$。该问题由稳态扩散方程 $-\\nabla \\cdot (\\mu \\nabla u) = f$ 定义，并使用三角网格上的二次拉格朗日 ($P2$) 基函数进行离散化。\n\n单个三角形 $K$ 上的单元刚度矩阵的元素由以下积分给出：\n$$\nA_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x\n$$\n在此，$\\mu$ 在单元 $K$ 上是一个常数，$\\{\\varphi_i\\}$ 是局部的 $P2$ 基函数。\n\n为了确定所需的求积精度，我们必须首先求出被积函数的多项式次数。这通常通过将积分从物理单元 $K$ 变换到规范的参考单元 $\\hat{K}$ 来完成。\n\n问题陈述，从参考单元 $\\hat{K}$ 到物理单元 $K$ 的映射是仿射的：\n$$\nx = F(\\hat{x}) = B \\hat{x} + b\n$$\n其中 $B$ 是变换的常数雅可比矩阵，$b$ 是一个常数向量。积分中的变量变换会引入雅可比行列式 $|\\det(B)|$，对于这种仿射映射，它是一个常数。\n\n物理单元上的基函数 $\\varphi_i$ 是次数为 $k$ 的多项式，它们通过 $\\varphi_i(x) = \\hat{\\varphi}_i(F^{-1}(x))$ 与参考单元上的基函数 $\\hat{\\varphi}_i$ 相关。函数 $\\hat{\\varphi}_i(\\hat{x})$ 是参考坐标 $\\hat{x}$ 中次数为 $k$ 的多项式。\n\n基函数 $\\varphi_i$ 在物理坐标 $x$ 中的梯度通过链式法则与参考坐标 $\\hat{x}$ 中的梯度 $\\hat{\\varphi}_i$ 相关：\n$$\n\\nabla_x \\varphi_i = (B^{-1})^T \\nabla_{\\hat{x}} \\hat{\\varphi}_i\n$$\n由于 $\\hat{\\varphi}_i$ 是一个次数为 $k$ 的多项式，其梯度 $\\nabla_{\\hat{x}} \\hat{\\varphi}_i$ 是一个矢量，其分量是参考坐标 $\\hat{x}$ 中次数为 $k-1$ 的多项式。由于矩阵 $(B^{-1})^T$ 是常数，向量 $\\nabla_x \\varphi_i$ 由 $\\hat{x}$ 中次数为 $k-1$ 的多项式组成。\n\n接下来，我们分析点积项 $\\nabla \\varphi_i \\cdot \\nabla \\varphi_j$。这是两个向量的标量积，其分量均为次数为 $k-1$ 的多项式。得到的标量函数是一个次数最多为 $(k-1) + (k-1) = 2k-2$ 的多项式。\n$$\n\\text{degree}(\\nabla \\varphi_i \\cdot \\nabla \\varphi_j) = 2k-2\n$$\n刚度矩阵元素的完整被积函数，当用参考坐标表示时，为：\n$$\n\\text{Integrand}(\\hat{x}) = \\mu \\, (\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}) \\, |\\det(B)|\n$$\n参数 $\\mu$ 被指定为分片常数，因此在单元 $K$ 上是一个常数（0次多项式）。雅可比行列式 $|\\det(B)|$ 也是一个常数。因此，要在参考单元 $\\hat{K}$ 上积分的函数的总多项式次数完全由点积项决定，即 $2k-2$。\n\n问题指定使用二次拉格朗日 ($P2$) 基函数。对于这些函数，多项式次数为 $k=2$。将此值代入我们的被积函数次数公式，得到：\n$$\n\\text{Degree of integrand} = 2(2) - 2 = 2\n$$\n因此，被积函数是一个2次多项式。数值求积法则必须能够精确积分所有次数不超过此次数的多项式。因此，求积法则所需的最小精确次数为 $q=2$。\n\n最后一步是找到一个具有最少点数 $N$ 的对称三角形求积法则，该法则对所有次数不超过 $q=2$ 的多项式都是精确的。我们考虑标准的三角形对称求积法则：\n- 一个单点法则 ($N=1$)，使用单元的形心，对次数不超过 $q=1$ 的多项式是精确的。这不满足要求。\n- 一个对称三点法则 ($N=3$)，它使用三条边的中点作为求积点，对次数不超过 $q=2$ 的多项式是精确的。这满足要求。\n- 更高阶的法则，例如四点法则 ($q=3$)，也能工作，但在点数上不是最少的。\n\n对于三角形，不存在具有 $N=2$ 个点的对称法则。因此，一个对称法则要对次数为2的多项式达到精确所需的最小点数为 $N=3$。\n\n所需的最小求积点数为3。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "许多复杂的流体流动，如纳维-斯托克斯方程所描述的那些，本质上是非线性的，这使得它们无法直接求解。牛顿法等迭代策略是求解这些方程的标准工具，但它们要求在每一步都对非线性系统进行线性化。本练习将演示如何在变分（弱形式）框架内，通过计算伽辽金导数（Gateaux derivative）来推导这种线性化所需的“一致切线算子”，这是在高级计算流体动力学中应用有限元方法的一项核心技能。",
            "id": "4087561",
            "problem": "考虑在有界域 $\\Omega \\subset \\mathbb{R}^{d}$（$d \\in \\{2,3\\}$）中一种牛顿流体的稳态不可压缩流动，其边界 $\\partial \\Omega$ 上的外单位法向量为 $\\boldsymbol{n}$。控制偏微分方程 (PDE) 模型是稳态不可压缩 Navier–Stokes 方程，具有恒定密度 $\\rho > 0$ 和动力粘度 $\\mu > 0$，并在边界 $\\partial \\Omega$ 上服从齐次 Dirichlet 边界条件 $\\boldsymbol{u} = \\boldsymbol{0}$：\n$$\n\\rho (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{f} \\quad \\text{在 } \\Omega \\text{ 中}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{在 } \\Omega \\text{ 中},\n$$\n其中 $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^{d}$ 是速度，$p:\\Omega \\to \\mathbb{R}$ 是压力，$\\boldsymbol{f}:\\Omega \\to \\mathbb{R}^{d}$ 是彻体力，牛顿流体的 Cauchy 应力张量由下式给出\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p \\boldsymbol{I} + 2\\mu \\boldsymbol{D}(\\boldsymbol{u}), \\quad \\text{其中 } \\boldsymbol{D}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right).\n$$\n令试验空间为 $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ 和 $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$，并令相应的测试空间与之一致。对于计算流体力学 (CFD) 的有限元法 (FEM)，其弱残差算子对给定的对 $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ 和测试对 $(\\boldsymbol{w},q) \\in \\boldsymbol{V} \\times Q$ 定义如下：\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x.\n$$\n将 $\\mathcal{R}$ 关于 $(\\boldsymbol{u},p)$ 沿方向 $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$ 的 Gateaux 导数定义为\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}.\n$$\n仅从上述定义以及张量微积分和弱形式的基本定律和性质出发，推导 $\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p]$ 的显式解析表达式，该表达式构成了弱形式下 Newton 法所需的一致切线算子。您的最终答案应该是 Gateaux 导数的闭式积分表达式，该表达式是关于 $(\\delta \\boldsymbol{u}, \\delta p)$ 和测试函数 $(\\boldsymbol{w},q)$ 的双线性形式，并用当前迭代值 $(\\boldsymbol{u},p)$、参数 $\\rho$ 和 $\\mu$ 以及上面定义的算子来表示。如果引入任何中间符号，请明确定义。无需进行舍入。最终结果请勿包含物理单位。",
            "solution": "该问题陈述是计算流体力学领域中一个有效、适定且有科学依据的问题。它要求推导稳态不可压缩 Navier–Stokes 方程弱形式的一致切线算子。该算子是弱残差的 Gateaux 导数，是使用 Newton 法求解由有限元法 (FEM) 离散化产生的非线性代数系统的基本组成部分。我将进行严谨的推导。\n\n我们的目标是计算弱残差算子 $\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)$ 关于状态变量 $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ 沿任意增量 $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$ 方向的 Gateaux 导数。所提供的定义是：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}\n$$\n其中 $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ 且 $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$。\n\n弱残差算子由下式给出：\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n$$\n为计算该导数，我们首先将微扰状态 $(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p)$ 代入 $\\mathcal{R}$ 的表达式中：\n\\begin{align*}\n\\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q) =  \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x \\\\\n + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x \\\\\n - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x \\\\\n + \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x \\\\\n - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n\\end{align*}\n我们可以通过考察每一项对参数 $\\varepsilon$ 的依赖关系来分析该导数。让我们记 $\\mathcal{R}_{\\varepsilon} = \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q)$。该导数可通过将 $\\mathcal{R}_{\\varepsilon}$ 对 $\\varepsilon$ 求导并令 $\\varepsilon = 0$ 得到。由于积分和对 $\\varepsilon$ 的微分是可交换的（根据 Leibniz 积分法则，因为域 $\\Omega$ 是固定的），我们可以对每一项的被积函数进行微分。\n\n1.  **对流项：**\n    令 $I_1(\\varepsilon) = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x$。\n    积分内的项是关于 $\\varepsilon$ 的二次项：\n    $$\n    ((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon ((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u}\n    $$\n    将此表达式对 $\\varepsilon$ 求导并在 $\\varepsilon = 0$ 处取值，得到：\n    $$\n    \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon ((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} \\right]\\right|_{\\varepsilon=0} = (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\n    $$\n    因此，第一积分项的导数为：\n    $$\n    \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left( (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} \\right) \\, \\mathrm{d}x\n    $$\n\n2.  **扩散项：**\n    令 $I_2(\\varepsilon) = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x$。\n    应变率张量算子 $\\boldsymbol{D}$ 是线性的。因此：\n    $$\n    \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\boldsymbol{D}(\\boldsymbol{u}) + \\varepsilon \\boldsymbol{D}(\\delta \\boldsymbol{u})\n    $$\n    $I_2(\\varepsilon)$ 项是关于 $\\varepsilon$ 的线性项。其导数是 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n3.  **压力项：**\n    令 $I_3(\\varepsilon) = - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x$。\n    此项也是关于 $\\varepsilon$ 的线性项。其导数即为 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n4.  **连续性项：**\n    令 $I_4(\\varepsilon) = \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x$。\n    散度算子 $\\nabla \\cdot$ 是线性的。因此：\n    $$\n    \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\nabla \\cdot \\boldsymbol{u} + \\varepsilon (\\nabla \\cdot \\delta \\boldsymbol{u})\n    $$\n    $I_4(\\varepsilon)$ 项是关于 $\\varepsilon$ 的线性项，其导数是 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n    $$\n\n5.  **源项：**\n    令 $I_5(\\varepsilon) = - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x$。\n    此项与 $\\varepsilon$ 无关，因此其导数为零：\n    $$\n    \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = 0\n    $$\n\n将所有项的导数相加，得到 Gateaux 导数的最终表达式：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}\n$$\n代入推导出的表达式，得到一致切线算子：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n$$\n该表达式是关于增量 $(\\delta \\boldsymbol{u}, \\delta p)$ 和测试函数 $(\\boldsymbol{w},q)$ 的双线性形式，并且它依赖于当前解的迭代值 $\\boldsymbol{u}$，这与应用于此非线性问题的 Newton 法的 Jacobian 矩阵的预期一致。",
            "answer": "$$\n\\boxed{\\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x}\n$$"
        }
    ]
}