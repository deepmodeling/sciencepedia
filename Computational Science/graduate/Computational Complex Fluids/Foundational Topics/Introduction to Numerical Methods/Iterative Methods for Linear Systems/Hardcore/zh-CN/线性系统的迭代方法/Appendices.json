{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本但至关重要的原则开始：并非所有迭代方法都对所有线性系统收敛。本练习将通过一个具体的例子，展示一个雅可比方法会失效的系统，从而引导我们深入探究迭代矩阵的内部机制。理解迭代矩阵的谱半径与收敛性之间的联系 ，是分析和选择数值方法的关键第一步。",
            "id": "2182318",
            "problem": "迭代法是一种数值方法，它为一类问题生成一个不断改进的近似解序列。对于线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中一种方法是 Jacobi 方法。矩阵 $A$ 可以分解为 $A = D - L - U$，其中 $D$ 是 $A$ 的对角部分，$-L$ 是 $A$ 的严格下三角部分，$-U$ 是 $A$ 的严格上三角部分。\n\nJacobi 迭代由以下公式定义：\n$$D\\mathbf{x}^{(k+1)} = (L+U)\\mathbf{x}^{(k)} + \\mathbf{b}$$\n这可以重写为形式 $\\mathbf{x}^{(k+1)} = T_J \\mathbf{x}^{(k)} + \\mathbf{c}$，其中 $T_J = D^{-1}(L+U)$ 被称为 Jacobi 迭代矩阵。该方法的收敛性由该矩阵的性质决定。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + 3x_2 = 5 \\\\\n4x_1 + 2x_2 = 6\n\\end{align*}\n$$\n求与该系统对应的 Jacobi 迭代矩阵 $T_J$ 的两个特征值。将你的答案表示为一个包含这两个特征值的行矩阵，并按数值升序排列。",
            "solution": "给定的线性方程组为：\n$$\n\\begin{align*}\n2x_1 + 3x_2 = 5 \\\\\n4x_1 + 2x_2 = 6\n\\end{align*}\n$$\n这可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$A = \\begin{pmatrix} 2  3 \\\\ 4  2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ 6 \\end{pmatrix}$$\n\n为了求 Jacobi 迭代矩阵 $T_J$，我们首先将矩阵 $A$ 分解为其对角部分（$D$）、严格下三角部分（$-L$）和严格上三角部分（$-U$）。\n$$A = D - L - U$$\n从矩阵 $A$ 中，我们确定：\n$$D = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}$$\n$$L = \\begin{pmatrix} 0  0 \\\\ -4  0 \\end{pmatrix}$$\n$$U = \\begin{pmatrix} 0  -3 \\\\ 0  0 \\end{pmatrix}$$\n\nJacobi 迭代矩阵定义为 $T_J = D^{-1}(L+U)$。\n首先，我们求对角矩阵 $D$ 的逆矩阵：\n$$D^{-1} = \\begin{pmatrix} 1/2  0 \\\\ 0  1/2 \\end{pmatrix}$$\n接下来，我们计算 $L$ 和 $U$ 的和：\n$$L+U = \\begin{pmatrix} 0  0 \\\\ -4  0 \\end{pmatrix} + \\begin{pmatrix} 0  -3 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -3 \\\\ -4  0 \\end{pmatrix}$$\n现在，我们可以计算迭代矩阵 $T_J$：\n$$T_J = D^{-1}(L+U) = \\begin{pmatrix} 1/2  0 \\\\ 0  1/2 \\end{pmatrix} \\begin{pmatrix} 0  -3 \\\\ -4  0 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (0)(-4)  (1/2)(-3) + (0)(0) \\\\ (0)(0) + (1/2)(-4)  (0)(-3) + (1/2)(0) \\end{pmatrix}$$\n$$T_J = \\begin{pmatrix} 0  -3/2 \\\\ -2  0 \\end{pmatrix}$$\n\n为了求 $T_J$ 的特征值，我们求解特征方程 $\\det(T_J - \\lambda I) = 0$，其中 $I$ 是单位矩阵。\n$$T_J - \\lambda I = \\begin{pmatrix} 0  -3/2 \\\\ -2  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} -\\lambda  -3/2 \\\\ -2  -\\lambda \\end{pmatrix}$$\n行列式为：\n$$\\det(T_J - \\lambda I) = (-\\lambda)(-\\lambda) - (-3/2)(-2) = \\lambda^2 - 3$$\n将行列式设为零，得到特征方程：\n$$\\lambda^2 - 3 = 0$$\n解出 $\\lambda$，我们得到：\n$$\\lambda^2 = 3$$\n$$\\lambda = \\pm\\sqrt{3}$$\n两个特征值为 $\\sqrt{3}$ 和 $-\\sqrt{3}$。\n\n题目要求将特征值以行矩阵的形式按升序排列。\n升序为 $-\\sqrt{3}$，然后是 $\\sqrt{3}$。\n迭代矩阵的谱半径为 $\\rho(T_J) = \\max(|\\sqrt{3}|, |-\\sqrt{3}|) = \\sqrt{3} \\approx 1.732$。由于 $\\rho(T_J) > 1$，对于该系统，Jacobi 方法将是发散的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\sqrt{3}  \\sqrt{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然定常迭代法是基础，但诸如共轭梯度（CG）之类的克雷洛夫子空间方法通常能提供更快的收敛速度。然而，其强大的功能也伴随着更严格的应用条件。本练习将深入探讨共轭梯度方法的理论基础，揭示为何该方法仅对特定类型的系统（对称正定矩阵）保证有效，以及在不满足该条件时会如何失效 。通过从第一性原理出发，我们能更深刻地理解算法的适用边界。",
            "id": "3245204",
            "problem": "考虑将共轭梯度（CG）法应用于线性系统 $A x = b$，其中 $A$ 是对称但非正定的。CG 方法的经典定义是通过沿着搜索方向 $p_k$ 最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$，其中残差为 $r_k = b - A x_k$，初始搜索方向为 $p_0 = r_0$。从第一性原理出发，步长 $\\alpha_k$ 是通过最小化 $\\phi(x_k + \\alpha p_k)$（相对于标量 $\\alpha$）来确定的。\n\n使用以下具体例子进行计算\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \n\\quad \nb = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \n\\quad \nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n从 $\\phi(x)$ 的定义和沿 $p_k$ 的最优性方向导数条件出发，推导步长 $\\alpha_0$ 关于 $p_0$ 和 $r_0$ 的表达式，并指出当 $A$ 是正定矩阵时，哪个分母必须为严格正值。然后，对于给定的 $A$、$b$ 和 $x_0$，计算标量 $p_0^{\\mathsf{T}} A p_0$，并用这个值解释在此情况下 CG 步是否是良定义的，以及为什么该方法对于这个非正定矩阵 $A$ 会失效。\n\n你最终报告的答案应该是 $p_0^{\\mathsf{T}} A p_0$ 的数值。无需四舍五入。",
            "solution": "问题要求分析将共轭梯度（CG）法应用于线性系统 $A x = b$ 的情况，其中矩阵 $A$ 是对称但非正定的。我们将首先从第一性原理推导步长 $\\alpha_k$ 的通用公式，然后将其应用于所提供的具体案例，以证明该方法的失效。\n\nCG 方法旨在通过最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 来找到解 $x$。该泛函的梯度为 $\\nabla \\phi(x) = A x - b$，即残差 $r = b - A x$ 的负值。该方法通过生成一系列近似解 $x_{k+1} = x_k + \\alpha_k p_k$ 来迭代进行，其中 $p_k$ 是一个搜索方向，$\\alpha_k$ 是为最小化 $\\phi(x_k + \\alpha_k p_k)$ 而选择的步长。\n\n为了推导 $\\alpha_k$，我们定义一个单变量 $\\alpha$ 的函数：\n$$f(\\alpha) = \\phi(x_k + \\alpha p_k) = \\frac{1}{2} (x_k + \\alpha p_k)^{\\mathsf{T}} A (x_k + \\alpha p_k) - b^{\\mathsf{T}} (x_k + \\alpha p_k)$$\n展开各项，我们得到：\n$$f(\\alpha) = \\frac{1}{2} (x_k^{\\mathsf{T}} A x_k + \\alpha x_k^{\\mathsf{T}} A p_k + \\alpha p_k^{\\mathsf{T}} A x_k + \\alpha^2 p_k^{\\mathsf{T}} A p_k) - b^{\\mathsf{T}} x_k - \\alpha b^{\\mathsf{T}} p_k$$\n由于 $A$ 是对称的，即 $A = A^{\\mathsf{T}}$，标量 $p_k^{\\mathsf{T}} A x_k = (x_k^{\\mathsf{T}} A^{\\mathsf{T}} p_k)^{\\mathsf{T}} = (x_k^{\\mathsf{T}} A p_k)^{\\mathsf{T}} = x_k^{\\mathsf{T}} A p_k$。我们可以按 $\\alpha$ 的幂次对各项进行分组：\n$$f(\\alpha) = \\left(\\frac{1}{2} x_k^{\\mathsf{T}} A x_k - b^{\\mathsf{T}} x_k\\right) + \\alpha (x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k) + \\frac{1}{2} \\alpha^2 (p_k^{\\mathsf{T}} A p_k)$$\n第一项是 $\\phi(x_k)$。关于 $\\alpha$ 的线性项可以使用残差 $r_k = b - A x_k$ 重写。\n$$x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k = -(b - A x_k)^{\\mathsf{T}} p_k = -r_k^{\\mathsf{T}} p_k$$\n因此，要最小化的函数是：\n$$f(\\alpha) = \\phi(x_k) - \\alpha r_k^{\\mathsf{T}} p_k + \\frac{1}{2} \\alpha^2 p_k^{\\mathsf{T}} A p_k$$\n为了找到最小值，我们对 $\\alpha$ 求导并令其为零，这由“最优性的方向导数条件”所决定：\n$$\\frac{df}{d\\alpha} = -r_k^{\\mathsf{T}} p_k + \\alpha p_k^{\\mathsf{T}} A p_k = 0$$\n求解 $\\alpha$ 得到步长 $\\alpha_k$：\n$$\\alpha_k = \\frac{r_k^{\\mathsf{T}} p_k}{p_k^{\\mathsf{T}} A p_k}$$\n对于第一次迭代（$k=0$），其中搜索方向 $p_0$ 被设为初始残差 $r_0$，该式变为：\n$$\\alpha_0 = \\frac{r_0^{\\mathsf{T}} r_0}{r_0^{\\mathsf{T}} A r_0}$$\n此表达式中的分母是 $p_k^{\\mathsf{T}} A p_k$。为了使 CG 方法是良定义的，并且步长对应于 $\\phi$ 沿搜索方向的最小值， $f(\\alpha)$ 的二阶导数必须为正：\n$$\\frac{d^2f}{d\\alpha^2} = p_k^{\\mathsf{T}} A p_k > 0$$\n如果 $A$ 是对称正定（SPD）的，那么根据定义，对于任何非零向量 $v$，都有 $v^{\\mathsf{T}} A v > 0$。由于 CG 算法生成的搜索方向 $p_k$ 是非零的（除非已经找到精确解），因此当 $A$ 是 SPD 时，分母 $p_k^{\\mathsf{T}} A p_k$ 保证是严格正的。\n\n现在我们分析所提供的具体案例：\n$$A = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n矩阵 $A$ 是对称的，但其特征值为 $1$ 和 $-1$，所以它不是正定的。\n首先，我们计算初始残差 $r_0$：\n$$r_0 = b - A x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n初始搜索方向为 $p_0 = r_0$，所以 $p_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n问题要求计算标量 $p_0^{\\mathsf{T}} A p_0$，这是计算步长 $\\alpha_0$ 所需的分母。\n$$p_0^{\\mathsf{T}} A p_0 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n首先，我们计算乘积 $A p_0$：\n$$A p_0 = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + (-1) \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$$\n现在我们计算最终的内积：\n$$p_0^{\\mathsf{T}} (A p_0) = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = (1)(1) + (1)(-1) = 1 - 1 = 0$$\n因此，分母的值为 $p_0^{\\mathsf{T}} A p_0 = 0$。\n\nCG 步不是良定义的，因为计算步长 $\\alpha_0$ 需要除以这个量。分子是 $r_0^{\\mathsf{T}} p_0 = r_0^{\\mathsf{T}} r_0 = 1^2 + 1^2 = 2$。因此，$\\alpha_0 = \\frac{2}{0}$，这是无定义的。算法在第一次迭代时就失效了。\n\n发生这种失效是因为条件 $p_0^{\\mathsf{T}} A p_0 > 0$ 被违反了。当 $p_0^{\\mathsf{T}} A p_0 = 0$ 时，函数 $f(\\alpha) = \\phi(x_0 + \\alpha p_0)$ 不再是一个凸二次函数。它变成一个线性函数：\n$$f(\\alpha) = \\phi(x_0) - \\alpha (r_0^{\\mathsf{T}} p_0) = \\phi(x_0) - 2\\alpha$$\n一个非常数的线性函数在实数线上没有最小值。CG 方法之所以失败，是因为它的核心假设——即它可以在搜索方向上找到二次泛函的最小值——没有得到满足。这揭示了标准 CG 方法仅限于具有对称正定矩阵的系统的根本原因。\n$p_0^{\\mathsf{T}} A p_0$ 的数值是 $0$。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}