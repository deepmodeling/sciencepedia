{
    "hands_on_practices": [
        {
            "introduction": "Many models in computational complex fluids, such as the Maxwell model for viscoelasticity, give rise to \"stiff\" ordinary differential equations. This stiffness occurs when the system involves processes with vastly different time scales, like a fast polymer relaxation and a slow macroscopic flow. This practice provides a foundational exercise in numerical stability, asking you to derive the strict time step limit for the explicit Euler method when applied to such a system. Understanding this constraint is the first step toward appreciating why more advanced implicit methods are often necessary for simulating stiff phenomena efficiently.",
            "id": "4105091",
            "problem": "In computational complex fluids, the linear Maxwell constitutive equation for the shear stress $ \\sigma(t) $ under an imposed shear rate $ \\dot{\\gamma}(t) $ is given by the ordinary differential equation (ODE)\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t),\n$$\nwhere $ \\tau $ is the relaxation time and $ G $ is the elastic modulus. Consider advancing this ODE in time on a uniform grid with time step $ \\Delta t $ using the explicit Euler method applied directly to the constitutive equation in its given form. Using stability analysis grounded in the behavior of the homogeneous part of the ODE, determine the largest admissible $ \\Delta t $ that guarantees absolute stability of the explicit Euler update, expressed solely in terms of $ \\tau $. Briefly explain how this stability limit constrains the simulation of fast relaxation (small $ \\tau $) relative to macroscopic time scales. Provide your final answer as a single closed-form expression in terms of $ \\tau $. No numerical rounding is required, and no units should be included in your final expression.",
            "solution": "The problem requires determining the stability limit of the explicit Euler method for the linear Maxwell constitutive equation. The governing ordinary differential equation (ODE) is:\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t)\n$$\nwhere $\\sigma$ is the shear stress, $t$ is time, $\\tau$ is the relaxation time, $G$ is the elastic modulus, and $\\dot{\\gamma}(t)$ is the imposed shear rate.\n\nThe stability of a numerical scheme for a linear ODE is determined by its behavior when applied to the homogeneous part of the equation. The forcing term, $G \\, \\dot{\\gamma}(t)$, does not influence the intrinsic stability of the numerical method itself. The homogeneous part of the Maxwell equation is:\n$$\n\\frac{d \\sigma_h}{d t} = -\\frac{1}{\\tau} \\sigma_h\n$$\nWe seek to advance this equation from time $t_n$ to $t_{n+1} = t_n + \\Delta t$, where $\\Delta t$ is the constant time step. Let $\\sigma_h^n$ be the numerical approximation of $\\sigma_h(t_n)$.\n\nThe explicit (or forward) Euler method approximates the time derivative as:\n$$\n\\left. \\frac{d \\sigma_h}{d t} \\right|_{t=t_n} \\approx \\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t}\n$$\nSubstituting this approximation into the homogeneous ODE, we evaluate the right-hand side at time $t_n$:\n$$\n\\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t} = -\\frac{1}{\\tau} \\sigma_h^n\n$$\nTo find the update rule, we solve for $\\sigma_h^{n+1}$:\n$$\n\\sigma_h^{n+1} = \\sigma_h^n - \\frac{\\Delta t}{\\tau} \\sigma_h^n\n$$\nFactoring out $\\sigma_h^n$, we obtain the iterative map:\n$$\n\\sigma_h^{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\sigma_h^n\n$$\nThis equation shows that the solution at step $n+1$ is obtained by multiplying the solution at step $n$ by an amplification factor, $g$. In this case, the amplification factor is:\n$$\ng = 1 - \\frac{\\Delta t}{\\tau}\n$$\nFor the numerical scheme to be absolutely stable, any initial error or perturbation must not grow in magnitude over time. This requires the magnitude of the amplification factor to be less than or equal to $1$:\n$$\n|g| \\le 1\n$$\nSubstituting the expression for $g$, we get the stability condition:\n$$\n\\left| 1 - \\frac{\\Delta t}{\\tau} \\right| \\le 1\n$$\nThis absolute value inequality is equivalent to the compound inequality:\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\le 1\n$$\nWe analyze the two parts of this inequality separately.\n\nFirst, the right-hand side:\n$$\n1 - \\frac{\\Delta t}{\\tau} \\le 1 \\implies -\\frac{\\Delta t}{\\tau} \\le 0 \\implies \\frac{\\Delta t}{\\tau} \\ge 0\n$$\nSince the time step $\\Delta t$ and the relaxation time $\\tau$ are both positive physical quantities, this condition is always satisfied.\n\nSecond, the left-hand side:\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\implies \\frac{\\Delta t}{\\tau} \\le 1 + 1 \\implies \\frac{\\Delta t}{\\tau} \\le 2\n$$\nThis gives us the critical constraint on the time step. Combining both conditions, the requirement for absolute stability is:\n$$\n\\Delta t \\le 2\\tau\n$$\nThe problem asks for the largest admissible $\\Delta t$ that guarantees stability. This corresponds to the upper bound of the derived inequality. Therefore, the maximum stable time step is:\n$$\n\\Delta t_{\\text{max}} = 2\\tau\n$$\nThis stability limit has a significant implication for simulating systems with fast relaxation dynamics, which are characterized by a small relaxation time $\\tau$. The constraint $\\Delta t \\le 2\\tau$ dictates that the time step must be of the same order as the fastest relaxation process in the system. If $\\tau$ is very small (e.g., microseconds), while the overall process of interest occurs on a much longer macroscopic time scale (e.g., seconds), the number of time steps required to complete the simulation ($N = T_{\\text{total}} / \\Delta t$) becomes prohibitively large. This makes the simulation computationally extremely expensive. This problem is a classic example of numerical stiffness, where an explicit method's stability is severely restricted by a fast time scale that may be of little importance to the overall system dynamics. This often motivates the use of implicit methods, which can have much larger stability regions, for stiff problems.",
            "answer": "$$\\boxed{2\\tau}$$"
        },
        {
            "introduction": "Beyond merely avoiding catastrophic instability, a good numerical integrator should faithfully reproduce the qualitative physical behavior of the system, such as the dissipation of energy in a gradient flow. This exercise delves into a more subtle aspect of numerical error by analyzing how the explicit and implicit Euler schemes affect a system's energy over a single step. By performing a modified equation analysis, you will uncover how the explicit method can artifactually introduce energy (numerical anti-dissipation) while the implicit method can enhance it, providing a deeper insight into the structural differences between these schemes.",
            "id": "4105096",
            "problem": "Consider a nondimensional scalar gradient flow representative of a single-degree-of-freedom truncation of an order-parameter dynamics in a complex fluid, given by the ordinary differential equation $u'(t) = - \\partial_{u} E(u)$ with energy $E(u) = \\frac{\\lambda}{4} \\left(u^{2} - 1\\right)^{2}$, initial condition $u(0) = a$, and time step $\\Delta t  0$. Two time-integration schemes are used for one step from $t^{0}$ to $t^{1} = t^{0} + \\Delta t$:\n- Explicit Euler: $u^{1} = u^{0} + \\Delta t \\, f(u^{0})$,\n- Implicit Euler: $u^{1} = u^{0} + \\Delta t \\, f(u^{1})$,\nwhere $f(u) = - \\partial_{u} E(u)$ and $u^{0} = a$.\n\nUsing only fundamental definitions and Taylor expansions, complete the following tasks.\n\n- Using a modified equation analysis accurate through the leading perturbation of order $\\mathcal{O}(\\Delta t)$ to the vector field, derive for each scheme the leading-order correction to the energy dissipation over a single step. In particular, for each scheme obtain the coefficient $C_{\\text{scheme}}(a,\\lambda)$ in the expansion\n$$\nE(u^{1}) - E(u^{0}) \\;=\\; - \\left[\\partial_{u} E(a)\\right]^{2} \\, \\Delta t \\;+\\; C_{\\text{scheme}}(a,\\lambda) \\, \\Delta t^{2} \\;+\\; \\mathcal{O}(\\Delta t^{3}) \\, .\n$$\n\n- Independently, verify your prediction by computing $E(u^{1}) - E(u^{0})$ to order $\\mathcal{O}(\\Delta t^{2})$ via a direct discrete Taylor expansion for each scheme, starting from $u^{0} = a$, and confirm agreement with the modified equation result.\n\nDefine $C = C_{\\text{explicit}}(a,\\lambda) - C_{\\text{implicit}}(a,\\lambda)$. Provide the final answer as a single closed-form analytic expression for $C$ in terms of $a$ and $\\lambda$. All quantities are nondimensional. No rounding is required, and no units should be reported in the final expression.",
            "solution": "The problem asks for the coefficient $C_{\\text{scheme}}(a,\\lambda)$ in the expansion of the energy change over one time step $\\Delta t$, starting from $u^0 = a$:\n$$E(u^{1}) - E(u^{0}) = - \\left[\\partial_{u} E(a)\\right]^{2} \\, \\Delta t \\;+\\; C_{\\text{scheme}}(a,\\lambda) \\, \\Delta t^{2} \\;+\\; \\mathcal{O}(\\Delta t^{3})$$\nThe governing ordinary differential equation (ODE) is a gradient flow $u'(t) = - \\partial_{u} E(u)$, where the force term is $f(u) = - \\partial_{u} E(u)$. The energy functional is $E(u) = \\frac{\\lambda}{4} \\left(u^{2} - 1\\right)^{2}$.\n\nWe will verify the result via direct discrete Taylor expansion.\nWe expand $E(u^1)$ around $u^0=a$ up to second order in the increment $(u^1 - a)$:\n$E(u^1) - E(a) = (\\partial_u E(a)) (u^1 - a) + \\frac{1}{2} (\\partial_u^2 E(a)) (u^1 - a)^2 + \\mathcal{O}((u^1-a)^3)$.\nSince $u^1-a = \\mathcal{O}(\\Delta t)$, we only need terms up to $(\\Delta t)^2$.\n\n**Explicit Euler:** $u^1 = a + \\Delta t f(a)$.\nThe increment is $u^1 - a = \\Delta t f(a)$. The square of the increment is $(u^1-a)^2 = (\\Delta t)^2 f(a)^2$.\nSubstituting into the energy expansion:\n$E(u^1) - E(a) = (\\partial_u E(a)) (\\Delta t f(a)) + \\frac{1}{2} (\\partial_u^2 E(a)) ((\\Delta t)^2 f(a)^2) + \\mathcal{O}(\\Delta t^3)$.\nUsing $f(a) = -\\partial_u E(a)$:\n$E(u^1) - E(a) = (\\partial_u E(a)) (-\\Delta t \\partial_u E(a)) + \\frac{1}{2} (\\partial_u^2 E(a)) (\\Delta t^2 (-\\partial_u E(a))^2) + \\mathcal{O}(\\Delta t^3)$.\n$E(u^1) - E(a) = -(\\partial_u E(a))^2 \\Delta t + \\frac{1}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a)) (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\nThis gives $C_{\\text{explicit}}(a,\\lambda) = \\frac{1}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a))$.\n\n**Implicit Euler:** $u^1 = a + \\Delta t f(u^1)$.\nWe find an expansion for $u^1$ in powers of $\\Delta t$. Let $u^1 = a + c_1 \\Delta t + c_2 (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\n$u^1 = a + \\Delta t \\left[ f(a) + f'(a)(u^1-a) + \\mathcal{O}((u^1-a)^2) \\right]$.\n$a + c_1 \\Delta t + c_2 (\\Delta t)^2 + \\dots = a + \\Delta t \\left[ f(a) + f'(a)(c_1 \\Delta t + \\dots) + \\dots \\right]$.\n$c_1 \\Delta t + c_2 (\\Delta t)^2 + \\dots = f(a) \\Delta t + c_1 f'(a) (\\Delta t)^2 + \\dots$.\nEquating coefficients of powers of $\\Delta t$:\n$\\mathcal{O}(\\Delta t): c_1 = f(a)$.\n$\\mathcal{O}((\\Delta t)^2): c_2 = c_1 f'(a) = f(a)f'(a)$.\nSo, $u^1 - a = f(a) \\Delta t + f(a) f'(a) (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\nThe square of the increment is $(u^1-a)^2 = (f(a) \\Delta t)^2 + \\mathcal{O}(\\Delta t^3) = f(a)^2 (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\nSubstituting into the energy expansion:\n$E(u^1) - E(a) = (\\partial_u E(a)) [f(a) \\Delta t + f(a)f'(a)(\\Delta t)^2] + \\frac{1}{2}(\\partial_u^2 E(a)) [f(a)^2(\\Delta t)^2] + \\mathcal{O}(\\Delta t^3)$.\nUsing $f = -\\partial_u E$ and $f' = -\\partial_u^2 E$:\n$E(u^1) - E(a) = (\\partial_u E(a))(-\\partial_u E(a))[\\Delta t] + (\\partial_u E(a))(-\\partial_u E(a))(-\\partial_u^2 E(a))[\\Delta t^2] + \\frac{1}{2}(\\partial_u^2 E(a))(-\\partial_u E(a))^2 [\\Delta t^2] + \\mathcal{O}(\\Delta t^3)$.\n$E(u^1) - E(a) = -(\\partial_u E(a))^2 \\Delta t + (\\partial_u E(a))^2 (\\partial_u^2 E(a)) (\\Delta t)^2 + \\frac{1}{2}(\\partial_u E(a))^2 (\\partial_u^2 E(a)) (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\n$E(u^1) - E(a) = -(\\partial_u E(a))^2 \\Delta t + \\frac{3}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a)) (\\Delta t)^2 + \\mathcal{O}(\\Delta t^3)$.\nThis gives $C_{\\text{implicit}}(a,\\lambda) = \\frac{3}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a))$.\n\n**Final Calculation of C**\n\nWe are asked to compute $C = C_{\\text{explicit}}(a,\\lambda) - C_{\\text{implicit}}(a,\\lambda)$.\n$C = \\left[ \\frac{1}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a)) \\right] - \\left[ \\frac{3}{2} (\\partial_u E(a))^2 (\\partial_u^2 E(a)) \\right]$.\n$C = -(\\partial_u E(a))^2 (\\partial_u^2 E(a))$.\nNow, we substitute the expressions for the derivatives of the specific energy function $E(u)$ evaluated at $u=a$:\n$\\partial_u E(a) = \\lambda(a^3 - a) = \\lambda a (a^2-1)$.\n$\\partial_u^2 E(a) = \\lambda(3a^2 - 1)$.\nSubstituting these into the expression for $C$:\n$C = -[\\lambda a (a^2-1)]^2 [\\lambda(3a^2-1)]$.\n$C = -[\\lambda^2 a^2 (a^2-1)^2] [\\lambda(3a^2-1)]$.\n$C = -\\lambda^3 a^2 (a^2-1)^2 (3a^2-1)$.",
            "answer": "$$\\boxed{-\\lambda^{3} a^{2} (a^{2}-1)^{2} (3a^{2}-1)}$$"
        },
        {
            "introduction": "While implicit methods are essential for overcoming the stiffness limitations of explicit schemes, their practical implementation involves a new challenge: solving an algebraic system at each time step. Since this solve is often performed iteratively and inexactly, it introduces an algebraic error distinct from the method's truncation error. This advanced practice explores a powerful technique used in modern software to control this error by relating the computable \"defect\" of the algebraic solution to the actual error. You will then use this estimate to drive an adaptive time-step controller, a core component of robust and efficient solvers for stiff systems.",
            "id": "4105099",
            "problem": "A linearized viscoelastic stress relaxation in a complex fluid can be modeled for the polymeric stress components by the autonomous Ordinary Differential Equation (ODE) system $y'(t)=f(y(t))$ with $f(y)=A y + b$, where $A \\in \\mathbb{R}^{2 \\times 2}$ is negative diagonal (representing relaxation rates) and $b \\in \\mathbb{R}^{2}$ is a constant driving term. Consider advancing this stiff system with the backward (implicit) Euler method from $t^{n}$ to $t^{n+1}=t^{n}+\\Delta t$, and suppose the nonlinear algebraic solve at $t^{n+1}$ returns an approximate state $y^{n+1}$ with a reported residual of the implicit update (the defect) that is nonzero.\n\nStarting from the implicit Euler update condition and a first-order Taylor expansion of $f$ about $y^{n+1}$, derive a leading-order relation between the defect vector and the error in the computed $y^{n+1}$ (interpreted as the difference between the exact solution of the implicit Euler discrete equation and the returned approximation). Explain how this relation yields a defect-based estimate of the local error suitable for adaptive step-size selection in stiff regimes.\n\nThen, specialize to the linear system with\n$$\nA=\\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix} \\text{ s}^{-1},\\quad b=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix},\\quad \\Delta t=1.0\\times 10^{-2}\\ \\text{s},\n$$\nand suppose the solver returns $y^{n+1}$ with a defect vector\n$$\nd^{n+1}=\\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix}.\n$$\nUsing the derived relation, compute the Euclidean norm of the estimated error vector at $t^{n+1}$ and use a first-order step-size controller\n$$\n\\Delta t_{\\text{new}}=\\Delta t\\, s \\left(\\frac{\\text{tol}}{\\|e^{n+1}\\|_{2}}\\right)^{1},\n$$\nwith safety factor $s=0.9$ and tolerance $\\text{tol}=1.0\\times 10^{-4}$, to determine the next time step. Round your final answer for $\\Delta t_{\\text{new}}$ to four significant figures and express it in seconds.",
            "solution": "### Part 1: Derivation of the Error-Defect Relation\n\nThe backward (implicit) Euler method for the ODE $y'(t)=f(y(t))$ is defined by the discrete update rule:\n$$\n\\frac{y_{IE}^{n+1} - y^n}{\\Delta t} = f(y_{IE}^{n+1})\n$$\nwhere $y^n$ is the solution at time $t^n$, and $y_{IE}^{n+1}$ is the exact solution to this algebraic equation at time $t^{n+1}$. We can rearrange this into a root-finding form:\n$$\ny_{IE}^{n+1} - y^n - \\Delta t f(y_{IE}^{n+1}) = 0\n$$\nIn practice, this (generally nonlinear) algebraic equation is solved iteratively, yielding an approximate solution $y^{n+1}$ which does not satisfy the equation exactly. The residual, or defect $d^{n+1}$, is the result of substituting $y^{n+1}$ into this equation:\n$$\nd^{n+1} = y^{n+1} - y^n - \\Delta t f(y^{n+1})\n$$\nThe error of the algebraic solve, $e^{n+1}$, is defined as the difference between the computed solution and the exact solution of the discrete equation:\n$$\ne^{n+1} = y^{n+1} - y_{IE}^{n+1}\n$$\nTo relate $d^{n+1}$ and $e^{n+1}$, we subtract the equation for the exact discrete solution from the equation for the defect:\n$$\nd^{n+1} - 0 = (y^{n+1} - y_{IE}^{n+1}) - \\Delta t (f(y^{n+1}) - f(y_{IE}^{n+1}))\n$$\nSubstituting $e^{n+1} = y^{n+1} - y_{IE}^{n+1}$ gives:\n$$\nd^{n+1} = e^{n+1} - \\Delta t (f(y^{n+1}) - f(y_{IE}^{n+1}))\n$$\nWe now expand $f(y_{IE}^{n+1})$ in a first-order Taylor series around the known point $y^{n+1}$. Noting that $y_{IE}^{n+1} = y^{n+1} - e^{n+1}$:\n$$\nf(y_{IE}^{n+1}) = f(y^{n+1} - e^{n+1}) \\approx f(y^{n+1}) - J(y^{n+1}) e^{n+1}\n$$\nwhere $J(y^{n+1})$ is the Jacobian of $f$ evaluated at $y^{n+1}$. Substituting this expansion into the expression for $d^{n+1}$:\n$$\nd^{n+1} \\approx e^{n+1} - \\Delta t \\left( f(y^{n+1}) - \\left[ f(y^{n+1}) - J(y^{n+1}) e^{n+1} \\right] \\right)\n$$\n$$\nd^{n+1} \\approx e^{n+1} - \\Delta t \\left( J(y^{n+1}) e^{n+1} \\right)\n$$\n$$\nd^{n+1} \\approx (I - \\Delta t J(y^{n+1})) e^{n+1}\n$$\nwhere $I$ is the identity matrix. For the given linear system $f(y) = Ay + b$, the Jacobian $J(y) = \\frac{\\partial f}{\\partial y} = A$ is a constant matrix. Therefore, the Taylor expansion is exact, and the relation is not an approximation:\n$$\nd^{n+1} = (I - \\Delta t A) e^{n+1}\n$$\nSolving for the error vector $e^{n+1}$, we obtain the desired leading-order (and in this case, exact) relation:\n$$\ne^{n+1} = (I - \\Delta t A)^{-1} d^{n+1}\n$$\n\n### Part 2: Role in Adaptive Step-Size Selection\n\nIn numerical time integration, the local error at step $n+1$ is the difference between the true solution of the ODE, $y(t^{n+1})$, and the computed solution, $y^{n+1}$, assuming $y^{n}=y(t^{n})$. This error consists of two main parts: the local truncation error (LTE) of the integration method, and the algebraic error from the inexact solve of the implicit equation.\nThe LTE for implicit Euler is $O(\\Delta t^2)$. The algebraic error is $e^{n+1} = y^{n+1} - y_{IE}^{n+1}$, which we have just related to the computable defect $d^{n+1}$.\n\nFor stiff systems, stability, rather than accuracy, often dictates that an implicit method be used. This allows for time steps $\\Delta t$ that are much larger than what an explicit method would permit. In this regime, the LTE can be very small. However, a large $\\Delta t$ can make the nonlinear algebraic system for $y^{n+1}$ more difficult to solve, potentially leading to a larger algebraic error $e^{n+1}$. The total local error can thus be dominated by this algebraic error.\n\nThe derived relation $e^{n+1} = (I - \\Delta t A)^{-1} d^{n+1}$ allows for an inexpensive, a posteriori estimate of this algebraic error. The defect $d^{n+1}$ is readily computed from the obtained solution $y^{n+1}$. The matrix $(I - \\Delta t A)$ is the iteration matrix for a fixed-point or Newton solve, so its inverse or LU decomposition is often available.\n\nBy computing $\\|e^{n+1}\\|$, we get a reliable estimate of a dominant component of the local error. This estimate can then be used in a feedback controller to adjust the step size $\\Delta t$. The controller compares the error estimate $\\|e^{n+1}\\|$ to a user-defined tolerance $\\text{tol}$.\n- If $\\|e^{n+1}\\|  \\text{tol}$, the step is considered inaccurate, typically rejected, and retried with a smaller $\\Delta t$ proposed by the controller.\n- If $\\|e^{n+1}\\|  \\text{tol}$, the step is accepted, and the controller may propose a larger $\\Delta t$ for the next step to improve computational efficiency.\nThis makes the defect-based error estimate a crucial component for robust and efficient adaptive time-stepping of stiff ODEs.\n\n### Part 3: Specific Calculation\n\nWe are given the specific system parameters:\n$A=\\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix}$, $\\Delta t=1.0\\times 10^{-2}=0.01$, and $d^{n+1}=\\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix}$.\n\nFirst, we compute the matrix $(I - \\Delta t A)$:\n$$\nI - \\Delta t A = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - (0.01) \\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - \\begin{pmatrix}-10  0 \\\\ 0  -0.1\\end{pmatrix} = \\begin{pmatrix}11  0 \\\\ 0  1.1\\end{pmatrix}\n$$\nThe inverse of this diagonal matrix is:\n$$\n(I - \\Delta t A)^{-1} = \\begin{pmatrix}1/11  0 \\\\ 0  1/1.1\\end{pmatrix}\n$$\nNow, we calculate the estimated error vector $e^{n+1}$:\n$$\ne^{n+1} = (I - \\Delta t A)^{-1} d^{n+1} = \\begin{pmatrix}1/11  0 \\\\ 0  1/1.1\\end{pmatrix} \\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{11} \\times 10^{-3} \\\\ \\frac{1}{1.1} \\times 10^{-5} \\end{pmatrix}\n$$\nNext, we compute the Euclidean norm of the error vector, $\\|e^{n+1}\\|_2$:\n$$\n\\|e^{n+1}\\|_{2}^2 = \\left(\\frac{10^{-3}}{11}\\right)^2 + \\left(\\frac{10^{-5}}{1.1}\\right)^2 = \\frac{10^{-6}}{121} + \\frac{10^{-10}}{1.21} = \\frac{10^{-6}}{121} + \\frac{10^{-8}}{121} = \\frac{10^{-6}(1 + 10^{-2})}{121} = \\frac{1.01 \\times 10^{-6}}{121}\n$$\n$$\n\\|e^{n+1}\\|_{2} = \\sqrt{\\frac{1.01 \\times 10^{-6}}{121}} = \\frac{\\sqrt{1.01} \\times 10^{-3}}{11} \\approx \\frac{1.00498756 \\times 10^{-3}}{11} \\approx 9.1362505 \\times 10^{-5}\n$$\nFinally, we apply the given first-order step-size controller to find $\\Delta t_{\\text{new}}$:\n$$\n\\Delta t_{\\text{new}}=\\Delta t\\, s \\left(\\frac{\\text{tol}}{\\|e^{n+1}\\|_{2}}\\right)\n$$\nUsing the given values $\\Delta t = 1.0\\times 10^{-2}$, $s=0.9$, and $\\text{tol}=1.0\\times 10^{-4}$:\n$$\n\\Delta t_{\\text{new}} = (1.0 \\times 10^{-2}) \\times 0.9 \\times \\left(\\frac{1.0 \\times 10^{-4}}{9.1362505 \\times 10^{-5}}\\right)\n$$\n$$\n\\Delta t_{\\text{new}} \\approx 0.009 \\times \\left(1.0945404\\right) \\approx 0.0098508636\n$$\nRounding this result to four significant figures gives $0.009851$.",
            "answer": "$$\\boxed{0.009851}$$"
        }
    ]
}