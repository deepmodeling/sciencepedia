{
    "hands_on_practices": [
        {
            "introduction": "首先，我们来分析显式时间积分方案的核心局限性。本练习将探讨显式欧拉法应用于麦克斯韦模型（一种黏弹性力学中的基本方程）时的稳定性，揭示该方法的稳定性如何严格地与材料的松弛时间挂钩。理解这一约束是认识计算科学中“刚性”问题挑战的第一步。",
            "id": "4105091",
            "problem": "在计算复杂流体中，给定剪切速率 $ \\dot{\\gamma}(t) $ 下剪切应力 $ \\sigma(t) $ 的线性麦克斯韦本构方程由以下常微分方程 (ODE) 给出\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t),\n$$\n其中 $ \\tau $ 是弛豫时间，$ G $ 是弹性模量。考虑在均匀网格上，使用时间步长 $ \\Delta t $，将显式欧拉法直接应用于给定形式的本构方程，以在时间上推进该ODE。基于该ODE齐次部分的行为进行稳定性分析，确定保证显式欧拉更新绝对稳定的最大允许时间步长 $ \\Delta t $，并仅用 $ \\tau $ 表示。简要解释此稳定性限制如何相对于宏观时间尺度，约束了快速弛豫（小 $ \\tau $）的模拟。请以仅包含 $ \\tau $ 的单个闭式表达式提供您的最终答案。无需进行数值舍入，最终表达式中不应包含单位。",
            "solution": "该问题要求确定用于线性麦克斯韦本构方程的显式欧拉法的稳定性极限。控制性常微分方程 (ODE) 为：\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t)\n$$\n其中 $\\sigma$ 是剪切应力，$t$ 是时间，$\\tau$ 是弛豫时间，$G$ 是弹性模量，$\\dot{\\gamma}(t)$ 是施加的剪切速率。\n\n线性ODE数值格式的稳定性由其应用于方程齐次部分时的行为决定。强迫项 $G \\, \\dot{\\gamma}(t)$ 不影响数值方法本身的内在稳定性。麦克斯韦方程的齐次部分是：\n$$\n\\frac{d \\sigma_h}{d t} = -\\frac{1}{\\tau} \\sigma_h\n$$\n我们寻求将此方程从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$，其中 $\\Delta t$ 是恒定的时间步长。令 $\\sigma_h^n$ 为 $\\sigma_h(t_n)$ 的数值近似。\n\n显式（或前向）欧拉法将时间导数近似为：\n$$\n\\left. \\frac{d \\sigma_h}{d t} \\right|_{t=t_n} \\approx \\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t}\n$$\n将此近似代入齐次ODE，我们在时间 $t_n$ 处计算右侧：\n$$\n\\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t} = -\\frac{1}{\\tau} \\sigma_h^n\n$$\n为了找到更新法则，我们求解 $\\sigma_h^{n+1}$：\n$$\n\\sigma_h^{n+1} = \\sigma_h^n - \\frac{\\Delta t}{\\tau} \\sigma_h^n\n$$\n将 $\\sigma_h^n$ 因子提出，我们得到迭代映射：\n$$\n\\sigma_h^{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\sigma_h^n\n$$\n该方程表明，步骤 $n+1$ 的解是通过将步骤 $n$ 的解乘以一个放大因子 $g$ 得到的。在这种情况下，放大因子为：\n$$\ng = 1 - \\frac{\\Delta t}{\\tau}\n$$\n为使数值格式绝对稳定，任何初始误差或扰动的幅度都不能随时间增长。这要求放大因子的绝对值小于或等于 $1$：\n$$\n|g| \\le 1\n$$\n代入 $g$ 的表达式，我们得到稳定性条件：\n$$\n\\left| 1 - \\frac{\\Delta t}{\\tau} \\right| \\le 1\n$$\n这个绝对值不等式等价于复合不等式：\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\le 1\n$$\n我们分别分析这个不等式的两部分。\n\n首先，右侧部分：\n$$\n1 - \\frac{\\Delta t}{\\tau} \\le 1 \\implies -\\frac{\\Delta t}{\\tau} \\le 0 \\implies \\frac{\\Delta t}{\\tau} \\ge 0\n$$\n由于时间步长 $\\Delta t$ 和弛豫时间 $\\tau$ 都是正的物理量，此条件总是满足的。\n\n其次，左侧部分：\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\implies \\frac{\\Delta t}{\\tau} \\le 1 + 1 \\implies \\frac{\\Delta t}{\\tau} \\le 2\n$$\n这给出了对时间步长的关键约束。结合这两个条件，绝对稳定性的要求是：\n$$\n\\Delta t \\le 2\\tau\n$$\n问题要求保证稳定性的最大允许时间步长 $ \\Delta t $。这对应于所推导不等式的上界。因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\text{max}} = 2\\tau\n$$\n此稳定性限制对于模拟具有快速弛豫动力学（其特征为弛豫时间 $\\tau$ 很小）的系统具有重要意义。约束 $\\Delta t \\le 2\\tau$ 规定了时间步长必须与系统中最快的弛豫过程处于同一数量级。如果 $\\tau$ 非常小（例如，微秒），而我们关心的整个过程发生在更长的宏观时间尺度上（例如，秒），那么完成模拟所需的时间步数（$N = T_{\\text{total}} / \\Delta t$）将变得过大。这使得模拟的计算成本极高。这个问题是数值刚性的一个典型例子，其中显式方法的稳定性受到一个快速时间尺度的严重限制，而这个快速时间尺度可能对整个系统的动力学影响不大。这通常促使人们对刚性问题使用隐式方法，因为隐式方法可以有大得多的稳定域。",
            "answer": "$$\\boxed{2\\tau}$$"
        },
        {
            "introduction": "除了线性稳定性，数值方法还必须尊重所模拟系统的物理定律，例如浓度的非负性。本练习要求您推导出一个时间步长约束，以确保显式欧拉方案在处理一个反应动力学模型时能够保持解的正性。这个分析突出了显式方法在处理不当时可能出现的另一种关键失效模式。",
            "id": "4105095",
            "problem": "考虑复杂流体中的单组分浓度场，记为 $y(t) \\ge 0$，其受一个反应类型的常微分方程 (ODE) 控制\n$$\n\\frac{d y}{d t} \\;=\\; r(y) - d(y),\n$$\n其中 $r(y)$ 和 $d(y)$ 分别代表生成和衰减。假设一个物理上真实的自催化生成项 $r(y) = k\\,y$（其中 $k > 0$），以及由吸附和二元合并引起的衰减项 $d(y) = \\lambda\\,y + \\mu\\,y^{2}$（其中 $\\lambda > 0$ 且 $\\mu > 0$）。这些形式与计算复杂流体中常用的质量作用动力学一致。设物理上允许的浓度受一个最大值 $L > 0$ 的限制，该限制源于不可压缩混合物半离散模型中的质量守恒，因此对于精确动力学，始终有 $y(t) \\in [0, L]$。\n\n你使用显式欧拉方法对该ODE进行离散化，\n$$\ny^{n+1} \\;=\\; y^{n} \\;+\\; \\Delta t \\,\\big(r(y^{n}) - d(y^{n})\\big),\n$$\n其中时间步长 $\\Delta t > 0$ 为常数。从任意初始值 $y^{0} \\in [0, L]$ 出发，你需要确保在 $y^{n} \\in [0, L]$ 的条件下，离散解对所有时间层级 $n \\in \\mathbb{N}$ 都满足 $y^{n+1} \\ge 0$。请从第一性原理出发，推导显式欧拉更新在所有 $y^{n} \\in [0, L]$ 下保持非负性的结构参数条件，并计算能保证在 $y^{n} \\in [0, L]$ 时总有 $y^{n+1} \\ge 0$ 的最大一致时间步长上限 $\\Delta t_{\\max}$。假设 $\\lambda - k + \\mu L > 0$，从而在允许范围内，当 $y$ 足够大时，衰减可以超过生成。\n\n以秒为单位表示你的最终时间步长上限。无需四舍五入；提供一个封闭形式的解析表达式作为你的最终答案。",
            "solution": "该问题要求找到最大的时间步长 $\\Delta t_{\\max}$，使得用于求解常微分方程 (ODE) 的显式欧拉离散化能够保持浓度 $y$ 的非负性。给定的 ODE 是：\n$$\n\\frac{d y}{d t} = k y - (\\lambda y + \\mu y^{2}) = (k - \\lambda) y - \\mu y^{2}\n$$\n此方程的显式欧拉格式由下式给出：\n$$\ny^{n+1} = y^{n} + \\Delta t \\left( (k - \\lambda) y^{n} - \\mu (y^{n})^{2} \\right)\n$$\n我们的目标是确保对于任何初始于 $[0, L]$ 区间内的 $y^n$，更新后的值 $y^{n+1}$ 始终保持非负，即 $y^{n+1} \\ge 0$。\n\n我们可以从更新方程的右侧提取因子 $y^{n}$：\n$$\ny^{n+1} = y^{n} \\left[ 1 + \\Delta t \\left( k - \\lambda - \\mu y^{n} \\right) \\right]\n$$\n如果 $y^n = 0$，则 $y^{n+1} = 0$，非负性得以保持。如果 $y^n > 0$，为了使 $y^{n+1}$ 非负，方括号中的项必须非负：\n$$\n1 + \\Delta t \\left( k - \\lambda - \\mu y^{n} \\right) \\ge 0\n$$\n此条件必须对所有可能的 $y^n$ 值（即 $y^n \\in (0, L]$）都成立。为了确保这一点，我们必须考虑“最坏情况”，即 $y^n$ 的选择使得 $k - \\lambda - \\mu y^n$ 这一项取其最小值。\n        \n我们定义函数 $g(y) = k - \\lambda - \\mu y$。由于 $\\mu > 0$，$g(y)$ 是 $y$ 的单调递减函数。因此，它在区间 $(0, L]$ 上的最小值出现在右边界，即 $y = L$。该最小值为：\n$$\n\\min_{y^{n} \\in (0, L]} \\left( k - \\lambda - \\mu y^{n} \\right) = k - \\lambda - \\mu L\n$$\n将这个最小值代入不等式，我们得到对 $\\Delta t$ 的全局约束：\n$$\n1 + \\Delta t \\left( k - \\lambda - \\mu L \\right) \\ge 0\n$$\n问题中给出的假设是 $\\lambda - k + \\mu L > 0$，这意味着 $k - \\lambda - \\mu L$ 是一个负数。因此，当我们求解 $\\Delta t$ 时，需要反转不等号：\n$$\n\\Delta t \\left( k - \\lambda - \\mu L \\right) \\ge -1 \\implies \\Delta t \\le \\frac{-1}{k - \\lambda - \\mu L}\n$$\n整理后得到：\n$$\n\\Delta t \\le \\frac{1}{\\lambda - k + \\mu L}\n$$\n这个不等式给出了保证非负性的时间步长上限。因此，所允许的最大时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = \\frac{1}{\\lambda - k + \\mu L}\n$$\n从量纲分析可知，$\\lambda$ 和 $k$ 的单位是时间的倒数，而 $\\mu L$ 的单位也是时间的倒数，因此 $\\Delta t_{\\max}$ 的单位是时间。如果时间以秒为单位测量，则最终表达式的单位是秒。",
            "answer": "$$\n\\boxed{\\frac{1}{\\lambda - k + \\mu L}}\n$$"
        },
        {
            "introduction": "在确定了刚性系统需要使用隐式方法后，我们现在转向它们的实际应用。最后一个练习将演示如何估计和控制因隐式格式中固有的非精确代数求解而产生的误差。通过将求解器的残差与局部误差联系起来，您将学习自适应时间步长选择的基础，这是实现高效可靠模拟的一项关键技术。",
            "id": "4105099",
            "problem": "对于复杂流体中的聚合物应力分量，其线性化粘弹性应力松弛可通过自治常微分方程（ODE）系统 $y'(t)=f(y(t))$ 建模，其中 $f(y)=A y + b$，$A \\in \\mathbb{R}^{2 \\times 2}$ 是一个负对角矩阵（表示松弛率），$b \\in \\mathbb{R}^{2}$ 是一个恒定驱动项。考虑使用后向（隐式）Euler方法将此刚性系统从 $t^{n}$ 推进到 $t^{n+1}=t^{n}+\\Delta t$，并假设在 $t^{n+1}$ 处的非线性代数求解返回一个近似状态 $y^{n+1}$，其隐式更新的报告残差（缺陷）为非零。\n\n从隐式Euler更新条件和 $f$ 在 $y^{n+1}$ 附近的一阶泰勒展开出发，推导缺陷向量与计算所得 $y^{n+1}$ 中误差（解释为隐式Euler离散方程的精确解与返回的近似解之差）之间的主阶关系。解释该关系如何产生一个基于缺陷的局部误差估计，该估计适用于刚性区域中的自适应步长选择。\n\n然后，将问题具体化到线性系统，其中\n$$\nA=\\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix} \\text{ s}^{-1},\\quad b=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix},\\quad \\Delta t=1.0\\times 10^{-2}\\ \\text{s},\n$$\n并假设求解器返回的 $y^{n+1}$ 的缺陷向量为\n$$\nd^{n+1}=\\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix}.\n$$\n使用推导出的关系，计算在 $t^{n+1}$ 处估计误差向量的欧几里得范数，并使用一阶步长控制器\n$$\n\\Delta t_{\\text{new}}=\\Delta t\\, s \\left(\\frac{\\text{tol}}{\\|e^{n+1}\\|_{2}}\\right)^{1},\n$$\n其中安全因子 $s=0.9$，容差 $\\text{tol}=1.0\\times 10^{-4}$，来确定下一个时间步长。将 $\\Delta t_{\\text{new}}$ 的最终答案四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "### 第1部分：误差与缺陷的关系推导\n\n对于自治ODE $y'(t)=f(y(t))$，后向（隐式）欧拉法的精确离散方程为：\n$$\ny_{IE}^{n+1} - y^n - \\Delta t f(y_{IE}^{n+1}) = 0\n$$\n其中 $y_{IE}^{n+1}$ 是在时间步 $n+1$ 处该代数方程的精确解。在实践中，迭代求解器得到一个近似解 $y^{n+1}$，其代数误差为 $e^{n+1} = y^{n+1} - y_{IE}^{n+1}$。将近似解 $y^{n+1}$ 代入离散方程，得到的非零结果被称为缺陷（或残差）$d^{n+1}$：\n$$\nd^{n+1} = y^{n+1} - y^n - \\Delta t f(y^{n+1})\n$$\n从缺陷的定义中减去精确离散方程，我们得到：\n$$\nd^{n+1} - 0 = (y^{n+1} - y_{IE}^{n+1}) - \\Delta t (f(y^{n+1}) - f(y_{IE}^{n+1}))\n$$\n代入误差的定义 $e^{n+1}$：\n$$\nd^{n+1} = e^{n+1} - \\Delta t (f(y^{n+1}) - f(y_{IE}^{n+1}))\n$$\n为了建立 $d^{n+1}$ 和 $e^{n+1}$ 之间的关系，我们将 $f(y_{IE}^{n+1})$ 在点 $y^{n+1}$ 附近进行一阶泰勒展开。注意到 $y_{IE}^{n+1} = y^{n+1} - e^{n+1}$：\n$$\nf(y_{IE}^{n+1}) \\approx f(y^{n+1}) - J(y^{n+1}) e^{n+1}\n$$\n其中 $J(y^{n+1})$ 是 $f$ 在 $y^{n+1}$ 处的雅可比矩阵。将此展开式代入，我们得到：\n$$\nd^{n+1} \\approx e^{n+1} - \\Delta t \\left( f(y^{n+1}) - [f(y^{n+1}) - J(y^{n+1}) e^{n+1}] \\right) = (I - \\Delta t J(y^{n+1})) e^{n+1}\n$$\n对于给定的线性系统 $f(y) = Ay + b$，雅可比矩阵 $J(y)$ 就是常数矩阵 $A$。因此，上述关系是精确的：\n$$\nd^{n+1} = (I - \\Delta t A) e^{n+1}\n$$\n求解误差向量 $e^{n+1}$，我们得到最终关系：\n$$\ne^{n+1} = (I - \\Delta t A)^{-1} d^{n+1}\n$$\n\n### 第2部分：在自适应步长选择中的作用\n\n推导出的关系 $e^{n+1} = (I - \\Delta t A)^{-1} d^{n+1}$ 提供了一种廉价的、后验的代数误差估计方法。在隐式方法中，尤其是在处理刚性问题时，时间步长 $\\Delta t$ 可能较大，导致代数求解变得困难，从而使代数误差 $e^{n+1}$ 成为局部总误差的主要贡献者。通过在每个时间步后计算可轻松获得的缺陷 $d^{n+1}$，我们可以估计出误差 $e^{n+1}$ 的大小。这个估计值可以与用户设定的容差 $\\text{tol}$进行比较：\n- 如果 $\\|e^{n+1}\\| > \\text{tol}$，则该步的精度不足，应拒绝并使用较小的 $\\Delta t$ 重算。\n- 如果 $\\|e^{n+1}\\| \\le \\text{tol}$，则该步被接受，并且可以为下一步考虑一个更大的 $\\Delta t$ 以提高效率。\n这种基于缺陷的误差估计是实现对刚性ODE进行稳健且高效的自适应时间积分的关键。\n\n### 第3部分：具体计算\n\n我们已知具体的系统参数：\n$A=\\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix}$，$\\Delta t=1.0\\times 10^{-2}$，以及 $d^{n+1}=\\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix}$。\n\n首先，我们计算矩阵 $(I - \\Delta t A)$：\n$$\nI - \\Delta t A = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - (0.01) \\begin{pmatrix}-1000  0 \\\\ 0  -10\\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - \\begin{pmatrix}-10  0 \\\\ 0  -0.1\\end{pmatrix} = \\begin{pmatrix}11  0 \\\\ 0  1.1\\end{pmatrix}\n$$\n这个对角矩阵的逆是：\n$$\n(I - \\Delta t A)^{-1} = \\begin{pmatrix}1/11  0 \\\\ 0  1/1.1\\end{pmatrix}\n$$\n现在，我们计算估计的误差向量 $e^{n+1}$：\n$$\ne^{n+1} = (I - \\Delta t A)^{-1} d^{n+1} = \\begin{pmatrix}1/11  0 \\\\ 0  1/1.1\\end{pmatrix} \\begin{pmatrix}1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-5}\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{11} \\times 10^{-3} \\\\ \\frac{1}{1.1} \\times 10^{-5} \\end{pmatrix}\n$$\n接下来，我们计算误差向量的欧几里得范数 $\\|e^{n+1}\\|_2$：\n$$\n\\|e^{n+1}\\|_{2} = \\sqrt{\\left(\\frac{1}{11} \\times 10^{-3}\\right)^2 + \\left(\\frac{1}{1.1} \\times 10^{-5}\\right)^2} \\approx \\sqrt{(9.0909 \\times 10^{-5})^2 + (9.0909 \\times 10^{-6})^2} \\approx 9.13625 \\times 10^{-5}\n$$\n最后，我们应用给定的一阶步长控制器来找到 $\\Delta t_{\\text{new}}$：\n$$\n\\Delta t_{\\text{new}}=\\Delta t\\, s \\left(\\frac{\\text{tol}}{\\|e^{n+1}\\|_{2}}\\right)\n$$\n使用给定的值 $\\Delta t = 1.0\\times 10^{-2}$，$s=0.9$，和 $\\text{tol}=1.0\\times 10^{-4}$：\n$$\n\\Delta t_{\\text{new}} = (1.0 \\times 10^{-2}) \\times 0.9 \\times \\left(\\frac{1.0 \\times 10^{-4}}{9.1362505 \\times 10^{-5}}\\right)\n$$\n$$\n\\Delta t_{\\text{new}} \\approx 0.009 \\times (1.0945404) \\approx 0.0098508636\n$$\n将此结果四舍五入到四位有效数字，得到 $0.009851$。最终答案以秒为单位。",
            "answer": "$$\\boxed{0.009851}$$"
        }
    ]
}