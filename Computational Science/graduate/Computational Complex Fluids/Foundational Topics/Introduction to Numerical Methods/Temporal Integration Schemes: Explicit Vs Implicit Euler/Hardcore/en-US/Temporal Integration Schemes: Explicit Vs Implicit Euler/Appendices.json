{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring one of the most common challenges in computational science: numerical stiffness. This practice uses the linear Maxwell model, a fundamental equation in computational rheology, to demonstrate how the stability of an explicit time integration scheme is fundamentally limited by the physical properties of the material being simulated. By performing a stability analysis on the explicit Euler method, you will derive the maximum permissible time step and understand why simulating systems with fast relaxation dynamics can be computationally prohibitive with this approach .",
            "id": "4105091",
            "problem": "In computational complex fluids, the linear Maxwell constitutive equation for the shear stress $\\sigma(t)$ under an imposed shear rate $\\dot{\\gamma}(t)$ is given by the ordinary differential equation (ODE)\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t),\n$$\nwhere $\\tau$ is the relaxation time and $G$ is the elastic modulus. Consider advancing this ODE in time on a uniform grid with time step $\\Delta t$ using the explicit Euler method applied directly to the constitutive equation in its given form. Using stability analysis grounded in the behavior of the homogeneous part of the ODE, determine the largest admissible $\\Delta t$ that guarantees absolute stability of the explicit Euler update, expressed solely in terms of $\\tau$. Briefly explain how this stability limit constrains the simulation of fast relaxation (small $\\tau$) relative to macroscopic time scales. Provide your final answer as a single closed-form expression in terms of $\\tau$. No numerical rounding is required, and no units should be included in your final expression.",
            "solution": "The problem requires determining the stability limit of the explicit Euler method for the linear Maxwell constitutive equation. The governing ordinary differential equation (ODE) is:\n$$\n\\frac{d \\sigma}{d t} = -\\frac{1}{\\tau} \\sigma + G \\, \\dot{\\gamma}(t)\n$$\nwhere $\\sigma$ is the shear stress, $t$ is time, $\\tau$ is the relaxation time, $G$ is the elastic modulus, and $\\dot{\\gamma}(t)$ is the imposed shear rate.\n\nThe stability of a numerical scheme for a linear ODE is determined by its behavior when applied to the homogeneous part of the equation. The forcing term, $G \\, \\dot{\\gamma}(t)$, does not influence the intrinsic stability of the numerical method itself. The homogeneous part of the Maxwell equation is:\n$$\n\\frac{d \\sigma_h}{d t} = -\\frac{1}{\\tau} \\sigma_h\n$$\nWe seek to advance this equation from time $t_n$ to $t_{n+1} = t_n + \\Delta t$, where $\\Delta t$ is the constant time step. Let $\\sigma_h^n$ be the numerical approximation of $\\sigma_h(t_n)$.\n\nThe explicit (or forward) Euler method approximates the time derivative as:\n$$\n\\left. \\frac{d \\sigma_h}{d t} \\right|_{t=t_n} \\approx \\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t}\n$$\nSubstituting this approximation into the homogeneous ODE, we evaluate the right-hand side at time $t_n$:\n$$\n\\frac{\\sigma_h^{n+1} - \\sigma_h^n}{\\Delta t} = -\\frac{1}{\\tau} \\sigma_h^n\n$$\nTo find the update rule, we solve for $\\sigma_h^{n+1}$:\n$$\n\\sigma_h^{n+1} = \\sigma_h^n - \\frac{\\Delta t}{\\tau} \\sigma_h^n\n$$\nFactoring out $\\sigma_h^n$, we obtain the iterative map:\n$$\n\\sigma_h^{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\sigma_h^n\n$$\nThis equation shows that the solution at step $n+1$ is obtained by multiplying the solution at step $n$ by an amplification factor, $g$. In this case, the amplification factor is:\n$$\ng = 1 - \\frac{\\Delta t}{\\tau}\n$$\nFor the numerical scheme to be absolutely stable, any initial error or perturbation must not grow in magnitude over time. This requires the magnitude of the amplification factor to be less than or equal to $1$:\n$$\n|g| \\le 1\n$$\nSubstituting the expression for $g$, we get the stability condition:\n$$\n\\left| 1 - \\frac{\\Delta t}{\\tau} \\right| \\le 1\n$$\nThis absolute value inequality is equivalent to the compound inequality:\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\le 1\n$$\nWe analyze the two parts of this inequality separately.\n\nFirst, the right-hand side:\n$$\n1 - \\frac{\\Delta t}{\\tau} \\le 1 \\implies -\\frac{\\Delta t}{\\tau} \\le 0 \\implies \\frac{\\Delta t}{\\tau} \\ge 0\n$$\nSince the time step $\\Delta t$ and the relaxation time $\\tau$ are both positive physical quantities, this condition is always satisfied.\n\nSecond, the left-hand side:\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\implies \\frac{\\Delta t}{\\tau} \\le 1 + 1 \\implies \\frac{\\Delta t}{\\tau} \\le 2\n$$\nThis gives us the critical constraint on the time step. Combining both conditions, the requirement for absolute stability is:\n$$\n\\Delta t \\le 2\\tau\n$$\nThe problem asks for the largest admissible $\\Delta t$ that guarantees stability. This corresponds to the upper bound of the derived inequality. Therefore, the maximum stable time step is:\n$$\n\\Delta t_{\\text{max}} = 2\\tau\n$$\nThis stability limit has a significant implication for simulating systems with fast relaxation dynamics, which are characterized by a small relaxation time $\\tau$. The constraint $\\Delta t \\le 2\\tau$ dictates that the time step must be of the same order as the fastest relaxation process in the system. If $\\tau$ is very small (e.g., microseconds), while the overall process of interest occurs on a much longer macroscopic time scale (e.g., seconds), the number of time steps required to complete the simulation ($N = T_{\\text{total}} / \\Delta t$) becomes prohibitively large. This makes the simulation computationally extremely expensive. This problem is a classic example of numerical stiffness, where an explicit method's stability is severely restricted by a fast time scale that may be of little importance to the overall system dynamics. This often motivates the use of implicit methods, which can have much larger stability regions, for stiff problems.",
            "answer": "$$\\boxed{2\\tau}$$"
        },
        {
            "introduction": "Beyond stability, the accuracy of a numerical scheme over long integration times is paramount. This exercise moves from a specific physical model to the universal test equation of numerical analysis, $y' = \\lambda y$, to provide a clear, analytical comparison between the explicit and implicit Euler methods. You will derive the exact global error for each scheme, revealing how their respective mathematical structures cause them to diverge from the true solution and offering a deeper insight into their long-term behavior .",
            "id": "4105111",
            "problem": "Consider a single-mode linear relaxation that arises from a semi-discretized, linearized viscoelastic constitutive equation in computational complex fluids, modeled by the ordinary differential equation (ODE) $y'(t)=\\lambda\\,y(t)$ with constant $\\lambda\\in\\mathbb{R}$ and initial condition $y(0)=y_0\\in\\mathbb{R}$. Let the target time be $T>0$, and let the number of uniform time steps be $N\\in\\mathbb{N}$ with step size $h=T/N$. The exact solution at time $T$ is $y(T)=\\exp(\\lambda T)\\,y_0$. Apply the forward (explicit) Euler method and the backward (implicit) Euler method to this ODE. For each method, define its stability function $R(z)$ by applying the method to the test equation $y'=\\lambda y$ with $z=\\lambda h$, and observe that a single step maps $y_n$ to $y_{n+1}=R(z)\\,y_n$. Then, after $N$ steps, the numerical solution can be written as $y_N=R(z)^N\\,y_0$. Using only the fundamental definitions of these schemes and the exact solution $y(T)$, compute the global error after $N$ steps for each method, defined by $E_N:=y_N-y(T)$, and express each error in closed form as an analytic expression in terms of $\\lambda$, $T$, $N$, and $y_0$. \nProvide your final answer as a row matrix with two entries in the order: first the explicit Euler error, then the implicit Euler error. No rounding is required, and no units are involved.",
            "solution": "The problem asks for the global error $E_N = y_N - y(T)$ for both the explicit and implicit Euler methods applied to the ODE $y'(t) = \\lambda y(t)$ with initial condition $y(0) = y_0$. The exact solution at time $T$ is $y(T) = \\exp(\\lambda T) y_0$. The numerical solution after $N$ steps is $y_N = [R(\\lambda h)]^N y_0$, where $h = T/N$ is the step size.\n\n**1. Forward (Explicit) Euler Method**\n\nThe forward Euler method is defined by the recurrence relation:\n$$\ny_{n+1} = y_n + h y'(t_n) = y_n + h (\\lambda y_n) = (1 + \\lambda h) y_n\n$$\nThe stability function is $R_{\\text{exp}}(z) = 1 + z$, where $z = \\lambda h$. After $N$ steps, the numerical solution at time $T=Nh$ is:\n$$\ny_N^{\\text{exp}} = (R_{\\text{exp}}(\\lambda h))^N y_0 = (1 + \\lambda h)^N y_0\n$$\nSubstituting $h = T/N$:\n$$\ny_N^{\\text{exp}} = \\left(1 + \\frac{\\lambda T}{N}\\right)^N y_0\n$$\nThe global error $E_N^{\\text{exp}}$ is the difference between the numerical and exact solutions:\n$$\nE_N^{\\text{exp}} = y_N^{\\text{exp}} - y(T) = \\left(1 + \\frac{\\lambda T}{N}\\right)^N y_0 - \\exp(\\lambda T) y_0\n$$\nFactoring out $y_0$ gives the final expression for the error:\n$$\nE_N^{\\text{exp}} = \\left[ \\left(1 + \\frac{\\lambda T}{N}\\right)^N - \\exp(\\lambda T) \\right] y_0\n$$\n\n**2. Backward (Implicit) Euler Method**\n\nThe backward Euler method is defined by the recurrence relation:\n$$\ny_{n+1} = y_n + h y'(t_{n+1}) = y_n + h (\\lambda y_{n+1})\n$$\nSolving for $y_{n+1}$:\n$$\ny_{n+1} (1 - \\lambda h) = y_n \\implies y_{n+1} = \\frac{1}{1 - \\lambda h} y_n\n$$\nThe stability function is $R_{\\text{imp}}(z) = (1 - z)^{-1}$. After $N$ steps, the numerical solution is:\n$$\ny_N^{\\text{imp}} = (R_{\\text{imp}}(\\lambda h))^N y_0 = \\left( \\frac{1}{1 - \\lambda h} \\right)^N y_0\n$$\nSubstituting $h = T/N$:\n$$\ny_N^{\\text{imp}} = \\left(1 - \\frac{\\lambda T}{N}\\right)^{-N} y_0\n$$\nThe global error $E_N^{\\text{imp}}$ is the difference between the numerical and exact solutions:\n$$\nE_N^{\\text{imp}} = y_N^{\\text{imp}} - y(T) = \\left(1 - \\frac{\\lambda T}{N}\\right)^{-N} y_0 - \\exp(\\lambda T) y_0\n$$\nFactoring out $y_0$ gives the final expression for the error:\n$$\nE_N^{\\text{imp}} = \\left[ \\left(1 - \\frac{\\lambda T}{N}\\right)^{-N} - \\exp(\\lambda T) \\right] y_0\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left[ \\left(1 + \\frac{\\lambda T}{N}\\right)^N - \\exp(\\lambda T) \\right] y_0  \\left[ \\left(1 - \\frac{\\lambda T}{N}\\right)^{-N} - \\exp(\\lambda T) \\right] y_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A numerically stable solution is not useful if it violates fundamental physical laws, such as the non-negativity of concentration. In this final practice, we address this issue by analyzing a nonlinear reaction-type model common in simulations of reacting flows and chemical kinetics. Your task will be to derive the time-step constraint required for the explicit Euler method to preserve the non-negativity of the solution, highlighting a crucial aspect of algorithm design for realistic, nonlinear systems .",
            "id": "4105095",
            "problem": "Consider a single-species concentration field in a complex fluid, denoted by $y(t) \\ge 0$, governed by an ordinary differential equation (ODE) of reaction type\n$$\n\\frac{d y}{d t} = r(y) - d(y),\n$$\nwhere $r(y)$ and $d(y)$ represent production and decay, respectively. Assume a physically realistic autocatalytic production $r(y) = k\\,y$ with $k > 0$, and decay due to adsorption and binary coalescence $d(y) = \\lambda\\,y + \\mu\\,y^{2}$ with $\\lambda > 0$ and $\\mu > 0$. These forms are consistent with mass-action kinetics often used in computational complex fluids. Let the physically admissible concentration be bounded by a maximum $L > 0$ arising from mass conservation in a semi-discrete model of an incompressible mixture, so that $y(t) \\in [0, L]$ at all times for the exact dynamics.\n\nYou discretize the ODE using the explicit Euler method,\n$$\ny^{n+1} = y^{n} + \\Delta t \\big(r(y^{n}) - d(y^{n})\\big),\n$$\nwith a constant time step $\\Delta t > 0$. Starting from any initial value $y^{0} \\in [0, L]$, you require that the discrete solution satisfies $y^{n+1} \\ge 0$ provided $y^{n} \\in [0, L]$, for all time levels $n \\in \\mathbb{N}$. Derive, from first principles, the structural parameter conditions under which the explicit Euler update preserves nonnegativity for all $y^{n} \\in [0, L]$, and compute the largest uniform time-step bound $\\Delta t_{\\max}$ that guarantees $y^{n+1} \\ge 0$ whenever $y^{n} \\in [0, L]$. Assume $\\lambda - k + \\mu L > 0$ so that the decay can dominate production in the admissible range at sufficiently large $y$.\n\nExpress your final time-step bound in seconds. No rounding is required; provide a closed-form analytical expression as your final answer.",
            "solution": "The problem requires finding the largest time step $\\Delta t_{\\max}$ for the explicit Euler method to preserve the non-negativity of the concentration $y$. The governing ODE is:\n$$\n\\frac{d y}{d t} = k y - (\\lambda y + \\mu y^{2}) = (k - \\lambda) y - \\mu y^{2}\n$$\nThe explicit Euler scheme is:\n$$\ny^{n+1} = y^{n} + \\Delta t \\left( (k - \\lambda) y^{n} - \\mu (y^{n})^{2} \\right)\n$$\nWe require $y^{n+1} \\ge 0$ for any $y^{n} \\in [0, L]$. Factoring $y^n$ from the right-hand side gives:\n$$\ny^{n+1} = y^{n} \\left[ 1 + \\Delta t \\left( k - \\lambda - \\mu y^{n} \\right) \\right]\n$$\nIf $y^n = 0$, then $y^{n+1} = 0$, which is non-negative. If $y^n > 0$, we must ensure that the term in the square brackets is non-negative:\n$$\n1 + \\Delta t \\left( k - \\lambda - \\mu y^{n} \\right) \\ge 0\n$$\nThis condition must hold for all possible values of $y^{n} \\in (0, L]$. To find a uniform time-step bound, we must satisfy this inequality for the \"worst-case\" scenario, which is the value of $y^n$ that makes the term $(k - \\lambda - \\mu y^{n})$ most negative.\n\nLet's define the function $g(y) = k - \\lambda - \\mu y$. Since $\\mu > 0$, $g(y)$ is a monotonically decreasing function. Its minimum value over the interval $(0, L]$ occurs at the right boundary, $y = L$. The most restrictive condition is therefore:\n$$\n1 + \\Delta t \\left( k - \\lambda - \\mu L \\right) \\ge 0\n$$\nNow, we solve for $\\Delta t$. The problem statement assumes $\\lambda - k + \\mu L > 0$, which implies that $k - \\lambda - \\mu L  0$. The coefficient of $\\Delta t$ is negative.\n$$\n\\Delta t (k - \\lambda - \\mu L) \\ge -1\n$$\nDividing by the negative quantity $(k - \\lambda - \\mu L)$ reverses the inequality sign:\n$$\n\\Delta t \\le \\frac{-1}{k - \\lambda - \\mu L}\n$$\nBy factoring out $-1$ from the denominator, we get:\n$$\n\\Delta t \\le \\frac{1}{\\lambda - k + \\mu L}\n$$\nThis is the condition on the time step that guarantees $y^{n+1} \\ge 0$ for any $y^n \\in [0, L]$. The largest uniform time-step bound, $\\Delta t_{\\max}$, is the maximum value that $\\Delta t$ can take, which is the upper bound of this inequality.\n$$\n\\Delta t_{\\max} = \\frac{1}{\\lambda - k + \\mu L}\n$$\nA dimensional analysis of the ODE shows that the parameters $k$ and $\\lambda$ have units of inverse time ($1/[t]$) and $\\mu L$ also has units of inverse time. Therefore, the denominator has units of $1/[t]$, and the resulting $\\Delta t_{\\max}$ has units of time, as expected. If the base unit of time is seconds, this expression gives the bound in seconds.",
            "answer": "$$\n\\boxed{\\frac{1}{\\lambda - k + \\mu L}}\n$$"
        }
    ]
}