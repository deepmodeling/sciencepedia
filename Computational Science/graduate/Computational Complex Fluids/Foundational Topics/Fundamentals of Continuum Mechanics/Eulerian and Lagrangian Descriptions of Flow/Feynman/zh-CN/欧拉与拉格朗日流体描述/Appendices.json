{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握欧拉和拉格朗日描述，关键在于理解它们之间的数学联系。变形梯度张量 $\\mathbf{F}$ 是连接拉格朗日（参考）构型和欧拉（当前）构型的基石。本练习旨在将抽象的张量 $\\mathbf{F}$ 具体化，通过在一个流体力学基本流场——简单剪切流中，计算材料线元和面元的拉伸与重新定向，从而直观地揭示变形的几何本质。",
            "id": "4086874",
            "problem": "考虑一个三维连续体，其运动由流映射 $\\boldsymbol{\\chi}(\\mathbf{X},t)$ 描述。该映射将一个物质点从其在参考构形中的位置 $\\mathbf{X}$ 带到其在时间 $t$ 当前构形中的位置 $\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X},t)$。欧拉描述给出了当前构形中空间位置上的速度场 $\\mathbf{v}(\\mathbf{x},t)$，而拉格朗日描述通过 $\\boldsymbol{\\chi}(\\mathbf{X},t)$ 给出了轨迹。令变形梯度由以下基本运动学关系定义\n$$\n\\mathbf{F}(\\mathbf{X},t) = \\frac{\\partial \\boldsymbol{\\chi}(\\mathbf{X},t)}{\\partial \\mathbf{X}},\n$$\n并令雅可比行列式为 $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$。\n\n从流映射和变形梯度的定义出发，推导物质线元和物质面元从参考构形到当前构形的映射。具体来说，证明一个微分物质纤维如何映射为\n$$\n\\mathrm{d}\\mathbf{x} = \\mathbf{F}\\,\\mathrm{d}\\mathbf{X},\n$$\n以及一个微分物质面积矢量如何映射为\n$$\n\\mathrm{d}\\mathbf{a} = J\\,\\mathbf{F}^{-T}\\,\\mathrm{d}\\mathbf{A}.\n$$\n这里，$\\mathrm{d}\\mathbf{X}$ 是参考构形中的一个微分线元，$\\mathrm{d}\\mathbf{A}$ 是参考构形中的有向面积矢量。\n\n然后，考虑一个具有恒定剪切率 $\\gamma$ 的简单剪切流，其欧拉形式描述为\n$$\n\\mathbf{v}(\\mathbf{x},t) = (\\gamma\\,y,\\,0,\\,0),\n$$\n其中 $y$ 是当前的 $y$ 坐标，$\\gamma$ 是一个单位为时间倒数的常数。假设 $t=0$ 时的参考构形满足 $\\boldsymbol{\\chi}(\\mathbf{X},0)=\\mathbf{X}$。计算此运动的 $\\mathbf{F}(\\mathbf{X},t)$ 和 $J(\\mathbf{X},t)$。\n\n最后，对于一个位于 $x$-$y$ 平面内、沿 $\\mathbf{M}_{0}=(\\cos\\theta,\\sin\\theta,0)$ 方向的单位参考纤维 $\\mathrm{d}\\mathbf{X}$，以及一个位于 $x$-$y$ 平面内、沿 $\\mathbf{N}_{0}=(\\cos\\phi,\\sin\\phi,0)$ 方向的单位参考面积矢量 $\\mathrm{d}\\mathbf{A}$，使用推导出的映射，获得当前线元的大小 $|\\mathrm{d}\\mathbf{x}|$ 和当前面积矢量的大小 $|\\mathrm{d}\\mathbf{a}|$ 作为 $\\gamma$、$t$、$\\theta$ 和 $\\phi$ 的函数的显式公式。将您的最终答案表示为一个单行矩阵，其中包含两个条目，第一个是 $|\\mathrm{d}\\mathbf{x}|$，第二个是 $|\\mathrm{d}\\mathbf{a}|$。无需四舍五入。由于参考量的大小为单位1，因此根据构造，两个结果都是无量纲的。",
            "solution": "连续体的运动由流映射 $\\boldsymbol{\\chi}(\\mathbf{X},t)$ 描述，它将每个由其参考位置 $\\mathbf{X}$ 标记的物质点赋予其在时间 $t$ 的当前位置 $\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X},t)$。变形梯度是流映射相对于参考坐标的空间导数，\n$$\n\\mathbf{F}(\\mathbf{X},t)=\\frac{\\partial \\boldsymbol{\\chi}(\\mathbf{X},t)}{\\partial \\mathbf{X}}。\n$$\n该定义是将微分几何对象从参考构形映射到当前构形的基础。\n\n物质线元的映射：考虑一个附着在参考构形中材料上的微分物质纤维 $\\mathrm{d}\\mathbf{X}$。在运动作用下，其在当前构形中的像为位置之差 $\\mathrm{d}\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X}+\\mathrm{d}\\mathbf{X},t)-\\boldsymbol{\\chi}(\\mathbf{X},t)$。对于无穷小的 $\\mathrm{d}\\mathbf{X}$，我们使用流映射的一阶泰勒展开，\n$$\n\\boldsymbol{\\chi}(\\mathbf{X}+\\mathrm{d}\\mathbf{X},t)\\approx \\boldsymbol{\\chi}(\\mathbf{X},t)+\\frac{\\partial \\boldsymbol{\\chi}}{\\partial \\mathbf{X}}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}=\\boldsymbol{\\chi}(\\mathbf{X},t)+\\mathbf{F}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}。\n$$\n因此，\n$$\n\\mathrm{d}\\mathbf{x}=\\mathbf{F}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}。\n$$\n\n物质面元的映射 (Nanson 公式)：设参考构形中的一个小的有向面片由两个独立的微分物质线元 $\\mathrm{d}\\mathbf{X}_{1}$ 和 $\\mathrm{d}\\mathbf{X}_{2}$ 张成，因此其有向面积矢量为\n$$\n\\mathrm{d}\\mathbf{A}=\\mathrm{d}\\mathbf{X}_{1}\\times \\mathrm{d}\\mathbf{X}_{2}。\n$$\n在运动作用下，这些张成纤维映射为 $\\mathrm{d}\\mathbf{x}_{1}=\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{1}$ 和 $\\mathrm{d}\\mathbf{x}_{2}=\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{2}$。当前面片的有向面积矢量则为\n$$\n\\mathrm{d}\\mathbf{a}=\\mathrm{d}\\mathbf{x}_{1}\\times \\mathrm{d}\\mathbf{x}_{2}=(\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{1})\\times (\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{2})。\n$$\n利用一个恒等式，即两个向量经过线性映射 $\\mathbf{F}$ 变换后的叉积等于 $\\mathbf{F}$ 的代数余子式作用于原始叉积，我们有\n$$\n(\\mathbf{F}\\,\\mathbf{u})\\times (\\mathbf{F}\\,\\mathbf{v})=\\operatorname{cof}(\\mathbf{F})\\,(\\mathbf{u}\\times \\mathbf{v})，\n$$\n其中 $\\operatorname{cof}(\\mathbf{F})$ 是 $\\mathbf{F}$ 的代数余子式矩阵。因此，\n$$\n\\mathrm{d}\\mathbf{a}=\\operatorname{cof}(\\mathbf{F})\\,\\mathrm{d}\\mathbf{A}。\n$$\n根据线性代数和连续介质力学中一个经过充分检验的恒等式，$\\operatorname{cof}(\\mathbf{F})=J\\,\\mathbf{F}^{-T}$，其中 $J=\\det \\mathbf{F}$。因此，\n$$\n\\mathrm{d}\\mathbf{a}=J\\,\\mathbf{F}^{-T}\\,\\mathrm{d}\\mathbf{A}。\n$$\n这就是 Nanson 公式，它是从流映射和变形梯度的基本定义推导出来的。\n\n从欧拉速度场得到的简单剪切运动学：给定欧拉速度场\n$$\n\\mathbf{v}(\\mathbf{x},t)=(\\gamma\\,y,\\,0,\\,0)，\n$$\n其中剪切率 $\\gamma$ 为常数。拉格朗日轨迹满足常微分方程\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\gamma\\,y,\\qquad \\frac{\\mathrm{d}y}{\\mathrm{d}t}=0,\\qquad \\frac{\\mathrm{d}z}{\\mathrm{d}t}=0,\n$$\n初始条件在 $t=0$ 时给出，为 $x(0)=X$, $y(0)=Y$, $z(0)=Z$。由于 $\\mathrm{d}y/\\mathrm{d}t=0$，我们有对所有 $t$ 都有 $y(t)=Y$。然后，\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\gamma\\,Y\\quad\\Rightarrow\\quad x(t)=X+\\gamma\\,t\\,Y。\n$$\n类似地，$z(t)=Z$。因此，流映射为\n$$\n\\boldsymbol{\\chi}(\\mathbf{X},t)=\\begin{pmatrix} X+\\gamma\\,t\\,Y \\\\ Y \\\\ Z\\end{pmatrix}。\n$$\n变形梯度是 $\\boldsymbol{\\chi}$ 相对于 $\\mathbf{X}$ 的雅可比矩阵，\n$$\n\\mathbf{F}(\\mathbf{X},t)=\\frac{\\partial \\boldsymbol{\\chi}}{\\partial \\mathbf{X}}=\\begin{pmatrix}\n\\frac{\\partial x}{\\partial X}  \\frac{\\partial x}{\\partial Y}  \\frac{\\partial x}{\\partial Z} \\\\\n\\frac{\\partial y}{\\partial X}  \\frac{\\partial y}{\\partial Y}  \\frac{\\partial y}{\\partial Z} \\\\\n\\frac{\\partial z}{\\partial X}  \\frac{\\partial z}{\\partial Y}  \\frac{\\partial z}{\\partial Z}\n\\end{pmatrix}=\\begin{pmatrix}\n1  \\gamma\\,t  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}。\n$$\n雅可比行列式为\n$$\nJ(\\mathbf{X},t)=\\det \\mathbf{F}=1,\n$$\n这与简单剪切的不可压缩性一致。$\\mathbf{F}$ 的逆矩阵是\n$$\n\\mathbf{F}^{-1}=\\begin{pmatrix}\n1  -\\gamma\\,t  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n因此\n$$\n\\mathbf{F}^{-T}=\\begin{pmatrix}\n1  0  0 \\\\\n-\\gamma\\,t  1  0 \\\\\n0  0  1\n\\end{pmatrix}。\n$$\n\n特定参考元的映射和大小：设单位参考纤维为 $\\mathrm{d}\\mathbf{X}=\\mathbf{M}_{0}$ 且\n$$\n\\mathbf{M}_{0}=(\\cos\\theta,\\sin\\theta,0)。\n$$\n其当前的像为\n$$\n\\mathrm{d}\\mathbf{x}=\\mathbf{F}\\,\\mathbf{M}_{0}=\\begin{pmatrix}\n1  \\gamma\\,t  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\\begin{pmatrix}\\cos\\theta \\\\ \\sin\\theta \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\n\\cos\\theta+\\gamma\\,t\\,\\sin\\theta \\\\ \\sin\\theta \\\\ 0\n\\end{pmatrix}。\n$$\n当前纤维的大小是\n$$\n|\\mathrm{d}\\mathbf{x}|=\\sqrt{\\left(\\cos\\theta+\\gamma\\,t\\,\\sin\\theta\\right)^{2}+\\left(\\sin\\theta\\right)^{2}}=\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta}。\n$$\n\n设单位参考面积矢量为 $\\mathrm{d}\\mathbf{A}=\\mathbf{N}_{0}$ 且\n$$\n\\mathbf{N}_{0}=(\\cos\\phi,\\sin\\phi,0)。\n$$\n根据 $J=1$ 时的 Nanson 公式，其当前的像为\n$$\n\\mathrm{d}\\mathbf{a}=\\mathbf{F}^{-T}\\,\\mathbf{N}_{0}=\\begin{pmatrix}\n1  0  0 \\\\\n-\\gamma\\,t  1  0 \\\\\n0  0  1\n\\end{pmatrix}\\begin{pmatrix}\\cos\\phi \\\\ \\sin\\phi \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\n\\cos\\phi \\\\ -\\gamma\\,t\\,\\cos\\phi+\\sin\\phi \\\\ 0\n\\end{pmatrix}。\n$$\n当前面积矢量的大小是\n$$\n|\\mathrm{d}\\mathbf{a}|=\\sqrt{\\left(\\cos\\phi\\right)^{2}+\\left(-\\gamma\\,t\\,\\cos\\phi+\\sin\\phi\\right)^{2}}=\\sqrt{1-2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}。\n$$\n\n因此，所要求的大小作为 $\\gamma$、$t$、$\\theta$ 和 $\\phi$ 的函数是\n$$\n|\\mathrm{d}\\mathbf{x}|=\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta},\\qquad\n|\\mathrm{d}\\mathbf{a}|=\\sqrt{1-2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}。\n$$\n无需四舍五入，并且由于参考量的大小为单位1，这些是无量纲的表达式。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta}  \\sqrt{1-2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在非定常流中，欧拉和拉格朗日视角之间的区别通过不同的流线可视化技术变得尤为直观。流线、迹线和路径这三个概念常常被混淆，而本练习将挑战您推导迹线的方程——这是一个真正混合了两种描述特点的概念。通过将其与路径和瞬时流线进行对比，您将能清晰地辨别它们各自独特的物理意义。",
            "id": "4086832",
            "problem": "考虑一股不可压缩的牛顿二维脉动射流，从原点 $\\left(x,y\\right)=\\left(0,0\\right)$ 的一个点源射入其他部分均静止的流体中。其欧拉速度场是空间均匀且随时间变化的，由下式给出\n$$\nu\\left(x,y,t\\right)=U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t\\right)\\right],\\qquad v\\left(x,y,t\\right)=V_{0}\\cos\\left(\\omega t\\right),\n$$\n其中，$U_{0}0$ 是恒定的平均轴向速度，$0\\epsilon1$ 是无量纲脉动振幅，$\\omega0$ 是脉动角频率，$V_{0}\\ge 0$ 是由喷嘴周期性摆动产生的恒定横向振荡振幅。假设染料在所有 $t\\ge 0$ 的时间内于原点处连续注入。\n\n从流动的拉格朗日和欧拉描述的第一性原理出发，即流体质点的拉格朗日轨迹 $\\left(x\\left(t\\right),y\\left(t\\right)\\right)$ 满足\n$$\n\\frac{dx}{dt}=u\\left(x\\left(t\\right),y\\left(t\\right),t\\right),\\qquad \\frac{dy}{dt}=v\\left(x\\left(t\\right),y\\left(t\\right),t\\right),\n$$\n并且在时刻 $t^{\\ast}$ 的瞬时欧拉流线是一条曲线 $\\left(x\\left(s\\right),y\\left(s\\right)\\right)$，其切线方向与该瞬间的速度方向一致，满足\n$$\n\\frac{dy}{dx}=\\frac{v\\left(x,y,t^{\\ast}\\right)}{u\\left(x,y,t^{\\ast}\\right)},\n$$\n请完成以下任务：\n\n- 构建在观测时间 $t0$ 时，从原点释放的迹线，该迹线以释放时间 $\\tau\\in\\left[0,t\\right]$ 为参数，并用 $U_{0}$、$\\epsilon$、$\\omega$、$V_{0}$、$t$ 和 $\\tau$ 推导其闭式表达式。\n- 在您的推导过程中，清晰阐明该迹线的形状与在固定时间释放的单个流体质点的路径以及在同一观测时间的瞬时欧拉流线有何不同。\n- 将最终的迹线表示为单一的参数化向量值解析表达式 $\\left(x_{s}\\left(\\tau;t\\right),y_{s}\\left(\\tau;t\\right)\\right)$。\n\n无需进行数值计算。请将您的最终答案以迹线坐标的单一解析表达式形式提供。不要包含单位。关于形状的解释性比较应包含在您的解题过程中，但不包含在最终答案中。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、是适定的且客观的。它提供了一个数学上一致但理想化的非定常流模型，并要求推导迹线——一个流体动力学中的标准概念。\n\n问题的核心是在一个非定常速度场中，区分并推导不同流动显示结构（路径、迹线和流线）的数学表达式。\n\n在观测时间 $t$ 的迹线，是所有在某个先前时间 $\\tau$（其中 $0 \\le \\tau \\le t$）经过一个特定点（此处为原点 $\\left(0,0\\right)$）的流体质点的集合轨迹。为了求得迹线，我们必须首先确定一个从原点释放的普通质点的路径。\n\n假设一个流体质点在时间 $\\tau$ 从原点 $\\left(x_0, y_0\\right) = \\left(0,0\\right)$ 释放。其轨迹（或路径）由位置矢量 $\\mathbf{x}_p(t'; \\tau) = \\left(x_p(t'; \\tau), y_p(t'; \\tau)\\right)$ 给出，适用于时间 $t' \\ge \\tau$。该轨迹通过对速度场进行时间积分得到。控制常微分方程(ODEs)如下：\n$$\n\\frac{dx_p}{dt'} = u\\left(x_p, y_p, t'\\right) = U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t'\\right)\\right]\n$$\n$$\n\\frac{dy_p}{dt'} = v\\left(x_p, y_p, t'\\right) = V_{0}\\cos\\left(\\omega t'\\right)\n$$\n初始条件为质点在其释放时间 $\\tau$ 时位于原点：\n$$\nx_p(\\tau; \\tau) = 0, \\qquad y_p(\\tau; \\tau) = 0.\n$$\n给定速度场的一个关键特征是其空间均匀性；$u$ 和 $v$ 仅是时间 $t'$ 的函数。这简化了积分过程，因为质点的速度仅取决于时间瞬间，而与其位置无关。\n\n我们将常微分方程从释放时间 $\\tau$ 积分到一个更晚的时间 $t'$：\n对于路径的x坐标：\n$$\nx_p(t'; \\tau) = \\int_{\\tau}^{t'} U_{0}\\left[1+\\epsilon \\sin\\left(\\omega s\\right)\\right] ds\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left[s - \\frac{\\epsilon}{\\omega}\\cos(\\omega s)\\right]_{\\tau}^{t'}\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left[ \\left(t' - \\frac{\\epsilon}{\\omega}\\cos(\\omega t')\\right) - \\left(\\tau - \\frac{\\epsilon}{\\omega}\\cos(\\omega \\tau)\\right) \\right]\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left( t' - \\tau - \\frac{\\epsilon}{\\omega} \\left[ \\cos(\\omega t') - \\cos(\\omega \\tau) \\right] \\right)\n$$\n对于路径的y坐标：\n$$\ny_p(t'; \\tau) = \\int_{\\tau}^{t'} V_{0}\\cos\\left(\\omega s\\right) ds\n$$\n$$\ny_p(t'; \\tau) = V_{0} \\left[\\frac{1}{\\omega}\\sin(\\omega s)\\right]_{\\tau}^{t'}\n$$\n$$\ny_p(t'; \\tau) = \\frac{V_{0}}{\\omega} \\left[ \\sin(\\omega t') - \\sin(\\omega \\tau) \\right]\n$$\n这两个方程描述了在时间 $\\tau$ 从原点释放的一个质点的路径，该路径以观测时间 $t' \\ge \\tau$ 为参数。\n\n现在，我们构建迹线。在特定观测时间 $t$ 的迹线是所有在区间 $\\left[0, t\\right]$ 内任一时间 $\\tau$ 从原点释放的质点的位置集合。为了找到迹线的方程，我们在路径方程中将观测时间 $t'$ 固定为 $t$，并将释放时间 $\\tau$ 视为曲线的参数。因此，迹线 $\\left(x_s(\\tau; t), y_s(\\tau; t)\\right)$ 以 $\\tau \\in \\left[0, t\\right]$ 为参数。\n\n在路径方程中令 $t' = t$ 即可得到迹线坐标：\n$$\nx_s(\\tau; t) = U_{0} \\left( t - \\tau - \\frac{\\epsilon}{\\omega} \\left[ \\cos(\\omega t) - \\cos(\\omega \\tau) \\right] \\right)\n$$\n$$\ny_s(\\tau; t) = \\frac{V_{0}}{\\omega} \\left[ \\sin(\\omega t) - \\sin(\\omega \\tau) \\right]\n$$\n这是在观测时间 $t$ 的迹线的闭式表达式。\n\n按照要求，我们现在阐明该迹线与路径和流线之间的区别。\n1.  **路径**：路径是*单个*流体质点随时间变化的轨迹。例如，对于在 $\\tau=0$ 释放的质点，其路径由 $\\left(x_p(t'; 0), y_p(t'; 0)\\right)$ 给出，其中 $t'$ 是可变的时间参数。路径是一个质点位置的时间历史。\n2.  **迹线**：迹线是在时间 $t$ 的一个*瞬时*快照，显示了由其释放时间 $\\tau$ 区分的*许多*不同质点的位置。它是由所有经过原点的质点形成的一条空间曲线。\n3.  **流线**：流线是一条*瞬时*曲线，在某一固定时刻（例如 $t^*$）处处与速度矢量场相切。流线的方程通过积分 $\\frac{dy}{dx} = \\frac{v(x,y,t^*)}{u(x,y,t^*)}$ 给出。对于本问题：\n    $$\n    \\frac{dy}{dx} = \\frac{V_{0}\\cos\\left(\\omega t^*\\right)}{U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t^*\\right)\\right]}\n    $$\n    由于对于给定的 $t^*$，等式右侧是一个常数，因此流线是一族直线。在时间 $t^*$ 经过原点 $\\left(0,0\\right)$ 的流线是直线 $y = \\left(\\frac{v(t^*)}{u(t^*)}\\right) x$。\n\n总而言之，对于此非定常流：\n-   在时间 $t$ 的**流线**是一条穿过原点的直线，其斜率随时间变化。\n-   **路径**是单个流体质点在一段时间内追踪出的通常为曲线的路径。\n-   **迹线**是在单个瞬间 $t$ 时，“染料”或“烟”丝的通常为曲线的形状，由在不同过去时间释放的质点组成。\n\n因为速度场是随时间变化的（非定常的），所以这三种曲线是不同的。只有当流动是定常的时（即，如果 $\\epsilon=0$ 且 $V_0=0$），它们才会重合。推导出的迹线表达式是一条复杂的参数曲线，明显不同于瞬时流线的直线形状。\n\n最终答案是迹线坐标的向量值表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nU_{0} \\left( t - \\tau - \\frac{\\epsilon}{\\omega} \\left( \\cos(\\omega t) - \\cos(\\omega \\tau) \\right) \\right)  \\frac{V_{0}}{\\omega} \\left( \\sin(\\omega t) - \\sin(\\omega \\tau) \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在欧拉和拉格朗日描述之间的理论选择对计算流体动力学中的数值模拟具有深远影响。最后的这项实践将带您从纸笔分析走向计算机编程。您需要为一个经典的标量平流问题，实现并比较一个固定网格的欧拉格式和一个基于特征线的半拉格朗日格式，从而在精度和稳定性方面，直接洞察这两种计算方法的各自优势。",
            "id": "4086856",
            "problem": "考虑一个长度为 $L=1$（无量纲单位）的一维周期性域中的被动标量平流。设标量场为 $\\phi(x,t)$，定义于 $x \\in [0,1)$ 和 $t \\ge 0$。设速度场为均匀常数 $u=1$（无量纲单位）。控制方程为线性平流方程\n$$\n\\partial_t \\phi + u \\,\\partial_x \\phi = 0,\n$$\n其边界条件为周期性边界条件，初始条件 $\\phi(x,0)=\\phi_0(x)$ 由下式给出\n$$\n\\phi_0(x) = \\sin(2\\pi x) + 0.3 \\cos(6\\pi x) + 0.05 \\sin(10\\pi x).\n$$\n欧拉描述在固定的空间位置上计算 $\\phi$，而拉格朗日描述则沿粒子路径追踪特征线。你需要实现并比较一个二阶精度的欧拉守恒格式和一个通过特征线回溯与插值计算相同平流输运的半拉格朗日格式。使用以下基本原理：平流物理量的守恒、速度的定义 $u=\\mathrm{d}x/\\mathrm{d}t$ 以及特征线法。确保欧拉格式与线性平流方程相容，以守恒形式表达输运，并且在满足 Courant-Friedrichs-Lewy (CFL) 条件的稳定性约束下，在空间和时间上均为二阶精度。半拉格朗日格式应将每个网格位置沿特征线向后回溯一个时间步长以追踪其出发点，并使用周期性线性插值在该出发点位置重构 $\\phi$。\n\n在具有 $N$ 个点、间距为 $\\Delta x = L/N$ 的均匀网格上实现这两种格式，时间步长为 $\\Delta t$，计算至指定的最终时间 $T$。使用特征位移计算在时间 $T$ 的精确解：\n$$\n\\phi_{\\text{exact}}(x,T) = \\phi_0(x - uT \\bmod 1).\n$$\n对于每种数值方法和每个测试用例，使用以下范数量化在 $t=T$ 时的误差：\n- 离散 $L^2$ 范数误差：\n$$\nE_2 = \\left(\\sum_{i=0}^{N-1} \\left(\\phi_i - \\phi_{\\text{exact},i}\\right)^2 \\Delta x\\right)^{1/2},\n$$\n- 离散 $L^\\infty$ 范数误差：\n$$\nE_\\infty = \\max_{0 \\le i \\le N-1} \\left|\\phi_i - \\phi_{\\text{exact},i}\\right|.\n$$\n\n所有量都是无量纲的，并且必须在无量纲单位中进行一致处理。三角函数中的角度以弧度为单位。你的程序必须产生数值结果（浮点数）。不涉及百分比。\n\n测试组：\n使用以下参数值集合 $(N, \\Delta t, n_t)$，其中 $n_t$ 是时间步数，且 $T = n_t \\,\\Delta t$：\n1. 用例 A (理想情况)：$N=128$, $\\Delta t=0.002$, $n_t=250$，因此 $T=0.5$。\n2. 用例 B (接近 CFL 边界)：$N=128$, $\\Delta t=0.007421875$, $n_t=67$，因此 $T=0.497265625$，其中 Courant 数为 $\\lambda = u\\,\\Delta t/\\Delta x \\approx 0.95$。\n3. 用例 C (粗网格)：$N=64$, $\\Delta t=0.0078125$, $n_t=64$，因此 $T=0.5$，其中 $\\lambda = 0.5$。\n4. 用例 D (边界情况，CFL 等于 1)：$N=100$, $\\Delta t=0.01$, $n_t=50$，因此 $T=0.5$，其中 $\\lambda = 1.0$。\n\n对于每个用例，计算欧拉方法的 $(E_2,E_\\infty)$ 和半拉格朗日方法的 $(E_2,E_\\infty)$。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果按用例和方法排序，每个用例包含四个数字，顺序为 $[E_{2,\\text{Eulerian}},E_{2,\\text{Semi-Lagrangian}},E_{\\infty,\\text{Eulerian}},E_{\\infty,\\text{Semi-Lagrangian}}]$。因此，最终输出必须是包含四个用例的共 16 个浮点数的列表，并按指定顺序排列。",
            "solution": "在尝试提供解答之前，对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **控制方程**：一维线性平流方程，$\\partial_t \\phi + u \\,\\partial_x \\phi = 0$。\n*   **域**：一个长度为 $L=1$ 的周期性域，对于 $x \\in [0,1)$ 和 $t \\ge 0$。\n*   **速度场**：一个均匀常数速度，$u=1$。\n*   **初始条件**：$\\phi(x,0)=\\phi_0(x) = \\sin(2\\pi x) + 0.3 \\cos(6\\pi x) + 0.05 \\sin(10\\pi x)$。\n*   **数值方法**：\n    1.  一个在空间和时间上均为二阶精度的欧拉守恒格式。\n    2.  一个使用特征线回溯和周期性线性插值的半拉格朗日格式。\n*   **离散化**：一个具有 $N$ 个点、间距为 $\\Delta x = L/N$ 的均匀网格。时间步长为 $\\Delta t$，模拟运行 $n_t$ 步，直至最终时间 $T=n_t \\Delta t$。\n*   **精确解**：$\\phi_{\\text{exact}}(x,T) = \\phi_0(x - uT \\bmod 1)$。\n*   **误差度量**：\n    *   $L^2$ 范数误差：$E_2 = \\left(\\sum_{i=0}^{N-1} \\left(\\phi_i - \\phi_{\\text{exact},i}\\right)^2 \\Delta x\\right)^{1/2}$。\n    *   $L^\\infty$ 范数误差：$E_\\infty = \\max_{0 \\le i \\le N-1} \\left|\\phi_i - \\phi_{\\text{exact},i}\\right|$。\n*   **测试用例**：\n    1.  用例 A：$N=128$, $\\Delta t=0.002$, $n_t=250$。\n    2.  用例 B：$N=128$, $\\Delta t=0.007421875$, $n_t=67$。\n    3.  用例 C：$N=64$, $\\Delta t=0.0078125$, $n_t=64$。\n    4.  用例 D：$N=100$, $\\Delta t=0.01$, $n_t=50$。\n*   **输出规格**：单行输出，包含一个用方括号括起来的逗号分隔列表，其中包含 16 个浮点数，按用例 A 到 D 的顺序排列，每个用例的顺序为 $[E_{2,\\text{Eulerian}}, E_{2,\\text{Semi-Lagrangian}}, E_{\\infty,\\text{Eulerian}}, E_{\\infty,\\text{Semi-Lagrangian}}]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题在根本上是合理的。它涉及线性平流方程，这是物理学和工程学中输运现象的基石。欧拉和半拉格朗日方法是求解该方程的标准、成熟的数值技术。\n*   **适定性**：线性平流方程的初边值问题是适定的，保证了解的唯一性和稳定性。该数值问题已指定了构建解所需的所有必要参数。\n*   **客观性**：该问题使用精确的数学语言陈述，没有歧义或主观解释。\n*   **缺陷分析**：\n    1.  该问题在科学和数学上是合理的。\n    2.  该问题与计算流体动力学方法的指定主题直接相关。\n    3.  该问题是自包含的。\n    4.  对于一个基准测试来说，这些条件和参数在物理上和计算上都是现实的。\n    5.  问题结构良好，能导出一个唯一的数值结果。\n    6.  问题并非微不足道；它需要正确实现两种不同的数值格式并进行误差分析。\n    7.  结果是可进行数值验证的。\n\n**步骤 3：结论与行动**\n\n问题被认为是**有效的**。将提供解答。\n\n### 解答推导与实现\n\n该问题要求使用两种不同的方法，在一个长度为 $L=1$、速度为 $u=1$ 的周期性域上，对一维线性平流方程 $\\partial_t \\phi + u\\,\\partial_x \\phi = 0$ 进行数值求解。\n\n该方程的基本原理是标量 $\\phi$ 沿特征线守恒。这些曲线由常微分方程 $\\frac{dx}{dt} = u$ 定义。对于恒定速度 $u$，通过点 $(x, t)$ 的特征线起源于点 $(x_d, t_0)$，其中 $x = x_d + u(t-t_0)$。因此，精确解是初始剖面的简单平移：$\\phi(x,t) = \\phi(x-ut, 0) = \\phi_0(x-ut)$。在一个长度为 $L=1$ 的周期性域上，这变为 $\\phi_{\\text{exact}}(x,T) = \\phi_0((x - uT) \\pmod 1)$。\n\n我们现在将详细介绍这两种数值格式。\n\n**1. 欧拉方法：Lax-Wendroff 格式**\n\n问题要求一个二阶精度、守恒的欧拉格式。Lax-Wendroff 格式满足这些标准。我们从 $\\phi$ 在时间上的泰勒级数展开开始：\n$$\n\\phi(x, t+\\Delta t) = \\phi(x,t) + \\Delta t \\, \\partial_t \\phi(x,t) + \\frac{(\\Delta t)^2}{2} \\, \\partial_{tt} \\phi(x,t) + \\mathcal{O}((\\Delta t)^3)\n$$\n根据控制方程，我们有 $\\partial_t \\phi = -u \\, \\partial_x \\phi$。对此式关于时间求导可得 $\\partial_{tt} \\phi = -u \\, \\partial_{tx} \\phi$。假设有足够的光滑性，我们可以交换微分顺序，$\\partial_{tx} \\phi = \\partial_{xt} \\phi$。对控制方程关于空间求导可得 $\\partial_{xt} \\phi = -u \\, \\partial_{xx} \\phi$。综合这些，我们发现 $\\partial_{tt} \\phi = u^2 \\, \\partial_{xx} \\phi$。将这些时间导数代入泰勒展开式，得到一个纯空间表示：\n$$\n\\phi(x, t+\\Delta t) = \\phi(x,t) - u \\Delta t \\, \\partial_x \\phi(x,t) + \\frac{(u \\Delta t)^2}{2} \\, \\partial_{xx} \\phi(x,t) + \\mathcal{O}((\\Delta t)^3)\n$$\n现在我们在均匀网格 $x_i = i \\Delta x$（其中 $i=0, \\ldots, N-1$）上离散化此方程，时间层为 $t_n = n \\Delta t$。令 $\\phi_i^n \\approx \\phi(x_i, t_n)$。我们使用二阶中心有限差分来处理空间导数：\n$$\n\\partial_x \\phi \\bigg|_{x_i} \\approx \\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2 \\Delta x}, \\quad \\partial_{xx} \\phi \\bigg|_{x_i} \\approx \\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些代入时间展开的方程，得到半离散格式：\n$$\n\\phi_i^{n+1} = \\phi_i^n - u \\Delta t \\left(\\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2 \\Delta x}\\right) + \\frac{(u \\Delta t)^2}{2} \\left(\\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{(\\Delta x)^2}\\right)\n$$\n引入 Courant 数 $\\lambda = u \\Delta t / \\Delta x$，我们可以将更新公式写为：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{\\lambda}{2}(\\phi_{i+1}^n - \\phi_{i-1}^n) + \\frac{\\lambda^2}{2}(\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n)\n$$\n按空间索引对各项进行分组，我们得到计算模板：\n$$\n\\phi_i^{n+1} = \\left(\\frac{\\lambda^2 - \\lambda}{2}\\right)\\phi_{i+1}^n + (1 - \\lambda^2)\\phi_i^n + \\left(\\frac{\\lambda^2 + \\lambda}{2}\\right)\\phi_{i-1}^n\n$$\n这种显式格式在空间和时间上都是二阶精度的，并且在 CFL 条件 $|\\lambda| \\le 1$ 下是稳定的。通过对索引应用模运算来处理周期性，例如 $\\phi_{-1}^n = \\phi_{N-1}^n$ 和 $\\phi_N^n = \\phi_0^n$。\n\n**2. 半拉格朗日方法**\n\n此方法直接利用特征线法。为了在新时间 $t_{n+1}$ 找到网格点 $x_i$ 处的标量场值，我们沿特征路径向后追溯时间 $\\Delta t$。出发点 $x_d$ 是流体粒子在时间 $t_n$ 的起始位置，该粒子在时间 $t_{n+1}$ 到达 $x_i$。\n$$\nx_i = x_d + u \\Delta t \\implies x_d = x_i - u \\Delta t\n$$\n由于 $\\phi$ 沿特征线是恒定的，我们有 $\\phi(x_i, t_{n+1}) = \\phi(x_d, t_n)$。出发点 $x_d$ 通常不与网格点重合。因此，其值必须通过对时间 $t_n$ 的已知网格值进行插值来重构。问题指定使用周期性线性插值。\n\n每个网格点 $i$ 的离散更新规则是：\n$$\n\\phi_i^{n+1} = \\text{Interpolate}(\\{\\phi_j^n\\}, x_d = x_i - u \\Delta t)\n$$\n插值必须遵守域的周期性。如果出发点 $x_d$ 位于 $[0, L)$ 之外，它将被映射回该域内，即 $x_d' = x_d \\pmod L$。一种同时对所有网格点实现此操作的计算高效方法是使用支持周期性插值的数值库函数。给定网格点 $x_j=j\\Delta x$ 和值 $\\phi_j^n$，我们需要在出发点数组 $x_{d,i} = x_i - u \\Delta t$ 处找到值。\n\n在实现中，我们可以使用支持周期性域的 `numpy.interp`。对于一组查询点 `xq`、数据点 `xp` 和函数值 `fp`，`numpy.interp(xq, xp, fp, period=L)` 执行线性插值，通过在周期长度 `L` 上环绕 `xq` 值，正确处理 `xp` 范围之外的 `xq` 值。在每个时间步，新的标量场计算如下：\n$$\n\\vec{\\phi}^{n+1} = \\text{interp}(\\vec{x} - u\\Delta t, \\vec{x}, \\vec{\\phi}^n, \\text{period}=L)\n$$\n其中 $\\vec{x}$ 是网格点坐标的向量，$\\vec{\\phi}^n$ 是时间 $t_n$ 的标量值向量。该格式是无条件稳定的，因为插值是一种有界操作。其精度由插值的阶数决定；对于线性插值，它在空间上是一阶的，尽管其数值耗散远低于标准的一阶欧拉（迎风）格式。\n\n**误差计算**\n\n在用每种方法模拟到最终时间 $T=n_t\\Delta t$ 后，将数值解 $\\phi_i$ 与精确解 $\\phi_{\\text{exact},i} = \\phi_0((x_i - uT) \\pmod 1)$ 进行比较。使用指定的离散 $L^2$ 和 $L^\\infty$ 范数量化误差。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection equation using two numerical schemes\n    and computes their errors against the exact solution for a suite of test cases.\n    \"\"\"\n\n    def phi_initial(x):\n        \"\"\"\n        Defines the initial condition phi_0(x).\n        \"\"\"\n        return (np.sin(2 * np.pi * x) +\n                0.3 * np.cos(6 * np.pi * x) +\n                0.05 * np.sin(10 * np.pi * x))\n\n    def run_simulation(N, dt, nt):\n        \"\"\"\n        Runs one simulation case for both Eulerian and Semi-Lagrangian methods.\n        \n        Args:\n            N (int): Number of grid points.\n            dt (float): Time step size.\n            nt (int): Number of time steps.\n\n        Returns:\n            tuple: A tuple containing four error metrics:\n                   (E2_eulerian, E2_semi_lagrangian,\n                    E_inf_eulerian, E_inf_semi_lagrangian).\n        \"\"\"\n        # --- Setup ---\n        L = 1.0\n        u = 1.0\n        dx = L / N\n        T = nt * dt\n        lambda_cfl = u * dt / dx\n\n        # Spatial grid (cell centers)\n        x = np.arange(N) * dx\n\n        # --- Initial conditions for both methods ---\n        phi_eul = phi_initial(x)\n        phi_sl = phi_initial(x)\n\n        # --- Time-stepping for Eulerian (Lax-Wendroff) method ---\n        # Coefficients for the Lax-Wendroff scheme\n        c1 = 0.5 * (lambda_cfl**2 - lambda_cfl)\n        c2 = 1.0 - lambda_cfl**2\n        c3 = 0.5 * (lambda_cfl**2 + lambda_cfl)\n\n        for _ in range(nt):\n            phi_eul_ip1 = np.roll(phi_eul, -1)  # phi_{i+1}\n            phi_eul_im1 = np.roll(phi_eul, 1)   # phi_{i-1}\n            phi_eul_new = (c1 * phi_eul_ip1 +\n                           c2 * phi_eul +\n                           c3 * phi_eul_im1)\n            phi_eul = phi_eul_new\n\n        # --- Time-stepping for Semi-Lagrangian method ---\n        for _ in range(nt):\n            # Departure points for all grid locations\n            x_departure = x - u * dt\n            # Interpolate to find values at departure points, with periodic handling\n            phi_sl = np.interp(x_departure, x, phi_sl, period=L)\n\n        # --- Error Calculation ---\n        # Exact solution at time T\n        x_shifted = (x - u * T)\n        phi_exact = phi_initial(x_shifted)\n        \n        # Note: The problem statement uses x mod 1. For x0, x mod 1 can be negative in some languages.\n        # Python's % operator behaves as a proper modulo for floats,\n        # e.g., -0.2 % 1.0 = 0.8. However, phi_initial is periodic with period 1, so this is robust.\n\n        # Calculate errors for Eulerian method\n        error_eul = phi_eul - phi_exact\n        E2_eul = np.sqrt(np.sum(error_eul**2) * dx)\n        E_inf_eul = np.max(np.abs(error_eul))\n\n        # Calculate errors for Semi-Lagrangian method\n        error_sl = phi_sl - phi_exact\n        E2_sl = np.sqrt(np.sum(error_sl**2) * dx)\n        E_inf_sl = np.max(np.abs(error_sl))\n\n        return E2_eul, E2_sl, E_inf_eul, E_inf_sl\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path)\n        (128, 0.002, 250),\n        # Case B (near-CFL boundary)\n        (128, 0.007421875, 67),\n        # Case C (coarse grid)\n        (64, 0.0078125, 64),\n        # Case D (edge case CFL=1)\n        (100, 0.01, 50),\n    ]\n\n    # --- Run all cases and collect results ---\n    results = []\n    for case in test_cases:\n        N, dt, nt = case\n        e2_eul, e2_sl, einf_eul, einf_sl = run_simulation(N, dt, nt)\n        results.extend([e2_eul, e2_sl, einf_eul, einf_sl])\n\n    # Final print statement in the exact required format.\n    return f\"[{','.join(f'{r:.15e}' for r in results)}]\"\n\n# The answer is generated by calling this function.\n```",
            "answer": "[4.498425257121775e-04,3.003927694931341e-03,6.386996417756910e-04,5.438515328400037e-03,1.602517861962325e-02,5.776634560706240e-03,2.449755490403756e-02,1.066465839846394e-02,2.909983190822606e-03,1.385317377519961e-02,5.201704987483648e-03,2.451676646698696e-02,4.898687770830491e-15,1.206413242277028e-15,1.065814103640150e-14,2.220446049250313e-15]"
        }
    ]
}