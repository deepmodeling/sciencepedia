{
    "hands_on_practices": [
        {
            "introduction": "柯西应力张量的核心作用是定义作用于连续体内部任意方向平面的力，即牵引力矢量。这个练习将提供一个直接应用基本柯西关系式 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ 的机会，这是连续介质力学的一块基石，也是连接抽象张量概念与可测量物理力的桥梁。",
            "id": "4106138",
            "problem": "在一项关于粘弹性液体的计算研究中，该液体受线性动量守恒和柯西应力原理支配。通过数值方法，一个物质点上的局部柯西应力张量被解析为\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}2 & 1 & 0 \\\\ 1 & 3 & 0 \\\\ 0 & 0 & -1\\end{pmatrix},\n$$\n其中所有分量的单位均为帕斯卡。考虑一个穿过该点的定向平面，其单位法向量为\n$$\n\\mathbf{n}=(1,0,0).\n$$\n从“作用在定向平面上的面力由该点的应力状态决定，并线性地依赖于该平面的单位法向量”这一基本陈述出发，并使用线性动量守恒作为基本物理定律，结合相对于 $\\mathbf{n}$ 的法向和切向分量的定义，确定该平面上的面力向量，并将其分解为相对于 $\\mathbf{n}$ 的法向和切向分量。\n\n将你的最终结果表示为单行矩阵\n$$\n\\big[t_{x},\\, t_{y},\\, t_{z},\\, t_{n},\\, (t_{t})_{x},\\, (t_{t})_{y},\\, (t_{t})_{z}\\big],\n$$\n其中 $\\mathbf{t}=(t_{x},t_{y},t_{z})$ 是面力向量，$t_{n}$ 是标量法向分量（$\\mathbf{t}$ 在 $\\mathbf{n}$ 上的投影），而 $\\mathbf{t}_{t}=\\mathbf{t}-(t_{n})\\mathbf{n}$ 是切向分量。各分量以帕斯卡表示。无需四舍五入。如果出现角度，必须以弧度为单位。",
            "solution": "所述问题具有科学依据，提法恰当，客观，并包含获得唯一解所需的所有信息。这是柯西应力原理的直接应用，该原理是连续介质力学中的一个基本概念。因此，该问题被认为是有效的，并将提供解答。\n\n连续介质中一点的柯西应力张量 $\\boldsymbol{\\sigma}$ 与作用于穿过该点的无穷小面元上的面力向量 $\\mathbf{t}$ 之间的关系由柯西关系式给出。该关系式表明，面力向量是应力张量作用于该面的单位法向量 $\\mathbf{n}$ 的结果：\n$$\n\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}\n$$\n在笛卡尔坐标系中，使用爱因斯坦求和约定，这个矩阵-向量方程可以写成分量形式 $t_i = \\sigma_{ij}n_j$，其中 $i,j \\in \\{1, 2, 3\\}$。\n\n问题给出了柯西应力张量：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 3 & 0 \\\\ 0 & 0 & -1 \\end{pmatrix}\n$$\n其中所有分量的单位均为帕斯卡。平面的单位法向量为：\n$$\n\\mathbf{n} = (1, 0, 0)\n$$\n我们可以将 $\\mathbf{n}$ 表示为用于矩阵乘法的列向量：\n$$\n\\mathbf{n} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n首先，我们通过执行乘法 $\\boldsymbol{\\sigma}\\mathbf{n}$ 来计算面力向量 $\\mathbf{t} = (t_x, t_y, t_z)$：\n$$\n\\mathbf{t} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 3 & 0 \\\\ 0 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (1)(0) + (0)(0) \\\\ (1)(1) + (3)(0) + (0)(0) \\\\ (0)(1) + (0)(0) + (-1)(0) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n因此，面力向量为 $\\mathbf{t} = (2, 1, 0)$ 帕斯卡。其分量为 $t_x = 2$，$t_y = 1$ 和 $t_z = 0$。\n\n接下来，我们将面力向量 $\\mathbf{t}$ 分解为相对于单位法向量 $\\mathbf{n}$ 的法向和切向分量。\n\n法向分量 $t_n$ 是 $\\mathbf{t}$ 在 $\\mathbf{n}$ 上的标量投影。这可以通过点积计算：\n$$\nt_n = \\mathbf{t} \\cdot \\mathbf{n} = (2, 1, 0) \\cdot (1, 0, 0) = (2)(1) + (1)(0) + (0)(0) = 2\n$$\n面力的法向分量是 $t_n = 2$ 帕斯卡。\n\n切向分量是一个向量 $\\mathbf{t}_t$，它是 $\\mathbf{t}$ 中位于由 $\\mathbf{n}$ 定义的平面内的部分。它通过从 $\\mathbf{t}$ 本身减去 $\\mathbf{t}$ 在 $\\mathbf{n}$ 上的向量投影得到。$\\mathbf{t}$ 在 $\\mathbf{n}$ 上的向量投影是 $(t_n)\\mathbf{n}$。切向分量的公式是：\n$$\n\\mathbf{t}_t = \\mathbf{t} - (t_n)\\mathbf{n}\n$$\n代入计算出的值：\n$$\n\\mathbf{t}_t = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} - (2) \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2-2 \\\\ 1-0 \\\\ 0-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n因此，切向分量向量为 $\\mathbf{t}_t = (0, 1, 0)$ 帕斯卡。其分量为 $(t_t)_x = 0$，$(t_t)_y = 1$ 和 $(t_t)_z = 0$。作为必要的检查，切向分量必须与法向量正交：$\\mathbf{t}_t \\cdot \\mathbf{n} = (0,1,0) \\cdot (1,0,0) = 0$，这得到了证实。\n\n最后，我们按照规定将所需分量组合成一个单行矩阵：\n$$\n\\big[t_{x},\\, t_{y},\\, t_{z},\\, t_{n},\\, (t_{t})_{x},\\, (t_{t})_{y},\\, (t_{t})_{z}\\big]\n$$\n代入计算出的值，我们得到：\n- $t_{x} = 2$\n- $t_{y} = 1$\n- $t_{z} = 0$\n- $t_{n} = 2$\n- $(t_{t})_{x} = 0$\n- $(t_{t})_{y} = 1$\n- $(t_{t})_{z} = 0$\n\n最终结果是包含这七个数值的行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 1 & 0 & 2 & 0 & 1 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然应力张量完整地描述了一个点的应力状态，但它的主值（特征值）揭示了关于极限状态的关键信息。这个练习将演示如何利用主应力来找到材料中的最大剪切应力，这是预测材料屈服、断裂或分析流动诱导变形的关键物理量。",
            "id": "4106091",
            "problem": "使用计算流体力学（CFD）在一个稳态均匀剪切流中模拟一种粘弹性聚合物溶液。在某材料点，对称的柯西应力张量 $\\boldsymbol{\\sigma}$ 被谱分解为 $\\boldsymbol{\\sigma} = \\sum_{i=1}^{3} \\sigma_{i} \\,\\boldsymbol{e}_{i} \\otimes \\boldsymbol{e}_{i}$，其中 $\\sigma_{i}$ 是实特征值（主应力），$\\boldsymbol{e}_{i}$ 是在实验室基中表示的相应标准正交特征向量（主方向）。从模拟中获得以下数据：\n- 特征值（单位：帕斯卡）：$\\sigma_{1} = 1.8 \\times 10^{3}$，$\\sigma_{2} = 0.2 \\times 10^{3}$，$\\sigma_{3} = -0.6 \\times 10^{3}$。\n- 特征向量：$\\boldsymbol{e}_{1} = \\frac{1}{\\sqrt{3}}(1,1,1)$，$\\boldsymbol{e}_{2} = \\frac{1}{\\sqrt{2}}(1,-1,0)$，$\\boldsymbol{e}_{3} = \\frac{1}{\\sqrt{6}}(1,1,-2)$。\n\n仅使用柯西应力、平面上的面力向量以及将面力分解为法向和剪切分量的基本定义，确定：\n1. 可作用于通过该点的任意平面上的最大剪应力大小。\n2. 此最大剪应力作用的平面，用其单位法向量来表征。\n\n在最大剪应力平面中，选择其单位法向量在实验室基中的所有分量均为非负的那个平面，并报告：\n- 最大剪应力大小。\n- 所选单位法向量的三个分量。\n\n以帕斯卡表示最大剪应力。无需四舍五入；为所有报告的量提供精确值。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法恰当，并包含所有必要信息且无矛盾。\n\n某点的应力状态由对称的柯西应力张量 $\\boldsymbol{\\sigma}$ 完全定义。该张量的特征值 $\\sigma_i$ 是主应力，相应的特征向量 $\\boldsymbol{e}_i$ 是主方向。问题提供了这些值。任务是找到最大剪应力 $\\tau_{\\text{max}}$ 及其作用的特定平面的法向量。\n\n首先，我们识别并排序主应力。给定的特征值是：\n$\\sigma_{1} = 1.8 \\times 10^{3} \\, \\text{Pa}$\n$\\sigma_{2} = 0.2 \\times 10^{3} \\, \\text{Pa}$\n$\\sigma_{3} = -0.6 \\times 10^{3} \\, \\text{Pa}$\n让我们将它们从大到小排序，记为 $\\sigma_I, \\sigma_{II}, \\sigma_{III}$：\n$\\sigma_I = \\sigma_{1} = 1.8 \\times 10^{3} \\, \\text{Pa}$\n$\\sigma_{II} = \\sigma_{2} = 0.2 \\times 10^{3} \\, \\text{Pa}$\n$\\sigma_{III} = \\sigma_{3} = -0.6 \\times 10^{3} \\, \\text{Pa}$\n相应的主方向是 $\\boldsymbol{e}_I = \\boldsymbol{e}_1$，$\\boldsymbol{e}_{II} = \\boldsymbol{e}_2$ 和 $\\boldsymbol{e}_{III} = \\boldsymbol{e}_3$。\n\n在单位法向量为 $\\boldsymbol{n}$ 的平面上，剪应力的大小 $\\tau_n$ 与主应力有关。三个主剪应力由下式给出：\n$\\tau_{I,II} = \\frac{\\sigma_I - \\sigma_{II}}{2}$\n$\\tau_{II,III} = \\frac{\\sigma_{II} - \\sigma_{III}}{2}$\n$\\tau_{I,III} = \\frac{\\sigma_I - \\sigma_{III}}{2}$\n\n该点的最大剪应力 $\\tau_{\\text{max}}$ 是这三个值中最大的一个。它始终等于最大和最小主应力之差的一半：\n$$\n\\tau_{\\text{max}} = \\frac{\\sigma_I - \\sigma_{III}}{2}\n$$\n代入给定值：\n$$\n\\tau_{\\text{max}} = \\frac{(1.8 \\times 10^{3}) - (-0.6 \\times 10^{3})}{2} = \\frac{1.8 \\times 10^{3} + 0.6 \\times 10^{3}}{2} = \\frac{2.4 \\times 10^{3}}{2} = 1.2 \\times 10^{3} \\, \\text{Pa}\n$$\n\n最大剪应力作用在法向量平分最大和最小主应力（$\\boldsymbol{e}_I$ 和 $\\boldsymbol{e}_{III}$）对应的主方向之间夹角的平面上。在本例中，即 $\\boldsymbol{e}_1$ 和 $\\boldsymbol{e}_3$。这些平面的单位法向量 $\\boldsymbol{n}$ 由以下通式给出：\n$$\n\\boldsymbol{n} = \\frac{1}{\\sqrt{2}}(\\boldsymbol{e}_1 \\pm \\boldsymbol{e}_3)\n$$\n以及它们的反向向量。这给出了四个可能的法向量，定义了两个相互垂直的平面。我们在实验室基中给出的特征向量是：\n$\\boldsymbol{e}_1 = \\frac{1}{\\sqrt{3}}(1, 1, 1)$\n$\\boldsymbol{e}_3 = \\frac{1}{\\sqrt{6}}(1, 1, -2)$\n\n我们需要计算向量 $\\boldsymbol{n}$ 并选择其所有分量均为非负的那个。让我们计算两个候选向量，$\\boldsymbol{n}_a = \\frac{1}{\\sqrt{2}}(\\boldsymbol{e}_1 + \\boldsymbol{e}_3)$ 和 $\\boldsymbol{n}_b = \\frac{1}{\\sqrt{2}}(\\boldsymbol{e}_1 - \\boldsymbol{e}_3)$。\n\n首先，对于 $\\boldsymbol{n}_a$：\n$$\n\\boldsymbol{e}_1 + \\boldsymbol{e}_3 = \\frac{1}{\\sqrt{3}}(1, 1, 1) + \\frac{1}{\\sqrt{6}}(1, 1, -2) = \\left(\\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{6}}, \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{6}}, \\frac{1}{\\sqrt{3}} - \\frac{2}{\\sqrt{6}}\\right)\n$$\n为了简化，我们注意到 $\\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{2}}{\\sqrt{6}}$。\n$$\n\\boldsymbol{e}_1 + \\boldsymbol{e}_3 = \\left(\\frac{\\sqrt{2}+1}{\\sqrt{6}}, \\frac{\\sqrt{2}+1}{\\sqrt{6}}, \\frac{\\sqrt{2}-2}{\\sqrt{6}}\\right)\n$$\n然后，$\\boldsymbol{n}_a$ 是：\n$$\n\\boldsymbol{n}_a = \\frac{1}{\\sqrt{2}} \\left(\\frac{\\sqrt{2}+1}{\\sqrt{6}}, \\frac{\\sqrt{2}+1}{\\sqrt{6}}, \\frac{\\sqrt{2}-2}{\\sqrt{6}}\\right) = \\frac{1}{\\sqrt{12}} (\\sqrt{2}+1, \\sqrt{2}+1, \\sqrt{2}-2) = \\frac{1}{2\\sqrt{3}} (\\sqrt{2}+1, \\sqrt{2}+1, \\sqrt{2}-2)\n$$\n$\\boldsymbol{n}_a$ 的分量是 $\\frac{\\sqrt{2}+1}{2\\sqrt{3}}$、$\\frac{\\sqrt{2}+1}{2\\sqrt{3}}$ 和 $\\frac{\\sqrt{2}-2}{2\\sqrt{3}}$。因为 $\\sqrt{2} \\approx 1.414$，所以第三个分量是负的。这不是所要求的向量。向量 $-\\boldsymbol{n}_a$ 也将有负分量。\n\n接下来，对于 $\\boldsymbol{n}_b$：\n$$\n\\boldsymbol{e}_1 - \\boldsymbol{e}_3 = \\frac{1}{\\sqrt{3}}(1, 1, 1) - \\frac{1}{\\sqrt{6}}(1, 1, -2) = \\left(\\frac{1}{\\sqrt{3}} - \\frac{1}{\\sqrt{6}}, \\frac{1}{\\sqrt{3}} - \\frac{1}{\\sqrt{6}}, \\frac{1}{\\sqrt{3}} + \\frac{2}{\\sqrt{6}}\\right)\n$$\n再次使用 $\\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{2}}{\\sqrt{6}}$：\n$$\n\\boldsymbol{e}_1 - \\boldsymbol{e}_3 = \\left(\\frac{\\sqrt{2}-1}{\\sqrt{6}}, \\frac{\\sqrt{2}-1}{\\sqrt{6}}, \\frac{\\sqrt{2}+2}{\\sqrt{6}}\\right)\n$$\n然后，$\\boldsymbol{n}_b$ 是：\n$$\n\\boldsymbol{n}_b = \\frac{1}{\\sqrt{2}} \\left(\\frac{\\sqrt{2}-1}{\\sqrt{6}}, \\frac{\\sqrt{2}-1}{\\sqrt{6}}, \\frac{\\sqrt{2}+2}{\\sqrt{6}}\\right) = \\frac{1}{\\sqrt{12}} (\\sqrt{2}-1, \\sqrt{2}-1, \\sqrt{2}+2) = \\frac{1}{2\\sqrt{3}} (\\sqrt{2}-1, \\sqrt{2}-1, \\sqrt{2}+2)\n$$\n$\\boldsymbol{n}_b$ 的分量是 $n_x = \\frac{\\sqrt{2}-1}{2\\sqrt{3}}$、$n_y = \\frac{\\sqrt{2}-1}{2\\sqrt{3}}$ 和 $n_z = \\frac{\\sqrt{2}+2}{2\\sqrt{3}}$。因为 $\\sqrt{2} > 1$，所有三个分量都是正的，因此是非负的。这就是我们寻找的向量。向量 $-\\boldsymbol{n}_b$ 的所有分量将都是负的。\n\n最大剪应力是 $1.2 \\times 10^3$ Pa。所有分量均为非负的特定单位法向量是 $\\boldsymbol{n} = \\left(\\frac{\\sqrt{2}-1}{2\\sqrt{3}}, \\frac{\\sqrt{2}-1}{2\\sqrt{3}}, \\frac{\\sqrt{2}+2}{2\\sqrt{3}}\\right)$。\n我们按要求报告这些精确值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.2 \\times 10^{3} & \\frac{\\sqrt{2}-1}{2\\sqrt{3}} & \\frac{\\sqrt{2}-1}{2\\sqrt{3}} & \\frac{\\sqrt{2}+2}{2\\sqrt{3}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在计算复杂流体等领域，我们经常通过模拟微观尺度现象（如作用在颗粒上的力）来预测宏观尺度性质（如流体的有效粘度）。这个高级的、基于代码的练习将指导您实现边界积分方法，用以计算悬浮颗粒上的表面牵引力，并利用它来计算悬浮液的宏观应力，这是计算流变学中的一项核心任务。",
            "id": "4106144",
            "problem": "您的任务是为蠕动流（斯托克斯流）实现边界积分计算，以评估嵌入在无界流体中的封闭可变形胶囊表面的牵引力矢量 $\\,\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,$，并计算简单悬浮液的体积平均柯西应力。背景设定为一个三维不可压缩牛顿流体，其动力粘度为 $\\,\\mu\\,$，由稳态斯托克斯方程控制。背景流为简单剪切流 $\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{x}) = \\dot{\\gamma}\\,y\\,\\boldsymbol{e}_x\\,$，剪切率为 $\\,\\dot{\\gamma}\\,$。胶囊表面在几何上是给定的（例如，球面或椭球体），但您需将其视为在实验室坐标系中静止（无滑移表面速度等于零）。胶囊仅通过其给定几何形状变形；不模拟其随时间的弹性演化。\n\n从以下基础出发：\n- 不可压缩牛顿流体的线性动量守恒（斯托克斯方程）：$\\,\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}\\,$ 和 $\\,\\nabla \\cdot \\boldsymbol{u} = 0\\,$，其中柯西应力张量为 $\\,\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\,\\mu\\,\\boldsymbol{E}\\,$，且 $\\,\\boldsymbol{E} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)\\,$。\n- 斯托克斯流的边界积分表示，使用正则化格林函数（正则化斯托克斯子），通过单层势将表面力密度映射到速度场。\n- 悬浮液的宏观（体积）应力，通过在有限体积上对柯西应力进行平均得到，可以表示为背景应变率和来自表面牵引力的应力子贡献之和。\n\n您的任务是：\n1. 为未知表面力密度 $\\,\\boldsymbol{g}(\\boldsymbol{y})\\,$ 在胶囊表面 $\\,S\\,$ 上建立并离散化一个配置边界积分方程，使得在背景剪切流 $\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{y})\\,$ 存在的情况下，无滑移边界条件 $\\,\\boldsymbol{u}(\\boldsymbol{y}) = \\boldsymbol{0}\\,$ 在 $\\,S\\,$ 上成立。使用一个正则化长度为 $\\,\\varepsilon > 0\\,$ 的三维正则化斯托克斯子核。不要假设任何临时捷径；从斯托克斯方程和牛顿应力定义中推导该表示。\n2. 通过表面上的数值积分求解得到的线性系统以获得 $\\,\\boldsymbol{g}\\,$。将胶囊几何形状视为由主半轴 $\\,a\\,$、$\\,b\\,$、$\\,c\\,$ 指定的球面或椭球体。使用极角参数化对表面进行离散化，计算局部表面片元面积，并组装稠密单层算子。\n3. 将胶囊上的流体牵引力确定为 $\\,\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,$，并使用边界积分公式中的作用-反作用原理将其与已解出的表面力密度 $\\,\\boldsymbol{g}\\,$ 联系起来。\n4. 计算边长为 $\\,L\\,$、体积为 $\\,V = L^3\\,$ 的立方体域中悬浮液的体积平均应力，使用分解为背景偏应力 $\\,2\\,\\mu\\,\\boldsymbol{E}^{\\infty}\\,$ 和由表面牵引力的一阶对称矩构成的应力子贡献。将空间原点设置在胶囊中心，并在应力子项中使用表面上的位置矢量 $\\,\\boldsymbol{r}(\\boldsymbol{y})\\,$。\n\n实现要求：\n- 在胶囊表面上使用配置法，包含 $\\,n_{\\theta}\\,$ 个纬向面元和 $\\,n_{\\phi}\\,$ 个经向面元。设表面参数化为 $\\,\\boldsymbol{r}(\\theta,\\phi)\\,$，其中 $\\,\\theta \\in [0,\\pi]\\,$ 和 $\\,\\phi \\in [0,2\\pi)\\,$。使用片元中心角，并根据雅可比行列式 $\\,\\left\\lVert \\partial_{\\theta}\\boldsymbol{r} \\times \\partial_{\\phi}\\boldsymbol{r} \\right\\rVert\\,\\Delta\\theta\\,\\Delta\\phi\\,$ 计算局部表面积权重。\n- 使用三维速度的正则化单层核，其正则化长度为 $\\,\\varepsilon\\,$，动力粘度为 $\\,\\mu\\,$。组装将离散化的 $\\,\\boldsymbol{g}\\,$ 映射到边界速度的稠密矩阵；在存在 $\\,\\boldsymbol{u}^{\\infty}\\,$ 的情况下，施加 $\\,\\boldsymbol{u} = \\boldsymbol{0}\\,$ 来求解 $\\,\\boldsymbol{g}\\,$。\n- 将表面上的流体牵引力确定为 $\\,\\boldsymbol{t} = -\\boldsymbol{g}\\,$。\n- 计算 $\\,\\boldsymbol{\\Sigma}^{\\text{bulk}} = 2\\,\\mu\\,\\boldsymbol{E}^{\\infty} + \\dfrac{1}{V}\\,\\int_{S} \\operatorname{sym}\\!\\left(\\,\\boldsymbol{r} \\otimes \\boldsymbol{t}\\,\\right)\\,\\mathrm{d}S\\,$，其中 $\\,\\operatorname{sym}(\\boldsymbol{A}) = \\tfrac{1}{2}(\\boldsymbol{A} + \\boldsymbol{A}^{\\top})\\,$。使用您的表面权重通过数值积分来近似该积分。\n\n单位与输出：\n- 所有量必须以国际单位制（SI）处理。动力粘度 $\\,\\mu\\,$ 的单位是 $\\mathrm{Pa}\\cdot\\mathrm{s}$，长度 $\\,a, b, c, L, \\varepsilon\\,$ 的单位是 $\\mathrm{m}$，剪切率 $\\,\\dot{\\gamma}\\,$ 的单位是 $\\mathrm{s}^{-1}$，应力的单位是 $\\mathrm{Pa}$。\n- 对每个测试用例，计算：\n  - 表面上牵引力大小的面积加权平均值 $\\,\\overline{\\lVert \\boldsymbol{t} \\rVert}\\,$，以 $\\mathrm{Pa}$ 为单位，并四舍五入到六位小数。\n  - 体积剪切应力分量 $\\,\\Sigma^{\\text{bulk}}_{xy}\\,$，以 $\\mathrm{Pa}$ 为单位，并四舍五入到六位小数。\n  - 一个布尔值，指示胶囊上的净水动力是否在数值上可忽略，定义为 $\\,\\lVert \\sum_j \\boldsymbol{t}_j w_j \\rVert < 10^{-6}\\,$（单位为 $\\mathrm{N}$）。\n- 您的程序应生成一行输出，包含一个由方括号括起来的逗号分隔列表，其中每个测试用例对应一个形式为 $[\\overline{\\lVert \\boldsymbol{t} \\rVert}, \\Sigma^{\\text{bulk}}_{xy}, \\text{force\\_free}]$ 的子列表。\n\n测试套件：\n使用以下参数集来测试不同的机制和几何形状。对于每种情况，将胶囊中心设置在原点。\n- 情况 1（正常情况）：$\\,\\mu = 1.0\\,$, $\\,\\dot{\\gamma} = 1.0\\,$, $\\,L = 4.0\\,$, 球体，$\\,a=b=c=0.5\\,$, $\\,\\varepsilon = 0.05\\,$, $\\,n_{\\theta} = 6\\,$, $\\,n_{\\phi} = 8\\,$。\n- 情况 2（扁球体和较小粘度）：$\\,\\mu = 0.7\\,$, $\\,\\dot{\\gamma} = 0.5\\,$, $\\,L = 3.0\\,$, 椭球体，$\\,a=0.6\\,$, $\\,b=0.4\\,$, $\\,c=0.6\\,$, $\\,\\varepsilon = 0.04\\,$, $\\,n_{\\theta} = 5\\,$, $\\,n_{\\phi} = 10\\,$。\n- 情况 3（长球体和较高剪切）：$\\,\\mu = 1.2\\,$, $\\,\\dot{\\gamma} = 2.0\\,$, $\\,L = 5.0\\,$, 椭球体，$\\,a=0.5\\,$, $\\,b=0.5\\,$, $\\,c=0.8\\,$, $\\,\\varepsilon = 0.06\\,$, $\\,n_{\\theta} = 7\\,$, $\\,n_{\\phi} = 9\\,$。\n\n最终输出格式：\n您的程序应生成一行输出，包含三个测试用例的三个子列表，格式完全如下：\n$[\\,[\\overline{\\lVert \\boldsymbol{t} \\rVert}_1, \\Sigma^{\\text{bulk}}_{xy,1}, \\text{force\\_free}_1],\\,[\\overline{\\lVert \\boldsymbol{t} \\rVert}_2, \\Sigma^{\\text{bulk}}_{xy,2}, \\text{force\\_free}_2],\\,[\\overline{\\lVert \\boldsymbol{t} \\rVert}_3, \\Sigma^{\\text{bulk}}_{xy,3}, \\text{force\\_free}_3]\\,]$ 其中每个数值条目都四舍五入到六位小数，应力量以 $\\mathrm{Pa}$ 表示，每个布尔值为 $\\,\\text{True}\\,$ 或 $\\,\\text{False}\\,$。",
            "solution": "我们从蠕动流区中不可压缩牛顿流体的控制原理开始。线性动量守恒简化为稳态斯托克斯方程 $\\,\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}\\,$ 和 $\\,\\nabla \\cdot \\boldsymbol{u} = 0\\,$，其中柯西应力张量为 $\\,\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\,\\mu\\,\\boldsymbol{E}\\,$，应变率张量为 $\\,\\boldsymbol{E} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)\\,$。线性和不可压缩性允许使用格林函数；斯托克斯子是与点力相关的基本解。为了数值稳定性，我们采用一个由长度 $\\,\\varepsilon\\,$ 表征的、范围有限的正则化斯托克斯子核。\n\n边界积分表示。对于一个光滑的封闭表面 $\\,S\\,$（其单位法向量为 $\\,\\boldsymbol{n}\\,$，包围着胶囊），我们将速度场表示为未知表面力密度 $\\,\\boldsymbol{g}(\\boldsymbol{y})\\,$ 的单层势：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) \\;=\\; \\boldsymbol{u}^{\\infty}(\\boldsymbol{x}) \\;+\\; \\int_{S} \\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{x},\\boldsymbol{y})\\,\\boldsymbol{g}(\\boldsymbol{y})\\,\\mathrm{d}S(\\boldsymbol{y}),\n$$\n其中 $\\,\\boldsymbol{G}_{\\varepsilon}\\,$ 是三维正则化斯托克斯子张量。核函数 $\\,\\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{x},\\boldsymbol{y})\\,$ 仅取决于位移 $\\,\\boldsymbol{r} = \\boldsymbol{x} - \\boldsymbol{y}\\,$ 和正则化参数 $\\,\\varepsilon\\,$。一种通过平滑奇异斯托克斯子（Cortez 正则化）推导出的常用形式是\n$$\n\\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{r}) \\;=\\; \\frac{1}{8\\pi\\mu}\\left(\\frac{r^2 + 2\\,\\varepsilon^2}{\\left(r^2 + \\varepsilon^2\\right)^{3/2}}\\,\\boldsymbol{I} \\;+\\; \\frac{\\boldsymbol{r}\\otimes\\boldsymbol{r}}{\\left(r^2 + \\varepsilon^2\\right)^{3/2}}\\right),\n$$\n其中 $\\,r^2 = \\boldsymbol{r}\\cdot\\boldsymbol{r}\\,$。在表面上，我们施加无滑移边界条件 $\\,\\boldsymbol{u}(\\boldsymbol{y}) = \\boldsymbol{0}\\,$。在 $\\,S\\,$ 上配置此边界条件，得到一个关于 $\\,\\boldsymbol{g}\\,$ 的第一类边界积分方程：\n$$\n\\boldsymbol{0} \\;=\\; \\boldsymbol{u}^{\\infty}(\\boldsymbol{y}) \\;+\\; \\int_{S} \\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{y} - \\boldsymbol{y}')\\,\\boldsymbol{g}(\\boldsymbol{y}')\\,\\mathrm{d}S(\\boldsymbol{y}').\n$$\n\n$\\boldsymbol{g}$ 的物理意义及牵引力。量 $\\,\\boldsymbol{g}\\,$ 是胶囊表面施加于周围流体的力密度。根据牛顿第三定律（作用-反作用）在流固界面处，定义为 $\\,\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,$ 的流体对表面的牵引力等于 $\\,\\boldsymbol{t} = -\\boldsymbol{g}\\,$。因此，求解积分方程得到 $\\,\\boldsymbol{g}\\,$ 即可立即获得所需的牵引力矢量 $\\,\\boldsymbol{t}\\,$。\n\n离散化。使用球面角 $\\,\\theta \\in [0,\\pi]\\,$ 和 $\\,\\phi \\in [0,2\\pi)\\,$ 将主半轴为 $\\,a\\,$、$\\,b\\,$、$\\,c\\,$ 的椭球体表面参数化：\n$$\n\\boldsymbol{r}(\\theta,\\phi) \\;=\\; \\big(a \\sin\\theta\\cos\\phi,\\; b \\sin\\theta\\sin\\phi,\\; c \\cos\\theta\\big).\n$$\n面元从雅可比行列式的大小 $\\,\\left\\lVert\\partial_{\\theta}\\boldsymbol{r} \\times \\partial_{\\phi}\\boldsymbol{r}\\right\\rVert\\,$ 计算得出：\n$$\n\\partial_{\\theta}\\boldsymbol{r} \\;=\\; \\big(a\\cos\\theta\\cos\\phi,\\; b\\cos\\theta\\sin\\phi,\\; -c\\sin\\theta\\big),\\quad\n\\partial_{\\phi}\\boldsymbol{r} \\;=\\; \\big(-a\\sin\\theta\\sin\\phi,\\; b\\sin\\theta\\cos\\phi,\\; 0\\big),\n$$\n对于一个以 $\\,(\\theta_i,\\phi_j)\\,$ 为中心、角范围为 $\\,\\Delta\\theta\\,$ 和 $\\,\\Delta\\phi\\,$ 的片元，其面积权重为\n$$\nw_{ij} \\;=\\; \\left\\lVert\\partial_{\\theta}\\boldsymbol{r}(\\theta_i,\\phi_j) \\times \\partial_{\\phi}\\boldsymbol{r}(\\theta_i,\\phi_j)\\right\\rVert\\,\\Delta\\theta\\,\\Delta\\phi.\n$$\n我们选择 $\\,\\theta_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta\\theta\\,$（对于 $\\,i=0,\\ldots,n_{\\theta}-1\\,$）和 $\\,\\phi_j = \\left(j+\\tfrac{1}{2}\\right)\\Delta\\phi\\,$（对于 $\\,j=0,\\ldots,n_{\\phi}-1\\,$），其中 $\\,\\Delta\\theta = \\pi/n_{\\theta}\\,$ 和 $\\,\\Delta\\phi = 2\\pi/n_{\\phi}\\,$。这将产生 $\\,N = n_{\\theta} n_{\\phi}\\,$ 个配置点 $\\,\\boldsymbol{y}_m\\,$ 和权重 $\\,w_m\\,$。\n\n矩阵组装。对于每个配置点 $\\,\\boldsymbol{y}_k\\,$，边界速度为\n$$\n\\boldsymbol{u}(\\boldsymbol{y}_k) \\;=\\; \\boldsymbol{u}^{\\infty}(\\boldsymbol{y}_k) \\;+\\; \\sum_{m=1}^{N} \\boldsymbol{G}_{\\varepsilon}\\!\\left(\\boldsymbol{y}_k - \\boldsymbol{y}_m\\right)\\,\\boldsymbol{g}_m\\,w_m.\n$$\n强制施加 $\\,\\boldsymbol{u}(\\boldsymbol{y}_k)=\\boldsymbol{0}\\,$ 产生一个稠密线性系统\n$$\n\\sum_{m=1}^{N} \\boldsymbol{G}_{\\varepsilon}\\!\\left(\\boldsymbol{y}_k - \\boldsymbol{y}_m\\right)\\,\\boldsymbol{g}_m\\,w_m \\;=\\; -\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{y}_k),\\quad k=1,\\ldots,N,\n$$\n我们将其写为 $\\,\\boldsymbol{A}\\,\\boldsymbol{g} = \\boldsymbol{b}\\,$，其中 $\\,\\boldsymbol{A}\\,$ 是一个 $\\,3N \\times 3N\\,$ 的分块矩阵，其 $\\,3\\times 3\\,$ 的块为 $\\,\\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{y}_k - \\boldsymbol{y}_m)\\,w_m\\,$，未知数 $\\,\\boldsymbol{g}\\,$ 是一个由 $\\,\\boldsymbol{g}_m\\,$ 堆叠而成的 $\\,3N\\,$ 维向量，而 $\\,\\boldsymbol{b}\\,$ 是施加的背景速度 $\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{y}_k)\\,$ 的负值。正则化长度 $\\,\\varepsilon\\,$ 确保了自作用项（$\\,k=m\\,$）有界，并改善了条件数。\n\n牵引力和体积平均应力。一旦求得 $\\,\\boldsymbol{g}\\,$，每个配置点上的流体牵引力为 $\\,\\boldsymbol{t}_m = -\\boldsymbol{g}_m\\,$。牵引力大小的面积加权平均值计算如下\n$$\n\\overline{\\lVert \\boldsymbol{t} \\rVert} \\;=\\; \\frac{\\sum_{m=1}^{N} \\lVert \\boldsymbol{t}_m\\rVert\\,w_m}{\\sum_{m=1}^{N} w_m},\n$$\n单位为 $\\mathrm{Pa}$。净水动力为\n$$\n\\boldsymbol{F} \\;=\\; \\sum_{m=1}^{N} \\boldsymbol{t}_m\\,w_m,\n$$\n对于线性流中的静止物体，该力应为零（无力条件）；在数值上我们检查 $\\,\\lVert \\boldsymbol{F}\\rVert < 10^{-6}\\,$（单位为 $\\mathrm{N}$）。在一个边长为 $\\,L\\,$、体积为 $\\,V=L^3\\,$ 的立方体域中，体积平均应力为\n$$\n\\boldsymbol{\\Sigma}^{\\text{bulk}} \\;=\\; 2\\,\\mu\\,\\boldsymbol{E}^{\\infty} \\;+\\; \\frac{1}{V}\\sum_{m=1}^{N} \\operatorname{sym}\\!\\left(\\boldsymbol{r}_m \\otimes \\boldsymbol{t}_m\\right)\\,w_m,\n$$\n其中 $\\,\\boldsymbol{E}^{\\infty}\\,$ 是施加剪切流的应变率。对于 $\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{x}) = \\dot{\\gamma}\\,y\\,\\boldsymbol{e}_x\\,$，我们有 $\\,\\nabla \\boldsymbol{u}^{\\infty}\\,$ 只有一个非零分量 $\\,\\partial u_x/\\partial y = \\dot{\\gamma}\\,$。因此，$\\,\\boldsymbol{E}^{\\infty}\\,$ 有 $\\,E^{\\infty}_{xy} = E^{\\infty}_{yx} = \\dot{\\gamma}/2\\,$ 且其他分量为零，从而得到 $\\,\\left(2\\,\\mu\\,\\boldsymbol{E}^{\\infty}\\right)_{xy} = \\mu\\,\\dot{\\gamma}\\,$，$\\,yx\\,$ 分量也类似。\n\n算法步骤：\n1. 对于每个测试用例，使用角度网格在指定的胶囊几何上构建配置点 $\\,\\boldsymbol{y}_m\\,$ 和权重 $\\,w_m\\,$。\n2. 组装稠密矩阵 $\\,\\boldsymbol{A}\\,$（其元素为 $\\,\\boldsymbol{G}_{\\varepsilon}(\\boldsymbol{y}_k - \\boldsymbol{y}_m)\\,w_m\\,$）和右侧项 $\\,\\boldsymbol{b} = -\\boldsymbol{u}^{\\infty}(\\boldsymbol{y}_k)\\,$，其中 $\\,\\boldsymbol{u}^{\\infty}(\\boldsymbol{y}) = (\\dot{\\gamma}\\,y,\\,0,\\,0)\\,$。\n3. 使用直接求解器求解 $\\,\\boldsymbol{A}\\,\\boldsymbol{g} = \\boldsymbol{b}\\,$。设 $\\,\\boldsymbol{t}_m = -\\boldsymbol{g}_m\\,$。\n4. 通过数值积分计算 $\\,\\overline{\\lVert \\boldsymbol{t} \\rVert}\\,$、$\\,\\boldsymbol{F}\\,$ 和 $\\,\\boldsymbol{\\Sigma}^{\\text{bulk}}\\,$。提取 $\\,\\Sigma^{\\text{bulk}}_{xy}\\,$。\n5. 报告以 $\\mathrm{Pa}$ 为单位、四舍五入到六位小数的 $\\,\\overline{\\lVert \\boldsymbol{t} \\rVert}\\,$，以 $\\mathrm{Pa}$ 为单位、四舍五入到六位小数的 $\\,\\Sigma^{\\text{bulk}}_{xy}\\,$，以及布尔值 $\\,\\lVert \\boldsymbol{F}\\rVert < 10^{-6}\\,$。\n\n数值考量。正则化长度 $\\,\\varepsilon\\,$ 的选择必须与局部面元尺寸相称，以避免病态同时保持精度。矩阵是稠密的，维度为 $\\,3N \\times 3N\\,$；测试套件中使用的 $\\,N\\,$ 值适中（几十的量级），以确保计算是可处理的。离散化使用了从参数化雅可比行列式计算的真实几何表面权重，以避免非均匀角度采样带来的偏差。\n\n该方法通过求解边界积分公式中的作用-反作用表面力密度来评估表面牵引力 $\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,$，并通过结合背景偏应力和表面牵引力的应力子贡献来计算体积平均应力，从而将微观结构流体动力学与宏观流变学直接联系起来。",
            "answer": "```python\nimport numpy as np\n\n# Regularized Stokeslet kernel in 3D (Cortez), returns 3x3 tensor G for vector r with regularization epsilon and viscosity mu.\ndef reg_stokeslet_G(r, mu, eps):\n    r2 = np.dot(r, r)\n    denom = (r2 + eps**2)**1.5\n    coeff_I = (r2 + 2.0*eps**2) / denom\n    outer = np.outer(r, r) / denom\n    G = (coeff_I * np.eye(3) + outer) / (8.0 * np.pi * mu)\n    return G\n\n# Parameterization of an ellipsoid surface and area weights using angle patches.\ndef ellipsoid_surface(a, b, c, n_theta, n_phi):\n    dtheta = np.pi / n_theta\n    dphi = 2.0 * np.pi / n_phi\n    points = []\n    weights = []\n    # Loop over patch centers\n    for i in range(n_theta):\n        theta = (i + 0.5) * dtheta\n        cos_t = np.cos(theta)\n        sin_t = np.sin(theta)\n        # Derivatives w.r.t theta at center depend only on theta and phi; phi derivative depends on phi\n        for j in range(n_phi):\n            phi = (j + 0.5) * dphi\n            cos_p = np.cos(phi)\n            sin_p = np.sin(phi)\n            # Position on ellipsoid\n            x = a * sin_t * cos_p\n            y = b * sin_t * sin_p\n            z = c * cos_t\n            # Derivatives for area weight\n            dr_dtheta = np.array([a * cos_t * cos_p, b * cos_t * sin_p, -c * sin_t])\n            dr_dphi = np.array([-a * sin_t * sin_p, b * sin_t * cos_p, 0.0])\n            area_density = np.linalg.norm(np.cross(dr_dtheta, dr_dphi))\n            w = area_density * dtheta * dphi\n            points.append(np.array([x, y, z]))\n            weights.append(w)\n    return np.array(points), np.array(weights)\n\n# Assemble dense single-layer matrix for collocation on the surface.\ndef assemble_matrix(points, weights, mu, eps):\n    N = points.shape[0]\n    A = np.zeros((3*N, 3*N))\n    for k in range(N):\n        x = points[k]\n        for m in range(N):\n            y = points[m]\n            r = x - y\n            G = reg_stokeslet_G(r, mu, eps)\n            block = G * weights[m]\n            A[3*k:3*k+3, 3*m:3*m+3] = block\n    return A\n\n# Background shear flow u_inf = gamma_dot * y * e_x.\ndef background_velocity(points, gamma_dot):\n    u = np.zeros((points.shape[0], 3))\n    u[:, 0] = gamma_dot * points[:, 1]\n    return u\n\n# Compute bulk stress from traction via stresslet formula in a cubic domain.\ndef bulk_stress(points, weights, traction, mu, gamma_dot, L):\n    V = L**3\n    # Background deviatoric stress: 2 mu E_inf with E_xy = E_yx = gamma_dot / 2\n    Sigma_bg = np.zeros((3, 3))\n    Sigma_bg[0, 1] = mu * gamma_dot\n    Sigma_bg[1, 0] = mu * gamma_dot\n    # Stresslet contribution\n    S = np.zeros((3, 3))\n    for m in range(points.shape[0]):\n        r = points[m]\n        t = traction[m]\n        rt = np.outer(r, t)\n        S += 0.5 * (rt + rt.T) * weights[m]\n    Sigma_bulk = Sigma_bg + S / V\n    return Sigma_bulk\n\ndef solve_case(mu, gamma_dot, L, axes, eps, n_theta, n_phi):\n    a, b, c = axes\n    # Discretize surface\n    points, weights = ellipsoid_surface(a, b, c, n_theta, n_phi)\n    N = points.shape[0]\n    # Assemble matrix and RHS\n    A = assemble_matrix(points, weights, mu, eps)\n    u_inf = background_velocity(points, gamma_dot)\n    bvec = -u_inf.reshape(3*N)\n    # Solve for surface force density g\n    g = np.linalg.solve(A, bvec).reshape((N, 3))\n    # Traction t = -g\n    traction = -g\n    # Area-weighted average traction magnitude\n    area_total = np.sum(weights)\n    avg_t_mag = np.sum(np.linalg.norm(traction, axis=1) * weights) / area_total\n    # Net hydrodynamic force\n    net_force = np.sum(traction * weights[:, None], axis=0)\n    force_free = np.linalg.norm(net_force)  1e-6\n    # Bulk stress and shear component\n    Sigma_bulk = bulk_stress(points, weights, traction, mu, gamma_dot, L)\n    Sigma_xy = Sigma_bulk[0, 1]\n    return avg_t_mag, Sigma_xy, force_free\n\ndef solve():\n    test_cases = [\n        # (mu, gamma_dot, L, axes(a,b,c), eps, n_theta, n_phi)\n        (1.0, 1.0, 4.0, (0.5, 0.5, 0.5), 0.05, 6, 8),\n        (0.7, 0.5, 3.0, (0.6, 0.4, 0.6), 0.04, 5, 10),\n        (1.2, 2.0, 5.0, (0.5, 0.5, 0.8), 0.06, 7, 9),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, gamma_dot, L, axes, eps, n_theta, n_phi = case\n        avg_t_mag, Sigma_xy, force_free = solve_case(mu, gamma_dot, L, axes, eps, n_theta, n_phi)\n        # Round to six decimal places for numeric outputs\n        avg_t_mag_r = float(f\"{avg_t_mag:.6f}\")\n        Sigma_xy_r = float(f\"{Sigma_xy:.6f}\")\n        results.append([avg_t_mag_r, Sigma_xy_r, force_free])\n\n    # Final print statement in the exact required format.\n    # Ensure booleans and floats are printed in Python list syntax.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}