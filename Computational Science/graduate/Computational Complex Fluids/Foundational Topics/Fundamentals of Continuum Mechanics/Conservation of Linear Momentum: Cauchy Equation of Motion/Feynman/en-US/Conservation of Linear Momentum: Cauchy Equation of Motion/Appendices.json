{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex computational models, it is essential to build a solid intuition for the Cauchy equation of motion. This practice provides a foundational exercise in deconstructing the momentum equation, term by term, for a simple yet non-trivial flow field. By applying the equation to a steady simple shear flow, you will verify its internal consistency and gain a concrete understanding of how the inertia, pressure, and viscous stress terms balance in a Newtonian fluid .",
            "id": "4081964",
            "problem": "Consider a three-dimensional continuum fluid used as a baseline test in computational complex fluids modeling. Invoke conservation of linear momentum in local form, with the Cauchy stress for a Newtonian fluid of constant viscosity, and the definition of the material (substantial) derivative. Let the velocity field be the steady simple shear flow $\\mathbf{v}(\\mathbf{x})=(\\gamma y,0,0)$, where $\\gamma$ is a constant shear rate, the mass density $\\rho$ is constant, the viscosity $\\mu$ is constant, and the body force per unit mass is absent so that $\\mathbf{b}=\\mathbf{0}$. Assume the mechanical pressure $p$ is spatially uniform for this consistency check. Evaluate, component by component, each term in the local linear momentum balance, namely $\\rho \\dot{\\mathbf{v}}$, $\\nabla\\cdot\\boldsymbol{\\sigma}$, and $\\rho\\mathbf{b}$, and then form the residual vector $\\rho \\dot{\\mathbf{v}}-\\nabla\\cdot\\boldsymbol{\\sigma}-\\rho\\mathbf{b}$. Provide the final residual as a single row matrix. No rounding is needed. Do not include units in your final row matrix.",
            "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of continuum mechanics, well-posed, objective, and contains sufficient information for a unique solution. We proceed with the solution.\n\nThe problem requires the evaluation of the residual of the local linear momentum balance equation, which is Cauchy's first law of motion. The equation is given by:\n$$\n\\rho \\frac{D\\mathbf{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b}\n$$\nIn this problem, the material derivative $\\frac{D\\mathbf{v}}{Dt}$ is denoted as $\\dot{\\mathbf{v}}$. We are asked to compute the residual vector $\\mathbf{R}$, defined as:\n$$\n\\mathbf{R} = \\rho \\dot{\\mathbf{v}} - \\nabla \\cdot \\boldsymbol{\\sigma} - \\rho \\mathbf{b}\n$$\nWe will evaluate each term in the residual vector component by component. The given information includes:\n- Velocity field: $\\mathbf{v}(\\mathbf{x}) = (\\gamma y, 0, 0)$, where $\\gamma$ is a constant. In component form, $v_x = \\gamma y$, $v_y = 0$, and $v_z = 0$.\n- Mass density $\\rho$ is constant.\n- Dynamic viscosity $\\mu$ is constant.\n- Body force per unit mass $\\mathbf{b} = \\mathbf{0}$.\n- Mechanical pressure $p$ is spatially uniform (constant).\n\nFirst, we evaluate the body force term, $\\rho \\mathbf{b}$. Since $\\mathbf{b} = \\mathbf{0}$, this term is simply:\n$$\n\\rho \\mathbf{b} = \\rho (0, 0, 0) = (0, 0, 0) = \\mathbf{0}\n$$\n\nNext, we evaluate the inertia term, $\\rho \\dot{\\mathbf{v}}$. The material derivative $\\dot{\\mathbf{v}}$ is defined as:\n$$\n\\dot{\\mathbf{v}} = \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v}\n$$\nThe problem specifies a steady flow, which means the velocity field does not change with time, so $\\frac{\\partial \\mathbf{v}}{\\partial t} = \\mathbf{0}$.\nThe convective acceleration term, $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$, is computed as:\n$$\n(\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = \\left( v_x \\frac{\\partial}{\\partial x} + v_y \\frac{\\partial}{\\partial y} + v_z \\frac{\\partial}{\\partial z} \\right) \\mathbf{v} = \\left( (\\gamma y) \\frac{\\partial}{\\partial x} + (0) \\frac{\\partial}{\\partial y} + (0) \\frac{\\partial}{\\partial z} \\right) \\mathbf{v} = (\\gamma y) \\frac{\\partial \\mathbf{v}}{\\partial x}\n$$\nThe partial derivative of the velocity vector with respect to $x$ is:\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial x} = \\left( \\frac{\\partial(\\gamma y)}{\\partial x}, \\frac{\\partial(0)}{\\partial x}, \\frac{\\partial(0)}{\\partial x} \\right) = (0, 0, 0)\n$$\nTherefore, the convective acceleration is:\n$$\n(\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = (\\gamma y) (0, 0, 0) = (0, 0, 0) = \\mathbf{0}\n$$\nCombining the terms, the material derivative is $\\dot{\\mathbf{v}} = \\mathbf{0} + \\mathbf{0} = \\mathbf{0}$. Consequently, the inertia term is:\n$$\n\\rho \\dot{\\mathbf{v}} = \\rho \\mathbf{0} = \\mathbf{0}\n$$\n\nFinally, we evaluate the divergence of the Cauchy stress tensor, $\\nabla \\cdot \\boldsymbol{\\sigma}$. For a Newtonian fluid, the Cauchy stress tensor $\\boldsymbol{\\sigma}$ is given by:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}\n$$\nwhere $p$ is the pressure, $\\mathbf{I}$ is the identity tensor, and $\\boldsymbol{\\tau}$ is the viscous stress tensor. For an incompressible flow, the viscous stress is:\n$$\n\\boldsymbol{\\tau} = \\mu (\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^T)\n$$\nWe first verify that the flow is incompressible by computing the divergence of the velocity field:\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(\\gamma y)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0\n$$\nSince $\\nabla \\cdot \\mathbf{v} = 0$, the flow is indeed incompressible. We now compute the velocity gradient tensor $\\nabla \\mathbf{v}$:\n$$\n\\nabla \\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x} & \\frac{\\partial v_x}{\\partial y} & \\frac{\\partial v_x}{\\partial z} \\\\\n\\frac{\\partial v_y}{\\partial x} & \\frac{\\partial v_y}{\\partial y} & \\frac{\\partial v_y}{\\partial z} \\\\\n\\frac{\\partial v_z}{\\partial x} & \\frac{\\partial v_z}{\\partial y} & \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nIts transpose is:\n$$\n(\\nabla \\mathbf{v})^T =\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThe viscous stress tensor $\\boldsymbol{\\tau}$ is then:\n$$\n\\boldsymbol{\\tau} = \\mu \\left(\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} \\right) = \\mu\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThe full Cauchy stress tensor $\\boldsymbol{\\sigma}$ is:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau} =\n\\begin{pmatrix}\n-p & 0 & 0 \\\\\n0 & -p & 0 \\\\\n0 & 0 & -p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-p & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & -p & 0 \\\\\n0 & 0 & -p\n\\end{pmatrix}\n$$\nNow we compute the divergence of $\\boldsymbol{\\sigma}$. The $i$-th component is $(\\nabla \\cdot \\boldsymbol{\\sigma})_i = \\sum_j \\frac{\\partial \\sigma_{ij}}{\\partial x_j}$.\nThe $x$-component is:\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} = \\frac{\\partial(-p)}{\\partial x} + \\frac{\\partial(\\mu\\gamma)}{\\partial y} + \\frac{\\partial(0)}{\\partial z}\n$$\nSince $p$, $\\mu$, and $\\gamma$ are all constants, their partial derivatives are zero. Thus:\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_x = 0 + 0 + 0 = 0\n$$\nThe $y$-component is:\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{yz}}{\\partial z} = \\frac{\\partial(\\mu\\gamma)}{\\partial x} + \\frac{\\partial(-p)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0\n$$\nThe $z$-component is:\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_z = \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zy}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = \\frac{\\partial(0)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(-p)}{\\partial z} = 0 + 0 + 0 = 0\n$$\nTherefore, the divergence of the stress tensor is $\\nabla \\cdot \\boldsymbol{\\sigma} = (0, 0, 0) = \\mathbf{0}$.\n\nFinally, we assemble the residual vector $\\mathbf{R}$:\n$$\n\\mathbf{R} = \\rho \\dot{\\mathbf{v}} - \\nabla \\cdot \\boldsymbol{\\sigma} - \\rho \\mathbf{b} = \\mathbf{0} - \\mathbf{0} - \\mathbf{0} = \\mathbf{0}\n$$\nThe residual vector is $(0, 0, 0)$. In the requested row matrix format, this is $\\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The local, differential form of the momentum equation, $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\rho \\mathbf{a}$, describes the balance of forces at every point within a fluid. However, we are often interested in the net effect of these internal stresses on a boundary, which manifests as a traction force. This exercise illustrates the powerful connection between the local balance and the global forces on a body through the divergence theorem, demonstrating that a body in static equilibrium experiences zero net force on its boundary .",
            "id": "4081916",
            "problem": "Consider a two-dimensional, incompressible viscoelastic fluid in steady state occupying the disk domain $\\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} \\leq R^{2}\\}$ with curved boundary $\\partial \\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} = R^{2}\\}$. Assume there are no body forces and no acceleration, so the balance of linear momentum reduces to the static form of Cauchyâ€™s equation of motion. The total Cauchy stress tensor $\\boldsymbol{\\sigma}(x,y)$ is specified by the symmetric field constructed from the scalar potential $\\chi(x,y) = \\alpha \\left(x^{2} - y^{2}\\right)$ with constant $\\alpha$ having units of Pascal per meter and $R > 0$ having units of meters:\n- $\\sigma_{xx} = \\partial_{y} \\chi$,\n- $\\sigma_{yy} = - \\partial_{y} \\chi$,\n- $\\sigma_{xy} = \\sigma_{yx} = - \\partial_{x} \\chi$.\n\nUsing only the fundamental balance of linear momentum, the definition of traction, and geometrically consistent parametrization of the boundary, perform the following:\n1. Starting from the local form of linear momentum conservation, state the corresponding global integral statement on $\\Omega$ that involves the boundary traction and explain the equilibrium implication under the stated assumptions.\n2. Compute the traction vector $\\mathbf{t}(\\theta)$ on $\\partial \\Omega$ defined by $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$, where the outward unit normal on $\\partial \\Omega$ is $\\mathbf{n}(\\theta) = (\\cos \\theta, \\sin \\theta)$ with the boundary parametrized by $(x(\\theta), y(\\theta)) = (R \\cos \\theta, R \\sin \\theta)$ for $\\theta \\in [0, 2\\pi)$.\n3. Verify equilibrium by computing the boundary integral $\\displaystyle \\int_{\\partial \\Omega} \\boldsymbol{\\sigma} \\mathbf{n} \\, ds$, where $ds = R \\, d\\theta$, and provide the resulting net integrated force vector.\n\nExpress the final integrated force per unit thickness in $\\mathrm{N/m}$, in exact form (no rounding).",
            "solution": "The problem is first validated for scientific soundness and self-consistency.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Domain: A two-dimensional disk $\\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} \\leq R^{2}\\}$ with radius $R > 0$.\n- Boundary: $\\partial \\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} = R^{2}\\}$.\n- Fluid: Incompressible viscoelastic fluid.\n- Conditions: Steady state, no body forces ($\\mathbf{f} = \\mathbf{0}$), no acceleration ($\\mathbf{a} = \\mathbf{0}$).\n- Governing Equation: Static form of Cauchy's equation of motion, which is the balance of linear momentum.\n- Scalar Potential: $\\chi(x,y) = \\alpha \\left(x^{2} - y^{2}\\right)$, where $\\alpha$ is a constant.\n- Cauchy Stress Tensor Components:\n  - $\\sigma_{xx} = \\partial_{y} \\chi$\n  - $\\sigma_{yy} = - \\partial_{y} \\chi$\n  - $\\sigma_{xy} = \\sigma_{yx} = - \\partial_{x} \\chi$\n- Boundary Parametrization: $(x(\\theta), y(\\theta)) = (R \\cos \\theta, R \\sin \\theta)$ for $\\theta \\in [0, 2\\pi)$.\n- Outward Unit Normal: $\\mathbf{n}(\\theta) = (\\cos \\theta, \\sin \\theta)$.\n- Line element: $ds = R \\, d\\theta$.\n- Task 1: State the global integral form of linear momentum balance and explain its implication.\n- Task 2: Compute the traction vector $\\mathbf{t}(\\theta) = \\boldsymbol{\\sigma} \\mathbf{n}$ on $\\partial \\Omega$.\n- Task 3: Verify equilibrium by computing the net force $\\int_{\\partial \\Omega} \\boldsymbol{\\sigma} \\mathbf{n} \\, ds$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed within the framework of continuum mechanics. A crucial consistency check is whether the given stress field satisfies the local momentum balance equation under the specified conditions. Cauchy's equation of motion is $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\rho \\mathbf{a}$. Given no body forces ($\\mathbf{f} = \\mathbf{0}$) and no acceleration ($\\mathbf{a} = \\mathbf{0}$), this reduces to the equilibrium condition $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$.\n\nFirst, we compute the partial derivatives of the potential $\\chi(x,y) = \\alpha(x^2 - y^2)$:\n$$ \\partial_{x} \\chi = 2 \\alpha x $$\n$$ \\partial_{y} \\chi = -2 \\alpha y $$\nNext, we determine the components of the stress tensor $\\boldsymbol{\\sigma}$:\n$$ \\sigma_{xx} = \\partial_{y} \\chi = -2 \\alpha y $$\n$$ \\sigma_{yy} = - \\partial_{y} \\chi = -(-2 \\alpha y) = 2 \\alpha y $$\n$$ \\sigma_{xy} = \\sigma_{yx} = - \\partial_{x} \\chi = -2 \\alpha x $$\nNow, we compute the divergence of the stress tensor, $\\nabla \\cdot \\boldsymbol{\\sigma}$. The components are:\n$$ (\\nabla \\cdot \\boldsymbol{\\sigma})_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} = \\frac{\\partial}{\\partial x}(-2 \\alpha y) + \\frac{\\partial}{\\partial y}(-2 \\alpha x) = 0 + 0 = 0 $$\n$$ (\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} = \\frac{\\partial}{\\partial x}(-2 \\alpha x) + \\frac{\\partial}{\\partial y}(2 \\alpha y) = -2 \\alpha + 2 \\alpha = 0 $$\nSince $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$, the provided stress field is self-consistent with the stated condition of static equilibrium in the absence of body forces. The problem is therefore scientifically grounded and valid.\n\n**Solution**\n\n**1. Global Integral Statement and Equilibrium Implication**\n\nThe local form of the conservation of linear momentum (Cauchy's first law of motion) is given by:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\rho \\frac{d\\mathbf{v}}{dt} = \\rho \\mathbf{a} $$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\mathbf{f}$ is the body force per unit volume, $\\rho$ is the density, and $\\mathbf{a}$ is the acceleration.\n\nThe problem states there are no body forces ($\\mathbf{f} = \\mathbf{0}$) and no acceleration ($\\mathbf{a} = \\mathbf{0}$). Thus, the local equation for static equilibrium is:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0} $$\nTo obtain the global statement, we integrate this equation over the entire domain $\\Omega$:\n$$ \\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\, dA = \\mathbf{0} $$\nBy applying the Divergence Theorem (also known as Gauss's theorem or Green's theorem in this 2D context) to the tensor field $\\boldsymbol{\\sigma}$, the area integral of the divergence can be converted into a line integral over the boundary $\\partial \\Omega$:\n$$ \\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\, dA = \\oint_{\\partial \\Omega} (\\boldsymbol{\\sigma} \\cdot \\mathbf{n}) \\, ds $$\nwhere $\\mathbf{n}$ is the outward unit normal vector on the boundary and $ds$ is the differential arc length. The term $\\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ is defined as the traction vector $\\mathbf{t}$, which represents the force per unit area exerted on the boundary.\n\nCombining these results, the global integral statement for static equilibrium is:\n$$ \\oint_{\\partial \\Omega} \\mathbf{t} \\, ds = \\mathbf{0} $$\nThe physical implication of this statement is that for a body to be in static equilibrium, the net force exerted on its boundary by the surroundings must be zero. The vector sum of all traction forces over the entire boundary must vanish.\n\n**2. Computation of the Traction Vector**\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ can be written in matrix form:\n$$ \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} \\\\ \\sigma_{yx} & \\sigma_{yy} \\end{pmatrix} = \\begin{pmatrix} -2 \\alpha y & -2 \\alpha x \\\\ -2 \\alpha x & 2 \\alpha y \\end{pmatrix} $$\nThe boundary $\\partial \\Omega$ is parametrized by $x = R \\cos \\theta$ and $y = R \\sin \\theta$. On the boundary, the stress tensor becomes:\n$$ \\left.\\boldsymbol{\\sigma}\\right|_{\\partial \\Omega} = \\begin{pmatrix} -2 \\alpha (R \\sin \\theta) & -2 \\alpha (R \\cos \\theta) \\\\ -2 \\alpha (R \\cos \\theta) & 2 \\alpha (R \\sin \\theta) \\end{pmatrix} = -2 \\alpha R \\begin{pmatrix} \\sin \\theta & \\cos \\theta \\\\ \\cos \\theta & -\\sin \\theta \\end{pmatrix} $$\nThe outward unit normal vector is $\\mathbf{n}(\\theta) = (\\cos \\theta, \\sin \\theta)^T$. The traction vector $\\mathbf{t}(\\theta)$ is the product of the stress tensor and the normal vector:\n$$ \\mathbf{t}(\\theta) = \\boldsymbol{\\sigma} \\mathbf{n} = -2 \\alpha R \\begin{pmatrix} \\sin \\theta & \\cos \\theta \\\\ \\cos \\theta & -\\sin \\theta \\end{pmatrix} \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix} $$\nPerforming the matrix-vector multiplication:\n$$ \\mathbf{t}(\\theta) = -2 \\alpha R \\begin{pmatrix} \\sin \\theta \\cos \\theta + \\cos \\theta \\sin \\theta \\\\ \\cos^{2} \\theta - \\sin^{2} \\theta \\end{pmatrix} $$\nUsing the trigonometric identities $\\sin(2\\theta) = 2 \\sin \\theta \\cos \\theta$ and $\\cos(2\\theta) = \\cos^{2} \\theta - \\sin^{2} \\theta$, we find the components of the traction vector:\n$$ t_x(\\theta) = -2 \\alpha R (\\sin(2\\theta)) $$\n$$ t_y(\\theta) = -2 \\alpha R (\\cos(2\\theta)) $$\nThus, the traction vector is:\n$$ \\mathbf{t}(\\theta) = -2 \\alpha R (\\sin(2\\theta) \\, \\mathbf{i} + \\cos(2\\theta) \\, \\mathbf{j}) $$\nwhere $\\mathbf{i}$ and $\\mathbf{j}$ are the standard basis vectors.\n\n**3. Verification of Equilibrium and Net Force Calculation**\n\nTo verify equilibrium, we compute the net integrated force on the boundary, $\\mathbf{F}_{\\text{net}}$, by integrating the traction vector $\\mathbf{t}(\\theta)$ along the boundary $\\partial \\Omega$. The differential arc length is given as $ds = R \\, d\\theta$.\n$$ \\mathbf{F}_{\\text{net}} = \\oint_{\\partial \\Omega} \\mathbf{t} \\, ds = \\int_{0}^{2\\pi} \\mathbf{t}(\\theta) \\, R \\, d\\theta $$\nSubstituting the expression for $\\mathbf{t}(\\theta)$:\n$$ \\mathbf{F}_{\\text{net}} = \\int_{0}^{2\\pi} [-2 \\alpha R (\\sin(2\\theta) \\, \\mathbf{i} + \\cos(2\\theta) \\, \\mathbf{j})] \\, R \\, d\\theta $$\n$$ \\mathbf{F}_{\\text{net}} = -2 \\alpha R^{2} \\int_{0}^{2\\pi} (\\sin(2\\theta) \\, \\mathbf{i} + \\cos(2\\theta) \\, \\mathbf{j}) \\, d\\theta $$\nWe evaluate the integral for each component separately.\nThe $x$-component is:\n$$ F_{\\text{net},x} = -2 \\alpha R^{2} \\int_{0}^{2\\pi} \\sin(2\\theta) \\, d\\theta = -2 \\alpha R^{2} \\left[ -\\frac{1}{2} \\cos(2\\theta) \\right]_{0}^{2\\pi} $$\n$$ F_{\\text{net},x} = -2 \\alpha R^{2} \\left( -\\frac{1}{2} \\cos(4\\pi) - \\left(-\\frac{1}{2}\\cos(0)\\right) \\right) = -2 \\alpha R^{2} \\left( -\\frac{1}{2}(1) + \\frac{1}{2}(1) \\right) = 0 $$\nThe $y$-component is:\n$$ F_{\\text{net},y} = -2 \\alpha R^{2} \\int_{0}^{2\\pi} \\cos(2\\theta) \\, d\\theta = -2 \\alpha R^{2} \\left[ \\frac{1}{2} \\sin(2\\theta) \\right]_{0}^{2\\pi} $$\n$$ F_{\\text{net},y} = -2 \\alpha R^{2} \\left( \\frac{1}{2} \\sin(4\\pi) - \\frac{1}{2} \\sin(0) \\right) = -2 \\alpha R^{2} \\left( \\frac{1}{2}(0) - \\frac{1}{2}(0) \\right) = 0 $$\nThe net integrated force vector is $\\mathbf{F}_{\\text{net}} = 0 \\cdot \\mathbf{i} + 0 \\cdot \\mathbf{j} = \\mathbf{0}$. This confirms the global equilibrium condition. The resulting net integrated force per unit thickness is the null vector $(0, 0)$, with units of $\\mathrm{N/m}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While analytical solutions are invaluable for building understanding, most real-world complex fluid problems require numerical computation. This practice bridges the gap between theory and implementation, guiding you through the full workflow of a computational fluid dynamics problem. Starting from the fundamental Cauchy equation, you will derive the specific governing equation for a channel flow with spatially varying viscosity, discretize it using a conservative numerical scheme, and solve it to predict the velocity profile, a task that is intractable with purely analytical methods .",
            "id": "4081923",
            "problem": "Consider steady, fully developed, laminar co-flow of two miscible Newtonian fluids in a planar channel of height $H$ driven by a constant streamwise pressure gradient $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$. Let the coordinate $y$ run from $y=0$ at the lower wall to $y=H$ at the upper wall. Denote the streamwise velocity by $u(y)$ and the viscosity distribution by $\\mu(y)$, which varies smoothly across an interfacial mixing region because the fluids are miscible. Assume incompressibility, no body forces, and negligible inertia such that the mixture momentum balance follows directly from the conservation of linear momentum (Cauchy's equation of motion) with a pointwise Newtonian constitutive relation for the stress.\n\nStarting from the fundamental base, use the conservation of linear momentum expressed by Cauchy's equation of motion for a continuum,\n$$\n\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b},\n$$\nwith the Cauchy stress tensor for a Newtonian fluid,\n$$\n\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\mu \\mathbf{D}, \\quad \\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\right),\n$$\nto derive the one-dimensional boundary value problem satisfied by $u(y)$ under the stated assumptions and boundary conditions. Enforce no-slip at both walls, $u(0)=0$ and $u(H)=0$, and continuity of velocity throughout the domain due to miscibility. Do not assume any pre-known or shortcut formulas beyond the fundamental base; instead, show a logically consistent pathway from the fundamental laws to the governing ordinary differential equation to be solved numerically.\n\nModel the viscosity of the miscible pair using a smooth sigmoid composition proxy $s(y)$ centered at an interface location $y_0$ with mixing thickness $\\delta>0$,\n$$\ns(y) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{y - y_0}{\\delta}\\right)\\right),\n$$\nand define the viscosity field as a linear blending of the component viscosities $\\mu_A$ and $\\mu_B$,\n$$\n\\mu(y) = \\mu_A \\left(1 - s(y)\\right) + \\mu_B s(y).\n$$\n\nYour task is to implement a conservative, second-order, finite-volume or finite-difference discretization for the differential operator\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right)\n$$\non a uniform grid in $y\\in[0,H]$ subject to the Dirichlet boundary conditions described above, solve the resulting linear system for $u(y)$, and compute the area-averaged velocity\n$U_{\\text{avg}} \\equiv \\frac{1}{H}\\int_0^H u(y)\\,\\mathrm{d}y$\nin $\\mathrm{m/s}$ for each test case. Use at least $N=401$ uniformly spaced grid points in $y$ for numerical resolution. Express the final answers in $\\mathrm{m/s}$ as floating-point numbers.\n\nTest Suite:\n- Case $1$ (happy path): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.6 H$, $\\delta = 2\\times 10^{-2} H$, $N=1001$.\n- Case $2$ (constant viscosity reference): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.5 H$, $\\delta = 5\\times 10^{-2} H$, $N=801$.\n- Case $3$ (zero pressure gradient boundary condition): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = 0\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.4 H$, $\\delta = 1\\times 10^{-2} H$, $N=601$.\n- Case $4$ (sharp interface edge case): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 2\\times 10^{-2}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.7 H$, $\\delta = 10^{-6}\\,\\mathrm{m}$, $N=2001$.\n\nRequired final output format:\nYour program should produce a single line of output containing the four results for $[U_{\\text{avg}}^{(1)}, U_{\\text{avg}}^{(2)}, U_{\\text{avg}}^{(3)}, U_{\\text{avg}}^{(4)}]$ as a comma-separated list enclosed in square brackets, for example `[result_1,result_2,result_3,result_4]`, where each `result_i` is a floating-point number in $\\mathrm{m/s}$.",
            "solution": "The user-provided problem is a well-posed problem in computational fluid dynamics, requiring the derivation and numerical solution of a one-dimensional boundary value problem for pressure-driven flow in a channel. The problem is scientifically grounded, self-contained, and objective. We will proceed with the solution.\n\n### 1. Derivation of the Governing Equation\n\nWe begin with the conservation of linear momentum as expressed by Cauchy's first law of motion for a continuum:\n$$\n\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b}\n$$\nHere, $\\rho$ is the fluid density, $\\mathbf{v}$ is the velocity vector, $\\frac{\\mathrm{D}}{\\mathrm{D}t} = \\frac{\\partial}{\\partial t} + \\mathbf{v} \\cdot \\nabla$ is the material derivative, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, and $\\mathbf{b}$ is the body force per unit mass.\n\nThe problem states several assumptions which simplify this general equation:\n- **Steady flow**: All time derivatives are zero, so $\\frac{\\partial}{\\partial t} = 0$.\n- **Negligible inertia**: The entire inertial term on the left-hand side is considered negligible, i.e., $\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\mathbf{0}$. This is characteristic of flows at very low Reynolds numbers (creeping or Stokes flow).\n- **No body forces**: $\\mathbf{b} = \\mathbf{0}$.\n\nApplying these assumptions, the momentum equation reduces to a statement of stress equilibrium:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}\n$$\n\nThe fluid is Newtonian, so the stress tensor $\\boldsymbol{\\sigma}$ is given by:\n$$\n\\boldsymbol{\\sigma} = -p \\mathbf{I} + \\boldsymbol{\\tau} = -p \\mathbf{I} + 2 \\mu \\mathbf{D}\n$$\nwhere $p$ is the thermodynamic pressure, $\\mathbf{I}$ is the identity tensor, $\\boldsymbol{\\tau}$ is the deviatoric (or viscous) stress tensor, $\\mu$ is the dynamic viscosity, and $\\mathbf{D}$ is the rate-of-deformation tensor (the symmetric part of the velocity gradient):\n$$\n\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\right)\n$$\nSubstituting the stress tensor expression into the equilibrium equation gives:\n$$\n\\nabla \\cdot (-p \\mathbf{I} + 2 \\mu \\mathbf{D}) = -\\nabla p + \\nabla \\cdot (2 \\mu \\mathbf{D}) = \\mathbf{0}\n$$\n\nThe flow is a steady, fully developed, unidirectional channel flow. Let the streamwise direction be $x$ and the wall-normal direction be $y$. The velocity vector is:\n$$\n\\mathbf{v} = (u(y), 0, 0)\n$$\nThe assumption of fully developed flow means that the velocity profile does not change in the streamwise direction, hence $u$ is a function of $y$ only. The velocity gradient tensor $\\nabla \\mathbf{v}$ is:\n$$\n\\nabla \\mathbf{v} = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} & \\frac{\\partial u}{\\partial y} & \\frac{\\partial u}{\\partial z} \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe rate-of-deformation tensor $\\mathbf{D}$ becomes:\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe viscous stress tensor $\\boldsymbol{\\tau} = 2 \\mu \\mathbf{D}$ is:\n$$\n\\boldsymbol{\\tau} = \\mu(y) \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe only non-zero components are $\\tau_{xy} = \\tau_{yx} = \\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}$.\n\nNow we evaluate the equilibrium equation $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ in component form:\n- **x-component**: $\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} = 0$\n  $$\n  -\\frac{\\partial p}{\\partial x} + \\frac{\\partial}{\\partial y} \\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) + 0 = 0 \\implies \\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) = \\frac{\\partial p}{\\partial x}\n  $$\n- **y-component**: $\\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{yz}}{\\partial z} = 0$\n  $$\n  \\frac{\\partial}{\\partial x}\\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) - \\frac{\\partial p}{\\partial y} + 0 = 0\n  $$\n  Since $u=u(y)$ and $\\mu=\\mu(y)$, the term $\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}$ is only a function of $y$, so its partial derivative with respect to $x$ is zero. This simplifies to $\\frac{\\partial p}{\\partial y} = 0$.\n- **z-component**: $\\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zy}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = 0 \\implies 0 + 0 - \\frac{\\partial p}{\\partial z} = 0 \\implies \\frac{\\partial p}{\\partial z} = 0$.\n\nFrom the y- and z-component equations, we find that the pressure $p$ does not depend on $y$ or $z$. Thus, $p$ is a function of $x$ only, $p = p(x)$. Consequently, the partial derivative $\\frac{\\partial p}{\\partial x}$ in the x-component equation can be written as a total derivative $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$. The problem states this is a constant. Let $G = \\frac{\\mathrm{d}p}{\\mathrm{d}x}$.\n\nThe final one-dimensional governing ordinary differential equation for the velocity profile $u(y)$ is:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) = G\n$$\nThis equation is subject to the no-slip boundary conditions at the walls:\n$$\nu(0) = 0 \\quad \\text{and} \\quad u(H) = 0\n$$\n\n### 2. Numerical Method\n\nWe will solve the boundary value problem using a conservative finite volume method on a uniform grid. The domain $y \\in [0, H]$ is discretized into $N$ points, $y_i = i \\Delta y$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta y = H/(N-1)$. Let $u_i = u(y_i)$ be the velocity at node $i$.\n\nWe integrate the governing ODE over a control volume (or cell) centered at an interior node $y_i$, extending from $y_{i-1/2} = y_i - \\Delta y/2$ to $y_{i+1/2} = y_i + \\Delta y/2$.\n$$\n\\int_{y_{i-1/2}}^{y_{i+1/2}} \\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) \\mathrm{d}y = \\int_{y_{i-1/2}}^{y_{i+1/2}} G \\, \\mathrm{d}y\n$$\nApplying the fundamental theorem of calculus to the left side and evaluating the integral of the constant $G$ on the right side yields:\n$$\n\\left[\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{y_{i+1/2}} - \\left[\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{y_{i-1/2}} = G \\Delta y\n$$\nThis expression is exact and ensures conservation of momentum flux. We now approximate the terms at the cell faces (the half-points) using second-order central differences for the derivatives and arithmetic means for the viscosity:\n- At the face $y_{i+1/2}$: $\\left[\\mu\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{i+1/2} \\approx \\mu_{i+1/2} \\left(\\frac{u_{i+1} - u_i}{\\Delta y}\\right)$, where $\\mu_{i+1/2} = \\frac{\\mu(y_i) + \\mu(y_{i+1})}{2} = \\frac{\\mu_i + \\mu_{i+1}}{2}$.\n- At the face $y_{i-1/2}$: $\\left[\\mu\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{i-1/2} \\approx \\mu_{i-1/2} \\left(\\frac{u_i - u_{i-1}}{\\Delta y}\\right)$, where $\\mu_{i-1/2} = \\frac{\\mu(y_{i-1}) + \\mu(y_i)}{2} = \\frac{\\mu_{i-1} + \\mu_i}{2}$.\n\nSubstituting these approximations back into the integrated equation gives a linear algebraic equation for each interior node $i = 1, 2, \\ldots, N-2$:\n$$\n\\mu_{i+1/2} \\left(\\frac{u_{i+1} - u_i}{\\Delta y}\\right) - \\mu_{i-1/2} \\left(\\frac{u_i - u_{i-1}}{\\Delta y}\\right) = G \\Delta y\n$$\nRearranging the terms to group the unknowns $u_{i-1}, u_i, u_{i+1}$:\n$$\n\\mu_{i-1/2} u_{i-1} - (\\mu_{i-1/2} + \\mu_{i+1/2}) u_i + \\mu_{i+1/2} u_{i+1} = G (\\Delta y)^2\n$$\nThis set of $N-2$ linear equations for the $N-2$ unknown interior velocities ($u_1, \\dots, u_{N-2}$) forms a tridiagonal system $A\\mathbf{u} = \\mathbf{b}$. The boundary conditions $u_0=0$ and $u_{N-1}=0$ are incorporated by modifying the equations for $i=1$ and $i=N-2$, where the terms involving $u_0$ and $u_{N-1}$ are moved to the right-hand side (and are zero in this case). This system can be solved efficiently using a tridiagonal matrix algorithm.\n\n### 3. Calculation of Average Velocity\n\nAfter solving the linear system for the interior velocities $u_i$, we have the complete discrete velocity profile $[u_0, u_1, \\dots, u_{N-1}]$. The area-averaged velocity $U_{\\text{avg}}$ is defined as:\n$$\nU_{\\text{avg}} = \\frac{1}{H}\\int_0^H u(y)\\,\\mathrm{d}y\n$$\nWe approximate this integral numerically using the trapezoidal rule, which is second-order accurate and consistent with our discretization scheme:\n$$\n\\int_0^H u(y)\\,\\mathrm{d}y \\approx \\Delta y \\left( \\frac{u_0 + u_{N-1}}{2} + \\sum_{i=1}^{N-2} u_i \\right)\n$$\nSince $u_0 = u_{N-1} = 0$, this simplifies to:\n$$\nU_{\\text{avg}} \\approx \\frac{\\Delta y}{H} \\sum_{i=1}^{N-2} u_i\n$$\nThe implementation will use `numpy.trapz` for robustness and clarity. The code will loop through the provided test cases, performing these calculations for each, and will then format the results as requested.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Derives and solves the 1D BVP for pressure-driven co-flow of two miscible fluids\n    in a planar channel, then computes the area-averaged velocity.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: happy path\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 5e-3, 'y0_factor': 0.6, 'delta_factor': 2e-2, 'N': 1001},\n        # Case 2: constant viscosity reference\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 1e-3, 'y0_factor': 0.5, 'delta_factor': 5e-2, 'N': 801},\n        # Case 3: zero pressure gradient\n        {'H': 1e-3, 'dpdx': 0,    'mu_A': 1e-3, 'mu_B': 5e-3, 'y0_factor': 0.4, 'delta_factor': 1e-2, 'N': 601},\n        # Case 4: sharp interface edge case\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 2e-2, 'y0_factor': 0.7, 'delta': 1e-6, 'N': 2001},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        H = case['H']\n        G = case['dpdx']\n        mu_A = case['mu_A']\n        mu_B = case['mu_B']\n        N = case['N']\n        y0 = case['y0_factor'] * H if 'y0_factor' in case else case['y0']\n        delta = case['delta_factor'] * H if 'delta_factor' in case else case['delta']\n\n        # 1. Set up the grid\n        y = np.linspace(0, H, N)\n        dy = H / (N - 1)\n\n        # 2. Define the viscosity profile mu(y)\n        s_y = 0.5 * (1 + np.tanh((y - y0) / delta))\n        mu_y = mu_A * (1 - s_y) + mu_B * s_y\n\n        # Handle the trivial case of zero pressure gradient\n        if G == 0:\n            results.append(0.0)\n            continue\n            \n        # 3. Set up the tridiagonal linear system Au = b for interior points\n        # The number of interior points (and unknowns) is M = N - 2.\n        M = N - 2\n        \n        # Calculate viscosity at cell faces (half-points) using arithmetic mean\n        mu_half = (mu_y[:-1] + mu_y[1:]) / 2.0\n        \n        # Main diagonal of matrix A\n        # Corresponds to coefficient of u_i for i=1..N-2\n        d_main = -(mu_half[:-1] + mu_half[1:])\n        \n        # Lower diagonal of matrix A\n        # Corresponds to coefficient of u_{i-1} for i=2..N-2\n        d_lower = mu_half[1:-1]\n\n        # Upper diagonal of matrix A\n        # Corresponds to coefficient of u_{i+1} for i=1..N-3\n        d_upper = mu_half[1:-1]\n        \n        # Assemble the matrix `ab` for `solve_banded`\n        # `ab` has shape (l+u+1, M) = (3, M)\n        # ab[0,:] = upper diagonal (padded at start)\n        # ab[1,:] = main diagonal\n        # ab[2,:] = lower diagonal (padded at end)\n        ab = np.zeros((3, M))\n        ab[0, 1:] = d_upper\n        ab[1, :] = d_main\n        ab[2, :-1] = d_lower\n\n        # Right-hand side vector b\n        b_rhs = np.full(M, G * dy**2)\n        \n        # 4. Solve the linear system for interior velocities\n        u_interior = solve_banded((1, 1), ab, b_rhs)\n        \n        # Reconstruct the full velocity profile with boundary conditions u(0)=0, u(H)=0\n        u_full = np.concatenate(([0.0], u_interior, [0.0]))\n        \n        # 5. Compute the area-averaged velocity using the trapezoidal rule\n        U_avg = np.trapz(u_full, y) / H\n        results.append(U_avg)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}