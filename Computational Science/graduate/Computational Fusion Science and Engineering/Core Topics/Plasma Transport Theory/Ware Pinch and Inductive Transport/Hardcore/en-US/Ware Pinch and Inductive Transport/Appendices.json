{
    "hands_on_practices": [
        {
            "introduction": "Understanding any transport mechanism begins with its fundamental physical origin. This exercise guides you through a first-principles derivation of the Ware pinch velocity for trapped particles, starting from the conservation of toroidal canonical momentum in an axisymmetric system. By considering the special case of a fully non-inductive plasma where the toroidal electric field $E_{\\phi}$ is zero, you will demonstrate precisely why this inductive field is the essential driver for the pinch and clarify the conditions under which it operates .",
            "id": "4062546",
            "problem": "Consider a large-aspect-ratio, circular-cross-section, axisymmetric tokamak plasma operating in a fully noninductive regime sustained by externally applied Radio-Frequency (RF) current drive. In this scenario, diagnostics confirm that the toroidal electric field is identically zero, i.e., $E_{\\phi}(r,t) = 0$ for all radii $r$ and times $t$ during the interval of interest. Assume standard flux coordinates with poloidal magnetic flux $\\psi_{p}(r,t)$ labeling flux surfaces, a major radius $R$ independent of poloidal angle, and a poloidal magnetic field $B_{\\theta}(r)$ that is finite and smooth. Trapped-particle guiding-center motion is bounce-averaged, and the tokamak is strictly axisymmetric, so that toroidal canonical momentum conservation applies.\n\nStarting from first principles—specifically, Maxwell–Faraday’s law for induction, the definition of poloidal magnetic flux as a flux-surface label, and the relationship between the time evolution of $\\psi_{p}$ and radial motion $dr/dt$ required to remain on a given flux surface—derive the Ware pinch velocity $v_{W}(r,t)$ for trapped particles. Then compute the value of $v_{W}$ under the stated noninductive condition $E_{\\phi}=0$ and explain, within the same logical framework, why any observed central density peaking during this interval must be attributed to non-Ware mechanisms.\n\nYour final computed answer must be the value of $v_{W}$ in $\\mathrm{m/s}$ for the stated case. Express the final velocity in $\\mathrm{m/s}$. No numerical approximation is required.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, self-contained, and well-posed. The problem is a standard derivation in neoclassical transport theory within plasma physics, and all provided conditions are physically meaningful in the context of tokamak research. I will now proceed with the solution.\n\nThe derivation of the Ware pinch velocity begins with the conservation of toroidal canonical momentum, $P_{\\phi}$, for a charged particle in an axisymmetric magnetic field. The toroidal canonical momentum for a particle of charge $q$ and mass $m$ is given by:\n$$P_{\\phi} = m R v_{\\phi} + q \\psi_{p}$$\nwhere $R$ is the major radius, $v_{\\phi}$ is the particle's toroidal velocity, and $\\psi_{p}$ is the poloidal magnetic flux per radian of toroidal angle. The problem states that the tokamak is strictly axisymmetric, which ensures that $P_{\\phi}$ is a constant of motion for the guiding center. Thus, the total time derivative of $P_{\\phi}$ following the guiding center is zero:\n$$\\frac{d P_{\\phi}}{dt} = 0$$\n\nThe Ware pinch specifically describes the motion of trapped particles. A key characteristic of trapped particles is that they are confined in a magnetic well and oscillate between two bounce points. Their net toroidal motion, when averaged over a single bounce period, is zero. That is, the bounce-averaged toroidal velocity is $\\langle v_{\\phi} \\rangle = 0$.\n\nApplying the bounce-average operator to the conservation of $P_{\\phi}$ for a trapped particle, we get:\n$$\\frac{d \\langle P_{\\phi} \\rangle}{dt} = \\frac{d}{dt} \\langle m R v_{\\phi} + q \\psi_{p} \\rangle = 0$$\nSince $\\langle v_{\\phi} \\rangle = 0$ and $q$ is constant, and $\\psi_{p}$ is a macroscopic field quantity that varies slowly compared to the bounce time, we can approximate $\\langle q \\psi_{p} \\rangle \\approx q \\psi_{p}$. This yields:\n$$\\frac{d}{dt} (q \\psi_{p}) = 0 \\implies \\frac{d \\psi_{p}}{dt} = 0$$\nThis result signifies that the bounce-averaged guiding center of a trapped particle remains on a surface of constant poloidal flux $\\psi_{p}$.\n\nThe total time derivative of $\\psi_{p}(r,t)$ following the particle's guiding center, which has a radial velocity component $v_{r}$, is expressed as:\n$$\\frac{d \\psi_{p}}{dt} = \\frac{\\partial \\psi_{p}}{\\partial t} + v_{r} \\frac{\\partial \\psi_{p}}{\\partial r} = 0$$\nFrom this, we can solve for the radial drift velocity, which is the Ware pinch velocity $v_{W}$:\n$$v_{W} = v_{r} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}}$$\n\nNext, we relate the terms in this expression to the physical fields $E_{\\phi}$ and $B_{\\theta}$ using the principles specified in the problem statement.\n\nFirst, we use Maxwell's law of induction (Faraday's law), $\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t}$. In integral form, for a toroidal loop of major radius $R$ at a fixed vertical position:\n$$\\oint \\vec{E} \\cdot d\\vec{l} = - \\frac{d}{dt} \\iint \\vec{B} \\cdot d\\vec{S}$$\nThe line integral on the left, taken along the toroidal loop, is $\\int_{0}^{2\\pi} E_{\\phi} R d\\phi$. Due to axisymmetry, $E_{\\phi}$ is constant along this path, so the integral evaluates to $2\\pi R E_{\\phi}$. The surface integral on the right is the time rate of change of the magnetic flux passing through the disk enclosed by the loop. This is, by definition, the poloidal magnetic flux, $\\Psi_{p}$. Thus:\n$$2\\pi R E_{\\phi} = - \\frac{\\partial \\Psi_{p}}{\\partial t}$$\nThe problem uses $\\psi_{p}$ as the flux-surface label, which conventionally is the poloidal flux per radian, $\\psi_{p} = \\Psi_{p} / (2\\pi)$. Substituting this gives:\n$$2\\pi R E_{\\phi} = - \\frac{\\partial (2\\pi \\psi_{p})}{\\partial t} = -2\\pi \\frac{\\partial \\psi_{p}}{\\partial t}$$\nThis simplifies to a fundamental relationship between the toroidal electric field and the time evolution of the poloidal flux function:\n$$E_{\\phi} = - \\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial t} \\implies \\frac{\\partial \\psi_{p}}{\\partial t} = -R E_{\\phi}$$\n\nSecond, we relate the radial gradient of $\\psi_{p}$ to the poloidal magnetic field $B_{\\theta}$. The poloidal magnetic field is derived from the poloidal flux function via $\\vec{B}_{p} = \\frac{1}{R} \\nabla \\psi_{p} \\times \\hat{\\phi}$. For the specified large-aspect-ratio, circular-cross-section geometry, we can use coordinates where $\\nabla \\psi_{p} = \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r}$. The poloidal field is $\\vec{B}_{p} = B_{\\theta} \\hat{\\theta}$. The unit vectors are related by $\\hat{\\theta} = \\hat{\\phi} \\times \\hat{r}$. Therefore:\n$$B_{\\theta} \\hat{\\theta} = \\frac{1}{R} \\left( \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r} \\right) \\times \\hat{\\phi} = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} (\\hat{\\phi} \\times \\hat{r}) = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{\\theta}$$\nComparing the components, we find:\n$$B_{\\theta} = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} \\implies \\frac{\\partial \\psi_{p}}{\\partial r} = -R B_{\\theta}$$\n\nNow, we substitute these two derived relationships back into the expression for $v_{W}$:\n$$v_{W} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}} = - \\frac{-R E_{\\phi}}{-R B_{\\theta}} = - \\frac{E_{\\phi}}{B_{\\theta}}$$\nThis is the general expression for the Ware pinch velocity, $v_{W}(r,t)$.\n\nThe problem now requires us to compute the value of $v_{W}$ under the specific condition of a fully noninductive regime where the toroidal electric field is identically zero, i.e., $E_{\\phi}(r, t) = 0$. The problem also states that the poloidal magnetic field $B_{\\theta}(r)$ is finite. Substituting the given condition into our derived formula:\n$$v_{W} = - \\frac{0}{B_{\\theta}} = 0$$\nThe Ware pinch velocity is identically zero everywhere in the plasma under the specified conditions.\n\nFinally, we must explain why any observed central density peaking must be attributed to non-Ware mechanisms. The Ware pinch is a neoclassical transport effect that drives an inward flux of trapped particles, proportional to $E_{\\phi}$. In a conventional inductively driven tokamak, $E_{\\phi}$ is non-zero and drives the toroidal current, and consequently, the Ware pinch contributes to density peaking at the plasma core. However, in the scenario described—a fully noninductive plasma with $E_{\\phi} = 0$—the driving force for the Ware pinch vanishes. As we have just calculated, $v_{W} = 0$. Therefore, the Ware pinch mechanism cannot transport any particles radially inward or outward, and it cannot be the cause of any observed density accumulation or peaking. Should experimental diagnostics confirm both $E_{\\phi} = 0$ and a centrally peaked density profile, it is a direct conclusion from this framework that other physical mechanisms must be responsible. Such mechanisms could include turbulent transport (e.g., an anomalous inward pinch driven by microinstabilities), other neoclassical effects (like the thermoelectric pinch), or core particle sources (like neutral beam fueling). The absence of an inductive electric field decouples particle transport from this specific neoclassical effect, forcing consideration of other transport channels to explain the observed plasma state.\n\nThe final computed value for the Ware pinch velocity $v_{W}$ in this noninductive case is $0 \\, \\mathrm{m/s}$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Having established the physical basis for the Ware pinch, we can now explore its quantitative impact on the plasma density profile. This practice challenges you to construct a simplified one-dimensional transport model that balances the inward convective flux from the Ware pinch against outward diffusion. By solving the steady-state transport equation, you will calculate the density peaking factor, $n(0)/n(a)$, providing a tangible estimate of how inductive transport shapes the plasma core .",
            "id": "3964879",
            "problem": "Consider an axisymmetric tokamak plasma modeled by a One-Dimensional (1D) reduced particle transport equation in cylindrical coordinates, with minor radius $a$ and major radius $R$. The transport model consists of a diffusive particle flux with constant diffusivity $D_0$ and a convective flux due to the neoclassical inductive pinch driven by the toroidal electric field. Assume a circular cross-section, large aspect ratio, and uniform toroidal current density. The toroidal electric field is maintained by an externally applied loop voltage. Work within the International System of Units (SI).\n\nStarting from fundamental laws, use Faraday's law to relate the toroidal electric field to the applied loop voltage, and use Ampère's law to estimate the flux-surface-averaged poloidal magnetic field at the plasma edge. Argue from the continuity equation and constitutive relations how the convective pinch modifies the steady-state density profile under the assumptions of no volumetric particle sources, a fixed edge density, and regularity at the magnetic axis.\n\nParameters:\n- Major radius: $R = 3.0\\,\\mathrm{m}$.\n- Minor radius: $a = 0.70\\,\\mathrm{m}$.\n- Total plasma current: $I_p = 1.8 \\times 10^6\\,\\mathrm{A}$.\n- Loop voltage: $V_{\\text{loop}} = 1.9\\,\\mathrm{V}$.\n- Constant particle diffusivity: $D_0 = 0.80\\,\\mathrm{m^2/s}$.\n- Magnetic permeability of free space: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n\nUsing these, compute the steady-state density peaking factor $n(0)/n(a)$ implied by the inductive pinch in this reduced model. Express the final answer as a dimensionless number, and round your answer to four significant figures.",
            "solution": "The problem is validated by following the specified procedure.\n\n### Step 1: Extract Givens\n-   **Model**: One-Dimensional (1D) reduced particle transport equation in cylindrical coordinates for an axisymmetric tokamak plasma.\n-   **Geometry**: Circular cross-section, large aspect ratio.\n-   **Minor Radius**: $a = 0.70\\,\\mathrm{m}$.\n-   **Major Radius**: $R = 3.0\\,\\mathrm{m}$.\n-   **Particle Flux**: Composed of a diffusive flux and a convective flux.\n-   **Diffusivity**: Constant particle diffusivity, $D_0 = 0.80\\,\\mathrm{m^2/s}$.\n-   **Convection**: Neoclassical inductive pinch driven by the toroidal electric field.\n-   **Current Profile**: Uniform toroidal current density.\n-   **Total Plasma Current**: $I_p = 1.8 \\times 10^6\\,\\mathrm{A}$.\n-   **Loop Voltage**: $V_{\\text{loop}} = 1.9\\,\\mathrm{V}$.\n-   **Magnetic Permeability**: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n-   **Assumptions**: Steady-state, no volumetric particle sources, fixed edge density $n(a)$, regularity at the magnetic axis ($r=0$).\n-   **Objective**: Compute the steady-state density peaking factor $n(0)/n(a)$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is firmly rooted in the principles of plasma physics and transport theory. It utilizes fundamental laws such as Faraday's law and Ampère's law, and the continuity equation. The concept of an inductive (Ware) pinch is a well-established neoclassical transport effect in tokamaks. The use of a 1D reduced model with simplifying assumptions (constant diffusivity, uniform current density) is a standard and valid approach for analytical estimation in fusion science.\n-   **Well-Posed**: The problem provides a differential equation (derived from the transport model) and a sufficient number of boundary conditions (fixed density at $r=a$ and regularity at $r=0$) to determine a unique solution for the density profile $n(r)$. All necessary physical parameters ($R$, $a$, $I_p$, $V_{\\text{loop}}$, $D_0$, $\\mu_0$) are given.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased technical language. It requires a specific calculation based on the provided model and data, with no room for subjective interpretation.\n\nThe problem does not exhibit any of the flaws listed in the instructions (e.g., scientific unsoundness, incompleteness, ambiguity). The one potential ambiguity—the treatment of the pinch velocity's singularity at the magnetic axis—is implicitly resolved by the instruction to \"estimate the flux-surface-averaged poloidal magnetic field at the plasma edge,\" which suggests a standard simplification used in reduced models to avoid this issue.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\nThe analysis begins with the particle continuity equation in cylindrical coordinates $(r, \\theta, \\phi)$, where $r$ is the minor radial coordinate. For an axisymmetric system with no poloidal or toroidal variation in density, the continuity equation is:\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\Gamma_r) = S\n$$\nwhere $n$ is the particle density, $\\Gamma_r$ is the radial particle flux, and $S$ is the particle source/sink term. The problem specifies a steady-state condition ($\\frac{\\partial n}{\\partial t}=0$) and no volumetric particle sources ($S=0$). The equation thus simplifies to:\n$$\n\\frac{d}{dr}(r\\Gamma_r) = 0\n$$\nIntegrating this equation with respect to $r$ yields $r\\Gamma_r = \\text{constant}$. The \"regularity at the magnetic axis\" condition requires that the particle flux $\\Gamma_r$ be finite at $r=0$. For the product $r\\Gamma_r$ to remain constant as $r \\to 0$, the constant must be zero. Therefore, the particle flux must be zero everywhere in the plasma for a source-free steady state:\n$$\n\\Gamma_r(r) = 0\n$$\nThe problem states that the particle flux consists of a diffusive and a convective component:\n$$\n\\Gamma_r(r) = -D_0 \\frac{dn}{dr} + n(r)v_r(r)\n$$\nwhere $D_0$ is the constant diffusivity and $v_r(r)$ is the convective pinch velocity. Setting the total flux to zero gives the balance between diffusion and convection:\n$$\nD_0 \\frac{dn}{dr} = n(r)v_r(r)\n$$\nThe convective velocity is the neoclassical inductive pinch (Ware pinch), given by $v_r = -E_\\phi/B_\\theta$, where $E_\\phi$ is the toroidal electric field and $B_\\theta$ is the poloidal magnetic field. The negative sign indicates an inward pinch (for standard sign conventions of $E_\\phi$ and $B_\\theta$).\n\nFirst, we relate the toroidal electric field $E_\\phi$ to the given loop voltage $V_{\\text{loop}}$ using Faraday's law of induction. For a loop of major radius $R$, the loop voltage is the line integral of the electric field around the torus:\n$$\nV_{\\text{loop}} = \\oint \\mathbf{E} \\cdot d\\mathbf{l} = E_\\phi (2\\pi R)\n$$\nAssuming a uniform toroidal electric field, we have:\n$$\nE_\\phi = \\frac{V_{\\text{loop}}}{2\\pi R}\n$$\nNext, we estimate the poloidal magnetic field $B_\\theta$. The problem directs us to use Ampère's law to estimate $B_\\theta$ at the plasma edge ($r=a$). Applying Ampère's law to a circular loop of radius $a$ enclosing the entire plasma current $I_p$:\n$$\n\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}} \\implies B_\\theta(a) (2\\pi a) = \\mu_0 I_p\n$$\nThis gives the poloidal magnetic field at the edge:\n$$\nB_\\theta(a) = \\frac{\\mu_0 I_p}{2\\pi a}\n$$\nIn a reduced 1D model, it is a common simplification to approximate the spatially varying pinch velocity with a constant value. We use the edge value of the poloidal field to define a characteristic, spatially-constant pinch velocity, $v_0$. This avoids the singularity in the pinch velocity $v_r \\propto 1/B_\\theta(r)$ that would arise at $r=0$ from the assumption of uniform current density (which implies $B_\\theta(r) \\propto r$).\n$$\nv_r \\approx v_0 = -\\frac{E_\\phi}{B_\\theta(a)} = -\\frac{V_{\\text{loop}}/(2\\pi R)}{\\mu_0 I_p/(2\\pi a)} = -\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\n$$\nNow we can substitute this constant pinch velocity $v_0$ into the flux balance equation:\n$$\nD_0 \\frac{dn}{dr} = n(r) v_0\n$$\nThis is a first-order, separable ordinary differential equation for the density profile $n(r)$:\n$$\n\\frac{dn}{n} = \\frac{v_0}{D_0} dr\n$$\nIntegrating both sides from the plasma edge $r=a$ to an arbitrary radius $r$ gives:\n$$\n\\int_{n(a)}^{n(r)} \\frac{dn'}{n'} = \\int_a^r \\frac{v_0}{D_0} dr' \\implies \\ln\\left(\\frac{n(r)}{n(a)}\\right) = \\frac{v_0}{D_0}(r-a)\n$$\nSolving for $n(r)$ yields the density profile:\n$$\nn(r) = n(a) \\exp\\left(\\frac{v_0}{D_0}(r-a)\\right)\n$$\nWe are asked to find the density peaking factor, which is the ratio of the central density $n(0)$ to the edge density $n(a)$. We evaluate the profile at $r=0$:\n$$\nn(0) = n(a) \\exp\\left(\\frac{v_0}{D_0}(0-a)\\right) = n(a) \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\nThe peaking factor is therefore:\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\nSubstituting the expression for $v_0$:\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\left(-\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\\right) \\frac{a}{D_0}\\right) = \\exp\\left(\\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0}\\right)\n$$\nThe exponent is a dimensionless quantity, often referred to as the pinch Peclet number. Let's compute its value using the given parameters:\n$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$\n$a = 0.70\\,\\mathrm{m}$\n$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$\n$R = 3.0\\,\\mathrm{m}$\n$D_0 = 0.80\\,\\mathrm{m^2/s}$\n\nThe exponent, let's call it $\\mathcal{S}$, is:\n$$\n\\mathcal{S} = \\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0} = \\frac{(1.9) \\times (0.70)^2}{(4\\pi \\times 10^{-7}) \\times (1.8 \\times 10^6) \\times (3.0) \\times (0.80)}\n$$\n$$\n\\mathcal{S} = \\frac{1.9 \\times 0.49}{4\\pi \\times 1.8 \\times 3.0 \\times 0.80 \\times 10^{-1}} = \\frac{0.931}{5.42867\\ldots}\n$$\n$$\n\\mathcal{S} \\approx 0.17150\n$$\nThe density peaking factor is then:\n$$\n\\frac{n(0)}{n(a)} = \\exp(\\mathcal{S}) = \\exp(0.17150) \\approx 1.187112\n$$\nRounding the result to four significant figures gives $1.187$.",
            "answer": "$$\n\\boxed{1.187}\n$$"
        },
        {
            "introduction": "Translating physical models into reliable simulation code requires careful consideration of numerical methods and boundary conditions. This exercise moves from analytical calculation to computational design, asking you to identify the correct methodology for implementing the Ware pinch in a 1D transport solver. You will analyze different strategies for discretizing the advective flux and enforcing boundary conditions, developing the critical thinking needed to build stable and physically consistent transport codes .",
            "id": "4062556",
            "problem": "You are implementing inductive transport associated with the Ware pinch in a one-dimensional ($1\\text{D}$) radial particle transport solver for an axisymmetric, large-aspect-ratio, circular tokamak. The solver advances the particle density $n(r,t)$ on the minor-radius coordinate $r \\in [0,a]$, with given geometry factor $V'(r)$ (the derivative of the plasma volume with respect to $r$), known toroidal magnetic field $B_{\\phi}$ (approximately constant on flux surfaces), and a known safety-factor profile $q(r)$. The inductive drive is specified by a measured loop voltage $V_{\\text{loop}}(t)$, which is spatially uniform poloidally and toroidally to leading order in the large-aspect-ratio limit. The governing particle continuity equation takes the standard conservative flux-surface-averaged form with diffusion and any additional modeled fluxes,\n$$\n\\frac{\\partial}{\\partial t}\\big(V'(r)\\,n(r,t)\\big) + \\frac{\\partial}{\\partial r}\\big(V'(r)\\,\\Gamma(r,t)\\big) \\;=\\; V'(r)\\,S(r,t),\n$$\nwhere $S(r,t)$ is a known particle source and $\\Gamma(r,t)$ is the radial particle flux. The inductive Ware pinch should enter $\\Gamma$ as a neoclassical advective contribution whose velocity is determined by the toroidal electric field and the poloidal magnetic field, after appropriate flux-surface averaging. The toroidal electric field $E_{\\phi}(t)$ is related to $V_{\\text{loop}}(t)$ by Faraday’s law. The poloidal magnetic field $B_{\\theta}(r)$ is related to $q(r)$, $B_{\\phi}$, and the major radius $R_{0}$ by large-aspect-ratio magnetic geometry.\n\nYour task is to select the option that correctly outlines, from first principles and with numerically robust choices, how to implement the inductive Ware pinch in the flux $\\Gamma$ with time-dependent inductive drive, including correct boundary conditions for $n(r,t)$ at $r=0$ (magnetic axis) and at $r=a$ (last closed flux surface), and a stable time discretization for the advective term. Assume that $D(r,t)$, the diffusive transport coefficient, and $S(r,t)$ are already provided by other modules. The implementation must be conservative, physically consistent with flux-surface averaging, and stable for time-dependent inductive drive.\n\nWhich option is correct?\n\nA. Use the conservative form of the transport equation as written. Decompose the flux as $\\Gamma(r,t)= -D(r,t)\\,\\partial n/\\partial r + n(r,t)\\,v_{\\text{pinch}}(r,t)$, where the Ware pinch velocity $v_{\\text{pinch}}(r,t)$ is obtained by first relating the flux-surface-averaged toroidal electric field to the loop voltage via Faraday’s law, $\\langle E_{\\phi}\\rangle_{\\psi}(t)=V_{\\text{loop}}(t)/(2\\pi R_{0})$, and then using large-aspect-ratio magnetic geometry to evaluate the ratio with the poloidal magnetic field $B_{\\theta}(r)$ computed consistently from the safety factor, $q(r)= r B_{\\phi}/(R_{0} B_{\\theta}(r))$. Discretize the advective flux $n\\,v_{\\text{pinch}}$ at cell interfaces using an upwind scheme based on the sign of $v_{\\text{pinch}}$ and advance in time with a semi-implicit scheme (for example, evaluating $v_{\\text{pinch}}$ at the midpoint in time $t^{n+1/2}$) to accommodate $V_{\\text{loop}}(t)$ variability. Enforce symmetry at the magnetic axis by imposing zero net flux, $V'(0)\\,\\Gamma(0,t)=0$, which translates to a constraint on the discrete combination of diffusive and advective terms at the innermost interface. At the edge $r=a$, apply an upwind inflow boundary condition based on the sign of $v_{\\text{pinch}}$: for inward pinch (negative radial velocity), prescribe the edge density (for example, set $n(a,t)$ to a specified last-closed-flux-surface value) or an equivalent ghost-cell value; for outward velocity, use a zero-gradient (Neumann) condition so that the outflow is not artificially reflected. This implementation preserves global particle conservation to within source and boundary fluxes.\n\nB. Use a non-conservative form $\\partial n/\\partial t + \\partial \\Gamma/\\partial r = S$ without the geometry factor $V'(r)$, since the Ware pinch is dominantly advective. Compute the pinch contribution by setting $\\Gamma_{\\text{pinch}} = n\\,u$, where $u$ is a user-specified constant proportional to the measured loop voltage, and evaluate spatial derivatives with centered differences for second-order accuracy. Set zero-flux boundary conditions at both $r=0$ and $r=a$ for all times to avoid boundary layers. Advance the time integration explicitly with the pinch velocity evaluated at $t^{n}$.\n\nC. Keep the conservative form but compute the toroidal electric field pointwise as $E_{\\phi}(r,\\theta,t)=V_{\\text{loop}}(t)/(2\\pi R(r,\\theta))$ and insert this pointwise value directly into the pinch velocity without flux-surface averaging, so that the $1\\text{D}$ code uses a single chosen poloidal angle $\\theta=\\theta_{0}$ to represent each flux surface. Use first-order upwind for the advective term and explicit time stepping with a Courant–Friedrichs–Lewy (CFL) time step restriction. Impose zero-flux at $r=0$ and a fixed density at $r=a$ for all signs of the velocity.\n\nD. Model the Ware pinch by redefining the diffusion coefficient as $D_{\\text{eff}}(r,t)=D(r,t)-\\ell\\,w(t)$, where $w(t)$ is proportional to the loop voltage and $\\ell$ is a user-chosen length scale, so that no explicit advective term is present. Keep centered differences for the diffusive flux and use homogeneous Neumann boundary conditions $\\partial n/\\partial r=0$ at both $r=0$ and $r=a$ for all times. The time integrator can remain unchanged because the effect is diffusive.\n\nE. Treat the inductive effect as a polarization current by adding a term proportional to $\\partial E_{\\phi}/\\partial t$ to the right-hand side source $S(r,t)$, since the loop voltage is time-dependent. Keep $\\Gamma=-D\\,\\partial n/\\partial r$ unchanged, because advective pinches can be represented as sources in the continuity equation. Use zero-gradient density at both boundaries and explicit time stepping for simplicity.",
            "solution": "The problem statement describes the implementation of the inductive Ware pinch within a one-dimensional ($1\\text{D}$) radial particle transport code for a tokamak. The task is to identify the correct implementation strategy among the given options, covering the physical model, numerical discretization, and boundary conditions.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n-   **Governing Equation:** The particle continuity equation is given in conservative form:\n    $$\n    \\frac{\\partial}{\\partial t}\\big(V'(r)\\,n(r,t)\\big) + \\frac{\\partial}{\\partial r}\\big(V'(r)\\,\\Gamma(r,t)\\big) \\;=\\; V'(r)\\,S(r,t)\n    $$\n-   **Variables and Domain:** The solver advances particle density $n(r,t)$ on the minor radius coordinate $r \\in [0,a]$.\n-   **Known Quantities:**\n    -   Geometry factor: $V'(r)$.\n    -   Toroidal magnetic field: $B_{\\phi}$.\n    -   Safety factor profile: $q(r)$.\n    -   Inductive drive: Spatially uniform loop voltage $V_{\\text{loop}}(t)$.\n    -   Particle source: $S(r,t)$.\n    -   Diffusion coefficient: $D(r,t)$.\n-   **Physical Relationships:**\n    -   The Ware pinch is a neoclassical effect.\n    -   The toroidal electric field $E_{\\phi}(t)$ is related to $V_{\\text{loop}}(t)$ by Faraday’s law.\n    -   The poloidal magnetic field $B_{\\theta}(r)$ is related to $q(r)$, $B_{\\phi}$, and major radius $R_{0}$ by large-aspect-ratio geometry.\n-   **Implementation Requirements:**\n    -   The implementation must be conservative.\n    -   It must be physically consistent with flux-surface averaging.\n    -   It must be stable for time-dependent inductive drive.\n    -   It must include correct boundary conditions at $r=0$ and $r=a$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is firmly based on established principles of neoclassical transport theory in tokamak plasmas (Ware pinch) and standard numerical methods for solving partial differential equations (PDEs) in computational physics. All concepts—flux-surface averaging, safety factor, loop voltage, conservative transport equations—are standard in fusion science.\n-   **Well-Posed:** The problem provides a complete and self-consistent physical and computational context. It asks for the correct methodology for implementing a specific physical effect, which is a well-defined task in computational science.\n-   **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. I will now proceed with a derivation of the correct implementation, followed by an evaluation of each option.\n\n### **Derivation from First Principles**\n\n1.  **Particle Conservation:** The provided governing equation is in conservative form, where $V'(r)$ is the differential plasma volume element ($V'(r) = dV/dr$). For a large-aspect-ratio circular tokamak, $V(r) = (2\\pi R_{0})(\\pi r^2)$, so $V'(r) = 4\\pi^2 R_0 r$. The use of the conservative form $\\frac{\\partial}{\\partial t}(V'n) + \\frac{\\partial}{\\partial r}(V'\\Gamma) = V'S$ is essential to ensure that the total number of particles in the simulation volume, $N = \\int_0^a V'(r) n(r,t) dr$, changes only due to sources $S$ and fluxes across the boundary at $r=a$. Any valid numerical scheme must discretize this conservative form correctly.\n\n2.  **Ware Pinch Flux:** The radial particle flux $\\Gamma$ is composed of diffusive and advective parts:\n    $$\n    \\Gamma(r,t) = -D(r,t)\\,\\frac{\\partial n}{\\partial r} + \\Gamma_{\\text{pinch}}(r,t)\n    $$\n    The Ware pinch is a neoclassical effect that results in an advective particle flux. As established in neoclassical transport theory (and as distinct from the simple $\\mathbf{E}\\times\\mathbf{B}$ drift discussed elsewhere in this article), the pinch velocity is given by:\n    $$v_{\\text{pinch}}(r,t) = -\\frac{E_{\\phi}(t)}{B_{\\theta}(r)}$$\n    The advective flux contribution is therefore written as $\\Gamma_{\\text{pinch}}(r,t) = n(r,t) \\, v_{\\text{pinch}}(r,t)$. A positive $E_{\\phi}$ (standard Ohmic operation) and positive $B_{\\theta}$ result in $v_{\\text{pinch}} < 0$, an inward pinch, as expected.\n\n3.  **Auxiliary Relations:**\n    -   **Toroidal Electric Field:** By Faraday's Law, the loop voltage is the line integral of the electric field around a toroidal path. For a loop at the magnetic axis, $V_{\\text{loop}}(t) = \\oint \\vec{E} \\cdot d\\vec{l}$. In an axisymmetric tokamak, $E_\\phi$ is approximately constant on a flux surface and spatially uniform to leading order. Thus, $V_{\\text{loop}}(t) \\approx E_{\\phi}(t) (2\\pi R_0)$, which gives:\n        $$\n        E_{\\phi}(t) = \\frac{V_{\\text{loop}}(t)}{2\\pi R_{0}}\n        $$\n    -   **Poloidal Magnetic Field:** The safety factor $q(r)$ in the large-aspect-ratio, circular-flux-surface limit is defined as $q(r) \\approx \\frac{r B_{\\phi}}{R_{0} B_{\\theta}(r)}$. This can be rearranged to find $B_{\\theta}(r)$:\n        $$\n        B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_{0} q(r)}\n        $$\n\n4.  **Numerical Scheme:**\n    -   **Spatial Discretization:** The advection term in the conservative equation, $\\frac{\\partial}{\\partial r}(V' n v_{\\text{pinch}})$, is prone to numerical instability if discretized with a centered difference scheme. An **upwind scheme** is the standard, robust choice. The flux at a cell interface $r_{i+1/2}$ is determined by the value of $n$ in the upwind cell:\n        $$\n        (V' n v_{\\text{pinch}})_{i+1/2} = \\begin{cases} (V' v_{\\text{pinch}})_{i+1/2} \\, n_i & \\text{if } v_{\\text{pinch}, i+1/2} > 0 \\\\ (V' v_{\\text{pinch}})_{i+1/2} \\, n_{i+1} & \\text{if } v_{\\text{pinch}, i+1/2} < 0 \\end{cases}\n        $$\n        This ensures stability and preserves the positivity of the density profile.\n    -   **Time Discretization:** An explicit time-stepping scheme for the advection term is subject to the Courant–Friedrichs–Lewy (CFL) condition, $\\Delta t \\le \\min(\\Delta r / |v_{\\text{pinch}}|)$, which can be prohibitively restrictive. Given that $V_{\\text{loop}}(t)$ and thus $v_{\\text{pinch}}(t)$ can vary in time, a **semi-implicit or implicit scheme** is superior. For example, a Crank-Nicolson or backward Euler scheme for the advection and diffusion terms provides unconditional linear stability. Evaluating the time-dependent velocity $v_{\\text{pinch}}(t)$ at the new time step $t^{n+1}$ or at the midpoint $t^{n+1/2}$ enhances accuracy and stability.\n\n5.  **Boundary Conditions:**\n    -   **Magnetic Axis ($r=0$):** Physical symmetry dictates that the net particle flux across the magnetic axis must be zero. The total flux through a surface of radius $r$ is proportional to $V'(r)\\Gamma(r)$. As $r \\to 0$, $V'(r) \\propto r \\to 0$. We must have $\\lim_{r\\to 0} V'(r)\\Gamma(r) = 0$. This is typically implemented by setting the flux at the first cell interface to zero, which often corresponds to a zero-gradient condition $\\partial n/\\partial r = 0$ at $r=0$.\n    -   **Last Closed Flux Surface ($r=a$):** The boundary condition here models interaction with the scrape-off layer. For an advection-diffusion equation, the correct boundary condition depends on the direction of information flow, i.e., the sign of the velocity.\n        -   **Inflow ($v_{\\text{pinch}}(a,t) < 0$):** Information flows into the domain. A boundary condition must be prescribed. A Dirichlet condition, $n(a,t) = n_{\\text{edge}}(t)$, is a physically appropriate choice, representing a density maintained by edge physics.\n        -   **Outflow ($v_{\\text{pinch}}(a,t) > 0$):** Information flows out of the domain. The solution at the boundary should be determined from the interior. Imposing a value would cause non-physical reflections. A zero-gradient (Neumann) condition, $\\partial n/\\partial r=0$ (or more generally, an outflow/extrapolation condition), is appropriate as it allows particles to leave the domain freely.\n        Therefore, an **upwind-based or characteristic-based boundary condition** that switches depending on the sign of the velocity is the most robust and physically correct approach.\n\n### **Option-by-Option Analysis**\n\n**A. Use the conservative form...**\nThis option correctly prescribes:\n1.  The conservative form of the transport equation.\n2.  The correct decomposition of the flux $\\Gamma = -D \\, \\partial n/\\partial r + n v_{\\text{pinch}}$.\n3.  The correct, physically-based calculation of $v_{\\text{pinch}}(r,t)$ from $V_{\\text{loop}}(t)$ and $q(r)$ using large-aspect-ratio formulas.\n4.  A numerically robust upwind scheme for the advective flux.\n5.  A stable semi-implicit time integration scheme suitable for time-dependent coefficients.\n6.  The correct zero net flux boundary condition at the magnetic axis ($r=0$).\n7.  The correct physically-motivated, sign-dependent \"upwind\" boundary condition at the edge ($r=a$).\nThis option is a complete and correct description of a state-of-the-art implementation.\n**Verdict: Correct**\n\n**B. Use a non-conservative form...**\nThis option is flawed for multiple reasons:\n1.  Using a non-conservative form, $\\partial n/\\partial t + \\partial \\Gamma/\\partial r = S$, violates particle conservation in curvilinear coordinates where the volume element $V'(r)$ is not constant.\n2.  Modeling the pinch velocity as a user-specified spatial constant is physically incorrect; $v_{\\text{pinch}}$ fundamentally depends on radius via $B_{\\theta}(r)$.\n3.  Using centered differences for advection is numerically unstable.\n4.  Zero-flux boundary conditions at $r=a$ are physically incorrect (reflecting).\n5.  Relying solely on an explicit time integrator is not robust.\n**Verdict: Incorrect**\n\n**C. Keep the conservative form but compute the toroidal electric field pointwise...**\nThis option is flawed because:\n1.  It proposes calculating $E_{\\phi}$ at a single, arbitrary poloidal angle $\\theta_0$ to represent a flux surface. This violates the principle of flux-surface averaging, which is the foundation of $1\\text{D}$ transport modeling. Physical quantities must be properly averaged, not sampled at an arbitrary point.\n2.  It suggests imposing a fixed density at $r=a$ regardless of the sign of the velocity. This is incorrect for outflow conditions and will lead to non-physical results.\n3.  It suggests explicit time stepping, which is not a robust choice.\n**Verdict: Incorrect**\n\n**D. Model the Ware pinch by redefining the diffusion coefficient as $D_{\\text{eff}}(r,t)=D(r,t)-\\ell\\,w(t)$...**\nThis option is fundamentally flawed because:\n1.  It misrepresents the mathematical structure of advection. Advective flux is proportional to the density $n$, while diffusive flux is proportional to the density gradient $\\partial n/\\partial r$. Conflating the two into an effective diffusion coefficient is physically incorrect.\n2.  This \"negative diffusion\" model can make the effective diffusion coefficient negative, leading to an ill-posed anti-diffusion problem which is exponentially unstable.\n3.  It proposes zero-gradient boundary conditions at both ends, which is physically wrong for the edge at $r=a$.\n**Verdict: Incorrect**\n\n**E. Treat the inductive effect as a polarization current...**\nThis option is flawed because:\n1.  It fundamentally misidentifies the physics. The Ware pinch is a neoclassical drift effect proportional to $E_{\\phi}$, not a polarization current effect proportional to $\\partial E_{\\phi}/\\partial t$. These are distinct phenomena.\n2.  Moving the advective term to the source term $S$ without care can violate the conservative properties of the numerical scheme. While mathematically possible to write $\\partial_r(nv) = v\\partial_r n + n\\partial_r v$, shuffling terms between the flux divergence and the source requires great care and is not the standard or most transparent way to implement an advective flux. The proposed source is also physically incorrect.\n3.  The proposed boundary conditions (zero-gradient at both ends) are incorrect.\n**Verdict: Incorrect**\n\nBased on this detailed analysis, Option A is the only one that describes a physically consistent, numerically robust, and complete implementation strategy.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}