{
    "hands_on_practices": [
        {
            "introduction": "Understanding the fundamental driving force behind a physical phenomenon is the first step toward mastering it. This foundational exercise guides you through a first-principles derivation of the Ware pinch from the conservation of toroidal canonical momentum for trapped particles. By examining a hypothetical noninductive scenario where the toroidal electric field is zero, you will prove that the pinch velocity vanishes, thus cementing the direct causal link between inductive drive and this crucial transport mechanism .",
            "id": "4062546",
            "problem": "Consider a large-aspect-ratio, circular-cross-section, axisymmetric tokamak plasma operating in a fully noninductive regime sustained by externally applied Radio-Frequency (RF) current drive. In this scenario, diagnostics confirm that the toroidal electric field is identically zero, i.e., $E_{\\phi}(r,t) = 0$ for all radii $r$ and times $t$ during the interval of interest. Assume standard flux coordinates with poloidal magnetic flux $\\psi_{p}(r,t)$ labeling flux surfaces, a major radius $R$ independent of poloidal angle, and a poloidal magnetic field $B_{\\theta}(r)$ that is finite and smooth. Trapped-particle guiding-center motion is bounce-averaged, and the tokamak is strictly axisymmetric, so that toroidal canonical momentum conservation applies.\n\nStarting from first principles—specifically, Maxwell–Faraday’s law for induction, the definition of poloidal magnetic flux as a flux-surface label, and the relationship between the time evolution of $\\psi_{p}$ and radial motion $dr/dt$ required to remain on a given flux surface—derive the Ware pinch velocity $v_{W}(r,t)$ for trapped particles. Then compute the value of $v_{W}$ under the stated noninductive condition $E_{\\phi}=0$ and explain, within the same logical framework, why any observed central density peaking during this interval must be attributed to non-Ware mechanisms.\n\nYour final computed answer must be the value of $v_{W}$ in $\\mathrm{m/s}$ for the stated case. Express the final velocity in $\\mathrm{m/s}$. No numerical approximation is required.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, self-contained, and well-posed. The problem is a standard derivation in neoclassical transport theory within plasma physics, and all provided conditions are physically meaningful in the context of tokamak research. I will now proceed with the solution.\n\nThe derivation of the Ware pinch velocity begins with the conservation of toroidal canonical momentum, $P_{\\phi}$, for a charged particle in an axisymmetric magnetic field. The toroidal canonical momentum for a particle of charge $q$ and mass $m$ is given by:\n$$P_{\\phi} = m R v_{\\phi} + q \\psi_{p}$$\nwhere $R$ is the major radius, $v_{\\phi}$ is the particle's toroidal velocity, and $\\psi_{p}$ is the poloidal magnetic flux per radian of toroidal angle. The problem states that the tokamak is strictly axisymmetric, which ensures that $P_{\\phi}$ is a constant of motion for the guiding center. Thus, the total time derivative of $P_{\\phi}$ following the guiding center is zero:\n$$\\frac{d P_{\\phi}}{dt} = 0$$\n\nThe Ware pinch specifically describes the motion of trapped particles. A key characteristic of trapped particles is that they are confined in a magnetic well and oscillate between two bounce points. Their net toroidal motion, when averaged over a single bounce period, is zero. That is, the bounce-averaged toroidal velocity is $\\langle v_{\\phi} \\rangle = 0$.\n\nApplying the bounce-average operator to the conservation of $P_{\\phi}$ for a trapped particle, we get:\n$$\\frac{d \\langle P_{\\phi} \\rangle}{dt} = \\frac{d}{dt} \\langle m R v_{\\phi} + q \\psi_{p} \\rangle = 0$$\nSince $\\langle v_{\\phi} \\rangle = 0$ and $q$ is constant, and $\\psi_{p}$ is a macroscopic field quantity that varies slowly compared to the bounce time, we can approximate $\\langle q \\psi_{p} \\rangle \\approx q \\psi_{p}$. This yields:\n$$\\frac{d}{dt} (q \\psi_{p}) = 0 \\implies \\frac{d \\psi_{p}}{dt} = 0$$\nThis result signifies that the bounce-averaged guiding center of a trapped particle remains on a surface of constant poloidal flux $\\psi_{p}$.\n\nThe total time derivative of $\\psi_{p}(r,t)$ following the particle's guiding center, which has a radial velocity component $v_{r}$, is expressed as:\n$$\\frac{d \\psi_{p}}{dt} = \\frac{\\partial \\psi_{p}}{\\partial t} + v_{r} \\frac{\\partial \\psi_{p}}{\\partial r} = 0$$\nFrom this, we can solve for the radial drift velocity, which is the Ware pinch velocity $v_{W}$:\n$$v_{W} = v_{r} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}}$$\n\nNext, we relate the terms in this expression to the physical fields $E_{\\phi}$ and $B_{\\theta}$ using the principles specified in the problem statement.\n\nFirst, we use Maxwell's law of induction (Faraday's law), $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$. In integral form, for a toroidal loop of major radius $R$ at a fixed vertical position:\n$$\\oint \\mathbf{E} \\cdot d\\mathbf{l} = - \\frac{d}{dt} \\iint \\mathbf{B} \\cdot d\\mathbf{S}$$\nThe line integral on the left, taken along the toroidal loop, is $\\int_{0}^{2\\pi} E_{\\phi} R d\\phi$. Due to axisymmetry, $E_{\\phi}$ is constant along this path, so the integral evaluates to $2\\pi R E_{\\phi}$. The surface integral on the right is the time rate of change of the magnetic flux passing through the disk enclosed by the loop. This is, by definition, the poloidal magnetic flux, $\\Psi_{p}$. Thus:\n$$2\\pi R E_{\\phi} = - \\frac{\\partial \\Psi_{p}}{\\partial t}$$\nThe problem uses $\\psi_{p}$ as the flux-surface label, which conventionally is the poloidal flux per radian, $\\psi_{p} = \\Psi_{p} / (2\\pi)$. Substituting this gives:\n$$2\\pi R E_{\\phi} = - \\frac{\\partial (2\\pi \\psi_{p})}{\\partial t} = -2\\pi \\frac{\\partial \\psi_{p}}{\\partial t}$$\nThis simplifies to a fundamental relationship between the toroidal electric field and the time evolution of the poloidal flux function:\n$$E_{\\phi} = - \\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial t} \\implies \\frac{\\partial \\psi_{p}}{\\partial t} = -R E_{\\phi}$$\n\nSecond, we relate the radial gradient of $\\psi_{p}$ to the poloidal magnetic field $B_{\\theta}$. The poloidal magnetic field is derived from the poloidal flux function via $\\mathbf{B}_{p} = \\frac{1}{R} \\nabla \\psi_{p} \\times \\hat{\\phi}$. For the specified large-aspect-ratio, circular-cross-section geometry, we can use coordinates where $\\nabla \\psi_{p} = \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r}$. The poloidal field is $\\mathbf{B}_{p} = B_{\\theta} \\hat{\\theta}$. The unit vectors are related by $\\hat{\\theta} = \\hat{\\phi} \\times \\hat{r}$. Therefore:\n$$B_{\\theta} \\hat{\\theta} = \\frac{1}{R} \\left( \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r} \\right) \\times \\hat{\\phi} = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} (\\hat{\\phi} \\times \\hat{r}) = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{\\theta}$$\nComparing the components, we find:\n$$B_{\\theta} = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} \\implies \\frac{\\partial \\psi_{p}}{\\partial r} = -R B_{\\theta}$$\n\nNow, we substitute these two derived relationships back into the expression for $v_{W}$:\n$$v_{W} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}} = - \\frac{-R E_{\\phi}}{-R B_{\\theta}} = - \\frac{E_{\\phi}}{B_{\\theta}}$$\nThis is the general expression for the Ware pinch velocity, $v_{W}(r,t)$.\n\nThe problem now requires us to compute the value of $v_{W}$ under the specific condition of a fully noninductive regime where the toroidal electric field is identically zero, i.e., $E_{\\phi}(r, t) = 0$. The problem also states that the poloidal magnetic field $B_{\\theta}(r)$ is finite. Substituting the given condition into our derived formula:\n$$v_{W} = - \\frac{0}{B_{\\theta}} = 0$$\nThe Ware pinch velocity is identically zero everywhere in the plasma under the specified conditions.\n\nFinally, we must explain why any observed central density peaking must be attributed to non-Ware mechanisms. The Ware pinch is a neoclassical transport effect that drives an inward flux of trapped particles, proportional to $E_{\\phi}$. In a conventional inductively driven tokamak, $E_{\\phi}$ is non-zero and drives the toroidal current, and consequently, the Ware pinch contributes to density peaking at the plasma core. However, in the scenario described—a fully noninductive plasma with $E_{\\phi} = 0$—the driving force for the Ware pinch vanishes. As we have just calculated, $v_{W} = 0$. Therefore, the Ware pinch mechanism cannot transport any particles radially inward or outward, and it cannot be the cause of any observed density accumulation or peaking. Should experimental diagnostics confirm both $E_{\\phi} = 0$ and a centrally peaked density profile, it is a direct conclusion from this framework that other physical mechanisms must be responsible. Such mechanisms could include turbulent transport (e.g., an anomalous inward pinch driven by microinstabilities), other neoclassical effects (like the thermoelectric pinch), or core particle sources (like neutral beam fueling). The absence of an inductive electric field decouples particle transport from this specific neoclassical effect, forcing consideration of other transport channels to explain the observed plasma state.\n\nThe final computed value for the Ware pinch velocity $v_{W}$ in this noninductive case is $0 \\, \\mathrm{m/s}$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "After establishing that the Ware pinch is driven by the toroidal electric field, the next step is to quantify its impact on the plasma. This practice connects the abstract concept of a pinch velocity to a measurable outcome: the steady-state density profile. By combining Faraday's and Ampère's laws within a simplified transport model, you will calculate the density peaking factor, offering a tangible sense of how inductive transport shapes the plasma core .",
            "id": "3964879",
            "problem": "Consider an axisymmetric tokamak plasma modeled by a One-Dimensional (1D) reduced particle transport equation in cylindrical coordinates, with minor radius $a$ and major radius $R$. The transport model consists of a diffusive particle flux with constant diffusivity $D_0$ and a convective flux due to the neoclassical inductive pinch driven by the toroidal electric field. Assume a circular cross-section, large aspect ratio, and uniform toroidal current density. The toroidal electric field is maintained by an externally applied loop voltage. Work within the International System of Units (SI).\n\nStarting from fundamental laws, use Faraday's law to relate the toroidal electric field to the applied loop voltage, and use Ampère's law to estimate the flux-surface-averaged poloidal magnetic field at the plasma edge. Argue from the continuity equation and constitutive relations how the convective pinch modifies the steady-state density profile under the assumptions of no volumetric particle sources, a fixed edge density, and regularity at the magnetic axis.\n\nParameters:\n- Major radius: $R = 3.0\\,\\mathrm{m}$.\n- Minor radius: $a = 0.70\\,\\mathrm{m}$.\n- Total plasma current: $I_p = 1.8 \\times 10^6\\,\\mathrm{A}$.\n- Loop voltage: $V_{\\text{loop}} = 1.9\\,\\mathrm{V}$.\n- Constant particle diffusivity: $D_0 = 0.80\\,\\mathrm{m^2/s}$.\n- Magnetic permeability of free space: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n\nUsing these, compute the steady-state density peaking factor $n(0)/n(a)$ implied by the inductive pinch in this reduced model. Express the final answer as a dimensionless number, and round your answer to four significant figures.",
            "solution": "The problem is validated by following the specified procedure.\n\n### Step 1: Extract Givens\n-   **Model**: One-Dimensional (1D) reduced particle transport equation in cylindrical coordinates for an axisymmetric tokamak plasma.\n-   **Geometry**: Circular cross-section, large aspect ratio.\n-   **Minor Radius**: $a = 0.70\\,\\mathrm{m}$.\n-   **Major Radius**: $R = 3.0\\,\\mathrm{m}$.\n-   **Particle Flux**: Composed of a diffusive flux and a convective flux.\n-   **Diffusivity**: Constant particle diffusivity, $D_0 = 0.80\\,\\mathrm{m^2/s}$.\n-   **Convection**: Neoclassical inductive pinch driven by the toroidal electric field.\n-   **Current Profile**: Uniform toroidal current density.\n-   **Total Plasma Current**: $I_p = 1.8 \\times 10^6\\,\\mathrm{A}$.\n-   **Loop Voltage**: $V_{\\text{loop}} = 1.9\\,\\mathrm{V}$.\n-   **Magnetic Permeability**: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n-   **Assumptions**: Steady-state, no volumetric particle sources, fixed edge density $n(a)$, regularity at the magnetic axis ($r=0$).\n-   **Objective**: Compute the steady-state density peaking factor $n(0)/n(a)$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is firmly rooted in the principles of plasma physics and transport theory. It utilizes fundamental laws such as Faraday's law and Ampère's law, and the continuity equation. The concept of an inductive (Ware) pinch is a well-established neoclassical transport effect in tokamaks. The use of a 1D reduced model with simplifying assumptions (constant diffusivity, uniform current density) is a standard and valid approach for analytical estimation in fusion science.\n-   **Well-Posed**: The problem provides a differential equation (derived from the transport model) and a sufficient number of boundary conditions (fixed density at $r=a$ and regularity at $r=0$) to determine a unique solution for the density profile $n(r)$. All necessary physical parameters ($R$, $a$, $I_p$, $V_{\\text{loop}}$, $D_0$, $\\mu_0$) are given.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased technical language. It requires a specific calculation based on the provided model and data, with no room for subjective interpretation.\n\nThe problem does not exhibit any of the flaws listed in the instructions (e.g., scientific unsoundness, incompleteness, ambiguity). The one potential ambiguity—the treatment of the pinch velocity's singularity at the magnetic axis—is implicitly resolved by the instruction to \"estimate the flux-surface-averaged poloidal magnetic field at the plasma edge,\" which suggests a standard simplification used in reduced models to avoid this issue.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\nThe analysis begins with the particle continuity equation in cylindrical coordinates $(r, \\theta, \\phi)$, where $r$ is the minor radial coordinate. For an axisymmetric system with no poloidal or toroidal variation in density, the continuity equation is:\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\Gamma_r) = S\n$$\nwhere $n$ is the particle density, $\\Gamma_r$ is the radial particle flux, and $S$ is the particle source/sink term. The problem specifies a steady-state condition ($\\frac{\\partial n}{\\partial t}=0$) and no volumetric particle sources ($S=0$). The equation thus simplifies to:\n$$\n\\frac{d}{dr}(r\\Gamma_r) = 0\n$$\nIntegrating this equation with respect to $r$ yields $r\\Gamma_r = \\text{constant}$. The \"regularity at the magnetic axis\" condition requires that the particle flux $\\Gamma_r$ be finite at $r=0$. For the product $r\\Gamma_r$ to remain constant as $r \\to 0$, the constant must be zero. Therefore, the particle flux must be zero everywhere in the plasma for a source-free steady state:\n$$\n\\Gamma_r(r) = 0\n$$\nThe problem states that the particle flux consists of a diffusive and a convective component:\n$$\n\\Gamma_r(r) = -D_0 \\frac{dn}{dr} + n(r)v_r(r)\n$$\nwhere $D_0$ is the constant diffusivity and $v_r(r)$ is the convective pinch velocity. Setting the total flux to zero gives the balance between diffusion and convection:\n$$\nD_0 \\frac{dn}{dr} = n(r)v_r(r)\n$$\nThe convective velocity is the neoclassical inductive pinch (Ware pinch), given by $v_r = -E_\\phi/B_\\theta$, where $E_\\phi$ is the toroidal electric field and $B_\\theta$ is the poloidal magnetic field. The negative sign indicates an inward pinch (for standard sign conventions of $E_\\phi$ and $B_\\theta$).\n\nFirst, we relate the toroidal electric field $E_\\phi$ to the given loop voltage $V_{\\text{loop}}$ using Faraday's law of induction. For a loop of major radius $R$, the loop voltage is the line integral of the electric field around the torus:\n$$\nV_{\\text{loop}} = \\oint \\mathbf{E} \\cdot d\\mathbf{l} = E_\\phi (2\\pi R)\n$$\nAssuming a uniform toroidal electric field, we have:\n$$\nE_\\phi = \\frac{V_{\\text{loop}}}{2\\pi R}\n$$\nNext, we estimate the poloidal magnetic field $B_\\theta$. The problem directs us to use Ampère's law to estimate $B_\\theta$ at the plasma edge ($r=a$). Applying Ampère's law to a circular loop of radius $a$ enclosing the entire plasma current $I_p$:\n$$\n\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}} \\implies B_\\theta(a) (2\\pi a) = \\mu_0 I_p\n$$\nThis gives the poloidal magnetic field at the edge:\n$$\nB_\\theta(a) = \\frac{\\mu_0 I_p}{2\\pi a}\n$$\nIn a reduced 1D model, it is a common simplification to approximate the spatially varying pinch velocity with a constant value. We use the edge value of the poloidal field to define a characteristic, spatially-constant pinch velocity, $v_0$. This avoids the singularity in the pinch velocity $v_r \\propto 1/B_\\theta(r)$ that would arise at $r=0$ from the assumption of uniform current density (which implies $B_\\theta(r) \\propto r$).\n$$\nv_r \\approx v_0 = -\\frac{E_\\phi}{B_\\theta(a)} = -\\frac{V_{\\text{loop}}/(2\\pi R)}{\\mu_0 I_p/(2\\pi a)} = -\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\n$$\nNow we can substitute this constant pinch velocity $v_0$ into the flux balance equation:\n$$\nD_0 \\frac{dn}{dr} = n(r) v_0\n$$\nThis is a first-order, separable ordinary differential equation for the density profile $n(r)$:\n$$\n\\frac{dn}{n} = \\frac{v_0}{D_0} dr\n$$\nIntegrating both sides from the plasma edge $r=a$ to an arbitrary radius $r$ gives:\n$$\n\\int_{n(a)}^{n(r)} \\frac{dn'}{n'} = \\int_a^r \\frac{v_0}{D_0} dr' \\implies \\ln\\left(\\frac{n(r)}{n(a)}\\right) = \\frac{v_0}{D_0}(r-a)\n$$\nSolving for $n(r)$ yields the density profile:\n$$\nn(r) = n(a) \\exp\\left(\\frac{v_0}{D_0}(r-a)\\right)\n$$\nWe are asked to find the density peaking factor, which is the ratio of the central density $n(0)$ to the edge density $n(a)$. We evaluate the profile at $r=0$:\n$$\nn(0) = n(a) \\exp\\left(\\frac{v_0}{D_0}(0-a)\\right) = n(a) \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\nThe peaking factor is therefore:\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\nSubstituting the expression for $v_0$:\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\left(-\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\\right) \\frac{a}{D_0}\\right) = \\exp\\left(\\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0}\\right)\n$$\nThe exponent is a dimensionless quantity, often referred to as the pinch Peclet number. Let's compute its value using the given parameters:\n$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$\n$a = 0.70\\,\\mathrm{m}$\n$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$\n$R = 3.0\\,\\mathrm{m}$\n$D_0 = 0.80\\,\\mathrm{m^2/s}$\n\nThe exponent, let's call it $\\mathcal{S}$, is:\n$$\n\\mathcal{S} = \\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0} = \\frac{(1.9) \\times (0.70)^2}{(4\\pi \\times 10^{-7}) \\times (1.8 \\times 10^6) \\times (3.0) \\times (0.80)}\n$$\n$$\n\\mathcal{S} = \\frac{1.9 \\times 0.49}{4\\pi \\times 1.8 \\times 3.0 \\times 0.80 \\times 10^{-1}} = \\frac{0.931}{5.42867\\ldots}\n$$\n$$\n\\mathcal{S} \\approx 0.17150\n$$\nThe density peaking factor is then:\n$$\n\\frac{n(0)}{n(a)} = \\exp(\\mathcal{S}) = \\exp(0.17150) \\approx 1.187112\n$$\nRounding the result to four significant figures gives $1.187$.",
            "answer": "$$\n\\boxed{1.187}\n$$"
        },
        {
            "introduction": "Moving from simplified models to more realistic scenarios requires accounting for the spatial variation of plasma parameters. The Ware pinch velocity is not uniform; it changes with radius, primarily due to the structure of the poloidal magnetic field. This computational exercise challenges you to calculate the full radial profile of the Ware pinch velocity, $v_W(r)$, using a given safety factor profile, $q(r)$, and to explore the impact of model uncertainties . This practice is a direct step towards building predictive transport simulations.",
            "id": "4062613",
            "problem": "Consider a large-aspect-ratio, axisymmetric tokamak with major radius $R_0$, minor radius $a$, toroidal magnetic field $B_{\\phi}$, and measured loop voltage $V_{\\text{loop}}$. The toroidal electric field $E_{\\phi}(r)$ is induced by transformer action and is related to the loop voltage by Faraday's law of electromagnetic induction. The safety factor profile $q(r)$ is provided by magnetics. The goal is to compute a radial profile of the Ware pinch velocity $v_W(r)$ for trapped particles under a simplified neoclassical model, and to quantify uncertainties arising from geometric averaging.\n\nUse the following fundamental bases and definitions:\n- Faraday's law of electromagnetic induction: \n$$\\oint \\mathbf{E} \\cdot d\\mathbf{l} = - \\frac{d}{dt}\\int \\mathbf{B} \\cdot d\\mathbf{S}.$$\nAssume a steady inductive drive with measured loop voltage $V_{\\text{loop}}$ such that the toroidal electric field magnitude is \n$$E_{\\phi}(r) = \\frac{V_{\\text{loop}}}{2\\pi R_0}.$$\nTreat $E_{\\phi}$ as uniform on a flux surface due to the large aspect ratio approximation.\n- Definition of the safety factor:\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)},$$\nwhich implies\n$$B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}.$$\n- Under a simplified neoclassical trapped-particle model in a circular, large-aspect-ratio tokamak, the Ware pinch velocity can be expressed as\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon), \\quad \\varepsilon \\equiv \\frac{r}{R_0},$$\nwhere $G(\\varepsilon)$ is a geometric factor capturing the fraction of trapped particles and bounce-averaged drift projection. In a circular cross-section, large-aspect-ratio approximation, the trapped fraction scales as $f_t \\propto \\sqrt{\\varepsilon}$; thus take\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon},$$\nwhere $\\kappa$ is an uncertainty coefficient reflecting geometric averaging, shaping, and bounce-averaging approximations. For uncertainty quantification, use bounds $\\kappa_{\\min}$ and $\\kappa_{\\max}$ to compute lower and upper estimates:\n$$v_W^{\\text{low}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\min} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{nom}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\text{nom}} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{high}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\max} \\sqrt{\\varepsilon}.$$\n\nAssume the safety factor is provided by a functional form\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n,$$\nwith exponent $n$ specified per case. The program must evaluate $v_W(r)$ at specified radial points $r_i$.\n\nAll velocities must be reported in $\\mathrm{m/s}$.\n\nImplement a program that, for each test case below, computes three lists over the provided radial grid: the nominal Ware pinch velocities $v_W^{\\text{nom}}(r_i)$, the lower-bound velocities $v_W^{\\text{low}}(r_i)$, and the upper-bound velocities $v_W^{\\text{high}}(r_i)$. Aggregate the results of all test cases into a single line of output containing the concatenated lists for each case in the following order: for each case, first list $v_W^{\\text{nom}}(r_i)$ for all $r_i$, then $v_W^{\\text{low}}(r_i)$ for all $r_i$, then $v_W^{\\text{high}}(r_i)$ for all $r_i$. The final output must be a single line containing a comma-separated list of floats enclosed in square brackets.\n\nTest suite:\n- Case $1$ (happy path, moderate parameters):\n    - $R_0 = 3.0\\,\\mathrm{m}$, $a = 1.0\\,\\mathrm{m}$, $B_{\\phi} = 5.3\\,\\mathrm{T}$, $V_{\\text{loop}} = 1.2\\,\\mathrm{V}$,\n    - $q_0 = 1.0$, $\\alpha = 1.8$, $n = 2$,\n    - $\\kappa_{\\min} = 0.9$, $\\kappa_{\\text{nom}} = 1.1$, $\\kappa_{\\max} = 1.3$,\n    - radial points $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$.\n- Case $2$ (edge case: vanishing inductive drive):\n    - $R_0 = 3.0\\,\\mathrm{m}$, $a = 1.0\\,\\mathrm{m}$, $B_{\\phi} = 5.3\\,\\mathrm{T}$, $V_{\\text{loop}} = 0.0\\,\\mathrm{V}$,\n    - $q_0 = 1.0$, $\\alpha = 1.8$, $n = 2$,\n    - $\\kappa_{\\min} = 0.8$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.2$,\n    - radial points $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$.\n- Case $3$ (boundary coverage near magnetic axis and stronger shaping):\n    - $R_0 = 6.0\\,\\mathrm{m}$, $a = 2.0\\,\\mathrm{m}$, $B_{\\phi} = 2.5\\,\\mathrm{T}$, $V_{\\text{loop}} = 2.0\\,\\mathrm{V}$,\n    - $q_0 = 0.9$, $\\alpha = 3.0$, $n = 2$,\n    - $\\kappa_{\\min} = 0.7$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.5$,\n    - radial points $r_i \\in \\{0.05 a, 0.2 a, 0.4 a, 0.6 a, 0.8 a, 0.95 a\\}$.\n- Case $4$ (profile sensitivity: flatter $q(r)$ with quartic variation):\n    - $R_0 = 3.5\\,\\mathrm{m}$, $a = 0.8\\,\\mathrm{m}$, $B_{\\phi} = 4.0\\,\\mathrm{T}$, $V_{\\text{loop}} = 0.5\\,\\mathrm{V}$,\n    - $q_0 = 1.2$, $\\alpha = 0.5$, $n = 4$,\n    - $\\kappa_{\\min} = 0.85$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.25$,\n    - radial points $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, list $N$ nominal values $[v_W^{\\text{nom}}(r_1), \\ldots, v_W^{\\text{nom}}(r_N)]$, then $N$ lower-bound values $[v_W^{\\text{low}}(r_1), \\ldots, v_W^{\\text{low}}(r_N)]$, then $N$ upper-bound values $[v_W^{\\text{high}}(r_1), \\ldots, v_W^{\\text{high}}(r_N)]$, and concatenate these sequences for all cases into a single bracketed list. All velocities must be in $\\mathrm{m/s}$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of neoclassical transport in tokamak plasmas, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. The provided model, while simplified, represents a standard textbook-level description of the Ware pinch effect. All parameters are physically reasonable, and no internal contradictions or ambiguities are present.\n\nThe objective is to compute the Ware pinch velocity profile, $v_W(r)$, at a set of specified radial coordinates $r_i$. The derivation begins with the provided definition of the Ware pinch velocity in a simplified large-aspect-ratio, circular tokamak model:\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon)$$\nwhere $E_{\\phi}(r)$ is the toroidal electric field, $B_{\\theta}(r)$ is the poloidal magnetic field, and $G(\\varepsilon)$ is a geometric factor related to the fraction of trapped particles. The inverse aspect ratio is defined as $\\varepsilon \\equiv r/R_0$.\n\nThe problem specifies the forms for each term in this equation. We will substitute them systematically to derive a final computational formula.\n\nFirst, the geometric factor $G(\\varepsilon)$ is given as:\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon} = \\kappa \\sqrt{\\frac{r}{R_0}}$$\nHere, $\\kappa$ is an uncertainty coefficient.\n\nSecond, the toroidal electric field $E_{\\phi}(r)$ is assumed to be spatially uniform due to the large-aspect-ratio approximation and is related to the loop voltage $V_{\\text{loop}}$ by Faraday's law:\n$$E_{\\phi}(r) = E_{\\phi} = \\frac{V_{\\text{loop}}}{2\\pi R_0}$$\n\nThird, the poloidal magnetic field $B_{\\theta}(r)$ is derived from the definition of the safety factor $q(r)$:\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)} \\implies B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}$$\n\nSubstituting these three expressions into the initial equation for $v_W(r)$:\n$$v_W(r) = - \\frac{\\left( \\frac{V_{\\text{loop}}}{2\\pi R_0} \\right)}{\\left( \\frac{r B_{\\phi}}{R_0 q(r)} \\right)} \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\nThis expression can be algebraically simplified. The major radius $R_0$ in the numerator and denominator of the main fraction cancels:\n$$v_W(r) = - \\left( \\frac{V_{\\text{loop}}}{2\\pi} \\right) \\left( \\frac{q(r)}{r B_{\\phi}} \\right) \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\nCombining terms and isolating the radial dependence:\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{r} \\sqrt{r} = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{\\sqrt{r}}$$\nIt is crucial to verify the physical units of this expression. With $V_{\\text{loop}}$ in Volts (V), $B_{\\phi}$ in Tesla ($T = V \\cdot s \\cdot m^{-2}$), and lengths ($R_0, r$) in meters (m), the resulting unit is $\\mathrm{m/s}$, which is correct for a velocity.\n\nThe final piece is the functional form of the safety factor profile, $q(r)$:\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n$$\nSubstituting this into our simplified expression for $v_W(r)$ gives the complete formula for computation:\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{1}{\\sqrt{r}} \\left[ q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n \\right]$$\nThis formula is valid for $r > 0$. The problem statement provides radial points $r_i$ that are all strictly positive, thus avoiding the singularity at $r=0$.\n\nFor uncertainty quantification, we compute three velocity profiles by substituting the three given values of $\\kappa$: $\\kappa_{\\min}$, $\\kappa_{\\text{nom}}$, and $\\kappa_{\\max}$. This yields $v_W^{\\text{low}}(r)$, $v_W^{\\text{nom}}(r)$, and $v_W^{\\text{high}}(r)$, respectively.\n\nThe algorithmic implementation proceeds as follows:\n1.  A function is defined to handle the calculation for a single test case. This function takes all physical and profile parameters as input.\n2.  For each case, the radial grid points $r_i$ are first computed from the minor radius $a$ and the provided fractional radii.\n3.  The calculation is vectorized over the array of radial points $r_i$ for efficiency. The term $q(r_i)$ is computed for all $r_i$.\n4.  The main formula is then evaluated for each of the three $\\kappa$ values, producing three arrays corresponding to the nominal, lower-bound, and upper-bound velocity profiles.\n5.  A main script defines the four test cases as a structured collection of parameters. It iterates through each case, calls the calculation function, and aggregates the results.\n6.  The final output is constructed by concatenating the results for each case in the specified order: the list of nominal velocities, followed by the list of lower-bound velocities, and then the list of upper-bound velocities. This sequence is repeated for all test cases, and the combined list is formatted into a single comma-separated string enclosed in square brackets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Ware pinch velocity profile across multiple test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, moderate parameters)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 1.2,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.9, \"k_nom\": 1.1, \"k_max\": 1.3,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 2 (edge case: vanishing inductive drive)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 0.0,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.8, \"k_nom\": 1.0, \"k_max\": 1.2,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 3 (boundary coverage near magnetic axis and stronger shaping)\n        {\n            \"R0\": 6.0, \"a\": 2.0, \"B_phi\": 2.5, \"V_loop\": 2.0,\n            \"q0\": 0.9, \"alpha\": 3.0, \"n\": 2,\n            \"k_min\": 0.7, \"k_nom\": 1.0, \"k_max\": 1.5,\n            \"r_fractions\": np.array([0.05, 0.2, 0.4, 0.6, 0.8, 0.95]),\n        },\n        # Case 4 (profile sensitivity: flatter q(r) with quartic variation)\n        {\n            \"R0\": 3.5, \"a\": 0.8, \"B_phi\": 4.0, \"V_loop\": 0.5,\n            \"q0\": 1.2, \"alpha\": 0.5, \"n\": 4,\n            \"k_min\": 0.85, \"k_nom\": 1.0, \"k_max\": 1.25,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        B_phi = case[\"B_phi\"]\n        V_loop = case[\"V_loop\"]\n        q0 = case[\"q0\"]\n        alpha = case[\"alpha\"]\n        n = case[\"n\"]\n        k_values = {\"nom\": case[\"k_nom\"], \"low\": case[\"k_min\"], \"high\": case[\"k_max\"]}\n        r_fractions = case[\"r_fractions\"]\n\n        # Calculate radial grid in meters\n        r = r_fractions * a\n\n        # Handle the V_loop = 0 case to avoid unnecessary calculations and potential 0/0 issues if r=0 were allowed\n        if V_loop == 0.0:\n            num_points = len(r)\n            v_w_nom = np.zeros(num_points)\n            v_w_low = np.zeros(num_points)\n            v_w_high = np.zeros(num_points)\n        else:\n            # Calculate the safety factor profile q(r)\n            q_r = q0 + alpha * (r / a)**n\n\n            # Calculate the Ware pinch velocity v_W(r)\n            # v_W(r) = - (V_loop * k) / (2 * pi * B_phi * sqrt(R0)) * q(r) / sqrt(r)\n            constant_factor = -V_loop / (2.0 * np.pi * B_phi * np.sqrt(R0))\n            radial_dependent_factor = q_r / np.sqrt(r)\n            \n            # Note: np.sqrt(r) is safe as all r > 0 in test cases.\n            \n            v_w_nom = constant_factor * k_values[\"nom\"] * radial_dependent_factor\n            v_w_low = constant_factor * k_values[\"low\"] * radial_dependent_factor\n            v_w_high = constant_factor * k_values[\"high\"] * radial_dependent_factor\n\n        # Append results in the specified order: nom, low, high\n        all_results.extend(v_w_nom.tolist())\n        all_results.extend(v_w_low.tolist())\n        all_results.extend(v_w_high.tolist())\n\n    # Format output as a single comma-separated list of floats in brackets\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}