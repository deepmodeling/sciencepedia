{
    "hands_on_practices": [
        {
            "introduction": "在深入研究波纹如何影响粒子输运之前，我们首先需要一个精确描述环向场波纹自身的物理模型。波纹幅度 $\\delta$ 在托卡马克中并非均匀分布，它通常在等离子体芯部很小，并向边缘急剧增大。这个实践练习将指导你从基本的真空磁静力学原理出发，推导出一个描述波纹幅度 $\\delta$ 空间分布的解析模型，并将其与来自真实托卡马克装置（如 JET 和 JT-60U）的测量数据进行比较，从而将理论与计算实践和实验观测紧密联系起来。",
            "id": "4041617",
            "problem": "你的任务是从第一性原理出发，为托卡马克中的环向场波纹振幅剖面构建一个计算模型，并与两个装置——欧洲联合环 (JET) 和日本托卡马克60升级版 (JT-60U)——的代表性测量剖面进行基准比较。波纹振幅是由于环向场线圈数量离散而引起的环向磁场的相对变化，并且观测到它朝向等离子体边缘方向增加。此比较必须作为归一化小半径 $r/a$ 的函数进行，其中 $r$ 是小半径，$a$ 是等离子体边界处的小半径。\n\n从真空中的静磁学出发，援引分析区域内无电流情况下的麦克斯韦方程组，即 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = \\mathbf{0}$，这允许我们引入一个满足拉普拉斯方程 $\\nabla^2 \\Phi = 0$ 的磁标势 $\\Phi$。将环向装置建模为一个半径为 $a$ 的局部圆柱域，并将由 $N_{\\mathrm{TF}}$ 个离散环向场线圈施加的环向周期性近似为环向上的谐波边界条件，该条件由一个有效轴向波数表征。需认识到，在这种圆柱近似中，径向依赖关系的解是通过变量分离法得到的，并且涉及修正贝塞尔函数。使用此框架推导波纹振幅剖面 $\\delta(r/a)$ 的无量纲模型，该模型依赖于 $N_{\\mathrm{TF}}$、大半径 $R_0$ 和小半径 $a$，并且在 $r/a = 1$ 处能够恢复给定的边缘波纹振幅。\n\n你将获得两个装置（JET 和 JT-60U）的测量波纹振幅数据，其作为 $r/a$ 的函数。将这些测量值视为已发表行为的代表性数字化结果，并用它们来定量评估你的模型。你必须：\n\n1. 在上述圆柱真空近似下，推导波纹振幅 $\\delta(r/a)$ 的模型表达式。\n2. 在代码中实现推导出的表达式，以计算每个装置在给定 $r/a$ 点的预测波纹振幅剖面。\n3. 计算每个装置的模型预测值与测量值之间的均方根误差 (RMSE) 和最大绝对误差。\n4. 通过检查 RMSE 是否低于特定装置的容差，来确定模型是否对每个装置“通过”。\n\n所有长度必须以米表示。波纹振幅是无量纲的。角度不直接出现在计算中，因此不需要指定角度单位。归一化半径 $r/a$ 是无量纲的。\n\n使用以下装置参数和测量数据的测试套件：\n\n- 装置 1 (JET):\n    - $N_{\\mathrm{TF}} = 32$, $R_0 = 2.96\\,\\mathrm{m}$, $a = 1.25\\,\\mathrm{m}$。\n    - 边缘波纹振幅参数 $\\delta_a = 0.0065$ (无量纲)。\n    - $r/a$ 点：$[0.0, 0.2, 0.4, 0.6, 0.8, 0.95]$。\n    - 在这些点测量的 $\\delta$：$[0.00005, 0.00030, 0.00090, 0.00210, 0.00460, 0.00580]$。\n    - RMSE 容差：$0.0015$。\n- 装置 2 (JT-60U):\n    - $N_{\\mathrm{TF}} = 18$, $R_0 = 3.00\\,\\mathrm{m}$, $a = 1.00\\,\\mathrm{m}$。\n    - 边缘波纹振幅参数 $\\delta_a = 0.0160$ (无量纲)。\n    - $r/a$ 点：$[0.0, 0.2, 0.4, 0.6, 0.8, 0.95]$。\n    - 在这些点测量的 $\\delta$：$[0.00020, 0.00080, 0.00250, 0.00650, 0.01200, 0.01450]$。\n    - RMSE 容差：$0.0030$。\n- 装置 3 (SymmTok, 合成的理想化对称参考):\n    - $N_{\\mathrm{TF}} = 360$, $R_0 = 3.00\\,\\mathrm{m}$, $a = 1.00\\,\\mathrm{m}$。\n    - 边缘波纹振幅参数 $\\delta_a = 0.0000$ (无量纲)。\n    - $r/a$ 点：$[0.0, 0.25, 0.50, 0.75, 1.00]$。\n    - 在这些点测量的 $\\delta$：$[0.0, 0.0, 0.0, 0.0, 0.0]$。\n    - RMSE 容差：$1\\times 10^{-12}$。\n\n你的程序必须为每个装置计算 RMSE 和最大绝对误差，然后使用指定的容差评估布尔值的通过/失败。最终的程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表，按以下顺序包含九个条目：\n$[$JET 的 RMSE$, $JT\\text{-}60\\mathrm{U} 的 RMSE$, $SymmTok 的 RMSE$, $JET 的最大误差$, $JT\\text{-}60\\mathrm{U} 的最大误差$, $SymmTok 的最大误差$, $JET 是否通过$, $JT\\text{-}60\\mathrm{U} 是否通过$, $SymmTok 是否通过$]$。\n\n所有数值输出必须是原始浮点数和布尔值。不应打印任何附加文本。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[$结果1$, $结果2$, $结果3$]$）。",
            "solution": "该问题被评估为有效的，因为它在静磁学方面有科学依据，提法恰当，具有充分且一致的数据，并且表述客观。解决方案首先推导环向场波纹振幅的理论模型，然后通过计算实现该模型来分析所提供的数据。\n\n### 1. 波纹振幅模型的推导\n\n推导从指定的无源区静磁学基本原理开始。在等离子体体积内，我们假设一个无电流的真空场，因此麦克斯韦方程组简化为 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = \\mathbf{0}$。磁场 $\\mathbf{B}$ 的无旋条件允许我们定义一个磁标势 $\\Phi$，使得 $\\mathbf{B} = -\\nabla \\Phi$。将其代入无散条件，即可得到势的拉普拉斯方程：\n$$ \\nabla^2 \\Phi = 0 $$\n问题指示我们将环形等离子体建模为局部圆柱域。我们使用圆柱坐标 $(r, \\theta, z)$，其中 $r$ 是小半径，$\\theta$ 是角向角，$z$ 代表环向。波纹是一种随小半径 $r$ 和环向坐标 $z$ 变化的扰动，但对于这个简化模型，可以假设它与角向角 $\\theta$ 无关（即 $\\partial/\\partial\\theta = 0$）。在这些坐标系下拉普拉斯算子简化为：\n$$ \\nabla^2 \\Phi = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\Phi}{\\partial r} \\right) + \\frac{\\partial^2 \\Phi}{\\partial z^2} = 0 $$\n我们使用变量分离法寻求波纹势 $\\Phi(r, z)$ 的解，假设解的形式为 $\\Phi(r, z) = R(r)Z(z)$。将其代入方程并分离变量可得：\n$$ \\frac{1}{r R(r)} \\frac{d}{dr} \\left( r \\frac{dR}{dr} \\right) = -\\frac{1}{Z(z)} \\frac{d^2 Z}{dz^2} = k^2 $$\n其中 $k^2$ 是分离常数。\n\n轴向方程为：\n$$ \\frac{d^2 Z}{dz^2} + k^2 Z = 0 $$\n波纹是由分布在近似为 $2\\pi R_0$ 的环向周长上的 $N_{\\mathrm{TF}}$ 个离散环向场线圈引起的。这对场施加了周期性。该周期结构在环向上的基本波长为 $\\lambda_z = 2\\pi R_0 / N_{\\mathrm{TF}}$。相应的波数为 $k = 2\\pi/\\lambda_z = N_{\\mathrm{TF}}/R_0$。$Z(z)$ 的解是一个谐波函数，我们可以写成 $Z(z) \\propto \\cos(kz)$。\n\n径向方程为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR}{dr} \\right) - k^2 R(r) = 0 $$\n乘以 $r^2$ 得到标准的零阶修正贝塞尔方程：\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} - (kr)^2 R = 0 $$\n通解是第一类 ($I_0$) 和第二类 ($K_0$) 修正贝塞尔函数的线性组合：\n$$ R(r) = C_1 I_0(kr) + C_2 K_0(kr) $$\n为使解在等离子体柱 ($0 \\le r \\le a$) 内物理有效，它必须在轴心 ($r=0$) 处保持有限。函数 $K_0(x)$ 在 $x \\to 0$ 时发散，而 $I_0(x)$ 是有限的 ($I_0(0)=1$)。因此，我们必须设 $C_2=0$，径向解为 $R(r) \\propto I_0(kr)$。\n\n结合径向和轴向解，波纹势具有以下形式：\n$$ \\Phi(r, z) = C \\cdot I_0(kr) \\cos(kz) $$\n其中 $C$ 是一个常数。波纹是环向磁场的变化，在此坐标系中即为 $z$ 分量 $B_z$。波纹场 $\\tilde{B}_z$ 是随 $z$ 变化的部分：\n$$ \\tilde{B}_z = -\\frac{\\partial \\Phi}{\\partial z} = C k I_0(kr) \\sin(kz) $$\n总环向场为 $B_z(r, z) = B_{z,\\text{avg}}(r) + \\tilde{B}_z(r, z)$。波纹振幅 $\\delta$ 定义为相对变化：\n$$ \\delta(r) = \\frac{B_{z,\\max}(r) - B_{z,\\min}(r)}{B_{z,\\max}(r) + B_{z,\\min}(r)} $$\n在给定半径 $r$ 处的最大和最小场出现在 $\\sin(kz) = \\pm 1$ 时。因此，$B_{z,\\max/min} = B_{z,\\text{avg}} \\pm C k I_0(kr)$。将这些代入 $\\delta$ 的定义中可得：\n$$ \\delta(r) = \\frac{(B_{z,\\text{avg}} + C k I_0(kr)) - (B_{z,\\text{avg}} - C k I_0(kr))}{(B_{z,\\text{avg}} + C k I_0(kr)) + (B_{z,\\text{avg}} - C k I_0(kr))} = \\frac{2 C k I_0(kr)}{2 B_{z,\\text{avg}}} \\propto I_0(kr) $$\n在小半径 $r$ 处的波纹振幅与 $I_0(kr)$ 成正比。我们将其写为 $\\delta(r) = C' I_0(kr)$。\n比例常数 $C'$ 由所提供的边界条件决定：在等离子体边缘 ($r=a$)，波纹为 $\\delta(a) = \\delta_a$。\n$$ \\delta_a = C' I_0(ka) \\implies C' = \\frac{\\delta_a}{I_0(ka)} $$\n将 $C'$ 代回，得到波纹剖面的最终模型：\n$$ \\delta(r) = \\delta_a \\frac{I_0(kr)}{I_0(ka)} $$\n最后，我们用给定的参数和归一化小半径 $\\rho = r/a$ 来表示。当 $k = N_{\\mathrm{TF}}/R_0$ 且 $r = \\rho a$ 时，贝塞尔函数的自变量变为 $kr = (\\frac{N_{\\mathrm{TF}}}{R_0})(\\rho a) = \\rho \\frac{N_{\\mathrm{TF}}a}{R_0}$。要实现的推导模型是：\n$$ \\delta(\\rho) = \\delta_a \\frac{I_0(\\rho \\cdot N_{\\mathrm{TF}}a/R_0)}{I_0(N_{\\mathrm{TF}}a/R_0)} $$\n\n### 2. 计算实现与误差分析\n\n推导出的公式在一个 Python 脚本中实现。对于每个装置，我们执行以下步骤：\n1.  定义装置参数：线圈数 $N_{\\mathrm{TF}}$、大半径 $R_0$、小半径 $a$ 和边缘波纹 $\\delta_a$。\n2.  计算贝塞尔函数在边缘处的无量纲常数自变量 $\\alpha = N_{\\mathrm{TF}}a/R_0$。\n3.  对于每个给定的归一化半径点 $\\rho_i = (r/a)_i$，使用模型计算预测的波纹振幅 $\\delta_{\\text{pred},i}$：$\\delta_{\\text{pred},i} = \\delta_a \\cdot I_0(\\rho_i \\alpha) / I_0(\\alpha)$。使用函数 `scipy.special.i0` 来计算修正贝塞尔函数 $I_0(x)$。\n4.  对于 $\\delta_a=0$ 的 SymmTok 特殊情况直接处理，得到处处为 0 的预测波纹，这符合预期。\n5.  利用预测值数组 $\\delta_{\\text{pred}}$ 和测量值数组 $\\delta_{\\text{meas}}$，计算误差。\n6.  均方根误差 (RMSE) 计算公式为 $\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\delta_{\\text{pred},i} - \\delta_{\\text{meas},i})^2}$，其中 $N$ 是数据点的数量。\n7.  最大绝对误差计算为 $\\max_i |\\delta_{\\text{pred},i} - \\delta_{\\text{meas},i}|$。\n8.  通过将计算出的 RMSE 与指定的设备特定容差进行比较来确定布尔值的通过/失败状态：`pass = RMSE  rmse_tolerance`。\n将所有三个装置的结果收集并按要求格式化为单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes ripple amplitude profiles for tokamaks based on a cylindrical model,\n    and benchmarks them against measured data.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"JET\",\n            \"N_TF\": 32,\n            \"R0\": 2.96,\n            \"a\": 1.25,\n            \"delta_a\": 0.0065,\n            \"rho_points\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 0.95]),\n            \"delta_measured\": np.array([0.00005, 0.00030, 0.00090, 0.00210, 0.00460, 0.00580]),\n            \"rmse_tolerance\": 0.0015\n        },\n        {\n            \"name\": \"JT-60U\",\n            \"N_TF\": 18,\n            \"R0\": 3.00,\n            \"a\": 1.00,\n            \"delta_a\": 0.0160,\n            \"rho_points\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 0.95]),\n            \"delta_measured\": np.array([0.00020, 0.00080, 0.00250, 0.00650, 0.01200, 0.01450]),\n            \"rmse_tolerance\": 0.0030\n        },\n        {\n            \"name\": \"SymmTok\",\n            \"N_TF\": 360,\n            \"R0\": 3.00,\n            \"a\": 1.00,\n            \"delta_a\": 0.0,\n            \"rho_points\": np.array([0.0, 0.25, 0.50, 0.75, 1.00]),\n            \"delta_measured\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"rmse_tolerance\": 1e-12\n        }\n    ]\n\n    results_rmse = []\n    results_max_err = []\n    results_pass_fail = []\n\n    for case in test_cases:\n        # Unpack data for the current device\n        N_TF = case[\"N_TF\"]\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        delta_a = case[\"delta_a\"]\n        rho_points = case[\"rho_points\"]\n        delta_measured = case[\"delta_measured\"]\n        rmse_tolerance = case[\"rmse_tolerance\"]\n\n        # The derived model is delta(rho) = delta_a * I_0(rho * alpha) / I_0(alpha)\n        # where alpha = N_TF * a / R0\n        \n        # Handle the trivial case where edge ripple is zero to avoid division by zero\n        # if I_0(alpha) becomes huge and delta_a is zero.\n        if delta_a == 0.0:\n            delta_predicted = np.zeros_like(rho_points)\n        else:\n            # Dimensionless argument for the Bessel function\n            alpha = (N_TF * a) / R0\n            \n            # The value of I_0 at the edge (r=a, so rho=1)\n            I0_at_a = i0(alpha)\n            \n            # Arguments for I_0 at each evaluation point\n            bessel_args = rho_points * alpha\n            \n            # Values of I_0 at each evaluation point\n            I0_at_r = i0(bessel_args)\n            \n            # Calculate the predicted ripple profile\n            delta_predicted = delta_a * I0_at_r / I0_at_a\n\n        # Calculate errors\n        errors = delta_predicted - delta_measured\n        \n        # Calculate Root-Mean-Square Error (RMSE)\n        rmse = np.sqrt(np.mean(np.square(errors)))\n        \n        # Calculate Maximum Absolute Error\n        max_abs_error = np.max(np.abs(errors))\n        \n        # Determine if the model passes based on the RMSE tolerance\n        is_pass = rmse  rmse_tolerance\n\n        # Store results\n        results_rmse.append(rmse)\n        results_max_err.append(max_abs_error)\n        results_pass_fail.append(is_pass)\n    \n    # Combine all results into a single list as per the problem specification\n    final_results = results_rmse + results_max_err + results_pass_fail\n    \n    # Format the final output string exactly as required\n    output_string = f\"[{','.join(map(str, final_results))}]\"\n\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "建立了环向场波纹的物理模型后，下一步是理解它如何影响单个带电粒子的运动轨迹。由波纹场的非轴对称性引起的 $\\nabla B$ 漂移是导致径向输运的关键微观机制。这个练习将引导你在 Boozer 坐标系下，通过详细的解析计算，推导出由波纹场梯度直接引起的粒子径向漂移速度，这是进行理论输运分析所必备的一项核心技能。",
            "id": "4041646",
            "problem": "考虑一个大环径比、圆形截面的托卡马克，其大半径为 $R_0$，小半径为 $r$，嵌入在柱坐标系 $(R,\\phi,Z)$ 中，具有标准映射 $R = R_0 + r \\cos\\theta$ 和 $Z = r \\sin\\theta$，其中 $\\theta$ 是几何极向角。在 Boozer 坐标系 $(\\psi,\\theta,\\phi_B)$ 中进行计算，其中 Boozer 环向角 $\\phi_B$ 与几何环向角 $\\phi$ 在 $r/R_0$ 的主导阶上是对齐的，并且极向磁通标签 $\\psi$ 通过 $\\psi = \\frac{1}{2} B_0 R_0 r^2$ 与小半径相关，其中 $B_0$ 是轴上环向磁场。假设安全因子 $q_s$ 在磁通面上是常数。磁场强度由一个占主导地位的环向场和一个由环向曲率引起的极向变化以及由有限数量 $N$ 的环向场（TF）线圈引起的微小环向场波纹来建模：\n$$\nB(R,\\theta,\\phi_B) \\approx \\frac{B_0 R_0}{R}\\left(1 + \\delta \\cos(N\\phi_B)\\right),\n$$\n其中 $0  \\delta \\ll 1$，角度以弧度为单位。在小参数 $\\delta$ 和 $r/R_0$ 的主导阶上进行一致的计算，忽略所有小参数的乘积。\n\n任务：\n1. 使用上述几何映射和 $\\psi$ 的磁通-半径关系，计算 Boozer 坐标系 $(\\psi,\\theta,\\phi_B)$ 中度规张量系数 $g_{ij}$ 到 $r/R_0$ 的主导阶。明确写出非零分量。\n2. 从正交曲线坐标系中的微分几何第一性原理出发，构建在与 $(\\psi,\\theta,\\phi_B)$ 对齐的正交归一基中的梯度 $\\nabla B$ 到主导阶，并识别出由极向变化和环向波纹产生的分量。\n3. 使用梯度B漂移的导心理论，其中梯度B漂移速度为\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B,\n$$\n其中 $\\mu$ 是磁矩，$q_p$ 是粒子电荷，确定在低场侧中平面（$\\theta=0$）和波纹引起梯度最大的环向位置（$N\\phi_B = \\frac{\\pi}{2}$）处的径向分量 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B}\\cdot \\hat{\\mathbf{e}}_r$。将磁场矢量在主导阶上建模为 $\\mathbf{B} \\approx B_\\phi \\,\\hat{\\mathbf{e}}_\\phi + B_\\theta \\,\\hat{\\mathbf{e}}_\\theta$，其中 $B_\\phi \\approx B_0$ 和 $B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$，并在计算点使用 $R \\approx R_0$ 和 $B \\approx B_0$。用米/秒表示最终的径向漂移速度。\n你的最终答案必须是一个单一的闭式解析表达式。不需要进行数值计算。",
            "solution": "首先对问题进行验证，以确保其科学上合理、良定且客观。\n\n### 步骤1：提取已知条件\n- 托卡马克几何：大环径比、圆形截面。\n- 大半径：$R_0$。\n- 小半径：$r$。\n- 坐标映射：$R = R_0 + r \\cos\\theta$，$Z = r \\sin\\theta$ 将柱坐标系 $(R,\\phi,Z)$ 与几何极向角 $\\theta$ 相关联。\n- Boozer 坐标系：$(\\psi, \\theta, \\phi_B)$。\n- 环向角对齐：在 $r/R_0$ 的主导阶上 $\\phi_B \\approx \\phi$。\n- 极向角对齐：Boozer 极向角 $\\theta$ 与几何极向角 $\\theta$ 等同。\n- 磁通-半径关系：$\\psi = \\frac{1}{2} B_0 R_0 r^2$。\n- 轴上环向场：$B_0$。\n- 安全因子：$q_s$，在磁通面上为常数。\n- 磁场强度模型：$B(R, \\theta, \\phi_B) \\approx \\frac{B_0 R_0}{R}\\left(1 + \\delta \\cos(N\\phi_B)\\right)$。\n- 波纹参数：$0  \\delta \\ll 1$，$N$ 是环向场（TF）线圈的数量。\n- 近似：在 $\\delta$ 和 $r/R_0$ 的主导阶上计算，忽略小参数的乘积。\n- 任务1：计算 Boozer 坐标系 $(\\psi, \\theta, \\phi_B)$ 中度规张量系数 $g_{ij}$ 到 $r/R_0$ 的主导阶。\n- 任务2：构建在与 $(\\psi, \\theta, \\phi_B)$ 对齐的正交归一基中的梯度 $\\nabla B$ 到主导阶。\n- 任务3：确定在低场侧中平面（$\\theta=0$）和 $N\\phi_B = \\frac{\\pi}{2}$ 处的径向梯度B漂移速度 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B}\\cdot \\hat{\\mathbf{e}}_r$。\n- 梯度B漂移速度：$\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B$。\n- 磁矩：$\\mu$。\n- 粒子电荷：$q_p$。\n- 任务3的磁场矢量模型：$\\mathbf{B} \\approx B_\\phi \\,\\hat{\\mathbf{e}}_\\phi + B_\\theta \\,\\hat{\\mathbf{e}}_\\theta$ 其中 $B_\\phi \\approx B_0$ 和 $B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$。\n- 任务3计算的近似：$R \\approx R_0$ 和 $B \\approx B_0$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题科学上基于托卡马克中等离子体物理的既定理论，特别是导心运动和新经典输运。几何和磁场模型是大环径比、圆形托卡马克的标准近似。问题是良定的，为每个任务提供了足够的信息和明确的目标。语言客观，并使用标准术语。近似条件被明确陈述，在此框架内定义了通往唯一解的路径。不存在科学缺陷、矛盾或歧义。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n\n**任务1：度规张量系数**\n\n笛卡尔坐标系 $(x,y,z)$ 中的位置矢量 $\\mathbf{x}$ 由下式给出：\n$$\n\\mathbf{x} = (R \\cos\\phi, R \\sin\\phi, Z)\n$$\n使用给定的映射 $R=R_0+r\\cos\\theta$，$Z=r\\sin\\theta$ 以及 $\\phi_B \\approx \\phi$，我们将 $\\mathbf{x}$ 用 $(\\psi, \\theta, \\phi_B)$ 表示：\n$$\n\\mathbf{x}(\\psi, \\theta, \\phi_B) = \\left( (R_0 + r(\\psi)\\cos\\theta)\\cos\\phi_B, (R_0 + r(\\psi)\\cos\\theta)\\sin\\phi_B, r(\\psi)\\sin\\theta \\right)\n$$\n其中 $r(\\psi) = \\sqrt{\\frac{2\\psi}{B_0 R_0}}$ 来自磁通-半径关系。\n\n对于坐标 $u^i = (\\psi, \\theta, \\phi_B)$，协变基矢 $\\mathbf{e}_i = \\frac{\\partial \\mathbf{x}}{\\partial u^i}$ 为：\n$$\n\\mathbf{e}_\\psi = \\frac{\\partial \\mathbf{x}}{\\partial r}\\frac{\\partial r}{\\partial \\psi} \\quad, \\quad \\mathbf{e}_\\theta = \\frac{\\partial \\mathbf{x}}{\\partial \\theta} \\quad, \\quad \\mathbf{e}_{\\phi_B} = \\frac{\\partial \\mathbf{x}}{\\partial \\phi_B}\n$$\n首先，我们求得 $\\frac{\\partial r}{\\partial \\psi} = \\frac{d}{d\\psi}\\left(\\sqrt{\\frac{2\\psi}{B_0 R_0}}\\right) = \\frac{1}{2\\sqrt{\\frac{2\\psi}{B_0 R_0}}} \\frac{2}{B_0 R_0} = \\frac{1}{r B_0 R_0}$。\n$\\mathbf{x}$ 的偏导数为：\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial r} = (\\cos\\theta\\cos\\phi_B, \\cos\\theta\\sin\\phi_B, \\sin\\theta)\n$$\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial \\theta} = (-r\\sin\\theta\\cos\\phi_B, -r\\sin\\theta\\sin\\phi_B, r\\cos\\theta)\n$$\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial \\phi_B} = (-(R_0+r\\cos\\theta)\\sin\\phi_B, (R_0+r\\cos\\theta)\\cos\\phi_B, 0)\n$$\n因此，基矢为：\n$$\n\\mathbf{e}_\\psi = \\frac{1}{r B_0 R_0}(\\cos\\theta\\cos\\phi_B, \\cos\\theta\\sin\\phi_B, \\sin\\theta)\n$$\n$$\n\\mathbf{e}_\\theta = (-r\\sin\\theta\\cos\\phi_B, -r\\sin\\theta\\sin\\phi_B, r\\cos\\theta)\n$$\n$$\n\\mathbf{e}_{\\phi_B} = (-R\\sin\\phi_B, R\\cos\\phi_B, 0) \\quad \\text{其中 } R=R_0+r\\cos\\theta\n$$\n度规张量系数为 $g_{ij} = \\mathbf{e}_i \\cdot \\mathbf{e}_j$。该坐标系是正交的，因此当 $i \\neq j$ 时 $g_{ij}=0$。我们计算对角分量：\n$$\ng_{\\psi\\psi} = \\mathbf{e}_\\psi \\cdot \\mathbf{e}_\\psi = \\left(\\frac{1}{r B_0 R_0}\\right)^2 (\\cos^2\\theta(\\cos^2\\phi_B+\\sin^2\\phi_B) + \\sin^2\\theta) = \\frac{1}{r^2 B_0^2 R_0^2}\n$$\n$$\ng_{\\theta\\theta} = \\mathbf{e}_\\theta \\cdot \\mathbf{e}_\\theta = r^2\\sin^2\\theta(\\cos^2\\phi_B+\\sin^2\\phi_B) + r^2\\cos^2\\theta = r^2\n$$\n$$\ng_{\\phi_B\\phi_B} = \\mathbf{e}_{\\phi_B} \\cdot \\mathbf{e}_{\\phi_B} = R^2\\sin^2\\phi_B + R^2\\cos^2\\phi_B = R^2 = (R_0+r\\cos\\theta)^2\n$$\n到 $r/R_0$ 的主导阶，我们保留主导项。对于 $g_{\\phi_B\\phi_B}$，我们保留一阶修正，因为它具有物理意义：$g_{\\phi_B\\phi_B} \\approx R_0^2(1+2\\frac{r}{R_0}\\cos\\theta)$。然而，为了后续计算的一致性，通常只需要零阶项 $R_0^2$。我们列出主导阶项：\n$g_{\\psi\\psi} = \\frac{1}{r^2 B_0^2 R_0^2}$，$g_{\\theta\\theta} = r^2$，以及 $g_{\\phi_B\\phi_B} \\approx R_0^2$。\n非零的度规张量系数是 $g_{\\psi\\psi}$、$g_{\\theta\\theta}$ 和 $g_{\\phi_B\\phi_B}$。\n\n**任务2：磁场强度的梯度**\n\n在正交坐标系 $(\\psi, \\theta, \\phi_B)$ 中，标量 $B$ 的梯度为：\n$$\n\\nabla B = \\frac{1}{h_\\psi}\\frac{\\partial B}{\\partial \\psi}\\hat{\\mathbf{e}}_\\psi + \\frac{1}{h_\\theta}\\frac{\\partial B}{\\partial \\theta}\\hat{\\mathbf{e}}_\\theta + \\frac{1}{h_{\\phi_B}}\\frac{\\partial B}{\\partial \\phi_B}\\hat{\\mathbf{e}}_{\\phi_B}\n$$\n其中 $h_i = \\sqrt{g_{ii}}$ 是尺度因子，$\\hat{\\mathbf{e}}_i$ 构成正交归一基。\n$$\nh_\\psi = \\sqrt{g_{\\psi\\psi}} = \\frac{1}{r B_0 R_0} \\quad, \\quad h_\\theta = \\sqrt{g_{\\theta\\theta}} = r \\quad, \\quad h_{\\phi_B} = \\sqrt{g_{\\phi_B\\phi_B}} = R_0+r\\cos\\theta \\approx R_0\n$$\n磁场强度为 $B \\approx \\frac{B_0 R_0}{R}(1 + \\delta \\cos(N\\phi_B))$。我们对 $r/R_0 \\ll 1$ 的情况展开 $1/R$：\n$$\n\\frac{1}{R} = \\frac{1}{R_0+r\\cos\\theta} = \\frac{1}{R_0(1+\\frac{r}{R_0}\\cos\\theta)} \\approx \\frac{1}{R_0}\\left(1-\\frac{r}{R_0}\\cos\\theta\\right)\n$$\n将此代入 $B$ 的表达式中：\n$$\nB \\approx \\frac{B_0 R_0}{R_0}\\left(1-\\frac{r}{R_0}\\cos\\theta\\right)(1 + \\delta \\cos(N\\phi_B)) \\approx B_0\\left(1 - \\frac{r}{R_0}\\cos\\theta + \\delta\\cos(N\\phi_B)\\right)\n$$\n我们忽略了小参数 $\\delta \\cdot (r/R_0)$ 的乘积。\n现在，我们计算 $B$ 对各坐标的偏导数，注意 $r=r(\\psi)$：\n$$\n\\frac{\\partial B}{\\partial \\psi} = \\frac{\\partial B}{\\partial r}\\frac{\\partial r}{\\partial \\psi} \\approx \\left(-\\frac{B_0}{R_0}\\cos\\theta\\right)\\left(\\frac{1}{r B_0 R_0}\\right) = -\\frac{\\cos\\theta}{r R_0^2}\n$$\n$$\n\\frac{\\partial B}{\\partial \\theta} \\approx B_0 \\frac{\\partial}{\\partial \\theta}\\left(-\\frac{r}{R_0}\\cos\\theta\\right) = \\frac{B_0 r}{R_0}\\sin\\theta\n$$\n$$\n\\frac{\\partial B}{\\partial \\phi_B} \\approx B_0 \\frac{\\partial}{\\partial \\phi_B}(\\delta\\cos(N\\phi_B)) = -B_0 N \\delta \\sin(N\\phi_B)\n$$\n在正交归一基 $(\\hat{\\mathbf{e}}_\\psi, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_{\\phi_B})$ 中，梯度的分量为：\n$$\n(\\nabla B)_\\psi = \\frac{1}{h_\\psi}\\frac{\\partial B}{\\partial \\psi} = (r B_0 R_0)\\left(-\\frac{\\cos\\theta}{r R_0^2}\\right) = -\\frac{B_0}{R_0}\\cos\\theta\n$$\n$$\n(\\nabla B)_\\theta = \\frac{1}{h_\\theta}\\frac{\\partial B}{\\partial \\theta} = \\frac{1}{r}\\left(\\frac{B_0 r}{R_0}\\sin\\theta\\right) = \\frac{B_0}{R_0}\\sin\\theta\n$$\n$$\n(\\nabla B)_{\\phi_B} = \\frac{1}{h_{\\phi_B}}\\frac{\\partial B}{\\partial \\phi_B} \\approx \\frac{1}{R_0}(-B_0 N \\delta \\sin(N\\phi_B)) = -\\frac{B_0 N \\delta}{R_0}\\sin(N\\phi_B)\n$$\n梯度矢量为：\n$$\n\\nabla B \\approx \\left(-\\frac{B_0}{R_0}\\cos\\theta\\right)\\hat{\\mathbf{e}}_\\psi + \\left(\\frac{B_0}{R_0}\\sin\\theta\\right)\\hat{\\mathbf{e}}_\\theta - \\left(\\frac{B_0 N \\delta}{R_0}\\sin(N\\phi_B)\\right)\\hat{\\mathbf{e}}_{\\phi_B}\n$$\n前两个分量由环向曲率引起的极向变化产生，第三个分量由环向场波纹产生。\n\n**任务3：径向梯度B漂移速度**\n\n梯度B漂移速度为 $\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B$。我们求其径向分量 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B} \\cdot \\hat{\\mathbf{e}}_r$。径向方向对应于 $\\psi$ 方向，因此 $\\hat{\\mathbf{e}}_r = \\hat{\\mathbf{e}}_\\psi$。\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\,(\\mathbf{B}\\times\\nabla B) \\cdot \\hat{\\mathbf{e}}_\\psi\n$$\n使用标量三重积恒等式 $(\\mathbf{A}\\times\\mathbf{B})\\cdot\\mathbf{C} = \\mathbf{A}\\cdot(\\mathbf{B}\\times\\mathbf{C})$，这可以写成：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\cdot(\\nabla B \\times \\hat{\\mathbf{e}}_\\psi)\n$$\n磁场矢量给定为 $\\mathbf{B} \\approx B_\\theta \\hat{\\mathbf{e}}_\\theta + B_\\phi \\hat{\\mathbf{e}}_{\\phi_B}$，其中 $B_\\phi$ 与 $B_{\\phi_B}$ 等同。\n在右手正交归一基 $(\\hat{\\mathbf{e}}_\\psi, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_{\\phi_B})$ 中的叉积 $\\nabla B \\times \\hat{\\mathbf{e}}_\\psi$ 为：\n$$\n\\nabla B \\times \\hat{\\mathbf{e}}_\\psi = ((\\nabla B)_\\psi \\hat{\\mathbf{e}}_\\psi + (\\nabla B)_\\theta \\hat{\\mathbf{e}}_\\theta + (\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_{\\phi_B}) \\times \\hat{\\mathbf{e}}_\\psi = (\\nabla B)_\\theta (\\hat{\\mathbf{e}}_\\theta \\times \\hat{\\mathbf{e}}_\\psi) + (\\nabla B)_{\\phi_B} (\\hat{\\mathbf{e}}_{\\phi_B} \\times \\hat{\\mathbf{e}}_\\psi)\n$$\n$$\n= (\\nabla B)_\\theta (-\\hat{\\mathbf{e}}_{\\phi_B}) + (\\nabla B)_{\\phi_B} (\\hat{\\mathbf{e}}_\\theta) = (\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_\\theta - (\\nabla B)_\\theta \\hat{\\mathbf{e}}_{\\phi_B}\n$$\n现在，我们计算与 $\\mathbf{B}$ 的点积：\n$$\n\\mathbf{B} \\cdot (\\nabla B \\times \\hat{\\mathbf{e}}_\\psi) = (B_\\theta \\hat{\\mathbf{e}}_\\theta + B_{\\phi_B} \\hat{\\mathbf{e}}_{\\phi_B}) \\cdot ((\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_\\theta - (\\nabla B)_\\theta \\hat{\\mathbf{e}}_{\\phi_B}) = B_\\theta (\\nabla B)_{\\phi_B} - B_{\\phi_B} (\\nabla B)_\\theta\n$$\n所以径向漂移为：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\left[B_\\theta (\\nabla B)_{\\phi_B} - B_{\\phi_B} (\\nabla B)_\\theta\\right]\n$$\n我们在此指定位置计算该表达式：低场侧中平面（$\\theta=0$）和最大波纹梯度处（$N\\phi_B = \\frac{\\pi}{2}$）。\n在此位置，我们使用给定的近似：$B_\\phi \\approx B_{\\phi_B} \\approx B_0$，$B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$，以及 $B \\approx B_0$。\n来自任务2的梯度分量变为：\n$$\n(\\nabla B)_\\theta = \\frac{B_0}{R_0}\\sin(0) = 0\n$$\n$$\n(\\nabla B)_{\\phi_B} = -\\frac{B_0 N \\delta}{R_0}\\sin\\left(\\frac{\\pi}{2}\\right) = -\\frac{B_0 N \\delta}{R_0}\n$$\n将这些值代入 $v_{\\nabla B,r}$ 的表达式中：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B_0^2}\\left[ \\left(\\frac{B_0 r}{q_s R_0}\\right) \\left(-\\frac{B_0 N \\delta}{R_0}\\right) - (B_0)(0) \\right]\n$$\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B_0^2}\\left[ -\\frac{B_0^2 N \\delta r}{q_s R_0^2} \\right]\n$$\n$$\nv_{\\nabla B,r} = -\\frac{\\mu N \\delta r}{q_p q_s R_0^2}\n$$\n这是在指定点由环向场波纹驱动的径向梯度B漂移速度的最终表达式。负号表示对于典型配置（例如，正离子 $q_p>0$，$\\mu>0$）存在向内漂移。此表达式的单位是速度，符合要求。",
            "answer": "$$\n\\boxed{-\\frac{\\mu N \\delta r}{q_{p} q_{s} R_{0}^{2}}}\n$$"
        },
        {
            "introduction": "在单粒子漂移的基础上，最后一个实践练习将我们带到宏观输运层面。实际的输运过程涉及大量具有不同能量和螺距角分布的粒子的集体行为。这个练习将演示如何通过对“共振”粒子贡献的积分来计算净粒子通量，并引入一种在现代输运理论中广泛使用的强大工具——准线性方法，让你深入理解从微观漂移到宏观通量的理论飞跃。",
            "id": "4041639",
            "problem": "一个具有弱环向磁场涟漪的大环径比托卡马克，其涟漪幅度为 $\\delta \\ll 1$，环向周期性参数为 $N$。考虑由静态非轴对称涟漪引起的导心粒子的近共振径向输运。设粒子能量为 $E = m v^{2}/2$，定义螺距角参数 $\\lambda \\in [0,1]$ 为 $\\lambda = v_{\\perp}^{2}/v^{2}$。假设背景分布在速度空间中是麦克斯韦分布，数密度为 $n$，温度为 $T$，因此分布函数为 $f(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2 T}\\right)$。准线性径向粒子通量密度的近共振贡献（记为 $\\Gamma_{\\mathrm{res}}$）被建模为与三个因子乘积对螺距角 $\\lambda$ 和能量 $E$ 的积分成正比：\n1. 权重 $W(\\lambda,E)$，它描述了导心的弹跳平均径向步长，\n2. 共振函数 $R(\\lambda,E)$，它在 $(\\lambda,E)$ 空间中的共振点附近急剧峰化，\n3. 从 $f(\\mathbf{v})$ 导出的单位能量的麦克斯韦能量密度。\n\n具体而言，取\n$$W(\\lambda,E) = w_{0}\\,E\\,\\lambda(1-\\lambda),$$\n$$\\omega_{d}(\\lambda,E) = a\\,E\\,(\\lambda-\\lambda_{0}),$$\n$$R(\\lambda,E) = \\frac{\\Delta^{2}}{\\omega_{d}(\\lambda,E)^{2} + \\Delta^{2}},$$\n其中 $\\lambda_{0} \\in (0,1)$ 是共振螺距角，$a0$ 是一个常数，表征在固定 $E$ 时弹跳平均环向进动频率 $\\omega_{d}$ 相对于 $\\lambda$ 的局部斜率，$\\Delta0$ 是一个有效去相关率（共振的碰撞展宽），$w_{0}0$ 是一个设定径向步长尺度的常数。设近共振通量密度为\n$$\\Gamma_{\\mathrm{res}} = A\\,\\delta^{2}\\,n \\int_{0}^{\\infty} dE\\,P(E)\\int_{0}^{1} d\\lambda\\, W(\\lambda,E)\\,R(\\lambda,E),$$\n其中 $A0$ 是一个无量纲几何因子，$P(E)$ 是通过在固定 $E$ 时对 $f(\\mathbf{v})$ 在所有速度方向上积分得到的单位能量的麦克斯韦能量密度。\n\n从麦克斯韦分布函数和上述定义出发，在窄共振假设（即对于对 $P(E)$ 贡献最大的能量，有 $\\Delta/(a E) \\ll 1$）下，在小参数 $\\Delta/(a E)$ 的主导阶上精确计算积分，并获得 $\\Gamma_{\\mathrm{res}}$ 关于 $A$, $w_{0}$, $n$, $T$, $a$, $\\Delta$, $\\lambda_{0}$ 和 $\\delta$ 的闭式解析表达式。您的推导必须从第一性原理出发，首先由 $f(\\mathbf{v})$ 构建 $P(E)$，然后执行对 $\\lambda$ 的积分和对 $E$ 的积分，期间不得援引任何未经证明的简化公式。\n\n以“粒子数/平方米·秒”为单位表示最终的通量密度。无需进行数值计算。请将您的最终答案以单个闭式表达式的形式给出。方框内的答案请勿包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于等离子体物理和聚变科学中的标准概念，是适定的，并且客观地陈述了导致唯一解的任务。\n\n### 解答推导\n近共振径向粒子通量密度 $\\Gamma_{\\mathrm{res}}$ 的计算分三个阶段进行：首先，推导麦克斯韦能量分布 $P(E)$；其次，计算对螺距角参数 $\\lambda$ 的积分；第三，计算对能量 $E$ 的积分。\n\n首先，我们从给定的麦克斯韦速度分布函数 $f(\\mathbf{v})$ 推导能量概率密度函数 $P(E)$。分布函数以速率 $v$ 表示为\n$$f(v) = n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2 T}\\right)$$\n在速度空间的无穷小体积 $d^3v$ 内，单位体积的粒子数 $dn$ 为 $dn = f(\\mathbf{v})d^3v$。为了找到能量 $E = \\frac{1}{2} m v^2$ 的分布，我们在固定速率 $v$ 的情况下对所有速度方向进行积分。在速度空间的球坐标系中，体积元为 $d^3v = 4\\pi v^2 dv$。单位体积内速率在 $v$ 和 $v+dv$ 之间的粒子数为\n$$dn_v = f(v) 4\\pi v^2 dv = n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2 T}\\right) 4\\pi v^2 dv$$\n我们将变量从速率 $v$ 转换为能量 $E$。我们有 $E = \\frac{1}{2} m v^2$，因此 $v = \\sqrt{2E/m}$ 且 $dv = \\frac{dE}{\\sqrt{2mE}}$。将这些代入 $dn_v$ 的表达式，得到单位体积内能量在 $E$ 和 $E+dE$ 之间的粒子数，记为 $dn_E$：\n$$dn_E = n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\left(-\\frac{E}{T}\\right) 4\\pi \\left(\\frac{2E}{m}\\right) \\frac{dE}{\\sqrt{2mE}}$$\n通过合并常数项并简化，我们得到：\n$$dn_E = n \\frac{m^{3/2}}{2^{3/2}\\pi^{3/2}T^{3/2}} \\cdot 4\\pi \\cdot \\frac{2E}{m} \\cdot \\frac{1}{\\sqrt{2mE}} \\cdot \\exp\\left(-\\frac{E}{T}\\right) dE$$\n$$dn_E = n \\left(\\frac{m^{3/2}}{m \\cdot m^{1/2}}\\right) \\left(\\frac{4\\pi \\cdot 2}{2^{3/2}\\pi^{3/2}\\sqrt{2}}\\right) \\frac{1}{T^{3/2}} E^{1/2} \\exp\\left(-\\frac{E}{T}\\right) dE$$\n$$dn_E = n \\left(\\frac{8\\pi}{4\\pi^{3/2}}\\right) \\frac{1}{T^{3/2}} E^{1/2} \\exp\\left(-\\frac{E}{T}\\right) dE = n \\frac{2}{\\sqrt{\\pi}T^{3/2}} E^{1/2} \\exp\\left(-\\frac{E}{T}\\right) dE$$\n问题在定义 $\\Gamma_{\\mathrm{res}}$ 时，将因子 $n$ 放在积分之外，这意味着 $P(E)$ 是一个归一化的概率密度函数，即 $\\int_0^\\infty P(E) dE = 1$。从 $dn_E = n P(E) dE$，我们确定：\n$$P(E) = \\frac{2}{\\sqrt{\\pi} T^{3/2}} E^{1/2} \\exp\\!\\left(-\\frac{E}{T}\\right)$$\n我们可以通过标准伽马函数积分 $\\int_0^\\infty x^{1/2} e^{-x} dx = \\Gamma(3/2) = \\sqrt{\\pi}/2$ 来验证其归一性。因此 $P(E)$ 的表达式是正确的。\n\n接下来，我们对固定的能量 $E$ 计算关于 $\\lambda$ 的积分：\n$$I_{\\lambda}(E) = \\int_{0}^{1} d\\lambda\\, W(\\lambda,E)\\,R(\\lambda,E)$$\n代入给定的 $W$ 和 $R$ 的形式：\n$$I_{\\lambda}(E) = \\int_{0}^{1} d\\lambda\\, \\left(w_{0}\\,E\\,\\lambda(1-\\lambda)\\right) \\left(\\frac{\\Delta^{2}}{(a\\,E\\,(\\lambda-\\lambda_{0}))^{2} + \\Delta^{2}}\\right)$$\n窄共振假设 $\\Delta/(aE) \\ll 1$ 意味着函数 $R(\\lambda,E)$ 在 $\\lambda = \\lambda_0$ 附近非常尖锐地达到峰值。峰宽约为 $\\Delta/(aE)$。由于权重函数 $g(\\lambda) = w_0 E \\lambda(1-\\lambda)$ 与此窄峰相比是一个缓变函数，我们可以通过在共振中心 $\\lambda = \\lambda_0$ 处计算 $g(\\lambda)$ 的值并将其从积分中提出来近似该积分。\n$$I_{\\lambda}(E) \\approx w_{0}\\,E\\,\\lambda_{0}(1-\\lambda_{0}) \\int_{0}^{1} d\\lambda\\, \\frac{\\Delta^{2}}{(aE(\\lambda-\\lambda_0))^{2} + \\Delta^{2}}$$\n我们进行变量替换：$u = \\frac{aE}{\\Delta}(\\lambda-\\lambda_{0})$。那么 $d\\lambda = \\frac{\\Delta}{aE}du$。由于 $\\lambda_{0} \\in (0,1)$ 且 $\\Delta/(aE) \\ll 1$， $u$ 的积分极限，即 $-\\frac{aE}{\\Delta}\\lambda_0$ 和 $\\frac{aE}{\\Delta}(1-\\lambda_0)$，在主导阶上可以扩展到 $-\\infty$ 和 $+\\infty$。\n$$\\int_{0}^{1} d\\lambda\\, \\frac{\\Delta^{2}}{(aE(\\lambda-\\lambda_0))^{2} + \\Delta^{2}} \\approx \\int_{-\\infty}^{\\infty} \\frac{\\Delta}{aE}du\\, \\frac{\\Delta^{2}}{(\\Delta u)^2 + \\Delta^2} = \\frac{\\Delta}{aE} \\int_{-\\infty}^{\\infty} \\frac{du}{u^2+1}$$\n这是一个标准积分：$\\int_{-\\infty}^{\\infty} \\frac{du}{u^2+1} = [\\arctan(u)]_{-\\infty}^{\\infty} = \\frac{\\pi}{2} - (-\\frac{\\pi}{2}) = \\pi$。\n所以，共振函数的积分变为 $\\frac{\\pi\\Delta}{aE}$。\n将此结果代回 $I_{\\lambda}(E)$ 的表达式中：\n$$I_{\\lambda}(E) \\approx \\left(w_{0}\\,E\\,\\lambda_{0}(1-\\lambda_{0})\\right) \\left(\\frac{\\pi\\Delta}{aE}\\right) = \\frac{\\pi w_{0} \\Delta}{a} \\lambda_{0}(1-\\lambda_{0})$$\n值得注意的是，这个关于 $\\lambda$ 的积分结果与能量 $E$ 无关。\n\n最后，我们进行关于能量 $E$ 的积分以求得通量 $\\Gamma_{\\mathrm{res}}$：\n$$\\Gamma_{\\mathrm{res}} = A\\,\\delta^{2}\\,n \\int_{0}^{\\infty} dE\\,P(E)\\,I_{\\lambda}(E)$$\n代入我们对 $I_{\\lambda}(E)$ 的主导阶结果：\n$$\\Gamma_{\\mathrm{res}} = A\\,\\delta^{2}\\,n \\int_{0}^{\\infty} dE\\,P(E)\\,\\left( \\frac{\\pi w_{0} \\Delta}{a} \\lambda_{0}(1-\\lambda_{0}) \\right)$$\n由于括号中的项相对于 $E$ 是常数，我们可以将其移出积分：\n$$\\Gamma_{\\mathrm{res}} = A\\,\\delta^{2}\\,n \\left( \\frac{\\pi w_{0} \\Delta}{a} \\lambda_{0}(1-\\lambda_{0}) \\right) \\int_{0}^{\\infty} P(E) dE$$\n根据定义，概率密度函数 $P(E)$ 在其整个定义域上的积分为1：$\\int_{0}^{\\infty} P(E) dE = 1$。\n因此，粒子通量密度的最终表达式为：\n$$\\Gamma_{\\mathrm{res}} = A\\,\\delta^{2}\\,n \\frac{\\pi w_{0} \\Delta}{a} \\lambda_{0}(1-\\lambda_{0})$$\n重新整理各项即可得到最终结果。",
            "answer": "$$\\boxed{\\frac{A \\pi \\delta^{2} n w_{0} \\Delta \\lambda_{0} (1-\\lambda_{0})}{a}}$$"
        }
    ]
}