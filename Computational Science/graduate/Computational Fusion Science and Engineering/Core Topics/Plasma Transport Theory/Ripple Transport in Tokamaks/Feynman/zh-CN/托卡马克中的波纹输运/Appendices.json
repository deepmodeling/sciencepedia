{
    "hands_on_practices": [
        {
            "introduction": "在我们模拟或分析纹波输运之前，我们必须首先能够精确定义什么是纹波，以及如何从实验或模拟数据中测量它。本实践的核心任务是识别并区分环向场纹波与其他磁场变化。这项练习  将挑战你利用傅里叶分析和托卡马克线圈系统的内禀对称性，为区分环向纹波和极向场变化建立稳健的判据。",
            "id": "4041619",
            "problem": "考虑一个大环径比托卡马克，其拥有 $N_t$ 个相同的环向场线圈，产生一个静态磁构型。令 $(r,\\theta,\\phi)$ 表示标准的磁通坐标，其中 $r$ 标记磁面，$\\theta$ 是极向角，$\\phi$ 是环向角。您在一个固定的磁面 $r=r_0$ 上，在 $\\theta \\in [0,2\\pi)$ 和 $\\phi \\in [0,2\\pi)$ 的密集网格上测量磁场强度 $B(r,\\theta,\\phi)$。假设为理想准静态条件（无时间依赖性），且由等离子体产生的非轴对称场可以忽略不计。定义条件一维傅里叶变换\n$$\n\\hat{B}_n(r_0,\\theta) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} d\\phi\\, B(r_0,\\theta,\\phi)\\,e^{-i n \\phi},\\quad \\tilde{B}_m(r_0,\\phi) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} d\\theta\\, B(r_0,\\theta,\\phi)\\,e^{-i m \\theta},\n$$\n及其功率谱 $S_\\phi(n;\\theta) = \\left|\\hat{B}_n(r_0,\\theta)\\right|^2$ 和 $S_\\theta(m;\\phi) = \\left|\\tilde{B}_m(r_0,\\phi)\\right|^2$。令 $\\langle \\cdot \\rangle_\\theta$ 表示对 $\\theta$ 的极向平均，$\\langle \\cdot \\rangle_\\phi$ 表示对 $\\phi$ 的环向平均。为分类目的，定义极向平均的环向谱 $H_\\phi(n) = \\langle S_\\phi(n;\\theta)\\rangle_\\theta$ 和环向平均的极向谱 $H_\\theta(m) = \\langle S_\\theta(m;\\phi)\\rangle_\\phi$。\n\n要求您通过比较在固定 $(r,\\theta)$ 时 $B$ 沿 $\\phi$ 的变化与在固定 $(r,\\phi)$ 时 $B$ 沿 $\\theta$ 的变化，来正式区分环向场波纹和极向波纹，并陈述可应用于测量谱以区分二者的判据。\n\n请选择能够最正确、最稳健地提供区分环向场波纹和极向波纹判据的选项，该判据需基于分立线圈的周期性和 $B(r,\\theta,\\phi)$ 的对称性：\n\nA. 利用分立环向对称性：在一个具有 $N_t$ 个相同环向场线圈的理想装置中，$B(r,\\theta,\\phi)$ 在分立环向平移 $\\phi \\to \\phi + 2\\pi/N_t$ 下保持不变。因此，在固定的 $\\theta$ 处，$B$ 沿 $\\phi$ 方向的傅里叶分量仅在环向模数 $n = k N_t$（其中 $k$ 为整数）处呈现非零谐波，具体会受到 $\\theta$ 的几何调制影响。将环向波纹归类为那些频谱分量，其极向平均环向谱 $H_\\phi(n)$ 在 $n = k N_t$ 处显示出一系列峰值的梳状结构，并且该结构在所有 $\\theta$ 上都持续存在（即，$S_\\phi(n;\\theta)$ 在所有 $\\theta$ 处都显示相同的 $n$ 梳状结构）；而将极向波纹归类为那些频谱分量，其环向平均极向谱 $H_\\theta(m)$ 在 $m \\neq 0$ 处有峰值，并且这些峰值在所有 $\\phi$ 上都持续存在，但其环向谱缺乏 $n = k N_t$ 的选择定则梳状结构。操作上：验证 $B(r,\\theta,\\phi + 2\\pi/N_t) - B(r,\\theta,\\phi) \\approx 0$，并通过 $H_\\phi(n)$ 中在 $N_t$ 整数倍处的 $n$ 峰来识别环向波纹；通过 $H_\\theta(m)$ 中在 $\\phi$ 平均后仍然存在且不与 $n = k N_t$ 选择性对齐的 $m$ 峰来识别极向波纹。\n\nB. 仅通过不存在极向变化（即 $S_\\theta(m;\\phi)$ 中 $m=0$）来识别环向波纹，并仅通过不存在环向变化（即 $S_\\phi(n;\\theta)$ 中 $n=0$）来识别极向波纹。因此，环向波纹只包含 $m = 0$ 的分量，而极向波纹只包含 $n = 0$ 的分量。\n\nC. 变换到直场线坐标系，并将满足共振条件 $m - n q = 0$（其中 $q$ 是安全因子）的傅里叶分量归类为环向波纹，而将由 $m - n q \\neq 0$ 定义的分量归类为极向波纹。使用这组共振来区分谱中的环向波纹和极向波纹。\n\nD. 完全依赖于固定 $\\theta$ 处的环向谱：任何在整数 $n$ 处的峰值都表示环向波纹，而极向波纹在 $S_\\phi(n;\\theta)$ 中无法检测到，必须忽略。无需进行跨 $\\theta$ 或 $\\phi$ 的平均。\n\nE. 计算环向平均 $\\bar{B}(r_0,\\theta) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} d\\phi\\, B(r_0,\\theta,\\phi)$ 以消除环向波纹，然后将 $\\bar{B}$ 中剩余的极向变化定义为极向波纹。因为环向平均消除了所有非轴对称效应，所以剩余的极向依赖性唯一地标识了极向波纹。\n\n选择唯一的最佳选项。通过引用线圈几何结构所蕴含的对称性和谱选择定则来证明您的推理，而不是设备特定的经验启发式方法或共振输运判据。假设在 $\\theta$ 和 $\\phi$ 上的采样是充分的，因此谱泄漏和混叠可以忽略不计。",
            "solution": "用户希望我验证并解决一个关于托卡马克磁场中环向和极向波纹谱分类的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **系统**：大环径比托卡马克，拥有 $N_t$ 个相同的环向场线圈。\n*   **坐标**：磁通坐标 $(r,\\theta,\\phi)$。\n*   **测量域**：一个固定的磁面 $r=r_0$，在 $\\theta \\in [0,2\\pi)$ 和 $\\phi \\in [0,2\\pi)$ 上有密集采样。\n*   **磁场**：静态磁场 $B(r_0,\\theta,\\phi)$。\n*   **假设**：理想准静态条件；可忽略的等离子体产生的非轴对称场。\n*   **定义**：\n    *   环向傅里叶变换：$\\hat{B}_n(r_0,\\theta) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} d\\phi\\, B(r_0,\\theta,\\phi)\\,e^{-i n \\phi}$\n    *   极向傅里叶变换：$\\tilde{B}_m(r_0,\\phi) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} d\\theta\\, B(r_0,\\theta,\\phi)\\,e^{-i m \\theta}$\n    *   固定 $\\theta$ 处的环向功率谱：$S_\\phi(n;\\theta) = \\left|\\hat{B}_n(r_0,\\theta)\\right|^2$\n    *   固定 $\\phi$ 处的极向功率谱：$S_\\theta(m;\\phi) = \\left|\\tilde{B}_m(r_0,\\phi)\\right|^2$\n    *   极向平均的环向谱：$H_\\phi(n) = \\langle S_\\phi(n;\\theta)\\rangle_\\theta$\n    *   环向平均的极向谱：$H_\\theta(m) = \\langle S_\\theta(m;\\phi)\\rangle_\\phi$\n*   **任务**：基于线圈几何的对称性，使用谱判据来正式区分环向场波纹和极向波纹。\n*   **约束**：论证必须基于对称性和谱选择定则，而不是输运共振判据。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题在托卡马克磁约束物理学中有充分的根据。托卡马克真空磁场中的主要非轴对称性是由于有限数量的环向场（TF）线圈造成的，这会产生“波纹”。使用傅里叶分析来表征这种空间变化是等离子体物理和计算聚变科学中的标准技术。所有定义都是标准的。\n2.  **良态问题**：问题是良态的。它要求根据物理系统的基本对称性直接推导出的谱特性，为不同类型的磁场变化建立分类方案。可以建立一套独特且有意义的判据。\n3.  **客观性**：问题以精确、客观和定量的方式陈述。\n4.  **完整性和一致性**：问题提供了所有必要的信息。关键的物理约束是存在 $N_t$ 个相同的环向场线圈，这强加了一个分立的环向对称性。关于可忽略的等离子体产生的非轴对称性的假设是一个关键且标准的简化，它使得能够清晰地关注真空场的性质。\n5.  **无其他缺陷**：该问题并非不切实际、病态、微不足道或基于非科学前提。\n\n**步骤 3：结论和行动**\n\n问题陈述是**有效的**。我将继续进行详细的解答。\n\n### 解答推导\n\n该问题要求根据对称性来区分环向和极向波纹的判据。让我们分析这些场变化的物理来源和对称性质。\n\n1.  **环向场波纹**：这是由于 $N_t$ 个分立的环向场线圈引起的磁场强度在环向 $\\phi$ 上的变化。由于有 $N_t$ 个相同且等距的线圈，它们产生的磁场构型必须在 $\\phi$ 方向旋转 $2\\pi/N_t$ 角度后保持不变。这对磁场强度施加了一个基本的分立对称性：\n    $$B(r, \\theta, \\phi) = B(r, \\theta, \\phi + 2\\pi/N_t)$$\n    让我们分析这种对称性对环向傅里叶谱的影响。傅里叶系数 $\\hat{B}_n(r_0, \\theta)$ 定义为：\n    $$\\hat{B}_n(r_0, \\theta) = \\frac{1}{2\\pi}\\int_0^{2\\pi} B(r_0, \\theta, \\phi) e^{-in\\phi} d\\phi$$\n    由于周期性，我们必须有：\n    $$\\hat{B}_n(r_0, \\theta) = \\frac{1}{2\\pi}\\int_0^{2\\pi} B(r_0, \\theta, \\phi + 2\\pi/N_t) e^{-in\\phi} d\\phi$$\n    令 $\\phi' = \\phi + 2\\pi/N_t$，则 $\\phi = \\phi' - 2\\pi/N_t$ 且 $d\\phi = d\\phi'$。积分变为：\n    $$\\hat{B}_n(r_0, \\theta) = \\frac{1}{2\\pi}\\int_{2\\pi/N_t}^{2\\pi+2\\pi/N_t} B(r_0, \\theta, \\phi') e^{-in(\\phi' - 2\\pi/N_t)} d\\phi'$$\n    由于被积函数以 $2\\pi$ 为周期，我们可以将积分区间移回 $[0, 2\\pi]$。\n    $$\\hat{B}_n(r_0, \\theta) = e^{i 2\\pi n / N_t} \\left( \\frac{1}{2\\pi}\\int_0^{2\\pi} B(r_0, \\theta, \\phi') e^{-in\\phi'} d\\phi' \\right) = e^{i 2\\pi n / N_t} \\hat{B}_n(r_0, \\theta)$$\n    这个方程意味着，要么 $\\hat{B}_n(r_0, \\theta) = 0$，要么 $e^{i 2\\pi n / N_t} = 1$。第二个条件当且仅当 $n/N_t$ 是一个整数时才满足。设这个整数为 $k$。因此，非零的傅里叶系数只能存在于环向模数 $n$ 是环向场线圈数 $N_t$ 的整数倍的情况下。\n    $$n = k N_t, \\quad k \\in \\mathbb{Z}$$\n    这是一个严格的**选择定则**。$k=0$（$n=0$）的情况对应于场的轴对称分量。$k \\neq 0$ 的情况对应于环向波纹。因此，环向波纹在环向谱中的定义性特征是谱峰完全位于 $n=k N_t$ 处的梳状结构。这些波纹分量的强度 $\\hat{B}_{kN_t}$ 通常依赖于极向角 $\\theta$，通常在外侧中平面（$\\theta=0$）最大，在内侧中平面（$\\theta=\\pi$）最小。极向平均谱 $H_\\phi(n)$ 将稳健地显示出这种梳状结构。\n\n2.  **极向波纹**：这个术语的定义不那么正式，但通常指磁面上磁场强度在极向 $\\theta$ 上的变化。在理想的轴对称托卡马克中，这种变化的主要来源是环效应。环向场强度随大半径 $R$ 的变化而变化，即 $1/R$。在一个圆形磁面 $r=\\text{const}$上，$R = R_0 + r \\cos\\theta$，所以 $B \\approx B_0 (1 - (r/R_0) \\cos\\theta)$。这是一个极向变化（$m=1$）但环向对称（$n=0$）的结构。其他极向变化可以来自磁面的形状（拉长、三角形变）和极向场线圈的场，但这些也基本上是轴对称的（$n=0$）。\n    因此，“极向波纹”最好与磁场的轴对称（$n=0$）分量中随极向变化的部分联系起来。这意味着其谱特征是在环向模 $n=0$ 的情况下，极向模 $m \\neq 0$ 中存在功率。这可以通过分析环向平均场 $\\bar{B}(r_0, \\theta) = \\hat{B}_0(r_0, \\theta)$ 并观察其极向谱来识别。等效地，环向平均的极向谱 $H_\\theta(m)$ 将在 $m \\neq 0$ 处显示峰值，这些峰值主要由 $n=0$ 的场分量引起。\n\n**区分判据**：\n*   **环向波纹**：其特征是环向模数为 $n=k N_t$（$k$ 为非零整数）的分量。这是分立线圈对称性的直接结果。\n*   **极向波纹**：其特征是环向模数 $n=0$ 和非零极向模数 $m \\neq 0$ 的分量。这主要归因于环效应和等离子体位形。\n\n### 逐项分析选项\n\n*   **A**：此选项正确地指出，具有 $N_t$ 个线圈的分立环向对称性意味着 $B(r,\\theta,\\phi) = B(r,\\theta,\\phi+2\\pi/N_t)$。它正确地推导出了谱选择定则：非零环向谐波仅在 $n = k N_t$ 处出现。它正确地提议通过在极向平均环向谱 $H_\\phi(n)$ 中寻找“位于 $n=k N_t$ 的峰值梳状结构”来识别环向波纹。它正确地通过在环向平均极向谱 $H_\\theta(m)$ 中寻找 $m \\neq 0$ 的峰值来识别极向波纹，并通过指出极向波纹的环向谱缺乏 $n=kN_t$ 梳状结构（即，它主要由 $n=0$ 主导）来与环向波纹进行关键对比。操作性总结是精确和正确的。此选项与我们从第一性原理推导的结果完全一致。**正确**。\n\n*   **B**：此选项声称环向波纹只有 $m=0$ 的分量，而极向波纹只有 $n=0$ 的分量。将极向波纹与 $n=0$ 联系起来大体上是正确的，因为这是其主要特征。然而，声称环向波纹没有极向变化（$m=0$）是根本错误的。环向场波纹的幅度受到极向角 $\\theta$ 的强烈调制，这意味着它必须有 $m \\neq 0$ 的傅里叶分量。**不正确**。\n\n*   **C**：此选项引用了场线共振条件 $m-nq=0$。问题明确禁止使用共振输运判据，因为目标是根据场的几何来源对其进行分类，而不是根据其对粒子运动的影响。线圈组的对称性是原因；共振是结果。此选项混淆了这两个独立的概念。**不正确**。\n\n*   **D**：此选项建议环向谱中任何整数 $n$ 处的峰值都表示环向波纹。这不够稳健；定义特征不仅仅是任何峰值，而是在 $N_t$ 的整数倍处系统性的峰值结构。它还错误地声称在 $S_\\phi(n;\\theta)$ 中无法检测到极向波纹。轴对称场的极向变化包含在 $n=0$ 分量 $\\hat{B}_0(r_0, \\theta)$ 的 $\\theta$ 依赖性中，因此是可以检测的。不使用平均的建议忽略了一种提高信号清晰度的标准技术。**不正确**。\n\n*   **E**：此选项正确地识别了一个隔离极向波纹的程序：计算环向平均 $\\bar{B}(r_0,\\theta)$ 并分析其剩余的极向变化。这成功地移除了所有非轴对称效应，包括环向波纹。然而，该选项不完整。它提供了一种识别极向波纹的方法，但未能为识别环向波纹本身提供一个明确的判据。它没有提到关键的 $n=k N_t$ 选择定则，而这正是环向波纹的基本标志。选项 A 为两种波纹都提供了明确的识别方法。因此，虽然部分正确，但选项 E 不如选项 A 完整和具有描述性。**不正确**（因为它不是*最*正确和最稳健的选项）。\n\n基于详细分析，选项 A 提供了最完整、物理上最可靠、最稳健的判据，可根据其基本对称性来区分环向和极向波纹。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦我们识别出磁场纹波，下一个关键步骤是理解其对带电粒子运动的直接影响。磁场强度的空间变化（$\\nabla B$）会引起导心漂移，这是粒子输运的一个主要机制。这项练习  提供了一个第一性原理的计算，引导你完成从Boozer坐标系下的磁场几何出发，推导由纹波引起的径向漂移速度的过程。",
            "id": "4041646",
            "problem": "考虑一个大环径比、圆截面的托卡马克，其大半径为 $R_0$，小半径为 $r$。该托卡马克嵌入在柱坐标系 $(R,\\phi,Z)$ 中，具有标准映射关系 $R = R_0 + r \\cos\\theta$ 和 $Z = r \\sin\\theta$，其中 $\\theta$ 是几何极向角。在 Boozer 坐标系 $(\\psi,\\theta,\\phi_B)$ 中进行计算，其中 Boozer 环向角 $\\phi_B$ 与几何环向角 $\\phi$ 在 $r/R_0$ 的领头阶上是对齐的，极向磁通标签 $\\psi$ 通过 $\\psi = \\frac{1}{2} B_0 R_0 r^2$ 与小半径相关，其中 $B_0$ 是轴上环向磁场。假设安全因子 $q_s$ 在磁面上是常数。磁场强度由一个占主导地位的环向场来建模，该场具有由环向曲率引起的极向变化，以及由有限数量 $N$ 的环向场（TF）线圈引起的微小环向场波纹：\n$$\nB(R,\\theta,\\phi_B) \\approx \\frac{B_0 R_0}{R}\\left(1 + \\delta \\cos(N\\phi_B)\\right),\n$$\n其中 $0  \\delta \\ll 1$，角度以弧度为单位。在计算中，对小参数 $\\delta$ 和 $r/R_0$ 保持领头阶一致，忽略所有小参数的乘积项。\n\n任务：\n1. 使用上述几何映射和 $\\psi$ 的磁通-半径关系，计算 Boozer 坐标系 $(\\psi,\\theta,\\phi_B)$ 中度规系数 $g_{ij}$ 的领头阶。明确写出非零分量。\n2. 从正交曲线坐标系中微分几何的基本原理出发，构建在与 $(\\psi,\\theta,\\phi_B)$ 对齐的标准正交基中梯度 $\\nabla B$ 的领头阶，并指出来自极向变化和环向波纹的分量。\n3. 使用梯度B漂移的导心理论，其中梯度B漂移速度为\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B,\n$$\n其中 $\\mu$ 是磁矩，$q_p$ 是粒子电荷，确定在外侧中平面（$\\theta=0$）以及波纹引起梯度最大的环向位置（$N\\phi_B = \\frac{\\pi}{2}$）处的径向分量 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B}\\cdot \\hat{\\mathbf{e}}_r$。将磁场矢量在领头阶上建模为 $\\mathbf{B} \\approx B_\\phi \\,\\hat{\\mathbf{e}}_\\phi + B_\\theta \\,\\hat{\\mathbf{e}}_\\theta$，其中 $B_\\phi \\approx B_0$ 和 $B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$，并在计算点使用 $R \\approx R_0$ 和 $B \\approx B_0$。用米每秒表示最终的径向漂移速度。\n你的最终答案必须是单一的闭式解析表达式。不需要进行数值计算。",
            "solution": "首先验证该问题，以确保其科学上可靠、提法恰当且客观。\n\n### 第1步：提取已知条件\n- 托卡马克几何：大环径比、圆截面。\n- 大半径：$R_0$。\n- 小半径：$r$。\n- 坐标映射：$R = R_0 + r \\cos\\theta$, $Z = r \\sin\\theta$ 将柱坐标 $(R,\\phi,Z)$ 与几何极向角 $\\theta$ 相关联。\n- Boozer 坐标：$(\\psi, \\theta, \\phi_B)$。\n- 环向角对齐：$\\phi_B \\approx \\phi$，在 $r/R_0$ 的领头阶上。\n- 极向角对齐：Boozer 极向角 $\\theta$ 与几何极向角 $\\theta$ 等同。\n- 磁通-半径关系：$\\psi = \\frac{1}{2} B_0 R_0 r^2$。\n- 轴上环向场：$B_0$。\n- 安全因子：$q_s$，在磁面上为常数。\n- 磁场强度模型：$B(R, \\theta, \\phi_B) \\approx \\frac{B_0 R_0}{R}\\left(1 + \\delta \\cos(N\\phi_B)\\right)$。\n- 波纹参数：$0  \\delta \\ll 1$，$N$ 是TF线圈的数量。\n- 近似：在 $\\delta$ 和 $r/R_0$ 的领头阶上进行计算，忽略小参数的乘积。\n- 任务1：计算 Boozer 坐标系 $(\\psi, \\theta, \\phi_B)$ 中度规系数 $g_{ij}$ 的领头阶。\n- 任务2：在领头阶上构建与 $(\\psi, \\theta, \\phi_B)$ 对齐的标准正交基中的 $\\nabla B$。\n- 任务3：确定在外侧中平面（$\\theta=0$）和 $N\\phi_B = \\frac{\\pi}{2}$ 处的径向梯度B漂移速度 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B}\\cdot \\hat{\\mathbf{e}}_r$。\n- 梯度B漂移速度：$\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B$。\n- 磁矩：$\\mu$。\n- 粒子电荷：$q_p$。\n- 任务3的磁场矢量模型：$\\mathbf{B} \\approx B_\\phi \\,\\hat{\\mathbf{e}}_\\phi + B_\\theta \\,\\hat{\\mathbf{e}}_\\theta$，其中 $B_\\phi \\approx B_0$，$B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$。\n- 任务3计算的近似：$R \\approx R_0$ 和 $B \\approx B_0$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上基于成熟的托卡马克等离子体物理理论，特别是导心运动和新经典输运。几何和磁场模型是大环径比、圆截面托卡马克的标准近似。问题提法恰当，为每个任务提供了充分的信息和明确的目标。语言客观，并使用了标准术语。近似条件被明确陈述，为在此框架内找到唯一解定义了路径。不存在科学缺陷、矛盾或含糊之处。\n\n### 第3步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解题推导\n\n**任务1：度规系数**\n\n在笛卡尔坐标系 $(x,y,z)$ 中的位置矢量 $\\mathbf{x}$ 由下式给出：\n$$\n\\mathbf{x} = (R \\cos\\phi, R \\sin\\phi, Z)\n$$\n使用所提供的映射关系 $R=R_0+r\\cos\\theta$、$Z=r\\sin\\theta$ 以及 $\\phi_B \\approx \\phi$，我们将 $\\mathbf{x}$ 用 $(\\psi, \\theta, \\phi_B)$ 表示：\n$$\n\\mathbf{x}(\\psi, \\theta, \\phi_B) = \\left( (R_0 + r(\\psi)\\cos\\theta)\\cos\\phi_B, (R_0 + r(\\psi)\\cos\\theta)\\sin\\phi_B, r(\\psi)\\sin\\theta \\right)\n$$\n其中 $r(\\psi) = \\sqrt{\\frac{2\\psi}{B_0 R_0}}$ 来自磁通-半径关系。\n\n坐标 $u^i = (\\psi, \\theta, \\phi_B)$ 的协变基矢 $\\mathbf{e}_i = \\frac{\\partial \\mathbf{x}}{\\partial u^i}$ 为：\n$$\n\\mathbf{e}_\\psi = \\frac{\\partial \\mathbf{x}}{\\partial r}\\frac{\\partial r}{\\partial \\psi} \\quad, \\quad \\mathbf{e}_\\theta = \\frac{\\partial \\mathbf{x}}{\\partial \\theta} \\quad, \\quad \\mathbf{e}_{\\phi_B} = \\frac{\\partial \\mathbf{x}}{\\partial \\phi_B}\n$$\n首先，我们求得 $\\frac{\\partial r}{\\partial \\psi} = \\frac{d}{d\\psi}\\left(\\sqrt{\\frac{2\\psi}{B_0 R_0}}\\right) = \\frac{1}{2\\sqrt{\\frac{2\\psi}{B_0 R_0}}} \\frac{2}{B_0 R_0} = \\frac{1}{r B_0 R_0}$。\n$\\mathbf{x}$ 的偏导数是：\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial r} = (\\cos\\theta\\cos\\phi_B, \\cos\\theta\\sin\\phi_B, \\sin\\theta)\n$$\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial \\theta} = (-r\\sin\\theta\\cos\\phi_B, -r\\sin\\theta\\sin\\phi_B, r\\cos\\theta)\n$$\n$$\n\\frac{\\partial \\mathbf{x}}{\\partial \\phi_B} = (-(R_0+r\\cos\\theta)\\sin\\phi_B, (R_0+r\\cos\\theta)\\cos\\phi_B, 0)\n$$\n因此，基矢为：\n$$\n\\mathbf{e}_\\psi = \\frac{1}{r B_0 R_0}(\\cos\\theta\\cos\\phi_B, \\cos\\theta\\sin\\phi_B, \\sin\\theta)\n$$\n$$\n\\mathbf{e}_\\theta = (-r\\sin\\theta\\cos\\phi_B, -r\\sin\\theta\\sin\\phi_B, r\\cos\\theta)\n$$\n$$\n\\mathbf{e}_{\\phi_B} = (-R\\sin\\phi_B, R\\cos\\phi_B, 0) \\quad \\text{其中 } R=R_0+r\\cos\\theta\n$$\n度规系数为 $g_{ij} = \\mathbf{e}_i \\cdot \\mathbf{e}_j$。该坐标系是正交的，因此当 $i \\neq j$ 时 $g_{ij}=0$。我们计算对角分量：\n$$\ng_{\\psi\\psi} = \\mathbf{e}_\\psi \\cdot \\mathbf{e}_\\psi = \\left(\\frac{1}{r B_0 R_0}\\right)^2 (\\cos^2\\theta(\\cos^2\\phi_B+\\sin^2\\phi_B) + \\sin^2\\theta) = \\frac{1}{r^2 B_0^2 R_0^2}\n$$\n$$\ng_{\\theta\\theta} = \\mathbf{e}_\\theta \\cdot \\mathbf{e}_\\theta = r^2\\sin^2\\theta(\\cos^2\\phi_B+\\sin^2\\phi_B) + r^2\\cos^2\\theta = r^2\n$$\n$$\ng_{\\phi_B\\phi_B} = \\mathbf{e}_{\\phi_B} \\cdot \\mathbf{e}_{\\phi_B} = R^2\\sin^2\\phi_B + R^2\\cos^2\\phi_B = R^2 = (R_0+r\\cos\\theta)^2\n$$\n在 $r/R_0$ 的领头阶上，我们保留主导项。对于 $g_{\\phi_B\\phi_B}$，我们保留一阶修正项，因为它具有物理意义：$g_{\\phi_B\\phi_B} \\approx R_0^2(1+2\\frac{r}{R_0}\\cos\\theta)$。然而，为了后续计算的一致性，通常只需要零阶项 $R_0^2$。我们列出领头阶项：\n$g_{\\psi\\psi} = \\frac{1}{r^2 B_0^2 R_0^2}$, $g_{\\theta\\theta} = r^2$, and $g_{\\phi_B\\phi_B} \\approx R_0^2$。\n非零度规系数为 $g_{\\psi\\psi}$，$g_{\\theta\\theta}$ 和 $g_{\\phi_B\\phi_B}$。\n\n**任务2：磁场强度的梯度**\n\n在正交坐标系 $(\\psi, \\theta, \\phi_B)$ 中，标量 $B$ 的梯度为：\n$$\n\\nabla B = \\frac{1}{h_\\psi}\\frac{\\partial B}{\\partial \\psi}\\hat{\\mathbf{e}}_\\psi + \\frac{1}{h_\\theta}\\frac{\\partial B}{\\partial \\theta}\\hat{\\mathbf{e}}_\\theta + \\frac{1}{h_{\\phi_B}}\\frac{\\partial B}{\\partial \\phi_B}\\hat{\\mathbf{e}}_{\\phi_B}\n$$\n其中 $h_i = \\sqrt{g_{ii}}$ 是尺度因子，$\\hat{\\mathbf{e}}_i$ 构成标准正交基。\n$$\nh_\\psi = \\sqrt{g_{\\psi\\psi}} = \\frac{1}{r B_0 R_0} \\quad, \\quad h_\\theta = \\sqrt{g_{\\theta\\theta}} = r \\quad, \\quad h_{\\phi_B} = \\sqrt{g_{\\phi_B\\phi_B}} = R_0+r\\cos\\theta \\approx R_0\n$$\n磁场强度为 $B \\approx \\frac{B_0 R_0}{R}(1 + \\delta \\cos(N\\phi_B))$。我们将 $1/R$ 在 $r/R_0 \\ll 1$ 的条件下展开：\n$$\n\\frac{1}{R} = \\frac{1}{R_0+r\\cos\\theta} = \\frac{1}{R_0(1+\\frac{r}{R_0}\\cos\\theta)} \\approx \\frac{1}{R_0}\\left(1-\\frac{r}{R_0}\\cos\\theta\\right)\n$$\n将此代入 $B$ 的表达式中：\n$$\nB \\approx \\frac{B_0 R_0}{R_0}\\left(1-\\frac{r}{R_0}\\cos\\theta\\right)(1 + \\delta \\cos(N\\phi_B)) \\approx B_0\\left(1 - \\frac{r}{R_0}\\cos\\theta + \\delta\\cos(N\\phi_B)\\right)\n$$\n我们忽略了小参数 $\\delta \\cdot (r/R_0)$ 的乘积。\n现在，我们计算 $B$ 对各坐标的偏导数，注意 $r=r(\\psi)$：\n$$\n\\frac{\\partial B}{\\partial \\psi} = \\frac{\\partial B}{\\partial r}\\frac{\\partial r}{\\partial \\psi} \\approx \\left(-\\frac{B_0}{R_0}\\cos\\theta\\right)\\left(\\frac{1}{r B_0 R_0}\\right) = -\\frac{\\cos\\theta}{r R_0^2}\n$$\n$$\n\\frac{\\partial B}{\\partial \\theta} \\approx B_0 \\frac{\\partial}{\\partial \\theta}\\left(-\\frac{r}{R_0}\\cos\\theta\\right) = \\frac{B_0 r}{R_0}\\sin\\theta\n$$\n$$\n\\frac{\\partial B}{\\partial \\phi_B} \\approx B_0 \\frac{\\partial}{\\partial \\phi_B}(\\delta\\cos(N\\phi_B)) = -B_0 N \\delta \\sin(N\\phi_B)\n$$\n在标准正交基 $(\\hat{\\mathbf{e}}_\\psi, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_{\\phi_B})$ 中，梯度的分量为：\n$$\n(\\nabla B)_\\psi = \\frac{1}{h_\\psi}\\frac{\\partial B}{\\partial \\psi} = (r B_0 R_0)\\left(-\\frac{\\cos\\theta}{r R_0^2}\\right) = -\\frac{B_0}{R_0}\\cos\\theta\n$$\n$$\n(\\nabla B)_\\theta = \\frac{1}{h_\\theta}\\frac{\\partial B}{\\partial \\theta} = \\frac{1}{r}\\left(\\frac{B_0 r}{R_0}\\sin\\theta\\right) = \\frac{B_0}{R_0}\\sin\\theta\n$$\n$$\n(\\nabla B)_{\\phi_B} = \\frac{1}{h_{\\phi_B}}\\frac{\\partial B}{\\partial \\phi_B} \\approx \\frac{1}{R_0}(-B_0 N \\delta \\sin(N\\phi_B)) = -\\frac{B_0 N \\delta}{R_0}\\sin(N\\phi_B)\n$$\n梯度矢量为：\n$$\n\\nabla B \\approx \\left(-\\frac{B_0}{R_0}\\cos\\theta\\right)\\hat{\\mathbf{e}}_\\psi + \\left(\\frac{B_0}{R_0}\\sin\\theta\\right)\\hat{\\mathbf{e}}_\\theta - \\left(\\frac{B_0 N \\delta}{R_0}\\sin(N\\phi_B)\\right)\\hat{\\mathbf{e}}_{\\phi_B}\n$$\n前两个分量来自环向曲率引起的极向变化，第三个分量来自环向场波纹。\n\n**任务3：径向梯度B漂移速度**\n\n梯度B漂移速度为 $\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\times\\nabla B$。我们要求其径向分量 $v_{\\nabla B,r} = \\mathbf{v}_{\\nabla B} \\cdot \\hat{\\mathbf{e}}_r$。径向方向对应于 $\\psi$ 方向，因此 $\\hat{\\mathbf{e}}_r = \\hat{\\mathbf{e}}_\\psi$。\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\,(\\mathbf{B}\\times\\nabla B) \\cdot \\hat{\\mathbf{e}}_\\psi\n$$\n使用标量三重积恒等式 $(\\mathbf{A}\\times\\mathbf{B})\\cdot\\mathbf{C} = \\mathbf{A}\\cdot(\\mathbf{B}\\times\\mathbf{C})$，这可以写成：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\,\\mathbf{B}\\cdot(\\nabla B \\times \\hat{\\mathbf{e}}_\\psi)\n$$\n磁场矢量给出为 $\\mathbf{B} \\approx B_\\theta \\hat{\\mathbf{e}}_\\theta + B_\\phi \\hat{\\mathbf{e}}_{\\phi_B}$，其中 $B_\\phi$ 与 $B_{\\phi_B}$ 等同。\n在右手标准正交基 $(\\hat{\\mathbf{e}}_\\psi, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_{\\phi_B})$ 中，叉积 $\\nabla B \\times \\hat{\\mathbf{e}}_\\psi$ 为：\n$$\n\\nabla B \\times \\hat{\\mathbf{e}}_\\psi = ((\\nabla B)_\\psi \\hat{\\mathbf{e}}_\\psi + (\\nabla B)_\\theta \\hat{\\mathbf{e}}_\\theta + (\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_{\\phi_B}) \\times \\hat{\\mathbf{e}}_\\psi = (\\nabla B)_\\theta (\\hat{\\mathbf{e}}_\\theta \\times \\hat{\\mathbf{e}}_\\psi) + (\\nabla B)_{\\phi_B} (\\hat{\\mathbf{e}}_{\\phi_B} \\times \\hat{\\mathbf{e}}_\\psi)\n$$\n$$\n= (\\nabla B)_\\theta (-\\hat{\\mathbf{e}}_{\\phi_B}) + (\\nabla B)_{\\phi_B} (\\hat{\\mathbf{e}}_\\theta) = (\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_\\theta - (\\nabla B)_\\theta \\hat{\\mathbf{e}}_{\\phi_B}\n$$\n现在，我们计算与 $\\mathbf{B}$ 的点积：\n$$\n\\mathbf{B} \\cdot (\\nabla B \\times \\hat{\\mathbf{e}}_\\psi) = (B_\\theta \\hat{\\mathbf{e}}_\\theta + B_{\\phi_B} \\hat{\\mathbf{e}}_{\\phi_B}) \\cdot ((\\nabla B)_{\\phi_B} \\hat{\\mathbf{e}}_\\theta - (\\nabla B)_\\theta \\hat{\\mathbf{e}}_{\\phi_B}) = B_\\theta (\\nabla B)_{\\phi_B} - B_{\\phi_B} (\\nabla B)_\\theta\n$$\n因此径向漂移为：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B^2}\\left[B_\\theta (\\nabla B)_{\\phi_B} - B_{\\phi_B} (\\nabla B)_\\theta\\right]\n$$\n我们在指定位置计算该表达式：外侧中平面（$\\theta=0$）和最大波纹梯度处（$N\\phi_B = \\frac{\\pi}{2}$）。\n在此位置，我们使用给定的近似：$B_\\phi \\approx B_{\\phi_B} \\approx B_0$，$B_\\theta \\approx \\frac{B_0 r}{q_s R_0}$，以及 $B \\approx B_0$。\n来自任务2的梯度分量变为：\n$$\n(\\nabla B)_\\theta = \\frac{B_0}{R_0}\\sin(0) = 0\n$$\n$$\n(\\nabla B)_{\\phi_B} = -\\frac{B_0 N \\delta}{R_0}\\sin\\left(\\frac{\\pi}{2}\\right) = -\\frac{B_0 N \\delta}{R_0}\n$$\n将这些值代入 $v_{\\nabla B,r}$ 的表达式中：\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B_0^2}\\left[ \\left(\\frac{B_0 r}{q_s R_0}\\right) \\left(-\\frac{B_0 N \\delta}{R_0}\\right) - (B_0)(0) \\right]\n$$\n$$\nv_{\\nabla B,r} = \\frac{\\mu}{q_p B_0^2}\\left[ -\\frac{B_0^2 N \\delta r}{q_s R_0^2} \\right]\n$$\n$$\nv_{\\nabla B,r} = -\\frac{\\mu N \\delta r}{q_p q_s R_0^2}\n$$\n这是在指定点由环向场波纹驱动的径向梯度B漂移速度的最终表达式。负号表示在典型配置下（例如，正离子 $q_p0$，$\\mu0$）的内向漂移。根据要求，该表达式的单位是速度。",
            "answer": "$$\n\\boxed{-\\frac{\\mu N \\delta r}{q_{p} q_{s} R_{0}^{2}}}\n$$"
        },
        {
            "introduction": "弥合理论与实验现实之间的鸿沟是计算科学的基石。这最后一个实践  将挑战你开发并验证一个针对真实装置数据的环向纹波幅度分布计算模型。你将从静磁学出发，推导一个基于物理的模型，然后通过代码实现它，以对其预测进行基准测试，从而量化模型的准确性并理解其局限性。",
            "id": "4041617",
            "problem": "您的任务是，从第一性原理出发，为托卡马克中的环向场波纹幅度剖面构建一个计算模型，并与两个装置的代表性测量剖面进行基准比较：欧洲联合环 (Joint European Torus, JET) 和日本60兆安升级版托卡马克 (Japan Tokamak-60 Upgrade, JT-60U)。波纹幅度是由于环向场线圈数量离散而引起的环向磁场的相对变化，并且观察到该幅度朝向等离子体边缘增加。必须以归一化小半径 $r/a$ 的函数形式进行比较，其中 $r$ 是小半径，$a$ 是等离子体边界处的小半径。\n\n从真空中的静磁学出发，在所分析区域内没有电流的情况下，引用麦克斯韦方程组，即 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = \\mathbf{0}$，这允许引入满足拉普拉斯方程 $\\nabla^2 \\Phi = 0$ 的磁标势 $\\Phi$。将环向装置建模为一个半径为 $a$ 的局部圆柱形区域，并将由离散数量的环向场线圈 $N_{\\mathrm{TF}}$ 施加的环向周期性近似为环向上的谐波边界条件，该条件由一个有效轴向波数表征。认识到在这种圆柱近似中，径向依赖性的解源于变量分离法，并涉及修正贝塞尔函数。使用此框架推导一个无量纲模型，用于描述波纹幅度剖面 $\\delta(r/a)$，该模型依赖于 $N_{\\mathrm{TF}}$、大半径 $R_0$ 和小半径 $a$，并且该模型在 $r/a = 1$ 处能恢复给定的边缘波纹幅度。\n\n为您提供了两个装置（JET 和 JT-60U）的测量波纹幅度数据，作为 $r/a$ 的函数。将这些测量值视为已发布行为的代表性数字化结果，并使用它们来定量评估您的模型。您必须：\n\n1.  在上述圆柱真空近似下，推导波纹幅度 $\\delta(r/a)$ 的模型表达式。\n2.  在代码中实现推导出的表达式，为每个装置在给定的 $r/a$ 点上计算预测的波纹幅度剖面。\n3.  计算您的模型预测与每个装置的测量值之间的均方根误差 (RMSE) 和最大绝对误差。\n4.  通过检查 RMSE 是否低于特定于装置的容差，来确定模型是否对每个装置“通过”。\n\n所有长度必须以米为单位表示。波纹幅度是无量纲的。角度不直接出现在计算中，因此不需要指定角度单位。归一化半径 $r/a$ 是无量纲的。\n\n使用以下装置参数和测量数据的测试套件：\n\n- 装置 1 (JET):\n    - $N_{\\mathrm{TF}} = 32$, $R_0 = 2.96\\,\\mathrm{m}$, $a = 1.25\\,\\mathrm{m}$。\n    - 边缘波纹幅度参数 $\\delta_a = 0.0065$ (无量纲)。\n    - $r/a$ 点: $[0.0, 0.2, 0.4, 0.6, 0.8, 0.95]$。\n    - 在这些点测量的 $\\delta$ 值: $[0.00005, 0.00030, 0.00090, 0.00210, 0.00460, 0.00580]$。\n    - RMSE 容差: $0.0015$。\n- 装置 2 (JT-60U):\n    - $N_{\\mathrm{TF}} = 18$, $R_0 = 3.00\\,\\mathrm{m}$, $a = 1.00\\,\\mathrm{m}$。\n    - 边缘波纹幅度参数 $\\delta_a = 0.0160$ (无量纲)。\n    - $r/a$ 点: $[0.0, 0.2, 0.4, 0.6, 0.8, 0.95]$。\n    - 在这些点测量的 $\\delta$ 值: $[0.00020, 0.00080, 0.00250, 0.00650, 0.01200, 0.01450]$。\n    - RMSE 容差: $0.0030$。\n- 装置 3 (SymmTok, 合成的理想化对称参考):\n    - $N_{\\mathrm{TF}} = 360$, $R_0 = 3.00\\,\\mathrm{m}$, $a = 1.00\\,\\mathrm{m}$。\n    - 边缘波纹幅度参数 $\\delta_a = 0.0000$ (无量纲)。\n    - $r/a$ 点: $[0.0, 0.25, 0.50, 0.75, 1.00]$。\n    - 在这些点测量的 $\\delta$ 值: $[0.0, 0.0, 0.0, 0.0, 0.0]$。\n    - RMSE 容差: $1\\times 10^{-12}$。\n\n您的程序必须为每个装置计算 RMSE 和最大绝对误差，然后使用指定的容差评估一个布尔值的通过/失败。最终程序输出必须是单行，包含一个方括号括起来的逗号分隔列表，按此顺序包含以下九个条目：\n$[$JET 的 RMSE$, $JT\\text{-}60\\mathrm{U} 的 RMSE$, $SymmTok 的 RMSE$, $JET 的 max\\ error$, $JT\\text{-}60\\mathrm{U} 的 max\\ error$, $SymmTok 的 max\\ error$, $JET 的 pass$, $JT\\text{-}60\\mathrm{U} 的 pass$, $SymmTok 的 pass$]$。\n\n所有数值输出必须是原始浮点数和布尔值。不应打印任何附加文本。\n\n您的程序应生成一行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来（例如，$[$result1$, $result2$, $result3$]$）。",
            "solution": "该问题被评估为有效，因为它在科学上基于静磁学，设定良好，数据充分且一致，并且表述客观。解决方案的步骤是，首先推导环向场波纹幅度的理论模型，然后通过计算实现该模型以分析所提供的数据。\n\n### 1. 波纹幅度模型的推导\n\n推导从指定的无源区静磁学基本原理开始。在等离子体体积内部，我们假设一个没有电流的真空场，因此麦克斯韦方程组简化为 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = \\mathbf{0}$。磁场 $\\mathbf{B}$ 的无旋条件允许我们定义一个磁标势 $\\Phi$，使得 $\\mathbf{B} = -\\nabla \\Phi$。将其代入无散条件，得到势的拉普拉斯方程：\n$$ \\nabla^2 \\Phi = 0 $$\n问题要求我们将环形等离子体建模为一个局部圆柱形区域。我们使用圆柱坐标 $(r, \\theta, z)$，其中 $r$ 是小半径，$\\theta$ 是极向角，$z$ 代表环向。波纹是一种随小半径 $r$ 和环向坐标 $z$ 变化的扰动，但对于这个简化模型，可以假设它与极向角 $\\theta$ 无关（即 $\\partial/\\partial\\theta = 0$）。在这些坐标下拉普拉斯算子简化为：\n$$ \\nabla^2 \\Phi = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\Phi}{\\partial r} \\right) + \\frac{\\partial^2 \\Phi}{\\partial z^2} = 0 $$\n我们使用分离变量法寻找波纹势 $\\Phi(r, z)$ 的解，假设解的形式为 $\\Phi(r, z) = R(r)Z(z)$。将其代入方程并分离变量得到：\n$$ \\frac{1}{r R(r)} \\frac{d}{dr} \\left( r \\frac{dR}{dr} \\right) = -\\frac{1}{Z(z)} \\frac{d^2 Z}{dz^2} = k^2 $$\n其中 $k^2$ 是分离常数。\n\n轴向方程为：\n$$ \\frac{d^2 Z}{dz^2} + k^2 Z = 0 $$\n波纹是由 $N_{\\mathrm{TF}}$ 个离散的环向场线圈分布在近似为 $2\\pi R_0$ 的环向周长上引起的。这给场施加了周期性。这个周期结构在环向上的基波波长是 $\\lambda_z = 2\\pi R_0 / N_{\\mathrm{TF}}$。相应的波数是 $k = 2\\pi/\\lambda_z = N_{\\mathrm{TF}}/R_0$。$Z(z)$ 的解是一个谐波函数，我们可以写成 $Z(z) \\propto \\cos(kz)$。\n\n径向方程为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR}{dr} \\right) - k^2 R(r) = 0 $$\n两边乘以 $r^2$ 得到标准形式的零阶修正贝塞尔方程：\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} - (kr)^2 R = 0 $$\n通解是第一类 ($I_0$) 和第二类 ($K_0$) 修正贝塞尔函数的线性组合：\n$$ R(r) = C_1 I_0(kr) + C_2 K_0(kr) $$\n为了使解在等离子体柱 ($0 \\le r \\le a$) 内物理有效，它在轴线 ($r=0$) 处必须是有限的。函数 $K_0(x)$ 在 $x \\to 0$ 时发散，而 $I_0(x)$ 是有限的 ($I_0(0)=1$)。因此，我们必须设 $C_2=0$，径向解为 $R(r) \\propto I_0(kr)$。\n\n结合径向和轴向解，波纹势具有以下形式：\n$$ \\Phi(r, z) = C \\cdot I_0(kr) \\cos(kz) $$\n其中 $C$ 是一个常数。波纹是环向磁场的变化，在此坐标系中即为 $z$ 分量 $B_z$。波纹场 $\\tilde{B}_z$ 是随 $z$ 变化的部分：\n$$ \\tilde{B}_z = -\\frac{\\partial \\Phi}{\\partial z} = C k I_0(kr) \\sin(kz) $$\n总环向场为 $B_z(r, z) = B_{z,\\text{avg}}(r) + \\tilde{B}_z(r, z)$。波纹幅度 $\\delta$ 定义为相对变化：\n$$ \\delta(r) = \\frac{B_{z,\\max}(r) - B_{z,\\min}(r)}{B_{z,\\max}(r) + B_{z,\\min}(r)} $$\n在给定半径 $r$ 处，最大和最小场出现在 $\\sin(kz) = \\pm 1$ 时。因此，$B_{z,\\max/min} = B_{z,\\text{avg}} \\pm C k I_0(kr)$。将这些代入 $\\delta$ 的定义中得到：\n$$ \\delta(r) = \\frac{(B_{z,\\text{avg}} + C k I_0(kr)) - (B_{z,\\text{avg}} - C k I_0(kr))}{(B_{z,\\text{avg}} + C k I_0(kr)) + (B_{z,\\text{avg}} - C k I_0(kr))} = \\frac{2 C k I_0(kr)}{2 B_{z,\\text{avg}}} \\propto I_0(kr) $$\n在小半径 $r$ 处的波纹幅度与 $I_0(kr)$ 成正比。我们将其写作 $\\delta(r) = C' I_0(kr)$。\n比例常数 $C'$ 由给定的边界条件确定：在等离子体边缘 ($r=a$)，波纹为 $\\delta(a) = \\delta_a$。\n$$ \\delta_a = C' I_0(ka) \\implies C' = \\frac{\\delta_a}{I_0(ka)} $$\n将 $C'$ 代回，得到波纹剖面的最终模型：\n$$ \\delta(r) = \\delta_a \\frac{I_0(kr)}{I_0(ka)} $$\n最后，我们用给定的参数和归一化小半径 $\\rho = r/a$ 来表示。由于 $k = N_{\\mathrm{TF}}/R_0$ 和 $r = \\rho a$，贝塞尔函数的自变量变为 $kr = (\\frac{N_{\\mathrm{TF}}}{R_0})(\\rho a) = \\rho \\frac{N_{\\mathrm{TF}}a}{R_0}$。\n待实现的推导模型是：\n$$ \\delta(\\rho) = \\delta_a \\frac{I_0(\\rho \\cdot N_{\\mathrm{TF}}a/R_0)}{I_0(N_{\\mathrm{TF}}a/R_0)} $$\n\n### 2. 计算实现与误差分析\n\n推导出的公式在 Python 脚本中实现。对于每个装置，我们执行以下步骤：\n1.  定义装置参数：线圈数 $N_{\\mathrm{TF}}$、大半径 $R_0$、小半径 $a$ 和边缘波纹 $\\delta_a$。\n2.  计算边缘处贝塞尔函数的无量纲常数参数 $\\alpha = N_{\\mathrm{TF}}a/R_0$。\n3.  对于每个给定的归一化半径点 $\\rho_i = (r/a)_i$，使用模型计算预测的波纹幅度 $\\delta_{\\text{pred},i}$：$\\delta_{\\text{pred},i} = \\delta_a \\cdot I_0(\\rho_i \\alpha) / I_0(\\alpha)$。使用 `scipy.special.i0` 函数计算修正贝塞尔函数 $I_0(x)$。\n4.  $\\delta_a=0$ 的 SymmTok 特殊情况直接处理，得到处处为 0 的预测波纹，正如预期。\n5.  利用预测值数组 $\\delta_{\\text{pred}}$ 和测量值数组 $\\delta_{\\text{meas}}$ 计算误差。\n6.  均方根误差 (RMSE) 计算公式为 $\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\delta_{\\text{pred},i} - \\delta_{\\text{meas},i})^2}$，其中 $N$ 是数据点数。\n7.  最大绝对误差计算公式为 $\\max_i |\\delta_{\\text{pred},i} - \\delta_{\\text{meas},i}|$。\n8.  通过将计算出的 RMSE 与指定的装置特定容差进行比较，确定布尔值的通过/失败状态：`pass = RMSE  rmse_tolerance`。\n将所有三个装置的结果收集并按要求格式化为单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes ripple amplitude profiles for tokamaks based on a cylindrical model,\n    and benchmarks them against measured data.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"JET\",\n            \"N_TF\": 32,\n            \"R0\": 2.96,\n            \"a\": 1.25,\n            \"delta_a\": 0.0065,\n            \"rho_points\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 0.95]),\n            \"delta_measured\": np.array([0.00005, 0.00030, 0.00090, 0.00210, 0.00460, 0.00580]),\n            \"rmse_tolerance\": 0.0015\n        },\n        {\n            \"name\": \"JT-60U\",\n            \"N_TF\": 18,\n            \"R0\": 3.00,\n            \"a\": 1.00,\n            \"delta_a\": 0.0160,\n            \"rho_points\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 0.95]),\n            \"delta_measured\": np.array([0.00020, 0.00080, 0.00250, 0.00650, 0.01200, 0.01450]),\n            \"rmse_tolerance\": 0.0030\n        },\n        {\n            \"name\": \"SymmTok\",\n            \"N_TF\": 360,\n            \"R0\": 3.00,\n            \"a\": 1.00,\n            \"delta_a\": 0.0,\n            \"rho_points\": np.array([0.0, 0.25, 0.50, 0.75, 1.00]),\n            \"delta_measured\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"rmse_tolerance\": 1e-12\n        }\n    ]\n\n    results_rmse = []\n    results_max_err = []\n    results_pass_fail = []\n\n    for case in test_cases:\n        # Unpack data for the current device\n        N_TF = case[\"N_TF\"]\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        delta_a = case[\"delta_a\"]\n        rho_points = case[\"rho_points\"]\n        delta_measured = case[\"delta_measured\"]\n        rmse_tolerance = case[\"rmse_tolerance\"]\n\n        # The derived model is delta(rho) = delta_a * I_0(rho * alpha) / I_0(alpha)\n        # where alpha = N_TF * a / R0\n        \n        # Handle the trivial case where edge ripple is zero.\n        if delta_a == 0.0:\n            delta_predicted = np.zeros_like(rho_points)\n        else:\n            # Dimensionless argument for the Bessel function\n            alpha = (N_TF * a) / R0\n            \n            # The value of I_0 at the edge (r=a, so rho=1)\n            I0_at_a = i0(alpha)\n            \n            # Arguments for I_0 at each evaluation point\n            bessel_args = rho_points * alpha\n            \n            # Values of I_0 at each evaluation point\n            I0_at_r = i0(bessel_args)\n            \n            # Calculate the predicted ripple profile\n            delta_predicted = delta_a * I0_at_r / I0_at_a\n\n        # Calculate errors\n        errors = delta_predicted - delta_measured\n        \n        # Calculate Root-Mean-Square Error (RMSE)\n        rmse = np.sqrt(np.mean(np.square(errors)))\n        \n        # Calculate Maximum Absolute Error\n        max_abs_error = np.max(np.abs(errors))\n        \n        # Determine if the model passes based on the RMSE tolerance\n        is_pass = rmse  rmse_tolerance\n\n        # Store results\n        results_rmse.append(rmse)\n        results_max_err.append(max_abs_error)\n        results_pass_fail.append(is_pass)\n    \n    # Combine all results into a single list as per the problem specification\n    final_results = results_rmse + results_max_err + results_pass_fail\n    \n    # Format the final output string exactly as required\n    output_string = f\"[{','.join(map(str, final_results))}]\"\n\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}