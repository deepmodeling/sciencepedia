{
    "hands_on_practices": [
        {
            "introduction": "To understand neoclassical effects, we must first appreciate how toroidal geometry fundamentally alters plasma behavior compared to a simple cylinder. This practice guides you through an essential analytical derivation that reveals the origin of the Pfirsch-Schlüter current, which arises to maintain charge conservation in a spatially varying magnetic field. By calculating the crucial geometric factor $\\langle B^{-2} \\rangle$, you will gain a first-principles understanding of how the magnetic field structure directly impacts plasma currents and enhances effective resistivity .",
            "id": "4017815",
            "problem": "A circular, concentric, large-aspect-ratio tokamak has major radius $R_{0}$ and minor radius $r$, with inverse aspect ratio $\\varepsilon \\equiv r/R_{0} \\ll 1$. Assume axisymmetry and that the magnetic field on a given flux surface is dominated by the toroidal component so that, to leading order in $\\varepsilon$, its magnitude varies with poloidal angle $\\theta$ as $B(\\theta) = B_{0} R_{0}/R(\\theta)$, where $R(\\theta) = R_{0} \\left(1 + \\varepsilon \\cos\\theta\\right)$ and $B_{0}$ is the toroidal field at the magnetic axis. The flux-surface average of a scalar $g(\\theta)$ is defined by the area-average on the flux surface,\n$$\n\\langle g \\rangle \\equiv \\frac{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} g(\\theta)\\, dS}{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} dS}, \\quad dS = r\\,R(\\theta)\\, d\\theta\\, d\\varphi,\n$$\nwith $\\varphi$ the toroidal angle. \n\nStarting from magnetohydrodynamic force balance and current continuity, derive the Pfirsch–Schlüter parallel current $j_{\\mathrm{PS},\\parallel}$ on a flux surface in an axisymmetric tokamak with pressure $p = p(\\psi)$ constant on each surface of poloidal flux $\\psi$, showing that the geometric integral $\\langle B^{-2} \\rangle$ appears in the combination $B^{-2} - \\langle B^{-2} \\rangle$. Then, using the parallel component of Ohm’s law in the collisional regime with scalar parallel resistivity $\\eta_{\\parallel}$, show how $\\langle B^{-2} \\rangle$ enters the flux-surface averaged relation between the loop voltage drive and the net parallel current (the effective parallel resistivity).\n\nCompute explicitly the flux-surface average $\\langle B^{-2} \\rangle$ for the circular geometry defined above, retaining terms up to and including order $\\varepsilon^{2}$. Express your final answer as a closed-form analytic expression in terms of $B_{0}$ and $\\varepsilon$. No numerical rounding is required.",
            "solution": "### Part 1: Derivation of the Pfirsch-Schlüter Current\n\nThe starting points are the ideal MHD force balance equation and the current continuity equation in steady state:\n$$\n\\nabla p = \\mathbf{j} \\times \\mathbf{B}\n$$\n$$\n\\nabla \\cdot \\mathbf{j} = 0\n$$\nThe current density $\\mathbf{j}$ can be decomposed into components parallel and perpendicular to the magnetic field $\\mathbf{B}$: $\\mathbf{j} = j_{\\parallel} \\frac{\\mathbf{B}}{B} + \\mathbf{j}_{\\perp}$. From the force balance equation, the perpendicular component is the diamagnetic current:\n$$\n\\mathbf{j}_{\\perp} = \\frac{\\mathbf{B} \\times \\nabla p}{B^2}\n$$\nSubstituting the decomposition of $\\mathbf{j}$ into the continuity equation gives:\n$$\n\\nabla \\cdot \\left(j_{\\parallel} \\frac{\\mathbf{B}}{B}\\right) + \\nabla \\cdot \\mathbf{j}_{\\perp} = 0\n$$\nThe first term can be rewritten as $\\mathbf{B} \\cdot \\nabla (j_{\\parallel}/B)$, since $\\nabla \\cdot \\mathbf{B} = 0$. This yields:\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} \\right) = - \\nabla \\cdot \\mathbf{j}_{\\perp} = - \\nabla \\cdot \\left(\\frac{\\mathbf{B} \\times \\nabla p}{B^2}\\right)\n$$\nFor an axisymmetric system where pressure $p$ and the toroidal flux function $I \\equiv R B_{\\phi}$ are flux functions ($p=p(\\psi)$, $I=I(\\psi)$), a key identity is:\n$$\n\\nabla \\cdot \\left(\\frac{\\mathbf{B} \\times \\nabla p}{B^2}\\right) = -I(\\psi) p'(\\psi) \\left( \\mathbf{B} \\cdot \\nabla \\left( \\frac{1}{B^2} \\right) \\right)\n$$\nwhere $p'(\\psi) \\equiv dp/d\\psi$. Substituting this into the equation for $j_{\\parallel}/B$:\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} \\right) = I p' \\left( \\mathbf{B} \\cdot \\nabla \\left( \\frac{1}{B^2} \\right) \\right)\n$$\nRearranging the terms, we get:\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} - \\frac{I p'}{B^2} \\right) = 0\n$$\nThis equation states that the quantity inside the parenthesis does not vary along a magnetic field line. Since field lines on a rational flux surface ergodically cover the surface, this quantity must be a flux function, which we denote as $K(\\psi)$:\n$$\n\\frac{j_{\\parallel}}{B} - \\frac{I p'}{B^2} = K(\\psi)\n$$\nThis gives the structure of the total parallel current density:\n$$\nj_{\\parallel} = K(\\psi) B + \\frac{I p'}{B}\n$$\nThe parallel current is a sum of two terms. The term $K(\\psi)B$ is related to the net current driven by external means (like loop voltage) or the bootstrap effect. The second term, proportional to the pressure gradient $p'$, is required to maintain charge neutrality ($\\nabla \\cdot \\mathbf{j}=0$) in the presence of the poloidally varying diamagnetic current. This pressure-driven part of the parallel current is what gives rise to the Pfirsch-Schlüter current.\n\nThe Pfirsch-Schlüter current, $j_{\\mathrm{PS},\\parallel}$, is defined as the poloidally varying component of the parallel current driven by the pressure gradient. To isolate this varying part, we subtract its flux-surface average. We can define $j_{\\mathrm{PS},\\parallel}$ such that the corresponding value of $j_{\\mathrm{PS},\\parallel}/B$ has zero flux-surface average: $\\langle j_{\\mathrm{PS},\\parallel}/B \\rangle = 0$.\nThe pressure-driven part of $j_{\\parallel}/B$ is $I p' / B^2$. We can decompose this into its average and varying parts:\n$$\n\\frac{I p'}{B^2} = I p' \\langle B^{-2} \\rangle + I p' \\left( B^{-2} - \\langle B^{-2} \\rangle \\right)\n$$\nThe first term is a flux function, while the second term has zero flux-surface average. The first term can be absorbed into the definition of $K(\\psi)$, representing the pressure-driven part of the net current (bootstrap current). The second term represents the oscillating part of the parallel current needed for charge conservation. Thus, the quantity corresponding to the Pfirsch-Schlüter current is:\n$$\n\\frac{j_{\\mathrm{PS},\\parallel}}{B} = I p' \\left( \\frac{1}{B^2} - \\left\\langle \\frac{1}{B^2} \\right\\rangle \\right)\n$$\nThis shows that the geometric integral $\\langle B^{-2} \\rangle$ appears in the combination $B^{-2} - \\langle B^{-2} \\rangle$ in the expression for the normalized Pfirsch-Schlüter current.\n\n### Part 2: Effective Parallel Resistivity\n\nIn the collisional regime, the parallel component of Ohm's law is $E_{\\parallel} = \\eta_{\\parallel} j_{\\parallel}$. In a toroidal geometry, the total parallel current $j_{\\parallel}$ consists of a net current (driven by the loop voltage or bootstrap effect) and the oscillating Pfirsch-Schlüter current, $j_{\\mathrm{PS},\\parallel}$. The total Ohmic power dissipated on a flux surface is $P_{diss} = \\langle \\eta_{\\parallel} j_{\\parallel}^2 \\rangle$. This dissipation is larger than what would be caused by the net current alone due to the presence of $j_{\\mathrm{PS},\\parallel}$. An effective parallel resistivity, $\\eta_{eff}$, is defined to account for this enhanced dissipation for a given net current. From Part 1, the magnitude of $j_{\\mathrm{PS},\\parallel}$ is proportional to the geometric factor $(B^{-2} - \\langle B^{-2} \\rangle)$. Therefore, the additional power dissipation due to this current, $\\langle \\eta_{\\parallel} j_{\\mathrm{PS},\\parallel}^2 \\rangle$, depends on this geometric factor. This is how the flux-surface average $\\langle B^{-2} \\rangle$ (or more accurately, $\\langle 1/B^2 \\rangle$) enters into the calculation of the effective parallel resistivity, which is enhanced above the classical value.\n\n### Part 3: Explicit Calculation of $\\langle B^{-2} \\rangle$\n\nFirst, we must evaluate the averaging operator $\\langle \\cdot \\rangle$ for the given geometry.\n$$\n\\langle g \\rangle = \\frac{\\int_{0}^{2\\pi} d\\varphi \\int_{0}^{2\\pi} g(\\theta) r R(\\theta) d\\theta}{\\int_{0}^{2\\pi} d\\varphi \\int_{0}^{2\\pi} r R(\\theta) d\\theta} = \\frac{2\\pi r \\int_{0}^{2\\pi} g(\\theta) R_0(1+\\varepsilon\\cos\\theta) d\\theta}{2\\pi r \\int_{0}^{2\\pi} R_0(1+\\varepsilon\\cos\\theta) d\\theta}\n$$\nThe denominator integral is $\\int_{0}^{2\\pi} (1+\\varepsilon\\cos\\theta) d\\theta = [\\theta + \\varepsilon\\sin\\theta]_0^{2\\pi} = 2\\pi$. So, the averaging operator simplifies to:\n$$\n\\langle g \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} g(\\theta)(1+\\varepsilon\\cos\\theta) d\\theta\n$$\nWe need to compute $\\langle B^{-2} \\rangle$. The magnetic field strength is $B = B_0(1+\\varepsilon\\cos\\theta)^{-1}$.\nTherefore, $B^{-2} = B_0^{-2}(1+\\varepsilon\\cos\\theta)^2$.\nExpanding this term:\n$$\nB^{-2} = B_0^{-2} (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta)\n$$\nNow, we apply the averaging operator:\n$$\n\\langle B^{-2} \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} B_0^{-2} (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta) (1+\\varepsilon\\cos\\theta) d\\theta\n$$\nWe expand the integrand, keeping terms up to $\\varepsilon^2$:\n$$\n(1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta) (1+\\varepsilon\\cos\\theta) = 1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta + \\varepsilon\\cos\\theta + 2\\varepsilon^2\\cos^2\\theta + O(\\varepsilon^3)\n$$\n$$\n= 1 + 3\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta + O(\\varepsilon^3)\n$$\nThe integral becomes:\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} \\int_{0}^{2\\pi} (1 + 3\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta) d\\theta\n$$\nWe evaluate the integrals of the trigonometric terms over $[0, 2\\pi]$:\n-   $\\int_{0}^{2\\pi} 1 \\, d\\theta = 2\\pi$\n-   $\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = [\\sin\\theta]_0^{2\\pi} = 0$\n-   $\\int_{0}^{2\\pi} \\cos^2\\theta \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2\\theta)}{2} \\, d\\theta = \\frac{1}{2} \\left[\\theta + \\frac{\\sin(2\\theta)}{2}\\right]_0^{2\\pi} = \\pi$\n\nSubstituting these results into the expression for $\\langle B^{-2} \\rangle$:\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} \\left( 1 \\cdot (2\\pi) + 3\\varepsilon \\cdot (0) + 3\\varepsilon^2 \\cdot (\\pi) \\right)\n$$\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} (2\\pi + 3\\pi\\varepsilon^2)\n$$\n$$\n\\langle B^{-2} \\rangle = B_0^{-2} \\left(1 + \\frac{3}{2}\\varepsilon^2\\right)\n$$\nThis is the final expression for the flux-surface average of $B^{-2}$ up to order $\\varepsilon^2$.",
            "answer": "$$\n\\boxed{B_0^{-2} \\left(1 + \\frac{3}{2}\\varepsilon^2\\right)}\n$$"
        },
        {
            "introduction": "The net current in a tokamak is a combination of externally driven and self-generated components. This exercise moves from the foundational geometry of the previous problem to a practical application, dissecting the total parallel current into its Ohmic, bootstrap, and Pfirsch-Schlüter parts. Through a quantitative analysis, you will develop an intuition for the operational regimes of modern fusion devices where the self-generated bootstrap current can dominate, and you will solidify your understanding of why the oscillating Pfirsch-Schlüter current, while locally large, does not contribute to the net toroidal current .",
            "id": "4017785",
            "problem": "Consider a large-aspect-ratio, axisymmetric tokamak with circular flux surfaces in steady-state, where the minor radius is $a$ and the major radius is $R$, so the inverse aspect ratio is $\\epsilon = a/R \\ll 1$. Assume collisional electron dynamics are described by a parallel force balance without inertia, and the system is quasi-neutral. Let the flux-surface average (FSA) operator be denoted by $\\langle \\cdot \\rangle$, defined over the poloidal angle with the appropriate Jacobian for axisymmetric geometry. The magnetic field is predominantly toroidal with magnitude $B$, and the safety factor is $q$. The parallel electric field is produced by a uniform toroidal electric field $E_{\\phi}$, so $E_{\\parallel} \\approx E_{\\phi} B_{\\phi}/B \\approx E_{\\phi}$ under large-aspect-ratio ordering. The plasma has a radial pressure gradient $dp/dr < 0$ at the radius of interest.\n\nStarting from the steady-state charge continuity equation $\\nabla \\cdot \\mathbf{j} = 0$ and the requirement that the total current be divergence-free on each flux surface, argue from first principles why the flux-surface average of the Pfirsch–Schlüter (PS) parallel current $\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle$ must vanish in an axisymmetric equilibrium. Then, model the flux-surface averaged parallel current density as the sum of an $E_{\\parallel}$-driven (Ohmic) component and a gradient-driven bootstrap component,\n$$\n\\langle j_{\\parallel} \\rangle = \\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle + \\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle,\n$$\nwith the parallel Ohmic response given by a neoclassical parallel conductivity $\\sigma_{\\parallel}$ via\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = \\sigma_{\\parallel} E_{\\parallel},\n$$\nand the bootstrap component in the large-aspect-ratio banana–plateau regime approximated by the closure\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - \\alpha \\frac{q}{\\epsilon B} \\frac{dp}{dr},\n$$\nwhere $\\alpha$ is a dimensionless coefficient of order unity encoding the trapped-particle physics and weak collisionality dependence.\n\nUse the following parameter values at the flux surface of interest:\n- $B = 3.0$ T,\n- $q = 2.0$,\n- $\\epsilon = 0.20$,\n- $E_{\\phi} = 0.050$ V/m,\n- $\\sigma_{\\parallel} = 2.0 \\times 10^{6}$ S/m,\n- $\\frac{dp}{dr} = -6.0 \\times 10^{4}$ Pa/m,\n- $\\alpha = 0.75$.\n\nCompute the fractions of the flux-surface averaged parallel current density carried by each mechanism,\n$$\nf_{\\mathrm{Ohm}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle}{\\langle j_{\\parallel} \\rangle}, \\quad\nf_{\\mathrm{PS}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle}{\\langle j_{\\parallel} \\rangle}, \\quad\nf_{\\mathrm{bs}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle}{\\langle j_{\\parallel} \\rangle},\n$$\nand express the final answer as a single row vector $\\left( f_{\\mathrm{Ohm}} \\ \\ f_{\\mathrm{PS}} \\ \\ f_{\\mathrm{bs}} \\right)$.\n\nRound your fractions to four significant figures. Fractions are dimensionless; no unit is required in the final answer.",
            "solution": "The solution proceeds in two parts as requested by the problem: first, an argument for the vanishing of the flux-surface averaged Pfirsch-Schlüter current, and second, the calculation of the current fractions.\n\n### Part 1: Argument for $\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle = 0$\n\nIn a steady-state plasma, the current density $\\mathbf{j}$ must be divergence-free to ensure charge conservation, as described by the continuity equation $\\nabla \\cdot \\mathbf{j} = 0$. The total current density can be decomposed into components parallel and perpendicular to the magnetic field $\\mathbf{B}$:\n$$\n\\mathbf{j} = j_{\\parallel} \\mathbf{b} + \\mathbf{j}_{\\perp}\n$$\nwhere $\\mathbf{b} = \\mathbf{B}/B$ is the unit vector along the magnetic field. Substituting this into the continuity equation gives:\n$$\n\\nabla \\cdot (j_{\\parallel} \\mathbf{b}) + \\nabla \\cdot \\mathbf{j}_{\\perp} = 0\n$$\nIn a simple cylindrical plasma, the magnetic field is uniform on a flux surface, and the perpendicular current (dominated by the diamagnetic current, $\\mathbf{j}_{\\perp} \\approx (\\mathbf{B} \\times \\nabla p)/B^2$) is divergence-free, so no parallel current is needed to maintain charge conservation.\n\nHowever, in a toroidal geometry like a tokamak, the magnetic field strength varies on a flux surface, typically as $B \\propto 1/(1+\\epsilon \\cos\\theta)$, where $\\theta$ is the poloidal angle. This variation in $B$, along with the curvature of the field lines, causes the divergence of the perpendicular current, $\\nabla \\cdot \\mathbf{j}_{\\perp}$, to be non-zero. This divergence has a poloidal dependence (e.g., proportional to $\\sin\\theta$) but its flux-surface average, $\\langle \\nabla \\cdot \\mathbf{j}_{\\perp} \\rangle$, is zero.\n\nTo satisfy $\\nabla \\cdot \\mathbf{j} = 0$ at every point on the flux surface, a poloidally varying parallel current must flow to cancel the divergence of the perpendicular current locally. This current is known as the Pfirsch-Schlüter (PS) current, $j_{\\parallel}^{\\mathrm{PS}}$. It is defined as the solution to:\n$$\n\\nabla \\cdot (j_{\\parallel}^{\\mathrm{PS}} \\mathbf{b}) = - \\nabla \\cdot \\mathbf{j}_{\\perp}\n$$\nThe total parallel current density $j_{\\parallel}$ can be formally decomposed into its flux-surface average $\\langle j_{\\parallel} \\rangle$ and a poloidally varying part $\\tilde{j}_{\\parallel}$:\n$$\nj_{\\parallel}(\\psi, \\theta) = \\langle j_{\\parallel} \\rangle(\\psi) + \\tilde{j}_{\\parallel}(\\psi, \\theta)\n$$\nBy definition, the flux-surface average of the varying part is zero: $\\langle \\tilde{j}_{\\parallel} \\rangle = 0$.\n\nThe Pfirsch-Schlüter current is precisely this poloidally varying component, $j_{\\parallel}^{\\mathrm{PS}} \\equiv \\tilde{j}_{\\parallel}$, which arises in response to the poloidally varying source term $- \\nabla \\cdot \\mathbf{j}_{\\perp}$. The flux-surface averaged current, $\\langle j_{\\parallel} \\rangle$, is driven by sources that are constant on a flux surface, such as the externally applied toroidal electric field (Ohmic drive) and the net effect of trapped particle orbits on the pressure gradient (bootstrap current).\n\nTherefore, by its very definition as the poloidally varying component of the parallel current that closes the perpendicular current loops, the flux-surface average of the Pfirsch-Schlüter current must be zero.\n$$\n\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle = 0\n$$\n\n### Part 2: Calculation of Current Fractions\n\nBased on the conclusion from Part 1, the fraction of the flux-surface averaged parallel current carried by the Pfirsch-Schlüter mechanism is:\n$$\nf_{\\mathrm{PS}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{0}{\\langle j_{\\parallel} \\rangle} = 0\n$$\nThe total flux-surface averaged parallel current is the sum of the Ohmic and bootstrap components:\n$$\n\\langle j_{\\parallel} \\rangle = \\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle + \\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle\n$$\nWe now calculate each component using the provided data.\n\nThe problem states $E_{\\parallel} \\approx E_{\\phi}$. The Ohmic component is:\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = \\sigma_{\\parallel} E_{\\phi}\n$$\nSubstituting the given values:\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = (2.0 \\times 10^{6} \\text{ S/m}) \\times (0.050 \\text{ V/m}) = 1.0 \\times 10^{5} \\text{ A/m}^2\n$$\nThe bootstrap component is given by:\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - \\alpha \\frac{q}{\\epsilon B} \\frac{dp}{dr}\n$$\nSubstituting the given values:\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - (0.75) \\frac{2.0}{(0.20)(3.0 \\text{ T})} (-6.0 \\times 10^{4} \\text{ Pa/m})\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - (0.75) \\frac{2.0}{0.60} (-6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = (0.75) \\left(\\frac{1}{0.30}\\right) (6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = (0.75) \\left(\\frac{10}{3}\\right) (6.0 \\times 10^{4}) \\text{ A/m}^2 = (0.25) \\times 10 \\times (6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = 1.5 \\times 10^{5} \\text{ A/m}^2\n$$\nThe total flux-surface averaged parallel current density is:\n$$\n\\langle j_{\\parallel} \\rangle = (1.0 \\times 10^{5} \\text{ A/m}^2) + (1.5 \\times 10^{5} \\text{ A/m}^2) = 2.5 \\times 10^{5} \\text{ A/m}^2\n$$\nNow we can compute the required fractions, rounded to four significant figures.\n\nFraction for the Ohmic component:\n$$\nf_{\\mathrm{Ohm}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{1.0 \\times 10^{5}}{2.5 \\times 10^{5}} = 0.4\n$$\nTo four significant figures, this is $0.4000$.\n\nFraction for the Pfirsch-Schlüter component:\n$$\nf_{\\mathrm{PS}} = 0\n$$\nTo four significant figures, this is $0.0000$.\n\nFraction for the bootstrap component:\n$$\nf_{\\mathrm{bs}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{1.5 \\times 10^{5}}{2.5 \\times 10^{5}} = 0.6\n$$\nTo four significant figures, this is $0.6000$.\n\nThe sum of the fractions is $f_{\\mathrm{Ohm}} + f_{\\mathrm{PS}} + f_{\\mathrm{bs}} = 0.4 + 0 + 0.6 = 1.0$, which serves as a consistency check.\n\nThe final answer is the row vector of these three fractions.\n$$\n\\left( f_{\\mathrm{Ohm}} \\ \\ f_{\\mathrm{PS}} \\ \\ f_{\\mathrm{bs}} \\right) = \\left( 0.4000 \\ \\ 0.0000 \\ \\ 0.6000 \\right)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4000 & 0.0000 & 0.6000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The coefficients used in neoclassical models, such as the parallel conductivity $\\sigma_{\\parallel}$, are not merely parameters but are the result of complex kinetic calculations. This advanced computational practice takes you to the heart of neoclassical theory, challenging you to derive and numerically solve the linearized drift-kinetic equation from first principles. By constructing a solver for the electron distribution function and computing $\\sigma_{\\parallel}$, you will bridge the gap between microscopic particle dynamics and the macroscopic transport laws that govern plasma confinement, a core skill in computational fusion science .",
            "id": "4017810",
            "problem": "You are tasked with constructing a self-contained numerical scheme that computes the parallel electrical conductivity $\\,\\sigma_\\parallel\\,$ for electrons in a strongly magnetized, axisymmetric plasma using a pitch-angle expansion and an energy grid. The derivation and algorithm must start from fundamental principles and definitions applicable to computational fusion science and engineering and must avoid invoking pre-derived shortcut formulas. The program must implement the computation and produce results for a specified test suite.\n\nConsider a homogeneous plasma with a uniform magnetic field direction and a spatially uniform parallel electric field $\\,E_\\parallel\\,$. Let $\\,f(\\boldsymbol{v}) = f_0(v) + f_1(v,\\xi)\\,$ be the electron distribution function, where $\\,f_0(v)\\,$ is the isotropic local Maxwellian and $\\,f_1(v,\\xi)\\,$ is the first-order perturbation due to $\\,E_\\parallel\\,$. The pitch-angle variable is $\\,\\xi = v_\\parallel / v \\in [-1,1]\\,$. The linear drift-kinetic equation (DKE) for electrons under these conditions is\n$$\nv_\\parallel \\nabla_\\parallel f_1(v,\\xi) + \\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0(v)}{\\partial v_\\parallel} = C[f_1],\n$$\nwhere $\\,e\\,$ is the elementary charge, $\\,m_e\\,$ is the electron mass, and $\\,C[\\cdot]\\,$ is the linearized collision operator. Assume spatial homogeneity along the field line so that $\\,\\nabla_\\parallel f_1 = 0\\,$. Model the collisions by the Lorentz pitch-angle scattering operator for electron-ion deflections,\n$$\nC_L[f_1] = \\nu_D(v) \\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial f_1}{\\partial \\xi}\\right],\n$$\nwhere the deflection frequency $\\,\\nu_D(v)\\,$ is taken as\n$$\n\\nu_D(v) = \\frac{n_i Z_i^2 e^4 \\ln \\Lambda}{4\\pi \\varepsilon_0^2 m_e^2 v^3},\n$$\nwith $\\,n_i\\,$ the ion density, $\\,Z_i\\,$ the ion charge state, $\\,\\ln \\Lambda\\,$ the Coulomb logarithm, and $\\,\\varepsilon_0\\,$ the vacuum permittivity.\n\nExpand the perturbation in Legendre polynomials $\\,P_\\ell(\\xi)\\,$ as\n$$\nf_1(v,\\xi) = \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) P_\\ell(\\xi).\n$$\nUsing orthogonality of $\\,P_\\ell\\,$ and the action of $\\,C_L\\,$ on the angular harmonics, derive the one-dimensional equations for $\\,g_\\ell(v)\\,$ and explain how the $\\,\\ell=1\\,$ component is driven by the parallel electric field through $\\,\\partial f_0/\\partial v_\\parallel\\,$. Let $\\,f_0(v)\\,$ be the isotropic Maxwellian,\n$$\nf_0(v) = n_e \\left(\\frac{m_e}{2\\pi T_e}\\right)^{3/2} \\exp\\!\\left(-\\frac{m_e v^2}{2 T_e}\\right),\n$$\nwhere $\\,n_e\\,$ is the electron density and $\\,T_e\\,$ is the electron temperature in Joules.\n\nDefine the parallel current density $\\,J_\\parallel\\,$ as\n$$\nJ_\\parallel = -e \\int v_\\parallel f_1(\\boldsymbol{v})\\, d^3 v,\n$$\nand define the parallel conductivity by the electron response as\n$$\n\\sigma_\\parallel \\equiv -\\frac{J_\\parallel}{E_\\parallel},\n$$\nso that $\\,\\sigma_\\parallel\\,$ is positive in a conventional Ohmic sense.\n\nYou must:\n- Derive the decoupled equation for $\\,g_1(v)\\,$ under the Lorentz pitch-angle scattering operator and express $\\,J_\\parallel\\,$ in terms of $\\,g_1(v)\\,$ and the velocity-space integrals over $\\,v\\,$ and $\\,\\xi\\,$. Use the orthogonality relations of $\\,P_\\ell(\\xi)\\,$ to carry out the angular integration.\n- Transform the remaining velocity integral to an energy integral $\\,\\varepsilon = m_e v^2 / 2\\,$ with an energy grid of $\\,N_\\varepsilon\\,$ points on $\\,\\varepsilon \\in [0,\\varepsilon_{\\max}]\\,$, where $\\,\\varepsilon_{\\max} = \\alpha T_e\\,$ and $\\,\\alpha > 0\\,$ is an energy-range factor. Specify how $\\,v\\,$ and the measure $\\,dv\\,$ map to $\\,\\varepsilon\\,$ and $\\,d\\varepsilon\\,$.\n- Formulate a trapezoidal-rule quadrature on the energy grid to compute $\\,\\sigma_\\parallel\\,$, maintaining dimensional consistency. All quantities must be in International System of Units (SI), with $\\,T_e\\,$ provided in electron-volts to be converted to Joules via $\\,T_e^{(\\mathrm{J})} = T_e^{(\\mathrm{eV})} e\\,$.\n\nConvergence criteria:\n- Energy-grid refinement: Let $\\,\\sigma_\\parallel(N_\\varepsilon)\\,$ be the conductivity computed with $\\,N_\\varepsilon\\,$ points. Define the energy-grid convergence boolean as true if\n$$\n\\left|\\frac{\\sigma_\\parallel(2 N_\\varepsilon) - \\sigma_\\parallel(N_\\varepsilon)}{\\sigma_\\parallel(2 N_\\varepsilon)}\\right| < \\tau_N,\n$$\nwith tolerance $\\,\\tau_N = 10^{-3}\\,$.\n- Pitch-angle expansion order: Compute $\\,\\sigma_\\parallel\\,$ with $\\,L_{\\max}=1\\,$ and $\\,L_{\\max}=3\\,$, and define the pitch-angle expansion convergence boolean as true if\n$$\n\\left|\\frac{\\sigma_\\parallel(L_{\\max}=3) - \\sigma_\\parallel(L_{\\max}=1)}{\\sigma_\\parallel(L_{\\max}=3)}\\right| < \\tau_L,\n$$\nwith tolerance $\\,\\tau_L = 10^{-8}\\,$.\n- Energy-range factor: Compute $\\,\\sigma_\\parallel\\,$ with $\\,\\alpha\\,$ and with $\\,1.3\\alpha\\,$, and define the energy-range convergence boolean as true if\n$$\n\\left|\\frac{\\sigma_\\parallel(1.3\\alpha) - \\sigma_\\parallel(\\alpha)}{\\sigma_\\parallel(1.3\\alpha)}\\right| < \\tau_R,\n$$\nwith tolerance $\\,\\tau_R = 10^{-3}\\,$.\n\nYour program must implement the above numerical scheme and produce the outputs for the following test suite. Each test case is given as a tuple $\\, (n_e, Z_i, T_e^{(\\mathrm{eV})}, \\ln \\Lambda, E_\\parallel, N_\\varepsilon, \\alpha)\\,$:\n1. $\\, (1.0\\times 10^{20}\\,\\mathrm{m}^{-3}, 1.0, 5000.0\\,\\mathrm{eV}, 17.0, 0.1\\,\\mathrm{V/m}, 200, 5.0)\\,$\n2. $\\, (1.0\\times 10^{20}\\,\\mathrm{m}^{-3}, 1.0, 20000.0\\,\\mathrm{eV}, 17.0, 0.1\\,\\mathrm{V/m}, 50, 5.0)\\,$\n3. $\\, (1.0\\times 10^{18}\\,\\mathrm{m}^{-3}, 1.0, 500.0\\,\\mathrm{eV}, 15.0, 1.0\\,\\mathrm{V/m}, 32, 4.0)\\,$\n4. $\\, (5.0\\times 10^{19}\\,\\mathrm{m}^{-3}, 2.0, 10000.0\\,\\mathrm{eV}, 18.0, 0.5\\,\\mathrm{V/m}, 100, 6.0)\\,$\n\nFinal output format:\n- Express each computed $\\,\\sigma_\\parallel\\,$ in Siemens per meter (S/m) as a float rounded to six significant digits.\n- For each test case, output four items in order: $\\,\\sigma_\\parallel\\,$, energy-grid convergence boolean, pitch-angle expansion convergence boolean, energy-range convergence boolean.\n- Your program should produce a single line of output containing all items across all test cases as a comma-separated list enclosed in square brackets, for example, $\\, [\\sigma_1,\\text{bool}_{1,N},\\text{bool}_{1,L},\\text{bool}_{1,R},\\sigma_2,\\ldots]\\,$.\n\nYour implementation must be a complete, runnable program and must not require any external input or files. Use only the Python standard library and the libraries specified in the execution environment. Ensure numerical stability and scientific plausibility in your constants and computations.",
            "solution": "The analytical solution begins with the linearized electron drift-kinetic equation (DKE) in a homogeneous plasma with a uniform parallel electric field $\\,E_\\parallel\\,$, under the assumption of spatial homogeneity ($\\,\\nabla_\\parallel f_1 = 0\\,$):\n$$\n\\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0(v)}{\\partial v_\\parallel} = C[f_1]\n$$\nHere, $\\,e\\,$ is the elementary charge, $\\,m_e\\,$ is the electron mass, $\\,f_0(v)\\,$ is the isotropic Maxwellian distribution, and $\\,f_1(v,\\xi)\\,$ is the kinetic perturbation. The collision operator $\\,C[\\cdot]\\,$ is the Lorentz pitch-angle scattering operator, $\\,C_L[\\cdot]\\,$:\n$$\nC_L[f_1] = \\nu_D(v) \\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial f_1}{\\partial \\xi}\\right]\n$$\nwhere $\\,\\xi = v_\\parallel/v\\,$ is the pitch-angle cosine and $\\,\\nu_D(v)\\,$ is the velocity-dependent deflection frequency.\n\nThe perturbation $\\,f_1\\,$ is expanded in Legendre polynomials $\\,P_\\ell(\\xi)\\,$:\n$$\nf_1(v,\\xi) = \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) P_\\ell(\\xi)\n$$\nWe project the DKE onto the Legendre basis to find equations for the expansion coefficients $\\,g_\\ell(v)\\,$.\n\nFirst, we analyze the source term (left-hand side). The Maxwellian distribution $\\,f_0(v) = n_e (m_e/2\\pi T_e)^{3/2} \\exp(-m_e v^2/2T_e)\\,$ depends only on speed $\\,v\\,$. Using the chain rule, the derivative with respect to the parallel velocity $\\,v_\\parallel\\,$ is:\n$$\n\\frac{\\partial f_0}{\\partial v_\\parallel} = \\frac{\\partial f_0}{\\partial v} \\frac{\\partial v}{\\partial v_\\parallel} = \\left(-\\frac{m_e v}{T_e} f_0(v)\\right) \\left(\\frac{v_\\parallel}{v}\\right) = -\\frac{m_e v}{T_e} f_0(v) \\xi\n$$\nSince $\\,P_1(\\xi) = \\xi\\,$, the source term of the DKE is:\n$$\n\\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0}{\\partial v_\\parallel} = -\\frac{e E_\\parallel v}{T_e} f_0(v) P_1(\\xi)\n$$\nThis source term is purely in the $\\,\\ell=1\\,$ Legendre mode.\n\nNext, we analyze the collision term (right-hand side). The angular operator in $\\,C_L\\,$ is the Legendre operator, for which $\\,P_\\ell(\\xi)\\,$ are eigenfunctions with eigenvalues $\\,-\\ell(\\ell+1)\\,$:\n$$\n\\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial P_\\ell(\\xi)}{\\partial \\xi}\\right] = -\\ell(\\ell+1) P_\\ell(\\xi)\n$$\nApplying the collision operator to the expansion of $\\,f_1\\,$ yields:\n$$\nC_L[f_1] = \\nu_D(v) \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) [-\\ell(\\ell+1) P_\\ell(\\xi)]\n$$\nThe DKE thus becomes:\n$$\n-\\frac{e E_\\parallel v}{T_e} f_0(v) P_1(\\xi) = -\\nu_D(v) \\sum_{\\ell=0}^{L_{\\max}} \\ell(\\ell+1) g_\\ell(v) P_\\ell(\\xi)\n$$\nBy the orthogonality of Legendre polynomials, we can equate the coefficients of each $\\,P_\\ell(\\xi)\\,$ on both sides.\nFor $\\,\\ell=0\\,$, the coefficient on both sides is zero, so $\\,g_0\\,$ is undetermined. However, particle conservation requires $\\,\\int f_1 d^3v = 0\\,$, which implies $\\,g_0(v) = 0\\,$.\nFor $\\,\\ell=1\\,$, we equate the coefficients:\n$$\n-\\frac{e E_\\parallel v}{T_e} f_0(v) = -1(1+1) \\nu_D(v) g_1(v) = -2 \\nu_D(v) g_1(v)\n$$\nSolving for $\\,g_1(v)\\,$ gives:\n$$\ng_1(v) = \\frac{e E_\\parallel v}{2 T_e \\nu_D(v)} f_0(v)\n$$\nFor all $\\,\\ell > 1\\,$, the source term coefficient is zero, leading to:\n$$\n0 = -\\ell(\\ell+1) \\nu_D(v) g_\\ell(v) \\implies g_\\ell(v) = 0 \\quad \\text{for } \\ell > 1\n$$\nThis is a crucial result: for the Lorentz collision operator, the electric field only drives the $\\,\\ell=1\\,$ component of the distribution function, and there is no coupling to higher-order modes. Consequently, the solution is exact with a truncation at $\\,L_{\\max}=1\\,$. The calculation for $\\,L_{\\max}=3\\,$ will yield an identical result, making the pitch-angle expansion convergence test trivially true.\n\nThe parallel current density $\\,J_\\parallel\\,$ is defined as:\n$$\nJ_\\parallel = -e \\int v_\\parallel f_1(\\boldsymbol{v})\\, d^3 v\n$$\nUsing spherical velocity coordinates ($\\,v, \\xi, \\phi\\,$), the volume element is $\\,d^3v = 2\\pi v^2 dv d\\xi\\,$. With $\\,v_\\parallel = v\\xi = vP_1(\\xi)\\,$ and $\\,f_1(v,\\xi) = g_1(v)P_1(\\xi)\\,$:\n$$\nJ_\\parallel = -e \\int_0^\\infty dv \\int_{-1}^1 d\\xi \\, [v P_1(\\xi)] [g_1(v) P_1(\\xi)] (2\\pi v^2) = -2\\pi e \\int_0^\\infty v^3 g_1(v) dv \\int_{-1}^1 [P_1(\\xi)]^2 d\\xi\n$$\nUsing the orthogonality relation $\\,\\int_{-1}^1 [P_1(\\xi)]^2 d\\xi = 2/3\\,$, we get:\n$$\nJ_\\parallel = -2\\pi e \\left(\\frac{2}{3}\\right) \\int_0^\\infty v^3 g_1(v) dv = -\\frac{4\\pi e}{3} \\int_0^\\infty v^3 g_1(v) dv\n$$\nThe parallel conductivity $\\,\\sigma_\\parallel\\,$ is defined by $\\,J_\\parallel = -\\sigma_\\parallel E_\\parallel\\,$ (the problem's definition is $\\sigma_\\parallel = -J_\\parallel/E_\\parallel$ to ensure $\\sigma_\\parallel>0$). Substituting the expression for $\\,g_1(v)\\,$:\n$$\n\\sigma_\\parallel = -\\frac{J_\\parallel}{E_\\parallel} = \\frac{4\\pi e}{3E_\\parallel} \\int_0^\\infty v^3 \\left(\\frac{e E_\\parallel v}{2 T_e \\nu_D(v)} f_0(v)\\right) dv = \\frac{2\\pi e^2}{3 T_e} \\int_0^\\infty \\frac{v^4}{\\nu_D(v)} f_0(v) dv\n$$\nTo perform numerical integration, we transform the integral from velocity $\\,v\\,$ to kinetic energy $\\,\\varepsilon = m_e v^2/2\\,$.\nThe deflection frequency is $\\,\\nu_D(v) = C_\\nu v^{-3}\\,$, where $\\,C_\\nu = \\frac{n_i Z_i^2 e^4 \\ln\\Lambda}{4\\pi\\varepsilon_0^2 m_e^2}\\,$. In terms of energy, $\\,\\nu_D(\\varepsilon) = C_\\nu (2\\varepsilon/m_e)^{-3/2}\\,$.\nThe integral for conductivity can be rewritten using the Maxwell-Boltzmann energy distribution $F(\\varepsilon)d\\varepsilon = f_0(v) 4\\pi v^2 dv$.\n$$\n\\sigma_\\parallel = \\frac{e^2}{3T_e} \\int_0^\\infty \\frac{v^2}{\\nu_D(v)} (4\\pi v^2 f_0(v))dv = \\frac{e^2}{3T_e} \\int_0^\\infty \\frac{2\\varepsilon/m_e}{\\nu_D(\\varepsilon)} F(\\varepsilon)d\\varepsilon\n$$\nSubstituting all the terms and simplifying using quasineutrality ($n_e = Z_i n_i$) leads to the final expression to be computed numerically:\n$$\n\\sigma_\\parallel = \\frac{16\\sqrt{2\\pi}\\varepsilon_0^2}{3 Z_i e^2 m_e^{1/2} \\ln \\Lambda \\cdot T_e^{5/2}} \\int_0^{\\varepsilon_{\\max}} \\varepsilon^3 e^{-\\varepsilon/T_e} d\\varepsilon\n$$\nThis integral is evaluated from $\\,0\\,$ to $\\,\\varepsilon_{\\max} = \\alpha T_e\\,$ using the trapezoidal rule on a uniform grid of $\\,N_\\varepsilon\\,$ points. The integrand $\\,\\varepsilon^3 e^{-\\varepsilon/T_e}\\,$ is zero at $\\,\\varepsilon=0\\,$, so no singularity occurs at the lower integration bound. The numerical scheme is implemented in the provided Python code.",
            "answer": "```python\nimport numpy as np\nimport math\n\n# Physical constants in SI units\nE_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\nM_ELECTRON = 9.1093837015e-31  # Electron mass in kg\nEPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n\ndef format_sigfig(value, sigfigs):\n    \"\"\"\n    Rounds a float to a specified number of significant figures and returns a string.\n    This function is used for formatting the final output as requested.\n    \"\"\"\n    if value == 0:\n        return '0.0'\n    return f\"{value:.{sigfigs}g}\"\n\ndef compute_conductivity(n_e, Z_i, T_e_eV, ln_Lambda, N_eps, alpha):\n    \"\"\"\n    Computes the parallel electrical conductivity sigma_parallel.\n\n    The derivation shows that sigma_parallel for the Lorentz model is:\n    sigma = Prefactor * Integral\n\n    Prefactor = (16 * sqrt(2*pi) * eps0^2) / (3 * Z_i * e^2 * m_e^0.5 * ln_Lambda)\n    Integral part = Integral from 0 to eps_max of [eps^3 * exp(-eps/T_e)] d_eps / T_e^2.5\n\n    Note: The conductivity in this model is independent of electron density n_e,\n    a characteristic of the Spitzer-Härm problem. The parameter n_e is\n    retained for consistency with the problem statement's test case format.\n    \"\"\"\n    # 1. Convert temperature to Joules and define integration limit\n    T_e_J = T_e_eV * E_CHARGE\n    eps_max = alpha * T_e_J\n\n    # 2. Set up the energy grid for numerical integration\n    # The grid has N_eps points from 0 to eps_max, inclusive.\n    eps_grid = np.linspace(0, eps_max, N_eps)\n\n    # 3. Evaluate the integrand on the grid\n    # The integrand is I(eps) = eps^3 * exp(-eps / T_e_J).\n    integrand_values = eps_grid**3 * np.exp(-eps_grid / T_e_J)\n\n    # 4. Perform the numerical integration using the trapezoidal rule\n    integral_result = np.trapz(integrand_values, eps_grid)\n\n    # 5. Calculate the overall prefactor for sigma_parallel\n    prefactor_num = 16.0 * np.sqrt(2.0 * np.pi) * EPSILON_0**2\n    prefactor_den = 3.0 * Z_i * E_CHARGE**2 * np.sqrt(M_ELECTRON) * ln_Lambda\n    \n    # The full expression for conductivity includes the temperature-dependent term T_e_J**(-2.5)\n    conductivity = (prefactor_num / prefactor_den) * integral_result / (T_e_J**2.5)\n    \n    return conductivity\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and produce the final output.\n    \"\"\"\n    # Test cases from the problem statement:\n    # (n_e, Z_i, T_e_eV, ln_Lambda, E_parallel, N_eps, alpha)\n    test_cases = [\n        (1.0e20, 1.0, 5000.0, 17.0, 0.1, 200, 5.0),\n        (1.0e20, 1.0, 20000.0, 17.0, 0.1, 50, 5.0),\n        (1.0e18, 1.0, 500.0, 15.0, 1.0, 32, 4.0),\n        (5.0e19, 2.0, 10000.0, 18.0, 0.5, 100, 6.0),\n    ]\n\n    results = []\n    \n    # Convergence tolerances\n    TAU_N = 1e-3  # for energy-grid refinement\n    TAU_L = 1e-8  # for pitch-angle expansion order\n    TAU_R = 1e-3  # for energy-range factor\n\n    for case in test_cases:\n        n_e, Z_i, T_e_eV, ln_L, _, N_eps, alpha = case\n\n        # --- Base Calculation ---\n        sigma_base = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, N_eps, alpha)\n\n        # --- Convergence Checks ---\n\n        # 1. Energy-grid convergence\n        sigma_N_refined = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, 2 * N_eps, alpha)\n        # Avoid division by zero if conductivity is zero\n        if sigma_N_refined != 0:\n            rel_diff_N = abs((sigma_N_refined - sigma_base) / sigma_N_refined)\n            conv_N = rel_diff_N  TAU_N\n        else:\n            conv_N = (sigma_base == 0)\n\n        # 2. Pitch-angle expansion convergence\n        # As derived in the solution, for the Lorentz pitch-angle scattering operator, only the\n        # l=1 Legendre mode (g_1) is driven by the electric field, and it does not couple\n        # to higher-order modes (g_l=0 for l>1). Thus, the conductivity is identical\n        # for L_max=1 and L_max=3. The relative difference is analytically zero.\n        # sigma(L_max=3) == sigma(L_max=1), so diff is 0, which is  TAU_L.\n        conv_L = True\n\n        # 3. Energy-range convergence\n        sigma_R_extended = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, N_eps, 1.3 * alpha)\n        # Avoid division by zero if conductivity is zero\n        if sigma_R_extended != 0:\n            rel_diff_R = abs((sigma_R_extended - sigma_base) / sigma_R_extended)\n            conv_R = rel_diff_R  TAU_R\n        else:\n            conv_R = (sigma_base == 0)\n\n        # --- Collect Results ---\n        results.append(format_sigfig(sigma_base, 6))\n        results.append(str(conv_N))\n        results.append(str(conv_L))\n        results.append(str(conv_R))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results).lower()}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}