{
    "hands_on_practices": [
        {
            "introduction": "降阶输运模型建立在将物理量在磁通量面上进行平均的关键步骤之上。本练习 () 提供了一个动手推导的机会，计算一个极向变化的局部热通量的磁面平均值。通过处理环形几何，您将具体理解局部二维信息如何被压缩为单一的一维数值，这是输运建模中的一项基础技术。",
            "id": "3964867",
            "problem": "在轴对称托卡马克等离子体的简化输运模型中，标量场的磁通面平均（FSA）用于闭合一维平衡方程。考虑一个在柱坐标系下的圆形同心磁通面，其特征是大半径 $R_0$ 和小半径 $r$，满足 $0<r<R_0$。环向角为 $\\phi \\in [0,2\\pi)$，极向角为 $\\theta \\in [0,2\\pi)$，所有角度均以弧度为单位。该表面由圆环面的标准几何形状参数化，其中到对称轴的距离为 $R(\\theta) = R_0 + r \\cos\\theta$。假定该磁通面上的局部热通量密度是极向不对称的，\n$$\nq(\\theta) = q_0 \\left(1 + \\delta \\cos\\theta\\right),\n$$\n其中 $q_0>0$ 是一个恒定的参考振幅，$\\delta$ 是一个满足 $|\\delta|<1$ 的无量纲不对称参数。\n\n从标量场的磁通面平均的基本定义（即面积平均）出发，\n$$\n\\langle q \\rangle \\equiv \\frac{1}{A}\\iint_{\\mathcal{S}} q \\,\\mathrm{d}S, \\quad A \\equiv \\iint_{\\mathcal{S}} \\mathrm{d}S,\n$$\n并仅利用圆环面的几何形状以及 $q$ 仅依赖于 $\\theta$ 这一事实，推导无量纲的归一化磁通面平均 $\\langle q \\rangle / q_0$ 关于 $\\delta$、$r$ 和 $R_0$ 的闭式表达式。\n\n你的最终答案必须是 $\\langle q \\rangle/q_0$ 的单个闭式解析表达式。最终答案中不要包含单位。角度必须以弧度处理。",
            "solution": "该问题要求推导在一个圆形环状表面上，极向变化的标量场 $q(\\theta)$ 的归一化磁通面平均 $\\langle q \\rangle / q_0$。\n\n磁通面平均（FSA）定义为面积平均：\n$$\n\\langle q \\rangle \\equiv \\frac{1}{A}\\iint_{\\mathcal{S}} q \\, \\mathrm{d}S\n$$\n其中 $A$ 是磁通面 $\\mathcal{S}$ 的总表面积，由 $A = \\iint_{\\mathcal{S}} \\mathrm{d}S$ 给出。问题要求我们求出 $\\langle q \\rangle / q_0$。\n\n首先，我们必须确定微分表面积元 $\\mathrm{d}S$。该环状表面使用极向角 $\\theta \\in [0, 2\\pi)$ 和环向角 $\\phi \\in [0, 2\\pi)$ 进行参数化。在以 $z$ 轴为对称轴的笛卡尔坐标系 $(x,y,z)$ 中，环面上一点的位置矢量 $\\vec{p}(\\theta, \\phi)$ 为：\n$$\n\\vec{p}(\\theta, \\phi) = \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} (R_0 + r \\cos\\theta) \\cos\\phi \\\\ (R_0 + r \\cos\\theta) \\sin\\phi \\\\ r \\sin\\theta \\end{pmatrix}\n$$\n在这里，$R(\\theta) = R_0 + r \\cos\\theta$ 是到对称轴的距离。面元 $\\mathrm{d}S$ 由切矢量 $\\frac{\\partial\\vec{p}}{\\partial\\theta}$ 和 $\\frac{\\partial\\vec{p}}{\\partial\\phi}$ 的叉积的模给出。\n\n偏导数是：\n$$\n\\frac{\\partial\\vec{p}}{\\partial\\theta} = \\begin{pmatrix} -r \\sin\\theta \\cos\\phi \\\\ -r \\sin\\theta \\sin\\phi \\\\ r \\cos\\theta \\end{pmatrix}\n$$\n$$\n\\frac{\\partial\\vec{p}}{\\partial\\phi} = \\begin{pmatrix} -(R_0 + r \\cos\\theta) \\sin\\phi \\\\ (R_0 + r \\cos\\theta) \\cos\\phi \\\\ 0 \\end{pmatrix}\n$$\n\n叉积是：\n$$\n\\frac{\\partial\\vec{p}}{\\partial\\theta} \\times \\frac{\\partial\\vec{p}}{\\partial\\phi} = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ -r \\sin\\theta \\cos\\phi & -r \\sin\\theta \\sin\\phi & r \\cos\\theta \\\\ -(R_0 + r \\cos\\theta) \\sin\\phi & (R_0 + r \\cos\\theta) \\cos\\phi & 0 \\end{vmatrix}\n$$\n$$\n= \\mathbf{i} \\left( 0 - r \\cos\\theta (R_0 + r \\cos\\theta) \\cos\\phi \\right) - \\mathbf{j} \\left( 0 - r \\cos\\theta (-(R_0 + r \\cos\\theta) \\sin\\phi) \\right) + \\mathbf{k} \\left( -r \\sin\\theta \\cos\\phi (R_0 + r \\cos\\theta) \\cos\\phi - (-r \\sin\\theta \\sin\\phi) (-(R_0 + r \\cos\\theta) \\sin\\phi) \\right)\n$$\n$$\n= -r(R_0 + r \\cos\\theta) \\cos\\theta \\cos\\phi \\, \\mathbf{i} - r(R_0 + r \\cos\\theta) \\cos\\theta \\sin\\phi \\, \\mathbf{j} - r(R_0 + r \\cos\\theta) \\sin\\theta (\\cos^2\\phi + \\sin^2\\phi) \\, \\mathbf{k}\n$$\n$$\n= -r(R_0 + r \\cos\\theta) \\begin{pmatrix} \\cos\\theta \\cos\\phi \\\\ \\cos\\theta \\sin\\phi \\\\ \\sin\\theta \\end{pmatrix}\n$$\n\n这个矢量的模是：\n$$\n\\left|\\frac{\\partial\\vec{p}}{\\partial\\theta} \\times \\frac{\\partial\\vec{p}}{\\partial\\phi}\\right| = | -r(R_0 + r \\cos\\theta) | \\sqrt{(\\cos\\theta \\cos\\phi)^2 + (\\cos\\theta \\sin\\phi)^2 + (\\sin\\theta)^2}\n$$\n已知 $R_0 > r > 0$，因此项 $R_0 + r \\cos\\theta$ 总是正的。所以，\n$$\n\\left|\\frac{\\partial\\vec{p}}{\\partial\\theta} \\times \\frac{\\partial\\vec{p}}{\\partial\\phi}\\right| = r(R_0 + r \\cos\\theta) \\sqrt{\\cos^2\\theta(\\cos^2\\phi + \\sin^2\\phi) + \\sin^2\\theta}\n$$\n$$\n= r(R_0 + r \\cos\\theta) \\sqrt{\\cos^2\\theta + \\sin^2\\theta} = r(R_0 + r \\cos\\theta)\n$$\n所以，表面积元是 $\\mathrm{d}S = r(R_0 + r \\cos\\theta) \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi$。\n\n现在我们计算总表面积 $A$，即 FSA 表达式中的分母。\n$$\nA = \\iint_{\\mathcal{S}} \\mathrm{d}S = \\int_0^{2\\pi} \\int_0^{2\\pi} r(R_0 + r \\cos\\theta) \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n被积函数不依赖于 $\\phi$，所以对 $\\phi$ 的积分得到一个因子 $2\\pi$：\n$$\nA = 2\\pi r \\int_0^{2\\pi} (R_0 + r \\cos\\theta) \\, \\mathrm{d}\\theta = 2\\pi r \\left[ R_0\\theta + r \\sin\\theta \\right]_0^{2\\pi}\n$$\n$$\nA = 2\\pi r ( (R_0 \\cdot 2\\pi + r \\sin(2\\pi)) - (0 + 0) ) = 4\\pi^2 R_0 r\n$$\n这就是熟知的环面表面积公式。\n\n接下来，我们计算 FSA 表达式的分子，即 $q(\\theta)$ 在该表面上的积分。\n$$\n\\iint_{\\mathcal{S}} q \\, \\mathrm{d}S = \\int_0^{2\\pi} \\int_0^{2\\pi} q(\\theta) \\, \\mathrm{d}S = \\int_0^{2\\pi} \\int_0^{2\\pi} q_0(1 + \\delta \\cos\\theta) r(R_0 + r \\cos\\theta) \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n同样，对 $\\phi$ 积分得到一个因子 $2\\pi$。我们同时提出常数 $q_0$ 和 $r$。\n$$\n\\iint_{\\mathcal{S}} q \\, \\mathrm{d}S = 2\\pi q_0 r \\int_0^{2\\pi} (1 + \\delta \\cos\\theta)(R_0 + r \\cos\\theta) \\, \\mathrm{d}\\theta\n$$\n我们展开被积函数：\n$$\n(1 + \\delta \\cos\\theta)(R_0 + r \\cos\\theta) = R_0 + r \\cos\\theta + \\delta R_0 \\cos\\theta + \\delta r \\cos^2\\theta = R_0 + (r + \\delta R_0)\\cos\\theta + \\delta r \\cos^2\\theta\n$$\n现在我们将这个表达式对 $\\theta$ 从 $0$ 积分到 $2\\pi$：\n$$\n\\int_0^{2\\pi} \\left( R_0 + (r + \\delta R_0)\\cos\\theta + \\delta r \\cos^2\\theta \\right) \\mathrm{d}\\theta\n$$\n我们逐项计算积分：\n$$\n\\int_0^{2\\pi} R_0 \\, \\mathrm{d}\\theta = R_0 [\\theta]_0^{2\\pi} = 2\\pi R_0\n$$\n$$\n\\int_0^{2\\pi} (r + \\delta R_0)\\cos\\theta \\, \\mathrm{d}\\theta = (r + \\delta R_0)[\\sin\\theta]_0^{2\\pi} = 0\n$$\n对于最后一项，我们使用恒等式 $\\cos^2\\theta = \\frac{1}{2}(1 + \\cos(2\\theta))$：\n$$\n\\int_0^{2\\pi} \\delta r \\cos^2\\theta \\, \\mathrm{d}\\theta = \\delta r \\int_0^{2\\pi} \\frac{1 + \\cos(2\\theta)}{2} \\, \\mathrm{d}\\theta = \\frac{\\delta r}{2} \\left[ \\theta + \\frac{1}{2}\\sin(2\\theta) \\right]_0^{2\\pi} = \\frac{\\delta r}{2} (2\\pi) = \\pi \\delta r\n$$\n将这些结果相加，对 $\\theta$ 的积分是 $2\\pi R_0 + 0 + \\pi \\delta r$。\n因此，分子是：\n$$\n\\iint_{\\mathcal{S}} q \\, \\mathrm{d}S = 2\\pi q_0 r (2\\pi R_0 + \\pi \\delta r) = 2\\pi^2 q_0 r (2R_0 + \\delta r)\n$$\n\n现在我们可以计算磁通面平均 $\\langle q \\rangle$：\n$$\n\\langle q \\rangle = \\frac{\\iint_{\\mathcal{S}} q \\, \\mathrm{d}S}{A} = \\frac{2\\pi^2 q_0 r (2R_0 + \\delta r)}{4\\pi^2 R_0 r}\n$$\n消去公因式 $2\\pi^2 r$：\n$$\n\\langle q \\rangle = q_0 \\frac{2R_0 + \\delta r}{2R_0} = q_0 \\left( 1 + \\frac{\\delta r}{2R_0} \\right)\n$$\n最后，问题要求的是归一化的量 $\\langle q \\rangle / q_0$。\n$$\n\\frac{\\langle q \\rangle}{q_0} = 1 + \\frac{\\delta r}{2R_0}\n$$\n该表达式是无量纲的，正如所要求的，因为 $\\delta$ 是无量纲的，而 $r/R_0$ 是长度之比。",
            "answer": "$$\n\\boxed{1 + \\frac{\\delta r}{2R_{0}}}\n$$"
        },
        {
            "introduction": "发展降阶模型的一个关键任务是确定其输运系数，这些系数通常封装了复杂的底层物理。本练习 () 模拟了这一过程，要求您使用来自高保真度回旋动理学模型的合成数据，通过最小二乘法拟合一个有效的热导率 $\\kappa$。这项常见的“模型降阶”任务将让您获得从复杂模拟输出中推导简单预测规律的实践经验。",
            "id": "3964885",
            "problem": "您的任务是通过使用代表在固定等离子体比压和归一化回旋半径下回旋动理学计算的热通量的合成数据，拟合一个有效热导率，从而构建并验证一个用于磁化聚变等离子体中热传导的简化输运模型。您必须实现一个完整的、可运行的程序，该程序不读取外部输入，并在程序内部使用所提供的合成数据。\n\n基本原理：在简化输运模型中，傅里叶热传导定律 (Fourier’s law) 假设热通量矢量由 $q = - \\kappa \\nabla T$ 给出，其中 $q$ 是热通量，$\\kappa$ 是标量各向同性热导率，$\\nabla T$ 是温度梯度。在一个由等离子体比压 $\\beta$ 和归一化回旋半径 $\\rho_\\ast$ 表征的固定平衡中，假设回旋动理学热通量数据 $Q$ 通过一个有效各向同性 $\\kappa$ 依赖于 $\\nabla T$，并可能包含非扩散分量。给定 $N$ 个样本 $\\{(\\nabla T_i, Q_i)\\}_{i=1}^N$，其中 $Q_i \\in \\mathbb{R}^d$ 且 $\\nabla T_i \\in \\mathbb{R}^d$，您将通过最小二乘法拟合单个标量 $\\kappa$，以最小化测量通量 $Q_i$ 与模型 $- \\kappa \\nabla T_i$ 之间的残差。\n\n数学目标：对于固定 $\\beta$ 和 $\\rho_\\ast$ 的数据集，定义最小二乘目标函数\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2,\n$$\n并找到最小化 $J(\\kappa)$ 的 $\\kappa$ 值。计算并报告残差范数\n$$\n\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 \\right)^{1/2}。\n$$\n如果数据没有提供关于 $\\kappa$ 的信息（即，如果 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 = 0$），则设 $\\kappa = 0$ 并将残差范数计算为 $\\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}$。\n\n单位：以国际单位制（SI）报告 $\\kappa$，单位为瓦特每米开尔文 ($\\mathrm{W/(m \\cdot K)}$)，残差范数的单位为瓦特每平方米 ($\\mathrm{W/m^2}$)。程序应输出不带单位字符串的数值，但所有计算必须与这些单位保持一致。\n\n测试套件：实现以下四个数据集（每个数据集都在固定的 $\\beta$ 和 $\\rho_\\ast$ 下独立），且均为二维空间 $d = 2$：\n\n- 情况1（理想路径，完全扩散）：固定 $\\beta = 0.02$ 和 $\\rho_\\ast = 10^{-3}$。使用 $N = 4$ 个样本：\n  - $\\nabla T_1 = (10.0, 0.0)$, $Q_1 = (-50.0, 0.0)$,\n  - $\\nabla T_2 = (0.0, 8.0)$, $Q_2 = (0.0, -40.0)$,\n  - $\\nabla T_3 = (6.0, 6.0)$, $Q_3 = (-30.0, -30.0)$,\n  - $\\nabla T_4 = (-4.0, 5.0)$, $Q_4 = (20.0, -25.0)$。\n  这些数据与精确的 $\\kappa_{\\text{true}} = 5.0$ 且无非扩散分量的情况一致。\n\n- 情况2（垂直非扩散通量分量）：固定 $\\beta = 0.03$ 和 $\\rho_\\ast = 2 \\times 10^{-3}$。使用 $N = 4$ 个样本：\n  - $\\nabla T_1 = (12.0, 0.0)$, $Q_1 = (-24.0, 1.0)$,\n  - $\\nabla T_2 = (9.0, 0.0)$, $Q_2 = (-18.0, -1.0)$,\n  - $\\nabla T_3 = (6.0, 0.0)$, $Q_3 = (-12.0, 0.5)$,\n  - $\\nabla T_4 = (3.0, 0.0)$, $Q_4 = (-6.0, -0.5)$。\n  这些数据与 $\\kappa_{\\text{true}} = 2.0$ 且增加了垂直于 $\\nabla T$ 的非扩散分量的情况一致。\n\n- 情况3（无梯度信息，纯非扩散通量）：固定 $\\beta = 0.015$ 和 $\\rho_\\ast = 8 \\times 10^{-4}$。使用 $N = 2$ 个样本：\n  - $\\nabla T_1 = (0.0, 0.0)$, $Q_1 = (1.0, -2.0)$,\n  - $\\nabla T_2 = (0.0, 0.0)$, $Q_2 = (-0.5, 0.5)$。\n\n- 情况4（混合对齐，一个零梯度样本，少量非扩散分量）：固定 $\\beta = 0.025$ 和 $\\rho_\\ast = 1.5 \\times 10^{-3}$。使用 $N = 5$ 个样本：\n  - $\\nabla T_1 = (5.0, 1.0)$, $Q_1 = (-14.8, -3.1)$,\n  - $\\nabla T_2 = (-4.0, 2.0)$, $Q_2 = (12.0, -6.0)$,\n  - $\\nabla T_3 = (0.0, 0.0)$, $Q_3 = (1.0, -1.0)$,\n  - $\\nabla T_4 = (3.0, -3.0)$, $Q_4 = (-8.5, 9.5)$,\n  - $\\nabla T_5 = (2.0, 4.0)$, $Q_5 = (-6.2, -11.9)$。\n\n算法任务：对每个数据集，计算最小化 $J(\\kappa)$ 的最小二乘解 $\\kappa$，然后计算残差范数 $\\|r\\|_2$，两者都以实数（浮点数）形式报告。所有数据集都是独立的，必须在程序中按顺序处理。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表，每个数据集的结果表示为一个双元素列表 $[\\kappa,\\|r\\|_2]$。对于上述四种情况，输出必须因此具有以下格式\n$$\n[[\\kappa_1,\\|r_1\\|_2],[\\kappa_2,\\|r_2\\|_2],[\\kappa_3,\\|r_3\\|_2],[\\kappa_4,\\|r_4\\|_2]],\n$$\n不含空格。所有值都必须以上述指定的SI单位表示。",
            "solution": "在进行求解之前，对问题陈述的有效性进行评估。\n\n### 步骤1：提取给定信息\n- **模型：** 热通量矢量 $q$ 通过傅里叶定律与温度梯度 $\\nabla T$ 相关联，$q = - \\kappa \\nabla T$，其中 $\\kappa$ 是一个标量各向同性热导率。\n- **数据：** 提供了一组 $N$ 个样本 $\\{(\\nabla T_i, Q_i)\\}_{i=1}^N$，其中 $Q_i \\in \\mathbb{R}^d$ 是测量的热通量，$\\nabla T_i \\in \\mathbb{R}^d$ 是温度梯度。空间维度为 $d=2$。\n- **目标：** 找到最小化最小二乘目标函数 $J(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2$ 的标量 $\\kappa$。\n- **待计算量：** 残差范数，定义为 $\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 \\right)^{1/2}$，其中 $\\kappa$ 是最优值。\n- **特殊情况：** 如果 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 = 0$，则设 $\\kappa = 0$，残差范数计算为 $\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}$。\n- **单位：** $\\kappa$ 的单位是瓦特每米开尔文 ($\\mathrm{W/(m \\cdot K)}$)，$\\|r\\|_2$ 的单位是瓦特每平方米 ($\\mathrm{W/m^2}$)。\n- **数据集 ($d=2$)：**\n    - **情况1：** $N = 4$。数据点：$(\\nabla T_1, Q_1) = ((10.0, 0.0), (-50.0, 0.0))$, $(\\nabla T_2, Q_2) = ((0.0, 8.0), (0.0, -40.0))$, $(\\nabla T_3, Q_3) = ((6.0, 6.0), (-30.0, -30.0))$, $(\\nabla T_4, Q_4) = ((-4.0, 5.0), (20.0, -25.0))$。\n    - **情况2：** $N = 4$。数据点：$(\\nabla T_1, Q_1) = ((12.0, 0.0), (-24.0, 1.0))$, $(\\nabla T_2, Q_2) = ((9.0, 0.0), (-18.0, -1.0))$, $(\\nabla T_3, Q_3) = ((6.0, 0.0), (-12.0, 0.5))$, $(\\nabla T_4, Q_4) = ((3.0, 0.0), (-6.0, -0.5))$。\n    - **情况3：** $N = 2$。数据点：$(\\nabla T_1, Q_1) = ((0.0, 0.0), (1.0, -2.0))$, $(\\nabla T_2, Q_2) = ((0.0, 0.0), (-0.5, 0.5))$。\n    - **情况4：** $N = 5$。数据点：$(\\nabla T_1, Q_1) = ((5.0, 1.0), (-14.8, -3.1))$, $(\\nabla T_2, Q_2) = ((-4.0, 2.0), (12.0, -6.0))$, $(\\nabla T_3, Q_3) = ((0.0, 0.0), (1.0, -1.0))$, $(\\nabla T_4, Q_4) = ((3.0, -3.0), (-8.5, 9.5))$, $(\\nabla T_5, Q_5) = ((2.0, 4.0), (-6.2, -11.9))$。\n- **要求的输出格式：** 单行字符串 `[[k1,r1],[k2,r2],[k3,r3],[k4,r4]]`。\n\n### 步骤2：使用提取的给定信息进行验证\n根据既定标准对问题进行验证。\n- **科学基础：** 问题基于传热学（傅里叶定律）和数值模型降阶的成熟原理，这是计算物理和工程领域的标准实践。使用回旋动理学数据拟合聚变等离子体简化输运模型的背景是科学上真实的。\n- **良态性：** 任务是求解一个单参数的线性最小二乘问题。目标函数 $J(\\kappa)$ 是关于 $\\kappa$ 的二次函数，具有唯一的全局最小值。问题明确处理了梯度数据为空的奇异情况，确保了对所有提供的输入都有明确定义的处理过程。\n- **客观性：** 问题使用精确的数学语言陈述，并提供了明确的数值数据。没有主观或基于观点的部分。\n- **完整性和一致性：** 所有必要的数据、公式和边界条件（以特殊情况的形式）都已提供。数据集是自包含的，与所述目标没有矛盾。\n- **现实性：** 数值虽然是合成的，但在聚变科学领域的归一化模拟背景下是合理的。单位和物理量在物理上是一致的。\n\n### 步骤3：结论与行动\n问题在科学上和数学上是合理的、良态的且完整的。因此，它被判定为**有效**。将着手开发解决方案。\n\n### 基于原理的设计与求解\n\n问题的核心是找到标量热导率 $\\kappa$，以最小化观测热通量 $Q_i$ 与模型预测 $- \\kappa \\nabla T_i$ 之间的残差平方和。需要最小化的目标函数是：\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2\n$$\n为找到最小值，我们必须找到使 $J(\\kappa)$ 对 $\\kappa$ 的导数为零的 $\\kappa$ 值。首先，我们展开L2范数的平方项。一个矢量的平方范数是它与自身的点积。\n$$\n\\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 = (Q_i + \\kappa \\nabla T_i) \\cdot (Q_i + \\kappa \\nabla T_i)\n$$\n使用点积的分配律：\n$$\n(Q_i + \\kappa \\nabla T_i) \\cdot (Q_i + \\kappa \\nabla T_i) = Q_i \\cdot Q_i + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 (\\nabla T_i \\cdot \\nabla T_i)\n$$\n注意到 $v \\cdot v = \\|v\\|_2^2$，上式变为：\n$$\n\\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 = \\|Q_i\\|_2^2 + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 \\|\\nabla T_i\\|_2^2\n$$\n将此代回 $J(\\kappa)$ 的表达式并分配求和：\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left( \\|Q_i\\|_2^2 + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 \\|\\nabla T_i\\|_2^2 \\right) = \\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa^2 + 2 \\left( \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i \\right) \\kappa + \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)\n$$\n这是一个标准的关于 $\\kappa$ 的二次函数，形式为 $A\\kappa^2 + B\\kappa + C$。为求最小值，我们计算关于 $\\kappa$ 的导数并令其为零：\n$$\n\\frac{dJ}{d\\kappa} = 2 \\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa + 2 \\left( \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i \\right) = 0\n$$\n求解 $\\kappa$：\n$$\n\\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa = - \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i\n$$\n只要分母不为零，$\\kappa$ 的最优值是：\n$$\n\\kappa_{\\text{opt}} = - \\frac{\\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i}{\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2}\n$$\n分母 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2$ 为零当且仅当所有梯度矢量 $\\nabla T_i$ 都是零矢量。这个条件与问题陈述中定义的特殊情况完全对应。在这种情况下，数据没有提供任何信息来确定扩散输运系数，问题正确地规定了设置 $\\kappa = 0$。\n\n一旦确定了最优的 $\\kappa$，通过将其值代回其定义来计算残差范数 $\\|r\\|_2$：\n$$\n\\|r\\|_2 = \\sqrt{J(\\kappa_{\\text{opt}})} = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa_{\\text{opt}} \\nabla T_i \\right\\|_2^2 \\right)^{1/2}\n$$\n如果特殊情况适用（$\\kappa=0$），则简化为：\n$$\n\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}\n$$\n每个情况的算法如下：\n1. 初始化分子和 $S_{\\text{num}} = 0$ 和分母和 $S_{\\text{den}} = 0$。\n2. 对每个样本 $(\\nabla T_i, Q_i)$：\n   a. 计算点积 $d_i = Q_i \\cdot \\nabla T_i$ 并将其加到 $S_{\\text{num}}$。\n   b. 计算平方范数 $n_i = \\|\\nabla T_i\\|_2^2$ 并将其加到 $S_{\\text{den}}$。\n3. 检查 $S_{\\text{den}}$ 是否实际为零。如果是，则设 $\\kappa = 0$。否则，计算 $\\kappa = -S_{\\text{num}} / S_{\\text{den}}$。\n4. 初始化残差平方和 $E^2 = 0$。\n5. 对每个样本 $(\\nabla T_i, Q_i)$：\n   a. 计算残差矢量 $r_i = Q_i + \\kappa \\nabla T_i$。\n   b. 计算平方范数 $\\|r_i\\|_2^2$ 并将其加到 $E^2$。\n6. 最终的残差范数为 $\\|r\\|_2 = \\sqrt{E^2}$。\n将此过程应用于所提供的四个数据集中的每一个。",
            "answer": "```\n[[5.0,0.0],[2.0,1.5811388300841898],[0.0,2.345207879911715],[2.989285714285714,1.609491223126756]]\n```"
        },
        {
            "introduction": "一旦降阶输运模型建立起来，它就可以被用来对等离子体行为和运行需求做出有力的预测。在本问题 () 中，您将应用一个包含扩散和对流项的一维稳态粒子输运方程，来计算维持给定等离子体密度分布所需的总粒子源率。这展示了降阶模型如何直接为聚变反应堆的实际操作（如粒子控制）提供信息。",
            "id": "3964888",
            "problem": "考虑一个大环径比、圆形截面的托卡马克，其大半径为 $R_{0}$，小半径坐标为 $r \\in [0,a]$。设 $\\mathcal{V}(r)$ 表示由磁通面 $r$ 包围的体积，设 $\\mathcal{V}'(r) \\equiv d\\mathcal{V}/dr$ 表示相应的磁通面面积。在大环径比、圆形几何近似下，取 $\\mathcal{V}'(r) = 4 \\pi^{2} R_{0} r$。磁通面平均的稳态粒子连续性方程将径向粒子通量的散度与体积粒子源密度联系起来。采用一种简化的输运闭合，其中径向粒子通量是扩散贡献和对流（箍缩）贡献之和，其系数可以依赖于 $r$。具体来说，设径向粒子通量的形式为 $\\Gamma_{r}(r) = - D(r) \\, d n(r)/dr + V(r) \\, n(r)$，其中 $n(r)$ 是目标密度分布，$D(r)$ 是粒子扩散系数，$V(r)$ 是对流箍缩速度。\n\n给定以下分布：\n- $D(r) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{r}{a} \\right)^{2} \\right]$,\n- $V(r) = V_{0} \\left( \\frac{r}{a} \\right)$,\n- $n(r) = n_{0} \\left[ 1 - \\left( \\frac{r}{a} \\right)^{2} \\right]$,\n\n其中 $D_{0} > 0$, $\\alpha \\ge 0$, $V_{0}$, $n_{0} > 0$ 和 $a > 0$ 是常数。假设在磁轴 $r=0$ 处具有正则性，使得径向粒子通量 $\\Gamma_{r}(r)$ 在 $r \\to 0$ 时保持有限，并取最外闭合磁通面 (LCFS) 在 $r=a$ 处。\n\n从稳态磁通面平均的粒子连续性方程和上述 $\\Gamma_{r}(r)$ 的闭合关系出发，使用在 $0 \\le r \\le a$ 上的积分约束来确定维持给定目标密度分布所需的总粒子源（总加料率）$\\Phi_{\\text{tot}} \\equiv \\int_{0}^{a} S(r) \\, \\mathcal{V}'(r) \\, dr$。将你的最终答案表示为关于 $n_{0}$、$D_{0}$、$\\alpha$、$V_{0}$、$a$ 和 $R_{0}$ 的单个闭式解析表达式。$\\Phi_{\\text{tot}}$ 的物理单位是 $\\text{s}^{-1}$（粒子数/秒）。不要代入任何数值，最终方框内的答案也不要包含单位。",
            "solution": "该问题要求确定在托卡马克等离子体中维持给定稳态密度分布所需的总粒子源率 $\\Phi_{\\text{tot}}$。出发点是磁通面平均的稳态粒子连续性方程，它代表了局部粒子守恒：\n$$ \\frac{1}{\\mathcal{V}'(r)} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) = S(r) $$\n此处，$r$ 是小半径坐标，$S(r)$ 是体积粒子源密度，$\\Gamma_{r}(r)$ 是径向粒子通量，而 $\\mathcal{V}'(r)$ 是磁通面面积，在大环径比、圆形几何近似下由 $\\mathcal{V}'(r) = 4 \\pi^{2} R_{0} r$ 给出。\n\n总粒子源率 $\\Phi_{\\text{tot}}$ 是体积粒子源密度在整个等离子体体积（从磁轴 $r=0$ 到最外闭合磁通面 LCFS $r=a$）上的积分。体积元为 $d\\mathcal{V} = \\mathcal{V}'(r) dr$。因此，$\\Phi_{\\text{tot}}$ 定义为：\n$$ \\Phi_{\\text{tot}} \\equiv \\int_{0}^{a} S(r) \\mathcal{V}'(r) dr $$\n将连续性方程中 $S(r)$ 的表达式代入此定义，我们得到：\n$$ \\Phi_{\\text{tot}} = \\int_{0}^{a} \\left[ \\frac{1}{\\mathcal{V}'(r)} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) \\right] \\mathcal{V}'(r) dr $$\n$\\mathcal{V}'(r)$ 项相互抵消，留下一个全导数的简单积分：\n$$ \\Phi_{\\text{tot}} = \\int_{0}^{a} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) dr $$\n根据微积分基本定理，该积分等于被积函数在积分域边界处的值之差：\n$$ \\Phi_{\\text{tot}} = \\left[ \\mathcal{V}'(r) \\Gamma_{r}(r) \\right]_{r=0}^{r=a} = \\mathcal{V}'(a) \\Gamma_{r}(a) - \\mathcal{V}'(0) \\Gamma_{r}(0) $$\n我们现在必须计算这两个边界项。\n在磁轴 $r=0$ 处，磁通面面积为 $\\mathcal{V}'(0) = 4 \\pi^{2} R_{0} (0) = 0$。问题还指出，径向粒子通量 $\\Gamma_{r}(r)$ 在 $r \\to 0$ 时必须保持有限。因此，下边界处的项为零：\n$$ \\mathcal{V}'(0) \\Gamma_{r}(0) = 0 $$\n这将总源率的表达式简化为流出 LCFS 的粒子通量乘以 LCFS 的面积：\n$$ \\Phi_{\\text{tot}} = \\mathcal{V}'(a) \\Gamma_{r}(a) $$\n这是稳态下全局粒子平衡的表述：体积内产生的总粒子数必须等于流出其边界的总粒子数。\n\n接下来，我们必须计算量 $\\mathcal{V}'(a)$ 和 $\\Gamma_{r}(a)$。\n在 $r=a$ 处的磁通面面积为：\n$$ \\mathcal{V}'(a) = 4 \\pi^{2} R_{0} a $$\n径向粒子通量 $\\Gamma_{r}(r)$ 由输运闭合给出：\n$$ \\Gamma_{r}(r) = - D(r) \\frac{dn(r)}{dr} + V(r) n(r) $$\n我们需要使用给定的分布在 $r=a$ 处计算此表达式的值。\n密度分布为 $n(r) = n_{0} \\left[ 1 - \\left( \\frac{r}{a} \\right)^{2} \\right]$。在 LCFS，$r=a$ 处，密度为：\n$$ n(a) = n_{0} \\left[ 1 - \\left( \\frac{a}{a} \\right)^{2} \\right] = n_{0} (1 - 1) = 0 $$\n密度梯度为 $\\frac{dn}{dr} = \\frac{d}{dr} \\left( n_{0} - \\frac{n_{0}r^{2}}{a^{2}} \\right) = - \\frac{2 n_{0} r}{a^{2}}$。在 $r=a$ 处，梯度为：\n$$ \\frac{dn}{dr}\\bigg|_{r=a} = - \\frac{2 n_{0} a}{a^{2}} = - \\frac{2 n_{0}}{a} $$\n在 $r=a$ 处的扩散系数由 $D(r) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{r}{a} \\right)^{2} \\right]$ 得到：\n$$ D(a) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{a}{a} \\right)^{2} \\right] = D_{0} (1 + \\alpha) $$\n在 $r=a$ 处的对流箍缩速度由 $V(r) = V_{0} \\frac{r}{a}$ 得到：\n$$ V(a) = V_{0} \\frac{a}{a} = V_{0} $$\n现在我们组合出边界处通量 $\\Gamma_{r}(a)$ 的表达式：\n$$ \\Gamma_{r}(a) = - D(a) \\left( \\frac{dn}{dr}\\bigg|_{r=a} \\right) + V(a) n(a) $$\n代入计算出的值：\n$$ \\Gamma_{r}(a) = - \\left[ D_{0} (1 + \\alpha) \\right] \\left( - \\frac{2 n_{0}}{a} \\right) + (V_{0}) (0) $$\n$$ \\Gamma_{r}(a) = \\frac{2 n_{0} D_{0} (1 + \\alpha)}{a} $$\n注意到，由于密度 $n(a)$ 为零，通量的对流部分 $V(r)n(r)$ 在边界处为零。\n\n最后，我们通过代入 $\\mathcal{V}'(a)$ 和 $\\Gamma_{r}(a)$ 的表达式来计算总粒子源率 $\\Phi_{\\text{tot}}$：\n$$ \\Phi_{\\text{tot}} = \\mathcal{V}'(a) \\Gamma_{r}(a) = \\left( 4 \\pi^{2} R_{0} a \\right) \\left( \\frac{2 n_{0} D_{0} (1 + \\alpha)}{a} \\right) $$\n小半径 $a$ 从表达式中消去：\n$$ \\Phi_{\\text{tot}} = 8 \\pi^{2} R_{0} n_{0} D_{0} (1 + \\alpha) $$\n这就是在给定输运模型下，维持指定密度分布所需的总加料率的最终闭式解析表达式。结果取决于大半径、中心密度、中心扩散系数和扩散系数形状参数 $\\alpha$，但由于特定的边界条件 $n(a)=0$，它与小半径 $a$ 和箍缩速度参数 $V_{0}$ 无关。",
            "answer": "$$ \\boxed{8 \\pi^{2} R_{0} n_{0} D_{0} (1 + \\alpha)} $$"
        }
    ]
}