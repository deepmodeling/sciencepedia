{
    "hands_on_practices": [
        {
            "introduction": "预测性输运建模的核心是通量-梯度关系。湍流输运通常表现出门槛行为：一旦梯度超过临界值，通量就会急剧增加。理解这种“刚性”是解释等离子体剖面为何具有弹性的关键。本练习将让你分析一个常见的湍流通量代理模型，通过直接计算刚性，你将对这一关键概念及其在输运代码中的实现方式有具体的理解。",
            "id": "3997874",
            "problem": "在磁约束聚变等离子体的诠释性和预测性输运模拟中，径向热输运通过能量平衡和通量-梯度关系进行建模。设离子温度梯度驱动由无量纲参数 $x \\equiv R/L_T$ 表示，其中 $R$ 是大半径，$L_T \\equiv -\\left(\\mathrm{d}\\ln T/\\mathrm{d}r\\right)^{-1}$ 是离子温度梯度标长。通过将物理热通量 $Q$ 除以一个选定的回旋-玻姆参考值 $Q_{\\mathrm{gB}}$ 来定义归一化湍流热通量 $\\hat{Q}$，因此 $\\hat{Q} \\equiv Q/Q_{\\mathrm{gB}}$ 是无量纲的。输运刚度是归一化湍流热通量对临界梯度 $x_c$ 附近驱动的敏感度，即右导数 $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$。\n\n考虑一个用于离子温度梯度驱动湍流的触发和饱和的代理闭合，该闭合能够捕捉阈值和刚度效应：\n$$\n\\hat{Q}(x) \\;=\\; \\alpha \\,\\frac{\\left(x - x_c\\right)^{p}}{1 + \\beta \\left(x - x_c\\right)}\\,H\\!\\left(x - x_c\\right),\n$$\n其中 $H$ 是亥维赛函数，$\\alpha>0$ 和 $\\beta \\ge 0$ 是无量纲系数，$x_c>0$ 是临界梯度，$p>0$ 控制触发的陡峭程度。该形式旨在用作输运求解器内通量-梯度关系中的局域闭合。\n\n从能量守恒和梯度标长的定义出发，论证输运刚度为何简化为 $\\hat{Q}(x)$ 在 $x=x_c$ 处的右导数，然后解析计算 $p=1$ 情况下的 $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$。根据指数 $p$ 讨论该模型预测的是突发的有限斜率触发、初始斜率消失的超临界斜坡，还是阈值处的奇异触发。\n\n对具体参数值 $\\alpha = 9.80665$，$\\beta = 0.60$，$x_c = 4.50$ 和 $p=1$ 计算最终表达式的值。将您计算出的输运刚度的最终数值结果表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题基于聚变等离子体物理中输运模拟的原理，具有科学依据，数学上适定、客观且自洽，因此被认为是有效的。我们可以开始求解。\n\n该问题要求完成三个主要任务：首先，论证将输运刚度定义为归一化热通量 $\\hat{Q}$ 关于温度梯度驱动 $x$ 的右导数的合理性；其次，为特定情况计算该刚度并讨论模型的行为；第三，为一组给定的参数计算刚度。\n\n首先，我们论证输运刚度的定义。问题陈述定性地将输运刚度定义为“归一化湍流热通量对临界梯度 $x_c$ 附近驱动的敏感度”。在数学上，函数 $f(y)$ 对其自变量 $y$ 变化的敏感度由其导数 $\\mathrm{d}f/\\mathrm{d}y$ 来量化。在我们的情境中，函数是归一化湍流热通量 $\\hat{Q}$，自变量或“驱动”是无量纲温度梯度 $x$。因此，敏感度由导数 $\\partial \\hat{Q}/\\partial x$ 给出。\n\n$\\hat{Q}(x)$ 的模型给出为\n$$\n\\hat{Q}(x) \\;=\\; \\alpha \\,\\frac{\\left(x - x_c\\right)^{p}}{1 + \\beta \\left(x - x_c\\right)}\\,H\\!\\left(x - x_c\\right)\n$$\n其中 $H(z)$ 是亥维赛阶跃函数，定义为当 $z<0$ 时 $H(z)=0$，当 $z \\ge 0$ 时 $H(z)=1$。该模型体现了临界梯度概念：对于 $x \\le x_c$，项 $x - x_c \\le 0$，因此 $H(x-x_c)=0$，从而 $\\hat{Q}(x)=0$。这意味着在梯度驱动 $x$ 超过临界阈值 $x_c$ 之前，湍流输运不会“开启”。短语“临界梯度附近”指导我们研究 $\\hat{Q}(x)$ 在 $x=x_c$ 紧邻区域的行为。由于我们关心的是驱动超过阈值时输运的触发，相关行为由 $x$ 从上方趋近于 $x_c$ ($x \\to x_c^{+}$) 时的极限所捕捉。这自然引出了在 $x_c$ 处的右导数定义：\n$$\n\\text{刚度} \\equiv \\lim_{h \\to 0^{+}} \\frac{\\hat{Q}(x_c+h) - \\hat{Q}(x_c)}{h} = \\left.\\frac{\\partial \\hat{Q}}{\\partial x}\\right|_{x=x_c^{+}}\n$$\n这将热通量对驱动在临界点之上微小增加的响应强度这一物理概念形式化了，而这正是刚度的本质。\n\n第二，我们计算指数 $p=1$ 这一特定情况下的刚度。对于 $x > x_c$，亥维赛函数为 $H(x-x_c)=1$，模型简化为：\n$$\n\\hat{Q}(x) = \\alpha \\frac{x - x_c}{1 + \\beta(x - x_c)}, \\quad \\text{对于 } x > x_c\n$$\n为了求出刚度，我们必须计算导数 $\\partial \\hat{Q}/\\partial x$。我们使用微分的商法则 $\\frac{\\mathrm{d}}{\\mathrm{d}z}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$，其中 $u(x) = \\alpha(x-x_c)$ 且 $v(x) = 1 + \\beta(x-x_c)$。它们的导数是 $u'(x) = \\alpha$ 和 $v'(x) = \\beta$。\n应用该法则，我们得到：\n$$\n\\frac{\\partial \\hat{Q}}{\\partial x} = \\frac{(\\alpha)\\left(1 + \\beta(x - x_c)\\right) - \\left(\\alpha(x - x_c)\\right)(\\beta)}{\\left(1 + \\beta(x - x_c)\\right)^2}\n$$\n化简分子：\n$$\n\\alpha + \\alpha\\beta(x - x_c) - \\alpha\\beta(x - x_c) = \\alpha\n$$\n因此，对于 $x > x_c$ 的导数是：\n$$\n\\frac{\\partial \\hat{Q}}{\\partial x} = \\frac{\\alpha}{\\left(1 + \\beta(x - x_c)\\right)^2}\n$$\n为了求出刚度，我们在 $x \\to x_c^{+}$ 的极限下计算该表达式：\n$$\n\\left.\\frac{\\partial \\hat{Q}}{\\partial x}\\right|_{x_c^{+}} = \\lim_{x \\to x_c^{+}} \\frac{\\alpha}{\\left(1 + \\beta(x - x_c)\\right)^2} = \\frac{\\alpha}{\\left(1 + \\beta(x_c - x_c)\\right)^2} = \\frac{\\alpha}{(1 + 0)^2} = \\alpha\n$$\n所以，对于 $p=1$ 的情况，输运刚度就是参数 $\\alpha$。\n\n接下来，我们根据指数 $p>0$ 讨论触发行为。刚度，即 $\\hat{Q}(x)$ 在 $x_c^{+}$ 处的初始斜率，决定了过渡的性质。我们分析当 $x \\to x_c^{+}$ 时一般形式的导数。令 $y = x-x_c$。对于 $y>0$，$\\hat{Q}(y) = \\alpha y^p / (1+\\beta y)$。其导数为：\n$$\n\\frac{\\partial \\hat{Q}}{\\partial y} = \\alpha \\frac{p y^{p-1}(1+\\beta y) - y^p(\\beta)}{(1+\\beta y)^2} = \\alpha \\frac{p y^{p-1} + (p-1)\\beta y^p}{(1+\\beta y)^2}\n$$\n我们考察当 $y \\to 0^{+}$ 时的极限：\n1.  如果 $p=1$：$\\lim_{y \\to 0^{+}} \\frac{\\partial \\hat{Q}}{\\partial y} = \\alpha \\frac{1\\cdot y^0 + 0}{(1+\\beta y)^2} = \\alpha$。由于 $\\alpha>0$，刚度是一个有限的正常量。这描述了一种**突发的有限斜率触发**，其中通量开始随超出部分的梯度驱动线性增长。\n2.  如果 $p>1$：指数 $p-1$ 为正。当 $y \\to 0^{+}$ 时，$y^{p-1} \\to 0$ 和 $y^p \\to 0$。分子趋于0而分母趋于1，因此 $\\lim_{y \\to 0^{+}} \\frac{\\partial \\hat{Q}}{\\partial y} = 0$。这描述了一种**初始斜率消失的超临界斜坡**。通量平滑且逐渐地开启，初始斜率为零。\n3.  如果 $0<p<1$：指数 $p-1$ 为负。当 $y \\to 0^{+}$ 时，项 $y^{p-1} \\to \\infty$。分子变为无穷大，因此 $\\lim_{y \\to 0^{+}} \\frac{\\partial \\hat{Q}}{\\partial y} = \\infty$。这描述了一种**阈值处的奇异触发**，其中通量的斜率在阈值处为无穷大，意味着对于任何高于 $x_c$ 的无穷小驱动，输运都会极其敏感地快速增加。\n\n最后，我们为给定的参数值计算输运刚度：$\\alpha = 9.80665$，$\\beta = 0.60$，$x_c = 4.50$ 和 $p=1$。\n如上所推导，对于 $p=1$ 的情况，输运刚度等于 $\\alpha$。\n$$\n\\text{刚度} = \\alpha = 9.80665\n$$\n问题要求将此结果四舍五入到四位有效数字。\n$$\n\\text{刚度} \\approx 9.807\n$$\n该值是无量纲的，这与定义 $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$ 一致，其中 $\\hat{Q}$ 和 $x$ 都是无量纲的。",
            "answer": "$$\\boxed{9.807}$$"
        },
        {
            "introduction": "在定义了通量的物理模型之后，我们必须构建一个数学上适定的问题来求解输运方程。边界条件的选择并非任意，而是由等离子体核心和边界处的基本物理原理（如对称性和能量守恒）决定的。本练习要求你从第一性原理出发，为径向输运方程论证恰当的边界条件。在任何诠释性或预测性模拟中，正确设置这些条件是确保解具有物理意义的关键第一步。",
            "id": "3997906",
            "problem": "考虑一个轴对称、低碰撞的托卡马克等离子体，其小半径为 $a$，大半径为 $R_0$。设 $r$ 是与小半径成正比的磁通面标签。在闭合磁力线区域（$0 \\le r \\le a$）内，离子温度 $T(r,t)$ 的磁通面平均、一维径向能量输运方程可建模为\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) + \\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = S_E(r),\n$$\n其中 $n(r)$ 是密度，$V'(r) = \\frac{dV}{dr}$ 是所包围的磁通面体积 $V(r)$ 的导数，$q_r(r) = - n \\chi \\frac{\\partial T}{\\partial r} + n v_r T$ 是由扩散（$\\chi$）和对流（$v_r$）部分组成的径向热通量，$S_E(r)$ 是体加热源。假设 $n(r)$、$\\chi(r)$、$v_r(r)$ 和 $S_E(r)$ 在 $[0,a]$ 上是光滑的，$V'(r)$ 在 $r \\to 0^+$ 时的行为如同 $V'(r) \\sim C r$（其中 $C > 0$ 为某个常数），并且在 $r=0$ 处没有奇异源或点源。位于 $r=a$ 处的分界面连接到刮削层（SOL），在刮削层中，开放磁力线将热量带到偏滤器；台基顶部位于分界面内侧的闭合磁力线上。\n\n在诠释性建模中，闭合磁力线剖面受到测量的台基顶部值的约束；在预测性建模中，台基顶部值由边界台基模型提供或从刮削层物理外推得出。你的任务是论证在磁轴（$r=0$）和分界面（$r=a$）处的边界条件，以确保上述径向输运方程的解在数学上是适定的并且在物理上是一致的。\n\n以下哪些陈述正确地论证了 $T(r)$ 在 $r=0$ 和 $r=a$ 处的合适边界条件？\n\nA. 在磁轴处，施加 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$，因为旋转对称性和标量场 $T(\\mathbf{x})$ 的正则性要求轴心处的梯度为零；任何非零的 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0}$ 都会选择一个优先方向，并且当与 $V'(r)\\sim C r$ 结合时，可能导致非物理的 $\\frac{1}{V'}\\frac{\\partial}{\\partial r}\\left[V' q_r\\right]$ 行为，除非有奇异源来补偿。\n\nB. 在分界面（$r=a$）处，施加狄利克雷条件 $T(a) = T_{\\mathrm{ped,top}}$，其中 $T_{\\mathrm{ped,top}}$ 要么是实验测量的（诠释性），要么是由边界台基/刮削层模型提供的（预测性）；这将闭合磁力线区域的边界固定在一个与刮削层中的平行热量移除相匹配的、物理上一致的台基顶部状态。\n\nC. 在磁轴处，施加 $T(0)=0$ 来消除未知的芯部热通量；即使在有有限中心加热的情况下，这也保证了解的唯一性。\n\nD. 在分界面处，施加 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$，因为分界面内部的磁力线是闭合的，所以没有净热量穿过 $r=a$ 损失，梯度在此处应该为零。\n\n选择所有适用项。请提供基于第一性原理的推理，植根于对称性、正则性和能量守恒，而不是启发式的经验法则。",
            "solution": "用户要求对问题陈述进行批判性验证，然后给出详细的解答和对所提供選項的评估。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题提供了以下信息：\n- **控制方程**：轴对称托卡马克中离子温度 $T(r,t)$ 的一维径向能量输运方程：\n    $$\n    \\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) + \\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = S_E(r)\n    $$\n- **定义域**：闭合磁力线区域，$0 \\le r \\le a$。\n- **定义**：\n    - $r$：与小半径成正比的磁通面标签。\n    - $a$：小半径（分界面的位置）。\n    - $n(r)$：粒子密度。\n    - $T(r,t)$：离子温度。\n    - $V'(r) = \\frac{dV}{dr}$：所包围的磁通面体积 $V(r)$ 的导数。\n    - $q_r(r)$：径向热通量，由 $q_r(r) = - n \\chi \\frac{\\partial T}{\\partial r} + n v_r T$ 给出。\n    - $\\chi(r)$：热扩散系数。\n    - $v_r(r)$：径向对流速度。\n    - $S_E(r)$：体加热源。\n- **假设和条件**：\n    - 等离子体处于低碰撞托卡马克中，是轴对称的。\n    - $n(r)$, $\\chi(r)$, $v_r(r)$ 和 $S_E(r)$ 在区间 $[0,a]$上是光滑函数。\n    - 几何因子 $V'(r)$ 在 $r \\to 0^+$ 时表现为 $V'(r) \\sim C r$，其中常数 $C > 0$。\n    - 在磁轴 $r=0$ 处没有奇异源或点源。\n- **上下文**：问题区分了诠释性建模（使用测量数据）和预测性建模（使用基于物理的模型）来处理 $r=a$ 处的边界条件。\n- **目标**：为 $T(r)$ 在 $r=0$ 和 $r=a$ 处的边界条件提供论证，以确保一个在数学上适定且在物理上一致的解。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于托卡马克等离子体芯部新经典和湍流输运的标准、广泛使用的公式。该输运方程是对动理学方程取矩并在磁通面上平均的直接结果。扩散通量和对流通量的定义是标准的。对于靠近轴心的圆形截面环形等离子体（其中 $V(r) \\approx (2\\pi R_0)(\\pi r^2)$，因此 $V'(r) \\approx 4\\pi^2 R_0 r$），几何假设 $V'(r) \\sim C r$ 在小 $r$ 处是正确的。对分界面、刮削层（SOL）和台基物理的描述是准确的。该问题在科学上是合理的。\n- **适定性**：任务是确定给定偏微分方程在何种条件下是适定的。该方程是一个二阶（空间）抛物型偏微分方程，需要两个空间边界条件才能得到唯一解。确定这些条件是求解此类方程的一个标准而关键的步骤。该问题的结构旨在直接解决这一问题。\n- **客观性**：所用术语在计算聚变科学领域是精确和标准的。问题陈述没有主观或模糊的语言。\n\n**步骤 3：结论与行动**\n\n问题陈述在科学上是合理的、适定的、客观的和完整的。它准确地代表了输运建模中的一个根本性挑战。因此，该问题是**有效的**。我们可以继续进行解答。\n\n### 解答推导与选项分析\n\n控制方程是一个能量守恒定律。让我们分析在定义域的两个边界——磁轴（$r=0$）和分界面（$r=a$）——上，获得物理和数学上一致解的要求。\n\n**磁轴（$r=0$）处边界条件的分析**\n\n输运方程中的空间算子是热通量的散度，$\\nabla \\cdot \\mathbf{q}$，在其磁通面平均的一维形式下为 $\\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right]$。问题陈述中说明在 $r=0$ 处没有奇异源。这意味着方程中的所有项在 $r=0$ 处都必须是有限的。\n\n让我们分析这个散度项。我们可以将其重写为：\n$$\n\\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = \\frac{\\partial q_r}{\\partial r} + \\frac{V''(r)}{V'(r)} q_r(r)\n$$\n给定 $V'(r) \\sim Cr$ for $r \\to 0^+$，则 $V''(r) \\sim C$。因此，比率 $\\frac{V''(r)}{V'(r)} \\sim \\frac{C}{Cr} = \\frac{1}{r}$ 对于小 $r$ 成立。散度项变为：\n$$\n\\frac{\\partial q_r}{\\partial r} + \\frac{1}{r}q_r(r)\n$$\n这是柱坐标系中散度径向部分的标准形式。\n为了使整个表达式在 $r=0$ 处为有限值，我们不能有行为类似于 $1/r$ 的项。让我们研究 $q_r(r)$ 在 $r \\to 0$ 时的行为。我们假设 $T(r)$ 在 $r=0$ 附近有泰勒级数展开。由于物理系统的轴对称性，温度 $T$ 作为对应于极向截面的二维空间 $(x,y)$ 中的标量场，必须是一个光滑函数。一个关于原点对称的函数 $f(x,y)$（即仅依赖于 $r = \\sqrt{x^2+y^2}$）仅当其泰勒展开只包含 $r$ 的偶次幂时，才在原点处光滑。\n也就是说，$T(r) = T_0 + T_2 r^2 + T_4 r^4 + ...$，其中 $T_n$ 是常数。任何包含 $r$ 的奇次幂的项，例如 $T_1 r$，将对应于像 $T_1\\sqrt{x^2+y^2}$ 这样的函数，它在原点有一个锥点（尖点），并且在该点不可微。\n根据这个正则性要求，温度对 $r$ 的一阶导数为：\n$$\n\\frac{\\partial T}{\\partial r} = 2 T_2 r + 4 T_4 r^3 + ...\n$$\n这立即意味着 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$。\n\n让我们从方程本身来验证这一点。如果我们假设一个非零梯度，$T(r) \\approx T_0 + T_1 r$，那么 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = T_1 \\ne 0$。靠近 $r=0$ 处的热通量大约为 $q_r(r) \\approx -n(0)\\chi(0)T_1 + n(0)v_r(0)T_0$。根据对称性，径向速度 $v_r$ 在轴心处必须为零（$v_r(0)=0$），否则在单一点上就会有净粒子源或汇。所以，$q_r(0) \\approx -n(0)\\chi(0)T_1$。这是一个有限的非零常数。\n散度项 $\\frac{1}{r}q_r(r) + \\frac{\\partial q_r}{\\partial r}$ 就会有一个项 $\\frac{-n(0)\\chi(0)T_1}{r}$，它在 $r \\to 0$ 时发散。这将需要在 $S_E(r)$ 中有一个奇异源项（一个δ函数，$\\delta(r)$）来平衡它，而这已被问题陈述明确排除了。\n因此，为确保解是正则的且方程在轴心处是良态的，我们必须施加条件 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$。这是一个自然（诺伊曼）边界条件。\n\n**分界面（$r=a$）处边界条件的分析**\n\n$r=a$ 处的分界面是具有闭合磁力线的“芯部”等离子体和具有终止于材料表面（偏滤器靶板）的开放磁力线的“刮削层”（SOL）之间的边界。\n1.  **输运机制**：在分界面内部（$r<a$），热量主要通过垂直于磁力线的径向输运（扩散/对流）缓慢地向外传输。在刮削层中（$r>a$），热量主要通过沿着开放磁力线的平行传导和对流快速地传输到偏滤器。由于平行输运比垂直输运快得多，刮削层中的温度剖面由平行输运物理决定，并且通常会急剧下降。\n2.  **能量守恒**：在稳态下，从芯部区域穿过 $r=a$ 的热通量 $q_r(a)$ 必须等于进入刮削层的热量，最终沉积在偏滤器上。$q_r(a)$ 通常是非零的，因为它代表了维持等离子体所需的总加热功率减去在芯部内辐射掉的功率。因此，在 $r=a$ 处施加零热通量或零梯度的边界条件（如选项D所述）在物理上是不正确的。\n3.  **耦合**：芯部和刮削层是两个物理上耦合的系统。刮削层中的状态决定了芯部等离子体“看到”的边界条件。在 $r=a$ 处的温度值，$T(a)$，是这种耦合的体现。这个值，被称为台基顶部温度 $T_{\\mathrm{ped,top}}$，是由刮削层中的功率耗散和输运过程决定的。在实践中，我们通常无法从第一性原理精确地解析整个刮削层。因此，我们采用以下两种方法之一：\n    - **诠释性建模**：我们直接从实验诊断（如汤姆逊散射）中测量台基顶部的温度 $T_{\\mathrm{ped,top}}$，并将其用作芯部输运求解器的狄利克雷边界条件，$T(a) = T_{\\mathrm{ped,top}}$。\n    - **预测性建模**：我们使用一个简化的边界/刮削层模型，该模型根据流入刮削层的功率 $q_r(a)$ 来预测 $T_{\\mathrm{ped,top}}$。然后，这个预测值被用作芯部模型的狄利克雷边界条件。\n\n在这两种情况下，最合适、物理上最一致的边界条件是在 $r=a$ 处施加一个狄利克雷条件，其值反映了与刮削层物理的连接。\n\n**评估选项**\n\n- **A. 在磁轴处，施加 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$...**\n  - **评估**：**正确**。我们的分析表明，这个诺伊曼边界条件是轴对称性和解在 $r=0$ 处的正则性所必需的。它避免了在没有奇异源的情况下，方程中出现非物理的发散项。\n\n- **B. 在分界面（$r=a$）处，施加狄利克雷条件 $T(a) = T_{\\mathrm{ped,top}}$...**\n  - **评估**：**正确**。我们的分析表明，这是一个物理上一致的条件，它将芯部区域与刮削层中的快速平行输运物理耦合起来。这个值既可以从实验中测量得到，也可以从边界模型中预测得到。\n\n- **C. 在磁轴处，施加 $T(0)=0$ ...**\n  - **评估**：**不正确**。中心温度通常是等离子体中的最高点，尤其是在有中心加热的情况下。施加 $T(0)=0$ 是完全不符合物理实际的，除非在没有中心加热且有强中心冷却的特殊情况下。它也不能“消除未知的芯部热通量”；热通量由梯度决定，梯度则由诺伊曼条件（选项A）在轴心处设为零。\n\n- **D. 在分界面处，施加 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$...**\n  - **评估**：**不正确**。这个条件意味着在分界面处的传导热通量为零。然而，必须有一个净热通量从芯部流出以平衡加热功率。因此，这个条件违反了能量守恒。\n\n**结论**\n\n正确的陈述是A和B。它们共同为二阶输运方程提供了两个物理上和数学上都合理的边界条件。",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "输运模型的“刚性”特性给数值计算带来了巨大挑战。时间步进算法的选择——无论是显式还是隐式——对模拟的稳定性和效率有着深远的影响，尤其是在细网格上处理大输运系数时。通过冯·诺依曼稳定性分析，本练习将揭示为何显式方法对于刚性输运问题通常不切实际，而隐式方法却至关重要。为一个实际场景计算最大稳定时间步长，将巩固你对 Courant–Friedrichs–Lewy (CFL) 条件及其在输运代码开发中实际影响的理解。",
            "id": "3997886",
            "problem": "考虑磁约束聚变等离子体中的轴对称径向热输运，其在平板几何中通过温度场 $T(r,t)$ 的一维扩散方程进行建模，\n$$\n\\frac{\\partial T}{\\partial t} = \\chi(r)\\,\\frac{\\partial^{2} T}{\\partial r^{2}} + S(r,t),\n$$\n其中 $\\chi(r)$ 是湍流热扩散系数，$S(r,t)$ 是一个外部施加的热源。在具有刚性输运的区域，$\\chi(r)$ 可能会在局部区域变得很大，预测性输运求解器必须选择在精细径向网格上保持稳定的时间步进格式。\n\n您将分析线性齐次扩散算子（设 $S=0$），并比较在均匀网格上使用二阶中心差分得到的半离散问题中，前向欧拉（显式）和后向欧拉（隐式）时间步进的稳定性。然后，您将把得到的稳定性约束应用于一个非均匀网格和一个代表台基区的空间变化的 $\\chi(r)$ 剖面。\n\n任务：\n\n1. 从线性扩散算子出发，对间距为 $\\Delta r$ 的均匀网格进行 von Neumann (傅里叶) 稳定性分析，针对：\n   - 前向欧拉（显式）时间步进离散化。\n   - 后向欧拉（隐式）时间步进离散化。\n   推导每种格式对傅里叶模式 $\\exp(\\mathrm{i} k r)$ 的放大因子 $G(k)$，并根据无量纲参数 $\\mu = \\chi\\,\\Delta t/\\Delta r^{2}$ 确定相应的稳定性要求。利用放大因子解释为什么后向欧拉是无条件稳定的，而前向欧拉需要一个时间步长约束，这个约束对于具有大 $\\chi$ 和小 $\\Delta r$ 的刚性输运会变得非常严苛。\n\n2. 考虑一个模拟芯部-台基-边界结构的非均匀径向网格和扩散系数剖面：\n   - 芯部区域：均匀单元宽度 $\\Delta r_{\\mathrm{core}} = 0.015\\,\\mathrm{m}$，恒定扩散系数 $\\chi_{\\mathrm{core}} = 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n   - 台基区域：均匀单元宽度 $\\Delta r_{\\mathrm{ped}} = 0.003\\,\\mathrm{m}$，恒定扩散系数 $\\chi_{\\mathrm{ped}} = 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n   - 边界区域：均匀单元宽度 $\\Delta r_{\\mathrm{edge}} = 0.012\\,\\mathrm{m}$，恒定扩散系数 $\\chi_{\\mathrm{edge}} = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n\n   利用您的分析得出的局部扩散 Courant–Friedrichs–Lewy (CFL) 条件，通过取各区域的最小值，计算该网格上前向欧拉显式格式的最大稳定时间步长 $\\Delta t_{\\max}$。将最终的 $\\Delta t_{\\max}$ 以微秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是适定的且客观的。该问题描述了一维扩散方程，这是等离子体中热输运的一个标准模型。它要求对两种常见的数值格式——前向欧拉和后向欧拉——进行 von Neumann 稳定性分析，这是计算物理学中的一个基本步骤。所有参数和常数都得到了明确定义，并且所提供的值在聚变等离子体的背景下是物理上合理的。任务具体，所需数据完整。因此，该问题被认为是有效的。\n\n我们从线性齐次一维扩散方程开始分析：\n$$\n\\frac{\\partial T}{\\partial t} = \\chi\\,\\frac{\\partial^{2} T}{\\partial r^{2}}\n$$\n在这里，为了在间距为 $\\Delta r$ 的均匀网格上进行 von Neumann 分析，我们将热扩散系数 $\\chi$ 视为常数。网格点 $j$ 和时间步 $n$ 处的温度表示为 $T_j^n \\equiv T(j\\Delta r, n\\Delta t)$。对空间导数使用二阶中心差分，半离散方程为：\n$$\n\\frac{d T_j}{d t} = \\chi \\left( \\frac{T_{j+1} - 2T_j + T_{j-1}}{\\Delta r^2} \\right)\n$$\n\n### 任务 1：Von Neumann 稳定性分析\n\n我们通过考虑单个傅里叶模式 $T_j^n = G^n(k) \\exp(\\mathrm{i} k j \\Delta r)$ 来分析稳定性，其中 $k$ 是波数，$G(k)$ 是每个时间步长 $\\Delta t$ 的放大因子。如果对于所有可能的波数 $k$ 都有 $|G(k)| \\le 1$，则该格式是稳定的。\n\n#### 1a. 前向欧拉（显式）格式\n半离散方程的前向欧拉离散化是：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\chi \\left( \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{\\Delta r^2} \\right)\n$$\n重新整理并引入无量纲参数 $\\mu = \\chi \\Delta t / \\Delta r^2$，我们得到：\n$$\nT_j^{n+1} = T_j^n + \\mu (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n代入傅里叶模式 $T_j^n = G^n(k) \\exp(\\mathrm{i} k j \\Delta r)$：\n$$\nG^{n+1}\\exp(\\mathrm{i}kj\\Delta r) = G^n\\exp(\\mathrm{i}kj\\Delta r) + \\mu \\left( G^n\\exp(\\mathrm{i}k(j+1)\\Delta r) - 2G^n\\exp(\\mathrm{i}kj\\Delta r) + G^n\\exp(\\mathrm{i}k(j-1)\\Delta r) \\right)\n$$\n两边同除以 $G^n \\exp(\\mathrm{i} k j \\Delta r)$，我们得到放大因子 $G(k) = G^{n+1}/G^n$：\n$$\nG(k) = 1 + \\mu (\\exp(\\mathrm{i}k\\Delta r) - 2 + \\exp(-\\mathrm{i}k\\Delta r))\n$$\n使用恒等式 $2\\cos(\\theta) = \\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)$，上式可简化为：\n$$\nG(k) = 1 + \\mu (2\\cos(k\\Delta r) - 2) = 1 - 2\\mu(1 - \\cos(k\\Delta r))\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG(k) = 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\n为了保证稳定性，我们要求 $|G(k)| \\le 1$。由于 $G(k)$ 是实值，该条件等价于 $-1 \\le G(k) \\le 1$。\n条件 $G(k) \\le 1$ 总是满足的，因为 $\\mu > 0$ 且 $\\sin^2(\\cdot) \\ge 0$。\n关键条件是 $G(k) \\ge -1$：\n$$\n-1 \\le 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\n$$\n4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right) \\le 2\n$$\n这个不等式必须对所有 $k$ 成立。最严格的情况发生在 $\\sin^2(k\\Delta r/2)$ 取最大值时，即为 $1$（对应最高频率模式，此时 $k\\Delta r = \\pi$）。这给出了稳定性约束：\n$$\n4\\mu(1) \\le 2 \\implies \\mu \\le \\frac{1}{2}\n$$\n因此，前向欧拉格式是条件稳定的，要求 $\\mu = \\chi \\Delta t / \\Delta r^2 \\le 1/2$。\n\n#### 1b. 后向欧拉（隐式）格式\n后向欧拉离散化在未来的时间步 $n+1$ 处计算空间导数：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\chi \\left( \\frac{T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}}{\\Delta r^2} \\right)\n$$\n重新整理得到：\n$$\nT_j^n = T_j^{n+1} - \\mu(T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1})\n$$\n代入傅里叶模式：\n$$\nG^n\\exp(\\mathrm{i}kj\\Delta r) = G^{n+1}\\exp(\\mathrm{i}kj\\Delta r) - \\mu \\left( G^{n+1}\\exp(\\mathrm{i}k(j+1)\\Delta r) - 2G^{n+1}\\exp(\\mathrm{i}kj\\Delta r) + G^{n+1}\\exp(\\mathrm{i}k(j-1)\\Delta r) \\right)\n$$\n两边同除以 $G^{n+1} \\exp(\\mathrm{i} k j \\Delta r)$：\n$$\n\\frac{1}{G(k)} = 1 - \\mu(\\exp(\\mathrm{i}k\\Delta r) - 2 + \\exp(-\\mathrm{i}k\\Delta r)) = 1 - 2\\mu(\\cos(k\\Delta r) - 1) = 1 + 4\\mu\\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\n所以，放大因子为：\n$$\nG(k) = \\frac{1}{1 + 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)}\n$$\n为了保证稳定性，我们要求 $|G(k)| \\le 1$。因为 $\\mu > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，分母 $1 + 4\\mu \\sin^2(k\\Delta r/2)$ 总是大于或等于 $1$。因此，对于所有 $\\mu$ 和 $k$ 的值，都有 $0 < G(k) \\le 1$。后向欧拉格式是无条件稳定的。\n\n#### 解释\n前向欧拉的稳定性约束是 $\\Delta t \\le \\frac{\\Delta r^2}{2\\chi}$。在刚性输运区域，例如聚变等离子体的台基区，湍流热扩散系数 $\\chi$ 非常大。为了解析这些区域中的陡峭梯度，需要一个精细的径向网格（小的 $\\Delta r$）。大的 $\\chi$ 和小的 $\\Delta r$ 都严重限制了显式格式的最大稳定时间步长 $\\Delta t$，因为 $\\Delta t$ 与 $\\Delta r^2$ 成正比，与 $1/\\chi$ 成反比。这使得前向欧拉格式在计算上变得不可行。\n相比之下，后向欧拉格式是无条件稳定的，这意味着其放大因子 $|G(k)| \\le 1$ 与 $\\Delta t$、$\\Delta r$ 和 $\\chi$ 的值无关。这允许选择一个大得多的 $\\Delta t$，其大小仅受所需精度的限制，而不受稳定性的限制。这一特性使得像后向欧拉这样的隐式格式对于高效模拟刚性输运问题至关重要。\n\n### 任务 2：最大稳定时间步长计算\n\n对于在具有空间变化的扩散系数的非均匀网格上的前向欧拉格式，稳定性条件必须在区域内的每一点局部成立。因此，全局最大稳定时间步长 $\\Delta t_{\\max}$ 受限于限制最强的区域，即 $\\Delta r^2 / (2\\chi)$ 值最小的区域。\n局部稳定性条件是：\n$$\n\\Delta t \\le \\frac{\\Delta r_i^2}{2\\chi_i}\n$$\n其中索引 $i$ 表示特定区域（芯部、台基或边界）。全局最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\min \\left( \\frac{\\Delta r_{\\mathrm{core}}^2}{2\\chi_{\\mathrm{core}}}, \\frac{\\Delta r_{\\mathrm{ped}}^2}{2\\chi_{\\mathrm{ped}}}, \\frac{\\Delta r_{\\mathrm{edge}}^2}{2\\chi_{\\mathrm{edge}}} \\right)\n$$\n我们使用提供的数据为每个区域计算该值：\n- **芯部区域：** $\\Delta r_{\\mathrm{core}} = 0.015\\,\\mathrm{m}$, $\\chi_{\\mathrm{core}} = 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{core}} = \\frac{(0.015\\,\\mathrm{m})^2}{2 \\times 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{0.000225}{1.6}\\,\\mathrm{s} = 0.000140625\\,\\mathrm{s} = 140.625\\,\\mu\\mathrm{s}\n$$\n- **台基区域：** $\\Delta r_{\\mathrm{ped}} = 0.003\\,\\mathrm{m}$, $\\chi_{\\mathrm{ped}} = 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{ped}} = \\frac{(0.003\\,\\mathrm{m})^2}{2 \\times 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{9 \\times 10^{-6}}{3.0}\\,\\mathrm{s} = 3 \\times 10^{-6}\\,\\mathrm{s} = 3.0\\,\\mu\\mathrm{s}\n$$\n- **边界区域：** $\\Delta r_{\\mathrm{edge}} = 0.012\\,\\mathrm{m}$, $\\chi_{\\mathrm{edge}} = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{edge}} = \\frac{(0.012\\,\\mathrm{m})^2}{2 \\times 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{0.000144}{0.6}\\,\\mathrm{s} = 0.00024\\,\\mathrm{s} = 240.0\\,\\mu\\mathrm{s}\n$$\n全局最大稳定时间步长是这些值的最小值：\n$$\n\\Delta t_{\\max} = \\min(140.625\\,\\mu\\mathrm{s}, 3.0\\,\\mu\\mathrm{s}, 240.0\\,\\mu\\mathrm{s}) = 3.0\\,\\mu\\mathrm{s}\n$$\n台基区域，由于其高扩散系数和精细网格间距的组合，对显式时间步长施加了最严格的约束。\n将结果四舍五入到四位有效数字，得到 $3.000\\,\\mu\\mathrm{s}$。",
            "answer": "$$\\boxed{3.000}$$"
        }
    ]
}