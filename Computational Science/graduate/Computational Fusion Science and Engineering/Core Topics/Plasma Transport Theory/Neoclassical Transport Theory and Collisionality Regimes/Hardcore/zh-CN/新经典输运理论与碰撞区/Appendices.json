{
    "hands_on_practices": [
        {
            "introduction": "新经典输运的物理过程与托卡马克磁场的几何结构紧密相连。在深入探讨复杂的粒子轨道动力学之前，我们必须首先掌握在磁通面上对物理量进行平均的基本数学工具。本练习  将引导您计算在高碰撞率的Pfirsch-Schlüter机制中出现的关键几何因子，这不仅是对磁通面平均概念的具体应用，也是理解碰撞输运如何受磁场不均匀性影响的第一步。",
            "id": "4019211",
            "problem": "考虑一个大环径比的轴对称托卡马克，其磁通面为小半径为 $r$、大半径为 $R_{0}$ 的同心圆。定义反环径比 $\\varepsilon \\equiv r/R_{0}$，且 $\\varepsilon \\ll 1$。设极向角为 $\\theta$，环向角为 $\\phi$。在此极限下，磁通面上的大半径可取为 $R(\\theta) = R_{0} \\left(1 + \\varepsilon \\cos\\theta\\right)$，磁场大小主要由环向场决定，其标度关系为 $B(\\theta) \\propto 1/R(\\theta)$。为确定起见，取 $B(\\theta) = B_{0} \\, R_{0}/R(\\theta) = B_{0}/\\left(1 + \\varepsilon \\cos\\theta\\right)$，其中 $B_{0}$ 是一个常数。\n\n标量场 $f(\\theta,\\phi)$ 的磁通面平均定义为\n$$\n\\langle f \\rangle \\equiv \\frac{\\displaystyle \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\frac{dS}{|\\nabla \\psi|} \\, f(\\theta,\\phi)}{\\displaystyle \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\frac{dS}{|\\nabla \\psi|}},\n$$\n其中 $\\psi$ 是一个磁通标记，$dS$ 是面元。对于大环径比的圆形托卡马克，$dS/|\\nabla\\psi|$ 正比于 $R(\\theta)$，因此磁通面平均简化为以 $R(\\theta)$ 为权重的归一化 $\\theta$ 平均：\n$$\n\\langle f \\rangle = \\frac{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R(\\theta) \\, f(\\theta)}{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R(\\theta)}.\n$$\n\n任务：\n1) 使用这个大环径比雅可比，计算磁通面平均 $\\langle \\cos\\theta \\rangle$ 和 $\\langle \\cos^{2}\\theta \\rangle$。\n\n2) 在碰撞 Pfirsch–Schlüter (PS) 区，几何因子如 $\\langle B^{-2} \\cos\\theta \\rangle$ 和 $\\langle B^{-2} \\rangle$ 会出现在 PS 平行流和电流的极向变化部分的公式中。定义无量纲几何因子\n$$\nG_{\\mathrm{PS}}(\\varepsilon) \\equiv \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle},\n$$\n其磁通面平均使用相同的大环径比雅可比进行计算。结合第1部分的结果以及 $B(\\theta) = B_{0}/\\left(1 + \\varepsilon \\cos\\theta\\right)$，以 $\\varepsilon$ 的函数形式，计算 $G_{\\mathrm{PS}}(\\varepsilon)$ 的闭合形式表达式。\n\n你的最终答案必须是 $G_{\\mathrm{PS}}(\\varepsilon)$ 的单一解析表达式。不要在最终结果中包含任何单位。",
            "solution": "问题提法恰当，有科学依据，并包含求得唯一解所需的所有信息。我们可以开始计算。\n\n首先，我们简化问题描述中给出的磁通面平均 $\\langle f \\rangle$ 的表达式。平均值的分母为\n$$\n\\int_{0}^{2\\pi} d\\theta \\, R(\\theta) = \\int_{0}^{2\\pi} d\\theta \\, R_{0} (1 + \\varepsilon \\cos\\theta) = R_{0} \\left[ \\int_{0}^{2\\pi} d\\theta + \\varepsilon \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta \\right]\n$$\n$\\cos\\theta$ 在一个周期上的积分为零，因此\n$$\n\\int_{0}^{2\\pi} d\\theta \\, R(\\theta) = R_{0} \\left( [\\theta]_{0}^{2\\pi} + \\varepsilon[\\sin\\theta]_{0}^{2\\pi} \\right) = R_{0} (2\\pi + 0) = 2\\pi R_{0}\n$$\n因此，磁通面平均简化为\n$$\n\\langle f \\rangle = \\frac{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R_{0} (1 + \\varepsilon \\cos\\theta) \\, f(\\theta)}{2\\pi R_{0}} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\, f(\\theta)\n$$\n\n现在我们处理第一个任务：计算 $\\langle \\cos\\theta \\rangle$ 和 $\\langle \\cos^{2}\\theta \\rangle$。\n\n对于 $\\langle \\cos\\theta \\rangle$，我们设 $f(\\theta) = \\cos\\theta$：\n$$\n\\langle \\cos\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\cos\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (\\cos\\theta + \\varepsilon \\cos^{2}\\theta) \\, d\\theta\n$$\n我们使用标准定积分：$\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = 0$ 和 $\\int_{0}^{2\\pi} \\cos^{2}\\theta \\, d\\theta = \\pi$。\n$$\n\\langle \\cos\\theta \\rangle = \\frac{1}{2\\pi} (0 + \\varepsilon \\pi) = \\frac{\\varepsilon}{2}\n$$\n\n对于 $\\langle \\cos^{2}\\theta \\rangle$，我们设 $f(\\theta) = \\cos^{2}\\theta$：\n$$\n\\langle \\cos^{2}\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\cos^{2}\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (\\cos^{2}\\theta + \\varepsilon \\cos^{3}\\theta) \\, d\\theta\n$$\n我们使用积分 $\\int_{0}^{2\\pi} \\cos^{2}\\theta \\, d\\theta = \\pi$ 和 $\\int_{0}^{2\\pi} \\cos^{3}\\theta \\, d\\theta = 0$ （因为余弦的奇次幂在一个完整周期上的积分为零）。\n$$\n\\langle \\cos^{2}\\theta \\rangle = \\frac{1}{2\\pi} (\\pi + \\varepsilon \\cdot 0) = \\frac{1}{2}\n$$\n\n对于第二个任务，我们必须计算 $G_{\\mathrm{PS}}(\\varepsilon) = \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle}$。我们分别计算分子和分母。磁场由 $B(\\theta) = B_{0} / (1 + \\varepsilon \\cos\\theta)$ 给出，这意味着 $B^{-2}(\\theta) = B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2}$。\n\n首先，我们计算分母 $\\langle B^{-2} \\rangle$。需要平均的函数是 $f(\\theta) = B^{-2}(\\theta)$。\n$$\n\\langle B^{-2} \\rangle = \\langle B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2} \\rangle = B_{0}^{-2} \\langle 1 + 2\\varepsilon \\cos\\theta + \\varepsilon^{2} \\cos^{2}\\theta \\rangle\n$$\n利用平均算符的线性性质以及第1部分的结果：\n$$\n\\langle B^{-2} \\rangle = B_{0}^{-2} \\left[ \\langle 1 \\rangle + 2\\varepsilon \\langle \\cos\\theta \\rangle + \\varepsilon^{2} \\langle \\cos^{2}\\theta \\rangle \\right]\n$$\n常数的平均值是其自身，所以 $\\langle 1 \\rangle = 1$。代入先前计算出的平均值：\n$$\n\\langle B^{-2} \\rangle = B_{0}^{-2} \\left[ 1 + 2\\varepsilon \\left(\\frac{\\varepsilon}{2}\\right) + \\varepsilon^{2} \\left(\\frac{1}{2}\\right) \\right] = B_{0}^{-2} \\left( 1 + \\varepsilon^{2} + \\frac{1}{2}\\varepsilon^{2} \\right) = B_{0}^{-2} \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)\n$$\n\n接下来，我们计算分子 $\\langle B^{-2} \\cos\\theta \\rangle$。需要平均的函数是 $f(\\theta) = B^{-2}(\\theta)\\cos\\theta$。\n$$\n\\langle B^{-2} \\cos\\theta \\rangle = \\langle B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2} \\cos\\theta \\rangle = B_{0}^{-2} \\langle (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^{2}\\cos^{2}\\theta)\\cos\\theta \\rangle\n$$\n$$\n= B_{0}^{-2} \\langle \\cos\\theta + 2\\varepsilon\\cos^{2}\\theta + \\varepsilon^{2}\\cos^{3}\\theta \\rangle = B_{0}^{-2} \\left[ \\langle \\cos\\theta \\rangle + 2\\varepsilon \\langle \\cos^{2}\\theta \\rangle + \\varepsilon^{2} \\langle \\cos^{3}\\theta \\rangle \\right]\n$$\n我们需要计算 $\\langle \\cos^{3}\\theta \\rangle$：\n$$\n\\langle \\cos^{3}\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (1 + \\varepsilon \\cos\\theta) \\cos^{3}\\theta \\, d\\theta = \\frac{1}{2\\pi} \\left( \\int_{0}^{2\\pi} \\cos^{3}\\theta \\, d\\theta + \\varepsilon \\int_{0}^{2\\pi} \\cos^{4}\\theta \\, d\\theta \\right)\n$$\n$\\cos^3\\theta$ 的积分为 $0$。$\\cos^4\\theta$ 的积分为 $\\int_{0}^{2\\pi} \\cos^{4}\\theta \\, d\\theta = \\frac{3\\pi}{4}$。\n$$\n\\langle \\cos^{3}\\theta \\rangle = \\frac{1}{2\\pi} \\left( 0 + \\varepsilon \\frac{3\\pi}{4} \\right) = \\frac{3\\varepsilon}{8}\n$$\n现在，将平均值代入分子的表达式中：\n$$\n\\langle B^{-2} \\cos\\theta \\rangle = B_{0}^{-2} \\left[ \\frac{\\varepsilon}{2} + 2\\varepsilon\\left(\\frac{1}{2}\\right) + \\varepsilon^{2}\\left(\\frac{3\\varepsilon}{8}\\right) \\right] = B_{0}^{-2} \\left( \\frac{\\varepsilon}{2} + \\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right) = B_{0}^{-2} \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)\n$$\n\n最后，我们计算比值 $G_{\\mathrm{PS}}(\\varepsilon)$：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle} = \\frac{B_{0}^{-2} \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)}{B_{0}^{-2} \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)} = \\frac{\\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3}}{1 + \\frac{3}{2}\\varepsilon^{2}}\n$$\n为简化表达式，我们可以将分子和分母同乘以 $8$：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{8 \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)}{8 \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)} = \\frac{12\\varepsilon + 3\\varepsilon^{3}}{8 + 12\\varepsilon^{2}}\n$$\n提取公因式后得到最终的闭合形式表达式：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{3\\varepsilon(4 + \\varepsilon^{2})}{4(2 + 3\\varepsilon^{2})}\n$$",
            "answer": "$$\n\\boxed{\\frac{3\\varepsilon(4 + \\varepsilon^{2})}{4(2 + 3\\varepsilon^{2})}}\n$$"
        },
        {
            "introduction": "在前一个练习的基础上，我们进一步探讨磁场几何的径向变化，即磁剪切，及其对粒子动力学的重要影响。本练习  将一个描述磁场线螺旋程度的基本参数——安全因子 $q$——与低碰撞率香蕉机制下捕获粒子的运动行为直接联系起来。通过亲手推导磁剪切并阐明其如何改变粒子轨道进动，您将深刻理解静态的磁场位形如何主导了决定输运的微观粒子舞蹈。",
            "id": "4019244",
            "problem": "考虑一个大环径比、圆形截面、轴对称的托卡马克，其大半径为 $R_0$，小半径为 $a$，使用直场线磁通坐标 $(\\psi, \\theta, \\phi)$，其中 $\\psi$ 是极向磁通，$\\theta$ 是极向角，$\\phi$ 是环向角。磁力线满足 $d\\phi/d\\theta = ( \\boldsymbol{B} \\cdot \\nabla \\phi ) / ( \\boldsymbol{B} \\cdot \\nabla \\theta )$，安全因子 $q(\\psi)$ 定义为极向环路平均值 $q(\\psi) = (1/2\\pi) \\oint ( \\boldsymbol{B} \\cdot \\nabla \\phi ) / ( \\boldsymbol{B} \\cdot \\nabla \\theta ) \\, d\\theta$。在大环径比极限下，在给定的磁面上可以取 $R \\approx R_0$，并使用 $r$ 作为标记磁面的类小半径坐标。\n\n一个托卡马克平衡具有给定的安全因子剖面 $q(r)$，其中 $q(r)$ 随 $r$ 单调递增且可微。取\n$$\nq(r) = q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4},\n$$\n其中 $q_0  0$、$\\alpha  0$ 和 $\\beta \\ge 0$ 是常数。仅使用所提供的定义和标准的大环径比几何，完成以下任务：\n\n1. 从场线关系和安全因子作为磁面量的定义出发，推导一个衡量场线扭曲径向变化的无量纲量。然后，对给定的 $q(r)$ 计算该量的值。\n\n2. 在导心运动的漂移动理学描述框架下，解释在小反环径比 $\\epsilon \\equiv r/R_0 \\ll 1$ 存在时，有限的场线扭曲径向变化如何进入捕获粒子轨道的弹跳平均环向进动，并修正低碰撞（香蕉）区的新经典输运。你的解释应从导心漂移和弹跳平均的基本表达式开始，并清楚地说明第1部分中推导的量如何影响进动和输运标度。\n\n你的最终计算输出必须是针对给定 $q(r)$ 计算出的无量纲量的单个闭式解析表达式。不需要进行数值计算。",
            "solution": "用户提供了一个托卡马克等离子体物理领域的问题，经过我的验证，该问题在科学上是合理的、提法是恰当的，并且是内部一致的。这是一个关于托卡马克磁几何及其对新经典输运影响的标准但高级的问题。我现在将进行正式的解答。\n\n该问题分为两部分。第一部分要求推导一个衡量磁场线扭曲径向变化的无量纲量，并针对给定的安全因子剖面进行计算。第二部分要求物理解释该量如何影响捕获粒子的进动和新经典输运。\n\n### 第1部分：场线扭曲变化的无量纲量度\n\n在托卡马克中，给定磁面上磁力线的结构由安全因子 $q$ 来表征。问题陈述了 $q(\\psi)$ 被定义为局部场线螺距的极向环路平均值，$q(\\psi) = \\frac{1}{2\\pi} \\oint \\frac{\\boldsymbol{B} \\cdot \\nabla \\phi}{\\boldsymbol{B} \\cdot \\nabla \\theta} d\\theta$。在大环径比近似下，极向磁通 $\\psi$ 是小半径坐标 $r$ 的函数，因此我们可以将安全因子视为函数 $q(r)$。安全因子 $q(r)$ 代表在以 $r$ 标记的磁面上，磁力线每绕行极向一圈所绕行的环向圈数。因此，$q(r)$ 是该磁面上场线扭曲的直接量度。\n\n“场线扭曲的径向变化”指的是当我们从一个磁面移动到相邻磁面时，即当我们改变小半径 $r$ 时，这种扭曲如何变化。这种变化由安全因子的径向导数 $\\frac{dq}{dr}$ 来量化。\n\n然而，导数不是无量纲的。为了构建一个无量纲量，我们必须使用系统的特征量来归一化 $\\frac{dq}{dr}$。径向变化的自然局部长度尺度是小半径 $r$ 本身。安全因子的自然尺度是其局部值 $q(r)$。将这些结合起来，我们构成了被称为**磁剪切**的无量纲量，通常用 $s$ 表示：\n$$\ns(r) \\equiv \\frac{r}{q(r)} \\frac{dq}{dr}\n$$\n这个量也可以写成 $s(r) = \\frac{d(\\ln q)}{d(\\ln r)}$，它表示安全因子相对于小半径的对数导数。它提供了一个归一化的、局部的量度，用以衡量场线螺距随半径的变化。这就是要求我们推导的无量纲量。\n\n接下来，我们为给定的安全因子剖面计算这个量：\n$$\nq(r) = q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}\n$$\n其中 $q_0$、$\\alpha$ 和 $\\beta$ 是常数， $a$ 是托卡马克的小半径。\n\n首先，我们计算 $q(r)$ 关于 $r$ 的导数：\n$$\n\\frac{dq}{dr} = \\frac{d}{dr} \\left[ q_0 + \\frac{\\alpha r^2}{a^2} + \\frac{\\beta r^4}{a^4} \\right]\n$$\n应用幂次法则求导，我们得到：\n$$\n\\frac{dq}{dr} = \\frac{\\alpha}{a^2} (2r) + \\frac{\\beta}{a^4} (4r^3) = \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4}\n$$\n现在，我们将这个导数和给定的 $q(r)$ 表达式代入磁剪切 $s(r)$ 的定义中：\n$$\ns(r) = \\frac{r}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}} \\left( \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4} \\right)\n$$\n如果需要，我们可以通过提取公因数来简化括号中的项，但为清晰起见，我们可以将前面的 $r$ 因子乘进去：\n$$\ns(r) = \\frac{\\frac{2\\alpha r^2}{a^2} + \\frac{4\\beta r^4}{a^4}}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}}\n$$\n这就是给定 $q$ 剖面下磁剪切参数 $s(r)$ 的最终闭式表达式。\n\n### 第2部分：与进动和新经典输运的物理联系\n\n磁剪切 $s$ 在修正捕获粒子的动力学以及由此产生的低碰撞（香蕉）区新经典输运中扮演着关键角色。这种联系可以通过从粒子漂移到输运通量的逻辑链来理解。\n\n1.  **导心漂移和捕获粒子轨道：** 在托卡马克中，磁场强度是不均匀的，近似地变化为 $B \\approx B_0(1 - \\epsilon \\cos\\theta)$，其中 $\\epsilon = r/R_0$ 是反环径比。$B$ 的空间梯度以及磁力线的曲率导致导心跨越磁力线漂移。主要的漂移是梯度B漂移和曲率漂移，它们主要在垂直方向。平行速度 $v_\\parallel$ 较低的粒子无法克服高场区的磁镜力，而在环的低场侧被“捕获”。它们快速的回旋运动、沿场线的较慢运动以及缓慢的垂直漂移相结合，导致它们的导心在极向截面上描绘出特征性的“香蕉”形状。\n\n2.  **有限轨道宽度和磁剪切：** 这些香蕉轨道的一个关键特征是其有限的径向宽度 $\\Delta r$。该宽度的一个标准估计是 $\\Delta r \\sim \\frac{v_\\parallel}{\\Omega_p} \\sim \\frac{q \\rho}{\\sqrt{\\epsilon}}$，其中 $\\Omega_p$ 是极向回旋频率，$\\rho$ 是拉莫尔半径。这意味着一个捕获粒子不会停留在单个磁面上，而是在宽度为 $\\Delta r$ 的径向区域内取样。安全因子 $q$ 是一个磁面量，$q=q(r)$。当粒子沿其香蕉轨道运动时，它在具有不同 $q$ 值的磁面之间移动。磁剪切 $s = \\frac{r}{q}\\frac{dq}{dr}$ 正是量化 $q$ 在此径向偏移过程中变化程度的参数。非零的剪切意味着在香蕉轨道的内侧和外侧分支上，场线螺距是不同的。\n\n3.  **环向进动的修正：** 捕获粒子的香蕉轨道不是静止的；它们会环向进动。这种进动 $\\Omega_\\phi = \\langle \\dot{\\phi} \\rangle$ 是环向角的弹跳平均变化率。它主要由形成香蕉轨道的相同垂直漂移驱动。然而，粒子经历的径向变化的场线螺距（由于非零剪切）为这种进动提供了额外的贡献。粒子有效地对其取样的磁面上的不同螺旋路径进行平均。这种轨道平均效应与磁剪切 $s$ 成正比，它修正了总的环向进动频率。对于具有正剪切（$s0$）的典型托卡马克剖面，这种效应会增加由 $\\nabla B$ 和曲率漂移引起的进动，从而提高总进动率。\n\n4.  **对新经典输运的影响：** 香蕉区的新经典输运源于粒子轨道与碰撞的相互作用。碰撞导致粒子在速度空间中散射，这可能将它们从一个香蕉轨道撞到另一个，从而产生净的径向步长。扩散系数的经典估计为 $D \\sim f_t (\\Delta r)^2 \\nu_{eff}$，其中 $f_t$ 是捕获粒子份额，$\\nu_{eff}$ 是有效碰撞频率。这给出了香蕉区的特征标度关系 $D \\propto \\epsilon^{-3/2}$。\n\n磁剪切通过修正碰撞作用所基于的底层轨道结构而进入。新经典输运系数（例如，扩散和热导率）的精确值由弹跳平均漂移动理学方程的解确定。在该方程中，出现了环向进动频率 $\\Omega_\\phi$（其包含依赖于剪切的项）。进动有助于在环向方向上平均掉香蕉轨道的径向位置。由剪切引起的 $\\Omega_\\phi$ 的变化会修正粒子极向和环向运动之间的相位关系，这反过来又改变了携带输运通量的微扰分布函数 $f_1$ 的结构。因此，尽管磁剪切通常不会改变新经典输运的基本参数标度关系（例如，对 $\\epsilon$ 的依赖性），但它会定量地修正输运矩阵中的数值系数，从而改变粒子和能量通量的大小。这在精确建模和预测托卡马克中的输运时是一个至关重要的效应。",
            "answer": "$$ \\boxed{ \\frac{\\frac{2\\alpha r^2}{a^2} + \\frac{4\\beta r^4}{a^4}}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}} } $$"
        },
        {
            "introduction": "本章的最终实践旨在搭建理论模型与实验数据分析之间的桥梁。在托卡马克中，径向电场 $E_r$ 是一个至关重要的参数，它通过双极性条件——即要求径向净电流为零——自洽地建立起来，并深刻影响着整体约束性能。这个计算练习  模拟了等离子体分析中的一项核心任务：您将利用依赖于不同碰撞机制的粒子通量模型来求解双极电场 $E_r$，并将其与通过离子力平衡方程推导出的电场进行比较，从而综合运用本章所学的关键概念。",
            "id": "4019216",
            "problem": "给定一个磁约束等离子体中若干半径处的离子和电子的径向粒子通量偏移量测量值以及局部等离子体参数。目标是推断出满足双极性条件的径向电场 $E_r$，并将其与使用测量的流速和压强梯度通过离子径向力平衡得到的 $E_r$ 进行比较。该问题的背景是跨越不同碰撞性分区的新经典输运理论，且必须以纯计算的方式解决。\n\n使用的基本和建模假设：\n- 从漂移动理学描述出发，假设径向粒子通量对径向电场呈线性响应。对每种粒子 $s \\in \\{i,e\\}$，径向粒子通量模型为 $ \\Gamma_s(E_r) = \\Gamma_s^0 + s_s \\mu_s n_s E_r $，其中 $ \\Gamma_s^0 $ 是测得的与 $E_r$ 无关的通量偏移量，$ s_s = \\mathrm{sign}(q_s) $，$ s_i = +1 $ 且 $ s_e = -1 $，$ \\mu_s $ 是新经典迁移率系数，$ n_s $ 是粒子密度，$ q_s $ 是粒子电荷。假设准中性条件 $ n_e = Z_i n_i $ 成立，其中 $ Z_i $ 为离子电荷数。\n- 通过要求净径向电流密度为零来施加双极性条件，$ J_r = e( Z_i \\Gamma_i - \\Gamma_e ) = 0 $，其中 $ e $ 是以国际单位制（SI）中的库仑为单位表示的基本电荷。\n- 使用以下依赖于不同分区的标度关系，从无量纲碰撞性 $ \\nu_* $ 确定 $ \\mu_s $，这是一个经过充分检验的输运系数新经典近似：\n  - 香蕉区 $ \\nu_*  10^{-2} $: $ \\mu_s = C_s / \\max(\\nu_*, \\nu_{\\min}) $，其中 $ \\nu_{\\min} $ 是一个小的下限，以避免除以零。\n  - 平台区 $ 10^{-2} \\le \\nu_* \\le 1 $: $ \\mu_s = C_s $。\n  - Pfirsch-Schlüter 区 $ \\nu_* > 1 $: $ \\mu_s = C_s \\nu_* $。\n  此处 $ C_s $ 是一个与粒子种类相关的系数，在国际单位制中单位为 $ \\mathrm{m^2/(V\\,s)} $。\n- 将双极性 $ E_r $ 与通过忽略惯性项并使用轴对称几何得到的离子径向力平衡 $ E_r $ 进行比较。这种简化将离子径向动量平衡方程简化为包含径向压强梯度和由测量的流速引起的横场漂移贡献的形式。最终的 $ E_r $ 以伏特/米（$ \\mathrm{V/m} $）表示。计算中不涉及角度。\n\n计算任务：\n- 对下面列出的每个测试案例，计算：\n  1. 在上述线性通量模型和依赖于碰撞性的 $ \\mu_s $ 条件下，通过求解 $ J_r = e( Z_i \\Gamma_i(E_r) - \\Gamma_e(E_r) ) = 0 $，计算双极性径向电场 $ E_r^{\\mathrm{amb}} $。\n  2. 使用轴对称、无惯性项的径向动量平衡方程，以及测量的离子流、磁场和径向压强梯度 $ \\partial p_i / \\partial r $，计算离子径向力平衡电场 $ E_r^{\\mathrm{fb}} $。使用国际单位制（SI）并将结果以 $ \\mathrm{V/m} $ 表示。\n  3. 计算绝对差值 $ \\Delta = \\left| E_r^{\\mathrm{amb}} - E_r^{\\mathrm{fb}} \\right| $，单位为 $ \\mathrm{V/m} $。\n- 如果双极性条件不允许唯一解（例如，如果线性解的分母为零而分子不为零），则对 $ E_r^{\\mathrm{amb}} $ 返回非数值（Not-a-Number）。\n\n物理单位：\n- 所有输入均以国际单位制（SI）单位提供，所有输出必须以伏特/米（$ \\mathrm{V/m} $）表示。返回四舍五入到六位小数的浮点数。不要使用任何百分号；任何分数量必须以小数形式表示。\n\n测试套件：\n- 使用以下四个案例。在每个案例中，常数为 $ e = 1.602 \\times 10^{-19} \\, \\mathrm{C} $，碰撞性下限为 $ \\nu_{\\min} = 10^{-6} $。\n\n1. 香蕉区（常规路径）：\n  - $ Z_i = 1 $, $ n_i = 1.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 2.0 \\times 10^{19} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 0.2 \\times 10^{19} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 5.0 \\times 10^{-3} $,\n  - $ \\partial p_i / \\partial r = -2.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.0 \\, \\mathrm{T} $, $ B_\\theta = 0.2 \\, \\mathrm{T} $, $ V_{\\phi i} = 1.0 \\times 10^{5} \\, \\mathrm{m/s} $, $ V_{\\theta i} = 2.0 \\times 10^{4} \\, \\mathrm{m/s} $.\n\n2. 平台区（边界覆盖）：\n  - $ Z_i = 1 $, $ n_i = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 1.5 \\times 10^{17} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 6.0 \\times 10^{16} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 1.0 \\times 10^{-1} $,\n  - $ \\partial p_i / \\partial r = -5.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.5 \\, \\mathrm{T} $, $ B_\\theta = 0.25 \\, \\mathrm{T} $, $ V_{\\phi i} = 5.0 \\times 10^{4} \\, \\mathrm{m/s} $, $ V_{\\theta i} = 1.0 \\times 10^{4} \\, \\mathrm{m/s} $.\n\n3. Pfirsch-Schlüter 区（带符号反转的边缘情况）：\n  - $ Z_i = 1 $, $ n_i = 5.0 \\times 10^{18} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 1.2 \\times 10^{17} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 3.0 \\times 10^{16} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 3.0 $,\n  - $ \\partial p_i / \\partial r = -1.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 1.5 \\, \\mathrm{T} $, $ B_\\theta = 0.15 \\, \\mathrm{T} $, $ V_{\\phi i} = 2.0 \\times 10^{5} \\, \\mathrm{m/s} $, $ V_{\\theta i} = -1.0 \\times 10^{4} \\, \\mathrm{m/s} $.\n\n4. 具有零双极性分子项的平台区边界（简并性检查）：\n  - $ Z_i = 2 $, $ n_i = 2.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 3.0 \\times 10^{18} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 6.0 \\times 10^{18} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 0.5 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 1.0 \\times 10^{-2} $,\n  - $ \\partial p_i / \\partial r = -1.0 \\times 10^{3} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.0 \\, \\mathrm{T} $, $ B_\\theta = 0.2 \\, \\mathrm{T} $, $ V_{\\phi i} = 0.0 \\, \\mathrm{m/s} $, $ V_{\\theta i} = 0.0 \\, \\mathrm{m/s} $.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表。每个测试案例贡献一个包含三个浮点数 $[E_r^{\\mathrm{amb}}, E_r^{\\mathrm{fb}}, \\Delta]$（四舍五入到六位小数）的子列表，外层列表按顺序包含这些子列表。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$。",
            "solution": "该问题要求计算和比较磁约束等离子体中的径向电场 $E_r$，该电场由两个不同的物理原理导出：双极性输运和离子径向力平衡。解决方案将首先从每个原理推导出电场的解析表达式，然后将这些公式应用于所提供的具体测试案例。所有计算均遵循国际单位制（SI）。\n\n### 1. 双极性径向电场 ($E_r^{\\mathrm{amb}}$)\n\n确定径向电场 $E_r^{\\mathrm{amb}}$ 的第一种方法是通过施加双极性条件。在稳态等离子体中，为防止电荷积累，净径向电流密度 $J_r$ 必须为零。径向电流由离子和电子承载。\n\n总径向电流密度由 $J_r = \\sum_s q_s \\Gamma_s$ 给出，其中 $q_s$ 是电荷，$\\Gamma_s$ 是粒子种类 $s$ 的径向粒子通量。对于离子-电子等离子体，离子电荷为 $q_i = Z_i e$，电子电荷为 $q_e = -e$，该式变为：\n$$ J_r = e(Z_i \\Gamma_i - \\Gamma_e) = 0 $$\n这简化为条件 $Z_i \\Gamma_i = \\Gamma_e$。\n\n问题为每种粒子 $s \\in \\{i, e\\}$ 的径向粒子通量提供了一个作为径向电场 $E_r$ 函数的线性模型：\n$$ \\Gamma_s(E_r) = \\Gamma_s^0 + s_s \\mu_s n_s E_r $$\n其中 $\\Gamma_s^0$ 是本征（非电场驱动）通量，$s_s = \\mathrm{sign}(q_s)$ 使得 $s_i = +1$ 且 $s_e = -1$，$\\mu_s$ 是新经典迁移率系数，$n_s$ 是粒子数密度。\n\n将此通量模型代入双极性条件 $Z_i \\Gamma_i(E_r) = \\Gamma_e(E_r)$：\n$$ Z_i (\\Gamma_i^0 + \\mu_i n_i E_r) = \\Gamma_e^0 - \\mu_e n_e E_r $$\n我们求解电场，记为 $E_r^{\\mathrm{amb}}$：\n$$ Z_i \\Gamma_i^0 + Z_i \\mu_i n_i E_r^{\\mathrm{amb}} = \\Gamma_e^0 - \\mu_e n_e E_r^{\\mathrm{amb}} $$\n$$ (Z_i \\mu_i n_i + \\mu_e n_e) E_r^{\\mathrm{amb}} = \\Gamma_e^0 - Z_i \\Gamma_i^0 $$\n使用准中性条件 $n_e = Z_i n_i$，我们可以简化乘以 $E_r^{\\mathrm{amb}}$ 的项：\n$$ (Z_i \\mu_i n_i + \\mu_e (Z_i n_i)) E_r^{\\mathrm{amb}} = Z_i n_i (\\mu_i + \\mu_e) E_r^{\\mathrm{amb}} = \\Gamma_e^0 - Z_i \\Gamma_i^0 $$\n最终，双极性径向电场的表达式为：\n$$ E_r^{\\mathrm{amb}} = \\frac{\\Gamma_e^0 - Z_i \\Gamma_i^0}{Z_i n_i (\\mu_i + \\mu_e)} $$\n只要分母不为零，$E_r^{\\mathrm{amb}}$ 就存在唯一解。如果分母为零而分子不为零，则该问题是病态的，不存在解。\n\n迁移率系数 $\\mu_s$ 依赖于无量纲碰撞性 $\\nu_*$，根据指定的新经典分区：\n- 香蕉区（$\\nu_*  10^{-2}$）：$\\mu_s = C_s / \\max(\\nu_*, \\nu_{\\min})$\n- 平台区（$10^{-2} \\le \\nu_* \\le 1$）：$\\mu_s = C_s$\n- Pfirsch-Schlüter 区（$\\nu_* > 1$）：$\\mu_s = C_s \\nu_*$\n其中 $C_s$ 是给定的与粒子种类相关的系数，$\\nu_{\\min} = 10^{-6}$ 是一个正则化参数，用于在低碰撞性极限下防止除以零。\n\n### 2. 离子力平衡径向电场 ($E_r^{\\mathrm{fb}}$)\n\n确定 $E_r$ 的第二种方法基于离子径向力平衡方程。在流体模型中，离子的动量方程为：\n$$ n_i m_i \\left( \\frac{\\partial \\mathbf{V}_i}{\\partial t} + (\\mathbf{V}_i \\cdot \\nabla) \\mathbf{V}_i \\right) = Z_i e n_i (\\mathbf{E} + \\mathbf{V}_i \\times \\mathbf{B}) - \\nabla p_i $$\n其中左侧为惯性项，右侧为洛伦兹力和压强梯度力。问题指定忽略惯性项（即左侧为零），对应于稳态动量平衡。\n$$ 0 = Z_i e n_i (\\mathbf{E} + \\mathbf{V}_i \\times \\mathbf{B}) - \\nabla p_i $$\n我们关心的是该方程的径向分量。在轴对称磁几何（如托卡马克）中，使用坐标 $(r, \\theta, \\phi)$ 分别表示半径、极向角和环向角，场可以写为 $\\mathbf{E} = E_r \\mathbf{\\hat{r}}$，$\\mathbf{V}_i = V_{\\theta i} \\mathbf{\\hat{\\theta}} + V_{\\phi i} \\mathbf{\\hat{\\phi}}$（在力平衡中忽略径向速度），以及 $\\mathbf{B} = B_\\theta \\mathbf{\\hat{\\theta}} + B_\\phi \\mathbf{\\hat{\\phi}}$。洛伦兹力项的径向分量为：\n$$ (\\mathbf{V}_i \\times \\mathbf{B})_r = V_{\\theta i} B_\\phi - V_{\\phi i} B_\\theta $$\n因此，动量方程的径向分量变为：\n$$ Z_i e n_i (E_r + V_{\\theta i} B_\\phi - V_{\\phi i} B_\\theta) = \\frac{\\partial p_i}{\\partial r} $$\n求解电场，记为 $E_r^{\\mathrm{fb}}$：\n$$ E_r^{\\mathrm{fb}} = \\frac{1}{Z_i e n_i} \\frac{\\partial p_i}{\\partial r} - V_{\\theta i} B_\\phi + V_{\\phi i} B_\\theta $$\n该方程表明，径向电场平衡了离子抗磁漂移（压强梯度项）和由离子流体穿越磁力线产生的洛伦兹力。右侧的所有量均在测试案例中提供。\n\n### 3. 计算步骤\n\n对于每个测试案例，执行以下步骤：\n1.  根据 $\\nu_*$ 的值确定碰撞性分区。\n2.  使用已确定分区的相应公式计算离子和电子的迁移率 $\\mu_i$ 和 $\\mu_e$。\n3.  使用其推导出的公式计算 $E_r^{\\mathrm{amb}}$。实现一个检查来处理分母 $Z_i n_i (\\mu_i + \\mu_e)$ 为零的情况，这将导致 $E_r^{\\mathrm{amb}}$ 为非数值（NaN）。\n4.  使用其推导出的公式以及提供的流、磁场和压强梯度数据计算 $E_r^{\\mathrm{fb}}$。基本电荷为 $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$。\n5.  计算绝对差值 $\\Delta = |E_r^{\\mathrm{amb}} - E_r^{\\mathrm{fb}}|$。\n6.  每个案例的最终结果 $[E_r^{\\mathrm{amb}}, E_r^{\\mathrm{fb}}, \\Delta]$ 四舍五入到六位小数。\n\n此过程应用于所有四个指定的测试案例，涵盖了不同的碰撞性分区和特殊条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ambipolar and force-balance radial electric fields for a set of plasma test cases.\n    \"\"\"\n\n    # Define physical constants and problem parameters\n    E_CHARGE = 1.602e-19  # Elementary charge in Coulombs\n    NU_MIN = 1.0e-6       # Lower bound for collisionality\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        # 1. Banana regime\n        {\n            \"Zi\": 1, \"ni\": 1.0e19, \"Gamma_i0\": 2.0e19, \"Gamma_e0\": 0.2e19,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 5.0e-3,\n            \"dpdr_i\": -2.0e4, \"B_phi\": 2.0, \"B_theta\": 0.2, \"V_phi_i\": 1.0e5, \"V_theta_i\": 2.0e4\n        },\n        # 2. Plateau regime\n        {\n            \"Zi\": 1, \"ni\": 5.0e19, \"Gamma_i0\": 1.5e17, \"Gamma_e0\": 6.0e16,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 1.0e-1,\n            \"dpdr_i\": -5.0e4, \"B_phi\": 2.5, \"B_theta\": 0.25, \"V_phi_i\": 5.0e4, \"V_theta_i\": 1.0e4\n        },\n        # 3. Pfirsch-Schlüter regime\n        {\n            \"Zi\": 1, \"ni\": 5.0e18, \"Gamma_i0\": 1.2e17, \"Gamma_e0\": 3.0e16,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 3.0,\n            \"dpdr_i\": -1.0e4, \"B_phi\": 1.5, \"B_theta\": 0.15, \"V_phi_i\": 2.0e5, \"V_theta_i\": -1.0e4\n        },\n        # 4. Plateau regime boundary (degenerate case)\n        {\n            \"Zi\": 2, \"ni\": 2.0e19, \"Gamma_i0\": 3.0e18, \"Gamma_e0\": 6.0e18,\n            \"Ci\": 0.5e-7, \"Ce\": 1.0e-7, \"nu_star\": 1.0e-2,\n            \"dpdr_i\": -1.0e3, \"B_phi\": 2.0, \"B_theta\": 0.2, \"V_phi_i\": 0.0, \"V_theta_i\": 0.0\n        }\n    ]\n\n    results = []\n\n    def calculate_mobility(C_s, nu_star):\n        \"\"\"Calculates the mobility coefficient based on collisionality.\"\"\"\n        if nu_star  1.0e-2:\n            # Banana regime\n            return C_s / max(nu_star, NU_MIN)\n        elif 1.0e-2 = nu_star = 1.0:\n            # Plateau regime\n            return C_s\n        else: # nu_star > 1.0\n            # Pfirsch-Schlüter regime\n            return C_s * nu_star\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        Zi, ni = case[\"Zi\"], case[\"ni\"]\n        Gamma_i0, Gamma_e0 = case[\"Gamma_i0\"], case[\"Gamma_e0\"]\n        Ci, Ce = case[\"Ci\"], case[\"Ce\"]\n        nu_star = case[\"nu_star\"]\n        dpdr_i = case[\"dpdr_i\"]\n        B_phi, B_theta = case[\"B_phi\"], case[\"B_theta\"]\n        V_phi_i, V_theta_i = case[\"V_phi_i\"], case[\"V_theta_i\"]\n\n        # --- 1. Compute Ambipolar Radial Electric Field (Er_amb) ---\n        mu_i = calculate_mobility(Ci, nu_star)\n        mu_e = calculate_mobility(Ce, nu_star)\n\n        numerator_amb = Gamma_e0 - Zi * Gamma_i0\n        denominator_amb = Zi * ni * (mu_i + mu_e)\n\n        if denominator_amb == 0:\n            # Handle ill-posed case (denominator is zero)\n            Er_amb = np.nan\n        else:\n            Er_amb = numerator_amb / denominator_amb\n\n        # --- 2. Compute Ion Force Balance Electric Field (Er_fb) ---\n        term_pressure = (1 / (Zi * E_CHARGE * ni)) * dpdr_i\n        term_flow = -V_theta_i * B_phi + V_phi_i * B_theta\n        Er_fb = term_pressure + term_flow\n        \n        # --- 3. Compute Absolute Difference ---\n        if np.isnan(Er_amb):\n            delta = np.nan\n        else:\n            delta = abs(Er_amb - Er_fb)\n\n        # Store rounded results\n        if not np.isnan(Er_amb):\n           results.append([round(Er_amb, 6), round(Er_fb, 6), round(delta, 6)])\n        else:\n           results.append(['nan', round(Er_fb, 6), 'nan']) # Not an expected case, but for correctness\n\n    # Format the final output string as specified\n    # Example format: [[-30000.0, -32484.394507, 2484.394507], [...]]\n    output_str = \"[\" + \",\".join(f\"[{r[0]},{r[1]},{r[2]}]\" for r in results) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}