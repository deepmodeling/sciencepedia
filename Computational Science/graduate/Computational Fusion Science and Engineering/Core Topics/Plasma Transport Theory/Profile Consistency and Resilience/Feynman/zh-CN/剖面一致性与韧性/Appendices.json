{
    "hands_on_practices": [
        {
            "introduction": "剖面一致性的基础在于磁流体动力学（MHD）平衡，即等离子体压力梯度 $ \\nabla p $ 必须由磁洛伦兹力 $ \\mathbf{J} \\times \\mathbf{B} $ 来平衡。本练习要求您从假设的压力和安全因子剖面的测量结果出发，来验证这一基本原理。通过从安全因子计算预期的压力梯度，并将其与测量的梯度进行比较，您将定量地评估该等离子体状态的一致性 。",
            "id": "4032341",
            "problem": "在一个轴对称、圆形截面、大环径比的托卡马克中，假设磁轴位于大半径 $R_{0} = 3.0\\,\\mathrm{m}$ 处，等离子体小半径为 $a = 0.5\\,\\mathrm{m}$。环向磁场在磁通量面上近似恒定，在 $R_{0}$ 处等于 $B_{\\phi} = 3.0\\,\\mathrm{T}$。磁流体动力学 (MHD) 平衡要求静力平衡方程 $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$ 成立。\n\n给定压强和安全因子剖面的测量值：\n- 压强为 $p(r) = p_{0}\\left(1 - \\left(\\frac{r}{a}\\right)^{2}\\right)^{2}$，中心压强 $p_{0} = \\frac{1}{8\\mu_{0}}\\,\\mathrm{Pa}$，其中 $\\mu_{0}$ 是真空磁导率。\n- 安全因子为 $q(r) = 1 + \\left(\\frac{r}{a}\\right)^{2}$。\n\n假设磁面为圆形同心圆，忽略 Shafranov 位移，并使用适用于大环径比的标准关系式。从第一性原理出发，根据这些测量值确定其隐含的环向电流密度 $J_{\\phi}(r)$，并从磁力密度构建预测的径向压强梯度。然后，在半径 $r^{\\star} = \\frac{a}{\\sqrt{3}}$ 处，评估一致性指数\n$$\\Gamma = \\frac{\\left| \\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}} - \\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}} \\right|}{\\sigma_{p'}(r^{\\star})},$$\n其中 $\\sigma_{p'}(r^{\\star})$ 是在 $r^{\\star}$ 处压强梯度的测量不确定度，由 $\\sigma_{p'}(r^{\\star}) = 0.05\\,\\left|\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})\\right|$ 给出。\n\n将最终的一致性指数 $\\Gamma$ 表示为一个纯数（无量纲）。将您的答案四舍五入到四位有效数字。",
            "solution": "首先根据既定标准对问题陈述进行验证。\n\n### 问题验证\n\n**第1步：提取给定条件**\n-   几何形状：轴对称、圆形截面、大环径比托卡马克。\n-   大半径：$R_{0} = 3.0\\,\\mathrm{m}$。\n-   小半径：$a = 0.5\\,\\mathrm{m}$。\n-   轴上环向磁场：$B_{\\phi} = 3.0\\,\\mathrm{T}$。\n-   MHD平衡方程：$\\nabla p = \\mathbf{J} \\times \\mathbf{B}$。\n-   测量的压强剖面：$p(r) = p_{0}\\left(1 - \\left(\\frac{r}{a}\\right)^{2}\\right)^{2}$。\n-   中心压强定义：$p_{0} = \\frac{1}{8\\mu_{0}}\\,\\mathrm{Pa}$。\n-   测量的安全因子剖面：$q(r) = 1 + \\left(\\frac{r}{a}\\right)^{2}$。\n-   假设：圆形同心磁面；大环径比；忽略 Shafranov 位移。\n-   评估半径：$r^{\\star} = \\frac{a}{\\sqrt{3}}$。\n-   一致性指数：$\\Gamma = \\frac{\\left| \\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}} - \\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}} \\right|}{\\sigma_{p'}(r^{\\star})}$。\n-   不确定度：$\\sigma_{p'}(r^{\\star}) = 0.05\\,\\left|\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})\\right|$。\n\n**第2步：使用提取的给定条件进行验证**\n-   **科学基础**：该问题设置在聚变等离子体中的磁流体动力学（MHD）平衡背景下，这是计算聚变科学的核心课题。所有使用的原理（$\\nabla p = \\mathbf{J} \\times \\mathbf{B}$、安全因子 $q$、安培定律）都是该领域的基础。\n-   **适定性**：该问题是适定的。它提供了两个独立的“测量值”（$p(r)$ 和 $q(r)$），并要求在指定的物理模型内评估它们之间的相互一致性。所有计算所定义的一致性指数 $\\Gamma$ 所需的信息都已提供。\n-   **客观性**：问题以客观、定量的术语陈述。\n-   **量纲一致性**：一个值得关注的点是定义 $p_{0} = \\frac{1}{8\\mu_{0}}\\,\\mathrm{Pa}$。物理量 $1/\\mu_0$ 的单位不是压强。然而，这个表达式必须被解释为定义 $p_0$ 在国际单位制（帕斯卡）中的数值，即 $p_0 = C\\,\\mathrm{Pa}$，其中 $C$ 是 $1/(8\\mu_0)$ 的数值。给定国际单位制中 $\\mu_0 = 4\\pi \\times 10^{-7}$，这得出 $p_0 \\approx 9.95 \\times 10^4\\,\\mathrm{Pa}$，这对于托卡马克核心来说是一个物理上合理的压强。虽然这种表示法非常规且量纲上不正确，但它明确地指定了一个值。在这种解释下，该问题并未失效。\n-   **其他标准**：该问题是可形式化的、完整的、可行的且非平凡的。\n\n**第3步：结论与行动**\n在将 $p_0$ 的定义解释为指定其帕斯卡数值的前提下，该问题被认为是**有效的**。我们可以继续进行求解。\n\n### 解题推导\n\n目标是计算在半径 $r^{\\star} = \\frac{a}{\\sqrt{3}}$ 处的一致性指数 $\\Gamma$。这需要计算“测量的”压强梯度 $\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}$ 和“预测的”压强梯度 $\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}$。\n\n**1. 测量的压强梯度**\n测量的压强剖面由 $p(r) = p_{0}\\left(1 - \\left(\\frac{r}{a}\\right)^{2}\\right)^{2}$ 给出。\n我们对小半径 $r$ 求导，以找到测量的压强梯度：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}} = \\frac{d}{dr} \\left[ p_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{2} \\right] = p_{0} \\cdot 2 \\left(1 - \\frac{r^{2}}{a^{2}}\\right) \\cdot \\left(-\\frac{2r}{a^{2}}\\right) = -\\frac{4 p_{0} r}{a^{2}} \\left(1 - \\frac{r^{2}}{a^{2}}\\right)\n$$\n在评估半径 $r^{\\star} = \\frac{a}{\\sqrt{3}}$ 处，我们有 $\\left(\\frac{r^{\\star}}{a}\\right)^2 = \\frac{1}{3}$。\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star}) = -\\frac{4 p_{0}}{a^{2}} \\left(\\frac{a}{\\sqrt{3}}\\right) \\left(1 - \\frac{1}{3}\\right) = -\\frac{4 p_{0}}{a\\sqrt{3}} \\left(\\frac{2}{3}\\right) = -\\frac{8 p_{0}}{3\\sqrt{3} a}\n$$\n使用给定的定义 $p_{0} = \\frac{1}{8\\mu_{0}}$，这可以简化为：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star}) = -\\frac{8}{3\\sqrt{3} a} \\left(\\frac{1}{8\\mu_{0}}\\right) = -\\frac{1}{3\\sqrt{3} a \\mu_{0}}\n$$\n\n**2. 预测的压强梯度**\n预测的压强梯度源于 MHD 力平衡方程 $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$。在大环径比、圆形磁通量面近似下，该方程的径向分量为：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}} = -J_{\\phi}(r) B_{\\theta}(r)\n$$\n其中 $J_{\\phi}$ 是环向电流密度，$B_{\\theta}$ 是极向磁场。我们必须从给定的安全因子剖面 $q(r)$ 推导出 $J_{\\phi}(r)$ 和 $B_{\\theta}(r)$ 的表达式。\n\n在大环径比极限下，安全因子由下式给出：\n$$\nq(r) = \\frac{r B_{\\phi}}{R_{0} B_{\\theta}(r)}\n$$\n使用提供的剖面 $q(r) = 1 + \\left(\\frac{r}{a}\\right)^{2}$，我们求解 $B_{\\theta}(r)$：\n$$\nB_{\\theta}(r) = \\frac{r B_{\\phi}}{R_{0} q(r)} = \\frac{r B_{\\phi}}{R_{0} \\left(1 + \\frac{r^{2}}{a^{2}}\\right)}\n$$\n环向电流密度 $J_{\\phi}(r)$ 可从安培定律的环向分量 $\\mu_{0}\\mathbf{J} = \\nabla \\times \\mathbf{B}$ 得到。对于轴对称系统，在柱坐标系中，这表示为：\n$$\n\\mu_{0} J_{\\phi}(r) = \\frac{1}{r} \\frac{d}{dr} (r B_{\\theta}(r))\n$$\n我们计算导数项：\n$$\n\\frac{d}{dr} (r B_{\\theta}(r)) = \\frac{d}{dr} \\left[ \\frac{r^{2} B_{\\phi}}{R_{0} \\left(1 + \\frac{r^{2}}{a^{2}}\\right)} \\right] = \\frac{B_{\\phi}}{R_{0}} \\frac{2r\\left(1 + \\frac{r^{2}}{a^{2}}\\right) - r^{2}\\left(\\frac{2r}{a^{2}}\\right)}{\\left(1 + \\frac{r^{2}}{a^{2}}\\right)^{2}} = \\frac{B_{\\phi}}{R_{0}} \\frac{2r}{\\left(1 + \\frac{r^{2}}{a^{2}}\\right)^{2}}\n$$\n因此，环向电流密度为：\n$$\nJ_{\\phi}(r) = \\frac{1}{\\mu_{0} r} \\frac{2r B_{\\phi}}{R_{0} \\left(1 + \\frac{r^{2}}{a^{2}}\\right)^{2}} = \\frac{2 B_{\\phi}}{\\mu_{0} R_{0} q(r)^{2}}\n$$\n现在我们构建预测的压强梯度：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}} = -J_{\\phi}(r) B_{\\theta}(r) = -\\left(\\frac{2 B_{\\phi}}{\\mu_{0} R_{0} q(r)^{2}}\\right) \\left(\\frac{r B_{\\phi}}{R_{0} q(r)}\\right) = -\\frac{2r B_{\\phi}^{2}}{\\mu_{0} R_{0}^{2} q(r)^{3}}\n$$\n代入 $q(r) = 1 + \\frac{r^{2}}{a^{2}}$：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}} = -\\frac{2r B_{\\phi}^{2}}{\\mu_{0} R_{0}^{2} \\left(1 + \\frac{r^{2}}{a^{2}}\\right)^{3}}\n$$\n在评估半径 $r^{\\star} = \\frac{a}{\\sqrt{3}}$ 处：\n$$\n\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}(r^{\\star}) = -\\frac{2\\left(\\frac{a}{\\sqrt{3}}\\right) B_{\\phi}^{2}}{\\mu_{0} R_{0}^{2} \\left(1 + \\frac{1}{3}\\right)^{3}} = -\\frac{2a B_{\\phi}^{2}}{\\sqrt{3} \\mu_{0} R_{0}^{2} \\left(\\frac{4}{3}\\right)^{3}} = -\\frac{2a B_{\\phi}^{2}}{\\sqrt{3} \\mu_{0} R_{0}^{2} \\left(\\frac{64}{27}\\right)} = -\\frac{27 a B_{\\phi}^{2}}{32 \\sqrt{3} \\mu_{0} R_{0}^{2}}\n$$\n\n**3. 一致性指数 $\\Gamma$ 的计算**\n指数 $\\Gamma$ 定义为：\n$$\n\\Gamma = \\frac{\\left| \\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star}) - \\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}(r^{\\star}) \\right|}{\\sigma_{p'}(r^{\\star})}\n$$\n由于 $\\sigma_{p'}(r^{\\star}) = 0.05\\,\\left|\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})\\right|$，上式变为：\n$$\n\\Gamma = \\frac{\\left| \\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star}) - \\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}(r^{\\star}) \\right|}{0.05\\,\\left|\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})\\right|} = \\frac{1}{0.05} \\left| 1 - \\frac{\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}(r^{\\star})}{\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})} \\right|\n$$\n让我们计算梯度的比率：\n$$\n\\frac{\\left.\\frac{dp}{dr}\\right|_{\\mathrm{pred}}(r^{\\star})}{\\left.\\frac{dp}{dr}\\right|_{\\mathrm{meas}}(r^{\\star})} = \\frac{-\\frac{27 a B_{\\phi}^{2}}{32 \\sqrt{3} \\mu_{0} R_{0}^{2}}}{-\\frac{1}{3\\sqrt{3} a \\mu_{0}}} = \\left(\\frac{27 a B_{\\phi}^{2}}{32 \\sqrt{3} \\mu_{0} R_{0}^{2}}\\right) \\left(3\\sqrt{3} a \\mu_{0}\\right) = \\frac{81 a^{2} B_{\\phi}^{2}}{32 R_{0}^{2}}\n$$\n现在，将此比率代入 $\\Gamma$ 的表达式中：\n$$\n\\Gamma = 20 \\left| 1 - \\frac{81 a^{2} B_{\\phi}^{2}}{32 R_{0}^{2}} \\right|\n$$\n最后，我们代入数值：$a = 0.5\\,\\mathrm{m}$，$R_0 = 3.0\\,\\mathrm{m}$，$B_{\\phi} = 3.0\\,\\mathrm{T}$。\n$$\n\\Gamma = 20 \\left| 1 - \\frac{81 \\cdot (0.5)^{2} \\cdot (3.0)^{2}}{32 \\cdot (3.0)^{2}} \\right| = 20 \\left| 1 - \\frac{81 \\cdot 0.25}{32} \\right|\n$$\n$$\n\\Gamma = 20 \\left| 1 - \\frac{20.25}{32} \\right| = 20 \\left| 1 - 0.6328125 \\right|\n$$\n$$\n\\Gamma = 20 |0.3671875| = 7.34375\n$$\n四舍五入到四位有效数字，结果是 $7.344$。这个值显著不为零，表明在所使用的理想MHD模型假设下，测量的压强剖面和安全因子剖面之间存在显著的不一致性。",
            "answer": "$$\n\\boxed{7.344}\n$$"
        },
        {
            "introduction": "除了静态力平衡，剖面一致性还延伸到能量输运的动态平衡。在稳态等离子体中，温度剖面由加热源和通过输运过程的能量损失之间的平衡决定。本练习将指导您从给定的温度和加热剖面中推断出关键的输运系数——电子热导率 $ \\chi_e $，并将其与理论预测进行比较，这是约束研究中的一项常见任务 。",
            "id": "4032329",
            "problem": "考虑一个轴对称托卡马克等离子体，其小半径 $a = 0.5\\,\\mathrm{m}$，近似为一个圆柱体。在该等离子体中，电子热输运以传导为主，电子密度 $n_e$ 径向均匀。测得的电子温度分布为\n$$\nT_e(r) = T_{e,\\mathrm{edge}} + T_0\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right),\n$$\n其中 $T_{e,\\mathrm{edge}} = 1\\,\\mathrm{keV}$，$T_0 = 4\\,\\mathrm{keV}$。电子回旋共振加热 (ECRH) 沉积的功率具有一个磁通面平均的体分布\n$$\nP_{\\mathrm{ECRH}}(r) = S_0 \\exp\\!\\left(-\\left(\\frac{r}{w}\\right)^2\\right),\n$$\n其中 $S_0 = 2.0 \\times 10^5\\,\\mathrm{W/m^3}$，$w = 0.2\\,\\mathrm{m}$。假设处于稳态，对流和辐射可忽略不计，且没有其他电子能量的源或汇。利用能量守恒和传导热通量的定义，推导隐含的电子热导率 $\\chi_e(r)$。\n\n取 $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，磁场 $B = 3.0\\,\\mathrm{T}$，离子质量 $m_i = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$ (氘)，基本电荷 $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$。使用基于离子声尺度的标准 gyro-Bohm 估算来计算电子热导率，其中离子声速为 $c_s = \\sqrt{T_e(r)/m_i}$，离子回旋频率为 $\\Omega_i = e B / m_i$，离子声拉莫尔半径为 $\\rho_s = c_s/\\Omega_i$，定义\n$$\n\\chi_{\\mathrm{gB}}(r) = \\frac{\\rho_s(r)^2\\,c_s(r)}{a}.\n$$\n计算在 $r = a/2$ 处的 $\\chi_e(r)$ 和 $\\chi_{\\mathrm{gB}}(r)$，并计算无量纲比值\n$$\n\\mathcal{R} = \\frac{\\chi_e(a/2)}{\\chi_{\\mathrm{gB}}(a/2)}.\n$$\n将最终比值 $\\mathcal{R}$ 表示为四舍五入到三位有效数字的小数。最终比值不应包含单位。",
            "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当且客观。\n\n**1. 提取已知条件**\n- 圆柱小半径：$a = 0.5\\,\\mathrm{m}$\n- 电子密度（均匀）：$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n- 电子温度分布：$T_e(r) = T_{e,\\mathrm{edge}} + T_0\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)$\n- 边界温度：$T_{e,\\mathrm{edge}} = 1\\,\\mathrm{keV}$\n- 温度参数：$T_0 = 4\\,\\mathrm{keV}$\n- ECRH 功率分布：$P_{\\mathrm{ECRH}}(r) = S_0 \\exp\\left(-\\left(\\frac{r}{w}\\right)^2\\right)$\n- ECRH 功率幅度：$S_0 = 2.0 \\times 10^5\\,\\mathrm{W/m^3}$\n- ECRH 沉积宽度：$w = 0.2\\,\\mathrm{m}$\n- 假设：稳态，电子热输运以传导为主，对流和辐射可忽略，没有其他能量源/汇。\n- 磁场：$B = 3.0\\,\\mathrm{T}$\n- 离子质量（氘）：$m_i = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$\n- 基本电荷：$e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- Gyro-Bohm 电导率定义：$\\chi_{\\mathrm{gB}}(r) = \\frac{\\rho_s(r)^2\\,c_s(r)}{a}$，其中 $c_s = \\sqrt{T_e(r)/m_i}$ 且 $\\rho_s = c_s/\\Omega_i$，而 $\\Omega_i = e B / m_i$。\n\n**2. 验证**\n该问题是等离子体输运分析中的一个标准练习，这是计算聚变科学的核心课题。它使用了基本原理（能量守恒）、标准定义（传导热通量）和已建立的理论模型（gyro-Bohm 标度律）。参数与典型的托卡马克运行参数一致。该问题是自洽的、无歧义的且可解的。\n**结论：**该问题有效。\n\n**3. 推导隐含的电子热导率 $\\chi_e(r)$**\n在稳态和柱坐标系下，只考虑传导和源项的电子能量守恒方程为：\n$$\n\\frac{1}{r} \\frac{d}{dr} \\left( r q_e(r) \\right) = P_{\\mathrm{ECRH}}(r)\n$$\n其中 $q_e(r)$ 是径向电子热通量。将此方程从磁轴（$r=0$）积分到半径 $r$，得到通过半径为 $r$ 的圆柱面的总热通量：\n$$\nr q_e(r) = \\int_0^r P_{\\mathrm{ECRH}}(r') r' dr'\n$$\n代入给定的 $P_{\\mathrm{ECRH}}(r)$ 分布：\n$$\nr q_e(r) = \\int_0^r S_0 \\exp\\left(-\\left(\\frac{r'}{w}\\right)^2\\right) r' dr'\n$$\n该积分可通过换元法求解，令 $u = (r'/w)^2$，则 $du = 2r'/w^2 dr'$，或 $r'dr' = \\frac{w^2}{2} du$。\n$$\nr q_e(r) = S_0 \\frac{w^2}{2} \\int_0^{(r/w)^2} \\exp(-u) du = S_0 \\frac{w^2}{2} \\left[ -\\exp(-u) \\right]_0^{(r/w)^2} = \\frac{S_0 w^2}{2} \\left(1 - \\exp\\left(-\\left(\\frac{r}{w}\\right)^2\\right)\\right)\n$$\n因此，热通量为：\n$$\nq_e(r) = \\frac{S_0 w^2}{2r} \\left(1 - \\exp\\left(-\\left(\\frac{r}{w}\\right)^2\\right)\\right)\n$$\n传导热通量由等离子体的傅里叶定律定义：\n$$\nq_e(r) = -n_e \\chi_e(r) \\frac{dT_e}{dr}\n$$\n通过对给定的 $T_e(r)$ 分布求导，可得温度梯度：\n$$\n\\frac{dT_e}{dr} = \\frac{d}{dr} \\left[ T_{e,\\mathrm{edge}} + T_0\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right) \\right] = -\\frac{2T_0r}{a^2}\n$$\n求解 $\\chi_e(r)$：\n$$\n\\chi_e(r) = -\\frac{q_e(r)}{n_e \\frac{dT_e}{dr}} = -\\frac{\\frac{S_0 w^2}{2r} \\left(1 - \\exp\\left(-\\left(\\frac{r}{w}\\right)^2\\right)\\right)}{n_e \\left(-\\frac{2T_0r}{a^2}\\right)}\n$$\n简化表达式，我们得到隐含的电子热导率：\n$$\n\\chi_e(r) = \\frac{S_0 w^2 a^2}{4 n_e T_0} \\frac{1 - \\exp\\left(-\\left(\\frac{r}{w}\\right)^2\\right)}{r^2}\n$$\n\n**4. 计算 $\\chi_e(a/2)$**\n我们在 $r=a/2$ 处计算 $\\chi_e(r)$：\n$$\n\\chi_e(a/2) = \\frac{S_0 w^2 a^2}{4 n_e T_0} \\frac{1 - \\exp\\left(-\\left(\\frac{a/2}{w}\\right)^2\\right)}{(a/2)^2} = \\frac{S_0 w^2 a^2}{4 n_e T_0} \\frac{1 - \\exp\\left(-\\frac{a^2}{4w^2}\\right)}{a^2/4}\n$$\n$$\n\\chi_e(a/2) = \\frac{S_0 w^2}{n_e T_0} \\left(1 - \\exp\\left(-\\frac{a^2}{4w^2}\\right)\\right)\n$$\n计算中必须使用国际单位制（SI）。温度必须从 $\\mathrm{keV}$ 转换为焦耳。\n$1\\,\\mathrm{keV} = 1000 \\times e \\approx 1.602 \\times 10^{-16}\\,\\mathrm{J}$。\n$T_0 = 4\\,\\mathrm{keV} \\approx 6.408 \\times 10^{-16}\\,\\mathrm{J}$。\n各值为：$S_0 = 2.0 \\times 10^5\\,\\mathrm{W/m^3}$，$w = 0.2\\,\\mathrm{m}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$a = 0.5\\,\\mathrm{m}$。\n指数的参数为 $\\frac{a^2}{4w^2} = \\frac{(0.5)^2}{4(0.2)^2} = \\frac{0.25}{0.16} = 1.5625$。\n$$\n\\chi_e(a/2) = \\frac{(2.0 \\times 10^5\\,\\mathrm{W/m^3}) (0.2\\,\\mathrm{m})^2}{(5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}) (6.408 \\times 10^{-16}\\,\\mathrm{J})} \\left(1 - \\exp(-1.5625)\\right)\n$$\n$$\n\\chi_e(a/2) \\approx \\frac{8000}{3.204 \\times 10^4} (1 - 0.20961) \\approx 0.24969 \\times 0.79039 \\approx 0.19735\\,\\mathrm{m^2/s}\n$$\n\n**5. 推导和计算 Gyro-Bohm 电导率 $\\chi_{\\mathrm{gB}}(a/2)$**\nGyro-Bohm 电导率定义为 $\\chi_{\\mathrm{gB}}(r) = \\frac{\\rho_s(r)^2\\,c_s(r)}{a}$。使用 $c_s(r)$ 和 $\\rho_s(r)$ 的定义：\n$$\n\\chi_{\\mathrm{gB}}(r) = \\frac{1}{a} \\left(\\frac{c_s(r)}{\\Omega_i}\\right)^2 c_s(r) = \\frac{c_s(r)^3}{a \\Omega_i^2}\n$$\n代入 $c_s = \\sqrt{T_e/m_i}$ 和 $\\Omega_i = eB/m_i$：\n$$\n\\chi_{\\mathrm{gB}}(r) = \\frac{(T_e(r)/m_i)^{3/2}}{a (eB/m_i)^2} = \\frac{T_e(r)^{3/2} m_i^{-3/2}}{a e^2 B^2 m_i^{-2}} = \\frac{m_i^{1/2} T_e(r)^{3/2}}{a e^2 B^2}\n$$\n首先，我们计算在 $r=a/2$ 处的电子温度：\n$$\nT_e(a/2) = T_{e,\\mathrm{edge}} + T_0\\left(1 - \\left(\\frac{a/2}{a}\\right)^2\\right) = T_{e,\\mathrm{edge}} + T_0(1 - 1/4) = T_{e,\\mathrm{edge}} + \\frac{3}{4}T_0\n$$\n$$\nT_e(a/2) = 1\\,\\mathrm{keV} + \\frac{3}{4}(4\\,\\mathrm{keV}) = 1\\,\\mathrm{keV} + 3\\,\\mathrm{keV} = 4\\,\\mathrm{keV}\n$$\n以焦耳为单位，$T_e(a/2) = 4\\,\\mathrm{keV} \\approx 6.408 \\times 10^{-16}\\,\\mathrm{J}$。\n现在我们将数值代入 $\\chi_{\\mathrm{gB}}(a/2)$ 的表达式中：\n$$\n\\chi_{\\mathrm{gB}}(a/2) = \\frac{(3.345 \\times 10^{-27}\\,\\mathrm{kg})^{1/2} (6.408 \\times 10^{-16}\\,\\mathrm{J})^{3/2}}{(0.5\\,\\mathrm{m}) (1.602 \\times 10^{-19}\\,\\mathrm{C})^2 (3.0\\,\\mathrm{T})^2}\n$$\n$$\n\\chi_{\\mathrm{gB}}(a/2) \\approx \\frac{(5.7836 \\times 10^{-14}) (1.6205 \\times 10^{-23})}{0.5 \\times (2.5664 \\times 10^{-38}) \\times 9.0} \\approx \\frac{9.372 \\times 10^{-37}}{1.1549 \\times 10^{-37}} \\approx 8.1152\\,\\mathrm{m^2/s}\n$$\n\n**6. 计算比值 $\\mathcal{R}$**\n无量纲比值 $\\mathcal{R}$ 是两个电导率之商：\n$$\n\\mathcal{R} = \\frac{\\chi_e(a/2)}{\\chi_{\\mathrm{gB}}(a/2)} \\approx \\frac{0.19735\\,\\mathrm{m^2/s}}{8.1152\\,\\mathrm{m^2/s}} \\approx 0.024318\n$$\n四舍五入到三位有效数字，我们得到 $\\mathcal{R} \\approx 0.0243$。",
            "answer": "$$\n\\boxed{0.0243}\n$$"
        },
        {
            "introduction": "从分析转向主动工程控制，本练习将探讨如何对等离子体剖面进行计算建模和控制。通过实现一个数值模型，您将模拟电子回旋电流驱动（ECCD）对等离子体安全因子剖面 $ q(r) $ 的影响。这个练习展示了增强剖面“韧性”的一个关键方面：主动剪裁电流分布以避免磁流体动力学不稳定性，从而实现更稳健的等离子体运行。通过此练习，您可以理解如何通过修改电流分布来改善剖面一致性，从而增强对磁流体力学不稳定性的抵抗力 。",
            "id": "4032300",
            "problem": "一个大环径比的圆形托卡马克模型，其小半径为 $a$，大半径为 $R$，环向磁场为 $B_T$，初始安全因子分布 $q_0(r)$ 随半径 $r \\in [0,a]$ 单调变化。使用射频 (RF) 天线进行电子回旋电流驱动 (ECCD)，射线追踪的输出提供了极向和环向平均的吸收功率密度分布 $P_{\\mathrm{abs}}(r)$ 以及沿磁力线的无量纲平行折射率 $n_{\\parallel}(r)$。目标是计算可实现的驱动电流密度分布 $J_{\\mathrm{CD}}(r)$，并评估最小安全因子 $q_{\\min}$ 是否能被提升至 $1.5$ 以上，从而改善剖面一致性并增强对磁流体力学不稳定性的抵抗力。\n\n从基本定律和核心定义出发：\n- 在大环径比的圆形托卡马克中，安全因子定义为 $q(r) = \\dfrac{r B_T}{R B_P(r)}$，其中 $B_P(r)$ 是极向磁场。\n- 根据安培定律，$B_P(r) = \\dfrac{\\mu_0 I_{\\mathrm{enc}}(r)}{2 \\pi r}$，其中 $\\mu_0$ 是真空磁导率，$I_{\\mathrm{enc}}(r)$ 是半径 $r$ 范围内包围的环向电流。\n- 吸收的射频波将平行磁场的动量传递给电子。在稳态下，通过平衡射频动量源与碰撞阻力，可以得到局域驱动的平行流动 $u_{\\parallel}(r)$，其关系式为 $m_e n_e(r) \\nu_{e}(r) u_{\\parallel}(r) = \\left(\\dfrac{k_{\\parallel}}{\\omega}\\right) P_{\\mathrm{abs}}(r)$，其中 $m_e$ 是电子质量，$n_e(r)$ 是电子密度，$\\nu_e(r)$ 是电子碰撞频率，$k_{\\parallel}$ 是平行波数，$\\omega$ 是射频角频率。使用 $k_{\\parallel}/\\omega = n_{\\parallel}/c$（其中 $c$ 为光速），驱动电流密度变为 $J_{\\mathrm{CD}}(r) = e n_e(r) u_{\\parallel}(r) = \\dfrac{e\\, n_{\\parallel}(r)\\, P_{\\mathrm{abs}}(r)}{m_e c\\, \\nu_e(r)}$，其中 $e$ 是元电荷。\n- 电子-离子碰撞频率可由一个经过充分检验的公式近似计算：$\\nu_e(r) = 2.91 \\times 10^{-6}\\, Z_{\\mathrm{eff}}\\, \\dfrac{n_e^{(\\mathrm{cm}^{-3})}(r)\\, \\ln \\Lambda}{T_e(r)^{3/2}}$，单位为 $\\mathrm{s}^{-1}$，其中 $n_e^{(\\mathrm{cm}^{-3})}$ 是以 $\\mathrm{cm}^{-3}$ 为单位的密度，$T_e(r)$ 是以 $\\mathrm{eV}$ 为单位的电子温度，$Z_{\\mathrm{eff}}$ 是有效离子电荷数，$\\ln \\Lambda$ 是库仑对数。\n\n需要执行的算法任务：\n1. 将半径在 $[0,a]$ 范围内离散化为 $N$ 个点。\n2. 根据给定的 $q_0(r)$，使用 $I_{\\mathrm{enc},0}(r) = \\dfrac{2 \\pi r^2 B_T}{\\mu_0 R\\, q_0(r)}$ 计算初始包围电流 $I_{\\mathrm{enc},0}(r)$。\n3. 根据射线追踪输出的 $P_{\\mathrm{abs}}(r)$ 和 $n_{\\parallel}(r)$ 以及局域等离子体参数 $n_e(r)$ 和 $T_e(r)$，通过 $J_{\\mathrm{CD}}(r) = \\dfrac{e\\, n_{\\parallel}(r)\\, P_{\\mathrm{abs}}(r)}{m_e c\\, \\nu_e(r)}$ 计算驱动电流密度 $J_{\\mathrm{CD}}(r)$。\n4. 积分 $J_{\\mathrm{CD}}(r)$ 以获得增加的包围电流 $\\Delta I_{\\mathrm{enc}}(r) = \\int_0^r J_{\\mathrm{CD}}(r')\\, 2 \\pi r' \\, dr'$。\n5. 构建修正后的包围电流 $I_{\\mathrm{enc}}(r) = I_{\\mathrm{enc},0}(r) + \\Delta I_{\\mathrm{enc}}(r)$。\n6. 对于 $r > 0$，计算修正后的安全因子 $q(r) = \\dfrac{2 \\pi r^2 B_T}{\\mu_0 R\\, I_{\\mathrm{enc}}(r)}$，并在离散化网格上确定 $q_{\\min}$。\n7. 评估 $q_{\\min} > 1.5$ 是否成立。\n\n除非另有说明，所有物理量都必须在国际单位制（SI）中处理。安全因子 $q(r)$ 和 $q_{\\min}$ 是无量纲的。碰撞频率 $\\nu_e(r)$ 必须按照上述规定，使用单位为 $\\mathrm{cm}^{-3}$ 的 $n_e$ 和单位为 $\\mathrm{eV}$ 的 $T_e$ 进行计算。角度不直接使用；无量纲的平行折射率 $n_{\\parallel}(r)$ 编码了发射几何以及沿磁场的射线轨迹投影。\n\n使用以下测试套件，其中每个测试用例提供了 $(R, a, B_T)$ 的参数，一个通过 $(q_{\\mathrm{axis}}, q_{\\mathrm{edge}}, \\lambda)$ 定义的初始安全因子分布 $q_0(r) = q_{\\mathrm{axis}} + (q_{\\mathrm{edge}} - q_{\\mathrm{axis}}) \\left(\\dfrac{r}{a}\\right)^{\\lambda}$，模拟为 $n_e(r) = n_{e0} - (n_{e0} - n_{e\\mathrm{edge}}) \\left(\\dfrac{r}{a}\\right)^{\\alpha_n}$ 和 $T_e(r) = T_{e0} - (T_{e0} - T_{e\\mathrm{edge}}) \\left(\\dfrac{r}{a}\\right)^{\\alpha_T}$ 的等离子体分布 $n_e(r)$ 和 $T_e(r)$，以及模拟为 $P_{\\mathrm{abs}}(r) = P_0 \\exp\\!\\left(-\\dfrac{(r - r_0)^2}{2 w^2}\\right)$ 的射线追踪输出，其中 $n_{\\parallel}(r) = n_{\\parallel,0}$ 为常数。有效离子电荷数和库仑对数固定为 $Z_{\\mathrm{eff}} = 1.5$ 和 $\\ln \\Lambda = 17$。\n\n测试用例：\n- 用例 A (反向电流，近轴，中等碰撞性):\n  - $R = 3.0\\, \\mathrm{m}$, $a = 1.0\\, \\mathrm{m}$, $B_T = 3.0\\, \\mathrm{T}$.\n  - $q_{\\mathrm{axis}} = 1.3$, $q_{\\mathrm{edge}} = 3.5$, $\\lambda = 2.0$.\n  - $n_{e0} = 8.0 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $n_{e\\mathrm{edge}} = 3.0 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $\\alpha_n = 2.0$.\n  - $T_{e0} = 6000\\, \\mathrm{eV}$, $T_{e\\mathrm{edge}} = 1500\\, \\mathrm{eV}$, $\\alpha_T = 2.0$.\n  - $P_0 = 5.0 \\times 10^{4}\\, \\mathrm{W}/\\mathrm{m}^3$, $r_0 = 0.2\\, a$, $w = 0.12\\, a$, $n_{\\parallel,0} = -1.4$.\n- 用例 B (同向电流，离轴，中等功率):\n  - $R = 3.0\\, \\mathrm{m}$, $a = 1.0\\, \\mathrm{m}$, $B_T = 3.0\\, \\mathrm{T}$.\n  - $q_{\\mathrm{axis}} = 1.3$, $q_{\\mathrm{edge}} = 3.5$, $\\lambda = 2.0$.\n  - $n_{e0} = 7.5 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $n_{e\\mathrm{edge}} = 3.0 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $\\alpha_n = 2.0$.\n  - $T_{e0} = 5500\\, \\mathrm{eV}$, $T_{e\\mathrm{edge}} = 1500\\, \\mathrm{eV}$, $\\alpha_T = 2.0$.\n  - $P_0 = 6.0 \\times 10^{4}\\, \\mathrm{W}/\\mathrm{m}^3$, $r_0 = 0.5\\, a$, $w = 0.15\\, a$, $n_{\\parallel,0} = 1.4$.\n- 用例 C (弱反向电流，低功率):\n  - $R = 3.0\\, \\mathrm{m}$, $a = 1.0\\, \\mathrm{m}$, $B_T = 3.0\\, \\mathrm{T}$.\n  - $q_{\\mathrm{axis}} = 1.3$, $q_{\\mathrm{edge}} = 3.5$, $\\lambda = 2.0$.\n  - $n_{e0} = 8.0 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $n_{e\\mathrm{edge}} = 3.0 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $\\alpha_n = 2.0$.\n  - $T_{e0} = 6000\\, \\mathrm{eV}$, $T_{e\\mathrm{edge}} = 1500\\, \\mathrm{eV}$, $\\alpha_T = 2.0$.\n  - $P_0 = 2.0 \\times 10^{4}\\, \\mathrm{W}/\\mathrm{m}^3$, $r_0 = 0.3\\, a$, $w = 0.12\\, a$, $n_{\\parallel,0} = -0.8$.\n- 用例 D (反向电流，近轴，因低温导致的高碰撞性):\n  - $R = 3.0\\, \\mathrm{m}$, $a = 1.0\\, \\mathrm{m}$, $B_T = 3.0\\, \\mathrm{T}$.\n  - $q_{\\mathrm{axis}} = 1.3$, $q_{\\mathrm{edge}} = 3.5$, $\\lambda = 2.0$.\n  - $n_{e0} = 8.5 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $n_{e\\mathrm{edge}} = 3.5 \\times 10^{19}\\, \\mathrm{m}^{-3}$, $\\alpha_n = 2.0$.\n  - $T_{e0} = 2000\\, \\mathrm{eV}$, $T_{e\\mathrm{edge}} = 800\\, \\mathrm{eV}$, $\\alpha_T = 2.0$.\n  - $P_0 = 5.0 \\times 10^{4}\\, \\mathrm{W}/\\mathrm{m}^3$, $r_0 = 0.2\\, a$, $w = 0.12\\, a$, $n_{\\parallel,0} = -1.2$.\n\n您的程序必须：\n- 针对每个测试用例，实现所述的基于物理的算法，以计算 $J_{\\mathrm{CD}}(r)$ 和修正后的 $q(r)$。\n- 对于每个用例，确定在 $r \\in (0,a]$ 范围内的修正后安全因子最小值 $q_{\\min}$。\n- 输出一行包含结果的列表的列表，其中每个内部列表包含两个元素：$q_{\\min}$ 的值（无量纲），四舍五入到三位小数，以及一个布尔值，表示 $q_{\\min} > 1.5$ 是否成立（即是否已提升至 $1.5$ 以上）。例如，输出格式必须为 $[[q_{\\min}^{(A)}, \\mathrm{flag}^{(A)}],[q_{\\min}^{(B)}, \\mathrm{flag}^{(B)}],\\dots]$。\n\n不允许外部输入。所有常数和参数必须在程序内部定义。使用 $N = 400$ 个径向点。确保所有计算均使用 SI 单位，但碰撞频率公式除外，该公式要求 $n_e$ 单位为 $\\mathrm{cm}^{-3}$，$T_e$ 单位为 $\\mathrm{eV}$。最终输出必须严格按照指定的单行格式打印。",
            "solution": "用户提供了一个定义明确的计算等离子体物理学问题。任务是计算托卡马克等离子体的安全因子分布 $q(r)$ 因电子回旋电流驱动 (ECCD) 而发生的变化，并确定最小安全因子 $q_{\\min}$ 是否能被提升到 $1.5$ 的稳定性阈值之上。该问题具有科学依据，内容自洽，且算法明确。我将继续提供完整的解决方案。\n\n该解决方案涉及逐步实现所提供的物理模型。所有计算将以 SI 单位制进行，但电子碰撞频率的计算除外，该计算需要使用指定的温度和密度单位。\n\n**1. 基本关系**\n\n问题的核心在于环向等离子体电流与磁场结构之间的关系，该结构由安全因子 $q(r)$ 表征。\n\n在一个大半径为 $R$、小半径为 $r$ 的大环径比圆形托卡马克中，安全因子 $q(r)$ 由下式给出：\n$$\nq(r) = \\frac{r B_T}{R B_P(r)}\n$$\n其中 $B_T$ 是恒定的环向磁场，$B_P(r)$ 是极向磁场。\n\n根据安培定律，半径 $r$ 处的极向磁场由该半径内包围的总环向电流 $I_{\\mathrm{enc}}(r)$ 产生：\n$$\nB_P(r) = \\frac{\\mu_0 I_{\\mathrm{enc}}(r)}{2 \\pi r}\n$$\n其中 $\\mu_0$ 是真空磁导率。\n\n将 $B_P(r)$ 的表达式代入 $q(r)$ 的定义，我们得到安全因子与包围电流之间的直接关系：\n$$\nq(r) = \\frac{r B_T}{R} \\left( \\frac{2 \\pi r}{\\mu_0 I_{\\mathrm{enc}}(r)} \\right) = \\frac{2 \\pi r^2 B_T}{\\mu_0 R I_{\\mathrm{enc}}(r)}\n$$\n这个方程是问题的核心。它表明 $q(r)$ 与包围电流 $I_{\\mathrm{enc}}(r)$ 成反比。要提高安全因子，必须减小包围电流。\n\n**2. 算法流程**\n\n计算过程通过将小半径 $r$ 从 $0$ 到 $a$ 离散化为 $N$ 个点，并在此网格上计算所有物理量来展开。\n\n**步骤 1：初始状态计算**\n我们给定了一个初始安全因子分布 $q_0(r)$。我们可以反转上述关系式，以求得初始包围电流分布 $I_{\\mathrm{enc},0}(r)$：\n$$\nI_{\\mathrm{enc},0}(r) = \\frac{2 \\pi r^2 B_T}{\\mu_0 R q_0(r)}\n$$\n这是对我们离散网格上所有 $r_i > 0$ 进行计算的。在中心处，$I_{\\mathrm{enc},0}(0) = 0$。\n\n**步骤 2：射频驱动电流计算**\nECCD 系统沉积功率 $P_{\\mathrm{abs}}(r)$ 并将动量传递给电子，从而驱动电流。稳态驱动电流密度 $J_{\\mathrm{CD}}(r)$ 由射频力与来自离子的碰撞阻力之间的平衡决定。这给出：\n$$\nJ_{\\mathrm{CD}}(r) = \\frac{e \\, n_{\\parallel}(r) \\, P_{\\mathrm{abs}}(r)}{m_e c \\, \\nu_e(r)}\n$$\n其中 $e$ 是元电荷，$m_e$ 是电子质量，$c$ 是光速，$n_{\\parallel}(r)$ 是平行折射率，它决定了波的方向和相速度。正的 $n_{\\parallel}$ 对应于同向电流驱动（增加等离子体电流），而负的 $n_{\\parallel}$ 对应于反向电流驱动（从等离子体电流中减去）。\n\n电子碰撞频率 $\\nu_e(r)$ 是一个关键参数，它量化了等离子体的电阻率。它由以下公式给出：\n$$\n\\nu_e(r) = 2.91 \\times 10^{-6} \\, Z_{\\mathrm{eff}} \\, \\frac{n_e^{(\\mathrm{cm}^{-3})}(r) \\, \\ln \\Lambda}{T_e(r)^{3/2}} \\quad [\\mathrm{s}^{-1}]\n$$\n此公式要求电子密度 $n_e$ 的单位为 $\\mathrm{cm}^{-3}$，电子温度 $T_e$ 的单位为 $\\mathrm{eV}$。由于输入的密度 $n_e(r)$ 使用 SI 单位（$\\mathrm{m}^{-3}$），因此在使用此公式前必须乘以 $10^{-6}$ 进行转换。\n\n**步骤 3：驱动电流积分**\n驱动电流密度 $J_{\\mathrm{CD}}(r)$ 必须在等离子体截面上积分，以求得额外的包围电流 $\\Delta I_{\\mathrm{enc}}(r)$：\n$$\n\\Delta I_{\\mathrm{enc}}(r) = \\int_0^r J_{\\mathrm{CD}}(r') \\, 2 \\pi r' \\, dr'\n$$\n此积分使用梯形法则进行数值计算，特别是使用 `scipy.integrate.cumulative_trapezoid`，它可以有效地计算径向网格上的累积积分。\n\n**步骤 4：修正后的分布**\n新的总包围电流是初始电流和驱动电流之和：\n$$\nI_{\\mathrm{enc}}(r) = I_{\\mathrm{enc},0}(r) + \\Delta I_{\\mathrm{enc}}(r)\n$$\n使用这个修正后的包围电流，我们计算所有 $r > 0$ 的新安全因子分布 $q(r)$：\n$$\nq(r) = \\frac{2 \\pi r^2 B_T}{\\mu_0 R I_{\\mathrm{enc}}(r)}\n$$\n计算仅限于 $r > 0$，以避免除以零，因为 $I_{\\mathrm{enc}}(0) = 0$。\n\n**步骤 5：评估 $q_{\\min}$**\n修正后的安全因子分布的最小值 $q_{\\min}$，是通过在 $(0, a]$ 域上取计算出的 $q(r)$ 数组的最小值来找到的。然后将此值与 $1.5$ 的阈值进行比较，以确定 ECCD 应用是否成功地将 $q_{\\min}$ 提高到足以可能改善 MHD 稳定性的水平。对提供的每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the tokamak current drive problem for a suite of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    e = 1.60217663e-19  # Elementary charge (C)\n    m_e = 9.1093837e-31 # Electron mass (kg)\n    c = 299792458       # Speed of light (m/s)\n    mu_0 = 4 * np.pi * 1e-7 # Permeability of free space (T*m/A)\n\n    # Problem-specific constants\n    Z_eff = 1.5\n    ln_Lambda = 17.0\n    N_POINTS = 400\n\n    def solve_case(params):\n        \"\"\"\n        Computes the modified q_min for a single set of tokamak parameters.\n        \"\"\"\n        # Unpack parameters\n        R, a, B_T = params['geom']\n        q_axis, q_edge, lam = params['q0_profile']\n        n_e0, n_e_edge, alpha_n = params['ne_profile']\n        T_e0, T_e_edge, alpha_T = params['Te_profile']\n        P0, r0_norm, w_norm, n_parallel_0 = params['rf_params']\n\n        # 1. Discretize radius and define normalized radius\n        r = np.linspace(0, a, N_POINTS)\n        r_norm = r / a\n        r0 = r0_norm * a\n        w = w_norm * a\n\n        # Define profile functions based on the provided models\n        def q0_func(rn):\n            return q_axis + (q_edge - q_axis) * rn**lam\n\n        def ne_func_si(rn): # in m^-3\n            return n_e0 - (n_e0 - n_e_edge) * rn**alpha_n\n\n        def Te_func_ev(rn): # in eV\n            return T_e0 - (T_e0 - T_e_edge) * rn**alpha_T\n\n        def P_abs_func_si(r_val): # in W/m^3\n            return P0 * np.exp(-((r_val - r0)**2) / (2 * w**2))\n\n        # Evaluate profiles on the discrete radial grid\n        q0_r = q0_func(r_norm)\n        ne_r_si = ne_func_si(r_norm)\n        Te_r_ev = Te_func_ev(r_norm)\n        P_abs_r_si = P_abs_func_si(r)\n        n_parallel_r = np.full_like(r, n_parallel_0)\n\n        # 2. Compute initial enclosed current I_enc,0(r)\n        I_enc0_r = np.zeros_like(r)\n        # Avoid division by zero at r=0. I_enc(0) is 0.\n        r_nonzero = r[1:]\n        q0_nonzero = q0_r[1:]\n        I_enc0_r[1:] = (2 * np.pi * r_nonzero**2 * B_T) / (mu_0 * R * q0_nonzero)\n\n        # 3. Compute driven current density J_CD(r)\n        # First, calculate electron collision frequency nu_e(r)\n        # The formula requires n_e in cm^-3. 1 m^-3 = 1e-6 cm^-3.\n        ne_r_cm3 = ne_r_si * 1e-6\n        nu_e_r = (2.91e-6 * Z_eff * ln_Lambda * ne_r_cm3) / (Te_r_ev**1.5)\n        \n        # Then, calculate driven current density J_CD(r)\n        denominator = m_e * c * nu_e_r\n        # Avoid division by zero, though Te>0 ensures nu_e>0\n        J_cd_r = np.divide(e * n_parallel_r * P_abs_r_si, denominator, \n                           out=np.zeros_like(denominator), where=denominator!=0)\n\n        # 4. Integrate J_CD to obtain the added enclosed current Delta_I_enc(r)\n        integrand = 2 * np.pi * r * J_cd_r\n        delta_I_enc_r = cumulative_trapezoid(integrand, r, initial=0)\n\n        # 5. Form the modified enclosed current I_enc(r)\n        I_enc_mod_r = I_enc0_r + delta_I_enc_r\n\n        # 6. Compute the modified safety factor q(r) for r > 0\n        # Slice to exclude r=0 as per problem description\n        r_nonzero = r[1:]\n        I_enc_mod_nonzero = I_enc_mod_r[1:]\n        \n        # Guard against unphysical negative total current from strong counter-drive\n        valid_indices = np.where(I_enc_mod_nonzero > 0)[0]\n        \n        if len(valid_indices) == 0:\n            # If all current is reversed, q is undefined or infinite.\n            q_min = np.inf\n        else:\n            # Compute q only where the enclosed current is positive\n            r_valid = r_nonzero[valid_indices]\n            I_enc_valid = I_enc_mod_nonzero[valid_indices]\n            q_mod_valid = (2 * np.pi * r_valid**2 * B_T) / (mu_0 * R * I_enc_valid)\n            q_min = np.min(q_mod_valid)\n\n        # 7. Assess if q_min > 1.5\n        is_raised = bool(q_min > 1.5)\n\n        return [round(q_min, 3), is_raised]\n\n    test_cases = [\n        # Case A: counter-current, near-axis, moderate collisionality\n        {\n            'geom': (3.0, 1.0, 3.0),\n            'q0_profile': (1.3, 3.5, 2.0),\n            'ne_profile': (8.0e19, 3.0e19, 2.0),\n            'Te_profile': (6000, 1500, 2.0),\n            'rf_params': (5.0e4, 0.2, 0.12, -1.4)\n        },\n        # Case B: co-current, off-axis, moderate power\n        {\n            'geom': (3.0, 1.0, 3.0),\n            'q0_profile': (1.3, 3.5, 2.0),\n            'ne_profile': (7.5e19, 3.0e19, 2.0),\n            'Te_profile': (5500, 1500, 2.0),\n            'rf_params': (6.0e4, 0.5, 0.15, 1.4)\n        },\n        # Case C: weak counter-current, low power\n        {\n            'geom': (3.0, 1.0, 3.0),\n            'q0_profile': (1.3, 3.5, 2.0),\n            'ne_profile': (8.0e19, 3.0e19, 2.0),\n            'Te_profile': (6000, 1500, 2.0),\n            'rf_params': (2.0e4, 0.3, 0.12, -0.8)\n        },\n        # Case D: counter-current, near-axis, high collisionality\n        {\n            'geom': (3.0, 1.0, 3.0),\n            'q0_profile': (1.3, 3.5, 2.0),\n            'ne_profile': (8.5e19, 3.5e19, 2.0),\n            'Te_profile': (2000, 800, 2.0),\n            'rf_params': (5.0e4, 0.2, 0.12, -1.2)\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_case(case_params)\n        results.append(result)\n\n    # Print results in the specified single-line format\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}