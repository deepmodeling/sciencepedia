{
    "hands_on_practices": [
        {
            "introduction": "Before implementing any physical model, it is crucial to understand its fundamental properties. This first practice grounds our study of sources and sinks by examining their physical dimensions within the framework of a transport equation. By applying the principle of dimensional homogeneity to the particle continuity equation, you will determine the units of a source term and verify that this is consistent with common physical models for ionization and recombination, ensuring your theoretical and computational work is built on a solid foundation .",
            "id": "4045974",
            "problem": "In a magnetically confined fusion plasma, the particle continuity equation for a single species reads $\\partial_{t} n + \\nabla \\cdot \\Gamma = S_{n}$, where $n$ is the number density and $\\Gamma$ is the particle flux density. Suppose $n$ is reported in $\\mathrm{m^{-3}}$ and $\\Gamma$ is reported in $\\mathrm{m^{-2}\\,s^{-1}}$. Starting from the principle of local particle conservation and the definition of flux and sources, use dimensional analysis to determine the dimensional form of $S_{n}$ expressed in terms of the base dimensions of length $L$ and time $T$. Then, verify consistency in a fusion plasma context by considering the integral form over a fixed control volume $V$ with boundary $\\partial V$, and show that the dimensional form of $\\int_{V} S_{n}\\,\\mathrm{d}V$ matches the time rate of change of particle number plus the net boundary outflow. Finally, discuss whether typical volumetric source terms arising from ionization and volumetric sink terms from recombination are dimensionally consistent with your result when modeled as $S_{n} = n_{e} n_{n} \\langle \\sigma v \\rangle - n_{e} n_{i} \\alpha$, where $n_{e}$, $n_{n}$, and $n_{i}$ are number densities, $\\langle \\sigma v \\rangle$ is a reaction rate coefficient, and $\\alpha$ is a recombination coefficient. Express your final dimensional result for $S_{n}$ using only the base dimensions $L$ and $T$ (do not include any physical units in the final expression).",
            "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded in the principles of particle conservation, well-posed, objective, and internally consistent. We may therefore proceed with a full solution.\n\nThe problem asks for three tasks: first, to determine the dimensional form of the source term $S_{n}$ from the particle continuity equation; second, to verify this result using the integral form of the equation; and third, to check for dimensional consistency with a typical model for sources and sinks in a fusion plasma. We will address these in sequence.\n\nThe particle continuity equation is given as:\n$$\n\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\Gamma = S_{n}\n$$\nwhere $n$ is the number density, $\\Gamma$ is the particle flux density, and $S_{n}$ is the volumetric particle source rate.\n\nAccording to the principle of dimensional homogeneity, all additive terms in a physical equation must possess the same physical dimensions. We will determine the dimensions of the terms on the left-hand side to deduce the dimensions of $S_{n}$. Let $[X]$ denote the dimension of a quantity $X$. The base dimensions are length, $L$, and time, $T$.\n\nThe number density $n$ is given in units of $\\mathrm{m^{-3}}$ (particles per unit volume). Its dimension is therefore:\n$$\n[n] = L^{-3}\n$$\nThe first term, $\\frac{\\partial n}{\\partial t}$, represents the time rate of change of the number density. Its dimension is:\n$$\n\\left[\\frac{\\partial n}{\\partial t}\\right] = \\frac{[n]}{[t]} = \\frac{L^{-3}}{T} = L^{-3} T^{-1}\n$$\n\nThe particle flux density $\\Gamma$ is given in units of $\\mathrm{m^{-2}\\,s^{-1}}$ (particles per unit area per unit time). Its dimension is:\n$$\n[\\Gamma] = L^{-2} T^{-1}\n$$\nThe divergence operator, $\\nabla \\cdot$, involves spatial derivatives, so its dimension is that of inverse length:\n$$\n[\\nabla] = L^{-1}\n$$\nThe dimension of the divergence of the flux, $\\nabla \\cdot \\Gamma$, is therefore:\n$$\n[\\nabla \\cdot \\Gamma] = [\\nabla] [\\Gamma] = (L^{-1}) (L^{-2} T^{-1}) = L^{-3} T^{-1}\n$$\n\nAs both terms on the left-hand side of the continuity equation have dimensions of $L^{-3} T^{-1}$, the source term $S_{n}$ must have the same dimensions to ensure homogeneity:\n$$\n[S_{n}] = \\left[\\frac{\\partial n}{\\partial t}\\right] = [\\nabla \\cdot \\Gamma] = L^{-3} T^{-1}\n$$\nThis dimensional form corresponds to a number of particles per unit volume per unit time, which is the physical meaning of a volumetric source rate.\n\nNext, we verify this consistency using the integral form of the conservation law. We integrate the continuity equation over a fixed control volume $V$ with boundary $\\partial V$:\n$$\n\\int_{V} \\left( \\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\Gamma \\right) \\,\\mathrm{d}V = \\int_{V} S_{n}\\,\\mathrm{d}V\n$$\nUsing the linearity of the integral and applying the Gauss's Divergence Theorem to the flux term, we get:\n$$\n\\int_{V} \\frac{\\partial n}{\\partial t} \\,\\mathrm{d}V + \\oint_{\\partial V} \\Gamma \\cdot \\mathrm{d}\\mathbf{A} = \\int_{V} S_{n}\\,\\mathrm{d}V\n$$\nSince the control volume $V$ is fixed, the time derivative can be moved outside the integral:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} n \\,\\mathrm{d}V + \\oint_{\\partial V} \\Gamma \\cdot \\mathrm{d}\\mathbf{A} = \\int_{V} S_{n}\\,\\mathrm{d}V\n$$\nThe term $\\int_{V} n \\,\\mathrm{d}V$ represents the total number of particles within the volume $V$, which is a dimensionless quantity (a pure number). Its time derivative, $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} n \\,\\mathrm{d}V$, is the time rate of change of the total particle number, and its dimension is $T^{-1}$. The term $\\oint_{\\partial V} \\Gamma \\cdot \\mathrm{d}\\mathbf{A}$ is the net outflow rate of particles across the boundary, with dimensions $[\\Gamma] \\times [\\text{Area}] = (L^{-2} T^{-1})(L^{2}) = T^{-1}$.\nThus, the left-hand side of the integral equation has dimensions of $T^{-1}$. The right-hand side, representing the total rate of particle generation within the volume, must also have this dimension. Using our derived dimension for $S_{n}$:\n$$\n\\left[ \\int_{V} S_{n}\\,\\mathrm{d}V \\right] = [S_{n}] [\\mathrm{d}V] = (L^{-3} T^{-1}) (L^{3}) = T^{-1}\n$$\nThe dimensions match, which confirms that our derived dimensional form $[S_{n}] = L^{-3} T^{-1}$ is consistent with the physical interpretation of the integral conservation law.\n\nFinally, we discuss the dimensional consistency of the given source/sink model:\n$$\nS_{n} = n_{e} n_{n} \\langle \\sigma v \\rangle - n_{e} n_{i} \\alpha\n$$\nThis expression is the sum of an ionization source term and a recombination sink term. For the equation to be valid, both terms must have the dimensions of $S_{n}$, i.e., $L^{-3} T^{-1}$.\n\nLet's analyze the ionization term, $n_{e} n_{n} \\langle \\sigma v \\rangle$. The quantities $n_{e}$ (electron density) and $n_{n}$ (neutral density) are number densities, so $[n_{e}] = [n_{n}] = L^{-3}$. The term $\\langle \\sigma v \\rangle$ is the reaction rate coefficient. It is the product of a reaction cross-section $\\sigma$ and a relative velocity $v$, averaged over the velocity distribution. The dimension of a cross-section (an effective area) is $[\\sigma] = L^{2}$, and the dimension of velocity is $[v] = L T^{-1}$. The average does not alter the dimensions. Therefore:\n$$\n[\\langle \\sigma v \\rangle] = [\\sigma][v] = (L^{2})(L T^{-1}) = L^{3} T^{-1}\n$$\nThe dimension of the ionization term is then:\n$$\n[n_{e} n_{n} \\langle \\sigma v \\rangle] = [n_{e}] [n_{n}] [\\langle \\sigma v \\rangle] = (L^{-3}) (L^{-3}) (L^{3} T^{-1}) = L^{-3} T^{-1}\n$$\nThis matches the required dimension for $S_{n}$.\n\nNow, let's analyze the recombination term, $n_{e} n_{i} \\alpha$. The quantities $n_{e}$ and $n_{i}$ (ion density) are number densities, $[n_{e}] = [n_{i}] = L^{-3}$. For this term to be dimensionally consistent, it must also have the dimension $L^{-3} T^{-1}$. This allows us to determine the dimension of the recombination coefficient $\\alpha$:\n$$\n[n_{e} n_{i} \\alpha] = L^{-3} T^{-1}\n$$\n$$\n(L^{-3})(L^{-3})[\\alpha] = L^{-3} T^{-1}\n$$\n$$\nL^{-6} [\\alpha] = L^{-3} T^{-1}\n$$\nSolving for $[\\alpha]$:\n$$\n[\\alpha] = \\frac{L^{-3} T^{-1}}{L^{-6}} = L^{-3 - (-6)} T^{-1} = L^{3} T^{-1}\n$$\nThus, the recombination coefficient $\\alpha$ must have dimensions of volume per time. This is the standard and physically correct dimension for a two-body recombination coefficient, analogous to the ionization rate coefficient $\\langle \\sigma v \\rangle$.\n\nBoth terms in the model $S_{n} = n_{e} n_{n} \\langle \\sigma v \\rangle - n_{e} n_{i} \\alpha$ are dimensionally consistent with the continuity equation. The final result requested is the dimensional form of $S_{n}$. As determined in the first part of the analysis, this is $L^{-3} T^{-1}$.",
            "answer": "$$\\boxed{L^{-3} T^{-1}}$$"
        },
        {
            "introduction": "Transport codes solve equations on a discrete grid, requiring continuous physical processes to be represented in a discrete manner. This exercise focuses on a core task in computational transport modeling: converting a continuous, analytical source profile into a set of discrete, cell-averaged values suitable for a finite volume method. You will work through the specific case of a Gaussian source distribution in a toroidal geometry, a scenario directly relevant to modeling neutral beam injection or localized particle fueling in tokamaks .",
            "id": "4045945",
            "problem": "Consider the conservation of particle number in an axisymmetric, large–aspect-ratio toroidal plasma typical of a tokamak, modeled as a one-dimensional radial transport problem for the particle density $n(r,t)$ with radial coordinate $r \\in [0,a]$ and constant major radius $R_0$. The fundamental balance law is the local particle continuity equation $\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\boldsymbol{\\Gamma} = S_n$, where $\\boldsymbol{\\Gamma}$ is the particle flux density and $S_n$ is a volumetric source density.\n\nUsing the Finite Volume Method (FVM), consider a control volume that is an annulus bounded by the flux surfaces at $r = r_{i-1/2}$ and $r = r_{i+1/2}$, with $0 \\le r_{i-1/2}  r_{i+1/2} \\le a$. Assume axisymmetry and the large–aspect-ratio approximation so that the differential volume element and the radial face areas are determined by toroidal geometry. Starting from the fundamental continuity equation stated above, derive the conservative semi-discrete balance for the cell-averaged density that relates the time rate of change of the total number of particles in the cell, the net flux across the two radial faces, and the volumetric source integrated over the cell.\n\nThen, take the continuous source distribution to be $S_n(r) = S_0 \\exp\\!\\big(-r^2/\\ell^2\\big)$ with constants $S_0 > 0$ and $\\ell > 0$, and compute the corresponding cell-averaged source $S_{n,i}$ as the appropriate volume average of $S_n(r)$ over the annulus. Use the large–aspect-ratio toroidal geometry with the line element around the torus taken as $2\\pi R_0$ and the poloidal circumference taken as $2\\pi r$ so that the differential volume is $\\mathrm{d}V = 4\\pi^2 R_0\\, r\\, \\mathrm{d}r$.\n\nProvide your final result as a single closed-form analytic expression for $S_{n,i}$ in terms of $S_0$, $\\ell$, $r_{i-1/2}$, and $r_{i+1/2}$ only. Express the value in the International System of Units (SI) as $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$. Do not include the units in your final boxed answer, and do not include an equality sign. If you simplify to a purely numerical value, round to four significant figures.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of transport phenomena, specifically particle conservation in plasma physics. The problem is well-posed, with all necessary information provided for a unique solution. The language is objective and the setup is a standard, albeit simplified, representation used in computational fusion science.\n\nThe solution is developed in two parts as requested by the problem statement. First, the conservative semi-discrete balance equation is derived using the Finite Volume Method (FVM). Second, the specific cell-averaged source term is calculated for the given source distribution.\n\n**Part 1: Derivation of the Semi-Discrete Balance Equation**\n\nThe starting point is the local particle continuity equation, which expresses the conservation of particle number density $n(r,t)$:\n$$\n\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\boldsymbol{\\Gamma} = S_n\n$$\nHere, $\\boldsymbol{\\Gamma}$ is the particle flux density and $S_n$ is the volumetric particle source density.\n\nFor the Finite Volume Method, we integrate this equation over a control volume $V_i$. In this axisymmetric toroidal geometry, the control volume is an annulus (a toroidal shell) bounded by the flux surfaces at radii $r=r_{i-1/2}$ and $r=r_{i+1/2}$.\n$$\n\\int_{V_i} \\frac{\\partial n}{\\partial t} \\, \\mathrm{d}V + \\int_{V_i} \\nabla \\cdot \\boldsymbol{\\Gamma} \\, \\mathrm{d}V = \\int_{V_i} S_n \\, \\mathrm{d}V\n$$\nLet's analyze each term.\n\nThe first term represents the time rate of change of the total number of particles, $N_i$, within the control volume $V_i$. Assuming the control volume is fixed in time, we can interchange integration and differentiation:\n$$\n\\int_{V_i} \\frac{\\partial n}{\\partial t} \\, \\mathrm{d}V = \\frac{d}{dt} \\int_{V_i} n \\, \\mathrm{d}V = \\frac{d N_i}{dt}\n$$\nThe total number of particles $N_i$ is related to the cell-averaged density $n_i$ by $N_i = n_i V_i$.\n\nThe second term is transformed using the divergence theorem (Gauss's theorem) into a surface integral over the boundary of the control volume, $\\partial V_i$:\n$$\n\\int_{V_i} \\nabla \\cdot \\boldsymbol{\\Gamma} \\, \\mathrm{d}V = \\oint_{\\partial V_i} \\boldsymbol{\\Gamma} \\cdot d\\mathbf{A}\n$$\nIn this one-dimensional radial model, the particle flux is purely radial, $\\boldsymbol{\\Gamma} = \\Gamma_r(r) \\hat{\\mathbf{r}}$. The boundary $\\partial V_i$ consists of two toroidal surfaces at $r_{i-1/2}$ (inner) and $r_{i+1/2}$ (outer). The outward normal vector is $-\\hat{\\mathbf{r}}$ on the inner surface and $+\\hat{\\mathbf{r}}$ on the outer surface. The surface area of a torus of minor radius $r$ and major radius $R_0$ in the large aspect ratio approximation is $A(r) = (2\\pi r)(2\\pi R_0) = 4\\pi^2 R_0 r$. The surface integral thus becomes the net flux out of the cell:\n$$\n\\oint_{\\partial V_i} \\boldsymbol{\\Gamma} \\cdot d\\mathbf{A} = (\\Gamma_r A(r))|_{r=r_{i+1/2}} - (\\Gamma_r A(r))|_{r=r_{i-1/2}} = A_{i+1/2}\\Gamma_{r, i+1/2} - A_{i-1/2}\\Gamma_{r, i-1/2}\n$$\nwhere $A_{i\\pm1/2} = A(r_{i\\pm1/2})$ and $\\Gamma_{r, i\\pm1/2} = \\Gamma_r(r_{i\\pm1/2})$.\n\nThe third term is the total number of particles generated per unit time within the cell volume, which we can denote as $\\mathcal{S}_i$:\n$$\n\\mathcal{S}_i = \\int_{V_i} S_n \\, \\mathrm{d}V\n$$\nThis can be expressed in terms of the cell-averaged source $S_{n,i}$ as $\\mathcal{S}_i = S_{n,i} V_i$.\n\nCombining these terms yields the conservative semi-discrete balance equation for the total number of particles in cell $i$:\n$$\n\\frac{d N_i}{dt} + \\left( A_{i+1/2}\\Gamma_{r, i+1/2} - A_{i-1/2}\\Gamma_{r, i-1/2} \\right) = \\mathcal{S}_i\n$$\nThis equation precisely relates the time rate of change of the total number of particles in the cell ($d N_i/dt$), the net flux across the two radial faces (the term in parentheses), and the volumetric source integrated over the cell ($\\mathcal{S}_i$).\n\n**Part 2: Calculation of the Cell-Averaged Source**\n\nThe cell-averaged source, $S_{n,i}$, is defined as the volume average of the continuous source distribution $S_n(r)$ over the cell volume $V_i$:\n$$\nS_{n,i} = \\frac{\\int_{V_i} S_n(r) \\, \\mathrm{d}V}{\\int_{V_i} \\, \\mathrm{d}V} = \\frac{\\mathcal{S}_i}{V_i}\n$$\nThe differential volume element is given as $\\mathrm{d}V = 4\\pi^2 R_0 r \\, \\mathrm{d}r$.\n\nFirst, we compute the volume of the cell $V_i$:\n$$\nV_i = \\int_{r_{i-1/2}}^{r_{i+1/2}} 4\\pi^2 R_0 r \\, \\mathrm{d}r = 4\\pi^2 R_0 \\left[ \\frac{r^2}{2} \\right]_{r_{i-1/2}}^{r_{i+1/2}} = 2\\pi^2 R_0 (r_{i+1/2}^2 - r_{i-1/2}^2)\n$$\nNext, we compute the integrated source $\\mathcal{S}_i$ using the given source distribution $S_n(r) = S_0 \\exp(-r^2/\\ell^2)$:\n$$\n\\mathcal{S}_i = \\int_{r_{i-1/2}}^{r_{i+1/2}} S_0 \\exp\\left(-\\frac{r^2}{\\ell^2}\\right) (4\\pi^2 R_0 r \\, \\mathrm{d}r) = 4\\pi^2 R_0 S_0 \\int_{r_{i-1/2}}^{r_{i+1/2}} r \\exp\\left(-\\frac{r^2}{\\ell^2}\\right) \\, \\mathrm{d}r\n$$\nTo solve the integral, we use the substitution $u = -r^2/\\ell^2$. The differential is $du = -2r/\\ell^2 \\, \\mathrm{d}r$, which implies $r \\, \\mathrm{d}r = -\\frac{\\ell^2}{2} \\, du$. The integral becomes:\n$$\n\\int r \\exp\\left(-\\frac{r^2}{\\ell^2}\\right) \\, \\mathrm{d}r = \\int \\exp(u) \\left(-\\frac{\\ell^2}{2} \\, du\\right) = -\\frac{\\ell^2}{2} \\exp(u) = -\\frac{\\ell^2}{2} \\exp\\left(-\\frac{r^2}{\\ell^2}\\right)\n$$\nEvaluating the definite integral from $r_{i-1/2}$ to $r_{i+1/2}$:\n$$\n\\int_{r_{i-1/2}}^{r_{i+1/2}} r \\exp\\left(-\\frac{r^2}{\\ell^2}\\right) \\, \\mathrm{d}r = \\left[ -\\frac{\\ell^2}{2} \\exp\\left(-\\frac{r^2}{\\ell^2}\\right) \\right]_{r_{i-1/2}}^{r_{i+1/2}}\n= -\\frac{\\ell^2}{2} \\left[ \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) \\right]\n$$\n$$\n= \\frac{\\ell^2}{2} \\left[ \\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right) \\right]\n$$\nSubstituting this result back into the expression for $\\mathcal{S}_i$:\n$$\n\\mathcal{S}_i = 4\\pi^2 R_0 S_0 \\left( \\frac{\\ell^2}{2} \\left[ \\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right) \\right] \\right)\n$$\n$$\n\\mathcal{S}_i = 2\\pi^2 R_0 S_0 \\ell^2 \\left[ \\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right) \\right]\n$$\nFinally, we compute the cell-averaged source $S_{n,i}$ by dividing $\\mathcal{S}_i$ by $V_i$:\n$$\nS_{n,i} = \\frac{2\\pi^2 R_0 S_0 \\ell^2 \\left[ \\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right) \\right]}{2\\pi^2 R_0 (r_{i+1/2}^2 - r_{i-1/2}^2)}\n$$\nThe common factor of $2\\pi^2 R_0$ cancels, yielding the final expression for the cell-averaged source:\n$$\nS_{n,i} = S_0 \\ell^2 \\frac{\\exp\\left(-\\frac{r_{i-1/2}^2}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^2}{\\ell^2}\\right)}{r_{i+1/2}^2 - r_{i-1/2}^2}\n$$\nThis is the closed-form analytic expression for $S_{n,i}$ in terms of the given parameters. The units are consistent, as $(m^{-3}s^{-1}) \\cdot m^2 / m^2 = m^{-3}s^{-1}$.",
            "answer": "$$\\boxed{S_0 \\ell^2 \\frac{\\exp\\left(-\\frac{r_{i-1/2}^{2}}{\\ell^2}\\right) - \\exp\\left(-\\frac{r_{i+1/2}^{2}}{\\ell^2}\\right)}{r_{i+1/2}^{2} - r_{i-1/2}^{2}}}$$"
        },
        {
            "introduction": "A cornerstone of reliable scientific computing is rigorous code verification. This final practice walks you through the Method of Manufactured Solutions, a powerful technique to confirm that your numerical code correctly solves the intended mathematical equations. You will devise a verification test by choosing an analytic solution, deriving the corresponding source term needed to satisfy the governing equation, and then comparing the output of a numerical solver against this exact solution to precisely quantify the implementation's accuracy .",
            "id": "4045995",
            "problem": "Consider the one-dimensional slab transport of a scalar particle density $n(x,t)$ along the coordinate $x \\in [0,L]$ in a periodic domain, representative of a flux-tube segment in computational fusion science and engineering. The fundamental base is the continuity equation with a diffusive flux and linear sources and sinks: \n$$\\frac{\\partial n}{\\partial t} + \\frac{\\partial \\Gamma}{\\partial x} = S(x) - \\sigma n(x,t),$$ \nwhere the diffusive flux is given by Fick's law $\\Gamma(x,t) = -D \\frac{\\partial n}{\\partial x}$, the scalar diffusion coefficient $D>0$ is uniform, $S(x)$ is an externally imposed source density profile, and $\\sigma \\ge 0$ is a uniform linear sink rate. In steady state, the governing equation reduces to the second-order ordinary differential equation \n$$D \\frac{d^2 n}{dx^2} - \\sigma n + S(x) = 0,$$ \nsubject to periodic boundary conditions $n(0) = n(L)$ and $\\frac{dn}{dx}(0) = \\frac{dn}{dx}(L)$. \n\nYou must design and implement a verification test that uses a known analytic source profile to produce a predictable steady-state density profile, and then use it to verify a transport code's source implementation. Use the analytic source \n$$S(x) = s_1 \\sin(\\kappa_1 x) + s_2 \\cos(\\kappa_2 x),$$ \nwith $\\kappa_m = \\frac{2\\pi k_m}{L}$ and integers $k_m \\in \\mathbb{Z}^+$, ensuring periodicity. The verification method should be rooted in first principles: derive the expected steady-state $n(x)$ implied by the fundamental base without shortcut formulas, and independently solve the steady-state equation numerically for the same source using a second-order central finite-difference discretization with periodic boundary conditions on an equispaced grid of $N$ points. Compute the relative $\\ell_2$ error between the numerical solution and the analytic prediction to quantify the correctness of the source implementation:\n$$\\varepsilon = \\frac{\\left\\| n_{\\mathrm{num}} - n_{\\mathrm{ana}} \\right\\|_2}{\\left\\| n_{\\mathrm{ana}} \\right\\|_2}.$$\n\nImplementation requirements:\n- Discretize the interval $[0,L]$ into $N$ equispaced points $x_j = j h$ with $h = L/N$ and $j \\in \\{0,1,\\dots,N-1\\}$. \n- Use the periodic second-order central-difference Laplacian operator $\\mathcal{L}_h n_j = \\frac{n_{j+1} - 2 n_j + n_{j-1}}{h^2}$ (with periodic indexing) to construct the steady-state discrete equation $D \\mathcal{L}_h n_j - \\sigma n_j + S_j = 0$. \n- Solve the discrete steady-state problem accurately and stably for $n_{\\mathrm{num}}$ using a method appropriate for periodic problems.\n- Independently construct $n_{\\mathrm{ana}}$ on the same grid from the first-principles derivation.\n- Compute the relative $\\ell_2$ error $\\varepsilon$ as a dimensionless float. No physical units are required in the output.\n\nTest suite:\nUse the following parameter sets, which exercise a general case, coarse-grid behavior, high diffusion, high sink, and near-Nyquist content. For each case, define $(L,D,\\sigma,N,k_1,k_2,s_1,s_2)$ as specified:\n- Case $1$ (general \"happy path\"): $L = 2\\pi$, $D = 0.3$, $\\sigma = 0.7$, $N = 256$, $k_1 = 3$, $k_2 = 5$, $s_1 = 1.0$, $s_2 = 0.5$.\n- Case $2$ (coarse grid boundary coverage): $L = 2\\pi$, $D = 0.3$, $\\sigma = 0.7$, $N = 16$, $k_1 = 3$, $k_2 = 5$, $s_1 = 1.0$, $s_2 = 0.5$.\n- Case $3$ (significant edge case: high diffusion): $L = 2\\pi$, $D = 5.0$, $\\sigma = 0.1$, $N = 128$, $k_1 = 1$, $k_2 = 2$, $s_1 = 2.0$, $s_2 = 1.0$.\n- Case $4$ (significant edge case: high sink): $L = 2\\pi$, $D = 0.01$, $\\sigma = 10.0$, $N = 128$, $k_1 = 4$, $k_2 = 7$, $s_1 = 1.0$, $s_2 = 2.0$.\n- Case $5$ (near-Nyquist content without aliasing): $L = 2\\pi$, $D = 0.2$, $\\sigma = 0.5$, $N = 64$, $k_1 = 8$, $k_2 = 16$, $s_1 = 1.5$, $s_2 = 0.75$.\n\nFinal output specification:\nYour program should produce a single line of output containing the relative $\\ell_2$ errors for the five cases as a comma-separated list of floats enclosed in square brackets, with the cases ordered $1$ through $5$, for example, $[e_1,e_2,e_3,e_4,e_5]$.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and provides a complete and consistent set of specifications for a verification test in computational transport modeling. All test cases are defined with $\\sigma  0$, ensuring the corresponding continuous and discrete problems have a unique solution.\n\nThe solution proceeds in three stages as required: first, the derivation of the exact analytic solution to the continuous problem; second, the formulation of a numerical solution to the discretized problem; and third, the computation of the relative error between the two to verify the implementation.\n\n**1. Derivation of the Analytic Solution**\n\nThe governing equation is the steady-state, one-dimensional reaction-diffusion equation:\n$$D \\frac{d^2 n}{dx^2} - \\sigma n + S(x) = 0$$\nThis is a linear, second-order ordinary differential equation with constant coefficients $D  0$ and $\\sigma  0$. The domain is $x \\in [0, L]$ with periodic boundary conditions. The source term is specified as:\n$$S(x) = s_1 \\sin(\\kappa_1 x) + s_2 \\cos(\\kappa_2 x)$$\nwhere $\\kappa_m = \\frac{2\\pi k_m}{L}$ for positive integers $k_m$. This form ensures that $S(x)$ satisfies the periodic boundary conditions on the interval $[0, L]$.\n\nDue to the linearity of the differential operator $\\mathcal{L} \\equiv D \\frac{d^2}{dx^2} - \\sigma$, we can apply the principle of superposition. We seek a particular solution $n_p(x)$ by considering the contributions from the sine and cosine components of the source term independently. The functions $\\sin(\\kappa x)$ and $\\cos(\\kappa x)$ are eigenfunctions of the second derivative operator $\\frac{d^2}{dx^2}$. We thus propose a solution ansatz of the same functional form as the source:\n$$n_{\\mathrm{ana}}(x) = C_1 \\sin(\\kappa_1 x) + C_2 \\cos(\\kappa_2 x)$$\nWe substitute this ansatz into the governing equation. First, we compute the second derivative of $n_{\\mathrm{ana}}(x)$:\n$$\\frac{d^2 n_{\\mathrm{ana}}}{dx^2} = -C_1 \\kappa_1^2 \\sin(\\kappa_1 x) - C_2 \\kappa_2^2 \\cos(\\kappa_2 x)$$\nSubstituting $n_{\\mathrm{ana}}$ and its second derivative into the ODE yields:\n$$D \\left( -C_1 \\kappa_1^2 \\sin(\\kappa_1 x) - C_2 \\kappa_2^2 \\cos(\\kappa_2 x) \\right) - \\sigma \\left( C_1 \\sin(\\kappa_1 x) + C_2 \\cos(\\kappa_2 x) \\right) + \\left( s_1 \\sin(\\kappa_1 x) + s_2 \\cos(\\kappa_2 x) \\right) = 0$$\nCollecting terms for each trigonometric function:\n$$\\left( -D C_1 \\kappa_1^2 - \\sigma C_1 + s_1 \\right) \\sin(\\kappa_1 x) + \\left( -D C_2 \\kappa_2^2 - \\sigma C_2 + s_2 \\right) \\cos(\\kappa_2 x) = 0$$\nFor this equation to hold for all $x \\in [0, L]$, the coefficients of the basis functions $\\sin(\\kappa_1 x)$ and $\\cos(\\kappa_2 x)$ must independently be zero (assuming $k_1 \\ne k_2$; if $k_1 = k_2$, the logic still holds by combining terms).\n$$-C_1 (D \\kappa_1^2 + \\sigma) + s_1 = 0 \\implies C_1 = \\frac{s_1}{D \\kappa_1^2 + \\sigma}$$\n$$-C_2 (D \\kappa_2^2 + \\sigma) + s_2 = 0 \\implies C_2 = \\frac{s_2}{D \\kappa_2^2 + \\sigma}$$\nThe denominator $(D \\kappa_m^2 + \\sigma)$ is strictly positive given $D0$, $\\sigma0$, and real $\\kappa_m$. Thus, the coefficients are well-defined. The resulting analytic solution is:\n$$n_{\\mathrm{ana}}(x) = \\frac{s_1}{D \\kappa_1^2 + \\sigma} \\sin(\\kappa_1 x) + \\frac{s_2}{D \\kappa_2^2 + \\sigma} \\cos(\\kappa_2 x)$$\nThis solution is periodic by construction and is the unique steady-state solution under the given conditions.\n\n**2. Numerical Solution Formulation**\n\nThe problem is discretized on a uniform grid of $N$ points $x_j = j h$ for $j \\in \\{0, 1, \\dots, N-1\\}$, with grid spacing $h = L/N$. The steady-state equation is discretized using a second-order central difference for the Laplacian, resulting in a system of algebraic equations:\n$$D \\left( \\frac{n_{j+1} - 2n_j + n_{j-1}}{h^2} \\right) - \\sigma n_j + S_j = 0$$\nwhere $n_j = n(x_j)$ and $S_j = S(x_j)$. The indices are handled periodically, i.e., $n_{N} \\equiv n_0$ and $n_{-1} \\equiv n_{N-1}$. This set of $N$ linear equations can be written in matrix form $A \\mathbf{n}_{\\mathrm{num}} = -\\mathbf{S}$. Due to the periodic boundary conditions, the matrix $A$ representing the discrete operator $D \\mathcal{L}_h - \\sigma I$ is a circulant matrix.\n\nThe most efficient and stable method for solving linear systems involving circulant matrices is the Discrete Fourier Transform (DFT). The DFT diagonalizes any circulant matrix. Applying the DFT, denoted by $\\mathcal{F}$, to the discrete equation transforms the convolution represented by the finite-difference stencil into a simple multiplication in Fourier space. Let $\\hat{n}_q = \\mathcal{F}\\{n_j\\}$ and $\\hat{S}_q = \\mathcal{F}\\{S_j\\}$ be the DFTs of the density and source, respectively, where $q$ is the discrete mode index.\n\nThe DFT of the discrete Laplacian operator acting on $n_j$ is given by multiplication with its eigenvalues, $\\lambda_q$:\n$$\\mathcal{F}\\{\\mathcal{L}_h n_j\\} = \\lambda_q \\hat{n}_q = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi q}{N}\\right) - 1 \\right) \\hat{n}_q, \\quad q \\in \\{0, 1, \\dots, N-1\\}$$\nThe full equation in Fourier space becomes an algebraic equation for each mode $\\hat{n}_q$:\n$$\\left( D \\lambda_q - \\sigma \\right) \\hat{n}_q + \\hat{S}_q = 0$$\nSolving for $\\hat{n}_q$:\n$$\\hat{n}_q = \\frac{-\\hat{S}_q}{D \\lambda_q - \\sigma} = \\frac{-\\hat{S}_q}{D \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi q}{N}\\right) - 1 \\right) - \\sigma}$$\nThe denominator is always non-zero for $\\sigma0$, so a unique solution for $\\hat{\\mathbf{n}}$ exists. The numerical solution in real space, $\\mathbf{n}_{\\mathrm{num}}$, is then recovered by applying the inverse DFT ($\\mathcal{F}^{-1}$) to the vector of Fourier coefficients $\\hat{\\mathbf{n}}$:\n$$n_{\\mathrm{num}, j} = \\mathcal{F}^{-1}\\{\\hat{n}_q\\}$$\n\n**3. Error Quantification**\n\nTo verify the correctness of the numerical implementation, we compare the numerical solution $n_{\\mathrm{num}}$ with the analytic solution $n_{\\mathrm{ana}}$ evaluated on the same grid. The deviation is quantified using the relative $\\ell_2$ error, $\\varepsilon$:\n$$\\varepsilon = \\frac{\\left\\| \\mathbf{n}_{\\mathrm{num}} - \\mathbf{n}_{\\mathrm{ana}} \\right\\|_2}{\\left\\| \\mathbf{n}_{\\mathrm{ana}} \\right\\|_2}$$\nwhere the discrete $\\ell_2$ norm of a vector $\\mathbf{v}$ of length $N$ is defined as $\\left\\| \\mathbf{v} \\right\\|_2 = \\sqrt{\\sum_{j=0}^{N-1} v_j^2}$. This error is primarily attributable to the truncation error of the finite-difference approximation, which is of order $\\mathcal{O}(h^2)$. A small value of $\\varepsilon$ confirms that the numerical solver correctly implements the physics described by the continuous model. The implementation will compute this error for each provided test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state diffusion-reaction equation for a series of test cases,\n    compares the numerical solution to the analytic solution, and computes the relative l2 error.\n    \"\"\"\n    # (L, D, sigma, N, k1, k2, s1, s2)\n    test_cases = [\n        # Case 1 (general \"happy path\"):\n        (2 * np.pi, 0.3, 0.7, 256, 3, 5, 1.0, 0.5),\n        # Case 2 (coarse grid boundary coverage):\n        (2 * np.pi, 0.3, 0.7, 16, 3, 5, 1.0, 0.5),\n        # Case 3 (significant edge case: high diffusion):\n        (2 * np.pi, 5.0, 0.1, 128, 1, 2, 2.0, 1.0),\n        # Case 4 (significant edge case: high sink):\n        (2 * np.pi, 0.01, 10.0, 128, 4, 7, 1.0, 2.0),\n        # Case 5 (near-Nyquist content without aliasing):\n        (2 * np.pi, 0.2, 0.5, 64, 8, 16, 1.5, 0.75),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, D, sigma, N, k1, k2, s1, s2 = case\n        \n        # 1. Grid and Parameter Setup\n        h = L / N\n        x = np.arange(N) * h\n        kappa1 = 2 * np.pi * k1 / L\n        kappa2 = 2 * np.pi * k2 / L\n        \n        # 2. Analytic Solution Construction\n        # n_ana(x) = c1*sin(k1*x) + c2*cos(k2*x), where coefficients c1 and c2 are\n        # derived from the ODE: c_m = s_m / (D*kappa_m^2 + sigma).\n        c1 = s1 / (D * kappa1**2 + sigma)\n        c2 = s2 / (D * kappa2**2 + sigma)\n        n_ana = c1 * np.sin(kappa1 * x) + c2 * np.cos(kappa2 * x)\n        \n        # 3. Numerical Solution via FFT\n        # The equation D*n'' - sigma*n = -S is solved in Fourier space.\n        \n        # Evaluate source term on the grid\n        S = s1 * np.sin(kappa1 * x) + s2 * np.cos(kappa2 * x)\n        \n        # Fourier transform the source\n        S_hat = fft.fft(S)\n        \n        # Define eigenvalues of the discrete Laplacian operator in Fourier space.\n        # q represents the discrete mode number from 0 to N-1.\n        q = np.arange(N)\n        # Eigenvalues of second-order central difference periodic Laplacian:\n        # lambda_q = (2/h^2)*(cos(2*pi*q/N) - 1)\n        discrete_laplacian_eigvals = (2 / h**2) * (np.cos(2 * np.pi * q / N) - 1)\n        \n        # Solve for n_hat in Fourier space: (D*lambda_q - sigma)*n_hat = -S_hat\n        # The denominator is guaranteed non-zero since D>0 and sigma>0.\n        denominator = D * discrete_laplacian_eigvals - sigma\n        n_hat = -S_hat / denominator\n        \n        # Inverse Fourier transform to get the solution in real space.\n        # The result should be real; the small imaginary part is numerical noise.\n        n_num = np.real(fft.ifft(n_hat))\n        \n        # 4. Error Calculation\n        # Compute the relative l2 error between numerical and analytic solutions.\n        error_norm = np.linalg.norm(n_num - n_ana)\n        ana_norm = np.linalg.norm(n_ana)\n        \n        # Avoid division by zero if the analytic solution is identically zero.\n        # This is not expected for the given test cases but is good practice.\n        if ana_norm == 0.0:\n            relative_error = 0.0 if error_norm == 0.0 else np.inf\n        else:\n            relative_error = error_norm / ana_norm\n            \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}