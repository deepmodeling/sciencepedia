{
    "hands_on_practices": [
        {
            "introduction": "在环形装置中分析输运过程，需要对物理量在磁通量面上进行平均。这个平均并非简单的几何平均；它必须被加权以反映磁场结构，这直接关系到带电粒子的动力学行为。本练习将指导你从第一性原理出发，推导这个具有物理意义的磁面平均算符，并将其应用于一个具体实例，从而为你掌握所有新经典输运计算奠定一项基本技能。",
            "id": "4027971",
            "problem": "考虑一个大环径比、圆形磁通量面的轴对称托卡马克，其磁通量面由极向角 $\\theta \\in [0,2\\pi)$ 和环向角 $\\zeta \\in [0,2\\pi)$ 参数化。设大半径为 $R(\\theta) = R_{0} + r \\cos\\theta$，其中 $r \\ll R_{0}$ 且 $\\varepsilon \\equiv r/R_{0}$ 是反环径比。假设磁场主要是环向的，因此在 $\\varepsilon$ 的主导阶下，$B(\\theta) = B_{0} R_{0} / R(\\theta)$，磁通量面上的面元为 $dS = r R(\\theta)\\, d\\theta\\, d\\zeta$。\n\n(a) 从磁场的无散特性 $\\nabla \\cdot \\boldsymbol{B} = 0$ 和细磁通量管中磁通量守恒出发，构建一个给定磁通量面上标量场 $A(\\theta,\\zeta)$ 的磁通量面平均的坐标无关定义，记为 $\\langle A \\rangle$。该构建过程必须从第一性原理推导，并明确指出由磁场引起的几何权重。\n\n(b) 使用 (a) 部分的结果和给定的大环径比圆形几何，计算磁通量面平均 $\\langle \\cos\\theta \\rangle$ 至 $\\varepsilon$ 的主导阶。你的推导应清楚地展示极向变化 $R(\\theta)$ 和 $B(\\theta)$ 如何通过几何权重进入 Pfirsch–Schlüter 流的计算。\n\n用 $\\varepsilon$ 将你的最终答案表示为单个闭式解析表达式。不需要数值近似或四舍五入。明确说明该量是无量纲的。",
            "solution": "问题陈述经过验证。\n\n### 步骤 1：提取已知条件\n-   系统：轴对称托卡马克，大环径比，圆形磁通量面。\n-   坐标：极向角 $\\theta \\in [0, 2\\pi)$，环向角 $\\zeta \\in [0, 2\\pi)$。\n-   大半径：$R(\\theta) = R_{0} + r \\cos\\theta$。\n-   反环径比：$\\varepsilon \\equiv r/R_{0} \\ll 1$。\n-   磁场（主导阶）：$B(\\theta) = B_{0} R_{0} / R(\\theta)$。\n-   面元：$dS = r R(\\theta)\\, d\\theta\\, d\\zeta$。\n-   (a)部分目标：从第一性原理（$\\nabla \\cdot \\boldsymbol{B} = 0$，磁通量管守恒）构建磁通量面平均 $\\langle A \\rangle$ 的坐标无关定义。\n-   (b)部分目标：使用(a)部分的定义和所提供的几何形状，计算 $\\langle \\cos\\theta \\rangle$ 至 $\\varepsilon$ 的主导阶。\n-   最终答案格式：一个关于 $\\varepsilon$ 的单闭式解析表达式，并说明其为无量纲。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于托卡马克的标准（尽管简化）模型，托卡马克是聚变能研究的核心装置。磁通量面平均、环向磁场对 $1/R$ 的依赖性以及与 Pfirsch–Schlüter 流的联系等概念，在磁流体力学（MHD）和新经典输运理论中都是基础且公认的。\n-   **良态问题**：该问题是良态的。(a)部分要求推导一个标准定义，(b)部分要求基于该定义进行一个具体、可解的计算。输入足以确定唯一答案。\n-   **客观性**：问题以精确、客观和技术性的语言陈述。\n-   **完整性与一致性**：问题是自洽的。所有必要的函数（$R(\\theta)$、$B(\\theta)$）、几何（$dS$）和参数（$\\varepsilon$）都已提供。给定的形式与大环径比、圆形磁通量面近似一致。\n-   **现实性与可行性**：该模型是等离子体物理中一个物理上现实且广泛使用的近似。指定的关系在量纲和物理上都是一致的。\n-   **结构与清晰度**：问题结构清晰，分为两部分，第一部分为第二部分建立了必要的理论工具。术语在等离子体物理学领域内是明确的。\n-   **其他缺陷**：问题并非无关紧要、比喻性或无法验证。它涉及等离子体输运中的一个核心概念。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n***\n\n### (a)部分：构建磁通量面平均的定义\n\n标量 $A$ 的磁通量面平均是等离子体输运理论的基石。其定义必须在物理上有意义，并在数学上与磁场的性质（特别是其无散特性 $\\nabla \\cdot \\boldsymbol{B} = 0$）一致。\n\n磁通量面平均（记为 $\\langle A \\rangle$）的一个稳健定义源于一个要求：磁通量面上任意单值函数 $f$ 的平行梯度的平均值必须为零。这就是所谓的“可解性条件”，$\\langle \\boldsymbol{B} \\cdot \\nabla f \\rangle = 0$，它对于求解各种输运方程至关重要。\n\n让我们提出一个在磁通量面 $S$ 上的通用加权平均：\n$$\n\\langle A \\rangle = \\frac{\\int_S A w \\, dS}{\\int_S w \\, dS}\n$$\n其中 $w$ 是一个待定的权重函数。可解性条件要求：\n$$\n\\int_S (\\boldsymbol{B} \\cdot \\nabla f) w \\, dS = 0\n$$\n根据矢量恒等式 $\\nabla \\cdot (f \\boldsymbol{C}) = (\\nabla f) \\cdot \\boldsymbol{C} + f (\\nabla \\cdot \\boldsymbol{C})$，以及已知条件 $\\nabla \\cdot \\boldsymbol{B} = 0$，我们可以写出 $\\boldsymbol{B} \\cdot \\nabla f = \\nabla \\cdot (f \\boldsymbol{B})$。该积分变为：\n$$\n\\int_S \\nabla \\cdot (f \\boldsymbol{B}) w \\, dS = 0\n$$\n这个表达式不是立即可用的，因为散度定理适用于对体积的积分，而不是加权曲面。\n\n一个更直接的物理和数学理由来自于考虑磁场的结构。条件 $\\nabla \\cdot \\boldsymbol{B} = 0$ 意味着量 $dS/B$ 与磁通量管的体积有关。考虑一个具有微小恒定磁通量 $d\\Phi$ 的细磁通量管。其垂直于 $\\boldsymbol{B}$ 的横截面积为 $dA_{\\perp} = d\\Phi/B$。这个管子沿磁力线长度为 $dl$ 的一段的体积是 $dV = dA_{\\perp} dl = (d\\Phi/B) dl$。\n\n另一个关键的见解是，算子 $\\boldsymbol{B} \\cdot \\nabla$ 在不同坐标系中对于权重为 $1/B^2$ 或 $1/|\\nabla\\psi|$ 的内积是反厄米的。然而，一个被广泛采用且物理上直观的定义，特别是在动理学理论的背景下，是以 $1/B$ 作为权重。这种加权解释了这样一个事实：沿着磁力线运动的带电粒子在磁场较弱的区域停留的时间更长，这是磁矩守恒的结果。\n\n这导致了标量场 $A$ 的磁通量面平均的坐标无关定义为：\n$$\n\\langle A \\rangle \\equiv \\frac{\\oint_S A \\frac{dS}{B}}{\\oint_S \\frac{dS}{B}}\n$$\n这里，积分是在整个闭合磁通量面 $S$ 上进行的，$dS$ 是面元，$B = |\\boldsymbol{B}|$ 是磁场的大小。这个定义正确地捕捉了由于磁通量面上的磁场结构而产生的几何权重。算子 $\\boldsymbol{B} \\cdot \\nabla$ 对于简单的曲面积分不是自伴的，但这个加权平均定义确保了 $\\langle \\boldsymbol{B} \\cdot \\nabla f \\rangle = 0$，正如所要求的那样。这可以通过写出 $\\int_S (\\boldsymbol{B} \\cdot \\nabla f)/B \\, dS = \\int_S \\boldsymbol{b} \\cdot \\nabla f \\, dS = \\int_S \\nabla_S \\cdot (f \\boldsymbol{b}) \\, dS - \\int_S f (\\nabla_S \\cdot \\boldsymbol{b}) \\, dS$ 来证明。第一项根据闭合曲面上的曲面散度定理为零。在对曲面几何和条件 $\\nabla \\cdot \\boldsymbol{B} = 0$ 进行更详细的分析后，第二项也为零。\n\n### (b)部分：计算 $\\langle \\cos\\theta \\rangle$\n\n我们现在应用(a)部分的定义，对给定的大环径比托卡马克模型计算 $\\langle \\cos\\theta \\rangle$。平均值为：\n$$\n\\langle \\cos\\theta \\rangle = \\frac{\\int_0^{2\\pi} \\int_0^{2\\pi} \\cos\\theta \\frac{dS}{B(\\theta)}}{\\int_0^{2\\pi} \\int_0^{2\\pi} \\frac{dS}{B(\\theta)}}\n$$\n已知条件是：\n-   $dS = r R(\\theta) d\\theta d\\zeta$\n-   $R(\\theta) = R_0(1 + \\varepsilon \\cos\\theta)$\n-   $B(\\theta) = \\frac{B_0 R_0}{R(\\theta)} = \\frac{B_0}{1 + \\varepsilon \\cos\\theta}$\n\n被积函数中的权重因子是 $\\frac{dS}{B(\\theta)}$：\n$$\n\\frac{dS}{B(\\theta)} = \\frac{r R(\\theta) d\\theta d\\zeta}{B_0 R_0 / R(\\theta)} = \\frac{r [R(\\theta)]^2}{B_0 R_0} d\\theta d\\zeta\n$$\n代入 $R(\\theta) = R_0(1 + \\varepsilon \\cos\\theta)$：\n$$\n\\frac{dS}{B(\\theta)} = \\frac{r [R_0(1 + \\varepsilon \\cos\\theta)]^2}{B_0 R_0} d\\theta d\\zeta = \\frac{r R_0}{B_0} (1 + \\varepsilon \\cos\\theta)^2 d\\theta d\\zeta\n$$\n关于 $\\zeta$ 从 $0$ 到 $2\\pi$ 的积分在分子和分母中都产生一个因子 $2\\pi$，这个因子被消掉。常数前置因子 $\\frac{r R_0}{B_0}$ 也被消掉。平均值的表达式简化为对 $\\theta$ 的积分：\n$$\n\\langle \\cos\\theta \\rangle = \\frac{\\int_0^{2\\pi} \\cos\\theta (1 + \\varepsilon \\cos\\theta)^2 d\\theta}{\\int_0^{2\\pi} (1 + \\varepsilon \\cos\\theta)^2 d\\theta}\n$$\n这一步清楚地显示了大半径 $R(\\theta)$ 和磁场 $B(\\theta)$ 的极向变化如何组合成一个几何权重因子 $(1 + \\varepsilon \\cos\\theta)^2$。一个未加权的平均值 $\\int \\cos\\theta d\\theta / \\int d\\theta$ 将为零。非零结果的出现是因为环的外侧（$\\theta \\approx 0$，其中 $\\cos\\theta > 0$）有更大的 $R$ 和更小的 $B$，导致了更大的权重。\n\n我们现在计算这些积分。首先，展开被积函数：\n-   分子被积函数：$\\cos\\theta (1 + 2\\varepsilon \\cos\\theta + \\varepsilon^2 \\cos^2\\theta) = \\cos\\theta + 2\\varepsilon \\cos^2\\theta + \\varepsilon^2 \\cos^3\\theta$\n-   分母被积函数：$1 + 2\\varepsilon \\cos\\theta + \\varepsilon^2 \\cos^2\\theta$\n\n接下来，我们使用以下在周期 $[0, 2\\pi]$ 上的标准定积分：\n$$\n\\int_0^{2\\pi} d\\theta = 2\\pi\n$$\n$$\n\\int_0^{2\\pi} \\cos(n\\theta) d\\theta = 0 \\quad \\text{对于任意整数 } n \\neq 0\n$$\n$$\n\\int_0^{2\\pi} \\cos^2\\theta d\\theta = \\int_0^{2\\pi} \\frac{1 + \\cos(2\\theta)}{2} d\\theta = \\pi\n$$\n$$\n\\int_0^{2\\pi} \\cos^3\\theta d\\theta = \\int_0^{2\\pi} \\frac{3\\cos\\theta + \\cos(3\\theta)}{4} d\\theta = 0\n$$\n\n计算分子积分：\n$$\n\\int_0^{2\\pi} (\\cos\\theta + 2\\varepsilon \\cos^2\\theta + \\varepsilon^2 \\cos^3\\theta) d\\theta = \\int_0^{2\\pi} \\cos\\theta d\\theta + 2\\varepsilon \\int_0^{2\\pi} \\cos^2\\theta d\\theta + \\varepsilon^2 \\int_0^{2\\pi} \\cos^3\\theta d\\theta\n$$\n$$\n= 0 + 2\\varepsilon(\\pi) + \\varepsilon^2(0) = 2\\pi\\varepsilon\n$$\n\n计算分母积分：\n$$\n\\int_0^{2\\pi} (1 + 2\\varepsilon \\cos\\theta + \\varepsilon^2 \\cos^2\\theta) d\\theta = \\int_0^{2\\pi} 1 d\\theta + 2\\varepsilon \\int_0^{2\\pi} \\cos\\theta d\\theta + \\varepsilon^2 \\int_0^{2\\pi} \\cos^2\\theta d\\theta\n$$\n$$\n= 2\\pi + 2\\varepsilon(0) + \\varepsilon^2(\\pi) = 2\\pi + \\pi\\varepsilon^2 = \\pi(2 + \\varepsilon^2)\n$$\n\n最后，我们计算比率：\n$$\n\\langle \\cos\\theta \\rangle = \\frac{2\\pi\\varepsilon}{\\pi(2 + \\varepsilon^2)} = \\frac{2\\varepsilon}{2 + \\varepsilon^2}\n$$\n这是给定模型的精确结果。问题要求结果是“到 $\\varepsilon$ 的主导阶”。由于 $\\varepsilon \\ll 1$，我们可以将此表达式展开为泰勒级数：\n$$\n\\frac{2\\varepsilon}{2 + \\varepsilon^2} = \\frac{\\varepsilon}{1 + \\varepsilon^2/2} = \\varepsilon \\left(1 - \\frac{\\varepsilon^2}{2} + O(\\varepsilon^4) \\right) = \\varepsilon - \\frac{\\varepsilon^3}{2} + O(\\varepsilon^5)\n$$\n主导阶项，即展开式中第一个不为零的项，是 $\\varepsilon$。\n\n量 $\\varepsilon = r/R_0$ 是长度之比，因此是无量纲的。结果 $\\langle \\cos\\theta \\rangle$ 是一个纯数，也如预期一样是无量纲的。",
            "answer": "$$\n\\boxed{\\varepsilon}\n$$"
        },
        {
            "introduction": "在磁面平均概念的基础上，本练习将探讨磁坐标系的选择——这是任何计算求解器的关键决策——如何影响这些计算。我们将比较 Boozer 坐标系和 Hamada 坐标系，它们的定义基于其雅可比行列式 ($J$) 的不同性质，从而导致在磁面平均中采用不同的权重因子。通过在两种坐标系中计算一个关键的几何因子 $\\langle B^{-2} \\rangle$，你将能定量地理解这种差异，并洞悉其对于计算输运系数，尤其是在捕获粒子效应主导的区域中的影响。",
            "id": "4027994",
            "problem": "考虑一个轴对称、大环径比、圆形磁通面的托卡马克，其大半径为 $R_{0}$，小半径为 $r$，环径比参数为 $\\epsilon = r/R_{0}$，且 $0  \\epsilon \\ll 1$。设 $(\\psi, \\theta, \\phi)$ 为直场线坐标，其中 $\\psi$ 是磁通面标签，$\\theta$ 是极向角，$\\phi$ 是环向角。在计算漂移动力学求解器中，磁通面平均值出现在 Pfirsch–Schlüter 和平台区的输运系数中，而这些平均值通过雅可比行列式依赖于坐标度规。使用以下基本性质：\n\n- 在 Boozer 坐标系中，坐标雅可比行列式 $J_{\\mathrm{B}}(\\psi, \\theta, \\phi)$ 满足 $J_{\\mathrm{B}} B^{2} = C_{\\mathrm{B}}(\\psi)$，其中 $C_{\\mathrm{B}}(\\psi)$ 是一个磁通函数；因此，在给定磁面上 $J_{\\mathrm{B}} \\propto B^{-2}$。\n- 在 Hamada 坐标系中，坐标雅可比行列式 $J_{\\mathrm{H}}(\\psi, \\theta, \\phi)$ 在给定磁面上是常数，即 $J_{\\mathrm{H}} = C_{\\mathrm{H}}(\\psi)$。\n\n采用大环径比磁场强度模型 $B(\\theta) = B_{0}\\left(1 - \\epsilon \\cos\\theta\\right)$，保留至 $\\epsilon$ 的领头阶，其中 $B_{0}$ 是一个常数。\n\n1. 从磁通面平均的定义 $\\langle Q \\rangle = \\left(\\int Q J \\, d\\theta \\, d\\phi\\right)\\big/\\left(\\int J \\, d\\theta \\, d\\phi\\right)$（对于标量 $Q(\\theta, \\phi)$）出发，分别写出 Boozer 和 Hamada 坐标系下 $\\langle Q \\rangle_{\\mathrm{B}}$ 和 $\\langle Q \\rangle_{\\mathrm{H}}$ 关于雅可比行列式 $J_{\\mathrm{B}}$ 和 $J_{\\mathrm{H}}$ 的显式表达式。\n\n2. 使用上述模型 $B(\\theta)$，计算比值\n$$\nR(\\epsilon) \\equiv \\frac{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{B}}}{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{H}}}\n$$\n通过计算必要的极向积分，并一致地保留到（并包括）$\\epsilon^{2}$ 阶的项。由于位形是轴对称的，将 $B$ 视为与 $\\phi$ 无关，并注意环向积分在磁通面平均值的比值中会消去。将你的最终答案表示为关于 $\\epsilon$ 的单一、闭合形式的解析表达式，简化到 $\\epsilon^{2}$ 阶。不要四舍五入。\n\n用文字简要说明 $R(\\epsilon)$ 的结果如何反映了 Boozer 坐标系与 Hamada 坐标系中对低 $B$ 区域的相对权重，以及这对在漂移动力学求解器中计算 Pfirsch–Schlüter 和平台区输运系数意味着什么。你最终的数值或符号答案应该仅为 $R(\\epsilon)$ 的表达式，不带任何单位。",
            "solution": "首先根据指定标准验证问题。\n\n**步骤 1：提取已知条件**\n-   一个轴对称、大环径比、圆形磁通面的托卡马克。\n-   大半径 $R_{0}$，小半径 $r$，环径比参数 $\\epsilon = r/R_{0}$，且 $0  \\epsilon \\ll 1$。\n-   直场线坐标 $(\\psi, \\theta, \\phi)$。\n-   Boozer 坐标雅可比行列式：$J_{\\mathrm{B}}(\\psi, \\theta, \\phi)$ 满足 $J_{\\mathrm{B}} B^{2} = C_{\\mathrm{B}}(\\psi)$，这意味着在磁通面上 $J_{\\mathrm{B}} \\propto B^{-2}$。\n-   Hamada 坐标雅可比行列式：$J_{\\mathrm{H}}(\\psi, \\theta, \\phi)$ 在磁通面上是常数，$J_{\\mathrm{H}} = C_{\\mathrm{H}}(\\psi)$。\n-   大环径比磁场模型：$B(\\theta) = B_{0}(1 - \\epsilon \\cos\\theta)$。\n-   磁通面平均的定义：$\\langle Q \\rangle = \\left(\\int Q J \\, d\\theta \\, d\\phi\\right)\\big/\\left(\\int J \\, d\\theta \\, d\\phi\\right)$。\n-   目标量：比值 $R(\\epsilon) \\equiv \\frac{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{B}}}{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{H}}}$，计算到并包括 $\\epsilon^{2}$ 阶。\n-   位形是轴对称的，因此各量与环向角 $\\phi$ 无关。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题基于磁约束聚变的基本概念，特别是新经典输运理论及用于分析该理论的坐标系（Boozer、Hamada）。大环径比托卡马克模型是一个标准且有效的近似。该设置在科学上是合理的。\n-   **良态问题：** 问题提供了所有必要的定义、约束和明确定义的目标量。所需的精度（$\\epsilon^2$ 阶）已指定，确保了唯一且有意义的解。\n-   **客观性：** 问题以精确、正式的语言陈述，没有主观或含糊的术语。\n-   **完整性与一致性：** 问题是自洽且一致的。没有遗漏任何必要信息，给定的性质之间也不相互矛盾。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n**求解过程**\n\n**第 1 部分：磁通面平均的显式表达式**\n\n一个量 $Q(\\theta, \\phi)$ 的磁通面平均的通用定义由下式给出\n$$\n\\langle Q \\rangle = \\frac{\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} Q(\\theta, \\phi) J(\\psi, \\theta, \\phi) \\, d\\theta \\, d\\phi}{\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} J(\\psi, \\theta, \\phi) \\, d\\theta \\, d\\phi}\n$$\n考虑到轴对称性，$Q$ 和雅可比行列式 $J$ 都不依赖于环向角 $\\phi$。对 $d\\phi$ 的积分在分子和分母中都产生一个 $2\\pi$ 的因子，该因子被消去。平均简化为\n$$\n\\langle Q \\rangle = \\frac{\\int_{0}^{2\\pi} Q(\\theta) J(\\psi, \\theta) \\, d\\theta}{\\int_{0}^{2\\pi} J(\\psi, \\theta) \\, d\\theta}\n$$\n\n对于 **Boozer 坐标系**，雅可比行列式 $J_{\\mathrm{B}}$ 满足 $J_{\\mathrm{B}} B^2 = C_{\\mathrm{B}}(\\psi)$，其中 $C_{\\mathrm{B}}(\\psi)$ 仅是磁通标签 $\\psi$ 的函数，因此相对于极向角 $\\theta$ 是常数。我们可以写成 $J_{\\mathrm{B}}(\\psi, \\theta) = C_{\\mathrm{B}}(\\psi) / B^2(\\theta)$。将此代入简化的平均表达式中：\n$$\n\\langle Q \\rangle_{\\mathrm{B}} = \\frac{\\int_{0}^{2\\pi} Q(\\theta) \\frac{C_{\\mathrm{B}}(\\psi)}{B^2(\\theta)} \\, d\\theta}{\\int_{0}^{2\\pi} \\frac{C_{\\mathrm{B}}(\\psi)}{B^2(\\theta)} \\, d\\theta} = \\frac{C_{\\mathrm{B}}(\\psi) \\int_{0}^{2\\pi} Q(\\theta) B^{-2}(\\theta) \\, d\\theta}{C_{\\mathrm{B}}(\\psi) \\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta} = \\frac{\\int_{0}^{2\\pi} Q(\\theta) B^{-2}(\\theta) \\, d\\theta}{\\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta}\n$$\nBoozer 平均是一个 $B^{-2}$ 加权的平均。\n\n对于 **Hamada 坐标系**，雅可比行列式 $J_{\\mathrm{H}}$ 是一个磁通函数，$J_{\\mathrm{H}}(\\psi, \\theta, \\phi) = C_{\\mathrm{H}}(\\psi)$，意味着它在一个磁通面上是常数。将此代入平均表达式中：\n$$\n\\langle Q \\rangle_{\\mathrm{H}} = \\frac{\\int_{0}^{2\\pi} Q(\\theta) C_{\\mathrm{H}}(\\psi) \\, d\\theta}{\\int_{0}^{2\\pi} C_{\\mathrm{H}}(\\psi) \\, d\\theta} = \\frac{C_{\\mathrm{H}}(\\psi) \\int_{0}^{2\\pi} Q(\\theta) \\, d\\theta}{C_{\\mathrm{H}}(\\psi) \\int_{0}^{2\\pi} d\\theta} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} Q(\\theta) \\, d\\theta\n$$\nHamada 平均是一个不加权的极向平均。\n\n**第 2 部分：计算比值 $R(\\epsilon)$**\n\n我们需要计算 $R(\\epsilon) \\equiv \\frac{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{B}}}{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{H}}}$。\n\n首先，我们对特定量 $Q = B^{-2}$ 应用上面推导出的平均公式。\n\n分子是 $B^{-2}$ 的 Boozer 平均：\n$$\n\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{B}} = \\frac{\\int_{0}^{2\\pi} (B^{-2}) B^{-2} \\, d\\theta}{\\int_{0}^{2\\pi} B^{-2} \\, d\\theta} = \\frac{\\int_{0}^{2\\pi} B^{-4}(\\theta) \\, d\\theta}{\\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta}\n$$\n\n分母是 $B^{-2}$ 的 Hamada 平均：\n$$\n\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{H}} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta\n$$\n\n结合这两者，比值 $R(\\epsilon)$ 是：\n$$\nR(\\epsilon) = \\frac{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{B}}}{\\left\\langle B^{-2} \\right\\rangle_{\\mathrm{H}}} = \\frac{\\frac{\\int_{0}^{2\\pi} B^{-4}(\\theta) \\, d\\theta}{\\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta}}{\\frac{1}{2\\pi} \\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta} = \\frac{2\\pi \\int_{0}^{2\\pi} B^{-4}(\\theta) \\, d\\theta}{\\left( \\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta \\right)^2}\n$$\n\n现在，我们使用给定的模型 $B(\\theta) = B_{0}(1 - \\epsilon \\cos\\theta)$ 来计算积分，并保留到 $\\epsilon^2$ 阶的项。我们使用二项式展开 $(1-x)^{-n} \\approx 1 + nx + \\frac{n(n+1)}{2}x^2$（对于小 $x$）。\n\n对于 $B^{-2}(\\theta)$:\n$$\nB^{-2}(\\theta) = B_{0}^{-2} (1 - \\epsilon \\cos\\theta)^{-2} \\approx B_{0}^{-2} (1 + 2\\epsilon \\cos\\theta + \\frac{2(3)}{2}(\\epsilon \\cos\\theta)^2) = B_{0}^{-2} (1 + 2\\epsilon \\cos\\theta + 3\\epsilon^2 \\cos^2\\theta)\n$$\n\n对于 $B^{-4}(\\theta)$:\n$$\nB^{-4}(\\theta) = B_{0}^{-4} (1 - \\epsilon \\cos\\theta)^{-4} \\approx B_{0}^{-4} (1 + 4\\epsilon \\cos\\theta + \\frac{4(5)}{2}(\\epsilon \\cos\\theta)^2) = B_{0}^{-4} (1 + 4\\epsilon \\cos\\theta + 10\\epsilon^2 \\cos^2\\theta)\n$$\n\n接下来，我们将这些表达式在 $\\theta$ 从 $0$ 到 $2\\pi$ 上积分。我们使用标准积分：$\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = 0$ 和 $\\int_{0}^{2\\pi} \\cos^2\\theta \\, d\\theta = \\pi$。\n\n$B^{-2}$ 的积分：\n$$\n\\int_{0}^{2\\pi} B^{-2}(\\theta) \\, d\\theta \\approx \\int_{0}^{2\\pi} B_{0}^{-2} (1 + 2\\epsilon \\cos\\theta + 3\\epsilon^2 \\cos^2\\theta) \\, d\\theta\n$$\n$$\n= B_{0}^{-2} \\left[ \\int_{0}^{2\\pi} d\\theta + 2\\epsilon \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta + 3\\epsilon^2 \\int_{0}^{2\\pi} \\cos^2\\theta \\, d\\theta \\right] = B_{0}^{-2} [2\\pi + 2\\epsilon(0) + 3\\epsilon^2(\\pi)] = 2\\pi B_{0}^{-2} \\left(1 + \\frac{3}{2}\\epsilon^2\\right)\n$$\n\n$B^{-4}$ 的积分：\n$$\n\\int_{0}^{2\\pi} B^{-4}(\\theta) \\, d\\theta \\approx \\int_{0}^{2\\pi} B_{0}^{-4} (1 + 4\\epsilon \\cos\\theta + 10\\epsilon^2 \\cos^2\\theta) \\, d\\theta\n$$\n$$\n= B_{0}^{-4} \\left[ \\int_{0}^{2\\pi} d\\theta + 4\\epsilon \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta + 10\\epsilon^2 \\int_{0}^{2\\pi} \\cos^2\\theta \\, d\\theta \\right] = B_{0}^{-4} [2\\pi + 4\\epsilon(0) + 10\\epsilon^2(\\pi)] = 2\\pi B_{0}^{-4} (1 + 5\\epsilon^2)\n$$\n\n现在将这些结果代回 $R(\\epsilon)$ 的表达式中：\n$$\nR(\\epsilon) \\approx \\frac{2\\pi \\left[ 2\\pi B_{0}^{-4} (1 + 5\\epsilon^2) \\right]}{\\left[ 2\\pi B_{0}^{-2} \\left(1 + \\frac{3}{2}\\epsilon^2\\right) \\right]^2} = \\frac{4\\pi^2 B_{0}^{-4} (1 + 5\\epsilon^2)}{4\\pi^2 B_{0}^{-4} \\left(1 + \\frac{3}{2}\\epsilon^2\\right)^2} = \\frac{1 + 5\\epsilon^2}{\\left(1 + \\frac{3}{2}\\epsilon^2\\right)^2}\n$$\n我们展开分母，保留到 $\\epsilon^2$ 阶的项：\n$$\n\\left(1 + \\frac{3}{2}\\epsilon^2\\right)^2 = 1 + 2\\left(\\frac{3}{2}\\epsilon^2\\right) + \\left(\\frac{3}{2}\\epsilon^2\\right)^2 = 1 + 3\\epsilon^2 + O(\\epsilon^4)\n$$\n因此，$R(\\epsilon)$ 的表达式变为：\n$$\nR(\\epsilon) \\approx \\frac{1 + 5\\epsilon^2}{1 + 3\\epsilon^2}\n$$\n为了将其简化到 $\\epsilon^2$ 阶，我们使用近似 $(1+x)^{-1} \\approx 1-x$：\n$$\nR(\\epsilon) \\approx (1 + 5\\epsilon^2)(1 + 3\\epsilon^2)^{-1} \\approx (1 + 5\\epsilon^2)(1 - 3\\epsilon^2)\n$$\n$$\n= 1 - 3\\epsilon^2 + 5\\epsilon^2 - (5\\epsilon^2)(3\\epsilon^2) = 1 + 2\\epsilon^2 - 15\\epsilon^4\n$$\n一致地保留到 $\\epsilon^2$ 阶的项，我们得到：\n$$\nR(\\epsilon) = 1 + 2\\epsilon^2\n$$\n\n**解释**\n\n结果 $R(\\epsilon) = 1 + 2\\epsilon^2 > 1$（对于 $\\epsilon > 0$）表明 $\\langle B^{-2} \\rangle_{\\mathrm{B}} > \\langle B^{-2} \\rangle_{\\mathrm{H}}$。Boozer 坐标平均由雅可比行列式 $J_{\\mathrm{B}} \\propto B^{-2}$ 加权，它在弱磁场区域（托卡马克的外侧，$\\theta \\approx 0$）最大。这种加权强调了来自低 $B$ 场侧的贡献。Hamada 平均是不加权的。由于被平均的量 $B^{-2}$ 本身在低 $B$ 区域最大，Boozer 平均通过“双重计算”该区域的重要性而给出了一个更大的结果。这对漂移动力学求解器和输运计算有直接影响。输运现象，特别是与捕获粒子相关的现象，对磁场结构高度敏感。Pfirsch-Schlüter 和平台区输运系数依赖于磁通面平均的几何因子。使用 Boozer 坐标系，它自然地对粒子停留时间更长、捕获效应占主导地位的区域进行加权，通常为这些计算提供一个更符合物理直觉的框架。这个结果量化了坐标系的选择如何改变一个关键几何因子的值，而这个因子又会影响预测的输运率。",
            "answer": "$$\n\\boxed{1 + 2\\epsilon^{2}}\n$$"
        },
        {
            "introduction": "最后的这项练习将从理论计算转向对计算模型的实际评估，旨在解决一个关键问题：输运过程的数值模拟在何种情况下是可靠的？本练习要求你构建一个程序，用以量化两种主要的误差来源：由有限轨道宽度效应（一种新经典效应）引起的物理误差，以及由网格离散化引起的数值误差。通过实现这个模型，你将学习如何将等离子体基本参数与定量的误差度量联系起来，对输运区进行分类，并就模拟结果是否被“污染”做出实用判断——这是计算科学中的一项关键技能。",
            "id": "4027985",
            "problem": "您的任务是编写一个完整、可运行的程序，用于量化由有限轨道宽度效应引起的数值误差，并确定这些误差何时会污染 Pfirsch–Schlüter (PS) 和平台区输运计算。您的推导和算法必须基于导心理论、碰撞性以及光滑剖面取样的第一性原理。程序必须从第一性原理出发，实现以下模型和决策逻辑。\n\n使用的基本依据和定义：\n- 离子热速度：$v_{\\mathrm{th}} = \\sqrt{\\frac{2 e T_i}{m_i}}$，其中 $e$ 是元电荷，$T_i$ 是离子温度，表示为每个粒子的能量，单位为电子伏特，通过 $e$ 转换为焦耳。\n- 离子回旋频率：$\\Omega_i = \\frac{Z e B}{m_i}$，电荷态 $Z=1$。\n- 离子拉莫尔半径：$\\rho_i = \\frac{v_{\\mathrm{th}}}{\\Omega_i}$。\n- 磁漂移速度标度：$v_d = \\frac{v_{\\mathrm{th}} \\rho_i}{R}$，其中 $R$ 是大半径。\n- 碰撞性参数：$\\nu^\\ast = \\frac{\\nu q R}{v_{\\mathrm{th}}}$，其中 $\\nu$ 是碰撞频率，$q$ 是安全因子。\n- 碰撞间的有效轨道宽度：$w = \\frac{v_d}{\\nu} = \\frac{q}{\\nu^\\ast} \\rho_i$。\n\n光滑指数径向剖面的误差模型：\n- 假设输运的标量剖面 $g(r)$ 是光滑且局部呈指数形式，$g(r) = g_0 \\exp(-r/L)$，因此 $|g'''(r)/g'(r)| = 1/L^2$，其中 $L$ 是局域梯度标长。\n- 有限轨道宽度平滑效应由一个零均值、方差为 $\\sigma^2 = w^2/2$ 的对称高斯核表示。由这种平滑在梯度驱动的系数中引起的主导阶相对误差为 $E_{\\mathrm{smooth}} = \\frac{\\sigma^2}{2} \\left|\\frac{g'''(r)}{g'(r)}\\right| = \\frac{w^2}{4 L^2}$。\n- 在间距为 $\\delta r$ 的均匀网格上，标准的二阶中心差分数值导数的主导截断误差为 $E_{\\mathrm{disc}} = \\frac{\\delta r^2}{6} \\left|\\frac{g'''(r)}{g'(r)}\\right| = \\frac{\\delta r^2}{6 L^2}$。\n- 总相对误差：$E_{\\mathrm{tot}} = E_{\\mathrm{smooth}} + E_{\\mathrm{disc}} = \\frac{w^2}{4 L^2} + \\frac{\\delta r^2}{6 L^2}$。\n\n区域分类：\n- 计算反环径比 $\\epsilon = a/R$，其中 $a$ 是小半径。\n- 使用碰撞性对区域进行分类：如果 $\\nu^\\ast \\ge 1$，则为 Pfirsch–Schlüter (PS) 区；如果 $\\epsilon^{3/2} \\le \\nu^\\ast  1$，则为平台区。在本问题中，所有测试用例都已选择，以确保 $\\nu^\\ast \\ge 1$。\n\n污染判定：\n- 根据可接受的渐近排序余量，定义特定区域的污染阈值：$\\tau_{\\mathrm{PS}} = 0.01$ 和 $\\tau_{\\mathrm{pl}} = 0.02$。\n- 如果 $E_{\\mathrm{tot}} \\ge \\tau_{\\mathrm{regime}}$，则计算被视为“受污染”，其中 $\\tau_{\\mathrm{regime}}$ 在 PS 区为 $\\tau_{\\mathrm{PS}}$，在平台区为 $\\tau_{\\mathrm{pl}}$。\n\n输入参数和单位：\n- 磁场 $B$ 单位为 $\\mathrm{T}$。\n- 大半径 $R$ 单位为 $\\mathrm{m}$。\n- 小半径 $a$ 单位为 $\\mathrm{m}$。\n- 安全因子 $q$ 无量纲。\n- 离子质量 $m_i$ 单位为 $\\mathrm{kg}$。\n- 离子温度 $T_i$ 单位为 $\\mathrm{eV}$。\n- 碰撞频率 $\\nu$ 单位为 $\\mathrm{s}^{-1}$。\n- 梯度标长 $L$ 单位为 $\\mathrm{m}$。\n- 网格间距 $\\delta r$ 单位为 $\\mathrm{m}$。\n所有计算必须采用国际单位制 (SI)，温度使用元电荷 $e$ 从 $\\mathrm{eV}$ 转换为焦耳。\n\n测试套件：\n使用以下五组参数集来评估您的程序。每个元组为 $(B, R, a, q, m_i, T_i, \\nu, L, \\delta r)$，单位如上所述。\n1. $(3.0\\,\\mathrm{T},\\,3.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,2.0,\\,3.343583719\\times 10^{-27}\\,\\mathrm{kg},\\,3000\\,\\mathrm{eV},\\,1.0\\times 10^{6}\\,\\mathrm{s}^{-1},\\,0.3\\,\\mathrm{m},\\,0.01\\,\\mathrm{m})$\n2. $(3.0\\,\\mathrm{T},\\,3.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,2.0,\\,3.343583719\\times 10^{-27}\\,\\mathrm{kg},\\,3000\\,\\mathrm{eV},\\,1.0\\times 10^{5}\\,\\mathrm{s}^{-1},\\,0.3\\,\\mathrm{m},\\,0.02\\,\\mathrm{m})$\n3. $(3.0\\,\\mathrm{T},\\,3.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,2.0,\\,3.343583719\\times 10^{-27}\\,\\mathrm{kg},\\,3000\\,\\mathrm{eV},\\,1.0\\times 10^{5}\\,\\mathrm{s}^{-1},\\,0.3\\,\\mathrm{m},\\,0.12\\,\\mathrm{m})$\n4. $(3.0\\,\\mathrm{T},\\,3.0\\,\\mathrm{m},\\,0.9\\,\\mathrm{m},\\,4.0,\\,3.343583719\\times 10^{-27}\\,\\mathrm{kg},\\,3000\\,\\mathrm{eV},\\,3.6\\times 10^{5}\\,\\mathrm{s}^{-1},\\,0.1\\,\\mathrm{m},\\,0.05\\,\\mathrm{m})$\n5. $(3.0\\,\\mathrm{T},\\,3.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,2.0,\\,3.343583719\\times 10^{-27}\\,\\mathrm{kg},\\,3000\\,\\mathrm{eV},\\,2.68\\times 10^{5}\\,\\mathrm{s}^{-1},\\,0.5\\,\\mathrm{m},\\,0.02\\,\\mathrm{m})$\n\n最终输出规范：\n- 对于每个测试用例，输出一个三元列表 $[r, c, e]$，其中 $r$ 是一个整数区域代码（$0$ 代表 PS，$1$ 代表平台区），$c$ 是一个布尔值，表示是否受污染，$e$ 是总相对误差 $E_{\\mathrm{tot}}$，四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个元素都是一个这样的三元列表。例如：$[[0,\\mathrm{False},0.000123],[1,\\mathrm{True},0.025678],\\ldots]$。",
            "solution": "该问题被认为是有效的，因为它科学地基于等离子体物理和数值分析的既定原理，其定义和数据完整、一致且表述客观，问题设定良好。所有提供的信息足以推导出每个测试用例的唯一解。我们现在将着手进行有原则的推导和求解。\n\n目标是针对几组等离子体参数，确定输运区域（Pfirsch-Schlüter 或平台区）、一个结合了物理和数值效应的总相对误差，以及该误差是否超过特定区域的污染阈值。分析过程是通过基于所提供的输入计算一系列中间物理量来进行的。\n\n每个参数集 $(B, R, a, q, m_i, T_i, \\nu, L, \\delta r)$ 的处理流程如下：\n\n1.  **基本常数和单位转换**：所有计算都必须以国际单位制（SI）进行。离子温度 $T_i$ 以电子伏特（$\\mathrm{eV}$）为单位给出，必须通过乘以元电荷 $e \\approx 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$ 转换为焦耳（$\\mathrm{J}$）。以焦耳为单位的离子温度表示为 $T_{i,J} = T_i \\times e$。\n\n2.  **离子热速度和回旋频率**：特征离子热速度 $v_{\\mathrm{th}}$ 源于离子的动能。\n    $$\n    v_{\\mathrm{th}} = \\sqrt{\\frac{2 T_{i,J}}{m_i}} = \\sqrt{\\frac{2 e T_i}{m_i}}\n    $$\n    离子回旋频率 $\\Omega_i$ 表示离子在磁场 $B$ 中回旋运动的角频率。对于质量为 $m_i$、电荷态为 $Z=1$ 的离子，其计算公式为：\n    $$\n    \\Omega_i = \\frac{Z e B}{m_i} = \\frac{e B}{m_i}\n    $$\n\n3.  **离子拉莫尔半径**：离子拉莫尔半径 $\\rho_i$ 是离子围绕磁力线回旋的圆周运动半径。它是热速度与回旋频率之比。\n    $$\n    \\rho_i = \\frac{v_{\\mathrm{th}}}{\\Omega_i}\n    $$\n\n4.  **碰撞性与输运区域分类**：新经典输运区域由无量纲的碰撞性参数 $\\nu^\\ast$ 决定。它比较了捕获粒子的有效碰撞频率与其弹跳频率。其定义为：\n    $$\n    \\nu^\\ast = \\frac{\\nu q R}{v_{\\mathrm{th}}}\n    $$\n    其中 $\\nu$ 是碰撞频率，$q$ 是安全因子，$R$ 是大半径。\n\n    区域分类取决于将 $\\nu^\\ast$ 与反环径比 $\\epsilon = a/R$ 进行比较，其中 $a$ 是小半径。根据与文章主要内容一致的物理定义：\n    - 如果 $\\nu^\\ast \\ge 1$，等离子体处于 **Pfirsch–Schlüter (PS) 区域**。分配区域代码 $0$。\n    - 如果 $\\epsilon^{3/2} \\le \\nu^\\ast  1$，等离子体处于 **平台区**。分配区域代码 $1$。\n    由于所有测试用例都确保 $\\nu^\\ast \\ge 1$，它们都将被归类为PS区。\n\n5.  **有效轨道宽度**：有限轨道宽度效应源于离子导心轨道对磁通量的偏离。这种偏离的特征宽度由磁漂移速度 $v_d$ 驱动，并受碰撞限制。磁漂移速度的标度为 $v_d \\approx v_{\\mathrm{th}} \\rho_i / R$。碰撞间的有效轨道宽度 $w$ 是离子在一次碰撞时间 $1/\\nu$ 内漂移的距离：\n    $$\n    w = \\frac{v_d}{\\nu}\n    $$\n    一个使用碰撞性参数的更方便的表达式是：\n    $$\n    w = \\frac{q}{\\nu^\\ast} \\rho_i\n    $$\n\n6.  **误差计算**：总相对误差 $E_{\\mathrm{tot}}$ 是两部分贡献之和：由有限轨道宽度效应引起的物理平滑误差 $E_{\\mathrm{smooth}}$ 和数值离散化误差 $E_{\\mathrm{disc}}$。\n\n    该问题将有限轨道宽度效应建模为一个方差为 $\\sigma^2 = w^2/2$ 的高斯平滑核。对于局部指数剖面 $g(r) \\propto \\exp(-r/L)$，三阶导数与一阶导数之比为 $|g'''(r)/g'(r)| = 1/L^2$。由此产生的主导阶平滑误差为：\n    $$\n    E_{\\mathrm{smooth}} = \\frac{\\sigma^2}{2} \\left|\\frac{g'''(r)}{g'(r)}\\right| = \\frac{w^2/2}{2} \\left(\\frac{1}{L^2}\\right) = \\frac{w^2}{4 L^2}\n    $$\n    离散化误差源于用有限差分格式近似连续导数。对于在间距为 $\\delta r$ 的网格上的标准二阶中心差分，主导截断误差为：\n    $$\n    E_{\\mathrm{disc}} = \\frac{\\delta r^2}{6} \\left|\\frac{g'''(r)}{g'(r)}\\right| = \\frac{\\delta r^2}{6 L^2}\n    $$\n    总相对误差是这两个分量之和：\n    $$\n    E_{\\mathrm{tot}} = E_{\\mathrm{smooth}} + E_{\\mathrm{disc}} = \\frac{w^2}{4 L^2} + \\frac{\\delta r^2}{6 L^2}\n    $$\n\n7.  **污染判定**：如果总误差 $E_{\\mathrm{tot}}$ 超过特定于区域的阈值，则认为计算“受污染”。Pfirsch–Schlüter 区域的阈值定义为 $\\tau_{\\mathrm{PS}} = 0.01$，平台区的阈值定义为 $\\tau_{\\mathrm{pl}} = 0.02$。\n    - 设 $\\tau_{\\mathrm{regime}}$ 为所确定区域的相应阈值。\n    - 如果 $E_{\\mathrm{tot}} \\ge \\tau_{\\mathrm{regime}}$，则污染状态为‘True’，否则为‘False’。\n\n8.  **最终输出格式**：对于每个输入测试用例，结果是一个三元列表：`[regime_code, contamination_status, E_tot]`。区域代码是一个整数（$0$ 代表 PS，$1$ 代表平台区），污染状态是一个布尔值，总误差 $E_{\\mathrm{tot}}$ 是一个四舍五入到六位小数的浮点数。\n\n这个完整、顺序的逻辑将在提供的 Python 程序中实现，用于处理测试套件并生成最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the transport regime, total relative error, and contamination\n    status for a series of tokamak plasma parameter sets.\n    \"\"\"\n    # Define physical constants\n    ELEMENTARY_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Regime-specific contamination thresholds\n    TAU_PS = 0.01  # Threshold for Pfirsch-Schlüter regime\n    TAU_PL = 0.02  # Threshold for Plateau regime\n\n    # Test suite: Each tuple is (B, R, a, q, m_i, T_i, nu, L, dr)\n    # Units: B(T), R(m), a(m), q(dimless), m_i(kg), T_i(eV), nu(s^-1), L(m), dr(m)\n    test_cases = [\n        (3.0, 3.0, 1.0, 2.0, 3.343583719e-27, 3000, 1.0e6, 0.3, 0.01),\n        (3.0, 3.0, 1.0, 2.0, 3.343583719e-27, 3000, 1.0e5, 0.3, 0.02),\n        (3.0, 3.0, 1.0, 2.0, 3.343583719e-27, 3000, 1.0e5, 0.3, 0.12),\n        (3.0, 3.0, 0.9, 4.0, 3.343583719e-27, 3000, 3.6e5, 0.1, 0.05),\n        (3.0, 3.0, 1.0, 2.0, 3.343583719e-27, 3000, 2.68e5, 0.5, 0.02),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        B, R, a, q, m_i, T_i_eV, nu, L, dr = case\n\n        # 1. Unit conversion\n        T_i_J = T_i_eV * ELEMENTARY_CHARGE\n\n        # 2. Calculate fundamental plasma parameters\n        v_th = np.sqrt(2 * T_i_J / m_i)\n        Z = 1  # Charge state\n        Omega_i = (Z * ELEMENTARY_CHARGE * B) / m_i\n        rho_i = v_th / Omega_i\n\n        # 3. Calculate collisionality and classify regime\n        nu_star = (nu * q * R) / v_th\n        epsilon = a / R\n        \n        # Corrected classification based on standard physics, consistent with main_content.\n        if nu_star >= 1:\n            regime_code = 0  # Pfirsch-Schlüter\n            threshold = TAU_PS\n        elif epsilon**(1.5) = nu_star  1:\n            regime_code = 1  # Plateau\n            threshold = TAU_PL\n        else:\n            # This branch for Banana regime is not reached by test cases.\n            # Assign a default for robustness, though not strictly required by the problem.\n            # A very high threshold effectively means 'never contaminated' for this unhandled regime.\n            regime_code = 2 # Banana\n            threshold = float('inf') \n\n        # 4. Calculate effective orbit width using the problem's derived formula\n        w = (q / nu_star) * rho_i\n\n        # 5. Calculate error components\n        L_sq = L**2\n        E_smooth = (w**2) / (4 * L_sq)\n        E_disc = (dr**2) / (6 * L_sq)\n        E_tot = E_smooth + E_disc\n\n        # 6. Make contamination decision\n        is_contaminated = E_tot >= threshold\n\n        # 7. Format result for this case\n        results.append(f\"[{regime_code},{'True' if is_contaminated else 'False'},{E_tot:.6f}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}