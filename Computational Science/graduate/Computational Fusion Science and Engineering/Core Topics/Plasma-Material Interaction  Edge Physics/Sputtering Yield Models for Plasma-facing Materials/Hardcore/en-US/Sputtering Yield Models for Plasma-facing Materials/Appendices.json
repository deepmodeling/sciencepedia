{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex simulations, a solid grasp of the underlying physics is essential. This first practice challenges you to reason from the first principles of two-body collisions to predict the fundamental characteristics of physical sputtering. By analyzing the kinematics of energy transfer between an incident ion and a target atom, you will develop an intuition for the sputtering threshold energy and the behavior of the yield curve just above this threshold .",
            "id": "4047094",
            "problem": "Consider normal-incidence deuterium ions on a tungsten surface, with tungsten’s surface binding energy $U_0 = 8.7~\\mathrm{eV}$. The sputtering threshold energy $E_{th}$ is the minimum incident energy $E$ at which a surface atom can be ejected, and the sputtering yield $Y(E)$ is the number of ejected target atoms per incident ion. Starting from first principles relevant to ion–solid interactions, namely two-body elastic collision kinematics, energy conservation, and the dominance of nuclear stopping at low energy for light ions on heavy targets, choose the option that most accurately outlines the correct conceptual steps to estimate $E_{th}$ for deuterium on tungsten and the qualitative shape of $Y(E)$ for $E$ just above $E_{th}$.\n\nA. Estimate $E_{th}$ by using two-body elastic collision kinematics to obtain the maximum energy transfer fraction $f(m,M)$ from a projectile of mass $m$ to a target atom of mass $M$, then require that a near-surface recoil can overcome $U_0$ after accounting for geometric and cascade inefficiencies via a factor $\\eta$ (with $\\eta \\lesssim 1$), leading to $E_{th}$ of order $10^2~\\mathrm{eV}$ for deuterium on tungsten. For $E$ just above $E_{th}$, argue from linear collision cascade theory (nuclear stopping–controlled) that $Y(E)$ emerges from zero with a steep, convex onset characteristic of a low-order power in $(E - E_{th})$, reflecting the vanishing phase space of outward recoils near threshold and the rapid increase of near-surface energy deposition.\n\nB. Estimate $E_{th}$ by equating the incident energy directly to $U_0$, so $E_{th} \\approx U_0 = 8.7~\\mathrm{eV}$. For $E$ just above $E_{th}$, $Y(E)$ is approximately linear in $E$ with a slope governed by electronic stopping, since electronic energy loss dominates the onset of sputtering in metals.\n\nC. Estimate $E_{th}$ from thermodynamic heating: the incident ion’s energy raises the local lattice temperature until surface atoms surpass $U_0$ through thermal activation, so $E_{th}$ follows an Arrhenius-type criterion controlled by $U_0$. Near $E_{th}$, $Y(E)$ increases exponentially with $E$, reflecting a transition over an activation barrier.\n\nD. Estimate $E_{th}$ using two-body collisions but assume the projectile and target masses are comparable, so the energy transfer fraction is large. Conclude $E_{th}$ is of order $10^1~\\mathrm{eV}$ for deuterium on tungsten. Near $E_{th}$, $Y(E)$ shows a concave-down onset due to shadowing by the surface, with a rapid approach to a plateau once $E  E_{th}$.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Incident particles: normal-incidence deuterium ions.\n- Target material: tungsten surface.\n- Surface binding energy of tungsten: $U_0 = 8.7~\\mathrm{eV}$.\n- Definition of sputtering threshold energy, $E_{th}$: minimum incident energy $E$ to eject a surface atom.\n- Definition of sputtering yield, $Y(E)$: number of ejected target atoms per incident ion.\n- Required principles for derivation:\n    1. Two-body elastic collision kinematics.\n    2. Energy conservation.\n    3. Dominance of nuclear stopping at low energy for light ions on heavy targets.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically sound and well-posed.\n- **Scientific Grounding:** The problem is set within the established framework of ion-solid interactions and physical sputtering, a critical topic in plasma physics and materials science for fusion applications. The concepts of surface binding energy, collision kinematics, and nuclear stopping are fundamental to this field. The specific system of deuterium on tungsten is a canonical and extensively studied case. The provided value for $U_0 = 8.7~\\mathrm{eV}$ is a reasonable approximation for the heat of sublimation of tungsten, which is the standard proxy for surface binding energy in sputtering models. The premise that nuclear stopping (elastic collisions with atomic nuclei) governs sputtering at low energies is correct, particularly for light ions on heavy targets where electronic stopping (inelastic energy loss to electrons) is less effective at causing atomic displacements.\n- **Well-Posedness  Objectivity:** The question asks for the correct conceptual pathway to estimate $E_{th}$ and describe the qualitative behavior of $Y(E)$ near the threshold. It is phrased objectively and provides sufficient physical context to determine a unique, correct conceptual approach among the choices. It does not require a precise numerical answer but rather an understanding of the underlying physical mechanisms.\n- **Flaw Analysis:**\n    - The problem does not violate any scientific principles.\n    - It is not metaphorical or irrelevant; it is a core problem in its field.\n    - It is not incomplete or contradictory for a conceptual question.\n    - The scenario is physically realistic.\n    - The question is structured to have a unique answer based on established theory.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution process will now proceed.\n\n### Derivation and Option Analysis\n\nThe problem asks for the conceptual steps to estimate the sputtering threshold energy $E_{th}$ and the qualitative shape of the sputtering yield $Y(E)$ near this threshold for deuterium (D) ions incident on a tungsten (W) surface.\n\n**1. Estimation of the Sputtering Threshold Energy, $E_{th}$**\n\nPhysical sputtering is a collisional process. An incident ion of mass $m$ and energy $E$ strikes a target of atoms with mass $M$. Through a sequence of binary collisions (a collision cascade), energy is transferred to the target atoms. For a surface atom to be ejected (sputtered), it must receive a minimum kinetic energy greater than its surface binding energy, $U_0$, in a direction with a component normal to and out of the surface.\n\nThe first crucial step is to analyze the energy transfer in a single binary elastic collision. According to classical mechanics, the maximum energy $T_{max}$ transferred from a projectile of mass $m$ to a stationary target atom of mass $M$ in a head-on collision is:\n$$T_{max} = \\gamma E$$\nwhere $\\gamma$ is the maximum energy transfer factor, given by:\n$$\\gamma = \\frac{4mM}{(m+M)^2}$$\nFor the given system:\n- Projectile: Deuterium ($m \\approx 2.0~\\mathrm{u}$)\n- Target: Tungsten ($M \\approx 183.8~\\mathrm{u}$)\n\nThe mass ratio is $m/M \\approx 2.0/183.8 \\ll 1$. The energy transfer is very inefficient. Let's calculate $\\gamma$:\n$$\\gamma = \\frac{4(2.0)(183.8)}{(2.0 + 183.8)^2} = \\frac{1470.4}{185.8^2} \\approx \\frac{1470.4}{34521.6} \\approx 0.0426$$\nThis means that in a single, optimal (head-on) collision, a deuterium ion can transfer only about $4.3\\%$ of its energy to a tungsten atom.\n\nFor sputtering to occur, a surface atom must be ejected. The simplest possible condition is that the incident ion transfers at least $U_0$ to a surface atom. Due to the inefficiency of energy transfer, the minimum incident energy $E$ required to do this would be $E_{th} = U_0 / \\gamma$.\n$$E_{th} \\approx \\frac{U_0}{\\gamma} \\approx \\frac{8.7~\\mathrm{eV}}{0.0426} \\approx 204~\\mathrm{eV}$$\nThis provides an initial order-of-magnitude estimate. In reality, the process is more complex:\n- The first collision is typically sub-surface.\n- Multiple collisions are usually involved (a cascade).\n- The final collision that ejects the atom is unlikely to be perfectly efficient or directed. For light ions on heavy targets, a common high-yield sequence involves the light ion backscattering from a deeper atom and then striking a surface atom on its way out.\n\nThese complexities (cascade development, geometric factors) mean that the actual energy required is different from the simple estimate. These effects are often modeled by introducing an inefficiency factor, let's call it $\\eta$, such that a more refined estimate might look like $E_{th} \\approx U_0 / (\\eta \\gamma)$. Empirically and through more detailed models (e.g., the Bohdansky formula, $E_{th} = U_0 / [\\gamma(1-\\gamma)]$), the threshold energy for D on W is found to be in the range of $100-200~\\mathrm{eV}$. Therefore, the correct conceptual approach is to recognize the poor energy transfer (small $\\gamma$) and conclude that $E_{th}$ must be significantly larger than $U_0$, on the order of $10^2~\\mathrm{eV}$.\n\n**2. Qualitative Shape of the Sputtering Yield $Y(E)$ near $E_{th}$**\n\nThe sputtering yield $Y(E)$ is fundamentally linked to the amount of energy deposited by the ion and the subsequent collision cascade into the near-surface region, leading to atomic motion. This energy deposition process is quantified by the nuclear stopping power, $S_n(E)$.\n\n- At $E = E_{th}$, the yield is by definition zero: $Y(E_{th}) = 0$.\n- For energies just above $E_{th}$, $E  E_{th}$, sputtering becomes possible. However, the phase space of collision sequences that can lead to an ejection event is extremely small. Only a very specific and unlikely chain of collisions can channel enough energy to a surface atom in the right direction.\n- As $E$ increases further above $E_{th}$, the available energy for the cascade increases. This rapidly expands the volume of phase space for successful sputtering events: a wider range of impact parameters, collision angles, and cascade generations can contribute.\n- Consequently, the yield $Y(E)$ does not rise linearly from zero. It starts with a very low slope and accelerates. This shape is described as **convex** (or concave-up).\n- Theoretical models and empirical fits often describe this near-threshold behavior with a power law of the form:\n$$Y(E) \\propto \\left(E - E_{th}\\right)^n$$\nor\n$$Y(E) \\propto \\left(1 - \\sqrt{\\frac{E_{th}}{E}}\\right)^p$$\nwhere the exponents $n$ and $p$ are typically greater than $1$ (e.g., $n \\approx 2$). This functional form captures the convex, non-linear onset of the yield curve, which stems from the physics of nuclear stopping and the statistical nature of the collision cascade near its energetic limit.\n\n### Evaluation of Options\n\n**A. Estimate $E_{th}$ by using two-body elastic collision kinematics to obtain the maximum energy transfer fraction $f(m,M)$ from a projectile of mass $m$ to a target atom of mass $M$, then require that a near-surface recoil can overcome $U_0$ after accounting for geometric and cascade inefficiencies via a factor $\\eta$ (with $\\eta \\lesssim 1$), leading to $E_{th}$ of order $10^2~\\mathrm{eV}$ for deuterium on tungsten. For $E$ just above $E_{th}$, argue from linear collision cascade theory (nuclear stopping–controlled) that $Y(E)$ emerges from zero with a steep, convex onset characteristic of a low-order power in $(E - E_{th})$, reflecting the vanishing phase space of outward recoils near threshold and the rapid increase of near-surface energy deposition.**\n- This option correctly identifies the central role of the small energy transfer fraction ($\\gamma$, here denoted $f(m,M)$) from two-body kinematics. It correctly concludes that this inefficiency leads to an $E_{th}$ much larger than $U_0$, on the order of $10^2~\\mathrm{eV}$. It correctly describes the role of nuclear stopping in governing the yield near threshold. It correctly characterizes the shape of $Y(E)$ as a \"convex onset\" (concave-up), representing a non-linear rise from zero, and correctly relates this to a power-law dependence on $(E - E_{th})$ and the underlying physics of phase space and energy deposition.\n- **Verdict: Correct**\n\n**B. Estimate $E_{th}$ by equating the incident energy directly to $U_0$, so $E_{th} \\approx U_0 = 8.7~\\mathrm{eV}$. For $E$ just above $E_{th}$, $Y(E)$ is approximately linear in $E$ with a slope governed by electronic stopping, since electronic energy loss dominates the onset of sputtering in metals.**\n- This option is incorrect. Equating $E_{th}$ to $U_0$ completely ignores the laws of momentum and energy conservation in a two-body collision between disparate masses. The prediction of $E_{th} \\approx 8.7~\\mathrm{eV}$ is wrong by more than an order of magnitude. The assertion that electronic stopping governs sputtering is also fundamentally incorrect; sputtering is a result of momentum transfer to nuclei (nuclear stopping). The claim of a linear yield dependence near threshold is also inaccurate.\n- **Verdict: Incorrect**\n\n**C. Estimate $E_{th}$ from thermodynamic heating: the incident ion’s energy raises the local lattice temperature until surface atoms surpass $U_0$ through thermal activation, so $E_{th}$ follows an Arrhenius-type criterion controlled by $U_0$. Near $E_{th}$, $Y(E)$ increases exponentially with $E$, reflecting a transition over an activation barrier.**\n- This describes thermal sputtering or sublimation, not the standard mechanism of physical sputtering by single ion impacts. Physical sputtering is a kinetic, collisional phenomenon. While thermal spikes can occur under conditions of extremely high energy density (e.g., with heavy cluster ions), it is not the correct model for single light ions near the sputtering threshold. The predicted exponential increase of $Y(E)$ is also inconsistent with experimental data for physical sputtering.\n- **Verdict: Incorrect**\n\n**D. Estimate $E_{th}$ using two-body collisions but assume the projectile and target masses are comparable, so the energy transfer fraction is large. Conclude $E_{th}$ is of order $10^1~\\mathrm{eV}$ for deuterium on tungsten. Near $E_{th}$, $Y(E)$ shows a concave-down onset due to shadowing by the surface, with a rapid approach to a plateau once $E  E_{th}$.**\n- This option is based on a counterfactual premise. The masses of deuterium ($m \\approx 2~\\mathrm{u}$) and tungsten ($M \\approx 184~\\mathrm{u}$) are not comparable. This false assumption leads to the incorrect conclusion that $E_{th}$ is low (order $10^1~\\mathrm{eV}$). The description of the yield curve as \"concave-down\" is the opposite of the correct convex (concave-up) shape. A plateau in yield does not occur just above threshold but at much higher energies (typically in the multi-keV range).\n- **Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Simulations of plasma-material interactions require continuous functions for physical properties, but experimental data is often sparse and contains noise. This exercise addresses the practical engineering challenge of converting discrete data points into a well-behaved, physically-sound model suitable for computation. You will implement a shape-preserving interpolation scheme that enforces the known physical constraints of sputtering, such as the non-negativity of the yield and the existence of a threshold energy .",
            "id": "4047054",
            "problem": "You are tasked with constructing a physically constrained interpolation scheme for the sputtering yield of plasma-facing materials. The sputtering yield is the number of target atoms ejected per incident ion and is modeled here as a function of incident ion energy. Denote the energy by $E$ (in electronvolts, eV) and the sputtering yield by $Y(E)$ (dimensionless). The threshold energy $E_{th}$ is the minimum energy below which sputtering is negligible. Physical constraints require $Y(E)\\ge 0$ for all $E$ and $Y(E) = 0$ for $E \\le E_{th}$.\n\nStarting only from the following foundational physical principles:\n- The sputtering yield $Y(E)$ is non-negative by definition because it counts ejected atoms, hence $Y(E)\\ge 0$.\n- The threshold energy $E_{th}$ enforces that sputtering does not occur below threshold, hence $Y(E)=0$ for $E \\le E_{th}$.\n\nYou must design and implement an interpolation scheme that:\n1. Accepts sparse experimental datasets of $(E_i, Y_i)$ values with energies $E_i$ in eV and yields $Y_i$ dimensionless.\n2. Enforces the physical constraints $Y(E)\\ge 0$ and $Y(E)=0$ for $E\\le E_{th}$, exactly at and below threshold.\n3. Produces smooth, shape-preserving behavior suitable for use in simulations with sparse data.\n4. Is deterministic, well-defined, and numerically stable on the given test cases.\n5. Does not rely on any closed-form sputtering yield model beyond the two physical constraints above; your interpolation must be constructed purely from the data and constraints.\n\nAlgorithmic requirements:\n- Preprocess the dataset by sorting in ascending energy and projecting any negative measured yields to zero.\n- Explicitly enforce $Y(E)=0$ for energies $E\\le E_{th}$, including inserting the anchor point $(E_{th}, 0)$ if it is not present in the data.\n- Construct a shape-preserving interpolant above $E_{th}$ whose evaluation never yields negative values. The interpolation must be piecewise-defined on the data energies and must have local support and monotonic slope control to prevent spurious oscillations from sparse data.\n- The output values must be rounded to six decimal places.\n\nImplement a program that applies your interpolation scheme to the following test suite. For each test case, evaluate the interpolant at the specified query energies and collect the results into a single list. All energies are in eV and all yields are dimensionless.\n\nTest Suite:\n- Case $1$ (happy path with sub-threshold noisy datum):\n  - Threshold $E_{th} = 200$.\n  - Data points: $(150, -0.02)$, $(220, 0.02)$, $(400, 0.15)$, $(800, 0.30)$.\n  - Query energies: $[100, 200, 250, 600]$.\n- Case $2$ (moderate energies with increasing yields):\n  - Threshold $E_{th} = 50$.\n  - Data points: $(60, 0.03)$, $(120, 0.10)$, $(300, 0.22)$.\n  - Query energies: $[40, 50, 75, 300]$.\n- Case $3$ (very sparse high-energy data):\n  - Threshold $E_{th} = 500$.\n  - Data points: $(700, 0.04)$, $(1500, 0.08)$.\n  - Query energies: $[300, 500, 700, 1500]$.\n- Case $4$ (non-monotonic sparse data above threshold):\n  - Threshold $E_{th} = 30$.\n  - Data points: $(35, 0.01)$, $(100, 0.06)$, $(200, 0.05)$, $(500, 0.07)$.\n  - Query energies: $[20, 30, 200, 400]$.\n\nOutput Specification:\n- Express all energies internally in electronvolts (eV) and all yields as dimensionless numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and by query within each case. Within each test case, evaluate the interpolant at the query energies in the given order and append each value to the output list. For example, the output format must be of the form $[y_{1,1}, y_{1,2}, \\dots, y_{1,m_1}, y_{2,1}, \\dots, y_{n,m_n}]$, where $y_{i,j}$ denotes the interpolated yield at the $j$-th query energy of the $i$-th test case. Each number must be rounded to six decimal places.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of plasma-material interactions, mathematically well-posed, and provides a complete, self-contained set of requirements for constructing a numerical interpolation scheme. The provided data and constraints are physically realistic and computationally tractable.\n\nThe task is to construct a physically constrained interpolation scheme for sputtering yield, $Y(E)$, as a function of incident ion energy, $E$. The scheme must adhere to two fundamental physical constraints: non-negativity of the yield, $Y(E) \\ge 0$, and the existence of a threshold energy, $E_{th}$, below which no sputtering occurs, i.e., $Y(E)=0$ for $E \\le E_{th}$. The interpolation must be constructed from sparse data points $(E_i, Y_i)$ without recourse to pre-defined analytical models. The requirements for a smooth, shape-preserving, and non-oscillatory interpolant guide the choice of method.\n\nA suitable interpolation algorithm must be piecewise-defined, have local support, and control the behavior of derivatives to prevent spurious oscillations and ensure non-negativity. Standard polynomial interpolation is globally defined and highly oscillatory. Cubic splines, while smooth, are known to produce overshoots that can violate both the shape-preservation and non-negativity constraints, especially with sparse or non-monotonic data. Linear interpolation is shape-preserving and non-negative (for non-negative data) but is not smooth, having only $C^0$ continuity.\n\nThe optimal choice that satisfies all requirements is a Piecewise Cubic Hermite Interpolating Polynomial (PCHIP) scheme. PCHIP constructs a $C^1$ continuous function (i.e., the function and its first derivative are continuous) from piecewise cubic polynomials defined on each data interval $[E_i, E_{i+1}]$. Its key feature is the method for determining the derivative, or slope, $d_i$, at each data point $(E_i, Y_i)$. Unlike cubic splines which solve a global system of equations that can propagate local changes globally, PCHIP computes each derivative $d_i$ using only local information (typically from adjacent points). The derivatives are constrained to ensure the interpolant preserves the monotonicity of the data. For instance, if the data is increasing over an interval, the interpolant will also be monotonically increasing. This \"shape-preserving\" property is crucial for preventing oscillations and, by extension, for maintaining non-negativity between non-negative data points.\n\nThe overall algorithmic design proceeds in three stages: data preprocessing, interpolator construction, and constrained evaluation.\n\n1.  Data Preprocessing: A robust set of interpolation nodes $\\{ (E_j^*, Y_j^*) \\}$ is prepared from the raw experimental data and the physical constraints. This procedure is as follows:\n    a. We initialize a working data structure, such as a dictionary, to store the final nodes. This handles sorting and ensures unique energies.\n    b. The threshold constraint is enforced by adding an anchor point $(E_{th}, 0)$ to our node set. This explicitly forces the interpolant to pass through zero at the threshold energy.\n    c. We iterate through the provided experimental data points $(E_i, Y_i)$. Any point with an energy $E_i \\le E_{th}$ is discarded, as the behavior in this region is strictly defined by the physical constraint $Y(E)=0$, not by potentially noisy data.\n    d. For each point with $E_i  E_{th}$, the yield is projected to be non-negative, $Y_i' = \\max(Y_i, 0)$, to account for measurement noise that might produce unphysical negative values. The processed point $(E_i, Y_i')$ is then added to our node set. If a point at energy $E_i$ already exists (e.g., from a duplicate measurement), the maximum yield value is retained to be conservative.\n    e. The finalized set of nodes is then sorted by energy to form the arrays $X = [E_1^*, E_2^*, \\dots, E_N^*]$ and $Y = [Y_1^*, Y_2^*, \\dots, Y_N^*]$ for interpolation, where $E_1^* = E_{th}$ and $Y_1^* = 0$.\n\n2.  Interpolator Construction: With the processed, physically-consistent nodes $(X, Y)$, a PCHIP interpolator is constructed. This object encapsulates the piecewise cubic functions for each interval $[E_j^*, E_{j+1}^*]$. The implementation will leverage the `scipy.interpolate.PchipInterpolator` class, which provides a numerically stable and validated implementation of this method. The interpolator is defined over the domain $[E_{th}, E_{max}^*]$.\n\n3.  Constrained Evaluation: A wrapper function is used to evaluate the sputtering yield $Y(E_q)$ at any query energy $E_q$.\n    a. If the query energy $E_q$ is at or below the threshold, $E_q \\le E_{th}$, the function returns $0$, directly enforcing the physical constraint.\n    b. If $E_q  E_{th}$, the pre-constructed PCHIP object is called to evaluate the yield. The shape-preserving nature of PCHIP ensures that for the prepared non-negative nodes, the interpolated yield will also be non-negative. Extrapolation for $E_q  E_{max}^*$ is handled by the `PchipInterpolator`'s default behavior, which uses the derivative at the boundary point, providing a reasonable linear extrapolation.\n\nThis comprehensive approach results in a deterministic, robust, and physically sound interpolation scheme that fully adheres to the problem statement's constraints. The final values are rounded to six decimal places as required.",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import PchipInterpolator\n\ndef solve():\n    \"\"\"\n    Solves the sputtering yield interpolation problem for a suite of test cases.\n    \"\"\"\n    test_suite = [\n        {\n            \"Eth\": 200,\n            \"data\": [(150, -0.02), (220, 0.02), (400, 0.15), (800, 0.30)],\n            \"queries\": [100, 200, 250, 600],\n        },\n        {\n            \"Eth\": 50,\n            \"data\": [(60, 0.03), (120, 0.10), (300, 0.22)],\n            \"queries\": [40, 50, 75, 300],\n        },\n        {\n            \"Eth\": 500,\n            \"data\": [(700, 0.04), (1500, 0.08)],\n            \"queries\": [300, 500, 700, 1500],\n        },\n        {\n            \"Eth\": 30,\n            \"data\": [(35, 0.01), (100, 0.06), (200, 0.05), (500, 0.07)],\n            \"queries\": [20, 30, 200, 400],\n        },\n    ]\n\n    all_results = []\n\n    for case in test_suite:\n        E_th = case[\"Eth\"]\n        raw_data = case[\"data\"]\n        query_energies = case[\"queries\"]\n\n        # --- 1. Data Preprocessing ---\n        # Use a dictionary to handle sorting, uniqueness, and updates efficiently.\n        processed_nodes = {}\n\n        # Add the anchor point (E_th, 0).\n        processed_nodes[E_th] = 0.0\n\n        for E_i, Y_i in raw_data:\n            # Project negative yields to zero.\n            Y_i_proj = max(0, Y_i)\n            \n            # Process points above the threshold.\n            if E_i  E_th:\n                # If energy already exists, take the max yield.\n                if E_i in processed_nodes:\n                    processed_nodes[E_i] = max(processed_nodes[E_i], Y_i_proj)\n                else:\n                    processed_nodes[E_i] = Y_i_proj\n            # If a point exists exactly at E_th, update the anchor point's yield.\n            elif E_i == E_th:\n                processed_nodes[E_th] = max(processed_nodes[E_th], Y_i_proj)\n        \n            # Points with E_i  E_th are ignored as per the physical model Y(E)=0 for E=E_th.\n\n        # Convert dictionary to sorted lists for the interpolator.\n        sorted_energies = sorted(processed_nodes.keys())\n        X = np.array(sorted_energies)\n        Y = np.array([processed_nodes[E] for E in sorted_energies])\n\n        # --- 2. Interpolator Construction ---\n        # Create a PCHIP interpolator, which is shape-preserving and C1 continuous.\n        # It requires at least two points to be constructed.\n        if len(X)  2:\n            # If there is only the anchor point, create a dummy interpolator.\n            # This handles cases with no data above E_th.\n            pchip_interpolator = lambda E_q: 0.0\n        else:\n            pchip_interpolator = PchipInterpolator(X, Y, extrapolate=True)\n\n        # --- 3. Constrained Evaluation ---\n        case_results = []\n        for E_q in query_energies:\n            if E_q = E_th:\n                yield_val = 0.0\n            else:\n                # The PchipInterpolator returns a 0-d array, so extract the scalar value.\n                yield_val = float(pchip_interpolator(E_q))\n                # Ensure non-negativity due to potential float precision issues.\n                if yield_val  0:\n                    yield_val = 0.0\n            \n            # Round the result to six decimal places.\n            case_results.append(round(yield_val, 6))\n        \n        all_results.extend(case_results)\n\n    # Format the final output as a single comma-separated list in brackets.\n    output_str = \"[\" + \",\".join(f\"{val:.6f}\" for val in all_results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "In a realistic fusion environment, plasma-facing components are bombarded by ions with a wide distribution of energies, not a single monoenergetic beam. This final practice bridges the gap between single-event physics and macroscopic outcomes by asking you to calculate the average sputtering yield resulting from an ion energy distribution. This exercise demonstrates the crucial and often non-intuitive impact of the high-energy tail of a distribution, which can cause significant material erosion even when the average ion energy is below the sputtering threshold .",
            "id": "4047224",
            "problem": "Consider deuterium ions incident on a tungsten plasma-facing component in a magnetic-confinement fusion device. The sputtering yield as a function of incident ion energy is governed near threshold by kinematic considerations from Sigmund’s theory of sputtering, in which the yield increases from zero once the incident energy exceeds a material-dependent threshold energy. Model the near-threshold sputtering yield by a linear approximation whose slope is consistent with empirical near-threshold behavior: for energy $E$, define the sputtering yield $Y(E)$ by $Y(E) = s\\,(E - E_{\\mathrm{th}})$ for $E \\geq E_{\\mathrm{th}}$ and $Y(E) = 0$ for $E  E_{\\mathrm{th}}$, where $s$ is a material and incidence-condition dependent constant with units of sputtered atoms per incident ion per electron-volt. Assume the incident ion energy distribution at the material surface is Gaussian due to sheath fluctuations, $f(E) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(E-\\mu)^{2}}{2\\sigma^{2}}\\right)$, with mean energy $\\mu$ and standard deviation $\\sigma$, and that $f(E)$ is normalized over $(-\\infty,\\infty)$.\n\nLet the threshold energy be $E_{\\mathrm{th}} = 200\\,\\text{eV}$, the mean ion energy be $\\mu = 180\\,\\text{eV}$, the energy standard deviation be $\\sigma = 50\\,\\text{eV}$, and the near-threshold slope be $s = 2.0\\times 10^{-4}\\,\\text{eV}^{-1}$. Starting from the definition of ensemble-averaged sputtering yield under a distribution of incident energies and the properties of the Gaussian distribution, derive an analytic expression for the contribution to the mean sputtering yield from the energy tail above $E_{\\mathrm{th}}$,\n$$\nY_{\\text{tail}} = \\int_{E_{\\mathrm{th}}}^{\\infty} Y(E)\\, f(E)\\, dE,\n$$\nand compute its numerical value for the parameters provided. To assess the importance of the tail, also compute the fraction of incident ions with energy above threshold,\n$$\nP_{\\text{tail}} = \\int_{E_{\\mathrm{th}}}^{\\infty} f(E)\\, dE.\n$$\nReport both $Y_{\\text{tail}}$ and $P_{\\text{tail}}$ as dimensionless decimals. Round your answers to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to proceed with a solution. All physical parameters and models are consistent with established principles in plasma-material interaction physics.\n\nThe first quantity to be computed is the fraction of incident ions with energy above the sputtering threshold, $P_{\\text{tail}}$. This is defined by the integral of the energy distribution function $f(E)$ from the threshold energy $E_{\\mathrm{th}}$ to infinity.\n$$\nP_{\\text{tail}} = \\int_{E_{\\mathrm{th}}}^{\\infty} f(E)\\, dE = \\int_{E_{\\mathrm{th}}}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(E-\\mu)^{2}}{2\\sigma^{2}}\\right) dE\n$$\nTo evaluate this integral, we perform a change of variables to standardize the Gaussian distribution. Let $z = \\frac{E-\\mu}{\\sigma}$. Then $dE = \\sigma\\,dz$. The lower limit of integration becomes $z_{\\mathrm{th}} = \\frac{E_{\\mathrm{th}}-\\mu}{\\sigma}$, and the upper limit remains $\\infty$. The integral transforms to:\n$$\nP_{\\text{tail}} = \\int_{z_{\\mathrm{th}}}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{z^{2}}{2}\\right) (\\sigma\\,dz) = \\int_{z_{\\mathrm{th}}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^{2}}{2}\\right) dz\n$$\nThis is the integral of the standard normal probability density function over its tail. This integral is commonly expressed in terms of the complementary error function, $\\text{erfc}(x)$, which is defined as $\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\exp(-t^2) dt$. With a substitution $t = z/\\sqrt{2}$, we find the relationship:\n$$\nP_{\\text{tail}} = \\frac{1}{2} \\text{erfc}\\left(\\frac{z_{\\mathrm{th}}}{\\sqrt{2}}\\right) = \\frac{1}{2} \\text{erfc}\\left(\\frac{E_{\\mathrm{th}}-\\mu}{\\sqrt{2}\\sigma}\\right)\n$$\nSubstituting the given numerical values: $E_{\\mathrm{th}} = 200\\,\\text{eV}$, $\\mu = 180\\,\\text{eV}$, and $\\sigma = 50\\,\\text{eV}$:\n$$\n\\frac{E_{\\mathrm{th}}-\\mu}{\\sigma} = \\frac{200 - 180}{50} = \\frac{20}{50} = 0.4\n$$\n$$\nP_{\\text{tail}} = \\frac{1}{2} \\text{erfc}\\left(\\frac{0.4}{\\sqrt{2}}\\right) \\approx \\frac{1}{2} \\text{erfc}(0.28284) \\approx \\frac{1}{2}(0.689156) \\approx 0.344578\n$$\nRounding to four significant figures, $P_{\\text{tail}} \\approx 0.3446$.\n\nThe second quantity to be computed is the contribution to the mean sputtering yield from the energy tail, $Y_{\\text{tail}}$. This is the ensemble average of the sputtering yield $Y(E)$ over the ions with energy $E \\geq E_{\\mathrm{th}}$.\n$$\nY_{\\text{tail}} = \\int_{E_{\\mathrm{th}}}^{\\infty} Y(E)\\, f(E)\\, dE\n$$\nSubstituting the given linear model for the yield, $Y(E) = s(E - E_{\\mathrm{th}})$ for $E \\geq E_{\\mathrm{th}}$:\n$$\nY_{\\text{tail}} = \\int_{E_{\\mathrm{th}}}^{\\infty} s(E - E_{\\mathrm{th}}) f(E)\\, dE = s \\int_{E_{\\mathrm{th}}}^{\\infty} (E - E_{\\mathrm{th}}) f(E)\\, dE\n$$\nTo simplify the integral, we rewrite the term $(E - E_{\\mathrm{th}})$ as $(E - \\mu) + (\\mu - E_{\\mathrm{th}})$. This allows us to split the integral into two parts:\n$$\nY_{\\text{tail}} = s \\left[ \\int_{E_{\\mathrm{th}}}^{\\infty} (E - \\mu) f(E)\\, dE + \\int_{E_{\\mathrm{th}}}^{\\infty} (\\mu - E_{\\mathrm{th}}) f(E)\\, dE \\right]\n$$\n$$\nY_{\\text{tail}} = s \\left[ \\int_{E_{\\mathrm{th}}}^{\\infty} (E - \\mu) f(E)\\, dE + (\\mu - E_{\\mathrm{th}}) \\int_{E_{\\mathrm{th}}}^{\\infty} f(E)\\, dE \\right]\n$$\nThe second integral is simply $P_{\\text{tail}}$, which we have already evaluated. Let's focus on the first integral, which we denote as $I_1$:\n$$\nI_1 = \\int_{E_{\\mathrm{th}}}^{\\infty} (E - \\mu) f(E)\\, dE = \\int_{E_{\\mathrm{th}}}^{\\infty} (E - \\mu) \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(E-\\mu)^{2}}{2\\sigma^{2}}\\right) dE\n$$\nWe can solve this integral by substitution. Let $u = \\frac{(E-\\mu)^2}{2\\sigma^2}$. The differential is $du = \\frac{E-\\mu}{\\sigma^2} dE$, which means $(E-\\mu)dE = \\sigma^2 du$. The lower integration limit becomes $u_{\\mathrm{th}} = \\frac{(E_{\\mathrm{th}}-\\mu)^2}{2\\sigma^2}$.\n$$\nI_1 = \\int_{u_{\\mathrm{th}}}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp(-u) (\\sigma^2 du) = \\frac{\\sigma}{\\sqrt{2\\pi}} \\int_{u_{\\mathrm{th}}}^{\\infty} \\exp(-u) du\n$$\n$$\nI_1 = \\frac{\\sigma}{\\sqrt{2\\pi}} \\left[ -\\exp(-u) \\right]_{u_{\\mathrm{th}}}^{\\infty} = \\frac{\\sigma}{\\sqrt{2\\pi}} \\left( 0 - (-\\exp(-u_{\\mathrm{th}})) \\right) = \\frac{\\sigma}{\\sqrt{2\\pi}} \\exp(-u_{\\mathrm{th}})\n$$\nSubstituting back $u_{\\mathrm{th}}$:\n$$\nI_1 = \\frac{\\sigma}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(E_{\\mathrm{th}}-\\mu)^2}{2\\sigma^2}\\right)\n$$\nCombining the pieces, we arrive at the analytical expression for $Y_{\\text{tail}}$:\n$$\nY_{\\text{tail}} = s \\left[ \\frac{\\sigma}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(E_{\\mathrm{th}}-\\mu)^2}{2\\sigma^2}\\right) + (\\mu - E_{\\mathrm{th}}) P_{\\text{tail}} \\right]\n$$\nNow, we substitute the numerical values: $s = 2.0\\times 10^{-4}\\,\\text{eV}^{-1}$, $\\sigma = 50\\,\\text{eV}$, $\\mu = 180\\,\\text{eV}$, $E_{\\mathrm{th}} = 200\\,\\text{eV}$, and the previously calculated $P_{\\text{tail}} \\approx 0.344578$.\nThe argument of the exponential is $-\\frac{(E_{\\mathrm{th}}-\\mu)^2}{2\\sigma^2} = -\\frac{(200-180)^2}{2(50)^2} = -\\frac{20^2}{2 \\times 2500} = -\\frac{400}{5000} = -0.08$.\nThe term $I_1$ evaluates to:\n$$\nI_1 = \\frac{50}{\\sqrt{2\\pi}} \\exp(-0.08) \\approx (19.9471) \\times (0.923116) \\approx 18.4135\\,\\text{eV}\n$$\nThe second term in the bracket is:\n$$\n(\\mu - E_{\\mathrm{th}}) P_{\\text{tail}} = (180 - 200) \\times 0.344578 = -20 \\times 0.344578 \\approx -6.89156\\,\\text{eV}\n$$\nSumming the terms inside the bracket:\n$$\nI_1 + (\\mu - E_{\\mathrm{th}}) P_{\\text{tail}} \\approx 18.4135 - 6.89156 = 11.52194\\,\\text{eV}\n$$\nFinally, we multiply by the slope $s$:\n$$\nY_{\\text{tail}} = (2.0\\times 10^{-4}\\,\\text{eV}^{-1}) \\times (11.52194\\,\\text{eV}) \\approx 0.002304388\n$$\nRounding to four significant figures, $Y_{\\text{tail}} \\approx 0.002304$.\n\nThe two requested quantities are the tail-averaged sputtering yield, $Y_{\\text{tail}}$, and the fraction of ions in the tail, $P_{\\text{tail}}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.002304  0.3446 \\end{pmatrix}}$$"
        }
    ]
}