{
    "hands_on_practices": [
        {
            "introduction": "Before ions enter the sheath, they must be accelerated in a quasi-neutral \"presheath\" to satisfy the Bohm criterion. This practice delves into the kinetic origins of this acceleration, modeling the balance between the electric field and collisional drag. By deriving the presheath length scale, you will gain a first-principles understanding of the conditions that set up the ion flow essential for a stable sheath .",
            "id": "3999663",
            "problem": "Consider a one-dimensional, steady, weakly collisional presheath adjacent to a material wall in a magnetically unconfined region of a fusion-relevant plasma where ion–neutral scattering dominates ion momentum relaxation. Ions of charge $q_{i}$ and mass $m_{i}$ move under a spatially uniform electric field $E$ and undergo elastic collisions with stationary neutrals. Model the ion kinetics with the Bhatnagar–Gross–Krook (BGK) collision operator, using a constant ion–neutral collision frequency $\\nu_{in}$ and assuming that the neutral reference distribution has zero drift. Let the upstream ion distribution be near-Maxwellian with ion temperature $T_{i}$, and define the ion thermal speed by $v_{Ti} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}}$.\n\nIn the presheath entrance, the directed ion speed is small compared to $v_{Ti}$, and the directed motion is established by a balance between field-driven acceleration and collisional drag. Define the presheath length scale $\\ell_{p}$ as the characteristic distance over which the electric field does work equal to the directed kinetic energy corresponding to the speed $v_{Ti}$, under conditions where the electric acceleration $q_{i} E$ is balanced by the collisional drag $m_{i} \\nu_{in} u_{i}$ at the terminal directed speed $u_{i} = v_{Ti}$. Using only the parameters $\\nu_{in}$ and $v_{Ti}$ and first-principles kinetic and energy arguments, derive a closed-form expression for $\\ell_{p}$.\n\nExpress your final answer as a single analytic expression for $\\ell_{p}$ in terms of $v_{Ti}$ and $\\nu_{in}$. No numerical evaluation is required, and no units should be included in the final boxed expression.",
            "solution": "The kinetic starting point is the steady, one-dimensional ion Boltzmann equation with the Bhatnagar–Gross–Krook (BGK) collision operator,\n$$\nv\\,\\frac{\\partial f_{i}}{\\partial x} + \\frac{q_{i}}{m_{i}} E\\,\\frac{\\partial f_{i}}{\\partial v}\n= -\\nu_{in}\\,\\bigl(f_{i} - f_{i}^{(M)}\\bigr),\n$$\nwhere $f_{i}(x,v)$ is the ion distribution function, $f_{i}^{(M)}$ is the Maxwellian reference state for the BGK operator, and the neutrals are stationary so that the BGK operator relaxes ion momentum toward zero drift at rate $\\nu_{in}$. Taking the first velocity moment (multiplying by $m_{i} v$ and integrating over $v$) gives the steady momentum balance along $x$,\n$$\nm_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x} = q_{i} n_{i} E - m_{i} n_{i} \\nu_{in}\\,u_{i},\n$$\nwhere $n_{i}(x)$ is the ion density and $u_{i}(x)$ is the ion drift speed. In the presheath entrance region, the flow is subsonic and $u_{i}$ increases from a small value. For the characteristic terminal drift speed that the field sustains against collisions, we consider the regime where the inertial term $m_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x}$ is negligible compared to the forcing and drag; then the local force balance yields\n$$\n\\frac{q_{i}}{m_{i}} E = \\nu_{in}\\,u_{i}.\n$$\nEvaluated at the terminal directed speed $u_{i} = v_{Ti}$, this gives a field magnitude\n$$\nE = \\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}.\n$$\n\nNext, define the presheath length scale $\\ell_{p}$ as the distance required for the field to do work equal to the directed kinetic energy associated with $v_{Ti}$. The work done by the field over a distance $\\ell_{p}$ is $q_{i} E \\ell_{p}$, and the directed kinetic energy is $\\frac{1}{2} m_{i} v_{Ti}^{2}$. Equating these,\n$$\nq_{i} E\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\nSubstituting the expression for $E$ obtained from the acceleration–drag balance,\n$$\nq_{i} \\left(\\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}\\right)\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\nCanceling $q_{i}$ and $m_{i}$ and solving for $\\ell_{p}$,\n$$\n\\nu_{in}\\,v_{Ti}\\,\\ell_{p} = \\frac{1}{2} v_{Ti}^{2}\n\\quad\\Rightarrow\\quad\n\\ell_{p} = \\frac{v_{Ti}}{2\\,\\nu_{in}}.\n$$\n\nThis result depends only on the ion thermal speed $v_{Ti}$ and the ion–neutral collision frequency $\\nu_{in}$, as required. It can be interpreted as one-half of the ion–neutral mean free path evaluated at the thermal speed, consistent with the notion that the presheath length is set by the balance between acceleration and collisional momentum relaxation and by the energy required to establish a directed motion comparable to the thermal speed.",
            "answer": "$$\\boxed{\\frac{v_{Ti}}{2 \\nu_{in}}}$$"
        },
        {
            "introduction": "A key aspect of kinetic modeling is accurately representing particle behavior at boundaries. This exercise focuses on the electrons within the sheath, whose distribution is shaped by the confining potential and their interaction with the material wall. Applying fundamental principles like Liouville's theorem, you will construct the electron distribution function considering elastic reflection, a process that can significantly alter the local plasma density and current at the surface .",
            "id": "3999695",
            "problem": "Consider a steady, one-dimensional (1D), collisionless, planar plasma sheath adjacent to a perfectly planar wall. Electrons originate from the quasi-neutral plasma edge with a one-dimensional Maxwellian distribution function $f_{\\infty}(v)$ at $x=0$ with number density $n_0$ and electron temperature $T_e$. The wall is at $x=L$ with potential $\\phi_w$ relative to the plasma edge potential $\\phi_0=0$. We denote the elementary charge as $e0$, the electron mass as $m_e$, and the Boltzmann constant as $k_\\mathrm{B}$. Electrons experience a monotonic repelling potential drop $\\Delta \\phi = \\phi_0 - \\phi_w  0$ toward the wall. A fraction $R \\in [0,1]$ of electrons incident on the wall is elastically, specularly reflected (no energy loss and velocity component normal to the wall reverses sign), and a fraction $1-R$ is absorbed.\n\nStarting only from the following fundamental bases:\n- Conservation of single-particle energy, $\\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x)$, along collisionless trajectories.\n- Liouville's theorem for collisionless dynamics (phase-space density is constant along trajectories).\n- The one-dimensional Maxwellian definition at the plasma edge,\n$$\nf_{\\infty}(v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right),\n$$\nand the specular elastic reflection boundary condition at the wall with coefficient $R$.\n\nDerive expressions for the electron number density at the wall, $n_e^{\\mathrm{wall}}$, and the absorbed electron current density to the wall, $J_e^{\\mathrm{abs}}$, by incorporating the incident and the elastically reflected electron trajectories in $f_e(L,v)$. Your derivation must explicitly show how conservation of energy and Liouville's theorem determine $f_{\\mathrm{in}}(L,v)$ for $v0$ (incident electrons) and how the reflection boundary condition determines $f_{\\mathrm{ref}}(L,v)$ for $v0$ (reflected electrons). Then, compute the integrals that yield $n_e^{\\mathrm{wall}}$ and $J_e^{\\mathrm{abs}}$ in terms of $n_0$, $T_e$, $\\Delta\\phi$, $R$, $m_e$, $e$, and $k_\\mathrm{B}$.\n\nNumerical implementation requirements:\n- Use $T_e$ given in electronvolts (eV), and consistently convert to energy using $k_\\mathrm{B} T_e = e\\, T_e$.\n- For each test case below, compute two quantities:\n    1) $n_e^{\\mathrm{wall}}$ in $\\mathrm{m}^{-3}$,\n    2) $J_e^{\\mathrm{abs}}$ in $\\mathrm{A}\\,\\mathrm{m}^{-2}$.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[n_e^{\\mathrm{wall}}, J_e^{\\mathrm{abs}}]$. For example: \"[[n1,J1],[n2,J2],...]\".\n\nTest suite parameter sets (each is $(n_0, T_e, \\phi_w, R)$):\n- Case 1 (happy path): $(8.0\\times 10^{18}, 12.0, -25.0, 0.0)$.\n- Case 2 (moderate reflection): $(8.0\\times 10^{18}, 12.0, -25.0, 0.3)$.\n- Case 3 (full reflection boundary): $(8.0\\times 10^{18}, 12.0, -25.0, 1.0)$.\n- Case 4 (boundary condition check, zero drop): $(1.0\\times 10^{19}, 5.0, 0.0, 0.0)$.\n- Case 5 (edge case, strong depletion at low temperature): $(5.0\\times 10^{18}, 2.0, -10.0, 0.5)$.\n\nYour program must implement the derived formulas and produce the output in the exact format described above. Express $n_e^{\\mathrm{wall}}$ in $\\mathrm{m}^{-3}$ and $J_e^{\\mathrm{abs}}$ in $\\mathrm{A}\\,\\mathrm{m}^{-2}$ without rounding constraints beyond standard double-precision floating-point representation.",
            "solution": "The problem is valid as it is scientifically grounded in established plasma kinetic theory, well-posed with sufficient and consistent conditions, and stated objectively. We can proceed with a formal derivation.\n\nThe derivation for the electron density and absorbed current density at the wall is based on Liouville's theorem, which states that the distribution function $f_e(x,v)$ is constant along particle trajectories in a collisionless system. The trajectories are governed by the conservation of total energy, $\\mathcal{E}$.\n\nStep 1: Define Energy and Trajectories\nThe total energy of an electron with charge $-e$ (where $e$ is the elementary charge, $e0$) and mass $m_e$ is given by:\n$$ \\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nConservation of energy along a trajectory connecting a point $(0, v_0)$ at the plasma edge to a point $(x, v)$ in the sheath is expressed as:\n$$ \\frac{1}{2} m_e v_0^2 - e \\phi(0) = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nGiven $\\phi(0) = \\phi_0 = 0$, this simplifies to:\n$$ \\frac{1}{2} m_e v_0^2 = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nFrom this, we can find the velocity $v_0$ at the source for any particle found at $(x,v)$:\n$$ v_0^2 = v^2 - \\frac{2e\\phi(x)}{m_e} $$\nSince the distribution function at the source ($x=0$) is known to be a one-dimensional Maxwellian, $f_{\\infty}(v_0)$, Liouville's theorem allows us to write the distribution function at any point $(x,v)$ as $f_e(x,v) = f_{\\infty}(v_0)$.\n\nStep 2: Construct the Distribution Function at the Wall\nAt the wall, located at $x=L$, the potential is $\\phi(L) = \\phi_w$. The problem states a repelling potential drop for electrons, $\\Delta\\phi = \\phi_0 - \\phi_w  0$, which implies $\\phi_w  0$. The potential energy for an electron, $-e\\phi$, increases from $0$ at the edge to $-e\\phi_w  0$ at the wall.\n\nThe total electron distribution function at the wall, $f_e(L,v)$, is the sum of the distribution functions for incident electrons ($v0$) and reflected electrons ($v0$).\n$$ f_e(L,v) = \\begin{cases} f_{\\mathrm{in}}(L,v)  \\text{for } v  0 \\\\ f_{\\mathrm{ref}}(L,v)  \\text{for } v  0 \\end{cases} $$\n\nFor incident electrons ($v0$) at the wall, their source velocity $v_0$ must also be negative. Using the energy conservation equation at $x=L$:\n$$ v_0 = -\\sqrt{v^2 - \\frac{2e\\phi_w}{m_e}} $$\nApplying Liouville's theorem, we find $f_{\\mathrm{in}}(L,v)$:\n$$ f_{\\mathrm{in}}(L,v) = f_{\\infty}(v_0) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v_0^2}{2 k_\\mathrm{B} T_e}\\right) $$\nSubstituting the expression for $v_0^2$:\n$$ f_{\\mathrm{in}}(L,v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e (v^2 - 2e\\phi_w/m_e)}{2 k_\\mathrm{B} T_e}\\right) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) $$\nThis expression is valid for $v0$. Electrons can only reach the wall if they have sufficient initial kinetic energy to overcome the potential energy barrier: $\\frac{1}{2}m_e v_0^2 \\ge -e\\phi_w$. This condition ensures that the velocity at the wall, $v$, is real.\n\nFor reflected electrons ($v0$), the boundary condition is specular reflection with coefficient $R$. This means an electron incident with velocity $v_{\\mathrm{inc}}$ reflects with velocity $v_{\\mathrm{ref}} = -v_{\\mathrm{inc}}$. The particle flux is scaled by $R$:\n$$ |v_{\\mathrm{ref}}| f_{\\mathrm{ref}}(L, v_{\\mathrm{ref}}) = R |v_{\\mathrm{inc}}| f_{\\mathrm{in}}(L, v_{\\mathrm{inc}}) $$\nFor a reflected velocity $v  0$, the corresponding incident velocity is $-v  0$. Thus, $v_{\\mathrm{ref}} = v$ and $v_{\\mathrm{inc}} = -v$. The equation becomes:\n$$ v f_{\\mathrm{ref}}(L, v) = R |-v| f_{\\mathrm{in}}(L, -v) = R v f_{\\mathrm{in}}(L, -v) $$\nThis yields $f_{\\mathrm{ref}}(L,v) = R f_{\\mathrm{in}}(L,-v)$ for $v0$. Since the expression for $f_{\\mathrm{in}}(L,v)$ depends on $v^2$, it is an even function of $v$. Therefore, $f_{\\mathrm{in}}(L,-v) = f_{\\mathrm{in}}(L,v)$.\n$$ f_{\\mathrm{ref}}(L,v) = R \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right) \\quad \\text{for } v0 $$\n\nStep 3: Derive Electron Number Density at the Wall, $n_e^{\\mathrm{wall}}$\nThe number density is the zeroth moment of the distribution function:\n$$ n_e^{\\mathrm{wall}} = \\int_{-\\infty}^{\\infty} f_e(L,v) \\, dv = \\int_{-\\infty}^{0} f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} f_{\\mathrm{ref}}(L,v) \\, dv $$\nLet's define a constant factor $C_w = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right)$.\n$$ n_e^{\\mathrm{wall}} = C_w \\int_{-\\infty}^{0} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv + R C_w \\int_{0}^{\\infty} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\nThe integrals are standard Gaussian integrals. Let $a = \\frac{m_e}{2 k_\\mathrm{B} T_e}$. Then $\\int_0^\\infty e^{-av^2}dv = \\int_{-\\infty}^0 e^{-av^2}dv = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$.\n$$ \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} = \\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}} $$\nSubstituting this back:\n$$ n_e^{\\mathrm{wall}} = C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) + R C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = (1+R) \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n\nStep 4: Derive Absorbed Electron Current Density, $J_e^{\\mathrm{abs}}$\nThe net electron particle flux at the wall, $\\Gamma_e$, is the first moment of the distribution function:\n$$ \\Gamma_e = \\int_{-\\infty}^{\\infty} v f_e(L,v) \\, dv = \\int_{-\\infty}^{0} v f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} v f_{\\mathrm{ref}}(L,v) \\, dv $$\nThe first integral is the incident flux, $\\Gamma_{\\mathrm{in}}$, and the second is the reflected flux, $\\Gamma_{\\mathrm{ref}}$.\n$$ \\Gamma_{\\mathrm{in}} = C_w \\int_{-\\infty}^{0} v \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\nThis integral evaluates to:\n$$ \\Gamma_{\\mathrm{in}} = C_w \\left[ -\\frac{k_\\mathrm{B} T_e}{m_e} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right]_{-\\infty}^{0} = C_w \\left( -\\frac{k_\\mathrm{B} T_e}{m_e} (1 - 0) \\right) = -C_w \\frac{k_\\mathrm{B} T_e}{m_e} $$\nSubstituting $C_w$:\n$$ \\Gamma_{\\mathrm{in}} = -n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\frac{k_\\mathrm{B} T_e}{m_e} = -n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe reflected flux is $\\Gamma_{\\mathrm{ref}} = \\int_{0}^{\\infty} v R f_{\\mathrm{in}}(L,-v) \\, dv = R \\int_{0}^{\\infty} v f_{\\mathrm{in}}(L,v) \\, dv = -R \\Gamma_{\\mathrm{in}}$.\nThe net particle flux is $\\Gamma_e = \\Gamma_{\\mathrm{in}} + \\Gamma_{\\mathrm{ref}} = \\Gamma_{\\mathrm{in}} - R \\Gamma_{\\mathrm{in}} = (1-R)\\Gamma_{\\mathrm{in}}$. This net flux corresponds to the absorbed particles.\n$$ \\Gamma_e = -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe absorbed electron current density, $J_e^{\\mathrm{abs}}$, is the charge ($-e$) times the net particle flux:\n$$ J_e^{\\mathrm{abs}} = (-e) \\Gamma_e = (-e) \\left( -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) $$\n$$ J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe problem states $T_e$ is given in electron-volts (eV), which implies the use of the conversion $k_\\mathrm{B} T_{e,K} = e T_{e,eV}$. Thus, the exponential term becomes $\\exp(\\frac{e\\phi_w}{e T_{e,eV}}) = \\exp(\\frac{\\phi_w}{T_{e,eV}})$ where $\\phi_w$ is in Volts.\n\nThe final expressions for implementation are:\n1.  $n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n2.  $J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{e T_e}{2\\pi m_e}} \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\nHere, $T_e$ is the value in eV and $\\phi_w$ is the value in V.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron number density and absorbed current density at a wall\n    in a plasma sheath based on a kinetic model.\n    \"\"\"\n\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_e = 9.1093837015e-31 # Electron mass in kg\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n0, Te, phi_w, R)\n    # n0: electron density at plasma edge (m^-3)\n    # Te: electron temperature (eV)\n    # phi_w: wall potential (V)\n    # R: reflection coefficient (dimensionless)\n    test_cases = [\n        (8.0e18, 12.0, -25.0, 0.0), # Case 1 (happy path)\n        (8.0e18, 12.0, -25.0, 0.3), # Case 2 (moderate reflection)\n        (8.0e18, 12.0, -25.0, 1.0), # Case 3 (full reflection boundary)\n        (1.0e19, 5.0, 0.0, 0.0),    # Case 4 (boundary condition check, zero drop)\n        (5.0e18, 2.0, -10.0, 0.5)   # Case 5 (edge case, strong depletion at low temp)\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, Te_eV, phi_w, R = case\n\n        # The term e*phi_w / (k_B*T_e) simplifies to phi_w / T_e\n        # when Te is in eV and phi_w is in V.\n        # This is because k_B*T_e[J] = e*T_e[eV]\n        if Te_eV = 0:\n            # Avoid division by zero or non-physical temperature\n            # In this problem, all Te_eV  0, so this is a safeguard.\n            exp_term = 0.0\n        else:\n            exp_term = np.exp(phi_w / Te_eV)\n\n        # 1. Calculate electron number density at the wall, n_e^wall\n        # Formula: n_e_wall = 0.5 * (1 + R) * n0 * exp(e*phi_w / (k_B*T_e))\n        n_wall = 0.5 * (1 + R) * n0 * exp_term\n\n        # 2. Calculate absorbed electron current density to the wall, J_e^abs\n        # Formula: J_e_abs = (1 - R) * e * n0 * sqrt(k_B*T_e / (2*pi*m_e)) * exp(e*phi_w / (k_B*T_e))\n        # where k_B*T_e is e*Te_eV\n        kBT_e_joules = e * Te_eV\n        thermal_velocity_term = np.sqrt(kBT_e_joules / (2 * np.pi * m_e))\n        J_abs = (1 - R) * e * n0 * thermal_velocity_term * exp_term\n\n        results.append([n_wall, J_abs])\n\n    # Format the final output string exactly as required: [[n1,J1],[n2,J2],...]\n    # without extra spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "This practice synthesizes core concepts into a self-consistent model of a floating sheath, connecting microscopic particle dynamics to macroscopic engineering parameters. By enforcing the zero-current condition at the wall, which balances incident ion and electron fluxes with secondary electron emission, you will calculate the sheath potential drop. This result is then used to determine crucial outputs like wall heat load and sputtering flux, illustrating the practical power of kinetic sheath models in predicting plasma-material interactions .",
            "id": "3999682",
            "problem": "A one-dimensional, planar plasma sheath adjacent to a floating wall is modeled kinetically under fusion-relevant edge conditions using Maxwellian electrons, cold ions, and Secondary Electron Emission (SEE). The objective is to compute, for each specified parameter set, the sheath potential drop, the total steady-state wall heat load, and the sputtered particle flux, and to aggregate these results in a single list. The foundational base for this problem must begin from the following well-tested principles and definitions: electron and ion fluxes derived from Maxwellian kinetic theory, the current balance condition at a floating wall, and the Bohm criterion for ion entry to the sheath. The program must then implement a simplified but scientifically consistent energy accounting to determine the wall heat load and a thresholded yield model to estimate sputtering.\n\nAssumptions and base definitions:\n- Electrons are Maxwellian with electron temperature $T_e$ and number density $n$ in the quasi-neutral plasma region adjacent to the sheath edge.\n- Ions are cold, singly charged and satisfy the Bohm criterion at the sheath edge. The ion sound speed is defined by $c_s = \\sqrt{e\\,T_e/m_i}$ when $T_e$ is expressed in electronvolts (eV) and $m_i$ is the ion mass in kilograms, with $e$ the elementary charge in coulombs.\n- The wall is floating, hence the net current to the wall is zero in steady state. The emitted electron flux from the wall due to Secondary Electron Emission (SEE) is modeled as a fraction $\\gamma$ of the incident electron flux, with $\\gamma \\in [0,1)$.\n- Emitted electrons are approximated as Maxwellian at an emission temperature $T_{\\text{emit}}$.\n- The electron incident flux to the wall is determined by Maxwellian kinetics and reduced by the sheath potential barrier. The ion flux to the wall equals the ion flux at the sheath edge.\n- The sheath potential drop $\\phi$ is defined as the plasma-to-wall potential difference in volts.\n\nFrom the above, the following construction must be used:\n1. Enforce current balance at a floating wall using incident electron flux reduced by the sheath barrier and SEE.\n2. The ion particle flux to the wall is $\\Gamma_i = n\\,c_s$.\n3. The incident electron particle flux is $\\Gamma_{e,0} = n\\sqrt{e\\,T_e/(2\\pi m_e)}$, reduced by the barrier to $\\Gamma_e = \\Gamma_{e,0}\\,\\exp(-\\phi/T_e)$.\n4. The SEE emitted electron flux is $\\Gamma_{\\text{emit}} = \\gamma\\,\\Gamma_e$.\n5. The sheath potential drop $\\phi$ must be obtained by enforcing the floating current balance $J_i = J_e - J_{\\text{emit}}$ with $J = e\\,\\Gamma$.\n6. The ion energy per particle arriving at the wall is $E_i = e\\,(\\phi + 0.5\\,T_e)$ in joules, where $T_e$ is in eV and the factor $e$ converts eV to joules. The electron incident energy per particle to the wall is approximated as $E_e = e\\,(2\\,T_e)$, and the emitted electron energy per particle is $E_{\\text{emit}} = e\\,(2\\,T_{\\text{emit}})$. These coefficients are standard kinetic flux-weighted approximations for Maxwellian distributions at a planar boundary.\n7. The total wall heat load is the sum of ion and incident electron energy fluxes minus the emitted electron energy flux:\n   $$q_{\\text{total}} = \\Gamma_i\\,E_i + \\Gamma_e\\,E_e - \\Gamma_{\\text{emit}}\\,E_{\\text{emit}}.$$\n8. Sputtering is modeled with a thresholded power-law yield $Y(E_i)$ based on the ion impact energy in electronvolts $E_i^{\\text{eV}} = \\phi + 0.5\\,T_e$, with threshold $E_{\\text{th}}$ and reference yield parameters:\n   $$Y(E_i^{\\text{eV}}) = \\begin{cases}\n   0  \\text{if } E_i^{\\text{eV}}  E_{\\text{th}}, \\\\\n   Y_0 \\left(\\dfrac{E_i^{\\text{eV}}}{E_{\\text{ref}}}\\right)^{\\alpha}  \\text{otherwise}.\n   \\end{cases}$$\n   The sputtered particle flux is $\\Gamma_{\\text{sput}} = Y(E_i^{\\text{eV}})\\,\\Gamma_i$.\n\nPhysical constants:\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\,\\text{C}$.\n- Electron mass $m_e = 9.1093837015\\times 10^{-31}\\,\\text{kg}$.\n- Deuterium ion mass $m_i = 2.013553212745\\,\\text{u}$ with $1\\,\\text{u} = 1.66053906660\\times 10^{-27}\\,\\text{kg}$, hence $m_i = 3.345\\times 10^{-27}\\,\\text{kg}$ (use this numerical value).\n- Use $T_e$ and $T_{\\text{emit}}$ in electronvolts (eV), $n$ in $\\text{m}^{-3}$, and $\\phi$ in volts.\n\nTasks:\n- Implement the above model to compute, for each parameter set, the sheath potential drop $\\phi$ in volts, the total wall heat load $q_{\\text{total}}$ in watts per square meter ($\\text{W}/\\text{m}^2$), and the sputtered particle flux $\\Gamma_{\\text{sput}}$ in particles per square meter per second ($\\text{m}^{-2}\\,\\text{s}^{-1}$).\n- The floating wall condition implies a constraint on $\\gamma$: require $\\gamma  1 - \\sqrt{2\\pi m_e/m_i}$ to ensure a physically valid positive sheath potential drop.\n- For sputtering parameters use $E_{\\text{th}} = 30\\,\\text{eV}$, $Y_0 = 0.01$, $E_{\\text{ref}} = 100\\,\\text{eV}$, and $\\alpha = 0.5$.\n\nTest suite:\nProvide the following five parameter sets $(T_e, n, \\gamma, T_{\\text{emit}})$:\n1. $(25\\,\\text{eV}, 1.0\\times 10^{19}\\,\\text{m}^{-3}, 0.0, 2\\,\\text{eV})$.\n2. $(25\\,\\text{eV}, 1.0\\times 10^{19}\\,\\text{m}^{-3}, 0.9, 2\\,\\text{eV})$.\n3. $(100\\,\\text{eV}, 1.0\\times 10^{20}\\,\\text{m}^{-3}, 0.0, 2\\,\\text{eV})$.\n4. $(5\\,\\text{eV}, 1.0\\times 10^{18}\\,\\text{m}^{-3}, 0.95, 1\\,\\text{eV})$.\n5. $(50\\,\\text{eV}, 5.0\\times 10^{19}\\,\\text{m}^{-3}, 0.958, 5\\,\\text{eV})$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $[\\phi_1, q_{\\text{total},1}, \\Gamma_{\\text{sput},1}, \\phi_2, q_{\\text{total},2}, \\Gamma_{\\text{sput},2}, \\ldots, \\phi_5, q_{\\text{total},5}, \\Gamma_{\\text{sput},5}]$.\n- Express the sheath potential drop $\\phi$ in volts, the heat load $q_{\\text{total}}$ in watts per square meter, and the sputtered flux $\\Gamma_{\\text{sput}}$ in particles per square meter per second.\n- Print each numerical value as a floating-point number with six digits after the decimal point.",
            "solution": "The problem is subjected to validation and found to be valid. It is scientifically grounded in established plasma-wall interaction physics, well-posed with a complete and consistent set of definitions and parameters, and computationally tractable. The model, while simplified, represents a standard kinetic treatment of the plasma sheath, suitable for a computational exercise in fusion science.\n\nThe solution proceeds by first establishing the governing equations for the sheath potential, heat load, and sputtering, and then applying them to the specified test cases. The entire derivation adheres to the mandatory LaTeX formatting for all mathematical entities.\n\n**1. Derivation of the Sheath Potential Drop ($\\phi$)**\n\nThe foundation of a floating wall model is the condition of zero net electrical current to the surface in a steady state. The incident ion current density, $J_i$, must be balanced by the net electron current density, which is the incident electron current $J_e$ minus the emitted secondary electron current $J_{\\text{emit}}$.\n$$J_i = J_e - J_{\\text{emit}}$$\nThe current density $J$ is related to the particle flux $\\Gamma$ by $J=q\\Gamma$, where $q$ is the charge of the particle. For singly charged positive ions and electrons, this becomes $J=e\\Gamma$. The current balance equation in terms of particle fluxes is:\n$$e\\Gamma_i = e\\Gamma_e - e\\Gamma_{\\text{emit}}$$\n$$\\Gamma_i = \\Gamma_e - \\Gamma_{\\text{emit}}$$\nThe problem provides the following definitions:\n- The ion flux to the wall is determined by the Bohm criterion at the sheath edge: $\\Gamma_i = n\\,c_s$, where the ion sound speed is $c_s = \\sqrt{e\\,T_e/m_i}$. The electron temperature $T_e$ is in electronvolts ($eV$) and $e$ is the elementary charge.\n- The incident electron flux at the wall is the thermal flux from the bulk plasma, $n\\sqrt{eT_e/(2\\pi m_e)}$, reduced by the repulsive sheath potential barrier $\\phi$: $\\Gamma_e = n\\sqrt{e\\,T_e/(2\\pi m_e)}\\,\\exp(-\\phi/T_e)$. Note that $\\phi$ is in volts and $T_e$ is in electronvolts, so the ratio $\\phi/T_e$ is dimensionless.\n- The secondary electron emission (SEE) flux is proportional to the incident electron flux: $\\Gamma_{\\text{emit}} = \\gamma\\,\\Gamma_e$.\n\nSubstituting these into the flux balance equation:\n$$\\Gamma_i = \\Gamma_e - \\gamma\\,\\Gamma_e = (1-\\gamma)\\,\\Gamma_e$$\nNow, we substitute the full expressions for $\\Gamma_i$ and $\\Gamma_e$:\n$$n\\sqrt{\\frac{e\\,T_e}{m_i}} = (1-\\gamma)\\,n\\sqrt{\\frac{e\\,T_e}{2\\pi m_e}}\\,\\exp\\left(-\\frac{\\phi}{T_e}\\right)$$\nThe density $n$ and the term $\\sqrt{e\\,T_e}$ cancel from both sides:\n$$\\sqrt{\\frac{1}{m_i}} = (1-\\gamma)\\sqrt{\\frac{1}{2\\pi m_e}}\\exp\\left(-\\frac{\\phi}{T_e}\\right)$$\nWe can rearrange this equation to solve for the term containing $\\phi$:\n$$\\exp\\left(-\\frac{\\phi}{T_e}\\right) = \\frac{1}{1-\\gamma}\\sqrt{\\frac{2\\pi m_e}{m_i}}$$\nTaking the natural logarithm of both sides gives:\n$$-\\frac{\\phi}{T_e} = \\ln\\left(\\frac{1}{1-\\gamma}\\sqrt{\\frac{2\\pi m_e}{m_i}}\\right)$$\nFinally, solving for the sheath potential drop $\\phi$ (in volts) yields:\n$$\\phi = -T_e \\ln\\left(\\frac{1}{1-\\gamma}\\sqrt{\\frac{2\\pi m_e}{m_i}}\\right) = T_e \\ln\\left((1-\\gamma)\\sqrt{\\frac{m_i}{2\\pi m_e}}\\right)$$\nThis equation is used to compute $\\phi$ for each parameter set. A positive sheath potential ($\\phi  0$) requires the argument of the logarithm to be greater than $1$, which implies the constraint $\\gamma  1 - \\sqrt{2\\pi m_e/m_i}$ as stated in the problem.\n\n**2. Calculation of the Total Wall Heat Load ($q_{\\text{total}}$)**\n\nThe total heat load is the sum of the energy fluxes from incident ions and electrons, minus the energy flux carried away by emitted electrons:\n$$q_{\\text{total}} = \\Gamma_i E_i + \\Gamma_e E_e - \\Gamma_{\\text{emit}} E_{\\text{emit}}$$\nwhere $E_i$, $E_e$, and $E_{\\text{emit}}$ are the average energies per particle, in Joules. The problem provides:\n- $E_i = e\\,(\\phi + 0.5\\,T_e)$: Ions are accelerated by the sheath potential $\\phi$ and have an initial kinetic energy of $0.5\\,e\\,T_e$ from entering at the Bohm speed.\n- $E_e = e\\,(2\\,T_e)$: The flux-weighted average kinetic energy of Maxwellian electrons hitting a surface.\n- $E_{\\text{emit}} = e\\,(2\\,T_{\\text{emit}})$: The flux-weighted average kinetic energy of emitted electrons, assumed to be a Maxwellian distribution at temperature $T_{\\text{emit}}$.\n\nFrom the flux balance, we have the relations $\\Gamma_e = \\Gamma_i / (1-\\gamma)$ and $\\Gamma_{\\text{emit}} = \\gamma \\Gamma_e = \\gamma \\Gamma_i / (1-\\gamma)$. Substituting these into the heat load equation allows us to express $q_{\\text{total}}$ solely in terms of $\\Gamma_i$:\n$$q_{\\text{total}} = \\Gamma_i E_i + \\frac{\\Gamma_i}{1-\\gamma} E_e - \\frac{\\gamma \\Gamma_i}{1-\\gamma} E_{\\text{emit}}$$\n$$q_{\\text{total}} = \\Gamma_i \\left( E_i + \\frac{E_e - \\gamma E_{\\text{emit}}}{1-\\gamma} \\right)$$\nSubstituting the energy expressions and $\\Gamma_i = n\\sqrt{eT_e/m_i}$:\n$$q_{\\text{total}} = n\\sqrt{\\frac{eT_e}{m_i}} \\left( e(\\phi + 0.5T_e) + \\frac{e(2T_e) - \\gamma e(2T_{\\text{emit}})}{1-\\gamma} \\right)$$\n$$q_{\\text{total}} = e\\,n\\sqrt{\\frac{eT_e}{m_i}} \\left( (\\phi + 0.5T_e) + \\frac{2(T_e - \\gamma T_{\\text{emit}})}{1-\\gamma} \\right)$$\nThis formula is used to compute the heat load $q_{\\text{total}}$ in units of watts per square meter (W/m$^2$).\n\n**3. Calculation of the Sputtered Particle Flux ($\\Gamma_{\\text{sput}}$)**\n\nSputtering is caused by the impact of energetic ions on the wall material. The sputtered flux is the product of the incident ion flux $\\Gamma_i$ and the sputtering yield $Y$, which depends on the ion impact energy $E_i^{\\text{eV}}$.\n$$\\Gamma_{\\text{sput}} = Y(E_i^{\\text{eV}})\\,\\Gamma_i$$\nThe ion impact energy in electronvolts is the sum of the energy gained from the potential drop and the initial kinetic energy:\n$$E_i^{\\text{eV}} = \\phi + 0.5\\,T_e$$\nThe sputtering yield $Y(E_i^{\\text{eV}})$ is given by a thresholded power-law model with parameters $E_{\\text{th}} = 30\\,\\text{eV}$, $Y_0 = 0.01$, $E_{\\text{ref}} = 100\\,\\text{eV}$, and $\\alpha = 0.5$:\n$$Y(E_i^{\\text{eV}}) = \\begin{cases}\n0  \\text{if } E_i^{\\text{eV}}  E_{\\text{th}}, \\\\\nY_0 \\left(\\dfrac{E_i^{\\text{eV}}}{E_{\\text{ref}}}\\right)^{\\alpha}  \\text{if } E_i^{\\text{eV}} \\ge E_{\\text{th}}.\n\\end{cases}$$\nThe final sputtered flux $\\Gamma_{\\text{sput}}$ is calculated in units of particles per square meter per second (m$^{-2}$s$^{-1}$).\n\n**Summary of Algorithm**\nFor each given parameter set $(T_e, n, \\gamma, T_{\\text{emit}})$, the computational procedure is as follows:\n1.  Calculate the sheath potential drop $\\phi$ using its derived formula.\n2.  Calculate the ion sound speed $c_s$ and the ion flux $\\Gamma_i$.\n3.  Calculate the total wall heat load $q_{\\text{total}}$ using its derived formula.\n4.  Calculate the ion impact energy in eV, $E_i^{\\text{eV}}$.\n5.  Determine the sputtering yield $Y(E_i^{\\text{eV}})$ based on the threshold condition.\n6.  Calculate the sputtered particle flux $\\Gamma_{\\text{sput}}$.\n7.  Collect the results $(\\phi, q_{\\text{total}}, \\Gamma_{\\text{sput}})$ for each case.\nThis procedure is implemented in the provided program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sheath potential, wall heat load, and sputtered flux for a\n    1D kinetic plasma sheath model.\n    \"\"\"\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_e = 9.1093837015e-31  # Electron mass in kg\n    m_i = 3.345e-27  # Deuterium ion mass in kg\n\n    # Sputtering model parameters\n    E_th = 30.0    # Sputtering energy threshold in eV\n    Y0 = 0.01      # Reference sputtering yield\n    E_ref = 100.0  # Reference energy for sputtering in eV\n    alpha = 0.5    # Sputtering yield power-law exponent\n\n    test_cases = [\n        # (Te in eV, n in m^-3, gamma, Temit in eV)\n        (25.0, 1.0e19, 0.0, 2.0),\n        (25.0, 1.0e19, 0.9, 2.0),\n        (100.0, 1.0e20, 0.0, 2.0),\n        (5.0, 1.0e18, 0.95, 1.0),\n        (50.0, 5.0e19, 0.958, 5.0),\n    ]\n\n    results = []\n\n    # Pre-compute the mass ratio factor for the phi calculation\n    mass_ratio_factor = np.sqrt(m_i / (2.0 * np.pi * m_e))\n    \n    # Check the physical constraint on gamma\n    gamma_limit = 1.0 - np.sqrt(2.0 * np.pi * m_e / m_i)\n\n    for case in test_cases:\n        Te, n, gamma, Temit = case\n\n        # --- 1. Compute Sheath Potential (phi) ---\n        # The equation for phi is: phi = Te * ln((1 - gamma) * sqrt(m_i / (2*pi*m_e)))\n        # A positive phi requires the argument of ln to be  1, which implies\n        # (1-gamma)  sqrt(2*pi*m_e/m_i) or gamma  1 - sqrt(2*pi*m_e/m_i)\n        if gamma = gamma_limit:\n            # This case is unphysical based on the model's constraints\n            # but we will proceed as per the problem's implicit assumption of validity.\n            # In a real scenario, this would signal sheath collapse.\n            # For this problem, we let the logarithm evaluate to a negative,\n            # resulting in a negative phi, which is a sign of this condition.\n            pass\n        \n        log_arg = (1.0 - gamma) * mass_ratio_factor\n        # Handle potential log of non-positive number, though test cases avoid this.\n        if log_arg = 0:\n            phi = -np.inf # Physically indicates sheath collapse\n        else:\n            phi = Te * np.log(log_arg)\n\n        # --- 2. Compute Particle Fluxes ---\n        # Ion sound speed: c_s = sqrt(e * Te / m_i)\n        c_s = np.sqrt(e * Te / m_i)\n        # Ion flux to the wall: Gamma_i = n * c_s\n        gamma_i = n * c_s\n\n        # --- 3. Compute Total Wall Heat Load (q_total) ---\n        # q_total = Gamma_i * (E_i + (E_e - gamma*E_emit)/(1-gamma))\n        # where E_i = e*(phi+0.5*Te), E_e=e*(2*Te), E_emit=e*(2*Temit)\n        # q_total = e*Gamma_i * ( (phi+0.5*Te) + 2*(Te - gamma*Temit)/(1-gamma) )\n        if (1.0 - gamma) == 0:\n            # Handle division by zero, physically corresponds to infinite electron flux\n            q_total = np.inf\n        else:\n            energy_term_V = (phi + 0.5 * Te) + (2.0 * (Te - gamma * Temit)) / (1.0 - gamma)\n            q_total = e * gamma_i * energy_term_V\n            \n        # --- 4. Compute Sputtered Flux (gamma_sput) ---\n        # Ion impact energy in eV\n        E_i_eV = phi + 0.5 * Te\n        \n        # Sputtering yield Y\n        if E_i_eV  E_th:\n            Y = 0.0\n        else:\n            Y = Y0 * ((E_i_eV / E_ref) ** alpha)\n            \n        # Sputtered particle flux\n        gamma_sput = Y * gamma_i\n\n        results.extend([phi, q_total, gamma_sput])\n\n    # Format the output string as required.\n    output_str = '[' + ','.join([f\"{val:.6f}\" for val in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}