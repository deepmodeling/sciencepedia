{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，我们通过动手实践来巩固理解。第一个练习将带领我们探索预鞘层，这是等离子体在进入德拜鞘层之前的一个关键区域。通过分析电场加速和碰撞阻力之间的基本平衡，我们将推导出预鞘层的特征长度尺度，这是连接等离子体主体与边界的关键参数 。",
            "id": "3999663",
            "problem": "考虑在一个聚变相关等离子体的磁无约束区域中，邻近材料壁的一个一维、稳态、弱碰撞预鞘层，其中离子-中性粒子散射主导离子动量弛豫。电荷为 $q_{i}$、质量为 $m_{i}$ 的离子在空间均匀的电场 $E$ 下运动，并与静止的中性粒子发生弹性碰撞。使用 Bhatnagar–Gross–Krook (BGK) 碰撞算符对离子动力学进行建模，其中离子-中性粒子碰撞频率 $\\nu_{in}$ 为常数，并假设中性粒子的参考分布无漂移。设上游离子分布为近麦克斯韦分布，离子温度为 $T_{i}$，并将离子热速度定义为 $v_{Ti} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}}$。\n\n在预鞘层入口处，离子的定向速度与 $v_{Ti}$ 相比很小，其定向运动由电场驱动的加速度与碰撞阻力之间的平衡所建立。将预鞘层长度尺度 $\\ell_{p}$ 定义为这样一个特征距离：当电场加速度 $q_{i} E$ 在终端定向速度 $u_{i} = v_{Ti}$ 时与碰撞阻力 $m_{i} \\nu_{in} u_{i}$ 相平衡的条件下，电场在该距离上所做的功等于与速度 $v_{Ti}$ 对应的定向动能。仅使用参数 $\\nu_{in}$ 和 $v_{Ti}$ 以及基于第一性原理的动力学和能量论证，推导 $\\ell_{p}$ 的闭式表达式。\n\n将您的最终答案表示为用 $v_{Ti}$ 和 $\\nu_{in}$ 表示的 $\\ell_{p}$ 的单个解析表达式。无需进行数值计算，最终方框内的表达式不应包含单位。",
            "solution": "动力学的出发点是带有 Bhatnagar–Gross–Krook (BGK) 碰撞算符的稳态、一维离子玻尔兹曼方程，\n$$\nv\\,\\frac{\\partial f_{i}}{\\partial x} + \\frac{q_{i}}{m_{i}} E\\,\\frac{\\partial f_{i}}{\\partial v}\n= -\\nu_{in}\\,\\bigl(f_{i} - f_{i}^{(M)}\\bigr),\n$$\n其中 $f_{i}(x,v)$ 是离子分布函数，$f_{i}^{(M)}$ 是 BGK 算符的麦克斯韦参考态，且中性粒子是静止的，因此 BGK 算符以速率 $\\nu_{in}$ 使离子动量弛豫至零漂移。取速度一阶矩（乘以 $m_{i} v$ 并对 $v$ 积分）可得到沿 $x$ 方向的稳态动量平衡方程，\n$$\nm_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x} = q_{i} n_{i} E - m_{i} n_{i} \\nu_{in}\\,u_{i},\n$$\n其中 $n_{i}(x)$ 是离子密度，$u_{i}(x)$ 是离子漂移速度。在预鞘层入口区域，流动是亚声速的，且 $u_{i}$ 从一个很小的值开始增加。对于电场在碰撞作用下所能维持的特征终端漂移速度，我们考虑惯性项 $m_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x}$ 与驱动力和阻力相比可以忽略不计的情况；此时，局部力平衡得出\n$$\n\\frac{q_{i}}{m_{i}} E = \\nu_{in}\\,u_{i}.\n$$\n在终端定向速度 $u_{i} = v_{Ti}$ 处计算，可得出电场强度为\n$$\nE = \\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}.\n$$\n\n接下来，将预鞘层长度尺度 $\\ell_{p}$ 定义为电场做功达到与 $v_{Ti}$ 相关的定向动能所需的距离。电场在距离 $\\ell_{p}$ 上做的功是 $q_{i} E \\ell_{p}$，定向动能是 $\\frac{1}{2} m_{i} v_{Ti}^{2}$。令二者相等，\n$$\nq_{i} E\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\n代入从加速度-阻力平衡中得到的 $E$ 的表达式，\n$$\nq_{i} \\left(\\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}\\right)\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\n消去 $q_{i}$ 和 $m_{i}$ 并求解 $\\ell_{p}$，\n$$\n\\nu_{in}\\,v_{Ti}\\,\\ell_{p} = \\frac{1}{2} v_{Ti}^{2}\n\\quad\\Rightarrow\\quad\n\\ell_{p} = \\frac{v_{Ti}}{2\\,\\nu_{in}}.\n$$\n\n这个结果仅取决于离子热速度 $v_{Ti}$ 和离子-中性粒子碰撞频率 $\\nu_{in}$，符合题意要求。这个结果可以解释为在热速度下计算的离子-中性粒子平均自由程的一半，这与预鞘层长度由加速度和碰撞动量弛豫之间的平衡以及建立与热速度相当的定向运动所需能量共同决定的观点相一致。",
            "answer": "$$\\boxed{\\frac{v_{Ti}}{2 \\nu_{in}}}$$"
        },
        {
            "introduction": "接下来，我们将焦点从预鞘层转移到鞘层的另一端——器壁本身。理解粒子与器壁的相互作用对于精确预测壁面上的热流和粒子流至关重要。本练习  运用刘维尔定理 (Liouville's theorem) 这一基本原理，来构建考虑了弹性反射效应的电子分布函数，从而使我们能够精确计算壁面处的电子密度和电流。",
            "id": "3999695",
            "problem": "考虑一个与完美平面壁相邻的稳定、一维 (1D)、无碰撞的平面等离子体鞘层。电子源于准中性等离子体边界（$x=0$ 处），具有一维麦克斯韦分布函数 $f_{\\infty}(v)$，数密度为 $n_0$，电子温度为 $T_e$。壁位于 $x=L$ 处，其相对于等离子体边界电势 $\\phi_0=0$ 的电势为 $\\phi_w$。我们将元电荷记为 $e>0$，电子质量记为 $m_e$，玻尔兹曼常数记为 $k_\\mathrm{B}$。电子朝向壁的方向经历一个单调的排斥性电势降 $\\Delta \\phi = \\phi_0 - \\phi_w  0$。入射到壁上的电子中，一部分（比例为 $R \\in [0,1]$）被弹性、镜面反射（没有能量损失，垂直于壁的速度分量反向），另一部分（比例为 $1-R$）被吸收。\n\n仅从以下基本原理出发：\n- 沿无碰撞轨迹的单粒子能量守恒，$\\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x)$。\n- 适用于无碰撞动力学的刘维尔定理（相空间密度沿轨迹恒定）。\n- 等离子体边界处的一维麦克斯韦分布定义，\n$$\nf_{\\infty}(v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right),\n$$\n以及壁上系数为 $R$ 的镜面弹性反射边界条件。\n\n通过在 $f_e(L,v)$ 中整合入射和弹性反射的电子轨迹，推导壁处电子数密度 $n_e^{\\mathrm{wall}}$ 和壁吸收的电子电流密度 $J_e^{\\mathrm{abs}}$ 的表达式。你的推导必须明确展示能量守恒和刘维尔定理如何确定 $v0$（入射电子）时的 $f_{\\mathrm{in}}(L,v)$，以及反射边界条件如何确定 $v>0$（反射电子）时的 $f_{\\mathrm{ref}}(L,v)$。然后，计算得出 $n_e^{\\mathrm{wall}}$ 和 $J_e^{\\mathrm{abs}}$ 的积分，用 $n_0$, $T_e$, $\\Delta\\phi$, $R$, $m_e$, $e$ 和 $k_\\mathrm{B}$ 表示。\n\n数值实现要求：\n- 使用以电子伏特 (eV) 为单位给出的 $T_e$，并始终使用 $k_\\mathrm{B} T_e = e\\, T_e$ 将其转换为能量。\n- 对于下面的每个测试用例，计算两个量：\n    1) $n_e^{\\mathrm{wall}}$，单位为 $\\mathrm{m}^{-3}$，\n    2) $J_e^{\\mathrm{abs}}$，单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n- 你的程序必须生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起来，每个测试用例对应一个双元素列表 $[n_e^{\\mathrm{wall}}, J_e^{\\mathrm{abs}}]$。例如：“[[n1,J1],[n2,J2],...]”。\n\n测试套件参数集（每个为 $(n_0, T_e, \\phi_w, R)$）：\n- 用例 1 (正常路径): $(8.0\\times 10^{18}, 12.0, -25.0, 0.0)$。\n- 用例 2 (中等反射): $(8.0\\times 10^{18}, 12.0, -25.0, 0.3)$。\n- 用例 3 (全反射边界): $(8.0\\times 10^{18}, 12.0, -25.0, 1.0)$。\n- 用例 4 (边界条件检查，零电势降): $(1.0\\times 10^{19}, 5.0, 0.0, 0.0)$。\n- 用例 5 (边缘情况，低温下强耗尽): $(5.0\\times 10^{18}, 2.0, -10.0, 0.5)$。\n\n你的程序必须实现所推导的公式，并以上述确切格式生成输出。以 $\\mathrm{m}^{-3}$ 表示 $n_e^{\\mathrm{wall}}$，以 $\\mathrm{A}\\,\\mathrm{m}^{-2}$ 表示 $J_e^{\\mathrm{abs}}$，除了标准的双精度浮点表示外，没有舍入限制。",
            "solution": "该问题是有效的，因为它科学地基于已建立的等离子体动理学理论，具有充分且一致的条件，陈述客观。我们可以进行正式推导。\n\n壁处电子密度和吸收电流密度的推导基于刘维尔定理。该定理指出，在无碰撞系统中，分布函数 $f_e(x,v)$ 沿着粒子轨迹是恒定的。这些轨迹由总能量 $\\mathcal{E}$ 的守恒定律决定。\n\n步骤 1：定义能量和轨迹\n一个电荷为 $-e$（其中 $e$ 是元电荷，$e>0$）、质量为 $m_e$ 的电子的总能量由下式给出：\n$$ \\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n沿着连接等离子体边界点 $(0, v_0)$ 和鞘层中点 $(x, v)$ 的轨迹的能量守恒表示为：\n$$ \\frac{1}{2} m_e v_0^2 - e \\phi(0) = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n给定 $\\phi(0) = \\phi_0 = 0$，上式简化为：\n$$ \\frac{1}{2} m_e v_0^2 = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n由此，我们可以找到位于 $(x,v)$ 的任何粒子在源头的速度 $v_0$：\n$$ v_0^2 = v^2 - \\frac{2e\\phi(x)}{m_e} $$\n由于源头（$x=0$）的分布函数已知为一维麦克斯韦分布 $f_{\\infty}(v_0)$，刘维尔定理允许我们将任意点 $(x,v)$ 的分布函数写为 $f_e(x,v) = f_{\\infty}(v_0)$。\n\n步骤 2：构建壁处的分布函数\n在壁处（位于 $x=L$），电势为 $\\phi(L) = \\phi_w$。问题陈述了电子经历一个排斥性电势降 $\\Delta\\phi = \\phi_0 - \\phi_w > 0$，这意味着 $\\phi_w  0$。电子的势能 $-e\\phi$ 从边界处的 0 增加到壁处的 $-e\\phi_w > 0$。\n\n壁处的总电子分布函数 $f_e(L,v)$ 是入射电子（$v0$）和反射电子（$v>0$）的分布函数之和。\n$$ f_e(L,v) = \\begin{cases} f_{\\mathrm{in}}(L,v)   \\text{对于 } v  0 \\\\ f_{\\mathrm{ref}}(L,v)   \\text{对于 } v > 0 \\end{cases} $$\n\n对于壁处的入射电子（$v0$），它们在源头的速度 $v_0$ 也必须是负的。在 $x=L$ 处使用能量守恒方程：\n$$ v_0 = -\\sqrt{v^2 - \\frac{2e\\phi_w}{m_e}} $$\n应用刘维尔定理，我们得到 $f_{\\mathrm{in}}(L,v)$：\n$$ f_{\\mathrm{in}}(L,v) = f_{\\infty}(v_0) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v_0^2}{2 k_\\mathrm{B} T_e}\\right) $$\n代入 $v_0^2$ 的表达式：\n$$ f_{\\mathrm{in}}(L,v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e (v^2 - 2e\\phi_w/m_e)}{2 k_\\mathrm{B} T_e}\\right) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) $$\n此表达式对 $v0$ 有效。电子只有在初始动能足以克服势垒时才能到达壁：$\\frac{1}{2}m_e v_0^2 \\ge -e\\phi_w$。此条件确保壁处速度 $v$ 是实数。\n\n对于反射电子（$v>0$），边界条件是系数为 $R$ 的镜面反射。这意味着以速度 $v_{\\mathrm{inc}}$ 入射的电子以速度 $v_{\\mathrm{ref}} = -v_{\\mathrm{inc}}$ 反射。粒子通量按 $R$ 进行缩放：\n$$ |v_{\\mathrm{ref}}| f_{\\mathrm{ref}}(L, v_{\\mathrm{ref}}) = R |v_{\\mathrm{inc}}| f_{\\mathrm{in}}(L, v_{\\mathrm{inc}}) $$\n对于反射速度 $v > 0$，相应的入射速度为 $-v  0$。因此，$v_{\\mathrm{ref}} = v$ 且 $v_{\\mathrm{inc}} = -v$。方程变为：\n$$ v f_{\\mathrm{ref}}(L, v) = R |-v| f_{\\mathrm{in}}(L, -v) = R v f_{\\mathrm{in}}(L, -v) $$\n这得到对于 $v>0$ 有 $f_{\\mathrm{ref}}(L,v) = R f_{\\mathrm{in}}(L,-v)$。由于 $f_{\\mathrm{in}}(L,v)$ 的表达式依赖于 $v^2$，它是 $v$ 的偶函数。因此，$f_{\\mathrm{in}}(L,-v) = f_{\\mathrm{in}}(L,v)$。\n$$ f_{\\mathrm{ref}}(L,v) = R \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right) \\quad \\text{对于 } v>0 $$\n\n步骤 3：推导壁处的电子数密度 $n_e^{\\mathrm{wall}}$\n数密度是分布函数的零阶矩：\n$$ n_e^{\\mathrm{wall}} = \\int_{-\\infty}^{\\infty} f_e(L,v) \\, dv = \\int_{-\\infty}^{0} f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} f_{\\mathrm{ref}}(L,v) \\, dv $$\n我们定义一个常数因子 $C_w = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right)$。\n$$ n_e^{\\mathrm{wall}} = C_w \\int_{-\\infty}^{0} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv + R C_w \\int_{0}^{\\infty} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\n这些积分是标准高斯积分。令 $a = \\frac{m_e}{2 k_\\mathrm{B} T_e}$。那么 $\\int_0^\\infty e^{-av^2}dv = \\int_{-\\infty}^0 e^{-av^2}dv = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。\n$$ \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} = \\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}} $$\n将此代回：\n$$ n_e^{\\mathrm{wall}} = C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) + R C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = (1+R) \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n\n步骤 4：推导吸收的电子电流密度 $J_e^{\\mathrm{abs}}$\n壁处的净电子粒子通量 $\\Gamma_e$ 是分布函数的一阶矩：\n$$ \\Gamma_e = \\int_{-\\infty}^{\\infty} v f_e(L,v) \\, dv = \\int_{-\\infty}^{0} v f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} v f_{\\mathrm{ref}}(L,v) \\, dv $$\n第一个积分是入射通量 $\\Gamma_{\\mathrm{in}}$，第二个是反射通量 $\\Gamma_{\\mathrm{ref}}$。\n$$ \\Gamma_{\\mathrm{in}} = C_w \\int_{-\\infty}^{0} v \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\n该积分计算结果为：\n$$ \\Gamma_{\\mathrm{in}} = C_w \\left[ -\\frac{k_\\mathrm{B} T_e}{m_e} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right]_{-\\infty}^{0} = C_w \\left( -\\frac{k_\\mathrm{B} T_e}{m_e} (1 - 0) \\right) = -C_w \\frac{k_\\mathrm{B} T_e}{m_e} $$\n代入 $C_w$：\n$$ \\Gamma_{\\mathrm{in}} = -n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\frac{k_\\mathrm{B} T_e}{m_e} = -n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n反射通量为 $\\Gamma_{\\mathrm{ref}} = \\int_{0}^{\\infty} v R f_{\\mathrm{in}}(L,-v) \\, dv = R \\int_{0}^{\\infty} v f_{\\mathrm{in}}(L,v) \\, dv = -R \\Gamma_{\\mathrm{in}}$。\n净粒子通量为 $\\Gamma_e = \\Gamma_{\\mathrm{in}} + \\Gamma_{\\mathrm{ref}} = \\Gamma_{\\mathrm{in}} - R \\Gamma_{\\mathrm{in}} = (1-R)\\Gamma_{\\mathrm{in}}$。这个净通量对应于被吸收的粒子。\n$$ \\Gamma_e = -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n吸收的电子电流密度 $J_e^{\\mathrm{abs}}$ 是电荷 ($-e$) 乘以净粒子通量：\n$$ J_e^{\\mathrm{abs}} = (-e) \\Gamma_e = (-e) \\left( -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) $$\n$$ J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n问题陈述 $T_e$ 以电子伏特 (eV) 给出，这意味着使用转换关系 $k_\\mathrm{B} T_{e,K} = e T_{e,eV}$。因此，指数项变为 $\\exp(\\frac{e\\phi_w}{e T_{e,eV}}) = \\exp(\\frac{\\phi_w}{T_{e,eV}})$，其中 $\\phi_w$ 的单位是伏特。\n\n用于实现的最终表达式为：\n1.  $n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n2.  $J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{e T_e}{2\\pi m_e}} \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n这里，$T_e$ 是以 eV 为单位的值，$\\phi_w$ 是以 V 为单位的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron number density and absorbed current density at a wall\n    in a plasma sheath based on a kinetic model.\n    \"\"\"\n\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_e = 9.1093837015e-31 # Electron mass in kg\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n0, Te, phi_w, R)\n    # n0: electron density at plasma edge (m^-3)\n    # Te: electron temperature (eV)\n    # phi_w: wall potential (V)\n    # R: reflection coefficient (dimensionless)\n    test_cases = [\n        (8.0e18, 12.0, -25.0, 0.0), # Case 1 (happy path)\n        (8.0e18, 12.0, -25.0, 0.3), # Case 2 (moderate reflection)\n        (8.0e18, 12.0, -25.0, 1.0), # Case 3 (full reflection boundary)\n        (1.0e19, 5.0, 0.0, 0.0),    # Case 4 (boundary condition check, zero drop)\n        (5.0e18, 2.0, -10.0, 0.5)   # Case 5 (edge case, strong depletion at low temp)\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, Te_eV, phi_w, R = case\n\n        # The term e*phi_w / (k_B*T_e) simplifies to phi_w / T_e\n        # when Te is in eV and phi_w is in V.\n        # This is because k_B*T_e[J] = e*T_e[eV]\n        if Te_eV == 0:\n            # Avoid division by zero or non-physical temperature\n            # In this problem, all Te_eV > 0, so this is a safeguard.\n            exp_term = 0.0\n        else:\n            exp_term = np.exp(phi_w / Te_eV)\n\n        # 1. Calculate electron number density at the wall, n_e^wall\n        # Formula: n_e_wall = 0.5 * (1 + R) * n0 * exp(e*phi_w / (k_B*T_e))\n        n_wall = 0.5 * (1 + R) * n0 * exp_term\n\n        # 2. Calculate absorbed electron current density to the wall, J_e^abs\n        # Formula: J_e_abs = (1 - R) * e * n0 * sqrt(k_B*T_e / (2*pi*m_e)) * exp(e*phi_w / (k_B*T_e))\n        # where k_B*T_e is e*Te_eV\n        kBT_e_joules = e * Te_eV\n        thermal_velocity_term = np.sqrt(kBT_e_joules / (2 * np.pi * m_e))\n        J_abs = (1 - R) * e * n0 * thermal_velocity_term * exp_term\n\n        results.append([n_wall, J_abs])\n\n    # Format the final output string exactly as required: [[n1,J1],[n2,J2],...]\n    # without extra spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个实践练习将预鞘层的离子加速与鞘层边界条件联系起来，并引入了更贴近实际的复杂性。为了形成稳定的鞘层，离子必须以满足玻姆判据 (Bohm criterion) 的最小速度进入。本练习  旨在将这一判据推广到包含多种离子和反应源的复杂等离子体中，这在聚变和工业等离子体应用中是常见情景。",
            "id": "3999628",
            "problem": "考虑一个聚变相关的低温等离子体中，从 $x=0$（上游）延伸到 $x=L$（鞘层边界）的一维稳态预鞘层。其中的粒子种类为电子（电荷 $q_e=-e$，质量 $m_e$）、正离子（电荷 $q_i=+e$，质量 $m_i$）和负离子（电荷 $q_n=-e$，质量 $m_n$）。假设存在一个空间均匀的电场 $E$，其方向指向壁（加速正离子向 $x$ 增加的方向运动，并排斥负离子），并且预鞘层中的源项主要由产生正离子的电子碰撞电离（速率为 $S_{ion}$）和产生负离子的电子附着（速率为 $S_{att}$）主导。目标是确定这些动理学源项如何改变上游分布函数和鞘层边界条件。\n\n计算模型必须从包含各离子种类 $s\\in\\{i,n\\}$ 源项的一维稳态弗拉索夫-玻尔兹曼方程出发：\n$$\nv\\,\\frac{\\partial f_s}{\\partial x}+\\frac{q_s E}{m_s}\\,\\frac{\\partial f_s}{\\partial v} = \\mathcal{C}_s[f_s] + S_s(x,v),\n$$\n其中 $f_s(x,v)$ 是分布函数，$\\mathcal{C}_s[\\cdot]$ 是一个碰撞算符，$S_s(x,v)$ 是一个动理学源，用于注入由反应产生的离子。假设：\n- 对于 $s=i$，$S_i(x,v)$ 表示电离过程，其产生的离子具有接近零的漂移速度，注入速度分布在 $v\\approx 0$ 附近，近似为一个局域麦克斯韦分布，其温度为中性气体温度，净体积产率为 $S_{ion}$（单位为 $\\mathrm{m^{-3}\\,s^{-1}}$）。\n- 对于 $s=n$，$S_n(x,v)$ 表示附着过程，其产生的负离子类似，净体积产率为 $S_{att}$（单位为 $\\mathrm{m^{-3}\\,s^{-1}}$）。\n- 碰撞足够弱，以至于在预鞘层长度 $L$ 上，对 $f_s$ 的主导效应是电场加速和源注入，即对于沿特征线的主导阶输运，可以忽略碰撞项 $\\mathcal{C}_s$。\n\n在这些假设下，沿特征线，离子速度根据牛顿第二定律沿 $x$ 演化：\n$$\n\\frac{dv_s}{dx} = \\frac{q_s E}{m_s}\\,\\frac{1}{v_s},\n$$\n积分可得\n$$\nv_s^2(x) = v_{s0}^2 + 2\\,\\frac{q_s E}{m_s}\\,(x-x_0),\n$$\n其中 $v_{s0}$ 是在注入/入口点 $x_0$ 的速度。对于在 $x=0$ 处平均漂移速度为 $u_{s0}$ 的上游粒子群，取 $v_{s0}\\approx u_{s0}$。对于在位置 $\\xi$ 产生、初始漂移可忽略的源粒子，取在 $x_0=\\xi$ 处 $v_{s0}\\approx 0$。\n\n通过 $f_s$ 的矩积分定义鞘层边界 $x=L$ 处的离子通量和密度，但通过以下物理上合理的近似来闭合模型：\n- 对于正离子，鞘层边界的漂移速度为 $u_i(L)=\\sqrt{u_{i0}^2+2\\,a_i\\,L}$，其中 $a_i=\\frac{e|E|}{m_i}$，通量随积分源线性增加：$\\Gamma_i(L)=\\Gamma_i(0)+S_{ion}\\,L$，其中 $\\Gamma_i(0)=n_{i0}u_{i0}$ 是上游正离子通量。\n- 对于负离子，由于排斥作用，漂移速度减小：$u_n(L)=\\sqrt{\\max\\{u_{n0}^2-2\\,a_n\\,L,\\,0\\}}$，其中 $a_n=\\frac{e|E|}{m_n}$，鞘层边界的通量仅由从上游进入的粒子贡献；局域附着产生的负离子向上游移动，不会到达 $x=L$。因此，如果 $u_n(L)0$，则 $\\Gamma_n(L)=\\Gamma_n(0)$，否则 $\\Gamma_n(L)=0$，其中 $\\Gamma_n(0)=n_{n0}u_{n0}$。\n- 对于 $u_s(L)0$，密度由漂移速度和通量通过 $n_s(L)=\\Gamma_s(L)/u_s(L)$ 得出，否则 $n_s(L)=0$。\n- 电子在鞘层边界附近遵循准中性预鞘层标度，因此取 $n_e(L)=n_i(L)-n_n(L)$ 并强制 $n_e(L)0$。\n\n为评估鞘层边界条件，需使用与上述动理学图像一致的多流体方程的低频线性化，从第一性原理推导出一个多组分推广的玻姆判据。考虑电子、正离子和负离子的等温闭合，温度分别为 $T_e$、$T_i$ 和 $T_n$。证明在鞘层边界，形成单调电势降的必要条件可以由一个不等式形式捕获\n$$\n\\mathcal{B}(L) \\le 0,\n$$\n其中 $\\mathcal{B}(L)$ 是一个依赖于 $n_i(L)$、$n_e(L)$、$n_n(L)$、$u_i(L)$、$u_n(L)$、$m_i$、$m_n$、$T_e$、$T_i$ 和 $T_n$ 的局域表达式。实现此表达式的计算，并报告该不等式是否满足。\n\n您的程序必须：\n- 计算如上定义的 $u_i(L)$、$u_n(L)$、$\\Gamma_i(L)$、$\\Gamma_n(L)$、$n_i(L)$、$n_n(L)$ 和 $n_e(L)$。\n- 计算一个与 $\\omega\\to 0$ 时的线性化多流体响应和波数为 $k$ 的平面波微扰一致的显式 $\\mathcal{B}(L)$，其中电子呈类玻尔兹曼响应，正离子在漂移速度 $u_i(L)$ 下以有限惯性响应，负离子在漂移速度 $u_n(L)$ 下以有限惯性响应。\n- 为每个测试用例返回一个布尔值，指出在给定参数下，$x=L$ 处的鞘层边界条件是否满足。\n\n使用以下常数和单位：\n- 元电荷 $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- 所有速度必须以 $\\mathrm{m/s}$ 计算，长度以 $\\mathrm{m}$ 计算，电场以 $\\mathrm{V/m}$ 计算，质量以 $\\mathrm{kg}$ 计算，温度以电子伏特给出，其中 $k_B T_s$ 通过 $k_B T_s = e\\cdot T_s[\\mathrm{eV}]$ 转换为 $\\mathrm{J}$。\n\n测试套件：\n为以下参数集提供结果，每个参数集为一个元组 $(E, L, m_i, m_n, T_e[\\mathrm{eV}], T_i[\\mathrm{eV}], T_n[\\mathrm{eV}], n_{i0}, n_{n0}, u_{i0}, u_{n0}, S_{ion}, S_{att})$：\n1. $(50.0,\\,0.05,\\,3.3436\\times 10^{-27},\\,1.6735\\times 10^{-27},\\,5.0,\\,0.10,\\,0.03,\\,5.0\\times 10^{17},\\,1.0\\times 10^{17},\\,100.0,\\,300.0,\\,1.0\\times 10^{19},\\,5.0\\times 10^{18})$。\n2. $(50.0,\\,0.05,\\,3.3436\\times 10^{-27},\\,1.6735\\times 10^{-27},\\,5.0,\\,0.10,\\,0.03,\\,5.0\\times 10^{17},\\,1.0\\times 10^{17},\\,100.0,\\,300.0,\\,0.0,\\,0.0)$。\n3. $(40.0,\\,0.05,\\,3.3436\\times 10^{-27},\\,1.6735\\times 10^{-27},\\,3.0,\\,0.05,\\,0.02,\\,5.0\\times 10^{17},\\,2.0\\times 10^{17},\\,50.0,\\,500.0,\\,1.0\\times 10^{18},\\,5.0\\times 10^{20})$。\n4. $(10.0,\\,0.10,\\,3.3436\\times 10^{-27},\\,1.6735\\times 10^{-27},\\,5.0,\\,0.10,\\,0.03,\\,5.0\\times 10^{17},\\,1.0\\times 10^{17},\\,100.0,\\,300.0,\\,5.0\\times 10^{18},\\,1.0\\times 10^{18})$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，\"[True,False,True,False]\"），其中每个条目是对应测试用例的鞘层边界条件的布尔结果，顺序与上面列出的一致。",
            "solution": "我们从包含离子种类 $s$ 动理学源项的一维稳态弗拉索夫-玻尔兹曼方程出发：\n$$\nv\\,\\frac{\\partial f_s}{\\partial x}+\\frac{q_s E}{m_s}\\,\\frac{\\partial f_s}{\\partial v} = \\mathcal{C}_s[f_s] + S_s(x,v).\n$$\n在预鞘层中，主导效应是电场加速和由反应引起的粒子产生；在距离 $L$ 上，我们忽略主导阶的 $\\mathcal{C}_s$。特征线遵循牛顿第二定律：\n$$\n\\frac{dv_s}{dt}=\\frac{q_s E}{m_s},\\quad \\frac{dx}{dt}=v_s.\n$$\n消去时间，我们得到\n$$\n\\frac{dv_s}{dx} = \\frac{q_s E}{m_s}\\,\\frac{1}{v_s}\\quad\\Rightarrow\\quad v_s^2(x)=v_{s0}^2+2\\,\\frac{q_s E}{m_s}\\,(x-x_0).\n$$\n对于 $q_i=+e$ 的正离子，一个均匀电场 $E>0$（指向壁）产生加速度大小 $a_i=\\frac{e|E|}{m_i}0$，所以\n$$\nu_i(L)=\\sqrt{u_{i0}^2+2\\,a_i\\,L}.\n$$\n对于 $q_n=-e$ 的负离子，电场排斥它们，所以它们在 $x=L$ 处的漂移速度是\n$$\nu_n(L)=\\sqrt{\\max\\{u_{n0}^2-2\\,a_n\\,L,\\,0\\}},\\quad a_n=\\frac{e|E|}{m_n}.\n$$\n接下来，我们根据上游粒子群和源来构建鞘层边界的通量和密度。电离源增加了朝向鞘层边界的正离子通量；对具有均匀体积产率 $S_{ion}$ 的通量连续性方程进行积分，得到\n$$\n\\Gamma_i(L)=\\Gamma_i(0)+\\int_0^L S_{ion}\\,dx = n_{i0}u_{i0}+S_{ion}\\,L.\n$$\n我们通过漂移速度近似密度\n$$\nn_i(L)=\\frac{\\Gamma_i(L)}{u_i(L)}.\n$$\n类似地，在给定电场下，由附着产生的负离子向上游移动（远离在 $x=L$ 处的鞘层边界），所以 $L$ 处的通量没有局域附着离子的贡献。因此，\n$$\n\\Gamma_n(L)=\n\\begin{cases}\n\\Gamma_n(0)=n_{n0}u_{n0},  \\text{若 }u_n(L)0,\\\\\n0, \\text{若 }u_n(L)=0,\n\\end{cases}\n\\quad\nn_n(L)=\n\\begin{cases}\n\\Gamma_n(L)/u_n(L), \\text{若 }u_n(L)0,\\\\\n0, \\text{若 }u_n(L)=0.\n\\end{cases}\n$$\n鞘层边界附近的电子遵循准中性标度，因此我们设置\n$$\nn_e(L)=n_i(L)-n_n(L),\n$$\n并在计算中强制 $n_e(L)0$。\n\n为推导多组分广义玻姆判据，我们对与动理学图像一致的多流体方程进行低频线性化。对于每个组分 $s$，围绕均匀稳态漂移 $u_{s0}$ 和密度 $n_{s0}$ 线性化的等温流体方程，对于平面波微扰 $\\propto e^{ikx-i\\omega t}$ 并在 $\\omega\\to 0$ 的极限下，得出：\n- 连续性方程：\n$$\nik\\,n_{s0}\\,\\delta u_s + ik\\,u_{s0}\\,\\delta n_s = 0 \\;\\Rightarrow\\; \\delta u_s = -\\frac{u_{s0}}{n_{s0}}\\,\\delta n_s.\n$$\n- 动量方程：\n$$\nik\\,m_s\\,u_{s0}\\,\\delta u_s = -ik\\,q_s\\,\\delta\\phi - ik\\,\\frac{k_B T_s}{n_{s0}}\\,\\delta n_s.\n$$\n消去 $\\delta u_s$，对于正离子 ($q_i=+e$)，得到\n$$\n-\\,m_i\\,\\frac{u_{i0}^2}{n_{i0}}\\,\\delta n_i = -e\\,\\delta\\phi - \\frac{k_B T_i}{n_{i0}}\\,\\delta n_i\n\\;\\Rightarrow\\;\n\\delta n_i = \\frac{e\\,n_{i0}}{m_i u_{i0}^2 - k_B T_i}\\,\\delta\\phi.\n$$\n对于负离子 ($q_n=-e$)，\n$$\n-\\,m_n\\,\\frac{u_{n0}^2}{n_{n0}}\\,\\delta n_n = +e\\,\\delta\\phi - \\frac{k_B T_n}{n_{n0}}\\,\\delta n_n\n\\;\\Rightarrow\\;\n\\delta n_n = -\\frac{e\\,n_{n0}}{m_n u_{n0}^2 + k_B T_n}\\,\\delta\\phi.\n$$\n在低频下，电子可以很好地用玻尔兹曼响应描述，\n$$\n\\delta n_e = \\frac{e\\,n_{e0}}{k_B T_e}\\,\\delta\\phi.\n$$\n线性化的泊松方程为\n$$\n-\\varepsilon_0 k^2\\,\\delta\\phi = e\\,(\\delta n_i - \\delta n_e - \\delta n_n).\n$$\n必要的鞘层边界条件断言，一个无穷小的电势降会产生正确符号的空间电荷，以允许一个单调解。计算 $\\delta\\phi$ 的系数，我们定义表达式\n$$\n\\mathcal{B} = \\frac{n_i}{m_i u_i^2 - k_B T_i} - \\frac{n_e}{k_B T_e} + \\frac{n_n}{m_n u_n^2 + k_B T_n},\n$$\n其中所有量均在 $x=L$ 处取值。鞘层形成的必要条件是\n$$\n\\mathcal{B} \\le 0.\n$$\n在单组分、冷离子极限（$n_n=0$, $T_i\\to 0$）和准中性（$n_e\\approx n_i$）条件下，这简化为 $\\frac{n_i}{m_i u_i^2} - \\frac{n_i}{k_B T_e} \\le 0$，即 $u_i^2 \\ge \\frac{k_B T_e}{m_i}$，这恢复了声速为 $c_s=\\sqrt{\\frac{k_B T_e}{m_i}}$ 的标准玻姆判据。\n\n每个测试用例的算法步骤：\n1. 计算 $a_i=\\frac{e|E|}{m_i}$ 和 $a_n=\\frac{e|E|}{m_n}$。\n2. 计算 $u_i(L)=\\sqrt{u_{i0}^2+2\\,a_i\\,L}$ 和 $u_n(L)=\\sqrt{\\max\\{u_{n0}^2-2\\,a_n\\,L,\\,0\\}}$。\n3. 计算通量：$\\Gamma_i(L)=n_{i0}u_{i0}+S_{ion}L$，如果 $u_n(L)0$ 则 $\\Gamma_n(L)=n_{n0}u_{n0}$，否则为 $0$。\n4. 计算密度：$n_i(L)=\\Gamma_i(L)/u_i(L)$；如果 $u_n(L)0$ 则 $n_n(L)=\\Gamma_n(L)/u_n(L)$，否则为 $0$；$n_e(L)=\\max\\{n_i(L)-n_n(L),\\,\\epsilon\\}$，其中 $\\epsilon0$ 为一个小值以防止除以零。\n5. 通过 $k_B T_s = e\\cdot T_s[\\mathrm{eV}]$ 将温度从电子伏特转换为焦耳，其中 $s\\in\\{e,i,n\\}$。\n6. 计算表达式 $\\mathcal{B}$ 并返回 $\\mathcal{B}\\le 0$ 的布尔结果。\n\n然后我们将该算法应用于指定的测试套件。最终程序按照测试套件的顺序打印一个包含四个布尔值的列表，指示每种情况下鞘层边界条件是否得到满足。",
            "answer": "```python\nimport numpy as np\n\n# Constants\ne_charge = 1.602176634e-19  # Coulomb\nepsilon0 = 8.854187817e-12  # F/m\n\ndef sheath_edge_condition(E, L, m_i, m_n, Te_eV, Ti_eV, Tn_eV,\n                          n_i0, n_n0, u_i0, u_n0, S_ion, S_att):\n    \"\"\"\n    Evaluate the generalized sheath-edge condition for given parameters.\n    Returns True if the condition is satisfied (B = 0), else False.\n    \"\"\"\n    # Accelerations (m/s^2), use magnitude of E\n    a_i = (e_charge * abs(E)) / m_i\n    a_n = (e_charge * abs(E)) / m_n\n\n    # Sheath-edge drifts (m/s)\n    u_i_L = np.sqrt(max(u_i0**2 + 2.0 * a_i * L, 0.0))\n    u_n_sq = u_n0**2 - 2.0 * a_n * L\n    if u_n_sq > 0.0:\n        u_n_L = np.sqrt(u_n_sq)\n        negative_reaches_edge = True\n    else:\n        u_n_L = 0.0\n        negative_reaches_edge = False\n\n    # Fluxes at sheath edge (m^-2 s^-1)\n    Gamma_i_L = n_i0 * u_i0 + S_ion * L\n    # Negative-ion flux at edge: only upstream contribution if they reach the edge\n    Gamma_n_L = (n_n0 * u_n0) if negative_reaches_edge else 0.0\n\n    # Densities at sheath edge (m^-3)\n    n_i_L = Gamma_i_L / u_i_L if u_i_L > 0.0 else 0.0\n    n_n_L = (Gamma_n_L / u_n_L) if negative_reaches_edge and (u_n_L > 0.0) else 0.0\n    # Quasi-neutral electron density\n    n_e_L = n_i_L - n_n_L\n    # Ensure positive electron density to avoid division by zero (physically n_e_L > 0)\n    n_e_L = max(n_e_L, 1e-12)\n\n    # Temperatures (J)\n    kTe = e_charge * Te_eV\n    kTi = e_charge * Ti_eV\n    kTn = e_charge * Tn_eV\n\n    # Generalized Bohm bracket at sheath edge\n    denom_i = m_i * (u_i_L**2) - kTi\n    # Numerical safeguard: if denom_i is very small or negative, the criterion will likely fail.\n    # Still compute B explicitly.\n    term_i = n_i_L / denom_i if denom_i != 0.0 else np.inf\n\n    term_e = n_e_L / kTe  # electrons Boltzmann-like\n    if negative_reaches_edge and u_n_L > 0.0:\n        denom_n = m_n * (u_n_L**2) + kTn\n        term_n = n_n_L / denom_n\n    else:\n        term_n = 0.0\n\n    B = term_i - term_e + term_n\n\n    return B = 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, L, m_i, m_n, Te_eV, Ti_eV, Tn_eV, n_i0, n_n0, u_i0, u_n0, S_ion, S_att)\n        (50.0, 0.05, 3.3436e-27, 1.6735e-27, 5.0, 0.10, 0.03, 5.0e17, 1.0e17, 100.0, 300.0, 1.0e19, 5.0e18),\n        (50.0, 0.05, 3.3436e-27, 1.6735e-27, 5.0, 0.10, 0.03, 5.0e17, 1.0e17, 100.0, 300.0, 0.0, 0.0),\n        (40.0, 0.05, 3.3436e-27, 1.6735e-27, 3.0, 0.05, 0.02, 5.0e17, 2.0e17, 50.0, 500.0, 1.0e18, 5.0e20),\n        (10.0, 0.10, 3.3436e-27, 1.6735e-27, 5.0, 0.10, 0.03, 5.0e17, 1.0e17, 100.0, 300.0, 5.0e18, 1.0e18),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, L, m_i, m_n, Te_eV, Ti_eV, Tn_eV, n_i0, n_n0, u_i0, u_n0, S_ion, S_att = case\n        result = sheath_edge_condition(E, L, m_i, m_n, Te_eV, Ti_eV, Tn_eV,\n                                       n_i0, n_n0, u_i0, u_n0, S_ion, S_att)\n        results.append(str(result).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}