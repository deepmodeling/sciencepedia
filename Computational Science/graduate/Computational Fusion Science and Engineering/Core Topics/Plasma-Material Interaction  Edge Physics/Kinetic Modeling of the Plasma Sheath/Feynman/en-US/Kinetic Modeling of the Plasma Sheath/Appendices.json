{
    "hands_on_practices": [
        {
            "introduction": "Before ions can enter the sheath, they must be accelerated from thermal speeds in the bulk plasma to satisfy the Bohm criterion. This practice explores the presheath, a quasi-neutral region where a weak electric field accelerates ions against collisional drag. By deriving the characteristic length scale of the presheath, $\\ell_p$, you will gain a fundamental understanding of the interplay between acceleration and collisions that initiates the entire sheath structure .",
            "id": "3999663",
            "problem": "Consider a one-dimensional, steady, weakly collisional presheath adjacent to a material wall in a magnetically unconfined region of a fusion-relevant plasma where ion–neutral scattering dominates ion momentum relaxation. Ions of charge $q_{i}$ and mass $m_{i}$ move under a spatially uniform electric field $E$ and undergo elastic collisions with stationary neutrals. Model the ion kinetics with the Bhatnagar–Gross–Krook (BGK) collision operator, using a constant ion–neutral collision frequency $\\nu_{in}$ and assuming that the neutral reference distribution has zero drift. Let the upstream ion distribution be near-Maxwellian with ion temperature $T_{i}$, and define the ion thermal speed by $v_{Ti} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}}$.\n\nIn the presheath entrance, the directed ion speed is small compared to $v_{Ti}$, and the directed motion is established by a balance between field-driven acceleration and collisional drag. Define the presheath length scale $\\ell_{p}$ as the characteristic distance over which the electric field does work equal to the directed kinetic energy corresponding to the speed $v_{Ti}$, under conditions where the electric acceleration $q_{i} E$ is balanced by the collisional drag $m_{i} \\nu_{in} u_{i}$ at the terminal directed speed $u_{i} = v_{Ti}$. Using only the parameters $\\nu_{in}$ and $v_{Ti}$ and first-principles kinetic and energy arguments, derive a closed-form expression for $\\ell_{p}$.\n\nExpress your final answer as a single analytic expression for $\\ell_{p}$ in terms of $v_{Ti}$ and $\\nu_{in}$. No numerical evaluation is required, and no units should be included in the final boxed expression.",
            "solution": "The kinetic starting point is the steady, one-dimensional ion Boltzmann equation with the Bhatnagar–Gross–Krook (BGK) collision operator,\n$$\nv\\,\\frac{\\partial f_{i}}{\\partial x} + \\frac{q_{i}}{m_{i}} E\\,\\frac{\\partial f_{i}}{\\partial v}\n= -\\nu_{in}\\,\\bigl(f_{i} - f_{i}^{(M)}\\bigr),\n$$\nwhere $f_{i}(x,v)$ is the ion distribution function, $f_{i}^{(M)}$ is the Maxwellian reference state for the BGK operator, and the neutrals are stationary so that the BGK operator relaxes ion momentum toward zero drift at rate $\\nu_{in}$. Taking the first velocity moment (multiplying by $m_{i} v$ and integrating over $v$) gives the steady momentum balance along $x$,\n$$\nm_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x} = q_{i} n_{i} E - m_{i} n_{i} \\nu_{in}\\,u_{i},\n$$\nwhere $n_{i}(x)$ is the ion density and $u_{i}(x)$ is the ion drift speed. In the presheath entrance region, the flow is subsonic and $u_{i}$ increases from a small value. For the characteristic terminal drift speed that the field sustains against collisions, we consider the regime where the inertial term $m_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x}$ is negligible compared to the forcing and drag; then the local force balance yields\n$$\n\\frac{q_{i}}{m_{i}} E = \\nu_{in}\\,u_{i}.\n$$\nEvaluated at the terminal directed speed $u_{i} = v_{Ti}$, this gives a field magnitude\n$$\nE = \\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}.\n$$\n\nNext, define the presheath length scale $\\ell_{p}$ as the distance required for the field to do work equal to the directed kinetic energy associated with $v_{Ti}$. The work done by the field over a distance $\\ell_{p}$ is $q_{i} E \\ell_{p}$, and the directed kinetic energy is $\\frac{1}{2} m_{i} v_{Ti}^{2}$. Equating these,\n$$\nq_{i} E\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\nSubstituting the expression for $E$ obtained from the acceleration–drag balance,\n$$\nq_{i} \\left(\\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}\\right)\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\nCanceling $q_{i}$ and $m_{i}$ and solving for $\\ell_{p}$,\n$$\n\\nu_{in}\\,v_{Ti}\\,\\ell_{p} = \\frac{1}{2} v_{Ti}^{2}\n\\quad\\Rightarrow\\quad\n\\ell_{p} = \\frac{v_{Ti}}{2\\,\\nu_{in}}.\n$$\n\nThis result depends only on the ion thermal speed $v_{Ti}$ and the ion–neutral collision frequency $\\nu_{in}$, as required. It can be interpreted as one-half of the ion–neutral mean free path evaluated at the thermal speed, consistent with the notion that the presheath length is set by the balance between acceleration and collisional momentum relaxation and by the energy required to establish a directed motion comparable to the thermal speed.",
            "answer": "$$\\boxed{\\frac{v_{Ti}}{2 \\nu_{in}}}$$"
        },
        {
            "introduction": "A crucial aspect of kinetic modeling is correctly describing particle behavior at boundaries. This exercise focuses on electrons, which are typically repelled by the sheath potential, and how they interact with the material wall. You will use Liouville's theorem to construct the electron velocity distribution function at the wall, incorporating the physical process of particle reflection, which is a foundational technique for building accurate kinetic simulations .",
            "id": "3999695",
            "problem": "Consider a steady, one-dimensional (1D), collisionless, planar plasma sheath adjacent to a perfectly planar wall. Electrons originate from the quasi-neutral plasma edge with a one-dimensional Maxwellian distribution function $f_{\\infty}(v)$ at $x=0$ with number density $n_0$ and electron temperature $T_e$. The wall is at $x=L$ with potential $\\phi_w$ relative to the plasma edge potential $\\phi_0=0$. We denote the elementary charge as $e0$, the electron mass as $m_e$, and the Boltzmann constant as $k_\\mathrm{B}$. Electrons experience a monotonic repelling potential drop $\\Delta \\phi = \\phi_0 - \\phi_w  0$ toward the wall. A fraction $R \\in [0,1]$ of electrons incident on the wall is elastically, specularly reflected (no energy loss and velocity component normal to the wall reverses sign), and a fraction $1-R$ is absorbed.\n\nStarting only from the following fundamental bases:\n- Conservation of single-particle energy, $\\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x)$, along collisionless trajectories.\n- Liouville's theorem for collisionless dynamics (phase-space density is constant along trajectories).\n- The one-dimensional Maxwellian definition at the plasma edge,\n$$\nf_{\\infty}(v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right),\n$$\nand the specular elastic reflection boundary condition at the wall with coefficient $R$.\n\nDerive expressions for the electron number density at the wall, $n_e^{\\mathrm{wall}}$, and the absorbed electron current density to the wall, $J_e^{\\mathrm{abs}}$, by incorporating the incident and the elastically reflected electron trajectories in $f_e(L,v)$. Your derivation must explicitly show how conservation of energy and Liouville's theorem determine $f_{\\mathrm{in}}(L,v)$ for $v0$ (incident electrons) and how the reflection boundary condition determines $f_{\\mathrm{ref}}(L,v)$ for $v0$ (reflected electrons). Then, compute the integrals that yield $n_e^{\\mathrm{wall}}$ and $J_e^{\\mathrm{abs}}$ in terms of $n_0$, $T_e$, $\\Delta\\phi$, $R$, $m_e$, $e$, and $k_\\mathrm{B}$.\n\nNumerical implementation requirements:\n- Use $T_e$ given in electronvolts (eV), and consistently convert to energy using $k_\\mathrm{B} T_e = e\\, T_e$.\n- For each test case below, compute two quantities:\n    1) $n_e^{\\mathrm{wall}}$ in $\\mathrm{m}^{-3}$,\n    2) $J_e^{\\mathrm{abs}}$ in $\\mathrm{A}\\,\\mathrm{m}^{-2}$.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[n_e^{\\mathrm{wall}}, J_e^{\\mathrm{abs}}]$. For example: \"[[n1,J1],[n2,J2],...]\".\n\nTest suite parameter sets (each is $(n_0, T_e, \\phi_w, R)$):\n- Case 1 (happy path): $(8.0\\times 10^{18}, 12.0, -25.0, 0.0)$.\n- Case 2 (moderate reflection): $(8.0\\times 10^{18}, 12.0, -25.0, 0.3)$.\n- Case 3 (full reflection boundary): $(8.0\\times 10^{18}, 12.0, -25.0, 1.0)$.\n- Case 4 (boundary condition check, zero drop): $(1.0\\times 10^{19}, 5.0, 0.0, 0.0)$.\n- Case 5 (edge case, strong depletion at low temperature): $(5.0\\times 10^{18}, 2.0, -10.0, 0.5)$.\n\nYour program must implement the derived formulas and produce the output in the exact format described above. Express $n_e^{\\mathrm{wall}}$ in $\\mathrm{m}^{-3}$ and $J_e^{\\mathrm{abs}}$ in $\\mathrm{A}\\,\\mathrm{m}^{-2}$ without rounding constraints beyond standard double-precision floating-point representation.",
            "solution": "The problem is valid as it is scientifically grounded in established plasma kinetic theory, well-posed with sufficient and consistent conditions, and stated objectively. We can proceed with a formal derivation.\n\nThe derivation for the electron density and absorbed current density at the wall is based on Liouville's theorem, which states that the distribution function $f_e(x,v)$ is constant along particle trajectories in a collisionless system. The trajectories are governed by the conservation of total energy, $\\mathcal{E}$.\n\nStep 1: Define Energy and Trajectories\nThe total energy of an electron with charge $-e$ (where $e$ is the elementary charge, $e0$) and mass $m_e$ is given by:\n$$ \\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nConservation of energy along a trajectory connecting a point $(0, v_0)$ at the plasma edge to a point $(x, v)$ in the sheath is expressed as:\n$$ \\frac{1}{2} m_e v_0^2 - e \\phi(0) = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nGiven $\\phi(0) = \\phi_0 = 0$, this simplifies to:\n$$ \\frac{1}{2} m_e v_0^2 = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\nFrom this, we can find the velocity $v_0$ at the source for any particle found at $(x,v)$:\n$$ v_0^2 = v^2 - \\frac{2e\\phi(x)}{m_e} $$\nSince the distribution function at the source ($x=0$) is known to be a one-dimensional Maxwellian, $f_{\\infty}(v_0)$, Liouville's theorem allows us to write the distribution function at any point $(x,v)$ as $f_e(x,v) = f_{\\infty}(v_0)$.\n\nStep 2: Construct the Distribution Function at the Wall\nAt the wall, located at $x=L$, the potential is $\\phi(L) = \\phi_w$. The problem states a repelling potential drop for electrons, $\\Delta\\phi = \\phi_0 - \\phi_w  0$, which implies $\\phi_w  0$. The potential energy for an electron, $-e\\phi$, increases from $0$ at the edge to $-e\\phi_w  0$ at the wall.\n\nThe total electron distribution function at the wall, $f_e(L,v)$, is the sum of the distribution functions for incident electrons ($v0$) and reflected electrons ($v0$).\n$$ f_e(L,v) = \\begin{cases} f_{\\mathrm{in}}(L,v)  \\text{for } v  0 \\\\ f_{\\mathrm{ref}}(L,v)  \\text{for } v  0 \\end{cases} $$\n\nFor incident electrons ($v0$) at the wall, their source velocity $v_0$ must also be negative. Using the energy conservation equation at $x=L$:\n$$ v_0 = -\\sqrt{v^2 - \\frac{2e\\phi_w}{m_e}} $$\nApplying Liouville's theorem, we find $f_{\\mathrm{in}}(L,v)$:\n$$ f_{\\mathrm{in}}(L,v) = f_{\\infty}(v_0) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v_0^2}{2 k_\\mathrm{B} T_e}\\right) $$\nSubstituting the expression for $v_0^2$:\n$$ f_{\\mathrm{in}}(L,v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e (v^2 - 2e\\phi_w/m_e)}{2 k_\\mathrm{B} T_e}\\right) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) $$\nThis expression is valid for $v0$. Electrons can only reach the wall if they have sufficient initial kinetic energy to overcome the potential energy barrier: $\\frac{1}{2}m_e v_0^2 \\ge -e\\phi_w$. This condition ensures that the velocity at the wall, $v$, is real.\n\nFor reflected electrons ($v0$), the boundary condition is specular reflection with coefficient $R$. This means an electron incident with velocity $v_{\\mathrm{inc}}$ reflects with velocity $v_{\\mathrm{ref}} = -v_{\\mathrm{inc}}$. The particle flux is scaled by $R$:\n$$ |v_{\\mathrm{ref}}| f_{\\mathrm{ref}}(L, v_{\\mathrm{ref}}) = R |v_{\\mathrm{inc}}| f_{\\mathrm{in}}(L, v_{\\mathrm{inc}}) $$\nFor a reflected velocity $v  0$, the corresponding incident velocity is $-v  0$. Thus, $v_{\\mathrm{ref}} = v$ and $v_{\\mathrm{inc}} = -v$. The equation becomes:\n$$ v f_{\\mathrm{ref}}(L, v) = R |-v| f_{\\mathrm{in}}(L, -v) = R v f_{\\mathrm{in}}(L, -v) $$\nThis yields $f_{\\mathrm{ref}}(L,v) = R f_{\\mathrm{in}}(L,-v)$ for $v0$. Since the expression for $f_{\\mathrm{in}}(L,v)$ depends on $v^2$, it is an even function of $v$. Therefore, $f_{\\mathrm{in}}(L,-v) = f_{\\mathrm{in}}(L,v)$.\n$$ f_{\\mathrm{ref}}(L,v) = R \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right) \\quad \\text{for } v0 $$\n\nStep 3: Derive Electron Number Density at the Wall, $n_e^{\\mathrm{wall}}$\nThe number density is the zeroth moment of the distribution function:\n$$ n_e^{\\mathrm{wall}} = \\int_{-\\infty}^{\\infty} f_e(L,v) \\, dv = \\int_{-\\infty}^{0} f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} f_{\\mathrm{ref}}(L,v) \\, dv $$\nLet's define a constant factor $C_w = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right)$.\n$$ n_e^{\\mathrm{wall}} = C_w \\int_{-\\infty}^{0} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv + R C_w \\int_{0}^{\\infty} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\nThe integrals are standard Gaussian integrals. Let $a = \\frac{m_e}{2 k_\\mathrm{B} T_e}$. Then $\\int_0^\\infty e^{-av^2}dv = \\int_{-\\infty}^0 e^{-av^2}dv = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$.\n$$ \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} = \\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}} $$\nSubstituting this back:\n$$ n_e^{\\mathrm{wall}} = C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) + R C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = (1+R) \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n\nStep 4: Derive Absorbed Electron Current Density, $J_e^{\\mathrm{abs}}$\nThe net electron particle flux at the wall, $\\Gamma_e$, is the first moment of the distribution function:\n$$ \\Gamma_e = \\int_{-\\infty}^{\\infty} v f_e(L,v) \\, dv = \\int_{-\\infty}^{0} v f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} v f_{\\mathrm{ref}}(L,v) \\, dv $$\nThe first integral is the incident flux, $\\Gamma_{\\mathrm{in}}$, and the second is the reflected flux, $\\Gamma_{\\mathrm{ref}}$.\n$$ \\Gamma_{\\mathrm{in}} = C_w \\int_{-\\infty}^{0} v \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\nThis integral evaluates to:\n$$ \\Gamma_{\\mathrm{in}} = C_w \\left[ -\\frac{k_\\mathrm{B} T_e}{m_e} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right]_{-\\infty}^{0} = C_w \\left( -\\frac{k_\\mathrm{B} T_e}{m_e} (1 - 0) \\right) = -C_w \\frac{k_\\mathrm{B} T_e}{m_e} $$\nSubstituting $C_w$:\n$$ \\Gamma_{\\mathrm{in}} = -n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\frac{k_\\mathrm{B} T_e}{m_e} = -n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe reflected flux is $\\Gamma_{\\mathrm{ref}} = \\int_{0}^{\\infty} v R f_{\\mathrm{in}}(L,-v) \\, dv = R \\int_{0}^{\\infty} v f_{\\mathrm{in}}(L,v) \\, dv = -R \\Gamma_{\\mathrm{in}}$.\nThe net particle flux is $\\Gamma_e = \\Gamma_{\\mathrm{in}} + \\Gamma_{\\mathrm{ref}} = \\Gamma_{\\mathrm{in}} - R \\Gamma_{\\mathrm{in}} = (1-R)\\Gamma_{\\mathrm{in}}$. This net flux corresponds to the absorbed particles.\n$$ \\Gamma_e = -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe absorbed electron current density, $J_e^{\\mathrm{abs}}$, is the charge ($-e$) times the net particle flux:\n$$ J_e^{\\mathrm{abs}} = (-e) \\Gamma_e = (-e) \\left( -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) $$\n$$ J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\nThe problem states $T_e$ is given in electron-volts (eV), which implies the use of the conversion $k_\\mathrm{B} T_{e,K} = e T_{e,eV}$. Thus, the exponential term becomes $\\exp(\\frac{e\\phi_w}{e T_{e,eV}}) = \\exp(\\frac{\\phi_w}{T_{e,eV}})$ where $\\phi_w$ is in Volts.\n\nThe final expressions for implementation are:\n1.  $n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n2.  $J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{e T_e}{2\\pi m_e}} \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\nHere, $T_e$ is the value in eV and $\\phi_w$ is the value in V.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron number density and absorbed current density at a wall\n    in a plasma sheath based on a kinetic model.\n    \"\"\"\n\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_e = 9.1093837015e-31 # Electron mass in kg\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n0, Te, phi_w, R)\n    # n0: electron density at plasma edge (m^-3)\n    # Te: electron temperature (eV)\n    # phi_w: wall potential (V)\n    # R: reflection coefficient (dimensionless)\n    test_cases = [\n        (8.0e18, 12.0, -25.0, 0.0), # Case 1 (happy path)\n        (8.0e18, 12.0, -25.0, 0.3), # Case 2 (moderate reflection)\n        (8.0e18, 12.0, -25.0, 1.0), # Case 3 (full reflection boundary)\n        (1.0e19, 5.0, 0.0, 0.0),    # Case 4 (boundary condition check, zero drop)\n        (5.0e18, 2.0, -10.0, 0.5)   # Case 5 (edge case, strong depletion at low temp)\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, Te_eV, phi_w, R = case\n\n        # The term e*phi_w / (k_B*T_e) simplifies to phi_w / T_e\n        # when Te is in eV and phi_w is in V.\n        # This is because k_B*T_e[J] = e*T_e[eV]\n        if Te_eV = 0:\n            # Avoid division by zero or non-physical temperature\n            # In this problem, all Te_eV  0, so this is a safeguard.\n            exp_term = 0.0\n        else:\n            exp_term = np.exp(phi_w / Te_eV)\n\n        # 1. Calculate electron number density at the wall, n_e^wall\n        # Formula: n_e_wall = 0.5 * (1 + R) * n0 * exp(e*phi_w / (k_B*T_e))\n        n_wall = 0.5 * (1 + R) * n0 * exp_term\n\n        # 2. Calculate absorbed electron current density to the wall, J_e^abs\n        # Formula: J_e_abs = (1 - R) * e * n0 * sqrt(k_B*T_e / (2*pi*m_e)) * exp(e*phi_w / (k_B*T_e))\n        # where k_B*T_e is e*Te_eV\n        kBT_e_joules = e * Te_eV\n        thermal_velocity_term = np.sqrt(kBT_e_joules / (2 * np.pi * m_e))\n        J_abs = (1 - R) * e * n0 * thermal_velocity_term * exp_term\n\n        results.append([n_wall, J_abs])\n\n    # Format the final output string exactly as required: [[n1,J1],[n2,J2],...]\n    # without extra spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "In many realistic scenarios, the sheath is not collisionless, and these interactions profoundly alter the energy of ions arriving at a surface. This practice moves beyond simple collisionless models to explore how charge-exchange (CX) events create a broad ion energy distribution at the wall, rather than a single monoenergetic beam. By modeling this process, you will directly connect the kinetic physics within the sheath to a critical real-world application: predicting material erosion due to sputtering .",
            "id": "3999685",
            "problem": "Consider a one-dimensional, steady-state plasma sheath in front of a planar wall in a fusion-relevant plasma, where ions are accelerated by an electrostatic potential drop and undergo collisions with neutrals. The kinetic evolution of the ion distribution function $f(x,v)$ is governed by the one-dimensional Boltzmann equation\n$$\nv \\frac{\\partial f}{\\partial x} + \\frac{q_i}{m_i} E(x) \\frac{\\partial f}{\\partial v} = C_{\\mathrm{BGK}}[f] + C_{\\mathrm{FP}}[f] + C_{\\mathrm{CX}}[f],\n$$\nwhere $x$ is the coordinate normal to the wall with $x=0$ at the wall, $v$ is the ion velocity, $q_i$ is the ion charge, $m_i$ is the ion mass, $E(x) = -\\frac{d\\phi}{dx}$ is the electric field associated with the sheath potential $\\phi(x)$, $C_{\\mathrm{BGK}}[f]$ is the Bhatnagar–Gross–Krook (BGK) collision operator (a relaxation model), $C_{\\mathrm{FP}}[f]$ is the Fokker–Planck operator (small-angle scattering and energy diffusion), and $C_{\\mathrm{CX}}[f]$ is the charge-exchange collision operator with neutral atoms.\n\nAssume the following physically justified simplifications for a strongly biased sheath:\n- The charge-exchange process produces a fast neutral and a newborn ion whose kinetic energy is approximately thermal, i.e., close to zero compared to the sheath potential energy scale. Therefore, after the last charge-exchange event at position $x$, the newborn ion starts effectively from rest and is accelerated by the remaining potential $\\phi(x)$ to the wall.\n- Neutral density and the charge-exchange cross section are spatially uniform across the sheath, so the spatial hazard for charge exchange is constant. The charge-exchange events along the path from the sheath edge to the wall can be modeled as a homogeneous Poisson process with mean free path $\\lambda_{\\mathrm{cx}}$.\n- The sheath potential is monotonic and can be parameterized as\n$$\n\\phi(x) = \\Phi_s \\left(\\frac{x}{s}\\right)^{\\alpha},\n$$\nwhere $\\phi(0)=0$ at the wall, $\\phi(s)=\\Phi_s$ at the sheath edge, $s$ is the sheath thickness, $\\Phi_s$ is the total potential drop across the sheath, and $\\alpha0$ is a known profile exponent.\n- The collisionless ion energy at the wall includes the potential energy $q_i \\Phi_s$ and the initial kinetic energy associated with the ion sound speed at the sheath edge, which for ions with electron temperature $T_e$ is approximately $\\frac{1}{2} k_B T_e$; expressed in electronvolts, this is $\\frac{1}{2} T_e$.\n\nUnder these assumptions, the energy of an ion at the wall in electronvolts (eV) is modeled as follows:\n- If the ion suffers no charge-exchange collision across the sheath (a discrete event with probability $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$), then\n$$\nE_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e.\n$$\n- If the ion undergoes charge exchange and the last charge-exchange event occurs at position $x \\in [0,s]$, then the ion energy at the wall is\n$$\nE(x) = \\Phi_s \\left(\\frac{x}{s}\\right)^{\\alpha}.\n$$\nThe unconditional probability density for the last charge-exchange event position is\n$$\nf_{\\mathrm{last}}(x) = \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}, \\quad x \\in [0,s],\n$$\nand there is a discrete mass $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$ for no collision.\n\nDefine the sputtering threshold energy $E_{\\mathrm{th}}$ (in electronvolts). The “sputtering impact energy spectrum at the wall” is taken to be the distribution of ion impact energies at the wall restricted to those ion energies greater than or equal to $E_{\\mathrm{th}}$.\n\nYour tasks:\n1. Starting from the one-dimensional Boltzmann equation and the above assumptions, derive the expression for the unconditional mean ion energy at the wall, $\\langle E \\rangle$, in electronvolts, as a function of $s$, $\\Phi_s$, $\\lambda_{\\mathrm{cx}}$, $\\alpha$, and $T_e$. Also derive the unconditional mean energy loss per ion due to charge exchange, $\\langle \\Delta E \\rangle$, defined as the difference between the collisionless energy $E_{\\mathrm{no}}$ and the actual ion energy $E$ averaged over the ensemble.\n2. Derive the fraction of ions that arrive at the wall with energy greater than or equal to the sputtering threshold $E_{\\mathrm{th}}$, as a decimal number. Then derive the mean energy of the sputtering-impacting ions (restricted to those with $E \\ge E_{\\mathrm{th}}$), $\\langle E \\rangle_{\\mathrm{sput}}$, in electronvolts.\n3. Implement a program that computes these quantities for the test suite given below. You must not perform any stochastic sampling; instead, use the derived analytical formulas.\n\nAll answers that involve energy must be expressed in electronvolts (eV). Any angle that might appear (none are expected) must be expressed in radians. Decimal fractions must be provided as pure decimals or fractions without the percent sign.\n\nTest suite:\n- Case A (collision-rare, near-collisionless reference):\n  - $s = 0.005 \\, \\mathrm{m}$,\n  - $\\Phi_s = 200 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.5 \\, \\mathrm{m}$,\n  - $\\alpha = \\tfrac{4}{3}$,\n  - $T_e = 10 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 30 \\, \\mathrm{eV}$.\n- Case B (collision-dominated):\n  - $s = 0.005 \\, \\mathrm{m}$,\n  - $\\Phi_s = 200 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.0005 \\, \\mathrm{m}$,\n  - $\\alpha = 1$,\n  - $T_e = 10 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 50 \\, \\mathrm{eV}$.\n- Case C (moderate collisions, high threshold):\n  - $s = 0.002 \\, \\mathrm{m}$,\n  - $\\Phi_s = 100 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.001 \\, \\mathrm{m}$,\n  - $\\alpha = 2$,\n  - $T_e = 5 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 75 \\, \\mathrm{eV}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each test case, output a list of four floats: $[\\langle E \\rangle, \\langle \\Delta E \\rangle, \\text{fraction}_{\\ge E_{\\mathrm{th}}}, \\langle E \\rangle_{\\mathrm{sput}}]$.\n- The overall output should be a single list containing these per-case lists, for example, $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$.\n- Round all floats to six decimal places in the printed output.",
            "solution": "The problem requires the derivation and computation of several statistical quantities related to the energy of ions impacting a wall, based on a simplified kinetic model of a one-dimensional plasma sheath. I will first present the complete analytical derivations for the required quantities, followed by the implementation of these formulas to solve for the given test cases. The entire derivation process is based on the provided probabilistic model for ion behavior.\n\nThe model for the ion energy $E$ at the wall ($x=0$) is a mixed distribution. An ion's history falls into one of two mutually exclusive categories:\n1.  **Collisionless Trajectory**: The ion traverses the entire sheath of thickness $s$ without undergoing a charge-exchange (CX) collision. This occurs with a given probability $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$. The resulting energy is a fixed value, $E_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e$.\n2.  **Collisional Trajectory**: The ion undergoes at least one CX collision. The model simplifies this by considering only the position of the last CX event, $x \\in [0,s]$. The probability density function for this position is given as $f_{\\mathrm{last}}(x) = \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}$. The ion is assumed to be created at rest at position $x$ and is accelerated by the remaining potential, arriving at the wall with energy $E(x) = \\phi(x) = \\Phi_s (x/s)^\\alpha$. The total probability for this case is $\\int_0^s f_{\\mathrm{last}}(x) dx = 1 - e^{-s/\\lambda_{\\mathrm{cx}}}$.\n\nThe derivations for all required quantities are based on the fundamental principles of probability theory, specifically the law of total expectation for computing mean values over mixed distributions.\n\n### Task 1: Unconditional Mean Energy and Mean Energy Loss\n\n#### Unconditional Mean Ion Energy, $\\langle E \\rangle$\nThe mean ion energy at the wall, $\\langle E \\rangle$, is the expectation of the energy random variable $E$. It is calculated by summing the contributions from the collisionless and collisional scenarios, weighted by their respective probabilities:\n$$\n\\langle E \\rangle = E[\\text{collisionless}] \\cdot P(\\text{collisionless}) + E[\\text{collisional}]\n$$\nMore formally, using the law of total expectation:\n$$\n\\langle E \\rangle = E_{\\mathrm{no}} \\cdot P_0 + \\int_0^s E(x) f_{\\mathrm{last}}(x) dx\n$$\nSubstituting the given expressions for $E_{\\mathrm{no}}$, $P_0$, $E(x)$, and $f_{\\mathrm{last}}(x)$:\n$$\n\\langle E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\int_0^s \\left(\\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha\\right) \\left(\\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}\\right) dx\n$$\nThe integral term represents the contribution from all collisional trajectories. Let's evaluate this integral:\n$$\nI_E = \\int_0^s \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} x^\\alpha e^{-x/\\lambda_{\\mathrm{cx}}} dx = \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^s x^\\alpha e^{-x/\\lambda_{\\mathrm{cx}}} dx\n$$\nWe perform a change of variables. Let $t = x/\\lambda_{\\mathrm{cx}}$, which implies $x = \\lambda_{\\mathrm{cx}} t$ and $dx = \\lambda_{\\mathrm{cx}} dt$. The integration limits change from $x \\in [0,s]$ to $t \\in [0, s/\\lambda_{\\mathrm{cx}}]$.\n$$\nI_E = \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^{s/\\lambda_{\\mathrm{cx}}} (\\lambda_{\\mathrm{cx}} t)^\\alpha e^{-t} (\\lambda_{\\mathrm{cx}} dt) = \\frac{\\Phi_s \\lambda_{\\mathrm{cx}}^{\\alpha+1}}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt\n$$\nThe remaining integral is the definition of the lower incomplete gamma function, $\\gamma(a,z) = \\int_0^z t^{a-1} e^{-t} dt$. Here, the integrand has $t^\\alpha$, so the first argument of the function is $a = \\alpha+1$.\n$$\n\\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\nSubstituting this back, we obtain the final expression for the unconditional mean energy:\n$$\n\\langle E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n\n#### Unconditional Mean Energy Loss, $\\langle \\Delta E \\rangle$\nThe mean energy loss $\\langle \\Delta E \\rangle$ is defined as the average difference between the collisionless energy $E_{\\mathrm{no}}$ and the actual ion energy $E$. Using the linearity of the expectation operator:\n$$\n\\langle \\Delta E \\rangle = \\langle E_{\\mathrm{no}} - E \\rangle = \\langle E_{\\mathrm{no}} \\rangle - \\langle E \\rangle\n$$\nSince $E_{\\mathrm{no}}$ is a constant, its expectation is the value itself, $\\langle E_{\\mathrm{no}} \\rangle = E_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e$.\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) - \\langle E \\rangle\n$$\nSubstituting the derived expression for $\\langle E \\rangle$:\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) - \\left[ \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) \\right]\n$$\nFactoring out the $E_{\\mathrm{no}}$ term:\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) \\left(1 - e^{-s/\\lambda_{\\mathrm{cx}}}\\right) - \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n\n### Task 2: Sputtering-Related Quantities\n\n#### Fraction of Sputtering Ions, $F_{\\mathrm{sput}} = P(E \\ge E_{\\mathrm{th}})$\nThe fraction of ions that strike the wall with energy greater than or equal to the sputtering threshold $E_{\\mathrm{th}}$ is the total probability $P(E \\ge E_{\\mathrm{th}})$. We again sum the probabilities from the collisionless and collisional cases.\n$$\nF_{\\mathrm{sput}} = P(E \\ge E_{\\mathrm{th}}) = P(E \\ge E_{\\mathrm{th}} \\text{ and collisionless}) + P(E \\ge E_{\\mathrm{th}} \\text{ and collisional})\n$$\nThe contribution from collisionless ions is non-zero only if their energy $E_{\\mathrm{no}}$ meets the threshold:\n$$\nP(E \\ge E_{\\mathrm{th}} \\text{ and collisionless}) = P(\\text{collisionless}) \\cdot \\mathbb{I}(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}}) = e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}\\left(\\Phi_s + \\frac{1}{2} T_e \\ge E_{\\mathrm{th}}\\right)\n$$\nwhere $\\mathbb{I}(\\cdot)$ is the indicator function.\n\nFor a collisional ion, the energy $E(x) = \\Phi_s(x/s)^\\alpha$ must be at least $E_{\\mathrm{th}}$. This condition defines a minimum creation position $x_{\\mathrm{th}}$:\n$$\n\\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha \\ge E_{\\mathrm{th}} \\implies \\frac{x}{s} \\ge \\left(\\frac{E_{\\mathrm{th}}}{\\Phi_s}\\right)^{1/\\alpha} \\implies x \\ge s \\left(\\frac{E_{\\mathrm{th}}}{\\Phi_s}\\right)^{1/\\alpha} =: x_{\\mathrm{th}}\n$$\nAn ion created by CX at $x \\in [0,s]$ will cause sputtering if its creation point $x \\ge x_{\\mathrm{th}}$. The range of such positions within the sheath is $[x_{\\mathrm{th}}^*, s]$, where $x_{\\mathrm{th}}^* = \\max(0, \\min(s, x_{\\mathrm{th}}))$ ensures the position is physically valid. The probability for this is:\n$$\nP(E \\ge E_{\\mathrm{th}} \\text{ and collisional}) = \\int_{x_{\\mathrm{th}}^*}^s f_{\\mathrm{last}}(x) dx = \\int_{x_{\\mathrm{th}}^*}^s \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}} dx\n$$\n$$\n= \\left[-e^{-x/\\lambda_{\\mathrm{cx}}}\\right]_{x_{\\mathrm{th}}^*}^s = e^{-x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}} - e^{-s/\\lambda_{\\mathrm{cx}}}\n$$\nThe total fraction is the sum of the two contributions:\n$$\nF_{\\mathrm{sput}} = e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}\\left(\\Phi_s + \\frac{1}{2} T_e \\ge E_{\\mathrm{th}}\\right) + e^{-x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}} - e^{-s/\\lambda_{\\mathrm{cx}}}\n$$\n\n#### Mean Energy of Sputtering Ions, $\\langle E \\rangle_{\\mathrm{sput}}$\nThe mean energy of the sub-population of ions that cause sputtering is the conditional expectation $E[E | E \\ge E_{\\mathrm{th}}]$. By definition:\n$$\n\\langle E \\rangle_{\\mathrm{sput}} = \\frac{E[E \\cdot \\mathbb{I}(E \\ge E_{\\mathrm{th}})]}{P(E \\ge E_{\\mathrm{th}})} = \\frac{1}{F_{\\mathrm{sput}}} \\left( \\sum_{\\text{events}} E \\cdot P(E \\ge E_{\\mathrm{th}}) \\right)\n$$\nThe numerator is the first moment of the energy distribution, but restricted to energies $E \\ge E_{\\mathrm{th}}$. We compute its components:\n1.  **Collisionless contribution**: $E_{\\mathrm{no}} \\cdot P(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}} \\text{ and collisionless}) = E_{\\mathrm{no}} \\cdot e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}})$.\n2.  **Collisional contribution**: $\\int_{x_{\\mathrm{th}}^*}^s E(x) f_{\\mathrm{last}}(x) dx$. This is an integral similar to $I_E$ but with a different lower limit.\n$$\nI_{\\mathrm{sput}} = \\int_{x_{\\mathrm{th}}^*}^s \\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}} dx = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\int_{x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}}^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt\n$$\nThe integral resolves to a difference of incomplete gamma functions:\n$$\n\\int_{x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}}^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) - \\gamma\\left(\\alpha+1, \\frac{x_{\\mathrm{th}}^*}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\nThus, the collisional contribution to the numerator is:\n$$\nI_{\\mathrm{sput}} = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\left[\\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) - \\gamma\\left(\\alpha+1, \\frac{x_{\\mathrm{th}}^*}{\\lambda_{\\mathrm{cx}}}\\right)\\right]\n$$\nCombining these parts, the full expression for the mean sputtering energy is:\n$$\n\\langle E \\rangle_{\\mathrm{sput}} = \\frac{1}{F_{\\mathrm{sput}}} \\left( \\left(\\Phi_s + \\frac{1}{2}T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} \\mathbb{I}\\left(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}}\\right) + I_{\\mathrm{sput}} \\right)\n$$\nIf $F_{\\mathrm{sput}} = 0$, no ions cause sputtering, and the mean energy is undefined. In this case, we will return $0$.\n\nThese derived formulae are purely analytical and can be implemented directly for computation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammainc, gamma\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (s, Phi_s, lambda_cx, alpha, T_e, E_th)\n        (0.005, 200.0, 0.5, 4.0/3.0, 10.0, 30.0),\n        # Case B\n        (0.005, 200.0, 0.0005, 1.0, 10.0, 50.0),\n        # Case C\n        (0.002, 100.0, 0.001, 2.0, 5.0, 75.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        s, Phi_s, lambda_cx, alpha, T_e, E_th = case\n        \n        # --- Task 1: Mean Energy and Mean Energy Loss ---\n\n        # Intermediate variables\n        s_over_lambda = s / lambda_cx\n        E_no = Phi_s + 0.5 * T_e\n        P0 = np.exp(-s_over_lambda)\n        \n        # The lower incomplete gamma function gamma(a,x) is implemented in scipy as\n        # gammainc(a,x) * gamma(a), where gammainc is the regularized version.\n        g_s = gammainc(alpha + 1, s_over_lambda) * gamma(alpha + 1)\n        \n        # Contribution to mean energy from collisional ions\n        coll_energy_contrib = Phi_s * (lambda_cx / s)**alpha * g_s\n        \n        # Unconditional mean ion energy E\n        mean_E = E_no * P0 + coll_energy_contrib\n        \n        # Unconditional mean energy loss ΔE\n        mean_Delta_E = E_no - mean_E\n        \n        # --- Task 2: Sputtering-Related Quantities ---\n\n        # Critical position x_th where a newborn ion gains exactly E_th energy\n        # Assume E_th  0 and Phi_s  0 as per problem context.\n        x_th = s * (E_th / Phi_s)**(1.0 / alpha)\n        \n        # Clip x_th to the physical domain [0, s]\n        x_th_star = np.clip(x_th, 0, s)\n        \n        # Fraction of sputtering ions, F_sput = P(E = E_th)\n        # Contribution from collisionless ions\n        F_sput_no_coll = P0 if E_no = E_th else 0.0\n        \n        # Contribution from collisional ions\n        F_sput_coll = np.exp(-x_th_star / lambda_cx) - P0\n        \n        # Total fraction\n        frac_sput = F_sput_no_coll + F_sput_coll\n        \n        # Mean energy of sputtering ions, E_sput\n        mean_E_sput = 0.0\n        if frac_sput  1e-12: # Avoid division by zero\n            # Numerator for the conditional expectation E[E | E = E_th]\n            \n            # Contribution from collisionless ions to numerator\n            sput_numerator = E_no * F_sput_no_coll\n            \n            # Contribution from collisional ions to numerator\n            g_x_th_star = gammainc(alpha + 1, x_th_star / lambda_cx) * gamma(alpha + 1)\n            I_sput = Phi_s * (lambda_cx / s)**alpha * (g_s - g_x_th_star)\n            sput_numerator += I_sput\n            \n            mean_E_sput = sput_numerator / frac_sput\n\n        # Store results for this case\n        case_results = [mean_E, mean_Delta_E, frac_sput, mean_E_sput]\n        all_results.append(case_results)\n\n    # Format and print the final output exactly as required.\n    # The output is a list of lists, with each inner list containing 4 floats.\n    # All floats must be rounded to six decimal places.\n    output_str = ','.join(\n        [f'[{\",\".join([f\"{val:.6f}\" for val in res])}]' for res in all_results]\n    )\n    \n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}