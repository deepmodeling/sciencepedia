{
    "hands_on_practices": [
        {
            "introduction": "Managing the immense heat flux in a fusion reactor's divertor is a critical engineering challenge. This first exercise provides a foundational understanding of how impurity seeding helps solve this problem by converting plasma kinetic energy into radiated light. By performing a straightforward calculation, you will determine the required concentration $f_z$ of different impurity species needed to radiate a significant fraction of the incoming power, offering direct insight into the effectiveness of various radiator candidates .",
            "id": "3993761",
            "problem": "A magnetically confined fusion device operates with a lower single-null divertor whose divertor leg is approximated as a one-dimensional, optically thin, coronal-equilibrium radiation zone of uniform electron temperature and density. The upstream parallel heat flux is prescribed as $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2}$. Assume a uniform electron temperature $T_e$ in the divertor leg and a uniform electron density $n_e$, over an effective radiation extent $L_{\\mathrm{rad}}$ along the magnetic field. The volumetric impurity radiation loss is modeled as $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$, where $n_z$ is the impurity density and $L_z(T_e)$ is the impurity cooling rate coefficient. The radiated power per unit target area from the divertor leg is the line integral of the volumetric loss, which, under the stated uniform assumptions, reduces to $n_e n_z L_z(T_e) L_{\\mathrm{rad}}$. A detached operation target is to radiate a fraction $f_r$ of $q_{\\parallel,u}$ before the power reaches the target plate, with $f_r = 0.5$ in this scenario.\n\nAt low electron temperatures $T_e$ in the range $1-10\\,\\mathrm{eV}$, adopt the following experimentally and computationally motivated fits for the cooling rate coefficient $L_z(T_e)$ for three seeded impurities, valid for optically thin, coronal conditions:\n- Nitrogen: $L_z^{\\mathrm{N}}(T_e) \\approx 3.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{-0.2}\\,\\mathrm{W\\,m^3}$,\n- Neon: $L_z^{\\mathrm{Ne}}(T_e) \\approx 1.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.1}\\,\\mathrm{W\\,m^3}$,\n- Argon: $L_z^{\\mathrm{Ar}}(T_e) \\approx 3.0 \\times 10^{-32} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.5}\\,\\mathrm{W\\,m^3}$.\n\nAssume $T_e = 5\\,\\mathrm{eV}$, $n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$, and $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$. Define the impurity seeding concentration as the ratio $f_z = n_z/n_e$. Starting from energy conservation and the definition of $L_z(T_e)$, derive the expression that relates $f_z$ to $q_{\\parallel,u}$, $f_r$, $n_e$, $L_{\\mathrm{rad}}$, and $L_z(T_e)$. Then, evaluate the required $f_z$ to radiate $50\\%$ of $q_{\\parallel,u}$ for each species (nitrogen, neon, argon) at $T_e = 5\\,\\mathrm{eV}$.\n\nYour final answer must be the three values of $f_z$ for nitrogen, neon, and argon, respectively, expressed as a single row matrix, rounded to three significant figures, as decimal fractions without units.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of plasma physics, well-posed with sufficient information for a unique solution, and objective in its formulation. We will proceed with the derivation and calculation.\n\nThe first step is to establish the energy balance in the divertor leg. The problem states that a fraction $f_r$ of the upstream parallel heat flux, $q_{\\parallel,u}$, is radiated away. The total power radiated per unit area of the divertor target, $q_{\\mathrm{rad}}$, must equal this fraction of the incoming power.\n$$\nq_{\\mathrm{rad}} = f_r q_{\\parallel,u}\n$$\nThe radiated power per unit area, $q_{\\mathrm{rad}}$, is the line integral of the volumetric radiation loss, $P_{\\mathrm{rad}}$, along the magnetic field line over the radiation extent $L_{\\mathrm{rad}}$. Under the given assumption of uniform electron density $n_e$, impurity density $n_z$, and electron temperature $T_e$, this integral simplifies to a product:\n$$\nq_{\\mathrm{rad}} = P_{\\mathrm{rad}} L_{\\mathrm{rad}}\n$$\nThe volumetric radiation loss is given by the expression $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$, where $L_z(T_e)$ is the impurity cooling rate coefficient. Substituting this into the expression for $q_{\\mathrm{rad}}$ yields:\n$$\nq_{\\mathrm{rad}} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\nEquating the two expressions for $q_{\\mathrm{rad}}$ gives the core energy balance equation:\n$$\nf_r q_{\\parallel,u} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\nThe problem defines the impurity seeding concentration as the ratio $f_z = n_z/n_e$. We can express the impurity density as $n_z = f_z n_e$. Substituting this into the energy balance equation:\n$$\nf_r q_{\\parallel,u} = n_e (f_z n_e) L_z(T_e) L_{\\mathrm{rad}}\n$$\n$$\nf_r q_{\\parallel,u} = f_z n_e^2 L_z(T_e) L_{\\mathrm{rad}}\n$$\nWe can now isolate $f_z$ to obtain the desired expression:\n$$\nf_z = \\frac{f_r q_{\\parallel,u}}{n_e^2 L_z(T_e) L_{\\mathrm{rad}}}\n$$\nThis is the general expression relating the impurity concentration to the other parameters.\n\nNext, we evaluate the cooling rate coefficients $L_z(T_e)$ for each impurity at the specified electron temperature of $T_e = 5\\,\\mathrm{eV}$. The given fitting formulas are normalized to $T_e/(5\\,\\mathrm{eV})$, which simplifies to $1$ for this case.\nFor Nitrogen (N):\n$$\nL_z^{\\mathrm{N}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{-0.2} = (3.0 \\times 10^{-31}) \\times 1^{-0.2} = 3.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3}\n$$\nFor Neon (Ne):\n$$\nL_z^{\\mathrm{Ne}}(T_e = 5\\,\\mathrm{eV}) = (1.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.1} = (1.0 \\times 10^{-31}) \\times 1^{0.1} = 1.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3}\n$$\nFor Argon (Ar):\n$$\nL_z^{\\mathrm{Ar}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-32}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.5} = (3.0 \\times 10^{-32}) \\times 1^{0.5} = 3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3}\n$$\nNow we can substitute the given numerical values into the derived expression for $f_z$:\n- $f_r = 0.5$\n- $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2} = 5.0 \\times 10^7\\,\\mathrm{W/m^2}$\n- $n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n- $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$\n\nLet's compute the numerator and the constant part of the denominator:\nNumerator: $f_r q_{\\parallel,u} = 0.5 \\times (5.0 \\times 10^7\\,\\mathrm{W/m^2}) = 2.5 \\times 10^7\\,\\mathrm{W/m^2}$.\nDenominator (without $L_z$): $n_e^2 L_{\\mathrm{rad}} = (5.0 \\times 10^{20}\\,\\mathrm{m^{-3}})^2 \\times (5.0\\,\\mathrm{m}) = (25.0 \\times 10^{40}\\,\\mathrm{m^{-6}}) \\times (5.0\\,\\mathrm{m}) = 1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}$.\n\nNow we calculate $f_z$ for each impurity.\nFor Nitrogen (N):\n$$\nf_z^{\\mathrm{N}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{11}} = 0.666... \\times 10^{-4} \\approx 6.67 \\times 10^{-5}\n$$\nFor Neon (Ne):\n$$\nf_z^{\\mathrm{Ne}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (1.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{1.25 \\times 10^{11}} = 2.0 \\times 10^{-4}\n$$\nFor Argon (Ar):\n$$\nf_z^{\\mathrm{Ar}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{10}} = 0.666... \\times 10^{-3} \\approx 6.67 \\times 10^{-4}\n$$\nThe problem requires the answers rounded to three significant figures and expressed as decimal fractions.\n- $f_z^{\\mathrm{N}} \\approx 0.0000667$\n- $f_z^{\\mathrm{Ne}} = 0.000200$ (The trailing zeros are significant)\n- $f_z^{\\mathrm{Ar}} \\approx 0.000667$\n\nThese values represent the required fraction of impurities relative to the electron density to radiate $50\\%$ of the incoming heat flux under the specified conditions.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0000667  0.000200  0.000667 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our models of impurity radiation often assume that the atomic populations are in a steady-state equilibrium, but is this always a safe assumption during rapid plasma events? This practice delves into the underlying atomic physics to answer that very question by calculating the collisional-radiative equilibration timescale, $\\tau_{CR}$. This exercise is crucial for developing good modeling instincts, teaching you to justify the use of simpler steady-state models versus more complex, time-dependent ones based on the physical timescales involved .",
            "id": "3993851",
            "problem": "A low-temperature divertor plasma in a magnetic confinement fusion device is seeded with neon to enhance impurity radiation. In the regime of interest, the electron temperature is approximately constant at $T_e=10\\,\\mathrm{eV}$, and the electron density is $n_e=5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$. The collisional-radiative model for the charge-state populations of neon is reduced to two dominant stages, neutral neon $N_0$ and singly ionized neon $N_1$, where transport is neglected and the total neon density $N_{\\mathrm{tot}}=N_0+N_1$ is conserved over the timescale considered. The population dynamics are governed by electron-impact ionization (from $N_0$ to $N_1$) with Maxwellian-averaged rate coefficient $S_0$ and electron-ion recombination (from $N_1$ to $N_0$) with Maxwellian-averaged rate coefficient $\\alpha_0$, both evaluated at $T_e$. Adopt the following physically plausible coefficients at $T_e=10\\,\\mathrm{eV}$: $S_0=1.0\\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ and $\\alpha_0=1.5\\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n\nStarting from the fundamental rate equations, derive the linearized system for small perturbations about the steady state and determine the slowest relaxation timescale associated with collisional-radiative equilibration for this two-stage neon system. Then, compute this timescale numerically using the given parameters. Express the final timescale in microseconds and round your answer to three significant figures.\n\nTo provide scientific context relevant to impurity radiation balance in divertors, briefly discuss in your derivation how this equilibration timescale informs whether a time-dependent Collisional-Radiative (CR) model is necessary to capture neon radiation transients over a divertor event of duration $0.5\\,\\mathrm{ms}$. Your final numerical answer must be the equilibration timescale only, expressed in $\\mathrm{\\mu s}$ as specified.",
            "solution": "The problem asks for the derivation and calculation of the collisional-radiative equilibration timescale for a simplified two-stage neon system in a divertor plasma, and a discussion of its implications for modeling. The problem is scientifically grounded, well-posed, and objective, and therefore deemed valid.\n\nThe system consists of two charge states of neon: neutral ($N_0$) and singly ionized ($N_1$). The dynamics are governed by electron-impact ionization and electron-ion recombination. According to the problem statement, we can write the rate equation for the population density of singly ionized neon, $N_1$, as follows:\n$$\n\\frac{dN_1}{dt} = (\\text{Source from ionization of } N_0) - (\\text{Sink from recombination of } N_1)\n$$\nThe source term is the rate of ionization of $N_0$, which is proportional to the electron density $n_e$, the neutral neon density $N_0$, and the ionization rate coefficient $S_0$. The sink term is the rate of recombination of $N_1$, which is proportional to the electron density $n_e$, the singly ionized neon density $N_1$, and the recombination rate coefficient $\\alpha_0$. This gives the rate equation:\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_0 - n_e \\alpha_0 N_1\n$$\nThe total neon density, $N_{\\mathrm{tot}} = N_0 + N_1$, is conserved. This implies that the rate of change of the total density is zero:\n$$\n\\frac{dN_{\\mathrm{tot}}}{dt} = \\frac{dN_0}{dt} + \\frac{dN_1}{dt} = 0\n$$\nTherefore, the rate equation for the neutral population is $\\frac{dN_0}{dt} = -\\frac{dN_1}{dt}$. We can analyze the system's dynamics using only one of these two coupled equations by invoking the conservation law. Using $N_0 = N_{\\mathrm{tot}} - N_1$, we can rewrite the rate equation for $N_1$ entirely in terms of $N_1$:\n$$\n\\frac{dN_1}{dt} = n_e S_0 (N_{\\mathrm{tot}} - N_1) - n_e \\alpha_0 N_1\n$$\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_{\\mathrm{tot}} - n_e S_0 N_1 - n_e \\alpha_0 N_1\n$$\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_{\\mathrm{tot}} - n_e(S_0 + \\alpha_0) N_1\n$$\nTo find the relaxation timescale, we analyze small perturbations around the steady-state equilibrium. Let the steady-state populations be $\\bar{N}_0$ and $\\bar{N}_1$. At steady state, $\\frac{dN_1}{dt} = 0$, which gives the balance equation:\n$$\nn_e S_0 \\bar{N}_0 - n_e \\alpha_0 \\bar{N}_1 = 0 \\implies S_0 \\bar{N}_0 = \\alpha_0 \\bar{N}_1\n$$\nNow, consider small perturbations $\\delta N_0(t)$ and $\\delta N_1(t)$ from the steady state:\n$$\nN_0(t) = \\bar{N}_0 + \\delta N_0(t)\n$$\n$$\nN_1(t) = \\bar{N}_1 + \\delta N_1(t)\n$$\nFrom the conservation law $N_0 + N_1 = N_{\\mathrm{tot}}$, we have $(\\bar{N}_0 + \\delta N_0) + (\\bar{N}_1 + \\delta N_1) = N_{\\mathrm{tot}}$. Since $\\bar{N}_0 + \\bar{N}_1 = N_{\\mathrm{tot}}$, the perturbations must satisfy $\\delta N_0 + \\delta N_1 = 0$, or $\\delta N_0 = -\\delta N_1$.\n\nSubstituting the perturbed quantities into the rate equation for $N_1$:\n$$\n\\frac{d}{dt}(\\bar{N}_1 + \\delta N_1) = n_e S_0 (\\bar{N}_0 + \\delta N_0) - n_e \\alpha_0 (\\bar{N}_1 + \\delta N_1)\n$$\nSince $\\bar{N}_1$ is constant, the left side becomes $\\frac{d\\delta N_1}{dt}$. Expanding the right side:\n$$\n\\frac{d\\delta N_1}{dt} = (n_e S_0 \\bar{N}_0 - n_e \\alpha_0 \\bar{N}_1) + n_e S_0 \\delta N_0 - n_e \\alpha_0 \\delta N_1\n$$\nThe term in parentheses is zero by the definition of steady state. Substituting $\\delta N_0 = -\\delta N_1$, we obtain the linearized equation for the perturbation $\\delta N_1$:\n$$\n\\frac{d\\delta N_1}{dt} = n_e S_0 (-\\delta N_1) - n_e \\alpha_0 \\delta N_1\n$$\n$$\n\\frac{d\\delta N_1}{dt} = -[n_e (S_0 + \\alpha_0)] \\delta N_1\n$$\nThis is a standard first-order linear ordinary differential equation of the form $\\frac{dy}{dt} = -\\lambda y$, whose solution is $y(t) = y(0) \\exp(-\\lambda t)$. The relaxation timescale, $\\tau$, is the reciprocal of the decay constant $\\lambda$. Therefore, the slowest (and only) relaxation timescale for this two-stage system is:\n$$\n\\tau = \\frac{1}{\\lambda} = \\frac{1}{n_e (S_0 + \\alpha_0)}\n$$\nNow, we compute the numerical value of this timescale using the given parameters:\n$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n$S_0 = 1.0 \\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$\n$\\alpha_0 = 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$\n\nFirst, we sum the rate coefficients:\n$$\nS_0 + \\alpha_0 = 1.0 \\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}\n$$\n$$\nS_0 + \\alpha_0 = 0.1 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} = 1.6 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}\n$$\nNext, we calculate the timescale $\\tau$:\n$$\n\\tau = \\frac{1}{(5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.6 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1})}\n$$\n$$\n\\tau = \\frac{1}{5.0 \\times 1.6 \\times 10^{19-13}}\\,\\mathrm{s} = \\frac{1}{8.0 \\times 10^6}\\,\\mathrm{s}\n$$\n$$\n\\tau = 0.125 \\times 10^{-6}\\,\\mathrm{s}\n$$\nThe problem requires the answer in microseconds ($\\mu\\mathrm{s}$) and rounded to three significant figures. Since $1\\,\\mu\\mathrm{s} = 10^{-6}\\,\\mathrm{s}$, we have:\n$$\n\\tau = 0.125\\,\\mu\\mathrm{s}\n$$\nThis value is already expressed with three significant figures.\n\nRegarding the scientific context, the problem asks to discuss how this timescale informs the modeling of radiation for a divertor event of duration $0.5\\,\\mathrm{ms}$. The calculated equilibration timescale is $\\tau = 0.125\\,\\mu\\mathrm{s}$. The event duration is $t_{\\mathrm{event}} = 0.5\\,\\mathrm{ms} = 500\\,\\mu\\mathrm{s}$.\n\nThe ratio of the equilibration timescale to the event duration is $\\tau/t_{\\mathrm{event}} = 0.125 / 500 = 1/4000$. Since $\\tau \\ll t_{\\mathrm{event}}$, the charge-state populations of neon will adjust to any changes in the background plasma conditions ($T_e$, $n_e$) almost instantaneously relative to the timescale of the event itself. This implies that for modeling purposes, the neon charge-state distribution can be assumed to be in a quasi-static equilibrium with the local plasma at every moment during the event. Consequently, one can use a steady-state Collisional-Radiative (CR) model (also known as a coronal equilibrium model in its simplest form) to calculate the neon populations and their radiated power at each time step of a plasma simulation, rather than solving the full time-dependent rate equations for the impurity species. A full time-dependent CR model for the impurity dynamics would only be necessary if the plasma parameters were fluctuating on a timescale comparable to or faster than $\\tau$, i.e., on sub-microsecond timescales. For a relatively slow $0.5\\,\\mathrm{ms}$ transient, the quasi-static approximation is well-justified.",
            "answer": "$$\n\\boxed{0.125}\n$$"
        },
        {
            "introduction": "The true power of impurity radiation is realized through its dynamic interplay with plasma heat transport, which can create a stable, detached 'radiation front' that protects divertor targets. This final practice moves from static calculations to a dynamic simulation, where you will build a 1D coupled transport-radiation model from the ground up. By solving the system of equations, you will simulate the formation of this radiation front, gaining hands-on experience with the nonlinear feedback mechanisms that govern modern divertor solutions .",
            "id": "3993836",
            "problem": "You are asked to construct and solve a one-dimensional, steady-state coupled transport–radiation model for impurity radiation balance in a divertor leg. The coordinate is the parallel distance $s \\in [0,L]$ from the upstream region ($s = 0$) to the target ($s = L$). The objective is to demonstrate the formation of a radiation front, defined as the location where the parallel conductive heat flux that originates upstream is largely exhausted by local volumetric radiation from impurities.\n\nBegin from the following fundamental base:\n- Conservation of energy along the field line in steady state implies that the divergence of the conductive heat flux balances volumetric sinks. Let $q(s)$ be the electron parallel conductive heat flux and $P_{\\mathrm{rad}}(s)$ be the volumetric radiation power density. Then\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s).\n$$\n- Adopt Spitzer–Härm electron parallel conduction in the collisional regime with $q(s) = - \\kappa_{0} \\, T_{e}(s)^{5/2} \\,\\frac{d T_{e}}{d s}$, where $T_{e}(s)$ is the electron temperature and $\\kappa_{0}$ is a constant coefficient.\n- The impurity radiation power density is modeled as\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right),\n$$\nwhere $n_{e}(s)$ is the electron density, $n_{z}(s)$ is the impurity density, and $L_{z}(T)$ is an impurity cooling function (power coefficient).\n\nAssume the following scientifically realistic modeling choices to close the system:\n- The electron density is uniform, $n_{e}(s) \\equiv n_{e}$.\n- The impurity density is stronger near the target and decays upstream with a screening length $\\lambda_{z}$, modeled as\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right),\n$$\nwhere $f_{z0}$ is the impurity fraction near the target.\n- The impurity cooling function has a single temperature peak around $T_{p}$ and decays for both lower and higher temperatures. Use the smooth analytic form\n$$\nL_{z}(T) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T}\\right)^{\\beta}},\n$$\nwith given constants $L_{\\max}$, $T_{p}$, $\\alpha$, and $\\beta$.\n\nCombine these into a first-order system of Ordinary Differential Equations (ODEs) for $T_{e}(s)$ and $q(s)$, suitable for numerical solution:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}, \n\\qquad\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right).\n$$\nFor numerical robustness, you may regularize the denominator in the first equation by bounding $T_{e}$ below by a small positive floor $T_{\\min}$.\n\nBoundary and input data:\n- Upstream boundary condition: a specified incoming parallel heat flux $q(0) = q_{\\mathrm{up}}$.\n- Upstream initial temperature: $T_{e}(0) = T_{\\mathrm{up}}$.\n- Domain length: $s \\in [0,L]$.\n\nDefinition of the radiation front:\n- Define the radiation front location $s_{\\mathrm{front}}$ as the smallest $s \\in [0,L]$ such that $q(s) \\le \\varepsilon \\, q_{\\mathrm{up}}$, for a small threshold $0  \\varepsilon \\ll 1$. If no such $s$ exists in $[0,L]$, return $s_{\\mathrm{front}} = -1.0$.\n\nPhysical units and constants to use:\n- Express temperature in electron-volts (eV), length in meters (m), density in $\\mathrm{m}^{-3}$, and power density in $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n- Use $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$.\n- Use $T_{\\min} = 0.2\\,\\mathrm{eV}$ as a numerical floor.\n- Use $\\varepsilon = 0.05$.\n\nTest suite:\nFor each case below, compute $s_{\\mathrm{front}}$ in meters, rounded to three decimals.\n\n- Case A (happy path): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 2.5\\times 10^{-3}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n- Case B (low-impurity boundary): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 1.0\\times 10^{-4}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n- Case C (strong-cooling edge): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 5.0\\times 10^{6}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 5.0\\times 10^{-3}$, $\\lambda_{z} = 3.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n\nComputational requirements:\n- Integrate the coupled first-order system along $s$ from $s=0$ to $s=L$ using a suitable explicit solver for Ordinary Differential Equations (ODEs), such as a Runge–Kutta method.\n- Detect $s_{\\mathrm{front}}$ as soon as $q(s)$ first satisfies $q(s) \\le \\varepsilon q_{\\mathrm{up}}$, otherwise return $-1.0$ if no such point exists up to $s=L$.\n- Report $s_{\\mathrm{front}}$ in $\\mathrm{m}$ rounded to three decimals, as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example, [$x_A,x_B,x_C$], where each $x$ is the rounded value of $s_{\\mathrm{front}}$ for the corresponding case.",
            "solution": "The problem presents a one-dimensional, steady-state model for heat transport and radiation in a fusion divertor. The task is to determine the location of the \"radiation front,\" where the incoming heat flux is dissipated by impurity radiation. This is a well-posed initial value problem for a system of ordinary differential equations (ODEs), grounded in established principles of plasma physics.\n\nThe state of the plasma along the magnetic field line, parameterized by the coordinate $s$ from $s=0$ (upstream) to $s=L$ (target), is described by the electron temperature $T_{e}(s)$ and the parallel conductive heat flux $q(s)$. The governing equations form a coupled first-order system:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s)\n$$\nThe first equation is derived from the Spitzer–Härm model for electron heat conduction, $q = -\\kappa_{0} T_{e}^{5/2} (dT_{e}/ds)$, where $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$ is the thermal conductivity coefficient. For numerical stability, the temperature in the denominator is floored at a minimum value, $T_{e} \\ge T_{\\min} = 0.2\\,\\mathrm{eV}$.\n\nThe second equation expresses the conservation of energy, where the divergence of the heat flux is balanced by a volumetric power sink, $P_{\\mathrm{rad}}(s)$. This radiation power density is given by:\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right)\n$$\nThe model assumes a uniform electron density $n_{e}(s) \\equiv n_{e}$. The impurity density, $n_{z}(s)$, is modeled to be highest at the target ($s=L$) and decay exponentially upstream with a characteristic length $\\lambda_{z}$:\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\n$$\nwhere $f_{z0}$ is the impurity fraction at the target.\n\nThe impurity cooling function, $L_{z}(T_{e})$, which represents the radiative efficiency of the impurity species, is described by an analytic function peaked at temperature $T_{p}$:\n$$\nL_{z}(T_{e}) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T_{e}}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T_{e}}\\right)^{\\beta}}\n$$\nSubstituting these expressions into the equation for $dq/ds$, the complete ODE system is:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, \\max(T_{e}, T_{\\min})^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}^{2}\\, f_{z0}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\\, \\frac{L_{\\max}}{1 + \\left(\\frac{\\max(T_{e}, T_{\\min})}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{\\max(T_{e}, T_{\\min})}\\right)^{\\beta}}\n$$\nThis system constitutes an initial value problem with conditions specified at the upstream boundary $s=0$:\n$$\nT_{e}(0) \\;=\\; T_{\\mathrm{up}}\n$$\n$$\nq(0) \\;=\\; q_{\\mathrm{up}}\n$$\nThe problem is to integrate this system from $s=0$ to $s=L$ and find the radiation front location, $s_{\\mathrm{front}}$. This is defined as the first point $s$ where the heat flux $q(s)$ drops to a small fraction $\\varepsilon = 0.05$ of its initial value, i.e., $q(s) \\le \\varepsilon q_{\\mathrm{up}}$. If this condition is not met within the domain $[0, L]$, $s_{\\mathrm{front}}$ is reported as $-1.0$.\n\nTo solve this numerically, we employ an adaptive step-size Runge-Kutta solver, specifically the `solve_ivp` function from the `scipy.integrate` library. This function is well-suited for this task as it provides robust event detection capabilities. We define a vector of state variables $\\vec{y}(s) = [T_e(s), q(s)]^T$. The ODE system is implemented as a function that computes $d\\vec{y}/ds$ given $s$ and $\\vec{y}$.\n\nAn event function is defined to detect the radiation front. This function calculates the quantity $q(s) - \\varepsilon q_{\\mathrm{up}}$. The solver is configured to find the root of this function (where $q(s) = \\varepsilon q_{\\mathrm{up}}$) and to terminate integration upon its detection. Since $q(s)$ is expected to decrease monotonically (as $P_{\\mathrm{rad}} \\ge 0$, thus $dq/ds \\le 0$), the first root found will correspond to the smallest $s$ satisfying the condition.\n\nThe solution proceeds by iterating through each test case. For each case, the parameters are set, the initial state vector $\\vec{y}(0) = [T_{\\mathrm{up}}, q_{\\mathrm{up}}]$ is defined, and the solver is called for the domain $s \\in [0, L]$. If the solver reports that the event was triggered, the corresponding time (which is the spatial coordinate $s$) is recorded as $s_{\\mathrm{front}}$. If the integration completes to $s=L$ without the event being triggered, $s_{\\mathrm{front}}$ is set to $-1.0$. The final result is rounded to three decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coupled ODE system for impurity radiation balance in a divertor \n    for three distinct test cases to find the radiation front location.\n    \"\"\"\n\n    # Physical and numerical constants\n    KAPPA_0 = 2000.0  # W m^-1 eV^-7/2\n    T_MIN = 0.2        # eV\n    EPSILON = 0.05     # Radiation front threshold fraction\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 2.5e-3, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case B (low-impurity boundary)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 1.0e-4, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case C (strong-cooling edge)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 5.0e6, \"T_up\": 120.0,\n            \"f_z0\": 5.0e-3, \"lambda_z\": 3.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n\n        def ode_system(s, y):\n            \"\"\"\n            Defines the coupled first-order ODE system for T_e and q.\n            y[0] = T_e (electron temperature)\n            y[1] = q (parallel heat flux)\n            s = parallel distance\n            \"\"\"\n            T_e, q = y\n            \n            # Apply numerical floor to temperature for robustness\n            T_e_reg = max(T_e, T_MIN)\n\n            # Impurity density n_z(s)\n            n_z = params[\"f_z0\"] * params[\"n_e\"] * np.exp((s - params[\"L\"]) / params[\"lambda_z\"])\n\n            # Impurity cooling function L_z(T_e)\n            T_ratio = T_e_reg / params[\"T_p\"]\n            L_z = params[\"L_max\"] / (1.0 + T_ratio**params[\"alpha\"] + (1.0 / T_ratio)**params[\"beta\"])\n\n            # Radiation power density P_rad(s)\n            P_rad = params[\"n_e\"] * n_z * L_z\n\n            # Derivatives\n            # dT_e/ds = -q / (kappa_0 * T_e^(5/2))\n            dTeds = -q / (KAPPA_0 * T_e_reg**2.5)\n            \n            # dq/ds = -P_rad\n            dqds = -P_rad\n\n            return [dTeds, dqds]\n\n        # Event function to find where q(s) = epsilon * q_up\n        def radiation_front_event(s, y):\n            q = y[1]\n            return q - EPSILON * params[\"q_up\"]\n\n        # The event is terminal: stop integration when the front is found.\n        radiation_front_event.terminal = True\n        # We are looking for a decreasing function q(s) to hit a value, so direction is -1.\n        radiation_front_event.direction = -1\n\n        # Initial conditions at s=0\n        y0 = [params[\"T_up\"], params[\"q_up\"]]\n        \n        # Integration domain\n        s_span = [0, params[\"L\"]]\n\n        # Solve the ODE\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=s_span,\n            y0=y0,\n            method='RK45',\n            events=radiation_front_event,\n            dense_output=True\n        )\n\n        # Check if the event was triggered\n        if sol.t_events[0].size > 0:\n            s_front = sol.t_events[0][0]\n        else:\n            s_front = -1.0\n            \n        results.append(round(s_front, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}