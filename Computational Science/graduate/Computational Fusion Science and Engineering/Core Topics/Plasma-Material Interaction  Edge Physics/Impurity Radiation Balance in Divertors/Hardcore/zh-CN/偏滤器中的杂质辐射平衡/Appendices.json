{
    "hands_on_practices": [
        {
            "introduction": "在偏滤器设计中，一个核心问题是估算需要注入多少杂质才能辐射掉目标功率。本练习  提供了一个简化的“零维”模型来进行这种初步估算。通过这个练习，你将亲手计算并比较在特定等离子体条件下，氮、氖和氩等常见杂质的辐射效率差异，从而理解不同杂质在实现功率耗散中的作用。",
            "id": "3993761",
            "problem": "一个磁约束聚变装置在下单零点偏滤器模式下运行，其偏滤器靶腿被近似为一个一维、光学薄、电子温度和密度均匀的日冕平衡辐射区。上游平行热通量设定为 $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2}$。假设在沿磁场的有效辐射范围 $L_{\\mathrm{rad}}$ 内，偏滤器靶腿中的电子温度 $T_e$ 和电子密度 $n_e$ 是均匀的。体积杂质辐射损失由公式 $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$ 建模，其中 $n_z$ 是杂质密度，$L_z(T_e)$ 是杂质冷却率系数。来自偏滤器靶腿的单位靶板面积上的辐射功率是体积损失的线积分，在所述的均匀假设下，该值简化为 $n_e n_z L_z(T_e) L_{\\mathrm{rad}}$。脱靶运行的一个目标是在功率到达靶板之前，辐射掉上游平行热通量 $q_{\\parallel,u}$ 的一部分，比例为 $f_r$。在此情景中，$f_r = 0.5$。\n\n在 $1$–$10\\,\\mathrm{eV}$ 范围内的低电子温度 $T_e$下，对于三种注入的杂质，采用以下由实验和计算得出的冷却率系数 $L_z(T_e)$ 的拟合公式，这些公式在光学薄、日冕条件下有效：\n- 氮：$L_z^{\\mathrm{N}}(T_e) \\approx 3.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{-0.2}\\,\\mathrm{W\\,m^3}$，\n- 氖：$L_z^{\\mathrm{Ne}}(T_e) \\approx 1.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.1}\\,\\mathrm{W\\,m^3}$，\n- 氩：$L_z^{\\mathrm{Ar}}(T_e) \\approx 3.0 \\times 10^{-32} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.5}\\,\\mathrm{W\\,m^3}$。\n\n假设 $T_e = 5\\,\\mathrm{eV}$，$n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$，以及 $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$。将杂质注入浓度定义为比率 $f_z = n_z/n_e$。从能量守恒和 $L_z(T_e)$ 的定义出发，推导将 $f_z$ 与 $q_{\\parallel,u}$、$f_r$、$n_e$、$L_{\\mathrm{rad}}$ 和 $L_z(T_e)$ 联系起来的表达式。然后，对于每种粒子（氮、氖、氩），在 $T_e = 5\\,\\mathrm{eV}$ 的条件下，计算辐射掉 $q_{\\parallel,u}$ 的 $50\\%$ 所需的 $f_z$。\n\n你的最终答案必须是分别对应氮、氖和氩的三个 $f_z$ 值，以单行矩阵的形式表示，四舍五入到三位有效数字，且为不带单位的小数。",
            "solution": "该问题是有效的，因为它基于等离子体物理学的原理，具有科学依据，问题提法恰当，有足够的信息得到唯一解，且表述客观。我们将进行推导和计算。\n\n第一步是建立偏滤器靶腿中的能量平衡。问题陈述，上游平行热通量 $q_{\\parallel,u}$ 的一部分 $f_r$ 被辐射掉。偏滤器靶板单位面积上的总辐射功率 $q_{\\mathrm{rad}}$ 必须等于这部分入射功率。\n$$\nq_{\\mathrm{rad}} = f_r q_{\\parallel,u}\n$$\n单位面积上的辐射功率 $q_{\\mathrm{rad}}$ 是体积辐射损失 $P_{\\mathrm{rad}}$ 沿着磁场线在辐射范围 $L_{\\mathrm{rad}}$ 上的线积分。在给定的电子密度 $n_e$、杂质密度 $n_z$ 和电子温度 $T_e$ 均匀的假设下，该积分简化为一个乘积：\n$$\nq_{\\mathrm{rad}} = P_{\\mathrm{rad}} L_{\\mathrm{rad}}\n$$\n体积辐射损失由表达式 $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$ 给出，其中 $L_z(T_e)$ 是杂质冷却率系数。将此代入 $q_{\\mathrm{rad}}$ 的表达式中，得到：\n$$\nq_{\\mathrm{rad}} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\n将两个 $q_{\\mathrm{rad}}$ 的表达式相等，得到核心能量平衡方程：\n$$\nf_r q_{\\parallel,u} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\n问题将杂质注入浓度定义为比率 $f_z = n_z/n_e$。我们可以将杂质密度表示为 $n_z = f_z n_e$。将其代入能量平衡方程：\n$$\nf_r q_{\\parallel,u} = n_e (f_z n_e) L_z(T_e) L_{\\mathrm{rad}}\n$$\n$$\nf_r q_{\\parallel,u} = f_z n_e^2 L_z(T_e) L_{\\mathrm{rad}}\n$$\n现在我们可以分离出 $f_z$ 来得到所需的表达式：\n$$\nf_z = \\frac{f_r q_{\\parallel,u}}{n_e^2 L_z(T_e) L_{\\mathrm{rad}}}\n$$\n这是将杂质浓度与其他参数关联起来的通用表达式。\n\n接下来，我们在指定的电子温度 $T_e = 5\\,\\mathrm{eV}$ 下，计算每种杂质的冷却率系数 $L_z(T_e)$。给定的拟合公式是相对于 $T_e/(5\\,\\mathrm{eV})$ 进行归一化的，在这种情况下，该比值简化为 1。\n对于氮 (N)：\n$$\nL_z^{\\mathrm{N}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{-0.2} = (3.0 \\times 10^{-31}) \\times 1^{-0.2} = 3.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3}\n$$\n对于氖 (Ne)：\n$$\nL_z^{\\mathrm{Ne}}(T_e = 5\\,\\mathrm{eV}) = (1.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.1} = (1.0 \\times 10^{-31}) \\times 1^{0.1} = 1.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3}\n$$\n对于氩 (Ar)：\n$$\nL_z^{\\mathrm{Ar}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-32}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.5} = (3.0 \\times 10^{-32}) \\times 1^{0.5} = 3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3}\n$$\n现在我们可以将给定的数值代入推导出的 $f_z$ 表达式中：\n- $f_r = 0.5$\n- $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2} = 5.0 \\times 10^7\\,\\mathrm{W/m^2}$\n- $n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n- $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$\n\n让我们计算分子和分母中的常数部分：\n分子：$f_r q_{\\parallel,u} = 0.5 \\times (5.0 \\times 10^7\\,\\mathrm{W/m^2}) = 2.5 \\times 10^7\\,\\mathrm{W/m^2}$。\n分母 (不含 $L_z$)：$n_e^2 L_{\\mathrm{rad}} = (5.0 \\times 10^{20}\\,\\mathrm{m^{-3}})^2 \\times (5.0\\,\\mathrm{m}) = (25.0 \\times 10^{40}\\,\\mathrm{m^{-6}}) \\times (5.0\\,\\mathrm{m}) = 1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}$。\n\n现在我们为每种杂质计算 $f_z$。\n对于氮 (N)：\n$$\nf_z^{\\mathrm{N}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{11}} = 0.666... \\times 10^{-4} \\approx 6.67 \\times 10^{-5}\n$$\n对于氖 (Ne)：\n$$\nf_z^{\\mathrm{Ne}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (1.0 \\times 10^{-31}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{1.25 \\times 10^{11}} = 2.0 \\times 10^{-4}\n$$\n对于氩 (Ar)：\n$$\nf_z^{\\mathrm{Ar}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{10}} = 0.666... \\times 10^{-3} \\approx 6.67 \\times 10^{-4}\n$$\n问题要求答案四舍五入到三位有效数字，并以小数形式表示。\n- $f_z^{\\mathrm{N}} \\approx 0.0000667$\n- $f_z^{\\mathrm{Ne}} = 0.000200$ (尾随的零是有效数字)\n- $f_z^{\\mathrm{Ar}} \\approx 0.000667$\n\n这些值表示在指定条件下，为辐射掉 50% 的入射热通量，所需的杂质与电子密度的比率。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0000667  0.000200  0.000667 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实中，杂质辐射并非均匀分布，而是与局域等离子体温度紧密耦合，而温度又由热传导和辐射损失之间的平衡决定。本练习  将引导你从简单的估算进入更真实的建模，构建一个耦合了这两个过程的一维模型。通过求解该模型，你将能够数值上观察到一个自洽的“辐射前沿”的形成，这是理解偏滤器脱靶状态的一个关键物理现象。",
            "id": "3993836",
            "problem": "要求您为偏滤器靶板腿中的杂质辐射平衡构建并求解一个一维稳态耦合输运-辐射模型。坐标为从上游区域（$s = 0$）到靶板（$s = L$）的平行距离 $s \\in [0,L]$。目标是展示辐射前沿的形成，该前沿定义为源于上游的平行传导热通量被杂质的局部体积辐射基本耗盡的位置。\n\n从以下基本基础开始：\n- 稳态下沿磁力线的能量守恒意味着传导热通量的散度与体积汇相平衡。设 $q(s)$ 为电子平行传导热通量，$P_{\\mathrm{rad}}(s)$ 为体积辐射功率密度。那么\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s).\n$$\n- 在碰撞区中采用 Spitzer–Härm 电子平行传导模型，即 $q(s) = - \\kappa_{0} \\, T_{e}(s)^{5/2} \\,\\frac{d T_{e}}{d s}$，其中 $T_{e}(s)$ 是电子温度，$\\kappa_{0}$ 是一个恒定系数。\n- 杂质辐射功率密度模型为\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right),\n$$\n其中 $n_{e}(s)$ 是电子密度，$n_{z}(s)$ 是杂质密度，$L_{z}(T)$ 是一个杂质冷却函数（功率系数）。\n\n假设以下科学上符合实际的建模选择以闭合该系统：\n- 电子密度是均匀的，$n_{e}(s) \\equiv n_{e}$。\n- 杂质密度在靶板附近更强，并以特征屏蔽长度 $\\lambda_{z}$ 向上游衰减，其模型为\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right),\n$$\n其中 $f_{z0}$ 是靶板附近的杂质份额。\n- 杂质冷却函数在 $T_{p}$ 附近有一个单一温度峰值，并在更低和更高温度下衰减。使用以下光滑解析形式\n$$\nL_{z}(T) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T}\\right)^{\\beta}},\n$$\n其中 $L_{\\max}$、$T_{p}$、$\\alpha$ 和 $\\beta$ 为给定常数。\n\n将这些组合成一个关于 $T_{e}(s)$ 和 $q(s)$ 的一阶常微分方程组（ODE），适合进行数值求解：\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}, \n\\qquad\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right).\n$$\n为保证数值鲁棒性，您可以通过将 $T_{e}$ 的下限限制为一个微小的正数下限值 $T_{\\min}$ 来对第一个方程中的分母进行正则化。\n\n边界条件和输入数据：\n- 上游边界条件：指定的入射平行热通量 $q(0) = q_{\\mathrm{up}}$。\n- 上游初始温度：$T_{e}(0) = T_{\\mathrm{up}}$。\n- 求解域长度：$s \\in [0,L]$。\n\n辐射前沿的定义：\n- 定义辐射前沿位置 $s_{\\mathrm{front}}$ 为满足 $q(s) \\le \\varepsilon \\, q_{\\mathrm{up}}$ 的最小 $s \\in [0,L]$，其中 $0  \\varepsilon \\ll 1$ 是一个很小的阈值。如果 $[0,L]$ 内不存在这样的 $s$，则返回 $s_{\\mathrm{front}} = -1.0$。\n\n使用的物理单位和常数：\n- 温度以电子伏特 (eV) 表示，长度以米 (m) 表示，密度以 $\\mathrm{m}^{-3}$ 表示，功率密度以 $\\mathrm{W}\\,\\mathrm{m}^{-3}$ 表示。\n- 使用 $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$。\n- 使用 $T_{\\min} = 0.2\\,\\mathrm{eV}$ 作为数值下限值。\n- 使用 $\\varepsilon = 0.05$。\n\n测试组：\n对于以下每种情况，计算 $s_{\\mathrm{front}}$（单位为米），并四舍五入到三位小数。\n\n- 情况 A (理想情况): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 2.5\\times 10^{-3}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$。\n- 情况 B (低杂质边界): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 1.0\\times 10^{-4}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$。\n- 情况 C (强冷却边缘): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$, $q_{\\mathrm{up}} = 5.0\\times 10^{6}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 5.0\\times 10^{-3}$, $\\lambda_{z} = 3.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$。\n\n计算要求：\n- 使用适用于常微分方程（ODE）的显式求解器（例如 Runge–Kutta 方法），沿 $s$ 从 $s=0$ 到 $s=L$ 积分该耦合一阶系统。\n- 一旦 $q(s)$ 首次满足 $q(s) \\le \\varepsilon q_{\\mathrm{up}}$，立即检测 $s_{\\mathrm{front}}$，否则如果在 $s=L$ 之前不存在这样的点，则返回 $-1.0$。\n- 以浮点数形式报告 $s_{\\mathrm{front}}$（单位为 $\\mathrm{m}$），四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个结果，以逗号分隔并用方括号括起来，例如 $[x_{A},x_{B},x_{C}]$，其中每个 $x$ 是相应情况下 $s_{\\mathrm{front}}$ 的四舍五入值。",
            "solution": "该问题提出了一个用于聚变偏滤器中热输运和辐射的一维稳态模型。任务是确定“辐射前沿”的位置，即入射热通量被杂质辐射耗散掉的地方。这是一个基于等离子体物理学既定原理的、针对常微分方程组（ODE）的良态初值问题。\n\n沿磁力线的等离子体状态由坐标 $s$（从 $s=0$（上游）到 $s=L$（靶板））参数化，通过电子温度 $T_{e}(s)$ 和平行传导热通量 $q(s)$ 来描述。控制方程构成一个耦合的一阶系统：\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s)\n$$\n第一个方程源自电子热传导的 Spitzer–Härm 模型，$q = -\\kappa_{0} T_{e}^{5/2} (dT_{e}/ds)$，其中 $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$ 是热导率系数。为保证数值稳定性，分母中的温度被设置了下限值，$T_{e} \\ge T_{\\min} = 0.2\\,\\mathrm{eV}$。\n\n第二个方程表示能量守恒，其中热通量的散度由体积功率汇 $P_{\\mathrm{rad}}(s)$ 平衡。该辐射功率密度由下式给出：\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right)\n$$\n该模型假设电子密度是均匀的，$n_{e}(s) \\equiv n_{e}$。杂质密度 $n_{z}(s)$ 被建模为在靶板（$s=L$）处最高，并以特征长度 $\\lambda_{z}$ 向上游呈指数衰减：\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\n$$\n其中 $f_{z0}$ 是靶板处的杂质份额。\n\n杂质冷却函数 $L_{z}(T_{e})$ 代表了杂质种类的辐射效率，由一个在温度 $T_{p}$ 处达到峰值的解析函数描述：\n$$\nL_{z}(T_{e}) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T_{e}}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T_{e}}\\right)^{\\beta}}\n$$\n将这些表达式代入 $dq/ds$ 方程，完整的 ODE 系统为：\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, \\max(T_{e}, T_{\\min})^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}^{2}\\, f_{z0}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\\, \\frac{L_{\\max}}{1 + \\left(\\frac{\\max(T_{e}, T_{\\min})}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{\\max(T_{e}, T_{\\min})}\\right)^{\\beta}}\n$$\n该系统构成一个初值问题，其条件在上游边界 $s=0$ 处指定：\n$$\nT_{e}(0) \\;=\\; T_{\\mathrm{up}}\n$$\n$$\nq(0) \\;=\\; q_{\\mathrm{up}}\n$$\n问题在于要将此系统从 $s=0$ 积分到 $s=L$，并找到辐射前沿位置 $s_{\\mathrm{front}}$。它被定义为热通量 $q(s)$ 下降到其初始值的很小一部分 $\\varepsilon = 0.05$ 的第一个点 $s$，即 $q(s) \\le \\varepsilon q_{\\mathrm{up}}$。如果此条件在域 $[0, L]$ 内未被满足，则报告 $s_{\\mathrm{front}}$ 为 $-1.0$。\n\n为了进行数值求解，我们采用一个自适应步长的 Runge-Kutta 求解器，具体来说是 `scipy.integrate` 库中的 `solve_ivp` 函数。该函数非常适合此任务，因为它提供了强大的事件检测功能。我们定义一个状态变量向量 $\\vec{y}(s) = [T_e(s), q(s)]^T$。ODE 系统被实现为一个函数，该函数在给定 $s$ 和 $\\vec{y}$ 的情况下计算 $d\\vec{y}/ds$。\n\n我们定义一个事件函数来检测辐射前沿。该函数计算量 $q(s) - \\varepsilon q_{\\mathrm{up}}$。求解器被配置为寻找该函数的根（即 $q(s) = \\varepsilon q_{\\mathrm{up}}$ 处），并在检测到根时终止积分。由于 $q(s)$ 预计会单调递减（因为 $P_{\\mathrm{rad}} \\ge 0$，所以 $dq/ds \\le 0$），找到的第一个根将对应于满足条件的最小 $s$。\n\n求解过程通过遍历每个测试用例来进行。对于每种情况，设置参数，定义初始状态向量 $\\vec{y}(0) = [T_{\\mathrm{up}}, q_{\\mathrm{up}}]$，并对域 $s \\in [0, L]$调用求解器。如果求解器报告事件被触发，则相应的时间（即空间坐标 $s$）被记录为 $s_{\\mathrm{front}}$。如果积分完成到 $s=L$ 而事件未被触发，则将 $s_{\\mathrm{front}}$ 设置为 $-1.0$。最终结果按要求四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coupled ODE system for impurity radiation balance in a divertor \n    for three distinct test cases to find the radiation front location.\n    \"\"\"\n\n    # Physical and numerical constants\n    KAPPA_0 = 2000.0  # W m^-1 eV^-7/2\n    T_MIN = 0.2        # eV\n    EPSILON = 0.05     # Radiation front threshold fraction\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 2.5e-3, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case B (low-impurity boundary)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 1.0e-4, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case C (strong-cooling edge)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 5.0e6, \"T_up\": 120.0,\n            \"f_z0\": 5.0e-3, \"lambda_z\": 3.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n\n        def ode_system(s, y):\n            \"\"\"\n            Defines the coupled first-order ODE system for T_e and q.\n            y[0] = T_e (electron temperature)\n            y[1] = q (parallel heat flux)\n            s = parallel distance\n            \"\"\"\n            T_e, q = y\n            \n            # Apply numerical floor to temperature for robustness\n            T_e_reg = max(T_e, T_MIN)\n\n            # Impurity density n_z(s)\n            n_z = params[\"f_z0\"] * params[\"n_e\"] * np.exp((s - params[\"L\"]) / params[\"lambda_z\"])\n\n            # Impurity cooling function L_z(T_e)\n            T_ratio = T_e_reg / params[\"T_p\"]\n            L_z = params[\"L_max\"] / (1.0 + T_ratio**params[\"alpha\"] + (1.0 / T_ratio)**params[\"beta\"])\n\n            # Radiation power density P_rad(s)\n            P_rad = params[\"n_e\"] * n_z * L_z\n\n            # Derivatives\n            # dT_e/ds = -q / (kappa_0 * T_e^(5/2))\n            dTeds = -q / (KAPPA_0 * T_e_reg**2.5)\n            \n            # dq/ds = -P_rad\n            dqds = -P_rad\n\n            return [dTeds, dqds]\n\n        # Event function to find where q(s) = epsilon * q_up\n        def radiation_front_event(s, y):\n            q = y[1]\n            return q - EPSILON * params[\"q_up\"]\n\n        # The event is terminal: stop integration when the front is found.\n        radiation_front_event.terminal = True\n        # We are looking for a decreasing function q(s) to hit a value, so direction is -1.\n        radiation_front_event.direction = -1\n\n        # Initial conditions at s=0\n        y0 = [params[\"T_up\"], params[\"q_up\"]]\n        \n        # Integration domain\n        s_span = [0, params[\"L\"]]\n\n        # Solve the ODE\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=s_span,\n            y0=y0,\n            method='RK45',\n            events=radiation_front_event,\n            dense_output=True\n        )\n\n        # Check if the event was triggered\n        if sol.t_events[0].size > 0:\n            s_front = sol.t_events[0][0]\n        else:\n            s_front = -1.0\n            \n        results.append(round(s_front, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在建立了物理模型之后，严谨的科学家必须审视其基本假设的有效性。本练习  深入探讨了杂质辐射计算中常用的稳态假设。通过计算碰撞辐射平衡的特征时间尺度，你将能够判断杂质的电荷态分布能否跟上背景等离子体参数的变化，这对于精确模拟边缘局域模 (ELMs) 或破裂等瞬态事件至关重要。",
            "id": "3993851",
            "problem": "在磁约束聚变装置中，向低温偏滤器等离子体中注入氖以增强杂质辐射。在所研究的区域内，电子温度近似恒定为 $T_e=10\\,\\mathrm{eV}$，电子密度为 $n_e=5.0\\times 10^{19}\\,\\mathrm{m}^{-3}$。氖的电荷态布居的碰撞辐射模型被简化为两个主要阶段：中性氖 $N_0$ 和单电离氖 $N_1$。在此模型中，输运被忽略，且在所考虑的时间尺度上，总氖密度 $N_{\\mathrm{tot}}=N_0+N_1$ 是守恒的。布居动力学由电子碰撞电离（从 $N_0$ 到 $N_1$，其麦克斯韦平均速率系数为 $S_0$）和电子-离子复合（从 $N_1$ 到 $N_0$，其麦克斯韦平均速率系数为 $\\alpha_0$）所主导，两者都在电子温度 $T_e$ 下进行评估。在 $T_e=10\\,\\mathrm{eV}$ 时，采用以下符合物理实际的系数：$S_0=1.0\\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ 和 $\\alpha_0=1.5\\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n\n从基本速率方程出发，推导围绕稳态的小扰动的线性化系统，并确定该两阶段氖系统与碰撞辐射平衡相关的最慢弛豫时间尺度。然后，使用给定参数数值计算此时间尺度。最终的时间尺度以微秒表示，并四舍五入至三位有效数字。\n\n为了提供与偏滤器中杂质辐射平衡相关的科学背景，请在推导过程中简要讨论该平衡时间尺度如何用于判断是否需要采用瞬态碰撞辐射（CR）模型来捕捉持续时间为 $0.5\\,\\mathrm{ms}$ 的偏滤器事件中的氖辐射瞬态过程。最终的数值答案必须仅为平衡时间尺度，并按要求以 $\\mathrm{\\mu s}$ 表示。",
            "solution": "该问题要求推导和计算偏滤器等离子体中简化的两阶段氖系统的碰撞辐射平衡时间尺度，并讨论其对建模的意义。此问题具有科学依据，是适定的，且客观公正，因此被认为是有效的。\n\n该系统包含氖的两种电荷态：中性 ($N_0$) 和单电离 ($N_1$)。其动力学由电子碰撞电离和电子-离子复合主导。根据问题陈述，我们可以写出单电离氖布居密度 $N_1$ 的速率方程如下：\n$$\n\\frac{dN_1}{dt} = (\\text{来自 } N_0 \\text{ 电离的源项}) - (\\text{来自 } N_1 \\text{ 复合的汇项})\n$$\n源项是 $N_0$ 的电离速率，它与电子密度 $n_e$、中性氖密度 $N_0$ 和电离速率系数 $S_0$ 成正比。汇项是 $N_1$ 的复合速率，它与电子密度 $n_e$、单电离氖密度 $N_1$ 和复合速率系数 $\\alpha_0$ 成正比。由此得到速率方程：\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_0 - n_e \\alpha_0 N_1\n$$\n总氖密度 $N_{\\mathrm{tot}} = N_0 + N_1$ 是守恒的。这意味着总密度的变化率为零：\n$$\n\\frac{dN_{\\mathrm{tot}}}{dt} = \\frac{dN_0}{dt} + \\frac{dN_1}{dt} = 0\n$$\n因此，中性粒子布居的速率方程为 $\\frac{dN_0}{dt} = -\\frac{dN_1}{dt}$。通过引用守恒定律，我们可以仅使用这两个耦合方程中的一个来分析系统动力学。使用 $N_0 = N_{\\mathrm{tot}} - N_1$，我们可以将 $N_1$ 的速率方程完全用 $N_1$ 来重写：\n$$\n\\frac{dN_1}{dt} = n_e S_0 (N_{\\mathrm{tot}} - N_1) - n_e \\alpha_0 N_1\n$$\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_{\\mathrm{tot}} - n_e S_0 N_1 - n_e \\alpha_0 N_1\n$$\n$$\n\\frac{dN_1}{dt} = n_e S_0 N_{\\mathrm{tot}} - n_e(S_0 + \\alpha_0) N_1\n$$\n为求得弛豫时间尺度，我们分析围绕稳态平衡的小扰动。设稳态布居为 $\\bar{N}_0$ 和 $\\bar{N}_1$。在稳态时，$\\frac{dN_1}{dt} = 0$，这给出了平衡方程：\n$$\nn_e S_0 \\bar{N}_0 - n_e \\alpha_0 \\bar{N}_1 = 0 \\implies S_0 \\bar{N}_0 = \\alpha_0 \\bar{N}_1\n$$\n现在，考虑偏离稳态的小扰动 $\\delta N_0(t)$ 和 $\\delta N_1(t)$：\n$$\nN_0(t) = \\bar{N}_0 + \\delta N_0(t)\n$$\n$$\nN_1(t) = \\bar{N}_1 + \\delta N_1(t)\n$$\n根据守恒定律 $N_0 + N_1 = N_{\\mathrm{tot}}$，我们有 $(\\bar{N}_0 + \\delta N_0) + (\\bar{N}_1 + \\delta N_1) = N_{\\mathrm{tot}}$。由于 $\\bar{N}_0 + \\bar{N}_1 = N_{\\mathrm{tot}}$，扰动必须满足 $\\delta N_0 + \\delta N_1 = 0$，即 $\\delta N_0 = -\\delta N_1$。\n\n将扰动量代入 $N_1$ 的速率方程：\n$$\n\\frac{d}{dt}(\\bar{N}_1 + \\delta N_1) = n_e S_0 (\\bar{N}_0 + \\delta N_0) - n_e \\alpha_0 (\\bar{N}_1 + \\delta N_1)\n$$\n由于 $\\bar{N}_1$ 是常数，左边变为 $\\frac{d\\delta N_1}{dt}$。展开右边：\n$$\n\\frac{d\\delta N_1}{dt} = (n_e S_0 \\bar{N}_0 - n_e \\alpha_0 \\bar{N}_1) + n_e S_0 \\delta N_0 - n_e \\alpha_0 \\delta N_1\n$$\n根据稳态的定义，括号中的项为零。代入 $\\delta N_0 = -\\delta N_1$，我们得到扰动 $\\delta N_1$ 的线性化方程：\n$$\n\\frac{d\\delta N_1}{dt} = n_e S_0 (-\\delta N_1) - n_e \\alpha_0 \\delta N_1\n$$\n$$\n\\frac{d\\delta N_1}{dt} = -[n_e (S_0 + \\alpha_0)] \\delta N_1\n$$\n这是一个标准的一阶线性常微分方程，形式为 $\\frac{dy}{dt} = -\\lambda y$，其解为 $y(t) = y(0) \\exp(-\\lambda t)$。弛豫时间尺度 $\\tau$ 是衰减常数 $\\lambda$ 的倒数。因此，这个两阶段系统的最慢（也是唯一）的弛豫时间尺度是：\n$$\n\\tau = \\frac{1}{\\lambda} = \\frac{1}{n_e (S_0 + \\alpha_0)}\n$$\n现在，我们使用给定参数计算此时间尺度的数值：\n$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n$S_0 = 1.0 \\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$\n$\\alpha_0 = 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$\n\n首先，我们对速率系数求和：\n$$\nS_0 + \\alpha_0 = 1.0 \\times 10^{-14}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}\n$$\n$$\nS_0 + \\alpha_0 = 0.1 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} = 1.6 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}\n$$\n接下来，我们计算时间尺度 $\\tau$：\n$$\n\\tau = \\frac{1}{(5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.6 \\times 10^{-13}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1})}\n$$\n$$\n\\tau = \\frac{1}{5.0 \\times 1.6 \\times 10^{19-13}}\\,\\mathrm{s} = \\frac{1}{8.0 \\times 10^6}\\,\\mathrm{s}\n$$\n$$\n\\tau = 0.125 \\times 10^{-6}\\,\\mathrm{s}\n$$\n问题要求答案以微秒（$\\mu\\mathrm{s}$）为单位，并四舍五入到三位有效数字。由于 $1\\,\\mu\\mathrm{s} = 10^{-6}\\,\\mathrm{s}$，我们有：\n$$\n\\tau = 0.125\\,\\mu\\mathrm{s}\n$$\n该值已经用三位有效数字表示。\n\n关于科学背景，问题要求讨论该时间尺度如何为持续时间为 $0.5\\,\\mathrm{ms}$ 的偏滤器事件的辐射建模提供信息。计算出的平衡时间尺度为 $\\tau = 0.125\\,\\mu\\mathrm{s}$。事件持续时间为 $t_{\\mathrm{event}} = 0.5\\,\\mathrm{ms} = 500\\,\\mu\\mathrm{s}$。\n\n平衡时间尺度与事件持续时间的比值为 $\\tau/t_{\\mathrm{event}} = 0.125 / 500 = 1/4000$。由于 $\\tau \\ll t_{\\mathrm{event}}$，相对于事件本身的时间尺度，氖的电荷态布居几乎可以瞬时地适应背景等离子体条件（$T_e$, $n_e$）的任何变化。这意味着，为了建模目的，可以假设在事件过程中的每一时刻，氖的电荷态分布都与局域等离子体处于准静态平衡。因此，可以使用稳态碰撞辐射（CR）模型（其最简单形式也称为电晕平衡模型）来计算等离子体模拟中每个时间步的氖布居及其辐射功率，而无需为杂质种类求解完整的瞬态速率方程。只有当等离子体参数在与 $\\tau$ 相当或更快的时间尺度（即亚微秒时间尺度）上波动时，才有必要为杂质动力学建立一个完整的瞬态CR模型。对于一个相对缓慢的 $0.5\\,\\mathrm{ms}$ 瞬态过程，准静态近似是完全合理的。",
            "answer": "$$\n\\boxed{0.125}\n$$"
        }
    ]
}