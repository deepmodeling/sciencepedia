{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in designing a power exhaust solution for a fusion device is estimating the required amount of impurity to achieve a target level of radiated power. This exercise provides a foundational, hands-on calculation to build intuition for this process . By working through a simplified yet physically meaningful model, you will compare the effectiveness of different common impurity species and determine the concentration needed to manage a high heat flux, a central task in divertor physics.",
            "id": "3993761",
            "problem": "A magnetically confined fusion device operates with a lower single-null divertor whose divertor leg is approximated as a one-dimensional, optically thin, coronal-equilibrium radiation zone of uniform electron temperature and density. The upstream parallel heat flux is prescribed as $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2}$. Assume a uniform electron temperature $T_e$ in the divertor leg and a uniform electron density $n_e$, over an effective radiation extent $L_{\\mathrm{rad}}$ along the magnetic field. The volumetric impurity radiation loss is modeled as $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$, where $n_z$ is the impurity density and $L_z(T_e)$ is the impurity cooling rate coefficient. The radiated power per unit target area from the divertor leg is the line integral of the volumetric loss, which, under the stated uniform assumptions, reduces to $n_e n_z L_z(T_e) L_{\\mathrm{rad}}$. A detached operation target is to radiate a fraction $f_r$ of $q_{\\parallel,u}$ before the power reaches the target plate, with $f_r = 0.5$ in this scenario.\n\nAt low electron temperatures $T_e$ in the range $1$–$10\\,\\mathrm{eV}$, adopt the following experimentally and computationally motivated fits for the cooling rate coefficient $L_z(T_e)$ for three seeded impurities, valid for optically thin, coronal conditions:\n- Nitrogen: $L_z^{\\mathrm{N}}(T_e) \\approx 3.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{-0.2}\\,\\mathrm{W \\cdot m^3}$,\n- Neon: $L_z^{\\mathrm{Ne}}(T_e) \\approx 1.0 \\times 10^{-31} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.1}\\,\\mathrm{W \\cdot m^3}$,\n- Argon: $L_z^{\\mathrm{Ar}}(T_e) \\approx 3.0 \\times 10^{-32} \\left(\\frac{T_e}{5\\,\\mathrm{eV}}\\right)^{0.5}\\,\\mathrm{W \\cdot m^3}$.\n\nAssume $T_e = 5\\,\\mathrm{eV}$, $n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$, and $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$. Define the impurity seeding concentration as the ratio $f_z = n_z/n_e$. Starting from energy conservation and the definition of $L_z(T_e)$, derive the expression that relates $f_z$ to $q_{\\parallel,u}$, $f_r$, $n_e$, $L_{\\mathrm{rad}}$, and $L_z(T_e)$. Then, evaluate the required $f_z$ to radiate $50\\%$ of $q_{\\parallel,u}$ for each species (nitrogen, neon, argon) at $T_e = 5\\,\\mathrm{eV}$.\n\nYour final answer must be the three values of $f_z$ for nitrogen, neon, and argon, respectively, expressed as a single row matrix, rounded to three significant figures, as decimal fractions without units.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of plasma physics, well-posed with sufficient information for a unique solution, and objective in its formulation. We will proceed with the derivation and calculation.\n\nThe first step is to establish the energy balance in the divertor leg. The problem states that a fraction $f_r$ of the upstream parallel heat flux, $q_{\\parallel,u}$, is radiated away. The total power radiated per unit area of the divertor target, $q_{\\mathrm{rad}}$, must equal this fraction of the incoming power.\n$$\nq_{\\mathrm{rad}} = f_r q_{\\parallel,u}\n$$\nThe radiated power per unit area, $q_{\\mathrm{rad}}$, is the line integral of the volumetric radiation loss, $P_{\\mathrm{rad}}$, along the magnetic field line over the radiation extent $L_{\\mathrm{rad}}$. Under the given assumption of uniform electron density $n_e$, impurity density $n_z$, and electron temperature $T_e$, this integral simplifies to a product:\n$$\nq_{\\mathrm{rad}} = P_{\\mathrm{rad}} L_{\\mathrm{rad}}\n$$\nThe volumetric radiation loss is given by the expression $P_{\\mathrm{rad}} = n_e n_z L_z(T_e)$, where $L_z(T_e)$ is the impurity cooling rate coefficient. Substituting this into the expression for $q_{\\mathrm{rad}}$ yields:\n$$\nq_{\\mathrm{rad}} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\nEquating the two expressions for $q_{\\mathrm{rad}}$ gives the core energy balance equation:\n$$\nf_r q_{\\parallel,u} = n_e n_z L_z(T_e) L_{\\mathrm{rad}}\n$$\nThe problem defines the impurity seeding concentration as the ratio $f_z = n_z/n_e$. We can express the impurity density as $n_z = f_z n_e$. Substituting this into the energy balance equation:\n$$\nf_r q_{\\parallel,u} = n_e (f_z n_e) L_z(T_e) L_{\\mathrm{rad}}\n$$\n$$\nf_r q_{\\parallel,u} = f_z n_e^2 L_z(T_e) L_{\\mathrm{rad}}\n$$\nWe can now isolate $f_z$ to obtain the desired expression:\n$$\nf_z = \\frac{f_r q_{\\parallel,u}}{n_e^2 L_z(T_e) L_{\\mathrm{rad}}}\n$$\nThis is the general expression relating the impurity concentration to the other parameters.\n\nNext, we evaluate the cooling rate coefficients $L_z(T_e)$ for each impurity at the specified electron temperature of $T_e = 5\\,\\mathrm{eV}$. The given fitting formulas are normalized to $T_e/(5\\,\\mathrm{eV})$, which simplifies to $1$ for this case.\nFor Nitrogen (N):\n$$\nL_z^{\\mathrm{N}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{-0.2} = (3.0 \\times 10^{-31}) \\times 1^{-0.2} = 3.0 \\times 10^{-31}\\,\\mathrm{W \\cdot m^3}\n$$\nFor Neon (Ne):\n$$\nL_z^{\\mathrm{Ne}}(T_e = 5\\,\\mathrm{eV}) = (1.0 \\times 10^{-31}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.1} = (1.0 \\times 10^{-31}) \\times 1^{0.1} = 1.0 \\times 10^{-31}\\,\\mathrm{W \\cdot m^3}\n$$\nFor Argon (Ar):\n$$\nL_z^{\\mathrm{Ar}}(T_e = 5\\,\\mathrm{eV}) = (3.0 \\times 10^{-32}) \\left(\\frac{5\\,\\mathrm{eV}}{5\\,\\mathrm{eV}}\\right)^{0.5} = (3.0 \\times 10^{-32}) \\times 1^{0.5} = 3.0 \\times 10^{-32}\\,\\mathrm{W \\cdot m^3}\n$$\nNow we can substitute the given numerical values into the derived expression for $f_z$:\n- $f_r = 0.5$\n- $q_{\\parallel,u} = 50\\,\\mathrm{MW/m^2} = 5.0 \\times 10^7\\,\\mathrm{W/m^2}$\n- $n_e = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n- $L_{\\mathrm{rad}} = 5.0\\,\\mathrm{m}$\n\nLet's compute the numerator and the constant part of the denominator:\nNumerator: $f_r q_{\\parallel,u} = 0.5 \\times (5.0 \\times 10^7\\,\\mathrm{W/m^2}) = 2.5 \\times 10^7\\,\\mathrm{W/m^2}$.\nDenominator (without $L_z$): $n_e^2 L_{\\mathrm{rad}} = (5.0 \\times 10^{20}\\,\\mathrm{m^{-3}})^2 \\times (5.0\\,\\mathrm{m}) = (25.0 \\times 10^{40}\\,\\mathrm{m^{-6}}) \\times (5.0\\,\\mathrm{m}) = 1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}$.\n\nNow we calculate $f_z$ for each impurity.\nFor Nitrogen (N):\n$$\nf_z^{\\mathrm{N}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-31}\\,\\mathrm{W \\cdot m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{11}} = 0.666... \\times 10^{-4} \\approx 6.67 \\times 10^{-5}\n$$\nFor Neon (Ne):\n$$\nf_z^{\\mathrm{Ne}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (1.0 \\times 10^{-31}\\,\\mathrm{W \\cdot m^3})} = \\frac{2.5 \\times 10^7}{1.25 \\times 10^{11}} = 2.0 \\times 10^{-4}\n$$\nFor Argon (Ar):\n$$\nf_z^{\\mathrm{Ar}} = \\frac{2.5 \\times 10^7\\,\\mathrm{W/m^2}}{(1.25 \\times 10^{42}\\,\\mathrm{m^{-5}}) \\times (3.0 \\times 10^{-32}\\,\\mathrm{W \\cdot m^3})} = \\frac{2.5 \\times 10^7}{3.75 \\times 10^{10}} = 0.666... \\times 10^{-3} \\approx 6.67 \\times 10^{-4}\n$$\nThe problem requires the answers rounded to three significant figures and expressed as decimal fractions.\n- $f_z^{\\mathrm{N}} \\approx 0.0000667$\n- $f_z^{\\mathrm{Ne}} = 0.000200$ (The trailing zeros are significant)\n- $f_z^{\\mathrm{Ar}} \\approx 0.000667$\n\nThese values represent the required fraction of impurities relative to the electron density to radiate $50\\%$ of the incoming heat flux under the specified conditions.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0000667  0.000200  0.000667 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While simplified models are useful for estimates, real divertor plasmas have complex spatial structures. This computational practice bridges the gap between simple models and realistic scenarios by tasking you with calculating the total radiated power from a divertor volume with non-uniform plasma profiles . Performing this numerical integration is a core skill in fusion science, allowing you to quantify the overall radiative performance based on detailed profile data and explore how different plasma conditions impact power dissipation.",
            "id": "3993840",
            "problem": "You are asked to compute the total impurity radiation power in a toroidally symmetric cylindrical divertor segment and report the fraction of upstream parallel heat flux radiated. The volumetric radiative power density at position with electron temperature $T_e$ is modeled as $p_{\\mathrm{rad}}(T_e) = n_e n_z L_z(T_e)$, where $n_e$ is the electron density, $n_z$ is the impurity density, and $L_z(T_e)$ is the impurity cooling function. Under axial symmetry in cylindrical coordinates, the total radiative power is\n$$\nP_{\\mathrm{rad}}^{\\mathrm{div}} = \\int_V n_e n_z L_z(T_e)\\, dV,\n$$\nwith a cylindrical volume of radius $a$ and length $L$. Using cylindrical coordinates with azimuthal symmetry, the volume element is $dV = 2\\pi r L \\, dr$ and the integral reduces to\n$$\nP_{\\mathrm{rad}}^{\\mathrm{div}} = 2\\pi L \\int_0^a r\\, n_e(r)\\, n_z(r)\\, L_z(T_e(r))\\, dr.\n$$\nYou are to compute $P_{\\mathrm{rad}}^{\\mathrm{div}}$ for given radial profiles $n_e(r)$, $T_e(r)$, and $n_z(r)$, then report the dimensionless fraction\n$$\nf = \\frac{P_{\\mathrm{rad}}^{\\mathrm{div}}}{q_{\\parallel,u} A},\n$$\nwhere $q_{\\parallel,u}$ is the upstream parallel heat flux and $A$ is an effective upstream wetted area. Use the International System of Units (SI), with $P_{\\mathrm{rad}}^{\\mathrm{div}}$ in watts, $q_{\\parallel,u}$ in watts per square meter, $A$ in square meters, $a$ and $L$ in meters, and densities in inverse cubic meters. Electron temperature $T_e$ is specified in electronvolts.\n\nThe impurity cooling function $L_z(T_e)$ for coronal nitrogen is modeled with a log-normal fit as\n$$\nL_z(T_e) = L_0 \\exp\\left(-\\frac{\\left(\\ln\\left(\\frac{T_e}{T_{pk}}\\right)\\right)^2}{2\\sigma^2}\\right),\n$$\nwith $L_0 = 3\\times 10^{-31}$, $T_{pk} = 15$, and $\\sigma = 0.6$, where $L_z$ is in $W \\cdot m^3$ and $T_e$ is in eV.\n\nThe profiles are specified as follows:\n- Electron density:\n$$\nn_e(r) = n_{e0}\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\alpha} + n_{floor},\n$$\n- Electron temperature:\n$$\nT_e(r) = T_{min} + \\left(T_0 - T_{min}\\right)\\left(1 - \\frac{r}{a}\\right)^{\\beta},\n$$\n- Impurity density:\n$$\nn_z(r) = f_{z0}\\, n_e(r)\\, \\left(\\frac{r}{a}\\right)^{\\gamma}.\n$$\n\nYour program must:\n- Implement the above definitions and compute $P_{\\mathrm{rad}}^{\\mathrm{div}}$ using numerical integration over $r \\in [0,a]$.\n- Compute the fraction $f = P_{\\mathrm{rad}}^{\\mathrm{div}}/(q_{\\parallel,u}A)$.\n- For numerical integration, use a sufficiently fine radial mesh to ensure numerical convergence in a scientifically sound manner.\n- Output only the fractions for each test case as a single comma-separated list enclosed in square brackets, with each fraction rounded to six decimal places (e.g., $[0.123456,0.000789,0.456123]$).\n\nTest suite:\nProvide the following four test cases, each defined by the tuple of parameters $(a, L, n_{e0}, n_{floor}, \\alpha, T_0, T_{min}, \\beta, f_{z0}, \\gamma, q_{\\parallel,u}, A)$:\n1. Happy path case with moderate densities and temperatures:\n   - $a = 0.08$, $L = 3.0$, $n_{e0} = 1.5\\times 10^{20}$, $n_{floor} = 1.0\\times 10^{19}$, $\\alpha = 1.0$, $T_0 = 50$, $T_{min} = 2$, $\\beta = 2.0$, $f_{z0} = 5.0\\times 10^{-3}$, $\\gamma = 3.0$, $q_{\\parallel,u} = 8.0\\times 10^{6}$, $A = 1.0$.\n2. Edge case with negligible impurity presence:\n   - $a = 0.08$, $L = 3.0$, $n_{e0} = 1.5\\times 10^{20}$, $n_{floor} = 1.0\\times 10^{19}$, $\\alpha = 1.0$, $T_0 = 50$, $T_{min} = 2$, $\\beta = 2.0$, $f_{z0} = 1.0\\times 10^{-6}$, $\\gamma = 3.0$, $q_{\\parallel,u} = 8.0\\times 10^{6}$, $A = 1.0$.\n3. Boundary case with colder, denser divertor enhancing radiation near the peak of $L_z(T_e)$:\n   - $a = 0.10$, $L = 4.0$, $n_{e0} = 2.0\\times 10^{20}$, $n_{floor} = 2.0\\times 10^{19}$, $\\alpha = 1.5$, $T_0 = 25$, $T_{min} = 1$, $\\beta = 3.0$, $f_{z0} = 8.0\\times 10^{-3}$, $\\gamma = 2.0$, $q_{\\parallel,u} = 5.0\\times 10^{6}$, $A = 0.8$.\n4. Very hot divertor where $T_e$ is mostly above the peak of $L_z(T_e)$:\n   - $a = 0.07$, $L = 2.5$, $n_{e0} = 1.2\\times 10^{20}$, $n_{floor} = 8.0\\times 10^{18}$, $\\alpha = 1.2$, $T_0 = 120$, $T_{min} = 10$, $\\beta = 2.5$, $f_{z0} = 4.0\\times 10^{-3}$, $\\gamma = 2.5$, $q_{\\parallel,u} = 1.0\\times 10^{7}$, $A = 1.2$.\n\nFinal output format:\nYour program should produce a single line of output containing the fractions for the four test cases as a comma-separated list enclosed in square brackets, with each element rounded to six decimal places, in International System of Units (SI), and the fraction represented as a decimal (no percentage sign). For example: $[f_1,f_2,f_3,f_4]$.",
            "solution": "The central task is to compute the fraction of upstream parallel heat flux that is radiated by impurities in a simplified cylindrical divertor plasma. This requires calculating the total radiated power, $P_{\\mathrm{rad}}^{\\mathrm{div}}$, by integrating the volumetric power loss over the divertor volume, and then normalizing this quantity by the total incoming power, $q_{\\parallel,u} A$.\n\nThe starting point is the formal definition of the total radiated power, which is the integral of the volumetric power density, $p_{\\mathrm{rad}}$, over the volume $V$ of the divertor segment:\n$$\nP_{\\mathrm{rad}}^{\\mathrm{div}} = \\int_V p_{\\mathrm{rad}} \\, dV\n$$\nThe volumetric power density is given by the expression $p_{\\mathrm{rad}}(T_e) = n_e n_z L_z(T_e)$, where $n_e$ is the electron density, $n_z$ is the impurity density, and $L_z(T_e)$ is the temperature-dependent impurity cooling rate coefficient. All these quantities are functions of position. The problem specifies a cylindrical geometry of radius $a$ and length $L$, and assumes toroidal (azimuthal) symmetry. In cylindrical coordinates $(r, \\theta, z)$, this symmetry implies the integrand is independent of $\\theta$. The volume element is $dV = r \\, dr \\, d\\theta \\, dz$. Integrating over $\\theta \\in [0, 2\\pi]$ and assuming uniformity along the length $L$ (which is a standard simplification in 1D radial models), the integral becomes:\n$$\nP_{\\mathrm{rad}}^{\\mathrm{div}} = \\int_0^L \\int_0^{2\\pi} \\int_0^a r \\, n_e(r) \\, n_z(r) \\, L_z(T_e(r)) \\, dr \\, d\\theta \\, dz = 2\\pi L \\int_0^a r \\, n_e(r) \\, n_z(r) \\, L_z(T_e(r)) \\, dr\n$$\nThe problem provides specific functional forms for the radial profiles of electron density $n_e(r)$, electron temperature $T_e(r)$, impurity density $n_z(r)$, and the cooling function $L_z(T_e)$.\n\nThe impurity cooling function for coronal nitrogen is modeled as a log-normal distribution:\n$$\nL_z(T_e) = L_0 \\exp\\left(-\\frac{\\left(\\ln\\left(\\frac{T_e}{T_{pk}}\\right)\\right)^2}{2\\sigma^2}\\right)\n$$\nwith given constants $L_0 = 3\\times 10^{-31} \\, \\mathrm{W \\cdot m^3}$, $T_{pk} = 15 \\, \\mathrm{eV}$, and $\\sigma = 0.6$.\n\nThe radial profiles are defined as:\n1. Electron density: $n_e(r) = n_{e0}\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\alpha} + n_{floor}$\n2. Electron temperature: $T_e(r) = T_{min} + \\left(T_0 - T_{min}\\right)\\left(1 - \\frac{r}{a}\\right)^{\\beta}$\n3. Impurity density: $n_z(r) = f_{z0}\\, n_e(r)\\, \\left(\\frac{r}{a}\\right)^{\\gamma}$\n\nSubstituting these definitions into the integral for $P_{\\mathrm{rad}}^{\\mathrm{div}}$, we define the integrand, which we shall denote $I(r)$:\n$$\nI(r) = r \\cdot n_e(r) \\cdot n_z(r) \\cdot L_z(T_e(r))\n$$\nBy substituting the expression for $n_z(r)$, the integrand can be expressed more explicitly:\n$$\nI(r) = r \\cdot n_e(r) \\cdot \\left[ f_{z0}\\, n_e(r)\\, \\left(\\frac{r}{a}\\right)^{\\gamma} \\right] \\cdot L_z(T_e(r)) = f_{z0} \\frac{r^{\\gamma+1}}{a^{\\gamma}} [n_e(r)]^2 L_z(T_e(r))\n$$\nThe full expression for $P_{\\mathrm{rad}}^{\\mathrm{div}}$ is therefore:\n$$\nP_{\\mathrm{rad}}^{\\mathrm{div}} = 2\\pi L f_{z0} \\int_0^a \\frac{r^{\\gamma+1}}{a^{\\gamma}} \\left[ n_{e0}\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\alpha} + n_{floor} \\right]^2 L_z\\left(T_{min} + \\left(T_0 - T_{min}\\right)\\left(1 - \\frac{r}{a}\\right)^{\\beta}\\right) dr\n$$\nThis integral does not have a simple analytical solution and must be evaluated numerically. Since the integrand is continuous and well-behaved on the interval $r \\in [0, a]$ (as $\\gamma  0$ for all test cases, the integrand is zero at $r=0$), standard numerical quadrature methods, such as those provided by the `scipy.integrate.quad` function, are suitable and will provide a result with high precision.\n\nOnce $P_{\\mathrm{rad}}^{\\mathrm{div}}$ is computed in units of watts, the final desired quantity is the dimensionless radiated fraction, $f$, defined as:\n$$\nf = \\frac{P_{\\mathrm{rad}}^{\\mathrm{div}}}{q_{\\parallel,u} A}\n$$\nwhere $q_{\\parallel,u}$ is the upstream parallel heat flux (in $\\mathrm{W/m^2}$) and $A$ is the effective upstream wetted area (in $\\mathrm{m^2}$), such that the denominator represents the total power flowing into the divertor.\n\nThe procedure is to implement the integrand function $I(r)$ using the given parameters for each test case, perform the numerical integration from $r=0$ to $r=a$, multiply by the constant prefactor $2\\pi L$, and finally compute the fraction $f$. This process is repeated for each of the four specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the total impurity radiation power fraction in a cylindrical divertor segment.\n    \"\"\"\n\n    # Constants for the impurity cooling function L_z(T_e)\n    L0 = 3e-31  # W m^3\n    T_pk = 15.0   # eV\n    sigma = 0.6\n\n    # Test suite: (a, L, n_e0, n_floor, alpha, T0, T_min, beta, f_z0, gamma, q_par_u, A)\n    test_cases = [\n        (0.08, 3.0, 1.5e20, 1.0e19, 1.0, 50.0, 2.0, 2.0, 5.0e-3, 3.0, 8.0e6, 1.0),\n        (0.08, 3.0, 1.5e20, 1.0e19, 1.0, 50.0, 2.0, 2.0, 1.0e-6, 3.0, 8.0e6, 1.0),\n        (0.10, 4.0, 2.0e20, 2.0e19, 1.5, 25.0, 1.0, 3.0, 8.0e-3, 2.0, 5.0e6, 0.8),\n        (0.07, 2.5, 1.2e20, 8.0e18, 1.2, 120.0, 10.0, 2.5, 4.0e-3, 2.5, 1.0e7, 1.2),\n    ]\n\n    def integrand(r, a, n_e0, n_floor, alpha, T0, T_min, beta, f_z0, gamma):\n        \"\"\"\n        Calculates the value of the integrand: r * n_e * n_z * L_z at a given radius r.\n        \"\"\"\n        if r  0 or r  a:\n            return 0.0\n\n        # Electron density profile\n        # Clamping argument of power to be non-negative for robustness\n        base_ne = max(0.0, 1.0 - (r / a)**2)\n        n_e_r = n_e0 * (base_ne**alpha) + n_floor\n\n        # Electron temperature profile\n        base_Te = max(0.0, 1.0 - r / a)\n        T_e_r = T_min + (T0 - T_min) * (base_Te**beta)\n        \n        # Impurity density profile\n        # The form r**(gamma+1) / a**gamma is used for numerical stability at r=0.\n        # The full integrand term is f_z0/a^gamma * r^(gamma+1) * n_e^2 * L_z\n        # Here we calculate n_z for clarity.\n        if r == 0.0:\n            n_z_r = 0.0\n        else:\n            n_z_r = f_z0 * n_e_r * (r / a)**gamma\n            \n        # Impurity cooling function L_z(T_e)\n        # T_e_r is always  0 since T_min  0 in all cases\n        log_term = np.log(T_e_r / T_pk)\n        L_z_r = L0 * np.exp(-(log_term**2) / (2.0 * sigma**2))\n\n        return r * n_e_r * n_z_r * L_z_r\n\n    results = []\n    for case in test_cases:\n        a, L, n_e0, n_floor, alpha, T0, T_min, beta, f_z0, gamma, q_par_u, A = case\n\n        # Perform numerical integration\n        integral_val, _ = quad(\n            integrand, 0, a,\n            args=(a, n_e0, n_floor, alpha, T0, T_min, beta, f_z0, gamma)\n        )\n\n        # Calculate total radiated power\n        P_rad_div = 2.0 * np.pi * L * integral_val\n\n        # Calculate upstream power\n        P_upstream = q_par_u * A\n\n        # Calculate the radiated fraction\n        if P_upstream == 0:\n            f = 0.0\n        else:\n            f = P_rad_div / P_upstream\n        \n        results.append(f)\n\n    # Format the output string as per requirements\n    output_str = \"[\" + \",\".join([f\"{res:.6f}\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The most powerful insights come from understanding the dynamic interplay and feedback between plasma transport and atomic processes. This advanced practice guides you through the development of a self-consistent model where impurity radiation is not just a passive energy sink but an active component that fundamentally alters the plasma temperature profile . By solving a coupled set of transport and radiation equations, you will simulate the formation of a \"radiation front,\" a highly localized cooling region that is the hallmark of a successfully detached divertor.",
            "id": "3993836",
            "problem": "You are asked to construct and solve a one-dimensional, steady-state coupled transport–radiation model for impurity radiation balance in a divertor leg. The coordinate is the parallel distance $s \\in [0,L]$ from the upstream region ($s = 0$) to the target ($s = L$). The objective is to demonstrate the formation of a radiation front, defined as the location where the parallel conductive heat flux that originates upstream is largely exhausted by local volumetric radiation from impurities.\n\nBegin from the following fundamental base:\n- Conservation of energy along the field line in steady state implies that the divergence of the conductive heat flux balances volumetric sinks. Let $q(s)$ be the electron parallel conductive heat flux and $P_{\\mathrm{rad}}(s)$ be the volumetric radiation power density. Then\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s).\n$$\n- Adopt Spitzer–Härm electron parallel conduction in the collisional regime with $q(s) = - \\kappa_{0} \\, T_{e}(s)^{5/2} \\,\\frac{d T_{e}}{d s}$, where $T_{e}(s)$ is the electron temperature and $\\kappa_{0}$ is a constant coefficient.\n- The impurity radiation power density is modeled as\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right),\n$$\nwhere $n_{e}(s)$ is the electron density, $n_{z}(s)$ is the impurity density, and $L_{z}(T)$ is an impurity cooling function (power coefficient).\n\nAssume the following scientifically realistic modeling choices to close the system:\n- The electron density is uniform, $n_{e}(s) \\equiv n_{e}$.\n- The impurity density is stronger near the target and decays upstream with a screening length $\\lambda_{z}$, modeled as\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right),\n$$\nwhere $f_{z0}$ is the impurity fraction near the target.\n- The impurity cooling function has a single temperature peak around $T_{p}$ and decays for both lower and higher temperatures. Use the smooth analytic form\n$$\nL_{z}(T) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T}\\right)^{\\beta}},\n$$\nwith given constants $L_{\\max}$, $T_{p}$, $\\alpha$, and $\\beta$.\n\nCombine these into a first-order system of Ordinary Differential Equations (ODEs) for $T_{e}(s)$ and $q(s)$, suitable for numerical solution:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}, \n\\qquad\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right).\n$$\nFor numerical robustness, you may regularize the denominator in the first equation by bounding $T_{e}$ below by a small positive floor $T_{\\min}$.\n\nBoundary and input data:\n- Upstream boundary condition: a specified incoming parallel heat flux $q(0) = q_{\\mathrm{up}}$.\n- Upstream initial temperature: $T_{e}(0) = T_{\\mathrm{up}}$.\n- Domain length: $s \\in [0,L]$.\n\nDefinition of the radiation front:\n- Define the radiation front location $s_{\\mathrm{front}}$ as the smallest $s \\in [0,L]$ such that $q(s) \\le \\varepsilon \\, q_{\\mathrm{up}}$, for a small threshold $0  \\varepsilon \\ll 1$. If no such $s$ exists in $[0,L]$, return $s_{\\mathrm{front}} = -1.0$.\n\nPhysical units and constants to use:\n- Express temperature in electron-volts (eV), length in meters (m), density in $m^{-3}$, and power density in $W \\cdot m^{-3}$.\n- Use $\\kappa_{0} = 2000\\,\\mathrm{W \\cdot m^{-1} \\cdot eV^{-7/2}}$.\n- Use $T_{\\min} = 0.2\\,\\mathrm{eV}$ as a numerical floor.\n- Use $\\varepsilon = 0.05$.\n\nTest suite:\nFor each case below, compute $s_{\\mathrm{front}}$ in meters, rounded to three decimals.\n\n- Case A (happy path): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m^{-3}}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W \\cdot m^{-2}}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 2.5\\times 10^{-3}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W \\cdot m^{3}}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n- Case B (low-impurity boundary): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m^{-3}}$, $q_{\\mathrm{up}} = 1.0\\times 10^{7}\\,\\mathrm{W \\cdot m^{-2}}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 1.0\\times 10^{-4}$, $\\lambda_{z} = 5.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W \\cdot m^{3}}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n- Case C (strong-cooling edge): $L = 25\\,\\mathrm{m}$, $n_{e} = 5.0\\times 10^{19}\\,\\mathrm{m^{-3}}$, $q_{\\mathrm{up}} = 5.0\\times 10^{6}\\,\\mathrm{W \\cdot m^{-2}}$, $T_{\\mathrm{up}} = 120\\,\\mathrm{eV}$, $f_{z0} = 5.0\\times 10^{-3}$, $\\lambda_{z} = 3.0\\,\\mathrm{m}$, $L_{\\max} = 1.0\\times 10^{-30}\\,\\mathrm{W \\cdot m^{3}}$, $T_{p} = 10\\,\\mathrm{eV}$, $\\alpha = 2.0$, $\\beta = 2.0$.\n\nComputational requirements:\n- Integrate the coupled first-order system along $s$ from $s=0$ to $s=L$ using a suitable explicit solver for Ordinary Differential Equations (ODEs), such as a Runge–Kutta method.\n- Detect $s_{\\mathrm{front}}$ as soon as $q(s)$ first satisfies $q(s) \\le \\varepsilon q_{\\mathrm{up}}$, otherwise return $-1.0$ if no such point exists up to $s=L$.\n- Report $s_{\\mathrm{front}}$ in $\\mathrm{m}$ rounded to three decimals, as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example, $[x_{A},x_{B},x_{C}]$, where each $x$ is the rounded value of $s_{\\mathrm{front}}$ for the corresponding case.",
            "solution": "The problem presents a one-dimensional, steady-state model for heat transport and radiation in a fusion divertor. The task is to determine the location of the \"radiation front,\" where the incoming heat flux is dissipated by impurity radiation. This is a well-posed initial value problem for a system of ordinary differential equations (ODEs), grounded in established principles of plasma physics.\n\nThe state of the plasma along the magnetic field line, parameterized by the coordinate $s$ from $s=0$ (upstream) to $s=L$ (target), is described by the electron temperature $T_{e}(s)$ and the parallel conductive heat flux $q(s)$. The governing equations form a coupled first-order system:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, T_{e}^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\,P_{\\mathrm{rad}}(s)\n$$\nThe first equation is derived from the Spitzer–Härm model for electron heat conduction, $q = -\\kappa_{0} T_{e}^{5/2} (dT_{e}/ds)$, where $\\kappa_{0} = 2000\\,\\mathrm{W \\cdot m^{-1} \\cdot eV^{-7/2}}$ is the thermal conductivity coefficient. For numerical stability, the temperature in the denominator is floored at a minimum value, $T_{e} \\ge T_{\\min} = 0.2\\,\\mathrm{eV}$.\n\nThe second equation expresses the conservation of energy, where the divergence of the heat flux is balanced by a volumetric power sink, $P_{\\mathrm{rad}}(s)$. This radiation power density is given by:\n$$\nP_{\\mathrm{rad}}(s) \\;=\\; n_{e}(s)\\, n_{z}(s)\\, L_{z}\\!\\left(T_{e}(s)\\right)\n$$\nThe model assumes a uniform electron density $n_{e}(s) \\equiv n_{e}$. The impurity density, $n_{z}(s)$, is modeled to be highest at the target ($s=L$) and decay exponentially upstream with a characteristic length $\\lambda_{z}$:\n$$\nn_{z}(s) \\;=\\; f_{z0}\\, n_{e}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\n$$\nwhere $f_{z0}$ is the impurity fraction at the target.\n\nThe impurity cooling function, $L_{z}(T_{e})$, which represents the radiative efficiency of the impurity species, is described by an analytic function peaked at temperature $T_{p}$:\n$$\nL_{z}(T_{e}) \\;=\\; \\frac{L_{\\max}}{1 + \\left(\\frac{T_{e}}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{T_{e}}\\right)^{\\beta}}\n$$\nSubstituting these expressions into the equation for $dq/ds$, the complete ODE system is:\n$$\n\\frac{d T_{e}}{d s} \\;=\\; -\\,\\frac{q}{\\kappa_{0}\\, \\max(T_{e}, T_{\\min})^{5/2}}\n$$\n$$\n\\frac{d q}{d s} \\;=\\; -\\, n_{e}^{2}\\, f_{z0}\\, \\exp\\!\\left(\\frac{s-L}{\\lambda_{z}}\\right)\\, \\frac{L_{\\max}}{1 + \\left(\\frac{\\max(T_{e}, T_{\\min})}{T_{p}}\\right)^{\\alpha} + \\left(\\frac{T_{p}}{\\max(T_{e}, T_{\\min})}\\right)^{\\beta}}\n$$\nThis system constitutes an initial value problem with conditions specified at the upstream boundary $s=0$:\n$$\nT_{e}(0) \\;=\\; T_{\\mathrm{up}}\n$$\n$$\nq(0) \\;=\\; q_{\\mathrm{up}}\n$$\nThe problem is to integrate this system from $s=0$ to $s=L$ and find the radiation front location, $s_{\\mathrm{front}}$. This is defined as the first point $s$ where the heat flux $q(s)$ drops to a small fraction $\\varepsilon = 0.05$ of its initial value, i.e., $q(s) \\le \\varepsilon q_{\\mathrm{up}}$. If this condition is not met within the domain $[0, L]$, $s_{\\mathrm{front}}$ is reported as $-1.0$.\n\nTo solve this numerically, we employ an adaptive step-size Runge-Kutta solver, specifically the `solve_ivp` function from the `scipy.integrate` library. This function is well-suited for this task as it provides robust event detection capabilities. We define a vector of state variables $\\vec{y}(s) = [T_e(s), q(s)]^T$. The ODE system is implemented as a function that computes $d\\vec{y}/ds$ given $s$ and $\\vec{y}$.\n\nAn event function is defined to detect the radiation front. This function calculates the quantity $q(s) - \\varepsilon q_{\\mathrm{up}}$. The solver is configured to find the root of this function (where $q(s) = \\varepsilon q_{\\mathrm{up}}$) and to terminate integration upon its detection. Since $q(s)$ is expected to decrease monotonically (as $P_{\\mathrm{rad}} \\ge 0$, thus $dq/ds \\le 0$), the first root found will correspond to the smallest $s$ satisfying the condition.\n\nThe solution proceeds by iterating through each test case. For each case, the parameters are set, the initial state vector $\\vec{y}(0) = [T_{\\mathrm{up}}, q_{\\mathrm{up}}]$ is defined, and the solver is called for the domain $s \\in [0, L]$. If the solver reports that the event was triggered, the corresponding time (which is the spatial coordinate $s$) is recorded as $s_{\\mathrm{front}}$. If the integration completes to $s=L$ without the event being triggered, $s_{\\mathrm{front}}$ is set to $-1.0$. The final result is rounded to three decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coupled ODE system for impurity radiation balance in a divertor \n    for three distinct test cases to find the radiation front location.\n    \"\"\"\n\n    # Physical and numerical constants\n    KAPPA_0 = 2000.0  # W m^-1 eV^-7/2\n    T_MIN = 0.2        # eV\n    EPSILON = 0.05     # Radiation front threshold fraction\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 2.5e-3, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case B (low-impurity boundary)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 1.0e7, \"T_up\": 120.0,\n            \"f_z0\": 1.0e-4, \"lambda_z\": 5.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        },\n        # Case C (strong-cooling edge)\n        {\n            \"L\": 25.0, \"n_e\": 5.0e19, \"q_up\": 5.0e6, \"T_up\": 120.0,\n            \"f_z0\": 5.0e-3, \"lambda_z\": 3.0, \"L_max\": 1.0e-30,\n            \"T_p\": 10.0, \"alpha\": 2.0, \"beta\": 2.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n\n        def ode_system(s, y):\n            \"\"\"\n            Defines the coupled first-order ODE system for T_e and q.\n            y[0] = T_e (electron temperature)\n            y[1] = q (parallel heat flux)\n            s = parallel distance\n            \"\"\"\n            T_e, q = y\n            \n            # Apply numerical floor to temperature for robustness\n            T_e_reg = max(T_e, T_MIN)\n\n            # Impurity density n_z(s)\n            n_z = params[\"f_z0\"] * params[\"n_e\"] * np.exp((s - params[\"L\"]) / params[\"lambda_z\"])\n\n            # Impurity cooling function L_z(T_e)\n            T_ratio = T_e_reg / params[\"T_p\"]\n            L_z = params[\"L_max\"] / (1.0 + T_ratio**params[\"alpha\"] + (1.0 / T_ratio)**params[\"beta\"])\n\n            # Radiation power density P_rad(s)\n            P_rad = params[\"n_e\"] * n_z * L_z\n\n            # Derivatives\n            # dT_e/ds = -q / (kappa_0 * T_e^(5/2))\n            dTeds = -q / (KAPPA_0 * T_e_reg**2.5)\n            \n            # dq/ds = -P_rad\n            dqds = -P_rad\n\n            return [dTeds, dqds]\n\n        # Event function to find where q(s) = epsilon * q_up\n        def radiation_front_event(s, y):\n            q = y[1]\n            return q - EPSILON * params[\"q_up\"]\n\n        # The event is terminal: stop integration when the front is found.\n        radiation_front_event.terminal = True\n        # We are looking for a decreasing function q(s) to hit a value, so direction is -1.\n        radiation_front_event.direction = -1\n\n        # Initial conditions at s=0\n        y0 = [params[\"T_up\"], params[\"q_up\"]]\n        \n        # Integration domain\n        s_span = [0, params[\"L\"]]\n\n        # Solve the ODE\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=s_span,\n            y0=y0,\n            method='RK45',\n            events=radiation_front_event,\n            dense_output=True\n        )\n\n        # Check if the event was triggered\n        if sol.t_events[0].size  0:\n            s_front = sol.t_events[0][0]\n        else:\n            s_front = -1.0\n            \n        results.append(round(s_front, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}