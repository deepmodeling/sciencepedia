{
    "hands_on_practices": [
        {
            "introduction": "这项首个练习聚焦于辐射幔控制的一个基本方面。我们将使用一个简化的零维模型，来确定为达到目标辐射功率份额所需的杂质浓度。这项实践有助于巩固对等离子体参数、杂质含量和全局功率平衡之间关系的理解。",
            "id": "4037489",
            "problem": "在磁约束聚变等离子体中，会在边界壳层区域建立一个辐射幔，以体积形式重新分配和排出功率。考虑一个稳态、单流体、光学薄的等离子体，其全局功率平衡可表示为 $P_{\\text{in}} = P_{\\text{rad}} + P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}}$，其中 $P_{\\text{in}}$ 是输入到等离子体的总功率，$P_{\\text{rad}}$ 是来自幔区的总辐射功率，$P_{\\text{conduct}} + P_{\\text{convect}}$ 代表非辐射热输运损失，而 $P_{\\text{other}}$ 则计及所有未与幔区辐射重复计算的其余功率汇（例如，芯部核反应损失和非幔区辐射）。辐射幔占据一个体积为 $V_{\\text{m}}$ 的壳层，在此壳层中，电子密度 $n_{e}$ 和单一注入杂质粒子的密度 $n_{z}$ 近似空间均匀。该幔区是光学薄的，并处于电晕平衡状态，因此幔区的辐射功率可以通过体积发射率关系建模\n$$\nP_{\\text{rad}} \\approx \\int_{V_{\\text{m}}} n_{e} n_{z} \\, L_{z}(T) \\, dV \\approx n_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}})\\, V_{\\text{m}},\n$$\n其中 $L_{z}(T)$ 是杂质有效辐射冷却率系数，$T_{\\text{m}}$ 是近似均匀的幔区温度。利用能量守恒和上述发射率模型，推导出一个强制实现指定幔区辐射份额 $f_{\\text{rad}}$ 的条件，该份额定义为 $f_{\\text{rad}} \\equiv P_{\\text{rad}}/P_{\\text{in}}$，然后确定为达到给定的目标 $f_{\\text{rad}}$ 所需的杂质密度 $n_{z}$。\n\n假设对于大环径比托卡马克放电，通过实验推断出以下参数：\n- 总输入功率 $P_{\\text{in}} = 12 \\ \\text{MW}$。\n- 目标幔区辐射份额 $f_{\\text{rad}} = 0.55$。\n- 均匀幔区电子密度 $n_{e} = 4.0 \\times 10^{19} \\ \\text{m}^{-3}$。\n- 幔区体积 $V_{\\text{m}} = 40 \\ \\text{m}^{3}$。\n- 幔区温度下的有效杂质冷却率系数 $L_{z}(T_{\\text{m}}) = 1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}$。\n\n仅从全局稳态功率平衡和基本定义出发。明确陈述用模型中的量表示的、实现指定份额 $f_{\\text{rad}}$ 的推导条件，然后计算满足此条件的所需杂质密度 $n_{z}$。将最终的 $n_{z}$ 以 $\\text{m}^{-3}$ 为单位表示，并将您的答案四舍五入到三位有效数字。",
            "solution": "我们从磁约束等离子体的全局稳态功率平衡开始，\n$$\nP_{\\text{in}} = P_{\\text{rad}} + P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}}.\n$$\n根据定义，目标幔区辐射份额为\n$$\nf_{\\text{rad}} \\equiv \\frac{P_{\\text{rad}}}{P_{\\text{in}}}.\n$$\n为了强制要求总输入功率的指定份额 $f_{\\text{rad}}$ 在幔区辐射掉，其条件是\n$$\nP_{\\text{rad}} = f_{\\text{rad}} \\, P_{\\text{in}}.\n$$\n这与稳态平衡直接一致，因为剩余的损失必须满足 $P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}} = (1 - f_{\\text{rad}}) P_{\\text{in}}$，这是一个推论，而非一个额外的约束。\n\n接下来，我们将幔区辐射功率与局部等离子体参数联系起来。在标准的光学薄、电晕平衡近似下，单一杂质粒子的体积辐射功率密度为 $n_{e} n_{z} L_{z}(T)$，其中 $L_{z}(T)$ 是有效辐射冷却率系数，它包含了该杂质在给定电荷态分布下的线辐射、复合辐射和韧致辐射的贡献。假设 $n_{e}$、$n_{z}$ 和 $T$ 在体积为 $V_{\\text{m}}$ 的幔区壳层内近似均匀，则总幔区辐射功率为\n$$\nP_{\\text{rad}} \\approx n_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}.\n$$\n将此与条件 $P_{\\text{rad}} = f_{\\text{rad}} P_{\\text{in}}$ 结合，得到\n$$\nn_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}} = f_{\\text{rad}} \\, P_{\\text{in}}.\n$$\n求解所需的杂质密度，得到解析表达式\n$$\nn_{z} = \\frac{f_{\\text{rad}} \\, P_{\\text{in}}}{n_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}}.\n$$\n该公式即为在所述假设下，将目标幔区辐射份额与杂质密度联系起来的所求条件。\n\n现在我们代入给定的数值，并保持使用国际单位制：\n- $P_{\\text{in}} = 12 \\ \\text{MW} = 12 \\times 10^{6} \\ \\text{W}$,\n- $f_{\\text{rad}} = 0.55$,\n- $n_{e} = 4.0 \\times 10^{19} \\ \\text{m}^{-3}$,\n- $V_{\\text{m}} = 40 \\ \\text{m}^{3}$,\n- $L_{z}(T_{\\text{m}}) = 1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}$.\n\n计算分母：\n$$\nn_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}} = \\left(4.0 \\times 10^{19} \\ \\text{m}^{-3}\\right)\\left(1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}\\right)\\left(40 \\ \\text{m}^{3}\\right).\n$$\n首先将 $L_{z}(T_{\\text{m}})$ 乘以 $V_{\\text{m}}$：\n$$\n1.2 \\times 10^{-31} \\times 40 = 4.8 \\times 10^{-30} \\ \\text{W} \\, \\text{m}^{3}.\n$$\n然后乘以 $n_{e}$：\n$$\n\\left(4.0 \\times 10^{19}\\right)\\left(4.8 \\times 10^{-30}\\right) = 19.2 \\times 10^{-11} = 1.92 \\times 10^{-10}.\n$$\n因此，\n$$\nn_{z} = \\frac{f_{\\text{rad}} \\, P_{\\text{in}}}{n_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}} = \\frac{0.55 \\times 12 \\times 10^{6}}{1.92 \\times 10^{-10}}.\n$$\n计算分子：\n$$\n0.55 \\times 12 \\times 10^{6} = 6.6 \\times 10^{6}.\n$$\n于是，\n$$\nn_{z} = \\frac{6.6 \\times 10^{6}}{1.92 \\times 10^{-10}} = \\left(\\frac{6.6}{1.92}\\right) \\times 10^{16}.\n$$\n计算比值：\n$$\n\\frac{6.6}{1.92} = 3.4375\\ldots\n$$\n因此，\n$$\nn_{z} = 3.4375 \\times 10^{16} \\ \\text{m}^{-3}.\n$$\n四舍五入到三位有效数字，\n$$\nn_{z} \\approx 3.44 \\times 10^{16} \\ \\text{m}^{-3}.\n$$\n在给定假设下，该值对应的杂质相对于电子的浓度约为 $(3.44 \\times 10^{16})/(4.0 \\times 10^{19}) \\approx 8.6 \\times 10^{-4}$，这在当代装置中注入杂质形成辐射幔的典型操作范围内。所使用的主要假设包括：稳态功率平衡、光学薄辐射、幔区壳层内 $n_{e}$、$n_{z}$ 和 $T$ 的空间均匀性，以及表征电晕平衡中杂质电荷态分布的有效冷却率系数 $L_{z}(T_{\\text{m}})$ 的适用性。",
            "answer": "$$\\boxed{3.44 \\times 10^{16}}$$"
        },
        {
            "introduction": "真实世界的等离子体并非总是光学薄的，特别是对于强的共振谱线。这项练习超越了我们第一个实践中的简化假设，旨在探索光学厚度的影响。通过基于辐射转移方程推导和应用修正，您将学习自吸收如何减少净辐射功率，以及这部分被重吸收的能量必须如何在局部功率平衡中被计入。",
            "id": "4037364",
            "problem": "你正在对磁约束聚变等离子体中辐射带的单一主导谱线贡献进行建模。考虑一个厚度为 $L$ 的均匀平行平面板，它代表了辐射带的一个局部片段。该谱线是频率积分的，并且为了输运目的，在其中心波长处被视为单色光，具有各向同性的发射和吸收。该板具有恒定的单位立体角线发射率 $j_{\\ell}$ 和恒定的线吸收系数 $\\kappa_{\\ell}$。没有外部照明，也没有散射，因此辐射输运方程 (RTE) 以其吸收-发射形式适用。目标是估算当谱线变为边缘光学厚时，对光学薄体积辐射的修正，并提出并计算一个要包含在功率平衡中的重发射项。\n\n仅从以下基本定律和定义出发，推导出评估净体积辐射损失和重发射（沉积）功率所需的关系式：\n- 辐射输运方程 (RTE)：对于路径长度坐标为 $s$、频率为 $\\nu$ 的特定强度为 $I_{\\nu}$ 的射线，RTE为 $\\dfrac{d I_{\\nu}}{d s} = -\\kappa_{\\nu} I_{\\nu} + j_{\\nu}$，其中 $\\kappa_{\\nu}$ 是吸收系数，$j_{\\nu}$ 是单位立体角发射率。\n- 谱线的光学深度：$\\tau_{\\ell} = \\kappa_{\\ell} L$。假设 $j_{\\ell}$ 和 $\\kappa_{\\ell}$ 在谱线上进行了频率积分，并且在整个板内是恒定的。\n- 谱线的源函数：$S_{\\ell} = j_{\\ell} / \\kappa_{\\ell}$。\n- 谱线的光学薄体积功率密度：$Q_{\\text{thin}} = 4\\pi j_{\\ell}$，单位为 $\\text{W}/\\text{m}^{3}$。\n\n在均匀板、各向同性发射和无外部照明的这些假设下，从辐射输运方程推导出净体积线功率密度 $Q_{\\text{net}}$ 作为光学深度 $\\tau_{\\ell}$ 的函数表达式，并将其表示为对 $Q_{\\text{thin}}$ 的乘法修正。从物理上解释未逃逸而被重新吸收和重新发射（沉积）在局部的谱线功率部分，并定义一个可以添加到局部功率平衡中的重发射项 $Q_{\\text{reemit}}$。你必须用 $\\text{W}/\\text{m}^{3}$ 来表示所有结果。\n\n完成推导后，编写一个程序来计算下面每个测试用例的 $Q_{\\text{net}}$ 和 $Q_{\\text{reemit}}$。使用适用于具有各向同性发射的平行平面板的角度积分、频率积分公式。你的数值计算必须在光学薄和光学厚极限下都具有鲁棒性。将每个测试用例的结果表示为一个包含两个浮点数的列表 $[Q_{\\text{net}},Q_{\\text{reemit}}]$。\n\n测试套件（每个元组为 $(j_{\\ell}, \\kappa_{\\ell}, L)$）：\n1. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 10.0\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$，代表一条边缘光学厚谱线，$\\tau_{\\ell} = 1.0$。\n2. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 0.1\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$，代表一条光学薄谱线，$\\tau_{\\ell} = 0.01$。\n3. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 100.0\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$，代表一条光学厚谱线，$\\tau_{\\ell} = 10.0$。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应上述每个测试用例的列表 $[Q_{\\text{net}},Q_{\\text{reemit}}]$。例如，一个有效的输出结构形式为 `[[float,float],[float,float],[float,float]]`。不要打印任何额外的文本。",
            "solution": "该问题具有科学依据，设定良好，客观，并包含获得唯一解所需的所有信息。它基于基本的辐射输运方程及其在简化物理系统中的标准应用，这是计算物理和工程领域进行模型开发的常用方法。参数和背景与指定的计算聚变科学领域相关。因此，该问题被认为是有效的，并将提供解决方案。\n\n主要目标是为均匀的平行平面等离子体板推导净体积辐射功率损失 $Q_{\\text{net}}$ 和相应的重发射（沉积）功率项 $Q_{\\text{reemit}}$ 的表达式。推导从基本的辐射输运方程 (RTE) 开始。\n\n**1. 净体积辐射损失 ($Q_{\\text{net}}$) 的推导**\n\n问题指定了对单条谱线进行频率积分处理。沿射线路径 $s$ 的 RTE 给出为：\n$$\n\\frac{dI}{ds} = -\\kappa_{\\ell} I + j_{\\ell}\n$$\n其中 $I$ 是特定强度，$\\kappa_{\\ell}$ 是恒定的吸收系数，$j_{\\ell}$ 是恒定的单位立体角发射率。\n\n我们考虑一个厚度为 $L$ 的平行平面板。设 $z$ 轴垂直于板，从 $z=0$ 延伸到 $z=L$。路径长度元 $ds$ 与 $dz$ 的关系为 $ds = dz / \\mu$，其中 $\\mu = \\cos\\theta$，$\\theta$ 是射线与 $z$ 轴正向之间的夹角。RTE 变为：\n$$\n\\mu \\frac{dI}{dz} = -\\kappa_{\\ell} I + j_{\\ell}\n$$\n使用光学深度进行处理更为方便，定义为 $d\\tau = \\kappa_{\\ell} dz$。对于恒定的 $\\kappa_{\\ell}$，我们有 $\\tau(z) = \\kappa_{\\ell} z$。板的总光学深度为 $\\tau_{\\ell} = \\kappa_{\\ell} L$。用 $\\tau$ 表示的 RTE 是：\n$$\n\\mu \\frac{dI}{d\\tau} = -I + S_{\\ell}\n$$\n其中 $S_{\\ell} = j_{\\ell} / \\kappa_{\\ell}$ 是源函数，在整个板内是恒定的。\n\n这个一阶线性常微分方程对于强度 $I(\\tau, \\mu)$ 的形式解取决于传播方向。\n\n对于沿 $z$ 轴正向传播的射线 ($\\mu > 0$)，我们从 $\\tau'=0$ 积分到 $\\tau$。边界条件是 $I(0, \\mu) = 0$，因为没有外部照明。解是：\n$$\nI(\\tau, \\mu) = S_{\\ell}(1 - e^{-\\tau/\\mu}) \\quad (\\text{对于 } \\mu > 0)\n$$\n对于沿 $z$ 轴负向传播的射线 ($\\mu  0$)，我们从 $\\tau'=\\tau_{\\ell}$ 积分到 $\\tau$。边界条件是 $I(\\tau_{\\ell}, \\mu) = 0$。解是：\n$$\nI(\\tau, \\mu) = S_{\\ell}(1 - e^{(\\tau_{\\ell}-\\tau)/\\mu}) \\quad (\\text{对于 } \\mu  0)\n$$\n净体积功率密度 $Q_{\\text{net}}$ 是辐射通量矢量散度的板内平均值。对于平行平面几何，这简化为离开板的净通量除以板的厚度：\n$$\nQ_{\\text{net}} = \\frac{F(L) - F(0)}{L}\n$$\n其中 $F(z)$ 是位置 $z$ 处的辐射通量。通量定义为强度的法向分量在所有立体角上的积分：\n$$\nF(z) = \\int_{4\\pi} I(z, \\mu) \\mu d\\Omega = 2\\pi \\int_{-1}^{1} I(\\tau(z), \\mu) \\mu d\\mu\n$$\n我们计算边界处的通量。在顶部边界，$z=L$ (或 $\\tau=\\tau_{\\ell}$):\n$$\nF(L) = 2\\pi \\int_{-1}^{1} I(\\tau_{\\ell}, \\mu) \\mu d\\mu = 2\\pi \\left[ \\int_{0}^{1} S_{\\ell}(1 - e^{-\\tau_{\\ell}/\\mu})\\mu d\\mu + \\int_{-1}^{0} S_{\\ell}(1 - e^{0})\\mu d\\mu \\right]\n$$\n第二个积分为零。因此：\n$$\nF(L) = 2\\pi S_{\\ell} \\int_{0}^{1} (1 - e^{-\\tau_{\\ell}/\\mu})\\mu d\\mu\n$$\n在底部边界，$z=0$ (或 $\\tau=0$)，由于问题的对称性和上下方向的定义，$F(0) = -F(L)$。因此，离开板的净功率为 $F(L) - F(0) = 2F(L)$。\n\n净体积功率密度为：\n$$\nQ_{\\text{net}} = \\frac{2 F(L)}{L} = \\frac{4\\pi S_{\\ell}}{L} \\int_{0}^{1} (\\mu - \\mu e^{-\\tau_{\\ell}/\\mu}) d\\mu\n$$\n该积分可以计算为：\n$$\n\\int_{0}^{1} \\mu d\\mu - \\int_{0}^{1} \\mu e^{-\\tau_{\\ell}/\\mu} d\\mu = \\frac{1}{2} - E_3(\\tau_{\\ell})\n$$\n其中 $E_n(x) = \\int_{1}^{\\infty} t^{-n}e^{-xt} dt = \\int_{0}^{1} u^{n-2}e^{-x/u} du$ 是 $n$ 阶指数积分函数。\n\n代入这个结果以及定义 $S_{\\ell} = j_{\\ell}/\\kappa_{\\ell}$ 和 $L = \\tau_{\\ell}/\\kappa_{\\ell}$：\n$$\nQ_{\\text{net}} = \\frac{4\\pi (j_{\\ell}/\\kappa_{\\ell})}{(\\tau_{\\ell}/\\kappa_{\\ell})} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right) = \\frac{4\\pi j_{\\ell}}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\n$$\n光学薄体积功率密度是 $Q_{\\text{thin}} = 4\\pi j_{\\ell}$。我们可以将 $Q_{\\text{net}}$ 表示为对 $Q_{\\text{thin}}$ 的修正：\n$$\nQ_{\\text{net}} = Q_{\\text{thin}} \\cdot P(\\tau_{\\ell})\n$$\n其中 $P(\\tau_{\\ell})$ 是均匀、各向同性发射板的逃逸概率：\n$$\nP(\\tau_{\\ell}) = \\frac{1}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\n$$\n\n**2. 重发射功率项 ($Q_{\\text{reemit}}$) 的推导**\n\n在板内每单位体积产生的总功率是 $Q_{\\text{thin}} = 4\\pi j_{\\ell}$。逃离板的每单位体积净功率是 $Q_{\\text{net}}$。这两个量之间的差值代表了在板内产生但在逃逸前被重新吸收的功率。这部分被重新吸收的能量作为热能局部沉积，在等离子体的功率平衡中作为一个加热项。我们将这个沉积的功率定义为重发射项 $Q_{\\text{reemit}}$。\n\n根据体积内辐射场的能量守恒原理：\n$$\n\\text{总发射功率} = \\text{净逃逸功率} + \\text{沉积功率}\n$$\n$$\nQ_{\\text{thin}} = Q_{\\text{net}} + Q_{\\text{reemit}}\n$$\n因此，重发射项是：\n$$\nQ_{\\text{reemit}} = Q_{\\text{thin}} - Q_{\\text{net}} = Q_{\\text{thin}} \\cdot (1 - P(\\tau_{\\ell}))\n$$\n$$\nQ_{\\text{reemit}} = 4\\pi j_{\\ell} \\left(1 - \\frac{1}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\\right)\n$$\n这些关于 $Q_{\\text{net}}$ 和 $Q_{\\text{reemit}}$ 的表达式对于任何光学深度 $\\tau_{\\ell} \\geq 0$ 都有效。\n\n**3. 用于实现的公式总结**\n\n对于由 $(j_{\\ell}, \\kappa_{\\ell}, L)$ 定义的每个测试用例：\n1. 计算光学深度：$\\tau_{\\ell} = \\kappa_{\\ell} L$。\n2. 计算光学薄功率密度：$Q_{\\text{thin}} = 4\\pi j_{\\ell}$。\n3. 计算三阶指数积分 $E_3(\\tau_{\\ell})$。\n4. 计算逃逸概率：$P(\\tau_{\\ell}) = \\frac{1}{\\tau_{\\ell}} (\\frac{1}{2} - E_3(\\tau_{\\ell}))$。对于边缘情况 $\\tau_{\\ell} \\to 0$，$P(\\tau_{\\ell}) \\to 1$。\n5. 计算净体积功率损失：$Q_{\\text{net}} = Q_{\\text{thin}} \\cdot P(\\tau_{\\ell})$。\n6. 计算重发射（沉积）功率：$Q_{\\text{reemit}} = Q_{\\text{thin}} - Q_{\\text{net}}$。\n数值实现将使用 `scipy.special.expn` 来计算 $E_n(x)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\n\ndef solve():\n    \"\"\"\n    Calculates the net volumetric radiative loss (Q_net) and the re-emitted\n    (deposited) power density (Q_reemit) for a uniform plane-parallel slab.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (j_l [W m^-3 sr^-1], kappa_l [m^-1], L [m])\n    test_cases = [\n        (5.0e3, 10.0, 0.1),\n        (5.0e3, 0.1, 0.1),\n        (5.0e3, 100.0, 0.1),\n    ]\n\n    results = []\n    for j_l, kappa_l, L in test_cases:\n        # Calculate optical depth for the line\n        tau_l = kappa_l * L\n        \n        # Calculate the optically thin volumetric power density\n        Q_thin = 4.0 * np.pi * j_l\n        \n        # Handle the optically thin limit to avoid division by zero,\n        # although the provided test cases have tau_l > 0.\n        if np.isclose(tau_l, 0.0):\n            # In the limit tau - 0, P(tau) - 1\n            escape_probability = 1.0\n        else:\n            # Evaluate the third exponential integral E_3(tau_l)\n            E3_tau = expn(3, tau_l)\n            \n            # Calculate the escape probability for a uniform slab\n            # P(tau) = (1/tau) * (1/2 - E_3(tau))\n            escape_probability = (0.5 - E3_tau) / tau_l\n\n        # Calculate the net volumetric radiative loss\n        Q_net = Q_thin * escape_probability\n        \n        # Calculate the re-emitted (deposited) power density\n        # This is the power generated but not escaped.\n        Q_reemit = Q_thin - Q_net\n        \n        # Append the results for the current case\n        results.append([Q_net, Q_reemit])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list is already in the format '[item1, item2]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "设计辐射幔需要在相互竞争的目标之间取得平衡：既要最大化热量排出，又要最小化对核心聚变性能的负面影响。这最后一项实践将您置于反应堆设计者的角色，要求您评估不同杂质选择在辐射功率份额和核心燃料稀释之间的权衡。通过计算帕累托前沿，您将定量地描绘出最优性能空间，并学会识别最佳的运行折衷点。",
            "id": "4037485",
            "problem": "你需要在一个简化的磁约束聚变等离子体辐射幔模型中，计算辐射功率份额和芯部燃料稀释之间的权衡关系。该场景设定在计算聚变科学与工程领域的高级研究生水平，并且必须从科学上可靠的第一性原理推导得出。\n\n考虑一个环形等离子体，其辐射幔区域的体积为 $V_{\\mathrm{m}}$，幔区中的近似电子密度为 $n_{\\mathrm{e,m}}$。当没有杂质存在时，通过平行于磁力线到偏滤器靶板腿的热传导，建立了基准幔区电子温度 $T_{0}$。外部供给等离子体的总加热功率 $P_{\\mathrm{heat}}$ 穿过分界面，一部分由幔区中的平行电子热传导携带，另一部分由注入杂质的辐射携带。\n\n使用从 Spitzer-Härm 平行电子传导标度律推导出的传导-辐射关系来为幔区功率平衡建模。假设平行传导功率的标度关系为 $P_{\\mathrm{cond}}(T)=K\\,T^{5/2}$，其中 $K$ 是一个常数，由无杂质情况下的边界条件 $P_{\\mathrm{cond}}(T_{0})=P_{\\mathrm{heat}}$ 确定。在日冕平衡下，来自杂质种类 $Z$ 的幔区辐射功率模型为 $P_{\\mathrm{rad}}(T,f_{Z})=n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T)\\,V_{\\mathrm{m}}$，其中 $f_{Z}$ 是杂质分数丰度，定义为 $f_{Z}=n_{Z}/n_{\\mathrm{e,m}}$，而 $\\Lambda_{Z}(T)$ 是特定种类的辐射冷却函数。辐射冷却函数用一个对数正态峰来近似：\n$$\n\\Lambda_{Z}(T)=S_{Z}\\,\\exp\\!\\left(-\\frac{(\\ln T-\\ln T_{\\mathrm{p},Z})^{2}}{2\\,\\sigma_{Z}^{2}}\\right),\n$$\n其中 $S_{Z}$ 是依赖于种类的振幅，单位为 $\\mathrm{W}\\,\\mathrm{m}^{3}$，$T_{\\mathrm{p},Z}$ 是峰值温度，单位为 $\\mathrm{eV}$，$\\sigma_{Z}$ 是对数宽度。\n\n对于给定的 $f_{Z}$，幔区温度 $T_{\\mathrm{m}}$ 由稳态功率平衡决定：\n$$\nP_{\\mathrm{cond}}(T_{\\mathrm{m}})+P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})=P_{\\mathrm{heat}},\n$$\n即，\n$$\nK\\,T_{\\mathrm{m}}^{5/2}+n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T_{\\mathrm{m}})\\,V_{\\mathrm{m}}=P_{\\mathrm{heat}}.\n$$\n根据解出的 $T_{\\mathrm{m}}$，将辐射功率份额定义为\n$$\nf_{\\mathrm{rad}}=\\frac{P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})}{P_{\\mathrm{heat}}}.\n$$\n\n芯部燃料稀释是使用芯部的准中性条件估算的，其中芯部电子密度 $n_{\\mathrm{e,c}}$ 固定，并采用一个适用于芯部高温的单一有效杂质电荷态 $Z_{\\mathrm{imp,c}}$。对于电荷为 $+1$ 的氘-氚燃料离子，芯部燃料离子密度降低为 $n_{\\mathrm{fuel,c}}=n_{\\mathrm{e,c}}-Z_{\\mathrm{imp,c}}\\,n_{\\mathrm{imp,c}}$。在一个简化的假设下，即杂质分数丰度在径向上是均匀的，并且等于幔区分数 $f_{Z}$，无量纲的芯部稀释分数为\n$$\n\\delta=\\frac{n_{\\mathrm{fuel,c},0}-n_{\\mathrm{fuel,c}}}{n_{\\mathrm{fuel,c},0}}=Z_{\\mathrm{imp,c}}\\,f_{Z},\n$$\n其中 $n_{\\mathrm{fuel,c},0}=n_{\\mathrm{e,c}}$ 是未稀释的芯部燃料密度。\n\n你的任务是，对于两种杂质，在一组离散的杂质分数丰度 $f_{Z}$ 上，计算最大化 $f_{\\mathrm{rad}}$ 和最小化 $\\delta$ 之间的帕累托前沿。如果不存在任何其他采样点，其 $f_{\\mathrm{rad}}$ 大于或等于且 $\\delta$ 小于或等于，并且至少有一个严格不等式成立，则点 $\\left(\\delta,f_{\\mathrm{rad}}\\right)$ 是帕累托最优的。此外，在每个种类的帕累托前沿上，将最大化比率 $f_{\\mathrm{rad}}/(\\delta+\\varepsilon)$ 的点确定为唯一的“拐点”，其中 $\\varepsilon$ 是一个小的正数，以避免除以零。\n\n使用以下科学上合理的参数和单位：\n- $P_{\\mathrm{heat}}=5\\times 10^{7}\\ \\mathrm{W}$。\n- $T_{0}=180\\ \\mathrm{eV}$。\n- $n_{\\mathrm{e,m}}=2\\times 10^{19}\\ \\mathrm{m}^{-3}$。\n- $V_{\\mathrm{m}}=30\\ \\mathrm{m}^{3}$。\n- $K=P_{\\mathrm{heat}}/T_{0}^{5/2}$，确保 $P_{\\mathrm{cond}}(T_{0})=P_{\\mathrm{heat}}$。\n- 对于氖（$\\mathrm{Ne}$）：$S_{Z}=2\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$，$T_{\\mathrm{p},Z}=120\\ \\mathrm{eV}$，$\\sigma_{Z}=0.5$，$Z_{\\mathrm{imp,c}}=10$，以及 $f_{Z}\\in\\{0,2\\times 10^{-4},5\\times 10^{-4},10^{-3},2\\times 10^{-3},4\\times 10^{-3},8\\times 10^{-3}\\}$。\n- 对于氩（$\\mathrm{Ar}$）：$S_{Z}=6\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$，$T_{\\mathrm{p},Z}=180\\ \\mathrm{eV}$，$\\sigma_{Z}=0.5$，$Z_{\\mathrm{imp,c}}=18$，以及 $f_{Z}\\in\\{0,10^{-4},3\\times 10^{-4},8\\times 10^{-4},1.5\\times 10^{-3},3\\times 10^{-3},6\\times 10^{-3},10^{-2}\\}$。\n\n计算要求：\n- 对于每种杂质及其集合中的每个 $f_{Z}$，求解满足功率平衡的 $T_{\\mathrm{m}}$（单位为 $\\mathrm{eV}$）。在区间 $[10^{-3}\\ \\mathrm{eV},T_{0}]$ 上使用稳健的标量求根方法来寻找 $T_{\\mathrm{m}}$。\n- 为每个采样的 $f_{Z}$ 计算 $f_{\\mathrm{rad}}$ 和 $\\delta$。\n- 提取目标对 $\\left(-f_{\\mathrm{rad}},\\delta\\right)$ 的离散帕累托前沿（等同于最大化 $f_{\\mathrm{rad}}$ 和最小化 $\\delta$）。\n- 在每个前沿上，选择使 $f_{\\mathrm{rad}}/(\\delta+\\varepsilon)$（其中 $\\varepsilon=10^{-12}$）最大化的点作为拐点，并报告其 $\\left(f_{\\mathrm{rad}},\\delta\\right)$ 坐标。\n\n测试套件和最终输出：\n- 上述两种杂质及其参数集构成了测试套件。这些案例探究了低注入极限（包括 $f_{Z}=0$）、中间区域以及辐射饱和且额外稀释带来的辐射收益递减的高注入边界情况。\n- 你的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。该列表必须是 $\\left[N_{\\mathrm{Ne}},f_{\\mathrm{rad},\\mathrm{knee},\\mathrm{Ne}},\\delta_{\\mathrm{knee},\\mathrm{Ne}},N_{\\mathrm{Ar}},f_{\\mathrm{rad},\\mathrm{knee},\\mathrm{Ar}},\\delta_{\\mathrm{knee},\\mathrm{Ar}}\\right]$，其中 $N_{\\mathrm{Ne}}$ 和 $N_{\\mathrm{Ar}}$ 是给出氖和氩的帕累托最优点数量的整数，拐点坐标是浮点数。所有输出都表示为无量纲数（无物理单位），其中 $f_{\\mathrm{rad}}$ 和 $\\delta$ 为小数。",
            "solution": "用户的请求是在一个简化的聚变等离子体幔模型中，分析辐射功率和燃料稀释之间的权衡关系。这涉及到求解一个非线性功率平衡方程，生成性能指标，并应用多目标优化概念来确定最佳工作点。\n\n### 问题验证\n\n1.  **提取已知条件**：\n    -   等离子体模型：具有辐射幔体积 $V_{\\mathrm{m}}$、电子密度 $n_{\\mathrm{e,m}}$ 和基准温度 $T_{0}$ 的环形等离子体。\n    -   加热功率：$P_{\\mathrm{heat}}$。\n    -   功率平衡方程：$P_{\\mathrm{cond}}(T_{\\mathrm{m}})+P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})=P_{\\mathrm{heat}}$。\n    -   传导模型：$P_{\\mathrm{cond}}(T)=K\\,T^{5/2}$，其中 $K=P_{\\mathrm{heat}}/T_{0}^{5/2}$。\n    -   辐射模型：$P_{\\mathrm{rad}}(T,f_{Z})=n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T)\\,V_{\\mathrm{m}}$。\n    -   辐射冷却函数：$\\Lambda_{Z}(T)=S_{Z}\\,\\exp\\!\\left(-\\frac{(\\ln T-\\ln T_{\\mathrm{p},Z})^{2}}{2\\,\\sigma_{Z}^{2}}\\right)$。\n    -   辐射功率份额：$f_{\\mathrm{rad}}=P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})/P_{\\mathrm{heat}}$。\n    -   芯部燃料稀释分数：$\\delta=Z_{\\mathrm{imp,c}}\\,f_{Z}$。\n    -   优化目标：最大化 $f_{\\mathrm{rad}}$ 和最小化 $\\delta$。\n    -   帕累托前沿定义：如果不存在其他点在两个目标上都更好或相等，且至少在一个目标上严格更优，则该点 $(\\delta,f_{\\mathrm{rad}})$ 是最优的。\n    -   拐点定义：最大化比率 $f_{\\mathrm{rad}}/(\\delta+\\varepsilon)$ 的帕累托最优点，其中 $\\varepsilon=10^{-12}$。\n    -   计算任务：在区间 $[10^{-3}\\,\\mathrm{eV},T_{0}]$ 内求解幔区温度 $T_{\\mathrm{m}}$。\n    -   常量：\n        -   $P_{\\mathrm{heat}}=5\\times 10^{7}\\ \\mathrm{W}$。\n        -   $T_{0}=180\\ \\mathrm{eV}$。\n        -   $n_{\\mathrm{e,m}}=2\\times 10^{19}\\ \\mathrm{m}^{-3}$。\n        -   $V_{\\mathrm{m}}=30\\ \\mathrm{m}^{3}$。\n    -   氖（$\\mathrm{Ne}$）参数：\n        -   $S_{Z}=2\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$，$T_{\\mathrm{p},Z}=120\\ \\mathrm{eV}$，$\\sigma_{Z}=0.5$，$Z_{\\mathrm{imp,c}}=10$。\n        -   $f_{Z}\\in\\{0,2\\times 10^{-4},5\\times 10^{-4},10^{-3},2\\times 10^{-3},4\\times 10^{-3},8\\times 10^{-3}\\}$。\n    -   氩（$\\mathrm{Ar}$）参数：\n        -   $S_{Z}=6\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$，$T_{\\mathrm{p},Z}=180\\ \\mathrm{eV}$，$\\sigma_{Z}=0.5$，$Z_{\\mathrm{imp,c}}=18$。\n        -   $f_{Z}\\in\\{0,10^{-4},3\\times 10^{-4},8\\times 10^{-4},1.5\\times 10^{-3},3\\times 10^{-3},6\\times 10^{-3},10^{-2}\\}$。\n\n2.  **验证检查**：\n    -   **科学依据**：该问题基于已建立的等离子体物理学原理。Spitzer-Härm 传导定律 ($P_{\\mathrm{cond}} \\propto T^{5/2}$)、杂质辐射功率公式 ($P_{\\mathrm{rad}} \\propto n_e n_Z \\Lambda_Z(T)$) 以及基于准中性的燃料稀释模型都是标准的且公式正确。参数值对于托卡马克是物理上现实的。\n    -   **适定性**：该问题在数学上是明确定义的。核心任务是求解超越方程 $K\\,T_{\\mathrm{m}}^{5/2}+n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T_{\\mathrm{m}})\\,V_{\\mathrm{m}}-P_{\\mathrm{heat}}=0$ 的根。该函数是连续的，当 $T \\to 0$ 时其值为负，在 $T=T_0$ 时为非负，根据介值定理，这保证了在指定区间 $[10^{-3}\\,\\mathrm{eV}, T_0]$ 内至少存在一个根。该问题要求使用稳健的数值求解器，恰当地考虑了非线性。帕累托前沿和拐点的定义是精确的，并允许唯一解。\n    -   **客观性**：问题陈述纯粹是定量的和客观的，没有主观或含糊的语言。所有术语都得到了清晰的定义。\n\n3.  **结论**：该问题是**有效的**。它是一个独立的、科学上可靠且适定的计算物理问题。将提供一个解决方案。\n\n### 基于原理的解决方案设计\n\n解决方案首先实现物理模型，然后使用该模型生成一组性能数据，最后将多目标优化概念应用于此数据集。\n\n**1. 物理和数学模型实现**\n\n问题的基础是等离子体幔中的稳态功率平衡：\n$$\nP_{\\mathrm{heat}} = P_{\\mathrm{cond}}(T_{\\mathrm{m}}) + P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_{Z})\n$$\n其中，对于给定的杂质分数 $f_{Z}$， $T_{\\mathrm{m}}$ 是最终的幔区温度。代入传导和辐射的具体模型，得到需求解 $T_{\\mathrm{m}}$ 的方程：\n$$\nP_{\\mathrm{heat}} = \\left(\\frac{P_{\\mathrm{heat}}}{T_{0}^{5/2}}\\right)T_{\\mathrm{m}}^{5/2} + n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,V_{\\mathrm{m}}\\,S_{Z}\\,\\exp\\!\\left(-\\frac{(\\ln T_{\\mathrm{m}}-\\ln T_{\\mathrm{p},Z})^{2}}{2\\,\\sigma_{Z}^{2}}\\right)\n$$\n这是一个关于 $T_{\\mathrm{m}}$ 的非线性超越方程。我们定义一个函数 $g(T, f_Z)$ 表示功率平衡的残差：\n$$\ng(T, f_Z) = \\left(\\frac{P_{\\mathrm{heat}}}{T_{0}^{5/2}}\\right)T^{5/2} + n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,V_{\\mathrm{m}}\\,\\Lambda_{Z}(T) - P_{\\mathrm{heat}}\n$$\n对于每个指定的杂质分数 $f_{Z}$，我们必须在区间 $[10^{-3}\\,\\mathrm{eV}, T_{0}]$ 内找到根 $T_{\\mathrm{m}}$，使得 $g(T_{\\mathrm{m}}, f_Z) = 0$。像 Brent-Dekker 方法（在 SciPy 中为 `brentq`）这样的稳健区间求根器适合此任务。\n\n一旦确定了 $T_{\\mathrm{m}}$，就可以计算两个品质因数：辐射功率份额 ($f_{\\mathrm{rad}}$) 和芯部燃料稀释 ($\\delta$)。从功率平衡方程可知，传导功率为 $P_{\\mathrm{cond}}(T_{\\mathrm{m}}) = P_{\\mathrm{heat}} - P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_Z)$。因此，$f_{\\mathrm{rad}}$ 可以无需重新计算辐射项而表示出来：\n$$\nf_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_Z)}{P_{\\mathrm{heat}}} = 1 - \\frac{P_{\\mathrm{cond}}(T_{\\mathrm{m}})}{P_{\\mathrm{heat}}} = 1 - \\frac{K\\,T_{\\mathrm{m}}^{5/2}}{K\\,T_{0}^{5/2}} = 1 - \\left(\\frac{T_{\\mathrm{m}}}{T_{0}}\\right)^{5/2}\n$$\n芯部燃料稀释由线性关系给出：\n$$\n\\delta = Z_{\\mathrm{imp,c}} \\, f_{Z}\n$$\n\n**2. 多目标分析**\n\n对于给定杂质的每个给定 $f_Z$ 值，重复此过程，生成一组 $(\\delta, f_{\\mathrm{rad}})$ 对。这些对代表了可实现的性能点。\n\n**a. 帕累托前沿识别**\n目标是最大化 $f_{\\mathrm{rad}}$ 和最小化 $\\delta$。如果不存在其他点 $(d_j, r_j)$ 使得 $r_j \\geq r_i$ 和 $d_j \\leq d_i$（其中至少一个不等式是严格的），则点 $(d_i, r_i)$ 位于帕累托前沿上。识别此离散前沿的算法如下：\n1.  按 $\\delta$ 的升序对计算出的 $(\\delta, f_{\\mathrm{rad}})$ 点进行排序。\n2.  初始化一个空的帕累托前沿列表，并将变量 `max_f_rad_seen` 设置为低于任何可能 $f_{\\mathrm{rad}}$ 的值（例如 `-1.0`）。\n3.  遍历排序后的点。对于每个点 $(d_i, r_i)$，如果其辐射分数 $r_i$ 严格大于 `max_f_rad_seen`，则该点不受任何先前点（所有这些点都具有更小或相等的 $\\delta$）的支配。将其添加到帕累托前沿并更新 `max_f_rad_seen = r_i`。\n4.  最终列表包含所有帕累托最优点。这些点的数量为 $N$。\n\n**b. 拐点选择**\n拐点是前沿上的“最佳折衷”。通过在已识别的帕累托前沿上的所有点中最大化效用函数 $U = f_{\\mathrm{rad}} / (\\delta + \\varepsilon)$ 来找到它。小常数 $\\varepsilon = 10^{-12}$ 确保对于点 $(\\delta=0, f_{\\mathrm{rad}}=0)$ 该表达式是明确定义的。我们为每个帕累托最优点计算此比率，并选择产生最大值的点。\n\n整个过程对氖和氩的参数集独立执行。最终输出汇总了两种杂质的帕累托点数和拐点坐标。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Pareto front and knee point for mantle radiation vs. core dilution\n    for Neon and Argon impurities in a simplified fusion plasma model.\n    \"\"\"\n\n    # Define the common physical parameters\n    P_heat = 5.0e7  # Total heating power in W\n    T0 = 180.0      # Baseline mantle temperature in eV\n    ne_m = 2.0e19   # Mantle electron density in m^-3\n    V_m = 30.0      # Mantle volume in m^3\n    epsilon = 1e-12 # Small constant for knee point calculation\n\n    # Define the species-specific parameters in test cases\n    test_cases = [\n        {\n            \"species\": \"Ne\",\n            \"S_Z\": 2.0e-31,      # Radiation amplitude in W m^3\n            \"Tp_Z\": 120.0,       # Peak radiation temperature in eV\n            \"sigma_Z\": 0.5,      # Logarithmic width of radiation peak\n            \"Z_impc\": 10.0,      # Effective core charge state\n            \"f_Z_values\": [0, 2e-4, 5e-4, 1e-3, 2e-3, 4e-3, 8e-3],\n        },\n        {\n            \"species\": \"Ar\",\n            \"S_Z\": 6.0e-31,\n            \"Tp_Z\": 180.0,\n            \"sigma_Z\": 0.5,\n            \"Z_impc\": 18.0,\n            \"f_Z_values\": [0, 1e-4, 3e-4, 8e-4, 1.5e-3, 3e-3, 6e-3, 1e-2],\n        },\n    ]\n\n    final_results = []\n    for params in test_cases:\n        \n        # Calculate the conduction constant K\n        K = P_heat / (T0**2.5)\n\n        def lambda_Z(T, S_Z, Tp_Z, sigma_Z):\n            \"\"\"Calculates the radiative cooling function Lambda_Z(T).\"\"\"\n            if T = 0: return 0.0\n            ln_T = np.log(T)\n            ln_Tp = np.log(Tp_Z)\n            return S_Z * np.exp(-(ln_T - ln_Tp)**2 / (2 * sigma_Z**2))\n\n        def power_balance_residual(T, f_Z, S_Z, Tp_Z, sigma_Z):\n            \"\"\"\n            Calculates the residual of the power balance equation.\n            g(T) = P_cond(T) + P_rad(T) - P_heat\n            We want to find T such that g(T) = 0.\n            \"\"\"\n            P_cond = K * (T**2.5)\n            P_rad = ne_m**2 * f_Z * lambda_Z(T, S_Z, Tp_Z, sigma_Z) * V_m\n            return P_cond + P_rad - P_heat\n        \n        # Store (delta, f_rad) pairs\n        performance_points = []\n\n        for f_Z in params[\"f_Z_values\"]:\n            delta = params[\"Z_impc\"] * f_Z\n            \n            # Solve for mantle temperature Tm\n            if f_Z == 0:\n                # No radiation, so P_cond = P_heat, which implies Tm = T0\n                Tm = T0\n            else:\n                # Use a robust root finder to solve the power balance equation\n                try:\n                    Tm = brentq(\n                        lambda T: power_balance_residual(\n                            T, f_Z, params[\"S_Z\"], params[\"Tp_Z\"], params[\"sigma_Z\"]\n                        ),\n                        1e-3, # Lower bound for temperature search\n                        T0,   # Upper bound for temperature search\n                    )\n                except ValueError:\n                    # If brentq fails (e.g., endpoints have same sign), handle it\n                    # This might happen if radiation is extremely high, pushing the\n                    # solution to very low T. For this problem setup, it's unlikely.\n                    # We can assume the solution is at the lower bound if a root isn't found.\n                    Tm = 1e-3\n\n            # Calculate radiated power fraction f_rad\n            # f_rad = 1 - P_cond(Tm)/P_heat = 1 - (K*Tm^2.5)/(K*T0^2.5)\n            f_rad = 1.0 - (Tm / T0)**2.5\n\n            performance_points.append({\"delta\": delta, \"f_rad\": f_rad})\n\n        # Identify the Pareto front\n        # The points are already sorted by delta due to the order of f_Z_values\n        pareto_front = []\n        max_f_rad_so_far = -1.0\n        for point in performance_points:\n            # A point is on the front if its f_rad is higher than any point with a smaller delta\n            if point['f_rad']  max_f_rad_so_far:\n                pareto_front.append(point)\n                max_f_rad_so_far = point['f_rad']\n        \n        num_pareto_points = len(pareto_front)\n        \n        # Find the knee point on the Pareto front\n        best_ratio = -1.0\n        knee_point = None\n        for point in pareto_front:\n            ratio = point['f_rad'] / (point['delta'] + epsilon)\n            if ratio  best_ratio:\n                best_ratio = ratio\n                knee_point = point\n        \n        # Append results for this species to the final list\n        final_results.extend([num_pareto_points, knee_point['f_rad'], knee_point['delta']])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}