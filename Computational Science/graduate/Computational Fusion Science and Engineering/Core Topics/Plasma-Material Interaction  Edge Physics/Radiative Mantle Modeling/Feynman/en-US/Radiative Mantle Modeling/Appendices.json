{
    "hands_on_practices": [
        {
            "introduction": "A primary goal in radiative mantle control is to exhaust a specific fraction of the plasma's heating power through radiation. This foundational exercise establishes the direct relationship between the desired radiated power fraction, $f_{\\text{rad}}$, and the required concentration of a seeded impurity, $n_z$. By working through this problem, you will apply the global power balance and a simplified, optically thin radiation model to determine the necessary impurity density to achieve a target operational state .",
            "id": "4037489",
            "problem": "In a magnetically confined fusion plasma, a radiative mantle is established in an edge shell region to redistribute and exhaust power volumetrically. Consider a steady-state, single-fluid, optically thin plasma in which the global power balance reads $P_{\\text{in}} = P_{\\text{rad}} + P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}}$, where $P_{\\text{in}}$ is the total input power to the plasma, $P_{\\text{rad}}$ is the total radiated power from the mantle region, $P_{\\text{conduct}} + P_{\\text{convect}}$ represents non-radiative thermal transport losses, and $P_{\\text{other}}$ accounts for all remaining sinks not double-counted with the mantle radiation (for example, core nuclear reaction losses and non-mantle radiation). The radiative mantle occupies a shell of volume $V_{\\text{m}}$, and in this shell the electron density $n_{e}$ and the density $n_{z}$ of a single seeded impurity species are approximately spatially uniform. The mantle is optically thin and in coronal equilibrium so that the mantle radiated power can be modeled by the volumetric emissivity relation\n$$\nP_{\\text{rad}} \\approx \\int_{V_{\\text{m}}} n_{e} n_{z} \\, L_{z}(T) \\, dV \\approx n_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}})\\, V_{\\text{m}},\n$$\nwhere $L_{z}(T)$ is the impurity effective radiative cooling rate coefficient and $T_{\\text{m}}$ is the approximately uniform mantle temperature. Using conservation of energy and the above emissivity model, derive the condition that enforces a specified mantle radiation fraction $f_{\\text{rad}}$ of the total input power, defined by $f_{\\text{rad}} \\equiv P_{\\text{rad}}/P_{\\text{in}}$, and then determine the impurity density $n_{z}$ required to achieve a given target $f_{\\text{rad}}$.\n\nAssume the following experimentally inferred parameters for a large-aspect-ratio tokamak discharge:\n- Total input power $P_{\\text{in}} = 12 \\ \\text{MW}$.\n- Target mantle radiation fraction $f_{\\text{rad}} = 0.55$.\n- Uniform mantle electron density $n_{e} = 4.0 \\times 10^{19} \\ \\text{m}^{-3}$.\n- Mantle volume $V_{\\text{m}} = 40 \\ \\text{m}^{3}$.\n- Effective impurity cooling rate coefficient at the mantle temperature $L_{z}(T_{\\text{m}}) = 1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}$.\n\nStart from the global steady-state power balance and basic definitions only. Clearly state the derived condition that implements the specified fraction $f_{\\text{rad}}$ in terms of the quantities in the model and then compute the required impurity density $n_{z}$ that satisfies this condition. Express the final $n_{z}$ in $\\text{m}^{-3}$ and round your answer to three significant figures.",
            "solution": "We begin from the global, steady-state power balance for a magnetically confined plasma,\n$$\nP_{\\text{in}} = P_{\\text{rad}} + P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}}.\n$$\nBy definition, the target mantle radiation fraction is\n$$\nf_{\\text{rad}} \\equiv \\frac{P_{\\text{rad}}}{P_{\\text{in}}}.\n$$\nTo enforce that a specified fraction $f_{\\text{rad}}$ of the total input power is radiated in the mantle, the condition is\n$$\nP_{\\text{rad}} = f_{\\text{rad}} \\, P_{\\text{in}}.\n$$\nThis is directly consistent with the steady-state balance, since the remaining losses must then satisfy $P_{\\text{conduct}} + P_{\\text{convect}} + P_{\\text{other}} = (1 - f_{\\text{rad}}) P_{\\text{in}}$, which is a consequence rather than an additional constraint.\n\nNext, we relate the mantle radiated power to local plasma parameters. Under the standard optically thin, coronal equilibrium approximation, the volumetric radiated power density for a single impurity species is $n_{e} n_{z} L_{z}(T)$, where $L_{z}(T)$ is the effective radiative cooling rate coefficient that encapsulates line radiation, recombination radiation, and bremsstrahlung contributions for the impurity in the given charge state distribution. Assuming $n_{e}$, $n_{z}$, and $T$ are approximately uniform across the mantle shell with volume $V_{\\text{m}}$, the total mantle radiated power is\n$$\nP_{\\text{rad}} \\approx n_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}.\n$$\nCombining this with the condition $P_{\\text{rad}} = f_{\\text{rad}} P_{\\text{in}}$ yields\n$$\nn_{e} \\, n_{z} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}} = f_{\\text{rad}} \\, P_{\\text{in}}.\n$$\nSolving for the required impurity density gives the analytic expression\n$$\nn_{z} = \\frac{f_{\\text{rad}} \\, P_{\\text{in}}}{n_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}}.\n$$\nThis formula is the sought condition linking the target mantle radiation fraction to the impurity density under the stated assumptions.\n\nWe now insert the given numerical values, keeping to the International System of Units:\n- $P_{\\text{in}} = 12 \\ \\text{MW} = 12 \\times 10^{6} \\ \\text{W}$,\n- $f_{\\text{rad}} = 0.55$,\n- $n_{e} = 4.0 \\times 10^{19} \\ \\text{m}^{-3}$,\n- $V_{\\text{m}} = 40 \\ \\text{m}^{3}$,\n- $L_{z}(T_{\\text{m}}) = 1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}$.\n\nCompute the denominator:\n$$\nn_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}} = \\left(4.0 \\times 10^{19} \\ \\text{m}^{-3}\\right)\\left(1.2 \\times 10^{-31} \\ \\text{W} \\, \\text{m}^{3}\\right)\\left(40 \\ \\text{m}^{3}\\right).\n$$\nFirst multiply $L_{z}(T_{\\text{m}})$ by $V_{\\text{m}}$:\n$$\n1.2 \\times 10^{-31} \\times 40 = 4.8 \\times 10^{-30} \\ \\text{W} \\, \\text{m}^{6}.\n$$\nThen multiply by $n_{e}$:\n$$\n\\left(4.0 \\times 10^{19}\\right)\\left(4.8 \\times 10^{-30}\\right) = 19.2 \\times 10^{-11} = 1.92 \\times 10^{-10}.\n$$\nTherefore,\n$$\nn_{z} = \\frac{f_{\\text{rad}} \\, P_{\\text{in}}}{n_{e} \\, L_{z}(T_{\\text{m}}) \\, V_{\\text{m}}} = \\frac{0.55 \\times 12 \\times 10^{6}}{1.92 \\times 10^{-10}}.\n$$\nCompute the numerator:\n$$\n0.55 \\times 12 \\times 10^{6} = 6.6 \\times 10^{6}.\n$$\nThus,\n$$\nn_{z} = \\frac{6.6 \\times 10^{6}}{1.92 \\times 10^{-10}} = \\left(\\frac{6.6}{1.92}\\right) \\times 10^{16}.\n$$\nEvaluate the ratio:\n$$\n\\frac{6.6}{1.92} = 3.4375\\ldots\n$$\nHence,\n$$\nn_{z} = 3.4375 \\times 10^{16} \\ \\text{m}^{-3}.\n$$\nRounded to three significant figures,\n$$\nn_{z} \\approx 3.44 \\times 10^{16} \\ \\text{m}^{-3}.\n$$\nThis value corresponds to an impurity concentration relative to the electrons of approximately $(3.44 \\times 10^{16})/(4.0 \\times 10^{19}) \\approx 8.6 \\times 10^{-4}$ under the given assumptions, which is within typical operational ranges for seeded radiative mantles in contemporary devices. The primary assumptions used were steady-state power balance, optically thin radiation, spatial uniformity of $n_{e}$, $n_{z}$, and $T$ across the mantle shell, and the applicability of an effective cooling rate coefficient $L_{z}(T_{\\text{m}})$ characterizing the impurity charge state distribution in coronal equilibrium.",
            "answer": "$$\\boxed{3.44 \\times 10^{16}}$$"
        },
        {
            "introduction": "While the optically thin approximation is a useful starting point, it can break down for strong radiators or in dense plasma regions, leading to radiation trapping. This practice delves into the physics of optical thickness by starting from the fundamental Radiative Transfer Equation, introducing the crucial concepts of escape probability and re-absorbed power . Mastering this allows for a more accurate calculation of the net power loss from the mantle and provides a self-consistent heating term for the local plasma power balance.",
            "id": "4037364",
            "problem": "You are modeling a single, dominant spectral line contribution to the radiative mantle in a magnetically confined fusion plasma. Consider a uniform plane-parallel slab of thickness $L$ representing a local segment of the mantle. The line is frequency-integrated and treated as monochromatic at its center for transport purposes, with isotropic emission and absorption. The slab has constant line emissivity per unit solid angle $j_{\\ell}$ and constant line absorption coefficient $\\kappa_{\\ell}$. There is no external illumination and no scattering, so the Radiative Transfer Equation (RTE) applies in its absorption-emission form. The goal is to estimate the correction to the optically thin volumetric radiation when the line becomes marginally optically thick and to propose and compute a re-emission term to include in the power balance.\n\nStarting only from the fundamental laws and definitions below, derive the necessary relations to evaluate the net volumetric radiative loss and the re-emitted (deposited) power:\n- Radiative Transfer Equation (RTE): Along a ray with path length coordinate $s$ and specific intensity $I_{\\nu}$ at frequency $\\nu$, the RTE is $\\dfrac{d I_{\\nu}}{d s} = -\\kappa_{\\nu} I_{\\nu} + j_{\\nu}$, where $\\kappa_{\\nu}$ is the absorption coefficient and $j_{\\nu}$ is the emissivity per unit solid angle.\n- Optical depth for the line: $\\tau_{\\ell} = \\kappa_{\\ell} L$. Assume that $j_{\\ell}$ and $\\kappa_{\\ell}$ are frequency-integrated over the line and constant across the slab.\n- Source function for the line: $S_{\\ell} = j_{\\ell} / \\kappa_{\\ell}$.\n- Optically thin volumetric power density for the line: $Q_{\\text{thin}} = 4\\pi j_{\\ell}$ in $\\text{W}/\\text{m}^{3}$.\n\nUnder these assumptions of a uniform slab, isotropic emission, and no external illumination, derive from the Radiative Transfer Equation the expression for the net volumetric line power density $Q_{\\text{net}}$ as a function of the optical depth $\\tau_{\\ell}$, and express it as a multiplicative correction to $Q_{\\text{thin}}$. Interpret physically the fraction of line power that does not escape and is re-absorbed and re-emitted (deposited) locally, and define a re-emission term $Q_{\\text{reemit}}$ that can be added to the local power balance. You must express all results in $\\text{W}/\\text{m}^{3}$.\n\nAfter completing the derivation, implement a program to compute $Q_{\\text{net}}$ and $Q_{\\text{reemit}}$ for each test case below. Use the angle-integrated, frequency-integrated formulation appropriate for a plane-parallel slab with isotropic emission. Your numerical evaluation must be robust for both optically thin and optically thick limits. Express each test case result as a list of two floats $[Q_{\\text{net}},Q_{\\text{reemit}}]$.\n\nTest suite (each tuple is $(j_{\\ell}, \\kappa_{\\ell}, L)$):\n1. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 10.0\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$ representing a marginally optically thick line with $\\tau_{\\ell} = 1.0$.\n2. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 0.1\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$ representing an optically thin line with $\\tau_{\\ell} = 0.01$.\n3. $(5.0\\times 10^{3}\\ \\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1},\\ 100.0\\ \\text{m}^{-1},\\ 0.1\\ \\text{m})$ representing an optically thick line with $\\tau_{\\ell} = 10.0$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[Q_{\\text{net}},Q_{\\text{reemit}}]$ for each test case in the same order as above. For example, a valid output structure is of the form `[[float,float],[float,float],[float,float]]`. Do not print any additional text.",
            "solution": "The primary objective is to derive expressions for the net volumetric radiative power loss, $Q_{\\text{net}}$, and a corresponding re-emission (deposited) power term, $Q_{\\text{reemit}}$, for a uniform plane-parallel slab of plasma. The derivation begins with the fundamental Radiative Transfer Equation (RTE).\n\n**1. Derivation of Net Volumetric Radiative Loss ($Q_{\\text{net}}$)**\n\nThe problem specifies a frequency-integrated treatment for a single spectral line. The RTE along a ray path $s$ is given as:\n$$\n\\frac{dI}{ds} = -\\kappa_{\\ell} I + j_{\\ell}\n$$\nwhere $I$ is the specific intensity, $\\kappa_{\\ell}$ is the constant absorption coefficient, and $j_{\\ell}$ is the constant emissivity per unit solid angle.\n\nWe consider a plane-parallel slab of thickness $L$. Let the $z$-axis be normal to the slab, extending from $z=0$ to $z=L$. The path length element $ds$ is related to $dz$ by $ds = dz / \\mu$, where $\\mu = \\cos\\theta$ and $\\theta$ is the angle between the ray and the positive $z$-axis. The RTE becomes:\n$$\n\\mu \\frac{dI}{dz} = -\\kappa_{\\ell} I + j_{\\ell}\n$$\nIt is convenient to work with the optical depth, defined as $d\\tau = \\kappa_{\\ell} dz$. For a constant $\\kappa_{\\ell}$, we have $\\tau(z) = \\kappa_{\\ell} z$. The total optical depth of the slab is $\\tau_{\\ell} = \\kappa_{\\ell} L$. The RTE in terms of $\\tau$ is:\n$$\n\\mu \\frac{dI}{d\\tau} = -I + S_{\\ell}\n$$\nwhere $S_{\\ell} = j_{\\ell} / \\kappa_{\\ell}$ is the source function, which is constant throughout the slab.\n\nThe formal solution of this first-order linear ordinary differential equation for the intensity $I(\\tau, \\mu)$ depends on the direction of propagation.\n\nFor rays traveling in the positive $z$-direction ($\\mu > 0$), we integrate from $\\tau'=0$ to $\\tau$. The boundary condition is $I(0, \\mu) = 0$ as there is no external illumination. The solution is:\n$$\nI(\\tau, \\mu) = S_{\\ell}(1 - e^{-\\tau/\\mu}) \\quad (\\text{for } \\mu > 0)\n$$\nFor rays traveling in the negative $z$-direction ($\\mu < 0$), we integrate from $\\tau'=\\tau_{\\ell}$ to $\\tau$. The boundary condition is $I(\\tau_{\\ell}, \\mu) = 0$. The solution is:\n$$\nI(\\tau, \\mu) = S_{\\ell}(1 - e^{(\\tau_{\\ell}-\\tau)/\\mu}) \\quad (\\text{for } \\mu < 0)\n$$\nThe net volumetric power density, $Q_{\\text{net}}$, is the slab-averaged divergence of the radiative flux vector. For a plane-parallel geometry, this simplifies to the net flux emerging from the slab divided by the slab thickness:\n$$\nQ_{\\text{net}} = \\frac{F(L) - F(0)}{L}\n$$\nwhere $F(z)$ is the radiative flux at position $z$. The flux is defined as the integral of the normal component of the intensity over all solid angles:\n$$\nF(z) = \\int_{4\\pi} I(z, \\mu) \\mu d\\Omega = 2\\pi \\int_{-1}^{1} I(\\tau(z), \\mu) \\mu d\\mu\n$$\nWe evaluate the flux at the boundaries. At the top boundary, $z=L$ (or $\\tau=\\tau_{\\ell}$):\n$$\nF(L) = 2\\pi \\int_{-1}^{1} I(\\tau_{\\ell}, \\mu) \\mu d\\mu = 2\\pi \\left[ \\int_{0}^{1} S_{\\ell}(1 - e^{-\\tau_{\\ell}/\\mu})\\mu d\\mu + \\int_{-1}^{0} S_{\\ell}(1 - e^{0})\\mu d\\mu \\right]\n$$\nThe second integral is zero. Thus:\n$$\nF(L) = 2\\pi S_{\\ell} \\int_{0}^{1} (1 - e^{-\\tau_{\\ell}/\\mu})\\mu d\\mu\n$$\nAt the bottom boundary, $z=0$ (or $\\tau=0$), due to the symmetry of the problem and the up-down direction definitions, $F(0) = -F(L)$. Therefore, the net power leaving the slab is $F(L) - F(0) = 2F(L)$.\n\nThe net volumetric power density is:\n$$\nQ_{\\text{net}} = \\frac{2 F(L)}{L} = \\frac{4\\pi S_{\\ell}}{L} \\int_{0}^{1} (\\mu - \\mu e^{-\\tau_{\\ell}/\\mu}) d\\mu\n$$\nThe integral can be evaluated as:\n$$\n\\int_{0}^{1} \\mu d\\mu - \\int_{0}^{1} \\mu e^{-\\tau_{\\ell}/\\mu} d\\mu = \\frac{1}{2} - E_3(\\tau_{\\ell})\n$$\nwhere $E_n(x) = \\int_{1}^{\\infty} t^{-n}e^{-xt} dt = \\int_{0}^{1} u^{n-2}e^{-x/u} du$ is the exponential integral function of order $n$.\n\nSubstituting this result and the definitions $S_{\\ell} = j_{\\ell}/\\kappa_{\\ell}$ and $L = \\tau_{\\ell}/\\kappa_{\\ell}$:\n$$\nQ_{\\text{net}} = \\frac{4\\pi (j_{\\ell}/\\kappa_{\\ell})}{(\\tau_{\\ell}/\\kappa_{\\ell})} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right) = \\frac{4\\pi j_{\\ell}}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\n$$\nThe optically thin volumetric power density is $Q_{\\text{thin}} = 4\\pi j_{\\ell}$. We can express $Q_{\\text{net}}$ as a correction to $Q_{\\text{thin}}$:\n$$\nQ_{\\text{net}} = Q_{\\text{thin}} \\cdot P(\\tau_{\\ell})\n$$\nwhere $P(\\tau_{\\ell})$ is the escape probability for a uniform, isotropically emitting slab:\n$$\nP(\\tau_{\\ell}) = \\frac{1}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\n$$\n\n**2. Derivation of Re-emission Power Term ($Q_{\\text{reemit}}$)**\n\nThe total power generated per unit volume within the slab is $Q_{\\text{thin}} = 4\\pi j_{\\ell}$. The net power that escapes the slab per unit volume is $Q_{\\text{net}}$. The difference between these two quantities represents the power that is generated within the slab but is re-absorbed before it can escape. This re-absorbed energy is locally deposited as thermal energy, contributing as a heating term in the plasma's power balance. We define this deposited power as the re-emission term, $Q_{\\text{reemit}}$.\n\nBy the principle of energy conservation for the radiation field within the volume:\n$$\n\\text{Total Emitted Power} = \\text{Net Escaped Power} + \\text{Deposited Power}\n$$\n$$\nQ_{\\text{thin}} = Q_{\\text{net}} + Q_{\\text{reemit}}\n$$\nTherefore, the re-emission term is:\n$$\nQ_{\\text{reemit}} = Q_{\\text{thin}} - Q_{\\text{net}} = Q_{\\text{thin}} \\cdot (1 - P(\\tau_{\\ell}))\n$$\n$$\nQ_{\\text{reemit}} = 4\\pi j_{\\ell} \\left(1 - \\frac{1}{\\tau_{\\ell}} \\left(\\frac{1}{2} - E_3(\\tau_{\\ell})\\right)\\right)\n$$\nThese expressions for $Q_{\\text{net}}$ and $Q_{\\text{reemit}}$ are valid for any optical depth $\\tau_{\\ell} \\geq 0$.\n\n**3. Summary of Formulas for Implementation**\n\nFor each test case defined by $(j_{\\ell}, \\kappa_{\\ell}, L)$:\n1. Calculate the optical depth: $\\tau_{\\ell} = \\kappa_{\\ell} L$.\n2. Calculate the optically thin power density: $Q_{\\text{thin}} = 4\\pi j_{\\ell}$.\n3. Evaluate the third-order exponential integral $E_3(\\tau_{\\ell})$.\n4. Calculate the escape probability: $P(\\tau_{\\ell}) = \\frac{1}{\\tau_{\\ell}} (\\frac{1}{2} - E_3(\\tau_{\\ell}))$. For the edge case $\\tau_{\\ell} \\to 0$, $P(\\tau_{\\ell}) \\to 1$.\n5. Compute the net volumetric power loss: $Q_{\\text{net}} = Q_{\\text{thin}} \\cdot P(\\tau_{\\ell})$.\n6. Compute the re-emitted (deposited) power: $Q_{\\text{reemit}} = Q_{\\text{thin}} - Q_{\\text{net}}$.\nThe numerical implementation will use `scipy.special.expn` for $E_n(x)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\n\ndef solve():\n    \"\"\"\n    Calculates the net volumetric radiative loss (Q_net) and the re-emitted\n    (deposited) power density (Q_reemit) for a uniform plane-parallel slab.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (j_l [W m^-3 sr^-1], kappa_l [m^-1], L [m])\n    test_cases = [\n        (5.0e3, 10.0, 0.1),\n        (5.0e3, 0.1, 0.1),\n        (5.0e3, 100.0, 0.1),\n    ]\n\n    results = []\n    for j_l, kappa_l, L in test_cases:\n        # Calculate optical depth for the line\n        tau_l = kappa_l * L\n        \n        # Calculate the optically thin volumetric power density\n        Q_thin = 4.0 * np.pi * j_l\n        \n        # Handle the optically thin limit to avoid division by zero,\n        # although the provided test cases have tau_l > 0.\n        if np.isclose(tau_l, 0.0):\n            # In the limit tau -> 0, P(tau) -> 1\n            escape_probability = 1.0\n        else:\n            # Evaluate the third exponential integral E_3(tau_l)\n            E3_tau = expn(3, tau_l)\n            \n            # Calculate the escape probability for a uniform slab\n            # P(tau) = (1/tau) * (1/2 - E_3(tau))\n            escape_probability = (0.5 - E3_tau) / tau_l\n\n        # Calculate the net volumetric radiative loss\n        Q_net = Q_thin * escape_probability\n        \n        # Calculate the re-emitted (deposited) power density\n        # This is the power generated but not escaped.\n        Q_reemit = Q_thin - Q_net\n        \n        # Append the results for the current case\n        results.append([Q_net, Q_reemit])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list is already in the format '[item1, item2]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The choice of an impurity for a radiative mantle involves balancing competing engineering objectives. This advanced practice elevates the analysis to a system-level design problem, exploring the trade-off between maximizing the radiated power fraction ($f_{\\text{rad}}$) and minimizing the dilution of fusion fuel in the core ($\\delta$) . By computing the Pareto front for different impurity species, you will learn to identify optimal operating points that represent the best compromise between efficient power exhaust and preserving core fusion performance.",
            "id": "4037485",
            "problem": "You are asked to compute the trade-off between radiated power fraction and core fuel dilution in a simplified radiative mantle model for a magnetically confined fusion plasma. The scenario is framed within computational fusion science and engineering at the advanced graduate level and must be derived from scientifically sound first principles.\n\nConsider a toroidal plasma with a radiative mantle region of volume $V_{\\mathrm{m}}$, approximate electron density $n_{\\mathrm{e,m}}$ in the mantle, and baseline mantle electron temperature $T_{0}$ established by parallel thermal conduction to the divertor legs when no impurity is present. The total externally supplied heating power to the plasma $P_{\\mathrm{heat}}$ crosses the separatrix and is carried partly by parallel electron thermal conduction in the mantle and partly by radiation from seeded impurities.\n\nModel the mantle power balance using a conduction-radiation relation derived from Spitzer-Härm scaling for parallel electron conduction. The parallel conduction power is assumed to scale as $P_{\\mathrm{cond}}(T)=K\\,T^{5/2}$, where $K$ is a constant determined by the boundary condition $P_{\\mathrm{cond}}(T_{0})=P_{\\mathrm{heat}}$ in the absence of impurities. Radiative power in the mantle from an impurity species $Z$ under coronal equilibrium is modeled as $P_{\\mathrm{rad}}(T,f_{Z})=n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T)\\,V_{\\mathrm{m}}$, where $f_{Z}$ is the impurity fractional abundance defined by $f_{Z}=n_{Z}/n_{\\mathrm{e,m}}$ and $\\Lambda_{Z}(T)$ is the species-specific radiative cooling function. The radiative cooling function is approximated with a log-normal peak:\n$$\n\\Lambda_{Z}(T)=S_{Z}\\,\\exp\\!\\left(-\\frac{(\\ln T-\\ln T_{\\mathrm{p},Z})^{2}}{2\\,\\sigma_{Z}^{2}}\\right),\n$$\nwith $S_{Z}$ a species-dependent amplitude in $\\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{\\mathrm{p},Z}$ the peak temperature in $\\mathrm{eV}$, and $\\sigma_{Z}$ the logarithmic width.\n\nThe mantle temperature $T_{\\mathrm{m}}$ for given $f_{Z}$ is determined by the steady power balance\n$$\nP_{\\mathrm{cond}}(T_{\\mathrm{m}})+P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})=P_{\\mathrm{heat}},\n$$\nthat is,\n$$\nK\\,T_{\\mathrm{m}}^{5/2}+n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,\\Lambda_{Z}(T_{\\mathrm{m}})\\,V_{\\mathrm{m}}=P_{\\mathrm{heat}}.\n$$\nFrom the solution $T_{\\mathrm{m}}$, define the radiated power fraction as\n$$\nf_{\\mathrm{rad}}=\\frac{P_{\\mathrm{rad}}(T_{\\mathrm{m}},f_{Z})}{P_{\\mathrm{heat}}}.\n$$\n\nCore fuel dilution is estimated using quasineutrality in the core with a fixed core electron density $n_{\\mathrm{e,c}}$ and a single effective impurity charge state $Z_{\\mathrm{imp,c}}$ appropriate to the high core temperature. With deuterium-tritium fuel ions of charge $+1$, the core fuel ion density is reduced to $n_{\\mathrm{fuel,c}}=n_{\\mathrm{e,c}}-Z_{\\mathrm{imp,c}}\\,n_{\\mathrm{imp,c}}$. Under the simplifying assumption that the impurity fractional abundance is radially uniform and equal to the mantle fraction $f_{Z}$, the dimensionless core dilution fraction is\n$$\n\\delta=\\frac{n_{\\mathrm{fuel,c},0}-n_{\\mathrm{fuel,c}}}{n_{\\mathrm{fuel,c},0}}=Z_{\\mathrm{imp,c}}\\,f_{Z},\n$$\nwhere $n_{\\mathrm{fuel,c},0}=n_{\\mathrm{e,c}}$ is the undiluted core fuel density.\n\nYour task is to compute, for two impurity species, the Pareto front between maximizing $f_{\\mathrm{rad}}$ and minimizing $\\delta$ over a discrete set of impurity fractional abundances $f_{Z}$. A point $\\left(\\delta,f_{\\mathrm{rad}}\\right)$ is Pareto-optimal if there is no other sampled point with $f_{\\mathrm{rad}}$ greater than or equal and $\\delta$ less than or equal, with at least one strict inequality. Additionally, identify a single “knee” point on each species’ Pareto front as the point maximizing the ratio $f_{\\mathrm{rad}}/(\\delta+\\varepsilon)$ for a small positive $\\varepsilon$ to avoid division by zero.\n\nUse the following scientifically reasonable parameters and units:\n- $P_{\\mathrm{heat}}=5\\times 10^{7}\\ \\mathrm{W}$.\n- $T_{0}=180\\ \\mathrm{eV}$.\n- $n_{\\mathrm{e,m}}=2\\times 10^{19}\\ \\mathrm{m}^{-3}$.\n- $V_{\\mathrm{m}}=30\\ \\mathrm{m}^{3}$.\n- $K=P_{\\mathrm{heat}}/T_{0}^{5/2}$, ensuring $P_{\\mathrm{cond}}(T_{0})=P_{\\mathrm{heat}}$.\n- For Neon ($\\mathrm{Ne}$): $S_{Z}=2\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{\\mathrm{p},Z}=120\\ \\mathrm{eV}$, $\\sigma_{Z}=0.5$, $Z_{\\mathrm{imp,c}}=10$, and $f_{Z}\\in\\{0,2\\times 10^{-4},5\\times 10^{-4},10^{-3},2\\times 10^{-3},4\\times 10^{-3},8\\times 10^{-3}\\}$.\n- For Argon ($\\mathrm{Ar}$): $S_{Z}=6\\times 10^{-31}\\ \\mathrm{W}\\,\\mathrm{m}^{3}$, $T_{\\mathrm{p},Z}=180\\ \\mathrm{eV}$, $\\sigma_{Z}=0.5$, $Z_{\\mathrm{imp,c}}=18$, and $f_{Z}\\in\\{0,10^{-4},3\\times 10^{-4},8\\times 10^{-4},1.5\\times 10^{-3},3\\times 10^{-3},6\\times 10^{-3},10^{-2}\\}$.\n\nComputational requirements:\n- For each species and each $f_{Z}$ in its set, solve for $T_{\\mathrm{m}}$ in $\\mathrm{eV}$ that satisfies the power balance. Use a robust scalar root-finding method over the interval $[10^{-3}\\ \\mathrm{eV},T_{0}]$ to find $T_{\\mathrm{m}}$.\n- Compute $f_{\\mathrm{rad}}$ and $\\delta$ for each sampled $f_{Z}$.\n- Extract the discrete Pareto front for the objective pair $\\left(-f_{\\mathrm{rad}},\\delta\\right)$ (equivalently maximizing $f_{\\mathrm{rad}}$ and minimizing $\\delta$).\n- On each front, select the knee point as the one maximizing $f_{\\mathrm{rad}}/(\\delta+\\varepsilon)$ with $\\varepsilon=10^{-12}$, and report its $\\left(f_{\\mathrm{rad}},\\delta\\right)$ coordinates.\n\nTest suite and final output:\n- The two species with their parameter sets above constitute the test suite. These cases probe low-seeding limits (including $f_{Z}=0$), intermediate regimes, and high-seeding edge cases where radiation saturates and additional dilution provides diminishing radiative returns.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be $\\left[N_{\\mathrm{Ne}},f_{\\mathrm{rad},\\mathrm{knee},\\mathrm{Ne}},\\delta_{\\mathrm{knee},\\mathrm{Ne}},N_{\\mathrm{Ar}},f_{\\mathrm{rad},\\mathrm{knee},\\mathrm{Ar}},\\delta_{\\mathrm{knee},\\mathrm{Ar}}\\right]$, where $N_{\\mathrm{Ne}}$ and $N_{\\mathrm{Ar}}$ are integers giving the number of Pareto-optimal points for Neon and Argon, and the knee coordinates are floats. Express all outputs as dimensionless numbers (no physical units), with $f_{\\mathrm{rad}}$ and $\\delta$ as decimals.",
            "solution": "The solution proceeds by first implementing the physical model, then using this model to generate a set of performance data, and finally applying multi-objective optimization concepts to this dataset.\n\n**1. Physical and Mathematical Model Implementation**\n\nThe foundation of the problem is the steady-state power balance in the plasma mantle:\n$$\nP_{\\mathrm{heat}} = P_{\\mathrm{cond}}(T_{\\mathrm{m}}) + P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_{Z})\n$$\nwhere $T_{\\mathrm{m}}$ is the resulting mantle temperature for a given impurity fraction $f_{Z}$. Substituting the specific models for conduction and radiation gives the equation to be solved for $T_{\\mathrm{m}}$:\n$$\nP_{\\mathrm{heat}} = \\left(\\frac{P_{\\mathrm{heat}}}{T_{0}^{5/2}}\\right)T_{\\mathrm{m}}^{5/2} + n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,V_{\\mathrm{m}}\\,S_{Z}\\,\\exp\\!\\left(-\\frac{(\\ln T_{\\mathrm{m}}-\\ln T_{\\mathrm{p},Z})^{2}}{2\\,\\sigma_{Z}^{2}}\\right)\n$$\nThis is a nonlinear, transcendental equation for $T_{\\mathrm{m}}$. We define a function $g(T, f_Z)$ representing the residual of the power balance:\n$$\ng(T, f_Z) = \\left(\\frac{P_{\\mathrm{heat}}}{T_{0}^{5/2}}\\right)T^{5/2} + n_{\\mathrm{e,m}}^{2}\\,f_{Z}\\,V_{\\mathrm{m}}\\,\\Lambda_{Z}(T) - P_{\\mathrm{heat}}\n$$\nFor each specified impurity fraction $f_{Z}$, we must find the root $T_{\\mathrm{m}}$ such that $g(T_{\\mathrm{m}}, f_Z) = 0$ within the interval $[10^{-3}\\,\\mathrm{eV}, T_{0}]$. A robust bracketing root-finder like the Brent-Dekker method (`brentq` in SciPy) is suitable for this task.\n\nOnce $T_{\\mathrm{m}}$ is determined, the two figures of merit, radiated power fraction ($f_{\\mathrm{rad}}$) and core fuel dilution ($\\delta$), are calculated. From the power balance equation, the conduction power is $P_{\\mathrm{cond}}(T_{\\mathrm{m}}) = P_{\\mathrm{heat}} - P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_Z)$. Therefore, $f_{\\mathrm{rad}}$ can be expressed without recalculating the radiation term:\n$$\nf_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}(T_{\\mathrm{m}}, f_Z)}{P_{\\mathrm{heat}}} = 1 - \\frac{P_{\\mathrm{cond}}(T_{\\mathrm{m}})}{P_{\\mathrm{heat}}} = 1 - \\frac{K\\,T_{\\mathrm{m}}^{5/2}}{K\\,T_{0}^{5/2}} = 1 - \\left(\\frac{T_{\\mathrm{m}}}{T_{0}}\\right)^{5/2}\n$$\nThe core fuel dilution is given by the linear relation:\n$$\n\\delta = Z_{\\mathrm{imp,c}} \\, f_{Z}\n$$\n\n**2. Multi-Objective Analysis**\n\nThis procedure is repeated for each given value of $f_Z$ for a given impurity, generating a set of $(\\delta, f_{\\mathrm{rad}})$ pairs. These pairs represent the achievable performance points.\n\n**a. Pareto Front Identification**\nThe goal is to maximize $f_{\\mathrm{rad}}$ and minimize $\\delta$. A point $(d_i, r_i)$ is on the Pareto front if no other point $(d_j, r_j)$ exists such that $r_j \\geq r_i$ and $d_j \\leq d_i$, with at least one inequality being strict. The algorithm to identify this discrete front is as follows:\n1. Sort the calculated $(\\delta, f_{\\mathrm{rad}})$ points in ascending order of $\\delta$.\n2. Initialize an empty Pareto front list and set a variable `max_f_rad_seen` to a value below any possible $f_{\\mathrm{rad}}$ (e.g., `-1.0`).\n3. Iterate through the sorted points. For each point $(d_i, r_i)$, if its radiated fraction $r_i$ is strictly greater than `max_f_rad_seen`, the point is not dominated by any preceding point (which all have smaller or equal $\\delta$). Add it to the Pareto front and update `max_f_rad_seen = r_i`.\n4. The final list contains all Pareto-optimal points. The number of these points is $N$.\n\n**b. Knee Point Selection**\nThe knee point is the \"best compromise\" on the front. It is found by maximizing the utility function $U = f_{\\mathrm{rad}} / (\\delta + \\varepsilon)$ over all points on the identified Pareto front. The small constant $\\varepsilon = 10^{-12}$ ensures the expression is well-defined for the point $(\\delta=0, f_{\\mathrm{rad}}=0)$. We compute this ratio for each Pareto-optimal point and select the one yielding the maximum value.\n\nThis entire process is performed independently for the Neon and Argon parameter sets. The final output aggregates the number of Pareto points and the knee point coordinates for both species.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Pareto front and knee point for mantle radiation vs. core dilution\n    for Neon and Argon impurities in a simplified fusion plasma model.\n    \"\"\"\n\n    # Define the common physical parameters\n    P_heat = 5.0e7  # Total heating power in W\n    T0 = 180.0      # Baseline mantle temperature in eV\n    ne_m = 2.0e19   # Mantle electron density in m^-3\n    V_m = 30.0      # Mantle volume in m^3\n    epsilon = 1e-12 # Small constant for knee point calculation\n\n    # Define the species-specific parameters in test cases\n    test_cases = [\n        {\n            \"species\": \"Ne\",\n            \"S_Z\": 2.0e-31,      # Radiation amplitude in W m^3\n            \"Tp_Z\": 120.0,       # Peak radiation temperature in eV\n            \"sigma_Z\": 0.5,      # Logarithmic width of radiation peak\n            \"Z_impc\": 10.0,      # Effective core charge state\n            \"f_Z_values\": [0, 2e-4, 5e-4, 1e-3, 2e-3, 4e-3, 8e-3],\n        },\n        {\n            \"species\": \"Ar\",\n            \"S_Z\": 6.0e-31,\n            \"Tp_Z\": 180.0,\n            \"sigma_Z\": 0.5,\n            \"Z_impc\": 18.0,\n            \"f_Z_values\": [0, 1e-4, 3e-4, 8e-4, 1.5e-3, 3e-3, 6e-3, 1e-2],\n        },\n    ]\n\n    final_results = []\n    for params in test_cases:\n        \n        # Calculate the conduction constant K\n        K = P_heat / (T0**2.5)\n\n        def lambda_Z(T, S_Z, Tp_Z, sigma_Z):\n            \"\"\"Calculates the radiative cooling function Lambda_Z(T).\"\"\"\n            if T <= 0: return 0.0\n            ln_T = np.log(T)\n            ln_Tp = np.log(Tp_Z)\n            return S_Z * np.exp(-(ln_T - ln_Tp)**2 / (2 * sigma_Z**2))\n\n        def power_balance_residual(T, f_Z, S_Z, Tp_Z, sigma_Z):\n            \"\"\"\n            Calculates the residual of the power balance equation.\n            g(T) = P_cond(T) + P_rad(T) - P_heat\n            We want to find T such that g(T) = 0.\n            \"\"\"\n            P_cond = K * (T**2.5)\n            P_rad = ne_m**2 * f_Z * lambda_Z(T, S_Z, Tp_Z, sigma_Z) * V_m\n            return P_cond + P_rad - P_heat\n        \n        # Store (delta, f_rad) pairs\n        performance_points = []\n\n        for f_Z in params[\"f_Z_values\"]:\n            delta = params[\"Z_impc\"] * f_Z\n            \n            # Solve for mantle temperature Tm\n            if f_Z == 0:\n                # No radiation, so P_cond = P_heat, which implies Tm = T0\n                Tm = T0\n            else:\n                # Use a robust root finder to solve the power balance equation\n                try:\n                    Tm = brentq(\n                        lambda T: power_balance_residual(\n                            T, f_Z, params[\"S_Z\"], params[\"Tp_Z\"], params[\"sigma_Z\"]\n                        ),\n                        1e-3, # Lower bound for temperature search\n                        T0,   # Upper bound for temperature search\n                    )\n                except ValueError:\n                    # If brentq fails (e.g., endpoints have same sign), handle it\n                    # This might happen if radiation is extremely high, pushing the\n                    # solution to very low T. For this problem setup, it's unlikely.\n                    # We can assume the solution is at the lower bound if a root isn't found.\n                    Tm = 1e-3\n\n            # Calculate radiated power fraction f_rad\n            # f_rad = 1 - P_cond(Tm)/P_heat = 1 - (K*Tm^2.5)/(K*T0^2.5)\n            f_rad = 1.0 - (Tm / T0)**2.5\n\n            performance_points.append({\"delta\": delta, \"f_rad\": f_rad})\n\n        # Identify the Pareto front\n        # The points are already sorted by delta due to the order of f_Z_values\n        pareto_front = []\n        max_f_rad_so_far = -1.0\n        for point in performance_points:\n            # A point is on the front if its f_rad is higher than any point with a smaller delta\n            if point['f_rad'] > max_f_rad_so_far:\n                pareto_front.append(point)\n                max_f_rad_so_far = point['f_rad']\n        \n        num_pareto_points = len(pareto_front)\n        \n        # Find the knee point on the Pareto front\n        best_ratio = -1.0\n        knee_point = None\n        for point in pareto_front:\n            ratio = point['f_rad'] / (point['delta'] + epsilon)\n            if ratio > best_ratio:\n                best_ratio = ratio\n                knee_point = point\n        \n        # Append results for this species to the final list\n        final_results.extend([num_pareto_points, knee_point['f_rad'], knee_point['delta']])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}