{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on the fundamental source of material migration: physical sputtering. Real-world fusion plasmas contain a mix of ion species, and their combined effect on a surface is not always a simple sum of their individual impacts. This exercise challenges you to first build a baseline \"linear-mixing\" model to predict the sputtering yield from a mixed D-He plasma, and then use it to quantify non-linear synergistic effects, which are a critical area of study in plasma-surface interactions .",
            "id": "4050382",
            "problem": "A polycrystalline tungsten surface in a magnetically confined fusion device is exposed to a steady, mixed ion flux composed of deuterium (D) and helium (He). Assume a stationary regime where surface temperature is low enough that thermal desorption is negligible and where prompt re-deposition is negligible. Let the incident ion energies and incidence angle be $E_{D}=200\\ \\text{eV}$, $E_{\\mathrm{He}}=600\\ \\text{eV}$, and $\\theta=60^{\\circ}$ from the surface normal. The ion fluxes to the surface are $\\Gamma_{D}=7.0\\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ and $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$.\n\nBy definition, the sputtering yield $Y_{i}(E_{i},\\theta)$ of species $i$ is the number of target atoms removed per incident ion of species $i$ at energy $E_{i}$ and incidence angle $\\theta$. Under the assumption that, in the absence of cross-coupling between species, the emission rate density is the sum of the independent contributions from each ion species, the flux-weighted mixed yield is defined by the ratio of the total emission rate density to the total incident ion flux. Use this definition to derive the linear-mixing prediction $Y_{\\text{mix}}$ in terms of flux fractions and the mono-species yields.\n\nUnder identical surface state and geometry, single-species measurements provide the following mono-species yields at the stated $E_{i}$ and $\\theta$: $Y_{D}(E_{D},\\theta)=0.015$ and $Y_{\\mathrm{He}}(E_{\\mathrm{He}},\\theta)=0.420$. A co-bombardment experiment at the same $E_{i}$ and $\\theta$ with the mixed D+He fluxes stated above reports a measured mixed yield $Y_{\\text{meas}}=0.273$.\n\nStarting from the definition of sputtering yield and conservation of particle fluxes to and from the surface, (i) derive the expression for the linear-mixing prediction $Y_{\\text{mix}}$ in terms of flux fractions $x_{i}$ and mono-species yields $Y_{i}(E_{i},\\theta)$, and compute its numerical value from the provided data; (ii) quantify the synergistic effect of co-bombardment by defining the multiplicative synergy factor $\\eta$ as the ratio of the measured mixed yield to the linear-mixing prediction, $\\eta=Y_{\\text{meas}}/Y_{\\text{mix}}$, and compute its numerical value.\n\nExpress your final answer as the single number $\\eta$ (dimensionless) rounded to four significant figures.",
            "solution": "The problem is evaluated to be physically sound, well-posed, and contains all necessary information for a unique solution. The concepts of sputtering yield, ion flux, and linear mixing are standard in the field of plasma-surface interactions.\n\nThe solution is divided into two main parts as requested: (i) the derivation and calculation of the linear-mixing prediction for the mixed-species sputtering yield, $Y_{\\text{mix}}$, and (ii) the calculation of the multiplicative synergy factor, $\\eta$.\n\n(i) Derivation and computation of the linear-mixing sputtering yield, $Y_{\\text{mix}}$.\n\nThe sputtering yield for a single ion species $i$, denoted $Y_i$, is defined as the number of target atoms ejected per incident ion. This can be expressed as a ratio of fluxes: the flux of sputtered target atoms, $\\Gamma_{\\text{emitted}, i}$, to the incident ion flux, $\\Gamma_i$.\n$$Y_i = \\frac{\\Gamma_{\\text{emitted}, i}}{\\Gamma_i}$$\nFrom this definition, the flux of emitted atoms due to bombardment by species $i$ is $\\Gamma_{\\text{emitted}, i} = Y_i \\Gamma_i$.\n\nThe problem states that for the linear-mixing model, the total emission rate density (total flux of emitted atoms, $\\Gamma_{\\text{emitted, total}}$) is assumed to be the sum of the independent contributions from each ion species. For the given mixture of deuterium ($D$) and helium ($He$), the total emitted flux is:\n$$\\Gamma_{\\text{emitted, total}} = \\Gamma_{\\text{emitted, D}} + \\Gamma_{\\text{emitted, He}} = Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}$$\nwhere $Y_{D}$ and $Y_{\\mathrm{He}}$ are the mono-species sputtering yields for deuterium and helium, respectively, and $\\Gamma_{D}$ and $\\Gamma_{\\mathrm{He}}$ are their corresponding incident ion fluxes.\n\nThe total incident ion flux, $\\Gamma_{\\text{total}}$, is the sum of the individual ion fluxes:\n$$\\Gamma_{\\text{total}} = \\Gamma_{D} + \\Gamma_{\\mathrm{He}}$$\nThe problem defines the flux-weighted mixed yield, $Y_{\\text{mix}}$, as the ratio of the total emission rate density to the total incident ion flux.\n$$Y_{\\text{mix}} = \\frac{\\Gamma_{\\text{emitted, total}}}{\\Gamma_{\\text{total}}} = \\frac{Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\nTo express this in terms of flux fractions, we define the fraction of each species in the total flux. The flux fraction for deuterium, $x_{D}$, and for helium, $x_{\\mathrm{He}}$, are:\n$$x_{D} = \\frac{\\Gamma_{D}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\n$$x_{\\mathrm{He}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\nSubstituting these definitions into the expression for $Y_{\\text{mix}}$:\n$$Y_{\\text{mix}} = \\frac{Y_{D} \\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} + \\frac{Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} = Y_{D} x_{D} + Y_{\\mathrm{He}} x_{\\mathrm{He}}$$\nThis is the required expression for the linear-mixing prediction in terms of flux fractions and mono-species yields.\n\nNow, we compute the numerical value of $Y_{\\text{mix}}$ using the provided data.\nThe incident ion fluxes are $\\Gamma_{D}=7.0\\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ and $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$.\nThe total incident ion flux is:\n$$\\Gamma_{\\text{total}} = (7.0 \\times 10^{19} + 3.0 \\times 10^{19})\\,\\text{m}^{-2}\\,\\text{s}^{-1} = 10.0 \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1} = 1.0 \\times 10^{20}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$$\nThe flux fractions are:\n$$x_{D} = \\frac{7.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.7$$\n$$x_{\\mathrm{He}} = \\frac{3.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.3$$\nThe mono-species yields are given as $Y_{D} = 0.015$ and $Y_{\\mathrm{He}} = 0.420$. The specific energy $E_i$ and angle $\\theta$ arguments are omitted for brevity as they are constant throughout the problem.\n$$Y_{\\text{mix}} = x_{D} Y_{D} + x_{\\mathrm{He}} Y_{\\mathrm{He}} = (0.7)(0.015) + (0.3)(0.420)$$\n$$Y_{\\text{mix}} = 0.0105 + 0.1260 = 0.1365$$\n\n(ii) Quantification of the synergistic effect, $\\eta$.\n\nThe problem defines the multiplicative synergy factor $\\eta$ as the ratio of the measured mixed yield, $Y_{\\text{meas}}$, to the linear-mixing prediction, $Y_{\\text{mix}}$.\n$$\\eta = \\frac{Y_{\\text{meas}}}{Y_{\\text{mix}}}$$\nThe measured mixed yield is given as $Y_{\\text{meas}} = 0.273$.\nUsing the value of $Y_{\\text{mix}}$ calculated above:\n$$\\eta = \\frac{0.273}{0.1365}$$\n$$\\eta = 2.0$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\\eta = 2.000$$\nThis value indicates a strong synergistic effect, where the co-bombardment of deuterium and helium results in a sputtering yield that is twice as large as would be expected from a simple linear combination of their individual effects.",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "Having explored the primary sputtering event, we now examine its cumulative effect on the evolution of a solid surface's morphology. This computational exercise delves into the Bradley-Harper theory, a cornerstone model that describes how ion bombardment can lead to the spontaneous formation of surface patterns like nanoscale ripples. By simulating the growth or decay of different spatial frequency modes, you will gain hands-on experience with linear stability analysis and see how the competition between erosion-driven roughening and diffusion-driven smoothing shapes the surface landscape .",
            "id": "4050333",
            "problem": "Consider a one-dimensional plasma-facing surface with height field $h(x,t)$ evolving under the linearized Bradley-Harper (BH) model of ion-induced erosion and surface diffusion. You are given an initial roughness spectrum $S(k)$ sampled at discrete wavenumbers $k$, and your task is to simulate a single time step of the spectral evolution under BH linear dynamics and compute the amplification of each mode.\n\nFundamental base and assumptions:\n- Begin from mass conservation of surface material, small-slope approximation, and linear response of erosion to curvature.\n- The Bradley-Harper (BH) linearized evolution equation in one spatial dimension is\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4},\n$$\nwhere $x$ is position along the surface, $t$ is time, $\\nu$ is the curvature-dependent erosion coefficient (units $\\mathrm{m}^2/\\mathrm{s}$; $\\nu>0$ corresponds to destabilization, $\\nu<0$ corresponds to stabilization), and $K$ is the effective surface diffusion coefficient (units $\\mathrm{m}^4/\\mathrm{s}$; $K>0$ provides high-wavenumber smoothing).\n\n- Let $h_k(t)$ denote the spatial Fourier mode of $h$ at wavenumber $k$ with Fourier convention $h(x,t) = \\int h_k(t) e^{ikx} \\, dk$. Linearizing and transforming to Fourier space yields the ordinary differential equation for each mode:\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k,\n$$\nwith dispersion relation\n$$\n\\omega(k) = \\nu k^2 - K k^4,\n$$\nwhich has units of $\\mathrm{s}^{-1}$.\n\n- The mode amplitude solution over a time step $\\Delta t$ is\n$$\nh_k(t+\\Delta t) = h_k(t)\\, \\exp\\big(\\omega(k)\\, \\Delta t\\big).\n$$\nDefine the roughness spectrum $S(k)$ as the squared amplitude $S(k) = |h_k|^2$ (dimension depends on normalization, but the amplification factor for $S(k)$ is dimensionless). Then the spectral update over a single time step is\n$$\nS(k, t+\\Delta t) = S(k, t) \\, \\exp\\big(2\\, \\omega(k)\\, \\Delta t\\big).\n$$\nTherefore, the amplification factor of the spectral power for each mode is\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big).\n$$\n\nYour program must compute $A(k)$ for given sets of $(\\nu, K, \\Delta t)$ and discrete $k$ lists and produce the amplification values for each test case. Although the initial $S(k)$ is provided to define a complete physical scenario, only the amplification $A(k)$ needs to be returned by your program.\n\nPhysical and numerical units and output requirements:\n- Use $k$ in $\\mathrm{m}^{-1}$, time step $\\Delta t$ in $\\mathrm{s}$, $\\nu$ in $\\mathrm{m}^2/\\mathrm{s}$, and $K$ in $\\mathrm{m}^4/\\mathrm{s}$.\n- The amplification $A(k)$ is dimensionless. Express the amplification values as floating point numbers rounded to six decimal places.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the per-mode amplification values in the order of the provided $k$ list. For example: $[ [a_1, a_2], [b_1, b_2, b_3] ]$.\n\nTest suite:\nCompute the amplification $A(k)$ for the following parameter sets. Each test case provides $(\\nu, K, \\Delta t)$, an explicit $k$ list, and an initial $S(k)$ list. Only $A(k)$ must be output.\n\n- Test case $1$ (destabilizing at intermediate $k$):\n  - $\\nu = 1.0 \\times 10^{-12}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 2.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-4}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{6},\\, 5.0 \\times 10^{6},\\, 1.0 \\times 10^{7},\\, 5.0 \\times 10^{7},\\, 1.0 \\times 10^{8}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[1.0 \\times 10^{-18},\\, 2.5 \\times 10^{-18},\\, 3.0 \\times 10^{-18},\\, 1.5 \\times 10^{-18},\\, 1.0 \\times 10^{-18}]$.\n\n- Test case $2$ (near-neutral and stabilizing at high $k$):\n  - $\\nu = 1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{8},\\, 1.0 \\times 10^{9},\\, 2.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[5.0 \\times 10^{-19},\\, 2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19}]$.\n\n- Test case $3$ (stabilizing curvature, mixed neutral mode):\n  - $\\nu = -1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{8},\\, 5.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19},\\, 8.0 \\times 10^{-20}]$.\n\n- Test case $4$ (longer time step, mixed stability across $k$):\n  - $\\nu = 5.0 \\times 10^{-19}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-1}\\ \\mathrm{s}$,\n  - $k$ list: $[5.0 \\times 10^{8},\\, 7.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[1.0 \\times 10^{-19},\\, 1.5 \\times 10^{-19},\\, 2.0 \\times 10^{-19}]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of amplification values for the corresponding test case, each rounded to six decimal places. For instance, the output must look like $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with no additional text.",
            "solution": "The user-provided problem has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **Governing Equation (Linearized Bradley-Harper):**\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4}\n$$\n- **Parameters:**\n  - $h(x,t)$: surface height field.\n  - $\\nu$: curvature-dependent erosion coefficient ($\\mathrm{m}^2/\\mathrm{s}$).\n  - $K$: effective surface diffusion coefficient ($\\mathrm{m}^4/\\mathrm{s}$).\n- **Fourier Mode ODE:**\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k\n$$\n- **Dispersion Relation:**\n$$\n\\omega(k) = \\nu k^2 - K k^4\n$$\n- **Target Quantity (Amplification Factor of Spectral Power $S(k) = |h_k|^2$):**\n$$\nA(k) = \\frac{S(k, t+\\Delta t)}{S(k, t)} = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n- **Test Cases:**\n  1.  **Case 1:** $\\nu = 1.0 \\times 10^{-12}$, $K = 2.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-4}$, $k = [10^6, 5 \\times 10^6, 10^7, 5 \\times 10^7, 10^8]$.\n  2.  **Case 2:** $\\nu = 1.0 \\times 10^{-18}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-2}$, $k = [10^8, 10^9, 2 \\times 10^9]$.\n  3.  **Case 3:** $\\nu = -1.0 \\times 10^{-18}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-2}$, $k = [10^8, 5 \\times 10^8, 10^9]$.\n  4.  **Case 4:** $\\nu = 5.0 \\times 10^{-19}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-1}$, $k = [5 \\times 10^8, 7 \\times 10^8, 10^9]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed as **valid**.\n- **Scientifically Grounded:** The problem is based on the linearized Bradley-Harper equation, a standard and well-established model in surface science and plasma-material interaction for describing ion-induced pattern formation.\n- **Well-Posed:** The problem is well-posed, providing a direct formula for the quantity to be calculated, $A(k)$, and all necessary parameters. For each set of inputs, a unique and stable solution exists.\n- **Objective:** The problem is stated in precise, objective language with clearly defined physical quantities, units, and mathematical relationships.\n- **Complete and Consistent:** All necessary data ($\\nu, K, \\Delta t$, lists of $k$) are provided for each test case. The units are dimensionally consistent. The contextual information about $S(k)$ is explicitly marked as not needed for the calculation, which is a clarification, not a contradiction.\n- **Realistic and Feasible:** The numerical values of the physical parameters are within plausible orders of magnitude for nanotechnology and surface science applications.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Principle-Based Design of the Solution\nThe core task is to compute the amplification factor, $A(k)$, for the spectral power of surface roughness, which is governed by the linearized Bradley-Harper (BH) model. The problem provides the final analytical expression for this factor, derived from the model's governing partial differential equation through Fourier analysis.\n\nThe fundamental principle is that in a linear system, different spatial frequency components (Fourier modes) evolve independently. The evolution of each mode $h_k$ is described by a simple first-order ordinary differential equation, $\\frac{d h_k}{d t} = \\omega(k)\\, h_k$, where $\\omega(k)$ is the dispersion relation, or growth rate, of the mode with wavenumber $k$.\n\nThe solution for the mode amplitude after a time step $\\Delta t$ is an exponential growth or decay: $h_k(t+\\Delta t) = h_k(t) \\exp(\\omega(k) \\Delta t)$. The spectral power, defined as $S(k) = |h_k|^2$, consequently evolves as $S(k, t+\\Delta t) = S(k, t) \\exp(2\\omega(k) \\Delta t)$. The amplification factor $A(k)$ is the ratio $\\frac{S(k, t+\\Delta t)}{S(k, t)}$.\n\nThe algorithmic design directly implements this final expression:\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n\nThe solution proceeds as follows:\n1.  A function is defined to encapsulate the calculation for a single test case. This function takes the parameters $\\nu$, $K$, $\\Delta t$, and a list of wavenumbers $k$ as input.\n2.  For each value of $k$ in the input list, the program first computes the growth rate $\\omega(k) = \\nu k^2 - K k^4$. The term $\\nu k^2$ represents the instability driven by curvature-dependent erosion, while the term $-K k^4$ represents stabilization due to surface diffusion. The competition between these two terms determines whether a mode grows ($\\omega(k) > 0$), decays ($\\omega(k) < 0$), or remains neutral ($\\omega(k) = 0$).\n3.  Next, the argument of the exponential function, $2 \\omega(k) \\Delta t$, is calculated. This represents the total growth of the spectral power over the time step $\\Delta t$.\n4.  The amplification factor $A(k)$ is then computed using the exponential function `numpy.exp()`, which is well-suited for scientific computation involving floating-point numbers.\n5.  The computed value of $A(k)$ is rounded to six decimal places as required.\n6.  This process is repeated for all $k$ values in a given test case, and the results are collected into a list.\n7.  The main program structure iterates through all specified test cases, calls the calculation function for each, and aggregates the resulting lists.\n8.  Finally, the results are formatted into a single string that strictly adheres to the required output format: a list of lists, with numbers formatted to six decimal places, represented as `[[...],[...],...]`.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor A(k) for surface roughness modes\n    based on the linearized Bradley-Harper model for several test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1: (nu, K, dt, k_list)\n        (1.0e-12, 2.0e-36, 1.0e-4, [1.0e6, 5.0e6, 1.0e7, 5.0e7, 1.0e8]),\n        # Test case 2:\n        (1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 1.0e9, 2.0e9]),\n        # Test case 3:\n        (-1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 5.0e8, 1.0e9]),\n        # Test case 4:\n        (5.0e-19, 1.0e-36, 1.0e-1, [5.0e8, 7.0e8, 1.0e9]),\n    ]\n\n    all_results = []\n    for nu, K, dt, k_list in test_cases:\n        case_results = []\n        for k in k_list:\n            # Calculate the dispersion relation (growth rate) for the mode k.\n            # omega(k) = nu * k^2 - K * k^4\n            omega_k = nu * k**2 - K * k**4\n\n            # Calculate the amplification factor A(k) for the spectral power.\n            # A(k) = exp(2 * omega(k) * dt)\n            amplification_factor = np.exp(2 * omega_k * dt)\n            \n            # The problem asks for rounding to six decimal places.\n            # We will handle formatting to six places in the output string.\n            case_results.append(amplification_factor)\n        \n        all_results.append(case_results)\n\n    # Format the final output string precisely as requested:\n    # [[val1,val2,...],[val1,val2,...],...]\n    # using .6f to ensure six decimal places are always shown.\n    result_strings = []\n    for case_res in all_results:\n        inner_str = '[' + ','.join(f'{x:.6f}' for x in case_res) + ']'\n        result_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(result_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice shifts from solid surfaces to the behavior of liquid metals, a promising concept for next-generation plasma-facing components. Here, material migration occurs not just atom-by-atom, but through bulk fluid motion driven by powerful electromagnetic forces. This problem asks you to model the magnetohydrodynamic (MHD) flow of a thin melt layer subjected to a $\\mathbf{J}\\times\\mathbf{B}$ force, providing insight into the large-scale material displacement that can occur during transient events in a fusion device .",
            "id": "4050332",
            "problem": "A thin liquid-metal melt layer forms on a fusion divertor surface during a high-heat-flux event. The layer of thickness $h$ is subject to a surface-parallel electric current density $\\mathbf{J}$ and a magnetic field $\\mathbf{B}$ that is normal to the surface, producing a uniform magnetohydrodynamic (MHD) body force density $\\mathbf{f} = \\mathbf{J}\\times\\mathbf{B}$ directed along the surface. Assume the melt behaves as an incompressible Newtonian fluid of dynamic viscosity $\\mu$, with constant properties during the event, negligible inertia, negligible capillary pressure gradients along the flow direction, and negligible thermocapillary (Marangoni) stresses. The substrate at $y=0$ imposes a no-slip boundary condition, and the free surface at $y=h$ is shear-stress free. The transient forcing is a rectangular pulse of duration $t_p$, with $\\mathbf{J}$ and $\\mathbf{B}$ constant during the pulse and zero afterward. Using only the incompressible Navier–Stokes equations and the stated boundary conditions, derive the free-surface speed $v_s$ during the pulse and the free-surface displacement $\\Delta x_s$ accumulated over the pulse.\n\nTake the following values: $|\\mathbf{B}| = 5\\,\\text{T}$, $|\\mathbf{J}| = 1.0\\times 10^{6}\\,\\text{A/m}^{2}$ with $\\mathbf{J}\\perp\\mathbf{B}$, melt-layer thickness $h = 2.0\\times 10^{-4}\\,\\text{m}$, and pulse duration $t_p = 2.0\\times 10^{-3}\\,\\text{s}$. Express the final speed in $\\mathrm{m/s}$ and the final displacement in $\\mathrm{mm}$. Provide your final results as closed-form analytic expressions in terms of $\\mu$ with the given numerical parameters substituted.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **System:** A thin liquid-metal melt layer of thickness $h$.\n-   **Electromagnetic Forcing:** A surface-parallel electric current density $\\mathbf{J}$ and a normal magnetic field $\\mathbf{B}$ produce a uniform body force density $\\mathbf{f} = \\mathbf{J}\\times\\mathbf{B}$ along the surface.\n-   **Fluid Properties:** Incompressible Newtonian fluid with dynamic viscosity $\\mu$.\n-   **Assumptions:** Constant properties, negligible inertia, negligible capillary pressure gradients, negligible thermocapillary stresses.\n-   **Boundary Conditions:** No-slip at the substrate ($y=0$), shear-stress free at the free surface ($y=h$).\n-   **Transient Forcing:** A rectangular pulse of duration $t_p$. $\\mathbf{J}$ and $\\mathbf{B}$ are constant for $0 \\le t \\le t_p$ and zero otherwise.\n-   **Governing Equations:** Incompressible Navier–Stokes equations.\n-   **Numerical Values:** $|\\mathbf{B}| = 5\\,\\text{T}$, $|\\mathbf{J}| = 1.0\\times 10^{6}\\,\\text{A/m}^{2}$, $\\mathbf{J}\\perp\\mathbf{B}$, $h = 2.0\\times 10^{-4}\\,\\text{m}$, $t_p = 2.0\\times 10^{-3}\\,\\text{s}$.\n-   **Required Output:** Free-surface speed $v_s$ (in m/s) and displacement $\\Delta x_s$ (in mm) as analytic expressions in terms of $\\mu$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes magnetohydrodynamic (MHD) flow, a standard topic in fusion engineering. The governing equation is specified (Navier-Stokes), and the assumptions (e.g., negligible inertia, incompressible flow) are common simplifications used to make such problems tractable. The assumption of \"negligible inertia\" for a \"transient forcing\" is not contradictory; it implies that the flow is quasi-static, meaning the velocity profile adjusts instantaneously to changes in the applied force. This simplifies the transient problem to a steady-state problem during the pulse. The boundary conditions are well-defined. All parameters are given with consistent units. The problem is scientifically sound, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now commence.\n\n### Derivation\n\nWe model the flow of the liquid-metal layer. Let the $x$-axis be aligned with the direction of the body force $\\mathbf{f}$ (parallel to the surface) and the $y$-axis be normal to the surface, with $y=0$ at the substrate and $y=h$ at the free surface. The flow is assumed to be one-dimensional, with the velocity vector given by $\\mathbf{v} = v(y,t) \\hat{\\mathbf{i}}$.\n\nThe incompressible Navier–Stokes equation is:\n$$ \\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{v} + \\mathbf{f} $$\nwhere $\\rho$ is the density, $p$ is the pressure, $\\mu$ is the dynamic viscosity, and $\\mathbf{f}$ is the body force density.\n\nWe apply the simplifying assumptions:\n1.  **Flow is directed along $x$**: $\\mathbf{v} = v(y,t) \\hat{\\mathbf{i}}$. The continuity equation $\\nabla \\cdot \\mathbf{v} = 0$ implies $\\frac{\\partial v}{\\partial x} = 0$, so $v$ is not a function of $x$. We assume uniformity in the $z$-direction, so $v=v(y,t)$.\n2.  **Negligible inertia**: The entire left-hand side is negligible, $\\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right) \\approx \\mathbf{0}$. This reduces the Navier-Stokes equation to the Stokes equation. This key assumption implies that the velocity profile responds instantaneously to the forcing. During the pulse ($0 < t \\le t_p$), where the force is constant, the flow is steady.\n3.  **Pressure gradient**: The assumption of negligible capillary pressure gradients along the flow direction, typical for thin film flows on a flat surface, implies we can take the pressure gradient $\\frac{\\partial p}{\\partial x}$ to be zero.\n4.  **Body Force**: The force is $\\mathbf{f} = \\mathbf{J}\\times\\mathbf{B}$. Since $\\mathbf{J} \\perp \\mathbf{B}$, its magnitude is constant during the pulse: $f = |\\mathbf{f}| = |\\mathbf{J}||\\mathbf{B}|$. The force acts in the $x$-direction.\n\nWith these simplifications, the $x$-component of the Stokes equation for the velocity profile $v(y)$ during the pulse becomes:\n$$ 0 = \\mu \\frac{d^2 v}{dy^2} + f $$\nThis can be rewritten as:\n$$ \\frac{d^2 v}{dy^2} = -\\frac{f}{\\mu} $$\nThe boundary conditions are:\n1.  No-slip at the substrate ($y=0$): $v(0) = 0$.\n2.  Shear-stress free at the free surface ($y=h$): $\\tau_{yx}|_{y=h} = \\mu \\frac{dv}{dy}|_{y=h} = 0$, which implies $\\frac{dv}{dy}|_{y=h} = 0$.\n\nWe integrate the differential equation twice with respect to $y$. The first integration yields:\n$$ \\frac{dv}{dy} = -\\frac{f}{\\mu}y + C_1 $$\nApplying the shear-free boundary condition at $y=h$:\n$$ \\frac{dv}{dy}(h) = -\\frac{f}{\\mu}h + C_1 = 0 \\implies C_1 = \\frac{fh}{\\mu} $$\nThus, the velocity gradient is:\n$$ \\frac{dv}{dy} = \\frac{f}{\\mu}(h-y) $$\nThe second integration yields the velocity profile:\n$$ v(y) = \\int \\frac{f}{\\mu}(h-y) dy = \\frac{f}{\\mu}\\left(hy - \\frac{y^2}{2}\\right) + C_2 $$\nApplying the no-slip boundary condition at $y=0$:\n$$ v(0) = \\frac{f}{\\mu}\\left(0 - 0\\right) + C_2 = 0 \\implies C_2 = 0 $$\nThe velocity profile during the pulse ($0 < t \\le t_p$) is therefore:\n$$ v(y) = \\frac{f}{\\mu}\\left(hy - \\frac{y^2}{2}\\right) $$\nThe free-surface speed, $v_s$, is the velocity at $y=h$:\n$$ v_s = v(h) = \\frac{f}{\\mu}\\left(h^2 - \\frac{h^2}{2}\\right) = \\frac{fh^2}{2\\mu} $$\nBecause of the negligible inertia assumption, this speed is constant for the duration of the pulse $t_p$ and is zero immediately after the pulse.\n\nThe total displacement of the free surface, $\\Delta x_s$, is the integral of the surface speed over time. Since $v_s$ is constant during the pulse and zero otherwise:\n$$ \\Delta x_s = \\int_0^{t_p} v_s dt = v_s t_p = \\frac{fh^2t_p}{2\\mu} $$\nNow, we substitute $f=|\\mathbf{J}||\\mathbf{B}|$ and the given numerical values.\nThe magnitude of the force density is:\n$$ f = |\\mathbf{J}||\\mathbf{B}| = (1.0\\times 10^{6}\\,\\text{A/m}^{2})(5\\,\\text{T}) = 5.0\\times 10^{6}\\,\\text{N/m}^{3} $$\nThe surface speed $v_s$ is:\n$$ v_s = \\frac{f h^2}{2\\mu} = \\frac{(5.0\\times 10^{6}\\,\\text{N/m}^{3})(2.0\\times 10^{-4}\\,\\text{m})^2}{2\\mu} = \\frac{(5.0\\times 10^{6})(4.0\\times 10^{-8})}{2\\mu}\\,\\frac{\\text{m}}{\\text{s}} $$\n$$ v_s = \\frac{20.0\\times 10^{-2}}{2\\mu}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{0.2}{2\\mu}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{0.1}{\\mu}\\,\\frac{\\text{m}}{\\text{s}} $$\nThe problem requests the final expression for $v_s$ in units of m/s, so the expression is $\\frac{0.1}{\\mu}$.\n\nThe surface displacement $\\Delta x_s$ is:\n$$ \\Delta x_s = v_s t_p = \\left(\\frac{0.1}{\\mu}\\right) (2.0\\times 10^{-3}\\,\\text{s}) = \\frac{0.2\\times 10^{-3}}{\\mu}\\,\\text{m} = \\frac{2.0\\times 10^{-4}}{\\mu}\\,\\text{m} $$\nThe problem requests the final displacement $\\Delta x_s$ in units of millimeters (mm). We convert the result:\n$$ \\Delta x_s = \\left(\\frac{2.0\\times 10^{-4}}{\\mu}\\right)\\,\\text{m} \\times \\left(\\frac{1000\\,\\text{mm}}{1\\,\\text{m}}\\right) = \\frac{2.0\\times 10^{-1}}{\\mu}\\,\\text{mm} = \\frac{0.2}{\\mu}\\,\\text{mm} $$\nThe expression for $\\Delta x_s$ in mm is $\\frac{0.2}{\\mu}$.\n\nThe final answers are the analytical expressions for $v_s$ and $\\Delta x_s$ in terms of $\\mu$.\n-   Free-surface speed: $v_s = \\frac{0.1}{\\mu}$ (in m/s)\n-   Free-surface displacement: $\\Delta x_s = \\frac{0.2}{\\mu}$ (in mm)",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{0.1}{\\mu} & \\frac{0.2}{\\mu}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}