{
    "hands_on_practices": [
        {
            "introduction": "Physical sputtering is a primary erosion mechanism for plasma-facing components in fusion devices. This exercise  delves into quantifying erosion under realistic mixed-species plasma bombardment, composed here of deuterium (D) and helium (He) ions. You will apply the fundamental definition of sputtering yield to establish a linear-mixing baseline and then use it to quantify non-linear synergistic effects, a critical aspect of understanding and predicting material performance.",
            "id": "4050382",
            "problem": "A polycrystalline tungsten surface in a magnetically confined fusion device is exposed to a steady, mixed ion flux composed of deuterium (D) and helium (He). Assume a stationary regime where surface temperature is low enough that thermal desorption is negligible and where prompt re-deposition is negligible. Let the incident ion energies and incidence angle be $E_{D}=200\\ \\text{eV}$, $E_{\\mathrm{He}}=600\\ \\text{eV}$, and $\\theta=60^{\\circ}$ from the surface normal. The ion fluxes to the surface are $\\Gamma_{D}=7.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$ and $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$.\n\nBy definition, the sputtering yield $Y_{i}(E_{i},\\theta)$ of species $i$ is the number of target atoms removed per incident ion of species $i$ at energy $E_{i}$ and incidence angle $\\theta$. Under the assumption that, in the absence of cross-coupling between species, the emission rate density is the sum of the independent contributions from each ion species, the flux-weighted mixed yield is defined by the ratio of the total emission rate density to the total incident ion flux. Use this definition to derive the linear-mixing prediction $Y_{\\text{mix}}$ in terms of flux fractions and the mono-species yields.\n\nUnder identical surface state and geometry, single-species measurements provide the following mono-species yields at the stated $E_{i}$ and $\\theta$: $Y_{D}(E_{D},\\theta)=0.015$ and $Y_{\\mathrm{He}}(E_{\\mathrm{He}},\\theta)=0.420$. A co-bombardment experiment at the same $E_{i}$ and $\\theta$ with the mixed D+He fluxes stated above reports a measured mixed yield $Y_{\\text{meas}}=0.273$.\n\nStarting from the definition of sputtering yield and conservation of particle fluxes to and from the surface, (i) derive the expression for the linear-mixing prediction $Y_{\\text{mix}}$ in terms of flux fractions $x_{i}$ and mono-species yields $Y_{i}(E_{i},\\theta)$, and compute its numerical value from the provided data; (ii) quantify the synergistic effect of co-bombardment by defining the multiplicative synergy factor $\\eta$ as the ratio of the measured mixed yield to the linear-mixing prediction, $\\eta=Y_{\\text{meas}}/Y_{\\text{mix}}$, and compute its numerical value.\n\nExpress your final answer as the single number $\\eta$ (dimensionless) rounded to four significant figures.",
            "solution": "The problem is evaluated to be physically sound, well-posed, and contains all necessary information for a unique solution. The concepts of sputtering yield, ion flux, and linear mixing are standard in the field of plasma-surface interactions.\n\nThe solution is divided into two main parts as requested: (i) the derivation and calculation of the linear-mixing prediction for the mixed-species sputtering yield, $Y_{\\text{mix}}$, and (ii) the calculation of the multiplicative synergy factor, $\\eta$.\n\n(i) Derivation and computation of the linear-mixing sputtering yield, $Y_{\\text{mix}}$.\n\nThe sputtering yield for a single ion species $i$, denoted $Y_i$, is defined as the number of target atoms ejected per incident ion. This can be expressed as a ratio of fluxes: the flux of sputtered target atoms, $\\Gamma_{\\text{emitted}, i}$, to the incident ion flux, $\\Gamma_i$.\n$$Y_i = \\frac{\\Gamma_{\\text{emitted}, i}}{\\Gamma_i}$$\nFrom this definition, the flux of emitted atoms due to bombardment by species $i$ is $\\Gamma_{\\text{emitted}, i} = Y_i \\Gamma_i$.\n\nThe problem states that for the linear-mixing model, the total emission rate density (total flux of emitted atoms, $\\Gamma_{\\text{emitted, total}}$) is assumed to be the sum of the independent contributions from each ion species. For the given mixture of deuterium ($D$) and helium ($He$), the total emitted flux is:\n$$\\Gamma_{\\text{emitted, total}} = \\Gamma_{\\text{emitted, D}} + \\Gamma_{\\text{emitted, He}} = Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}$$\nwhere $Y_{D}$ and $Y_{\\mathrm{He}}$ are the mono-species sputtering yields for deuterium and helium, respectively, and $\\Gamma_{D}$ and $\\Gamma_{\\mathrm{He}}$ are their corresponding incident ion fluxes.\n\nThe total incident ion flux, $\\Gamma_{\\text{total}}$, is the sum of the individual ion fluxes:\n$$\\Gamma_{\\text{total}} = \\Gamma_{D} + \\Gamma_{\\mathrm{He}}$$\nThe problem defines the flux-weighted mixed yield, $Y_{\\text{mix}}$, as the ratio of the total emission rate density to the total incident ion flux.\n$$Y_{\\text{mix}} = \\frac{\\Gamma_{\\text{emitted, total}}}{\\Gamma_{\\text{total}}} = \\frac{Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\nTo express this in terms of flux fractions, we define the fraction of each species in the total flux. The flux fraction for deuterium, $x_{D}$, and for helium, $x_{\\mathrm{He}}$, are:\n$$x_{D} = \\frac{\\Gamma_{D}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\n$$x_{\\mathrm{He}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\nSubstituting these definitions into the expression for $Y_{\\text{mix}}$:\n$$Y_{\\text{mix}} = \\frac{Y_{D} \\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} + \\frac{Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} = Y_{D} x_{D} + Y_{\\mathrm{He}} x_{\\mathrm{He}}$$\nThis is the required expression for the linear-mixing prediction in terms of flux fractions and mono-species yields.\n\nNow, we compute the numerical value of $Y_{\\text{mix}}$ using the provided data.\nThe incident ion fluxes are $\\Gamma_{D}=7.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$ and $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$.\nThe total incident ion flux is:\n$$\\Gamma_{\\text{total}} = (7.0 \\times 10^{19} + 3.0 \\times 10^{19})\\ \\text{m}^{-2}\\ \\text{s}^{-1} = 10.0 \\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1} = 1.0 \\times 10^{20}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$$\nThe flux fractions are:\n$$x_{D} = \\frac{7.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.7$$\n$$x_{\\mathrm{He}} = \\frac{3.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.3$$\nThe mono-species yields are given as $Y_{D} = 0.015$ and $Y_{\\mathrm{He}} = 0.420$. The specific energy $E_i$ and angle $\\theta$ arguments are omitted for brevity as they are constant throughout the problem.\n$$Y_{\\text{mix}} = x_{D} Y_{D} + x_{\\mathrm{He}} Y_{\\mathrm{He}} = (0.7)(0.015) + (0.3)(0.420)$$\n$$Y_{\\text{mix}} = 0.0105 + 0.1260 = 0.1365$$\n\n(ii) Quantification of the synergistic effect, $\\eta$.\n\nThe problem defines the multiplicative synergy factor $\\eta$ as the ratio of the measured mixed yield, $Y_{\\text{meas}}$, to the linear-mixing prediction, $Y_{\\text{mix}}$.\n$$\\eta = \\frac{Y_{\\text{meas}}}{Y_{\\text{mix}}}$$\nThe measured mixed yield is given as $Y_{\\text{meas}} = 0.273$.\nUsing the value of $Y_{\\text{mix}}$ calculated above:\n$$\\eta = \\frac{0.273}{0.1365}$$\n$$\\eta = 2.0$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\\eta = 2.000$$\nThis value indicates a strong synergistic effect, where the co-bombardment of deuterium and helium results in a sputtering yield that is twice as large as would be expected from a simple linear combination of their individual effects.",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "The erosion and redeposition of material continuously reshape the surface of a plasma-facing component, often leading to the spontaneous formation of complex patterns. This computational practice  explores this phenomenon using the linearized Bradley-Harper (BH) equation, a foundational model that captures the interplay between ion-induced instability (a term proportional to $\\nu k^2$) and surface diffusion smoothing (a term proportional to $-K k^4$). By calculating the amplification factor $A(k)$ for different spatial modes, you will gain hands-on experience with the spectral methods used to analyze and predict surface morphological evolution.",
            "id": "4050333",
            "problem": "Consider a one-dimensional plasma-facing surface with height field $h(x,t)$ evolving under the linearized Bradley-Harper (BH) model of ion-induced erosion and surface diffusion. You are given an initial roughness spectrum $S(k)$ sampled at discrete wavenumbers $k$, and your task is to simulate a single time step of the spectral evolution under BH linear dynamics and compute the amplification of each mode.\n\nFundamental base and assumptions:\n- Begin from mass conservation of surface material, small-slope approximation, and linear response of erosion to curvature.\n- The Bradley-Harper (BH) linearized evolution equation in one spatial dimension is\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4},\n$$\nwhere $x$ is position along the surface, $t$ is time, $\\nu$ is the curvature-dependent erosion coefficient (units $\\mathrm{m}^2/\\mathrm{s}$; $\\nu>0$ corresponds to destabilization, $\\nu<0$ corresponds to stabilization), and $K$ is the effective surface diffusion coefficient (units $\\mathrm{m}^4/\\mathrm{s}$; $K>0$ provides high-wavenumber smoothing).\n\n- Let $h_k(t)$ denote the spatial Fourier mode of $h$ at wavenumber $k$ with Fourier convention $h(x,t) = \\int h_k(t) e^{ikx} \\, dk$. Linearizing and transforming to Fourier space yields the ordinary differential equation for each mode:\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k,\n$$\nwith dispersion relation\n$$\n\\omega(k) = \\nu k^2 - K k^4,\n$$\nwhich has units of $\\mathrm{s}^{-1}$.\n\n- The mode amplitude solution over a time step $\\Delta t$ is\n$$\nh_k(t+\\Delta t) = h_k(t)\\, \\exp\\big(\\omega(k)\\, \\Delta t\\big).\n$$\nDefine the roughness spectrum $S(k)$ as the squared amplitude $S(k) = |h_k|^2$ (dimension depends on normalization, but the amplification factor for $S(k)$ is dimensionless). Then the spectral update over a single time step is\n$$\nS(k, t+\\Delta t) = S(k, t) \\, \\exp\\big(2\\, \\omega(k)\\, \\Delta t\\big).\n$$\nTherefore, the amplification factor of the spectral power for each mode is\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big).\n$$\n\nYour program must compute $A(k)$ for given sets of $(\\nu, K, \\Delta t)$ and discrete $k$ lists and produce the amplification values for each test case. Although the initial $S(k)$ is provided to define a complete physical scenario, only the amplification $A(k)$ needs to be returned by your program.\n\nPhysical and numerical units and output requirements:\n- Use $k$ in $\\mathrm{m}^{-1}$, time step $\\Delta t$ in $\\mathrm{s}$, $\\nu$ in $\\mathrm{m}^2/\\mathrm{s}$, and $K$ in $\\mathrm{m}^4/\\mathrm{s}$.\n- The amplification $A(k)$ is dimensionless. Express the amplification values as floating point numbers rounded to six decimal places.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the per-mode amplification values in the order of the provided $k$ list. For example: `[ [a_1, a_2], [b_1, b_2, b_3] ]`.\n\nTest suite:\nCompute the amplification $A(k)$ for the following parameter sets. Each test case provides $(\\nu, K, \\Delta t)$, an explicit $k$ list, and an initial $S(k)$ list. Only $A(k)$ must be output.\n\n- Test case $1$ (destabilizing at intermediate $k$):\n  - $\\nu = 1.0 \\times 10^{-12}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 2.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-4}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{6},\\, 5.0 \\times 10^{6},\\, 1.0 \\times 10^{7},\\, 5.0 \\times 10^{7},\\, 1.0 \\times 10^{8}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[1.0 \\times 10^{-18},\\, 2.5 \\times 10^{-18},\\, 3.0 \\times 10^{-18},\\, 1.5 \\times 10^{-18},\\, 1.0 \\times 10^{-18}]$.\n\n- Test case $2$ (near-neutral and stabilizing at high $k$):\n  - $\\nu = 1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{8},\\, 1.0 \\times 10^{9},\\, 2.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[5.0 \\times 10^{-19},\\, 2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19}]$.\n\n- Test case $3$ (stabilizing curvature, mixed neutral mode):\n  - $\\nu = -1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ list: $[1.0 \\times 10^{8},\\, 5.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19},\\, 8.0 \\times 10^{-20}]$.\n\n- Test case $4$ (longer time step, mixed stability across $k$):\n  - $\\nu = 5.0 \\times 10^{-19}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-1}\\ \\mathrm{s}$,\n  - $k$ list: $[5.0 \\times 10^{8},\\, 7.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ initial: $[1.0 \\times 10^{-19},\\, 1.5 \\times 10^{-19},\\, 2.0 \\times 10^{-19}]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of amplification values for the corresponding test case, each rounded to six decimal places. For instance, the output must look like `[[...],[...],[...],[...]]` with no additional text.",
            "solution": "The user-provided problem has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **Governing Equation (Linearized Bradley-Harper):**\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4}\n$$\n- **Parameters:**\n  - $h(x,t)$: surface height field.\n  - $\\nu$: curvature-dependent erosion coefficient ($\\mathrm{m}^2/\\mathrm{s}$).\n  - $K$: effective surface diffusion coefficient ($\\mathrm{m}^4/\\mathrm{s}$).\n- **Fourier Mode ODE:**\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k\n$$\n- **Dispersion Relation:**\n$$\n\\omega(k) = \\nu k^2 - K k^4\n$$\n- **Target Quantity (Amplification Factor of Spectral Power $S(k) = |h_k|^2$):**\n$$\nA(k) = \\frac{S(k, t+\\Delta t)}{S(k, t)} = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n- **Test Cases:**\n  1.  **Case 1:** $\\nu = 1.0 \\times 10^{-12}$, $K = 2.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-4}$, $k = [10^6, 5 \\times 10^6, 10^7, 5 \\times 10^7, 10^8]$.\n  2.  **Case 2:** $\\nu = 1.0 \\times 10^{-18}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-2}$, $k = [10^8, 10^9, 2 \\times 10^9]$.\n  3.  **Case 3:** $\\nu = -1.0 \\times 10^{-18}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-2}$, $k = [10^8, 5 \\times 10^8, 10^9]$.\n  4.  **Case 4:** $\\nu = 5.0 \\times 10^{-19}$, $K = 1.0 \\times 10^{-36}$, $\\Delta t = 1.0 \\times 10^{-1}$, $k = [5 \\times 10^8, 7 \\times 10^8, 10^9]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed as **valid**.\n- **Scientifically Grounded:** The problem is based on the linearized Bradley-Harper equation, a standard and well-established model in surface science and plasma-material interaction for describing ion-induced pattern formation.\n- **Well-Posed:** The problem is well-posed, providing a direct formula for the quantity to be calculated, $A(k)$, and all necessary parameters. For each set of inputs, a unique and stable solution exists.\n- **Objective:** The problem is stated in precise, objective language with clearly defined physical quantities, units, and mathematical relationships.\n- **Complete and Consistent:** All necessary data ($\\nu, K, \\Delta t$, lists of $k$) are provided for each test case. The units are dimensionally consistent. The contextual information about $S(k)$ is explicitly marked as not needed for the calculation, which is a clarification, not a contradiction.\n- **Realistic and Feasible:** The numerical values of the physical parameters are within plausible orders of magnitude for nanotechnology and surface science applications.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Principle-Based Design of the Solution\nThe core task is to compute the amplification factor, $A(k)$, for the spectral power of surface roughness, which is governed by the linearized Bradley-Harper (BH) model. The problem provides the final analytical expression for this factor, derived from the model's governing partial differential equation through Fourier analysis.\n\nThe fundamental principle is that in a linear system, different spatial frequency components (Fourier modes) evolve independently. The evolution of each mode $h_k$ is described by a simple first-order ordinary differential equation, $\\frac{d h_k}{d t} = \\omega(k)\\, h_k$, where $\\omega(k)$ is the dispersion relation, or growth rate, of the mode with wavenumber $k$.\n\nThe solution for the mode amplitude after a time step $\\Delta t$ is an exponential growth or decay: $h_k(t+\\Delta t) = h_k(t) \\exp(\\omega(k) \\Delta t)$. The spectral power, defined as $S(k) = |h_k|^2$, consequently evolves as $S(k, t+\\Delta t) = S(k, t) \\exp(2\\omega(k) \\Delta t)$. The amplification factor $A(k)$ is the ratio $\\frac{S(k, t+\\Delta t)}{S(k, t)}$.\n\nThe algorithmic design directly implements this final expression:\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n\nThe solution proceeds as follows:\n1.  A function is defined to encapsulate the calculation for a single test case. This function takes the parameters $\\nu$, $K$, $\\Delta t$, and a list of wavenumbers $k$ as input.\n2.  For each value of $k$ in the input list, the program first computes the growth rate $\\omega(k) = \\nu k^2 - K k^4$. The term $\\nu k^2$ represents the instability driven by curvature-dependent erosion, while the term $-K k^4$ represents stabilization due to surface diffusion. The competition between these two terms determines whether a mode grows ($\\omega(k) > 0$), decays ($\\omega(k) < 0$), or remains neutral ($\\omega(k) = 0$).\n3.  Next, the argument of the exponential function, $2 \\omega(k) \\Delta t$, is calculated. This represents the total growth of the spectral power over the time step $\\Delta t$.\n4.  The amplification factor $A(k)$ is then computed using the exponential function `numpy.exp()`, which is well-suited for scientific computation involving floating-point numbers.\n5.  The computed value of $A(k)$ is rounded to six decimal places as required.\n6.  This process is repeated for all $k$ values in a given test case, and the results are collected into a list.\n7.  The main program structure iterates through all specified test cases, calls the calculation function for each, and aggregates the resulting lists.\n8.  Finally, the results are formatted into a single string that strictly adheres to the required output format: a list of lists, with numbers formatted to six decimal places, represented as `[[...],[...],...]`.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor A(k) for surface roughness modes\n    based on the linearized Bradley-Harper model for several test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1: (nu, K, dt, k_list)\n        (1.0e-12, 2.0e-36, 1.0e-4, [1.0e6, 5.0e6, 1.0e7, 5.0e7, 1.0e8]),\n        # Test case 2:\n        (1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 1.0e9, 2.0e9]),\n        # Test case 3:\n        (-1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 5.0e8, 1.0e9]),\n        # Test case 4:\n        (5.0e-19, 1.0e-36, 1.0e-1, [5.0e8, 7.0e8, 1.0e9]),\n    ]\n\n    all_results = []\n    for nu, K, dt, k_list in test_cases:\n        case_results = []\n        for k in k_list:\n            # Calculate the dispersion relation (growth rate) for the mode k.\n            # omega(k) = nu * k^2 - K * k^4\n            omega_k = nu * k**2 - K * k**4\n\n            # Calculate the amplification factor A(k) for the spectral power.\n            # A(k) = exp(2 * omega(k) * dt)\n            amplification_factor = np.exp(2 * omega_k * dt)\n            \n            # The problem asks for rounding to six decimal places.\n            # We will handle formatting to six places in the output string.\n            case_results.append(amplification_factor)\n        \n        all_results.append(case_results)\n\n    # Format the final output string precisely as requested:\n    # [[val1,val2,...],[val1,val2,...],...]\n    # using .6f to ensure six decimal places are always shown.\n    result_strings = []\n    for case_res in all_results:\n        inner_str = '[' + ','.join(f'{x:.6f}' for x in case_res) + ']'\n        result_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(result_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "In a fusion device, the evolution of a material surface and the dynamics of the adjacent plasma edge are inextricably linked, forming a complex, coupled system. This advanced computational exercise  tasks you with building a simplified, yet physically sound, coupled solver to model the feedback loop between wall sputtering, impurity cloud formation, and material redeposition. Implementing the specified data-exchange protocol will provide crucial insights into the architecture of multi-physics simulations and the numerical challenges, such as conservation errors, that arise from operator splitting.",
            "id": "4050334",
            "problem": "Consider a simplified, yet scientifically sound, coupling between a surface erosion solver representing a Plasma-Facing Component and an edge transport solver representing near-wall impurity cloud evolution in a fusion device. Let the wall material be tungsten. Work per unit area and assume spatial uniformity (no spatial gradients). The fundamental base is mass continuity and kinetic flux relations.\n\nDefine the following per-unit-area state variables in kilograms per square meter: wall areal mass $P_w(t)$, edge cloud areal mass $M_e(t)$, and cumulative sink areal mass $M_{\\mathrm{sink}}(t)$ that represents material transported irreversibly away from the near-wall region. The wall height $H(t)$ in meters is $H(t) = P_w(t)/\\rho_m$, where $\\rho_m$ is the bulk mass density of the wall material.\n\nAssume the incident plasma particle flux to the wall is attenuated by the edge cloud according to a simple opacity model,\n$$\n\\Gamma_{\\mathrm{in}}(t) = \\Gamma_0 \\exp\\!\\big(-\\sigma M_e(t)\\big),\n$$\nwith $\\Gamma_0$ the unattenuated incident flux in $\\mathrm{m}^{-2}\\mathrm{s}^{-1}$, and $\\sigma$ an attenuation coefficient in $\\mathrm{m}^2\\mathrm{kg}^{-1}$. The sputtered mass flux leaving the wall is given by\n$$\nJ_{\\mathrm{sput}}(t) = Y\\,\\Gamma_{\\mathrm{in}}(t)\\,m_m,\n$$\nwhere $Y$ is the sputter yield (dimensionless, number of sputtered atoms per incident particle) and $m_m$ is the atomic mass of tungsten in kilograms.\n\nModel redeposition and transport in the edge cloud by a linear deposition rate $k_{\\mathrm{dep}}$ in $\\mathrm{s}^{-1}$ and a transport loss with timescale $\\tau_e$ in seconds:\n$$\nJ_{\\mathrm{dep}}(t) = k_{\\mathrm{dep}}\\,M_e(t),\\qquad J_{\\mathrm{loss}}(t) = \\frac{M_e(t)}{\\tau_e}.\n$$\nThe continuous-time coupled mass balance equations per unit area are\n$$\n\\frac{dP_w}{dt} = -J_{\\mathrm{sput}}(t) + J_{\\mathrm{dep}}(t),\n$$\n$$\n\\frac{dM_e}{dt} = J_{\\mathrm{sput}}(t) - J_{\\mathrm{dep}}(t) - J_{\\mathrm{loss}}(t),\n$$\n$$\n\\frac{dM_{\\mathrm{sink}}}{dt} = J_{\\mathrm{loss}}(t),\n$$\nwhich imply exact conservation of total mass $P_w(t) + M_e(t) + M_{\\mathrm{sink}}(t)$.\n\nImplement an explicit time-integration coupling algorithm between two solvers that enforce the following data exchange protocol at a specified exchange frequency:\n- At an exchange step, the edge transport solver computes $J_{\\mathrm{dep}}$ and $\\Gamma_{\\mathrm{in}}$ from its current $M_e$ and sends these to the surface erosion solver.\n- The surface erosion solver then computes $J_{\\mathrm{sput}}$ using the received $\\Gamma_{\\mathrm{in}}$ and updates $P_w$ using the received $J_{\\mathrm{dep}}$. It sends the computed $J_{\\mathrm{sput}}$ to the edge transport solver.\n- The edge transport solver finally updates $M_e$ and $M_{\\mathrm{sink}}$ using the received $J_{\\mathrm{sput}}$ and its $J_{\\mathrm{dep}}$.\n\nBetween exchange steps, each solver advances using the most recently exchanged quantities (i.e., values are held constant until the next exchange). Use forward Euler updates. Let $\\Delta t$ be the timestep and let the exchange frequency be every $k$ timesteps (i.e., an exchange happens when the timestep index $i$ satisfies $i \\bmod k = 0$). This staggered exchange introduces a splitting error which you must quantify via the residual of total mass conservation at the end of the simulation.\n\nConstants to use throughout:\n- Tungsten bulk mass density $\\rho_m = 1.925\\times 10^{4}\\ \\mathrm{kg}/\\mathrm{m}^{3}$.\n- Tungsten atomic mass $m_m = 3.056\\times 10^{-25}\\ \\mathrm{kg}$.\n- Unattenuated incident flux $\\Gamma_0 = 1.0\\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$.\n- Attenuation coefficient $\\sigma = 1.0\\times 10^{6}\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$.\n\nInitial conditions common to all tests:\n- Initial wall height $H_0 = 5.0\\times 10^{-4}\\ \\mathrm{m}$, thus $P_w(0) = \\rho_m H_0$.\n- Initial edge cloud mass $M_e(0) = 0$.\n- Initial sink mass $M_{\\mathrm{sink}}(0) = 0$.\n\nIntegration parameters common to all tests:\n- Total simulated time $T = 1.0\\times 10^{-3}\\ \\mathrm{s}$.\n- Timestep $\\Delta t = 1.0\\times 10^{-6}\\ \\mathrm{s}$.\n\nYou must construct a complete program that simulates the coupled system for the following test suite of parameter sets, each specified by the triplet $(Y, k_{\\mathrm{dep}}, \\tau_e)$ and integer exchange frequency $k$:\n\n- Test 1 (general case): $Y = 2.0\\times 10^{-2}$, $k_{\\mathrm{dep}} = 1.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 5.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 1$.\n- Test 2 (boundary case, zero sputtering): $Y = 0$, $k_{\\mathrm{dep}} = 1.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 5.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 10$.\n- Test 3 (edge case, coarse exchange and high yield): $Y = 2.0\\times 10^{-1}$, $k_{\\mathrm{dep}} = 2.0\\times 10^{2}\\ \\mathrm{s}^{-1}$, $\\tau_e = 1.0\\times 10^{-3}\\ \\mathrm{s}$, $k = 20$.\n- Test 4 (fast deposition and fast loss): $Y = 5.0\\times 10^{-2}$, $k_{\\mathrm{dep}} = 5.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 1.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 5$.\n\nFor each test, compute:\n- The final wall height $H(T)$ in meters.\n- The absolute residual in total mass conservation at $t=T$, defined as\n$$\nR = \\left| \\big(P_w(T) + M_e(T) + M_{\\mathrm{sink}}(T)\\big) - \\big(P_w(0) + M_e(0) + M_{\\mathrm{sink}}(0)\\big) \\right|\n$$\nin kilograms per square meter.\n\nExpress $H(T)$ in meters and $R$ in kilograms per square meter. Angles are not used in this problem. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list $[H(T), R]$. For example, the output format must be like\n[[h_1, r_1], [h_2, r_2], [h_3, r_3], [h_4, r_4]]\nwith numerical values replacing the symbols. No other text should be printed.",
            "solution": "The problem requires the simulation of a coupled system modeling plasma-surface interactions and edge impurity transport. The solution involves implementing a specified numerical scheme to solve the governing time-dependent equations.\n\nThe state of the system is described by three areal mass densities: the wall mass $P_w(t)$, the edge cloud mass $M_e(t)$, and the sink mass $M_{\\mathrm{sink}}(t)$. The governing dynamics are given by a set of coupled ordinary differential equations (ODEs):\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nP_w \\\\\nM_e \\\\\nM_{\\mathrm{sink}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-J_{\\mathrm{sput}}(t) + J_{\\mathrm{dep}}(t) \\\\\nJ_{\\mathrm{sput}}(t) - J_{\\mathrm{dep}}(t) - J_{\\mathrm{loss}}(t) \\\\\nJ_{\\mathrm{loss}}(t)\n\\end{pmatrix}\n$$\nThe fluxes are functions of the state variables, introducing nonlinear coupling:\n- Incident particle flux attenuation: $\\Gamma_{\\mathrm{in}}(t) = \\Gamma_0 \\exp(-\\sigma M_e(t))$\n- Sputtered mass flux: $J_{\\mathrm{sput}}(t) = Y\\,\\Gamma_{\\mathrm{in}}(t)\\,m_m$\n- Deposition mass flux: $J_{\\mathrm{dep}}(t) = k_{\\mathrm{dep}}\\,M_e(t)$\n- Transport loss mass flux: $J_{\\mathrm{loss}}(t) = M_e(t)/\\tau_e$\n\nThe continuous system exhibits exact mass conservation, as $\\frac{d}{dt}(P_w + M_e + M_{\\mathrm{sink}}) = 0$.\n\nThe numerical solution is constructed using a forward Euler time-stepping scheme with a timestep $\\Delta t$. Let the state at timestep $i$ be $(P_{w,i}, M_{e,i}, M_{\\mathrm{sink},i})$. A forward Euler update for a generic variable $X$ is $X_{i+1} = X_i + \\frac{dX}{dt}|_i \\Delta t$.\n\nA key aspect of the problem is the staggered data exchange protocol between the \"surface erosion solver\" (governing $P_w$) and the \"edge transport solver\" (governing $M_e$ and $M_{\\mathrm{sink}}$). Exchanges occur every $k$ timesteps. This introduces an operator splitting error, which we must quantify. The protocol dictates the following simulation algorithm:\n\nWe iterate through timesteps $i = 0, 1, \\dots, N-1$, where $N=T/\\Delta t$. At each step, we update the state from $(P_{w,i}, M_{e,i}, M_{\\mathrm{sink},i})$ to $(P_{w,i+1}, M_{e,i+1}, M_{\\mathrm{sink},i+1})$.\n\nFirst, we define the \"exchanged\" quantities, which are held constant between exchange steps. If an exchange occurs at step $i$ (i.e., $i \\bmod k = 0$), these quantities are re-evaluated.\n- Exchanged incident flux: $\\Gamma_{\\mathrm{in, exch}} = \\Gamma_0 \\exp(-\\sigma M_{e,i})$\n- Exchanged deposition flux: $J_{\\mathrm{dep, exch}} = k_{\\mathrm{dep}}M_{e,i}$\n- Exchanged sputtered flux: $J_{\\mathrm{sput, exch}} = Y \\Gamma_{\\mathrm{in, exch}} m_m$\n\nThese values, computed at the start of a $k$-step block, are used for the subsequent updates within that block.\n\nThe update for the state variables at each timestep $i$ proceeds as follows:\n1.  **Surface Solver Update**: The evolution of the wall mass $P_w$ depends on the exchanged fluxes. The solver uses the values frozen at the last exchange.\n    $$\n    P_{w,i+1} = P_{w,i} + (-J_{\\mathrm{sput, exch}} + J_{\\mathrm{dep, exch}}) \\Delta t\n    $$\n2.  **Edge Solver Update**: The edge solver uses the received sputtered flux $J_{\\mathrm{sput, exch}}$, but evaluates its own internal sink/source terms ($J_{\\mathrm{dep}}$ and $J_{\\mathrm{loss}}$) based on its current state $M_{e,i}$. This asymmetric update is the source of the numerical mass conservation error.\n    -   Current deposition flux: $J_{\\mathrm{dep, current}} = k_{\\mathrm{dep}} M_{e,i}$\n    -   Current loss flux: $J_{\\mathrm{loss, current}} = M_{e,i}/\\tau_e$\n    The updates for $M_e$ and $M_{\\mathrm{sink}}$ are therefore:\n    $$\n    M_{e,i+1} = M_{e,i} + (J_{\\mathrm{sput, exch}} - J_{\\mathrm{dep, current}} - J_{\\mathrm{loss, current}}) \\Delta t\n    $$\n    $$\n    M_{\\mathrm{sink},i+1} = M_{\\mathrm{sink},i} + J_{\\mathrm{loss, current}} \\Delta t\n    $$\n\nThe total mass at step $i+1$ is $M_{\\mathrm{tot}, i+1} = P_{w,i+1} + M_{e,i+1} + M_{\\mathrm{sink},i+1}$. The change in total mass over one timestep is:\n$$\n\\Delta M_{\\mathrm{tot}, i} = M_{\\mathrm{tot}, i+1} - M_{\\mathrm{tot}, i}\n$$\n$$\n\\Delta M_{\\mathrm{tot}, i} = \\Delta t \\left[ (-J_{\\mathrm{sput, exch}} + J_{\\mathrm{dep, exch}}) + (J_{\\mathrm{sput, exch}} - J_{\\mathrm{dep, current}} - J_{\\mathrm{loss, current}}) + (J_{\\mathrm{loss, current}}) \\right]\n$$\n$$\n\\Delta M_{\\mathrm{tot}, i} = \\Delta t (J_{\\mathrm{dep, exch}} - J_{\\mathrm{dep, current}})\n$$\nThis demonstrates that the scheme is not conservative. The error at each step arises from the discrepancy between the deposition flux used by the surface solver ($J_{\\mathrm{dep, exch}}$) and that used by the edge solver ($J_{\\mathrm{dep, current}}$).\n\nIf $k=1$, an exchange happens at every step. $J_{\\mathrm{dep, exch}}$ is calculated using $M_{e,i}$, and $J_{\\mathrm{dep, current}}$ is also calculated using $M_{e,i}$. Thus, $J_{\\mathrm{dep, exch}} = J_{\\mathrm{dep, current}}$, and the scheme becomes perfectly mass-conserving ($\\Delta M_{\\mathrm{tot}, i} = 0$), up to floating-point precision.\n\nIf $k>1$, $J_{\\mathrm{dep, exch}}$ is calculated using the mass $M_e$ from the beginning of the $k$-step block, while $J_{\\mathrm{dep, current}}$ uses the mass $M_{e,i}$ which evolves within the block. This difference leads to a non-zero mass residual.\n\nThe simulation starts from the initial conditions $P_w(0) = \\rho_m H_0 = (1.925\\times 10^4)(5.0\\times 10^{-4}) = 9.625 \\, \\mathrm{kg}/\\mathrm{m}^2$, $M_e(0)=0$, and $M_{\\mathrm{sink}}(0)=0$. We run the simulation for a total time $T$ with timestep $\\Delta t$. After the final step, we compute the final wall height $H(T) = P_w(T)/\\rho_m$ and the absolute total mass residual $R = |(P_w(T) + M_e(T) + M_{\\mathrm{sink}}(T)) - (P_w(0) + M_e(0) + M_{\\mathrm{sink}}(0))|$. This procedure is repeated for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a coupled plasma-surface interaction model for several test cases.\n    \"\"\"\n    \n    # --- Physical and Simulation Constants ---\n    \n    # Tungsten material properties\n    rho_m = 1.925e4  # Bulk mass density (kg/m^3)\n    m_m = 3.056e-25  # Atomic mass (kg)\n    \n    # Plasma interaction parameters\n    Gamma_0 = 1.0e23   # Unattenuated incident flux (m^-2 s^-1)\n    sigma = 1.0e6      # Attenuation coefficient (m^2/kg)\n    \n    # Initial conditions\n    H_0 = 5.0e-4           # Initial wall height (m)\n    P_w_0 = rho_m * H_0  # Initial wall areal mass (kg/m^2)\n    M_e_0 = 0.0          # Initial edge cloud areal mass (kg/m^2)\n    M_sink_0 = 0.0       # Initial sink areal mass (kg/m^2)\n    \n    # Integration parameters\n    T = 1.0e-3     # Total simulated time (s)\n    dt = 1.0e-6    # Timestep (s)\n    num_steps = int(T / dt)\n\n    # --- Test Suite ---\n    \n    test_cases = [\n        # Test 1: (Y, k_dep, tau_e), k\n        {'params': (2.0e-2, 1.0e3, 5.0e-4), 'k': 1, 'name': 'General Case'},\n        # Test 2:\n        {'params': (0.0, 1.0e3, 5.0e-4), 'k': 10, 'name': 'Zero Sputtering'},\n        # Test 3:\n        {'params': (2.0e-1, 2.0e2, 1.0e-3), 'k': 20, 'name': 'High Yield, Coarse Exchange'},\n        # Test 4:\n        {'params': (5.0e-2, 5.0e3, 1.0e-4), 'k': 5, 'name': 'Fast Deposition/Loss'},\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Y, k_dep, tau_e = case['params']\n        k = case['k']\n\n        # --- State Variable Initialization ---\n        P_w = P_w_0\n        M_e = M_e_0\n        M_sink = M_sink_0\n\n        initial_total_mass = P_w_0 + M_e_0 + M_sink_0\n\n        # Initialize exchanged flux values to be used in the loop\n        J_sput_exch = 0.0\n        J_dep_exch = 0.0\n        \n        # --- Time Integration Loop ---\n        for i in range(num_steps):\n            # Check for data exchange step\n            if i % k == 0:\n                # Edge solver computes quantities based on its current state\n                Gamma_in_exch = Gamma_0 * np.exp(-sigma * M_e)\n                J_dep_exch = k_dep * M_e\n                \n                # Surface solver computes sputtered flux based on received Gamma_in\n                J_sput_exch = Y * Gamma_in_exch * m_m\n\n            # --- Solver Updates using Forward Euler ---\n            \n            # 1. Surface solver update\n            # It uses the flux values from the most recent exchange\n            P_w_rate = -J_sput_exch + J_dep_exch\n            P_w += P_w_rate * dt\n\n            # 2. Edge solver update\n            # It uses the J_sput from exchange, but re-evaluates its own local terms.\n            # This is the source of the splitting error and mass conservation residual.\n            J_dep_current = k_dep * M_e\n            J_loss_current = M_e / tau_e\n            \n            M_e_rate = J_sput_exch - J_dep_current - J_loss_current\n            M_e += M_e_rate * dt\n\n            # 3. Sink update (part of the edge solver's domain)\n            M_sink_rate = J_loss_current\n            M_sink += M_sink_rate * dt\n\n        # --- Final calculations ---\n        H_final = P_w / rho_m\n        final_total_mass = P_w + M_e + M_sink\n        residual = abs(final_total_mass - initial_total_mass)\n        \n        all_results.append([H_final, residual])\n\n    # --- Format and Print Output ---\n    # The output format must be exactly [[h1,r1],[h2,r2],...]\n    formatted_pairs = [f\"[{h},{r}]\" for h, r in all_results]\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}