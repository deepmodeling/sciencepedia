{
    "hands_on_practices": [
        {
            "introduction": "物理溅射是导致面向等离子体部件（PFCs）侵蚀的主要机制。因此，在任何侵蚀模型中，准确量化溅射产额（$Y$）都是至关重要的第一步。在聚变装置中常见的混合组分等离子体（例如氘-氦混合物）中，总溅射效应可能并非各组分独立效应的简单线性叠加，这种偏离线性预测的现象被称为“协同效应”。本练习  将引导您计算一个线性的混合产额基准，并利用给定的“测量”数据来量化这种协同效应，这反映了计算科学家在验证和改进物理模型时的一项常见任务。",
            "id": "4050382",
            "problem": "在磁约束聚变装置中，一个多晶钨表面暴露于由氘（D）和氦（He）组成的稳定混合离子流中。假设处于一个稳定状态，其中表面温度足够低，以至于热解吸可以忽略不计，且瞬时再沉积也可以忽略不计。设入射离子能量和入射角分别为 $E_{D}=200\\ \\text{eV}$、$E_{\\mathrm{He}}=600\\ \\text{eV}$，以及与表面法线夹角为 $\\theta=60^{\\circ}$。到达表面的离子通量为 $\\Gamma_{D}=7.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$ 和 $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$。\n\n根据定义，物种 $i$ 的溅射产额 $Y_{i}(E_{i},\\theta)$ 是指能量为 $E_{i}$、入射角为 $\\theta$ 的单个物种 $i$ 的入射离子所移除的靶材原子数。在假设物种之间不存在交叉耦合的情况下，发射速率密度是各种离子物种独立贡献之和，通量加权混合产额定义为总发射速率密度与总入射离子通量之比。使用此定义，用通量分数和单物种产额来推导线性混合预测值 $Y_{\\text{mix}}$。\n\n在相同的表面状态和几何条件下，单物种测量提供了在所述 $E_{i}$ 和 $\\theta$ 下的以下单物种产额：$Y_{D}(E_{D},\\theta)=0.015$ 和 $Y_{\\mathrm{He}}(E_{\\mathrm{He}},\\theta)=0.420$。在相同的 $E_{i}$ 和 $\\theta$ 下，使用上述混合 D+He 通量进行的共轰击实验报告的测量混合产额为 $Y_{\\text{meas}}=0.273$。\n\n从溅射产额的定义以及进出表面的粒子通量守恒出发，(i) 推导线性混合预测值 $Y_{\\text{mix}}$ 的表达式，用通量分数 $x_{i}$ 和单物种产额 $Y_{i}(E_{i},\\theta)$ 表示，并根据所提供的数据计算其数值；(ii) 通过将乘法协同因子 $\\eta$ 定义为测量混合产额与线性混合预测值之比，即 $\\eta=Y_{\\text{meas}}/Y_{\\text{mix}}$，来量化共轰击的协同效应，并计算其数值。\n\n将您的最终答案表示为单个无量纲数 $\\eta$，并四舍五入到四位有效数字。",
            "solution": "该问题经评估在物理上是合理的、提法得当，并包含了唯一解所需的所有信息。溅射产额、离子通量和线性混合等概念是等离子体-表面相互作用领域的标准概念。\n\n根据要求，解答分为两个主要部分：(i) 混合物种溅射产额的线性混合预测值 $Y_{\\text{mix}}$ 的推导和计算，以及 (ii) 乘法协同因子 $\\eta$ 的计算。\n\n(i) 线性混合溅射产额 $Y_{\\text{mix}}$ 的推导与计算。\n\n单个离子物种 $i$ 的溅射产额（记为 $Y_i$）定义为每个入射离子喷射出的靶材原子数。这可以表示为通量之比：溅射出的靶材原子通量 $\\Gamma_{\\text{emitted}, i}$ 与入射离子通量 $\\Gamma_i$之比。\n$$Y_i = \\frac{\\Gamma_{\\text{emitted}, i}}{\\Gamma_i}$$\n根据此定义，由物种 $i$ 轰击引起的发射原子通量为 $\\Gamma_{\\text{emitted}, i} = Y_i \\Gamma_i$。\n\n问题指出，对于线性混合模型，总发射速率密度（发射原子的总通量 $\\Gamma_{\\text{emitted, total}}$）被假定为每种离子物种独立贡献之和。对于给定的氘（$D$）和氦（$He$）的混合物，总发射通量为：\n$$\\Gamma_{\\text{emitted, total}} = \\Gamma_{\\text{emitted, D}} + \\Gamma_{\\text{emitted, He}} = Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}$$\n其中 $Y_{D}$ 和 $Y_{\\mathrm{He}}$ 分别是氘和氦的单物种溅射产额，而 $\\Gamma_{D}$ 和 $\\Gamma_{\\mathrm{He}}$ 是它们对应的入射离子通量。\n\n总入射离子通量 $\\Gamma_{\\text{total}}$ 是各个离子通量之和：\n$$\\Gamma_{\\text{total}} = \\Gamma_{D} + \\Gamma_{\\mathrm{He}}$$\n问题将通量加权混合产额 $Y_{\\text{mix}}$ 定义为总发射速率密度与总入射离子通量之比。\n$$Y_{\\text{mix}} = \\frac{\\Gamma_{\\text{emitted, total}}}{\\Gamma_{\\text{total}}} = \\frac{Y_{D} \\Gamma_{D} + Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\n为了用通量分数来表示，我们定义了每种物种在总通量中所占的比例。氘的通量分数 $x_{D}$ 和氦的通量分数 $x_{\\mathrm{He}}$ 分别为：\n$$x_{D} = \\frac{\\Gamma_{D}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\n$$x_{\\mathrm{He}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{\\text{total}}} = \\frac{\\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}}$$\n将这些定义代入 $Y_{\\text{mix}}$ 的表达式中：\n$$Y_{\\text{mix}} = \\frac{Y_{D} \\Gamma_{D}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} + \\frac{Y_{\\mathrm{He}} \\Gamma_{\\mathrm{He}}}{\\Gamma_{D} + \\Gamma_{\\mathrm{He}}} = Y_{D} x_{D} + Y_{\\mathrm{He}} x_{\\mathrm{He}}$$\n这就是所要求的用通量分数和单物种产额表示的线性混合预测表达式。\n\n现在，我们使用所提供的数据计算 $Y_{\\text{mix}}$ 的数值。\n入射离子通量为 $\\Gamma_{D}=7.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$ 和 $\\Gamma_{\\mathrm{He}}=3.0\\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$。\n总入射离子通量为：\n$$\\Gamma_{\\text{total}} = (7.0 \\times 10^{19} + 3.0 \\times 10^{19})\\ \\text{m}^{-2}\\ \\text{s}^{-1} = 10.0 \\times 10^{19}\\ \\text{m}^{-2}\\ \\text{s}^{-1} = 1.0 \\times 10^{20}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$$\n通量分数为：\n$$x_{D} = \\frac{7.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.7$$\n$$x_{\\mathrm{He}} = \\frac{3.0 \\times 10^{19}}{1.0 \\times 10^{20}} = 0.3$$\n给定的单物种产额为 $Y_{D} = 0.015$ 和 $Y_{\\mathrm{He}} = 0.420$。为了简洁起见，省略了特定的能量 $E_i$ 和角度 $\\theta$ 参数，因为它们在整个问题中都是恒定的。\n$$Y_{\\text{mix}} = x_{D} Y_{D} + x_{\\mathrm{He}} Y_{\\mathrm{He}} = (0.7)(0.015) + (0.3)(0.420)$$\n$$Y_{\\text{mix}} = 0.0105 + 0.1260 = 0.1365$$\n\n(ii) 协同效应 $\\eta$ 的量化。\n\n问题将乘法协同因子 $\\eta$ 定义为测量混合产额 $Y_{\\text{meas}}$ 与线性混合预测值 $Y_{\\text{mix}}$ 之比。\n$$\\eta = \\frac{Y_{\\text{meas}}}{Y_{\\text{mix}}}$$\n给定的测量混合产额为 $Y_{\\text{meas}} = 0.273$。\n使用上面计算出的 $Y_{\\text{mix}}$ 值：\n$$\\eta = \\frac{0.273}{0.1365}$$\n$$\\eta = 2.0$$\n问题要求最终答案四舍五入到四位有效数字。\n$$\\eta = 2.000$$\n该值表明存在强烈的协同效应，其中氘和氦的共轰击导致的溅射产额是其各自效应简单线性组合预期值的两倍。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "当材料从表面被溅射出来后，表面的形貌会随之演化。Bradley-Harper（BH）模型是理解离子束诱导的表面图案形成早期阶段的基石。本练习  提供了一个在傅里叶空间中直接操作BH模型的动手实践机会。通过计算不同空间频率模式的增长或衰减，您将探索由曲率相关的侵蚀不稳定性（由系数 $\\nu$ 描述）和表面扩散引起的平滑效应（由系数 $K$ 描述）之间的竞争如何催生出特征性的表面形貌。",
            "id": "4050333",
            "problem": "考虑一个一维面向等离子体的表面，其高度场 $h(x,t)$ 在线性化的 Bradley-Harper (BH) 离子诱导侵蚀和表面扩散模型下演化。给定一个在离散波数 $k$ 处采样的初始粗糙度谱 $S(k)$，您的任务是在 BH 线性动力学下模拟谱演化的单个时间步长，并计算每个模式的放大率。\n\n基本依据和假设：\n- 从表面材料的质量守恒、小斜率近似以及侵蚀对曲率的线性响应开始。\n- Bradley-Harper (BH) 在一维空间中的线性化演化方程为\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4},\n$$\n其中 $x$ 是沿表面的位置，$t$ 是时间，$\\nu$ 是曲率相关侵蚀系数（单位 $\\mathrm{m}^2/\\mathrm{s}$；$\\nu>0$ 对应不稳定化，$\\nu<0$ 对应稳定化），$K$ 是有效表面扩散系数（单位 $\\mathrm{m}^4/\\mathrm{s}$；$K>0$ 提供高波数平滑）。\n\n- 令 $h_k(t)$ 表示 $h$ 在波数 $k$ 处的空间傅里叶模式，傅里叶约定为 $h(x,t) = \\int h_k(t) e^{ikx} \\, dk$。线性化并变换到傅里叶空间，得到每个模式的常微分方程：\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k,\n$$\n其色散关系为\n$$\n\\omega(k) = \\nu k^2 - K k^4,\n$$\n其单位为 $\\mathrm{s}^{-1}$。\n\n- 在一个时间步长 $\\Delta t$ 内，模式振幅的解为\n$$\nh_k(t+\\Delta t) = h_k(t)\\, \\exp\\big(\\omega(k)\\, \\Delta t\\big).\n$$\n定义粗糙度谱 $S(k)$ 为振幅的平方 $S(k) = |h_k|^2$（量纲取决于归一化，但 $S(k)$ 的放大因子是无量纲的）。那么，单个时间步长内的谱更新为\n$$\nS(k, t+\\Delta t) = S(k, t) \\, \\exp\\big(2\\, \\omega(k)\\, \\Delta t\\big).\n$$\n因此，每个模式的光谱功率放大因子为\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big).\n$$\n\n您的程序必须为给定的 $(\\nu, K, \\Delta t)$ 集合和离散的 $k$ 列表计算 $A(k)$，并为每个测试用例生成放大值。虽然提供初始的 $S(k)$ 是为了定义一个完整的物理场景，但您的程序只需返回放大率 $A(k)$。\n\n物理和数值单位及输出要求：\n- 使用 $k$ 的单位为 $\\mathrm{m}^{-1}$，时间步长 $\\Delta t$ 的单位为 $\\mathrm{s}$，$\\nu$ 的单位为 $\\mathrm{m}^2/\\mathrm{s}$，以及 $K$ 的单位为 $\\mathrm{m}^4/\\mathrm{s}$。\n- 放大率 $A(k)$ 是无量纲的。将放大值表示为四舍五入到六位小数的浮点数。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个测试用例，并且本身是一个按照所提供的 $k$ 列表顺序排列的各模式放大值列表。例如：$[ [a_1, a_2], [b_1, b_2, b_3] ]$。\n\n测试套件：\n为以下参数集计算放大率 $A(k)$。每个测试用例提供 $(\\nu, K, \\Delta t)$、一个显式的 $k$ 列表和一个初始 $S(k)$ 列表。只需输出 $A(k)$。\n\n- 测试用例 1（在中间波数 k 处不稳定）：\n  - $\\nu = 1.0 \\times 10^{-12}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 2.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-4}\\ \\mathrm{s}$,\n  - $k$ 列表: $[1.0 \\times 10^{6},\\, 5.0 \\times 10^{6},\\, 1.0 \\times 10^{7},\\, 5.0 \\times 10^{7},\\, 1.0 \\times 10^{8}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ 初始值: $[1.0 \\times 10^{-18},\\, 2.5 \\times 10^{-18},\\, 3.0 \\times 10^{-18},\\, 1.5 \\times 10^{-18},\\, 1.0 \\times 10^{-18}]$。\n\n- 测试用例 2（在高波数 k 处接近中性并趋于稳定）：\n  - $\\nu = 1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ 列表: $[1.0 \\times 10^{8},\\, 1.0 \\times 10^{9},\\, 2.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ 初始值: $[5.0 \\times 10^{-19},\\, 2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19}]$。\n\n- 测试用例 3（稳定化曲率，混合中性模式）：\n  - $\\nu = -1.0 \\times 10^{-18}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-2}\\ \\mathrm{s}$,\n  - $k$ 列表: $[1.0 \\times 10^{8},\\, 5.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ 初始值: $[2.0 \\times 10^{-19},\\, 1.0 \\times 10^{-19},\\, 8.0 \\times 10^{-20}]$。\n\n- 测试用例 4（更长的时间步长，不同 k 处的混合稳定性）：\n  - $\\nu = 5.0 \\times 10^{-19}\\ \\mathrm{m}^2/\\mathrm{s}$,\n  - $K = 1.0 \\times 10^{-36}\\ \\mathrm{m}^4/\\mathrm{s}$,\n  - $\\Delta t = 1.0 \\times 10^{-1}\\ \\mathrm{s}$,\n  - $k$ 列表: $[5.0 \\times 10^{8},\\, 7.0 \\times 10^{8},\\, 1.0 \\times 10^{9}]\\ \\mathrm{m}^{-1}$,\n  - $S(k)$ 初始值: $[1.0 \\times 10^{-19},\\, 1.5 \\times 10^{-19},\\, 2.0 \\times 10^{-19}]$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素是对应测试用例的放大值列表，每个值都四舍五入到六位小数。例如，输出必须类似于 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，不含任何额外文本。",
            "solution": "已分析并验证用户提供的问题。\n\n### 第 1 步：提取已知条件\n- **控制方程（线性化的 Bradley-Harper）：**\n$$\n\\frac{\\partial h(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 h(x,t)}{\\partial x^2} - K \\frac{\\partial^4 h(x,t)}{\\partial x^4}\n$$\n- **参数：**\n  - $h(x,t)$：表面高度场。\n  - $\\nu$：曲率相关侵蚀系数 ($\\mathrm{m}^2/\\mathrm{s}$)。\n  - $K$：有效表面扩散系数 ($\\mathrm{m}^4/\\mathrm{s}$)。\n- **傅里叶模式常微分方程：**\n$$\n\\frac{d h_k}{d t} = \\omega(k)\\, h_k\n$$\n- **色散关系：**\n$$\n\\omega(k) = \\nu k^2 - K k^4\n$$\n- **目标量（光谱功率 $S(k) = |h_k|^2$ 的放大因子）：**\n$$\nA(k) = \\frac{S(k, t+\\Delta t)}{S(k, t)} = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n- **测试用例：**\n  1.  **用例 1：** $\\nu = 1.0 \\times 10^{-12}$，$K = 2.0 \\times 10^{-36}$，$\\Delta t = 1.0 \\times 10^{-4}$，$k = [10^6, 5 \\times 10^6, 10^7, 5 \\times 10^7, 10^8]$。\n  2.  **用例 2：** $\\nu = 1.0 \\times 10^{-18}$，$K = 1.0 \\times 10^{-36}$，$\\Delta t = 1.0 \\times 10^{-2}$，$k = [10^8, 10^9, 2 \\times 10^9]$。\n  3.  **用例 3：** $\\nu = -1.0 \\times 10^{-18}$，$K = 1.0 \\times 10^{-36}$，$\\Delta t = 1.0 \\times 10^{-2}$，$k = [10^8, 5 \\times 10^8, 10^9]$。\n  4.  **用例 4：** $\\nu = 5.0 \\times 10^{-19}$，$K = 1.0 \\times 10^{-36}$，$\\Delta t = 1.0 \\times 10^{-1}$，$k = [5 \\times 10^8, 7 \\times 10^8, 10^9]$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题被评估为**有效**。\n- **科学依据：**该问题基于线性化的 Bradley-Harper 方程，这是表面科学和等离子体-材料相互作用领域中用于描述离子诱导图案形成的一个标准且成熟的模型。\n- **适定性：**该问题是适定的，为待计算量 $A(k)$ 提供了直接公式和所有必要参数。对于每组输入，都存在唯一且稳定的解。\n- **客观性：**该问题以精确、客观的语言陈述，具有明确定义的物理量、单位和数学关系。\n- **完整性和一致性：**为每个测试用例提供了所有必要数据（$\\nu, K, \\Delta t$, k 列表）。单位在量纲上是一致的。关于 $S(k)$ 的背景信息被明确标记为计算所不需要，这是一种澄清，而非矛盾。\n- **现实性和可行性：**物理参数的数值在纳米技术和表面科学应用的合理数量级范围内。\n\n### 第 3 步：结论与行动\n问题有效。将提供解决方案。\n\n### 基于原理的解决方案设计\n核心任务是计算表面粗糙度谱功率的放大因子 $A(k)$，该过程受线性化的 Bradley-Harper (BH) 模型控制。问题提供了这个因子的最终解析表达式，该表达式是通过傅里叶分析从模型的控制偏微分方程推导出来的。\n\n基本原理是，在线性系统中，不同的空间频率分量（傅里叶模式）是独立演化的。每个模式 $h_k$ 的演化由一个简单的一阶常微分方程 $\\frac{d h_k}{d t} = \\omega(k)\\, h_k$ 描述，其中 $\\omega(k)$ 是波数为 $k$ 的模式的色散关系或增长率。\n\n经过一个时间步长 $\\Delta t$ 后，模式振幅的解呈指数增长或衰减：$h_k(t+\\Delta t) = h_k(t) \\exp(\\omega(k) \\Delta t)$。因此，定义为 $S(k) = |h_k|^2$ 的谱功率演化为 $S(k, t+\\Delta t) = S(k, t) \\exp(2\\omega(k) \\Delta t)$。放大因子 $A(k)$ 是比率 $\\frac{S(k, t+\\Delta t)}{S(k, t)}$。\n\n算法设计直接实现了这个最终表达式：\n$$\nA(k) = \\exp\\big(2\\, (\\nu k^2 - K k^4)\\, \\Delta t\\big)\n$$\n\n解决方案的步骤如下：\n1.  定义一个函数来封装单个测试用例的计算。该函数接受参数 $\\nu$、$K$、$\\Delta t$ 和波数列表 $k$ 作为输入。\n2.  对于输入列表中的每个 $k$ 值，程序首先计算增长率 $\\omega(k) = \\nu k^2 - K k^4$。项 $\\nu k^2$ 代表由曲率相关侵蚀驱动的不稳定性，而项 $-K k^4$ 代表由表面扩散引起的稳定性。这两项之间的竞争决定了模式是增长（$\\omega(k) > 0$）、衰减（$\\omega(k) < 0$）还是保持中性（$\\omega(k) = 0$）。\n3.  接下来，计算指数函数的参数 $2 \\omega(k) \\Delta t$。这表示在时间步长 $\\Delta t$ 内谱功率的总增长。\n4.  然后使用指数函数 `numpy.exp()` 计算放大因子 $A(k)$，该函数非常适合涉及浮点数的科学计算。\n5.  根据要求，将计算出的 $A(k)$ 值四舍五入到六位小数。\n6.  对给定测试用例中的所有 $k$ 值重复此过程，并将结果收集到一个列表中。\n7.  主程序结构遍历所有指定的测试用例，为每个测试用例调用计算函数，并汇总结果列表。\n8.  最后，将结果格式化为严格遵守所要求输出格式的单个字符串：一个列表的列表，其中的数字格式化为六位小数，表示为 `[[...],[...],...]`。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor A(k) for surface roughness modes\n    based on the linearized Bradley-Harper model for several test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1: (nu, K, dt, k_list)\n        (1.0e-12, 2.0e-36, 1.0e-4, [1.0e6, 5.0e6, 1.0e7, 5.0e7, 1.0e8]),\n        # Test case 2:\n        (1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 1.0e9, 2.0e9]),\n        # Test case 3:\n        (-1.0e-18, 1.0e-36, 1.0e-2, [1.0e8, 5.0e8, 1.0e9]),\n        # Test case 4:\n        (5.0e-19, 1.0e-36, 1.0e-1, [5.0e8, 7.0e8, 1.0e9]),\n    ]\n\n    all_results = []\n    for nu, K, dt, k_list in test_cases:\n        case_results = []\n        for k in k_list:\n            # Calculate the dispersion relation (growth rate) for the mode k.\n            # omega(k) = nu * k^2 - K * k^4\n            omega_k = nu * k**2 - K * k**4\n\n            # Calculate the amplification factor A(k) for the spectral power.\n            # A(k) = exp(2 * omega(k) * dt)\n            amplification_factor = np.exp(2 * omega_k * dt)\n            \n            # The problem asks for rounding to six decimal places.\n            # We will handle formatting to six places in the output string.\n            case_results.append(amplification_factor)\n        \n        all_results.append(case_results)\n\n    # Format the final output string precisely as requested:\n    # [[val1,val2,...],[val1,val2,...],...]\n    # using .6f to ensure six decimal places are always shown.\n    result_strings = []\n    for case_res in all_results:\n        inner_str = '[' + ','.join(f'{x:.6f}' for x in case_res) + ']'\n        result_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(result_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的聚变装置中，材料表面与邻近的边界等离子体构成一个紧密耦合的系统：溅射出的杂质进入等离子体，改变其性质，而这又反过来影响了到达壁面的离子通量和能量。本练习  将通过一个简化的耦合模型来模拟这一关键的反馈回路。您将实现一个耦合算法，从而掌握解决多物理场问题中的算子分裂等核心计算技术，并学会分析由耦合方案引入的数值误差，例如质量守恒残差。",
            "id": "4050334",
            "problem": "考虑在一个聚变装置中，一个代表面向等离子体部件的表面侵蚀求解器与一个代表近壁杂质云演化的边缘输运求解器之间的一种简化但科学合理的耦合。设壁材料为钨。按单位面积计算，并假设空间均匀（无空间梯度）。基本依据是质量连续性和动力学通量关系。\n\n定义以下单位面积状态变量（单位：千克/平方米）：壁面质量 $P_w(t)$，边缘云面质量 $M_e(t)$，以及代表从近壁区域不可逆地输运走的材料的累积汇面质量 $M_{\\mathrm{sink}}(t)$。壁高 $H(t)$（单位：米）为 $H(t) = P_w(t)/\\rho_m$，其中 $\\rho_m$ 是壁材料的体质量密度。\n\n假设入射到壁上的等离子体粒子通量根据一个简单的不透明度模型被边缘云衰减，\n$$\n\\Gamma_{\\mathrm{in}}(t) = \\Gamma_0 \\exp\\!\\big(-\\sigma M_e(t)\\big),\n$$\n其中 $\\Gamma_0$ 是未衰减的入射通量，单位为 $\\mathrm{m}^{-2}\\mathrm{s}^{-1}$，$\\sigma$ 是衰减系数，单位为 $\\mathrm{m}^2\\mathrm{kg}^{-1}$。离开壁的溅射质量通量由下式给出\n$$\nJ_{\\mathrm{sput}}(t) = Y\\,\\Gamma_{\\mathrm{in}}(t)\\,m_m,\n$$\n其中 $Y$ 是溅射产额（无量纲，每个入射粒子溅射出的原子数），$m_m$ 是钨的原子质量，单位为千克。\n\n通过线性沉积率 $k_{\\mathrm{dep}}$（单位：$\\mathrm{s}^{-1}$）和时间尺度为 $\\tau_e$（单位：秒）的输运损失来模拟边缘云中的再沉积和输运：\n$$\nJ_{\\mathrm{dep}}(t) = k_{\\mathrm{dep}}\\,M_e(t),\\qquad J_{\\mathrm{loss}}(t) = \\frac{M_e(t)}{\\tau_e}.\n$$\n单位面积的连续时间耦合质量平衡方程为\n$$\n\\frac{dP_w}{dt} = -J_{\\mathrm{sput}}(t) + J_{\\mathrm{dep}}(t),\n$$\n$$\n\\frac{dM_e}{dt} = J_{\\mathrm{sput}}(t) - J_{\\mathrm{dep}}(t) - J_{\\mathrm{loss}}(t),\n$$\n$$\n\\frac{dM_{\\mathrm{sink}}}{dt} = J_{\\mathrm{loss}}(t),\n$$\n这些方程意味着总质量 $P_w(t) + M_e(t) + M_{\\mathrm{sink}}(t)$ 的精确守恒。\n\n实现一个两个求解器之间的显式时间积分耦合算法，该算法在指定的交换频率下强制执行以下数据交换协议：\n- 在一个交换步骤中，边缘输运求解器根据其当前的 $M_e$ 计算 $J_{\\mathrm{dep}}$ 和 $\\Gamma_{\\mathrm{in}}$，并将它们发送给表面侵蚀求解器。\n- 表面侵蚀求解器然后使用接收到的 $\\Gamma_{\\mathrm{in}}$ 计算 $J_{\\mathrm{sput}}$，并使用接收到的 $J_{\\mathrm{dep}}$ 更新 $P_w$。它将计算出的 $J_{\\mathrm{sput}}$ 发送给边缘输运求解器。\n- 边缘输运求解器最终使用接收到的 $J_{\\mathrm{sput}}$ 及其自身的 $J_{\\mathrm{dep}}$ 来更新 $M_e$ 和 $M_{\\mathrm{sink}}$。\n\n在交换步骤之间，每个求解器使用最近交换的量进行推进（即，值保持恒定直到下一次交换）。使用前向欧拉更新。设 $\\Delta t$ 为时间步长，交换频率为每 $k$ 个时间步一次（即，当时间步索引 $i$ 满足 $i \\bmod k = 0$ 时发生交换）。这种交错交换引入了分裂误差，您必须通过模拟结束时总质量守恒的残差来量化该误差。\n\n贯穿所有测试使用的常量：\n- 钨的体质量密度 $\\rho_m = 1.925\\times 10^{4}\\ \\mathrm{kg}/\\mathrm{m}^{3}$。\n- 钨的原子质量 $m_m = 3.056\\times 10^{-25}\\ \\mathrm{kg}$。\n- 未衰减的入射通量 $\\Gamma_0 = 1.0\\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$。\n- 衰减系数 $\\sigma = 1.0\\times 10^{6}\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n所有测试通用的初始条件：\n- 初始壁高 $H_0 = 5.0\\times 10^{-4}\\ \\mathrm{m}$，因此 $P_w(0) = \\rho_m H_0$。\n- 初始边缘云质量 $M_e(0) = 0$。\n- 初始汇质量 $M_{\\mathrm{sink}}(0) = 0$。\n\n所有测试通用的积分参数：\n- 总模拟时间 $T = 1.0\\times 10^{-3}\\ \\mathrm{s}$。\n- 时间步长 $\\Delta t = 1.0\\times 10^{-6}\\ \\mathrm{s}$。\n\n您必须构建一个完整的程序，对以下参数集测试套件模拟耦合系统，每个测试由三元组 $(Y, k_{\\mathrm{dep}}, \\tau_e)$ 和整数交换频率 $k$ 指定：\n\n- 测试1（一般情况）：$Y = 2.0\\times 10^{-2}$, $k_{\\mathrm{dep}} = 1.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 5.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 1$。\n- 测试2（边界情况，零溅射）：$Y = 0$, $k_{\\mathrm{dep}} = 1.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 5.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 10$。\n- 测试3（边缘情况，粗交换和高产额）：$Y = 2.0\\times 10^{-1}$, $k_{\\mathrm{dep}} = 2.0\\times 10^{2}\\ \\mathrm{s}^{-1}$, $\\tau_e = 1.0\\times 10^{-3}\\ \\mathrm{s}$, $k = 20$。\n- 测试4（快速沉积和快速损失）：$Y = 5.0\\times 10^{-2}$, $k_{\\mathrm{dep}} = 5.0\\times 10^{3}\\ \\mathrm{s}^{-1}$, $\\tau_e = 1.0\\times 10^{-4}\\ \\mathrm{s}$, $k = 5$。\n\n对于每个测试，计算：\n- 最终壁高 $H(T)$，单位为米。\n- 在 $t=T$ 时总质量守恒的绝对残差，定义为\n$$\nR = \\left| \\big(P_w(T) + M_e(T) + M_{\\mathrm{sink}}(T)\\big) - \\big(P_w(0) + M_e(0) + M_{\\mathrm{sink}}(0)\\big) \\right|\n$$\n单位为千克/平方米。\n\n用米表示 $H(T)$，用千克/平方米表示 $R$。本问题不使用角度。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $[H(T), R]$。例如，输出格式必须类似于：\n`[[h_1, r_1], [h_2, r_2], [h_3, r_3], [h_4, r_4]]`\n用数值替换符号。不应打印其他任何文本。",
            "solution": "该问题要求模拟一个耦合系统，该系统模拟等离子体-表面相互作用和边缘杂质输运。解决方案涉及实现一个指定的数值方案来求解控制该过程的时间相关方程。\n\n系统的状态由三个面质量密度描述：壁质量 $P_w(t)$、边缘云质量 $M_e(t)$ 和汇质量 $M_{\\mathrm{sink}}(t)$。控制动力学由一组耦合的常微分方程（ODE）给出：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nP_w \\\\\nM_e \\\\\nM_{\\mathrm{sink}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-J_{\\mathrm{sput}}(t) + J_{\\mathrm{dep}}(t) \\\\\nJ_{\\mathrm{sput}}(t) - J_{\\mathrm{dep}}(t) - J_{\\mathrm{loss}}(t) \\\\\nJ_{\\mathrm{loss}}(t)\n\\end{pmatrix}\n$$\n通量是状态变量的函数，引入了非线性耦合：\n- 入射粒子通量衰减：$\\Gamma_{\\mathrm{in}}(t) = \\Gamma_0 \\exp(-\\sigma M_e(t))$\n- 溅射质量通量：$J_{\\mathrm{sput}}(t) = Y\\,\\Gamma_{\\mathrm{in}}(t)\\,m_m$\n- 沉积质量通量：$J_{\\mathrm{dep}}(t) = k_{\\mathrm{dep}}\\,M_e(t)$\n- 输运损失质量通量：$J_{\\mathrm{loss}}(t) = M_e(t)/\\tau_e$\n\n连续系统表现出精确的质量守恒，因为 $\\frac{d}{dt}(P_w + M_e + M_{\\mathrm{sink}}) = 0$。\n\n数值解是使用时间步长为 $\\Delta t$ 的前向欧拉时间步进方案构建的。设时间步 $i$ 的状态为 $(P_{w,i}, M_{e,i}, M_{\\mathrm{sink},i})$。对于一个通用变量 $X$，前向欧拉更新为 $X_{i+1} = X_i + \\frac{dX}{dt}|_i \\Delta t$。\n\n问题的关键方面是“表面侵蚀求解器”（控制 $P_w$）和“边缘输运求解器”（控制 $M_e$ 和 $M_{\\mathrm{sink}}$）之间的交错数据交换协议。交换每 $k$ 个时间步发生一次。这引入了算子分裂误差，我们必须对其进行量化。该协议规定了以下模拟算法：\n\n我们遍历时间步 $i = 0, 1, \\dots, N-1$，其中 $N=T/\\Delta t$。在每一步，我们将状态从 $(P_{w,i}, M_{e,i}, M_{\\mathrm{sink},i})$ 更新为 $(P_{w,i+1}, M_{e,i+1}, M_{\\mathrm{sink},i+1})$。\n\n首先，我们定义“交换”量，这些量在交换步骤之间保持恒定。如果在步骤 $i$ 发生交换（即，$i \\bmod k = 0$），则重新评估这些量。\n- 交换的入射通量：$\\Gamma_{\\mathrm{in, exch}} = \\Gamma_0 \\exp(-\\sigma M_{e,i})$\n- 交换的沉积通量：$J_{\\mathrm{dep, exch}} = k_{\\mathrm{dep}}M_{e,i}$\n- 交换的溅射通量：$J_{\\mathrm{sput, exch}} = Y \\Gamma_{\\mathrm{in, exch}} m_m$\n\n这些在 $k$ 步块开始时计算的值，将用于该块内的后续更新。\n\n在每个时间步 $i$ 更新状态变量的过程如下：\n1.  **表面求解器更新**：壁质量 $P_w$ 的演化取决于交换的通量。求解器使用在上次交换时冻结的值。\n    $$\n    P_{w,i+1} = P_{w,i} + (-J_{\\mathrm{sput, exch}} + J_{\\mathrm{dep, exch}}) \\Delta t\n    $$\n2.  **边缘求解器更新**：边缘求解器使用接收到的溅射通量 $J_{\\mathrm{sput, exch}}$，但根据其当前状态 $M_{e,i}$ 评估其内部的源/汇项（$J_{\\mathrm{dep}}$ 和 $J_{\\mathrm{loss}}$）。这种非对称更新是数值质量守恒误差的来源。\n    -   当前沉积通量：$J_{\\mathrm{dep, current}} = k_{\\mathrm{dep}} M_{e,i}$\n    -   当前损失通量：$J_{\\mathrm{loss, current}} = M_{e,i}/\\tau_e$\n    因此，$M_e$ 和 $M_{\\mathrm{sink}}$ 的更新为：\n    $$\n    M_{e,i+1} = M_{e,i} + (J_{\\mathrm{sput, exch}} - J_{\\mathrm{dep, current}} - J_{\\mathrm{loss, current}}) \\Delta t\n    $$\n    $$\n    M_{\\mathrm{sink},i+1} = M_{\\mathrm{sink},i} + J_{\\mathrm{loss, current}} \\Delta t\n    $$\n\n步骤 $i+1$ 的总质量为 $M_{\\mathrm{tot}, i+1} = P_{w,i+1} + M_{e,i+1} + M_{\\mathrmsink,i+1}$。一个时间步内总质量的变化是：\n$$\n\\Delta M_{\\mathrm{tot}, i} = M_{\\mathrm{tot}, i+1} - M_{\\mathrm{tot}, i}\n$$\n$$\n\\Delta M_{\\mathrm{tot}, i} = \\Delta t \\left[ (-J_{\\mathrm{sput, exch}} + J_{\\mathrm{dep, exch}}) + (J_{\\mathrm{sput, exch}} - J_{\\mathrm{dep, current}} - J_{\\mathrm{loss, current}}) + (J_{\\mathrm{loss, current}}) \\right]\n$$\n$$\n\\Delta M_{\\mathrm{tot}, i} = \\Delta t (J_{\\mathrm{dep, exch}} - J_{\\mathrm{dep, current}})\n$$\n这表明该方案是不守恒的。每一步的误差源于表面求解器使用的沉积通量（$J_{\\mathrm{dep, exch}}$）和边缘求解器使用的沉积通量（$J_{\\mathrm{dep, current}}$）之间的差异。\n\n如果 $k=1$，则每一步都发生交换。$J_{\\mathrm{dep, exch}}$ 使用 $M_{e,i}$ 计算，而 $J_{\\mathrm{dep, current}}$ 也使用 $M_{e,i}$ 计算。因此，$J_{\\mathrm{dep, exch}} = J_{\\mathrm{dep, current}}$，方案变为完全质量守恒（$\\Delta M_{\\mathrm{tot}, i} = 0$），直至浮点精度。\n\n如果 $k>1$，$J_{\\mathrm{dep, exch}}$ 使用 $k$ 步块开始时的质量 $M_e$ 计算，而 $J_{\\mathrm{dep, current}}$ 使用在块内演化的质量 $M_{e,i}$。这种差异导致了非零的质量残差。\n\n模拟从初始条件 $P_w(0) = \\rho_m H_0 = (1.925\\times 10^4)(5.0\\times 10^{-4}) = 9.625 \\, \\mathrm{kg}/\\mathrm{m}^2$, $M_e(0)=0$ 和 $M_{\\mathrm{sink}}(0)=0$ 开始。我们用时间步长 $\\Delta t$ 对总时间 $T$ 进行模拟。在最后一步之后，我们计算最终壁高 $H(T) = P_w(T)/\\rho_m$ 和绝对总质量残差 $R = |(P_w(T) + M_e(T) + M_{\\mathrm{sink}}(T)) - (P_w(0) + M_e(0) + M_{\\mathrm{sink}}(0))|$。对每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a coupled plasma-surface interaction model for several test cases.\n    \"\"\"\n    \n    # --- Physical and Simulation Constants ---\n    \n    # Tungsten material properties\n    rho_m = 1.925e4  # Bulk mass density (kg/m^3)\n    m_m = 3.056e-25  # Atomic mass (kg)\n    \n    # Plasma interaction parameters\n    Gamma_0 = 1.0e23   # Unattenuated incident flux (m^-2 s^-1)\n    sigma = 1.0e6      # Attenuation coefficient (m^2/kg)\n    \n    # Initial conditions\n    H_0 = 5.0e-4           # Initial wall height (m)\n    P_w_0 = rho_m * H_0  # Initial wall areal mass (kg/m^2)\n    M_e_0 = 0.0          # Initial edge cloud areal mass (kg/m^2)\n    M_sink_0 = 0.0       # Initial sink areal mass (kg/m^2)\n    \n    # Integration parameters\n    T = 1.0e-3     # Total simulated time (s)\n    dt = 1.0e-6    # Timestep (s)\n    num_steps = int(T / dt)\n\n    # --- Test Suite ---\n    \n    test_cases = [\n        # Test 1: (Y, k_dep, tau_e), k\n        {'params': (2.0e-2, 1.0e3, 5.0e-4), 'k': 1, 'name': 'General Case'},\n        # Test 2:\n        {'params': (0.0, 1.0e3, 5.0e-4), 'k': 10, 'name': 'Zero Sputtering'},\n        # Test 3:\n        {'params': (2.0e-1, 2.0e2, 1.0e-3), 'k': 20, 'name': 'High Yield, Coarse Exchange'},\n        # Test 4:\n        {'params': (5.0e-2, 5.0e3, 1.0e-4), 'k': 5, 'name': 'Fast Deposition/Loss'},\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Y, k_dep, tau_e = case['params']\n        k = case['k']\n\n        # --- State Variable Initialization ---\n        P_w = P_w_0\n        M_e = M_e_0\n        M_sink = M_sink_0\n\n        initial_total_mass = P_w_0 + M_e_0 + M_sink_0\n\n        # Initialize exchanged flux values to be used in the loop\n        J_sput_exch = 0.0\n        J_dep_exch = 0.0\n        \n        # --- Time Integration Loop ---\n        for i in range(num_steps):\n            # Check for data exchange step\n            if i % k == 0:\n                # Edge solver computes quantities based on its current state\n                Gamma_in_exch = Gamma_0 * np.exp(-sigma * M_e)\n                J_dep_exch = k_dep * M_e\n                \n                # Surface solver computes sputtered flux based on received Gamma_in\n                J_sput_exch = Y * Gamma_in_exch * m_m\n\n            # --- Solver Updates using Forward Euler ---\n            \n            # 1. Surface solver update\n            # It uses the flux values from the most recent exchange\n            P_w_rate = -J_sput_exch + J_dep_exch\n            P_w += P_w_rate * dt\n\n            # 2. Edge solver update\n            # It uses the J_sput from exchange, but re-evaluates its own local terms.\n            # This is the source of the splitting error and mass conservation residual.\n            J_dep_current = k_dep * M_e\n            J_loss_current = M_e / tau_e\n            \n            M_e_rate = J_sput_exch - J_dep_current - J_loss_current\n            M_e += M_e_rate * dt\n\n            # 3. Sink update (part of the edge solver's domain)\n            M_sink_rate = J_loss_current\n            M_sink += M_sink_rate * dt\n\n        # --- Final calculations ---\n        H_final = P_w / rho_m\n        final_total_mass = P_w + M_e + M_sink\n        residual = abs(final_total_mass - initial_total_mass)\n        \n        all_results.append([H_final, residual])\n\n    # --- Format and Print Output ---\n    # The output format must be exactly [[h1,r1],[h2,r2],...]\n    formatted_pairs = [f\"[{h},{r}]\" for h, r in all_results]\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}