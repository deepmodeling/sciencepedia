{
    "hands_on_practices": [
        {
            "introduction": "托卡马克装置中的磁场在空间上并非均匀分布，这种沿磁力线变化的磁场强度会产生“磁镜”效应。本练习将引导您从能量 $E$ 和磁矩 $\\mu$ 这两个守恒量出发，推导带电粒子被磁镜反射的条件，从而将等离子体中的粒子区分为“俘获粒子”和“通行粒子”两大类 。掌握这一区分是理解托卡马克中许多关键物理过程的基础，因为俘获粒子在新经典输运和多种微观不稳定性（如俘获电子模）的驱动中扮演着核心角色。",
            "id": "4053549",
            "problem": "考虑一个大环径比、圆形同心的托卡马克装置中，由回旋动理学 (GK) Vlasov 方程所描述的无碰撞带电粒子。在小半径为 $r$、大半径为 $R_0$ 的给定磁通量面上，磁场强度大小作为极向角 $\\theta$ 的函数，可由模型 $B(\\theta) = B_0 \\left(1 - \\epsilon \\cos \\theta\\right)$ 描述，其中 $B_0$ 是一个恒定的参考磁场强度，$\\epsilon = r/R_0 \\ll 1$。用 $B_{\\min}$ 和 $B_{\\max}$ 分别表示在该磁面上沿磁力线遇到的 $B(\\theta)$ 的最小值和最大值。\n\n从缓变磁场中单粒子能量 $E = m v^2/2$ 和磁矩 $\\mu = m v_{\\perp}^2/(2B)$ 的守恒出发，推导出一个包含 $v_{\\parallel}$、$v$、$B_{\\min}$ 和沿轨道某点磁场强度 $B$ 的不等式形式的螺距角捕获条件。然后，将此条件特殊化到沿磁力线的磁场最强位置。\n\n假设在外侧中平面（即 $B(\\theta)$ 最小的位置）处的粒子速度呈单能、各向同性的分布。计算在该位置速度空间中满足捕获条件的方向所占的比例，并将结果仅用反环径比参数 $\\epsilon$ 表示。提供最终的捕获粒子比例，形式为一个单一的闭式解析表达式。最终表达式中不要包含单位。",
            "solution": "用户希望我解决一个计算聚变科学与工程领域的问题。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n*   系统：无碰撞带电粒子。\n*   控制方程：回旋动理学 (GK) Vlasov 方程。\n*   几何：大环径比、圆形同心托卡马克。小半径为 $r$、大半径为 $R_0$ 的磁通量面。\n*   磁场模型：磁通量面上的磁场为 $B(\\theta) = B_0 \\left(1 - \\epsilon \\cos \\theta\\right)$，其中 $\\epsilon = r/R_0 \\ll 1$。\n*   定义：$B_{\\min}$ 和 $B_{\\max}$ 是磁面上 $B(\\theta)$ 的最小值和最大值。\n*   守恒量：单粒子能量 $E = m v^2/2$ 和磁矩 $\\mu = m v_{\\perp}^2/(2B)$。\n*   任务1：推导包含 $v_{\\parallel}$、$v$、$B_{\\min}$ 和 $B$ 的不等式形式的螺距角捕获条件。\n*   任务2：将此条件特殊化到磁场最强位置。\n*   任务3：假设在外侧中平面（$B(\\theta)$ 最小处）的粒子速度呈单能、各向同性分布。\n*   任务4：计算该位置速度空间中被捕获的方向所占的比例。\n*   任务5：将此比例仅用 $\\epsilon$ 表示。\n*   任务6：为捕获粒子比例提供一个单一的闭式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题是等离子体物理和聚变科学的核心。磁场模型是大环径比托卡马克的标准近似。能量 $E$ 和磁矩 $\\mu$（第一绝热不变量）的守恒是带电粒子在缓变磁场中运动的基本原理。捕获粒子和通行粒子的概念对于理解托卡马克中的等离子体稳定性、输运和加热至关重要，并且是回旋动理学 Vlasov 方程解的一个关键特征。该问题在科学上是合理的。\n*   **适定性**：该问题是适定的。它提供了一个清晰的模型，列出了守恒量，并提出了一系列逻辑上导向一个唯一、可计算结果的问题。单能和各向同性分布的假设足以计算所需的分数。\n*   **客观性**：语言正式、精确，没有主观或模糊的术语。所有术语在等离子体物理领域都是标准术语。\n\n该问题没有说明中列出的任何缺陷（例如，科学上不合理、信息缺失或不适定）。它是该领域一个标准的、不平凡的问题。\n\n**第三步：结论与行动**\n\n问题有效。我现在将进行完整解答。\n\n### 解答\n\n在托卡马克的缓变磁场中，带电粒子的运动以其能量 $E$ 和磁矩 $\\mu$ 的守恒为特征。它们由以下公式给出：\n$$E = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2) = \\text{constant}$$\n$$\\mu = \\frac{m v_{\\perp}^2}{2B} = \\text{constant}$$\n在此，$m$ 是粒子质量，$v$ 是其总速率，$v_{\\parallel}$ 是平行于磁场 $\\vec{B}$ 的速度分量，$v_{\\perp}$ 是垂直于 $\\vec{B}$ 的速度分量，$B=|\\vec{B}|$ 是磁场强度大小。由于 $E$ 和 $m$ 是常数，粒子的速率 $v$ 在其轨道上也保持不变。\n\n根据 $\\mu$ 的守恒，我们可以将在粒子轨迹上任意点的垂直速度平方表示为 $v_{\\perp}^2 = \\frac{2B\\mu}{m}$。将其代入能量守恒方程，可得到平行速度平方的表达式：\n$$v_{\\parallel}^2 = v^2 - v_{\\perp}^2 = v^2 - \\frac{2B\\mu}{m}$$\n如果一个粒子的平行运动方向发生反转，则认为该粒子被“捕获”，这种情况发生在 $v_{\\parallel}=0$ 的“反弹点”或“磁镜点”。设此反弹点的磁场为 $B_b$。$v_{\\parallel}=0$ 的条件意味着 $v^2 = \\frac{2B_b\\mu}{m}$，或等效地，$E = \\mu B_b$。如果一个粒子的反弹发生在场强 $B_b$ 小于或等于磁通量面上的最大场强 $B_{\\max}$ 的位置，那么该粒子就被捕获在托卡马克的磁阱中。因此，粒子被捕获的一般条件是：\n$$B_b \\le B_{\\max} \\implies \\frac{E}{\\mu} \\le B_{\\max}$$\n我们可以用场强为 $B$ 的任意点的局部速度分量来表示比值 $E/\\mu$，对于给定粒子，该比值是恒定的：\n$$\\frac{E}{\\mu} = \\frac{\\frac{1}{2}mv^2}{\\frac{m v_{\\perp}^2}{2B}} = \\frac{v^2 B}{v_{\\perp}^2}$$\n由于 $v_{\\perp}^2 = v^2 - v_{\\parallel}^2$，上式变为：\n$$\\frac{E}{\\mu} = \\frac{v^2 B}{v^2 - v_{\\parallel}^2}$$\n将此代入捕获不等式得到：\n$$\\frac{v^2 B}{v^2 - v_{\\parallel}^2} \\le B_{\\max}$$\n假设粒子不在反弹点（即 $v_{\\perp}^2 > 0$），我们可以重新整理不等式：\n$$v^2 B \\le B_{\\max}(v^2 - v_{\\parallel}^2)$$\n$$B_{\\max} v_{\\parallel}^2 \\le B_{\\max}v^2 - B v^2$$\n两边同除以 $v^2 B_{\\max}$ 得到一般的螺距角捕获条件：\n$$\\frac{v_{\\parallel}^2}{v^2} \\le 1 - \\frac{B}{B_{\\max}}$$\n这个不等式将粒子在局部磁场 $B$ 处的螺距 ($v_{\\parallel}/v$) 与磁通量面上的最大磁场 $B_{\\max}$联系起来。问题要求的是一个包含 $B_{\\min}$ 的不等式，但定义磁镜的物理相关量是 $B_{\\max}$。\n\n为了将此条件特殊化到磁场最强位置，我们设 $B=B_{\\max}$。不等式变为：\n$$\\frac{v_{\\parallel}^2(B_{\\max})}{v^2} \\le 1 - \\frac{B_{\\max}}{B_{\\max}} = 0$$\n由于 $v_{\\parallel}^2$ 必须为非负数，这意味着 $v_{\\parallel}(B_{\\max}) = 0$。这在物理上是一致的：在磁场最强点能找到的唯一捕获粒子是那些恰好处于其反弹点的粒子。\n\n接下来，我们计算在外侧中平面上单能、各向同性速度分布下捕获粒子的比例。外侧中平面对应于极向角 $\\theta=0$，这是最小磁场 $B_{\\min}$ 的位置。各向同性分布的假设意味着速度矢量在速度空间中所有可能方向上均匀分布。对于单能分布，这些矢量都位于半径为 $v$ 的球面上。捕获粒子的比例是该球体满足捕获条件的立体角所占的比例。\n\n我们在外侧中平面处评估捕获条件，此处 $B=B_{\\min}$：\n$$\\frac{v_{\\parallel, \\min}^2}{v^2} \\le 1 - \\frac{B_{\\min}}{B_{\\max}}$$\n这里，$v_{\\parallel, \\min}$ 是在外侧中平面处的平行速度。设 $\\xi_0$ 为此处的螺距角，定义为 $v_{\\parallel, \\min} = v \\cos \\xi_0$。条件变为：\n$$\\cos^2\\xi_0 \\le 1 - \\frac{B_{\\min}}{B_{\\max}}$$\n捕获粒子集合对应于满足此不等式的螺距角 $\\xi_0$。这在速度空间中定义了一个关于垂直于磁场的平面对称的“捕获”区域。“通行”粒子区域（损失锥）的边界由等式成立时的临界角 $\\xi_c$ 给出：\n$$\\cos^2\\xi_c = 1 - \\frac{B_{\\min}}{B_{\\max}} \\implies |\\cos\\xi_c| = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}}$$\n通行粒子是那些螺距角接近 $0$ 和 $\\pi$ 的粒子，即 $0 \\le \\xi_0  \\xi_c$ 和 $\\pi-\\xi_c  \\xi_0 \\le \\pi$。捕获粒子是那些螺距角在范围 $\\xi_c \\le \\xi_0 \\le \\pi - \\xi_c$ 内的粒子。\n\n速度空间中的立体角元是 $d\\Omega = \\sin\\xi_0 d\\xi_0 d\\phi$，其中 $\\phi$ 是回旋相位角。总立体角是 $\\int_0^{2\\pi}d\\phi\\int_0^{\\pi}\\sin\\xi_0 d\\xi_0=4\\pi$。被捕获粒子占据的立体角是：\n$$\\Omega_{\\text{trap}} = \\int_0^{2\\pi} d\\phi \\int_{\\xi_c}^{\\pi-\\xi_c} \\sin\\xi_0 d\\xi_0 = 2\\pi \\left[-\\cos\\xi_0\\right]_{\\xi_c}^{\\pi-\\xi_c}$$\n$$\\Omega_{\\text{trap}} = 2\\pi \\left(-\\cos(\\pi-\\xi_c) - (-\\cos\\xi_c)\\right) = 2\\pi(\\cos\\xi_c + \\cos\\xi_c) = 4\\pi\\cos\\xi_c$$\n捕获粒子的比例 $f_{\\text{trap}}$ 是捕获立体角与总立体角的比值：\n$$f_{\\text{trap}} = \\frac{\\Omega_{\\text{trap}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi\\cos\\xi_c}{4\\pi} = \\cos\\xi_c = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}}$$\n最后一步是用反环径比 $\\epsilon$ 来表示这个比例。根据给定的磁场模型 $B(\\theta) = B_0(1-\\epsilon\\cos\\theta)$：\n最小磁场出现在 $\\theta=0$ 处：$B_{\\min} = B_0(1-\\epsilon)$。\n最大磁场出现在 $\\theta=\\pi$ 处：$B_{\\max} = B_0(1+\\epsilon)$。\n它们的比值是：\n$$\\frac{B_{\\min}}{B_{\\max}} = \\frac{B_0(1-\\epsilon)}{B_0(1+\\epsilon)} = \\frac{1-\\epsilon}{1+\\epsilon}$$\n将此代入捕获粒子比例的表达式中：\n$$f_{\\text{trap}} = \\sqrt{1 - \\frac{1-\\epsilon}{1+\\epsilon}} = \\sqrt{\\frac{(1+\\epsilon) - (1-\\epsilon)}{1+\\epsilon}} = \\sqrt{\\frac{1+\\epsilon-1+\\epsilon}{1+\\epsilon}} = \\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}$$\n这就是捕获粒子比例的最终闭式表达式。",
            "answer": "$$\\boxed{\\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}}$$"
        },
        {
            "introduction": "回旋动理学Vlasov方程是描述等离子体分布函数在相空间中演化的核心方程，其中一个关键组成部分是描述粒子因电磁场漂移而在空间中运动的平流项。本练习旨在建立微观粒子运动与宏观动理学方程之间的联系，您将从单个粒子的 $\\mathbf{E}\\times\\mathbf{B}$ 漂移速度出发，推导出它在回旋动理学Vlasov方程中的非线性平流项 。将此项表达为简洁的泊松括号形式，不仅是理论推导的关键一步，更是理解和开发回旋动理学模拟程序的基础，因为这种形式揭示了湍流演化的哈密顿结构。",
            "id": "4053508",
            "problem": "考虑一个与计算聚变科学与工程相关的板状几何中的强磁化等离子体，其具有均匀磁场 $\\mathbf{B} = B\\,\\mathbf{b}$，其中 $\\mathbf{b}$ 是一个恒定的单位向量。假设存在低频静电涨落，使得电场为 $\\mathbf{E}(\\mathbf{R},t) = -\\nabla \\phi(\\mathbf{R},t)$，其中 $\\phi(\\mathbf{R},t)$ 是一个仅依赖于导心位置 $\\mathbf{R}$ 的标量势。令 $g(\\mathbf{R},v_{\\parallel},\\mu,t)$ 表示微扰导心分布函数的非绝热部分，其中 $v_{\\parallel}$ 是平行速度，$\\mu$ 是磁矩。\n\n从适用于回旋动理学极限的基本定律和核心定义出发，使用洛伦兹力定律和导心分解来推导与电场相关的跨场导心漂移。然后，利用该漂移速度，将回旋动理学 Vlasov 方程中的非线性平流项写成一个作用于 $g(\\mathbf{R},v_{\\parallel},\\mu,t)$ 的算子，并使用垂直于 $\\mathbf{B}$ 的平面中的泊松括号形式进行紧凑表示。\n\n你的最终答案必须是一个单一的闭式解析表达式，用 $\\phi(\\mathbf{R},t)$、$g(\\mathbf{R},v_{\\parallel},\\mu,t)$、$\\mathbf{b}$ 和 $B$ 来表示非线性平流项。最终答案中不要包含任何推导过程。不需要进行数值计算。",
            "solution": "该问题要求推导回旋动理学 Vlasov 方程中的非线性平流项，并以泊松括号形式表示。推导将分两个主要阶段进行：首先，推导由电场引起的导心漂移速度；其次，利用此速度构建平流项。\n\n**第1部分：电漂移速度的推导**\n\n单个带电粒子（电荷为 $q$，质量为 $m$）在电场和磁场中的运动由洛伦兹力定律决定：\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\n在强而均匀的磁场 $\\mathbf{B} = B\\mathbf{b}$ 中，粒子的运动可以分解为围绕磁力线的快速回旋运动和该回旋中心的较慢漂移，该中心被称为导心。导心的速度 $\\mathbf{v}_g$ 是我们感兴趣的量。\n\n我们感兴趣的是由电场 $\\mathbf{E}$ 引起的跨场漂移速度。此漂移通常表示为 $\\mathbf{v}_E$。它是一种慢漂移，意味着与此漂移速度相关的惯性项 $m \\frac{d\\mathbf{v}}{dt}$ 与场施加的力相比可以忽略不计。在此低频极限下，垂直于 $\\mathbf{B}$ 的平面中的主导力必须平衡。设 $\\mathbf{v}_g$ 为导心速度。作用在导心上的洛伦兹力的垂直分量必须近似为零：\n$$q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{g\\perp} \\times \\mathbf{B}) \\approx 0$$\n此处，$\\mathbf{E}_{\\perp}$ 是电场垂直于 $\\mathbf{B}$ 的分量，$\\mathbf{v}_{g\\perp}$ 是垂直导心漂移速度。电漂移即为此速度，$\\mathbf{v}_E = \\mathbf{v}_{g\\perp}$。因此，$\\mathbf{v}_E$ 的方程为：\n$$\\mathbf{v}_E \\times \\mathbf{B} = -\\mathbf{E}_{\\perp}$$\n为了求解 $\\mathbf{v}_E$，我们将此方程与 $\\mathbf{B}$ 做叉积：\n$$(\\mathbf{v}_E \\times \\mathbf{B}) \\times \\mathbf{B} = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\n使用矢量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$。\n令 $\\mathbf{A} = \\mathbf{v}_E$, $\\mathbf{B} = \\mathbf{B}$, $\\mathbf{C} = \\mathbf{B}$：\n$$(\\mathbf{v}_E \\times \\mathbf{B}) \\times \\mathbf{B} = (\\mathbf{v}_E \\cdot \\mathbf{B})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{B})\\mathbf{v}_E$$\n由于 $\\mathbf{v}_E$ 垂直于 $\\mathbf{B}$，所以 $\\mathbf{v}_E \\cdot \\mathbf{B} = 0$。且 $\\mathbf{B} \\cdot \\mathbf{B} = B^2$。\n$$-B^2 \\mathbf{v}_E = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\n$$\\mathbf{v}_E = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}$$\n电场的平行分量 $\\mathbf{E}_{\\parallel}$ 不会对此跨场漂移产生贡献，因为 $\\mathbf{E}_{\\parallel} \\times \\mathbf{B}$ 也垂直于 $\\mathbf{B}$。因此，我们可以用总电场 $\\mathbf{E}$ 来表示该表达式：\n$$\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}$$\n这就是著名的 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度。它与粒子的电荷和质量无关。给定 $\\mathbf{E} = -\\nabla\\phi$ 和 $\\mathbf{B} = B\\mathbf{b}$，我们有：\n$$\\mathbf{v}_E = \\frac{(-\\nabla\\phi) \\times (B\\mathbf{b})}{B^2} = \\frac{-B(\\nabla\\phi \\times \\mathbf{b})}{B^2} = \\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)$$\n\n**第2部分：非线性平流项的构建**\n\n回旋动理学 Vlasov 方程描述了导心分布函数 $g(\\mathbf{R}, v_{\\parallel}, \\mu, t)$ 在相空间中的时间演化。其一般形式是一个守恒方程：\n$$\\frac{\\partial g}{\\partial t} + \\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g + \\frac{dv_{\\parallel}}{dt} \\frac{\\partial g}{\\partial v_{\\parallel}} + \\frac{d\\mu}{dt} \\frac{\\partial g}{\\partial \\mu} = C(g)$$\n其中 $C(g)$ 代表碰撞项，对于本问题我们可以忽略。项 $\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g$ 表示分布函数在位形空间中的平流。导心速度 $\\frac{d\\mathbf{R}}{dt}$ 包括了平行于 $\\mathbf{B}$ 的运动和垂直于 $\\mathbf{B}$ 的漂移的贡献。对于给定条件，导心速度为：\n$$\\frac{d\\mathbf{R}}{dt} = v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E$$\n因此，平流项为：\n$$\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g = (v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E) \\cdot \\nabla g = v_{\\parallel}\\mathbf{b} \\cdot \\nabla g + \\mathbf{v}_E \\cdot \\nabla g$$\n第一部分 $v_{\\parallel}\\mathbf{b} \\cdot \\nabla g$ 是平行流项。第二部分 $\\mathbf{v}_E \\cdot \\nabla g$ 表示由电漂移引起的平流。此项是非线性的，因为 $\\mathbf{v}_E$ 依赖于势 $\\phi$，而在自洽等离子体模型中，$\\phi$ 是通过准中性条件或泊松方程由粒子（包括 $g$）的分布函数决定的。\n\n现在我们代入推导出的 $\\mathbf{v}_E$ 表达式：\n$$\\text{非线性平流项} = \\mathbf{v}_E \\cdot \\nabla g = \\left(\\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)\\right) \\cdot \\nabla g$$\n为了以泊松括号形式表示，我们使用标量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$。令 $\\mathbf{A} = \\mathbf{b}$，$\\mathbf{B} = \\nabla\\phi$，$\\mathbf{C} = \\nabla g$：\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\left( \\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) \\right)$$\n表达式 $\\mathbf{b} \\cdot (\\nabla_A \\times \\nabla_C)$ 是典则泊松括号 $\\{A, C\\}$ 在垂直于 $\\mathbf{b}$ 的平面中的矢量表示。为了看清这一点，我们选择一个坐标系，其中 $\\mathbf{b} = \\mathbf{\\hat{z}}$，垂直平面为 $x-y$ 平面。梯度算子作用于导心位置 $\\mathbf{R}=(x,y,z)$。\n$$\\nabla\\phi = \\frac{\\partial\\phi}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial\\phi}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial\\phi}{\\partial z}\\mathbf{\\hat{z}}$$\n$$\\nabla g = \\frac{\\partial g}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial g}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial g}{\\partial z}\\mathbf{\\hat{z}}$$\n叉积为：\n$$\\nabla\\phi \\times \\nabla g = \\left(\\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial z} - \\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial y}\\right)\\mathbf{\\hat{x}} + \\left(\\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial x} - \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial z}\\right)\\mathbf{\\hat{y}} + \\left(\\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}\\right)\\mathbf{\\hat{z}}$$\n与 $\\mathbf{b} = \\mathbf{\\hat{z}}$ 做点积，分离出 $\\mathbf{\\hat{z}}$ 分量：\n$$\\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) = \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}$$\n这就是在垂直于磁场的空间坐标 $(x, y)$ 中泊松括号 $\\{\\phi, g\\}$ 的定义。因此，以泊松括号形式紧凑写出的非线性平流项为：\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)$$\n此表达式包含指定的量 $\\phi$、$g$、$\\mathbf{b}$ 和 $B$，并且只使用基本微分算子。梯度 $\\nabla$ 被理解为关于导心位置 $\\mathbf{R}$ 的梯度。",
            "answer": "$$\\boxed{\\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)}$$"
        },
        {
            "introduction": "回旋动理学理论的最终目标之一是建立能够预测聚变等离子体中湍流输运的模型，而离子温度梯度（ITG）模是驱动这种输运的最主要的不稳定性之一。本练习将引导您从理论走向实践，通过编写一个数值程序来实现一个简化的ITG不稳定性增长率估算模型，并使用国际公认的“Cyclone Base Case”参数进行基准检验 。这项计算实践将抽象的物理概念（如梯度、曲率、有限拉莫尔半径效应）与具体的、可量化的预测联系起来，让您亲身体验如何将复杂的动理学理论转化为具有预测能力的计算工具。",
            "id": "4053504",
            "problem": "要求您实现一个独立的数值程序，使用简化的局域回旋动理学色散模型估算 Cyclone Base Case 的线性离子温度梯度（ITG）不稳定性增长率，并将数值结果与公认的基准值进行比较。重点在于回旋动理学 Vlasov 方程及其线性化所编码的基本物理学，这通过一个包含曲率、抗磁漂移和有限拉莫尔半径效应的简化模型来表示。所有增长率必须以 $c_s/R$ 为单位表示，其中 $c_s$ 是离子声速，$R$ 是环的大半径，并以无量纲数的形式呈现。\n\n从以下基本基础开始：\n- 对于粒子种类 $s$（在本问题中为离子 $i$），回旋动理学 Vlasov 方程控制非绝热分布函数 $h_s$ 的演化：$\\partial h_s / \\partial t + v_\\parallel \\nabla_\\parallel h_s + \\mathbf{v}_D \\cdot \\nabla h_s + \\left( \\frac{q_s}{m_s} \\frac{\\partial \\langle \\phi \\rangle }{\\partial t} \\right) F_{0s} = 0$，其中 $\\langle \\cdot \\rangle$ 表示回旋平均，$F_{0s}$ 是平衡麦克斯韦分布，$\\mathbf{v}_D$ 是磁漂移速度，$\\phi$ 是静电势。\n- 在绝热电子极限下，电子密度扰动满足 $\\delta n_e = (e \\phi / T_e) n_{0e}$，其中 $e$ 是元电荷，$T_e$ 是电子温度，$n_{0e}$ 是平衡电子密度。\n- 准中性条件 $\\sum_s q_s \\delta n_s = 0$ 将离子响应与静电势耦合起来。离子的回旋平均响应通过零阶贝塞尔函数回旋平均因子 $\\Gamma_0(b)$ 引入了有限拉莫尔半径效应。\n- 抗磁漂移频率和曲率漂移频率提供了驱动和几何依赖性。使用局域（磁通管）近似，采用垂直波数 $k_y$ 和 $k_x$，并在最不稳定的气球模角处忽略平行动力学，即在线性增长率计算中设置 $k_\\parallel \\approx 0$。\n\n您的程序必须在绝热电子、静电、局域回旋动理学极限下，使用以下模型选择和定义，实现一个简化的基于色散的线性 ITG 增长率 $\\gamma$ 估算器：\n- 归一化到 $c_s/R$ 的无量纲抗磁频率为 $ \\omega_*^i = k_y \\rho_s \\, (R/L_n)$，其中 $L_n^{-1} = d\\ln n_i / dr$ 且 $R/L_n$ 已给出。\n- 曲率驱动由无量纲频率 $ \\omega_{di} = \\epsilon \\, \\omega_*^i$ 表示，其中 $\\epsilon = r/R$ 是反环径比（局域曲率参数）。\n- 温度梯度比为 $ \\eta_i = L_n / L_{T_i} = (R/L_{T_i})/(R/L_n)$，其中 $L_{T_i}^{-1} = d\\ln T_i / dr$ 且 $R/L_{T_i}$ 已给出。\n- 有限拉莫尔半径效应通过 $ b = k_\\perp^2 \\rho_i^2 = (k_y^2 + k_x^2)\\rho_i^2$ 进入，其中 $ \\rho_i/\\rho_s = \\sqrt{2 T_i/T_e} $，$T_i$ 和 $T_e$ 分别是离子和电子温度，$\\rho_s$ 是离子声回旋半径。使用精确的回旋平均因子 $ \\Gamma_0(b) = I_0(b) e^{-b}$，其中 $I_0$ 是第一类零阶修正贝塞尔函数。\n- 采用长波 Padé 稳定化方法计算有效阈值 $ \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\, \\hat{s}/q + \\alpha_{\\text{FLR}} \\, b $，其中 $\\hat{s}$ 是磁剪切，$q$ 是安全因子，$\\alpha_{\\text{sh}}, \\alpha_{\\text{FLR}}$ 是代表剪切和有限拉莫尔半径稳定化效应的量级为1的模型系数。对于本任务，设置 $ \\alpha_{\\text{sh}} = 0.3 $ 和 $ \\alpha_{\\text{FLR}} = 0.2 $。\n- 使用与上述回旋动理学要素一致的曲率驱动 ITG 启发式模型估算线性增长率：\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b},\n$$\n其中 $\\gamma$ 是无量纲的，并已归一化到 $c_s/R$。\n\n主要测试使用 Cyclone Base Case 的几何形状和梯度，除非测试套件中另有规定，否则使用以下基线参数：\n- 大半径与离子温度梯度标度长度之比：$R/L_{T_i} = 6.9$。\n- 大半径与密度梯度标度长度之比：$R/L_n = 2.2$。\n- 安全因子：$q = 1.4$。\n- 磁剪切：$\\hat{s} = 0.8$。\n- 曲率参数：$\\epsilon = r/R = 0.18$。\n- 温度比：$T_e/T_i = 1$。\n- 使用 $k_\\parallel \\approx 0$。不使用角度；所有量均为标量或无量纲参数。\n\n测试套件：\n- 每个测试用例是一个元组 $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$。\n- 对于以下情况，使用上述模型计算 $\\gamma$，并将其与公认的基准值（无量纲，单位为 $c_s/R$）进行比较。如果 $|\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03$，则认为该用例的计算成功。\n\n提供以下测试用例和公认的基准值：\n- 用例 1 (Cyclone Base Case，中等波数)：$(0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.19 $。\n- 用例 2 (Cyclone Base Case，较高波数)：$(0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.19 $。\n- 用例 3 (Cyclone Base Case，更高波数)：$(0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.14 $。\n- 用例 4 (近阈值温度梯度)：$(0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.00 $。\n- 用例 5 (Cyclone Base Case，高波数)：$(0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.10 $。\n- 用例 6 (Cyclone Base Case，带有限径向波数)：$(0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$，其中 $ \\gamma_{\\text{accepted}} = 0.15 $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,...]”）。\n- 对于每个测试用例，按上面列出的用例顺序输出一个布尔值，指示计算出的增长率是否在容差范围内与公认的基准值匹配。\n\n本问题陈述中的所有数学符号均以 LaTeX 格式呈现。以 $c_s/R$ 为单位，将所有增长率作为无量纲浮点数作答；最终程序输出是如上所述的布尔值列表。",
            "solution": "用户提供的问题陈述已经过严格审查，并被确定为有效。它在科学上基于等离子体物理和聚变科学的原理，特别是关于微观不稳定性的回旋动理学理论。该问题定义明确，提供了一套完整且一致的定义、参数和清晰的目标。它要求实现一个用于估算离子温度梯度（ITG）模增长率的简化启发式模型，这是该领域的标准练习。所提供的测试用例基于著名的 Cyclone Base Case 基准，是适当的，并允许对模型的实现进行定量评估。所有术语都有正式定义，不存在矛盾或含糊之处。\n\n解决方案首先详细说明了根据所提供的模型，为一组任意输入参数计算增长率 $\\gamma$ 的逻辑步骤。随后，在一个处理指定测试套件的程序中实现这一逻辑。\n\n问题的核心是评估启发式增长率公式：\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n$$\n此计算需要顺序确定几个中间物理量，这些物理量从一组输入参数中导出。对于每个测试用例，输入是一个形式为 $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$ 的元组。\n\n计算过程如下：\n\n1.  **解构输入参数**：对于给定的测试用例，我们识别出归一化的垂直极向波数 $k_y \\rho_s$、归一化的垂直径向波数 $k_x \\rho_s$、归一化的逆温度梯度长度 $R/L_{T_i}$、归一化的逆密度梯度长度 $R/L_n$、安全因子 $q$、磁剪切 $\\hat{s}$、局域反环径比（或曲率参数）$\\epsilon$ 以及电子与离子温度比 $T_e/T_i$。\n\n2.  **计算温度梯度参数 $\\eta_i$**：参数 $\\eta_i$ 表示密度梯度标度长度与离子温度梯度标度长度之比。大的 $\\eta_i$ 值表示相对于起稳定作用的密度梯度，存在一个强烈不稳定的温度梯度。其计算公式为：\n    $$\n    \\eta_i = \\frac{L_n}{L_{T_i}} = \\frac{R/L_{T_i}}{R/L_n}\n    $$\n\n3.  **计算有限拉莫尔半径（FLR）参数 $b$**：参数 $b$ 量化了有限拉莫尔半径（FLR）效应的重要性，该效应倾向于稳定短波长模。它是总垂直波数 $k_\\perp = \\sqrt{k_x^2 + k_y^2}$ 和离子回旋半径 $\\rho_i$ 的函数。由于输入的波数是根据离子声回旋半径 $\\rho_s$ 归一化的，我们必须首先将 $\\rho_i$ 与 $\\rho_s$ 联系起来。$\\rho_s = \\sqrt{m_i T_e}/(eB)$ 和 $\\rho_i = \\sqrt{2 m_i T_i}/(eB)$ 的定义给出了该比率：\n    $$\n    \\frac{\\rho_i}{\\rho_s} = \\sqrt{\\frac{2 T_i}{T_e}} = \\sqrt{\\frac{2}{T_e/T_i}}\n    $$\n    参数 $b$ 的计算公式为：\n    $$\n    b = k_\\perp^2 \\rho_i^2 = (k_x^2 + k_y^2) \\rho_i^2 = \\left( (k_x \\rho_s)^2 + (k_y \\rho_s)^2 \\right) \\left( \\frac{\\rho_i}{\\rho_s} \\right)^2\n    $$\n\n4.  **计算 ITG 不稳定性阈值 $\\eta_{\\text{th}}$**：ITG 模仅在 $\\eta_i$ 超过某个阈值 $\\eta_{\\text{th}}$ 时才不稳定。所提供的该阈值模型包含一个简单的流体极限（$2/3$）、磁剪切 $\\hat{s}$ 带来的稳定效应以及 FLR 效应（通过 $b$）带来的稳定效应。数值系数 $\\alpha_{\\text{sh}} = 0.3$ 和 $\\alpha_{\\text{FLR}} = 0.2$ 是模型参数。\n    $$\n    \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\frac{\\hat{s}}{q} + \\alpha_{\\text{FLR}} b\n    $$\n\n5.  **计算离子抗磁频率 $\\omega_*^i$**：此频率，归一化到 $c_s/R$，与极向波数和密度梯度成正比。它设定了漂移波的特征频率标度。\n    $$\n    \\omega_*^i = (k_y \\rho_s) \\left( \\frac{R}{L_n} \\right)\n    $$\n\n6.  **计算回旋平均因子 $\\Gamma_0(b)$**：该因子源于对离子拉莫尔轨道上的静电势进行平均。它代表了一个关键的 FLR 稳定机制。该模型使用第一类零阶修正贝塞尔函数 $I_0$ 指定了其精确形式。\n    $$\n    \\Gamma_0(b) = I_0(b) e^{-b}\n    $$\n    这将使用 `scipy.special` 库中的 `i0` 函数进行计算。\n\n7.  **组合最终增长率 $\\gamma$**：现在所有组件都已备齐。增长率 $\\gamma$ 与驱动项成正比，驱动项是 $\\eta_i$ 超过 $\\eta_{\\text{th}}$ 的量。$\\max(\\eta_i - \\eta_{\\text{th}}, 0)$ 项确保如果模式是稳定的，则增长率为零。结果按曲率漂移频率（由 $\\epsilon \\omega_*^i$ 表示）和 FLR 稳定因子进行缩放。\n    $$\n    \\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n    $$\n    分母项 $1+b$ 是流体和简单动理学模型中的一个常见特征，与准中性条件下的极化漂移屏蔽响应有关。\n\n8.  **与基准值比较**：对于每个测试用例，将计算出的增长率 $\\gamma$ 与给定的公认值 $\\gamma_{\\text{accepted}}$ 进行比较。如果绝对差在指定的容差 $0.03$ 之内，则认为测试成功：\n    $$\n    |\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03\n    $$\n    这个比较的结果是一个布尔值，构成该用例的最终结果。\n\n程序将对所提供的六个测试用例中的每一个执行此计算序列，并将布尔结果整理成一个列表以供输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes the ITG growth rate for the Cyclone Base Case test suite\n    using a simplified local gyrokinetic dispersion model and compares the\n    results to accepted benchmark values.\n    \"\"\"\n    \n    # Model coefficients\n    alpha_sh = 0.3\n    alpha_flr = 0.2\n    \n    # Tolerance for comparison with benchmark values\n    tolerance = 0.03\n\n    # Test suite: (k_y*rho_s, k_x*rho_s, R/L_Ti, R/L_n, q, s_hat, epsilon, Te/Ti), gamma_accepted\n    test_cases = [\n        # Case 1: Cyclone Base Case, medium wavenumber\n        ((0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 2: Cyclone Base Case, higher wavenumber\n        ((0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 3: Cyclone Base Case, even higher wavenumber\n        ((0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.14),\n        # Case 4: Near-threshold temperature gradient\n        ((0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0), 0.00),\n        # Case 5: Cyclone Base Case, high wavenumber\n        ((0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.10),\n        # Case 6: Cyclone Base Case with finite radial wavenumber\n        ((0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.15),\n    ]\n\n    results = []\n    \n    for case, gamma_accepted in test_cases:\n        # Unpack parameters for the current test case\n        k_y_rho_s, k_x_rho_s, R_LTi, R_Ln, q, s_hat, epsilon, Te_Ti = case\n\n        # 1. Calculate the temperature gradient parameter eta_i\n        # Avoid division by zero, though problem constraints make this unlikely.\n        if R_Ln == 0:\n            eta_i = float('inf')\n        else:\n            eta_i = R_LTi / R_Ln\n\n        # 2. Calculate the Finite Larmor Radius (FLR) parameter b\n        # rho_i^2 / rho_s^2 = 2 * Ti / Te\n        rho_ratio_sq = 2.0 / Te_Ti if Te_Ti != 0 else float('inf')\n        k_perp_rho_s_sq = k_y_rho_s**2 + k_x_rho_s**2\n        b = k_perp_rho_s_sq * rho_ratio_sq\n\n        # 3. Calculate the ITG instability threshold eta_th\n        eta_th = (2.0 / 3.0) + alpha_sh * (s_hat / q) + alpha_flr * b\n\n        # 4. Calculate the ion diamagnetic frequency omega_star_i (normalized)\n        omega_star_i = k_y_rho_s * R_Ln\n\n        # 5. Calculate the gyro-average factor Gamma_0(b)\n        # Gamma_0(b) = I_0(b) * exp(-b)\n        gamma_0_b = i0(b) * np.exp(-b)\n\n        # 6. Assemble the final growth rate gamma\n        # The drive term is max(eta_i - eta_th, 0)\n        drive_term = max(eta_i - eta_th, 0)\n        \n        # Denominator term (1+b) from polarization shielding\n        stabilization_term = gamma_0_b / (1.0 + b)\n\n        gamma = omega_star_i * epsilon * drive_term * stabilization_term\n        \n        # 7. Compare with the accepted benchmark value within tolerance\n        is_match = abs(gamma - gamma_accepted) = tolerance\n        results.append(is_match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}