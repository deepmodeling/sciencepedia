{
    "hands_on_practices": [
        {
            "introduction": "The gyrokinetic Vlasov equation's primary role is to describe plasma turbulence, which is fundamentally driven by the nonlinear advection of the particle distribution by fluctuating fields. This exercise solidifies the derivation of this crucial term, linking the fundamental $\\mathbf{E} \\times \\mathbf{B}$ drift to the elegant and powerful Poisson-bracket notation used in advanced gyrokinetic models . Mastering this derivation is essential for understanding the engine of turbulent transport.",
            "id": "4053508",
            "problem": "Consider a strongly magnetized plasma in slab geometry relevant to computational fusion science and engineering, with a uniform magnetic field $\\mathbf{B} = B\\,\\mathbf{b}$, where $\\mathbf{b}$ is a constant unit vector. Assume low-frequency, electrostatic fluctuations such that the electric field is $\\mathbf{E}(\\mathbf{R},t) = -\\nabla \\phi(\\mathbf{R},t)$, with $\\phi(\\mathbf{R},t)$ a scalar potential that depends only on the gyrocenter position $\\mathbf{R}$. Let $g(\\mathbf{R},v_{\\parallel},\\mu,t)$ denote the non-adiabatic part of the perturbed gyrocenter distribution function, with $v_{\\parallel}$ the parallel velocity and $\\mu$ the magnetic moment.\n\nStarting from fundamental laws and core definitions suitable to the gyrokinetic limit, use the Lorentz force law and the guiding-center decomposition to derive the cross-field guiding-center drift associated with the electric field. Then, using that drift velocity, write the nonlinear advection term in the gyrokinetic Vlasov equation as an operator acting on $g(\\mathbf{R},v_{\\parallel},\\mu,t)$, expressed compactly using a Poisson-bracket form in the plane perpendicular to $\\mathbf{B}$.\n\nYour final answer must be a single closed-form analytic expression giving the nonlinear advection term in terms of $\\phi(\\mathbf{R},t)$, $g(\\mathbf{R},v_{\\parallel},\\mu,t)$, $\\mathbf{b}$, and $B$. Do not include any derivation in the final answer. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the nonlinear advection term in the gyrokinetic Vlasov equation, expressed in a Poisson-bracket form. The derivation will proceed in two main stages: first, deriving the guiding-center drift velocity caused by the electric field, and second, formulating the advection term using this velocity.\n\n**Part 1: Derivation of the Electric Drift Velocity**\n\nThe motion of a single charged particle (with charge $q$ and mass $m$) in electric and magnetic fields is governed by the Lorentz force law:\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\nIn a strong, uniform magnetic field $\\mathbf{B} = B\\mathbf{b}$, the particle's motion can be decomposed into rapid gyration around a magnetic field line and a slower drift of the center of that gyration, known as the guiding center. The velocity of the guiding center, $\\mathbf{v}_g$, is the quantity of interest.\n\nWe are interested in the cross-field drift velocity caused by the electric field $\\mathbf{E}$. This drift is commonly denoted as $\\mathbf{v}_E$. It is a slow drift, meaning the inertial term $m \\frac{d\\mathbf{v}}{dt}$ associated with this drift velocity is negligible compared to the forces exerted by the fields. In this low-frequency limit, the dominant forces in the plane perpendicular to $\\mathbf{B}$ must balance. Let $\\mathbf{v}_g$ be the guiding-center velocity. The perpendicular component of the Lorentz force on the guiding center must be approximately zero:\n$$q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{g\\perp} \\times \\mathbf{B}) \\approx 0$$\nHere, $\\mathbf{E}_{\\perp}$ is the component of the electric field perpendicular to $\\mathbf{B}$, and $\\mathbf{v}_{g\\perp}$ is the perpendicular guiding-center drift velocity. The electric drift is this velocity, $\\mathbf{v}_E = \\mathbf{v}_{g\\perp}$. The equation for $\\mathbf{v}_E$ is thus:\n$$\\mathbf{v}_E \\times \\mathbf{B} = -\\mathbf{E}_{\\perp}$$\nTo solve for $\\mathbf{v}_E$, we take the cross product of this equation with $\\mathbf{B}$:\n$$(\\mathbf{v}_E \\times \\mathbf{B}) \\times \\mathbf{B} = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\nUsing the vector triple product identity $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$, with $\\mathbf{A} = \\mathbf{v}_E$, $\\mathbf{B} = \\mathbf{B}$, and $\\mathbf{C} = \\mathbf{B}$, we get:\n$$(\\mathbf{v}_E \\cdot \\mathbf{B})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{B})\\mathbf{v}_E = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\nSince $\\mathbf{v}_E$ is a perpendicular drift, $\\mathbf{v}_E \\cdot \\mathbf{B} = 0$. Also, $\\mathbf{B} \\cdot \\mathbf{B} = B^2$. The equation simplifies to:\n$$-B^2 \\mathbf{v}_E = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\n$$\\mathbf{v}_E = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}$$\nThe parallel component of the electric field $\\mathbf{E}_{\\parallel}$ would not contribute to this cross-field drift, as $\\mathbf{E}_{\\parallel} \\times \\mathbf{B}$ is also perpendicular to $\\mathbf{B}$. Thus, we can write the expression in terms of the full electric field $\\mathbf{E}$:\n$$\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}$$\nThis is the renowned $\\mathbf{E} \\times \\mathbf{B}$ drift velocity. It is independent of the particle's charge and mass. Given $\\mathbf{E} = -\\nabla\\phi$ and $\\mathbf{B} = B\\mathbf{b}$, we have:\n$$\\mathbf{v}_E = \\frac{(-\\nabla\\phi) \\times (B\\mathbf{b})}{B^2} = \\frac{-B(\\nabla\\phi \\times \\mathbf{b})}{B^2} = \\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)$$\n\n**Part 2: Formulation of the Nonlinear Advection Term**\n\nThe gyrokinetic Vlasov equation describes the time evolution of the gyrocenter distribution function $g(\\mathbf{R}, v_{\\parallel}, \\mu, t)$ in phase space. In its general form, it is a conservation equation:\n$$\\frac{\\partial g}{\\partial t} + \\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g + \\frac{dv_{\\parallel}}{dt} \\frac{\\partial g}{\\partial v_{\\parallel}} + \\frac{d\\mu}{dt} \\frac{\\partial g}{\\partial \\mu} = C(g)$$\nwhere $C(g)$ represents collision terms, which we can ignore for this problem. The term $\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g$ represents the advection of the distribution function in configuration space. The velocity of the gyrocenter $\\frac{d\\mathbf{R}}{dt}$ includes contributions from motion parallel to $\\mathbf{B}$ and drifts perpendicular to $\\mathbf{B}$. For the conditions given, the gyrocenter velocity is:\n$$\\frac{d\\mathbf{R}}{dt} = v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E$$\nThe advection term is therefore:\n$$\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g = (v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E) \\cdot \\nabla g = v_{\\parallel}\\mathbf{b} \\cdot \\nabla g + \\mathbf{v}_E \\cdot \\nabla g$$\nThe first part, $v_{\\parallel}\\mathbf{b} \\cdot \\nabla g$, is the parallel streaming term. The second part, $\\mathbf{v}_E \\cdot \\nabla g$, represents advection due to the electric drift. This term is nonlinear because $\\mathbf{v}_E$ depends on the potential $\\phi$, which in a self-consistent plasma model is determined by the distribution functions of the particles (including $g$) through the quasineutrality condition or Poisson's equation.\n\nWe now substitute the derived expression for $\\mathbf{v}_E$:\n$$\\text{Nonlinear advection term} = \\mathbf{v}_E \\cdot \\nabla g = \\left(\\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)\\right) \\cdot \\nabla g$$\nTo express this in a Poisson-bracket form, we use the scalar triple product identity $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$. Let $\\mathbf{A} = \\mathbf{b}$, $\\mathbf{B} = \\nabla\\phi$, and $\\mathbf{C} = \\nabla g$:\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\left( \\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) \\right)$$\nThe expression $\\mathbf{b} \\cdot (\\nabla_A \\times \\nabla_C)$ is the vector representation of the canonical Poisson bracket $\\{A, C\\}$ in the plane perpendicular to $\\mathbf{b}$. To see this, let's choose a coordinate system where $\\mathbf{b} = \\mathbf{\\hat{z}}$ and the perpendicular plane is the $x-y$ plane. The gradient operators act on the gyrocenter position $\\mathbf{R}=(x,y,z)$.\n$$\\nabla\\phi = \\frac{\\partial\\phi}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial\\phi}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial\\phi}{\\partial z}\\mathbf{\\hat{z}}$$\n$$\\nabla g = \\frac{\\partial g}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial g}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial g}{\\partial z}\\mathbf{\\hat{z}}$$\nThe cross product is:\n$$\\nabla\\phi \\times \\nabla g = \\left(\\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial z} - \\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial y}\\right)\\mathbf{\\hat{x}} + \\left(\\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial x} - \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial z}\\right)\\mathbf{\\hat{y}} + \\left(\\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}\\right)\\mathbf{\\hat{z}}$$\nTaking the dot product with $\\mathbf{b} = \\mathbf{\\hat{z}}$ isolates the $\\mathbf{\\hat{z}}$ component:\n$$\\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) = \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}$$\nThis is the definition of the Poisson bracket $\\{\\phi, g\\}$ in the spatial coordinates $(x, y)$ perpendicular to the magnetic field. Therefore, the nonlinear advection term, written compactly in a Poisson-bracket form, is:\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)$$\nThis expression contains the specified quantities $\\phi$, $g$, $\\mathbf{b}$, and $B$, and uses only fundamental differential operators. The gradient $\\nabla$ is understood to be the gradient with respect to the gyrocenter position $\\mathbf{R}$.",
            "answer": "$$\\boxed{\\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)}$$"
        },
        {
            "introduction": "Building on the concept of guiding-center drifts, this practice shifts focus from electric field-induced motion to drifts arising from the inherent inhomogeneity of the confining magnetic field. Calculating the magnitude of the magnetic gradient and curvature drifts in a tokamak geometry provides crucial physical intuition, allowing you to compare their importance against the $\\mathbf{E} \\times \\mathbf{B}$ drift . This analysis is key to understanding how these drifts act as a conduit, tapping into plasma pressure gradients to provide the free energy for microinstabilities.",
            "id": "4053579",
            "problem": "Consider an axisymmetric, large-aspect-ratio circular tokamak with major radius $R$ and minor radius $r$ (assume $R \\gg r$), containing an ion species of charge $q_i = Z e$ and a Maxwellian ion distribution at temperature $T_i$. The dynamics are described by the gyrokinetic Vlasov equation (GKV equation), in which the distribution function is constant along characteristics defined by guiding-center motion. In the guiding-center approximation with small Larmor-radius ordering, the cross-field drift velocity is composed of the magnetic gradient drift $\\mathbf{v}_{\\nabla B}$ and the magnetic curvature drift $\\mathbf{v}_C$. Using only fundamental definitions and well-tested facts, derive an expression for the thermal-averaged magnitude of the combined drift speed $|\\mathbf{v}_{\\nabla B} + \\mathbf{v}_C|$ in a large-aspect-ratio circular tokamak where the toroidal magnetic field has magnitude $B$ and the field-line curvature scale is set by $R$.\n\nAssume:\n- The magnetic moment is $\\mu = m_i v_{\\perp}^{2} / (2 B)$, where $m_i$ is the ion mass, $v_{\\perp}$ is the perpendicular speed, and $B$ is the magnetic field magnitude.\n- The magnetic field unit vector is $\\mathbf{b} = \\mathbf{B}/B$, the curvature is $\\boldsymbol{\\kappa} = \\mathbf{b} \\cdot \\nabla \\mathbf{b}$, and for a circular tokamak $|\\boldsymbol{\\kappa}| \\approx 1/R$ and $|\\mathbf{b} \\times \\nabla B| \\approx B/R$ on the outboard midplane.\n- The ion distribution is Maxwellian, so that the parallel and perpendicular second moments satisfy $\\langle v_{\\parallel}^{2} \\rangle = k_B T_i / m_i$ and $\\langle v_{\\perp}^{2} \\rangle = 2 k_B T_i / m_i$, where $k_B$ is the Boltzmann constant.\n- The temperature $T_i$ is specified in kilo-electronvolts (keV), so that $k_B T_i$ should be interpreted as $T_i$ (in electronvolts) times $e$.\n\nThen compute the dimensionless ratio\n$$\\mathcal{R} \\equiv \\frac{\\langle |\\mathbf{v}_{\\nabla B} + \\mathbf{v}_C| \\rangle}{|\\mathbf{v}_E|},$$\nwhere $|\\mathbf{v}_E| = |\\mathbf{E}|/B$ is the magnitude of the $\\mathbf{E}\\times\\mathbf{B}$ drift speed for a typical perpendicular electric field $|\\mathbf{E}|$. Use the following parameters: $R = 1.7\\,\\text{m}$, $r = 0.5\\,\\text{m}$, $B = 3.0\\,\\text{T}$, $Z = 1$, $T_i = 2.0\\,\\text{keV}$, and $|\\mathbf{E}| = 5.0\\,\\text{kV/m}$. Report the final value of $\\mathcal{R}$ as a dimensionless number, rounded to four significant figures. No units are required for $\\mathcal{R}$.",
            "solution": "The user has requested the derivation of the thermal-averaged guiding-center drift speed in a tokamak and the calculation of a dimensionless ratio.\n\nThe problem statement has been validated and is found to be scientifically grounded, well-posed, and objective. The provided physical parameters and approximations are standard in the field of fusion plasma physics.\n\nWe begin by stating the fundamental definitions for the magnetic gradient drift, $\\mathbf{v}_{\\nabla B}$, and the magnetic curvature drift, $\\mathbf{v}_C$, for a particle of charge $q_i$ and mass $m_i$ in a magnetic field $\\mathbf{B}$.\nThe gradient drift is given by:\n$$ \\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q_i B} (\\mathbf{b} \\times \\nabla B) $$\nwhere $\\mu = \\frac{m_i v_{\\perp}^2}{2B}$ is the magnetic moment, $v_{\\perp}$ is the particle's velocity component perpendicular to $\\mathbf{B}$, and $\\mathbf{b} = \\mathbf{B}/B$ is the unit vector along the magnetic field.\n\nThe curvature drift is given by:\n$$ \\mathbf{v}_C = \\frac{m_i v_{\\parallel}^2}{q_i B} (\\mathbf{b} \\times \\boldsymbol{\\kappa}) $$\nwhere $v_{\\parallel}$ is the particle's velocity component parallel to $\\mathbf{B}$, and $\\boldsymbol{\\kappa} = (\\mathbf{b} \\cdot \\nabla) \\mathbf{b}$ is the magnetic field line curvature vector.\n\nThe total cross-field drift velocity due to magnetic field inhomogeneity, $\\mathbf{v}_d$, is the sum of these two drifts:\n$$ \\mathbf{v}_d = \\mathbf{v}_{\\nabla B} + \\mathbf{v}_C = \\frac{1}{q_i B} \\left[ \\mu (\\mathbf{b} \\times \\nabla B) + m_i v_{\\parallel}^2 (\\mathbf{b} \\times \\boldsymbol{\\kappa}) \\right] $$\nSubstituting the expression for $\\mu$:\n$$ \\mathbf{v}_d = \\frac{m_i}{q_i B} \\left[ \\frac{v_{\\perp}^2}{2B} (\\mathbf{b} \\times \\nabla B) + v_{\\parallel}^2 (\\mathbf{b} \\times \\boldsymbol{\\kappa}) \\right] $$\nFor a large-aspect-ratio circular tokamak, on the outboard midplane, the magnetic field is primarily toroidal ($\\mathbf{b}$ is in the toroidal direction), while the magnetic field gradient $\\nabla B$ and the curvature vector $\\boldsymbol{\\kappa}$ both point radially inwards, towards the major axis of the torus. Therefore, both $\\nabla B$ and $\\boldsymbol{\\kappa}$ are perpendicular to $\\mathbf{b}$. This implies that the vectors $(\\mathbf{b} \\times \\nabla B)$ and $(\\mathbf{b} \\times \\boldsymbol{\\kappa})$ are parallel (both point in the vertical direction). Consequently, the total drift speed is the sum of the magnitudes of the individual drifts:\n$$ |\\mathbf{v}_d| = |\\mathbf{v}_{\\nabla B}| + |\\mathbf{v}_C| $$\nUsing the assumptions provided in the problem statement, $|\\mathbf{b} \\times \\nabla B| \\approx B/R$ and $|\\boldsymbol{\\kappa}| \\approx 1/R$. Since $\\mathbf{b}$ is perpendicular to $\\nabla B$ and $\\boldsymbol{\\kappa}$, we have $|\\mathbf{b} \\times \\nabla B| = |\\mathbf{b}||\\nabla B| \\sin(\\pi/2) = |\\nabla B|$ and $|\\mathbf{b} \\times \\boldsymbol{\\kappa}| = |\\mathbf{b}||\\boldsymbol{\\kappa}| \\sin(\\pi/2) = |\\boldsymbol{\\kappa}|$.\nThis gives us $|\\nabla B| \\approx B/R$ and $|\\boldsymbol{\\kappa}| \\approx 1/R$. The directions of the vectors are also the same (radially inward), so we can state the vector relationship $\\nabla B/B \\approx \\boldsymbol{\\kappa}$.\nSubstituting $\\nabla B \\approx B \\boldsymbol{\\kappa}$ into the combined drift expression:\n$$ \\mathbf{v}_d \\approx \\frac{m_i}{q_i B} \\left[ \\frac{v_{\\perp}^2}{2B} (\\mathbf{b} \\times (B\\boldsymbol{\\kappa})) + v_{\\parallel}^2 (\\mathbf{b} \\times \\boldsymbol{\\kappa}) \\right] = \\frac{m_i}{q_i B} \\left( \\frac{v_{\\perp}^2}{2} + v_{\\parallel}^2 \\right) (\\mathbf{b} \\times \\boldsymbol{\\kappa}) $$\nThe magnitude of this drift is:\n$$ |\\mathbf{v}_d| \\approx \\frac{m_i}{|q_i| B} \\left( \\frac{v_{\\perp}^2}{2} + v_{\\parallel}^2 \\right) |\\mathbf{b} \\times \\boldsymbol{\\kappa}| = \\frac{m_i}{|q_i| B} \\left( \\frac{v_{\\perp}^2}{2} + v_{\\parallel}^2 \\right) |\\boldsymbol{\\kappa}| $$\nUsing $|\\boldsymbol{\\kappa}| \\approx 1/R$, we obtain the expression for the drift speed:\n$$ |\\mathbf{v}_d| \\approx \\frac{m_i}{|q_i| B R} \\left( \\frac{v_{\\perp}^2}{2} + v_{\\parallel}^2 \\right) $$\nTo find the thermal-averaged magnitude, we take the expectation value over the ion velocity distribution, which is given as Maxwellian:\n$$ \\langle |\\mathbf{v}_d| \\rangle = \\left\\langle \\frac{m_i}{|q_i| B R} \\left( \\frac{v_{\\perp}^2}{2} + v_{\\parallel}^2 \\right) \\right\\rangle $$\nSince $m_i$, $q_i$, $B$, and $R$ are not functions of velocity, we can write:\n$$ \\langle |\\mathbf{v}_d| \\rangle = \\frac{m_i}{|q_i| B R} \\left( \\frac{1}{2}\\langle v_{\\perp}^2 \\rangle + \\langle v_{\\parallel}^2 \\rangle \\right) $$\nThe problem provides the second moments for the Maxwellian distribution: $\\langle v_{\\parallel}^{2} \\rangle = k_B T_i / m_i$ and $\\langle v_{\\perp}^{2} \\rangle = 2 k_B T_i / m_i$, where $k_B$ is the Boltzmann constant and $T_i$ is the ion temperature. Substituting these into the equation for the averaged drift speed:\n$$ \\langle |\\mathbf{v}_d| \\rangle = \\frac{m_i}{|q_i| B R} \\left[ \\frac{1}{2}\\left(\\frac{2 k_B T_i}{m_i}\\right) + \\left(\\frac{k_B T_i}{m_i}\\right) \\right] $$\n$$ \\langle |\\mathbf{v}_d| \\rangle = \\frac{m_i}{|q_i| B R} \\left[ \\frac{k_B T_i}{m_i} + \\frac{k_B T_i}{m_i} \\right] = \\frac{m_i}{|q_i| B R} \\left( \\frac{2 k_B T_i}{m_i} \\right) $$\nThe ion mass $m_i$ cancels, and substituting $|q_i| = Z e$:\n$$ \\langle |\\mathbf{v}_{\\nabla B} + \\mathbf{v}_C| \\rangle = \\frac{2 k_B T_i}{Z e B R} $$\nThis completes the first part of the problem.\n\nNext, we compute the dimensionless ratio $\\mathcal{R}$:\n$$ \\mathcal{R} \\equiv \\frac{\\langle |\\mathbf{v}_{\\nabla B} + \\mathbf{v}_C| \\rangle}{|\\mathbf{v}_E|} $$\nwhere $|\\mathbf{v}_E| = |\\mathbf{E}|/B$ is the magnitude of the $\\mathbf{E}\\times\\mathbf{B}$ drift.\nSubstituting the expressions for the averaged drift and the $\\mathbf{E}\\times\\mathbf{B}$ drift:\n$$ \\mathcal{R} = \\frac{\\frac{2 k_B T_i}{Z e B R}}{\\frac{|\\mathbf{E}|}{B}} = \\frac{2 k_B T_i}{Z e R |\\mathbf{E}|} $$\nThe magnetic field magnitude $B$ cancels from the ratio.\nThe problem states that for a temperature $T_i$ given in keV, the energy $k_B T_i$ should be interpreted as $T_i$ (in electronvolts) times the elementary charge $e$. Let $T_{i,eV}$ be the numerical value of the temperature in units of electronvolts. Then $k_B T_i = T_{i,eV} \\cdot e$.\nSubstituting this into the expression for $\\mathcal{R}$:\n$$ \\mathcal{R} = \\frac{2 (T_{i,eV} \\cdot e)}{Z e R |\\mathbf{E}|} = \\frac{2 T_{i,eV}}{Z R |\\mathbf{E}|} $$\nThe elementary charge $e$ also cancels. This allows us to perform the calculation with energies in eV and electric potentials in V.\n\nWe are given the following parameters:\n$T_i = 2.0\\,\\text{keV} \\implies T_{i,eV} = 2000$.\n$Z = 1$.\n$R = 1.7\\,\\text{m}$.\n$|\\mathbf{E}| = 5.0\\,\\text{kV/m} = 5000\\,\\text{V/m}$.\n\nSubstituting these values into the expression for $\\mathcal{R}$:\n$$ \\mathcal{R} = \\frac{2 \\times 2000}{1 \\times 1.7\\,\\text{m} \\times 5000\\,\\text{V/m}} = \\frac{4000}{8500} = \\frac{40}{85} = \\frac{8}{17} $$\nNow, we compute the numerical value and round to four significant figures:\n$$ \\mathcal{R} = \\frac{8}{17} \\approx 0.4705882... $$\nRounding to four significant figures, we get $\\mathcal{R} \\approx 0.4706$.",
            "answer": "$$\n\\boxed{0.4706}\n$$"
        },
        {
            "introduction": "This final practice bridges theory and application by challenging you to implement a computational model for a critical plasma phenomenon: the Ion Temperature Gradient (ITG) instability. By synthesizing concepts like diamagnetic and curvature drifts, gradient-driven free energy, and finite Larmor radius stabilization, you will estimate the instability's growth rate for the famous Cyclone Base Case . This exercise provides direct experience in how the components of the gyrokinetic framework are assembled to make quantitative predictions relevant to fusion energy research.",
            "id": "4053504",
            "problem": "You are asked to implement a self-contained numerical program that estimates the linear Ion Temperature Gradient (ITG) growth rate for the Cyclone Base Case using a simplified local gyrokinetic dispersion model and compares the numerical results to accepted benchmark values. The focus is on the fundamental physics encoded by the gyrokinetic Vlasov equation and its linearization, represented through a reduced model that incorporates curvature, diamagnetic drift, and finite Larmor radius effects. All growth rates must be expressed in units of $c_s/R$, where $c_s$ is the ion sound speed and $R$ is the major radius of the torus, and presented as dimensionless numbers.\n\nStart from the following fundamental base:\n- The gyrokinetic Vlasov equation for species $s$ (ions $i$ in this problem) governs the evolution of the non-adiabatic distribution function $h_s$: $\\partial h_s / \\partial t + v_\\parallel \\nabla_\\parallel h_s + \\mathbf{v}_D \\cdot \\nabla h_s + \\left( \\frac{q_s}{m_s} \\frac{\\partial \\langle \\phi \\rangle }{\\partial t} \\right) F_{0s} = 0$, where $\\langle \\cdot \\rangle$ denotes gyro-average, $F_{0s}$ is the equilibrium Maxwellian, $\\mathbf{v}_D$ is the magnetic drift velocity, and $\\phi$ is the electrostatic potential.\n- In the adiabatic electron limit, the electron density perturbation satisfies $\\delta n_e = (e \\phi / T_e) n_{0e}$, where $e$ is the elementary charge, $T_e$ is the electron temperature, and $n_{0e}$ is the equilibrium electron density.\n- Quasi-neutrality, $\\sum_s q_s \\delta n_s = 0$, couples the ion response to the electrostatic potential. The ion gyro-averaged response introduces finite Larmor radius effects through the zeroth-order Bessel function gyro-average factor $\\Gamma_0(b)$.\n- Diamagnetic drift frequencies and curvature drift frequencies provide the drive and geometry dependence. Use the local (flux-tube) approximation with perpendicular wavenumbers $k_y$ and $k_x$, and neglect parallel dynamics at the most unstable ballooning angle, i.e., set $k_\\parallel \\approx 0$ for the linear growth-rate calculation.\n\nYour program must implement a simplified dispersion-based estimator for the linear ITG growth rate $\\gamma$ in the adiabatic-electron, electrostatic, local gyrokinetic limit, using the following modeling choices and definitions:\n- The dimensionless diamagnetic frequency normalized to $c_s/R$ is $ \\omega_*^i = k_y \\rho_s \\, (R/L_n)$, where $L_n^{-1} = d\\ln n_i / dr$ and $R/L_n$ is provided.\n- The curvature drive is represented by the dimensionless frequency $ \\omega_{di} = \\epsilon \\, \\omega_*^i$, where $\\epsilon = r/R$ is the inverse aspect-ratio (local curvature parameter).\n- The temperature gradient ratio is $ \\eta_i = L_n / L_{T_i} = (R/L_{T_i})/(R/L_n)$, where $L_{T_i}^{-1} = d\\ln T_i / dr$ and $R/L_{T_i}$ is provided.\n- Finite Larmor radius effects enter through $ b = k_\\perp^2 \\rho_i^2 = (k_y^2 + k_x^2)\\rho_i^2$, with $ \\rho_i/\\rho_s = \\sqrt{2 T_i/T_e} $, where $T_i$ and $T_e$ are ion and electron temperatures, and $\\rho_s$ is the ion sound gyroradius. Use the exact gyro-average factor $ \\Gamma_0(b) = I_0(b) e^{-b}$, where $I_0$ is the zeroth-order modified Bessel function of the first kind.\n- Adopt the long-wavelength Pad√© stabilization for the effective threshold using $ \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\, \\hat{s}/q + \\alpha_{\\text{FLR}} \\, b $, where $\\hat{s}$ is the magnetic shear, $q$ is the safety factor, and $\\alpha_{\\text{sh}}, \\alpha_{\\text{FLR}}$ are order-unity model coefficients representing shear and finite Larmor radius stabilization. For this assignment, set $ \\alpha_{\\text{sh}} = 0.3 $ and $ \\alpha_{\\text{FLR}} = 0.2 $.\n- Estimate the linear growth rate using the curvature-driven ITG heuristic consistent with the above gyrokinetic ingredients:\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b},\n$$\nwhere $\\gamma$ is dimensionless and normalized to $c_s/R$.\n\nUse the Cyclone Base Case geometry and gradients for the primary tests, with the following baseline parameters unless otherwise specified in the test suite:\n- Major radius to ion temperature gradient scale: $R/L_{T_i} = 6.9$.\n- Major radius to density gradient scale: $R/L_n = 2.2$.\n- Safety factor: $q = 1.4$.\n- Magnetic shear: $\\hat{s} = 0.8$.\n- Curvature parameter: $\\epsilon = r/R = 0.18$.\n- Temperature ratio: $T_e/T_i = 1$.\n- Use $k_\\parallel \\approx 0$. Angles are not used; all quantities are scalars or dimensionless parameters.\n\nTest suite:\n- Each test case is a tuple $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$.\n- For the following cases, compute $\\gamma$ using the model above and compare it to the accepted benchmark value (dimensionless, in units of $c_s/R$). Consider the computation successful for a case if $|\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03$.\n\nProvide the following test cases and accepted benchmark values:\n- Case 1 (Cyclone Base Case, medium wavenumber): $(0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.19 $.\n- Case 2 (Cyclone Base Case, higher wavenumber): $(0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.19 $.\n- Case 3 (Cyclone Base Case, even higher wavenumber): $(0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.14 $.\n- Case 4 (near-threshold temperature gradient): $(0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.00 $.\n- Case 5 (Cyclone Base Case, high wavenumber): $(0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.10 $.\n- Case 6 (Cyclone Base Case with finite radial wavenumber): $(0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.15 $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").\n- For each test case, output a boolean indicating whether the computed growth rate matches the accepted benchmark within the tolerance, in the order of the cases listed above.\n\nAll mathematical symbols in this problem statement are presented in LaTeX. Answer all growth rates in units of $c_s/R$ as dimensionless floats; the final program output is a list of booleans as specified above.",
            "solution": "The user-provided problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of plasma physics and fusion science, specifically concerning the gyrokinetic theory of microinstabilities. The problem is well-posed, providing a complete and consistent set of definitions, parameters, and a clear objective. It requests the implementation of a simplified, heuristic model for the Ion Temperature Gradient (ITG) mode growth rate, a standard exercise in the field. The provided test cases, based on the well-known Cyclone Base Case benchmark, are appropriate and allow for a quantitative assessment of the model's implementation. All terms are formally defined, and no contradictions or ambiguities are present.\n\nThe solution proceeds by first detailing the logical steps to compute the growth rate $\\gamma$ according to the provided model for an arbitrary set of input parameters. This is followed by the implementation of this logic in a program that processes the specified test suite.\n\nThe core of the problem is the evaluation of the heuristic growth rate formula:\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n$$\nThis calculation requires the sequential determination of several intermediate physical quantities, which are derived from a set of input parameters. For each test case, the input is a tuple of the form $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$.\n\nThe computational procedure is as follows:\n\n1.  **Deconstruct Input Parameters**: For a given test case, we identify the normalized perpendicular poloidal wavenumber $k_y \\rho_s$, the normalized perpendicular radial wavenumber $k_x \\rho_s$, the normalized inverse temperature gradient length $R/L_{T_i}$, the normalized inverse density gradient length $R/L_n$, the safety factor $q$, the magnetic shear $\\hat{s}$, the local inverse aspect ratio (or curvature parameter) $\\epsilon$, and the electron-to-ion temperature ratio $T_e/T_i$.\n\n2.  **Calculate the Temperature Gradient Parameter $\\eta_i$**: The parameter $\\eta_i$ represents the ratio of the density gradient scale length to the ion temperature gradient scale length. A large $\\eta_i$ signifies a strongly destabilizing temperature gradient relative to the stabilizing density gradient. It is calculated as:\n    $$\n    \\eta_i = \\frac{L_n}{L_{T_i}} = \\frac{R/L_{T_i}}{R/L_n}\n    $$\n\n3.  **Calculate the Finite Larmor Radius (FLR) Parameter $b$**: The parameter $b$ quantifies the importance of finite Larmor radius (FLR) effects, which tend to stabilize short-wavelength modes. It is a function of the total perpendicular wavenumber $k_\\perp = \\sqrt{k_x^2 + k_y^2}$ and the ion gyroradius $\\rho_i$. Since the input wavenumbers are normalized to the ion sound gyroradius $\\rho_s$, we must first relate $\\rho_i$ to $\\rho_s$. The definition of $\\rho_s = \\sqrt{m_i T_e}/(eB)$ and $\\rho_i = \\sqrt{2 m_i T_i}/(eB)$ gives the ratio:\n    $$\n    \\frac{\\rho_i}{\\rho_s} = \\sqrt{\\frac{2 T_i}{T_e}} = \\sqrt{\\frac{2}{T_e/T_i}}\n    $$\n    The parameter $b$ is then computed as:\n    $$\n    b = k_\\perp^2 \\rho_i^2 = (k_x^2 + k_y^2) \\rho_i^2 = \\left( (k_x \\rho_s)^2 + (k_y \\rho_s)^2 \\right) \\left( \\frac{\\rho_i}{\\rho_s} \\right)^2\n    $$\n\n4.  **Calculate the ITG Instability Threshold $\\eta_{\\text{th}}$**: The ITG mode is unstable only when $\\eta_i$ exceeds a certain threshold, $\\eta_{\\text{th}}$. The provided model for this threshold incorporates a a simple fluid limit ($2/3$), a stabilizing effect from magnetic shear $\\hat{s}$, and a stabilizing effect from FLR effects (via $b$). The numeric coefficients $\\alpha_{\\text{sh}} = 0.3$ and $\\alpha_{\\text{FLR}} = 0.2$ are model parameters.\n    $$\n    \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\frac{\\hat{s}}{q} + \\alpha_{\\text{FLR}} b\n    $$\n\n5.  **Calculate the Ion Diamagnetic Frequency $\\omega_*^i$**: This frequency, normalized to $c_s/R$, is proportional to the poloidal wavenumber and the density gradient. It sets the characteristic frequency scale for the drift waves.\n    $$\n    \\omega_*^i = (k_y \\rho_s) \\left( \\frac{R}{L_n} \\right)\n    $$\n\n6.  **Calculate the Gyro-average Factor $\\Gamma_0(b)$**: This factor arises from averaging the electrostatic potential over the Larmor orbit of an ion. It represents a key FLR stabilization mechanism. The model specifies the exact form using the zeroth-order modified Bessel function of the first kind, $I_0$.\n    $$\n    \\Gamma_0(b) = I_0(b) e^{-b}\n    $$\n    This will be computed using the `i0` function from the `scipy.special` library.\n\n7.  **Assemble the Final Growth Rate $\\gamma$**: All components are now available. The growth rate $\\gamma$ is proportional to the drive, which is the amount by which $\\eta_i$ exceeds $\\eta_{\\text{th}}$. The term $\\max(\\eta_i - \\eta_{\\text{th}}, 0)$ ensures that the growth rate is zero if the mode is stable. The result is scaled by the curvature drift frequency (represented by $\\epsilon \\omega_*^i$) and the FLR stabilization factor.\n    $$\n    \\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n    $$\n    The denominator term $1+b$ is a common feature in fluid and simple kinetic models, related to the polarization drift shielding response in the quasi-neutrality condition.\n\n8.  **Compare with Benchmark**: For each test case, the computed growth rate $\\gamma$ is compared against the given accepted value $\\gamma_{\\text{accepted}}$. The test is considered successful if the absolute difference is within the specified tolerance of $0.03$:\n    $$\n    |\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03\n    $$\n    The outcome of this comparison, a boolean value, constitutes the final result for that case.\n\nThe program will execute this sequence of calculations for each of the six test cases provided and will collate the boolean results into a single list for output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes the ITG growth rate for the Cyclone Base Case test suite\n    using a simplified local gyrokinetic dispersion model and compares the\n    results to accepted benchmark values.\n    \"\"\"\n    \n    # Model coefficients\n    alpha_sh = 0.3\n    alpha_flr = 0.2\n    \n    # Tolerance for comparison with benchmark values\n    tolerance = 0.03\n\n    # Test suite: (k_y*rho_s, k_x*rho_s, R/L_Ti, R/L_n, q, s_hat, epsilon, Te/Ti), gamma_accepted\n    test_cases = [\n        # Case 1: Cyclone Base Case, medium wavenumber\n        ((0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 2: Cyclone Base Case, higher wavenumber\n        ((0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 3: Cyclone Base Case, even higher wavenumber\n        ((0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.14),\n        # Case 4: Near-threshold temperature gradient\n        ((0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0), 0.00),\n        # Case 5: Cyclone Base Case, high wavenumber\n        ((0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.10),\n        # Case 6: Cyclone Base Case with finite radial wavenumber\n        ((0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.15),\n    ]\n\n    results = []\n    \n    for case, gamma_accepted in test_cases:\n        # Unpack parameters for the current test case\n        k_y_rho_s, k_x_rho_s, R_LTi, R_Ln, q, s_hat, epsilon, Te_Ti = case\n\n        # 1. Calculate the temperature gradient parameter eta_i\n        # Avoid division by zero, though problem constraints make this unlikely.\n        if R_Ln == 0:\n            eta_i = float('inf')\n        else:\n            eta_i = R_LTi / R_Ln\n\n        # 2. Calculate the Finite Larmor Radius (FLR) parameter b\n        # rho_i^2 / rho_s^2 = 2 * Ti / Te\n        rho_ratio_sq = 2.0 / Te_Ti if Te_Ti != 0 else float('inf')\n        k_perp_rho_s_sq = k_y_rho_s**2 + k_x_rho_s**2\n        b = k_perp_rho_s_sq * rho_ratio_sq\n\n        # 3. Calculate the ITG instability threshold eta_th\n        eta_th = (2.0 / 3.0) + alpha_sh * (s_hat / q) + alpha_flr * b\n\n        # 4. Calculate the ion diamagnetic frequency omega_star_i (normalized)\n        omega_star_i = k_y_rho_s * R_Ln\n\n        # 5. Calculate the gyro-average factor Gamma_0(b)\n        # Gamma_0(b) = I_0(b) * exp(-b)\n        gamma_0_b = i0(b) * np.exp(-b)\n\n        # 6. Assemble the final growth rate gamma\n        # The drive term is max(eta_i - eta_th, 0)\n        drive_term = max(eta_i - eta_th, 0)\n        \n        # Denominator term (1+b) from polarization shielding\n        stabilization_term = gamma_0_b / (1.0 + b)\n\n        gamma = omega_star_i * epsilon * drive_term * stabilization_term\n        \n        # 7. Compare with the accepted benchmark value within tolerance\n        is_match = abs(gamma - gamma_accepted) = tolerance\n        results.append(is_match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}