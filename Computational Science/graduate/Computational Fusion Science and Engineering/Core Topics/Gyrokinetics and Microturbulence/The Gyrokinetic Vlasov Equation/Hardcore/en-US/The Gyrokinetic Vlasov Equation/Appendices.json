{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complexities of the full gyrokinetic Vlasov equation, it is essential to understand the underlying motion of individual charged particles in a tokamak's magnetic field. This exercise guides you through the derivation of the particle trapping condition from first principles—the conservation of energy and magnetic moment. Mastering this concept is crucial, as the distinction between trapped and passing particles is fundamental to understanding plasma transport, neoclassical effects, and the formation of key instabilities. ",
            "id": "4053549",
            "problem": "Consider collisionless charged particles governed by the gyrokinetic (GK) Vlasov equation in a large–aspect-ratio, circular, concentric tokamak. On a given magnetic flux surface of minor radius $r$ and major radius $R_0$, the magnetic field magnitude as a function of poloidal angle $\\theta$ can be modeled by $B(\\theta) = B_0 \\left(1 - \\epsilon \\cos \\theta\\right)$, where $B_0$ is a constant reference magnitude and $\\epsilon = r/R_0 \\ll 1$. Denote by $B_{\\min}$ and $B_{\\max}$ the minimum and maximum values of $B(\\theta)$ encountered along a field line on this surface.\n\nStarting from the conservation of the single-particle energy $E = m v^2/2$ and the magnetic moment $\\mu = m v_{\\perp}^2/(2B)$ in a slowly varying magnetic field, derive the pitch-angle trapping condition in the form of an inequality involving $v_{\\parallel}$, $v$, $B_{\\min}$, and a field magnitude $B$ along the orbit. Then, specialize this condition to the maximum-field location along the field line.\n\nAssume a monoenergetic, isotropic distribution of particle velocities at the outboard midplane (the location where $B(\\theta)$ is minimal). Compute the fraction of velocity-space directions at that location that satisfy the trapping condition, expressed solely in terms of the inverse aspect ratio parameter $\\epsilon$. Provide the final trapped fraction as a single closed-form analytic expression. Do not include units in your final expression.",
            "solution": "The motion of a charged particle in the slowly varying magnetic field of a tokamak is characterized by the conservation of its energy $E$ and magnetic moment $\\mu$. These are given by:\n$$E = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2) = \\text{constant}$$\n$$\\mu = \\frac{m v_{\\perp}^2}{2B} = \\text{constant}$$\nHere, $m$ is the particle mass, $v$ is its total speed, $v_{\\parallel}$ is the component of velocity parallel to the magnetic field $\\vec{B}$, $v_{\\perp}$ is the component perpendicular to $\\vec{B}$, and $B=|\\vec{B}|$ is the magnetic field magnitude. Since $E$ and $m$ are constant, the particle's speed $v$ is also constant along its orbit.\n\nFrom the conservation of $\\mu$, we can express the perpendicular velocity squared at any point along the particle's trajectory as $v_{\\perp}^2 = \\frac{2B\\mu}{m}$. Substituting this into the energy conservation equation gives an expression for the parallel velocity squared:\n$$v_{\\parallel}^2 = v^2 - v_{\\perp}^2 = v^2 - \\frac{2B\\mu}{m}$$\nA particle is considered \"trapped\" if its parallel motion is reversed, which occurs at a \"bounce point\" or \"mirror point\" where $v_{\\parallel}=0$. Let the magnetic field at this bounce point be $B_b$. The condition $v_{\\parallel}=0$ implies that $v^2 = \\frac{2B_b\\mu}{m}$, or equivalently, $E = \\mu B_b$. A particle is trapped within the magnetic well of the tokamak if its bounce occurs at a field strength $B_b$ that is less than or equal to the maximum field strength on the flux surface, $B_{\\max}$. Thus, the general condition for a particle to be trapped is:\n$$B_b \\le B_{\\max} \\implies \\frac{E}{\\mu} \\le B_{\\max}$$\nWe can express the ratio $E/\\mu$, which is constant for a given particle, in terms of the local velocity components at any point with field strength $B$:\n$$\\frac{E}{\\mu} = \\frac{\\frac{1}{2}mv^2}{\\frac{m v_{\\perp}^2}{2B}} = \\frac{v^2 B}{v_{\\perp}^2}$$\nSince $v_{\\perp}^2 = v^2 - v_{\\parallel}^2$, this becomes:\n$$\\frac{E}{\\mu} = \\frac{v^2 B}{v^2 - v_{\\parallel}^2}$$\nSubstituting this into the trapping inequality gives:\n$$\\frac{v^2 B}{v^2 - v_{\\parallel}^2} \\le B_{\\max}$$\nAssuming the particle is not at a bounce point (i.e., $v_{\\perp}^2 > 0$), we can rearrange the inequality:\n$$v^2 B \\le B_{\\max}(v^2 - v_{\\parallel}^2)$$\n$$B_{\\max} v_{\\parallel}^2 \\le B_{\\max}v^2 - B v^2$$\nDividing by $v^2 B_{\\max}$ yields the general pitch-angle trapping condition:\n$$\\frac{v_{\\parallel}^2}{v^2} \\le 1 - \\frac{B}{B_{\\max}}$$\nThis inequality relates the particle's pitch ($v_{\\parallel}/v$) at a local field $B$ to the maximum field $B_{\\max}$ on the flux surface. The problem asks for an inequality involving $B_{\\min}$, but $B_{\\max}$ is the physically relevant quantity that defines the magnetic mirror.\n\nTo specialize this condition to the maximum-field location, we set $B=B_{\\max}$. The inequality becomes:\n$$\\frac{v_{\\parallel}^2(B_{\\max})}{v^2} \\le 1 - \\frac{B_{\\max}}{B_{\\max}} = 0$$\nSince $v_{\\parallel}^2$ must be non-negative, this implies $v_{\\parallel}(B_{\\max}) = 0$. This is physically consistent: the only trapped particles that can be found at the point of maximum magnetic field are those that are exactly at their bounce point.\n\nNext, we compute the fraction of trapped particles for a monoenergetic, isotropic velocity distribution at the outboard midplane. The outboard midplane corresponds to the poloidal angle $\\theta=0$, which is the location of the minimum magnetic field $B_{\\min}$. The assumption of an isotropic distribution means that the velocity vectors are uniformly distributed over all possible directions in velocity space. For a monoenergetic distribution, these vectors all lie on the surface of a sphere of radius $v$. The fraction of trapped particles is the fraction of the solid angle of this sphere that satisfies the trapping condition.\n\nWe evaluate the trapping condition at the outboard midplane, where $B=B_{\\min}$:\n$$\\frac{v_{\\parallel, \\min}^2}{v^2} \\le 1 - \\frac{B_{\\min}}{B_{\\max}}$$\nHere, $v_{\\parallel, \\min}$ is the parallel velocity at the outboard midplane. Let $\\xi_0$ be the pitch angle at this location, defined by $v_{\\parallel, \\min} = v \\cos \\xi_0$. The condition becomes:\n$$\\cos^2\\xi_0 \\le 1 - \\frac{B_{\\min}}{B_{\\max}}$$\nThe set of trapped particles corresponds to pitch angles $\\xi_0$ that satisfy this inequality. This defines a \"trapped\" region in velocity space, symmetric about the plane perpendicular to the magnetic field. The boundary of the \"passing\" particle region (the loss cone) is given by the critical angle $\\xi_c$ where equality holds:\n$$\\cos^2\\xi_c = 1 - \\frac{B_{\\min}}{B_{\\max}} \\implies |\\cos\\xi_c| = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}}$$\nThe passing particles are those with pitch angles close to $0$ and $\\pi$, i.e., $0 \\le \\xi_0  \\xi_c$ and $\\pi-\\xi_c  \\xi_0 \\le \\pi$. The trapped particles are those with pitch angles in the range $\\xi_c \\le \\xi_0 \\le \\pi - \\xi_c$.\n\nThe solid angle element in velocity space is $d\\Omega = \\sin\\xi_0 d\\xi_0 d\\phi$, where $\\phi$ is the gyrophase angle. The total solid angle is $\\int_0^{2\\pi}d\\phi\\int_0^{\\pi}\\sin\\xi_0 d\\xi_0=4\\pi$. The solid angle occupied by trapped particles is:\n$$\\Omega_{\\text{trap}} = \\int_0^{2\\pi} d\\phi \\int_{\\xi_c}^{\\pi-\\xi_c} \\sin\\xi_0 d\\xi_0 = 2\\pi \\left[-\\cos\\xi_0\\right]_{\\xi_c}^{\\pi-\\xi_c}$$\n$$\\Omega_{\\text{trap}} = 2\\pi \\left(-\\cos(\\pi-\\xi_c) - (-\\cos\\xi_c)\\right) = 2\\pi(\\cos\\xi_c + \\cos\\xi_c) = 4\\pi\\cos\\xi_c$$\nThe fraction of trapped particles, $f_{\\text{trap}}$, is the ratio of the trapped solid angle to the total solid angle:\n$$f_{\\text{trap}} = \\frac{\\Omega_{\\text{trap}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi\\cos\\xi_c}{4\\pi} = \\cos\\xi_c = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}}$$\nThe final step is to express this fraction in terms of the inverse aspect ratio $\\epsilon$. From the given magnetic field model, $B(\\theta) = B_0(1-\\epsilon\\cos\\theta)$:\nThe minimum magnetic field occurs at $\\theta=0$: $B_{\\min} = B_0(1-\\epsilon)$.\nThe maximum magnetic field occurs at $\\theta=\\pi$: $B_{\\max} = B_0(1+\\epsilon)$.\nThe ratio is:\n$$\\frac{B_{\\min}}{B_{\\max}} = \\frac{B_0(1-\\epsilon)}{B_0(1+\\epsilon)} = \\frac{1-\\epsilon}{1+\\epsilon}$$\nSubstituting this into the expression for the trapped fraction:\n$$f_{\\text{trap}} = \\sqrt{1 - \\frac{1-\\epsilon}{1+\\epsilon}} = \\sqrt{\\frac{(1+\\epsilon) - (1-\\epsilon)}{1+\\epsilon}} = \\sqrt{\\frac{1+\\epsilon-1+\\epsilon}{1+\\epsilon}} = \\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}$$\nThis is the final closed-form expression for the fraction of trapped particles.",
            "answer": "$$\\boxed{\\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}}$$"
        },
        {
            "introduction": "Having established the behavior of single particles, we now turn to the collective dynamics described by the distribution function. The gyrokinetic Vlasov equation's nonlinearity, which is the ultimate source of turbulence, is dominated by the advection of the distribution function by the self-consistent $\\mathbf{E} \\times \\mathbf{B}$ drift. This practice focuses on deriving this critical term and expressing it in the elegant and computationally efficient Poisson-bracket form, a cornerstone of modern gyrokinetic simulations. ",
            "id": "4053508",
            "problem": "Consider a strongly magnetized plasma in slab geometry relevant to computational fusion science and engineering, with a uniform magnetic field $\\mathbf{B} = B\\,\\mathbf{b}$, where $\\mathbf{b}$ is a constant unit vector. Assume low-frequency, electrostatic fluctuations such that the electric field is $\\mathbf{E}(\\mathbf{R},t) = -\\nabla \\phi(\\mathbf{R},t)$, with $\\phi(\\mathbf{R},t)$ a scalar potential that depends only on the gyrocenter position $\\mathbf{R}$. Let $g(\\mathbf{R},v_{\\parallel},\\mu,t)$ denote the non-adiabatic part of the perturbed gyrocenter distribution function, with $v_{\\parallel}$ the parallel velocity and $\\mu$ the magnetic moment.\n\nStarting from fundamental laws and core definitions suitable to the gyrokinetic limit, use the Lorentz force law and the guiding-center decomposition to derive the cross-field guiding-center drift associated with the electric field. Then, using that drift velocity, write the nonlinear advection term in the gyrokinetic Vlasov equation as an operator acting on $g(\\mathbf{R},v_{\\parallel},\\mu,t)$, expressed compactly using a Poisson-bracket form in the plane perpendicular to $\\mathbf{B}$.\n\nYour final answer must be a single closed-form analytic expression giving the nonlinear advection term in terms of $\\phi(\\mathbf{R},t)$, $g(\\mathbf{R},v_{\\parallel},\\mu,t)$, $\\mathbf{b}$, and $B$. Do not include any derivation in the final answer. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the nonlinear advection term in the gyrokinetic Vlasov equation, expressed in a Poisson-bracket form. The derivation will proceed in two main stages: first, deriving the guiding-center drift velocity caused by the electric field, and second, formulating the advection term using this velocity.\n\n**Part 1: Derivation of the Electric Drift Velocity**\n\nThe motion of a single charged particle (with charge $q$ and mass $m$) in electric and magnetic fields is governed by the Lorentz force law:\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\nIn a strong, uniform magnetic field $\\mathbf{B} = B\\mathbf{b}$, the particle's motion can be decomposed into rapid gyration around a magnetic field line and a slower drift of the center of that gyration, known as the guiding center. The velocity of the guiding center, $\\mathbf{v}_g$, is the quantity of interest.\n\nWe are interested in the cross-field drift velocity caused by the electric field $\\mathbf{E}$. This drift is commonly denoted as $\\mathbf{v}_E$. It is a slow drift, meaning the inertial term $m \\frac{d\\mathbf{v}}{dt}$ associated with this drift velocity is negligible compared to the forces exerted by the fields. In this low-frequency limit, the dominant forces in the plane perpendicular to $\\mathbf{B}$ must balance. Let $\\mathbf{v}_g$ be the guiding-center velocity. The perpendicular component of the Lorentz force on the guiding center must be approximately zero:\n$$q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{g\\perp} \\times \\mathbf{B}) \\approx 0$$\nHere, $\\mathbf{E}_{\\perp}$ is the component of the electric field perpendicular to $\\mathbf{B}$, and $\\mathbf{v}_{g\\perp}$ is the perpendicular guiding-center drift velocity. The electric drift is this velocity, $\\mathbf{v}_E = \\mathbf{v}_{g\\perp}$. The equation for $\\mathbf{v}_E$ is thus:\n$$\\mathbf{v}_E \\times \\mathbf{B} = -\\mathbf{E}_{\\perp}$$\nTo solve for $\\mathbf{v}_E$, we take the cross product of this equation with $\\mathbf{B}$:\n$$(\\mathbf{v}_E \\times \\mathbf{B}) \\times \\mathbf{B} = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\nUsing the vector triple product identity $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$, with $\\mathbf{A} = \\mathbf{v}_E$, $\\mathbf{B} = \\mathbf{B}$, $\\mathbf{C} = \\mathbf{B}$:\n$$(\\mathbf{v}_E \\times \\mathbf{B}) \\times \\mathbf{B} = (\\mathbf{v}_E \\cdot \\mathbf{B})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{B})\\mathbf{v}_E$$\nSince $\\mathbf{v}_E$ is perpendicular to $\\mathbf{B}$, $\\mathbf{v}_E \\cdot \\mathbf{B} = 0$. And $\\mathbf{B} \\cdot \\mathbf{B} = B^2$.\n$$-B^2 \\mathbf{v}_E = -\\mathbf{E}_{\\perp} \\times \\mathbf{B}$$\n$$\\mathbf{v}_E = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}$$\nThe parallel component of the electric field $\\mathbf{E}_{\\parallel}$ would not contribute to this cross-field drift, as $\\mathbf{E}_{\\parallel} \\times \\mathbf{B}$ is also perpendicular to $\\mathbf{B}$. Thus, we can write the expression in terms of the full electric field $\\mathbf{E}$:\n$$\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}$$\nThis is the renowned $\\mathbf{E} \\times \\mathbf{B}$ drift velocity. It is independent of the particle's charge and mass. Given $\\mathbf{E} = -\\nabla\\phi$ and $\\mathbf{B} = B\\mathbf{b}$, we have:\n$$\\mathbf{v}_E = \\frac{(-\\nabla\\phi) \\times (B\\mathbf{b})}{B^2} = \\frac{-B(\\nabla\\phi \\times \\mathbf{b})}{B^2} = \\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)$$\n\n**Part 2: Formulation of the Nonlinear Advection Term**\n\nThe gyrokinetic Vlasov equation describes the time evolution of the gyrocenter distribution function $g(\\mathbf{R}, v_{\\parallel}, \\mu, t)$ in phase space. In its general form, it is a conservation equation:\n$$\\frac{\\partial g}{\\partial t} + \\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g + \\frac{dv_{\\parallel}}{dt} \\frac{\\partial g}{\\partial v_{\\parallel}} + \\frac{d\\mu}{dt} \\frac{\\partial g}{\\partial \\mu} = C(g)$$\nwhere $C(g)$ represents collision terms, which we can ignore for this problem. The term $\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g$ represents the advection of the distribution function in configuration space. The velocity of the gyrocenter $\\frac{d\\mathbf{R}}{dt}$ includes contributions from motion parallel to $\\mathbf{B}$ and drifts perpendicular to $\\mathbf{B}$. For the conditions given, the gyrocenter velocity is:\n$$\\frac{d\\mathbf{R}}{dt} = v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E$$\nThe advection term is therefore:\n$$\\frac{d\\mathbf{R}}{dt} \\cdot \\nabla_{\\mathbf{R}} g = (v_{\\parallel}\\mathbf{b} + \\mathbf{v}_E) \\cdot \\nabla g = v_{\\parallel}\\mathbf{b} \\cdot \\nabla g + \\mathbf{v}_E \\cdot \\nabla g$$\nThe first part, $v_{\\parallel}\\mathbf{b} \\cdot \\nabla g$, is the parallel streaming term. The second part, $\\mathbf{v}_E \\cdot \\nabla g$, represents advection due to the electric drift. This term is nonlinear because $\\mathbf{v}_E$ depends on the potential $\\phi$, which in a self-consistent plasma model is determined by the distribution functions of the particles (including $g$) through the quasineutrality condition or Poisson's equation.\n\nWe now substitute the derived expression for $\\mathbf{v}_E$:\n$$\\text{Nonlinear advection term} = \\mathbf{v}_E \\cdot \\nabla g = \\left(\\frac{1}{B}(\\mathbf{b} \\times \\nabla\\phi)\\right) \\cdot \\nabla g$$\nTo express this in a Poisson-bracket form, we use the scalar triple product identity $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$. Let $\\mathbf{A} = \\mathbf{b}$, $\\mathbf{B} = \\nabla\\phi$, and $\\mathbf{C} = \\nabla g$:\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\left( \\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) \\right)$$\nThe expression $\\mathbf{b} \\cdot (\\nabla_A \\times \\nabla_C)$ is the vector representation of the canonical Poisson bracket $\\{A, C\\}$ in the plane perpendicular to $\\mathbf{b}$. To see this, let's choose a coordinate system where $\\mathbf{b} = \\mathbf{\\hat{z}}$ and the perpendicular plane is the $x-y$ plane. The gradient operators act on the gyrocenter position $\\mathbf{R}=(x,y,z)$.\n$$\\nabla\\phi = \\frac{\\partial\\phi}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial\\phi}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial\\phi}{\\partial z}\\mathbf{\\hat{z}}$$\n$$\\nabla g = \\frac{\\partial g}{\\partial x}\\mathbf{\\hat{x}} + \\frac{\\partial g}{\\partial y}\\mathbf{\\hat{y}} + \\frac{\\partial g}{\\partial z}\\mathbf{\\hat{z}}$$\nThe cross product is:\n$$\\nabla\\phi \\times \\nabla g = \\left(\\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial z} - \\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial y}\\right)\\mathbf{\\hat{x}} + \\left(\\frac{\\partial\\phi}{\\partial z}\\frac{\\partial g}{\\partial x} - \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial z}\\right)\\mathbf{\\hat{y}} + \\left(\\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}\\right)\\mathbf{\\hat{z}}$$\nTaking the dot product with $\\mathbf{b} = \\mathbf{\\hat{z}}$ isolates the $\\mathbf{\\hat{z}}$ component:\n$$\\mathbf{b} \\cdot (\\nabla\\phi \\times \\nabla g) = \\frac{\\partial\\phi}{\\partial x}\\frac{\\partial g}{\\partial y} - \\frac{\\partial\\phi}{\\partial y}\\frac{\\partial g}{\\partial x}$$\nThis is the definition of the Poisson bracket $\\{\\phi, g\\}$ in the spatial coordinates $(x, y)$ perpendicular to the magnetic field. Therefore, the nonlinear advection term, written compactly in a Poisson-bracket form, is:\n$$\\mathbf{v}_E \\cdot \\nabla g = \\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)$$\nThis expression contains the specified quantities $\\phi$, $g$, $\\mathbf{b}$, and $B$, and uses only fundamental differential operators. The gradient $\\nabla$ is understood to be the gradient with respect to the gyrocenter position $\\mathbf{R}$.",
            "answer": "$$\\boxed{\\frac{1}{B} \\mathbf{b} \\cdot (\\nabla \\phi \\times \\nabla g)}$$"
        },
        {
            "introduction": "Theory finds its ultimate test in application and comparison with experimental or benchmark results. This final practice bridges the gap between the abstract formalism of the gyrokinetic equation and the practical task of predicting plasma behavior by having you implement a computational model for the Ion Temperature Gradient (ITG) instability. By calculating the instability's growth rate for the famous Cyclone Base Case, you will synthesize concepts like temperature gradients, drifts, and finite Larmor radius effects to produce a quantitative prediction and validate it against established benchmark results. ",
            "id": "4053504",
            "problem": "You are asked to implement a self-contained numerical program that estimates the linear Ion Temperature Gradient (ITG) growth rate for the Cyclone Base Case using a simplified local gyrokinetic dispersion model and compares the numerical results to accepted benchmark values. The focus is on the fundamental physics encoded by the gyrokinetic Vlasov equation and its linearization, represented through a reduced model that incorporates curvature, diamagnetic drift, and finite Larmor radius effects. All growth rates must be expressed in units of $c_s/R$, where $c_s$ is the ion sound speed and $R$ is the major radius of the torus, and presented as dimensionless numbers.\n\nStart from the following fundamental base:\n- The gyrokinetic Vlasov equation for species $s$ (ions $i$ in this problem) governs the evolution of the non-adiabatic distribution function $h_s$: $\\partial h_s / \\partial t + v_\\parallel \\nabla_\\parallel h_s + \\mathbf{v}_D \\cdot \\nabla h_s + \\left( \\frac{q_s}{m_s} \\frac{\\partial \\langle \\phi \\rangle }{\\partial t} \\right) F_{0s} = 0$, where $\\langle \\cdot \\rangle$ denotes gyro-average, $F_{0s}$ is the equilibrium Maxwellian, $\\mathbf{v}_D$ is the magnetic drift velocity, and $\\phi$ is the electrostatic potential.\n- In the adiabatic electron limit, the electron density perturbation satisfies $\\delta n_e = (e \\phi / T_e) n_{0e}$, where $e$ is the elementary charge, $T_e$ is the electron temperature, and $n_{0e}$ is the equilibrium electron density.\n- Quasi-neutrality, $\\sum_s q_s \\delta n_s = 0$, couples the ion response to the electrostatic potential. The ion gyro-averaged response introduces finite Larmor radius effects through the zeroth-order Bessel function gyro-average factor $\\Gamma_0(b)$.\n- Diamagnetic drift frequencies and curvature drift frequencies provide the drive and geometry dependence. Use the local (flux-tube) approximation with perpendicular wavenumbers $k_y$ and $k_x$, and neglect parallel dynamics at the most unstable ballooning angle, i.e., set $k_\\parallel \\approx 0$ for the linear growth-rate calculation.\n\nYour program must implement a simplified dispersion-based estimator for the linear ITG growth rate $\\gamma$ in the adiabatic-electron, electrostatic, local gyrokinetic limit, using the following modeling choices and definitions:\n- The dimensionless diamagnetic frequency normalized to $c_s/R$ is $ \\omega_*^i = k_y \\rho_s \\, (R/L_n)$, where $L_n^{-1} = d\\ln n_i / dr$ and $R/L_n$ is provided.\n- The curvature drive is represented by the dimensionless frequency $ \\omega_{di} = \\epsilon \\, \\omega_*^i$, where $\\epsilon = r/R$ is the inverse aspect-ratio (local curvature parameter).\n- The temperature gradient ratio is $ \\eta_i = L_n / L_{T_i} = (R/L_{T_i})/(R/L_n)$, where $L_{T_i}^{-1} = d\\ln T_i / dr$ and $R/L_{T_i}$ is provided.\n- Finite Larmor radius effects enter through $ b = k_\\perp^2 \\rho_i^2 = (k_y^2 + k_x^2)\\rho_i^2$, with $ \\rho_i/\\rho_s = \\sqrt{2 T_i/T_e} $, where $T_i$ and $T_e$ are ion and electron temperatures, and $\\rho_s$ is the ion sound gyroradius. Use the exact gyro-average factor $ \\Gamma_0(b) = I_0(b) e^{-b}$, where $I_0$ is the zeroth-order modified Bessel function of the first kind.\n- Adopt the long-wavelength Padé stabilization for the effective threshold using $ \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\, \\hat{s}/q + \\alpha_{\\text{FLR}} \\, b $, where $\\hat{s}$ is the magnetic shear, $q$ is the safety factor, and $\\alpha_{\\text{sh}}, \\alpha_{\\text{FLR}}$ are order-unity model coefficients representing shear and finite Larmor radius stabilization. For this assignment, set $ \\alpha_{\\text{sh}} = 0.3 $ and $ \\alpha_{\\text{FLR}} = 0.2 $.\n- Estimate the linear growth rate using the curvature-driven ITG heuristic consistent with the above gyrokinetic ingredients:\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b},\n$$\nwhere $\\gamma$ is dimensionless and normalized to $c_s/R$.\n\nUse the Cyclone Base Case geometry and gradients for the primary tests, with the following baseline parameters unless otherwise specified in the test suite:\n- Major radius to ion temperature gradient scale: $R/L_{T_i} = 6.9$.\n- Major radius to density gradient scale: $R/L_n = 2.2$.\n- Safety factor: $q = 1.4$.\n- Magnetic shear: $\\hat{s} = 0.8$.\n- Curvature parameter: $\\epsilon = r/R = 0.18$.\n- Temperature ratio: $T_e/T_i = 1$.\n- Use $k_\\parallel \\approx 0$. Angles are not used; all quantities are scalars or dimensionless parameters.\n\nTest suite:\n- Each test case is a tuple $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$.\n- For the following cases, compute $\\gamma$ using the model above and compare it to the accepted benchmark value (dimensionless, in units of $c_s/R$). Consider the computation successful for a case if $|\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03$.\n\nProvide the following test cases and accepted benchmark values:\n- Case 1 (Cyclone Base Case, medium wavenumber): $(0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.19 $.\n- Case 2 (Cyclone Base Case, higher wavenumber): $(0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.19 $.\n- Case 3 (Cyclone Base Case, even higher wavenumber): $(0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.14 $.\n- Case 4 (near-threshold temperature gradient): $(0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.00 $.\n- Case 5 (Cyclone Base Case, high wavenumber): $(0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.10 $.\n- Case 6 (Cyclone Base Case with finite radial wavenumber): $(0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0)$ with $ \\gamma_{\\text{accepted}} = 0.15 $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").\n- For each test case, output a boolean indicating whether the computed growth rate matches the accepted benchmark within the tolerance, in the order of the cases listed above.\n\nAll mathematical symbols in this problem statement are presented in LaTeX. Answer all growth rates in units of $c_s/R$ as dimensionless floats; the final program output is a list of booleans as specified above.",
            "solution": "The solution proceeds by first detailing the logical steps to compute the growth rate $\\gamma$ according to the provided model for an arbitrary set of input parameters. This is followed by the implementation of this logic in a program that processes the specified test suite.\n\nThe core of the problem is the evaluation of the heuristic growth rate formula:\n$$\n\\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n$$\nThis calculation requires the sequential determination of several intermediate physical quantities, which are derived from a set of input parameters. For each test case, the input is a tuple of the form $(k_y \\rho_s, k_x \\rho_s, R/L_{T_i}, R/L_n, q, \\hat{s}, \\epsilon, T_e/T_i)$.\n\nThe computational procedure is as follows:\n\n1.  **Deconstruct Input Parameters**: For a given test case, we identify the normalized perpendicular poloidal wavenumber $k_y \\rho_s$, the normalized perpendicular radial wavenumber $k_x \\rho_s$, the normalized inverse temperature gradient length $R/L_{T_i}$, the normalized inverse density gradient length $R/L_n$, the safety factor $q$, the magnetic shear $\\hat{s}$, the local inverse aspect ratio (or curvature parameter) $\\epsilon$, and the electron-to-ion temperature ratio $T_e/T_i$.\n\n2.  **Calculate the Temperature Gradient Parameter $\\eta_i$**: The parameter $\\eta_i$ represents the ratio of the density gradient scale length to the ion temperature gradient scale length. A large $\\eta_i$ signifies a strongly destabilizing temperature gradient relative to the stabilizing density gradient. It is calculated as:\n    $$\n    \\eta_i = \\frac{L_n}{L_{T_i}} = \\frac{R/L_{T_i}}{R/L_n}\n    $$\n\n3.  **Calculate the Finite Larmor Radius (FLR) Parameter $b$**: The parameter $b$ quantifies the importance of finite Larmor radius (FLR) effects, which tend to stabilize short-wavelength modes. It is a function of the total perpendicular wavenumber $k_\\perp = \\sqrt{k_x^2 + k_y^2}$ and the ion gyroradius $\\rho_i$. Since the input wavenumbers are normalized to the ion sound gyroradius $\\rho_s$, we must first relate $\\rho_i$ to $\\rho_s$. The ratio is given by:\n    $$\n    \\frac{\\rho_i}{\\rho_s} = \\sqrt{\\frac{2 T_i}{T_e}} = \\sqrt{\\frac{2}{T_e/T_i}}\n    $$\n    The parameter $b$ is then computed as:\n    $$\n    b = k_\\perp^2 \\rho_i^2 = \\left( (k_x \\rho_s)^2 + (k_y \\rho_s)^2 \\right) \\left( \\frac{\\rho_i}{\\rho_s} \\right)^2\n    $$\n\n4.  **Calculate the ITG Instability Threshold $\\eta_{\\text{th}}$**: The ITG mode is unstable only when $\\eta_i$ exceeds a certain threshold, $\\eta_{\\text{th}}$. The provided model for this threshold incorporates a a simple fluid limit ($2/3$), a stabilizing effect from magnetic shear $\\hat{s}$, and a stabilizing effect from FLR effects (via $b$). The numeric coefficients $\\alpha_{\\text{sh}} = 0.3$ and $\\alpha_{\\text{FLR}} = 0.2$ are model parameters.\n    $$\n    \\eta_{\\text{th}} = \\frac{2}{3} + \\alpha_{\\text{sh}} \\frac{\\hat{s}}{q} + \\alpha_{\\text{FLR}} b\n    $$\n\n5.  **Calculate the Ion Diamagnetic Frequency $\\omega_*^i$**: This frequency, normalized to $c_s/R$, is proportional to the poloidal wavenumber and the density gradient. It sets the characteristic frequency scale for the drift waves.\n    $$\n    \\omega_*^i = (k_y \\rho_s) \\left( \\frac{R}{L_n} \\right)\n    $$\n\n6.  **Calculate the Gyro-average Factor $\\Gamma_0(b)$**: This factor arises from averaging the electrostatic potential over the Larmor orbit of an ion. It represents a key FLR stabilization mechanism. The model specifies the exact form using the zeroth-order modified Bessel function of the first kind, $I_0$.\n    $$\n    \\Gamma_0(b) = I_0(b) e^{-b}\n    $$\n    This will be computed using an appropriate scientific library function.\n\n7.  **Assemble the Final Growth Rate $\\gamma$**: All components are now available. The growth rate $\\gamma$ is proportional to the drive, which is the amount by which $\\eta_i$ exceeds $\\eta_{\\text{th}}$. The term $\\max(\\eta_i - \\eta_{\\text{th}}, 0)$ ensures that the growth rate is zero if the mode is stable. The result is scaled by the curvature drift frequency (represented by $\\epsilon \\omega_*^i$) and the FLR stabilization factor.\n    $$\n    \\gamma = \\omega_*^i \\, \\epsilon \\, \\max\\!\\big( \\eta_i - \\eta_{\\text{th}}, 0 \\big) \\, \\frac{\\Gamma_0(b)}{1+b}\n    $$\n    The denominator term $1+b$ is a common feature in fluid and simple kinetic models, related to the polarization drift shielding response in the quasi-neutrality condition.\n\n8.  **Compare with Benchmark**: For each test case, the computed growth rate $\\gamma$ is compared against the given accepted value $\\gamma_{\\text{accepted}}$. The test is considered successful if the absolute difference is within the specified tolerance of $0.03$:\n    $$\n    |\\gamma - \\gamma_{\\text{accepted}}| \\le 0.03\n    $$\n    The outcome of this comparison, a boolean value, constitutes the final result for that case.\n\nThe program will execute this sequence of calculations for each of the six test cases provided and will collate the boolean results into a single list for output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes the ITG growth rate for the Cyclone Base Case test suite\n    using a simplified local gyrokinetic dispersion model and compares the\n    results to accepted benchmark values.\n    \"\"\"\n    \n    # Model coefficients\n    alpha_sh = 0.3\n    alpha_flr = 0.2\n    \n    # Tolerance for comparison with benchmark values\n    tolerance = 0.03\n\n    # Test suite: (k_y*rho_s, k_x*rho_s, R/L_Ti, R/L_n, q, s_hat, epsilon, Te/Ti), gamma_accepted\n    test_cases = [\n        # Case 1: Cyclone Base Case, medium wavenumber\n        ((0.3, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 2: Cyclone Base Case, higher wavenumber\n        ((0.5, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.19),\n        # Case 3: Cyclone Base Case, even higher wavenumber\n        ((0.7, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.14),\n        # Case 4: Near-threshold temperature gradient\n        ((0.3, 0.0, 1.8, 2.2, 1.4, 0.8, 0.18, 1.0), 0.00),\n        # Case 5: Cyclone Base Case, high wavenumber\n        ((0.9, 0.0, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.10),\n        # Case 6: Cyclone Base Case with finite radial wavenumber\n        ((0.5, 0.3, 6.9, 2.2, 1.4, 0.8, 0.18, 1.0), 0.15),\n    ]\n\n    results = []\n    \n    for case, gamma_accepted in test_cases:\n        # Unpack parameters for the current test case\n        k_y_rho_s, k_x_rho_s, R_LTi, R_Ln, q, s_hat, epsilon, Te_Ti = case\n\n        # 1. Calculate the temperature gradient parameter eta_i\n        # Avoid division by zero, though problem constraints make this unlikely.\n        if R_Ln == 0:\n            eta_i = float('inf')\n        else:\n            eta_i = R_LTi / R_Ln\n\n        # 2. Calculate the Finite Larmor Radius (FLR) parameter b\n        # rho_i^2 / rho_s^2 = 2 * Ti / Te\n        rho_ratio_sq = 2.0 / Te_Ti if Te_Ti != 0 else float('inf')\n        k_perp_rho_s_sq = k_y_rho_s**2 + k_x_rho_s**2\n        b = k_perp_rho_s_sq * rho_ratio_sq\n\n        # 3. Calculate the ITG instability threshold eta_th\n        eta_th = (2.0 / 3.0) + alpha_sh * (s_hat / q) + alpha_flr * b\n\n        # 4. Calculate the ion diamagnetic frequency omega_star_i (normalized)\n        omega_star_i = k_y_rho_s * R_Ln\n\n        # 5. Calculate the gyro-average factor Gamma_0(b)\n        # Gamma_0(b) = I_0(b) * exp(-b)\n        gamma_0_b = i0(b) * np.exp(-b)\n\n        # 6. Assemble the final growth rate gamma\n        # The drive term is max(eta_i - eta_th, 0)\n        drive_term = max(eta_i - eta_th, 0)\n        \n        # Denominator term (1+b) from polarization shielding\n        stabilization_term = gamma_0_b / (1.0 + b)\n\n        gamma = omega_star_i * epsilon * drive_term * stabilization_term\n        \n        # 7. Compare with the accepted benchmark value within tolerance\n        is_match = abs(gamma - gamma_accepted) = tolerance\n        results.append(is_match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}