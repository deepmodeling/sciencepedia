{
    "hands_on_practices": [
        {
            "introduction": "The magnetic moment, $\\mu$, is a cornerstone of magnetized plasma physics, acting as an adiabatic invariant in slowly varying electromagnetic fields. This near-conservation is the foundation of the gyrokinetic ordering. This exercise guides you through a first-principles derivation to quantify the small, non-zero rate of change of the gyro-averaged magnetic moment, revealing how time-dependent electric fields lead to a slow evolution and break the perfect invariance . Understanding this mechanism is crucial for grasping concepts like non-resonant plasma heating and the fundamental dynamics that gyrokinetic theory aims to capture.",
            "id": "3987710",
            "problem": "A single charged particle of mass $m$ and charge $q$ moves in a spatially uniform, time-independent magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$ with $B > 0$. The particle is subjected to a spatially uniform, time-dependent, perpendicular electric field $\\mathbf{E}_{\\perp}(t) = \\tilde{E} \\cos(\\omega t)\\,\\hat{\\mathbf{x}}$, where $\\omega$ is the field modulation frequency. Assume the gyrokinetic ordering appropriate to magnetized plasma dynamics in computational fusion science and engineering: the cyclotron frequency $\\Omega \\equiv |q| B / m$ is the fastest timescale, and the electric field varies slowly in time such that $\\omega = O(\\epsilon \\Omega)$ with a formal small parameter $0 < \\epsilon \\ll 1$. Also assume that the electric field amplitude is sufficiently small that drifts remain subsonic and that spatial gradients and collisions may be neglected. Define the magnetic moment $\\mu$ by $\\mu \\equiv m v_{\\perp}^{2} / (2B)$, where $v_{\\perp}$ is the magnitude of the particle’s velocity perpendicular to $\\mathbf{B}$.\n\nStarting from the Lorentz force law $m\\, d\\mathbf{v}/dt = q\\,\\mathbf{E} + q\\,\\mathbf{v} \\times \\mathbf{B}$, the definition of perpendicular kinetic energy $W_{\\perp} \\equiv m v_{\\perp}^{2}/2$, and the relation $dW_{\\perp}/dt = q\\,\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}$, perform a gyro-average over the fast cyclotron motion and retain terms through the leading non-vanishing order in $\\epsilon$ to capture the first-order violation of magnetic moment conservation induced solely by the time dependence of $\\mathbf{E}_{\\perp}(t)$. You may use the guiding-center decomposition and include the polarization drift driven by $\\partial_{t}\\mathbf{E}_{\\perp}$ that is consistent with the stated ordering, but you must not assume any other drift corrections beyond that order.\n\nDerive an explicit, closed-form analytical expression for the gyro-averaged rate of change $d\\langle \\mu \\rangle/dt$ as a function of time $t$, expressed in terms of $m$, $q$, $B$, $\\tilde{E}$, and $\\omega$. The final answer must be a single analytical expression. No numerical evaluation or rounding is required.",
            "solution": "The problem requires the derivation of the gyro-averaged rate of change of the magnetic moment, $d\\langle \\mu \\rangle/dt$, for a charged particle in specific electromagnetic fields, under the gyrokinetic ordering.\n\nFirst, we establish the relationship between the magnetic moment $\\mu$ and the perpendicular kinetic energy $W_{\\perp}$. The problem defines $\\mu \\equiv m v_{\\perp}^{2} / (2B)$ and $W_{\\perp} \\equiv m v_{\\perp}^{2}/2$, where $v_{\\perp}$ is the magnitude of the particle's total velocity perpendicular to the magnetic field $\\mathbf{B}$. Since the magnetic field strength $B$ is constant in time and space, we can write $\\mu = W_{\\perp} / B$.\n\nThe rate of change of $\\mu$ is therefore directly proportional to the rate of change of $W_{\\perp}$:\n$$\n\\frac{d\\mu}{dt} = \\frac{d}{dt}\\left(\\frac{W_{\\perp}}{B}\\right) = \\frac{1}{B} \\frac{dW_{\\perp}}{dt}\n$$\nThe problem provides the expression for the rate of change of perpendicular kinetic energy, which is the power delivered by the electric field to the perpendicular motion of the particle:\n$$\n\\frac{dW_{\\perp}}{dt} = q\\,\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}\n$$\nCombining these, we get an expression for the instantaneous rate of change of $\\mu$:\n$$\n\\frac{d\\mu}{dt} = \\frac{q}{B} (\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp})\n$$\nThe task is to find the gyro-averaged rate of change, $d\\langle \\mu \\rangle/dt$. Assuming the time derivative and the gyro-average operator commute for the slowly evolving averaged quantity, we have:\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\left\\langle \\frac{d\\mu}{dt} \\right\\rangle = \\frac{q}{B} \\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle\n$$\nThe gyro-average $\\langle A \\rangle$ of a quantity $A$ is its average over the fast cyclotron motion, typically performed by integrating over the gyrophase angle from $0$ to $2\\pi$.\n\nTo evaluate the average, we decompose the perpendicular velocity $\\mathbf{v}_{\\perp}$ into the guiding-center velocity $\\mathbf{V}_{GC, \\perp}$ and the gyromotion velocity $\\mathbf{v}_{gyro}$:\n$$\n\\mathbf{v}_{\\perp} = \\mathbf{V}_{GC, \\perp} + \\mathbf{v}_{gyro}\n$$\nThe guiding-center velocity itself consists of drift velocities. For a spatially uniform magnetic field and a spatially uniform but time-varying electric field, the relevant drifts to the order required by the problem are the $\\mathbf{E} \\times \\mathbf{B}$ drift ($\\mathbf{v}_E$) and the polarization drift ($\\mathbf{v}_p$). The problem explicitly directs us to include the polarization drift.\n$$\n\\mathbf{V}_{GC, \\perp} = \\mathbf{v}_E + \\mathbf{v}_p\n$$\nThe expressions for these drifts are:\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}\n$$\n$$\n\\mathbf{v}_p = \\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t}\n$$\nThe gyromotion velocity $\\mathbf{v}_{gyro}$ oscillates rapidly at the cyclotron frequency $\\Omega$. The guiding-center drifts $\\mathbf{v}_E$ and $\\mathbf{v}_p$, and the electric field $\\mathbf{E}_{\\perp}$, vary slowly on the timescale of $\\omega \\ll \\Omega$.\n\nNow we substitute the decomposed velocity into the expression for the gyro-averaged power:\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle (\\mathbf{V}_{GC, \\perp} + \\mathbf{v}_{gyro}) \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle + \\langle \\mathbf{v}_{gyro} \\cdot \\mathbf{E}_{\\perp} \\rangle\n$$\nLet's analyze each term. The quantities $\\mathbf{V}_{GC, \\perp}$ and $\\mathbf{E}_{\\perp}$ are determined by the slow time variation and do not depend on the fast gyrophase. Therefore, they are unaffected by the gyro-average. The gyromotion velocity $\\mathbf{v}_{gyro}$, by its nature, averages to zero over a gyro-period: $\\langle \\mathbf{v}_{gyro} \\rangle=0$.\n$$\n\\langle \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp}\n$$\n$$\n\\langle \\mathbf{v}_{gyro} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle \\mathbf{v}_{gyro} \\rangle \\cdot \\mathbf{E}_{\\perp} = 0 \\cdot \\mathbf{E}_{\\perp} = 0\n$$\nThus, the gyro-averaged power is simply the work done by the electric field on the guiding-center velocity:\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} = (\\mathbf{v}_E + \\mathbf{v}_p) \\cdot \\mathbf{E}_{\\perp}\n$$\nWe evaluate the two parts of this dot product:\n1.  Work on the $\\mathbf{E} \\times \\mathbf{B}$ drift: $\\mathbf{v}_E \\cdot \\mathbf{E}_{\\perp} = \\frac{(\\mathbf{E}_{\\perp} \\times \\mathbf{B})}{B^2} \\cdot \\mathbf{E}_{\\perp}$. This is zero because the vector $\\mathbf{E}_{\\perp} \\times \\mathbf{B}$ is, by definition of the cross product, perpendicular to $\\mathbf{E}_{\\perp}$.\n2.  Work on the polarization drift: $\\mathbf{v}_p \\cdot \\mathbf{E}_{\\perp} = \\left(\\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t}\\right) \\cdot \\mathbf{E}_{\\perp}$. This term is generally non-zero.\n\nSo, the gyro-averaged power reduces to the work done on the polarization drift:\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\frac{m}{q B^2} \\left(\\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp}\\right)\n$$\nSubstituting this back into our expression for $d\\langle \\mu \\rangle/dt$:\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{q}{B} \\left( \\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp} \\right) = \\frac{m}{B^3} \\left(\\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp}\\right)\n$$\nThis can also be written using the identity $\\mathbf{A} \\cdot \\frac{d\\mathbf{A}}{dt} = \\frac{1}{2}\\frac{d}{dt}(|\\mathbf{A}|^2)$:\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{m}{2 B^3} \\frac{d}{dt}(E_{\\perp}^2)\n$$\nNow, we use the specific form of the electric field given in the problem: $\\mathbf{E}_{\\perp}(t) = \\tilde{E} \\cos(\\omega t)\\,\\hat{\\mathbf{x}}$.\nThe magnitude squared is $E_{\\perp}^2 = (\\tilde{E} \\cos(\\omega t))^2 = \\tilde{E}^2 \\cos^2(\\omega t)$.\nIts time derivative is:\n$$\n\\frac{d}{dt}(E_{\\perp}^2) = \\tilde{E}^2 \\frac{d}{dt}(\\cos^2(\\omega t)) = \\tilde{E}^2 [2 \\cos(\\omega t) (-\\omega \\sin(\\omega t))] = -2 \\omega \\tilde{E}^2 \\sin(\\omega t) \\cos(\\omega t)\n$$\nUsing the trigonometric identity $\\sin(2\\theta) = 2 \\sin(\\theta)\\cos(\\theta)$, we find:\n$$\n\\frac{d}{dt}(E_{\\perp}^2) = -\\omega \\tilde{E}^2 \\sin(2\\omega t)\n$$\nFinally, we substitute this into the expression for $d\\langle \\mu \\rangle/dt$:\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{m}{2 B^3} (-\\omega \\tilde{E}^2 \\sin(2\\omega t)) = -\\frac{m \\omega \\tilde{E}^2}{2 B^3} \\sin(2\\omega t)\n$$\nThis is the explicit, closed-form analytical expression for the gyro-averaged rate of change of the magnetic moment as defined in the problem. The non-zero result demonstrates a first-order violation of the conservation of $\\mu$ (representing the total perpendicular kinetic energy) due to the time-varying electric field. This change corresponds to the work done by the electric field on the polarization current of the particle, a process known as non-resonant heating. Note that the result is independent of the particle's charge $q$.",
            "answer": "$$\\boxed{-\\frac{m \\omega \\tilde{E}^2}{2 B^3} \\sin(2\\omega t)}$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice requires translating continuous integrals into discrete sums. The gyro-average is a prime example, where an integral over the gyrophase angle is replaced by a sum over a finite number of points. This hands-on coding problem delves into the numerical fidelity of this approximation, challenging you to determine the minimum number of gyrophase points needed to achieve a desired accuracy . This task highlights the practical link between the physical parameter $k_{\\perp}\\rho$ and the necessary computational resolution, a core consideration in the design of any gyrokinetic simulation code.",
            "id": "3987734",
            "problem": "Consider the gyroaverage in Gyrokinetic (GK) theory, defined as the average of a rapidly varying phase over the gyrophase. Let a charged particle gyrate in a uniform magnetic field, and consider the plane-wave factor associated with perpendicular spatial variation. The plane-wave factor evaluated along the circular Larmor orbit can be written as a function of the gyrophase $\\,\\theta\\,$ as $\\,\\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta\\right)\\,$, where $\\,k_{\\perp}\\,$ is the magnitude of the perpendicular wavevector, $\\,\\rho\\,$ is the Larmor radius, and $\\,\\theta\\,$ is the gyrophase angle in radians. The continuous gyroaverage is the $\\,2\\pi\\,$-periodic average\n$$\n\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta\\right)\\,d\\theta,\n$$\nwhich is a standard quantity in computational fusion science and engineering.\n\nIn practice, numerical gyroaveraging replaces the continuous integral by a discrete sum over $\\,N_{\\theta}\\,$ equally spaced points in $\\,\\theta\\,$. Define the discrete uniform-grid gyrophase samples as $\\,\\theta_{n} = \\frac{2\\pi n}{N_{\\theta}}\\,$ for $\\,n=0,1,\\dots,N_{\\theta}-1\\,$, and the discrete gyroaverage approximation\n$$\n\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right) \\equiv \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta_{n}\\right).\n$$\nAngles must be treated in radians. The dimensionless parameter $\\,k_{\\perp}\\rho\\,$ should be viewed through gyrokinetic ordering as varying from small to large values.\n\nYour task is to analyze the effect of discretizing the gyrophase with $\\,N_{\\theta}\\,$ points on the accuracy of gyroaverages and to determine, for a given tolerance $\\,\\varepsilon\\,$, the minimum $\\,N_{\\theta}\\,$ such that\n$$\n\\left|\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right) - \\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\right| \\le \\varepsilon,\n$$\nwhere $\\,\\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\,$ denotes the exact continuous gyroaverage defined by the integral above. You must:\n- Use the discrete uniform-grid approximation $\\,\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right)\\,$ as specified.\n- Compute the exact continuous gyroaverage $\\,\\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\,$ from first principles, not by assumption.\n- For each test case, find the smallest integer $\\,N_{\\theta}\\ge 1\\,$ that meets the tolerance $\\,\\varepsilon\\,$.\n\nDesign a program that, for a set of $(k_{\\perp}\\rho,\\varepsilon)$ test cases, returns the corresponding minimal $\\,N_{\\theta}\\,$ values. All angles must be handled in radians. The outputs must be integers. Use the following test suite to ensure coverage of different regimes:\n- Case 1: $\\,k_{\\perp}\\rho = 0.0\\,$, $\\,\\varepsilon = 10^{-12}\\,$.\n- Case 2: $\\,k_{\\perp}\\rho = 0.1\\,$, $\\,\\varepsilon = 10^{-10}\\,$.\n- Case 3: $\\,k_{\\perp}\\rho = 1.0\\,$, $\\,\\varepsilon = 10^{-8}\\,$.\n- Case 4: $\\,k_{\\perp}\\rho = 2.5\\,$, $\\,\\varepsilon = 10^{-6}\\,$.\n- Case 5: $\\,k_{\\perp}\\rho = 5.0\\,$, $\\,\\varepsilon = 10^{-6}\\,$.\n- Case 6: $\\,k_{\\perp}\\rho = 10.0\\,$, $\\,\\varepsilon = 10^{-5}\\,$.\n- Case 7: $\\,k_{\\perp}\\rho = 20.0\\,$, $\\,\\varepsilon = 10^{-4}\\,$.\n- Case 8: $\\,k_{\\perp}\\rho = 50.0\\,$, $\\,\\varepsilon = 10^{-3}\\,$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[n1,n2,n3,n4,n5,n6,n7,n8]\"), where each entry is the minimal $\\,N_{\\theta}\\,$ for the corresponding test case, in the same order they are listed above.",
            "solution": "The problem requires finding the minimum number of discrete gyrophase sample points, $N_{\\theta}$, needed to approximate a continuous gyroaverage to within a specified tolerance, $\\varepsilon$. The problem is rooted in the computational methods of gyrokinetic theory, a cornerstone of plasma physics for magnetic fusion energy research.\n\nThe continuous gyroaverage, $\\mathcal{G}_{\\infty}(k_{\\perp}\\rho)$, of the plane-wave factor $\\exp(i k_{\\perp}\\rho\\cos\\theta)$ is defined by the integral:\n$$\n\\mathcal{G}_{\\infty}(k_{\\perp}\\rho) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(i k_{\\perp}\\rho \\cos\\theta)\\,d\\theta\n$$\nHere, $k_{\\perp}$ is the perpendicular wavenumber, $\\rho$ is the Larmor radius, and $\\theta$ is the gyrophase angle. Let $x = k_{\\perp}\\rho$ be the dimensionless argument. The integral is a standard representation of the Bessel function of the first kind of order zero, $J_0(x)$. This can be formally shown by integrating the Jacobi-Anger expansion,\n$$\ne^{iz\\cos\\theta} = J_0(z) + 2 \\sum_{k=1}^{\\infty} i^k J_k(z) \\cos(k\\theta)\n$$\nwith respect to $\\theta$ from $0$ to $2\\pi$. The summation part integrates to zero, as $\\int_{0}^{2\\pi} \\cos(k\\theta) d\\theta = 0$ for any integer $k \\ge 1$. This leaves:\n$$\n\\frac{1}{2\\pi}\\int_{0}^{2\\pi} e^{ix\\cos\\theta}\\,d\\theta = J_0(x)\n$$\nTherefore, the exact value of the continuous gyroaverage is $\\mathcal{G}_{\\infty}(k_{\\perp}\\rho) = J_0(k_{\\perp}\\rho)$. Since the argument $k_{\\perp}\\rho$ is a real number, the value $J_0(k_{\\perp}\\rho)$ is also real. This exact value can be computed using standard scientific libraries, specifically `scipy.special.j0` in the designated Python environment.\n\nThe discrete approximation, $\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho)$, is given by a sum over $N_{\\theta}$ uniformly spaced points $\\theta_n = 2\\pi n / N_{\\theta}$ for $n=0, 1, \\dots, N_{\\theta}-1$:\n$$\n\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho) = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp\\left(i k_{\\perp}\\rho \\cos\\theta_{n}\\right)\n$$\nThis represents the application of the trapezoidal rule to a $2\\pi$-periodic function, which is known to provide high (spectral) accuracy. The result of this sum, $\\mathcal{G}_{N_{\\theta}}$, is generally a complex number.\n\nThe objective is to find the smallest integer $N_{\\theta} \\ge 1$ that satisfies the tolerance condition:\n$$\n\\left|\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho) - J_0(k_{\\perp}\\rho)\\right| \\le \\varepsilon\n$$\nThe absolute value here denotes the magnitude of the complex error.\n\nThe algorithm to find the minimal $N_{\\theta}$ for each $(k_{\\perp}\\rho, \\varepsilon)$ test case is an iterative search:\n1.  Set the parameters $x = k_{\\perp}\\rho$ and the tolerance $\\varepsilon$ from the test case.\n2.  Compute the exact reference value, $G_{\\infty} = J_0(x)$.\n3.  Initialize the number of points at the minimum allowed value, $N_{\\theta} = 1$.\n4.  Begin a loop that iteratively increases $N_{\\theta}$:\n    a. For the current $N_{\\theta}$, generate the phase angles $\\theta_n = \\frac{2\\pi n}{N_{\\theta}}$ for $n \\in \\{0, \\dots, N_{\\theta}-1\\}$.\n    b. Calculate the discrete average $G_{N_{\\theta}} = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp(i x \\cos\\theta_n)$.\n    c. Compute the error magnitude $E = |G_{N_{\\theta}} - G_{\\infty}|$.\n    d. If $E \\le \\varepsilon$, the condition is met. The current $N_{\\theta}$ is the minimal integer value, so the search for this test case terminates and the value of $N_{\\theta}$ is recorded.\n    e. If $E > \\varepsilon$, increment $N_{\\theta}$ by $1$ and continue the loop.\n\nThis search is certain to converge because the discrete sum is a convergent numerical approximation of the integral.\n\nA special case arises when $k_{\\perp}\\rho = 0$. In this scenario, $J_0(0) = 1$. The discrete sum becomes $\\mathcal{G}_{N_{\\theta}}(0) = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp(0) = \\frac{1}{N_{\\theta}} \\cdot N_{\\theta} = 1$. The error is identically zero for any $N_{\\theta} \\ge 1$. Consequently, the minimal required number of points is $N_{\\theta}=1$. For all other cases where $k_{\\perp}\\rho > 0$, the iterative search provides the solution.\n\nThe implementation will use `numpy` for efficient vectorization of the calculations and `scipy.special.j0` for the high-precision computation of the Bessel function.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Solves the gyro-averaging problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 1e-12),    # Case 1\n        (0.1, 1e-10),    # Case 2\n        (1.0, 1e-8),     # Case 3\n        (2.5, 1e-6),     # Case 4\n        (5.0, 1e-6),     # Case 5\n        (10.0, 1e-5),    # Case 6\n        (20.0, 1e-4),    # Case 7\n        (50.0, 1e-3),    # Case 8\n    ]\n\n    def find_min_N_theta(k_perp_rho, epsilon):\n        \"\"\"\n        Finds the minimum integer N_theta >= 1 that satisfies the error tolerance.\n        \n        Args:\n            k_perp_rho (float): The dimensionless parameter k_perp * rho.\n            epsilon (float): The error tolerance.\n            \n        Returns:\n            int: The smallest N_theta satisfying the condition.\n        \"\"\"\n        # The exact continuous gyroaverage is the Bessel function J0(k_perp*rho).\n        g_infinity = j0(k_perp_rho)\n\n        # Handle the special case k_perp_rho = 0, where the error is always 0.\n        # The problem asks for the minimum N_theta >= 1.\n        if k_perp_rho == 0.0:\n            return 1\n\n        # Start search for minimum N_theta from 1.\n        n_theta = 1\n        while True:\n            # Generate N_theta equally spaced gyrophase angles in [0, 2*pi).\n            theta_n = np.linspace(0.0, 2.0 * np.pi, n_theta, endpoint=False)\n            \n            # Calculate the discrete gyroaverage using complex exponentials.\n            # np.mean is equivalent to np.sum(...)/n_theta.\n            g_n_theta = np.mean(np.exp(1j * k_perp_rho * np.cos(theta_n)))\n            \n            # Calculate the error as the magnitude of the complex difference.\n            error = np.abs(g_n_theta - g_infinity)\n            \n            # Check if the error is within the specified tolerance.\n            if error <= epsilon:\n                return n_theta\n            \n            # If not, increment N_theta and continue the search.\n            n_theta += 1\n\n    results = []\n    for case in test_cases:\n        k_perp_rho, epsilon = case\n        min_n = find_min_N_theta(k_perp_rho, epsilon)\n        results.append(min_n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "With an understanding of the principles and numerical implementation of gyro-averaging, we can now apply these tools to solve a central problem in electrostatic plasma turbulence: determining the self-consistent potential. This practice requires you to assemble the linearized gyrokinetic quasineutrality relation, which balances the charge density from the non-adiabatic particle response with the polarization density . By doing so, you will calculate the electrostatic potential for a given fluctuation, demonstrating how the system of equations is closed and how different plasma properties (temperature, density) influence the turbulent fields.",
            "id": "3987725",
            "problem": "Consider a uniform, magnetized plasma with singly charged ions and electrons supporting a single, perpendicular electrostatic Fourier mode with wave vector magnitude $k_{\\perp}$. Work in the standard electrostatic gyrokinetic ordering (frequency much smaller than cyclotron frequencies, $k_{\\perp} \\rho_{s}$ finite but $k_{\\parallel} \\rho_{s}$ small, and fluctuations weak so that linearization is valid). The non-adiabatic gyrocenter distribution functions for ions and electrons are prescribed in Fourier space as $g_{s}(\\mathbf{k}, v_{\\parallel}, v_{\\perp}) = \\alpha_{s} F_{Ms}(v_{\\parallel}, v_{\\perp})$, where $F_{Ms}$ is the local Maxwellian normalized such that $\\int d^{3}v\\,F_{Ms} = n_{s}$.\n\nYou are given:\n- Ion charge $q_{i} = +e$, electron charge $q_{e} = -e$, with the elementary charge $e = 1.602 \\times 10^{-19}$ Coulombs.\n- Ion density $n_{i} = 5.00 \\times 10^{19}$ per cubic meter, electron density $n_{e} = 5.00 \\times 10^{19}$ per cubic meter.\n- Ion temperature $T_{i} = 5.00$ kiloelectronvolts, electron temperature $T_{e} = 8.00$ kiloelectronvolts. Use $1~\\mathrm{eV} = 1.602 \\times 10^{-19}$ Joules to convert energies to Joules.\n- Non-adiabatic amplitudes $\\alpha_{i} = 2.00 \\times 10^{-2}$ and $\\alpha_{e} = 1.00 \\times 10^{-2}$.\n- Gyro-averaging factors for the given $k_{\\perp}$ and species thermal gyroradii: $\\Gamma_{0}(b_{i}) = 7.60 \\times 10^{-1}$ and $\\Gamma_{0}(b_{e}) = 9.90 \\times 10^{-1}$, where $\\Gamma_{0}(b) \\equiv I_{0}(b)\\exp(-b)$ and $I_{0}$ is the modified Bessel function of the first kind of order zero.\n\nAssume both species contribute to the polarization density and do not neglect electron polarization. Apply the electrostatic gyrokinetic quasineutrality relation for this single mode to compute the Fourier component of the electrostatic potential, $\\phi(\\mathbf{k})$. Express the final answer in Volts and round your answer to four significant figures. No angles are involved.",
            "solution": "The appropriate starting point is the linearized electrostatic gyrokinetic quasineutrality relation, which follows from Poisson’s equation with gyro-averaging and the gyrokinetic ordering. For a single Fourier mode, the charge balance between the gyrocenter non-adiabatic response and the polarization density can be written as\n$$\n\\sum_{s} q_{s} \\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) g_{s}(\\mathbf{k}, v_{\\parallel}, v_{\\perp}) \\;=\\; \\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right)\\,\\phi(\\mathbf{k}),\n$$\nwhere $J_{0}$ is the Bessel function of the first kind of order zero, $\\Omega_{s}$ is the species cyclotron frequency, $b_{s} = k_{\\perp}^{2}\\rho_{s}^{2}$ with $\\rho_{s}$ the thermal gyroradius, and $\\Gamma_{0}(b_{s}) \\equiv I_{0}(b_{s})\\exp(-b_{s})$ encodes the gyro-averaging of a Maxwellian over the Larmor orbit.\n\nWith the prescribed $g_{s} = \\alpha_{s} F_{Ms}$ and the Maxwellian normalization $\\int d^{3}v\\,F_{Ms} = n_{s}$, the gyro-averaged non-adiabatic density for species $s$ evaluates to\n$$\n\\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) g_{s} \\;=\\; \\alpha_{s} \\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) F_{Ms} \\;=\\; \\alpha_{s} n_{s} \\Gamma_{0}(b_{s}).\n$$\nInserting this into the quasineutrality relation gives\n$$\n\\sum_{s} q_{s} \\alpha_{s} n_{s} \\Gamma_{0}(b_{s}) \\;=\\; \\phi(\\mathbf{k}) \\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right),\n$$\nand hence\n$$\n\\phi(\\mathbf{k}) \\;=\\; \\frac{\\sum_{s} q_{s} \\alpha_{s} n_{s} \\Gamma_{0}(b_{s})}{\\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right)}.\n$$\n\nWe now evaluate this expression for ions ($s=i$) and electrons ($s=e$). Use $q_{i} = +e$ and $q_{e} = -e$. The numerator becomes\n$$\n\\mathcal{N} \\;=\\; q_{i}\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) + q_{e}\\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\n\\;=\\; e\\left[\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\\right].\n$$\nThe denominator becomes\n$$\n\\mathcal{D} \\;=\\; \\frac{q_{i}^{2}n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{q_{e}^{2}n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\n\\;=\\; e^{2}\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right].\n$$\nTherefore,\n$$\n\\phi(\\mathbf{k}) \\;=\\; \\frac{e\\left[\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\\right]}{e^{2}\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right]}\n\\;=\\; \\frac{\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})}{e\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right]}.\n$$\n\nNext, convert temperatures to Joules. Using $1~\\mathrm{eV} = 1.602 \\times 10^{-19}$ Joules, we have\n$$\nT_{i} = 5.00 \\times 10^{3} \\times 1.602 \\times 10^{-19} = 8.010 \\times 10^{-16} \\text{ Joules},\n$$\n$$\nT_{e} = 8.00 \\times 10^{3} \\times 1.602 \\times 10^{-19} = 1.2816 \\times 10^{-15} \\text{ Joules}.\n$$\n\nCompute the numerator:\n$$\n\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) = (2.00 \\times 10^{-2})(5.00 \\times 10^{19})(0.760) = (1.00 \\times 10^{18})(0.760) = 7.60 \\times 10^{17},\n$$\n$$\n\\alpha_{e}n_{e}\\Gamma_{0}(b_{e}) = (1.00 \\times 10^{-2})(5.00 \\times 10^{19})(0.990) = (5.00 \\times 10^{17})(0.990) = 4.95 \\times 10^{17}.\n$$\nThus\n$$\n\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e}) = \\left(7.60 - 4.95\\right) \\times 10^{17} = 2.65 \\times 10^{17}.\n$$\n\nCompute the denominator bracket:\n$$\n\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) = \\frac{5.00 \\times 10^{19}}{8.010 \\times 10^{-16}}\\left(1 - 7.60 \\times 10^{-1}\\right)\n= \\left(6.242 \\times 10^{34}\\right)\\left(2.40 \\times 10^{-1}\\right) = 1.498 \\times 10^{34},\n$$\n$$\n\\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right) = \\frac{5.00 \\times 10^{19}}{1.2816 \\times 10^{-15}}\\left(1 - 9.90 \\times 10^{-1}\\right)\n= \\left(3.902 \\times 10^{34}\\right)\\left(1.00 \\times 10^{-2}\\right) = 3.902 \\times 10^{32}.\n$$\nSumming,\n$$\n\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\n= \\left(1.498 \\times 10^{34}\\right) + \\left(3.902 \\times 10^{32}\\right) = 1.537 \\times 10^{34}.\n$$\n\nNow assemble $\\phi(\\mathbf{k})$ numerically. Using $e = 1.602 \\times 10^{-19}$,\n$$\n\\phi(\\mathbf{k}) = \\frac{2.65 \\times 10^{17}}{\\,1.602 \\times 10^{-19}\\, \\times \\left(1.537 \\times 10^{34}\\right)}\n= \\frac{2.65 \\times 10^{17}}{2.462 \\times 10^{15}} = 1.076 \\times 10^{2}.\n$$\nEquivalently, evaluating the numerator and denominator in base units,\n$$\n\\text{numerator} = e\\left(2.65 \\times 10^{17}\\right) = \\left(1.602 \\times 10^{-19}\\right)\\left(2.65 \\times 10^{17}\\right) = 4.2453 \\times 10^{-2},\n$$\n$$\n\\text{denominator} = e^{2}\\left(1.537 \\times 10^{34}\\right) = \\left(2.5664 \\times 10^{-38}\\right)\\left(1.537 \\times 10^{34}\\right) = 3.9469 \\times 10^{-4},\n$$\nand thus\n$$\n\\phi(\\mathbf{k}) = \\frac{4.2453 \\times 10^{-2}}{3.9469 \\times 10^{-4}} = 1.076 \\times 10^{2}.\n$$\n\nTherefore, the electrostatic potential for the given mode is approximately $107.6$ Volts when rounded to four significant figures.",
            "answer": "$$\\boxed{107.6}$$"
        }
    ]
}