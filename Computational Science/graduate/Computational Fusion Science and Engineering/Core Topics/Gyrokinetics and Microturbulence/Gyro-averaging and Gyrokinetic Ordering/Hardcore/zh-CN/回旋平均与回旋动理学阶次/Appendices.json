{
    "hands_on_practices": [
        {
            "introduction": "磁矩 $\\mu$ 是磁化等离子体中粒子运动的一个基本绝热不变量，它在最低阶的回旋动理学理论中是守恒的。然而，在存在时变电场的情况下，这种守恒性可能会被打破。这项练习将引导你从洛伦兹力定律出发，通过回旋平均来推导磁矩的平均变化率，从而揭示非共振加热等离子体的基本物理机制。",
            "id": "3987710",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子，在一个空间均匀、不随时间变化的磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ ($B > 0$) 中运动。该粒子受到一个空间均匀、随时间变化且垂直的电场 $\\mathbf{E}_{\\perp}(t) = \\tilde{E} \\cos(\\omega t)\\,\\hat{\\mathbf{x}}$ 的作用，其中 $\\omega$ 是场调制频率。假设采用适用于计算聚变科学与工程中磁化等离子体动力学的回旋动理学级数：回旋频率 $\\Omega \\equiv |q| B / m$ 是最快的时间尺度，电场随时间缓慢变化，使得 $\\omega = O(\\epsilon \\Omega)$，其中 $0  \\epsilon \\ll 1$ 是一个形式小参数。同时假设电场振幅足够小，以至于漂移保持亚音速，并且空间梯度和碰撞可以忽略不计。定义磁矩 $\\mu$ 为 $\\mu \\equiv m v_{\\perp}^{2} / (2B)$，其中 $v_{\\perp}$ 是粒子垂直于磁场 $\\mathbf{B}$ 的速度分量的大小。\n\n从洛伦兹力定律 $m\\, d\\mathbf{v}/dt = q\\,\\mathbf{E} + q\\,\\mathbf{v} \\times \\mathbf{B}$、垂直动能的定义 $W_{\\perp} \\equiv m v_{\\perp}^{2}/2$ 以及关系式 $dW_{\\perp}/dt = q\\,\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}$ 出发，对快速回旋运动进行回旋平均，并保留到 $\\epsilon$ 的领头非零阶项，以捕捉仅由电场 $\\mathbf{E}_{\\perp}(t)$ 的时间依赖性引起的磁矩守恒的一阶破坏。您可以使用导心分解，并包含由 $\\partial_{t}\\mathbf{E}_{\\perp}$ 驱动且与所述级数一致的极化漂移，但不得假设任何超出该阶数的其他漂移修正。\n\n推导回旋平均变化率 $d\\langle \\mu \\rangle/dt$ 作为一个关于时间 $t$ 的显式的、闭合形式的解析表达式，该表达式用 $m$、$q$、$B$、$\\tilde{E}$ 和 $\\omega$ 表示。最终答案必须是单一的解析表达式。无需进行数值计算或四舍五入。",
            "solution": "该问题要求在回旋动理学级数下，推导带电粒子在特定电磁场中磁矩的回旋平均变化率 $d\\langle \\mu \\rangle/dt$。\n\n首先，我们建立磁矩 $\\mu$ 和垂直动能 $W_{\\perp}$ 之间的关系。问题定义了 $\\mu \\equiv m v_{\\perp}^{2} / (2B)$ 和 $W_{\\perp} \\equiv m v_{\\perp}^{2}/2$，其中 $v_{\\perp}$ 是粒子垂直于磁场 $\\mathbf{B}$ 的总速度的大小。由于磁场强度 $B$ 在时间和空间上是恒定的，我们可以写出 $\\mu = W_{\\perp} / B$。\n\n因此，$\\mu$ 的变化率与 $W_{\\perp}$ 的变化率成正比：\n$$\n\\frac{d\\mu}{dt} = \\frac{d}{dt}\\left(\\frac{W_{\\perp}}{B}\\right) = \\frac{1}{B} \\frac{dW_{\\perp}}{dt}\n$$\n问题给出了垂直动能变化率的表达式，即电场对粒子垂直运动所做的功的功率：\n$$\n\\frac{dW_{\\perp}}{dt} = q\\,\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}\n$$\n结合这些，我们得到 $\\mu$ 的瞬时变化率表达式：\n$$\n\\frac{d\\mu}{dt} = \\frac{q}{B} (\\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp})\n$$\n任务是求出回旋平均变化率 $d\\langle \\mu \\rangle/dt$。假设对于缓慢演化的平均量，时间导数和回旋平均算子是可交换的，我们有：\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\left\\langle \\frac{d\\mu}{dt} \\right\\rangle = \\frac{q}{B} \\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle\n$$\n一个量 $A$ 的回旋平均 $\\langle A \\rangle$ 是其在快速回旋运动上的平均值，通常通过对回旋相位角从 $0$ 到 $2\\pi$ 进行积分来计算。\n\n为了计算该平均值，我们将垂直速度 $\\mathbf{v}_{\\perp}$ 分解为导心速度 $\\mathbf{V}_{GC, \\perp}$ 和回旋运动速度 $\\mathbf{v}_{gyro}$：\n$$\n\\mathbf{v}_{\\perp} = \\mathbf{V}_{GC, \\perp} + \\mathbf{v}_{gyro}\n$$\n导心速度本身由漂移速度组成。对于空间均匀的磁场和空间均匀但随时间变化的电场，问题所要求阶数内的相关漂移是 $\\mathbf{E} \\times \\mathbf{B}$ 漂移 ($\\mathbf{v}_E$) 和极化漂移 ($\\mathbf{v}_p$) 。问题明确指示我们要包含极化漂移。\n$$\n\\mathbf{V}_{GC, \\perp} = \\mathbf{v}_E + \\mathbf{v}_p\n$$\n这些漂移的表达式为：\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}\n$$\n$$\n\\mathbf{v}_p = \\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t}\n$$\n回旋运动速度 $\\mathbf{v}_{gyro}$ 以回旋频率 $\\Omega$ 快速振荡。导心漂移 $\\mathbf{v}_E$ 和 $\\mathbf{v}_p$ 以及电场 $\\mathbf{E}_{\\perp}$ 在 $\\omega \\ll \\Omega$ 的时间尺度上缓慢变化。\n\n现在我们将分解后的速度代入回旋平均功率的表达式中：\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle (\\mathbf{V}_{GC, \\perp} + \\mathbf{v}_{gyro}) \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle + \\langle \\mathbf{v}_{gyro} \\cdot \\mathbf{E}_{\\perp} \\rangle\n$$\n我们来分析每一项。量 $\\mathbf{V}_{GC, \\perp}$ 和 $\\mathbf{E}_{\\perp}$ 由缓慢的时间变化决定，不依赖于快速的回旋相位。因此，它们不受回旋平均的影响。回旋运动速度 $\\mathbf{v}_{gyro}$，就其本质而言，在一个回旋周期内的平均值为零：$\\langle \\mathbf{v}_{gyro} \\rangle=0$。\n$$\n\\langle \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp}\n$$\n$$\n\\langle \\mathbf{v}_{gyro} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\langle \\mathbf{v}_{gyro} \\rangle \\cdot \\mathbf{E}_{\\perp} = 0 \\cdot \\mathbf{E}_{\\perp} = 0\n$$\n因此，回旋平均功率就是电场对导心速度所做的功：\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\mathbf{V}_{GC, \\perp} \\cdot \\mathbf{E}_{\\perp} = (\\mathbf{v}_E + \\mathbf{v}_p) \\cdot \\mathbf{E}_{\\perp}\n$$\n我们计算这个点积的两个部分：\n1.  对 $\\mathbf{E} \\times \\mathbf{B}$ 漂移做的功：$\\mathbf{v}_E \\cdot \\mathbf{E}_{\\perp} = \\frac{(\\mathbf{E}_{\\perp} \\times \\mathbf{B})}{B^2} \\cdot \\mathbf{E}_{\\perp}$。该项为零，因为根据叉积的定义，向量 $\\mathbf{E}_{\\perp} \\times \\mathbf{B}$ 垂直于 $\\mathbf{E}_{\\perp}$。\n2.  对极化漂移做的功：$\\mathbf{v}_p \\cdot \\mathbf{E}_{\\perp} = \\left(\\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t}\\right) \\cdot \\mathbf{E}_{\\perp}$。该项通常不为零。\n\n所以，回旋平均功率简化为对极化漂移所做的功：\n$$\n\\langle \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle = \\frac{m}{q B^2} \\left(\\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp}\\right)\n$$\n将此代回我们关于 $d\\langle \\mu \\rangle/dt$ 的表达式中：\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{q}{B} \\left( \\frac{m}{q B^2} \\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp} \\right) = \\frac{m}{B^3} \\left(\\frac{\\partial \\mathbf{E}_{\\perp}}{\\partial t} \\cdot \\mathbf{E}_{\\perp}\\right)\n$$\n这也可以使用恒等式 $\\mathbf{A} \\cdot \\frac{d\\mathbf{A}}{dt} = \\frac{1}{2}\\frac{d}{dt}(|\\mathbf{A}|^2)$ 写成：\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{m}{2 B^3} \\frac{d}{dt}(E_{\\perp}^2)\n$$\n现在，我们使用问题中给出的电场的具体形式：$\\mathbf{E}_{\\perp}(t) = \\tilde{E} \\cos(\\omega t)\\,\\hat{\\mathbf{x}}$。\n其大小的平方为 $E_{\\perp}^2 = (\\tilde{E} \\cos(\\omega t))^2 = \\tilde{E}^2 \\cos^2(\\omega t)$。\n它的时间导数为：\n$$\n\\frac{d}{dt}(E_{\\perp}^2) = \\tilde{E}^2 \\frac{d}{dt}(\\cos^2(\\omega t)) = \\tilde{E}^2 [2 \\cos(\\omega t) (-\\omega \\sin(\\omega t))] = -2 \\omega \\tilde{E}^2 \\sin(\\omega t) \\cos(\\omega t)\n$$\n使用三角恒等式 $\\sin(2\\theta) = 2 \\sin(\\theta)\\cos(\\theta)$，我们得到：\n$$\n\\frac{d}{dt}(E_{\\perp}^2) = -\\omega \\tilde{E}^2 \\sin(2\\omega t)\n$$\n最后，我们将此代入 $d\\langle \\mu \\rangle/dt$ 的表达式中：\n$$\n\\frac{d\\langle \\mu \\rangle}{dt} = \\frac{m}{2 B^3} (-\\omega \\tilde{E}^2 \\sin(2\\omega t)) = -\\frac{m \\omega \\tilde{E}^2}{2 B^3} \\sin(2\\omega t)\n$$\n这就是问题所定义的磁矩回旋平均变化率的显式、闭合形式的解析表达式。这个非零结果表明，由于时变电场，代表总垂直动能的 $\\mu$ 的守恒性存在一阶破坏。这个变化对应于电场对粒子极化电流所做的功，这一过程被称为非共振加热。注意，该结果与粒子的电荷 $q$ 无关。",
            "answer": "$$\\boxed{-\\frac{m \\omega \\tilde{E}^2}{2 B^3} \\sin(2\\omega t)}$$"
        },
        {
            "introduction": "在计算机模拟中，将理论概念转化为可执行的算法是至关重要的一步。回旋平均作为一个积分运算，在数值上通常通过对离散的回旋相位点求和来近似。本练习旨在让你亲手实现这一数值过程，并探索离散化精度（由回旋相位点数 $N_{\\theta}$ 决定）与物理参数（如归一化波数 $k_{\\perp}\\rho$）之间的关系，这是确保回旋动理学模拟既准确又高效的关键。",
            "id": "3987734",
            "problem": "考虑回旋动理学（GK）理论中的回旋平均，其定义为快变相位在回旋相位上的平均值。设一带电粒子在匀强磁场中回旋，并考虑与垂直空间变化相关的平面波因子。沿圆形拉莫尔轨道的平面波因子可以写成回旋相位$\\,\\theta\\,$的函数，形式为$\\,\\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta\\right)\\,$，其中$\\,k_{\\perp}\\,$是垂直波矢的大小，$\\,\\rho\\,$是拉莫尔半径，$\\,\\theta\\,$是回旋相位角（以弧度为单位）。连续回旋平均是周期为$\\,2\\pi\\,$的平均值\n$$\n\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta\\right)\\,d\\theta,\n$$\n这是计算聚变科学与工程中的一个标准量。\n\n在实践中，数值回旋平均用在$\\,\\theta\\,$上的$\\,N_{\\theta}\\,$个等间距点上的离散求和来代替连续积分。定义离散均匀网格上的回旋相位样本为$\\,\\theta_{n} = \\frac{2\\pi n}{N_{\\theta}}\\,$，其中$\\,n=0,1,\\dots,N_{\\theta}-1\\,$，以及离散回旋平均近似\n$$\n\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right) \\equiv \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp\\!\\left(i\\,k_{\\perp}\\rho\\cos\\theta_{n}\\right).\n$$\n角度必须以弧度处理。无量纲参数$\\,k_{\\perp}\\rho\\,$应通过回旋动理学级数被视为从小数变到大数。\n\n您的任务是分析使用$\\,N_{\\theta}\\,$个点离散化回旋相位对回旋平均精度的影响，并对于给定的容差$\\,\\varepsilon\\,$，确定最小的$\\,N_{\\theta}\\,$，使得\n$$\n\\left|\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right) - \\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\right| \\le \\varepsilon,\n$$\n其中$\\,\\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\,$表示由上述积分定义的精确连续回旋平均。您必须：\n- 按规定使用离散均匀网格近似$\\,\\mathcal{G}_{N_{\\theta}}\\!\\left(k_{\\perp}\\rho\\right)\\,$。\n- 从第一性原理计算精确的连续回旋平均$\\,\\mathcal{G}_{\\infty}\\!\\left(k_{\\perp}\\rho\\right)\\,$，而不是通过假设。\n- 对于每个测试用例，找到满足容差$\\,\\varepsilon\\,$的最小整数$\\,N_{\\theta}\\ge 1\\,$。\n\n设计一个程序，对于一组$(k_{\\perp}\\rho,\\varepsilon)$测试用例，返回相应的最小$\\,N_{\\theta}\\,$值。所有角度必须以弧度处理。输出必须为整数。使用以下测试套件以确保覆盖不同区域：\n- 用例 1: $\\,k_{\\perp}\\rho = 0.0\\,$, $\\,\\varepsilon = 10^{-12}\\,$.\n- 用例 2: $\\,k_{\\perp}\\rho = 0.1\\,$, $\\,\\varepsilon = 10^{-10}\\,$.\n- 用例 3: $\\,k_{\\perp}\\rho = 1.0\\,$, $\\,\\varepsilon = 10^{-8}\\,$.\n- 用例 4: $\\,k_{\\perp}\\rho = 2.5\\,$, $\\,\\varepsilon = 10^{-6}\\,$.\n- 用例 5: $\\,k_{\\perp}\\rho = 5.0\\,$, $\\,\\varepsilon = 10^{-6}\\,$.\n- 用例 6: $\\,k_{\\perp}\\rho = 10.0\\,$, $\\,\\varepsilon = 10^{-5}\\,$.\n- 用例 7: $\\,k_{\\perp}\\rho = 20.0\\,$, $\\,\\varepsilon = 10^{-4}\\,$.\n- 用例 8: $\\,k_{\\perp}\\rho = 50.0\\,$, $\\,\\varepsilon = 10^{-3}\\,$.\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来（例如，“[n1,n2,n3,n4,n5,n6,n7,n8]”），其中每个条目是对应测试用例的最小$\\,N_{\\theta}\\,$，顺序与上面列出的一致。",
            "solution": "该问题要求找到离散回旋相位样本点的最小数量 $N_{\\theta}$，以在指定的容差 $\\varepsilon$ 内近似连续回旋平均。该问题植根于回旋动理学理论的计算方法，这是磁约束聚变能研究中等离子体物理的基石。\n\n平面波因子 $\\exp(i k_{\\perp}\\rho\\cos\\theta)$ 的连续回旋平均 $\\mathcal{G}_{\\infty}(k_{\\perp}\\rho)$ 由以下积分定义：\n$$\n\\mathcal{G}_{\\infty}(k_{\\perp}\\rho) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(i k_{\\perp}\\rho \\cos\\theta)\\,d\\theta\n$$\n在这里，$k_{\\perp}$ 是垂直波数，$\\rho$ 是拉莫尔半径，$\\theta$ 是回旋相位角。令 $x = k_{\\perp}\\rho$ 为无量纲参数。该积分是零阶第一类贝塞尔函数 $J_0(x)$ 的标准表示。这可以通过对 Jacobi-Anger 展开式进行积分来正式证明，\n$$\ne^{iz\\cos\\theta} = J_0(z) + 2 \\sum_{k=1}^{\\infty} i^k J_k(z) \\cos(k\\theta)\n$$\n对 $\\theta$ 从 $0$ 到 $2\\pi$ 进行积分。求和部分的积分为零，因为对于任何整数 $k \\ge 1$，$\\int_{0}^{2\\pi} \\cos(k\\theta) d\\theta = 0$。这样剩下：\n$$\n\\frac{1}{2\\pi}\\int_{0}^{2\\pi} e^{ix\\cos\\theta}\\,d\\theta = J_0(x)\n$$\n因此，连续回旋平均的精确值是 $\\mathcal{G}_{\\infty}(k_{\\perp}\\rho) = J_0(k_{\\perp}\\rho)$。由于参数 $k_{\\perp}\\rho$ 是一个实数，所以 $J_0(k_{\\perp}\\rho)$ 的值也是实数。这个精确值可以使用标准的科学计算库来计算，特别是在指定的 Python 环境中使用 `scipy.special.j0`。\n\n离散近似 $\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho)$ 由对 $N_{\\theta}$ 个均匀分布的点 $\\theta_n = 2\\pi n / N_{\\theta}$（其中 $n=0, 1, \\dots, N_{\\theta}-1$）的求和给出：\n$$\n\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho) = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp\\left(i k_{\\perp}\\rho \\cos\\theta_{n}\\right)\n$$\n这代表了将梯形法则应用于一个周期为 $2\\pi$ 的函数，众所周知，这种方法可以提供高（谱）精度。这个求和的结果 $\\mathcal{G}_{N_{\\theta}}$ 通常是一个复数。\n\n目标是找到满足容差条件的最小整数 $N_{\\theta} \\ge 1$：\n$$\n\\left|\\mathcal{G}_{N_{\\theta}}(k_{\\perp}\\rho) - J_0(k_{\\perp}\\rho)\\right| \\le \\varepsilon\n$$\n这里的绝对值表示复数误差的模。\n\n为每个 $(k_{\\perp}\\rho, \\varepsilon)$ 测试用例找到最小 $N_{\\theta}$ 的算法是一个迭代搜索：\n1.  从测试用例中设置参数 $x = k_{\\perp}\\rho$ 和容差 $\\varepsilon$。\n2.  计算精确的参考值 $G_{\\infty} = J_0(x)$。\n3.  将点数初始化为允许的最小值 $N_{\\theta} = 1$。\n4.  开始一个迭代增加 $N_{\\theta}$ 的循环：\n    a. 对于当前的 $N_{\\theta}$，生成相位角 $\\theta_n = \\frac{2\\pi n}{N_{\\theta}}$，其中 $n \\in \\{0, \\dots, N_{\\theta}-1\\}$。\n    b. 计算离散平均值 $G_{N_{\\theta}} = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp(i x \\cos\\theta_n)$。\n    c. 计算误差的模 $E = |G_{N_{\\theta}} - G_{\\infty}|$。\n    d. 如果 $E \\le \\varepsilon$，则条件满足。当前的 $N_{\\theta}$ 是最小的整数值，因此该测试用例的搜索终止，并记录 $N_{\\theta}$ 的值。\n    e. 如果 $E  \\varepsilon$，则将 $N_{\\theta}$ 增加 1 并继续循环。\n\n这个搜索过程必然会收敛，因为离散和是该积分的一个收敛的数值近似。\n\n当 $k_{\\perp}\\rho = 0$ 时出现一个特殊情况。在这种情况下，$J_0(0) = 1$。离散和变为 $\\mathcal{G}_{N_{\\theta}}(0) = \\frac{1}{N_{\\theta}}\\sum_{n=0}^{N_{\\theta}-1} \\exp(0) = \\frac{1}{N_{\\theta}} \\cdot N_{\\theta} = 1$。对于任何 $N_{\\theta} \\ge 1$，误差恒等于零。因此，所需的最小点数是 $N_{\\theta}=1$。对于所有其他 $k_{\\perp}\\rho  0$ 的情况，迭代搜索提供解决方案。\n\n实现将使用 `numpy` 来高效地向量化计算，并使用 `scipy.special.j0` 来进行贝塞尔函数的高精度计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Solves the gyro-averaging problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 1e-12),    # Case 1\n        (0.1, 1e-10),    # Case 2\n        (1.0, 1e-8),     # Case 3\n        (2.5, 1e-6),     # Case 4\n        (5.0, 1e-6),     # Case 5\n        (10.0, 1e-5),    # Case 6\n        (20.0, 1e-4),    # Case 7\n        (50.0, 1e-3),    # Case 8\n    ]\n\n    def find_min_N_theta(k_perp_rho, epsilon):\n        \"\"\"\n        Finds the minimum integer N_theta >= 1 that satisfies the error tolerance.\n        \n        Args:\n            k_perp_rho (float): The dimensionless parameter k_perp * rho.\n            epsilon (float): The error tolerance.\n            \n        Returns:\n            int: The smallest N_theta satisfying the condition.\n        \"\"\"\n        # The exact continuous gyroaverage is the Bessel function J0(k_perp*rho).\n        g_infinity = j0(k_perp_rho)\n\n        # Handle the special case k_perp_rho = 0, where the error is always 0.\n        # The problem asks for the minimum N_theta >= 1.\n        if k_perp_rho == 0.0:\n            return 1\n\n        # Start search for minimum N_theta from 1.\n        n_theta = 1\n        while True:\n            # Generate N_theta equally spaced gyrophase angles in [0, 2*pi).\n            theta_n = np.linspace(0.0, 2.0 * np.pi, n_theta, endpoint=False)\n            \n            # Calculate the discrete gyroaverage using complex exponentials.\n            # np.mean is equivalent to np.sum(...)/n_theta.\n            g_n_theta = np.mean(np.exp(1j * k_perp_rho * np.cos(theta_n)))\n            \n            # Calculate the error as the magnitude of the complex difference.\n            error = np.abs(g_n_theta - g_infinity)\n            \n            # Check if the error is within the specified tolerance.\n            if error = epsilon:\n                return n_theta\n            \n            # If not, increment N_theta and continue the search.\n            n_theta += 1\n\n    results = []\n    for case in test_cases:\n        k_perp_rho, epsilon = case\n        min_n = find_min_N_theta(k_perp_rho, epsilon)\n        results.append(min_n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "回旋平均后的物理量是构建回旋动理学模型的基石，它们描述了等离子体对低频电磁场的集体响应。本练习将理论与应用相结合，要求你使用回旋动理学准中性关系——泊松方程在回旋动理学排序下的简化形式——来求解由给定非绝热粒子分布所产生的静电势。通过这个计算，你将深入理解等离子体中的电荷屏蔽效应以及不同粒子组分（离子和电子）如何共同决定电场。",
            "id": "3987725",
            "problem": "考虑一个均匀磁化等离子体，其中包含单电荷离子和电子，支持一个单一的、垂直的静电傅里叶模式，其波矢大小为 $k_{\\perp}$。在标准的静电回旋动理学级数下进行计算（频率远小于回旋频率，$k_{\\perp} \\rho_{s}$ 为有限值但 $k_{\\parallel} \\rho_{s}$ 很小，且扰动很弱以至于线性化有效）。离子和电子的非绝热回旋中心分布函数在傅里叶空间中被规定为 $g_{s}(\\mathbf{k}, v_{\\parallel}, v_{\\perp}) = \\alpha_{s} F_{Ms}(v_{\\parallel}, v_{\\perp})$，其中 $F_{Ms}$ 是局部麦克斯韦分布，其归一化满足 $\\int d^{3}v\\,F_{Ms} = n_{s}$。\n\n给定：\n- 离子电荷 $q_{i} = +e$，电子电荷 $q_{e} = -e$，元电荷 $e = 1.602 \\times 10^{-19}$ 库仑。\n- 离子密度 $n_{i} = 5.00 \\times 10^{19}$ 每立方米，电子密度 $n_{e} = 5.00 \\times 10^{19}$ 每立方米。\n- 离子温度 $T_{i} = 5.00$ 千电子伏特，电子温度 $T_{e} = 8.00$ 千电子伏特。使用 $1~\\mathrm{eV} = 1.602 \\times 10^{-19}$ 焦耳将能量单位转换为焦耳。\n- 非绝热振幅 $\\alpha_{i} = 2.00 \\times 10^{-2}$ 和 $\\alpha_{e} = 1.00 \\times 10^{-2}$。\n- 对于给定的 $k_{\\perp}$ 和粒子热回旋半径，回旋平均因子为：$\\Gamma_{0}(b_{i}) = 7.60 \\times 10^{-1}$ 和 $\\Gamma_{0}(b_{e}) = 9.90 \\times 10^{-1}$，其中 $\\Gamma_{0}(b) \\equiv I_{0}(b)\\exp(-b)$ 且 $I_{0}$ 是零阶第一类修正贝塞尔函数。\n\n假设两种粒子都对极化密度有贡献，并且不忽略电子极化。应用此单一模式的静电回旋动理学准中性关系，计算静电势的傅里叶分量 $\\phi(\\mathbf{k})$。最终答案以伏特表示，并四舍五入到四位有效数字。不涉及角度。",
            "solution": "合适的出发点是线性化的静电回旋动理学准中性关系，该关系由包含回旋平均和回旋动理学级数的泊松方程导出。对于单个傅里叶模式，回旋中心非绝热响应与极化密度之间的电荷平衡可以写为\n$$\n\\sum_{s} q_{s} \\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) g_{s}(\\mathbf{k}, v_{\\parallel}, v_{\\perp}) \\;=\\; \\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right)\\,\\phi(\\mathbf{k}),\n$$\n其中 $J_{0}$ 是零阶第一类贝塞尔函数，$\\Omega_{s}$ 是粒子回旋频率，$b_{s} = k_{\\perp}^{2}\\rho_{s}^{2}$（$\\rho_{s}$ 是热回旋半径），$\\Gamma_{0}(b_{s}) \\equiv I_{0}(b_{s})\\exp(-b_{s})$ 表示麦克斯韦分布在拉莫尔轨道上的回旋平均。\n\n根据给定的 $g_{s} = \\alpha_{s} F_{Ms}$ 和麦克斯韦归一化条件 $\\int d^{3}v\\,F_{Ms} = n_{s}$，粒子 $s$ 的回旋平均非绝热密度可以表示为\n$$\n\\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) g_{s} \\;=\\; \\alpha_{s} \\int d^{3}v\\, J_{0}\\!\\left(k_{\\perp}\\frac{v_{\\perp}}{\\Omega_{s}}\\right) F_{Ms} \\;=\\; \\alpha_{s} n_{s} \\Gamma_{0}(b_{s}).\n$$\n将此代入准中性关系，得到\n$$\n\\sum_{s} q_{s} \\alpha_{s} n_{s} \\Gamma_{0}(b_{s}) \\;=\\; \\phi(\\mathbf{k}) \\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right),\n$$\n因此\n$$\n\\phi(\\mathbf{k}) \\;=\\; \\frac{\\sum_{s} q_{s} \\alpha_{s} n_{s} \\Gamma_{0}(b_{s})}{\\sum_{s} \\frac{q_{s}^{2} n_{s}}{T_{s}}\\left(1 - \\Gamma_{0}(b_{s})\\right)}.\n$$\n\n我们现在对离子 ($s=i$) 和电子 ($s=e$) 计算此表达式。使用 $q_{i} = +e$ 和 $q_{e} = -e$。分子变为\n$$\n\\mathcal{N} \\;=\\; q_{i}\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) + q_{e}\\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\n\\;=\\; e\\left[\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\\right].\n$$\n分母变为\n$$\n\\mathcal{D} \\;=\\; \\frac{q_{i}^{2}n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{q_{e}^{2}n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\n\\;=\\; e^{2}\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right].\n$$\n因此，\n$$\n\\phi(\\mathbf{k}) \\;=\\; \\frac{e\\left[\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})\\right]}{e^{2}\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right]}\n\\;=\\; \\frac{\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e})}{e\\left[\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\\right]}.\n$$\n\n接下来，将温度转换为焦耳。使用 $1~\\mathrm{eV} = 1.602 \\times 10^{-19}$ 焦耳，我们有\n$$\nT_{i} = 5.00 \\times 10^{3} \\times 1.602 \\times 10^{-19} = 8.010 \\times 10^{-16} \\text{ 焦耳},\n$$\n$$\nT_{e} = 8.00 \\times 10^{3} \\times 1.602 \\times 10^{-19} = 1.2816 \\times 10^{-15} \\text{ 焦耳}.\n$$\n\n计算分子：\n$$\n\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) = (2.00 \\times 10^{-2}) \\times (5.00 \\times 10^{19}) \\times (7.60 \\times 10^{-1}) = 7.60 \\times 10^{17},\n$$\n$$\n\\alpha_{e}n_{e}\\Gamma_{0}(b_{e}) = (1.00 \\times 10^{-2}) \\times (5.00 \\times 10^{19}) \\times (9.90 \\times 10^{-1}) = 4.95 \\times 10^{17}.\n$$\n因此\n$$\n\\alpha_{i}n_{i}\\Gamma_{0}(b_{i}) - \\alpha_{e}n_{e}\\Gamma_{0}(b_{e}) = \\left(7.60 - 4.95\\right) \\times 10^{17} = 2.65 \\times 10^{17}.\n$$\n在最终的 $\\phi$ 表达式中乘以 $1/e$ 的步骤将在我们计算完分母之后处理。\n\n计算分母的方括号部分：\n$$\n\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) = \\frac{5.00 \\times 10^{19}}{8.010 \\times 10^{-16}}\\left(1 - 7.60 \\times 10^{-1}\\right)\n= \\left(6.242 \\times 10^{34}\\right)\\left(2.40 \\times 10^{-1}\\right) = 1.498 \\times 10^{34},\n$$\n$$\n\\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right) = \\frac{5.00 \\times 10^{19}}{1.2816 \\times 10^{-15}}\\left(1 - 9.90 \\times 10^{-1}\\right)\n= \\left(3.902 \\times 10^{34}\\right)\\left(1.00 \\times 10^{-2}\\right) = 3.902 \\times 10^{32}.\n$$\n求和，\n$$\n\\frac{n_{i}}{T_{i}}\\left(1 - \\Gamma_{0}(b_{i})\\right) + \\frac{n_{e}}{T_{e}}\\left(1 - \\Gamma_{0}(b_{e})\\right)\n= \\left(1.498 \\times 10^{34}\\right) + \\left(3.902 \\times 10^{32}\\right) = 1.537 \\times 10^{34}.\n$$\n\n现在数值计算 $\\phi(\\mathbf{k})$。使用 $e = 1.602 \\times 10^{-19}$，\n$$\n\\phi(\\mathbf{k}) = \\frac{2.65 \\times 10^{17}}{\\,1.602 \\times 10^{-19}\\, \\times \\left(1.537 \\times 10^{34}\\right)}\n= \\frac{2.65 \\times 10^{17}}{2.462 \\times 10^{15}} = 107.6 \\times 10^{0}.\n$$\n等价地，用基本单位计算分子和分母，\n$$\n\\text{分子} = e\\left(2.65 \\times 10^{17}\\right) = \\left(1.602 \\times 10^{-19}\\right)\\left(2.65 \\times 10^{17}\\right) = 4.2453 \\times 10^{-2},\n$$\n$$\n\\text{分母} = e^{2}\\left(1.537 \\times 10^{34}\\right) = \\left(2.5664 \\times 10^{-38}\\right)\\left(1.537 \\times 10^{34}\\right) = 3.9469 \\times 10^{-4},\n$$\n于是\n$$\n\\phi(\\mathbf{k}) = \\frac{4.2453 \\times 10^{-2}}{3.9469 \\times 10^{-4}} = 1.076 \\times 10^{2}.\n$$\n\n因此，对于给定的模式，当四舍五入到四位有效数字时，静电势约为 $107.6$ 伏特。",
            "answer": "$$\\boxed{107.6}$$"
        }
    ]
}