{
    "hands_on_practices": [
        {
            "introduction": "理论物理学的魅力之一在于通过简化的模型抓住复杂现象的核心。本练习将引导你通过解析推导来探索动理学气球模（KBM）的物理本质。我们将从一个简化的回旋动理学色散关系出发，通过平衡稳定化的磁力线弯曲效应（以阿尔芬波为代表）与非稳定化的压力梯度驱动效应，来推导动理学气球模的离子贝塔（$\\beta_i$）阈值。这个练习旨在阐明像离子温度梯度参数 $\\eta_i$ 这样的关键物理量是如何直接影响等离子体稳定性的，从而为你提供对 KBM 背后物理机制的深刻理解。",
            "id": "4189889",
            "problem": "考虑一个大环径比托卡马克等离子体，其大半径为 $R$，磁场强度为 $B$，离子数密度为 $n_i$，离子温度为 $T_i$，电荷为 $e$。假设满足以下排序和区域：归一化回旋半径小（记为归一化回旋半径 $\\rho^{*} \\equiv \\rho_i / a$，满足 $\\rho^{*} \\ll 1$）和归一化碰撞率低（记为归一化碰撞率 $\\nu^{*} \\ll 1$），因此可以应用无碰撞、低频回旋动理学近似。设离子温度梯度参数定义为 $\\eta_i \\equiv L_n / L_{T_i}$，其中 $L_n^{-1} \\equiv -\\partial_r \\ln n_i$ 且 $L_{T_i}^{-1} \\equiv -\\partial_r \\ln T_i$。定义离子等离子体贝塔值为 $\\beta_i \\equiv 2 \\mu_0 n_i T_i / B^2$，其中 $\\mu_0$ 为真空磁导率。\n\n在一个简化的动理学气球模 (KBM) 局域电磁回旋动理学模型中，考虑场线弯曲阿尔芬恢复力与压强梯度驱动之间的耦合。使用以下最小色散关系\n$$\n\\omega^2 = k_{\\parallel}^2 v_A^2 - \\omega_{*pi}\\,\\omega_{Di},\n$$\n其中 $v_A^2 \\equiv B^2/(\\mu_0 n_i m_i)$ 是阿尔芬速度的平方，$m_i$ 是离子质量，$\\omega_{*pi} \\equiv \\omega_{*i}(1+\\eta_i)$ 是离子压强梯度抗磁频率，其中 $\\omega_{*i} \\equiv k_y T_i/(e B L_n)$，而离子曲率漂移频率为 $\\omega_{Di} \\equiv 2 k_y T_i/(e B R)$。设热速度为 $v_{ti} \\equiv \\sqrt{2 T_i/m_i}$，离子拉莫尔半径为 $\\rho_i \\equiv v_{ti}/\\Omega_i$，其中离子回旋频率为 $\\Omega_i \\equiv e B/m_i$。假设电子沿场线具有绝热响应，并忽略电子温度梯度效应。\n\n在 KBM 的临界稳定性下，设 $\\omega^2 = 0$。为了对最不稳定模式进行局域估计，采用标度选择 $k_{\\parallel} R = 1$ 和 $k_y \\rho_i = \\sqrt{L_n/R}$。仅使用上面提供的定义和关系，推导动理学气球模的离子贝塔阈值 $\\beta_{i,\\text{crit}}$ 作为仅关于 $\\eta_i$ 的函数的解析表达式。将最终答案表示为仅包含 $\\eta_i$ 的闭式表达式。不需要进行数值计算，最终表达式不应带单位。",
            "solution": "该问题具有科学依据，提法恰当且内容自洽。所有给出的定义和关系在聚变等离子体物理和回旋动理学理论框架内都是标准的。该任务构成了基于给定模型的有效推导。因此，我们可以开始求解。\n\n通过在给定的色散关系中设置 $\\omega^2 = 0$，可以得到动理学气球模 (KBM) 的临界稳定性条件：\n$$\n\\omega^2 = k_{\\parallel}^2 v_A^2 - \\omega_{*pi}\\,\\omega_{Di} = 0\n$$\n这给出了不稳定性发生的阈值条件：\n$$\nk_{\\parallel}^2 v_A^2 = \\omega_{*pi}\\,\\omega_{Di}\n$$\n现在，我们将各项的给定定义代入该方程，以推导临界离子贝塔值 $\\beta_{i, \\text{crit}}$ 的表达式。\n\n首先，我们使用问题中的定义来表示左侧 (LHS) 和右侧 (RHS)。LHS 代表了阿尔芬波沿弯曲磁场线传播的稳定效应。使用给定的标度选择 $k_{\\parallel} R = 1$，我们有 $k_{\\parallel} = \\frac{1}{R}$。阿尔芬速度的平方为 $v_A^2 \\equiv \\frac{B^2}{\\mu_0 n_i m_i}$。因此，LHS 变为：\n$$\n\\text{LHS} = k_{\\parallel}^2 v_A^2 = \\left(\\frac{1}{R}\\right)^2 \\left(\\frac{B^2}{\\mu_0 n_i m_i}\\right) = \\frac{B^2}{\\mu_0 n_i m_i R^2}\n$$\nRHS 代表了在非有利磁曲率区域内由压强梯度驱动的不稳定性。离子压强梯度抗磁频率为 $\\omega_{*pi} \\equiv \\omega_{*i}(1+\\eta_i)$，其中 $\\omega_{*i} \\equiv \\frac{k_y T_i}{e B L_n}$。离子曲率漂移频率为 $\\omega_{Di} \\equiv \\frac{2 k_y T_i}{e B R}$。这些频率的乘积是：\n$$\n\\text{RHS} = \\omega_{*pi} \\omega_{Di} = \\left(\\frac{k_y T_i}{e B L_n}(1+\\eta_i)\\right) \\left(\\frac{2 k_y T_i}{e B R}\\right) = \\frac{2 k_y^2 T_i^2 (1+\\eta_i)}{e^2 B^2 L_n R}\n$$\n将 LHS 和 RHS 的表达式相等，得到临界稳定性平衡条件：\n$$\n\\frac{B^2}{\\mu_0 n_i m_i R^2} = \\frac{2 k_y^2 T_i^2 (1+\\eta_i)}{e^2 B^2 L_n R}\n$$\n目标是用 $\\beta_i$ 和 $\\eta_i$ 来表示这个关系。为此，我们必须使用给定的关系来消除波数 ($k_y$) 和标度长度 ($L_n$, $R$)。问题陈述了垂直波数 $k_y$ 的标度选择为 $k_y \\rho_i = \\sqrt{L_n/R}$。将其平方得到 $k_y^2 \\rho_i^2 = \\frac{L_n}{R}$，可以重新排列得到 $k_y^2 = \\frac{L_n}{R \\rho_i^2}$。将此式代入我们主方程的 RHS，可以同时消去 $k_y$ 和 $L_n$：\n$$\n\\text{RHS} = \\frac{2 \\left(\\frac{L_n}{R \\rho_i^2}\\right) T_i^2 (1+\\eta_i)}{e^2 B^2 L_n R} = \\frac{2 T_i^2 (1+\\eta_i)}{e^2 B^2 R^2 \\rho_i^2}\n$$\n现在，稳定性条件简化为：\n$$\n\\frac{B^2}{\\mu_0 n_i m_i R^2} = \\frac{2 T_i^2 (1+\\eta_i)}{e^2 B^2 R^2 \\rho_i^2}\n$$\n$R^2$ 项从两侧消去，这对于局域分析是符合预期的：\n$$\n\\frac{B^2}{\\mu_0 n_i m_i} = \\frac{2 T_i^2 (1+\\eta_i)}{e^2 B^2 \\rho_i^2}\n$$\n接下来，我们必须代入离子拉莫尔半径 $\\rho_i$ 的定义。给定 $\\rho_i \\equiv v_{ti}/\\Omega_i$，其中离子热速度为 $v_{ti} \\equiv \\sqrt{2 T_i/m_i}$，离子回旋频率为 $\\Omega_i \\equiv e B/m_i$。对 $\\rho_i$ 平方可得：\n$$\n\\rho_i^2 = \\frac{v_{ti}^2}{\\Omega_i^2} = \\frac{2 T_i/m_i}{(e B/m_i)^2} = \\frac{2 T_i m_i^2}{m_i e^2 B^2} = \\frac{2 T_i m_i}{e^2 B^2}\n$$\n将 $\\rho_i^2$ 的这个表达式代入稳定性方程：\n$$\n\\frac{B^2}{\\mu_0 n_i m_i} = \\frac{2 T_i^2 (1+\\eta_i)}{e^2 B^2 \\left(\\frac{2 T_i m_i}{e^2 B^2}\\right)}\n$$\nRHS 的分母显著简化，因为 $e^2$ 和 $B^2$ 的因子被消去：\n$$\n\\frac{B^2}{\\mu_0 n_i m_i} = \\frac{2 T_i^2 (1+\\eta_i)}{2 T_i m_i} = \\frac{T_i (1+\\eta_i)}{m_i}\n$$\n我们可以从两侧消去离子质量 $m_i$，得到磁场强度和等离子体动力学参数之间的一个简单关系：\n$$\n\\frac{B^2}{\\mu_0 n_i} = T_i (1+\\eta_i)\n$$\n最后，我们引入离子等离子体贝塔值，定义为 $\\beta_i \\equiv \\frac{2 \\mu_0 n_i T_i}{B^2}$。在临界稳定性阈值处，我们将 $\\beta_i$ 表示为 $\\beta_{i, \\text{crit}}$。我们可以将推导出的关系重新排列成包含 $\\beta_i$ 倒数的形式：\n$$\n\\frac{B^2}{\\mu_0 n_i T_i} = 1+\\eta_i\n$$\n从 $\\beta_i$ 的定义，我们可以写出 $\\frac{2}{\\beta_i} = \\frac{B^2}{\\mu_0 n_i T_i}$。令这两个表达式相等，得到：\n$$\n\\frac{2}{\\beta_{i, \\text{crit}}} = 1+\\eta_i\n$$\n求解临界离子贝塔值 $\\beta_{i, \\text{crit}}$，我们得到最终结果：\n$$\n\\beta_{i, \\text{crit}} = \\frac{2}{1+\\eta_i}\n$$\n此表达式给出了动理学气球模不稳定性的阈值，它仅是离子温度梯度参数 $\\eta_i$ 的函数，与问题的要求一致。",
            "answer": "$$\n\\boxed{\\frac{2}{1+\\eta_i}}\n$$"
        },
        {
            "introduction": "虽然解析模型为我们提供了宝贵的物理直觉，但要获得定量的预测，数值模拟是不可或缺的工具。本练习将带你从理论走向实践，通过编写程序来求解动理学气球模的本征值问题。你将学习如何将描述 KBM 的偏微分算符在一个一维“气球模坐标”下离散化为一个矩阵，然后求解其本征值和本征函数，从而计算出最不稳定模式的线性增长率和奇偶性。这项实践不仅能让你掌握一种核心的稳定性分析技术，还能让你直观地看到在不同物理参数下（如磁剪切 $s$ 和归一化压力梯度 $\\alpha$），KBM 模式的结构和行为是如何变化的。",
            "id": "4200505",
            "problem": "您的任务是在局域气球模框架下，为环形聚变等离子体中的动理学气球模 (KBM) 构建并分析一个一维、沿磁力线的线性模型。目标是使用一个平衡了磁力线弯曲与压力梯度曲率驱动的简化算符，来确定线性稳定性、主导本征值以及最不稳定模式的宇称。您的程序必须通过求解一个实自伴本征值问题来从第一性原理计算增长率，然后通过一个简化色散关系将其最小本征值映射到一个复频率。\n\n从以下基本且经过充分检验的物理基础开始：\n- 对于沿磁力线的线性微扰，磁力线弯曲提供了一个稳定的贡献，其大小与微扰幅度的平行梯度的平方成正比，由一个与 $-d^2/d\\theta^2$ 成正比的算符表示，其中 $\\theta$ 是无量纲的磁力线坐标。\n- 磁剪切会引入沿磁力线的局域垂直波数变化，在气球模表象中，这被建模为一个与 $s^2 \\theta^2$ 成正比的有效势，其中 $s$ 是无量纲磁剪切参数。\n- 压力梯度曲率驱动引入了一个不稳定的、关于 $\\theta$ 的偶函数贡献，建模为 $-\\alpha \\cos\\theta$，其中 $\\alpha$ 是无量纲的归一化压力梯度（即所谓的 s–α 模型）。\n- 在阿尔芬极限下，惯性将空间算符的本征值与复频率的平方耦合起来，一个简单的碰撞或动理学耗散可以被建模为一个与频率成线性的项 $i\\hat{\\nu}\\,\\hat{\\omega}$，其中 $\\hat{\\nu}$ 是无量纲阻尼率。\n\n在这些假设下，定义自伴算符\n$$\n\\hat{H} = -\\frac{d^2}{d\\theta^2} + s^2 \\theta^2 - \\alpha \\cos\\theta,\n$$\n作用于 $\\theta \\in \\mathbb{R}$ 上的平方可积函数。为了使问题在计算上是适定的，将无限域近似为一个有限区间，并在 $[-\\Theta,\\Theta]$（其中 $\\Theta = 10$）上施加齐次狄利克雷边界条件。用 $N=1001$ 个网格点对区间进行均匀离散，并对限制在内部点的 $d^2/d\\theta^2$ 使用二阶中心差分。\n\n令 $\\mu_0$ 表示 $\\hat{H}$ 的最小本征值，$\\phi_0(\\theta)$ 表示相关的本征函数。将算符谱与归一化复频率 $\\hat{\\omega}$（归一化到阿尔芬频率 $v_A/L_\\parallel$）联系起来的简化色散关系为\n$$\n\\hat{\\omega}^2 + i \\hat{\\nu}\\,\\hat{\\omega} - \\mu_0 = 0.\n$$\n定义线性增长率为 $\\gamma = \\operatorname{Im}(\\hat{\\omega})$。如果两个二次方程根的虚部均为非正，则设 $\\gamma$ 等于 $0$。通过检验计算出的基态本征函数是否为偶函数来确定最不稳定模式的宇称，即在离散 $\\ell^2$ 意义下，$\\phi_0(\\theta) \\approx \\phi_0(-\\theta)$ 是否成立。\n\n您的任务：\n1. 在 $[-\\Theta,\\Theta]$（其中 $\\Theta = 10$）上使用 $N=1001$ 个等距点和端点处的齐次狄利克雷边界条件对 $\\hat{H}$ 进行离散化。使用二阶中心差分法组装对应于 $-d^2/d\\theta^2$ 的对称三对角矩阵，并在内部点上添加对角势 $s^2 \\theta^2 - \\alpha \\cos\\theta$。\n2. 计算最小本征值 $\\mu_0$ 和相应的本征向量 $\\phi_0$。\n3. 求解关于 $\\hat{\\omega}$ 的二次方程，并取具有最大正虚部的根。如果没有根具有正虚部，则返回 $\\gamma=0$。\n4. 通过在离散 $\\ell^2$ 范数下比较 $\\phi_0(\\theta)$ 与 $\\phi_0(-\\theta)$，确定一个指示偶宇称的布尔标志。如果偶宇称差异严格小于奇宇称差异，则返回 true。\n5. 对于每个测试用例，返回一个包含三个条目的列表：增长率 $\\gamma$（四舍五入到六位小数），偶宇称布尔值，以及最小本征值 $\\mu_0$（四舍五入到六位小数）。\n\n物理和数值单位：\n- 所有频率均以归一化到 $v_A/L_\\parallel$ 的无量纲阿尔芬频率单位报告。也就是说，$\\hat{\\omega}$ 和 $\\gamma$ 是无量纲的。将 $\\gamma$ 表示为四舍五入到六位小数的十进制浮点数。\n- 角度 $\\theta$ 是无量纲的，余弦函数使用弧度。\n\n测试套件：\n使用以下参数集 $(s,\\alpha,\\hat{\\nu})$：\n- 情况 A（稳定参考）：$(s,\\alpha,\\hat{\\nu}) = (1.0, 0.0, 0.1)$。\n- 情况 B（强驱动，弱阻尼）：$(s,\\alpha,\\hat{\\nu}) = (0.5, 4.0, 0.05)$。\n- 情况 C（近临界驱动）：$(s,\\alpha,\\hat{\\nu}) = (1.5, 2.0, 0.02)$。\n- 情况 D（中等参数）：$(s,\\alpha,\\hat{\\nu}) = (1.0, 3.0, 0.2)$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含四个测试用例的结果，格式为一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是按 [gamma, is_even, mu0] 顺序排列的三元素列表。例如：\n\"[[0.000000,True,1.000000],[0.123456,True,-0.500000],[...],[...]]\"。",
            "solution": "此问题是有效的，因为它提出了一个基于等离子体物理学中标准简化模型——局域动理学气球模 (KBM)——的适定、有科学依据且客观的任务。所提供的方程、参数和数值方法是一致的，并且足以推导出唯一的解。\n\n问题的核心是通过求解一个一维类薛定谔本征值方程以及随后的色散关系来确定等离子体位形的稳定性。整个过程包括三个主要步骤：本征值问题的数值求解，二次方程的解析求解，以及所得本征函数对称性的分析。\n\n首先，我们处理算符 $\\hat{H} = -\\frac{d^2}{d\\theta^2} + s^2 \\theta^2 - \\alpha \\cos\\theta$ 的本征值问题。该算符作用于定义在实线 $\\theta \\in \\mathbb{R}$ 上的函数 $\\phi(\\theta)$。为了得到一个计算上可行的解，我们将定义域限制在一个有限区间 $[-\\Theta, \\Theta]$，其中 $\\Theta=10$，并施加齐次狄利克雷边界条件 $\\phi(-\\Theta) = \\phi(\\Theta) = 0$。这是一个有效的近似，因为势能项 $s^2\\theta^2$ 确保了低能本征函数局域在 $\\theta=0$ 附近，并在 $|\\theta|$ 较大时迅速衰减。\n\n为了数值求解本征值问题 $\\hat{H}\\phi = \\mu\\phi$，我们对定义域进行离散化。区间 $[-\\Theta, \\Theta]$ 被划分为 $N=1001$ 个等距点 $\\theta_j$，其中 $j=0, 1, \\ldots, N-1$。网格间距为 $\\Delta\\theta = \\frac{2\\Theta}{N-1}$。函数 $\\phi(\\theta)$ 由其在这些网格点上的值构成的向量 $\\phi_j = \\phi(\\theta_j)$ 表示。边界条件意味着 $\\phi_0 = 0$ 和 $\\phi_{N-1} = 0$，因此我们只需要求解 $M = N-2$ 个内部点。\n\n二阶导数算符 $-\\frac{d^2}{d\\theta^2}$ 使用二阶中心差分格式在每个内部点 $\\theta_j$（$j=1, \\ldots, N-2$）处进行近似：\n$$\n-\\frac{d^2\\phi}{d\\theta^2}\\bigg|_{\\theta_j} \\approx \\frac{-\\phi_{j-1} + 2\\phi_j - \\phi_{j+1}}{(\\Delta\\theta)^2}\n$$\n这会得到一个对称三对角矩阵表示。对角元素为 $\\frac{2}{(\\Delta\\theta)^2}$，非对角元素（在第一超对角线和次对角线上）为 $-\\frac{1}{(\\Delta\\theta)^2}$。\n\n势能项 $V(\\theta) = s^2 \\theta^2 - \\alpha \\cos\\theta$ 贡献一个对角矩阵，其中每个对角元素是势在相应内部网格点的值，即 $V_{jj} = s^2\\theta_{j+1}^2 - \\alpha\\cos(\\theta_{j+1})$，其中 $j=0, \\ldots, M-1$。\n\n完整的离散化哈密顿量 $H$ 是一个 $M \\times M$ 的对称三对角矩阵。我们求解矩阵本征值问题 $H\\vec{\\phi} = \\mu\\vec{\\phi}$ 来找到其本征值和本征向量。我们关心的是最小的本征值 $\\mu_0$ 及其对应的本征向量 $\\vec{\\phi}_0$。这可以通过使用专门的数值线性代数程序（例如 `scipy.linalg.eigh_tridiagonal`）来高效完成。\n\n其次，计算出最小本征值 $\\mu_0$ 后，我们求解给定的色散关系以得到归一化复频率 $\\hat{\\omega}$：\n$$\n\\hat{\\omega}^2 + i \\hat{\\nu}\\,\\hat{\\omega} - \\mu_0 = 0\n$$\n这是一个关于 $\\hat{\\omega}$ 的标准二次方程。其根由求根公式给出：\n$$\n\\hat{\\omega} = \\frac{-i\\hat{\\nu} \\pm \\sqrt{(i\\hat{\\nu})^2 - 4(1)(-\\mu_0)}}{2} = \\frac{-i\\hat{\\nu} \\pm \\sqrt{4\\mu_0 - \\hat{\\nu}^2}}{2}\n$$\n线性增长率 $\\gamma$ 定义为最不稳定根的虚部，即具有最大正虚部的根。如果没有根具有正虚部，则模式是稳定的，我们设 $\\gamma=0$。令判别式为 $D_c = 4\\mu_0 - \\hat{\\nu}^2$。\n如果 $D_c \\ge 0$，则平方根为实数，两个根的虚部均为 $-\\frac{\\hat{\\nu}}{2} \\le 0$。因此，$\\gamma=0$。\n如果 $D_c  0$，则平方根为纯虚数，$\\sqrt{D_c} = i\\sqrt{|D_c|} = i\\sqrt{\\hat{\\nu}^2 - 4\\mu_0}$。$\\hat{\\omega}$ 的两个根的虚部分别为 $\\frac{-\\hat{\\nu} \\pm \\sqrt{\\hat{\\nu}^2 - 4\\mu_0}}{2}$。其中较大者是 $\\gamma_{raw} = \\frac{\\sqrt{\\hat{\\nu}^2 - 4\\mu_0} - \\hat{\\nu}}{2}$。最终的增长率为 $\\gamma = \\max(0, \\gamma_{raw})$。只有当 $\\mu_0  0$ 时，才可能存在 $\\gamma > 0$ 的不稳定模式。\n\n第三，我们确定基态本征函数 $\\phi_0(\\theta)$ 的宇称。势 $V(\\theta) = s^2 \\theta^2 - \\alpha \\cos\\theta$ 是 $\\theta$ 的偶函数，即 $V(\\theta) = V(-\\theta)$。因此，哈密顿算符 $\\hat{H}$ 与宇称算符 $P$ 对易，宇称算符将 $\\phi(\\theta)$ 映射为 $\\phi(-\\theta)$。这是量子力学的一个基本定理，它规定 $\\hat{H}$ 的本征函数也必须是 $P$ 的本征函数，这意味着它们必须具有确定的宇称（纯偶宇称，$\\phi_0(\\theta) = \\phi_0(-\\theta)$；或纯奇宇称，$\\phi_0(\\theta) = -\\phi_0(-\\theta)$）。具有对称势阱的一维系统的基态总是偶宇称的。\n\n在数值上，我们通过检查计算出的本征向量 $\\vec{\\phi}_0$ 更接近偶函数还是奇函数来验证此属性。与偶宇称的差异与 $||\\vec{\\phi}_0 - \\operatorname{flip}(\\vec{\\phi}_0)||_2^2$ 成正比，而与奇宇称的差异与 $||\\vec{\\phi}_0 + \\operatorname{flip}(\\vec{\\phi}_0)||_2^2$ 成正比，其中 $\\operatorname{flip}(\\vec{\\phi}_0)$ 是元素反转后的向量。偶宇称差异小于奇宇称差异的条件可以简化为点积 $\\vec{\\phi}_0 \\cdot \\operatorname{flip}(\\vec{\\phi}_0) > 0$。因此，如果满足此条件，我们返回 `True` 表示偶宇称。\n\n对于每个测试用例 $(s, \\alpha, \\hat{\\nu})$，我们执行这些步骤来计算增长率 $\\gamma$、偶宇称标志和最小本征值 $\\mu_0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the KBM problem for all test cases.\n    \"\"\"\n    test_cases = [\n        (1.0, 0.0, 0.1),   # Case A (stable reference)\n        (0.5, 4.0, 0.05),  # Case B (strong drive, weak damping)\n        (1.5, 2.0, 0.02),  # Case C (near-marginal drive)\n        (1.0, 3.0, 0.2),   # Case D (intermediate parameters)\n    ]\n\n    results = []\n    for s, alpha, nu_hat in test_cases:\n        gamma, is_even, mu0 = calculate_kbm_stability(s, alpha, nu_hat)\n        results.append(f\"[{gamma:.6f},{is_even},{mu0:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_kbm_stability(s, alpha, nu_hat):\n    \"\"\"\n    Calculates the KBM growth rate, parity, and smallest eigenvalue for a given\n    set of physical parameters.\n\n    Args:\n        s (float): Dimensionless magnetic shear.\n        alpha (float): Dimensionless normalized pressure gradient.\n        nu_hat (float): Dimensionless damping rate.\n\n    Returns:\n        tuple: (gamma, is_even, mu0) where gamma is the growth rate,\n               is_even is a boolean for parity, and mu0 is the eigenvalue.\n    \"\"\"\n    # 1. Discretize the operator H\n    Theta = 10.0\n    N = 1001\n    M = N - 2  # Number of interior points\n\n    delta_theta = 2.0 * Theta / (N - 1)\n    \n    # Grid for interior points\n    theta_interior = np.linspace(-Theta + delta_theta, Theta - delta_theta, M)\n\n    # Assemble the symmetric tridiagonal matrix for H\n    # Diagonal elements\n    diag_potential = s**2 * theta_interior**2 - alpha * np.cos(theta_interior)\n    diag_laplacian = 2.0 / delta_theta**2\n    d = diag_laplacian + diag_potential\n\n    # Off-diagonal elements\n    e = -1.0 / delta_theta**2 * np.ones(M - 1)\n\n    # 2. Compute the smallest eigenvalue and eigenvector\n    # eigh_tridiagonal returns eigenvalues in ascending order.\n    eigenvalues, eigenvectors = eigh_tridiagonal(d, e)\n    mu0 = eigenvalues[0]\n    phi0_interior = eigenvectors[:, 0]\n\n    # Reconstruct the full eigenvector with zero boundaries\n    phi0_full = np.concatenate(([0.0], phi0_interior, [0.0]))\n\n    # 3. Solve the dispersion relation for the growth rate gamma\n    discriminant = nu_hat**2 - 4 * mu0\n    \n    # Unstable modes can only arise if mu0  0, which ensures discriminant > nu_hat^2 >= 0\n    if discriminant > 0:\n        gamma_raw = (np.sqrt(discriminant) - nu_hat) / 2.0\n        gamma = max(0.0, gamma_raw)\n    else:\n        # If discriminant is = 0, the imaginary part of the frequency is negative or zero.\n        gamma = 0.0\n\n    # 4. Determine the parity of the eigenfunction\n    # The potential is even, so the ground state must have definite parity.\n    # An even function has a positive dot product with its flipped version.\n    # An odd function has a negative dot product.\n    # The dot product is zero only for a function that is zero everywhere or\n    # is a mix of even/odd components that cancel out, which is not expected here\n    # due to numerical precision.\n    dot_product = np.dot(phi0_full, np.flip(phi0_full))\n    is_even = dot_product > 0\n\n    return gamma, is_even, mu0\n\nsolve()\n```"
        },
        {
            "introduction": "在理论研究中，构建能够抓住核心物理的“简化模型”是一项至关重要的技能。本练习将指导你从基本物理原理出发，构建一个 KBM 的局域简化模型，并用它来研究不稳定性阈值附近的普适行为。你将推导出一个描述 KBM 增长率的简单公式，然后通过参数扫描来验证一个关键的物理预测：在临界点附近，不稳定性增长率 $\\hat{\\gamma}$ 与超出阈值的驱动量 $\\delta$ 之间存在幂律关系 $\\hat{\\gamma} \\sim \\delta^p$。通过拟合数据来确定这个幂律指数 $p$，你将亲身体验理论建模与数据分析相结合的强大威力。",
            "id": "4200507",
            "problem": "在环形等离子体中，动理学气球模（KBMs）的局域简化模型可以通过理想磁流体力学（MHD）能量原理加上领头的有限拉莫尔半径（FLR）修正来构建，然后转换成适合算法评估的无量纲形式。您将仅使用经过充分检验的物理定义和第一性原理平衡，推导、论证和实现一个参数扫描算法，以计算无量纲线性增长率和一个接近临界稳定性时的标度律指数。该任务完全以数学和逻辑术语构建，并且对于使用任何现代编程语言的开发者都必须是可理解的。\n\n从以下基本和核心定义开始：\n- 理想MHD能量原理指出，稳定性由势能变化的符号决定，其中势能变分可以示意性地写为稳定化和非稳定化贡献的加和组合。用 $\\delta W$ 表示净能量变分，并注意不稳定性对应于 $\\delta W  0$。\n- 剪切-阿尔芬恢复力提供了一个磁力线弯曲能量贡献，该贡献是稳定性的。特征阿尔芬速度为 $v_{\\mathrm{A}} = B/\\sqrt{\\mu_0 n_i m_i}$，特征阿尔芬频率为 $\\omega_{\\mathrm{A}}$；为完成此任务，您将报告由 $\\omega_{\\mathrm{A}}$ 归一化的无量纲量，因此输出中不需要进行物理单位转换。\n- 曲率驱动的交换不稳定性驱动是非稳定化的，并且与一个无量纲气球模参数 $\\alpha$ 成正比。在广泛使用的 $s$-$\\alpha$ 表示法中，磁剪切 $s$ 是无量纲的，它编码了磁力线螺距随小半径的变化，而气球模参数 $\\alpha$ 编码了由磁几何归一化的压力梯度驱动。\n- 来自离子回旋运动的有限拉莫尔半径（FLR）效应贡献了一个额外的稳定项，该项与无量纲垂直波数的平方成标度关系，表示为 $k_y \\rho_i$，其中 $\\rho_i$ 是离子拉莫尔半径，$k_y$ 是副法线波数。量 $k_y \\rho_i$ 是无量纲的。\n\n仅使用这些基础，构建一个局域、无量纲、单模的能量平衡，从而导出一个不稳定性阈值条件和一个相应的、由 $\\omega_{\\mathrm{A}}$ 归一化的无量纲线性增长率 $\\hat{\\gamma}$。您的推导必须是基于原理的：用一个随磁剪切 $s$ 增加的函数来表示稳定化的磁力线弯曲贡献，用随 $\\alpha$ 增加的量表示非稳定化的曲率驱动，以及随 $(k_y \\rho_i)^2$ 增加的FLR稳定化。通过以下规则将净能量的符号转换为无量纲增长率：只有当净驱动超过净稳定化时，增长率才是实数且非零；在临界稳定性附近，有量纲的增长率的标度关系如同超出部分的驱动除以有效惯量的平方根。您不得在问题陈述中使用或声明任何捷径或预先指定的目标公式；您实现的公式必须在您的解决方案中从上述原理推导和论证得出。\n\n实现要求：\n- 对每个提供的测试用例，计算无量綱线性增长率 $\\hat{\\gamma}$ 作为非负实数（浮点数），对于标度律测试，计算 $\\hat{\\gamma}$ 对阈值距离依赖关系的拟合指数（浮点数）。\n- 程序必须是自包含的，并产生一行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表。\n- 所有输出必须是无量纲数，因此不需要进行物理单位转换。\n\n测试套件和要求的输出：\n- 测试用例 $1$ (正常路径)：磁剪切 $s = 0.5$，副法线参数 $k_y \\rho_i = 0.3$，气球模驱动 $\\alpha = 1.2$。输出无量纲增长率 $\\hat{\\gamma}_1$ 作为浮点数。\n- 测试用例 $2$ (边界/临界)：磁剪切 $s = 0.5$，副法线参数 $k_y \\rho_i = 0.3$，气球模驱动 $\\alpha = 0.59$。输出无量纲增长率 $\\hat{\\gamma}_2$ 作为浮点数。\n- 测试用例 $3$ (FLR主导的稳定区)：磁剪切 $s = 0.5$，副法线参数 $k_y \\rho_i = 1.5$，气球模驱动 $\\alpha = 2.0$。输出无量纲增长率 $\\hat{\\gamma}_3$ 作为浮点数。\n- 测试用例 $4$ (阈值附近的标度律拟合)：固定磁剪切 $s = 0.3$，副法线参数 $k_y \\rho_i = 0.2$，以及基础气球模驱动 $\\alpha_{\\mathrm{base}} = 0.34$。通过在四个偏移量 $\\delta \\in \\{10^{-4}, 2 \\times 10^{-4}, 5 \\times 10^{-4}, 10^{-3}\\}$ 下，计算 $\\alpha = \\alpha_{\\mathrm{base}} + \\delta$ 处的无量纲增长率，来执行近阈值参数扫描。对 $\\log \\hat{\\gamma}$ 与 $\\log \\delta$ 的关系进行线性拟合，并输出拟合斜率 $p$ 作为浮点数，它代表了接近阈值时 $\\hat{\\gamma} \\sim \\delta^p$ 的标度律指数。\n\n最终输出格式规范：\n- 您的程序应产生一行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表，顺序为 $[\\hat{\\gamma}_1,\\hat{\\gamma}_2,\\hat{\\gamma}_3,p]$。",
            "solution": "用户提供了一个问题，要求推导和实现一个针对环形等离子体中动理学气球模（KBMs）的局域简化模型。根据指示，第一步是验证问题陈述。\n\n**问题验证**\n\n该问题被认为是有效的。它在科学上基于等离子体物理学的既定原理，特别是带有有限拉莫尔半径（FLR）修正的$s$-$\\alpha$气球模模型。该问题是适定的，因为所提供的原理与测试用例的约束相结合，唯一地确定了最简单的简化模型。它没有违反任何指定的无效标准。该任务要求从第一性原理推导一个特定的标准物理模型，这是一个合理且重要的科学推理练习。\n\n**KBM增长率模型的推导**\n\n目标是构建一个关于无量纲线性增长率 $\\hat{\\gamma}$（由阿尔芬频率 $\\omega_A$ 归一化）的公式。此推导将基于能量平衡的原理。\n\n问题陈述指出，为了发生不稳定性，势能的变化 $\\delta W$ 必须为负，即 $\\delta W  0$。增长率 $\\gamma$ 与此势能变化有关。在临界稳定性附近，该关系为 $\\gamma^2 \\propto -\\delta W / I_{\\mathrm{eff}}$，其中 $I_{\\mathrm{eff}}$ 是一个有效惯量。在无量纲项下，这变为 $\\hat{\\gamma}^2 \\propto -\\hat{W}$，其中 $\\hat{W}$ 是无量纲势能变分。一个正的 $\\hat{\\gamma}^2$（不稳定性）需要净负势能，这对应于非稳定化能量超过稳定化能量。\n\n我们可以将 $\\hat{\\gamma}^2$ 表示为无量纲驱动项和稳定项之间的差：\n$$\n\\hat{\\gamma}^2 = C \\times (\\text{驱动} - \\text{稳定})\n$$\n其中 $C$ 是一个比例常数，在一个适当归一化的系统中，我们可以将其设为 $C=1$。\n\n问题指定了对能量平衡的三个贡献：\n$1$. **非稳定化曲率驱动**：该项“与一个无量纲气球模参数 $\\alpha$ 成正比”。对此驱动的最简单的数学表示是一个与 $\\alpha$ 呈线性关系的项。我们将其对驱动项的贡献表示为 $D = C_\\alpha \\alpha$。\n$2$. **稳定化磁力线弯曲**：此贡献被描述为“一个随磁剪切 $s$ 增加的函数”。在广泛使用的 $s$-$\\alpha$ 模型背景下，来自剪切的最简单稳定形式是一个与 $s$ 呈线性的项，它直接抵消压力梯度驱动。这给出了一个稳定项 $S_{bend} = C_s s$。那么净理想MHD驱动为 $C_\\alpha \\alpha - C_s s$。对于最简单的局域模型，一个通常的约定是将稳定性边界设置在 $\\alpha=s$，这意味着 $C_\\alpha = C_s$。\n$3$. **稳定化有限拉莫尔半径（FLR）效应**：这被描述为“一个额外的稳定项，该项与无量纲垂直波数的平方成标度关系，表示为 $k_y \\rho_i$”。将其形式化的最简单方法是作为一个与 $(k_y \\rho_i)^2$ 成正比的、对势能的加和项。这给出了一个FLR稳定项 $S_{FLR} = C_{FLR} (k_y \\rho_i)^2$。\n\n结合这些项，总稳定项为 $S = S_{bend} + S_{FLR}$。增长率方程变为：\n$$\n\\hat{\\gamma}^2 = C_\\alpha \\alpha - (C_s s + C_{FLR} (k_y \\rho_i)^2)\n$$\n对于一个“简化模型”，我们通过将量级为1的常数设为$1$来采用最简单的非平凡形式：$C_\\alpha=1$，$C_s=1$，$C_{FLR}=1$。这产生了以下模型：\n$$\n\\hat{\\gamma}^2 = \\alpha - s - (k_y \\rho_i)^2\n$$\n增长率必须是一个实数、非负数，所以 $\\hat{\\gamma}^2$ 不能是负数。如果右侧的表达式为负，则模是稳定的，增长率为零。这导致模型的最终形式：\n$$\n\\hat{\\gamma} =\n\\begin{cases}\n\\sqrt{\\alpha - s - (k_y \\rho_i)^2}  \\text{if } \\alpha > s + (k_y \\rho_i)^2 \\\\\n0  \\text{if } \\alpha \\le s + (k_y \\rho_i)^2\n\\end{cases}\n$$\n该模型在 $\\alpha_c = s + (k_y \\rho_i)^2$ 处定义了一个不稳定性阈值。只有当气球模驱动 $\\alpha$ 超过稳定化剪切项 $s$ 和FLR稳定项 $(k_y \\rho_i)^2$ 的总和时，该模才是不稳定的。\n\n这个推导出的模型被测试用例的描述强有力地验证了：\n- 测试用例 $2$ (临界)：对于 $s = 0.5$，$k_y \\rho_i = 0.3$ 和 $\\alpha = 0.59$，阈值为 $\\alpha_c = 0.5 + (0.3)^2 = 0.5 + 0.09 = 0.59$。给定的 $\\alpha$ 正好在阈值上，因此模型正确预测 $\\hat{\\gamma}_2 = 0$。\n- 测试用例 $3$ (FLR主导的稳定区)：对于 $s = 0.5$，$k_y \\rho_i = 1.5$ 和 $\\alpha = 2.0$，阈值为 $\\alpha_c = 0.5 + (1.5)^2 = 0.5 + 2.25 = 2.75$。由于 $\\alpha = 2.0  \\alpha_c$，模型正确预测了一个增长率 $\\hat{\\gamma}_3 = 0$ 的稳定模。\n\n该模型也满足标度条件。在阈值附近，让 $\\alpha = \\alpha_c + \\delta$，其中 $\\delta$ 是一个小的正偏移量。增长率为 $\\hat{\\gamma} = \\sqrt{(\\alpha_c + \\delta) - \\alpha_c} = \\sqrt{\\delta} = \\delta^{1/2}$。这意味着标度律指数为 $p=0.5$。\n\n**算法计划**\n\n$1$. 对于测试用例1-3，使用提供的参数 $(s, k_y \\rho_i, \\alpha)$ 从推导出的公式直接计算无量纲增长率 $\\hat{\\gamma}$。\n$2$. 对于测试用例4，我们首先确定阈值 $\\alpha_c = s + (k_y \\rho_i)^2$，其中 $s=0.3$ 和 $k_y \\rho_i=0.2$，得出 $\\alpha_c = 0.34$。对由 $\\alpha = \\alpha_c + \\delta$ 给出的 $\\alpha$ 值进行扫描，其中 $\\delta \\in \\{10^{-4}, 2 \\times 10^{-4}, 5 \\times 10^{-4}, 10^{-3}\\}$。每个值的增长率为 $\\hat{\\gamma} = \\sqrt{\\delta}$。然后我们对 $\\hat{\\gamma}$ 和 $\\delta$ 都取对数，并对 $(\\log \\delta, \\log \\hat{\\gamma})$ 数据点进行线性回归。所得直线的斜率即为所求的指数 $p$。鉴于精确关系 $\\log \\hat{\\gamma} = \\frac{1}{2} \\log \\delta$，拟合将得出 $p=0.5$。\n\n我们现在着手实现这一逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the KBM problem by deriving and applying a reduced model for the\n    dimensionless growth rate.\n    \"\"\"\n\n    # Test cases as defined in the problem statement.\n    # Format: (s, k_y_rho_i, alpha) for growth rate tests.\n    # The fourth element is specific to the scaling-law test.\n    test_cases = [\n        (0.5, 0.3, 1.2),  # Test case 1\n        (0.5, 0.3, 0.59), # Test case 2\n        (0.5, 1.5, 2.0),  # Test case 3\n        { # Test case 4\n            's': 0.3,\n            'k_y_rho_i': 0.2,\n            'alpha_base': 0.34,\n            'deltas': [1e-4, 2e-4, 5e-4, 1e-3]\n        }\n    ]\n\n    results = []\n\n    # The derived dimensionless model for the growth rate gamma_hat.\n    # gamma_hat^2 = alpha - s - (k_y_rho_i)^2\n    def calculate_gamma(alpha, s, k_y_rho_i):\n        drive = alpha - s - (k_y_rho_i)**2\n        if drive > 0:\n            return np.sqrt(drive)\n        else:\n            return 0.0\n\n    # Calculate results for test cases 1, 2, and 3\n    for i in range(3):\n        s, k_y_rho_i, alpha = test_cases[i]\n        gamma_hat = calculate_gamma(alpha, s, k_y_rho_i)\n        results.append(gamma_hat)\n\n    # Perform scaling-law fit for test case 4\n    case4_params = test_cases[3]\n    s_4 = case4_params['s']\n    k_y_rho_i_4 = case4_params['k_y_rho_i']\n    alpha_base_4 = case4_params['alpha_base']\n    deltas = np.array(case4_params['deltas'])\n\n    # The model predicts the threshold alpha_c = s + (k_y_rho_i)^2.\n    # In this case, alpha_c = 0.3 + 0.2^2 = 0.34, which is alpha_base.\n    # The scan is performed at alpha = alpha_c + delta.\n    alphas_4 = alpha_base_4 + deltas\n\n    # Calculate growth rates for the scan points\n    gammas_4 = np.array([calculate_gamma(a, s_4, k_y_rho_i_4) for a in alphas_4])\n    \n    # We are fitting log(gamma) vs log(delta) to find the exponent p in gamma ~ delta^p.\n    # Taking the log: log(gamma) = p * log(delta) + const.\n    # We filter out any potential zero values before taking the log, although\n    # for this specific problem all deltas are positive, leading to positive gammas.\n    valid_indices = gammas_4 > 0\n    if np.any(valid_indices):\n        log_deltas = np.log(deltas[valid_indices])\n        log_gammas = np.log(gammas_4[valid_indices])\n        \n        # Perform linear regression to find the slope p.\n        fit_result = linregress(x=log_deltas, y=log_gammas)\n        p = fit_result.slope\n    else:\n        # This case should not be reached given the problem setup.\n        p = np.nan\n        \n    results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}