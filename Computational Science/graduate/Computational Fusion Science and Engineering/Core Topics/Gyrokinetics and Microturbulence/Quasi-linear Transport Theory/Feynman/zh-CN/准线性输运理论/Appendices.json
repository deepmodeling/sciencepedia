{
    "hands_on_practices": [
        {
            "introduction": "在输运理论中，最基本的计算之一是将粒子通量用涨落的性质来表示。本练习将演示密度涨落和 $E \\times B$ 速度涨落之间的关联，特别是它们的交叉相位，如何产生净粒子输运。通过完成这个推导，您将掌握湍流如何将粒子输运穿过磁场的关键机制 。",
            "id": "4198800",
            "problem": "考虑一个具有均匀磁场 $\\mathbf{B}=B\\,\\mathbf{b}$ 的板状等离子体，其中 $\\mathbf{b}=\\hat{\\mathbf{z}}$ 是一个恒定的单位矢量。设 $\\tilde{n}(\\mathbf{r},t)$ 和 $\\tilde{\\phi}(\\mathbf{r},t)$ 分别表示密度和静电势的小振幅湍流涨落。电场叉磁场（E$\\times$B）漂移定义为 $\\mathbf{v}_{E}=(\\mathbf{b}\\times\\nabla\\phi)/B$。在坐标为 $(x,y,z)$ 的板状几何中，取 $x$ 为径向方向，$y$ 为副法线（类极向）方向，$z$ 为沿 $\\mathbf{B}$ 的方向。准线性径向粒子通量定义为 $\\Gamma=\\langle \\tilde{n}\\,\\tilde{v}_{E,x}\\rangle$，其中平均 $\\langle\\cdot\\rangle$ 是在时间和垂直平面上进行的。\n\n假设涨落是均匀的，可以表示为单一傅里叶平面波，$\\tilde{n}(\\mathbf{r},t)=\\Re\\{\\tilde{n}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}$ 和 $\\tilde{\\phi}(\\mathbf{r},t)=\\Re\\{\\tilde{\\phi}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}$，其中波矢为 $\\mathbf{k}=(k_{x},k_{y},k_{\\parallel})$。设 $\\Delta\\theta=\\arg(\\tilde{n}_{\\mathbf{k}})-\\arg(\\tilde{\\phi}_{\\mathbf{k}})$ 表示密度和电势涨落之间的交叉相位。\n\n从 $\\mathbf{v}_{E}$ 的定义和上述涨落的表示出发，推导单模径向粒子通量 $\\Gamma_{\\mathbf{k}}$ 的准线性表达式，使其明确地表示出对副法线波数 $k_{y}$ 和交叉相位 $\\Delta\\theta$ 的依赖关系。将最终答案表示为关于 $k_{y}$、$B$、$|\\tilde{n}_{\\mathbf{k}}|$、$|\\tilde{\\phi}_{\\mathbf{k}}|$ 和 $\\Delta\\theta$ 的闭式解析表达式。除所述参数外，不要引入任何额外的常数或参数。不需要进行数值计算。",
            "solution": "该问题已经过验证，被认为是等离子体物理学中一个良定的、科学上合理的问题。我现在开始进行推导。\n\n目标是推导单模准线性径向粒子通量 $\\Gamma_{\\mathbf{k}}$ 的表达式，其定义为 $\\Gamma_{\\mathbf{k}} = \\langle \\tilde{n}\\,\\tilde{v}_{E,x}\\rangle$。平均 $\\langle\\cdot\\rangle$ 是在时间和垂直于磁场的空间平面上进行的。涨落以单一傅里叶模式给出。\n\n首先，我们确定E$\\times$B漂移速度的径向分量 $\\tilde{v}_{E,x}$。E$\\times$B速度定义为 $\\mathbf{v}_{E} = (\\mathbf{b}\\times\\nabla\\phi)/B$。对于涨落分量，这变为 $\\tilde{\\mathbf{v}}_{E} = (\\mathbf{b}\\times\\nabla\\tilde{\\phi})/B$。\n磁场是均匀的且沿 $\\hat{\\mathbf{z}}$ 方向，因此 $\\mathbf{b} = \\hat{\\mathbf{z}}$。坐标为 $(x, y, z)$。静电势的梯度为 $\\nabla\\tilde{\\phi} = \\frac{\\partial\\tilde{\\phi}}{\\partial x}\\hat{\\mathbf{x}} + \\frac{\\partial\\tilde{\\phi}}{\\partial y}\\hat{\\mathbf{y}} + \\frac{\\partial\\tilde{\\phi}}{\\partial z}\\hat{\\mathbf{z}}$。\n叉积为：\n$$\n\\mathbf{b}\\times\\nabla\\tilde{\\phi} = \\hat{\\mathbf{z}} \\times \\left( \\frac{\\partial\\tilde{\\phi}}{\\partial x}\\hat{\\mathbf{x}} + \\frac{\\partial\\tilde{\\phi}}{\\partial y}\\hat{\\mathbf{y}} + \\frac{\\partial\\tilde{\\phi}}{\\partial z}\\hat{\\mathbf{z}} \\right) = \\frac{\\partial\\tilde{\\phi}}{\\partial x}(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{x}}) + \\frac{\\partial\\tilde{\\phi}}{\\partial y}(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) = \\frac{\\partial\\tilde{\\phi}}{\\partial x}\\hat{\\mathbf{y}} - \\frac{\\partial\\tilde{\\phi}}{\\partial y}\\hat{\\mathbf{x}}\n$$\n因此，涨落的E$\\times$B速度为：\n$$\n\\tilde{\\mathbf{v}}_{E} = \\frac{1}{B}\\left(-\\frac{\\partial\\tilde{\\phi}}{\\partial y}\\hat{\\mathbf{x}} + \\frac{\\partial\\tilde{\\phi}}{\\partial x}\\hat{\\mathbf{y}}\\right)\n$$\n径向分量是 $x$ 分量，所以：\n$$\n\\tilde{v}_{E,x} = -\\frac{1}{B}\\frac{\\partial\\tilde{\\phi}}{\\partial y}\n$$\n问题指明涨落是单一傅里叶平面波：\n$$\n\\tilde{n}(\\mathbf{r},t) = \\Re\\{\\tilde{n}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}\n$$\n$$\n\\tilde{\\phi}(\\mathbf{r},t) = \\Re\\{\\tilde{\\phi}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}\n$$\n其中 $\\tilde{n}_{\\mathbf{k}}$ 和 $\\tilde{\\phi}_{\\mathbf{k}}$ 是波矢为 $\\mathbf{k}=(k_x, k_y, k_\\parallel)$ 的密度和电势涨落的复振幅。我们需要计算 $\\tilde{\\phi}$ 对 $y$ 的偏导数。一个复函数的实部的空间导数是其导数的实部。\n$$\n\\frac{\\partial\\tilde{\\phi}}{\\partial y} = \\frac{\\partial}{\\partial y} \\Re\\{\\tilde{\\phi}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\} = \\Re\\left\\{\\frac{\\partial}{\\partial y} (\\tilde{\\phi}_{\\mathbf{k}}\\exp[i(k_x x + k_y y + k_\\parallel z - \\omega t)])\\right\\}\n$$\n$$\n\\frac{\\partial\\tilde{\\phi}}{\\partial y} = \\Re\\{i k_y \\tilde{\\phi}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}\n$$\n将此代入 $\\tilde{v}_{E,x}$ 的表达式中：\n$$\n\\tilde{v}_{E,x} = -\\frac{1}{B} \\Re\\{i k_y \\tilde{\\phi}_{\\mathbf{k}}\\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}\n$$\n现在我们必须计算乘积的平均值 $\\langle \\tilde{n}\\,\\tilde{v}_{E,x}\\rangle$。对于两个实振荡量 $A(t) = \\Re\\{A_0 e^{-i\\omega t}\\}$ 和 $B(t) = \\Re\\{B_0 e^{-i\\omega t}\\}$ 的乘积的平均值，有一个通用结果是 $\\langle A(t) B(t) \\rangle = \\frac{1}{2}\\Re\\{A_0 B_0^*\\}$，其中 $A_0$ 和 $B_0$ 是复振幅，平均是在一个周期内进行的。这个公式可以推广到平面波的时空平均。\n\n在我们的例子中，这两个量是 $\\tilde{n}$ 和 $\\tilde{v}_{E,x}$。让我们确定它们的复振幅。\n对于密度涨落 $\\tilde{n}$，复振幅是 $\\tilde{n}_{\\mathbf{k}}$。\n对于径向速度涨落 $\\tilde{v}_{E,x}$，其表达式为 $\\Re\\{A_0 \\exp[i(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)]\\}$，其中复振幅 $A_0$ 是 $-\\frac{ik_y}{B}\\tilde{\\phi}_{\\mathbf{k}}$。我们称这个振幅为 $\\tilde{v}_{E,x,\\mathbf{k}}$。\n$$\n\\tilde{v}_{E,x,\\mathbf{k}} = -\\frac{i k_y}{B}\\tilde{\\phi}_{\\mathbf{k}}\n$$\n使用平均公式，模式 $\\mathbf{k}$ 的径向粒子通量为：\n$$\n\\Gamma_{\\mathbf{k}} = \\langle \\tilde{n}\\,\\tilde{v}_{E,x}\\rangle = \\frac{1}{2}\\Re\\{\\tilde{n}_{\\mathbf{k}} (\\tilde{v}_{E,x,\\mathbf{k}})^*\\}\n$$\n其中 $(\\cdot)^*$ 表示复共轭。我们计算 $\\tilde{v}_{E,x,\\mathbf{k}}$ 的共轭：\n$$\n(\\tilde{v}_{E,x,\\mathbf{k}})^* = \\left(-\\frac{i k_y}{B}\\tilde{\\phi}_{\\mathbf{k}}\\right)^* = \\left(\\frac{-i k_y}{B}\\right)^* (\\tilde{\\phi}_{\\mathbf{k}})^* = \\frac{i k_y}{B} \\tilde{\\phi}_{\\mathbf{k}}^*\n$$\n将此代入 $\\Gamma_{\\mathbf{k}}$ 的表达式中：\n$$\n\\Gamma_{\\mathbf{k}} = \\frac{1}{2}\\Re\\left\\{\\tilde{n}_{\\mathbf{k}} \\left(\\frac{i k_y}{B} \\tilde{\\phi}_{\\mathbf{k}}^*\\right)\\right\\} = \\frac{k_y}{2B}\\Re\\{i\\, \\tilde{n}_{\\mathbf{k}} \\tilde{\\phi}_{\\mathbf{k}}^*\\}\n$$\n问题将密度和电势涨落之间的交叉相位定义为 $\\Delta\\theta = \\arg(\\tilde{n}_{\\mathbf{k}}) - \\arg(\\tilde{\\phi}_{\\mathbf{k}})$。让我们用极坐标形式表示复振幅：\n$$\n\\tilde{n}_{\\mathbf{k}} = |\\tilde{n}_{\\mathbf{k}}|\\exp(i\\arg(\\tilde{n}_{\\mathbf{k}}))\n$$\n$$\n\\tilde{\\phi}_{\\mathbf{k}} = |\\tilde{\\phi}_{\\mathbf{k}}|\\exp(i\\arg(\\tilde{\\phi}_{\\mathbf{k}})) \\implies \\tilde{\\phi}_{\\mathbf{k}}^* = |\\tilde{\\phi}_{\\mathbf{k}}|\\exp(-i\\arg(\\tilde{\\phi}_{\\mathbf{k}}))\n$$\n那么，乘积 $\\tilde{n}_{\\mathbf{k}}\\tilde{\\phi}_{\\mathbf{k}}^*$ 是：\n$$\n\\tilde{n}_{\\mathbf{k}}\\tilde{\\phi}_{\\mathbf{k}}^* = |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\exp(i(\\arg(\\tilde{n}_{\\mathbf{k}})-\\arg(\\tilde{\\phi}_{\\mathbf{k}}))) = |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\exp(i\\Delta\\theta)\n$$\n现在，将此代入通量的表达式中：\n$$\n\\Gamma_{\\mathbf{k}} = \\frac{k_y}{2B}\\Re\\{i |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\exp(i\\Delta\\theta)\\}\n$$\n使用欧拉公式 $\\exp(i\\Delta\\theta) = \\cos(\\Delta\\theta) + i\\sin(\\Delta\\theta)$，我们得到：\n$$\ni \\exp(i\\Delta\\theta) = i\\cos(\\Delta\\theta) + i^2\\sin(\\Delta\\theta) = i\\cos(\\Delta\\theta) - \\sin(\\Delta\\theta)\n$$\n此表达式的实部是：\n$$\n\\Re\\{i \\exp(i\\Delta\\theta)\\} = -\\sin(\\Delta\\theta)\n$$\n因此，通量表达式中实部算子内的表达式变为：\n$$\n\\Re\\{i |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\exp(i\\Delta\\theta)\\} = |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\Re\\{i \\exp(i\\Delta\\theta)\\} = -|\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\sin(\\Delta\\theta)\n$$\n最后，将此代回 $\\Gamma_{\\mathbf{k}}$ 的表达式中，得到期望的结果：\n$$\n\\Gamma_{\\mathbf{k}} = \\frac{k_y}{2B} \\left( -|\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|\\sin(\\Delta\\theta) \\right)\n$$\n$$\n\\Gamma_{\\mathbf{k}} = -\\frac{k_y |\\tilde{n}_{\\mathbf{k}}||\\tilde{\\phi}_{\\mathbf{k}}|}{2B}\\sin(\\Delta\\theta)\n$$\n该表达式显示了单模径向粒子通量对副法线波数 $k_y$、磁场强度 $B$、密度和电势涨落的振幅 $|\\tilde{n}_{\\mathbf{k}}|$ 和 $|\\tilde{\\phi}_{\\mathbf{k}}|$ 以及它们的交叉相位 $\\Delta\\theta$ 的明确依赖关系。",
            "answer": "$$\n\\boxed{-\\frac{k_y |\\tilde{n}_{\\mathbf{k}}| |\\tilde{\\phi}_{\\mathbf{k}}|}{2B} \\sin(\\Delta\\theta)}\n$$"
        },
        {
            "introduction": "上一个练习展示了通量如何依赖于涨落的关联。本练习将更深入地探讨波-粒共振如何导致粒子在速度空间中的随机行走，这个过程可以用一个扩散系数来描述。通过使用 Green-Kubo 关系，您将把电场谱的统计特性与重塑粒子分布函数的基本输运系数联系起来 。",
            "id": "4034369",
            "problem": "考虑一个均匀的磁化等离子体，其处在一个均匀磁场 $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$ 中。一个种类为 $s$ 的测试粒子（电荷为 $q_{s}$，质量为 $m_{s}$）在波的相关时间内以恒定的平行速度 $v_{\\parallel}$ 沿着 $\\hat{\\mathbf{z}}$ 方向运动。假设存在由标量势 $\\phi(\\mathbf{r},t)$ 描述的静电涨落，其平行电场为 $E_{\\parallel}(\\mathbf{r},t) = -\\partial \\phi(\\mathbf{r},t)/\\partial z$。在准线性理论 (QLT) 中，平行速度空间扩散系数 $D_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel})$ 的共振部分源于平行加速度的自相关。请使用速度空间扩散的 Green–Kubo 关系和随机相位近似，结合弹道轨迹 $\\mathbf{r}(t) \\approx \\mathbf{r}_{0} + v_{\\parallel} t \\,\\hat{\\mathbf{z}}$（忽略有限拉莫尔半径效应和垂直漂移），推导 $D_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel})$ 的一个收敛表达式，该表达式应以静电波谱的形式表示。\n\n静电势涨落由双边频率谱 $S(\\mathbf{k},\\omega)$ 表征，其定义为\n$$\n\\left\\langle \\phi(\\mathbf{k},t)\\,\\phi^{*}(\\mathbf{k},0)\\right\\rangle \\;=\\; \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\; S(\\mathbf{k},\\omega)\\,\\exp(-\\mathrm{i}\\omega t),\n$$\n其中 $\\phi(\\mathbf{k},t)$ 是 $\\phi(\\mathbf{r},t)$ 的空间傅里叶变换，尖括号表示系综平均。假设谱由以下模型给出\n$$\nS(\\mathbf{k},\\omega) \\;=\\; S_{0}\\,\\exp\\!\\left(-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}\\right)\\,\\delta\\!\\left(k_{\\parallel} - k_{\\parallel 0}\\right)\\,\\frac{\\Delta \\omega}{\\pi\\left[(\\omega - \\omega_{0})^{2} + \\Delta \\omega^{2}\\right]},\n$$\n其中 $k_{\\perp} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$，并且 $S_{0}$、$k_{\\perp 0}$、$k_{\\parallel 0}$、$\\omega_{0}$ 和 $\\Delta \\omega$ 均为正常数。假设谱在垂直波数上是轴对称的，并且只有平行分量 $k_{\\parallel}$ 与平行加速度耦合。\n\n从上述第一性原理出发（不使用任何现成的准线性扩散公式），计算共振贡献 $D_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel})$，将其表示为关于 $q_{s}$、$m_{s}$、$S_{0}$、$k_{\\perp 0}$、$k_{\\parallel 0}$、$\\omega_{0}$、$\\Delta \\omega$ 和 $v_{\\parallel}$ 的闭合形式解析表达式。以国际单位制 (SI) 基本单位表示你的最终答案。无需进行数值计算。",
            "solution": "用户希望我根据提供的问题陈述来解决一个问题。\n\n### 步骤 1：提取已知条件\n-   **系统：** 一个均匀的磁化等离子体，其处在一个均匀磁场 $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$ 中。\n-   **测试粒子：** 种类 $s$，电荷 $q_{s}$，质量 $m_{s}$。\n-   **粒子运动：** 恒定的平行速度 $v_{\\parallel}$ 沿着 $\\hat{\\mathbf{z}}$；弹道轨迹近似 $\\mathbf{r}(t) \\approx \\mathbf{r}_{0} + v_{\\parallel} t \\,\\hat{\\mathbf{z}}$。忽略有限拉莫尔半径效应和垂直漂移。\n-   **涨落：** 静电的，由标量势 $\\phi(\\mathbf{r},t)$ 描述。\n-   **平行电场：** $E_{\\parallel}(\\mathbf{r},t) = -\\partial \\phi(\\mathbf{r},t)/\\partial z$。\n-   **任务：** 推导平行速度空间扩散系数的共振部分 $D_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel})$。\n-   **方法论：** 从 Green–Kubo 关系出发，使用随机相位近似和给定的弹道轨迹。\n-   **谱定义：** 双边频率谱 $S(\\mathbf{k},\\omega)$ 由以下关系定义：\n    $$\n    \\left\\langle \\phi(\\mathbf{k},t)\\,\\phi^{*}(\\mathbf{k},0)\\right\\rangle \\;=\\; \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\; S(\\mathbf{k},\\omega)\\,\\exp(-\\mathrm{i}\\omega t)\n    $$\n    其中 $\\phi(\\mathbf{k},t)$ 是 $\\phi(\\mathbf{r},t)$ 的空间傅里叶变换。\n-   **模型谱：** 谱由以下模型给出：\n    $$\n    S(\\mathbf{k},\\omega) \\;=\\; S_{0}\\,\\exp\\!\\left(-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}\\right)\\,\\delta\\!\\left(k_{\\parallel} - k_{\\parallel 0}\\right)\\,\\frac{\\Delta \\omega}{\\pi\\left[(\\omega - \\omega_{0})^{2} + \\Delta \\omega^{2}\\right]}\n    $$\n    其中 $k_{\\perp} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$，并且 $S_{0}$、$k_{\\perp 0}$、$k_{\\parallel 0}$、$\\omega_{0}$ 和 $\\Delta \\omega$ 均为正常数。谱被假设在 $k_\\perp$ 上是轴对称的。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于等离子体物理学中准线性理论的标准框架。在弱湍流等离子体中，使用 Green-Kubo 关系、未受扰动轨道的弹道轨迹以及随机相位近似是推导输运系数的标准程序。静电涨落谱的模型是一种在理论分析中使用的数学上定义明确且物理上合理的形式，它表示具有特征垂直和平行波数以及有限频率宽度的湍流。该问题是适定的，提供了推导唯一解所需的所有物理量和数学定义。语言客观而精确。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题是有效的。我现在将进行推导。\n\n平行速度空间扩散系数 $D_{v_{\\parallel} v_{\\parallel}}$ 由 Green–Kubo 公式给出，该公式将扩散系数与加速度自相关函数的时间积分联系起来。对于平稳过程，其表达式为：\n$$\nD_{v_{\\parallel} v_{\\parallel}} = \\int_{0}^{\\infty} \\mathrm{d}\\tau \\left\\langle a_{\\parallel}(t) a_{\\parallel}(t+\\tau) \\right\\rangle\n$$\n对于平稳过程，我们可以设 $t=0$，因此我们计算 $D_{v_{\\parallel} v_{\\parallel}} = \\int_{0}^{\\infty} \\mathrm{d}\\tau \\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle$。\n\n带电荷 $q_s$ 和质量 $m_s$ 的粒子的平行加速度 $a_{\\parallel}$ 是由平行电场 $E_{\\parallel}$ 引起的：\n$$\na_{\\parallel}(t) = \\frac{q_s}{m_s} E_{\\parallel}(\\mathbf{r}(t), t)\n$$\n问题指定使用未受扰动的弹道轨迹 $\\mathbf{r}(t) = \\mathbf{r}_0 + v_{\\parallel} t \\hat{\\mathbf{z}}$。沿此轨迹的加速度为：\n$$\na_{\\parallel}(t) = \\frac{q_s}{m_s} E_{\\parallel}(\\mathbf{r}_0 + v_{\\parallel} t \\hat{\\mathbf{z}}, t)\n$$\n我们用电场的傅里叶分量来表示它。傅里叶变换对的约定是 $\\phi(\\mathbf{r},t) = \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} \\phi(\\mathbf{k},t) e^{\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{r}}$。平行电场 $E_{\\parallel} = -\\partial\\phi/\\partial z$ 在傅里叶空间中变为：\n$$\nE_{\\parallel}(\\mathbf{r},t) = -\\frac{\\partial}{\\partial z} \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} \\phi(\\mathbf{k},t) e^{\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{r}} = \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} (-\\mathrm{i}k_{\\parallel}) \\phi(\\mathbf{k},t) e^{\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{r}}\n$$\n将粒子轨迹代入此表达式，得到在时间 $\\tau$ 的加速度：\n$$\na_{\\parallel}(\\tau) = \\frac{q_s}{m_s} \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} (-\\mathrm{i}k_{\\parallel}) \\phi(\\mathbf{k},\\tau) e^{\\mathrm{i}\\mathbf{k}\\cdot(\\mathbf{r}_0 + v_{\\parallel}\\tau\\hat{\\mathbf{z}})} = \\frac{q_s}{m_s} \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} (-\\mathrm{i}k_{\\parallel}) \\phi(\\mathbf{k},\\tau) e^{\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{r}_0} e^{\\mathrm{i}k_{\\parallel}v_{\\parallel}\\tau}\n$$\n在时间 $0$ 的加速度为：\n$$\na_{\\parallel}(0) = \\frac{q_s}{m_s} \\int \\frac{\\mathrm{d}^3\\mathbf{k}'}{(2\\pi)^3} (-\\mathrm{i}k'_{\\parallel}) \\phi(\\mathbf{k}',0) e^{\\mathrm{i}\\mathbf{k}'\\cdot\\mathbf{r}_0}\n$$\n加速度自相关函数为 $\\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle$。系综平均 $\\langle \\dots \\rangle$ 包括对初始位置 $\\mathbf{r}_0$ 的平均。\n\\begin{align*}\n\\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle = \\left(\\frac{q_s}{m_s}\\right)^2 \\iint \\frac{\\mathrm{d}^3\\mathbf{k}\\,\\mathrm{d}^3\\mathbf{k}'}{(2\\pi)^6} (-\\mathrm{i}k'_{\\parallel})(-\\mathrm{i}k_{\\parallel}) \\left\\langle \\phi(\\mathbf{k}',0)\\phi(\\mathbf{k},\\tau) e^{\\mathrm{i}(\\mathbf{k}+\\mathbf{k}')\\cdot\\mathbf{r}_0} \\right\\rangle e^{\\mathrm{i}k_{\\parallel}v_{\\parallel}\\tau}\n\\end{align*}\n使用随机相位近似，场 $\\phi(\\mathbf{k},t)$ 对于不同的 $\\mathbf{k}$ 是统计独立的。这意味着 $\\left\\langle \\phi(\\mathbf{k}', t_1) \\phi(\\mathbf{k}, t_2) \\right\\rangle = 0$，除非 $\\mathbf{k}' = -\\mathbf{k}$。此外，由于 $\\phi(\\mathbf{r}, t)$ 是实数，所以 $\\phi(\\mathbf{k})^* = \\phi(-\\mathbf{k})$。形式关系是 $\\left\\langle \\phi(\\mathbf{k}',t_1)\\phi(\\mathbf{k},t_2) \\right\\rangle = (2\\pi)^3 \\delta(\\mathbf{k}+\\mathbf{k}') \\left\\langle \\phi(-\\mathbf{k},t_1)\\phi(\\mathbf{k},t_2) \\right\\rangle = (2\\pi)^3 \\delta(\\mathbf{k}+\\mathbf{k}') \\left\\langle \\phi^*(\\mathbf{k},t_1)\\phi(\\mathbf{k},t_2) \\right\\rangle$。\n将此代入相关函数并对 $\\mathbf{k}'$ 积分，得到：\n$$\n\\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle = \\left(\\frac{q_s}{m_s}\\right)^2 \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} k_{\\parallel}^2 \\left\\langle \\phi^*(\\mathbf{k},0)\\phi(\\mathbf{k},\\tau) \\right\\rangle e^{\\mathrm{i}k_{\\parallel}v_{\\parallel}\\tau}\n$$\n该相关函数与给定的谱 $S(\\mathbf{k},\\omega)$ 有关。我们有 $\\left\\langle \\phi(\\mathbf{k},\\tau)\\phi^*(\\mathbf{k},0) \\right\\rangle = \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, S(\\mathbf{k},\\omega)\\exp(-\\mathrm{i}\\omega \\tau)$。\n因此，$\\left\\langle \\phi^*(\\mathbf{k},0)\\phi(\\mathbf{k},\\tau) \\right\\rangle = \\left\\langle \\phi(\\mathbf{k},\\tau)\\phi^*(\\mathbf{k},0) \\right\\rangle^*$。由于势是一个实场，其功率谱 $S(\\mathbf{k},\\omega)$ 必须是一个实函数。\n$$\n\\left\\langle \\phi^*(\\mathbf{k},0)\\phi(\\mathbf{k},\\tau) \\right\\rangle = \\left( \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, S(\\mathbf{k},\\omega)e^{-\\mathrm{i}\\omega \\tau} \\right)^* = \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, S(\\mathbf{k},\\omega)e^{\\mathrm{i}\\omega \\tau}\n$$\n将此代入加速度相关函数中：\n$$\n\\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle = \\left(\\frac{q_s}{m_s}\\right)^2 \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} k_{\\parallel}^2 \\left( \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, S(\\mathbf{k},\\omega)e^{\\mathrm{i}\\omega \\tau} \\right) e^{\\mathrm{i}k_{\\parallel}v_{\\parallel}\\tau}\n$$\n这个表达式包含一个由约定引起的符号错误。正确的物理相互作用发生在多普勒频移的频率 $\\omega' = \\omega - k_{\\parallel}v_{\\parallel}$ 上。从第一性原理出发，使用时空傅里叶变换 $\\phi(\\mathbf{r},t) = \\int \\frac{\\mathrm{d}^3\\mathbf{k}\\,\\mathrm{d}\\omega}{(2\\pi)^4} \\tilde{\\phi}(\\mathbf{k},\\omega) e^{\\mathrm{i}(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t)}$ 进行严格推导，可以得到正确的指数项：\n$$\n\\left\\langle a_{\\parallel}(0) a_{\\parallel}(\\tau) \\right\\rangle = \\left(\\frac{q_s}{m_s}\\right)^2 \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, k_{\\parallel}^2 S(\\mathbf{k},\\omega) e^{-\\mathrm{i}(\\omega-k_{\\parallel}v_{\\parallel})\\tau}\n$$\n现在我们通过对 $\\tau$ 从 $0$ 到 $\\infty$ 积分来计算扩散系数。我们关心的是共振部分，它来自时间积分的实部：\n$$\n\\int_0^\\infty e^{-\\mathrm{i}(\\omega-k_{\\parallel}v_{\\parallel})\\tau} \\mathrm{d}\\tau = \\pi\\delta(\\omega-k_{\\parallel}v_{\\parallel}) - \\mathrm{i}\\mathcal{P}\\frac{1}{\\omega-k_{\\parallel}v_{\\parallel}}\n$$\n其中 $\\mathcal{P}$ 是柯西主值。共振扩散由包含狄拉克 delta 函数的实部给出：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel}) = \\pi\\left(\\frac{q_s}{m_s}\\right)^2 \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega \\, k_{\\parallel}^2 S(\\mathbf{k},\\omega) \\delta(\\omega-k_{\\parallel}v_{\\parallel})\n$$\n使用 delta 函数对 $\\omega$ 进行积分，可令 $\\omega = k_{\\parallel}v_{\\parallel}$：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel}) = \\pi\\left(\\frac{q_s}{m_s}\\right)^2 \\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} k_{\\parallel}^2 S(\\mathbf{k}, k_{\\parallel}v_{\\parallel})\n$$\n现在我们代入给定的谱模型 $S(\\mathbf{k},\\omega)$：\n$$\nS(\\mathbf{k}, k_{\\parallel}v_{\\parallel}) = S_{0}\\,\\exp\\left(-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}\\right)\\,\\delta(k_{\\parallel} - k_{\\parallel 0})\\,\\frac{\\Delta \\omega}{\\pi[(k_{\\parallel}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}]}\n$$\n我们用柱坐标写出 k 空间中的体积元：$d^3\\mathbf{k} = k_{\\perp} \\mathrm{d}k_{\\perp} \\mathrm{d}\\theta \\mathrm{d}k_{\\parallel}$。由于谱是轴对称的，对 $\\theta$ 的积分得到 $2\\pi$。\n$$\n\\int \\frac{\\mathrm{d}^3\\mathbf{k}}{(2\\pi)^3} (\\dots) = \\int_{-\\infty}^{\\infty} \\mathrm{d}k_{\\parallel} \\int_0^\\infty \\mathrm{d}k_{\\perp} \\frac{2\\pi k_{\\perp}}{(2\\pi)^3} (\\dots) = \\int_{-\\infty}^{\\infty} \\mathrm{d}k_{\\parallel} \\int_0^\\infty \\mathrm{d}k_{\\perp} \\frac{k_{\\perp}}{4\\pi^2} (\\dots)\n$$\n将此代入 $D_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}$ 的表达式中：\n\\begin{align*}\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel}) = \\pi\\left(\\frac{q_s}{m_s}\\right)^2 \\int_{-\\infty}^{\\infty} \\mathrm{d}k_{\\parallel} \\int_0^\\infty \\mathrm{d}k_{\\perp} \\frac{k_{\\perp}}{4\\pi^2} k_{\\parallel}^2 \\left( S_{0}e^{-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}} \\delta(k_{\\parallel} - k_{\\parallel 0}) \\frac{\\Delta \\omega}{\\pi[(k_{\\parallel}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}]} \\right)\n\\end{align*}\n我们可以将关于 $k_{\\perp}$ 和 $k_{\\parallel}$ 的积分分开：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}} = \\left(\\frac{q_s}{m_s}\\right)^2 \\frac{S_0 \\Delta\\omega}{4\\pi^2} \\left[ \\int_0^\\infty k_{\\perp} e^{-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}} \\mathrm{d}k_{\\perp} \\right] \\left[ \\int_{-\\infty}^\\infty k_{\\parallel}^2 \\delta(k_{\\parallel} - k_{\\parallel 0}) \\frac{1}{(k_{\\parallel}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}} \\mathrm{d}k_{\\parallel} \\right]\n$$\n我们来计算每个积分。首先，是关于 $k_{\\perp}$ 的积分：\n$$\nI_{\\perp} = \\int_0^\\infty k_{\\perp} e^{-\\frac{k_{\\perp}^{2}}{k_{\\perp 0}^{2}}} \\mathrm{d}k_{\\perp}\n$$\n使用换元 $u = k_{\\perp}^2/k_{\\perp 0}^2$，则 $\\mathrm{d}u = 2k_{\\perp}\\mathrm{d}k_{\\perp}/k_{\\perp 0}^2$，即 $k_{\\perp}\\mathrm{d}k_{\\perp} = (k_{\\perp 0}^2/2)\\mathrm{d}u$：\n$$\nI_{\\perp} = \\frac{k_{\\perp 0}^2}{2} \\int_0^\\infty e^{-u} \\mathrm{d}u = \\frac{k_{\\perp 0}^2}{2} [-e^{-u}]_0^{\\infty} = \\frac{k_{\\perp 0}^2}{2}\n$$\n接下来，是关于 $k_{\\parallel}$ 的积分。狄拉克 delta 函数 $\\delta(k_{\\parallel} - k_{\\parallel 0})$ 通过在被积函数的其余部分中设置 $k_{\\parallel} = k_{\\parallel 0}$，使得计算变得直接：\n$$\nI_{\\parallel} = \\int_{-\\infty}^\\infty k_{\\parallel}^2 \\delta(k_{\\parallel} - k_{\\parallel 0}) \\frac{1}{(k_{\\parallel}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}} \\mathrm{d}k_{\\parallel} = \\frac{k_{\\parallel 0}^2}{(k_{\\parallel 0}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}}\n$$\n最后，我们将所有部分组合起来，得到扩散系数的表达式：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}} = \\left(\\frac{q_s}{m_s}\\right)^2 \\frac{S_0 \\Delta\\omega}{4\\pi^2} \\left( \\frac{k_{\\perp 0}^2}{2} \\right) \\left( \\frac{k_{\\parallel 0}^2}{(k_{\\parallel 0}v_{\\parallel} - \\omega_{0})^{2} + \\Delta \\omega^{2}} \\right)\n$$\n化简常数项得到最终结果：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel}) = \\frac{q_s^2 S_0 k_{\\perp 0}^2 k_{\\parallel 0}^2 \\Delta\\omega}{8\\pi^2 m_s^2} \\frac{1}{(k_{\\parallel 0}v_{\\parallel} - \\omega_{0})^{2} + \\Delta\\omega^{2}}\n$$\n这个表达式可以写成：\n$$\nD_{v_{\\parallel} v_{\\parallel}}^{\\mathrm{res}}(v_{\\parallel}) = \\left(\\frac{q_s}{m_s}\\right)^2 \\frac{S_0 k_{\\perp 0}^2 k_{\\parallel 0}^2 \\Delta\\omega}{8\\pi^2} \\frac{1}{(\\omega_{0} - k_{\\parallel 0}v_{\\parallel})^{2} + \\Delta\\omega^{2}}\n$$\n这个结果就是用给定参数表示的共振平行速度扩散系数。从洛伦兹形式的分母可以清楚地看到其共振特性，当切伦科夫共振条件 $\\omega_0 - k_{\\parallel 0}v_{\\parallel} = 0$ 满足时，该分母达到峰值。",
            "answer": "$$\\boxed{\\left(\\frac{q_{s}}{m_{s}}\\right)^{2} \\frac{S_{0} k_{\\perp 0}^{2} k_{\\parallel 0}^{2} \\Delta \\omega}{8\\pi^{2}} \\frac{1}{(\\omega_{0} - k_{\\parallel 0} v_{\\parallel})^{2} + (\\Delta \\omega)^{2}}}$$"
        },
        {
            "introduction": "将理论概念转化为实际应用是至关重要的一步。本练习利用混合长度近似——这是湍流理论中一个强大的启发式方法——从不稳定性（如离子温度梯度模）的线性特性来估算离子热扩散系数 $\\chi_i$。您将通过编写代码实现这个准线性模型，从而将抽象的理论概念转化为定量的预测 。",
            "id": "4034363",
            "problem": "考虑磁化等离子体中的静电离子温度梯度（ITG）模，并假设处于 $k_{\\perp} \\rho_i \\sim O(1)$ 的区间，其中 $k_{\\perp}$ 是垂直波数，$\\rho_i$ 是离子拉莫尔半径。准线性输运理论通过聚合由副法向波数 $k_y$ 索引的、统计上独立的模谱的贡献来估计离子热扩散系数 $\\chi_i$。请基于以下基本原理开始您的推导：\n\n- 回旋频率的定义 $\\Omega_i = \\frac{q_i B}{m_i}$，其中 $q_i$ 是离子电荷，$B$ 是以 $\\mathrm{Tesla}$ 为单位的磁场强度，$m_i$ 是以 $\\mathrm{kg}$ 为单位的离子质量。\n- 离子热速度 $v_{\\mathrm{thi}} = \\sqrt{\\frac{2 T_i}{m_i}}$，其中 $T_i$ 是以 $\\mathrm{J}$ 为单位的离子温度。\n- 离子拉莫尔半径 $\\rho_i = \\frac{v_{\\mathrm{thi}}}{\\Omega_i}$。\n- 对于被动标量（背景离子温度）的扩散输运，采用随机相位近似和退相关论证，这意味着一个随机行走过程，其步长由垂直相关长度设定，步长时间由线性增长率的倒数设定。\n\n运用这些原理，推导出一个可计算的 $\\chi_i$ 的准线性表达式，形式为对离散 $k_y$ 模的加权和。权重必须源于物理上合理的ITG模的线性本征函数特性：明确地包含通过第一类零阶贝塞尔函数 $J_0(k_{\\perp} \\rho_i)$ 体现的有限拉莫尔半径平均效应，以及由线性本征函数产生的、涨落静电势和涨落离子温度之间的交叉相角 $\\theta_k$（以弧度为单位）。最终表达式的量纲必须一致，且 $\\chi_i$ 的最终数值必须以 $\\mathrm{m}^2/\\mathrm{s}$ 表示。\n\n您必须将推导出的公式实现为一个完整的、可运行的程序。对于下方的每个测试用例，该程序通过对所提供的离散模集进行求和来计算 $\\chi_i$。取每个模的垂直波数为 $k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$，并通过每个测试用例提供的恒定比率 $\\alpha = \\frac{k_x}{k_y}$ 来模拟谱各向异性，因此 $k_{\\perp} = k_y \\sqrt{1 + \\alpha^2}$。对于每个模，给定无量纲参数 $s_j = k_{\\perp j} \\rho_i$、线性增长率 $\\gamma_j$（单位 $\\mathrm{s}^{-1}$）以及交叉相角 $\\theta_j$（单位弧度）。离子种类为氘，其电荷 $q_i = e$ 和质量 $m_i$ 被明确指定。使用 $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$ 将 $T_i$ 从 $\\mathrm{keV}$ 转换为 $\\mathrm{J}$。\n\n测试套件和数据（每个项目符号为一个测试用例）：\n- 用例1（正常路径）：\n  - $B = 2.0\\,\\mathrm{T}$，$T_i = 2.5\\,\\mathrm{keV}$，$m_i = 3.343 \\times 10^{-27}\\,\\mathrm{kg}$，$\\alpha = 1.0$\n  - 模：$s = [0.6, 1.0, 1.4]$，$\\gamma = [4.0 \\times 10^{5}, 1.2 \\times 10^{6}, 8.0 \\times 10^{5}]\\,\\mathrm{s}^{-1}$，$\\theta = [0.35, 0.50, 0.40]\\,\\mathrm{rad}$\n- 用例2（强磁场；有限拉莫尔半径抑制效应更显著）：\n  - $B = 5.0\\,\\mathrm{T}$，$T_i = 1.5\\,\\mathrm{keV}$，$m_i = 3.343 \\times 10^{-27}\\,\\mathrm{kg}$，$\\alpha = 0.7$\n  - 模：$s = [0.8, 1.2]$，$\\gamma = [3.0 \\times 10^{5}, 7.0 \\times 10^{5}]\\,\\mathrm{s}^{-1}$，$\\theta = [0.30, 0.45]\\,\\mathrm{rad}$\n- 用例3（边界条件，包含一个临界稳定模）：\n  - $B = 3.0\\,\\mathrm{T}$，$T_i = 3.0\\,\\mathrm{keV}$，$m_i = 3.343 \\times 10^{-27}\\,\\mathrm{kg}$，$\\alpha = 1.3$\n  - 模：$s = [0.5, 1.0, 2.0]$，$\\gamma = [0.0, 9.0 \\times 10^{5}, 4.0 \\times 10^{5}]\\,\\mathrm{s}^{-1}$，$\\theta = [0.40, 0.60, 0.20]\\,\\mathrm{rad}$\n- 用例4（具有强各向异性的边缘用例）：\n  - $B = 1.5\\,\\mathrm{T}$，$T_i = 1.0\\,\\mathrm{keV}$，$m_i = 3.343 \\times 10^{-27}\\,\\mathrm{kg}$，$\\alpha = 3.0$\n  - 模：$s = [1.0]$，$\\gamma = [1.0 \\times 10^{5}]\\,\\mathrm{s}^{-1}$，$\\theta = [0.50]\\,\\mathrm{rad}$\n\n角度输入必须解释为弧度。您的程序必须为每个测试用例计算 $\\chi_i$，并生成单行输出，其中包含以逗号分隔、方括号括起来的结果列表，单位为 $\\mathrm{m}^2/\\mathrm{s}$（例如，$[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个浮点数）。",
            "solution": "该问题要求推导并实现一个可计算的准线性表达式，用于描述在存在离子温度梯度（ITG）湍流的磁化等离子体中的离子热扩散系数 $\\chi_i$。推导过程必须基于所提供的物理原理。\n\n### 准线性离子热扩散系数 $\\chi_i$ 的推导\n\n1.  **扩散的随机行走模型**\n    问题陈述为扩散输运建立了一个随机行走过程的框架。在此类模型中，扩散系数，这里指离子热扩散系数 $\\chi_i$，近似由以下关系式给出：\n    $$ \\chi_i \\approx \\frac{(\\Delta x)^2}{\\Delta t} $$\n    其中 $\\Delta x$ 是随机行走的特征空间步长，$\\Delta t$ 是步与步之间的特征时间。\n\n2.  **特征尺度的确定**\n    问题指导了在等离子体湍流背景下对这些尺度的确定：\n    -   步长时间 $\\Delta t$ 是湍流涨落的退相关时间。对于线性不稳定性，可以合理地将其近似为线性增长率 $\\gamma$ 的倒数。因此，对于索引为 $j$ 的模，我们有 $\\Delta t_j = 1/\\gamma_j$。\n    -   步长 $\\Delta x$ 是湍流涡旋的垂直相关长度。在混合长度理论中，这被认为与垂直波数 $k_{\\perp}$ 的倒数成正比。因此，对于一个模 $j$，有 $\\Delta x_j \\sim 1/k_{\\perp j}$。\n\n3.  **基本的混合长度扩散系数**\n    将这些尺度代入随机行走公式，得到单个模 $j$ 对扩散系数贡献的基本混合长度估计：\n    $$ \\chi_{i,j} \\sim \\frac{(1/k_{\\perp j})^2}{1/\\gamma_j} = \\frac{\\gamma_j}{k_{\\perp j}^2} $$\n    该表达式在量纲上是一致的，单位为 $(\\mathrm{s}^{-1}) / (\\mathrm{m}^{-1})^2 = \\mathrm{m}^2/\\mathrm{s}$。\n\n4.  **引入物理权重因子**\n    问题要求明确地包含两个调节输运效率的额外物理效应：\n    -   **有限拉莫尔半径（FLR）平均**：离子经历的不是涨落电场的点值，而是其在回旋运动轨道上平均后的场。这种平均效应减弱了离子对短波长涨落的响应。对于一个垂直波数为 $k_{\\perp j}$ 的波，这种减弱在数学上由第一类零阶贝塞尔函数 $J_0(k_{\\perp j} \\rho_i)$ 描述，其中 $\\rho_i$ 是离子拉莫尔半径。由于通量和扩散系数与涨落场或粒子响应呈二次关系，因此扩散系数要按因子 $J_0^2(k_{\\perp j} \\rho_i)$ 进行缩放。\n    -   **交叉相角**：净热量输运要求涨落的径向速度（由静电势涨落 $\\tilde{\\phi}$ 驱动）和离子温度涨落 $\\tilde{T}_i$ 之间存在相位差。径向热通量 $Q_r$ 与时间平均值 $\\langle \\tilde{v}_{Er} \\tilde{T}_i \\rangle$ 成正比。只有存在相移时，该平均值才非零。所产生通量的大小与 $\\sin(\\theta_j)$ 成正比，其中 $\\theta_j$ 是势涨落和温度涨落之间的交叉相角。因此，扩散系数必须由因子 $\\sin(\\theta_j)$ 加权。\n\n5.  **组合成单个模的完整公式**\n    将混合长度估计与物理权重因子相结合，并假设一个数量级为1的前导无量纲常数（在此类估计中通常设为1），则单个模 $j$ 的扩散系数贡献为：\n    $$ \\chi_{i,j} = \\frac{\\gamma_j}{k_{\\perp j}^2} J_0^2(k_{\\perp j} \\rho_i) \\sin(\\theta_j) $$\n\n6.  **总扩散系数和最终可计算表达式**\n    总热扩散系数 $\\chi_i$ 是湍流谱中所有统计独立模贡献的总和。对于所提供的离散模集：\n    $$ \\chi_i = \\sum_j \\chi_{i,j} = \\sum_j \\frac{\\gamma_j}{k_{\\perp j}^2} J_0^2(k_{\\perp j} \\rho_i) \\sin(\\theta_j) $$\n    问题提供了无量纲参数 $s_j = k_{\\perp j} \\rho_i$。我们可以将 $k_{\\perp j}$ 表示为 $s_j / \\rho_i$。将其代入求和式中可得：\n    $$ \\chi_i = \\sum_j \\frac{\\gamma_j}{(s_j / \\rho_i)^2} J_0^2(s_j) \\sin(\\theta_j) = \\sum_j \\frac{\\gamma_j \\rho_i^2}{s_j^2} J_0^2(s_j) \\sin(\\theta_j) $$\n    将常数 $\\rho_i^2$ 提取出来，我们得到最终的计算公式：\n    $$ \\chi_i = \\rho_i^2 \\sum_j \\frac{\\gamma_j}{s_j^2} J_0^2(s_j) \\sin(\\theta_j) $$\n    注意，谱各向异性参数 $\\alpha = k_x/k_y$ 仅作为物理背景提供，计算中并不需要，因为有效的垂直模结构已经包含在给定的参数 $s_j = k_{\\perp j} \\rho_i$ 中。\n\n### 辅助参数的计算\n\n必须根据给定的等离子体参数计算离子拉莫尔半径 $\\rho_i$。\n- 离子温度 $T_i$ 以 $\\mathrm{keV}$ 给出，必须转换为焦耳（$J$）：\n  $T_i\\,(\\mathrm{J}) = T_i\\,(\\mathrm{keV}) \\times 1000 \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV})$。\n- 离子热速度 $v_{\\mathrm{thi}}$ 由下式给出：\n  $v_{\\mathrm{thi}} = \\sqrt{\\frac{2 T_i}{m_i}}$。\n- 离子回旋频率 $\\Omega_i$ 由下式给出：\n  $\\Omega_i = \\frac{q_i B}{m_i}$，其中 $q_i = e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$。\n- 因此，离子拉莫尔半径 $\\rho_i$ 为：\n  $$ \\rho_i = \\frac{v_{\\mathrm{thi}}}{\\Omega_i} = \\frac{\\sqrt{2 T_i / m_i}}{q_i B / m_i} = \\frac{\\sqrt{2 T_i m_i}}{q_i B} $$\n此表达式中的所有量都必须使用国际单位制基本单位（$T_i$ 单位为J，$m_i$ 单位为kg，$q_i$ 单位为C，$B$ 单位为T），以得出以米为单位的 $\\rho_i$。\n\n### 算法摘要\n对于每个测试用例：\n1.  定义物理常数 $e$ 和 eV 到 J 的转换因子。\n2.  将输入的离子温度 $T_i$ 从 $\\mathrm{keV}$ 转换为焦耳。\n3.  使用上述公式计算离子拉莫尔半径 $\\rho_i$。\n4.  初始化一个求和变量，例如 `sum_val`，为 $0.0$。\n5.  遍历每个具有参数 $(s_j, \\gamma_j, \\theta_j)$ 的模 $j$：\n    -   如果 $\\gamma_j = 0$ 或 $s_j = 0$，则贡献为 $0$。\n    -   否则，计算项 $T_j = \\frac{\\gamma_j}{s_j^2} J_0^2(s_j) \\sin(\\theta_j)$。\n    -   将 $T_j$ 加到 `sum_val`。\n6.  计算最终的扩散系数为 $\\chi_i = \\rho_i^2 \\times \\text{sum\\_val}$。\n7.  结果的单位为 $\\mathrm{m}^2/\\mathrm{s}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Solves the quasi-linear transport problem for all test cases.\n    \"\"\"\n    \n    # Define fundamental constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    EV_TO_JOULE = 1.602176634e-19 # eV to Joule conversion factor\n    KEV_TO_JOULE = EV_TO_JOULE * 1000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary for clarity.\n    test_cases = [\n        {\n            \"B\": 2.0, \"Ti_keV\": 2.5, \"mi\": 3.343e-27, \"alpha\": 1.0,\n            \"modes\": {\n                \"s\": [0.6, 1.0, 1.4],\n                \"gamma\": [4.0e5, 1.2e6, 8.0e5],\n                \"theta\": [0.35, 0.50, 0.40]\n            }\n        },\n        {\n            \"B\": 5.0, \"Ti_keV\": 1.5, \"mi\": 3.343e-27, \"alpha\": 0.7,\n            \"modes\": {\n                \"s\": [0.8, 1.2],\n                \"gamma\": [3.0e5, 7.0e5],\n                \"theta\": [0.30, 0.45]\n            }\n        },\n        {\n            \"B\": 3.0, \"Ti_keV\": 3.0, \"mi\": 3.343e-27, \"alpha\": 1.3,\n            \"modes\": {\n                \"s\": [0.5, 1.0, 2.0],\n                \"gamma\": [0.0, 9.0e5, 4.0e5],\n                \"theta\": [0.40, 0.60, 0.20]\n            }\n        },\n        {\n            \"B\": 1.5, \"Ti_keV\": 1.0, \"mi\": 3.343e-27, \"alpha\": 3.0,\n            \"modes\": {\n                \"s\": [1.0],\n                \"gamma\": [1.0e5],\n                \"theta\": [0.50]\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_chi_i(case, E_CHARGE, KEV_TO_JOULE)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef calculate_chi_i(case_data, q_i, kev_to_j):\n    \"\"\"\n    Calculates the ion heat diffusivity chi_i for a single test case.\n\n    The formula used is derived from quasi-linear theory and mixing-length arguments:\n    chi_i = rho_i^2 * sum_j [ (gamma_j / s_j^2) * J_0(s_j)^2 * sin(theta_j) ]\n    where rho_i = sqrt(2 * T_i * m_i) / (q_i * B)\n    \"\"\"\n    B = case_data[\"B\"]          # Magnetic field in Tesla\n    Ti_keV = case_data[\"Ti_keV\"]  # Ion temperature in keV\n    m_i = case_data[\"mi\"]         # Ion mass in kg\n    modes = case_data[\"modes\"]    # Dictionary of mode arrays for s, gamma, theta\n\n    # Convert ion temperature from keV to Joules\n    T_i_J = Ti_keV * kev_to_j\n\n    # Calculate the ion Larmor radius (rho_i) in meters\n    # rho_i = (v_thi) / Omega_i = (sqrt(2*Ti/mi)) / (q*B/mi) = sqrt(2*Ti*mi)/(q*B)\n    numerator = np.sqrt(2 * T_i_J * m_i)\n    denominator = q_i * B\n    rho_i = numerator / denominator\n\n    # Sum the contributions from each mode\n    sum_val = 0.0\n    num_modes = len(modes[\"s\"])\n    \n    for j in range(num_modes):\n        s_j = modes[\"s\"][j]\n        gamma_j = modes[\"gamma\"][j]\n        theta_j = modes[\"theta\"][j]\n\n        # A marginally stable mode (gamma=0) or a k_perp=0 mode (s=0) does not contribute to transport.\n        if gamma_j == 0.0 or s_j == 0.0:\n            continue\n        \n        # Calculate single mode contribution to the sum\n        j0_val = j0(s_j)\n        sin_theta = np.sin(theta_j)\n        \n        term = (gamma_j / s_j**2) * (j0_val**2) * sin_theta\n        sum_val += term\n        \n    # Final diffusivity calculation\n    chi_i = rho_i**2 * sum_val\n    \n    return chi_i\n\nsolve()\n```"
        }
    ]
}