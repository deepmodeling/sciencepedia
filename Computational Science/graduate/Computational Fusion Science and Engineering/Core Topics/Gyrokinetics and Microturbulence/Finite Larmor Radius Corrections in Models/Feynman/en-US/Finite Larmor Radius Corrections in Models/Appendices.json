{
    "hands_on_practices": [
        {
            "introduction": "To understand finite Larmor radius (FLR) corrections, we must first master the concept of the Larmor radius, $r_L$, itself. This foundational exercise guides you through its derivation from the first principles of single-particle motion in a uniform magnetic field $\\mathbf{B}$. By calculating a concrete value for $r_L$ and analyzing its scaling with particle mass, charge, and field strength, you will develop a crucial physical intuition for the characteristic scale of particle gyromotion .",
            "id": "3963559",
            "problem": "A singly ionized hydrogen nucleus (proton) with charge $q=+e$ and mass $m=m_{p}$ moves in a uniform magnetic field of magnitude $B$ such that its velocity component perpendicular to the magnetic field is $v_{\\perp}$. In the context of magnetized plasma dynamics and wave–particle interaction basics relevant to computational fusion science and engineering, the perpendicular motion of the charged particle in a uniform magnetic field is circular due to the Lorentz force. Starting from the Lorentz force law $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$ and the kinematic description of uniform circular motion, derive an expression for the gyroradius (also called the Larmor radius) $r_{L}$ in terms of $m$, $q$, $v_{\\perp}$, and $B$. Then, compute $r_{L}$ for a proton with $v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ in a uniform field $B = 6.00\\,\\mathrm{T}$. Use $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ and $m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$. Assume nonrelativistic motion. Express your final numerical answer for $r_{L}$ in meters and round your result to four significant figures.\n\nFinally, based on your derived expression, discuss the scaling of $r_{L}$ with particle mass $m$, charge magnitude $|q|$, and magnetic field strength $B$, connecting to the notion of cyclotron frequency as it arises from first principles.",
            "solution": "The problem asks for the derivation of the gyroradius for a charged particle in a uniform magnetic field, its numerical calculation for a specific case, and a discussion of its scaling properties.\n\n**Problem Validation**\n\nFirst, I will validate the provided problem statement.\n\n**Step 1: Extract Givens**\n-   Particle: Singly ionized hydrogen nucleus (proton).\n-   Charge: $q = +e$.\n-   Mass: $m = m_p$.\n-   Magnetic Field: Uniform, with magnitude $B$.\n-   Velocity: Perpendicular component to the magnetic field is $v_{\\perp}$.\n-   Governing Equation: Lorentz force law, $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$.\n-   Motion Type: Uniform circular motion for the perpendicular component.\n-   Task 1: Derive an expression for the gyroradius $r_{L}$ in terms of $m$, $q$, $v_{\\perp}$, and $B$.\n-   Task 2: Compute $r_{L}$ for a proton with $v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ in a uniform field $B = 6.00\\,\\mathrm{T}$.\n-   Constants: $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$.\n-   Assumption: Nonrelativistic motion.\n-   Requirement: Express numerical answer in meters, rounded to four significant figures.\n-   Task 3: Discuss the scaling of $r_L$ with $m$, $|q|$, and $B$, and connect to the cyclotron frequency.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is a classic and fundamental exercise in plasma physics and electromagnetism, based on the well-established Lorentz force law and Newtonian mechanics. The context of fusion science is appropriate and the physical parameters are realistic. The proton energy is $(1/2)m_p v_{\\perp}^2 \\approx 32.7\\,\\mathrm{keV}$ and the magnetic field strength of $6.00\\,\\mathrm{T}$ is typical for high-field fusion experiments. The velocity $v_{\\perp} = 2.50\\times 10^6\\,\\mathrm{m/s}$ is approximately $0.83\\%$ of the speed of light, so the nonrelativistic assumption is valid.\n-   **Well-Posed:** The problem is clearly stated, with all necessary data and constraints provided to derive a unique analytical expression and compute a specific numerical result.\n-   **Objective:** The language is formal, precise, and free of subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, and objective. I will now proceed with the solution.\n\n**Part 1: Derivation of the Gyroradius ($r_L$)**\n\nThe motion of a charged particle with mass $m$ and charge $q$ in a magnetic field $\\mathbf{B}$ is governed by the Lorentz force, given by Newton's second law:\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})$$\nLet's decompose the velocity vector $\\mathbf{v}$ into components parallel ($\\mathbf{v}_{\\parallel}$) and perpendicular ($\\mathbf{v}_{\\perp}$) to the magnetic field $\\mathbf{B}$. So, $\\mathbf{v} = \\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}$.\nSubstituting this into the equation of motion:\n$$m \\frac{d}{dt}(\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) = q((\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) \\times \\mathbf{B})$$\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\parallel} \\times \\mathbf{B}) + q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nSince $\\mathbf{v}_{\\parallel}$ is parallel to $\\mathbf{B}$, their cross product is zero: $\\mathbf{v}_{\\parallel} \\times \\mathbf{B} = \\mathbf{0}$. The equation simplifies to:\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThis shows that there is no force component parallel to $\\mathbf{B}$, so the parallel velocity $\\mathbf{v}_{\\parallel}$ remains constant. The force acts entirely in the plane perpendicular to $\\mathbf{B}$. The equation for the perpendicular motion is:\n$$m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThe force $\\mathbf{F}_{\\perp} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ is always perpendicular to both $\\mathbf{v}_{\\perp}$ and $\\mathbf{B}$. A force that is constant in magnitude and always perpendicular to the velocity vector results in uniform circular motion. The magnitude of this force is:\n$$F_{\\perp} = |q| v_{\\perp} B \\sin(\\theta)$$\nwhere $v_{\\perp} = |\\mathbf{v}_{\\perp}|$ and $\\theta$ is the angle between $\\mathbf{v}_{\\perp}$ and $\\mathbf{B}$. By definition, $\\theta = \\frac{\\pi}{2}$, so $\\sin(\\theta) = 1$. The force magnitude is therefore:\n$$F_{\\perp} = |q| v_{\\perp} B$$\nFor uniform circular motion with radius $r_L$ (the gyroradius) and speed $v_{\\perp}$, the centripetal force required is given by:\n$$F_{c} = m a_{c} = m \\frac{v_{\\perp}^2}{r_L}$$\nEquating the magnitude of the magnetic Lorentz force with the required centripetal force:\n$$m \\frac{v_{\\perp}^2}{r_L} = |q| v_{\\perp} B$$\nAssuming $v_{\\perp} \\neq 0$, we can divide both sides by $v_{\\perp}$ and solve for $r_L$:\n$$r_L = \\frac{m v_{\\perp}}{|q| B}$$\nThis is the desired expression for the gyroradius.\n\n**Part 2: Numerical Calculation of $r_L$**\n\nWe are given the following values for a proton:\n-   Mass $m = m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$\n-   Charge $q = +e$, so $|q| = e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n-   Perpendicular velocity $v_{\\perp} = 2.50 \\times 10^{6}\\,\\mathrm{m/s}$\n-   Magnetic field strength $B = 6.00\\,\\mathrm{T}$\n\nSubstituting these values into the derived expression for $r_L$:\n$$r_L = \\frac{(1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (2.50 \\times 10^{6}\\,\\mathrm{m/s})}{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\cdot (6.00\\,\\mathrm{T})}$$\n$$r_L = \\frac{4.181554809225 \\times 10^{-21}}{9.613059804 \\times 10^{-19}}\\,\\mathrm{m}$$\n$$r_L = 0.43499039... \\times 10^{-2}\\,\\mathrm{m}$$\n$$r_L \\approx 0.0043499\\,\\mathrm{m}$$\nThe problem requires the result to be rounded to four significant figures. The first four significant figures are $4$, $3$, $4$, $9$. The fifth digit is $9$, so we round up the fourth digit.\n$$r_L \\approx 0.004350\\,\\mathrm{m}$$\nExpressed in scientific notation, this is $4.350 \\times 10^{-3}\\,\\mathrm{m}$.\n\n**Part 3: Scaling and Connection to Cyclotron Frequency**\n\nThe derived expression for the gyroradius is $r_L = \\frac{m v_{\\perp}}{|q| B}$.\nFrom this expression, we can analyze the scaling of $r_L$:\n-   **Scaling with mass ($m$):** $r_L \\propto m$. The gyroradius is directly proportional to the particle's mass. A more massive particle has greater inertia, making it more resistant to the bending effect of the magnetic force, thus resulting in a larger orbit for the same velocity and field.\n-   **Scaling with charge magnitude ($|q|$):** $r_L \\propto \\frac{1}{|q|}$. The gyroradius is inversely proportional to the magnitude of the particle's charge. A larger charge leads to a stronger Lorentz force ($F_{\\perp} \\propto |q|$), which curves the particle's path more sharply, resulting in a smaller gyroradius.\n-   **Scaling with magnetic field strength ($B$):** $r_L \\propto \\frac{1}{B}$. The gyroradius is inversely proportional to the magnetic field strength. A stronger magnetic field also increases the Lorentz force ($F_{\\perp} \\propto B$), leading to tighter confinement and a smaller gyroradius.\n\nThe **cyclotron frequency**, $\\omega_c$, is the angular frequency of the particle's gyration. For uniform circular motion, the tangential velocity $v_{\\perp}$ is related to the angular frequency $\\omega_c$ and radius $r_L$ by $v_{\\perp} = \\omega_c r_L$.\nWe can substitute this into our gyroradius equation:\n$$r_L = \\frac{m (\\omega_c r_L)}{|q| B}$$\nCanceling $r_L$ from both sides (since $r_L \\neq 0$), we can solve for $\\omega_c$:\n$$\\omega_c = \\frac{|q| B}{m}$$\nThis is the cyclotron (or gyro-) frequency. A key result of nonrelativistic theory is that $\\omega_c$ is independent of the particle's velocity $v_{\\perp}$ and its energy.\nWe can now express the gyroradius in terms of the cyclotron frequency by rearranging the above relation:\n$$r_L = \\frac{v_{\\perp}}{\\omega_c}$$\nThis relationship provides a clear physical picture: the size of the orbit ($r_L$) is determined by how far the particle travels at speed $v_{\\perp}$ during one characteristic radian of its rotation (which happens in a time $1/\\omega_c$). A higher cyclotron frequency (from a stronger field $B$, larger charge $|q|$, or smaller mass $m$) means the particle gyrates faster, completing its circular path in a shorter time, which for a given speed $v_{\\perp}$ corresponds to a smaller radius. This elegantly connects the concepts of gyroradius, particle properties, field strength, and the fundamental frequency of motion.",
            "answer": "$$\n\\boxed{4.350 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "Moving from single particles to a fluid or kinetic description of a plasma requires averaging quantities over the fast gyromotion. This practice provides a hands-on guide to constructing and verifying these fundamental gyroaveraging operators, connecting their integral definitions to exact analytical forms involving Bessel functions like $J_0$ and $I_0$. By implementing numerical quadratures and comparing them to exact solutions, you will build confidence in these mathematical tools and test the accuracy of practical Padé approximations that are essential in modern gyrofluid and gyrokinetic codes .",
            "id": "3980348",
            "problem": "You are tasked with constructing a verification and analytic test suite for finite Larmor radius (FLR) corrections using the gyroaveraging framework. All quantities must be treated within a two-dimensional plane perpendicular to a uniform magnetic field, and all angles must be in radians. Physical units must be adhered to explicitly where appropriate.\n\nDefine the ring-average (gyroaverage at fixed Larmor radius) of a scalar field $f(\\boldsymbol{r})$ with respect to a fixed Larmor radius $\\rho$ as\n$$\n\\mathcal{G}_{\\rho}[f](\\boldsymbol{r}) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f\\!\\left(\\boldsymbol{r} + \\rho\\,\\big(\\hat{\\boldsymbol{e}}_{x}\\cos\\theta + \\hat{\\boldsymbol{e}}_{y}\\sin\\theta\\big)\\right)\\,\\mathrm{d}\\theta,\n$$\nwhere $\\hat{\\boldsymbol{e}}_{x}$ and $\\hat{\\boldsymbol{e}}_{y}$ are unit vectors in the perpendicular plane. Consider the plane wave\n$$\nf_{\\boldsymbol{k}}(\\boldsymbol{r}) = \\exp\\!\\big(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{r}\\big),\n$$\nwith perpendicular wavevector $\\boldsymbol{k} = k_{x}\\,\\hat{\\boldsymbol{e}}_{x} + k_{y}\\,\\hat{\\boldsymbol{e}}_{y}$ and perpendicular magnitude $k_{\\perp} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$, measured in $\\mathrm{m}^{-1}$, while positions and radii are in $\\mathrm{m}$.\n\nAdditionally, define the Maxwellian-weighted FLR factor (commonly used in gyrofluid closures for polarization) for a given thermal Larmor radius $\\rho_{\\mathrm{th}}$ (in $\\mathrm{m}$) as\n$$\n\\Gamma_{0}(b) = \\int_{0}^{\\infty} p(\\rho)\\,J_{0}^{2}\\!\\big(k_{\\perp}\\rho\\big)\\,\\mathrm{d}\\rho,\n$$\nwhere $J_{0}$ is the Bessel function of the first kind of order zero, $b = k_{\\perp}^{2}\\rho_{\\mathrm{th}}^{2}$ is dimensionless, and $p(\\rho)$ is the normalized perpendicular Maxwellian distribution of the Larmor radius magnitude,\n$$\np(\\rho) = \\frac{\\rho}{\\rho_{\\mathrm{th}}^{2}}\\,\\exp\\!\\left(-\\frac{\\rho^{2}}{2\\rho_{\\mathrm{th}}^{2}}\\right).\n$$\nThe normalization condition is $\\int_{0}^{\\infty} p(\\rho)\\,\\mathrm{d}\\rho = 1$.\n\nStarting only from these definitions and fundamental facts about integrals and special functions, your program must:\n- Compute the ring-average of the plane wave $f_{\\boldsymbol{k}}(\\boldsymbol{r})$ numerically by direct quadrature of the angle integral for specified parameters and compare it to the analytic prediction derived from first principles. Because $f_{\\boldsymbol{k}}(\\boldsymbol{r})$ appears as a multiplicative factor, it is sufficient to compare the dimensionless amplitude ratio $\\mathcal{A}(k_{\\perp}\\rho)$ defined by\n$$\n\\mathcal{A}(k_{\\perp}\\rho) \\equiv \\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\exp\\!\\big(i\\,k_{\\perp}\\rho\\cos\\theta\\big)\\,\\mathrm{d}\\theta,\n$$\nagainst its analytic counterpart implied by the ring-average definition.\n- Compute $\\Gamma_{0}(b)$ numerically by direct quadrature of the $\\rho$ integral for specified parameters and compare to the analytic expression implied by first principles (do not assume any shortcuts).\n- Evaluate two widely used Padé approximations for $\\Gamma_{0}(b)$ and report their relative errors compared to the analytic expression:\n  1. First Padé: $\\Gamma_{0}^{(1)}(b) = \\dfrac{1}{1 + b}$.\n  2. Second Padé: $\\Gamma_{0}^{(2)}(b) = \\dfrac{1}{1 + b + \\dfrac{b^{2}}{2}}$.\n\nAll comparisons must be performed with clearly stated numerical tolerances, and all outputs must be dimensionless. Use the following test suite with parameters in specified units:\n\n- Ring-average tests (angles in radians; lengths in meters; wavenumbers in $\\mathrm{m}^{-1}$):\n  1. $k_{\\perp} = 0.0$, $\\rho = 1.0$.\n  2. $k_{\\perp} = 5.0$, $\\rho = 0.1$.\n  3. $k_{\\perp} = 50.0$, $\\rho = 0.1$.\n  4. $k_{\\perp} = 200.0$, $\\rho = 0.25$.\n  Use an absolute tolerance of $10^{-9}$ on the amplitude ratio.\n\n- Maxwellian-weighted $\\Gamma_{0}$ tests (lengths in meters; wavenumbers in $\\mathrm{m}^{-1}$):\n  1. $k_{\\perp} = 0.0$, $\\rho_{\\mathrm{th}} = 1.0$ (boundary case).\n  2. $k_{\\perp} = 1.0$, $\\rho_{\\mathrm{th}} = 1.0$.\n  3. $k_{\\perp} = 5.0$, $\\rho_{\\mathrm{th}} = 1.0$.\n  4. $k_{\\perp} = \\sqrt{50}$, $\\rho_{\\mathrm{th}} = 1.0$.\n  Use an absolute tolerance of $10^{-8}$.\n\n- Padé approximation error tests (dimensionless $b$ values):\n  Evaluate relative errors $\\left|\\dfrac{\\Gamma_{0}^{(\\cdot)}(b) - \\Gamma_{0}(b)}{\\Gamma_{0}(b)}\\right|$ for $b \\in \\{10^{-6},\\,0.1,\\,1.0,\\,10.0,\\,50.0\\}$ for both Padé approximations above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as follows:\n- First, four boolean values for the ring-average tests in the order given.\n- Next, four boolean values for the Maxwellian-weighted $\\Gamma_{0}$ tests in the order given.\n- Finally, ten floating-point values: the five relative errors for the first Padé approximation for the $b$ values in ascending order, followed by the five relative errors for the second Padé approximation for the same $b$ values in ascending order.\n\nExample format (values shown are placeholders): \"[True,True,False,True,True,True,True,True,1e-6,0.01,0.1,0.2,0.3,5e-7,0.02,0.08,0.15,0.25]\".",
            "solution": "The problem requires the construction of a verification suite for two fundamental operations in the theory of finite Larmor radius (FLR) corrections in plasma physics: the ring-average (gyroaverage) and the Maxwellian-weighted FLR factor, $\\Gamma_0$. The process involves deriving the exact analytic expressions for these operations under specific conditions and then developing a numerical program to verify these analytic results and evaluate the accuracy of common approximations.\n\n### Problem Validation\n\nThe provided problem statement has been validated and is deemed sound.\n\n1.  **Givens Extraction**: All definitions, parameters, and test cases have been precisely defined.\n    - The ring-average $\\mathcal{G}_{\\rho}[f](\\boldsymbol{r})$ is given by $\\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\boldsymbol{r} + \\boldsymbol{\\rho}(\\theta))\\,\\mathrm{d}\\theta$.\n    - The plane wave is $f_{\\boldsymbol{k}}(\\boldsymbol{r}) = \\exp(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{r})$.\n    - The Maxwellian-weighted factor $\\Gamma_0(b)$ is $\\int_{0}^{\\infty} p(\\rho)\\,J_{0}^{2}(k_{\\perp}\\rho)\\,\\mathrm{d}\\rho$, with $p(\\rho) = \\frac{\\rho}{\\rho_{\\mathrm{th}}^{2}}\\,\\exp(-\\frac{\\rho^{2}}{2\\rho_{\\mathrm{th}}^{2}})$ and $b = k_{\\perp}^{2}\\rho_{\\mathrm{th}}^{2}$.\n    - Two Padé approximations, $\\Gamma_0^{(1)}(b)$ and $\\Gamma_0^{(2)}(b)$, are defined.\n    - Specific test suites for numerical verification and error analysis are provided with explicit parameters and tolerances.\n2.  **Validation Verdict**: The problem is scientifically grounded in plasma physics, mathematically well-posed, objective, and self-contained. The requested derivations are based on standard integral representations of special functions. The numerical tasks are well-defined and computationally feasible. The problem is therefore valid.\n\n### Analytical Derivations\n\nThe core of this task lies in deriving the analytic expressions for the two integral operations, which will serve as the benchmark for numerical verification.\n\n#### 1. Analysis of the Ring-Average Amplitude $\\mathcal{A}(k_{\\perp}\\rho)$\n\nThe ring-average of the plane wave $f_{\\boldsymbol{k}}(\\boldsymbol{r}) = \\exp(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{r})$ is:\n$$\n\\mathcal{G}_{\\rho}[f_{\\boldsymbol{k}}](\\boldsymbol{r}) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\left[i\\,\\boldsymbol{k}\\cdot\\left(\\boldsymbol{r} + \\rho\\,\\big(\\hat{\\boldsymbol{e}}_{x}\\cos\\theta + \\hat{\\boldsymbol{e}}_{y}\\sin\\theta\\big)\\right)\\right]\\,\\mathrm{d}\\theta\n$$\nThe exponential term can be factored:\n$$\n\\mathcal{G}_{\\rho}[f_{\\boldsymbol{k}}](\\boldsymbol{r}) = \\exp(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{r}) \\cdot \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\left[i\\,\\rho\\,\\boldsymbol{k}\\cdot\\big(\\hat{\\boldsymbol{e}}_{x}\\cos\\theta + \\hat{\\boldsymbol{e}}_{y}\\sin\\theta\\big)\\right]\\,\\mathrm{d}\\theta\n$$\nThe operation of the ring-average on a plane wave thus amounts to multiplying the plane wave by a complex scalar. Let us analyze the integral factor. The dot product in the exponent is $\\boldsymbol{k}\\cdot(\\hat{\\boldsymbol{e}}_{x}\\cos\\theta + \\hat{\\boldsymbol{e}}_{y}\\sin\\theta) = k_x \\cos\\theta + k_y \\sin\\theta$. We can express the wavevector components in polar coordinates as $k_x = k_{\\perp}\\cos\\phi$ and $k_y = k_{\\perp}\\sin\\phi$, where $k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$ and $\\phi$ is the angle of $\\boldsymbol{k}$ with respect to $\\hat{\\boldsymbol{e}}_{x}$. The expression becomes:\n$$\nk_{\\perp}\\cos\\phi\\cos\\theta + k_{\\perp}\\sin\\phi\\sin\\theta = k_{\\perp}\\cos(\\theta - \\phi)\n$$\nThe integral is now:\n$$\n\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\big(i\\,k_{\\perp}\\rho\\cos(\\theta - \\phi)\\big)\\,\\mathrm{d}\\theta\n$$\nSince the integrand is $2\\pi$-periodic, we can shift the integration variable by $\\phi$ (i.e., let $\\theta' = \\theta - \\phi$) without changing the value of the integral. This yields the dimensionless amplitude ratio $\\mathcal{A}(k_{\\perp}\\rho)$ defined in the problem statement, showing its independence from the direction of $\\boldsymbol{k}$:\n$$\n\\mathcal{A}(k_{\\perp}\\rho) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp\\!\\big(i\\,k_{\\perp}\\rho\\cos\\theta'\\big)\\,\\mathrm{d}\\theta'\n$$\nThis is a standard integral representation of the Bessel function of the first kind of order zero, $J_0(z)$:\n$$\nJ_n(z) = \\frac{1}{2\\pi i^n}\\int_{0}^{2\\pi} e^{i z \\cos\\theta} \\cos(n\\theta)\\,\\mathrm{d}\\theta\n$$\nFor $n=0$, this simplifies to:\n$$\nJ_0(z) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} e^{i z \\cos\\theta}\\,\\mathrm{d}\\theta\n$$\nTherefore, the exact analytic expression for the amplitude ratio is:\n$$\n\\mathcal{A}(k_{\\perp}\\rho) = J_0(k_{\\perp}\\rho)\n$$\nThe numerical verification will compare the direct quadrature of the integral defining $\\mathcal{A}(k_{\\perp}\\rho)$ against the value of $J_0(k_{\\perp}\\rho)$ obtained from a standard scientific library. Since the imaginary part of the integral of $\\exp(iz\\cos\\theta)$ over $[0, 2\\pi]$ is zero (due to symmetry), the comparison is between two real numbers.\n\n#### 2. Analysis of the Maxwellian-Weighted FLR Factor $\\Gamma_0(b)$\n\nThe factor $\\Gamma_0(b)$ is defined by the integral:\n$$\n\\Gamma_{0}(b) = \\int_{0}^{\\infty} p(\\rho)\\,J_{0}^{2}\\!\\big(k_{\\perp}\\rho\\big)\\,\\mathrm{d}\\rho = \\int_{0}^{\\infty} \\frac{\\rho}{\\rho_{\\mathrm{th}}^{2}}\\,\\exp\\!\\left(-\\frac{\\rho^{2}}{2\\rho_{\\mathrm{th}}^{2}}\\right)\\,J_{0}^{2}\\!\\big(k_{\\perp}\\rho\\big)\\,\\mathrm{d}\\rho\n$$\nTo evaluate this integral, we use a standard result from the theory of Bessel functions, such as formula 6.633.2 from Gradshteyn and Ryzhik:\n$$\n\\int_0^\\infty x e^{-a^2 x^2} J_\\nu(cx) J_\\nu(dx) dx = \\frac{1}{2a^2} \\exp\\left(-\\frac{c^2+d^2}{4a^2}\\right) I_\\nu\\left(\\frac{cd}{2a^2}\\right)\n$$\nwhere $I_\\nu$ is the modified Bessel function of the first kind.\nTo match our integral to this form, we let $x=\\rho$, $\\nu=0$, $c=d=k_{\\perp}$, and $a^2 = 1/(2\\rho_{\\mathrm{th}}^2)$. This gives $a = 1/(\\sqrt{2}\\rho_{\\mathrm{th}})$.\nOur integral requires a prefactor of $1/\\rho_{\\mathrm{th}}^2$. Let's apply the formula to the core integral part, $\\int_0^\\infty \\rho \\exp(-\\rho^2 / (2\\rho_{\\mathrm{th}}^2)) J_0^2(k_{\\perp}\\rho) d\\rho$:\n$$\n\\frac{1}{2(1/(2\\rho_{\\mathrm{th}}^2))} \\exp\\left(-\\frac{k_{\\perp}^2+k_{\\perp}^2}{4(1/(2\\rho_{\\mathrm{th}}^2))}\\right) I_0\\left(\\frac{k_{\\perp}^2}{2(1/(2\\rho_{\\mathrm{th}}^2))}\\right) = \\rho_{\\mathrm{th}}^2 \\exp\\left(-\\frac{2k_{\\perp}^2}{2/\\rho_{\\mathrm{th}}^2}\\right) I_0\\left(\\frac{k_{\\perp}^2}{1/\\rho_{\\mathrm{th}}^2}\\right)\n$$\nSimplifying the exponents and arguments:\n$$\n= \\rho_{\\mathrm{th}}^2 \\exp(-k_{\\perp}^2 \\rho_{\\mathrm{th}}^2) I_0(k_{\\perp}^2 \\rho_{\\mathrm{th}}^2)\n$$\nNow, we reintroduce the $1/\\rho_{\\mathrm{th}}^2$ prefactor from the definition of $\\Gamma_0(b)$:\n$$\n\\Gamma_0(b) = \\frac{1}{\\rho_{\\mathrm{th}}^2} \\left[ \\rho_{\\mathrm{th}}^2 \\exp(-k_{\\perp}^2 \\rho_{\\mathrm{th}}^2) I_0(k_{\\perp}^2 \\rho_{\\mathrm{th}}^2) \\right]\n$$\nUsing the definition $b = k_{\\perp}^2 \\rho_{\\mathrm{th}}^2$, we arrive at the compact analytic expression:\n$$\n\\Gamma_0(b) = e^{-b}I_0(b)\n$$\nThis exact result will be used as the benchmark for the numerical evaluation of the integral for $\\Gamma_0(b)$ and for assessing the error of the Padé approximations. For numerical stability, this is often computed using a function that provides $e^{-x}I_0(x)$ directly.\n\n### Numerical Implementation Plan\n\nThe solution requires a Python program to perform the following tasks:\n1.  **Ring-Average Verification**: A function will compute $\\mathcal{A}(k_{\\perp}\\rho)$ by numerical quadrature of its defining integral. The result will be compared to the analytic value $J_0(k_{\\perp}\\rho)$ for each test case using the specified absolute tolerance of $10^{-9}$. `scipy.integrate.quad` will be used for the integration and `scipy.special.j0` for the Bessel function.\n2.  **$\\Gamma_0$ Verification**: A function will compute $\\Gamma_0(b)$ by numerical quadrature of its defining integral over $[0, \\infty)$. The integrand involves the Maxwellian distribution $p(\\rho)$ and the square of the Bessel function $J_0(k_{\\perp}\\rho)$. The result will be compared to the analytic value $e^{-b}I_0(b)$ for each test case, using the specified absolute tolerance of $10^{-8}$. `scipy.integrate.quad` will handle the semi-infinite integral, and `scipy.special.i0e` (which computes $e^{-x}I_0(x)$) will provide the analytic benchmark.\n3.  **Padé Approximation Error**: For a given set of $b$ values, the program will calculate the two Padé approximations, $\\Gamma_0^{(1)}(b) = \\frac{1}{1+b}$ and $\\Gamma_0^{(2)}(b) = \\frac{1}{1+b+b^2/2}$. It will then compute their relative errors with respect to the analytic value of $\\Gamma_0(b)$.\n4.  **Output Formatting**: All results (four booleans from ring-average tests, four booleans from $\\Gamma_0$ tests, and ten floating-point relative errors from the Padé tests) will be collected into a single list and printed in the specified comma-separated format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import j0, i0e\n\ndef solve():\n    \"\"\"\n    Constructs a verification and analytic test suite for finite Larmor radius \n    (FLR) corrections using the gyroaveraging framework.\n    \"\"\"\n\n    # --- Test Cases from the problem statement ---\n    ring_average_tests = [\n        # (k_perp, rho)\n        (0.0, 1.0),\n        (5.0, 0.1),\n        (50.0, 0.1),\n        (200.0, 0.25),\n    ]\n    ring_average_tol = 1e-9\n\n    gamma0_tests = [\n        # (k_perp, rho_th)\n        (0.0, 1.0),\n        (1.0, 1.0),\n        (5.0, 1.0),\n        (np.sqrt(50), 1.0),\n    ]\n    gamma0_tol = 1e-8\n\n    pade_error_b_values = [1e-6, 0.1, 1.0, 10.0, 50.0]\n\n    results = []\n\n    # --- Part 1: Ring-average tests ---\n    def ring_avg_integrand(theta, k_perp, rho):\n        return np.exp(1j * k_perp * rho * np.cos(theta))\n\n    for k_perp, rho in ring_average_tests:\n        # Numerical calculation via quadrature\n        # quad returns a tuple (result, error_estimate)\n        # We only need the real part as the imaginary part integrates to zero.\n        numerical_A_complex, _ = quad(ring_avg_integrand, 0, 2 * np.pi, args=(k_perp, rho))\n        numerical_A = numerical_A_complex.real / (2 * np.pi)\n\n        # Analytic result\n        analytic_A = j0(k_perp * rho)\n\n        # Comparison\n        is_close = np.isclose(numerical_A, analytic_A, atol=ring_average_tol, rtol=0)\n        results.append(is_close)\n\n    # --- Part 2: Maxwellian-weighted Gamma_0 tests ---\n    def gamma0_integrand(rho, k_perp, rho_th):\n        p_rho = (rho / rho_th**2) * np.exp(-(rho**2) / (2 * rho_th**2))\n        j0_term = j0(k_perp * rho)\n        return p_rho * j0_term**2\n\n    for k_perp, rho_th in gamma0_tests:\n        # Numerical calculation via quadrature\n        # The integral is over [0, inf)\n        numerical_G0, _ = quad(gamma0_integrand, 0, np.inf, args=(k_perp, rho_th))\n\n        # Analytic result\n        b = k_perp**2 * rho_th**2\n        # i0e(x) computes exp(-x) * I_0(x), which is exactly Gamma_0(b)\n        analytic_G0 = i0e(b)\n\n        # Comparison\n        is_close = np.isclose(numerical_G0, analytic_G0, atol=gamma0_tol, rtol=0)\n        results.append(is_close)\n        \n    # --- Part 3: Padé approximation error tests ---\n    pade1_errors = []\n    pade2_errors = []\n\n    for b in pade_error_b_values:\n        # Analytic Gamma_0(b)\n        analytic_G0 = i0e(b)\n\n        # First Padé approximation\n        gamma0_pade1 = 1.0 / (1.0 + b)\n        err1 = np.abs((gamma0_pade1 - analytic_G0) / analytic_G0) if analytic_G0 != 0 else 0\n        pade1_errors.append(err1)\n\n        # Second Padé approximation\n        gamma0_pade2 = 1.0 / (1.0 + b + b**2 / 2.0)\n        err2 = np.abs((gamma0_pade2 - analytic_G0) / analytic_G0) if analytic_G0 != 0 else 0\n        pade2_errors.append(err2)\n\n    results.extend(pade1_errors)\n    results.extend(pade2_errors)\n\n    # Final print statement in the exact required format.\n    # The format 'g' provides a general-purpose representation.\n    formatted_results = [f\"{r}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With the mathematical tools for FLR corrections established, this final practice applies them to a tangible problem in fusion research: the turbulent transport driven by plasma filaments, or \"blobs,\" in the cooler edge region. This problem demonstrates how FLR effects modify the plasma's inertial response, which in turn alters the propagation speed of these important structures. By deriving and calculating a velocity correction factor using the Padé approximation for the gyroaveraging operator $\\Gamma_0(b)$, you will see directly how FLR models yield more accurate predictions for turbulent transport than simpler drift-ordered theories .",
            "id": "4200222",
            "problem": "Consider a two-dimensional slab model of the edge region of a magnetized fusion plasma, with Cartesian coordinates $(x,y)$ across and along the curvature drift direction, respectively, and a uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$. A coherent filament (\"blob\") of characteristic perpendicular wavenumber $k_{\\perp}$ and density perturbation amplitude $\\delta n$ moves radially due to the Electric cross Magnetic ($E\\times B$) drift generated by an electrostatic potential $\\phi(x,y,t)$. Assume isothermal electrons and ions with equal temperatures, $T_e = T_i$, and define the ion sound Larmor radius $\\rho_s = c_s/\\Omega_i$, where $c_s = \\sqrt{T_e/m_i}$ and $\\Omega_i = eB/m_i$. The electron response is adiabatic along the magnetic field, so that the normalized electron density perturbation satisfies $\\tilde{n}_e \\equiv \\delta n_e/n_0 \\approx \\tilde{\\phi} \\equiv e \\phi/T_e$. \n\nTo describe finite ion Larmor radius effects at perpendicular scale $k_{\\perp}$, use a standard gyrofluid quasi-neutrality closure in Fourier space with the zeroth-order gyroaveraging operator $\\Gamma_0(b)$, where $b \\equiv k_{\\perp}^{2}\\rho_s^{2}$. For a single-$k_{\\perp}$ perturbation, the quasi-neutrality condition yields\n$$\n\\tilde{n}_e - \\tilde{n}_i = \\left(1 - \\Gamma_0(b)\\right)\\tilde{\\phi} \\, ,\n$$\nwhich implies $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$ when $\\tilde{n}_e = \\tilde{\\phi}$ holds.\n\nIn the drift-ordering limit $k_{\\perp}\\rho_s \\ll 1$, a baseline inertial blob speed scaling $V_0$ follows from $E\\times B$ advection by $\\phi_0$ determined under $\\Gamma_0(b) \\to 1$. Now test the sensitivity of this blob speed scaling to the breakdown of drift ordering by estimating the correction when $k_{\\perp}\\rho_s \\sim 0.5$. Specifically:\n\n- Starting from the above quasi-neutrality and the $E\\times B$ drift velocity magnitude $V \\sim (c/B) k_{\\perp}\\phi$, derive the multiplicative correction factor $F(b)$ such that $V = F(b) V_0$, expressed in terms of $b$.\n- To make $F(b)$ explicit, use the widely employed Padé approximation for the gyroaveraging operator, $\\Gamma_0(b) \\approx \\frac{1}{1+b}$.\n- Evaluate $F(b)$ at $b = (0.5)^2$.\n\nIn addition, identify (qualitatively, without calculation) which terms that are neglected under drift ordering become non-negligible as $k_{\\perp}\\rho_s$ approaches $0.5$ in the drift-reduced Braginskii fluid equations, focusing on the vorticity (polarization) and continuity dynamics.\n\nGive the multiplicative correction factor $F(b)$ evaluated at $b = (0.5)^2$ as a single dimensionless number. No rounding is required; provide the exact value. Do not include any units in your final numerical answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of plasma physics, specifically the theory of drift-wave turbulence and transport in magnetized plasmas. It is well-posed, objective, and internally consistent, providing all necessary relations and approximations to derive a unique solution. The model and parameters, including the gyrofluid closure and Padé approximation, are standard in the field of fusion plasma simulation.\n\nThe primary objective is to find a multiplicative correction factor, $F(b)$, for the blob velocity scaling, accounting for finite Larmor radius (FLR) effects beyond the strict drift-ordering limit. The blob velocity, $V$, is driven by the $\\mathbf{E} \\times \\mathbf{B}$ drift, with a magnitude scaling as $V \\sim (c/B) k_{\\perp}\\phi$. The potential $\\phi$ is determined by the plasma dynamics, specifically the balance between charge-separating source terms and the inertial response of the plasma, which is described by the vorticity equation.\n\nThe vorticity equation is fundamentally derived from the quasi-neutrality condition, or more precisely, the charge conservation law $\\nabla \\cdot \\mathbf{J} = 0$. The polarization current, $\\mathbf{J}_{pol}$, represents the inertial response of the ions to a time-varying electric field. Its divergence is given by the rate of change of the charge density associated with the polarization of the medium. From charge conservation, this is related to the ion density evolution: $\\nabla \\cdot \\mathbf{J}_{pol} = -e \\frac{\\partial(\\delta n_i)}{\\partial t}$.\n\nUsing normalized quantities and the given gyrofluid relation for the ion density perturbation, $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$, we can write the ion density perturbation as $\\delta n_i = n_0 \\tilde{n}_i = n_0 \\Gamma_0(b) \\tilde{\\phi}$. Here, $b = k_{\\perp}^2 \\rho_s^2$ is the normalized squared perpendicular wavenumber. The divergence of the polarization current is then:\n$$\n\\nabla \\cdot \\mathbf{J}_{pol} = -e n_0 \\frac{\\partial}{\\partial t} \\left( \\Gamma_0(b) \\tilde{\\phi} \\right)\n$$\nAssuming a wave-like perturbation with time dependence $\\partial/\\partial t \\rightarrow -i\\omega$, and associating the blob's radial propagation with this frequency via $\\omega \\sim k_x V$, we get a scaling for the polarization response. However, a more direct scaling argument is sufficient. The vorticity (or polarization) part of the dynamic equation that determines $\\phi$ is proportional to the ion density response to the potential. The problem states that the ion density response is $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$. The actual charge separation that drives the polarization current is given by $\\tilde{n}_i - \\tilde{n}_e = (\\Gamma_0(b)-1)\\tilde{\\phi}$. The dynamics balance a source term (e.g., from curvature drifts, assumed constant for this scaling) against this polarization response. In a steady propagation picture, this balance yields a scaling for the velocity $V$:\n$$\nV \\propto \\frac{\\text{Source Term}}{\\text{Inertial Response}} \\propto \\frac{1}{|\\Gamma_0(b) - 1|}\n$$\nThe problem defines a baseline speed $V_0$ in the drift-ordering limit, $k_{\\perp}\\rho_s \\ll 1$, which corresponds to $b \\ll 1$. In this limit, the gyroaveraging operator $\\Gamma_0(b)$ can be expanded. A standard expansion for $\\Gamma_0(b)$ is $\\Gamma_0(b) \\approx 1 - b + \\mathcal{O}(b^2)$. Therefore, in the small-$b$ limit, the denominator becomes $|\\Gamma_0(b) - 1| \\approx |(1-b)-1| = b$.\nThe baseline velocity scaling is thus:\n$$\nV_0 \\propto \\frac{1}{b}\n$$\nThe velocity scaling including FLR effects is:\n$$\nV \\propto \\frac{1}{1 - \\Gamma_0(b)}\n$$\nNote that since $\\Gamma_0(b) \\le 1$, we can write $1 - \\Gamma_0(b)$ without the absolute value. The multiplicative correction factor $F(b) = V/V_0$ is the ratio of these scalings:\n$$\nF(b) = \\frac{V}{V_0} = \\frac{1/(1-\\Gamma_0(b))}{1/b} = \\frac{b}{1-\\Gamma_0(b)}\n$$\nThe problem specifies using the Padé approximation for the gyroaveraging operator:\n$$\n\\Gamma_0(b) \\approx \\frac{1}{1+b}\n$$\nSubstituting this approximation into the expression for $F(b)$:\n$$\nF(b) = \\frac{b}{1 - \\frac{1}{1+b}} = \\frac{b}{\\frac{(1+b) - 1}{1+b}} = \\frac{b}{\\frac{b}{1+b}} = 1+b\n$$\nSo the correction factor is simply $F(b) = 1+b$. We are asked to evaluate this factor at $k_{\\perp}\\rho_s = 0.5$. First, we calculate the corresponding value of $b$:\n$$\nb = (k_{\\perp}\\rho_s)^2 = (0.5)^2 = 0.25\n$$\nNow we evaluate $F(b)$ at this value:\n$$\nF(0.25) = 1 + 0.25 = 1.25\n$$\nThis indicates that for $k_{\\perp}\\rho_s = 0.5$, the blob speed is $25\\%$ larger than the prediction from the simple drift-ordered model. This enhancement is a consequence of FLR effects reducing the effective inertia of the ions.\n\nFor the second part of the question, we identify terms neglected under drift ordering ($k_{\\perp}\\rho_s \\ll 1$) that become non-negligible as $k_{\\perp}\\rho_s$ approaches $0.5$ in the drift-reduced Braginskii fluid equations.\n\nIn **vorticity/polarization dynamics**, the primary neglected terms are higher-order Finite Larmor Radius (FLR) corrections. The standard drift-fluid polarization term, proportional to $\\frac{d}{dt}\\nabla_{\\perp}^2\\phi$, is an approximation of the full ion polarization response valid only for long wavelengths. As $k_{\\perp}\\rho_s$ increases, this approximation fails. The gyrofluid model used in the first part of this problem replaces this term with a more accurate form based on $\\Gamma_0(b)$, but a full fluid model would need to include higher-order derivative terms. Furthermore, the **ion gyro-viscous stress tensor**, which is responsible for momentum transport, contains FLR terms of higher order in $(k_{\\perp}\\rho_s)^2$ that are typically omitted. These terms act as a form of hyper-viscosity, damping small-scale structures, and are crucial for correctly describing the dynamics at the scales where $k_{\\perp}\\rho_s \\sim 0.5$.\n\nIn **continuity dynamics**, the primary advection of density is by the $\\mathbf{E}\\times\\mathbf{B}$ drift, $\\mathbf{v}_E$. In drift-ordering, it is assumed that ions and electrons are advected by the same fluid velocity $\\mathbf{v}_E$. However, ions have finite Larmor radii and thus experience a gyro-averaged electric field. The true ion advecting velocity is the gyro-averaged $\\mathbf{E}\\times\\mathbf{B}$ velocity, $\\langle \\mathbf{v}_E \\rangle_{gyro}$, not the local value $\\mathbf{v}_E$. The difference, $\\langle \\mathbf{v}_E \\rangle_{gyro} - \\mathbf{v}_E$, constitutes an FLR correction to the advection term in the continuity equation (e.g., in $\\nabla \\cdot (n_i \\mathbf{v}_i)$) that becomes significant as $k_{\\perp}\\rho_s \\to 0.5$. Similarly, the ion diamagnetic drift also acquires FLR corrections that are neglected in the basic drift-ordered model.",
            "answer": "$$\\boxed{1.25}$$"
        }
    ]
}