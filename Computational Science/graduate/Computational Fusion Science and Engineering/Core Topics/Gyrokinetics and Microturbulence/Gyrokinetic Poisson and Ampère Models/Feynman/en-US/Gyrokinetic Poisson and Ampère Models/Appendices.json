{
    "hands_on_practices": [
        {
            "introduction": "Gyrokinetic models are built upon a series of systematic orderings that simplify the full Vlasov-Maxwell system for low-frequency phenomena. A cornerstone of the electromagnetic model is the frequent neglect of the displacement current in Ampère's law, leading to a magnetostatic approximation. This exercise  provides a first-principles derivation to quantify the magnitude of the displacement current relative to the parallel conduction current, revealing the conditions under which this important simplification is justified.",
            "id": "3988909",
            "problem": "A homogeneous, magnetized, quasi-neutral plasma with uniform equilibrium magnetic field $\\mathbf{B}_0$ is described by the low-frequency gyrokinetic ordering, where the characteristic fluctuation frequency satisfies $\\omega \\ll \\Omega_i$, the ion gyrofrequency. Consider a single, linear, plane-wave perturbation with parallel electric field $E_{\\parallel}(t) = \\text{Re}\\{E_0 \\exp(-\\mathrm{i}\\,\\omega t)\\}$ and negligible collisions. Assume that:\n- ions provide negligible contribution to the parallel conduction current at the fluctuation timescale,\n- the electron contribution to the parallel conduction current dominates and can be modeled by the cold-electron parallel momentum equation (neglecting electron pressure gradient and collisions),\n- the system is in the International System of Units, and the displacement current is the term $\\varepsilon_0\\,\\partial_t E_{\\parallel}$ in the Maxwell–Ampère law.\n\nStarting from the Maxwell–Ampère law and the cold-electron parallel momentum equation, and using only fundamental constants and definitions, derive an analytic estimate for the ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\left|\\varepsilon_0\\,\\partial_t E_{\\parallel}\\right|}{\\left|J_{\\parallel}\\right|},\n$$\nexpressed solely in terms of $\\omega$ and the electron plasma frequency $\\omega_{pe}$.\n\nYou must state clearly any intermediate relations you use and the assumptions that justify them under the gyrokinetic ordering. Provide your final answer as a single closed-form expression in terms of $\\omega$ and $\\omega_{pe}$. No numerical evaluation is required, and no units should be included in the final expression. The answer must be a single expression, not an inequality or an equation.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The derivation proceeds directly from the provided physical laws and definitions.\n\nThe objective is to compute the ratio $\\mathcal{R} \\equiv \\frac{\\left|\\varepsilon_0\\,\\partial_t E_{\\parallel}\\right|}{\\left|J_{\\parallel}\\right|}$, where the numerator represents the magnitude of the parallel component of the displacement current density and the denominator represents the magnitude of the parallel component of the conduction current density. We are considering a single, linear, plane-wave perturbation with harmonic time dependence, so any perturbed quantity $Q(t)$ can be represented as $Q(t) = \\text{Re}\\{Q_0 \\exp(-\\mathrm{i}\\,\\omega t)\\}$. In complex notation, this implies the time derivative operator can be replaced as $\\frac{\\partial}{\\partial t} \\to -\\mathrm{i}\\,\\omega$.\n\nFirst, we evaluate the numerator, which is the magnitude of the parallel displacement current density term, $\\varepsilon_0\\,\\partial_t E_{\\parallel}$. Applying the harmonic time dependence substitution:\n$$\n\\varepsilon_0 \\frac{\\partial E_{\\parallel}}{\\partial t} = \\varepsilon_0 (-\\mathrm{i}\\,\\omega E_{\\parallel}) = -\\mathrm{i}\\,\\omega \\varepsilon_0 E_{\\parallel}\n$$\nThe magnitude is therefore:\n$$\n\\left|\\varepsilon_0\\,\\partial_t E_{\\parallel}\\right| = |-\\mathrm{i}\\,\\omega \\varepsilon_0 E_{\\parallel}| = \\omega \\varepsilon_0 |E_{\\parallel}|\n$$\n\nNext, we evaluate the denominator, which is the magnitude of the parallel conduction current density, $|J_{\\parallel}|$. The problem states that the ion contribution is negligible, thus the parallel current is dominated by the electron contribution, $J_{\\parallel} \\approx J_{e\\parallel}$. The electron current density is defined as $J_{e\\parallel} = -n_e e v_{e\\parallel}$, where $-e$ is the electron charge, $n_e$ is the electron number density, and $v_{e\\parallel}$ is the parallel electron fluid velocity. In the context of a linear perturbation about a static, uniform equilibrium with density $n_0$, we have:\n$$\nJ_{\\parallel} = -n_0 e v_{e\\parallel}\n$$\n\nTo find $v_{e\\parallel}$, we use the cold-electron parallel momentum equation, as specified in the problem statement, neglecting electron pressure and collisions. The linearized form of this equation is:\n$$\nm_e \\frac{\\partial v_{e\\parallel}}{\\partial t} = -e E_{\\parallel}\n$$\nwhere $m_e$ is the electron mass. We have canceled the constant equilibrium density $n_0$ from both sides. Applying the harmonic time dependence substitution $\\frac{\\partial}{\\partial t} \\to -\\mathrm{i}\\,\\omega$:\n$$\nm_e (-\\mathrm{i}\\,\\omega) v_{e\\parallel} = -e E_{\\parallel}\n$$\nSolving for the complex amplitude of the parallel velocity $v_{e\\parallel}$ in terms of the electric field $E_{\\parallel}$:\n$$\nv_{e\\parallel} = \\frac{-e E_{\\parallel}}{-\\mathrm{i}\\,\\omega m_e} = \\frac{e}{\\mathrm{i}\\,\\omega m_e} E_{\\parallel}\n$$\n\nNow, we substitute this expression for $v_{e\\parallel}$ back into the equation for the parallel current density $J_{\\parallel}$:\n$$\nJ_{\\parallel} = -n_0 e v_{e\\parallel} = -n_0 e \\left( \\frac{e}{\\mathrm{i}\\,\\omega m_e} E_{\\parallel} \\right) = -\\frac{n_0 e^2}{\\mathrm{i}\\,\\omega m_e} E_{\\parallel}\n$$\nTo express this in terms of the electron plasma frequency $\\omega_{pe}$, we use its definition: $\\omega_{pe}^2 \\equiv \\frac{n_0 e^2}{\\varepsilon_0 m_e}$. This implies that $n_0 e^2 / m_e = \\varepsilon_0 \\omega_{pe}^2$. Substituting this into the expression for $J_{\\parallel}$:\n$$\nJ_{\\parallel} = -\\frac{\\varepsilon_0 \\omega_{pe}^2}{\\mathrm{i}\\,\\omega} E_{\\parallel} = \\mathrm{i} \\frac{\\varepsilon_0 \\omega_{pe}^2}{\\omega} E_{\\parallel}\n$$\nThe magnitude of the parallel conduction current is then:\n$$\n|J_{\\parallel}| = \\left| \\mathrm{i} \\frac{\\varepsilon_0 \\omega_{pe}^2}{\\omega} E_{\\parallel} \\right| = \\frac{\\varepsilon_0 \\omega_{pe}^2}{\\omega} |E_{\\parallel}|\n$$\n\nFinally, we assemble the ratio $\\mathcal{R}$ using the derived magnitudes for the displacement and conduction currents:\n$$\n\\mathcal{R} = \\frac{\\left|\\varepsilon_0\\,\\partial_t E_{\\parallel}\\right|}{\\left|J_{\\parallel}\\right|} = \\frac{\\omega \\varepsilon_0 |E_{\\parallel}|}{\\frac{\\varepsilon_0 \\omega_{pe}^2}{\\omega} |E_{\\parallel}|}\n$$\nThe terms $\\varepsilon_0 |E_{\\parallel}|$ cancel, yielding the final expression:\n$$\n\\mathcal{R} = \\frac{\\omega}{\\frac{\\omega_{pe}^2}{\\omega}} = \\frac{\\omega^2}{\\omega_{pe}^2}\n$$\nThis result is expressed solely in terms of the fluctuation frequency $\\omega$ and the electron plasma frequency $\\omega_{pe}$, as required.",
            "answer": "$$\n\\boxed{\\frac{\\omega^{2}}{\\omega_{pe}^{2}}}\n$$"
        },
        {
            "introduction": "Finite Larmor Radius (FLR) effects, which are essential for accurately describing micro-instabilities and transport, are captured in gyrokinetic theory through the gyroaverage operator. Bridging theory and practice, this computational exercise  involves implementing a numerical quadrature of the gyroaverage operator for a simple plane wave. By validating your implementation against its well-known analytical result, the Bessel function $J_0$, you will gain concrete insight into how this fundamental operation is realized in gyrokinetic codes.",
            "id": "3988923",
            "problem": "Consider the role of gyrophase averaging in the derivation of the Gyrokinetic Poisson and Ampère models in computational fusion science and engineering. In a strong, uniform magnetic field, the Lorentz force causes charged particles to execute rapid circular motion around magnetic field lines, such that fields are sampled over rings of radius given by the species gyroradius. The gyroaverage operator acts on a scalar field by averaging that field over the particle's Larmor orbit at fixed guiding-center position. This operation underpins how the perpendicular wavenumber coupling enters the Gyrokinetic Poisson equation and the parallel current response in the Gyrokinetic Ampère law. \n\nImplement a discrete, real-space quadrature approximation of the gyroaverage operator acting on a monochromatic plane wave with perpendicular wave number magnitude. The implementation must use a uniform quadrature over the gyrophase angle, expressed in radians. Let the plane wave be represented as a complex field of the form $e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}}$ with $\\boldsymbol{k}_\\perp$ aligned with the $x$-axis and the guiding center fixed at the origin. The discrete gyroaverage must be computed as the uniform average over $N_\\theta$ equally spaced points on the circle of radius $\\rho_s$ centered at the origin. The real-space quadrature should directly sample the field at the ring points and average the values.\n\nThe validation target is that, for the chosen monochromatic field and the described geometry, the discrete gyroaverage reproduces the expected zero-order Bessel factor as a function of the dimensionless parameter $k_\\perp \\rho_s$, within a specified tolerance. Angles must be in radians, and all quantities are dimensionless. The program must compute, for each test case, the absolute error between the discrete quadrature result and the reference zero-order Bessel function evaluation, and then compare this error to the test-case-specific tolerance to determine a boolean validation result.\n\nUse the following test suite, covering small, moderate, and large values of $k_\\perp \\rho_s$, as well as coarse and fine quadrature resolution to probe convergence and edge conditions:\n- Test case 1: $k_\\perp = 0.2$, $\\rho_s = 0.5$, $N_\\theta = 64$, tolerance $= 10^{-12}$.\n- Test case 2: $k_\\perp = 3.0$, $\\rho_s = 1.0$, $N_\\theta = 128$, tolerance $= 10^{-10}$.\n- Test case 3: $k_\\perp = 10.0$, $\\rho_s = 2.0$, $N_\\theta = 1024$, tolerance $= 10^{-8}$.\n- Test case 4: $k_\\perp = 5.0$, $\\rho_s = 1.0$, $N_\\theta = 4$, tolerance $= 10^{-6}$.\n- Test case 5: $k_\\perp = 0.0$, $\\rho_s = 1.0$, $N_\\theta = 16$, tolerance $= 10^{-15}$.\n- Test case 6: $k_\\perp = 3.0$, $\\rho_s = 1.0$, $N_\\theta = 2048$, tolerance $= 10^{-13}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). Each result must be a boolean indicating whether the absolute error is less than or equal to the specified tolerance for that test case.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It describes a standard numerical validation task in computational plasma physics, specifically concerning the implementation of the gyroaverage operator, which is fundamental to gyrokinetic theory. The problem is therefore deemed valid.\n\nThe core of the problem is to compute a discrete approximation of the gyroaverage operator acting on a monochromatic plane wave and compare it to the known analytical result.\n\nThe continuous gyroaverage of a scalar field $\\phi(\\boldsymbol{r})$ at a fixed guiding-center position $\\boldsymbol{R}$ is defined as the average over a circular Larmor orbit in the plane perpendicular to the magnetic field:\n$$\n\\langle \\phi \\rangle_g (\\boldsymbol{R}) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\phi(\\boldsymbol{R} + \\boldsymbol{\\rho}_s(\\theta)) \\, d\\theta\n$$\nwhere $\\boldsymbol{\\rho}_s(\\theta)$ is the gyroradius vector parameterized by the gyrophase angle $\\theta \\in [0, 2\\pi)$.\n\nFor this problem, the scalar field is a plane wave, $\\phi(\\boldsymbol{r}) = e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}}$. The guiding center is at the origin, so $\\boldsymbol{R} = \\boldsymbol{0}$. The particle position on the gyro-ring is thus $\\boldsymbol{r} = \\boldsymbol{\\rho}_s(\\theta)$. The wavevector $\\boldsymbol{k}_\\perp$ is aligned with the $x$-axis, so we can write $\\boldsymbol{k}_\\perp = (k_\\perp, 0, 0)$. The gyroradius vector lies in the $x$-$y$ plane and is given by $\\boldsymbol{\\rho}_s(\\theta) = (\\rho_s \\cos\\theta, \\rho_s \\sin\\theta, 0)$.\n\nThe dot product in the exponential is $\\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r} = k_\\perp \\rho_s \\cos\\theta$. Substituting this into the field expression and then into the gyroaverage integral gives:\n$$\n\\langle e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}} \\rangle_g = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{\\mathrm{i} k_\\perp \\rho_s \\cos\\theta} \\, d\\theta\n$$\nThis integral is a standard integral representation of the zero-order Bessel function of the first kind, $J_0(z)$, where the argument is the dimensionless parameter $z = k_\\perp \\rho_s$:\n$$\nJ_0(z) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{\\mathrm{i} z \\cos\\theta} \\, d\\theta\n$$\nThis analytical result serves as the reference value for our numerical validation. Note that for real $z$, $J_0(z)$ is a real-valued function.\n\nThe problem mandates a discrete, real-space quadrature approximation. This is achieved by replacing the continuous integral with a discrete sum over $N_\\theta$ uniformly spaced points on the gyro-ring. The gyrophase angles are taken as $\\theta_j = \\frac{2\\pi j}{N_\\theta}$ for $j = 0, 1, \\dots, N_\\theta - 1$. The discrete approximation to the gyroaverage, which we can denote as $\\hat{J}_0(z)$, is the arithmetic mean of the field values at these points:\n$$\n\\hat{J}_0(z) = \\frac{1}{N_\\theta} \\sum_{j=0}^{N_\\theta-1} e^{\\mathrm{i} z \\cos(\\theta_j)}\n$$\nThis numerical evaluation is equivalent to applying the trapezoidal rule to a periodic function over one period, which is known to have excellent convergence properties.\n\nDue to the symmetry of the cosine function, the imaginary part of the sum, $\\sum_j \\sin(z \\cos\\theta_j)$, evaluates to zero in the continuous limit and is expected to be zero to within machine precision in the discrete sum for a symmetric set of points. Therefore, the numerical result is taken as the real part of the complex-valued sum.\n\nThe overall algorithm for each test case is as follows:\n$1$. Given the parameters $k_\\perp$, $\\rho_s$, and $N_\\theta$, calculate the dimensionless argument $z = k_\\perp \\rho_s$.\n$2$. Generate an array of $N_\\theta$ angles, $\\theta_j = \\frac{2\\pi j}{N_\\theta}$ for $j \\in \\{0, 1, ..., N_\\theta - 1\\}$.\n$3$. Compute the discrete gyroaverage, $\\hat{J}_0(z)$, by averaging the values of $e^{\\mathrm{i} z \\cos(\\theta_j)}$ over all angles. The result is the real part of this average.\n$4$. Compute the reference value, $J_0(z)$, using a standard library function (e.g., `scipy.special.j0`).\n$5$. Calculate the absolute error: $|\\hat{J}_0(z) - J_0(z)|$.\n$6$. Compare this error against the specified tolerance for the test case. The result is `True` if the error is less than or equal to the tolerance, and `False` otherwise.\n\nThis procedure is repeated for all test cases provided. A special case is Test Case $5$, where $k_\\perp = 0$. This gives $z = 0$, for which the field is $e^0 = 1$ everywhere. The discrete average is exactly $1$, and the reference value is $J_0(0) = 1$. The error is exactly $0$, serving as a robust sanity check of the implementation. Test Case $4$, with a very coarse quadrature ($N_\\theta = 4$) for a rapidly oscillating integrand ($z=5$), is expected to yield a large error and fail the validation check against its tight tolerance, demonstrating the limits of the numerical method.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Computes a discrete gyroaverage of a plane wave and validates it against\n    the analytical zero-order Bessel function result for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (k_perp, rho_s, N_theta, tolerance)\n    test_cases = [\n        (0.2, 0.5, 64, 1e-12),\n        (3.0, 1.0, 128, 1e-10),\n        (10.0, 2.0, 1024, 1e-8),\n        (5.0, 1.0, 4, 1e-6),\n        (0.0, 1.0, 16, 1e-15),\n        (3.0, 1.0, 2048, 1e-13),\n    ]\n\n    results = []\n    for k_perp, rho_s, N_theta, tolerance in test_cases:\n        # 1. Calculate the dimensionless parameter z = k_perp * rho_s\n        z = k_perp * rho_s\n\n        # 2. Compute the discrete gyroaverage using a uniform quadrature with N_theta points.\n        # Generate N_theta equally spaced angles in the interval [0, 2*pi).\n        # Using endpoint=False is crucial for a symmetric set of points for the discrete sum.\n        theta_points = np.linspace(0.0, 2.0 * np.pi, N_theta, endpoint=False)\n        \n        # Evaluate the complex field exp(i * z * cos(theta)) at each discrete angle.\n        field_values = np.exp(1j * z * np.cos(theta_points))\n        \n        # The discrete gyroaverage is the arithmetic mean of the field values.\n        # The analytical result J0(z) for real z is real. The imaginary part of the\n        # discrete sum should be zero to within machine precision due to symmetry.\n        # We take the real part of the numerical average for comparison.\n        discrete_j0 = np.real(np.mean(field_values))\n\n        # 3. Obtain the reference value from the zero-order Bessel function of the first kind.\n        reference_j0 = j0(z)\n\n        # 4. Calculate the absolute error between the discrete quadrature and the reference value.\n        absolute_error = np.abs(discrete_j0 - reference_j0)\n\n        # 5. Compare the absolute error to the specified tolerance to get the boolean result.\n        validation_result = absolute_error <= tolerance\n        results.append(validation_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The choice of numerical discretization scheme profoundly impacts the accuracy and stability of a simulation. The ion polarization density in the long-wavelength gyrokinetic Poisson equation is represented by a Laplacian operator, and this exercise  contrasts two common approaches: an exact spectral method and a local finite difference method. By deriving the numerical dispersion factor, you will learn to quantitatively assess how a finite difference grid can introduce non-physical dispersion that distorts the behavior of waves compared to the continuum system.",
            "id": "3988929",
            "problem": "Consider a uniform, magnetized, quasi-neutral plasma in a periodic slab with constant background magnetic field magnitude $B_0$ pointing along $\\hat{\\boldsymbol{z}}$. In the long-wavelength limit of gyrokinetic theory, the electrostatic quasi-neutrality closure contains the perpendicular polarization term $-\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2 \\phi$, where $n_{0s}$ and $m_s$ denote the equilibrium density and mass of species $s$, respectively, and $\\phi$ is the electrostatic potential. Assume two-dimensional perpendicular dynamics in coordinates $(x,y)$ with domain lengths $L_x$ and $L_y$, and impose periodic boundary conditions in both directions.\n\nYou are asked to compare two numerical discretizations of the perpendicular polarization operator $-\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2 \\phi$ when acting on a single Fourier mode of the form $\\phi(x,y) = \\text{Re}\\{\\Phi \\exp(i k_x x + i k_y y)\\}$, with real wavenumbers $k_x$ and $k_y$.\n\n- Spectral discretization: In a Fourier representation, the perpendicular Laplacian acting on the plane wave returns the continuum eigenvalue $-(k_x^2 + k_y^2)$.\n- Finite difference discretization: On a uniform grid with $N_x$ and $N_y$ points in the $x$ and $y$ directions respectively, define grid spacings $h_x = L_x/N_x$ and $h_y = L_y/N_y$. Approximate the second derivatives by standard second-order central differences,\n$$\n\\left.\\frac{\\partial^2 \\phi}{\\partial x^2}\\right|_{j,l} \\approx \\frac{\\phi_{j+1,l} - 2 \\phi_{j,l} + \\phi_{j-1,l}}{h_x^2}, \\quad\n\\left.\\frac{\\partial^2 \\phi}{\\partial y^2}\\right|_{j,l} \\approx \\frac{\\phi_{j,l+1} - 2 \\phi_{j,l} + \\phi_{j,l-1}}{h_y^2},\n$$\nwhere $(j,l)$ index grid points at $(x_j, y_l) = (j h_x, l h_y)$ with integers $j \\in [0, N_x-1]$ and $l \\in [0, N_y-1]$, and $\\phi_{j,l} = \\text{Re}\\{\\Phi \\exp(i k_x x_j + i k_y y_l)\\}$.\n\nStarting from fundamental definitions of the continuum and discrete operators above, derive the discrete Fourier symbol (eigenvalue) of the finite difference Laplacian acting on the plane wave, and use it to define the numerical dispersion factor $\\mathcal{D}(k_x, k_y; h_x, h_y)$ as the ratio of the finite difference polarization operator eigenvalue to the spectral (continuum) polarization operator eigenvalue when acting on the same plane wave. Express $\\mathcal{D}(k_x, k_y; h_x, h_y)$ as a single closed-form analytic expression in terms of $k_x$, $k_y$, $h_x$, and $h_y$.\n\nReport only the expression for $\\mathcal{D}(k_x, k_y; h_x, h_y)$. No numerical evaluation is required.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution.\n\nThe task is to derive the numerical dispersion factor $\\mathcal{D}(k_x, k_y; h_x, h_y)$, defined as the ratio of the eigenvalue of the finite-difference polarization operator to the eigenvalue of the spectral (continuum) polarization operator when acting on a single Fourier mode $\\phi(x,y) = \\text{Re}\\{\\Phi \\exp(i k_x x + i k_y y)\\}$.\n\nThe perpendicular polarization operator is given by $P = -\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2$. Let us define the constant coefficient as $C_p = \\sum_{s} \\frac{n_{0s} m_s}{B_0^2}$, which is positive definite. The operator is then $P = -C_p \\nabla_{\\perp}^2$, where $\\nabla_{\\perp}^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$.\n\nSince the operator $P$ is a linear, real-valued differential operator, its action on the real part of a complex function is the real part of its action on that complex function. That is, $P(\\text{Re}\\{f\\}) = \\text{Re}\\{P(f)\\}$. Furthermore, if the resulting eigenvalue is real, then the real part of the eigenfunction is also an eigenfunction with the same eigenvalue. We can therefore simplify the analysis by working with the complex exponential function $\\phi_c(x,y) = \\Phi \\exp(i k_x x + i k_y y)$, where $\\phi(x,y) = \\text{Re}\\{\\phi_c(x,y)\\}$.\n\nFirst, we determine the eigenvalue of the continuum polarization operator, $\\Lambda_{cont}$. We apply the perpendicular Laplacian operator $\\nabla_{\\perp}^2$ to the complex potential $\\phi_c(x,y)$:\n$$\n\\nabla_{\\perp}^2 \\phi_c = \\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right) \\left[ \\Phi \\exp(i k_x x + i k_y y) \\right]\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial^2}{\\partial x^2} \\phi_c = \\frac{\\partial}{\\partial x} (i k_x \\phi_c) = (i k_x)^2 \\phi_c = -k_x^2 \\phi_c\n$$\n$$\n\\frac{\\partial^2}{\\partial y^2} \\phi_c = \\frac{\\partial}{\\partial y} (i k_y \\phi_c) = (i k_y)^2 \\phi_c = -k_y^2 \\phi_c\n$$\nSumming these results, we find the action of the Laplacian:\n$$\n\\nabla_{\\perp}^2 \\phi_c = (-k_x^2 - k_y^2) \\phi_c = -(k_x^2 + k_y^2) \\phi_c\n$$\nThe eigenvalue of the continuum Laplacian $\\nabla_{\\perp}^2$ is thus $\\lambda_{cont} = -(k_x^2 + k_y^2)$. The continuum polarization operator is $P_{cont} = -C_p \\nabla_{\\perp}^2$. Its eigenvalue, $\\Lambda_{cont}$, is:\n$$\n\\Lambda_{cont} = -C_p \\lambda_{cont} = C_p (k_x^2 + k_y^2)\n$$\n\nNext, we determine the eigenvalue of the finite-difference discretization of the polarization operator, $\\Lambda_{FD}$. The discrete operator acts on the potential evaluated at the grid points $(x_j, y_l) = (j h_x, l h_y)$, denoted by $\\phi_{j,l}$. The complex potential on the grid is $\\phi_{c,j,l} = \\Phi \\exp(i k_x x_j + i k_y y_l)$. The finite-difference approximation to the Laplacian, $\\nabla_{FD}^2$, is given by:\n$$\n\\nabla_{FD}^2 \\phi_{j,l} = \\frac{\\phi_{j+1,l} - 2\\phi_{j,l} + \\phi_{j-1,l}}{h_x^2} + \\frac{\\phi_{j,l+1} - 2\\phi_{j,l} + \\phi_{j,l-1}}{h_y^2}\n$$\nWe evaluate the action of this discrete operator on $\\phi_{c,j,l}$. Let's first analyze the term corresponding to the $x$-derivative:\n$$\n\\frac{\\phi_{c,j+1,l} - 2\\phi_{c,j,l} + \\phi_{c,j-1,l}}{h_x^2}\n$$\nWe use the relations $\\phi_{c,j\\pm 1,l} = \\Phi \\exp(i k_x (j\\pm 1) h_x + i k_y l h_y) = \\phi_{c,j,l} \\exp(\\pm i k_x h_x)$. Substituting these into the expression gives:\n$$\n\\frac{\\phi_{c,j,l}\\exp(i k_x h_x) - 2\\phi_{c,j,l} + \\phi_{c,j,l}\\exp(-i k_x h_x)}{h_x^2} = \\frac{\\phi_{c,j,l}}{h_x^2} \\left[ \\exp(i k_x h_x) + \\exp(-i k_x h_x) - 2 \\right]\n$$\nUsing the Euler identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, the expression becomes:\n$$\n\\frac{\\phi_{c,j,l}}{h_x^2} [2\\cos(k_x h_x) - 2] = \\frac{2\\phi_{c,j,l}}{h_x^2} [\\cos(k_x h_x) - 1]\n$$\nUsing the trigonometric identity $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$, we obtain:\n$$\n\\frac{2\\phi_{c,j,l}}{h_x^2} \\left[ -2\\sin^2\\left(\\frac{k_x h_x}{2}\\right) \\right] = -\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) \\phi_{c,j,l}\n$$\nBy an identical procedure for the $y$-derivative term, we find:\n$$\n\\frac{\\phi_{c,j,l+1} - 2\\phi_{c,j,l} + \\phi_{c,j,l-1}}{h_y^2} = -\\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\phi_{c,j,l}\n$$\nSumming the terms, the action of the discrete Laplacian on $\\phi_{c,j,l}$ is:\n$$\n\\nabla_{FD}^2 \\phi_{c,j,l} = \\left[ -\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) - \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right] \\phi_{c,j,l}\n$$\nThe eigenvalue of the finite-difference Laplacian, $\\lambda_{FD}$, is therefore:\n$$\n\\lambda_{FD} = -\\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]\n$$\nThe finite-difference polarization operator is $P_{FD} = -C_p \\nabla_{FD}^2$. Its eigenvalue, $\\Lambda_{FD}$, is:\n$$\n\\Lambda_{FD} = -C_p \\lambda_{FD} = C_p \\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]\n$$\n\nFinally, we compute the numerical dispersion factor $\\mathcal{D}(k_x, k_y; h_x, h_y)$ as the ratio of $\\Lambda_{FD}$ to $\\Lambda_{cont}$:\n$$\n\\mathcal{D}(k_x, k_y; h_x, h_y) = \\frac{\\Lambda_{FD}}{\\Lambda_{cont}} = \\frac{C_p \\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]}{C_p (k_x^2 + k_y^2)}\n$$\nThe constant coefficient $C_p$ cancels, yielding the final expression for the numerical dispersion factor:\n$$\n\\mathcal{D}(k_x, k_y; h_x, h_y) = \\frac{\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right)}{k_x^2 + k_y^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right)}{k_x^2 + k_y^2}}\n$$"
        }
    ]
}