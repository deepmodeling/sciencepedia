{
    "hands_on_practices": [
        {
            "introduction": "回旋动理学泊松方程通过平衡电子和离子密度扰动来保证准中性。这一平衡中的一个关键组成部分是离子极化密度，它源于离子对变化的电场的缓慢漂移响应。本练习深入探讨了在长波极限下对该密度起贡献的两个主要物理机制：离子惯性和离子-离子碰撞。通过推导它们贡献的比率 ，您将对何时一种效应主导另一种效应建立起定量的理解，这对于模拟不同等离子体区域至关重要。",
            "id": "3988964",
            "problem": "考虑一个均匀的、单次电离的等离子体，其离子电荷为 $Z_{i} e$，离子质量为 $m_{i}$，均匀背景密度为 $n_{0}$。磁场是均匀且恒定的，$\\mathbf{B} = B \\hat{\\mathbf{z}}$，系统是静电的，静电势涨落形式为 $\\phi(\\mathbf{r}, t) = \\tilde{\\phi} \\exp\\!\\left(i \\mathbf{k}_{\\perp} \\cdot \\mathbf{r} - i \\omega t\\right)$，其中 $\\mathbf{k}_{\\perp} \\cdot \\hat{\\mathbf{z}} = 0$ 且 $k_{\\perp} \\rho_{i} \\ll 1$（长波极限，$\\rho_{i}$ 为离子回旋半径）。假设在此极限下回旋动理学泊松模型适用，并且垂直离子动力学可由垂直力引起的导心漂移很好地描述。\n\n从以下基本依据出发：\n- 受到垂直力 $\\mathbf{F}_{\\perp}$ 作用的导心垂直漂移为 $\\mathbf{v}_{F} = \\left(\\mathbf{F}_{\\perp} \\times \\mathbf{B}\\right)/\\left(Z_{i} e B^{2}\\right)$。\n- 离子密度扰动的连续性方程为 $\\partial_{t} \\delta n_{i} + n_{0} \\nabla \\cdot \\mathbf{v}_{\\perp} = 0$。\n- 垂直电场为 $\\mathbf{E}_{\\perp} = - \\nabla_{\\perp} \\phi$。\n\n将离子-离子碰撞建模为对离子流的线性垂直拖曳，碰撞频率为 $\\nu_{ii}$。将摩擦力视为 $\\mathbf{F}_{\\perp}^{(\\text{coll})} = - m_{i} \\nu_{ii} \\mathbf{v}_{\\perp}$，并在评估此碰撞修正时，用最低阶的电叉磁漂移 $\\mathbf{v}_{E} = \\left(\\mathbf{E} \\times \\mathbf{B}\\right)/B^{2}$ 来近似 $\\mathbf{v}_{\\perp}$。此外，还包括与离子惯性力 $\\mathbf{F}_{\\perp}^{(\\text{inert})} = m_{i} \\, \\mathrm{d}\\mathbf{v}_{E}/\\mathrm{d}t$ 相关的惯性极化。\n\n仅使用所述依据，计算长波极限下的碰撞极化修正 $\\delta n_{i}^{(\\text{coll})}$ 和惯性极化 $\\delta n_{i}^{(\\text{inert})}$，两者均针对给定的平面波涨落。然后，构建它们幅值的比率，\n$$\nR \\equiv \\frac{\\left|\\delta n_{i}^{(\\text{coll})}\\right|}{\\left|\\delta n_{i}^{(\\text{inert})}\\right|},\n$$\n作为以 $\\nu_{ii}$ 和 $\\omega$ 表示的封闭形式解析表达式。您的最终答案必须是这个单一的 $R$ 的解析表达式。不需要进行数值计算。",
            "solution": "用户希望我解决一个物理问题。我将首先验证它，如果有效，然后解决它。\n\n**问题验证**\n\n**第1步：提取已知条件**\n- 等离子体参数：均匀，单次电离，离子电荷 $Z_{i} e$，离子质量 $m_{i}$，均匀背景密度 $n_{0}$。\n- 磁场：$\\mathbf{B} = B \\hat{\\mathbf{z}}$，均匀且恒定。\n- 静电势涨落：$\\phi(\\mathbf{r}, t) = \\tilde{\\phi} \\exp\\!\\left(i \\mathbf{k}_{\\perp} \\cdot \\mathbf{r} - i \\omega t\\right)$。\n- 波矢约束：$\\mathbf{k}_{\\perp} \\cdot \\hat{\\mathbf{z}} = 0$。\n- 长波极限：$k_{\\perp} \\rho_{i} \\ll 1$。\n- 适用模型：回旋动理学泊松模型。\n- 由力 $\\mathbf{F}_{\\perp}$ 引起的垂直漂移速度：$\\mathbf{v}_{F} = \\left(\\mathbf{F}_{\\perp} \\times \\mathbf{B}\\right)/\\left(Z_{i} e B^{2}\\right)$。\n- 离子连续性方程：$\\partial_{t} \\delta n_{i} + n_{0} \\nabla \\cdot \\mathbf{v}_{\\perp} = 0$。\n- 垂直电场：$\\mathbf{E}_{\\perp} = - \\nabla_{\\perp} \\phi$。\n- 碰撞力：$\\mathbf{F}_{\\perp}^{(\\text{coll})} = - m_{i} \\nu_{ii} \\mathbf{v}_{\\perp}$，其中 $\\mathbf{v}_{\\perp}$ 用 $\\mathbf{v}_{E} = \\left(\\mathbf{E} \\times \\mathbf{B}\\right)/B^{2}$ 近似。\n- 惯性力：$\\mathbf{F}_{\\perp}^{(\\text{inert})} = m_{i} \\, \\mathrm{d}\\mathbf{v}_{E}/\\mathrm{d}t$。\n- 待计算量：$R \\equiv \\frac{\\left|\\delta n_{i}^{(\\text{coll})}\\right|}{\\left|\\delta n_{i}^{(\\text{inert})}\\right|}$。\n\n**第2步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题基于等离子体物理学的基本原理，特别是导心近似和流体矩方程（连续性）。极化漂移（来自离子惯性）、碰撞漂移和 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的概念是该领域的标准内容。该设置是研究磁化等离子体中低频波的典型问题。\n- **适定性：** 提供了所有必要的物理定律、本构关系和参数，以推导出目标比率 $R$ 的唯一解析表达式。问题是自洽且逻辑清晰的。\n- **客观性：** 问题以精确、数学和客观的语言陈述，不含任何主观或基于意见的主张。\n\n该问题没有表现出指令中列出的任何缺陷，如科学上不合理、不完整或含糊不清。它是计算聚变科学和等离子体理论中推导的一个教科书式例子。\n\n**第3步：结论与行动**\n问题有效。现在将推导解答。\n\n**问题解答**\n\n目标是计算碰撞和惯性离子密度扰动幅值的比率，$R \\equiv \\frac{\\left|\\delta n_{i}^{(\\text{coll})}\\right|}{\\left|\\delta n_{i}^{(\\text{inert})}\\right|}$。根据离子连续性方程，这两种密度扰动都源于它们各自漂移速度的散度。\n\n对于形式为 $\\exp(i \\mathbf{k}_{\\perp} \\cdot \\mathbf{r} - i \\omega t)$ 的平面波扰动，时间导数算符变为 $\\partial_t \\rightarrow -i\\omega$，梯度算符变为 $\\nabla \\rightarrow i\\mathbf{k}$。\n线性化的离子连续性方程 $\\partial_{t} \\delta n_{i} + n_{0} \\nabla \\cdot \\mathbf{v}_{\\perp} = 0$ 变为：\n$$\n-i \\omega \\delta n_{i} + n_{0} (i \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{\\perp}) = 0\n$$\n求解与垂直速度 $\\mathbf{v}_{\\perp}$ 相关的密度扰动 $\\delta n_{i}$，得到：\n$$\n\\delta n_{i} = \\frac{n_{0}}{\\omega}(\\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{\\perp})\n$$\n\n我们现在必须找到分别由惯性力和碰撞力产生的垂直速度 $\\mathbf{v}_{\\perp}^{(\\text{inert})}$ 和 $\\mathbf{v}_{\\perp}^{(\\text{coll})}$。这些速度是由公式 $\\mathbf{v}_{F} = \\left(\\mathbf{F}_{\\perp} \\times \\mathbf{B}\\right)/\\left(Z_{i} e B^{2}\\right)$ 给出的漂移速度。\n\n首先，我们确定基本最低阶漂移，即 $\\mathbf{E} \\times \\mathbf{B}$ 漂移 $\\mathbf{v}_{E}$。电场为 $\\mathbf{E}_{\\perp} = -\\nabla_{\\perp} \\phi = -i\\mathbf{k}_{\\perp}\\phi$。\n$$\n\\mathbf{v}_{E} = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^{2}} = \\frac{(-i\\mathbf{k}_{\\perp}\\phi) \\times (B\\hat{\\mathbf{z}})}{B^{2}} = -\\frac{i\\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}})\n$$\n\n**1. 惯性极化密度，$\\delta n_{i}^{(\\text{inert})}$**\n\n惯性力为 $\\mathbf{F}_{\\perp}^{(\\text{inert})} = m_{i} \\frac{\\mathrm{d}\\mathbf{v}_{E}}{\\mathrm{d}t}$。在线性近似中，全时间导数 $\\frac{\\mathrm{d}}{\\mathrm{d}t} = \\partial_t + \\mathbf{v} \\cdot \\nabla$ 由偏导数 $\\partial_t$ 近似，因为对流项 $(\\mathbf{v}_E \\cdot \\nabla)\\mathbf{v}_E$ 是扰动幅度 $\\phi$ 的二阶项。\n$$\n\\mathbf{F}_{\\perp}^{(\\text{inert})} \\approx m_{i} \\frac{\\partial \\mathbf{v}_{E}}{\\partial t} = m_{i}(-i\\omega)\\mathbf{v}_{E} = -i\\omega m_{i} \\left( -\\frac{i\\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\right) = -\\frac{\\omega m_{i} \\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}})\n$$\n由这个力产生的漂移速度，即所谓的极化漂移，是：\n$$\n\\mathbf{v}_{\\perp}^{(\\text{inert})} = \\frac{\\mathbf{F}_{\\perp}^{(\\text{inert})} \\times \\mathbf{B}}{Z_{i} e B^{2}} = \\frac{\\left(-\\frac{\\omega m_{i} \\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}})\\right) \\times (B\\hat{\\mathbf{z}})}{Z_{i} e B^{2}} = -\\frac{\\omega m_{i} \\phi}{Z_{i} e B^{2}} \\left( (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\times \\hat{\\mathbf{z}} \\right)\n$$\n使用矢量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$ 以及 $\\mathbf{k}_{\\perp} \\cdot \\hat{\\mathbf{z}} = 0$ 和 $\\hat{\\mathbf{z}} \\cdot \\hat{\\mathbf{z}} = 1$ 的事实，我们有 $(\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\times \\hat{\\mathbf{z}} = -\\mathbf{k}_{\\perp}$。\n$$\n\\mathbf{v}_{\\perp}^{(\\text{inert})} = -\\frac{\\omega m_{i} \\phi}{Z_{i} e B^{2}} (-\\mathbf{k}_{\\perp}) = \\frac{\\omega m_{i} \\phi}{Z_{i} e B^{2}} \\mathbf{k}_{\\perp}\n$$\n相应的惯性密度扰动是：\n$$\n\\delta n_{i}^{(\\text{inert})} = \\frac{n_{0}}{\\omega} \\left( \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{\\perp}^{(\\text{inert})} \\right) = \\frac{n_{0}}{\\omega} \\left( \\mathbf{k}_{\\perp} \\cdot \\left( \\frac{\\omega m_{i} \\phi}{Z_{i} e B^{2}} \\mathbf{k}_{\\perp} \\right) \\right) = \\frac{n_{0} m_{i} k_{\\perp}^{2}}{Z_{i} e B^{2}} \\phi\n$$\n\n**2. 碰撞极化密度，$\\delta n_{i}^{(\\text{coll})}$**\n\n碰撞力为 $\\mathbf{F}_{\\perp}^{(\\text{coll})} = - m_{i} \\nu_{ii} \\mathbf{v}_{E}$。\n$$\n\\mathbf{F}_{\\perp}^{(\\text{coll})} = -m_{i} \\nu_{ii} \\left( -\\frac{i\\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\right) = i \\frac{m_{i} \\nu_{ii} \\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}})\n$$\n由该碰撞拖曳力产生的漂移速度为：\n$$\n\\mathbf{v}_{\\perp}^{(\\text{coll})} = \\frac{\\mathbf{F}_{\\perp}^{(\\text{coll})} \\times \\mathbf{B}}{Z_{i} e B^{2}} = \\frac{\\left(i \\frac{m_{i} \\nu_{ii} \\phi}{B} (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}})\\right) \\times (B\\hat{\\mathbf{z}})}{Z_{i} e B^{2}} = i \\frac{m_{i} \\nu_{ii} \\phi}{Z_{i} e B^{2}} \\left( (\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\times \\hat{\\mathbf{z}} \\right)\n$$\n再次使用 $(\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}) \\times \\hat{\\mathbf{z}} = -\\mathbf{k}_{\\perp}$：\n$$\n\\mathbf{v}_{\\perp}^{(\\text{coll})} = i \\frac{m_{i} \\nu_{ii} \\phi}{Z_{i} e B^{2}} (-\\mathbf{k}_{\\perp}) = -i \\frac{m_{i} \\nu_{ii} \\phi}{Z_{i} e B^{2}} \\mathbf{k}_{\\perp}\n$$\n相应的碰撞密度扰动是：\n$$\n\\delta n_{i}^{(\\text{coll})} = \\frac{n_{0}}{\\omega} \\left( \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{\\perp}^{(\\text{coll})} \\right) = \\frac{n_{0}}{\\omega} \\left( \\mathbf{k}_{\\perp} \\cdot \\left( -i \\frac{m_{i} \\nu_{ii} \\phi}{Z_{i} e B^{2}} \\mathbf{k}_{\\perp} \\right) \\right) = -i \\frac{n_{0} m_{i} \\nu_{ii} k_{\\perp}^{2}}{Z_{i} e B^{2} \\omega} \\phi\n$$\n\n**3. 幅值比，$R$**\n\n现在我们计算两种密度扰动幅值的比率 $R$。\n$$\nR = \\frac{\\left|\\delta n_{i}^{(\\text{coll})}\\right|}{\\left|\\delta n_{i}^{(\\text{inert})}\\right|} = \\frac{\\left| -i \\frac{n_{0} m_{i} \\nu_{ii} k_{\\perp}^{2}}{Z_{i} e B^{2} \\omega} \\phi \\right|}{\\left| \\frac{n_{0} m_{i} k_{\\perp}^{2}}{Z_{i} e B^{2}} \\phi \\right|}\n$$\n项 $\\frac{n_{0} m_{i} k_{\\perp}^{2}}{Z_{i} e B^{2}}$ 和 $|\\phi|$ 在分子和分母中都是公因式，假设它们非零，可以消去。\n$$\nR = \\frac{\\left| -i \\frac{\\nu_{ii}}{\\omega} \\right|}{\\left| 1 \\right|} = \\left|-i\\right| \\left|\\frac{\\nu_{ii}}{\\omega}\\right| = 1 \\cdot \\frac{|\\nu_{ii}|}{|\\omega|}\n$$\n离子-离子碰撞频率 $\\nu_{ii}$ 是一个物理上的正量，所以 $|\\nu_{ii}| = \\nu_{ii}$。波频 $\\omega$ 可以是正的也可以是负的，这取决于相传播的方向，所以必须取其绝对值。\n$$\nR = \\frac{\\nu_{ii}}{|\\omega|}\n$$\n这个结果表明，碰撞极化修正相对于惯性极化的重要性由碰撞频率与波频的比值决定。",
            "answer": "$$\n\\boxed{\\frac{\\nu_{ii}}{|\\omega|}}\n$$"
        },
        {
            "introduction": "将理论物理转化为可靠的计算工具需要仔细的实现和验证。回旋动理学的基石是回旋平均算符，它捕捉了有限粒子轨道尺寸对其所经历场的影响。这个动手编程练习  将指导您使用简单的求积方法创建一个回旋平均算符的数值表示。然后，您将通过比较其对平面波的作用与精确的解析结果——贝塞尔函数 $J_0(k_\\perp \\rho_s)$——来验证您的实现，从而获得数值验证方面的实践技能。",
            "id": "3988923",
            "problem": "考虑在计算聚变科学与工程中，回旋相位平均在推导回旋动理学泊松和安培模型中的作用。在强匀磁场中，洛伦兹力使带电粒子围绕磁力线进行快速的圆周运动，从而在由粒子种类的回旋半径给定的环上对场进行采样。回旋平均算子作用于一个标量场，通过在固定的导心位置对该粒子拉莫尔轨道上的场进行平均。该操作是垂直波数耦合如何进入回旋动理学泊松方程以及平行电流响应如何进入回旋动理学安培定律的基础。\n\n实现一个作用于具有垂直波数大小的单色平面波的回旋平均算子的离散实空间求积近似。该实现必须对以弧度表示的回旋相位角使用均匀求积。设平面波表示为形式为 $e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}}$ 的复数场，其中 $\\boldsymbol{k}_\\perp$ 与 $x$ 轴对齐，导心固定在原点。离散回旋平均必须计算为在以原点为中心、半径为 $\\rho_s$ 的圆上 $N_\\theta$ 个等距点的均匀平均值。实空间求积应直接在环上的点采样场并对这些值进行平均。\n\n验证目标是，对于所选的单色场和所述几何结构，离散回旋平均在指定的容差范围内，再现了作为无量纲参数 $k_\\perp \\rho_s$ 函数的预期零阶贝塞尔因子。角度必须以弧度为单位，所有量均为无量纲。程序必须为每个测试用例计算离散求积结果与参考零阶贝塞尔函数评估值之间的绝对误差，然后将此误差与该测试用例特定的容差进行比较，以确定一个布尔验证结果。\n\n使用以下测试套件，涵盖 $k_\\perp \\rho_s$ 的小、中、大值，以及粗糙和精细的求积分辨率，以探究收敛性和边界条件：\n- 测试用例 1：$k_\\perp = 0.2$，$\\rho_s = 0.5$，$N_\\theta = 64$，容差 $= 10^{-12}$。\n- 测试用例 2：$k_\\perp = 3.0$，$\\rho_s = 1.0$，$N_\\theta = 128$，容差 $= 10^{-10}$。\n- 测试用例 3：$k_\\perp = 10.0$，$\\rho_s = 2.0$，$N_\\theta = 1024$，容差 $= 10^{-8}$。\n- 测试用例 4：$k_\\perp = 5.0$，$\\rho_s = 1.0$，$N_\\theta = 4$，容差 $= 10^{-6}$。\n- 测试用例 5：$k_\\perp = 0.0$，$\\rho_s = 1.0$，$N_\\theta = 16$，容差 $= 10^{-15}$。\n- 测试用例 6：$k_\\perp = 3.0$，$\\rho_s = 1.0$，$N_\\theta = 2048$，容差 $= 10^{-13}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”）。每个结果都必须是一个布尔值，指示绝对误差是否小于或等于该测试用例指定的容差。",
            "solution": "所述问题具有科学依据，是良定的，并包含唯一解所需的所有必要信息。它描述了计算等离子体物理学中的一个标准数值验证任务，特别是关于回旋平均算子的实现，该算子是回旋动理学理论的基础。因此，该问题被认为是有效的。\n\n问题的核心是计算作用于单色平面波的回旋平均算子的离散近似，并将其与已知的解析结果进行比较。\n\n在固定导心位置 $\\boldsymbol{R}$ 处，标量场 $\\phi(\\boldsymbol{r})$ 的连续回旋平均定义为在垂直于磁场的平面内，对圆形拉莫尔轨道上的平均：\n$$\n\\langle \\phi \\rangle_g (\\boldsymbol{R}) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\phi(\\boldsymbol{R} + \\boldsymbol{\\rho}_s(\\theta)) \\, d\\theta\n$$\n其中 $\\boldsymbol{\\rho}_s(\\theta)$ 是由回旋相位角 $\\theta \\in [0, 2\\pi)$ 参数化的回旋半径矢量。\n\n对于这个问题，标量场是平面波 $\\phi(\\boldsymbol{r}) = e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}}$。导心在原点，所以 $\\boldsymbol{R} = \\boldsymbol{0}$。因此，粒子在回旋环上的位置是 $\\boldsymbol{r} = \\boldsymbol{\\rho}_s(\\theta)$。波矢 $\\boldsymbol{k}_\\perp$ 与 $x$ 轴对齐，所以我们可以写成 $\\boldsymbol{k}_\\perp = (k_\\perp, 0, 0)$。回旋半径矢量位于 $x$-$y$ 平面内，由 $\\boldsymbol{\\rho}_s(\\theta) = (\\rho_s \\cos\\theta, \\rho_s \\sin\\theta, 0)$ 给出。\n\n指数部分中的点积是 $\\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r} = k_\\perp \\rho_s \\cos\\theta$。将此代入场表达式，然后再代入回旋平均积分，得到：\n$$\n\\langle e^{\\mathrm{i} \\boldsymbol{k}_\\perp \\cdot \\boldsymbol{r}} \\rangle_g = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{\\mathrm{i} k_\\perp \\rho_s \\cos\\theta} \\, d\\theta\n$$\n这个积分是零阶第一类贝塞尔函数 $J_0(z)$ 的标准积分表示，其中自变量是无量纲参数 $z = k_\\perp \\rho_s$：\n$$\nJ_0(z) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{\\mathrm{i} z \\cos\\theta} \\, d\\theta\n$$\n这个解析结果作为我们数值验证的参考值。注意，对于实数 $z$，$J_0(z)$ 是一个实值函数。\n\n问题要求使用离散的实空间求积近似。这是通过将连续积分替换为在回旋环上 $N_\\theta$ 个均匀间隔点上的离散和来实现的。回旋相位角取为 $\\theta_j = \\frac{2\\pi j}{N_\\theta}$，其中 $j = 0, 1, \\dots, N_\\theta - 1$。回旋平均的离散近似（我们可以表示为 $\\hat{J}_0(z)$）是这些点上场值的算术平均值：\n$$\n\\hat{J}_0(z) = \\frac{1}{N_\\theta} \\sum_{j=0}^{N_\\theta-1} e^{\\mathrm{i} z \\cos(\\theta_j)}\n$$\n这种数值计算等同于对一个周期内的周期函数应用梯形法则，已知该方法具有优异的收敛性质。\n\n由于余弦函数的对称性，和的虚部 $\\sum_j \\sin(z \\cos\\theta_j)$ 在连续极限下为零，并且对于对称的点集，在离散和中也期望在机器精度范围内为零。因此，数值结果取复值和的实部。\n\n每个测试用例的总体算法如下：\n$1$. 给定参数 $k_\\perp$、$\\rho_s$ 和 $N_\\theta$，计算无量纲自变量 $z = k_\\perp \\rho_s$。\n$2$. 生成一个包含 $N_\\theta$ 个角度的数组，$\\theta_j = \\frac{2\\pi j}{N_\\theta}$，其中 $j \\in \\{0, 1, ..., N_\\theta - 1\\}$。\n$3$. 通过对所有角度上的 $e^{\\mathrm{i} z \\cos(\\theta_j)}$ 值进行平均，计算离散回旋平均值 $\\hat{J}_0(z)$。结果是该平均值的实部。\n$4$. 使用标准库函数（例如 `scipy.special.j0`）计算参考值 $J_0(z)$。\n$5$. 计算绝对误差：$|\\hat{J}_0(z) - J_0(z)|$。\n$6$. 将此误差与测试用例指定的容差进行比较。如果误差小于或等于容差，则结果为 `True`，否则为 `False`。\n\n对所有提供的测试用例重复此过程。一个特殊情况是测试用例 5，其中 $k_\\perp = 0$。这导致 $z = 0$，此时场处处为 $e^0 = 1$。离散平均值恰好为 $1$，参考值为 $J_0(0) = 1$。误差恰好为 $0$，可作为对实现方案的稳健合理性检查。测试用例 4，对一个快速振荡的被积函数（$z=5$）使用非常粗糙的求积（$N_\\theta = 4$），预计会产生较大的误差，并且无法通过其严格的容差验证检查，这展示了数值方法的局限性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Computes a discrete gyroaverage of a plane wave and validates it against\n    the analytical zero-order Bessel function result for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (k_perp, rho_s, N_theta, tolerance)\n    test_cases = [\n        (0.2, 0.5, 64, 1e-12),\n        (3.0, 1.0, 128, 1e-10),\n        (10.0, 2.0, 1024, 1e-8),\n        (5.0, 1.0, 4, 1e-6),\n        (0.0, 1.0, 16, 1e-15),\n        (3.0, 1.0, 2048, 1e-13),\n    ]\n\n    results = []\n    for k_perp, rho_s, N_theta, tolerance in test_cases:\n        # 1. Calculate the dimensionless parameter z = k_perp * rho_s\n        z = k_perp * rho_s\n\n        # 2. Compute the discrete gyroaverage using a uniform quadrature with N_theta points.\n        # Generate N_theta equally spaced angles in the interval [0, 2*pi).\n        # Using endpoint=False is crucial for a symmetric set of points for the discrete sum.\n        theta_points = np.linspace(0.0, 2.0 * np.pi, N_theta, endpoint=False)\n        \n        # Evaluate the complex field exp(i * z * cos(theta)) at each discrete angle.\n        field_values = np.exp(1j * z * np.cos(theta_points))\n        \n        # The discrete gyroaverage is the arithmetic mean of the field values.\n        # The analytical result J0(z) for real z is real. The imaginary part of the\n        # discrete sum should be zero to within machine precision due to symmetry.\n        # We take the real part of the numerical average for comparison.\n        discrete_j0 = np.real(np.mean(field_values))\n\n        # 3. Obtain the reference value from the zero-order Bessel function of the first kind.\n        reference_j0 = j0(z)\n\n        # 4. Calculate the absolute error between the discrete quadrature and the reference value.\n        absolute_error = np.abs(discrete_j0 - reference_j0)\n\n        # 5. Compare the absolute error to the specified tolerance to get the boolean result.\n        validation_result = absolute_error = tolerance\n        results.append(validation_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "回旋动理学模拟的准确性在很大程度上取决于用于离散化控制方程的数值方法。我们在第一个练习  中从物理上探讨过的离子极化项，包含一个垂直拉普拉斯算符 $\\nabla_\\perp^2$。本练习  旨在检验使用常见的有限差分格式近似该算符所带来的后果。通过推导数值色散因子，您将量化该格式相对于精确的谱表示所引入的误差，从而揭示数值选择如何影响对不同波长波动的模拟。",
            "id": "3988929",
            "problem": "考虑一个均匀、磁化、准中性的等离子体，该等离子体位于一个周期性平板中，背景磁场大小恒为 $B_0$，方向沿 $\\hat{\\boldsymbol{z}}$。在回旋动理学理论的长波极限下，静电准中性闭合项包含垂直极化项 $-\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2 \\phi$，其中 $n_{0s}$ 和 $m_s$ 分别表示粒子种类 $s$ 的平衡密度和质量，$\\phi$ 是静电势。假设在坐标 $(x,y)$ 中存在二维垂直动力学，区域长度为 $L_x$ 和 $L_y$，并且在两个方向上都施加周期性边界条件。\n\n要求您比较垂直极化算符 $-\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2 \\phi$ 的两种数值离散化方法，当它作用于形式为 $\\phi(x,y) = \\Re\\{\\Phi \\exp(i k_x x + i k_y y)\\}$ 的单个傅里叶模式时，其中波数 $k_x$ 和 $k_y$ 为实数。\n\n- 谱方法离散：在傅里叶表示中，作用于平面波的垂直拉普拉斯算符返回连续本征值 $-(k_x^2 + k_y^2)$。\n- 有限差分方法离散：在一个均匀网格上，$x$ 和 $y$ 方向分别有 $N_x$ 和 $N_y$ 个点，定义网格间距为 $h_x = L_x/N_x$ 和 $h_y = L_y/N_y$。使用标准的二阶中心差分来近似二阶导数，\n$$\n\\left.\\frac{\\partial^2 \\phi}{\\partial x^2}\\right|_{j,l} \\approx \\frac{\\phi_{j+1,l} - 2 \\phi_{j,l} + \\phi_{j-1,l}}{h_x^2}, \\quad\n\\left.\\frac{\\partial^2 \\phi}{\\partial y^2}\\right|_{j,l} \\approx \\frac{\\phi_{j,l+1} - 2 \\phi_{j,l} + \\phi_{j,l-1}}{h_y^2},\n$$\n其中 $(j,l)$ 索引位于 $(x_j, y_l) = (j h_x, l h_y)$ 的网格点，整数 $j \\in [0, N_x-1]$ 和 $l \\in [0, N_y-1]$，并且 $\\phi_{j,l} = \\Re\\{\\Phi \\exp(i k_x x_j + i k_y y_l)\\}$。\n\n从上述连续算符和离散算符的基本定义出发，推导作用于平面波的有限差分拉普拉斯算符的离散傅里叶符号（本征值），并用它来定义数值色散因子 $\\mathcal{D}(k_x, k_y; h_x, h_y)$，其定义为有限差分极化算符的本征值与谱方法（连续）极化算符的本征值在作用于同一平面波时的比值。将 $\\mathcal{D}(k_x, k_y; h_x, h_y)$ 表示为以 $k_x$、$k_y$、$h_x$ 和 $h_y$ 为变量的单个闭式解析表达式。\n\n只需报告 $\\mathcal{D}(k_x, k_y; h_x, h_y)$ 的表达式。不需要进行数值计算。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题设定良好，客观，并包含足够的信息以获得唯一解。\n\n任务是推导数值色散因子 $\\mathcal{D}(k_x, k_y; h_x, h_y)$，其定义为当作用于单个傅里叶模式 $\\phi(x,y) = \\Re\\{\\Phi \\exp(i k_x x + i k_y y)\\}$ 时，有限差分极化算符的本征值与谱方法（连续）极化算符的本征值的比值。\n\n垂直极化算符由 $P = -\\sum_{s} \\frac{n_{0s} m_s}{B_0^2} \\nabla_{\\perp}^2$ 给出。让我们将常数系数定义为 $C_p = \\sum_{s} \\frac{n_{0s} m_s}{B_0^2}$，它是正定的。则算符为 $P = -C_p \\nabla_{\\perp}^2$，其中 $\\nabla_{\\perp}^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。\n\n由于算符 $P$ 是一个线性的、实值的微分算符，其作用于复数函数的实部等于其作用于该复数函数的实部。即，$P(\\Re\\{f\\}) = \\Re\\{P(f)\\}$。此外，如果所得本征值为实数，则本征函数的实部也是具有相同本征值的本征函数。因此，我们可以通过处理复指数函数 $\\phi_c(x,y) = \\Phi \\exp(i k_x x + i k_y y)$ 来简化分析，其中 $\\phi(x,y) = \\Re\\{\\phi_c(x,y)\\}$。\n\n首先，我们确定连续极化算符的本征值 $\\Lambda_{cont}$。我们将垂直拉普拉斯算符 $\\nabla_{\\perp}^2$ 应用于复势 $\\phi_c(x,y)$：\n$$\n\\nabla_{\\perp}^2 \\phi_c = \\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right) \\left[ \\Phi \\exp(i k_x x + i k_y y) \\right]\n$$\n偏导数为：\n$$\n\\frac{\\partial^2}{\\partial x^2} \\phi_c = \\frac{\\partial}{\\partial x} (i k_x \\phi_c) = (i k_x)^2 \\phi_c = -k_x^2 \\phi_c\n$$\n$$\n\\frac{\\partial^2}{\\partial y^2} \\phi_c = \\frac{\\partial}{\\partial y} (i k_y \\phi_c) = (i k_y)^2 \\phi_c = -k_y^2 \\phi_c\n$$\n将这些结果相加，我们得到拉普拉斯算符的作用：\n$$\n\\nabla_{\\perp}^2 \\phi_c = (-k_x^2 - k_y^2) \\phi_c = -(k_x^2 + k_y^2) \\phi_c\n$$\n因此，连续拉普拉斯算符 $\\nabla_{\\perp}^2$ 的本征值为 $\\lambda_{cont} = -(k_x^2 + k_y^2)$。连续极化算符为 $P_{cont} = -C_p \\nabla_{\\perp}^2$。其本征值 $\\Lambda_{cont}$ 为：\n$$\n\\Lambda_{cont} = -C_p \\lambda_{cont} = C_p (k_x^2 + k_y^2)\n$$\n\n接下来，我们确定极化算符的有限差分方法离散的本征值 $\\Lambda_{FD}$。离散算符作用于在网格点 $(x_j, y_l) = (j h_x, l h_y)$ 处求值的势，记为 $\\phi_{j,l}$。网格上的复势为 $\\phi_{c,j,l} = \\Phi \\exp(i k_x x_j + i k_y y_l)$。拉普拉斯算符的有限差分近似 $\\nabla_{FD}^2$ 由下式给出：\n$$\n\\nabla_{FD}^2 \\phi_{j,l} = \\frac{\\phi_{j+1,l} - 2\\phi_{j,l} + \\phi_{j-1,l}}{h_x^2} + \\frac{\\phi_{j,l+1} - 2\\phi_{j,l} + \\phi_{j,l-1}}{h_y^2}\n$$\n我们计算此离散算符对 $\\phi_{c,j,l}$ 的作用。首先分析对应于 $x$ 导数的项：\n$$\n\\frac{\\phi_{c,j+1,l} - 2\\phi_{c,j,l} + \\phi_{c,j-1,l}}{h_x^2}\n$$\n我们使用关系式 $\\phi_{c,j\\pm 1,l} = \\Phi \\exp(i k_x (j\\pm 1) h_x + i k_y l h_y) = \\phi_{c,j,l} \\exp(\\pm i k_x h_x)$。将它们代入表达式中得到：\n$$\n\\frac{\\phi_{c,j,l}\\exp(i k_x h_x) - 2\\phi_{c,j,l} + \\phi_{c,j,l}\\exp(-i k_x h_x)}{h_x^2} = \\frac{\\phi_{c,j,l}}{h_x^2} \\left[ \\exp(i k_x h_x) + \\exp(-i k_x h_x) - 2 \\right]\n$$\n使用欧拉恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，表达式变为：\n$$\n\\frac{\\phi_{c,j,l}}{h_x^2} [2\\cos(k_x h_x) - 2] = \\frac{2\\phi_{c,j,l}}{h_x^2} [\\cos(k_x h_x) - 1]\n$$\n使用三角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$，我们得到：\n$$\n\\frac{2\\phi_{c,j,l}}{h_x^2} \\left[ -2\\sin^2\\left(\\frac{k_x h_x}{2}\\right) \\right] = -\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) \\phi_{c,j,l}\n$$\n对 $y$ 导数项采用相同的步骤，我们发现：\n$$\n\\frac{\\phi_{c,j,l+1} - 2\\phi_{c,j,l} + \\phi_{c,j,l-1}}{h_y^2} = -\\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\phi_{c,j,l}\n$$\n将各项相加，离散拉普拉斯算符对 $\\phi_{c,j,l}$ 的作用是：\n$$\n\\nabla_{FD}^2 \\phi_{c,j,l} = \\left[ -\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) - \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right] \\phi_{c,j,l}\n$$\n因此，有限差分拉普拉斯算符的本征值 $\\lambda_{FD}$ 是：\n$$\n\\lambda_{FD} = -\\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]\n$$\n有限差分极化算符为 $P_{FD} = -C_p \\nabla_{FD}^2$。其本征值 $\\Lambda_{FD}$ 为：\n$$\n\\Lambda_{FD} = -C_p \\lambda_{FD} = C_p \\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]\n$$\n\n最后，我们计算数值色散因子 $\\mathcal{D}(k_x, k_y; h_x, h_y)$，即 $\\Lambda_{FD}$ 与 $\\Lambda_{cont}$ 的比值：\n$$\n\\mathcal{D}(k_x, k_y; h_x, h_y) = \\frac{\\Lambda_{FD}}{\\Lambda_{cont}} = \\frac{C_p \\left[ \\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right) \\right]}{C_p (k_x^2 + k_y^2)}\n$$\n常数系数 $C_p$ 被消去，得到数值色散因子的最终表达式：\n$$\n\\mathcal{D}(k_x, k_y; h_x, h_y) = \\frac{\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right)}{k_x^2 + k_y^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\frac{4}{h_x^2}\\sin^2\\left(\\frac{k_x h_x}{2}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{k_y h_y}{2}\\right)}{k_x^2 + k_y^2}}\n$$"
        }
    ]
}