{
    "hands_on_practices": [
        {
            "introduction": "This first exercise focuses on the essential properties that any physically realistic transport model must possess. We will examine a specific, smooth functional form for the turbulent thermal diffusivity, $\\chi$, justifying its construction based on principles like positivity and correct asymptotic behavior. This practice develops the skill of connecting mathematical forms with underlying physical constraints and analyzing model behavior near the critical threshold, such as the local stiffness of the transport response. ",
            "id": "3962253",
            "problem": "Consider a toroidal magnetically confined plasma in which the radial ion heat flux is modeled by Fick’s law, $q_{i}=-n_{i}\\chi\\,\\nabla T_{i}$, where $n_{i}$ is the ion density, $T_{i}$ is the ion temperature, and $\\chi$ is the effective ion thermal diffusivity. In the presence of microinstabilities such as Ion Temperature Gradient (ITG) driven turbulence, it is widely observed that turbulent transport exhibits a critical-gradient behavior: negligible turbulent transport below a threshold in the dimensionless gradient $R/L_{T}$, and stiff, rapidly increasing transport above it. Here $R$ is the major radius, and the temperature gradient scale length $L_{T}$ is defined by $L_{T}\\equiv -T_{i}/(\\mathrm{d}T_{i}/\\mathrm{d}r)$.\n\nStarting from these foundational ideas and the decomposition $\\chi=\\chi_{\\mathrm{neo}}+\\chi_{\\mathrm{turb}}$, where $\\chi_{\\mathrm{neo}}$ is the neoclassical baseline and $\\chi_{\\mathrm{turb}}$ is the turbulence-driven contribution, propose and justify a smooth “critical flux law” of the form\n$$\n\\chi\\!\\left(\\frac{R}{L_{T}}\\right)=\\chi_{\\mathrm{neo}}+\\alpha\\,\\ln\\!\\left\\{1+\\exp\\!\\left[\\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}\\right]\\right\\},\n$$\nwhere $\\alpha > 0$ sets the turbulent amplitude scale, $\\Delta > 0$ sets the smoothness (onset width) of the transition, and $R/L_{T,\\mathrm{crit}}$ is the critical gradient. Your justification should be rooted in the principles stated above, including physical monotonicity, positivity, asymptotic consistency with negligible turbulence well below threshold, and a finite stiffness near threshold.\n\nThen, compute a near-threshold expansion of $\\chi(R/L_{T})$ as a series in the small parameter\n$$\nx\\equiv \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta},\n$$\nretaining terms up to and including order $x^{4}$. Express the final expansion in terms of $\\chi_{\\mathrm{neo}}$, $\\alpha$, $\\Delta$, $R/L_{T}$, and $R/L_{T,\\mathrm{crit}}$. The final answer must be a single analytical expression. You do not need to provide a numerical value, so no rounding instructions are required. Assume $\\chi_{\\mathrm{neo}}$ and $\\alpha$ have units of thermal diffusivity and $\\Delta$ is dimensionless; you do not need to report units in your final expression.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Ion heat flux model: $q_{i}=-n_{i}\\chi\\,\\nabla T_{i}$\n- Ion density: $n_{i}$\n- Ion temperature: $T_{i}$\n- Effective ion thermal diffusivity: $\\chi$\n- Dimensionless temperature gradient: $R/L_{T}$\n- Major radius: $R$\n- Temperature gradient scale length: $L_{T}\\equiv -T_{i}/(\\mathrm{d}T_{i}/\\mathrm{d}r)$\n- Decomposition of diffusivity: $\\chi=\\chi_{\\mathrm{neo}}+\\chi_{\\mathrm{turb}}$\n- Neoclassical diffusivity: $\\chi_{\\mathrm{neo}}$\n- Turbulent diffusivity: $\\chi_{\\mathrm{turb}}$\n- Proposed critical flux law: $\\chi\\!\\left(\\frac{R}{L_{T}}\\right)=\\chi_{\\mathrm{neo}}+\\alpha\\,\\ln\\!\\left\\{1+\\exp\\!\\left[\\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}\\right]\\right\\}$\n- Turbulent amplitude scale: $\\alpha > 0$\n- Transition smoothness parameter: $\\Delta > 0$\n- Critical gradient threshold: $R/L_{T,\\mathrm{crit}}$\n- Expansion parameter: $x\\equiv \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}$\n- Task 1: Justify the proposed form based on physical principles: monotonicity, positivity, asymptotic consistency, and finite stiffness.\n- Task 2: Compute a near-threshold expansion of $\\chi(R/L_{T})$ as a series in $x$ up to order $x^{4}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the established field of critical gradient models for turbulent transport in fusion plasmas. The concepts, definitions ($L_{T}$), and functional form are standard representations used in computational fusion science. The problem is well-posed, providing a clearly defined mathematical model and asking for its justification and a specific series expansion. All terms are defined, and the premises are consistent. The task is neither trivial nor overly complex, requiring a solid application of calculus and physical reasoning.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\nThe solution consists of two parts as requested: first, a justification of the physical properties of the proposed model for thermal diffusivity $\\chi$, and second, the calculation of its Taylor series expansion near the critical gradient threshold.\n\nFor clarity, we introduce the dimensionless gradient variable $g \\equiv R/L_{T}$ and its critical value $g_{\\mathrm{crit}} \\equiv R/L_{T,\\mathrm{crit}}$. The expansion parameter is $x \\equiv (g - g_{\\mathrm{crit}})/\\Delta$. The model for the thermal diffusivity can be written as:\n$$\n\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + \\exp(x))\n$$\n\n**Part 1: Justification of the Model Form**\n\nWe verify that the model adheres to the specified physical principles.\n\n1.  **Positivity**: A physical diffusivity must be positive. It is given that $\\alpha > 0$. The neoclassical diffusivity $\\chi_{\\mathrm{neo}}$ is also inherently positive. The argument of the natural logarithm is $1 + \\exp(x)$. Since $\\exp(x) > 0$ for all real $x$, it follows that $1 + \\exp(x) > 1$. The natural logarithm of a number greater than $1$ is positive, so $\\ln(1 + \\exp(x)) > 0$. Therefore, $\\chi(x) = \\chi_{\\mathrm{neo}} + (\\text{positive term})$, ensuring that $\\chi(x)$ is always positive and greater than $\\chi_{\\mathrm{neo}}$.\n\n2.  **Asymptotic Consistency**: The model must reproduce the expected physical behavior in the limits far below and far above the critical gradient.\n    -   **Well below threshold ($g \\ll g_{\\mathrm{crit}}$)**: In this limit, the argument of the exponent $x = (g - g_{\\mathrm{crit}})/\\Delta$ becomes large and negative, i.e., $x \\to -\\infty$. Consequently, $\\exp(x) \\to 0$. The model becomes:\n        $$\n        \\lim_{x \\to -\\infty} \\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + 0) = \\chi_{\\mathrm{neo}}\n        $$\n        This correctly recovers the baseline neoclassical transport, with the turbulent contribution $\\chi_{\\mathrm{turb}}$ becoming negligible, as physically required.\n    -   **Well above threshold ($g \\gg g_{\\mathrm{crit}}$)**: In this limit, $x$ becomes large and positive, $x \\to +\\infty$. For large $x$, $1 + \\exp(x) \\approx \\exp(x)$. The model becomes:\n        $$\n        \\lim_{x \\to +\\infty} \\chi(x) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\ln(\\exp(x)) = \\chi_{\\mathrm{neo}} + \\alpha x = \\chi_{\\mathrm{neo}} + \\frac{\\alpha}{\\Delta}(g - g_{\\mathrm{crit}})\n        $$\n        This shows that far above the threshold, the turbulent diffusivity grows linearly with the excess gradient $g - g_{\\mathrm{crit}}$. This linear growth represents the \"stiff\" transport regime, where a small increase in the driving gradient results in a large increase in transport. The stiffness, defined as the slope $\\mathrm{d}\\chi/\\mathrm{d}g$, approaches the constant value $\\alpha/\\Delta$.\n\n3.  **Physical Monotonicity**: The diffusivity $\\chi$ should be a non-decreasing function of the gradient drive $g$. We check this by computing the first derivative of $\\chi$ with respect to $g$:\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\frac{\\mathrm{d}}{\\mathrm{d}g} \\left[ \\chi_{\\mathrm{neo}} + \\alpha \\ln\\left(1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)\\right) \\right]\n    $$\n    Using the chain rule:\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\alpha \\cdot \\frac{1}{1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)} \\cdot \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right) \\cdot \\frac{1}{\\Delta} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)}\n    $$\n    Since $\\alpha > 0$, $\\Delta > 0$, and the term $\\exp(x)/(1 + \\exp(x))$ is always positive, we have $\\mathrm{d}\\chi/\\mathrm{d}g > 0$ for all $g$. Thus, the model is strictly monotonic increasing, which is physically correct.\n\n4.  **Finite Stiffness near Threshold**: The model should provide a smooth transition from the low-transport to the high-transport regime, implying a finite stiffness at the threshold $g = g_{\\mathrm{crit}}$ (or $x=0$). The stiffness at the threshold is the value of the derivative at this point:\n    $$\n    \\left. \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} \\right|_{g=g_{\\mathrm{crit}}} = \\left. \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)} \\right|_{x=0} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{\\alpha}{\\Delta} \\frac{1}{2} = \\frac{\\alpha}{2\\Delta}\n    $$\n    The stiffness at the threshold is finite and positive. The parameter $\\Delta$ controls the sharpness of this transition: a smaller $\\Delta$ corresponds to a stiffer, more abrupt onset of turbulence. This smooth turn-on is a key feature of the model distinguishing it from a simple step-function.\n\n**Part 2: Near-Threshold Expansion**\n\nWe are asked to compute the Taylor series expansion of $\\chi(x)$ around $x=0$ up to the fourth order in $x$. The expansion is given by:\n$$\n\\chi(x) \\approx \\chi(0) + \\chi'(0)x + \\frac{\\chi''(0)}{2!}x^2 + \\frac{\\chi'''(0)}{3!}x^3 + \\frac{\\chi^{(4)}(0)}{4!}x^4\n$$\nLet $f(x) = \\ln(1 + \\exp(x))$. Then $\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha f(x)$. We need to find the derivatives of $f(x)$ at $x=0$.\n\n-   $f(x) = \\ln(1 + \\exp(x))$\n    $f(0) = \\ln(1 + \\exp(0)) = \\ln(2)$\n\n-   $f'(x) = \\frac{\\exp(x)}{1 + \\exp(x)}$\n    $f'(0) = \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{1}{2}$\n\n-   $f''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{1 + \\exp(x)} \\right) = \\frac{\\exp(x)(1 + \\exp(x)) - \\exp(x)\\exp(x)}{(1 + \\exp(x))^2} = \\frac{\\exp(x)}{(1 + \\exp(x))^2}$\n    $f''(0) = \\frac{\\exp(0)}{(1 + \\exp(0))^2} = \\frac{1}{2^2} = \\frac{1}{4}$\n\n-   $f'''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{(1 + \\exp(x))^2} \\right) = \\frac{\\exp(x)(1+\\exp(x))^2 - \\exp(x) \\cdot 2(1+\\exp(x))\\exp(x)}{(1 + \\exp(x))^4}$\n    $ = \\frac{\\exp(x)(1+\\exp(x)) - 2\\exp(2x)}{(1 + \\exp(x))^3} = \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3}$\n    $f'''(0) = \\frac{\\exp(0) - \\exp(0)}{(1 + \\exp(0))^3} = \\frac{1 - 1}{8} = 0$\n\n-   $f^{(4)}(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3} \\right)$\n    Numerator derivative: $\\exp(x) - 2\\exp(2x)$. Denominator derivative: $3(1 + \\exp(x))^2 \\exp(x)$.\n    Using the quotient rule and evaluating at $x=0$:\n    $f^{(4)}(0) = \\frac{(\\exp(0)-2\\exp(0))(1+\\exp(0))^3 - (\\exp(0)-\\exp(0)) \\cdot 3(1+\\exp(0))^2\\exp(0)}{(1+\\exp(0))^6}$\n    $f^{(4)}(0) = \\frac{(1-2)(1+1)^3 - 0}{(1+1)^6} = \\frac{-1 \\cdot 8}{64} = -\\frac{8}{64} = -\\frac{1}{8}$\n\nNow we assemble the Taylor series for $f(x)$:\n$$\nf(x) \\approx f(0) + f'(0)x + \\frac{f''(0)}{2!}x^2 + \\frac{f'''(0)}{3!}x^3 + \\frac{f^{(4)}(0)}{4!}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1/4}{2}x^2 + \\frac{0}{6}x^3 + \\frac{-1/8}{24}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4\n$$\nFinally, we substitute this back into the expression for $\\chi(x)$ and replace $x$ with its definition:\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\left( \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4 \\right)\n$$\nSubstituting $x = \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}$:\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4\n$$\nThis is the desired near-threshold expansion of the thermal diffusivity up to fourth order.",
            "answer": "$$\n\\boxed{\\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4}\n$$"
        },
        {
            "introduction": "Building on the concept of a single model, this practice explores how different mathematical forms for the diffusivity can lead to dramatically different physical behaviors. We will analyze a family of power-law models, where the diffusivity $\\chi$ is proportional to $(R/L_T - R/L_{T,\\mathrm{crit}})^p$, to understand the crucial concept of \"transport stiffness.\" This exercise highlights the profound implications of the exponent $p$ for both plasma profile regulation and the numerical stability of transport simulations, linking the chosen model physics to its computational feasibility. ",
            "id": "3962238",
            "problem": "Consider a one-dimensional flux-surface-averaged ion heat transport equation in a toroidal plasma,\n$$\\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) = - \\frac{\\partial Q}{\\partial r} + S,$$\nwhere $n$ is the ion density, $T$ is the ion temperature, $Q$ is the radial heat flux, $r$ is the minor-radius-like radial coordinate, and $S$ is a given source term. Assume the flux is diffusive, $Q = - n \\chi \\frac{\\partial T}{\\partial r}$, with a nonlinearly gradient-dependent thermal diffusivity $\\chi$ that turns on when a normalized temperature gradient exceeds a threshold (critical gradient model). Let the normalized gradient be defined as\n$$\\frac{R}{L_T} \\equiv - \\frac{R}{T} \\frac{\\partial T}{\\partial r},$$\nwhere $R$ is the major radius and $L_T$ is the temperature scale length. Above a critical value $\\frac{R}{L_{T,\\mathrm{crit}}}$, adopt the generic power-law transport closure\n$$\\chi = \\chi_0 \\left[\\frac{R}{L_T} - \\frac{R}{L_{T,\\mathrm{crit}}}\\right]_+^p,$$\nwith $\\chi_0 > 0$, exponent $p > 0$, and $[x]_+ \\equiv \\max(x,0)$ denoting activation only above threshold. In a narrow radial layer around a point $r_0$ where $T \\approx T_0$ and $n \\approx n_0$ can be treated as locally constant, define the local positive gradient magnitude $g \\equiv - \\frac{\\partial T}{\\partial r}(r_0) \\ge 0$ and approximate $\\frac{R}{L_T} \\approx k g$, with $k \\equiv \\frac{R}{T_0}$ treated as constant within the layer. For small perturbations around a state just above threshold, $g = g_\\ast + \\delta g$ with $g_\\ast \\equiv \\frac{1}{k} \\frac{R}{L_{T,\\mathrm{crit}}}$ and $\\delta g > 0$ small, linearize the flux-gradient relation to identify an effective diffusion coefficient $D_{\\mathrm{eff}}$ governing the response of $Q$ to changes in $g$. Using this local analysis, reason from the conservation law and diffusive closure to determine how the exponent $p$ impacts:\n- the transport stiffness (the sensitivity of $Q$ to small increases in $g$ above threshold, which tends to clamp gradients), and\n- the numerical stability of explicit time-stepping schemes, as constrained by the Courant–Friedrichs–Lewy (CFL) condition for nonlinear diffusion.\n\nWhich of the following statements is most consistent with this first-principles analysis?\n\nA. Increasing $p$ raises transport stiffness at finite excess gradients while smoothing the onset at threshold: near $\\delta g \\to 0^+$, $D_{\\mathrm{eff}} \\propto \\delta g^{p-1}$ so $p  1$ yields a divergent onset slope (severe explicit CFL restriction), $p = 1$ yields a finite onset slope, and $p > 1$ yields a vanishing onset slope; away from threshold, larger $p$ increases $D_{\\mathrm{eff}}$ and clamps the gradient more strongly.\n\nB. For any $p$, the effective diffusion $D_{\\mathrm{eff}}$ is independent of the excess gradient above threshold, so stiffness and CFL stability are unaffected by the choice of $p$.\n\nC. The linear-in-excess-gradient case $p = 1$ produces a vanishing onset slope at threshold, making it the least stiff and the most stable choice for explicit schemes.\n\nD. Larger $p$ always worsens explicit stability because it increases nonlinearity irrespective of the operating point; onset behavior at threshold does not depend on $p$.",
            "solution": "The user has provided a problem concerning a one-dimensional ion heat transport model in a toroidal plasma. The task is to validate the problem statement and, if valid, derive the correct answer by analyzing the provided options.\n\n### Step 1: Extract Givens\n\nThe problem statement provides the following information:\n-   **Heat Transport Equation**: $\\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) = - \\frac{\\partial Q}{\\partial r} + S$, where $n$ is ion density, $T$ is ion temperature, $Q$ is radial heat flux, $r$ is a radial coordinate, and $S$ is a source term.\n-   **Heat Flux Definition**: $Q = - n \\chi \\frac{\\partial T}{\\partial r}$, where $\\chi$ is the thermal diffusivity.\n-   **Normalized Temperature Gradient**: $\\frac{R}{L_T} \\equiv - \\frac{R}{T} \\frac{\\partial T}{\\partial r}$, where $R$ is the major radius and $L_T$ is the temperature scale length.\n-   **Critical Gradient Model for Diffusivity**: $\\chi = \\chi_0 \\left[\\frac{R}{L_T} - \\frac{R}{L_{T,\\mathrm{crit}}}\\right]_+^p$, with constants $\\chi_0 > 0$ and $p > 0$. The notation $[x]_+ \\equiv \\max(x,0)$ indicates a threshold condition.\n-   **Local Analysis Approximations**: In a narrow layer around a point $r_0$:\n    -   $T \\approx T_0$ and $n \\approx n_0$ are treated as locally constant.\n    -   The local positive gradient magnitude is $g \\equiv - \\frac{\\partial T}{\\partial r}(r_0) \\ge 0$.\n    -   The normalized gradient is approximated as $\\frac{R}{L_T} \\approx k g$, where $k \\equiv \\frac{R}{T_0}$ is treated as constant.\n-   **Perturbation near Threshold**: We consider a state just above threshold where $g = g_\\ast + \\delta g$, with $g_\\ast \\equiv \\frac{1}{k} \\frac{R}{L_{T,\\mathrm{crit}}}$ being the critical gradient magnitude and $\\delta g > 0$ being a small perturbation.\n-   **Questions to Address**: The analysis should determine how the exponent $p$ affects:\n    1.  Transport stiffness, defined as the sensitivity of $Q$ to small increases in $g$ above threshold.\n    2.  The numerical stability of explicit time-stepping schemes via the Courant–Friedrichs–Lewy (CFL) condition for nonlinear diffusion.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is subjected to validation against the established criteria.\n\n-   **Scientific Grounding**: The problem is well-grounded in the field of computational plasma physics and fusion energy science. The 1D energy transport equation, the diffusive flux model, and the critical gradient model for turbulent transport are standard elements in core transport modeling of tokamaks. The specific power-law form for the diffusivity is a common and physically motivated parameterization.\n-   **Well-Posedness**: The problem is well-posed. It provides a clear theoretical model and a set of simplifying assumptions (local analysis) that allow for a direct analytical investigation of the model's properties. The questions asked (regarding stiffness and numerical stability) are standard and meaningful concepts within this context.\n-   **Objectivity**: The language is precise, quantitative, and free of subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem statement is self-contained. It defines all variables and provides all necessary equations and approximations to proceed with the analysis. There are no internal contradictions.\n-   **Realism**: The model is a simplified but physically realistic representation of a key phenomenon (transport stiffness) in magnetic confinement fusion.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is a standard, well-posed problem in theoretical plasma transport. I will now proceed with a full derivation and analysis.\n\n### Derivation and Analysis\n\nThe goal is to analyze the behavior of the heat flux $Q$ and its implications for transport stiffness and numerical stability, as a function of the model exponent $p$.\n\nFirst, we express the heat flux $Q$ in terms of the local gradient magnitude $g$. Using the provided local approximations ($n \\approx n_0$, $g = - \\frac{\\partial T}{\\partial r}$), the heat flux is:\n$$Q = -n_0 \\chi \\left(-\\frac{1}{n_0 \\chi} Q\\right) = n_0 \\chi g$$\nNext, we express the diffusivity $\\chi$ in terms of $g$. Using the approximation $\\frac{R}{L_T} \\approx kg$ and the definition of the critical gradient magnitude $g_\\ast = \\frac{1}{k}\\frac{R}{L_{T, \\mathrm{crit}}}$, the critical gradient model for $\\chi$ becomes:\n$$\\chi = \\chi_0 \\left[k g - k g_\\ast\\right]_+^p = \\chi_0 k^p \\left[g - g_\\ast\\right]_+^p$$\nWe are interested in the behavior *above* threshold, where $g > g_\\ast$, so $[g-g_\\ast]_+ = g-g_\\ast$. Substituting this into the expression for $Q$:\n$$Q(g) = n_0 \\left(\\chi_0 k^p (g - g_\\ast)^p\\right) g = n_0 \\chi_0 k^p g (g - g_\\ast)^p$$\n\n**1. Transport Stiffness**\n\nTransport stiffness is defined as the sensitivity of $Q$ to small increases in $g$, which is mathematically given by the derivative $\\frac{\\partial Q}{\\partial g}$. A large value of this derivative means that a small increase in the driving gradient $g$ causes a large increase in the flux $Q$, which in turn cools the plasma and reduces the gradient, thus \"clamping\" it near the critical value.\n\nWe calculate the derivative of $Q(g)$ with respect to $g$ for $g > g_\\ast$:\n$$\\frac{\\partial Q}{\\partial g} = \\frac{\\partial}{\\partial g} \\left[ n_0 \\chi_0 k^p g (g - g_\\ast)^p \\right]$$\nUsing the product rule:\n$$\\frac{\\partial Q}{\\partial g} = n_0 \\chi_0 k^p \\left[ 1 \\cdot (g - g_\\ast)^p + g \\cdot p(g - g_\\ast)^{p-1} \\right]$$\nFactoring out the term $(g - g_\\ast)^{p-1}$:\n$$\\frac{\\partial Q}{\\partial g} = n_0 \\chi_0 k^p (g - g_\\ast)^{p-1} \\left[ (g - g_\\ast) + pg \\right]$$\n$$\\frac{\\partial Q}{\\partial g} = n_0 \\chi_0 k^p (g - g_\\ast)^{p-1} \\left[ (p+1)g - g_\\ast \\right]$$\nTo analyze the behavior at the onset of transport, we examine this expression for a small perturbation above threshold, $g = g_\\ast + \\delta g$, where $\\delta g \\to 0^+$.\n$$g - g_\\ast = \\delta g$$\nSubstituting this into the expression for the stiffness:\n$$\\frac{\\partial Q}{\\partial g} = n_0 \\chi_0 k^p (\\delta g)^{p-1} \\left[ (p+1)(g_\\ast + \\delta g) - g_\\ast \\right] = n_0 \\chi_0 k^p (\\delta g)^{p-1} \\left[ pg_\\ast + (p+1)\\delta g \\right]$$\nAs $\\delta g \\to 0^+$, the term in the brackets approaches $pg_\\ast$. The dominant behavior is determined by the $(\\delta g)^{p-1}$ term:\n$$\\frac{\\partial Q}{\\partial g} \\propto (\\delta g)^{p-1} \\quad \\text{as } \\delta g \\to 0^+$$\n\nWe analyze this behavior for different values of $p > 0$:\n-   If $0  p  1$, the exponent $p-1$ is negative. Thus, as $\\delta g \\to 0^+$, $(\\delta g)^{p-1} \\to \\infty$. The stiffness diverges at the threshold, meaning an infinitely sharp onset of transport.\n-   If $p = 1$, the exponent $p-1$ is zero. Thus, as $\\delta g \\to 0^+$, $(\\delta g)^{p-1} \\to 1$. The stiffness approaches a finite, non-zero constant, $\\frac{\\partial Q}{\\partial g}(g_\\ast) = n_0 \\chi_0 k g_\\ast$. This corresponds to a sharp \"corner\" in the $Q-g$ relationship.\n-   If $p > 1$, the exponent $p-1$ is positive. Thus, as $\\delta g \\to 0^+$, $(\\delta g)^{p-1} \\to 0$. The stiffness is zero at the threshold. This corresponds to a smooth ($C^1$) onset of transport.\n\n**2. Numerical Stability (CFL Condition)**\n\nThe heat transport equation is a nonlinear diffusion equation. With constant $n$, it is $\\frac{3}{2}n_0 \\frac{\\partial T}{\\partial t} = -\\frac{\\partial Q}{\\partial r}$. Using the chain rule, we can write $\\frac{\\partial Q}{\\partial r} = \\frac{\\partial Q}{\\partial g} \\frac{\\partial g}{\\partial r} = \\frac{\\partial Q}{\\partial g} \\frac{\\partial}{\\partial r}(-\\frac{\\partial T}{\\partial r}) = -\\frac{\\partial Q}{\\partial g} \\frac{\\partial^2 T}{\\partial r^2}$. This gives:\n$$\\frac{\\partial T}{\\partial t} = \\frac{2}{3n_0} \\frac{\\partial Q}{\\partial g} \\frac{\\partial^2 T}{\\partial r^2}$$\nThis is of the form $\\frac{\\partial T}{\\partial t} = D_{\\mathrm{eff}} \\frac{\\partial^2 T}{\\partial r^2}$, where the effective diffusion coefficient for stability analysis is $D_{\\mathrm{eff}} = \\frac{2}{3n_0} \\frac{\\partial Q}{\\partial g}$. The CFL condition for an explicit finite-difference scheme for this equation is $\\Delta t \\le C \\frac{(\\Delta r)^2}{D_{\\mathrm{eff}}}$, where $C$ is a constant of order unity. Therefore, the maximum stable time step is inversely proportional to the stiffness:\n$$\\Delta t_{\\max} \\propto \\frac{1}{D_{\\mathrm{eff}}} \\propto \\frac{1}{\\partial Q / \\partial g}$$\nThe numerical stability constraint is most severe when the stiffness is highest.\n-   For $0  p  1$, stiffness diverges at threshold ($\\partial Q/\\partial g \\to \\infty$), so the required time step goes to zero ($\\Delta t_{\\max} \\to 0$). This is an extremely severe restriction for explicit numerical schemes.\n-   For $p = 1$, stiffness is finite at threshold, so $\\Delta t_{\\max}$ is finite and non-zero.\n-   For $p > 1$, stiffness is zero at threshold, implying no CFL restriction *at the threshold point itself*. This is the most favorable case for explicit stability at onset.\n\n**3. Behavior Away from Threshold**\n\nThe options also discuss behavior \"away from threshold\". Let's consider the stiffness $\\frac{\\partial Q}{\\partial g}$ for a finite overdrive, e.g., $g = 2g_\\ast$.\n$$\\frac{\\partial Q}{\\partial g}\\Big|_{g=2g_\\ast} = n_0 \\chi_0 k^p (g_\\ast)^{p-1} \\left[ (p+1)2g_\\ast - g_\\ast \\right] = n_0 \\chi_0 (k g_\\ast)^p (2p+1)$$\nSince $k g_\\ast = R/L_{T,\\mathrm{crit}}$ is typically greater than $1$ in tokamaks, the term $(k g_\\ast)^p$ grows strongly with $p$. The term $(2p+1)$ also grows with $p$. Therefore, for a fixed gradient well above threshold, a larger exponent $p$ leads to a much larger stiffness $\\frac{\\partial Q}{\\partial g}$. This confirms that larger $p$ models clamp the gradient more strongly when it exceeds the critical value by a finite amount.\n\n### Option-by-Option Analysis\n\nNow we evaluate the provided options based on this analysis.\n\n**A. Increasing $p$ raises transport stiffness at finite excess gradients while smoothing the onset at threshold: near $\\delta g \\to 0^+$, $D_{\\mathrm{eff}} \\propto \\delta g^{p-1}$ so $p  1$ yields a divergent onset slope (severe explicit CFL restriction), $p = 1$ yields a finite onset slope, and $p > 1$ yields a vanishing onset slope; away from threshold, larger $p$ increases $D_{\\mathrm{eff}}$ and clamps the gradient more strongly.**\n\n-   \"...smoothing the onset at threshold\": Correct. Increasing $p$ past $1$ makes the onset $C^1$ smooth.\n-   \"near $\\delta g \\to 0^+$, $D_{\\mathrm{eff}} \\propto \\delta g^{p-1}$\": Correct. The effective diffusivity for stiffness and stability, $\\frac{\\partial Q}{\\partial g}$, scales this way.\n-   \"$p  1$ yields a divergent onset slope (severe explicit CFL restriction)\": Correct. Stiffness diverges, so $\\Delta t \\to 0$.\n-   \"$p = 1$ yields a finite onset slope\": Correct.\n-   \"$p > 1$ yields a vanishing onset slope\": Correct.\n-   \"away from threshold, larger $p$ increases $D_{\\mathrm{eff}}$ and clamps the gradient more strongly\": Correct. As shown, for finite overdrive, stiffness increases strongly with $p$.\n\nThis statement accurately summarizes all aspects of our analysis.\n**Verdict: Correct.**\n\n**B. For any $p$, the effective diffusion $D_{\\mathrm{eff}}$ is independent of the excess gradient above threshold, so stiffness and CFL stability are unaffected by the choice of $p$.**\n\n-   \"independent of the excess gradient\": Incorrect. We found $\\frac{\\partial Q}{\\partial g} \\propto (g-g_\\ast)^{p-1}$, which explicitly depends on the excess gradient unless $p=1$.\n-   \"unaffected by the choice of $p$\": Incorrect. The exponent $p$ fundamentally changes the behavior at and away from the threshold.\n**Verdict: Incorrect.**\n\n**C. The linear-in-excess-gradient case $p = 1$ produces a vanishing onset slope at threshold, making it the least stiff and the most stable choice for explicit schemes.**\n\n-   \"...produces a vanishing onset slope\": Incorrect. For $p=1$, the slope is finite and non-zero. It is the models with $p>1$ that have a vanishing onset slope.\n-   \"making it the least stiff\": Incorrect. At onset, it is stiffer than any case with $p>1$.\n-   \"most stable choice\": Incorrect. Cases with $p>1$ are more stable at onset because their effective diffusivity is zero there.\n**Verdict: Incorrect.**\n\n**D. Larger $p$ always worsens explicit stability because it increases nonlinearity irrespective of the operating point; onset behavior at threshold does not depend on $p$.**\n\n-   \"Larger $p$ always worsens explicit stability\": Incorrect. At the onset threshold, a larger $p$ (specifically $p>1$) *improves* stability by making the stiffness vanish. The word \"always\" makes the statement false.\n-   \"onset behavior at threshold does not depend on $p$\": Incorrect. Our entire analysis shows that the behavior of the onset slope is critically dependent on whether $p1$, $p=1$, or $p>1$.\n**Verdict: Incorrect.**\n\nBased on the thorough analysis, only option A is consistent with the derived properties of the critical gradient transport model.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice bridges the gap between theoretical models and practical computation, a core skill in computational science. You will implement a finite-volume discretization of the heat transport equation featuring a nonlinear diffusivity from a critical gradient model. By deriving and applying the numerical stability criterion for an explicit time-stepping scheme, you will see firsthand how the \"stiffness\" of the transport model—a physical property—directly dictates the maximum allowable time step in a simulation. ",
            "id": "3962212",
            "problem": "Consider a one-dimensional slab geometry with spatial coordinate $x \\in [0,L]$ and a uniform finite-volume partition into $N$ control volumes of width $\\Delta x = L/N$. Let $T(x,t)$ denote the ion temperature field in kilo-electronvolts (keV). The nonlinear turbulent heat conduction operator is modeled in the form $\\nabla \\cdot \\left(\\chi\\left(\\frac{R}{L_T}\\right) \\nabla T\\right)$, where the thermal diffusivity $\\chi$ depends on the dimensionless gradient ratio $\\frac{R}{L_T}$ through a critical-gradient prescription. Here $R$ is the tokamak major radius in meters, and the local temperature gradient scale length is defined by $L_T = -\\frac{T}{\\partial T/\\partial x}$ in meters. The evolution equation is\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\chi\\left(\\frac{R}{L_T}\\right)\\frac{\\partial T}{\\partial x}\\right).\n$$\nBoundary conditions are symmetry at $x=0$ (zero flux, i.e., $\\frac{\\partial T}{\\partial x}(0,t)=0$) and a fixed edge temperature at $x=L$ (Dirichlet condition $T(L,t) = T_{\\text{edge}}$). Assume all temperatures remain strictly positive.\n\nThe finite-volume discretization is to be constructed as follows:\n- Cell centers $x_i = \\left(i+\\frac{1}{2}\\right)\\Delta x$ for $i=0,1,\\dots,N-1$, and cell faces $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$ for $i=0,1,\\dots,N-1$, with the left boundary at $x_{-\\frac{1}{2}}=0$ and right boundary at $x_{N-\\frac{1}{2}}=L$.\n- Define face temperatures by centered averaging $T_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(T_{i+1}+T_i\\right)$ for internal faces $i=0,\\dots,N-2$. For the left boundary face use $T_{-\\frac{1}{2}} = T_0$, and for the right boundary face use $T_{N-\\frac{1}{2}} = \\frac{1}{2}\\left(T_{N-1}+T_{\\text{edge}}\\right)$.\n- Define face gradients by $\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}} = \\frac{T_{i+1}-T_i}{\\Delta x}$ for internal faces $i=0,\\dots,N-2$, $\\left(\\frac{\\partial T}{\\partial x}\\right)_{-\\frac{1}{2}}=0$ for the left boundary, and $\\left(\\frac{\\partial T}{\\partial x}\\right)_{N-\\frac{1}{2}} = \\frac{T_{\\text{edge}}-T_{N-1}}{\\Delta x}$ for the right boundary.\n- Define the dimensionless gradient ratio at faces as\n$$\ng_{i+\\frac{1}{2}} = \\frac{R}{L_T}\\bigg|_{i+\\frac{1}{2}} = -\\,\\frac{R}{T_{i+\\frac{1}{2}}}\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n- Define the critical-gradient model for the diffusivity as\n$$\n\\chi(g) = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max\\!\\left(0,\\,g - g_c\\right)^{\\alpha},\n$$\nwhere $\\chi_{\\min}$ and $\\chi_{\\text{amp}}$ are in $\\text{m}^2/\\text{s}$, $g_c$ is dimensionless, and $\\alpha \\geq 1$ is dimensionless.\n- The finite-volume semi-discrete operator for cell $i$ must be implemented as\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left[-F_{i+\\frac{1}{2}} + F_{i-\\frac{1}{2}}\\right],\n$$\nwith face heat fluxes\n$$\nF_{i+\\frac{1}{2}} = -\\,\\chi\\!\\left(g_{i+\\frac{1}{2}}\\right)\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n\nTask 1 (Derivation): Starting from conservation of energy in a control volume and the definition of flux, derive the explicit forward-Euler time-stepping update formula for the finite-volume discretization in terms of cell-centered temperatures $T_i^n$ and face diffusivities $\\chi_{i+\\frac{1}{2}}$. Using a standard monotonicity and positivity argument, derive a sufficient stability criterion of the form\n$$\n\\Delta t \\le \\min_i \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}},\n$$\nthat guarantees the forward-Euler scheme does not produce non-physical overshoots for any cell $i$. Express $\\Delta t$ in seconds.\n\nTask 2 (Implementation): Implement a complete program that:\n- Constructs the finite-volume faces, face temperatures, face gradients, face $g_{i+\\frac{1}{2}}$, and face diffusivities $\\chi_{i+\\frac{1}{2}}$ for given parameters.\n- Computes the cell-wise stability denominator $\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}$ for all $i$ accounting for boundary faces (with $\\chi_{-\\frac{1}{2}}=0$ due to symmetry).\n- Returns the maximum allowable explicit time step $\\Delta t_{\\max}$ according to the stability criterion above as a float in seconds.\n\nUse the following test suite. For all cases, use $L=1.0$ meters, $N=128$ cells, $R=3.0$ meters, $\\chi_{\\min}=0.30$ $\\text{m}^2/\\text{s}$, $\\chi_{\\text{amp}}=1.50$ $\\text{m}^2/\\text{s}$, $g_c=6.0$, and $\\alpha=1$. Define the edge temperature $T_{\\text{edge}}=1.0$ keV, and cell-centered initial profiles $T_i$ by evaluating $T(x_i)$:\n\n- Case 1 (gentle, quadratic profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$ with $T_{\\text{core}} = 15.0$ keV.\n- Case 2 (steeper, linear profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)$ with $T_{\\text{core}} = 20.0$ keV.\n- Case 3 (near-flat profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$ with $T_{\\text{core}} = 2.0$ keV.\n- Case 4 (uniform profile): $T(x) \\equiv T_{\\text{edge}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each list element must be $\\Delta t_{\\max}$ for the corresponding case, expressed in seconds as a float. No other text should be printed.\n\nAll physical quantities must be handled in their specified units, and the final outputs must be in seconds.",
            "solution": "The user has provided a problem statement that requires the derivation of a numerical stability criterion and its implementation for a nonlinear heat diffusion equation used in computational plasma physics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation**: $\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\chi\\left(\\frac{R}{L_T}\\right)\\frac{\\partial T}{\\partial x}\\right)$, for temperature $T(x,t)$ in keV.\n- **Domain**: $x \\in [0,L]$.\n- **Boundary Conditions**: $\\frac{\\partial T}{\\partial x}(0,t)=0$ (zero flux) and $T(L,t) = T_{\\text{edge}}$ (Dirichlet).\n- **Definitions**:\n    - Major radius $R$ (meters).\n    - Temperature gradient scale length: $L_T = -T / (\\partial T/\\partial x)$ (meters).\n    - Dimensionless gradient ratio: $g = R/L_T = -R/T \\cdot \\partial T/\\partial x$.\n    - Diffusivity model: $\\chi(g) = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max(0, g - g_c)^{\\alpha}$.\n- **Discretization**:\n    - $N$ cells of width $\\Delta x = L/N$.\n    - Cell centers: $x_i = (i+\\frac{1}{2})\\Delta x$ for $i=0,\\dots,N-1$.\n    - Cell faces: $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$ for $i=0,\\dots,N-1$.\n    - Face temperatures: $T_{i+\\frac{1}{2}} = \\frac{1}{2}(T_{i+1}+T_i)$ for internal faces, $T_{-\\frac{1}{2}} = T_0$, $T_{N-\\frac{1}{2}} = \\frac{1}{2}(T_{N-1}+T_{\\text{edge}})$.\n    - Face gradients: $(\\frac{\\partial T}{\\partial x})_{i+\\frac{1}{2}} = \\frac{T_{i+1}-T_i}{\\Delta x}$ for internal faces, $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}}=0$, $(\\frac{\\partial T}{\\partial x})_{N-\\frac{1}{2}} = \\frac{T_{\\text{edge}}-T_{N-1}}{\\Delta x}$.\n    - Semi-discrete equation: $\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}[-F_{i+\\frac{1}{2}} + F_{i-\\frac{1}{2}}]$.\n    - Face flux: $F_{i+\\frac{1}{2}} = -\\chi(g_{i+\\frac{1}{2}})(\\frac{\\partial T}{\\partial x})_{i+\\frac{1}{2}}$.\n- **Task 1**: Derive the forward-Euler update formula and the stability criterion $\\Delta t \\le \\min_i \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}}$.\n- **Task 2**: Implement a program to compute $\\Delta t_{\\max}$ for four specific initial temperature profiles.\n- **Parameters**: $L=1.0\\,\\text{m}$, $N=128$, $R=3.0\\,\\text{m}$, $\\chi_{\\min}=0.30\\,\\text{m}^2/\\text{s}$, $\\chi_{\\text{amp}}=1.50\\,\\text{m}^2/\\text{s}$, $g_c=6.0$, $\\alpha=1.0$, $T_{\\text{edge}}=1.0\\,\\text{keV}$.\n- **Special Instruction**: Account for boundary faces with $\\chi_{-\\frac{1}{2}}=0$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is scientifically grounded, describing a standard finite-volume discretization of a nonlinear parabolic partial differential equation commonly used in plasma transport modeling. All terms, parameters, and numerical procedures are defined precisely and are consistent with standard practices in computational physics. The problem is well-posed, objective, and contains all necessary information to perform the requested derivations and computations. There are no scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A complete solution will be provided.\n\n---\n\n### Solution\n\nThe solution is presented in two parts as requested: a theoretical derivation and an explanation of the implementation methodology.\n\n**Task 1: Derivation of the Forward-Euler Update and Stability Criterion**\n\nThe semi-discrete finite-volume equation for the temperature $T_i$ in control volume $i$ is given by the conservation law:\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left(F_{i-\\frac{1}{2}} - F_{i+\\frac{1}{2}}\\right)\n$$\nwhere $F_{i\\pm\\frac{1}{2}}$ are the heat fluxes at the cell faces. The flux is defined as $F = -\\chi \\frac{\\partial T}{\\partial x}$. Substituting the discrete expressions for the flux, we have:\n$$\nF_{i+\\frac{1}{2}} = -\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\n$$\n$$\nF_{i-\\frac{1}{2}} = -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right)\n$$\nwhere $\\chi_{i\\pm\\frac{1}{2}}$ is the thermal diffusivity evaluated at the respective face. Substituting these into the conservation law gives:\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x} \\left[ -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right) - \\left(-\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\\right) \\right]\n$$\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}(T_{i+1} - T_i) + \\chi_{i-\\frac{1}{2}}(T_{i-1} - T_i) \\right]\n$$\nNow, we apply the forward-Euler method for time integration. Let $T_i^n$ be the temperature in cell $i$ at time step $n$. The time derivative is approximated as $\\frac{d T_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$. All terms on the right-hand side are evaluated at time step $n$.\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\nSolving for $T_i^{n+1}$ gives the explicit update formula:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\nTo derive the stability criterion, we rearrange the update formula to express $T_i^{n+1}$ as a linear combination of temperatures at step $n$:\n$$\nT_i^{n+1} = T_{i-1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i-\\frac{1}{2}}^n\\right) + T_{i+1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i+\\frac{1}{2}}^n\\right) + T_i^n \\left(1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n)\\right)\n$$\nA sufficient condition for the scheme to be monotonic (i.e., not create new extrema, which prevents non-physical oscillations and negative temperatures, given that $T^n > 0$) is that all coefficients in the linear combination for $T_i^{n+1}$ are non-negative.\nThe diffusivity $\\chi$ is always non-negative (since $\\chi \\ge \\chi_{\\min} > 0$), and $\\Delta t, \\Delta x^2 > 0$. Thus, the coefficients for $T_{i-1}^n$ and $T_{i+1}^n$ are non-negative. The only condition to enforce is on the coefficient of $T_i^n$:\n$$\n1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n) \\ge 0\n$$\nRearranging this inequality for $\\Delta t$ gives:\n$$\n\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\nThis condition must hold for every computational cell $i=0, 1, \\dots, N-1$. Therefore, the global time step $\\Delta t$ must be bounded by the minimum of these local time step limits:\n$$\n\\Delta t \\le \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\nThis establishes the required stability criterion. For the boundary cell $i=0$, the flux $F_{-\\frac{1}{2}}$ corresponds to the symmetry boundary condition. The problem states $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}}=0$, which implies $F_{-\\frac{1}{2}}=0$. The update for cell $i=0$ is:\n$$\n\\frac{d T_0}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{\\frac{1}{2}}(T_1 - T_0) \\right]\n$$\nThe corresponding coefficient for $T_0^n$ in the forward-Euler update is $1 - \\frac{\\Delta t}{\\Delta x^2}\\chi_{\\frac{1}{2}}^n$. The stability condition is $\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{\\frac{1}{2}}^n}$. This is consistent with the general formula if we set $\\chi_{-\\frac{1}{2}}^n = 0$, as explicitly instructed in the problem statement. The fixed temperature at $x=L$ means $T_N=T_{\\text{edge}}$ is a constant parameter, not a variable, and does not impose a stability constraint on itself. The cell $i=N-1$ is the last dynamic cell and its stability is covered by the general formula for $i=N-1$.\n\n**Task 2: Implementation Methodology**\n\nThe goal is to compute the maximum allowed time step, $\\Delta t_{\\max}$, for given initial conditions. This corresponds to evaluating the stability criterion at time $t=0$.\n$$\n\\Delta t_{\\max} = \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}} = \\frac{\\Delta x^2}{\\max_{i=0, \\dots, N-1} (\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}})}\n$$\nThe algorithm proceeds as follows for each test case:\n1.  **Grid and Profile Setup**: Set the physical and numerical constants $L, N, R, \\chi_{\\min}, \\chi_{\\text{amp}}, g_c, \\alpha, T_{\\text{edge}}$. Compute the grid spacing $\\Delta x = L/N$. Create an array of cell centers $x_i = (i+0.5)\\Delta x$ for $i=0, \\dots, N-1$. Evaluate the given initial temperature profile $T(x)$ at these cell centers to obtain the array $T_i$.\n\n2.  **Compute Face Quantities**: We need to evaluate the diffusivity $\\chi$ at all $N+1$ faces, from face $-\\frac{1}{2}$ (index $j=0$) to face $N-\\frac{1}{2}$ (index $j=N$).\n    - **Face Gradients**: An array of size $N+1$ is computed.\n        - Left boundary $(j=0)$: $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}} = 0$.\n        - Internal faces $(j=1, \\dots, N-1)$: $(\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}} = (T_j - T_{j-1})/\\Delta x$.\n        - Right boundary $(j=N)$: $(\\frac{\\partial T}{\\partial x})_{N-\\frac{1}{2}} = (T_{\\text{edge}} - T_{N-1})/\\Delta x$.\n    - **Face Temperatures**: An array of size $N+1$ is computed.\n        - Left boundary $(j=0)$: $T_{-\\frac{1}{2}} = T_0$.\n        - Internal faces $(j=1, \\dots, N-1)$: $T_{j-\\frac{1}{2}} = \\frac{1}{2}(T_j + T_{j-1})$.\n        - Right boundary $(j=N)$: $T_{N-\\frac{1}{2}} = \\frac{1}{2}(T_{N-1} + T_{\\text{edge}})$.\n    - **Face Gradient Ratio, $g$**: Using the face gradients and temperatures, compute $g_{j-\\frac{1}{2}} = -R/T_{j-\\frac{1}{2}} \\cdot (\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}}$ for all $j=0, \\dots, N$. All temperatures are assumed positive, so division by zero is not a concern.\n    - **Face Diffusivities, $\\chi$**: An array of size $N+1$ is computed using the formula $\\chi_{j-\\frac{1}{2}} = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max(0, g_{j-\\frac{1}{2}} - g_c)^{\\alpha}$. After this calculation, the value at the left boundary face is overwritten per the problem instruction: $\\chi_{-\\frac{1}{2}} = 0$.\n\n3.  **Compute Stability Denominators**: For each cell $i=0, \\dots, N-1$, the stability denominator is $D_i = \\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}$. This can be computed for all cells simultaneously using array operations on the face diffusivity array. If the face diffusivity array is `chi_faces` (indices $0, \\dots, N$), the denominator array for cells $0, \\dots, N-1$ is `chi_faces[1:] + chi_faces[:-1]`.\n\n4.  **Calculate $\\Delta t_{\\max}$**: Find the maximum value in the stability denominator array, $D_{\\max} = \\max_i D_i$. The maximum allowed time step is then $\\Delta t_{\\max} = \\Delta x^2 / D_{\\max}$. This value is the result for the test case.\n\nThis procedure is repeated for each of the four specified initial temperature profiles.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable time step for a 1D nonlinear heat diffusion\n    problem using a finite-volume method with a critical gradient model.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 1.0           # meters, slab width\n    N = 128           # number of cells\n    R = 3.0           # meters, major radius\n    chi_min = 0.30    # m^2/s, minimum diffusivity\n    chi_amp = 1.50    # m^2/s, turbulent diffusivity amplitude\n    gc = 6.0          # dimensionless, critical gradient\n    alpha = 1.0       # dimensionless, exponent\n    T_edge = 1.0      # keV, edge temperature\n\n    # --- Test Case Definitions ---\n    # Each tuple contains (T_core, profile_function_name)\n    test_cases = [\n        (15.0, \"quadratic\"),\n        (20.0, \"linear\"),\n        (2.0, \"quadratic\"),\n        (T_edge, \"uniform\") # For a uniform profile, T_core is the same as T_edge\n    ]\n\n    results = []\n\n    for T_core, profile_type in test_cases:\n        # --- Algorithm Implementation ---\n\n        # 1. Grid and Initial Profile Setup\n        dx = L / N\n        x_centers = (np.arange(N) + 0.5) * dx\n        \n        T_initial = np.zeros(N)\n        if profile_type == \"quadratic\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)**2\n        elif profile_type == \"linear\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)\n        elif profile_type == \"uniform\":\n            T_initial = np.full(N, T_edge)\n\n        # 2. Compute Face Quantities\n        # We define N+1 faces, indexed j=0...N, corresponding to\n        # physical faces at locations x_{-1/2}, x_{1/2}, ..., x_{N-1/2}.\n        grad_T_faces = np.zeros(N + 1)\n        T_faces = np.zeros(N + 1)\n\n        # Face Gradients\n        # j=0 (face -1/2): Left boundary\n        grad_T_faces[0] = 0.0\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        # Corresponds to faces x_{1/2} to x_{N-3/2}\n        grad_T_faces[1:N] = (T_initial[1:] - T_initial[:-1]) / dx\n        # j=N (face N-1/2): Right boundary\n        grad_T_faces[N] = (T_edge - T_initial[N - 1]) / dx\n        \n        # Face Temperatures\n        # j=0 (face -1/2): Left boundary\n        T_faces[0] = T_initial[0]\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        T_faces[1:N] = 0.5 * (T_initial[1:] + T_initial[:-1])\n        # j=N (face N-1/2): Right boundary\n        T_faces[N] = 0.5 * (T_initial[N - 1] + T_edge)\n        \n        # Face Gradient Ratio, g\n        # Problem assumes T > 0, so no division by zero check is needed.\n        g_faces = -R / T_faces * grad_T_faces\n\n        # Face Diffusivities, chi\n        g_factor = g_faces - gc\n        g_factor[g_factor  0] = 0.0 # This implements max(0, g - gc)\n        chi_faces = chi_min + chi_amp * (g_factor**alpha)\n\n        # Enforce special boundary condition from problem statement\n        chi_faces[0] = 0.0\n\n        # 3. Compute Stability Denominators\n        # For cell i=0...N-1, denominator is chi_{i+1/2} + chi_{i-1/2}.\n        # This maps to chi_faces[i+1] + chi_faces[i].\n        # In NumPy, this is a sum of shifted slices.\n        denominators = chi_faces[1:] + chi_faces[:-1]\n\n        # 4. Calculate dt_max\n        max_denominator = np.max(denominators)\n        \n        # Guard against division by zero, though unlikely with chi_min > 0.\n        if max_denominator > 1e-12:\n            dt_max = (dx**2) / max_denominator\n        else:\n            # If all gradients are zero, denominator is 2*chi_min (or chi_min at boundary),\n            # so this branch shouldn't be taken unless chi_min is also zero.\n            # An infinite dt implies unconditional stability.\n            dt_max = np.inf\n            \n        results.append(dt_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}