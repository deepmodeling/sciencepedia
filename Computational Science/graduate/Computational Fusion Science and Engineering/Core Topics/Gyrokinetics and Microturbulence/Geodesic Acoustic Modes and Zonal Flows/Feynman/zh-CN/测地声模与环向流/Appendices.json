{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克等离子体中，轴对称的“纬向流”对于调节湍流和输运至关重要。本练习将引导您探索一个基础性问题：一个初始的纬向电势扰动如何在无碰撞等离子体中演化。通过该练习，您将从第一性原理出发，推导能量如何在最终的稳态剩余纬向流和瞬态的测地声学模（GAM）之间分配，从而加深对由新经典极化屏蔽效应决定的罗森布鲁斯-辛顿（Rosenbluth-Hinton）剩余水平的理解 。",
            "id": "3984894",
            "problem": "考虑一个具有圆形同心磁通量面的大环径比托卡马克等离子体。其逆环径比为 $\\epsilon$，安全因子为 $q$，平衡磁场强度为 $B$。在 $t=0^{+}$ 时，施加一个具有单一径向波数 $k_r$ 的轴对称带状势扰动，产生一个磁通量面平均的静电势 $\\phi(r,t)$，其初始条件为 $\\phi(r,0^{+})=\\phi_0 \\cos(k_r r)$，且没有初始平行运动。假设离子是无碰撞的，由漂移动理学理论描述；电子是绝热的；并处于长波极限 $k_r \\rho_i \\ll 1$，其中 $\\rho_i$ 是离子拉莫尔半径。带状流通过测地曲率和离子可压缩性与测地声学模 (GAM) 耦合。\n\n使用动理学理论，推导在无碰撞极限下，初始带状势扰动如何划分为非振荡的剩余带状流分量和振荡的测地声学模 (GAM) 分量。采用以下模型选择：\n\n- 要划分的能量范数是带状流的 $\\mathbf{E}\\times\\mathbf{B}$ 动能密度，定义为 $W_E = \\frac{n_i m_i}{2} |\\mathbf{u}_E|^2$，其中 $\\mathbf{u}_E = \\frac{c}{B}\\,\\hat{\\mathbf{b}}\\times\\nabla \\phi$，$\\hat{\\mathbf{b}}$ 是沿磁场的单位矢量，$n_i$ 是离子密度，$m_i$ 是离子质量。对于单一 $k_r$ 的带状扰动，$W_E \\propto k_r^2 \\phi^2$。\n- 在大环径比、圆形磁面的极限下，与捕获离子动力学相关的新经典极化惯性会增强静态带状流响应，其增强量由无量纲参数 $\\Lambda(q,\\epsilon)$ 表征。对于绝热电子和 $k_r \\rho_i \\ll 1$ 的情况，该参数正比于 $q^2/\\sqrt{\\epsilon}$。具体来说，对于圆形同心磁通量面，取 $\\Lambda(q,\\epsilon) = \\alpha\\,\\frac{q^2}{\\sqrt{\\epsilon}}$，其中 $\\alpha=1.6$。\n\n从第一性原理出发，确定剩余带状流势的振幅 $\\phi_{\\infty}$（用 $\\phi_0$ 和 $\\Lambda$ 表示），然后使用指定的能量范数计算初始 $\\mathbf{E}\\times\\mathbf{B}$ 动能中保留在剩余带状流中的部分（记为 $f_{\\mathrm{res}}$）以及进入振荡 GAM 分量的互补部分（记为 $f_{\\mathrm{GAM}}$）。对 $q=1.5$ 和 $\\epsilon=0.16$ 的情况，数值计算这些分数。\n\n将您的数值答案四舍五入到四位有效数字。最终的能量分数以小数形式表示，不带百分号。最终答案应按顺序报告 $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$ 这两个数。",
            "solution": "用户提供的问题已经过验证，被确定为计算聚变科学与工程领域中一个有科学依据、定义明确且客观的问题。\n\n该问题要求计算初始带状势扰动的能量如何划分为长时间的剩余带状流和振荡的测地声学模 (GAM)。问题的核心在于托卡马克等离子体中的新经典极化屏蔽概念。\n\n首先，我们讨论磁通量面平均静电势 $\\phi(t)$ 的演化。在等离子体上施加一个初始势扰动 $\\phi(r, 0^+) = \\phi_0 \\cos(k_r r)$。在环形几何中，对该扰动的响应由经典和新经典极化效应共同决定。在长时间极限下 ($t \\rightarrow \\infty$)，当振荡的 GAM 分量通过无碰撞相混合而衰减后，会留下一个稳态的剩余带状流势 $\\phi_{\\infty}$。\n\n初始势 $\\phi_0$ 和剩余势 $\\phi_{\\infty}$ 之间的关系是动理学理论中的一个经典结果（由 Rosenbluth 和 Hinton 推广）。它源于建立电势的初始电荷的守恒。在初始时刻 $t=0^+$，等离子体还没有时间表现出由环形效应引起的（新经典的）效应。系统的响应由高频或经典介电电容决定，这与经典离子极化漂移有关。我们将这个快速时间尺度上的有效介电常数记为 $\\epsilon_{cl}$。初始的“未屏蔽”电荷密度扰动 $\\rho_0$ 正比于 $\\epsilon_{cl}\\nabla^2\\phi_0$。\n\n随着时间的推移，系统向一个新的稳态演化。在这个最终状态下，相同的初始电荷密度 $\\rho_0$ 现在被等离子体的完全静态介电响应 $\\epsilon_{st}$ 所屏蔽。这种静态响应既包括经典极化，也包括由环形磁场中捕获离子的动力学引起的额外新经典极化。问题用因子 $\\Lambda$ 来参数化这种新经典增强效应。因此，静态介电常数被增强了 $(1+\\Lambda)$ 倍，所以 $\\epsilon_{st} = (1+\\Lambda)\\epsilon_{cl}$。最终电势 $\\phi_{\\infty}$ 与电荷 $\\rho_0$ 的关系为 $\\rho_0 \\propto \\epsilon_{st}\\nabla^2\\phi_{\\infty}$。\n\n根据极化电荷守恒，我们有：\n$$ \\epsilon_{cl}\\nabla^2\\phi_0 = \\epsilon_{st}\\nabla^2\\phi_{\\infty} = (1+\\Lambda)\\epsilon_{cl}\\nabla^2\\phi_{\\infty} $$\n对于单一径向模，这简化为：\n$$ \\phi_0 = (1+\\Lambda)\\phi_{\\infty} $$\n由此，我们推导出剩余带状流势的振幅：\n$$ \\phi_{\\infty} = \\frac{1}{1+\\Lambda}\\phi_0 $$\n\n接下来，我们计算能量的划分。问题指定能量范数为 $\\mathbf{E}\\times\\mathbf{B}$ 动能密度 $W_E$。对于单一 $k_r$ 扰动，该能量正比于势振幅的平方：$W_E \\propto \\phi^2$。设比例常数为 $C$。\n\n在 $t=0^+$ 时的初始能量与势 $\\phi_0$ 相关：\n$$ W_{E,0} = C \\phi_0^2 $$\n问题陈述没有初始平行运动，因此这代表了系统在 $t=0^+$ 时的总能量。\n\n在 $t \\rightarrow \\infty$ 极限下，保留在剩余带状流中的能量与势 $\\phi_{\\infty}$ 相关：\n$$ W_{E,\\mathrm{res}} = C \\phi_{\\infty}^2 = C \\left(\\frac{1}{1+\\Lambda}\\phi_0\\right)^2 = \\frac{1}{(1+\\Lambda)^2} C \\phi_0^2 $$\n\n保留在剩余带状流中的初始能量分数 $f_{\\mathrm{res}}$ 是剩余能量与初始能量的比值：\n$$ f_{\\mathrm{res}} = \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = \\frac{\\frac{1}{(1+\\Lambda)^2} C \\phi_0^2}{C \\phi_0^2} = \\frac{1}{(1+\\Lambda)^2} $$\n\n系统的总能量是守恒的。初始能量 $W_{E,0}$ 被划分为最终的稳态剩余流能量 $W_{E,\\mathrm{res}}$ 和转移到振荡 GAM 分量的能量 $W_{E,\\mathrm{GAM}}$。因此，GAM 中的能量是初始能量与剩余能量之差。\n$$ W_{E,\\mathrm{GAM}} = W_{E,0} - W_{E,\\mathrm{res}} $$\n进入 GAM 的初始能量分数 $f_{\\mathrm{GAM}}$ 是：\n$$ f_{\\mathrm{GAM}} = \\frac{W_{E,\\mathrm{GAM}}}{W_{E,0}} = \\frac{W_{E,0} - W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - f_{\\mathrm{res}} $$\n代入 $f_{\\mathrm{res}}$ 的表达式：\n$$ f_{\\mathrm{GAM}} = 1 - \\frac{1}{(1+\\Lambda)^2} $$\n\n现在，我们为给定的参数计算这些分数：$q=1.5$，$\\epsilon=0.16$ 和 $\\alpha=1.6$。\n首先，我们计算无量纲新经典极化参数 $\\Lambda$：\n$$ \\Lambda = \\alpha \\frac{q^2}{\\sqrt{\\epsilon}} = 1.6 \\times \\frac{(1.5)^2}{\\sqrt{0.16}} = 1.6 \\times \\frac{2.25}{0.4} $$\n$$ \\Lambda = 4 \\times 2.25 = 9 $$\n$\\Lambda$ 的值恰好是 $9$。\n\n现在我们可以计算能量分数：\n$$ f_{\\mathrm{res}} = \\frac{1}{(1+\\Lambda)^2} = \\frac{1}{(1+9)^2} = \\frac{1}{10^2} = \\frac{1}{100} = 0.01 $$\n$$ f_{\\mathrm{GAM}} = 1 - f_{\\mathrm{res}} = 1 - 0.01 = 0.99 $$\n\n问题要求将数值答案四舍五入到四位有效数字。\n$$ f_{\\mathrm{res}} = 0.01000 $$\n$$ f_{\\mathrm{GAM}} = 0.9900 $$\n\n最终答案是序对 $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.01000  0.9900 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了剩余纬向流的物理起源之后，接下来的关键步骤是如何从复杂的模拟数据中精确地测量它。本练习将带您设计一个数值实验，模拟从回旋动理学代码输出的时间序列数据中提取罗森布鲁斯-辛顿剩余的过程。您将学习如何应用数字信号处理技术，如设计和使用带阻滤波器，以及如何通过收敛性检验来确保测量结果的可靠性与准确性 。",
            "id": "3985290",
            "problem": "设计一个独立的数值实验，用于在存在测地声模 (Geodesic Acoustic Mode, GAM) 的情况下，通过对纬向流弛豫的人工回旋动理学诊断，测量 Rosenbluth–Hinton 剩余（RH 剩余）。Rosenbluth–Hinton 剩余是指，在瞬态振荡的 GAM 响应经历相位混合而消失后，与纬向流相关的、经磁通面平均的静电势所剩余的有限的、无碰撞的长时余量。该人工诊断模拟了静电势磁通面平均值的时间演化过程，其构建旨在反映基本的回旋动理舍行为，而无需使用实际的回旋动理学求解器。\n\n从以下基本原理开始：\n- 对于纬向扰动，其无碰撞、线性、轴对称的回旋动理学响应可分解为以测地声模频率振荡的分量和与剩余纬向流相关的非振荡分量。在数学上，诊断信号可以理想化为代表剩余的恒定偏移量、以测地声模频率进行的阻尼振荡，以及小的辅助项（例如，数值漂移和噪声）之和。\n- 只要滤波器以非因果、零相位的方式应用，频域滤波器就可以从信号中移除 GAM 频带，而不会扭曲恒定的剩余偏移量。\n\n待分析的人工信号定义为，对于时间 $t \\in [0, T)$：\n$$\n\\phi(t) = \\phi_0 \\left[ R + (1 - R) \\exp(-\\alpha t) \\cos(\\omega_G t) \\right] + \\phi_0 \\, d \\, \\frac{t}{T} + \\phi_0 \\, r_{\\mathrm{noise}} \\left[ \\tfrac{1}{2} \\sin(2\\pi f_{n1} t) + \\tfrac{1}{2} \\sin(2\\pi f_{n2} t) \\right],\n$$\n其中，$R$ 是待测量的真实剩余分数，$\\phi_0$ 是初始静电势振幅，$\\alpha$ 是阻尼率，$\\omega_G$ 是测地声模角频率，$d$ 是在区间 $[0, T)$ 上的无量纲线性漂移分数，$r_{\\mathrm{noise}}$ 是无量纲噪声振幅分数，而 $f_{n1}$ 和 $f_{n2}$ 是确定性噪声频率，被选为采样率的固定分数。测量目标是使用基于滤波器的诊断方法从 $\\phi(t)$ 中估计无量纲剩余分数 $R$，并检查测量结果关于时间分辨率和滤波器带宽的收敛性。\n\n您必须实现以下测量流程：\n- 采样和单位：\n  - 在总时长 $T$（单位：$\\mathrm{s}$）内，以频率 $f_s$（单位：$\\mathrm{Hz}$）进行均匀采样，生成离散时间序列。角度使用弧度，角频率使用 $\\mathrm{rad/s}$。最终的剩余分数必须是无量纲的。\n  - 将两个确定性噪声频率定义为 $f_{n1} = 0.12 f_s$ 和 $f_{n2} = 0.20 f_s$（单位：$\\mathrm{Hz}$），以确保在不同采样率下的可复现性。\n- 滤波器设计：\n  - 计算测地声模的线性频率 $f_0 = \\omega_G/(2\\pi)$（单位：$\\mathrm{Hz}$）和 Nyquist 频率 $f_N = f_s/2$（单位：$\\mathrm{Hz}$）。\n  - 设计一个 $n$ 阶 Butterworth 带阻（陷波）滤波器，其归一化的下限和上限截止频率为\n    $$\n    w_1 = \\frac{(1 - \\beta) f_0}{f_N}, \\quad w_2 = \\frac{(1 + \\beta) f_0}{f_N},\n    $$\n    裁剪到开区间 $(0, 1)$ 内，以确保滤波器是良定义的。双向（前向-后向）应用滤波器，以实现零相移。\n- 剩余估计和平稳性：\n  - 滤波后，计算剩余估计值 $\\widehat{R}$，作为持续时间为 $T_{\\mathrm{win}}$ 秒的最后一个窗口上的平均值：\n    $$\n    \\widehat{R} = \\frac{1}{\\phi_0} \\, \\frac{1}{|\\mathcal{I}|} \\sum_{t_i \\in \\mathcal{I}} \\phi_{\\mathrm{filt}}(t_i), \\quad \\mathcal{I} = \\{ t_i \\mid t_i \\in [T - T_{\\mathrm{win}}, T) \\},\n    $$\n    其中 $\\phi_{\\mathrm{filt}}(t)$ 是滤波后的信号， $|\\mathcal{I}|$ 是窗口中的样本数。\n  - 通过对 $[T - T_{\\mathrm{win}}, T)$ 区间内的 $\\phi_{\\mathrm{filt}}(t)$ 进行线性拟合，计算其斜率 $s$（单位：$\\mathrm{V/s}$），从而评估窗口内剩余的平稳性。定义无量纲斜率比\n    $$\n    \\rho_s = \\frac{|s|}{\\phi_0 / T_{\\mathrm{win}}}.\n    $$\n    如果 $\\rho_s \\ge \\epsilon_s$，则迭代地将 $T_{\\mathrm{win}}$ 减小一半（直至最小值 $0.05 T$），如有需要则重新滤波，并重新计算，直到 $\\rho_s  \\epsilon_s$ 或达到最小窗口。使用 $\\epsilon_s$ 作为无量纲阈值。\n- 收敛性检查：\n  - 时间分辨率收敛性：使用双倍采样率 $2 f_s$ 重新计算 $\\widehat{R}$（保持 $T$ 和所有其他物理参数不变），如果满足\n    $$\n    \\left| \\widehat{R}(2 f_s) - \\widehat{R}(f_s) \\right|  \\tau_{\\mathrm{time}},\n    $$\n    则宣布收敛，其中 $\\tau_{\\mathrm{time}}$ 是一个无量纲容差。\n  - 滤波器带宽收敛性：使用第二个频带参数 $\\beta_2$ 重新计算 $\\widehat{R}$（保持原始采样率 $f_s$ 不变），如果满足\n    $$\n    \\left| \\widehat{R}(\\beta_2) - \\widehat{R}(\\beta_1) \\right|  \\tau_{\\mathrm{band}},\n    $$\n    则宣布收敛，其中 $\\beta_1$ 是主频带参数，$\\tau_{\\mathrm{band}}$ 是一个无量纲容差。\n\n将上述过程实现为一个单一、完整的程序，该程序构建人工信号，执行滤波和剩余估计，并对每个测试用例，输出一个包含估计的剩余分数以及分别表示时间分辨率和滤波器带宽收敛性检查结果的两个布尔值的列表。\n\n使用以下参数集测试套件。对于每个测试用例，参数为 $(\\phi_0 \\, [\\mathrm{V}], \\, \\omega_G \\, [\\mathrm{rad/s}], \\, \\alpha \\, [\\mathrm{s}^{-1}], \\, R, \\, r_{\\mathrm{noise}}, \\, f_s \\, [\\mathrm{Hz}], \\, T \\, [\\mathrm{s}], \\, d)$，并采用固定的滤波器和收敛性控制参数 $n = 4$, $\\beta_1 = 0.15$, $\\beta_2 = 0.25$, $T_{\\mathrm{win}} = 0.25 T$, $\\epsilon_s = 0.02$, $\\tau_{\\mathrm{time}} = 10^{-3}$ 和 $\\tau_{\\mathrm{band}} = 2 \\times 10^{-3}$：\n- 测试用例 1： $(1.0, \\, 60000, \\, 50, \\, 0.6, \\, 0.01, \\, 200000, \\, 0.2, \\, 0.005)$。\n- 测试用例 2： $(1.0, \\, 40000, \\, 5, \\, 0.3, \\, 0.05, \\, 100000, \\, 0.4, \\, 0.01)$。\n- 测试用例 3： $(0.5, \\, 80000, \\, 50, \\, 0.8, \\, 0.0, \\, 150000, \\, 0.2, \\, 0.0)$。\n- 测试用例 4： $(2.0, \\, 30000, \\, 20, \\, 0.5, \\, 0.2, \\, 100000, \\, 0.3, \\, 0.02)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个形式为 $[\\widehat{R}, \\mathrm{time\\_conv}, \\mathrm{band\\_conv}]$ 的列表，其中 $\\widehat{R}$ 是一个浮点数，两个收敛性指示符是布尔值。例如，输出格式应为\n$$\n\\texttt{[[r1,True,False],[r2,True,True],[r3,False,True],[r4,True,True]]}.\n$$\n必须遵守所有指定的物理单位，$\\omega_G$ 的频率以 $\\mathrm{rad/s}$ 表示，$f_s$ 的频率以 $\\mathrm{Hz}$ 表示，时间以 $\\mathrm{s}$ 表示，角度以弧度表示。剩余分数是无量纲的。不允许用户输入；所有参数均按上文所示进行硬编码。",
            "solution": "该问题要求设计并实现一个数值实验，从代表纬向流在测地声模 (Geodesic Acoustic Mode, GAM) 存在下弛豫的人工诊断信号中，测量 Rosenbluth–Hinton (RH) 剩余。该流程经确认为科学上合理、良定且客观。它构成了一个基于等离子体物理和数字信号处理既定原理的、定义明确的计算任务。我们接下来将详细描述解决方案的方法论，该方法论将作为一个独立的程序来实现。\n\n该方法的核心是通过滤除主要的振荡分量（即 GAM），来分离出时间序列信号中的恒定（DC）分量，该分量代表 RH 剩余。此过程包括四个主要阶段：(1) 生成人工信号；(2) 设计和应用数字滤波器；(3) 从滤波后的信号中估计剩余，包括进行平稳性检查；(4) 对时间分辨率和滤波器带宽进行收敛性研究。\n\n首先，在时间区间 $t \\in [0, T)$ 上生成一个人工诊断信号 $\\phi(t)$。该信号由以下方程定义：\n$$\n\\phi(t) = \\phi_0 \\left[ R + (1 - R) \\exp(-\\alpha t) \\cos(\\omega_G t) \\right] + \\phi_0 \\, d \\, \\frac{t}{T} + \\phi_0 \\, r_{\\mathrm{noise}} \\left[ \\tfrac{1}{2} \\sin(2\\pi f_{n1} t) + \\tfrac{1}{2} \\sin(2\\pi f_{n2} t) \\right]\n$$\n在这里，$\\phi_0$ 是初始电势振幅，$R$ 是真实的无量纲剩余分数，$\\alpha$ 是 GAM 的阻尼率，$\\omega_G$ 是 GAM 角频率，$d$ 是线性漂移系数，$r_{\\mathrm{noise}}$ 控制着两个频率为 $f_{n1}$ 和 $f_{n2}$ 的确定性高频噪声项的振幅。在数值实现中，此连续信号以均匀采样频率 $f_s$ 被离散化为一个时间序列，从而产生一组点 $\\phi(t_i)$，其中 $t_i$ 是离散时间步。噪声频率相对于采样率定义为 $f_{n1} = 0.12 f_s$ 和 $f_{n2} = 0.20 f_s$，以确保其在不同时间分辨率下的频谱位置保持一致。\n\n其次，采用一个数字滤波器来从信号中移除 GAM 振荡。GAM 的线性频率为 $f_0 = \\omega_G / (2\\pi)$。为此，选择了一个 Butterworth 带阻（或“陷波”）滤波器，因其具有最大平坦的通带响应。该滤波器为 $n$ 阶。其阻带中心位于 $f_0$ 附近，相对宽度由参数 $\\beta$ 控制。阻带的下限和上限截止频率，经 Nyquist 频率 $f_N = f_s/2$ 归一化后，由以下公式给出：\n$$\nw_1 = \\frac{(1 - \\beta) f_0}{f_N}, \\quad w_2 = \\frac{(1 + \\beta) f_0}{f_N}\n$$\n这些归一化频率必须位于开区间 $(0, 1)$ 内，以使滤波器良定义，必要时会在数值上裁剪至距边界一小段距离处。为防止引入可能破坏信号时域特征的相位失真，该滤波器通过使用零相移滤波技术进行前向-后向传递应用。这种非因果滤波能有效移除阻带内的频率分量，而不会使剩余分量在时间上发生偏移。此步骤的输出是滤波后的信号 $\\phi_{\\mathrm{filt}}(t)$。\n\n第三，从滤波后的信号中估计剩余分数 $\\widehat{R}$。理论上的剩余是电势的非振荡长时极限。我们通过在模拟结束时的一个时间窗口（从 $t=T-T_{\\mathrm{win}}$ 到 $t=T$）内对 $\\phi_{\\mathrm{filt}}(t)$ 进行平均来估计该值。估计的剩余分数计算如下：\n$$\n\\widehat{R} = \\frac{1}{\\phi_0} \\, \\frac{1}{|\\mathcal{I}|} \\sum_{t_i \\in \\mathcal{I}} \\phi_{\\mathrm{filt}}(t_i), \\quad \\text{其中 } \\mathcal{I} = \\{ t_i \\mid t_i \\in [T - T_{\\mathrm{win}}, T) \\}\n$$\n此估计的一个关键方面是确保平均窗口内的信号足够平稳（即恒定）。任何剩余的斜率都可能表明 GAM 瞬态阻尼不完全或线性漂移项的影响。通过在窗口 $[T-T_{\\mathrm{win}}, T)$ 内对 $\\phi_{\\mathrm{filt}}(t)$ 进行线性函数拟合以获得其斜率 $s$，来评估平稳性。计算一个无量纲斜率比 $\\rho_s$：\n$$\n\\rho_s = \\frac{|s|}{\\phi_0 / T_{\\mathrm{win}}}\n$$\n如果 $\\rho_s$ 大于或等于预设容差 $\\epsilon_s$，则认为窗口持续时间 $T_{\\mathrm{win}}$ 过长，并迭代地将其减半。此过程持续进行，直到 $\\rho_s  \\epsilon_s$ 或 $T_{\\mathrm{win}}$ 达到指定的最小尺寸（此处为 $0.05 T$）。滤波步骤在整个信号上只执行一次；平稳性检查仅涉及对滤波后数据的后处理。\n\n第四，执行两次收敛性检查，以验证测量的数值鲁棒性。\n时间分辨率收敛性检查评估 $\\widehat{R}$ 对采样率 $f_s$ 的敏感度。整个计算过程使用双倍采样率 $2f_s$ 重复一遍，同时保持所有其他物理参数不变。如果新估计值 $\\widehat{R}(2f_s)$ 与原始估计值 $\\widehat{R}(f_s)$ 之间的绝对差低于容差 $\\tau_{\\mathrm{time}}$，即 $|\\widehat{R}(2f_s) - \\widehat{R}(f_s)|  \\tau_{\\mathrm{time}}$，则认为测量收敛。\n滤波器带宽收敛性检查评估对滤波器阻带宽度的敏感度。使用原始采样率 $f_s$ 但采用不同的带宽参数 $\\beta_2$ 重复计算。如果使用新带宽的估计值 $\\widehat{R}(\\beta_2)$ 与原始估计值 $\\widehat{R}(\\beta_1)$ 之间的绝对差低于容差 $\\tau_{\\mathrm{band}}$，即 $|\\widehat{R}(\\beta_2) - \\widehat{R}(\\beta_1)|  \\tau_{\\mathrm{band}}$，则宣布收敛。\n\n最终的程序将实现这整个流程，遍历一套测试用例。对于每个用例，它会计算主剩余估计值 $\\widehat{R}$ 和两个布尔收敛性指示符，并按指定的列表格式输出结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef calculate_residual(params, fs_override=None, beta_override=None):\n    \"\"\"\n    Calculates the RH residual for a single parameter configuration.\n    \"\"\"\n    # Unpack parameters\n    phi0, omega_G, alpha, R, r_noise, fs_base, T, d = params\n    \n    # Fixed analysis parameters\n    n = 4\n    beta1 = 0.15\n    T_win_initial_frac = 0.25\n    T_win_min_frac = 0.05\n    eps_s = 0.02\n\n    # Apply overrides for convergence checks\n    fs = fs_override if fs_override is not None else fs_base\n    beta = beta_override if beta_override is not None else beta1\n\n    # 1. Generate Signal\n    num_points = int(T * fs)\n    t = np.linspace(0, T, num_points, endpoint=False)\n    \n    # GAM frequency in Hz\n    f0 = omega_G / (2.0 * np.pi)\n    \n    # Noise frequencies\n    f_n1 = 0.12 * fs\n    f_n2 = 0.20 * fs\n    \n    # Synthetic signal formula\n    gam_component = phi0 * (1 - R) * np.exp(-alpha * t) * np.cos(omega_G * t)\n    residual_component = phi0 * R\n    drift_component = phi0 * d * (t / T)\n    noise_component = phi0 * r_noise * (0.5 * np.sin(2 * np.pi * f_n1 * t) + 0.5 * np.sin(2 * np.pi * f_n2 * t))\n    \n    phi_t = residual_component + gam_component + drift_component + noise_component\n\n    # 2. Design and Apply Filter\n    f_nyquist = 0.5 * fs\n    \n    # Normalized cutoff frequencies, clipped to (0, 1)\n    w1 = (1 - beta) * f0 / f_nyquist\n    w2 = (1 + beta) * f0 / f_nyquist\n    w1 = max(1e-9, w1)\n    w2 = min(1.0 - 1e-9, w2)\n    \n    # Design Butterworth band-stop filter using second-order sections for stability\n    sos = signal.butter(n, [w1, w2], btype='bandstop', output='sos')\n    \n    # Apply zero-phase filter\n    phi_filt = signal.sosfiltfilt(sos, phi_t)\n\n    # 3. Stationarity Check and Residual Estimation loop\n    current_T_win = T * T_win_initial_frac\n    min_T_win = T * T_win_min_frac\n\n    while True:\n        win_samples = int(current_T_win * fs)\n        if win_samples  2: # Need at least 2 points for a line fit\n            break\n\n        t_window = t[-win_samples:]\n        phi_window = phi_filt[-win_samples:]\n        \n        # Fit a line to the data in the window\n        slope, _ = np.polyfit(t_window, phi_window, 1)\n\n        # Dimensionless slope ratio\n        rho_s = abs(slope) / (phi0 / current_T_win)\n\n        if rho_s  eps_s:\n            break\n        \n        if (current_T_win / 2.0)  min_T_win:\n            break\n        \n        current_T_win /= 2.0\n\n    # 4. Final Residual Calculation\n    final_win_samples = int(current_T_win * fs)\n    final_phi_window = phi_filt[-final_win_samples:]\n    \n    R_hat = np.mean(final_phi_window) / phi0\n    \n    return R_hat\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases: (phi0, omega_G, alpha, R, r_noise, fs, T, d)\n    test_cases = [\n        (1.0, 60000, 50, 0.6, 0.01, 200000, 0.2, 0.005),\n        (1.0, 40000, 5, 0.3, 0.05, 100000, 0.4, 0.01),\n        (0.5, 80000, 50, 0.8, 0.0, 150000, 0.2, 0.0),\n        (2.0, 30000, 20, 0.5, 0.2, 100000, 0.3, 0.02),\n    ]\n\n    # Convergence parameters\n    beta2 = 0.25\n    tau_time = 1e-3\n    tau_band = 2e-3\n\n    results = []\n    for params in test_cases:\n        fs_base = params[5]\n\n        # Base calculation\n        R_hat_base = calculate_residual(params)\n        \n        # Time-resolution convergence check\n        R_hat_time_conv = calculate_residual(params, fs_override=2 * fs_base)\n        time_conv = abs(R_hat_time_conv - R_hat_base)  tau_time\n\n        # Filter-bandwidth convergence check\n        R_hat_band_conv = calculate_residual(params, beta_override=beta2)\n        band_conv = abs(R_hat_band_conv - R_hat_base)  tau_band\n\n        results.append([R_hat_base, time_conv, band_conv])\n\n    # Format the output as specified\n    # Using map(str, ...) on the list of lists correctly formats each inner list\n    # e.g., str([0.6, True, False]) -> '[0.6, True, False]'\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个练习将深入探讨测地声学模（GAM）本身动力学的数值建模。通过构建一个描述GAM与离子平行速度分布耦合的线性化漂移动理学模型，您将研究数值参数如何影响物理结果。这项实践将使您能够亲手评估速度空间分辨率（通过厄米展开的阶数$N$体现）和碰撞算符的精度如何影响GAM的线性阻尼率，这对于验证和确认复杂的回旋动理学模拟至关重要 。",
            "id": "3985279",
            "problem": "考虑一个大环径比的圆形托卡马克等离子体，其中测地声模 (GAM) 源于轴对称（$m=0$, $n=0$）环带流通过测地曲率与平行可压缩性的耦合。从离子种类的线性漂移动理学方程出发，该方程使用麦克斯韦平衡分布，并用简化的 Lenard–Bernstein 算符模拟碰撞。令 $f(\\mathbf{v},t)$ 为离子分布函数，$F_M(\\mathbf{v})$ 为稳态麦克斯韦分布，$g(\\mathbf{v},t) = f(\\mathbf{v},t) - F_M(\\mathbf{v})$ 为微扰。在长波极限 $k_\\perp \\rho_i \\ll 1$ 和轴对称微扰下，线性化动力学可以用归一化平行速度 $v_\\parallel / v_{ti}$ 的 Hermite 谱展开来表示，其中 $v_{ti}$ 是离子热速度。\n\n定义 Hermite 系数 $h_n(t)$，使得微扰 $g$ 在 Hermite 基 $H_n$ 上的投影形式为 $g(v_\\parallel,t) = \\sum_{n=0}^{N-1} h_n(t) H_n(v_\\parallel / v_{ti}) F_M$。平行流算符将相邻的 Hermite 矩与特征流频率 $\\omega_s = k_\\parallel v_{ti}$ 耦合；对于 GAM，有效平行波数可取为 $k_\\parallel = 1/(qR)$，其中 $q$ 为安全因子，$R$ 为大半径，因此 $\\omega_s = v_{ti}/(qR)$。测地声模表现为静电势 $\\Phi(t)$ 的振荡，其特征频率 $\\Omega_G$ 由测地曲率和压力平衡决定；在大环径比的圆形几何中，一个合理的标度关系是 $\\Omega_G = \\sqrt{G} \\, v_{ti} / R$，其中 $G$ 是一个无量纲几何因子。GAM 通过测地可压缩性和 $E \\times B$ 流惯性与平行速度矩耦合。\n\n为状态向量 $\\mathbf{y}(t) = [\\Phi(t), \\psi(t), h_0(t), h_1(t), \\dots, h_{N-1}(t)]^\\top$ 建立一阶形式的耦合线性系统模型，其中 $\\psi(t) = d\\Phi/dt$。该系统为\n$$\n\\frac{d\\Phi}{dt} = \\psi,\n$$\n$$\n\\frac{d\\psi}{dt} = -\\Omega_G^2 \\, \\Phi - \\lambda \\, h_1,\n$$\n$$\n\\frac{dh_0}{dt} = -\\omega_s \\sqrt{1} \\, h_1 - \\nu \\, \\Lambda_0 \\, h_0,\n$$\n$$\n\\frac{dh_1}{dt} = -\\omega_s \\left( \\sqrt{2} \\, h_2 + \\sqrt{1} \\, h_0 \\right) - \\nu \\, \\Lambda_1 \\, h_1 - \\kappa \\, \\psi,\n$$\n$$\n\\frac{dh_n}{dt} = -\\omega_s \\left( \\sqrt{n+1} \\, h_{n+1} + \\sqrt{n} \\, h_{n-1} \\right) - \\nu \\, \\Lambda_n \\, h_n \\quad \\text{对于 } n \\ge 2.\n$$\n使用在 $n = N - 1$ 处的截断，并以 $h_N \\equiv 0$ 作为闭合。常数定义如下：\n- $\\omega_s = v_{ti} / (q R)$ 是平行流频率标度。\n- $\\Omega_G = \\sqrt{G} \\, v_{ti} / R$ 是测地声模频率标度。\n- $\\lambda = \\omega_s^2$ 参数化了从平行流矩 $h_1$ 回到 GAM 振荡器的耦合。\n- $\\kappa = \\omega_s$ 参数化了从 GAM 时间导数 $\\psi$ 到平行流矩 $h_1$ 的耦合，代表测地可压缩性。\n- $\\nu$ 是碰撞频率。\n- $\\Lambda_n$ 编码了碰撞算符的精度：对于守恒密度和动量的高精度算符，设置 $\\Lambda_0 = 0$、$\\Lambda_1 = 0$ 以及对于 $n \\ge 2$ 设置 $\\Lambda_n = n$；对于低精度算符（非守恒扩散），对所有 $n \\ge 0$ 设置 $\\Lambda_n = n$。\n\n该线性系统可以写成矩阵形式 $d\\mathbf{y}/dt = \\mathbf{M} \\, \\mathbf{y}$，其中 $\\mathbf{M}$ 是一个大小为 $(2+N) \\times (2+N)$ 的常系数矩阵。$\\mathbf{M}$ 的本征值 $\\lambda_j$ 描述了线性模；在耦合可忽略的极限下，GAM 对应于 $\\pm i \\Omega_G$ 附近的本征值对。在有耦合和碰撞的情况下，相关的本征值是复数，$\\lambda_\\mathrm{GAM} = \\gamma + i \\omega$，其中 $\\omega$ 是接近 $\\Omega_G$ 的振荡频率，$\\gamma$ 是阻尼率（预期为负）。通过改变 $N$ 和 $\\Lambda_n$ 的选择来评估数值对速度空间分辨率和碰撞算符精度的敏感性。\n\n任务：\n- 为给定的参数 $(N, \\nu, q, R, v_{ti}, G)$ 和指定 $\\Lambda_n$ 的碰撞算符精度标志构建 $\\mathbf{M}$。\n- 计算所有本征值 $\\lambda_j$。\n- 将类 GAM 本征值识别为虚部为正且最接近 $\\Omega_G$ 的那个（在所有 $\\mathrm{Im}(\\lambda_j)  0$ 的本征值中最小化 $|\\mathrm{Im}(\\lambda_j) - \\Omega_G|$）。如果没有本征值的虚部为正，则选择最小化 $|\\mathrm{Im}(\\lambda_j) - \\Omega_G|$ 的那个。\n- 报告每个测试用例的阻尼率 $\\gamma = \\mathrm{Re}(\\lambda_\\mathrm{GAM})$。\n\n以 $\\mathrm{s}^{-1}$ 为单位表示阻尼率。\n\n您的程序必须实现以上步骤，并生成单行输出，其中包含指定测试套件的阻尼率的逗号分隔列表，并用方括号括起来。\n\n使用以下参数集测试套件 $(N, \\nu, \\text{acc}, q, R, v_{ti}, G)$:\n1. $(16, 0.0, 1, 2.0, 1.7, 1.5 \\times 10^5, 1.6)$\n2. $(8, 0.0, 0, 2.0, 1.7, 1.5 \\times 10^5, 1.6)$\n3. $(64, 1.0 \\times 10^3, 1, 1.5, 1.7, 2.0 \\times 10^5, 1.4)$\n4. $(32, 1.0 \\times 10^4, 1, 2.5, 1.7, 1.2 \\times 10^5, 1.8)$\n5. $(128, 0.0, 1, 2.0, 1.7, 1.5 \\times 10^5, 1.6)$\n\n您的程序应生成单行输出，其中包含以逗号分隔的列表形式的结果，并用方括号括起来（例如，“[result1,result2,result3,result4,result5]”），每个结果都是一个浮点数，代表相应测试用例的 GAM 阻尼率 $\\gamma$（单位为 $\\mathrm{s}^{-1}$）。",
            "solution": "经评估，用户提供的问题是有效的。它在科学上基于成熟的等离子体微不稳定性理论，特别是托卡马克中测地声模（GAM）的线性动力学。该问题是良定的，提供了一套完整的线性常微分方程、参数定义和一个明确的数值目标。所有术语都有定义，且其前提与聚变等离子体物理学中的标准模型一致。任务是构建一个表示系统动力学的矩阵，计算其本征值，并根据明确的物理准则识别一个特定的模。这是计算物理学中一个标准且有意义的问题。\n\n求解过程如下。首先，我们为线性常微分方程组 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{M} \\, \\mathbf{y}$ 构建系数矩阵 $\\mathbf{M}$。状态向量为 $\\mathbf{y}(t) = [\\Phi(t), \\psi(t), h_0(t), h_1(t), \\dots, h_{N-1}(t)]^\\top$，其维度为 $D=N+2$。因此，矩阵 $\\mathbf{M}$ 的大小将为 $D \\times D$。我们将状态向量的分量映射到索引 $0, 1, \\dots, N+1$，使得 $y_0 = \\Phi$，$y_1 = \\psi$，并且对于 $k \\in [2, N+1]$ 有 $y_{k} = h_{k-2}$。\n\n给定的方程组是：\n$$\n\\frac{d\\Phi}{dt} = \\psi\n$$\n$$\n\\frac{d\\psi}{dt} = -\\Omega_G^2 \\, \\Phi - \\lambda \\, h_1\n$$\n$$\n\\frac{dh_0}{dt} = -\\omega_s \\sqrt{1} \\, h_1 - \\nu \\, \\Lambda_0 \\, h_0\n$$\n$$\n\\frac{dh_1}{dt} = -\\omega_s \\left( \\sqrt{2} \\, h_2 + \\sqrt{1} \\, h_0 \\right) - \\nu \\, \\Lambda_1 \\, h_1 - \\kappa \\, \\psi\n$$\n$$\n\\frac{dh_n}{dt} = -\\omega_s \\left( \\sqrt{n+1} \\, h_{n+1} + \\sqrt{n} \\, h_{n-1} \\right) - \\nu \\, \\Lambda_n \\, h_n \\quad \\text{对于 } n \\ge 2\n$$\n闭合条件是 $h_N \\equiv 0$。\n\n根据这些方程，我们构建矩阵 $\\mathbf{M}$，其元素 $M_{i,j}$ 满足 $\\frac{dy_i}{dt} = \\sum_{j=0}^{N+1} M_{i,j} y_j$。$\\mathbf{M}$ 的非零元素如下：\n\n1.  由 $\\frac{dy_0}{dt} = y_1$（即 $\\frac{d\\Phi}{dt} = \\psi$）可得：\n    $M_{0,1} = 1$\n\n2.  由 $\\frac{dy_1}{dt} = -\\Omega_G^2 y_0 - \\lambda y_3$（即 $\\frac{d\\psi}{dt} = -\\Omega_G^2 \\Phi - \\lambda h_1$）可得：\n    $M_{1,0} = -\\Omega_G^2$\n    $M_{1,3} = -\\lambda$\n\n3.  由 $\\frac{dy_2}{dt} = -\\nu \\Lambda_0 y_2 - \\omega_s \\sqrt{1} y_3$（即 $\\frac{dh_0}{dt} = -\\nu \\Lambda_0 h_0 - \\omega_s h_1$）可得：\n    $M_{2,2} = -\\nu \\Lambda_0$\n    $M_{2,3} = -\\omega_s \\sqrt{1}$\n\n4.  由 $\\frac{dy_3}{dt} = -\\kappa y_1 - \\omega_s \\sqrt{1} y_2 - \\nu \\Lambda_1 y_3 - \\omega_s \\sqrt{2} y_4$（即 $\\frac{dh_1}{dt}$）可得：\n    $M_{3,1} = -\\kappa$\n    $M_{3,2} = -\\omega_s \\sqrt{1}$\n    $M_{3,3} = -\\nu \\Lambda_1$\n    $M_{3,4} = -\\omega_s \\sqrt{2}$（如果 $N  3$，此项为零）\n\n5.  对于 $n \\ge 2$，由 $\\frac{dh_n}{dt}$（对应于 $\\frac{dy_{n+2}}{dt}$）可得：\n    $\\frac{dy_{n+2}}{dt} = -\\omega_s \\sqrt{n} y_{n+1} - \\nu \\Lambda_n y_{n+2} - \\omega_s\\sqrt{n+1} y_{n+3}$\n    这给出了从 $4$ 到 $N+1$ 行（$i=n+2$）的次对角线、对角线和超对角线元素。\n    对于 $n \\in [2, N-2]$:\n    $M_{n+2, n+1} = -\\omega_s \\sqrt{n}$\n    $M_{n+2, n+2} = -\\nu \\Lambda_n$\n    $M_{n+2, n+3} = -\\omega_s \\sqrt{n+1}$\n\n6.  对于最后一个 Hermite 矩，$n=N-1$，应用闭合条件 $h_N=0$：\n    $\\frac{dh_{N-1}}{dt} = -\\omega_s \\sqrt{N-1} h_{N-2} - \\nu \\Lambda_{N-1} h_{N-1}$，这转换为：\n    $\\frac{dy_{N+1}}{dt} = -\\omega_s \\sqrt{N-1} y_N - \\nu \\Lambda_{N-1} y_{N+1}$\n    这决定了矩阵的最后一行：\n    $M_{N+1, N} = -\\omega_s \\sqrt{N-1}$\n    $M_{N+1, N+1} = -\\nu \\Lambda_{N-1}$\n\n参数 $\\omega_s$、$\\Omega_G$、$\\lambda$ 和 $\\kappa$ 由主要输入 $(q, R, v_{ti}, G)$ 计算得出。碰撞系数 $\\Lambda_n$ 由精度标志 `acc` 确定。\n\n对于给定的测试用例，一旦构建了矩阵 $\\mathbf{M}$，就可以数值计算其本征值 $\\lambda_j$。本征值代表系统线性模的复频率，$\\lambda_j = \\gamma_j + i\\omega_j$。问题要求的是 GAM 的阻尼率 $\\gamma$。GAM 被识别为频率 $\\omega$ 最接近 GAM 特征频率标度 $\\Omega_G$ 的模。选择标准是在所有虚部为正的本征值中，找到使 $|\\mathrm{Im}(\\lambda_j) - \\Omega_G|$ 最小化的本征值 $\\lambda_{\\mathrm{GAM}}$。如果不存在这样的本征值，则在所有本征值中进行搜索。所识别本征值的实部 $\\gamma = \\mathrm{Re}(\\lambda_{\\mathrm{GAM}})$ 即为阻尼率。\n\n实现将对测试套件中的每个参数集遵循这些步骤。首先使用物理参数计算矩阵系数，然后构建矩阵，找到其本征值，选择 GAM 本征值，并报告其实部。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_damping(params):\n    \"\"\"\n    Constructs the system matrix M and calculates the GAM damping rate.\n\n    Args:\n        params (tuple): A tuple containing the parameters for a single test case:\n                        (N, nu, acc, q, R, vti, G).\n\n    Returns:\n        float: The calculated GAM damping rate gamma in s^-1.\n    \"\"\"\n    N, nu, acc, q, R, vti, G = params\n    \n    # Calculate derived parameters\n    omega_s = vti / (q * R)\n    Omega_G = np.sqrt(G) * vti / R\n    lmbda = omega_s**2\n    kappa = omega_s\n\n    # Define collision coefficients Lambda_n\n    Lambda = np.zeros(N)\n    if acc == 1:  # High-accuracy operator\n        if N > 0: Lambda[0] = 0.0\n        if N > 1: Lambda[1] = 0.0\n        if N > 2: Lambda[2:] = np.arange(2, N)\n    else:  # Low-accuracy operator\n        if N > 0: Lambda[:] = np.arange(N)\n\n    # Initialize the (N+2) x (N+2) matrix M\n    dim = N + 2\n    M = np.zeros((dim, dim))\n\n    # Populate the matrix M based on the system of ODEs\n    \n    # Equation for d(Phi)/dt\n    if 1  dim:\n        M[0, 1] = 1.0\n\n    # Equation for d(psi)/dt\n    if 0  dim:\n        M[1, 0] = -Omega_G**2\n    if 3  dim:\n        M[1, 3] = -lmbda\n\n    # Equation for dh_0/dt\n    if 2  dim:\n        M[2, 2] = -nu * Lambda[0]\n        if 3  dim:\n            M[2, 3] = -omega_s * np.sqrt(1)\n\n    # Equation for dh_1/dt\n    if 3  dim:\n        M[3, 1] = -kappa\n        M[3, 2] = -omega_s * np.sqrt(1)\n        M[3, 3] = -nu * Lambda[1]\n        if 4  dim:\n            M[3, 4] = -omega_s * np.sqrt(2)\n\n    # Equations for dh_n/dt for n >= 2\n    # This corresponds to rows i >= 4\n    for n in range(2, N):\n        i = n + 2\n        # Coupling to h_{n-1}\n        M[i, i - 1] = -omega_s * np.sqrt(n)\n        # Collisional term for h_n\n        M[i, i] = -nu * Lambda[n]\n        # Coupling to h_{n+1}, with closure h_N=0\n        if (n + 1)  N:\n            M[i, i + 1] = -omega_s * np.sqrt(n + 1)\n\n    # Compute eigenvalues of M\n    eigenvalues = np.linalg.eigvals(M)\n\n    # Identify the GAM eigenvalue\n    # Criterion: eigenvalue with positive imaginary part closest to Omega_G\n    pos_imag_eigs = [e for e in eigenvalues if e.imag > 0]\n\n    if pos_imag_eigs:\n        # Find the one minimizing |Im(lambda) - Omega_G| among those with Im(lambda) > 0\n        gam_eigenvalue = min(pos_imag_eigs, key=lambda e: abs(e.imag - Omega_G))\n    else:\n        # If no eigenvalues have positive imaginary part, search all eigenvalues\n        gam_eigenvalue = min(eigenvalues, key=lambda e: abs(e.imag - Omega_G))\n\n    # The damping rate is the real part of the GAM eigenvalue\n    damping_rate = gam_eigenvalue.real\n    \n    return damping_rate\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Test suite: (N, nu, acc, q, R, vti, G)\n    # N: Hermite truncation number\n    # nu: collision frequency (s^-1)\n    # acc: collision operator accuracy flag (1 for high, 0 for low)\n    # q: safety factor\n    # R: major radius (m)\n    # vti: ion thermal speed (m/s)\n    # G: dimensionless geometry factor\n    test_cases = [\n        (16, 0.0, 1, 2.0, 1.7, 1.5e5, 1.6),\n        (8, 0.0, 0, 2.0, 1.7, 1.5e5, 1.6),\n        (64, 1.0e3, 1, 1.5, 1.7, 2.0e5, 1.4),\n        (32, 1.0e4, 1, 2.5, 1.7, 1.2e5, 1.8),\n        (128, 0.0, 1, 2.0, 1.7, 1.5e5, 1.6),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_damping(case)\n        results.append(result)\n\n    # Print the final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}