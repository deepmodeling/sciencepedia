## Introduction
Understanding and predicting turbulent transport is a central challenge in developing fusion energy. Gyrokinetic theory offers a powerful first-principles framework for this task by simulating plasma turbulence. However, a critical choice arises in its application: the selection between simplified, local flux-tube models and comprehensive, global formulations, each with its own domain of validity and computational cost. This decision dictates which physical phenomena can be accurately captured, from local instabilities to large-scale transport events.

This article provides a guide to navigating this choice by dissecting the two approaches. The first chapter, **Principles and Mechanisms**, delves into the foundational [gyrokinetic ordering](@entry_id:1125860) and contrasts the local assumptions of the [flux-tube model](@entry_id:1125143) with the more complete physics of the global formulation, including the crucial role of trapped-[particle dynamics](@entry_id:1129385). The second chapter, **Applications and Interdisciplinary Connections**, explores how these models are implemented computationally and applied to key fusion science problems, highlighting when nonlocal effects captured only by global models become essential. Finally, **Hands-On Practices** offers practical exercises to solidify understanding of the core concepts, bridging theory with application.

## Principles and Mechanisms

The gyrokinetic framework provides a reduced yet powerful description of plasma turbulence by systematically eliminating the fastest timescale in a magnetized plasma—the particle gyromotion—while retaining the essential physics of low-frequency microinstabilities. This reduction is achieved through a rigorous [asymptotic expansion](@entry_id:149302). Understanding the principles of this expansion, and the subsequent development of simplified ([flux-tube](@entry_id:1125141)) and comprehensive (global) models, is foundational to modern [computational fusion science](@entry_id:1122784). This chapter elucidates the core principles and mechanisms underpinning these formulations.

### The Gyrokinetic Ordering: A Foundation of Scale Separation

The validity of the [gyrokinetic model](@entry_id:1125859) rests on a fundamental [separation of scales](@entry_id:270204). The dynamics of interest, such as drift waves and other [microinstabilities](@entry_id:751966), evolve on timescales much longer than a particle's cyclotron period and have spatial scales much larger than the Larmor radius, yet much smaller than the overall device size. This hierarchy of scales is formalized through the **[gyrokinetic ordering](@entry_id:1125860)**, where all relevant quantities are ordered with respect to a single small parameter, $\epsilon = \rho / L \ll 1$. Here, $\rho$ is the characteristic thermal Larmor radius, and $L$ is the macroscopic scale length over which equilibrium quantities like density and temperature vary. Several key orderings emerge from physical first principles .

First, to justify averaging over the fast gyromotion, the characteristic frequency of the turbulence, $\omega$, must be much lower than the cyclotron frequency, $\Omega = qB/m$. This low-frequency condition is formally expressed as:
$$
\frac{\omega}{\Omega} \sim \mathcal{O}(\epsilon)
$$
This ordering ensures that the magnetic field experienced by a particle changes only by a small amount over a single gyro-period, which is a prerequisite for the conservation of the particle's magnetic moment, $\mu = m v_{\perp}^{2}/(2 B)$, to leading order. The conservation of $\mu$ is the cornerstone of [guiding-center theory](@entry_id:1125840), upon which gyrokinetics is built.

Second, turbulence in magnetized plasmas is inherently anisotropic. Fluctuations tend to have very short correlation lengths across the magnetic field but very long correlation lengths along it. This is because particles stream rapidly along field lines but are confined to tight helical orbits in the perpendicular direction. This physical picture is captured by ordering the ratio of parallel to perpendicular wavenumbers, $k_{\parallel}$ and $k_{\perp}$, as:
$$
\frac{k_{\parallel}}{k_{\perp}} \sim \mathcal{O}(\epsilon)
$$
This scaling arises from two complementary physical arguments. To retain the crucial Finite Larmor Radius (FLR) effects, which mediate the interaction between particles and waves, the perpendicular scale of the turbulence must be comparable to the Larmor radius, expressed as $k_{\perp} \rho \sim \mathcal{O}(1)$. Concurrently, a "critical balance" is assumed to exist, where the time for a thermal particle to stream along a parallel wavelength, $(k_{\parallel} v_{\mathrm{th}})^{-1}$, is of the same order as the fluctuation period, $\omega^{-1}$. This implies $\omega \sim k_{\parallel} v_{\mathrm{th}}$. Combining these relations with the low-frequency ordering $\omega \sim \epsilon \Omega$ and the definition $\rho \sim v_{\mathrm{th}}/\Omega$, we find that $k_{\parallel}/k_{\perp} \sim \epsilon$, confirming the strong anisotropy.

Third, for plasmas with significant thermal pressure relative to magnetic pressure (i.e., plasma beta $\beta = 2 \mu_{0} n T / B^{2} \sim \mathcal{O}(1)$), the magnetic field lines can be bent by the plasma motion. In such electromagnetic turbulence, the amplitude of the magnetic field fluctuations, $\delta B$, is related to the perpendicular flow fluctuations, $\delta u_{\perp}$, through the Alfvén [wave polarization](@entry_id:262733), $|\delta u_{\perp}|/v_A \sim |\delta B_{\perp}|/B$, where $v_A$ is the Alfvén speed. A mixing-length estimate for the fluctuation amplitude yields $|\delta u_{\perp}| \sim \omega/k_{\perp} \sim \epsilon v_{\mathrm{th}}$. For $\beta \sim \mathcal{O}(1)$, the thermal speed is comparable to the Alfvén speed ($v_{\mathrm{th}} \sim v_A$). This leads to the ordering for [magnetic fluctuations](@entry_id:1127582):
$$
\frac{\delta B}{B} \sim \mathcal{O}(\epsilon)
$$
These three orderings—for frequency, anisotropy, and amplitude—form a self-consistent asymptotic framework that defines the standard gyrokinetic model for electromagnetic turbulence in moderate-beta plasmas .

### The Flux-Tube Formulation: A Local Model

The most direct application of the scale [separation principle](@entry_id:176134) $\rho \ll L$ is the **[flux-tube](@entry_id:1125141) formulation**. This model isolates a small, radially localized "tube" of plasma that follows a magnetic field line as it winds around the torus. By assuming that the equilibrium profiles are approximately constant within this narrow tube, the complex global problem is reduced to a more tractable local one. This local approximation is formalized mathematically using the **ballooning representation**, which maps the problem onto an infinite domain along the magnetic field line.

A critical feature of [toroidal geometry](@entry_id:756056) captured within the [flux-tube model](@entry_id:1125143) is **magnetic shear**, $\hat{s} = (r/q)dq/dr$, which quantifies the radial variation of the magnetic field line pitch. Magnetic shear has a profound effect on the mode structure. In the ballooning representation, it causes the effective radial wavenumber of a fluctuation to vary with the poloidal angle $\theta$. For a mode with binormal wavenumber $k_y$ and a radial wavenumber $k_{x0}$ at the outboard midplane ($\theta=0$), the squared perpendicular wavenumber evolves along the field line as :
$$
k_{\perp}^2(\theta) = k_y^2 + (k_{x0} + \hat{s} k_y \theta)^2
$$
This expression reveals that $k_{\perp}$ increases quadratically away from the mode's center in ballooning space. Since FLR damping effects are proportional to $k_{\perp}\rho$, this shear-induced variation strongly damps the mode at large $|\theta|$, effectively localizing the [eigenmode](@entry_id:165358) poloidally near the outboard midplane where the instability drive is typically strongest.

The validity of this elegant local model hinges on several strict criteria  . First, the radial width of the turbulent eddies, $\Delta r$, must be much smaller than the equilibrium scale length $L$. This condition, $\Delta r \ll L$, justifies the Taylor expansion of equilibrium profiles and treating their gradients as constant. The error incurred by this approximation scales as $\mathcal{O}(\Delta r / L)$. Second, the radial variation of the local mode frequency must not be so strong as to tear the mode apart before it can grow; this is the condition of weak [profile shearing](@entry_id:1130216). Third, the turbulent structures must be radially small compared to the device minor radius $a$, a condition expressed as $k_x a \gg 1$, where $k_x$ is the characteristic radial wavenumber. This ensures that the turbulence does not "feel" the global boundaries of the plasma.

Computationally, [flux-tube](@entry_id:1125141) simulations employ periodic boundary conditions in the directions perpendicular to the magnetic field. A consequence of this periodic topology is that the net flux of any quantity, including free energy, across the domain boundaries is identically zero. The evolution of the system is therefore determined solely by the balance of volumetric sources (from local gradients) and sinks (from dissipation) .

### Trapped-Particle Dynamics and Bounce-Averaging

In a [toroidal magnetic field](@entry_id:756057), which is stronger on the inboard side and weaker on the outboard side, particles with a low ratio of parallel to perpendicular velocity become trapped in a magnetic well on the outboard side. These **trapped particles** execute a "banana-shaped" drift orbit, bouncing between two turning points. Their dynamics are fundamentally different from **passing particles**, which circulate freely around the torus.

The motion of trapped particles involves two disparate timescales: a fast bounce motion between turning points (with frequency $\omega_b$) and a slow precession of the entire banana orbit around the torus (with frequency $\omega_d$). For low-frequency turbulence where $\omega \ll \omega_b$, it is possible to average the gyrokinetic equation over the fast [bounce motion](@entry_id:1121799). This procedure, known as **bounce-averaging**, greatly simplifies the kinetic response of trapped particles  .

The most significant consequence of bounce-averaging is that the parallel streaming term, which represents the rapid motion along the field line, averages to zero over a complete bounce orbit:
$$
\langle v_{\parallel} \nabla_{\parallel} h \rangle_b = 0
$$
where $h$ is the perturbed distribution function. This is because the particle traverses its orbit in both parallel directions, and the requirement that $h$ be single-valued ensures the contributions cancel. The physical implication is that the parallel Landau resonance, a key [wave-particle interaction](@entry_id:195662) mechanism for passing particles, is eliminated for trapped particles.

Instead, a new resonance emerges. After bounce-averaging, the linear [gyrokinetic equation](@entry_id:1125856) for trapped electrons yields a non-adiabatic response of the form :
$$
\langle h_e \rangle_b = \frac{e F_{0e}}{T_e} \frac{\omega - \omega_{*e}^T}{\omega - \langle \omega_{de} \rangle_b} \phi
$$
Here, $\langle h_e \rangle_b$ is the bounce-averaged non-adiabatic response, $\omega_{*e}^T$ is the electron diamagnetic frequency (related to the free energy in the pressure gradient), and $\langle \omega_{de} \rangle_b$ is the bounce-averaged magnetic precession drift frequency. The denominator reveals the new resonance condition:
$$
\omega \approx \langle \omega_{de} \rangle_b
$$
This resonance, where the wave frequency matches the toroidal precession frequency of the trapped electrons, is the primary drive mechanism for the **Trapped Electron Mode (TEM)**, a ubiquitous instability in tokamak plasmas.

### The Global Formulation: A Comprehensive Description

While the [flux-tube model](@entry_id:1125143) offers invaluable insights, its foundational assumption of locality is a simplification. The **global formulation** is a more fundamental approach that relinquishes this assumption. Global simulations solve the gyrokinetic equations over a large radial domain, often spanning a significant fraction of the plasma minor radius, and retain the full, explicit radial dependence of all equilibrium profiles, such as density $n_0(r)$, temperature $T_0(r)$, and safety factor $q(r)$ .

The inclusion of profile variation fundamentally changes the character of the problem. The operators in the gyrokinetic equation now contain coefficients that vary with the [radial coordinate](@entry_id:165186) $r$. For example, the free-energy drive term depends on local gradients like $\kappa_n(r) = -d(\ln n_0)/dr$, and the magnetic drift velocities depend on the local geometry determined by $q(r)$. This explicit radial dependence breaks the radial [translational symmetry](@entry_id:171614) that is the cornerstone of the [flux-tube model](@entry_id:1125143). Mathematically, this means that different radial Fourier modes are no longer independent; they become coupled. An equation that is algebraic in the radial wavenumber $k_r$ in a [flux-tube model](@entry_id:1125143) becomes a differential or integral equation in a global model, capturing **[nonlocal coupling](@entry_id:1128879)** between different radial locations.

This structural difference necessitates a different approach to boundary conditions . Instead of the artificial periodicity of the flux-tube, global simulations must implement physically motivated boundary conditions. At the radial boundaries of the simulation domain, **absorbing layers** are often used. These are artificial damping regions that absorb outgoing fluctuation energy, preventing unphysical reflections and mimicking an open, infinite domain. At the parallel boundaries, especially in simulations of the plasma edge, **sheath boundary conditions** are employed to model the physical contact with material surfaces like a divertor plate.

Both absorbing layers and sheaths act as energy sinks. They permit a net flux of free energy out of the simulation domain, a crucial piece of physics absent from periodic flux-tube models. This boundary flux appears as a sink term in the system's free-energy balance, providing a damping mechanism that can lower instability growth rates and significantly alter the overall dynamics of the turbulence.

### Domains of Validity: When to Use Flux-Tube vs. Global Models

The choice between a [flux-tube](@entry_id:1125141) and a global formulation is dictated by the physical problem at hand, specifically by how well the assumption of scale separation holds.

In the core of a typical tokamak plasma, equilibrium gradients are often gentle, meaning the scale length $L$ is much larger than the ion gyroradius $\rho_i$. Here, the scale separation $\rho_i \ll L$ is well-satisfied. A turbulent eddy with a radial width $\Delta r$ is typically much smaller than $L$, so the condition $\Delta r/L \ll 1$ holds. In this regime, a [flux-tube simulation](@entry_id:1125144) provides a good leading-order approximation for the local [linear instability](@entry_id:1127282) growth rates and turbulent characteristics .

However, this local picture can break down even in the core when considering large-scale [transport phenomena](@entry_id:147655). Turbulent energy is not confined to the region where it is generated; it can propagate radially. This leads to phenomena like **[turbulence spreading](@entry_id:1133499)** and **avalanches**. The characteristic scale of this [nonlocal transport](@entry_id:1128882), $\lambda_E$, can become comparable to or even larger than the equilibrium scale length $L$. In a scenario where numerical estimates give $\lambda_E \approx 0.15 \, \mathrm{m}$ while $L = 0.05 \, \mathrm{m}$, the ratio $\lambda_E/L = 3$ indicates a strong violation of locality. The turbulent flux at a given point depends on the plasma state over a wide region where the background gradients themselves vary significantly. Capturing such dynamics is impossible within a local framework and requires a global simulation .

The most prominent example of where [flux-tube](@entry_id:1125141) models fail and global simulations are essential is the **edge pedestal** of a high-confinement (H-mode) plasma. This region is characterized by extremely steep pressure gradients, where the equilibrium scale length $L_r$ can become comparable to the ion gyroradius $\rho_i$. In a representative pedestal, one might find $L_r \approx 5 \, \mathrm{mm}$ and $\rho_i \approx 3 \, \mathrm{mm}$, giving $\rho_i/L_r \sim \mathcal{O}(1)$ . Here, the fundamental gyrokinetic scale-separation assumption is violated. A turbulent eddy of size $\ell_r \sim 2\rho_i \approx 6 \, \mathrm{mm}$ spans a region where the background profiles change by an order-one amount. Consequently, the concepts of a constant gradient drive and periodic boundaries become invalid. Simulating pedestal turbulence requires a global formulation that retains the full profile variation and incorporates realistic boundary physics, such as open-field-line losses modeled by sheath conditions, which represent a dominant energy sink in this region. Furthermore, the large radial excursions of trapped-particle [banana orbits](@entry_id:202619) ($\Delta_b$) can become a non-negligible fraction of $L_r$, providing an additional mechanism for [nonlocal coupling](@entry_id:1128879) through finite-orbit-width (FOW) effects that are naturally included in global models .

In summary, while the [flux-tube model](@entry_id:1125143) is an indispensable tool for understanding local instability mechanisms in regions of gentle gradients, the global formulation provides the more complete and fundamental description required for phenomena involving [nonlocal coupling](@entry_id:1128879), large-scale transport events, and regions of strong profile variation like the plasma edge.