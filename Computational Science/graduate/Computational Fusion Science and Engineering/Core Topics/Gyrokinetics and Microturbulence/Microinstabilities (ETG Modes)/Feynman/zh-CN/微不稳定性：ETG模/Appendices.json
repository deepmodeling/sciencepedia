{
    "hands_on_practices": [
        {
            "introduction": "许多描述电子温度梯度（ETG）模的模型都依赖于准中性近似，该近似通过忽略电荷分离效应（即德拜屏蔽）来简化控制方程。这个练习将通过推导和计算，帮助你理解这一关键近似为何以及何时成立。你将把准中性条件与 $k_{\\perp} \\lambda_{D} \\ll 1$ 联系起来，并利用典型的托卡马克参数来验证其有效性 ()。",
            "id": "4011292",
            "problem": "在托卡马克的核心区，电子温度梯度（ETG）微观不稳定性发生在由电子回旋半径物理学表征的垂直尺度上。在回旋动理学和流体描述中，一个关键的简化是忽略德拜屏蔽，这通常概括为条件 $k_{\\perp} \\lambda_{D} \\ll 1$，其中 $k_{\\perp}$ 是垂直波数，$\\lambda_{D}$ 是电子德拜长度。从第一性原理出发，使用泊松方程和线性化的等温电子响应，解释为什么在 $k_{\\perp} \\lambda_{D} \\ll 1$ 的情况下，代表静电真空极化的项与等离子体极化相比可以忽略不计，从而证明在该级数关系下ETG动力学中的准中性是合理的。\n\n然后，对于一个典型的托卡马克核心区，其电子密度 $n_{e} = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$，电子温度 $T_{e} = 2.0\\,\\mathrm{keV}$，磁场强度 $B = 1.5\\,\\mathrm{T}$，使用基本常数估算电子德拜长度 $\\lambda_{D}$。你可以取基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，真空介电常数 $\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，以及电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。作为背景，假设ETG湍流满足 $k_{\\perp} \\rho_{e} \\approx 0.3$，其中 $\\rho_{e}$ 是电子拉莫尔半径，定义为 $\\rho_{e} = v_{\\mathrm{th},e}/\\Omega_{ce}$，$v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$，以及 $\\Omega_{ce} = e B/m_{e}$。使用你对 $\\lambda_{D}$ 的估算值来计算 $k_{\\perp} \\lambda_{D}$，并说明级数关系 $k_{\\perp} \\lambda_{D} \\ll 1$ 是否满足。\n\n将你对 $\\lambda_{D}$ 的最终数值估算四舍五入到三位有效数字，并以米为单位表示。最终报告的答案必须仅为 $\\lambda_{D}$ 的值。",
            "solution": "该问题被评估为有效，因为它在科学上基于等离子体物理学原理，问题设定良好、客观且内部一致。它提出了一个与聚变等离子体中微观不稳定性研究相关的标准理论推导和实际数值计算。\n\n根据要求，解答分为两部分：首先，对准中性近似的理论论证；其次，基于所提供的托卡马克参数进行数值估算。\n\n### 准中性的论证\n\n等离子体中的静电势与电荷密度之间的关系由泊松方程决定。对于形式为 $\\tilde{\\phi}(\\mathbf{x}) = \\tilde{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$ 的静电扰动，其中 $\\tilde{\\phi}$ 是电势振幅，$\\mathbf{k}$ 是波矢量，拉普拉斯算子 $\\nabla^2$ 变为 $-k^2$。我们关注垂直于磁场的动力学，使用垂直波数 $k_{\\perp}$。傅里叶空间中的泊松方程为：\n$$\n-k_{\\perp}^2 \\tilde{\\phi} = -\\frac{\\tilde{\\rho}_{\\text{charge}}}{\\epsilon_0}\n$$\n其中 $\\tilde{\\rho}_{\\text{charge}}$ 是扰动电荷密度，$\\epsilon_0$ 是真空介电常数。电荷密度由离子和电子贡献，$\\tilde{\\rho}_{\\text{charge}} = e(\\tilde{n}_i - \\tilde{n}_e)$，对于具有单电荷离子（$Z=1$）的等离子体。将此代入泊松方程，得到：\n$$\n\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi} = e(\\tilde{n}_e - \\tilde{n}_i)\n$$\n该方程表明，等离子体中的净电荷分离 $e(\\tilde{n}_i - \\tilde{n}_e)$ 与项 $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$ 相平衡，后者可以解释为与真空中电势结构相关的电荷密度。问题将此项称为“静电真空极化”。目标是证明在条件 $k_{\\perp} \\lambda_D \\ll 1$ 下，此项可以忽略不计。\n\n问题指定使用线性化的等温电子响应。对于沿磁力线移动的电子，其密度扰动 $\\tilde{n}_e$ 通常被假定遵循与静电势扰动 $\\tilde{\\phi}$ 的玻尔兹曼关系。该关系的线性化形式是：\n$$\n\\frac{\\tilde{n}_e}{n_{e0}} = \\frac{e \\tilde{\\phi}}{T_e}\n$$\n其中 $n_{e0}$ 是平衡电子密度， $T_e$ 是以能量单位（焦耳）表示的电子温度。这使我们能够用电势来表示扰动电子电荷密度 $\\rho_{e,k} = -e\\tilde{n}_e$：\n$$\n-e \\tilde{n}_e = - \\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}\n$$\n右边的量是“等离子体极化”的一个组成部分。现在，让我们回到泊松方程，重写为：\n$$\ne(\\tilde{n}_i - \\tilde{n}_e) = \\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}\n$$\n右边的项 $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$ 代表傅里叶空间中的净电荷密度涨落。让我们将此净电荷密度的大小与电子电荷密度涨落的大小 $|-e\\tilde{n}_e|$ 进行比较：\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-e \\tilde{n}_e|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-\\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}|} = \\frac{\\epsilon_0 k_{\\perp}^2 T_e}{n_{e0} e^2}\n$$\n我们确定电子德拜长度 $\\lambda_D$，其定义关系为：\n$$\n\\lambda_D^2 = \\frac{\\epsilon_0 T_e}{n_{e0} e^2}\n$$\n将此定义代入我们的比率，得到：\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = k_{\\perp}^2 \\lambda_D^2 = (k_{\\perp} \\lambda_D)^2\n$$\n问题陈述了级数关系 $k_{\\perp} \\lambda_D \\ll 1$。在此极限下，$(k_{\\perp} \\lambda_D)^2 \\ll 1$。这意味着：\n$$\n|\\text{net charge density}| \\ll |\\text{electron charge density}|\n$$\n就粒子数密度而言，这意味着 $|e(\\tilde{n}_i - \\tilde{n}_e)| \\ll |-e \\tilde{n}_e|$。这只有在离子和电子的电荷扰动几乎相互抵消时才成立，即 $e \\tilde{n}_i \\approx e \\tilde{n}_e$，从而导出准中性条件：\n$$\n\\tilde{n}_i \\approx \\tilde{n}_e\n$$\n因此，条件 $k_{\\perp} \\lambda_D \\ll 1$ 证明了与单个粒子种类的电荷扰动（“等离子体极化”）相比，忽略净电荷分离（“真空极化”项）是合理的，这直接导致了在许多流体和回旋动理学模型中使用的准中性近似。\n\n### 数值估算与验证\n\n接下来，我们针对给定的托卡马克核心区参数计算相关量。给定的参数是：\n- 电子密度：$n_e = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- 电子温度：$T_e = 2.0\\,\\mathrm{keV}$\n- 磁场：$B = 1.5\\,\\mathrm{T}$\n\n首先，我们将电子温度转换为国际单位制（焦耳）。单位keV代表能量，因此我们使用基本电荷进行转换。\n$$\nT_e [\\mathrm{J}] = (2.0 \\times 10^3\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\n注意，由于 $T_e$ 是以能量单位给出的，标准公式中的 $k_B T_e$ 项将被此值替代。\n\n**1. 电子德拜长度 ($\\lambda_D$)**\n德拜长度的公式为 $\\lambda_D = \\sqrt{\\epsilon_0 T_e / (n_e e^2)}$，其中 $T_e$ 的单位是焦耳。\n$$\n\\lambda_D = \\sqrt{\\frac{(8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{(2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}}\n$$\n$$\n\\lambda_D \\approx 2.35082 \\times 10^{-5}\\,\\mathrm{m}\n$$\n四舍五入到三位有效数字，电子德拜长度为 $\\lambda_D = 2.35 \\times 10^{-5}\\,\\mathrm{m}$。\n\n**2. 级数关系 $k_{\\perp} \\lambda_D \\ll 1$ 的验证**\n为了检验这个级数关系，我们首先需要估算 $k_{\\perp}$。根据背景信息，对于ETG湍流，$k_{\\perp} \\rho_e \\approx 0.3$，其中 $\\rho_e$ 是电子拉莫尔半径。我们必须计算 $\\rho_e = v_{\\mathrm{th},e} / \\Omega_{ce}$。\n\n电子热速度由 $v_{\\mathrm{th},e} = \\sqrt{2 T_e / m_e}$ 给出（其中 $T_e$ 的单位是焦耳）：\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}}} \\approx 2.65241 \\times 10^7\\,\\mathrm{m/s}\n$$\n电子回旋频率为 $\\Omega_{ce} = e B / m_e$：\n$$\n\\Omega_{ce} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1.5\\,\\mathrm{T})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}} \\approx 2.63819 \\times 10^{11}\\,\\mathrm{rad/s}\n$$\n因此，电子拉莫尔半径为：\n$$\n\\rho_e = \\frac{v_{\\mathrm{th},e}}{\\Omega_{ce}} = \\frac{2.65241 \\times 10^7\\,\\mathrm{m/s}}{2.63819 \\times 10^{11}\\,\\mathrm{s}^{-1}} \\approx 1.00539 \\times 10^{-4}\\,\\mathrm{m}\n$$\n使用ETG模的典型值 $k_{\\perp} \\rho_e = 0.3$，我们求得 $k_{\\perp}$：\n$$\nk_{\\perp} = \\frac{0.3}{\\rho_e} = \\frac{0.3}{1.00539 \\times 10^{-4}\\,\\mathrm{m}} \\approx 2983.9\\,\\mathrm{m}^{-1}\n$$\n最后，我们可以计算乘积 $k_{\\perp} \\lambda_D$：\n$$\nk_{\\perp} \\lambda_D = (2983.9\\,\\mathrm{m}^{-1}) \\times (2.35082 \\times 10^{-5}\\,\\mathrm{m}) \\approx 0.07015\n$$\n结果是 $k_{\\perp} \\lambda_D \\approx 0.07$。由于 $0.07 \\ll 1$，对于托卡马克核心区中这些典型的ETG不稳定性参数，该级数关系得到了很好的满足。这证实了准中性近似是研究该区域ETG湍流的一种高度准确且合理的简化方法。\n\n要求作为最终答案的具体值是 $\\lambda_D$ 的数值估算。",
            "answer": "$$\n\\boxed{2.35 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "在回旋动理学理论中，回旋平均是一个关键概念，它描述了电子有限轨道尺寸对波动的影响，并在数学上引入了贝塞尔函数因子 $J_{0}(k_{\\perp} \\rho_{e})$。为了确保数值模拟的准确性，我们必须能够精确地解析这个函数的结构。这个练习将提供一个具体的方法，指导你如何确定波数空间中模拟所需的网格分辨率 ()。",
            "id": "4011222",
            "problem": "在电子温度梯度（ETG）驱动的湍流的非线性回旋动理学模拟中，垂直速度空间回旋平均因子以零阶第一类贝塞尔函数 $J_{0}(k_{\\perp} \\rho_{e})$ 的形式出现，其中 $k_{\\perp}$ 是垂直波数，$\\rho_{e}$ 是电子热回旋半径。考虑一种谱离散化方法，该方法使用一个均匀的垂直波数网格，该网格包含从 $k_{\\perp}=0$ 到 $k_{\\perp}=k_{\\max}$ 的 $N_{\\perp}$ 个点（包括两个端点）。为了确保数值网格既能跨越回旋平均响应的峰值和尾部，又能解析其振荡，请采用以下具有科学依据的要求：\n\n- 峰-尾跨度：选择 $k_{\\max}$，使得 $k_{\\perp} \\rho_{e}$ 的范围从 $0$（$J_{0}$ 的峰值）跨越到 $J_{0}$ 的第五个正零点，即 $k_{\\max} \\rho_{e} = j_{0,5}$，其中 $j_{0,5}$ 表示 $J_{0}(s)$ 的第五个正根。对于本题，使用已知数值 $j_{0,5} = 14.930917$。\n\n- 振荡分辨率：在渐近尾部，$J_{0}(s)$ 在 $s \\doteq k_{\\perp} \\rho_{e}$ 中的局部振荡尺度约为 $\\pi$（即，连续零点之间的间距趋向于 $\\pi$）。施加一个分辨率标准，即在尾部附近每个振荡周期至少有 $q=20$ 个网格点。\n\n假设 $k_{\\perp}$ 网格是均匀的，因此 $s$ 中的间距为 $\\Delta s = \\rho_{e} \\Delta k_{\\perp} = \\frac{k_{\\max} \\rho_{e}}{N_{\\perp}-1}$，请确定满足上述标准的 $N_{\\perp}$ 的最小整数值。请以整数形式提供您的答案。不需要单位。",
            "solution": "该问题要求确定在回旋动理学模拟中使用的均匀垂直波数网格的最小整数网格点数 $N_{\\perp}$，且该网格需满足两个特定的分辨率标准。\n\n首先，让我们将问题陈述形式化。\n涉及的物理量是垂直波数 $k_{\\perp}$ 和电子热回旋半径 $\\rho_{e}$。模拟网格在 $k_{\\perp}$ 空间中定义，范围从 $k_{\\perp}=0$ 到最大值 $k_{\\perp}=k_{\\max}$，有 $N_{\\perp}$ 个均匀分布的点。定义一个无量纲变量 $s \\doteq k_{\\perp} \\rho_{e}$。因此，$s$ 空间中的网格范围从 $s=0$ 到 $s_{\\max} = k_{\\max} \\rho_{e}$。由于 $k_{\\perp}$ 中的网格是均匀的且包含端点，其间距 $\\Delta k_{\\perp}$ 为 $\\frac{k_{\\max}}{N_{\\perp}-1}$。因此，$s$ 空间中的间距 $\\Delta s$ 由下式给出：\n$$\n\\Delta s = \\rho_{e} \\Delta k_{\\perp} = \\rho_{e} \\frac{k_{\\max}}{N_{\\perp}-1} = \\frac{k_{\\max} \\rho_{e}}{N_{\\perp}-1} = \\frac{s_{\\max}}{N_{\\perp}-1}\n$$\n\n我们有两个标准来确定网格参数。\n\n第一个标准是“峰-尾跨度”要求。这将无量纲波数的最大值 $s_{\\max}$ 设置为等于零阶第一类贝塞尔函数 $J_{0}(s)$ 的第五个正根。该根表示为 $j_{0,5}$。\n$$\ns_{\\max} = k_{\\max} \\rho_{e} = j_{0,5}\n$$\n题目提供了数值 $j_{0,5} = 14.930917$。因此，需要离散化的 $s$ 的范围是 $[0, 14.930917]$。\n\n第二个标准是“振荡分辨率”要求。它规定在函数 $J_{0}(s)$ 的渐近（尾部）区域，每个振荡周期网格必须至少有 $q=20$ 个点。题目指明该区域的局部振荡尺度（波长）约为 $\\pi$。这意味着在变量 $s$ 中长度为 $\\pi$ 的区间内，必须至少有 $q$ 个网格点。\n设 $N_{osc}$ 是一个振荡长度 $\\pi$ 内的网格点数。对于一个间距为 $\\Delta s$ 的网格，在长度为 $L$ 的区间内的点数是 $L/\\Delta s$。因此，我们可以将此条件表示为：\n$$\nN_{osc} = \\frac{\\pi}{\\Delta s} \\geq q\n$$\n\n现在我们将这两个条件结合起来求解 $N_{\\perp}$。我们有 $\\Delta s$ 关于 $s_{\\max}$ 和 $N_{\\perp}$ 的表达式：\n$$\n\\Delta s = \\frac{s_{\\max}}{N_{\\perp}-1}\n$$\n将此代入分辨率不等式中，得到：\n$$\n\\frac{\\pi}{\\left(\\frac{s_{\\max}}{N_{\\perp}-1}\\right)} \\geq q\n$$\n重新整理这个不等式以求解 $N_{\\perp}$：\n$$\n\\frac{\\pi (N_{\\perp}-1)}{s_{\\max}} \\geq q\n$$\n$$\nN_{\\perp}-1 \\geq \\frac{q \\cdot s_{\\max}}{\\pi}\n$$\n$$\nN_{\\perp} \\geq 1 + \\frac{q \\cdot s_{\\max}}{\\pi}\n$$\n\n现在，我们代入题目中提供的数值：$q=20$ 和 $s_{\\max} = j_{0,5} = 14.930917$。\n$$\nN_{\\perp} \\geq 1 + \\frac{20 \\times 14.930917}{\\pi}\n$$\n$$\nN_{\\perp} \\geq 1 + \\frac{298.61834}{\\pi}\n$$\n使用 $\\pi \\approx 3.14159265$ 的值，我们可以计算出分数的值：\n$$\n\\frac{298.61834}{\\pi} \\approx 95.05340\n$$\n将此值代回关于 $N_{\\perp}$ 的不等式中：\n$$\nN_{\\perp} \\geq 1 + 95.05340\n$$\n$$\nN_{\\perp} \\geq 96.05340\n$$\n\n题目要求满足此条件的 $N_{\\perp}$ 的最小整数值。大于或等于 $96.05340$ 的最小整数是 $97$。\n因此，所需的最小网格点数为 $N_{\\perp} = 97$。\n这确保了波数网格跨越了从 $s=0$ 到 $J_0(s)$ 第五个零点的所需范围，并且函数在尾部区域的振荡以每个振荡周期至少20个点的分辨率被解析。",
            "answer": "$$\\boxed{97}$$"
        },
        {
            "introduction": "在环形几何位形中，ETG模的结构并非均匀不变，而是会沿着磁力线发生变化，其变化规律由一个类似于量子力学中薛定谔方程的方程所描述。这个练习将要求你构建一个简单的数值求解器，来计算这种“气球模”的结构。通过求解，你将能直观地看到磁剪切和曲率是如何影响不稳定性的形态，并判断其是局域化的还是延展的 ()。",
            "id": "4011253",
            "problem": "您的任务是使用气球模形式论，设计并实现一个用于求解环形几何中电子温度梯度（ETG）微观不稳定性模结构的数值求解器。任务是计算沿气球模坐标的模结构，并将该模分类为局限在外侧中平面附近（定域模）或沿场线延展的模。本问题中所有物理量均采用无量纲回旋动理学归一化，因此不需要物理单位。\n\n从均匀磁通管中静电ETG涨落的线性回旋动理学气球模简化出发，其中模结构是沿磁场线的气球模角坐标 $\\theta$ 的函数。通常，由磁剪切引起的垂直波数变化可以用以下关系式建模：\n$$k_{\\perp}(\\theta)^2 = k_y^2\\left( 1 + s^2\\,\\theta^2 \\right),$$\n其中 $k_y$ 是副法向波数，$s$ 是磁剪切。有限拉莫尔半径效应引入了一个与 $k_{\\perp}(\\theta)^2$ 成正比的稳定项，而环曲率和电子温度梯度驱动则在靠近外侧中平面 $\\theta = 0$ 的坏曲率区附近产生一个有效的局域化不稳定贡献。\n\n基于这些具有物理动机的要素，构建并求解关于静电势模结构 $\\phi(\\theta)$ 的一维类薛定谔本征值问题：\n$$-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta)\\,\\phi(\\theta) = \\lambda\\,\\phi(\\theta),$$\n该问题定义在有限区间 $\\theta \\in [-\\theta_{\\max},\\theta_{\\max}]$ 上，并采用齐次狄利克雷边界条件 $\\phi(-\\theta_{\\max}) = \\phi(\\theta_{\\max}) = 0$。有效势 $V(\\theta)$ 定义为：\n$$V(\\theta) = \\beta\\,\\big(1 + s^2\\,\\theta^2\\big) - D\\,\\exp\\!\\left(-\\frac{\\theta^2}{\\theta_w^2}\\right),$$\n其中 $\\beta = (k_y\\,\\rho_e)^2$，$\\rho_e$ 是归一化中使用的电子拉莫尔半径，$D$ 是曲率和梯度驱动的振幅（$D$ 越大，驱动越强），$\\theta_w$ 是围绕 $\\theta=0$ 的坏曲率驱动的特征宽度。该模型捕捉了由磁剪切和有限拉莫尔半径引起的稳定化垂直尺度增长与局限在 $\\theta = 0$ 附近的不稳定化曲率驱动之间的竞争。\n\n您的程序必须：\n- 使用二阶中心有限差分格式对二阶导数进行离散化，在均匀网格上离散算子 $-\\mathrm{d}^2/\\mathrm{d}\\theta^2 + V(\\theta)$。通过仅在内部网格点上构建离散算子来施加齐次狄利克雷边界条件。\n- 计算基态本征对 $(\\lambda_0,\\phi_0(\\theta))$，其中 $\\lambda_0$ 是最小的代数本征值，$\\phi_0$ 是其对应的归一化本征函数，满足：\n$$\\sum_{i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta = 1,$$\n其中 $\\Delta\\theta$ 是网格间距，$\\theta_i$ 是网格点。\n- 使用以下规则将模分类为定域或流光状：计算比值\n$$\\mathcal{F} = \\frac{\\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}{\\sum_{\\text{all } i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta},$$\n其中核心窗口为 $|\\theta| \\le \\theta_c$。如果 $\\mathcal{F} \\ge T$，则判定该模在 $\\theta = 0$ 附近是定域的；否则，判定其表现为延展的流光。使用 $\\theta_c = 0.8$ 和阈值 $T = 0.55$。\n- 对于所有计算，使用一个包含端点在内共 $N$ 个点的均匀网格，并使用内部点进行算子组装。您可以选择任何能够得到数值稳定解的合理 $N$ 值，但该选择在所有测试用例中必须保持一致。\n\n测试套件：\n请提供以下四组参数集的结果，每组参数指定为 $(s,\\;k_y\\,\\rho_e,\\;D,\\;\\theta_w,\\;\\theta_{\\max})$：\n1. $s = 0.7$, $k_y\\,\\rho_e = 0.4$, $D = 3.0$, $\\theta_w = 0.8$, $\\theta_{\\max} = 5.0$.\n2. $s = 0.05$, $k_y\\,\\rho_e = 0.2$, $D = 1.2$, $\\theta_w = 2.5$, $\\theta_{\\max} = 8.0$.\n3. $s = 0.3$, $k_y\\,\\rho_e = 0.3$, $D = 1.8$, $\\theta_w = 1.3$, $\\theta_{\\max} = 6.0$.\n4. $s = 0.8$, $k_y\\,\\rho_e = 0.7$, $D = 2.0$, $\\theta_w = 0.7$, $\\theta_{\\max} = 5.0$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的分类结果。结果按顺序排列，格式为一个用方括号括起来的、逗号分隔的Python布尔值列表，例如 $[True,False,\\dots]$，其中 $\\text{True}$ 表示在 $\\theta = 0$ 附近定域，$\\text{False}$ 表示延展的流光。不应打印任何额外文本。",
            "solution": "所提出的问题是计算等离子体物理学中一个有效、适定且科学上合理的练习。它要求数值求解一个一维类薛定谔本征值问题，这是使用气球模形式论研究环形聚变等离子体中电子温度梯度（ETG）微观不稳定性的一个标准简化模型。所有必需的参数、方程和边界条件都已提供，并且没有违反任何科学原理。\n\n问题的核心是求解静电势模结构 $\\phi(\\theta)$ 的本征值方程：\n$$\n-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta)\\,\\phi(\\theta) = \\lambda\\,\\phi(\\theta)\n$$\n该方程定义在区域 $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$ 上，并采用齐次狄利克雷边界条件 $\\phi(\\pm\\theta_{\\max}) = 0$。势 $V(\\theta)$ 由下式给出：\n$$\nV(\\theta) = \\beta\\,\\big(1 + s^2\\,\\theta^2\\big) - D\\,\\exp\\! \\left(-\\frac{\\theta^2}{\\theta_w^2}\\right)\n$$\n其中 $\\beta = (k_y\\,\\rho_e)^2$。该方程模拟了与 $\\beta(1 + s^2\\theta^2)$ 成正比的稳定项（代表因磁剪切导致的垂直波数 $k_\\perp$ 增加）和与 $D$ 成正比的不稳定驱动项（局域在 $\\theta=0$ 附近的坏曲率区域）之间的竞争。\n\n为了数值求解此问题，我们将在均匀网格上离散化微分算子，并将微分方程转换为矩阵本征值问题。\n\n首先，我们在区域 $[-\\theta_{\\max}, \\theta_{\\max}]$ 上定义一个包含 $N$ 个点的均匀网格。设网格点为 $\\theta_i = -\\theta_{\\max} + i\\,\\Delta\\theta$，其中 $i=0, 1, \\dots, N-1$，网格间距为 $\\Delta\\theta = \\frac{2\\theta_{\\max}}{N-1}$。为了保证数值稳定性和准确性，需要足够多的网格点。我们选择 $N=1001$，这能确保所有测试用例都有一个精细的网格，并包含 $\\theta=0$ 这个点。\n\n在每个内部网格点 $\\theta_j$ (其中 $j=1, \\dots, N-2$) 上，我们使用二阶中心有限差分格式来近似二阶导数 $\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}\\theta^2}$：\n$$\n\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} \\bigg|_{\\theta_j} \\approx \\frac{\\phi(\\theta_{j+1}) - 2\\phi(\\theta_j) + \\phi(\\theta_{j-1})}{(\\Delta\\theta)^2} = \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2}\n$$\n将此代入内部点 $\\theta_j$ 的薛定谔方程，得到：\n$$\n-\\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2} + V(\\theta_j)\\phi_j = \\lambda \\phi_j\n$$\n整理各项，我们得到：\n$$\n-\\frac{1}{(\\Delta\\theta)^2}\\phi_{j-1} + \\left(\\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\\right)\\phi_j - \\frac{1}{(\\Delta\\theta)^2}\\phi_{j+1} = \\lambda \\phi_j\n$$\n齐次狄利克雷边界条件为 $\\phi_0 = 0$ 和 $\\phi_{N-1} = 0$。通过仅为 $N-2$ 个内部点构建方程组来强制施加这些条件。$j=1$ 的方程涉及到 $\\phi_0=0$，$j=N-2$ 的方程涉及到 $\\phi_{N-1}=0$。这产生了一个矩阵本征值问题 $A\\mathbf{x} = \\lambda\\mathbf{x}$，其中 $\\mathbf{x} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-2}]^T$ 是本征函数在内部点上的值构成的向量。矩阵 $A$ 是一个大小为 $(N-2) \\times (N-2)$ 的实对称三对角矩阵，其元素如下：\n$$\nA_{jj} = \\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\n$$\n$$\nA_{j, j+1} = A_{j+1, j} = -\\frac{1}{(\\Delta\\theta)^2}\n$$\n我们寻求基态本征对 $(\\lambda_0, \\phi_0)$，其中 $\\lambda_0$ 是 $A$ 的最小本征值。这可以使用数值线性代数库高效计算。我们将使用专门为此类矩阵优化的 `scipy.linalg.eigh_tridiagonal` 函数。它返回按升序排列的本征值及其对应的本征向量。\n\n设与 $\\lambda_0$ 对应的本征向量为 $\\mathbf{v}_0$。此向量包含本征函数在内部点的值。根据边界条件，通过在两端补零来构造网格上的完整、未归一化的本征函数：$\\vec{\\phi}_{\\text{unnormalized}} = [0, v_{0,1}, \\dots, v_{0, N-2}, 0]^T$。\n\n下一步是根据条件 $\\sum_{i=0}^{N-1} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta = 1$ 对本征函数进行归一化。归一化常数 $C$ 通过要求 $C^2 \\sum_{i=0}^{N-1} |\\phi_{\\text{unnormalized},i}|^2\\,\\Delta\\theta = 1$ 来找到。然后，归一化的本征函数为 $\\vec{\\phi}_0 = C \\cdot \\vec{\\phi}_{\\text{unnormalized}}$。\n\n最后，我们对模结构进行分类。我们计算在核心窗口 $|\\theta| \\le \\theta_c = 0.8$ 内包含的模的“概率密度”分数 $\\mathcal{F}$：\n$$\n\\mathcal{F} = \\frac{\\sum\\limits_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}{\\sum\\limits_{\\text{all } i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}\n$$\n由于我们的归一化，分母为1。因此，计算简化为 $\\mathcal{F} = \\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta$。如果 $\\mathcal{F} \\ge T=0.55$，则该模被分类为“定域”的，否则为“延展”的。对测试套件中提供的每组参数重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the ETG mode structure problem for the given test cases.\n    \"\"\"\n    # Test Suite: Each tuple is (s, k_y*rho_e, D, theta_w, theta_max)\n    test_cases = [\n        (0.7, 0.4, 3.0, 0.8, 5.0),\n        (0.05, 0.2, 1.2, 2.5, 8.0),\n        (0.3, 0.3, 1.8, 1.3, 6.0),\n        (0.8, 0.7, 2.0, 0.7, 5.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        is_loc = is_mode_localized(*params)\n        results.append(is_loc)\n\n    # Final print statement in the exact required format.\n    # The map(str,...) converts boolean True/False to \"True\"/\"False\" string literals.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef is_mode_localized(s, ky_rho_e, D, theta_w, theta_max):\n    \"\"\"\n    Solves the 1D Schrödinger eigenvalue problem for a single parameter set and\n    classifies the ground state mode as localized or extended.\n\n    Args:\n        s (float): Magnetic shear.\n        ky_rho_e (float): Normalized binormal wavenumber.\n        D (float): Drive amplitude.\n        theta_w (float): Width of the drive.\n        theta_max (float): Boundary of the ballooning coordinate domain.\n\n    Returns:\n        bool: True if the mode is localized, False otherwise.\n    \"\"\"\n    # Numerical and classification parameters\n    N = 1001  # Number of grid points (must be odd to include theta=0)\n    theta_c = 0.8  # Core window half-width for classification\n    T = 0.55  # Threshold for localization classification\n\n    # 1. Set up the grid\n    theta = np.linspace(-theta_max, theta_max, N)\n    delta_theta = theta[1] - theta[0]\n\n    # We solve for the eigenfunction on the interior points\n    theta_interior = theta[1:-1]\n\n    # 2. Construct the potential V(theta)\n    beta = ky_rho_e**2\n    V = beta * (1.0 + s**2 * theta_interior**2) - D * np.exp(-(theta_interior**2) / theta_w**2)\n\n    # 3. Construct the tridiagonal matrix for the operator -d^2/d(theta)^2 + V\n    # The matrix A is defined by its diagonal (d) and off-diagonal (e) elements.\n    d = 2.0 / delta_theta**2 + V\n    e = -1.0 / delta_theta**2 * np.ones(N - 3) # Off-diagonal has N-3 elements\n\n    # 4. Solve the eigenvalue problem\n    # eigh_tridiagonal returns eigenvalues sorted in ascending order and corresponding\n    # normalized eigenvectors.\n    eigenvalues, eigenvectors = eigh_tridiagonal(d, e)\n\n    # The ground state is the one with the smallest eigenvalue (the first one)\n    ground_state_vector = eigenvectors[:, 0]\n\n    # 5. Reconstruct and normalize the full eigenfunction\n    # Add zeros at the boundaries for phi(-theta_max) and phi(theta_max)\n    phi_full = np.concatenate(([0.0], ground_state_vector, [0.0]))\n\n    # Normalize the eigenfunction such that sum(|phi|^2 * delta_theta) = 1\n    # This is a numerical integration of |phi|^2 over the domain.\n    norm_integral = np.sum(phi_full**2) * delta_theta\n    phi_normalized = phi_full / np.sqrt(norm_integral)\n\n    # 6. Classify the mode\n    # Find indices within the core window |theta| = theta_c\n    core_indices = np.where(np.abs(theta) = theta_c)[0]\n\n    # Calculate the fraction F. The denominator is 1 due to normalization.\n    F = np.sum(phi_normalized[core_indices]**2) * delta_theta\n\n    # Compare with a threshold T to classify\n    return F >= T\n\n# Execute the solver\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}