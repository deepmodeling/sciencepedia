{
    "hands_on_practices": [
        {
            "introduction": "Advanced plasma models often rely on key simplifying assumptions to remain tractable. This practice explores the validity of the quasi-neutrality approximation, a cornerstone of theories for low-frequency instabilities like Electron Temperature Gradient (ETG) modes. By deriving the condition from first principles and performing a calculation for a typical tokamak plasma, you will gain a quantitative understanding of why we can neglect charge separation effects for the scales relevant to ETG turbulence .",
            "id": "4011292",
            "problem": "In the core of a tokamak, Electron Temperature Gradient (ETG) microinstabilities occur at perpendicular scales characterized by electron gyroradius physics. A key simplification in gyrokinetic and fluid descriptions is the neglect of Debye shielding, often summarized by the condition $k_{\\perp} \\lambda_{D} \\ll 1$, where $k_{\\perp}$ is the perpendicular wavenumber and $\\lambda_{D}$ is the electron Debye length. Starting from first principles, use Poisson’s equation and the linearized isothermal electron response to explain why the term representing electrostatic vacuum polarization is negligible compared to the plasma polarization for $k_{\\perp} \\lambda_{D} \\ll 1$, thereby justifying quasi-neutrality in ETG dynamics under this ordering.\n\nThen, for a typical tokamak core with electron density $n_{e} = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$, electron temperature $T_{e} = 2.0\\,\\mathrm{keV}$, and magnetic field strength $B = 1.5\\,\\mathrm{T}$, estimate the electron Debye length $\\lambda_{D}$ using fundamental constants. You may take the elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, vacuum permittivity $\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}$, Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$, and electron mass $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$. For context, assume ETG turbulence with $k_{\\perp} \\rho_{e} \\approx 0.3$, where $\\rho_{e}$ is the electron Larmor radius defined by $\\rho_{e} = v_{\\mathrm{th},e}/\\Omega_{ce}$, $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$, and $\\Omega_{ce} = e B/m_{e}$. Use your $\\lambda_{D}$ estimate to evaluate $k_{\\perp} \\lambda_{D}$ and state whether the ordering $k_{\\perp} \\lambda_{D} \\ll 1$ is satisfied. \n\nRound your final numerical estimate of $\\lambda_{D}$ to three significant figures and express it in meters. The final reported answer must be only the value of $\\lambda_{D}$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of plasma physics, well-posed, objective, and internally consistent. It presents a standard theoretical derivation and a practical numerical calculation relevant to the study of microinstabilities in fusion plasmas.\n\nThe solution is presented in two parts as requested: first, a theoretical justification for the quasi-neutrality approximation, and second, a numerical estimation based on the provided tokamak parameters.\n\n### Justification of Quasi-Neutrality\n\nThe relationship between the electrostatic potential and the charge density in a plasma is governed by Poisson's equation. For electrostatic perturbations of the form $\\tilde{\\phi}(\\mathbf{x}) = \\tilde{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$, where $\\tilde{\\phi}$ is the potential amplitude and $\\mathbf{k}$ is the wavevector, the Laplacian operator $\\nabla^2$ becomes $-k^2$. Focusing on dynamics perpendicular to the magnetic field, we use the perpendicular wavenumber $k_{\\perp}$. Poisson's equation in Fourier space is:\n$$\n-k_{\\perp}^2 \\tilde{\\phi} = -\\frac{\\tilde{\\rho}_{\\text{charge}}}{\\epsilon_0}\n$$\nwhere $\\tilde{\\rho}_{\\text{charge}}$ is the perturbed charge density and $\\epsilon_0$ is the vacuum permittivity. The charge density is contributed by ions and electrons, $\\tilde{\\rho}_{\\text{charge}} = e(\\tilde{n}_i - \\tilde{n}_e)$, for a plasma with singly charged ions ($Z=1$). Substituting this into Poisson's equation gives:\n$$\n\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi} = e(\\tilde{n}_e - \\tilde{n}_i)\n$$\nThis equation states that the net charge separation in the plasma, $e(\\tilde{n}_i - \\tilde{n}_e)$, is balanced by the term $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$, which can be interpreted as the charge density associated with the potential structure in vacuum. The problem refers to this term as the \"electrostatic vacuum polarization\". The goal is to show that this term is negligible under the condition $k_{\\perp} \\lambda_D \\ll 1$.\n\nThe problem specifies using the linearized isothermal electron response. For electrons that are mobile along magnetic field lines, their density perturbation $\\tilde{n}_e$ is often assumed to follow a Boltzmann relation with the electrostatic potential perturbation $\\tilde{\\phi}$. The linearized form of this relation is:\n$$\n\\frac{\\tilde{n}_e}{n_{e0}} = \\frac{e \\tilde{\\phi}}{T_e}\n$$\nWhere $n_{e0}$ is the equilibrium electron density and $T_e$ is the electron temperature in energy units (Joules). This allows us to express the perturbed electron charge density, $\\rho_{e,k} = -e\\tilde{n}_e$, in terms of the potential:\n$$\n-e \\tilde{n}_e = - \\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}\n$$\nThe quantity on the right is a component of the \"plasma polarization\". Now, let us return to Poisson's equation, rewritten as:\n$$\ne(\\tilde{n}_i - \\tilde{n}_e) = \\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}\n$$\nThe term on the right, $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$, represents the net charge density fluctuation in Fourier space. Let us compare the magnitude of this net charge density to the magnitude of the electron charge density fluctuation, $|-e\\tilde{n}_e|$:\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-e \\tilde{n}_e|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-\\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}|} = \\frac{\\epsilon_0 k_{\\perp}^2 T_e}{n_{e0} e^2}\n$$\nWe identify the electron Debye length, $\\lambda_D$, which is defined by the relation:\n$$\n\\lambda_D^2 = \\frac{\\epsilon_0 T_e}{n_{e0} e^2}\n$$\nSubstituting this definition into our ratio gives:\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = k_{\\perp}^2 \\lambda_D^2 = (k_{\\perp} \\lambda_D)^2\n$$\nThe problem states the ordering $k_{\\perp} \\lambda_D \\ll 1$. In this limit, $(k_{\\perp} \\lambda_D)^2 \\ll 1$. This implies:\n$$\n|\\text{net charge density}| \\ll |\\text{electron charge density}|\n$$\nIn terms of the species densities, this means $|e(\\tilde{n}_i - \\tilde{n}_e)| \\ll |-e \\tilde{n}_e|$. This can only be true if the ion and electron charge perturbations nearly cancel each other, i.e., $e \\tilde{n}_i \\approx e \\tilde{n}_e$, which leads to the quasi-neutrality condition:\n$$\n\\tilde{n}_i \\approx \\tilde{n}_e\n$$\nThus, the condition $k_{\\perp} \\lambda_D \\ll 1$ justifies neglecting the net charge separation (the \"vacuum polarization\" term) in comparison to the individual species charge perturbations (\"plasma polarization\"), leading directly to the quasi-neutrality approximation used in many fluid and gyrokinetic models.\n\n### Numerical Estimation and Validation\n\nNext, we evaluate the relevant quantities for the given tokamak core parameters.\nThe given parameters are:\n- Electron density: $n_e = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- Electron temperature: $T_e = 2.0\\,\\mathrm{keV}$\n- Magnetic field: $B = 1.5\\,\\mathrm{T}$\n\nFirst, we convert the electron temperature into SI units (Joules). The unit keV represents an energy, so we use the elementary charge for conversion.\n$$\nT_e [\\mathrm{J}] = (2.0 \\times 10^3\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\nNote that given $T_e$ in energy units, the term $k_B T_e$ in standard formulas is replaced by this value.\n\n**1. Electron Debye Length ($\\lambda_D$)**\nThe formula for the Debye length is $\\lambda_D = \\sqrt{\\epsilon_0 T_e / (n_e e^2)}$, where $T_e$ is in Joules.\n$$\n\\lambda_D = \\sqrt{\\frac{(8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{(2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}}\n$$\n$$\n\\lambda_D \\approx 2.35082 \\times 10^{-5}\\,\\mathrm{m}\n$$\nRounding to three significant figures, the electron Debye length is $\\lambda_D = 2.35 \\times 10^{-5}\\,\\mathrm{m}$.\n\n**2. Validation of the Ordering $k_{\\perp} \\lambda_D \\ll 1$**\nTo check this ordering, we first need to estimate $k_{\\perp}$. We are given the contextual information that for ETG turbulence, $k_{\\perp} \\rho_e \\approx 0.3$, where $\\rho_e$ is the electron Larmor radius. We must calculate $\\rho_e = v_{\\mathrm{th},e} / \\Omega_{ce}$.\n\nThe electron thermal velocity is given as $v_{\\mathrm{th},e} = \\sqrt{2 T_e / m_e}$ (with $T_e$ in Joules):\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}}} \\approx 2.65241 \\times 10^7\\,\\mathrm{m/s}\n$$\nThe electron cyclotron frequency is $\\Omega_{ce} = e B / m_e$:\n$$\n\\Omega_{ce} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1.5\\,\\mathrm{T})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}} \\approx 2.63819 \\times 10^{11}\\,\\mathrm{rad/s}\n$$\nThe electron Larmor radius is therefore:\n$$\n\\rho_e = \\frac{v_{\\mathrm{th},e}}{\\Omega_{ce}} = \\frac{2.65241 \\times 10^7\\,\\mathrm{m/s}}{2.63819 \\times 10^{11}\\,\\mathrm{s}^{-1}} \\approx 1.00539 \\times 10^{-4}\\,\\mathrm{m}\n$$\nUsing the typical value for ETG modes, $k_{\\perp} \\rho_e = 0.3$, we find $k_{\\perp}$:\n$$\nk_{\\perp} = \\frac{0.3}{\\rho_e} = \\frac{0.3}{1.00539 \\times 10^{-4}\\,\\mathrm{m}} \\approx 2983.9\\,\\mathrm{m}^{-1}\n$$\nFinally, we can evaluate the product $k_{\\perp} \\lambda_D$:\n$$\nk_{\\perp} \\lambda_D = (2983.9\\,\\mathrm{m}^{-1}) \\times (2.35082 \\times 10^{-5}\\,\\mathrm{m}) \\approx 0.07015\n$$\nThe result is $k_{\\perp} \\lambda_D \\approx 0.07$. Since $0.07 \\ll 1$, the ordering is well satisfied for these typical ETG instability parameters in a tokamak core. This confirms that the quasi-neutrality approximation is a highly accurate and justified simplification for studying ETG turbulence in this regime.\n\nThe specific value requested for the final answer is the numerical estimate of $\\lambda_D$.",
            "answer": "$$\n\\boxed{2.35 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "Having established the framework's core assumptions, we now investigate the spatial structure of the instability itself. This computational exercise delves into the ballooning formalism, a powerful tool for analyzing microinstabilities in the complex magnetic geometry of a tokamak. By numerically solving a model equation, you will connect abstract parameters like magnetic shear to the physical shape of the instability, $\\phi(\\theta)$, along the magnetic field line .",
            "id": "4011253",
            "problem": "You are asked to design and implement a numerical solver for the Electron Temperature Gradient (ETG) microinstability mode structure in toroidal geometry using the ballooning formalism. The task is to compute the mode structure along the ballooning coordinate and to classify the mode as either localized near the outboard midplane or extended along the field line. All quantities in this problem are formulated in dimensionless gyrokinetic normalization, so no physical units are required.\n\nBegin from the linear gyrokinetic ballooning reduction for electrostatic ETG fluctuations in a homogeneous flux tube, where the mode structure is a function of the ballooning angle coordinate $\\theta$ along the magnetic field line. It is standard to model the perpendicular wavenumber variation due to magnetic shear by the relation\n$$\nk_{\\perp}(\\theta)^2 = k_y^2 \\left( 1 + s^2 \\theta^2 \\right),\n$$\nwhere $k_y$ is the binormal wavenumber and $s$ is the magnetic shear. Finite Larmor radius effects introduce a stabilizing term proportional to $k_{\\perp}(\\theta)^2$, while the toroidal curvature and the electron temperature gradient drive an effective destabilizing contribution localized around the bad-curvature region near the outboard midplane at $\\theta = 0$.\n\nUsing these physically motivated ingredients, construct and solve the one-dimensional Schrödinger-type eigenvalue problem for the electrostatic potential mode structure $\\phi(\\theta)$,\n$$\n-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta) \\phi(\\theta) = \\lambda \\phi(\\theta),\n$$\non a finite interval $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$, with homogeneous Dirichlet boundary conditions $\\phi(-\\theta_{\\max}) = \\phi(\\theta_{\\max}) = 0$. The effective potential $V(\\theta)$ is defined as\n$$\nV(\\theta) = \\beta \\left(1 + s^2 \\theta^2\\right) - D \\exp\\left(-\\frac{\\theta^2}{\\theta_w^2}\\right),\n$$\nwhere $\\beta = (k_y \\rho_e)^2$, $\\rho_e$ is the electron Larmor radius used in the normalization, $D$ is the amplitude of the curvature and gradient drive (larger $D$ increases the drive), and $\\theta_w$ is the characteristic width of the bad-curvature drive around $\\theta=0$. This model captures the competition between stabilizing perpendicular scale growth due to shear and finite Larmor radius, and destabilizing curvature drive localized near $\\theta = 0$.\n\nYour program must:\n- Discretize the operator $-\\mathrm{d}^2/\\mathrm{d}\\theta^2 + V(\\theta)$ on a uniform grid using second-order central finite differences for the second derivative. Impose homogeneous Dirichlet boundary conditions by constructing the discrete operator on the interior grid points only.\n- Compute the ground-state eigenpair $(\\lambda_0, \\phi_0(\\theta))$ with $\\lambda_0$ the smallest algebraic eigenvalue and $\\phi_0$ its associated normalized eigenfunction, such that\n$$\n\\sum_{i} |\\phi_0(\\theta_i)|^2 \\Delta\\theta = 1,\n$$\nwhere $\\Delta\\theta$ is the grid spacing and $\\theta_i$ are the grid points.\n- Classify the mode as localized or streamer-like using the following rule: compute the fraction\n$$\n\\mathcal{F} = \\frac{\\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2 \\Delta\\theta}{\\sum_{\\text{all } i} |\\phi_0(\\theta_i)|^2 \\Delta\\theta},\n$$\nwith a core window $|\\theta| \\le \\theta_c$. If $\\mathcal{F} \\ge T$, declare the mode localized near $\\theta = 0$; otherwise declare that it exhibits extended streamers. Use $\\theta_c = 0.8$ and threshold $T = 0.55$.\n- For all computations, use a uniform grid with $N$ points including the endpoints, and interior points for the operator assembly. You may choose any reasonable $N$ that leads to a numerically stable solution, but the choice must be consistent across all test cases.\n\nTest Suite:\nProvide results for the following four parameter sets, each specified as $(s, k_y \\rho_e, D, \\theta_w, \\theta_{\\max})$:\n1. $s = 0.7$, $k_y \\rho_e = 0.4$, $D = 3.0$, $\\theta_w = 0.8$, $\\theta_{\\max} = 5.0$.\n2. $s = 0.05$, $k_y \\rho_e = 0.2$, $D = 1.2$, $\\theta_w = 2.5$, $\\theta_{\\max} = 8.0$.\n3. $s = 0.3$, $k_y \\rho_e = 0.3$, $D = 1.8$, $\\theta_w = 1.3$, $\\theta_{\\max} = 6.0$.\n4. $s = 0.8$, $k_y \\rho_e = 0.7$, $D = 2.0$, $\\theta_w = 0.7$, $\\theta_{\\max} = 5.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the classification results for all test cases, in order, as a comma-separated Python list of booleans enclosed in square brackets, for example [True,False,...], where True means localized near $\\theta = 0$ and False means extended streamers. No additional text should be printed.",
            "solution": "The problem presented is a valid, well-posed, and scientifically sound exercise in computational plasma physics. It asks for the numerical solution of a one-dimensional Schrödinger-type eigenvalue problem, which is a standard simplified model for studying Electron Temperature Gradient (ETG) microinstabilities in toroidal fusion plasmas using the ballooning formalism. All necessary parameters, equations, and boundary conditions are provided, and no scientific principles are violated.\n\nThe core of the problem is to solve the eigenvalue equation for the electrostatic potential mode structure $\\phi(\\theta)$:\n$$\n-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta)\\,\\phi(\\theta) = \\lambda\\,\\phi(\\theta)\n$$\non the domain $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$ with homogeneous Dirichlet boundary conditions $\\phi(\\pm\\theta_{\\max}) = 0$. The potential $V(\\theta)$ is given by:\n$$\nV(\\theta) = \\beta \\left(1 + s^2 \\theta^2\\right) - D \\exp\\left(-\\frac{\\theta^2}{\\theta_w^2}\\right)\n$$\nwhere $\\beta = (k_y\\,\\rho_e)^2$. This equation models the competition between the stabilizing term proportional to $\\beta(1 + s^2\\theta^2)$, which represents the increase of the perpendicular wavenumber $k_\\perp$ due to magnetic shear, and a destabilizing drive term proportional to $D$, which is localized in the bad-curvature region around $\\theta=0$.\n\nTo solve this problem numerically, we will discretize the differential operator on a uniform grid and transform the differential equation into a matrix eigenvalue problem.\n\nFirst, we define a uniform grid on the domain $[-\\theta_{\\max}, \\theta_{\\max}]$ with $N$ points. Let the grid points be $\\theta_i = -\\theta_{\\max} + i\\,\\Delta\\theta$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta\\theta = \\frac{2\\theta_{\\max}}{N-1}$. For numerical stability and accuracy, a sufficiently large number of grid points is required. We choose $N=1001$, which ensures a fine grid for all test cases and includes a point at $\\theta=0$.\n\nThe second derivative $\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}\\theta^2}$ is approximated using a second-order central finite difference scheme at each interior grid point $\\theta_j$ for $j=1, \\dots, N-2$:\n$$\n\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} \\bigg|_{\\theta_j} \\approx \\frac{\\phi(\\theta_{j+1}) - 2\\phi(\\theta_j) + \\phi(\\theta_{j-1})}{(\\Delta\\theta)^2} = \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2}\n$$\nSubstituting this into the Schrödinger equation for an interior point $\\theta_j$ gives:\n$$\n-\\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2} + V(\\theta_j)\\phi_j = \\lambda \\phi_j\n$$\nRearranging the terms, we get:\n$$\n-\\frac{1}{(\\Delta\\theta)^2}\\phi_{j-1} + \\left(\\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\\right)\\phi_j - \\frac{1}{(\\Delta\\theta)^2}\\phi_{j+1} = \\lambda \\phi_j\n$$\nThe homogeneous Dirichlet boundary conditions are $\\phi_0 = 0$ and $\\phi_{N-1} = 0$. These conditions are enforced by constructing the system of equations only for the $N-2$ interior points. The equation for $j=1$ involves $\\phi_0=0$, and the equation for $j=N-2$ involves $\\phi_{N-1}=0$. This results in a matrix eigenvalue problem $A\\mathbf{x} = \\lambda\\mathbf{x}$, where $\\mathbf{x} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-2}]^T$ is the vector of the eigenfunction values at the interior points. The matrix $A$ is a real, symmetric, tridiagonal matrix of size $(N-2) \\times (N-2)$ with the following elements:\n$$\nA_{jj} = \\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\n$$\n$$\nA_{j, j+1} = A_{j+1, j} = -\\frac{1}{(\\Delta\\theta)^2}\n$$\nWe seek the ground-state eigenpair $(\\lambda_0, \\phi_0)$, where $\\lambda_0$ is the smallest eigenvalue of $A$. This can be efficiently computed using a numerical linear algebra library. We will use `scipy.linalg.eigh_tridiagonal`, which is optimized for this type of matrix. It returns the eigenvalues in ascending order and their corresponding eigenvectors.\n\nLet the eigenvector corresponding to $\\lambda_0$ be $\\mathbf{v}_0$. This vector contains the values of the eigenfunction at the interior points. The full, unnormalized eigenfunction on the grid is constructed by padding with zeros according to the boundary conditions: $\\vec{\\phi}_{\\text{unnormalized}} = [0, v_{0,1}, \\dots, v_{0, N-2}, 0]^T$.\n\nThe next step is to normalize the eigenfunction according to the condition $\\sum_{i=0}^{N-1} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta = 1$. The normalization constant $C$ is found by requiring $C^2 \\sum_{i=0}^{N-1} |\\phi_{\\text{unnormalized},i}|^2\\,\\Delta\\theta = 1$. The normalized eigenfunction is then $\\vec{\\phi}_0 = C \\cdot \\vec{\\phi}_{\\text{unnormalized}}$.\n\nFinally, we classify the mode structure. We compute the fraction $\\mathcal{F}$ of the mode's \"probability density\" contained within the core window $|\\theta| \\le \\theta_c = 0.8$:\n$$\n\\mathcal{F} = \\frac{\\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}{\\sum_{\\text{all } i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}\n$$\nDue to our normalization, the denominator is unity. Thus, the calculation simplifies to $\\mathcal{F} = \\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta$. The mode is classified as 'localized' if $\\mathcal{F} \\ge T=0.55$ and 'extended' otherwise. This procedure is repeated for each parameter set provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the ETG mode structure problem for the given test cases.\n    \"\"\"\n    # Test Suite: Each tuple is (s, k_y*rho_e, D, theta_w, theta_max)\n    test_cases = [\n        (0.7, 0.4, 3.0, 0.8, 5.0),\n        (0.05, 0.2, 1.2, 2.5, 8.0),\n        (0.3, 0.3, 1.8, 1.3, 6.0),\n        (0.8, 0.7, 2.0, 0.7, 5.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        is_loc = is_mode_localized(*params)\n        results.append(is_loc)\n\n    # Final print statement in the exact required format.\n    # The map(str,...) converts boolean True/False to \"True\"/\"False\" string literals.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef is_mode_localized(s, ky_rho_e, D, theta_w, theta_max):\n    \"\"\"\n    Solves the 1D Schrödinger eigenvalue problem for a single parameter set and\n    classifies the ground state mode as localized or extended.\n\n    Args:\n        s (float): Magnetic shear.\n        ky_rho_e (float): Normalized binormal wavenumber.\n        D (float): Drive amplitude.\n        theta_w (float): Width of the drive.\n        theta_max (float): Boundary of the ballooning coordinate domain.\n\n    Returns:\n        bool: True if the mode is localized, False otherwise.\n    \"\"\"\n    # Numerical and classification parameters\n    N = 1001  # Number of grid points (must be odd to include theta=0)\n    theta_c = 0.8  # Core window half-width for classification\n    T = 0.55  # Threshold for localization classification\n\n    # 1. Set up the grid\n    theta = np.linspace(-theta_max, theta_max, N)\n    delta_theta = theta[1] - theta[0]\n\n    # We solve for the eigenfunction on the interior points\n    theta_interior = theta[1:-1]\n\n    # 2. Construct the potential V(theta)\n    beta = ky_rho_e**2\n    V = beta * (1.0 + s**2 * theta_interior**2) - D * np.exp(-(theta_interior**2) / theta_w**2)\n\n    # 3. Construct the tridiagonal matrix for the operator -d^2/d(theta)^2 + V\n    # The matrix A is defined by its diagonal (d) and off-diagonal (e) elements.\n    d = 2.0 / delta_theta**2 + V\n    e = -1.0 / delta_theta**2 * np.ones(N - 3) # Off-diagonal has N-3 elements\n\n    # 4. Solve the eigenvalue problem\n    # eigh_tridiagonal returns eigenvalues sorted in ascending order and corresponding\n    # normalized eigenvectors.\n    eigenvalues, eigenvectors = eigh_tridiagonal(d, e)\n\n    # The ground state is the one with the smallest eigenvalue (the first one)\n    ground_state_vector = eigenvectors[:, 0]\n\n    # 5. Reconstruct and normalize the full eigenfunction\n    # Add zeros at the boundaries for phi(-theta_max) and phi(theta_max)\n    phi_full = np.concatenate(([0.0], ground_state_vector, [0.0]))\n\n    # Normalize the eigenfunction such that sum(|phi|^2 * delta_theta) = 1\n    # This is a numerical integration of |phi|^2 over the domain.\n    norm_integral = np.sum(phi_full**2) * delta_theta\n    phi_normalized = phi_full / np.sqrt(norm_integral)\n\n    # 6. Classify the mode\n    # Find indices within the core window |theta| <= theta_c\n    core_indices = np.where(np.abs(theta) <= theta_c)[0]\n\n    # Calculate the fraction F. The denominator is 1 due to normalization.\n    F = np.sum(phi_normalized[core_indices]**2) * delta_theta\n\n    # Compare with a threshold T to classify\n    return F >= T\n\n# Execute the solver\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "Linearly unstable modes do not grow indefinitely; they are regulated by nonlinear mechanisms. This practice focuses on zonal flows, which are self-generated, radially-varying shear flows that provide a primary saturation mechanism for ETG turbulence. You will derive the flow shearing rate, $\\omega_E$, and apply the heuristic suppression criterion $\\omega_E \\ge \\gamma$ to gain insight into the critical process of turbulence self-regulation .",
            "id": "4011291",
            "problem": "Consider a slab plasma with a uniform magnetic field $B \\hat{\\boldsymbol{z}}$, representative of the local geometry in the core of a tokamak. Electron Temperature Gradient (ETG) modes are linearly unstable in this configuration, with a characteristic growth rate $\\gamma$ obtained independently from a linear gyrokinetic calculation. In the presence of a radially varying zonal electrostatic potential $\\phi(x)$, the associated $\\boldsymbol{E} \\times \\boldsymbol{B}$ flow produces a poloidal velocity $v_y(x)$ and a shearing rate that can suppress turbulence if it exceeds the linear growth rate.\n\nStarting from the fundamental relations for electrostatics and cross-field drift, namely $ \\boldsymbol{E} = -\\nabla \\phi $ and $ \\boldsymbol{v}_E = \\boldsymbol{E} \\times \\boldsymbol{B} / B^2 $, derive the expression for the zonal-flow shearing rate $\\omega_E$ in terms of the zonal potential $\\phi(x)$ and the magnetic field $B$ for the specific case $\\phi(x) = \\phi_0 \\cos(k_x x)$. Use this to compute the shearing rate amplitude and compare it to the given ETG linear growth rate.\n\nParameters:\n- Magnetic field magnitude $B = 3.2 \\ \\mathrm{T}$.\n- Zonal potential amplitude $\\phi_0 = 0.85 \\ \\mathrm{V}$.\n- Zonal radial wavenumber $k_x = 4.2 \\times 10^{3} \\ \\mathrm{m}^{-1}$.\n- Linear ETG growth rate $\\gamma = 3.9 \\times 10^{6} \\ \\mathrm{s}^{-1}$.\n\nTasks:\n1. Using the above definitions, derive the shearing rate $\\omega_E$ corresponding to the given $\\phi(x)$, and evaluate its amplitude in $\\mathrm{s}^{-1}$.\n2. Compute the dimensionless ratio $R = \\omega_E / \\gamma$ and determine whether zonal shearing can suppress ETG (the heuristic suppression criterion is $R \\geq 1$).\n\nExpress your final answer as the single dimensionless ratio $R$. Round your final ratio to four significant figures. No units are required for the ratio since it is dimensionless.",
            "solution": "The problem statement has been validated and is determined to be scientifically sound, self-contained, and well-posed. The physical model and parameters are standard in the field of computational fusion science. We may therefore proceed with the derivation and calculation.\n\nThe objective is to derive an expression for the zonal-flow shearing rate, $\\omega_E$, and then compute a dimensionless ratio, $R$. We begin from the fundamental definitions provided.\n\nThe electrostatic potential, $\\phi$, depends only on the radial coordinate $x$, so $\\phi = \\phi(x)$. The electric field, $\\boldsymbol{E}$, is given by the negative gradient of the potential:\n$$\n\\boldsymbol{E} = -\\nabla \\phi = -\\frac{d\\phi}{dx} \\hat{\\boldsymbol{x}}\n$$\nThe magnetic field is uniform and directed along the $\\hat{\\boldsymbol{z}}$-axis, $\\boldsymbol{B} = B \\hat{\\boldsymbol{z}}$. The $\\boldsymbol{E} \\times \\boldsymbol{B}$ drift velocity, $\\boldsymbol{v}_E$, is defined as:\n$$\n\\boldsymbol{v}_E = \\frac{\\boldsymbol{E} \\times \\boldsymbol{B}}{B^2}\n$$\nSubstituting the expressions for $\\boldsymbol{E}$ and $\\boldsymbol{B}$:\n$$\n\\boldsymbol{v}_E = \\frac{(-\\frac{d\\phi}{dx} \\hat{\\boldsymbol{x}}) \\times (B \\hat{\\boldsymbol{z}})}{B^2} = \\frac{-\\frac{d\\phi}{dx} B}{B^2} (\\hat{\\boldsymbol{x}} \\times \\hat{\\boldsymbol{z}})\n$$\nUsing the vector cross-product identity for a right-handed Cartesian coordinate system, $\\hat{\\boldsymbol{x}} \\times \\hat{\\boldsymbol{z}} = -\\hat{\\boldsymbol{y}}$, we obtain:\n$$\n\\boldsymbol{v}_E = -\\frac{1}{B}\\frac{d\\phi}{dx}(-\\hat{\\boldsymbol{y}}) = \\frac{1}{B}\\frac{d\\phi}{dx} \\hat{\\boldsymbol{y}}\n$$\nThis velocity is purely in the poloidal ($\\hat{\\boldsymbol{y}}$) direction, and its magnitude varies with the radial coordinate $x$. The poloidal velocity component is thus $v_y(x) = \\frac{1}{B} \\frac{d\\phi}{dx}$.\n\nThe shearing rate of this velocity field is its spatial derivative with respect to the radial coordinate $x$:\n$$\n\\text{Shearing Rate} = \\frac{dv_y}{dx} = \\frac{d}{dx} \\left(\\frac{1}{B} \\frac{d\\phi}{dx}\\right)\n$$\nSince the magnetic field magnitude $B$ is constant, we can write:\n$$\n\\frac{dv_y}{dx} = \\frac{1}{B} \\frac{d^2\\phi}{dx^2}\n$$\nThe problem asks for the shearing rate amplitude, $\\omega_E$, which is the maximum absolute value of this quantity.\n$$\n\\omega_E = \\max\\left| \\frac{dv_y}{dx} \\right| = \\frac{1}{B} \\max\\left| \\frac{d^2\\phi}{dx^2} \\right|\n$$\nWe are given the specific form for the zonal potential: $\\phi(x) = \\phi_0 \\cos(k_x x)$. We must compute its second derivative.\nThe first derivative is:\n$$\n\\frac{d\\phi}{dx} = \\frac{d}{dx} [\\phi_0 \\cos(k_x x)] = -\\phi_0 k_x \\sin(k_x x)\n$$\nThe second derivative is:\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{d}{dx} [-\\phi_0 k_x \\sin(k_x x)] = -\\phi_0 k_x^2 \\cos(k_x x)\n$$\nThe maximum absolute value of the second derivative occurs when $|\\cos(k_x x)| = 1$. Thus:\n$$\n\\max\\left| \\frac{d^2\\phi}{dx^2} \\right| = |-\\phi_0 k_x^2| = \\phi_0 k_x^2\n$$\nSubstituting this result into the expression for $\\omega_E$, we arrive at the shearing rate amplitude:\n$$\n\\omega_E = \\frac{\\phi_0 k_x^2}{B}\n$$\nThis completes the first part of the task. Now, we substitute the given numerical values to evaluate $\\omega_E$ and then the ratio $R$.\nThe parameters are:\n- $B = 3.2 \\ \\mathrm{T}$\n- $\\phi_0 = 0.85 \\ \\mathrm{V}$\n- $k_x = 4.2 \\times 10^3 \\ \\mathrm{m}^{-1}$\n- $\\gamma = 3.9 \\times 10^6 \\ \\mathrm{s}^{-1}$\n\nFirst, we calculate $\\omega_E$:\n$$\n\\omega_E = \\frac{(0.85) \\times (4.2 \\times 10^3)^2}{3.2} = \\frac{0.85 \\times 17.64 \\times 10^6}{3.2} \\ \\mathrm{s}^{-1}\n$$\n$$\n\\omega_E = \\frac{14.994 \\times 10^6}{3.2} \\ \\mathrm{s}^{-1} = 4.685625 \\times 10^6 \\ \\mathrm{s}^{-1}\n$$\nThe second task is to compute the dimensionless ratio $R = \\omega_E / \\gamma$:\n$$\nR = \\frac{4.685625 \\times 10^6 \\ \\mathrm{s}^{-1}}{3.9 \\times 10^6 \\ \\mathrm{s}^{-1}} = \\frac{4.685625}{3.9} \\approx 1.20144230769\n$$\nRounding the result to four significant figures as requested:\n$$\nR \\approx 1.201\n$$\nAccording to the heuristic suppression criterion $R \\ge 1$, the calculated value indicates that the zonal flow shearing is strong enough to suppress the ETG turbulence. The final answer is the value of $R$.",
            "answer": "$$\n\\boxed{1.201}\n$$"
        }
    ]
}