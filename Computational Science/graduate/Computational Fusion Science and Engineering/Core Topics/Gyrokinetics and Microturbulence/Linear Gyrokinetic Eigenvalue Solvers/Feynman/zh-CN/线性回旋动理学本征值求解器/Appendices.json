{
    "hands_on_practices": [
        {
            "introduction": "复杂的动理学物理过程通常可以简化为更简单的代数色散关系。这个练习将让你使用一个简化的流体模型求解离子温度梯度（ITG）模的增长率。这是理解物理驱动（$ \\eta_i $）与稳定化机制（通过 $ \\Gamma_0 $ 体现的有限拉莫尔半径效应）之间相互作用的绝佳第一步，且无需构建复杂的数值求解器。你还将把你的结果与一个解析近似进行比较，以了解这种简化在何种条件下是有效的。",
            "id": "4001971",
            "problem": "考虑线性离子温度梯度（ITG）不稳定性，在静电、低贝塔极限下，使用局域、磁通管、$s$–$\\alpha$ 几何模型进行建模。假设电子是绝热的，且存在单一麦克斯韦背景的离子种类。从线性化、无碰撞、静电的离子回旋动理学方程出发，其中绝热电子满足准中性条件。在最不稳定气球模宇称的平行动态消失的极限下（即，取 $k_{\\parallel} \\rightarrow 0$ 以分离环向 ITG 分支），并对离子矩采用标准的 Landau-流体（Padé 型）闭合，该闭合能够捕捉曲率驱动和有限拉莫尔半径（FLR）效应，可以得到一个简化的、无量纲的、关于复数抗磁归一化频率 $\\hat{\\omega} = \\omega / \\omega_{\\ast i}$ 的二次色散关系式，其形式为\n$$\n\\hat{\\omega}^2 - \\hat{\\omega}\\left[\\Gamma_0(b)\\left(1 + \\eta_i\\right) + \\hat{\\omega}_d\\right] + \\alpha\\,\\hat{\\omega}_d\\,\\Gamma_0(b) = 0,\n$$\n其中：\n- $\\eta_i = L_n/L_{T_i}$ 是离子温度梯度参数，其中 $L_n$ 是密度梯度标长，$L_{T_i}$ 是离子温度梯度标长，二者均为正常数。\n- $k_y \\rho_i$ 是以回旋半径为单位的双法向波数；定义 $b = \\left(k_y \\rho_i\\right)^2$。\n- $\\Gamma_0(b)$ 是离子回旋平均因子，精确取为零阶 Laguerre (Bessel) FLR 因子 $\\Gamma_0(b) = I_0(b)\\,e^{-b}$，其中 $I_0$ 是零阶第一类修正贝塞尔函数。\n- $s$ 是磁剪切，一个非负实数参数。\n- $\\alpha$ 是 $s$–$\\alpha$ 几何中的归一化压力梯度驱动，是一个乘以曲率耦合项的非负实数参数。\n- 归一化到 $\\omega_{\\ast i}$ 的曲率漂移频率模型为\n$$\n\\hat{\\omega}_d = \\frac{\\alpha}{1 + s^2},\n$$\n该模型捕捉了磁剪切对平均曲率驱动的稳定效应。\n\n在此模型中，二次方程的复根定义了 ITG 本征值 $\\hat{\\omega} = \\hat{\\omega}_r + i \\gamma$。不稳定性对应于负的判别式，此时增长率为\n$$\n\\gamma_{\\mathrm{num}} = \\frac{1}{2}\\sqrt{4\\,B - A^2},\n$$\n其中\n$$\nA = \\Gamma_0(b)\\left(1 + \\eta_i\\right) + \\hat{\\omega}_d, \\quad B = \\alpha\\,\\hat{\\omega}_d\\,\\Gamma_0(b).\n$$\n若 $4\\,B - A^2 \\le 0$，则取 $\\gamma_{\\mathrm{num}} = 0$。\n\n对于适用于小等离子体贝塔（静电）和中等 FLR 的基准解析极限，将回旋平均因子近似为其最高到二阶的小 $b$ 渐近展开式，\n$$\n\\Gamma_0(b) \\approx \\Gamma_0^{\\mathrm{asym}}(b) = 1 - b + \\frac{b^2}{2},\n$$\n并定义相应的渐近系数\n$$\nA_{\\mathrm{asym}} = \\Gamma_0^{\\mathrm{asym}}(b)\\left(1 + \\eta_i\\right) + \\hat{\\omega}_d, \\quad B_{\\mathrm{asym}} = \\alpha\\,\\hat{\\omega}_d\\,\\Gamma_0^{\\mathrm{asym}}(b),\n$$\n渐近增长率为\n$$\n\\gamma_{\\mathrm{asym}} = \\max\\left\\{0,\\ \\frac{1}{2}\\sqrt{4\\,B_{\\mathrm{asym}} - A_{\\mathrm{asym}}^2}\\right\\}.\n$$\n\n任务。编写一个完整的程序：\n1. 对于每个提供的测试用例，根据精确的 $\\Gamma_0(b)$ 模型计算 ITG 本征值增长率 $\\gamma_{\\mathrm{num}}$，并根据二阶 $\\Gamma_0^{\\mathrm{asym}}(b)$ 展开式计算基准渐近增长率 $\\gamma_{\\mathrm{asym}}$。\n2. 对于每个测试用例，返回绝对差异\n$$\n\\Delta \\gamma = \\left|\\gamma_{\\mathrm{num}} - \\gamma_{\\mathrm{asym}}\\right|.\n$$\n\n重要说明：\n- 所有量都是无量纲的。答案中无需物理单位。\n- 不出现角度；无需角度单位。\n- 如果在精确模型或渐近模型中判别式为非正，则将相应的增长率解释为零。\n\n测试套件。使用以下参数集 $(\\eta_i, k_y \\rho_i, s, \\alpha)$:\n- 用例 1（不稳定，中等 FLR）：$(0.8,\\ 0.7,\\ 0.2,\\ 4.0)$。\n- 用例 2（接近阈值）：$(1.5,\\ 0.4,\\ 1.0,\\ 2.7)$。\n- 用例 3（因强剪切而稳定）：$(3.0,\\ 0.7,\\ 3.0,\\ 1.0)$。\n- 用例 4（小 $b$，不稳定）：$(2.0,\\ 0.15,\\ 0.5,\\ 4.0)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含四个结果 $\\Delta \\gamma$，以逗号分隔的列表形式包含在方括号中，每个数字四舍五入到六位小数，例如：“[x1,x2,x3,x4]”。",
            "solution": "该问题是有效的。它在科学上基于等离子体微观不稳定性理论，特别是离子温度梯度（ITG）模的简化模型。该问题是适定的、客观的，并包含获得唯一、可验证解所需的所有信息。\n\n任务是计算对于一组给定的等离子体参数，由完整回旋平均模型计算出的 ITG 增长率 $\\gamma_{\\mathrm{num}}$ 与渐近模型计算出的增长率 $\\gamma_{\\mathrm{asym}}$ 之间的绝对差异 $\\Delta \\gamma$。\n\n解决每个测试用例 $(\\eta_i, k_y \\rho_i, s, \\alpha)$ 的逻辑步骤如下：\n\n首先，我们计算两个模型共有的无量纲参数。归一化双法向波数的平方 $b$ 定义为\n$$\nb = (k_y \\rho_i)^2.\n$$\n该参数量化了不稳定性相对于离子回旋半径 $\\rho_i$ 的尺度。归一化曲率漂移频率 $\\hat{\\omega}_d$ 模型化了环向曲率和磁剪切的影响，由下式给出\n$$\n\\hat{\\omega}_d = \\frac{\\alpha}{1 + s^2}.\n$$\n这里，$\\alpha$ 是代表驱动的归一化压力梯度参数，而 $s$ 是磁剪切，其在分母中的存在表明其对平均曲率漂移的稳定作用。\n\n其次，我们使用精确的回旋平均因子 $\\Gamma_0(b)$ 计算增长率 $\\gamma_{\\mathrm{num}}$。色散关系是一个关于复频率 $\\hat{\\omega}$ 的二次方程。该二次方程的系数（表示为 $A$ 和 $B$）取决于等离子体参数。当二次方程的判别式为负时，出现不稳定性，对应于正的增长率。增长率从此判别式中导出。\n\n精确的离子回旋平均因子是\n$$\n\\Gamma_0(b) = I_0(b)\\,e^{-b},\n$$\n其中 $I_0(b)$ 是零阶第一类修正贝塞尔函数。该函数表示垂直电场在一个离子回旋轨道上的平均，是有限拉莫尔半径（FLR）效应的关键组成部分。\n\n利用这个，我们定义特征多项式的系数：\n$$\nA = \\Gamma_0(b)\\left(1 + \\eta_i\\right) + \\hat{\\omega}_d,\n$$\n$$\nB = \\alpha\\,\\hat{\\omega}_d\\,\\Gamma_0(b).\n$$\n增长率 $\\gamma_{\\mathrm{num}}$ 是项 $4B - A^2$ 正部分的平方根的一半，这对应于 $\\hat{\\omega}$ 二次方程判别式的负值：\n$$\n\\gamma_{\\mathrm{num}} = \\begin{cases} \\frac{1}{2}\\sqrt{4B - A^2}  \\text{if } 4B - A^2 > 0 \\\\ 0  \\text{if } 4B - A^2 \\le 0 \\end{cases}.\n$$\n$\\gamma_{\\mathrm{num}} = 0$ 的值表示稳定或临界稳定模。\n\n第三，我们对渐近增长率 $\\gamma_{\\mathrm{asym}}$ 重复计算。该模型作为一个基准，在小 $b$（即 $k_y \\rho_i \\ll 1$）的极限下有效。它用 $\\Gamma_0(b)$ 在 $b=0$ 附近的二阶泰勒展开式替换了精确的 $\\Gamma_0(b)$：\n$$\n\\Gamma_0^{\\mathrm{asym}}(b) = 1 - b + \\frac{b^2}{2}.\n$$\n相应的渐近系数为：\n$$\nA_{\\mathrm{asym}} = \\Gamma_0^{\\mathrm{asym}}(b)\\left(1 + \\eta_i\\right) + \\hat{\\omega}_d,\n$$\n$$\nB_{\\mathrm{asym}} = \\alpha\\,\\hat{\\omega}_d\\,\\Gamma_0^{\\mathrm{asym}}(b).\n$$\n然后使用与之前相同的逻辑计算渐近增长率：\n$$\n\\gamma_{\\mathrm{asym}} = \\begin{cases} \\frac{1}{2}\\sqrt{4B_{\\mathrm{asym}} - A_{\\mathrm{asym}}^2}  \\text{if } 4B_{\\mathrm{asym}} - A_{\\mathrm{asym}}^2 > 0 \\\\ 0  \\text{if } 4B_{\\mathrm{asym}} - A_{\\mathrm{asym}}^2 \\le 0 \\end{cases}.\n$$\n\n最后，对于每组参数，计算两个模型之间的绝对差异为\n$$\n\\Delta \\gamma = \\left|\\gamma_{\\mathrm{num}} - \\gamma_{\\mathrm{asym}}\\right|.\n$$\n这个量衡量了在给定参数下，由小 $b$ 近似引入的误差。对所有提供的测试用例重复整个过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes the absolute discrepancy in ITG growth rates between an exact\n    and an asymptotic model for given plasma parameters.\n    \"\"\"\n\n    # Test cases defined as tuples of (eta_i, k_y_rho_i, s, alpha)\n    test_cases = [\n        (0.8, 0.7, 0.2, 4.0),   # Case 1: unstable, moderate FLR\n        (1.5, 0.4, 1.0, 2.7),   # Case 2: near threshold\n        (3.0, 0.7, 3.0, 1.0),   # Case 3: stable due to strong shear\n        (2.0, 0.15, 0.5, 4.0),  # Case 4: small b, unstable\n    ]\n\n    results = []\n    for eta_i, ky_rho_i, s, alpha in test_cases:\n        # Step 1: Calculate common parameters\n        # b is the squared normalized binormal wavenumber\n        b = ky_rho_i**2\n        # omega_d_hat is the normalized curvature-drift frequency\n        omega_d_hat = alpha / (1.0 + s**2)\n\n        # Step 2: Calculate the numerical growth rate (gamma_num)\n        # Gamma_0(b) is the exact ion gyroaverage factor\n        gamma0_b_num = i0(b) * np.exp(-b)\n        \n        # Coefficients of the quadratic dispersion relation\n        A_num = gamma0_b_num * (1.0 + eta_i) + omega_d_hat\n        B_num = alpha * omega_d_hat * gamma0_b_num\n        \n        # The growth rate is derived from the discriminant of the quadratic\n        discriminant_num = 4.0 * B_num - A_num**2\n        gamma_num = 0.5 * np.sqrt(discriminant_num) if discriminant_num > 0 else 0.0\n\n        # Step 3: Calculate the asymptotic growth rate (gamma_asym)\n        # Gamma_0(b) is approximated by its second-order expansion\n        gamma0_b_asym = 1.0 - b + 0.5 * b**2\n        \n        # Coefficients for the asymptotic model\n        A_asym = gamma0_b_asym * (1.0 + eta_i) + omega_d_hat\n        B_asym = alpha * omega_d_hat * gamma0_b_asym\n        \n        # Calculate the asymptotic growth rate\n        discriminant_asym = 4.0 * B_asym - A_asym**2\n        gamma_asym = 0.5 * np.sqrt(discriminant_asym) if discriminant_asym > 0 else 0.0\n\n        # Step 4: Compute the absolute discrepancy\n        delta_gamma = np.abs(gamma_num - gamma_asym)\n        results.append(delta_gamma)\n\n    # Format the results to six decimal places as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Print the final output in the required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "超越简单的代数形式，大多数回旋动理学求解器将底层的积分-微分算符表示为一个大型矩阵。这项实践将指导你为电子温度梯度（ETG）模建立这样一个矩阵。通过使用厄米多项式离散化速度空间的相关性，你将构建并求解一个矩阵本征值问题来寻找不稳定性的增长率，这项技术是许多生产级回旋动理学程序的核心。",
            "id": "4001874",
            "problem": "考虑在平板几何中，具有绝热（玻尔兹曼）离子和零磁曲率的静电、碰撞阻尼、线性回旋动理学电子动力学。目标是为指定的电子温度梯度参数 $\\eta_e$、归一化到电子回旋半径的副法线方向波数 $k_y \\rho_e$ 以及归一化碰撞率，计算电子温度梯度（ETG）模增长率，然后将计算出的ETG增长率与典型的离子温度梯度（ITG）标度趋势进行比较。结果必须以无量纲单位表示，具体而言，所有频率都归一化到电子逆磁频率的幅度。角度单位不适用。除所述归一化外，输出中不应出现任何物理单位。\n\n从电子的线性静电回旋动理学方程开始，\n$$\n\\left(- i \\omega + i k_{\\parallel} v_{\\parallel} + \\nu_e \\right) g_e = i \\omega_{*e} \\, J_0\\!\\left(k_\\perp \\rho_e\\right) \\, F_{0e} \\left[ 1 + \\eta_e \\left(\\frac{v^2}{v_{\\mathrm{th},e}^2} - \\frac{3}{2}\\right)\\right] \\, \\frac{e \\phi}{T_e},\n$$\n其中 $g_e$ 是非绝热电子分布函数，$F_{0e}$ 是电子麦克斯韦分布，$J_0$ 是零阶第一类贝塞尔函数（源于有限拉莫尔半径下的回旋平均），$k_{\\parallel}$ 是平行波数，$v_{\\parallel}$ 是平行速度，$\\nu_e$ 是模型碰撞频率，$\\omega_{*e}$ 是电子逆磁频率，$\\rho_e$ 是电子拉莫尔半径，$v_{\\mathrm{th},e}$ 是电子热速度，$e$ 是元电荷，$T_e$ 是电子温度，$\\phi$ 是静电势。假设在平板几何中 $k_x = 0$，因此 $k_\\perp = k_y$。\n\n将速度空间对 $v_{\\parallel}$ 的依赖性投影到厄米多项式基上，并进行归一化，使得厄米矩 $h_m$ 满足流动关系\n$$\nv_{\\parallel} \\varphi_m(v_{\\parallel}) \\propto \\sqrt{m+1} \\, \\varphi_{m+1}(v_{\\parallel}) + \\sqrt{m} \\, \\varphi_{m-1}(v_{\\parallel}),\n$$\n其中 $m \\ge 0$ 为整数，$\\varphi_m$ 表示由麦克斯韦分布 $F_{0e}$ 加权的标准正交厄米函数。使用 Lenard–Bernstein 碰撞模型，该模型以与 $m$ 成正比的速率阻尼厄米矩 $h_m$。在 $m = M-1$ 处截断厄米展开，并应用标准闭合 $h_M \\approx 0$。\n\n施加具有玻尔兹曼离子的准中性条件。在电子尺度的平板ETG中，离子是玻尔兹曼分布的，因此离子密度微扰为 $\\delta n_i / n_0 = (e \\phi / T_i)$，而电子密度微扰为 $\\delta n_e / n_0 = - (e \\phi / T_e) + \\Gamma_0(b_e) h_0$，其中 $h_0$ 是电子密度矩（经适当归一化的 $J_0 g_e$ 的速度积分），且 $\\Gamma_0(b_e) \\equiv I_0(b_e) \\exp(-b_e)$，其中 $b_e \\equiv (k_\\perp \\rho_e)^2$，$I_0$ 是零阶第一类修正贝塞尔函数。准中性条件 $e \\delta n_i - e \\delta n_e = 0$ 随后给出了无量纲静电势 $\\hat{\\phi} \\equiv e \\phi / T_e$ 与电子密度矩之间的关系：\n$$\n\\hat{\\phi} = \\frac{\\Gamma_0(b_e)}{1 + \\tau} \\, h_0,\n$$\n其中 $\\tau \\equiv T_e / T_i$。取 $\\tau = 1$。\n\n在厄米表示中，ETG驱动项 $1 + \\eta_e (v^2 / v_{\\mathrm{th},e}^2 - 3/2)$ 的速度空间结构仅投影到 $m=0$ 和 $m=2$ 的厄米矩上。将这些驱动投影系数表示为 $a_0 = 1$ 和 $a_2 = \\eta_e \\sqrt{2}$，对于所有其他 $m$，$a_m = 0$。在代入准中性关系以消去 $\\hat{\\phi}$ 而用 $h_0$ 表示后，并将频率归一化到 $\\omega_{*e}$，将平行流动因子 $k_{\\parallel} v_{\\mathrm{th},e}$ 归一化为1。由此产生的厄米矩向量 $\\mathbf{h} = (h_0, h_1, \\dots, h_{M-1})^\\top$ 的特征值问题是\n$$\n\\omega h_m = i \\, \\nu_e \\, m \\, h_m + \\alpha \\left( \\sqrt{m+1} \\, h_{m+1} + \\sqrt{m} \\, h_{m-1} \\right) - C \\, a_m \\, h_0,\n$$\n对于 $m = 0, 1, \\dots, M-1$，其中 $h_{-1} \\equiv 0$，$h_M \\equiv 0$，$\\alpha \\equiv k_{\\parallel} v_{\\mathrm{th},e} / \\omega_{*e} = 1$，以及\n$$\nC \\equiv \\frac{\\Gamma_0(b_e)}{1 + \\tau}, \\quad \\Gamma_0(b_e) \\equiv I_0(b_e) \\, e^{-b_e}, \\quad b_e \\equiv (k_y \\rho_e)^2.\n$$\n该系统定义了一个线性算子 $\\mathcal{L}$，使得 $\\mathcal{L} \\, \\mathbf{h} = \\omega \\, \\mathbf{h}$。ETG增长率是 $\\mathcal{L}$ 的特征值 $\\omega_j$ 中的最大虚部 $\\gamma \\equiv \\max\\limits_j \\operatorname{Im}(\\omega_j)$。所有量都是无量纲的，频率被归一化到电子逆磁频率的幅度，因此 $\\gamma$ 是一个无量纲增长率。\n\n为了与典型的离子温度梯度（ITG）标度趋势进行比较，使用相同的副法线波数归一化，定义以下无量纲类ITG标度代理函数：\n$$\n\\gamma_{\\mathrm{ITG,\\,scale}}(\\eta_e, k_y \\rho_e) \\equiv \\frac{\\sqrt{\\eta_e}}{1 + (k_y \\rho_e)^2}.\n$$\n该代理函数捕捉了对温度梯度参数的平方根依赖关系，以及随垂直波数增加而回旋平均效应减弱的趋势，作为趋势参考。每个测试案例的比较指标是比率\n$$\n\\mathcal{R} \\equiv \\frac{\\gamma_{\\mathrm{ETG}}}{\\gamma_{\\mathrm{ITG,\\,scale}}}.\n$$\n\n实现以下计算任务：\n- 根据上述模型假设和归一化，为一个选定的厄米截断数 $M$ 构建 $\\mathcal{L}$ 的矩阵表示。\n- 计算 $\\mathcal{L}$ 的所有特征值，并将最大的虚部确定为 $\\gamma_{\\mathrm{ETG}}$。\n- 对每个测试案例，使用提供的标度代理函数计算比较比率 $\\mathcal{R}$。\n\n使用以下参数值测试套件 $(\\eta_e, k_y \\rho_e, \\nu_e)$：\n1. $(1.0, 0.30, 0.00)$\n2. $(0.2, 0.30, 0.00)$\n3. $(2.0, 1.00, 0.50)$\n4. $(4.0, 0.05, 0.00)$\n5. $(1.5, 2.00, 0.20)$\n\n覆盖性设计：\n- 案例1是中等波数下的一般无碰撞ETG驱动（理想路径）。\n- 案例2接近弱驱动（边界），测试近稳定性。\n- 案例3测试了单位量级波数下的有限碰撞阻尼。\n- 案例4研究了回旋平均效应较弱的长波极限。\n- 案例5探测了高波数和中等碰撞率下的强回旋平均效应。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含按 $[\\gamma_1, \\mathcal{R}_1, \\gamma_2, \\mathcal{R}_2, \\dots, \\gamma_5, \\mathcal{R}_5]$ 顺序连接的数字列表，其中 $\\gamma_j$ 和 $\\mathcal{R}_j$ 分别是测试案例 $j$ 的ETG增长率和比较比率。所有值必须是符合所述归一化的浮点数。不应打印任何其他文本。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于已确立的线性回旋动理学理论原理，内容自洽，并且在数学上是作为一个线性特征值问题被适当地提出的。所有必要的参数和定义都已提供，问题没有矛盾或事实错误。唯一未指定的参数，即厄米矩截断数 $M$，是数值实现策略的一个方面，而不是问题表述中的缺陷。一个求解器理应选择一个能确保数值收敛的 $M$ 值。\n\n任务是计算电子温度梯度（ETG）模的增长率，并将其与一个参考标度进行比较。这需要求解以简化的厄米矩表示形式提出的线性回旋动理学特征值问题。厄米矩向量 $\\mathbf{h} = (h_0, h_1, \\dots, h_{M-1})^\\top$ 的控制方程如下所示：\n$$\n\\omega h_m = i \\, \\nu_e \\, m \\, h_m + \\alpha \\left( \\sqrt{m+1} \\, h_{m+1} + \\sqrt{m} \\, h_{m-1} \\right) - C \\, a_m \\, h_0\n$$\n对于 $m = 0, 1, \\dots, M-1$，并满足闭合条件 $h_{-1} \\equiv 0$ 和 $h_M \\equiv 0$。在这里，$\\omega$ 是复数模频率，已归一化到电子逆磁频率 $\\omega_{*e}$ 的幅度。$\\omega$ 的虚部，记作 $\\gamma \\equiv \\operatorname{Im}(\\omega)$，代表了模的增长率。ETG增长率是所有本征模中最大的增长率，即 $\\gamma_{\\mathrm{ETG}} = \\max_j \\operatorname{Im}(\\omega_j)$。\n\n这个线性方程组定义了一个形式为 $\\mathcal{L} \\mathbf{h} = \\omega \\mathbf{h}$ 的矩阵特征值问题，其中 $\\mathcal{L}$ 是一个线性算子，我们必须构建其矩阵表示。$M \\times M$ 矩阵 $\\mathbf{L}$ 的元素，记作 $\\mathcal{L}_{mn}$，是通过在 $\\omega h_m$ 的表达式中识别每个矩 $h_n$ 的系数来确定的。算子 $\\mathcal{L}$ 可以加性分解为三个对应于不同物理效应的分量：平行流动、碰撞阻尼，以及经回旋平均和准中性修正的ETG驱动。\n\n$1$. **平行流动算子 ($\\mathcal{L}_{\\mathrm{stream}}$)**：此分量源于项 $\\alpha (\\sqrt{m+1} h_{m+1} + \\sqrt{m} h_{m-1})$。它耦合相邻的厄米矩，并由一个实对称三对角矩阵表示。在归一化 $\\alpha \\equiv k_{\\parallel} v_{\\mathrm{th},e} / \\omega_{*e} = 1$ 的条件下，其非零元素为：\n$$\n\\mathcal{L}_{m, m+1}^{\\mathrm{stream}} = \\sqrt{m+1} \\quad \\text{for } m = 0, \\dots, M-2\n$$\n$$\n\\mathcal{L}_{m, m-1}^{\\mathrm{stream}} = \\sqrt{m} \\quad \\text{for } m = 1, \\dots, M-1\n$$\n\n$2$. **碰撞阻尼算子 ($\\mathcal{L}_{\\mathrm{coll}}$)**：此分量来自 Lenard–Bernstein 模型碰撞项 $i \\nu_e m h_m$。它由一个纯虚对角矩阵表示，其中 $\\nu_e$ 是归一化的碰撞频率。阻尼率与矩指数 $m$ 成正比。\n$$\n\\mathcal{L}_{mm}^{\\mathrm{coll}} = i \\nu_e m\n$$\n\n$3$. **驱动算子 ($\\mathcal{L}_{\\mathrm{drive}}$)**：此分量 $-C a_m h_0$ 代表不稳定性的来源。它将所有矩耦合回密度微扰矩 $h_0$。它由一个除了第一列（$n=0$）外处处为零的矩阵表示。耦合强度 $C$ 由下式给出\n$$\nC = \\frac{\\Gamma_0(b_e)}{1 + \\tau} \\quad \\text{where} \\quad \\Gamma_0(b_e) = I_0(b_e) e^{-b_e}, \\quad b_e = (k_y \\rho_e)^2, \\quad \\tau = 1\n$$\n投影系数 $a_m$ 仅在 $m=0$（$a_0 = 1$）和 $m=2$（$a_2 = \\eta_e \\sqrt{2}$）时非零。驱动矩阵的元素为：\n$$\n\\mathcal{L}_{m0}^{\\mathrm{drive}} = -C a_m\n$$\n\n总算子是三者之和 $\\mathcal{L} = \\mathcal{L}_{\\mathrm{stream}} + \\mathcal{L}_{\\mathrm{coll}} + \\mathcal{L}_{\\mathrm{drive}}$。因此，其矩阵表示 $\\mathbf{L}$ 的元素为：\n$$\n\\mathcal{L}_{mn} = \\sqrt{m+1} \\, \\delta_{n, m+1} + \\sqrt{m} \\, \\delta_{n, m-1} + i \\nu_e m \\, \\delta_{mn} - C a_m \\, \\delta_{n0}\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ。厄米级数必须在足够高的矩数 $M$ 处截断，以确保特征值的数值收敛。对于所考虑的参数范围，选择 $M = 64$ 可以为电子速度空间动力学提供足够的分辨率。\n\n对于每个测试案例 $(\\eta_e, k_y \\rho_e, \\nu_e)$ 的计算步骤如下：\n$1$. 计算参数 $b_e = (k_y \\rho_e)^2$ 和 $C = I_0(b_e) e^{-b_e} / 2$。\n$2$. 使用 $\\mathcal{L}_{mn}$ 的表达式构建 $M \\times M$ 复矩阵 $\\mathbf{L}$。\n$3$. 计算 $\\mathbf{L}$ 的所有特征值集合 $\\{\\omega_j\\}$。\n$4$. 通过找到所有特征值中的最大虚部来确定ETG增长率：$\\gamma_{\\mathrm{ETG}} = \\max_j \\operatorname{Im}(\\omega_j)$。\n$5$. 计算类ITG标度代理：$\\gamma_{\\mathrm{ITG,\\,scale}} = \\sqrt{\\eta_e} / (1 + (k_y \\rho_e)^2)$。\n$6$. 计算比较比率 $\\mathcal{R} = \\gamma_{\\mathrm{ETG}} / \\gamma_{\\mathrm{ITG,\\,scale}}$。\n\n对问题陈述中提供的所有五个测试案例重复此过程。将得到的 $\\gamma_{\\mathrm{ETG}}$ 和 $\\mathcal{R}$ 值收集并格式化为指定的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Solves the linear gyrokinetic eigenvalue problem for the ETG mode,\n    computes the growth rate and a comparison metric for a suite of test cases.\n    \"\"\"\n    \n    # Hermite truncation number. Chosen to be sufficient for convergence.\n    M = 64\n    \n    # Normalization constants from the problem statement.\n    alpha = 1.0\n    tau = 1.0\n\n    # Define the test cases from the problem statement.\n    # Format: (eta_e, k_y_rho_e, nu_e)\n    test_cases = [\n        (1.0, 0.30, 0.00),\n        (0.2, 0.30, 0.00),\n        (2.0, 1.00, 0.50),\n        (4.0, 0.05, 0.00),\n        (1.5, 2.00, 0.20),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eta_e, ky_rho_e, nu_e = case\n\n        # 1. Construct the matrix representation of the operator L.\n        \n        # Initialize the M x M complex matrix L.\n        L = np.zeros((M, M), dtype=complex)\n        \n        # Moment indices.\n        m_vals = np.arange(M)\n\n        # a) Streaming part (tridiagonal).\n        # Super-diagonal (couples m to m+1)\n        if M > 1:\n            super_diag = alpha * np.sqrt(m_vals[:-1] + 1)\n            np.fill_diagonal(L[:, 1:], super_diag)\n        # Sub-diagonal (couples m to m-1)\n        if M > 1:\n            sub_diag = alpha * np.sqrt(m_vals[1:])\n            np.fill_diagonal(L[1:, :], sub_diag)\n\n        # b) Collisional damping part (diagonal).\n        # This adds to the main diagonal.\n        np.fill_diagonal(L, L.diagonal() + 1j * nu_e * m_vals)\n\n        # c) Drive part (modifies the first column).\n        # Calculate the coupling coefficient C.\n        b_e = ky_rho_e**2\n        gamma_0_be = i0(b_e) * np.exp(-b_e)\n        C = gamma_0_be / (1.0 + tau)\n\n        # Construct the drive projection vector a_m.\n        a_m = np.zeros(M)\n        a_m[0] = 1.0\n        if M > 2:\n            a_m[2] = eta_e * np.sqrt(2.0)\n        \n        # Add the drive term to the first column of L.\n        L[:, 0] -= C * a_m\n\n        # 2. Compute eigenvalues and find the maximum growth rate.\n        eigenvalues = np.linalg.eigvals(L)\n        gamma_etg = np.max(eigenvalues.imag)\n\n        # 3. Compute the comparison metric R.\n        # Guard against eta_e = 0 cases, although not present in test suite.\n        if eta_e > 0:\n            gamma_itg_scale = np.sqrt(eta_e) / (1.0 + ky_rho_e**2)\n            # Avoid division by zero if scaling is zero\n            if gamma_itg_scale > 1e-12:\n                R = gamma_etg / gamma_itg_scale\n            else:\n                R = np.inf if gamma_etg > 0 else 0.0\n        else:\n            gamma_itg_scale = 0.0\n            R = np.inf if gamma_etg > 0 else 0.0\n\n        # Ensure that modes that should be stable are reported with zero growth rate.\n        if gamma_etg  1e-12:\n            gamma_etg = 0.0\n            \n        results.append(gamma_etg)\n        results.append(R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "找到本征值后，一个关键的下一步是理解它对各种物理参数的敏感度。伴随方法为计算这些敏感度提供了一种强大而高效的途径。在这个高级练习中，你将实施一个基于伴随方法的计算，以找到一个类ITG本征值对等离子体参数的导数，并用有限差分法验证你的结果。这将为你提供一个用于不确定性量化和实验设计的工具。",
            "id": "4001903",
            "problem": "要求您实现一个完整的程序，用于计算简化的线性回旋动理学算子的主导特征值相对于副法向波数和离子温度梯度标长的基于伴随的灵敏度。其背景是采用简化回旋流体闭合的平板位形离子温度梯度（ITG）动力学，其中电子为绝热电子。该计算必须通过一小组测试用例的有限差分近似进行验证。程序必须是自包含的，并能以指定格式生成所需输出，无需用户输入。\n\n其基本原理是在漂移波动力学下，耦合的离子密度和离子温度涨落的线性化，这被表示为一个关于状态向量的非厄米特征值问题。这种表示反映了在简化回旋流体近似下的线性回旋动理学行为，并能够通过伴随方法对非正规算子进行严格的灵敏度分析。该分析纯粹从数学角度表述，涉及一个含参数的复矩阵及其特征对。\n\n将含参数的复矩阵算子定义如下。设 $k_y$ 为无量纲的副法向波数，$L_T$ 为无量纲的离子温度梯度标长。引入具有指定值的固定无量纲常数：\n- $L_n = 2.0$，\n- $a_T = 0.7$，\n- $\\beta = 0.9$，\n- $\\nu = 0.05$，\n- $g_0 = 0.2$，\n- $c_{\\mathrm{FLR}} = 0.3$。\n\n将温度梯度耦合函数和有限拉莫尔半径稳定化函数定义为\n$$\n\\alpha(L_T) = a_T \\frac{L_n}{L_T}, \\qquad \\gamma(k_y) = g_0 + c_{\\mathrm{FLR}} k_y^2.\n$$\n该算子为 $2 \\times 2$ 复矩阵\n$$\nA(k_y,L_T) =\n\\begin{pmatrix}\n- i k_y   i k_y \\,\\alpha(L_T) \\\\\ni k_y \\,\\beta   -\\left(\\nu + i k_y \\,\\gamma(k_y)\\right)\n\\end{pmatrix},\n$$\n其中 $i$ 是虚数单位。此定义反映了在简化回旋流体背景下的线性漂移波平流（$-i k_y$）、温度梯度驱动（$i k_y \\alpha$）以及稳定化/阻尼（$\\nu$ 和 $i k_y \\gamma$）。\n\n您必须对 $A(k_y,L_T)$ 的主导特征值 $\\lambda(k_y,L_T)$（定义为虚部最大的特征值）进行基于伴随的灵敏度分析。对于每个测试用例，使用伴随方法计算复导数 $\\partial \\lambda / \\partial k_y$ 和 $\\partial \\lambda / \\partial L_T$，并通过独立微扰 $k_y$ 和 $L_T$ 计算出的中心有限差分近似来验证这些导数。您的实现必须包含稳健的模式追踪，以确保在 $(k_y \\pm h, L_T)$ 和 $(k_y, L_T \\pm h)$ 处的有限差分微扰通过最小化复平面上的距离，与未微扰的 $\\lambda(k_y,L_T)$ 匹配到相同的特征模式分支。对微扰使用一个小的正实数步长 $h$，并确保您的选择在数值上是稳定的。\n\n您的程序必须为每个测试用例计算伴随灵敏度与有限差分之间的相对误差：\n$$\n\\mathrm{err}_{k_y} = \\frac{\\left|\\frac{\\partial \\lambda}{\\partial k_y}\\big|_{\\mathrm{adj}} - \\frac{\\partial \\lambda}{\\partial k_y}\\big|_{\\mathrm{fd}}\\right|}{\\max\\left(\\left|\\frac{\\partial \\lambda}{\\partial k_y}\\big|_{\\mathrm{fd}}\\right|, \\epsilon\\right)}, \\quad\n\\mathrm{err}_{L_T} = \\frac{\\left|\\frac{\\partial \\lambda}{\\partial L_T}\\big|_{\\mathrm{adj}} - \\frac{\\partial \\lambda}{\\partial L_T}\\big|_{\\mathrm{fd}}\\right|}{\\max\\left(\\left|\\frac{\\partial \\lambda}{\\partial L_T}\\big|_{\\mathrm{fd}}\\right|, \\epsilon\\right)},\n$$\n其中 $\\epsilon$ 是一个用于数值正则化的小的正实数常数。\n\n使用以下参数值测试套件来实现程序：\n- 情况 1：$k_y = 0.4$，$L_T = 3.0$，\n- 情况 2：$k_y = 0.1$，$L_T = 6.0$，\n- 情况 3：$k_y = 1.0$，$L_T = 1.5$，\n- 情况 4：$k_y = 0.05$，$L_T = 2.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots]$）。该列表必须按顺序包含每个情况的两个浮点数 $\\mathrm{err}_{k_y}$ 和 $\\mathrm{err}_{L_T}$，并将所有情况的结果连接起来，总共产生 8 个数字。所有量都是无量纲的，不需要进行物理单位转换。本问题不使用角度。不得使用百分比；所有比率必须表示为小数值。",
            "solution": "所提出的问题在科学上和数学上都是有效的。这是一个定义明确的计算科学练习，具体涉及对一个模拟物理系统的非厄米特征值问题进行灵敏度分析。所有必要的数据和定义都已提供，目标清晰。该问题是自包含、一致的，并且可以使用标准数值方法求解。因此，我们可以着手解决。\n\n该问题要求对一个含参数矩阵 $A(k_y, L_T)$ 的主导特征值进行灵敏度分析，该矩阵代表了离子温度梯度（ITG）模式的简化线性回旋动理学算子。特征值 $\\lambda$ 相对于参数 $p$ 的灵敏度是导数 $\\partial \\lambda / \\partial p$。我们将使用两种方法计算此导数：伴随方法（解析精确）和有限差分方法（用作数值验证）。\n\n系统由 $2 \\times 2$ 复矩阵描述：\n$$\nA(k_y, L_T) =\n\\begin{pmatrix}\n- i k_y   i k_y \\,\\alpha(L_T) \\\\\ni k_y \\,\\beta   -\\left(\\nu + i k_y \\,\\gamma(k_y)\\right)\n\\end{pmatrix}\n$$\n其中 $k_y$ 是副法向波数，$L_T$ 是离子温度梯度标长，$i$ 是虚数单位。函数 $\\alpha(L_T)$ 和 $\\gamma(k_y)$ 定义为：\n$$\n\\alpha(L_T) = a_T \\frac{L_n}{L_T}, \\qquad \\gamma(k_y) = g_0 + c_{\\mathrm{FLR}} k_y^2\n$$\n给定的常数为 $L_n = 2.0$，$a_T = 0.7$，$\\beta = 0.9$，$\\nu = 0.05$，$g_0 = 0.2$ 和 $c_{\\mathrm{FLR}} = 0.3$。\n\n系统线性微扰的演化由一个特征值问题控制。如果状态向量为 $z$，其时间演化为 $\\partial z / \\partial t = A z$。假设存在模式解 $z(t) = x e^{\\lambda t}$，我们得到右特征值问题：\n$$\nA x = \\lambda x\n$$\n特征值 $\\lambda$ 是复频率。虚部 $\\Im(\\lambda)$ 是模式的增长率。“主导”特征值是具有最大增长率的特征值，即虚部最大的那个。\n\n**基于伴随的灵敏度分析**\n\n矩阵 $A$ 是非厄米的，这对于包含自由能来源（如温度梯度）和耗散的系统是典型情况。对于此类系统，左、右特征向量并非简单的互为共轭转置。特征值 $\\lambda$ 对参数 $p$ 的灵敏度可以使用相应的左特征向量 $\\psi$ 推导得出。左特征值问题定义为 $\\psi^\\dagger A = \\lambda \\psi^\\dagger$，其中 $\\psi^\\dagger$ 是 $\\psi$ 的共轭转置。一个等价的表述是伴随矩阵 $A^\\dagger = A^T_c$（共轭转置）的右特征值问题：\n$$\nA^\\dagger \\psi = \\lambda^* \\psi\n$$\n其中 $\\lambda^*$ 是 $\\lambda$ 的复共轭。因此，$A$ 对应于特征值 $\\lambda$ 的左特征向量，是 $A^\\dagger$ 对应于特征值 $\\lambda^*$ 的右特征向量。\n\n通过对特征值方程 $A x = \\lambda x$ 关于参数 $p$ 求导，并从左侧乘以 $\\psi^\\dagger$，可以推导出著名的特征值灵敏度公式：\n$$\n\\frac{\\partial \\lambda}{\\partial p} = \\frac{\\psi^\\dagger \\left( \\frac{\\partial A}{\\partial p} \\right) x}{\\psi^\\dagger x}\n$$\n该公式是精确的，并且避免了计算特征向量导数的需要。\n\n要应用此公式，我们首先需要矩阵 $A$ 相对于参数 $k_y$ 和 $L_T$ 的导数。\n相对于 $L_T$ 的导数为：\n$$\n\\frac{\\partial A}{\\partial L_T} = \\begin{pmatrix} 0   i k_y \\frac{\\partial \\alpha}{\\partial L_T} \\\\ 0   0 \\end{pmatrix} = \\begin{pmatrix} 0   -i k_y \\frac{a_T L_n}{L_T^2} \\\\ 0   0 \\end{pmatrix}\n$$\n相对于 $k_y$ 的导数为：\n$$\n\\frac{\\partial A}{\\partial k_y} = \\frac{\\partial}{\\partial k_y} \\begin{pmatrix} - i k_y   i k_y \\alpha(L_T) \\\\ i k_y \\beta   -\\nu - i k_y g_0 - i c_{\\mathrm{FLR}} k_y^3 \\end{pmatrix} = \\begin{pmatrix} -i   i \\alpha(L_T) \\\\ i \\beta   -i g_0 - 3 i c_{\\mathrm{FLR}} k_y^2 \\end{pmatrix} = \\begin{pmatrix} -i   i \\alpha(L_T) \\\\ i \\beta   -i (g_0 + 3 c_{\\mathrm{FLR}} k_y^2) \\end{pmatrix}\n$$\n\n对于每个参数 $p \\in \\{k_y, L_T\\}$，伴随灵敏度的计算流程如下：\n1. 对于给定的对 $(k_y, L_T)$，构建矩阵 $A$。\n2. 求解右特征值问题 $A x_j = \\lambda_j x_j$，找到所有特征值和特征向量。\n3. 将虚部最大的特征值确定为主导特征值 $\\lambda$，并找到其对应的右特征向量 $x$。\n4. 构建伴随矩阵 $A^\\dagger$。\n5. 求解伴随特征值问题 $A^\\dagger \\psi_j = \\mu_j \\psi_j$。\n6. 通过寻找其特征值 $\\mu_j$ 是 $\\lambda$ 的复共轭（即 $\\mu_j \\approx \\lambda^*$）的特征向量 $\\psi_j$，来确定与 $\\lambda$ 对应的伴随特征向量 $\\psi$。\n7. 计算矩阵导数 $\\partial A / \\partial p$。\n8. 使用公式 $\\frac{\\psi^\\dagger (\\partial A / \\partial p) x}{\\psi^\\dagger x}$ 计算灵敏度 $\\partial \\lambda / \\partial p$。\n\n**有限差分验证**\n\n为了验证伴随灵敏度，我们使用中心有限差分公式计算数值近似：\n$$\n\\frac{\\partial \\lambda}{\\partial p} \\bigg|_{\\mathrm{fd}} \\approx \\frac{\\lambda(p+h) - \\lambda(p-h)}{2h}\n$$\n其中 $h$ 是一个小的正实数步长。一个数值上稳定的 $h$ 的选择必须足够小以最小化截断误差，但又足够大以避免浮点运算中的灾难性抵消。我们将使用 $h = 10^{-7}$。\n\n一个关键步骤是**模式追踪**。当我们计算微扰后矩阵（例如 $A(k_y+h, L_T)$）的特征值时，会得到一组新的特征值。我们必须确定这些新特征值中哪一个对应于未微扰系统的主导模式。这可以通过找到在复平面上与原始主导特征值 $\\lambda(k_y, L_T)$ 最接近的新特征值来实现。具体来说，我们计算微扰矩阵的特征值 $\\{\\lambda'_j\\}$，并选择使距离 $|\\lambda'_j - \\lambda(p)|$ 最小的那个作为 $\\lambda(p+h)$。同样的过程也适用于微扰 $p-h$。\n\n**误差计算**\n\n最后，对于每个测试用例和每个参数，我们计算伴随结果和有限差分结果之间的相对误差：\n$$\n\\mathrm{err}_{p} = \\frac{\\left|\\frac{\\partial \\lambda}{\\partial p}\\big|_{\\mathrm{adj}} - \\frac{\\partial \\lambda}{\\partial p}\\big|_{\\mathrm{fd}}\\right|}{\\max\\left(\\left|\\frac{\\partial \\lambda}{\\partial p}\\big|_{\\mathrm{fd}}\\right|, \\epsilon\\right)}\n$$\n正则化参数 $\\epsilon$ 可以防止除以一个非常小的数或零。我们选择 $\\epsilon = 10^{-14}$。一个小的误差可以验证我们伴随方法实现的正确性。\n\n下面的实现将为问题陈述中提供的每个测试用例系统地执行这些计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates adjoint-based sensitivities of a gyrofluid eigenvalue problem.\n    \"\"\"\n\n    # --- Fixed dimensionless constants ---\n    L_n = 2.0\n    a_T = 0.7\n    beta = 0.9\n    nu = 0.05\n    g_0 = 0.2\n    c_FLR = 0.3\n\n    # --- Numerical parameters ---\n    h = 1e-7  # Step size for finite differences\n    epsilon = 1e-14  # Regularization for error calculation\n\n    # --- Test cases ---\n    test_cases = [\n        (0.4, 3.0),  # Case 1: ky, LT\n        (0.1, 6.0),  # Case 2: ky, LT\n        (1.0, 1.5),  # Case 3: ky, LT\n        (0.05, 2.5), # Case 4: ky, LT\n    ]\n\n    # --- Helper functions for matrix construction ---\n    def alpha(LT):\n        return a_T * L_n / LT\n\n    def gamma(ky):\n        return g_0 + c_FLR * ky**2\n\n    def get_A(ky, LT):\n        \"\"\"Constructs the operator matrix A.\"\"\"\n        a = alpha(LT)\n        g = gamma(ky)\n        A = np.array([\n            [-1j * ky, 1j * ky * a],\n            [1j * ky * beta, -(nu + 1j * ky * g)]\n        ], dtype=np.complex128)\n        return A\n\n    def get_dA_dky(ky, LT):\n        \"\"\"Constructs the derivative of A with respect to ky.\"\"\"\n        a = alpha(LT)\n        dA = np.array([\n            [-1j, 1j * a],\n            [1j * beta, -1j * (g_0 + 3 * c_FLR * ky**2)]\n        ], dtype=np.complex128)\n        return dA\n\n    def get_dA_dLT(ky, LT):\n        \"\"\"Constructs the derivative of A with respect to LT.\"\"\"\n        dA = np.array([\n            [0, -1j * ky * a_T * L_n / LT**2],\n            [0, 0]\n        ], dtype=np.complex128)\n        return dA\n\n    results = []\n    \n    for ky_0, LT_0 in test_cases:\n        # --- Base Calculation at (ky_0, LT_0) ---\n        A_0 = get_A(ky_0, LT_0)\n        \n        # Solve for right eigenpairs\n        lams, vecs = np.linalg.eig(A_0)\n        \n        # Find dominant mode (largest imaginary part)\n        idx_dom = np.argmax(lams.imag)\n        lam_dom = lams[idx_dom]\n        x_dom = vecs[:, idx_dom]\n        \n        # --- Adjoint Sensitivity Calculation ---\n        \n        # Solve for left eigenpairs (eigenvectors of A dagger)\n        A_adj = A_0.T.conj()\n        lams_adj, vecs_adj = np.linalg.eig(A_adj)\n        \n        # Find the adjoint eigenvector corresponding to the dominant mode\n        idx_adj = np.argmin(np.abs(lams_adj - lam_dom.conj()))\n        psi_dom = vecs_adj[:, idx_adj]\n        \n        # Calculate matrix-vector products\n        denominator = psi_dom.conj().T @ x_dom\n        \n        # Sensitivity w.r.t. ky\n        dA_dky = get_dA_dky(ky_0, LT_0)\n        numerator_ky = psi_dom.conj().T @ dA_dky @ x_dom\n        sens_ky_adj = numerator_ky / denominator\n        \n        # Sensitivity w.r.t. LT\n        dA_dLT = get_dA_dLT(ky_0, LT_0)\n        numerator_LT = psi_dom.conj().T @ dA_dLT @ x_dom\n        sens_LT_adj = numerator_LT / denominator\n\n        # --- Finite-Difference Validation ---\n\n        # Perturbation for ky\n        A_p_ky = get_A(ky_0 + h, LT_0)\n        A_m_ky = get_A(ky_0 - h, LT_0)\n        lams_p_ky, _ = np.linalg.eig(A_p_ky)\n        lams_m_ky, _ = np.linalg.eig(A_m_ky)\n        # Mode tracking\n        lam_p_ky = lams_p_ky[np.argmin(np.abs(lams_p_ky - lam_dom))]\n        lam_m_ky = lams_m_ky[np.argmin(np.abs(lams_m_ky - lam_dom))]\n        sens_ky_fd = (lam_p_ky - lam_m_ky) / (2 * h)\n\n        # Perturbation for LT\n        A_p_LT = get_A(ky_0, LT_0 + h)\n        A_m_LT = get_A(ky_0, LT_0 - h)\n        lams_p_LT, _ = np.linalg.eig(A_p_LT)\n        lams_m_LT, _ = np.linalg.eig(A_m_LT)\n        # Mode tracking\n        lam_p_LT = lams_p_LT[np.argmin(np.abs(lams_p_LT - lam_dom))]\n        lam_m_LT = lams_m_LT[np.argmin(np.abs(lams_m_LT - lam_dom))]\n        sens_LT_fd = (lam_p_LT - lam_m_LT) / (2 * h)\n\n        # --- Error Calculation ---\n        err_ky = np.abs(sens_ky_adj - sens_ky_fd) / max(np.abs(sens_ky_fd), epsilon)\n        err_LT = np.abs(sens_LT_adj - sens_LT_fd) / max(np.abs(sens_LT_fd), epsilon)\n        \n        results.extend([err_ky, err_LT])\n        \n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}