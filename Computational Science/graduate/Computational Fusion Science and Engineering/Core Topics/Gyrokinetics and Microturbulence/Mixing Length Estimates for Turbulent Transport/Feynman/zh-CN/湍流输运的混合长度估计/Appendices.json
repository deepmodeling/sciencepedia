{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳方式之一是通过动手推导来巩固。本练习将引导你从最基本的物理原理出发——即由电场和磁场引起的 $E \\times B$ 漂移——来推导出一个估算湍流输运的关键模型。通过将单个傅里叶模式下的漂移速度与混合长度理论相结合，你将亲自推导出湍流扩散系数的一个基本表达式，即 $\\chi \\sim \\gamma / k_{\\perp}^2$，从而深刻理解微观波动如何导致宏观输运。",
            "id": "4013105",
            "problem": "考虑一个均匀的、磁化的静电等离子体，其磁场为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$，其中 $B$ 在空间上是常数。涨落的静电势由单个傅里叶模式给出，其形式为 $\\tilde{\\phi}(\\mathbf{x},t) = \\Re\\{\\tilde{\\phi}_{\\mathbf{k}}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)]\\}$，其中 $\\tilde{\\phi}_{\\mathbf{k}}$ 是复振幅，$\\omega$ 是频率，$\\mathbf{k}$ 是波矢。基本定义如下：电场 $\\mathbf{E} = -\\nabla \\tilde{\\phi}$ 和电场叉磁场（E$\\times$B）漂移速度 $\\mathbf{v}_E = \\mathbf{E} \\times \\mathbf{B} / B^2$。设垂直波数为 $k_\\perp = |\\mathbf{k} - (\\mathbf{k}\\cdot\\hat{\\mathbf{b}})\\hat{\\mathbf{b}}|$，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/B$。\n\n仅使用这些定义和单模式表示，首先推导涨落的E$\\times$B漂移速率的模 $|\\tilde{v}_E|$ 的表达式，用 $k_\\perp$、$|\\tilde{\\phi}_{\\mathbf{k}}|$ 和 $B$ 表示。然后，引用湍流输运的混合长度估计，其中非线性退相干率与E$\\times$B剪切率相当，即 $\\gamma \\sim k_\\perp |\\tilde{v}_E|$，求出跨场扩散系数 $\\chi$ 的解析表达式，用 $k_\\perp$、$|\\tilde{\\phi}_{\\mathbf{k}}|$ 和 $B$ 表示。\n\n最后，根据给定的参数 $B = 3.5\\,\\mathrm{T}$，$k_\\perp = 800\\,\\mathrm{m}^{-1}$ 和 $|\\tilde{\\phi}_{\\mathbf{k}}| = 25\\,\\mathrm{V}$ 计算 $\\chi$ 的值。将最终的扩散系数以平方米每秒（$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估具有科学依据、提法恰当、客观且内部一致。它基于等离子体物理和湍流理论的标准定义和模型，特别是静电漂移波湍流。推导和计算所需的所有信息均已提供。物理参数对于磁约束聚变等离子体是符合实际的。因此，该问题被认为是有效的，并将提供解答。\n\n目标是首先推导出涨落的E$\\times$B漂移速度的模 $|\\tilde{v}_E|$，然后在一个混合长度模型中使用它来找到跨场扩散系数 $\\chi$ 的表达式，最后根据给定的参数计算 $\\chi$ 的值。\n\n涨落的静电势由单个傅里叶模式给出：\n$$\n\\tilde{\\phi}(\\mathbf{x},t) = \\Re\\{\\tilde{\\phi}_{\\mathbf{k}}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)]\\}\n$$\n为使推导清晰，我们将使用势的复数表示 $\\Phi(\\mathbf{x},t) = \\tilde{\\phi}_{\\mathbf{k}}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)]$，并仅在必要时取其实部。\n\n电场 $\\mathbf{E}$ 定义为势的负梯度，$\\mathbf{E} = -\\nabla \\tilde{\\phi}$。复数电场为：\n$$\n\\mathbf{E}_{\\text{complex}} = -\\nabla \\Phi = -\\nabla \\left( \\tilde{\\phi}_{\\mathbf{k}}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)] \\right)\n$$\n梯度算子 $\\nabla$ 作用于空间部分 $\\exp(i\\mathbf{k}\\cdot\\mathbf{x})$ 会产生一个因子 $i\\mathbf{k}$。\n$$\n\\mathbf{E}_{\\text{complex}} = -i\\mathbf{k}\\,\\tilde{\\phi}_{\\mathbf{k}}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)] = -i\\mathbf{k}\\,\\Phi\n$$\nE$\\times$B漂移速度定义为 $\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}$。我们使用复数电场来求复数速度：\n$$\n\\mathbf{v}_{E, \\text{complex}} = \\frac{\\mathbf{E}_{\\text{complex}} \\times \\mathbf{B}}{B^2} = \\frac{(-i\\mathbf{k}\\,\\Phi) \\times (B\\hat{\\mathbf{z}})}{B^2} = -\\frac{i\\Phi}{B}(\\mathbf{k} \\times \\hat{\\mathbf{z}})\n$$\n其中我们使用了 $\\mathbf{B} = B\\hat{\\mathbf{z}}$。物理上随时间变化的速度是 $\\mathbf{v}_E(t) = \\Re\\{\\mathbf{v}_{E, \\text{complex}}\\}$。问题要求的是涨落速率的模，在此背景下指的是振荡的振幅。复数速度矢量的振幅为：\n$$\n|\\tilde{v}_E| = \\left| -\\frac{i\\tilde{\\phi}_{\\mathbf{k}}}{B}(\\mathbf{k} \\times \\hat{\\mathbf{z}}) \\right|\n$$\n使用性质 $|-i|=1$ 并分离出模：\n$$\n|\\tilde{v}_E| = \\frac{|\\tilde{\\phi}_{\\mathbf{k}}|}{B}|\\mathbf{k} \\times \\hat{\\mathbf{z}}|\n$$\n波矢 $\\mathbf{k}$ 可以分解为平行于磁场和垂直于磁场的分量：$\\mathbf{k} = \\mathbf{k}_{\\perp} + k_{\\parallel}\\hat{\\mathbf{z}}$。叉积为：\n$$\n\\mathbf{k} \\times \\hat{\\mathbf{z}} = (\\mathbf{k}_{\\perp} + k_{\\parallel}\\hat{\\mathbf{z}}) \\times \\hat{\\mathbf{z}} = \\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}} + k_{\\parallel}(\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{z}}) = \\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}\n$$\n由于根据定义 $\\mathbf{k}_{\\perp}$ 垂直于 $\\hat{\\mathbf{z}}$，它们的叉积的模为 $|\\mathbf{k}_{\\perp} \\times \\hat{\\mathbf{z}}| = |\\mathbf{k}_{\\perp}||\\hat{\\mathbf{z}}|\\sin(\\frac{\\pi}{2}) = k_{\\perp}$。问题中 $k_\\perp = |\\mathbf{k} - (\\mathbf{k}\\cdot\\hat{\\mathbf{b}})\\hat{\\mathbf{b}}|$ （其中 $\\hat{\\mathbf{b}} = \\hat{\\mathbf{z}}$）的定义与此分解是一致的。\n因此，E$\\times$B漂移速率的模为：\n$$\n|\\tilde{v}_E| = \\frac{k_\\perp |\\tilde{\\phi}_{\\mathbf{k}}|}{B}\n$$\n这是第一个所求的表达式。\n\n接下来，我们使用非线性退相干率 $\\gamma$ 的混合长度估计，该估计假定其量级与E$\\times$B剪切率相当，即 $\\gamma \\sim k_\\perp |\\tilde{v}_E|$。在混合长度理论中，这被视为一个等式：\n$$\n\\gamma = k_\\perp |\\tilde{v}_E|\n$$\n代入我们得到的 $|\\tilde{v}_E|$ 表达式：\n$$\n\\gamma = k_\\perp \\left( \\frac{k_\\perp |\\tilde{\\phi}_{\\mathbf{k}}|}{B} \\right) = \\frac{k_\\perp^2 |\\tilde{\\phi}_{\\mathbf{k}}|}{B}\n$$\n跨场扩散系数 $\\chi$ 是通过一个随机行走模型估算的，其中粒子在特征时间（退相干时间 $\\tau_c$）内走过一个特征径向尺寸（“混合长度” $L_m$）的步长。扩散系数为 $\\chi \\sim L_m^2 / \\tau_c$。在此背景下，混合长度是涨落的垂直尺度，$L_m \\sim 1/k_\\perp$，而退相干时间是退相干率的倒数，$\\tau_c \\sim 1/\\gamma$。这得出了准线性或混合长度扩散系数的标准表达式：\n$$\n\\chi = \\frac{\\gamma}{k_\\perp^2}\n$$\n代入我们得到的 $\\gamma$ 表达式：\n$$\n\\chi = \\frac{1}{k_\\perp^2} \\left( \\frac{k_\\perp^2 |\\tilde{\\phi}_{\\mathbf{k}}|}{B} \\right) = \\frac{|\\tilde{\\phi}_{\\mathbf{k}}|}{B}\n$$\n这就是所求的跨场扩散系数 $\\chi$ 的解析表达式。值得注意的是，对 $k_\\perp$ 的依赖性被消除了，这是这种E$\\times$B混合长度模型的一个典型结果。\n\n最后，我们使用给定的数值来计算 $\\chi$：\n$B = 3.5\\,\\mathrm{T}$\n$|\\tilde{\\phi}_{\\mathbf{k}}| = 25\\,\\mathrm{V}$\n\n$k_\\perp = 800\\,\\mathrm{m}^{-1}$ 的值在最终计算 $\\chi$ 时是不需要的。\n$$\n\\chi = \\frac{25\\,\\mathrm{V}}{3.5\\,\\mathrm{T}} = \\frac{25}{3.5}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} = \\frac{50}{7}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n计算数值并将结果四舍五入到四位有效数字：\n$$\n\\chi \\approx 7.142857... \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\approx 7.143\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{7.143}\n$$"
        },
        {
            "introduction": "在掌握了基本的混合长度扩散系数公式后，下一步是将其应用于具体的物理场景，以获得更具洞察力的物理定标率。本练习将探讨静电漂移波湍流，这是托卡马克芯部等离子体中的一种主要微观不稳定性。通过运用回旋动理学排序（gyrokinetic ordering）中的关键假设，如 $k_{\\perp} \\rho_i \\sim O(1)$，你将从 $\\chi \\sim \\gamma / k_{\\perp}^2$ 出发，推导出著名的“回旋玻姆”（gyro-Bohm）定标率，它将扩散系数与等离子体的基本微观参数联系起来。",
            "id": "4013124",
            "problem": "在强磁化托卡马克芯部，考虑输运离子热量穿过磁通面的静电漂移波湍流。设等离子体数密度为 $n(r)$，径向梯度标长为 $L_n \\equiv -\\left(\\frac{d\\ln n}{dr}\\right)^{-1}$。定义离子声速 $c_s \\equiv \\sqrt{\\frac{T_e}{m_i}}$，离子回旋频率 $\\Omega_i \\equiv \\frac{e B}{m_i}$，以及离子热吉罗半径 $\\rho_i \\equiv \\frac{v_{Thi}}{\\Omega_i}$，其中 $v_{Thi} \\equiv \\sqrt{\\frac{T_i}{m_i}}$。设湍流由垂直波数 $k_{\\perp}$ 和副法向波数 $k_y$（两者均垂直于磁场）表征，根据回旋动理学级数，有 $k_{\\perp} \\rho_i \\sim O(1)$ 和 $k_y \\sim k_{\\perp}$。假设 $T_i \\approx T_e$，因此在领头阶上，离子声吉罗半径 $\\rho_s \\equiv \\frac{c_s}{\\Omega_i}$ 满足 $\\rho_s \\approx \\rho_i$。\n\n采用混合长度假设，即湍流离子热扩散系数 $\\chi$ 的标度关系类似于关联长度的平方除以退关联时间，并将退关联率用线性不稳定性增长率来建模。具体来说，取退关联率与电子抗磁漂移频率 $\\omega_{*e}$ 同量级，并使用\n- 特征垂直关联长度 $\\ell_c \\sim k_{\\perp}^{-1}$，\n- 退关联时间 $\\tau_c \\sim \\gamma^{-1}$，其中 $\\gamma \\sim \\omega_{*e}$，\n- 以及 $\\omega_{*e} \\equiv \\frac{k_y T_e}{e B L_n} = \\frac{k_y \\rho_s c_s}{L_n}$。\n\n仅使用这些假设和级数关系，推导离子热扩散系数标度关系 $\\chi$ 关于 $\\rho_i$、$c_s$ 和 $L_n$ 的领头阶表达式，忽略所有量级为1的数值系数。清晰地陈述将假设与最终标度关系联系起来所需的任何中间步骤。然后，用文字说明在何种物理级数条件下，这种所谓的 gyro-Bohm 标度关系预计在磁化聚变等离子体中成立。\n\n将 $\\chi$ 的最终答案表示为单位为 $\\mathrm{m^2\\,s^{-1}}$ 的单个符号表达式；不要在最终的方框答案中包含单位。不需要进行数值计算。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 等离子体数密度: $n(r)$\n- 径向梯度标长: $L_n \\equiv -\\left(\\frac{d\\ln n}{dr}\\right)^{-1}$\n- 离子声速: $c_s \\equiv \\sqrt{\\frac{T_e}{m_i}}$\n- 离子回旋频率: $\\Omega_i \\equiv \\frac{e B}{m_i}$\n- 离子热吉罗半径: $\\rho_i \\equiv \\frac{v_{Thi}}{\\Omega_i}$\n- 离子热速度: $v_{Thi} \\equiv \\sqrt{\\frac{T_i}{m_i}}$\n- 垂直波数: $k_{\\perp}$\n- 副法向波数: $k_y$\n- 回旋动理学级数: $k_{\\perp} \\rho_i \\sim O(1)$ 且 $k_y \\sim k_{\\perp}$\n- 温度近似: $T_i \\approx T_e$\n- 温度近似的推论: $\\rho_s \\approx \\rho_i$，其中 $\\rho_s \\equiv \\frac{c_s}{\\Omega_i}$\n- 离子热扩散系数的混合长度假设: $\\chi \\sim \\frac{\\ell_c^2}{\\tau_c}$\n- 特征垂直关联长度: $\\ell_c \\sim k_{\\perp}^{-1}$\n- 退关联时间: $\\tau_c \\sim \\gamma^{-1}$\n- 退关联率（线性不稳定性增长率）: $\\gamma \\sim \\omega_{*e}$\n- 电子抗磁漂移频率: $\\omega_{*e} \\equiv \\frac{k_y T_e}{e B L_n} = \\frac{k_y \\rho_s c_s}{L_n}$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题定义明确，具有科学依据。所有术语和概念——例如离子声速 $c_s$、吉罗半径 $\\rho_i$、抗磁漂移频率 $\\omega_{*e}$ 和梯度标长 $L_n$——都是等离子体物理和聚变科学中的标准术语。混合长度假设 $\\chi \\sim \\gamma/k^2$ 是湍流输运的一个基础启发式模型。回旋动理学级数 $k_{\\perp} \\rho_i \\sim O(1)$ 是现代漂移波湍流理论的基石。该问题是自洽的，提供了推导所要求的标度律所需的所有必要定义和假设。没有矛盾、歧义或违反物理原理之处。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将推导解答。\n\n离子热扩散系数标度关系（称为 gyro-Bohm 标度）的推导从混合长度假设开始。问题陈述指出，湍流离子热扩散系数 $\\chi$ 被估计为特征关联长度 $\\ell_c$ 的平方与特征退关联时间 $\\tau_c$ 的比值。\n$$\n\\chi \\sim \\frac{\\ell_c^2}{\\tau_c}\n$$\n问题为这些特征尺度提供了模型。关联长度 $\\ell_c$ 取为特征垂直波数 $k_{\\perp}$ 的倒数，退关联时间 $\\tau_c$ 取为线性不稳定性增长率 $\\gamma$ 的倒数。\n$$\n\\ell_c \\sim k_{\\perp}^{-1} \\quad \\text{和} \\quad \\tau_c \\sim \\gamma^{-1}\n$$\n将这些代入 $\\chi$ 的表达式，得到混合长度估计的常见形式：\n$$\n\\chi \\sim \\frac{(k_{\\perp}^{-1})^2}{\\gamma^{-1}} = \\frac{\\gamma}{k_{\\perp}^2}\n$$\n假设退关联率 $\\gamma$ 与电子抗磁漂移频率 $\\omega_{*e}$ 成标度关系。\n$$\n\\gamma \\sim \\omega_{*e}\n$$\n这导致：\n$$\n\\chi \\sim \\frac{\\omega_{*e}}{k_{\\perp}^2}\n$$\n问题提供了 $\\omega_{*e}$ 的定义：\n$$\n\\omega_{*e} = \\frac{k_y \\rho_s c_s}{L_n}\n$$\n其中 $\\rho_s$ 是离子声吉罗半径。将此定义代入 $\\chi$ 的表达式中：\n$$\n\\chi \\sim \\frac{1}{k_{\\perp}^2} \\left( \\frac{k_y \\rho_s c_s}{L_n} \\right)\n$$\n为消去波数 $k_y$ 和 $k_{\\perp}$，我们采用所给定的回旋动理学级数关系。首先，假设湍流是各向异性的，但在垂直于磁场的方向上具有可比的尺度，因此 $k_y \\sim k_{\\perp}$。这允许我们在标度关系中用 $k_{\\perp}$ 替换 $k_y$，因为我们忽略了量级为1的数值因子。\n$$\n\\chi \\sim \\frac{1}{k_{\\perp}^2} \\left( \\frac{k_{\\perp} \\rho_s c_s}{L_n} \\right) = \\frac{\\rho_s c_s}{k_{\\perp} L_n}\n$$\n接下来，我们使用漂移波湍流的基本回旋动理学级数关系，该关系假定湍流的垂直尺度与离子吉罗半径的量级相同。这表示为 $k_{\\perp} \\rho_i \\sim O(1)$，意味着 $k_{\\perp} \\sim \\rho_i^{-1}$。将此代入我们对 $\\chi$ 的表达式中：\n$$\n\\chi \\sim \\frac{\\rho_s c_s}{(\\rho_i^{-1}) L_n} = \\frac{\\rho_s c_s \\rho_i}{L_n}\n$$\n最后，我们使用所给的近似，即离子和电子温度是可比的，$T_i \\approx T_e$。这意味着离子热速度 $v_{Thi} = \\sqrt{T_i/m_i}$ 近似等于离子声速 $c_s = \\sqrt{T_e/m_i}$。因此，离子热吉罗半径 $\\rho_i = v_{Thi}/\\Omega_i$ 近似等于离子声吉罗半径 $\\rho_s = c_s/\\Omega_i$。使用这个等价关系，$\\rho_s \\approx \\rho_i$：\n$$\n\\chi \\sim \\frac{\\rho_i c_s \\rho_i}{L_n} = \\frac{\\rho_i^2 c_s}{L_n}\n$$\n这是离子热扩散系数的 gyro-Bohm 标度关系的最终表达式。\n\n预计此 gyro-Bohm 标度关系成立的物理级数条件是推导过程中固有的条件。Gyro-Bohm 标度是由局域、小尺度湍流驱动的输运的特征。主要条件是湍流涡旋的特征垂直尺寸与一个微观等离子体参数成标度关系，具体来说是热离子吉罗半径 $\\rho_i$。这被形式化地表示为级数关系 $k_{\\perp} \\rho_i \\sim O(1)$。这个条件意味着输运是“局域的”，不依赖于装置的全局尺寸（例如，小半径）。这与“Bohm”标度形成对比，后者在湍流尺度长度与装置尺寸成正比时出现。因此，在由诸如离子温度梯度（ITG）模或捕获电子模（TEM）等微观不稳定性主导输运的区域，预计会出现 gyro-Bohm 标度，因为这些不稳定性通常具有量级为 $\\rho_i$ 的垂直波长。",
            "answer": "$$\n\\boxed{\\frac{\\rho_i^2 c_s}{L_n}}\n$$"
        },
        {
            "introduction": "理论模型最终需要服务于实际的计算和预测。本练习旨在弥合解析理论与计算实践之间的鸿沟，这对于计算聚变科学领域的工程师和科学家至关重要。你将扮演一名输运建模者的角色，任务是利用来自大型回旋动理学代码的离散线性增长率谱数据，设计一个算法来计算混合长度扩散系数。这个过程不仅巩固了 $D = \\gamma/k_{\\perp}^2$ 的物理模型，还让你直面在实际应用中如何从众多不稳定的模式中选择最关键的输运驱动模式的挑战。",
            "id": "4013066",
            "problem": "本任务要求设计并实现一个数值算法，该算法适用于计算聚变科学与工程中的输运求解器，用于基于混合长概念，利用回旋动理学计算得到的表格化线性增长率，来估算给定径向位置的湍流扩散系数。该问题重点在于推导和计算实现一个混合长扩散率标度律，并根据原则从表格化数据中选择垂直波数。推导必须从与磁化等离子体湍流相关的公认物理原理出发，并且算法必须解决在使用线性求解器的离散谱时遇到的实际问题。\n\n出发点与假设：\n- 湍流输运主要由与电场涨落相关的静电漂移速度引起的平流混合所主导。假设在饱和湍流中，非线性退相干与线性驱动相当，那么平面平均的跨场标量扩散系数$D$的大小可以通过特征平流速度的平方与特征退相干率之比来估算。\n- 非线性退相干率估算为垂直波数与特征$E \\times B$漂移速度的乘积。\n- 线性回旋动理学求解器（例如，Gyrokinetic Electromagnetic Numerical Experiment (GENE) 或 Gyrokinetic Stability (GS2) 代码）能生成在给定径向位置和平衡下，作为垂直波数$k$的函数的表格化线性增长率$\\gamma(k)$。这些增长率是混合长估算的输入，对于不稳定模式其为非负值，否则为非正值。\n\n推导任务：\n1. 从静电$E \\times B$漂移的定义以及非线性退相干与线性增长平衡导致饱和的假设出发，推导出一个仅用线性增长率$\\gamma$和垂直波数$k_\\perp$表示的湍流扩散系数$D$的混合长标度律。\n2. 清晰陈述所使用的任何假设，并使用量纲分析和饱和平衡来论证该标度律的合理性。\n\n算法设计任务：\n- 使用推导出的标度律，设计一个算法，从表格化谱$\\{(k_i, \\gamma_i)\\}_{i=1}^N$中选择一个单一的有效垂直波数$k_\\perp^\\ast$来评估扩散系数。该算法必须：\n  - 通过将模式限制在无量纲尺度$k_\\perp \\rho_s$处于指定区间$[k_{\\rho,\\min}, k_{\\rho,\\max}]$内来确保物理相关性，其中$\\rho_s$是声拉莫尔半径。声拉莫尔半径必须使用标准定义，根据电子温度$T_e$、磁场强度$B$和离子质量$m_i$计算得出。\n  - 通过在选择前将任何负的线性增长率替换为零来处理稳定模式。\n  - 当没有表格化模式位于指定的$k_\\perp \\rho_s$区间内时，提供一个后备方案。在这种情况下，使用梯度限制的相关长度，方法是将每个$k_i$替换为一个有效的$k_{\\mathrm{eff},i} = \\max(k_i, 1/L)$，其中$L$是给定的梯度标长，然后基于推导出的标度律使用$k_{\\mathrm{eff},i}$进行选择。\n  - 在所有容许的候选模式中，选择能够使推导出的混合长扩散系数最大化的$k_\\perp^\\ast$。\n- 清晰说明所需的单位和转换：$k$的单位是$\\mathrm{m}^{-1}$，$\\gamma$的单位是$\\mathrm{s}^{-1}$，$B$的单位是$\\mathrm{T}$，$T_e$的单位是电子伏特，$m_i$的单位是$\\mathrm{kg}$，$L$的单位是$\\mathrm{m}$，最终得到的$D$的单位是$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。使用$e$表示基本电荷，单位为库仑，并将$T_e$从电子伏特转换为焦耳。\n\n使用的定义：\n- 静电$E \\times B$漂移速度大小为$|\\mathbf{v}_E| = |\\mathbf{E} \\times \\mathbf{B}|/B^2$，其中在波数$k_\\perp$下，$|\\mathbf{E}| \\sim |\\nabla \\phi|$且$|\\nabla \\phi| \\sim k_\\perp |\\phi|$。\n- 非线性退相干率为$\\omega_{\\mathrm{nl}} \\sim k_\\perp |\\mathbf{v}_E|$。\n- 对于主导模式，饱和状态由$\\gamma \\sim \\omega_{\\mathrm{nl}}$估算。\n- 声速为$c_s = \\sqrt{T_e/m_i}$（其中$T_e$单位为焦耳），离子回旋频率为$\\Omega_{ci} = e B / m_i$，声拉莫尔半径为$\\rho_s = c_s/\\Omega_{ci}$。\n\n程序要求：\n- 实现一个完整、可运行的程序，该程序：\n  - 不接受任何输入，并使用下述固定的测试套件。\n  - 对于每个测试案例，计算$\\rho_s$，使用$k_\\perp \\rho_s$区间构建容许集，对$\\gamma$应用正性条件，在需要时使用$k_{\\mathrm{eff}}$执行后备方案，选择$k_\\perp^\\ast$，并使用推导出的标度律计算混合长扩散系数。\n  - 生成单行输出，其中包含所有测试案例的结果，结果为方括号内以逗号分隔的列表，每个值都以$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$为单位并四舍五入到六位小数。\n\n测试套件：\n- 案例1（一般情况，存在一个明确的容许最大值）：\n  - $B = 3.0\\,\\mathrm{T}$，$T_e = 2000\\,\\mathrm{eV}$，$m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$，$L = 0.2\\,\\mathrm{m}$，\n  - $k$ 数组（单位 $\\mathrm{m}^{-1}$）：$[100.0, 200.0, 400.0, 800.0, 1600.0]$，\n  - $\\gamma$ 数组（单位 $\\mathrm{s}^{-1}$）：$[1.0 \\times 10^5, 3.0 \\times 10^5, 4.0 \\times 10^5, 2.0 \\times 10^5, 1.0 \\times 10^5]$，\n  - $k_\\perp \\rho_s$ 窗口：$[0.2, 1.5]$。\n- 案例2（边界情况，没有不稳定模式）：\n  - $B = 2.1\\,\\mathrm{T}$，$T_e = 1000\\,\\mathrm{eV}$，$m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$，$L = 0.3\\,\\mathrm{m}$，\n  - $k$ 数组（单位 $\\mathrm{m}^{-1}$）：$[100.0, 200.0, 400.0]$，\n  - $\\gamma$ 数组（单位 $\\mathrm{s}^{-1}$）：$[-2.0 \\times 10^4, -1.0 \\times 10^4, 0.0]$，\n  - $k_\\perp \\rho_s$ 窗口：$[0.2, 1.5]$。\n- 案例3（边缘情况，窗口内没有容许模式，需要后备方案）：\n  - $B = 5.0\\,\\mathrm{T}$，$T_e = 1000\\,\\mathrm{eV}$，$m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$，$L = 0.5\\,\\mathrm{m}$，\n  - $k$ 数组（单位 $\\mathrm{m}^{-1}$）：$[50.0, 80.0, 100.0]$，\n  - $\\gamma$ 数组（单位 $\\mathrm{s}^{-1}$）：$[5.0 \\times 10^4, 8.0 \\times 10^4, 9.0 \\times 10^4]$，\n  - $k_\\perp \\rho_s$ 窗口：$[0.2, 1.5]$。\n\n答案规格：\n- 最终的扩散系数以$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$为单位表示。\n- 将每个值四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，例如$[d_1,d_2,d_3]$，其中每个$d_i$是代表相应测试案例扩散系数的、四舍五入到六位小数的十进制数。",
            "solution": "该问题陈述是计算等离子体物理学中一个有效的、适定的问题。它在科学上基于已建立但简化的湍流输运混合长理论。所提供的参数对于磁约束聚变等离子体是物理上现实的。该问题是自洽的，为获得唯一解提供了所有必要的数据和定义。算法要求具体且逻辑一致，包括对边缘情况的处理。因此，将提供一个解决方案。\n\n根据要求，解决方案分两部分呈现：首先，物理模型的推导；其次，数值算法的设计。\n\n### 1. 混合长扩散率标度律的推导\n\n目标是推导湍流扩散系数$D$关于线性增长率$\\gamma$和垂直波数$k_\\perp$的标度律。\n\n湍流扩散系数的一个标准模型基于随机行走过程，其中$D$由特征步长的平方$(\\Delta x)^2$与步频$f$的乘积给出。在流体湍流中，这通常表示为$D \\sim v^2 \\tau_c$，其中$v$是特征涨落速度，$\\tau_c$是湍涡的相关时间。\n\n问题指明输运由静电$\\mathbf{E} \\times \\mathbf{B}$漂移主导。因此，特征速度$v$是$\\mathbf{E} \\times \\mathbf{B}$漂移速度的大小，$|\\mathbf{v}_E|$。\n$$\n|\\mathbf{v}_E| = \\frac{|\\mathbf{E}|}{B}\n$$\n其中$\\mathbf{E}$是涨落电场，$B$是背景磁场的大小。对于具有垂直波数$k_\\perp$的单个傅里叶模式，电场通过$\\mathbf{E} = -\\nabla \\phi$与静电势$\\phi$相关，因此其大小可以估算为$|\\mathbf{E}| \\sim k_\\perp |\\phi|$。\n\n相关时间$\\tau_c$是湍涡维持其结构的时间。在饱和湍流中，这个时间受到该涡被其他涡非线性平流的限制。这个过程的速率，即非线性退相干率$\\omega_{\\mathrm{nl}}$，估算为平流涡的特征速度$|\\mathbf{v}_E|$除以其特征尺寸$1/k_\\perp$。问题提供了这个标度关系：\n$$\n\\omega_{\\mathrm{nl}} \\sim k_\\perp |\\mathbf{v}_E|\n$$\n相关时间是该速率的倒数：$\\tau_c \\sim 1/\\omega_{\\mathrm{nl}} \\sim 1/(k_\\perp |\\mathbf{v}_E|)$。\n\n结合这些要素，扩散系数由下式给出：\n$$\nD \\sim |\\mathbf{v}_E|^2 \\tau_c \\sim |\\mathbf{v}_E|^2 \\frac{1}{k_\\perp |\\mathbf{v}_E|} = \\frac{|\\mathbf{v}_E|}{k_\\perp}\n$$\n\n为了闭合这个表达式，我们需要估算饱和速度涨落的大小，$|\\mathbf{v}_E|$。混合长理论的核心假设是，不稳定性以线性增长率$\\gamma$指数增长，直到非线性退相干效应变得足够强以平衡线性驱动。这个饱和条件表示为：\n$$\n\\gamma \\sim \\omega_{\\mathrm{nl}}\n$$\n代入$\\omega_{\\mathrm{nl}}$的表达式：\n$$\n\\gamma \\sim k_\\perp |\\mathbf{v}_E|\n$$\n这使我们能够用已知的线性增长率来估算饱和漂移速度：\n$$\n|\\mathbf{v}_E| \\sim \\frac{\\gamma}{k_\\perp}\n$$\n最后，将这个$|\\mathbf{v}_E|$的估算值代回到$D$的表达式中：\n$$\nD \\sim \\frac{(\\gamma/k_\\perp)}{k_\\perp} = \\frac{\\gamma}{k_\\perp^2}\n$$\n这就是所期望的混合长标度律。为了解决这个问题，我们假设无量纲比例常数为1，从而得到最终表达式：\n$$\nD = \\frac{\\gamma}{k_\\perp^2}\n$$\n\n**论证：**\n该标度律在物理上和量纲上都是一致的。\n-   **量纲分析**：$\\gamma$的单位是时间的倒数（$s^{-1}$），$k_\\perp$的单位是长度的倒数（$m^{-1}$）。因此，$D$的单位是：\n    $$\n    [D] = \\frac{[\\gamma]}{[k_\\perp]^2} = \\frac{s^{-1}}{(m^{-1})^2} = \\frac{s^{-1}}{m^{-2}} = m^2 s^{-1}\n    $$\n    这是扩散系数的正确单位。\n-   **饱和平衡**：该推导从根本上基于线性驱动（$\\gamma$）和非线性饱和（$\\omega_{\\mathrm{nl}}$）之间的平衡，这是湍流饱和理论的基石。它假定更强的线性不稳定性（更大的$\\gamma$）导致更大的饱和振幅，从而导致更大的输运，这通过与$\\gamma$的正比关系得以体现。$1/k_\\perp^2$的依赖关系反映了对于给定的涨落振幅，较小的涡（较大的$k_\\perp$）在大尺度输运方面效率较低。\n\n### 2. 算法设计\n\n该算法通过从给定谱中选择最主导的模式来计算湍流扩散系数，基于推导出的标度律$D = \\gamma/k_\\perp^2$。\n\n**每个案例的输入：**\n-   磁场强度$B$（单位 T）\n-   电子温度$T_e$（单位 eV）\n-   离子质量$m_i$（单位 kg）\n-   梯度标长$L$（单位 m）\n-   一个垂直波数数组$\\{k_i\\}_{i=1}^N$（单位 $m^{-1}$）\n-   一个线性增长率数组$\\{\\gamma_i\\}_{i=1}^N$（单位 $s^{-1}$）\n-   一个无量纲波数的窗口$[k_{\\rho,\\min}, k_{\\rho,\\max}]$。\n\n**常量：**\n-   基本电荷$e = 1.602176634 \\times 10^{-19}\\,C$。\n\n**算法步骤：**\n1.  **计算物理参数**：\n    a.  将电子温度转换为焦耳：$T_{e,J} = T_e \\times e$。\n    b.  计算离子声速：$c_s = \\sqrt{T_{e,J} / m_i}$。\n    c.  计算离子回旋频率：$\\Omega_{ci} = e B / m_i$。\n    d.  计算声拉莫尔半径：$\\rho_s = c_s / \\Omega_{ci}$。\n\n2.  **筛选数据并构建容许集**：\n    a.  创建一个空列表`admissible_modes`，用于存储用于扩散系数计算的候选模式。\n    b.  遍历输入谱$\\{(k_i, \\gamma_i)\\}_{i=1}^N$。\n    c.  对于每个模式$i$，对增长率强制施加正性：$\\gamma'_i = \\max(0, \\gamma_i)$。\n    d.  计算无量纲波数：$k_{\\rho,i} = k_i \\rho_s$。\n    e.  通过测试模式是否落在指定窗口内来检查其物理相关性：$k_{\\rho,\\min} \\le k_{\\rho,i} \\le k_{\\rho,\\max}$。\n    f.  如果(2e)中的条件满足，则将对$(k_i, \\gamma'_i)$添加到`admissible_modes`列表中。\n\n3.  **处理后备条件**：\n    a.  检查在遍历所有模式后`admissible_modes`列表是否为空。\n    b.  如果为空，则触发后备机制。创建一个新列表`fallback_modes`。\n        i. 遍历原始谱$\\{(k_i, \\gamma_i)\\}_{i=1}^N$。\n        ii. 计算有效波数：$k_{\\mathrm{eff},i} = \\max(k_i, 1/L)$。\n        iii. 对增长率应用正性：$\\gamma'_i = \\max(0, \\gamma_i)$。\n        iv. 将对$(k_{\\mathrm{eff},i}, \\gamma'_i)$添加到`fallback_modes`列表中。\n    c.  待评估的模式集合`evaluation_set`是`admissible_modes`（如果不为空），否则为`fallback_modes`。\n\n4.  **选择主导模式并计算扩散系数**：\n    a.  初始化最大扩散系数$D_{\\max} = 0$。\n    b.  如果`evaluation_set`为空（如果所有原始$\\gamma_i \\le 0$且未触发后备方案，则可能发生），扩散系数保持为$0$。\n    c.  否则，遍历`evaluation_set`中的每一对$(k, \\gamma')$。\n        i. 计算此模式的试探扩散系数：$D_{\\text{trial}} = \\gamma' / k^2$。请注意，$k$可以是原始的$k_i$或有效的$k_{\\mathrm{eff},i}$，具体取决于上下文。\n        ii. 更新最大扩散系数：$D_{\\max} = \\max(D_{\\max}, D_{\\text{trial}})$。\n    d.  该测试案例的最终结果是$D_{\\max}$。\n\n该算法系统地应用了物理模型和约束条件，从线性模式的离散谱中确定了一个单一的、有代表性的湍流扩散系数值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mixing-length diffusivity for a set of test cases based on\n    tabulated gyrokinetic data.\n    \"\"\"\n    \n    # Fundamental physical constant\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"B\": 3.0, \"Te\": 2000.0, \"mi\": 3.344e-27, \"L\": 0.2,\n            \"k_perp\": np.array([100.0, 200.0, 400.0, 800.0, 1600.0]),\n            \"gamma\": np.array([1.0e5, 3.0e5, 4.0e5, 2.0e5, 1.0e5]),\n            \"k_rho_window\": (0.2, 1.5)\n        },\n        {\n            \"B\": 2.1, \"Te\": 1000.0, \"mi\": 3.344e-27, \"L\": 0.3,\n            \"k_perp\": np.array([100.0, 200.0, 400.0]),\n            \"gamma\": np.array([-2.0e4, -1.0e4, 0.0]),\n            \"k_rho_window\": (0.2, 1.5)\n        },\n        {\n            \"B\": 5.0, \"Te\": 1000.0, \"mi\": 3.344e-27, \"L\": 0.5,\n            \"k_perp\": np.array([50.0, 80.0, 100.0]),\n            \"gamma\": np.array([5.0e4, 8.0e4, 9.0e4]),\n            \"k_rho_window\": (0.2, 1.5)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_diffusivity(\n            B=case[\"B\"],\n            Te_eV=case[\"Te\"],\n            m_i=case[\"mi\"],\n            L=case[\"L\"],\n            k_perp_values=case[\"k_perp\"],\n            gamma_values=case[\"gamma\"],\n            k_rho_window=case[\"k_rho_window\"],\n            e_charge=E_CHARGE\n        )\n        results.append(result)\n\n    # Format the final output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_diffusivity(B, Te_eV, m_i, L, k_perp_values, gamma_values, k_rho_window, e_charge):\n    \"\"\"\n    Implements the algorithm to calculate the mixing-length diffusivity.\n    \n    Args:\n        B (float): Magnetic field strength in Tesla.\n        Te_eV (float): Electron temperature in electron-volts.\n        m_i (float): Ion mass in kg.\n        L (float): Gradient scale length in meters.\n        k_perp_values (np.ndarray): Array of perpendicular wavenumbers in m^-1.\n        gamma_values (np.ndarray): Array of linear growth rates in s^-1.\n        k_rho_window (tuple): (min, max) for the k_perp * rho_s window.\n        e_charge (float): Elementary charge in Coulombs.\n\n    Returns:\n        float: The calculated turbulent diffusivity in m^2/s.\n    \"\"\"\n    \n    # 1. Compute physical parameters\n    Te_J = Te_eV * e_charge\n    c_s = np.sqrt(Te_J / m_i)\n    Omega_ci = e_charge * B / m_i\n    rho_s = c_s / Omega_ci\n\n    # Enforce positivity on growth rates\n    gamma_prime = np.maximum(0, gamma_values)\n\n    # 2. Filter data and construct admissible set\n    admissible_modes = []\n    k_rho_min, k_rho_max = k_rho_window\n    \n    for k, g in zip(k_perp_values, gamma_prime):\n        k_rho = k * rho_s\n        if k_rho_min = k_rho = k_rho_max:\n            admissible_modes.append((k, g))\n\n    # 3. Handle fallback condition and define evaluation set\n    evaluation_set = []\n    if not admissible_modes:\n        # Fallback triggered: no modes in the specified window\n        k_inv_L = 1.0 / L\n        for k, g in zip(k_perp_values, gamma_prime):\n            k_eff = np.maximum(k, k_inv_L)\n            evaluation_set.append((k_eff, g))\n    else:\n        evaluation_set = admissible_modes\n\n    # 4. Select dominant mode and compute diffusivity\n    max_D = 0.0\n    if not evaluation_set:\n        return 0.0\n\n    for k_eval, g_eval in evaluation_set:\n        # Avoid division by zero, although k is expected to be positive.\n        if k_eval  0:\n            D_trial = g_eval / (k_eval**2)\n            if D_trial  max_D:\n                max_D = D_trial\n                \n    return max_D\n\nsolve()\n```"
        }
    ]
}